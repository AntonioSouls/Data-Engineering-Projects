<!DOCTYPE html><html lang="en" prefix="dcterms: http://purl.org/dc/terms/" data-theme="light"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>Look Around and Find Out: OOD Detection with Relative Angles</title>
<!--Generated on Sun Oct  6 15:37:10 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="https://arxiv.org/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css">
<link href="https://arxiv.org/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css">
<link href="https://arxiv.org/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css">




<base href="https://arxiv.org/html/2410.04525v1/"><link rel="stylesheet" href="https://use.typekit.net/rwr5zpx.css"><link rel="icon" type="image/png" href="https://static.arxiv.org/static/browse/0.3.4/images/icons/favicon-16x16.png" sizes="16x16"><link rel="icon" type="image/png" href="https://static.arxiv.org/static/browse/0.3.4/images/icons/favicon-32x32.png" sizes="32x32"></head>
<body><header class="mob_header">
    <div class="html-header-logo">
      <a href="https://arxiv.org/">
        <img alt="logo" class="logomark" role="presentation" width="100" src="https://services.dev.arxiv.org/html/static/arxiv-logomark-small-white.svg">
        <span class="sr-only">Back to arXiv</span>
      </a>
    </div>

    <!--TOC, dark mode, links-->
    <div class="html-header-nav">
      <!--back to abstract-->
      
        <a class="nav-link ar5iv-footer-button hover-effect" aria-label="Back to abstract page" href="https://arxiv.org/abs/2410.04525v1">
        <svg xmlns="http://www.w3.org/2000/svg" height="1.25em" viewBox="0 0 512 512" fill="#ffffff" aria-hidden="true">
            <path d="M502.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 224 192 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l210.7 0-73.4 73.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l128-128zM160 96c17.7 0 32-14.3 32-32s-14.3-32-32-32L96 32C43 32 0 75 0 128L0 384c0 53 43 96 96 96l64 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-64 0c-17.7 0-32-14.3-32-32l0-256c0-17.7 14.3-32 32-32l64 0z"></path>
        </svg>
        </a>
      <!--dark mode-->
      <a class="ar5iv-toggle-color-scheme" title="Toggle dark/light mode" aria-label="System preference">
        <label id="automatic-tog" class="toggle-icon" title="Switch to light mode" for="__palette_3">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"></path></svg>
        </label>
        
        
      </a>
      <!--nav-->
      <button class="navbar-toggler ar5iv-footer-button" type="button" data-bs-theme="dark" data-bs-toggle="collapse" aria-expanded="false" data-bs-target=".ltx_page_main >.ltx_TOC.mobile" aria-controls="navbarSupportedContent" aria-label="Toggle navigation" style="border:none; margin-right: 0em;">
        <svg xmlns="http://www.w3.org/2000/svg" height="1.25em" viewBox="0 0 448 512" aria-hidden="true" role="img" fill="#ffffff"><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"></path></svg>
      </button>
    </div>
    </header><header class="desktop_header">
    <div class="html-header-logo">
      <a href="https://arxiv.org/">
          <img alt="logo" class="logo" role="presentation" width="100" src="https://services.dev.arxiv.org/html/static/arxiv-logo-one-color-white.svg">
          <span class="sr-only">Back to arXiv</span>
      </a>
    </div>
    <div class="html-header-message" role="banner">
        <p>This is <strong>experimental HTML</strong> to improve accessibility. We invite you to report rendering errors. <span class="sr-only">Use Alt+Y to toggle on accessible reporting links and Alt+Shift+Y to toggle off.</span> Learn more <a href="https://info.arxiv.org/about/accessible_HTML.html" target="_blank">about this project</a> and <a href="https://info.arxiv.org/help/submit_latex_best_practices.html" target="_blank">help improve conversions</a>.
        </p>
    </div>
    <nav class="html-header-nav">
      <a class="ar5iv-footer-button hover-effect" href="https://info.arxiv.org/about/accessible_HTML.html" target="_blank">Why HTML?</a>
      <a class="ar5iv-footer-button hover-effect" target="_blank" href="https://arxiv.org/html/2410.04525v1/#myForm">Report Issue</a>
      <a class="ar5iv-footer-button hover-effect" href="https://arxiv.org/abs/2410.04525v1">Back to Abstract</a>
      <a class="ar5iv-footer-button hover-effect" href="https://arxiv.org/pdf/2410.04525v1" target="_blank">Download PDF</a>
      <a class="ar5iv-toggle-color-scheme" title="Toggle dark/light mode">
        <label id="automatic-tog" class="toggle-icon" title="Switch to light mode" for="__palette_3">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"></path></svg>
        </label>
        
        
      </a>
    </nav></header>

<div class="ltx_page_main" id="main">
<nav class="ltx_TOC active" aria-labelledby="toc_header"><h2 id="toc_header" class="sr-only">Table of Contents</h2>

      <div id="listIcon" type="button" class="hide">
          <svg width="17px" height="17px" viewBox="0 0 512 512" style="pointer-events: none;">
          <path d="M40 48C26.7 48 16 58.7 16 72v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V72c0-13.3-10.7-24-24-24H40zM192 64c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zM16 232v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V232c0-13.3-10.7-24-24-24H40c-13.3 0-24 10.7-24 24zM40 368c-13.3 0-24 10.7-24 24v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V392c0-13.3-10.7-24-24-24H40z"></path>
          </svg>
      </div>
      <div id="arrowIcon" type="button">
          <svg width="17px" height="17px" viewBox="0 0 448 512" style="pointer-events: none;">
          <path d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.2 288 416 288c17.7 0 32-14.3 32-32s-14.3-32-32-32l-306.7 0L214.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"></path>
          </svg>
      </div><ol class="ltx_toclist"><li class="ltx_tocentry ltx_tocentry_section">
    <a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#abstract" title="Abstract">
      <span class="ltx_text ltx_ref_title">
        <span class="ltx_tag ltx_tag_ref"></span>
        Abstract
      </span>
    </a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#S1" title="In Look Around and Find Out: OOD Detection with Relative Angles"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#S2" title="In Look Around and Find Out: OOD Detection with Relative Angles"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#S2.SS0.SSS0.Px1" title="In 2 Related Work ‣ Look Around and Find Out: OOD Detection with Relative Angles"><span class="ltx_text ltx_ref_title">Model Regularization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#S2.SS0.SSS0.Px2" title="In 2 Related Work ‣ Look Around and Find Out: OOD Detection with Relative Angles"><span class="ltx_text ltx_ref_title">Score Functions</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#S3" title="In Look Around and Find Out: OOD Detection with Relative Angles"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Method</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#S3.SS1" title="In 3 Method ‣ Look Around and Find Out: OOD Detection with Relative Angles"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Problem Setting</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#S3.SS2" title="In 3 Method ‣ Look Around and Find Out: OOD Detection with Relative Angles"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>OOD Detection with Relative Angles</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#S3.SS3" title="In 3 Method ‣ Look Around and Find Out: OOD Detection with Relative Angles"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Features on the Decision Boundary</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#S4" title="In Look Around and Find Out: OOD Detection with Relative Angles"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#S4.SS1" title="In 4 Experiments ‣ Look Around and Find Out: OOD Detection with Relative Angles"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>OOD Detection on CIFAR-10 and ImageNet Benchmarks</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#S4.SS2" title="In 4 Experiments ‣ Look Around and Find Out: OOD Detection with Relative Angles"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Model Ensembling with LAFO</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#S4.SS3" title="In 4 Experiments ‣ Look Around and Find Out: OOD Detection with Relative Angles"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>LAFO with activation shaping algorithms</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#S4.SS4" title="In 4 Experiments ‣ Look Around and Find Out: OOD Detection with Relative Angles"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Ablation Studies</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#S5" title="In Look Around and Find Out: OOD Detection with Relative Angles"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#A1" title="In Look Around and Find Out: OOD Detection with Relative Angles"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Appendix</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#A1.SS1" title="In Appendix A Appendix ‣ Look Around and Find Out: OOD Detection with Relative Angles"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Comparison of Score Distributions: CIFAR-10 vs. OOD Datasets</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#A1.SS2" title="In Appendix A Appendix ‣ Look Around and Find Out: OOD Detection with Relative Angles"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2 </span>Comparison of Score Distributions: ImageNet vs. OOD Datasets</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#A1.SS3" title="In Appendix A Appendix ‣ Look Around and Find Out: OOD Detection with Relative Angles"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.3 </span>Model Ensemble Experiment</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#A1.SS4" title="In Appendix A Appendix ‣ Look Around and Find Out: OOD Detection with Relative Angles"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.4 </span>Implementation Details</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
    <a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib" title="References">
      <span class="ltx_text ltx_ref_title">
        <span class="ltx_tag ltx_tag_ref"></span>
        References
      </span>
    </a></li></ol></nav>

<div class="ltx_page_content"><div class="package-alerts ltx_document" role="status" aria-label="Conversion errors have been found">
      <button aria-label="Dismiss alert">
          <span aria-hidden="true"><svg role="presentation" width="20" height="20" viewBox="0 0 44 44" aria-hidden="true" focusable="false">
          <path d="M0.549989 4.44999L4.44999 0.549988L43.45 39.55L39.55 43.45L0.549989 4.44999Z"></path>
          <path d="M39.55 0.549988L43.45 4.44999L4.44999 43.45L0.549988 39.55L39.55 0.549988Z"></path>
          </svg></span>
      </button>
      <p>HTML conversions <a href="https://info.dev.arxiv.org/about/accessibility_html_error_messages.html" target="_blank">sometimes display errors</a> due to content that did not convert correctly from the source. This paper uses the following packages that are not yet supported by the HTML conversion tool. Feedback on these issues are not necessary; they are known and are being worked on.</p>
          <ul arial-label="Unsupported packages used in this paper">
              <li>failed: mdframed</li><li>failed: epic</li>
          </ul>
      <p>Authors: achieve the best HTML results from your LaTeX submissions by following these <a href="https://info.arxiv.org/help/submit_latex_best_practices.html" target="_blank">best practices</a>.</p>
    </div><div id="target-section" class="section"><a id="license-tr" href="https://info.arxiv.org/help/license/index.html#licenses-available">License: CC BY-NC-SA 4.0</a><div id="watermark-tr">arXiv:2410.04525v1 [cs.LG] 06 Oct 2024</div></div>
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Look Around and Find Out: OOD Detection with Relative Angles</h1><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Berker Demirel
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">Institute of Science and Technology, Austria
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Marco Fumero
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">Institute of Science and Technology, Austria
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Francesco Locatello
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">Institute of Science and Technology, Austria
</span></span></span>
</div><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_abstract" id="abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<p class="ltx_p" id="id2.2">Deep learning systems deployed in real-world applications often encounter data that is different from their in-distribution (ID). A reliable system should ideally abstain from making decisions in this out-of-distribution (OOD) setting. Existing state-of-the-art methods primarily focus on feature distances, such as k-th nearest neighbors and distances to decision boundaries, either overlooking or ineffectively using in-distribution statistics. In this work, we propose a novel angle-based metric for OOD detection that is computed relative to the in-distribution structure. We demonstrate that the angles between feature representations and decision boundaries, viewed from the mean of in-distribution features, serve as an effective discriminative factor between ID and OOD data. Our method achieves state-of-the-art performance on CIFAR-10 and ImageNet benchmarks, reducing FPR95 by <math alttext="0.88\%" class="ltx_Math" display="inline" id="id1.1.m1.1"><semantics id="id1.1.m1.1a"><mrow id="id1.1.m1.1.1" xref="id1.1.m1.1.1.cmml"><mn id="id1.1.m1.1.1.2" xref="id1.1.m1.1.1.2.cmml">0.88</mn><mo id="id1.1.m1.1.1.1" xref="id1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="id1.1.m1.1b"><apply id="id1.1.m1.1.1.cmml" xref="id1.1.m1.1.1"><csymbol cd="latexml" id="id1.1.m1.1.1.1.cmml" xref="id1.1.m1.1.1.1">percent</csymbol><cn id="id1.1.m1.1.1.2.cmml" type="float" xref="id1.1.m1.1.1.2">0.88</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id1.1.m1.1c">0.88\%</annotation><annotation encoding="application/x-llamapun" id="id1.1.m1.1d">0.88 %</annotation></semantics></math> and <math alttext="7.74\%" class="ltx_Math" display="inline" id="id2.2.m2.1"><semantics id="id2.2.m2.1a"><mrow id="id2.2.m2.1.1" xref="id2.2.m2.1.1.cmml"><mn id="id2.2.m2.1.1.2" xref="id2.2.m2.1.1.2.cmml">7.74</mn><mo id="id2.2.m2.1.1.1" xref="id2.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="id2.2.m2.1b"><apply id="id2.2.m2.1.1.cmml" xref="id2.2.m2.1.1"><csymbol cd="latexml" id="id2.2.m2.1.1.1.cmml" xref="id2.2.m2.1.1.1">percent</csymbol><cn id="id2.2.m2.1.1.2.cmml" type="float" xref="id2.2.m2.1.1.2">7.74</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id2.2.m2.1c">7.74\%</annotation><annotation encoding="application/x-llamapun" id="id2.2.m2.1d">7.74 %</annotation></semantics></math> respectively. Our score function is compatible with existing feature space regularization techniques, enhancing performance. Additionally, its scale-invariance property enables creating an ensemble of models for OOD detection via simple score summation. Code available at <a class="ltx_ref ltx_href" href="https://github.com/berkerdemirel/LAFO-Look-Around-and-Find-Out" title="">https://github.com/berkerdemirel/LAFO-Look-Around-and-Find-Out</a></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">A trustworthy deep learning system should not only produce accurate predictions, but also recognize when it is processing an unknown sample. The ability to identify when a sample deviates from the expected distribution, and potentially rejecting it, plays a crucial role especially in safety-critical applications, such as medical diagnosis &nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib11" title="">11</a>]</cite>, driverless cars &nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib3" title="">3</a>]</cite> and surveillance systems &nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib7" title="">7</a>]</cite>. The out-of-distribution (OOD) detection problem addresses the challenge of distinguishing between in-distribution (ID) and OOD data – essentially, drawing a line between what the system knows and what it does not.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Various approaches have been proposed for OOD detection, mainly falling into two categories: (i) methods that suggest model regularization during training &nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib22" title="">22</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib16" title="">16</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib28" title="">28</a>]</cite>, and
(ii) post-hoc methods, which leverage a pre-trained model to determine if a sample is OOD by designing appropriate <em class="ltx_emph ltx_font_italic" id="S1.p2.1.1">score functions</em> &nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib35" title="">35</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib15" title="">15</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib39" title="">39</a>]</cite>. Post-hoc methods are more advantageous for their efficiency and flexibility, as they can be applied to arbitrary pre-trained models without retraining. These approaches are often categorized based on the domain of their score functions, i.e., at which representational abstraction level they assess if a sample is OOD or not. Earlier techniques focus on measuring the model confidence in the logits space &nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib15" title="">15</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib26" title="">26</a>]</cite>, while the recent works employ distance-based scores &nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib39" title="">39</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib36" title="">36</a>]</cite> defined in the model feature space. While logit-based methods suffer from the overconfident predictions of neural networks &nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib29" title="">29</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib21" title="">21</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib13" title="">13</a>]</cite>, the recent success of distance-based techniques highlights that the relationships in the latent space can provide a richer analysis.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">A natural approach to feature representations is by checking their proximity to the decision boundaries &nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib25" title="">25</a>]</cite>. Conceptually, this can be related to identifying hard-to-learn examples in data-efficient learning &nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib18" title="">18</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib4" title="">4</a>]</cite>. OOD samples can be viewed as hard-to-learn since they do not share the same label distribution as ID data. The success of this approach has been directly showed in fDBD score from &nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib25" title="">25</a>]</cite>. However, our derivations revealed that the regularization term they use to incorporate ID statistics introduces an additional term that does not correlate with ID/OOD separation, ultimately hindering their performance.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">In this work, we present Look Around and Find Out (LAFO), a novel approach that exploits the relationship between feature representations and classifier decision boundaries, in the context of the mean statistics of ID features. Unlike the earlier techniques, LAFO introduces a new angle-based measure that calculates the angles between the feature representations and their projection onto the decision boundaries, relative to the the mean statistics of ID features. Changing reference frame to the mean of ID features adds another layer of discriminatory information to the score, as it naturally incorporates the ID statistics to the distance notion, exploiting the disparity between ID and OOD statistics.
Moreover, the scale-invariant nature of angle-based representations, as similarly observed in&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib32" title="">32</a>]</cite>, allows us to aggregate the confidence scores from multiple pre-trained models simply by summing their LAFO scores. This enables to have a score that can be single model based or extended to ensemble of models. In summary, our key contributions include:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S1.p5">
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We present a novel technique for OOD detection, which computes the angles between the feature representation and its projection to the decision boundaries, relative to the mean of ID-features</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">Our score is model agnostic, hyperparameter-free and efficient, scaling linearly with the number of ID-classes. Therefore, it can flexibly be combined with various architectures without the need of additional tuning.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">We demonstrate the state-of-the-art performance of LAFO on widely used CIFAR-10 and ImageNet OOD benchmarks. Specifically, LAFO achieves a <math alttext="7.74\%" class="ltx_Math" display="inline" id="S1.I1.i3.p1.1.m1.1"><semantics id="S1.I1.i3.p1.1.m1.1a"><mrow id="S1.I1.i3.p1.1.m1.1.1" xref="S1.I1.i3.p1.1.m1.1.1.cmml"><mn id="S1.I1.i3.p1.1.m1.1.1.2" xref="S1.I1.i3.p1.1.m1.1.1.2.cmml">7.74</mn><mo id="S1.I1.i3.p1.1.m1.1.1.1" xref="S1.I1.i3.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.I1.i3.p1.1.m1.1b"><apply id="S1.I1.i3.p1.1.m1.1.1.cmml" xref="S1.I1.i3.p1.1.m1.1.1"><csymbol cd="latexml" id="S1.I1.i3.p1.1.m1.1.1.1.cmml" xref="S1.I1.i3.p1.1.m1.1.1.1">percent</csymbol><cn id="S1.I1.i3.p1.1.m1.1.1.2.cmml" type="float" xref="S1.I1.i3.p1.1.m1.1.1.2">7.74</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i3.p1.1.m1.1c">7.74\%</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i3.p1.1.m1.1d">7.74 %</annotation></semantics></math> reduction in FPR95 score compared to the best previous distance-based method on a large-scale ImageNet OOD benchmark.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S1.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i4.p1">
<p class="ltx_p" id="S1.I1.i4.p1.1">The scale-invariant property of LAFO allows for straightforward aggregation of confidence scores from multiple pre-trained models, improving ensemble performance. Our experiments show that the ensemble with LAFO reduces the FPR95 by <math alttext="2.51\%" class="ltx_Math" display="inline" id="S1.I1.i4.p1.1.m1.1"><semantics id="S1.I1.i4.p1.1.m1.1a"><mrow id="S1.I1.i4.p1.1.m1.1.1" xref="S1.I1.i4.p1.1.m1.1.1.cmml"><mn id="S1.I1.i4.p1.1.m1.1.1.2" xref="S1.I1.i4.p1.1.m1.1.1.2.cmml">2.51</mn><mo id="S1.I1.i4.p1.1.m1.1.1.1" xref="S1.I1.i4.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.I1.i4.p1.1.m1.1b"><apply id="S1.I1.i4.p1.1.m1.1.1.cmml" xref="S1.I1.i4.p1.1.m1.1.1"><csymbol cd="latexml" id="S1.I1.i4.p1.1.m1.1.1.1.cmml" xref="S1.I1.i4.p1.1.m1.1.1.1">percent</csymbol><cn id="S1.I1.i4.p1.1.m1.1.1.2.cmml" type="float" xref="S1.I1.i4.p1.1.m1.1.1.2">2.51</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i4.p1.1.m1.1c">2.51\%</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i4.p1.1.m1.1d">2.51 %</annotation></semantics></math> on the ImageNet OOD benchmark compared to the best single model performance.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">Previous work in OOD detection falls into two categories: (i) methods that regularize models during training to produce different outcomes for ID and OOD data, and (ii) post-hoc methods that develop scoring mechanisms using pre-trained models on ID data.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Model Regularization</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S2.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px1.p1.1">Early methods addressing the OOD detection problem &nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib2" title="">2</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib16" title="">16</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib31" title="">31</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib50" title="">50</a>]</cite> utilize additional datasets to represent out-of-distribution data, training models with both positive and negative samples. This approach assumes a specific nature of OOD data, potentially limiting its effectiveness when encountering OOD samples that deviate from this assumption during inference. &nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib27" title="">27</a>]</cite> designed a network architecture to measure distributional uncertainty using Dirichlet Prior Networks. In &nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib12" title="">12</a>]</cite>’s work, they provide another architecture with an additional reject option to abstain from answering. Their selection model incorporates a hyperparameter, the coverage rate for ID, to control the percentage of ID samples classified. &nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib22" title="">22</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib30" title="">30</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib10" title="">10</a>]</cite>, focused on synthesizing outliers rather than relying on auxilary datasets to improve the generalizability of the detection method. On the other hand, &nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib28" title="">28</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib41" title="">41</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib44" title="">44</a>]</cite> argued that overconfident predictions of the networks on OOD data are the problem to be mitigated. For example,
&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib41" title="">41</a>]</cite> puts an additional gradient penalty to limit the confidence of the network. Whereas, &nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib44" title="">44</a>]</cite> tackled the same problem by enforcing a constant logit vector norm during training. Although it is natural to impose structures during training for better separability of ID and OOD, these methods face the trade-off between OOD separability and model performance. Moreover, such approaches lack the flexibility of post-hoc score functions, as they necessitate model retraining—a process that can be both time-consuming and computationally expensive.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Score Functions</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S2.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px2.p1.1">Recently, developing score functions for pretrained models on ID data has gained attention due to its ease of implementation and flexibility. These methods typically either couple feature representations with distance metrics, or measure a model’s confidence using its logits. Beyond canonical works such as Maximum Softmax Probability &nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib15" title="">15</a>]</cite>, ODIN score &nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib24" title="">24</a>]</cite>, Energy score &nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib26" title="">26</a>]</cite>, Mahalanobis score &nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib23" title="">23</a>]</cite>, Virtual Logit Matching &nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib43" title="">43</a>]</cite>, we observed many advancements in post-hoc score design. For example, the activation shaping algorithms such as ASH &nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib8" title="">8</a>]</cite>, Scale &nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib47" title="">47</a>]</cite>, and ReAct &nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib38" title="">38</a>]</cite>, apply activation truncations to feature representations, reducing model’s confidence for OOD data. These methods can be used in conjunction with LAFO improving the performance. Following a similar intuition, DICE &nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib37" title="">37</a>]</cite> applies weight sparsification to limit the model confidence by using the more salient weights for output. GradOrth &nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib1" title="">1</a>]</cite> offers a gradient-based perspective, projecting representations to a lower dimensional subspace based on gradient norms. Recent distance-based methods KNN &nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib39" title="">39</a>]</cite> and FDBD &nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib25" title="">25</a>]</cite> successfully utilized the feature representations from networks trained with supervised contrastive loss. KNN assigns a score to a sample based on the kth nearest neighbor in ID training data. On the other hand, FDBD assigns a score to a sample based on its estimate of the distance between the feature representation and the decision boundaries.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S2.SS0.SSS0.Px2.p2">
<p class="ltx_p" id="S2.SS0.SSS0.Px2.p2.1">Our work falls into the score function category, serving as a plug-in for any pre-trained model on ID data. LAFO combines feature space and logit space methods by utilizing the relative angle between the feature representation and its projections to the decision boundaries. Among the existing works, the closest approach to our method is &nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib25" title="">25</a>]</cite>, which uses a lower bound estimate to the decision boundaries. However, the regularization term they introduced to equalize deviations from the in-distribution mean inadvertently includes a term in their equation that is uncorrelated with being out- or in-distribution and can change spuriously, impeding performance. In contrast, we provide a simple, hyperparameter-free score function that effectively incorporates in-distribution context and maintains scale invariance, all without extra regularization terms.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="S2.F1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S2.F1.sf1"><span class="ltx_picture ltx_centering" id="S2.F1.sf1.pic1" style="width:432.2pt;height:324.5pt;">\begin{overpic}[trim=0.0pt 0.0pt 0.0pt 0.0pt,clip,width=433.62pt,grid=false]{%
figures/teaser/teaser_ID.pdf}
\put(16.0,7.0){\footnotesize$\bm{\mu_{\text{ID}}}$}
\put(23.0,47.0){\footnotesize$\mathbf{z}_{\text{ID}}$}
\put(25.0,65.0){{\color[rgb]{1,.5,0}\definecolor[named]{pgfstrokecolor}{rgb}{%
1,.5,0}$C_{1}$}}
\put(85.0,24.0){{\color[rgb]{0,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{%
0,0,0}$C_{2}$}}
\put(22.0,15.0){\footnotesize{\color[rgb]{0,0,0}\definecolor[named]{%
pgfstrokecolor}{rgb}{0,0,0}\pgfsys@color@gray@stroke{0}\pgfsys@color@gray@fill%
{0}$\theta_{\text{ID}}$}}
\put(62.0,26.0){\footnotesize$\mathbf{z}_{\text{DB}}$}
\par\end{overpic}</span>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F1.sf1.2.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S2.F1.sf1.3.2" style="font-size:90%;">ID</span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S2.F1.sf2"><span class="ltx_picture" id="S2.F1.sf2.pic1" style="width:432.2pt;height:324.5pt;">\begin{overpic}[trim=0.0pt 0.0pt 0.0pt 0.0pt,clip,width=433.62pt,grid=false]{%
figures/teaser/teaser_OOD.pdf}
\put(16.0,7.0){\footnotesize$\bm{\mu_{\text{ID}}}$}
\put(52.0,60.0){\footnotesize$\mathbf{z}_{\text{OOD}}$}
\put(25.0,16.0){\footnotesize{\color[rgb]{0,0,0}\definecolor[named]{%
pgfstrokecolor}{rgb}{0,0,0}\pgfsys@color@gray@stroke{0}\pgfsys@color@gray@fill%
{0}$\theta_{\text{OOD}}$}}
\put(25.0,65.0){{\color[rgb]{1,.5,0}\definecolor[named]{pgfstrokecolor}{rgb}{%
1,.5,0}$C_{1}$}}
\put(85.0,24.0){{\color[rgb]{0,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{%
0,0,0}$C_{2}$}}
\put(74.0,50.0){\footnotesize$\mathbf{z}_{\text{DB}}$}
\end{overpic}</span>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F1.sf2.2.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S2.F1.sf2.3.2" style="font-size:90%;">OOD</span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F1.8.3.1" style="font-size:90%;">Figure 1</span>: </span><span class="ltx_text" id="S2.F1.4.2" style="font-size:90%;">Geometric visualization of LAFO for in-distribution (<span class="ltx_text ltx_font_italic" id="S2.F1.4.2.1">left</span>) and out-of-distribution (<span class="ltx_text ltx_font_italic" id="S2.F1.4.2.2">right</span>) cases. LAFO focuses on the angular distance between the feature representation and the decision boundary, from the perspective of the in-distribution mean. The angle <math alttext="\theta" class="ltx_Math" display="inline" id="S2.F1.3.1.m1.1"><semantics id="S2.F1.3.1.m1.1b"><mi id="S2.F1.3.1.m1.1.1" xref="S2.F1.3.1.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S2.F1.3.1.m1.1c"><ci id="S2.F1.3.1.m1.1.1.cmml" xref="S2.F1.3.1.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.3.1.m1.1d">\theta</annotation><annotation encoding="application/x-llamapun" id="S2.F1.3.1.m1.1e">italic_θ</annotation></semantics></math> serves as the distinguishing factor between ID and OOD samples, with <math alttext="\theta_{\text{ID}}>\theta_{\text{OOD}}" class="ltx_Math" display="inline" id="S2.F1.4.2.m2.1"><semantics id="S2.F1.4.2.m2.1b"><mrow id="S2.F1.4.2.m2.1.1" xref="S2.F1.4.2.m2.1.1.cmml"><msub id="S2.F1.4.2.m2.1.1.2" xref="S2.F1.4.2.m2.1.1.2.cmml"><mi id="S2.F1.4.2.m2.1.1.2.2" xref="S2.F1.4.2.m2.1.1.2.2.cmml">θ</mi><mtext id="S2.F1.4.2.m2.1.1.2.3" xref="S2.F1.4.2.m2.1.1.2.3a.cmml">ID</mtext></msub><mo id="S2.F1.4.2.m2.1.1.1" xref="S2.F1.4.2.m2.1.1.1.cmml">&gt;</mo><msub id="S2.F1.4.2.m2.1.1.3" xref="S2.F1.4.2.m2.1.1.3.cmml"><mi id="S2.F1.4.2.m2.1.1.3.2" xref="S2.F1.4.2.m2.1.1.3.2.cmml">θ</mi><mtext id="S2.F1.4.2.m2.1.1.3.3" xref="S2.F1.4.2.m2.1.1.3.3a.cmml">OOD</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.F1.4.2.m2.1c"><apply id="S2.F1.4.2.m2.1.1.cmml" xref="S2.F1.4.2.m2.1.1"><gt id="S2.F1.4.2.m2.1.1.1.cmml" xref="S2.F1.4.2.m2.1.1.1"></gt><apply id="S2.F1.4.2.m2.1.1.2.cmml" xref="S2.F1.4.2.m2.1.1.2"><csymbol cd="ambiguous" id="S2.F1.4.2.m2.1.1.2.1.cmml" xref="S2.F1.4.2.m2.1.1.2">subscript</csymbol><ci id="S2.F1.4.2.m2.1.1.2.2.cmml" xref="S2.F1.4.2.m2.1.1.2.2">𝜃</ci><ci id="S2.F1.4.2.m2.1.1.2.3a.cmml" xref="S2.F1.4.2.m2.1.1.2.3"><mtext id="S2.F1.4.2.m2.1.1.2.3.cmml" mathsize="70%" xref="S2.F1.4.2.m2.1.1.2.3">ID</mtext></ci></apply><apply id="S2.F1.4.2.m2.1.1.3.cmml" xref="S2.F1.4.2.m2.1.1.3"><csymbol cd="ambiguous" id="S2.F1.4.2.m2.1.1.3.1.cmml" xref="S2.F1.4.2.m2.1.1.3">subscript</csymbol><ci id="S2.F1.4.2.m2.1.1.3.2.cmml" xref="S2.F1.4.2.m2.1.1.3.2">𝜃</ci><ci id="S2.F1.4.2.m2.1.1.3.3a.cmml" xref="S2.F1.4.2.m2.1.1.3.3"><mtext id="S2.F1.4.2.m2.1.1.3.3.cmml" mathsize="70%" xref="S2.F1.4.2.m2.1.1.3.3">OOD</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.4.2.m2.1d">\theta_{\text{ID}}&gt;\theta_{\text{OOD}}</annotation><annotation encoding="application/x-llamapun" id="S2.F1.4.2.m2.1e">italic_θ start_POSTSUBSCRIPT ID end_POSTSUBSCRIPT &gt; italic_θ start_POSTSUBSCRIPT OOD end_POSTSUBSCRIPT</annotation></semantics></math>. </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Method</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Problem Setting</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.19">We consider a supervised classification setting with input space <math alttext="\mathcal{X}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\mathcal{X}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">caligraphic_X</annotation></semantics></math> and label space <math alttext="\mathcal{Y}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">𝒴</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝒴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">\mathcal{Y}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">caligraphic_Y</annotation></semantics></math>, following the literature &nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib51" title="">51</a>]</cite>. Given a model <math alttext="f:\mathcal{X}\rightarrow\mathbb{R}^{|\mathcal{Y}|}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><mrow id="S3.SS1.p1.3.m3.1.2" xref="S3.SS1.p1.3.m3.1.2.cmml"><mi id="S3.SS1.p1.3.m3.1.2.2" xref="S3.SS1.p1.3.m3.1.2.2.cmml">f</mi><mo id="S3.SS1.p1.3.m3.1.2.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p1.3.m3.1.2.1.cmml">:</mo><mrow id="S3.SS1.p1.3.m3.1.2.3" xref="S3.SS1.p1.3.m3.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.3.m3.1.2.3.2" xref="S3.SS1.p1.3.m3.1.2.3.2.cmml">𝒳</mi><mo id="S3.SS1.p1.3.m3.1.2.3.1" stretchy="false" xref="S3.SS1.p1.3.m3.1.2.3.1.cmml">→</mo><msup id="S3.SS1.p1.3.m3.1.2.3.3" xref="S3.SS1.p1.3.m3.1.2.3.3.cmml"><mi id="S3.SS1.p1.3.m3.1.2.3.3.2" xref="S3.SS1.p1.3.m3.1.2.3.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p1.3.m3.1.1.1.3" xref="S3.SS1.p1.3.m3.1.1.1.2.cmml"><mo id="S3.SS1.p1.3.m3.1.1.1.3.1" stretchy="false" xref="S3.SS1.p1.3.m3.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.3.m3.1.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.1.cmml">𝒴</mi><mo id="S3.SS1.p1.3.m3.1.1.1.3.2" stretchy="false" xref="S3.SS1.p1.3.m3.1.1.1.2.1.cmml">|</mo></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.2.cmml" xref="S3.SS1.p1.3.m3.1.2"><ci id="S3.SS1.p1.3.m3.1.2.1.cmml" xref="S3.SS1.p1.3.m3.1.2.1">:</ci><ci id="S3.SS1.p1.3.m3.1.2.2.cmml" xref="S3.SS1.p1.3.m3.1.2.2">𝑓</ci><apply id="S3.SS1.p1.3.m3.1.2.3.cmml" xref="S3.SS1.p1.3.m3.1.2.3"><ci id="S3.SS1.p1.3.m3.1.2.3.1.cmml" xref="S3.SS1.p1.3.m3.1.2.3.1">→</ci><ci id="S3.SS1.p1.3.m3.1.2.3.2.cmml" xref="S3.SS1.p1.3.m3.1.2.3.2">𝒳</ci><apply id="S3.SS1.p1.3.m3.1.2.3.3.cmml" xref="S3.SS1.p1.3.m3.1.2.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.2.3.3.1.cmml" xref="S3.SS1.p1.3.m3.1.2.3.3">superscript</csymbol><ci id="S3.SS1.p1.3.m3.1.2.3.3.2.cmml" xref="S3.SS1.p1.3.m3.1.2.3.3.2">ℝ</ci><apply id="S3.SS1.p1.3.m3.1.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.1.3"><abs id="S3.SS1.p1.3.m3.1.1.1.2.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1.3.1"></abs><ci id="S3.SS1.p1.3.m3.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1">𝒴</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">f:\mathcal{X}\rightarrow\mathbb{R}^{|\mathcal{Y}|}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">italic_f : caligraphic_X → blackboard_R start_POSTSUPERSCRIPT | caligraphic_Y | end_POSTSUPERSCRIPT</annotation></semantics></math> pretrained on an in-distribution dataset <math alttext="D_{\text{ID}}=\{(\mathbf{x}_{i},y_{i})\}_{i=1}^{N}" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.1"><semantics id="S3.SS1.p1.4.m4.1a"><mrow id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><msub id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml"><mi id="S3.SS1.p1.4.m4.1.1.3.2" xref="S3.SS1.p1.4.m4.1.1.3.2.cmml">D</mi><mtext id="S3.SS1.p1.4.m4.1.1.3.3" xref="S3.SS1.p1.4.m4.1.1.3.3a.cmml">ID</mtext></msub><mo id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml">=</mo><msubsup id="S3.SS1.p1.4.m4.1.1.1" xref="S3.SS1.p1.4.m4.1.1.1.cmml"><mrow id="S3.SS1.p1.4.m4.1.1.1.1.1.1" xref="S3.SS1.p1.4.m4.1.1.1.1.1.2.cmml"><mo id="S3.SS1.p1.4.m4.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.4.m4.1.1.1.1.1.2.cmml">{</mo><mrow id="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.2" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.3.cmml"><mo id="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.2.3" stretchy="false" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.3.cmml">(</mo><msub id="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.1.1" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.1.1.2" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.1.1.3" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.2.4" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.3.cmml">,</mo><msub id="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.2.2" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.2.2.2" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.2.2.2.cmml">y</mi><mi id="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.2.2.3" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo id="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.2.5" stretchy="false" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="S3.SS1.p1.4.m4.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.4.m4.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS1.p1.4.m4.1.1.1.1.3" xref="S3.SS1.p1.4.m4.1.1.1.1.3.cmml"><mi id="S3.SS1.p1.4.m4.1.1.1.1.3.2" xref="S3.SS1.p1.4.m4.1.1.1.1.3.2.cmml">i</mi><mo id="S3.SS1.p1.4.m4.1.1.1.1.3.1" xref="S3.SS1.p1.4.m4.1.1.1.1.3.1.cmml">=</mo><mn id="S3.SS1.p1.4.m4.1.1.1.1.3.3" xref="S3.SS1.p1.4.m4.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS1.p1.4.m4.1.1.1.3" xref="S3.SS1.p1.4.m4.1.1.1.3.cmml">N</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><eq id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2"></eq><apply id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.3.1.cmml" xref="S3.SS1.p1.4.m4.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.3.2.cmml" xref="S3.SS1.p1.4.m4.1.1.3.2">𝐷</ci><ci id="S3.SS1.p1.4.m4.1.1.3.3a.cmml" xref="S3.SS1.p1.4.m4.1.1.3.3"><mtext id="S3.SS1.p1.4.m4.1.1.3.3.cmml" mathsize="70%" xref="S3.SS1.p1.4.m4.1.1.3.3">ID</mtext></ci></apply><apply id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.1">superscript</csymbol><apply id="S3.SS1.p1.4.m4.1.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.1">subscript</csymbol><set id="S3.SS1.p1.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1"><interval closure="open" id="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.2"><apply id="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.2.2.2">𝑦</ci><ci id="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply></interval></set><apply id="S3.SS1.p1.4.m4.1.1.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1.3"><eq id="S3.SS1.p1.4.m4.1.1.1.1.3.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1.3.1"></eq><ci id="S3.SS1.p1.4.m4.1.1.1.1.3.2.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1.3.2">𝑖</ci><cn id="S3.SS1.p1.4.m4.1.1.1.1.3.3.cmml" type="integer" xref="S3.SS1.p1.4.m4.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS1.p1.4.m4.1.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.1.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">D_{\text{ID}}=\{(\mathbf{x}_{i},y_{i})\}_{i=1}^{N}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.1d">italic_D start_POSTSUBSCRIPT ID end_POSTSUBSCRIPT = { ( bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math>, where elements of <math alttext="D_{\text{ID}}" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.1"><semantics id="S3.SS1.p1.5.m5.1a"><msub id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml"><mi id="S3.SS1.p1.5.m5.1.1.2" xref="S3.SS1.p1.5.m5.1.1.2.cmml">D</mi><mtext id="S3.SS1.p1.5.m5.1.1.3" xref="S3.SS1.p1.5.m5.1.1.3a.cmml">ID</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2">𝐷</ci><ci id="S3.SS1.p1.5.m5.1.1.3a.cmml" xref="S3.SS1.p1.5.m5.1.1.3"><mtext id="S3.SS1.p1.5.m5.1.1.3.cmml" mathsize="70%" xref="S3.SS1.p1.5.m5.1.1.3">ID</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">D_{\text{ID}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.1d">italic_D start_POSTSUBSCRIPT ID end_POSTSUBSCRIPT</annotation></semantics></math> are drawn from a joint distribution <math alttext="P_{\mathcal{X}\mathcal{Y}}" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m6.1"><semantics id="S3.SS1.p1.6.m6.1a"><msub id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml"><mi id="S3.SS1.p1.6.m6.1.1.2" xref="S3.SS1.p1.6.m6.1.1.2.cmml">P</mi><mrow id="S3.SS1.p1.6.m6.1.1.3" xref="S3.SS1.p1.6.m6.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.6.m6.1.1.3.2" xref="S3.SS1.p1.6.m6.1.1.3.2.cmml">𝒳</mi><mo id="S3.SS1.p1.6.m6.1.1.3.1" xref="S3.SS1.p1.6.m6.1.1.3.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.6.m6.1.1.3.3" xref="S3.SS1.p1.6.m6.1.1.3.3.cmml">𝒴</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2">𝑃</ci><apply id="S3.SS1.p1.6.m6.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3"><times id="S3.SS1.p1.6.m6.1.1.3.1.cmml" xref="S3.SS1.p1.6.m6.1.1.3.1"></times><ci id="S3.SS1.p1.6.m6.1.1.3.2.cmml" xref="S3.SS1.p1.6.m6.1.1.3.2">𝒳</ci><ci id="S3.SS1.p1.6.m6.1.1.3.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3.3">𝒴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">P_{\mathcal{X}\mathcal{Y}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m6.1d">italic_P start_POSTSUBSCRIPT caligraphic_X caligraphic_Y end_POSTSUBSCRIPT</annotation></semantics></math>, with support <math alttext="\mathcal{X}\times\mathcal{Y}" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m7.1"><semantics id="S3.SS1.p1.7.m7.1a"><mrow id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.7.m7.1.1.2" xref="S3.SS1.p1.7.m7.1.1.2.cmml">𝒳</mi><mo id="S3.SS1.p1.7.m7.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.7.m7.1.1.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.7.m7.1.1.3" xref="S3.SS1.p1.7.m7.1.1.3.cmml">𝒴</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><apply id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1"><times id="S3.SS1.p1.7.m7.1.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1.1"></times><ci id="S3.SS1.p1.7.m7.1.1.2.cmml" xref="S3.SS1.p1.7.m7.1.1.2">𝒳</ci><ci id="S3.SS1.p1.7.m7.1.1.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3">𝒴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">\mathcal{X}\times\mathcal{Y}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m7.1d">caligraphic_X × caligraphic_Y</annotation></semantics></math>. We denote with <math alttext="P_{\text{ID}}" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m8.1"><semantics id="S3.SS1.p1.8.m8.1a"><msub id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml"><mi id="S3.SS1.p1.8.m8.1.1.2" xref="S3.SS1.p1.8.m8.1.1.2.cmml">P</mi><mtext id="S3.SS1.p1.8.m8.1.1.3" xref="S3.SS1.p1.8.m8.1.1.3a.cmml">ID</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><apply id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS1.p1.8.m8.1.1.2.cmml" xref="S3.SS1.p1.8.m8.1.1.2">𝑃</ci><ci id="S3.SS1.p1.8.m8.1.1.3a.cmml" xref="S3.SS1.p1.8.m8.1.1.3"><mtext id="S3.SS1.p1.8.m8.1.1.3.cmml" mathsize="70%" xref="S3.SS1.p1.8.m8.1.1.3">ID</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">P_{\text{ID}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.8.m8.1d">italic_P start_POSTSUBSCRIPT ID end_POSTSUBSCRIPT</annotation></semantics></math> its marginalization on <math alttext="\mathcal{X}" class="ltx_Math" display="inline" id="S3.SS1.p1.9.m9.1"><semantics id="S3.SS1.p1.9.m9.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b"><ci id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">\mathcal{X}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.9.m9.1d">caligraphic_X</annotation></semantics></math>. The <em class="ltx_emph ltx_font_italic" id="S3.SS1.p1.19.1">OOD detection problem</em> aims to determine whether an input sample originates from the in-distribution <math alttext="P_{in}" class="ltx_Math" display="inline" id="S3.SS1.p1.10.m10.1"><semantics id="S3.SS1.p1.10.m10.1a"><msub id="S3.SS1.p1.10.m10.1.1" xref="S3.SS1.p1.10.m10.1.1.cmml"><mi id="S3.SS1.p1.10.m10.1.1.2" xref="S3.SS1.p1.10.m10.1.1.2.cmml">P</mi><mrow id="S3.SS1.p1.10.m10.1.1.3" xref="S3.SS1.p1.10.m10.1.1.3.cmml"><mi id="S3.SS1.p1.10.m10.1.1.3.2" xref="S3.SS1.p1.10.m10.1.1.3.2.cmml">i</mi><mo id="S3.SS1.p1.10.m10.1.1.3.1" xref="S3.SS1.p1.10.m10.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.10.m10.1.1.3.3" xref="S3.SS1.p1.10.m10.1.1.3.3.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m10.1b"><apply id="S3.SS1.p1.10.m10.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m10.1.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1">subscript</csymbol><ci id="S3.SS1.p1.10.m10.1.1.2.cmml" xref="S3.SS1.p1.10.m10.1.1.2">𝑃</ci><apply id="S3.SS1.p1.10.m10.1.1.3.cmml" xref="S3.SS1.p1.10.m10.1.1.3"><times id="S3.SS1.p1.10.m10.1.1.3.1.cmml" xref="S3.SS1.p1.10.m10.1.1.3.1"></times><ci id="S3.SS1.p1.10.m10.1.1.3.2.cmml" xref="S3.SS1.p1.10.m10.1.1.3.2">𝑖</ci><ci id="S3.SS1.p1.10.m10.1.1.3.3.cmml" xref="S3.SS1.p1.10.m10.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m10.1c">P_{in}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.10.m10.1d">italic_P start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT</annotation></semantics></math> or not. Denoting with <math alttext="\mathcal{Y}_{\text{OOD}}" class="ltx_Math" display="inline" id="S3.SS1.p1.11.m11.1"><semantics id="S3.SS1.p1.11.m11.1a"><msub id="S3.SS1.p1.11.m11.1.1" xref="S3.SS1.p1.11.m11.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.11.m11.1.1.2" xref="S3.SS1.p1.11.m11.1.1.2.cmml">𝒴</mi><mtext id="S3.SS1.p1.11.m11.1.1.3" xref="S3.SS1.p1.11.m11.1.1.3a.cmml">OOD</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m11.1b"><apply id="S3.SS1.p1.11.m11.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.1.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1">subscript</csymbol><ci id="S3.SS1.p1.11.m11.1.1.2.cmml" xref="S3.SS1.p1.11.m11.1.1.2">𝒴</ci><ci id="S3.SS1.p1.11.m11.1.1.3a.cmml" xref="S3.SS1.p1.11.m11.1.1.3"><mtext id="S3.SS1.p1.11.m11.1.1.3.cmml" mathsize="70%" xref="S3.SS1.p1.11.m11.1.1.3">OOD</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m11.1c">\mathcal{Y}_{\text{OOD}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.11.m11.1d">caligraphic_Y start_POSTSUBSCRIPT OOD end_POSTSUBSCRIPT</annotation></semantics></math> a set of labels such that <math alttext="\mathcal{Y}\cap\mathcal{Y}_{\text{OOD}}=\emptyset" class="ltx_Math" display="inline" id="S3.SS1.p1.12.m12.1"><semantics id="S3.SS1.p1.12.m12.1a"><mrow id="S3.SS1.p1.12.m12.1.1" xref="S3.SS1.p1.12.m12.1.1.cmml"><mrow id="S3.SS1.p1.12.m12.1.1.2" xref="S3.SS1.p1.12.m12.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.12.m12.1.1.2.2" xref="S3.SS1.p1.12.m12.1.1.2.2.cmml">𝒴</mi><mo id="S3.SS1.p1.12.m12.1.1.2.1" xref="S3.SS1.p1.12.m12.1.1.2.1.cmml">∩</mo><msub id="S3.SS1.p1.12.m12.1.1.2.3" xref="S3.SS1.p1.12.m12.1.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.12.m12.1.1.2.3.2" xref="S3.SS1.p1.12.m12.1.1.2.3.2.cmml">𝒴</mi><mtext id="S3.SS1.p1.12.m12.1.1.2.3.3" xref="S3.SS1.p1.12.m12.1.1.2.3.3a.cmml">OOD</mtext></msub></mrow><mo id="S3.SS1.p1.12.m12.1.1.1" xref="S3.SS1.p1.12.m12.1.1.1.cmml">=</mo><mi id="S3.SS1.p1.12.m12.1.1.3" mathvariant="normal" xref="S3.SS1.p1.12.m12.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m12.1b"><apply id="S3.SS1.p1.12.m12.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1"><eq id="S3.SS1.p1.12.m12.1.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1.1"></eq><apply id="S3.SS1.p1.12.m12.1.1.2.cmml" xref="S3.SS1.p1.12.m12.1.1.2"><intersect id="S3.SS1.p1.12.m12.1.1.2.1.cmml" xref="S3.SS1.p1.12.m12.1.1.2.1"></intersect><ci id="S3.SS1.p1.12.m12.1.1.2.2.cmml" xref="S3.SS1.p1.12.m12.1.1.2.2">𝒴</ci><apply id="S3.SS1.p1.12.m12.1.1.2.3.cmml" xref="S3.SS1.p1.12.m12.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m12.1.1.2.3.1.cmml" xref="S3.SS1.p1.12.m12.1.1.2.3">subscript</csymbol><ci id="S3.SS1.p1.12.m12.1.1.2.3.2.cmml" xref="S3.SS1.p1.12.m12.1.1.2.3.2">𝒴</ci><ci id="S3.SS1.p1.12.m12.1.1.2.3.3a.cmml" xref="S3.SS1.p1.12.m12.1.1.2.3.3"><mtext id="S3.SS1.p1.12.m12.1.1.2.3.3.cmml" mathsize="70%" xref="S3.SS1.p1.12.m12.1.1.2.3.3">OOD</mtext></ci></apply></apply><emptyset id="S3.SS1.p1.12.m12.1.1.3.cmml" xref="S3.SS1.p1.12.m12.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m12.1c">\mathcal{Y}\cap\mathcal{Y}_{\text{OOD}}=\emptyset</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.12.m12.1d">caligraphic_Y ∩ caligraphic_Y start_POSTSUBSCRIPT OOD end_POSTSUBSCRIPT = ∅</annotation></semantics></math>, OOD samples are drawn from a distribution <math alttext="P_{\text{OOD}}" class="ltx_Math" display="inline" id="S3.SS1.p1.13.m13.1"><semantics id="S3.SS1.p1.13.m13.1a"><msub id="S3.SS1.p1.13.m13.1.1" xref="S3.SS1.p1.13.m13.1.1.cmml"><mi id="S3.SS1.p1.13.m13.1.1.2" xref="S3.SS1.p1.13.m13.1.1.2.cmml">P</mi><mtext id="S3.SS1.p1.13.m13.1.1.3" xref="S3.SS1.p1.13.m13.1.1.3a.cmml">OOD</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m13.1b"><apply id="S3.SS1.p1.13.m13.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.13.m13.1.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1">subscript</csymbol><ci id="S3.SS1.p1.13.m13.1.1.2.cmml" xref="S3.SS1.p1.13.m13.1.1.2">𝑃</ci><ci id="S3.SS1.p1.13.m13.1.1.3a.cmml" xref="S3.SS1.p1.13.m13.1.1.3"><mtext id="S3.SS1.p1.13.m13.1.1.3.cmml" mathsize="70%" xref="S3.SS1.p1.13.m13.1.1.3">OOD</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.13.m13.1c">P_{\text{OOD}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.13.m13.1d">italic_P start_POSTSUBSCRIPT OOD end_POSTSUBSCRIPT</annotation></semantics></math> which correspond to the marginalization on <math alttext="\mathcal{X}" class="ltx_Math" display="inline" id="S3.SS1.p1.14.m14.1"><semantics id="S3.SS1.p1.14.m14.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.14.m14.1.1" xref="S3.SS1.p1.14.m14.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.14.m14.1b"><ci id="S3.SS1.p1.14.m14.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.14.m14.1c">\mathcal{X}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.14.m14.1d">caligraphic_X</annotation></semantics></math> of the joint distribution on <math alttext="\mathcal{X}\times\mathcal{Y}_{\text{OOD}}" class="ltx_Math" display="inline" id="S3.SS1.p1.15.m15.1"><semantics id="S3.SS1.p1.15.m15.1a"><mrow id="S3.SS1.p1.15.m15.1.1" xref="S3.SS1.p1.15.m15.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.15.m15.1.1.2" xref="S3.SS1.p1.15.m15.1.1.2.cmml">𝒳</mi><mo id="S3.SS1.p1.15.m15.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.15.m15.1.1.1.cmml">×</mo><msub id="S3.SS1.p1.15.m15.1.1.3" xref="S3.SS1.p1.15.m15.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.15.m15.1.1.3.2" xref="S3.SS1.p1.15.m15.1.1.3.2.cmml">𝒴</mi><mtext id="S3.SS1.p1.15.m15.1.1.3.3" xref="S3.SS1.p1.15.m15.1.1.3.3a.cmml">OOD</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.15.m15.1b"><apply id="S3.SS1.p1.15.m15.1.1.cmml" xref="S3.SS1.p1.15.m15.1.1"><times id="S3.SS1.p1.15.m15.1.1.1.cmml" xref="S3.SS1.p1.15.m15.1.1.1"></times><ci id="S3.SS1.p1.15.m15.1.1.2.cmml" xref="S3.SS1.p1.15.m15.1.1.2">𝒳</ci><apply id="S3.SS1.p1.15.m15.1.1.3.cmml" xref="S3.SS1.p1.15.m15.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.15.m15.1.1.3.1.cmml" xref="S3.SS1.p1.15.m15.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.15.m15.1.1.3.2.cmml" xref="S3.SS1.p1.15.m15.1.1.3.2">𝒴</ci><ci id="S3.SS1.p1.15.m15.1.1.3.3a.cmml" xref="S3.SS1.p1.15.m15.1.1.3.3"><mtext id="S3.SS1.p1.15.m15.1.1.3.3.cmml" mathsize="70%" xref="S3.SS1.p1.15.m15.1.1.3.3">OOD</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.15.m15.1c">\mathcal{X}\times\mathcal{Y}_{\text{OOD}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.15.m15.1d">caligraphic_X × caligraphic_Y start_POSTSUBSCRIPT OOD end_POSTSUBSCRIPT</annotation></semantics></math>. i.e., they share the same input space <math alttext="\mathcal{X}" class="ltx_Math" display="inline" id="S3.SS1.p1.16.m16.1"><semantics id="S3.SS1.p1.16.m16.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.16.m16.1.1" xref="S3.SS1.p1.16.m16.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.16.m16.1b"><ci id="S3.SS1.p1.16.m16.1.1.cmml" xref="S3.SS1.p1.16.m16.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.16.m16.1c">\mathcal{X}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.16.m16.1d">caligraphic_X</annotation></semantics></math> as in-distribution samples, but have labels outside <math alttext="\mathcal{Y}" class="ltx_Math" display="inline" id="S3.SS1.p1.17.m17.1"><semantics id="S3.SS1.p1.17.m17.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.17.m17.1.1" xref="S3.SS1.p1.17.m17.1.1.cmml">𝒴</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.17.m17.1b"><ci id="S3.SS1.p1.17.m17.1.1.cmml" xref="S3.SS1.p1.17.m17.1.1">𝒴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.17.m17.1c">\mathcal{Y}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.17.m17.1d">caligraphic_Y</annotation></semantics></math>. Shifting from <math alttext="P_{\text{ID}}" class="ltx_Math" display="inline" id="S3.SS1.p1.18.m18.1"><semantics id="S3.SS1.p1.18.m18.1a"><msub id="S3.SS1.p1.18.m18.1.1" xref="S3.SS1.p1.18.m18.1.1.cmml"><mi id="S3.SS1.p1.18.m18.1.1.2" xref="S3.SS1.p1.18.m18.1.1.2.cmml">P</mi><mtext id="S3.SS1.p1.18.m18.1.1.3" xref="S3.SS1.p1.18.m18.1.1.3a.cmml">ID</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.18.m18.1b"><apply id="S3.SS1.p1.18.m18.1.1.cmml" xref="S3.SS1.p1.18.m18.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.18.m18.1.1.1.cmml" xref="S3.SS1.p1.18.m18.1.1">subscript</csymbol><ci id="S3.SS1.p1.18.m18.1.1.2.cmml" xref="S3.SS1.p1.18.m18.1.1.2">𝑃</ci><ci id="S3.SS1.p1.18.m18.1.1.3a.cmml" xref="S3.SS1.p1.18.m18.1.1.3"><mtext id="S3.SS1.p1.18.m18.1.1.3.cmml" mathsize="70%" xref="S3.SS1.p1.18.m18.1.1.3">ID</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.18.m18.1c">P_{\text{ID}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.18.m18.1d">italic_P start_POSTSUBSCRIPT ID end_POSTSUBSCRIPT</annotation></semantics></math> to <math alttext="P_{\text{OOD}}" class="ltx_Math" display="inline" id="S3.SS1.p1.19.m19.1"><semantics id="S3.SS1.p1.19.m19.1a"><msub id="S3.SS1.p1.19.m19.1.1" xref="S3.SS1.p1.19.m19.1.1.cmml"><mi id="S3.SS1.p1.19.m19.1.1.2" xref="S3.SS1.p1.19.m19.1.1.2.cmml">P</mi><mtext id="S3.SS1.p1.19.m19.1.1.3" xref="S3.SS1.p1.19.m19.1.1.3a.cmml">OOD</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.19.m19.1b"><apply id="S3.SS1.p1.19.m19.1.1.cmml" xref="S3.SS1.p1.19.m19.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.19.m19.1.1.1.cmml" xref="S3.SS1.p1.19.m19.1.1">subscript</csymbol><ci id="S3.SS1.p1.19.m19.1.1.2.cmml" xref="S3.SS1.p1.19.m19.1.1.2">𝑃</ci><ci id="S3.SS1.p1.19.m19.1.1.3a.cmml" xref="S3.SS1.p1.19.m19.1.1.3"><mtext id="S3.SS1.p1.19.m19.1.1.3.cmml" mathsize="70%" xref="S3.SS1.p1.19.m19.1.1.3">OOD</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.19.m19.1c">P_{\text{OOD}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.19.m19.1d">italic_P start_POSTSUBSCRIPT OOD end_POSTSUBSCRIPT</annotation></semantics></math> corresponds to a semantic change in label space.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.2">The OOD decision can be made via the function <math alttext="d:\mathcal{X}\rightarrow\{\text{ID},\text{OOD}\}" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.2"><semantics id="S3.SS1.p2.1.m1.2a"><mrow id="S3.SS1.p2.1.m1.2.3" xref="S3.SS1.p2.1.m1.2.3.cmml"><mi id="S3.SS1.p2.1.m1.2.3.2" xref="S3.SS1.p2.1.m1.2.3.2.cmml">d</mi><mo id="S3.SS1.p2.1.m1.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p2.1.m1.2.3.1.cmml">:</mo><mrow id="S3.SS1.p2.1.m1.2.3.3" xref="S3.SS1.p2.1.m1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.1.m1.2.3.3.2" xref="S3.SS1.p2.1.m1.2.3.3.2.cmml">𝒳</mi><mo id="S3.SS1.p2.1.m1.2.3.3.1" stretchy="false" xref="S3.SS1.p2.1.m1.2.3.3.1.cmml">→</mo><mrow id="S3.SS1.p2.1.m1.2.3.3.3.2" xref="S3.SS1.p2.1.m1.2.3.3.3.1.cmml"><mo id="S3.SS1.p2.1.m1.2.3.3.3.2.1" stretchy="false" xref="S3.SS1.p2.1.m1.2.3.3.3.1.cmml">{</mo><mtext id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1a.cmml">ID</mtext><mo id="S3.SS1.p2.1.m1.2.3.3.3.2.2" xref="S3.SS1.p2.1.m1.2.3.3.3.1.cmml">,</mo><mtext id="S3.SS1.p2.1.m1.2.2" xref="S3.SS1.p2.1.m1.2.2a.cmml">OOD</mtext><mo id="S3.SS1.p2.1.m1.2.3.3.3.2.3" stretchy="false" xref="S3.SS1.p2.1.m1.2.3.3.3.1.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.2b"><apply id="S3.SS1.p2.1.m1.2.3.cmml" xref="S3.SS1.p2.1.m1.2.3"><ci id="S3.SS1.p2.1.m1.2.3.1.cmml" xref="S3.SS1.p2.1.m1.2.3.1">:</ci><ci id="S3.SS1.p2.1.m1.2.3.2.cmml" xref="S3.SS1.p2.1.m1.2.3.2">𝑑</ci><apply id="S3.SS1.p2.1.m1.2.3.3.cmml" xref="S3.SS1.p2.1.m1.2.3.3"><ci id="S3.SS1.p2.1.m1.2.3.3.1.cmml" xref="S3.SS1.p2.1.m1.2.3.3.1">→</ci><ci id="S3.SS1.p2.1.m1.2.3.3.2.cmml" xref="S3.SS1.p2.1.m1.2.3.3.2">𝒳</ci><set id="S3.SS1.p2.1.m1.2.3.3.3.1.cmml" xref="S3.SS1.p2.1.m1.2.3.3.3.2"><ci id="S3.SS1.p2.1.m1.1.1a.cmml" xref="S3.SS1.p2.1.m1.1.1"><mtext id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">ID</mtext></ci><ci id="S3.SS1.p2.1.m1.2.2a.cmml" xref="S3.SS1.p2.1.m1.2.2"><mtext id="S3.SS1.p2.1.m1.2.2.cmml" xref="S3.SS1.p2.1.m1.2.2">OOD</mtext></ci></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.2c">d:\mathcal{X}\rightarrow\{\text{ID},\text{OOD}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.2d">italic_d : caligraphic_X → { ID , OOD }</annotation></semantics></math> given a <em class="ltx_emph ltx_font_italic" id="S3.SS1.p2.2.1">score function</em> <math alttext="s:\mathcal{X}\rightarrow\mathbb{R}" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><mrow id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml"><mi id="S3.SS1.p2.2.m2.1.1.2" xref="S3.SS1.p2.2.m2.1.1.2.cmml">s</mi><mo id="S3.SS1.p2.2.m2.1.1.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p2.2.m2.1.1.1.cmml">:</mo><mrow id="S3.SS1.p2.2.m2.1.1.3" xref="S3.SS1.p2.2.m2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.2.m2.1.1.3.2" xref="S3.SS1.p2.2.m2.1.1.3.2.cmml">𝒳</mi><mo id="S3.SS1.p2.2.m2.1.1.3.1" stretchy="false" xref="S3.SS1.p2.2.m2.1.1.3.1.cmml">→</mo><mi id="S3.SS1.p2.2.m2.1.1.3.3" xref="S3.SS1.p2.2.m2.1.1.3.3.cmml">ℝ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"><ci id="S3.SS1.p2.2.m2.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1">:</ci><ci id="S3.SS1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.2">𝑠</ci><apply id="S3.SS1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3"><ci id="S3.SS1.p2.2.m2.1.1.3.1.cmml" xref="S3.SS1.p2.2.m2.1.1.3.1">→</ci><ci id="S3.SS1.p2.2.m2.1.1.3.2.cmml" xref="S3.SS1.p2.2.m2.1.1.3.2">𝒳</ci><ci id="S3.SS1.p2.2.m2.1.1.3.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3.3">ℝ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">s:\mathcal{X}\rightarrow\mathbb{R}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">italic_s : caligraphic_X → blackboard_R</annotation></semantics></math> such that:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S3.SS1.p3">
<table class="ltx_equation ltx_eqn_table" id="S3.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="d(\mathbf{x};s,f)=\begin{cases}\text{ID}&amp;\text{if }s(\mathbf{x};f)\geq\lambda%
\\
\text{OOD}&amp;\text{if }s(\mathbf{x};f)<\lambda\end{cases}" class="ltx_Math" display="block" id="S3.Ex1.m1.7"><semantics id="S3.Ex1.m1.7a"><mrow id="S3.Ex1.m1.7.8" xref="S3.Ex1.m1.7.8.cmml"><mrow id="S3.Ex1.m1.7.8.2" xref="S3.Ex1.m1.7.8.2.cmml"><mi id="S3.Ex1.m1.7.8.2.2" xref="S3.Ex1.m1.7.8.2.2.cmml">d</mi><mo id="S3.Ex1.m1.7.8.2.1" xref="S3.Ex1.m1.7.8.2.1.cmml">⁢</mo><mrow id="S3.Ex1.m1.7.8.2.3.2" xref="S3.Ex1.m1.7.8.2.3.1.cmml"><mo id="S3.Ex1.m1.7.8.2.3.2.1" stretchy="false" xref="S3.Ex1.m1.7.8.2.3.1.cmml">(</mo><mi id="S3.Ex1.m1.5.5" xref="S3.Ex1.m1.5.5.cmml">𝐱</mi><mo id="S3.Ex1.m1.7.8.2.3.2.2" xref="S3.Ex1.m1.7.8.2.3.1.cmml">;</mo><mi id="S3.Ex1.m1.6.6" xref="S3.Ex1.m1.6.6.cmml">s</mi><mo id="S3.Ex1.m1.7.8.2.3.2.3" xref="S3.Ex1.m1.7.8.2.3.1.cmml">,</mo><mi id="S3.Ex1.m1.7.7" xref="S3.Ex1.m1.7.7.cmml">f</mi><mo id="S3.Ex1.m1.7.8.2.3.2.4" stretchy="false" xref="S3.Ex1.m1.7.8.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m1.7.8.1" xref="S3.Ex1.m1.7.8.1.cmml">=</mo><mrow id="S3.Ex1.m1.4.4" xref="S3.Ex1.m1.7.8.3.1.cmml"><mo id="S3.Ex1.m1.4.4.5" xref="S3.Ex1.m1.7.8.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" id="S3.Ex1.m1.4.4.4" rowspacing="0pt" xref="S3.Ex1.m1.7.8.3.1.cmml"><mtr id="S3.Ex1.m1.4.4.4a" xref="S3.Ex1.m1.7.8.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.Ex1.m1.4.4.4b" xref="S3.Ex1.m1.7.8.3.1.cmml"><mtext id="S3.Ex1.m1.1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1a.cmml">ID</mtext></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.Ex1.m1.4.4.4c" xref="S3.Ex1.m1.7.8.3.1.cmml"><mrow id="S3.Ex1.m1.2.2.2.2.2.1" xref="S3.Ex1.m1.2.2.2.2.2.1.cmml"><mrow id="S3.Ex1.m1.2.2.2.2.2.1.4" xref="S3.Ex1.m1.2.2.2.2.2.1.4.cmml"><mtext id="S3.Ex1.m1.2.2.2.2.2.1.4.2" xref="S3.Ex1.m1.2.2.2.2.2.1.4.2a.cmml">if&nbsp;</mtext><mo id="S3.Ex1.m1.2.2.2.2.2.1.4.1" xref="S3.Ex1.m1.2.2.2.2.2.1.4.1.cmml">⁢</mo><mi id="S3.Ex1.m1.2.2.2.2.2.1.4.3" xref="S3.Ex1.m1.2.2.2.2.2.1.4.3.cmml">s</mi><mo id="S3.Ex1.m1.2.2.2.2.2.1.4.1a" xref="S3.Ex1.m1.2.2.2.2.2.1.4.1.cmml">⁢</mo><mrow id="S3.Ex1.m1.2.2.2.2.2.1.4.4.2" xref="S3.Ex1.m1.2.2.2.2.2.1.4.4.1.cmml"><mo id="S3.Ex1.m1.2.2.2.2.2.1.4.4.2.1" stretchy="false" xref="S3.Ex1.m1.2.2.2.2.2.1.4.4.1.cmml">(</mo><mi id="S3.Ex1.m1.2.2.2.2.2.1.1" xref="S3.Ex1.m1.2.2.2.2.2.1.1.cmml">𝐱</mi><mo id="S3.Ex1.m1.2.2.2.2.2.1.4.4.2.2" xref="S3.Ex1.m1.2.2.2.2.2.1.4.4.1.cmml">;</mo><mi id="S3.Ex1.m1.2.2.2.2.2.1.2" xref="S3.Ex1.m1.2.2.2.2.2.1.2.cmml">f</mi><mo id="S3.Ex1.m1.2.2.2.2.2.1.4.4.2.3" stretchy="false" xref="S3.Ex1.m1.2.2.2.2.2.1.4.4.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m1.2.2.2.2.2.1.3" xref="S3.Ex1.m1.2.2.2.2.2.1.3.cmml">≥</mo><mi id="S3.Ex1.m1.2.2.2.2.2.1.5" xref="S3.Ex1.m1.2.2.2.2.2.1.5.cmml">λ</mi></mrow></mtd></mtr><mtr id="S3.Ex1.m1.4.4.4d" xref="S3.Ex1.m1.7.8.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.Ex1.m1.4.4.4e" xref="S3.Ex1.m1.7.8.3.1.cmml"><mtext id="S3.Ex1.m1.3.3.3.3.1.1" xref="S3.Ex1.m1.3.3.3.3.1.1a.cmml">OOD</mtext></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.Ex1.m1.4.4.4f" xref="S3.Ex1.m1.7.8.3.1.cmml"><mrow id="S3.Ex1.m1.4.4.4.4.2.1" xref="S3.Ex1.m1.4.4.4.4.2.1.cmml"><mrow id="S3.Ex1.m1.4.4.4.4.2.1.4" xref="S3.Ex1.m1.4.4.4.4.2.1.4.cmml"><mtext id="S3.Ex1.m1.4.4.4.4.2.1.4.2" xref="S3.Ex1.m1.4.4.4.4.2.1.4.2a.cmml">if&nbsp;</mtext><mo id="S3.Ex1.m1.4.4.4.4.2.1.4.1" xref="S3.Ex1.m1.4.4.4.4.2.1.4.1.cmml">⁢</mo><mi id="S3.Ex1.m1.4.4.4.4.2.1.4.3" xref="S3.Ex1.m1.4.4.4.4.2.1.4.3.cmml">s</mi><mo id="S3.Ex1.m1.4.4.4.4.2.1.4.1a" xref="S3.Ex1.m1.4.4.4.4.2.1.4.1.cmml">⁢</mo><mrow id="S3.Ex1.m1.4.4.4.4.2.1.4.4.2" xref="S3.Ex1.m1.4.4.4.4.2.1.4.4.1.cmml"><mo id="S3.Ex1.m1.4.4.4.4.2.1.4.4.2.1" stretchy="false" xref="S3.Ex1.m1.4.4.4.4.2.1.4.4.1.cmml">(</mo><mi id="S3.Ex1.m1.4.4.4.4.2.1.1" xref="S3.Ex1.m1.4.4.4.4.2.1.1.cmml">𝐱</mi><mo id="S3.Ex1.m1.4.4.4.4.2.1.4.4.2.2" xref="S3.Ex1.m1.4.4.4.4.2.1.4.4.1.cmml">;</mo><mi id="S3.Ex1.m1.4.4.4.4.2.1.2" xref="S3.Ex1.m1.4.4.4.4.2.1.2.cmml">f</mi><mo id="S3.Ex1.m1.4.4.4.4.2.1.4.4.2.3" stretchy="false" xref="S3.Ex1.m1.4.4.4.4.2.1.4.4.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m1.4.4.4.4.2.1.3" xref="S3.Ex1.m1.4.4.4.4.2.1.3.cmml">&lt;</mo><mi id="S3.Ex1.m1.4.4.4.4.2.1.5" xref="S3.Ex1.m1.4.4.4.4.2.1.5.cmml">λ</mi></mrow></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.7b"><apply id="S3.Ex1.m1.7.8.cmml" xref="S3.Ex1.m1.7.8"><eq id="S3.Ex1.m1.7.8.1.cmml" xref="S3.Ex1.m1.7.8.1"></eq><apply id="S3.Ex1.m1.7.8.2.cmml" xref="S3.Ex1.m1.7.8.2"><times id="S3.Ex1.m1.7.8.2.1.cmml" xref="S3.Ex1.m1.7.8.2.1"></times><ci id="S3.Ex1.m1.7.8.2.2.cmml" xref="S3.Ex1.m1.7.8.2.2">𝑑</ci><list id="S3.Ex1.m1.7.8.2.3.1.cmml" xref="S3.Ex1.m1.7.8.2.3.2"><ci id="S3.Ex1.m1.5.5.cmml" xref="S3.Ex1.m1.5.5">𝐱</ci><ci id="S3.Ex1.m1.6.6.cmml" xref="S3.Ex1.m1.6.6">𝑠</ci><ci id="S3.Ex1.m1.7.7.cmml" xref="S3.Ex1.m1.7.7">𝑓</ci></list></apply><apply id="S3.Ex1.m1.7.8.3.1.cmml" xref="S3.Ex1.m1.4.4"><csymbol cd="latexml" id="S3.Ex1.m1.7.8.3.1.1.cmml" xref="S3.Ex1.m1.4.4.5">cases</csymbol><ci id="S3.Ex1.m1.1.1.1.1.1.1a.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1"><mtext id="S3.Ex1.m1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1">ID</mtext></ci><apply id="S3.Ex1.m1.2.2.2.2.2.1.cmml" xref="S3.Ex1.m1.2.2.2.2.2.1"><geq id="S3.Ex1.m1.2.2.2.2.2.1.3.cmml" xref="S3.Ex1.m1.2.2.2.2.2.1.3"></geq><apply id="S3.Ex1.m1.2.2.2.2.2.1.4.cmml" xref="S3.Ex1.m1.2.2.2.2.2.1.4"><times id="S3.Ex1.m1.2.2.2.2.2.1.4.1.cmml" xref="S3.Ex1.m1.2.2.2.2.2.1.4.1"></times><ci id="S3.Ex1.m1.2.2.2.2.2.1.4.2a.cmml" xref="S3.Ex1.m1.2.2.2.2.2.1.4.2"><mtext id="S3.Ex1.m1.2.2.2.2.2.1.4.2.cmml" xref="S3.Ex1.m1.2.2.2.2.2.1.4.2">if&nbsp;</mtext></ci><ci id="S3.Ex1.m1.2.2.2.2.2.1.4.3.cmml" xref="S3.Ex1.m1.2.2.2.2.2.1.4.3">𝑠</ci><list id="S3.Ex1.m1.2.2.2.2.2.1.4.4.1.cmml" xref="S3.Ex1.m1.2.2.2.2.2.1.4.4.2"><ci id="S3.Ex1.m1.2.2.2.2.2.1.1.cmml" xref="S3.Ex1.m1.2.2.2.2.2.1.1">𝐱</ci><ci id="S3.Ex1.m1.2.2.2.2.2.1.2.cmml" xref="S3.Ex1.m1.2.2.2.2.2.1.2">𝑓</ci></list></apply><ci id="S3.Ex1.m1.2.2.2.2.2.1.5.cmml" xref="S3.Ex1.m1.2.2.2.2.2.1.5">𝜆</ci></apply><ci id="S3.Ex1.m1.3.3.3.3.1.1a.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1"><mtext id="S3.Ex1.m1.3.3.3.3.1.1.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1">OOD</mtext></ci><apply id="S3.Ex1.m1.4.4.4.4.2.1.cmml" xref="S3.Ex1.m1.4.4.4.4.2.1"><lt id="S3.Ex1.m1.4.4.4.4.2.1.3.cmml" xref="S3.Ex1.m1.4.4.4.4.2.1.3"></lt><apply id="S3.Ex1.m1.4.4.4.4.2.1.4.cmml" xref="S3.Ex1.m1.4.4.4.4.2.1.4"><times id="S3.Ex1.m1.4.4.4.4.2.1.4.1.cmml" xref="S3.Ex1.m1.4.4.4.4.2.1.4.1"></times><ci id="S3.Ex1.m1.4.4.4.4.2.1.4.2a.cmml" xref="S3.Ex1.m1.4.4.4.4.2.1.4.2"><mtext id="S3.Ex1.m1.4.4.4.4.2.1.4.2.cmml" xref="S3.Ex1.m1.4.4.4.4.2.1.4.2">if&nbsp;</mtext></ci><ci id="S3.Ex1.m1.4.4.4.4.2.1.4.3.cmml" xref="S3.Ex1.m1.4.4.4.4.2.1.4.3">𝑠</ci><list id="S3.Ex1.m1.4.4.4.4.2.1.4.4.1.cmml" xref="S3.Ex1.m1.4.4.4.4.2.1.4.4.2"><ci id="S3.Ex1.m1.4.4.4.4.2.1.1.cmml" xref="S3.Ex1.m1.4.4.4.4.2.1.1">𝐱</ci><ci id="S3.Ex1.m1.4.4.4.4.2.1.2.cmml" xref="S3.Ex1.m1.4.4.4.4.2.1.2">𝑓</ci></list></apply><ci id="S3.Ex1.m1.4.4.4.4.2.1.5.cmml" xref="S3.Ex1.m1.4.4.4.4.2.1.5">𝜆</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.7c">d(\mathbf{x};s,f)=\begin{cases}\text{ID}&amp;\text{if }s(\mathbf{x};f)\geq\lambda%
\\
\text{OOD}&amp;\text{if }s(\mathbf{x};f)&lt;\lambda\end{cases}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1.m1.7d">italic_d ( bold_x ; italic_s , italic_f ) = { start_ROW start_CELL ID end_CELL start_CELL if italic_s ( bold_x ; italic_f ) ≥ italic_λ end_CELL end_ROW start_ROW start_CELL OOD end_CELL start_CELL if italic_s ( bold_x ; italic_f ) &lt; italic_λ end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS1.p4">
<p class="ltx_p" id="S3.SS1.p4.5">where samples with high scores are classified as in-distribution, according to the threshold <math alttext="\lambda" class="ltx_Math" display="inline" id="S3.SS1.p4.1.m1.1"><semantics id="S3.SS1.p4.1.m1.1a"><mi id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b"><ci id="S3.SS1.p4.1.m1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.1.m1.1d">italic_λ</annotation></semantics></math>. For example, to compute the standard FPR95 metric&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib51" title="">51</a>]</cite>, the threshold <math alttext="\lambda" class="ltx_Math" display="inline" id="S3.SS1.p4.2.m2.1"><semantics id="S3.SS1.p4.2.m2.1a"><mi id="S3.SS1.p4.2.m2.1.1" xref="S3.SS1.p4.2.m2.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.2.m2.1b"><ci id="S3.SS1.p4.2.m2.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.2.m2.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.2.m2.1d">italic_λ</annotation></semantics></math> is chosen such that it correctly classifies <math alttext="95\%" class="ltx_Math" display="inline" id="S3.SS1.p4.3.m3.1"><semantics id="S3.SS1.p4.3.m3.1a"><mrow id="S3.SS1.p4.3.m3.1.1" xref="S3.SS1.p4.3.m3.1.1.cmml"><mn id="S3.SS1.p4.3.m3.1.1.2" xref="S3.SS1.p4.3.m3.1.1.2.cmml">95</mn><mo id="S3.SS1.p4.3.m3.1.1.1" xref="S3.SS1.p4.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.3.m3.1b"><apply id="S3.SS1.p4.3.m3.1.1.cmml" xref="S3.SS1.p4.3.m3.1.1"><csymbol cd="latexml" id="S3.SS1.p4.3.m3.1.1.1.cmml" xref="S3.SS1.p4.3.m3.1.1.1">percent</csymbol><cn id="S3.SS1.p4.3.m3.1.1.2.cmml" type="integer" xref="S3.SS1.p4.3.m3.1.1.2">95</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.3.m3.1c">95\%</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.3.m3.1d">95 %</annotation></semantics></math> of ID held-out data.
An ideal OOD score function should capture differences in model outputs between samples drawn from <math alttext="P_{\text{ID}}" class="ltx_Math" display="inline" id="S3.SS1.p4.4.m4.1"><semantics id="S3.SS1.p4.4.m4.1a"><msub id="S3.SS1.p4.4.m4.1.1" xref="S3.SS1.p4.4.m4.1.1.cmml"><mi id="S3.SS1.p4.4.m4.1.1.2" xref="S3.SS1.p4.4.m4.1.1.2.cmml">P</mi><mtext id="S3.SS1.p4.4.m4.1.1.3" xref="S3.SS1.p4.4.m4.1.1.3a.cmml">ID</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.4.m4.1b"><apply id="S3.SS1.p4.4.m4.1.1.cmml" xref="S3.SS1.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.4.m4.1.1.1.cmml" xref="S3.SS1.p4.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p4.4.m4.1.1.2.cmml" xref="S3.SS1.p4.4.m4.1.1.2">𝑃</ci><ci id="S3.SS1.p4.4.m4.1.1.3a.cmml" xref="S3.SS1.p4.4.m4.1.1.3"><mtext id="S3.SS1.p4.4.m4.1.1.3.cmml" mathsize="70%" xref="S3.SS1.p4.4.m4.1.1.3">ID</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.4.m4.1c">P_{\text{ID}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.4.m4.1d">italic_P start_POSTSUBSCRIPT ID end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="P_{\text{OOD}}" class="ltx_Math" display="inline" id="S3.SS1.p4.5.m5.1"><semantics id="S3.SS1.p4.5.m5.1a"><msub id="S3.SS1.p4.5.m5.1.1" xref="S3.SS1.p4.5.m5.1.1.cmml"><mi id="S3.SS1.p4.5.m5.1.1.2" xref="S3.SS1.p4.5.m5.1.1.2.cmml">P</mi><mtext id="S3.SS1.p4.5.m5.1.1.3" xref="S3.SS1.p4.5.m5.1.1.3a.cmml">OOD</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.5.m5.1b"><apply id="S3.SS1.p4.5.m5.1.1.cmml" xref="S3.SS1.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.5.m5.1.1.1.cmml" xref="S3.SS1.p4.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.p4.5.m5.1.1.2.cmml" xref="S3.SS1.p4.5.m5.1.1.2">𝑃</ci><ci id="S3.SS1.p4.5.m5.1.1.3a.cmml" xref="S3.SS1.p4.5.m5.1.1.3"><mtext id="S3.SS1.p4.5.m5.1.1.3.cmml" mathsize="70%" xref="S3.SS1.p4.5.m5.1.1.3">OOD</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.5.m5.1c">P_{\text{OOD}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.5.m5.1d">italic_P start_POSTSUBSCRIPT OOD end_POSTSUBSCRIPT</annotation></semantics></math>, effectively, determining when the model encounters inputs from classes it was not trained on.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span> </span> LAFO (Look Around and Find Out)</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.3">
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l1.1.1.1" style="font-size:80%;">1:</span></span>Sample <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="alg1.l1.m1.1"><semantics id="alg1.l1.m1.1a"><mi id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.1d">bold_x</annotation></semantics></math>, Pretrained model <math alttext="f" class="ltx_Math" display="inline" id="alg1.l1.m2.1"><semantics id="alg1.l1.m2.1a"><mi id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><ci id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">f</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m2.1d">italic_f</annotation></semantics></math>, Mean of the in-distribution features <math alttext="\bm{\mu}_{\text{ID}}" class="ltx_Math" display="inline" id="alg1.l1.m3.1"><semantics id="alg1.l1.m3.1a"><msub id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml"><mi id="alg1.l1.m3.1.1.2" xref="alg1.l1.m3.1.1.2.cmml">𝝁</mi><mtext id="alg1.l1.m3.1.1.3" xref="alg1.l1.m3.1.1.3a.cmml">ID</mtext></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><apply id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1"><csymbol cd="ambiguous" id="alg1.l1.m3.1.1.1.cmml" xref="alg1.l1.m3.1.1">subscript</csymbol><ci id="alg1.l1.m3.1.1.2.cmml" xref="alg1.l1.m3.1.1.2">𝝁</ci><ci id="alg1.l1.m3.1.1.3a.cmml" xref="alg1.l1.m3.1.1.3"><mtext id="alg1.l1.m3.1.1.3.cmml" mathsize="70%" xref="alg1.l1.m3.1.1.3">ID</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">\bm{\mu}_{\text{ID}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m3.1d">bold_italic_μ start_POSTSUBSCRIPT ID end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l2.1.1.1" style="font-size:80%;">2:</span></span>OOD score <math alttext="s" class="ltx_Math" display="inline" id="alg1.l2.m1.1"><semantics id="alg1.l2.m1.1a"><mi id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><ci id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">s</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.1d">italic_s</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l3.1.1.1" style="font-size:80%;">3:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l3.2">function</span>&nbsp;<span class="ltx_text ltx_font_smallcaps" id="alg1.l3.3">LAFO</span>(<math alttext="\mathbf{x},f,\bm{\mu}_{\text{ID}},\alpha" class="ltx_Math" display="inline" id="alg1.l3.m1.4"><semantics id="alg1.l3.m1.4a"><mrow id="alg1.l3.m1.4.4.1" xref="alg1.l3.m1.4.4.2.cmml"><mi id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">𝐱</mi><mo id="alg1.l3.m1.4.4.1.2" xref="alg1.l3.m1.4.4.2.cmml">,</mo><mi id="alg1.l3.m1.2.2" xref="alg1.l3.m1.2.2.cmml">f</mi><mo id="alg1.l3.m1.4.4.1.3" xref="alg1.l3.m1.4.4.2.cmml">,</mo><msub id="alg1.l3.m1.4.4.1.1" xref="alg1.l3.m1.4.4.1.1.cmml"><mi id="alg1.l3.m1.4.4.1.1.2" xref="alg1.l3.m1.4.4.1.1.2.cmml">𝝁</mi><mtext id="alg1.l3.m1.4.4.1.1.3" xref="alg1.l3.m1.4.4.1.1.3a.cmml">ID</mtext></msub><mo id="alg1.l3.m1.4.4.1.4" xref="alg1.l3.m1.4.4.2.cmml">,</mo><mi id="alg1.l3.m1.3.3" xref="alg1.l3.m1.3.3.cmml">α</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.4b"><list id="alg1.l3.m1.4.4.2.cmml" xref="alg1.l3.m1.4.4.1"><ci id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">𝐱</ci><ci id="alg1.l3.m1.2.2.cmml" xref="alg1.l3.m1.2.2">𝑓</ci><apply id="alg1.l3.m1.4.4.1.1.cmml" xref="alg1.l3.m1.4.4.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.4.4.1.1.1.cmml" xref="alg1.l3.m1.4.4.1.1">subscript</csymbol><ci id="alg1.l3.m1.4.4.1.1.2.cmml" xref="alg1.l3.m1.4.4.1.1.2">𝝁</ci><ci id="alg1.l3.m1.4.4.1.1.3a.cmml" xref="alg1.l3.m1.4.4.1.1.3"><mtext id="alg1.l3.m1.4.4.1.1.3.cmml" mathsize="70%" xref="alg1.l3.m1.4.4.1.1.3">ID</mtext></ci></apply><ci id="alg1.l3.m1.3.3.cmml" xref="alg1.l3.m1.3.3">𝛼</ci></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.4c">\mathbf{x},f,\bm{\mu}_{\text{ID}},\alpha</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.4d">bold_x , italic_f , bold_italic_μ start_POSTSUBSCRIPT ID end_POSTSUBSCRIPT , italic_α</annotation></semantics></math>)

</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l4.1.1.1" style="font-size:80%;">4:</span></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<math alttext="\hat{y}\leftarrow\operatorname*{arg\,max}_{y\in\mathcal{Y}}f(\mathbf{x})" class="ltx_Math" display="inline" id="alg1.l4.m1.1"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.2" xref="alg1.l4.m1.1.2.cmml"><mover accent="true" id="alg1.l4.m1.1.2.2" xref="alg1.l4.m1.1.2.2.cmml"><mi id="alg1.l4.m1.1.2.2.2" xref="alg1.l4.m1.1.2.2.2.cmml">y</mi><mo id="alg1.l4.m1.1.2.2.1" xref="alg1.l4.m1.1.2.2.1.cmml">^</mo></mover><mo id="alg1.l4.m1.1.2.1" stretchy="false" xref="alg1.l4.m1.1.2.1.cmml">←</mo><mrow id="alg1.l4.m1.1.2.3" xref="alg1.l4.m1.1.2.3.cmml"><mrow id="alg1.l4.m1.1.2.3.2" xref="alg1.l4.m1.1.2.3.2.cmml"><msub id="alg1.l4.m1.1.2.3.2.1" xref="alg1.l4.m1.1.2.3.2.1.cmml"><mrow id="alg1.l4.m1.1.2.3.2.1.2" xref="alg1.l4.m1.1.2.3.2.1.2.cmml"><mi id="alg1.l4.m1.1.2.3.2.1.2.2" xref="alg1.l4.m1.1.2.3.2.1.2.2.cmml">arg</mi><mo id="alg1.l4.m1.1.2.3.2.1.2.1" lspace="0.170em" xref="alg1.l4.m1.1.2.3.2.1.2.1.cmml">⁢</mo><mi id="alg1.l4.m1.1.2.3.2.1.2.3" xref="alg1.l4.m1.1.2.3.2.1.2.3.cmml">max</mi></mrow><mrow id="alg1.l4.m1.1.2.3.2.1.3" xref="alg1.l4.m1.1.2.3.2.1.3.cmml"><mi id="alg1.l4.m1.1.2.3.2.1.3.2" xref="alg1.l4.m1.1.2.3.2.1.3.2.cmml">y</mi><mo id="alg1.l4.m1.1.2.3.2.1.3.1" xref="alg1.l4.m1.1.2.3.2.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l4.m1.1.2.3.2.1.3.3" xref="alg1.l4.m1.1.2.3.2.1.3.3.cmml">𝒴</mi></mrow></msub><mo id="alg1.l4.m1.1.2.3.2a" xref="alg1.l4.m1.1.2.3.2.cmml">⁡</mo><mi id="alg1.l4.m1.1.2.3.2.2" xref="alg1.l4.m1.1.2.3.2.2.cmml">f</mi></mrow><mo id="alg1.l4.m1.1.2.3.1" xref="alg1.l4.m1.1.2.3.1.cmml">⁢</mo><mrow id="alg1.l4.m1.1.2.3.3.2" xref="alg1.l4.m1.1.2.3.cmml"><mo id="alg1.l4.m1.1.2.3.3.2.1" stretchy="false" xref="alg1.l4.m1.1.2.3.cmml">(</mo><mi id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">𝐱</mi><mo id="alg1.l4.m1.1.2.3.3.2.2" stretchy="false" xref="alg1.l4.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.2.cmml" xref="alg1.l4.m1.1.2"><ci id="alg1.l4.m1.1.2.1.cmml" xref="alg1.l4.m1.1.2.1">←</ci><apply id="alg1.l4.m1.1.2.2.cmml" xref="alg1.l4.m1.1.2.2"><ci id="alg1.l4.m1.1.2.2.1.cmml" xref="alg1.l4.m1.1.2.2.1">^</ci><ci id="alg1.l4.m1.1.2.2.2.cmml" xref="alg1.l4.m1.1.2.2.2">𝑦</ci></apply><apply id="alg1.l4.m1.1.2.3.cmml" xref="alg1.l4.m1.1.2.3"><times id="alg1.l4.m1.1.2.3.1.cmml" xref="alg1.l4.m1.1.2.3.1"></times><apply id="alg1.l4.m1.1.2.3.2.cmml" xref="alg1.l4.m1.1.2.3.2"><apply id="alg1.l4.m1.1.2.3.2.1.cmml" xref="alg1.l4.m1.1.2.3.2.1"><csymbol cd="ambiguous" id="alg1.l4.m1.1.2.3.2.1.1.cmml" xref="alg1.l4.m1.1.2.3.2.1">subscript</csymbol><apply id="alg1.l4.m1.1.2.3.2.1.2.cmml" xref="alg1.l4.m1.1.2.3.2.1.2"><times id="alg1.l4.m1.1.2.3.2.1.2.1.cmml" xref="alg1.l4.m1.1.2.3.2.1.2.1"></times><ci id="alg1.l4.m1.1.2.3.2.1.2.2.cmml" xref="alg1.l4.m1.1.2.3.2.1.2.2">arg</ci><ci id="alg1.l4.m1.1.2.3.2.1.2.3.cmml" xref="alg1.l4.m1.1.2.3.2.1.2.3">max</ci></apply><apply id="alg1.l4.m1.1.2.3.2.1.3.cmml" xref="alg1.l4.m1.1.2.3.2.1.3"><in id="alg1.l4.m1.1.2.3.2.1.3.1.cmml" xref="alg1.l4.m1.1.2.3.2.1.3.1"></in><ci id="alg1.l4.m1.1.2.3.2.1.3.2.cmml" xref="alg1.l4.m1.1.2.3.2.1.3.2">𝑦</ci><ci id="alg1.l4.m1.1.2.3.2.1.3.3.cmml" xref="alg1.l4.m1.1.2.3.2.1.3.3">𝒴</ci></apply></apply><ci id="alg1.l4.m1.1.2.3.2.2.cmml" xref="alg1.l4.m1.1.2.3.2.2">𝑓</ci></apply><ci id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">𝐱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">\hat{y}\leftarrow\operatorname*{arg\,max}_{y\in\mathcal{Y}}f(\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.1d">over^ start_ARG italic_y end_ARG ← start_OPERATOR roman_arg roman_max end_OPERATOR start_POSTSUBSCRIPT italic_y ∈ caligraphic_Y end_POSTSUBSCRIPT italic_f ( bold_x )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l5.3.1.1" style="font-size:80%;">5:</span></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<math alttext="\mathbf{z}=f_{1}\circ\ldots\circ f_{L-1}(\mathbf{x})" class="ltx_Math" display="inline" id="alg1.l5.m1.1"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.2" xref="alg1.l5.m1.1.2.cmml"><mi id="alg1.l5.m1.1.2.2" xref="alg1.l5.m1.1.2.2.cmml">𝐳</mi><mo id="alg1.l5.m1.1.2.1" xref="alg1.l5.m1.1.2.1.cmml">=</mo><mrow id="alg1.l5.m1.1.2.3" xref="alg1.l5.m1.1.2.3.cmml"><mrow id="alg1.l5.m1.1.2.3.2" xref="alg1.l5.m1.1.2.3.2.cmml"><msub id="alg1.l5.m1.1.2.3.2.2" xref="alg1.l5.m1.1.2.3.2.2.cmml"><mi id="alg1.l5.m1.1.2.3.2.2.2" xref="alg1.l5.m1.1.2.3.2.2.2.cmml">f</mi><mn id="alg1.l5.m1.1.2.3.2.2.3" xref="alg1.l5.m1.1.2.3.2.2.3.cmml">1</mn></msub><mo id="alg1.l5.m1.1.2.3.2.1" lspace="0.222em" rspace="0.222em" xref="alg1.l5.m1.1.2.3.2.1.cmml">∘</mo><mi id="alg1.l5.m1.1.2.3.2.3" mathvariant="normal" xref="alg1.l5.m1.1.2.3.2.3.cmml">…</mi><mo id="alg1.l5.m1.1.2.3.2.1a" lspace="0.222em" rspace="0.222em" xref="alg1.l5.m1.1.2.3.2.1.cmml">∘</mo><msub id="alg1.l5.m1.1.2.3.2.4" xref="alg1.l5.m1.1.2.3.2.4.cmml"><mi id="alg1.l5.m1.1.2.3.2.4.2" xref="alg1.l5.m1.1.2.3.2.4.2.cmml">f</mi><mrow id="alg1.l5.m1.1.2.3.2.4.3" xref="alg1.l5.m1.1.2.3.2.4.3.cmml"><mi id="alg1.l5.m1.1.2.3.2.4.3.2" xref="alg1.l5.m1.1.2.3.2.4.3.2.cmml">L</mi><mo id="alg1.l5.m1.1.2.3.2.4.3.1" xref="alg1.l5.m1.1.2.3.2.4.3.1.cmml">−</mo><mn id="alg1.l5.m1.1.2.3.2.4.3.3" xref="alg1.l5.m1.1.2.3.2.4.3.3.cmml">1</mn></mrow></msub></mrow><mo id="alg1.l5.m1.1.2.3.1" xref="alg1.l5.m1.1.2.3.1.cmml">⁢</mo><mrow id="alg1.l5.m1.1.2.3.3.2" xref="alg1.l5.m1.1.2.3.cmml"><mo id="alg1.l5.m1.1.2.3.3.2.1" stretchy="false" xref="alg1.l5.m1.1.2.3.cmml">(</mo><mi id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml">𝐱</mi><mo id="alg1.l5.m1.1.2.3.3.2.2" stretchy="false" xref="alg1.l5.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.2.cmml" xref="alg1.l5.m1.1.2"><eq id="alg1.l5.m1.1.2.1.cmml" xref="alg1.l5.m1.1.2.1"></eq><ci id="alg1.l5.m1.1.2.2.cmml" xref="alg1.l5.m1.1.2.2">𝐳</ci><apply id="alg1.l5.m1.1.2.3.cmml" xref="alg1.l5.m1.1.2.3"><times id="alg1.l5.m1.1.2.3.1.cmml" xref="alg1.l5.m1.1.2.3.1"></times><apply id="alg1.l5.m1.1.2.3.2.cmml" xref="alg1.l5.m1.1.2.3.2"><compose id="alg1.l5.m1.1.2.3.2.1.cmml" xref="alg1.l5.m1.1.2.3.2.1"></compose><apply id="alg1.l5.m1.1.2.3.2.2.cmml" xref="alg1.l5.m1.1.2.3.2.2"><csymbol cd="ambiguous" id="alg1.l5.m1.1.2.3.2.2.1.cmml" xref="alg1.l5.m1.1.2.3.2.2">subscript</csymbol><ci id="alg1.l5.m1.1.2.3.2.2.2.cmml" xref="alg1.l5.m1.1.2.3.2.2.2">𝑓</ci><cn id="alg1.l5.m1.1.2.3.2.2.3.cmml" type="integer" xref="alg1.l5.m1.1.2.3.2.2.3">1</cn></apply><ci id="alg1.l5.m1.1.2.3.2.3.cmml" xref="alg1.l5.m1.1.2.3.2.3">…</ci><apply id="alg1.l5.m1.1.2.3.2.4.cmml" xref="alg1.l5.m1.1.2.3.2.4"><csymbol cd="ambiguous" id="alg1.l5.m1.1.2.3.2.4.1.cmml" xref="alg1.l5.m1.1.2.3.2.4">subscript</csymbol><ci id="alg1.l5.m1.1.2.3.2.4.2.cmml" xref="alg1.l5.m1.1.2.3.2.4.2">𝑓</ci><apply id="alg1.l5.m1.1.2.3.2.4.3.cmml" xref="alg1.l5.m1.1.2.3.2.4.3"><minus id="alg1.l5.m1.1.2.3.2.4.3.1.cmml" xref="alg1.l5.m1.1.2.3.2.4.3.1"></minus><ci id="alg1.l5.m1.1.2.3.2.4.3.2.cmml" xref="alg1.l5.m1.1.2.3.2.4.3.2">𝐿</ci><cn id="alg1.l5.m1.1.2.3.2.4.3.3.cmml" type="integer" xref="alg1.l5.m1.1.2.3.2.4.3.3">1</cn></apply></apply></apply><ci id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1">𝐱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">\mathbf{z}=f_{1}\circ\ldots\circ f_{L-1}(\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.1d">bold_z = italic_f start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∘ … ∘ italic_f start_POSTSUBSCRIPT italic_L - 1 end_POSTSUBSCRIPT ( bold_x )</annotation></semantics></math> <span class="ltx_text" id="alg1.l5.2" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l5.1.m1.1"><semantics id="alg1.l5.1.m1.1a"><mo id="alg1.l5.1.m1.1.1" xref="alg1.l5.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l5.1.m1.1b"><ci id="alg1.l5.1.m1.1.1.cmml" xref="alg1.l5.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.1.m1.1d">▷</annotation></semantics></math> Compute the penultimate last layer features <math alttext="\mathbf{z}" class="ltx_Math" display="inline" id="alg1.l5.2.m2.1"><semantics id="alg1.l5.2.m2.1a"><mi id="alg1.l5.2.m2.1.1" xref="alg1.l5.2.m2.1.1.cmml">𝐳</mi><annotation-xml encoding="MathML-Content" id="alg1.l5.2.m2.1b"><ci id="alg1.l5.2.m2.1.1.cmml" xref="alg1.l5.2.m2.1.1">𝐳</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.2.m2.1c">\mathbf{z}</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.2.m2.1d">bold_z</annotation></semantics></math>
</span>
</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l6.1.1.1" style="font-size:80%;">6:</span></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<math alttext="score\leftarrow-\infty" class="ltx_Math" display="inline" id="alg1.l6.m1.1"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><mrow id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml"><mi id="alg1.l6.m1.1.1.2.2" xref="alg1.l6.m1.1.1.2.2.cmml">s</mi><mo id="alg1.l6.m1.1.1.2.1" xref="alg1.l6.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l6.m1.1.1.2.3" xref="alg1.l6.m1.1.1.2.3.cmml">c</mi><mo id="alg1.l6.m1.1.1.2.1a" xref="alg1.l6.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l6.m1.1.1.2.4" xref="alg1.l6.m1.1.1.2.4.cmml">o</mi><mo id="alg1.l6.m1.1.1.2.1b" xref="alg1.l6.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l6.m1.1.1.2.5" xref="alg1.l6.m1.1.1.2.5.cmml">r</mi><mo id="alg1.l6.m1.1.1.2.1c" xref="alg1.l6.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l6.m1.1.1.2.6" xref="alg1.l6.m1.1.1.2.6.cmml">e</mi></mrow><mo id="alg1.l6.m1.1.1.1" stretchy="false" xref="alg1.l6.m1.1.1.1.cmml">←</mo><mrow id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml"><mo id="alg1.l6.m1.1.1.3a" xref="alg1.l6.m1.1.1.3.cmml">−</mo><mi id="alg1.l6.m1.1.1.3.2" mathvariant="normal" xref="alg1.l6.m1.1.1.3.2.cmml">∞</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><ci id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1">←</ci><apply id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2"><times id="alg1.l6.m1.1.1.2.1.cmml" xref="alg1.l6.m1.1.1.2.1"></times><ci id="alg1.l6.m1.1.1.2.2.cmml" xref="alg1.l6.m1.1.1.2.2">𝑠</ci><ci id="alg1.l6.m1.1.1.2.3.cmml" xref="alg1.l6.m1.1.1.2.3">𝑐</ci><ci id="alg1.l6.m1.1.1.2.4.cmml" xref="alg1.l6.m1.1.1.2.4">𝑜</ci><ci id="alg1.l6.m1.1.1.2.5.cmml" xref="alg1.l6.m1.1.1.2.5">𝑟</ci><ci id="alg1.l6.m1.1.1.2.6.cmml" xref="alg1.l6.m1.1.1.2.6">𝑒</ci></apply><apply id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3"><minus id="alg1.l6.m1.1.1.3.1.cmml" xref="alg1.l6.m1.1.1.3"></minus><infinity id="alg1.l6.m1.1.1.3.2.cmml" xref="alg1.l6.m1.1.1.3.2"></infinity></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">score\leftarrow-\infty</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.1d">italic_s italic_c italic_o italic_r italic_e ← - ∞</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l7.2.1.1" style="font-size:80%;">7:</span></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l7.3">for</span>&nbsp;<math alttext="y^{\prime}\in\mathcal{Y}" class="ltx_Math" display="inline" id="alg1.l7.m1.1"><semantics id="alg1.l7.m1.1a"><mrow id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><msup id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml"><mi id="alg1.l7.m1.1.1.2.2" xref="alg1.l7.m1.1.1.2.2.cmml">y</mi><mo id="alg1.l7.m1.1.1.2.3" xref="alg1.l7.m1.1.1.2.3.cmml">′</mo></msup><mo id="alg1.l7.m1.1.1.1" xref="alg1.l7.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml">𝒴</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><in id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1"></in><apply id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.2.1.cmml" xref="alg1.l7.m1.1.1.2">superscript</csymbol><ci id="alg1.l7.m1.1.1.2.2.cmml" xref="alg1.l7.m1.1.1.2.2">𝑦</ci><ci id="alg1.l7.m1.1.1.2.3.cmml" xref="alg1.l7.m1.1.1.2.3">′</ci></apply><ci id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3">𝒴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">y^{\prime}\in\mathcal{Y}</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m1.1d">italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∈ caligraphic_Y</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l7.4">and</span> <math alttext="y^{\prime}\neq\hat{y}" class="ltx_Math" display="inline" id="alg1.l7.m2.1"><semantics id="alg1.l7.m2.1a"><mrow id="alg1.l7.m2.1.1" xref="alg1.l7.m2.1.1.cmml"><msup id="alg1.l7.m2.1.1.2" xref="alg1.l7.m2.1.1.2.cmml"><mi id="alg1.l7.m2.1.1.2.2" xref="alg1.l7.m2.1.1.2.2.cmml">y</mi><mo id="alg1.l7.m2.1.1.2.3" xref="alg1.l7.m2.1.1.2.3.cmml">′</mo></msup><mo id="alg1.l7.m2.1.1.1" xref="alg1.l7.m2.1.1.1.cmml">≠</mo><mover accent="true" id="alg1.l7.m2.1.1.3" xref="alg1.l7.m2.1.1.3.cmml"><mi id="alg1.l7.m2.1.1.3.2" xref="alg1.l7.m2.1.1.3.2.cmml">y</mi><mo id="alg1.l7.m2.1.1.3.1" xref="alg1.l7.m2.1.1.3.1.cmml">^</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m2.1b"><apply id="alg1.l7.m2.1.1.cmml" xref="alg1.l7.m2.1.1"><neq id="alg1.l7.m2.1.1.1.cmml" xref="alg1.l7.m2.1.1.1"></neq><apply id="alg1.l7.m2.1.1.2.cmml" xref="alg1.l7.m2.1.1.2"><csymbol cd="ambiguous" id="alg1.l7.m2.1.1.2.1.cmml" xref="alg1.l7.m2.1.1.2">superscript</csymbol><ci id="alg1.l7.m2.1.1.2.2.cmml" xref="alg1.l7.m2.1.1.2.2">𝑦</ci><ci id="alg1.l7.m2.1.1.2.3.cmml" xref="alg1.l7.m2.1.1.2.3">′</ci></apply><apply id="alg1.l7.m2.1.1.3.cmml" xref="alg1.l7.m2.1.1.3"><ci id="alg1.l7.m2.1.1.3.1.cmml" xref="alg1.l7.m2.1.1.3.1">^</ci><ci id="alg1.l7.m2.1.1.3.2.cmml" xref="alg1.l7.m2.1.1.3.2">𝑦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m2.1c">y^{\prime}\neq\hat{y}</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m2.1d">italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ≠ over^ start_ARG italic_y end_ARG</annotation></semantics></math>&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l7.5">do</span> <span class="ltx_text" id="alg1.l7.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l7.1.m1.1"><semantics id="alg1.l7.1.m1.1a"><mo id="alg1.l7.1.m1.1.1" xref="alg1.l7.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l7.1.m1.1b"><ci id="alg1.l7.1.m1.1.1.cmml" xref="alg1.l7.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.1.m1.1d">▷</annotation></semantics></math> For each other class
</span>
</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l8.1.1.1" style="font-size:80%;">8:</span></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;compute <math alttext="\mathbf{z}_{db}" class="ltx_Math" display="inline" id="alg1.l8.m1.1"><semantics id="alg1.l8.m1.1a"><msub id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><mi id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml">𝐳</mi><mrow id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml"><mi id="alg1.l8.m1.1.1.3.2" xref="alg1.l8.m1.1.1.3.2.cmml">d</mi><mo id="alg1.l8.m1.1.1.3.1" xref="alg1.l8.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l8.m1.1.1.3.3" xref="alg1.l8.m1.1.1.3.3.cmml">b</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1">subscript</csymbol><ci id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2">𝐳</ci><apply id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3"><times id="alg1.l8.m1.1.1.3.1.cmml" xref="alg1.l8.m1.1.1.3.1"></times><ci id="alg1.l8.m1.1.1.3.2.cmml" xref="alg1.l8.m1.1.1.3.2">𝑑</ci><ci id="alg1.l8.m1.1.1.3.3.cmml" xref="alg1.l8.m1.1.1.3.3">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">\mathbf{z}_{db}</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.1d">bold_z start_POSTSUBSCRIPT italic_d italic_b end_POSTSUBSCRIPT</annotation></semantics></math> as in Eq.<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#S3.E1" title="Equation 1 ‣ 3.3 Features on the Decision Boundary ‣ 3 Method ‣ Look Around and Find Out: OOD Detection with Relative Angles"><span class="ltx_text ltx_ref_tag">1</span></a>
</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l9.1.1.1" style="font-size:80%;">9:</span></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;compute 
<math alttext="\theta_{\hat{y},y^{\prime}}(\mathbf{z})" class="ltx_Math" display="inline" id="alg1.l9.m1.3"><semantics id="alg1.l9.m1.3a"><mrow id="alg1.l9.m1.3.4" xref="alg1.l9.m1.3.4.cmml"><msub id="alg1.l9.m1.3.4.2" xref="alg1.l9.m1.3.4.2.cmml"><mi id="alg1.l9.m1.3.4.2.2" xref="alg1.l9.m1.3.4.2.2.cmml">θ</mi><mrow id="alg1.l9.m1.2.2.2.2" xref="alg1.l9.m1.2.2.2.3.cmml"><mover accent="true" id="alg1.l9.m1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.cmml"><mi id="alg1.l9.m1.1.1.1.1.2" xref="alg1.l9.m1.1.1.1.1.2.cmml">y</mi><mo id="alg1.l9.m1.1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.1.cmml">^</mo></mover><mo id="alg1.l9.m1.2.2.2.2.2" xref="alg1.l9.m1.2.2.2.3.cmml">,</mo><msup id="alg1.l9.m1.2.2.2.2.1" xref="alg1.l9.m1.2.2.2.2.1.cmml"><mi id="alg1.l9.m1.2.2.2.2.1.2" xref="alg1.l9.m1.2.2.2.2.1.2.cmml">y</mi><mo id="alg1.l9.m1.2.2.2.2.1.3" xref="alg1.l9.m1.2.2.2.2.1.3.cmml">′</mo></msup></mrow></msub><mo id="alg1.l9.m1.3.4.1" xref="alg1.l9.m1.3.4.1.cmml">⁢</mo><mrow id="alg1.l9.m1.3.4.3.2" xref="alg1.l9.m1.3.4.cmml"><mo id="alg1.l9.m1.3.4.3.2.1" stretchy="false" xref="alg1.l9.m1.3.4.cmml">(</mo><mi id="alg1.l9.m1.3.3" xref="alg1.l9.m1.3.3.cmml">𝐳</mi><mo id="alg1.l9.m1.3.4.3.2.2" stretchy="false" xref="alg1.l9.m1.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.3b"><apply id="alg1.l9.m1.3.4.cmml" xref="alg1.l9.m1.3.4"><times id="alg1.l9.m1.3.4.1.cmml" xref="alg1.l9.m1.3.4.1"></times><apply id="alg1.l9.m1.3.4.2.cmml" xref="alg1.l9.m1.3.4.2"><csymbol cd="ambiguous" id="alg1.l9.m1.3.4.2.1.cmml" xref="alg1.l9.m1.3.4.2">subscript</csymbol><ci id="alg1.l9.m1.3.4.2.2.cmml" xref="alg1.l9.m1.3.4.2.2">𝜃</ci><list id="alg1.l9.m1.2.2.2.3.cmml" xref="alg1.l9.m1.2.2.2.2"><apply id="alg1.l9.m1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1"><ci id="alg1.l9.m1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1.1">^</ci><ci id="alg1.l9.m1.1.1.1.1.2.cmml" xref="alg1.l9.m1.1.1.1.1.2">𝑦</ci></apply><apply id="alg1.l9.m1.2.2.2.2.1.cmml" xref="alg1.l9.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="alg1.l9.m1.2.2.2.2.1.1.cmml" xref="alg1.l9.m1.2.2.2.2.1">superscript</csymbol><ci id="alg1.l9.m1.2.2.2.2.1.2.cmml" xref="alg1.l9.m1.2.2.2.2.1.2">𝑦</ci><ci id="alg1.l9.m1.2.2.2.2.1.3.cmml" xref="alg1.l9.m1.2.2.2.2.1.3">′</ci></apply></list></apply><ci id="alg1.l9.m1.3.3.cmml" xref="alg1.l9.m1.3.3">𝐳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.3c">\theta_{\hat{y},y^{\prime}}(\mathbf{z})</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m1.3d">italic_θ start_POSTSUBSCRIPT over^ start_ARG italic_y end_ARG , italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( bold_z )</annotation></semantics></math> using Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#S3.E2" title="Equation 2 ‣ 3.3 Features on the Decision Boundary ‣ 3 Method ‣ Look Around and Find Out: OOD Detection with Relative Angles"><span class="ltx_text ltx_ref_tag">2</span></a>
</div>
<div class="ltx_listingline" id="alg1.l10">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l10.1.1.1" style="font-size:80%;">10:</span></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;compute <math alttext="\tilde{s}(\mathbf{z})" class="ltx_Math" display="inline" id="alg1.l10.m1.1"><semantics id="alg1.l10.m1.1a"><mrow id="alg1.l10.m1.1.2" xref="alg1.l10.m1.1.2.cmml"><mover accent="true" id="alg1.l10.m1.1.2.2" xref="alg1.l10.m1.1.2.2.cmml"><mi id="alg1.l10.m1.1.2.2.2" xref="alg1.l10.m1.1.2.2.2.cmml">s</mi><mo id="alg1.l10.m1.1.2.2.1" xref="alg1.l10.m1.1.2.2.1.cmml">~</mo></mover><mo id="alg1.l10.m1.1.2.1" xref="alg1.l10.m1.1.2.1.cmml">⁢</mo><mrow id="alg1.l10.m1.1.2.3.2" xref="alg1.l10.m1.1.2.cmml"><mo id="alg1.l10.m1.1.2.3.2.1" stretchy="false" xref="alg1.l10.m1.1.2.cmml">(</mo><mi id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml">𝐳</mi><mo id="alg1.l10.m1.1.2.3.2.2" stretchy="false" xref="alg1.l10.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.2.cmml" xref="alg1.l10.m1.1.2"><times id="alg1.l10.m1.1.2.1.cmml" xref="alg1.l10.m1.1.2.1"></times><apply id="alg1.l10.m1.1.2.2.cmml" xref="alg1.l10.m1.1.2.2"><ci id="alg1.l10.m1.1.2.2.1.cmml" xref="alg1.l10.m1.1.2.2.1">~</ci><ci id="alg1.l10.m1.1.2.2.2.cmml" xref="alg1.l10.m1.1.2.2.2">𝑠</ci></apply><ci id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1">𝐳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">\tilde{s}(\mathbf{z})</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m1.1d">over~ start_ARG italic_s end_ARG ( bold_z )</annotation></semantics></math> using Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#S3.E3" title="Equation 3 ‣ 3.3 Features on the Decision Boundary ‣ 3 Method ‣ Look Around and Find Out: OOD Detection with Relative Angles"><span class="ltx_text ltx_ref_tag">3</span></a>
</div>
<div class="ltx_listingline" id="alg1.l11">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l11.1.1.1" style="font-size:80%;">11:</span></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l11.2">if</span>&nbsp;<math alttext="\tilde{s}(\mathbf{z})\geq score" class="ltx_Math" display="inline" id="alg1.l11.m1.1"><semantics id="alg1.l11.m1.1a"><mrow id="alg1.l11.m1.1.2" xref="alg1.l11.m1.1.2.cmml"><mrow id="alg1.l11.m1.1.2.2" xref="alg1.l11.m1.1.2.2.cmml"><mover accent="true" id="alg1.l11.m1.1.2.2.2" xref="alg1.l11.m1.1.2.2.2.cmml"><mi id="alg1.l11.m1.1.2.2.2.2" xref="alg1.l11.m1.1.2.2.2.2.cmml">s</mi><mo id="alg1.l11.m1.1.2.2.2.1" xref="alg1.l11.m1.1.2.2.2.1.cmml">~</mo></mover><mo id="alg1.l11.m1.1.2.2.1" xref="alg1.l11.m1.1.2.2.1.cmml">⁢</mo><mrow id="alg1.l11.m1.1.2.2.3.2" xref="alg1.l11.m1.1.2.2.cmml"><mo id="alg1.l11.m1.1.2.2.3.2.1" stretchy="false" xref="alg1.l11.m1.1.2.2.cmml">(</mo><mi id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml">𝐳</mi><mo id="alg1.l11.m1.1.2.2.3.2.2" stretchy="false" xref="alg1.l11.m1.1.2.2.cmml">)</mo></mrow></mrow><mo id="alg1.l11.m1.1.2.1" xref="alg1.l11.m1.1.2.1.cmml">≥</mo><mrow id="alg1.l11.m1.1.2.3" xref="alg1.l11.m1.1.2.3.cmml"><mi id="alg1.l11.m1.1.2.3.2" xref="alg1.l11.m1.1.2.3.2.cmml">s</mi><mo id="alg1.l11.m1.1.2.3.1" xref="alg1.l11.m1.1.2.3.1.cmml">⁢</mo><mi id="alg1.l11.m1.1.2.3.3" xref="alg1.l11.m1.1.2.3.3.cmml">c</mi><mo id="alg1.l11.m1.1.2.3.1a" xref="alg1.l11.m1.1.2.3.1.cmml">⁢</mo><mi id="alg1.l11.m1.1.2.3.4" xref="alg1.l11.m1.1.2.3.4.cmml">o</mi><mo id="alg1.l11.m1.1.2.3.1b" xref="alg1.l11.m1.1.2.3.1.cmml">⁢</mo><mi id="alg1.l11.m1.1.2.3.5" xref="alg1.l11.m1.1.2.3.5.cmml">r</mi><mo id="alg1.l11.m1.1.2.3.1c" xref="alg1.l11.m1.1.2.3.1.cmml">⁢</mo><mi id="alg1.l11.m1.1.2.3.6" xref="alg1.l11.m1.1.2.3.6.cmml">e</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><apply id="alg1.l11.m1.1.2.cmml" xref="alg1.l11.m1.1.2"><geq id="alg1.l11.m1.1.2.1.cmml" xref="alg1.l11.m1.1.2.1"></geq><apply id="alg1.l11.m1.1.2.2.cmml" xref="alg1.l11.m1.1.2.2"><times id="alg1.l11.m1.1.2.2.1.cmml" xref="alg1.l11.m1.1.2.2.1"></times><apply id="alg1.l11.m1.1.2.2.2.cmml" xref="alg1.l11.m1.1.2.2.2"><ci id="alg1.l11.m1.1.2.2.2.1.cmml" xref="alg1.l11.m1.1.2.2.2.1">~</ci><ci id="alg1.l11.m1.1.2.2.2.2.cmml" xref="alg1.l11.m1.1.2.2.2.2">𝑠</ci></apply><ci id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1">𝐳</ci></apply><apply id="alg1.l11.m1.1.2.3.cmml" xref="alg1.l11.m1.1.2.3"><times id="alg1.l11.m1.1.2.3.1.cmml" xref="alg1.l11.m1.1.2.3.1"></times><ci id="alg1.l11.m1.1.2.3.2.cmml" xref="alg1.l11.m1.1.2.3.2">𝑠</ci><ci id="alg1.l11.m1.1.2.3.3.cmml" xref="alg1.l11.m1.1.2.3.3">𝑐</ci><ci id="alg1.l11.m1.1.2.3.4.cmml" xref="alg1.l11.m1.1.2.3.4">𝑜</ci><ci id="alg1.l11.m1.1.2.3.5.cmml" xref="alg1.l11.m1.1.2.3.5">𝑟</ci><ci id="alg1.l11.m1.1.2.3.6.cmml" xref="alg1.l11.m1.1.2.3.6">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">\tilde{s}(\mathbf{z})\geq score</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m1.1d">over~ start_ARG italic_s end_ARG ( bold_z ) ≥ italic_s italic_c italic_o italic_r italic_e</annotation></semantics></math>&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l11.3">then</span>
</div>
<div class="ltx_listingline" id="alg1.l12">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l12.1.1.1" style="font-size:80%;">12:</span></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<math alttext="score=\tilde{s}(\mathbf{z})" class="ltx_Math" display="inline" id="alg1.l12.m1.1"><semantics id="alg1.l12.m1.1a"><mrow id="alg1.l12.m1.1.2" xref="alg1.l12.m1.1.2.cmml"><mrow id="alg1.l12.m1.1.2.2" xref="alg1.l12.m1.1.2.2.cmml"><mi id="alg1.l12.m1.1.2.2.2" xref="alg1.l12.m1.1.2.2.2.cmml">s</mi><mo id="alg1.l12.m1.1.2.2.1" xref="alg1.l12.m1.1.2.2.1.cmml">⁢</mo><mi id="alg1.l12.m1.1.2.2.3" xref="alg1.l12.m1.1.2.2.3.cmml">c</mi><mo id="alg1.l12.m1.1.2.2.1a" xref="alg1.l12.m1.1.2.2.1.cmml">⁢</mo><mi id="alg1.l12.m1.1.2.2.4" xref="alg1.l12.m1.1.2.2.4.cmml">o</mi><mo id="alg1.l12.m1.1.2.2.1b" xref="alg1.l12.m1.1.2.2.1.cmml">⁢</mo><mi id="alg1.l12.m1.1.2.2.5" xref="alg1.l12.m1.1.2.2.5.cmml">r</mi><mo id="alg1.l12.m1.1.2.2.1c" xref="alg1.l12.m1.1.2.2.1.cmml">⁢</mo><mi id="alg1.l12.m1.1.2.2.6" xref="alg1.l12.m1.1.2.2.6.cmml">e</mi></mrow><mo id="alg1.l12.m1.1.2.1" xref="alg1.l12.m1.1.2.1.cmml">=</mo><mrow id="alg1.l12.m1.1.2.3" xref="alg1.l12.m1.1.2.3.cmml"><mover accent="true" id="alg1.l12.m1.1.2.3.2" xref="alg1.l12.m1.1.2.3.2.cmml"><mi id="alg1.l12.m1.1.2.3.2.2" xref="alg1.l12.m1.1.2.3.2.2.cmml">s</mi><mo id="alg1.l12.m1.1.2.3.2.1" xref="alg1.l12.m1.1.2.3.2.1.cmml">~</mo></mover><mo id="alg1.l12.m1.1.2.3.1" xref="alg1.l12.m1.1.2.3.1.cmml">⁢</mo><mrow id="alg1.l12.m1.1.2.3.3.2" xref="alg1.l12.m1.1.2.3.cmml"><mo id="alg1.l12.m1.1.2.3.3.2.1" stretchy="false" xref="alg1.l12.m1.1.2.3.cmml">(</mo><mi id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml">𝐳</mi><mo id="alg1.l12.m1.1.2.3.3.2.2" stretchy="false" xref="alg1.l12.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><apply id="alg1.l12.m1.1.2.cmml" xref="alg1.l12.m1.1.2"><eq id="alg1.l12.m1.1.2.1.cmml" xref="alg1.l12.m1.1.2.1"></eq><apply id="alg1.l12.m1.1.2.2.cmml" xref="alg1.l12.m1.1.2.2"><times id="alg1.l12.m1.1.2.2.1.cmml" xref="alg1.l12.m1.1.2.2.1"></times><ci id="alg1.l12.m1.1.2.2.2.cmml" xref="alg1.l12.m1.1.2.2.2">𝑠</ci><ci id="alg1.l12.m1.1.2.2.3.cmml" xref="alg1.l12.m1.1.2.2.3">𝑐</ci><ci id="alg1.l12.m1.1.2.2.4.cmml" xref="alg1.l12.m1.1.2.2.4">𝑜</ci><ci id="alg1.l12.m1.1.2.2.5.cmml" xref="alg1.l12.m1.1.2.2.5">𝑟</ci><ci id="alg1.l12.m1.1.2.2.6.cmml" xref="alg1.l12.m1.1.2.2.6">𝑒</ci></apply><apply id="alg1.l12.m1.1.2.3.cmml" xref="alg1.l12.m1.1.2.3"><times id="alg1.l12.m1.1.2.3.1.cmml" xref="alg1.l12.m1.1.2.3.1"></times><apply id="alg1.l12.m1.1.2.3.2.cmml" xref="alg1.l12.m1.1.2.3.2"><ci id="alg1.l12.m1.1.2.3.2.1.cmml" xref="alg1.l12.m1.1.2.3.2.1">~</ci><ci id="alg1.l12.m1.1.2.3.2.2.cmml" xref="alg1.l12.m1.1.2.3.2.2">𝑠</ci></apply><ci id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1">𝐳</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">score=\tilde{s}(\mathbf{z})</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.m1.1d">italic_s italic_c italic_o italic_r italic_e = over~ start_ARG italic_s end_ARG ( bold_z )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l13">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l13.1.1.1" style="font-size:80%;">13:</span></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l13.2">end</span>&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l13.3">if</span>
</div>
<div class="ltx_listingline" id="alg1.l14">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l14.1.1.1" style="font-size:80%;">14:</span></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l14.2">end</span>&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l14.3">for</span>
</div>
<div class="ltx_listingline" id="alg1.l15">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l15.2.1.1" style="font-size:80%;">15:</span></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l15.3">return</span> <math alttext="score" class="ltx_Math" display="inline" id="alg1.l15.m1.1"><semantics id="alg1.l15.m1.1a"><mrow id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1.cmml"><mi id="alg1.l15.m1.1.1.2" xref="alg1.l15.m1.1.1.2.cmml">s</mi><mo id="alg1.l15.m1.1.1.1" xref="alg1.l15.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l15.m1.1.1.3" xref="alg1.l15.m1.1.1.3.cmml">c</mi><mo id="alg1.l15.m1.1.1.1a" xref="alg1.l15.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l15.m1.1.1.4" xref="alg1.l15.m1.1.1.4.cmml">o</mi><mo id="alg1.l15.m1.1.1.1b" xref="alg1.l15.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l15.m1.1.1.5" xref="alg1.l15.m1.1.1.5.cmml">r</mi><mo id="alg1.l15.m1.1.1.1c" xref="alg1.l15.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l15.m1.1.1.6" xref="alg1.l15.m1.1.1.6.cmml">e</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.1b"><apply id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1"><times id="alg1.l15.m1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1"></times><ci id="alg1.l15.m1.1.1.2.cmml" xref="alg1.l15.m1.1.1.2">𝑠</ci><ci id="alg1.l15.m1.1.1.3.cmml" xref="alg1.l15.m1.1.1.3">𝑐</ci><ci id="alg1.l15.m1.1.1.4.cmml" xref="alg1.l15.m1.1.1.4">𝑜</ci><ci id="alg1.l15.m1.1.1.5.cmml" xref="alg1.l15.m1.1.1.5">𝑟</ci><ci id="alg1.l15.m1.1.1.6.cmml" xref="alg1.l15.m1.1.1.6">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.1c">score</annotation><annotation encoding="application/x-llamapun" id="alg1.l15.m1.1d">italic_s italic_c italic_o italic_r italic_e</annotation></semantics></math> <span class="ltx_text" id="alg1.l15.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l15.1.m1.1"><semantics id="alg1.l15.1.m1.1a"><mo id="alg1.l15.1.m1.1.1" xref="alg1.l15.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l15.1.m1.1b"><ci id="alg1.l15.1.m1.1.1.cmml" xref="alg1.l15.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l15.1.m1.1d">▷</annotation></semantics></math> Returns the maximum score across all other classes
</span>
</div>
<div class="ltx_listingline" id="alg1.l16">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l16.1.1.1" style="font-size:80%;">16:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l16.2">end</span>&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l16.3">function</span>
</div>
</div>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>OOD Detection with Relative Angles</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">This section presents our OOD score function, which relates the feature representations with the decision boundaries using relative angles in the feature space to discriminate between ID and OOD samples. Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#S2.F1" title="Figure 1 ‣ Score Functions ‣ 2 Related Work ‣ Look Around and Find Out: OOD Detection with Relative Angles"><span class="ltx_text ltx_ref_tag">1</span></a> provides a geometric visualization of our method.
Our approach leverages the geometric relationships between three key points in the feature space: (i) the initial representation of a sample, (ii) its projection onto the decision boundary, and (iii) the mean of in-distribution features.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.1">We propose using the relation between feature representations and decision boundaries by deriving closed-form plane equations for the decision boundaries between any two classes. Specifically, we examine the angle formed between the feature representation vector and its projection onto the decision boundary. However, this angle is sensitive to the choice of origin, creating an ambiguity as the geometric relationship between the feature representation and the decision boundary should be translation-invariant. To address this, we propose to represent features in a reference frame relative to the mean of the in-distribution samples. Therefore, we incorporate in-distribution characteristics by centering around its mean, while ensuring scale and translation invariance.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.1">We observe that the angle between the centered representation and its projection onto the decision boundary is larger for ID data, indicating them requiring higher cost to change their label which captures the model’s confidence. In contrast, for OOD data, angle is smaller since they are expected to be more unstable, as they do not contain strong clues about their predicted classes (see Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#S2.F1" title="Figure 1 ‣ Score Functions ‣ 2 Related Work ‣ Look Around and Find Out: OOD Detection with Relative Angles"><span class="ltx_text ltx_ref_tag">1</span></a> for a conceptual explanation and the ID/OOD histograms in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#A1.SS1" title="A.1 Comparison of Score Distributions: CIFAR-10 vs. OOD Datasets ‣ Appendix A Appendix ‣ Look Around and Find Out: OOD Detection with Relative Angles"><span class="ltx_text ltx_ref_tag">A.1</span></a> for empirical evidence).</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S3.SS2.p4">
<p class="ltx_p" id="S3.SS2.p4.1">Our framework provides a concise scoring with useful properties such as translation and scale invariance. These properties enable LAFO to be used in conjunction with existing activation shaping algorithms and allow for confidence aggregation across different models through score summation.
</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Features on the Decision Boundary</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.11">In this section, we derive the mathematical equations and demonstrate the properties of our score. The model <math alttext="f" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.1"><semantics id="S3.SS3.p1.1.m1.1a"><mi id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">f</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.1d">italic_f</annotation></semantics></math> can be rewritten as a composed function <math alttext="f_{1}\circ...f_{L-1}\circ g" class="ltx_Math" display="inline" id="S3.SS3.p1.2.m2.1"><semantics id="S3.SS3.p1.2.m2.1a"><mrow id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml"><mrow id="S3.SS3.p1.2.m2.1.1.2" xref="S3.SS3.p1.2.m2.1.1.2.cmml"><mrow id="S3.SS3.p1.2.m2.1.1.2.2" xref="S3.SS3.p1.2.m2.1.1.2.2.cmml"><msub id="S3.SS3.p1.2.m2.1.1.2.2.2" xref="S3.SS3.p1.2.m2.1.1.2.2.2.cmml"><mi id="S3.SS3.p1.2.m2.1.1.2.2.2.2" xref="S3.SS3.p1.2.m2.1.1.2.2.2.2.cmml">f</mi><mn id="S3.SS3.p1.2.m2.1.1.2.2.2.3" xref="S3.SS3.p1.2.m2.1.1.2.2.2.3.cmml">1</mn></msub><mo id="S3.SS3.p1.2.m2.1.1.2.2.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p1.2.m2.1.1.2.2.1.cmml">∘</mo><mi id="S3.SS3.p1.2.m2.1.1.2.2.3" mathvariant="normal" xref="S3.SS3.p1.2.m2.1.1.2.2.3.cmml">…</mi></mrow><mo id="S3.SS3.p1.2.m2.1.1.2.1" xref="S3.SS3.p1.2.m2.1.1.2.1.cmml">⁢</mo><msub id="S3.SS3.p1.2.m2.1.1.2.3" xref="S3.SS3.p1.2.m2.1.1.2.3.cmml"><mi id="S3.SS3.p1.2.m2.1.1.2.3.2" xref="S3.SS3.p1.2.m2.1.1.2.3.2.cmml">f</mi><mrow id="S3.SS3.p1.2.m2.1.1.2.3.3" xref="S3.SS3.p1.2.m2.1.1.2.3.3.cmml"><mi id="S3.SS3.p1.2.m2.1.1.2.3.3.2" xref="S3.SS3.p1.2.m2.1.1.2.3.3.2.cmml">L</mi><mo id="S3.SS3.p1.2.m2.1.1.2.3.3.1" xref="S3.SS3.p1.2.m2.1.1.2.3.3.1.cmml">−</mo><mn id="S3.SS3.p1.2.m2.1.1.2.3.3.3" xref="S3.SS3.p1.2.m2.1.1.2.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.SS3.p1.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p1.2.m2.1.1.1.cmml">∘</mo><mi id="S3.SS3.p1.2.m2.1.1.3" xref="S3.SS3.p1.2.m2.1.1.3.cmml">g</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><apply id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1"><compose id="S3.SS3.p1.2.m2.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1.1"></compose><apply id="S3.SS3.p1.2.m2.1.1.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2"><times id="S3.SS3.p1.2.m2.1.1.2.1.cmml" xref="S3.SS3.p1.2.m2.1.1.2.1"></times><apply id="S3.SS3.p1.2.m2.1.1.2.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2.2"><compose id="S3.SS3.p1.2.m2.1.1.2.2.1.cmml" xref="S3.SS3.p1.2.m2.1.1.2.2.1"></compose><apply id="S3.SS3.p1.2.m2.1.1.2.2.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.1.2.2.2.1.cmml" xref="S3.SS3.p1.2.m2.1.1.2.2.2">subscript</csymbol><ci id="S3.SS3.p1.2.m2.1.1.2.2.2.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2.2.2.2">𝑓</ci><cn id="S3.SS3.p1.2.m2.1.1.2.2.2.3.cmml" type="integer" xref="S3.SS3.p1.2.m2.1.1.2.2.2.3">1</cn></apply><ci id="S3.SS3.p1.2.m2.1.1.2.2.3.cmml" xref="S3.SS3.p1.2.m2.1.1.2.2.3">…</ci></apply><apply id="S3.SS3.p1.2.m2.1.1.2.3.cmml" xref="S3.SS3.p1.2.m2.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.1.2.3.1.cmml" xref="S3.SS3.p1.2.m2.1.1.2.3">subscript</csymbol><ci id="S3.SS3.p1.2.m2.1.1.2.3.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2.3.2">𝑓</ci><apply id="S3.SS3.p1.2.m2.1.1.2.3.3.cmml" xref="S3.SS3.p1.2.m2.1.1.2.3.3"><minus id="S3.SS3.p1.2.m2.1.1.2.3.3.1.cmml" xref="S3.SS3.p1.2.m2.1.1.2.3.3.1"></minus><ci id="S3.SS3.p1.2.m2.1.1.2.3.3.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2.3.3.2">𝐿</ci><cn id="S3.SS3.p1.2.m2.1.1.2.3.3.3.cmml" type="integer" xref="S3.SS3.p1.2.m2.1.1.2.3.3.3">1</cn></apply></apply></apply><ci id="S3.SS3.p1.2.m2.1.1.3.cmml" xref="S3.SS3.p1.2.m2.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">f_{1}\circ...f_{L-1}\circ g</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.2.m2.1d">italic_f start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∘ … italic_f start_POSTSUBSCRIPT italic_L - 1 end_POSTSUBSCRIPT ∘ italic_g</annotation></semantics></math>, where <math alttext="L" class="ltx_Math" display="inline" id="S3.SS3.p1.3.m3.1"><semantics id="S3.SS3.p1.3.m3.1a"><mi id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><ci id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.3.m3.1d">italic_L</annotation></semantics></math> is the number of layers and <math alttext="g:\mathbb{R}^{D}\rightarrow\mathbb{R}^{|\mathcal{Y}|}" class="ltx_Math" display="inline" id="S3.SS3.p1.4.m4.1"><semantics id="S3.SS3.p1.4.m4.1a"><mrow id="S3.SS3.p1.4.m4.1.2" xref="S3.SS3.p1.4.m4.1.2.cmml"><mi id="S3.SS3.p1.4.m4.1.2.2" xref="S3.SS3.p1.4.m4.1.2.2.cmml">g</mi><mo id="S3.SS3.p1.4.m4.1.2.1" lspace="0.278em" rspace="0.278em" xref="S3.SS3.p1.4.m4.1.2.1.cmml">:</mo><mrow id="S3.SS3.p1.4.m4.1.2.3" xref="S3.SS3.p1.4.m4.1.2.3.cmml"><msup id="S3.SS3.p1.4.m4.1.2.3.2" xref="S3.SS3.p1.4.m4.1.2.3.2.cmml"><mi id="S3.SS3.p1.4.m4.1.2.3.2.2" xref="S3.SS3.p1.4.m4.1.2.3.2.2.cmml">ℝ</mi><mi id="S3.SS3.p1.4.m4.1.2.3.2.3" xref="S3.SS3.p1.4.m4.1.2.3.2.3.cmml">D</mi></msup><mo id="S3.SS3.p1.4.m4.1.2.3.1" stretchy="false" xref="S3.SS3.p1.4.m4.1.2.3.1.cmml">→</mo><msup id="S3.SS3.p1.4.m4.1.2.3.3" xref="S3.SS3.p1.4.m4.1.2.3.3.cmml"><mi id="S3.SS3.p1.4.m4.1.2.3.3.2" xref="S3.SS3.p1.4.m4.1.2.3.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p1.4.m4.1.1.1.3" xref="S3.SS3.p1.4.m4.1.1.1.2.cmml"><mo id="S3.SS3.p1.4.m4.1.1.1.3.1" stretchy="false" xref="S3.SS3.p1.4.m4.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.4.m4.1.1.1.1" xref="S3.SS3.p1.4.m4.1.1.1.1.cmml">𝒴</mi><mo id="S3.SS3.p1.4.m4.1.1.1.3.2" stretchy="false" xref="S3.SS3.p1.4.m4.1.1.1.2.1.cmml">|</mo></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><apply id="S3.SS3.p1.4.m4.1.2.cmml" xref="S3.SS3.p1.4.m4.1.2"><ci id="S3.SS3.p1.4.m4.1.2.1.cmml" xref="S3.SS3.p1.4.m4.1.2.1">:</ci><ci id="S3.SS3.p1.4.m4.1.2.2.cmml" xref="S3.SS3.p1.4.m4.1.2.2">𝑔</ci><apply id="S3.SS3.p1.4.m4.1.2.3.cmml" xref="S3.SS3.p1.4.m4.1.2.3"><ci id="S3.SS3.p1.4.m4.1.2.3.1.cmml" xref="S3.SS3.p1.4.m4.1.2.3.1">→</ci><apply id="S3.SS3.p1.4.m4.1.2.3.2.cmml" xref="S3.SS3.p1.4.m4.1.2.3.2"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.1.2.3.2.1.cmml" xref="S3.SS3.p1.4.m4.1.2.3.2">superscript</csymbol><ci id="S3.SS3.p1.4.m4.1.2.3.2.2.cmml" xref="S3.SS3.p1.4.m4.1.2.3.2.2">ℝ</ci><ci id="S3.SS3.p1.4.m4.1.2.3.2.3.cmml" xref="S3.SS3.p1.4.m4.1.2.3.2.3">𝐷</ci></apply><apply id="S3.SS3.p1.4.m4.1.2.3.3.cmml" xref="S3.SS3.p1.4.m4.1.2.3.3"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.1.2.3.3.1.cmml" xref="S3.SS3.p1.4.m4.1.2.3.3">superscript</csymbol><ci id="S3.SS3.p1.4.m4.1.2.3.3.2.cmml" xref="S3.SS3.p1.4.m4.1.2.3.3.2">ℝ</ci><apply id="S3.SS3.p1.4.m4.1.1.1.2.cmml" xref="S3.SS3.p1.4.m4.1.1.1.3"><abs id="S3.SS3.p1.4.m4.1.1.1.2.1.cmml" xref="S3.SS3.p1.4.m4.1.1.1.3.1"></abs><ci id="S3.SS3.p1.4.m4.1.1.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1.1.1">𝒴</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">g:\mathbb{R}^{D}\rightarrow\mathbb{R}^{|\mathcal{Y}|}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.4.m4.1d">italic_g : blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT → blackboard_R start_POSTSUPERSCRIPT | caligraphic_Y | end_POSTSUPERSCRIPT</annotation></semantics></math> corresponds to the last layer classification head. The function <math alttext="g(\mathbf{z})=\mathbf{W}\mathbf{z}+\mathbf{b}" class="ltx_Math" display="inline" id="S3.SS3.p1.5.m5.1"><semantics id="S3.SS3.p1.5.m5.1a"><mrow id="S3.SS3.p1.5.m5.1.2" xref="S3.SS3.p1.5.m5.1.2.cmml"><mrow id="S3.SS3.p1.5.m5.1.2.2" xref="S3.SS3.p1.5.m5.1.2.2.cmml"><mi id="S3.SS3.p1.5.m5.1.2.2.2" xref="S3.SS3.p1.5.m5.1.2.2.2.cmml">g</mi><mo id="S3.SS3.p1.5.m5.1.2.2.1" xref="S3.SS3.p1.5.m5.1.2.2.1.cmml">⁢</mo><mrow id="S3.SS3.p1.5.m5.1.2.2.3.2" xref="S3.SS3.p1.5.m5.1.2.2.cmml"><mo id="S3.SS3.p1.5.m5.1.2.2.3.2.1" stretchy="false" xref="S3.SS3.p1.5.m5.1.2.2.cmml">(</mo><mi id="S3.SS3.p1.5.m5.1.1" xref="S3.SS3.p1.5.m5.1.1.cmml">𝐳</mi><mo id="S3.SS3.p1.5.m5.1.2.2.3.2.2" stretchy="false" xref="S3.SS3.p1.5.m5.1.2.2.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p1.5.m5.1.2.1" xref="S3.SS3.p1.5.m5.1.2.1.cmml">=</mo><mrow id="S3.SS3.p1.5.m5.1.2.3" xref="S3.SS3.p1.5.m5.1.2.3.cmml"><mi id="S3.SS3.p1.5.m5.1.2.3.2" xref="S3.SS3.p1.5.m5.1.2.3.2.cmml">𝐖𝐳</mi><mo id="S3.SS3.p1.5.m5.1.2.3.1" xref="S3.SS3.p1.5.m5.1.2.3.1.cmml">+</mo><mi id="S3.SS3.p1.5.m5.1.2.3.3" xref="S3.SS3.p1.5.m5.1.2.3.3.cmml">𝐛</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.1b"><apply id="S3.SS3.p1.5.m5.1.2.cmml" xref="S3.SS3.p1.5.m5.1.2"><eq id="S3.SS3.p1.5.m5.1.2.1.cmml" xref="S3.SS3.p1.5.m5.1.2.1"></eq><apply id="S3.SS3.p1.5.m5.1.2.2.cmml" xref="S3.SS3.p1.5.m5.1.2.2"><times id="S3.SS3.p1.5.m5.1.2.2.1.cmml" xref="S3.SS3.p1.5.m5.1.2.2.1"></times><ci id="S3.SS3.p1.5.m5.1.2.2.2.cmml" xref="S3.SS3.p1.5.m5.1.2.2.2">𝑔</ci><ci id="S3.SS3.p1.5.m5.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1">𝐳</ci></apply><apply id="S3.SS3.p1.5.m5.1.2.3.cmml" xref="S3.SS3.p1.5.m5.1.2.3"><plus id="S3.SS3.p1.5.m5.1.2.3.1.cmml" xref="S3.SS3.p1.5.m5.1.2.3.1"></plus><ci id="S3.SS3.p1.5.m5.1.2.3.2.cmml" xref="S3.SS3.p1.5.m5.1.2.3.2">𝐖𝐳</ci><ci id="S3.SS3.p1.5.m5.1.2.3.3.cmml" xref="S3.SS3.p1.5.m5.1.2.3.3">𝐛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.1c">g(\mathbf{z})=\mathbf{W}\mathbf{z}+\mathbf{b}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.5.m5.1d">italic_g ( bold_z ) = bold_Wz + bold_b</annotation></semantics></math> maps penultimate layer features <math alttext="\mathbf{z}\in\mathbb{R}^{D}" class="ltx_Math" display="inline" id="S3.SS3.p1.6.m6.1"><semantics id="S3.SS3.p1.6.m6.1a"><mrow id="S3.SS3.p1.6.m6.1.1" xref="S3.SS3.p1.6.m6.1.1.cmml"><mi id="S3.SS3.p1.6.m6.1.1.2" xref="S3.SS3.p1.6.m6.1.1.2.cmml">𝐳</mi><mo id="S3.SS3.p1.6.m6.1.1.1" xref="S3.SS3.p1.6.m6.1.1.1.cmml">∈</mo><msup id="S3.SS3.p1.6.m6.1.1.3" xref="S3.SS3.p1.6.m6.1.1.3.cmml"><mi id="S3.SS3.p1.6.m6.1.1.3.2" xref="S3.SS3.p1.6.m6.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS3.p1.6.m6.1.1.3.3" xref="S3.SS3.p1.6.m6.1.1.3.3.cmml">D</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m6.1b"><apply id="S3.SS3.p1.6.m6.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1"><in id="S3.SS3.p1.6.m6.1.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1.1"></in><ci id="S3.SS3.p1.6.m6.1.1.2.cmml" xref="S3.SS3.p1.6.m6.1.1.2">𝐳</ci><apply id="S3.SS3.p1.6.m6.1.1.3.cmml" xref="S3.SS3.p1.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.6.m6.1.1.3.1.cmml" xref="S3.SS3.p1.6.m6.1.1.3">superscript</csymbol><ci id="S3.SS3.p1.6.m6.1.1.3.2.cmml" xref="S3.SS3.p1.6.m6.1.1.3.2">ℝ</ci><ci id="S3.SS3.p1.6.m6.1.1.3.3.cmml" xref="S3.SS3.p1.6.m6.1.1.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m6.1c">\mathbf{z}\in\mathbb{R}^{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.6.m6.1d">bold_z ∈ blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> to the logits space via <math alttext="\mathbf{W}\in\mathbb{R}^{|\mathcal{Y}|\times D}" class="ltx_Math" display="inline" id="S3.SS3.p1.7.m7.1"><semantics id="S3.SS3.p1.7.m7.1a"><mrow id="S3.SS3.p1.7.m7.1.2" xref="S3.SS3.p1.7.m7.1.2.cmml"><mi id="S3.SS3.p1.7.m7.1.2.2" xref="S3.SS3.p1.7.m7.1.2.2.cmml">𝐖</mi><mo id="S3.SS3.p1.7.m7.1.2.1" xref="S3.SS3.p1.7.m7.1.2.1.cmml">∈</mo><msup id="S3.SS3.p1.7.m7.1.2.3" xref="S3.SS3.p1.7.m7.1.2.3.cmml"><mi id="S3.SS3.p1.7.m7.1.2.3.2" xref="S3.SS3.p1.7.m7.1.2.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p1.7.m7.1.1.1" xref="S3.SS3.p1.7.m7.1.1.1.cmml"><mrow id="S3.SS3.p1.7.m7.1.1.1.3.2" xref="S3.SS3.p1.7.m7.1.1.1.3.1.cmml"><mo id="S3.SS3.p1.7.m7.1.1.1.3.2.1" stretchy="false" xref="S3.SS3.p1.7.m7.1.1.1.3.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.7.m7.1.1.1.1" xref="S3.SS3.p1.7.m7.1.1.1.1.cmml">𝒴</mi><mo id="S3.SS3.p1.7.m7.1.1.1.3.2.2" rspace="0.055em" stretchy="false" xref="S3.SS3.p1.7.m7.1.1.1.3.1.1.cmml">|</mo></mrow><mo id="S3.SS3.p1.7.m7.1.1.1.2" rspace="0.222em" xref="S3.SS3.p1.7.m7.1.1.1.2.cmml">×</mo><mi id="S3.SS3.p1.7.m7.1.1.1.4" xref="S3.SS3.p1.7.m7.1.1.1.4.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m7.1b"><apply id="S3.SS3.p1.7.m7.1.2.cmml" xref="S3.SS3.p1.7.m7.1.2"><in id="S3.SS3.p1.7.m7.1.2.1.cmml" xref="S3.SS3.p1.7.m7.1.2.1"></in><ci id="S3.SS3.p1.7.m7.1.2.2.cmml" xref="S3.SS3.p1.7.m7.1.2.2">𝐖</ci><apply id="S3.SS3.p1.7.m7.1.2.3.cmml" xref="S3.SS3.p1.7.m7.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.p1.7.m7.1.2.3.1.cmml" xref="S3.SS3.p1.7.m7.1.2.3">superscript</csymbol><ci id="S3.SS3.p1.7.m7.1.2.3.2.cmml" xref="S3.SS3.p1.7.m7.1.2.3.2">ℝ</ci><apply id="S3.SS3.p1.7.m7.1.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1.1"><times id="S3.SS3.p1.7.m7.1.1.1.2.cmml" xref="S3.SS3.p1.7.m7.1.1.1.2"></times><apply id="S3.SS3.p1.7.m7.1.1.1.3.1.cmml" xref="S3.SS3.p1.7.m7.1.1.1.3.2"><abs id="S3.SS3.p1.7.m7.1.1.1.3.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1.1.3.2.1"></abs><ci id="S3.SS3.p1.7.m7.1.1.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1.1.1">𝒴</ci></apply><ci id="S3.SS3.p1.7.m7.1.1.1.4.cmml" xref="S3.SS3.p1.7.m7.1.1.1.4">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.7.m7.1c">\mathbf{W}\in\mathbb{R}^{|\mathcal{Y}|\times D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.7.m7.1d">bold_W ∈ blackboard_R start_POSTSUPERSCRIPT | caligraphic_Y | × italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{b}\in\mathbb{R}^{|\mathcal{Y}|}" class="ltx_Math" display="inline" id="S3.SS3.p1.8.m8.1"><semantics id="S3.SS3.p1.8.m8.1a"><mrow id="S3.SS3.p1.8.m8.1.2" xref="S3.SS3.p1.8.m8.1.2.cmml"><mi id="S3.SS3.p1.8.m8.1.2.2" xref="S3.SS3.p1.8.m8.1.2.2.cmml">𝐛</mi><mo id="S3.SS3.p1.8.m8.1.2.1" xref="S3.SS3.p1.8.m8.1.2.1.cmml">∈</mo><msup id="S3.SS3.p1.8.m8.1.2.3" xref="S3.SS3.p1.8.m8.1.2.3.cmml"><mi id="S3.SS3.p1.8.m8.1.2.3.2" xref="S3.SS3.p1.8.m8.1.2.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p1.8.m8.1.1.1.3" xref="S3.SS3.p1.8.m8.1.1.1.2.cmml"><mo id="S3.SS3.p1.8.m8.1.1.1.3.1" stretchy="false" xref="S3.SS3.p1.8.m8.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.8.m8.1.1.1.1" xref="S3.SS3.p1.8.m8.1.1.1.1.cmml">𝒴</mi><mo id="S3.SS3.p1.8.m8.1.1.1.3.2" stretchy="false" xref="S3.SS3.p1.8.m8.1.1.1.2.1.cmml">|</mo></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.8.m8.1b"><apply id="S3.SS3.p1.8.m8.1.2.cmml" xref="S3.SS3.p1.8.m8.1.2"><in id="S3.SS3.p1.8.m8.1.2.1.cmml" xref="S3.SS3.p1.8.m8.1.2.1"></in><ci id="S3.SS3.p1.8.m8.1.2.2.cmml" xref="S3.SS3.p1.8.m8.1.2.2">𝐛</ci><apply id="S3.SS3.p1.8.m8.1.2.3.cmml" xref="S3.SS3.p1.8.m8.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.p1.8.m8.1.2.3.1.cmml" xref="S3.SS3.p1.8.m8.1.2.3">superscript</csymbol><ci id="S3.SS3.p1.8.m8.1.2.3.2.cmml" xref="S3.SS3.p1.8.m8.1.2.3.2">ℝ</ci><apply id="S3.SS3.p1.8.m8.1.1.1.2.cmml" xref="S3.SS3.p1.8.m8.1.1.1.3"><abs id="S3.SS3.p1.8.m8.1.1.1.2.1.cmml" xref="S3.SS3.p1.8.m8.1.1.1.3.1"></abs><ci id="S3.SS3.p1.8.m8.1.1.1.1.cmml" xref="S3.SS3.p1.8.m8.1.1.1.1">𝒴</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.8.m8.1c">\mathbf{b}\in\mathbb{R}^{|\mathcal{Y}|}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.8.m8.1d">bold_b ∈ blackboard_R start_POSTSUPERSCRIPT | caligraphic_Y | end_POSTSUPERSCRIPT</annotation></semantics></math>. The decision boundary between any two classes <math alttext="y_{1}" class="ltx_Math" display="inline" id="S3.SS3.p1.9.m9.1"><semantics id="S3.SS3.p1.9.m9.1a"><msub id="S3.SS3.p1.9.m9.1.1" xref="S3.SS3.p1.9.m9.1.1.cmml"><mi id="S3.SS3.p1.9.m9.1.1.2" xref="S3.SS3.p1.9.m9.1.1.2.cmml">y</mi><mn id="S3.SS3.p1.9.m9.1.1.3" xref="S3.SS3.p1.9.m9.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.9.m9.1b"><apply id="S3.SS3.p1.9.m9.1.1.cmml" xref="S3.SS3.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.9.m9.1.1.1.cmml" xref="S3.SS3.p1.9.m9.1.1">subscript</csymbol><ci id="S3.SS3.p1.9.m9.1.1.2.cmml" xref="S3.SS3.p1.9.m9.1.1.2">𝑦</ci><cn id="S3.SS3.p1.9.m9.1.1.3.cmml" type="integer" xref="S3.SS3.p1.9.m9.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.9.m9.1c">y_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.9.m9.1d">italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="y_{2}" class="ltx_Math" display="inline" id="S3.SS3.p1.10.m10.1"><semantics id="S3.SS3.p1.10.m10.1a"><msub id="S3.SS3.p1.10.m10.1.1" xref="S3.SS3.p1.10.m10.1.1.cmml"><mi id="S3.SS3.p1.10.m10.1.1.2" xref="S3.SS3.p1.10.m10.1.1.2.cmml">y</mi><mn id="S3.SS3.p1.10.m10.1.1.3" xref="S3.SS3.p1.10.m10.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.10.m10.1b"><apply id="S3.SS3.p1.10.m10.1.1.cmml" xref="S3.SS3.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.10.m10.1.1.1.cmml" xref="S3.SS3.p1.10.m10.1.1">subscript</csymbol><ci id="S3.SS3.p1.10.m10.1.1.2.cmml" xref="S3.SS3.p1.10.m10.1.1.2">𝑦</ci><cn id="S3.SS3.p1.10.m10.1.1.3.cmml" type="integer" xref="S3.SS3.p1.10.m10.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.10.m10.1c">y_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.10.m10.1d">italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> with <math alttext="y_{1}\neq y_{2}" class="ltx_Math" display="inline" id="S3.SS3.p1.11.m11.1"><semantics id="S3.SS3.p1.11.m11.1a"><mrow id="S3.SS3.p1.11.m11.1.1" xref="S3.SS3.p1.11.m11.1.1.cmml"><msub id="S3.SS3.p1.11.m11.1.1.2" xref="S3.SS3.p1.11.m11.1.1.2.cmml"><mi id="S3.SS3.p1.11.m11.1.1.2.2" xref="S3.SS3.p1.11.m11.1.1.2.2.cmml">y</mi><mn id="S3.SS3.p1.11.m11.1.1.2.3" xref="S3.SS3.p1.11.m11.1.1.2.3.cmml">1</mn></msub><mo id="S3.SS3.p1.11.m11.1.1.1" xref="S3.SS3.p1.11.m11.1.1.1.cmml">≠</mo><msub id="S3.SS3.p1.11.m11.1.1.3" xref="S3.SS3.p1.11.m11.1.1.3.cmml"><mi id="S3.SS3.p1.11.m11.1.1.3.2" xref="S3.SS3.p1.11.m11.1.1.3.2.cmml">y</mi><mn id="S3.SS3.p1.11.m11.1.1.3.3" xref="S3.SS3.p1.11.m11.1.1.3.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.11.m11.1b"><apply id="S3.SS3.p1.11.m11.1.1.cmml" xref="S3.SS3.p1.11.m11.1.1"><neq id="S3.SS3.p1.11.m11.1.1.1.cmml" xref="S3.SS3.p1.11.m11.1.1.1"></neq><apply id="S3.SS3.p1.11.m11.1.1.2.cmml" xref="S3.SS3.p1.11.m11.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.11.m11.1.1.2.1.cmml" xref="S3.SS3.p1.11.m11.1.1.2">subscript</csymbol><ci id="S3.SS3.p1.11.m11.1.1.2.2.cmml" xref="S3.SS3.p1.11.m11.1.1.2.2">𝑦</ci><cn id="S3.SS3.p1.11.m11.1.1.2.3.cmml" type="integer" xref="S3.SS3.p1.11.m11.1.1.2.3">1</cn></apply><apply id="S3.SS3.p1.11.m11.1.1.3.cmml" xref="S3.SS3.p1.11.m11.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.11.m11.1.1.3.1.cmml" xref="S3.SS3.p1.11.m11.1.1.3">subscript</csymbol><ci id="S3.SS3.p1.11.m11.1.1.3.2.cmml" xref="S3.SS3.p1.11.m11.1.1.3.2">𝑦</ci><cn id="S3.SS3.p1.11.m11.1.1.3.3.cmml" type="integer" xref="S3.SS3.p1.11.m11.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.11.m11.1c">y_{1}\neq y_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.11.m11.1d">italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ≠ italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> can be represented as:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx1">
<tbody id="S3.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle DB_{y_{1},y_{2}}=(\mathbf{w}_{y_{1}}-\mathbf{w}_{y_{2}})^{T}%
\mathbf{z}+b_{y_{1}}-b_{y_{2}}=0" class="ltx_Math" display="inline" id="S3.Ex2.m1.3"><semantics id="S3.Ex2.m1.3a"><mrow id="S3.Ex2.m1.3.3" xref="S3.Ex2.m1.3.3.cmml"><mrow id="S3.Ex2.m1.3.3.3" xref="S3.Ex2.m1.3.3.3.cmml"><mi id="S3.Ex2.m1.3.3.3.2" xref="S3.Ex2.m1.3.3.3.2.cmml">D</mi><mo id="S3.Ex2.m1.3.3.3.1" xref="S3.Ex2.m1.3.3.3.1.cmml">⁢</mo><msub id="S3.Ex2.m1.3.3.3.3" xref="S3.Ex2.m1.3.3.3.3.cmml"><mi id="S3.Ex2.m1.3.3.3.3.2" xref="S3.Ex2.m1.3.3.3.3.2.cmml">B</mi><mrow id="S3.Ex2.m1.2.2.2.2" xref="S3.Ex2.m1.2.2.2.3.cmml"><msub id="S3.Ex2.m1.1.1.1.1.1" xref="S3.Ex2.m1.1.1.1.1.1.cmml"><mi id="S3.Ex2.m1.1.1.1.1.1.2" xref="S3.Ex2.m1.1.1.1.1.1.2.cmml">y</mi><mn id="S3.Ex2.m1.1.1.1.1.1.3" xref="S3.Ex2.m1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.Ex2.m1.2.2.2.2.3" xref="S3.Ex2.m1.2.2.2.3.cmml">,</mo><msub id="S3.Ex2.m1.2.2.2.2.2" xref="S3.Ex2.m1.2.2.2.2.2.cmml"><mi id="S3.Ex2.m1.2.2.2.2.2.2" xref="S3.Ex2.m1.2.2.2.2.2.2.cmml">y</mi><mn id="S3.Ex2.m1.2.2.2.2.2.3" xref="S3.Ex2.m1.2.2.2.2.2.3.cmml">2</mn></msub></mrow></msub></mrow><mo id="S3.Ex2.m1.3.3.4" xref="S3.Ex2.m1.3.3.4.cmml">=</mo><mrow id="S3.Ex2.m1.3.3.1" xref="S3.Ex2.m1.3.3.1.cmml"><mrow id="S3.Ex2.m1.3.3.1.1" xref="S3.Ex2.m1.3.3.1.1.cmml"><mrow id="S3.Ex2.m1.3.3.1.1.1" xref="S3.Ex2.m1.3.3.1.1.1.cmml"><msup id="S3.Ex2.m1.3.3.1.1.1.1" xref="S3.Ex2.m1.3.3.1.1.1.1.cmml"><mrow id="S3.Ex2.m1.3.3.1.1.1.1.1.1" xref="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex2.m1.3.3.1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex2.m1.3.3.1.1.1.1.1.1.1" xref="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.cmml"><msub id="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.2.2" xref="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.2.2.cmml">𝐰</mi><msub id="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.2.3" xref="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.2.3.2" xref="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.2.3.2.cmml">y</mi><mn id="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.2.3.3" xref="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></msub></msub><mo id="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.3.2" xref="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.3.2.cmml">𝐰</mi><msub id="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.3.3" xref="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.3.3.2" xref="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.3.3.2.cmml">y</mi><mn id="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.3.3.3" xref="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.3.3.3.cmml">2</mn></msub></msub></mrow><mo id="S3.Ex2.m1.3.3.1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.Ex2.m1.3.3.1.1.1.1.3" xref="S3.Ex2.m1.3.3.1.1.1.1.3.cmml">T</mi></msup><mo id="S3.Ex2.m1.3.3.1.1.1.2" xref="S3.Ex2.m1.3.3.1.1.1.2.cmml">⁢</mo><mi id="S3.Ex2.m1.3.3.1.1.1.3" xref="S3.Ex2.m1.3.3.1.1.1.3.cmml">𝐳</mi></mrow><mo id="S3.Ex2.m1.3.3.1.1.2" xref="S3.Ex2.m1.3.3.1.1.2.cmml">+</mo><msub id="S3.Ex2.m1.3.3.1.1.3" xref="S3.Ex2.m1.3.3.1.1.3.cmml"><mi id="S3.Ex2.m1.3.3.1.1.3.2" xref="S3.Ex2.m1.3.3.1.1.3.2.cmml">b</mi><msub id="S3.Ex2.m1.3.3.1.1.3.3" xref="S3.Ex2.m1.3.3.1.1.3.3.cmml"><mi id="S3.Ex2.m1.3.3.1.1.3.3.2" xref="S3.Ex2.m1.3.3.1.1.3.3.2.cmml">y</mi><mn id="S3.Ex2.m1.3.3.1.1.3.3.3" xref="S3.Ex2.m1.3.3.1.1.3.3.3.cmml">1</mn></msub></msub></mrow><mo id="S3.Ex2.m1.3.3.1.2" xref="S3.Ex2.m1.3.3.1.2.cmml">−</mo><msub id="S3.Ex2.m1.3.3.1.3" xref="S3.Ex2.m1.3.3.1.3.cmml"><mi id="S3.Ex2.m1.3.3.1.3.2" xref="S3.Ex2.m1.3.3.1.3.2.cmml">b</mi><msub id="S3.Ex2.m1.3.3.1.3.3" xref="S3.Ex2.m1.3.3.1.3.3.cmml"><mi id="S3.Ex2.m1.3.3.1.3.3.2" xref="S3.Ex2.m1.3.3.1.3.3.2.cmml">y</mi><mn id="S3.Ex2.m1.3.3.1.3.3.3" xref="S3.Ex2.m1.3.3.1.3.3.3.cmml">2</mn></msub></msub></mrow><mo id="S3.Ex2.m1.3.3.5" xref="S3.Ex2.m1.3.3.5.cmml">=</mo><mn id="S3.Ex2.m1.3.3.6" xref="S3.Ex2.m1.3.3.6.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex2.m1.3b"><apply id="S3.Ex2.m1.3.3.cmml" xref="S3.Ex2.m1.3.3"><and id="S3.Ex2.m1.3.3a.cmml" xref="S3.Ex2.m1.3.3"></and><apply id="S3.Ex2.m1.3.3b.cmml" xref="S3.Ex2.m1.3.3"><eq id="S3.Ex2.m1.3.3.4.cmml" xref="S3.Ex2.m1.3.3.4"></eq><apply id="S3.Ex2.m1.3.3.3.cmml" xref="S3.Ex2.m1.3.3.3"><times id="S3.Ex2.m1.3.3.3.1.cmml" xref="S3.Ex2.m1.3.3.3.1"></times><ci id="S3.Ex2.m1.3.3.3.2.cmml" xref="S3.Ex2.m1.3.3.3.2">𝐷</ci><apply id="S3.Ex2.m1.3.3.3.3.cmml" xref="S3.Ex2.m1.3.3.3.3"><csymbol cd="ambiguous" id="S3.Ex2.m1.3.3.3.3.1.cmml" xref="S3.Ex2.m1.3.3.3.3">subscript</csymbol><ci id="S3.Ex2.m1.3.3.3.3.2.cmml" xref="S3.Ex2.m1.3.3.3.3.2">𝐵</ci><list id="S3.Ex2.m1.2.2.2.3.cmml" xref="S3.Ex2.m1.2.2.2.2"><apply id="S3.Ex2.m1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex2.m1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex2.m1.1.1.1.1.1.2.cmml" xref="S3.Ex2.m1.1.1.1.1.1.2">𝑦</ci><cn id="S3.Ex2.m1.1.1.1.1.1.3.cmml" type="integer" xref="S3.Ex2.m1.1.1.1.1.1.3">1</cn></apply><apply id="S3.Ex2.m1.2.2.2.2.2.cmml" xref="S3.Ex2.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.2.2.2.2.2.1.cmml" xref="S3.Ex2.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.Ex2.m1.2.2.2.2.2.2.cmml" xref="S3.Ex2.m1.2.2.2.2.2.2">𝑦</ci><cn id="S3.Ex2.m1.2.2.2.2.2.3.cmml" type="integer" xref="S3.Ex2.m1.2.2.2.2.2.3">2</cn></apply></list></apply></apply><apply id="S3.Ex2.m1.3.3.1.cmml" xref="S3.Ex2.m1.3.3.1"><minus id="S3.Ex2.m1.3.3.1.2.cmml" xref="S3.Ex2.m1.3.3.1.2"></minus><apply id="S3.Ex2.m1.3.3.1.1.cmml" xref="S3.Ex2.m1.3.3.1.1"><plus id="S3.Ex2.m1.3.3.1.1.2.cmml" xref="S3.Ex2.m1.3.3.1.1.2"></plus><apply id="S3.Ex2.m1.3.3.1.1.1.cmml" xref="S3.Ex2.m1.3.3.1.1.1"><times id="S3.Ex2.m1.3.3.1.1.1.2.cmml" xref="S3.Ex2.m1.3.3.1.1.1.2"></times><apply id="S3.Ex2.m1.3.3.1.1.1.1.cmml" xref="S3.Ex2.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex2.m1.3.3.1.1.1.1.2.cmml" xref="S3.Ex2.m1.3.3.1.1.1.1">superscript</csymbol><apply id="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.3.3.1.1.1.1.1.1"><minus id="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.1"></minus><apply id="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.2.2">𝐰</ci><apply id="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.2.3.2">𝑦</ci><cn id="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.3.2">𝐰</ci><apply id="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.3.3.2">𝑦</ci><cn id="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.3.3.3">2</cn></apply></apply></apply><ci id="S3.Ex2.m1.3.3.1.1.1.1.3.cmml" xref="S3.Ex2.m1.3.3.1.1.1.1.3">𝑇</ci></apply><ci id="S3.Ex2.m1.3.3.1.1.1.3.cmml" xref="S3.Ex2.m1.3.3.1.1.1.3">𝐳</ci></apply><apply id="S3.Ex2.m1.3.3.1.1.3.cmml" xref="S3.Ex2.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.Ex2.m1.3.3.1.1.3.1.cmml" xref="S3.Ex2.m1.3.3.1.1.3">subscript</csymbol><ci id="S3.Ex2.m1.3.3.1.1.3.2.cmml" xref="S3.Ex2.m1.3.3.1.1.3.2">𝑏</ci><apply id="S3.Ex2.m1.3.3.1.1.3.3.cmml" xref="S3.Ex2.m1.3.3.1.1.3.3"><csymbol cd="ambiguous" id="S3.Ex2.m1.3.3.1.1.3.3.1.cmml" xref="S3.Ex2.m1.3.3.1.1.3.3">subscript</csymbol><ci id="S3.Ex2.m1.3.3.1.1.3.3.2.cmml" xref="S3.Ex2.m1.3.3.1.1.3.3.2">𝑦</ci><cn id="S3.Ex2.m1.3.3.1.1.3.3.3.cmml" type="integer" xref="S3.Ex2.m1.3.3.1.1.3.3.3">1</cn></apply></apply></apply><apply id="S3.Ex2.m1.3.3.1.3.cmml" xref="S3.Ex2.m1.3.3.1.3"><csymbol cd="ambiguous" id="S3.Ex2.m1.3.3.1.3.1.cmml" xref="S3.Ex2.m1.3.3.1.3">subscript</csymbol><ci id="S3.Ex2.m1.3.3.1.3.2.cmml" xref="S3.Ex2.m1.3.3.1.3.2">𝑏</ci><apply id="S3.Ex2.m1.3.3.1.3.3.cmml" xref="S3.Ex2.m1.3.3.1.3.3"><csymbol cd="ambiguous" id="S3.Ex2.m1.3.3.1.3.3.1.cmml" xref="S3.Ex2.m1.3.3.1.3.3">subscript</csymbol><ci id="S3.Ex2.m1.3.3.1.3.3.2.cmml" xref="S3.Ex2.m1.3.3.1.3.3.2">𝑦</ci><cn id="S3.Ex2.m1.3.3.1.3.3.3.cmml" type="integer" xref="S3.Ex2.m1.3.3.1.3.3.3">2</cn></apply></apply></apply></apply><apply id="S3.Ex2.m1.3.3c.cmml" xref="S3.Ex2.m1.3.3"><eq id="S3.Ex2.m1.3.3.5.cmml" xref="S3.Ex2.m1.3.3.5"></eq><share href="https://arxiv.org/html/2410.04525v1#S3.Ex2.m1.3.3.1.cmml" id="S3.Ex2.m1.3.3d.cmml" xref="S3.Ex2.m1.3.3"></share><cn id="S3.Ex2.m1.3.3.6.cmml" type="integer" xref="S3.Ex2.m1.3.3.6">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex2.m1.3c">\displaystyle DB_{y_{1},y_{2}}=(\mathbf{w}_{y_{1}}-\mathbf{w}_{y_{2}})^{T}%
\mathbf{z}+b_{y_{1}}-b_{y_{2}}=0</annotation><annotation encoding="application/x-llamapun" id="S3.Ex2.m1.3d">italic_D italic_B start_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT = ( bold_w start_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT - bold_w start_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT bold_z + italic_b start_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT - italic_b start_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT = 0</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.p3">
<p class="ltx_p" id="S3.SS3.p3.11">where <math alttext="\mathbf{w}_{y_{1}}" class="ltx_Math" display="inline" id="S3.SS3.p3.1.m1.1"><semantics id="S3.SS3.p3.1.m1.1a"><msub id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml"><mi id="S3.SS3.p3.1.m1.1.1.2" xref="S3.SS3.p3.1.m1.1.1.2.cmml">𝐰</mi><msub id="S3.SS3.p3.1.m1.1.1.3" xref="S3.SS3.p3.1.m1.1.1.3.cmml"><mi id="S3.SS3.p3.1.m1.1.1.3.2" xref="S3.SS3.p3.1.m1.1.1.3.2.cmml">y</mi><mn id="S3.SS3.p3.1.m1.1.1.3.3" xref="S3.SS3.p3.1.m1.1.1.3.3.cmml">1</mn></msub></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><apply id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p3.1.m1.1.1.2.cmml" xref="S3.SS3.p3.1.m1.1.1.2">𝐰</ci><apply id="S3.SS3.p3.1.m1.1.1.3.cmml" xref="S3.SS3.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.1.1.3.1.cmml" xref="S3.SS3.p3.1.m1.1.1.3">subscript</csymbol><ci id="S3.SS3.p3.1.m1.1.1.3.2.cmml" xref="S3.SS3.p3.1.m1.1.1.3.2">𝑦</ci><cn id="S3.SS3.p3.1.m1.1.1.3.3.cmml" type="integer" xref="S3.SS3.p3.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">\mathbf{w}_{y_{1}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.1.m1.1d">bold_w start_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> (or <math alttext="\mathbf{w}_{y_{2}}" class="ltx_Math" display="inline" id="S3.SS3.p3.2.m2.1"><semantics id="S3.SS3.p3.2.m2.1a"><msub id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml"><mi id="S3.SS3.p3.2.m2.1.1.2" xref="S3.SS3.p3.2.m2.1.1.2.cmml">𝐰</mi><msub id="S3.SS3.p3.2.m2.1.1.3" xref="S3.SS3.p3.2.m2.1.1.3.cmml"><mi id="S3.SS3.p3.2.m2.1.1.3.2" xref="S3.SS3.p3.2.m2.1.1.3.2.cmml">y</mi><mn id="S3.SS3.p3.2.m2.1.1.3.3" xref="S3.SS3.p3.2.m2.1.1.3.3.cmml">2</mn></msub></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b"><apply id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.1.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p3.2.m2.1.1.2.cmml" xref="S3.SS3.p3.2.m2.1.1.2">𝐰</ci><apply id="S3.SS3.p3.2.m2.1.1.3.cmml" xref="S3.SS3.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.1.1.3.1.cmml" xref="S3.SS3.p3.2.m2.1.1.3">subscript</csymbol><ci id="S3.SS3.p3.2.m2.1.1.3.2.cmml" xref="S3.SS3.p3.2.m2.1.1.3.2">𝑦</ci><cn id="S3.SS3.p3.2.m2.1.1.3.3.cmml" type="integer" xref="S3.SS3.p3.2.m2.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">\mathbf{w}_{y_{2}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.2.m2.1d">bold_w start_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>) denotes the the row vectors of <math alttext="\mathbf{W}" class="ltx_Math" display="inline" id="S3.SS3.p3.3.m3.1"><semantics id="S3.SS3.p3.3.m3.1a"><mi id="S3.SS3.p3.3.m3.1.1" xref="S3.SS3.p3.3.m3.1.1.cmml">𝐖</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m3.1b"><ci id="S3.SS3.p3.3.m3.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1">𝐖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m3.1c">\mathbf{W}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.3.m3.1d">bold_W</annotation></semantics></math> corresponding to class <math alttext="{y_{1}}" class="ltx_Math" display="inline" id="S3.SS3.p3.4.m4.1"><semantics id="S3.SS3.p3.4.m4.1a"><msub id="S3.SS3.p3.4.m4.1.1" xref="S3.SS3.p3.4.m4.1.1.cmml"><mi id="S3.SS3.p3.4.m4.1.1.2" xref="S3.SS3.p3.4.m4.1.1.2.cmml">y</mi><mn id="S3.SS3.p3.4.m4.1.1.3" xref="S3.SS3.p3.4.m4.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.4.m4.1b"><apply id="S3.SS3.p3.4.m4.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.4.m4.1.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.p3.4.m4.1.1.2.cmml" xref="S3.SS3.p3.4.m4.1.1.2">𝑦</ci><cn id="S3.SS3.p3.4.m4.1.1.3.cmml" type="integer" xref="S3.SS3.p3.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.4.m4.1c">{y_{1}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.4.m4.1d">italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> (respectively <math alttext="{y_{2}}" class="ltx_Math" display="inline" id="S3.SS3.p3.5.m5.1"><semantics id="S3.SS3.p3.5.m5.1a"><msub id="S3.SS3.p3.5.m5.1.1" xref="S3.SS3.p3.5.m5.1.1.cmml"><mi id="S3.SS3.p3.5.m5.1.1.2" xref="S3.SS3.p3.5.m5.1.1.2.cmml">y</mi><mn id="S3.SS3.p3.5.m5.1.1.3" xref="S3.SS3.p3.5.m5.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.5.m5.1b"><apply id="S3.SS3.p3.5.m5.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.5.m5.1.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.p3.5.m5.1.1.2.cmml" xref="S3.SS3.p3.5.m5.1.1.2">𝑦</ci><cn id="S3.SS3.p3.5.m5.1.1.3.cmml" type="integer" xref="S3.SS3.p3.5.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.5.m5.1c">{y_{2}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.5.m5.1d">italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>) and similarly, <math alttext="b_{y_{1}},b_{y_{2}}" class="ltx_Math" display="inline" id="S3.SS3.p3.6.m6.2"><semantics id="S3.SS3.p3.6.m6.2a"><mrow id="S3.SS3.p3.6.m6.2.2.2" xref="S3.SS3.p3.6.m6.2.2.3.cmml"><msub id="S3.SS3.p3.6.m6.1.1.1.1" xref="S3.SS3.p3.6.m6.1.1.1.1.cmml"><mi id="S3.SS3.p3.6.m6.1.1.1.1.2" xref="S3.SS3.p3.6.m6.1.1.1.1.2.cmml">b</mi><msub id="S3.SS3.p3.6.m6.1.1.1.1.3" xref="S3.SS3.p3.6.m6.1.1.1.1.3.cmml"><mi id="S3.SS3.p3.6.m6.1.1.1.1.3.2" xref="S3.SS3.p3.6.m6.1.1.1.1.3.2.cmml">y</mi><mn id="S3.SS3.p3.6.m6.1.1.1.1.3.3" xref="S3.SS3.p3.6.m6.1.1.1.1.3.3.cmml">1</mn></msub></msub><mo id="S3.SS3.p3.6.m6.2.2.2.3" xref="S3.SS3.p3.6.m6.2.2.3.cmml">,</mo><msub id="S3.SS3.p3.6.m6.2.2.2.2" xref="S3.SS3.p3.6.m6.2.2.2.2.cmml"><mi id="S3.SS3.p3.6.m6.2.2.2.2.2" xref="S3.SS3.p3.6.m6.2.2.2.2.2.cmml">b</mi><msub id="S3.SS3.p3.6.m6.2.2.2.2.3" xref="S3.SS3.p3.6.m6.2.2.2.2.3.cmml"><mi id="S3.SS3.p3.6.m6.2.2.2.2.3.2" xref="S3.SS3.p3.6.m6.2.2.2.2.3.2.cmml">y</mi><mn id="S3.SS3.p3.6.m6.2.2.2.2.3.3" xref="S3.SS3.p3.6.m6.2.2.2.2.3.3.cmml">2</mn></msub></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.6.m6.2b"><list id="S3.SS3.p3.6.m6.2.2.3.cmml" xref="S3.SS3.p3.6.m6.2.2.2"><apply id="S3.SS3.p3.6.m6.1.1.1.1.cmml" xref="S3.SS3.p3.6.m6.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.6.m6.1.1.1.1.1.cmml" xref="S3.SS3.p3.6.m6.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p3.6.m6.1.1.1.1.2.cmml" xref="S3.SS3.p3.6.m6.1.1.1.1.2">𝑏</ci><apply id="S3.SS3.p3.6.m6.1.1.1.1.3.cmml" xref="S3.SS3.p3.6.m6.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.6.m6.1.1.1.1.3.1.cmml" xref="S3.SS3.p3.6.m6.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.p3.6.m6.1.1.1.1.3.2.cmml" xref="S3.SS3.p3.6.m6.1.1.1.1.3.2">𝑦</ci><cn id="S3.SS3.p3.6.m6.1.1.1.1.3.3.cmml" type="integer" xref="S3.SS3.p3.6.m6.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.SS3.p3.6.m6.2.2.2.2.cmml" xref="S3.SS3.p3.6.m6.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p3.6.m6.2.2.2.2.1.cmml" xref="S3.SS3.p3.6.m6.2.2.2.2">subscript</csymbol><ci id="S3.SS3.p3.6.m6.2.2.2.2.2.cmml" xref="S3.SS3.p3.6.m6.2.2.2.2.2">𝑏</ci><apply id="S3.SS3.p3.6.m6.2.2.2.2.3.cmml" xref="S3.SS3.p3.6.m6.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.p3.6.m6.2.2.2.2.3.1.cmml" xref="S3.SS3.p3.6.m6.2.2.2.2.3">subscript</csymbol><ci id="S3.SS3.p3.6.m6.2.2.2.2.3.2.cmml" xref="S3.SS3.p3.6.m6.2.2.2.2.3.2">𝑦</ci><cn id="S3.SS3.p3.6.m6.2.2.2.2.3.3.cmml" type="integer" xref="S3.SS3.p3.6.m6.2.2.2.2.3.3">2</cn></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.6.m6.2c">b_{y_{1}},b_{y_{2}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.6.m6.2d">italic_b start_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , italic_b start_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> are the bias values corresponding to classes <math alttext="y_{1}" class="ltx_Math" display="inline" id="S3.SS3.p3.7.m7.1"><semantics id="S3.SS3.p3.7.m7.1a"><msub id="S3.SS3.p3.7.m7.1.1" xref="S3.SS3.p3.7.m7.1.1.cmml"><mi id="S3.SS3.p3.7.m7.1.1.2" xref="S3.SS3.p3.7.m7.1.1.2.cmml">y</mi><mn id="S3.SS3.p3.7.m7.1.1.3" xref="S3.SS3.p3.7.m7.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.7.m7.1b"><apply id="S3.SS3.p3.7.m7.1.1.cmml" xref="S3.SS3.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.7.m7.1.1.1.cmml" xref="S3.SS3.p3.7.m7.1.1">subscript</csymbol><ci id="S3.SS3.p3.7.m7.1.1.2.cmml" xref="S3.SS3.p3.7.m7.1.1.2">𝑦</ci><cn id="S3.SS3.p3.7.m7.1.1.3.cmml" type="integer" xref="S3.SS3.p3.7.m7.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.7.m7.1c">y_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.7.m7.1d">italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="y_{2}" class="ltx_Math" display="inline" id="S3.SS3.p3.8.m8.1"><semantics id="S3.SS3.p3.8.m8.1a"><msub id="S3.SS3.p3.8.m8.1.1" xref="S3.SS3.p3.8.m8.1.1.cmml"><mi id="S3.SS3.p3.8.m8.1.1.2" xref="S3.SS3.p3.8.m8.1.1.2.cmml">y</mi><mn id="S3.SS3.p3.8.m8.1.1.3" xref="S3.SS3.p3.8.m8.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.8.m8.1b"><apply id="S3.SS3.p3.8.m8.1.1.cmml" xref="S3.SS3.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.8.m8.1.1.1.cmml" xref="S3.SS3.p3.8.m8.1.1">subscript</csymbol><ci id="S3.SS3.p3.8.m8.1.1.2.cmml" xref="S3.SS3.p3.8.m8.1.1.2">𝑦</ci><cn id="S3.SS3.p3.8.m8.1.1.3.cmml" type="integer" xref="S3.SS3.p3.8.m8.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.8.m8.1c">y_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.8.m8.1d">italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>.
Intuitively, given a fixed classifier, this equation is satisfied for all <math alttext="\mathbf{z}" class="ltx_Math" display="inline" id="S3.SS3.p3.9.m9.1"><semantics id="S3.SS3.p3.9.m9.1a"><mi id="S3.SS3.p3.9.m9.1.1" xref="S3.SS3.p3.9.m9.1.1.cmml">𝐳</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.9.m9.1b"><ci id="S3.SS3.p3.9.m9.1.1.cmml" xref="S3.SS3.p3.9.m9.1.1">𝐳</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.9.m9.1c">\mathbf{z}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.9.m9.1d">bold_z</annotation></semantics></math>’s such that their corresponding logits for class <math alttext="y_{1}" class="ltx_Math" display="inline" id="S3.SS3.p3.10.m10.1"><semantics id="S3.SS3.p3.10.m10.1a"><msub id="S3.SS3.p3.10.m10.1.1" xref="S3.SS3.p3.10.m10.1.1.cmml"><mi id="S3.SS3.p3.10.m10.1.1.2" xref="S3.SS3.p3.10.m10.1.1.2.cmml">y</mi><mn id="S3.SS3.p3.10.m10.1.1.3" xref="S3.SS3.p3.10.m10.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.10.m10.1b"><apply id="S3.SS3.p3.10.m10.1.1.cmml" xref="S3.SS3.p3.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.10.m10.1.1.1.cmml" xref="S3.SS3.p3.10.m10.1.1">subscript</csymbol><ci id="S3.SS3.p3.10.m10.1.1.2.cmml" xref="S3.SS3.p3.10.m10.1.1.2">𝑦</ci><cn id="S3.SS3.p3.10.m10.1.1.3.cmml" type="integer" xref="S3.SS3.p3.10.m10.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.10.m10.1c">y_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.10.m10.1d">italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="y_{2}" class="ltx_Math" display="inline" id="S3.SS3.p3.11.m11.1"><semantics id="S3.SS3.p3.11.m11.1a"><msub id="S3.SS3.p3.11.m11.1.1" xref="S3.SS3.p3.11.m11.1.1.cmml"><mi id="S3.SS3.p3.11.m11.1.1.2" xref="S3.SS3.p3.11.m11.1.1.2.cmml">y</mi><mn id="S3.SS3.p3.11.m11.1.1.3" xref="S3.SS3.p3.11.m11.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.11.m11.1b"><apply id="S3.SS3.p3.11.m11.1.1.cmml" xref="S3.SS3.p3.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.11.m11.1.1.1.cmml" xref="S3.SS3.p3.11.m11.1.1">subscript</csymbol><ci id="S3.SS3.p3.11.m11.1.1.2.cmml" xref="S3.SS3.p3.11.m11.1.1.2">𝑦</ci><cn id="S3.SS3.p3.11.m11.1.1.3.cmml" type="integer" xref="S3.SS3.p3.11.m11.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.11.m11.1c">y_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.11.m11.1d">italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> are equal. Then, feature representations can be projected orthogonally onto the hyperplane that defines the decision boundary:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S3.SS3.p4">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx2">
<tbody id="S3.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{z}_{db}=\mathbf{z}-\frac{(\mathbf{w}_{y_{1}}-\mathbf{w}_{%
y_{2}})^{T}\mathbf{z}+(b_{y_{1}}-b_{y_{2}})}{||\mathbf{w}_{y_{1}}-\mathbf{w}_{%
y_{2}}||^{2}}(\mathbf{w}_{y_{1}}-\mathbf{w}_{y_{2}})" class="ltx_Math" display="inline" id="S3.E1.m1.4"><semantics id="S3.E1.m1.4a"><mrow id="S3.E1.m1.4.4" xref="S3.E1.m1.4.4.cmml"><msub id="S3.E1.m1.4.4.3" xref="S3.E1.m1.4.4.3.cmml"><mi id="S3.E1.m1.4.4.3.2" xref="S3.E1.m1.4.4.3.2.cmml">𝐳</mi><mrow id="S3.E1.m1.4.4.3.3" xref="S3.E1.m1.4.4.3.3.cmml"><mi id="S3.E1.m1.4.4.3.3.2" xref="S3.E1.m1.4.4.3.3.2.cmml">d</mi><mo id="S3.E1.m1.4.4.3.3.1" xref="S3.E1.m1.4.4.3.3.1.cmml">⁢</mo><mi id="S3.E1.m1.4.4.3.3.3" xref="S3.E1.m1.4.4.3.3.3.cmml">b</mi></mrow></msub><mo id="S3.E1.m1.4.4.2" xref="S3.E1.m1.4.4.2.cmml">=</mo><mrow id="S3.E1.m1.4.4.1" xref="S3.E1.m1.4.4.1.cmml"><mi id="S3.E1.m1.4.4.1.3" xref="S3.E1.m1.4.4.1.3.cmml">𝐳</mi><mo id="S3.E1.m1.4.4.1.2" xref="S3.E1.m1.4.4.1.2.cmml">−</mo><mrow id="S3.E1.m1.4.4.1.1" xref="S3.E1.m1.4.4.1.1.cmml"><mstyle displaystyle="true" id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml"><mfrac id="S3.E1.m1.3.3a" xref="S3.E1.m1.3.3.cmml"><mrow id="S3.E1.m1.2.2.2" xref="S3.E1.m1.2.2.2.cmml"><mrow id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><msup id="S3.E1.m1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E1.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E1.m1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.cmml">𝐰</mi><msub id="S3.E1.m1.1.1.1.1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.2.cmml">y</mi><mn id="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></msub></msub><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.E1.m1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.2.cmml">𝐰</mi><msub id="S3.E1.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.2.cmml">y</mi><mn id="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.cmml">2</mn></msub></msub></mrow><mo id="S3.E1.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.E1.m1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.3.cmml">T</mi></msup><mo id="S3.E1.m1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E1.m1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.3.cmml">𝐳</mi></mrow><mo id="S3.E1.m1.2.2.2.3" xref="S3.E1.m1.2.2.2.3.cmml">+</mo><mrow id="S3.E1.m1.2.2.2.2.1" xref="S3.E1.m1.2.2.2.2.1.1.cmml"><mo id="S3.E1.m1.2.2.2.2.1.2" stretchy="false" xref="S3.E1.m1.2.2.2.2.1.1.cmml">(</mo><mrow id="S3.E1.m1.2.2.2.2.1.1" xref="S3.E1.m1.2.2.2.2.1.1.cmml"><msub id="S3.E1.m1.2.2.2.2.1.1.2" xref="S3.E1.m1.2.2.2.2.1.1.2.cmml"><mi id="S3.E1.m1.2.2.2.2.1.1.2.2" xref="S3.E1.m1.2.2.2.2.1.1.2.2.cmml">b</mi><msub id="S3.E1.m1.2.2.2.2.1.1.2.3" xref="S3.E1.m1.2.2.2.2.1.1.2.3.cmml"><mi id="S3.E1.m1.2.2.2.2.1.1.2.3.2" xref="S3.E1.m1.2.2.2.2.1.1.2.3.2.cmml">y</mi><mn id="S3.E1.m1.2.2.2.2.1.1.2.3.3" xref="S3.E1.m1.2.2.2.2.1.1.2.3.3.cmml">1</mn></msub></msub><mo id="S3.E1.m1.2.2.2.2.1.1.1" xref="S3.E1.m1.2.2.2.2.1.1.1.cmml">−</mo><msub id="S3.E1.m1.2.2.2.2.1.1.3" xref="S3.E1.m1.2.2.2.2.1.1.3.cmml"><mi id="S3.E1.m1.2.2.2.2.1.1.3.2" xref="S3.E1.m1.2.2.2.2.1.1.3.2.cmml">b</mi><msub id="S3.E1.m1.2.2.2.2.1.1.3.3" xref="S3.E1.m1.2.2.2.2.1.1.3.3.cmml"><mi id="S3.E1.m1.2.2.2.2.1.1.3.3.2" xref="S3.E1.m1.2.2.2.2.1.1.3.3.2.cmml">y</mi><mn id="S3.E1.m1.2.2.2.2.1.1.3.3.3" xref="S3.E1.m1.2.2.2.2.1.1.3.3.3.cmml">2</mn></msub></msub></mrow><mo id="S3.E1.m1.2.2.2.2.1.3" stretchy="false" xref="S3.E1.m1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow><msup id="S3.E1.m1.3.3.3" xref="S3.E1.m1.3.3.3.cmml"><mrow id="S3.E1.m1.3.3.3.1.1" xref="S3.E1.m1.3.3.3.1.2.cmml"><mo id="S3.E1.m1.3.3.3.1.1.2" stretchy="false" xref="S3.E1.m1.3.3.3.1.2.1.cmml">‖</mo><mrow id="S3.E1.m1.3.3.3.1.1.1" xref="S3.E1.m1.3.3.3.1.1.1.cmml"><msub id="S3.E1.m1.3.3.3.1.1.1.2" xref="S3.E1.m1.3.3.3.1.1.1.2.cmml"><mi id="S3.E1.m1.3.3.3.1.1.1.2.2" xref="S3.E1.m1.3.3.3.1.1.1.2.2.cmml">𝐰</mi><msub id="S3.E1.m1.3.3.3.1.1.1.2.3" xref="S3.E1.m1.3.3.3.1.1.1.2.3.cmml"><mi id="S3.E1.m1.3.3.3.1.1.1.2.3.2" xref="S3.E1.m1.3.3.3.1.1.1.2.3.2.cmml">y</mi><mn id="S3.E1.m1.3.3.3.1.1.1.2.3.3" xref="S3.E1.m1.3.3.3.1.1.1.2.3.3.cmml">1</mn></msub></msub><mo id="S3.E1.m1.3.3.3.1.1.1.1" xref="S3.E1.m1.3.3.3.1.1.1.1.cmml">−</mo><msub id="S3.E1.m1.3.3.3.1.1.1.3" xref="S3.E1.m1.3.3.3.1.1.1.3.cmml"><mi id="S3.E1.m1.3.3.3.1.1.1.3.2" xref="S3.E1.m1.3.3.3.1.1.1.3.2.cmml">𝐰</mi><msub id="S3.E1.m1.3.3.3.1.1.1.3.3" xref="S3.E1.m1.3.3.3.1.1.1.3.3.cmml"><mi id="S3.E1.m1.3.3.3.1.1.1.3.3.2" xref="S3.E1.m1.3.3.3.1.1.1.3.3.2.cmml">y</mi><mn id="S3.E1.m1.3.3.3.1.1.1.3.3.3" xref="S3.E1.m1.3.3.3.1.1.1.3.3.3.cmml">2</mn></msub></msub></mrow><mo id="S3.E1.m1.3.3.3.1.1.3" stretchy="false" xref="S3.E1.m1.3.3.3.1.2.1.cmml">‖</mo></mrow><mn id="S3.E1.m1.3.3.3.3" xref="S3.E1.m1.3.3.3.3.cmml">2</mn></msup></mfrac></mstyle><mo id="S3.E1.m1.4.4.1.1.2" xref="S3.E1.m1.4.4.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.4.4.1.1.1.1" xref="S3.E1.m1.4.4.1.1.1.1.1.cmml"><mo id="S3.E1.m1.4.4.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.4.4.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.4.4.1.1.1.1.1" xref="S3.E1.m1.4.4.1.1.1.1.1.cmml"><msub id="S3.E1.m1.4.4.1.1.1.1.1.2" xref="S3.E1.m1.4.4.1.1.1.1.1.2.cmml"><mi id="S3.E1.m1.4.4.1.1.1.1.1.2.2" xref="S3.E1.m1.4.4.1.1.1.1.1.2.2.cmml">𝐰</mi><msub id="S3.E1.m1.4.4.1.1.1.1.1.2.3" xref="S3.E1.m1.4.4.1.1.1.1.1.2.3.cmml"><mi id="S3.E1.m1.4.4.1.1.1.1.1.2.3.2" xref="S3.E1.m1.4.4.1.1.1.1.1.2.3.2.cmml">y</mi><mn id="S3.E1.m1.4.4.1.1.1.1.1.2.3.3" xref="S3.E1.m1.4.4.1.1.1.1.1.2.3.3.cmml">1</mn></msub></msub><mo id="S3.E1.m1.4.4.1.1.1.1.1.1" xref="S3.E1.m1.4.4.1.1.1.1.1.1.cmml">−</mo><msub id="S3.E1.m1.4.4.1.1.1.1.1.3" xref="S3.E1.m1.4.4.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.4.4.1.1.1.1.1.3.2" xref="S3.E1.m1.4.4.1.1.1.1.1.3.2.cmml">𝐰</mi><msub id="S3.E1.m1.4.4.1.1.1.1.1.3.3" xref="S3.E1.m1.4.4.1.1.1.1.1.3.3.cmml"><mi id="S3.E1.m1.4.4.1.1.1.1.1.3.3.2" xref="S3.E1.m1.4.4.1.1.1.1.1.3.3.2.cmml">y</mi><mn id="S3.E1.m1.4.4.1.1.1.1.1.3.3.3" xref="S3.E1.m1.4.4.1.1.1.1.1.3.3.3.cmml">2</mn></msub></msub></mrow><mo id="S3.E1.m1.4.4.1.1.1.1.3" stretchy="false" xref="S3.E1.m1.4.4.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.4b"><apply id="S3.E1.m1.4.4.cmml" xref="S3.E1.m1.4.4"><eq id="S3.E1.m1.4.4.2.cmml" xref="S3.E1.m1.4.4.2"></eq><apply id="S3.E1.m1.4.4.3.cmml" xref="S3.E1.m1.4.4.3"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.3.1.cmml" xref="S3.E1.m1.4.4.3">subscript</csymbol><ci id="S3.E1.m1.4.4.3.2.cmml" xref="S3.E1.m1.4.4.3.2">𝐳</ci><apply id="S3.E1.m1.4.4.3.3.cmml" xref="S3.E1.m1.4.4.3.3"><times id="S3.E1.m1.4.4.3.3.1.cmml" xref="S3.E1.m1.4.4.3.3.1"></times><ci id="S3.E1.m1.4.4.3.3.2.cmml" xref="S3.E1.m1.4.4.3.3.2">𝑑</ci><ci id="S3.E1.m1.4.4.3.3.3.cmml" xref="S3.E1.m1.4.4.3.3.3">𝑏</ci></apply></apply><apply id="S3.E1.m1.4.4.1.cmml" xref="S3.E1.m1.4.4.1"><minus id="S3.E1.m1.4.4.1.2.cmml" xref="S3.E1.m1.4.4.1.2"></minus><ci id="S3.E1.m1.4.4.1.3.cmml" xref="S3.E1.m1.4.4.1.3">𝐳</ci><apply id="S3.E1.m1.4.4.1.1.cmml" xref="S3.E1.m1.4.4.1.1"><times id="S3.E1.m1.4.4.1.1.2.cmml" xref="S3.E1.m1.4.4.1.1.2"></times><apply id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3"><divide id="S3.E1.m1.3.3.4.cmml" xref="S3.E1.m1.3.3"></divide><apply id="S3.E1.m1.2.2.2.cmml" xref="S3.E1.m1.2.2.2"><plus id="S3.E1.m1.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.3"></plus><apply id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1"><times id="S3.E1.m1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.2"></times><apply id="S3.E1.m1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1"><minus id="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.2">𝐰</ci><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.2">𝑦</ci><cn id="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.2">𝐰</ci><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.2">𝑦</ci><cn id="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3">2</cn></apply></apply></apply><ci id="S3.E1.m1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.3">𝑇</ci></apply><ci id="S3.E1.m1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.3">𝐳</ci></apply><apply id="S3.E1.m1.2.2.2.2.1.1.cmml" xref="S3.E1.m1.2.2.2.2.1"><minus id="S3.E1.m1.2.2.2.2.1.1.1.cmml" xref="S3.E1.m1.2.2.2.2.1.1.1"></minus><apply id="S3.E1.m1.2.2.2.2.1.1.2.cmml" xref="S3.E1.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.1.1.2.1.cmml" xref="S3.E1.m1.2.2.2.2.1.1.2">subscript</csymbol><ci id="S3.E1.m1.2.2.2.2.1.1.2.2.cmml" xref="S3.E1.m1.2.2.2.2.1.1.2.2">𝑏</ci><apply id="S3.E1.m1.2.2.2.2.1.1.2.3.cmml" xref="S3.E1.m1.2.2.2.2.1.1.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.1.1.2.3.1.cmml" xref="S3.E1.m1.2.2.2.2.1.1.2.3">subscript</csymbol><ci id="S3.E1.m1.2.2.2.2.1.1.2.3.2.cmml" xref="S3.E1.m1.2.2.2.2.1.1.2.3.2">𝑦</ci><cn id="S3.E1.m1.2.2.2.2.1.1.2.3.3.cmml" type="integer" xref="S3.E1.m1.2.2.2.2.1.1.2.3.3">1</cn></apply></apply><apply id="S3.E1.m1.2.2.2.2.1.1.3.cmml" xref="S3.E1.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.1.1.3.1.cmml" xref="S3.E1.m1.2.2.2.2.1.1.3">subscript</csymbol><ci id="S3.E1.m1.2.2.2.2.1.1.3.2.cmml" xref="S3.E1.m1.2.2.2.2.1.1.3.2">𝑏</ci><apply id="S3.E1.m1.2.2.2.2.1.1.3.3.cmml" xref="S3.E1.m1.2.2.2.2.1.1.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.1.1.3.3.1.cmml" xref="S3.E1.m1.2.2.2.2.1.1.3.3">subscript</csymbol><ci id="S3.E1.m1.2.2.2.2.1.1.3.3.2.cmml" xref="S3.E1.m1.2.2.2.2.1.1.3.3.2">𝑦</ci><cn id="S3.E1.m1.2.2.2.2.1.1.3.3.3.cmml" type="integer" xref="S3.E1.m1.2.2.2.2.1.1.3.3.3">2</cn></apply></apply></apply></apply><apply id="S3.E1.m1.3.3.3.cmml" xref="S3.E1.m1.3.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.3.2.cmml" xref="S3.E1.m1.3.3.3">superscript</csymbol><apply id="S3.E1.m1.3.3.3.1.2.cmml" xref="S3.E1.m1.3.3.3.1.1"><csymbol cd="latexml" id="S3.E1.m1.3.3.3.1.2.1.cmml" xref="S3.E1.m1.3.3.3.1.1.2">norm</csymbol><apply id="S3.E1.m1.3.3.3.1.1.1.cmml" xref="S3.E1.m1.3.3.3.1.1.1"><minus id="S3.E1.m1.3.3.3.1.1.1.1.cmml" xref="S3.E1.m1.3.3.3.1.1.1.1"></minus><apply id="S3.E1.m1.3.3.3.1.1.1.2.cmml" xref="S3.E1.m1.3.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.3.1.1.1.2.1.cmml" xref="S3.E1.m1.3.3.3.1.1.1.2">subscript</csymbol><ci id="S3.E1.m1.3.3.3.1.1.1.2.2.cmml" xref="S3.E1.m1.3.3.3.1.1.1.2.2">𝐰</ci><apply id="S3.E1.m1.3.3.3.1.1.1.2.3.cmml" xref="S3.E1.m1.3.3.3.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.3.1.1.1.2.3.1.cmml" xref="S3.E1.m1.3.3.3.1.1.1.2.3">subscript</csymbol><ci id="S3.E1.m1.3.3.3.1.1.1.2.3.2.cmml" xref="S3.E1.m1.3.3.3.1.1.1.2.3.2">𝑦</ci><cn id="S3.E1.m1.3.3.3.1.1.1.2.3.3.cmml" type="integer" xref="S3.E1.m1.3.3.3.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.E1.m1.3.3.3.1.1.1.3.cmml" xref="S3.E1.m1.3.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.3.1.1.1.3.1.cmml" xref="S3.E1.m1.3.3.3.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.3.3.3.1.1.1.3.2.cmml" xref="S3.E1.m1.3.3.3.1.1.1.3.2">𝐰</ci><apply id="S3.E1.m1.3.3.3.1.1.1.3.3.cmml" xref="S3.E1.m1.3.3.3.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.3.1.1.1.3.3.1.cmml" xref="S3.E1.m1.3.3.3.1.1.1.3.3">subscript</csymbol><ci id="S3.E1.m1.3.3.3.1.1.1.3.3.2.cmml" xref="S3.E1.m1.3.3.3.1.1.1.3.3.2">𝑦</ci><cn id="S3.E1.m1.3.3.3.1.1.1.3.3.3.cmml" type="integer" xref="S3.E1.m1.3.3.3.1.1.1.3.3.3">2</cn></apply></apply></apply></apply><cn id="S3.E1.m1.3.3.3.3.cmml" type="integer" xref="S3.E1.m1.3.3.3.3">2</cn></apply></apply><apply id="S3.E1.m1.4.4.1.1.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1"><minus id="S3.E1.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1"></minus><apply id="S3.E1.m1.4.4.1.1.1.1.1.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E1.m1.4.4.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.2.2">𝐰</ci><apply id="S3.E1.m1.4.4.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.1.1.1.2.3.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E1.m1.4.4.1.1.1.1.1.2.3.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.2.3.2">𝑦</ci><cn id="S3.E1.m1.4.4.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.E1.m1.4.4.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.E1.m1.4.4.1.1.1.1.1.3.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.4.4.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.3.2">𝐰</ci><apply id="S3.E1.m1.4.4.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.1.1.1.3.3.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E1.m1.4.4.1.1.1.1.1.3.3.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.3.3.2">𝑦</ci><cn id="S3.E1.m1.4.4.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S3.E1.m1.4.4.1.1.1.1.1.3.3.3">2</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.4c">\displaystyle\mathbf{z}_{db}=\mathbf{z}-\frac{(\mathbf{w}_{y_{1}}-\mathbf{w}_{%
y_{2}})^{T}\mathbf{z}+(b_{y_{1}}-b_{y_{2}})}{||\mathbf{w}_{y_{1}}-\mathbf{w}_{%
y_{2}}||^{2}}(\mathbf{w}_{y_{1}}-\mathbf{w}_{y_{2}})</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.4d">bold_z start_POSTSUBSCRIPT italic_d italic_b end_POSTSUBSCRIPT = bold_z - divide start_ARG ( bold_w start_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT - bold_w start_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT bold_z + ( italic_b start_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT - italic_b start_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) end_ARG start_ARG | | bold_w start_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT - bold_w start_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT | | start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG ( bold_w start_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT - bold_w start_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.p5">
<p class="ltx_p" id="S3.SS3.p5.9">Let <math alttext="\bm{\mu_{\text{ID}}}\in\mathbb{R}^{D}" class="ltx_Math" display="inline" id="S3.SS3.p5.1.m1.1"><semantics id="S3.SS3.p5.1.m1.1a"><mrow id="S3.SS3.p5.1.m1.1.1" xref="S3.SS3.p5.1.m1.1.1.cmml"><msub id="S3.SS3.p5.1.m1.1.1.2" xref="S3.SS3.p5.1.m1.1.1.2.cmml"><mi id="S3.SS3.p5.1.m1.1.1.2.2" xref="S3.SS3.p5.1.m1.1.1.2.2.cmml">𝝁</mi><mtext id="S3.SS3.p5.1.m1.1.1.2.3" xref="S3.SS3.p5.1.m1.1.1.2.3a.cmml">ID</mtext></msub><mo id="S3.SS3.p5.1.m1.1.1.1" xref="S3.SS3.p5.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS3.p5.1.m1.1.1.3" xref="S3.SS3.p5.1.m1.1.1.3.cmml"><mi id="S3.SS3.p5.1.m1.1.1.3.2" xref="S3.SS3.p5.1.m1.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS3.p5.1.m1.1.1.3.3" xref="S3.SS3.p5.1.m1.1.1.3.3.cmml">D</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.1.m1.1b"><apply id="S3.SS3.p5.1.m1.1.1.cmml" xref="S3.SS3.p5.1.m1.1.1"><in id="S3.SS3.p5.1.m1.1.1.1.cmml" xref="S3.SS3.p5.1.m1.1.1.1"></in><apply id="S3.SS3.p5.1.m1.1.1.2.cmml" xref="S3.SS3.p5.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p5.1.m1.1.1.2.1.cmml" xref="S3.SS3.p5.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS3.p5.1.m1.1.1.2.2.cmml" xref="S3.SS3.p5.1.m1.1.1.2.2">𝝁</ci><ci id="S3.SS3.p5.1.m1.1.1.2.3a.cmml" xref="S3.SS3.p5.1.m1.1.1.2.3"><mtext id="S3.SS3.p5.1.m1.1.1.2.3.cmml" mathsize="70%" xref="S3.SS3.p5.1.m1.1.1.2.3">ID</mtext></ci></apply><apply id="S3.SS3.p5.1.m1.1.1.3.cmml" xref="S3.SS3.p5.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p5.1.m1.1.1.3.1.cmml" xref="S3.SS3.p5.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS3.p5.1.m1.1.1.3.2.cmml" xref="S3.SS3.p5.1.m1.1.1.3.2">ℝ</ci><ci id="S3.SS3.p5.1.m1.1.1.3.3.cmml" xref="S3.SS3.p5.1.m1.1.1.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.1.m1.1c">\bm{\mu_{\text{ID}}}\in\mathbb{R}^{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.1.m1.1d">bold_italic_μ start_POSTSUBSCRIPT ID end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> be the mean of the in-distribution feature representations. Centering w.r.t. <math alttext="\bm{\mu_{\text{ID}}}" class="ltx_Math" display="inline" id="S3.SS3.p5.2.m2.1"><semantics id="S3.SS3.p5.2.m2.1a"><msub id="S3.SS3.p5.2.m2.1.1" xref="S3.SS3.p5.2.m2.1.1.cmml"><mi id="S3.SS3.p5.2.m2.1.1.2" xref="S3.SS3.p5.2.m2.1.1.2.cmml">𝝁</mi><mtext id="S3.SS3.p5.2.m2.1.1.3" xref="S3.SS3.p5.2.m2.1.1.3a.cmml">ID</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.2.m2.1b"><apply id="S3.SS3.p5.2.m2.1.1.cmml" xref="S3.SS3.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p5.2.m2.1.1.1.cmml" xref="S3.SS3.p5.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p5.2.m2.1.1.2.cmml" xref="S3.SS3.p5.2.m2.1.1.2">𝝁</ci><ci id="S3.SS3.p5.2.m2.1.1.3a.cmml" xref="S3.SS3.p5.2.m2.1.1.3"><mtext id="S3.SS3.p5.2.m2.1.1.3.cmml" mathsize="70%" xref="S3.SS3.p5.2.m2.1.1.3">ID</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.2.m2.1c">\bm{\mu_{\text{ID}}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.2.m2.1d">bold_italic_μ start_POSTSUBSCRIPT ID end_POSTSUBSCRIPT</annotation></semantics></math> corresponds to shifting the origin to <math alttext="\mu_{\text{ID}}" class="ltx_Math" display="inline" id="S3.SS3.p5.3.m3.1"><semantics id="S3.SS3.p5.3.m3.1a"><msub id="S3.SS3.p5.3.m3.1.1" xref="S3.SS3.p5.3.m3.1.1.cmml"><mi id="S3.SS3.p5.3.m3.1.1.2" xref="S3.SS3.p5.3.m3.1.1.2.cmml">μ</mi><mtext id="S3.SS3.p5.3.m3.1.1.3" xref="S3.SS3.p5.3.m3.1.1.3a.cmml">ID</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.3.m3.1b"><apply id="S3.SS3.p5.3.m3.1.1.cmml" xref="S3.SS3.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p5.3.m3.1.1.1.cmml" xref="S3.SS3.p5.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p5.3.m3.1.1.2.cmml" xref="S3.SS3.p5.3.m3.1.1.2">𝜇</ci><ci id="S3.SS3.p5.3.m3.1.1.3a.cmml" xref="S3.SS3.p5.3.m3.1.1.3"><mtext id="S3.SS3.p5.3.m3.1.1.3.cmml" mathsize="70%" xref="S3.SS3.p5.3.m3.1.1.3">ID</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.3.m3.1c">\mu_{\text{ID}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.3.m3.1d">italic_μ start_POSTSUBSCRIPT ID end_POSTSUBSCRIPT</annotation></semantics></math>. In this new reference frame, three key points form a triangle in <math alttext="D" class="ltx_Math" display="inline" id="S3.SS3.p5.4.m4.1"><semantics id="S3.SS3.p5.4.m4.1a"><mi id="S3.SS3.p5.4.m4.1.1" xref="S3.SS3.p5.4.m4.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.4.m4.1b"><ci id="S3.SS3.p5.4.m4.1.1.cmml" xref="S3.SS3.p5.4.m4.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.4.m4.1c">D</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.4.m4.1d">italic_D</annotation></semantics></math>-dimensional space: the centered feature vector (<math alttext="\mathbf{z}-\bm{\mu_{\text{ID}}}" class="ltx_Math" display="inline" id="S3.SS3.p5.5.m5.1"><semantics id="S3.SS3.p5.5.m5.1a"><mrow id="S3.SS3.p5.5.m5.1.1" xref="S3.SS3.p5.5.m5.1.1.cmml"><mi id="S3.SS3.p5.5.m5.1.1.2" xref="S3.SS3.p5.5.m5.1.1.2.cmml">𝐳</mi><mo id="S3.SS3.p5.5.m5.1.1.1" xref="S3.SS3.p5.5.m5.1.1.1.cmml">−</mo><msub id="S3.SS3.p5.5.m5.1.1.3" xref="S3.SS3.p5.5.m5.1.1.3.cmml"><mi id="S3.SS3.p5.5.m5.1.1.3.2" xref="S3.SS3.p5.5.m5.1.1.3.2.cmml">𝝁</mi><mtext id="S3.SS3.p5.5.m5.1.1.3.3" xref="S3.SS3.p5.5.m5.1.1.3.3a.cmml">ID</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.5.m5.1b"><apply id="S3.SS3.p5.5.m5.1.1.cmml" xref="S3.SS3.p5.5.m5.1.1"><minus id="S3.SS3.p5.5.m5.1.1.1.cmml" xref="S3.SS3.p5.5.m5.1.1.1"></minus><ci id="S3.SS3.p5.5.m5.1.1.2.cmml" xref="S3.SS3.p5.5.m5.1.1.2">𝐳</ci><apply id="S3.SS3.p5.5.m5.1.1.3.cmml" xref="S3.SS3.p5.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p5.5.m5.1.1.3.1.cmml" xref="S3.SS3.p5.5.m5.1.1.3">subscript</csymbol><ci id="S3.SS3.p5.5.m5.1.1.3.2.cmml" xref="S3.SS3.p5.5.m5.1.1.3.2">𝝁</ci><ci id="S3.SS3.p5.5.m5.1.1.3.3a.cmml" xref="S3.SS3.p5.5.m5.1.1.3.3"><mtext id="S3.SS3.p5.5.m5.1.1.3.3.cmml" mathsize="70%" xref="S3.SS3.p5.5.m5.1.1.3.3">ID</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.5.m5.1c">\mathbf{z}-\bm{\mu_{\text{ID}}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.5.m5.1d">bold_z - bold_italic_μ start_POSTSUBSCRIPT ID end_POSTSUBSCRIPT</annotation></semantics></math>), its projection onto the decision boundary (<math alttext="\mathbf{z_{db}}-\bm{\mu_{\text{ID}}}" class="ltx_Math" display="inline" id="S3.SS3.p5.6.m6.1"><semantics id="S3.SS3.p5.6.m6.1a"><mrow id="S3.SS3.p5.6.m6.1.1" xref="S3.SS3.p5.6.m6.1.1.cmml"><msub id="S3.SS3.p5.6.m6.1.1.2" xref="S3.SS3.p5.6.m6.1.1.2.cmml"><mi id="S3.SS3.p5.6.m6.1.1.2.2" xref="S3.SS3.p5.6.m6.1.1.2.2.cmml">𝐳</mi><mi id="S3.SS3.p5.6.m6.1.1.2.3" xref="S3.SS3.p5.6.m6.1.1.2.3.cmml">𝐝𝐛</mi></msub><mo id="S3.SS3.p5.6.m6.1.1.1" xref="S3.SS3.p5.6.m6.1.1.1.cmml">−</mo><msub id="S3.SS3.p5.6.m6.1.1.3" xref="S3.SS3.p5.6.m6.1.1.3.cmml"><mi id="S3.SS3.p5.6.m6.1.1.3.2" xref="S3.SS3.p5.6.m6.1.1.3.2.cmml">𝝁</mi><mtext id="S3.SS3.p5.6.m6.1.1.3.3" xref="S3.SS3.p5.6.m6.1.1.3.3a.cmml">ID</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.6.m6.1b"><apply id="S3.SS3.p5.6.m6.1.1.cmml" xref="S3.SS3.p5.6.m6.1.1"><minus id="S3.SS3.p5.6.m6.1.1.1.cmml" xref="S3.SS3.p5.6.m6.1.1.1"></minus><apply id="S3.SS3.p5.6.m6.1.1.2.cmml" xref="S3.SS3.p5.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p5.6.m6.1.1.2.1.cmml" xref="S3.SS3.p5.6.m6.1.1.2">subscript</csymbol><ci id="S3.SS3.p5.6.m6.1.1.2.2.cmml" xref="S3.SS3.p5.6.m6.1.1.2.2">𝐳</ci><ci id="S3.SS3.p5.6.m6.1.1.2.3.cmml" xref="S3.SS3.p5.6.m6.1.1.2.3">𝐝𝐛</ci></apply><apply id="S3.SS3.p5.6.m6.1.1.3.cmml" xref="S3.SS3.p5.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p5.6.m6.1.1.3.1.cmml" xref="S3.SS3.p5.6.m6.1.1.3">subscript</csymbol><ci id="S3.SS3.p5.6.m6.1.1.3.2.cmml" xref="S3.SS3.p5.6.m6.1.1.3.2">𝝁</ci><ci id="S3.SS3.p5.6.m6.1.1.3.3a.cmml" xref="S3.SS3.p5.6.m6.1.1.3.3"><mtext id="S3.SS3.p5.6.m6.1.1.3.3.cmml" mathsize="70%" xref="S3.SS3.p5.6.m6.1.1.3.3">ID</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.6.m6.1c">\mathbf{z_{db}}-\bm{\mu_{\text{ID}}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.6.m6.1d">bold_z start_POSTSUBSCRIPT bold_db end_POSTSUBSCRIPT - bold_italic_μ start_POSTSUBSCRIPT ID end_POSTSUBSCRIPT</annotation></semantics></math>) and the new origin (see Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#S2.F1" title="Figure 1 ‣ Score Functions ‣ 2 Related Work ‣ Look Around and Find Out: OOD Detection with Relative Angles"><span class="ltx_text ltx_ref_tag">1</span></a>). Then, rather than the absolute distance between <math alttext="\mathbf{z}" class="ltx_Math" display="inline" id="S3.SS3.p5.7.m7.1"><semantics id="S3.SS3.p5.7.m7.1a"><mi id="S3.SS3.p5.7.m7.1.1" xref="S3.SS3.p5.7.m7.1.1.cmml">𝐳</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.7.m7.1b"><ci id="S3.SS3.p5.7.m7.1.1.cmml" xref="S3.SS3.p5.7.m7.1.1">𝐳</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.7.m7.1c">\mathbf{z}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.7.m7.1d">bold_z</annotation></semantics></math> and <math alttext="\mathbf{z}_{db}" class="ltx_Math" display="inline" id="S3.SS3.p5.8.m8.1"><semantics id="S3.SS3.p5.8.m8.1a"><msub id="S3.SS3.p5.8.m8.1.1" xref="S3.SS3.p5.8.m8.1.1.cmml"><mi id="S3.SS3.p5.8.m8.1.1.2" xref="S3.SS3.p5.8.m8.1.1.2.cmml">𝐳</mi><mrow id="S3.SS3.p5.8.m8.1.1.3" xref="S3.SS3.p5.8.m8.1.1.3.cmml"><mi id="S3.SS3.p5.8.m8.1.1.3.2" xref="S3.SS3.p5.8.m8.1.1.3.2.cmml">d</mi><mo id="S3.SS3.p5.8.m8.1.1.3.1" xref="S3.SS3.p5.8.m8.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p5.8.m8.1.1.3.3" xref="S3.SS3.p5.8.m8.1.1.3.3.cmml">b</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.8.m8.1b"><apply id="S3.SS3.p5.8.m8.1.1.cmml" xref="S3.SS3.p5.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.p5.8.m8.1.1.1.cmml" xref="S3.SS3.p5.8.m8.1.1">subscript</csymbol><ci id="S3.SS3.p5.8.m8.1.1.2.cmml" xref="S3.SS3.p5.8.m8.1.1.2">𝐳</ci><apply id="S3.SS3.p5.8.m8.1.1.3.cmml" xref="S3.SS3.p5.8.m8.1.1.3"><times id="S3.SS3.p5.8.m8.1.1.3.1.cmml" xref="S3.SS3.p5.8.m8.1.1.3.1"></times><ci id="S3.SS3.p5.8.m8.1.1.3.2.cmml" xref="S3.SS3.p5.8.m8.1.1.3.2">𝑑</ci><ci id="S3.SS3.p5.8.m8.1.1.3.3.cmml" xref="S3.SS3.p5.8.m8.1.1.3.3">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.8.m8.1c">\mathbf{z}_{db}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.8.m8.1d">bold_z start_POSTSUBSCRIPT italic_d italic_b end_POSTSUBSCRIPT</annotation></semantics></math>, we consider the relative angle <math alttext="\theta_{y_{1},y_{2}}(\mathbf{z})" class="ltx_Math" display="inline" id="S3.SS3.p5.9.m9.3"><semantics id="S3.SS3.p5.9.m9.3a"><mrow id="S3.SS3.p5.9.m9.3.4" xref="S3.SS3.p5.9.m9.3.4.cmml"><msub id="S3.SS3.p5.9.m9.3.4.2" xref="S3.SS3.p5.9.m9.3.4.2.cmml"><mi id="S3.SS3.p5.9.m9.3.4.2.2" xref="S3.SS3.p5.9.m9.3.4.2.2.cmml">θ</mi><mrow id="S3.SS3.p5.9.m9.2.2.2.2" xref="S3.SS3.p5.9.m9.2.2.2.3.cmml"><msub id="S3.SS3.p5.9.m9.1.1.1.1.1" xref="S3.SS3.p5.9.m9.1.1.1.1.1.cmml"><mi id="S3.SS3.p5.9.m9.1.1.1.1.1.2" xref="S3.SS3.p5.9.m9.1.1.1.1.1.2.cmml">y</mi><mn id="S3.SS3.p5.9.m9.1.1.1.1.1.3" xref="S3.SS3.p5.9.m9.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS3.p5.9.m9.2.2.2.2.3" xref="S3.SS3.p5.9.m9.2.2.2.3.cmml">,</mo><msub id="S3.SS3.p5.9.m9.2.2.2.2.2" xref="S3.SS3.p5.9.m9.2.2.2.2.2.cmml"><mi id="S3.SS3.p5.9.m9.2.2.2.2.2.2" xref="S3.SS3.p5.9.m9.2.2.2.2.2.2.cmml">y</mi><mn id="S3.SS3.p5.9.m9.2.2.2.2.2.3" xref="S3.SS3.p5.9.m9.2.2.2.2.2.3.cmml">2</mn></msub></mrow></msub><mo id="S3.SS3.p5.9.m9.3.4.1" xref="S3.SS3.p5.9.m9.3.4.1.cmml">⁢</mo><mrow id="S3.SS3.p5.9.m9.3.4.3.2" xref="S3.SS3.p5.9.m9.3.4.cmml"><mo id="S3.SS3.p5.9.m9.3.4.3.2.1" stretchy="false" xref="S3.SS3.p5.9.m9.3.4.cmml">(</mo><mi id="S3.SS3.p5.9.m9.3.3" xref="S3.SS3.p5.9.m9.3.3.cmml">𝐳</mi><mo id="S3.SS3.p5.9.m9.3.4.3.2.2" stretchy="false" xref="S3.SS3.p5.9.m9.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.9.m9.3b"><apply id="S3.SS3.p5.9.m9.3.4.cmml" xref="S3.SS3.p5.9.m9.3.4"><times id="S3.SS3.p5.9.m9.3.4.1.cmml" xref="S3.SS3.p5.9.m9.3.4.1"></times><apply id="S3.SS3.p5.9.m9.3.4.2.cmml" xref="S3.SS3.p5.9.m9.3.4.2"><csymbol cd="ambiguous" id="S3.SS3.p5.9.m9.3.4.2.1.cmml" xref="S3.SS3.p5.9.m9.3.4.2">subscript</csymbol><ci id="S3.SS3.p5.9.m9.3.4.2.2.cmml" xref="S3.SS3.p5.9.m9.3.4.2.2">𝜃</ci><list id="S3.SS3.p5.9.m9.2.2.2.3.cmml" xref="S3.SS3.p5.9.m9.2.2.2.2"><apply id="S3.SS3.p5.9.m9.1.1.1.1.1.cmml" xref="S3.SS3.p5.9.m9.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p5.9.m9.1.1.1.1.1.1.cmml" xref="S3.SS3.p5.9.m9.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p5.9.m9.1.1.1.1.1.2.cmml" xref="S3.SS3.p5.9.m9.1.1.1.1.1.2">𝑦</ci><cn id="S3.SS3.p5.9.m9.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS3.p5.9.m9.1.1.1.1.1.3">1</cn></apply><apply id="S3.SS3.p5.9.m9.2.2.2.2.2.cmml" xref="S3.SS3.p5.9.m9.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p5.9.m9.2.2.2.2.2.1.cmml" xref="S3.SS3.p5.9.m9.2.2.2.2.2">subscript</csymbol><ci id="S3.SS3.p5.9.m9.2.2.2.2.2.2.cmml" xref="S3.SS3.p5.9.m9.2.2.2.2.2.2">𝑦</ci><cn id="S3.SS3.p5.9.m9.2.2.2.2.2.3.cmml" type="integer" xref="S3.SS3.p5.9.m9.2.2.2.2.2.3">2</cn></apply></list></apply><ci id="S3.SS3.p5.9.m9.3.3.cmml" xref="S3.SS3.p5.9.m9.3.3">𝐳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.9.m9.3c">\theta_{y_{1},y_{2}}(\mathbf{z})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.9.m9.3d">italic_θ start_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_z )</annotation></semantics></math> from the in-distribution feature representation’s reference frame: this captures <span class="ltx_text ltx_font_italic" id="S3.SS3.p5.9.1">the position of features and the decision boundaries with respect to the in-distribution data</span>, while also being scale invariant:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S3.SS3.p6">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx3">
<tbody id="S3.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\theta_{y_{1},y_{2}}(\mathbf{z})=\arccos{\left(\frac{<\mathbf{z}-%
\bm{\mu_{\text{ID}}},\mathbf{z}_{db}-\bm{\mu_{\text{ID}}}>}{||\mathbf{z}-\bm{%
\mu_{\text{ID}}}||\cdot||\mathbf{z}_{db}-\bm{\mu_{\text{ID}}}||}\right)}" class="ltx_math_unparsed" display="inline" id="S3.E2.m1.6"><semantics id="S3.E2.m1.6a"><mrow id="S3.E2.m1.6.7"><mrow id="S3.E2.m1.6.7.2"><msub id="S3.E2.m1.6.7.2.2"><mi id="S3.E2.m1.6.7.2.2.2">θ</mi><mrow id="S3.E2.m1.2.2.2.2"><msub id="S3.E2.m1.1.1.1.1.1"><mi id="S3.E2.m1.1.1.1.1.1.2">y</mi><mn id="S3.E2.m1.1.1.1.1.1.3">1</mn></msub><mo id="S3.E2.m1.2.2.2.2.3">,</mo><msub id="S3.E2.m1.2.2.2.2.2"><mi id="S3.E2.m1.2.2.2.2.2.2">y</mi><mn id="S3.E2.m1.2.2.2.2.2.3">2</mn></msub></mrow></msub><mo id="S3.E2.m1.6.7.2.1">⁢</mo><mrow id="S3.E2.m1.6.7.2.3.2"><mo id="S3.E2.m1.6.7.2.3.2.1" stretchy="false">(</mo><mi id="S3.E2.m1.5.5">𝐳</mi><mo id="S3.E2.m1.6.7.2.3.2.2" stretchy="false">)</mo></mrow></mrow><mo id="S3.E2.m1.6.7.1">=</mo><mrow id="S3.E2.m1.6.7.3.2"><mi id="S3.E2.m1.6.6">arccos</mi><mo id="S3.E2.m1.6.7.3.2a">⁡</mo><mrow id="S3.E2.m1.6.7.3.2.1"><mo id="S3.E2.m1.6.7.3.2.1.1">(</mo><mstyle displaystyle="true" id="S3.E2.m1.4.4"><mfrac id="S3.E2.m1.4.4a"><mrow id="S3.E2.m1.4.4.4"><mo id="S3.E2.m1.4.4.4.1">&lt;</mo><mi id="S3.E2.m1.4.4.4.2">𝐳</mi><mo id="S3.E2.m1.4.4.4.3">−</mo><msub id="S3.E2.m1.4.4.4.4"><mi id="S3.E2.m1.4.4.4.4.2">𝝁</mi><mtext id="S3.E2.m1.4.4.4.4.3">ID</mtext></msub><mo id="S3.E2.m1.4.4.4.5">,</mo><msub id="S3.E2.m1.4.4.4.6"><mi id="S3.E2.m1.4.4.4.6.2">𝐳</mi><mrow id="S3.E2.m1.4.4.4.6.3"><mi id="S3.E2.m1.4.4.4.6.3.2">d</mi><mo id="S3.E2.m1.4.4.4.6.3.1">⁢</mo><mi id="S3.E2.m1.4.4.4.6.3.3">b</mi></mrow></msub><mo id="S3.E2.m1.4.4.4.7">−</mo><msub id="S3.E2.m1.4.4.4.8"><mi id="S3.E2.m1.4.4.4.8.2">𝝁</mi><mtext id="S3.E2.m1.4.4.4.8.3">ID</mtext></msub><mo id="S3.E2.m1.4.4.4.9">&gt;</mo></mrow><mrow id="S3.E2.m1.4.4.2"><mrow id="S3.E2.m1.3.3.1.1.1"><mo id="S3.E2.m1.3.3.1.1.1.2" stretchy="false">‖</mo><mrow id="S3.E2.m1.3.3.1.1.1.1"><mi id="S3.E2.m1.3.3.1.1.1.1.2">𝐳</mi><mo id="S3.E2.m1.3.3.1.1.1.1.1">−</mo><msub id="S3.E2.m1.3.3.1.1.1.1.3"><mi id="S3.E2.m1.3.3.1.1.1.1.3.2">𝝁</mi><mtext id="S3.E2.m1.3.3.1.1.1.1.3.3">ID</mtext></msub></mrow><mo id="S3.E2.m1.3.3.1.1.1.3" rspace="0.055em" stretchy="false">‖</mo></mrow><mo id="S3.E2.m1.4.4.2.3" rspace="0.222em">⋅</mo><mrow id="S3.E2.m1.4.4.2.2.1"><mo id="S3.E2.m1.4.4.2.2.1.2" stretchy="false">‖</mo><mrow id="S3.E2.m1.4.4.2.2.1.1"><msub id="S3.E2.m1.4.4.2.2.1.1.2"><mi id="S3.E2.m1.4.4.2.2.1.1.2.2">𝐳</mi><mrow id="S3.E2.m1.4.4.2.2.1.1.2.3"><mi id="S3.E2.m1.4.4.2.2.1.1.2.3.2">d</mi><mo id="S3.E2.m1.4.4.2.2.1.1.2.3.1">⁢</mo><mi id="S3.E2.m1.4.4.2.2.1.1.2.3.3">b</mi></mrow></msub><mo id="S3.E2.m1.4.4.2.2.1.1.1">−</mo><msub id="S3.E2.m1.4.4.2.2.1.1.3"><mi id="S3.E2.m1.4.4.2.2.1.1.3.2">𝝁</mi><mtext id="S3.E2.m1.4.4.2.2.1.1.3.3">ID</mtext></msub></mrow><mo id="S3.E2.m1.4.4.2.2.1.3" stretchy="false">‖</mo></mrow></mrow></mfrac></mstyle><mo id="S3.E2.m1.6.7.3.2.1.2">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S3.E2.m1.6b">\displaystyle\theta_{y_{1},y_{2}}(\mathbf{z})=\arccos{\left(\frac{&lt;\mathbf{z}-%
\bm{\mu_{\text{ID}}},\mathbf{z}_{db}-\bm{\mu_{\text{ID}}}&gt;}{||\mathbf{z}-\bm{%
\mu_{\text{ID}}}||\cdot||\mathbf{z}_{db}-\bm{\mu_{\text{ID}}}||}\right)}</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.6c">italic_θ start_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_z ) = roman_arccos ( divide start_ARG &lt; bold_z - bold_italic_μ start_POSTSUBSCRIPT ID end_POSTSUBSCRIPT , bold_z start_POSTSUBSCRIPT italic_d italic_b end_POSTSUBSCRIPT - bold_italic_μ start_POSTSUBSCRIPT ID end_POSTSUBSCRIPT &gt; end_ARG start_ARG | | bold_z - bold_italic_μ start_POSTSUBSCRIPT ID end_POSTSUBSCRIPT | | ⋅ | | bold_z start_POSTSUBSCRIPT italic_d italic_b end_POSTSUBSCRIPT - bold_italic_μ start_POSTSUBSCRIPT ID end_POSTSUBSCRIPT | | end_ARG )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.p7">
<p class="ltx_p" id="S3.SS3.p7.8">Our score function extracts the maximum discrepancy of the relative angles between the centered feature representation and its projections on <math alttext="DB_{\hat{y},y^{\prime}}" class="ltx_Math" display="inline" id="S3.SS3.p7.1.m1.2"><semantics id="S3.SS3.p7.1.m1.2a"><mrow id="S3.SS3.p7.1.m1.2.3" xref="S3.SS3.p7.1.m1.2.3.cmml"><mi id="S3.SS3.p7.1.m1.2.3.2" xref="S3.SS3.p7.1.m1.2.3.2.cmml">D</mi><mo id="S3.SS3.p7.1.m1.2.3.1" xref="S3.SS3.p7.1.m1.2.3.1.cmml">⁢</mo><msub id="S3.SS3.p7.1.m1.2.3.3" xref="S3.SS3.p7.1.m1.2.3.3.cmml"><mi id="S3.SS3.p7.1.m1.2.3.3.2" xref="S3.SS3.p7.1.m1.2.3.3.2.cmml">B</mi><mrow id="S3.SS3.p7.1.m1.2.2.2.2" xref="S3.SS3.p7.1.m1.2.2.2.3.cmml"><mover accent="true" id="S3.SS3.p7.1.m1.1.1.1.1" xref="S3.SS3.p7.1.m1.1.1.1.1.cmml"><mi id="S3.SS3.p7.1.m1.1.1.1.1.2" xref="S3.SS3.p7.1.m1.1.1.1.1.2.cmml">y</mi><mo id="S3.SS3.p7.1.m1.1.1.1.1.1" xref="S3.SS3.p7.1.m1.1.1.1.1.1.cmml">^</mo></mover><mo id="S3.SS3.p7.1.m1.2.2.2.2.2" xref="S3.SS3.p7.1.m1.2.2.2.3.cmml">,</mo><msup id="S3.SS3.p7.1.m1.2.2.2.2.1" xref="S3.SS3.p7.1.m1.2.2.2.2.1.cmml"><mi id="S3.SS3.p7.1.m1.2.2.2.2.1.2" xref="S3.SS3.p7.1.m1.2.2.2.2.1.2.cmml">y</mi><mo id="S3.SS3.p7.1.m1.2.2.2.2.1.3" xref="S3.SS3.p7.1.m1.2.2.2.2.1.3.cmml">′</mo></msup></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.1.m1.2b"><apply id="S3.SS3.p7.1.m1.2.3.cmml" xref="S3.SS3.p7.1.m1.2.3"><times id="S3.SS3.p7.1.m1.2.3.1.cmml" xref="S3.SS3.p7.1.m1.2.3.1"></times><ci id="S3.SS3.p7.1.m1.2.3.2.cmml" xref="S3.SS3.p7.1.m1.2.3.2">𝐷</ci><apply id="S3.SS3.p7.1.m1.2.3.3.cmml" xref="S3.SS3.p7.1.m1.2.3.3"><csymbol cd="ambiguous" id="S3.SS3.p7.1.m1.2.3.3.1.cmml" xref="S3.SS3.p7.1.m1.2.3.3">subscript</csymbol><ci id="S3.SS3.p7.1.m1.2.3.3.2.cmml" xref="S3.SS3.p7.1.m1.2.3.3.2">𝐵</ci><list id="S3.SS3.p7.1.m1.2.2.2.3.cmml" xref="S3.SS3.p7.1.m1.2.2.2.2"><apply id="S3.SS3.p7.1.m1.1.1.1.1.cmml" xref="S3.SS3.p7.1.m1.1.1.1.1"><ci id="S3.SS3.p7.1.m1.1.1.1.1.1.cmml" xref="S3.SS3.p7.1.m1.1.1.1.1.1">^</ci><ci id="S3.SS3.p7.1.m1.1.1.1.1.2.cmml" xref="S3.SS3.p7.1.m1.1.1.1.1.2">𝑦</ci></apply><apply id="S3.SS3.p7.1.m1.2.2.2.2.1.cmml" xref="S3.SS3.p7.1.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.SS3.p7.1.m1.2.2.2.2.1.1.cmml" xref="S3.SS3.p7.1.m1.2.2.2.2.1">superscript</csymbol><ci id="S3.SS3.p7.1.m1.2.2.2.2.1.2.cmml" xref="S3.SS3.p7.1.m1.2.2.2.2.1.2">𝑦</ci><ci id="S3.SS3.p7.1.m1.2.2.2.2.1.3.cmml" xref="S3.SS3.p7.1.m1.2.2.2.2.1.3">′</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.1.m1.2c">DB_{\hat{y},y^{\prime}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.1.m1.2d">italic_D italic_B start_POSTSUBSCRIPT over^ start_ARG italic_y end_ARG , italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>, where <math alttext="\hat{y}=\operatorname*{arg\,max}_{y\in\mathcal{Y}}g(\mathbf{z})" class="ltx_Math" display="inline" id="S3.SS3.p7.2.m2.1"><semantics id="S3.SS3.p7.2.m2.1a"><mrow id="S3.SS3.p7.2.m2.1.2" xref="S3.SS3.p7.2.m2.1.2.cmml"><mover accent="true" id="S3.SS3.p7.2.m2.1.2.2" xref="S3.SS3.p7.2.m2.1.2.2.cmml"><mi id="S3.SS3.p7.2.m2.1.2.2.2" xref="S3.SS3.p7.2.m2.1.2.2.2.cmml">y</mi><mo id="S3.SS3.p7.2.m2.1.2.2.1" xref="S3.SS3.p7.2.m2.1.2.2.1.cmml">^</mo></mover><mo id="S3.SS3.p7.2.m2.1.2.1" xref="S3.SS3.p7.2.m2.1.2.1.cmml">=</mo><mrow id="S3.SS3.p7.2.m2.1.2.3" xref="S3.SS3.p7.2.m2.1.2.3.cmml"><mrow id="S3.SS3.p7.2.m2.1.2.3.2" xref="S3.SS3.p7.2.m2.1.2.3.2.cmml"><msub id="S3.SS3.p7.2.m2.1.2.3.2.1" xref="S3.SS3.p7.2.m2.1.2.3.2.1.cmml"><mrow id="S3.SS3.p7.2.m2.1.2.3.2.1.2" xref="S3.SS3.p7.2.m2.1.2.3.2.1.2.cmml"><mi id="S3.SS3.p7.2.m2.1.2.3.2.1.2.2" xref="S3.SS3.p7.2.m2.1.2.3.2.1.2.2.cmml">arg</mi><mo id="S3.SS3.p7.2.m2.1.2.3.2.1.2.1" lspace="0.170em" xref="S3.SS3.p7.2.m2.1.2.3.2.1.2.1.cmml">⁢</mo><mi id="S3.SS3.p7.2.m2.1.2.3.2.1.2.3" xref="S3.SS3.p7.2.m2.1.2.3.2.1.2.3.cmml">max</mi></mrow><mrow id="S3.SS3.p7.2.m2.1.2.3.2.1.3" xref="S3.SS3.p7.2.m2.1.2.3.2.1.3.cmml"><mi id="S3.SS3.p7.2.m2.1.2.3.2.1.3.2" xref="S3.SS3.p7.2.m2.1.2.3.2.1.3.2.cmml">y</mi><mo id="S3.SS3.p7.2.m2.1.2.3.2.1.3.1" xref="S3.SS3.p7.2.m2.1.2.3.2.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p7.2.m2.1.2.3.2.1.3.3" xref="S3.SS3.p7.2.m2.1.2.3.2.1.3.3.cmml">𝒴</mi></mrow></msub><mo id="S3.SS3.p7.2.m2.1.2.3.2a" xref="S3.SS3.p7.2.m2.1.2.3.2.cmml">⁡</mo><mi id="S3.SS3.p7.2.m2.1.2.3.2.2" xref="S3.SS3.p7.2.m2.1.2.3.2.2.cmml">g</mi></mrow><mo id="S3.SS3.p7.2.m2.1.2.3.1" xref="S3.SS3.p7.2.m2.1.2.3.1.cmml">⁢</mo><mrow id="S3.SS3.p7.2.m2.1.2.3.3.2" xref="S3.SS3.p7.2.m2.1.2.3.cmml"><mo id="S3.SS3.p7.2.m2.1.2.3.3.2.1" stretchy="false" xref="S3.SS3.p7.2.m2.1.2.3.cmml">(</mo><mi id="S3.SS3.p7.2.m2.1.1" xref="S3.SS3.p7.2.m2.1.1.cmml">𝐳</mi><mo id="S3.SS3.p7.2.m2.1.2.3.3.2.2" stretchy="false" xref="S3.SS3.p7.2.m2.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.2.m2.1b"><apply id="S3.SS3.p7.2.m2.1.2.cmml" xref="S3.SS3.p7.2.m2.1.2"><eq id="S3.SS3.p7.2.m2.1.2.1.cmml" xref="S3.SS3.p7.2.m2.1.2.1"></eq><apply id="S3.SS3.p7.2.m2.1.2.2.cmml" xref="S3.SS3.p7.2.m2.1.2.2"><ci id="S3.SS3.p7.2.m2.1.2.2.1.cmml" xref="S3.SS3.p7.2.m2.1.2.2.1">^</ci><ci id="S3.SS3.p7.2.m2.1.2.2.2.cmml" xref="S3.SS3.p7.2.m2.1.2.2.2">𝑦</ci></apply><apply id="S3.SS3.p7.2.m2.1.2.3.cmml" xref="S3.SS3.p7.2.m2.1.2.3"><times id="S3.SS3.p7.2.m2.1.2.3.1.cmml" xref="S3.SS3.p7.2.m2.1.2.3.1"></times><apply id="S3.SS3.p7.2.m2.1.2.3.2.cmml" xref="S3.SS3.p7.2.m2.1.2.3.2"><apply id="S3.SS3.p7.2.m2.1.2.3.2.1.cmml" xref="S3.SS3.p7.2.m2.1.2.3.2.1"><csymbol cd="ambiguous" id="S3.SS3.p7.2.m2.1.2.3.2.1.1.cmml" xref="S3.SS3.p7.2.m2.1.2.3.2.1">subscript</csymbol><apply id="S3.SS3.p7.2.m2.1.2.3.2.1.2.cmml" xref="S3.SS3.p7.2.m2.1.2.3.2.1.2"><times id="S3.SS3.p7.2.m2.1.2.3.2.1.2.1.cmml" xref="S3.SS3.p7.2.m2.1.2.3.2.1.2.1"></times><ci id="S3.SS3.p7.2.m2.1.2.3.2.1.2.2.cmml" xref="S3.SS3.p7.2.m2.1.2.3.2.1.2.2">arg</ci><ci id="S3.SS3.p7.2.m2.1.2.3.2.1.2.3.cmml" xref="S3.SS3.p7.2.m2.1.2.3.2.1.2.3">max</ci></apply><apply id="S3.SS3.p7.2.m2.1.2.3.2.1.3.cmml" xref="S3.SS3.p7.2.m2.1.2.3.2.1.3"><in id="S3.SS3.p7.2.m2.1.2.3.2.1.3.1.cmml" xref="S3.SS3.p7.2.m2.1.2.3.2.1.3.1"></in><ci id="S3.SS3.p7.2.m2.1.2.3.2.1.3.2.cmml" xref="S3.SS3.p7.2.m2.1.2.3.2.1.3.2">𝑦</ci><ci id="S3.SS3.p7.2.m2.1.2.3.2.1.3.3.cmml" xref="S3.SS3.p7.2.m2.1.2.3.2.1.3.3">𝒴</ci></apply></apply><ci id="S3.SS3.p7.2.m2.1.2.3.2.2.cmml" xref="S3.SS3.p7.2.m2.1.2.3.2.2">𝑔</ci></apply><ci id="S3.SS3.p7.2.m2.1.1.cmml" xref="S3.SS3.p7.2.m2.1.1">𝐳</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.2.m2.1c">\hat{y}=\operatorname*{arg\,max}_{y\in\mathcal{Y}}g(\mathbf{z})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.2.m2.1d">over^ start_ARG italic_y end_ARG = start_OPERATOR roman_arg roman_max end_OPERATOR start_POSTSUBSCRIPT italic_y ∈ caligraphic_Y end_POSTSUBSCRIPT italic_g ( bold_z )</annotation></semantics></math> and <math alttext="y^{\prime}\in\mathcal{Y}" class="ltx_Math" display="inline" id="S3.SS3.p7.3.m3.1"><semantics id="S3.SS3.p7.3.m3.1a"><mrow id="S3.SS3.p7.3.m3.1.1" xref="S3.SS3.p7.3.m3.1.1.cmml"><msup id="S3.SS3.p7.3.m3.1.1.2" xref="S3.SS3.p7.3.m3.1.1.2.cmml"><mi id="S3.SS3.p7.3.m3.1.1.2.2" xref="S3.SS3.p7.3.m3.1.1.2.2.cmml">y</mi><mo id="S3.SS3.p7.3.m3.1.1.2.3" xref="S3.SS3.p7.3.m3.1.1.2.3.cmml">′</mo></msup><mo id="S3.SS3.p7.3.m3.1.1.1" xref="S3.SS3.p7.3.m3.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p7.3.m3.1.1.3" xref="S3.SS3.p7.3.m3.1.1.3.cmml">𝒴</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.3.m3.1b"><apply id="S3.SS3.p7.3.m3.1.1.cmml" xref="S3.SS3.p7.3.m3.1.1"><in id="S3.SS3.p7.3.m3.1.1.1.cmml" xref="S3.SS3.p7.3.m3.1.1.1"></in><apply id="S3.SS3.p7.3.m3.1.1.2.cmml" xref="S3.SS3.p7.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p7.3.m3.1.1.2.1.cmml" xref="S3.SS3.p7.3.m3.1.1.2">superscript</csymbol><ci id="S3.SS3.p7.3.m3.1.1.2.2.cmml" xref="S3.SS3.p7.3.m3.1.1.2.2">𝑦</ci><ci id="S3.SS3.p7.3.m3.1.1.2.3.cmml" xref="S3.SS3.p7.3.m3.1.1.2.3">′</ci></apply><ci id="S3.SS3.p7.3.m3.1.1.3.cmml" xref="S3.SS3.p7.3.m3.1.1.3">𝒴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.3.m3.1c">y^{\prime}\in\mathcal{Y}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.3.m3.1d">italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∈ caligraphic_Y</annotation></semantics></math>, <math alttext="y^{\prime}\neq y" class="ltx_Math" display="inline" id="S3.SS3.p7.4.m4.1"><semantics id="S3.SS3.p7.4.m4.1a"><mrow id="S3.SS3.p7.4.m4.1.1" xref="S3.SS3.p7.4.m4.1.1.cmml"><msup id="S3.SS3.p7.4.m4.1.1.2" xref="S3.SS3.p7.4.m4.1.1.2.cmml"><mi id="S3.SS3.p7.4.m4.1.1.2.2" xref="S3.SS3.p7.4.m4.1.1.2.2.cmml">y</mi><mo id="S3.SS3.p7.4.m4.1.1.2.3" xref="S3.SS3.p7.4.m4.1.1.2.3.cmml">′</mo></msup><mo id="S3.SS3.p7.4.m4.1.1.1" xref="S3.SS3.p7.4.m4.1.1.1.cmml">≠</mo><mi id="S3.SS3.p7.4.m4.1.1.3" xref="S3.SS3.p7.4.m4.1.1.3.cmml">y</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.4.m4.1b"><apply id="S3.SS3.p7.4.m4.1.1.cmml" xref="S3.SS3.p7.4.m4.1.1"><neq id="S3.SS3.p7.4.m4.1.1.1.cmml" xref="S3.SS3.p7.4.m4.1.1.1"></neq><apply id="S3.SS3.p7.4.m4.1.1.2.cmml" xref="S3.SS3.p7.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p7.4.m4.1.1.2.1.cmml" xref="S3.SS3.p7.4.m4.1.1.2">superscript</csymbol><ci id="S3.SS3.p7.4.m4.1.1.2.2.cmml" xref="S3.SS3.p7.4.m4.1.1.2.2">𝑦</ci><ci id="S3.SS3.p7.4.m4.1.1.2.3.cmml" xref="S3.SS3.p7.4.m4.1.1.2.3">′</ci></apply><ci id="S3.SS3.p7.4.m4.1.1.3.cmml" xref="S3.SS3.p7.4.m4.1.1.3">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.4.m4.1c">y^{\prime}\neq y</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.4.m4.1d">italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ≠ italic_y</annotation></semantics></math>. Therefore for a sample <math alttext="\mathbf{x}\in\mathcal{X}" class="ltx_Math" display="inline" id="S3.SS3.p7.5.m5.1"><semantics id="S3.SS3.p7.5.m5.1a"><mrow id="S3.SS3.p7.5.m5.1.1" xref="S3.SS3.p7.5.m5.1.1.cmml"><mi id="S3.SS3.p7.5.m5.1.1.2" xref="S3.SS3.p7.5.m5.1.1.2.cmml">𝐱</mi><mo id="S3.SS3.p7.5.m5.1.1.1" xref="S3.SS3.p7.5.m5.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p7.5.m5.1.1.3" xref="S3.SS3.p7.5.m5.1.1.3.cmml">𝒳</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.5.m5.1b"><apply id="S3.SS3.p7.5.m5.1.1.cmml" xref="S3.SS3.p7.5.m5.1.1"><in id="S3.SS3.p7.5.m5.1.1.1.cmml" xref="S3.SS3.p7.5.m5.1.1.1"></in><ci id="S3.SS3.p7.5.m5.1.1.2.cmml" xref="S3.SS3.p7.5.m5.1.1.2">𝐱</ci><ci id="S3.SS3.p7.5.m5.1.1.3.cmml" xref="S3.SS3.p7.5.m5.1.1.3">𝒳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.5.m5.1c">\mathbf{x}\in\mathcal{X}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.5.m5.1d">bold_x ∈ caligraphic_X</annotation></semantics></math>, given <math alttext="\mathbf{z}=f_{1}\circ...\circ f_{L_{1}}(\mathbf{x})" class="ltx_Math" display="inline" id="S3.SS3.p7.6.m6.1"><semantics id="S3.SS3.p7.6.m6.1a"><mrow id="S3.SS3.p7.6.m6.1.2" xref="S3.SS3.p7.6.m6.1.2.cmml"><mi id="S3.SS3.p7.6.m6.1.2.2" xref="S3.SS3.p7.6.m6.1.2.2.cmml">𝐳</mi><mo id="S3.SS3.p7.6.m6.1.2.1" xref="S3.SS3.p7.6.m6.1.2.1.cmml">=</mo><mrow id="S3.SS3.p7.6.m6.1.2.3" xref="S3.SS3.p7.6.m6.1.2.3.cmml"><mrow id="S3.SS3.p7.6.m6.1.2.3.2" xref="S3.SS3.p7.6.m6.1.2.3.2.cmml"><msub id="S3.SS3.p7.6.m6.1.2.3.2.2" xref="S3.SS3.p7.6.m6.1.2.3.2.2.cmml"><mi id="S3.SS3.p7.6.m6.1.2.3.2.2.2" xref="S3.SS3.p7.6.m6.1.2.3.2.2.2.cmml">f</mi><mn id="S3.SS3.p7.6.m6.1.2.3.2.2.3" xref="S3.SS3.p7.6.m6.1.2.3.2.2.3.cmml">1</mn></msub><mo id="S3.SS3.p7.6.m6.1.2.3.2.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p7.6.m6.1.2.3.2.1.cmml">∘</mo><mi id="S3.SS3.p7.6.m6.1.2.3.2.3" mathvariant="normal" xref="S3.SS3.p7.6.m6.1.2.3.2.3.cmml">…</mi><mo id="S3.SS3.p7.6.m6.1.2.3.2.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p7.6.m6.1.2.3.2.1.cmml">∘</mo><msub id="S3.SS3.p7.6.m6.1.2.3.2.4" xref="S3.SS3.p7.6.m6.1.2.3.2.4.cmml"><mi id="S3.SS3.p7.6.m6.1.2.3.2.4.2" xref="S3.SS3.p7.6.m6.1.2.3.2.4.2.cmml">f</mi><msub id="S3.SS3.p7.6.m6.1.2.3.2.4.3" xref="S3.SS3.p7.6.m6.1.2.3.2.4.3.cmml"><mi id="S3.SS3.p7.6.m6.1.2.3.2.4.3.2" xref="S3.SS3.p7.6.m6.1.2.3.2.4.3.2.cmml">L</mi><mn id="S3.SS3.p7.6.m6.1.2.3.2.4.3.3" xref="S3.SS3.p7.6.m6.1.2.3.2.4.3.3.cmml">1</mn></msub></msub></mrow><mo id="S3.SS3.p7.6.m6.1.2.3.1" xref="S3.SS3.p7.6.m6.1.2.3.1.cmml">⁢</mo><mrow id="S3.SS3.p7.6.m6.1.2.3.3.2" xref="S3.SS3.p7.6.m6.1.2.3.cmml"><mo id="S3.SS3.p7.6.m6.1.2.3.3.2.1" stretchy="false" xref="S3.SS3.p7.6.m6.1.2.3.cmml">(</mo><mi id="S3.SS3.p7.6.m6.1.1" xref="S3.SS3.p7.6.m6.1.1.cmml">𝐱</mi><mo id="S3.SS3.p7.6.m6.1.2.3.3.2.2" stretchy="false" xref="S3.SS3.p7.6.m6.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.6.m6.1b"><apply id="S3.SS3.p7.6.m6.1.2.cmml" xref="S3.SS3.p7.6.m6.1.2"><eq id="S3.SS3.p7.6.m6.1.2.1.cmml" xref="S3.SS3.p7.6.m6.1.2.1"></eq><ci id="S3.SS3.p7.6.m6.1.2.2.cmml" xref="S3.SS3.p7.6.m6.1.2.2">𝐳</ci><apply id="S3.SS3.p7.6.m6.1.2.3.cmml" xref="S3.SS3.p7.6.m6.1.2.3"><times id="S3.SS3.p7.6.m6.1.2.3.1.cmml" xref="S3.SS3.p7.6.m6.1.2.3.1"></times><apply id="S3.SS3.p7.6.m6.1.2.3.2.cmml" xref="S3.SS3.p7.6.m6.1.2.3.2"><compose id="S3.SS3.p7.6.m6.1.2.3.2.1.cmml" xref="S3.SS3.p7.6.m6.1.2.3.2.1"></compose><apply id="S3.SS3.p7.6.m6.1.2.3.2.2.cmml" xref="S3.SS3.p7.6.m6.1.2.3.2.2"><csymbol cd="ambiguous" id="S3.SS3.p7.6.m6.1.2.3.2.2.1.cmml" xref="S3.SS3.p7.6.m6.1.2.3.2.2">subscript</csymbol><ci id="S3.SS3.p7.6.m6.1.2.3.2.2.2.cmml" xref="S3.SS3.p7.6.m6.1.2.3.2.2.2">𝑓</ci><cn id="S3.SS3.p7.6.m6.1.2.3.2.2.3.cmml" type="integer" xref="S3.SS3.p7.6.m6.1.2.3.2.2.3">1</cn></apply><ci id="S3.SS3.p7.6.m6.1.2.3.2.3.cmml" xref="S3.SS3.p7.6.m6.1.2.3.2.3">…</ci><apply id="S3.SS3.p7.6.m6.1.2.3.2.4.cmml" xref="S3.SS3.p7.6.m6.1.2.3.2.4"><csymbol cd="ambiguous" id="S3.SS3.p7.6.m6.1.2.3.2.4.1.cmml" xref="S3.SS3.p7.6.m6.1.2.3.2.4">subscript</csymbol><ci id="S3.SS3.p7.6.m6.1.2.3.2.4.2.cmml" xref="S3.SS3.p7.6.m6.1.2.3.2.4.2">𝑓</ci><apply id="S3.SS3.p7.6.m6.1.2.3.2.4.3.cmml" xref="S3.SS3.p7.6.m6.1.2.3.2.4.3"><csymbol cd="ambiguous" id="S3.SS3.p7.6.m6.1.2.3.2.4.3.1.cmml" xref="S3.SS3.p7.6.m6.1.2.3.2.4.3">subscript</csymbol><ci id="S3.SS3.p7.6.m6.1.2.3.2.4.3.2.cmml" xref="S3.SS3.p7.6.m6.1.2.3.2.4.3.2">𝐿</ci><cn id="S3.SS3.p7.6.m6.1.2.3.2.4.3.3.cmml" type="integer" xref="S3.SS3.p7.6.m6.1.2.3.2.4.3.3">1</cn></apply></apply></apply><ci id="S3.SS3.p7.6.m6.1.1.cmml" xref="S3.SS3.p7.6.m6.1.1">𝐱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.6.m6.1c">\mathbf{z}=f_{1}\circ...\circ f_{L_{1}}(\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.6.m6.1d">bold_z = italic_f start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∘ … ∘ italic_f start_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_x )</annotation></semantics></math> we can write the score <math alttext="s(\mathbf{x},f)" class="ltx_Math" display="inline" id="S3.SS3.p7.7.m7.2"><semantics id="S3.SS3.p7.7.m7.2a"><mrow id="S3.SS3.p7.7.m7.2.3" xref="S3.SS3.p7.7.m7.2.3.cmml"><mi id="S3.SS3.p7.7.m7.2.3.2" xref="S3.SS3.p7.7.m7.2.3.2.cmml">s</mi><mo id="S3.SS3.p7.7.m7.2.3.1" xref="S3.SS3.p7.7.m7.2.3.1.cmml">⁢</mo><mrow id="S3.SS3.p7.7.m7.2.3.3.2" xref="S3.SS3.p7.7.m7.2.3.3.1.cmml"><mo id="S3.SS3.p7.7.m7.2.3.3.2.1" stretchy="false" xref="S3.SS3.p7.7.m7.2.3.3.1.cmml">(</mo><mi id="S3.SS3.p7.7.m7.1.1" xref="S3.SS3.p7.7.m7.1.1.cmml">𝐱</mi><mo id="S3.SS3.p7.7.m7.2.3.3.2.2" xref="S3.SS3.p7.7.m7.2.3.3.1.cmml">,</mo><mi id="S3.SS3.p7.7.m7.2.2" xref="S3.SS3.p7.7.m7.2.2.cmml">f</mi><mo id="S3.SS3.p7.7.m7.2.3.3.2.3" stretchy="false" xref="S3.SS3.p7.7.m7.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.7.m7.2b"><apply id="S3.SS3.p7.7.m7.2.3.cmml" xref="S3.SS3.p7.7.m7.2.3"><times id="S3.SS3.p7.7.m7.2.3.1.cmml" xref="S3.SS3.p7.7.m7.2.3.1"></times><ci id="S3.SS3.p7.7.m7.2.3.2.cmml" xref="S3.SS3.p7.7.m7.2.3.2">𝑠</ci><interval closure="open" id="S3.SS3.p7.7.m7.2.3.3.1.cmml" xref="S3.SS3.p7.7.m7.2.3.3.2"><ci id="S3.SS3.p7.7.m7.1.1.cmml" xref="S3.SS3.p7.7.m7.1.1">𝐱</ci><ci id="S3.SS3.p7.7.m7.2.2.cmml" xref="S3.SS3.p7.7.m7.2.2">𝑓</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.7.m7.2c">s(\mathbf{x},f)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.7.m7.2d">italic_s ( bold_x , italic_f )</annotation></semantics></math> as a function of <math alttext="\mathbf{z}" class="ltx_Math" display="inline" id="S3.SS3.p7.8.m8.1"><semantics id="S3.SS3.p7.8.m8.1a"><mi id="S3.SS3.p7.8.m8.1.1" xref="S3.SS3.p7.8.m8.1.1.cmml">𝐳</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.8.m8.1b"><ci id="S3.SS3.p7.8.m8.1.1.cmml" xref="S3.SS3.p7.8.m8.1.1">𝐳</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.8.m8.1c">\mathbf{z}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.8.m8.1d">bold_z</annotation></semantics></math>:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S3.SS3.p8">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx4">
<tbody id="S3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\tilde{s}(\mathbf{z})=\max{\left({\{\theta_{y,y^{\prime}}(\mathbf%
{z})\}_{y^{\prime}\in\mathcal{Y},y^{\prime}\neq y}}\right)}" class="ltx_Math" display="inline" id="S3.E3.m1.8"><semantics id="S3.E3.m1.8a"><mrow id="S3.E3.m1.8.8" xref="S3.E3.m1.8.8.cmml"><mrow id="S3.E3.m1.8.8.3" xref="S3.E3.m1.8.8.3.cmml"><mover accent="true" id="S3.E3.m1.8.8.3.2" xref="S3.E3.m1.8.8.3.2.cmml"><mi id="S3.E3.m1.8.8.3.2.2" xref="S3.E3.m1.8.8.3.2.2.cmml">s</mi><mo id="S3.E3.m1.8.8.3.2.1" xref="S3.E3.m1.8.8.3.2.1.cmml">~</mo></mover><mo id="S3.E3.m1.8.8.3.1" xref="S3.E3.m1.8.8.3.1.cmml">⁢</mo><mrow id="S3.E3.m1.8.8.3.3.2" xref="S3.E3.m1.8.8.3.cmml"><mo id="S3.E3.m1.8.8.3.3.2.1" stretchy="false" xref="S3.E3.m1.8.8.3.cmml">(</mo><mi id="S3.E3.m1.5.5" xref="S3.E3.m1.5.5.cmml">𝐳</mi><mo id="S3.E3.m1.8.8.3.3.2.2" stretchy="false" xref="S3.E3.m1.8.8.3.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.8.8.2" xref="S3.E3.m1.8.8.2.cmml">=</mo><mrow id="S3.E3.m1.8.8.1.1" xref="S3.E3.m1.8.8.1.2.cmml"><mi id="S3.E3.m1.7.7" xref="S3.E3.m1.7.7.cmml">max</mi><mo id="S3.E3.m1.8.8.1.1a" xref="S3.E3.m1.8.8.1.2.cmml">⁡</mo><mrow id="S3.E3.m1.8.8.1.1.1" xref="S3.E3.m1.8.8.1.2.cmml"><mo id="S3.E3.m1.8.8.1.1.1.2" xref="S3.E3.m1.8.8.1.2.cmml">(</mo><msub id="S3.E3.m1.8.8.1.1.1.1" xref="S3.E3.m1.8.8.1.1.1.1.cmml"><mrow id="S3.E3.m1.8.8.1.1.1.1.1.1" xref="S3.E3.m1.8.8.1.1.1.1.1.2.cmml"><mo id="S3.E3.m1.8.8.1.1.1.1.1.1.2" stretchy="false" xref="S3.E3.m1.8.8.1.1.1.1.1.2.cmml">{</mo><mrow id="S3.E3.m1.8.8.1.1.1.1.1.1.1" xref="S3.E3.m1.8.8.1.1.1.1.1.1.1.cmml"><msub id="S3.E3.m1.8.8.1.1.1.1.1.1.1.2" xref="S3.E3.m1.8.8.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E3.m1.8.8.1.1.1.1.1.1.1.2.2" xref="S3.E3.m1.8.8.1.1.1.1.1.1.1.2.2.cmml">θ</mi><mrow id="S3.E3.m1.2.2.2.2" xref="S3.E3.m1.2.2.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml">y</mi><mo id="S3.E3.m1.2.2.2.2.2" xref="S3.E3.m1.2.2.2.3.cmml">,</mo><msup id="S3.E3.m1.2.2.2.2.1" xref="S3.E3.m1.2.2.2.2.1.cmml"><mi id="S3.E3.m1.2.2.2.2.1.2" xref="S3.E3.m1.2.2.2.2.1.2.cmml">y</mi><mo id="S3.E3.m1.2.2.2.2.1.3" xref="S3.E3.m1.2.2.2.2.1.3.cmml">′</mo></msup></mrow></msub><mo id="S3.E3.m1.8.8.1.1.1.1.1.1.1.1" xref="S3.E3.m1.8.8.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E3.m1.8.8.1.1.1.1.1.1.1.3.2" xref="S3.E3.m1.8.8.1.1.1.1.1.1.1.cmml"><mo id="S3.E3.m1.8.8.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.E3.m1.8.8.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E3.m1.6.6" xref="S3.E3.m1.6.6.cmml">𝐳</mi><mo id="S3.E3.m1.8.8.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.E3.m1.8.8.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.8.8.1.1.1.1.1.1.3" stretchy="false" xref="S3.E3.m1.8.8.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.E3.m1.4.4.2.2" xref="S3.E3.m1.4.4.2.3.cmml"><mrow id="S3.E3.m1.3.3.1.1.1" xref="S3.E3.m1.3.3.1.1.1.cmml"><msup id="S3.E3.m1.3.3.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.2.cmml"><mi id="S3.E3.m1.3.3.1.1.1.2.2" xref="S3.E3.m1.3.3.1.1.1.2.2.cmml">y</mi><mo id="S3.E3.m1.3.3.1.1.1.2.3" xref="S3.E3.m1.3.3.1.1.1.2.3.cmml">′</mo></msup><mo id="S3.E3.m1.3.3.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.3.3.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.3.cmml">𝒴</mi></mrow><mo id="S3.E3.m1.4.4.2.2.3" xref="S3.E3.m1.4.4.2.3a.cmml">,</mo><mrow id="S3.E3.m1.4.4.2.2.2" xref="S3.E3.m1.4.4.2.2.2.cmml"><msup id="S3.E3.m1.4.4.2.2.2.2" xref="S3.E3.m1.4.4.2.2.2.2.cmml"><mi id="S3.E3.m1.4.4.2.2.2.2.2" xref="S3.E3.m1.4.4.2.2.2.2.2.cmml">y</mi><mo id="S3.E3.m1.4.4.2.2.2.2.3" xref="S3.E3.m1.4.4.2.2.2.2.3.cmml">′</mo></msup><mo id="S3.E3.m1.4.4.2.2.2.1" xref="S3.E3.m1.4.4.2.2.2.1.cmml">≠</mo><mi id="S3.E3.m1.4.4.2.2.2.3" xref="S3.E3.m1.4.4.2.2.2.3.cmml">y</mi></mrow></mrow></msub><mo id="S3.E3.m1.8.8.1.1.1.3" xref="S3.E3.m1.8.8.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.8b"><apply id="S3.E3.m1.8.8.cmml" xref="S3.E3.m1.8.8"><eq id="S3.E3.m1.8.8.2.cmml" xref="S3.E3.m1.8.8.2"></eq><apply id="S3.E3.m1.8.8.3.cmml" xref="S3.E3.m1.8.8.3"><times id="S3.E3.m1.8.8.3.1.cmml" xref="S3.E3.m1.8.8.3.1"></times><apply id="S3.E3.m1.8.8.3.2.cmml" xref="S3.E3.m1.8.8.3.2"><ci id="S3.E3.m1.8.8.3.2.1.cmml" xref="S3.E3.m1.8.8.3.2.1">~</ci><ci id="S3.E3.m1.8.8.3.2.2.cmml" xref="S3.E3.m1.8.8.3.2.2">𝑠</ci></apply><ci id="S3.E3.m1.5.5.cmml" xref="S3.E3.m1.5.5">𝐳</ci></apply><apply id="S3.E3.m1.8.8.1.2.cmml" xref="S3.E3.m1.8.8.1.1"><max id="S3.E3.m1.7.7.cmml" xref="S3.E3.m1.7.7"></max><apply id="S3.E3.m1.8.8.1.1.1.1.cmml" xref="S3.E3.m1.8.8.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.8.8.1.1.1.1.2.cmml" xref="S3.E3.m1.8.8.1.1.1.1">subscript</csymbol><set id="S3.E3.m1.8.8.1.1.1.1.1.2.cmml" xref="S3.E3.m1.8.8.1.1.1.1.1.1"><apply id="S3.E3.m1.8.8.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.8.8.1.1.1.1.1.1.1"><times id="S3.E3.m1.8.8.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.8.8.1.1.1.1.1.1.1.1"></times><apply id="S3.E3.m1.8.8.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.8.8.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.8.8.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.8.8.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E3.m1.8.8.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.8.8.1.1.1.1.1.1.1.2.2">𝜃</ci><list id="S3.E3.m1.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.2"><ci id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1">𝑦</ci><apply id="S3.E3.m1.2.2.2.2.1.cmml" xref="S3.E3.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.2.1.1.cmml" xref="S3.E3.m1.2.2.2.2.1">superscript</csymbol><ci id="S3.E3.m1.2.2.2.2.1.2.cmml" xref="S3.E3.m1.2.2.2.2.1.2">𝑦</ci><ci id="S3.E3.m1.2.2.2.2.1.3.cmml" xref="S3.E3.m1.2.2.2.2.1.3">′</ci></apply></list></apply><ci id="S3.E3.m1.6.6.cmml" xref="S3.E3.m1.6.6">𝐳</ci></apply></set><apply id="S3.E3.m1.4.4.2.3.cmml" xref="S3.E3.m1.4.4.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.2.3a.cmml" xref="S3.E3.m1.4.4.2.2.3">formulae-sequence</csymbol><apply id="S3.E3.m1.3.3.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1"><in id="S3.E3.m1.3.3.1.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1"></in><apply id="S3.E3.m1.3.3.1.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.1.2.1.cmml" xref="S3.E3.m1.3.3.1.1.1.2">superscript</csymbol><ci id="S3.E3.m1.3.3.1.1.1.2.2.cmml" xref="S3.E3.m1.3.3.1.1.1.2.2">𝑦</ci><ci id="S3.E3.m1.3.3.1.1.1.2.3.cmml" xref="S3.E3.m1.3.3.1.1.1.2.3">′</ci></apply><ci id="S3.E3.m1.3.3.1.1.1.3.cmml" xref="S3.E3.m1.3.3.1.1.1.3">𝒴</ci></apply><apply id="S3.E3.m1.4.4.2.2.2.cmml" xref="S3.E3.m1.4.4.2.2.2"><neq id="S3.E3.m1.4.4.2.2.2.1.cmml" xref="S3.E3.m1.4.4.2.2.2.1"></neq><apply id="S3.E3.m1.4.4.2.2.2.2.cmml" xref="S3.E3.m1.4.4.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.2.2.2.2.1.cmml" xref="S3.E3.m1.4.4.2.2.2.2">superscript</csymbol><ci id="S3.E3.m1.4.4.2.2.2.2.2.cmml" xref="S3.E3.m1.4.4.2.2.2.2.2">𝑦</ci><ci id="S3.E3.m1.4.4.2.2.2.2.3.cmml" xref="S3.E3.m1.4.4.2.2.2.2.3">′</ci></apply><ci id="S3.E3.m1.4.4.2.2.2.3.cmml" xref="S3.E3.m1.4.4.2.2.2.3">𝑦</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.8c">\displaystyle\tilde{s}(\mathbf{z})=\max{\left({\{\theta_{y,y^{\prime}}(\mathbf%
{z})\}_{y^{\prime}\in\mathcal{Y},y^{\prime}\neq y}}\right)}</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.8d">over~ start_ARG italic_s end_ARG ( bold_z ) = roman_max ( { italic_θ start_POSTSUBSCRIPT italic_y , italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( bold_z ) } start_POSTSUBSCRIPT italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∈ caligraphic_Y , italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ≠ italic_y end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.p9">
<p class="ltx_p" id="S3.SS3.p9.1"><span class="ltx_text ltx_font_bold" id="S3.SS3.p9.1.1">Properties.</span> Intuitively, our score function captures several key aspects:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S3.SS3.p10">
<ul class="ltx_itemize" id="S3.I1">
<li class="ltx_item" id="S3.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i1.p1">
<p class="ltx_p" id="S3.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I1.i1.p1.1.1">Confidence Measure.</span> The angle between the feature representation and its projection onto a decision boundary is proportional to the distance between them, serving as a proxy for the model’s confidence.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S3.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i2.p1">
<p class="ltx_p" id="S3.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I1.i2.p1.1.1">In-Distribution Context.</span> By centering the space using the mean of in-distribution features, we incorporate ID statistics, improving angle separability across points.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S3.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i3.p1">
<p class="ltx_p" id="S3.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I1.i3.p1.1.1">Maximum Discrepancy.</span> By considering the maximum angle across all non-predicted classes, we identify the ’furthest’ relative decision boundary, extracting model’s confidence on least likely class that an instance might belong.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S3.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i4.p1">
<p class="ltx_p" id="S3.I1.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I1.i4.p1.1.1">Scale Invariance.</span> Unlike absolute distances, angles remain consistent even if the feature space is scaled, allowing for fair comparisons between different models.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S3.SS3.p11">
<p class="ltx_p" id="S3.SS3.p11.1"><span class="ltx_text ltx_font_bold" id="S3.SS3.p11.1.1">Relation with the state-of-the-art fDBD &nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib25" title="">25</a>]</cite>).</span>  We now provide a geometric interpretation for the score function fDBD. Using our analysis, we identified that their score can directly be mapped into the triangle we formed in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#S2.F1" title="Figure 1 ‣ Score Functions ‣ 2 Related Work ‣ Look Around and Find Out: OOD Detection with Relative Angles"><span class="ltx_text ltx_ref_tag">1</span></a>. For a sample <math alttext="\mathbf{x}\in\mathcal{X}" class="ltx_Math" display="inline" id="S3.SS3.p11.1.m1.1"><semantics id="S3.SS3.p11.1.m1.1a"><mrow id="S3.SS3.p11.1.m1.1.1" xref="S3.SS3.p11.1.m1.1.1.cmml"><mi id="S3.SS3.p11.1.m1.1.1.2" xref="S3.SS3.p11.1.m1.1.1.2.cmml">𝐱</mi><mo id="S3.SS3.p11.1.m1.1.1.1" xref="S3.SS3.p11.1.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p11.1.m1.1.1.3" xref="S3.SS3.p11.1.m1.1.1.3.cmml">𝒳</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p11.1.m1.1b"><apply id="S3.SS3.p11.1.m1.1.1.cmml" xref="S3.SS3.p11.1.m1.1.1"><in id="S3.SS3.p11.1.m1.1.1.1.cmml" xref="S3.SS3.p11.1.m1.1.1.1"></in><ci id="S3.SS3.p11.1.m1.1.1.2.cmml" xref="S3.SS3.p11.1.m1.1.1.2">𝐱</ci><ci id="S3.SS3.p11.1.m1.1.1.3.cmml" xref="S3.SS3.p11.1.m1.1.1.3">𝒳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p11.1.m1.1c">\mathbf{x}\in\mathcal{X}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p11.1.m1.1d">bold_x ∈ caligraphic_X</annotation></semantics></math>:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S3.SS3.p12">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx5">
<tbody id="S3.Ex3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\text{fDBD}(\mathbf{z})=\frac{d(\mathbf{z},\mathbf{z}_{db})}{||%
\mathbf{z}-\bm{\mu_{\text{ID}}}||_{2}}" class="ltx_Math" display="inline" id="S3.Ex3.m1.4"><semantics id="S3.Ex3.m1.4a"><mrow id="S3.Ex3.m1.4.5" xref="S3.Ex3.m1.4.5.cmml"><mrow id="S3.Ex3.m1.4.5.2" xref="S3.Ex3.m1.4.5.2.cmml"><mtext id="S3.Ex3.m1.4.5.2.2" xref="S3.Ex3.m1.4.5.2.2a.cmml">fDBD</mtext><mo id="S3.Ex3.m1.4.5.2.1" xref="S3.Ex3.m1.4.5.2.1.cmml">⁢</mo><mrow id="S3.Ex3.m1.4.5.2.3.2" xref="S3.Ex3.m1.4.5.2.cmml"><mo id="S3.Ex3.m1.4.5.2.3.2.1" stretchy="false" xref="S3.Ex3.m1.4.5.2.cmml">(</mo><mi id="S3.Ex3.m1.4.4" xref="S3.Ex3.m1.4.4.cmml">𝐳</mi><mo id="S3.Ex3.m1.4.5.2.3.2.2" stretchy="false" xref="S3.Ex3.m1.4.5.2.cmml">)</mo></mrow></mrow><mo id="S3.Ex3.m1.4.5.1" xref="S3.Ex3.m1.4.5.1.cmml">=</mo><mstyle displaystyle="true" id="S3.Ex3.m1.3.3" xref="S3.Ex3.m1.3.3.cmml"><mfrac id="S3.Ex3.m1.3.3a" xref="S3.Ex3.m1.3.3.cmml"><mrow id="S3.Ex3.m1.2.2.2" xref="S3.Ex3.m1.2.2.2.cmml"><mi id="S3.Ex3.m1.2.2.2.4" xref="S3.Ex3.m1.2.2.2.4.cmml">d</mi><mo id="S3.Ex3.m1.2.2.2.3" xref="S3.Ex3.m1.2.2.2.3.cmml">⁢</mo><mrow id="S3.Ex3.m1.2.2.2.2.1" xref="S3.Ex3.m1.2.2.2.2.2.cmml"><mo id="S3.Ex3.m1.2.2.2.2.1.2" stretchy="false" xref="S3.Ex3.m1.2.2.2.2.2.cmml">(</mo><mi id="S3.Ex3.m1.1.1.1.1" xref="S3.Ex3.m1.1.1.1.1.cmml">𝐳</mi><mo id="S3.Ex3.m1.2.2.2.2.1.3" xref="S3.Ex3.m1.2.2.2.2.2.cmml">,</mo><msub id="S3.Ex3.m1.2.2.2.2.1.1" xref="S3.Ex3.m1.2.2.2.2.1.1.cmml"><mi id="S3.Ex3.m1.2.2.2.2.1.1.2" xref="S3.Ex3.m1.2.2.2.2.1.1.2.cmml">𝐳</mi><mrow id="S3.Ex3.m1.2.2.2.2.1.1.3" xref="S3.Ex3.m1.2.2.2.2.1.1.3.cmml"><mi id="S3.Ex3.m1.2.2.2.2.1.1.3.2" xref="S3.Ex3.m1.2.2.2.2.1.1.3.2.cmml">d</mi><mo id="S3.Ex3.m1.2.2.2.2.1.1.3.1" xref="S3.Ex3.m1.2.2.2.2.1.1.3.1.cmml">⁢</mo><mi id="S3.Ex3.m1.2.2.2.2.1.1.3.3" xref="S3.Ex3.m1.2.2.2.2.1.1.3.3.cmml">b</mi></mrow></msub><mo id="S3.Ex3.m1.2.2.2.2.1.4" stretchy="false" xref="S3.Ex3.m1.2.2.2.2.2.cmml">)</mo></mrow></mrow><msub id="S3.Ex3.m1.3.3.3" xref="S3.Ex3.m1.3.3.3.cmml"><mrow id="S3.Ex3.m1.3.3.3.1.1" xref="S3.Ex3.m1.3.3.3.1.2.cmml"><mo id="S3.Ex3.m1.3.3.3.1.1.2" stretchy="false" xref="S3.Ex3.m1.3.3.3.1.2.1.cmml">‖</mo><mrow id="S3.Ex3.m1.3.3.3.1.1.1" xref="S3.Ex3.m1.3.3.3.1.1.1.cmml"><mi id="S3.Ex3.m1.3.3.3.1.1.1.2" xref="S3.Ex3.m1.3.3.3.1.1.1.2.cmml">𝐳</mi><mo id="S3.Ex3.m1.3.3.3.1.1.1.1" xref="S3.Ex3.m1.3.3.3.1.1.1.1.cmml">−</mo><msub id="S3.Ex3.m1.3.3.3.1.1.1.3" xref="S3.Ex3.m1.3.3.3.1.1.1.3.cmml"><mi id="S3.Ex3.m1.3.3.3.1.1.1.3.2" xref="S3.Ex3.m1.3.3.3.1.1.1.3.2.cmml">𝝁</mi><mtext id="S3.Ex3.m1.3.3.3.1.1.1.3.3" xref="S3.Ex3.m1.3.3.3.1.1.1.3.3a.cmml">ID</mtext></msub></mrow><mo id="S3.Ex3.m1.3.3.3.1.1.3" stretchy="false" xref="S3.Ex3.m1.3.3.3.1.2.1.cmml">‖</mo></mrow><mn id="S3.Ex3.m1.3.3.3.3" xref="S3.Ex3.m1.3.3.3.3.cmml">2</mn></msub></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex3.m1.4b"><apply id="S3.Ex3.m1.4.5.cmml" xref="S3.Ex3.m1.4.5"><eq id="S3.Ex3.m1.4.5.1.cmml" xref="S3.Ex3.m1.4.5.1"></eq><apply id="S3.Ex3.m1.4.5.2.cmml" xref="S3.Ex3.m1.4.5.2"><times id="S3.Ex3.m1.4.5.2.1.cmml" xref="S3.Ex3.m1.4.5.2.1"></times><ci id="S3.Ex3.m1.4.5.2.2a.cmml" xref="S3.Ex3.m1.4.5.2.2"><mtext id="S3.Ex3.m1.4.5.2.2.cmml" xref="S3.Ex3.m1.4.5.2.2">fDBD</mtext></ci><ci id="S3.Ex3.m1.4.4.cmml" xref="S3.Ex3.m1.4.4">𝐳</ci></apply><apply id="S3.Ex3.m1.3.3.cmml" xref="S3.Ex3.m1.3.3"><divide id="S3.Ex3.m1.3.3.4.cmml" xref="S3.Ex3.m1.3.3"></divide><apply id="S3.Ex3.m1.2.2.2.cmml" xref="S3.Ex3.m1.2.2.2"><times id="S3.Ex3.m1.2.2.2.3.cmml" xref="S3.Ex3.m1.2.2.2.3"></times><ci id="S3.Ex3.m1.2.2.2.4.cmml" xref="S3.Ex3.m1.2.2.2.4">𝑑</ci><interval closure="open" id="S3.Ex3.m1.2.2.2.2.2.cmml" xref="S3.Ex3.m1.2.2.2.2.1"><ci id="S3.Ex3.m1.1.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1.1">𝐳</ci><apply id="S3.Ex3.m1.2.2.2.2.1.1.cmml" xref="S3.Ex3.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.Ex3.m1.2.2.2.2.1.1.1.cmml" xref="S3.Ex3.m1.2.2.2.2.1.1">subscript</csymbol><ci id="S3.Ex3.m1.2.2.2.2.1.1.2.cmml" xref="S3.Ex3.m1.2.2.2.2.1.1.2">𝐳</ci><apply id="S3.Ex3.m1.2.2.2.2.1.1.3.cmml" xref="S3.Ex3.m1.2.2.2.2.1.1.3"><times id="S3.Ex3.m1.2.2.2.2.1.1.3.1.cmml" xref="S3.Ex3.m1.2.2.2.2.1.1.3.1"></times><ci id="S3.Ex3.m1.2.2.2.2.1.1.3.2.cmml" xref="S3.Ex3.m1.2.2.2.2.1.1.3.2">𝑑</ci><ci id="S3.Ex3.m1.2.2.2.2.1.1.3.3.cmml" xref="S3.Ex3.m1.2.2.2.2.1.1.3.3">𝑏</ci></apply></apply></interval></apply><apply id="S3.Ex3.m1.3.3.3.cmml" xref="S3.Ex3.m1.3.3.3"><csymbol cd="ambiguous" id="S3.Ex3.m1.3.3.3.2.cmml" xref="S3.Ex3.m1.3.3.3">subscript</csymbol><apply id="S3.Ex3.m1.3.3.3.1.2.cmml" xref="S3.Ex3.m1.3.3.3.1.1"><csymbol cd="latexml" id="S3.Ex3.m1.3.3.3.1.2.1.cmml" xref="S3.Ex3.m1.3.3.3.1.1.2">norm</csymbol><apply id="S3.Ex3.m1.3.3.3.1.1.1.cmml" xref="S3.Ex3.m1.3.3.3.1.1.1"><minus id="S3.Ex3.m1.3.3.3.1.1.1.1.cmml" xref="S3.Ex3.m1.3.3.3.1.1.1.1"></minus><ci id="S3.Ex3.m1.3.3.3.1.1.1.2.cmml" xref="S3.Ex3.m1.3.3.3.1.1.1.2">𝐳</ci><apply id="S3.Ex3.m1.3.3.3.1.1.1.3.cmml" xref="S3.Ex3.m1.3.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex3.m1.3.3.3.1.1.1.3.1.cmml" xref="S3.Ex3.m1.3.3.3.1.1.1.3">subscript</csymbol><ci id="S3.Ex3.m1.3.3.3.1.1.1.3.2.cmml" xref="S3.Ex3.m1.3.3.3.1.1.1.3.2">𝝁</ci><ci id="S3.Ex3.m1.3.3.3.1.1.1.3.3a.cmml" xref="S3.Ex3.m1.3.3.3.1.1.1.3.3"><mtext id="S3.Ex3.m1.3.3.3.1.1.1.3.3.cmml" mathsize="70%" xref="S3.Ex3.m1.3.3.3.1.1.1.3.3">ID</mtext></ci></apply></apply></apply><cn id="S3.Ex3.m1.3.3.3.3.cmml" type="integer" xref="S3.Ex3.m1.3.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex3.m1.4c">\displaystyle\text{fDBD}(\mathbf{z})=\frac{d(\mathbf{z},\mathbf{z}_{db})}{||%
\mathbf{z}-\bm{\mu_{\text{ID}}}||_{2}}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex3.m1.4d">fDBD ( bold_z ) = divide start_ARG italic_d ( bold_z , bold_z start_POSTSUBSCRIPT italic_d italic_b end_POSTSUBSCRIPT ) end_ARG start_ARG | | bold_z - bold_italic_μ start_POSTSUBSCRIPT ID end_POSTSUBSCRIPT | | start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.p13">
<p class="ltx_p" id="S3.SS3.p13.4">where <math alttext="\mathbf{z}\in\mathbb{R}^{D}" class="ltx_Math" display="inline" id="S3.SS3.p13.1.m1.1"><semantics id="S3.SS3.p13.1.m1.1a"><mrow id="S3.SS3.p13.1.m1.1.1" xref="S3.SS3.p13.1.m1.1.1.cmml"><mi id="S3.SS3.p13.1.m1.1.1.2" xref="S3.SS3.p13.1.m1.1.1.2.cmml">𝐳</mi><mo id="S3.SS3.p13.1.m1.1.1.1" xref="S3.SS3.p13.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS3.p13.1.m1.1.1.3" xref="S3.SS3.p13.1.m1.1.1.3.cmml"><mi id="S3.SS3.p13.1.m1.1.1.3.2" xref="S3.SS3.p13.1.m1.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS3.p13.1.m1.1.1.3.3" xref="S3.SS3.p13.1.m1.1.1.3.3.cmml">D</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p13.1.m1.1b"><apply id="S3.SS3.p13.1.m1.1.1.cmml" xref="S3.SS3.p13.1.m1.1.1"><in id="S3.SS3.p13.1.m1.1.1.1.cmml" xref="S3.SS3.p13.1.m1.1.1.1"></in><ci id="S3.SS3.p13.1.m1.1.1.2.cmml" xref="S3.SS3.p13.1.m1.1.1.2">𝐳</ci><apply id="S3.SS3.p13.1.m1.1.1.3.cmml" xref="S3.SS3.p13.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p13.1.m1.1.1.3.1.cmml" xref="S3.SS3.p13.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS3.p13.1.m1.1.1.3.2.cmml" xref="S3.SS3.p13.1.m1.1.1.3.2">ℝ</ci><ci id="S3.SS3.p13.1.m1.1.1.3.3.cmml" xref="S3.SS3.p13.1.m1.1.1.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p13.1.m1.1c">\mathbf{z}\in\mathbb{R}^{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p13.1.m1.1d">bold_z ∈ blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> is the feature representations of the input <math alttext="x\in\mathcal{X}" class="ltx_Math" display="inline" id="S3.SS3.p13.2.m2.1"><semantics id="S3.SS3.p13.2.m2.1a"><mrow id="S3.SS3.p13.2.m2.1.1" xref="S3.SS3.p13.2.m2.1.1.cmml"><mi id="S3.SS3.p13.2.m2.1.1.2" xref="S3.SS3.p13.2.m2.1.1.2.cmml">x</mi><mo id="S3.SS3.p13.2.m2.1.1.1" xref="S3.SS3.p13.2.m2.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p13.2.m2.1.1.3" xref="S3.SS3.p13.2.m2.1.1.3.cmml">𝒳</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p13.2.m2.1b"><apply id="S3.SS3.p13.2.m2.1.1.cmml" xref="S3.SS3.p13.2.m2.1.1"><in id="S3.SS3.p13.2.m2.1.1.1.cmml" xref="S3.SS3.p13.2.m2.1.1.1"></in><ci id="S3.SS3.p13.2.m2.1.1.2.cmml" xref="S3.SS3.p13.2.m2.1.1.2">𝑥</ci><ci id="S3.SS3.p13.2.m2.1.1.3.cmml" xref="S3.SS3.p13.2.m2.1.1.3">𝒳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p13.2.m2.1c">x\in\mathcal{X}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p13.2.m2.1d">italic_x ∈ caligraphic_X</annotation></semantics></math>, <math alttext="\mathbf{z}_{db}\in\mathbb{R}^{D}" class="ltx_Math" display="inline" id="S3.SS3.p13.3.m3.1"><semantics id="S3.SS3.p13.3.m3.1a"><mrow id="S3.SS3.p13.3.m3.1.1" xref="S3.SS3.p13.3.m3.1.1.cmml"><msub id="S3.SS3.p13.3.m3.1.1.2" xref="S3.SS3.p13.3.m3.1.1.2.cmml"><mi id="S3.SS3.p13.3.m3.1.1.2.2" xref="S3.SS3.p13.3.m3.1.1.2.2.cmml">𝐳</mi><mrow id="S3.SS3.p13.3.m3.1.1.2.3" xref="S3.SS3.p13.3.m3.1.1.2.3.cmml"><mi id="S3.SS3.p13.3.m3.1.1.2.3.2" xref="S3.SS3.p13.3.m3.1.1.2.3.2.cmml">d</mi><mo id="S3.SS3.p13.3.m3.1.1.2.3.1" xref="S3.SS3.p13.3.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.p13.3.m3.1.1.2.3.3" xref="S3.SS3.p13.3.m3.1.1.2.3.3.cmml">b</mi></mrow></msub><mo id="S3.SS3.p13.3.m3.1.1.1" xref="S3.SS3.p13.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS3.p13.3.m3.1.1.3" xref="S3.SS3.p13.3.m3.1.1.3.cmml"><mi id="S3.SS3.p13.3.m3.1.1.3.2" xref="S3.SS3.p13.3.m3.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS3.p13.3.m3.1.1.3.3" xref="S3.SS3.p13.3.m3.1.1.3.3.cmml">D</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p13.3.m3.1b"><apply id="S3.SS3.p13.3.m3.1.1.cmml" xref="S3.SS3.p13.3.m3.1.1"><in id="S3.SS3.p13.3.m3.1.1.1.cmml" xref="S3.SS3.p13.3.m3.1.1.1"></in><apply id="S3.SS3.p13.3.m3.1.1.2.cmml" xref="S3.SS3.p13.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p13.3.m3.1.1.2.1.cmml" xref="S3.SS3.p13.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS3.p13.3.m3.1.1.2.2.cmml" xref="S3.SS3.p13.3.m3.1.1.2.2">𝐳</ci><apply id="S3.SS3.p13.3.m3.1.1.2.3.cmml" xref="S3.SS3.p13.3.m3.1.1.2.3"><times id="S3.SS3.p13.3.m3.1.1.2.3.1.cmml" xref="S3.SS3.p13.3.m3.1.1.2.3.1"></times><ci id="S3.SS3.p13.3.m3.1.1.2.3.2.cmml" xref="S3.SS3.p13.3.m3.1.1.2.3.2">𝑑</ci><ci id="S3.SS3.p13.3.m3.1.1.2.3.3.cmml" xref="S3.SS3.p13.3.m3.1.1.2.3.3">𝑏</ci></apply></apply><apply id="S3.SS3.p13.3.m3.1.1.3.cmml" xref="S3.SS3.p13.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p13.3.m3.1.1.3.1.cmml" xref="S3.SS3.p13.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS3.p13.3.m3.1.1.3.2.cmml" xref="S3.SS3.p13.3.m3.1.1.3.2">ℝ</ci><ci id="S3.SS3.p13.3.m3.1.1.3.3.cmml" xref="S3.SS3.p13.3.m3.1.1.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p13.3.m3.1c">\mathbf{z}_{db}\in\mathbb{R}^{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p13.3.m3.1d">bold_z start_POSTSUBSCRIPT italic_d italic_b end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> is its projection onto the decision boundary, and <math alttext="d(\cdot,\cdot)" class="ltx_Math" display="inline" id="S3.SS3.p13.4.m4.2"><semantics id="S3.SS3.p13.4.m4.2a"><mrow id="S3.SS3.p13.4.m4.2.3" xref="S3.SS3.p13.4.m4.2.3.cmml"><mi id="S3.SS3.p13.4.m4.2.3.2" xref="S3.SS3.p13.4.m4.2.3.2.cmml">d</mi><mo id="S3.SS3.p13.4.m4.2.3.1" xref="S3.SS3.p13.4.m4.2.3.1.cmml">⁢</mo><mrow id="S3.SS3.p13.4.m4.2.3.3.2" xref="S3.SS3.p13.4.m4.2.3.3.1.cmml"><mo id="S3.SS3.p13.4.m4.2.3.3.2.1" stretchy="false" xref="S3.SS3.p13.4.m4.2.3.3.1.cmml">(</mo><mo id="S3.SS3.p13.4.m4.1.1" lspace="0em" rspace="0em" xref="S3.SS3.p13.4.m4.1.1.cmml">⋅</mo><mo id="S3.SS3.p13.4.m4.2.3.3.2.2" rspace="0em" xref="S3.SS3.p13.4.m4.2.3.3.1.cmml">,</mo><mo id="S3.SS3.p13.4.m4.2.2" lspace="0em" rspace="0em" xref="S3.SS3.p13.4.m4.2.2.cmml">⋅</mo><mo id="S3.SS3.p13.4.m4.2.3.3.2.3" stretchy="false" xref="S3.SS3.p13.4.m4.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p13.4.m4.2b"><apply id="S3.SS3.p13.4.m4.2.3.cmml" xref="S3.SS3.p13.4.m4.2.3"><times id="S3.SS3.p13.4.m4.2.3.1.cmml" xref="S3.SS3.p13.4.m4.2.3.1"></times><ci id="S3.SS3.p13.4.m4.2.3.2.cmml" xref="S3.SS3.p13.4.m4.2.3.2">𝑑</ci><interval closure="open" id="S3.SS3.p13.4.m4.2.3.3.1.cmml" xref="S3.SS3.p13.4.m4.2.3.3.2"><ci id="S3.SS3.p13.4.m4.1.1.cmml" xref="S3.SS3.p13.4.m4.1.1">⋅</ci><ci id="S3.SS3.p13.4.m4.2.2.cmml" xref="S3.SS3.p13.4.m4.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p13.4.m4.2c">d(\cdot,\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p13.4.m4.2d">italic_d ( ⋅ , ⋅ )</annotation></semantics></math> is the euclidean distance. Although seemingly unrelated, we can connect this score to our relative angle and demonstrate that the regularization term on the denominator brings a term that does not effectively discriminate between OOD and ID. As a result, impeding fDBD’s performance.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S3.SS3.p14">
<p class="ltx_p" id="S3.SS3.p14.1">Using translation invariance of the euclidean distance, the same score can be written as:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S3.SS3.p15">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx6">
<tbody id="S3.Ex4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\text{fDBD}(\mathbf{z})=\frac{d(\mathbf{z}-\bm{\mu_{\text{ID}}},%
\mathbf{z}_{db}-\bm{\mu_{\text{ID}}})}{d(\mathbf{z}-\bm{\mu_{\text{ID}}},0)}" class="ltx_Math" display="inline" id="S3.Ex4.m1.5"><semantics id="S3.Ex4.m1.5a"><mrow id="S3.Ex4.m1.5.6" xref="S3.Ex4.m1.5.6.cmml"><mrow id="S3.Ex4.m1.5.6.2" xref="S3.Ex4.m1.5.6.2.cmml"><mtext id="S3.Ex4.m1.5.6.2.2" xref="S3.Ex4.m1.5.6.2.2a.cmml">fDBD</mtext><mo id="S3.Ex4.m1.5.6.2.1" xref="S3.Ex4.m1.5.6.2.1.cmml">⁢</mo><mrow id="S3.Ex4.m1.5.6.2.3.2" xref="S3.Ex4.m1.5.6.2.cmml"><mo id="S3.Ex4.m1.5.6.2.3.2.1" stretchy="false" xref="S3.Ex4.m1.5.6.2.cmml">(</mo><mi id="S3.Ex4.m1.5.5" xref="S3.Ex4.m1.5.5.cmml">𝐳</mi><mo id="S3.Ex4.m1.5.6.2.3.2.2" stretchy="false" xref="S3.Ex4.m1.5.6.2.cmml">)</mo></mrow></mrow><mo id="S3.Ex4.m1.5.6.1" xref="S3.Ex4.m1.5.6.1.cmml">=</mo><mstyle displaystyle="true" id="S3.Ex4.m1.4.4" xref="S3.Ex4.m1.4.4.cmml"><mfrac id="S3.Ex4.m1.4.4a" xref="S3.Ex4.m1.4.4.cmml"><mrow id="S3.Ex4.m1.2.2.2" xref="S3.Ex4.m1.2.2.2.cmml"><mi id="S3.Ex4.m1.2.2.2.4" xref="S3.Ex4.m1.2.2.2.4.cmml">d</mi><mo id="S3.Ex4.m1.2.2.2.3" xref="S3.Ex4.m1.2.2.2.3.cmml">⁢</mo><mrow id="S3.Ex4.m1.2.2.2.2.2" xref="S3.Ex4.m1.2.2.2.2.3.cmml"><mo id="S3.Ex4.m1.2.2.2.2.2.3" stretchy="false" xref="S3.Ex4.m1.2.2.2.2.3.cmml">(</mo><mrow id="S3.Ex4.m1.1.1.1.1.1.1" xref="S3.Ex4.m1.1.1.1.1.1.1.cmml"><mi id="S3.Ex4.m1.1.1.1.1.1.1.2" xref="S3.Ex4.m1.1.1.1.1.1.1.2.cmml">𝐳</mi><mo id="S3.Ex4.m1.1.1.1.1.1.1.1" xref="S3.Ex4.m1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.Ex4.m1.1.1.1.1.1.1.3" xref="S3.Ex4.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex4.m1.1.1.1.1.1.1.3.2" xref="S3.Ex4.m1.1.1.1.1.1.1.3.2.cmml">𝝁</mi><mtext id="S3.Ex4.m1.1.1.1.1.1.1.3.3" xref="S3.Ex4.m1.1.1.1.1.1.1.3.3a.cmml">ID</mtext></msub></mrow><mo id="S3.Ex4.m1.2.2.2.2.2.4" xref="S3.Ex4.m1.2.2.2.2.3.cmml">,</mo><mrow id="S3.Ex4.m1.2.2.2.2.2.2" xref="S3.Ex4.m1.2.2.2.2.2.2.cmml"><msub id="S3.Ex4.m1.2.2.2.2.2.2.2" xref="S3.Ex4.m1.2.2.2.2.2.2.2.cmml"><mi id="S3.Ex4.m1.2.2.2.2.2.2.2.2" xref="S3.Ex4.m1.2.2.2.2.2.2.2.2.cmml">𝐳</mi><mrow id="S3.Ex4.m1.2.2.2.2.2.2.2.3" xref="S3.Ex4.m1.2.2.2.2.2.2.2.3.cmml"><mi id="S3.Ex4.m1.2.2.2.2.2.2.2.3.2" xref="S3.Ex4.m1.2.2.2.2.2.2.2.3.2.cmml">d</mi><mo id="S3.Ex4.m1.2.2.2.2.2.2.2.3.1" xref="S3.Ex4.m1.2.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.Ex4.m1.2.2.2.2.2.2.2.3.3" xref="S3.Ex4.m1.2.2.2.2.2.2.2.3.3.cmml">b</mi></mrow></msub><mo id="S3.Ex4.m1.2.2.2.2.2.2.1" xref="S3.Ex4.m1.2.2.2.2.2.2.1.cmml">−</mo><msub id="S3.Ex4.m1.2.2.2.2.2.2.3" xref="S3.Ex4.m1.2.2.2.2.2.2.3.cmml"><mi id="S3.Ex4.m1.2.2.2.2.2.2.3.2" xref="S3.Ex4.m1.2.2.2.2.2.2.3.2.cmml">𝝁</mi><mtext id="S3.Ex4.m1.2.2.2.2.2.2.3.3" xref="S3.Ex4.m1.2.2.2.2.2.2.3.3a.cmml">ID</mtext></msub></mrow><mo id="S3.Ex4.m1.2.2.2.2.2.5" stretchy="false" xref="S3.Ex4.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="S3.Ex4.m1.4.4.4" xref="S3.Ex4.m1.4.4.4.cmml"><mi id="S3.Ex4.m1.4.4.4.4" xref="S3.Ex4.m1.4.4.4.4.cmml">d</mi><mo id="S3.Ex4.m1.4.4.4.3" xref="S3.Ex4.m1.4.4.4.3.cmml">⁢</mo><mrow id="S3.Ex4.m1.4.4.4.2.1" xref="S3.Ex4.m1.4.4.4.2.2.cmml"><mo id="S3.Ex4.m1.4.4.4.2.1.2" stretchy="false" xref="S3.Ex4.m1.4.4.4.2.2.cmml">(</mo><mrow id="S3.Ex4.m1.4.4.4.2.1.1" xref="S3.Ex4.m1.4.4.4.2.1.1.cmml"><mi id="S3.Ex4.m1.4.4.4.2.1.1.2" xref="S3.Ex4.m1.4.4.4.2.1.1.2.cmml">𝐳</mi><mo id="S3.Ex4.m1.4.4.4.2.1.1.1" xref="S3.Ex4.m1.4.4.4.2.1.1.1.cmml">−</mo><msub id="S3.Ex4.m1.4.4.4.2.1.1.3" xref="S3.Ex4.m1.4.4.4.2.1.1.3.cmml"><mi id="S3.Ex4.m1.4.4.4.2.1.1.3.2" xref="S3.Ex4.m1.4.4.4.2.1.1.3.2.cmml">𝝁</mi><mtext id="S3.Ex4.m1.4.4.4.2.1.1.3.3" xref="S3.Ex4.m1.4.4.4.2.1.1.3.3a.cmml">ID</mtext></msub></mrow><mo id="S3.Ex4.m1.4.4.4.2.1.3" xref="S3.Ex4.m1.4.4.4.2.2.cmml">,</mo><mn id="S3.Ex4.m1.3.3.3.1" xref="S3.Ex4.m1.3.3.3.1.cmml">0</mn><mo id="S3.Ex4.m1.4.4.4.2.1.4" stretchy="false" xref="S3.Ex4.m1.4.4.4.2.2.cmml">)</mo></mrow></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex4.m1.5b"><apply id="S3.Ex4.m1.5.6.cmml" xref="S3.Ex4.m1.5.6"><eq id="S3.Ex4.m1.5.6.1.cmml" xref="S3.Ex4.m1.5.6.1"></eq><apply id="S3.Ex4.m1.5.6.2.cmml" xref="S3.Ex4.m1.5.6.2"><times id="S3.Ex4.m1.5.6.2.1.cmml" xref="S3.Ex4.m1.5.6.2.1"></times><ci id="S3.Ex4.m1.5.6.2.2a.cmml" xref="S3.Ex4.m1.5.6.2.2"><mtext id="S3.Ex4.m1.5.6.2.2.cmml" xref="S3.Ex4.m1.5.6.2.2">fDBD</mtext></ci><ci id="S3.Ex4.m1.5.5.cmml" xref="S3.Ex4.m1.5.5">𝐳</ci></apply><apply id="S3.Ex4.m1.4.4.cmml" xref="S3.Ex4.m1.4.4"><divide id="S3.Ex4.m1.4.4.5.cmml" xref="S3.Ex4.m1.4.4"></divide><apply id="S3.Ex4.m1.2.2.2.cmml" xref="S3.Ex4.m1.2.2.2"><times id="S3.Ex4.m1.2.2.2.3.cmml" xref="S3.Ex4.m1.2.2.2.3"></times><ci id="S3.Ex4.m1.2.2.2.4.cmml" xref="S3.Ex4.m1.2.2.2.4">𝑑</ci><interval closure="open" id="S3.Ex4.m1.2.2.2.2.3.cmml" xref="S3.Ex4.m1.2.2.2.2.2"><apply id="S3.Ex4.m1.1.1.1.1.1.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1"><minus id="S3.Ex4.m1.1.1.1.1.1.1.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1"></minus><ci id="S3.Ex4.m1.1.1.1.1.1.1.2.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.2">𝐳</ci><apply id="S3.Ex4.m1.1.1.1.1.1.1.3.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex4.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex4.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.3.2">𝝁</ci><ci id="S3.Ex4.m1.1.1.1.1.1.1.3.3a.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.3.3"><mtext id="S3.Ex4.m1.1.1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S3.Ex4.m1.1.1.1.1.1.1.3.3">ID</mtext></ci></apply></apply><apply id="S3.Ex4.m1.2.2.2.2.2.2.cmml" xref="S3.Ex4.m1.2.2.2.2.2.2"><minus id="S3.Ex4.m1.2.2.2.2.2.2.1.cmml" xref="S3.Ex4.m1.2.2.2.2.2.2.1"></minus><apply id="S3.Ex4.m1.2.2.2.2.2.2.2.cmml" xref="S3.Ex4.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.Ex4.m1.2.2.2.2.2.2.2.1.cmml" xref="S3.Ex4.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.Ex4.m1.2.2.2.2.2.2.2.2.cmml" xref="S3.Ex4.m1.2.2.2.2.2.2.2.2">𝐳</ci><apply id="S3.Ex4.m1.2.2.2.2.2.2.2.3.cmml" xref="S3.Ex4.m1.2.2.2.2.2.2.2.3"><times id="S3.Ex4.m1.2.2.2.2.2.2.2.3.1.cmml" xref="S3.Ex4.m1.2.2.2.2.2.2.2.3.1"></times><ci id="S3.Ex4.m1.2.2.2.2.2.2.2.3.2.cmml" xref="S3.Ex4.m1.2.2.2.2.2.2.2.3.2">𝑑</ci><ci id="S3.Ex4.m1.2.2.2.2.2.2.2.3.3.cmml" xref="S3.Ex4.m1.2.2.2.2.2.2.2.3.3">𝑏</ci></apply></apply><apply id="S3.Ex4.m1.2.2.2.2.2.2.3.cmml" xref="S3.Ex4.m1.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.Ex4.m1.2.2.2.2.2.2.3.1.cmml" xref="S3.Ex4.m1.2.2.2.2.2.2.3">subscript</csymbol><ci id="S3.Ex4.m1.2.2.2.2.2.2.3.2.cmml" xref="S3.Ex4.m1.2.2.2.2.2.2.3.2">𝝁</ci><ci id="S3.Ex4.m1.2.2.2.2.2.2.3.3a.cmml" xref="S3.Ex4.m1.2.2.2.2.2.2.3.3"><mtext id="S3.Ex4.m1.2.2.2.2.2.2.3.3.cmml" mathsize="70%" xref="S3.Ex4.m1.2.2.2.2.2.2.3.3">ID</mtext></ci></apply></apply></interval></apply><apply id="S3.Ex4.m1.4.4.4.cmml" xref="S3.Ex4.m1.4.4.4"><times id="S3.Ex4.m1.4.4.4.3.cmml" xref="S3.Ex4.m1.4.4.4.3"></times><ci id="S3.Ex4.m1.4.4.4.4.cmml" xref="S3.Ex4.m1.4.4.4.4">𝑑</ci><interval closure="open" id="S3.Ex4.m1.4.4.4.2.2.cmml" xref="S3.Ex4.m1.4.4.4.2.1"><apply id="S3.Ex4.m1.4.4.4.2.1.1.cmml" xref="S3.Ex4.m1.4.4.4.2.1.1"><minus id="S3.Ex4.m1.4.4.4.2.1.1.1.cmml" xref="S3.Ex4.m1.4.4.4.2.1.1.1"></minus><ci id="S3.Ex4.m1.4.4.4.2.1.1.2.cmml" xref="S3.Ex4.m1.4.4.4.2.1.1.2">𝐳</ci><apply id="S3.Ex4.m1.4.4.4.2.1.1.3.cmml" xref="S3.Ex4.m1.4.4.4.2.1.1.3"><csymbol cd="ambiguous" id="S3.Ex4.m1.4.4.4.2.1.1.3.1.cmml" xref="S3.Ex4.m1.4.4.4.2.1.1.3">subscript</csymbol><ci id="S3.Ex4.m1.4.4.4.2.1.1.3.2.cmml" xref="S3.Ex4.m1.4.4.4.2.1.1.3.2">𝝁</ci><ci id="S3.Ex4.m1.4.4.4.2.1.1.3.3a.cmml" xref="S3.Ex4.m1.4.4.4.2.1.1.3.3"><mtext id="S3.Ex4.m1.4.4.4.2.1.1.3.3.cmml" mathsize="70%" xref="S3.Ex4.m1.4.4.4.2.1.1.3.3">ID</mtext></ci></apply></apply><cn id="S3.Ex4.m1.3.3.3.1.cmml" type="integer" xref="S3.Ex4.m1.3.3.3.1">0</cn></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex4.m1.5c">\displaystyle\text{fDBD}(\mathbf{z})=\frac{d(\mathbf{z}-\bm{\mu_{\text{ID}}},%
\mathbf{z}_{db}-\bm{\mu_{\text{ID}}})}{d(\mathbf{z}-\bm{\mu_{\text{ID}}},0)}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex4.m1.5d">fDBD ( bold_z ) = divide start_ARG italic_d ( bold_z - bold_italic_μ start_POSTSUBSCRIPT ID end_POSTSUBSCRIPT , bold_z start_POSTSUBSCRIPT italic_d italic_b end_POSTSUBSCRIPT - bold_italic_μ start_POSTSUBSCRIPT ID end_POSTSUBSCRIPT ) end_ARG start_ARG italic_d ( bold_z - bold_italic_μ start_POSTSUBSCRIPT ID end_POSTSUBSCRIPT , 0 ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.p16">
<p class="ltx_p" id="S3.SS3.p16.2">One can observe that, this is the ratio of two sides of the triangle formed between the points <math alttext="\mathbf{z}-\bm{\mu_{\text{ID}}}" class="ltx_Math" display="inline" id="S3.SS3.p16.1.m1.1"><semantics id="S3.SS3.p16.1.m1.1a"><mrow id="S3.SS3.p16.1.m1.1.1" xref="S3.SS3.p16.1.m1.1.1.cmml"><mi id="S3.SS3.p16.1.m1.1.1.2" xref="S3.SS3.p16.1.m1.1.1.2.cmml">𝐳</mi><mo id="S3.SS3.p16.1.m1.1.1.1" xref="S3.SS3.p16.1.m1.1.1.1.cmml">−</mo><msub id="S3.SS3.p16.1.m1.1.1.3" xref="S3.SS3.p16.1.m1.1.1.3.cmml"><mi id="S3.SS3.p16.1.m1.1.1.3.2" xref="S3.SS3.p16.1.m1.1.1.3.2.cmml">𝝁</mi><mtext id="S3.SS3.p16.1.m1.1.1.3.3" xref="S3.SS3.p16.1.m1.1.1.3.3a.cmml">ID</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p16.1.m1.1b"><apply id="S3.SS3.p16.1.m1.1.1.cmml" xref="S3.SS3.p16.1.m1.1.1"><minus id="S3.SS3.p16.1.m1.1.1.1.cmml" xref="S3.SS3.p16.1.m1.1.1.1"></minus><ci id="S3.SS3.p16.1.m1.1.1.2.cmml" xref="S3.SS3.p16.1.m1.1.1.2">𝐳</ci><apply id="S3.SS3.p16.1.m1.1.1.3.cmml" xref="S3.SS3.p16.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p16.1.m1.1.1.3.1.cmml" xref="S3.SS3.p16.1.m1.1.1.3">subscript</csymbol><ci id="S3.SS3.p16.1.m1.1.1.3.2.cmml" xref="S3.SS3.p16.1.m1.1.1.3.2">𝝁</ci><ci id="S3.SS3.p16.1.m1.1.1.3.3a.cmml" xref="S3.SS3.p16.1.m1.1.1.3.3"><mtext id="S3.SS3.p16.1.m1.1.1.3.3.cmml" mathsize="70%" xref="S3.SS3.p16.1.m1.1.1.3.3">ID</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p16.1.m1.1c">\mathbf{z}-\bm{\mu_{\text{ID}}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p16.1.m1.1d">bold_z - bold_italic_μ start_POSTSUBSCRIPT ID end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{z_{db}}-\bm{\mu_{\text{ID}}}" class="ltx_Math" display="inline" id="S3.SS3.p16.2.m2.1"><semantics id="S3.SS3.p16.2.m2.1a"><mrow id="S3.SS3.p16.2.m2.1.1" xref="S3.SS3.p16.2.m2.1.1.cmml"><msub id="S3.SS3.p16.2.m2.1.1.2" xref="S3.SS3.p16.2.m2.1.1.2.cmml"><mi id="S3.SS3.p16.2.m2.1.1.2.2" xref="S3.SS3.p16.2.m2.1.1.2.2.cmml">𝐳</mi><mi id="S3.SS3.p16.2.m2.1.1.2.3" xref="S3.SS3.p16.2.m2.1.1.2.3.cmml">𝐝𝐛</mi></msub><mo id="S3.SS3.p16.2.m2.1.1.1" xref="S3.SS3.p16.2.m2.1.1.1.cmml">−</mo><msub id="S3.SS3.p16.2.m2.1.1.3" xref="S3.SS3.p16.2.m2.1.1.3.cmml"><mi id="S3.SS3.p16.2.m2.1.1.3.2" xref="S3.SS3.p16.2.m2.1.1.3.2.cmml">𝝁</mi><mtext id="S3.SS3.p16.2.m2.1.1.3.3" xref="S3.SS3.p16.2.m2.1.1.3.3a.cmml">ID</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p16.2.m2.1b"><apply id="S3.SS3.p16.2.m2.1.1.cmml" xref="S3.SS3.p16.2.m2.1.1"><minus id="S3.SS3.p16.2.m2.1.1.1.cmml" xref="S3.SS3.p16.2.m2.1.1.1"></minus><apply id="S3.SS3.p16.2.m2.1.1.2.cmml" xref="S3.SS3.p16.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p16.2.m2.1.1.2.1.cmml" xref="S3.SS3.p16.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS3.p16.2.m2.1.1.2.2.cmml" xref="S3.SS3.p16.2.m2.1.1.2.2">𝐳</ci><ci id="S3.SS3.p16.2.m2.1.1.2.3.cmml" xref="S3.SS3.p16.2.m2.1.1.2.3">𝐝𝐛</ci></apply><apply id="S3.SS3.p16.2.m2.1.1.3.cmml" xref="S3.SS3.p16.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p16.2.m2.1.1.3.1.cmml" xref="S3.SS3.p16.2.m2.1.1.3">subscript</csymbol><ci id="S3.SS3.p16.2.m2.1.1.3.2.cmml" xref="S3.SS3.p16.2.m2.1.1.3.2">𝝁</ci><ci id="S3.SS3.p16.2.m2.1.1.3.3a.cmml" xref="S3.SS3.p16.2.m2.1.1.3.3"><mtext id="S3.SS3.p16.2.m2.1.1.3.3.cmml" mathsize="70%" xref="S3.SS3.p16.2.m2.1.1.3.3">ID</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p16.2.m2.1c">\mathbf{z_{db}}-\bm{\mu_{\text{ID}}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p16.2.m2.1d">bold_z start_POSTSUBSCRIPT bold_db end_POSTSUBSCRIPT - bold_italic_μ start_POSTSUBSCRIPT ID end_POSTSUBSCRIPT</annotation></semantics></math> and the origin. Using the law of sines:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S3.SS3.p17">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx7">
<tbody id="S3.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\frac{d(\mathbf{z}-\bm{\mu_{\text{ID}}},\mathbf{z}_{db}-\bm{\mu_{%
\text{ID}}})}{\sin{(\theta)}}=\frac{d(\mathbf{z}-\bm{\mu_{\text{ID}}},0)}{\sin%
{(\alpha)}}" class="ltx_Math" display="inline" id="S3.E4.m1.8"><semantics id="S3.E4.m1.8a"><mrow id="S3.E4.m1.8.9" xref="S3.E4.m1.8.9.cmml"><mstyle displaystyle="true" id="S3.E4.m1.4.4" xref="S3.E4.m1.4.4.cmml"><mfrac id="S3.E4.m1.4.4a" xref="S3.E4.m1.4.4.cmml"><mrow id="S3.E4.m1.2.2.2" xref="S3.E4.m1.2.2.2.cmml"><mi id="S3.E4.m1.2.2.2.4" xref="S3.E4.m1.2.2.2.4.cmml">d</mi><mo id="S3.E4.m1.2.2.2.3" xref="S3.E4.m1.2.2.2.3.cmml">⁢</mo><mrow id="S3.E4.m1.2.2.2.2.2" xref="S3.E4.m1.2.2.2.2.3.cmml"><mo id="S3.E4.m1.2.2.2.2.2.3" stretchy="false" xref="S3.E4.m1.2.2.2.2.3.cmml">(</mo><mrow id="S3.E4.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.2.cmml">𝐳</mi><mo id="S3.E4.m1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.E4.m1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.1.1.1.3.2.cmml">𝝁</mi><mtext id="S3.E4.m1.1.1.1.1.1.1.3.3" xref="S3.E4.m1.1.1.1.1.1.1.3.3a.cmml">ID</mtext></msub></mrow><mo id="S3.E4.m1.2.2.2.2.2.4" xref="S3.E4.m1.2.2.2.2.3.cmml">,</mo><mrow id="S3.E4.m1.2.2.2.2.2.2" xref="S3.E4.m1.2.2.2.2.2.2.cmml"><msub id="S3.E4.m1.2.2.2.2.2.2.2" xref="S3.E4.m1.2.2.2.2.2.2.2.cmml"><mi id="S3.E4.m1.2.2.2.2.2.2.2.2" xref="S3.E4.m1.2.2.2.2.2.2.2.2.cmml">𝐳</mi><mrow id="S3.E4.m1.2.2.2.2.2.2.2.3" xref="S3.E4.m1.2.2.2.2.2.2.2.3.cmml"><mi id="S3.E4.m1.2.2.2.2.2.2.2.3.2" xref="S3.E4.m1.2.2.2.2.2.2.2.3.2.cmml">d</mi><mo id="S3.E4.m1.2.2.2.2.2.2.2.3.1" xref="S3.E4.m1.2.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.E4.m1.2.2.2.2.2.2.2.3.3" xref="S3.E4.m1.2.2.2.2.2.2.2.3.3.cmml">b</mi></mrow></msub><mo id="S3.E4.m1.2.2.2.2.2.2.1" xref="S3.E4.m1.2.2.2.2.2.2.1.cmml">−</mo><msub id="S3.E4.m1.2.2.2.2.2.2.3" xref="S3.E4.m1.2.2.2.2.2.2.3.cmml"><mi id="S3.E4.m1.2.2.2.2.2.2.3.2" xref="S3.E4.m1.2.2.2.2.2.2.3.2.cmml">𝝁</mi><mtext id="S3.E4.m1.2.2.2.2.2.2.3.3" xref="S3.E4.m1.2.2.2.2.2.2.3.3a.cmml">ID</mtext></msub></mrow><mo id="S3.E4.m1.2.2.2.2.2.5" stretchy="false" xref="S3.E4.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="S3.E4.m1.4.4.4.4" xref="S3.E4.m1.4.4.4.3.cmml"><mi id="S3.E4.m1.3.3.3.1" xref="S3.E4.m1.3.3.3.1.cmml">sin</mi><mo id="S3.E4.m1.4.4.4.4a" xref="S3.E4.m1.4.4.4.3.cmml">⁡</mo><mrow id="S3.E4.m1.4.4.4.4.1" xref="S3.E4.m1.4.4.4.3.cmml"><mo id="S3.E4.m1.4.4.4.4.1.1" stretchy="false" xref="S3.E4.m1.4.4.4.3.cmml">(</mo><mi id="S3.E4.m1.4.4.4.2" xref="S3.E4.m1.4.4.4.2.cmml">θ</mi><mo id="S3.E4.m1.4.4.4.4.1.2" stretchy="false" xref="S3.E4.m1.4.4.4.3.cmml">)</mo></mrow></mrow></mfrac></mstyle><mo id="S3.E4.m1.8.9.1" xref="S3.E4.m1.8.9.1.cmml">=</mo><mstyle displaystyle="true" id="S3.E4.m1.8.8" xref="S3.E4.m1.8.8.cmml"><mfrac id="S3.E4.m1.8.8a" xref="S3.E4.m1.8.8.cmml"><mrow id="S3.E4.m1.6.6.2" xref="S3.E4.m1.6.6.2.cmml"><mi id="S3.E4.m1.6.6.2.4" xref="S3.E4.m1.6.6.2.4.cmml">d</mi><mo id="S3.E4.m1.6.6.2.3" xref="S3.E4.m1.6.6.2.3.cmml">⁢</mo><mrow id="S3.E4.m1.6.6.2.2.1" xref="S3.E4.m1.6.6.2.2.2.cmml"><mo id="S3.E4.m1.6.6.2.2.1.2" stretchy="false" xref="S3.E4.m1.6.6.2.2.2.cmml">(</mo><mrow id="S3.E4.m1.6.6.2.2.1.1" xref="S3.E4.m1.6.6.2.2.1.1.cmml"><mi id="S3.E4.m1.6.6.2.2.1.1.2" xref="S3.E4.m1.6.6.2.2.1.1.2.cmml">𝐳</mi><mo id="S3.E4.m1.6.6.2.2.1.1.1" xref="S3.E4.m1.6.6.2.2.1.1.1.cmml">−</mo><msub id="S3.E4.m1.6.6.2.2.1.1.3" xref="S3.E4.m1.6.6.2.2.1.1.3.cmml"><mi id="S3.E4.m1.6.6.2.2.1.1.3.2" xref="S3.E4.m1.6.6.2.2.1.1.3.2.cmml">𝝁</mi><mtext id="S3.E4.m1.6.6.2.2.1.1.3.3" xref="S3.E4.m1.6.6.2.2.1.1.3.3a.cmml">ID</mtext></msub></mrow><mo id="S3.E4.m1.6.6.2.2.1.3" xref="S3.E4.m1.6.6.2.2.2.cmml">,</mo><mn id="S3.E4.m1.5.5.1.1" xref="S3.E4.m1.5.5.1.1.cmml">0</mn><mo id="S3.E4.m1.6.6.2.2.1.4" stretchy="false" xref="S3.E4.m1.6.6.2.2.2.cmml">)</mo></mrow></mrow><mrow id="S3.E4.m1.8.8.4.4" xref="S3.E4.m1.8.8.4.3.cmml"><mi id="S3.E4.m1.7.7.3.1" xref="S3.E4.m1.7.7.3.1.cmml">sin</mi><mo id="S3.E4.m1.8.8.4.4a" xref="S3.E4.m1.8.8.4.3.cmml">⁡</mo><mrow id="S3.E4.m1.8.8.4.4.1" xref="S3.E4.m1.8.8.4.3.cmml"><mo id="S3.E4.m1.8.8.4.4.1.1" stretchy="false" xref="S3.E4.m1.8.8.4.3.cmml">(</mo><mi id="S3.E4.m1.8.8.4.2" xref="S3.E4.m1.8.8.4.2.cmml">α</mi><mo id="S3.E4.m1.8.8.4.4.1.2" stretchy="false" xref="S3.E4.m1.8.8.4.3.cmml">)</mo></mrow></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.8b"><apply id="S3.E4.m1.8.9.cmml" xref="S3.E4.m1.8.9"><eq id="S3.E4.m1.8.9.1.cmml" xref="S3.E4.m1.8.9.1"></eq><apply id="S3.E4.m1.4.4.cmml" xref="S3.E4.m1.4.4"><divide id="S3.E4.m1.4.4.5.cmml" xref="S3.E4.m1.4.4"></divide><apply id="S3.E4.m1.2.2.2.cmml" xref="S3.E4.m1.2.2.2"><times id="S3.E4.m1.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.3"></times><ci id="S3.E4.m1.2.2.2.4.cmml" xref="S3.E4.m1.2.2.2.4">𝑑</ci><interval closure="open" id="S3.E4.m1.2.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.2.2"><apply id="S3.E4.m1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1"><minus id="S3.E4.m1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1"></minus><ci id="S3.E4.m1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.2">𝐳</ci><apply id="S3.E4.m1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3.2">𝝁</ci><ci id="S3.E4.m1.1.1.1.1.1.1.3.3a.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3.3"><mtext id="S3.E4.m1.1.1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S3.E4.m1.1.1.1.1.1.1.3.3">ID</mtext></ci></apply></apply><apply id="S3.E4.m1.2.2.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2.2.2"><minus id="S3.E4.m1.2.2.2.2.2.2.1.cmml" xref="S3.E4.m1.2.2.2.2.2.2.1"></minus><apply id="S3.E4.m1.2.2.2.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.2.2.2.2.2.1.cmml" xref="S3.E4.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E4.m1.2.2.2.2.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2.2.2.2.2">𝐳</ci><apply id="S3.E4.m1.2.2.2.2.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.2.2.2.2.3"><times id="S3.E4.m1.2.2.2.2.2.2.2.3.1.cmml" xref="S3.E4.m1.2.2.2.2.2.2.2.3.1"></times><ci id="S3.E4.m1.2.2.2.2.2.2.2.3.2.cmml" xref="S3.E4.m1.2.2.2.2.2.2.2.3.2">𝑑</ci><ci id="S3.E4.m1.2.2.2.2.2.2.2.3.3.cmml" xref="S3.E4.m1.2.2.2.2.2.2.2.3.3">𝑏</ci></apply></apply><apply id="S3.E4.m1.2.2.2.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.2.2.2.2.3.1.cmml" xref="S3.E4.m1.2.2.2.2.2.2.3">subscript</csymbol><ci id="S3.E4.m1.2.2.2.2.2.2.3.2.cmml" xref="S3.E4.m1.2.2.2.2.2.2.3.2">𝝁</ci><ci id="S3.E4.m1.2.2.2.2.2.2.3.3a.cmml" xref="S3.E4.m1.2.2.2.2.2.2.3.3"><mtext id="S3.E4.m1.2.2.2.2.2.2.3.3.cmml" mathsize="70%" xref="S3.E4.m1.2.2.2.2.2.2.3.3">ID</mtext></ci></apply></apply></interval></apply><apply id="S3.E4.m1.4.4.4.3.cmml" xref="S3.E4.m1.4.4.4.4"><sin id="S3.E4.m1.3.3.3.1.cmml" xref="S3.E4.m1.3.3.3.1"></sin><ci id="S3.E4.m1.4.4.4.2.cmml" xref="S3.E4.m1.4.4.4.2">𝜃</ci></apply></apply><apply id="S3.E4.m1.8.8.cmml" xref="S3.E4.m1.8.8"><divide id="S3.E4.m1.8.8.5.cmml" xref="S3.E4.m1.8.8"></divide><apply id="S3.E4.m1.6.6.2.cmml" xref="S3.E4.m1.6.6.2"><times id="S3.E4.m1.6.6.2.3.cmml" xref="S3.E4.m1.6.6.2.3"></times><ci id="S3.E4.m1.6.6.2.4.cmml" xref="S3.E4.m1.6.6.2.4">𝑑</ci><interval closure="open" id="S3.E4.m1.6.6.2.2.2.cmml" xref="S3.E4.m1.6.6.2.2.1"><apply id="S3.E4.m1.6.6.2.2.1.1.cmml" xref="S3.E4.m1.6.6.2.2.1.1"><minus id="S3.E4.m1.6.6.2.2.1.1.1.cmml" xref="S3.E4.m1.6.6.2.2.1.1.1"></minus><ci id="S3.E4.m1.6.6.2.2.1.1.2.cmml" xref="S3.E4.m1.6.6.2.2.1.1.2">𝐳</ci><apply id="S3.E4.m1.6.6.2.2.1.1.3.cmml" xref="S3.E4.m1.6.6.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.2.2.1.1.3.1.cmml" xref="S3.E4.m1.6.6.2.2.1.1.3">subscript</csymbol><ci id="S3.E4.m1.6.6.2.2.1.1.3.2.cmml" xref="S3.E4.m1.6.6.2.2.1.1.3.2">𝝁</ci><ci id="S3.E4.m1.6.6.2.2.1.1.3.3a.cmml" xref="S3.E4.m1.6.6.2.2.1.1.3.3"><mtext id="S3.E4.m1.6.6.2.2.1.1.3.3.cmml" mathsize="70%" xref="S3.E4.m1.6.6.2.2.1.1.3.3">ID</mtext></ci></apply></apply><cn id="S3.E4.m1.5.5.1.1.cmml" type="integer" xref="S3.E4.m1.5.5.1.1">0</cn></interval></apply><apply id="S3.E4.m1.8.8.4.3.cmml" xref="S3.E4.m1.8.8.4.4"><sin id="S3.E4.m1.7.7.3.1.cmml" xref="S3.E4.m1.7.7.3.1"></sin><ci id="S3.E4.m1.8.8.4.2.cmml" xref="S3.E4.m1.8.8.4.2">𝛼</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.8c">\displaystyle\frac{d(\mathbf{z}-\bm{\mu_{\text{ID}}},\mathbf{z}_{db}-\bm{\mu_{%
\text{ID}}})}{\sin{(\theta)}}=\frac{d(\mathbf{z}-\bm{\mu_{\text{ID}}},0)}{\sin%
{(\alpha)}}</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.8d">divide start_ARG italic_d ( bold_z - bold_italic_μ start_POSTSUBSCRIPT ID end_POSTSUBSCRIPT , bold_z start_POSTSUBSCRIPT italic_d italic_b end_POSTSUBSCRIPT - bold_italic_μ start_POSTSUBSCRIPT ID end_POSTSUBSCRIPT ) end_ARG start_ARG roman_sin ( italic_θ ) end_ARG = divide start_ARG italic_d ( bold_z - bold_italic_μ start_POSTSUBSCRIPT ID end_POSTSUBSCRIPT , 0 ) end_ARG start_ARG roman_sin ( italic_α ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
<tbody id="S3.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\frac{\sin{(\theta)}}{\sin{(\alpha)}}=\frac{d(\mathbf{z}-\bm{\mu_%
{\text{ID}}},\mathbf{z}_{db}-\bm{\mu_{\text{ID}}})}{d(\mathbf{z}-\bm{\mu_{%
\text{ID}}},0)}=\text{fDBD}(\mathbf{z})" class="ltx_Math" display="inline" id="S3.E5.m1.9"><semantics id="S3.E5.m1.9a"><mrow id="S3.E5.m1.9.10" xref="S3.E5.m1.9.10.cmml"><mstyle displaystyle="true" id="S3.E5.m1.4.4" xref="S3.E5.m1.4.4.cmml"><mfrac id="S3.E5.m1.4.4a" xref="S3.E5.m1.4.4.cmml"><mrow id="S3.E5.m1.2.2.2.4" xref="S3.E5.m1.2.2.2.3.cmml"><mi id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml">sin</mi><mo id="S3.E5.m1.2.2.2.4a" xref="S3.E5.m1.2.2.2.3.cmml">⁡</mo><mrow id="S3.E5.m1.2.2.2.4.1" xref="S3.E5.m1.2.2.2.3.cmml"><mo id="S3.E5.m1.2.2.2.4.1.1" stretchy="false" xref="S3.E5.m1.2.2.2.3.cmml">(</mo><mi id="S3.E5.m1.2.2.2.2" xref="S3.E5.m1.2.2.2.2.cmml">θ</mi><mo id="S3.E5.m1.2.2.2.4.1.2" stretchy="false" xref="S3.E5.m1.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="S3.E5.m1.4.4.4.4" xref="S3.E5.m1.4.4.4.3.cmml"><mi id="S3.E5.m1.3.3.3.1" xref="S3.E5.m1.3.3.3.1.cmml">sin</mi><mo id="S3.E5.m1.4.4.4.4a" xref="S3.E5.m1.4.4.4.3.cmml">⁡</mo><mrow id="S3.E5.m1.4.4.4.4.1" xref="S3.E5.m1.4.4.4.3.cmml"><mo id="S3.E5.m1.4.4.4.4.1.1" stretchy="false" xref="S3.E5.m1.4.4.4.3.cmml">(</mo><mi id="S3.E5.m1.4.4.4.2" xref="S3.E5.m1.4.4.4.2.cmml">α</mi><mo id="S3.E5.m1.4.4.4.4.1.2" stretchy="false" xref="S3.E5.m1.4.4.4.3.cmml">)</mo></mrow></mrow></mfrac></mstyle><mo id="S3.E5.m1.9.10.2" xref="S3.E5.m1.9.10.2.cmml">=</mo><mstyle displaystyle="true" id="S3.E5.m1.8.8" xref="S3.E5.m1.8.8.cmml"><mfrac id="S3.E5.m1.8.8a" xref="S3.E5.m1.8.8.cmml"><mrow id="S3.E5.m1.6.6.2" xref="S3.E5.m1.6.6.2.cmml"><mi id="S3.E5.m1.6.6.2.4" xref="S3.E5.m1.6.6.2.4.cmml">d</mi><mo id="S3.E5.m1.6.6.2.3" xref="S3.E5.m1.6.6.2.3.cmml">⁢</mo><mrow id="S3.E5.m1.6.6.2.2.2" xref="S3.E5.m1.6.6.2.2.3.cmml"><mo id="S3.E5.m1.6.6.2.2.2.3" stretchy="false" xref="S3.E5.m1.6.6.2.2.3.cmml">(</mo><mrow id="S3.E5.m1.5.5.1.1.1.1" xref="S3.E5.m1.5.5.1.1.1.1.cmml"><mi id="S3.E5.m1.5.5.1.1.1.1.2" xref="S3.E5.m1.5.5.1.1.1.1.2.cmml">𝐳</mi><mo id="S3.E5.m1.5.5.1.1.1.1.1" xref="S3.E5.m1.5.5.1.1.1.1.1.cmml">−</mo><msub id="S3.E5.m1.5.5.1.1.1.1.3" xref="S3.E5.m1.5.5.1.1.1.1.3.cmml"><mi id="S3.E5.m1.5.5.1.1.1.1.3.2" xref="S3.E5.m1.5.5.1.1.1.1.3.2.cmml">𝝁</mi><mtext id="S3.E5.m1.5.5.1.1.1.1.3.3" xref="S3.E5.m1.5.5.1.1.1.1.3.3a.cmml">ID</mtext></msub></mrow><mo id="S3.E5.m1.6.6.2.2.2.4" xref="S3.E5.m1.6.6.2.2.3.cmml">,</mo><mrow id="S3.E5.m1.6.6.2.2.2.2" xref="S3.E5.m1.6.6.2.2.2.2.cmml"><msub id="S3.E5.m1.6.6.2.2.2.2.2" xref="S3.E5.m1.6.6.2.2.2.2.2.cmml"><mi id="S3.E5.m1.6.6.2.2.2.2.2.2" xref="S3.E5.m1.6.6.2.2.2.2.2.2.cmml">𝐳</mi><mrow id="S3.E5.m1.6.6.2.2.2.2.2.3" xref="S3.E5.m1.6.6.2.2.2.2.2.3.cmml"><mi id="S3.E5.m1.6.6.2.2.2.2.2.3.2" xref="S3.E5.m1.6.6.2.2.2.2.2.3.2.cmml">d</mi><mo id="S3.E5.m1.6.6.2.2.2.2.2.3.1" xref="S3.E5.m1.6.6.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.E5.m1.6.6.2.2.2.2.2.3.3" xref="S3.E5.m1.6.6.2.2.2.2.2.3.3.cmml">b</mi></mrow></msub><mo id="S3.E5.m1.6.6.2.2.2.2.1" xref="S3.E5.m1.6.6.2.2.2.2.1.cmml">−</mo><msub id="S3.E5.m1.6.6.2.2.2.2.3" xref="S3.E5.m1.6.6.2.2.2.2.3.cmml"><mi id="S3.E5.m1.6.6.2.2.2.2.3.2" xref="S3.E5.m1.6.6.2.2.2.2.3.2.cmml">𝝁</mi><mtext id="S3.E5.m1.6.6.2.2.2.2.3.3" xref="S3.E5.m1.6.6.2.2.2.2.3.3a.cmml">ID</mtext></msub></mrow><mo id="S3.E5.m1.6.6.2.2.2.5" stretchy="false" xref="S3.E5.m1.6.6.2.2.3.cmml">)</mo></mrow></mrow><mrow id="S3.E5.m1.8.8.4" xref="S3.E5.m1.8.8.4.cmml"><mi id="S3.E5.m1.8.8.4.4" xref="S3.E5.m1.8.8.4.4.cmml">d</mi><mo id="S3.E5.m1.8.8.4.3" xref="S3.E5.m1.8.8.4.3.cmml">⁢</mo><mrow id="S3.E5.m1.8.8.4.2.1" xref="S3.E5.m1.8.8.4.2.2.cmml"><mo id="S3.E5.m1.8.8.4.2.1.2" stretchy="false" xref="S3.E5.m1.8.8.4.2.2.cmml">(</mo><mrow id="S3.E5.m1.8.8.4.2.1.1" xref="S3.E5.m1.8.8.4.2.1.1.cmml"><mi id="S3.E5.m1.8.8.4.2.1.1.2" xref="S3.E5.m1.8.8.4.2.1.1.2.cmml">𝐳</mi><mo id="S3.E5.m1.8.8.4.2.1.1.1" xref="S3.E5.m1.8.8.4.2.1.1.1.cmml">−</mo><msub id="S3.E5.m1.8.8.4.2.1.1.3" xref="S3.E5.m1.8.8.4.2.1.1.3.cmml"><mi id="S3.E5.m1.8.8.4.2.1.1.3.2" xref="S3.E5.m1.8.8.4.2.1.1.3.2.cmml">𝝁</mi><mtext id="S3.E5.m1.8.8.4.2.1.1.3.3" xref="S3.E5.m1.8.8.4.2.1.1.3.3a.cmml">ID</mtext></msub></mrow><mo id="S3.E5.m1.8.8.4.2.1.3" xref="S3.E5.m1.8.8.4.2.2.cmml">,</mo><mn id="S3.E5.m1.7.7.3.1" xref="S3.E5.m1.7.7.3.1.cmml">0</mn><mo id="S3.E5.m1.8.8.4.2.1.4" stretchy="false" xref="S3.E5.m1.8.8.4.2.2.cmml">)</mo></mrow></mrow></mfrac></mstyle><mo id="S3.E5.m1.9.10.3" xref="S3.E5.m1.9.10.3.cmml">=</mo><mrow id="S3.E5.m1.9.10.4" xref="S3.E5.m1.9.10.4.cmml"><mtext id="S3.E5.m1.9.10.4.2" xref="S3.E5.m1.9.10.4.2a.cmml">fDBD</mtext><mo id="S3.E5.m1.9.10.4.1" xref="S3.E5.m1.9.10.4.1.cmml">⁢</mo><mrow id="S3.E5.m1.9.10.4.3.2" xref="S3.E5.m1.9.10.4.cmml"><mo id="S3.E5.m1.9.10.4.3.2.1" stretchy="false" xref="S3.E5.m1.9.10.4.cmml">(</mo><mi id="S3.E5.m1.9.9" xref="S3.E5.m1.9.9.cmml">𝐳</mi><mo id="S3.E5.m1.9.10.4.3.2.2" stretchy="false" xref="S3.E5.m1.9.10.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.9b"><apply id="S3.E5.m1.9.10.cmml" xref="S3.E5.m1.9.10"><and id="S3.E5.m1.9.10a.cmml" xref="S3.E5.m1.9.10"></and><apply id="S3.E5.m1.9.10b.cmml" xref="S3.E5.m1.9.10"><eq id="S3.E5.m1.9.10.2.cmml" xref="S3.E5.m1.9.10.2"></eq><apply id="S3.E5.m1.4.4.cmml" xref="S3.E5.m1.4.4"><divide id="S3.E5.m1.4.4.5.cmml" xref="S3.E5.m1.4.4"></divide><apply id="S3.E5.m1.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.4"><sin id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1"></sin><ci id="S3.E5.m1.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2">𝜃</ci></apply><apply id="S3.E5.m1.4.4.4.3.cmml" xref="S3.E5.m1.4.4.4.4"><sin id="S3.E5.m1.3.3.3.1.cmml" xref="S3.E5.m1.3.3.3.1"></sin><ci id="S3.E5.m1.4.4.4.2.cmml" xref="S3.E5.m1.4.4.4.2">𝛼</ci></apply></apply><apply id="S3.E5.m1.8.8.cmml" xref="S3.E5.m1.8.8"><divide id="S3.E5.m1.8.8.5.cmml" xref="S3.E5.m1.8.8"></divide><apply id="S3.E5.m1.6.6.2.cmml" xref="S3.E5.m1.6.6.2"><times id="S3.E5.m1.6.6.2.3.cmml" xref="S3.E5.m1.6.6.2.3"></times><ci id="S3.E5.m1.6.6.2.4.cmml" xref="S3.E5.m1.6.6.2.4">𝑑</ci><interval closure="open" id="S3.E5.m1.6.6.2.2.3.cmml" xref="S3.E5.m1.6.6.2.2.2"><apply id="S3.E5.m1.5.5.1.1.1.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1"><minus id="S3.E5.m1.5.5.1.1.1.1.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1"></minus><ci id="S3.E5.m1.5.5.1.1.1.1.2.cmml" xref="S3.E5.m1.5.5.1.1.1.1.2">𝐳</ci><apply id="S3.E5.m1.5.5.1.1.1.1.3.cmml" xref="S3.E5.m1.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.1.1.1.3.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.5.5.1.1.1.1.3.2.cmml" xref="S3.E5.m1.5.5.1.1.1.1.3.2">𝝁</ci><ci id="S3.E5.m1.5.5.1.1.1.1.3.3a.cmml" xref="S3.E5.m1.5.5.1.1.1.1.3.3"><mtext id="S3.E5.m1.5.5.1.1.1.1.3.3.cmml" mathsize="70%" xref="S3.E5.m1.5.5.1.1.1.1.3.3">ID</mtext></ci></apply></apply><apply id="S3.E5.m1.6.6.2.2.2.2.cmml" xref="S3.E5.m1.6.6.2.2.2.2"><minus id="S3.E5.m1.6.6.2.2.2.2.1.cmml" xref="S3.E5.m1.6.6.2.2.2.2.1"></minus><apply id="S3.E5.m1.6.6.2.2.2.2.2.cmml" xref="S3.E5.m1.6.6.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.2.2.2.2.2.1.cmml" xref="S3.E5.m1.6.6.2.2.2.2.2">subscript</csymbol><ci id="S3.E5.m1.6.6.2.2.2.2.2.2.cmml" xref="S3.E5.m1.6.6.2.2.2.2.2.2">𝐳</ci><apply id="S3.E5.m1.6.6.2.2.2.2.2.3.cmml" xref="S3.E5.m1.6.6.2.2.2.2.2.3"><times id="S3.E5.m1.6.6.2.2.2.2.2.3.1.cmml" xref="S3.E5.m1.6.6.2.2.2.2.2.3.1"></times><ci id="S3.E5.m1.6.6.2.2.2.2.2.3.2.cmml" xref="S3.E5.m1.6.6.2.2.2.2.2.3.2">𝑑</ci><ci id="S3.E5.m1.6.6.2.2.2.2.2.3.3.cmml" xref="S3.E5.m1.6.6.2.2.2.2.2.3.3">𝑏</ci></apply></apply><apply id="S3.E5.m1.6.6.2.2.2.2.3.cmml" xref="S3.E5.m1.6.6.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.2.2.2.2.3.1.cmml" xref="S3.E5.m1.6.6.2.2.2.2.3">subscript</csymbol><ci id="S3.E5.m1.6.6.2.2.2.2.3.2.cmml" xref="S3.E5.m1.6.6.2.2.2.2.3.2">𝝁</ci><ci id="S3.E5.m1.6.6.2.2.2.2.3.3a.cmml" xref="S3.E5.m1.6.6.2.2.2.2.3.3"><mtext id="S3.E5.m1.6.6.2.2.2.2.3.3.cmml" mathsize="70%" xref="S3.E5.m1.6.6.2.2.2.2.3.3">ID</mtext></ci></apply></apply></interval></apply><apply id="S3.E5.m1.8.8.4.cmml" xref="S3.E5.m1.8.8.4"><times id="S3.E5.m1.8.8.4.3.cmml" xref="S3.E5.m1.8.8.4.3"></times><ci id="S3.E5.m1.8.8.4.4.cmml" xref="S3.E5.m1.8.8.4.4">𝑑</ci><interval closure="open" id="S3.E5.m1.8.8.4.2.2.cmml" xref="S3.E5.m1.8.8.4.2.1"><apply id="S3.E5.m1.8.8.4.2.1.1.cmml" xref="S3.E5.m1.8.8.4.2.1.1"><minus id="S3.E5.m1.8.8.4.2.1.1.1.cmml" xref="S3.E5.m1.8.8.4.2.1.1.1"></minus><ci id="S3.E5.m1.8.8.4.2.1.1.2.cmml" xref="S3.E5.m1.8.8.4.2.1.1.2">𝐳</ci><apply id="S3.E5.m1.8.8.4.2.1.1.3.cmml" xref="S3.E5.m1.8.8.4.2.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.8.8.4.2.1.1.3.1.cmml" xref="S3.E5.m1.8.8.4.2.1.1.3">subscript</csymbol><ci id="S3.E5.m1.8.8.4.2.1.1.3.2.cmml" xref="S3.E5.m1.8.8.4.2.1.1.3.2">𝝁</ci><ci id="S3.E5.m1.8.8.4.2.1.1.3.3a.cmml" xref="S3.E5.m1.8.8.4.2.1.1.3.3"><mtext id="S3.E5.m1.8.8.4.2.1.1.3.3.cmml" mathsize="70%" xref="S3.E5.m1.8.8.4.2.1.1.3.3">ID</mtext></ci></apply></apply><cn id="S3.E5.m1.7.7.3.1.cmml" type="integer" xref="S3.E5.m1.7.7.3.1">0</cn></interval></apply></apply></apply><apply id="S3.E5.m1.9.10c.cmml" xref="S3.E5.m1.9.10"><eq id="S3.E5.m1.9.10.3.cmml" xref="S3.E5.m1.9.10.3"></eq><share href="https://arxiv.org/html/2410.04525v1#S3.E5.m1.8.8.cmml" id="S3.E5.m1.9.10d.cmml" xref="S3.E5.m1.9.10"></share><apply id="S3.E5.m1.9.10.4.cmml" xref="S3.E5.m1.9.10.4"><times id="S3.E5.m1.9.10.4.1.cmml" xref="S3.E5.m1.9.10.4.1"></times><ci id="S3.E5.m1.9.10.4.2a.cmml" xref="S3.E5.m1.9.10.4.2"><mtext id="S3.E5.m1.9.10.4.2.cmml" xref="S3.E5.m1.9.10.4.2">fDBD</mtext></ci><ci id="S3.E5.m1.9.9.cmml" xref="S3.E5.m1.9.9">𝐳</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.9c">\displaystyle\frac{\sin{(\theta)}}{\sin{(\alpha)}}=\frac{d(\mathbf{z}-\bm{\mu_%
{\text{ID}}},\mathbf{z}_{db}-\bm{\mu_{\text{ID}}})}{d(\mathbf{z}-\bm{\mu_{%
\text{ID}}},0)}=\text{fDBD}(\mathbf{z})</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.9d">divide start_ARG roman_sin ( italic_θ ) end_ARG start_ARG roman_sin ( italic_α ) end_ARG = divide start_ARG italic_d ( bold_z - bold_italic_μ start_POSTSUBSCRIPT ID end_POSTSUBSCRIPT , bold_z start_POSTSUBSCRIPT italic_d italic_b end_POSTSUBSCRIPT - bold_italic_μ start_POSTSUBSCRIPT ID end_POSTSUBSCRIPT ) end_ARG start_ARG italic_d ( bold_z - bold_italic_μ start_POSTSUBSCRIPT ID end_POSTSUBSCRIPT , 0 ) end_ARG = fDBD ( bold_z )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<figure class="ltx_figure ltx_align_floatright" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="368" id="S3.F2.g1" src="https://arxiv.org/html/2410.04525v1/extracted/5905247/figures/hists/CIFAR-10_Texture_hist_sines.png" width="598">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F2.6.3.1" style="font-size:90%;">Figure 2</span>: </span><span class="ltx_text" id="S3.F2.4.2" style="font-size:90%;">Histogram of ID (CIFAR-10) and OOD (Texture) with respect to the sine of the angle of the triangle that looks at the edge <math alttext="\mathbf{z}-\bm{\mu_{\text{ID}}}" class="ltx_Math" display="inline" id="S3.F2.3.1.m1.1"><semantics id="S3.F2.3.1.m1.1b"><mrow id="S3.F2.3.1.m1.1.1" xref="S3.F2.3.1.m1.1.1.cmml"><mi id="S3.F2.3.1.m1.1.1.2" xref="S3.F2.3.1.m1.1.1.2.cmml">𝐳</mi><mo id="S3.F2.3.1.m1.1.1.1" xref="S3.F2.3.1.m1.1.1.1.cmml">−</mo><msub id="S3.F2.3.1.m1.1.1.3" xref="S3.F2.3.1.m1.1.1.3.cmml"><mi id="S3.F2.3.1.m1.1.1.3.2" xref="S3.F2.3.1.m1.1.1.3.2.cmml">𝝁</mi><mtext id="S3.F2.3.1.m1.1.1.3.3" xref="S3.F2.3.1.m1.1.1.3.3a.cmml">ID</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.3.1.m1.1c"><apply id="S3.F2.3.1.m1.1.1.cmml" xref="S3.F2.3.1.m1.1.1"><minus id="S3.F2.3.1.m1.1.1.1.cmml" xref="S3.F2.3.1.m1.1.1.1"></minus><ci id="S3.F2.3.1.m1.1.1.2.cmml" xref="S3.F2.3.1.m1.1.1.2">𝐳</ci><apply id="S3.F2.3.1.m1.1.1.3.cmml" xref="S3.F2.3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.F2.3.1.m1.1.1.3.1.cmml" xref="S3.F2.3.1.m1.1.1.3">subscript</csymbol><ci id="S3.F2.3.1.m1.1.1.3.2.cmml" xref="S3.F2.3.1.m1.1.1.3.2">𝝁</ci><ci id="S3.F2.3.1.m1.1.1.3.3a.cmml" xref="S3.F2.3.1.m1.1.1.3.3"><mtext id="S3.F2.3.1.m1.1.1.3.3.cmml" mathsize="70%" xref="S3.F2.3.1.m1.1.1.3.3">ID</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.3.1.m1.1d">\mathbf{z}-\bm{\mu_{\text{ID}}}</annotation><annotation encoding="application/x-llamapun" id="S3.F2.3.1.m1.1e">bold_z - bold_italic_μ start_POSTSUBSCRIPT ID end_POSTSUBSCRIPT</annotation></semantics></math>. This empirically shows that <math alttext="\sin{(\alpha)}" class="ltx_Math" display="inline" id="S3.F2.4.2.m2.2"><semantics id="S3.F2.4.2.m2.2b"><mrow id="S3.F2.4.2.m2.2.3.2" xref="S3.F2.4.2.m2.2.3.1.cmml"><mi id="S3.F2.4.2.m2.1.1" xref="S3.F2.4.2.m2.1.1.cmml">sin</mi><mo id="S3.F2.4.2.m2.2.3.2b" xref="S3.F2.4.2.m2.2.3.1.cmml">⁡</mo><mrow id="S3.F2.4.2.m2.2.3.2.1" xref="S3.F2.4.2.m2.2.3.1.cmml"><mo id="S3.F2.4.2.m2.2.3.2.1.1" stretchy="false" xref="S3.F2.4.2.m2.2.3.1.cmml">(</mo><mi id="S3.F2.4.2.m2.2.2" xref="S3.F2.4.2.m2.2.2.cmml">α</mi><mo id="S3.F2.4.2.m2.2.3.2.1.2" stretchy="false" xref="S3.F2.4.2.m2.2.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.4.2.m2.2c"><apply id="S3.F2.4.2.m2.2.3.1.cmml" xref="S3.F2.4.2.m2.2.3.2"><sin id="S3.F2.4.2.m2.1.1.cmml" xref="S3.F2.4.2.m2.1.1"></sin><ci id="S3.F2.4.2.m2.2.2.cmml" xref="S3.F2.4.2.m2.2.2">𝛼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.4.2.m2.2d">\sin{(\alpha)}</annotation><annotation encoding="application/x-llamapun" id="S3.F2.4.2.m2.2e">roman_sin ( italic_α )</annotation></semantics></math> is not highly informative to distinguish between ID or OOD.</span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.SS3.p18">
<p class="ltx_p" id="S3.SS3.p18.8">where <math alttext="\theta" class="ltx_Math" display="inline" id="S3.SS3.p18.1.m1.1"><semantics id="S3.SS3.p18.1.m1.1a"><mi id="S3.SS3.p18.1.m1.1.1" xref="S3.SS3.p18.1.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p18.1.m1.1b"><ci id="S3.SS3.p18.1.m1.1.1.cmml" xref="S3.SS3.p18.1.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p18.1.m1.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p18.1.m1.1d">italic_θ</annotation></semantics></math> and <math alttext="\alpha" class="ltx_Math" display="inline" id="S3.SS3.p18.2.m2.1"><semantics id="S3.SS3.p18.2.m2.1a"><mi id="S3.SS3.p18.2.m2.1.1" xref="S3.SS3.p18.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p18.2.m2.1b"><ci id="S3.SS3.p18.2.m2.1.1.cmml" xref="S3.SS3.p18.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p18.2.m2.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p18.2.m2.1d">italic_α</annotation></semantics></math> are the angles opposite to the sides <math alttext="\mathbf{z}-\bm{\mu_{\text{ID}}}-\mathbf{(z_{db}}-\bm{\mu_{\text{ID}}})" class="ltx_Math" display="inline" id="S3.SS3.p18.3.m3.1"><semantics id="S3.SS3.p18.3.m3.1a"><mrow id="S3.SS3.p18.3.m3.1.1" xref="S3.SS3.p18.3.m3.1.1.cmml"><mi id="S3.SS3.p18.3.m3.1.1.3" xref="S3.SS3.p18.3.m3.1.1.3.cmml">𝐳</mi><mo id="S3.SS3.p18.3.m3.1.1.2" xref="S3.SS3.p18.3.m3.1.1.2.cmml">−</mo><msub id="S3.SS3.p18.3.m3.1.1.4" xref="S3.SS3.p18.3.m3.1.1.4.cmml"><mi id="S3.SS3.p18.3.m3.1.1.4.2" xref="S3.SS3.p18.3.m3.1.1.4.2.cmml">𝝁</mi><mtext id="S3.SS3.p18.3.m3.1.1.4.3" xref="S3.SS3.p18.3.m3.1.1.4.3a.cmml">ID</mtext></msub><mo id="S3.SS3.p18.3.m3.1.1.2a" xref="S3.SS3.p18.3.m3.1.1.2.cmml">−</mo><mrow id="S3.SS3.p18.3.m3.1.1.1.1" xref="S3.SS3.p18.3.m3.1.1.1.1.1.cmml"><mo id="S3.SS3.p18.3.m3.1.1.1.1.2" stretchy="false" xref="S3.SS3.p18.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p18.3.m3.1.1.1.1.1" xref="S3.SS3.p18.3.m3.1.1.1.1.1.cmml"><msub id="S3.SS3.p18.3.m3.1.1.1.1.1.2" xref="S3.SS3.p18.3.m3.1.1.1.1.1.2.cmml"><mi id="S3.SS3.p18.3.m3.1.1.1.1.1.2.2" xref="S3.SS3.p18.3.m3.1.1.1.1.1.2.2.cmml">𝐳</mi><mi id="S3.SS3.p18.3.m3.1.1.1.1.1.2.3" xref="S3.SS3.p18.3.m3.1.1.1.1.1.2.3.cmml">𝐝𝐛</mi></msub><mo id="S3.SS3.p18.3.m3.1.1.1.1.1.1" xref="S3.SS3.p18.3.m3.1.1.1.1.1.1.cmml">−</mo><msub id="S3.SS3.p18.3.m3.1.1.1.1.1.3" xref="S3.SS3.p18.3.m3.1.1.1.1.1.3.cmml"><mi id="S3.SS3.p18.3.m3.1.1.1.1.1.3.2" xref="S3.SS3.p18.3.m3.1.1.1.1.1.3.2.cmml">𝝁</mi><mtext id="S3.SS3.p18.3.m3.1.1.1.1.1.3.3" xref="S3.SS3.p18.3.m3.1.1.1.1.1.3.3a.cmml">ID</mtext></msub></mrow><mo id="S3.SS3.p18.3.m3.1.1.1.1.3" stretchy="false" xref="S3.SS3.p18.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p18.3.m3.1b"><apply id="S3.SS3.p18.3.m3.1.1.cmml" xref="S3.SS3.p18.3.m3.1.1"><minus id="S3.SS3.p18.3.m3.1.1.2.cmml" xref="S3.SS3.p18.3.m3.1.1.2"></minus><ci id="S3.SS3.p18.3.m3.1.1.3.cmml" xref="S3.SS3.p18.3.m3.1.1.3">𝐳</ci><apply id="S3.SS3.p18.3.m3.1.1.4.cmml" xref="S3.SS3.p18.3.m3.1.1.4"><csymbol cd="ambiguous" id="S3.SS3.p18.3.m3.1.1.4.1.cmml" xref="S3.SS3.p18.3.m3.1.1.4">subscript</csymbol><ci id="S3.SS3.p18.3.m3.1.1.4.2.cmml" xref="S3.SS3.p18.3.m3.1.1.4.2">𝝁</ci><ci id="S3.SS3.p18.3.m3.1.1.4.3a.cmml" xref="S3.SS3.p18.3.m3.1.1.4.3"><mtext id="S3.SS3.p18.3.m3.1.1.4.3.cmml" mathsize="70%" xref="S3.SS3.p18.3.m3.1.1.4.3">ID</mtext></ci></apply><apply id="S3.SS3.p18.3.m3.1.1.1.1.1.cmml" xref="S3.SS3.p18.3.m3.1.1.1.1"><minus id="S3.SS3.p18.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS3.p18.3.m3.1.1.1.1.1.1"></minus><apply id="S3.SS3.p18.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS3.p18.3.m3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p18.3.m3.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p18.3.m3.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS3.p18.3.m3.1.1.1.1.1.2.2.cmml" xref="S3.SS3.p18.3.m3.1.1.1.1.1.2.2">𝐳</ci><ci id="S3.SS3.p18.3.m3.1.1.1.1.1.2.3.cmml" xref="S3.SS3.p18.3.m3.1.1.1.1.1.2.3">𝐝𝐛</ci></apply><apply id="S3.SS3.p18.3.m3.1.1.1.1.1.3.cmml" xref="S3.SS3.p18.3.m3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p18.3.m3.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p18.3.m3.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.p18.3.m3.1.1.1.1.1.3.2.cmml" xref="S3.SS3.p18.3.m3.1.1.1.1.1.3.2">𝝁</ci><ci id="S3.SS3.p18.3.m3.1.1.1.1.1.3.3a.cmml" xref="S3.SS3.p18.3.m3.1.1.1.1.1.3.3"><mtext id="S3.SS3.p18.3.m3.1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S3.SS3.p18.3.m3.1.1.1.1.1.3.3">ID</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p18.3.m3.1c">\mathbf{z}-\bm{\mu_{\text{ID}}}-\mathbf{(z_{db}}-\bm{\mu_{\text{ID}}})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p18.3.m3.1d">bold_z - bold_italic_μ start_POSTSUBSCRIPT ID end_POSTSUBSCRIPT - ( bold_z start_POSTSUBSCRIPT bold_db end_POSTSUBSCRIPT - bold_italic_μ start_POSTSUBSCRIPT ID end_POSTSUBSCRIPT )</annotation></semantics></math> and <math alttext="\mathbf{z}-\bm{\mu_{\text{ID}}}" class="ltx_Math" display="inline" id="S3.SS3.p18.4.m4.1"><semantics id="S3.SS3.p18.4.m4.1a"><mrow id="S3.SS3.p18.4.m4.1.1" xref="S3.SS3.p18.4.m4.1.1.cmml"><mi id="S3.SS3.p18.4.m4.1.1.2" xref="S3.SS3.p18.4.m4.1.1.2.cmml">𝐳</mi><mo id="S3.SS3.p18.4.m4.1.1.1" xref="S3.SS3.p18.4.m4.1.1.1.cmml">−</mo><msub id="S3.SS3.p18.4.m4.1.1.3" xref="S3.SS3.p18.4.m4.1.1.3.cmml"><mi id="S3.SS3.p18.4.m4.1.1.3.2" xref="S3.SS3.p18.4.m4.1.1.3.2.cmml">𝝁</mi><mtext id="S3.SS3.p18.4.m4.1.1.3.3" xref="S3.SS3.p18.4.m4.1.1.3.3a.cmml">ID</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p18.4.m4.1b"><apply id="S3.SS3.p18.4.m4.1.1.cmml" xref="S3.SS3.p18.4.m4.1.1"><minus id="S3.SS3.p18.4.m4.1.1.1.cmml" xref="S3.SS3.p18.4.m4.1.1.1"></minus><ci id="S3.SS3.p18.4.m4.1.1.2.cmml" xref="S3.SS3.p18.4.m4.1.1.2">𝐳</ci><apply id="S3.SS3.p18.4.m4.1.1.3.cmml" xref="S3.SS3.p18.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p18.4.m4.1.1.3.1.cmml" xref="S3.SS3.p18.4.m4.1.1.3">subscript</csymbol><ci id="S3.SS3.p18.4.m4.1.1.3.2.cmml" xref="S3.SS3.p18.4.m4.1.1.3.2">𝝁</ci><ci id="S3.SS3.p18.4.m4.1.1.3.3a.cmml" xref="S3.SS3.p18.4.m4.1.1.3.3"><mtext id="S3.SS3.p18.4.m4.1.1.3.3.cmml" mathsize="70%" xref="S3.SS3.p18.4.m4.1.1.3.3">ID</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p18.4.m4.1c">\mathbf{z}-\bm{\mu_{\text{ID}}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p18.4.m4.1d">bold_z - bold_italic_μ start_POSTSUBSCRIPT ID end_POSTSUBSCRIPT</annotation></semantics></math> respectively. Although the observation they made on comparing the distances to the decision boundaries at equal deviation levels from the mean of in-distribution is inspiring, we claim that the angle <math alttext="\alpha" class="ltx_Math" display="inline" id="S3.SS3.p18.5.m5.1"><semantics id="S3.SS3.p18.5.m5.1a"><mi id="S3.SS3.p18.5.m5.1.1" xref="S3.SS3.p18.5.m5.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p18.5.m5.1b"><ci id="S3.SS3.p18.5.m5.1.1.cmml" xref="S3.SS3.p18.5.m5.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p18.5.m5.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p18.5.m5.1d">italic_α</annotation></semantics></math> is not very informative for ID and OOD separation. This is because <math alttext="\alpha" class="ltx_Math" display="inline" id="S3.SS3.p18.6.m6.1"><semantics id="S3.SS3.p18.6.m6.1a"><mi id="S3.SS3.p18.6.m6.1.1" xref="S3.SS3.p18.6.m6.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p18.6.m6.1b"><ci id="S3.SS3.p18.6.m6.1.1.cmml" xref="S3.SS3.p18.6.m6.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p18.6.m6.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p18.6.m6.1d">italic_α</annotation></semantics></math> is connected to the magnitude of the feature vector relative to <math alttext="\bm{\mu_{\text{ID}}}" class="ltx_Math" display="inline" id="S3.SS3.p18.7.m7.1"><semantics id="S3.SS3.p18.7.m7.1a"><msub id="S3.SS3.p18.7.m7.1.1" xref="S3.SS3.p18.7.m7.1.1.cmml"><mi id="S3.SS3.p18.7.m7.1.1.2" xref="S3.SS3.p18.7.m7.1.1.2.cmml">𝝁</mi><mtext id="S3.SS3.p18.7.m7.1.1.3" xref="S3.SS3.p18.7.m7.1.1.3a.cmml">ID</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p18.7.m7.1b"><apply id="S3.SS3.p18.7.m7.1.1.cmml" xref="S3.SS3.p18.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.p18.7.m7.1.1.1.cmml" xref="S3.SS3.p18.7.m7.1.1">subscript</csymbol><ci id="S3.SS3.p18.7.m7.1.1.2.cmml" xref="S3.SS3.p18.7.m7.1.1.2">𝝁</ci><ci id="S3.SS3.p18.7.m7.1.1.3a.cmml" xref="S3.SS3.p18.7.m7.1.1.3"><mtext id="S3.SS3.p18.7.m7.1.1.3.cmml" mathsize="70%" xref="S3.SS3.p18.7.m7.1.1.3">ID</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p18.7.m7.1c">\bm{\mu_{\text{ID}}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p18.7.m7.1d">bold_italic_μ start_POSTSUBSCRIPT ID end_POSTSUBSCRIPT</annotation></semantics></math>, which may not directly correlate with OOD characteristics. On Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#S3.F2" title="Figure 2 ‣ 3.3 Features on the Decision Boundary ‣ 3 Method ‣ Look Around and Find Out: OOD Detection with Relative Angles"><span class="ltx_text ltx_ref_tag">2</span></a> we show the <math alttext="\sin{(\alpha)}" class="ltx_Math" display="inline" id="S3.SS3.p18.8.m8.2"><semantics id="S3.SS3.p18.8.m8.2a"><mrow id="S3.SS3.p18.8.m8.2.3.2" xref="S3.SS3.p18.8.m8.2.3.1.cmml"><mi id="S3.SS3.p18.8.m8.1.1" xref="S3.SS3.p18.8.m8.1.1.cmml">sin</mi><mo id="S3.SS3.p18.8.m8.2.3.2a" xref="S3.SS3.p18.8.m8.2.3.1.cmml">⁡</mo><mrow id="S3.SS3.p18.8.m8.2.3.2.1" xref="S3.SS3.p18.8.m8.2.3.1.cmml"><mo id="S3.SS3.p18.8.m8.2.3.2.1.1" stretchy="false" xref="S3.SS3.p18.8.m8.2.3.1.cmml">(</mo><mi id="S3.SS3.p18.8.m8.2.2" xref="S3.SS3.p18.8.m8.2.2.cmml">α</mi><mo id="S3.SS3.p18.8.m8.2.3.2.1.2" stretchy="false" xref="S3.SS3.p18.8.m8.2.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p18.8.m8.2b"><apply id="S3.SS3.p18.8.m8.2.3.1.cmml" xref="S3.SS3.p18.8.m8.2.3.2"><sin id="S3.SS3.p18.8.m8.1.1.cmml" xref="S3.SS3.p18.8.m8.1.1"></sin><ci id="S3.SS3.p18.8.m8.2.2.cmml" xref="S3.SS3.p18.8.m8.2.2">𝛼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p18.8.m8.2c">\sin{(\alpha)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p18.8.m8.2d">roman_sin ( italic_α )</annotation></semantics></math> values between CIFAR-10 &nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib20" title="">20</a>]</cite> and Texture &nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib5" title="">5</a>]</cite> datasets, empirically justifying that including this term impedes fDBD’s performance. Omitting the denominator from Equation <a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#S3.E5" title="Equation 5 ‣ 3.3 Features on the Decision Boundary ‣ 3 Method ‣ Look Around and Find Out: OOD Detection with Relative Angles"><span class="ltx_text ltx_ref_tag">5</span></a> allows to effectively capture the relation between the feature representation and the decision boundary from the mean of in-distribution’s view.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">In this section, we demonstrate the performance of LAFO on various settings and benchmarks. We will first provide our results on the most common benchmarks CIFAR-10 &nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib20" title="">20</a>]</cite> and ImageNet &nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib6" title="">6</a>]</cite> to show small and large scale performance of our scoring. Then, we show the flexibility of LAFO by (i) combining it with different activation shaping algorithms, (ii) using it to aggregate different architectures’ confidences via simply summing their scores, exploiting the scale-invariance property of LAFO. Moreover, an ablation study is presented to show the efficacy of the design choices.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S4.p2">
<p class="ltx_p" id="S4.p2.3"><span class="ltx_text ltx_font_bold" id="S4.p2.3.1">Benchmarks:</span> We mainly consider two widely used benchmarks: CIFAR-10 &nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib20" title="">20</a>]</cite> and ImageNet &nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib6" title="">6</a>]</cite>). We included the evaluation on CIFAR-10 OOD Benchmark to show the performance on smaller scale datasets. In CIFAR-10 experiments, we use a pretrained ResNet-18 architecture &nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib14" title="">14</a>]</cite> trained with supervised contrastive loss <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib19" title="">19</a>]</cite>, following previous literature <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib25" title="">25</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib39" title="">39</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib36" title="">36</a>]</cite>. During inference <math alttext="10.000" class="ltx_Math" display="inline" id="S4.p2.1.m1.1"><semantics id="S4.p2.1.m1.1a"><mn id="S4.p2.1.m1.1.1" xref="S4.p2.1.m1.1.1.cmml">10.000</mn><annotation-xml encoding="MathML-Content" id="S4.p2.1.m1.1b"><cn id="S4.p2.1.m1.1.1.cmml" type="float" xref="S4.p2.1.m1.1.1">10.000</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.1.m1.1c">10.000</annotation><annotation encoding="application/x-llamapun" id="S4.p2.1.m1.1d">10.000</annotation></semantics></math> test samples are used to set the in-distribution scores and choose the threshold value <math alttext="\lambda" class="ltx_Math" display="inline" id="S4.p2.2.m2.1"><semantics id="S4.p2.2.m2.1a"><mi id="S4.p2.2.m2.1.1" xref="S4.p2.2.m2.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.p2.2.m2.1b"><ci id="S4.p2.2.m2.1.1.cmml" xref="S4.p2.2.m2.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.2.m2.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S4.p2.2.m2.1d">italic_λ</annotation></semantics></math>; while the datasets SVHN &nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib33" title="">33</a>]</cite>, iSUN &nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib48" title="">48</a>]</cite>, Places365 &nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib52" title="">52</a>]</cite> and Texture &nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib5" title="">5</a>]</cite> are used to obtain out-of-distribution scores and metric evaluation. Similarly, for large scale ImageNet OOD Benchmark, we use a pretrained ResNet-50 architecture trained with supervised contrastive loss. In-distribution validation set of size <math alttext="50.000" class="ltx_Math" display="inline" id="S4.p2.3.m3.1"><semantics id="S4.p2.3.m3.1a"><mn id="S4.p2.3.m3.1.1" xref="S4.p2.3.m3.1.1.cmml">50.000</mn><annotation-xml encoding="MathML-Content" id="S4.p2.3.m3.1b"><cn id="S4.p2.3.m3.1.1.cmml" type="float" xref="S4.p2.3.m3.1.1">50.000</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.3.m3.1c">50.000</annotation><annotation encoding="application/x-llamapun" id="S4.p2.3.m3.1d">50.000</annotation></semantics></math> is used to set the ID scores and the threshold, and the datasets iNaturalist &nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib42" title="">42</a>]</cite>, SUN &nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib45" title="">45</a>]</cite>, Places365 &nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib52" title="">52</a>]</cite> and Texture &nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib5" title="">5</a>]</cite> are used to obtain out-of-distribution scores and metric evaluation.
We analyzed the case of architectures trained with Cross Entropy loss, in the ensemble experiment of Table <a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#S4.F3.2" title="Figure 3 ‣ 4.2 Model Ensembling with LAFO ‣ 4 Experiments ‣ Look Around and Find Out: OOD Detection with Relative Angles"><span class="ltx_text ltx_ref_tag">3</span></a>.
Note that, in this typical OOD Detection Benchmarks the samples that have same classes as ID are removed from their OOD counterparts, following the work &nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib17" title="">17</a>]</cite> and fitting into our problem setting.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S4.p3">
<p class="ltx_p" id="S4.p3.2"><span class="ltx_text ltx_font_bold" id="S4.p3.2.1">Metrics:</span> Throughout our experiments we report two metrics: False-positive rate at <math alttext="\%95" class="ltx_math_unparsed" display="inline" id="S4.p3.1.m1.1"><semantics id="S4.p3.1.m1.1a"><mrow id="S4.p3.1.m1.1b"><mo id="S4.p3.1.m1.1.1">%</mo><mn id="S4.p3.1.m1.1.2">95</mn></mrow><annotation encoding="application/x-tex" id="S4.p3.1.m1.1c">\%95</annotation><annotation encoding="application/x-llamapun" id="S4.p3.1.m1.1d">% 95</annotation></semantics></math> true positive rate (FPR95), and Area Under the Receiver Operating Characteristic Curve (AUROC). FPR95, simply measures what percentage of OOD data we falsely classify as ID where our threshold includes <math alttext="95\%" class="ltx_Math" display="inline" id="S4.p3.2.m2.1"><semantics id="S4.p3.2.m2.1a"><mrow id="S4.p3.2.m2.1.1" xref="S4.p3.2.m2.1.1.cmml"><mn id="S4.p3.2.m2.1.1.2" xref="S4.p3.2.m2.1.1.2.cmml">95</mn><mo id="S4.p3.2.m2.1.1.1" xref="S4.p3.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.2.m2.1b"><apply id="S4.p3.2.m2.1.1.cmml" xref="S4.p3.2.m2.1.1"><csymbol cd="latexml" id="S4.p3.2.m2.1.1.1.cmml" xref="S4.p3.2.m2.1.1.1">percent</csymbol><cn id="S4.p3.2.m2.1.1.2.cmml" type="integer" xref="S4.p3.2.m2.1.1.2">95</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.2.m2.1c">95\%</annotation><annotation encoding="application/x-llamapun" id="S4.p3.2.m2.1d">95 %</annotation></semantics></math> of ID data.
Therefore, smaller FPR95 indicates a better performance by sharply controlling the false positive rate. On the other hand, AUROC measures the model’s ability to distinguish between ID and OOD by calculating the area under the curve that plots the true positive rate against the false positive rate across various thresholds. AUROC shows how rapidly we include ID data while paying the cost of including false positives. Thus, higher AUROC shows a better result.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S4.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T1.15.2.1" style="font-size:90%;">Table 1</span>: </span><span class="ltx_text" id="S4.T1.2.1" style="font-size:90%;">LAFO achieves state-of-the-art performance on CIFAR-10 OOD benchmark. Evaluated on ResNet-18 with FPR95 and AUROC. <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T1.2.1.m1.1"><semantics id="S4.T1.2.1.m1.1b"><mo id="S4.T1.2.1.m1.1.1" stretchy="false" xref="S4.T1.2.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T1.2.1.m1.1c"><ci id="S4.T1.2.1.m1.1.1.cmml" xref="S4.T1.2.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.1.m1.1d">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.2.1.m1.1e">↑</annotation></semantics></math> indicates that larger values are better and vice versa. Best performance highlighted in <span class="ltx_text ltx_font_bold" id="S4.T1.2.1.1">bold</span>. Methods with * are hyperparameter-free.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T1.12" style="width:433.6pt;height:166.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-64.0pt,24.6pt) scale(0.772098815820014,0.772098815820014) ;">
<table class="ltx_tabular ltx_align_middle" id="S4.T1.12.10">
<tbody><tr class="ltx_tr" id="S4.T1.12.10.11">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.12.10.11.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="S4.T1.12.10.11.1.1">Method</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S4.T1.12.10.11.2"><span class="ltx_text ltx_font_bold" id="S4.T1.12.10.11.2.1">SVHN</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S4.T1.12.10.11.3"><span class="ltx_text ltx_font_bold" id="S4.T1.12.10.11.3.1">iSUN</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S4.T1.12.10.11.4"><span class="ltx_text ltx_font_bold" id="S4.T1.12.10.11.4.1">Place365</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S4.T1.12.10.11.5"><span class="ltx_text ltx_font_bold" id="S4.T1.12.10.11.5.1">Texture</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S4.T1.12.10.11.6"><span class="ltx_text ltx_font_bold" id="S4.T1.12.10.11.6.1">Avg</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.12.10.10">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.1.1.1">FPR95<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T1.3.1.1.1.m1.1"><semantics id="S4.T1.3.1.1.1.m1.1a"><mo id="S4.T1.3.1.1.1.m1.1.1" stretchy="false" xref="S4.T1.3.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T1.3.1.1.1.m1.1b"><ci id="S4.T1.3.1.1.1.m1.1.1.cmml" xref="S4.T1.3.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.1.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.3.1.1.1.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.2.2.2">AUROC<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T1.4.2.2.2.m1.1"><semantics id="S4.T1.4.2.2.2.m1.1a"><mo id="S4.T1.4.2.2.2.m1.1.1" stretchy="false" xref="S4.T1.4.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T1.4.2.2.2.m1.1b"><ci id="S4.T1.4.2.2.2.m1.1.1.cmml" xref="S4.T1.4.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.2.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.4.2.2.2.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.5.3.3.3">FPR95<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T1.5.3.3.3.m1.1"><semantics id="S4.T1.5.3.3.3.m1.1a"><mo id="S4.T1.5.3.3.3.m1.1.1" stretchy="false" xref="S4.T1.5.3.3.3.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T1.5.3.3.3.m1.1b"><ci id="S4.T1.5.3.3.3.m1.1.1.cmml" xref="S4.T1.5.3.3.3.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.5.3.3.3.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.5.3.3.3.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.4.4.4">AUROC<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T1.6.4.4.4.m1.1"><semantics id="S4.T1.6.4.4.4.m1.1a"><mo id="S4.T1.6.4.4.4.m1.1.1" stretchy="false" xref="S4.T1.6.4.4.4.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T1.6.4.4.4.m1.1b"><ci id="S4.T1.6.4.4.4.m1.1.1.cmml" xref="S4.T1.6.4.4.4.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.6.4.4.4.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.6.4.4.4.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.5.5.5">FPR95<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T1.7.5.5.5.m1.1"><semantics id="S4.T1.7.5.5.5.m1.1a"><mo id="S4.T1.7.5.5.5.m1.1.1" stretchy="false" xref="S4.T1.7.5.5.5.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T1.7.5.5.5.m1.1b"><ci id="S4.T1.7.5.5.5.m1.1.1.cmml" xref="S4.T1.7.5.5.5.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.7.5.5.5.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.7.5.5.5.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.8.6.6.6">AUROC<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T1.8.6.6.6.m1.1"><semantics id="S4.T1.8.6.6.6.m1.1a"><mo id="S4.T1.8.6.6.6.m1.1.1" stretchy="false" xref="S4.T1.8.6.6.6.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T1.8.6.6.6.m1.1b"><ci id="S4.T1.8.6.6.6.m1.1.1.cmml" xref="S4.T1.8.6.6.6.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.8.6.6.6.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.8.6.6.6.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.9.7.7.7">FPR95<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T1.9.7.7.7.m1.1"><semantics id="S4.T1.9.7.7.7.m1.1a"><mo id="S4.T1.9.7.7.7.m1.1.1" stretchy="false" xref="S4.T1.9.7.7.7.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T1.9.7.7.7.m1.1b"><ci id="S4.T1.9.7.7.7.m1.1.1.cmml" xref="S4.T1.9.7.7.7.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.9.7.7.7.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.9.7.7.7.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.10.8.8.8">AUROC<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T1.10.8.8.8.m1.1"><semantics id="S4.T1.10.8.8.8.m1.1a"><mo id="S4.T1.10.8.8.8.m1.1.1" stretchy="false" xref="S4.T1.10.8.8.8.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T1.10.8.8.8.m1.1b"><ci id="S4.T1.10.8.8.8.m1.1.1.cmml" xref="S4.T1.10.8.8.8.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.10.8.8.8.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.10.8.8.8.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.11.9.9.9">FPR95<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T1.11.9.9.9.m1.1"><semantics id="S4.T1.11.9.9.9.m1.1a"><mo id="S4.T1.11.9.9.9.m1.1.1" stretchy="false" xref="S4.T1.11.9.9.9.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T1.11.9.9.9.m1.1b"><ci id="S4.T1.11.9.9.9.m1.1.1.cmml" xref="S4.T1.11.9.9.9.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.11.9.9.9.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.11.9.9.9.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.12.10.10.10">AUROC<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T1.12.10.10.10.m1.1"><semantics id="S4.T1.12.10.10.10.m1.1a"><mo id="S4.T1.12.10.10.10.m1.1.1" stretchy="false" xref="S4.T1.12.10.10.10.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T1.12.10.10.10.m1.1b"><ci id="S4.T1.12.10.10.10.m1.1.1.cmml" xref="S4.T1.12.10.10.10.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.12.10.10.10.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.12.10.10.10.m1.1d">↑</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.12.10.12">
<td class="ltx_td ltx_align_left" id="S4.T1.12.10.12.1">
<span class="ltx_rule" style="width:0.0pt;height:8.6pt;background:black;display:inline-block;"></span>MSP *</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.12.2">59.51</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.12.3">91.29</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.12.4">54.57</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.12.5">92.12</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.12.6">62.55</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.12.7">88.63</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.12.8">66.49</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.12.9">88.50</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.12.10">60.78</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.12.11">90.14</td>
</tr>
<tr class="ltx_tr" id="S4.T1.12.10.13">
<td class="ltx_td ltx_align_left" id="S4.T1.12.10.13.1">ODIN</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.13.2">61.71</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.13.3">89.12</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.13.4">15.09</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.13.5">97.37</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.13.6">41.45</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.13.7">91.85</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.13.8">52.62</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.13.9">89.41</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.13.10">42.72</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.13.11">91.94</td>
</tr>
<tr class="ltx_tr" id="S4.T1.12.10.14">
<td class="ltx_td ltx_align_left" id="S4.T1.12.10.14.1">Energy *</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.14.2">53.96</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.14.3">91.32</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.14.4">27.52</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.14.5">95.59</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.14.6">42.80</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.14.7">91.03</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.14.8">55.23</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.14.9">89.37</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.14.10">44.88</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.14.11">91.83</td>
</tr>
<tr class="ltx_tr" id="S4.T1.12.10.15">
<td class="ltx_td ltx_align_left" id="S4.T1.12.10.15.1">ViM</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.15.2">25.38</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.15.3">95.40</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.15.4">30.52</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.15.5">95.10</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.15.6">47.36</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.15.7">90.68</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.15.8">25.69</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.15.9">95.01</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.15.10">32.24</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.15.11">94.05</td>
</tr>
<tr class="ltx_tr" id="S4.T1.12.10.16">
<td class="ltx_td ltx_align_left" id="S4.T1.12.10.16.1">MDS</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.16.2">16.77</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.16.3">95.67</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.16.4">7.56</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.16.5">97.93</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.16.6">85.87</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.16.7">68.44</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.16.8">35.21</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.16.9">85.90</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.16.10">36.35</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.16.11">86.99</td>
</tr>
<tr class="ltx_tr" id="S4.T1.12.10.17">
<td class="ltx_td ltx_align_left" id="S4.T1.12.10.17.1">CSI</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.17.2">37.38</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.17.3">94.69</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.17.4">10.36</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.17.5">98.01</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.17.6">38.31</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.17.7">93.04</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.17.8">28.85</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.17.9">94.87</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.17.10">28.73</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.17.11">95.15</td>
</tr>
<tr class="ltx_tr" id="S4.T1.12.10.18">
<td class="ltx_td ltx_align_left" id="S4.T1.12.10.18.1">SSD+</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.18.2">1.35</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.18.3">99.72</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.18.4">33.60</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.18.5">95.16</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.18.6">26.09</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.18.7">95.48</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.18.8">12.98</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.18.9">97.70</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.18.10">18.51</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.18.11">97.02</td>
</tr>
<tr class="ltx_tr" id="S4.T1.12.10.19">
<td class="ltx_td ltx_align_left" id="S4.T1.12.10.19.1">KNN+</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.19.2">2.20</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.19.3">99.57</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.19.4">20.06</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.19.5">96.74</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.19.6">23.06</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.19.7">95.36</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.19.8">8.09</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.19.9">98.56</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.19.10">13.35</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.19.11">97.56</td>
</tr>
<tr class="ltx_tr" id="S4.T1.12.10.20">
<td class="ltx_td ltx_align_left" id="S4.T1.12.10.20.1">fDBD *</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.20.2">4.59</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.20.3">99.00</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.20.4">10.04</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.20.5">98.07</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.20.6">23.16</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.20.7">95.09</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.20.8">9.61</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.20.9">98.22</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.20.10">11.85</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.10.20.11">97.60</td>
</tr>
<tr class="ltx_tr" id="S4.T1.12.10.21">
<td class="ltx_td ltx_align_left ltx_border_b" id="S4.T1.12.10.21.1">LAFO *</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T1.12.10.21.2">3.53</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T1.12.10.21.3">99.16</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T1.12.10.21.4">8.36</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T1.12.10.21.5">98.28</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T1.12.10.21.6">23.40</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T1.12.10.21.7">94.88</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T1.12.10.21.8">8.58</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T1.12.10.21.9">98.34</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T1.12.10.21.10"><span class="ltx_text ltx_font_bold" id="S4.T1.12.10.21.10.1">10.97</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T1.12.10.21.11"><span class="ltx_text ltx_font_bold" id="S4.T1.12.10.21.11.1">97.67</span></td>
</tr>
</tbody></table>
</span></div>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>OOD Detection on CIFAR-10 and ImageNet Benchmarks</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.2">Table <a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#S4.T1" title="Table 1 ‣ 4 Experiments ‣ Look Around and Find Out: OOD Detection with Relative Angles"><span class="ltx_text ltx_ref_tag">1</span></a> and Table <a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#S4.T2" title="Table 2 ‣ 4.1 OOD Detection on CIFAR-10 and ImageNet Benchmarks ‣ 4 Experiments ‣ Look Around and Find Out: OOD Detection with Relative Angles"><span class="ltx_text ltx_ref_tag">2</span></a> shows the performance of LAFO along with the 9 baselines on CIFAR-10 and ImageNet OOD Benchmarks, respectively. All the baselines on CIFAR-10 use ResNet-18 architecture and on ImageNet use ResNet-50. We compare with methods in three categories : (i) logit-based score functions, (ii) methods that utilize contrastively learned representations (iii) hyperparameter free methods. Our proposed method reaches <em class="ltx_emph ltx_font_italic" id="S4.SS1.p1.2.1">state-of-the-art</em> performance on both benchmarks, reducing the FPR95 on average by <math alttext="7.74\%" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><mrow id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml"><mn id="S4.SS1.p1.1.m1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.2.cmml">7.74</mn><mo id="S4.SS1.p1.1.m1.1.1.1" xref="S4.SS1.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"><csymbol cd="latexml" id="S4.SS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1">percent</csymbol><cn id="S4.SS1.p1.1.m1.1.1.2.cmml" type="float" xref="S4.SS1.p1.1.m1.1.1.2">7.74</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">7.74\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">7.74 %</annotation></semantics></math> on Imagenet and <math alttext="0.88\%" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.1"><semantics id="S4.SS1.p1.2.m2.1a"><mrow id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><mn id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml">0.88</mn><mo id="S4.SS1.p1.2.m2.1.1.1" xref="S4.SS1.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"><csymbol cd="latexml" id="S4.SS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1">percent</csymbol><cn id="S4.SS1.p1.2.m2.1.1.2.cmml" type="float" xref="S4.SS1.p1.2.m2.1.1.2">0.88</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">0.88\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m2.1d">0.88 %</annotation></semantics></math> on CIFAR10. In the following, we provide a detailed analysis of these results.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S4.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T2.15.2.1" style="font-size:90%;">Table 2</span>: </span><span class="ltx_text" id="S4.T2.2.1" style="font-size:90%;">LAFO achieves state-of-the-art performance on ImageNet OOD benchmark. Evaluated on ResNet-50 with FPR95 and AUROC. <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T2.2.1.m1.1"><semantics id="S4.T2.2.1.m1.1b"><mo id="S4.T2.2.1.m1.1.1" stretchy="false" xref="S4.T2.2.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.2.1.m1.1c"><ci id="S4.T2.2.1.m1.1.1.cmml" xref="S4.T2.2.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.1.m1.1d">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.2.1.m1.1e">↑</annotation></semantics></math> indicates that larger values are better and vice versa. Best performance highlighted in <span class="ltx_text ltx_font_bold" id="S4.T2.2.1.1">bold</span>. Methods with * are hyperparameter-free.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T2.12" style="width:433.6pt;height:152.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-64.0pt,22.6pt) scale(0.772098815820014,0.772098815820014) ;">
<table class="ltx_tabular ltx_align_middle" id="S4.T2.12.10">
<tbody><tr class="ltx_tr" id="S4.T2.12.10.11">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T2.12.10.11.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="S4.T2.12.10.11.1.1">Method</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S4.T2.12.10.11.2"><span class="ltx_text ltx_font_bold" id="S4.T2.12.10.11.2.1">iNaturalist</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S4.T2.12.10.11.3"><span class="ltx_text ltx_font_bold" id="S4.T2.12.10.11.3.1">SUN</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S4.T2.12.10.11.4"><span class="ltx_text ltx_font_bold" id="S4.T2.12.10.11.4.1">Places</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S4.T2.12.10.11.5"><span class="ltx_text ltx_font_bold" id="S4.T2.12.10.11.5.1">Texture</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S4.T2.12.10.11.6"><span class="ltx_text ltx_font_bold" id="S4.T2.12.10.11.6.1">Avg</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.12.10.10">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.3.1.1.1">FPR95<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T2.3.1.1.1.m1.1"><semantics id="S4.T2.3.1.1.1.m1.1a"><mo id="S4.T2.3.1.1.1.m1.1.1" stretchy="false" xref="S4.T2.3.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T2.3.1.1.1.m1.1b"><ci id="S4.T2.3.1.1.1.m1.1.1.cmml" xref="S4.T2.3.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.1.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.3.1.1.1.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.2.2.2">AUROC<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T2.4.2.2.2.m1.1"><semantics id="S4.T2.4.2.2.2.m1.1a"><mo id="S4.T2.4.2.2.2.m1.1.1" stretchy="false" xref="S4.T2.4.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.4.2.2.2.m1.1b"><ci id="S4.T2.4.2.2.2.m1.1.1.cmml" xref="S4.T2.4.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.2.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.4.2.2.2.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.3.3.3">FPR95<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T2.5.3.3.3.m1.1"><semantics id="S4.T2.5.3.3.3.m1.1a"><mo id="S4.T2.5.3.3.3.m1.1.1" stretchy="false" xref="S4.T2.5.3.3.3.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T2.5.3.3.3.m1.1b"><ci id="S4.T2.5.3.3.3.m1.1.1.cmml" xref="S4.T2.5.3.3.3.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.5.3.3.3.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.5.3.3.3.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.4.4.4">AUROC<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T2.6.4.4.4.m1.1"><semantics id="S4.T2.6.4.4.4.m1.1a"><mo id="S4.T2.6.4.4.4.m1.1.1" stretchy="false" xref="S4.T2.6.4.4.4.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.6.4.4.4.m1.1b"><ci id="S4.T2.6.4.4.4.m1.1.1.cmml" xref="S4.T2.6.4.4.4.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.6.4.4.4.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.6.4.4.4.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.7.5.5.5">FPR95<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T2.7.5.5.5.m1.1"><semantics id="S4.T2.7.5.5.5.m1.1a"><mo id="S4.T2.7.5.5.5.m1.1.1" stretchy="false" xref="S4.T2.7.5.5.5.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T2.7.5.5.5.m1.1b"><ci id="S4.T2.7.5.5.5.m1.1.1.cmml" xref="S4.T2.7.5.5.5.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.7.5.5.5.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.7.5.5.5.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.6.6.6">AUROC<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T2.8.6.6.6.m1.1"><semantics id="S4.T2.8.6.6.6.m1.1a"><mo id="S4.T2.8.6.6.6.m1.1.1" stretchy="false" xref="S4.T2.8.6.6.6.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.8.6.6.6.m1.1b"><ci id="S4.T2.8.6.6.6.m1.1.1.cmml" xref="S4.T2.8.6.6.6.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.8.6.6.6.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.8.6.6.6.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.9.7.7.7">FPR95<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T2.9.7.7.7.m1.1"><semantics id="S4.T2.9.7.7.7.m1.1a"><mo id="S4.T2.9.7.7.7.m1.1.1" stretchy="false" xref="S4.T2.9.7.7.7.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T2.9.7.7.7.m1.1b"><ci id="S4.T2.9.7.7.7.m1.1.1.cmml" xref="S4.T2.9.7.7.7.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.9.7.7.7.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.9.7.7.7.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.10.8.8.8">AUROC<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T2.10.8.8.8.m1.1"><semantics id="S4.T2.10.8.8.8.m1.1a"><mo id="S4.T2.10.8.8.8.m1.1.1" stretchy="false" xref="S4.T2.10.8.8.8.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.10.8.8.8.m1.1b"><ci id="S4.T2.10.8.8.8.m1.1.1.cmml" xref="S4.T2.10.8.8.8.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.10.8.8.8.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.10.8.8.8.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.11.9.9.9">FPR95<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T2.11.9.9.9.m1.1"><semantics id="S4.T2.11.9.9.9.m1.1a"><mo id="S4.T2.11.9.9.9.m1.1.1" stretchy="false" xref="S4.T2.11.9.9.9.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T2.11.9.9.9.m1.1b"><ci id="S4.T2.11.9.9.9.m1.1.1.cmml" xref="S4.T2.11.9.9.9.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.11.9.9.9.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.11.9.9.9.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.12.10.10.10">AUROC<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T2.12.10.10.10.m1.1"><semantics id="S4.T2.12.10.10.10.m1.1a"><mo id="S4.T2.12.10.10.10.m1.1.1" stretchy="false" xref="S4.T2.12.10.10.10.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.12.10.10.10.m1.1b"><ci id="S4.T2.12.10.10.10.m1.1.1.cmml" xref="S4.T2.12.10.10.10.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.12.10.10.10.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.12.10.10.10.m1.1d">↑</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T2.12.10.12">
<td class="ltx_td ltx_align_left" id="S4.T2.12.10.12.1">
<span class="ltx_rule" style="width:0.0pt;height:8.6pt;background:black;display:inline-block;"></span>MSP *</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.12.2">54.99</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.12.3">87.74</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.12.4">70.83</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.12.5">80.63</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.12.6">73.99</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.12.7">79.76</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.12.8">68.00</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.12.9">79.61</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.12.10">66.95</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.12.11">81.99</td>
</tr>
<tr class="ltx_tr" id="S4.T2.12.10.13">
<td class="ltx_td ltx_align_left" id="S4.T2.12.10.13.1">ODIN</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.13.2">47.66</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.13.3">89.66</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.13.4">60.15</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.13.5">84.59</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.13.6">67.90</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.13.7">81.78</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.13.8">50.23</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.13.9">85.62</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.13.10">56.48</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.13.11">85.41</td>
</tr>
<tr class="ltx_tr" id="S4.T2.12.10.14">
<td class="ltx_td ltx_align_left" id="S4.T2.12.10.14.1">Energy *</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.14.2">55.72</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.14.3">89.95</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.14.4">59.26</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.14.5">85.89</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.14.6">64.92</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.14.7">82.86</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.14.8">53.72</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.14.9">85.99</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.14.10">58.41</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.14.11">86.17</td>
</tr>
<tr class="ltx_tr" id="S4.T2.12.10.15">
<td class="ltx_td ltx_align_left" id="S4.T2.12.10.15.1">ViM</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.15.2">71.85</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.15.3">87.42</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.15.4">81.79</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.15.5">81.07</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.15.6">83.12</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.15.7">78.40</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.15.8">14.88</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.15.9">96.83</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.15.10">62.91</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.15.11">85.93</td>
</tr>
<tr class="ltx_tr" id="S4.T2.12.10.16">
<td class="ltx_td ltx_align_left" id="S4.T2.12.10.16.1">MDS</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.16.2">97.00</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.16.3">52.65</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.16.4">98.50</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.16.5">42.41</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.16.6">98.40</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.16.7">41.79</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.16.8">55.80</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.16.9">85.01</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.16.10">87.43</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.16.11">55.17</td>
</tr>
<tr class="ltx_tr" id="S4.T2.12.10.17">
<td class="ltx_td ltx_align_left" id="S4.T2.12.10.17.1">SSD+</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.17.2">57.16</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.17.3">87.77</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.17.4">78.23</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.17.5">73.10</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.17.6">81.19</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.17.7">70.97</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.17.8">36.37</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.17.9">88.53</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.17.10">63.24</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.17.11">80.09</td>
</tr>
<tr class="ltx_tr" id="S4.T2.12.10.18">
<td class="ltx_td ltx_align_left" id="S4.T2.12.10.18.1">KNN+</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.18.2">30.18</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.18.3">94.89</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.18.4">48.99</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.18.5">88.63</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.18.6">59.15</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.18.7">84.71</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.18.8">15.55</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.18.9">95.40</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.18.10">38.47</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.18.11">90.91</td>
</tr>
<tr class="ltx_tr" id="S4.T2.12.10.19">
<td class="ltx_td ltx_align_left" id="S4.T2.12.10.19.1">fDBD *</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.19.2">17.27</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.19.3">96.68</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.19.4">42.30</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.19.5">90.90</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.19.6">49.77</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.19.7">88.36</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.19.8">21.83</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.19.9">95.43</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.19.10">32.78</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.10.19.11">92.86</td>
</tr>
<tr class="ltx_tr" id="S4.T2.12.10.20">
<td class="ltx_td ltx_align_left ltx_border_b" id="S4.T2.12.10.20.1">LAFO *</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T2.12.10.20.2">12.27</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T2.12.10.20.3">97.42</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T2.12.10.20.4">31.80</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T2.12.10.20.5">92.85</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T2.12.10.20.6">40.71</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T2.12.10.20.7">90.10</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T2.12.10.20.8">15.39</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T2.12.10.20.9">96.68</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T2.12.10.20.10"><span class="ltx_text ltx_font_bold" id="S4.T2.12.10.20.10.1">25.04</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T2.12.10.20.11"><span class="ltx_text ltx_font_bold" id="S4.T2.12.10.20.11.1">94.26</span></td>
</tr>
</tbody></table>
</span></div>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.4"><span class="ltx_text ltx_font_bold" id="S4.SS1.p2.4.1">LAFO continues to show the success of distance-based methods over logit-based methods.</span> Logit-based scoring methods MSP &nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib15" title="">15</a>]</cite>, Energy &nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib26" title="">26</a>]</cite> are one of the earliest baselines proving their success on measuring model’s confidences. MSP measures the maximum softmax probability as its score while Energy does a logsumexp operation on the logits. Recent distance-based methods like KNN+ &nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib39" title="">39</a>]</cite> and fDBD &nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib25" title="">25</a>]</cite>
outperforms the early logit-based ones. Similarly, LAFO achieves significantly better performance on both benchmarks, reducing the FPR95 up to <math alttext="49.81\%" class="ltx_Math" display="inline" id="S4.SS1.p2.1.m1.1"><semantics id="S4.SS1.p2.1.m1.1a"><mrow id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml"><mn id="S4.SS1.p2.1.m1.1.1.2" xref="S4.SS1.p2.1.m1.1.1.2.cmml">49.81</mn><mo id="S4.SS1.p2.1.m1.1.1.1" xref="S4.SS1.p2.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><apply id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1"><csymbol cd="latexml" id="S4.SS1.p2.1.m1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1.1">percent</csymbol><cn id="S4.SS1.p2.1.m1.1.1.2.cmml" type="float" xref="S4.SS1.p2.1.m1.1.1.2">49.81</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">49.81\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.1.m1.1d">49.81 %</annotation></semantics></math> and <math alttext="41.91\%" class="ltx_Math" display="inline" id="S4.SS1.p2.2.m2.1"><semantics id="S4.SS1.p2.2.m2.1a"><mrow id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml"><mn id="S4.SS1.p2.2.m2.1.1.2" xref="S4.SS1.p2.2.m2.1.1.2.cmml">41.91</mn><mo id="S4.SS1.p2.2.m2.1.1.1" xref="S4.SS1.p2.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><apply id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1"><csymbol cd="latexml" id="S4.SS1.p2.2.m2.1.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1.1">percent</csymbol><cn id="S4.SS1.p2.2.m2.1.1.2.cmml" type="float" xref="S4.SS1.p2.2.m2.1.1.2">41.91</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">41.91\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.2.m2.1d">41.91 %</annotation></semantics></math> while improving the AUROC up to <math alttext="7.53\%" class="ltx_Math" display="inline" id="S4.SS1.p2.3.m3.1"><semantics id="S4.SS1.p2.3.m3.1a"><mrow id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml"><mn id="S4.SS1.p2.3.m3.1.1.2" xref="S4.SS1.p2.3.m3.1.1.2.cmml">7.53</mn><mo id="S4.SS1.p2.3.m3.1.1.1" xref="S4.SS1.p2.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b"><apply id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1"><csymbol cd="latexml" id="S4.SS1.p2.3.m3.1.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1.1">percent</csymbol><cn id="S4.SS1.p2.3.m3.1.1.2.cmml" type="float" xref="S4.SS1.p2.3.m3.1.1.2">7.53</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">7.53\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.3.m3.1d">7.53 %</annotation></semantics></math> and <math alttext="12.27\%" class="ltx_Math" display="inline" id="S4.SS1.p2.4.m4.1"><semantics id="S4.SS1.p2.4.m4.1a"><mrow id="S4.SS1.p2.4.m4.1.1" xref="S4.SS1.p2.4.m4.1.1.cmml"><mn id="S4.SS1.p2.4.m4.1.1.2" xref="S4.SS1.p2.4.m4.1.1.2.cmml">12.27</mn><mo id="S4.SS1.p2.4.m4.1.1.1" xref="S4.SS1.p2.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m4.1b"><apply id="S4.SS1.p2.4.m4.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1"><csymbol cd="latexml" id="S4.SS1.p2.4.m4.1.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1.1">percent</csymbol><cn id="S4.SS1.p2.4.m4.1.1.2.cmml" type="float" xref="S4.SS1.p2.4.m4.1.1.2">12.27</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.4.m4.1c">12.27\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.4.m4.1d">12.27 %</annotation></semantics></math> on CIFAR-10 and ImageNet OOD benchmarks.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p3.1.1">LAFO improves on the recent success of methods using contrastively learned features.</span>
Table <a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#S4.T1" title="Table 1 ‣ 4 Experiments ‣ Look Around and Find Out: OOD Detection with Relative Angles"><span class="ltx_text ltx_ref_tag">1</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#S4.T2" title="Table 2 ‣ 4.1 OOD Detection on CIFAR-10 and ImageNet Benchmarks ‣ 4 Experiments ‣ Look Around and Find Out: OOD Detection with Relative Angles"><span class="ltx_text ltx_ref_tag">2</span></a> show the success of recent methods CSI &nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib40" title="">40</a>]</cite>, SSD+ &nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib36" title="">36</a>]</cite>, KNN+ &nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib39" title="">39</a>]</cite> and fDBD &nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib25" title="">25</a>]</cite> that utilizes contrastively learned representations over the ones those do not use. We observe that the additional structure the supervised contrastive loss puts on the feature representations are particularly beneficial to the distance-based methods. LAFO also benefits from more structured representations on the feature space, as it explores the relationship between the representation and the decision boundaries. Notably, LAFO improves both of the metrics on both CIFAR-10 and ImageNet benchmarks, achieving the state-of-the-art performance.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S4.SS1.p4">
<p class="ltx_p" id="S4.SS1.p4.4"><span class="ltx_text ltx_font_bold" id="S4.SS1.p4.4.1">LAFO enjoys being hyperparameter-free while offering state-of-the-art performance.</span>
Methods that use hyperparameters require a holdout set the tune them. Moreover, having different optimal hyperparameters for different benchmarks makes it harder to use them in real world applications. MSP &nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib15" title="">15</a>]</cite>, Energy &nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib26" title="">26</a>]</cite> and fDBD &nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib25" title="">25</a>]</cite> are the baselines which do not require any hyperparameters. LAFO outperforms the most competitive hyperparameter-free baseline fDBD by having <math alttext="10.97\%" class="ltx_Math" display="inline" id="S4.SS1.p4.1.m1.1"><semantics id="S4.SS1.p4.1.m1.1a"><mrow id="S4.SS1.p4.1.m1.1.1" xref="S4.SS1.p4.1.m1.1.1.cmml"><mn id="S4.SS1.p4.1.m1.1.1.2" xref="S4.SS1.p4.1.m1.1.1.2.cmml">10.97</mn><mo id="S4.SS1.p4.1.m1.1.1.1" xref="S4.SS1.p4.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.1.m1.1b"><apply id="S4.SS1.p4.1.m1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1"><csymbol cd="latexml" id="S4.SS1.p4.1.m1.1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1.1">percent</csymbol><cn id="S4.SS1.p4.1.m1.1.1.2.cmml" type="float" xref="S4.SS1.p4.1.m1.1.1.2">10.97</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.1.m1.1c">10.97\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.1.m1.1d">10.97 %</annotation></semantics></math> FPR95 on CIFAR-10 as opposed to fDBD’s <math alttext="11.85\%" class="ltx_Math" display="inline" id="S4.SS1.p4.2.m2.1"><semantics id="S4.SS1.p4.2.m2.1a"><mrow id="S4.SS1.p4.2.m2.1.1" xref="S4.SS1.p4.2.m2.1.1.cmml"><mn id="S4.SS1.p4.2.m2.1.1.2" xref="S4.SS1.p4.2.m2.1.1.2.cmml">11.85</mn><mo id="S4.SS1.p4.2.m2.1.1.1" xref="S4.SS1.p4.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.2.m2.1b"><apply id="S4.SS1.p4.2.m2.1.1.cmml" xref="S4.SS1.p4.2.m2.1.1"><csymbol cd="latexml" id="S4.SS1.p4.2.m2.1.1.1.cmml" xref="S4.SS1.p4.2.m2.1.1.1">percent</csymbol><cn id="S4.SS1.p4.2.m2.1.1.2.cmml" type="float" xref="S4.SS1.p4.2.m2.1.1.2">11.85</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.2.m2.1c">11.85\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.2.m2.1d">11.85 %</annotation></semantics></math>, and <math alttext="25.04\%" class="ltx_Math" display="inline" id="S4.SS1.p4.3.m3.1"><semantics id="S4.SS1.p4.3.m3.1a"><mrow id="S4.SS1.p4.3.m3.1.1" xref="S4.SS1.p4.3.m3.1.1.cmml"><mn id="S4.SS1.p4.3.m3.1.1.2" xref="S4.SS1.p4.3.m3.1.1.2.cmml">25.04</mn><mo id="S4.SS1.p4.3.m3.1.1.1" xref="S4.SS1.p4.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.3.m3.1b"><apply id="S4.SS1.p4.3.m3.1.1.cmml" xref="S4.SS1.p4.3.m3.1.1"><csymbol cd="latexml" id="S4.SS1.p4.3.m3.1.1.1.cmml" xref="S4.SS1.p4.3.m3.1.1.1">percent</csymbol><cn id="S4.SS1.p4.3.m3.1.1.2.cmml" type="float" xref="S4.SS1.p4.3.m3.1.1.2">25.04</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.3.m3.1c">25.04\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.3.m3.1d">25.04 %</annotation></semantics></math> FPR95 on ImageNet compared to fDBD’s <math alttext="32.78\%" class="ltx_Math" display="inline" id="S4.SS1.p4.4.m4.1"><semantics id="S4.SS1.p4.4.m4.1a"><mrow id="S4.SS1.p4.4.m4.1.1" xref="S4.SS1.p4.4.m4.1.1.cmml"><mn id="S4.SS1.p4.4.m4.1.1.2" xref="S4.SS1.p4.4.m4.1.1.2.cmml">32.78</mn><mo id="S4.SS1.p4.4.m4.1.1.1" xref="S4.SS1.p4.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.4.m4.1b"><apply id="S4.SS1.p4.4.m4.1.1.cmml" xref="S4.SS1.p4.4.m4.1.1"><csymbol cd="latexml" id="S4.SS1.p4.4.m4.1.1.1.cmml" xref="S4.SS1.p4.4.m4.1.1.1">percent</csymbol><cn id="S4.SS1.p4.4.m4.1.1.2.cmml" type="float" xref="S4.SS1.p4.4.m4.1.1.2">32.78</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.4.m4.1c">32.78\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.4.m4.1d">32.78 %</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Model Ensembling with LAFO</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">Recent works &nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib49" title="">49</a>]</cite> and &nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib46" title="">46</a>]</cite> show that creating an ensemble of models can enhance the OOD performance. Inspired from these works, and from the observation that scale invariant representations are compatible between distinct models <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib32" title="">32</a>]</cite>, we demonstrate that <em class="ltx_emph ltx_font_italic" id="S4.SS2.p1.1.1">scale-invariant score functions can aggregate the confidences from different models</em>, by simply summing their scores. On Table <a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#S4.F3.2" title="Figure 3 ‣ 4.2 Model Ensembling with LAFO ‣ 4 Experiments ‣ Look Around and Find Out: OOD Detection with Relative Angles"><span class="ltx_text ltx_ref_tag">3</span></a> we show the individual performances of models ResNet-50, ResNet-50 with supervised contrastive loss and ViT-B/16 as well as their combined performances using the scale-invariant LAFO.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure ltx_minipage ltx_align_middle ltx_align_floatright" id="S4.F3.2" style="width:411.9pt;">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F3.2.5.1.1" style="font-size:90%;">Figure 3</span>: </span><span class="ltx_text" id="S4.F3.2.6.2" style="font-size:90%;">LAFO can be used for ensemble OOD detection due to its scale-invariance property. Evaluated on ImageNet OOD benchmark. Best performance highlighted in <span class="ltx_text ltx_font_bold" id="S4.F3.2.6.2.1">bold</span>.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.F3.2.2" style="width:433.6pt;height:319pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(94.5pt,-69.5pt) scale(1.77248730545906,1.77248730545906) ;">
<table class="ltx_tabular ltx_align_middle" id="S4.F3.2.2.2">
<tbody><tr class="ltx_tr" id="S4.F3.2.2.2.3">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.F3.2.2.2.3.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="S4.F3.2.2.2.3.1.1">Method</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S4.F3.2.2.2.3.2"><span class="ltx_text ltx_font_bold" id="S4.F3.2.2.2.3.2.1">Avg</span></td>
<td class="ltx_td ltx_border_t" id="S4.F3.2.2.2.3.3"></td>
</tr>
<tr class="ltx_tr" id="S4.F3.2.2.2.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.F3.1.1.1.1.1">FPR95<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.F3.1.1.1.1.1.m1.1"><semantics id="S4.F3.1.1.1.1.1.m1.1a"><mo id="S4.F3.1.1.1.1.1.m1.1.1" stretchy="false" xref="S4.F3.1.1.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.F3.1.1.1.1.1.m1.1b"><ci id="S4.F3.1.1.1.1.1.m1.1.1.cmml" xref="S4.F3.1.1.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.1.1.1.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.F3.1.1.1.1.1.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.F3.2.2.2.2.2">AUROC<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.F3.2.2.2.2.2.m1.1"><semantics id="S4.F3.2.2.2.2.2.m1.1a"><mo id="S4.F3.2.2.2.2.2.m1.1.1" stretchy="false" xref="S4.F3.2.2.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.F3.2.2.2.2.2.m1.1b"><ci id="S4.F3.2.2.2.2.2.m1.1.1.cmml" xref="S4.F3.2.2.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.2.2.2.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.F3.2.2.2.2.2.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td" id="S4.F3.2.2.2.2.3"></td>
</tr>
<tr class="ltx_tr" id="S4.F3.2.2.2.4">
<td class="ltx_td ltx_align_left" id="S4.F3.2.2.2.4.1">
<span class="ltx_rule" style="width:0.0pt;height:8.6pt;background:black;display:inline-block;"></span>fDBD w/ResNet50</td>
<td class="ltx_td ltx_align_center" id="S4.F3.2.2.2.4.2">51.35</td>
<td class="ltx_td ltx_align_center" id="S4.F3.2.2.2.4.3">89.20</td>
<td class="ltx_td" id="S4.F3.2.2.2.4.4"></td>
</tr>
<tr class="ltx_tr" id="S4.F3.2.2.2.5">
<td class="ltx_td ltx_align_left" id="S4.F3.2.2.2.5.1">fDBD w/ResNet50-supcon</td>
<td class="ltx_td ltx_align_center" id="S4.F3.2.2.2.5.2">32.78</td>
<td class="ltx_td ltx_align_center" id="S4.F3.2.2.2.5.3">92.86</td>
<td class="ltx_td" id="S4.F3.2.2.2.5.4"></td>
</tr>
<tr class="ltx_tr" id="S4.F3.2.2.2.6">
<td class="ltx_td ltx_align_left" id="S4.F3.2.2.2.6.1">fDBD w/ViT-B/16</td>
<td class="ltx_td ltx_align_center" id="S4.F3.2.2.2.6.2">41.55</td>
<td class="ltx_td ltx_align_center" id="S4.F3.2.2.2.6.3">91.05</td>
<td class="ltx_td" id="S4.F3.2.2.2.6.4"></td>
</tr>
<tr class="ltx_tr" id="S4.F3.2.2.2.7">
<td class="ltx_td ltx_align_left" id="S4.F3.2.2.2.7.1">LAFO w/ResNet50</td>
<td class="ltx_td ltx_align_center" id="S4.F3.2.2.2.7.2">44.58</td>
<td class="ltx_td ltx_align_center" id="S4.F3.2.2.2.7.3">90.68</td>
<td class="ltx_td" id="S4.F3.2.2.2.7.4"></td>
</tr>
<tr class="ltx_tr" id="S4.F3.2.2.2.8">
<td class="ltx_td ltx_align_left" id="S4.F3.2.2.2.8.1">LAFO w/ResNet50-supcon</td>
<td class="ltx_td ltx_align_center" id="S4.F3.2.2.2.8.2">25.04</td>
<td class="ltx_td ltx_align_center" id="S4.F3.2.2.2.8.3">94.26</td>
<td class="ltx_td" id="S4.F3.2.2.2.8.4"></td>
</tr>
<tr class="ltx_tr" id="S4.F3.2.2.2.9">
<td class="ltx_td ltx_align_left" id="S4.F3.2.2.2.9.1">LAFO w/ViT-B/16</td>
<td class="ltx_td ltx_align_center" id="S4.F3.2.2.2.9.2">39.92</td>
<td class="ltx_td ltx_align_center" id="S4.F3.2.2.2.9.3">91.38</td>
<td class="ltx_td" id="S4.F3.2.2.2.9.4"></td>
</tr>
<tr class="ltx_tr" id="S4.F3.2.2.2.10">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.F3.2.2.2.10.1">Ensemble fDBD</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.F3.2.2.2.10.2">31.05</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.F3.2.2.2.10.3">95.29</td>
<td class="ltx_td ltx_border_t" id="S4.F3.2.2.2.10.4"></td>
</tr>
<tr class="ltx_tr" id="S4.F3.2.2.2.11">
<td class="ltx_td ltx_align_left ltx_border_b" id="S4.F3.2.2.2.11.1">Ensemble LAFO</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.F3.2.2.2.11.2"><span class="ltx_text ltx_font_bold" id="S4.F3.2.2.2.11.2.1">22.53</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.F3.2.2.2.11.3"><span class="ltx_text ltx_font_bold" id="S4.F3.2.2.2.11.3.1">96.41</span></td>
<td class="ltx_td ltx_border_b" id="S4.F3.2.2.2.11.4"></td>
</tr>
</tbody></table>
</span></div>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.4">Note that, we show the scale-invariance property of fDBD on section <a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#S3.SS3" title="3.3 Features on the Decision Boundary ‣ 3 Method ‣ Look Around and Find Out: OOD Detection with Relative Angles"><span class="ltx_text ltx_ref_tag">3.3</span></a> and added it to demonstrate the same idea and also to compare with LAFO. It can be seen that for both of the score functions, the performance of ensemble is better than their individual counterparts showing that score aggregation improves their OOD performance. Moreover, the ensemble with LAFO achieves a performance with <math alttext="22.53\%" class="ltx_Math" display="inline" id="S4.SS2.p2.1.m1.1"><semantics id="S4.SS2.p2.1.m1.1a"><mrow id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml"><mn id="S4.SS2.p2.1.m1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.2.cmml">22.53</mn><mo id="S4.SS2.p2.1.m1.1.1.1" xref="S4.SS2.p2.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1"><csymbol cd="latexml" id="S4.SS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1">percent</csymbol><cn id="S4.SS2.p2.1.m1.1.1.2.cmml" type="float" xref="S4.SS2.p2.1.m1.1.1.2">22.53</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">22.53\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.1.m1.1d">22.53 %</annotation></semantics></math> FPR95 and <math alttext="96.41\%" class="ltx_Math" display="inline" id="S4.SS2.p2.2.m2.1"><semantics id="S4.SS2.p2.2.m2.1a"><mrow id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml"><mn id="S4.SS2.p2.2.m2.1.1.2" xref="S4.SS2.p2.2.m2.1.1.2.cmml">96.41</mn><mo id="S4.SS2.p2.2.m2.1.1.1" xref="S4.SS2.p2.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><apply id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1"><csymbol cd="latexml" id="S4.SS2.p2.2.m2.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1">percent</csymbol><cn id="S4.SS2.p2.2.m2.1.1.2.cmml" type="float" xref="S4.SS2.p2.2.m2.1.1.2">96.41</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">96.41\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.2.m2.1d">96.41 %</annotation></semantics></math> AUROC, improving the metrics compared to the best individual performer in the ensemble by <math alttext="2.51\%" class="ltx_Math" display="inline" id="S4.SS2.p2.3.m3.1"><semantics id="S4.SS2.p2.3.m3.1a"><mrow id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml"><mn id="S4.SS2.p2.3.m3.1.1.2" xref="S4.SS2.p2.3.m3.1.1.2.cmml">2.51</mn><mo id="S4.SS2.p2.3.m3.1.1.1" xref="S4.SS2.p2.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><apply id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1"><csymbol cd="latexml" id="S4.SS2.p2.3.m3.1.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1.1">percent</csymbol><cn id="S4.SS2.p2.3.m3.1.1.2.cmml" type="float" xref="S4.SS2.p2.3.m3.1.1.2">2.51</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">2.51\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.3.m3.1d">2.51 %</annotation></semantics></math> and <math alttext="2.15\%" class="ltx_Math" display="inline" id="S4.SS2.p2.4.m4.1"><semantics id="S4.SS2.p2.4.m4.1a"><mrow id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml"><mn id="S4.SS2.p2.4.m4.1.1.2" xref="S4.SS2.p2.4.m4.1.1.2.cmml">2.15</mn><mo id="S4.SS2.p2.4.m4.1.1.1" xref="S4.SS2.p2.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><apply id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1"><csymbol cd="latexml" id="S4.SS2.p2.4.m4.1.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1.1">percent</csymbol><cn id="S4.SS2.p2.4.m4.1.1.2.cmml" type="float" xref="S4.SS2.p2.4.m4.1.1.2">2.15</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.1c">2.15\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.4.m4.1d">2.15 %</annotation></semantics></math> respectively. We show qualititave evidence of the improved performance by plotting the ID and OOD histograms on ImageNet &nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib6" title="">6</a>]</cite>(ID) and iNaturalist &nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib42" title="">42</a>]</cite> (OOD) datasets, respectively, in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#A1.F6" title="Figure 6 ‣ A.3 Model Ensemble Experiment ‣ Appendix A Appendix ‣ Look Around and Find Out: OOD Detection with Relative Angles"><span class="ltx_text ltx_ref_tag">6</span></a> in the Appendix, demonstrating a better separation in the ensembled model.
In summary, we demonstrate that scale-invariance of LAFO allows aggregating different models’ confidences to solve OOD Detection Problem.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S4.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T3.15.2.1" style="font-size:90%;">Table 3</span>: </span><span class="ltx_text" id="S4.T3.2.1" style="font-size:90%;">LAFO can be used as a plug-in on top of activation shaping algorithms. Evaluated under ImageNet OOD benchmark. <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T3.2.1.m1.1"><semantics id="S4.T3.2.1.m1.1b"><mo id="S4.T3.2.1.m1.1.1" stretchy="false" xref="S4.T3.2.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T3.2.1.m1.1c"><ci id="S4.T3.2.1.m1.1.1.cmml" xref="S4.T3.2.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.2.1.m1.1d">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.2.1.m1.1e">↑</annotation></semantics></math> indicates that larger values are better and vice versa. Best performance highlighted in <span class="ltx_text ltx_font_bold" id="S4.T3.2.1.1">bold</span>.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T3.12" style="width:433.6pt;height:78.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-79.8pt,14.5pt) scale(0.730921689809447,0.730921689809447) ;">
<table class="ltx_tabular ltx_align_middle" id="S4.T3.12.10">
<tbody><tr class="ltx_tr" id="S4.T3.12.10.11">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.12.10.11.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="S4.T3.12.10.11.1.1">Method</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S4.T3.12.10.11.2"><span class="ltx_text ltx_font_bold" id="S4.T3.12.10.11.2.1">iNaturalist</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S4.T3.12.10.11.3"><span class="ltx_text ltx_font_bold" id="S4.T3.12.10.11.3.1">SUN</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S4.T3.12.10.11.4"><span class="ltx_text ltx_font_bold" id="S4.T3.12.10.11.4.1">Places</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S4.T3.12.10.11.5"><span class="ltx_text ltx_font_bold" id="S4.T3.12.10.11.5.1">Texture</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S4.T3.12.10.11.6"><span class="ltx_text ltx_font_bold" id="S4.T3.12.10.11.6.1">Avg</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.12.10.10">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.1.1.1">FPR95<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T3.3.1.1.1.m1.1"><semantics id="S4.T3.3.1.1.1.m1.1a"><mo id="S4.T3.3.1.1.1.m1.1.1" stretchy="false" xref="S4.T3.3.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T3.3.1.1.1.m1.1b"><ci id="S4.T3.3.1.1.1.m1.1.1.cmml" xref="S4.T3.3.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.3.1.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.3.1.1.1.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.2.2.2">AUROC<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T3.4.2.2.2.m1.1"><semantics id="S4.T3.4.2.2.2.m1.1a"><mo id="S4.T3.4.2.2.2.m1.1.1" stretchy="false" xref="S4.T3.4.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T3.4.2.2.2.m1.1b"><ci id="S4.T3.4.2.2.2.m1.1.1.cmml" xref="S4.T3.4.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.4.2.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.4.2.2.2.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.5.3.3.3">FPR95<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T3.5.3.3.3.m1.1"><semantics id="S4.T3.5.3.3.3.m1.1a"><mo id="S4.T3.5.3.3.3.m1.1.1" stretchy="false" xref="S4.T3.5.3.3.3.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T3.5.3.3.3.m1.1b"><ci id="S4.T3.5.3.3.3.m1.1.1.cmml" xref="S4.T3.5.3.3.3.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.5.3.3.3.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.5.3.3.3.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.4.4.4">AUROC<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T3.6.4.4.4.m1.1"><semantics id="S4.T3.6.4.4.4.m1.1a"><mo id="S4.T3.6.4.4.4.m1.1.1" stretchy="false" xref="S4.T3.6.4.4.4.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T3.6.4.4.4.m1.1b"><ci id="S4.T3.6.4.4.4.m1.1.1.cmml" xref="S4.T3.6.4.4.4.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.6.4.4.4.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.6.4.4.4.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.7.5.5.5">FPR95<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T3.7.5.5.5.m1.1"><semantics id="S4.T3.7.5.5.5.m1.1a"><mo id="S4.T3.7.5.5.5.m1.1.1" stretchy="false" xref="S4.T3.7.5.5.5.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T3.7.5.5.5.m1.1b"><ci id="S4.T3.7.5.5.5.m1.1.1.cmml" xref="S4.T3.7.5.5.5.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.7.5.5.5.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.7.5.5.5.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.8.6.6.6">AUROC<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T3.8.6.6.6.m1.1"><semantics id="S4.T3.8.6.6.6.m1.1a"><mo id="S4.T3.8.6.6.6.m1.1.1" stretchy="false" xref="S4.T3.8.6.6.6.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T3.8.6.6.6.m1.1b"><ci id="S4.T3.8.6.6.6.m1.1.1.cmml" xref="S4.T3.8.6.6.6.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.8.6.6.6.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.8.6.6.6.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.9.7.7.7">FPR95<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T3.9.7.7.7.m1.1"><semantics id="S4.T3.9.7.7.7.m1.1a"><mo id="S4.T3.9.7.7.7.m1.1.1" stretchy="false" xref="S4.T3.9.7.7.7.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T3.9.7.7.7.m1.1b"><ci id="S4.T3.9.7.7.7.m1.1.1.cmml" xref="S4.T3.9.7.7.7.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.9.7.7.7.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.9.7.7.7.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.10.8.8.8">AUROC<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T3.10.8.8.8.m1.1"><semantics id="S4.T3.10.8.8.8.m1.1a"><mo id="S4.T3.10.8.8.8.m1.1.1" stretchy="false" xref="S4.T3.10.8.8.8.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T3.10.8.8.8.m1.1b"><ci id="S4.T3.10.8.8.8.m1.1.1.cmml" xref="S4.T3.10.8.8.8.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.10.8.8.8.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.10.8.8.8.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.11.9.9.9">FPR95<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T3.11.9.9.9.m1.1"><semantics id="S4.T3.11.9.9.9.m1.1a"><mo id="S4.T3.11.9.9.9.m1.1.1" stretchy="false" xref="S4.T3.11.9.9.9.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T3.11.9.9.9.m1.1b"><ci id="S4.T3.11.9.9.9.m1.1.1.cmml" xref="S4.T3.11.9.9.9.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.11.9.9.9.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.11.9.9.9.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.12.10.10.10">AUROC<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T3.12.10.10.10.m1.1"><semantics id="S4.T3.12.10.10.10.m1.1a"><mo id="S4.T3.12.10.10.10.m1.1.1" stretchy="false" xref="S4.T3.12.10.10.10.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T3.12.10.10.10.m1.1b"><ci id="S4.T3.12.10.10.10.m1.1.1.cmml" xref="S4.T3.12.10.10.10.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.12.10.10.10.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.12.10.10.10.m1.1d">↑</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T3.12.10.12">
<td class="ltx_td ltx_align_left" id="S4.T3.12.10.12.1">
<span class="ltx_rule" style="width:0.0pt;height:8.6pt;background:black;display:inline-block;"></span>LAFO w/ReLU</td>
<td class="ltx_td ltx_align_center" id="S4.T3.12.10.12.2">12.27</td>
<td class="ltx_td ltx_align_center" id="S4.T3.12.10.12.3">97.42</td>
<td class="ltx_td ltx_align_center" id="S4.T3.12.10.12.4">31.80</td>
<td class="ltx_td ltx_align_center" id="S4.T3.12.10.12.5">92.85</td>
<td class="ltx_td ltx_align_center" id="S4.T3.12.10.12.6">40.71</td>
<td class="ltx_td ltx_align_center" id="S4.T3.12.10.12.7">90.10</td>
<td class="ltx_td ltx_align_center" id="S4.T3.12.10.12.8">15.39</td>
<td class="ltx_td ltx_align_center" id="S4.T3.12.10.12.9">96.68</td>
<td class="ltx_td ltx_align_center" id="S4.T3.12.10.12.10">25.04</td>
<td class="ltx_td ltx_align_center" id="S4.T3.12.10.12.11">94.26</td>
</tr>
<tr class="ltx_tr" id="S4.T3.12.10.13">
<td class="ltx_td ltx_align_left" id="S4.T3.12.10.13.1">LAFO w/ASH</td>
<td class="ltx_td ltx_align_center" id="S4.T3.12.10.13.2">11.08</td>
<td class="ltx_td ltx_align_center" id="S4.T3.12.10.13.3">97.68</td>
<td class="ltx_td ltx_align_center" id="S4.T3.12.10.13.4">27.81</td>
<td class="ltx_td ltx_align_center" id="S4.T3.12.10.13.5">93.59</td>
<td class="ltx_td ltx_align_center" id="S4.T3.12.10.13.6">36.53</td>
<td class="ltx_td ltx_align_center" id="S4.T3.12.10.13.7">91.36</td>
<td class="ltx_td ltx_align_center" id="S4.T3.12.10.13.8">18.48</td>
<td class="ltx_td ltx_align_center" id="S4.T3.12.10.13.9">96.70</td>
<td class="ltx_td ltx_align_center" id="S4.T3.12.10.13.10">23.47</td>
<td class="ltx_td ltx_align_center" id="S4.T3.12.10.13.11">94.58</td>
</tr>
<tr class="ltx_tr" id="S4.T3.12.10.14">
<td class="ltx_td ltx_align_left" id="S4.T3.12.10.14.1">LAFO w/Scale</td>
<td class="ltx_td ltx_align_center" id="S4.T3.12.10.14.2">14.65</td>
<td class="ltx_td ltx_align_center" id="S4.T3.12.10.14.3">97.05</td>
<td class="ltx_td ltx_align_center" id="S4.T3.12.10.14.4">25.43</td>
<td class="ltx_td ltx_align_center" id="S4.T3.12.10.14.5">94.02</td>
<td class="ltx_td ltx_align_center" id="S4.T3.12.10.14.6">36.21</td>
<td class="ltx_td ltx_align_center" id="S4.T3.12.10.14.7">90.78</td>
<td class="ltx_td ltx_align_center" id="S4.T3.12.10.14.8">17.07</td>
<td class="ltx_td ltx_align_center" id="S4.T3.12.10.14.9">95.65</td>
<td class="ltx_td ltx_align_center" id="S4.T3.12.10.14.10">23.34</td>
<td class="ltx_td ltx_align_center" id="S4.T3.12.10.14.11">94.37</td>
</tr>
<tr class="ltx_tr" id="S4.T3.12.10.15">
<td class="ltx_td ltx_align_left ltx_border_b" id="S4.T3.12.10.15.1">LAFO w/ReAct</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.12.10.15.2">11.13</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.12.10.15.3">97.79</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.12.10.15.4">22.34</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.12.10.15.5">94.95</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.12.10.15.6">33.33</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.12.10.15.7">91.81</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.12.10.15.8">14.65</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.12.10.15.9">96.60</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.12.10.15.10"><span class="ltx_text ltx_font_bold" id="S4.T3.12.10.15.10.1">20.36</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.12.10.15.11"><span class="ltx_text ltx_font_bold" id="S4.T3.12.10.15.11.1">96.29</span></td>
</tr>
</tbody></table>
</span></div>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>LAFO with activation shaping algorithms</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.2">Recent methods ReAct &nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib38" title="">38</a>]</cite>, ASH &nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib8" title="">8</a>]</cite> and Scale &nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib47" title="">47</a>]</cite> show their success to modify the feature representations to reduce model’s overconfident predictions. All three methods adopt a hyperparameter percentile to choose how to truncate and scale the feature representations using ID data statistics. When combined with Energy &nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib26" title="">26</a>]</cite> score, these methods improve the OOD Detection performance. On Table <a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#S4.T3" title="Table 3 ‣ 4.2 Model Ensembling with LAFO ‣ 4 Experiments ‣ Look Around and Find Out: OOD Detection with Relative Angles"><span class="ltx_text ltx_ref_tag">3</span></a> we show that applying LAFO scoring after activation shaping algorithms improves the performance. Specifically combining LAFO with ReAct reduces FPR95 from <math alttext="25.04\%" class="ltx_Math" display="inline" id="S4.SS3.p1.1.m1.1"><semantics id="S4.SS3.p1.1.m1.1a"><mrow id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml"><mn id="S4.SS3.p1.1.m1.1.1.2" xref="S4.SS3.p1.1.m1.1.1.2.cmml">25.04</mn><mo id="S4.SS3.p1.1.m1.1.1.1" xref="S4.SS3.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><apply id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1"><csymbol cd="latexml" id="S4.SS3.p1.1.m1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1.1">percent</csymbol><cn id="S4.SS3.p1.1.m1.1.1.2.cmml" type="float" xref="S4.SS3.p1.1.m1.1.1.2">25.04</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">25.04\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.1.m1.1d">25.04 %</annotation></semantics></math> to <math alttext="20.36\%" class="ltx_Math" display="inline" id="S4.SS3.p1.2.m2.1"><semantics id="S4.SS3.p1.2.m2.1a"><mrow id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml"><mn id="S4.SS3.p1.2.m2.1.1.2" xref="S4.SS3.p1.2.m2.1.1.2.cmml">20.36</mn><mo id="S4.SS3.p1.2.m2.1.1.1" xref="S4.SS3.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><apply id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1"><csymbol cd="latexml" id="S4.SS3.p1.2.m2.1.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1.1">percent</csymbol><cn id="S4.SS3.p1.2.m2.1.1.2.cmml" type="float" xref="S4.SS3.p1.2.m2.1.1.2">20.36</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">20.36\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.2.m2.1d">20.36 %</annotation></semantics></math> highlighting both the flexibility and efficacy of our method. This demonstrates that LAFO can flexibly be combined with activation shaping algorithms.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Ablation Studies</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.6">In this section, we will demonstrate the effectiveness of design choices on our score function LAFO. We first justify our choice of centering in <math alttext="\bm{\mu}_{\text{ID}}" class="ltx_Math" display="inline" id="S4.SS4.p1.1.m1.1"><semantics id="S4.SS4.p1.1.m1.1a"><msub id="S4.SS4.p1.1.m1.1.1" xref="S4.SS4.p1.1.m1.1.1.cmml"><mi id="S4.SS4.p1.1.m1.1.1.2" xref="S4.SS4.p1.1.m1.1.1.2.cmml">𝝁</mi><mtext id="S4.SS4.p1.1.m1.1.1.3" xref="S4.SS4.p1.1.m1.1.1.3a.cmml">ID</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.m1.1b"><apply id="S4.SS4.p1.1.m1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.1.m1.1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS4.p1.1.m1.1.1.2.cmml" xref="S4.SS4.p1.1.m1.1.1.2">𝝁</ci><ci id="S4.SS4.p1.1.m1.1.1.3a.cmml" xref="S4.SS4.p1.1.m1.1.1.3"><mtext id="S4.SS4.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="S4.SS4.p1.1.m1.1.1.3">ID</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.m1.1c">\bm{\mu}_{\text{ID}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.1.m1.1d">bold_italic_μ start_POSTSUBSCRIPT ID end_POSTSUBSCRIPT</annotation></semantics></math> empirically, among the candidates: <math alttext="\bm{\mu}_{\text{ID}}" class="ltx_Math" display="inline" id="S4.SS4.p1.2.m2.1"><semantics id="S4.SS4.p1.2.m2.1a"><msub id="S4.SS4.p1.2.m2.1.1" xref="S4.SS4.p1.2.m2.1.1.cmml"><mi id="S4.SS4.p1.2.m2.1.1.2" xref="S4.SS4.p1.2.m2.1.1.2.cmml">𝝁</mi><mtext id="S4.SS4.p1.2.m2.1.1.3" xref="S4.SS4.p1.2.m2.1.1.3a.cmml">ID</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.2.m2.1b"><apply id="S4.SS4.p1.2.m2.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.2.m2.1.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS4.p1.2.m2.1.1.2.cmml" xref="S4.SS4.p1.2.m2.1.1.2">𝝁</ci><ci id="S4.SS4.p1.2.m2.1.1.3a.cmml" xref="S4.SS4.p1.2.m2.1.1.3"><mtext id="S4.SS4.p1.2.m2.1.1.3.cmml" mathsize="70%" xref="S4.SS4.p1.2.m2.1.1.3">ID</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.2.m2.1c">\bm{\mu}_{\text{ID}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.2.m2.1d">bold_italic_μ start_POSTSUBSCRIPT ID end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\bm{\mu}_{y_{\text{pred}}}" class="ltx_Math" display="inline" id="S4.SS4.p1.3.m3.1"><semantics id="S4.SS4.p1.3.m3.1a"><msub id="S4.SS4.p1.3.m3.1.1" xref="S4.SS4.p1.3.m3.1.1.cmml"><mi id="S4.SS4.p1.3.m3.1.1.2" xref="S4.SS4.p1.3.m3.1.1.2.cmml">𝝁</mi><msub id="S4.SS4.p1.3.m3.1.1.3" xref="S4.SS4.p1.3.m3.1.1.3.cmml"><mi id="S4.SS4.p1.3.m3.1.1.3.2" xref="S4.SS4.p1.3.m3.1.1.3.2.cmml">y</mi><mtext id="S4.SS4.p1.3.m3.1.1.3.3" xref="S4.SS4.p1.3.m3.1.1.3.3a.cmml">pred</mtext></msub></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.3.m3.1b"><apply id="S4.SS4.p1.3.m3.1.1.cmml" xref="S4.SS4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.3.m3.1.1.1.cmml" xref="S4.SS4.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS4.p1.3.m3.1.1.2.cmml" xref="S4.SS4.p1.3.m3.1.1.2">𝝁</ci><apply id="S4.SS4.p1.3.m3.1.1.3.cmml" xref="S4.SS4.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS4.p1.3.m3.1.1.3.1.cmml" xref="S4.SS4.p1.3.m3.1.1.3">subscript</csymbol><ci id="S4.SS4.p1.3.m3.1.1.3.2.cmml" xref="S4.SS4.p1.3.m3.1.1.3.2">𝑦</ci><ci id="S4.SS4.p1.3.m3.1.1.3.3a.cmml" xref="S4.SS4.p1.3.m3.1.1.3.3"><mtext id="S4.SS4.p1.3.m3.1.1.3.3.cmml" mathsize="50%" xref="S4.SS4.p1.3.m3.1.1.3.3">pred</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.3.m3.1c">\bm{\mu}_{y_{\text{pred}}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.3.m3.1d">bold_italic_μ start_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT pred end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\bm{\mu}_{y_{\text{target}}}" class="ltx_Math" display="inline" id="S4.SS4.p1.4.m4.1"><semantics id="S4.SS4.p1.4.m4.1a"><msub id="S4.SS4.p1.4.m4.1.1" xref="S4.SS4.p1.4.m4.1.1.cmml"><mi id="S4.SS4.p1.4.m4.1.1.2" xref="S4.SS4.p1.4.m4.1.1.2.cmml">𝝁</mi><msub id="S4.SS4.p1.4.m4.1.1.3" xref="S4.SS4.p1.4.m4.1.1.3.cmml"><mi id="S4.SS4.p1.4.m4.1.1.3.2" xref="S4.SS4.p1.4.m4.1.1.3.2.cmml">y</mi><mtext id="S4.SS4.p1.4.m4.1.1.3.3" xref="S4.SS4.p1.4.m4.1.1.3.3a.cmml">target</mtext></msub></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.4.m4.1b"><apply id="S4.SS4.p1.4.m4.1.1.cmml" xref="S4.SS4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.4.m4.1.1.1.cmml" xref="S4.SS4.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS4.p1.4.m4.1.1.2.cmml" xref="S4.SS4.p1.4.m4.1.1.2">𝝁</ci><apply id="S4.SS4.p1.4.m4.1.1.3.cmml" xref="S4.SS4.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS4.p1.4.m4.1.1.3.1.cmml" xref="S4.SS4.p1.4.m4.1.1.3">subscript</csymbol><ci id="S4.SS4.p1.4.m4.1.1.3.2.cmml" xref="S4.SS4.p1.4.m4.1.1.3.2">𝑦</ci><ci id="S4.SS4.p1.4.m4.1.1.3.3a.cmml" xref="S4.SS4.p1.4.m4.1.1.3.3"><mtext id="S4.SS4.p1.4.m4.1.1.3.3.cmml" mathsize="50%" xref="S4.SS4.p1.4.m4.1.1.3.3">target</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.4.m4.1c">\bm{\mu}_{y_{\text{target}}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.4.m4.1d">bold_italic_μ start_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT target end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\max{(\mathbf{z}_{\text{ID}}})" class="ltx_Math" display="inline" id="S4.SS4.p1.5.m5.2"><semantics id="S4.SS4.p1.5.m5.2a"><mrow id="S4.SS4.p1.5.m5.2.2.1" xref="S4.SS4.p1.5.m5.2.2.2.cmml"><mi id="S4.SS4.p1.5.m5.1.1" xref="S4.SS4.p1.5.m5.1.1.cmml">max</mi><mo id="S4.SS4.p1.5.m5.2.2.1a" xref="S4.SS4.p1.5.m5.2.2.2.cmml">⁡</mo><mrow id="S4.SS4.p1.5.m5.2.2.1.1" xref="S4.SS4.p1.5.m5.2.2.2.cmml"><mo id="S4.SS4.p1.5.m5.2.2.1.1.2" stretchy="false" xref="S4.SS4.p1.5.m5.2.2.2.cmml">(</mo><msub id="S4.SS4.p1.5.m5.2.2.1.1.1" xref="S4.SS4.p1.5.m5.2.2.1.1.1.cmml"><mi id="S4.SS4.p1.5.m5.2.2.1.1.1.2" xref="S4.SS4.p1.5.m5.2.2.1.1.1.2.cmml">𝐳</mi><mtext id="S4.SS4.p1.5.m5.2.2.1.1.1.3" xref="S4.SS4.p1.5.m5.2.2.1.1.1.3a.cmml">ID</mtext></msub><mo id="S4.SS4.p1.5.m5.2.2.1.1.3" stretchy="false" xref="S4.SS4.p1.5.m5.2.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.5.m5.2b"><apply id="S4.SS4.p1.5.m5.2.2.2.cmml" xref="S4.SS4.p1.5.m5.2.2.1"><max id="S4.SS4.p1.5.m5.1.1.cmml" xref="S4.SS4.p1.5.m5.1.1"></max><apply id="S4.SS4.p1.5.m5.2.2.1.1.1.cmml" xref="S4.SS4.p1.5.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.5.m5.2.2.1.1.1.1.cmml" xref="S4.SS4.p1.5.m5.2.2.1.1.1">subscript</csymbol><ci id="S4.SS4.p1.5.m5.2.2.1.1.1.2.cmml" xref="S4.SS4.p1.5.m5.2.2.1.1.1.2">𝐳</ci><ci id="S4.SS4.p1.5.m5.2.2.1.1.1.3a.cmml" xref="S4.SS4.p1.5.m5.2.2.1.1.1.3"><mtext id="S4.SS4.p1.5.m5.2.2.1.1.1.3.cmml" mathsize="70%" xref="S4.SS4.p1.5.m5.2.2.1.1.1.3">ID</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.5.m5.2c">\max{(\mathbf{z}_{\text{ID}}})</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.5.m5.2d">roman_max ( bold_z start_POSTSUBSCRIPT ID end_POSTSUBSCRIPT )</annotation></semantics></math>. Then, we compare different angle aggregation techniques across classes by replacing our <math alttext="\max{\left({\{\theta{y,y^{\prime}}\}_{y^{\prime}\in\mathcal{Y},y^{\prime}\neq y%
}}\right)}" class="ltx_Math" display="inline" id="S4.SS4.p1.6.m6.4"><semantics id="S4.SS4.p1.6.m6.4a"><mrow id="S4.SS4.p1.6.m6.4.4.1" xref="S4.SS4.p1.6.m6.4.4.2.cmml"><mi id="S4.SS4.p1.6.m6.3.3" xref="S4.SS4.p1.6.m6.3.3.cmml">max</mi><mo id="S4.SS4.p1.6.m6.4.4.1a" xref="S4.SS4.p1.6.m6.4.4.2.cmml">⁡</mo><mrow id="S4.SS4.p1.6.m6.4.4.1.1" xref="S4.SS4.p1.6.m6.4.4.2.cmml"><mo id="S4.SS4.p1.6.m6.4.4.1.1.2" xref="S4.SS4.p1.6.m6.4.4.2.cmml">(</mo><msub id="S4.SS4.p1.6.m6.4.4.1.1.1" xref="S4.SS4.p1.6.m6.4.4.1.1.1.cmml"><mrow id="S4.SS4.p1.6.m6.4.4.1.1.1.2.2" xref="S4.SS4.p1.6.m6.4.4.1.1.1.2.3.cmml"><mo id="S4.SS4.p1.6.m6.4.4.1.1.1.2.2.3" stretchy="false" xref="S4.SS4.p1.6.m6.4.4.1.1.1.2.3.cmml">{</mo><mrow id="S4.SS4.p1.6.m6.4.4.1.1.1.1.1.1" xref="S4.SS4.p1.6.m6.4.4.1.1.1.1.1.1.cmml"><mi id="S4.SS4.p1.6.m6.4.4.1.1.1.1.1.1.2" xref="S4.SS4.p1.6.m6.4.4.1.1.1.1.1.1.2.cmml">θ</mi><mo id="S4.SS4.p1.6.m6.4.4.1.1.1.1.1.1.1" xref="S4.SS4.p1.6.m6.4.4.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.SS4.p1.6.m6.4.4.1.1.1.1.1.1.3" xref="S4.SS4.p1.6.m6.4.4.1.1.1.1.1.1.3.cmml">y</mi></mrow><mo id="S4.SS4.p1.6.m6.4.4.1.1.1.2.2.4" xref="S4.SS4.p1.6.m6.4.4.1.1.1.2.3.cmml">,</mo><msup id="S4.SS4.p1.6.m6.4.4.1.1.1.2.2.2" xref="S4.SS4.p1.6.m6.4.4.1.1.1.2.2.2.cmml"><mi id="S4.SS4.p1.6.m6.4.4.1.1.1.2.2.2.2" xref="S4.SS4.p1.6.m6.4.4.1.1.1.2.2.2.2.cmml">y</mi><mo id="S4.SS4.p1.6.m6.4.4.1.1.1.2.2.2.3" xref="S4.SS4.p1.6.m6.4.4.1.1.1.2.2.2.3.cmml">′</mo></msup><mo id="S4.SS4.p1.6.m6.4.4.1.1.1.2.2.5" stretchy="false" xref="S4.SS4.p1.6.m6.4.4.1.1.1.2.3.cmml">}</mo></mrow><mrow id="S4.SS4.p1.6.m6.2.2.2.2" xref="S4.SS4.p1.6.m6.2.2.2.3.cmml"><mrow id="S4.SS4.p1.6.m6.1.1.1.1.1" xref="S4.SS4.p1.6.m6.1.1.1.1.1.cmml"><msup id="S4.SS4.p1.6.m6.1.1.1.1.1.2" xref="S4.SS4.p1.6.m6.1.1.1.1.1.2.cmml"><mi id="S4.SS4.p1.6.m6.1.1.1.1.1.2.2" xref="S4.SS4.p1.6.m6.1.1.1.1.1.2.2.cmml">y</mi><mo id="S4.SS4.p1.6.m6.1.1.1.1.1.2.3" xref="S4.SS4.p1.6.m6.1.1.1.1.1.2.3.cmml">′</mo></msup><mo id="S4.SS4.p1.6.m6.1.1.1.1.1.1" xref="S4.SS4.p1.6.m6.1.1.1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p1.6.m6.1.1.1.1.1.3" xref="S4.SS4.p1.6.m6.1.1.1.1.1.3.cmml">𝒴</mi></mrow><mo id="S4.SS4.p1.6.m6.2.2.2.2.3" xref="S4.SS4.p1.6.m6.2.2.2.3a.cmml">,</mo><mrow id="S4.SS4.p1.6.m6.2.2.2.2.2" xref="S4.SS4.p1.6.m6.2.2.2.2.2.cmml"><msup id="S4.SS4.p1.6.m6.2.2.2.2.2.2" xref="S4.SS4.p1.6.m6.2.2.2.2.2.2.cmml"><mi id="S4.SS4.p1.6.m6.2.2.2.2.2.2.2" xref="S4.SS4.p1.6.m6.2.2.2.2.2.2.2.cmml">y</mi><mo id="S4.SS4.p1.6.m6.2.2.2.2.2.2.3" xref="S4.SS4.p1.6.m6.2.2.2.2.2.2.3.cmml">′</mo></msup><mo id="S4.SS4.p1.6.m6.2.2.2.2.2.1" xref="S4.SS4.p1.6.m6.2.2.2.2.2.1.cmml">≠</mo><mi id="S4.SS4.p1.6.m6.2.2.2.2.2.3" xref="S4.SS4.p1.6.m6.2.2.2.2.2.3.cmml">y</mi></mrow></mrow></msub><mo id="S4.SS4.p1.6.m6.4.4.1.1.3" xref="S4.SS4.p1.6.m6.4.4.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.6.m6.4b"><apply id="S4.SS4.p1.6.m6.4.4.2.cmml" xref="S4.SS4.p1.6.m6.4.4.1"><max id="S4.SS4.p1.6.m6.3.3.cmml" xref="S4.SS4.p1.6.m6.3.3"></max><apply id="S4.SS4.p1.6.m6.4.4.1.1.1.cmml" xref="S4.SS4.p1.6.m6.4.4.1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.6.m6.4.4.1.1.1.3.cmml" xref="S4.SS4.p1.6.m6.4.4.1.1.1">subscript</csymbol><set id="S4.SS4.p1.6.m6.4.4.1.1.1.2.3.cmml" xref="S4.SS4.p1.6.m6.4.4.1.1.1.2.2"><apply id="S4.SS4.p1.6.m6.4.4.1.1.1.1.1.1.cmml" xref="S4.SS4.p1.6.m6.4.4.1.1.1.1.1.1"><times id="S4.SS4.p1.6.m6.4.4.1.1.1.1.1.1.1.cmml" xref="S4.SS4.p1.6.m6.4.4.1.1.1.1.1.1.1"></times><ci id="S4.SS4.p1.6.m6.4.4.1.1.1.1.1.1.2.cmml" xref="S4.SS4.p1.6.m6.4.4.1.1.1.1.1.1.2">𝜃</ci><ci id="S4.SS4.p1.6.m6.4.4.1.1.1.1.1.1.3.cmml" xref="S4.SS4.p1.6.m6.4.4.1.1.1.1.1.1.3">𝑦</ci></apply><apply id="S4.SS4.p1.6.m6.4.4.1.1.1.2.2.2.cmml" xref="S4.SS4.p1.6.m6.4.4.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.SS4.p1.6.m6.4.4.1.1.1.2.2.2.1.cmml" xref="S4.SS4.p1.6.m6.4.4.1.1.1.2.2.2">superscript</csymbol><ci id="S4.SS4.p1.6.m6.4.4.1.1.1.2.2.2.2.cmml" xref="S4.SS4.p1.6.m6.4.4.1.1.1.2.2.2.2">𝑦</ci><ci id="S4.SS4.p1.6.m6.4.4.1.1.1.2.2.2.3.cmml" xref="S4.SS4.p1.6.m6.4.4.1.1.1.2.2.2.3">′</ci></apply></set><apply id="S4.SS4.p1.6.m6.2.2.2.3.cmml" xref="S4.SS4.p1.6.m6.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS4.p1.6.m6.2.2.2.3a.cmml" xref="S4.SS4.p1.6.m6.2.2.2.2.3">formulae-sequence</csymbol><apply id="S4.SS4.p1.6.m6.1.1.1.1.1.cmml" xref="S4.SS4.p1.6.m6.1.1.1.1.1"><in id="S4.SS4.p1.6.m6.1.1.1.1.1.1.cmml" xref="S4.SS4.p1.6.m6.1.1.1.1.1.1"></in><apply id="S4.SS4.p1.6.m6.1.1.1.1.1.2.cmml" xref="S4.SS4.p1.6.m6.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS4.p1.6.m6.1.1.1.1.1.2.1.cmml" xref="S4.SS4.p1.6.m6.1.1.1.1.1.2">superscript</csymbol><ci id="S4.SS4.p1.6.m6.1.1.1.1.1.2.2.cmml" xref="S4.SS4.p1.6.m6.1.1.1.1.1.2.2">𝑦</ci><ci id="S4.SS4.p1.6.m6.1.1.1.1.1.2.3.cmml" xref="S4.SS4.p1.6.m6.1.1.1.1.1.2.3">′</ci></apply><ci id="S4.SS4.p1.6.m6.1.1.1.1.1.3.cmml" xref="S4.SS4.p1.6.m6.1.1.1.1.1.3">𝒴</ci></apply><apply id="S4.SS4.p1.6.m6.2.2.2.2.2.cmml" xref="S4.SS4.p1.6.m6.2.2.2.2.2"><neq id="S4.SS4.p1.6.m6.2.2.2.2.2.1.cmml" xref="S4.SS4.p1.6.m6.2.2.2.2.2.1"></neq><apply id="S4.SS4.p1.6.m6.2.2.2.2.2.2.cmml" xref="S4.SS4.p1.6.m6.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS4.p1.6.m6.2.2.2.2.2.2.1.cmml" xref="S4.SS4.p1.6.m6.2.2.2.2.2.2">superscript</csymbol><ci id="S4.SS4.p1.6.m6.2.2.2.2.2.2.2.cmml" xref="S4.SS4.p1.6.m6.2.2.2.2.2.2.2">𝑦</ci><ci id="S4.SS4.p1.6.m6.2.2.2.2.2.2.3.cmml" xref="S4.SS4.p1.6.m6.2.2.2.2.2.2.3">′</ci></apply><ci id="S4.SS4.p1.6.m6.2.2.2.2.2.3.cmml" xref="S4.SS4.p1.6.m6.2.2.2.2.2.3">𝑦</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.6.m6.4c">\max{\left({\{\theta{y,y^{\prime}}\}_{y^{\prime}\in\mathcal{Y},y^{\prime}\neq y%
}}\right)}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.6.m6.4d">roman_max ( { italic_θ italic_y , italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∈ caligraphic_Y , italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ≠ italic_y end_POSTSUBSCRIPT )</annotation></semantics></math> with mean and min across classes.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S4.T5">
<div class="ltx_flex_figure ltx_flex_table">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_top" id="S4.T5.8" style="width:208.1pt;">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.T5.8.9.1.1" style="font-size:90%;">Table 4</span>: </span><span class="ltx_text" id="S4.T5.8.10.2" style="font-size:90%;">Ablation on the different origin perspectives for centering. Evaluated under both ImageNet and CIFAR-10 OOD benchmarks.</span></figcaption>
<p class="ltx_p ltx_align_center" id="S4.T5.8.8">
<span class="ltx_inline-block ltx_transformed_outer" id="S4.T5.8.8.8" style="width:306.9pt;height:108pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span class="ltx_p" id="S4.T5.8.8.8.8"><span class="ltx_text" id="S4.T5.8.8.8.8.8">
<span class="ltx_tabular ltx_align_middle" id="S4.T5.8.8.8.8.8.8">
<span class="ltx_tr" id="S4.T5.8.8.8.8.8.8.9">
<span class="ltx_td ltx_align_left ltx_border_tt ltx_rowspan ltx_rowspan_2" id="S4.T5.8.8.8.8.8.8.9.1"><span class="ltx_text ltx_font_bold" id="S4.T5.8.8.8.8.8.8.9.1.1">Method</span></span>
<span class="ltx_td ltx_align_center ltx_border_tt ltx_colspan ltx_colspan_2" id="S4.T5.8.8.8.8.8.8.9.2"><span class="ltx_text ltx_font_bold" id="S4.T5.8.8.8.8.8.8.9.2.1">CIFAR-10</span></span>
<span class="ltx_td ltx_align_center ltx_border_tt ltx_colspan ltx_colspan_2" id="S4.T5.8.8.8.8.8.8.9.3"><span class="ltx_text ltx_font_bold" id="S4.T5.8.8.8.8.8.8.9.3.1">ImageNet</span></span></span>
<span class="ltx_tr" id="S4.T5.4.4.4.4.4.4.4">
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.1.1.1.1.1.1.1">FPR95<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T5.1.1.1.1.1.1.1.1.m1.1"><semantics id="S4.T5.1.1.1.1.1.1.1.1.m1.1a"><mo id="S4.T5.1.1.1.1.1.1.1.1.m1.1.1" stretchy="false" xref="S4.T5.1.1.1.1.1.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T5.1.1.1.1.1.1.1.1.m1.1b"><ci id="S4.T5.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S4.T5.1.1.1.1.1.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.1.1.1.1.1.1.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T5.1.1.1.1.1.1.1.1.m1.1d">↓</annotation></semantics></math></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.2.2.2.2.2.2.2.2">AUROC<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T5.2.2.2.2.2.2.2.2.m1.1"><semantics id="S4.T5.2.2.2.2.2.2.2.2.m1.1a"><mo id="S4.T5.2.2.2.2.2.2.2.2.m1.1.1" stretchy="false" xref="S4.T5.2.2.2.2.2.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T5.2.2.2.2.2.2.2.2.m1.1b"><ci id="S4.T5.2.2.2.2.2.2.2.2.m1.1.1.cmml" xref="S4.T5.2.2.2.2.2.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.2.2.2.2.2.2.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T5.2.2.2.2.2.2.2.2.m1.1d">↑</annotation></semantics></math></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.3.3.3.3.3.3.3.3">FPR95<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T5.3.3.3.3.3.3.3.3.m1.1"><semantics id="S4.T5.3.3.3.3.3.3.3.3.m1.1a"><mo id="S4.T5.3.3.3.3.3.3.3.3.m1.1.1" stretchy="false" xref="S4.T5.3.3.3.3.3.3.3.3.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T5.3.3.3.3.3.3.3.3.m1.1b"><ci id="S4.T5.3.3.3.3.3.3.3.3.m1.1.1.cmml" xref="S4.T5.3.3.3.3.3.3.3.3.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.3.3.3.3.3.3.3.3.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T5.3.3.3.3.3.3.3.3.m1.1d">↓</annotation></semantics></math></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.4.4.4.4.4.4.4.4">AUROC<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T5.4.4.4.4.4.4.4.4.m1.1"><semantics id="S4.T5.4.4.4.4.4.4.4.4.m1.1a"><mo id="S4.T5.4.4.4.4.4.4.4.4.m1.1.1" stretchy="false" xref="S4.T5.4.4.4.4.4.4.4.4.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T5.4.4.4.4.4.4.4.4.m1.1b"><ci id="S4.T5.4.4.4.4.4.4.4.4.m1.1.1.cmml" xref="S4.T5.4.4.4.4.4.4.4.4.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.4.4.4.4.4.4.4.4.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T5.4.4.4.4.4.4.4.4.m1.1d">↑</annotation></semantics></math></span></span>
<span class="ltx_tr" id="S4.T5.5.5.5.5.5.5.5">
<span class="ltx_td ltx_align_left" id="S4.T5.5.5.5.5.5.5.5.1"><span class="ltx_rule" style="width:0.0pt;height:8.6pt;background:black;display:inline-block;"></span>LAFO w/ <math alttext="\mu_{y_{\text{pred}}}" class="ltx_Math" display="inline" id="S4.T5.5.5.5.5.5.5.5.1.m1.1"><semantics id="S4.T5.5.5.5.5.5.5.5.1.m1.1a"><msub id="S4.T5.5.5.5.5.5.5.5.1.m1.1.1" xref="S4.T5.5.5.5.5.5.5.5.1.m1.1.1.cmml"><mi id="S4.T5.5.5.5.5.5.5.5.1.m1.1.1.2" xref="S4.T5.5.5.5.5.5.5.5.1.m1.1.1.2.cmml">μ</mi><msub id="S4.T5.5.5.5.5.5.5.5.1.m1.1.1.3" xref="S4.T5.5.5.5.5.5.5.5.1.m1.1.1.3.cmml"><mi id="S4.T5.5.5.5.5.5.5.5.1.m1.1.1.3.2" xref="S4.T5.5.5.5.5.5.5.5.1.m1.1.1.3.2.cmml">y</mi><mtext id="S4.T5.5.5.5.5.5.5.5.1.m1.1.1.3.3" xref="S4.T5.5.5.5.5.5.5.5.1.m1.1.1.3.3a.cmml">pred</mtext></msub></msub><annotation-xml encoding="MathML-Content" id="S4.T5.5.5.5.5.5.5.5.1.m1.1b"><apply id="S4.T5.5.5.5.5.5.5.5.1.m1.1.1.cmml" xref="S4.T5.5.5.5.5.5.5.5.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T5.5.5.5.5.5.5.5.1.m1.1.1.1.cmml" xref="S4.T5.5.5.5.5.5.5.5.1.m1.1.1">subscript</csymbol><ci id="S4.T5.5.5.5.5.5.5.5.1.m1.1.1.2.cmml" xref="S4.T5.5.5.5.5.5.5.5.1.m1.1.1.2">𝜇</ci><apply id="S4.T5.5.5.5.5.5.5.5.1.m1.1.1.3.cmml" xref="S4.T5.5.5.5.5.5.5.5.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T5.5.5.5.5.5.5.5.1.m1.1.1.3.1.cmml" xref="S4.T5.5.5.5.5.5.5.5.1.m1.1.1.3">subscript</csymbol><ci id="S4.T5.5.5.5.5.5.5.5.1.m1.1.1.3.2.cmml" xref="S4.T5.5.5.5.5.5.5.5.1.m1.1.1.3.2">𝑦</ci><ci id="S4.T5.5.5.5.5.5.5.5.1.m1.1.1.3.3a.cmml" xref="S4.T5.5.5.5.5.5.5.5.1.m1.1.1.3.3"><mtext id="S4.T5.5.5.5.5.5.5.5.1.m1.1.1.3.3.cmml" mathsize="50%" xref="S4.T5.5.5.5.5.5.5.5.1.m1.1.1.3.3">pred</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.5.5.5.5.5.5.5.1.m1.1c">\mu_{y_{\text{pred}}}</annotation><annotation encoding="application/x-llamapun" id="S4.T5.5.5.5.5.5.5.5.1.m1.1d">italic_μ start_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT pred end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math></span>
<span class="ltx_td ltx_align_center" id="S4.T5.5.5.5.5.5.5.5.2">12.42</span>
<span class="ltx_td ltx_align_center" id="S4.T5.5.5.5.5.5.5.5.3">97.59</span>
<span class="ltx_td ltx_align_center" id="S4.T5.5.5.5.5.5.5.5.4">43.02</span>
<span class="ltx_td ltx_align_center" id="S4.T5.5.5.5.5.5.5.5.5">89.86</span></span>
<span class="ltx_tr" id="S4.T5.6.6.6.6.6.6.6">
<span class="ltx_td ltx_align_left" id="S4.T5.6.6.6.6.6.6.6.1">LAFO w/<math alttext="\mu_{y_{\text{target}}}" class="ltx_Math" display="inline" id="S4.T5.6.6.6.6.6.6.6.1.m1.1"><semantics id="S4.T5.6.6.6.6.6.6.6.1.m1.1a"><msub id="S4.T5.6.6.6.6.6.6.6.1.m1.1.1" xref="S4.T5.6.6.6.6.6.6.6.1.m1.1.1.cmml"><mi id="S4.T5.6.6.6.6.6.6.6.1.m1.1.1.2" xref="S4.T5.6.6.6.6.6.6.6.1.m1.1.1.2.cmml">μ</mi><msub id="S4.T5.6.6.6.6.6.6.6.1.m1.1.1.3" xref="S4.T5.6.6.6.6.6.6.6.1.m1.1.1.3.cmml"><mi id="S4.T5.6.6.6.6.6.6.6.1.m1.1.1.3.2" xref="S4.T5.6.6.6.6.6.6.6.1.m1.1.1.3.2.cmml">y</mi><mtext id="S4.T5.6.6.6.6.6.6.6.1.m1.1.1.3.3" xref="S4.T5.6.6.6.6.6.6.6.1.m1.1.1.3.3a.cmml">target</mtext></msub></msub><annotation-xml encoding="MathML-Content" id="S4.T5.6.6.6.6.6.6.6.1.m1.1b"><apply id="S4.T5.6.6.6.6.6.6.6.1.m1.1.1.cmml" xref="S4.T5.6.6.6.6.6.6.6.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T5.6.6.6.6.6.6.6.1.m1.1.1.1.cmml" xref="S4.T5.6.6.6.6.6.6.6.1.m1.1.1">subscript</csymbol><ci id="S4.T5.6.6.6.6.6.6.6.1.m1.1.1.2.cmml" xref="S4.T5.6.6.6.6.6.6.6.1.m1.1.1.2">𝜇</ci><apply id="S4.T5.6.6.6.6.6.6.6.1.m1.1.1.3.cmml" xref="S4.T5.6.6.6.6.6.6.6.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T5.6.6.6.6.6.6.6.1.m1.1.1.3.1.cmml" xref="S4.T5.6.6.6.6.6.6.6.1.m1.1.1.3">subscript</csymbol><ci id="S4.T5.6.6.6.6.6.6.6.1.m1.1.1.3.2.cmml" xref="S4.T5.6.6.6.6.6.6.6.1.m1.1.1.3.2">𝑦</ci><ci id="S4.T5.6.6.6.6.6.6.6.1.m1.1.1.3.3a.cmml" xref="S4.T5.6.6.6.6.6.6.6.1.m1.1.1.3.3"><mtext id="S4.T5.6.6.6.6.6.6.6.1.m1.1.1.3.3.cmml" mathsize="50%" xref="S4.T5.6.6.6.6.6.6.6.1.m1.1.1.3.3">target</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.6.6.6.6.6.6.6.1.m1.1c">\mu_{y_{\text{target}}}</annotation><annotation encoding="application/x-llamapun" id="S4.T5.6.6.6.6.6.6.6.1.m1.1d">italic_μ start_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT target end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math></span>
<span class="ltx_td ltx_align_center" id="S4.T5.6.6.6.6.6.6.6.2">13.26</span>
<span class="ltx_td ltx_align_center" id="S4.T5.6.6.6.6.6.6.6.3">97.48</span>
<span class="ltx_td ltx_align_center" id="S4.T5.6.6.6.6.6.6.6.4">28.29</span>
<span class="ltx_td ltx_align_center" id="S4.T5.6.6.6.6.6.6.6.5">93.46</span></span>
<span class="ltx_tr" id="S4.T5.7.7.7.7.7.7.7">
<span class="ltx_td ltx_align_left" id="S4.T5.7.7.7.7.7.7.7.1">LAFO w/ <math alttext="\max{(\mathbf{z_{\text{ID}})}}" class="ltx_Math" display="inline" id="S4.T5.7.7.7.7.7.7.7.1.m1.2"><semantics id="S4.T5.7.7.7.7.7.7.7.1.m1.2a"><mrow id="S4.T5.7.7.7.7.7.7.7.1.m1.2.2.1" xref="S4.T5.7.7.7.7.7.7.7.1.m1.2.2.2.cmml"><mi id="S4.T5.7.7.7.7.7.7.7.1.m1.1.1" xref="S4.T5.7.7.7.7.7.7.7.1.m1.1.1.cmml">max</mi><mo id="S4.T5.7.7.7.7.7.7.7.1.m1.2.2.1a" xref="S4.T5.7.7.7.7.7.7.7.1.m1.2.2.2.cmml">⁡</mo><mrow id="S4.T5.7.7.7.7.7.7.7.1.m1.2.2.1.1" xref="S4.T5.7.7.7.7.7.7.7.1.m1.2.2.2.cmml"><mo id="S4.T5.7.7.7.7.7.7.7.1.m1.2.2.1.1.2" stretchy="false" xref="S4.T5.7.7.7.7.7.7.7.1.m1.2.2.2.cmml">(</mo><msub id="S4.T5.7.7.7.7.7.7.7.1.m1.2.2.1.1.1" xref="S4.T5.7.7.7.7.7.7.7.1.m1.2.2.1.1.1.cmml"><mi id="S4.T5.7.7.7.7.7.7.7.1.m1.2.2.1.1.1.2" xref="S4.T5.7.7.7.7.7.7.7.1.m1.2.2.1.1.1.2.cmml">𝐳</mi><mtext id="S4.T5.7.7.7.7.7.7.7.1.m1.2.2.1.1.1.3" xref="S4.T5.7.7.7.7.7.7.7.1.m1.2.2.1.1.1.3a.cmml">ID</mtext></msub><mo id="S4.T5.7.7.7.7.7.7.7.1.m1.2.2.1.1.3" stretchy="false" xref="S4.T5.7.7.7.7.7.7.7.1.m1.2.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T5.7.7.7.7.7.7.7.1.m1.2b"><apply id="S4.T5.7.7.7.7.7.7.7.1.m1.2.2.2.cmml" xref="S4.T5.7.7.7.7.7.7.7.1.m1.2.2.1"><max id="S4.T5.7.7.7.7.7.7.7.1.m1.1.1.cmml" xref="S4.T5.7.7.7.7.7.7.7.1.m1.1.1"></max><apply id="S4.T5.7.7.7.7.7.7.7.1.m1.2.2.1.1.1.cmml" xref="S4.T5.7.7.7.7.7.7.7.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.T5.7.7.7.7.7.7.7.1.m1.2.2.1.1.1.1.cmml" xref="S4.T5.7.7.7.7.7.7.7.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S4.T5.7.7.7.7.7.7.7.1.m1.2.2.1.1.1.2.cmml" xref="S4.T5.7.7.7.7.7.7.7.1.m1.2.2.1.1.1.2">𝐳</ci><ci id="S4.T5.7.7.7.7.7.7.7.1.m1.2.2.1.1.1.3a.cmml" xref="S4.T5.7.7.7.7.7.7.7.1.m1.2.2.1.1.1.3"><mtext id="S4.T5.7.7.7.7.7.7.7.1.m1.2.2.1.1.1.3.cmml" mathsize="70%" xref="S4.T5.7.7.7.7.7.7.7.1.m1.2.2.1.1.1.3">ID</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.7.7.7.7.7.7.7.1.m1.2c">\max{(\mathbf{z_{\text{ID}})}}</annotation><annotation encoding="application/x-llamapun" id="S4.T5.7.7.7.7.7.7.7.1.m1.2d">roman_max ( bold_z start_POSTSUBSCRIPT ID end_POSTSUBSCRIPT )</annotation></semantics></math></span>
<span class="ltx_td ltx_align_center" id="S4.T5.7.7.7.7.7.7.7.2">13.39</span>
<span class="ltx_td ltx_align_center" id="S4.T5.7.7.7.7.7.7.7.3">97.42</span>
<span class="ltx_td ltx_align_center" id="S4.T5.7.7.7.7.7.7.7.4">32.44</span>
<span class="ltx_td ltx_align_center" id="S4.T5.7.7.7.7.7.7.7.5">92.01</span></span>
<span class="ltx_tr" id="S4.T5.8.8.8.8.8.8.8">
<span class="ltx_td ltx_align_left ltx_border_bb" id="S4.T5.8.8.8.8.8.8.8.1">LAFO w/<math alttext="\mu_{\text{ID}}" class="ltx_Math" display="inline" id="S4.T5.8.8.8.8.8.8.8.1.m1.1"><semantics id="S4.T5.8.8.8.8.8.8.8.1.m1.1a"><msub id="S4.T5.8.8.8.8.8.8.8.1.m1.1.1" xref="S4.T5.8.8.8.8.8.8.8.1.m1.1.1.cmml"><mi id="S4.T5.8.8.8.8.8.8.8.1.m1.1.1.2" xref="S4.T5.8.8.8.8.8.8.8.1.m1.1.1.2.cmml">μ</mi><mtext id="S4.T5.8.8.8.8.8.8.8.1.m1.1.1.3" xref="S4.T5.8.8.8.8.8.8.8.1.m1.1.1.3a.cmml">ID</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.T5.8.8.8.8.8.8.8.1.m1.1b"><apply id="S4.T5.8.8.8.8.8.8.8.1.m1.1.1.cmml" xref="S4.T5.8.8.8.8.8.8.8.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T5.8.8.8.8.8.8.8.1.m1.1.1.1.cmml" xref="S4.T5.8.8.8.8.8.8.8.1.m1.1.1">subscript</csymbol><ci id="S4.T5.8.8.8.8.8.8.8.1.m1.1.1.2.cmml" xref="S4.T5.8.8.8.8.8.8.8.1.m1.1.1.2">𝜇</ci><ci id="S4.T5.8.8.8.8.8.8.8.1.m1.1.1.3a.cmml" xref="S4.T5.8.8.8.8.8.8.8.1.m1.1.1.3"><mtext id="S4.T5.8.8.8.8.8.8.8.1.m1.1.1.3.cmml" mathsize="70%" xref="S4.T5.8.8.8.8.8.8.8.1.m1.1.1.3">ID</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.8.8.8.8.8.8.8.1.m1.1c">\mu_{\text{ID}}</annotation><annotation encoding="application/x-llamapun" id="S4.T5.8.8.8.8.8.8.8.1.m1.1d">italic_μ start_POSTSUBSCRIPT ID end_POSTSUBSCRIPT</annotation></semantics></math></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.8.8.8.8.8.8.8.2"><span class="ltx_text ltx_font_bold" id="S4.T5.8.8.8.8.8.8.8.2.1">10.97</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.8.8.8.8.8.8.8.3"><span class="ltx_text ltx_font_bold" id="S4.T5.8.8.8.8.8.8.8.3.1">97.67</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.8.8.8.8.8.8.8.4"><span class="ltx_text ltx_font_bold" id="S4.T5.8.8.8.8.8.8.8.4.1">25.04</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.8.8.8.8.8.8.8.5"><span class="ltx_text ltx_font_bold" id="S4.T5.8.8.8.8.8.8.8.5.1">94.26</span></span></span>
</span></span></span>
</span></span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_top" id="S4.T5.12" style="width:208.1pt;">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.T5.12.5.1.1" style="font-size:90%;">Table 5</span>: </span><span class="ltx_text" id="S4.T5.12.6.2" style="font-size:90%;">Ablation on the different score aggregations across classes. Evaluated under both ImageNet and CIFAR-10 OOD benchmarks.</span></figcaption>
<p class="ltx_p ltx_align_center" id="S4.T5.12.4">
<span class="ltx_inline-block ltx_transformed_outer" id="S4.T5.12.4.4" style="width:286.1pt;height:90pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span class="ltx_p" id="S4.T5.12.4.4.4"><span class="ltx_text" id="S4.T5.12.4.4.4.4">
<span class="ltx_tabular ltx_align_middle" id="S4.T5.12.4.4.4.4.4">
<span class="ltx_tr" id="S4.T5.12.4.4.4.4.4.5">
<span class="ltx_td ltx_align_left ltx_border_tt ltx_rowspan ltx_rowspan_2" id="S4.T5.12.4.4.4.4.4.5.1"><span class="ltx_text ltx_font_bold" id="S4.T5.12.4.4.4.4.4.5.1.1">Method</span></span>
<span class="ltx_td ltx_align_center ltx_border_tt ltx_colspan ltx_colspan_2" id="S4.T5.12.4.4.4.4.4.5.2"><span class="ltx_text ltx_font_bold" id="S4.T5.12.4.4.4.4.4.5.2.1">CIFAR-10</span></span>
<span class="ltx_td ltx_align_center ltx_border_tt ltx_colspan ltx_colspan_2" id="S4.T5.12.4.4.4.4.4.5.3"><span class="ltx_text ltx_font_bold" id="S4.T5.12.4.4.4.4.4.5.3.1">ImageNet</span></span></span>
<span class="ltx_tr" id="S4.T5.12.4.4.4.4.4.4">
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.9.1.1.1.1.1.1.1">FPR95<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T5.9.1.1.1.1.1.1.1.m1.1"><semantics id="S4.T5.9.1.1.1.1.1.1.1.m1.1a"><mo id="S4.T5.9.1.1.1.1.1.1.1.m1.1.1" stretchy="false" xref="S4.T5.9.1.1.1.1.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T5.9.1.1.1.1.1.1.1.m1.1b"><ci id="S4.T5.9.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S4.T5.9.1.1.1.1.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.9.1.1.1.1.1.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T5.9.1.1.1.1.1.1.1.m1.1d">↓</annotation></semantics></math></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.10.2.2.2.2.2.2.2">AUROC<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T5.10.2.2.2.2.2.2.2.m1.1"><semantics id="S4.T5.10.2.2.2.2.2.2.2.m1.1a"><mo id="S4.T5.10.2.2.2.2.2.2.2.m1.1.1" stretchy="false" xref="S4.T5.10.2.2.2.2.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T5.10.2.2.2.2.2.2.2.m1.1b"><ci id="S4.T5.10.2.2.2.2.2.2.2.m1.1.1.cmml" xref="S4.T5.10.2.2.2.2.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.10.2.2.2.2.2.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T5.10.2.2.2.2.2.2.2.m1.1d">↑</annotation></semantics></math></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.11.3.3.3.3.3.3.3">FPR95<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T5.11.3.3.3.3.3.3.3.m1.1"><semantics id="S4.T5.11.3.3.3.3.3.3.3.m1.1a"><mo id="S4.T5.11.3.3.3.3.3.3.3.m1.1.1" stretchy="false" xref="S4.T5.11.3.3.3.3.3.3.3.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T5.11.3.3.3.3.3.3.3.m1.1b"><ci id="S4.T5.11.3.3.3.3.3.3.3.m1.1.1.cmml" xref="S4.T5.11.3.3.3.3.3.3.3.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.11.3.3.3.3.3.3.3.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T5.11.3.3.3.3.3.3.3.m1.1d">↓</annotation></semantics></math></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.12.4.4.4.4.4.4.4">AUROC<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T5.12.4.4.4.4.4.4.4.m1.1"><semantics id="S4.T5.12.4.4.4.4.4.4.4.m1.1a"><mo id="S4.T5.12.4.4.4.4.4.4.4.m1.1.1" stretchy="false" xref="S4.T5.12.4.4.4.4.4.4.4.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T5.12.4.4.4.4.4.4.4.m1.1b"><ci id="S4.T5.12.4.4.4.4.4.4.4.m1.1.1.cmml" xref="S4.T5.12.4.4.4.4.4.4.4.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.12.4.4.4.4.4.4.4.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T5.12.4.4.4.4.4.4.4.m1.1d">↑</annotation></semantics></math></span></span>
<span class="ltx_tr" id="S4.T5.12.4.4.4.4.4.6">
<span class="ltx_td ltx_align_left" id="S4.T5.12.4.4.4.4.4.6.1"><span class="ltx_rule" style="width:0.0pt;height:8.6pt;background:black;display:inline-block;"></span>LAFO w/min</span>
<span class="ltx_td ltx_align_center" id="S4.T5.12.4.4.4.4.4.6.2">32.02</span>
<span class="ltx_td ltx_align_center" id="S4.T5.12.4.4.4.4.4.6.3">95.23</span>
<span class="ltx_td ltx_align_center" id="S4.T5.12.4.4.4.4.4.6.4">79.15</span>
<span class="ltx_td ltx_align_center" id="S4.T5.12.4.4.4.4.4.6.5">81.38</span></span>
<span class="ltx_tr" id="S4.T5.12.4.4.4.4.4.7">
<span class="ltx_td ltx_align_left" id="S4.T5.12.4.4.4.4.4.7.1">LAFO w/mean</span>
<span class="ltx_td ltx_align_center" id="S4.T5.12.4.4.4.4.4.7.2">11.84</span>
<span class="ltx_td ltx_align_center" id="S4.T5.12.4.4.4.4.4.7.3">97.59</span>
<span class="ltx_td ltx_align_center" id="S4.T5.12.4.4.4.4.4.7.4">32.76</span>
<span class="ltx_td ltx_align_center" id="S4.T5.12.4.4.4.4.4.7.5">92.87</span></span>
<span class="ltx_tr" id="S4.T5.12.4.4.4.4.4.8">
<span class="ltx_td ltx_align_left ltx_border_b" id="S4.T5.12.4.4.4.4.4.8.1">LAFO w/max</span>
<span class="ltx_td ltx_align_center ltx_border_b" id="S4.T5.12.4.4.4.4.4.8.2"><span class="ltx_text ltx_font_bold" id="S4.T5.12.4.4.4.4.4.8.2.1">10.97</span></span>
<span class="ltx_td ltx_align_center ltx_border_b" id="S4.T5.12.4.4.4.4.4.8.3"><span class="ltx_text ltx_font_bold" id="S4.T5.12.4.4.4.4.4.8.3.1">97.67</span></span>
<span class="ltx_td ltx_align_center ltx_border_b" id="S4.T5.12.4.4.4.4.4.8.4"><span class="ltx_text ltx_font_bold" id="S4.T5.12.4.4.4.4.4.8.4.1">25.04</span></span>
<span class="ltx_td ltx_align_center ltx_border_b" id="S4.T5.12.4.4.4.4.4.8.5"><span class="ltx_text ltx_font_bold" id="S4.T5.12.4.4.4.4.4.8.5.1">94.26</span></span></span>
</span></span></span>
</span></span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS4.p2">
<p class="ltx_p" id="S4.SS4.p2.8"><span class="ltx_text ltx_font_bold" id="S4.SS4.p2.1.1">Centering with <math alttext="\mu_{\text{ID}}" class="ltx_Math" display="inline" id="S4.SS4.p2.1.1.m1.1"><semantics id="S4.SS4.p2.1.1.m1.1a"><msub id="S4.SS4.p2.1.1.m1.1.1" xref="S4.SS4.p2.1.1.m1.1.1.cmml"><mi id="S4.SS4.p2.1.1.m1.1.1.2" xref="S4.SS4.p2.1.1.m1.1.1.2.cmml">μ</mi><mtext class="ltx_mathvariant_bold" id="S4.SS4.p2.1.1.m1.1.1.3" xref="S4.SS4.p2.1.1.m1.1.1.3a.cmml">ID</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.1.1.m1.1b"><apply id="S4.SS4.p2.1.1.m1.1.1.cmml" xref="S4.SS4.p2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p2.1.1.m1.1.1.1.cmml" xref="S4.SS4.p2.1.1.m1.1.1">subscript</csymbol><ci id="S4.SS4.p2.1.1.m1.1.1.2.cmml" xref="S4.SS4.p2.1.1.m1.1.1.2">𝜇</ci><ci id="S4.SS4.p2.1.1.m1.1.1.3a.cmml" xref="S4.SS4.p2.1.1.m1.1.1.3"><mtext class="ltx_mathvariant_bold" id="S4.SS4.p2.1.1.m1.1.1.3.cmml" mathsize="70%" xref="S4.SS4.p2.1.1.m1.1.1.3">ID</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.1.1.m1.1c">\mu_{\text{ID}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.1.1.m1.1d">italic_μ start_POSTSUBSCRIPT ID end_POSTSUBSCRIPT</annotation></semantics></math> incorporates ID-statistics without biasing towards one particular class.</span> Table <a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#S4.T5" title="Table 5 ‣ 4.4 Ablation Studies ‣ 4 Experiments ‣ Look Around and Find Out: OOD Detection with Relative Angles"><span class="ltx_text ltx_ref_tag">5</span></a> shows the performance comparison between centerings with respect to different points. Using the relative angle with respect to the predicted (<math alttext="\bm{\mu}_{y_{\text{pred}}}" class="ltx_Math" display="inline" id="S4.SS4.p2.2.m1.1"><semantics id="S4.SS4.p2.2.m1.1a"><msub id="S4.SS4.p2.2.m1.1.1" xref="S4.SS4.p2.2.m1.1.1.cmml"><mi id="S4.SS4.p2.2.m1.1.1.2" xref="S4.SS4.p2.2.m1.1.1.2.cmml">𝝁</mi><msub id="S4.SS4.p2.2.m1.1.1.3" xref="S4.SS4.p2.2.m1.1.1.3.cmml"><mi id="S4.SS4.p2.2.m1.1.1.3.2" xref="S4.SS4.p2.2.m1.1.1.3.2.cmml">y</mi><mtext id="S4.SS4.p2.2.m1.1.1.3.3" xref="S4.SS4.p2.2.m1.1.1.3.3a.cmml">pred</mtext></msub></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.2.m1.1b"><apply id="S4.SS4.p2.2.m1.1.1.cmml" xref="S4.SS4.p2.2.m1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p2.2.m1.1.1.1.cmml" xref="S4.SS4.p2.2.m1.1.1">subscript</csymbol><ci id="S4.SS4.p2.2.m1.1.1.2.cmml" xref="S4.SS4.p2.2.m1.1.1.2">𝝁</ci><apply id="S4.SS4.p2.2.m1.1.1.3.cmml" xref="S4.SS4.p2.2.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS4.p2.2.m1.1.1.3.1.cmml" xref="S4.SS4.p2.2.m1.1.1.3">subscript</csymbol><ci id="S4.SS4.p2.2.m1.1.1.3.2.cmml" xref="S4.SS4.p2.2.m1.1.1.3.2">𝑦</ci><ci id="S4.SS4.p2.2.m1.1.1.3.3a.cmml" xref="S4.SS4.p2.2.m1.1.1.3.3"><mtext id="S4.SS4.p2.2.m1.1.1.3.3.cmml" mathsize="50%" xref="S4.SS4.p2.2.m1.1.1.3.3">pred</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.2.m1.1c">\bm{\mu}_{y_{\text{pred}}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.2.m1.1d">bold_italic_μ start_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT pred end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>) or target (<math alttext="\bm{\mu}_{y_{\text{target}}}" class="ltx_Math" display="inline" id="S4.SS4.p2.3.m2.1"><semantics id="S4.SS4.p2.3.m2.1a"><msub id="S4.SS4.p2.3.m2.1.1" xref="S4.SS4.p2.3.m2.1.1.cmml"><mi id="S4.SS4.p2.3.m2.1.1.2" xref="S4.SS4.p2.3.m2.1.1.2.cmml">𝝁</mi><msub id="S4.SS4.p2.3.m2.1.1.3" xref="S4.SS4.p2.3.m2.1.1.3.cmml"><mi id="S4.SS4.p2.3.m2.1.1.3.2" xref="S4.SS4.p2.3.m2.1.1.3.2.cmml">y</mi><mtext id="S4.SS4.p2.3.m2.1.1.3.3" xref="S4.SS4.p2.3.m2.1.1.3.3a.cmml">target</mtext></msub></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.3.m2.1b"><apply id="S4.SS4.p2.3.m2.1.1.cmml" xref="S4.SS4.p2.3.m2.1.1"><csymbol cd="ambiguous" id="S4.SS4.p2.3.m2.1.1.1.cmml" xref="S4.SS4.p2.3.m2.1.1">subscript</csymbol><ci id="S4.SS4.p2.3.m2.1.1.2.cmml" xref="S4.SS4.p2.3.m2.1.1.2">𝝁</ci><apply id="S4.SS4.p2.3.m2.1.1.3.cmml" xref="S4.SS4.p2.3.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS4.p2.3.m2.1.1.3.1.cmml" xref="S4.SS4.p2.3.m2.1.1.3">subscript</csymbol><ci id="S4.SS4.p2.3.m2.1.1.3.2.cmml" xref="S4.SS4.p2.3.m2.1.1.3.2">𝑦</ci><ci id="S4.SS4.p2.3.m2.1.1.3.3a.cmml" xref="S4.SS4.p2.3.m2.1.1.3.3"><mtext id="S4.SS4.p2.3.m2.1.1.3.3.cmml" mathsize="50%" xref="S4.SS4.p2.3.m2.1.1.3.3">target</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.3.m2.1c">\bm{\mu}_{y_{\text{target}}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.3.m2.1d">bold_italic_μ start_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT target end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>) class centroid induce a bias towards the corresponding class, which in the end hinders the compatibility between angles coming across classes. On the other hand, using <math alttext="\max{(\mathbf{z}_{\text{ID}}})" class="ltx_Math" display="inline" id="S4.SS4.p2.4.m3.2"><semantics id="S4.SS4.p2.4.m3.2a"><mrow id="S4.SS4.p2.4.m3.2.2.1" xref="S4.SS4.p2.4.m3.2.2.2.cmml"><mi id="S4.SS4.p2.4.m3.1.1" xref="S4.SS4.p2.4.m3.1.1.cmml">max</mi><mo id="S4.SS4.p2.4.m3.2.2.1a" xref="S4.SS4.p2.4.m3.2.2.2.cmml">⁡</mo><mrow id="S4.SS4.p2.4.m3.2.2.1.1" xref="S4.SS4.p2.4.m3.2.2.2.cmml"><mo id="S4.SS4.p2.4.m3.2.2.1.1.2" stretchy="false" xref="S4.SS4.p2.4.m3.2.2.2.cmml">(</mo><msub id="S4.SS4.p2.4.m3.2.2.1.1.1" xref="S4.SS4.p2.4.m3.2.2.1.1.1.cmml"><mi id="S4.SS4.p2.4.m3.2.2.1.1.1.2" xref="S4.SS4.p2.4.m3.2.2.1.1.1.2.cmml">𝐳</mi><mtext id="S4.SS4.p2.4.m3.2.2.1.1.1.3" xref="S4.SS4.p2.4.m3.2.2.1.1.1.3a.cmml">ID</mtext></msub><mo id="S4.SS4.p2.4.m3.2.2.1.1.3" stretchy="false" xref="S4.SS4.p2.4.m3.2.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.4.m3.2b"><apply id="S4.SS4.p2.4.m3.2.2.2.cmml" xref="S4.SS4.p2.4.m3.2.2.1"><max id="S4.SS4.p2.4.m3.1.1.cmml" xref="S4.SS4.p2.4.m3.1.1"></max><apply id="S4.SS4.p2.4.m3.2.2.1.1.1.cmml" xref="S4.SS4.p2.4.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p2.4.m3.2.2.1.1.1.1.cmml" xref="S4.SS4.p2.4.m3.2.2.1.1.1">subscript</csymbol><ci id="S4.SS4.p2.4.m3.2.2.1.1.1.2.cmml" xref="S4.SS4.p2.4.m3.2.2.1.1.1.2">𝐳</ci><ci id="S4.SS4.p2.4.m3.2.2.1.1.1.3a.cmml" xref="S4.SS4.p2.4.m3.2.2.1.1.1.3"><mtext id="S4.SS4.p2.4.m3.2.2.1.1.1.3.cmml" mathsize="70%" xref="S4.SS4.p2.4.m3.2.2.1.1.1.3">ID</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.4.m3.2c">\max{(\mathbf{z}_{\text{ID}}})</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.4.m3.2d">roman_max ( bold_z start_POSTSUBSCRIPT ID end_POSTSUBSCRIPT )</annotation></semantics></math> shifts every feature representation to the same orthant, reducing to simply computing the absolute distance between feature representations and the decision boundaries, which is agnostic from the in-distribution feature statistics. We observe a significant improvement in performance when computing relative angles using <math alttext="\mu_{\text{ID}}" class="ltx_Math" display="inline" id="S4.SS4.p2.5.m4.1"><semantics id="S4.SS4.p2.5.m4.1a"><msub id="S4.SS4.p2.5.m4.1.1" xref="S4.SS4.p2.5.m4.1.1.cmml"><mi id="S4.SS4.p2.5.m4.1.1.2" xref="S4.SS4.p2.5.m4.1.1.2.cmml">μ</mi><mtext id="S4.SS4.p2.5.m4.1.1.3" xref="S4.SS4.p2.5.m4.1.1.3a.cmml">ID</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.5.m4.1b"><apply id="S4.SS4.p2.5.m4.1.1.cmml" xref="S4.SS4.p2.5.m4.1.1"><csymbol cd="ambiguous" id="S4.SS4.p2.5.m4.1.1.1.cmml" xref="S4.SS4.p2.5.m4.1.1">subscript</csymbol><ci id="S4.SS4.p2.5.m4.1.1.2.cmml" xref="S4.SS4.p2.5.m4.1.1.2">𝜇</ci><ci id="S4.SS4.p2.5.m4.1.1.3a.cmml" xref="S4.SS4.p2.5.m4.1.1.3"><mtext id="S4.SS4.p2.5.m4.1.1.3.cmml" mathsize="70%" xref="S4.SS4.p2.5.m4.1.1.3">ID</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.5.m4.1c">\mu_{\text{ID}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.5.m4.1d">italic_μ start_POSTSUBSCRIPT ID end_POSTSUBSCRIPT</annotation></semantics></math>, demonstrating the importance of incorporating in-distribution (ID) statistics when measuring the relationship between feature representations and decision boundaries. LAFO with <math alttext="\mu_{\text{ID}}" class="ltx_Math" display="inline" id="S4.SS4.p2.6.m5.1"><semantics id="S4.SS4.p2.6.m5.1a"><msub id="S4.SS4.p2.6.m5.1.1" xref="S4.SS4.p2.6.m5.1.1.cmml"><mi id="S4.SS4.p2.6.m5.1.1.2" xref="S4.SS4.p2.6.m5.1.1.2.cmml">μ</mi><mtext id="S4.SS4.p2.6.m5.1.1.3" xref="S4.SS4.p2.6.m5.1.1.3a.cmml">ID</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.6.m5.1b"><apply id="S4.SS4.p2.6.m5.1.1.cmml" xref="S4.SS4.p2.6.m5.1.1"><csymbol cd="ambiguous" id="S4.SS4.p2.6.m5.1.1.1.cmml" xref="S4.SS4.p2.6.m5.1.1">subscript</csymbol><ci id="S4.SS4.p2.6.m5.1.1.2.cmml" xref="S4.SS4.p2.6.m5.1.1.2">𝜇</ci><ci id="S4.SS4.p2.6.m5.1.1.3a.cmml" xref="S4.SS4.p2.6.m5.1.1.3"><mtext id="S4.SS4.p2.6.m5.1.1.3.cmml" mathsize="70%" xref="S4.SS4.p2.6.m5.1.1.3">ID</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.6.m5.1c">\mu_{\text{ID}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.6.m5.1d">italic_μ start_POSTSUBSCRIPT ID end_POSTSUBSCRIPT</annotation></semantics></math> centering improves the FPR95 by up to <math alttext="1.45\%" class="ltx_Math" display="inline" id="S4.SS4.p2.7.m6.1"><semantics id="S4.SS4.p2.7.m6.1a"><mrow id="S4.SS4.p2.7.m6.1.1" xref="S4.SS4.p2.7.m6.1.1.cmml"><mn id="S4.SS4.p2.7.m6.1.1.2" xref="S4.SS4.p2.7.m6.1.1.2.cmml">1.45</mn><mo id="S4.SS4.p2.7.m6.1.1.1" xref="S4.SS4.p2.7.m6.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.7.m6.1b"><apply id="S4.SS4.p2.7.m6.1.1.cmml" xref="S4.SS4.p2.7.m6.1.1"><csymbol cd="latexml" id="S4.SS4.p2.7.m6.1.1.1.cmml" xref="S4.SS4.p2.7.m6.1.1.1">percent</csymbol><cn id="S4.SS4.p2.7.m6.1.1.2.cmml" type="float" xref="S4.SS4.p2.7.m6.1.1.2">1.45</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.7.m6.1c">1.45\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.7.m6.1d">1.45 %</annotation></semantics></math> and <math alttext="7.4\%" class="ltx_Math" display="inline" id="S4.SS4.p2.8.m7.1"><semantics id="S4.SS4.p2.8.m7.1a"><mrow id="S4.SS4.p2.8.m7.1.1" xref="S4.SS4.p2.8.m7.1.1.cmml"><mn id="S4.SS4.p2.8.m7.1.1.2" xref="S4.SS4.p2.8.m7.1.1.2.cmml">7.4</mn><mo id="S4.SS4.p2.8.m7.1.1.1" xref="S4.SS4.p2.8.m7.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.8.m7.1b"><apply id="S4.SS4.p2.8.m7.1.1.cmml" xref="S4.SS4.p2.8.m7.1.1"><csymbol cd="latexml" id="S4.SS4.p2.8.m7.1.1.1.cmml" xref="S4.SS4.p2.8.m7.1.1.1">percent</csymbol><cn id="S4.SS4.p2.8.m7.1.1.2.cmml" type="float" xref="S4.SS4.p2.8.m7.1.1.2">7.4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.8.m7.1c">7.4\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.8.m7.1d">7.4 %</annotation></semantics></math> on CIFAR-10 and ImageNet respectively while also improving the AUROC for both benchmarks.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S4.SS4.p3">
<p class="ltx_p" id="S4.SS4.p3.2"><span class="ltx_text ltx_font_bold" id="S4.SS4.p3.2.1">Looking at the furthest class is better for ID/OOD separation.</span> On Table <a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#S4.T5" title="Table 5 ‣ 4.4 Ablation Studies ‣ 4 Experiments ‣ Look Around and Find Out: OOD Detection with Relative Angles"><span class="ltx_text ltx_ref_tag">5</span></a> we explored different ways to aggregate class specific angles. Originally, we devise our score function to return the maximum relative angle discrepancy between the feature representation across decision boundaries. Intuitively, this suggests that considering the furthest possible class that a feature belongs from the mean of in-distribution’s perspective is effective to distinguish OOD from ID. On the other hand, comparing the minimum focuses on the smallest relative angle, reducing the separability significantly. Table <a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#S4.T5" title="Table 5 ‣ 4.4 Ablation Studies ‣ 4 Experiments ‣ Look Around and Find Out: OOD Detection with Relative Angles"><span class="ltx_text ltx_ref_tag">5</span></a> demonstrates taking the maximum across classes clearly outperforms mean and min aggregations, improving FPR95 and AUROC metrics on both benchmarks. Specifically the difference is higher on our large-scale experiments reducing the FPR95 by <math alttext="7.72\%" class="ltx_Math" display="inline" id="S4.SS4.p3.1.m1.1"><semantics id="S4.SS4.p3.1.m1.1a"><mrow id="S4.SS4.p3.1.m1.1.1" xref="S4.SS4.p3.1.m1.1.1.cmml"><mn id="S4.SS4.p3.1.m1.1.1.2" xref="S4.SS4.p3.1.m1.1.1.2.cmml">7.72</mn><mo id="S4.SS4.p3.1.m1.1.1.1" xref="S4.SS4.p3.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.1.m1.1b"><apply id="S4.SS4.p3.1.m1.1.1.cmml" xref="S4.SS4.p3.1.m1.1.1"><csymbol cd="latexml" id="S4.SS4.p3.1.m1.1.1.1.cmml" xref="S4.SS4.p3.1.m1.1.1.1">percent</csymbol><cn id="S4.SS4.p3.1.m1.1.1.2.cmml" type="float" xref="S4.SS4.p3.1.m1.1.1.2">7.72</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.1.m1.1c">7.72\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p3.1.m1.1d">7.72 %</annotation></semantics></math> and increasing the AUROC by <math alttext="1.39\%" class="ltx_Math" display="inline" id="S4.SS4.p3.2.m2.1"><semantics id="S4.SS4.p3.2.m2.1a"><mrow id="S4.SS4.p3.2.m2.1.1" xref="S4.SS4.p3.2.m2.1.1.cmml"><mn id="S4.SS4.p3.2.m2.1.1.2" xref="S4.SS4.p3.2.m2.1.1.2.cmml">1.39</mn><mo id="S4.SS4.p3.2.m2.1.1.1" xref="S4.SS4.p3.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.2.m2.1b"><apply id="S4.SS4.p3.2.m2.1.1.cmml" xref="S4.SS4.p3.2.m2.1.1"><csymbol cd="latexml" id="S4.SS4.p3.2.m2.1.1.1.cmml" xref="S4.SS4.p3.2.m2.1.1.1">percent</csymbol><cn id="S4.SS4.p3.2.m2.1.1.2.cmml" type="float" xref="S4.SS4.p3.2.m2.1.1.2">1.39</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.2.m2.1c">1.39\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p3.2.m2.1d">1.39 %</annotation></semantics></math> compared to the second best aggregation.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this paper, we introduce a novel angle-based OOD detection score function. As a post-hoc measure of model confidence, LAFO offers several key advantages: it is (i) hyperparameter-free, (ii) model-agnostic and (iii) scale-invariant. These features allow LAFO to be applied to arbitrary pretrained models and used in conjunction with existing activation shaping algorithms, enhancing the performance. Notably, its scale-invariant nature enables simple aggregation of multiple models’ confidences through score summation, allowing a creation of an effective model ensemble for OOD detection. Our extensive experiments demonstrate that LAFO achieves state-of-the-art performance, using the relationship between the feature representations and decision boundaries relative to the ID statistics effectively.
Despite the state-of-the-art performance achieved by LAFO, one possible limitation might be the use of the mean alone to capture the ID statistics in our score. As a future direction, we plan to mitigate this possible limitation by incorporating multiple relative angles to better capture the ID-statistics beyond the mean, aiming to further improve OOD detection performance. We hope that our approach inspires further research into geometric interpretations of model confidence for OOD detection.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Behpour et&nbsp;al. [2023]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Sima Behpour, Thang Doan, Xin Li, Wenbin He, Liang Gou, and Liu Ren.

</span>
<span class="ltx_bibblock">Gradorth: A simple yet efficient out-of-distribution detection with orthogonal projection of gradients.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">Thirty-seventh Conference on Neural Information Processing Systems</em>, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=L9nTuSbAws" title="">https://openreview.net/forum?id=L9nTuSbAws</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bevandić et&nbsp;al. [2019]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Petra Bevandić, Siniša Šegvić, Ivan Krešo, and Marin Oršić.

</span>
<span class="ltx_bibblock">Discriminative out-of-distribution detection for semantic segmentation, 2019.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=H1x1noAqKX" title="">https://openreview.net/forum?id=H1x1noAqKX</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bogdoll et&nbsp;al. [2022]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Daniel Bogdoll, Maximilian Nitsche, and J&nbsp;Marius Zöllner.

</span>
<span class="ltx_bibblock">Anomaly detection in autonomous driving: A survey.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, pp.&nbsp; 4488–4499, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et&nbsp;al. [2023]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Xuxi Chen, Yu&nbsp;Yang, Zhangyang Wang, and Baharan Mirzasoleiman.

</span>
<span class="ltx_bibblock">Data distillation can be like vodka: Distilling more times for better quality.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">The Twelfth International Conference on Learning Representations</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cimpoi et&nbsp;al. [2014]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Mircea Cimpoi, Subhransu Maji, Iasonas Kokkinos, Sammy Mohamed, and Andrea Vedaldi.

</span>
<span class="ltx_bibblock">Describing textures in the wild.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Proceedings of the IEEE conference on computer vision and pattern recognition</em>, pp.&nbsp; 3606–3613, 2014.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Deng et&nbsp;al. [2009]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jia Deng, Wei Dong, Richard Socher, Li-Jia Li, Kai Li, and Li&nbsp;Fei-Fei.

</span>
<span class="ltx_bibblock">Imagenet: A large-scale hierarchical image database.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">2009 IEEE conference on computer vision and pattern recognition</em>, pp.&nbsp; 248–255. Ieee, 2009.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Diehl &amp; Hampshire [2002]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Christopher&nbsp;P Diehl and John&nbsp;B Hampshire.

</span>
<span class="ltx_bibblock">Real-time object classification and novelty detection for collaborative video surveillance.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">Proceedings of the 2002 International Joint Conference on Neural Networks. IJCNN’02 (Cat. No. 02CH37290)</em>, volume&nbsp;3, pp.&nbsp; 2620–2625. IEEE, 2002.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Djurisic et&nbsp;al. [2023]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Andrija Djurisic, Nebojsa Bozanic, Arjun Ashok, and Rosanne Liu.

</span>
<span class="ltx_bibblock">Extremely simple activation shaping for out-of-distribution detection.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">The Eleventh International Conference on Learning Representations</em>, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=ndYXTEL6cZz" title="">https://openreview.net/forum?id=ndYXTEL6cZz</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dosovitskiy et&nbsp;al. [2020]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Alexey Dosovitskiy, Lucas Beyer, Alexander Kolesnikov, Dirk Weissenborn, Xiaohua Zhai, Thomas Unterthiner, Mostafa Dehghani, Matthias Minderer, Georg Heigold, Sylvain Gelly, et&nbsp;al.

</span>
<span class="ltx_bibblock">An image is worth 16x16 words: Transformers for image recognition at scale.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">International Conference on Learning Representations</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[10]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Xuefeng Du, Zhaoning Wang, Mu&nbsp;Cai, and Yixuan Li.

</span>
<span class="ltx_bibblock">Vos: Learning what you don’t know by virtual outlier synthesis.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">International Conference on Learning Representations</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fernando et&nbsp;al. [2021]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Tharindu Fernando, Harshala Gammulle, Simon Denman, Sridha Sridharan, and Clinton Fookes.

</span>
<span class="ltx_bibblock">Deep learning for medical anomaly detection–a survey.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">ACM Computing Surveys (CSUR)</em>, 54(7):1–37, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Geifman &amp; El-Yaniv [2019]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yonatan Geifman and Ran El-Yaniv.

</span>
<span class="ltx_bibblock">Selectivenet: A deep neural network with an integrated reject option.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">International conference on machine learning</em>, pp.&nbsp; 2151–2159. PMLR, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et&nbsp;al. [2017]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Chuan Guo, Geoff Pleiss, Yu&nbsp;Sun, and Kilian&nbsp;Q Weinberger.

</span>
<span class="ltx_bibblock">On calibration of modern neural networks.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">ICML</em>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et&nbsp;al. [2016]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun.

</span>
<span class="ltx_bibblock">Deep residual learning for image recognition.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">Proceedings of the IEEE conference on computer vision and pattern recognition</em>, pp.&nbsp; 770–778, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hendrycks &amp; Gimpel [2022]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Dan Hendrycks and Kevin Gimpel.

</span>
<span class="ltx_bibblock">A baseline for detecting misclassified and out-of-distribution examples in neural networks.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">International Conference on Learning Representations</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[16]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Dan Hendrycks, Mantas Mazeika, and Thomas Dietterich.

</span>
<span class="ltx_bibblock">Deep anomaly detection with outlier exposure.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">International Conference on Learning Representations</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang &amp; Li [2021]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Rui Huang and Yixuan Li.

</span>
<span class="ltx_bibblock">Mos: Towards scaling out-of-distribution detection for large semantic space.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.&nbsp; 8710–8719, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Joshi et&nbsp;al. [2024]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Siddharth Joshi, Arnav Jain, Ali Payani, and Baharan Mirzasoleiman.

</span>
<span class="ltx_bibblock">Data-efficient contrastive language-image pretraining: Prioritizing data quality over quantity.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">International Conference on Artificial Intelligence and Statistics</em>, pp.&nbsp; 1000–1008. PMLR, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Khosla et&nbsp;al. [2020]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Prannay Khosla, Piotr Teterwak, Chen Wang, Aaron Sarna, Yonglong Tian, Phillip Isola, Aaron Maschinot, Ce&nbsp;Liu, and Dilip Krishnan.

</span>
<span class="ltx_bibblock">Supervised contrastive learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">Advances in neural information processing systems</em>, 33:18661–18673, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krizhevsky et&nbsp;al. [2009]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Alex Krizhevsky, Geoffrey Hinton, et&nbsp;al.

</span>
<span class="ltx_bibblock">Learning multiple layers of features from tiny images.

</span>
<span class="ltx_bibblock">2009.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lakshminarayanan et&nbsp;al. [2017]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Balaji Lakshminarayanan, Alexander Pritzel, and Charles Blundell.

</span>
<span class="ltx_bibblock">Simple and scalable predictive uncertainty estimation using deep ensembles.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">NeurIPS</em>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lee et&nbsp;al. [2018a]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Kimin Lee, Honglak Lee, Kibok Lee, and Jinwoo Shin.

</span>
<span class="ltx_bibblock">Training confidence-calibrated classifiers for detecting out-of-distribution samples.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">International Conference on Learning Representations</em>, 2018a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lee et&nbsp;al. [2018b]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Kimin Lee, Kibok Lee, Honglak Lee, and Jinwoo Shin.

</span>
<span class="ltx_bibblock">A simple unified framework for detecting out-of-distribution samples and adversarial attacks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">Advances in neural information processing systems</em>, 31, 2018b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liang et&nbsp;al. [2018]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Shiyu Liang, Yixuan Li, and R&nbsp;Srikant.

</span>
<span class="ltx_bibblock">Enhancing the reliability of out-of-distribution image detection in neural networks.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">6th International Conference on Learning Representations, ICLR 2018</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu &amp; Qin [2024]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Litian Liu and Yao Qin.

</span>
<span class="ltx_bibblock">Fast decision boundary based out-of-distribution detector.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">Forty-first International Conference on Machine Learning</em>, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=eQaOb4r6YC" title="">https://openreview.net/forum?id=eQaOb4r6YC</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et&nbsp;al. [2020]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Weitang Liu, Xiaoyun Wang, John Owens, and Yixuan Li.

</span>
<span class="ltx_bibblock">Energy-based out-of-distribution detection.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">Advances in neural information processing systems</em>, 33:21464–21475, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Malinin &amp; Gales [2018]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Andrey Malinin and Mark Gales.

</span>
<span class="ltx_bibblock">Predictive uncertainty estimation via prior networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">Advances in neural information processing systems</em>, 31, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[28]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Alexander Meinke and Matthias Hein.

</span>
<span class="ltx_bibblock">Towards neural networks that provably know when they don’t know.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">International Conference on Learning Representations</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Minderer et&nbsp;al. [2021]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Matthias Minderer, Josip Djolonga, Rob Romijnders, Frances Hubis, Xiaohua Zhai, Neil Houlsby, Dustin Tran, and Mario Lucic.

</span>
<span class="ltx_bibblock">Revisiting the calibration of modern neural networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">NeurIPS</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ming et&nbsp;al. [2022]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yifei Ming, Ying Fan, and Yixuan Li.

</span>
<span class="ltx_bibblock">Poem: Out-of-distribution detection with posterior sampling.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">International Conference on Machine Learning</em>, pp.&nbsp; 15650–15665. PMLR, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mohseni et&nbsp;al. [2020]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Sina Mohseni, Mandar Pitale, JBS Yadawa, and Zhangyang Wang.

</span>
<span class="ltx_bibblock">Self-supervised learning for generalizable out-of-distribution detection.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">Proceedings of the AAAI conference on artificial intelligence</em>, volume&nbsp;34, pp.&nbsp; 5216–5223, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[32]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Luca Moschella, Valentino Maiorca, Marco Fumero, Antonio Norelli, Francesco Locatello, and Emanuele Rodolà.

</span>
<span class="ltx_bibblock">Relative representations enable zero-shot latent space communication.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">The Eleventh International Conference on Learning Representations</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Netzer et&nbsp;al. [2011]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yuval Netzer, Tao Wang, Adam Coates, Alessandro Bissacco, Baolin Wu, Andrew&nbsp;Y Ng, et&nbsp;al.

</span>
<span class="ltx_bibblock">Reading digits in natural images with unsupervised feature learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">NIPS workshop on deep learning and unsupervised feature learning</em>, volume 2011, pp.&nbsp;&nbsp;4. Granada, 2011.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Paszke et&nbsp;al. [2019]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Adam Paszke, Sam Gross, Francisco Massa, Adam Lerer, James Bradbury, Gregory Chanan, Trevor Killeen, Zeming Lin, Natalia Gimelshein, Luca Antiga, et&nbsp;al.

</span>
<span class="ltx_bibblock">Pytorch: An imperative style, high-performance deep learning library.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">Advances in neural information processing systems</em>, 32, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Peng et&nbsp;al. [2024]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Bo&nbsp;Peng, Yadan Luo, Yonggang Zhang, Yixuan Li, and Zhen Fang.

</span>
<span class="ltx_bibblock">Conjnorm: Tractable density estimation for out-of-distribution detection.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">The Twelfth International Conference on Learning Representations</em>, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=1pSL2cXWoz" title="">https://openreview.net/forum?id=1pSL2cXWoz</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sehwag et&nbsp;al. [2021]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Vikash Sehwag, Mung Chiang, and Prateek Mittal.

</span>
<span class="ltx_bibblock">Ssd: A unified framework for self-supervised outlier detection.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">International Conference on Learning Representations</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun &amp; Li [2022]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yiyou Sun and Yixuan Li.

</span>
<span class="ltx_bibblock">Dice: Leveraging sparsification for out-of-distribution detection.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">European Conference on Computer Vision</em>, pp.&nbsp; 691–708. Springer, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et&nbsp;al. [2021]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yiyou Sun, Chuan Guo, and Yixuan Li.

</span>
<span class="ltx_bibblock">React: Out-of-distribution detection with rectified activations.

</span>
<span class="ltx_bibblock">In A.&nbsp;Beygelzimer, Y.&nbsp;Dauphin, P.&nbsp;Liang, and J.&nbsp;Wortman Vaughan (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">Advances in Neural Information Processing Systems</em>, 2021.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=IBVBtz_sRSm" title="">https://openreview.net/forum?id=IBVBtz_sRSm</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et&nbsp;al. [2022]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yiyou Sun, Yifei Ming, Xiaojin Zhu, and Yixuan Li.

</span>
<span class="ltx_bibblock">Out-of-distribution detection with deep nearest neighbors.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">International Conference on Machine Learning</em>, pp.&nbsp; 20827–20840. PMLR, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tack et&nbsp;al. [2020]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jihoon Tack, Sangwoo Mo, Jongheon Jeong, and Jinwoo Shin.

</span>
<span class="ltx_bibblock">Csi: Novelty detection via contrastive learning on distributionally shifted instances.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">Advances in neural information processing systems</em>, 33:11839–11852, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Van&nbsp;Amersfoort et&nbsp;al. [2020]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Joost Van&nbsp;Amersfoort, Lewis Smith, Yee&nbsp;Whye Teh, and Yarin Gal.

</span>
<span class="ltx_bibblock">Uncertainty estimation using a single deep deterministic neural network.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">International conference on machine learning</em>, pp.&nbsp; 9690–9700. PMLR, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Van&nbsp;Horn et&nbsp;al. [2018]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Grant Van&nbsp;Horn, Oisin Mac&nbsp;Aodha, Yang Song, Yin Cui, Chen Sun, Alex Shepard, Hartwig Adam, Pietro Perona, and Serge Belongie.

</span>
<span class="ltx_bibblock">The inaturalist species classification and detection dataset.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">Proceedings of the IEEE conference on computer vision and pattern recognition</em>, pp.&nbsp; 8769–8778, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et&nbsp;al. [2022]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Haoqi Wang, Zhizhong Li, Litong Feng, and Wayne Zhang.

</span>
<span class="ltx_bibblock">Vim: Out-of-distribution with virtual-logit matching.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, pp.&nbsp; 4921–4930, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei et&nbsp;al. [2022]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Hongxin Wei, Renchunzi Xie, Hao Cheng, Lei Feng, Bo&nbsp;An, and Yixuan Li.

</span>
<span class="ltx_bibblock">Mitigating neural network overconfidence with logit normalization.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">International conference on machine learning</em>, pp.&nbsp; 23631–23644. PMLR, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiao et&nbsp;al. [2010]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jianxiong Xiao, James Hays, Krista&nbsp;A Ehinger, Aude Oliva, and Antonio Torralba.

</span>
<span class="ltx_bibblock">Sun database: Large-scale scene recognition from abbey to zoo.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">2010 IEEE computer society conference on computer vision and pattern recognition</em>, pp.&nbsp; 3485–3492. IEEE, 2010.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et&nbsp;al. [2024]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Chenhui Xu, Fuxun Yu, Zirui Xu, Nathan Inkawhich, and Xiang Chen.

</span>
<span class="ltx_bibblock">Out-of-distribution detection via deep multi-comprehension ensemble.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">Forty-first International Conference on Machine Learning</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[47]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Kai Xu, Rongyu Chen, Gianni Franchi, and Angela Yao.

</span>
<span class="ltx_bibblock">Scaling for training time and post-hoc out-of-distribution detection enhancement.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">The Twelfth International Conference on Learning Representations</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et&nbsp;al. [2015]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Pingmei Xu, Krista&nbsp;A Ehinger, Yinda Zhang, Adam Finkelstein, Sanjeev&nbsp;R Kulkarni, and Jianxiong Xiao.

</span>
<span class="ltx_bibblock">Turkergaze: Crowdsourcing saliency with webcam based eye tracking.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">arXiv preprint arXiv:1504.06755</em>, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xue et&nbsp;al. [2024]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Feng Xue, Zi&nbsp;He, Yuan Zhang, Chuanlong Xie, Zhenguo Li, and Falong Tan.

</span>
<span class="ltx_bibblock">Enhancing the power of ood detection via sample-aware model selection.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib49.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.&nbsp; 17148–17157, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et&nbsp;al. [2021]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jingkang Yang, Haoqi Wang, Litong Feng, Xiaopeng Yan, Huabin Zheng, Wayne Zhang, and Ziwei Liu.

</span>
<span class="ltx_bibblock">Semantically coherent out-of-distribution detection.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib50.1.1">Proceedings of the IEEE/CVF International Conference on Computer Vision</em>, pp.&nbsp; 8301–8309, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et&nbsp;al. [2024]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jingkang Yang, Kaiyang Zhou, Yixuan Li, and Ziwei Liu.

</span>
<span class="ltx_bibblock">Generalized out-of-distribution detection: A survey.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib51.1.1">International Journal of Computer Vision</em>, pp.&nbsp; 1–28, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et&nbsp;al. [2017]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Bolei Zhou, Agata Lapedriza, Aditya Khosla, Aude Oliva, and Antonio Torralba.

</span>
<span class="ltx_bibblock">Places: A 10 million image database for scene recognition.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib52.1.1">IEEE transactions on pattern analysis and machine intelligence</em>, 40(6):1452–1464, 2017.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Appendix</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Comparison of Score Distributions: CIFAR-10 vs. OOD Datasets</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A1.SS1.p1">
<p class="ltx_p" id="A1.SS1.p1.1">In this section we report the score histogram results on the Table <a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#S4.T1" title="Table 1 ‣ 4 Experiments ‣ Look Around and Find Out: OOD Detection with Relative Angles"><span class="ltx_text ltx_ref_tag">1</span></a> for CIFAR-10 OOD Benchmark.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="A1.F4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A1.F4.1" style="width:164.8pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="368" id="A1.F4.1.g1" src="https://arxiv.org/html/2410.04525v1/extracted/5905247/figures/hists/CIFAR/CIFAR-10_SVHN_hist_LAFO.png" width="598">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A1.F4.2" style="width:164.8pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="368" id="A1.F4.2.g1" src="https://arxiv.org/html/2410.04525v1/extracted/5905247/figures/hists/CIFAR/CIFAR-10_iSUN_hist_LAFO.png" width="598">
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A1.F4.3" style="width:164.8pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="368" id="A1.F4.3.g1" src="https://arxiv.org/html/2410.04525v1/extracted/5905247/figures/hists/CIFAR/CIFAR-10_places365_hist_LAFO.png" width="598">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A1.F4.4" style="width:164.8pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="368" id="A1.F4.4.g1" src="https://arxiv.org/html/2410.04525v1/extracted/5905247/figures/hists/CIFAR/CIFAR-10_Texture_hist_LAFO.png" width="598">
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A1.F4.6.1.1" style="font-size:90%;">Figure 4</span>: </span><span class="ltx_text" id="A1.F4.7.2" style="font-size:90%;">Score distributions of ID and OOD datasets in CIFAR-10 OOD Benchmark.</span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_subsection" id="A1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Comparison of Score Distributions: ImageNet vs. OOD Datasets</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A1.SS2.p1">
<p class="ltx_p" id="A1.SS2.p1.1">We report the score histogram results on the Table <a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#S4.T2" title="Table 2 ‣ 4.1 OOD Detection on CIFAR-10 and ImageNet Benchmarks ‣ 4 Experiments ‣ Look Around and Find Out: OOD Detection with Relative Angles"><span class="ltx_text ltx_ref_tag">2</span></a> for ImageNet OOD Benchmark.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="A1.F5">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A1.F5.1" style="width:164.8pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="449" id="A1.F5.1.g1" src="https://arxiv.org/html/2410.04525v1/extracted/5905247/figures/hists/ImageNet/imagenet_inat_hist_LAFO.png" width="598">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A1.F5.2" style="width:164.8pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="449" id="A1.F5.2.g1" src="https://arxiv.org/html/2410.04525v1/extracted/5905247/figures/hists/ImageNet/imagenet_sun50_hist_LAFO.png" width="598">
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A1.F5.3" style="width:164.8pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="449" id="A1.F5.3.g1" src="https://arxiv.org/html/2410.04525v1/extracted/5905247/figures/hists/ImageNet/imagenet_places50_hist_LAFO.png" width="598">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A1.F5.4" style="width:164.8pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="449" id="A1.F5.4.g1" src="https://arxiv.org/html/2410.04525v1/extracted/5905247/figures/hists/ImageNet/imagenet_Texture_hist_LAFO.png" width="598">
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A1.F5.6.1.1" style="font-size:90%;">Figure 5</span>: </span><span class="ltx_text" id="A1.F5.7.2" style="font-size:90%;">Score distributions of ID and OOD datasets in ImageNet OOD Benchmark.</span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_subsection" id="A1.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.3 </span>Model Ensemble Experiment</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A1.SS3.p1">
<p class="ltx_p" id="A1.SS3.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#A1.T6" title="Table 6 ‣ A.3 Model Ensemble Experiment ‣ Appendix A Appendix ‣ Look Around and Find Out: OOD Detection with Relative Angles"><span class="ltx_text ltx_ref_tag">6</span></a> show the extended version for the model ensemble experiment presented on Table <a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#S4.F3.2" title="Figure 3 ‣ 4.2 Model Ensembling with LAFO ‣ 4 Experiments ‣ Look Around and Find Out: OOD Detection with Relative Angles"><span class="ltx_text ltx_ref_tag">3</span></a></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="A1.T6">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="A1.T6.13.1.1" style="font-size:90%;">Table 6</span>: </span><span class="ltx_text" id="A1.T6.14.2" style="font-size:90%;">LAFO can be used as a score function to accumulate different architectures’ confidences due to its scale-invariance property. Evaluated under both ImageNet OOD benchmark. Best performance highlighted in <span class="ltx_text ltx_font_bold" id="A1.T6.14.2.1">bold</span>.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A1.T6.10" style="width:433.6pt;height:121.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-103.6pt,29.1pt) scale(0.676619743219587,0.676619743219587) ;">
<table class="ltx_tabular ltx_align_middle" id="A1.T6.10.10">
<tbody><tr class="ltx_tr" id="A1.T6.10.10.11">
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T6.10.10.11.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="A1.T6.10.10.11.1.1">Method</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="A1.T6.10.10.11.2"><span class="ltx_text ltx_font_bold" id="A1.T6.10.10.11.2.1">iNaturalist</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="A1.T6.10.10.11.3"><span class="ltx_text ltx_font_bold" id="A1.T6.10.10.11.3.1">SUN</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="A1.T6.10.10.11.4"><span class="ltx_text ltx_font_bold" id="A1.T6.10.10.11.4.1">Places</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="A1.T6.10.10.11.5"><span class="ltx_text ltx_font_bold" id="A1.T6.10.10.11.5.1">Texture</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="A1.T6.10.10.11.6"><span class="ltx_text ltx_font_bold" id="A1.T6.10.10.11.6.1">Avg</span></td>
</tr>
<tr class="ltx_tr" id="A1.T6.10.10.10">
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.1.1.1.1">FPR95<math alttext="\downarrow" class="ltx_Math" display="inline" id="A1.T6.1.1.1.1.m1.1"><semantics id="A1.T6.1.1.1.1.m1.1a"><mo id="A1.T6.1.1.1.1.m1.1.1" stretchy="false" xref="A1.T6.1.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="A1.T6.1.1.1.1.m1.1b"><ci id="A1.T6.1.1.1.1.m1.1.1.cmml" xref="A1.T6.1.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.1.1.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="A1.T6.1.1.1.1.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.2.2.2.2">AUROC<math alttext="\uparrow" class="ltx_Math" display="inline" id="A1.T6.2.2.2.2.m1.1"><semantics id="A1.T6.2.2.2.2.m1.1a"><mo id="A1.T6.2.2.2.2.m1.1.1" stretchy="false" xref="A1.T6.2.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A1.T6.2.2.2.2.m1.1b"><ci id="A1.T6.2.2.2.2.m1.1.1.cmml" xref="A1.T6.2.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.2.2.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="A1.T6.2.2.2.2.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.3.3.3.3">FPR95<math alttext="\downarrow" class="ltx_Math" display="inline" id="A1.T6.3.3.3.3.m1.1"><semantics id="A1.T6.3.3.3.3.m1.1a"><mo id="A1.T6.3.3.3.3.m1.1.1" stretchy="false" xref="A1.T6.3.3.3.3.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="A1.T6.3.3.3.3.m1.1b"><ci id="A1.T6.3.3.3.3.m1.1.1.cmml" xref="A1.T6.3.3.3.3.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.3.3.3.3.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="A1.T6.3.3.3.3.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.4.4.4.4">AUROC<math alttext="\uparrow" class="ltx_Math" display="inline" id="A1.T6.4.4.4.4.m1.1"><semantics id="A1.T6.4.4.4.4.m1.1a"><mo id="A1.T6.4.4.4.4.m1.1.1" stretchy="false" xref="A1.T6.4.4.4.4.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A1.T6.4.4.4.4.m1.1b"><ci id="A1.T6.4.4.4.4.m1.1.1.cmml" xref="A1.T6.4.4.4.4.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.4.4.4.4.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="A1.T6.4.4.4.4.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.5.5.5.5">FPR95<math alttext="\downarrow" class="ltx_Math" display="inline" id="A1.T6.5.5.5.5.m1.1"><semantics id="A1.T6.5.5.5.5.m1.1a"><mo id="A1.T6.5.5.5.5.m1.1.1" stretchy="false" xref="A1.T6.5.5.5.5.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="A1.T6.5.5.5.5.m1.1b"><ci id="A1.T6.5.5.5.5.m1.1.1.cmml" xref="A1.T6.5.5.5.5.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.5.5.5.5.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="A1.T6.5.5.5.5.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.6.6.6.6">AUROC<math alttext="\uparrow" class="ltx_Math" display="inline" id="A1.T6.6.6.6.6.m1.1"><semantics id="A1.T6.6.6.6.6.m1.1a"><mo id="A1.T6.6.6.6.6.m1.1.1" stretchy="false" xref="A1.T6.6.6.6.6.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A1.T6.6.6.6.6.m1.1b"><ci id="A1.T6.6.6.6.6.m1.1.1.cmml" xref="A1.T6.6.6.6.6.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.6.6.6.6.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="A1.T6.6.6.6.6.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.7.7.7.7">FPR95<math alttext="\downarrow" class="ltx_Math" display="inline" id="A1.T6.7.7.7.7.m1.1"><semantics id="A1.T6.7.7.7.7.m1.1a"><mo id="A1.T6.7.7.7.7.m1.1.1" stretchy="false" xref="A1.T6.7.7.7.7.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="A1.T6.7.7.7.7.m1.1b"><ci id="A1.T6.7.7.7.7.m1.1.1.cmml" xref="A1.T6.7.7.7.7.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.7.7.7.7.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="A1.T6.7.7.7.7.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.8.8.8.8">AUROC<math alttext="\uparrow" class="ltx_Math" display="inline" id="A1.T6.8.8.8.8.m1.1"><semantics id="A1.T6.8.8.8.8.m1.1a"><mo id="A1.T6.8.8.8.8.m1.1.1" stretchy="false" xref="A1.T6.8.8.8.8.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A1.T6.8.8.8.8.m1.1b"><ci id="A1.T6.8.8.8.8.m1.1.1.cmml" xref="A1.T6.8.8.8.8.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.8.8.8.8.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="A1.T6.8.8.8.8.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.9.9.9.9">FPR95<math alttext="\downarrow" class="ltx_Math" display="inline" id="A1.T6.9.9.9.9.m1.1"><semantics id="A1.T6.9.9.9.9.m1.1a"><mo id="A1.T6.9.9.9.9.m1.1.1" stretchy="false" xref="A1.T6.9.9.9.9.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="A1.T6.9.9.9.9.m1.1b"><ci id="A1.T6.9.9.9.9.m1.1.1.cmml" xref="A1.T6.9.9.9.9.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.9.9.9.9.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="A1.T6.9.9.9.9.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.10.10.10.10">AUROC<math alttext="\uparrow" class="ltx_Math" display="inline" id="A1.T6.10.10.10.10.m1.1"><semantics id="A1.T6.10.10.10.10.m1.1a"><mo id="A1.T6.10.10.10.10.m1.1.1" stretchy="false" xref="A1.T6.10.10.10.10.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A1.T6.10.10.10.10.m1.1b"><ci id="A1.T6.10.10.10.10.m1.1.1.cmml" xref="A1.T6.10.10.10.10.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.10.10.10.10.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="A1.T6.10.10.10.10.m1.1d">↑</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="A1.T6.10.10.12">
<td class="ltx_td ltx_align_left" id="A1.T6.10.10.12.1">fDBD w/ResNet50</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.12.2">40.10</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.12.3">93.70</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.12.4">60.89</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.12.5">86.86</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.12.6">66.75</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.12.7">84.14</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.12.8">37.66</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.12.9">92.09</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.12.10">51.35</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.12.11">89.20</td>
</tr>
<tr class="ltx_tr" id="A1.T6.10.10.13">
<td class="ltx_td ltx_align_left" id="A1.T6.10.10.13.1">fDBD w/ResNet50-supcon</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.13.2">17.34</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.13.3">96.68</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.13.4">42.26</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.13.5">90.92</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.13.6">49.68</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.13.7">88.38</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.13.8">21.84</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.13.9">95.44</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.13.10">32.78</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.13.11">92.86</td>
</tr>
<tr class="ltx_tr" id="A1.T6.10.10.14">
<td class="ltx_td ltx_align_left" id="A1.T6.10.10.14.1">fDBD w/ViT-B/16</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.14.2">12.97</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.14.3">97.71</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.14.4">51.09</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.14.5">89.67</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.14.6">56.51</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.14.7">87.32</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.14.8">45.62</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.14.9">89.48</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.14.10">41.55</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.14.11">91.05</td>
</tr>
<tr class="ltx_tr" id="A1.T6.10.10.15">
<td class="ltx_td ltx_align_left" id="A1.T6.10.10.15.1">LAFO w/ResNet50</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.15.2">34.88</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.15.3">94.43</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.15.4">54.30</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.15.5">88.41</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.15.6">61.79</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.15.7">85.64</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.15.8">27.34</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.15.9">94.24</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.15.10">44.58</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.15.11">90.68</td>
</tr>
<tr class="ltx_tr" id="A1.T6.10.10.16">
<td class="ltx_td ltx_align_left" id="A1.T6.10.10.16.1">LAFO w/ResNet50-supcon</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.16.2">12.27</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.16.3">97.42</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.16.4">31.80</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.16.5">92.85</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.16.6">40.71</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.16.7">90.10</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.16.8">15.39</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.16.9">96.68</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.16.10">25.04</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.16.11">94.26</td>
</tr>
<tr class="ltx_tr" id="A1.T6.10.10.17">
<td class="ltx_td ltx_align_left" id="A1.T6.10.10.17.1">LAFO w/ViT-B/16</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.17.2">11.81</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.17.3">97.85</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.17.4">48.98</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.17.5">90.06</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.17.6">54.60</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.17.7">87.75</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.17.8">44.31</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.17.9">89.85</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.17.10">39.92</td>
<td class="ltx_td ltx_align_center" id="A1.T6.10.10.17.11">91.38</td>
</tr>
<tr class="ltx_tr" id="A1.T6.10.10.18">
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T6.10.10.18.1">Ensemble fDBD</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.10.10.18.2">4.58</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.10.10.18.3">98.93</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.10.10.18.4">42.81</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.10.10.18.5">93.97</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.10.10.18.6">53.49</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.10.10.18.7">91.92</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.10.10.18.8">23.33</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.10.10.18.9">96.34</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.10.10.18.10">31.05</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.10.10.18.11">95.29</td>
</tr>
<tr class="ltx_tr" id="A1.T6.10.10.19">
<td class="ltx_td ltx_align_left ltx_border_b" id="A1.T6.10.10.19.1">Ensemble LAFO</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="A1.T6.10.10.19.2">2.77</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="A1.T6.10.10.19.3">99.29</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="A1.T6.10.10.19.4">30.21</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="A1.T6.10.10.19.5">95.39</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="A1.T6.10.10.19.6">42.52</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="A1.T6.10.10.19.7">93.39</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="A1.T6.10.10.19.8">14.63</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="A1.T6.10.10.19.9">97.59</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="A1.T6.10.10.19.10"><span class="ltx_text ltx_font_bold" id="A1.T6.10.10.19.10.1">22.53</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="A1.T6.10.10.19.11"><span class="ltx_text ltx_font_bold" id="A1.T6.10.10.19.11.1">96.41</span></td>
</tr>
</tbody></table>
</span></div>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A1.F6">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A1.F6.1" style="width:173.4pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="449" id="A1.F6.1.g1" src="https://arxiv.org/html/2410.04525v1/extracted/5905247/figures/hists/Ensemble_vs_LAFO/imagenet_inat_hist_LAFO_resnet50_supcon.png" width="598">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A1.F6.2" style="width:173.4pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="449" id="A1.F6.2.g1" src="https://arxiv.org/html/2410.04525v1/extracted/5905247/figures/hists/Ensemble_vs_LAFO/imagenet_inat_hist_LAFO_zoo.png" width="598">
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A1.F6.6.1.1" style="font-size:90%;">Figure 6</span>: </span><span class="ltx_text" id="A1.F6.7.2" style="font-size:90%;">Comparison of the score histograms on Imagenet (ID) and inaturalist<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib42" title="">42</a>]</cite>(OOD) of the best individual model <span class="ltx_text ltx_font_italic" id="A1.F6.7.2.1">(</span>left) with the model ensemble (<span class="ltx_text ltx_font_italic" id="A1.F6.7.2.2">right</span>). Model ensemble improves the ID and OOD separation.</span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_subsection" id="A1.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.4 </span>Implementation Details</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A1.SS4.p1">
<p class="ltx_p" id="A1.SS4.p1.3">We used Pytorch &nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib34" title="">34</a>]</cite> to conduct our experiments. We obtain the checkpoints of pretrained models ResNet18 with supervised contrastive loss and ResNet50 with supervised contrastive loss from &nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib25" title="">25</a>]</cite>’s work for a fair comparison. In the experiment where we aggregate different models’ confidences, ViT-B/16 &nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib9" title="">9</a>]</cite> checkpoint is retrieved from the publicly available repository <a class="ltx_ref ltx_href" href="https://github.com/lukemelas/PyTorch-Pretrained-ViT/tree/master" title="">https://github.com/lukemelas/PyTorch-Pretrained-ViT/tree/master</a>. In the experiment where we merge LAFO with the activation shaping algorithms ASH &nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib8" title="">8</a>]</cite>, Scale &nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib47" title="">47</a>]</cite> and ReAct &nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04525v1#bib.bib38" title="">38</a>]</cite>, we used the percentiles to set the thresholds <math alttext="35" class="ltx_Math" display="inline" id="A1.SS4.p1.1.m1.1"><semantics id="A1.SS4.p1.1.m1.1a"><mn id="A1.SS4.p1.1.m1.1.1" xref="A1.SS4.p1.1.m1.1.1.cmml">35</mn><annotation-xml encoding="MathML-Content" id="A1.SS4.p1.1.m1.1b"><cn id="A1.SS4.p1.1.m1.1.1.cmml" type="integer" xref="A1.SS4.p1.1.m1.1.1">35</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p1.1.m1.1c">35</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p1.1.m1.1d">35</annotation></semantics></math>, <math alttext="90" class="ltx_Math" display="inline" id="A1.SS4.p1.2.m2.1"><semantics id="A1.SS4.p1.2.m2.1a"><mn id="A1.SS4.p1.2.m2.1.1" xref="A1.SS4.p1.2.m2.1.1.cmml">90</mn><annotation-xml encoding="MathML-Content" id="A1.SS4.p1.2.m2.1b"><cn id="A1.SS4.p1.2.m2.1.1.cmml" type="integer" xref="A1.SS4.p1.2.m2.1.1">90</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p1.2.m2.1c">90</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p1.2.m2.1d">90</annotation></semantics></math> and <math alttext="80" class="ltx_Math" display="inline" id="A1.SS4.p1.3.m3.1"><semantics id="A1.SS4.p1.3.m3.1a"><mn id="A1.SS4.p1.3.m3.1.1" xref="A1.SS4.p1.3.m3.1.1.cmml">80</mn><annotation-xml encoding="MathML-Content" id="A1.SS4.p1.3.m3.1b"><cn id="A1.SS4.p1.3.m3.1.1.cmml" type="integer" xref="A1.SS4.p1.3.m3.1.1">80</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p1.3.m3.1c">80</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p1.3.m3.1d">80</annotation></semantics></math> respectively. All experiments are evaluated on a single Nvidia H100 GPU. Note that, due to our hyperparameter-free post-hoc score function, all experiments are deterministic given the pretrained model.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section><div about="" class="ltx_rdf" property="dcterms:creator"></div>
<div about="" class="ltx_rdf" content="language model, llm, calibration, benchmark, folktexts, datasets" property="dcterms:subject"></div>
<div about="" class="ltx_rdf" property="dcterms:title"></div>
</article>
</div>

</div>


<button type="button" class="btn btn-primary hover-rp-button" id="openForm">Report Issue</button><div class="modal" id="myForm" role="dialog" aria-labelledby="modal-title"><div class="modal-dialog"><form class="modal-content" id="myFormContent" enctype="multipart/form-data"><div class="modal-header" id="modal-header"><h5 class="modal-title">Report Github Issue</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body"><label for="form_title" id="modalTitle">Title:</label><input class="form-control" id="form_title" name="form_title" required="required" placeholder="Enter title"><label for="description" id="selectedTextModalDescription" style="display: none;">Content selection saved. Describe the issue below:</label><label for="description" id="nomralModalDescription">Description:</label><textarea class="form-control" id="description" name="description" required="required" style="height: 80px;" maxlength="500" placeholder="500 characters maximum"></textarea></div><div class="modal-footer d-flex justify-content-end"><button type="submit" class="sr-only button" id="modal-submit-sr">Submit without Github</button><button type="submit" class="btn btn-primary" id="modal-submit">Submit in Github</button></div></form></div></div><button id="small-report-button" type="button" class="btn btn-secondary btn-sm" style="background-color: rgb(179, 27, 27); position: fixed;">Report Issue for Selection</button><div class="ltx_page_footer">
        <div class="ltx_page_logo">
            Generated by
            <a href="https://math.nist.gov/~BMiller/LaTeXML/" class="ltx_LaTeXML_logo">
                <span style="letter-spacing: -0.2em; margin-right: 0.1em;">
                    L
                    <span style="font-size: 70%; position: relative; bottom: 2.2pt;">A</span>
                    T
                    <span style="position: relative; bottom: -0.4ex;">E</span>
                </span>
                <span class="ltx_font_smallcaps">xml</span>
                <img alt="[LOGO]" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==">
            </a>
        </div></div><footer id="footer" class="ltx_document">
        <div class="keyboard-glossary">
            <h2>Instructions for reporting errors</h2>
            <p>We are continuing to improve HTML versions of papers, and your feedback helps enhance accessibility and mobile support. To report errors in the HTML that will help us improve conversion and rendering, choose any of the methods listed below:</p>
            <ul>
                <li>Click the "Report Issue" button.</li>
                <li>Open a report feedback form via keyboard, use "<strong>Ctrl + ?</strong>".</li>
                <li>Make a text selection and click the "Report Issue for Selection" button near your cursor.</li>
                <li class="sr-only">You can use Alt+Y to toggle on and Alt+Shift+Y to toggle off accessible reporting links at each section.</li>
            </ul>
            <p>Our team has already identified <a class="ltx_ref" href="https://github.com/arXiv/html_feedback/issues" target="_blank">the following issues</a>. We appreciate your time reviewing and reporting rendering errors we may not have found yet. Your efforts will help us improve the HTML versions for all readers, because disability should not be a barrier to accessing research. Thank you for your continued support in championing open access for all.</p>
            <p>Have a free development cycle? Help support accessibility at arXiv! Our collaborators at LaTeXML maintain a <a class="ltx_ref" href="https://github.com/brucemiller/LaTeXML/wiki/Porting-LaTeX-packages-for-LaTeXML" target="_blank">list of packages that need conversion</a>, and welcome <a class="ltx_ref" href="https://github.com/brucemiller/LaTeXML/issues" target="_blank">developer contributions</a>.</p>
        </div>
    </footer></body></html>