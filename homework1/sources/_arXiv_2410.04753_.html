<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>ImProver: Agent-Based Automated Proof Optimization</title>
<!--Generated on Mon Oct  7 05:12:03 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.04753v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#S1" title="In ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#S2" title="In ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#S3" title="In ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Automated Proof Optimization with <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline"><semantics><mi>ImProver</mi><annotation-xml encoding="MathML-Content"><ci>ImProver</ci></annotation-xml><annotation encoding="application/x-tex">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun">roman_ImProver</annotation></semantics></math></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#S3.SS0.SSS0.Px1" title="In 3 Automated Proof Optimization with ImProver ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_title">Automated Proof Optimization.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#S3.SS1" title="In 3 Automated Proof Optimization with ImProver ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Improver</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#S3.SS1.SSS1" title="In 3.1 Improver ‣ 3 Automated Proof Optimization with ImProver ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1.1 </span>Chain-of-States Prompting</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#S3.SS1.SSS2" title="In 3.1 Improver ‣ 3 Automated Proof Optimization with ImProver ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1.2 </span>Output formatting.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#S3.SS1.SSS3" title="In 3.1 Improver ‣ 3 Automated Proof Optimization with ImProver ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1.3 </span>Sampling Method</span></a>
<ol class="ltx_toclist ltx_toclist_subsubsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#S3.SS1.SSS3.Px1" title="In 3.1.3 Sampling Method ‣ 3.1 Improver ‣ 3 Automated Proof Optimization with ImProver ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_title">Best-of-n</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#S3.SS1.SSS3.Px2" title="In 3.1.3 Sampling Method ‣ 3.1 Improver ‣ 3 Automated Proof Optimization with ImProver ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_title">Error correction and Refinement</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#S3.SS1.SSS3.Px3" title="In 3.1.3 Sampling Method ‣ 3.1 Improver ‣ 3 Automated Proof Optimization with ImProver ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_title">Combination Sampling and Compound Prompt Functions</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#S3.SS1.SSS4" title="In 3.1 Improver ‣ 3 Automated Proof Optimization with ImProver ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1.4 </span>Retrieval</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#S4" title="In ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#S4.SS1" title="In 4 Experiments ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Setup</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#S4.SS1.SSS0.Px1" title="In 4.1 Setup ‣ 4 Experiments ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_title">Datasets.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#S4.SS1.SSS0.Px2" title="In 4.1 Setup ‣ 4 Experiments ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_title">Models.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#S4.SS1.SSS0.Px3" title="In 4.1 Setup ‣ 4 Experiments ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_title">Performance metrics.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#S4.SS1.SSS1" title="In 4.1 Setup ‣ 4 Experiments ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.1 </span>Ablations</span></a>
<ol class="ltx_toclist ltx_toclist_subsubsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#S4.SS1.SSS1.Px1" title="In 4.1.1 Ablations ‣ 4.1 Setup ‣ 4 Experiments ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_title">Testing Groups.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#S4.SS1.SSS1.Px2" title="In 4.1.1 Ablations ‣ 4.1 Setup ‣ 4 Experiments ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_title">Ablation data.</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#S4.SS2" title="In 4 Experiments ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Results</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#S4.SS2.SSS0.Px1" title="In 4.2 Results ‣ 4 Experiments ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_title"><math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline"><semantics><mi>ImProver</mi><annotation-xml encoding="MathML-Content"><ci>ImProver</ci></annotation-xml><annotation encoding="application/x-tex">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun">roman_ImProver</annotation></semantics></math> is capable of optimizing proofs in all settings.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#S4.SS2.SSS0.Px2" title="In 4.2 Results ‣ 4 Experiments ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_title">Length optimization.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#S4.SS2.SSS0.Px3" title="In 4.2 Results ‣ 4 Experiments ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_title">Readability optimization.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#S4.SS2.SSS0.Px4" title="In 4.2 Results ‣ 4 Experiments ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_title">Optimization varies based on dataset difficulty.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#S4.SS2.SSS1" title="In 4.2 Results ‣ 4 Experiments ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2.1 </span>Ablation Testing</span></a>
<ol class="ltx_toclist ltx_toclist_subsubsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#S4.SS2.SSS1.Px1" title="In 4.2.1 Ablation Testing ‣ 4.2 Results ‣ 4 Experiments ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_title">Readability and Chain-of-States (CoS) Ablation.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#S4.SS2.SSS2" title="In 4.2 Results ‣ 4 Experiments ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2.2 </span>Neural Theorem Proving Evaluation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#S4.SS3" title="In 4 Experiments ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Qualitative Results</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#S4.SS3.SSS0.Px1" title="In 4.3 Qualitative Results ‣ 4 Experiments ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_title">Example 1: Compfiles Optimization.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#S4.SS3.SSS0.Px2" title="In 4.3 Qualitative Results ‣ 4 Experiments ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_title">Example 2: MIL.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#S4.SS3.SSS0.Px3" title="In 4.3 Qualitative Results ‣ 4 Experiments ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_title">Example 3: Full Proof Generation.</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#S5" title="In ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#A1" title="In ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Prompts</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#A1.SS1" title="In Appendix A Prompts ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Template</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#A1.SS2" title="In Appendix A Prompts ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2 </span>Metric Prompts</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#A2" title="In ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Additional Experimental Results</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#A2.SS1" title="In Appendix B Additional Experimental Results ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.1 </span>Ablation Details</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#A2.SS2" title="In Appendix B Additional Experimental Results ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.2 </span>Additional Qualitative Examples</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#A2.SS2.SSS0.Px1" title="In B.2 Additional Qualitative Examples ‣ Appendix B Additional Experimental Results ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_title">Compfiles: Length Optimization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#A2.SS2.SSS0.Px2" title="In B.2 Additional Qualitative Examples ‣ Appendix B Additional Experimental Results ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_title">Compfiles: Readability Optimization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#A2.SS2.SSS0.Px3" title="In B.2 Additional Qualitative Examples ‣ Appendix B Additional Experimental Results ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_title">MIL: Length Optimization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#A2.SS2.SSS0.Px4" title="In B.2 Additional Qualitative Examples ‣ Appendix B Additional Experimental Results ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_title">MIL: Length Optimization 2</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#A2.SS2.SSS0.Px5" title="In B.2 Additional Qualitative Examples ‣ Appendix B Additional Experimental Results ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_title">MIL: Readability Optimization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#A2.SS2.SSS0.Px6" title="In B.2 Additional Qualitative Examples ‣ Appendix B Additional Experimental Results ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_title">Mathlib: Length Optimization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#A2.SS2.SSS0.Px7" title="In B.2 Additional Qualitative Examples ‣ Appendix B Additional Experimental Results ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_title">Mathlib: Readability Optimization</span></a></li>
</ol>
</li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line" lang="en">
<h1 class="ltx_title ltx_title_document">ImProver: Agent-Based Automated 
<br class="ltx_break"/>Proof Optimization</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Riyaz Ahuja Jeremy Avigad Prasad Tetali Sean Welleck
<br class="ltx_break"/>Carnegie Mellon University
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id4.4"><span class="ltx_text" id="id4.4.4">Large language models (LLMs) have been used to generate formal proofs of mathematical theorems in proofs assistants such as Lean.
However, we often want to optimize a formal proof with respect to various criteria, depending on its downstream use.
For example, we may want a proof to adhere to a certain style, or to be readable, concise, or modularly structured.
Having suitably optimized proofs is also important for learning tasks, especially since human-written proofs may not optimal for that purpose.
To this end, we study a new problem of automated proof optimization: rewriting a proof so that it is correct and optimizes for an arbitrary criterion, such as length or readability.
As a first method for automated proof optimization, we present <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="id1.1.1.m1.1"><semantics id="id1.1.1.m1.1a"><mi id="id1.1.1.m1.1.1" xref="id1.1.1.m1.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="id1.1.1.m1.1b"><ci id="id1.1.1.m1.1.1.cmml" xref="id1.1.1.m1.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="id1.1.1.m1.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="id1.1.1.m1.1d">roman_ImProver</annotation></semantics></math>, a large-language-model agent that rewrites proofs to optimize arbitrary user-defined metrics in Lean.
We find that naively applying LLMs to proof optimization falls short, and we incorporate various improvements into <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="id2.2.2.m2.1"><semantics id="id2.2.2.m2.1a"><mi id="id2.2.2.m2.1.1" xref="id2.2.2.m2.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="id2.2.2.m2.1b"><ci id="id2.2.2.m2.1.1.cmml" xref="id2.2.2.m2.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="id2.2.2.m2.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="id2.2.2.m2.1d">roman_ImProver</annotation></semantics></math>, such as the use of symbolic Lean context in a novel Chain-of-States technique, as well as error-correction and retrieval. We test <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="id3.3.3.m3.1"><semantics id="id3.3.3.m3.1a"><mi id="id3.3.3.m3.1.1" xref="id3.3.3.m3.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="id3.3.3.m3.1b"><ci id="id3.3.3.m3.1.1.cmml" xref="id3.3.3.m3.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="id3.3.3.m3.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="id3.3.3.m3.1d">roman_ImProver</annotation></semantics></math> on rewriting real-world undergraduate, competition, and research-level mathematics theorems, finding that <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="id4.4.4.m4.1"><semantics id="id4.4.4.m4.1a"><mi id="id4.4.4.m4.1.1" xref="id4.4.4.m4.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="id4.4.4.m4.1b"><ci id="id4.4.4.m4.1.1.cmml" xref="id4.4.4.m4.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="id4.4.4.m4.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="id4.4.4.m4.1d">roman_ImProver</annotation></semantics></math> is capable of rewriting proofs so that they are substantially shorter, more modular, and more readable.</span></p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para ltx_noindent" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">The fundamental virtue of a mathematical proof is that it provides certainty: a deductive argument shows that the assumptions of a mathematical statement logically guarantee the conclusion. In practice, however, informal, natural-language proofs are prone to imprecision, ambiguity, and error.
Using a formal language such as Lean <cite class="ltx_cite ltx_citemacro_citep">(Moura &amp; Ullrich, <a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#bib.bib17" title="">2021</a>)</cite> removes ambiguity and precision and enables a proof assistant to verify correctness down to the primitives of a formal axiomatic system.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Formal proofs, however, can be hard to read and often suffer from low reusability or excessive detail.
For example, formal proofs in Lean’s extensive mathematical library, Mathlib <cite class="ltx_cite ltx_citemacro_citep">(mathlib Community, <a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#bib.bib16" title="">2020</a>)</cite>, are generally designed to be concise and very general, often at the expense of readability.
Formal proofs in an expository text, in contrast, may include detailed calculations steps, making them readable but verbose.
Machine learning systems trained on such proofs learn to mimic these varied conventions <cite class="ltx_cite ltx_citemacro_citep">(Hu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#bib.bib8" title="">2024</a>)</cite>, which may not be the optimal use of the limited supply of human-written proofs.
As a result, we would like to be able to automatically refactor proofs to meet a secondary objective such as length or readability.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">To this end, we study a new problem of <span class="ltx_text ltx_font_italic" id="S1.p3.1.1">automated proof optimization</span>: rewriting a proof so that it is correct and optimizes a criterion such as length or readability.
We find that naively applying LLMs to proof optimization falls short, often resulting in incorrect or poorly optimized proofs.
We develop various improvements that can be applied on top of a black-box language model, including Chain-of-States prompting–an analogy to chain-of-thought prompting <cite class="ltx_cite ltx_citemacro_citep">(Wei et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#bib.bib22" title="">2022</a>)</cite> that shows intermediate proof states–along with error-correction and retrieval.
We incorporate these into <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S1.p3.1.m1.1"><semantics id="S1.p3.1.m1.1a"><mi id="S1.p3.1.m1.1.1" xref="S1.p3.1.m1.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S1.p3.1.m1.1b"><ci id="S1.p3.1.m1.1.1.cmml" xref="S1.p3.1.m1.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.1.m1.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.1.m1.1d">roman_ImProver</annotation></semantics></math>: a large language model agent that rewrites proofs to optimize arbitrary user-defined metrics in Lean.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p4">
<p class="ltx_p" id="S1.p4.2">We test <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S1.p4.1.m1.1"><semantics id="S1.p4.1.m1.1a"><mi id="S1.p4.1.m1.1.1" xref="S1.p4.1.m1.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S1.p4.1.m1.1b"><ci id="S1.p4.1.m1.1.1.cmml" xref="S1.p4.1.m1.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.1.m1.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.1.m1.1d">roman_ImProver</annotation></semantics></math> on rewriting real-world undergraduate theorems, competition problems, and research-level mathematics, finding that <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S1.p4.2.m2.1"><semantics id="S1.p4.2.m2.1a"><mi id="S1.p4.2.m2.1.1" xref="S1.p4.2.m2.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S1.p4.2.m2.1b"><ci id="S1.p4.2.m2.1.1.cmml" xref="S1.p4.2.m2.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.2.m2.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.2.m2.1d">roman_ImProver</annotation></semantics></math> is capable of rewriting proofs so that they are substantially shorter, more readable, and more declarative in style.<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Code is available at <a class="ltx_ref ltx_href" href="https://github.com/riyazahuja/ImProver" title="">https://github.com/riyazahuja/ImProver</a>.</span></span></span></p>
</div>
<figure class="ltx_figure" id="S1.F1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_pagination ltx_figure_panel ltx_role_start_2_columns"></div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="S1.F1.8"><span class="ltx_text ltx_font_bold" id="S1.F1.8.1">Original (human-written)</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_listing ltx_figure_panel ltx_lst_language_lean ltx_lstlisting ltx_listing" id="S1.F1.9">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,bGVtbWEgbGVtbWEwIHvOsSA6IFR5cGV9IHtwIDogzrEg4oaSIM6xIOKGkiBQcm9wfQogICAgKGgxIDog4oiAIHgsIOKIgyEgeSwgcCB4IHkpCiAgICAoaDIgOiDiiIAgeCB5LCBwIHggeSDihpQgcCB5IHgpIDoKICAgIOKIgCB4LCBDbGFzc2ljYWwuY2hvb3NlCiAgICAgICAgKGgxIChDbGFzc2ljYWwuY2hvb3NlIChoMSB4KS5leGlzdHMpKS5leGlzdHM9eCA6PSBieQoKICAtLSBQUk9PRiBTVEFSVAogIGludHJvIHgKICBvYnRhaW4g4p+oeSwgaDFlLCBoMXXin6kgOj0gaDEgeAogIGhhdmUgaDInIDogQ2xhc3NpY2FsLmNob29zZSAoaDEgeCkuZXhpc3RzID0geSA6PQogICAgaDF1IF8gKENsYXNzaWNhbC5jaG9vc2Vfc3BlYyAoaDEgeCkuZXhpc3RzKQogIHJ3IFtoMiddCiAgb2J0YWluIOKfqHcsIGgxZScsIGgxdSfin6kgOj0gaDEgeQogIGhhdmUgaDQgOj0gQ2xhc3NpY2FsLmNob29zZV9zcGVjIChoMSB5KS5leGlzdHMKICBoYXZlIGh4dyA6IHggPSB3IDo9IGJ5CiAgICBhcHBseSBoMXUnCiAgICBydyBbaDJdCiAgICBleGFjdCBoMWUKICBydyBbaHh3XQogIGV4YWN0IGgxdScgXyBoNA==">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx1">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx1.1">lemma</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx1.2"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx1.3">lemma0</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx1.4"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx1.5">{α</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx1.6"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx1.7">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx1.8"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx1.9">Type</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx1.10">}</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx1.11"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx1.12">{</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx1.13">p</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx1.14"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx1.15">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx1.16"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx1.17">α</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx1.18"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx1.19">→</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx1.20"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx1.21">α</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx1.22"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx1.23">→</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx1.24"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx1.25">Prop</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx1.26">}</span>
</div>
<div class="ltx_listingline" id="lstnumberx2">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx2.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx2.2">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx2.3">h1</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx2.4"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx2.5">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx2.6"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx2.7">∀</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx2.8"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx2.9">x</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx2.10">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx2.11"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx2.12">∃!</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx2.13"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx2.14">y</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx2.15">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx2.16"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx2.17">p</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx2.18"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx2.19">x</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx2.20"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx2.21">y</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx2.22">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx3">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx3.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx3.2">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx3.3">h2</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx3.4"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx3.5">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx3.6"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx3.7">∀</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx3.8"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx3.9">x</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx3.10"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx3.11">y</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx3.12">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx3.13"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx3.14">p</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx3.15"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx3.16">x</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx3.17"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx3.18">y</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx3.19"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx3.20">↔</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx3.21"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx3.22">p</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx3.23"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx3.24">y</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx3.25"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx3.26">x</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx3.27">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx3.28"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx3.29">:</span>
</div>
<div class="ltx_listingline" id="lstnumberx4">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx4.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx4.2">∀</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx4.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx4.4">x</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx4.5">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx4.6"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx4.7">Classical</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx4.8">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx4.9">choose</span>
</div>
<div class="ltx_listingline" id="lstnumberx5">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx5.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx5.2">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx5.3">h1</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx5.4"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx5.5">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx5.6">Classical</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx5.7">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx5.8">choose</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx5.9"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx5.10">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx5.11">h1</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx5.12"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx5.13">x</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx5.14">).</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx5.15">exists</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx5.16">)).</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx5.17">exists</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx5.18">=</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx5.19">x</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx5.20"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx5.21">:=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx5.22"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx5.23">by</span>
</div>
<div class="ltx_listingline" id="lstnumberx6">
</div>
<div class="ltx_listingline" id="lstnumberx7">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx7.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx7.2">--</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx7.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx7.4">PROOF</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx7.5"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx7.6">START</span>
</div>
<div class="ltx_listingline" id="lstnumberx8">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx8.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx8.2">intro</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx8.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx8.4">x</span>
</div>
<div class="ltx_listingline" id="lstnumberx9">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx9.2">obtain</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx9.4">⟨</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx9.5">y</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx9.6">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.7"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx9.8">h1e</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx9.9">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.10"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx9.11">h1u</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx9.12">⟩</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.13"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx9.14">:=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.15"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx9.16">h1</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.17"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx9.18">x</span>
</div>
<div class="ltx_listingline" id="lstnumberx10">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx10.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx10.2">have</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx10.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx10.4">h2</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx10.5">’</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx10.6"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx10.7">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx10.8"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx10.9">Classical</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx10.10">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx10.11">choose</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx10.12"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx10.13">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx10.14">h1</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx10.15"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx10.16">x</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx10.17">).</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx10.18">exists</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx10.19"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx10.20">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx10.21"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx10.22">y</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx10.23"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx10.24">:=</span>
</div>
<div class="ltx_listingline" id="lstnumberx11">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx11.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx11.2">h1u</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx11.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx11.4">_</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx11.5"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx11.6">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx11.7">Classical</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx11.8">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx11.9">choose_spec</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx11.10"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx11.11">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx11.12">h1</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx11.13"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx11.14">x</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx11.15">).</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx11.16">exists</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx11.17">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx12">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx12.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx12.2">rw</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx12.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx12.4">[</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx12.5">h2</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx12.6">’]</span>
</div>
<div class="ltx_listingline" id="lstnumberx13">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx13.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx13.2">obtain</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx13.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx13.4">⟨</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx13.5">w</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx13.6">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx13.7"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx13.8">h1e</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx13.9">’,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx13.10"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx13.11">h1u</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx13.12">’⟩</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx13.13"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx13.14">:=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx13.15"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx13.16">h1</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx13.17"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx13.18">y</span>
</div>
<div class="ltx_listingline" id="lstnumberx14">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx14.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx14.2">have</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx14.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx14.4">h4</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx14.5"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx14.6">:=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx14.7"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx14.8">Classical</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx14.9">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx14.10">choose_spec</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx14.11"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx14.12">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx14.13">h1</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx14.14"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx14.15">y</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx14.16">).</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx14.17">exists</span>
</div>
<div class="ltx_listingline" id="lstnumberx15">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.2">have</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.4">hxw</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.5"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx15.6">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.7"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.8">x</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.9"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx15.10">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.11"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.12">w</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.13"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx15.14">:=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.15"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.16">by</span>
</div>
<div class="ltx_listingline" id="lstnumberx16">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx16.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx16.2">apply</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx16.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx16.4">h1u</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx16.5">’</span>
</div>
<div class="ltx_listingline" id="lstnumberx17">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.2">rw</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx17.4">[</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.5">h2</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx17.6">]</span>
</div>
<div class="ltx_listingline" id="lstnumberx18">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx18.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx18.2">exact</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx18.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx18.4">h1e</span>
</div>
<div class="ltx_listingline" id="lstnumberx19">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx19.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx19.2">rw</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx19.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx19.4">[</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx19.5">hxw</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx19.6">]</span>
</div>
<div class="ltx_listingline" id="lstnumberx20">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx20.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx20.2">exact</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx20.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx20.4">h1u</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx20.5">’</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx20.6"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx20.7">_</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx20.8"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx20.9">h4</span>
</div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="S1.F1.1"><span class="ltx_text" id="S1.F1.1.1"></span>
<math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S1.F1.1.m1.1"><semantics id="S1.F1.1.m1.1a"><mi id="S1.F1.1.m1.1.1" xref="S1.F1.1.m1.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S1.F1.1.m1.1b"><ci id="S1.F1.1.m1.1.1.cmml" xref="S1.F1.1.m1.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.1.m1.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.1.m1.1d">roman_ImProver</annotation></semantics></math><span class="ltx_text ltx_font_bold" id="S1.F1.1.2"> (length-optimized)</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_listing ltx_figure_panel ltx_lst_language_lean ltx_lstlisting ltx_listing" id="S1.F1.10">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,bGVtbWEgbGVtbWEwIHvOsSA6IFR5cGV9IHtwIDogzrEg4oaSIM6xIOKGkiBQcm9wfQogICAgKGgxIDog4oiAIHgsIOKIgyEgeSwgcCB4IHkpCiAgICAoaDIgOiDiiIAgeCB5LCBwIHggeSDihpQgcCB5IHgpIDoKICAgIOKIgCB4LCBDbGFzc2ljYWwuY2hvb3NlCiAgICAgICAgKGgxIChDbGFzc2ljYWwuY2hvb3NlIChoMSB4KS5leGlzdHMpKS5leGlzdHM9eCA6PSBieQoKICAtLSBQUk9PRiBTVEFSVAogIGludHJvIHgKICBvYnRhaW4g4p+oeSwgaDFlLCBoMXXin6kgOj0gaDEgeAogIHJ3IFtoMXUgXyAoQ2xhc3NpY2FsLmNob29zZV9zcGVjIF8pXQogIG9idGFpbiDin6h3LCBoMWUnLCBoMXUn4p+pIDo9IGgxIHkKICBydyBbaDF1JyBfICgoaDIgXyBfKS5tcHIgaDFlKV0KICBleGFjdCBoMXUnIF8gKENsYXNzaWNhbC5jaG9vc2Vfc3BlYyBfKQ==">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx21">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx21.1">lemma</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx21.2"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx21.3">lemma0</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx21.4"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx21.5">{α</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx21.6"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx21.7">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx21.8"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx21.9">Type</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx21.10">}</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx21.11"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx21.12">{</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx21.13">p</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx21.14"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx21.15">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx21.16"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx21.17">α</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx21.18"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx21.19">→</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx21.20"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx21.21">α</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx21.22"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx21.23">→</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx21.24"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx21.25">Prop</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx21.26">}</span>
</div>
<div class="ltx_listingline" id="lstnumberx22">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx22.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx22.2">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx22.3">h1</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx22.4"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx22.5">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx22.6"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx22.7">∀</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx22.8"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx22.9">x</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx22.10">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx22.11"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx22.12">∃!</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx22.13"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx22.14">y</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx22.15">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx22.16"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx22.17">p</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx22.18"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx22.19">x</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx22.20"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx22.21">y</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx22.22">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx23">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx23.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx23.2">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx23.3">h2</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx23.4"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx23.5">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx23.6"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx23.7">∀</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx23.8"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx23.9">x</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx23.10"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx23.11">y</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx23.12">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx23.13"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx23.14">p</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx23.15"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx23.16">x</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx23.17"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx23.18">y</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx23.19"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx23.20">↔</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx23.21"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx23.22">p</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx23.23"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx23.24">y</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx23.25"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx23.26">x</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx23.27">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx23.28"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx23.29">:</span>
</div>
<div class="ltx_listingline" id="lstnumberx24">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx24.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx24.2">∀</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx24.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx24.4">x</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx24.5">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx24.6"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx24.7">Classical</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx24.8">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx24.9">choose</span>
</div>
<div class="ltx_listingline" id="lstnumberx25">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx25.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx25.2">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx25.3">h1</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx25.4"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx25.5">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx25.6">Classical</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx25.7">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx25.8">choose</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx25.9"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx25.10">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx25.11">h1</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx25.12"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx25.13">x</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx25.14">).</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx25.15">exists</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx25.16">)).</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx25.17">exists</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx25.18">=</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx25.19">x</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx25.20"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx25.21">:=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx25.22"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx25.23">by</span>
</div>
<div class="ltx_listingline" id="lstnumberx26">
</div>
<div class="ltx_listingline" id="lstnumberx27">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx27.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx27.2">--</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx27.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx27.4">PROOF</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx27.5"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx27.6">START</span>
</div>
<div class="ltx_listingline" id="lstnumberx28">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx28.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx28.2">intro</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx28.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx28.4">x</span>
</div>
<div class="ltx_listingline" id="lstnumberx29">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.2">obtain</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx29.4">⟨</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.5">y</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx29.6">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.7"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.8">h1e</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx29.9">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.10"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.11">h1u</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx29.12">⟩</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.13"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx29.14">:=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.15"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.16">h1</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.17"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.18">x</span>
</div>
<div class="ltx_listingline" id="lstnumberx30">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.2">rw</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx30.4">[</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.5">h1u</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.6"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.7">_</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.8"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx30.9">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.10">Classical</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx30.11">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.12">choose_spec</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.13"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.14">_</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx30.15">)]</span>
</div>
<div class="ltx_listingline" id="lstnumberx31">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx31.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx31.2">obtain</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx31.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx31.4">⟨</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx31.5">w</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx31.6">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx31.7"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx31.8">h1e</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx31.9">’,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx31.10"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx31.11">h1u</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx31.12">’⟩</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx31.13"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx31.14">:=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx31.15"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx31.16">h1</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx31.17"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx31.18">y</span>
</div>
<div class="ltx_listingline" id="lstnumberx32">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx32.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx32.2">rw</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx32.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx32.4">[</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx32.5">h1u</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx32.6">’</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx32.7"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx32.8">_</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx32.9"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx32.10">((</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx32.11">h2</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx32.12"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx32.13">_</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx32.14"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx32.15">_</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx32.16">).</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx32.17">mpr</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx32.18"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx32.19">h1e</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx32.20">)]</span>
</div>
<div class="ltx_listingline" id="lstnumberx33">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx33.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx33.2">exact</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx33.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx33.4">h1u</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx33.5">’</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx33.6"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx33.7">_</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx33.8"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx33.9">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx33.10">Classical</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx33.11">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx33.12">choose_spec</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx33.13"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx33.14">_</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx33.15">)</span>
</div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_pagination ltx_figure_panel ltx_role_end_2_columns"></div>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1: </span><math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S1.F1.5.m1.1"><semantics id="S1.F1.5.m1.1b"><mi id="S1.F1.5.m1.1.1" xref="S1.F1.5.m1.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S1.F1.5.m1.1c"><ci id="S1.F1.5.m1.1.1.cmml" xref="S1.F1.5.m1.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.5.m1.1d">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.5.m1.1e">roman_ImProver</annotation></semantics></math> automatically rewrites formal proofs to optimize a criterion such as length or readability while remaining correct.
In this example, <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S1.F1.6.m2.1"><semantics id="S1.F1.6.m2.1b"><mi id="S1.F1.6.m2.1.1" xref="S1.F1.6.m2.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S1.F1.6.m2.1c"><ci id="S1.F1.6.m2.1.1.cmml" xref="S1.F1.6.m2.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.6.m2.1d">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.6.m2.1e">roman_ImProver</annotation></semantics></math> optimizes a human-written lemma (right) from the 2022 International Math Olympiad (Question 2, solution from Compfiles <cite class="ltx_cite ltx_citemacro_citep">(David Renshaw, <a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#bib.bib5" title="">2024</a>)</cite>) for length.
<math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S1.F1.7.m3.1"><semantics id="S1.F1.7.m3.1b"><mi id="S1.F1.7.m3.1.1" xref="S1.F1.7.m3.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S1.F1.7.m3.1c"><ci id="S1.F1.7.m3.1.1.cmml" xref="S1.F1.7.m3.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.7.m3.1d">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.7.m3.1e">roman_ImProver</annotation></semantics></math>’s optimized proof is correct and more concise.</figcaption>
</figure>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related work</h2>
<div class="ltx_para ltx_noindent" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">Recently there has been wide interest in automating theorem proving in interactive proof assistants; see <cite class="ltx_cite ltx_citemacro_citep">(Lu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#bib.bib14" title="">2023</a>; Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#bib.bib13" title="">2024</a>)</cite> for surveys.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p2">
<p class="ltx_p" id="S2.p2.2">A typical approach <cite class="ltx_cite ltx_citemacro_citep">(Polu &amp; Sutskever, <a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#bib.bib19" title="">2020</a>)</cite> is to train on a large corpus of mathematical proofs such as Lean’s Mathlib <cite class="ltx_cite ltx_citemacro_citep">(mathlib Community, <a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#bib.bib16" title="">2020</a>; Han et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#bib.bib7" title="">2022</a>; Polu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#bib.bib20" title="">2022</a>; Lample et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#bib.bib11" title="">2022</a>; Yang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#bib.bib24" title="">2023</a>; Hu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#bib.bib8" title="">2024</a>)</cite>.
A model learns from the distribution of proofs in the corpus, such as Mathlib-style proofs.
Recently, the AlphaProof <cite class="ltx_cite ltx_citemacro_citep">(AlphaProof &amp; Teams, <a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#bib.bib1" title="">2024</a>)</cite> system was shown to produce proofs with an arcane, non-human structure and syntax.
We consider the new problem of rewriting a proof to optimize a metric, such as rewriting a proof into a more readable or more concise one.
Proof optimization is more general than theorem proving, since we can also rewrite an empty proof to optimize correctness.
Finally, there is a rich literature on the varied styles of (human) formal proofs (e.g., <cite class="ltx_cite ltx_citemacro_citep">(Autexier &amp; Dietrich, <a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#bib.bib2" title="">2010</a>; Wiedijk, <a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#bib.bib23" title="">2004</a>)</cite>).
Our model, <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S2.p2.1.m1.1"><semantics id="S2.p2.1.m1.1a"><mi id="S2.p2.1.m1.1.1" xref="S2.p2.1.m1.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.1b"><ci id="S2.p2.1.m1.1.1.cmml" xref="S2.p2.1.m1.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.1.m1.1d">roman_ImProver</annotation></semantics></math>, builds on neural theorem proving techniques including full proof generation <cite class="ltx_cite ltx_citemacro_citep">(Jiang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#bib.bib9" title="">2023</a>; First et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#bib.bib6" title="">2023</a>)</cite>, conditioning on example proofs <cite class="ltx_cite ltx_citemacro_citep">(Jiang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#bib.bib9" title="">2023</a>)</cite>, retrieval <cite class="ltx_cite ltx_citemacro_citep">(Yang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#bib.bib24" title="">2023</a>; Thakur et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#bib.bib21" title="">2024</a>)</cite>, and preceding file context <cite class="ltx_cite ltx_citemacro_citep">(First et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#bib.bib6" title="">2023</a>; Hu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#bib.bib8" title="">2024</a>)</cite>, as well as error correction <cite class="ltx_cite ltx_citemacro_citep">(Madaan et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#bib.bib15" title="">2023</a>; Chen et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#bib.bib4" title="">2023</a>)</cite> and documentation retrieval <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#bib.bib25" title="">2023</a>)</cite> from code generation.
<math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S2.p2.2.m2.1"><semantics id="S2.p2.2.m2.1a"><mi id="S2.p2.2.m2.1.1" xref="S2.p2.2.m2.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S2.p2.2.m2.1b"><ci id="S2.p2.2.m2.1.1.cmml" xref="S2.p2.2.m2.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.2.m2.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.2.m2.1d">roman_ImProver</annotation></semantics></math> brings these code generation techniques, along with new Chain-of-States prompting and meta-programmed contextual information, into a unified proof optimization agent.</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Automated Proof Optimization with <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S3.1.m1.1"><semantics id="S3.1.m1.1b"><mi id="S3.1.m1.1.1" xref="S3.1.m1.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S3.1.m1.1c"><ci id="S3.1.m1.1.1.cmml" xref="S3.1.m1.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.1.m1.1d">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S3.1.m1.1e">roman_ImProver</annotation></semantics></math>
</h2>
<section class="ltx_paragraph" id="S3.SS0.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Automated Proof Optimization.</h5>
<div class="ltx_para ltx_noindent" id="S3.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS0.SSS0.Px1.p1.5">Given a theorem statement <math alttext="x" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px1.p1.1.m1.1"><semantics id="S3.SS0.SSS0.Px1.p1.1.m1.1a"><mi id="S3.SS0.SSS0.Px1.p1.1.m1.1.1" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.1.m1.1b"><ci id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.p1.1.m1.1d">italic_x</annotation></semantics></math>, additional context <math alttext="c" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px1.p1.2.m2.1"><semantics id="S3.SS0.SSS0.Px1.p1.2.m2.1a"><mi id="S3.SS0.SSS0.Px1.p1.2.m2.1.1" xref="S3.SS0.SSS0.Px1.p1.2.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.2.m2.1b"><ci id="S3.SS0.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.2.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.2.m2.1c">c</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.p1.2.m2.1d">italic_c</annotation></semantics></math>, and an initial proof <math alttext="y_{0}" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px1.p1.3.m3.1"><semantics id="S3.SS0.SSS0.Px1.p1.3.m3.1a"><msub id="S3.SS0.SSS0.Px1.p1.3.m3.1.1" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1.cmml"><mi id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.2" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1.2.cmml">y</mi><mn id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.3" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.3.m3.1b"><apply id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1.2">𝑦</ci><cn id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.3.cmml" type="integer" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.3.m3.1c">y_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.p1.3.m3.1d">italic_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>, proof optimization consists of generating a new proof <math alttext="y" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px1.p1.4.m4.1"><semantics id="S3.SS0.SSS0.Px1.p1.4.m4.1a"><mi id="S3.SS0.SSS0.Px1.p1.4.m4.1.1" xref="S3.SS0.SSS0.Px1.p1.4.m4.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.4.m4.1b"><ci id="S3.SS0.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.4.m4.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.4.m4.1c">y</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.p1.4.m4.1d">italic_y</annotation></semantics></math> that is correct and minimizes (or maximizes) a metric <math alttext="\mu(x,c,y_{0},y)\rightarrow\mathbb{R}" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px1.p1.5.m5.4"><semantics id="S3.SS0.SSS0.Px1.p1.5.m5.4a"><mrow id="S3.SS0.SSS0.Px1.p1.5.m5.4.4" xref="S3.SS0.SSS0.Px1.p1.5.m5.4.4.cmml"><mrow id="S3.SS0.SSS0.Px1.p1.5.m5.4.4.1" xref="S3.SS0.SSS0.Px1.p1.5.m5.4.4.1.cmml"><mi id="S3.SS0.SSS0.Px1.p1.5.m5.4.4.1.3" xref="S3.SS0.SSS0.Px1.p1.5.m5.4.4.1.3.cmml">μ</mi><mo id="S3.SS0.SSS0.Px1.p1.5.m5.4.4.1.2" xref="S3.SS0.SSS0.Px1.p1.5.m5.4.4.1.2.cmml">⁢</mo><mrow id="S3.SS0.SSS0.Px1.p1.5.m5.4.4.1.1.1" xref="S3.SS0.SSS0.Px1.p1.5.m5.4.4.1.1.2.cmml"><mo id="S3.SS0.SSS0.Px1.p1.5.m5.4.4.1.1.1.2" stretchy="false" xref="S3.SS0.SSS0.Px1.p1.5.m5.4.4.1.1.2.cmml">(</mo><mi id="S3.SS0.SSS0.Px1.p1.5.m5.1.1" xref="S3.SS0.SSS0.Px1.p1.5.m5.1.1.cmml">x</mi><mo id="S3.SS0.SSS0.Px1.p1.5.m5.4.4.1.1.1.3" xref="S3.SS0.SSS0.Px1.p1.5.m5.4.4.1.1.2.cmml">,</mo><mi id="S3.SS0.SSS0.Px1.p1.5.m5.2.2" xref="S3.SS0.SSS0.Px1.p1.5.m5.2.2.cmml">c</mi><mo id="S3.SS0.SSS0.Px1.p1.5.m5.4.4.1.1.1.4" xref="S3.SS0.SSS0.Px1.p1.5.m5.4.4.1.1.2.cmml">,</mo><msub id="S3.SS0.SSS0.Px1.p1.5.m5.4.4.1.1.1.1" xref="S3.SS0.SSS0.Px1.p1.5.m5.4.4.1.1.1.1.cmml"><mi id="S3.SS0.SSS0.Px1.p1.5.m5.4.4.1.1.1.1.2" xref="S3.SS0.SSS0.Px1.p1.5.m5.4.4.1.1.1.1.2.cmml">y</mi><mn id="S3.SS0.SSS0.Px1.p1.5.m5.4.4.1.1.1.1.3" xref="S3.SS0.SSS0.Px1.p1.5.m5.4.4.1.1.1.1.3.cmml">0</mn></msub><mo id="S3.SS0.SSS0.Px1.p1.5.m5.4.4.1.1.1.5" xref="S3.SS0.SSS0.Px1.p1.5.m5.4.4.1.1.2.cmml">,</mo><mi id="S3.SS0.SSS0.Px1.p1.5.m5.3.3" xref="S3.SS0.SSS0.Px1.p1.5.m5.3.3.cmml">y</mi><mo id="S3.SS0.SSS0.Px1.p1.5.m5.4.4.1.1.1.6" stretchy="false" xref="S3.SS0.SSS0.Px1.p1.5.m5.4.4.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.SS0.SSS0.Px1.p1.5.m5.4.4.2" stretchy="false" xref="S3.SS0.SSS0.Px1.p1.5.m5.4.4.2.cmml">→</mo><mi id="S3.SS0.SSS0.Px1.p1.5.m5.4.4.3" xref="S3.SS0.SSS0.Px1.p1.5.m5.4.4.3.cmml">ℝ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.5.m5.4b"><apply id="S3.SS0.SSS0.Px1.p1.5.m5.4.4.cmml" xref="S3.SS0.SSS0.Px1.p1.5.m5.4.4"><ci id="S3.SS0.SSS0.Px1.p1.5.m5.4.4.2.cmml" xref="S3.SS0.SSS0.Px1.p1.5.m5.4.4.2">→</ci><apply id="S3.SS0.SSS0.Px1.p1.5.m5.4.4.1.cmml" xref="S3.SS0.SSS0.Px1.p1.5.m5.4.4.1"><times id="S3.SS0.SSS0.Px1.p1.5.m5.4.4.1.2.cmml" xref="S3.SS0.SSS0.Px1.p1.5.m5.4.4.1.2"></times><ci id="S3.SS0.SSS0.Px1.p1.5.m5.4.4.1.3.cmml" xref="S3.SS0.SSS0.Px1.p1.5.m5.4.4.1.3">𝜇</ci><vector id="S3.SS0.SSS0.Px1.p1.5.m5.4.4.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p1.5.m5.4.4.1.1.1"><ci id="S3.SS0.SSS0.Px1.p1.5.m5.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.5.m5.1.1">𝑥</ci><ci id="S3.SS0.SSS0.Px1.p1.5.m5.2.2.cmml" xref="S3.SS0.SSS0.Px1.p1.5.m5.2.2">𝑐</ci><apply id="S3.SS0.SSS0.Px1.p1.5.m5.4.4.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.5.m5.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p1.5.m5.4.4.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.5.m5.4.4.1.1.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p1.5.m5.4.4.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p1.5.m5.4.4.1.1.1.1.2">𝑦</ci><cn id="S3.SS0.SSS0.Px1.p1.5.m5.4.4.1.1.1.1.3.cmml" type="integer" xref="S3.SS0.SSS0.Px1.p1.5.m5.4.4.1.1.1.1.3">0</cn></apply><ci id="S3.SS0.SSS0.Px1.p1.5.m5.3.3.cmml" xref="S3.SS0.SSS0.Px1.p1.5.m5.3.3">𝑦</ci></vector></apply><ci id="S3.SS0.SSS0.Px1.p1.5.m5.4.4.3.cmml" xref="S3.SS0.SSS0.Px1.p1.5.m5.4.4.3">ℝ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.5.m5.4c">\mu(x,c,y_{0},y)\rightarrow\mathbb{R}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.p1.5.m5.4d">italic_μ ( italic_x , italic_c , italic_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_y ) → blackboard_R</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS0.SSS0.Px1.p2">
<p class="ltx_p" id="S3.SS0.SSS0.Px1.p2.1">By varying the metric, we can perform tasks such as shortening proofs, making them more readable, or even automated proving.
We consider 3 metrics:</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS0.SSS0.Px1.p3">
<p class="ltx_p" id="S3.SS0.SSS0.Px1.p3.1"><span class="ltx_text ltx_font_bold" id="S3.SS0.SSS0.Px1.p3.1.1">Length Metric:</span> The length metric measures the number of tactic invocations in the tactic proof, aiming to reduce the proof’s length while ensuring its correctness. Note that shorter proofs often represent more efficient proofs.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS0.SSS0.Px1.p4">
<p class="ltx_p" id="S3.SS0.SSS0.Px1.p4.1"><span class="ltx_text ltx_font_bold" id="S3.SS0.SSS0.Px1.p4.1.1">Readability Metric:</span> We consider a proof to be readable if it is written in a declarative style <cite class="ltx_cite ltx_citemacro_citep">(Autexier &amp; Dietrich, <a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#bib.bib2" title="">2010</a>; Wiedijk, <a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#bib.bib23" title="">2004</a>)</cite>, which is related to the number of independent subproofs in a proof. Concretely, we evaluate this using the ratio of number of explicitly typed <span class="ltx_text ltx_font_typewriter" id="S3.SS0.SSS0.Px1.p4.1.2">have</span> tactics to total number of tactic invocations.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS0.SSS0.Px1.p5">
<p class="ltx_p" id="S3.SS0.SSS0.Px1.p5.1"><span class="ltx_text ltx_font_bold" id="S3.SS0.SSS0.Px1.p5.1.1">Completion Metric:</span> The completion of a proof simply describes its correctness. This is a trivial metric which measures the number of errors present. The completion metric is used for concretely viewing proof optimization as a generalization of neural theorem proving.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Improver</h3>
<div class="ltx_para ltx_noindent" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.2">We develop several improvements that can be applied to a black-box LLM generator <math alttext="y_{out}\sim G(\cdot|x_{in})" class="ltx_math_unparsed" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mrow id="S3.SS1.p1.1.m1.1b"><msub id="S3.SS1.p1.1.m1.1.1"><mi id="S3.SS1.p1.1.m1.1.1.2">y</mi><mrow id="S3.SS1.p1.1.m1.1.1.3"><mi id="S3.SS1.p1.1.m1.1.1.3.2">o</mi><mo id="S3.SS1.p1.1.m1.1.1.3.1">⁢</mo><mi id="S3.SS1.p1.1.m1.1.1.3.3">u</mi><mo id="S3.SS1.p1.1.m1.1.1.3.1a">⁢</mo><mi id="S3.SS1.p1.1.m1.1.1.3.4">t</mi></mrow></msub><mo id="S3.SS1.p1.1.m1.1.2">∼</mo><mi id="S3.SS1.p1.1.m1.1.3">G</mi><mrow id="S3.SS1.p1.1.m1.1.4"><mo id="S3.SS1.p1.1.m1.1.4.1" stretchy="false">(</mo><mo id="S3.SS1.p1.1.m1.1.4.2" lspace="0em" rspace="0em">⋅</mo><mo fence="false" id="S3.SS1.p1.1.m1.1.4.3" rspace="0.167em" stretchy="false">|</mo><msub id="S3.SS1.p1.1.m1.1.4.4"><mi id="S3.SS1.p1.1.m1.1.4.4.2">x</mi><mrow id="S3.SS1.p1.1.m1.1.4.4.3"><mi id="S3.SS1.p1.1.m1.1.4.4.3.2">i</mi><mo id="S3.SS1.p1.1.m1.1.4.4.3.1">⁢</mo><mi id="S3.SS1.p1.1.m1.1.4.4.3.3">n</mi></mrow></msub><mo id="S3.SS1.p1.1.m1.1.4.5" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">y_{out}\sim G(\cdot|x_{in})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">italic_y start_POSTSUBSCRIPT italic_o italic_u italic_t end_POSTSUBSCRIPT ∼ italic_G ( ⋅ | italic_x start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT )</annotation></semantics></math>, such as GPT-4 <cite class="ltx_cite ltx_citemacro_citep">(OpenAI et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#bib.bib18" title="">2024</a>)</cite>, and specify <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">roman_ImProver</annotation></semantics></math> with respect to these parameters. The explicit prompts and templates that are sent to the LLM can be found in (§<a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#A1" title="Appendix A Prompts ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_tag">A</span></a>).</p>
</div>
<section class="ltx_subsubsection" id="S3.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.1 </span>Chain-of-States Prompting</h4>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS1.p1">
<p class="ltx_p" id="S3.SS1.SSS1.p1.1">Typical formal proofs are a sequence of tactics (akin to steps) and <span class="ltx_text ltx_font_italic" id="S3.SS1.SSS1.p1.1.1">states</span> that show the hypotheses and goals at each step.
The intermediate states often contain valuable information (e.g., an expression after it has been simplified) that is not present in the tactics. To allow the model to reason about these intermediate goals and hypotheses, we use tools from Lean metaprogramming to automatically annotate each proof state as a comment prior to each tactic.
We refer to this method as <span class="ltx_text ltx_font_italic" id="S3.SS1.SSS1.p1.1.2">Chain-of-States</span> (CoS) prompting since it makes intermediate states explicit, akin to how chain-of-thought prompting <cite class="ltx_cite ltx_citemacro_citep">(Wei et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#bib.bib22" title="">2022</a>)</cite> makes intermediate steps of a solution explicit.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS1.p2">
<p class="ltx_p" id="S3.SS1.SSS1.p2.1">These states are extracted directly and symbolically from the underlying Lean compilation steps using Lean’s rich metaprogramming suite. The implementation of this extraction system is modeled from the work <cite class="ltx_cite ltx_citemacro_citep">(Kim Morrison, <a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#bib.bib10" title="">2024</a>)</cite>. Specifically, in the compiler’s elaboration and evaluation stages – where the parsed theorem code is first converted into concrete syntax trees (in practice, <span class="ltx_text ltx_font_typewriter" id="S3.SS1.SSS1.p2.1.1">Syntax</span> objects) and abstract syntax trees (<span class="ltx_text ltx_font_typewriter" id="S3.SS1.SSS1.p2.1.2">Expr</span> objects) – we convert the CST and AST output objects into the relevant proof data and proof states in the form of proof trees (<span class="ltx_text ltx_font_typewriter" id="S3.SS1.SSS1.p2.1.3">Lean.Elab.InfoTree</span>). These proof trees contain detailed context and information on a tactic-by-tactic level relating to the modification of the proof state, metavariable context, and proof correctness.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS1.p3">
<p class="ltx_p" id="S3.SS1.SSS1.p3.1">After state extraction is completed and cached for efficient future access, we annotate the proof text itself to contain the intermediate states in the form as comments.
<a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2410.04753v1#S3.F2" title="Figure 2 ‣ 3.1.1 Chain-of-States Prompting ‣ 3.1 Improver ‣ 3 Automated Proof Optimization with ImProver ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_tag">Figure 2</span></a> shows an example.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS1.p4">
<p class="ltx_p" id="S3.SS1.SSS1.p4.1">This explicit reasoning aims to help the generator model construct more optimized proofs via additional symbolic data.</p>
</div>
<figure class="ltx_figure" id="S3.F2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_pagination ltx_figure_panel ltx_role_start_2_columns"></div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="S3.F2.1"><span class="ltx_text ltx_font_bold" id="S3.F2.1.1">Without Chain-of-States</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_listing ltx_figure_panel ltx_lst_language_lean ltx_lstlisting ltx_listing" id="S3.F2.2">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,ZXhhbXBsZSA6IHMg4oipIHQg4oiqIHMg4oipIHUg4oqGIHMg4oipICh0IOKIqiB1KSAgOj0gYnkKICByaW50cm8geCAo4p+oeHMsIHh04p+pIHwg4p+oeHMsIHh14p+pKQogIMK3IHVzZSB4czsgbGVmdDsgZXhhY3QgeHQKICAuIHVzZSB4czsgcmlnaHQ7IGV4YWN0IHh1">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx34">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx34.1">example</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx34.2"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx34.3">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx34.4"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx34.5">s</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx34.6"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx34.7">∩</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx34.8"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx34.9">t</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx34.10"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx34.11">∪</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx34.12"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx34.13">s</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx34.14"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx34.15">∩</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx34.16"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx34.17">u</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx34.18"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx34.19">⊆</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx34.20"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx34.21">s</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx34.22"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx34.23">∩</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx34.24"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx34.25">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx34.26">t</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx34.27"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx34.28">∪</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx34.29"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx34.30">u</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx34.31">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx34.32"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx34.33">:=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx34.34"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx34.35">by</span>
</div>
<div class="ltx_listingline" id="lstnumberx35">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx35.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx35.2">rintro</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx35.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx35.4">x</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx35.5"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx35.6">(⟨</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx35.7">xs</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx35.8">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx35.9"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx35.10">xt</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx35.11">⟩</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx35.12"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx35.13">|</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx35.14"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx35.15">⟨</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx35.16">xs</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx35.17">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx35.18"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx35.19">xu</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx35.20">⟩)</span>
</div>
<div class="ltx_listingline" id="lstnumberx36">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx36.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx36.2">·</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx36.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx36.4">use</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx36.5"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx36.6">xs</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx36.7">;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx36.8"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx36.9">left</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx36.10">;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx36.11"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx36.12">exact</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx36.13"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx36.14">xt</span>
</div>
<div class="ltx_listingline" id="lstnumberx37">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx37.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx37.2">.</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx37.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx37.4">use</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx37.5"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx37.6">xs</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx37.7">;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx37.8"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx37.9">right</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx37.10">;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx37.11"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx37.12">exact</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx37.13"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx37.14">xu</span>
</div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="S3.F2.3"><span class="ltx_text" id="S3.F2.3.1"></span>
<span class="ltx_text ltx_font_bold" id="S3.F2.3.2">With Chain-of-States</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_listing ltx_figure_panel ltx_lst_language_lean ltx_lstlisting ltx_listing" id="S3.F2.4">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,ZXhhbXBsZSA6IHMg4oipIHQg4oiqIHMg4oipIHUg4oqGIHMg4oipICh0IOKIqiB1KSAgOj0gYnkKICByaW50cm8geCAo4p+oeHMsIHh04p+pIHwg4p+oeHMsIHh14p+pKQogIC8tCiAgY2FzZSBpbmwuaW50cm8KICDOsSA6IFR5cGUgdV8xCiAgcyB0IHUgOiBTZXQgzrEKICB4IDogzrEKICB4cyA6IHgg4oiIIHMKICB4dCA6IHgg4oiIIHQKICDiiqIgeCDiiIggcyDiiKkgKHQg4oiqIHUpCiAgY2FzZSBpbnIuaW50cm8KICDOsSA6IFR5cGUgdV8xCiAgcyB0IHUgOiBTZXQgzrEKICB4IDogzrEKICB4cyA6IHgg4oiIIHMKICB4dSA6IHgg4oiIIHUKICDiiqIgeCDiiIggcyDiiKkgKHQg4oiqIHUpCiAgLS8KICDCtyB1c2UgeHM7IGxlZnQ7IGV4YWN0IHh0CiAgLy0KICBHb2FscyBTb2x2ZWQhCiAgLS8KICAuIHVzZSB4czsgcmlnaHQ7IGV4YWN0IHh1CiAgLy0KICBHb2FscyBTb2x2ZWQhCiAgLS8=">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx38">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx38.1">example</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx38.2"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx38.3">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx38.4"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx38.5">s</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx38.6"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx38.7">∩</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx38.8"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx38.9">t</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx38.10"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx38.11">∪</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx38.12"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx38.13">s</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx38.14"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx38.15">∩</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx38.16"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx38.17">u</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx38.18"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx38.19">⊆</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx38.20"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx38.21">s</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx38.22"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx38.23">∩</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx38.24"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx38.25">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx38.26">t</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx38.27"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx38.28">∪</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx38.29"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx38.30">u</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx38.31">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx38.32"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx38.33">:=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx38.34"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx38.35">by</span>
</div>
<div class="ltx_listingline" id="lstnumberx39">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx39.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx39.2">rintro</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx39.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx39.4">x</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx39.5"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx39.6">(⟨</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx39.7">xs</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx39.8">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx39.9"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx39.10">xt</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx39.11">⟩</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx39.12"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx39.13">|</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx39.14"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx39.15">⟨</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx39.16">xs</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx39.17">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx39.18"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx39.19">xu</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx39.20">⟩)</span>
</div>
<div class="ltx_listingline" id="lstnumberx40">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx40.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx40.2">/-</span>
</div>
<div class="ltx_listingline" id="lstnumberx41">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx41.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx41.2">case</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx41.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx41.4">inl</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx41.5">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx41.6">intro</span>
</div>
<div class="ltx_listingline" id="lstnumberx42">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx42.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx42.2">α</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx42.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx42.4">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx42.5"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx42.6">Type</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx42.7"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx42.8">u_1</span>
</div>
<div class="ltx_listingline" id="lstnumberx43">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx43.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx43.2">s</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx43.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx43.4">t</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx43.5"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx43.6">u</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx43.7"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx43.8">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx43.9"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx43.10">Set</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx43.11"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx43.12">α</span>
</div>
<div class="ltx_listingline" id="lstnumberx44">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx44.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx44.2">x</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx44.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx44.4">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx44.5"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx44.6">α</span>
</div>
<div class="ltx_listingline" id="lstnumberx45">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx45.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx45.2">xs</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx45.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx45.4">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx45.5"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx45.6">x</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx45.7"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx45.8">∈</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx45.9"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx45.10">s</span>
</div>
<div class="ltx_listingline" id="lstnumberx46">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx46.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx46.2">xt</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx46.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx46.4">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx46.5"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx46.6">x</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx46.7"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx46.8">∈</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx46.9"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx46.10">t</span>
</div>
<div class="ltx_listingline" id="lstnumberx47">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx47.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx47.2">⊢</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx47.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx47.4">x</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx47.5"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx47.6">∈</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx47.7"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx47.8">s</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx47.9"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx47.10">∩</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx47.11"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx47.12">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx47.13">t</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx47.14"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx47.15">∪</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx47.16"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx47.17">u</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx47.18">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx48">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx48.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx48.2">case</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx48.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx48.4">inr</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx48.5">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx48.6">intro</span>
</div>
<div class="ltx_listingline" id="lstnumberx49">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx49.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx49.2">α</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx49.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx49.4">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx49.5"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx49.6">Type</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx49.7"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx49.8">u_1</span>
</div>
<div class="ltx_listingline" id="lstnumberx50">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx50.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx50.2">s</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx50.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx50.4">t</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx50.5"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx50.6">u</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx50.7"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx50.8">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx50.9"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx50.10">Set</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx50.11"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx50.12">α</span>
</div>
<div class="ltx_listingline" id="lstnumberx51">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx51.2">x</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx51.4">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.5"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx51.6">α</span>
</div>
<div class="ltx_listingline" id="lstnumberx52">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx52.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx52.2">xs</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx52.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx52.4">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx52.5"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx52.6">x</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx52.7"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx52.8">∈</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx52.9"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx52.10">s</span>
</div>
<div class="ltx_listingline" id="lstnumberx53">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx53.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx53.2">xu</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx53.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx53.4">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx53.5"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx53.6">x</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx53.7"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx53.8">∈</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx53.9"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx53.10">u</span>
</div>
<div class="ltx_listingline" id="lstnumberx54">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx54.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx54.2">⊢</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx54.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx54.4">x</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx54.5"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx54.6">∈</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx54.7"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx54.8">s</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx54.9"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx54.10">∩</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx54.11"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx54.12">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx54.13">t</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx54.14"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx54.15">∪</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx54.16"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx54.17">u</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx54.18">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx55">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx55.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx55.2">-/</span>
</div>
<div class="ltx_listingline" id="lstnumberx56">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx56.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx56.2">·</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx56.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx56.4">use</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx56.5"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx56.6">xs</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx56.7">;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx56.8"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx56.9">left</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx56.10">;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx56.11"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx56.12">exact</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx56.13"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx56.14">xt</span>
</div>
<div class="ltx_listingline" id="lstnumberx57">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx57.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx57.2">/-</span>
</div>
<div class="ltx_listingline" id="lstnumberx58">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx58.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx58.2">Goals</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx58.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx58.4">Solved</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx58.5">!</span>
</div>
<div class="ltx_listingline" id="lstnumberx59">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx59.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx59.2">-/</span>
</div>
<div class="ltx_listingline" id="lstnumberx60">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx60.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx60.2">.</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx60.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx60.4">use</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx60.5"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx60.6">xs</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx60.7">;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx60.8"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx60.9">right</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx60.10">;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx60.11"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx60.12">exact</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx60.13"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx60.14">xu</span>
</div>
<div class="ltx_listingline" id="lstnumberx61">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx61.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx61.2">/-</span>
</div>
<div class="ltx_listingline" id="lstnumberx62">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx62.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx62.2">Goals</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx62.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx62.4">Solved</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx62.5">!</span>
</div>
<div class="ltx_listingline" id="lstnumberx63">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx63.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx63.2">-/</span>
</div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_pagination ltx_figure_panel ltx_role_end_2_columns"></div>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>A Lean proof (left) with Chain-of-States prompting annotations (right).</figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S3.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.2 </span>Output formatting.</h4>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS2.p1">
<p class="ltx_p" id="S3.SS1.SSS2.p1.1">LLM outputs often contain ancillary and syntactically invalid content, especially before and after the actual proof. Additionally, by applying additional structure to the LLM outputs, we may hope to generate more structured proofs. To analyze this hypothesis, we introduce two additional output formats to the standard <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.SSS2.p1.1.1">str</code> output: <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.SSS2.p1.1.2">flat</code> and <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.SSS2.p1.1.3">structured</code>. The former enforces a tactic sequence output as a list of strings, and the latter enforces a proof tree output as a tree of strings.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS1.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.3 </span>Sampling Method</h4>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS3.p1">
<p class="ltx_p" id="S3.SS1.SSS3.p1.1">We also introduce different methods of sampling between many (sequential or parallel) LLM inference calls, involving best-of-n and iterative refinement implementations, as well as combinations thereof.</p>
</div>
<section class="ltx_paragraph" id="S3.SS1.SSS3.Px1">
<h5 class="ltx_title ltx_title_paragraph">Best-of-n</h5>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS3.Px1.p1">
<p class="ltx_p" id="S3.SS1.SSS3.Px1.p1.4">The best-of-n technique generates multiple (<math alttext="n" class="ltx_Math" display="inline" id="S3.SS1.SSS3.Px1.p1.1.m1.1"><semantics id="S3.SS1.SSS3.Px1.p1.1.m1.1a"><mi id="S3.SS1.SSS3.Px1.p1.1.m1.1.1" xref="S3.SS1.SSS3.Px1.p1.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.Px1.p1.1.m1.1b"><ci id="S3.SS1.SSS3.Px1.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS3.Px1.p1.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.Px1.p1.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.Px1.p1.1.m1.1d">italic_n</annotation></semantics></math>) calls to the language model and selects the “best” via a simple selection policy that first prioritizes output correctness, and secondly prioritizes the evaluated metric delta score. More specifically, our scoring function is given by the <math alttext="2" class="ltx_Math" display="inline" id="S3.SS1.SSS3.Px1.p1.2.m2.1"><semantics id="S3.SS1.SSS3.Px1.p1.2.m2.1a"><mn id="S3.SS1.SSS3.Px1.p1.2.m2.1.1" xref="S3.SS1.SSS3.Px1.p1.2.m2.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.Px1.p1.2.m2.1b"><cn id="S3.SS1.SSS3.Px1.p1.2.m2.1.1.cmml" type="integer" xref="S3.SS1.SSS3.Px1.p1.2.m2.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.Px1.p1.2.m2.1c">2</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.Px1.p1.2.m2.1d">2</annotation></semantics></math>-ary comparison function <math alttext="S" class="ltx_Math" display="inline" id="S3.SS1.SSS3.Px1.p1.3.m3.1"><semantics id="S3.SS1.SSS3.Px1.p1.3.m3.1a"><mi id="S3.SS1.SSS3.Px1.p1.3.m3.1.1" xref="S3.SS1.SSS3.Px1.p1.3.m3.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.Px1.p1.3.m3.1b"><ci id="S3.SS1.SSS3.Px1.p1.3.m3.1.1.cmml" xref="S3.SS1.SSS3.Px1.p1.3.m3.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.Px1.p1.3.m3.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.Px1.p1.3.m3.1d">italic_S</annotation></semantics></math>, whose arguments are output objects <math alttext="y,y^{\prime}" class="ltx_Math" display="inline" id="S3.SS1.SSS3.Px1.p1.4.m4.2"><semantics id="S3.SS1.SSS3.Px1.p1.4.m4.2a"><mrow id="S3.SS1.SSS3.Px1.p1.4.m4.2.2.1" xref="S3.SS1.SSS3.Px1.p1.4.m4.2.2.2.cmml"><mi id="S3.SS1.SSS3.Px1.p1.4.m4.1.1" xref="S3.SS1.SSS3.Px1.p1.4.m4.1.1.cmml">y</mi><mo id="S3.SS1.SSS3.Px1.p1.4.m4.2.2.1.2" xref="S3.SS1.SSS3.Px1.p1.4.m4.2.2.2.cmml">,</mo><msup id="S3.SS1.SSS3.Px1.p1.4.m4.2.2.1.1" xref="S3.SS1.SSS3.Px1.p1.4.m4.2.2.1.1.cmml"><mi id="S3.SS1.SSS3.Px1.p1.4.m4.2.2.1.1.2" xref="S3.SS1.SSS3.Px1.p1.4.m4.2.2.1.1.2.cmml">y</mi><mo id="S3.SS1.SSS3.Px1.p1.4.m4.2.2.1.1.3" xref="S3.SS1.SSS3.Px1.p1.4.m4.2.2.1.1.3.cmml">′</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.Px1.p1.4.m4.2b"><list id="S3.SS1.SSS3.Px1.p1.4.m4.2.2.2.cmml" xref="S3.SS1.SSS3.Px1.p1.4.m4.2.2.1"><ci id="S3.SS1.SSS3.Px1.p1.4.m4.1.1.cmml" xref="S3.SS1.SSS3.Px1.p1.4.m4.1.1">𝑦</ci><apply id="S3.SS1.SSS3.Px1.p1.4.m4.2.2.1.1.cmml" xref="S3.SS1.SSS3.Px1.p1.4.m4.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.Px1.p1.4.m4.2.2.1.1.1.cmml" xref="S3.SS1.SSS3.Px1.p1.4.m4.2.2.1.1">superscript</csymbol><ci id="S3.SS1.SSS3.Px1.p1.4.m4.2.2.1.1.2.cmml" xref="S3.SS1.SSS3.Px1.p1.4.m4.2.2.1.1.2">𝑦</ci><ci id="S3.SS1.SSS3.Px1.p1.4.m4.2.2.1.1.3.cmml" xref="S3.SS1.SSS3.Px1.p1.4.m4.2.2.1.1.3">′</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.Px1.p1.4.m4.2c">y,y^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.Px1.p1.4.m4.2d">italic_y , italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS3.Px1.p2">
<table class="ltx_equation ltx_eqn_table" id="S3.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="S(y,y^{\prime})=\begin{cases}\max(y,y^{\prime},\text{key: }x\mapsto\mu(x)),&amp;E(%
y)=E(y^{\prime})=0\\
y,&amp;E(y)=0,E(y^{\prime})&gt;0\\
y^{\prime},&amp;E(y)&gt;0,E(y^{\prime})=0\\
\min(y,y^{\prime},\text{key: }x\mapsto E(x)),&amp;E(y)=E(y^{\prime})&gt;0\\
\end{cases}" class="ltx_Math" display="block" id="S3.Ex1.m1.10"><semantics id="S3.Ex1.m1.10a"><mrow id="S3.Ex1.m1.10.10" xref="S3.Ex1.m1.10.10.cmml"><mrow id="S3.Ex1.m1.10.10.1" xref="S3.Ex1.m1.10.10.1.cmml"><mi id="S3.Ex1.m1.10.10.1.3" xref="S3.Ex1.m1.10.10.1.3.cmml">S</mi><mo id="S3.Ex1.m1.10.10.1.2" xref="S3.Ex1.m1.10.10.1.2.cmml">⁢</mo><mrow id="S3.Ex1.m1.10.10.1.1.1" xref="S3.Ex1.m1.10.10.1.1.2.cmml"><mo id="S3.Ex1.m1.10.10.1.1.1.2" stretchy="false" xref="S3.Ex1.m1.10.10.1.1.2.cmml">(</mo><mi id="S3.Ex1.m1.9.9" xref="S3.Ex1.m1.9.9.cmml">y</mi><mo id="S3.Ex1.m1.10.10.1.1.1.3" xref="S3.Ex1.m1.10.10.1.1.2.cmml">,</mo><msup id="S3.Ex1.m1.10.10.1.1.1.1" xref="S3.Ex1.m1.10.10.1.1.1.1.cmml"><mi id="S3.Ex1.m1.10.10.1.1.1.1.2" xref="S3.Ex1.m1.10.10.1.1.1.1.2.cmml">y</mi><mo id="S3.Ex1.m1.10.10.1.1.1.1.3" xref="S3.Ex1.m1.10.10.1.1.1.1.3.cmml">′</mo></msup><mo id="S3.Ex1.m1.10.10.1.1.1.4" stretchy="false" xref="S3.Ex1.m1.10.10.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m1.10.10.2" xref="S3.Ex1.m1.10.10.2.cmml">=</mo><mrow id="S3.Ex1.m1.8.8" xref="S3.Ex1.m1.10.10.3.1.cmml"><mo id="S3.Ex1.m1.8.8.9" xref="S3.Ex1.m1.10.10.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" id="S3.Ex1.m1.8.8.8" rowspacing="0pt" xref="S3.Ex1.m1.10.10.3.1.cmml"><mtr id="S3.Ex1.m1.8.8.8a" xref="S3.Ex1.m1.10.10.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.Ex1.m1.8.8.8b" xref="S3.Ex1.m1.10.10.3.1.cmml"><mrow id="S3.Ex1.m1.1.1.1.1.1.1.4" xref="S3.Ex1.m1.10.10.3.1.cmml"><mrow id="S3.Ex1.m1.1.1.1.1.1.1.4.1.2" xref="S3.Ex1.m1.1.1.1.1.1.1.4.1.3.cmml"><mi id="S3.Ex1.m1.1.1.1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.1.1.2.cmml">max</mi><mo id="S3.Ex1.m1.1.1.1.1.1.1.4.1.2a" xref="S3.Ex1.m1.1.1.1.1.1.1.4.1.3.cmml">⁡</mo><mrow id="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2" xref="S3.Ex1.m1.1.1.1.1.1.1.4.1.3.cmml"><mo id="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2.3" stretchy="false" xref="S3.Ex1.m1.1.1.1.1.1.1.4.1.3.cmml">(</mo><mi id="S3.Ex1.m1.1.1.1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.1.1.3.cmml">y</mi><mo id="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2.4" xref="S3.Ex1.m1.1.1.1.1.1.1.4.1.3.cmml">,</mo><msup id="S3.Ex1.m1.1.1.1.1.1.1.4.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.4.1.1.1.1.cmml"><mi id="S3.Ex1.m1.1.1.1.1.1.1.4.1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.1.1.4.1.1.1.1.2.cmml">y</mi><mo id="S3.Ex1.m1.1.1.1.1.1.1.4.1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.1.1.4.1.1.1.1.3.cmml">′</mo></msup><mo id="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2.5" xref="S3.Ex1.m1.1.1.1.1.1.1.4.1.3.cmml">,</mo><mrow id="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2.2" xref="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2.2.cmml"><mrow id="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2.2.2" xref="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2.2.2.cmml"><mtext id="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2.2.2.2" xref="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2.2.2.2a.cmml">key: </mtext><mo id="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2.2.2.1" xref="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2.2.2.1.cmml">⁢</mo><mi id="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2.2.2.3" xref="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2.2.2.3.cmml">x</mi></mrow><mo id="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2.2.1" stretchy="false" xref="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2.2.1.cmml">↦</mo><mrow id="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2.2.3" xref="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2.2.3.cmml"><mi id="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2.2.3.2" xref="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2.2.3.2.cmml">μ</mi><mo id="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2.2.3.1" xref="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2.2.3.1.cmml">⁢</mo><mrow id="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2.2.3.3.2" xref="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2.2.3.cmml"><mo id="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2.2.3.3.2.1" stretchy="false" xref="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2.2.3.cmml">(</mo><mi id="S3.Ex1.m1.1.1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.1.cmml">x</mi><mo id="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2.2.3.3.2.2" stretchy="false" xref="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2.6" stretchy="false" xref="S3.Ex1.m1.1.1.1.1.1.1.4.1.3.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m1.1.1.1.1.1.1.4.2" xref="S3.Ex1.m1.10.10.3.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.Ex1.m1.8.8.8c" xref="S3.Ex1.m1.10.10.3.1.cmml"><mrow id="S3.Ex1.m1.2.2.2.2.2.1" xref="S3.Ex1.m1.2.2.2.2.2.1.cmml"><mrow id="S3.Ex1.m1.2.2.2.2.2.1.4" xref="S3.Ex1.m1.2.2.2.2.2.1.4.cmml"><mi id="S3.Ex1.m1.2.2.2.2.2.1.4.2" xref="S3.Ex1.m1.2.2.2.2.2.1.4.2.cmml">E</mi><mo id="S3.Ex1.m1.2.2.2.2.2.1.4.1" xref="S3.Ex1.m1.2.2.2.2.2.1.4.1.cmml">⁢</mo><mrow id="S3.Ex1.m1.2.2.2.2.2.1.4.3.2" xref="S3.Ex1.m1.2.2.2.2.2.1.4.cmml"><mo id="S3.Ex1.m1.2.2.2.2.2.1.4.3.2.1" stretchy="false" xref="S3.Ex1.m1.2.2.2.2.2.1.4.cmml">(</mo><mi id="S3.Ex1.m1.2.2.2.2.2.1.1" xref="S3.Ex1.m1.2.2.2.2.2.1.1.cmml">y</mi><mo id="S3.Ex1.m1.2.2.2.2.2.1.4.3.2.2" stretchy="false" xref="S3.Ex1.m1.2.2.2.2.2.1.4.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m1.2.2.2.2.2.1.5" xref="S3.Ex1.m1.2.2.2.2.2.1.5.cmml">=</mo><mrow id="S3.Ex1.m1.2.2.2.2.2.1.2" xref="S3.Ex1.m1.2.2.2.2.2.1.2.cmml"><mi id="S3.Ex1.m1.2.2.2.2.2.1.2.3" xref="S3.Ex1.m1.2.2.2.2.2.1.2.3.cmml">E</mi><mo id="S3.Ex1.m1.2.2.2.2.2.1.2.2" xref="S3.Ex1.m1.2.2.2.2.2.1.2.2.cmml">⁢</mo><mrow id="S3.Ex1.m1.2.2.2.2.2.1.2.1.1" xref="S3.Ex1.m1.2.2.2.2.2.1.2.1.1.1.cmml"><mo id="S3.Ex1.m1.2.2.2.2.2.1.2.1.1.2" stretchy="false" xref="S3.Ex1.m1.2.2.2.2.2.1.2.1.1.1.cmml">(</mo><msup id="S3.Ex1.m1.2.2.2.2.2.1.2.1.1.1" xref="S3.Ex1.m1.2.2.2.2.2.1.2.1.1.1.cmml"><mi id="S3.Ex1.m1.2.2.2.2.2.1.2.1.1.1.2" xref="S3.Ex1.m1.2.2.2.2.2.1.2.1.1.1.2.cmml">y</mi><mo id="S3.Ex1.m1.2.2.2.2.2.1.2.1.1.1.3" xref="S3.Ex1.m1.2.2.2.2.2.1.2.1.1.1.3.cmml">′</mo></msup><mo id="S3.Ex1.m1.2.2.2.2.2.1.2.1.1.3" stretchy="false" xref="S3.Ex1.m1.2.2.2.2.2.1.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m1.2.2.2.2.2.1.6" xref="S3.Ex1.m1.2.2.2.2.2.1.6.cmml">=</mo><mn id="S3.Ex1.m1.2.2.2.2.2.1.7" xref="S3.Ex1.m1.2.2.2.2.2.1.7.cmml">0</mn></mrow></mtd></mtr><mtr id="S3.Ex1.m1.8.8.8d" xref="S3.Ex1.m1.10.10.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.Ex1.m1.8.8.8e" xref="S3.Ex1.m1.10.10.3.1.cmml"><mrow id="S3.Ex1.m1.3.3.3.3.1.1.3" xref="S3.Ex1.m1.10.10.3.1.cmml"><mi id="S3.Ex1.m1.3.3.3.3.1.1.1" xref="S3.Ex1.m1.3.3.3.3.1.1.1.cmml">y</mi><mo id="S3.Ex1.m1.3.3.3.3.1.1.3.1" xref="S3.Ex1.m1.10.10.3.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.Ex1.m1.8.8.8f" xref="S3.Ex1.m1.10.10.3.1.cmml"><mrow id="S3.Ex1.m1.4.4.4.4.2.1.3" xref="S3.Ex1.m1.4.4.4.4.2.1.4.cmml"><mrow id="S3.Ex1.m1.4.4.4.4.2.1.2.1" xref="S3.Ex1.m1.4.4.4.4.2.1.2.1.cmml"><mrow id="S3.Ex1.m1.4.4.4.4.2.1.2.1.2" xref="S3.Ex1.m1.4.4.4.4.2.1.2.1.2.cmml"><mi id="S3.Ex1.m1.4.4.4.4.2.1.2.1.2.2" xref="S3.Ex1.m1.4.4.4.4.2.1.2.1.2.2.cmml">E</mi><mo id="S3.Ex1.m1.4.4.4.4.2.1.2.1.2.1" xref="S3.Ex1.m1.4.4.4.4.2.1.2.1.2.1.cmml">⁢</mo><mrow id="S3.Ex1.m1.4.4.4.4.2.1.2.1.2.3.2" xref="S3.Ex1.m1.4.4.4.4.2.1.2.1.2.cmml"><mo id="S3.Ex1.m1.4.4.4.4.2.1.2.1.2.3.2.1" stretchy="false" xref="S3.Ex1.m1.4.4.4.4.2.1.2.1.2.cmml">(</mo><mi id="S3.Ex1.m1.4.4.4.4.2.1.1" xref="S3.Ex1.m1.4.4.4.4.2.1.1.cmml">y</mi><mo id="S3.Ex1.m1.4.4.4.4.2.1.2.1.2.3.2.2" stretchy="false" xref="S3.Ex1.m1.4.4.4.4.2.1.2.1.2.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m1.4.4.4.4.2.1.2.1.1" xref="S3.Ex1.m1.4.4.4.4.2.1.2.1.1.cmml">=</mo><mn id="S3.Ex1.m1.4.4.4.4.2.1.2.1.3" xref="S3.Ex1.m1.4.4.4.4.2.1.2.1.3.cmml">0</mn></mrow><mo id="S3.Ex1.m1.4.4.4.4.2.1.3.3" xref="S3.Ex1.m1.4.4.4.4.2.1.4a.cmml">,</mo><mrow id="S3.Ex1.m1.4.4.4.4.2.1.3.2" xref="S3.Ex1.m1.4.4.4.4.2.1.3.2.cmml"><mrow id="S3.Ex1.m1.4.4.4.4.2.1.3.2.1" xref="S3.Ex1.m1.4.4.4.4.2.1.3.2.1.cmml"><mi id="S3.Ex1.m1.4.4.4.4.2.1.3.2.1.3" xref="S3.Ex1.m1.4.4.4.4.2.1.3.2.1.3.cmml">E</mi><mo id="S3.Ex1.m1.4.4.4.4.2.1.3.2.1.2" xref="S3.Ex1.m1.4.4.4.4.2.1.3.2.1.2.cmml">⁢</mo><mrow id="S3.Ex1.m1.4.4.4.4.2.1.3.2.1.1.1" xref="S3.Ex1.m1.4.4.4.4.2.1.3.2.1.1.1.1.cmml"><mo id="S3.Ex1.m1.4.4.4.4.2.1.3.2.1.1.1.2" stretchy="false" xref="S3.Ex1.m1.4.4.4.4.2.1.3.2.1.1.1.1.cmml">(</mo><msup id="S3.Ex1.m1.4.4.4.4.2.1.3.2.1.1.1.1" xref="S3.Ex1.m1.4.4.4.4.2.1.3.2.1.1.1.1.cmml"><mi id="S3.Ex1.m1.4.4.4.4.2.1.3.2.1.1.1.1.2" xref="S3.Ex1.m1.4.4.4.4.2.1.3.2.1.1.1.1.2.cmml">y</mi><mo id="S3.Ex1.m1.4.4.4.4.2.1.3.2.1.1.1.1.3" xref="S3.Ex1.m1.4.4.4.4.2.1.3.2.1.1.1.1.3.cmml">′</mo></msup><mo id="S3.Ex1.m1.4.4.4.4.2.1.3.2.1.1.1.3" stretchy="false" xref="S3.Ex1.m1.4.4.4.4.2.1.3.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m1.4.4.4.4.2.1.3.2.2" xref="S3.Ex1.m1.4.4.4.4.2.1.3.2.2.cmml">&gt;</mo><mn id="S3.Ex1.m1.4.4.4.4.2.1.3.2.3" xref="S3.Ex1.m1.4.4.4.4.2.1.3.2.3.cmml">0</mn></mrow></mrow></mtd></mtr><mtr id="S3.Ex1.m1.8.8.8g" xref="S3.Ex1.m1.10.10.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.Ex1.m1.8.8.8h" xref="S3.Ex1.m1.10.10.3.1.cmml"><mrow id="S3.Ex1.m1.5.5.5.5.1.1.1" xref="S3.Ex1.m1.5.5.5.5.1.1.1.1.cmml"><msup id="S3.Ex1.m1.5.5.5.5.1.1.1.1" xref="S3.Ex1.m1.5.5.5.5.1.1.1.1.cmml"><mi id="S3.Ex1.m1.5.5.5.5.1.1.1.1.2" xref="S3.Ex1.m1.5.5.5.5.1.1.1.1.2.cmml">y</mi><mo id="S3.Ex1.m1.5.5.5.5.1.1.1.1.3" xref="S3.Ex1.m1.5.5.5.5.1.1.1.1.3.cmml">′</mo></msup><mo id="S3.Ex1.m1.5.5.5.5.1.1.1.2" xref="S3.Ex1.m1.5.5.5.5.1.1.1.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.Ex1.m1.8.8.8i" xref="S3.Ex1.m1.10.10.3.1.cmml"><mrow id="S3.Ex1.m1.6.6.6.6.2.1.3" xref="S3.Ex1.m1.6.6.6.6.2.1.4.cmml"><mrow id="S3.Ex1.m1.6.6.6.6.2.1.2.1" xref="S3.Ex1.m1.6.6.6.6.2.1.2.1.cmml"><mrow id="S3.Ex1.m1.6.6.6.6.2.1.2.1.2" xref="S3.Ex1.m1.6.6.6.6.2.1.2.1.2.cmml"><mi id="S3.Ex1.m1.6.6.6.6.2.1.2.1.2.2" xref="S3.Ex1.m1.6.6.6.6.2.1.2.1.2.2.cmml">E</mi><mo id="S3.Ex1.m1.6.6.6.6.2.1.2.1.2.1" xref="S3.Ex1.m1.6.6.6.6.2.1.2.1.2.1.cmml">⁢</mo><mrow id="S3.Ex1.m1.6.6.6.6.2.1.2.1.2.3.2" xref="S3.Ex1.m1.6.6.6.6.2.1.2.1.2.cmml"><mo id="S3.Ex1.m1.6.6.6.6.2.1.2.1.2.3.2.1" stretchy="false" xref="S3.Ex1.m1.6.6.6.6.2.1.2.1.2.cmml">(</mo><mi id="S3.Ex1.m1.6.6.6.6.2.1.1" xref="S3.Ex1.m1.6.6.6.6.2.1.1.cmml">y</mi><mo id="S3.Ex1.m1.6.6.6.6.2.1.2.1.2.3.2.2" stretchy="false" xref="S3.Ex1.m1.6.6.6.6.2.1.2.1.2.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m1.6.6.6.6.2.1.2.1.1" xref="S3.Ex1.m1.6.6.6.6.2.1.2.1.1.cmml">&gt;</mo><mn id="S3.Ex1.m1.6.6.6.6.2.1.2.1.3" xref="S3.Ex1.m1.6.6.6.6.2.1.2.1.3.cmml">0</mn></mrow><mo id="S3.Ex1.m1.6.6.6.6.2.1.3.3" xref="S3.Ex1.m1.6.6.6.6.2.1.4a.cmml">,</mo><mrow id="S3.Ex1.m1.6.6.6.6.2.1.3.2" xref="S3.Ex1.m1.6.6.6.6.2.1.3.2.cmml"><mrow id="S3.Ex1.m1.6.6.6.6.2.1.3.2.1" xref="S3.Ex1.m1.6.6.6.6.2.1.3.2.1.cmml"><mi id="S3.Ex1.m1.6.6.6.6.2.1.3.2.1.3" xref="S3.Ex1.m1.6.6.6.6.2.1.3.2.1.3.cmml">E</mi><mo id="S3.Ex1.m1.6.6.6.6.2.1.3.2.1.2" xref="S3.Ex1.m1.6.6.6.6.2.1.3.2.1.2.cmml">⁢</mo><mrow id="S3.Ex1.m1.6.6.6.6.2.1.3.2.1.1.1" xref="S3.Ex1.m1.6.6.6.6.2.1.3.2.1.1.1.1.cmml"><mo id="S3.Ex1.m1.6.6.6.6.2.1.3.2.1.1.1.2" stretchy="false" xref="S3.Ex1.m1.6.6.6.6.2.1.3.2.1.1.1.1.cmml">(</mo><msup id="S3.Ex1.m1.6.6.6.6.2.1.3.2.1.1.1.1" xref="S3.Ex1.m1.6.6.6.6.2.1.3.2.1.1.1.1.cmml"><mi id="S3.Ex1.m1.6.6.6.6.2.1.3.2.1.1.1.1.2" xref="S3.Ex1.m1.6.6.6.6.2.1.3.2.1.1.1.1.2.cmml">y</mi><mo id="S3.Ex1.m1.6.6.6.6.2.1.3.2.1.1.1.1.3" xref="S3.Ex1.m1.6.6.6.6.2.1.3.2.1.1.1.1.3.cmml">′</mo></msup><mo id="S3.Ex1.m1.6.6.6.6.2.1.3.2.1.1.1.3" stretchy="false" xref="S3.Ex1.m1.6.6.6.6.2.1.3.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m1.6.6.6.6.2.1.3.2.2" xref="S3.Ex1.m1.6.6.6.6.2.1.3.2.2.cmml">=</mo><mn id="S3.Ex1.m1.6.6.6.6.2.1.3.2.3" xref="S3.Ex1.m1.6.6.6.6.2.1.3.2.3.cmml">0</mn></mrow></mrow></mtd></mtr><mtr id="S3.Ex1.m1.8.8.8j" xref="S3.Ex1.m1.10.10.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.Ex1.m1.8.8.8k" xref="S3.Ex1.m1.10.10.3.1.cmml"><mrow id="S3.Ex1.m1.7.7.7.7.1.1.4" xref="S3.Ex1.m1.10.10.3.1.cmml"><mrow id="S3.Ex1.m1.7.7.7.7.1.1.4.1.2" xref="S3.Ex1.m1.7.7.7.7.1.1.4.1.3.cmml"><mi id="S3.Ex1.m1.7.7.7.7.1.1.2" xref="S3.Ex1.m1.7.7.7.7.1.1.2.cmml">min</mi><mo id="S3.Ex1.m1.7.7.7.7.1.1.4.1.2a" xref="S3.Ex1.m1.7.7.7.7.1.1.4.1.3.cmml">⁡</mo><mrow id="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2" xref="S3.Ex1.m1.7.7.7.7.1.1.4.1.3.cmml"><mo id="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2.3" stretchy="false" xref="S3.Ex1.m1.7.7.7.7.1.1.4.1.3.cmml">(</mo><mi id="S3.Ex1.m1.7.7.7.7.1.1.3" xref="S3.Ex1.m1.7.7.7.7.1.1.3.cmml">y</mi><mo id="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2.4" xref="S3.Ex1.m1.7.7.7.7.1.1.4.1.3.cmml">,</mo><msup id="S3.Ex1.m1.7.7.7.7.1.1.4.1.1.1.1" xref="S3.Ex1.m1.7.7.7.7.1.1.4.1.1.1.1.cmml"><mi id="S3.Ex1.m1.7.7.7.7.1.1.4.1.1.1.1.2" xref="S3.Ex1.m1.7.7.7.7.1.1.4.1.1.1.1.2.cmml">y</mi><mo id="S3.Ex1.m1.7.7.7.7.1.1.4.1.1.1.1.3" xref="S3.Ex1.m1.7.7.7.7.1.1.4.1.1.1.1.3.cmml">′</mo></msup><mo id="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2.5" xref="S3.Ex1.m1.7.7.7.7.1.1.4.1.3.cmml">,</mo><mrow id="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2.2" xref="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2.2.cmml"><mrow id="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2.2.2" xref="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2.2.2.cmml"><mtext id="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2.2.2.2" xref="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2.2.2.2a.cmml">key: </mtext><mo id="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2.2.2.1" xref="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2.2.2.1.cmml">⁢</mo><mi id="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2.2.2.3" xref="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2.2.2.3.cmml">x</mi></mrow><mo id="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2.2.1" stretchy="false" xref="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2.2.1.cmml">↦</mo><mrow id="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2.2.3" xref="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2.2.3.cmml"><mi id="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2.2.3.2" xref="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2.2.3.2.cmml">E</mi><mo id="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2.2.3.1" xref="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2.2.3.1.cmml">⁢</mo><mrow id="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2.2.3.3.2" xref="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2.2.3.cmml"><mo id="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2.2.3.3.2.1" stretchy="false" xref="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2.2.3.cmml">(</mo><mi id="S3.Ex1.m1.7.7.7.7.1.1.1" xref="S3.Ex1.m1.7.7.7.7.1.1.1.cmml">x</mi><mo id="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2.2.3.3.2.2" stretchy="false" xref="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2.6" stretchy="false" xref="S3.Ex1.m1.7.7.7.7.1.1.4.1.3.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m1.7.7.7.7.1.1.4.2" xref="S3.Ex1.m1.10.10.3.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.Ex1.m1.8.8.8l" xref="S3.Ex1.m1.10.10.3.1.cmml"><mrow id="S3.Ex1.m1.8.8.8.8.2.1" xref="S3.Ex1.m1.8.8.8.8.2.1.cmml"><mrow id="S3.Ex1.m1.8.8.8.8.2.1.4" xref="S3.Ex1.m1.8.8.8.8.2.1.4.cmml"><mi id="S3.Ex1.m1.8.8.8.8.2.1.4.2" xref="S3.Ex1.m1.8.8.8.8.2.1.4.2.cmml">E</mi><mo id="S3.Ex1.m1.8.8.8.8.2.1.4.1" xref="S3.Ex1.m1.8.8.8.8.2.1.4.1.cmml">⁢</mo><mrow id="S3.Ex1.m1.8.8.8.8.2.1.4.3.2" xref="S3.Ex1.m1.8.8.8.8.2.1.4.cmml"><mo id="S3.Ex1.m1.8.8.8.8.2.1.4.3.2.1" stretchy="false" xref="S3.Ex1.m1.8.8.8.8.2.1.4.cmml">(</mo><mi id="S3.Ex1.m1.8.8.8.8.2.1.1" xref="S3.Ex1.m1.8.8.8.8.2.1.1.cmml">y</mi><mo id="S3.Ex1.m1.8.8.8.8.2.1.4.3.2.2" stretchy="false" xref="S3.Ex1.m1.8.8.8.8.2.1.4.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m1.8.8.8.8.2.1.5" xref="S3.Ex1.m1.8.8.8.8.2.1.5.cmml">=</mo><mrow id="S3.Ex1.m1.8.8.8.8.2.1.2" xref="S3.Ex1.m1.8.8.8.8.2.1.2.cmml"><mi id="S3.Ex1.m1.8.8.8.8.2.1.2.3" xref="S3.Ex1.m1.8.8.8.8.2.1.2.3.cmml">E</mi><mo id="S3.Ex1.m1.8.8.8.8.2.1.2.2" xref="S3.Ex1.m1.8.8.8.8.2.1.2.2.cmml">⁢</mo><mrow id="S3.Ex1.m1.8.8.8.8.2.1.2.1.1" xref="S3.Ex1.m1.8.8.8.8.2.1.2.1.1.1.cmml"><mo id="S3.Ex1.m1.8.8.8.8.2.1.2.1.1.2" stretchy="false" xref="S3.Ex1.m1.8.8.8.8.2.1.2.1.1.1.cmml">(</mo><msup id="S3.Ex1.m1.8.8.8.8.2.1.2.1.1.1" xref="S3.Ex1.m1.8.8.8.8.2.1.2.1.1.1.cmml"><mi id="S3.Ex1.m1.8.8.8.8.2.1.2.1.1.1.2" xref="S3.Ex1.m1.8.8.8.8.2.1.2.1.1.1.2.cmml">y</mi><mo id="S3.Ex1.m1.8.8.8.8.2.1.2.1.1.1.3" xref="S3.Ex1.m1.8.8.8.8.2.1.2.1.1.1.3.cmml">′</mo></msup><mo id="S3.Ex1.m1.8.8.8.8.2.1.2.1.1.3" stretchy="false" xref="S3.Ex1.m1.8.8.8.8.2.1.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m1.8.8.8.8.2.1.6" xref="S3.Ex1.m1.8.8.8.8.2.1.6.cmml">&gt;</mo><mn id="S3.Ex1.m1.8.8.8.8.2.1.7" xref="S3.Ex1.m1.8.8.8.8.2.1.7.cmml">0</mn></mrow></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.10b"><apply id="S3.Ex1.m1.10.10.cmml" xref="S3.Ex1.m1.10.10"><eq id="S3.Ex1.m1.10.10.2.cmml" xref="S3.Ex1.m1.10.10.2"></eq><apply id="S3.Ex1.m1.10.10.1.cmml" xref="S3.Ex1.m1.10.10.1"><times id="S3.Ex1.m1.10.10.1.2.cmml" xref="S3.Ex1.m1.10.10.1.2"></times><ci id="S3.Ex1.m1.10.10.1.3.cmml" xref="S3.Ex1.m1.10.10.1.3">𝑆</ci><interval closure="open" id="S3.Ex1.m1.10.10.1.1.2.cmml" xref="S3.Ex1.m1.10.10.1.1.1"><ci id="S3.Ex1.m1.9.9.cmml" xref="S3.Ex1.m1.9.9">𝑦</ci><apply id="S3.Ex1.m1.10.10.1.1.1.1.cmml" xref="S3.Ex1.m1.10.10.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.10.10.1.1.1.1.1.cmml" xref="S3.Ex1.m1.10.10.1.1.1.1">superscript</csymbol><ci id="S3.Ex1.m1.10.10.1.1.1.1.2.cmml" xref="S3.Ex1.m1.10.10.1.1.1.1.2">𝑦</ci><ci id="S3.Ex1.m1.10.10.1.1.1.1.3.cmml" xref="S3.Ex1.m1.10.10.1.1.1.1.3">′</ci></apply></interval></apply><apply id="S3.Ex1.m1.10.10.3.1.cmml" xref="S3.Ex1.m1.8.8"><csymbol cd="latexml" id="S3.Ex1.m1.10.10.3.1.1.cmml" xref="S3.Ex1.m1.8.8.9">cases</csymbol><apply id="S3.Ex1.m1.1.1.1.1.1.1.4.1.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.4.1.2"><max id="S3.Ex1.m1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.2"></max><ci id="S3.Ex1.m1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.3">𝑦</ci><apply id="S3.Ex1.m1.1.1.1.1.1.1.4.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.4.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.1.1.4.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.4.1.1.1.1">superscript</csymbol><ci id="S3.Ex1.m1.1.1.1.1.1.1.4.1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.4.1.1.1.1.2">𝑦</ci><ci id="S3.Ex1.m1.1.1.1.1.1.1.4.1.1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.4.1.1.1.1.3">′</ci></apply><apply id="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2.2"><csymbol cd="latexml" id="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2.2.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2.2.1">maps-to</csymbol><apply id="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2.2.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2.2.2"><times id="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2.2.2.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2.2.2.1"></times><ci id="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2.2.2.2a.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2.2.2.2"><mtext id="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2.2.2.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2.2.2.2">key: </mtext></ci><ci id="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2.2.2.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2.2.2.3">𝑥</ci></apply><apply id="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2.2.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2.2.3"><times id="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2.2.3.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2.2.3.1"></times><ci id="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2.2.3.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.4.1.2.2.2.3.2">𝜇</ci><ci id="S3.Ex1.m1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1">𝑥</ci></apply></apply></apply><apply id="S3.Ex1.m1.2.2.2.2.2.1.cmml" xref="S3.Ex1.m1.2.2.2.2.2.1"><and id="S3.Ex1.m1.2.2.2.2.2.1a.cmml" xref="S3.Ex1.m1.2.2.2.2.2.1"></and><apply id="S3.Ex1.m1.2.2.2.2.2.1b.cmml" xref="S3.Ex1.m1.2.2.2.2.2.1"><eq id="S3.Ex1.m1.2.2.2.2.2.1.5.cmml" xref="S3.Ex1.m1.2.2.2.2.2.1.5"></eq><apply id="S3.Ex1.m1.2.2.2.2.2.1.4.cmml" xref="S3.Ex1.m1.2.2.2.2.2.1.4"><times id="S3.Ex1.m1.2.2.2.2.2.1.4.1.cmml" xref="S3.Ex1.m1.2.2.2.2.2.1.4.1"></times><ci id="S3.Ex1.m1.2.2.2.2.2.1.4.2.cmml" xref="S3.Ex1.m1.2.2.2.2.2.1.4.2">𝐸</ci><ci id="S3.Ex1.m1.2.2.2.2.2.1.1.cmml" xref="S3.Ex1.m1.2.2.2.2.2.1.1">𝑦</ci></apply><apply id="S3.Ex1.m1.2.2.2.2.2.1.2.cmml" xref="S3.Ex1.m1.2.2.2.2.2.1.2"><times id="S3.Ex1.m1.2.2.2.2.2.1.2.2.cmml" xref="S3.Ex1.m1.2.2.2.2.2.1.2.2"></times><ci id="S3.Ex1.m1.2.2.2.2.2.1.2.3.cmml" xref="S3.Ex1.m1.2.2.2.2.2.1.2.3">𝐸</ci><apply id="S3.Ex1.m1.2.2.2.2.2.1.2.1.1.1.cmml" xref="S3.Ex1.m1.2.2.2.2.2.1.2.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.2.2.2.2.1.2.1.1.1.1.cmml" xref="S3.Ex1.m1.2.2.2.2.2.1.2.1.1">superscript</csymbol><ci id="S3.Ex1.m1.2.2.2.2.2.1.2.1.1.1.2.cmml" xref="S3.Ex1.m1.2.2.2.2.2.1.2.1.1.1.2">𝑦</ci><ci id="S3.Ex1.m1.2.2.2.2.2.1.2.1.1.1.3.cmml" xref="S3.Ex1.m1.2.2.2.2.2.1.2.1.1.1.3">′</ci></apply></apply></apply><apply id="S3.Ex1.m1.2.2.2.2.2.1c.cmml" xref="S3.Ex1.m1.2.2.2.2.2.1"><eq id="S3.Ex1.m1.2.2.2.2.2.1.6.cmml" xref="S3.Ex1.m1.2.2.2.2.2.1.6"></eq><share href="https://arxiv.org/html/2410.04753v1#S3.Ex1.m1.2.2.2.2.2.1.2.cmml" id="S3.Ex1.m1.2.2.2.2.2.1d.cmml" xref="S3.Ex1.m1.2.2.2.2.2.1"></share><cn id="S3.Ex1.m1.2.2.2.2.2.1.7.cmml" type="integer" xref="S3.Ex1.m1.2.2.2.2.2.1.7">0</cn></apply></apply><ci id="S3.Ex1.m1.3.3.3.3.1.1.1.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.1">𝑦</ci><apply id="S3.Ex1.m1.4.4.4.4.2.1.4.cmml" xref="S3.Ex1.m1.4.4.4.4.2.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.4.4.4.4.2.1.4a.cmml" xref="S3.Ex1.m1.4.4.4.4.2.1.3.3">formulae-sequence</csymbol><apply id="S3.Ex1.m1.4.4.4.4.2.1.2.1.cmml" xref="S3.Ex1.m1.4.4.4.4.2.1.2.1"><eq id="S3.Ex1.m1.4.4.4.4.2.1.2.1.1.cmml" xref="S3.Ex1.m1.4.4.4.4.2.1.2.1.1"></eq><apply id="S3.Ex1.m1.4.4.4.4.2.1.2.1.2.cmml" xref="S3.Ex1.m1.4.4.4.4.2.1.2.1.2"><times id="S3.Ex1.m1.4.4.4.4.2.1.2.1.2.1.cmml" xref="S3.Ex1.m1.4.4.4.4.2.1.2.1.2.1"></times><ci id="S3.Ex1.m1.4.4.4.4.2.1.2.1.2.2.cmml" xref="S3.Ex1.m1.4.4.4.4.2.1.2.1.2.2">𝐸</ci><ci id="S3.Ex1.m1.4.4.4.4.2.1.1.cmml" xref="S3.Ex1.m1.4.4.4.4.2.1.1">𝑦</ci></apply><cn id="S3.Ex1.m1.4.4.4.4.2.1.2.1.3.cmml" type="integer" xref="S3.Ex1.m1.4.4.4.4.2.1.2.1.3">0</cn></apply><apply id="S3.Ex1.m1.4.4.4.4.2.1.3.2.cmml" xref="S3.Ex1.m1.4.4.4.4.2.1.3.2"><gt id="S3.Ex1.m1.4.4.4.4.2.1.3.2.2.cmml" xref="S3.Ex1.m1.4.4.4.4.2.1.3.2.2"></gt><apply id="S3.Ex1.m1.4.4.4.4.2.1.3.2.1.cmml" xref="S3.Ex1.m1.4.4.4.4.2.1.3.2.1"><times id="S3.Ex1.m1.4.4.4.4.2.1.3.2.1.2.cmml" xref="S3.Ex1.m1.4.4.4.4.2.1.3.2.1.2"></times><ci id="S3.Ex1.m1.4.4.4.4.2.1.3.2.1.3.cmml" xref="S3.Ex1.m1.4.4.4.4.2.1.3.2.1.3">𝐸</ci><apply id="S3.Ex1.m1.4.4.4.4.2.1.3.2.1.1.1.1.cmml" xref="S3.Ex1.m1.4.4.4.4.2.1.3.2.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.4.4.4.4.2.1.3.2.1.1.1.1.1.cmml" xref="S3.Ex1.m1.4.4.4.4.2.1.3.2.1.1.1">superscript</csymbol><ci id="S3.Ex1.m1.4.4.4.4.2.1.3.2.1.1.1.1.2.cmml" xref="S3.Ex1.m1.4.4.4.4.2.1.3.2.1.1.1.1.2">𝑦</ci><ci id="S3.Ex1.m1.4.4.4.4.2.1.3.2.1.1.1.1.3.cmml" xref="S3.Ex1.m1.4.4.4.4.2.1.3.2.1.1.1.1.3">′</ci></apply></apply><cn id="S3.Ex1.m1.4.4.4.4.2.1.3.2.3.cmml" type="integer" xref="S3.Ex1.m1.4.4.4.4.2.1.3.2.3">0</cn></apply></apply><apply id="S3.Ex1.m1.5.5.5.5.1.1.1.1.cmml" xref="S3.Ex1.m1.5.5.5.5.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.5.5.5.5.1.1.1.1.1.cmml" xref="S3.Ex1.m1.5.5.5.5.1.1.1">superscript</csymbol><ci id="S3.Ex1.m1.5.5.5.5.1.1.1.1.2.cmml" xref="S3.Ex1.m1.5.5.5.5.1.1.1.1.2">𝑦</ci><ci id="S3.Ex1.m1.5.5.5.5.1.1.1.1.3.cmml" xref="S3.Ex1.m1.5.5.5.5.1.1.1.1.3">′</ci></apply><apply id="S3.Ex1.m1.6.6.6.6.2.1.4.cmml" xref="S3.Ex1.m1.6.6.6.6.2.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.6.6.6.6.2.1.4a.cmml" xref="S3.Ex1.m1.6.6.6.6.2.1.3.3">formulae-sequence</csymbol><apply id="S3.Ex1.m1.6.6.6.6.2.1.2.1.cmml" xref="S3.Ex1.m1.6.6.6.6.2.1.2.1"><gt id="S3.Ex1.m1.6.6.6.6.2.1.2.1.1.cmml" xref="S3.Ex1.m1.6.6.6.6.2.1.2.1.1"></gt><apply id="S3.Ex1.m1.6.6.6.6.2.1.2.1.2.cmml" xref="S3.Ex1.m1.6.6.6.6.2.1.2.1.2"><times id="S3.Ex1.m1.6.6.6.6.2.1.2.1.2.1.cmml" xref="S3.Ex1.m1.6.6.6.6.2.1.2.1.2.1"></times><ci id="S3.Ex1.m1.6.6.6.6.2.1.2.1.2.2.cmml" xref="S3.Ex1.m1.6.6.6.6.2.1.2.1.2.2">𝐸</ci><ci id="S3.Ex1.m1.6.6.6.6.2.1.1.cmml" xref="S3.Ex1.m1.6.6.6.6.2.1.1">𝑦</ci></apply><cn id="S3.Ex1.m1.6.6.6.6.2.1.2.1.3.cmml" type="integer" xref="S3.Ex1.m1.6.6.6.6.2.1.2.1.3">0</cn></apply><apply id="S3.Ex1.m1.6.6.6.6.2.1.3.2.cmml" xref="S3.Ex1.m1.6.6.6.6.2.1.3.2"><eq id="S3.Ex1.m1.6.6.6.6.2.1.3.2.2.cmml" xref="S3.Ex1.m1.6.6.6.6.2.1.3.2.2"></eq><apply id="S3.Ex1.m1.6.6.6.6.2.1.3.2.1.cmml" xref="S3.Ex1.m1.6.6.6.6.2.1.3.2.1"><times id="S3.Ex1.m1.6.6.6.6.2.1.3.2.1.2.cmml" xref="S3.Ex1.m1.6.6.6.6.2.1.3.2.1.2"></times><ci id="S3.Ex1.m1.6.6.6.6.2.1.3.2.1.3.cmml" xref="S3.Ex1.m1.6.6.6.6.2.1.3.2.1.3">𝐸</ci><apply id="S3.Ex1.m1.6.6.6.6.2.1.3.2.1.1.1.1.cmml" xref="S3.Ex1.m1.6.6.6.6.2.1.3.2.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.6.6.6.6.2.1.3.2.1.1.1.1.1.cmml" xref="S3.Ex1.m1.6.6.6.6.2.1.3.2.1.1.1">superscript</csymbol><ci id="S3.Ex1.m1.6.6.6.6.2.1.3.2.1.1.1.1.2.cmml" xref="S3.Ex1.m1.6.6.6.6.2.1.3.2.1.1.1.1.2">𝑦</ci><ci id="S3.Ex1.m1.6.6.6.6.2.1.3.2.1.1.1.1.3.cmml" xref="S3.Ex1.m1.6.6.6.6.2.1.3.2.1.1.1.1.3">′</ci></apply></apply><cn id="S3.Ex1.m1.6.6.6.6.2.1.3.2.3.cmml" type="integer" xref="S3.Ex1.m1.6.6.6.6.2.1.3.2.3">0</cn></apply></apply><apply id="S3.Ex1.m1.7.7.7.7.1.1.4.1.3.cmml" xref="S3.Ex1.m1.7.7.7.7.1.1.4.1.2"><min id="S3.Ex1.m1.7.7.7.7.1.1.2.cmml" xref="S3.Ex1.m1.7.7.7.7.1.1.2"></min><ci id="S3.Ex1.m1.7.7.7.7.1.1.3.cmml" xref="S3.Ex1.m1.7.7.7.7.1.1.3">𝑦</ci><apply id="S3.Ex1.m1.7.7.7.7.1.1.4.1.1.1.1.cmml" xref="S3.Ex1.m1.7.7.7.7.1.1.4.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.7.7.7.7.1.1.4.1.1.1.1.1.cmml" xref="S3.Ex1.m1.7.7.7.7.1.1.4.1.1.1.1">superscript</csymbol><ci id="S3.Ex1.m1.7.7.7.7.1.1.4.1.1.1.1.2.cmml" xref="S3.Ex1.m1.7.7.7.7.1.1.4.1.1.1.1.2">𝑦</ci><ci id="S3.Ex1.m1.7.7.7.7.1.1.4.1.1.1.1.3.cmml" xref="S3.Ex1.m1.7.7.7.7.1.1.4.1.1.1.1.3">′</ci></apply><apply id="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2.2.cmml" xref="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2.2"><csymbol cd="latexml" id="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2.2.1.cmml" xref="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2.2.1">maps-to</csymbol><apply id="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2.2.2.cmml" xref="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2.2.2"><times id="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2.2.2.1.cmml" xref="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2.2.2.1"></times><ci id="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2.2.2.2a.cmml" xref="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2.2.2.2"><mtext id="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2.2.2.2.cmml" xref="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2.2.2.2">key: </mtext></ci><ci id="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2.2.2.3.cmml" xref="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2.2.2.3">𝑥</ci></apply><apply id="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2.2.3.cmml" xref="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2.2.3"><times id="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2.2.3.1.cmml" xref="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2.2.3.1"></times><ci id="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2.2.3.2.cmml" xref="S3.Ex1.m1.7.7.7.7.1.1.4.1.2.2.2.3.2">𝐸</ci><ci id="S3.Ex1.m1.7.7.7.7.1.1.1.cmml" xref="S3.Ex1.m1.7.7.7.7.1.1.1">𝑥</ci></apply></apply></apply><apply id="S3.Ex1.m1.8.8.8.8.2.1.cmml" xref="S3.Ex1.m1.8.8.8.8.2.1"><and id="S3.Ex1.m1.8.8.8.8.2.1a.cmml" xref="S3.Ex1.m1.8.8.8.8.2.1"></and><apply id="S3.Ex1.m1.8.8.8.8.2.1b.cmml" xref="S3.Ex1.m1.8.8.8.8.2.1"><eq id="S3.Ex1.m1.8.8.8.8.2.1.5.cmml" xref="S3.Ex1.m1.8.8.8.8.2.1.5"></eq><apply id="S3.Ex1.m1.8.8.8.8.2.1.4.cmml" xref="S3.Ex1.m1.8.8.8.8.2.1.4"><times id="S3.Ex1.m1.8.8.8.8.2.1.4.1.cmml" xref="S3.Ex1.m1.8.8.8.8.2.1.4.1"></times><ci id="S3.Ex1.m1.8.8.8.8.2.1.4.2.cmml" xref="S3.Ex1.m1.8.8.8.8.2.1.4.2">𝐸</ci><ci id="S3.Ex1.m1.8.8.8.8.2.1.1.cmml" xref="S3.Ex1.m1.8.8.8.8.2.1.1">𝑦</ci></apply><apply id="S3.Ex1.m1.8.8.8.8.2.1.2.cmml" xref="S3.Ex1.m1.8.8.8.8.2.1.2"><times id="S3.Ex1.m1.8.8.8.8.2.1.2.2.cmml" xref="S3.Ex1.m1.8.8.8.8.2.1.2.2"></times><ci id="S3.Ex1.m1.8.8.8.8.2.1.2.3.cmml" xref="S3.Ex1.m1.8.8.8.8.2.1.2.3">𝐸</ci><apply id="S3.Ex1.m1.8.8.8.8.2.1.2.1.1.1.cmml" xref="S3.Ex1.m1.8.8.8.8.2.1.2.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.8.8.8.8.2.1.2.1.1.1.1.cmml" xref="S3.Ex1.m1.8.8.8.8.2.1.2.1.1">superscript</csymbol><ci id="S3.Ex1.m1.8.8.8.8.2.1.2.1.1.1.2.cmml" xref="S3.Ex1.m1.8.8.8.8.2.1.2.1.1.1.2">𝑦</ci><ci id="S3.Ex1.m1.8.8.8.8.2.1.2.1.1.1.3.cmml" xref="S3.Ex1.m1.8.8.8.8.2.1.2.1.1.1.3">′</ci></apply></apply></apply><apply id="S3.Ex1.m1.8.8.8.8.2.1c.cmml" xref="S3.Ex1.m1.8.8.8.8.2.1"><gt id="S3.Ex1.m1.8.8.8.8.2.1.6.cmml" xref="S3.Ex1.m1.8.8.8.8.2.1.6"></gt><share href="https://arxiv.org/html/2410.04753v1#S3.Ex1.m1.8.8.8.8.2.1.2.cmml" id="S3.Ex1.m1.8.8.8.8.2.1d.cmml" xref="S3.Ex1.m1.8.8.8.8.2.1"></share><cn id="S3.Ex1.m1.8.8.8.8.2.1.7.cmml" type="integer" xref="S3.Ex1.m1.8.8.8.8.2.1.7">0</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.10c">S(y,y^{\prime})=\begin{cases}\max(y,y^{\prime},\text{key: }x\mapsto\mu(x)),&amp;E(%
y)=E(y^{\prime})=0\\
y,&amp;E(y)=0,E(y^{\prime})&gt;0\\
y^{\prime},&amp;E(y)&gt;0,E(y^{\prime})=0\\
\min(y,y^{\prime},\text{key: }x\mapsto E(x)),&amp;E(y)=E(y^{\prime})&gt;0\\
\end{cases}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1.m1.10d">italic_S ( italic_y , italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) = { start_ROW start_CELL roman_max ( italic_y , italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , key: italic_x ↦ italic_μ ( italic_x ) ) , end_CELL start_CELL italic_E ( italic_y ) = italic_E ( italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) = 0 end_CELL end_ROW start_ROW start_CELL italic_y , end_CELL start_CELL italic_E ( italic_y ) = 0 , italic_E ( italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) &gt; 0 end_CELL end_ROW start_ROW start_CELL italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , end_CELL start_CELL italic_E ( italic_y ) &gt; 0 , italic_E ( italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) = 0 end_CELL end_ROW start_ROW start_CELL roman_min ( italic_y , italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , key: italic_x ↦ italic_E ( italic_x ) ) , end_CELL start_CELL italic_E ( italic_y ) = italic_E ( italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) &gt; 0 end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS3.Px1.p3">
<p class="ltx_p" id="S3.SS1.SSS3.Px1.p3.4">Where <math alttext="\mu(x)" class="ltx_Math" display="inline" id="S3.SS1.SSS3.Px1.p3.1.m1.1"><semantics id="S3.SS1.SSS3.Px1.p3.1.m1.1a"><mrow id="S3.SS1.SSS3.Px1.p3.1.m1.1.2" xref="S3.SS1.SSS3.Px1.p3.1.m1.1.2.cmml"><mi id="S3.SS1.SSS3.Px1.p3.1.m1.1.2.2" xref="S3.SS1.SSS3.Px1.p3.1.m1.1.2.2.cmml">μ</mi><mo id="S3.SS1.SSS3.Px1.p3.1.m1.1.2.1" xref="S3.SS1.SSS3.Px1.p3.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.SSS3.Px1.p3.1.m1.1.2.3.2" xref="S3.SS1.SSS3.Px1.p3.1.m1.1.2.cmml"><mo id="S3.SS1.SSS3.Px1.p3.1.m1.1.2.3.2.1" stretchy="false" xref="S3.SS1.SSS3.Px1.p3.1.m1.1.2.cmml">(</mo><mi id="S3.SS1.SSS3.Px1.p3.1.m1.1.1" xref="S3.SS1.SSS3.Px1.p3.1.m1.1.1.cmml">x</mi><mo id="S3.SS1.SSS3.Px1.p3.1.m1.1.2.3.2.2" stretchy="false" xref="S3.SS1.SSS3.Px1.p3.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.Px1.p3.1.m1.1b"><apply id="S3.SS1.SSS3.Px1.p3.1.m1.1.2.cmml" xref="S3.SS1.SSS3.Px1.p3.1.m1.1.2"><times id="S3.SS1.SSS3.Px1.p3.1.m1.1.2.1.cmml" xref="S3.SS1.SSS3.Px1.p3.1.m1.1.2.1"></times><ci id="S3.SS1.SSS3.Px1.p3.1.m1.1.2.2.cmml" xref="S3.SS1.SSS3.Px1.p3.1.m1.1.2.2">𝜇</ci><ci id="S3.SS1.SSS3.Px1.p3.1.m1.1.1.cmml" xref="S3.SS1.SSS3.Px1.p3.1.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.Px1.p3.1.m1.1c">\mu(x)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.Px1.p3.1.m1.1d">italic_μ ( italic_x )</annotation></semantics></math> is the metric score of <math alttext="x" class="ltx_Math" display="inline" id="S3.SS1.SSS3.Px1.p3.2.m2.1"><semantics id="S3.SS1.SSS3.Px1.p3.2.m2.1a"><mi id="S3.SS1.SSS3.Px1.p3.2.m2.1.1" xref="S3.SS1.SSS3.Px1.p3.2.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.Px1.p3.2.m2.1b"><ci id="S3.SS1.SSS3.Px1.p3.2.m2.1.1.cmml" xref="S3.SS1.SSS3.Px1.p3.2.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.Px1.p3.2.m2.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.Px1.p3.2.m2.1d">italic_x</annotation></semantics></math>, and <math alttext="E(x)" class="ltx_Math" display="inline" id="S3.SS1.SSS3.Px1.p3.3.m3.1"><semantics id="S3.SS1.SSS3.Px1.p3.3.m3.1a"><mrow id="S3.SS1.SSS3.Px1.p3.3.m3.1.2" xref="S3.SS1.SSS3.Px1.p3.3.m3.1.2.cmml"><mi id="S3.SS1.SSS3.Px1.p3.3.m3.1.2.2" xref="S3.SS1.SSS3.Px1.p3.3.m3.1.2.2.cmml">E</mi><mo id="S3.SS1.SSS3.Px1.p3.3.m3.1.2.1" xref="S3.SS1.SSS3.Px1.p3.3.m3.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.SSS3.Px1.p3.3.m3.1.2.3.2" xref="S3.SS1.SSS3.Px1.p3.3.m3.1.2.cmml"><mo id="S3.SS1.SSS3.Px1.p3.3.m3.1.2.3.2.1" stretchy="false" xref="S3.SS1.SSS3.Px1.p3.3.m3.1.2.cmml">(</mo><mi id="S3.SS1.SSS3.Px1.p3.3.m3.1.1" xref="S3.SS1.SSS3.Px1.p3.3.m3.1.1.cmml">x</mi><mo id="S3.SS1.SSS3.Px1.p3.3.m3.1.2.3.2.2" stretchy="false" xref="S3.SS1.SSS3.Px1.p3.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.Px1.p3.3.m3.1b"><apply id="S3.SS1.SSS3.Px1.p3.3.m3.1.2.cmml" xref="S3.SS1.SSS3.Px1.p3.3.m3.1.2"><times id="S3.SS1.SSS3.Px1.p3.3.m3.1.2.1.cmml" xref="S3.SS1.SSS3.Px1.p3.3.m3.1.2.1"></times><ci id="S3.SS1.SSS3.Px1.p3.3.m3.1.2.2.cmml" xref="S3.SS1.SSS3.Px1.p3.3.m3.1.2.2">𝐸</ci><ci id="S3.SS1.SSS3.Px1.p3.3.m3.1.1.cmml" xref="S3.SS1.SSS3.Px1.p3.3.m3.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.Px1.p3.3.m3.1c">E(x)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.Px1.p3.3.m3.1d">italic_E ( italic_x )</annotation></semantics></math> is the number of errors in <math alttext="x" class="ltx_Math" display="inline" id="S3.SS1.SSS3.Px1.p3.4.m4.1"><semantics id="S3.SS1.SSS3.Px1.p3.4.m4.1a"><mi id="S3.SS1.SSS3.Px1.p3.4.m4.1.1" xref="S3.SS1.SSS3.Px1.p3.4.m4.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.Px1.p3.4.m4.1b"><ci id="S3.SS1.SSS3.Px1.p3.4.m4.1.1.cmml" xref="S3.SS1.SSS3.Px1.p3.4.m4.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.Px1.p3.4.m4.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.Px1.p3.4.m4.1d">italic_x</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS3.Px1.p4">
<p class="ltx_p" id="S3.SS1.SSS3.Px1.p4.1">This comparison function can be extended to evaluate the best output of any finite <math alttext="n" class="ltx_Math" display="inline" id="S3.SS1.SSS3.Px1.p4.1.m1.1"><semantics id="S3.SS1.SSS3.Px1.p4.1.m1.1a"><mi id="S3.SS1.SSS3.Px1.p4.1.m1.1.1" xref="S3.SS1.SSS3.Px1.p4.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.Px1.p4.1.m1.1b"><ci id="S3.SS1.SSS3.Px1.p4.1.m1.1.1.cmml" xref="S3.SS1.SSS3.Px1.p4.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.Px1.p4.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.Px1.p4.1.m1.1d">italic_n</annotation></semantics></math> via induction.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS3.Px1.p5">
<p class="ltx_p" id="S3.SS1.SSS3.Px1.p5.2">This best-of-n technique is implemented as a curried function such that each of the <math alttext="n" class="ltx_Math" display="inline" id="S3.SS1.SSS3.Px1.p5.1.m1.1"><semantics id="S3.SS1.SSS3.Px1.p5.1.m1.1a"><mi id="S3.SS1.SSS3.Px1.p5.1.m1.1.1" xref="S3.SS1.SSS3.Px1.p5.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.Px1.p5.1.m1.1b"><ci id="S3.SS1.SSS3.Px1.p5.1.m1.1.1.cmml" xref="S3.SS1.SSS3.Px1.p5.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.Px1.p5.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.Px1.p5.1.m1.1d">italic_n</annotation></semantics></math> calls can be handled by any arbitrary sampling method, or just a single standard prompt at user discretion. It utilizes thread-based parallelism to speed up the relatively large number of calls to the language model, as well as process-based parallelism for the <math alttext="n" class="ltx_Math" display="inline" id="S3.SS1.SSS3.Px1.p5.2.m2.1"><semantics id="S3.SS1.SSS3.Px1.p5.2.m2.1a"><mi id="S3.SS1.SSS3.Px1.p5.2.m2.1.1" xref="S3.SS1.SSS3.Px1.p5.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.Px1.p5.2.m2.1b"><ci id="S3.SS1.SSS3.Px1.p5.2.m2.1.1.cmml" xref="S3.SS1.SSS3.Px1.p5.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.Px1.p5.2.m2.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.Px1.p5.2.m2.1d">italic_n</annotation></semantics></math> evaluation calls to the Lean language server.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS1.SSS3.Px2">
<h5 class="ltx_title ltx_title_paragraph">Error correction and Refinement</h5>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS3.Px2.p1">
<p class="ltx_p" id="S3.SS1.SSS3.Px2.p1.1">Inspired by self-debugging techniques in code generation <cite class="ltx_cite ltx_citemacro_citep">(Madaan et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#bib.bib15" title="">2023</a>; Chen et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#bib.bib4" title="">2023</a>)</cite>, <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S3.SS1.SSS3.Px2.p1.1.m1.1"><semantics id="S3.SS1.SSS3.Px2.p1.1.m1.1a"><mi id="S3.SS1.SSS3.Px2.p1.1.m1.1.1" xref="S3.SS1.SSS3.Px2.p1.1.m1.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.Px2.p1.1.m1.1b"><ci id="S3.SS1.SSS3.Px2.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS3.Px2.p1.1.m1.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.Px2.p1.1.m1.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.Px2.p1.1.m1.1d">roman_ImProver</annotation></semantics></math> identifies and corrects errors in the generated proofs by iteratively refining its outputs.
The refinement process relies on user-defined parameters <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.SSS3.Px2.p1.1.1">n</code> and <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.SSS3.Px2.p1.1.2">prev_num</code> to specify the number of iterations and the number of previous iteration info to forward, respectively. Each iteration carries information on the last <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.SSS3.Px2.p1.1.3">prev_num</code> iterations, including input, output, metric score, correctness, and error messages.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS3.Px2.p2">
<p class="ltx_p" id="S3.SS1.SSS3.Px2.p2.1">The refinement technique iteratively improves the prompt output by feeding back the results into the prompt function, additionally forwarding errors and metric scores. Similar to the best-of-n technique, it relies on an argument <math alttext="n" class="ltx_Math" display="inline" id="S3.SS1.SSS3.Px2.p2.1.m1.1"><semantics id="S3.SS1.SSS3.Px2.p2.1.m1.1a"><mi id="S3.SS1.SSS3.Px2.p2.1.m1.1.1" xref="S3.SS1.SSS3.Px2.p2.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.Px2.p2.1.m1.1b"><ci id="S3.SS1.SSS3.Px2.p2.1.m1.1.1.cmml" xref="S3.SS1.SSS3.Px2.p2.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.Px2.p2.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.Px2.p2.1.m1.1d">italic_n</annotation></semantics></math> for the number of refinement steps, and is curried such that each refinement step can be handled by any other prompting function. However, unlike best-of-n, there is no opportunity for parallelism as each iteration is dependent on information from the previous call.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS1.SSS3.Px3">
<h5 class="ltx_title ltx_title_paragraph">Combination Sampling and Compound Prompt Functions</h5>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS3.Px3.p1">
<p class="ltx_p" id="S3.SS1.SSS3.Px3.p1.1">Compound prompt functions utilize the curried nature of the implementations of best-of-n and refinement to nest these techniques within one another. For example:</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS3.Px3.p2">
<p class="ltx_p" id="S3.SS1.SSS3.Px3.p2.2"><code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.SSS3.Px3.p2.2.3">best_of_n((refinement,m),n)</code><span class="ltx_text" id="S3.SS1.SSS3.Px3.p2.2.2"> is a compound sampling method that run a best-of-<math alttext="n" class="ltx_Math" display="inline" id="S3.SS1.SSS3.Px3.p2.1.1.m1.1"><semantics id="S3.SS1.SSS3.Px3.p2.1.1.m1.1a"><mi id="S3.SS1.SSS3.Px3.p2.1.1.m1.1.1" xref="S3.SS1.SSS3.Px3.p2.1.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.Px3.p2.1.1.m1.1b"><ci id="S3.SS1.SSS3.Px3.p2.1.1.m1.1.1.cmml" xref="S3.SS1.SSS3.Px3.p2.1.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.Px3.p2.1.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.Px3.p2.1.1.m1.1d">italic_n</annotation></semantics></math>, where each call is a <math alttext="m" class="ltx_Math" display="inline" id="S3.SS1.SSS3.Px3.p2.2.2.m2.1"><semantics id="S3.SS1.SSS3.Px3.p2.2.2.m2.1a"><mi id="S3.SS1.SSS3.Px3.p2.2.2.m2.1.1" xref="S3.SS1.SSS3.Px3.p2.2.2.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.Px3.p2.2.2.m2.1b"><ci id="S3.SS1.SSS3.Px3.p2.2.2.m2.1.1.cmml" xref="S3.SS1.SSS3.Px3.p2.2.2.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.Px3.p2.2.2.m2.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.Px3.p2.2.2.m2.1d">italic_m</annotation></semantics></math>-step refinement.</span></p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS3.Px3.p3">
<p class="ltx_p" id="S3.SS1.SSS3.Px3.p3.2"><code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.SSS3.Px3.p3.2.3">refinement((best_of_n,m),n)</code><span class="ltx_text" id="S3.SS1.SSS3.Px3.p3.2.2"> is a compound sampling method that runs a <math alttext="n" class="ltx_Math" display="inline" id="S3.SS1.SSS3.Px3.p3.1.1.m1.1"><semantics id="S3.SS1.SSS3.Px3.p3.1.1.m1.1a"><mi id="S3.SS1.SSS3.Px3.p3.1.1.m1.1.1" xref="S3.SS1.SSS3.Px3.p3.1.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.Px3.p3.1.1.m1.1b"><ci id="S3.SS1.SSS3.Px3.p3.1.1.m1.1.1.cmml" xref="S3.SS1.SSS3.Px3.p3.1.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.Px3.p3.1.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.Px3.p3.1.1.m1.1d">italic_n</annotation></semantics></math>-step refinement, where each call is a best-of-<math alttext="m" class="ltx_Math" display="inline" id="S3.SS1.SSS3.Px3.p3.2.2.m2.1"><semantics id="S3.SS1.SSS3.Px3.p3.2.2.m2.1a"><mi id="S3.SS1.SSS3.Px3.p3.2.2.m2.1.1" xref="S3.SS1.SSS3.Px3.p3.2.2.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.Px3.p3.2.2.m2.1b"><ci id="S3.SS1.SSS3.Px3.p3.2.2.m2.1.1.cmml" xref="S3.SS1.SSS3.Px3.p3.2.2.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.Px3.p3.2.2.m2.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.Px3.p3.2.2.m2.1d">italic_m</annotation></semantics></math> call to the LLM.</span></p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS3.Px3.p4">
<p class="ltx_p" id="S3.SS1.SSS3.Px3.p4.1">Note that with each of these compound prompt functions, there are always a total of <math alttext="mn" class="ltx_Math" display="inline" id="S3.SS1.SSS3.Px3.p4.1.m1.1"><semantics id="S3.SS1.SSS3.Px3.p4.1.m1.1a"><mrow id="S3.SS1.SSS3.Px3.p4.1.m1.1.1" xref="S3.SS1.SSS3.Px3.p4.1.m1.1.1.cmml"><mi id="S3.SS1.SSS3.Px3.p4.1.m1.1.1.2" xref="S3.SS1.SSS3.Px3.p4.1.m1.1.1.2.cmml">m</mi><mo id="S3.SS1.SSS3.Px3.p4.1.m1.1.1.1" xref="S3.SS1.SSS3.Px3.p4.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.SS1.SSS3.Px3.p4.1.m1.1.1.3" xref="S3.SS1.SSS3.Px3.p4.1.m1.1.1.3.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.Px3.p4.1.m1.1b"><apply id="S3.SS1.SSS3.Px3.p4.1.m1.1.1.cmml" xref="S3.SS1.SSS3.Px3.p4.1.m1.1.1"><times id="S3.SS1.SSS3.Px3.p4.1.m1.1.1.1.cmml" xref="S3.SS1.SSS3.Px3.p4.1.m1.1.1.1"></times><ci id="S3.SS1.SSS3.Px3.p4.1.m1.1.1.2.cmml" xref="S3.SS1.SSS3.Px3.p4.1.m1.1.1.2">𝑚</ci><ci id="S3.SS1.SSS3.Px3.p4.1.m1.1.1.3.cmml" xref="S3.SS1.SSS3.Px3.p4.1.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.Px3.p4.1.m1.1c">mn</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.Px3.p4.1.m1.1d">italic_m italic_n</annotation></semantics></math> iterations.</p>
</div>
</section>
</section>
<section class="ltx_subsubsection" id="S3.SS1.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.4 </span>Retrieval</h4>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS4.p1">
<p class="ltx_p" id="S3.SS1.SSS4.p1.1"><math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S3.SS1.SSS4.p1.1.m1.1"><semantics id="S3.SS1.SSS4.p1.1.m1.1a"><mi id="S3.SS1.SSS4.p1.1.m1.1.1" xref="S3.SS1.SSS4.p1.1.m1.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p1.1.m1.1b"><ci id="S3.SS1.SSS4.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS4.p1.1.m1.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p1.1.m1.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS4.p1.1.m1.1d">roman_ImProver</annotation></semantics></math> uses MMR (Maximum Marginal Relevance)-based <cite class="ltx_cite ltx_citemacro_citep">(Carbonell &amp; Goldstein, <a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#bib.bib3" title="">1998</a>)</cite> retrieval-augmented generation to select relevant examples and documents.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS4.p2">
<p class="ltx_p" id="S3.SS1.SSS4.p2.1">More specifically, example retrieval selects the most relevant user-generated examples of proof optimization on a specific metric. Namely, each metric is loaded with a cached (vector) database populated with human-made examples of preoptimized and postoptimized pairs of Lean theorems. The number of examples that are retrieved is user-specified.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS4.p3">
<p class="ltx_p" id="S3.SS1.SSS4.p3.1">Document retrieval extracts information using MMR from a pair of fixed (vector) databases. The databases store semantically chunked data from the Theorem Proving in Lean (TPiL) handbook – containing syntax guides and tactic explanations – and the Mathlib mathematics libary – containing thousands of theorems and lemmas. The chunking is handled by a recursive character splitter, which splits the TPiL markdown files at on its headers and Mathlib files at the start of theorems, examples, lemmas, and definitions – with chunk sizes of 1000 characters with a 200 character overlap.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS4.p4">
<p class="ltx_p" id="S3.SS1.SSS4.p4.2">The Mathlib retriever finds the top <math alttext="k" class="ltx_Math" display="inline" id="S3.SS1.SSS4.p4.1.m1.1"><semantics id="S3.SS1.SSS4.p4.1.m1.1a"><mi id="S3.SS1.SSS4.p4.1.m1.1.1" xref="S3.SS1.SSS4.p4.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p4.1.m1.1b"><ci id="S3.SS1.SSS4.p4.1.m1.1.1.cmml" xref="S3.SS1.SSS4.p4.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p4.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS4.p4.1.m1.1d">italic_k</annotation></semantics></math> documents that score the highest MMR score against the current theorem, the TPiL retriever finds the top <math alttext="k" class="ltx_Math" display="inline" id="S3.SS1.SSS4.p4.2.m2.1"><semantics id="S3.SS1.SSS4.p4.2.m2.1a"><mi id="S3.SS1.SSS4.p4.2.m2.1.1" xref="S3.SS1.SSS4.p4.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p4.2.m2.1b"><ci id="S3.SS1.SSS4.p4.2.m2.1.1.cmml" xref="S3.SS1.SSS4.p4.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p4.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS4.p4.2.m2.1d">italic_k</annotation></semantics></math> documents that score the highest MMR score against the current theorem in context and all current error messages. This retrieval process helps in generating more contextually accurate prompts that allow the language model to better correct its own errors as well as find useful lemmas to reference.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>
<div class="ltx_para ltx_noindent" id="S4.p1">
<p class="ltx_p" id="S4.p1.2">We test <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S4.p1.1.m1.1"><semantics id="S4.p1.1.m1.1a"><mi id="S4.p1.1.m1.1.1" xref="S4.p1.1.m1.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S4.p1.1.m1.1b"><ci id="S4.p1.1.m1.1.1.cmml" xref="S4.p1.1.m1.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.1.m1.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S4.p1.1.m1.1d">roman_ImProver</annotation></semantics></math> on rewriting real-world undergraduate theorems, competition problems, and research-level mathematics and compare its results to those of the base GPT-4o and GPT-4o-mini models. We examine the optimization capabilities of <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S4.p1.2.m2.1"><semantics id="S4.p1.2.m2.1a"><mi id="S4.p1.2.m2.1.1" xref="S4.p1.2.m2.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S4.p1.2.m2.1b"><ci id="S4.p1.2.m2.1.1.cmml" xref="S4.p1.2.m2.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.2.m2.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S4.p1.2.m2.1d">roman_ImProver</annotation></semantics></math> for the length and readability metrics - studying the effectiveness in maintaining the correctness of the tactic proof while making it more concise, as well as making it more declarative in style and readable in practice.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Setup</h3>
<div class="ltx_para ltx_noindent" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.3">Our experimentation is split into three distinct stages. We first perform ablation testing on the <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><mi id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">roman_ImProver</annotation></semantics></math> model parameters (§<a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#S3.SS1" title="3.1 Improver ‣ 3 Automated Proof Optimization with ImProver ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_tag">3.1</span></a>) to ensure that <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.1"><semantics id="S4.SS1.p1.2.m2.1a"><mi id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><ci id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m2.1d">roman_ImProver</annotation></semantics></math>’s parameter specification is the optimal one with respect to correctness and metric optimization score. We then evaluate this optimal parameter combination on datasets of varying complexity and analyze the performance and results thereof. Lastly, we note the performance of <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S4.SS1.p1.3.m3.1"><semantics id="S4.SS1.p1.3.m3.1a"><mi id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><ci id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.3.m3.1d">roman_ImProver</annotation></semantics></math> in NTP applications in comparison to the base GPT-4o and GPT-4o-mini models.</p>
</div>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Datasets.</h5>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px1.p1.1">We evaluate <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.1.m1.1"><semantics id="S4.SS1.SSS0.Px1.p1.1.m1.1a"><mi id="S4.SS1.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.1.m1.1b"><ci id="S4.SS1.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.1.m1.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.1.m1.1d">roman_ImProver</annotation></semantics></math> on subsets of the following datasets.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS0.Px1.p2">
<p class="ltx_p" id="S4.SS1.SSS0.Px1.p2.3"><span class="ltx_text ltx_font_italic" id="S4.SS1.SSS0.Px1.p2.3.1">Mathematics in Lean (MIL) <cite class="ltx_cite ltx_citemacro_citep">(leanprover-community, <a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#bib.bib12" title="">2024</a>)</cite>: </span> this dataset contains pedagogical solutions of common undergraduate-level exercises, and as such contains many readable, yet verbose and inefficient proofs.
We use exercise solutions from set theory, elementary number theory, group theory, topology, differential calculus, and integration &amp; measure theory. This dataset contains theorems at an undergraduate-level of complexity.
For our main results, we evaluated on <math alttext="72" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p2.1.m1.1"><semantics id="S4.SS1.SSS0.Px1.p2.1.m1.1a"><mn id="S4.SS1.SSS0.Px1.p2.1.m1.1.1" xref="S4.SS1.SSS0.Px1.p2.1.m1.1.1.cmml">72</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.1.m1.1b"><cn id="S4.SS1.SSS0.Px1.p2.1.m1.1.1.cmml" type="integer" xref="S4.SS1.SSS0.Px1.p2.1.m1.1.1">72</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.1.m1.1c">72</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p2.1.m1.1d">72</annotation></semantics></math> theorems from exercise solutions from MIL chapters <math alttext="4,5,8,9," class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p2.2.m2.5"><semantics id="S4.SS1.SSS0.Px1.p2.2.m2.5a"><mrow id="S4.SS1.SSS0.Px1.p2.2.m2.5.5.1"><mrow id="S4.SS1.SSS0.Px1.p2.2.m2.5.5.1.1.2" xref="S4.SS1.SSS0.Px1.p2.2.m2.5.5.1.1.1.cmml"><mn id="S4.SS1.SSS0.Px1.p2.2.m2.1.1" xref="S4.SS1.SSS0.Px1.p2.2.m2.1.1.cmml">4</mn><mo id="S4.SS1.SSS0.Px1.p2.2.m2.5.5.1.1.2.1" xref="S4.SS1.SSS0.Px1.p2.2.m2.5.5.1.1.1.cmml">,</mo><mn id="S4.SS1.SSS0.Px1.p2.2.m2.2.2" xref="S4.SS1.SSS0.Px1.p2.2.m2.2.2.cmml">5</mn><mo id="S4.SS1.SSS0.Px1.p2.2.m2.5.5.1.1.2.2" xref="S4.SS1.SSS0.Px1.p2.2.m2.5.5.1.1.1.cmml">,</mo><mn id="S4.SS1.SSS0.Px1.p2.2.m2.3.3" xref="S4.SS1.SSS0.Px1.p2.2.m2.3.3.cmml">8</mn><mo id="S4.SS1.SSS0.Px1.p2.2.m2.5.5.1.1.2.3" xref="S4.SS1.SSS0.Px1.p2.2.m2.5.5.1.1.1.cmml">,</mo><mn id="S4.SS1.SSS0.Px1.p2.2.m2.4.4" xref="S4.SS1.SSS0.Px1.p2.2.m2.4.4.cmml">9</mn></mrow><mo id="S4.SS1.SSS0.Px1.p2.2.m2.5.5.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.2.m2.5b"><list id="S4.SS1.SSS0.Px1.p2.2.m2.5.5.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.2.m2.5.5.1.1.2"><cn id="S4.SS1.SSS0.Px1.p2.2.m2.1.1.cmml" type="integer" xref="S4.SS1.SSS0.Px1.p2.2.m2.1.1">4</cn><cn id="S4.SS1.SSS0.Px1.p2.2.m2.2.2.cmml" type="integer" xref="S4.SS1.SSS0.Px1.p2.2.m2.2.2">5</cn><cn id="S4.SS1.SSS0.Px1.p2.2.m2.3.3.cmml" type="integer" xref="S4.SS1.SSS0.Px1.p2.2.m2.3.3">8</cn><cn id="S4.SS1.SSS0.Px1.p2.2.m2.4.4.cmml" type="integer" xref="S4.SS1.SSS0.Px1.p2.2.m2.4.4">9</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.2.m2.5c">4,5,8,9,</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p2.2.m2.5d">4 , 5 , 8 , 9 ,</annotation></semantics></math> and <math alttext="10" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p2.3.m3.1"><semantics id="S4.SS1.SSS0.Px1.p2.3.m3.1a"><mn id="S4.SS1.SSS0.Px1.p2.3.m3.1.1" xref="S4.SS1.SSS0.Px1.p2.3.m3.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.3.m3.1b"><cn id="S4.SS1.SSS0.Px1.p2.3.m3.1.1.cmml" type="integer" xref="S4.SS1.SSS0.Px1.p2.3.m3.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.3.m3.1c">10</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p2.3.m3.1d">10</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS0.Px1.p3">
<p class="ltx_p" id="S4.SS1.SSS0.Px1.p3.1"><span class="ltx_text ltx_font_italic" id="S4.SS1.SSS0.Px1.p3.1.1">Compfiles <cite class="ltx_cite ltx_citemacro_citep">(David Renshaw, <a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#bib.bib5" title="">2024</a>)</cite>: </span> Solutions of International Mathematics Olympiad (IMO) and American Mathematics Olympiad (USAMO) competition problems from 2016 to 2024. This is a dataset of internationally-renowned competitive math problems, many of which are readable, yet quite verbose. This dataset contains theorems of a competitive format, and although they contain concepts only at a high-school level, the logical complexity of internationally-renowned competition results is far above that.
For our main results, we used all <math alttext="26" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p3.1.m1.1"><semantics id="S4.SS1.SSS0.Px1.p3.1.m1.1a"><mn id="S4.SS1.SSS0.Px1.p3.1.m1.1.1" xref="S4.SS1.SSS0.Px1.p3.1.m1.1.1.cmml">26</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p3.1.m1.1b"><cn id="S4.SS1.SSS0.Px1.p3.1.m1.1.1.cmml" type="integer" xref="S4.SS1.SSS0.Px1.p3.1.m1.1.1">26</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p3.1.m1.1c">26</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p3.1.m1.1d">26</annotation></semantics></math> theorems and lemmas from the Compfiles database of complete solutions to the International Mathematics Olympiad (IMO) and the American Mathematics Olympiad (USAMO) from 2016-2024.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS0.Px1.p4">
<p class="ltx_p" id="S4.SS1.SSS0.Px1.p4.1"><span class="ltx_text ltx_font_italic" id="S4.SS1.SSS0.Px1.p4.1.1">Mathlib <cite class="ltx_cite ltx_citemacro_citep">(mathlib Community, <a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#bib.bib16" title="">2020</a>)</cite>:</span> Mathlib contains many advanced results at the forefront of mathematics, and has been at the center of research-level formalizations. These proofs are extremely efficient, concise, and generalized - which often comes at the cost of readability and understandability. These results and theorems often are at the cutting edge of research.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS0.Px1.p5">
<p class="ltx_p" id="S4.SS1.SSS0.Px1.p5.1">For our main results, we evaluated our methods on <math alttext="43" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p5.1.m1.1"><semantics id="S4.SS1.SSS0.Px1.p5.1.m1.1a"><mn id="S4.SS1.SSS0.Px1.p5.1.m1.1.1" xref="S4.SS1.SSS0.Px1.p5.1.m1.1.1.cmml">43</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p5.1.m1.1b"><cn id="S4.SS1.SSS0.Px1.p5.1.m1.1.1.cmml" type="integer" xref="S4.SS1.SSS0.Px1.p5.1.m1.1.1">43</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p5.1.m1.1c">43</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p5.1.m1.1d">43</annotation></semantics></math> advanced research-level proofs from <span class="ltx_text ltx_font_typewriter" id="S4.SS1.SSS0.Px1.p5.1.1">Mathlib/AlgebraicTopology/FundamentalGroupoid</span>. This is the most difficult dataset.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Models.</h5>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px2.p1.1">Our base generator uses GPT-4o <cite class="ltx_cite ltx_citemacro_citep">(OpenAI et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#bib.bib18" title="">2024</a>)</cite>. Since no prior methods currently exist for automated proof optimization, we consider a prompted GPT-4o without the improvements described in (§<a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#S3.SS1" title="3.1 Improver ‣ 3 Automated Proof Optimization with ImProver ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_tag">3.1</span></a>) as our baseline. Additionally, for a given metric, we write a prompt that briefly describes the metric and the proof optimization task. We also provide instructions, context, and information depending on the features selected, and add the theorem and proof to the prompt. Specific prompt information is detailed in (§<a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#A1" title="Appendix A Prompts ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_tag">A</span></a>)</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Performance metrics.</h5>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS0.Px3.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px3.p1.1">Since proof optimization is a new task, we define four performance metrics for measuring aspects of correctness and improvement.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS0.Px3.p2">
<p class="ltx_p" id="S4.SS1.SSS0.Px3.p2.2">First, we define <span class="ltx_text ltx_font_bold" id="S4.SS1.SSS0.Px3.p2.2.1">improvement</span> for length as percentage change in length, <math alttext="\frac{\mu_{\text{len}}(y_{0})-\mu_{\text{len}}(y)}{\mu_{\text{len}}(y_{0})}%
\times 100" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px3.p2.1.m1.3"><semantics id="S4.SS1.SSS0.Px3.p2.1.m1.3a"><mrow id="S4.SS1.SSS0.Px3.p2.1.m1.3.4" xref="S4.SS1.SSS0.Px3.p2.1.m1.3.4.cmml"><mfrac id="S4.SS1.SSS0.Px3.p2.1.m1.3.3" xref="S4.SS1.SSS0.Px3.p2.1.m1.3.3.cmml"><mrow id="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2" xref="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.cmml"><mrow id="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.2" xref="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.2.cmml"><msub id="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.2.3" xref="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.2.3.cmml"><mi id="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.2.3.2" xref="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.2.3.2.cmml">μ</mi><mtext id="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.2.3.3" xref="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.2.3.3a.cmml">len</mtext></msub><mo id="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.2.2" xref="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.2.2.cmml">⁢</mo><mrow id="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.2.1.1" xref="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.2.1.1.1.cmml"><mo id="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.2.1.1.2" stretchy="false" xref="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.2.1.1.1.cmml">(</mo><msub id="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.2.1.1.1" xref="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.2.1.1.1.cmml"><mi id="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.2.1.1.1.2" xref="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.2.1.1.1.2.cmml">y</mi><mn id="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.2.1.1.1.3" xref="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.2.1.1.1.3.cmml">0</mn></msub><mo id="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.2.1.1.3" stretchy="false" xref="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.3" xref="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.3.cmml">−</mo><mrow id="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.4" xref="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.4.cmml"><msub id="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.4.2" xref="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.4.2.cmml"><mi id="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.4.2.2" xref="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.4.2.2.cmml">μ</mi><mtext id="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.4.2.3" xref="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.4.2.3a.cmml">len</mtext></msub><mo id="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.4.1" xref="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.4.1.cmml">⁢</mo><mrow id="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.4.3.2" xref="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.4.cmml"><mo id="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.4.3.2.1" stretchy="false" xref="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.4.cmml">(</mo><mi id="S4.SS1.SSS0.Px3.p2.1.m1.1.1.1.1" xref="S4.SS1.SSS0.Px3.p2.1.m1.1.1.1.1.cmml">y</mi><mo id="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.4.3.2.2" stretchy="false" xref="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.4.cmml">)</mo></mrow></mrow></mrow><mrow id="S4.SS1.SSS0.Px3.p2.1.m1.3.3.3" xref="S4.SS1.SSS0.Px3.p2.1.m1.3.3.3.cmml"><msub id="S4.SS1.SSS0.Px3.p2.1.m1.3.3.3.3" xref="S4.SS1.SSS0.Px3.p2.1.m1.3.3.3.3.cmml"><mi id="S4.SS1.SSS0.Px3.p2.1.m1.3.3.3.3.2" xref="S4.SS1.SSS0.Px3.p2.1.m1.3.3.3.3.2.cmml">μ</mi><mtext id="S4.SS1.SSS0.Px3.p2.1.m1.3.3.3.3.3" xref="S4.SS1.SSS0.Px3.p2.1.m1.3.3.3.3.3a.cmml">len</mtext></msub><mo id="S4.SS1.SSS0.Px3.p2.1.m1.3.3.3.2" xref="S4.SS1.SSS0.Px3.p2.1.m1.3.3.3.2.cmml">⁢</mo><mrow id="S4.SS1.SSS0.Px3.p2.1.m1.3.3.3.1.1" xref="S4.SS1.SSS0.Px3.p2.1.m1.3.3.3.1.1.1.cmml"><mo id="S4.SS1.SSS0.Px3.p2.1.m1.3.3.3.1.1.2" stretchy="false" xref="S4.SS1.SSS0.Px3.p2.1.m1.3.3.3.1.1.1.cmml">(</mo><msub id="S4.SS1.SSS0.Px3.p2.1.m1.3.3.3.1.1.1" xref="S4.SS1.SSS0.Px3.p2.1.m1.3.3.3.1.1.1.cmml"><mi id="S4.SS1.SSS0.Px3.p2.1.m1.3.3.3.1.1.1.2" xref="S4.SS1.SSS0.Px3.p2.1.m1.3.3.3.1.1.1.2.cmml">y</mi><mn id="S4.SS1.SSS0.Px3.p2.1.m1.3.3.3.1.1.1.3" xref="S4.SS1.SSS0.Px3.p2.1.m1.3.3.3.1.1.1.3.cmml">0</mn></msub><mo id="S4.SS1.SSS0.Px3.p2.1.m1.3.3.3.1.1.3" stretchy="false" xref="S4.SS1.SSS0.Px3.p2.1.m1.3.3.3.1.1.1.cmml">)</mo></mrow></mrow></mfrac><mo id="S4.SS1.SSS0.Px3.p2.1.m1.3.4.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.SSS0.Px3.p2.1.m1.3.4.1.cmml">×</mo><mn id="S4.SS1.SSS0.Px3.p2.1.m1.3.4.2" xref="S4.SS1.SSS0.Px3.p2.1.m1.3.4.2.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p2.1.m1.3b"><apply id="S4.SS1.SSS0.Px3.p2.1.m1.3.4.cmml" xref="S4.SS1.SSS0.Px3.p2.1.m1.3.4"><times id="S4.SS1.SSS0.Px3.p2.1.m1.3.4.1.cmml" xref="S4.SS1.SSS0.Px3.p2.1.m1.3.4.1"></times><apply id="S4.SS1.SSS0.Px3.p2.1.m1.3.3.cmml" xref="S4.SS1.SSS0.Px3.p2.1.m1.3.3"><divide id="S4.SS1.SSS0.Px3.p2.1.m1.3.3.4.cmml" xref="S4.SS1.SSS0.Px3.p2.1.m1.3.3"></divide><apply id="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.cmml" xref="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2"><minus id="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.3"></minus><apply id="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.2.cmml" xref="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.2"><times id="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.2.2.cmml" xref="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.2.2"></times><apply id="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.2.3.1.cmml" xref="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.2.3">subscript</csymbol><ci id="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.2.3.2.cmml" xref="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.2.3.2">𝜇</ci><ci id="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.2.3.3a.cmml" xref="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.2.3.3"><mtext id="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.2.3.3.cmml" mathsize="50%" xref="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.2.3.3">len</mtext></ci></apply><apply id="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.2.1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.2.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.2.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.2.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.2.1.1.1.2">𝑦</ci><cn id="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.2.1.1.1.3.cmml" type="integer" xref="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.2.1.1.1.3">0</cn></apply></apply><apply id="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.4.cmml" xref="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.4"><times id="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.4.1.cmml" xref="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.4.1"></times><apply id="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.4.2.cmml" xref="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.4.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.4.2.1.cmml" xref="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.4.2">subscript</csymbol><ci id="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.4.2.2.cmml" xref="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.4.2.2">𝜇</ci><ci id="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.4.2.3a.cmml" xref="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.4.2.3"><mtext id="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.4.2.3.cmml" mathsize="50%" xref="S4.SS1.SSS0.Px3.p2.1.m1.2.2.2.4.2.3">len</mtext></ci></apply><ci id="S4.SS1.SSS0.Px3.p2.1.m1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p2.1.m1.1.1.1.1">𝑦</ci></apply></apply><apply id="S4.SS1.SSS0.Px3.p2.1.m1.3.3.3.cmml" xref="S4.SS1.SSS0.Px3.p2.1.m1.3.3.3"><times id="S4.SS1.SSS0.Px3.p2.1.m1.3.3.3.2.cmml" xref="S4.SS1.SSS0.Px3.p2.1.m1.3.3.3.2"></times><apply id="S4.SS1.SSS0.Px3.p2.1.m1.3.3.3.3.cmml" xref="S4.SS1.SSS0.Px3.p2.1.m1.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p2.1.m1.3.3.3.3.1.cmml" xref="S4.SS1.SSS0.Px3.p2.1.m1.3.3.3.3">subscript</csymbol><ci id="S4.SS1.SSS0.Px3.p2.1.m1.3.3.3.3.2.cmml" xref="S4.SS1.SSS0.Px3.p2.1.m1.3.3.3.3.2">𝜇</ci><ci id="S4.SS1.SSS0.Px3.p2.1.m1.3.3.3.3.3a.cmml" xref="S4.SS1.SSS0.Px3.p2.1.m1.3.3.3.3.3"><mtext id="S4.SS1.SSS0.Px3.p2.1.m1.3.3.3.3.3.cmml" mathsize="50%" xref="S4.SS1.SSS0.Px3.p2.1.m1.3.3.3.3.3">len</mtext></ci></apply><apply id="S4.SS1.SSS0.Px3.p2.1.m1.3.3.3.1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p2.1.m1.3.3.3.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p2.1.m1.3.3.3.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p2.1.m1.3.3.3.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px3.p2.1.m1.3.3.3.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px3.p2.1.m1.3.3.3.1.1.1.2">𝑦</ci><cn id="S4.SS1.SSS0.Px3.p2.1.m1.3.3.3.1.1.1.3.cmml" type="integer" xref="S4.SS1.SSS0.Px3.p2.1.m1.3.3.3.1.1.1.3">0</cn></apply></apply></apply><cn id="S4.SS1.SSS0.Px3.p2.1.m1.3.4.2.cmml" type="integer" xref="S4.SS1.SSS0.Px3.p2.1.m1.3.4.2">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p2.1.m1.3c">\frac{\mu_{\text{len}}(y_{0})-\mu_{\text{len}}(y)}{\mu_{\text{len}}(y_{0})}%
\times 100</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px3.p2.1.m1.3d">divide start_ARG italic_μ start_POSTSUBSCRIPT len end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) - italic_μ start_POSTSUBSCRIPT len end_POSTSUBSCRIPT ( italic_y ) end_ARG start_ARG italic_μ start_POSTSUBSCRIPT len end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) end_ARG × 100</annotation></semantics></math>.
For readability, we use the difference, <math alttext="\mu_{\text{read}}(y)-\mu_{\text{read}}(y_{o})" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px3.p2.2.m2.2"><semantics id="S4.SS1.SSS0.Px3.p2.2.m2.2a"><mrow id="S4.SS1.SSS0.Px3.p2.2.m2.2.2" xref="S4.SS1.SSS0.Px3.p2.2.m2.2.2.cmml"><mrow id="S4.SS1.SSS0.Px3.p2.2.m2.2.2.3" xref="S4.SS1.SSS0.Px3.p2.2.m2.2.2.3.cmml"><msub id="S4.SS1.SSS0.Px3.p2.2.m2.2.2.3.2" xref="S4.SS1.SSS0.Px3.p2.2.m2.2.2.3.2.cmml"><mi id="S4.SS1.SSS0.Px3.p2.2.m2.2.2.3.2.2" xref="S4.SS1.SSS0.Px3.p2.2.m2.2.2.3.2.2.cmml">μ</mi><mtext id="S4.SS1.SSS0.Px3.p2.2.m2.2.2.3.2.3" xref="S4.SS1.SSS0.Px3.p2.2.m2.2.2.3.2.3a.cmml">read</mtext></msub><mo id="S4.SS1.SSS0.Px3.p2.2.m2.2.2.3.1" xref="S4.SS1.SSS0.Px3.p2.2.m2.2.2.3.1.cmml">⁢</mo><mrow id="S4.SS1.SSS0.Px3.p2.2.m2.2.2.3.3.2" xref="S4.SS1.SSS0.Px3.p2.2.m2.2.2.3.cmml"><mo id="S4.SS1.SSS0.Px3.p2.2.m2.2.2.3.3.2.1" stretchy="false" xref="S4.SS1.SSS0.Px3.p2.2.m2.2.2.3.cmml">(</mo><mi id="S4.SS1.SSS0.Px3.p2.2.m2.1.1" xref="S4.SS1.SSS0.Px3.p2.2.m2.1.1.cmml">y</mi><mo id="S4.SS1.SSS0.Px3.p2.2.m2.2.2.3.3.2.2" stretchy="false" xref="S4.SS1.SSS0.Px3.p2.2.m2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.SS1.SSS0.Px3.p2.2.m2.2.2.2" xref="S4.SS1.SSS0.Px3.p2.2.m2.2.2.2.cmml">−</mo><mrow id="S4.SS1.SSS0.Px3.p2.2.m2.2.2.1" xref="S4.SS1.SSS0.Px3.p2.2.m2.2.2.1.cmml"><msub id="S4.SS1.SSS0.Px3.p2.2.m2.2.2.1.3" xref="S4.SS1.SSS0.Px3.p2.2.m2.2.2.1.3.cmml"><mi id="S4.SS1.SSS0.Px3.p2.2.m2.2.2.1.3.2" xref="S4.SS1.SSS0.Px3.p2.2.m2.2.2.1.3.2.cmml">μ</mi><mtext id="S4.SS1.SSS0.Px3.p2.2.m2.2.2.1.3.3" xref="S4.SS1.SSS0.Px3.p2.2.m2.2.2.1.3.3a.cmml">read</mtext></msub><mo id="S4.SS1.SSS0.Px3.p2.2.m2.2.2.1.2" xref="S4.SS1.SSS0.Px3.p2.2.m2.2.2.1.2.cmml">⁢</mo><mrow id="S4.SS1.SSS0.Px3.p2.2.m2.2.2.1.1.1" xref="S4.SS1.SSS0.Px3.p2.2.m2.2.2.1.1.1.1.cmml"><mo id="S4.SS1.SSS0.Px3.p2.2.m2.2.2.1.1.1.2" stretchy="false" xref="S4.SS1.SSS0.Px3.p2.2.m2.2.2.1.1.1.1.cmml">(</mo><msub id="S4.SS1.SSS0.Px3.p2.2.m2.2.2.1.1.1.1" xref="S4.SS1.SSS0.Px3.p2.2.m2.2.2.1.1.1.1.cmml"><mi id="S4.SS1.SSS0.Px3.p2.2.m2.2.2.1.1.1.1.2" xref="S4.SS1.SSS0.Px3.p2.2.m2.2.2.1.1.1.1.2.cmml">y</mi><mi id="S4.SS1.SSS0.Px3.p2.2.m2.2.2.1.1.1.1.3" xref="S4.SS1.SSS0.Px3.p2.2.m2.2.2.1.1.1.1.3.cmml">o</mi></msub><mo id="S4.SS1.SSS0.Px3.p2.2.m2.2.2.1.1.1.3" stretchy="false" xref="S4.SS1.SSS0.Px3.p2.2.m2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p2.2.m2.2b"><apply id="S4.SS1.SSS0.Px3.p2.2.m2.2.2.cmml" xref="S4.SS1.SSS0.Px3.p2.2.m2.2.2"><minus id="S4.SS1.SSS0.Px3.p2.2.m2.2.2.2.cmml" xref="S4.SS1.SSS0.Px3.p2.2.m2.2.2.2"></minus><apply id="S4.SS1.SSS0.Px3.p2.2.m2.2.2.3.cmml" xref="S4.SS1.SSS0.Px3.p2.2.m2.2.2.3"><times id="S4.SS1.SSS0.Px3.p2.2.m2.2.2.3.1.cmml" xref="S4.SS1.SSS0.Px3.p2.2.m2.2.2.3.1"></times><apply id="S4.SS1.SSS0.Px3.p2.2.m2.2.2.3.2.cmml" xref="S4.SS1.SSS0.Px3.p2.2.m2.2.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p2.2.m2.2.2.3.2.1.cmml" xref="S4.SS1.SSS0.Px3.p2.2.m2.2.2.3.2">subscript</csymbol><ci id="S4.SS1.SSS0.Px3.p2.2.m2.2.2.3.2.2.cmml" xref="S4.SS1.SSS0.Px3.p2.2.m2.2.2.3.2.2">𝜇</ci><ci id="S4.SS1.SSS0.Px3.p2.2.m2.2.2.3.2.3a.cmml" xref="S4.SS1.SSS0.Px3.p2.2.m2.2.2.3.2.3"><mtext id="S4.SS1.SSS0.Px3.p2.2.m2.2.2.3.2.3.cmml" mathsize="70%" xref="S4.SS1.SSS0.Px3.p2.2.m2.2.2.3.2.3">read</mtext></ci></apply><ci id="S4.SS1.SSS0.Px3.p2.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px3.p2.2.m2.1.1">𝑦</ci></apply><apply id="S4.SS1.SSS0.Px3.p2.2.m2.2.2.1.cmml" xref="S4.SS1.SSS0.Px3.p2.2.m2.2.2.1"><times id="S4.SS1.SSS0.Px3.p2.2.m2.2.2.1.2.cmml" xref="S4.SS1.SSS0.Px3.p2.2.m2.2.2.1.2"></times><apply id="S4.SS1.SSS0.Px3.p2.2.m2.2.2.1.3.cmml" xref="S4.SS1.SSS0.Px3.p2.2.m2.2.2.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p2.2.m2.2.2.1.3.1.cmml" xref="S4.SS1.SSS0.Px3.p2.2.m2.2.2.1.3">subscript</csymbol><ci id="S4.SS1.SSS0.Px3.p2.2.m2.2.2.1.3.2.cmml" xref="S4.SS1.SSS0.Px3.p2.2.m2.2.2.1.3.2">𝜇</ci><ci id="S4.SS1.SSS0.Px3.p2.2.m2.2.2.1.3.3a.cmml" xref="S4.SS1.SSS0.Px3.p2.2.m2.2.2.1.3.3"><mtext id="S4.SS1.SSS0.Px3.p2.2.m2.2.2.1.3.3.cmml" mathsize="70%" xref="S4.SS1.SSS0.Px3.p2.2.m2.2.2.1.3.3">read</mtext></ci></apply><apply id="S4.SS1.SSS0.Px3.p2.2.m2.2.2.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p2.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p2.2.m2.2.2.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p2.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px3.p2.2.m2.2.2.1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px3.p2.2.m2.2.2.1.1.1.1.2">𝑦</ci><ci id="S4.SS1.SSS0.Px3.p2.2.m2.2.2.1.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px3.p2.2.m2.2.2.1.1.1.1.3">𝑜</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p2.2.m2.2c">\mu_{\text{read}}(y)-\mu_{\text{read}}(y_{o})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px3.p2.2.m2.2d">italic_μ start_POSTSUBSCRIPT read end_POSTSUBSCRIPT ( italic_y ) - italic_μ start_POSTSUBSCRIPT read end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT )</annotation></semantics></math>.
If no correct output is generated by the model for a specific theorem, improvement is defined to be zero. We define <span class="ltx_text ltx_font_bold" id="S4.SS1.SSS0.Px3.p2.2.2">nonempty improvement</span> as the improvement restricted to theorems for which some output has nonzero improvement.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS0.Px3.p3">
<p class="ltx_p" id="S4.SS1.SSS0.Px3.p3.1">Intuitively, improvement is the expected improvement in metric score from the input to output, accounting for errors in the generation. The nonempty improvement score is the expected improvement in metric score, given that there are no errors in the generation.
Similar improvement scores can be defined for other metrics using a binary function of the metric assigned to the original and optimized proofs.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS0.Px3.p4">
<p class="ltx_p" id="S4.SS1.SSS0.Px3.p4.1">Additionally, the <span class="ltx_text ltx_font_bold" id="S4.SS1.SSS0.Px3.p4.1.1">accuracy</span> is the percentage of theorems in the dataset which the model was able to generate a correct output for. The <span class="ltx_text ltx_font_bold" id="S4.SS1.SSS0.Px3.p4.1.2">improved accuracy</span> is the percentage of theorems in the dataset which the model was able to generate a correct output for, as well as improve the metric to be nonzero.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.1 </span>Ablations</h4>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS1.p1">
<p class="ltx_p" id="S4.SS1.SSS1.p1.1">When performing our ablation studies, we used a fixed dataset (MIL) and metric (length) and varied the parameters of all the features to find the optimal combination. However, as there are over <math alttext="8640" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p1.1.m1.1"><semantics id="S4.SS1.SSS1.p1.1.m1.1a"><mn id="S4.SS1.SSS1.p1.1.m1.1.1" xref="S4.SS1.SSS1.p1.1.m1.1.1.cmml">8640</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.1.m1.1b"><cn id="S4.SS1.SSS1.p1.1.m1.1.1.cmml" type="integer" xref="S4.SS1.SSS1.p1.1.m1.1.1">8640</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.1.m1.1c">8640</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p1.1.m1.1d">8640</annotation></semantics></math> possible combinations, it is inefficient to test all combinations at once. As such, we evaluate using a factorial testing method.</p>
</div>
<section class="ltx_paragraph" id="S4.SS1.SSS1.Px1">
<h5 class="ltx_title ltx_title_paragraph">Testing Groups.</h5>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS1.Px1.p1">
<p class="ltx_p" id="S4.SS1.SSS1.Px1.p1.1">We define the following testing groups with the specified parameter combinations:</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS1.Px1.p2">
<p class="ltx_p" id="S4.SS1.SSS1.Px1.p2.1"><span class="ltx_text ltx_font_italic" id="S4.SS1.SSS1.Px1.p2.1.1">GPT-4o-mini/GPT-4o: </span>This varies the GPT-4o model, outputting a <span class="ltx_text ltx_font_typewriter" id="S4.SS1.SSS1.Px1.p2.1.2">string</span> with no other features.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS1.Px1.p3">
<p class="ltx_p" id="S4.SS1.SSS1.Px1.p3.1"><span class="ltx_text ltx_font_italic" id="S4.SS1.SSS1.Px1.p3.1.1">Output and CoS: </span> We evaluate the effects of different output formatting styles (<span class="ltx_text ltx_font_typewriter" id="S4.SS1.SSS1.Px1.p3.1.2">string</span>, <span class="ltx_text ltx_font_typewriter" id="S4.SS1.SSS1.Px1.p3.1.3">string list</span>, <span class="ltx_text ltx_font_typewriter" id="S4.SS1.SSS1.Px1.p3.1.4">string tree</span>) and CoS (True, False), with the model fixed as GPT-4o, with no other features enabled.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS1.Px1.p4">
<p class="ltx_p" id="S4.SS1.SSS1.Px1.p4.2"><span class="ltx_text ltx_font_italic" id="S4.SS1.SSS1.Px1.p4.2.1">Example Retrieval: </span> We evaluate the effects of increasing the number of examples provided (multi-shot prompting) in the range of <math alttext="0,3,5,7," class="ltx_Math" display="inline" id="S4.SS1.SSS1.Px1.p4.1.m1.5"><semantics id="S4.SS1.SSS1.Px1.p4.1.m1.5a"><mrow id="S4.SS1.SSS1.Px1.p4.1.m1.5.5.1"><mrow id="S4.SS1.SSS1.Px1.p4.1.m1.5.5.1.1.2" xref="S4.SS1.SSS1.Px1.p4.1.m1.5.5.1.1.1.cmml"><mn id="S4.SS1.SSS1.Px1.p4.1.m1.1.1" xref="S4.SS1.SSS1.Px1.p4.1.m1.1.1.cmml">0</mn><mo id="S4.SS1.SSS1.Px1.p4.1.m1.5.5.1.1.2.1" xref="S4.SS1.SSS1.Px1.p4.1.m1.5.5.1.1.1.cmml">,</mo><mn id="S4.SS1.SSS1.Px1.p4.1.m1.2.2" xref="S4.SS1.SSS1.Px1.p4.1.m1.2.2.cmml">3</mn><mo id="S4.SS1.SSS1.Px1.p4.1.m1.5.5.1.1.2.2" xref="S4.SS1.SSS1.Px1.p4.1.m1.5.5.1.1.1.cmml">,</mo><mn id="S4.SS1.SSS1.Px1.p4.1.m1.3.3" xref="S4.SS1.SSS1.Px1.p4.1.m1.3.3.cmml">5</mn><mo id="S4.SS1.SSS1.Px1.p4.1.m1.5.5.1.1.2.3" xref="S4.SS1.SSS1.Px1.p4.1.m1.5.5.1.1.1.cmml">,</mo><mn id="S4.SS1.SSS1.Px1.p4.1.m1.4.4" xref="S4.SS1.SSS1.Px1.p4.1.m1.4.4.cmml">7</mn></mrow><mo id="S4.SS1.SSS1.Px1.p4.1.m1.5.5.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.Px1.p4.1.m1.5b"><list id="S4.SS1.SSS1.Px1.p4.1.m1.5.5.1.1.1.cmml" xref="S4.SS1.SSS1.Px1.p4.1.m1.5.5.1.1.2"><cn id="S4.SS1.SSS1.Px1.p4.1.m1.1.1.cmml" type="integer" xref="S4.SS1.SSS1.Px1.p4.1.m1.1.1">0</cn><cn id="S4.SS1.SSS1.Px1.p4.1.m1.2.2.cmml" type="integer" xref="S4.SS1.SSS1.Px1.p4.1.m1.2.2">3</cn><cn id="S4.SS1.SSS1.Px1.p4.1.m1.3.3.cmml" type="integer" xref="S4.SS1.SSS1.Px1.p4.1.m1.3.3">5</cn><cn id="S4.SS1.SSS1.Px1.p4.1.m1.4.4.cmml" type="integer" xref="S4.SS1.SSS1.Px1.p4.1.m1.4.4">7</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.Px1.p4.1.m1.5c">0,3,5,7,</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.Px1.p4.1.m1.5d">0 , 3 , 5 , 7 ,</annotation></semantics></math> and <math alttext="10" class="ltx_Math" display="inline" id="S4.SS1.SSS1.Px1.p4.2.m2.1"><semantics id="S4.SS1.SSS1.Px1.p4.2.m2.1a"><mn id="S4.SS1.SSS1.Px1.p4.2.m2.1.1" xref="S4.SS1.SSS1.Px1.p4.2.m2.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.Px1.p4.2.m2.1b"><cn id="S4.SS1.SSS1.Px1.p4.2.m2.1.1.cmml" type="integer" xref="S4.SS1.SSS1.Px1.p4.2.m2.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.Px1.p4.2.m2.1c">10</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.Px1.p4.2.m2.1d">10</annotation></semantics></math>, with the model fixed as GPT-4o, CoS and output formatting fixed as the best combination from the previous test, and no other features enabled.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS1.Px1.p5">
<p class="ltx_p" id="S4.SS1.SSS1.Px1.p5.1"><span class="ltx_text ltx_font_italic" id="S4.SS1.SSS1.Px1.p5.1.1">Sampling Method: </span>Here, we evaluate the effects of best-of-n and refinement for a fixed <math alttext="n=5" class="ltx_Math" display="inline" id="S4.SS1.SSS1.Px1.p5.1.m1.1"><semantics id="S4.SS1.SSS1.Px1.p5.1.m1.1a"><mrow id="S4.SS1.SSS1.Px1.p5.1.m1.1.1" xref="S4.SS1.SSS1.Px1.p5.1.m1.1.1.cmml"><mi id="S4.SS1.SSS1.Px1.p5.1.m1.1.1.2" xref="S4.SS1.SSS1.Px1.p5.1.m1.1.1.2.cmml">n</mi><mo id="S4.SS1.SSS1.Px1.p5.1.m1.1.1.1" xref="S4.SS1.SSS1.Px1.p5.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS1.SSS1.Px1.p5.1.m1.1.1.3" xref="S4.SS1.SSS1.Px1.p5.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.Px1.p5.1.m1.1b"><apply id="S4.SS1.SSS1.Px1.p5.1.m1.1.1.cmml" xref="S4.SS1.SSS1.Px1.p5.1.m1.1.1"><eq id="S4.SS1.SSS1.Px1.p5.1.m1.1.1.1.cmml" xref="S4.SS1.SSS1.Px1.p5.1.m1.1.1.1"></eq><ci id="S4.SS1.SSS1.Px1.p5.1.m1.1.1.2.cmml" xref="S4.SS1.SSS1.Px1.p5.1.m1.1.1.2">𝑛</ci><cn id="S4.SS1.SSS1.Px1.p5.1.m1.1.1.3.cmml" type="integer" xref="S4.SS1.SSS1.Px1.p5.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.Px1.p5.1.m1.1c">n=5</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.Px1.p5.1.m1.1d">italic_n = 5</annotation></semantics></math>. Additionally we test on the refinement cases if forwarding the most recent iteration result, or all previous iteration results is the best, and if we should keep the best out of the iterations, or the most recent. The model is fixed as GPT-4o, CoS, output formatting, and examples are fixed as the best combination from the previous test, and no other features enabled.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS1.Px1.p6">
<p class="ltx_p" id="S4.SS1.SSS1.Px1.p6.4"><math alttext="n" class="ltx_Math" display="inline" id="S4.SS1.SSS1.Px1.p6.1.m1.1"><semantics id="S4.SS1.SSS1.Px1.p6.1.m1.1a"><mi id="S4.SS1.SSS1.Px1.p6.1.m1.1.1" xref="S4.SS1.SSS1.Px1.p6.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.Px1.p6.1.m1.1b"><ci id="S4.SS1.SSS1.Px1.p6.1.m1.1.1.cmml" xref="S4.SS1.SSS1.Px1.p6.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.Px1.p6.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.Px1.p6.1.m1.1d">italic_n</annotation></semantics></math><span class="ltx_text ltx_font_italic" id="S4.SS1.SSS1.Px1.p6.4.1"> and Model: </span>Here, we evaluate the effects of larger <math alttext="n" class="ltx_Math" display="inline" id="S4.SS1.SSS1.Px1.p6.2.m2.1"><semantics id="S4.SS1.SSS1.Px1.p6.2.m2.1a"><mi id="S4.SS1.SSS1.Px1.p6.2.m2.1.1" xref="S4.SS1.SSS1.Px1.p6.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.Px1.p6.2.m2.1b"><ci id="S4.SS1.SSS1.Px1.p6.2.m2.1.1.cmml" xref="S4.SS1.SSS1.Px1.p6.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.Px1.p6.2.m2.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.Px1.p6.2.m2.1d">italic_n</annotation></semantics></math> values and different models. We test <math alttext="n=3,5,7,10,15" class="ltx_Math" display="inline" id="S4.SS1.SSS1.Px1.p6.3.m3.5"><semantics id="S4.SS1.SSS1.Px1.p6.3.m3.5a"><mrow id="S4.SS1.SSS1.Px1.p6.3.m3.5.6" xref="S4.SS1.SSS1.Px1.p6.3.m3.5.6.cmml"><mi id="S4.SS1.SSS1.Px1.p6.3.m3.5.6.2" xref="S4.SS1.SSS1.Px1.p6.3.m3.5.6.2.cmml">n</mi><mo id="S4.SS1.SSS1.Px1.p6.3.m3.5.6.1" xref="S4.SS1.SSS1.Px1.p6.3.m3.5.6.1.cmml">=</mo><mrow id="S4.SS1.SSS1.Px1.p6.3.m3.5.6.3.2" xref="S4.SS1.SSS1.Px1.p6.3.m3.5.6.3.1.cmml"><mn id="S4.SS1.SSS1.Px1.p6.3.m3.1.1" xref="S4.SS1.SSS1.Px1.p6.3.m3.1.1.cmml">3</mn><mo id="S4.SS1.SSS1.Px1.p6.3.m3.5.6.3.2.1" xref="S4.SS1.SSS1.Px1.p6.3.m3.5.6.3.1.cmml">,</mo><mn id="S4.SS1.SSS1.Px1.p6.3.m3.2.2" xref="S4.SS1.SSS1.Px1.p6.3.m3.2.2.cmml">5</mn><mo id="S4.SS1.SSS1.Px1.p6.3.m3.5.6.3.2.2" xref="S4.SS1.SSS1.Px1.p6.3.m3.5.6.3.1.cmml">,</mo><mn id="S4.SS1.SSS1.Px1.p6.3.m3.3.3" xref="S4.SS1.SSS1.Px1.p6.3.m3.3.3.cmml">7</mn><mo id="S4.SS1.SSS1.Px1.p6.3.m3.5.6.3.2.3" xref="S4.SS1.SSS1.Px1.p6.3.m3.5.6.3.1.cmml">,</mo><mn id="S4.SS1.SSS1.Px1.p6.3.m3.4.4" xref="S4.SS1.SSS1.Px1.p6.3.m3.4.4.cmml">10</mn><mo id="S4.SS1.SSS1.Px1.p6.3.m3.5.6.3.2.4" xref="S4.SS1.SSS1.Px1.p6.3.m3.5.6.3.1.cmml">,</mo><mn id="S4.SS1.SSS1.Px1.p6.3.m3.5.5" xref="S4.SS1.SSS1.Px1.p6.3.m3.5.5.cmml">15</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.Px1.p6.3.m3.5b"><apply id="S4.SS1.SSS1.Px1.p6.3.m3.5.6.cmml" xref="S4.SS1.SSS1.Px1.p6.3.m3.5.6"><eq id="S4.SS1.SSS1.Px1.p6.3.m3.5.6.1.cmml" xref="S4.SS1.SSS1.Px1.p6.3.m3.5.6.1"></eq><ci id="S4.SS1.SSS1.Px1.p6.3.m3.5.6.2.cmml" xref="S4.SS1.SSS1.Px1.p6.3.m3.5.6.2">𝑛</ci><list id="S4.SS1.SSS1.Px1.p6.3.m3.5.6.3.1.cmml" xref="S4.SS1.SSS1.Px1.p6.3.m3.5.6.3.2"><cn id="S4.SS1.SSS1.Px1.p6.3.m3.1.1.cmml" type="integer" xref="S4.SS1.SSS1.Px1.p6.3.m3.1.1">3</cn><cn id="S4.SS1.SSS1.Px1.p6.3.m3.2.2.cmml" type="integer" xref="S4.SS1.SSS1.Px1.p6.3.m3.2.2">5</cn><cn id="S4.SS1.SSS1.Px1.p6.3.m3.3.3.cmml" type="integer" xref="S4.SS1.SSS1.Px1.p6.3.m3.3.3">7</cn><cn id="S4.SS1.SSS1.Px1.p6.3.m3.4.4.cmml" type="integer" xref="S4.SS1.SSS1.Px1.p6.3.m3.4.4">10</cn><cn id="S4.SS1.SSS1.Px1.p6.3.m3.5.5.cmml" type="integer" xref="S4.SS1.SSS1.Px1.p6.3.m3.5.5">15</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.Px1.p6.3.m3.5c">n=3,5,7,10,15</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.Px1.p6.3.m3.5d">italic_n = 3 , 5 , 7 , 10 , 15</annotation></semantics></math> on GPT-4o and GPT-4o-mini, as well as <math alttext="n=20" class="ltx_Math" display="inline" id="S4.SS1.SSS1.Px1.p6.4.m4.1"><semantics id="S4.SS1.SSS1.Px1.p6.4.m4.1a"><mrow id="S4.SS1.SSS1.Px1.p6.4.m4.1.1" xref="S4.SS1.SSS1.Px1.p6.4.m4.1.1.cmml"><mi id="S4.SS1.SSS1.Px1.p6.4.m4.1.1.2" xref="S4.SS1.SSS1.Px1.p6.4.m4.1.1.2.cmml">n</mi><mo id="S4.SS1.SSS1.Px1.p6.4.m4.1.1.1" xref="S4.SS1.SSS1.Px1.p6.4.m4.1.1.1.cmml">=</mo><mn id="S4.SS1.SSS1.Px1.p6.4.m4.1.1.3" xref="S4.SS1.SSS1.Px1.p6.4.m4.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.Px1.p6.4.m4.1b"><apply id="S4.SS1.SSS1.Px1.p6.4.m4.1.1.cmml" xref="S4.SS1.SSS1.Px1.p6.4.m4.1.1"><eq id="S4.SS1.SSS1.Px1.p6.4.m4.1.1.1.cmml" xref="S4.SS1.SSS1.Px1.p6.4.m4.1.1.1"></eq><ci id="S4.SS1.SSS1.Px1.p6.4.m4.1.1.2.cmml" xref="S4.SS1.SSS1.Px1.p6.4.m4.1.1.2">𝑛</ci><cn id="S4.SS1.SSS1.Px1.p6.4.m4.1.1.3.cmml" type="integer" xref="S4.SS1.SSS1.Px1.p6.4.m4.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.Px1.p6.4.m4.1c">n=20</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.Px1.p6.4.m4.1d">italic_n = 20</annotation></semantics></math> for GPT-4o-mini (as it is of a far lower token cost). CoS, output formatting, examples, and sampling method are fixed as the best combination from the previous test, and no other features enabled.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS1.Px1.p7">
<p class="ltx_p" id="S4.SS1.SSS1.Px1.p7.4"><span class="ltx_text ltx_font_italic" id="S4.SS1.SSS1.Px1.p7.4.1">Combos and RAG: </span> We evaluate combination methods <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS1.SSS1.Px1.p7.4.2">refinement(best_of_m’,m)</code> and <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS1.SSS1.Px1.p7.4.3">best_of_m’(refinement(m))</code>, for <math alttext="m\neq m^{\prime}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.Px1.p7.1.m1.1"><semantics id="S4.SS1.SSS1.Px1.p7.1.m1.1a"><mrow id="S4.SS1.SSS1.Px1.p7.1.m1.1.1" xref="S4.SS1.SSS1.Px1.p7.1.m1.1.1.cmml"><mi id="S4.SS1.SSS1.Px1.p7.1.m1.1.1.2" xref="S4.SS1.SSS1.Px1.p7.1.m1.1.1.2.cmml">m</mi><mo id="S4.SS1.SSS1.Px1.p7.1.m1.1.1.1" xref="S4.SS1.SSS1.Px1.p7.1.m1.1.1.1.cmml">≠</mo><msup id="S4.SS1.SSS1.Px1.p7.1.m1.1.1.3" xref="S4.SS1.SSS1.Px1.p7.1.m1.1.1.3.cmml"><mi id="S4.SS1.SSS1.Px1.p7.1.m1.1.1.3.2" xref="S4.SS1.SSS1.Px1.p7.1.m1.1.1.3.2.cmml">m</mi><mo id="S4.SS1.SSS1.Px1.p7.1.m1.1.1.3.3" xref="S4.SS1.SSS1.Px1.p7.1.m1.1.1.3.3.cmml">′</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.Px1.p7.1.m1.1b"><apply id="S4.SS1.SSS1.Px1.p7.1.m1.1.1.cmml" xref="S4.SS1.SSS1.Px1.p7.1.m1.1.1"><neq id="S4.SS1.SSS1.Px1.p7.1.m1.1.1.1.cmml" xref="S4.SS1.SSS1.Px1.p7.1.m1.1.1.1"></neq><ci id="S4.SS1.SSS1.Px1.p7.1.m1.1.1.2.cmml" xref="S4.SS1.SSS1.Px1.p7.1.m1.1.1.2">𝑚</ci><apply id="S4.SS1.SSS1.Px1.p7.1.m1.1.1.3.cmml" xref="S4.SS1.SSS1.Px1.p7.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.Px1.p7.1.m1.1.1.3.1.cmml" xref="S4.SS1.SSS1.Px1.p7.1.m1.1.1.3">superscript</csymbol><ci id="S4.SS1.SSS1.Px1.p7.1.m1.1.1.3.2.cmml" xref="S4.SS1.SSS1.Px1.p7.1.m1.1.1.3.2">𝑚</ci><ci id="S4.SS1.SSS1.Px1.p7.1.m1.1.1.3.3.cmml" xref="S4.SS1.SSS1.Px1.p7.1.m1.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.Px1.p7.1.m1.1c">m\neq m^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.Px1.p7.1.m1.1d">italic_m ≠ italic_m start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> with <math alttext="mm^{\prime}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.Px1.p7.2.m2.1"><semantics id="S4.SS1.SSS1.Px1.p7.2.m2.1a"><mrow id="S4.SS1.SSS1.Px1.p7.2.m2.1.1" xref="S4.SS1.SSS1.Px1.p7.2.m2.1.1.cmml"><mi id="S4.SS1.SSS1.Px1.p7.2.m2.1.1.2" xref="S4.SS1.SSS1.Px1.p7.2.m2.1.1.2.cmml">m</mi><mo id="S4.SS1.SSS1.Px1.p7.2.m2.1.1.1" xref="S4.SS1.SSS1.Px1.p7.2.m2.1.1.1.cmml">⁢</mo><msup id="S4.SS1.SSS1.Px1.p7.2.m2.1.1.3" xref="S4.SS1.SSS1.Px1.p7.2.m2.1.1.3.cmml"><mi id="S4.SS1.SSS1.Px1.p7.2.m2.1.1.3.2" xref="S4.SS1.SSS1.Px1.p7.2.m2.1.1.3.2.cmml">m</mi><mo id="S4.SS1.SSS1.Px1.p7.2.m2.1.1.3.3" xref="S4.SS1.SSS1.Px1.p7.2.m2.1.1.3.3.cmml">′</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.Px1.p7.2.m2.1b"><apply id="S4.SS1.SSS1.Px1.p7.2.m2.1.1.cmml" xref="S4.SS1.SSS1.Px1.p7.2.m2.1.1"><times id="S4.SS1.SSS1.Px1.p7.2.m2.1.1.1.cmml" xref="S4.SS1.SSS1.Px1.p7.2.m2.1.1.1"></times><ci id="S4.SS1.SSS1.Px1.p7.2.m2.1.1.2.cmml" xref="S4.SS1.SSS1.Px1.p7.2.m2.1.1.2">𝑚</ci><apply id="S4.SS1.SSS1.Px1.p7.2.m2.1.1.3.cmml" xref="S4.SS1.SSS1.Px1.p7.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.Px1.p7.2.m2.1.1.3.1.cmml" xref="S4.SS1.SSS1.Px1.p7.2.m2.1.1.3">superscript</csymbol><ci id="S4.SS1.SSS1.Px1.p7.2.m2.1.1.3.2.cmml" xref="S4.SS1.SSS1.Px1.p7.2.m2.1.1.3.2">𝑚</ci><ci id="S4.SS1.SSS1.Px1.p7.2.m2.1.1.3.3.cmml" xref="S4.SS1.SSS1.Px1.p7.2.m2.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.Px1.p7.2.m2.1c">mm^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.Px1.p7.2.m2.1d">italic_m italic_m start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> equal to the optimal value <math alttext="m" class="ltx_Math" display="inline" id="S4.SS1.SSS1.Px1.p7.3.m3.1"><semantics id="S4.SS1.SSS1.Px1.p7.3.m3.1a"><mi id="S4.SS1.SSS1.Px1.p7.3.m3.1.1" xref="S4.SS1.SSS1.Px1.p7.3.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.Px1.p7.3.m3.1b"><ci id="S4.SS1.SSS1.Px1.p7.3.m3.1.1.cmml" xref="S4.SS1.SSS1.Px1.p7.3.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.Px1.p7.3.m3.1c">m</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.Px1.p7.3.m3.1d">italic_m</annotation></semantics></math> from the previous test. We also test the effect of enabling document retrieval. Model, CoS, output formatting, examples, <math alttext="n" class="ltx_Math" display="inline" id="S4.SS1.SSS1.Px1.p7.4.m4.1"><semantics id="S4.SS1.SSS1.Px1.p7.4.m4.1a"><mi id="S4.SS1.SSS1.Px1.p7.4.m4.1.1" xref="S4.SS1.SSS1.Px1.p7.4.m4.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.Px1.p7.4.m4.1b"><ci id="S4.SS1.SSS1.Px1.p7.4.m4.1.1.cmml" xref="S4.SS1.SSS1.Px1.p7.4.m4.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.Px1.p7.4.m4.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.Px1.p7.4.m4.1d">italic_n</annotation></semantics></math>, and sampling method are fixed as the best combination from the previous test.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS1.SSS1.Px2">
<h5 class="ltx_title ltx_title_paragraph">Ablation data.</h5>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS1.Px2.p1">
<p class="ltx_p" id="S4.SS1.SSS1.Px2.p1.1">We evaluate our ablations on a subset of MIL. However, due to the increase in model calls for larger <math alttext="n" class="ltx_Math" display="inline" id="S4.SS1.SSS1.Px2.p1.1.m1.1"><semantics id="S4.SS1.SSS1.Px2.p1.1.m1.1a"><mi id="S4.SS1.SSS1.Px2.p1.1.m1.1.1" xref="S4.SS1.SSS1.Px2.p1.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.Px2.p1.1.m1.1b"><ci id="S4.SS1.SSS1.Px2.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS1.Px2.p1.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.Px2.p1.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.Px2.p1.1.m1.1d">italic_n</annotation></semantics></math> values, we switch a representative sample of this subset for some test groups. Namely,</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS1.Px2.p2">
<p class="ltx_p" id="S4.SS1.SSS1.Px2.p2.1">GPT-4o-mini, GPT-4o, Output and Cos, Example Retrieval, and Sampling Method are tested on the <math alttext="133" class="ltx_Math" display="inline" id="S4.SS1.SSS1.Px2.p2.1.m1.1"><semantics id="S4.SS1.SSS1.Px2.p2.1.m1.1a"><mn id="S4.SS1.SSS1.Px2.p2.1.m1.1.1" xref="S4.SS1.SSS1.Px2.p2.1.m1.1.1.cmml">133</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.Px2.p2.1.m1.1b"><cn id="S4.SS1.SSS1.Px2.p2.1.m1.1.1.cmml" type="integer" xref="S4.SS1.SSS1.Px2.p2.1.m1.1.1">133</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.Px2.p2.1.m1.1c">133</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.Px2.p2.1.m1.1d">133</annotation></semantics></math> theorems in the solutions of <span class="ltx_text ltx_font_typewriter" id="S4.SS1.SSS1.Px2.p2.1.1">C03_Logic</span>, <span class="ltx_text ltx_font_typewriter" id="S4.SS1.SSS1.Px2.p2.1.2">C04_Sets_and_Functions</span>, and <span class="ltx_text ltx_font_typewriter" id="S4.SS1.SSS1.Px2.p2.1.3">C05_Elementary_Number_Theory</span>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS1.Px2.p3">
<p class="ltx_p" id="S4.SS1.SSS1.Px2.p3.3"><math alttext="n" class="ltx_Math" display="inline" id="S4.SS1.SSS1.Px2.p3.1.m1.1"><semantics id="S4.SS1.SSS1.Px2.p3.1.m1.1a"><mi id="S4.SS1.SSS1.Px2.p3.1.m1.1.1" xref="S4.SS1.SSS1.Px2.p3.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.Px2.p3.1.m1.1b"><ci id="S4.SS1.SSS1.Px2.p3.1.m1.1.1.cmml" xref="S4.SS1.SSS1.Px2.p3.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.Px2.p3.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.Px2.p3.1.m1.1d">italic_n</annotation></semantics></math> and Model are tested on <math alttext="55" class="ltx_Math" display="inline" id="S4.SS1.SSS1.Px2.p3.2.m2.1"><semantics id="S4.SS1.SSS1.Px2.p3.2.m2.1a"><mn id="S4.SS1.SSS1.Px2.p3.2.m2.1.1" xref="S4.SS1.SSS1.Px2.p3.2.m2.1.1.cmml">55</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.Px2.p3.2.m2.1b"><cn id="S4.SS1.SSS1.Px2.p3.2.m2.1.1.cmml" type="integer" xref="S4.SS1.SSS1.Px2.p3.2.m2.1.1">55</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.Px2.p3.2.m2.1c">55</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.Px2.p3.2.m2.1d">55</annotation></semantics></math> theorems from a representative sample of the aforementioned, and Combos and RAG are tested on a representative sample of <math alttext="32" class="ltx_Math" display="inline" id="S4.SS1.SSS1.Px2.p3.3.m3.1"><semantics id="S4.SS1.SSS1.Px2.p3.3.m3.1a"><mn id="S4.SS1.SSS1.Px2.p3.3.m3.1.1" xref="S4.SS1.SSS1.Px2.p3.3.m3.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.Px2.p3.3.m3.1b"><cn id="S4.SS1.SSS1.Px2.p3.3.m3.1.1.cmml" type="integer" xref="S4.SS1.SSS1.Px2.p3.3.m3.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.Px2.p3.3.m3.1c">32</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.Px2.p3.3.m3.1d">32</annotation></semantics></math> theorems from the aforementioned.</p>
</div>
</section>
</section>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Results</h3>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">
<math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.1.m1.1"><semantics id="S4.SS2.SSS0.Px1.1.m1.1b"><mi id="S4.SS2.SSS0.Px1.1.m1.1.1" xref="S4.SS2.SSS0.Px1.1.m1.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.1.m1.1c"><ci id="S4.SS2.SSS0.Px1.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px1.1.m1.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.1.m1.1d">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.1.m1.1e">roman_ImProver</annotation></semantics></math> is capable of optimizing proofs in all settings.</h5>
<figure class="ltx_table" id="S4.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>Average Proof optimization results.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T1.2">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T1.2.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T1.2.3.1.1">Metric</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S4.T1.2.3.1.2">Model</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.2.3.1.3">Improvement</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.2.3.1.4">Nonempty Improvement</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.2.3.1.5">Accuracy</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.2.3.1.6">Improved Acc.</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.2.4.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T1.2.4.1.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="S4.T1.2.4.1.1.1">Length</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T1.2.4.1.2">GPT-4o</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.2.4.1.3">3.7</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.2.4.1.4">15.15</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.2.4.1.5">26.36%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.2.4.1.6">8.31%</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T1.1.1.1"><math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S4.T1.1.1.1.m1.1"><semantics id="S4.T1.1.1.1.m1.1a"><mi id="S4.T1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.m1.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.m1.1b"><ci id="S4.T1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.m1.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.m1.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.1.1.1.m1.1d">roman_ImProver</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S4.T1.1.1.2"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.2.1">20.96</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.1.3"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.3.1">55.29</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.1.4"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.4.1">100.0%</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.1.5"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.5.1">35.44%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.5.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="S4.T1.2.5.2.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="S4.T1.2.5.2.1.1">Readability</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T1.2.5.2.2">GPT-4o</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.2.5.2.3">2.21</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.2.5.2.4">8.02</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.2.5.2.5">18.75%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.2.5.2.6">6.13 %</td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S4.T1.2.2.1"><math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S4.T1.2.2.1.m1.1"><semantics id="S4.T1.2.2.1.m1.1a"><mi id="S4.T1.2.2.1.m1.1.1" xref="S4.T1.2.2.1.m1.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.1.m1.1b"><ci id="S4.T1.2.2.1.m1.1.1.cmml" xref="S4.T1.2.2.1.m1.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.1.m1.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.2.2.1.m1.1d">roman_ImProver</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.2.2.2"><span class="ltx_text ltx_font_bold" id="S4.T1.2.2.2.1">9.34</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.2.2.3"><span class="ltx_text ltx_font_bold" id="S4.T1.2.2.3.1">30.53</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.2.2.4">
<span class="ltx_text ltx_font_bold" id="S4.T1.2.2.4.1">100.0</span>%</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.2.2.5"><span class="ltx_text ltx_font_bold" id="S4.T1.2.2.5.1">24.56%</span></td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="S4.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>MIL Proof optimization results.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T2.2">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T2.2.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T2.2.3.1.1">Metric</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S4.T2.2.3.1.2">Model</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.2.3.1.3">Improvement</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.2.3.1.4">Nonempty Improvement</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.2.3.1.5">Accuracy</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.2.3.1.6">Improved Acc.</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.2.4.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T2.2.4.1.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="S4.T2.2.4.1.1.1">Length</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.2.4.1.2">GPT-4o</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.4.1.3">6.25</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.4.1.4">18.58</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.4.1.5">37.5%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.4.1.6">14.42%</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.1.1.1"><math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S4.T2.1.1.1.m1.1"><semantics id="S4.T2.1.1.1.m1.1a"><mi id="S4.T2.1.1.1.m1.1.1" xref="S4.T2.1.1.1.m1.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.m1.1b"><ci id="S4.T2.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.m1.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.m1.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.1.1.1.m1.1d">roman_ImProver</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.2"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.2.1">30.54</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.3"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.3.1">56.56</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.4"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.4.1">100.0%</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.5"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.5.1">50.0%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.5.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="S4.T2.2.5.2.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="S4.T2.2.5.2.1.1">Readability</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.2.5.2.2">GPT-4o</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.5.2.3">4.18</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.5.2.4">14.48</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.5.2.5">28.85%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.5.2.6">11.54%</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S4.T2.2.2.1"><math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S4.T2.2.2.1.m1.1"><semantics id="S4.T2.2.2.1.m1.1a"><mi id="S4.T2.2.2.1.m1.1.1" xref="S4.T2.2.2.1.m1.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.1.m1.1b"><ci id="S4.T2.2.2.1.m1.1.1.cmml" xref="S4.T2.2.2.1.m1.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.1.m1.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.2.2.1.m1.1d">roman_ImProver</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.2.2.2"><span class="ltx_text ltx_font_bold" id="S4.T2.2.2.2.1">13.45</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.2.2.3"><span class="ltx_text ltx_font_bold" id="S4.T2.2.2.3.1">30.97</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.2.2.4"><span class="ltx_text ltx_font_bold" id="S4.T2.2.2.4.1">100.0%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.2.2.5"><span class="ltx_text ltx_font_bold" id="S4.T2.2.2.5.1">34.21%</span></td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="S4.T3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>Compfiles Proof optimization results.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T3.2">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T3.2.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T3.2.3.1.1">Metric</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S4.T3.2.3.1.2">Model</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.2.3.1.3">Improvement</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.2.3.1.4">Nonempty Improvement</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.2.3.1.5">Accuracy</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.2.3.1.6">Improved Acc.</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T3.2.4.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T3.2.4.1.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="S4.T3.2.4.1.1.1">Length</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.2.4.1.2">GPT-4o</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.2.4.1.3">2.75</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.2.4.1.4">30.7</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.2.4.1.5">11.54%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.2.4.1.6">5.13%</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T3.1.1.1"><math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S4.T3.1.1.1.m1.1"><semantics id="S4.T3.1.1.1.m1.1a"><mi id="S4.T3.1.1.1.m1.1.1" xref="S4.T3.1.1.1.m1.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S4.T3.1.1.1.m1.1b"><ci id="S4.T3.1.1.1.m1.1.1.cmml" xref="S4.T3.1.1.1.m1.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.1.1.1.m1.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.1.1.1.m1.1d">roman_ImProver</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.2"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.2.1">18.86</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.3"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.3.1">54.48</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.4"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.4.1">100.0%</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.5"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.5.1">34.62%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.2.5.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="S4.T3.2.5.2.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="S4.T3.2.5.2.1.1">Readability</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.2.5.2.2">GPT-4o</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.2.5.2.3">0.39</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.2.5.2.4">3.38</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.2.5.2.5">14.1%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.2.5.2.6">1.28%</td>
</tr>
<tr class="ltx_tr" id="S4.T3.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S4.T3.2.2.1"><math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S4.T3.2.2.1.m1.1"><semantics id="S4.T3.2.2.1.m1.1a"><mi id="S4.T3.2.2.1.m1.1.1" xref="S4.T3.2.2.1.m1.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S4.T3.2.2.1.m1.1b"><ci id="S4.T3.2.2.1.m1.1.1.cmml" xref="S4.T3.2.2.1.m1.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.2.2.1.m1.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.2.2.1.m1.1d">roman_ImProver</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.2.2.2"><span class="ltx_text ltx_font_bold" id="S4.T3.2.2.2.1">5.74</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.2.2.3"><span class="ltx_text ltx_font_bold" id="S4.T3.2.2.3.1">24.89</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.2.2.4"><span class="ltx_text ltx_font_bold" id="S4.T3.2.2.4.1">100.0%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.2.2.5"><span class="ltx_text ltx_font_bold" id="S4.T3.2.2.5.1">19.23%</span></td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="S4.T4">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4: </span>Mathlib Proof optimization results.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T4.2">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T4.2.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T4.2.3.1.1">Metric</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S4.T4.2.3.1.2">Model</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T4.2.3.1.3">Improvement</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T4.2.3.1.4">Nonempty Improvement</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T4.2.3.1.5">Accuracy</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T4.2.3.1.6">Improved Acc.</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T4.2.4.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T4.2.4.1.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="S4.T4.2.4.1.1.1">Length</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T4.2.4.1.2">GPT-4o</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.2.4.1.3">0.0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.2.4.1.4">0.0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.2.4.1.5">16.67%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.2.4.1.6">0.0%</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T4.1.1.1"><math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S4.T4.1.1.1.m1.1"><semantics id="S4.T4.1.1.1.m1.1a"><mi id="S4.T4.1.1.1.m1.1.1" xref="S4.T4.1.1.1.m1.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S4.T4.1.1.1.m1.1b"><ci id="S4.T4.1.1.1.m1.1.1.cmml" xref="S4.T4.1.1.1.m1.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.1.1.1.m1.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S4.T4.1.1.1.m1.1d">roman_ImProver</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.2"><span class="ltx_text ltx_font_bold" id="S4.T4.1.1.2.1">6.19</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.3"><span class="ltx_text ltx_font_bold" id="S4.T4.1.1.3.1">53.65</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.4"><span class="ltx_text ltx_font_bold" id="S4.T4.1.1.4.1">100.0%</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.5"><span class="ltx_text ltx_font_bold" id="S4.T4.1.1.5.1">11.54%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.2.5.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="S4.T4.2.5.2.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="S4.T4.2.5.2.1.1">Readability</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T4.2.5.2.2">GPT-4o</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.2.5.2.3">0.0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.2.5.2.4">0.0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.2.5.2.5">4.65%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.2.5.2.6">0.0%</td>
</tr>
<tr class="ltx_tr" id="S4.T4.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S4.T4.2.2.1"><math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S4.T4.2.2.1.m1.1"><semantics id="S4.T4.2.2.1.m1.1a"><mi id="S4.T4.2.2.1.m1.1.1" xref="S4.T4.2.2.1.m1.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S4.T4.2.2.1.m1.1b"><ci id="S4.T4.2.2.1.m1.1.1.cmml" xref="S4.T4.2.2.1.m1.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.2.2.1.m1.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S4.T4.2.2.1.m1.1d">roman_ImProver</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.2.2.2"><span class="ltx_text ltx_font_bold" id="S4.T4.2.2.2.1">4.63</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.2.2.3"><span class="ltx_text ltx_font_bold" id="S4.T4.2.2.3.1">33.19</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.2.2.4"><span class="ltx_text ltx_font_bold" id="S4.T4.2.2.4.1">100.0%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.2.2.5"><span class="ltx_text ltx_font_bold" id="S4.T4.2.2.5.1">11.63%</span></td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p1.3">From <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2410.04753v1#S4.T2" title="Table 2 ‣ ImProver is capable of optimizing proofs in all settings. ‣ 4.2 Results ‣ 4 Experiments ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_tag">Table 2</span></a>, <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2410.04753v1#S4.T3" title="Table 3 ‣ ImProver is capable of optimizing proofs in all settings. ‣ 4.2 Results ‣ 4 Experiments ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_tag">Table 3</span></a>, and <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2410.04753v1#S4.T4" title="Table 4 ‣ ImProver is capable of optimizing proofs in all settings. ‣ 4.2 Results ‣ 4 Experiments ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_tag">Table 4</span></a>, we can see that <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.1.m1.1"><semantics id="S4.SS2.SSS0.Px1.p1.1.m1.1a"><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.1.m1.1b"><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.1.m1.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.1.m1.1d">roman_ImProver</annotation></semantics></math> is capable of optimizing proofs on all datasets for both the length and readability metrics.
Furthermore, <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2410.04753v1#S4.T1" title="Table 1 ‣ ImProver is capable of optimizing proofs in all settings. ‣ 4.2 Results ‣ 4 Experiments ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_tag">Table 1</span></a> shows that across all metrics, <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.2.m2.1"><semantics id="S4.SS2.SSS0.Px1.p1.2.m2.1a"><mi id="S4.SS2.SSS0.Px1.p1.2.m2.1.1" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.2.m2.1b"><ci id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.2.m2.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.2.m2.1d">roman_ImProver</annotation></semantics></math> significantly outperforms GPT-4o on proof optimization tasks on every experimental measure – aggregated from all datasets. Additionally, from <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2410.04753v1#S4.T2" title="Table 2 ‣ ImProver is capable of optimizing proofs in all settings. ‣ 4.2 Results ‣ 4 Experiments ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_tag">Table 2</span></a>, <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2410.04753v1#S4.T3" title="Table 3 ‣ ImProver is capable of optimizing proofs in all settings. ‣ 4.2 Results ‣ 4 Experiments ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_tag">Table 3</span></a>, and <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2410.04753v1#S4.T4" title="Table 4 ‣ ImProver is capable of optimizing proofs in all settings. ‣ 4.2 Results ‣ 4 Experiments ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_tag">Table 4</span></a>, we can see that <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.3.m3.1"><semantics id="S4.SS2.SSS0.Px1.p1.3.m3.1a"><mi id="S4.SS2.SSS0.Px1.p1.3.m3.1.1" xref="S4.SS2.SSS0.Px1.p1.3.m3.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.3.m3.1b"><ci id="S4.SS2.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.3.m3.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.3.m3.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.3.m3.1d">roman_ImProver</annotation></semantics></math> outperforms GPT-4o on each dataset as well.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.SSS0.Px1.p2">
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p2.1">We proceed to analyze this data and its implications.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Length optimization.</h5>
<div class="ltx_para ltx_noindent" id="S4.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px2.p1.6">First focusing on the length metric, we see that <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p1.1.m1.1"><semantics id="S4.SS2.SSS0.Px2.p1.1.m1.1a"><mi id="S4.SS2.SSS0.Px2.p1.1.m1.1.1" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p1.1.m1.1b"><ci id="S4.SS2.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p1.1.m1.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p1.1.m1.1d">roman_ImProver</annotation></semantics></math> outperforms GPT-4o with respect to the improvement score by <math alttext="566\%" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p1.2.m2.1"><semantics id="S4.SS2.SSS0.Px2.p1.2.m2.1a"><mrow id="S4.SS2.SSS0.Px2.p1.2.m2.1.1" xref="S4.SS2.SSS0.Px2.p1.2.m2.1.1.cmml"><mn id="S4.SS2.SSS0.Px2.p1.2.m2.1.1.2" xref="S4.SS2.SSS0.Px2.p1.2.m2.1.1.2.cmml">566</mn><mo id="S4.SS2.SSS0.Px2.p1.2.m2.1.1.1" xref="S4.SS2.SSS0.Px2.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p1.2.m2.1b"><apply id="S4.SS2.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.2.m2.1.1"><csymbol cd="latexml" id="S4.SS2.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.2.m2.1.1.1">percent</csymbol><cn id="S4.SS2.SSS0.Px2.p1.2.m2.1.1.2.cmml" type="integer" xref="S4.SS2.SSS0.Px2.p1.2.m2.1.1.2">566</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p1.2.m2.1c">566\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p1.2.m2.1d">566 %</annotation></semantics></math> (aggregated over all datasets). Additionally, we are guaranteed that <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p1.3.m3.1"><semantics id="S4.SS2.SSS0.Px2.p1.3.m3.1a"><mi id="S4.SS2.SSS0.Px2.p1.3.m3.1.1" xref="S4.SS2.SSS0.Px2.p1.3.m3.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p1.3.m3.1b"><ci id="S4.SS2.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.3.m3.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p1.3.m3.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p1.3.m3.1d">roman_ImProver</annotation></semantics></math> produces a correct output, although that output may just be the same as the input. However, <math alttext="35.44\%" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p1.4.m4.1"><semantics id="S4.SS2.SSS0.Px2.p1.4.m4.1a"><mrow id="S4.SS2.SSS0.Px2.p1.4.m4.1.1" xref="S4.SS2.SSS0.Px2.p1.4.m4.1.1.cmml"><mn id="S4.SS2.SSS0.Px2.p1.4.m4.1.1.2" xref="S4.SS2.SSS0.Px2.p1.4.m4.1.1.2.cmml">35.44</mn><mo id="S4.SS2.SSS0.Px2.p1.4.m4.1.1.1" xref="S4.SS2.SSS0.Px2.p1.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p1.4.m4.1b"><apply id="S4.SS2.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.4.m4.1.1"><csymbol cd="latexml" id="S4.SS2.SSS0.Px2.p1.4.m4.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.4.m4.1.1.1">percent</csymbol><cn id="S4.SS2.SSS0.Px2.p1.4.m4.1.1.2.cmml" type="float" xref="S4.SS2.SSS0.Px2.p1.4.m4.1.1.2">35.44</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p1.4.m4.1c">35.44\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p1.4.m4.1d">35.44 %</annotation></semantics></math> of the time, it generates a correct output that is not the same length as the input, and in that case, we expect an average of a <math alttext="55.29\%" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p1.5.m5.1"><semantics id="S4.SS2.SSS0.Px2.p1.5.m5.1a"><mrow id="S4.SS2.SSS0.Px2.p1.5.m5.1.1" xref="S4.SS2.SSS0.Px2.p1.5.m5.1.1.cmml"><mn id="S4.SS2.SSS0.Px2.p1.5.m5.1.1.2" xref="S4.SS2.SSS0.Px2.p1.5.m5.1.1.2.cmml">55.29</mn><mo id="S4.SS2.SSS0.Px2.p1.5.m5.1.1.1" xref="S4.SS2.SSS0.Px2.p1.5.m5.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p1.5.m5.1b"><apply id="S4.SS2.SSS0.Px2.p1.5.m5.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.5.m5.1.1"><csymbol cd="latexml" id="S4.SS2.SSS0.Px2.p1.5.m5.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.5.m5.1.1.1">percent</csymbol><cn id="S4.SS2.SSS0.Px2.p1.5.m5.1.1.2.cmml" type="float" xref="S4.SS2.SSS0.Px2.p1.5.m5.1.1.2">55.29</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p1.5.m5.1c">55.29\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p1.5.m5.1d">55.29 %</annotation></semantics></math> reduction in length. Comparing this with GPT-4o, we conclude that not only can <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p1.6.m6.1"><semantics id="S4.SS2.SSS0.Px2.p1.6.m6.1a"><mi id="S4.SS2.SSS0.Px2.p1.6.m6.1.1" xref="S4.SS2.SSS0.Px2.p1.6.m6.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p1.6.m6.1b"><ci id="S4.SS2.SSS0.Px2.p1.6.m6.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.6.m6.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p1.6.m6.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p1.6.m6.1d">roman_ImProver</annotation></semantics></math> optimize at a higher level on arbitrary theorems, but its ability to generate nontrivial correct outputs is far greater in comparison to GPT-4o.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Readability optimization.</h5>
<div class="ltx_para ltx_noindent" id="S4.SS2.SSS0.Px3.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px3.p1.4">Readability optimization is similar, with <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px3.p1.1.m1.1"><semantics id="S4.SS2.SSS0.Px3.p1.1.m1.1a"><mi id="S4.SS2.SSS0.Px3.p1.1.m1.1.1" xref="S4.SS2.SSS0.Px3.p1.1.m1.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px3.p1.1.m1.1b"><ci id="S4.SS2.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px3.p1.1.m1.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px3.p1.1.m1.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px3.p1.1.m1.1d">roman_ImProver</annotation></semantics></math> outperforming GPT-4o by <math alttext="423\%" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px3.p1.2.m2.1"><semantics id="S4.SS2.SSS0.Px3.p1.2.m2.1a"><mrow id="S4.SS2.SSS0.Px3.p1.2.m2.1.1" xref="S4.SS2.SSS0.Px3.p1.2.m2.1.1.cmml"><mn id="S4.SS2.SSS0.Px3.p1.2.m2.1.1.2" xref="S4.SS2.SSS0.Px3.p1.2.m2.1.1.2.cmml">423</mn><mo id="S4.SS2.SSS0.Px3.p1.2.m2.1.1.1" xref="S4.SS2.SSS0.Px3.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px3.p1.2.m2.1b"><apply id="S4.SS2.SSS0.Px3.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS0.Px3.p1.2.m2.1.1"><csymbol cd="latexml" id="S4.SS2.SSS0.Px3.p1.2.m2.1.1.1.cmml" xref="S4.SS2.SSS0.Px3.p1.2.m2.1.1.1">percent</csymbol><cn id="S4.SS2.SSS0.Px3.p1.2.m2.1.1.2.cmml" type="integer" xref="S4.SS2.SSS0.Px3.p1.2.m2.1.1.2">423</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px3.p1.2.m2.1c">423\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px3.p1.2.m2.1d">423 %</annotation></semantics></math>. Moreover, the accuracy, improved accuracy, and nonempty improvement disparities for readability parallel those of the length tests. However, it should be noted that for both GPT-4o and <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px3.p1.3.m3.1"><semantics id="S4.SS2.SSS0.Px3.p1.3.m3.1a"><mi id="S4.SS2.SSS0.Px3.p1.3.m3.1.1" xref="S4.SS2.SSS0.Px3.p1.3.m3.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px3.p1.3.m3.1b"><ci id="S4.SS2.SSS0.Px3.p1.3.m3.1.1.cmml" xref="S4.SS2.SSS0.Px3.p1.3.m3.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px3.p1.3.m3.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px3.p1.3.m3.1d">roman_ImProver</annotation></semantics></math>, the accuracy and improved accuracy scores were markedly smaller for readability than length optimization. This suggests that for both models, it was generally more “difficult” to generate a correct output, and moreover, generate a correct output with a better metric score than the input, for readability optimization than length optimization. In other words, optimizing for readability is more difficult for the underlying generator than optimizing for length. However, we speculate with higher-quality prompts, descriptions of the metric, and examples, this disparity can be minimized. Regardless, we note that different metrics can be less likely to be correctly optimized, and that model performance is correlated with the metric it seeks to optimize – both for GPT-4o and <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px3.p1.4.m4.1"><semantics id="S4.SS2.SSS0.Px3.p1.4.m4.1a"><mi id="S4.SS2.SSS0.Px3.p1.4.m4.1.1" xref="S4.SS2.SSS0.Px3.p1.4.m4.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px3.p1.4.m4.1b"><ci id="S4.SS2.SSS0.Px3.p1.4.m4.1.1.cmml" xref="S4.SS2.SSS0.Px3.p1.4.m4.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px3.p1.4.m4.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px3.p1.4.m4.1d">roman_ImProver</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px4">
<h5 class="ltx_title ltx_title_paragraph">Optimization varies based on dataset difficulty.</h5>
<div class="ltx_para ltx_noindent" id="S4.SS2.SSS0.Px4.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px4.p1.4">Additionally noting <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2410.04753v1#S4.T2" title="Table 2 ‣ ImProver is capable of optimizing proofs in all settings. ‣ 4.2 Results ‣ 4 Experiments ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_tag">Table 2</span></a>, <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2410.04753v1#S4.T3" title="Table 3 ‣ ImProver is capable of optimizing proofs in all settings. ‣ 4.2 Results ‣ 4 Experiments ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_tag">Table 3</span></a>, and <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2410.04753v1#S4.T4" title="Table 4 ‣ ImProver is capable of optimizing proofs in all settings. ‣ 4.2 Results ‣ 4 Experiments ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_tag">Table 4</span></a>, we observe that the improvement score for both metrics for both GPT-4o and <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px4.p1.1.m1.1"><semantics id="S4.SS2.SSS0.Px4.p1.1.m1.1a"><mi id="S4.SS2.SSS0.Px4.p1.1.m1.1.1" xref="S4.SS2.SSS0.Px4.p1.1.m1.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px4.p1.1.m1.1b"><ci id="S4.SS2.SSS0.Px4.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px4.p1.1.m1.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px4.p1.1.m1.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px4.p1.1.m1.1d">roman_ImProver</annotation></semantics></math> is highest for the MIL dataset, lower for Compfiles, and the lowest on the Mathlib theorems. This suggests that the expected improvement in metric score decreases with higher difficultly – with undergraduate-level theorems having a significantly higher expected improvement than research-level theorems. However, it should be noted that for both metrics, the nonempty improvement of <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px4.p1.2.m2.1"><semantics id="S4.SS2.SSS0.Px4.p1.2.m2.1a"><mi id="S4.SS2.SSS0.Px4.p1.2.m2.1.1" xref="S4.SS2.SSS0.Px4.p1.2.m2.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px4.p1.2.m2.1b"><ci id="S4.SS2.SSS0.Px4.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS0.Px4.p1.2.m2.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px4.p1.2.m2.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px4.p1.2.m2.1d">roman_ImProver</annotation></semantics></math> stayed consistent, whereas for GPT-4o, it followed the aforementioned trend of decreasing with difficulty. Similarly, the accuracy and improved accuracy scores for both metrics and models decreased with higher difficulty datasets (disregarding <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px4.p1.3.m3.1"><semantics id="S4.SS2.SSS0.Px4.p1.3.m3.1a"><mi id="S4.SS2.SSS0.Px4.p1.3.m3.1.1" xref="S4.SS2.SSS0.Px4.p1.3.m3.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px4.p1.3.m3.1b"><ci id="S4.SS2.SSS0.Px4.p1.3.m3.1.1.cmml" xref="S4.SS2.SSS0.Px4.p1.3.m3.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px4.p1.3.m3.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px4.p1.3.m3.1d">roman_ImProver</annotation></semantics></math>’s accuracy scores, as they are ensured to be 100%). This suggests that although the base GPT-4o generator is less likely to generate a correct output for higher difficulty datasets, the improvements that <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px4.p1.4.m4.1"><semantics id="S4.SS2.SSS0.Px4.p1.4.m4.1a"><mi id="S4.SS2.SSS0.Px4.p1.4.m4.1.1" xref="S4.SS2.SSS0.Px4.p1.4.m4.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px4.p1.4.m4.1b"><ci id="S4.SS2.SSS0.Px4.p1.4.m4.1.1.cmml" xref="S4.SS2.SSS0.Px4.p1.4.m4.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px4.p1.4.m4.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px4.p1.4.m4.1d">roman_ImProver</annotation></semantics></math> makes to the base generator allows it to maintain its improvement in the metric score whenever a correct output is generated. As such, we can speculate that the bottleneck in the improvement score is not the model’s ability to optimize the proof for a metric, but rather its ability to generate a new correct proof at all. As such, we conjecture that with more capable generator models, the accuracy – and thus, the improvement score – in optimization tasks will continue to increase, until the improvement scores match the nonempty improvement.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.SSS0.Px4.p2">
<p class="ltx_p" id="S4.SS2.SSS0.Px4.p2.2">Overall, we conclude that although the performance of both <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px4.p2.1.m1.1"><semantics id="S4.SS2.SSS0.Px4.p2.1.m1.1a"><mi id="S4.SS2.SSS0.Px4.p2.1.m1.1.1" xref="S4.SS2.SSS0.Px4.p2.1.m1.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px4.p2.1.m1.1b"><ci id="S4.SS2.SSS0.Px4.p2.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px4.p2.1.m1.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px4.p2.1.m1.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px4.p2.1.m1.1d">roman_ImProver</annotation></semantics></math> and GPT-4o decreases on length and readability optimization on more difficult datasets, <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px4.p2.2.m2.1"><semantics id="S4.SS2.SSS0.Px4.p2.2.m2.1a"><mi id="S4.SS2.SSS0.Px4.p2.2.m2.1.1" xref="S4.SS2.SSS0.Px4.p2.2.m2.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px4.p2.2.m2.1b"><ci id="S4.SS2.SSS0.Px4.p2.2.m2.1.1.cmml" xref="S4.SS2.SSS0.Px4.p2.2.m2.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px4.p2.2.m2.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px4.p2.2.m2.1d">roman_ImProver</annotation></semantics></math> significantly outperforms GPT-4o on all datasets for length and readability optimization.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.1 </span>Ablation Testing</h4>
<figure class="ltx_table" id="S4.T5">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 5: </span>Ablation results. Each cell in the ablation tests shows <span class="ltx_text ltx_font_typewriter" id="S4.T5.7.1">best</span> / <span class="ltx_text ltx_font_typewriter" id="S4.T5.8.2">worst</span>, which are the <span class="ltx_text ltx_font_typewriter" id="S4.T5.9.3">best</span> and <span class="ltx_text ltx_font_typewriter" id="S4.T5.10.4">worst</span> parameter combinations in the test group. The ImProver specification outputs the input theorem when no correct proof is generated, which results in an accuracy of 100% on MIL.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T5.2">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T5.2.3.1">
<th class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S4.T5.2.3.1.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T5.2.3.1.2">Improvement</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T5.2.3.1.3">Nonempty Improve.</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T5.2.3.1.4">Accuracy</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T5.2.3.1.5">Improved Acc.</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T5.2.4.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T5.2.4.1.1">GPT-4o-mini</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.2.4.1.2">0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.2.4.1.3">0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.2.4.1.4">3.62%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.2.4.1.5">0%</td>
</tr>
<tr class="ltx_tr" id="S4.T5.2.5.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T5.2.5.2.1">GPT-4o</th>
<td class="ltx_td ltx_align_center" id="S4.T5.2.5.2.2">7.03</td>
<td class="ltx_td ltx_align_center" id="S4.T5.2.5.2.3">19.67</td>
<td class="ltx_td ltx_align_center" id="S4.T5.2.5.2.4">35.77%</td>
<td class="ltx_td ltx_align_center" id="S4.T5.2.5.2.5">15.33%</td>
</tr>
<tr class="ltx_tr" id="S4.T5.2.6.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T5.2.6.3.1">+ Output and CoS</th>
<td class="ltx_td ltx_align_center" id="S4.T5.2.6.3.2">8.04 / 6.31</td>
<td class="ltx_td ltx_align_center" id="S4.T5.2.6.3.3">12.38 / 14.17</td>
<td class="ltx_td ltx_align_center" id="S4.T5.2.6.3.4">64.96% / 44.53%</td>
<td class="ltx_td ltx_align_center" id="S4.T5.2.6.3.5">21.17% / 16.06%</td>
</tr>
<tr class="ltx_tr" id="S4.T5.2.7.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T5.2.7.4.1">+ Example Retrieval</th>
<td class="ltx_td ltx_align_center" id="S4.T5.2.7.4.2">9.34 / 5.67</td>
<td class="ltx_td ltx_align_center" id="S4.T5.2.7.4.3">14.7 / 8.44</td>
<td class="ltx_td ltx_align_center" id="S4.T5.2.7.4.4">63.5% / 67.15%</td>
<td class="ltx_td ltx_align_center" id="S4.T5.2.7.4.5">21.9% / 16.79%</td>
</tr>
<tr class="ltx_tr" id="S4.T5.2.8.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T5.2.8.5.1">+ Sampling Method</th>
<td class="ltx_td ltx_align_center" id="S4.T5.2.8.5.2">15.35 / 9.34</td>
<td class="ltx_td ltx_align_center" id="S4.T5.2.8.5.3">18.44 / 14.7</td>
<td class="ltx_td ltx_align_center" id="S4.T5.2.8.5.4">83.21% / 63.5%</td>
<td class="ltx_td ltx_align_center" id="S4.T5.2.8.5.5">36.5% / 21.9%</td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T5.1.1.1">+ <math alttext="n" class="ltx_Math" display="inline" id="S4.T5.1.1.1.m1.1"><semantics id="S4.T5.1.1.1.m1.1a"><mi id="S4.T5.1.1.1.m1.1.1" xref="S4.T5.1.1.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.T5.1.1.1.m1.1b"><ci id="S4.T5.1.1.1.m1.1.1.cmml" xref="S4.T5.1.1.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.1.1.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.T5.1.1.1.m1.1d">italic_n</annotation></semantics></math> and Model</th>
<td class="ltx_td ltx_align_center" id="S4.T5.1.1.2">23.51 / 3.65</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.1.3">26.28 / 4.63</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.1.4">89.47% / 78.95%</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.1.5">45.61% / 8.77%</td>
</tr>
<tr class="ltx_tr" id="S4.T5.2.9.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T5.2.9.6.1">+ Combos and RAG</th>
<td class="ltx_td ltx_align_center" id="S4.T5.2.9.6.2">34.88 / 28.25</td>
<td class="ltx_td ltx_align_center" id="S4.T5.2.9.6.3">57.56 / 33.48</td>
<td class="ltx_td ltx_align_center" id="S4.T5.2.9.6.4">60.61% / 84.38%</td>
<td class="ltx_td ltx_align_center" id="S4.T5.2.9.6.5">54.55% / 53.12%</td>
</tr>
<tr class="ltx_tr" id="S4.T5.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" id="S4.T5.2.2.1"><math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S4.T5.2.2.1.m1.1"><semantics id="S4.T5.2.2.1.m1.1a"><mi id="S4.T5.2.2.1.m1.1.1" xref="S4.T5.2.2.1.m1.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S4.T5.2.2.1.m1.1b"><ci id="S4.T5.2.2.1.m1.1.1.cmml" xref="S4.T5.2.2.1.m1.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.2.2.1.m1.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S4.T5.2.2.1.m1.1d">roman_ImProver</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T5.2.2.2"><span class="ltx_text ltx_font_bold" id="S4.T5.2.2.2.1">34.88</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T5.2.2.3"><span class="ltx_text ltx_font_bold" id="S4.T5.2.2.3.1">57.56</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T5.2.2.4"><span class="ltx_text ltx_font_bold" id="S4.T5.2.2.4.1">100%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T5.2.2.5"><span class="ltx_text ltx_font_bold" id="S4.T5.2.2.5.1">54.55%</span></td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS2.SSS1.p1">
<p class="ltx_p" id="S4.SS2.SSS1.p1.7">We perform ablation studies using a subset of the MIL dataset as discussed in §<a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#S4.SS1.SSS1" title="4.1.1 Ablations ‣ 4.1 Setup ‣ 4 Experiments ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_tag">4.1.1</span></a>. The results of this factorial study are aggregated in <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2410.04753v1#S4.T5" title="Table 5 ‣ 4.2.1 Ablation Testing ‣ 4.2 Results ‣ 4 Experiments ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_tag">Table 5</span></a>. We measure the baseline results from the GPT-4o and GPT-4o-mini models, noting that GPT-4o is the better-scoring model (with respect to the improvement score). Thus, fixing this model, we vary the output formatting type and if CoS is enabled, and determine that outputting <span class="ltx_text ltx_font_typewriter" id="S4.SS2.SSS1.p1.7.1">flat</span> with CoS enabled maximizes the improvement score. Fixing these parameters, we now vary the number of examples retrieved, noting that prompting with <math alttext="10" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p1.1.m1.1"><semantics id="S4.SS2.SSS1.p1.1.m1.1a"><mn id="S4.SS2.SSS1.p1.1.m1.1.1" xref="S4.SS2.SSS1.p1.1.m1.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.1.m1.1b"><cn id="S4.SS2.SSS1.p1.1.m1.1.1.cmml" type="integer" xref="S4.SS2.SSS1.p1.1.m1.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.1.m1.1c">10</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p1.1.m1.1d">10</annotation></semantics></math> examples maximizes the improvement score. Fixing this parameter, we vary the sampling methods (excluding compound methods and fixing <math alttext="n=5" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p1.2.m2.1"><semantics id="S4.SS2.SSS1.p1.2.m2.1a"><mrow id="S4.SS2.SSS1.p1.2.m2.1.1" xref="S4.SS2.SSS1.p1.2.m2.1.1.cmml"><mi id="S4.SS2.SSS1.p1.2.m2.1.1.2" xref="S4.SS2.SSS1.p1.2.m2.1.1.2.cmml">n</mi><mo id="S4.SS2.SSS1.p1.2.m2.1.1.1" xref="S4.SS2.SSS1.p1.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS2.SSS1.p1.2.m2.1.1.3" xref="S4.SS2.SSS1.p1.2.m2.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.2.m2.1b"><apply id="S4.SS2.SSS1.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS1.p1.2.m2.1.1"><eq id="S4.SS2.SSS1.p1.2.m2.1.1.1.cmml" xref="S4.SS2.SSS1.p1.2.m2.1.1.1"></eq><ci id="S4.SS2.SSS1.p1.2.m2.1.1.2.cmml" xref="S4.SS2.SSS1.p1.2.m2.1.1.2">𝑛</ci><cn id="S4.SS2.SSS1.p1.2.m2.1.1.3.cmml" type="integer" xref="S4.SS2.SSS1.p1.2.m2.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.2.m2.1c">n=5</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p1.2.m2.1d">italic_n = 5</annotation></semantics></math>) and observe that best-of-n is the best parameter combination. Now, as GPT-4o-mini is significantly less computationally expensive than its GPT-4o counterpart, we test both models with the sample method fixed to best-of-n, and vary <math alttext="n=1,3,5,7,10,15" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p1.3.m3.6"><semantics id="S4.SS2.SSS1.p1.3.m3.6a"><mrow id="S4.SS2.SSS1.p1.3.m3.6.7" xref="S4.SS2.SSS1.p1.3.m3.6.7.cmml"><mi id="S4.SS2.SSS1.p1.3.m3.6.7.2" xref="S4.SS2.SSS1.p1.3.m3.6.7.2.cmml">n</mi><mo id="S4.SS2.SSS1.p1.3.m3.6.7.1" xref="S4.SS2.SSS1.p1.3.m3.6.7.1.cmml">=</mo><mrow id="S4.SS2.SSS1.p1.3.m3.6.7.3.2" xref="S4.SS2.SSS1.p1.3.m3.6.7.3.1.cmml"><mn id="S4.SS2.SSS1.p1.3.m3.1.1" xref="S4.SS2.SSS1.p1.3.m3.1.1.cmml">1</mn><mo id="S4.SS2.SSS1.p1.3.m3.6.7.3.2.1" xref="S4.SS2.SSS1.p1.3.m3.6.7.3.1.cmml">,</mo><mn id="S4.SS2.SSS1.p1.3.m3.2.2" xref="S4.SS2.SSS1.p1.3.m3.2.2.cmml">3</mn><mo id="S4.SS2.SSS1.p1.3.m3.6.7.3.2.2" xref="S4.SS2.SSS1.p1.3.m3.6.7.3.1.cmml">,</mo><mn id="S4.SS2.SSS1.p1.3.m3.3.3" xref="S4.SS2.SSS1.p1.3.m3.3.3.cmml">5</mn><mo id="S4.SS2.SSS1.p1.3.m3.6.7.3.2.3" xref="S4.SS2.SSS1.p1.3.m3.6.7.3.1.cmml">,</mo><mn id="S4.SS2.SSS1.p1.3.m3.4.4" xref="S4.SS2.SSS1.p1.3.m3.4.4.cmml">7</mn><mo id="S4.SS2.SSS1.p1.3.m3.6.7.3.2.4" xref="S4.SS2.SSS1.p1.3.m3.6.7.3.1.cmml">,</mo><mn id="S4.SS2.SSS1.p1.3.m3.5.5" xref="S4.SS2.SSS1.p1.3.m3.5.5.cmml">10</mn><mo id="S4.SS2.SSS1.p1.3.m3.6.7.3.2.5" xref="S4.SS2.SSS1.p1.3.m3.6.7.3.1.cmml">,</mo><mn id="S4.SS2.SSS1.p1.3.m3.6.6" xref="S4.SS2.SSS1.p1.3.m3.6.6.cmml">15</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.3.m3.6b"><apply id="S4.SS2.SSS1.p1.3.m3.6.7.cmml" xref="S4.SS2.SSS1.p1.3.m3.6.7"><eq id="S4.SS2.SSS1.p1.3.m3.6.7.1.cmml" xref="S4.SS2.SSS1.p1.3.m3.6.7.1"></eq><ci id="S4.SS2.SSS1.p1.3.m3.6.7.2.cmml" xref="S4.SS2.SSS1.p1.3.m3.6.7.2">𝑛</ci><list id="S4.SS2.SSS1.p1.3.m3.6.7.3.1.cmml" xref="S4.SS2.SSS1.p1.3.m3.6.7.3.2"><cn id="S4.SS2.SSS1.p1.3.m3.1.1.cmml" type="integer" xref="S4.SS2.SSS1.p1.3.m3.1.1">1</cn><cn id="S4.SS2.SSS1.p1.3.m3.2.2.cmml" type="integer" xref="S4.SS2.SSS1.p1.3.m3.2.2">3</cn><cn id="S4.SS2.SSS1.p1.3.m3.3.3.cmml" type="integer" xref="S4.SS2.SSS1.p1.3.m3.3.3">5</cn><cn id="S4.SS2.SSS1.p1.3.m3.4.4.cmml" type="integer" xref="S4.SS2.SSS1.p1.3.m3.4.4">7</cn><cn id="S4.SS2.SSS1.p1.3.m3.5.5.cmml" type="integer" xref="S4.SS2.SSS1.p1.3.m3.5.5">10</cn><cn id="S4.SS2.SSS1.p1.3.m3.6.6.cmml" type="integer" xref="S4.SS2.SSS1.p1.3.m3.6.6">15</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.3.m3.6c">n=1,3,5,7,10,15</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p1.3.m3.6d">italic_n = 1 , 3 , 5 , 7 , 10 , 15</annotation></semantics></math>, and for GPT-4o-mini, also <math alttext="n=20" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p1.4.m4.1"><semantics id="S4.SS2.SSS1.p1.4.m4.1a"><mrow id="S4.SS2.SSS1.p1.4.m4.1.1" xref="S4.SS2.SSS1.p1.4.m4.1.1.cmml"><mi id="S4.SS2.SSS1.p1.4.m4.1.1.2" xref="S4.SS2.SSS1.p1.4.m4.1.1.2.cmml">n</mi><mo id="S4.SS2.SSS1.p1.4.m4.1.1.1" xref="S4.SS2.SSS1.p1.4.m4.1.1.1.cmml">=</mo><mn id="S4.SS2.SSS1.p1.4.m4.1.1.3" xref="S4.SS2.SSS1.p1.4.m4.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.4.m4.1b"><apply id="S4.SS2.SSS1.p1.4.m4.1.1.cmml" xref="S4.SS2.SSS1.p1.4.m4.1.1"><eq id="S4.SS2.SSS1.p1.4.m4.1.1.1.cmml" xref="S4.SS2.SSS1.p1.4.m4.1.1.1"></eq><ci id="S4.SS2.SSS1.p1.4.m4.1.1.2.cmml" xref="S4.SS2.SSS1.p1.4.m4.1.1.2">𝑛</ci><cn id="S4.SS2.SSS1.p1.4.m4.1.1.3.cmml" type="integer" xref="S4.SS2.SSS1.p1.4.m4.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.4.m4.1c">n=20</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p1.4.m4.1d">italic_n = 20</annotation></semantics></math>. We conclude that GPT-4o with <math alttext="n=15" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p1.5.m5.1"><semantics id="S4.SS2.SSS1.p1.5.m5.1a"><mrow id="S4.SS2.SSS1.p1.5.m5.1.1" xref="S4.SS2.SSS1.p1.5.m5.1.1.cmml"><mi id="S4.SS2.SSS1.p1.5.m5.1.1.2" xref="S4.SS2.SSS1.p1.5.m5.1.1.2.cmml">n</mi><mo id="S4.SS2.SSS1.p1.5.m5.1.1.1" xref="S4.SS2.SSS1.p1.5.m5.1.1.1.cmml">=</mo><mn id="S4.SS2.SSS1.p1.5.m5.1.1.3" xref="S4.SS2.SSS1.p1.5.m5.1.1.3.cmml">15</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.5.m5.1b"><apply id="S4.SS2.SSS1.p1.5.m5.1.1.cmml" xref="S4.SS2.SSS1.p1.5.m5.1.1"><eq id="S4.SS2.SSS1.p1.5.m5.1.1.1.cmml" xref="S4.SS2.SSS1.p1.5.m5.1.1.1"></eq><ci id="S4.SS2.SSS1.p1.5.m5.1.1.2.cmml" xref="S4.SS2.SSS1.p1.5.m5.1.1.2">𝑛</ci><cn id="S4.SS2.SSS1.p1.5.m5.1.1.3.cmml" type="integer" xref="S4.SS2.SSS1.p1.5.m5.1.1.3">15</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.5.m5.1c">n=15</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p1.5.m5.1d">italic_n = 15</annotation></semantics></math> is the most effective. Fixing these parameters, we consider all mixed compound sampling methods with and without document retrieval enabled, concluding that a <math alttext="5" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p1.6.m6.1"><semantics id="S4.SS2.SSS1.p1.6.m6.1a"><mn id="S4.SS2.SSS1.p1.6.m6.1.1" xref="S4.SS2.SSS1.p1.6.m6.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.6.m6.1b"><cn id="S4.SS2.SSS1.p1.6.m6.1.1.cmml" type="integer" xref="S4.SS2.SSS1.p1.6.m6.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.6.m6.1c">5</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p1.6.m6.1d">5</annotation></semantics></math>-step refinement with best-of-<math alttext="3" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p1.7.m7.1"><semantics id="S4.SS2.SSS1.p1.7.m7.1a"><mn id="S4.SS2.SSS1.p1.7.m7.1.1" xref="S4.SS2.SSS1.p1.7.m7.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.7.m7.1b"><cn id="S4.SS2.SSS1.p1.7.m7.1.1.cmml" type="integer" xref="S4.SS2.SSS1.p1.7.m7.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.7.m7.1c">3</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p1.7.m7.1d">3</annotation></semantics></math> on each iteration, with RAG enabled, is the optimal combination.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.SSS1.p2">
<p class="ltx_p" id="S4.SS2.SSS1.p2.3">Thus, as we can see from <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2410.04753v1#S4.T5" title="Table 5 ‣ 4.2.1 Ablation Testing ‣ 4.2 Results ‣ 4 Experiments ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_tag">Table 5</span></a>, the optimal parameter combination comes from gpt-4o outputting as a <span class="ltx_text ltx_font_typewriter" id="S4.SS2.SSS1.p2.3.1">string list</span> with CoS, RAG, <math alttext="10" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p2.1.m1.1"><semantics id="S4.SS2.SSS1.p2.1.m1.1a"><mn id="S4.SS2.SSS1.p2.1.m1.1.1" xref="S4.SS2.SSS1.p2.1.m1.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.1.m1.1b"><cn id="S4.SS2.SSS1.p2.1.m1.1.1.cmml" type="integer" xref="S4.SS2.SSS1.p2.1.m1.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.1.m1.1c">10</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p2.1.m1.1d">10</annotation></semantics></math> examples, <math alttext="5" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p2.2.m2.1"><semantics id="S4.SS2.SSS1.p2.2.m2.1a"><mn id="S4.SS2.SSS1.p2.2.m2.1.1" xref="S4.SS2.SSS1.p2.2.m2.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.2.m2.1b"><cn id="S4.SS2.SSS1.p2.2.m2.1.1.cmml" type="integer" xref="S4.SS2.SSS1.p2.2.m2.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.2.m2.1c">5</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p2.2.m2.1d">5</annotation></semantics></math>-step refinement with each iteration being a best-of-<math alttext="3" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p2.3.m3.1"><semantics id="S4.SS2.SSS1.p2.3.m3.1a"><mn id="S4.SS2.SSS1.p2.3.m3.1.1" xref="S4.SS2.SSS1.p2.3.m3.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.3.m3.1b"><cn id="S4.SS2.SSS1.p2.3.m3.1.1.cmml" type="integer" xref="S4.SS2.SSS1.p2.3.m3.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.3.m3.1c">3</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p2.3.m3.1d">3</annotation></semantics></math> evaluation. Changing any one of these parameters them leads to a reduction in performance. Additional ablation data can be found at (§<a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#A2.SS1" title="B.1 Ablation Details ‣ Appendix B Additional Experimental Results ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_tag">B.1</span></a>).</p>
</div>
<section class="ltx_paragraph" id="S4.SS2.SSS1.Px1">
<h5 class="ltx_title ltx_title_paragraph">Readability and Chain-of-States (CoS) Ablation.</h5>
<figure class="ltx_table" id="S4.T6">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 6: </span>CoS Readability Ablation results.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T6.2">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T6.2.3.1">
<th class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S4.T6.2.3.1.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T6.2.3.1.2">Improvement</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T6.2.3.1.3">Nonempty Improve.</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T6.2.3.1.4">Accuracy</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T6.2.3.1.5">Improved Acc.</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T6.2.4.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T6.2.4.1.1">GPT-4o</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.2.4.1.2">4.97</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.2.4.1.3">15.89</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.2.4.1.4">37.5%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.2.4.1.5">12.5%</td>
</tr>
<tr class="ltx_tr" id="S4.T6.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T6.1.1.1">
<math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S4.T6.1.1.1.m1.1"><semantics id="S4.T6.1.1.1.m1.1a"><mi id="S4.T6.1.1.1.m1.1.1" xref="S4.T6.1.1.1.m1.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S4.T6.1.1.1.m1.1b"><ci id="S4.T6.1.1.1.m1.1.1.cmml" xref="S4.T6.1.1.1.m1.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.1.1.1.m1.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S4.T6.1.1.1.m1.1d">roman_ImProver</annotation></semantics></math>, CoS Disabled</th>
<td class="ltx_td ltx_align_center" id="S4.T6.1.1.2">9.23</td>
<td class="ltx_td ltx_align_center" id="S4.T6.1.1.3">24.61</td>
<td class="ltx_td ltx_align_center" id="S4.T6.1.1.4">100.0%</td>
<td class="ltx_td ltx_align_center" id="S4.T6.1.1.5">28.12%</td>
</tr>
<tr class="ltx_tr" id="S4.T6.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S4.T6.2.2.1"><math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S4.T6.2.2.1.m1.1"><semantics id="S4.T6.2.2.1.m1.1a"><mi id="S4.T6.2.2.1.m1.1.1" xref="S4.T6.2.2.1.m1.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S4.T6.2.2.1.m1.1b"><ci id="S4.T6.2.2.1.m1.1.1.cmml" xref="S4.T6.2.2.1.m1.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.2.2.1.m1.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S4.T6.2.2.1.m1.1d">roman_ImProver</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T6.2.2.2"><span class="ltx_text ltx_font_bold" id="S4.T6.2.2.2.1">16.69</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T6.2.2.3"><span class="ltx_text ltx_font_bold" id="S4.T6.2.2.3.1">31.42</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T6.2.2.4"><span class="ltx_text ltx_font_bold" id="S4.T6.2.2.4.1">100.0%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T6.2.2.5"><span class="ltx_text ltx_font_bold" id="S4.T6.2.2.5.1">46.88%</span></td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS2.SSS1.Px1.p1">
<p class="ltx_p" id="S4.SS2.SSS1.Px1.p1.1">We additionally examine the effects of disabling CoS on readability optimization tasks, as the previous study focused on length optimization tasks, and we speculate that CoS has a high impact on the performance of readability optimization tasks, as the proof states that are embedded due to CoS seem to be a critical aspect to generating the explicit declarations that the readability metric measures.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.SSS1.Px1.p2">
<p class="ltx_p" id="S4.SS2.SSS1.Px1.p2.1">We confirm this result by considering <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2410.04753v1#S4.T6" title="Table 6 ‣ Readability and Chain-of-States (CoS) Ablation. ‣ 4.2.1 Ablation Testing ‣ 4.2 Results ‣ 4 Experiments ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_tag">Table 6</span></a> and observe that simply enabling CoS nearly doubles the improvement score, and significantly improves the nonempty improvement score, suggesting that CoS has a high degree of impact on optimizing for the readability metric, as conjectured. However, we also note a significant increase in improved accuracy, which suggests that embedding the chain of states also improves the ability of the model to generate nontrivial correct outputs, implying that the symbolic information contained in the states are critical to effectively modifying the structure and content of a proof.</p>
</div>
</section>
</section>
<section class="ltx_subsubsection" id="S4.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.2 </span>Neural Theorem Proving Evaluation</h4>
<figure class="ltx_table" id="S4.T7">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 7: </span>Proof generation results. Each cell shows percent accuracy. </figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T7.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T7.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S4.T7.1.2.1.1"><span class="ltx_text ltx_font_bold" id="S4.T7.1.2.1.1.1">MIL</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T7.1.2.1.2">Set Theory</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T7.1.2.1.3">Group Theory</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T7.1.2.1.4">Overall</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T7.1.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T7.1.3.1.1">GPT-4o</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T7.1.3.1.2">18.18%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T7.1.3.1.3">25%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T7.1.3.1.4">21.73%</td>
</tr>
<tr class="ltx_tr" id="S4.T7.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S4.T7.1.1.1"><math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S4.T7.1.1.1.m1.1"><semantics id="S4.T7.1.1.1.m1.1a"><mi id="S4.T7.1.1.1.m1.1.1" xref="S4.T7.1.1.1.m1.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S4.T7.1.1.1.m1.1b"><ci id="S4.T7.1.1.1.m1.1.1.cmml" xref="S4.T7.1.1.1.m1.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.1.1.1.m1.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S4.T7.1.1.1.m1.1d">roman_ImProver</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T7.1.1.2"><span class="ltx_text ltx_font_bold" id="S4.T7.1.1.2.1">45.45%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T7.1.1.3"><span class="ltx_text ltx_font_bold" id="S4.T7.1.1.3.1">33.33%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T7.1.1.4"><span class="ltx_text ltx_font_bold" id="S4.T7.1.1.4.1">39.13%</span></td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS2.SSS2.p1">
<p class="ltx_p" id="S4.SS2.SSS2.p1.3">We evaluate <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p1.1.m1.1"><semantics id="S4.SS2.SSS2.p1.1.m1.1a"><mi id="S4.SS2.SSS2.p1.1.m1.1.1" xref="S4.SS2.SSS2.p1.1.m1.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.1.m1.1b"><ci id="S4.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.1.m1.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.1.m1.1d">roman_ImProver</annotation></semantics></math>’s neural theorem proving (NTP) performance using the completion metric. We evaluate on 23 exercises in group theory (12) and set theory (11) from MIL, with an empty input proof. <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2410.04753v1#S4.T7" title="Table 7 ‣ 4.2.2 Neural Theorem Proving Evaluation ‣ 4.2 Results ‣ 4 Experiments ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_tag">Table 7</span></a> shows the accuracy on the dataset split by topic for both <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p1.2.m2.1"><semantics id="S4.SS2.SSS2.p1.2.m2.1a"><mi id="S4.SS2.SSS2.p1.2.m2.1.1" xref="S4.SS2.SSS2.p1.2.m2.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.2.m2.1b"><ci id="S4.SS2.SSS2.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS2.p1.2.m2.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.2.m2.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.2.m2.1d">roman_ImProver</annotation></semantics></math> and GPT-4o. <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p1.3.m3.1"><semantics id="S4.SS2.SSS2.p1.3.m3.1a"><mi id="S4.SS2.SSS2.p1.3.m3.1.1" xref="S4.SS2.SSS2.p1.3.m3.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.3.m3.1b"><ci id="S4.SS2.SSS2.p1.3.m3.1.1.cmml" xref="S4.SS2.SSS2.p1.3.m3.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.3.m3.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.3.m3.1d">roman_ImProver</annotation></semantics></math> substantially outperforms GPT-4o across all topics, with an 80% increase in accuracy compared to the base model, showing that proof optimization systems are easily extendable to NTP systems.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Qualitative Results</h3>
<div class="ltx_para ltx_noindent" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.2">Next, we discuss qualitative examples showing the improvements from <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S4.SS3.p1.1.m1.1"><semantics id="S4.SS3.p1.1.m1.1a"><mi id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><ci id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.1.m1.1d">roman_ImProver</annotation></semantics></math> in proof optimization. These examples show the balance between correctness and the desired optimization metric, showing how <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S4.SS3.p1.2.m2.1"><semantics id="S4.SS3.p1.2.m2.1a"><mi id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><ci id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.2.m2.1d">roman_ImProver</annotation></semantics></math> can produce more concise or readable proofs depending on the use case. Additional examples can be found in (§<a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#A2.SS2" title="B.2 Additional Qualitative Examples ‣ Appendix B Additional Experimental Results ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_tag">B.2</span></a>)</p>
</div>
<section class="ltx_paragraph" id="S4.SS3.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Example 1: Compfiles Optimization.</h5>
<div class="ltx_para ltx_noindent" id="S4.SS3.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS3.SSS0.Px1.p1.1">Consider <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2410.04753v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_tag">Figure 1</span></a>, a lemma from the 2022 IMO Question 2 (Compfiles) that we optimize for length.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.SSS0.Px1.p2">
<p class="ltx_p" id="S4.SS3.SSS0.Px1.p2.1">The original proof consisted of 12 tactic steps and multiple intermediate calculations. After applying <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px1.p2.1.m1.1"><semantics id="S4.SS3.SSS0.Px1.p2.1.m1.1a"><mi id="S4.SS3.SSS0.Px1.p2.1.m1.1.1" xref="S4.SS3.SSS0.Px1.p2.1.m1.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p2.1.m1.1b"><ci id="S4.SS3.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p2.1.m1.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p2.1.m1.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px1.p2.1.m1.1d">roman_ImProver</annotation></semantics></math> for length optimization, the proof was halved to only 6 tactics, eliminating redundant steps while maintaining correctness.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.SSS0.Px1.p3">
<p class="ltx_p" id="S4.SS3.SSS0.Px1.p3.1">In comparison, the shortened proof makes multiple nontrivial optimizations, such as eliminating the <span class="ltx_text ltx_font_typewriter" id="S4.SS3.SSS0.Px1.p3.1.1">h2’</span> and <span class="ltx_text ltx_font_typewriter" id="S4.SS3.SSS0.Px1.p3.1.2">h4</span> and <span class="ltx_text ltx_font_typewriter" id="S4.SS3.SSS0.Px1.p3.1.3">hxw</span> hypotheses, as well as fully generating proof terms for specific rewrites and other tactics.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS3.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Example 2: MIL.</h5>
<div class="ltx_para ltx_noindent" id="S4.SS3.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS3.SSS0.Px2.p1.1">Consider <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2410.04753v1#S4.F3" title="Figure 3 ‣ Example 2: MIL. ‣ 4.3 Qualitative Results ‣ 4 Experiments ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_tag">Figure 3</span></a>, a result from MIL that we optimize for readability.</p>
</div>
<figure class="ltx_figure" id="S4.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_pagination ltx_figure_panel ltx_role_start_2_columns"></div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="S4.F3.6"><span class="ltx_text ltx_font_bold" id="S4.F3.6.1">Original (human-written)</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_listing ltx_figure_panel ltx_lst_language_lean ltx_lstlisting ltx_listing" id="S4.F3.7">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,ZGVmIGlzb+KCgSBbRmludHlwZSBHXSAoaCA6IERpc2pvaW50IEggSykgKGgnIDogY2FyZCBHID0gY2FyZCBIICogY2FyZCBLKQo6IEsg4omDKiBHIC8gSCAgOj0gYnkKICBhcHBseSBNdWxFcXVpdi5vZkJpamVjdGl2ZSAoKFF1b3RpZW50R3JvdXAubWsnIEgpLnJlc3RyaWN0IEspCiAgcncgW2JpamVjdGl2ZV9pZmZfaW5qZWN0aXZlX2FuZF9jYXJkXQogIGNvbnN0cnVjdG9yCiAgwrcgcncgW+KGkCBrZXJfZXFfYm90X2lmZiwgKFF1b3RpZW50R3JvdXAubWsnIEgpLmtlcl9yZXN0cmljdCBLXQogICAgc2ltcCBbaF0KICDCtyBzeW1tCiAgICBleGFjdCBhdXhfY2FyZF9lcSBoJw==">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx64">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx64.1">def</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx64.2"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx64.3">iso</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx64.4">₁</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx64.5"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx64.6">[</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx64.7">Fintype</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx64.8"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx64.9">G</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx64.10">]</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx64.11"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx64.12">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx64.13">h</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx64.14"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx64.15">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx64.16"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx64.17">Disjoint</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx64.18"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx64.19">H</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx64.20"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx64.21">K</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx64.22">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx64.23"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx64.24">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx64.25">h</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx64.26">’</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx64.27"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx64.28">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx64.29"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx64.30">card</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx64.31"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx64.32">G</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx64.33"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx64.34">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx64.35"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx64.36">card</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx64.37"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx64.38">H</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx64.39"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx64.40">*</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx64.41"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx64.42">card</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx64.43"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx64.44">K</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx64.45">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx65">
<span class="ltx_text ltx_font_typewriter" id="lstnumberx65.1">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx65.2"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx65.3">K</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx65.4"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx65.5">≃*</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx65.6"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx65.7">G</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx65.8"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx65.9">/</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx65.10"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx65.11">H</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx65.12"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx65.13">:=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx65.14"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx65.15">by</span>
</div>
<div class="ltx_listingline" id="lstnumberx66">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx66.2">apply</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx66.4">MulEquiv</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.5">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx66.6">ofBijective</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.7"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.8">((</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx66.9">QuotientGroup</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.10">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx66.11">mk</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.12">’</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.13"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx66.14">H</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.15">).</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx66.16">restrict</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.17"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx66.18">K</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.19">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx67">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx67.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx67.2">rw</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx67.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx67.4">[</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx67.5">bijective_iff_injective_and_card</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx67.6">]</span>
</div>
<div class="ltx_listingline" id="lstnumberx68">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx68.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx68.2">constructor</span>
</div>
<div class="ltx_listingline" id="lstnumberx69">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx69.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx69.2">·</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx69.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx69.4">rw</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx69.5"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx69.6">[←</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx69.7"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx69.8">ker_eq_bot_iff</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx69.9">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx69.10"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx69.11">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx69.12">QuotientGroup</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx69.13">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx69.14">mk</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx69.15">’</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx69.16"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx69.17">H</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx69.18">).</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx69.19">ker_restrict</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx69.20"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx69.21">K</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx69.22">]</span>
</div>
<div class="ltx_listingline" id="lstnumberx70">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx70.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx70.2">simp</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx70.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx70.4">[</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx70.5">h</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx70.6">]</span>
</div>
<div class="ltx_listingline" id="lstnumberx71">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx71.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx71.2">·</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx71.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx71.4">symm</span>
</div>
<div class="ltx_listingline" id="lstnumberx72">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx72.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx72.2">exact</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx72.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx72.4">aux_card_eq</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx72.5"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx72.6">h</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx72.7">’</span>
</div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="S4.F3.1"><span class="ltx_text" id="S4.F3.1.1"></span>
<math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S4.F3.1.m1.1"><semantics id="S4.F3.1.m1.1a"><mi id="S4.F3.1.m1.1.1" xref="S4.F3.1.m1.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S4.F3.1.m1.1b"><ci id="S4.F3.1.m1.1.1.cmml" xref="S4.F3.1.m1.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.1.m1.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S4.F3.1.m1.1d">roman_ImProver</annotation></semantics></math><span class="ltx_text ltx_font_bold" id="S4.F3.1.2"> (readability-optimized)</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_listing ltx_figure_panel ltx_lst_language_lean ltx_lstlisting ltx_listing" id="S4.F3.8">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,ZGVmIGlzb+KCgSBbRmludHlwZSBHXSAoaCA6IERpc2pvaW50IEggSykgKGgnIDogY2FyZCBHID0gY2FyZCBIICogY2FyZCBLKQo6IEsg4omDKiBHIC8gSCAgIDo9IGJ5CiAgaGF2ZSBpbmplY3Rpdml0eSA6IEZ1bmN0aW9uLkluamVjdGl2ZSAoKFF1b3RpZW50R3JvdXAubWsnIEgpLnJlc3RyaWN0IEspIDo9IGJ5CiAgICBydyBb4oaQIGtlcl9lcV9ib3RfaWZmLCAoUXVvdGllbnRHcm91cC5taycgSCkua2VyX3Jlc3RyaWN0IEtdCiAgICBzaW1wIFtoXQogIGhhdmUgY2FyZF9lcSA6IGNhcmQgKEcgLyBIKSA9IGNhcmQgSyA6PSBieQogICAgZXhhY3QgYXV4X2NhcmRfZXEgaCcKICBhcHBseSBNdWxFcXVpdi5vZkJpamVjdGl2ZSAoKFF1b3RpZW50R3JvdXAubWsnIEgpLnJlc3RyaWN0IEspCiAgcncgW2JpamVjdGl2ZV9pZmZfaW5qZWN0aXZlX2FuZF9jYXJkXQogIGNvbnN0cnVjdG9yCiAgZXhhY3QgaW5qZWN0aXZpdHkKICBzeW1tCiAgZXhhY3QgY2FyZF9lcQ==">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx73">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx73.1">def</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx73.2"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx73.3">iso</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx73.4">₁</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx73.5"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx73.6">[</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx73.7">Fintype</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx73.8"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx73.9">G</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx73.10">]</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx73.11"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx73.12">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx73.13">h</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx73.14"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx73.15">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx73.16"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx73.17">Disjoint</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx73.18"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx73.19">H</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx73.20"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx73.21">K</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx73.22">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx73.23"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx73.24">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx73.25">h</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx73.26">’</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx73.27"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx73.28">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx73.29"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx73.30">card</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx73.31"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx73.32">G</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx73.33"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx73.34">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx73.35"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx73.36">card</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx73.37"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx73.38">H</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx73.39"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx73.40">*</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx73.41"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx73.42">card</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx73.43"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx73.44">K</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx73.45">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx74">
<span class="ltx_text ltx_font_typewriter" id="lstnumberx74.1">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx74.2"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx74.3">K</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx74.4"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx74.5">≃*</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx74.6"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx74.7">G</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx74.8"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx74.9">/</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx74.10"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx74.11">H</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx74.12"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx74.13">:=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx74.14"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx74.15">by</span>
</div>
<div class="ltx_listingline" id="lstnumberx75">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx75.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx75.2">have</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx75.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx75.4">injectivity</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx75.5"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx75.6">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx75.7"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx75.8">Function</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx75.9">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx75.10">Injective</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx75.11"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx75.12">((</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx75.13">QuotientGroup</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx75.14">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx75.15">mk</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx75.16">’</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx75.17"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx75.18">H</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx75.19">).</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx75.20">restrict</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx75.21"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx75.22">K</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx75.23">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx75.24"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx75.25">:=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx75.26"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx75.27">by</span>
</div>
<div class="ltx_listingline" id="lstnumberx76">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx76.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx76.2">rw</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx76.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx76.4">[←</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx76.5"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx76.6">ker_eq_bot_iff</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx76.7">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx76.8"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx76.9">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx76.10">QuotientGroup</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx76.11">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx76.12">mk</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx76.13">’</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx76.14"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx76.15">H</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx76.16">).</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx76.17">ker_restrict</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx76.18"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx76.19">K</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx76.20">]</span>
</div>
<div class="ltx_listingline" id="lstnumberx77">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx77.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx77.2">simp</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx77.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx77.4">[</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx77.5">h</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx77.6">]</span>
</div>
<div class="ltx_listingline" id="lstnumberx78">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx78.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx78.2">have</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx78.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx78.4">card_eq</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx78.5"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx78.6">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx78.7"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx78.8">card</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx78.9"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx78.10">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx78.11">G</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx78.12"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx78.13">/</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx78.14"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx78.15">H</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx78.16">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx78.17"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx78.18">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx78.19"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx78.20">card</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx78.21"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx78.22">K</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx78.23"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx78.24">:=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx78.25"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx78.26">by</span>
</div>
<div class="ltx_listingline" id="lstnumberx79">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx79.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx79.2">exact</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx79.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx79.4">aux_card_eq</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx79.5"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx79.6">h</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx79.7">’</span>
</div>
<div class="ltx_listingline" id="lstnumberx80">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx80.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx80.2">apply</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx80.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx80.4">MulEquiv</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx80.5">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx80.6">ofBijective</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx80.7"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx80.8">((</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx80.9">QuotientGroup</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx80.10">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx80.11">mk</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx80.12">’</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx80.13"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx80.14">H</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx80.15">).</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx80.16">restrict</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx80.17"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx80.18">K</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx80.19">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx81">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx81.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx81.2">rw</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx81.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx81.4">[</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx81.5">bijective_iff_injective_and_card</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx81.6">]</span>
</div>
<div class="ltx_listingline" id="lstnumberx82">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx82.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx82.2">constructor</span>
</div>
<div class="ltx_listingline" id="lstnumberx83">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx83.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx83.2">exact</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx83.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx83.4">injectivity</span>
</div>
<div class="ltx_listingline" id="lstnumberx84">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx84.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx84.2">symm</span>
</div>
<div class="ltx_listingline" id="lstnumberx85">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx85.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx85.2">exact</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx85.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx85.4">card_eq</span>
</div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_pagination ltx_figure_panel ltx_role_end_2_columns"></div>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Optimizing a group-theoretic result from MIL Chapter 8 Section 1 for readability. We define a proof to be readable if it is written in a declarative style, which consists of intermediate conjectures (<span class="ltx_text ltx_font_typewriter" id="S4.F3.10.1">have</span> <math alttext="\cdots" class="ltx_Math" display="inline" id="S4.F3.4.m1.1"><semantics id="S4.F3.4.m1.1b"><mi id="S4.F3.4.m1.1.1" mathvariant="normal" xref="S4.F3.4.m1.1.1.cmml">⋯</mi><annotation-xml encoding="MathML-Content" id="S4.F3.4.m1.1c"><ci id="S4.F3.4.m1.1.1.cmml" xref="S4.F3.4.m1.1.1">⋯</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.4.m1.1d">\cdots</annotation><annotation encoding="application/x-llamapun" id="S4.F3.4.m1.1e">⋯</annotation></semantics></math> statements). <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S4.F3.5.m2.1"><semantics id="S4.F3.5.m2.1b"><mi id="S4.F3.5.m2.1.1" xref="S4.F3.5.m2.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S4.F3.5.m2.1c"><ci id="S4.F3.5.m2.1.1.cmml" xref="S4.F3.5.m2.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.5.m2.1d">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S4.F3.5.m2.1e">roman_ImProver</annotation></semantics></math> introduces two intermediate conjectures into the proof. </figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS3.SSS0.Px2.p2">
<p class="ltx_p" id="S4.SS3.SSS0.Px2.p2.2">This original proof carried a score of <math alttext="0" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px2.p2.1.m1.1"><semantics id="S4.SS3.SSS0.Px2.p2.1.m1.1a"><mn id="S4.SS3.SSS0.Px2.p2.1.m1.1.1" xref="S4.SS3.SSS0.Px2.p2.1.m1.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.p2.1.m1.1b"><cn id="S4.SS3.SSS0.Px2.p2.1.m1.1.1.cmml" type="integer" xref="S4.SS3.SSS0.Px2.p2.1.m1.1.1">0</cn></annotation-xml></semantics></math>, as it does not contain any declarative statements. In comparison, after applying <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px2.p2.2.m2.1"><semantics id="S4.SS3.SSS0.Px2.p2.2.m2.1a"><mi id="S4.SS3.SSS0.Px2.p2.2.m2.1.1" xref="S4.SS3.SSS0.Px2.p2.2.m2.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.p2.2.m2.1b"><ci id="S4.SS3.SSS0.Px2.p2.2.m2.1.1.cmml" xref="S4.SS3.SSS0.Px2.p2.2.m2.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.p2.2.m2.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px2.p2.2.m2.1d">roman_ImProver</annotation></semantics></math>, we transformed the proof to be more declarative, with many more intermediate steps with explicit <span class="ltx_text ltx_font_typewriter" id="S4.SS3.SSS0.Px2.p2.2.1">have</span> tactics for improved clarity. Additionally observe how the model defines hypotheses for use in the latter half of the proof; these predefined hypotheses could easily be converted into standalone lemmas for reuse.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS3.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Example 3: Full Proof Generation.</h5>
<div class="ltx_para ltx_noindent" id="S4.SS3.SSS0.Px3.p1">
<p class="ltx_p" id="S4.SS3.SSS0.Px3.p1.1">We analyze the application of <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px3.p1.1.m1.1"><semantics id="S4.SS3.SSS0.Px3.p1.1.m1.1a"><mi id="S4.SS3.SSS0.Px3.p1.1.m1.1.1" xref="S4.SS3.SSS0.Px3.p1.1.m1.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px3.p1.1.m1.1b"><ci id="S4.SS3.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.1.m1.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px3.p1.1.m1.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px3.p1.1.m1.1d">roman_ImProver</annotation></semantics></math> to neural theorem proving in the MIL example from <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2410.04753v1#S4.F4" title="Figure 4 ‣ Example 3: Full Proof Generation. ‣ 4.3 Qualitative Results ‣ 4 Experiments ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_tag">Figure 4</span></a>.</p>
</div>
<figure class="ltx_figure" id="S4.F4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_pagination ltx_figure_panel ltx_role_start_2_columns"></div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="S4.F4.2"><span class="ltx_text ltx_font_bold" id="S4.F4.2.1">Original (human-written)</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_listing ltx_figure_panel ltx_lst_language_lean ltx_lstlisting ltx_listing" id="S4.F4.3">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,ZXhhbXBsZSAoz4YgOiBHIOKGkiogSCkgKFMgVCA6IFN1Ymdyb3VwIEgpIChoU1QgOiBTIOKJpCBUKSA6IGNvbWFwIM+GIFMg4omkIGNvbWFwIM+GIFQgIDo9IGJ5CiAgc29ycnk=">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx86">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx86.1">example</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx86.2"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx86.3">(φ</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx86.4"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx86.5">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx86.6"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx86.7">G</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx86.8"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx86.9">→*</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx86.10"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx86.11">H</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx86.12">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx86.13"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx86.14">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx86.15">S</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx86.16"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx86.17">T</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx86.18"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx86.19">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx86.20"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx86.21">Subgroup</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx86.22"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx86.23">H</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx86.24">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx86.25"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx86.26">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx86.27">hST</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx86.28"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx86.29">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx86.30"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx86.31">S</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx86.32"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx86.33">≤</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx86.34"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx86.35">T</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx86.36">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx86.37"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx86.38">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx86.39"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx86.40">comap</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx86.41"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx86.42">φ</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx86.43"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx86.44">S</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx86.45"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx86.46">≤</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx86.47"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx86.48">comap</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx86.49"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx86.50">φ</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx86.51"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx86.52">T</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx86.53"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx86.54">:=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx86.55"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx86.56">by</span>
</div>
<div class="ltx_listingline" id="lstnumberx87">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx87.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx87.2">sorry</span>
</div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="S4.F4.1"><span class="ltx_text" id="S4.F4.1.1"></span>
<math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S4.F4.1.m1.1"><semantics id="S4.F4.1.m1.1a"><mi id="S4.F4.1.m1.1.1" xref="S4.F4.1.m1.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S4.F4.1.m1.1b"><ci id="S4.F4.1.m1.1.1.cmml" xref="S4.F4.1.m1.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.1.m1.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S4.F4.1.m1.1d">roman_ImProver</annotation></semantics></math><span class="ltx_text ltx_font_bold" id="S4.F4.1.2"> (completeness-optimized)</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_listing ltx_figure_panel ltx_lst_language_lean ltx_lstlisting ltx_listing" id="S4.F4.4">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,ZXhhbXBsZSAoz4YgOiBHIOKGkiogSCkgKFMgVCA6IFN1Ymdyb3VwIEgpIChoU1QgOiBTIOKJpCBUKSA6IGNvbWFwIM+GIFMg4omkIGNvbWFwIM+GIFQgICA6PSBieQogIGludHJvIGcKICBzaW1wIG9ubHkgW21lbV9jb21hcF0KICBpbnRybyBoUwogIGV4YWN0IGhTVCBoUw==">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx88">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx88.1">example</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx88.2"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx88.3">(φ</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx88.4"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx88.5">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx88.6"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx88.7">G</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx88.8"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx88.9">→*</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx88.10"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx88.11">H</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx88.12">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx88.13"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx88.14">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx88.15">S</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx88.16"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx88.17">T</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx88.18"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx88.19">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx88.20"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx88.21">Subgroup</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx88.22"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx88.23">H</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx88.24">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx88.25"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx88.26">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx88.27">hST</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx88.28"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx88.29">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx88.30"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx88.31">S</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx88.32"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx88.33">≤</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx88.34"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx88.35">T</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx88.36">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx88.37"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx88.38">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx88.39"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx88.40">comap</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx88.41"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx88.42">φ</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx88.43"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx88.44">S</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx88.45"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx88.46">≤</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx88.47"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx88.48">comap</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx88.49"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx88.50">φ</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx88.51"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx88.52">T</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx88.53"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx88.54">:=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx88.55"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx88.56">by</span>
</div>
<div class="ltx_listingline" id="lstnumberx89">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx89.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx89.2">intro</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx89.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx89.4">g</span>
</div>
<div class="ltx_listingline" id="lstnumberx90">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx90.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx90.2">simp</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx90.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx90.4">only</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx90.5"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx90.6">[</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx90.7">mem_comap</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx90.8">]</span>
</div>
<div class="ltx_listingline" id="lstnumberx91">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx91.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx91.2">intro</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx91.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx91.4">hS</span>
</div>
<div class="ltx_listingline" id="lstnumberx92">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx92.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx92.2">exact</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx92.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx92.4">hST</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx92.5"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx92.6">hS</span>
</div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_pagination ltx_figure_panel ltx_role_end_2_columns"></div>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Solving a group theorem exercise from MIL Chapter 8 Section 1 for readability. </figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS3.SSS0.Px3.p2">
<p class="ltx_p" id="S4.SS3.SSS0.Px3.p2.1">This theorem relating to group theory originally has no proof, however, <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px3.p2.1.m1.1"><semantics id="S4.SS3.SSS0.Px3.p2.1.m1.1a"><mi id="S4.SS3.SSS0.Px3.p2.1.m1.1.1" xref="S4.SS3.SSS0.Px3.p2.1.m1.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px3.p2.1.m1.1b"><ci id="S4.SS3.SSS0.Px3.p2.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px3.p2.1.m1.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px3.p2.1.m1.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px3.p2.1.m1.1d">roman_ImProver</annotation></semantics></math> generates one from scratch. This generated proof is verified to be correct by Lean, utilizing all the included hypotheses as well as a retrieved mathlib theorem.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>
<div class="ltx_para ltx_noindent" id="S5.p1">
<p class="ltx_p" id="S5.p1.2">In this paper, we introduced <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S5.p1.1.m1.1"><semantics id="S5.p1.1.m1.1a"><mi id="S5.p1.1.m1.1.1" xref="S5.p1.1.m1.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S5.p1.1.m1.1b"><ci id="S5.p1.1.m1.1.1.cmml" xref="S5.p1.1.m1.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.1.m1.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S5.p1.1.m1.1d">roman_ImProver</annotation></semantics></math>, a novel agent-based tool for automated proof optimization in Lean. By incorporating CoS, RAG, and other features, <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S5.p1.2.m2.1"><semantics id="S5.p1.2.m2.1a"><mi id="S5.p1.2.m2.1.1" xref="S5.p1.2.m2.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S5.p1.2.m2.1b"><ci id="S5.p1.2.m2.1.1.cmml" xref="S5.p1.2.m2.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.2.m2.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S5.p1.2.m2.1d">roman_ImProver</annotation></semantics></math> significantly outperforms base language models in proof optimization over undergraduate, competition, and research-level problems.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.p2">
<p class="ltx_p" id="S5.p2.1">However, <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S5.p2.1.m1.1"><semantics id="S5.p2.1.m1.1a"><mi id="S5.p2.1.m1.1.1" xref="S5.p2.1.m1.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S5.p2.1.m1.1b"><ci id="S5.p2.1.m1.1.1.cmml" xref="S5.p2.1.m1.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.1.m1.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S5.p2.1.m1.1d">roman_ImProver</annotation></semantics></math> is limited by its high cost and slow runtime, which is exacerbated by its reliance on black-box LLM’s. We intend to address this inefficiency in future work by applying fine-tuning and RL on a smaller model to match performance at a lower cost.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.p3">
<p class="ltx_p" id="S5.p3.2"><math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S5.p3.1.m1.1"><semantics id="S5.p3.1.m1.1a"><mi id="S5.p3.1.m1.1.1" xref="S5.p3.1.m1.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S5.p3.1.m1.1b"><ci id="S5.p3.1.m1.1.1.cmml" xref="S5.p3.1.m1.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.1.m1.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S5.p3.1.m1.1d">roman_ImProver</annotation></semantics></math> demonstrates its ability to generate substantially shorter, more readable, and modular proofs while maintaining correctness. As such, we believe that <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="S5.p3.2.m2.1"><semantics id="S5.p3.2.m2.1a"><mi id="S5.p3.2.m2.1.1" xref="S5.p3.2.m2.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="S5.p3.2.m2.1b"><ci id="S5.p3.2.m2.1.1.cmml" xref="S5.p3.2.m2.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.2.m2.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="S5.p3.2.m2.1d">roman_ImProver</annotation></semantics></math> sets the stage for further work on proof optimization to advance the study and use of AI in mathematics.</p>
</div>
<section class="ltx_subsubsection" id="S5.SS0.SSSx1">
<h4 class="ltx_title ltx_title_subsubsection">Acknowledgements</h4>
<div class="ltx_para ltx_noindent" id="S5.SS0.SSSx1.p1">
<p class="ltx_p" id="S5.SS0.SSSx1.p1.1">Riyaz Ahuja thanks the L3 Lab and Hoskinson Center for Formal Mathematics for their support.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS0.SSSx1.p2">
<p class="ltx_p" id="S5.SS0.SSSx1.p2.1">Sean Welleck thanks Convergent Research, the Lean FRO, and the OpenAI Researcher Access Program for their support.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">AlphaProof &amp; Teams (2024)</span>
<span class="ltx_bibblock">
AlphaProof and AlphaGeometry Teams.

</span>
<span class="ltx_bibblock">AI achieves silver-medal standard solving international mathematical olympiad problems.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://deepmind.google/discover/blog/ai-solves-imo-problems-at-silver-medal-level/" title="">https://deepmind.google/discover/blog/ai-solves-imo-problems-at-silver-medal-level/</a>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Autexier &amp; Dietrich (2010)</span>
<span class="ltx_bibblock">
Serge Autexier and Dominik Dietrich.

</span>
<span class="ltx_bibblock">A tactic language for declarative proofs.

</span>
<span class="ltx_bibblock">In Matt Kaufmann and Lawrence C. Paulson (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">Interactive Theorem Proving</em>, pp.  99–114, Berlin, Heidelberg, 2010. Springer Berlin Heidelberg.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Carbonell &amp; Goldstein (1998)</span>
<span class="ltx_bibblock">
Jaime Carbonell and Jade Goldstein.

</span>
<span class="ltx_bibblock">The use of mmr, diversity-based reranking for reordering documents and producing summaries.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">Proceedings of the 21st Annual International ACM SIGIR Conference on Research and Development in Information Retrieval</em>, SIGIR ’98, pp.  335–336, New York, NY, USA, 1998. Association for Computing Machinery.

</span>
<span class="ltx_bibblock">ISBN 1581130155.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1145/290941.291025</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/290941.291025" title="">https://doi.org/10.1145/290941.291025</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2023)</span>
<span class="ltx_bibblock">
Xinyun Chen, Maxwell Lin, Nathanael Schärli, and Denny Zhou.

</span>
<span class="ltx_bibblock">Teaching large language models to self-debug, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2304.05128" title="">https://arxiv.org/abs/2304.05128</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">David Renshaw (2024)</span>
<span class="ltx_bibblock">
David Renshaw.

</span>
<span class="ltx_bibblock">compfiles.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/dwrensha/compfiles" title="">https://github.com/dwrensha/compfiles</a>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">First et al. (2023)</span>
<span class="ltx_bibblock">
Emily First, Markus N. Rabe, Talia Ringer, and Yuriy Brun.

</span>
<span class="ltx_bibblock">Baldur: Whole-proof generation and repair with large language models, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Han et al. (2022)</span>
<span class="ltx_bibblock">
Jesse Michael Han, Jason Rute, Yuhuai Wu, Edward Ayers, and Stanislas Polu.

</span>
<span class="ltx_bibblock">Proof artifact co-training for theorem proving with language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">International Conference on Learning Representations</em>, 2022.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=rpxJc9j04U" title="">https://openreview.net/forum?id=rpxJc9j04U</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al. (2024)</span>
<span class="ltx_bibblock">
Jiewen Hu, Thomas Zhu, and Sean Welleck.

</span>
<span class="ltx_bibblock">minictx: Neural theorem proving with (long-)contexts, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2408.03350" title="">https://arxiv.org/abs/2408.03350</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al. (2023)</span>
<span class="ltx_bibblock">
Albert Qiaochu Jiang, Sean Welleck, Jin Peng Zhou, Timothee Lacroix, Jiacheng Liu, Wenda Li, Mateja Jamnik, Guillaume Lample, and Yuhuai Wu.

</span>
<span class="ltx_bibblock">Draft, sketch, and prove: Guiding formal theorem provers with informal proofs.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">The Eleventh International Conference on Learning Representations</em>, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=SMa9EAovKMC" title="">https://openreview.net/forum?id=SMa9EAovKMC</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim Morrison (2024)</span>
<span class="ltx_bibblock">
Kim Morrison.

</span>
<span class="ltx_bibblock">lean-training-data.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/kim-em/lean-training-data" title="">https://github.com/kim-em/lean-training-data</a>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lample et al. (2022)</span>
<span class="ltx_bibblock">
Guillaume Lample, Timothee Lacroix, Marie anne Lachaux, Aurelien Rodriguez, Amaury Hayat, Thibaut Lavril, Gabriel Ebner, and Xavier Martinet.

</span>
<span class="ltx_bibblock">Hypertree proof search for neural theorem proving.

</span>
<span class="ltx_bibblock">In Alice H. Oh, Alekh Agarwal, Danielle Belgrave, and Kyunghyun Cho (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">Advances in Neural Information Processing Systems</em>, 2022.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=J4pX8Q8cxHH" title="">https://openreview.net/forum?id=J4pX8Q8cxHH</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">leanprover-community (2024)</span>
<span class="ltx_bibblock">
leanprover-community.

</span>
<span class="ltx_bibblock">mathematics_in_lean.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/leanprover-community/mathematics_in_lean" title="">https://github.com/leanprover-community/mathematics_in_lean</a>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2024)</span>
<span class="ltx_bibblock">
Zhaoyu Li, Jialiang Sun, Logan Murphy, Qidong Su, Zenan Li, Xian Zhang, Kaiyu Yang, and Xujie Si.

</span>
<span class="ltx_bibblock">A survey on deep learning for theorem proving, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lu et al. (2023)</span>
<span class="ltx_bibblock">
Pan Lu, Liang Qiu, Wenhao Yu, Sean Welleck, and Kai-Wei Chang.

</span>
<span class="ltx_bibblock">A survey of deep learning for mathematical reasoning.

</span>
<span class="ltx_bibblock">In Anna Rogers, Jordan Boyd-Graber, and Naoaki Okazaki (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">Proceedings of the 61st Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers)</em>, pp.  14605–14631, Toronto, Canada, July 2023. Association for Computational Linguistics.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.18653/v1/2023.acl-long.817</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2023.acl-long.817" title="">https://aclanthology.org/2023.acl-long.817</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Madaan et al. (2023)</span>
<span class="ltx_bibblock">
Aman Madaan, Niket Tandon, Prakhar Gupta, Skyler Hallinan, Luyu Gao, Sarah Wiegreffe, Uri Alon, Nouha Dziri, Shrimai Prabhumoye, Yiming Yang, Shashank Gupta, Bodhisattwa Prasad Majumder, Katherine Hermann, Sean Welleck, Amir Yazdanbakhsh, and Peter Clark.

</span>
<span class="ltx_bibblock">Self-refine: Iterative refinement with self-feedback.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Thirty-seventh Conference on Neural Information Processing Systems</em>, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=S37hOerQLB" title="">https://openreview.net/forum?id=S37hOerQLB</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">mathlib Community (2020)</span>
<span class="ltx_bibblock">
The mathlib Community.

</span>
<span class="ltx_bibblock">The lean mathematical library.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">Proceedings of the 9th ACM SIGPLAN International Conference on Certified Programs and Proofs</em>, POPL ’20. ACM, January 2020.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1145/3372885.3373824</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://dx.doi.org/10.1145/3372885.3373824" title="">http://dx.doi.org/10.1145/3372885.3373824</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Moura &amp; Ullrich (2021)</span>
<span class="ltx_bibblock">
Leonardo de Moura and Sebastian Ullrich.

</span>
<span class="ltx_bibblock">The lean 4 theorem prover and programming language.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">Automated Deduction – CADE 28: 28th International Conference on Automated Deduction, Virtual Event, July 12–15, 2021, Proceedings</em>, pp.  625–635, Berlin, Heidelberg, 2021. Springer-Verlag.

</span>
<span class="ltx_bibblock">ISBN 978-3-030-79875-8.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1007/978-3-030-79876-5_37</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1007/978-3-030-79876-5_37" title="">https://doi.org/10.1007/978-3-030-79876-5_37</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">OpenAI et al. (2024)</span>
<span class="ltx_bibblock">
OpenAI, Josh Achiam, Steven Adler, Sandhini Agarwal, Lama Ahmad, Ilge Akkaya, Florencia Leoni Aleman, Diogo Almeida, Janko Altenschmidt, Sam Altman, Shyamal Anadkat, Red Avila, Igor Babuschkin, Suchir Balaji, Valerie Balcom, Paul Baltescu, Haiming Bao, Mohammad Bavarian, Jeff Belgum, Irwan Bello, Jake Berdine, Gabriel Bernadett-Shapiro, Christopher Berner, Lenny Bogdonoff, Oleg Boiko, Madelaine Boyd, Anna-Luisa Brakman, Greg Brockman, Tim Brooks, Miles Brundage, Kevin Button, Trevor Cai, Rosie Campbell, Andrew Cann, Brittany Carey, Chelsea Carlson, Rory Carmichael, Brooke Chan, Che Chang, Fotis Chantzis, Derek Chen, Sully Chen, Ruby Chen, Jason Chen, Mark Chen, Ben Chess, Chester Cho, Casey Chu, Hyung Won Chung, Dave Cummings, Jeremiah Currier, Yunxing Dai, Cory Decareaux, Thomas Degry, Noah Deutsch, Damien Deville, Arka Dhar, David Dohan, Steve Dowling, Sheila Dunning, Adrien Ecoffet, Atty Eleti, Tyna Eloundou, David Farhi, Liam Fedus, Niko Felix, Simón Posada Fishman, Juston Forte, Isabella Fulford, Leo
Gao, Elie Georges, Christian Gibson, Vik Goel, Tarun Gogineni, Gabriel Goh, Rapha Gontijo-Lopes, Jonathan Gordon, Morgan Grafstein, Scott Gray, Ryan Greene, Joshua Gross, Shixiang Shane Gu, Yufei Guo, Chris Hallacy, Jesse Han, Jeff Harris, Yuchen He, Mike Heaton, Johannes Heidecke, Chris Hesse, Alan Hickey, Wade Hickey, Peter Hoeschele, Brandon Houghton, Kenny Hsu, Shengli Hu, Xin Hu, Joost Huizinga, Shantanu Jain, Shawn Jain, Joanne Jang, Angela Jiang, Roger Jiang, Haozhun Jin, Denny Jin, Shino Jomoto, Billie Jonn, Heewoo Jun, Tomer Kaftan, Łukasz Kaiser, Ali Kamali, Ingmar Kanitscheider, Nitish Shirish Keskar, Tabarak Khan, Logan Kilpatrick, Jong Wook Kim, Christina Kim, Yongjik Kim, Jan Hendrik Kirchner, Jamie Kiros, Matt Knight, Daniel Kokotajlo, Łukasz Kondraciuk, Andrew Kondrich, Aris Konstantinidis, Kyle Kosic, Gretchen Krueger, Vishal Kuo, Michael Lampe, Ikai Lan, Teddy Lee, Jan Leike, Jade Leung, Daniel Levy, Chak Ming Li, Rachel Lim, Molly Lin, Stephanie Lin, Mateusz Litwin, Theresa Lopez, Ryan
Lowe, Patricia Lue, Anna Makanju, Kim Malfacini, Sam Manning, Todor Markov, Yaniv Markovski, Bianca Martin, Katie Mayer, Andrew Mayne, Bob McGrew, Scott Mayer McKinney, Christine McLeavey, Paul McMillan, Jake McNeil, David Medina, Aalok Mehta, Jacob Menick, Luke Metz, Andrey Mishchenko, Pamela Mishkin, Vinnie Monaco, Evan Morikawa, Daniel Mossing, Tong Mu, Mira Murati, Oleg Murk, David Mély, Ashvin Nair, Reiichiro Nakano, Rajeev Nayak, Arvind Neelakantan, Richard Ngo, Hyeonwoo Noh, Long Ouyang, Cullen O’Keefe, Jakub Pachocki, Alex Paino, Joe Palermo, Ashley Pantuliano, Giambattista Parascandolo, Joel Parish, Emy Parparita, Alex Passos, Mikhail Pavlov, Andrew Peng, Adam Perelman, Filipe de Avila Belbute Peres, Michael Petrov, Henrique Ponde de Oliveira Pinto, Michael, Pokorny, Michelle Pokrass, Vitchyr H. Pong, Tolly Powell, Alethea Power, Boris Power, Elizabeth Proehl, Raul Puri, Alec Radford, Jack Rae, Aditya Ramesh, Cameron Raymond, Francis Real, Kendra Rimbach, Carl Ross, Bob Rotsted, Henri Roussez,
Nick Ryder, Mario Saltarelli, Ted Sanders, Shibani Santurkar, Girish Sastry, Heather Schmidt, David Schnurr, John Schulman, Daniel Selsam, Kyla Sheppard, Toki Sherbakov, Jessica Shieh, Sarah Shoker, Pranav Shyam, Szymon Sidor, Eric Sigler, Maddie Simens, Jordan Sitkin, Katarina Slama, Ian Sohl, Benjamin Sokolowsky, Yang Song, Natalie Staudacher, Felipe Petroski Such, Natalie Summers, Ilya Sutskever, Jie Tang, Nikolas Tezak, Madeleine B. Thompson, Phil Tillet, Amin Tootoonchian, Elizabeth Tseng, Preston Tuggle, Nick Turley, Jerry Tworek, Juan Felipe Cerón Uribe, Andrea Vallone, Arun Vijayvergiya, Chelsea Voss, Carroll Wainwright, Justin Jay Wang, Alvin Wang, Ben Wang, Jonathan Ward, Jason Wei, CJ Weinmann, Akila Welihinda, Peter Welinder, Jiayi Weng, Lilian Weng, Matt Wiethoff, Dave Willner, Clemens Winter, Samuel Wolrich, Hannah Wong, Lauren Workman, Sherwin Wu, Jeff Wu, Michael Wu, Kai Xiao, Tao Xu, Sarah Yoo, Kevin Yu, Qiming Yuan, Wojciech Zaremba, Rowan Zellers, Chong Zhang, Marvin Zhang, Shengjia
Zhao, Tianhao Zheng, Juntang Zhuang, William Zhuk, and Barret Zoph.

</span>
<span class="ltx_bibblock">Gpt-4 technical report, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2303.08774" title="">https://arxiv.org/abs/2303.08774</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Polu &amp; Sutskever (2020)</span>
<span class="ltx_bibblock">
Stanislas Polu and Ilya Sutskever.

</span>
<span class="ltx_bibblock">Generative language modeling for automated theorem proving, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Polu et al. (2022)</span>
<span class="ltx_bibblock">
Stanislas Polu, Jesse Michael Han, Kunhao Zheng, Mantas Baksys, Igor Babuschkin, and Ilya Sutskever.

</span>
<span class="ltx_bibblock">Formal mathematics statement curriculum learning, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Thakur et al. (2024)</span>
<span class="ltx_bibblock">
Amitayush Thakur, George Tsoukalas, Yeming Wen, Jimmy Xin, and Swarat Chaudhuri.

</span>
<span class="ltx_bibblock">An in-context learning agent for formal theorem-proving, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei et al. (2022)</span>
<span class="ltx_bibblock">
Jason Wei, Xuezhi Wang, Dale Schuurmans, Maarten Bosma, brian ichter, Fei Xia, Ed H. Chi, Quoc V Le, and Denny Zhou.

</span>
<span class="ltx_bibblock">Chain of thought prompting elicits reasoning in large language models.

</span>
<span class="ltx_bibblock">In Alice H. Oh, Alekh Agarwal, Danielle Belgrave, and Kyunghyun Cho (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">Advances in Neural Information Processing Systems</em>, 2022.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=_VjQlMeSB_J" title="">https://openreview.net/forum?id=_VjQlMeSB_J</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wiedijk (2004)</span>
<span class="ltx_bibblock">
Freek Wiedijk.

</span>
<span class="ltx_bibblock">Formal proof sketches.

</span>
<span class="ltx_bibblock">In Stefano Berardi, Mario Coppo, and Ferruccio Damiani (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">Types for Proofs and Programs</em>, pp.  378–393, Berlin, Heidelberg, 2004. Springer Berlin Heidelberg.

</span>
<span class="ltx_bibblock">ISBN 978-3-540-24849-1.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2023)</span>
<span class="ltx_bibblock">
Kaiyu Yang, Aidan Swope, Alex Gu, Rahul Chalamala, Peiyang Song, Shixing Yu, Saad Godil, Ryan Prenger, and Anima Anandkumar.

</span>
<span class="ltx_bibblock">LeanDojo: Theorem proving with retrieval-augmented language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">Neural Information Processing Systems (NeurIPS)</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al. (2023)</span>
<span class="ltx_bibblock">
Shuyan Zhou, Uri Alon, Frank F. Xu, Zhengbao Jiang, and Graham Neubig.

</span>
<span class="ltx_bibblock">Docprompting: Generating code by retrieving the docs.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">The Eleventh International Conference on Learning Representations</em>, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=ZTCxT2t2Ru" title="">https://openreview.net/forum?id=ZTCxT2t2Ru</a>.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Prompts</h2>
<div class="ltx_para ltx_noindent" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">In this appendix, we note the prompts used by <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="A1.p1.1.m1.1"><semantics id="A1.p1.1.m1.1a"><mi id="A1.p1.1.m1.1.1" xref="A1.p1.1.m1.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="A1.p1.1.m1.1b"><ci id="A1.p1.1.m1.1.1.cmml" xref="A1.p1.1.m1.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.1.m1.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="A1.p1.1.m1.1d">roman_ImProver</annotation></semantics></math> both for general LLM prompting, as well as the metric-specific prompts.</p>
</div>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Template</h3>
<div class="ltx_para ltx_noindent" id="A1.SS1.p1">
<p class="ltx_p" id="A1.SS1.p1.1">For the main prompt sent to the LLM on each sample, we build a prompt string using a chat prompt template that is then invoked at runtime to fill in the variables.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS1.p2">
<p class="ltx_p" id="A1.SS1.p2.1">Namely, these variables include the set of metric prompts, previous results, input theorem, context, a syntax documents, Mathlib documents, and examples.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS1.p3">
<p class="ltx_p" id="A1.SS1.p3.1">The prompt template is a conversation of the format:</p>
<ul class="ltx_itemize" id="A1.I1">
<li class="ltx_item" id="A1.I1.ix1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="A1.I1.ix1.p1">
<p class="ltx_p" id="A1.I1.ix1.p1.1"><span class="ltx_text ltx_font_bold" id="A1.I1.ix1.p1.1.1">Placeholder:</span> <span class="ltx_text ltx_font_italic" id="A1.I1.ix1.p1.1.2">All metric prompts with a ‘System’ role</span></p>
</div>
</li>
<li class="ltx_item" id="A1.I1.ix2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para ltx_noindent" id="A1.I1.ix2.p1">
<p class="ltx_p" id="A1.I1.ix2.p1.1"><span class="ltx_text ltx_font_bold" id="A1.I1.ix2.p1.1.1">System:</span> You will be given the proof context (i.e. the lean file contents/imports leading up to the theorem declaration) wrapped by &lt;CONTEXT&gt;…&lt;/CONTEXT&gt;.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.I1.ix2.p2">
<p class="ltx_p" id="A1.I1.ix2.p2.1">You will be given the previous <span class="ltx_text ltx_font_italic" id="A1.I1.ix2.p2.1.1">num_prev</span> input/output pairs as well as their metric (metric.name) score and correctness score, as well as any error messages, for your reference to improve upon. Each of these previous results will be wrapped with &lt;PREV I=0&gt;&lt;/PREV I=0&gt;,…,&lt;PREV I=<span class="ltx_text ltx_font_italic" id="A1.I1.ix2.p2.1.2">num_prev-1</span>&gt;&lt;/PREV I=<span class="ltx_text ltx_font_italic" id="A1.I1.ix2.p2.1.3">num_prev-1</span>&gt;, with I=<span class="ltx_text ltx_font_italic" id="A1.I1.ix2.p2.1.4">num_prev-1</span> being the most recent result.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.I1.ix2.p3">
<p class="ltx_p" id="A1.I1.ix2.p3.1">Remember to use lean 4 syntax, which has significant changes from the lean 3 syntax.
To assist with the syntax relating to the current theorem and current error messages, you will be given <span class="ltx_text ltx_font_italic" id="A1.I1.ix2.p3.1.1">num_syntax_docs</span> documents to refer to for fixing these syntax issues. Each of these documents will be wrapped with &lt;SYNTAX_DOC&gt;…&lt;/SYNTAX_DOC&gt;.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.I1.ix2.p4">
<p class="ltx_p" id="A1.I1.ix2.p4.1">You will also receive <span class="ltx_text ltx_font_italic" id="A1.I1.ix2.p4.1.1">num_mathlib_docs</span> documents relevant to the current theorem to help with formulating your modified proof. Each of these will be wrapped with &lt;CONTENT_DOC&gt;…&lt;/CONTENT_DOC&gt;</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.I1.ix2.p5">
<p class="ltx_p" id="A1.I1.ix2.p5.1">You will also receive <span class="ltx_text ltx_font_italic" id="A1.I1.ix2.p5.1.1">num_examples</span> examples of input-output pairs of proofs that were optimized for the <span class="ltx_text ltx_font_italic" id="A1.I1.ix2.p5.1.2">metric</span> metric. Each of these will be wrapped with &lt;EXAMPLE&gt;…&lt;/EXAMPLE&gt;</p>
</div>
<div class="ltx_para" id="A1.I1.ix2.p6">
<p class="ltx_p" id="A1.I1.ix2.p6.1">You will be given the tactic states as comments for reference.
The current theorem will be wrapped in &lt;CURRENT&gt;…&lt;/CURRENT&gt;</p>
</div>
</li>
<li class="ltx_item" id="A1.I1.ix3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="A1.I1.ix3.p1">
<p class="ltx_p" id="A1.I1.ix3.p1.1"><span class="ltx_text ltx_font_bold" id="A1.I1.ix3.p1.1.1">System:</span> <span class="ltx_text ltx_font_italic" id="A1.I1.ix3.p1.1.2">Output format instructions</span></p>
</div>
</li>
<li class="ltx_item" id="A1.I1.ix4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="A1.I1.ix4.p1">
<p class="ltx_p" id="A1.I1.ix4.p1.1"><span class="ltx_text ltx_font_bold" id="A1.I1.ix4.p1.1.1">Placeholder:</span> <span class="ltx_text ltx_font_italic" id="A1.I1.ix4.p1.1.2">All retrieved syntax documentation</span></p>
</div>
</li>
<li class="ltx_item" id="A1.I1.ix5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="A1.I1.ix5.p1">
<p class="ltx_p" id="A1.I1.ix5.p1.1"><span class="ltx_text ltx_font_bold" id="A1.I1.ix5.p1.1.1">Placeholder:</span> <span class="ltx_text ltx_font_italic" id="A1.I1.ix5.p1.1.2">All retrieved mathlib documentation</span></p>
</div>
</li>
<li class="ltx_item" id="A1.I1.ix6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="A1.I1.ix6.p1">
<p class="ltx_p" id="A1.I1.ix6.p1.1"><span class="ltx_text ltx_font_bold" id="A1.I1.ix6.p1.1.1">Placeholder:</span> <span class="ltx_text ltx_font_italic" id="A1.I1.ix6.p1.1.2">All retrieved examples</span></p>
</div>
</li>
<li class="ltx_item" id="A1.I1.ix7" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="A1.I1.ix7.p1">
<p class="ltx_p" id="A1.I1.ix7.p1.1"><span class="ltx_text ltx_font_bold" id="A1.I1.ix7.p1.1.1">User:</span> &lt;CONTEXT&gt;
<span class="ltx_text ltx_font_italic" id="A1.I1.ix7.p1.1.2">context</span>
&lt;/CONTEXT&gt;</p>
</div>
</li>
<li class="ltx_item" id="A1.I1.ix8" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="A1.I1.ix8.p1">
<p class="ltx_p" id="A1.I1.ix8.p1.1"><span class="ltx_text ltx_font_bold" id="A1.I1.ix8.p1.1.1">Placeholder:</span> <span class="ltx_text ltx_font_italic" id="A1.I1.ix8.p1.1.2">Previous results and inputs/outputs</span></p>
</div>
</li>
<li class="ltx_item" id="A1.I1.ix9" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="A1.I1.ix9.p1">
<p class="ltx_p" id="A1.I1.ix9.p1.1"><span class="ltx_text ltx_font_bold" id="A1.I1.ix9.p1.1.1">Placeholder:</span> <span class="ltx_text ltx_font_italic" id="A1.I1.ix9.p1.1.2">All metric prompts with a ‘User’ role</span></p>
</div>
</li>
<li class="ltx_item" id="A1.I1.ix10" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para ltx_noindent" id="A1.I1.ix10.p1">
<p class="ltx_p" id="A1.I1.ix10.p1.1"><span class="ltx_text ltx_font_bold" id="A1.I1.ix10.p1.1.1">User:</span> &lt;CURRENT&gt;
<span class="ltx_text ltx_font_italic" id="A1.I1.ix10.p1.1.2">theorem</span>
&lt;/CURRENT&gt;</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS1.p4">
<p class="ltx_p" id="A1.SS1.p4.1">This prompt is then invoked and sent to the language model by filling in all the variables and placeholders. Notably, when we invoke the chain given by <math alttext="\texttt{chain}|\texttt{llm}|\texttt{parser}" class="ltx_Math" display="inline" id="A1.SS1.p4.1.m1.1"><semantics id="A1.SS1.p4.1.m1.1a"><mrow id="A1.SS1.p4.1.m1.1.2" xref="A1.SS1.p4.1.m1.1.2.cmml"><mtext class="ltx_mathvariant_monospace" id="A1.SS1.p4.1.m1.1.2.2" xref="A1.SS1.p4.1.m1.1.2.2a.cmml">chain</mtext><mo id="A1.SS1.p4.1.m1.1.2.1" xref="A1.SS1.p4.1.m1.1.2.1.cmml">⁢</mo><mrow id="A1.SS1.p4.1.m1.1.2.3.2" xref="A1.SS1.p4.1.m1.1.2.3.1.cmml"><mo id="A1.SS1.p4.1.m1.1.2.3.2.1" stretchy="false" xref="A1.SS1.p4.1.m1.1.2.3.1.1.cmml">|</mo><mtext class="ltx_mathvariant_monospace" id="A1.SS1.p4.1.m1.1.1" xref="A1.SS1.p4.1.m1.1.1a.cmml">llm</mtext><mo id="A1.SS1.p4.1.m1.1.2.3.2.2" stretchy="false" xref="A1.SS1.p4.1.m1.1.2.3.1.1.cmml">|</mo></mrow><mo id="A1.SS1.p4.1.m1.1.2.1a" xref="A1.SS1.p4.1.m1.1.2.1.cmml">⁢</mo><mtext class="ltx_mathvariant_monospace" id="A1.SS1.p4.1.m1.1.2.4" xref="A1.SS1.p4.1.m1.1.2.4a.cmml">parser</mtext></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.1.m1.1b"><apply id="A1.SS1.p4.1.m1.1.2.cmml" xref="A1.SS1.p4.1.m1.1.2"><times id="A1.SS1.p4.1.m1.1.2.1.cmml" xref="A1.SS1.p4.1.m1.1.2.1"></times><ci id="A1.SS1.p4.1.m1.1.2.2a.cmml" xref="A1.SS1.p4.1.m1.1.2.2"><mtext class="ltx_mathvariant_monospace" id="A1.SS1.p4.1.m1.1.2.2.cmml" xref="A1.SS1.p4.1.m1.1.2.2">chain</mtext></ci><apply id="A1.SS1.p4.1.m1.1.2.3.1.cmml" xref="A1.SS1.p4.1.m1.1.2.3.2"><abs id="A1.SS1.p4.1.m1.1.2.3.1.1.cmml" xref="A1.SS1.p4.1.m1.1.2.3.2.1"></abs><ci id="A1.SS1.p4.1.m1.1.1a.cmml" xref="A1.SS1.p4.1.m1.1.1"><mtext class="ltx_mathvariant_monospace" id="A1.SS1.p4.1.m1.1.1.cmml" xref="A1.SS1.p4.1.m1.1.1">llm</mtext></ci></apply><ci id="A1.SS1.p4.1.m1.1.2.4a.cmml" xref="A1.SS1.p4.1.m1.1.2.4"><mtext class="ltx_mathvariant_monospace" id="A1.SS1.p4.1.m1.1.2.4.cmml" xref="A1.SS1.p4.1.m1.1.2.4">parser</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.1.m1.1c">\texttt{chain}|\texttt{llm}|\texttt{parser}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p4.1.m1.1d">chain | llm | parser</annotation></semantics></math>, we throttle the invocation with a randomized exponential rate limit throttling to account for API rate limits, especially in highly-parallelized requests like when benchmarking over a large number of theorems.</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Metric Prompts</h3>
<div class="ltx_para ltx_noindent" id="A1.SS2.p1">
<p class="ltx_p" id="A1.SS2.p1.1"><span class="ltx_text ltx_font_bold" id="A1.SS2.p1.1.1">Length Metric</span></p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS2.p2">
<ul class="ltx_itemize" id="A1.I2">
<li class="ltx_item" id="A1.I2.ix1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="A1.I2.ix1.p1">
<p class="ltx_p" id="A1.I2.ix1.p1.1"><span class="ltx_text ltx_font_bold" id="A1.I2.ix1.p1.1.1">System:</span> You are an AI assistant who shortens Lean 4 proofs while ensuring their correctness. You will aim to reduce the number of lines of the tactic proof while ensuring that it properly compiles in Lean 4.</p>
</div>
</li>
<li class="ltx_item" id="A1.I2.ix2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para ltx_noindent" id="A1.I2.ix2.p1">
<p class="ltx_p" id="A1.I2.ix2.p1.1"><span class="ltx_text ltx_font_bold" id="A1.I2.ix2.p1.1.1">User:</span> Shorten the current theorem (wrapped in &lt;CURRENT&gt;…&lt;/CURRENT&gt;) to be as short in length—measured in the number of lines of the proof—as possible, while also ensuring that the output is still syntactically correct."</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS2.p3">
<p class="ltx_p" id="A1.SS2.p3.1"><span class="ltx_text ltx_font_bold" id="A1.SS2.p3.1.1">Readability Metric</span></p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS2.p4">
<ul class="ltx_itemize" id="A1.I3">
<li class="ltx_item" id="A1.I3.ix1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="A1.I3.ix1.p1">
<p class="ltx_p" id="A1.I3.ix1.p1.1"><span class="ltx_text ltx_font_bold" id="A1.I3.ix1.p1.1.1">System:</span> You are an AI assistant who rewrites Lean 4 proofs to be more readable while ensuring their correctness. We measure readablity by considering the ratio of the number ofexplicitly typed <span class="ltx_text ltx_font_typewriter" id="A1.I3.ix1.p1.1.2">have</span> tactics against the total number of tactics in the proof, as this is proportional to whether a proof is declarative in style, and thus, readable.</p>
</div>
</li>
<li class="ltx_item" id="A1.I3.ix2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para ltx_noindent" id="A1.I3.ix2.p1">
<p class="ltx_p" id="A1.I3.ix2.p1.1"><span class="ltx_text ltx_font_bold" id="A1.I3.ix2.p1.1.1">User:</span> Rewrite the current theorem (wrapped in &lt;CURRENT&gt;…&lt;/CURRENT&gt;) so it is more readable and declarative and modular.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS2.p5">
<p class="ltx_p" id="A1.SS2.p5.1"><span class="ltx_text ltx_font_bold" id="A1.SS2.p5.1.1">Completion Metric</span></p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS2.p6">
<ul class="ltx_itemize" id="A1.I4">
<li class="ltx_item" id="A1.I4.ix1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="A1.I4.ix1.p1">
<p class="ltx_p" id="A1.I4.ix1.p1.1"><span class="ltx_text ltx_font_bold" id="A1.I4.ix1.p1.1.1">System:</span> You are an AI assistant who automatically solves Lean 4 proofs (as in, generates the tactic proof) and ensures its correctness. You will receive a Lean 4 proof you must modify to eliminate any errors so that it compiles correctly and eliminate any “sorry”s with full proofs.</p>
</div>
</li>
<li class="ltx_item" id="A1.I4.ix2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para ltx_noindent" id="A1.I4.ix2.p1">
<p class="ltx_p" id="A1.I4.ix2.p1.1"><span class="ltx_text ltx_font_bold" id="A1.I4.ix2.p1.1.1">User:</span> Rewrite the current theorem (wrapped in &lt;CURRENT&gt;…&lt;/CURRENT&gt;) so it is a formal, complete, and correct Lean 4 proof by filling in its tactic proof.</p>
</div>
</li>
</ul>
</div>
</section>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Additional Experimental Results</h2>
<div class="ltx_para ltx_noindent" id="A2.p1">
<p class="ltx_p" id="A2.p1.1">In this section, we provide more detailed information on the experimental setup and results used to evaluate <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="A2.p1.1.m1.1"><semantics id="A2.p1.1.m1.1a"><mi id="A2.p1.1.m1.1.1" xref="A2.p1.1.m1.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="A2.p1.1.m1.1b"><ci id="A2.p1.1.m1.1.1.cmml" xref="A2.p1.1.m1.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.1.m1.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="A2.p1.1.m1.1d">roman_ImProver</annotation></semantics></math>.</p>
</div>
<section class="ltx_subsection" id="A2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span>Ablation Details</h3>
<div class="ltx_para ltx_noindent" id="A2.SS1.p1">
<p class="ltx_p" id="A2.SS1.p1.1">We now proceed to show detailed results from our ablation testing.</p>
</div>
<figure class="ltx_table" id="A2.T8">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 8: </span>Output and Chain-of-States Ablations</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A2.T8.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A2.T8.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A2.T8.1.1.1.1">Output Format</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="A2.T8.1.1.1.2">CoS</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T8.1.1.1.3">Improvement</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T8.1.1.1.4">Nonempty Improve.</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T8.1.1.1.5">Accuracy</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T8.1.1.1.6">Improved Acc.</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A2.T8.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A2.T8.1.2.1.1"><span class="ltx_text ltx_font_typewriter" id="A2.T8.1.2.1.1.1">string</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A2.T8.1.2.1.2">True</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.1.2.1.3">7.53</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.1.2.1.4">16.12</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.1.2.1.5">46.72%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.1.2.1.6">16.79%</td>
</tr>
<tr class="ltx_tr" id="A2.T8.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T8.1.3.2.1"><span class="ltx_text ltx_font_typewriter" id="A2.T8.1.3.2.1.1">string</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T8.1.3.2.2">False</th>
<td class="ltx_td ltx_align_center" id="A2.T8.1.3.2.3">7.03</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.3.2.4">19.67</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.3.2.5">35.77%</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.3.2.6">15.33%</td>
</tr>
<tr class="ltx_tr" id="A2.T8.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T8.1.4.3.1"><span class="ltx_text ltx_font_typewriter" id="A2.T8.1.4.3.1.1">string list</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T8.1.4.3.2"><span class="ltx_text ltx_font_bold" id="A2.T8.1.4.3.2.1">True</span></th>
<td class="ltx_td ltx_align_center" id="A2.T8.1.4.3.3"><span class="ltx_text ltx_font_bold" id="A2.T8.1.4.3.3.1">8.04</span></td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.4.3.4"><span class="ltx_text ltx_font_bold" id="A2.T8.1.4.3.4.1">12.38</span></td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.4.3.5"><span class="ltx_text ltx_font_bold" id="A2.T8.1.4.3.5.1">64.96%</span></td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.4.3.6"><span class="ltx_text ltx_font_bold" id="A2.T8.1.4.3.6.1">21.17%</span></td>
</tr>
<tr class="ltx_tr" id="A2.T8.1.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T8.1.5.4.1"><span class="ltx_text ltx_font_typewriter" id="A2.T8.1.5.4.1.1">string list</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T8.1.5.4.2">False</th>
<td class="ltx_td ltx_align_center" id="A2.T8.1.5.4.3">7.04</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.5.4.4">13.58</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.5.4.5">51.82%</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.5.4.6">18.98%</td>
</tr>
<tr class="ltx_tr" id="A2.T8.1.6.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T8.1.6.5.1"><span class="ltx_text ltx_font_typewriter" id="A2.T8.1.6.5.1.1">string tree</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T8.1.6.5.2">True</th>
<td class="ltx_td ltx_align_center" id="A2.T8.1.6.5.3">7.62</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.6.5.4">15.34</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.6.5.5">49.64%</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.6.5.6">18.25%</td>
</tr>
<tr class="ltx_tr" id="A2.T8.1.7.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A2.T8.1.7.6.1"><span class="ltx_text ltx_font_typewriter" id="A2.T8.1.7.6.1.1">string tree</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="A2.T8.1.7.6.2">False</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T8.1.7.6.3">6.31</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T8.1.7.6.4">14.17</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T8.1.7.6.5">44.53%</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T8.1.7.6.6">16.06%</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para ltx_noindent" id="A2.SS1.p2">
<p class="ltx_p" id="A2.SS1.p2.1">By <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2410.04753v1#A2.T8" title="Table 8 ‣ B.1 Ablation Details ‣ Appendix B Additional Experimental Results ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_tag">Table 8</span></a>, we see that the optimal combination in this testing group is a <span class="ltx_text ltx_font_typewriter" id="A2.SS1.p2.1.1">string list</span> output format with CoS enabled. Fix these values for all future tests.</p>
</div>
<figure class="ltx_table" id="A2.T9">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 9: </span>Example Retrieval Ablations</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A2.T9.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A2.T9.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="A2.T9.1.1.1.1">Examples</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T9.1.1.1.2">Improvement</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T9.1.1.1.3">Nonempty Improve.</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T9.1.1.1.4">Accuracy</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T9.1.1.1.5">Improved Acc.</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A2.T9.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A2.T9.1.2.1.1">0</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T9.1.2.1.2">5.67</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T9.1.2.1.3">8.44</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T9.1.2.1.4">67.15%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T9.1.2.1.5">16.79%</td>
</tr>
<tr class="ltx_tr" id="A2.T9.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T9.1.3.2.1">3</th>
<td class="ltx_td ltx_align_center" id="A2.T9.1.3.2.2">8.49</td>
<td class="ltx_td ltx_align_center" id="A2.T9.1.3.2.3">13.68</td>
<td class="ltx_td ltx_align_center" id="A2.T9.1.3.2.4">62.04%</td>
<td class="ltx_td ltx_align_center" id="A2.T9.1.3.2.5">19.71%</td>
</tr>
<tr class="ltx_tr" id="A2.T9.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T9.1.4.3.1">5</th>
<td class="ltx_td ltx_align_center" id="A2.T9.1.4.3.2">8.38</td>
<td class="ltx_td ltx_align_center" id="A2.T9.1.4.3.3">12.9</td>
<td class="ltx_td ltx_align_center" id="A2.T9.1.4.3.4">64.96%</td>
<td class="ltx_td ltx_align_center" id="A2.T9.1.4.3.5">21.17%</td>
</tr>
<tr class="ltx_tr" id="A2.T9.1.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T9.1.5.4.1">7</th>
<td class="ltx_td ltx_align_center" id="A2.T9.1.5.4.2">7.56</td>
<td class="ltx_td ltx_align_center" id="A2.T9.1.5.4.3">12.04</td>
<td class="ltx_td ltx_align_center" id="A2.T9.1.5.4.4">62.77%</td>
<td class="ltx_td ltx_align_center" id="A2.T9.1.5.4.5">19.71%</td>
</tr>
<tr class="ltx_tr" id="A2.T9.1.6.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="A2.T9.1.6.5.1"><span class="ltx_text ltx_font_bold" id="A2.T9.1.6.5.1.1">10</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T9.1.6.5.2"><span class="ltx_text ltx_font_bold" id="A2.T9.1.6.5.2.1">9.34</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T9.1.6.5.3"><span class="ltx_text ltx_font_bold" id="A2.T9.1.6.5.3.1">14.7</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T9.1.6.5.4"><span class="ltx_text ltx_font_bold" id="A2.T9.1.6.5.4.1">63.5%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T9.1.6.5.5"><span class="ltx_text ltx_font_bold" id="A2.T9.1.6.5.5.1">21.9%</span></td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para ltx_noindent" id="A2.SS1.p3">
<p class="ltx_p" id="A2.SS1.p3.1">With the previous optimal parameters fixed, run the ablation on the number of examples. By <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2410.04753v1#A2.T9" title="Table 9 ‣ B.1 Ablation Details ‣ Appendix B Additional Experimental Results ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_tag">Table 9</span></a>, we see that the optimal combination in this testing group is <math alttext="10" class="ltx_Math" display="inline" id="A2.SS1.p3.1.m1.1"><semantics id="A2.SS1.p3.1.m1.1a"><mn id="A2.SS1.p3.1.m1.1.1" xref="A2.SS1.p3.1.m1.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="A2.SS1.p3.1.m1.1b"><cn id="A2.SS1.p3.1.m1.1.1.cmml" type="integer" xref="A2.SS1.p3.1.m1.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p3.1.m1.1c">10</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p3.1.m1.1d">10</annotation></semantics></math> examples. Fix this value for all future tests.</p>
</div>
<figure class="ltx_table" id="A2.T10">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 10: </span>Sampling Method Ablations</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A2.T10.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A2.T10.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A2.T10.1.1.1.1">Method</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A2.T10.1.1.1.2">Forward</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="A2.T10.1.1.1.3">Keep Best</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T10.1.1.1.4">Improvement</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T10.1.1.1.5">Nonempty Improve.</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T10.1.1.1.6">Accuracy</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T10.1.1.1.7">Improved Acc.</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A2.T10.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A2.T10.1.2.1.1">None</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A2.T10.1.2.1.2">N/A</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A2.T10.1.2.1.3">N/A</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T10.1.2.1.4">9.34</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T10.1.2.1.5">14.7</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T10.1.2.1.6">63.5%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T10.1.2.1.7">21.9%</td>
</tr>
<tr class="ltx_tr" id="A2.T10.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T10.1.3.2.1">refinement</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T10.1.3.2.2">1</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T10.1.3.2.3">False</th>
<td class="ltx_td ltx_align_center" id="A2.T10.1.3.2.4">14.76</td>
<td class="ltx_td ltx_align_center" id="A2.T10.1.3.2.5">30.63</td>
<td class="ltx_td ltx_align_center" id="A2.T10.1.3.2.6">48.18%</td>
<td class="ltx_td ltx_align_center" id="A2.T10.1.3.2.7">30.66%</td>
</tr>
<tr class="ltx_tr" id="A2.T10.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T10.1.4.3.1">refinement</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T10.1.4.3.2">5</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T10.1.4.3.3">False</th>
<td class="ltx_td ltx_align_center" id="A2.T10.1.4.3.4">12.5</td>
<td class="ltx_td ltx_align_center" id="A2.T10.1.4.3.5">20.88</td>
<td class="ltx_td ltx_align_center" id="A2.T10.1.4.3.6">59.85%</td>
<td class="ltx_td ltx_align_center" id="A2.T10.1.4.3.7">30.66%</td>
</tr>
<tr class="ltx_tr" id="A2.T10.1.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T10.1.5.4.1">refinement</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T10.1.5.4.2">1</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T10.1.5.4.3">True</th>
<td class="ltx_td ltx_align_center" id="A2.T10.1.5.4.4">14.95</td>
<td class="ltx_td ltx_align_center" id="A2.T10.1.5.4.5">14.95</td>
<td class="ltx_td ltx_align_center" id="A2.T10.1.5.4.6">100.0%</td>
<td class="ltx_td ltx_align_center" id="A2.T10.1.5.4.7">30.66%</td>
</tr>
<tr class="ltx_tr" id="A2.T10.1.6.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T10.1.6.5.1">refinement</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T10.1.6.5.2">5</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T10.1.6.5.3">True</th>
<td class="ltx_td ltx_align_center" id="A2.T10.1.6.5.4">13.15</td>
<td class="ltx_td ltx_align_center" id="A2.T10.1.6.5.5">13.15</td>
<td class="ltx_td ltx_align_center" id="A2.T10.1.6.5.6">100.0%</td>
<td class="ltx_td ltx_align_center" id="A2.T10.1.6.5.7">29.93%</td>
</tr>
<tr class="ltx_tr" id="A2.T10.1.7.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A2.T10.1.7.6.1"><span class="ltx_text ltx_font_bold" id="A2.T10.1.7.6.1.1">best-of-n</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A2.T10.1.7.6.2">N/A</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="A2.T10.1.7.6.3">N/A</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T10.1.7.6.4"><span class="ltx_text ltx_font_bold" id="A2.T10.1.7.6.4.1">15.35</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T10.1.7.6.5"><span class="ltx_text ltx_font_bold" id="A2.T10.1.7.6.5.1">18.44</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T10.1.7.6.6"><span class="ltx_text ltx_font_bold" id="A2.T10.1.7.6.6.1">83.21%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T10.1.7.6.7"><span class="ltx_text ltx_font_bold" id="A2.T10.1.7.6.7.1">36.5%</span></td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para ltx_noindent" id="A2.SS1.p4">
<p class="ltx_p" id="A2.SS1.p4.1">Note that forward and keep-best values are parameters for refinement of how many previous iterations to forward, and whether to keep the most recent or the best iteration in subsequent refinement steps.</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS1.p5">
<p class="ltx_p" id="A2.SS1.p5.1">Now, with the previous optimal parameters fixed, run the ablation on the sample method. By <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2410.04753v1#A2.T10" title="Table 10 ‣ B.1 Ablation Details ‣ Appendix B Additional Experimental Results ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_tag">Table 10</span></a>, we see that the optimal combination in this testing group is best-of-n. Fix this value for all future tests.</p>
</div>
<figure class="ltx_table" id="A2.T11">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 11: </span>Model and <math alttext="n" class="ltx_Math" display="inline" id="A2.T11.2.m1.1"><semantics id="A2.T11.2.m1.1b"><mi id="A2.T11.2.m1.1.1" xref="A2.T11.2.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="A2.T11.2.m1.1c"><ci id="A2.T11.2.m1.1.1.cmml" xref="A2.T11.2.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T11.2.m1.1d">n</annotation><annotation encoding="application/x-llamapun" id="A2.T11.2.m1.1e">italic_n</annotation></semantics></math> Ablations</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A2.T11.3">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A2.T11.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A2.T11.3.1.2">Model</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="A2.T11.3.1.1"><math alttext="n" class="ltx_Math" display="inline" id="A2.T11.3.1.1.m1.1"><semantics id="A2.T11.3.1.1.m1.1a"><mi id="A2.T11.3.1.1.m1.1.1" xref="A2.T11.3.1.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="A2.T11.3.1.1.m1.1b"><ci id="A2.T11.3.1.1.m1.1.1.cmml" xref="A2.T11.3.1.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T11.3.1.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="A2.T11.3.1.1.m1.1d">italic_n</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T11.3.1.3">Improvement</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T11.3.1.4">Nonempty Improve.</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T11.3.1.5">Accuracy</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T11.3.1.6">Improved Acc.</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A2.T11.3.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A2.T11.3.2.1.1">gpt-4o</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A2.T11.3.2.1.2">3</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T11.3.2.1.3">19.66</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T11.3.2.1.4">24.36</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T11.3.2.1.5">80.7%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T11.3.2.1.6">38.6%</td>
</tr>
<tr class="ltx_tr" id="A2.T11.3.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T11.3.3.2.1">gpt-4o</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T11.3.3.2.2">5</th>
<td class="ltx_td ltx_align_center" id="A2.T11.3.3.2.3">20.12</td>
<td class="ltx_td ltx_align_center" id="A2.T11.3.3.2.4">24.97</td>
<td class="ltx_td ltx_align_center" id="A2.T11.3.3.2.5">80.56%</td>
<td class="ltx_td ltx_align_center" id="A2.T11.3.3.2.6">36.11%</td>
</tr>
<tr class="ltx_tr" id="A2.T11.3.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T11.3.4.3.1">gpt-4o</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T11.3.4.3.2">7</th>
<td class="ltx_td ltx_align_center" id="A2.T11.3.4.3.3">22.44</td>
<td class="ltx_td ltx_align_center" id="A2.T11.3.4.3.4">27.21</td>
<td class="ltx_td ltx_align_center" id="A2.T11.3.4.3.5">82.46%</td>
<td class="ltx_td ltx_align_center" id="A2.T11.3.4.3.6">42.11%</td>
</tr>
<tr class="ltx_tr" id="A2.T11.3.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T11.3.5.4.1">gpt-4o</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T11.3.5.4.2">10</th>
<td class="ltx_td ltx_align_center" id="A2.T11.3.5.4.3">21.73</td>
<td class="ltx_td ltx_align_center" id="A2.T11.3.5.4.4">25.28</td>
<td class="ltx_td ltx_align_center" id="A2.T11.3.5.4.5">85.96%</td>
<td class="ltx_td ltx_align_center" id="A2.T11.3.5.4.6">40.35%</td>
</tr>
<tr class="ltx_tr" id="A2.T11.3.6.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T11.3.6.5.1"><span class="ltx_text ltx_font_bold" id="A2.T11.3.6.5.1.1">gpt-4o</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T11.3.6.5.2"><span class="ltx_text ltx_font_bold" id="A2.T11.3.6.5.2.1">15</span></th>
<td class="ltx_td ltx_align_center" id="A2.T11.3.6.5.3"><span class="ltx_text ltx_font_bold" id="A2.T11.3.6.5.3.1">23.51</span></td>
<td class="ltx_td ltx_align_center" id="A2.T11.3.6.5.4"><span class="ltx_text ltx_font_bold" id="A2.T11.3.6.5.4.1">26.28</span></td>
<td class="ltx_td ltx_align_center" id="A2.T11.3.6.5.5"><span class="ltx_text ltx_font_bold" id="A2.T11.3.6.5.5.1">89.47%</span></td>
<td class="ltx_td ltx_align_center" id="A2.T11.3.6.5.6"><span class="ltx_text ltx_font_bold" id="A2.T11.3.6.5.6.1">45.61%</span></td>
</tr>
<tr class="ltx_tr" id="A2.T11.3.7.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T11.3.7.6.1">gpt-4o-mini</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T11.3.7.6.2">3</th>
<td class="ltx_td ltx_align_center" id="A2.T11.3.7.6.3">3.65</td>
<td class="ltx_td ltx_align_center" id="A2.T11.3.7.6.4">4.63</td>
<td class="ltx_td ltx_align_center" id="A2.T11.3.7.6.5">78.95%</td>
<td class="ltx_td ltx_align_center" id="A2.T11.3.7.6.6">8.77%</td>
</tr>
<tr class="ltx_tr" id="A2.T11.3.8.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T11.3.8.7.1">gpt-4o-mini</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T11.3.8.7.2">5</th>
<td class="ltx_td ltx_align_center" id="A2.T11.3.8.7.3">5.12</td>
<td class="ltx_td ltx_align_center" id="A2.T11.3.8.7.4">6.21</td>
<td class="ltx_td ltx_align_center" id="A2.T11.3.8.7.5">82.46%</td>
<td class="ltx_td ltx_align_center" id="A2.T11.3.8.7.6">10.53%</td>
</tr>
<tr class="ltx_tr" id="A2.T11.3.9.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T11.3.9.8.1">gpt-4o-mini</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T11.3.9.8.2">7</th>
<td class="ltx_td ltx_align_center" id="A2.T11.3.9.8.3">3.65</td>
<td class="ltx_td ltx_align_center" id="A2.T11.3.9.8.4">4.34</td>
<td class="ltx_td ltx_align_center" id="A2.T11.3.9.8.5">84.21%</td>
<td class="ltx_td ltx_align_center" id="A2.T11.3.9.8.6">8.77%</td>
</tr>
<tr class="ltx_tr" id="A2.T11.3.10.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T11.3.10.9.1">gpt-4o-mini</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T11.3.10.9.2">10</th>
<td class="ltx_td ltx_align_center" id="A2.T11.3.10.9.3">4.99</td>
<td class="ltx_td ltx_align_center" id="A2.T11.3.10.9.4">5.69</td>
<td class="ltx_td ltx_align_center" id="A2.T11.3.10.9.5">87.72%</td>
<td class="ltx_td ltx_align_center" id="A2.T11.3.10.9.6">12.28%</td>
</tr>
<tr class="ltx_tr" id="A2.T11.3.11.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T11.3.11.10.1">gpt-4o-mini</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T11.3.11.10.2">15</th>
<td class="ltx_td ltx_align_center" id="A2.T11.3.11.10.3">4.35</td>
<td class="ltx_td ltx_align_center" id="A2.T11.3.11.10.4">5.06</td>
<td class="ltx_td ltx_align_center" id="A2.T11.3.11.10.5">85.96%</td>
<td class="ltx_td ltx_align_center" id="A2.T11.3.11.10.6">12.28%</td>
</tr>
<tr class="ltx_tr" id="A2.T11.3.12.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A2.T11.3.12.11.1">gpt-4o-mini</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="A2.T11.3.12.11.2">20</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T11.3.12.11.3">4.87</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T11.3.12.11.4">5.56</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T11.3.12.11.5">87.72%</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T11.3.12.11.6">14.04%</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para ltx_noindent" id="A2.SS1.p6">
<p class="ltx_p" id="A2.SS1.p6.2">With the previous optimal parameters fixed, run the ablation on the value of <math alttext="n" class="ltx_Math" display="inline" id="A2.SS1.p6.1.m1.1"><semantics id="A2.SS1.p6.1.m1.1a"><mi id="A2.SS1.p6.1.m1.1.1" xref="A2.SS1.p6.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p6.1.m1.1b"><ci id="A2.SS1.p6.1.m1.1.1.cmml" xref="A2.SS1.p6.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p6.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p6.1.m1.1d">italic_n</annotation></semantics></math> and model. By <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2410.04753v1#A2.T11" title="Table 11 ‣ B.1 Ablation Details ‣ Appendix B Additional Experimental Results ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_tag">Table 11</span></a>, we see that the optimal combination in this testing group is GPT-4o with <math alttext="n=15" class="ltx_Math" display="inline" id="A2.SS1.p6.2.m2.1"><semantics id="A2.SS1.p6.2.m2.1a"><mrow id="A2.SS1.p6.2.m2.1.1" xref="A2.SS1.p6.2.m2.1.1.cmml"><mi id="A2.SS1.p6.2.m2.1.1.2" xref="A2.SS1.p6.2.m2.1.1.2.cmml">n</mi><mo id="A2.SS1.p6.2.m2.1.1.1" xref="A2.SS1.p6.2.m2.1.1.1.cmml">=</mo><mn id="A2.SS1.p6.2.m2.1.1.3" xref="A2.SS1.p6.2.m2.1.1.3.cmml">15</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p6.2.m2.1b"><apply id="A2.SS1.p6.2.m2.1.1.cmml" xref="A2.SS1.p6.2.m2.1.1"><eq id="A2.SS1.p6.2.m2.1.1.1.cmml" xref="A2.SS1.p6.2.m2.1.1.1"></eq><ci id="A2.SS1.p6.2.m2.1.1.2.cmml" xref="A2.SS1.p6.2.m2.1.1.2">𝑛</ci><cn id="A2.SS1.p6.2.m2.1.1.3.cmml" type="integer" xref="A2.SS1.p6.2.m2.1.1.3">15</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p6.2.m2.1c">n=15</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p6.2.m2.1d">italic_n = 15</annotation></semantics></math>. Fix this value for all future tests.</p>
</div>
<figure class="ltx_table" id="A2.T12">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 12: </span>RAG and Combination Sampling Method Ablations</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A2.T12.2">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A2.T12.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A2.T12.2.2.3">Combination</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A2.T12.1.1.1"><math alttext="m" class="ltx_Math" display="inline" id="A2.T12.1.1.1.m1.1"><semantics id="A2.T12.1.1.1.m1.1a"><mi id="A2.T12.1.1.1.m1.1.1" xref="A2.T12.1.1.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="A2.T12.1.1.1.m1.1b"><ci id="A2.T12.1.1.1.m1.1.1.cmml" xref="A2.T12.1.1.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T12.1.1.1.m1.1c">m</annotation><annotation encoding="application/x-llamapun" id="A2.T12.1.1.1.m1.1d">italic_m</annotation></semantics></math></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A2.T12.2.2.2"><math alttext="m^{\prime}" class="ltx_Math" display="inline" id="A2.T12.2.2.2.m1.1"><semantics id="A2.T12.2.2.2.m1.1a"><msup id="A2.T12.2.2.2.m1.1.1" xref="A2.T12.2.2.2.m1.1.1.cmml"><mi id="A2.T12.2.2.2.m1.1.1.2" xref="A2.T12.2.2.2.m1.1.1.2.cmml">m</mi><mo id="A2.T12.2.2.2.m1.1.1.3" xref="A2.T12.2.2.2.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="A2.T12.2.2.2.m1.1b"><apply id="A2.T12.2.2.2.m1.1.1.cmml" xref="A2.T12.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="A2.T12.2.2.2.m1.1.1.1.cmml" xref="A2.T12.2.2.2.m1.1.1">superscript</csymbol><ci id="A2.T12.2.2.2.m1.1.1.2.cmml" xref="A2.T12.2.2.2.m1.1.1.2">𝑚</ci><ci id="A2.T12.2.2.2.m1.1.1.3.cmml" xref="A2.T12.2.2.2.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T12.2.2.2.m1.1c">m^{\prime}</annotation><annotation encoding="application/x-llamapun" id="A2.T12.2.2.2.m1.1d">italic_m start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="A2.T12.2.2.4">RAG</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T12.2.2.5">Improvement</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T12.2.2.6">Nonempty Improve.</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T12.2.2.7">Accuracy</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T12.2.2.8">Improved Acc.</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A2.T12.2.3.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="A2.T12.2.3.1.1">best-of-n(refinement)</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A2.T12.2.3.1.2">3</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A2.T12.2.3.1.3">5</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A2.T12.2.3.1.4">True</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T12.2.3.1.5">33.78</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T12.2.3.1.6">33.78</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T12.2.3.1.7">100.0%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T12.2.3.1.8">50.0%</td>
</tr>
<tr class="ltx_tr" id="A2.T12.2.4.2">
<td class="ltx_td ltx_align_left" id="A2.T12.2.4.2.1">best-of-n(refinement)</td>
<td class="ltx_td ltx_align_left" id="A2.T12.2.4.2.2">3</td>
<td class="ltx_td ltx_align_left" id="A2.T12.2.4.2.3">5</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T12.2.4.2.4">False</td>
<td class="ltx_td ltx_align_center" id="A2.T12.2.4.2.5">31.23</td>
<td class="ltx_td ltx_align_center" id="A2.T12.2.4.2.6">31.23</td>
<td class="ltx_td ltx_align_center" id="A2.T12.2.4.2.7">100.0%</td>
<td class="ltx_td ltx_align_center" id="A2.T12.2.4.2.8">46.88%</td>
</tr>
<tr class="ltx_tr" id="A2.T12.2.5.3">
<td class="ltx_td ltx_align_left" id="A2.T12.2.5.3.1">best-of-n(refinement)</td>
<td class="ltx_td ltx_align_left" id="A2.T12.2.5.3.2">5</td>
<td class="ltx_td ltx_align_left" id="A2.T12.2.5.3.3">3</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T12.2.5.3.4">True</td>
<td class="ltx_td ltx_align_center" id="A2.T12.2.5.3.5">31.85</td>
<td class="ltx_td ltx_align_center" id="A2.T12.2.5.3.6">31.85</td>
<td class="ltx_td ltx_align_center" id="A2.T12.2.5.3.7">100.0%</td>
<td class="ltx_td ltx_align_center" id="A2.T12.2.5.3.8">50.0%</td>
</tr>
<tr class="ltx_tr" id="A2.T12.2.6.4">
<td class="ltx_td ltx_align_left" id="A2.T12.2.6.4.1">best-of-n(refinement)</td>
<td class="ltx_td ltx_align_left" id="A2.T12.2.6.4.2">5</td>
<td class="ltx_td ltx_align_left" id="A2.T12.2.6.4.3">3</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T12.2.6.4.4">False</td>
<td class="ltx_td ltx_align_center" id="A2.T12.2.6.4.5">31.35</td>
<td class="ltx_td ltx_align_center" id="A2.T12.2.6.4.6">31.35</td>
<td class="ltx_td ltx_align_center" id="A2.T12.2.6.4.7">100.0%</td>
<td class="ltx_td ltx_align_center" id="A2.T12.2.6.4.8">50.0%</td>
</tr>
<tr class="ltx_tr" id="A2.T12.2.7.5">
<td class="ltx_td ltx_align_left" id="A2.T12.2.7.5.1">refinement(best-of-n)</td>
<td class="ltx_td ltx_align_left" id="A2.T12.2.7.5.2">3</td>
<td class="ltx_td ltx_align_left" id="A2.T12.2.7.5.3">5</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T12.2.7.5.4">True</td>
<td class="ltx_td ltx_align_center" id="A2.T12.2.7.5.5">32.66</td>
<td class="ltx_td ltx_align_center" id="A2.T12.2.7.5.6">51.32</td>
<td class="ltx_td ltx_align_center" id="A2.T12.2.7.5.7">63.64%</td>
<td class="ltx_td ltx_align_center" id="A2.T12.2.7.5.8">48.48%</td>
</tr>
<tr class="ltx_tr" id="A2.T12.2.8.6">
<td class="ltx_td ltx_align_left" id="A2.T12.2.8.6.1">refinement(best-of-n)</td>
<td class="ltx_td ltx_align_left" id="A2.T12.2.8.6.2">3</td>
<td class="ltx_td ltx_align_left" id="A2.T12.2.8.6.3">5</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T12.2.8.6.4">False</td>
<td class="ltx_td ltx_align_center" id="A2.T12.2.8.6.5">32.88</td>
<td class="ltx_td ltx_align_center" id="A2.T12.2.8.6.6">50.1</td>
<td class="ltx_td ltx_align_center" id="A2.T12.2.8.6.7">65.62%</td>
<td class="ltx_td ltx_align_center" id="A2.T12.2.8.6.8">53.12%</td>
</tr>
<tr class="ltx_tr" id="A2.T12.2.9.7">
<td class="ltx_td ltx_align_left" id="A2.T12.2.9.7.1"><span class="ltx_text ltx_font_bold" id="A2.T12.2.9.7.1.1">refinement(best-of-n)</span></td>
<td class="ltx_td ltx_align_left" id="A2.T12.2.9.7.2"><span class="ltx_text ltx_font_bold" id="A2.T12.2.9.7.2.1">5</span></td>
<td class="ltx_td ltx_align_left" id="A2.T12.2.9.7.3"><span class="ltx_text ltx_font_bold" id="A2.T12.2.9.7.3.1">3</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T12.2.9.7.4"><span class="ltx_text ltx_font_bold" id="A2.T12.2.9.7.4.1">True</span></td>
<td class="ltx_td ltx_align_center" id="A2.T12.2.9.7.5"><span class="ltx_text ltx_font_bold" id="A2.T12.2.9.7.5.1">34.88</span></td>
<td class="ltx_td ltx_align_center" id="A2.T12.2.9.7.6"><span class="ltx_text ltx_font_bold" id="A2.T12.2.9.7.6.1">57.56</span></td>
<td class="ltx_td ltx_align_center" id="A2.T12.2.9.7.7"><span class="ltx_text ltx_font_bold" id="A2.T12.2.9.7.7.1">60.61%</span></td>
<td class="ltx_td ltx_align_center" id="A2.T12.2.9.7.8"><span class="ltx_text ltx_font_bold" id="A2.T12.2.9.7.8.1">54.55%</span></td>
</tr>
<tr class="ltx_tr" id="A2.T12.2.10.8">
<td class="ltx_td ltx_align_left" id="A2.T12.2.10.8.1">refinement(best-of-n)</td>
<td class="ltx_td ltx_align_left" id="A2.T12.2.10.8.2">5</td>
<td class="ltx_td ltx_align_left" id="A2.T12.2.10.8.3">3</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T12.2.10.8.4">False</td>
<td class="ltx_td ltx_align_center" id="A2.T12.2.10.8.5">29.54</td>
<td class="ltx_td ltx_align_center" id="A2.T12.2.10.8.6">49.75</td>
<td class="ltx_td ltx_align_center" id="A2.T12.2.10.8.7">59.38%</td>
<td class="ltx_td ltx_align_center" id="A2.T12.2.10.8.8">43.75%</td>
</tr>
<tr class="ltx_tr" id="A2.T12.2.11.9">
<td class="ltx_td ltx_align_left" id="A2.T12.2.11.9.1">best-of-n</td>
<td class="ltx_td ltx_align_left" id="A2.T12.2.11.9.2">N/A</td>
<td class="ltx_td ltx_align_left" id="A2.T12.2.11.9.3">15</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T12.2.11.9.4">True</td>
<td class="ltx_td ltx_align_center" id="A2.T12.2.11.9.5">29.64</td>
<td class="ltx_td ltx_align_center" id="A2.T12.2.11.9.6">32.71</td>
<td class="ltx_td ltx_align_center" id="A2.T12.2.11.9.7">90.62%</td>
<td class="ltx_td ltx_align_center" id="A2.T12.2.11.9.8">56.25%</td>
</tr>
<tr class="ltx_tr" id="A2.T12.2.12.10">
<td class="ltx_td ltx_align_left ltx_border_bb" id="A2.T12.2.12.10.1">best-of-n</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A2.T12.2.12.10.2">N/A</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A2.T12.2.12.10.3">15</td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" id="A2.T12.2.12.10.4">False</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T12.2.12.10.5">28.25</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T12.2.12.10.6">33.48</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T12.2.12.10.7">84.38%</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T12.2.12.10.8">53.12%</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para ltx_noindent" id="A2.SS1.p7">
<p class="ltx_p" id="A2.SS1.p7.1">With the previous optimal parameters fixed, run the ablation on the combination methods and if RAG is enabled. By <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2410.04753v1#A2.T12" title="Table 12 ‣ B.1 Ablation Details ‣ Appendix B Additional Experimental Results ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_tag">Table 12</span></a>, we see that the optimal combination in this testing group is a <math alttext="5" class="ltx_Math" display="inline" id="A2.SS1.p7.1.m1.1"><semantics id="A2.SS1.p7.1.m1.1a"><mn id="A2.SS1.p7.1.m1.1.1" xref="A2.SS1.p7.1.m1.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="A2.SS1.p7.1.m1.1b"><cn id="A2.SS1.p7.1.m1.1.1.cmml" type="integer" xref="A2.SS1.p7.1.m1.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p7.1.m1.1c">5</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p7.1.m1.1d">5</annotation></semantics></math>-step refinement with each iteration being a best-of-3 call, with RAG enabled.</p>
</div>
</section>
<section class="ltx_subsection" id="A2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.2 </span>Additional Qualitative Examples</h3>
<div class="ltx_para ltx_noindent" id="A2.SS2.p1">
<p class="ltx_p" id="A2.SS2.p1.1">In this section, we provide qualitative examples demonstrating the improvements <math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="A2.SS2.p1.1.m1.1"><semantics id="A2.SS2.p1.1.m1.1a"><mi id="A2.SS2.p1.1.m1.1.1" xref="A2.SS2.p1.1.m1.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.1.m1.1b"><ci id="A2.SS2.p1.1.m1.1.1.cmml" xref="A2.SS2.p1.1.m1.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.1.m1.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.p1.1.m1.1d">roman_ImProver</annotation></semantics></math> achieves in proof optimization.</p>
</div>
<section class="ltx_paragraph" id="A2.SS2.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Compfiles: Length Optimization</h5>
<div class="ltx_para ltx_noindent" id="A2.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="A2.SS2.SSS0.Px1.p1.1">See (§<a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#S4.SS3.SSS0.Px1" title="Example 1: Compfiles Optimization. ‣ 4.3 Qualitative Results ‣ 4 Experiments ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_tag">4.3</span></a>)</p>
</div>
</section>
<section class="ltx_paragraph" id="A2.SS2.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Compfiles: Readability Optimization</h5>
<div class="ltx_para ltx_noindent" id="A2.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="A2.SS2.SSS0.Px2.p1.1">Consider <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2410.04753v1#A2.F5" title="Figure 5 ‣ Compfiles: Readability Optimization ‣ B.2 Additional Qualitative Examples ‣ Appendix B Additional Experimental Results ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_tag">Figure 5</span></a>, in which a lemma from the 2019 IMO problem 1 (from the Compfiles dataset) is optimized for readability. This introduces multiple new hypotheses, which generalize a <span class="ltx_text ltx_font_typewriter" id="A2.SS2.SSS0.Px2.p1.1.1">linear_property</span> of the functions, and then reuses and instantiates that (and others, too) hypothesis throughout the proof, creating a significantly more declaritive, modular, and therefore readable proof.</p>
</div>
<figure class="ltx_figure" id="A2.F5">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_pagination ltx_figure_panel ltx_role_start_2_columns"></div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="A2.F5.2"><span class="ltx_text ltx_font_bold" id="A2.F5.2.1">Original (human-written)</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_listing ltx_figure_panel ltx_lst_language_lean ltx_lstlisting ltx_listing" id="A2.F5.3">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,bGVtbWEgYWRkaXRpdmVfdG9faW50X2xpbmVhciAoZiA6IOKEpCDihpIg4oSkKSAoaDog4oiAICh4IHkgOiDihKQpLCBmICh4ICsgeSkgPSBmIHggKyBmIHkpOgogICDiiIMgYywg4oiAIGEsIGYgYSA9IGMgKiBhICA6PSBieQogIGxldCBnIDo9IEFkZE1vbm9pZEhvbS50b0ludExpbmVhck1hcCA8fCBBZGRNb25vaWRIb20ubWsnIGYgaAogIHJlZmluZSDin6hmIDEsIGZ1biBhID0+ID9f4p+pCiAgY2hhbmdlIGcgYSA9IGcgMSAqIGEKICBydyBbbXVsX2NvbW0sIOKGkCBzbXVsX2VxX211bCwg4oaQIExpbmVhck1hcC5tYXBfc211bCwgc211bF9lcV9tdWwsIG11bF9vbmVd">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx93">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx93.1">lemma</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx93.2"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx93.3">additive_to_int_linear</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx93.4"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx93.5">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx93.6">f</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx93.7"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx93.8">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx93.9"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx93.10">ℤ</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx93.11"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx93.12">→</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx93.13"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx93.14">ℤ)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx93.15"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx93.16">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx93.17">h</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx93.18">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx93.19"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx93.20">∀</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx93.21"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx93.22">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx93.23">x</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx93.24"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx93.25">y</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx93.26"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx93.27">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx93.28"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx93.29">ℤ),</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx93.30"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx93.31">f</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx93.32"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx93.33">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx93.34">x</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx93.35"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx93.36">+</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx93.37"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx93.38">y</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx93.39">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx93.40"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx93.41">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx93.42"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx93.43">f</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx93.44"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx93.45">x</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx93.46"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx93.47">+</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx93.48"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx93.49">f</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx93.50"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx93.51">y</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx93.52">):</span>
</div>
<div class="ltx_listingline" id="lstnumberx94">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx94.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx94.2">∃</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx94.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx94.4">c</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx94.5">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx94.6"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx94.7">∀</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx94.8"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx94.9">a</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx94.10">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx94.11"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx94.12">f</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx94.13"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx94.14">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx94.15"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx94.16">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx94.17"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx94.18">c</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx94.19"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx94.20">*</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx94.21"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx94.22">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx94.23"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx94.24">:=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx94.25"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx94.26">by</span>
</div>
<div class="ltx_listingline" id="lstnumberx95">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx95.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx95.2">let</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx95.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx95.4">g</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx95.5"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx95.6">:=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx95.7"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx95.8">AddMonoidHom</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx95.9">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx95.10">toIntLinearMap</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx95.11"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx95.12">&lt;|</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx95.13"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx95.14">AddMonoidHom</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx95.15">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx95.16">mk</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx95.17">’</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx95.18"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx95.19">f</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx95.20"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx95.21">h</span>
</div>
<div class="ltx_listingline" id="lstnumberx96">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx96.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx96.2">refine</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx96.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx96.4">⟨</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx96.5">f</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx96.6"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx96.7">1,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx96.8"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx96.9">fun</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx96.10"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx96.11">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx96.12"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx96.13">=&gt;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx96.14"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx96.15">?</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx96.16">_</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx96.17">⟩</span>
</div>
<div class="ltx_listingline" id="lstnumberx97">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx97.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx97.2">change</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx97.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx97.4">g</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx97.5"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx97.6">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx97.7"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx97.8">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx97.9"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx97.10">g</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx97.11"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx97.12">1</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx97.13"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx97.14">*</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx97.15"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx97.16">a</span>
</div>
<div class="ltx_listingline" id="lstnumberx98">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx98.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx98.2">rw</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx98.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx98.4">[</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx98.5">mul_comm</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx98.6">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx98.7"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx98.8">←</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx98.9"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx98.10">smul_eq_mul</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx98.11">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx98.12"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx98.13">←</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx98.14"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx98.15">LinearMap</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx98.16">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx98.17">map_smul</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx98.18">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx98.19"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx98.20">smul_eq_mul</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx98.21">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx98.22"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx98.23">mul_one</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx98.24">]</span>
</div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="A2.F5.1"><span class="ltx_text" id="A2.F5.1.1"></span>
<math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="A2.F5.1.m1.1"><semantics id="A2.F5.1.m1.1a"><mi id="A2.F5.1.m1.1.1" xref="A2.F5.1.m1.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="A2.F5.1.m1.1b"><ci id="A2.F5.1.m1.1.1.cmml" xref="A2.F5.1.m1.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.F5.1.m1.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="A2.F5.1.m1.1d">roman_ImProver</annotation></semantics></math><span class="ltx_text ltx_font_bold" id="A2.F5.1.2"> (readability-optimized)</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_listing ltx_figure_panel ltx_lst_language_lean ltx_lstlisting ltx_listing" id="A2.F5.4">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,bGVtbWEgYWRkaXRpdmVfdG9faW50X2xpbmVhciAoZiA6IOKEpCDihpIg4oSkKSAoaDog4oiAICh4IHkgOiDihKQpLCBmICh4ICsgeSkgPSBmIHggKyBmIHkpOgogICDiiIMgYywg4oiAIGEsIGYgYSA9IGMgKiBhICAgOj0gYnkKICBsZXQgZyA6PSBBZGRNb25vaWRIb20udG9JbnRMaW5lYXJNYXAgPHwgQWRkTW9ub2lkSG9tLm1rJyBmIGgKICBoYXZlIGxpbmVhcl9wcm9wZXJ0eSA6IOKIgCBhLCBmIGEgPSBnIGEgOj0gYnkKICAgIGludHJvIGEKICAgIHJmbAogIGhhdmUgZ19zbXVsIDog4oiAIGEsIGcgYSA9IGcgMSAqIGEgOj0gYnkKICAgIGludHJvIGEKICAgIHJ3IFttdWxfY29tbSwg4oaQIHNtdWxfZXFfbXVsLCDihpAgTGluZWFyTWFwLm1hcF9zbXVsLCBzbXVsX2VxX211bCwgbXVsX29uZV0KICByZWZpbmUg4p+oZiAxLCBmdW4gYSA9PiA/X+KfqQogIGhhdmUgZl9lcV9nIDogZiBhID0gZyBhIDo9IGxpbmVhcl9wcm9wZXJ0eSBhCiAgaGF2ZSBnX2FfZXEgOiBnIGEgPSBnIDEgKiBhIDo9IGdfc211bCBhCiAgcncgW2ZfZXFfZywgbGluZWFyX3Byb3BlcnR5IDEsIGdfYV9lcV0=">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx99">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx99.1">lemma</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx99.2"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx99.3">additive_to_int_linear</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx99.4"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx99.5">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx99.6">f</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx99.7"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx99.8">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx99.9"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx99.10">ℤ</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx99.11"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx99.12">→</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx99.13"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx99.14">ℤ)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx99.15"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx99.16">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx99.17">h</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx99.18">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx99.19"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx99.20">∀</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx99.21"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx99.22">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx99.23">x</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx99.24"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx99.25">y</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx99.26"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx99.27">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx99.28"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx99.29">ℤ),</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx99.30"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx99.31">f</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx99.32"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx99.33">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx99.34">x</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx99.35"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx99.36">+</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx99.37"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx99.38">y</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx99.39">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx99.40"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx99.41">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx99.42"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx99.43">f</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx99.44"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx99.45">x</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx99.46"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx99.47">+</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx99.48"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx99.49">f</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx99.50"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx99.51">y</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx99.52">):</span>
</div>
<div class="ltx_listingline" id="lstnumberx100">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx100.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx100.2">∃</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx100.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx100.4">c</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx100.5">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx100.6"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx100.7">∀</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx100.8"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx100.9">a</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx100.10">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx100.11"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx100.12">f</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx100.13"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx100.14">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx100.15"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx100.16">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx100.17"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx100.18">c</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx100.19"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx100.20">*</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx100.21"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx100.22">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx100.23"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx100.24">:=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx100.25"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx100.26">by</span>
</div>
<div class="ltx_listingline" id="lstnumberx101">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx101.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx101.2">let</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx101.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx101.4">g</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx101.5"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx101.6">:=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx101.7"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx101.8">AddMonoidHom</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx101.9">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx101.10">toIntLinearMap</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx101.11"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx101.12">&lt;|</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx101.13"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx101.14">AddMonoidHom</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx101.15">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx101.16">mk</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx101.17">’</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx101.18"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx101.19">f</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx101.20"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx101.21">h</span>
</div>
<div class="ltx_listingline" id="lstnumberx102">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx102.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx102.2">have</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx102.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx102.4">linear_property</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx102.5"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx102.6">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx102.7"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx102.8">∀</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx102.9"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx102.10">a</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx102.11">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx102.12"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx102.13">f</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx102.14"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx102.15">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx102.16"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx102.17">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx102.18"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx102.19">g</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx102.20"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx102.21">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx102.22"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx102.23">:=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx102.24"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx102.25">by</span>
</div>
<div class="ltx_listingline" id="lstnumberx103">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx103.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx103.2">intro</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx103.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx103.4">a</span>
</div>
<div class="ltx_listingline" id="lstnumberx104">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx104.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx104.2">rfl</span>
</div>
<div class="ltx_listingline" id="lstnumberx105">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx105.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx105.2">have</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx105.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx105.4">g_smul</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx105.5"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx105.6">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx105.7"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx105.8">∀</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx105.9"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx105.10">a</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx105.11">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx105.12"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx105.13">g</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx105.14"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx105.15">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx105.16"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx105.17">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx105.18"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx105.19">g</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx105.20"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx105.21">1</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx105.22"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx105.23">*</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx105.24"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx105.25">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx105.26"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx105.27">:=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx105.28"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx105.29">by</span>
</div>
<div class="ltx_listingline" id="lstnumberx106">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx106.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx106.2">intro</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx106.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx106.4">a</span>
</div>
<div class="ltx_listingline" id="lstnumberx107">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx107.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx107.2">rw</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx107.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx107.4">[</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx107.5">mul_comm</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx107.6">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx107.7"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx107.8">←</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx107.9"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx107.10">smul_eq_mul</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx107.11">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx107.12"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx107.13">←</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx107.14"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx107.15">LinearMap</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx107.16">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx107.17">map_smul</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx107.18">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx107.19"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx107.20">smul_eq_mul</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx107.21">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx107.22"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx107.23">mul_one</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx107.24">]</span>
</div>
<div class="ltx_listingline" id="lstnumberx108">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx108.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx108.2">refine</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx108.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx108.4">⟨</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx108.5">f</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx108.6"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx108.7">1,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx108.8"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx108.9">fun</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx108.10"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx108.11">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx108.12"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx108.13">=&gt;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx108.14"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx108.15">?</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx108.16">_</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx108.17">⟩</span>
</div>
<div class="ltx_listingline" id="lstnumberx109">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx109.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx109.2">have</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx109.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx109.4">f_eq_g</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx109.5"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx109.6">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx109.7"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx109.8">f</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx109.9"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx109.10">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx109.11"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx109.12">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx109.13"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx109.14">g</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx109.15"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx109.16">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx109.17"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx109.18">:=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx109.19"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx109.20">linear_property</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx109.21"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx109.22">a</span>
</div>
<div class="ltx_listingline" id="lstnumberx110">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx110.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx110.2">have</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx110.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx110.4">g_a_eq</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx110.5"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx110.6">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx110.7"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx110.8">g</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx110.9"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx110.10">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx110.11"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx110.12">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx110.13"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx110.14">g</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx110.15"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx110.16">1</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx110.17"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx110.18">*</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx110.19"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx110.20">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx110.21"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx110.22">:=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx110.23"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx110.24">g_smul</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx110.25"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx110.26">a</span>
</div>
<div class="ltx_listingline" id="lstnumberx111">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx111.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx111.2">rw</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx111.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx111.4">[</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx111.5">f_eq_g</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx111.6">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx111.7"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx111.8">linear_property</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx111.9"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx111.10">1,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx111.11"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx111.12">g_a_eq</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx111.13">]</span>
</div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_pagination ltx_figure_panel ltx_role_end_2_columns"></div>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Optimizing a lemma from IMO 2019 P1 for readability</figcaption>
</figure>
</section>
<section class="ltx_paragraph" id="A2.SS2.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">MIL: Length Optimization</h5>
<div class="ltx_para ltx_noindent" id="A2.SS2.SSS0.Px3.p1">
<p class="ltx_p" id="A2.SS2.SSS0.Px3.p1.2">Consider <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2410.04753v1#A2.F6" title="Figure 6 ‣ MIL: Length Optimization ‣ B.2 Additional Qualitative Examples ‣ Appendix B Additional Experimental Results ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_tag">Figure 6</span></a>, which optimizes an exercise solution from MIL Chapter 8, Section 1 (Group theory) for length, eliminating <span class="ltx_text ltx_font_typewriter" id="A2.SS2.SSS0.Px3.p1.2.1">simp</span> calls and introducing proof terms into the structure of the proof to shorten it from <math alttext="9" class="ltx_Math" display="inline" id="A2.SS2.SSS0.Px3.p1.1.m1.1"><semantics id="A2.SS2.SSS0.Px3.p1.1.m1.1a"><mn id="A2.SS2.SSS0.Px3.p1.1.m1.1.1" xref="A2.SS2.SSS0.Px3.p1.1.m1.1.1.cmml">9</mn><annotation-xml encoding="MathML-Content" id="A2.SS2.SSS0.Px3.p1.1.m1.1b"><cn id="A2.SS2.SSS0.Px3.p1.1.m1.1.1.cmml" type="integer" xref="A2.SS2.SSS0.Px3.p1.1.m1.1.1">9</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.SSS0.Px3.p1.1.m1.1c">9</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.SSS0.Px3.p1.1.m1.1d">9</annotation></semantics></math> tactic invocations to <math alttext="7" class="ltx_Math" display="inline" id="A2.SS2.SSS0.Px3.p1.2.m2.1"><semantics id="A2.SS2.SSS0.Px3.p1.2.m2.1a"><mn id="A2.SS2.SSS0.Px3.p1.2.m2.1.1" xref="A2.SS2.SSS0.Px3.p1.2.m2.1.1.cmml">7</mn><annotation-xml encoding="MathML-Content" id="A2.SS2.SSS0.Px3.p1.2.m2.1b"><cn id="A2.SS2.SSS0.Px3.p1.2.m2.1.1.cmml" type="integer" xref="A2.SS2.SSS0.Px3.p1.2.m2.1.1">7</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.SSS0.Px3.p1.2.m2.1c">7</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.SSS0.Px3.p1.2.m2.1d">7</annotation></semantics></math>.</p>
</div>
<figure class="ltx_figure" id="A2.F6">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_pagination ltx_figure_panel ltx_role_start_2_columns"></div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="A2.F6.2"><span class="ltx_text ltx_font_bold" id="A2.F6.2.1">Original (human-written)</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_listing ltx_figure_panel ltx_lst_language_lean ltx_lstlisting ltx_listing" id="A2.F6.3">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,ZXhhbXBsZSAoz4YgOiBHIOKGkiogSCkgKM+IIDogSCDihpIqIEspIChTIDogU3ViZ3JvdXAgRykgOgogICAgbWFwICjPiC5jb21wIM+GKSBTID0gbWFwIM+IIChTLm1hcCDPhikgIDo9IGJ5CiAgZXh0IHgKICBzaW1wIG9ubHkgW21lbV9tYXBdCiAgY29uc3RydWN0b3IKICDCtyByaW50cm8g4p+oeSwgeV9pbiwgaHnin6kKICAgIGV4YWN0IOKfqM+GIHksIOKfqHksIHlfaW4sIHJmbOKfqSwgaHnin6kKICDCtyByaW50cm8g4p+oeSwg4p+oeiwgel9pbiwgaHrin6ksIGh54p+pCiAgICB1c2Ugeiwgel9pbgogICAgY2FsYyDPiC5jb21wIM+GIHogPSDPiCAoz4YgeikgOj0gcmZsCiAgICBfICAgICAgICAgICAgICAgPSDPiCB5IDo9IGJ5IGNvbmdy">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx112">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx112.1">example</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx112.2"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx112.3">(φ</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx112.4"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx112.5">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx112.6"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx112.7">G</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx112.8"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx112.9">→*</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx112.10"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx112.11">H</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx112.12">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx112.13"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx112.14">(ψ</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx112.15"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx112.16">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx112.17"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx112.18">H</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx112.19"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx112.20">→*</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx112.21"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx112.22">K</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx112.23">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx112.24"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx112.25">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx112.26">S</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx112.27"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx112.28">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx112.29"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx112.30">Subgroup</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx112.31"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx112.32">G</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx112.33">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx112.34"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx112.35">:</span>
</div>
<div class="ltx_listingline" id="lstnumberx113">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx113.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx113.2">map</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx113.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx113.4">(ψ.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx113.5">comp</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx113.6"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx113.7">φ)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx113.8"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx113.9">S</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx113.10"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx113.11">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx113.12"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx113.13">map</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx113.14"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx113.15">ψ</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx113.16"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx113.17">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx113.18">S</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx113.19">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx113.20">map</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx113.21"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx113.22">φ)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx113.23"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx113.24">:=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx113.25"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx113.26">by</span>
</div>
<div class="ltx_listingline" id="lstnumberx114">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx114.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx114.2">ext</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx114.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx114.4">x</span>
</div>
<div class="ltx_listingline" id="lstnumberx115">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx115.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx115.2">simp</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx115.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx115.4">only</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx115.5"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx115.6">[</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx115.7">mem_map</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx115.8">]</span>
</div>
<div class="ltx_listingline" id="lstnumberx116">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx116.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx116.2">constructor</span>
</div>
<div class="ltx_listingline" id="lstnumberx117">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx117.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx117.2">·</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx117.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx117.4">rintro</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx117.5"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx117.6">⟨</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx117.7">y</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx117.8">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx117.9"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx117.10">y_in</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx117.11">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx117.12"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx117.13">hy</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx117.14">⟩</span>
</div>
<div class="ltx_listingline" id="lstnumberx118">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx118.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx118.2">exact</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx118.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx118.4">⟨φ</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx118.5"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx118.6">y</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx118.7">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx118.8"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx118.9">⟨</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx118.10">y</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx118.11">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx118.12"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx118.13">y_in</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx118.14">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx118.15"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx118.16">rfl</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx118.17">⟩,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx118.18"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx118.19">hy</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx118.20">⟩</span>
</div>
<div class="ltx_listingline" id="lstnumberx119">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx119.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx119.2">·</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx119.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx119.4">rintro</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx119.5"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx119.6">⟨</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx119.7">y</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx119.8">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx119.9"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx119.10">⟨</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx119.11">z</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx119.12">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx119.13"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx119.14">z_in</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx119.15">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx119.16"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx119.17">hz</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx119.18">⟩,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx119.19"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx119.20">hy</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx119.21">⟩</span>
</div>
<div class="ltx_listingline" id="lstnumberx120">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx120.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx120.2">use</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx120.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx120.4">z</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx120.5">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx120.6"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx120.7">z_in</span>
</div>
<div class="ltx_listingline" id="lstnumberx121">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx121.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx121.2">calc</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx121.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx121.4">ψ.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx121.5">comp</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx121.6"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx121.7">φ</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx121.8"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx121.9">z</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx121.10"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx121.11">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx121.12"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx121.13">ψ</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx121.14"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx121.15">(φ</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx121.16"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx121.17">z</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx121.18">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx121.19"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx121.20">:=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx121.21"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx121.22">rfl</span>
</div>
<div class="ltx_listingline" id="lstnumberx122">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx122.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx122.2">_</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx122.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx122.4">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx122.5"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx122.6">ψ</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx122.7"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx122.8">y</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx122.9"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx122.10">:=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx122.11"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx122.12">by</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx122.13"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx122.14">congr</span>
</div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="A2.F6.1"><span class="ltx_text" id="A2.F6.1.1"></span>
<math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="A2.F6.1.m1.1"><semantics id="A2.F6.1.m1.1a"><mi id="A2.F6.1.m1.1.1" xref="A2.F6.1.m1.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="A2.F6.1.m1.1b"><ci id="A2.F6.1.m1.1.1.cmml" xref="A2.F6.1.m1.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.F6.1.m1.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="A2.F6.1.m1.1d">roman_ImProver</annotation></semantics></math><span class="ltx_text ltx_font_bold" id="A2.F6.1.2"> (length-optimized)</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_listing ltx_figure_panel ltx_lst_language_lean ltx_lstlisting ltx_listing" id="A2.F6.4">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,ZXhhbXBsZSAoz4YgOiBHIOKGkiogSCkgKM+IIDogSCDihpIqIEspIChTIDogU3ViZ3JvdXAgRykgOgogICAgbWFwICjPiC5jb21wIM+GKSBTID0gbWFwIM+IIChTLm1hcCDPhikgICA6PSBieQogIGV4dCB4CiAgc2ltcCBvbmx5IFttZW1fbWFwXQogIGNvbnN0cnVjdG9yCiAgcmludHJvIOKfqHksIHlfaW4sIGh54p+pOyBleGFjdCDin6jPhiB5LCDin6h5LCB5X2luLCByZmzin6ksIGh54p+pCiAgcmludHJvIOKfqHksIOKfqHosIHpfaW4sIGh64p+pLCBoeeKfqTsgZXhhY3Qg4p+oeiwgel9pbiwgKGNvbmdyX2FyZyDPiCBoeikudHJhbnMgaHnin6k=">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx123">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx123.1">example</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx123.2"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx123.3">(φ</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx123.4"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx123.5">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx123.6"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx123.7">G</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx123.8"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx123.9">→*</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx123.10"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx123.11">H</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx123.12">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx123.13"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx123.14">(ψ</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx123.15"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx123.16">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx123.17"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx123.18">H</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx123.19"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx123.20">→*</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx123.21"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx123.22">K</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx123.23">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx123.24"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx123.25">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx123.26">S</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx123.27"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx123.28">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx123.29"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx123.30">Subgroup</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx123.31"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx123.32">G</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx123.33">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx123.34"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx123.35">:</span>
</div>
<div class="ltx_listingline" id="lstnumberx124">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx124.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx124.2">map</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx124.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx124.4">(ψ.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx124.5">comp</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx124.6"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx124.7">φ)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx124.8"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx124.9">S</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx124.10"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx124.11">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx124.12"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx124.13">map</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx124.14"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx124.15">ψ</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx124.16"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx124.17">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx124.18">S</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx124.19">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx124.20">map</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx124.21"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx124.22">φ)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx124.23"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx124.24">:=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx124.25"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx124.26">by</span>
</div>
<div class="ltx_listingline" id="lstnumberx125">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx125.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx125.2">ext</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx125.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx125.4">x</span>
</div>
<div class="ltx_listingline" id="lstnumberx126">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx126.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx126.2">simp</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx126.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx126.4">only</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx126.5"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx126.6">[</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx126.7">mem_map</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx126.8">]</span>
</div>
<div class="ltx_listingline" id="lstnumberx127">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx127.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx127.2">constructor</span>
</div>
<div class="ltx_listingline" id="lstnumberx128">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx128.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx128.2">rintro</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx128.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx128.4">⟨</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx128.5">y</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx128.6">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx128.7"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx128.8">y_in</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx128.9">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx128.10"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx128.11">hy</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx128.12">⟩;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx128.13"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx128.14">exact</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx128.15"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx128.16">⟨φ</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx128.17"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx128.18">y</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx128.19">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx128.20"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx128.21">⟨</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx128.22">y</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx128.23">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx128.24"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx128.25">y_in</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx128.26">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx128.27"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx128.28">rfl</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx128.29">⟩,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx128.30"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx128.31">hy</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx128.32">⟩</span>
</div>
<div class="ltx_listingline" id="lstnumberx129">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx129.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx129.2">rintro</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx129.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx129.4">⟨</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx129.5">y</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx129.6">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx129.7"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx129.8">⟨</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx129.9">z</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx129.10">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx129.11"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx129.12">z_in</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx129.13">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx129.14"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx129.15">hz</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx129.16">⟩,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx129.17"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx129.18">hy</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx129.19">⟩;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx129.20"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx129.21">exact</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx129.22"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx129.23">⟨</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx129.24">z</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx129.25">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx129.26"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx129.27">z_in</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx129.28">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx129.29"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx129.30">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx129.31">congr_arg</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx129.32"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx129.33">ψ</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx129.34"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx129.35">hz</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx129.36">).</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx129.37">trans</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx129.38"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx129.39">hy</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx129.40">⟩</span>
</div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_pagination ltx_figure_panel ltx_role_end_2_columns"></div>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Optimizing a lemma from the solutions of MIL CH08 S01 for length</figcaption>
</figure>
</section>
<section class="ltx_paragraph" id="A2.SS2.SSS0.Px4">
<h5 class="ltx_title ltx_title_paragraph">MIL: Length Optimization 2</h5>
<div class="ltx_para ltx_noindent" id="A2.SS2.SSS0.Px4.p1">
<p class="ltx_p" id="A2.SS2.SSS0.Px4.p1.2">Consider <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2410.04753v1#A2.F6" title="Figure 6 ‣ MIL: Length Optimization ‣ B.2 Additional Qualitative Examples ‣ Appendix B Additional Experimental Results ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_tag">Figure 6</span></a>, which optimizes an exercise solution from MIL Chapter 8, Section 1 (Group theory) for length, converting a full tactic proof into a single proof term to shorten it from <math alttext="28" class="ltx_Math" display="inline" id="A2.SS2.SSS0.Px4.p1.1.m1.1"><semantics id="A2.SS2.SSS0.Px4.p1.1.m1.1a"><mn id="A2.SS2.SSS0.Px4.p1.1.m1.1.1" xref="A2.SS2.SSS0.Px4.p1.1.m1.1.1.cmml">28</mn><annotation-xml encoding="MathML-Content" id="A2.SS2.SSS0.Px4.p1.1.m1.1b"><cn id="A2.SS2.SSS0.Px4.p1.1.m1.1.1.cmml" type="integer" xref="A2.SS2.SSS0.Px4.p1.1.m1.1.1">28</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.SSS0.Px4.p1.1.m1.1c">28</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.SSS0.Px4.p1.1.m1.1d">28</annotation></semantics></math> tactic invocations to <math alttext="1" class="ltx_Math" display="inline" id="A2.SS2.SSS0.Px4.p1.2.m2.1"><semantics id="A2.SS2.SSS0.Px4.p1.2.m2.1a"><mn id="A2.SS2.SSS0.Px4.p1.2.m2.1.1" xref="A2.SS2.SSS0.Px4.p1.2.m2.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="A2.SS2.SSS0.Px4.p1.2.m2.1b"><cn id="A2.SS2.SSS0.Px4.p1.2.m2.1.1.cmml" type="integer" xref="A2.SS2.SSS0.Px4.p1.2.m2.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.SSS0.Px4.p1.2.m2.1c">1</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.SSS0.Px4.p1.2.m2.1d">1</annotation></semantics></math>. Note that the model does not have access to the Lean commands that symbolically generate proof terms, and therefore generates and estimates the proof term entirely by itself.</p>
</div>
<figure class="ltx_figure" id="A2.F7">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_pagination ltx_figure_panel ltx_role_start_2_columns"></div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="A2.F7.2"><span class="ltx_text ltx_font_bold" id="A2.F7.2.1">Original (human-written)</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_listing ltx_figure_panel ltx_lst_language_lean ltx_lstlisting ltx_listing" id="A2.F7.3">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,ZXhhbXBsZSA6IHMgXCB0IOKIqiB0IFwgcyA9IChzIOKIqiB0KSBcIChzIOKIqSB0KSAgOj0gYnkKICBleHQgeDsgY29uc3RydWN0b3IKICDCtyByaW50cm8gKOKfqHhzLCB4bnTin6kgfCDin6h4dCwgeG5z4p+pKQogICAgwrcgY29uc3RydWN0b3IKICAgICAgbGVmdAogICAgICBleGFjdCB4cwogICAgICByaW50cm8g4p+oXywgeHTin6kKICAgICAgY29udHJhZGljdGlvbgogICAgLiBjb25zdHJ1Y3RvcgogICAgICByaWdodAogICAgICBleGFjdCB4dAogICAgICByaW50cm8g4p+oeHMsIF/in6kKICAgICAgY29udHJhZGljdGlvbgogIHJpbnRybyDin6h4cyB8IHh0LCBueHN04p+pCiAgwrcgbGVmdAogICAgdXNlIHhzCiAgICBpbnRybyB4dAogICAgYXBwbHkgbnhzdAogICAgY29uc3RydWN0b3IgPDs+IGFzc3VtcHRpb24KICAuIHJpZ2h0OyB1c2UgeHQ7IGludHJvIHhzCiAgICBhcHBseSBueHN0CiAgICBjb25zdHJ1Y3RvciA8Oz4gYXNzdW1wdGlvbg==">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx130">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx130.1">example</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx130.2"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx130.3">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx130.4"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx130.5">s</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx130.6"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx130.7">\</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx130.8"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx130.9">t</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx130.10"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx130.11">∪</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx130.12"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx130.13">t</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx130.14"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx130.15">\</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx130.16"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx130.17">s</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx130.18"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx130.19">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx130.20"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx130.21">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx130.22">s</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx130.23"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx130.24">∪</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx130.25"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx130.26">t</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx130.27">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx130.28"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx130.29">\</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx130.30"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx130.31">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx130.32">s</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx130.33"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx130.34">∩</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx130.35"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx130.36">t</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx130.37">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx130.38"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx130.39">:=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx130.40"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx130.41">by</span>
</div>
<div class="ltx_listingline" id="lstnumberx131">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx131.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx131.2">ext</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx131.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx131.4">x</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx131.5">;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx131.6"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx131.7">constructor</span>
</div>
<div class="ltx_listingline" id="lstnumberx132">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx132.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx132.2">·</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx132.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx132.4">rintro</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx132.5"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx132.6">(⟨</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx132.7">xs</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx132.8">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx132.9"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx132.10">xnt</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx132.11">⟩</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx132.12"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx132.13">|</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx132.14"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx132.15">⟨</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx132.16">xt</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx132.17">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx132.18"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx132.19">xns</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx132.20">⟩)</span>
</div>
<div class="ltx_listingline" id="lstnumberx133">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx133.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx133.2">·</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx133.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx133.4">constructor</span>
</div>
<div class="ltx_listingline" id="lstnumberx134">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx134.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx134.2">left</span>
</div>
<div class="ltx_listingline" id="lstnumberx135">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx135.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx135.2">exact</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx135.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx135.4">xs</span>
</div>
<div class="ltx_listingline" id="lstnumberx136">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx136.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx136.2">rintro</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx136.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx136.4">⟨</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx136.5">_</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx136.6">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx136.7"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx136.8">xt</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx136.9">⟩</span>
</div>
<div class="ltx_listingline" id="lstnumberx137">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx137.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx137.2">contradiction</span>
</div>
<div class="ltx_listingline" id="lstnumberx138">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx138.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx138.2">.</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx138.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx138.4">constructor</span>
</div>
<div class="ltx_listingline" id="lstnumberx139">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx139.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx139.2">right</span>
</div>
<div class="ltx_listingline" id="lstnumberx140">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx140.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx140.2">exact</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx140.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx140.4">xt</span>
</div>
<div class="ltx_listingline" id="lstnumberx141">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx141.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx141.2">rintro</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx141.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx141.4">⟨</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx141.5">xs</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx141.6">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx141.7"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx141.8">_</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx141.9">⟩</span>
</div>
<div class="ltx_listingline" id="lstnumberx142">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx142.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx142.2">contradiction</span>
</div>
<div class="ltx_listingline" id="lstnumberx143">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx143.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx143.2">rintro</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx143.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx143.4">⟨</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx143.5">xs</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx143.6"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx143.7">|</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx143.8"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx143.9">xt</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx143.10">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx143.11"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx143.12">nxst</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx143.13">⟩</span>
</div>
<div class="ltx_listingline" id="lstnumberx144">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx144.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx144.2">·</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx144.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx144.4">left</span>
</div>
<div class="ltx_listingline" id="lstnumberx145">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx145.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx145.2">use</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx145.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx145.4">xs</span>
</div>
<div class="ltx_listingline" id="lstnumberx146">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx146.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx146.2">intro</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx146.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx146.4">xt</span>
</div>
<div class="ltx_listingline" id="lstnumberx147">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx147.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx147.2">apply</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx147.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx147.4">nxst</span>
</div>
<div class="ltx_listingline" id="lstnumberx148">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx148.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx148.2">constructor</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx148.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx148.4">&lt;;&gt;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx148.5"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx148.6">assumption</span>
</div>
<div class="ltx_listingline" id="lstnumberx149">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx149.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx149.2">.</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx149.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx149.4">right</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx149.5">;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx149.6"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx149.7">use</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx149.8"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx149.9">xt</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx149.10">;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx149.11"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx149.12">intro</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx149.13"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx149.14">xs</span>
</div>
<div class="ltx_listingline" id="lstnumberx150">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx150.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx150.2">apply</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx150.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx150.4">nxst</span>
</div>
<div class="ltx_listingline" id="lstnumberx151">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx151.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx151.2">constructor</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx151.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx151.4">&lt;;&gt;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx151.5"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx151.6">assumption</span>
</div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="A2.F7.1"><span class="ltx_text" id="A2.F7.1.1"></span>
<math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="A2.F7.1.m1.1"><semantics id="A2.F7.1.m1.1a"><mi id="A2.F7.1.m1.1.1" xref="A2.F7.1.m1.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="A2.F7.1.m1.1b"><ci id="A2.F7.1.m1.1.1.cmml" xref="A2.F7.1.m1.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.F7.1.m1.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="A2.F7.1.m1.1d">roman_ImProver</annotation></semantics></math><span class="ltx_text ltx_font_bold" id="A2.F7.1.2"> (length-optimized)</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_listing ltx_figure_panel ltx_lst_language_lean ltx_lstlisting ltx_listing" id="A2.F7.4">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,ZXhhbXBsZSA6IHMgXCB0IOKIqiB0IFwgcyA9IChzIOKIqiB0KSBcIChzIOKIqSB0KSAgICAgICA6PSBieQogIGV4YWN0IFNldC5leHQgZnVuIHggPT4g4p+oZnVuIGggPT4gaC5lbGltIChmdW4g4p+oeHMsIHhudOKfqSA9PiDin6hPci5pbmwgeHMsIGZ1biDin6hfLCB4dOKfqSA9PiB4bnQgeHTin6kpIChmdW4g4p+oeHQsIHhuc+KfqSA9PiDin6hPci5pbnIgeHQsIGZ1biDin6h4cywgX+KfqSA9PiB4bnMgeHPin6kpLAogIGZ1biDin6hoLCBueHN04p+pID0+IGguZWxpbSAoZnVuIHhzID0+IE9yLmlubCDin6h4cywgZnVuIHh0ID0+IG54c3Qg4p+oeHMsIHh04p+p4p+pKSAoZnVuIHh0ID0+IE9yLmluciDin6h4dCwgZnVuIHhzID0+IG54c3Qg4p+oeHMsIHh04p+p4p+pKeKfqQ==">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx152">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx152.1">example</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx152.2"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx152.3">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx152.4"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx152.5">s</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx152.6"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx152.7">\</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx152.8"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx152.9">t</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx152.10"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx152.11">∪</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx152.12"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx152.13">t</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx152.14"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx152.15">\</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx152.16"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx152.17">s</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx152.18"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx152.19">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx152.20"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx152.21">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx152.22">s</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx152.23"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx152.24">∪</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx152.25"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx152.26">t</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx152.27">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx152.28"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx152.29">\</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx152.30"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx152.31">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx152.32">s</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx152.33"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx152.34">∩</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx152.35"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx152.36">t</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx152.37">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx152.38"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx152.39">:=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx152.40"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx152.41">by</span>
</div>
<div class="ltx_listingline" id="lstnumberx153">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx153.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx153.2">exact</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx153.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx153.4">Set</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx153.5">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx153.6">ext</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx153.7"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx153.8">fun</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx153.9"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx153.10">x</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx153.11"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx153.12">=&gt;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx153.13"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx153.14">⟨</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx153.15">fun</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx153.16"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx153.17">h</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx153.18"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx153.19">=&gt;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx153.20"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx153.21">h</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx153.22">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx153.23">elim</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx153.24"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx153.25">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx153.26">fun</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx153.27"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx153.28">⟨</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx153.29">xs</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx153.30">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx153.31"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx153.32">xnt</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx153.33">⟩</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx153.34"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx153.35">=&gt;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx153.36"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx153.37">⟨</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx153.38">Or</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx153.39">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx153.40">inl</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx153.41"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx153.42">xs</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx153.43">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx153.44"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx153.45">fun</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx153.46"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx153.47">⟨</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx153.48">_</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx153.49">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx153.50"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx153.51">xt</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx153.52">⟩</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx153.53"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx153.54">=&gt;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx153.55"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx153.56">xnt</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx153.57"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx153.58">xt</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx153.59">⟩)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx153.60"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx153.61">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx153.62">fun</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx153.63"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx153.64">⟨</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx153.65">xt</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx153.66">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx153.67"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx153.68">xns</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx153.69">⟩</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx153.70"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx153.71">=&gt;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx153.72"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx153.73">⟨</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx153.74">Or</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx153.75">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx153.76">inr</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx153.77"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx153.78">xt</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx153.79">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx153.80"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx153.81">fun</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx153.82"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx153.83">⟨</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx153.84">xs</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx153.85">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx153.86"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx153.87">_</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx153.88">⟩</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx153.89"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx153.90">=&gt;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx153.91"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx153.92">xns</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx153.93"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx153.94">xs</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx153.95">⟩),</span>
</div>
<div class="ltx_listingline" id="lstnumberx154">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx154.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx154.2">fun</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx154.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx154.4">⟨</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx154.5">h</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx154.6">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx154.7"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx154.8">nxst</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx154.9">⟩</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx154.10"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx154.11">=&gt;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx154.12"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx154.13">h</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx154.14">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx154.15">elim</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx154.16"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx154.17">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx154.18">fun</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx154.19"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx154.20">xs</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx154.21"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx154.22">=&gt;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx154.23"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx154.24">Or</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx154.25">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx154.26">inl</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx154.27"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx154.28">⟨</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx154.29">xs</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx154.30">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx154.31"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx154.32">fun</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx154.33"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx154.34">xt</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx154.35"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx154.36">=&gt;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx154.37"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx154.38">nxst</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx154.39"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx154.40">⟨</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx154.41">xs</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx154.42">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx154.43"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx154.44">xt</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx154.45">⟩⟩)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx154.46"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx154.47">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx154.48">fun</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx154.49"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx154.50">xt</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx154.51"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx154.52">=&gt;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx154.53"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx154.54">Or</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx154.55">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx154.56">inr</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx154.57"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx154.58">⟨</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx154.59">xt</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx154.60">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx154.61"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx154.62">fun</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx154.63"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx154.64">xs</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx154.65"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx154.66">=&gt;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx154.67"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx154.68">nxst</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx154.69"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx154.70">⟨</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx154.71">xs</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx154.72">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx154.73"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx154.74">xt</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx154.75">⟩⟩)⟩</span>
</div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_pagination ltx_figure_panel ltx_role_end_2_columns"></div>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Optimizing a lemma from MIL CH04 S01 solution for length</figcaption>
</figure>
</section>
<section class="ltx_paragraph" id="A2.SS2.SSS0.Px5">
<h5 class="ltx_title ltx_title_paragraph">MIL: Readability Optimization</h5>
<div class="ltx_para ltx_noindent" id="A2.SS2.SSS0.Px5.p1">
<p class="ltx_p" id="A2.SS2.SSS0.Px5.p1.1">See (§<a class="ltx_ref" href="https://arxiv.org/html/2410.04753v1#S4.SS3.SSS0.Px2" title="Example 2: MIL. ‣ 4.3 Qualitative Results ‣ 4 Experiments ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_tag">4.3</span></a>)</p>
</div>
</section>
<section class="ltx_paragraph" id="A2.SS2.SSS0.Px6">
<h5 class="ltx_title ltx_title_paragraph">Mathlib: Length Optimization</h5>
<div class="ltx_para ltx_noindent" id="A2.SS2.SSS0.Px6.p1">
<p class="ltx_p" id="A2.SS2.SSS0.Px6.p1.2">Consider <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2410.04753v1#A2.F8" title="Figure 8 ‣ Mathlib: Length Optimization ‣ B.2 Additional Qualitative Examples ‣ Appendix B Additional Experimental Results ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_tag">Figure 8</span></a>, which optimizes a theorem in algebraic topology from mathlib for length, eliminating <span class="ltx_text ltx_font_typewriter" id="A2.SS2.SSS0.Px6.p1.2.1">simp</span> calls and combining tactics to shorten it from <math alttext="3" class="ltx_Math" display="inline" id="A2.SS2.SSS0.Px6.p1.1.m1.1"><semantics id="A2.SS2.SSS0.Px6.p1.1.m1.1a"><mn id="A2.SS2.SSS0.Px6.p1.1.m1.1.1" xref="A2.SS2.SSS0.Px6.p1.1.m1.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="A2.SS2.SSS0.Px6.p1.1.m1.1b"><cn id="A2.SS2.SSS0.Px6.p1.1.m1.1.1.cmml" type="integer" xref="A2.SS2.SSS0.Px6.p1.1.m1.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.SSS0.Px6.p1.1.m1.1c">3</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.SSS0.Px6.p1.1.m1.1d">3</annotation></semantics></math> tactic invocations to <math alttext="1" class="ltx_Math" display="inline" id="A2.SS2.SSS0.Px6.p1.2.m2.1"><semantics id="A2.SS2.SSS0.Px6.p1.2.m2.1a"><mn id="A2.SS2.SSS0.Px6.p1.2.m2.1.1" xref="A2.SS2.SSS0.Px6.p1.2.m2.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="A2.SS2.SSS0.Px6.p1.2.m2.1b"><cn id="A2.SS2.SSS0.Px6.p1.2.m2.1.1.cmml" type="integer" xref="A2.SS2.SSS0.Px6.p1.2.m2.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.SSS0.Px6.p1.2.m2.1c">1</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.SSS0.Px6.p1.2.m2.1d">1</annotation></semantics></math>.</p>
</div>
<figure class="ltx_figure" id="A2.F8">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_pagination ltx_figure_panel ltx_role_start_2_columns"></div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="A2.F8.2"><span class="ltx_text ltx_font_bold" id="A2.F8.2.1">Original (human-written)</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_listing ltx_figure_panel ltx_lst_language_lean ltx_lstlisting ltx_listing" id="A2.F8.3">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,Ly0tIElmIGBmKHAodCkgPSBnKHEodCkpYCBmb3IgdHdvIHBhdGhzIGBwYCBhbmQgYHFgLCB0aGVuIHRoZSBpbmR1Y2VkIHBhdGggaG9tb3RvcHkgY2xhc3NlcwpgZihwKWAgYW5kIGBnKHApYCBhcmUgdGhlIHNhbWUgYXMgd2VsbCwgZGVzcGl0ZSBoYXZpbmcgYSBwcmlvcmkgZGlmZmVyZW50IHR5cGVzIC0vCnRoZW9yZW0gaGVxX3BhdGhfb2ZfZXFfaW1hZ2UgOiBIRXEgKCjPgOKCmCBmKS5tYXAgJFxsbGJyYWNrZXQkcCRccnJicmFja2V0JCkgKCjPgOKCmCBnKS5tYXAgJFxsbGJyYWNrZXQkcSRccnJicmFja2V0JCkgIDo9IGJ5CiAgc2ltcCBvbmx5IFttYXBfZXEsIOKGkCBQYXRoLkhvbW90b3BpYy5tYXBfbGlmdF07IGFwcGx5IFBhdGguSG9tb3RvcGljLmhwYXRoX2hleHQ7IGV4YWN0IGhmZw==">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx155">
<span class="ltx_text ltx_font_typewriter" id="lstnumberx155.1">/--</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx155.2"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx155.3">If</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx155.4"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx155.5">‘</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx155.6">f</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx155.7">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx155.8">p</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx155.9">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx155.10">t</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx155.11">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx155.12"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx155.13">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx155.14"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx155.15">g</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx155.16">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx155.17">q</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx155.18">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx155.19">t</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx155.20">))‘</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx155.21"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx155.22">for</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx155.23"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx155.24">two</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx155.25"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx155.26">paths</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx155.27"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx155.28">‘</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx155.29">p</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx155.30">‘</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx155.31"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx155.32">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx155.33"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx155.34">‘</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx155.35">q</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx155.36">‘,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx155.37"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx155.38">then</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx155.39"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx155.40">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx155.41"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx155.42">induced</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx155.43"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx155.44">path</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx155.45"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx155.46">homotopy</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx155.47"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx155.48">classes</span>
</div>
<div class="ltx_listingline" id="lstnumberx156">
<span class="ltx_text ltx_font_typewriter" id="lstnumberx156.1">‘</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx156.2">f</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx156.3">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx156.4">p</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx156.5">)‘</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx156.6"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx156.7">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx156.8"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx156.9">‘</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx156.10">g</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx156.11">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx156.12">p</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx156.13">)‘</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx156.14"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx156.15">are</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx156.16"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx156.17">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx156.18"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx156.19">same</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx156.20"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx156.21">as</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx156.22"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx156.23">well</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx156.24">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx156.25"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx156.26">despite</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx156.27"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx156.28">having</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx156.29"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx156.30">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx156.31"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx156.32">priori</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx156.33"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx156.34">different</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx156.35"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx156.36">types</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx156.37"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx156.38">-/</span>
</div>
<div class="ltx_listingline" id="lstnumberx157">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx157.1">theorem</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx157.2"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx157.3">heq_path_of_eq_image</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx157.4"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx157.5">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx157.6"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx157.7">HEq</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx157.8"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx157.9">((πₘ</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx157.10"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx157.11">f</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx157.12">).</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx157.13">map</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx157.14"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx157.15">$</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx157.16">\</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx157.17">llbracket$p$</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx157.18">\</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx157.19">rrbracket$</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx157.20">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx157.21"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx157.22">((πₘ</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx157.23"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx157.24">g</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx157.25">).</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx157.26">map</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx157.27"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx157.28">$</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx157.29">\</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx157.30">llbracket$q$</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx157.31">\</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx157.32">rrbracket$</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx157.33">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx157.34"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx157.35">:=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx157.36"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx157.37">by</span>
</div>
<div class="ltx_listingline" id="lstnumberx158">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx158.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx158.2">simp</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx158.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx158.4">only</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx158.5"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx158.6">[</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx158.7">map_eq</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx158.8">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx158.9"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx158.10">←</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx158.11"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx158.12">Path</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx158.13">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx158.14">Homotopic</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx158.15">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx158.16">map_lift</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx158.17">];</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx158.18"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx158.19">apply</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx158.20"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx158.21">Path</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx158.22">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx158.23">Homotopic</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx158.24">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx158.25">hpath_hext</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx158.26">;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx158.27"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx158.28">exact</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx158.29"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx158.30">hfg</span>
</div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="A2.F8.1"><span class="ltx_text" id="A2.F8.1.1"></span>
<math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="A2.F8.1.m1.1"><semantics id="A2.F8.1.m1.1a"><mi id="A2.F8.1.m1.1.1" xref="A2.F8.1.m1.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="A2.F8.1.m1.1b"><ci id="A2.F8.1.m1.1.1.cmml" xref="A2.F8.1.m1.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.F8.1.m1.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="A2.F8.1.m1.1d">roman_ImProver</annotation></semantics></math><span class="ltx_text ltx_font_bold" id="A2.F8.1.2"> (length-optimized)</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_listing ltx_figure_panel ltx_lst_language_lean ltx_lstlisting ltx_listing" id="A2.F8.4">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,Ly0tIElmIGBmKHAodCkgPSBnKHEodCkpYCBmb3IgdHdvIHBhdGhzIGBwYCBhbmQgYHFgLCB0aGVuIHRoZSBpbmR1Y2VkIHBhdGggaG9tb3RvcHkgY2xhc3NlcwpgZihwKWAgYW5kIGBnKHApYCBhcmUgdGhlIHNhbWUgYXMgd2VsbCwgZGVzcGl0ZSBoYXZpbmcgYSBwcmlvcmkgZGlmZmVyZW50IHR5cGVzIC0vCnRoZW9yZW0gaGVxX3BhdGhfb2ZfZXFfaW1hZ2UgOiBIRXEgKCjPgOKCmCBmKS5tYXAgJFxsbGJyYWNrZXQkcCRccnJicmFja2V0JCkgKCjPgOKCmCBnKS5tYXAgJFxsbGJyYWNrZXQkcSRccnJicmFja2V0JCkgICAgOj0gYnkKICBleGFjdCBQYXRoLkhvbW90b3BpYy5ocGF0aF9oZXh0IGhmZw==">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx159">
<span class="ltx_text ltx_font_typewriter" id="lstnumberx159.1">/--</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx159.2"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx159.3">If</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx159.4"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx159.5">‘</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx159.6">f</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx159.7">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx159.8">p</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx159.9">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx159.10">t</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx159.11">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx159.12"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx159.13">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx159.14"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx159.15">g</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx159.16">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx159.17">q</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx159.18">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx159.19">t</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx159.20">))‘</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx159.21"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx159.22">for</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx159.23"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx159.24">two</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx159.25"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx159.26">paths</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx159.27"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx159.28">‘</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx159.29">p</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx159.30">‘</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx159.31"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx159.32">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx159.33"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx159.34">‘</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx159.35">q</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx159.36">‘,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx159.37"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx159.38">then</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx159.39"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx159.40">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx159.41"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx159.42">induced</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx159.43"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx159.44">path</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx159.45"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx159.46">homotopy</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx159.47"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx159.48">classes</span>
</div>
<div class="ltx_listingline" id="lstnumberx160">
<span class="ltx_text ltx_font_typewriter" id="lstnumberx160.1">‘</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx160.2">f</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx160.3">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx160.4">p</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx160.5">)‘</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx160.6"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx160.7">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx160.8"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx160.9">‘</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx160.10">g</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx160.11">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx160.12">p</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx160.13">)‘</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx160.14"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx160.15">are</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx160.16"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx160.17">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx160.18"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx160.19">same</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx160.20"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx160.21">as</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx160.22"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx160.23">well</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx160.24">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx160.25"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx160.26">despite</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx160.27"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx160.28">having</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx160.29"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx160.30">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx160.31"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx160.32">priori</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx160.33"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx160.34">different</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx160.35"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx160.36">types</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx160.37"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx160.38">-/</span>
</div>
<div class="ltx_listingline" id="lstnumberx161">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx161.5">theorem</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx161.6"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx161.7">heq_path_of_eq_image</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx161.8"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx161.9">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx161.10"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx161.11">HEq</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx161.12"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx161.13">((πₘ</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx161.14"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx161.15">f</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx161.16">).</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx161.17">map</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx161.18"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx161.1"><math alttext="\llbracket" class="ltx_Math" display="inline" id="lstnumberx161.1.m1.1"><semantics id="lstnumberx161.1.m1.1a"><mo id="lstnumberx161.1.m1.1.1" stretchy="false" xref="lstnumberx161.1.m1.1.1.cmml">⟦</mo><annotation-xml encoding="MathML-Content" id="lstnumberx161.1.m1.1b"><ci id="lstnumberx161.1.m1.1.1.cmml" xref="lstnumberx161.1.m1.1.1">⟦</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx161.1.m1.1c">\llbracket</annotation><annotation encoding="application/x-llamapun" id="lstnumberx161.1.m1.1d">⟦</annotation></semantics></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx161.19">p</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx161.2"><math alttext="\rrbracket" class="ltx_Math" display="inline" id="lstnumberx161.2.m1.1"><semantics id="lstnumberx161.2.m1.1a"><mo id="lstnumberx161.2.m1.1.1" stretchy="false" xref="lstnumberx161.2.m1.1.1.cmml">⟧</mo><annotation-xml encoding="MathML-Content" id="lstnumberx161.2.m1.1b"><ci id="lstnumberx161.2.m1.1.1.cmml" xref="lstnumberx161.2.m1.1.1">⟧</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx161.2.m1.1c">\rrbracket</annotation><annotation encoding="application/x-llamapun" id="lstnumberx161.2.m1.1d">⟧</annotation></semantics></math></span><span class="ltx_text ltx_font_typewriter" id="lstnumberx161.20">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx161.21"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx161.22">((πₘ</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx161.23"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx161.24">g</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx161.25">).</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx161.26">map</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx161.27"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx161.3"><math alttext="\llbracket" class="ltx_Math" display="inline" id="lstnumberx161.3.m1.1"><semantics id="lstnumberx161.3.m1.1a"><mo id="lstnumberx161.3.m1.1.1" stretchy="false" xref="lstnumberx161.3.m1.1.1.cmml">⟦</mo><annotation-xml encoding="MathML-Content" id="lstnumberx161.3.m1.1b"><ci id="lstnumberx161.3.m1.1.1.cmml" xref="lstnumberx161.3.m1.1.1">⟦</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx161.3.m1.1c">\llbracket</annotation><annotation encoding="application/x-llamapun" id="lstnumberx161.3.m1.1d">⟦</annotation></semantics></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx161.28">q</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx161.4"><math alttext="\rrbracket" class="ltx_Math" display="inline" id="lstnumberx161.4.m1.1"><semantics id="lstnumberx161.4.m1.1a"><mo id="lstnumberx161.4.m1.1.1" stretchy="false" xref="lstnumberx161.4.m1.1.1.cmml">⟧</mo><annotation-xml encoding="MathML-Content" id="lstnumberx161.4.m1.1b"><ci id="lstnumberx161.4.m1.1.1.cmml" xref="lstnumberx161.4.m1.1.1">⟧</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx161.4.m1.1c">\rrbracket</annotation><annotation encoding="application/x-llamapun" id="lstnumberx161.4.m1.1d">⟧</annotation></semantics></math></span><span class="ltx_text ltx_font_typewriter" id="lstnumberx161.29">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx161.30"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx161.31">:=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx161.32"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx161.33">by</span>
</div>
<div class="ltx_listingline" id="lstnumberx162">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx162.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx162.2">exact</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx162.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx162.4">Path</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx162.5">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx162.6">Homotopic</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx162.7">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx162.8">hpath_hext</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx162.9"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx162.10">hfg</span>
</div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_pagination ltx_figure_panel ltx_role_end_2_columns"></div>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Optimizing a theorem from <span class="ltx_text ltx_font_typewriter" id="A2.F8.6.1">Mathlib/FundamentalGroupoid/InducedMaps</span> for length</figcaption>
</figure>
</section>
<section class="ltx_paragraph" id="A2.SS2.SSS0.Px7">
<h5 class="ltx_title ltx_title_paragraph">Mathlib: Readability Optimization</h5>
<div class="ltx_para ltx_noindent" id="A2.SS2.SSS0.Px7.p1">
<p class="ltx_p" id="A2.SS2.SSS0.Px7.p1.1">Consider <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2410.04753v1#A2.F9" title="Figure 9 ‣ Mathlib: Readability Optimization ‣ B.2 Additional Qualitative Examples ‣ Appendix B Additional Experimental Results ‣ ImProver: Agent-Based Automated Proof Optimization"><span class="ltx_text ltx_ref_tag">Figure 9</span></a>, a theorem from Mathlib that we optimize for readability.</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS2.SSS0.Px7.p2">
<p class="ltx_p" id="A2.SS2.SSS0.Px7.p2.1">This original proof carried a score of <math alttext="0" class="ltx_Math" display="inline" id="A2.SS2.SSS0.Px7.p2.1.m1.1"><semantics id="A2.SS2.SSS0.Px7.p2.1.m1.1a"><mn id="A2.SS2.SSS0.Px7.p2.1.m1.1.1" xref="A2.SS2.SSS0.Px7.p2.1.m1.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="A2.SS2.SSS0.Px7.p2.1.m1.1b"><cn id="A2.SS2.SSS0.Px7.p2.1.m1.1.1.cmml" type="integer" xref="A2.SS2.SSS0.Px7.p2.1.m1.1.1">0</cn></annotation-xml></semantics></math>, as it does not contain any declarative statements. It is concise and efficient, however, it is difficult to understand and read.</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS2.SSS0.Px7.p3">
<p class="ltx_p" id="A2.SS2.SSS0.Px7.p3.1">After optimizing for readability, we see that the model did not change the structure of the proof. Rather, it added an intermediate declaration so that users can better understand the state after the <span class="ltx_text ltx_font_typewriter" id="A2.SS2.SSS0.Px7.p3.1.1">convert</span>. This intermediate tactic greatly helps in the understandability and clarity of the proof.</p>
</div>
<figure class="ltx_figure" id="A2.F9">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_pagination ltx_figure_panel ltx_role_start_2_columns"></div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="A2.F9.2"><span class="ltx_text ltx_font_bold" id="A2.F9.2.1">Original (human-written)</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_listing ltx_figure_panel ltx_lst_language_lean ltx_lstlisting ltx_listing" id="A2.F9.3">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,Ly0tIEFub3RoZXIgdmVyc2lvbiBvZiBgc2ltcGx5X2Nvbm5lY3RlZF9pZmZfcGF0aHNfaG9tb3RvcGljYCAtLwp0aGVvcmVtIHNpbXBseV9jb25uZWN0ZWRfaWZmX3BhdGhzX2hvbW90b3BpYycge1kgOiBUeXBlKn0gW1RvcG9sb2dpY2FsU3BhY2UgWV0gOgogICAgU2ltcGx5Q29ubmVjdGVkU3BhY2UgWSDihpQKICAgICAgUGF0aENvbm5lY3RlZFNwYWNlIFkg4oinIOKIgCB7eCB5IDogWX0gKHDigoEgcOKCgiA6IFBhdGggeCB5KSwgUGF0aC5Ib21vdG9waWMgcOKCgSBw4oKCICA6PSBieQogIGNvbnZlcnQgc2ltcGx5X2Nvbm5lY3RlZF9pZmZfcGF0aHNfaG9tb3RvcGljIChZIDo9IFkpCiAgc2ltcCBbUGF0aC5Ib21vdG9waWMuUXVvdGllbnQsIFNldG9pZC5lcV90b3BfaWZmXTsgcmZs">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx163">
<span class="ltx_text ltx_font_typewriter" id="lstnumberx163.1">/--</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx163.2"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx163.3">Another</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx163.4"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx163.5">version</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx163.6"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx163.7">of</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx163.8"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx163.9">‘</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx163.10">simply_connected_iff_paths_homotopic</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx163.11">‘</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx163.12"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx163.13">-/</span>
</div>
<div class="ltx_listingline" id="lstnumberx164">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx164.1">theorem</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx164.2"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx164.3">simply_connected_iff_paths_homotopic</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx164.4">’</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx164.5"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx164.6">{</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx164.7">Y</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx164.8"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx164.9">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx164.10"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx164.11">Type</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx164.12">*}</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx164.13"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx164.14">[</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx164.15">TopologicalSpace</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx164.16"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx164.17">Y</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx164.18">]</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx164.19"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx164.20">:</span>
</div>
<div class="ltx_listingline" id="lstnumberx165">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx165.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx165.2">SimplyConnectedSpace</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx165.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx165.4">Y</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx165.5"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx165.6">↔</span>
</div>
<div class="ltx_listingline" id="lstnumberx166">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx166.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx166.2">PathConnectedSpace</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx166.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx166.4">Y</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx166.5"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx166.6">∧</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx166.7"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx166.8">∀</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx166.9"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx166.10">{</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx166.11">x</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx166.12"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx166.13">y</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx166.14"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx166.15">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx166.16"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx166.17">Y</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx166.18">}</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx166.19"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx166.20">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx166.21">p</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx166.22">₁</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx166.23"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx166.24">p</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx166.25">₂</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx166.26"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx166.27">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx166.28"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx166.29">Path</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx166.30"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx166.31">x</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx166.32"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx166.33">y</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx166.34">),</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx166.35"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx166.36">Path</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx166.37">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx166.38">Homotopic</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx166.39"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx166.40">p</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx166.41">₁</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx166.42"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx166.43">p</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx166.44">₂</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx166.45"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx166.46">:=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx166.47"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx166.48">by</span>
</div>
<div class="ltx_listingline" id="lstnumberx167">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx167.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx167.2">convert</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx167.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx167.4">simply_connected_iff_paths_homotopic</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx167.5"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx167.6">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx167.7">Y</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx167.8"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx167.9">:=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx167.10"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx167.11">Y</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx167.12">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx168">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx168.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx168.2">simp</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx168.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx168.4">[</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx168.5">Path</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx168.6">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx168.7">Homotopic</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx168.8">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx168.9">Quotient</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx168.10">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx168.11"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx168.12">Setoid</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx168.13">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx168.14">eq_top_iff</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx168.15">];</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx168.16"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx168.17">rfl</span>
</div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="A2.F9.1"><span class="ltx_text" id="A2.F9.1.1"></span>
<math alttext="\mathrm{ImProver}" class="ltx_Math" display="inline" id="A2.F9.1.m1.1"><semantics id="A2.F9.1.m1.1a"><mi id="A2.F9.1.m1.1.1" xref="A2.F9.1.m1.1.1.cmml">ImProver</mi><annotation-xml encoding="MathML-Content" id="A2.F9.1.m1.1b"><ci id="A2.F9.1.m1.1.1.cmml" xref="A2.F9.1.m1.1.1">ImProver</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.F9.1.m1.1c">\mathrm{ImProver}</annotation><annotation encoding="application/x-llamapun" id="A2.F9.1.m1.1d">roman_ImProver</annotation></semantics></math><span class="ltx_text ltx_font_bold" id="A2.F9.1.2"> (readability-optimized)</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_listing ltx_figure_panel ltx_lst_language_lean ltx_lstlisting ltx_listing" id="A2.F9.4">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,Ly0tIEFub3RoZXIgdmVyc2lvbiBvZiBgc2ltcGx5X2Nvbm5lY3RlZF9pZmZfcGF0aHNfaG9tb3RvcGljYCAtLwp0aGVvcmVtIHNpbXBseV9jb25uZWN0ZWRfaWZmX3BhdGhzX2hvbW90b3BpYycge1kgOiBUeXBlKn0gW1RvcG9sb2dpY2FsU3BhY2UgWV0gOgogICAgU2ltcGx5Q29ubmVjdGVkU3BhY2UgWSDihpQKICAgICAgUGF0aENvbm5lY3RlZFNwYWNlIFkg4oinIOKIgCB7eCB5IDogWX0gKHDigoEgcOKCgiA6IFBhdGggeCB5KSwgUGF0aC5Ib21vdG9waWMgcOKCgSBw4oKCICAgOj0gYnkKICBjb252ZXJ0IHNpbXBseV9jb25uZWN0ZWRfaWZmX3BhdGhzX2hvbW90b3BpYyAoWSA6PSBZKQogIGhhdmUgaDEgOiDiiIAgeCB5IDogWSwgU3Vic2luZ2xldG9uIChQYXRoLkhvbW90b3BpYy5RdW90aWVudCB4IHkpIOKGlCDiiIAge3DigoEgcOKCgiA6IFBhdGggeCB5fSwgUGF0aC5Ib21vdG9waWMgcOKCgSBw4oKCIDo9IGJ5CiAgICBpbnRybyB4IHkKICAgIHNpbXAgW1BhdGguSG9tb3RvcGljLlF1b3RpZW50LCBTZXRvaWQuZXFfdG9wX2lmZl0KICAgIHJmbAogIHNpbXAgb25seSBbaDFd">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx169">
<span class="ltx_text ltx_font_typewriter" id="lstnumberx169.1">/--</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx169.2"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx169.3">Another</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx169.4"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx169.5">version</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx169.6"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx169.7">of</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx169.8"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx169.9">‘</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx169.10">simply_connected_iff_paths_homotopic</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx169.11">‘</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx169.12"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx169.13">-/</span>
</div>
<div class="ltx_listingline" id="lstnumberx170">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx170.1">theorem</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx170.2"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx170.3">simply_connected_iff_paths_homotopic</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx170.4">’</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx170.5"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx170.6">{</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx170.7">Y</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx170.8"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx170.9">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx170.10"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx170.11">Type</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx170.12">*}</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx170.13"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx170.14">[</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx170.15">TopologicalSpace</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx170.16"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx170.17">Y</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx170.18">]</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx170.19"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx170.20">:</span>
</div>
<div class="ltx_listingline" id="lstnumberx171">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx171.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx171.2">SimplyConnectedSpace</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx171.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx171.4">Y</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx171.5"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx171.6">↔</span>
</div>
<div class="ltx_listingline" id="lstnumberx172">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx172.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx172.2">PathConnectedSpace</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx172.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx172.4">Y</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx172.5"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx172.6">∧</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx172.7"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx172.8">∀</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx172.9"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx172.10">{</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx172.11">x</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx172.12"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx172.13">y</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx172.14"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx172.15">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx172.16"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx172.17">Y</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx172.18">}</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx172.19"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx172.20">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx172.21">p</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx172.22">₁</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx172.23"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx172.24">p</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx172.25">₂</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx172.26"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx172.27">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx172.28"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx172.29">Path</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx172.30"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx172.31">x</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx172.32"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx172.33">y</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx172.34">),</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx172.35"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx172.36">Path</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx172.37">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx172.38">Homotopic</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx172.39"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx172.40">p</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx172.41">₁</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx172.42"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx172.43">p</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx172.44">₂</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx172.45"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx172.46">:=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx172.47"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx172.48">by</span>
</div>
<div class="ltx_listingline" id="lstnumberx173">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx173.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx173.2">convert</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx173.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx173.4">simply_connected_iff_paths_homotopic</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx173.5"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx173.6">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx173.7">Y</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx173.8"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx173.9">:=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx173.10"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx173.11">Y</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx173.12">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx174">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx174.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx174.2">have</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx174.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx174.4">h1</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx174.5"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx174.6">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx174.7"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx174.8">∀</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx174.9"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx174.10">x</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx174.11"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx174.12">y</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx174.13"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx174.14">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx174.15"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx174.16">Y</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx174.17">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx174.18"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx174.19">Subsingleton</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx174.20"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx174.21">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx174.22">Path</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx174.23">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx174.24">Homotopic</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx174.25">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx174.26">Quotient</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx174.27"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx174.28">x</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx174.29"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx174.30">y</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx174.31">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx174.32"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx174.33">↔</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx174.34"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx174.35">∀</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx174.36"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx174.37">{</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx174.38">p</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx174.39">₁</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx174.40"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx174.41">p</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx174.42">₂</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx174.43"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx174.44">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx174.45"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx174.46">Path</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx174.47"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx174.48">x</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx174.49"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx174.50">y</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx174.51">},</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx174.52"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx174.53">Path</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx174.54">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx174.55">Homotopic</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx174.56"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx174.57">p</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx174.58">₁</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx174.59"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx174.60">p</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx174.61">₂</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx174.62"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx174.63">:=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx174.64"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx174.65">by</span>
</div>
<div class="ltx_listingline" id="lstnumberx175">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx175.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx175.2">intro</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx175.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx175.4">x</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx175.5"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx175.6">y</span>
</div>
<div class="ltx_listingline" id="lstnumberx176">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx176.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx176.2">simp</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx176.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx176.4">[</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx176.5">Path</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx176.6">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx176.7">Homotopic</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx176.8">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx176.9">Quotient</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx176.10">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx176.11"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx176.12">Setoid</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx176.13">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx176.14">eq_top_iff</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx176.15">]</span>
</div>
<div class="ltx_listingline" id="lstnumberx177">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx177.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx177.2">rfl</span>
</div>
<div class="ltx_listingline" id="lstnumberx178">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx178.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx178.2">simp</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx178.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx178.4">only</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx178.5"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx178.6">[</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx178.7">h1</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx178.8">]</span>
</div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_pagination ltx_figure_panel ltx_role_end_2_columns"></div>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Optimizing a theorem from <span class="ltx_text ltx_font_typewriter" id="A2.F9.6.1">Mathlib/FundamentalGroupoid/SimplyConnected</span> for readability</figcaption>
</figure>
</section>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Mon Oct  7 05:12:03 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
