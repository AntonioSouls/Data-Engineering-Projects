<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2302.13996] Aligning Bag of Regions for Open-Vocabulary Object Detection</title><meta property="og:description" content="Pre-trained vision-language models (VLMs) learn to align vision and language representations on large-scale datasets, where each image-text pair usually contains a bag of semantic concepts.
However, existing open-vocab…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Aligning Bag of Regions for Open-Vocabulary Object Detection">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Aligning Bag of Regions for Open-Vocabulary Object Detection">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2302.13996">

<!--Generated on Thu Feb 29 23:46:55 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Aligning Bag of Regions for Open-Vocabulary Object Detection</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Size Wu<sup id="id11.10.id1" class="ltx_sup"><span id="id11.10.id1.1" class="ltx_text ltx_font_italic">1</span></sup>  Wenwei Zhang<sup id="id12.11.id2" class="ltx_sup"><span id="id12.11.id2.1" class="ltx_text ltx_font_italic">1</span></sup>  Sheng Jin<sup id="id13.12.id3" class="ltx_sup"><span id="id13.12.id3.1" class="ltx_text ltx_font_italic">2,3</span></sup>  Wentao Liu<sup id="id14.13.id4" class="ltx_sup"><span id="id14.13.id4.1" class="ltx_text ltx_font_italic">3,4</span></sup>  Chen Change Loy<sup id="id15.14.id5" class="ltx_sup"><span id="id15.14.id5.1" class="ltx_text ltx_font_italic">1</span></sup> 
<br class="ltx_break"><sup id="id16.15.id6" class="ltx_sup"><span id="id16.15.id6.1" class="ltx_text ltx_font_italic">1</span></sup>Nanyang Technological University  <sup id="id17.16.id7" class="ltx_sup"><span id="id17.16.id7.1" class="ltx_text ltx_font_italic">2</span></sup> The University of Hong Kong 
<br class="ltx_break"><sup id="id18.17.id8" class="ltx_sup"><span id="id18.17.id8.1" class="ltx_text ltx_font_italic">3</span></sup> SenseTime Research and Tetras.AI  <sup id="id19.18.id9" class="ltx_sup"><span id="id19.18.id9.1" class="ltx_text ltx_font_italic">4</span></sup> Shanghai AI Laboratory 
<br class="ltx_break"><span id="id20.19.id10" class="ltx_text ltx_font_typewriter" style="font-size:90%;">{size001, wenwei001, ccloy}@ntu.edu.sg</span>  <span id="id21.20.id11" class="ltx_text ltx_font_typewriter" style="font-size:90%;">{jinsheng, liuwentao}@sensetime.com 
<br class="ltx_break"></span>
</span><span class="ltx_author_notes">Corresponding author.</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id10.1" class="ltx_p">Pre-trained vision-language models (VLMs) learn to align vision and language representations on large-scale datasets, where each image-text pair usually contains a bag of semantic concepts.
However, existing open-vocabulary object detectors only align region embeddings <em id="id10.1.1" class="ltx_emph ltx_font_italic">individually</em> with the corresponding features extracted from the VLMs.
Such a design leaves the compositional structure of semantic concepts in a scene under-exploited, although the structure may be implicitly learned by the VLMs.
In this work, we propose to align the embedding of <em id="id10.1.2" class="ltx_emph ltx_font_italic">bag of regions</em> beyond individual regions.
The proposed method groups contextually interrelated regions as a bag.
The embeddings of regions in a bag are treated as embeddings of words in a sentence, and they are sent to the text encoder of a VLM to obtain the bag-of-regions embedding, which is learned to be aligned to the corresponding features extracted by a frozen VLM.
Applied to the commonly used Faster R-CNN, our approach surpasses the previous best results by 4.6 box AP<math id="id10.1.m1.1" class="ltx_Math" alttext="{}_{\text{50}}" display="inline"><semantics id="id10.1.m1.1a"><msub id="id10.1.m1.1.1" xref="id10.1.m1.1.1.cmml"><mi id="id10.1.m1.1.1a" xref="id10.1.m1.1.1.cmml"></mi><mtext id="id10.1.m1.1.1.1" xref="id10.1.m1.1.1.1a.cmml">50</mtext></msub><annotation-xml encoding="MathML-Content" id="id10.1.m1.1b"><apply id="id10.1.m1.1.1.cmml" xref="id10.1.m1.1.1"><ci id="id10.1.m1.1.1.1a.cmml" xref="id10.1.m1.1.1.1"><mtext mathsize="70%" id="id10.1.m1.1.1.1.cmml" xref="id10.1.m1.1.1.1">50</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="id10.1.m1.1c">{}_{\text{50}}</annotation></semantics></math> and 2.8 mask AP on novel categories of open-vocabulary COCO and LVIS benchmarks, respectively.
Code and models are available at <a target="_blank" href="https://github.com/wusize/ovdet" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/wusize/ovdet</a>.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<figure id="S1.F1" class="ltx_figure"><img src="/html/2302.13996/assets/figs/teaser.jpg" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="343" height="303" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.8.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S1.F1.9.2" class="ltx_text" style="font-size:90%;">
<span id="S1.F1.9.2.1" class="ltx_text ltx_font_bold">(a)</span> Typical vision-language models (VLMs) learn to align representations of images and captions with rich compositional structure.
<span id="S1.F1.9.2.2" class="ltx_text ltx_font_bold">(b)</span> Existing distillation-based object detectors align each <em id="S1.F1.9.2.3" class="ltx_emph ltx_font_italic">individual</em> region embedding to features extracted by the frozen image encoder of VLMs.
<span id="S1.F1.9.2.4" class="ltx_text ltx_font_bold">(c)</span> Instead, the proposed method aligns the embedding of <em id="S1.F1.9.2.5" class="ltx_emph ltx_font_italic">bag of regions</em>. The region embeddings in a bag are projected to the word embedding space (dubbed as pseudo words), formed as a sentence, and then sent to the text encoder to obtain the <em id="S1.F1.9.2.6" class="ltx_emph ltx_font_italic">bag-of-regions</em> embedding, which is aligned to the corresponding image feature extracted by the frozen VLMs.
</span></figcaption>
</figure>
<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">A traditional object detector can only recognize categories learned in the training phase, restricting its application in the real world with a nearly unbounded concept pool.
Open-vocabulary object detection (OVD), a task to detect objects whose categories are absent in training, has drawn increasing research attention in recent years.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">A typical solution to OVD, known as the distillation-based approach, is to distill the knowledge of rich and unseen categories from pre-trained vision-language models (VLMs) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>.
In particular, VLMs learn aligned image and text representations on large-scale image-text pairs (Fig. <a href="#S1.F1" title="Fig. 1 ‣ 1 Introduction ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>(a)). Such general knowledge is beneficial for OVD. To extract the knowledge, most distillation-based approaches <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib55" title="" class="ltx_ref">55</a>]</cite> align each <em id="S1.p2.1.1" class="ltx_emph ltx_font_italic">individual</em> region embedding to the corresponding features extracted from the VLM (Fig. <a href="#S1.F1" title="Fig. 1 ‣ 1 Introduction ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>(b)) with some carefully designed strategies.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">We believe VLMs have implicitly learned the inherent compositional structure of multiple semantic concepts (<em id="S1.p3.1.1" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S1.p3.1.2" class="ltx_text"></span>, co-existence of stuff and things <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>) from a colossal amount of image-text pairs. A recent study, MaskCLIP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib60" title="" class="ltx_ref">60</a>]</cite>, leverages such a notion for zero-shot segmentation.
Existing distillation-based OVD approaches, however, have yet to fully exploit the compositional structures encapsulated in VLMs.
Beyond the distillation of individual region embedding, we propose to align the embedding of <em id="S1.p3.1.3" class="ltx_emph ltx_font_italic">BAg of RegiONs</em>, dubbed as <span id="S1.p3.1.4" class="ltx_text">BARON</span>. Explicitly learning the co-existence of visual concepts encourages the model to understand the scene beyond just recognizing isolated individual objects.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p"><span id="S1.p4.1.1" class="ltx_text">BARON</span> is easy to implement.
As shown in Fig. <a href="#S1.F1" title="Fig. 1 ‣ 1 Introduction ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>(c), <span id="S1.p4.1.2" class="ltx_text">BARON</span> first samples contextually interrelated regions to form a ‘bag’.
Since the region proposal network (RPN) is proven to cover potential novel objects <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib61" title="" class="ltx_ref">61</a>]</cite>, we explore a neighborhood sampling strategy that samples boxes around region proposals to help model the co-occurrence of a bag of visual concepts.
Second, <span id="S1.p4.1.3" class="ltx_text">BARON</span> obtains the bag-of-regions embeddings by projecting the regional features into the word embedding space and encoding these pseudo words with the text encoder (TE) of a frozen VLM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite>. By projecting region features to pseudo words, <span id="S1.p4.1.4" class="ltx_text">BARON</span> naturally allows TE to effectively represent the co-occurring semantic concepts and understand the whole scene.
To retain the spatial information of the region boxes, <span id="S1.p4.1.5" class="ltx_text">BARON</span> projects the box shape and box center position into embeddings and add to the pseudo words before feeding them to TE.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">To train <span id="S1.p5.1.1" class="ltx_text">BARON</span>, the bag-of-regions embeddings are learned to be aligned to the embeddings obtained by feeding the image crops that enclose the bag of regions to the teacher, <em id="S1.p5.1.2" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S1.p5.1.3" class="ltx_text"></span>, the image encoder (IE) of the VLM.
We adopt a contrastive learning approach <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>]</cite> to learn the pseudo words and the bag-of-regions embeddings.
Consistent with the VLMs’ pre-training (<em id="S1.p5.1.4" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S1.p5.1.5" class="ltx_text"></span>, CLIP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite>), the contrastive loss pulls close corresponding student (the detector) and teacher (IE) embedding pairs and pushes away non-corresponding pairs.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.2" class="ltx_p">We conduct extensive experiments on two challenging benchmarks, OV-COCO and OV-LVIS. The proposed method consistently outperforms existing state-of-the-art methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib55" title="" class="ltx_ref">55</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib61" title="" class="ltx_ref">61</a>]</cite> in different settings. Combined with Faster R-CNN, <span id="S1.p6.2.1" class="ltx_text">BARON</span> achieves a 34.0 (4.6 increase) box AP<math id="S1.p6.1.m1.1" class="ltx_Math" alttext="{}_{\text{50}}" display="inline"><semantics id="S1.p6.1.m1.1a"><msub id="S1.p6.1.m1.1.1" xref="S1.p6.1.m1.1.1.cmml"><mi id="S1.p6.1.m1.1.1a" xref="S1.p6.1.m1.1.1.cmml"></mi><mtext id="S1.p6.1.m1.1.1.1" xref="S1.p6.1.m1.1.1.1a.cmml">50</mtext></msub><annotation-xml encoding="MathML-Content" id="S1.p6.1.m1.1b"><apply id="S1.p6.1.m1.1.1.cmml" xref="S1.p6.1.m1.1.1"><ci id="S1.p6.1.m1.1.1.1a.cmml" xref="S1.p6.1.m1.1.1.1"><mtext mathsize="70%" id="S1.p6.1.m1.1.1.1.cmml" xref="S1.p6.1.m1.1.1.1">50</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.1.m1.1c">{}_{\text{50}}</annotation></semantics></math> of novel categories on OV-COCO and 22.6 (2.8 increase) mask mAP of novel categories on OV-LVIS. It is noteworthy that <span id="S1.p6.2.2" class="ltx_text">BARON</span> can also distill knowledge from caption supervision – it achieves 32.7 box AP<math id="S1.p6.2.m2.1" class="ltx_Math" alttext="{}_{\text{50}}" display="inline"><semantics id="S1.p6.2.m2.1a"><msub id="S1.p6.2.m2.1.1" xref="S1.p6.2.m2.1.1.cmml"><mi id="S1.p6.2.m2.1.1a" xref="S1.p6.2.m2.1.1.cmml"></mi><mtext id="S1.p6.2.m2.1.1.1" xref="S1.p6.2.m2.1.1.1a.cmml">50</mtext></msub><annotation-xml encoding="MathML-Content" id="S1.p6.2.m2.1b"><apply id="S1.p6.2.m2.1.1.cmml" xref="S1.p6.2.m2.1.1"><ci id="S1.p6.2.m2.1.1.1a.cmml" xref="S1.p6.2.m2.1.1.1"><mtext mathsize="70%" id="S1.p6.2.m2.1.1.1.cmml" xref="S1.p6.2.m2.1.1.1">50</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.2.m2.1c">{}_{\text{50}}</annotation></semantics></math> of novel categories on OV-COCO, outperforming previous approaches that use COCO caption  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib56" title="" class="ltx_ref">56</a>, <a href="#bib.bib59" title="" class="ltx_ref">59</a>, <a href="#bib.bib61" title="" class="ltx_ref">61</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<div id="S2.p1" class="ltx_para ltx_noindent">
<p id="S2.p1.1" class="ltx_p"><span id="S2.p1.1.1" class="ltx_text ltx_font_bold">Vison-Language Pretraining and Its Applications.</span> Vision-language pre-training aims to learn aligned image and text representations <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> on large-scale image-text pairs.
There are many studies <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib28" title="" class="ltx_ref">28</a>, <a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite> that pre-train vision-language models (VLMs) to improve the performance of downstream recognition and generation tasks.
There are also studies that learn aligned vision-language representation so that the images can be classified with arbitrary texts <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>.
Recent attempts <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib57" title="" class="ltx_ref">57</a>]</cite> push forward this direction by conducting contrastive learning in VLMs on billion-scale image-text pairs. These models show impressive zero-shot performance when they are transferred to image classification tasks.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">Inspired by the success of VLMs <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite>, some works try to exploit the alignment of vision-language representations for dense prediction tasks, <em id="S2.p2.1.1" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S2.p2.1.2" class="ltx_text"></span> segmentation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>, <a href="#bib.bib60" title="" class="ltx_ref">60</a>, <a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite> and detection <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib46" title="" class="ltx_ref">46</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>. In particular, MaskCLIP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib60" title="" class="ltx_ref">60</a>]</cite> shows that the image encoder in VLMs <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite> captures the stuff and things in a complex scene, where the pixel embeddings of each concept are naturally aligned with the corresponding text representations, although the original CLIP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite> model does not explicitly learn this target.
This implies that VLMs, after trained on a massive amount of image-text pairs, have implicitly learned the compositional structure of multiple semantic concepts, which naturally exist in image-text pairs.
This motivates us to explore the representation alignment between bag of regions and bag of words, different from previous works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> that focus on aligning the representation of individual pixels, regions, or words in VLMs.</p>
</div>
<div id="S2.p3" class="ltx_para ltx_noindent">
<p id="S2.p3.1" class="ltx_p"><span id="S2.p3.1.1" class="ltx_text ltx_font_bold">Open-Vocabulary Object Detection.</span>
Traditional object detectors <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib44" title="" class="ltx_ref">44</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib62" title="" class="ltx_ref">62</a>, <a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite> are limited to pre-defined object categories. To detect objects of unseen categories, zero-shot object detection (ZSD) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib58" title="" class="ltx_ref">58</a>, <a href="#bib.bib41" title="" class="ltx_ref">41</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> is proposed to align individual region embeddings with the text embeddings of categories through different strategies.
Recent attempts further explore open-vocabulary object detection (OVD) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib56" title="" class="ltx_ref">56</a>]</cite>, a more general form of ZSD that leverages weak supervisions like visual grounding data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>, image captions <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib56" title="" class="ltx_ref">56</a>, <a href="#bib.bib59" title="" class="ltx_ref">59</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>, and image labels <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib61" title="" class="ltx_ref">61</a>]</cite>.
Large-scale pre-trained VLMs <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite> are also exploited for their remarkable zero-shot recognition ability.
These VLMs can generate conditional queries <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib55" title="" class="ltx_ref">55</a>]</cite> or serve as a good teacher for knowledge distillation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>.
Specifically, distillation-based approaches <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> extract embeddings on pre-computed region proposals and <em id="S2.p3.1.2" class="ltx_emph ltx_font_italic">individually</em> align them to the corresponding features obtained from the VLMs.
To our best knowledge, <span id="S2.p3.1.3" class="ltx_text">BARON</span>  is the first attempt to lift the learning from <em id="S2.p3.1.4" class="ltx_emph ltx_font_italic">individual</em> regions to the <em id="S2.p3.1.5" class="ltx_emph ltx_font_italic">bag of regions</em> for OVD.</p>
</div>
<figure id="S2.F2" class="ltx_figure"><img src="/html/2302.13996/assets/figs/method.jpg" id="S2.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="685" height="285" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S2.F2.7.1.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S2.F2.8.2" class="ltx_text" style="font-size:90%;">Overview of <span id="S2.F2.8.2.1" class="ltx_text">BARON</span>. <span id="S2.F2.8.2.2" class="ltx_text ltx_font_bold">(a)</span> BARON is based on a Faster R-CNN whose classifier is replaced by a linear layer to map region features into pseudo words.
<span id="S2.F2.8.2.3" class="ltx_text ltx_font_bold">(b)</span> BARON takes region proposals and its surrounding boxes to form bags of regions.
<span id="S2.F2.8.2.4" class="ltx_text ltx_font_bold">(c)</span> BARON obtains student and teacher embeddings for the bag of regions from the pre-trained VLMs. <span id="S2.F2.8.2.5" class="ltx_text ltx_font_bold">(d)</span> BARON learns the alignment by the InfoNCE loss and maintains queues of embeddings to provide sufficient negative pairs for InfoNCE loss.</span></figcaption>
</figure>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Method</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">Our method makes the first attempt to align embedding of <em id="S3.p1.1.1" class="ltx_emph ltx_font_italic">bag of regions</em> beyond <em id="S3.p1.1.2" class="ltx_emph ltx_font_italic">individual</em> regions for OVD. We call our method BARON.
In this work, we instantiate the idea of BARON based on the commonly used Faster-RCNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite> and modify it for OVD (Sec. <a href="#S3.SS1" title="3.1 Preliminaries ‣ 3 Method ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1</span></a>).
We design a simple strategy to form the bag of regions from the region proposals (Sec. <a href="#S3.SS2" title="3.2 Forming Bag of Regions ‣ 3 Method ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>).
The bag of regions is treated as a bag of words to obtain the bag-of-regions embedding (Sec. <a href="#S3.SS3" title="3.3 Representing Bag of Regions ‣ 3 Method ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a>), which are then aligned with the corresponding features from VLMs (Sec. <a href="#S3.SS4" title="3.4 Aligning Bag of Regions ‣ 3 Method ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.4</span></a>).
BARON is general that it can align the bag-of-regions embeddings to not only image representations but also text representations (Sec. <a href="#S3.SS5" title="3.5 Caption Supervision ‣ 3 Method ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.5</span></a>).</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Preliminaries</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">In this paper, we instantiate the idea upon Faster R-CNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite> for simplicity.
The idea can also be used for other architectures <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> applicable for OVD.
To enable Faster R-CNN to detect objects from arbitrary vocabularies, we replace the original classifier with a linear layer that projects the region features into the word embedding space (dubbed as pseudo words) (Fig. <a href="#S2.F2" title="Fig. 2 ‣ 2 Related Work ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>(a)). In practice, the linear layer maps a region feature to multiple pseudo words to represent the rich semantic information of each object, similar to those category names consisting of multiple words (<em id="S3.SS1.p1.1.1" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S3.SS1.p1.1.2" class="ltx_text"></span>, horse-driven trolley).
Finally, we feed these pseudo words into the text encoder and then calculate the similarity with the category embeddings to obtain final classification results.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.6" class="ltx_p">As shown in Fig. <a href="#S2.F2" title="Fig. 2 ‣ 2 Related Work ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>(a), given <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">C</annotation></semantics></math> object categories, we obtain the embedding <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="f_{c}" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><msub id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml"><mi id="S3.SS1.p2.2.m2.1.1.2" xref="S3.SS1.p2.2.m2.1.1.2.cmml">f</mi><mi id="S3.SS1.p2.2.m2.1.1.3" xref="S3.SS1.p2.2.m2.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.2">𝑓</ci><ci id="S3.SS1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">f_{c}</annotation></semantics></math> for the <math id="S3.SS1.p2.3.m3.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS1.p2.3.m3.1a"><mi id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">c</annotation></semantics></math>-th category by feeding the category names with a prompt template, <em id="S3.SS1.p2.6.1" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S3.SS1.p2.6.2" class="ltx_text"></span>, <span id="S3.SS1.p2.6.3" class="ltx_text ltx_font_typewriter">‘a photo of {category} in the scene’</span> to the text encoder <math id="S3.SS1.p2.4.m4.1" class="ltx_Math" alttext="\mathcal{T}" display="inline"><semantics id="S3.SS1.p2.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><ci id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">\mathcal{T}</annotation></semantics></math>. For a region and its pseudo words <math id="S3.SS1.p2.5.m5.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S3.SS1.p2.5.m5.1a"><mi id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><ci id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">w</annotation></semantics></math>, the probability of the region to be classified as the <math id="S3.SS1.p2.6.m6.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS1.p2.6.m6.1a"><mi id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.1b"><ci id="S3.SS1.p2.6.m6.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.1c">c</annotation></semantics></math>-th category is</p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.7" class="ltx_Math" alttext="\vspace{-5pt}p_{c}=\frac{\exp(\tau\cdot\langle\mathcal{T}(w),f_{c}\rangle)}{\sum_{i=0}^{C-1}\exp(\tau\cdot\langle\mathcal{T}(w),f_{i}\rangle)}," display="block"><semantics id="S3.E1.m1.7a"><mrow id="S3.E1.m1.7.7.1" xref="S3.E1.m1.7.7.1.1.cmml"><mrow id="S3.E1.m1.7.7.1.1" xref="S3.E1.m1.7.7.1.1.cmml"><msub id="S3.E1.m1.7.7.1.1.2" xref="S3.E1.m1.7.7.1.1.2.cmml"><mi id="S3.E1.m1.7.7.1.1.2.2" xref="S3.E1.m1.7.7.1.1.2.2.cmml">p</mi><mi id="S3.E1.m1.7.7.1.1.2.3" xref="S3.E1.m1.7.7.1.1.2.3.cmml">c</mi></msub><mo id="S3.E1.m1.7.7.1.1.1" xref="S3.E1.m1.7.7.1.1.1.cmml">=</mo><mfrac id="S3.E1.m1.6.6" xref="S3.E1.m1.6.6.cmml"><mrow id="S3.E1.m1.3.3.3.3" xref="S3.E1.m1.3.3.3.4.cmml"><mi id="S3.E1.m1.2.2.2.2" xref="S3.E1.m1.2.2.2.2.cmml">exp</mi><mo id="S3.E1.m1.3.3.3.3a" xref="S3.E1.m1.3.3.3.4.cmml">⁡</mo><mrow id="S3.E1.m1.3.3.3.3.1" xref="S3.E1.m1.3.3.3.4.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.3.3.1.2" xref="S3.E1.m1.3.3.3.4.cmml">(</mo><mrow id="S3.E1.m1.3.3.3.3.1.1" xref="S3.E1.m1.3.3.3.3.1.1.cmml"><mi id="S3.E1.m1.3.3.3.3.1.1.4" xref="S3.E1.m1.3.3.3.3.1.1.4.cmml">τ</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E1.m1.3.3.3.3.1.1.3" xref="S3.E1.m1.3.3.3.3.1.1.3.cmml">⋅</mo><mrow id="S3.E1.m1.3.3.3.3.1.1.2.2" xref="S3.E1.m1.3.3.3.3.1.1.2.3.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.3.3.1.1.2.2.3" xref="S3.E1.m1.3.3.3.3.1.1.2.3.cmml">⟨</mo><mrow id="S3.E1.m1.3.3.3.3.1.1.1.1.1" xref="S3.E1.m1.3.3.3.3.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.3.3.3.3.1.1.1.1.1.2" xref="S3.E1.m1.3.3.3.3.1.1.1.1.1.2.cmml">𝒯</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.3.3.1.1.1.1.1.1" xref="S3.E1.m1.3.3.3.3.1.1.1.1.1.1.cmml">​</mo><mrow id="S3.E1.m1.3.3.3.3.1.1.1.1.1.3.2" xref="S3.E1.m1.3.3.3.3.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.3.3.1.1.1.1.1.3.2.1" xref="S3.E1.m1.3.3.3.3.1.1.1.1.1.cmml">(</mo><mi id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml">w</mi><mo stretchy="false" id="S3.E1.m1.3.3.3.3.1.1.1.1.1.3.2.2" xref="S3.E1.m1.3.3.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.3.3.3.3.1.1.2.2.4" xref="S3.E1.m1.3.3.3.3.1.1.2.3.cmml">,</mo><msub id="S3.E1.m1.3.3.3.3.1.1.2.2.2" xref="S3.E1.m1.3.3.3.3.1.1.2.2.2.cmml"><mi id="S3.E1.m1.3.3.3.3.1.1.2.2.2.2" xref="S3.E1.m1.3.3.3.3.1.1.2.2.2.2.cmml">f</mi><mi id="S3.E1.m1.3.3.3.3.1.1.2.2.2.3" xref="S3.E1.m1.3.3.3.3.1.1.2.2.2.3.cmml">c</mi></msub><mo stretchy="false" id="S3.E1.m1.3.3.3.3.1.1.2.2.5" xref="S3.E1.m1.3.3.3.3.1.1.2.3.cmml">⟩</mo></mrow></mrow><mo stretchy="false" id="S3.E1.m1.3.3.3.3.1.3" xref="S3.E1.m1.3.3.3.4.cmml">)</mo></mrow></mrow><mrow id="S3.E1.m1.6.6.6" xref="S3.E1.m1.6.6.6.cmml"><msubsup id="S3.E1.m1.6.6.6.4" xref="S3.E1.m1.6.6.6.4.cmml"><mo id="S3.E1.m1.6.6.6.4.2.2" xref="S3.E1.m1.6.6.6.4.2.2.cmml">∑</mo><mrow id="S3.E1.m1.6.6.6.4.2.3" xref="S3.E1.m1.6.6.6.4.2.3.cmml"><mi id="S3.E1.m1.6.6.6.4.2.3.2" xref="S3.E1.m1.6.6.6.4.2.3.2.cmml">i</mi><mo id="S3.E1.m1.6.6.6.4.2.3.1" xref="S3.E1.m1.6.6.6.4.2.3.1.cmml">=</mo><mn id="S3.E1.m1.6.6.6.4.2.3.3" xref="S3.E1.m1.6.6.6.4.2.3.3.cmml">0</mn></mrow><mrow id="S3.E1.m1.6.6.6.4.3" xref="S3.E1.m1.6.6.6.4.3.cmml"><mi id="S3.E1.m1.6.6.6.4.3.2" xref="S3.E1.m1.6.6.6.4.3.2.cmml">C</mi><mo id="S3.E1.m1.6.6.6.4.3.1" xref="S3.E1.m1.6.6.6.4.3.1.cmml">−</mo><mn id="S3.E1.m1.6.6.6.4.3.3" xref="S3.E1.m1.6.6.6.4.3.3.cmml">1</mn></mrow></msubsup><mrow id="S3.E1.m1.6.6.6.3.1" xref="S3.E1.m1.6.6.6.3.2.cmml"><mi id="S3.E1.m1.5.5.5.2" xref="S3.E1.m1.5.5.5.2.cmml">exp</mi><mo id="S3.E1.m1.6.6.6.3.1a" xref="S3.E1.m1.6.6.6.3.2.cmml">⁡</mo><mrow id="S3.E1.m1.6.6.6.3.1.1" xref="S3.E1.m1.6.6.6.3.2.cmml"><mo stretchy="false" id="S3.E1.m1.6.6.6.3.1.1.2" xref="S3.E1.m1.6.6.6.3.2.cmml">(</mo><mrow id="S3.E1.m1.6.6.6.3.1.1.1" xref="S3.E1.m1.6.6.6.3.1.1.1.cmml"><mi id="S3.E1.m1.6.6.6.3.1.1.1.4" xref="S3.E1.m1.6.6.6.3.1.1.1.4.cmml">τ</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E1.m1.6.6.6.3.1.1.1.3" xref="S3.E1.m1.6.6.6.3.1.1.1.3.cmml">⋅</mo><mrow id="S3.E1.m1.6.6.6.3.1.1.1.2.2" xref="S3.E1.m1.6.6.6.3.1.1.1.2.3.cmml"><mo stretchy="false" id="S3.E1.m1.6.6.6.3.1.1.1.2.2.3" xref="S3.E1.m1.6.6.6.3.1.1.1.2.3.cmml">⟨</mo><mrow id="S3.E1.m1.6.6.6.3.1.1.1.1.1.1" xref="S3.E1.m1.6.6.6.3.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.6.6.6.3.1.1.1.1.1.1.2" xref="S3.E1.m1.6.6.6.3.1.1.1.1.1.1.2.cmml">𝒯</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.6.6.6.3.1.1.1.1.1.1.1" xref="S3.E1.m1.6.6.6.3.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S3.E1.m1.6.6.6.3.1.1.1.1.1.1.3.2" xref="S3.E1.m1.6.6.6.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.6.6.6.3.1.1.1.1.1.1.3.2.1" xref="S3.E1.m1.6.6.6.3.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E1.m1.4.4.4.1" xref="S3.E1.m1.4.4.4.1.cmml">w</mi><mo stretchy="false" id="S3.E1.m1.6.6.6.3.1.1.1.1.1.1.3.2.2" xref="S3.E1.m1.6.6.6.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.6.6.6.3.1.1.1.2.2.4" xref="S3.E1.m1.6.6.6.3.1.1.1.2.3.cmml">,</mo><msub id="S3.E1.m1.6.6.6.3.1.1.1.2.2.2" xref="S3.E1.m1.6.6.6.3.1.1.1.2.2.2.cmml"><mi id="S3.E1.m1.6.6.6.3.1.1.1.2.2.2.2" xref="S3.E1.m1.6.6.6.3.1.1.1.2.2.2.2.cmml">f</mi><mi id="S3.E1.m1.6.6.6.3.1.1.1.2.2.2.3" xref="S3.E1.m1.6.6.6.3.1.1.1.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E1.m1.6.6.6.3.1.1.1.2.2.5" xref="S3.E1.m1.6.6.6.3.1.1.1.2.3.cmml">⟩</mo></mrow></mrow><mo stretchy="false" id="S3.E1.m1.6.6.6.3.1.1.3" xref="S3.E1.m1.6.6.6.3.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><mo id="S3.E1.m1.7.7.1.2" xref="S3.E1.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.7b"><apply id="S3.E1.m1.7.7.1.1.cmml" xref="S3.E1.m1.7.7.1"><eq id="S3.E1.m1.7.7.1.1.1.cmml" xref="S3.E1.m1.7.7.1.1.1"></eq><apply id="S3.E1.m1.7.7.1.1.2.cmml" xref="S3.E1.m1.7.7.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.7.7.1.1.2.1.cmml" xref="S3.E1.m1.7.7.1.1.2">subscript</csymbol><ci id="S3.E1.m1.7.7.1.1.2.2.cmml" xref="S3.E1.m1.7.7.1.1.2.2">𝑝</ci><ci id="S3.E1.m1.7.7.1.1.2.3.cmml" xref="S3.E1.m1.7.7.1.1.2.3">𝑐</ci></apply><apply id="S3.E1.m1.6.6.cmml" xref="S3.E1.m1.6.6"><divide id="S3.E1.m1.6.6.7.cmml" xref="S3.E1.m1.6.6"></divide><apply id="S3.E1.m1.3.3.3.4.cmml" xref="S3.E1.m1.3.3.3.3"><exp id="S3.E1.m1.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2"></exp><apply id="S3.E1.m1.3.3.3.3.1.1.cmml" xref="S3.E1.m1.3.3.3.3.1.1"><ci id="S3.E1.m1.3.3.3.3.1.1.3.cmml" xref="S3.E1.m1.3.3.3.3.1.1.3">⋅</ci><ci id="S3.E1.m1.3.3.3.3.1.1.4.cmml" xref="S3.E1.m1.3.3.3.3.1.1.4">𝜏</ci><list id="S3.E1.m1.3.3.3.3.1.1.2.3.cmml" xref="S3.E1.m1.3.3.3.3.1.1.2.2"><apply id="S3.E1.m1.3.3.3.3.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.3.3.1.1.1.1.1"><times id="S3.E1.m1.3.3.3.3.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.3.3.1.1.1.1.1.1"></times><ci id="S3.E1.m1.3.3.3.3.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.3.3.1.1.1.1.1.2">𝒯</ci><ci id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1">𝑤</ci></apply><apply id="S3.E1.m1.3.3.3.3.1.1.2.2.2.cmml" xref="S3.E1.m1.3.3.3.3.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.3.3.1.1.2.2.2.1.cmml" xref="S3.E1.m1.3.3.3.3.1.1.2.2.2">subscript</csymbol><ci id="S3.E1.m1.3.3.3.3.1.1.2.2.2.2.cmml" xref="S3.E1.m1.3.3.3.3.1.1.2.2.2.2">𝑓</ci><ci id="S3.E1.m1.3.3.3.3.1.1.2.2.2.3.cmml" xref="S3.E1.m1.3.3.3.3.1.1.2.2.2.3">𝑐</ci></apply></list></apply></apply><apply id="S3.E1.m1.6.6.6.cmml" xref="S3.E1.m1.6.6.6"><apply id="S3.E1.m1.6.6.6.4.cmml" xref="S3.E1.m1.6.6.6.4"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.6.4.1.cmml" xref="S3.E1.m1.6.6.6.4">superscript</csymbol><apply id="S3.E1.m1.6.6.6.4.2.cmml" xref="S3.E1.m1.6.6.6.4"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.6.4.2.1.cmml" xref="S3.E1.m1.6.6.6.4">subscript</csymbol><sum id="S3.E1.m1.6.6.6.4.2.2.cmml" xref="S3.E1.m1.6.6.6.4.2.2"></sum><apply id="S3.E1.m1.6.6.6.4.2.3.cmml" xref="S3.E1.m1.6.6.6.4.2.3"><eq id="S3.E1.m1.6.6.6.4.2.3.1.cmml" xref="S3.E1.m1.6.6.6.4.2.3.1"></eq><ci id="S3.E1.m1.6.6.6.4.2.3.2.cmml" xref="S3.E1.m1.6.6.6.4.2.3.2">𝑖</ci><cn type="integer" id="S3.E1.m1.6.6.6.4.2.3.3.cmml" xref="S3.E1.m1.6.6.6.4.2.3.3">0</cn></apply></apply><apply id="S3.E1.m1.6.6.6.4.3.cmml" xref="S3.E1.m1.6.6.6.4.3"><minus id="S3.E1.m1.6.6.6.4.3.1.cmml" xref="S3.E1.m1.6.6.6.4.3.1"></minus><ci id="S3.E1.m1.6.6.6.4.3.2.cmml" xref="S3.E1.m1.6.6.6.4.3.2">𝐶</ci><cn type="integer" id="S3.E1.m1.6.6.6.4.3.3.cmml" xref="S3.E1.m1.6.6.6.4.3.3">1</cn></apply></apply><apply id="S3.E1.m1.6.6.6.3.2.cmml" xref="S3.E1.m1.6.6.6.3.1"><exp id="S3.E1.m1.5.5.5.2.cmml" xref="S3.E1.m1.5.5.5.2"></exp><apply id="S3.E1.m1.6.6.6.3.1.1.1.cmml" xref="S3.E1.m1.6.6.6.3.1.1.1"><ci id="S3.E1.m1.6.6.6.3.1.1.1.3.cmml" xref="S3.E1.m1.6.6.6.3.1.1.1.3">⋅</ci><ci id="S3.E1.m1.6.6.6.3.1.1.1.4.cmml" xref="S3.E1.m1.6.6.6.3.1.1.1.4">𝜏</ci><list id="S3.E1.m1.6.6.6.3.1.1.1.2.3.cmml" xref="S3.E1.m1.6.6.6.3.1.1.1.2.2"><apply id="S3.E1.m1.6.6.6.3.1.1.1.1.1.1.cmml" xref="S3.E1.m1.6.6.6.3.1.1.1.1.1.1"><times id="S3.E1.m1.6.6.6.3.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.6.6.6.3.1.1.1.1.1.1.1"></times><ci id="S3.E1.m1.6.6.6.3.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.6.6.6.3.1.1.1.1.1.1.2">𝒯</ci><ci id="S3.E1.m1.4.4.4.1.cmml" xref="S3.E1.m1.4.4.4.1">𝑤</ci></apply><apply id="S3.E1.m1.6.6.6.3.1.1.1.2.2.2.cmml" xref="S3.E1.m1.6.6.6.3.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.6.3.1.1.1.2.2.2.1.cmml" xref="S3.E1.m1.6.6.6.3.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E1.m1.6.6.6.3.1.1.1.2.2.2.2.cmml" xref="S3.E1.m1.6.6.6.3.1.1.1.2.2.2.2">𝑓</ci><ci id="S3.E1.m1.6.6.6.3.1.1.1.2.2.2.3.cmml" xref="S3.E1.m1.6.6.6.3.1.1.1.2.2.2.3">𝑖</ci></apply></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.7c">\vspace{-5pt}p_{c}=\frac{\exp(\tau\cdot\langle\mathcal{T}(w),f_{c}\rangle)}{\sum_{i=0}^{C-1}\exp(\tau\cdot\langle\mathcal{T}(w),f_{i}\rangle)},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS1.p4" class="ltx_para ltx_noindent">
<p id="S3.SS1.p4.2" class="ltx_p">where <math id="S3.SS1.p4.1.m1.1" class="ltx_math_unparsed" alttext="\langle,\rangle" display="inline"><semantics id="S3.SS1.p4.1.m1.1a"><mrow id="S3.SS1.p4.1.m1.1b"><mo stretchy="false" id="S3.SS1.p4.1.m1.1.1">⟨</mo><mo id="S3.SS1.p4.1.m1.1.2">,</mo><mo stretchy="false" id="S3.SS1.p4.1.m1.1.3">⟩</mo></mrow><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">\langle,\rangle</annotation></semantics></math> denotes the cosine similarity and <math id="S3.SS1.p4.2.m2.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.SS1.p4.2.m2.1a"><mi id="S3.SS1.p4.2.m2.1.1" xref="S3.SS1.p4.2.m2.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.2.m2.1b"><ci id="S3.SS1.p4.2.m2.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.2.m2.1c">\tau</annotation></semantics></math> is the temperature to re-scale the value.</p>
</div>
<div id="S3.SS1.p5" class="ltx_para">
<p id="S3.SS1.p5.1" class="ltx_p">During training, only the boxes of base categories are annotated and the learning on base categories follows the convention of Faster R-CNN with regression and classification losses <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite>.
To learn to detect novel categories that do not have box annotations in training, previous distillation-based approaches <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> <em id="S3.SS1.p5.1.1" class="ltx_emph ltx_font_italic">individually</em> align region embeddings (<em id="S3.SS1.p5.1.2" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S3.SS1.p5.1.3" class="ltx_text"></span>, <math id="S3.SS1.p5.1.m1.1" class="ltx_Math" alttext="\mathcal{T}(w)" display="inline"><semantics id="S3.SS1.p5.1.m1.1a"><mrow id="S3.SS1.p5.1.m1.1.2" xref="S3.SS1.p5.1.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p5.1.m1.1.2.2" xref="S3.SS1.p5.1.m1.1.2.2.cmml">𝒯</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p5.1.m1.1.2.1" xref="S3.SS1.p5.1.m1.1.2.1.cmml">​</mo><mrow id="S3.SS1.p5.1.m1.1.2.3.2" xref="S3.SS1.p5.1.m1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p5.1.m1.1.2.3.2.1" xref="S3.SS1.p5.1.m1.1.2.cmml">(</mo><mi id="S3.SS1.p5.1.m1.1.1" xref="S3.SS1.p5.1.m1.1.1.cmml">w</mi><mo stretchy="false" id="S3.SS1.p5.1.m1.1.2.3.2.2" xref="S3.SS1.p5.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.1.m1.1b"><apply id="S3.SS1.p5.1.m1.1.2.cmml" xref="S3.SS1.p5.1.m1.1.2"><times id="S3.SS1.p5.1.m1.1.2.1.cmml" xref="S3.SS1.p5.1.m1.1.2.1"></times><ci id="S3.SS1.p5.1.m1.1.2.2.cmml" xref="S3.SS1.p5.1.m1.1.2.2">𝒯</ci><ci id="S3.SS1.p5.1.m1.1.1.cmml" xref="S3.SS1.p5.1.m1.1.1">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.1.m1.1c">\mathcal{T}(w)</annotation></semantics></math>) to the corresponding features obtained from the VLMs. To further exploit the power of VLMs that capture the compositional structure of multiple concepts, we lift the learning from <em id="S3.SS1.p5.1.4" class="ltx_emph ltx_font_italic">individual</em> regions to the <em id="S3.SS1.p5.1.5" class="ltx_emph ltx_font_italic">bag of regions</em>.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Forming Bag of Regions</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">Our framework is inspired by existing OVD approaches that distill knowledge from the image encoder of VLMs.
Specifically, we choose the image encoder of the VLMs as the teacher and expect it to teach the detector. But different from existing approaches, we wish the detector to learn the co-existence of multiple concepts, especially the potential existence of novel objects.
To effectively and efficiently learn such knowledge from the VLMs, we consider the following two properties of regions inside a bag:
1) the regions need to be close to each other because an image crop enclosing distanced regions will include a larger proportion of redundant image contents, distracting the image encoder from representing the bag of regions;
2) the regions should have similar sizes, as an imbalanced size ratio among regions will make the image representations dominated by the largest region.</p>
</div>
<figure id="S3.F3" class="ltx_figure"><img src="/html/2302.13996/assets/figs/samples.jpg" id="S3.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="568" height="313" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F3.2.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S3.F3.3.2" class="ltx_text" style="font-size:90%;">Visualization of sampled bags of regions. Green boxes denote the region proposals and blue boxes are sampled neighbors (candidates). Areas exceeding image boundary are cropped out.</span></figcaption>
</figure>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.1" class="ltx_p">According to these two requirements, we adopt a simple neighborhood sampling strategy to form the bag of regions based on the region proposals predicted by the region proposal network (RPN) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite>.
Concretely, for each region proposal, we take its surrounding eight boxes (neighbors) as the candidates, which are spatially close to each other as shown in Fig. <a href="#S2.F2" title="Fig. 2 ‣ 2 Related Work ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>(b).
We also allow these candidates to overlap slightly at a specific Intersection over Foreground (IOF) to improve the continuity of regional representations.
To balance the sizes of regions inside the bag, we simply let the eight candidate boxes have the same shape as the region proposal.
In practice, candidates that exceed the boundary of the image over a certain proportion, <em id="S3.SS2.p2.1.1" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S3.SS2.p2.1.2" class="ltx_text"></span>, more than <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="\frac{2}{3}" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><mfrac id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mn id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">2</mn><mn id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml">3</mn></mfrac><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><divide id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"></divide><cn type="integer" id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">2</cn><cn type="integer" id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">\frac{2}{3}</annotation></semantics></math> of their area out of the image, will be discarded.
The remaining candidates are independently sampled, and the sampled boxes, together with the region proposal, form a bag of regions.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.8" class="ltx_p">We sample <math id="S3.SS2.p3.1.m1.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S3.SS2.p3.1.m1.1a"><mi id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><ci id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">G</annotation></semantics></math> groups for each region proposal to obtain rich bag-of-regions representations.
At each time of sampling, the probability of a candidate being sampled is adjusted to prevent the box enclosing the grouped regions from having an extreme aspect ratio. Assuming a base probability <math id="S3.SS2.p3.2.m2.1" class="ltx_Math" alttext="p_{b}" display="inline"><semantics id="S3.SS2.p3.2.m2.1a"><msub id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml"><mi id="S3.SS2.p3.2.m2.1.1.2" xref="S3.SS2.p3.2.m2.1.1.2.cmml">p</mi><mi id="S3.SS2.p3.2.m2.1.1.3" xref="S3.SS2.p3.2.m2.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><apply id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.1.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p3.2.m2.1.1.2.cmml" xref="S3.SS2.p3.2.m2.1.1.2">𝑝</ci><ci id="S3.SS2.p3.2.m2.1.1.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">p_{b}</annotation></semantics></math> and a scaling factor <math id="S3.SS2.p3.3.m3.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS2.p3.3.m3.1a"><mi id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b"><ci id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">\alpha</annotation></semantics></math>, the probability to sample the left and right candidates is <math id="S3.SS2.p3.4.m4.3" class="ltx_Math" alttext="p=p_{b}\times min\{(\frac{H}{W})^{\alpha},1\}" display="inline"><semantics id="S3.SS2.p3.4.m4.3a"><mrow id="S3.SS2.p3.4.m4.3.3" xref="S3.SS2.p3.4.m4.3.3.cmml"><mi id="S3.SS2.p3.4.m4.3.3.3" xref="S3.SS2.p3.4.m4.3.3.3.cmml">p</mi><mo id="S3.SS2.p3.4.m4.3.3.2" xref="S3.SS2.p3.4.m4.3.3.2.cmml">=</mo><mrow id="S3.SS2.p3.4.m4.3.3.1" xref="S3.SS2.p3.4.m4.3.3.1.cmml"><mrow id="S3.SS2.p3.4.m4.3.3.1.3" xref="S3.SS2.p3.4.m4.3.3.1.3.cmml"><msub id="S3.SS2.p3.4.m4.3.3.1.3.2" xref="S3.SS2.p3.4.m4.3.3.1.3.2.cmml"><mi id="S3.SS2.p3.4.m4.3.3.1.3.2.2" xref="S3.SS2.p3.4.m4.3.3.1.3.2.2.cmml">p</mi><mi id="S3.SS2.p3.4.m4.3.3.1.3.2.3" xref="S3.SS2.p3.4.m4.3.3.1.3.2.3.cmml">b</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p3.4.m4.3.3.1.3.1" xref="S3.SS2.p3.4.m4.3.3.1.3.1.cmml">×</mo><mi id="S3.SS2.p3.4.m4.3.3.1.3.3" xref="S3.SS2.p3.4.m4.3.3.1.3.3.cmml">m</mi></mrow><mo lspace="0em" rspace="0em" id="S3.SS2.p3.4.m4.3.3.1.2" xref="S3.SS2.p3.4.m4.3.3.1.2.cmml">​</mo><mi id="S3.SS2.p3.4.m4.3.3.1.4" xref="S3.SS2.p3.4.m4.3.3.1.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.4.m4.3.3.1.2a" xref="S3.SS2.p3.4.m4.3.3.1.2.cmml">​</mo><mi id="S3.SS2.p3.4.m4.3.3.1.5" xref="S3.SS2.p3.4.m4.3.3.1.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.4.m4.3.3.1.2b" xref="S3.SS2.p3.4.m4.3.3.1.2.cmml">​</mo><mrow id="S3.SS2.p3.4.m4.3.3.1.1.1" xref="S3.SS2.p3.4.m4.3.3.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p3.4.m4.3.3.1.1.1.2" xref="S3.SS2.p3.4.m4.3.3.1.1.2.cmml">{</mo><msup id="S3.SS2.p3.4.m4.3.3.1.1.1.1" xref="S3.SS2.p3.4.m4.3.3.1.1.1.1.cmml"><mrow id="S3.SS2.p3.4.m4.3.3.1.1.1.1.2.2" xref="S3.SS2.p3.4.m4.1.1.cmml"><mo stretchy="false" id="S3.SS2.p3.4.m4.3.3.1.1.1.1.2.2.1" xref="S3.SS2.p3.4.m4.1.1.cmml">(</mo><mfrac id="S3.SS2.p3.4.m4.1.1" xref="S3.SS2.p3.4.m4.1.1.cmml"><mi id="S3.SS2.p3.4.m4.1.1.2" xref="S3.SS2.p3.4.m4.1.1.2.cmml">H</mi><mi id="S3.SS2.p3.4.m4.1.1.3" xref="S3.SS2.p3.4.m4.1.1.3.cmml">W</mi></mfrac><mo stretchy="false" id="S3.SS2.p3.4.m4.3.3.1.1.1.1.2.2.2" xref="S3.SS2.p3.4.m4.1.1.cmml">)</mo></mrow><mi id="S3.SS2.p3.4.m4.3.3.1.1.1.1.3" xref="S3.SS2.p3.4.m4.3.3.1.1.1.1.3.cmml">α</mi></msup><mo id="S3.SS2.p3.4.m4.3.3.1.1.1.3" xref="S3.SS2.p3.4.m4.3.3.1.1.2.cmml">,</mo><mn id="S3.SS2.p3.4.m4.2.2" xref="S3.SS2.p3.4.m4.2.2.cmml">1</mn><mo stretchy="false" id="S3.SS2.p3.4.m4.3.3.1.1.1.4" xref="S3.SS2.p3.4.m4.3.3.1.1.2.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.3b"><apply id="S3.SS2.p3.4.m4.3.3.cmml" xref="S3.SS2.p3.4.m4.3.3"><eq id="S3.SS2.p3.4.m4.3.3.2.cmml" xref="S3.SS2.p3.4.m4.3.3.2"></eq><ci id="S3.SS2.p3.4.m4.3.3.3.cmml" xref="S3.SS2.p3.4.m4.3.3.3">𝑝</ci><apply id="S3.SS2.p3.4.m4.3.3.1.cmml" xref="S3.SS2.p3.4.m4.3.3.1"><times id="S3.SS2.p3.4.m4.3.3.1.2.cmml" xref="S3.SS2.p3.4.m4.3.3.1.2"></times><apply id="S3.SS2.p3.4.m4.3.3.1.3.cmml" xref="S3.SS2.p3.4.m4.3.3.1.3"><times id="S3.SS2.p3.4.m4.3.3.1.3.1.cmml" xref="S3.SS2.p3.4.m4.3.3.1.3.1"></times><apply id="S3.SS2.p3.4.m4.3.3.1.3.2.cmml" xref="S3.SS2.p3.4.m4.3.3.1.3.2"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.3.3.1.3.2.1.cmml" xref="S3.SS2.p3.4.m4.3.3.1.3.2">subscript</csymbol><ci id="S3.SS2.p3.4.m4.3.3.1.3.2.2.cmml" xref="S3.SS2.p3.4.m4.3.3.1.3.2.2">𝑝</ci><ci id="S3.SS2.p3.4.m4.3.3.1.3.2.3.cmml" xref="S3.SS2.p3.4.m4.3.3.1.3.2.3">𝑏</ci></apply><ci id="S3.SS2.p3.4.m4.3.3.1.3.3.cmml" xref="S3.SS2.p3.4.m4.3.3.1.3.3">𝑚</ci></apply><ci id="S3.SS2.p3.4.m4.3.3.1.4.cmml" xref="S3.SS2.p3.4.m4.3.3.1.4">𝑖</ci><ci id="S3.SS2.p3.4.m4.3.3.1.5.cmml" xref="S3.SS2.p3.4.m4.3.3.1.5">𝑛</ci><set id="S3.SS2.p3.4.m4.3.3.1.1.2.cmml" xref="S3.SS2.p3.4.m4.3.3.1.1.1"><apply id="S3.SS2.p3.4.m4.3.3.1.1.1.1.cmml" xref="S3.SS2.p3.4.m4.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.3.3.1.1.1.1.1.cmml" xref="S3.SS2.p3.4.m4.3.3.1.1.1.1">superscript</csymbol><apply id="S3.SS2.p3.4.m4.1.1.cmml" xref="S3.SS2.p3.4.m4.3.3.1.1.1.1.2.2"><divide id="S3.SS2.p3.4.m4.1.1.1.cmml" xref="S3.SS2.p3.4.m4.3.3.1.1.1.1.2.2"></divide><ci id="S3.SS2.p3.4.m4.1.1.2.cmml" xref="S3.SS2.p3.4.m4.1.1.2">𝐻</ci><ci id="S3.SS2.p3.4.m4.1.1.3.cmml" xref="S3.SS2.p3.4.m4.1.1.3">𝑊</ci></apply><ci id="S3.SS2.p3.4.m4.3.3.1.1.1.1.3.cmml" xref="S3.SS2.p3.4.m4.3.3.1.1.1.1.3">𝛼</ci></apply><cn type="integer" id="S3.SS2.p3.4.m4.2.2.cmml" xref="S3.SS2.p3.4.m4.2.2">1</cn></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.3c">p=p_{b}\times min\{(\frac{H}{W})^{\alpha},1\}</annotation></semantics></math> and the probability to sample upper and bottom candidates is <math id="S3.SS2.p3.5.m5.3" class="ltx_Math" alttext="p=p_{b}\times min\{(\frac{W}{H})^{\alpha},1\}" display="inline"><semantics id="S3.SS2.p3.5.m5.3a"><mrow id="S3.SS2.p3.5.m5.3.3" xref="S3.SS2.p3.5.m5.3.3.cmml"><mi id="S3.SS2.p3.5.m5.3.3.3" xref="S3.SS2.p3.5.m5.3.3.3.cmml">p</mi><mo id="S3.SS2.p3.5.m5.3.3.2" xref="S3.SS2.p3.5.m5.3.3.2.cmml">=</mo><mrow id="S3.SS2.p3.5.m5.3.3.1" xref="S3.SS2.p3.5.m5.3.3.1.cmml"><mrow id="S3.SS2.p3.5.m5.3.3.1.3" xref="S3.SS2.p3.5.m5.3.3.1.3.cmml"><msub id="S3.SS2.p3.5.m5.3.3.1.3.2" xref="S3.SS2.p3.5.m5.3.3.1.3.2.cmml"><mi id="S3.SS2.p3.5.m5.3.3.1.3.2.2" xref="S3.SS2.p3.5.m5.3.3.1.3.2.2.cmml">p</mi><mi id="S3.SS2.p3.5.m5.3.3.1.3.2.3" xref="S3.SS2.p3.5.m5.3.3.1.3.2.3.cmml">b</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p3.5.m5.3.3.1.3.1" xref="S3.SS2.p3.5.m5.3.3.1.3.1.cmml">×</mo><mi id="S3.SS2.p3.5.m5.3.3.1.3.3" xref="S3.SS2.p3.5.m5.3.3.1.3.3.cmml">m</mi></mrow><mo lspace="0em" rspace="0em" id="S3.SS2.p3.5.m5.3.3.1.2" xref="S3.SS2.p3.5.m5.3.3.1.2.cmml">​</mo><mi id="S3.SS2.p3.5.m5.3.3.1.4" xref="S3.SS2.p3.5.m5.3.3.1.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.5.m5.3.3.1.2a" xref="S3.SS2.p3.5.m5.3.3.1.2.cmml">​</mo><mi id="S3.SS2.p3.5.m5.3.3.1.5" xref="S3.SS2.p3.5.m5.3.3.1.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.5.m5.3.3.1.2b" xref="S3.SS2.p3.5.m5.3.3.1.2.cmml">​</mo><mrow id="S3.SS2.p3.5.m5.3.3.1.1.1" xref="S3.SS2.p3.5.m5.3.3.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p3.5.m5.3.3.1.1.1.2" xref="S3.SS2.p3.5.m5.3.3.1.1.2.cmml">{</mo><msup id="S3.SS2.p3.5.m5.3.3.1.1.1.1" xref="S3.SS2.p3.5.m5.3.3.1.1.1.1.cmml"><mrow id="S3.SS2.p3.5.m5.3.3.1.1.1.1.2.2" xref="S3.SS2.p3.5.m5.1.1.cmml"><mo stretchy="false" id="S3.SS2.p3.5.m5.3.3.1.1.1.1.2.2.1" xref="S3.SS2.p3.5.m5.1.1.cmml">(</mo><mfrac id="S3.SS2.p3.5.m5.1.1" xref="S3.SS2.p3.5.m5.1.1.cmml"><mi id="S3.SS2.p3.5.m5.1.1.2" xref="S3.SS2.p3.5.m5.1.1.2.cmml">W</mi><mi id="S3.SS2.p3.5.m5.1.1.3" xref="S3.SS2.p3.5.m5.1.1.3.cmml">H</mi></mfrac><mo stretchy="false" id="S3.SS2.p3.5.m5.3.3.1.1.1.1.2.2.2" xref="S3.SS2.p3.5.m5.1.1.cmml">)</mo></mrow><mi id="S3.SS2.p3.5.m5.3.3.1.1.1.1.3" xref="S3.SS2.p3.5.m5.3.3.1.1.1.1.3.cmml">α</mi></msup><mo id="S3.SS2.p3.5.m5.3.3.1.1.1.3" xref="S3.SS2.p3.5.m5.3.3.1.1.2.cmml">,</mo><mn id="S3.SS2.p3.5.m5.2.2" xref="S3.SS2.p3.5.m5.2.2.cmml">1</mn><mo stretchy="false" id="S3.SS2.p3.5.m5.3.3.1.1.1.4" xref="S3.SS2.p3.5.m5.3.3.1.1.2.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m5.3b"><apply id="S3.SS2.p3.5.m5.3.3.cmml" xref="S3.SS2.p3.5.m5.3.3"><eq id="S3.SS2.p3.5.m5.3.3.2.cmml" xref="S3.SS2.p3.5.m5.3.3.2"></eq><ci id="S3.SS2.p3.5.m5.3.3.3.cmml" xref="S3.SS2.p3.5.m5.3.3.3">𝑝</ci><apply id="S3.SS2.p3.5.m5.3.3.1.cmml" xref="S3.SS2.p3.5.m5.3.3.1"><times id="S3.SS2.p3.5.m5.3.3.1.2.cmml" xref="S3.SS2.p3.5.m5.3.3.1.2"></times><apply id="S3.SS2.p3.5.m5.3.3.1.3.cmml" xref="S3.SS2.p3.5.m5.3.3.1.3"><times id="S3.SS2.p3.5.m5.3.3.1.3.1.cmml" xref="S3.SS2.p3.5.m5.3.3.1.3.1"></times><apply id="S3.SS2.p3.5.m5.3.3.1.3.2.cmml" xref="S3.SS2.p3.5.m5.3.3.1.3.2"><csymbol cd="ambiguous" id="S3.SS2.p3.5.m5.3.3.1.3.2.1.cmml" xref="S3.SS2.p3.5.m5.3.3.1.3.2">subscript</csymbol><ci id="S3.SS2.p3.5.m5.3.3.1.3.2.2.cmml" xref="S3.SS2.p3.5.m5.3.3.1.3.2.2">𝑝</ci><ci id="S3.SS2.p3.5.m5.3.3.1.3.2.3.cmml" xref="S3.SS2.p3.5.m5.3.3.1.3.2.3">𝑏</ci></apply><ci id="S3.SS2.p3.5.m5.3.3.1.3.3.cmml" xref="S3.SS2.p3.5.m5.3.3.1.3.3">𝑚</ci></apply><ci id="S3.SS2.p3.5.m5.3.3.1.4.cmml" xref="S3.SS2.p3.5.m5.3.3.1.4">𝑖</ci><ci id="S3.SS2.p3.5.m5.3.3.1.5.cmml" xref="S3.SS2.p3.5.m5.3.3.1.5">𝑛</ci><set id="S3.SS2.p3.5.m5.3.3.1.1.2.cmml" xref="S3.SS2.p3.5.m5.3.3.1.1.1"><apply id="S3.SS2.p3.5.m5.3.3.1.1.1.1.cmml" xref="S3.SS2.p3.5.m5.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.5.m5.3.3.1.1.1.1.1.cmml" xref="S3.SS2.p3.5.m5.3.3.1.1.1.1">superscript</csymbol><apply id="S3.SS2.p3.5.m5.1.1.cmml" xref="S3.SS2.p3.5.m5.3.3.1.1.1.1.2.2"><divide id="S3.SS2.p3.5.m5.1.1.1.cmml" xref="S3.SS2.p3.5.m5.3.3.1.1.1.1.2.2"></divide><ci id="S3.SS2.p3.5.m5.1.1.2.cmml" xref="S3.SS2.p3.5.m5.1.1.2">𝑊</ci><ci id="S3.SS2.p3.5.m5.1.1.3.cmml" xref="S3.SS2.p3.5.m5.1.1.3">𝐻</ci></apply><ci id="S3.SS2.p3.5.m5.3.3.1.1.1.1.3.cmml" xref="S3.SS2.p3.5.m5.3.3.1.1.1.1.3">𝛼</ci></apply><cn type="integer" id="S3.SS2.p3.5.m5.2.2.cmml" xref="S3.SS2.p3.5.m5.2.2">1</cn></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m5.3c">p=p_{b}\times min\{(\frac{W}{H})^{\alpha},1\}</annotation></semantics></math>, where <math id="S3.SS2.p3.6.m6.1" class="ltx_Math" alttext="H" display="inline"><semantics id="S3.SS2.p3.6.m6.1a"><mi id="S3.SS2.p3.6.m6.1.1" xref="S3.SS2.p3.6.m6.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.6.m6.1b"><ci id="S3.SS2.p3.6.m6.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.6.m6.1c">H</annotation></semantics></math> and <math id="S3.SS2.p3.7.m7.1" class="ltx_Math" alttext="W" display="inline"><semantics id="S3.SS2.p3.7.m7.1a"><mi id="S3.SS2.p3.7.m7.1.1" xref="S3.SS2.p3.7.m7.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.7.m7.1b"><ci id="S3.SS2.p3.7.m7.1.1.cmml" xref="S3.SS2.p3.7.m7.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.7.m7.1c">W</annotation></semantics></math> are the height and width of the region proposal box. <math id="S3.SS2.p3.8.m8.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS2.p3.8.m8.1a"><mi id="S3.SS2.p3.8.m8.1.1" xref="S3.SS2.p3.8.m8.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.8.m8.1b"><ci id="S3.SS2.p3.8.m8.1.1.cmml" xref="S3.SS2.p3.8.m8.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.8.m8.1c">\alpha</annotation></semantics></math> is 3.0 by default.</p>
</div>
<div id="S3.SS2.p4" class="ltx_para">
<p id="S3.SS2.p4.1" class="ltx_p">We show some sampling results of bags of regions on COCO dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> in Fig <a href="#S3.F3" title="Fig. 3 ‣ 3.2 Forming Bag of Regions ‣ 3 Method ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. The grouped regions in a bag can cover objects (in blue) co-occurring with the object in the region proposal (in green). The context of the co-occurring objects leads BARON to get a scene-level understanding of the regions, <em id="S3.SS2.p4.1.1" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S3.SS2.p4.1.2" class="ltx_text"></span> ‘a horse pulling the carriage’ and ‘a man surfing on the wave’. Novel object categories occasionally appear in the bag of regions, <em id="S3.SS2.p4.1.3" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S3.SS2.p4.1.4" class="ltx_text"></span> the ‘carriage’ in the top left image of Fig <a href="#S3.F3" title="Fig. 3 ‣ 3.2 Forming Bag of Regions ‣ 3 Method ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> and the ‘cup’ in the top right. In the following Sec <a href="#S3.SS3" title="3.3 Representing Bag of Regions ‣ 3 Method ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a> and Sec <a href="#S3.SS4" title="3.4 Aligning Bag of Regions ‣ 3 Method ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.4</span></a>, these potential novel object categories would be learned in the context of the bag of regions.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Representing Bag of Regions</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.6" class="ltx_p">With the sampled bags of regions, BARON obtains the bag-of-regions embeddings from both the student (<em id="S3.SS3.p1.6.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S3.SS3.p1.6.2" class="ltx_text"></span>, the open-vocabulary object detector) and the teacher (<em id="S3.SS3.p1.6.3" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S3.SS3.p1.6.4" class="ltx_text"></span>, VLMs).
We denote the <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><mi id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">j</annotation></semantics></math>-th region in the <math id="S3.SS3.p1.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS3.p1.2.m2.1a"><mi id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><ci id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">i</annotation></semantics></math>-th group as <math id="S3.SS3.p1.3.m3.1" class="ltx_Math" alttext="b^{i}_{j}" display="inline"><semantics id="S3.SS3.p1.3.m3.1a"><msubsup id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml"><mi id="S3.SS3.p1.3.m3.1.1.2.2" xref="S3.SS3.p1.3.m3.1.1.2.2.cmml">b</mi><mi id="S3.SS3.p1.3.m3.1.1.3" xref="S3.SS3.p1.3.m3.1.1.3.cmml">j</mi><mi id="S3.SS3.p1.3.m3.1.1.2.3" xref="S3.SS3.p1.3.m3.1.1.2.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><apply id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.1.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">subscript</csymbol><apply id="S3.SS3.p1.3.m3.1.1.2.cmml" xref="S3.SS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.1.1.2.1.cmml" xref="S3.SS3.p1.3.m3.1.1">superscript</csymbol><ci id="S3.SS3.p1.3.m3.1.1.2.2.cmml" xref="S3.SS3.p1.3.m3.1.1.2.2">𝑏</ci><ci id="S3.SS3.p1.3.m3.1.1.2.3.cmml" xref="S3.SS3.p1.3.m3.1.1.2.3">𝑖</ci></apply><ci id="S3.SS3.p1.3.m3.1.1.3.cmml" xref="S3.SS3.p1.3.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">b^{i}_{j}</annotation></semantics></math> and the pseudo words after the projection layer as <math id="S3.SS3.p1.4.m4.1" class="ltx_Math" alttext="w^{i}_{j}" display="inline"><semantics id="S3.SS3.p1.4.m4.1a"><msubsup id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml"><mi id="S3.SS3.p1.4.m4.1.1.2.2" xref="S3.SS3.p1.4.m4.1.1.2.2.cmml">w</mi><mi id="S3.SS3.p1.4.m4.1.1.3" xref="S3.SS3.p1.4.m4.1.1.3.cmml">j</mi><mi id="S3.SS3.p1.4.m4.1.1.2.3" xref="S3.SS3.p1.4.m4.1.1.2.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><apply id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.1.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1">subscript</csymbol><apply id="S3.SS3.p1.4.m4.1.1.2.cmml" xref="S3.SS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.1.1.2.1.cmml" xref="S3.SS3.p1.4.m4.1.1">superscript</csymbol><ci id="S3.SS3.p1.4.m4.1.1.2.2.cmml" xref="S3.SS3.p1.4.m4.1.1.2.2">𝑤</ci><ci id="S3.SS3.p1.4.m4.1.1.2.3.cmml" xref="S3.SS3.p1.4.m4.1.1.2.3">𝑖</ci></apply><ci id="S3.SS3.p1.4.m4.1.1.3.cmml" xref="S3.SS3.p1.4.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">w^{i}_{j}</annotation></semantics></math>.
For the pre-trained VLM, we use <math id="S3.SS3.p1.5.m5.1" class="ltx_Math" alttext="\mathcal{T}" display="inline"><semantics id="S3.SS3.p1.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.5.m5.1.1" xref="S3.SS3.p1.5.m5.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.1b"><ci id="S3.SS3.p1.5.m5.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.1c">\mathcal{T}</annotation></semantics></math> to denote the text encoder and <math id="S3.SS3.p1.6.m6.1" class="ltx_Math" alttext="\mathcal{V}" display="inline"><semantics id="S3.SS3.p1.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.6.m6.1.1" xref="S3.SS3.p1.6.m6.1.1.cmml">𝒱</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m6.1b"><ci id="S3.SS3.p1.6.m6.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1">𝒱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m6.1c">\mathcal{V}</annotation></semantics></math> to denote the image encoder.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para ltx_noindent">
<p id="S3.SS3.p2.5" class="ltx_p"><span id="S3.SS3.p2.5.1" class="ltx_text ltx_font_bold">Student Bag-of-Regions Embedding.</span>
Because the region features are projected to word embedding space and learned to be aligned with the text embedding of category,
a straightforward way to obtain the embedding of a bag of regions is to concatenate the pseudo words and feed them to the text encoder <math id="S3.SS3.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{T}" display="inline"><semantics id="S3.SS3.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><ci id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">\mathcal{T}</annotation></semantics></math>.
However, the spatial information of the regions will be lost in such a process, including relative box center positions and relative box shapes.
The center position and shape indicate the spatial relationship among the regions in a bag, which is essential to induce a sentence-like interpretation for the bag of regions. And they are also encoded in the teacher (image encoder of VLMs) through positional embeddings in the input <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite>.
Therefore, BARON encodes the spatial information into positional embeddings <math id="S3.SS3.p2.2.m2.1" class="ltx_Math" alttext="p^{i}_{j}" display="inline"><semantics id="S3.SS3.p2.2.m2.1a"><msubsup id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml"><mi id="S3.SS3.p2.2.m2.1.1.2.2" xref="S3.SS3.p2.2.m2.1.1.2.2.cmml">p</mi><mi id="S3.SS3.p2.2.m2.1.1.3" xref="S3.SS3.p2.2.m2.1.1.3.cmml">j</mi><mi id="S3.SS3.p2.2.m2.1.1.2.3" xref="S3.SS3.p2.2.m2.1.1.2.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><apply id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">subscript</csymbol><apply id="S3.SS3.p2.2.m2.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.2.1.cmml" xref="S3.SS3.p2.2.m2.1.1">superscript</csymbol><ci id="S3.SS3.p2.2.m2.1.1.2.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2.2">𝑝</ci><ci id="S3.SS3.p2.2.m2.1.1.2.3.cmml" xref="S3.SS3.p2.2.m2.1.1.2.3">𝑖</ci></apply><ci id="S3.SS3.p2.2.m2.1.1.3.cmml" xref="S3.SS3.p2.2.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">p^{i}_{j}</annotation></semantics></math> that have the same dimension with <math id="S3.SS3.p2.3.m3.1" class="ltx_Math" alttext="w^{i}_{j}" display="inline"><semantics id="S3.SS3.p2.3.m3.1a"><msubsup id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml"><mi id="S3.SS3.p2.3.m3.1.1.2.2" xref="S3.SS3.p2.3.m3.1.1.2.2.cmml">w</mi><mi id="S3.SS3.p2.3.m3.1.1.3" xref="S3.SS3.p2.3.m3.1.1.3.cmml">j</mi><mi id="S3.SS3.p2.3.m3.1.1.2.3" xref="S3.SS3.p2.3.m3.1.1.2.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><apply id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">subscript</csymbol><apply id="S3.SS3.p2.3.m3.1.1.2.cmml" xref="S3.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.1.1.2.1.cmml" xref="S3.SS3.p2.3.m3.1.1">superscript</csymbol><ci id="S3.SS3.p2.3.m3.1.1.2.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2.2">𝑤</ci><ci id="S3.SS3.p2.3.m3.1.1.2.3.cmml" xref="S3.SS3.p2.3.m3.1.1.2.3">𝑖</ci></apply><ci id="S3.SS3.p2.3.m3.1.1.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">w^{i}_{j}</annotation></semantics></math>, following the practices of Transformers <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib50" title="" class="ltx_ref">50</a>]</cite>.
The positional embeddings are added to the pseudo words before concatenation. Assuming the group size is <math id="S3.SS3.p2.4.m4.1" class="ltx_Math" alttext="N^{i}" display="inline"><semantics id="S3.SS3.p2.4.m4.1a"><msup id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml"><mi id="S3.SS3.p2.4.m4.1.1.2" xref="S3.SS3.p2.4.m4.1.1.2.cmml">N</mi><mi id="S3.SS3.p2.4.m4.1.1.3" xref="S3.SS3.p2.4.m4.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><apply id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.1.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1">superscript</csymbol><ci id="S3.SS3.p2.4.m4.1.1.2.cmml" xref="S3.SS3.p2.4.m4.1.1.2">𝑁</ci><ci id="S3.SS3.p2.4.m4.1.1.3.cmml" xref="S3.SS3.p2.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">N^{i}</annotation></semantics></math>, this representation can be formulated as <math id="S3.SS3.p2.5.m5.2" class="ltx_Math" alttext="f_{t}^{i}=\mathcal{T}(w^{i}_{0}+p^{i}_{0},w^{i}_{1}+p^{i}_{1},\dots,w^{i}_{N^{i}-1}+p^{i}_{N^{i}-1})." display="inline"><semantics id="S3.SS3.p2.5.m5.2a"><mrow id="S3.SS3.p2.5.m5.2.2.1" xref="S3.SS3.p2.5.m5.2.2.1.1.cmml"><mrow id="S3.SS3.p2.5.m5.2.2.1.1" xref="S3.SS3.p2.5.m5.2.2.1.1.cmml"><msubsup id="S3.SS3.p2.5.m5.2.2.1.1.5" xref="S3.SS3.p2.5.m5.2.2.1.1.5.cmml"><mi id="S3.SS3.p2.5.m5.2.2.1.1.5.2.2" xref="S3.SS3.p2.5.m5.2.2.1.1.5.2.2.cmml">f</mi><mi id="S3.SS3.p2.5.m5.2.2.1.1.5.2.3" xref="S3.SS3.p2.5.m5.2.2.1.1.5.2.3.cmml">t</mi><mi id="S3.SS3.p2.5.m5.2.2.1.1.5.3" xref="S3.SS3.p2.5.m5.2.2.1.1.5.3.cmml">i</mi></msubsup><mo id="S3.SS3.p2.5.m5.2.2.1.1.4" xref="S3.SS3.p2.5.m5.2.2.1.1.4.cmml">=</mo><mrow id="S3.SS3.p2.5.m5.2.2.1.1.3" xref="S3.SS3.p2.5.m5.2.2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.5.m5.2.2.1.1.3.5" xref="S3.SS3.p2.5.m5.2.2.1.1.3.5.cmml">𝒯</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.5.m5.2.2.1.1.3.4" xref="S3.SS3.p2.5.m5.2.2.1.1.3.4.cmml">​</mo><mrow id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.4.cmml"><mo stretchy="false" id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.4" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.4.cmml">(</mo><mrow id="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1" xref="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.cmml"><msubsup id="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.2" xref="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.2.cmml"><mi id="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.2.2.2" xref="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.2.2.2.cmml">w</mi><mn id="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.2.3" xref="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.2.3.cmml">0</mn><mi id="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.2.2.3" xref="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.2.2.3.cmml">i</mi></msubsup><mo id="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.1" xref="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.1.cmml">+</mo><msubsup id="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.3" xref="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.3.2.2" xref="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.3.2.2.cmml">p</mi><mn id="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.3.3" xref="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.3.3.cmml">0</mn><mi id="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.3.2.3" xref="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.3.2.3.cmml">i</mi></msubsup></mrow><mo id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.5" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.4.cmml">,</mo><mrow id="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2" xref="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.cmml"><msubsup id="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.2" xref="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.2.cmml"><mi id="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.2.2.2" xref="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.2.2.2.cmml">w</mi><mn id="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.2.3" xref="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.2.3.cmml">1</mn><mi id="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.2.2.3" xref="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.2.2.3.cmml">i</mi></msubsup><mo id="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.1" xref="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.1.cmml">+</mo><msubsup id="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.3" xref="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.3.cmml"><mi id="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.3.2.2" xref="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.3.2.2.cmml">p</mi><mn id="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.3.3" xref="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.3.3.cmml">1</mn><mi id="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.3.2.3" xref="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.3.2.3.cmml">i</mi></msubsup></mrow><mo id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.6" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS3.p2.5.m5.1.1" xref="S3.SS3.p2.5.m5.1.1.cmml">…</mi><mo id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.7" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.4.cmml">,</mo><mrow id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.cmml"><msubsup id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.2" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.2.cmml"><mi id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.2.2.2" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.2.2.2.cmml">w</mi><mrow id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.2.3" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.2.3.cmml"><msup id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.2.3.2" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.2.3.2.cmml"><mi id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.2.3.2.2" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.2.3.2.2.cmml">N</mi><mi id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.2.3.2.3" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.2.3.2.3.cmml">i</mi></msup><mo id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.2.3.1" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.2.3.1.cmml">−</mo><mn id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.2.3.3" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.2.3.3.cmml">1</mn></mrow><mi id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.2.2.3" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.2.2.3.cmml">i</mi></msubsup><mo id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.1" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.1.cmml">+</mo><msubsup id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.3" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.3.cmml"><mi id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.3.2.2" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.3.2.2.cmml">p</mi><mrow id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.3.3" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.3.3.cmml"><msup id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.3.3.2" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.3.3.2.cmml"><mi id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.3.3.2.2" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.3.3.2.2.cmml">N</mi><mi id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.3.3.2.3" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.3.3.2.3.cmml">i</mi></msup><mo id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.3.3.1" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.3.3.1.cmml">−</mo><mn id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.3.3.3" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.3.3.3.cmml">1</mn></mrow><mi id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.3.2.3" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.3.2.3.cmml">i</mi></msubsup></mrow><mo stretchy="false" id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.8" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.4.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.SS3.p2.5.m5.2.2.1.2" xref="S3.SS3.p2.5.m5.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.2b"><apply id="S3.SS3.p2.5.m5.2.2.1.1.cmml" xref="S3.SS3.p2.5.m5.2.2.1"><eq id="S3.SS3.p2.5.m5.2.2.1.1.4.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.4"></eq><apply id="S3.SS3.p2.5.m5.2.2.1.1.5.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.5"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.2.2.1.1.5.1.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.5">superscript</csymbol><apply id="S3.SS3.p2.5.m5.2.2.1.1.5.2.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.5"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.2.2.1.1.5.2.1.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.5">subscript</csymbol><ci id="S3.SS3.p2.5.m5.2.2.1.1.5.2.2.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.5.2.2">𝑓</ci><ci id="S3.SS3.p2.5.m5.2.2.1.1.5.2.3.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.5.2.3">𝑡</ci></apply><ci id="S3.SS3.p2.5.m5.2.2.1.1.5.3.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.5.3">𝑖</ci></apply><apply id="S3.SS3.p2.5.m5.2.2.1.1.3.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.3"><times id="S3.SS3.p2.5.m5.2.2.1.1.3.4.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.3.4"></times><ci id="S3.SS3.p2.5.m5.2.2.1.1.3.5.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.3.5">𝒯</ci><vector id="S3.SS3.p2.5.m5.2.2.1.1.3.3.4.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3"><apply id="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1"><plus id="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.1"></plus><apply id="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.2.2.1.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.2.2.2">𝑤</ci><ci id="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.2.2.3.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.2.2.3">𝑖</ci></apply><cn type="integer" id="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.2.3.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.2.3">0</cn></apply><apply id="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.3.2.1.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.3.2.2.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.3.2.2">𝑝</ci><ci id="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.3.2.3.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><cn type="integer" id="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.1.1.1.1.3.3">0</cn></apply></apply><apply id="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2"><plus id="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.1.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.1"></plus><apply id="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.2.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.2.1.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.2">subscript</csymbol><apply id="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.2.2.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.2.2.1.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.2">superscript</csymbol><ci id="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.2.2.2.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.2.2.2">𝑤</ci><ci id="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.2.2.3.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.2.2.3">𝑖</ci></apply><cn type="integer" id="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.2.3.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.2.3">1</cn></apply><apply id="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.3.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.3.1.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.3">subscript</csymbol><apply id="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.3.2.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.3.2.1.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.3">superscript</csymbol><ci id="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.3.2.2.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.3.2.2">𝑝</ci><ci id="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.3.2.3.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.3.2.3">𝑖</ci></apply><cn type="integer" id="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.3.3.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.2.2.2.2.3.3">1</cn></apply></apply><ci id="S3.SS3.p2.5.m5.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1">…</ci><apply id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3"><plus id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.1.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.1"></plus><apply id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.2.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.2"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.2.1.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.2">subscript</csymbol><apply id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.2.2.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.2"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.2.2.1.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.2">superscript</csymbol><ci id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.2.2.2.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.2.2.2">𝑤</ci><ci id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.2.2.3.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.2.2.3">𝑖</ci></apply><apply id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.2.3.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.2.3"><minus id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.2.3.1.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.2.3.1"></minus><apply id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.2.3.2.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.2.3.2"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.2.3.2.1.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.2.3.2">superscript</csymbol><ci id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.2.3.2.2.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.2.3.2.2">𝑁</ci><ci id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.2.3.2.3.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.2.3.2.3">𝑖</ci></apply><cn type="integer" id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.2.3.3.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.2.3.3">1</cn></apply></apply><apply id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.3.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.3.1.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.3">subscript</csymbol><apply id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.3.2.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.3.2.1.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.3">superscript</csymbol><ci id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.3.2.2.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.3.2.2">𝑝</ci><ci id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.3.2.3.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.3.2.3">𝑖</ci></apply><apply id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.3.3.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.3.3"><minus id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.3.3.1.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.3.3.1"></minus><apply id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.3.3.2.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.3.3.2"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.3.3.2.1.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.3.3.2">superscript</csymbol><ci id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.3.3.2.2.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.3.3.2.2">𝑁</ci><ci id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.3.3.2.3.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.3.3.2.3">𝑖</ci></apply><cn type="integer" id="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.3.3.3.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1.3.3.3.3.3.3.3">1</cn></apply></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.2c">f_{t}^{i}=\mathcal{T}(w^{i}_{0}+p^{i}_{0},w^{i}_{1}+p^{i}_{1},\dots,w^{i}_{N^{i}-1}+p^{i}_{N^{i}-1}).</annotation></semantics></math></p>
</div>
<div id="S3.SS3.p3" class="ltx_para ltx_noindent">
<p id="S3.SS3.p3.3" class="ltx_p"><span id="S3.SS3.p3.3.1" class="ltx_text ltx_font_bold">Teacher Bag-of-Regions Embedding.</span> The image embedding of the grouped regions can be obtained by feeding the image crop that encloses the regions to the image encoder <math id="S3.SS3.p3.1.m1.1" class="ltx_Math" alttext="\mathcal{V}" display="inline"><semantics id="S3.SS3.p3.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml">𝒱</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><ci id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">𝒱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">\mathcal{V}</annotation></semantics></math>. The image crop may contain redundant contents that are outside the grouped regions; we mask out them in the attention layers of <math id="S3.SS3.p3.2.m2.1" class="ltx_Math" alttext="\mathcal{V}" display="inline"><semantics id="S3.SS3.p3.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml">𝒱</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b"><ci id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1">𝒱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">\mathcal{V}</annotation></semantics></math>. The image feature can be formulated as <math id="S3.SS3.p3.3.m3.4" class="ltx_Math" alttext="f_{v}^{i}=\mathcal{V}(b^{i}_{0},b^{i}_{1},\dots,b^{i}_{N_{i}-1})" display="inline"><semantics id="S3.SS3.p3.3.m3.4a"><mrow id="S3.SS3.p3.3.m3.4.4" xref="S3.SS3.p3.3.m3.4.4.cmml"><msubsup id="S3.SS3.p3.3.m3.4.4.5" xref="S3.SS3.p3.3.m3.4.4.5.cmml"><mi id="S3.SS3.p3.3.m3.4.4.5.2.2" xref="S3.SS3.p3.3.m3.4.4.5.2.2.cmml">f</mi><mi id="S3.SS3.p3.3.m3.4.4.5.2.3" xref="S3.SS3.p3.3.m3.4.4.5.2.3.cmml">v</mi><mi id="S3.SS3.p3.3.m3.4.4.5.3" xref="S3.SS3.p3.3.m3.4.4.5.3.cmml">i</mi></msubsup><mo id="S3.SS3.p3.3.m3.4.4.4" xref="S3.SS3.p3.3.m3.4.4.4.cmml">=</mo><mrow id="S3.SS3.p3.3.m3.4.4.3" xref="S3.SS3.p3.3.m3.4.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p3.3.m3.4.4.3.5" xref="S3.SS3.p3.3.m3.4.4.3.5.cmml">𝒱</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.3.m3.4.4.3.4" xref="S3.SS3.p3.3.m3.4.4.3.4.cmml">​</mo><mrow id="S3.SS3.p3.3.m3.4.4.3.3.3" xref="S3.SS3.p3.3.m3.4.4.3.3.4.cmml"><mo stretchy="false" id="S3.SS3.p3.3.m3.4.4.3.3.3.4" xref="S3.SS3.p3.3.m3.4.4.3.3.4.cmml">(</mo><msubsup id="S3.SS3.p3.3.m3.2.2.1.1.1.1" xref="S3.SS3.p3.3.m3.2.2.1.1.1.1.cmml"><mi id="S3.SS3.p3.3.m3.2.2.1.1.1.1.2.2" xref="S3.SS3.p3.3.m3.2.2.1.1.1.1.2.2.cmml">b</mi><mn id="S3.SS3.p3.3.m3.2.2.1.1.1.1.3" xref="S3.SS3.p3.3.m3.2.2.1.1.1.1.3.cmml">0</mn><mi id="S3.SS3.p3.3.m3.2.2.1.1.1.1.2.3" xref="S3.SS3.p3.3.m3.2.2.1.1.1.1.2.3.cmml">i</mi></msubsup><mo id="S3.SS3.p3.3.m3.4.4.3.3.3.5" xref="S3.SS3.p3.3.m3.4.4.3.3.4.cmml">,</mo><msubsup id="S3.SS3.p3.3.m3.3.3.2.2.2.2" xref="S3.SS3.p3.3.m3.3.3.2.2.2.2.cmml"><mi id="S3.SS3.p3.3.m3.3.3.2.2.2.2.2.2" xref="S3.SS3.p3.3.m3.3.3.2.2.2.2.2.2.cmml">b</mi><mn id="S3.SS3.p3.3.m3.3.3.2.2.2.2.3" xref="S3.SS3.p3.3.m3.3.3.2.2.2.2.3.cmml">1</mn><mi id="S3.SS3.p3.3.m3.3.3.2.2.2.2.2.3" xref="S3.SS3.p3.3.m3.3.3.2.2.2.2.2.3.cmml">i</mi></msubsup><mo id="S3.SS3.p3.3.m3.4.4.3.3.3.6" xref="S3.SS3.p3.3.m3.4.4.3.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS3.p3.3.m3.1.1" xref="S3.SS3.p3.3.m3.1.1.cmml">…</mi><mo id="S3.SS3.p3.3.m3.4.4.3.3.3.7" xref="S3.SS3.p3.3.m3.4.4.3.3.4.cmml">,</mo><msubsup id="S3.SS3.p3.3.m3.4.4.3.3.3.3" xref="S3.SS3.p3.3.m3.4.4.3.3.3.3.cmml"><mi id="S3.SS3.p3.3.m3.4.4.3.3.3.3.2.2" xref="S3.SS3.p3.3.m3.4.4.3.3.3.3.2.2.cmml">b</mi><mrow id="S3.SS3.p3.3.m3.4.4.3.3.3.3.3" xref="S3.SS3.p3.3.m3.4.4.3.3.3.3.3.cmml"><msub id="S3.SS3.p3.3.m3.4.4.3.3.3.3.3.2" xref="S3.SS3.p3.3.m3.4.4.3.3.3.3.3.2.cmml"><mi id="S3.SS3.p3.3.m3.4.4.3.3.3.3.3.2.2" xref="S3.SS3.p3.3.m3.4.4.3.3.3.3.3.2.2.cmml">N</mi><mi id="S3.SS3.p3.3.m3.4.4.3.3.3.3.3.2.3" xref="S3.SS3.p3.3.m3.4.4.3.3.3.3.3.2.3.cmml">i</mi></msub><mo id="S3.SS3.p3.3.m3.4.4.3.3.3.3.3.1" xref="S3.SS3.p3.3.m3.4.4.3.3.3.3.3.1.cmml">−</mo><mn id="S3.SS3.p3.3.m3.4.4.3.3.3.3.3.3" xref="S3.SS3.p3.3.m3.4.4.3.3.3.3.3.3.cmml">1</mn></mrow><mi id="S3.SS3.p3.3.m3.4.4.3.3.3.3.2.3" xref="S3.SS3.p3.3.m3.4.4.3.3.3.3.2.3.cmml">i</mi></msubsup><mo stretchy="false" id="S3.SS3.p3.3.m3.4.4.3.3.3.8" xref="S3.SS3.p3.3.m3.4.4.3.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m3.4b"><apply id="S3.SS3.p3.3.m3.4.4.cmml" xref="S3.SS3.p3.3.m3.4.4"><eq id="S3.SS3.p3.3.m3.4.4.4.cmml" xref="S3.SS3.p3.3.m3.4.4.4"></eq><apply id="S3.SS3.p3.3.m3.4.4.5.cmml" xref="S3.SS3.p3.3.m3.4.4.5"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.4.4.5.1.cmml" xref="S3.SS3.p3.3.m3.4.4.5">superscript</csymbol><apply id="S3.SS3.p3.3.m3.4.4.5.2.cmml" xref="S3.SS3.p3.3.m3.4.4.5"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.4.4.5.2.1.cmml" xref="S3.SS3.p3.3.m3.4.4.5">subscript</csymbol><ci id="S3.SS3.p3.3.m3.4.4.5.2.2.cmml" xref="S3.SS3.p3.3.m3.4.4.5.2.2">𝑓</ci><ci id="S3.SS3.p3.3.m3.4.4.5.2.3.cmml" xref="S3.SS3.p3.3.m3.4.4.5.2.3">𝑣</ci></apply><ci id="S3.SS3.p3.3.m3.4.4.5.3.cmml" xref="S3.SS3.p3.3.m3.4.4.5.3">𝑖</ci></apply><apply id="S3.SS3.p3.3.m3.4.4.3.cmml" xref="S3.SS3.p3.3.m3.4.4.3"><times id="S3.SS3.p3.3.m3.4.4.3.4.cmml" xref="S3.SS3.p3.3.m3.4.4.3.4"></times><ci id="S3.SS3.p3.3.m3.4.4.3.5.cmml" xref="S3.SS3.p3.3.m3.4.4.3.5">𝒱</ci><vector id="S3.SS3.p3.3.m3.4.4.3.3.4.cmml" xref="S3.SS3.p3.3.m3.4.4.3.3.3"><apply id="S3.SS3.p3.3.m3.2.2.1.1.1.1.cmml" xref="S3.SS3.p3.3.m3.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.2.2.1.1.1.1.1.cmml" xref="S3.SS3.p3.3.m3.2.2.1.1.1.1">subscript</csymbol><apply id="S3.SS3.p3.3.m3.2.2.1.1.1.1.2.cmml" xref="S3.SS3.p3.3.m3.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.2.2.1.1.1.1.2.1.cmml" xref="S3.SS3.p3.3.m3.2.2.1.1.1.1">superscript</csymbol><ci id="S3.SS3.p3.3.m3.2.2.1.1.1.1.2.2.cmml" xref="S3.SS3.p3.3.m3.2.2.1.1.1.1.2.2">𝑏</ci><ci id="S3.SS3.p3.3.m3.2.2.1.1.1.1.2.3.cmml" xref="S3.SS3.p3.3.m3.2.2.1.1.1.1.2.3">𝑖</ci></apply><cn type="integer" id="S3.SS3.p3.3.m3.2.2.1.1.1.1.3.cmml" xref="S3.SS3.p3.3.m3.2.2.1.1.1.1.3">0</cn></apply><apply id="S3.SS3.p3.3.m3.3.3.2.2.2.2.cmml" xref="S3.SS3.p3.3.m3.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.3.3.2.2.2.2.1.cmml" xref="S3.SS3.p3.3.m3.3.3.2.2.2.2">subscript</csymbol><apply id="S3.SS3.p3.3.m3.3.3.2.2.2.2.2.cmml" xref="S3.SS3.p3.3.m3.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.3.3.2.2.2.2.2.1.cmml" xref="S3.SS3.p3.3.m3.3.3.2.2.2.2">superscript</csymbol><ci id="S3.SS3.p3.3.m3.3.3.2.2.2.2.2.2.cmml" xref="S3.SS3.p3.3.m3.3.3.2.2.2.2.2.2">𝑏</ci><ci id="S3.SS3.p3.3.m3.3.3.2.2.2.2.2.3.cmml" xref="S3.SS3.p3.3.m3.3.3.2.2.2.2.2.3">𝑖</ci></apply><cn type="integer" id="S3.SS3.p3.3.m3.3.3.2.2.2.2.3.cmml" xref="S3.SS3.p3.3.m3.3.3.2.2.2.2.3">1</cn></apply><ci id="S3.SS3.p3.3.m3.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1">…</ci><apply id="S3.SS3.p3.3.m3.4.4.3.3.3.3.cmml" xref="S3.SS3.p3.3.m3.4.4.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.4.4.3.3.3.3.1.cmml" xref="S3.SS3.p3.3.m3.4.4.3.3.3.3">subscript</csymbol><apply id="S3.SS3.p3.3.m3.4.4.3.3.3.3.2.cmml" xref="S3.SS3.p3.3.m3.4.4.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.4.4.3.3.3.3.2.1.cmml" xref="S3.SS3.p3.3.m3.4.4.3.3.3.3">superscript</csymbol><ci id="S3.SS3.p3.3.m3.4.4.3.3.3.3.2.2.cmml" xref="S3.SS3.p3.3.m3.4.4.3.3.3.3.2.2">𝑏</ci><ci id="S3.SS3.p3.3.m3.4.4.3.3.3.3.2.3.cmml" xref="S3.SS3.p3.3.m3.4.4.3.3.3.3.2.3">𝑖</ci></apply><apply id="S3.SS3.p3.3.m3.4.4.3.3.3.3.3.cmml" xref="S3.SS3.p3.3.m3.4.4.3.3.3.3.3"><minus id="S3.SS3.p3.3.m3.4.4.3.3.3.3.3.1.cmml" xref="S3.SS3.p3.3.m3.4.4.3.3.3.3.3.1"></minus><apply id="S3.SS3.p3.3.m3.4.4.3.3.3.3.3.2.cmml" xref="S3.SS3.p3.3.m3.4.4.3.3.3.3.3.2"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.4.4.3.3.3.3.3.2.1.cmml" xref="S3.SS3.p3.3.m3.4.4.3.3.3.3.3.2">subscript</csymbol><ci id="S3.SS3.p3.3.m3.4.4.3.3.3.3.3.2.2.cmml" xref="S3.SS3.p3.3.m3.4.4.3.3.3.3.3.2.2">𝑁</ci><ci id="S3.SS3.p3.3.m3.4.4.3.3.3.3.3.2.3.cmml" xref="S3.SS3.p3.3.m3.4.4.3.3.3.3.3.2.3">𝑖</ci></apply><cn type="integer" id="S3.SS3.p3.3.m3.4.4.3.3.3.3.3.3.cmml" xref="S3.SS3.p3.3.m3.4.4.3.3.3.3.3.3">1</cn></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m3.4c">f_{v}^{i}=\mathcal{V}(b^{i}_{0},b^{i}_{1},\dots,b^{i}_{N_{i}-1})</annotation></semantics></math>.</p>
</div>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Aligning Bag of Regions</h3>

<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.1" class="ltx_p">BARON aligns the bag-of-regions embeddings from student and teacher to make the student learn to encode the co-existence of multiple regions, which potentially contain multiple concepts.
We adopt the contrastive learning approach used in vision-language pre-training <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite>.
Specifically, given <math id="S3.SS4.p1.1.m1.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S3.SS4.p1.1.m1.1a"><mi id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><ci id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">G</annotation></semantics></math> bags of regions, the alignment InfoNCE loss <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite> between bag-of-regions embeddings is calculated as</p>
</div>
<div id="S3.SS4.p2" class="ltx_para">
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.7" class="ltx_Math" alttext="\mathcal{L}_{\mathrm{bag}}=-\frac{1}{2}\sum_{k=0}^{G-1}(\log(p_{t,v}^{k})+\log(p_{v,t}^{k}))." display="block"><semantics id="S3.E2.m1.7a"><mrow id="S3.E2.m1.7.7.1" xref="S3.E2.m1.7.7.1.1.cmml"><mrow id="S3.E2.m1.7.7.1.1" xref="S3.E2.m1.7.7.1.1.cmml"><msub id="S3.E2.m1.7.7.1.1.3" xref="S3.E2.m1.7.7.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.7.7.1.1.3.2" xref="S3.E2.m1.7.7.1.1.3.2.cmml">ℒ</mi><mi id="S3.E2.m1.7.7.1.1.3.3" xref="S3.E2.m1.7.7.1.1.3.3.cmml">bag</mi></msub><mo id="S3.E2.m1.7.7.1.1.2" xref="S3.E2.m1.7.7.1.1.2.cmml">=</mo><mrow id="S3.E2.m1.7.7.1.1.1" xref="S3.E2.m1.7.7.1.1.1.cmml"><mo id="S3.E2.m1.7.7.1.1.1a" xref="S3.E2.m1.7.7.1.1.1.cmml">−</mo><mrow id="S3.E2.m1.7.7.1.1.1.1" xref="S3.E2.m1.7.7.1.1.1.1.cmml"><mfrac id="S3.E2.m1.7.7.1.1.1.1.3" xref="S3.E2.m1.7.7.1.1.1.1.3.cmml"><mn id="S3.E2.m1.7.7.1.1.1.1.3.2" xref="S3.E2.m1.7.7.1.1.1.1.3.2.cmml">1</mn><mn id="S3.E2.m1.7.7.1.1.1.1.3.3" xref="S3.E2.m1.7.7.1.1.1.1.3.3.cmml">2</mn></mfrac><mo lspace="0em" rspace="0em" id="S3.E2.m1.7.7.1.1.1.1.2" xref="S3.E2.m1.7.7.1.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.7.7.1.1.1.1.1" xref="S3.E2.m1.7.7.1.1.1.1.1.cmml"><munderover id="S3.E2.m1.7.7.1.1.1.1.1.2" xref="S3.E2.m1.7.7.1.1.1.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S3.E2.m1.7.7.1.1.1.1.1.2.2.2" xref="S3.E2.m1.7.7.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E2.m1.7.7.1.1.1.1.1.2.2.3" xref="S3.E2.m1.7.7.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E2.m1.7.7.1.1.1.1.1.2.2.3.2" xref="S3.E2.m1.7.7.1.1.1.1.1.2.2.3.2.cmml">k</mi><mo id="S3.E2.m1.7.7.1.1.1.1.1.2.2.3.1" xref="S3.E2.m1.7.7.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E2.m1.7.7.1.1.1.1.1.2.2.3.3" xref="S3.E2.m1.7.7.1.1.1.1.1.2.2.3.3.cmml">0</mn></mrow><mrow id="S3.E2.m1.7.7.1.1.1.1.1.2.3" xref="S3.E2.m1.7.7.1.1.1.1.1.2.3.cmml"><mi id="S3.E2.m1.7.7.1.1.1.1.1.2.3.2" xref="S3.E2.m1.7.7.1.1.1.1.1.2.3.2.cmml">G</mi><mo id="S3.E2.m1.7.7.1.1.1.1.1.2.3.1" xref="S3.E2.m1.7.7.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="S3.E2.m1.7.7.1.1.1.1.1.2.3.3" xref="S3.E2.m1.7.7.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></munderover><mrow id="S3.E2.m1.7.7.1.1.1.1.1.1.1" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.7.7.1.1.1.1.1.1.1.2" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E2.m1.5.5" xref="S3.E2.m1.5.5.cmml">log</mi><mo id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1a" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><msubsup id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">p</mi><mrow id="S3.E2.m1.2.2.2.4" xref="S3.E2.m1.2.2.2.3.cmml"><mi id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">t</mi><mo id="S3.E2.m1.2.2.2.4.1" xref="S3.E2.m1.2.2.2.3.cmml">,</mo><mi id="S3.E2.m1.2.2.2.2" xref="S3.E2.m1.2.2.2.2.cmml">v</mi></mrow><mi id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msubsup><mo stretchy="false" id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.3.cmml">+</mo><mrow id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.1" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E2.m1.6.6" xref="S3.E2.m1.6.6.cmml">log</mi><mo id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.1a" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.2.cmml">⁡</mo><mrow id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.1.1" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.2.cmml"><mo stretchy="false" id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.2" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.2.cmml">(</mo><msubsup id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mi id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1.2.2" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1.2.2.cmml">p</mi><mrow id="S3.E2.m1.4.4.2.4" xref="S3.E2.m1.4.4.2.3.cmml"><mi id="S3.E2.m1.3.3.1.1" xref="S3.E2.m1.3.3.1.1.cmml">v</mi><mo id="S3.E2.m1.4.4.2.4.1" xref="S3.E2.m1.4.4.2.3.cmml">,</mo><mi id="S3.E2.m1.4.4.2.2" xref="S3.E2.m1.4.4.2.2.cmml">t</mi></mrow><mi id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1.3" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml">k</mi></msubsup><mo stretchy="false" id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.3" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.2.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.E2.m1.7.7.1.1.1.1.1.1.1.3" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E2.m1.7.7.1.2" xref="S3.E2.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.7b"><apply id="S3.E2.m1.7.7.1.1.cmml" xref="S3.E2.m1.7.7.1"><eq id="S3.E2.m1.7.7.1.1.2.cmml" xref="S3.E2.m1.7.7.1.1.2"></eq><apply id="S3.E2.m1.7.7.1.1.3.cmml" xref="S3.E2.m1.7.7.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.3.1.cmml" xref="S3.E2.m1.7.7.1.1.3">subscript</csymbol><ci id="S3.E2.m1.7.7.1.1.3.2.cmml" xref="S3.E2.m1.7.7.1.1.3.2">ℒ</ci><ci id="S3.E2.m1.7.7.1.1.3.3.cmml" xref="S3.E2.m1.7.7.1.1.3.3">bag</ci></apply><apply id="S3.E2.m1.7.7.1.1.1.cmml" xref="S3.E2.m1.7.7.1.1.1"><minus id="S3.E2.m1.7.7.1.1.1.2.cmml" xref="S3.E2.m1.7.7.1.1.1"></minus><apply id="S3.E2.m1.7.7.1.1.1.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1"><times id="S3.E2.m1.7.7.1.1.1.1.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.2"></times><apply id="S3.E2.m1.7.7.1.1.1.1.3.cmml" xref="S3.E2.m1.7.7.1.1.1.1.3"><divide id="S3.E2.m1.7.7.1.1.1.1.3.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.3"></divide><cn type="integer" id="S3.E2.m1.7.7.1.1.1.1.3.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.3.2">1</cn><cn type="integer" id="S3.E2.m1.7.7.1.1.1.1.3.3.cmml" xref="S3.E2.m1.7.7.1.1.1.1.3.3">2</cn></apply><apply id="S3.E2.m1.7.7.1.1.1.1.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1"><apply id="S3.E2.m1.7.7.1.1.1.1.1.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E2.m1.7.7.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.1.1.1.2.2.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E2.m1.7.7.1.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.2.2.2"></sum><apply id="S3.E2.m1.7.7.1.1.1.1.1.2.2.3.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.2.2.3"><eq id="S3.E2.m1.7.7.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.2.2.3.1"></eq><ci id="S3.E2.m1.7.7.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.2.2.3.2">𝑘</ci><cn type="integer" id="S3.E2.m1.7.7.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.2.2.3.3">0</cn></apply></apply><apply id="S3.E2.m1.7.7.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.2.3"><minus id="S3.E2.m1.7.7.1.1.1.1.1.2.3.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.2.3.1"></minus><ci id="S3.E2.m1.7.7.1.1.1.1.1.2.3.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.2.3.2">𝐺</ci><cn type="integer" id="S3.E2.m1.7.7.1.1.1.1.1.2.3.3.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1"><plus id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.3"></plus><apply id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1"><log id="S3.E2.m1.5.5.cmml" xref="S3.E2.m1.5.5"></log><apply id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑝</ci><list id="S3.E2.m1.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.4"><ci id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">𝑡</ci><ci id="S3.E2.m1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2">𝑣</ci></list></apply><ci id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply></apply><apply id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.1"><log id="S3.E2.m1.6.6.cmml" xref="S3.E2.m1.6.6"></log><apply id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1">superscript</csymbol><apply id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1.2.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1">subscript</csymbol><ci id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1.2.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1.2.2">𝑝</ci><list id="S3.E2.m1.4.4.2.3.cmml" xref="S3.E2.m1.4.4.2.4"><ci id="S3.E2.m1.3.3.1.1.cmml" xref="S3.E2.m1.3.3.1.1">𝑣</ci><ci id="S3.E2.m1.4.4.2.2.cmml" xref="S3.E2.m1.4.4.2.2">𝑡</ci></list></apply><ci id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1.3">𝑘</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.7c">\mathcal{L}_{\mathrm{bag}}=-\frac{1}{2}\sum_{k=0}^{G-1}(\log(p_{t,v}^{k})+\log(p_{v,t}^{k})).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p2.2" class="ltx_p">The <math id="S3.SS4.p2.1.m1.2" class="ltx_Math" alttext="p_{t,v}^{k}" display="inline"><semantics id="S3.SS4.p2.1.m1.2a"><msubsup id="S3.SS4.p2.1.m1.2.3" xref="S3.SS4.p2.1.m1.2.3.cmml"><mi id="S3.SS4.p2.1.m1.2.3.2.2" xref="S3.SS4.p2.1.m1.2.3.2.2.cmml">p</mi><mrow id="S3.SS4.p2.1.m1.2.2.2.4" xref="S3.SS4.p2.1.m1.2.2.2.3.cmml"><mi id="S3.SS4.p2.1.m1.1.1.1.1" xref="S3.SS4.p2.1.m1.1.1.1.1.cmml">t</mi><mo id="S3.SS4.p2.1.m1.2.2.2.4.1" xref="S3.SS4.p2.1.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS4.p2.1.m1.2.2.2.2" xref="S3.SS4.p2.1.m1.2.2.2.2.cmml">v</mi></mrow><mi id="S3.SS4.p2.1.m1.2.3.3" xref="S3.SS4.p2.1.m1.2.3.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.1.m1.2b"><apply id="S3.SS4.p2.1.m1.2.3.cmml" xref="S3.SS4.p2.1.m1.2.3"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.2.3.1.cmml" xref="S3.SS4.p2.1.m1.2.3">superscript</csymbol><apply id="S3.SS4.p2.1.m1.2.3.2.cmml" xref="S3.SS4.p2.1.m1.2.3"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.2.3.2.1.cmml" xref="S3.SS4.p2.1.m1.2.3">subscript</csymbol><ci id="S3.SS4.p2.1.m1.2.3.2.2.cmml" xref="S3.SS4.p2.1.m1.2.3.2.2">𝑝</ci><list id="S3.SS4.p2.1.m1.2.2.2.3.cmml" xref="S3.SS4.p2.1.m1.2.2.2.4"><ci id="S3.SS4.p2.1.m1.1.1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1">𝑡</ci><ci id="S3.SS4.p2.1.m1.2.2.2.2.cmml" xref="S3.SS4.p2.1.m1.2.2.2.2">𝑣</ci></list></apply><ci id="S3.SS4.p2.1.m1.2.3.3.cmml" xref="S3.SS4.p2.1.m1.2.3.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.1.m1.2c">p_{t,v}^{k}</annotation></semantics></math> and <math id="S3.SS4.p2.2.m2.2" class="ltx_Math" alttext="p_{v,t}^{k}" display="inline"><semantics id="S3.SS4.p2.2.m2.2a"><msubsup id="S3.SS4.p2.2.m2.2.3" xref="S3.SS4.p2.2.m2.2.3.cmml"><mi id="S3.SS4.p2.2.m2.2.3.2.2" xref="S3.SS4.p2.2.m2.2.3.2.2.cmml">p</mi><mrow id="S3.SS4.p2.2.m2.2.2.2.4" xref="S3.SS4.p2.2.m2.2.2.2.3.cmml"><mi id="S3.SS4.p2.2.m2.1.1.1.1" xref="S3.SS4.p2.2.m2.1.1.1.1.cmml">v</mi><mo id="S3.SS4.p2.2.m2.2.2.2.4.1" xref="S3.SS4.p2.2.m2.2.2.2.3.cmml">,</mo><mi id="S3.SS4.p2.2.m2.2.2.2.2" xref="S3.SS4.p2.2.m2.2.2.2.2.cmml">t</mi></mrow><mi id="S3.SS4.p2.2.m2.2.3.3" xref="S3.SS4.p2.2.m2.2.3.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.2.m2.2b"><apply id="S3.SS4.p2.2.m2.2.3.cmml" xref="S3.SS4.p2.2.m2.2.3"><csymbol cd="ambiguous" id="S3.SS4.p2.2.m2.2.3.1.cmml" xref="S3.SS4.p2.2.m2.2.3">superscript</csymbol><apply id="S3.SS4.p2.2.m2.2.3.2.cmml" xref="S3.SS4.p2.2.m2.2.3"><csymbol cd="ambiguous" id="S3.SS4.p2.2.m2.2.3.2.1.cmml" xref="S3.SS4.p2.2.m2.2.3">subscript</csymbol><ci id="S3.SS4.p2.2.m2.2.3.2.2.cmml" xref="S3.SS4.p2.2.m2.2.3.2.2">𝑝</ci><list id="S3.SS4.p2.2.m2.2.2.2.3.cmml" xref="S3.SS4.p2.2.m2.2.2.2.4"><ci id="S3.SS4.p2.2.m2.1.1.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1.1.1">𝑣</ci><ci id="S3.SS4.p2.2.m2.2.2.2.2.cmml" xref="S3.SS4.p2.2.m2.2.2.2.2">𝑡</ci></list></apply><ci id="S3.SS4.p2.2.m2.2.3.3.cmml" xref="S3.SS4.p2.2.m2.2.3.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.2.m2.2c">p_{v,t}^{k}</annotation></semantics></math> are calculated as</p>
<table id="A6.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E3.m1.6" class="ltx_Math" alttext="\displaystyle p_{t,v}^{k}=\frac{\exp(\tau^{\prime}\cdot\langle f_{t}^{k},f_{v}^{k}\rangle)}{\sum_{l=0}^{G-1}\exp(\tau^{\prime}\cdot\langle f_{t}^{k},f_{v}^{l}\rangle)}" display="inline"><semantics id="S3.E3.m1.6a"><mrow id="S3.E3.m1.6.7" xref="S3.E3.m1.6.7.cmml"><msubsup id="S3.E3.m1.6.7.2" xref="S3.E3.m1.6.7.2.cmml"><mi id="S3.E3.m1.6.7.2.2.2" xref="S3.E3.m1.6.7.2.2.2.cmml">p</mi><mrow id="S3.E3.m1.2.2.2.4" xref="S3.E3.m1.2.2.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml">t</mi><mo id="S3.E3.m1.2.2.2.4.1" xref="S3.E3.m1.2.2.2.3.cmml">,</mo><mi id="S3.E3.m1.2.2.2.2" xref="S3.E3.m1.2.2.2.2.cmml">v</mi></mrow><mi id="S3.E3.m1.6.7.2.3" xref="S3.E3.m1.6.7.2.3.cmml">k</mi></msubsup><mo id="S3.E3.m1.6.7.1" xref="S3.E3.m1.6.7.1.cmml">=</mo><mstyle displaystyle="true" id="S3.E3.m1.6.6" xref="S3.E3.m1.6.6.cmml"><mfrac id="S3.E3.m1.6.6a" xref="S3.E3.m1.6.6.cmml"><mrow id="S3.E3.m1.4.4.2.2" xref="S3.E3.m1.4.4.2.3.cmml"><mi id="S3.E3.m1.3.3.1.1" xref="S3.E3.m1.3.3.1.1.cmml">exp</mi><mo id="S3.E3.m1.4.4.2.2a" xref="S3.E3.m1.4.4.2.3.cmml">⁡</mo><mrow id="S3.E3.m1.4.4.2.2.1" xref="S3.E3.m1.4.4.2.3.cmml"><mo stretchy="false" id="S3.E3.m1.4.4.2.2.1.2" xref="S3.E3.m1.4.4.2.3.cmml">(</mo><mrow id="S3.E3.m1.4.4.2.2.1.1" xref="S3.E3.m1.4.4.2.2.1.1.cmml"><msup id="S3.E3.m1.4.4.2.2.1.1.4" xref="S3.E3.m1.4.4.2.2.1.1.4.cmml"><mi id="S3.E3.m1.4.4.2.2.1.1.4.2" xref="S3.E3.m1.4.4.2.2.1.1.4.2.cmml">τ</mi><mo id="S3.E3.m1.4.4.2.2.1.1.4.3" xref="S3.E3.m1.4.4.2.2.1.1.4.3.cmml">′</mo></msup><mo lspace="0.222em" rspace="0.222em" id="S3.E3.m1.4.4.2.2.1.1.3" xref="S3.E3.m1.4.4.2.2.1.1.3.cmml">⋅</mo><mrow id="S3.E3.m1.4.4.2.2.1.1.2.2" xref="S3.E3.m1.4.4.2.2.1.1.2.3.cmml"><mo stretchy="false" id="S3.E3.m1.4.4.2.2.1.1.2.2.3" xref="S3.E3.m1.4.4.2.2.1.1.2.3.cmml">⟨</mo><msubsup id="S3.E3.m1.4.4.2.2.1.1.1.1.1" xref="S3.E3.m1.4.4.2.2.1.1.1.1.1.cmml"><mi id="S3.E3.m1.4.4.2.2.1.1.1.1.1.2.2" xref="S3.E3.m1.4.4.2.2.1.1.1.1.1.2.2.cmml">f</mi><mi id="S3.E3.m1.4.4.2.2.1.1.1.1.1.2.3" xref="S3.E3.m1.4.4.2.2.1.1.1.1.1.2.3.cmml">t</mi><mi id="S3.E3.m1.4.4.2.2.1.1.1.1.1.3" xref="S3.E3.m1.4.4.2.2.1.1.1.1.1.3.cmml">k</mi></msubsup><mo id="S3.E3.m1.4.4.2.2.1.1.2.2.4" xref="S3.E3.m1.4.4.2.2.1.1.2.3.cmml">,</mo><msubsup id="S3.E3.m1.4.4.2.2.1.1.2.2.2" xref="S3.E3.m1.4.4.2.2.1.1.2.2.2.cmml"><mi id="S3.E3.m1.4.4.2.2.1.1.2.2.2.2.2" xref="S3.E3.m1.4.4.2.2.1.1.2.2.2.2.2.cmml">f</mi><mi id="S3.E3.m1.4.4.2.2.1.1.2.2.2.2.3" xref="S3.E3.m1.4.4.2.2.1.1.2.2.2.2.3.cmml">v</mi><mi id="S3.E3.m1.4.4.2.2.1.1.2.2.2.3" xref="S3.E3.m1.4.4.2.2.1.1.2.2.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="S3.E3.m1.4.4.2.2.1.1.2.2.5" xref="S3.E3.m1.4.4.2.2.1.1.2.3.cmml">⟩</mo></mrow></mrow><mo stretchy="false" id="S3.E3.m1.4.4.2.2.1.3" xref="S3.E3.m1.4.4.2.3.cmml">)</mo></mrow></mrow><mrow id="S3.E3.m1.6.6.4" xref="S3.E3.m1.6.6.4.cmml"><msubsup id="S3.E3.m1.6.6.4.3" xref="S3.E3.m1.6.6.4.3.cmml"><mo id="S3.E3.m1.6.6.4.3.2.2" xref="S3.E3.m1.6.6.4.3.2.2.cmml">∑</mo><mrow id="S3.E3.m1.6.6.4.3.2.3" xref="S3.E3.m1.6.6.4.3.2.3.cmml"><mi id="S3.E3.m1.6.6.4.3.2.3.2" xref="S3.E3.m1.6.6.4.3.2.3.2.cmml">l</mi><mo id="S3.E3.m1.6.6.4.3.2.3.1" xref="S3.E3.m1.6.6.4.3.2.3.1.cmml">=</mo><mn id="S3.E3.m1.6.6.4.3.2.3.3" xref="S3.E3.m1.6.6.4.3.2.3.3.cmml">0</mn></mrow><mrow id="S3.E3.m1.6.6.4.3.3" xref="S3.E3.m1.6.6.4.3.3.cmml"><mi id="S3.E3.m1.6.6.4.3.3.2" xref="S3.E3.m1.6.6.4.3.3.2.cmml">G</mi><mo id="S3.E3.m1.6.6.4.3.3.1" xref="S3.E3.m1.6.6.4.3.3.1.cmml">−</mo><mn id="S3.E3.m1.6.6.4.3.3.3" xref="S3.E3.m1.6.6.4.3.3.3.cmml">1</mn></mrow></msubsup><mrow id="S3.E3.m1.6.6.4.2.1" xref="S3.E3.m1.6.6.4.2.2.cmml"><mi id="S3.E3.m1.5.5.3.1" xref="S3.E3.m1.5.5.3.1.cmml">exp</mi><mo id="S3.E3.m1.6.6.4.2.1a" xref="S3.E3.m1.6.6.4.2.2.cmml">⁡</mo><mrow id="S3.E3.m1.6.6.4.2.1.1" xref="S3.E3.m1.6.6.4.2.2.cmml"><mo stretchy="false" id="S3.E3.m1.6.6.4.2.1.1.2" xref="S3.E3.m1.6.6.4.2.2.cmml">(</mo><mrow id="S3.E3.m1.6.6.4.2.1.1.1" xref="S3.E3.m1.6.6.4.2.1.1.1.cmml"><msup id="S3.E3.m1.6.6.4.2.1.1.1.4" xref="S3.E3.m1.6.6.4.2.1.1.1.4.cmml"><mi id="S3.E3.m1.6.6.4.2.1.1.1.4.2" xref="S3.E3.m1.6.6.4.2.1.1.1.4.2.cmml">τ</mi><mo id="S3.E3.m1.6.6.4.2.1.1.1.4.3" xref="S3.E3.m1.6.6.4.2.1.1.1.4.3.cmml">′</mo></msup><mo lspace="0.222em" rspace="0.222em" id="S3.E3.m1.6.6.4.2.1.1.1.3" xref="S3.E3.m1.6.6.4.2.1.1.1.3.cmml">⋅</mo><mrow id="S3.E3.m1.6.6.4.2.1.1.1.2.2" xref="S3.E3.m1.6.6.4.2.1.1.1.2.3.cmml"><mo stretchy="false" id="S3.E3.m1.6.6.4.2.1.1.1.2.2.3" xref="S3.E3.m1.6.6.4.2.1.1.1.2.3.cmml">⟨</mo><msubsup id="S3.E3.m1.6.6.4.2.1.1.1.1.1.1" xref="S3.E3.m1.6.6.4.2.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.6.6.4.2.1.1.1.1.1.1.2.2" xref="S3.E3.m1.6.6.4.2.1.1.1.1.1.1.2.2.cmml">f</mi><mi id="S3.E3.m1.6.6.4.2.1.1.1.1.1.1.2.3" xref="S3.E3.m1.6.6.4.2.1.1.1.1.1.1.2.3.cmml">t</mi><mi id="S3.E3.m1.6.6.4.2.1.1.1.1.1.1.3" xref="S3.E3.m1.6.6.4.2.1.1.1.1.1.1.3.cmml">k</mi></msubsup><mo id="S3.E3.m1.6.6.4.2.1.1.1.2.2.4" xref="S3.E3.m1.6.6.4.2.1.1.1.2.3.cmml">,</mo><msubsup id="S3.E3.m1.6.6.4.2.1.1.1.2.2.2" xref="S3.E3.m1.6.6.4.2.1.1.1.2.2.2.cmml"><mi id="S3.E3.m1.6.6.4.2.1.1.1.2.2.2.2.2" xref="S3.E3.m1.6.6.4.2.1.1.1.2.2.2.2.2.cmml">f</mi><mi id="S3.E3.m1.6.6.4.2.1.1.1.2.2.2.2.3" xref="S3.E3.m1.6.6.4.2.1.1.1.2.2.2.2.3.cmml">v</mi><mi id="S3.E3.m1.6.6.4.2.1.1.1.2.2.2.3" xref="S3.E3.m1.6.6.4.2.1.1.1.2.2.2.3.cmml">l</mi></msubsup><mo stretchy="false" id="S3.E3.m1.6.6.4.2.1.1.1.2.2.5" xref="S3.E3.m1.6.6.4.2.1.1.1.2.3.cmml">⟩</mo></mrow></mrow><mo stretchy="false" id="S3.E3.m1.6.6.4.2.1.1.3" xref="S3.E3.m1.6.6.4.2.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.6b"><apply id="S3.E3.m1.6.7.cmml" xref="S3.E3.m1.6.7"><eq id="S3.E3.m1.6.7.1.cmml" xref="S3.E3.m1.6.7.1"></eq><apply id="S3.E3.m1.6.7.2.cmml" xref="S3.E3.m1.6.7.2"><csymbol cd="ambiguous" id="S3.E3.m1.6.7.2.1.cmml" xref="S3.E3.m1.6.7.2">superscript</csymbol><apply id="S3.E3.m1.6.7.2.2.cmml" xref="S3.E3.m1.6.7.2"><csymbol cd="ambiguous" id="S3.E3.m1.6.7.2.2.1.cmml" xref="S3.E3.m1.6.7.2">subscript</csymbol><ci id="S3.E3.m1.6.7.2.2.2.cmml" xref="S3.E3.m1.6.7.2.2.2">𝑝</ci><list id="S3.E3.m1.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.4"><ci id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1">𝑡</ci><ci id="S3.E3.m1.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2">𝑣</ci></list></apply><ci id="S3.E3.m1.6.7.2.3.cmml" xref="S3.E3.m1.6.7.2.3">𝑘</ci></apply><apply id="S3.E3.m1.6.6.cmml" xref="S3.E3.m1.6.6"><divide id="S3.E3.m1.6.6.5.cmml" xref="S3.E3.m1.6.6"></divide><apply id="S3.E3.m1.4.4.2.3.cmml" xref="S3.E3.m1.4.4.2.2"><exp id="S3.E3.m1.3.3.1.1.cmml" xref="S3.E3.m1.3.3.1.1"></exp><apply id="S3.E3.m1.4.4.2.2.1.1.cmml" xref="S3.E3.m1.4.4.2.2.1.1"><ci id="S3.E3.m1.4.4.2.2.1.1.3.cmml" xref="S3.E3.m1.4.4.2.2.1.1.3">⋅</ci><apply id="S3.E3.m1.4.4.2.2.1.1.4.cmml" xref="S3.E3.m1.4.4.2.2.1.1.4"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.2.2.1.1.4.1.cmml" xref="S3.E3.m1.4.4.2.2.1.1.4">superscript</csymbol><ci id="S3.E3.m1.4.4.2.2.1.1.4.2.cmml" xref="S3.E3.m1.4.4.2.2.1.1.4.2">𝜏</ci><ci id="S3.E3.m1.4.4.2.2.1.1.4.3.cmml" xref="S3.E3.m1.4.4.2.2.1.1.4.3">′</ci></apply><list id="S3.E3.m1.4.4.2.2.1.1.2.3.cmml" xref="S3.E3.m1.4.4.2.2.1.1.2.2"><apply id="S3.E3.m1.4.4.2.2.1.1.1.1.1.cmml" xref="S3.E3.m1.4.4.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.2.2.1.1.1.1.1.1.cmml" xref="S3.E3.m1.4.4.2.2.1.1.1.1.1">superscript</csymbol><apply id="S3.E3.m1.4.4.2.2.1.1.1.1.1.2.cmml" xref="S3.E3.m1.4.4.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.2.2.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.4.4.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.4.4.2.2.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.4.4.2.2.1.1.1.1.1.2.2">𝑓</ci><ci id="S3.E3.m1.4.4.2.2.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.4.4.2.2.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S3.E3.m1.4.4.2.2.1.1.1.1.1.3.cmml" xref="S3.E3.m1.4.4.2.2.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.E3.m1.4.4.2.2.1.1.2.2.2.cmml" xref="S3.E3.m1.4.4.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.2.2.1.1.2.2.2.1.cmml" xref="S3.E3.m1.4.4.2.2.1.1.2.2.2">superscript</csymbol><apply id="S3.E3.m1.4.4.2.2.1.1.2.2.2.2.cmml" xref="S3.E3.m1.4.4.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.2.2.1.1.2.2.2.2.1.cmml" xref="S3.E3.m1.4.4.2.2.1.1.2.2.2">subscript</csymbol><ci id="S3.E3.m1.4.4.2.2.1.1.2.2.2.2.2.cmml" xref="S3.E3.m1.4.4.2.2.1.1.2.2.2.2.2">𝑓</ci><ci id="S3.E3.m1.4.4.2.2.1.1.2.2.2.2.3.cmml" xref="S3.E3.m1.4.4.2.2.1.1.2.2.2.2.3">𝑣</ci></apply><ci id="S3.E3.m1.4.4.2.2.1.1.2.2.2.3.cmml" xref="S3.E3.m1.4.4.2.2.1.1.2.2.2.3">𝑘</ci></apply></list></apply></apply><apply id="S3.E3.m1.6.6.4.cmml" xref="S3.E3.m1.6.6.4"><apply id="S3.E3.m1.6.6.4.3.cmml" xref="S3.E3.m1.6.6.4.3"><csymbol cd="ambiguous" id="S3.E3.m1.6.6.4.3.1.cmml" xref="S3.E3.m1.6.6.4.3">superscript</csymbol><apply id="S3.E3.m1.6.6.4.3.2.cmml" xref="S3.E3.m1.6.6.4.3"><csymbol cd="ambiguous" id="S3.E3.m1.6.6.4.3.2.1.cmml" xref="S3.E3.m1.6.6.4.3">subscript</csymbol><sum id="S3.E3.m1.6.6.4.3.2.2.cmml" xref="S3.E3.m1.6.6.4.3.2.2"></sum><apply id="S3.E3.m1.6.6.4.3.2.3.cmml" xref="S3.E3.m1.6.6.4.3.2.3"><eq id="S3.E3.m1.6.6.4.3.2.3.1.cmml" xref="S3.E3.m1.6.6.4.3.2.3.1"></eq><ci id="S3.E3.m1.6.6.4.3.2.3.2.cmml" xref="S3.E3.m1.6.6.4.3.2.3.2">𝑙</ci><cn type="integer" id="S3.E3.m1.6.6.4.3.2.3.3.cmml" xref="S3.E3.m1.6.6.4.3.2.3.3">0</cn></apply></apply><apply id="S3.E3.m1.6.6.4.3.3.cmml" xref="S3.E3.m1.6.6.4.3.3"><minus id="S3.E3.m1.6.6.4.3.3.1.cmml" xref="S3.E3.m1.6.6.4.3.3.1"></minus><ci id="S3.E3.m1.6.6.4.3.3.2.cmml" xref="S3.E3.m1.6.6.4.3.3.2">𝐺</ci><cn type="integer" id="S3.E3.m1.6.6.4.3.3.3.cmml" xref="S3.E3.m1.6.6.4.3.3.3">1</cn></apply></apply><apply id="S3.E3.m1.6.6.4.2.2.cmml" xref="S3.E3.m1.6.6.4.2.1"><exp id="S3.E3.m1.5.5.3.1.cmml" xref="S3.E3.m1.5.5.3.1"></exp><apply id="S3.E3.m1.6.6.4.2.1.1.1.cmml" xref="S3.E3.m1.6.6.4.2.1.1.1"><ci id="S3.E3.m1.6.6.4.2.1.1.1.3.cmml" xref="S3.E3.m1.6.6.4.2.1.1.1.3">⋅</ci><apply id="S3.E3.m1.6.6.4.2.1.1.1.4.cmml" xref="S3.E3.m1.6.6.4.2.1.1.1.4"><csymbol cd="ambiguous" id="S3.E3.m1.6.6.4.2.1.1.1.4.1.cmml" xref="S3.E3.m1.6.6.4.2.1.1.1.4">superscript</csymbol><ci id="S3.E3.m1.6.6.4.2.1.1.1.4.2.cmml" xref="S3.E3.m1.6.6.4.2.1.1.1.4.2">𝜏</ci><ci id="S3.E3.m1.6.6.4.2.1.1.1.4.3.cmml" xref="S3.E3.m1.6.6.4.2.1.1.1.4.3">′</ci></apply><list id="S3.E3.m1.6.6.4.2.1.1.1.2.3.cmml" xref="S3.E3.m1.6.6.4.2.1.1.1.2.2"><apply id="S3.E3.m1.6.6.4.2.1.1.1.1.1.1.cmml" xref="S3.E3.m1.6.6.4.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.6.6.4.2.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.6.6.4.2.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E3.m1.6.6.4.2.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.6.6.4.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.6.6.4.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.6.6.4.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.6.6.4.2.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.6.6.4.2.1.1.1.1.1.1.2.2">𝑓</ci><ci id="S3.E3.m1.6.6.4.2.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.6.6.4.2.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S3.E3.m1.6.6.4.2.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.6.6.4.2.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.E3.m1.6.6.4.2.1.1.1.2.2.2.cmml" xref="S3.E3.m1.6.6.4.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.6.6.4.2.1.1.1.2.2.2.1.cmml" xref="S3.E3.m1.6.6.4.2.1.1.1.2.2.2">superscript</csymbol><apply id="S3.E3.m1.6.6.4.2.1.1.1.2.2.2.2.cmml" xref="S3.E3.m1.6.6.4.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.6.6.4.2.1.1.1.2.2.2.2.1.cmml" xref="S3.E3.m1.6.6.4.2.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E3.m1.6.6.4.2.1.1.1.2.2.2.2.2.cmml" xref="S3.E3.m1.6.6.4.2.1.1.1.2.2.2.2.2">𝑓</ci><ci id="S3.E3.m1.6.6.4.2.1.1.1.2.2.2.2.3.cmml" xref="S3.E3.m1.6.6.4.2.1.1.1.2.2.2.2.3">𝑣</ci></apply><ci id="S3.E3.m1.6.6.4.2.1.1.1.2.2.2.3.cmml" xref="S3.E3.m1.6.6.4.2.1.1.1.2.2.2.3">𝑙</ci></apply></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.6c">\displaystyle p_{t,v}^{k}=\frac{\exp(\tau^{\prime}\cdot\langle f_{t}^{k},f_{v}^{k}\rangle)}{\sum_{l=0}^{G-1}\exp(\tau^{\prime}\cdot\langle f_{t}^{k},f_{v}^{l}\rangle)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
<tbody id="S3.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E4.m1.7" class="ltx_Math" alttext="\displaystyle p_{v,t}^{k}=\frac{\exp(\tau^{\prime}\cdot\langle f_{v}^{k},f_{t}^{k}\rangle)}{\sum_{l=0}^{G-1}\exp(\tau^{\prime}\cdot\langle f_{v}^{k},f_{t}^{l}\rangle)}," display="inline"><semantics id="S3.E4.m1.7a"><mrow id="S3.E4.m1.7.7.1" xref="S3.E4.m1.7.7.1.1.cmml"><mrow id="S3.E4.m1.7.7.1.1" xref="S3.E4.m1.7.7.1.1.cmml"><msubsup id="S3.E4.m1.7.7.1.1.2" xref="S3.E4.m1.7.7.1.1.2.cmml"><mi id="S3.E4.m1.7.7.1.1.2.2.2" xref="S3.E4.m1.7.7.1.1.2.2.2.cmml">p</mi><mrow id="S3.E4.m1.2.2.2.4" xref="S3.E4.m1.2.2.2.3.cmml"><mi id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml">v</mi><mo id="S3.E4.m1.2.2.2.4.1" xref="S3.E4.m1.2.2.2.3.cmml">,</mo><mi id="S3.E4.m1.2.2.2.2" xref="S3.E4.m1.2.2.2.2.cmml">t</mi></mrow><mi id="S3.E4.m1.7.7.1.1.2.3" xref="S3.E4.m1.7.7.1.1.2.3.cmml">k</mi></msubsup><mo id="S3.E4.m1.7.7.1.1.1" xref="S3.E4.m1.7.7.1.1.1.cmml">=</mo><mstyle displaystyle="true" id="S3.E4.m1.6.6" xref="S3.E4.m1.6.6.cmml"><mfrac id="S3.E4.m1.6.6a" xref="S3.E4.m1.6.6.cmml"><mrow id="S3.E4.m1.4.4.2.2" xref="S3.E4.m1.4.4.2.3.cmml"><mi id="S3.E4.m1.3.3.1.1" xref="S3.E4.m1.3.3.1.1.cmml">exp</mi><mo id="S3.E4.m1.4.4.2.2a" xref="S3.E4.m1.4.4.2.3.cmml">⁡</mo><mrow id="S3.E4.m1.4.4.2.2.1" xref="S3.E4.m1.4.4.2.3.cmml"><mo stretchy="false" id="S3.E4.m1.4.4.2.2.1.2" xref="S3.E4.m1.4.4.2.3.cmml">(</mo><mrow id="S3.E4.m1.4.4.2.2.1.1" xref="S3.E4.m1.4.4.2.2.1.1.cmml"><msup id="S3.E4.m1.4.4.2.2.1.1.4" xref="S3.E4.m1.4.4.2.2.1.1.4.cmml"><mi id="S3.E4.m1.4.4.2.2.1.1.4.2" xref="S3.E4.m1.4.4.2.2.1.1.4.2.cmml">τ</mi><mo id="S3.E4.m1.4.4.2.2.1.1.4.3" xref="S3.E4.m1.4.4.2.2.1.1.4.3.cmml">′</mo></msup><mo lspace="0.222em" rspace="0.222em" id="S3.E4.m1.4.4.2.2.1.1.3" xref="S3.E4.m1.4.4.2.2.1.1.3.cmml">⋅</mo><mrow id="S3.E4.m1.4.4.2.2.1.1.2.2" xref="S3.E4.m1.4.4.2.2.1.1.2.3.cmml"><mo stretchy="false" id="S3.E4.m1.4.4.2.2.1.1.2.2.3" xref="S3.E4.m1.4.4.2.2.1.1.2.3.cmml">⟨</mo><msubsup id="S3.E4.m1.4.4.2.2.1.1.1.1.1" xref="S3.E4.m1.4.4.2.2.1.1.1.1.1.cmml"><mi id="S3.E4.m1.4.4.2.2.1.1.1.1.1.2.2" xref="S3.E4.m1.4.4.2.2.1.1.1.1.1.2.2.cmml">f</mi><mi id="S3.E4.m1.4.4.2.2.1.1.1.1.1.2.3" xref="S3.E4.m1.4.4.2.2.1.1.1.1.1.2.3.cmml">v</mi><mi id="S3.E4.m1.4.4.2.2.1.1.1.1.1.3" xref="S3.E4.m1.4.4.2.2.1.1.1.1.1.3.cmml">k</mi></msubsup><mo id="S3.E4.m1.4.4.2.2.1.1.2.2.4" xref="S3.E4.m1.4.4.2.2.1.1.2.3.cmml">,</mo><msubsup id="S3.E4.m1.4.4.2.2.1.1.2.2.2" xref="S3.E4.m1.4.4.2.2.1.1.2.2.2.cmml"><mi id="S3.E4.m1.4.4.2.2.1.1.2.2.2.2.2" xref="S3.E4.m1.4.4.2.2.1.1.2.2.2.2.2.cmml">f</mi><mi id="S3.E4.m1.4.4.2.2.1.1.2.2.2.2.3" xref="S3.E4.m1.4.4.2.2.1.1.2.2.2.2.3.cmml">t</mi><mi id="S3.E4.m1.4.4.2.2.1.1.2.2.2.3" xref="S3.E4.m1.4.4.2.2.1.1.2.2.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="S3.E4.m1.4.4.2.2.1.1.2.2.5" xref="S3.E4.m1.4.4.2.2.1.1.2.3.cmml">⟩</mo></mrow></mrow><mo stretchy="false" id="S3.E4.m1.4.4.2.2.1.3" xref="S3.E4.m1.4.4.2.3.cmml">)</mo></mrow></mrow><mrow id="S3.E4.m1.6.6.4" xref="S3.E4.m1.6.6.4.cmml"><msubsup id="S3.E4.m1.6.6.4.3" xref="S3.E4.m1.6.6.4.3.cmml"><mo id="S3.E4.m1.6.6.4.3.2.2" xref="S3.E4.m1.6.6.4.3.2.2.cmml">∑</mo><mrow id="S3.E4.m1.6.6.4.3.2.3" xref="S3.E4.m1.6.6.4.3.2.3.cmml"><mi id="S3.E4.m1.6.6.4.3.2.3.2" xref="S3.E4.m1.6.6.4.3.2.3.2.cmml">l</mi><mo id="S3.E4.m1.6.6.4.3.2.3.1" xref="S3.E4.m1.6.6.4.3.2.3.1.cmml">=</mo><mn id="S3.E4.m1.6.6.4.3.2.3.3" xref="S3.E4.m1.6.6.4.3.2.3.3.cmml">0</mn></mrow><mrow id="S3.E4.m1.6.6.4.3.3" xref="S3.E4.m1.6.6.4.3.3.cmml"><mi id="S3.E4.m1.6.6.4.3.3.2" xref="S3.E4.m1.6.6.4.3.3.2.cmml">G</mi><mo id="S3.E4.m1.6.6.4.3.3.1" xref="S3.E4.m1.6.6.4.3.3.1.cmml">−</mo><mn id="S3.E4.m1.6.6.4.3.3.3" xref="S3.E4.m1.6.6.4.3.3.3.cmml">1</mn></mrow></msubsup><mrow id="S3.E4.m1.6.6.4.2.1" xref="S3.E4.m1.6.6.4.2.2.cmml"><mi id="S3.E4.m1.5.5.3.1" xref="S3.E4.m1.5.5.3.1.cmml">exp</mi><mo id="S3.E4.m1.6.6.4.2.1a" xref="S3.E4.m1.6.6.4.2.2.cmml">⁡</mo><mrow id="S3.E4.m1.6.6.4.2.1.1" xref="S3.E4.m1.6.6.4.2.2.cmml"><mo stretchy="false" id="S3.E4.m1.6.6.4.2.1.1.2" xref="S3.E4.m1.6.6.4.2.2.cmml">(</mo><mrow id="S3.E4.m1.6.6.4.2.1.1.1" xref="S3.E4.m1.6.6.4.2.1.1.1.cmml"><msup id="S3.E4.m1.6.6.4.2.1.1.1.4" xref="S3.E4.m1.6.6.4.2.1.1.1.4.cmml"><mi id="S3.E4.m1.6.6.4.2.1.1.1.4.2" xref="S3.E4.m1.6.6.4.2.1.1.1.4.2.cmml">τ</mi><mo id="S3.E4.m1.6.6.4.2.1.1.1.4.3" xref="S3.E4.m1.6.6.4.2.1.1.1.4.3.cmml">′</mo></msup><mo lspace="0.222em" rspace="0.222em" id="S3.E4.m1.6.6.4.2.1.1.1.3" xref="S3.E4.m1.6.6.4.2.1.1.1.3.cmml">⋅</mo><mrow id="S3.E4.m1.6.6.4.2.1.1.1.2.2" xref="S3.E4.m1.6.6.4.2.1.1.1.2.3.cmml"><mo stretchy="false" id="S3.E4.m1.6.6.4.2.1.1.1.2.2.3" xref="S3.E4.m1.6.6.4.2.1.1.1.2.3.cmml">⟨</mo><msubsup id="S3.E4.m1.6.6.4.2.1.1.1.1.1.1" xref="S3.E4.m1.6.6.4.2.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.6.6.4.2.1.1.1.1.1.1.2.2" xref="S3.E4.m1.6.6.4.2.1.1.1.1.1.1.2.2.cmml">f</mi><mi id="S3.E4.m1.6.6.4.2.1.1.1.1.1.1.2.3" xref="S3.E4.m1.6.6.4.2.1.1.1.1.1.1.2.3.cmml">v</mi><mi id="S3.E4.m1.6.6.4.2.1.1.1.1.1.1.3" xref="S3.E4.m1.6.6.4.2.1.1.1.1.1.1.3.cmml">k</mi></msubsup><mo id="S3.E4.m1.6.6.4.2.1.1.1.2.2.4" xref="S3.E4.m1.6.6.4.2.1.1.1.2.3.cmml">,</mo><msubsup id="S3.E4.m1.6.6.4.2.1.1.1.2.2.2" xref="S3.E4.m1.6.6.4.2.1.1.1.2.2.2.cmml"><mi id="S3.E4.m1.6.6.4.2.1.1.1.2.2.2.2.2" xref="S3.E4.m1.6.6.4.2.1.1.1.2.2.2.2.2.cmml">f</mi><mi id="S3.E4.m1.6.6.4.2.1.1.1.2.2.2.2.3" xref="S3.E4.m1.6.6.4.2.1.1.1.2.2.2.2.3.cmml">t</mi><mi id="S3.E4.m1.6.6.4.2.1.1.1.2.2.2.3" xref="S3.E4.m1.6.6.4.2.1.1.1.2.2.2.3.cmml">l</mi></msubsup><mo stretchy="false" id="S3.E4.m1.6.6.4.2.1.1.1.2.2.5" xref="S3.E4.m1.6.6.4.2.1.1.1.2.3.cmml">⟩</mo></mrow></mrow><mo stretchy="false" id="S3.E4.m1.6.6.4.2.1.1.3" xref="S3.E4.m1.6.6.4.2.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle></mrow><mo id="S3.E4.m1.7.7.1.2" xref="S3.E4.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.7b"><apply id="S3.E4.m1.7.7.1.1.cmml" xref="S3.E4.m1.7.7.1"><eq id="S3.E4.m1.7.7.1.1.1.cmml" xref="S3.E4.m1.7.7.1.1.1"></eq><apply id="S3.E4.m1.7.7.1.1.2.cmml" xref="S3.E4.m1.7.7.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.1.2.1.cmml" xref="S3.E4.m1.7.7.1.1.2">superscript</csymbol><apply id="S3.E4.m1.7.7.1.1.2.2.cmml" xref="S3.E4.m1.7.7.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.1.2.2.1.cmml" xref="S3.E4.m1.7.7.1.1.2">subscript</csymbol><ci id="S3.E4.m1.7.7.1.1.2.2.2.cmml" xref="S3.E4.m1.7.7.1.1.2.2.2">𝑝</ci><list id="S3.E4.m1.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.4"><ci id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1">𝑣</ci><ci id="S3.E4.m1.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2">𝑡</ci></list></apply><ci id="S3.E4.m1.7.7.1.1.2.3.cmml" xref="S3.E4.m1.7.7.1.1.2.3">𝑘</ci></apply><apply id="S3.E4.m1.6.6.cmml" xref="S3.E4.m1.6.6"><divide id="S3.E4.m1.6.6.5.cmml" xref="S3.E4.m1.6.6"></divide><apply id="S3.E4.m1.4.4.2.3.cmml" xref="S3.E4.m1.4.4.2.2"><exp id="S3.E4.m1.3.3.1.1.cmml" xref="S3.E4.m1.3.3.1.1"></exp><apply id="S3.E4.m1.4.4.2.2.1.1.cmml" xref="S3.E4.m1.4.4.2.2.1.1"><ci id="S3.E4.m1.4.4.2.2.1.1.3.cmml" xref="S3.E4.m1.4.4.2.2.1.1.3">⋅</ci><apply id="S3.E4.m1.4.4.2.2.1.1.4.cmml" xref="S3.E4.m1.4.4.2.2.1.1.4"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.2.2.1.1.4.1.cmml" xref="S3.E4.m1.4.4.2.2.1.1.4">superscript</csymbol><ci id="S3.E4.m1.4.4.2.2.1.1.4.2.cmml" xref="S3.E4.m1.4.4.2.2.1.1.4.2">𝜏</ci><ci id="S3.E4.m1.4.4.2.2.1.1.4.3.cmml" xref="S3.E4.m1.4.4.2.2.1.1.4.3">′</ci></apply><list id="S3.E4.m1.4.4.2.2.1.1.2.3.cmml" xref="S3.E4.m1.4.4.2.2.1.1.2.2"><apply id="S3.E4.m1.4.4.2.2.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.2.2.1.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.2.2.1.1.1.1.1">superscript</csymbol><apply id="S3.E4.m1.4.4.2.2.1.1.1.1.1.2.cmml" xref="S3.E4.m1.4.4.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.2.2.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.4.4.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.4.4.2.2.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.4.4.2.2.1.1.1.1.1.2.2">𝑓</ci><ci id="S3.E4.m1.4.4.2.2.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.4.4.2.2.1.1.1.1.1.2.3">𝑣</ci></apply><ci id="S3.E4.m1.4.4.2.2.1.1.1.1.1.3.cmml" xref="S3.E4.m1.4.4.2.2.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.E4.m1.4.4.2.2.1.1.2.2.2.cmml" xref="S3.E4.m1.4.4.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.2.2.1.1.2.2.2.1.cmml" xref="S3.E4.m1.4.4.2.2.1.1.2.2.2">superscript</csymbol><apply id="S3.E4.m1.4.4.2.2.1.1.2.2.2.2.cmml" xref="S3.E4.m1.4.4.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.2.2.1.1.2.2.2.2.1.cmml" xref="S3.E4.m1.4.4.2.2.1.1.2.2.2">subscript</csymbol><ci id="S3.E4.m1.4.4.2.2.1.1.2.2.2.2.2.cmml" xref="S3.E4.m1.4.4.2.2.1.1.2.2.2.2.2">𝑓</ci><ci id="S3.E4.m1.4.4.2.2.1.1.2.2.2.2.3.cmml" xref="S3.E4.m1.4.4.2.2.1.1.2.2.2.2.3">𝑡</ci></apply><ci id="S3.E4.m1.4.4.2.2.1.1.2.2.2.3.cmml" xref="S3.E4.m1.4.4.2.2.1.1.2.2.2.3">𝑘</ci></apply></list></apply></apply><apply id="S3.E4.m1.6.6.4.cmml" xref="S3.E4.m1.6.6.4"><apply id="S3.E4.m1.6.6.4.3.cmml" xref="S3.E4.m1.6.6.4.3"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.4.3.1.cmml" xref="S3.E4.m1.6.6.4.3">superscript</csymbol><apply id="S3.E4.m1.6.6.4.3.2.cmml" xref="S3.E4.m1.6.6.4.3"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.4.3.2.1.cmml" xref="S3.E4.m1.6.6.4.3">subscript</csymbol><sum id="S3.E4.m1.6.6.4.3.2.2.cmml" xref="S3.E4.m1.6.6.4.3.2.2"></sum><apply id="S3.E4.m1.6.6.4.3.2.3.cmml" xref="S3.E4.m1.6.6.4.3.2.3"><eq id="S3.E4.m1.6.6.4.3.2.3.1.cmml" xref="S3.E4.m1.6.6.4.3.2.3.1"></eq><ci id="S3.E4.m1.6.6.4.3.2.3.2.cmml" xref="S3.E4.m1.6.6.4.3.2.3.2">𝑙</ci><cn type="integer" id="S3.E4.m1.6.6.4.3.2.3.3.cmml" xref="S3.E4.m1.6.6.4.3.2.3.3">0</cn></apply></apply><apply id="S3.E4.m1.6.6.4.3.3.cmml" xref="S3.E4.m1.6.6.4.3.3"><minus id="S3.E4.m1.6.6.4.3.3.1.cmml" xref="S3.E4.m1.6.6.4.3.3.1"></minus><ci id="S3.E4.m1.6.6.4.3.3.2.cmml" xref="S3.E4.m1.6.6.4.3.3.2">𝐺</ci><cn type="integer" id="S3.E4.m1.6.6.4.3.3.3.cmml" xref="S3.E4.m1.6.6.4.3.3.3">1</cn></apply></apply><apply id="S3.E4.m1.6.6.4.2.2.cmml" xref="S3.E4.m1.6.6.4.2.1"><exp id="S3.E4.m1.5.5.3.1.cmml" xref="S3.E4.m1.5.5.3.1"></exp><apply id="S3.E4.m1.6.6.4.2.1.1.1.cmml" xref="S3.E4.m1.6.6.4.2.1.1.1"><ci id="S3.E4.m1.6.6.4.2.1.1.1.3.cmml" xref="S3.E4.m1.6.6.4.2.1.1.1.3">⋅</ci><apply id="S3.E4.m1.6.6.4.2.1.1.1.4.cmml" xref="S3.E4.m1.6.6.4.2.1.1.1.4"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.4.2.1.1.1.4.1.cmml" xref="S3.E4.m1.6.6.4.2.1.1.1.4">superscript</csymbol><ci id="S3.E4.m1.6.6.4.2.1.1.1.4.2.cmml" xref="S3.E4.m1.6.6.4.2.1.1.1.4.2">𝜏</ci><ci id="S3.E4.m1.6.6.4.2.1.1.1.4.3.cmml" xref="S3.E4.m1.6.6.4.2.1.1.1.4.3">′</ci></apply><list id="S3.E4.m1.6.6.4.2.1.1.1.2.3.cmml" xref="S3.E4.m1.6.6.4.2.1.1.1.2.2"><apply id="S3.E4.m1.6.6.4.2.1.1.1.1.1.1.cmml" xref="S3.E4.m1.6.6.4.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.4.2.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.6.6.4.2.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E4.m1.6.6.4.2.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.6.6.4.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.4.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.6.6.4.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.6.6.4.2.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.6.6.4.2.1.1.1.1.1.1.2.2">𝑓</ci><ci id="S3.E4.m1.6.6.4.2.1.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.6.6.4.2.1.1.1.1.1.1.2.3">𝑣</ci></apply><ci id="S3.E4.m1.6.6.4.2.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.6.6.4.2.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.E4.m1.6.6.4.2.1.1.1.2.2.2.cmml" xref="S3.E4.m1.6.6.4.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.4.2.1.1.1.2.2.2.1.cmml" xref="S3.E4.m1.6.6.4.2.1.1.1.2.2.2">superscript</csymbol><apply id="S3.E4.m1.6.6.4.2.1.1.1.2.2.2.2.cmml" xref="S3.E4.m1.6.6.4.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.4.2.1.1.1.2.2.2.2.1.cmml" xref="S3.E4.m1.6.6.4.2.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E4.m1.6.6.4.2.1.1.1.2.2.2.2.2.cmml" xref="S3.E4.m1.6.6.4.2.1.1.1.2.2.2.2.2">𝑓</ci><ci id="S3.E4.m1.6.6.4.2.1.1.1.2.2.2.2.3.cmml" xref="S3.E4.m1.6.6.4.2.1.1.1.2.2.2.2.3">𝑡</ci></apply><ci id="S3.E4.m1.6.6.4.2.1.1.1.2.2.2.3.cmml" xref="S3.E4.m1.6.6.4.2.1.1.1.2.2.2.3">𝑙</ci></apply></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.7c">\displaystyle p_{v,t}^{k}=\frac{\exp(\tau^{\prime}\cdot\langle f_{v}^{k},f_{t}^{k}\rangle)}{\sum_{l=0}^{G-1}\exp(\tau^{\prime}\cdot\langle f_{v}^{k},f_{t}^{l}\rangle)},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p2.5" class="ltx_p">respectively, where <math id="S3.SS4.p2.3.m1.1" class="ltx_Math" alttext="\tau^{\prime}" display="inline"><semantics id="S3.SS4.p2.3.m1.1a"><msup id="S3.SS4.p2.3.m1.1.1" xref="S3.SS4.p2.3.m1.1.1.cmml"><mi id="S3.SS4.p2.3.m1.1.1.2" xref="S3.SS4.p2.3.m1.1.1.2.cmml">τ</mi><mo id="S3.SS4.p2.3.m1.1.1.3" xref="S3.SS4.p2.3.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.3.m1.1b"><apply id="S3.SS4.p2.3.m1.1.1.cmml" xref="S3.SS4.p2.3.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.3.m1.1.1.1.cmml" xref="S3.SS4.p2.3.m1.1.1">superscript</csymbol><ci id="S3.SS4.p2.3.m1.1.1.2.cmml" xref="S3.SS4.p2.3.m1.1.1.2">𝜏</ci><ci id="S3.SS4.p2.3.m1.1.1.3.cmml" xref="S3.SS4.p2.3.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.3.m1.1c">\tau^{\prime}</annotation></semantics></math> is the temperature to re-scale the cosine similarity. The loss pulls positive pairs <math id="S3.SS4.p2.4.m2.2" class="ltx_Math" alttext="\{f_{t}^{k},f_{v}^{k}\}" display="inline"><semantics id="S3.SS4.p2.4.m2.2a"><mrow id="S3.SS4.p2.4.m2.2.2.2" xref="S3.SS4.p2.4.m2.2.2.3.cmml"><mo stretchy="false" id="S3.SS4.p2.4.m2.2.2.2.3" xref="S3.SS4.p2.4.m2.2.2.3.cmml">{</mo><msubsup id="S3.SS4.p2.4.m2.1.1.1.1" xref="S3.SS4.p2.4.m2.1.1.1.1.cmml"><mi id="S3.SS4.p2.4.m2.1.1.1.1.2.2" xref="S3.SS4.p2.4.m2.1.1.1.1.2.2.cmml">f</mi><mi id="S3.SS4.p2.4.m2.1.1.1.1.2.3" xref="S3.SS4.p2.4.m2.1.1.1.1.2.3.cmml">t</mi><mi id="S3.SS4.p2.4.m2.1.1.1.1.3" xref="S3.SS4.p2.4.m2.1.1.1.1.3.cmml">k</mi></msubsup><mo id="S3.SS4.p2.4.m2.2.2.2.4" xref="S3.SS4.p2.4.m2.2.2.3.cmml">,</mo><msubsup id="S3.SS4.p2.4.m2.2.2.2.2" xref="S3.SS4.p2.4.m2.2.2.2.2.cmml"><mi id="S3.SS4.p2.4.m2.2.2.2.2.2.2" xref="S3.SS4.p2.4.m2.2.2.2.2.2.2.cmml">f</mi><mi id="S3.SS4.p2.4.m2.2.2.2.2.2.3" xref="S3.SS4.p2.4.m2.2.2.2.2.2.3.cmml">v</mi><mi id="S3.SS4.p2.4.m2.2.2.2.2.3" xref="S3.SS4.p2.4.m2.2.2.2.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="S3.SS4.p2.4.m2.2.2.2.5" xref="S3.SS4.p2.4.m2.2.2.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.4.m2.2b"><set id="S3.SS4.p2.4.m2.2.2.3.cmml" xref="S3.SS4.p2.4.m2.2.2.2"><apply id="S3.SS4.p2.4.m2.1.1.1.1.cmml" xref="S3.SS4.p2.4.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.4.m2.1.1.1.1.1.cmml" xref="S3.SS4.p2.4.m2.1.1.1.1">superscript</csymbol><apply id="S3.SS4.p2.4.m2.1.1.1.1.2.cmml" xref="S3.SS4.p2.4.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.4.m2.1.1.1.1.2.1.cmml" xref="S3.SS4.p2.4.m2.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p2.4.m2.1.1.1.1.2.2.cmml" xref="S3.SS4.p2.4.m2.1.1.1.1.2.2">𝑓</ci><ci id="S3.SS4.p2.4.m2.1.1.1.1.2.3.cmml" xref="S3.SS4.p2.4.m2.1.1.1.1.2.3">𝑡</ci></apply><ci id="S3.SS4.p2.4.m2.1.1.1.1.3.cmml" xref="S3.SS4.p2.4.m2.1.1.1.1.3">𝑘</ci></apply><apply id="S3.SS4.p2.4.m2.2.2.2.2.cmml" xref="S3.SS4.p2.4.m2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p2.4.m2.2.2.2.2.1.cmml" xref="S3.SS4.p2.4.m2.2.2.2.2">superscript</csymbol><apply id="S3.SS4.p2.4.m2.2.2.2.2.2.cmml" xref="S3.SS4.p2.4.m2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p2.4.m2.2.2.2.2.2.1.cmml" xref="S3.SS4.p2.4.m2.2.2.2.2">subscript</csymbol><ci id="S3.SS4.p2.4.m2.2.2.2.2.2.2.cmml" xref="S3.SS4.p2.4.m2.2.2.2.2.2.2">𝑓</ci><ci id="S3.SS4.p2.4.m2.2.2.2.2.2.3.cmml" xref="S3.SS4.p2.4.m2.2.2.2.2.2.3">𝑣</ci></apply><ci id="S3.SS4.p2.4.m2.2.2.2.2.3.cmml" xref="S3.SS4.p2.4.m2.2.2.2.2.3">𝑘</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.4.m2.2c">\{f_{t}^{k},f_{v}^{k}\}</annotation></semantics></math> close to each other and pushes away negative pairs <math id="S3.SS4.p2.5.m3.3" class="ltx_Math" alttext="\{f_{t}^{k},f_{v}^{l}\}(k\neq l)" display="inline"><semantics id="S3.SS4.p2.5.m3.3a"><mrow id="S3.SS4.p2.5.m3.3.3" xref="S3.SS4.p2.5.m3.3.3.cmml"><mrow id="S3.SS4.p2.5.m3.2.2.2.2" xref="S3.SS4.p2.5.m3.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS4.p2.5.m3.2.2.2.2.3" xref="S3.SS4.p2.5.m3.2.2.2.3.cmml">{</mo><msubsup id="S3.SS4.p2.5.m3.1.1.1.1.1" xref="S3.SS4.p2.5.m3.1.1.1.1.1.cmml"><mi id="S3.SS4.p2.5.m3.1.1.1.1.1.2.2" xref="S3.SS4.p2.5.m3.1.1.1.1.1.2.2.cmml">f</mi><mi id="S3.SS4.p2.5.m3.1.1.1.1.1.2.3" xref="S3.SS4.p2.5.m3.1.1.1.1.1.2.3.cmml">t</mi><mi id="S3.SS4.p2.5.m3.1.1.1.1.1.3" xref="S3.SS4.p2.5.m3.1.1.1.1.1.3.cmml">k</mi></msubsup><mo id="S3.SS4.p2.5.m3.2.2.2.2.4" xref="S3.SS4.p2.5.m3.2.2.2.3.cmml">,</mo><msubsup id="S3.SS4.p2.5.m3.2.2.2.2.2" xref="S3.SS4.p2.5.m3.2.2.2.2.2.cmml"><mi id="S3.SS4.p2.5.m3.2.2.2.2.2.2.2" xref="S3.SS4.p2.5.m3.2.2.2.2.2.2.2.cmml">f</mi><mi id="S3.SS4.p2.5.m3.2.2.2.2.2.2.3" xref="S3.SS4.p2.5.m3.2.2.2.2.2.2.3.cmml">v</mi><mi id="S3.SS4.p2.5.m3.2.2.2.2.2.3" xref="S3.SS4.p2.5.m3.2.2.2.2.2.3.cmml">l</mi></msubsup><mo stretchy="false" id="S3.SS4.p2.5.m3.2.2.2.2.5" xref="S3.SS4.p2.5.m3.2.2.2.3.cmml">}</mo></mrow><mo lspace="0em" rspace="0em" id="S3.SS4.p2.5.m3.3.3.4" xref="S3.SS4.p2.5.m3.3.3.4.cmml">​</mo><mrow id="S3.SS4.p2.5.m3.3.3.3.1" xref="S3.SS4.p2.5.m3.3.3.3.1.1.cmml"><mo stretchy="false" id="S3.SS4.p2.5.m3.3.3.3.1.2" xref="S3.SS4.p2.5.m3.3.3.3.1.1.cmml">(</mo><mrow id="S3.SS4.p2.5.m3.3.3.3.1.1" xref="S3.SS4.p2.5.m3.3.3.3.1.1.cmml"><mi id="S3.SS4.p2.5.m3.3.3.3.1.1.2" xref="S3.SS4.p2.5.m3.3.3.3.1.1.2.cmml">k</mi><mo id="S3.SS4.p2.5.m3.3.3.3.1.1.1" xref="S3.SS4.p2.5.m3.3.3.3.1.1.1.cmml">≠</mo><mi id="S3.SS4.p2.5.m3.3.3.3.1.1.3" xref="S3.SS4.p2.5.m3.3.3.3.1.1.3.cmml">l</mi></mrow><mo stretchy="false" id="S3.SS4.p2.5.m3.3.3.3.1.3" xref="S3.SS4.p2.5.m3.3.3.3.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.5.m3.3b"><apply id="S3.SS4.p2.5.m3.3.3.cmml" xref="S3.SS4.p2.5.m3.3.3"><times id="S3.SS4.p2.5.m3.3.3.4.cmml" xref="S3.SS4.p2.5.m3.3.3.4"></times><set id="S3.SS4.p2.5.m3.2.2.2.3.cmml" xref="S3.SS4.p2.5.m3.2.2.2.2"><apply id="S3.SS4.p2.5.m3.1.1.1.1.1.cmml" xref="S3.SS4.p2.5.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.5.m3.1.1.1.1.1.1.cmml" xref="S3.SS4.p2.5.m3.1.1.1.1.1">superscript</csymbol><apply id="S3.SS4.p2.5.m3.1.1.1.1.1.2.cmml" xref="S3.SS4.p2.5.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.5.m3.1.1.1.1.1.2.1.cmml" xref="S3.SS4.p2.5.m3.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p2.5.m3.1.1.1.1.1.2.2.cmml" xref="S3.SS4.p2.5.m3.1.1.1.1.1.2.2">𝑓</ci><ci id="S3.SS4.p2.5.m3.1.1.1.1.1.2.3.cmml" xref="S3.SS4.p2.5.m3.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S3.SS4.p2.5.m3.1.1.1.1.1.3.cmml" xref="S3.SS4.p2.5.m3.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.SS4.p2.5.m3.2.2.2.2.2.cmml" xref="S3.SS4.p2.5.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p2.5.m3.2.2.2.2.2.1.cmml" xref="S3.SS4.p2.5.m3.2.2.2.2.2">superscript</csymbol><apply id="S3.SS4.p2.5.m3.2.2.2.2.2.2.cmml" xref="S3.SS4.p2.5.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p2.5.m3.2.2.2.2.2.2.1.cmml" xref="S3.SS4.p2.5.m3.2.2.2.2.2">subscript</csymbol><ci id="S3.SS4.p2.5.m3.2.2.2.2.2.2.2.cmml" xref="S3.SS4.p2.5.m3.2.2.2.2.2.2.2">𝑓</ci><ci id="S3.SS4.p2.5.m3.2.2.2.2.2.2.3.cmml" xref="S3.SS4.p2.5.m3.2.2.2.2.2.2.3">𝑣</ci></apply><ci id="S3.SS4.p2.5.m3.2.2.2.2.2.3.cmml" xref="S3.SS4.p2.5.m3.2.2.2.2.2.3">𝑙</ci></apply></set><apply id="S3.SS4.p2.5.m3.3.3.3.1.1.cmml" xref="S3.SS4.p2.5.m3.3.3.3.1"><neq id="S3.SS4.p2.5.m3.3.3.3.1.1.1.cmml" xref="S3.SS4.p2.5.m3.3.3.3.1.1.1"></neq><ci id="S3.SS4.p2.5.m3.3.3.3.1.1.2.cmml" xref="S3.SS4.p2.5.m3.3.3.3.1.1.2">𝑘</ci><ci id="S3.SS4.p2.5.m3.3.3.3.1.1.3.cmml" xref="S3.SS4.p2.5.m3.3.3.3.1.1.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.5.m3.3c">\{f_{t}^{k},f_{v}^{l}\}(k\neq l)</annotation></semantics></math>.</p>
</div>
<div id="S3.SS4.p3" class="ltx_para">
<p id="S3.SS4.p3.1" class="ltx_p">In practice, the number of groups <math id="S3.SS4.p3.1.m1.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S3.SS4.p3.1.m1.1a"><mi id="S3.SS4.p3.1.m1.1.1" xref="S3.SS4.p3.1.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.1.m1.1b"><ci id="S3.SS4.p3.1.m1.1.1.cmml" xref="S3.SS4.p3.1.m1.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.1.m1.1c">G</annotation></semantics></math> is small for a single image. We maintain two queues to save the image and text embeddings in previous iterations during training to provide sufficient negative pairs <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>.</p>
</div>
<figure id="S3.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S3.T1.9.2.1" class="ltx_text" style="font-size:90%;">Table 1</span>: </span><span id="S3.T1.2.2.1" class="ltx_text" style="font-size:90%;">Comparison with state-of-the-art methods on OV-COCO benchmark. We separately compare our approach with methods distilling knowledge from CLIP and approaches using COCO caption. <math id="S3.T1.2.2.1.m1.1" class="ltx_Math" alttext="\dagger" display="inline"><semantics id="S3.T1.2.2.1.m1.1b"><mo id="S3.T1.2.2.1.m1.1.1" xref="S3.T1.2.2.1.m1.1.1.cmml">†</mo><annotation-xml encoding="MathML-Content" id="S3.T1.2.2.1.m1.1c"><ci id="S3.T1.2.2.1.m1.1.1.cmml" xref="S3.T1.2.2.1.m1.1.1">†</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.2.2.1.m1.1d">\dagger</annotation></semantics></math> means using proposals produced by MAVL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite>.
</span></figcaption>
<div id="S3.T1.7.7" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:400.4pt;height:194.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-22.2pt,10.8pt) scale(0.9,0.9) ;">
<table id="S3.T1.7.7.5" class="ltx_tabular ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S3.T1.5.5.3.3" class="ltx_tr">
<td id="S3.T1.5.5.3.3.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" style="padding:0.45pt 3.0pt;"><span id="S3.T1.5.5.3.3.4.1" class="ltx_text" style="font-size:90%;">Method</span></td>
<td id="S3.T1.5.5.3.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding:0.45pt 3.0pt;"><span id="S3.T1.5.5.3.3.5.1" class="ltx_text" style="font-size:90%;">Supervision</span></td>
<td id="S3.T1.5.5.3.3.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding:0.45pt 3.0pt;"><span id="S3.T1.5.5.3.3.6.1" class="ltx_text" style="font-size:90%;">Backbone</span></td>
<td id="S3.T1.5.5.3.3.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding:0.45pt 3.0pt;"><span id="S3.T1.5.5.3.3.7.1" class="ltx_text" style="font-size:90%;">Detector</span></td>
<td id="S3.T1.3.3.1.1.1" class="ltx_td ltx_align_center ltx_border_tt" style="padding:0.45pt 3.0pt;">
<span id="S3.T1.3.3.1.1.1.1" class="ltx_text" style="font-size:90%;">AP</span><math id="S3.T1.3.3.1.1.1.m1.1" class="ltx_Math" alttext="{}_{50}^{\text{novel}}" display="inline"><semantics id="S3.T1.3.3.1.1.1.m1.1a"><mmultiscripts id="S3.T1.3.3.1.1.1.m1.1.1" xref="S3.T1.3.3.1.1.1.m1.1.1.cmml"><mi id="S3.T1.3.3.1.1.1.m1.1.1.2.2" xref="S3.T1.3.3.1.1.1.m1.1.1.2.2.cmml"></mi><mprescripts id="S3.T1.3.3.1.1.1.m1.1.1a" xref="S3.T1.3.3.1.1.1.m1.1.1.cmml"></mprescripts><mrow id="S3.T1.3.3.1.1.1.m1.1.1b" xref="S3.T1.3.3.1.1.1.m1.1.1.cmml"></mrow><mtext mathsize="90%" id="S3.T1.3.3.1.1.1.m1.1.1.3" xref="S3.T1.3.3.1.1.1.m1.1.1.3a.cmml">novel</mtext><mn mathsize="90%" id="S3.T1.3.3.1.1.1.m1.1.1.2.3" xref="S3.T1.3.3.1.1.1.m1.1.1.2.3.cmml">50</mn><mrow id="S3.T1.3.3.1.1.1.m1.1.1c" xref="S3.T1.3.3.1.1.1.m1.1.1.cmml"></mrow></mmultiscripts><annotation-xml encoding="MathML-Content" id="S3.T1.3.3.1.1.1.m1.1b"><apply id="S3.T1.3.3.1.1.1.m1.1.1.cmml" xref="S3.T1.3.3.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.3.3.1.1.1.m1.1.1.1.cmml" xref="S3.T1.3.3.1.1.1.m1.1.1">superscript</csymbol><apply id="S3.T1.3.3.1.1.1.m1.1.1.2.cmml" xref="S3.T1.3.3.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.3.3.1.1.1.m1.1.1.2.1.cmml" xref="S3.T1.3.3.1.1.1.m1.1.1">subscript</csymbol><csymbol cd="latexml" id="S3.T1.3.3.1.1.1.m1.1.1.2.2.cmml" xref="S3.T1.3.3.1.1.1.m1.1.1.2.2">absent</csymbol><cn type="integer" id="S3.T1.3.3.1.1.1.m1.1.1.2.3.cmml" xref="S3.T1.3.3.1.1.1.m1.1.1.2.3">50</cn></apply><ci id="S3.T1.3.3.1.1.1.m1.1.1.3a.cmml" xref="S3.T1.3.3.1.1.1.m1.1.1.3"><mtext mathsize="63%" id="S3.T1.3.3.1.1.1.m1.1.1.3.cmml" xref="S3.T1.3.3.1.1.1.m1.1.1.3">novel</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.3.3.1.1.1.m1.1c">{}_{50}^{\text{novel}}</annotation></semantics></math>
</td>
<td id="S3.T1.4.4.2.2.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding:0.45pt 3.0pt;"><span id="S3.T1.4.4.2.2.2.1" class="ltx_text" style="font-size:90%;color:#808080;">AP<math id="S3.T1.4.4.2.2.2.1.m1.1" class="ltx_Math" alttext="{}_{50}^{\text{base}}" display="inline"><semantics id="S3.T1.4.4.2.2.2.1.m1.1a"><mmultiscripts id="S3.T1.4.4.2.2.2.1.m1.1.1" xref="S3.T1.4.4.2.2.2.1.m1.1.1.cmml"><mi id="S3.T1.4.4.2.2.2.1.m1.1.1.2.2" xref="S3.T1.4.4.2.2.2.1.m1.1.1.2.2.cmml"></mi><mprescripts id="S3.T1.4.4.2.2.2.1.m1.1.1a" xref="S3.T1.4.4.2.2.2.1.m1.1.1.cmml"></mprescripts><mrow id="S3.T1.4.4.2.2.2.1.m1.1.1b" xref="S3.T1.4.4.2.2.2.1.m1.1.1.cmml"></mrow><mtext mathcolor="#808080" id="S3.T1.4.4.2.2.2.1.m1.1.1.3" xref="S3.T1.4.4.2.2.2.1.m1.1.1.3a.cmml">base</mtext><mn mathcolor="#808080" id="S3.T1.4.4.2.2.2.1.m1.1.1.2.3" xref="S3.T1.4.4.2.2.2.1.m1.1.1.2.3.cmml">50</mn><mrow id="S3.T1.4.4.2.2.2.1.m1.1.1c" xref="S3.T1.4.4.2.2.2.1.m1.1.1.cmml"></mrow></mmultiscripts><annotation-xml encoding="MathML-Content" id="S3.T1.4.4.2.2.2.1.m1.1b"><apply id="S3.T1.4.4.2.2.2.1.m1.1.1.cmml" xref="S3.T1.4.4.2.2.2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.4.4.2.2.2.1.m1.1.1.1.cmml" xref="S3.T1.4.4.2.2.2.1.m1.1.1">superscript</csymbol><apply id="S3.T1.4.4.2.2.2.1.m1.1.1.2.cmml" xref="S3.T1.4.4.2.2.2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.4.4.2.2.2.1.m1.1.1.2.1.cmml" xref="S3.T1.4.4.2.2.2.1.m1.1.1">subscript</csymbol><csymbol cd="latexml" id="S3.T1.4.4.2.2.2.1.m1.1.1.2.2.cmml" xref="S3.T1.4.4.2.2.2.1.m1.1.1.2.2">absent</csymbol><cn type="integer" id="S3.T1.4.4.2.2.2.1.m1.1.1.2.3.cmml" xref="S3.T1.4.4.2.2.2.1.m1.1.1.2.3">50</cn></apply><ci id="S3.T1.4.4.2.2.2.1.m1.1.1.3a.cmml" xref="S3.T1.4.4.2.2.2.1.m1.1.1.3"><mtext mathcolor="#808080" mathsize="70%" id="S3.T1.4.4.2.2.2.1.m1.1.1.3.cmml" xref="S3.T1.4.4.2.2.2.1.m1.1.1.3">base</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.4.4.2.2.2.1.m1.1c">{}_{50}^{\text{base}}</annotation></semantics></math></span></td>
<td id="S3.T1.5.5.3.3.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding:0.45pt 3.0pt;"><span id="S3.T1.5.5.3.3.3.1" class="ltx_text" style="font-size:90%;color:#808080;">AP<sub id="S3.T1.5.5.3.3.3.1.1" class="ltx_sub"><span id="S3.T1.5.5.3.3.3.1.1.1" class="ltx_text ltx_font_italic">50</span></sub></span></td>
</tr>
<tr id="S3.T1.7.7.5.6.1" class="ltx_tr">
<td id="S3.T1.7.7.5.6.1.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;">
<span id="S3.T1.7.7.5.6.1.1.1" class="ltx_text" style="font-size:90%;">ViLD </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S3.T1.7.7.5.6.1.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib16" title="" class="ltx_ref">16</a><span id="S3.T1.7.7.5.6.1.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</td>
<td id="S3.T1.7.7.5.6.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.6.1.2.1" class="ltx_text" style="font-size:90%;">CLIP</span></td>
<td id="S3.T1.7.7.5.6.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.6.1.3.1" class="ltx_text" style="font-size:90%;">ResNet50-FPN</span></td>
<td id="S3.T1.7.7.5.6.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.6.1.4.1" class="ltx_text" style="font-size:90%;">FasterRCNN</span></td>
<td id="S3.T1.7.7.5.6.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.6.1.5.1" class="ltx_text" style="font-size:90%;">27.6</span></td>
<td id="S3.T1.7.7.5.6.1.6" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.6.1.6.1" class="ltx_text" style="font-size:90%;color:#808080;">59.5</span></td>
<td id="S3.T1.7.7.5.6.1.7" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.6.1.7.1" class="ltx_text" style="font-size:90%;color:#808080;">51.2</span></td>
</tr>
<tr id="S3.T1.7.7.5.7.2" class="ltx_tr">
<td id="S3.T1.7.7.5.7.2.1" class="ltx_td ltx_align_left ltx_border_r" style="padding:0.45pt 3.0pt;">
<span id="S3.T1.7.7.5.7.2.1.1" class="ltx_text" style="font-size:90%;">OV-DETR </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S3.T1.7.7.5.7.2.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib55" title="" class="ltx_ref">55</a><span id="S3.T1.7.7.5.7.2.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</td>
<td id="S3.T1.7.7.5.7.2.2" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.7.2.2.1" class="ltx_text" style="font-size:90%;">CLIP</span></td>
<td id="S3.T1.7.7.5.7.2.3" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.7.2.3.1" class="ltx_text" style="font-size:90%;">ResNet50</span></td>
<td id="S3.T1.7.7.5.7.2.4" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.7.2.4.1" class="ltx_text" style="font-size:90%;">DeformableDETR</span></td>
<td id="S3.T1.7.7.5.7.2.5" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.7.2.5.1" class="ltx_text" style="font-size:90%;">29.4</span></td>
<td id="S3.T1.7.7.5.7.2.6" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.7.2.6.1" class="ltx_text" style="font-size:90%;color:#808080;">61.0</span></td>
<td id="S3.T1.7.7.5.7.2.7" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.7.2.7.1" class="ltx_text" style="font-size:90%;color:#808080;">52.7</span></td>
</tr>
<tr id="S3.T1.7.7.5.8.3" class="ltx_tr">
<td id="S3.T1.7.7.5.8.3.1" class="ltx_td ltx_align_left ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.8.3.1.1" class="ltx_text" style="font-size:90%;">BARON (Ours)</span></td>
<td id="S3.T1.7.7.5.8.3.2" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.8.3.2.1" class="ltx_text" style="font-size:90%;">CLIP</span></td>
<td id="S3.T1.7.7.5.8.3.3" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.8.3.3.1" class="ltx_text" style="font-size:90%;">ResNet50-FPN</span></td>
<td id="S3.T1.7.7.5.8.3.4" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.8.3.4.1" class="ltx_text" style="font-size:90%;">FasterRCNN</span></td>
<td id="S3.T1.7.7.5.8.3.5" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.8.3.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">34.0</span></td>
<td id="S3.T1.7.7.5.8.3.6" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.8.3.6.1" class="ltx_text" style="font-size:90%;color:#808080;">60.4</span></td>
<td id="S3.T1.7.7.5.8.3.7" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.8.3.7.1" class="ltx_text" style="font-size:90%;color:#808080;">53.5</span></td>
</tr>
<tr id="S3.T1.7.7.5.9.4" class="ltx_tr">
<td id="S3.T1.7.7.5.9.4.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;">
<span id="S3.T1.7.7.5.9.4.1.1" class="ltx_text" style="font-size:90%;">OVR-CNN </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S3.T1.7.7.5.9.4.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib56" title="" class="ltx_ref">56</a><span id="S3.T1.7.7.5.9.4.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</td>
<td id="S3.T1.7.7.5.9.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.9.4.2.1" class="ltx_text" style="font-size:90%;">Caption</span></td>
<td id="S3.T1.7.7.5.9.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.9.4.3.1" class="ltx_text" style="font-size:90%;">ResNet50-C4</span></td>
<td id="S3.T1.7.7.5.9.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.9.4.4.1" class="ltx_text" style="font-size:90%;">FasterRCNN</span></td>
<td id="S3.T1.7.7.5.9.4.5" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.9.4.5.1" class="ltx_text" style="font-size:90%;">22.8</span></td>
<td id="S3.T1.7.7.5.9.4.6" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.9.4.6.1" class="ltx_text" style="font-size:90%;color:#808080;">46.0</span></td>
<td id="S3.T1.7.7.5.9.4.7" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.9.4.7.1" class="ltx_text" style="font-size:90%;color:#808080;">39.9</span></td>
</tr>
<tr id="S3.T1.7.7.5.10.5" class="ltx_tr">
<td id="S3.T1.7.7.5.10.5.1" class="ltx_td ltx_align_left ltx_border_r" style="padding:0.45pt 3.0pt;">
<span id="S3.T1.7.7.5.10.5.1.1" class="ltx_text" style="font-size:90%;">RegionCLIP </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S3.T1.7.7.5.10.5.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib59" title="" class="ltx_ref">59</a><span id="S3.T1.7.7.5.10.5.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</td>
<td id="S3.T1.7.7.5.10.5.2" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.10.5.2.1" class="ltx_text" style="font-size:90%;">Caption</span></td>
<td id="S3.T1.7.7.5.10.5.3" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.10.5.3.1" class="ltx_text" style="font-size:90%;">ResNet50-C4</span></td>
<td id="S3.T1.7.7.5.10.5.4" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.10.5.4.1" class="ltx_text" style="font-size:90%;">FasterRCNN</span></td>
<td id="S3.T1.7.7.5.10.5.5" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.10.5.5.1" class="ltx_text" style="font-size:90%;">26.8</span></td>
<td id="S3.T1.7.7.5.10.5.6" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.10.5.6.1" class="ltx_text" style="font-size:90%;color:#808080;">54.8</span></td>
<td id="S3.T1.7.7.5.10.5.7" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.10.5.7.1" class="ltx_text" style="font-size:90%;color:#808080;">47.5</span></td>
</tr>
<tr id="S3.T1.7.7.5.11.6" class="ltx_tr">
<td id="S3.T1.7.7.5.11.6.1" class="ltx_td ltx_align_left ltx_border_r" style="padding:0.45pt 3.0pt;">
<span id="S3.T1.7.7.5.11.6.1.1" class="ltx_text" style="font-size:90%;">Detic </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S3.T1.7.7.5.11.6.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib61" title="" class="ltx_ref">61</a><span id="S3.T1.7.7.5.11.6.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</td>
<td id="S3.T1.7.7.5.11.6.2" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.11.6.2.1" class="ltx_text" style="font-size:90%;">Caption</span></td>
<td id="S3.T1.7.7.5.11.6.3" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.11.6.3.1" class="ltx_text" style="font-size:90%;">ResNet50-C4</span></td>
<td id="S3.T1.7.7.5.11.6.4" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.11.6.4.1" class="ltx_text" style="font-size:90%;">FasterRCNN</span></td>
<td id="S3.T1.7.7.5.11.6.5" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.11.6.5.1" class="ltx_text" style="font-size:90%;">27.8</span></td>
<td id="S3.T1.7.7.5.11.6.6" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.11.6.6.1" class="ltx_text" style="font-size:90%;color:#808080;">51.1</span></td>
<td id="S3.T1.7.7.5.11.6.7" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.11.6.7.1" class="ltx_text" style="font-size:90%;color:#808080;">45.0</span></td>
</tr>
<tr id="S3.T1.7.7.5.12.7" class="ltx_tr">
<td id="S3.T1.7.7.5.12.7.1" class="ltx_td ltx_align_left ltx_border_r" style="padding:0.45pt 3.0pt;">
<span id="S3.T1.7.7.5.12.7.1.1" class="ltx_text" style="font-size:90%;">PB-OVD </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S3.T1.7.7.5.12.7.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib14" title="" class="ltx_ref">14</a><span id="S3.T1.7.7.5.12.7.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</td>
<td id="S3.T1.7.7.5.12.7.2" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.12.7.2.1" class="ltx_text" style="font-size:90%;">Caption</span></td>
<td id="S3.T1.7.7.5.12.7.3" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.12.7.3.1" class="ltx_text" style="font-size:90%;">ResNet50-C4</span></td>
<td id="S3.T1.7.7.5.12.7.4" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.12.7.4.1" class="ltx_text" style="font-size:90%;">FasterRCNN</span></td>
<td id="S3.T1.7.7.5.12.7.5" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.12.7.5.1" class="ltx_text" style="font-size:90%;">30.8</span></td>
<td id="S3.T1.7.7.5.12.7.6" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.12.7.6.1" class="ltx_text" style="font-size:90%;color:#808080;">46.1</span></td>
<td id="S3.T1.7.7.5.12.7.7" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.12.7.7.1" class="ltx_text" style="font-size:90%;color:#808080;">42.1</span></td>
</tr>
<tr id="S3.T1.7.7.5.13.8" class="ltx_tr">
<td id="S3.T1.7.7.5.13.8.1" class="ltx_td ltx_align_left ltx_border_r" style="padding:0.45pt 3.0pt;">
<span id="S3.T1.7.7.5.13.8.1.1" class="ltx_text" style="font-size:90%;">VLDet </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S3.T1.7.7.5.13.8.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib30" title="" class="ltx_ref">30</a><span id="S3.T1.7.7.5.13.8.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</td>
<td id="S3.T1.7.7.5.13.8.2" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.13.8.2.1" class="ltx_text" style="font-size:90%;">Caption</span></td>
<td id="S3.T1.7.7.5.13.8.3" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.13.8.3.1" class="ltx_text" style="font-size:90%;">ResNet50-C4</span></td>
<td id="S3.T1.7.7.5.13.8.4" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.13.8.4.1" class="ltx_text" style="font-size:90%;">FasterRCNN</span></td>
<td id="S3.T1.7.7.5.13.8.5" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.13.8.5.1" class="ltx_text" style="font-size:90%;">32.0</span></td>
<td id="S3.T1.7.7.5.13.8.6" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.13.8.6.1" class="ltx_text" style="font-size:90%;color:#808080;">50.6</span></td>
<td id="S3.T1.7.7.5.13.8.7" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.13.8.7.1" class="ltx_text" style="font-size:90%;color:#808080;">45.8</span></td>
</tr>
<tr id="S3.T1.7.7.5.14.9" class="ltx_tr">
<td id="S3.T1.7.7.5.14.9.1" class="ltx_td ltx_align_left ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.14.9.1.1" class="ltx_text" style="font-size:90%;">BARON (Ours)</span></td>
<td id="S3.T1.7.7.5.14.9.2" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.14.9.2.1" class="ltx_text" style="font-size:90%;">Caption</span></td>
<td id="S3.T1.7.7.5.14.9.3" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.14.9.3.1" class="ltx_text" style="font-size:90%;">ResNet50-C4</span></td>
<td id="S3.T1.7.7.5.14.9.4" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.14.9.4.1" class="ltx_text" style="font-size:90%;">FasterRCNN</span></td>
<td id="S3.T1.7.7.5.14.9.5" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.14.9.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">33.1</span></td>
<td id="S3.T1.7.7.5.14.9.6" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.14.9.6.1" class="ltx_text" style="font-size:90%;color:#808080;">54.8</span></td>
<td id="S3.T1.7.7.5.14.9.7" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.14.9.7.1" class="ltx_text" style="font-size:90%;color:#808080;">49.1</span></td>
</tr>
<tr id="S3.T1.6.6.4.4" class="ltx_tr">
<td id="S3.T1.6.6.4.4.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;">
<span id="S3.T1.6.6.4.4.1.1" class="ltx_text" style="font-size:90%;">Rasheed </span><em id="S3.T1.6.6.4.4.1.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">et al</em><span id="S3.T1.6.6.4.4.1.3" class="ltx_text" style="font-size:90%;">.</span><span id="S3.T1.6.6.4.4.1.4" class="ltx_text"></span><span id="S3.T1.6.6.4.4.1.5" class="ltx_text" style="font-size:90%;"> </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S3.T1.6.6.4.4.1.6.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib43" title="" class="ltx_ref">43</a><span id="S3.T1.6.6.4.4.1.7.2" class="ltx_text" style="font-size:90%;">]</span></cite><sup id="S3.T1.6.6.4.4.1.8" class="ltx_sup"><span id="S3.T1.6.6.4.4.1.8.1" class="ltx_text" style="font-size:90%;">†</span></sup>
</td>
<td id="S3.T1.6.6.4.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S3.T1.6.6.4.4.2.1" class="ltx_text" style="font-size:90%;">CLIP + Caption</span></td>
<td id="S3.T1.6.6.4.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S3.T1.6.6.4.4.3.1" class="ltx_text" style="font-size:90%;">ResNet50-C4</span></td>
<td id="S3.T1.6.6.4.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S3.T1.6.6.4.4.4.1" class="ltx_text" style="font-size:90%;">FasterRCNN</span></td>
<td id="S3.T1.6.6.4.4.5" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S3.T1.6.6.4.4.5.1" class="ltx_text" style="font-size:90%;">36.6</span></td>
<td id="S3.T1.6.6.4.4.6" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S3.T1.6.6.4.4.6.1" class="ltx_text" style="font-size:90%;color:#808080;">54.0</span></td>
<td id="S3.T1.6.6.4.4.7" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S3.T1.6.6.4.4.7.1" class="ltx_text" style="font-size:90%;color:#808080;">49.4</span></td>
</tr>
<tr id="S3.T1.7.7.5.5" class="ltx_tr">
<td id="S3.T1.7.7.5.5.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" style="padding:0.45pt 3.0pt;">
<span id="S3.T1.7.7.5.5.1.1" class="ltx_text" style="font-size:90%;">BARON (Ours)</span><sup id="S3.T1.7.7.5.5.1.2" class="ltx_sup"><span id="S3.T1.7.7.5.5.1.2.1" class="ltx_text" style="font-size:90%;">†</span></sup>
</td>
<td id="S3.T1.7.7.5.5.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.5.2.1" class="ltx_text" style="font-size:90%;">CLIP + Caption</span></td>
<td id="S3.T1.7.7.5.5.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.5.3.1" class="ltx_text" style="font-size:90%;">ResNet50-C4</span></td>
<td id="S3.T1.7.7.5.5.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.5.4.1" class="ltx_text" style="font-size:90%;">FasterRCNN</span></td>
<td id="S3.T1.7.7.5.5.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.5.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">42.7</span></td>
<td id="S3.T1.7.7.5.5.6" class="ltx_td ltx_align_center ltx_border_bb" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.5.6.1" class="ltx_text" style="font-size:90%;color:#808080;">54.9</span></td>
<td id="S3.T1.7.7.5.5.7" class="ltx_td ltx_align_center ltx_border_bb" style="padding:0.45pt 3.0pt;"><span id="S3.T1.7.7.5.5.7.1" class="ltx_text" style="font-size:90%;color:#808080;">51.7</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="S3.SS4.p4" class="ltx_para ltx_noindent">
<p id="S3.SS4.p4.1" class="ltx_p"><span id="S3.SS4.p4.1.1" class="ltx_text ltx_font_bold">Aligning Individual Regions.</span>
The alignment between individual regions’ student and teacher embeddings is complementary to that of a bag of regions. Therefore, we also adopt the individual-level distillation in our implementation. For computational efficiency, we obtain the teacher embeddings from the feature map of the image encoder’s last attention layer by RoiAlign <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> instead of repeatedly passing image crops to the image encoder. Similarly, the student embeddings are extracted from the text encoder’s last attention layer by averaging pseudo-word embeddings of the same region. We apply the InfoNCE loss and keep queues of embeddings to calculate the individual-level loss <math id="S3.SS4.p4.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{\mathrm{individual}}" display="inline"><semantics id="S3.SS4.p4.1.m1.1a"><msub id="S3.SS4.p4.1.m1.1.1" xref="S3.SS4.p4.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p4.1.m1.1.1.2" xref="S3.SS4.p4.1.m1.1.1.2.cmml">ℒ</mi><mi id="S3.SS4.p4.1.m1.1.1.3" xref="S3.SS4.p4.1.m1.1.1.3.cmml">individual</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.1.m1.1b"><apply id="S3.SS4.p4.1.m1.1.1.cmml" xref="S3.SS4.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.1.m1.1.1.1.cmml" xref="S3.SS4.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS4.p4.1.m1.1.1.2.cmml" xref="S3.SS4.p4.1.m1.1.1.2">ℒ</ci><ci id="S3.SS4.p4.1.m1.1.1.3.cmml" xref="S3.SS4.p4.1.m1.1.1.3">individual</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.1.m1.1c">\mathcal{L}_{\mathrm{individual}}</annotation></semantics></math>.</p>
</div>
<figure id="S3.F4" class="ltx_figure"><img src="/html/2302.13996/assets/figs/caption.jpg" id="S3.F4.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="449" height="242" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S3.F4.4.1.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S3.F4.5.2" class="ltx_text" style="font-size:90%;">The caption-version <span id="S3.F4.5.2.1" class="ltx_text">BARON</span>. We align the text embeddings of the bag of regions to the caption embeddings.</span></figcaption>
</figure>
</section>
<section id="S3.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5 </span>Caption Supervision</h3>

<div id="S3.SS5.p1" class="ltx_para">
<p id="S3.SS5.p1.2" class="ltx_p">It is noteworthy that BARON can be applied to caption supervision. As shown in Fig. <a href="#S3.F4" title="Fig. 4 ‣ 3.4 Aligning Bag of Regions ‣ 3 Method ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, the core idea is to replace the image embedding <math id="S3.SS5.p1.1.m1.1" class="ltx_Math" alttext="f_{v}" display="inline"><semantics id="S3.SS5.p1.1.m1.1a"><msub id="S3.SS5.p1.1.m1.1.1" xref="S3.SS5.p1.1.m1.1.1.cmml"><mi id="S3.SS5.p1.1.m1.1.1.2" xref="S3.SS5.p1.1.m1.1.1.2.cmml">f</mi><mi id="S3.SS5.p1.1.m1.1.1.3" xref="S3.SS5.p1.1.m1.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.1.m1.1b"><apply id="S3.SS5.p1.1.m1.1.1.cmml" xref="S3.SS5.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.1.m1.1.1.1.cmml" xref="S3.SS5.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS5.p1.1.m1.1.1.2.cmml" xref="S3.SS5.p1.1.m1.1.1.2">𝑓</ci><ci id="S3.SS5.p1.1.m1.1.1.3.cmml" xref="S3.SS5.p1.1.m1.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.1.m1.1c">f_{v}</annotation></semantics></math> with embedding obtained by feeding the image captions to the text encoder <math id="S3.SS5.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{T}" display="inline"><semantics id="S3.SS5.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS5.p1.2.m2.1.1" xref="S3.SS5.p1.2.m2.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.2.m2.1b"><ci id="S3.SS5.p1.2.m2.1.1.cmml" xref="S3.SS5.p1.2.m2.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.2.m2.1c">\mathcal{T}</annotation></semantics></math>.
To obtain the region groups, we randomly sample some region proposals generated by the RPN. As an image can have multiple captions, we follow the practice in UniCL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib53" title="" class="ltx_ref">53</a>]</cite> to apply a soft cross entropy loss that simultaneously aligns the student bag-of-regions embedding to multiple caption embeddings.
The alignment of individual regions is discarded since we cannot get the correspondence between pseudo words of regions and the actual words in a caption without grounding.
In this way, BARON now learn to align the bag-of-regions embedding of the image caption, which also describes the existence of multiple concepts of the image.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<div id="S4.p1" class="ltx_para ltx_noindent">
<p id="S4.p1.1" class="ltx_p"><span id="S4.p1.1.1" class="ltx_text ltx_font_bold">Datasets.</span> We evaluate our method on the two popular object detection datasets, <em id="S4.p1.1.2" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S4.p1.1.3" class="ltx_text"></span>, COCO <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> and LVIS <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>. For the COCO dataset, we follow OV-RCNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib56" title="" class="ltx_ref">56</a>]</cite> to split the object categories to 48 base categories and 17 novel categories. For the LVIS dataset, we follow ViLD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> to split the 337 rare categories into novel categories and the rest common and frequent categories into base categories. For brevity, we denote the open-vocabulary benchmarks based on COCO and LVIS as OV-COCO and OV-LVIS.</p>
</div>
<div id="S4.p2" class="ltx_para ltx_noindent">
<p id="S4.p2.4" class="ltx_p"><span id="S4.p2.4.1" class="ltx_text ltx_font_bold">Evaluation Metrics.</span> We evaluate the detection performance on both base and novel categories for completeness.
For OV-COCO, we follow OV-RCNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib56" title="" class="ltx_ref">56</a>]</cite> to report the box AP at IoU threshold 0.5, noted as AP<sub id="S4.p2.4.2" class="ltx_sub"><span id="S4.p2.4.2.1" class="ltx_text ltx_font_italic">50</span></sub>.
For OV-LVIS, we report both the mask and box AP averaged on IoUs from 0.5 to 0.95, noted as mAP.
The AP<sub id="S4.p2.4.3" class="ltx_sub"><span id="S4.p2.4.3.1" class="ltx_text ltx_font_italic">50</span></sub> of novel categories (AP<math id="S4.p2.3.m3.1" class="ltx_Math" alttext="{}_{50}^{\mathrm{novel}}" display="inline"><semantics id="S4.p2.3.m3.1a"><mmultiscripts id="S4.p2.3.m3.1.1" xref="S4.p2.3.m3.1.1.cmml"><mi id="S4.p2.3.m3.1.1.2.2" xref="S4.p2.3.m3.1.1.2.2.cmml"></mi><mprescripts id="S4.p2.3.m3.1.1a" xref="S4.p2.3.m3.1.1.cmml"></mprescripts><mrow id="S4.p2.3.m3.1.1b" xref="S4.p2.3.m3.1.1.cmml"></mrow><mi id="S4.p2.3.m3.1.1.3" xref="S4.p2.3.m3.1.1.3.cmml">novel</mi><mn id="S4.p2.3.m3.1.1.2.3" xref="S4.p2.3.m3.1.1.2.3.cmml">50</mn><mrow id="S4.p2.3.m3.1.1c" xref="S4.p2.3.m3.1.1.cmml"></mrow></mmultiscripts><annotation-xml encoding="MathML-Content" id="S4.p2.3.m3.1b"><apply id="S4.p2.3.m3.1.1.cmml" xref="S4.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.p2.3.m3.1.1.1.cmml" xref="S4.p2.3.m3.1.1">superscript</csymbol><apply id="S4.p2.3.m3.1.1.2.cmml" xref="S4.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.p2.3.m3.1.1.2.1.cmml" xref="S4.p2.3.m3.1.1">subscript</csymbol><csymbol cd="latexml" id="S4.p2.3.m3.1.1.2.2.cmml" xref="S4.p2.3.m3.1.1.2.2">absent</csymbol><cn type="integer" id="S4.p2.3.m3.1.1.2.3.cmml" xref="S4.p2.3.m3.1.1.2.3">50</cn></apply><ci id="S4.p2.3.m3.1.1.3.cmml" xref="S4.p2.3.m3.1.1.3">novel</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.3.m3.1c">{}_{50}^{\mathrm{novel}}</annotation></semantics></math>) and mAP of rare categories (AP<sub id="S4.p2.4.4" class="ltx_sub"><span id="S4.p2.4.4.1" class="ltx_text ltx_font_italic">r</span></sub>) are the main metrics that evaluate the open-vocabulary detection performance on OV-COCO and OV-LVIS, respectively.</p>
</div>
<div id="S4.p3" class="ltx_para ltx_noindent">
<p id="S4.p3.2" class="ltx_p"><span id="S4.p3.2.1" class="ltx_text ltx_font_bold">Implementation Details.</span>
We build <span id="S4.p3.2.2" class="ltx_text">BARON</span> on Faster R-CNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite> with ResNet50-FPN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>.
For a fair comparison with existing methods, we initialize the backbone network with weights pre-trained by SOCO <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib51" title="" class="ltx_ref">51</a>]</cite> and apply synchronized Batch Normalization (SyncBN) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite> following DetPro <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>. We choose the <math id="S4.p3.1.m1.1" class="ltx_math_unparsed" alttext="2\times" display="inline"><semantics id="S4.p3.1.m1.1a"><mrow id="S4.p3.1.m1.1b"><mn id="S4.p3.1.m1.1.1">2</mn><mo lspace="0.222em" id="S4.p3.1.m1.1.2">×</mo></mrow><annotation encoding="application/x-tex" id="S4.p3.1.m1.1c">2\times</annotation></semantics></math> schedule (180, 000 iterations) for the main experiments on COCO and LVIS <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib52" title="" class="ltx_ref">52</a>]</cite>. For the pre-trained VLM, we choose the CLIP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite> model based on ViT-B/32 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>. For the adaptation to caption supervision, we base our method on Faster R-CNN with ResNet50-C4 backbone <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite> and adopt the <math id="S4.p3.2.m2.1" class="ltx_math_unparsed" alttext="1\times" display="inline"><semantics id="S4.p3.2.m2.1a"><mrow id="S4.p3.2.m2.1b"><mn id="S4.p3.2.m2.1.1">1</mn><mo lspace="0.222em" id="S4.p3.2.m2.1.2">×</mo></mrow><annotation encoding="application/x-tex" id="S4.p3.2.m2.1c">1\times</annotation></semantics></math> schedule. For the prompt of category names, we use the hand-crafted prompts in ViLD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> for all our experiments by default.
We use learned prompt only when comparing with DetPro <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 2: </span>Comparison with state-of-the-art methods on OV-LVIS. * denotes the re-implemented ViLD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> reported in DetPro <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>.
</figcaption>
<div id="S4.T2.6" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:379.9pt;height:162pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-21.1pt,9.0pt) scale(0.9,0.9) ;">
<table id="S4.T2.6.6" class="ltx_tabular ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T2.6.6.7.1" class="ltx_tr">
<td id="S4.T2.6.6.7.1.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" style="padding:0.45pt 3.0pt;" rowspan="2"><span id="S4.T2.6.6.7.1.1.1" class="ltx_text" style="font-size:90%;">Method</span></td>
<td id="S4.T2.6.6.7.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding:0.45pt 3.0pt;" rowspan="2"><span id="S4.T2.6.6.7.1.2.1" class="ltx_text" style="font-size:90%;">Ensemble</span></td>
<td id="S4.T2.6.6.7.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding:0.45pt 3.0pt;" rowspan="2"><span id="S4.T2.6.6.7.1.3.1" class="ltx_text" style="font-size:90%;">Learned Prompt</span></td>
<td id="S4.T2.6.6.7.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding:0.45pt 3.0pt;" colspan="4"><span id="S4.T2.6.6.7.1.4.1" class="ltx_text" style="font-size:90%;">Object Detection</span></td>
<td id="S4.T2.6.6.7.1.5" class="ltx_td ltx_align_center ltx_border_tt" style="padding:0.45pt 3.0pt;" colspan="4"><span id="S4.T2.6.6.7.1.5.1" class="ltx_text" style="font-size:90%;">Instance segmentation</span></td>
</tr>
<tr id="S4.T2.6.6.6" class="ltx_tr">
<td id="S4.T2.1.1.1.1" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;">
<span id="S4.T2.1.1.1.1.1" class="ltx_text" style="font-size:90%;">AP</span><sub id="S4.T2.1.1.1.1.2" class="ltx_sub"><span id="S4.T2.1.1.1.1.2.1" class="ltx_text ltx_font_italic" style="font-size:90%;">r</span></sub>
</td>
<td id="S4.T2.2.2.2.2" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T2.2.2.2.2.1" class="ltx_text" style="font-size:90%;color:#808080;">AP<sub id="S4.T2.2.2.2.2.1.1" class="ltx_sub"><span id="S4.T2.2.2.2.2.1.1.1" class="ltx_text ltx_font_italic">c</span></sub></span></td>
<td id="S4.T2.3.3.3.3" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T2.3.3.3.3.1" class="ltx_text" style="font-size:90%;color:#808080;">AP<sub id="S4.T2.3.3.3.3.1.1" class="ltx_sub"><span id="S4.T2.3.3.3.3.1.1.1" class="ltx_text ltx_font_italic">f</span></sub></span></td>
<td id="S4.T2.6.6.6.7" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.6.7.1" class="ltx_text" style="font-size:90%;color:#808080;">AP</span></td>
<td id="S4.T2.4.4.4.4" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;">
<span id="S4.T2.4.4.4.4.1" class="ltx_text" style="font-size:90%;">AP</span><sub id="S4.T2.4.4.4.4.2" class="ltx_sub"><span id="S4.T2.4.4.4.4.2.1" class="ltx_text ltx_font_italic" style="font-size:90%;">r</span></sub>
</td>
<td id="S4.T2.5.5.5.5" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T2.5.5.5.5.1" class="ltx_text" style="font-size:90%;color:#808080;">AP<sub id="S4.T2.5.5.5.5.1.1" class="ltx_sub"><span id="S4.T2.5.5.5.5.1.1.1" class="ltx_text ltx_font_italic">c</span></sub></span></td>
<td id="S4.T2.6.6.6.6" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.6.6.1" class="ltx_text" style="font-size:90%;color:#808080;">AP<sub id="S4.T2.6.6.6.6.1.1" class="ltx_sub"><span id="S4.T2.6.6.6.6.1.1.1" class="ltx_text ltx_font_italic">f</span></sub></span></td>
<td id="S4.T2.6.6.6.8" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.6.8.1" class="ltx_text" style="font-size:90%;color:#808080;">AP</span></td>
</tr>
<tr id="S4.T2.6.6.8.2" class="ltx_tr">
<td id="S4.T2.6.6.8.2.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;">
<span id="S4.T2.6.6.8.2.1.1" class="ltx_text" style="font-size:90%;">ViLD </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T2.6.6.8.2.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib16" title="" class="ltx_ref">16</a><span id="S4.T2.6.6.8.2.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</td>
<td id="S4.T2.6.6.8.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.8.2.2.1" class="ltx_text" style="font-size:90%;">-</span></td>
<td id="S4.T2.6.6.8.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.8.2.3.1" class="ltx_text" style="font-size:90%;">-</span></td>
<td id="S4.T2.6.6.8.2.4" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.8.2.4.1" class="ltx_text" style="font-size:90%;">16.3</span></td>
<td id="S4.T2.6.6.8.2.5" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.8.2.5.1" class="ltx_text" style="font-size:90%;color:#808080;">21.2</span></td>
<td id="S4.T2.6.6.8.2.6" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.8.2.6.1" class="ltx_text" style="font-size:90%;color:#808080;">31.6</span></td>
<td id="S4.T2.6.6.8.2.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.8.2.7.1" class="ltx_text" style="font-size:90%;color:#808080;">24.4</span></td>
<td id="S4.T2.6.6.8.2.8" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.8.2.8.1" class="ltx_text" style="font-size:90%;">16.1</span></td>
<td id="S4.T2.6.6.8.2.9" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.8.2.9.1" class="ltx_text" style="font-size:90%;color:#808080;">20.0</span></td>
<td id="S4.T2.6.6.8.2.10" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.8.2.10.1" class="ltx_text" style="font-size:90%;color:#808080;">28.3</span></td>
<td id="S4.T2.6.6.8.2.11" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.8.2.11.1" class="ltx_text" style="font-size:90%;color:#808080;">22.5</span></td>
</tr>
<tr id="S4.T2.6.6.9.3" class="ltx_tr">
<td id="S4.T2.6.6.9.3.1" class="ltx_td ltx_align_left ltx_border_r" style="padding:0.45pt 3.0pt;">
<span id="S4.T2.6.6.9.3.1.1" class="ltx_text" style="font-size:90%;">OV-DETR </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T2.6.6.9.3.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib55" title="" class="ltx_ref">55</a><span id="S4.T2.6.6.9.3.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</td>
<td id="S4.T2.6.6.9.3.2" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.9.3.2.1" class="ltx_text" style="font-size:90%;">-</span></td>
<td id="S4.T2.6.6.9.3.3" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.9.3.3.1" class="ltx_text" style="font-size:90%;">-</span></td>
<td id="S4.T2.6.6.9.3.4" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.9.3.4.1" class="ltx_text" style="font-size:90%;">-</span></td>
<td id="S4.T2.6.6.9.3.5" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.9.3.5.1" class="ltx_text" style="font-size:90%;color:#808080;">-</span></td>
<td id="S4.T2.6.6.9.3.6" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.9.3.6.1" class="ltx_text" style="font-size:90%;color:#808080;">-</span></td>
<td id="S4.T2.6.6.9.3.7" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.9.3.7.1" class="ltx_text" style="font-size:90%;color:#808080;">-</span></td>
<td id="S4.T2.6.6.9.3.8" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.9.3.8.1" class="ltx_text" style="font-size:90%;">17.4</span></td>
<td id="S4.T2.6.6.9.3.9" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.9.3.9.1" class="ltx_text" style="font-size:90%;color:#808080;">25.0</span></td>
<td id="S4.T2.6.6.9.3.10" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.9.3.10.1" class="ltx_text" style="font-size:90%;color:#808080;">32.5</span></td>
<td id="S4.T2.6.6.9.3.11" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.9.3.11.1" class="ltx_text" style="font-size:90%;color:#808080;">26.6</span></td>
</tr>
<tr id="S4.T2.6.6.10.4" class="ltx_tr">
<td id="S4.T2.6.6.10.4.1" class="ltx_td ltx_align_left ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.10.4.1.1" class="ltx_text" style="font-size:90%;">BARON (Ours)</span></td>
<td id="S4.T2.6.6.10.4.2" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.10.4.2.1" class="ltx_text" style="font-size:90%;">-</span></td>
<td id="S4.T2.6.6.10.4.3" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.10.4.3.1" class="ltx_text" style="font-size:90%;">-</span></td>
<td id="S4.T2.6.6.10.4.4" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.10.4.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">17.3</span></td>
<td id="S4.T2.6.6.10.4.5" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.10.4.5.1" class="ltx_text" style="font-size:90%;color:#808080;">25.6</span></td>
<td id="S4.T2.6.6.10.4.6" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.10.4.6.1" class="ltx_text" style="font-size:90%;color:#808080;">31.0</span></td>
<td id="S4.T2.6.6.10.4.7" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.10.4.7.1" class="ltx_text" style="font-size:90%;color:#808080;">26.3</span></td>
<td id="S4.T2.6.6.10.4.8" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.10.4.8.1" class="ltx_text ltx_font_bold" style="font-size:90%;">18.0</span></td>
<td id="S4.T2.6.6.10.4.9" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.10.4.9.1" class="ltx_text" style="font-size:90%;color:#808080;">24.4</span></td>
<td id="S4.T2.6.6.10.4.10" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.10.4.10.1" class="ltx_text" style="font-size:90%;color:#808080;">28.9</span></td>
<td id="S4.T2.6.6.10.4.11" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.10.4.11.1" class="ltx_text" style="font-size:90%;color:#808080;">25.1</span></td>
</tr>
<tr id="S4.T2.6.6.11.5" class="ltx_tr">
<td id="S4.T2.6.6.11.5.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;">
<span id="S4.T2.6.6.11.5.1.1" class="ltx_text" style="font-size:90%;">ViLD </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T2.6.6.11.5.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib16" title="" class="ltx_ref">16</a><span id="S4.T2.6.6.11.5.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</td>
<td id="S4.T2.6.6.11.5.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.11.5.2.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S4.T2.6.6.11.5.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.11.5.3.1" class="ltx_text" style="font-size:90%;">-</span></td>
<td id="S4.T2.6.6.11.5.4" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.11.5.4.1" class="ltx_text" style="font-size:90%;">16.7</span></td>
<td id="S4.T2.6.6.11.5.5" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.11.5.5.1" class="ltx_text" style="font-size:90%;color:#808080;">26.5</span></td>
<td id="S4.T2.6.6.11.5.6" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.11.5.6.1" class="ltx_text" style="font-size:90%;color:#808080;">34.2</span></td>
<td id="S4.T2.6.6.11.5.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.11.5.7.1" class="ltx_text" style="font-size:90%;color:#808080;">27.8</span></td>
<td id="S4.T2.6.6.11.5.8" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.11.5.8.1" class="ltx_text" style="font-size:90%;">16.6</span></td>
<td id="S4.T2.6.6.11.5.9" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.11.5.9.1" class="ltx_text" style="font-size:90%;color:#808080;">24.6</span></td>
<td id="S4.T2.6.6.11.5.10" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.11.5.10.1" class="ltx_text" style="font-size:90%;color:#808080;">30.3</span></td>
<td id="S4.T2.6.6.11.5.11" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.11.5.11.1" class="ltx_text" style="font-size:90%;color:#808080;">25.5</span></td>
</tr>
<tr id="S4.T2.6.6.12.6" class="ltx_tr">
<td id="S4.T2.6.6.12.6.1" class="ltx_td ltx_align_left ltx_border_r" style="padding:0.45pt 3.0pt;">
<span id="S4.T2.6.6.12.6.1.1" class="ltx_text" style="font-size:90%;">ViLD* </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T2.6.6.12.6.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib16" title="" class="ltx_ref">16</a><span id="S4.T2.6.6.12.6.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</td>
<td id="S4.T2.6.6.12.6.2" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.12.6.2.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S4.T2.6.6.12.6.3" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.12.6.3.1" class="ltx_text" style="font-size:90%;">-</span></td>
<td id="S4.T2.6.6.12.6.4" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.12.6.4.1" class="ltx_text" style="font-size:90%;">17.4</span></td>
<td id="S4.T2.6.6.12.6.5" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.12.6.5.1" class="ltx_text" style="font-size:90%;color:#808080;">27.5</span></td>
<td id="S4.T2.6.6.12.6.6" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.12.6.6.1" class="ltx_text" style="font-size:90%;color:#808080;">31.9</span></td>
<td id="S4.T2.6.6.12.6.7" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.12.6.7.1" class="ltx_text" style="font-size:90%;color:#808080;">27.5</span></td>
<td id="S4.T2.6.6.12.6.8" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.12.6.8.1" class="ltx_text" style="font-size:90%;">16.8</span></td>
<td id="S4.T2.6.6.12.6.9" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.12.6.9.1" class="ltx_text" style="font-size:90%;color:#808080;">25.6</span></td>
<td id="S4.T2.6.6.12.6.10" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.12.6.10.1" class="ltx_text" style="font-size:90%;color:#808080;">28.5</span></td>
<td id="S4.T2.6.6.12.6.11" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.12.6.11.1" class="ltx_text" style="font-size:90%;color:#808080;">25.2</span></td>
</tr>
<tr id="S4.T2.6.6.13.7" class="ltx_tr">
<td id="S4.T2.6.6.13.7.1" class="ltx_td ltx_align_left ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.13.7.1.1" class="ltx_text" style="font-size:90%;">BARON (Ours)</span></td>
<td id="S4.T2.6.6.13.7.2" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.13.7.2.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S4.T2.6.6.13.7.3" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.13.7.3.1" class="ltx_text" style="font-size:90%;">-</span></td>
<td id="S4.T2.6.6.13.7.4" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.13.7.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">20.1</span></td>
<td id="S4.T2.6.6.13.7.5" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.13.7.5.1" class="ltx_text" style="font-size:90%;color:#808080;">28.4</span></td>
<td id="S4.T2.6.6.13.7.6" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.13.7.6.1" class="ltx_text" style="font-size:90%;color:#808080;">32.2</span></td>
<td id="S4.T2.6.6.13.7.7" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.13.7.7.1" class="ltx_text" style="font-size:90%;color:#808080;">28.4</span></td>
<td id="S4.T2.6.6.13.7.8" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.13.7.8.1" class="ltx_text ltx_font_bold" style="font-size:90%;">19.2</span></td>
<td id="S4.T2.6.6.13.7.9" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.13.7.9.1" class="ltx_text" style="font-size:90%;color:#808080;">26.8</span></td>
<td id="S4.T2.6.6.13.7.10" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.13.7.10.1" class="ltx_text" style="font-size:90%;color:#808080;">29.4</span></td>
<td id="S4.T2.6.6.13.7.11" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.13.7.11.1" class="ltx_text" style="font-size:90%;color:#808080;">26.5</span></td>
</tr>
<tr id="S4.T2.6.6.14.8" class="ltx_tr">
<td id="S4.T2.6.6.14.8.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;">
<span id="S4.T2.6.6.14.8.1.1" class="ltx_text" style="font-size:90%;">DetPro </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T2.6.6.14.8.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib11" title="" class="ltx_ref">11</a><span id="S4.T2.6.6.14.8.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</td>
<td id="S4.T2.6.6.14.8.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.14.8.2.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S4.T2.6.6.14.8.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.14.8.3.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S4.T2.6.6.14.8.4" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.14.8.4.1" class="ltx_text" style="font-size:90%;">20.8</span></td>
<td id="S4.T2.6.6.14.8.5" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.14.8.5.1" class="ltx_text" style="font-size:90%;color:#808080;">27.8</span></td>
<td id="S4.T2.6.6.14.8.6" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.14.8.6.1" class="ltx_text" style="font-size:90%;color:#808080;">32.4</span></td>
<td id="S4.T2.6.6.14.8.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.14.8.7.1" class="ltx_text" style="font-size:90%;color:#808080;">28.4</span></td>
<td id="S4.T2.6.6.14.8.8" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.14.8.8.1" class="ltx_text" style="font-size:90%;">19.8</span></td>
<td id="S4.T2.6.6.14.8.9" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.14.8.9.1" class="ltx_text" style="font-size:90%;color:#808080;">25.6</span></td>
<td id="S4.T2.6.6.14.8.10" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.14.8.10.1" class="ltx_text" style="font-size:90%;color:#808080;">28.9</span></td>
<td id="S4.T2.6.6.14.8.11" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.14.8.11.1" class="ltx_text" style="font-size:90%;color:#808080;">25.9</span></td>
</tr>
<tr id="S4.T2.6.6.15.9" class="ltx_tr">
<td id="S4.T2.6.6.15.9.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.15.9.1.1" class="ltx_text" style="font-size:90%;">BARON (Ours)</span></td>
<td id="S4.T2.6.6.15.9.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.15.9.2.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S4.T2.6.6.15.9.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.15.9.3.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S4.T2.6.6.15.9.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.15.9.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">23.2</span></td>
<td id="S4.T2.6.6.15.9.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.15.9.5.1" class="ltx_text" style="font-size:90%;color:#808080;">29.3</span></td>
<td id="S4.T2.6.6.15.9.6" class="ltx_td ltx_align_center ltx_border_bb" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.15.9.6.1" class="ltx_text" style="font-size:90%;color:#808080;">32.5</span></td>
<td id="S4.T2.6.6.15.9.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.15.9.7.1" class="ltx_text" style="font-size:90%;color:#808080;">29.5</span></td>
<td id="S4.T2.6.6.15.9.8" class="ltx_td ltx_align_center ltx_border_bb" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.15.9.8.1" class="ltx_text ltx_font_bold" style="font-size:90%;">22.6</span></td>
<td id="S4.T2.6.6.15.9.9" class="ltx_td ltx_align_center ltx_border_bb" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.15.9.9.1" class="ltx_text" style="font-size:90%;color:#808080;">27.6</span></td>
<td id="S4.T2.6.6.15.9.10" class="ltx_td ltx_align_center ltx_border_bb" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.15.9.10.1" class="ltx_text" style="font-size:90%;color:#808080;">29.8</span></td>
<td id="S4.T2.6.6.15.9.11" class="ltx_td ltx_align_center ltx_border_bb" style="padding:0.45pt 3.0pt;"><span id="S4.T2.6.6.15.9.11.1" class="ltx_text" style="font-size:90%;color:#808080;">27.6</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S4.T3" class="ltx_table">
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 3: </span>Comparison of the transfer ability of the model trained on OV-LVIS. * denotes the re-implemented ViLD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> reported in DetPro <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>. <math id="S4.T3.2.m1.1" class="ltx_Math" alttext="\ddagger" display="inline"><semantics id="S4.T3.2.m1.1b"><mo id="S4.T3.2.m1.1.1" xref="S4.T3.2.m1.1.1.cmml">‡</mo><annotation-xml encoding="MathML-Content" id="S4.T3.2.m1.1c"><ci id="S4.T3.2.m1.1.1.cmml" xref="S4.T3.2.m1.1.1">‡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.2.m1.1d">\ddagger</annotation></semantics></math> denotes that we use hand-crafted prompts for a fair comparison with ViLD.</figcaption>
<div id="S4.T3.15" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:421.2pt;height:113.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-23.4pt,6.3pt) scale(0.9,0.9) ;">
<table id="S4.T3.15.13" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T3.15.13.14.1" class="ltx_tr">
<th id="S4.T3.15.13.14.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_tt" style="padding:0.45pt 3.0pt;" rowspan="2"><span id="S4.T3.15.13.14.1.1.1" class="ltx_text" style="font-size:90%;">Method</span></th>
<td id="S4.T3.15.13.14.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding:0.45pt 3.0pt;" colspan="2"><span id="S4.T3.15.13.14.1.2.1" class="ltx_text" style="font-size:90%;">Pascal VOC</span></td>
<td id="S4.T3.15.13.14.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding:0.45pt 3.0pt;" colspan="6"><span id="S4.T3.15.13.14.1.3.1" class="ltx_text" style="font-size:90%;">COCO</span></td>
<td id="S4.T3.15.13.14.1.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding:0.45pt 3.0pt;" colspan="6"><span id="S4.T3.15.13.14.1.4.1" class="ltx_text" style="font-size:90%;">Objects365</span></td>
</tr>
<tr id="S4.T3.14.12.12" class="ltx_tr">
<td id="S4.T3.3.1.1.1" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;">
<span id="S4.T3.3.1.1.1.1" class="ltx_text" style="font-size:90%;">AP</span><sub id="S4.T3.3.1.1.1.2" class="ltx_sub"><span id="S4.T3.3.1.1.1.2.1" class="ltx_text ltx_font_italic" style="font-size:90%;">50</span></sub>
</td>
<td id="S4.T3.4.2.2.2" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;">
<span id="S4.T3.4.2.2.2.1" class="ltx_text" style="font-size:90%;">AP</span><sub id="S4.T3.4.2.2.2.2" class="ltx_sub"><span id="S4.T3.4.2.2.2.2.1" class="ltx_text ltx_font_italic" style="font-size:90%;">75</span></sub>
</td>
<td id="S4.T3.14.12.12.13" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T3.14.12.12.13.1" class="ltx_text" style="font-size:90%;">AP</span></td>
<td id="S4.T3.5.3.3.3" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;">
<span id="S4.T3.5.3.3.3.1" class="ltx_text" style="font-size:90%;">AP</span><sub id="S4.T3.5.3.3.3.2" class="ltx_sub"><span id="S4.T3.5.3.3.3.2.1" class="ltx_text ltx_font_italic" style="font-size:90%;">50</span></sub>
</td>
<td id="S4.T3.6.4.4.4" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;">
<span id="S4.T3.6.4.4.4.1" class="ltx_text" style="font-size:90%;">AP</span><sub id="S4.T3.6.4.4.4.2" class="ltx_sub"><span id="S4.T3.6.4.4.4.2.1" class="ltx_text ltx_font_italic" style="font-size:90%;">75</span></sub>
</td>
<td id="S4.T3.7.5.5.5" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;">
<span id="S4.T3.7.5.5.5.1" class="ltx_text" style="font-size:90%;">AP</span><sub id="S4.T3.7.5.5.5.2" class="ltx_sub"><span id="S4.T3.7.5.5.5.2.1" class="ltx_text ltx_font_italic" style="font-size:90%;">s</span></sub>
</td>
<td id="S4.T3.8.6.6.6" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;">
<span id="S4.T3.8.6.6.6.1" class="ltx_text" style="font-size:90%;">AP</span><sub id="S4.T3.8.6.6.6.2" class="ltx_sub"><span id="S4.T3.8.6.6.6.2.1" class="ltx_text ltx_font_italic" style="font-size:90%;">m</span></sub>
</td>
<td id="S4.T3.9.7.7.7" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;">
<span id="S4.T3.9.7.7.7.1" class="ltx_text" style="font-size:90%;">AP</span><sub id="S4.T3.9.7.7.7.2" class="ltx_sub"><span id="S4.T3.9.7.7.7.2.1" class="ltx_text ltx_font_italic" style="font-size:90%;">l</span></sub>
</td>
<td id="S4.T3.14.12.12.14" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T3.14.12.12.14.1" class="ltx_text" style="font-size:90%;">AP</span></td>
<td id="S4.T3.10.8.8.8" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;">
<span id="S4.T3.10.8.8.8.1" class="ltx_text" style="font-size:90%;">AP</span><sub id="S4.T3.10.8.8.8.2" class="ltx_sub"><span id="S4.T3.10.8.8.8.2.1" class="ltx_text ltx_font_italic" style="font-size:90%;">50</span></sub>
</td>
<td id="S4.T3.11.9.9.9" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;">
<span id="S4.T3.11.9.9.9.1" class="ltx_text" style="font-size:90%;">AP</span><sub id="S4.T3.11.9.9.9.2" class="ltx_sub"><span id="S4.T3.11.9.9.9.2.1" class="ltx_text ltx_font_italic" style="font-size:90%;">75</span></sub>
</td>
<td id="S4.T3.12.10.10.10" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;">
<span id="S4.T3.12.10.10.10.1" class="ltx_text" style="font-size:90%;">AP</span><sub id="S4.T3.12.10.10.10.2" class="ltx_sub"><span id="S4.T3.12.10.10.10.2.1" class="ltx_text ltx_font_italic" style="font-size:90%;">s</span></sub>
</td>
<td id="S4.T3.13.11.11.11" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;">
<span id="S4.T3.13.11.11.11.1" class="ltx_text" style="font-size:90%;">AP</span><sub id="S4.T3.13.11.11.11.2" class="ltx_sub"><span id="S4.T3.13.11.11.11.2.1" class="ltx_text ltx_font_italic" style="font-size:90%;">m</span></sub>
</td>
<td id="S4.T3.14.12.12.12" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;">
<span id="S4.T3.14.12.12.12.1" class="ltx_text" style="font-size:90%;">AP</span><sub id="S4.T3.14.12.12.12.2" class="ltx_sub"><span id="S4.T3.14.12.12.12.2.1" class="ltx_text ltx_font_italic" style="font-size:90%;">l</span></sub>
</td>
</tr>
<tr id="S4.T3.15.13.15.2" class="ltx_tr">
<th id="S4.T3.15.13.15.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;">
<span id="S4.T3.15.13.15.2.1.1" class="ltx_text" style="font-size:90%;">Supervised </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T3.15.13.15.2.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib11" title="" class="ltx_ref">11</a><span id="S4.T3.15.13.15.2.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S4.T3.15.13.15.2.2" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.15.2.2.1" class="ltx_text" style="font-size:90%;">78.5</span></td>
<td id="S4.T3.15.13.15.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.15.2.3.1" class="ltx_text" style="font-size:90%;">49.0</span></td>
<td id="S4.T3.15.13.15.2.4" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.15.2.4.1" class="ltx_text" style="font-size:90%;">46.5</span></td>
<td id="S4.T3.15.13.15.2.5" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.15.2.5.1" class="ltx_text" style="font-size:90%;">67.6</span></td>
<td id="S4.T3.15.13.15.2.6" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.15.2.6.1" class="ltx_text" style="font-size:90%;">50.9</span></td>
<td id="S4.T3.15.13.15.2.7" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.15.2.7.1" class="ltx_text" style="font-size:90%;">27.1</span></td>
<td id="S4.T3.15.13.15.2.8" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.15.2.8.1" class="ltx_text" style="font-size:90%;">67.6</span></td>
<td id="S4.T3.15.13.15.2.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.15.2.9.1" class="ltx_text" style="font-size:90%;">77.7</span></td>
<td id="S4.T3.15.13.15.2.10" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.15.2.10.1" class="ltx_text" style="font-size:90%;">25.6</span></td>
<td id="S4.T3.15.13.15.2.11" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.15.2.11.1" class="ltx_text" style="font-size:90%;">38.6</span></td>
<td id="S4.T3.15.13.15.2.12" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.15.2.12.1" class="ltx_text" style="font-size:90%;">28.0</span></td>
<td id="S4.T3.15.13.15.2.13" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.15.2.13.1" class="ltx_text" style="font-size:90%;">16.0</span></td>
<td id="S4.T3.15.13.15.2.14" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.15.2.14.1" class="ltx_text" style="font-size:90%;">28.1</span></td>
<td id="S4.T3.15.13.15.2.15" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.15.2.15.1" class="ltx_text" style="font-size:90%;">36.7</span></td>
</tr>
<tr id="S4.T3.15.13.16.3" class="ltx_tr">
<th id="S4.T3.15.13.16.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;">
<span id="S4.T3.15.13.16.3.1.1" class="ltx_text" style="font-size:90%;">ViLD* </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T3.15.13.16.3.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib16" title="" class="ltx_ref">16</a><span id="S4.T3.15.13.16.3.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S4.T3.15.13.16.3.2" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.16.3.2.1" class="ltx_text" style="font-size:90%;">73.9</span></td>
<td id="S4.T3.15.13.16.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.16.3.3.1" class="ltx_text" style="font-size:90%;">57.9</span></td>
<td id="S4.T3.15.13.16.3.4" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.16.3.4.1" class="ltx_text" style="font-size:90%;">34.1</span></td>
<td id="S4.T3.15.13.16.3.5" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.16.3.5.1" class="ltx_text" style="font-size:90%;">52.3</span></td>
<td id="S4.T3.15.13.16.3.6" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.16.3.6.1" class="ltx_text" style="font-size:90%;">36.5</span></td>
<td id="S4.T3.15.13.16.3.7" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.16.3.7.1" class="ltx_text" style="font-size:90%;">21.6</span></td>
<td id="S4.T3.15.13.16.3.8" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.16.3.8.1" class="ltx_text" style="font-size:90%;">38.9</span></td>
<td id="S4.T3.15.13.16.3.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.16.3.9.1" class="ltx_text" style="font-size:90%;">46.1</span></td>
<td id="S4.T3.15.13.16.3.10" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.16.3.10.1" class="ltx_text" style="font-size:90%;">11.5</span></td>
<td id="S4.T3.15.13.16.3.11" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.16.3.11.1" class="ltx_text" style="font-size:90%;">17.8</span></td>
<td id="S4.T3.15.13.16.3.12" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.16.3.12.1" class="ltx_text" style="font-size:90%;">12.3</span></td>
<td id="S4.T3.15.13.16.3.13" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.16.3.13.1" class="ltx_text" style="font-size:90%;">4.2</span></td>
<td id="S4.T3.15.13.16.3.14" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.16.3.14.1" class="ltx_text" style="font-size:90%;">11.1</span></td>
<td id="S4.T3.15.13.16.3.15" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.16.3.15.1" class="ltx_text" style="font-size:90%;">17.8</span></td>
</tr>
<tr id="S4.T3.15.13.13" class="ltx_tr">
<th id="S4.T3.15.13.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding:0.45pt 3.0pt;">
<span id="S4.T3.15.13.13.1.1" class="ltx_text" style="font-size:90%;">BARON (Ours)</span><sup id="S4.T3.15.13.13.1.2" class="ltx_sup"><span id="S4.T3.15.13.13.1.2.1" class="ltx_text" style="font-size:90%;">‡</span></sup>
</th>
<td id="S4.T3.15.13.13.2" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.13.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">74.5</span></td>
<td id="S4.T3.15.13.13.3" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.13.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">57.9</span></td>
<td id="S4.T3.15.13.13.4" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.13.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">36.3</span></td>
<td id="S4.T3.15.13.13.5" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.13.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">56.1</span></td>
<td id="S4.T3.15.13.13.6" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.13.6.1" class="ltx_text ltx_font_bold" style="font-size:90%;">39.3</span></td>
<td id="S4.T3.15.13.13.7" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.13.7.1" class="ltx_text ltx_font_bold" style="font-size:90%;">25.4</span></td>
<td id="S4.T3.15.13.13.8" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.13.8.1" class="ltx_text ltx_font_bold" style="font-size:90%;">39.5</span></td>
<td id="S4.T3.15.13.13.9" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.13.9.1" class="ltx_text ltx_font_bold" style="font-size:90%;">48.2</span></td>
<td id="S4.T3.15.13.13.10" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.13.10.1" class="ltx_text ltx_font_bold" style="font-size:90%;">13.2</span></td>
<td id="S4.T3.15.13.13.11" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.13.11.1" class="ltx_text ltx_font_bold" style="font-size:90%;">20.0</span></td>
<td id="S4.T3.15.13.13.12" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.13.12.1" class="ltx_text ltx_font_bold" style="font-size:90%;">14.0</span></td>
<td id="S4.T3.15.13.13.13" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.13.13.1" class="ltx_text ltx_font_bold" style="font-size:90%;">4.8</span></td>
<td id="S4.T3.15.13.13.14" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.13.14.1" class="ltx_text ltx_font_bold" style="font-size:90%;">12.7</span></td>
<td id="S4.T3.15.13.13.15" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.13.15.1" class="ltx_text ltx_font_bold" style="font-size:90%;">20.1</span></td>
</tr>
<tr id="S4.T3.15.13.17.4" class="ltx_tr">
<th id="S4.T3.15.13.17.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;">
<span id="S4.T3.15.13.17.4.1.1" class="ltx_text" style="font-size:90%;">DetPro </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T3.15.13.17.4.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib11" title="" class="ltx_ref">11</a><span id="S4.T3.15.13.17.4.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S4.T3.15.13.17.4.2" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.17.4.2.1" class="ltx_text" style="font-size:90%;">74.6</span></td>
<td id="S4.T3.15.13.17.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.17.4.3.1" class="ltx_text" style="font-size:90%;">57.9</span></td>
<td id="S4.T3.15.13.17.4.4" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.17.4.4.1" class="ltx_text" style="font-size:90%;">34.9</span></td>
<td id="S4.T3.15.13.17.4.5" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.17.4.5.1" class="ltx_text" style="font-size:90%;">53.8</span></td>
<td id="S4.T3.15.13.17.4.6" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.17.4.6.1" class="ltx_text" style="font-size:90%;">37.4</span></td>
<td id="S4.T3.15.13.17.4.7" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.17.4.7.1" class="ltx_text" style="font-size:90%;">22.5</span></td>
<td id="S4.T3.15.13.17.4.8" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.17.4.8.1" class="ltx_text" style="font-size:90%;">39.6</span></td>
<td id="S4.T3.15.13.17.4.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.17.4.9.1" class="ltx_text" style="font-size:90%;">46.3</span></td>
<td id="S4.T3.15.13.17.4.10" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.17.4.10.1" class="ltx_text" style="font-size:90%;">12.1</span></td>
<td id="S4.T3.15.13.17.4.11" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.17.4.11.1" class="ltx_text" style="font-size:90%;">18.8</span></td>
<td id="S4.T3.15.13.17.4.12" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.17.4.12.1" class="ltx_text" style="font-size:90%;">12.9</span></td>
<td id="S4.T3.15.13.17.4.13" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.17.4.13.1" class="ltx_text" style="font-size:90%;">4.5</span></td>
<td id="S4.T3.15.13.17.4.14" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.17.4.14.1" class="ltx_text" style="font-size:90%;">11.5</span></td>
<td id="S4.T3.15.13.17.4.15" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.17.4.15.1" class="ltx_text" style="font-size:90%;">18.6</span></td>
</tr>
<tr id="S4.T3.15.13.18.5" class="ltx_tr">
<th id="S4.T3.15.13.18.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.18.5.1.1" class="ltx_text" style="font-size:90%;">BARON (Ours)</span></th>
<td id="S4.T3.15.13.18.5.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.18.5.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">76.0</span></td>
<td id="S4.T3.15.13.18.5.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.18.5.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">58.2</span></td>
<td id="S4.T3.15.13.18.5.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.18.5.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">36.2</span></td>
<td id="S4.T3.15.13.18.5.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.18.5.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">55.7</span></td>
<td id="S4.T3.15.13.18.5.6" class="ltx_td ltx_align_center ltx_border_bb" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.18.5.6.1" class="ltx_text ltx_font_bold" style="font-size:90%;">39.1</span></td>
<td id="S4.T3.15.13.18.5.7" class="ltx_td ltx_align_center ltx_border_bb" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.18.5.7.1" class="ltx_text ltx_font_bold" style="font-size:90%;">24.8</span></td>
<td id="S4.T3.15.13.18.5.8" class="ltx_td ltx_align_center ltx_border_bb" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.18.5.8.1" class="ltx_text ltx_font_bold" style="font-size:90%;">40.2</span></td>
<td id="S4.T3.15.13.18.5.9" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.18.5.9.1" class="ltx_text ltx_font_bold" style="font-size:90%;">47.3</span></td>
<td id="S4.T3.15.13.18.5.10" class="ltx_td ltx_align_center ltx_border_bb" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.18.5.10.1" class="ltx_text ltx_font_bold" style="font-size:90%;">13.6</span></td>
<td id="S4.T3.15.13.18.5.11" class="ltx_td ltx_align_center ltx_border_bb" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.18.5.11.1" class="ltx_text ltx_font_bold" style="font-size:90%;">21.0</span></td>
<td id="S4.T3.15.13.18.5.12" class="ltx_td ltx_align_center ltx_border_bb" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.18.5.12.1" class="ltx_text ltx_font_bold" style="font-size:90%;">14.5</span></td>
<td id="S4.T3.15.13.18.5.13" class="ltx_td ltx_align_center ltx_border_bb" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.18.5.13.1" class="ltx_text ltx_font_bold" style="font-size:90%;">5.0</span></td>
<td id="S4.T3.15.13.18.5.14" class="ltx_td ltx_align_center ltx_border_bb" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.18.5.14.1" class="ltx_text ltx_font_bold" style="font-size:90%;">13.1</span></td>
<td id="S4.T3.15.13.18.5.15" class="ltx_td ltx_align_center ltx_border_bb" style="padding:0.45pt 3.0pt;"><span id="S4.T3.15.13.18.5.15.1" class="ltx_text ltx_font_bold" style="font-size:90%;">20.7</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Benchmark Results</h3>

<div id="S4.SS1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS1.p1.1" class="ltx_p"><span id="S4.SS1.p1.1.1" class="ltx_text ltx_font_bold">OV-COCO.</span>
We report the comparison with previous methods in Table <a href="#S3.T1" title="Table 1 ‣ 3.4 Aligning Bag of Regions ‣ 3 Method ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.
BARON surpasses previous state of the arts with either pre-trained VLMs or COCO captions <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>, indicating its effectiveness and flexibility.
Note that OV-DETR is based on the Deformable DETR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib62" title="" class="ltx_ref">62</a>]</cite>, which is stronger than the Faster R-CNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite> with higher performance on base categories.
But BARON still outperforms OV-DETR by 4.6 AP<sub id="S4.SS1.p1.1.2" class="ltx_sub"><span id="S4.SS1.p1.1.2.1" class="ltx_text ltx_font_italic">50</span></sub> on novel categories.
When using caption supervision, BARON even outperforms PB-OVD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> that uses sophisticated pseudo-labeling. Combining CLIP image features, COCO captions, and MAVL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite> proposals, BARON significantly outperforms Rasheed <em id="S4.SS1.p1.1.3" class="ltx_emph ltx_font_italic">et al</em>.<span id="S4.SS1.p1.1.4" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite> by a large margin.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para ltx_noindent">
<p id="S4.SS1.p2.2" class="ltx_p"><span id="S4.SS1.p2.2.1" class="ltx_text ltx_font_bold">OV-LVIS.</span>
We compare BARON with other methods on the OV-LVIS benchmark in Table <a href="#S4.T2" title="Table 2 ‣ 4 Experiments ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.
Because ViLD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> is trained with large-scale jittering <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> and a prohibitive <math id="S4.SS1.p2.1.m1.1" class="ltx_math_unparsed" alttext="32\times" display="inline"><semantics id="S4.SS1.p2.1.m1.1a"><mrow id="S4.SS1.p2.1.m1.1b"><mn id="S4.SS1.p2.1.m1.1.1">32</mn><mo lspace="0.222em" id="S4.SS1.p2.1.m1.1.2">×</mo></mrow><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">32\times</annotation></semantics></math> schedule, DetPro <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> re-implemented it with backbone weights pre-trained by SOCO <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib51" title="" class="ltx_ref">51</a>]</cite> and a regular <math id="S4.SS1.p2.2.m2.1" class="ltx_math_unparsed" alttext="2\times" display="inline"><semantics id="S4.SS1.p2.2.m2.1a"><mrow id="S4.SS1.p2.2.m2.1b"><mn id="S4.SS1.p2.2.m2.1.1">2</mn><mo lspace="0.222em" id="S4.SS1.p2.2.m2.1.2">×</mo></mrow><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">2\times</annotation></semantics></math> schedule.
DetPro also proposes learned prompts for the category’s names. Besides, an ensembling strategy for classification scores is adopted in ViLD and DetPro.
For fair comparison, we respectively implement our method on OV-LVIS with and without the these tricks.
<span id="S4.SS1.p2.2.2" class="ltx_text">BARON</span> achieves the best performance in all the scenarios and can even surpass ViLD that adopts the ensembling strategy without these tricks.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para ltx_noindent">
<p id="S4.SS1.p3.1" class="ltx_p"><span id="S4.SS1.p3.1.1" class="ltx_text ltx_font_bold">Transfer to Other Datasets.</span>
We transfer the open-vocabulary detector trained on OV-LVIS to three other datasets, including Pascal VOC 2007 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> test set, COCO <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> validation set and Objects365 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite> v2 validation set. We compare our results with DetPro <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> and the ViLD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> implemented in DetPro. The comparison is fair since all the models are based on the same object detector and training schedule.
As shown in Table <a href="#S4.T3" title="Table 3 ‣ 4 Experiments ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, our approach exhibits better generalization ability on all of the three datasets.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Ablation Study</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">In this section, we ablate the effectiveness of components in <span id="S4.SS2.p1.1.1" class="ltx_text">BARON</span>on OV-COCO benchmark.</p>
</div>
<figure id="S4.T6" class="ltx_table">
<div class="ltx_flex_figure ltx_flex_table">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.T6.5" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_top" style="width:154.0pt;">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.T6.5.7.1.1" class="ltx_text" style="font-size:90%;">Table 4</span>: </span><span id="S4.T6.5.8.2" class="ltx_text" style="font-size:90%;">Effectiveness of main components of <span id="S4.T6.5.8.2.1" class="ltx_text">BARON</span></span></figcaption>
<div id="S4.T6.5.5" class="ltx_inline-block ltx_transformed_outer" style="width:137.1pt;height:72.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-7.6pt,4.1pt) scale(0.9,0.9) ;">
<div id="S4.T6.5.5.5" class="ltx_inline-block ltx_transformed_outer" style="width:146.3pt;height:81pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-8.1pt,4.5pt) scale(0.9,0.9) ;">
<table id="S4.T6.5.5.5.5" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T6.5.5.5.5.5" class="ltx_tr">
<th id="S4.T6.5.5.5.5.5.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T6.5.5.5.5.5.6.1" class="ltx_text" style="font-size:90%;">#</span></th>
<th id="S4.T6.1.1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><math id="S4.T6.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{\mathrm{individual}}" display="inline"><semantics id="S4.T6.1.1.1.1.1.1.m1.1a"><msub id="S4.T6.1.1.1.1.1.1.m1.1.1" xref="S4.T6.1.1.1.1.1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S4.T6.1.1.1.1.1.1.m1.1.1.2" xref="S4.T6.1.1.1.1.1.1.m1.1.1.2.cmml">ℒ</mi><mi mathsize="90%" id="S4.T6.1.1.1.1.1.1.m1.1.1.3" xref="S4.T6.1.1.1.1.1.1.m1.1.1.3.cmml">individual</mi></msub><annotation-xml encoding="MathML-Content" id="S4.T6.1.1.1.1.1.1.m1.1b"><apply id="S4.T6.1.1.1.1.1.1.m1.1.1.cmml" xref="S4.T6.1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T6.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S4.T6.1.1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S4.T6.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S4.T6.1.1.1.1.1.1.m1.1.1.2">ℒ</ci><ci id="S4.T6.1.1.1.1.1.1.m1.1.1.3.cmml" xref="S4.T6.1.1.1.1.1.1.m1.1.1.3">individual</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.1.1.1.1.1.1.m1.1c">\mathcal{L}_{\mathrm{individual}}</annotation></semantics></math></th>
<th id="S4.T6.2.2.2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><math id="S4.T6.2.2.2.2.2.2.m1.1" class="ltx_Math" alttext="\mathcal{L}_{\mathrm{bag}}" display="inline"><semantics id="S4.T6.2.2.2.2.2.2.m1.1a"><msub id="S4.T6.2.2.2.2.2.2.m1.1.1" xref="S4.T6.2.2.2.2.2.2.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S4.T6.2.2.2.2.2.2.m1.1.1.2" xref="S4.T6.2.2.2.2.2.2.m1.1.1.2.cmml">ℒ</mi><mi mathsize="90%" id="S4.T6.2.2.2.2.2.2.m1.1.1.3" xref="S4.T6.2.2.2.2.2.2.m1.1.1.3.cmml">bag</mi></msub><annotation-xml encoding="MathML-Content" id="S4.T6.2.2.2.2.2.2.m1.1b"><apply id="S4.T6.2.2.2.2.2.2.m1.1.1.cmml" xref="S4.T6.2.2.2.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T6.2.2.2.2.2.2.m1.1.1.1.cmml" xref="S4.T6.2.2.2.2.2.2.m1.1.1">subscript</csymbol><ci id="S4.T6.2.2.2.2.2.2.m1.1.1.2.cmml" xref="S4.T6.2.2.2.2.2.2.m1.1.1.2">ℒ</ci><ci id="S4.T6.2.2.2.2.2.2.m1.1.1.3.cmml" xref="S4.T6.2.2.2.2.2.2.m1.1.1.3">bag</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.2.2.2.2.2.2.m1.1c">\mathcal{L}_{\mathrm{bag}}</annotation></semantics></math></th>
<th id="S4.T6.5.5.5.5.5.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T6.5.5.5.5.5.7.1" class="ltx_text" style="font-size:90%;">PE</span></th>
<th id="S4.T6.3.3.3.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding:0.45pt 3.0pt;">
<span id="S4.T6.3.3.3.3.3.3.1" class="ltx_text" style="font-size:90%;">AP</span><math id="S4.T6.3.3.3.3.3.3.m1.1" class="ltx_Math" alttext="{}_{50}^{\text{novel}}" display="inline"><semantics id="S4.T6.3.3.3.3.3.3.m1.1a"><mmultiscripts id="S4.T6.3.3.3.3.3.3.m1.1.1" xref="S4.T6.3.3.3.3.3.3.m1.1.1.cmml"><mi id="S4.T6.3.3.3.3.3.3.m1.1.1.2.2" xref="S4.T6.3.3.3.3.3.3.m1.1.1.2.2.cmml"></mi><mprescripts id="S4.T6.3.3.3.3.3.3.m1.1.1a" xref="S4.T6.3.3.3.3.3.3.m1.1.1.cmml"></mprescripts><mrow id="S4.T6.3.3.3.3.3.3.m1.1.1b" xref="S4.T6.3.3.3.3.3.3.m1.1.1.cmml"></mrow><mtext mathsize="90%" id="S4.T6.3.3.3.3.3.3.m1.1.1.3" xref="S4.T6.3.3.3.3.3.3.m1.1.1.3a.cmml">novel</mtext><mn mathsize="90%" id="S4.T6.3.3.3.3.3.3.m1.1.1.2.3" xref="S4.T6.3.3.3.3.3.3.m1.1.1.2.3.cmml">50</mn><mrow id="S4.T6.3.3.3.3.3.3.m1.1.1c" xref="S4.T6.3.3.3.3.3.3.m1.1.1.cmml"></mrow></mmultiscripts><annotation-xml encoding="MathML-Content" id="S4.T6.3.3.3.3.3.3.m1.1b"><apply id="S4.T6.3.3.3.3.3.3.m1.1.1.cmml" xref="S4.T6.3.3.3.3.3.3.m1.1.1"><csymbol cd="ambiguous" id="S4.T6.3.3.3.3.3.3.m1.1.1.1.cmml" xref="S4.T6.3.3.3.3.3.3.m1.1.1">superscript</csymbol><apply id="S4.T6.3.3.3.3.3.3.m1.1.1.2.cmml" xref="S4.T6.3.3.3.3.3.3.m1.1.1"><csymbol cd="ambiguous" id="S4.T6.3.3.3.3.3.3.m1.1.1.2.1.cmml" xref="S4.T6.3.3.3.3.3.3.m1.1.1">subscript</csymbol><csymbol cd="latexml" id="S4.T6.3.3.3.3.3.3.m1.1.1.2.2.cmml" xref="S4.T6.3.3.3.3.3.3.m1.1.1.2.2">absent</csymbol><cn type="integer" id="S4.T6.3.3.3.3.3.3.m1.1.1.2.3.cmml" xref="S4.T6.3.3.3.3.3.3.m1.1.1.2.3">50</cn></apply><ci id="S4.T6.3.3.3.3.3.3.m1.1.1.3a.cmml" xref="S4.T6.3.3.3.3.3.3.m1.1.1.3"><mtext mathsize="63%" id="S4.T6.3.3.3.3.3.3.m1.1.1.3.cmml" xref="S4.T6.3.3.3.3.3.3.m1.1.1.3">novel</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.3.3.3.3.3.3.m1.1c">{}_{50}^{\text{novel}}</annotation></semantics></math>
</th>
<th id="S4.T6.4.4.4.4.4.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding:0.45pt 3.0pt;">
<span id="S4.T6.4.4.4.4.4.4.1" class="ltx_text" style="font-size:90%;">AP</span><math id="S4.T6.4.4.4.4.4.4.m1.1" class="ltx_Math" alttext="{}_{50}^{\text{base}}" display="inline"><semantics id="S4.T6.4.4.4.4.4.4.m1.1a"><mmultiscripts id="S4.T6.4.4.4.4.4.4.m1.1.1" xref="S4.T6.4.4.4.4.4.4.m1.1.1.cmml"><mi id="S4.T6.4.4.4.4.4.4.m1.1.1.2.2" xref="S4.T6.4.4.4.4.4.4.m1.1.1.2.2.cmml"></mi><mprescripts id="S4.T6.4.4.4.4.4.4.m1.1.1a" xref="S4.T6.4.4.4.4.4.4.m1.1.1.cmml"></mprescripts><mrow id="S4.T6.4.4.4.4.4.4.m1.1.1b" xref="S4.T6.4.4.4.4.4.4.m1.1.1.cmml"></mrow><mtext mathsize="90%" id="S4.T6.4.4.4.4.4.4.m1.1.1.3" xref="S4.T6.4.4.4.4.4.4.m1.1.1.3a.cmml">base</mtext><mn mathsize="90%" id="S4.T6.4.4.4.4.4.4.m1.1.1.2.3" xref="S4.T6.4.4.4.4.4.4.m1.1.1.2.3.cmml">50</mn><mrow id="S4.T6.4.4.4.4.4.4.m1.1.1c" xref="S4.T6.4.4.4.4.4.4.m1.1.1.cmml"></mrow></mmultiscripts><annotation-xml encoding="MathML-Content" id="S4.T6.4.4.4.4.4.4.m1.1b"><apply id="S4.T6.4.4.4.4.4.4.m1.1.1.cmml" xref="S4.T6.4.4.4.4.4.4.m1.1.1"><csymbol cd="ambiguous" id="S4.T6.4.4.4.4.4.4.m1.1.1.1.cmml" xref="S4.T6.4.4.4.4.4.4.m1.1.1">superscript</csymbol><apply id="S4.T6.4.4.4.4.4.4.m1.1.1.2.cmml" xref="S4.T6.4.4.4.4.4.4.m1.1.1"><csymbol cd="ambiguous" id="S4.T6.4.4.4.4.4.4.m1.1.1.2.1.cmml" xref="S4.T6.4.4.4.4.4.4.m1.1.1">subscript</csymbol><csymbol cd="latexml" id="S4.T6.4.4.4.4.4.4.m1.1.1.2.2.cmml" xref="S4.T6.4.4.4.4.4.4.m1.1.1.2.2">absent</csymbol><cn type="integer" id="S4.T6.4.4.4.4.4.4.m1.1.1.2.3.cmml" xref="S4.T6.4.4.4.4.4.4.m1.1.1.2.3">50</cn></apply><ci id="S4.T6.4.4.4.4.4.4.m1.1.1.3a.cmml" xref="S4.T6.4.4.4.4.4.4.m1.1.1.3"><mtext mathsize="63%" id="S4.T6.4.4.4.4.4.4.m1.1.1.3.cmml" xref="S4.T6.4.4.4.4.4.4.m1.1.1.3">base</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.4.4.4.4.4.4.m1.1c">{}_{50}^{\text{base}}</annotation></semantics></math>
</th>
<th id="S4.T6.5.5.5.5.5.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding:0.45pt 3.0pt;">
<span id="S4.T6.5.5.5.5.5.5.1" class="ltx_text" style="font-size:90%;">AP</span><sub id="S4.T6.5.5.5.5.5.5.2" class="ltx_sub"><span id="S4.T6.5.5.5.5.5.5.2.1" class="ltx_text ltx_font_italic" style="font-size:90%;">50</span></sub>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T6.5.5.5.5.6.1" class="ltx_tr">
<td id="S4.T6.5.5.5.5.6.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T6.5.5.5.5.6.1.1.1" class="ltx_text" style="font-size:90%;">1</span></td>
<td id="S4.T6.5.5.5.5.6.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T6.5.5.5.5.6.1.2.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S4.T6.5.5.5.5.6.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T6.5.5.5.5.6.1.3.1" class="ltx_text" style="font-size:90%;">-</span></td>
<td id="S4.T6.5.5.5.5.6.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T6.5.5.5.5.6.1.4.1" class="ltx_text" style="font-size:90%;">-</span></td>
<td id="S4.T6.5.5.5.5.6.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T6.5.5.5.5.6.1.5.1" class="ltx_text" style="font-size:90%;">25.7</span></td>
<td id="S4.T6.5.5.5.5.6.1.6" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T6.5.5.5.5.6.1.6.1" class="ltx_text" style="font-size:90%;">59.6</span></td>
<td id="S4.T6.5.5.5.5.6.1.7" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T6.5.5.5.5.6.1.7.1" class="ltx_text" style="font-size:90%;">50.6</span></td>
</tr>
<tr id="S4.T6.5.5.5.5.7.2" class="ltx_tr">
<td id="S4.T6.5.5.5.5.7.2.1" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T6.5.5.5.5.7.2.1.1" class="ltx_text" style="font-size:90%;">2</span></td>
<td id="S4.T6.5.5.5.5.7.2.2" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T6.5.5.5.5.7.2.2.1" class="ltx_text" style="font-size:90%;">-</span></td>
<td id="S4.T6.5.5.5.5.7.2.3" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T6.5.5.5.5.7.2.3.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S4.T6.5.5.5.5.7.2.4" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T6.5.5.5.5.7.2.4.1" class="ltx_text" style="font-size:90%;">-</span></td>
<td id="S4.T6.5.5.5.5.7.2.5" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T6.5.5.5.5.7.2.5.1" class="ltx_text" style="font-size:90%;">25.7</span></td>
<td id="S4.T6.5.5.5.5.7.2.6" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T6.5.5.5.5.7.2.6.1" class="ltx_text" style="font-size:90%;">59.4</span></td>
<td id="S4.T6.5.5.5.5.7.2.7" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T6.5.5.5.5.7.2.7.1" class="ltx_text" style="font-size:90%;">50.5</span></td>
</tr>
<tr id="S4.T6.5.5.5.5.8.3" class="ltx_tr">
<td id="S4.T6.5.5.5.5.8.3.1" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T6.5.5.5.5.8.3.1.1" class="ltx_text" style="font-size:90%;">3</span></td>
<td id="S4.T6.5.5.5.5.8.3.2" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T6.5.5.5.5.8.3.2.1" class="ltx_text" style="font-size:90%;">-</span></td>
<td id="S4.T6.5.5.5.5.8.3.3" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T6.5.5.5.5.8.3.3.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S4.T6.5.5.5.5.8.3.4" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T6.5.5.5.5.8.3.4.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S4.T6.5.5.5.5.8.3.5" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T6.5.5.5.5.8.3.5.1" class="ltx_text" style="font-size:90%;">32.8</span></td>
<td id="S4.T6.5.5.5.5.8.3.6" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T6.5.5.5.5.8.3.6.1" class="ltx_text" style="font-size:90%;">60.1</span></td>
<td id="S4.T6.5.5.5.5.8.3.7" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T6.5.5.5.5.8.3.7.1" class="ltx_text" style="font-size:90%;">53.0</span></td>
</tr>
<tr id="S4.T6.5.5.5.5.9.4" class="ltx_tr">
<td id="S4.T6.5.5.5.5.9.4.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T6.5.5.5.5.9.4.1.1" class="ltx_text" style="font-size:90%;">4</span></td>
<td id="S4.T6.5.5.5.5.9.4.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T6.5.5.5.5.9.4.2.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S4.T6.5.5.5.5.9.4.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T6.5.5.5.5.9.4.3.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S4.T6.5.5.5.5.9.4.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T6.5.5.5.5.9.4.4.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S4.T6.5.5.5.5.9.4.5" class="ltx_td ltx_align_center ltx_border_b" style="padding:0.45pt 3.0pt;"><span id="S4.T6.5.5.5.5.9.4.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">34.0</span></td>
<td id="S4.T6.5.5.5.5.9.4.6" class="ltx_td ltx_align_center ltx_border_b" style="padding:0.45pt 3.0pt;"><span id="S4.T6.5.5.5.5.9.4.6.1" class="ltx_text" style="font-size:90%;">60.4</span></td>
<td id="S4.T6.5.5.5.5.9.4.7" class="ltx_td ltx_align_center ltx_border_b" style="padding:0.45pt 3.0pt;"><span id="S4.T6.5.5.5.5.9.4.7.1" class="ltx_text" style="font-size:90%;">53.5</span></td>
</tr>
</tbody>
</table>
</span></div>
</span></div>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.T6.9" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_top" style="width:154.0pt;">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.T6.9.5.1.1" class="ltx_text" style="font-size:90%;">Table 5</span>: </span><span id="S4.T6.9.6.2" class="ltx_text" style="font-size:90%;">Exploring sampling strategies to obtain bag of regions</span></figcaption>
<div id="S4.T6.9.4" class="ltx_inline-block ltx_transformed_outer" style="width:140.2pt;height:72.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-7.8pt,4.1pt) scale(0.9,0.9) ;">
<div id="S4.T6.9.4.4" class="ltx_inline-block ltx_transformed_outer" style="width:149.8pt;height:81pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-8.3pt,4.5pt) scale(0.9,0.9) ;">
<table id="S4.T6.9.4.4.4" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T6.9.4.4.4.4" class="ltx_tr">
<th id="S4.T6.6.1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><math id="S4.T6.6.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\#" display="inline"><semantics id="S4.T6.6.1.1.1.1.1.m1.1a"><mi mathsize="90%" mathvariant="normal" id="S4.T6.6.1.1.1.1.1.m1.1.1" xref="S4.T6.6.1.1.1.1.1.m1.1.1.cmml">#</mi><annotation-xml encoding="MathML-Content" id="S4.T6.6.1.1.1.1.1.m1.1b"><ci id="S4.T6.6.1.1.1.1.1.m1.1.1.cmml" xref="S4.T6.6.1.1.1.1.1.m1.1.1">#</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.6.1.1.1.1.1.m1.1c">\#</annotation></semantics></math></th>
<th id="S4.T6.9.4.4.4.4.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T6.9.4.4.4.4.5.1" class="ltx_text" style="font-size:90%;">Sampling strategy</span></th>
<th id="S4.T6.7.2.2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding:0.45pt 3.0pt;">
<span id="S4.T6.7.2.2.2.2.2.1" class="ltx_text" style="font-size:90%;">AP</span><math id="S4.T6.7.2.2.2.2.2.m1.1" class="ltx_Math" alttext="{}_{50}^{\text{novel}}" display="inline"><semantics id="S4.T6.7.2.2.2.2.2.m1.1a"><mmultiscripts id="S4.T6.7.2.2.2.2.2.m1.1.1" xref="S4.T6.7.2.2.2.2.2.m1.1.1.cmml"><mi id="S4.T6.7.2.2.2.2.2.m1.1.1.2.2" xref="S4.T6.7.2.2.2.2.2.m1.1.1.2.2.cmml"></mi><mprescripts id="S4.T6.7.2.2.2.2.2.m1.1.1a" xref="S4.T6.7.2.2.2.2.2.m1.1.1.cmml"></mprescripts><mrow id="S4.T6.7.2.2.2.2.2.m1.1.1b" xref="S4.T6.7.2.2.2.2.2.m1.1.1.cmml"></mrow><mtext mathsize="90%" id="S4.T6.7.2.2.2.2.2.m1.1.1.3" xref="S4.T6.7.2.2.2.2.2.m1.1.1.3a.cmml">novel</mtext><mn mathsize="90%" id="S4.T6.7.2.2.2.2.2.m1.1.1.2.3" xref="S4.T6.7.2.2.2.2.2.m1.1.1.2.3.cmml">50</mn><mrow id="S4.T6.7.2.2.2.2.2.m1.1.1c" xref="S4.T6.7.2.2.2.2.2.m1.1.1.cmml"></mrow></mmultiscripts><annotation-xml encoding="MathML-Content" id="S4.T6.7.2.2.2.2.2.m1.1b"><apply id="S4.T6.7.2.2.2.2.2.m1.1.1.cmml" xref="S4.T6.7.2.2.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T6.7.2.2.2.2.2.m1.1.1.1.cmml" xref="S4.T6.7.2.2.2.2.2.m1.1.1">superscript</csymbol><apply id="S4.T6.7.2.2.2.2.2.m1.1.1.2.cmml" xref="S4.T6.7.2.2.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T6.7.2.2.2.2.2.m1.1.1.2.1.cmml" xref="S4.T6.7.2.2.2.2.2.m1.1.1">subscript</csymbol><csymbol cd="latexml" id="S4.T6.7.2.2.2.2.2.m1.1.1.2.2.cmml" xref="S4.T6.7.2.2.2.2.2.m1.1.1.2.2">absent</csymbol><cn type="integer" id="S4.T6.7.2.2.2.2.2.m1.1.1.2.3.cmml" xref="S4.T6.7.2.2.2.2.2.m1.1.1.2.3">50</cn></apply><ci id="S4.T6.7.2.2.2.2.2.m1.1.1.3a.cmml" xref="S4.T6.7.2.2.2.2.2.m1.1.1.3"><mtext mathsize="63%" id="S4.T6.7.2.2.2.2.2.m1.1.1.3.cmml" xref="S4.T6.7.2.2.2.2.2.m1.1.1.3">novel</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.7.2.2.2.2.2.m1.1c">{}_{50}^{\text{novel}}</annotation></semantics></math>
</th>
<th id="S4.T6.8.3.3.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding:0.45pt 3.0pt;">
<span id="S4.T6.8.3.3.3.3.3.1" class="ltx_text" style="font-size:90%;">AP</span><math id="S4.T6.8.3.3.3.3.3.m1.1" class="ltx_Math" alttext="{}_{50}^{\text{base}}" display="inline"><semantics id="S4.T6.8.3.3.3.3.3.m1.1a"><mmultiscripts id="S4.T6.8.3.3.3.3.3.m1.1.1" xref="S4.T6.8.3.3.3.3.3.m1.1.1.cmml"><mi id="S4.T6.8.3.3.3.3.3.m1.1.1.2.2" xref="S4.T6.8.3.3.3.3.3.m1.1.1.2.2.cmml"></mi><mprescripts id="S4.T6.8.3.3.3.3.3.m1.1.1a" xref="S4.T6.8.3.3.3.3.3.m1.1.1.cmml"></mprescripts><mrow id="S4.T6.8.3.3.3.3.3.m1.1.1b" xref="S4.T6.8.3.3.3.3.3.m1.1.1.cmml"></mrow><mtext mathsize="90%" id="S4.T6.8.3.3.3.3.3.m1.1.1.3" xref="S4.T6.8.3.3.3.3.3.m1.1.1.3a.cmml">base</mtext><mn mathsize="90%" id="S4.T6.8.3.3.3.3.3.m1.1.1.2.3" xref="S4.T6.8.3.3.3.3.3.m1.1.1.2.3.cmml">50</mn><mrow id="S4.T6.8.3.3.3.3.3.m1.1.1c" xref="S4.T6.8.3.3.3.3.3.m1.1.1.cmml"></mrow></mmultiscripts><annotation-xml encoding="MathML-Content" id="S4.T6.8.3.3.3.3.3.m1.1b"><apply id="S4.T6.8.3.3.3.3.3.m1.1.1.cmml" xref="S4.T6.8.3.3.3.3.3.m1.1.1"><csymbol cd="ambiguous" id="S4.T6.8.3.3.3.3.3.m1.1.1.1.cmml" xref="S4.T6.8.3.3.3.3.3.m1.1.1">superscript</csymbol><apply id="S4.T6.8.3.3.3.3.3.m1.1.1.2.cmml" xref="S4.T6.8.3.3.3.3.3.m1.1.1"><csymbol cd="ambiguous" id="S4.T6.8.3.3.3.3.3.m1.1.1.2.1.cmml" xref="S4.T6.8.3.3.3.3.3.m1.1.1">subscript</csymbol><csymbol cd="latexml" id="S4.T6.8.3.3.3.3.3.m1.1.1.2.2.cmml" xref="S4.T6.8.3.3.3.3.3.m1.1.1.2.2">absent</csymbol><cn type="integer" id="S4.T6.8.3.3.3.3.3.m1.1.1.2.3.cmml" xref="S4.T6.8.3.3.3.3.3.m1.1.1.2.3">50</cn></apply><ci id="S4.T6.8.3.3.3.3.3.m1.1.1.3a.cmml" xref="S4.T6.8.3.3.3.3.3.m1.1.1.3"><mtext mathsize="63%" id="S4.T6.8.3.3.3.3.3.m1.1.1.3.cmml" xref="S4.T6.8.3.3.3.3.3.m1.1.1.3">base</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.8.3.3.3.3.3.m1.1c">{}_{50}^{\text{base}}</annotation></semantics></math>
</th>
<th id="S4.T6.9.4.4.4.4.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding:0.45pt 3.0pt;">
<span id="S4.T6.9.4.4.4.4.4.1" class="ltx_text" style="font-size:90%;">AP</span><sub id="S4.T6.9.4.4.4.4.4.2" class="ltx_sub"><span id="S4.T6.9.4.4.4.4.4.2.1" class="ltx_text ltx_font_italic" style="font-size:90%;">50</span></sub>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T6.9.4.4.4.5.1" class="ltx_tr">
<th id="S4.T6.9.4.4.4.5.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T6.9.4.4.4.5.1.1.1" class="ltx_text" style="font-size:90%;">1</span></th>
<th id="S4.T6.9.4.4.4.5.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T6.9.4.4.4.5.1.2.1" class="ltx_text" style="font-size:90%;">Grid</span></th>
<td id="S4.T6.9.4.4.4.5.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T6.9.4.4.4.5.1.3.1" class="ltx_text" style="font-size:90%;">25.4</span></td>
<td id="S4.T6.9.4.4.4.5.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T6.9.4.4.4.5.1.4.1" class="ltx_text" style="font-size:90%;">58.0</span></td>
<td id="S4.T6.9.4.4.4.5.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T6.9.4.4.4.5.1.5.1" class="ltx_text" style="font-size:90%;">49.5</span></td>
</tr>
<tr id="S4.T6.9.4.4.4.6.2" class="ltx_tr">
<th id="S4.T6.9.4.4.4.6.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T6.9.4.4.4.6.2.1.1" class="ltx_text" style="font-size:90%;">2</span></th>
<th id="S4.T6.9.4.4.4.6.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T6.9.4.4.4.6.2.2.1" class="ltx_text" style="font-size:90%;">Random</span></th>
<td id="S4.T6.9.4.4.4.6.2.3" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T6.9.4.4.4.6.2.3.1" class="ltx_text" style="font-size:90%;">27.3</span></td>
<td id="S4.T6.9.4.4.4.6.2.4" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T6.9.4.4.4.6.2.4.1" class="ltx_text" style="font-size:90%;">53.3</span></td>
<td id="S4.T6.9.4.4.4.6.2.5" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T6.9.4.4.4.6.2.5.1" class="ltx_text" style="font-size:90%;">46.5</span></td>
</tr>
<tr id="S4.T6.9.4.4.4.7.3" class="ltx_tr">
<th id="S4.T6.9.4.4.4.7.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T6.9.4.4.4.7.3.1.1" class="ltx_text" style="font-size:90%;">3</span></th>
<th id="S4.T6.9.4.4.4.7.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T6.9.4.4.4.7.3.2.1" class="ltx_text" style="font-size:90%;">Ours (reduced)</span></th>
<td id="S4.T6.9.4.4.4.7.3.3" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T6.9.4.4.4.7.3.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">32.2</span></td>
<td id="S4.T6.9.4.4.4.7.3.4" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T6.9.4.4.4.7.3.4.1" class="ltx_text" style="font-size:90%;">58.3</span></td>
<td id="S4.T6.9.4.4.4.7.3.5" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T6.9.4.4.4.7.3.5.1" class="ltx_text" style="font-size:90%;">51.5</span></td>
</tr>
<tr id="S4.T6.9.4.4.4.8.4" class="ltx_tr">
<th id="S4.T6.9.4.4.4.8.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T6.9.4.4.4.8.4.1.1" class="ltx_text" style="font-size:90%;">4</span></th>
<th id="S4.T6.9.4.4.4.8.4.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T6.9.4.4.4.8.4.2.1" class="ltx_text" style="font-size:90%;">Ours</span></th>
<td id="S4.T6.9.4.4.4.8.4.3" class="ltx_td ltx_align_center ltx_border_b" style="padding:0.45pt 3.0pt;"><span id="S4.T6.9.4.4.4.8.4.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">34.0</span></td>
<td id="S4.T6.9.4.4.4.8.4.4" class="ltx_td ltx_align_center ltx_border_b" style="padding:0.45pt 3.0pt;"><span id="S4.T6.9.4.4.4.8.4.4.1" class="ltx_text" style="font-size:90%;">60.4</span></td>
<td id="S4.T6.9.4.4.4.8.4.5" class="ltx_td ltx_align_center ltx_border_b" style="padding:0.45pt 3.0pt;"><span id="S4.T6.9.4.4.4.8.4.5.1" class="ltx_text" style="font-size:90%;">53.5</span></td>
</tr>
</tbody>
</table>
</span></div>
</span></div>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.T6.12" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_top" style="width:154.0pt;">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.T6.12.4.1.1" class="ltx_text" style="font-size:90%;">Table 6</span>: </span><span id="S4.T6.12.5.2" class="ltx_text" style="font-size:90%;">Overlap (IOF) between regions</span></figcaption>
<div id="S4.T6.12.3" class="ltx_inline-block ltx_transformed_outer" style="width:111.2pt;height:89pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-5.1pt,4.1pt) scale(0.916,0.916) ;">
<div id="S4.T6.12.3.3" class="ltx_inline-block ltx_transformed_outer" style="width:115.4pt;height:97.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-6.4pt,5.4pt) scale(0.9,0.9) ;">
<table id="S4.T6.12.3.3.3" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T6.12.3.3.3.3" class="ltx_tr">
<th id="S4.T6.12.3.3.3.3.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T6.12.3.3.3.3.4.1" class="ltx_text" style="font-size:90%;">#</span></th>
<th id="S4.T6.12.3.3.3.3.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T6.12.3.3.3.3.5.1" class="ltx_text" style="font-size:90%;">Overlap</span></th>
<th id="S4.T6.10.1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding:0.45pt 3.0pt;">
<span id="S4.T6.10.1.1.1.1.1.1" class="ltx_text" style="font-size:90%;">AP</span><math id="S4.T6.10.1.1.1.1.1.m1.1" class="ltx_Math" alttext="{}_{50}^{\text{novel}}" display="inline"><semantics id="S4.T6.10.1.1.1.1.1.m1.1a"><mmultiscripts id="S4.T6.10.1.1.1.1.1.m1.1.1" xref="S4.T6.10.1.1.1.1.1.m1.1.1.cmml"><mi id="S4.T6.10.1.1.1.1.1.m1.1.1.2.2" xref="S4.T6.10.1.1.1.1.1.m1.1.1.2.2.cmml"></mi><mprescripts id="S4.T6.10.1.1.1.1.1.m1.1.1a" xref="S4.T6.10.1.1.1.1.1.m1.1.1.cmml"></mprescripts><mrow id="S4.T6.10.1.1.1.1.1.m1.1.1b" xref="S4.T6.10.1.1.1.1.1.m1.1.1.cmml"></mrow><mtext mathsize="90%" id="S4.T6.10.1.1.1.1.1.m1.1.1.3" xref="S4.T6.10.1.1.1.1.1.m1.1.1.3a.cmml">novel</mtext><mn mathsize="90%" id="S4.T6.10.1.1.1.1.1.m1.1.1.2.3" xref="S4.T6.10.1.1.1.1.1.m1.1.1.2.3.cmml">50</mn><mrow id="S4.T6.10.1.1.1.1.1.m1.1.1c" xref="S4.T6.10.1.1.1.1.1.m1.1.1.cmml"></mrow></mmultiscripts><annotation-xml encoding="MathML-Content" id="S4.T6.10.1.1.1.1.1.m1.1b"><apply id="S4.T6.10.1.1.1.1.1.m1.1.1.cmml" xref="S4.T6.10.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T6.10.1.1.1.1.1.m1.1.1.1.cmml" xref="S4.T6.10.1.1.1.1.1.m1.1.1">superscript</csymbol><apply id="S4.T6.10.1.1.1.1.1.m1.1.1.2.cmml" xref="S4.T6.10.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T6.10.1.1.1.1.1.m1.1.1.2.1.cmml" xref="S4.T6.10.1.1.1.1.1.m1.1.1">subscript</csymbol><csymbol cd="latexml" id="S4.T6.10.1.1.1.1.1.m1.1.1.2.2.cmml" xref="S4.T6.10.1.1.1.1.1.m1.1.1.2.2">absent</csymbol><cn type="integer" id="S4.T6.10.1.1.1.1.1.m1.1.1.2.3.cmml" xref="S4.T6.10.1.1.1.1.1.m1.1.1.2.3">50</cn></apply><ci id="S4.T6.10.1.1.1.1.1.m1.1.1.3a.cmml" xref="S4.T6.10.1.1.1.1.1.m1.1.1.3"><mtext mathsize="63%" id="S4.T6.10.1.1.1.1.1.m1.1.1.3.cmml" xref="S4.T6.10.1.1.1.1.1.m1.1.1.3">novel</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.10.1.1.1.1.1.m1.1c">{}_{50}^{\text{novel}}</annotation></semantics></math>
</th>
<th id="S4.T6.11.2.2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding:0.45pt 3.0pt;">
<span id="S4.T6.11.2.2.2.2.2.1" class="ltx_text" style="font-size:90%;">AP</span><math id="S4.T6.11.2.2.2.2.2.m1.1" class="ltx_Math" alttext="{}_{50}^{\text{base}}" display="inline"><semantics id="S4.T6.11.2.2.2.2.2.m1.1a"><mmultiscripts id="S4.T6.11.2.2.2.2.2.m1.1.1" xref="S4.T6.11.2.2.2.2.2.m1.1.1.cmml"><mi id="S4.T6.11.2.2.2.2.2.m1.1.1.2.2" xref="S4.T6.11.2.2.2.2.2.m1.1.1.2.2.cmml"></mi><mprescripts id="S4.T6.11.2.2.2.2.2.m1.1.1a" xref="S4.T6.11.2.2.2.2.2.m1.1.1.cmml"></mprescripts><mrow id="S4.T6.11.2.2.2.2.2.m1.1.1b" xref="S4.T6.11.2.2.2.2.2.m1.1.1.cmml"></mrow><mtext mathsize="90%" id="S4.T6.11.2.2.2.2.2.m1.1.1.3" xref="S4.T6.11.2.2.2.2.2.m1.1.1.3a.cmml">base</mtext><mn mathsize="90%" id="S4.T6.11.2.2.2.2.2.m1.1.1.2.3" xref="S4.T6.11.2.2.2.2.2.m1.1.1.2.3.cmml">50</mn><mrow id="S4.T6.11.2.2.2.2.2.m1.1.1c" xref="S4.T6.11.2.2.2.2.2.m1.1.1.cmml"></mrow></mmultiscripts><annotation-xml encoding="MathML-Content" id="S4.T6.11.2.2.2.2.2.m1.1b"><apply id="S4.T6.11.2.2.2.2.2.m1.1.1.cmml" xref="S4.T6.11.2.2.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T6.11.2.2.2.2.2.m1.1.1.1.cmml" xref="S4.T6.11.2.2.2.2.2.m1.1.1">superscript</csymbol><apply id="S4.T6.11.2.2.2.2.2.m1.1.1.2.cmml" xref="S4.T6.11.2.2.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T6.11.2.2.2.2.2.m1.1.1.2.1.cmml" xref="S4.T6.11.2.2.2.2.2.m1.1.1">subscript</csymbol><csymbol cd="latexml" id="S4.T6.11.2.2.2.2.2.m1.1.1.2.2.cmml" xref="S4.T6.11.2.2.2.2.2.m1.1.1.2.2">absent</csymbol><cn type="integer" id="S4.T6.11.2.2.2.2.2.m1.1.1.2.3.cmml" xref="S4.T6.11.2.2.2.2.2.m1.1.1.2.3">50</cn></apply><ci id="S4.T6.11.2.2.2.2.2.m1.1.1.3a.cmml" xref="S4.T6.11.2.2.2.2.2.m1.1.1.3"><mtext mathsize="63%" id="S4.T6.11.2.2.2.2.2.m1.1.1.3.cmml" xref="S4.T6.11.2.2.2.2.2.m1.1.1.3">base</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.11.2.2.2.2.2.m1.1c">{}_{50}^{\text{base}}</annotation></semantics></math>
</th>
<th id="S4.T6.12.3.3.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding:0.45pt 3.0pt;">
<span id="S4.T6.12.3.3.3.3.3.1" class="ltx_text" style="font-size:90%;">AP</span><sub id="S4.T6.12.3.3.3.3.3.2" class="ltx_sub"><span id="S4.T6.12.3.3.3.3.3.2.1" class="ltx_text ltx_font_italic" style="font-size:90%;">50</span></sub>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T6.12.3.3.3.4.1" class="ltx_tr">
<th id="S4.T6.12.3.3.3.4.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T6.12.3.3.3.4.1.1.1" class="ltx_text" style="font-size:90%;">1</span></th>
<th id="S4.T6.12.3.3.3.4.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T6.12.3.3.3.4.1.2.1" class="ltx_text" style="font-size:90%;">-0.1</span></th>
<td id="S4.T6.12.3.3.3.4.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T6.12.3.3.3.4.1.3.1" class="ltx_text" style="font-size:90%;">32.5</span></td>
<td id="S4.T6.12.3.3.3.4.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T6.12.3.3.3.4.1.4.1" class="ltx_text" style="font-size:90%;">59.7</span></td>
<td id="S4.T6.12.3.3.3.4.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T6.12.3.3.3.4.1.5.1" class="ltx_text" style="font-size:90%;">52.6</span></td>
</tr>
<tr id="S4.T6.12.3.3.3.5.2" class="ltx_tr">
<th id="S4.T6.12.3.3.3.5.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T6.12.3.3.3.5.2.1.1" class="ltx_text" style="font-size:90%;">2</span></th>
<th id="S4.T6.12.3.3.3.5.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T6.12.3.3.3.5.2.2.1" class="ltx_text" style="font-size:90%;">0.0</span></th>
<td id="S4.T6.12.3.3.3.5.2.3" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T6.12.3.3.3.5.2.3.1" class="ltx_text" style="font-size:90%;">33.6</span></td>
<td id="S4.T6.12.3.3.3.5.2.4" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T6.12.3.3.3.5.2.4.1" class="ltx_text" style="font-size:90%;">60.2</span></td>
<td id="S4.T6.12.3.3.3.5.2.5" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T6.12.3.3.3.5.2.5.1" class="ltx_text" style="font-size:90%;">53.2</span></td>
</tr>
<tr id="S4.T6.12.3.3.3.6.3" class="ltx_tr">
<th id="S4.T6.12.3.3.3.6.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T6.12.3.3.3.6.3.1.1" class="ltx_text" style="font-size:90%;">3</span></th>
<th id="S4.T6.12.3.3.3.6.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T6.12.3.3.3.6.3.2.1" class="ltx_text" style="font-size:90%;">0.1</span></th>
<td id="S4.T6.12.3.3.3.6.3.3" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T6.12.3.3.3.6.3.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">34.0</span></td>
<td id="S4.T6.12.3.3.3.6.3.4" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T6.12.3.3.3.6.3.4.1" class="ltx_text" style="font-size:90%;">60.4</span></td>
<td id="S4.T6.12.3.3.3.6.3.5" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T6.12.3.3.3.6.3.5.1" class="ltx_text" style="font-size:90%;">53.5</span></td>
</tr>
<tr id="S4.T6.12.3.3.3.7.4" class="ltx_tr">
<th id="S4.T6.12.3.3.3.7.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T6.12.3.3.3.7.4.1.1" class="ltx_text" style="font-size:90%;">4</span></th>
<th id="S4.T6.12.3.3.3.7.4.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T6.12.3.3.3.7.4.2.1" class="ltx_text" style="font-size:90%;">0.2</span></th>
<td id="S4.T6.12.3.3.3.7.4.3" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T6.12.3.3.3.7.4.3.1" class="ltx_text" style="font-size:90%;">33.8</span></td>
<td id="S4.T6.12.3.3.3.7.4.4" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T6.12.3.3.3.7.4.4.1" class="ltx_text" style="font-size:90%;">59.8</span></td>
<td id="S4.T6.12.3.3.3.7.4.5" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T6.12.3.3.3.7.4.5.1" class="ltx_text" style="font-size:90%;">53.0</span></td>
</tr>
<tr id="S4.T6.12.3.3.3.8.5" class="ltx_tr">
<th id="S4.T6.12.3.3.3.8.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T6.12.3.3.3.8.5.1.1" class="ltx_text" style="font-size:90%;">5</span></th>
<th id="S4.T6.12.3.3.3.8.5.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T6.12.3.3.3.8.5.2.1" class="ltx_text" style="font-size:90%;">0.3</span></th>
<td id="S4.T6.12.3.3.3.8.5.3" class="ltx_td ltx_align_center ltx_border_b" style="padding:0.45pt 3.0pt;"><span id="S4.T6.12.3.3.3.8.5.3.1" class="ltx_text" style="font-size:90%;">33.7</span></td>
<td id="S4.T6.12.3.3.3.8.5.4" class="ltx_td ltx_align_center ltx_border_b" style="padding:0.45pt 3.0pt;"><span id="S4.T6.12.3.3.3.8.5.4.1" class="ltx_text" style="font-size:90%;">60.0</span></td>
<td id="S4.T6.12.3.3.3.8.5.5" class="ltx_td ltx_align_center ltx_border_b" style="padding:0.45pt 3.0pt;"><span id="S4.T6.12.3.3.3.8.5.5.1" class="ltx_text" style="font-size:90%;">53.1</span></td>
</tr>
</tbody>
</table>
</span></div>
</span></div>
</figure>
</div>
</div>
</figure>
<figure id="S4.T9" class="ltx_table">
<div class="ltx_flex_figure ltx_flex_table">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.T9.6" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_top" style="width:154.0pt;">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.T9.6.7.2.1" class="ltx_text" style="font-size:90%;">Table 7</span>: </span><span id="S4.T9.2.2.1" class="ltx_text" style="font-size:90%;">Ablation study on the sampling probability <math id="S4.T9.2.2.1.m1.1" class="ltx_Math" alttext="p_{b}" display="inline"><semantics id="S4.T9.2.2.1.m1.1b"><msub id="S4.T9.2.2.1.m1.1.1" xref="S4.T9.2.2.1.m1.1.1.cmml"><mi id="S4.T9.2.2.1.m1.1.1.2" xref="S4.T9.2.2.1.m1.1.1.2.cmml">p</mi><mi id="S4.T9.2.2.1.m1.1.1.3" xref="S4.T9.2.2.1.m1.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S4.T9.2.2.1.m1.1c"><apply id="S4.T9.2.2.1.m1.1.1.cmml" xref="S4.T9.2.2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T9.2.2.1.m1.1.1.1.cmml" xref="S4.T9.2.2.1.m1.1.1">subscript</csymbol><ci id="S4.T9.2.2.1.m1.1.1.2.cmml" xref="S4.T9.2.2.1.m1.1.1.2">𝑝</ci><ci id="S4.T9.2.2.1.m1.1.1.3.cmml" xref="S4.T9.2.2.1.m1.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T9.2.2.1.m1.1d">p_{b}</annotation></semantics></math></span></figcaption>
<div id="S4.T9.6.6" class="ltx_inline-block ltx_transformed_outer" style="width:87.1pt;height:61.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-2.3pt,1.6pt) scale(0.95,0.95) ;">
<div id="S4.T9.6.6.4" class="ltx_inline-block ltx_transformed_outer" style="width:85.7pt;height:64.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-4.8pt,3.6pt) scale(0.9,0.9) ;">
<table id="S4.T9.6.6.4.4" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T9.6.6.4.4.4" class="ltx_tr">
<th id="S4.T9.3.3.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;">
<span id="S4.T9.3.3.1.1.1.1.1" class="ltx_text" style="font-size:90%;">p</span><sub id="S4.T9.3.3.1.1.1.1.2" class="ltx_sub"><span id="S4.T9.3.3.1.1.1.1.2.1" class="ltx_text ltx_font_italic" style="font-size:90%;">b</span></sub>
</th>
<th id="S4.T9.4.4.2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding:0.45pt 3.0pt;">
<span id="S4.T9.4.4.2.2.2.2.1" class="ltx_text" style="font-size:90%;">AP</span><math id="S4.T9.4.4.2.2.2.2.m1.1" class="ltx_Math" alttext="{}_{50}^{\text{novel}}" display="inline"><semantics id="S4.T9.4.4.2.2.2.2.m1.1a"><mmultiscripts id="S4.T9.4.4.2.2.2.2.m1.1.1" xref="S4.T9.4.4.2.2.2.2.m1.1.1.cmml"><mi id="S4.T9.4.4.2.2.2.2.m1.1.1.2.2" xref="S4.T9.4.4.2.2.2.2.m1.1.1.2.2.cmml"></mi><mprescripts id="S4.T9.4.4.2.2.2.2.m1.1.1a" xref="S4.T9.4.4.2.2.2.2.m1.1.1.cmml"></mprescripts><mrow id="S4.T9.4.4.2.2.2.2.m1.1.1b" xref="S4.T9.4.4.2.2.2.2.m1.1.1.cmml"></mrow><mtext mathsize="90%" id="S4.T9.4.4.2.2.2.2.m1.1.1.3" xref="S4.T9.4.4.2.2.2.2.m1.1.1.3a.cmml">novel</mtext><mn mathsize="90%" id="S4.T9.4.4.2.2.2.2.m1.1.1.2.3" xref="S4.T9.4.4.2.2.2.2.m1.1.1.2.3.cmml">50</mn><mrow id="S4.T9.4.4.2.2.2.2.m1.1.1c" xref="S4.T9.4.4.2.2.2.2.m1.1.1.cmml"></mrow></mmultiscripts><annotation-xml encoding="MathML-Content" id="S4.T9.4.4.2.2.2.2.m1.1b"><apply id="S4.T9.4.4.2.2.2.2.m1.1.1.cmml" xref="S4.T9.4.4.2.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T9.4.4.2.2.2.2.m1.1.1.1.cmml" xref="S4.T9.4.4.2.2.2.2.m1.1.1">superscript</csymbol><apply id="S4.T9.4.4.2.2.2.2.m1.1.1.2.cmml" xref="S4.T9.4.4.2.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T9.4.4.2.2.2.2.m1.1.1.2.1.cmml" xref="S4.T9.4.4.2.2.2.2.m1.1.1">subscript</csymbol><csymbol cd="latexml" id="S4.T9.4.4.2.2.2.2.m1.1.1.2.2.cmml" xref="S4.T9.4.4.2.2.2.2.m1.1.1.2.2">absent</csymbol><cn type="integer" id="S4.T9.4.4.2.2.2.2.m1.1.1.2.3.cmml" xref="S4.T9.4.4.2.2.2.2.m1.1.1.2.3">50</cn></apply><ci id="S4.T9.4.4.2.2.2.2.m1.1.1.3a.cmml" xref="S4.T9.4.4.2.2.2.2.m1.1.1.3"><mtext mathsize="63%" id="S4.T9.4.4.2.2.2.2.m1.1.1.3.cmml" xref="S4.T9.4.4.2.2.2.2.m1.1.1.3">novel</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T9.4.4.2.2.2.2.m1.1c">{}_{50}^{\text{novel}}</annotation></semantics></math>
</th>
<th id="S4.T9.5.5.3.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding:0.45pt 3.0pt;">
<span id="S4.T9.5.5.3.3.3.3.1" class="ltx_text" style="font-size:90%;">AP</span><math id="S4.T9.5.5.3.3.3.3.m1.1" class="ltx_Math" alttext="{}_{50}^{\text{base}}" display="inline"><semantics id="S4.T9.5.5.3.3.3.3.m1.1a"><mmultiscripts id="S4.T9.5.5.3.3.3.3.m1.1.1" xref="S4.T9.5.5.3.3.3.3.m1.1.1.cmml"><mi id="S4.T9.5.5.3.3.3.3.m1.1.1.2.2" xref="S4.T9.5.5.3.3.3.3.m1.1.1.2.2.cmml"></mi><mprescripts id="S4.T9.5.5.3.3.3.3.m1.1.1a" xref="S4.T9.5.5.3.3.3.3.m1.1.1.cmml"></mprescripts><mrow id="S4.T9.5.5.3.3.3.3.m1.1.1b" xref="S4.T9.5.5.3.3.3.3.m1.1.1.cmml"></mrow><mtext mathsize="90%" id="S4.T9.5.5.3.3.3.3.m1.1.1.3" xref="S4.T9.5.5.3.3.3.3.m1.1.1.3a.cmml">base</mtext><mn mathsize="90%" id="S4.T9.5.5.3.3.3.3.m1.1.1.2.3" xref="S4.T9.5.5.3.3.3.3.m1.1.1.2.3.cmml">50</mn><mrow id="S4.T9.5.5.3.3.3.3.m1.1.1c" xref="S4.T9.5.5.3.3.3.3.m1.1.1.cmml"></mrow></mmultiscripts><annotation-xml encoding="MathML-Content" id="S4.T9.5.5.3.3.3.3.m1.1b"><apply id="S4.T9.5.5.3.3.3.3.m1.1.1.cmml" xref="S4.T9.5.5.3.3.3.3.m1.1.1"><csymbol cd="ambiguous" id="S4.T9.5.5.3.3.3.3.m1.1.1.1.cmml" xref="S4.T9.5.5.3.3.3.3.m1.1.1">superscript</csymbol><apply id="S4.T9.5.5.3.3.3.3.m1.1.1.2.cmml" xref="S4.T9.5.5.3.3.3.3.m1.1.1"><csymbol cd="ambiguous" id="S4.T9.5.5.3.3.3.3.m1.1.1.2.1.cmml" xref="S4.T9.5.5.3.3.3.3.m1.1.1">subscript</csymbol><csymbol cd="latexml" id="S4.T9.5.5.3.3.3.3.m1.1.1.2.2.cmml" xref="S4.T9.5.5.3.3.3.3.m1.1.1.2.2">absent</csymbol><cn type="integer" id="S4.T9.5.5.3.3.3.3.m1.1.1.2.3.cmml" xref="S4.T9.5.5.3.3.3.3.m1.1.1.2.3">50</cn></apply><ci id="S4.T9.5.5.3.3.3.3.m1.1.1.3a.cmml" xref="S4.T9.5.5.3.3.3.3.m1.1.1.3"><mtext mathsize="63%" id="S4.T9.5.5.3.3.3.3.m1.1.1.3.cmml" xref="S4.T9.5.5.3.3.3.3.m1.1.1.3">base</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T9.5.5.3.3.3.3.m1.1c">{}_{50}^{\text{base}}</annotation></semantics></math>
</th>
<th id="S4.T9.6.6.4.4.4.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding:0.45pt 3.0pt;">
<span id="S4.T9.6.6.4.4.4.4.1" class="ltx_text" style="font-size:90%;">AP</span><sub id="S4.T9.6.6.4.4.4.4.2" class="ltx_sub"><span id="S4.T9.6.6.4.4.4.4.2.1" class="ltx_text ltx_font_italic" style="font-size:90%;">50</span></sub>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T9.6.6.4.4.5.1" class="ltx_tr">
<th id="S4.T9.6.6.4.4.5.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T9.6.6.4.4.5.1.1.1" class="ltx_text" style="font-size:90%;">0.1</span></th>
<td id="S4.T9.6.6.4.4.5.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T9.6.6.4.4.5.1.2.1" class="ltx_text" style="font-size:90%;">33.7</span></td>
<td id="S4.T9.6.6.4.4.5.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T9.6.6.4.4.5.1.3.1" class="ltx_text" style="font-size:90%;">59.8</span></td>
<td id="S4.T9.6.6.4.4.5.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T9.6.6.4.4.5.1.4.1" class="ltx_text" style="font-size:90%;">52.9</span></td>
</tr>
<tr id="S4.T9.6.6.4.4.6.2" class="ltx_tr">
<th id="S4.T9.6.6.4.4.6.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T9.6.6.4.4.6.2.1.1" class="ltx_text" style="font-size:90%;">0.3</span></th>
<td id="S4.T9.6.6.4.4.6.2.2" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T9.6.6.4.4.6.2.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">34.0</span></td>
<td id="S4.T9.6.6.4.4.6.2.3" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T9.6.6.4.4.6.2.3.1" class="ltx_text" style="font-size:90%;">60.4</span></td>
<td id="S4.T9.6.6.4.4.6.2.4" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T9.6.6.4.4.6.2.4.1" class="ltx_text" style="font-size:90%;">53.5</span></td>
</tr>
<tr id="S4.T9.6.6.4.4.7.3" class="ltx_tr">
<th id="S4.T9.6.6.4.4.7.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T9.6.6.4.4.7.3.1.1" class="ltx_text" style="font-size:90%;">0.5</span></th>
<td id="S4.T9.6.6.4.4.7.3.2" class="ltx_td ltx_align_center ltx_border_b" style="padding:0.45pt 3.0pt;"><span id="S4.T9.6.6.4.4.7.3.2.1" class="ltx_text" style="font-size:90%;">33.2</span></td>
<td id="S4.T9.6.6.4.4.7.3.3" class="ltx_td ltx_align_center ltx_border_b" style="padding:0.45pt 3.0pt;"><span id="S4.T9.6.6.4.4.7.3.3.1" class="ltx_text" style="font-size:90%;">60.0</span></td>
<td id="S4.T9.6.6.4.4.7.3.4" class="ltx_td ltx_align_center ltx_border_b" style="padding:0.45pt 3.0pt;"><span id="S4.T9.6.6.4.4.7.3.4.1" class="ltx_text" style="font-size:90%;">53.0</span></td>
</tr>
</tbody>
</table>
</span></div>
</span></div>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.T9.9" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_top" style="width:154.0pt;">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.T9.9.4.1.1" class="ltx_text" style="font-size:90%;">Table 8</span>: </span><span id="S4.T9.9.5.2" class="ltx_text" style="font-size:90%;">Number of sampled bags per region proposal</span></figcaption>
<div id="S4.T9.9.3" class="ltx_inline-block ltx_transformed_outer" style="width:98.7pt;height:61.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-2.6pt,1.6pt) scale(0.95,0.95) ;">
<div id="S4.T9.9.3.3" class="ltx_inline-block ltx_transformed_outer" style="width:97.9pt;height:64.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-5.4pt,3.6pt) scale(0.9,0.9) ;">
<table id="S4.T9.9.3.3.3" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T9.9.3.3.3.3" class="ltx_tr">
<th id="S4.T9.9.3.3.3.3.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;">
<span id="S4.T9.9.3.3.3.3.4.1" class="ltx_text" style="font-size:90%;">#</span><span id="S4.T9.9.3.3.3.3.4.2" class="ltx_text" style="font-size:90%;">bags</span>
</th>
<th id="S4.T9.7.1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding:0.45pt 3.0pt;">
<span id="S4.T9.7.1.1.1.1.1.1" class="ltx_text" style="font-size:90%;">AP</span><math id="S4.T9.7.1.1.1.1.1.m1.1" class="ltx_Math" alttext="{}_{50}^{\text{novel}}" display="inline"><semantics id="S4.T9.7.1.1.1.1.1.m1.1a"><mmultiscripts id="S4.T9.7.1.1.1.1.1.m1.1.1" xref="S4.T9.7.1.1.1.1.1.m1.1.1.cmml"><mi id="S4.T9.7.1.1.1.1.1.m1.1.1.2.2" xref="S4.T9.7.1.1.1.1.1.m1.1.1.2.2.cmml"></mi><mprescripts id="S4.T9.7.1.1.1.1.1.m1.1.1a" xref="S4.T9.7.1.1.1.1.1.m1.1.1.cmml"></mprescripts><mrow id="S4.T9.7.1.1.1.1.1.m1.1.1b" xref="S4.T9.7.1.1.1.1.1.m1.1.1.cmml"></mrow><mtext mathsize="90%" id="S4.T9.7.1.1.1.1.1.m1.1.1.3" xref="S4.T9.7.1.1.1.1.1.m1.1.1.3a.cmml">novel</mtext><mn mathsize="90%" id="S4.T9.7.1.1.1.1.1.m1.1.1.2.3" xref="S4.T9.7.1.1.1.1.1.m1.1.1.2.3.cmml">50</mn><mrow id="S4.T9.7.1.1.1.1.1.m1.1.1c" xref="S4.T9.7.1.1.1.1.1.m1.1.1.cmml"></mrow></mmultiscripts><annotation-xml encoding="MathML-Content" id="S4.T9.7.1.1.1.1.1.m1.1b"><apply id="S4.T9.7.1.1.1.1.1.m1.1.1.cmml" xref="S4.T9.7.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T9.7.1.1.1.1.1.m1.1.1.1.cmml" xref="S4.T9.7.1.1.1.1.1.m1.1.1">superscript</csymbol><apply id="S4.T9.7.1.1.1.1.1.m1.1.1.2.cmml" xref="S4.T9.7.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T9.7.1.1.1.1.1.m1.1.1.2.1.cmml" xref="S4.T9.7.1.1.1.1.1.m1.1.1">subscript</csymbol><csymbol cd="latexml" id="S4.T9.7.1.1.1.1.1.m1.1.1.2.2.cmml" xref="S4.T9.7.1.1.1.1.1.m1.1.1.2.2">absent</csymbol><cn type="integer" id="S4.T9.7.1.1.1.1.1.m1.1.1.2.3.cmml" xref="S4.T9.7.1.1.1.1.1.m1.1.1.2.3">50</cn></apply><ci id="S4.T9.7.1.1.1.1.1.m1.1.1.3a.cmml" xref="S4.T9.7.1.1.1.1.1.m1.1.1.3"><mtext mathsize="63%" id="S4.T9.7.1.1.1.1.1.m1.1.1.3.cmml" xref="S4.T9.7.1.1.1.1.1.m1.1.1.3">novel</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T9.7.1.1.1.1.1.m1.1c">{}_{50}^{\text{novel}}</annotation></semantics></math>
</th>
<th id="S4.T9.8.2.2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding:0.45pt 3.0pt;">
<span id="S4.T9.8.2.2.2.2.2.1" class="ltx_text" style="font-size:90%;">AP</span><math id="S4.T9.8.2.2.2.2.2.m1.1" class="ltx_Math" alttext="{}_{50}^{\text{base}}" display="inline"><semantics id="S4.T9.8.2.2.2.2.2.m1.1a"><mmultiscripts id="S4.T9.8.2.2.2.2.2.m1.1.1" xref="S4.T9.8.2.2.2.2.2.m1.1.1.cmml"><mi id="S4.T9.8.2.2.2.2.2.m1.1.1.2.2" xref="S4.T9.8.2.2.2.2.2.m1.1.1.2.2.cmml"></mi><mprescripts id="S4.T9.8.2.2.2.2.2.m1.1.1a" xref="S4.T9.8.2.2.2.2.2.m1.1.1.cmml"></mprescripts><mrow id="S4.T9.8.2.2.2.2.2.m1.1.1b" xref="S4.T9.8.2.2.2.2.2.m1.1.1.cmml"></mrow><mtext mathsize="90%" id="S4.T9.8.2.2.2.2.2.m1.1.1.3" xref="S4.T9.8.2.2.2.2.2.m1.1.1.3a.cmml">base</mtext><mn mathsize="90%" id="S4.T9.8.2.2.2.2.2.m1.1.1.2.3" xref="S4.T9.8.2.2.2.2.2.m1.1.1.2.3.cmml">50</mn><mrow id="S4.T9.8.2.2.2.2.2.m1.1.1c" xref="S4.T9.8.2.2.2.2.2.m1.1.1.cmml"></mrow></mmultiscripts><annotation-xml encoding="MathML-Content" id="S4.T9.8.2.2.2.2.2.m1.1b"><apply id="S4.T9.8.2.2.2.2.2.m1.1.1.cmml" xref="S4.T9.8.2.2.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T9.8.2.2.2.2.2.m1.1.1.1.cmml" xref="S4.T9.8.2.2.2.2.2.m1.1.1">superscript</csymbol><apply id="S4.T9.8.2.2.2.2.2.m1.1.1.2.cmml" xref="S4.T9.8.2.2.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T9.8.2.2.2.2.2.m1.1.1.2.1.cmml" xref="S4.T9.8.2.2.2.2.2.m1.1.1">subscript</csymbol><csymbol cd="latexml" id="S4.T9.8.2.2.2.2.2.m1.1.1.2.2.cmml" xref="S4.T9.8.2.2.2.2.2.m1.1.1.2.2">absent</csymbol><cn type="integer" id="S4.T9.8.2.2.2.2.2.m1.1.1.2.3.cmml" xref="S4.T9.8.2.2.2.2.2.m1.1.1.2.3">50</cn></apply><ci id="S4.T9.8.2.2.2.2.2.m1.1.1.3a.cmml" xref="S4.T9.8.2.2.2.2.2.m1.1.1.3"><mtext mathsize="63%" id="S4.T9.8.2.2.2.2.2.m1.1.1.3.cmml" xref="S4.T9.8.2.2.2.2.2.m1.1.1.3">base</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T9.8.2.2.2.2.2.m1.1c">{}_{50}^{\text{base}}</annotation></semantics></math>
</th>
<th id="S4.T9.9.3.3.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding:0.45pt 3.0pt;">
<span id="S4.T9.9.3.3.3.3.3.1" class="ltx_text" style="font-size:90%;">AP</span><sub id="S4.T9.9.3.3.3.3.3.2" class="ltx_sub"><span id="S4.T9.9.3.3.3.3.3.2.1" class="ltx_text ltx_font_italic" style="font-size:90%;">50</span></sub>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T9.9.3.3.3.4.1" class="ltx_tr">
<th id="S4.T9.9.3.3.3.4.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T9.9.3.3.3.4.1.1.1" class="ltx_text" style="font-size:90%;">1</span></th>
<td id="S4.T9.9.3.3.3.4.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T9.9.3.3.3.4.1.2.1" class="ltx_text" style="font-size:90%;">32.6</span></td>
<td id="S4.T9.9.3.3.3.4.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T9.9.3.3.3.4.1.3.1" class="ltx_text" style="font-size:90%;">58.5</span></td>
<td id="S4.T9.9.3.3.3.4.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T9.9.3.3.3.4.1.4.1" class="ltx_text" style="font-size:90%;">51.7</span></td>
</tr>
<tr id="S4.T9.9.3.3.3.5.2" class="ltx_tr">
<th id="S4.T9.9.3.3.3.5.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T9.9.3.3.3.5.2.1.1" class="ltx_text" style="font-size:90%;">3</span></th>
<td id="S4.T9.9.3.3.3.5.2.2" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T9.9.3.3.3.5.2.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">34.0</span></td>
<td id="S4.T9.9.3.3.3.5.2.3" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T9.9.3.3.3.5.2.3.1" class="ltx_text" style="font-size:90%;">60.4</span></td>
<td id="S4.T9.9.3.3.3.5.2.4" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T9.9.3.3.3.5.2.4.1" class="ltx_text" style="font-size:90%;">53.5</span></td>
</tr>
<tr id="S4.T9.9.3.3.3.6.3" class="ltx_tr">
<th id="S4.T9.9.3.3.3.6.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T9.9.3.3.3.6.3.1.1" class="ltx_text" style="font-size:90%;">5</span></th>
<td id="S4.T9.9.3.3.3.6.3.2" class="ltx_td ltx_align_center ltx_border_b" style="padding:0.45pt 3.0pt;"><span id="S4.T9.9.3.3.3.6.3.2.1" class="ltx_text" style="font-size:90%;">33.2</span></td>
<td id="S4.T9.9.3.3.3.6.3.3" class="ltx_td ltx_align_center ltx_border_b" style="padding:0.45pt 3.0pt;"><span id="S4.T9.9.3.3.3.6.3.3.1" class="ltx_text" style="font-size:90%;">60.0</span></td>
<td id="S4.T9.9.3.3.3.6.3.4" class="ltx_td ltx_align_center ltx_border_b" style="padding:0.45pt 3.0pt;"><span id="S4.T9.9.3.3.3.6.3.4.1" class="ltx_text" style="font-size:90%;">53.0</span></td>
</tr>
</tbody>
</table>
</span></div>
</span></div>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.T9.12" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_top" style="width:154.0pt;">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.T9.12.4.1.1" class="ltx_text" style="font-size:90%;">Table 9</span>: </span><span id="S4.T9.12.5.2" class="ltx_text" style="font-size:90%;">Number of pseudo words</span></figcaption>
<div id="S4.T9.12.3" class="ltx_inline-block ltx_transformed_outer" style="width:116.0pt;height:77.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-2.4pt,1.6pt) scale(0.96,0.96) ;">
<div id="S4.T9.12.3.3" class="ltx_inline-block ltx_transformed_outer" style="width:114.8pt;height:81pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-6.4pt,4.5pt) scale(0.9,0.9) ;">
<table id="S4.T9.12.3.3.3" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T9.12.3.3.3.3" class="ltx_tr">
<th id="S4.T9.12.3.3.3.3.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T9.12.3.3.3.3.4.1" class="ltx_text" style="font-size:90%;">#</span></th>
<th id="S4.T9.12.3.3.3.3.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T9.12.3.3.3.3.5.1" class="ltx_text" style="font-size:90%;">#words</span></th>
<th id="S4.T9.10.1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding:0.45pt 3.0pt;">
<span id="S4.T9.10.1.1.1.1.1.1" class="ltx_text" style="font-size:90%;">AP</span><math id="S4.T9.10.1.1.1.1.1.m1.1" class="ltx_Math" alttext="{}_{50}^{\text{novel}}" display="inline"><semantics id="S4.T9.10.1.1.1.1.1.m1.1a"><mmultiscripts id="S4.T9.10.1.1.1.1.1.m1.1.1" xref="S4.T9.10.1.1.1.1.1.m1.1.1.cmml"><mi id="S4.T9.10.1.1.1.1.1.m1.1.1.2.2" xref="S4.T9.10.1.1.1.1.1.m1.1.1.2.2.cmml"></mi><mprescripts id="S4.T9.10.1.1.1.1.1.m1.1.1a" xref="S4.T9.10.1.1.1.1.1.m1.1.1.cmml"></mprescripts><mrow id="S4.T9.10.1.1.1.1.1.m1.1.1b" xref="S4.T9.10.1.1.1.1.1.m1.1.1.cmml"></mrow><mtext mathsize="90%" id="S4.T9.10.1.1.1.1.1.m1.1.1.3" xref="S4.T9.10.1.1.1.1.1.m1.1.1.3a.cmml">novel</mtext><mn mathsize="90%" id="S4.T9.10.1.1.1.1.1.m1.1.1.2.3" xref="S4.T9.10.1.1.1.1.1.m1.1.1.2.3.cmml">50</mn><mrow id="S4.T9.10.1.1.1.1.1.m1.1.1c" xref="S4.T9.10.1.1.1.1.1.m1.1.1.cmml"></mrow></mmultiscripts><annotation-xml encoding="MathML-Content" id="S4.T9.10.1.1.1.1.1.m1.1b"><apply id="S4.T9.10.1.1.1.1.1.m1.1.1.cmml" xref="S4.T9.10.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T9.10.1.1.1.1.1.m1.1.1.1.cmml" xref="S4.T9.10.1.1.1.1.1.m1.1.1">superscript</csymbol><apply id="S4.T9.10.1.1.1.1.1.m1.1.1.2.cmml" xref="S4.T9.10.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T9.10.1.1.1.1.1.m1.1.1.2.1.cmml" xref="S4.T9.10.1.1.1.1.1.m1.1.1">subscript</csymbol><csymbol cd="latexml" id="S4.T9.10.1.1.1.1.1.m1.1.1.2.2.cmml" xref="S4.T9.10.1.1.1.1.1.m1.1.1.2.2">absent</csymbol><cn type="integer" id="S4.T9.10.1.1.1.1.1.m1.1.1.2.3.cmml" xref="S4.T9.10.1.1.1.1.1.m1.1.1.2.3">50</cn></apply><ci id="S4.T9.10.1.1.1.1.1.m1.1.1.3a.cmml" xref="S4.T9.10.1.1.1.1.1.m1.1.1.3"><mtext mathsize="63%" id="S4.T9.10.1.1.1.1.1.m1.1.1.3.cmml" xref="S4.T9.10.1.1.1.1.1.m1.1.1.3">novel</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T9.10.1.1.1.1.1.m1.1c">{}_{50}^{\text{novel}}</annotation></semantics></math>
</th>
<th id="S4.T9.11.2.2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding:0.45pt 3.0pt;">
<span id="S4.T9.11.2.2.2.2.2.1" class="ltx_text" style="font-size:90%;">AP</span><math id="S4.T9.11.2.2.2.2.2.m1.1" class="ltx_Math" alttext="{}_{50}^{\text{base}}" display="inline"><semantics id="S4.T9.11.2.2.2.2.2.m1.1a"><mmultiscripts id="S4.T9.11.2.2.2.2.2.m1.1.1" xref="S4.T9.11.2.2.2.2.2.m1.1.1.cmml"><mi id="S4.T9.11.2.2.2.2.2.m1.1.1.2.2" xref="S4.T9.11.2.2.2.2.2.m1.1.1.2.2.cmml"></mi><mprescripts id="S4.T9.11.2.2.2.2.2.m1.1.1a" xref="S4.T9.11.2.2.2.2.2.m1.1.1.cmml"></mprescripts><mrow id="S4.T9.11.2.2.2.2.2.m1.1.1b" xref="S4.T9.11.2.2.2.2.2.m1.1.1.cmml"></mrow><mtext mathsize="90%" id="S4.T9.11.2.2.2.2.2.m1.1.1.3" xref="S4.T9.11.2.2.2.2.2.m1.1.1.3a.cmml">base</mtext><mn mathsize="90%" id="S4.T9.11.2.2.2.2.2.m1.1.1.2.3" xref="S4.T9.11.2.2.2.2.2.m1.1.1.2.3.cmml">50</mn><mrow id="S4.T9.11.2.2.2.2.2.m1.1.1c" xref="S4.T9.11.2.2.2.2.2.m1.1.1.cmml"></mrow></mmultiscripts><annotation-xml encoding="MathML-Content" id="S4.T9.11.2.2.2.2.2.m1.1b"><apply id="S4.T9.11.2.2.2.2.2.m1.1.1.cmml" xref="S4.T9.11.2.2.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T9.11.2.2.2.2.2.m1.1.1.1.cmml" xref="S4.T9.11.2.2.2.2.2.m1.1.1">superscript</csymbol><apply id="S4.T9.11.2.2.2.2.2.m1.1.1.2.cmml" xref="S4.T9.11.2.2.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T9.11.2.2.2.2.2.m1.1.1.2.1.cmml" xref="S4.T9.11.2.2.2.2.2.m1.1.1">subscript</csymbol><csymbol cd="latexml" id="S4.T9.11.2.2.2.2.2.m1.1.1.2.2.cmml" xref="S4.T9.11.2.2.2.2.2.m1.1.1.2.2">absent</csymbol><cn type="integer" id="S4.T9.11.2.2.2.2.2.m1.1.1.2.3.cmml" xref="S4.T9.11.2.2.2.2.2.m1.1.1.2.3">50</cn></apply><ci id="S4.T9.11.2.2.2.2.2.m1.1.1.3a.cmml" xref="S4.T9.11.2.2.2.2.2.m1.1.1.3"><mtext mathsize="63%" id="S4.T9.11.2.2.2.2.2.m1.1.1.3.cmml" xref="S4.T9.11.2.2.2.2.2.m1.1.1.3">base</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T9.11.2.2.2.2.2.m1.1c">{}_{50}^{\text{base}}</annotation></semantics></math>
</th>
<th id="S4.T9.12.3.3.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding:0.45pt 3.0pt;">
<span id="S4.T9.12.3.3.3.3.3.1" class="ltx_text" style="font-size:90%;">AP</span><sub id="S4.T9.12.3.3.3.3.3.2" class="ltx_sub"><span id="S4.T9.12.3.3.3.3.3.2.1" class="ltx_text ltx_font_italic" style="font-size:90%;">50</span></sub>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T9.12.3.3.3.4.1" class="ltx_tr">
<th id="S4.T9.12.3.3.3.4.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T9.12.3.3.3.4.1.1.1" class="ltx_text" style="font-size:90%;">1</span></th>
<th id="S4.T9.12.3.3.3.4.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T9.12.3.3.3.4.1.2.1" class="ltx_text" style="font-size:90%;">2</span></th>
<td id="S4.T9.12.3.3.3.4.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T9.12.3.3.3.4.1.3.1" class="ltx_text" style="font-size:90%;">31.6</span></td>
<td id="S4.T9.12.3.3.3.4.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T9.12.3.3.3.4.1.4.1" class="ltx_text" style="font-size:90%;">59.5</span></td>
<td id="S4.T9.12.3.3.3.4.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="S4.T9.12.3.3.3.4.1.5.1" class="ltx_text" style="font-size:90%;">52.2</span></td>
</tr>
<tr id="S4.T9.12.3.3.3.5.2" class="ltx_tr">
<th id="S4.T9.12.3.3.3.5.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T9.12.3.3.3.5.2.1.1" class="ltx_text" style="font-size:90%;">2</span></th>
<th id="S4.T9.12.3.3.3.5.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T9.12.3.3.3.5.2.2.1" class="ltx_text" style="font-size:90%;">4</span></th>
<td id="S4.T9.12.3.3.3.5.2.3" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T9.12.3.3.3.5.2.3.1" class="ltx_text" style="font-size:90%;">33.1</span></td>
<td id="S4.T9.12.3.3.3.5.2.4" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T9.12.3.3.3.5.2.4.1" class="ltx_text" style="font-size:90%;">60.1</span></td>
<td id="S4.T9.12.3.3.3.5.2.5" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T9.12.3.3.3.5.2.5.1" class="ltx_text" style="font-size:90%;">53.0</span></td>
</tr>
<tr id="S4.T9.12.3.3.3.6.3" class="ltx_tr">
<th id="S4.T9.12.3.3.3.6.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T9.12.3.3.3.6.3.1.1" class="ltx_text" style="font-size:90%;">3</span></th>
<th id="S4.T9.12.3.3.3.6.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T9.12.3.3.3.6.3.2.1" class="ltx_text" style="font-size:90%;">6</span></th>
<td id="S4.T9.12.3.3.3.6.3.3" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T9.12.3.3.3.6.3.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">34.0</span></td>
<td id="S4.T9.12.3.3.3.6.3.4" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T9.12.3.3.3.6.3.4.1" class="ltx_text" style="font-size:90%;">60.4</span></td>
<td id="S4.T9.12.3.3.3.6.3.5" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="S4.T9.12.3.3.3.6.3.5.1" class="ltx_text" style="font-size:90%;">53.5</span></td>
</tr>
<tr id="S4.T9.12.3.3.3.7.4" class="ltx_tr">
<th id="S4.T9.12.3.3.3.7.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T9.12.3.3.3.7.4.1.1" class="ltx_text" style="font-size:90%;">4</span></th>
<th id="S4.T9.12.3.3.3.7.4.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="S4.T9.12.3.3.3.7.4.2.1" class="ltx_text" style="font-size:90%;">8</span></th>
<td id="S4.T9.12.3.3.3.7.4.3" class="ltx_td ltx_align_center ltx_border_b" style="padding:0.45pt 3.0pt;"><span id="S4.T9.12.3.3.3.7.4.3.1" class="ltx_text" style="font-size:90%;">33.5</span></td>
<td id="S4.T9.12.3.3.3.7.4.4" class="ltx_td ltx_align_center ltx_border_b" style="padding:0.45pt 3.0pt;"><span id="S4.T9.12.3.3.3.7.4.4.1" class="ltx_text" style="font-size:90%;">59.9</span></td>
<td id="S4.T9.12.3.3.3.7.4.5" class="ltx_td ltx_align_center ltx_border_b" style="padding:0.45pt 3.0pt;"><span id="S4.T9.12.3.3.3.7.4.5.1" class="ltx_text" style="font-size:90%;">53.0</span></td>
</tr>
</tbody>
</table>
</span></div>
</span></div>
</figure>
</div>
</div>
</figure>
<div id="S4.SS2.p2" class="ltx_para ltx_noindent">
<p id="S4.SS2.p2.10" class="ltx_p"><span id="S4.SS2.p2.10.1" class="ltx_text ltx_font_bold">Effectiveness of Aligning Bag of Regions.</span> We start from a baseline that only uses the individual-level loss <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{\text{individual}}" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><msub id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p2.1.m1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.2.cmml">ℒ</mi><mtext id="S4.SS2.p2.1.m1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.3a.cmml">individual</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2">ℒ</ci><ci id="S4.SS2.p2.1.m1.1.1.3a.cmml" xref="S4.SS2.p2.1.m1.1.1.3"><mtext mathsize="70%" id="S4.SS2.p2.1.m1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3">individual</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">\mathcal{L}_{\text{individual}}</annotation></semantics></math>. As shown in Table <a href="#S4.T6" title="Table 6 ‣ 4.2 Ablation Study ‣ 4 Experiments ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>(<math id="S4.SS2.p2.2.m2.1" class="ltx_Math" alttext="\#1" display="inline"><semantics id="S4.SS2.p2.2.m2.1a"><mrow id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml"><mi mathvariant="normal" id="S4.SS2.p2.2.m2.1.1.2" xref="S4.SS2.p2.2.m2.1.1.2.cmml">#</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.2.m2.1.1.1" xref="S4.SS2.p2.2.m2.1.1.1.cmml">​</mo><mn id="S4.SS2.p2.2.m2.1.1.3" xref="S4.SS2.p2.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><apply id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1"><times id="S4.SS2.p2.2.m2.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1"></times><ci id="S4.SS2.p2.2.m2.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1.2">#</ci><cn type="integer" id="S4.SS2.p2.2.m2.1.1.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">\#1</annotation></semantics></math>), the individual-level baseline achieves 25.7 mAP<math id="S4.SS2.p2.3.m3.1" class="ltx_Math" alttext="{}_{\text{50}}" display="inline"><semantics id="S4.SS2.p2.3.m3.1a"><msub id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml"><mi id="S4.SS2.p2.3.m3.1.1a" xref="S4.SS2.p2.3.m3.1.1.cmml"></mi><mtext id="S4.SS2.p2.3.m3.1.1.1" xref="S4.SS2.p2.3.m3.1.1.1a.cmml">50</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><apply id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1"><ci id="S4.SS2.p2.3.m3.1.1.1a.cmml" xref="S4.SS2.p2.3.m3.1.1.1"><mtext mathsize="70%" id="S4.SS2.p2.3.m3.1.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1.1">50</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">{}_{\text{50}}</annotation></semantics></math> on novel categories. We then replace <math id="S4.SS2.p2.4.m4.1" class="ltx_Math" alttext="\mathcal{L}_{\text{individual}}" display="inline"><semantics id="S4.SS2.p2.4.m4.1a"><msub id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p2.4.m4.1.1.2" xref="S4.SS2.p2.4.m4.1.1.2.cmml">ℒ</mi><mtext id="S4.SS2.p2.4.m4.1.1.3" xref="S4.SS2.p2.4.m4.1.1.3a.cmml">individual</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><apply id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.4.m4.1.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1">subscript</csymbol><ci id="S4.SS2.p2.4.m4.1.1.2.cmml" xref="S4.SS2.p2.4.m4.1.1.2">ℒ</ci><ci id="S4.SS2.p2.4.m4.1.1.3a.cmml" xref="S4.SS2.p2.4.m4.1.1.3"><mtext mathsize="70%" id="S4.SS2.p2.4.m4.1.1.3.cmml" xref="S4.SS2.p2.4.m4.1.1.3">individual</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.1c">\mathcal{L}_{\text{individual}}</annotation></semantics></math> with the loss for bag of regions <math id="S4.SS2.p2.5.m5.1" class="ltx_Math" alttext="\mathcal{L}_{\text{bag}}" display="inline"><semantics id="S4.SS2.p2.5.m5.1a"><msub id="S4.SS2.p2.5.m5.1.1" xref="S4.SS2.p2.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p2.5.m5.1.1.2" xref="S4.SS2.p2.5.m5.1.1.2.cmml">ℒ</mi><mtext id="S4.SS2.p2.5.m5.1.1.3" xref="S4.SS2.p2.5.m5.1.1.3a.cmml">bag</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.5.m5.1b"><apply id="S4.SS2.p2.5.m5.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.1.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1">subscript</csymbol><ci id="S4.SS2.p2.5.m5.1.1.2.cmml" xref="S4.SS2.p2.5.m5.1.1.2">ℒ</ci><ci id="S4.SS2.p2.5.m5.1.1.3a.cmml" xref="S4.SS2.p2.5.m5.1.1.3"><mtext mathsize="70%" id="S4.SS2.p2.5.m5.1.1.3.cmml" xref="S4.SS2.p2.5.m5.1.1.3">bag</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.5.m5.1c">\mathcal{L}_{\text{bag}}</annotation></semantics></math> (Table <a href="#S4.T6" title="Table 6 ‣ 4.2 Ablation Study ‣ 4 Experiments ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>(<math id="S4.SS2.p2.6.m6.1" class="ltx_Math" alttext="\#2" display="inline"><semantics id="S4.SS2.p2.6.m6.1a"><mrow id="S4.SS2.p2.6.m6.1.1" xref="S4.SS2.p2.6.m6.1.1.cmml"><mi mathvariant="normal" id="S4.SS2.p2.6.m6.1.1.2" xref="S4.SS2.p2.6.m6.1.1.2.cmml">#</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.6.m6.1.1.1" xref="S4.SS2.p2.6.m6.1.1.1.cmml">​</mo><mn id="S4.SS2.p2.6.m6.1.1.3" xref="S4.SS2.p2.6.m6.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.6.m6.1b"><apply id="S4.SS2.p2.6.m6.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1"><times id="S4.SS2.p2.6.m6.1.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1.1"></times><ci id="S4.SS2.p2.6.m6.1.1.2.cmml" xref="S4.SS2.p2.6.m6.1.1.2">#</ci><cn type="integer" id="S4.SS2.p2.6.m6.1.1.3.cmml" xref="S4.SS2.p2.6.m6.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.6.m6.1c">\#2</annotation></semantics></math>)). Without considering the spatial information of region boxes, the performance on novel categories is compatible with aligning individual regions.
When adding the positional embedding of the region boxes’ spatial information, the performance on novel categories (Table <a href="#S4.T6" title="Table 6 ‣ 4.2 Ablation Study ‣ 4 Experiments ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>(<math id="S4.SS2.p2.7.m7.1" class="ltx_Math" alttext="\#3" display="inline"><semantics id="S4.SS2.p2.7.m7.1a"><mrow id="S4.SS2.p2.7.m7.1.1" xref="S4.SS2.p2.7.m7.1.1.cmml"><mi mathvariant="normal" id="S4.SS2.p2.7.m7.1.1.2" xref="S4.SS2.p2.7.m7.1.1.2.cmml">#</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.7.m7.1.1.1" xref="S4.SS2.p2.7.m7.1.1.1.cmml">​</mo><mn id="S4.SS2.p2.7.m7.1.1.3" xref="S4.SS2.p2.7.m7.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.7.m7.1b"><apply id="S4.SS2.p2.7.m7.1.1.cmml" xref="S4.SS2.p2.7.m7.1.1"><times id="S4.SS2.p2.7.m7.1.1.1.cmml" xref="S4.SS2.p2.7.m7.1.1.1"></times><ci id="S4.SS2.p2.7.m7.1.1.2.cmml" xref="S4.SS2.p2.7.m7.1.1.2">#</ci><cn type="integer" id="S4.SS2.p2.7.m7.1.1.3.cmml" xref="S4.SS2.p2.7.m7.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.7.m7.1c">\#3</annotation></semantics></math>)) dramatically increases by 7.1 mAP<math id="S4.SS2.p2.8.m8.1" class="ltx_Math" alttext="{}_{\text{50}}" display="inline"><semantics id="S4.SS2.p2.8.m8.1a"><msub id="S4.SS2.p2.8.m8.1.1" xref="S4.SS2.p2.8.m8.1.1.cmml"><mi id="S4.SS2.p2.8.m8.1.1a" xref="S4.SS2.p2.8.m8.1.1.cmml"></mi><mtext id="S4.SS2.p2.8.m8.1.1.1" xref="S4.SS2.p2.8.m8.1.1.1a.cmml">50</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.8.m8.1b"><apply id="S4.SS2.p2.8.m8.1.1.cmml" xref="S4.SS2.p2.8.m8.1.1"><ci id="S4.SS2.p2.8.m8.1.1.1a.cmml" xref="S4.SS2.p2.8.m8.1.1.1"><mtext mathsize="70%" id="S4.SS2.p2.8.m8.1.1.1.cmml" xref="S4.SS2.p2.8.m8.1.1.1">50</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.8.m8.1c">{}_{\text{50}}</annotation></semantics></math>.
This means that the spatial information is essential to effectively exploit the compositional structure of co-occurring visual concepts in a bag of regions.
Finally, in Table <a href="#S4.T6" title="Table 6 ‣ 4.2 Ablation Study ‣ 4 Experiments ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>(<math id="S4.SS2.p2.9.m9.1" class="ltx_Math" alttext="\#4" display="inline"><semantics id="S4.SS2.p2.9.m9.1a"><mrow id="S4.SS2.p2.9.m9.1.1" xref="S4.SS2.p2.9.m9.1.1.cmml"><mi mathvariant="normal" id="S4.SS2.p2.9.m9.1.1.2" xref="S4.SS2.p2.9.m9.1.1.2.cmml">#</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.9.m9.1.1.1" xref="S4.SS2.p2.9.m9.1.1.1.cmml">​</mo><mn id="S4.SS2.p2.9.m9.1.1.3" xref="S4.SS2.p2.9.m9.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.9.m9.1b"><apply id="S4.SS2.p2.9.m9.1.1.cmml" xref="S4.SS2.p2.9.m9.1.1"><times id="S4.SS2.p2.9.m9.1.1.1.cmml" xref="S4.SS2.p2.9.m9.1.1.1"></times><ci id="S4.SS2.p2.9.m9.1.1.2.cmml" xref="S4.SS2.p2.9.m9.1.1.2">#</ci><cn type="integer" id="S4.SS2.p2.9.m9.1.1.3.cmml" xref="S4.SS2.p2.9.m9.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.9.m9.1c">\#4</annotation></semantics></math>), we find that the individual-level loss is complementary to the bag-of-regions alignment, which brings 1.2 mAP<math id="S4.SS2.p2.10.m10.1" class="ltx_Math" alttext="{}_{\text{50}}" display="inline"><semantics id="S4.SS2.p2.10.m10.1a"><msub id="S4.SS2.p2.10.m10.1.1" xref="S4.SS2.p2.10.m10.1.1.cmml"><mi id="S4.SS2.p2.10.m10.1.1a" xref="S4.SS2.p2.10.m10.1.1.cmml"></mi><mtext id="S4.SS2.p2.10.m10.1.1.1" xref="S4.SS2.p2.10.m10.1.1.1a.cmml">50</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.10.m10.1b"><apply id="S4.SS2.p2.10.m10.1.1.cmml" xref="S4.SS2.p2.10.m10.1.1"><ci id="S4.SS2.p2.10.m10.1.1.1a.cmml" xref="S4.SS2.p2.10.m10.1.1.1"><mtext mathsize="70%" id="S4.SS2.p2.10.m10.1.1.1.cmml" xref="S4.SS2.p2.10.m10.1.1.1">50</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.10.m10.1c">{}_{\text{50}}</annotation></semantics></math> performance gain on novel categories.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para ltx_noindent">
<p id="S4.SS2.p3.4" class="ltx_p"><span id="S4.SS2.p3.4.1" class="ltx_text ltx_font_bold">Sampling Strategies.</span>
We explore two baselines to sample bags of regions to support the rationale of our neighborhood sampling strategy. The first is to equally split an image into grids (dubbed as grid sampling) like the pre-training stage in OVR-CNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib56" title="" class="ltx_ref">56</a>]</cite> such that the fixed grids form a bag of regions. And the second is to
randomly sample region proposals to form a bag of regions (dubbed as random sampling). For a fair comparison, we keep the number of sampled regions in each sampling strategy roughly the same. Concretely, we split the images to <math id="S4.SS2.p3.1.m1.1" class="ltx_Math" alttext="3\times 3=9" display="inline"><semantics id="S4.SS2.p3.1.m1.1a"><mrow id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml"><mrow id="S4.SS2.p3.1.m1.1.1.2" xref="S4.SS2.p3.1.m1.1.1.2.cmml"><mn id="S4.SS2.p3.1.m1.1.1.2.2" xref="S4.SS2.p3.1.m1.1.1.2.2.cmml">3</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p3.1.m1.1.1.2.1" xref="S4.SS2.p3.1.m1.1.1.2.1.cmml">×</mo><mn id="S4.SS2.p3.1.m1.1.1.2.3" xref="S4.SS2.p3.1.m1.1.1.2.3.cmml">3</mn></mrow><mo id="S4.SS2.p3.1.m1.1.1.1" xref="S4.SS2.p3.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS2.p3.1.m1.1.1.3" xref="S4.SS2.p3.1.m1.1.1.3.cmml">9</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><apply id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1"><eq id="S4.SS2.p3.1.m1.1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1.1"></eq><apply id="S4.SS2.p3.1.m1.1.1.2.cmml" xref="S4.SS2.p3.1.m1.1.1.2"><times id="S4.SS2.p3.1.m1.1.1.2.1.cmml" xref="S4.SS2.p3.1.m1.1.1.2.1"></times><cn type="integer" id="S4.SS2.p3.1.m1.1.1.2.2.cmml" xref="S4.SS2.p3.1.m1.1.1.2.2">3</cn><cn type="integer" id="S4.SS2.p3.1.m1.1.1.2.3.cmml" xref="S4.SS2.p3.1.m1.1.1.2.3">3</cn></apply><cn type="integer" id="S4.SS2.p3.1.m1.1.1.3.cmml" xref="S4.SS2.p3.1.m1.1.1.3">9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">3\times 3=9</annotation></semantics></math> grids for the grid sampling strategy and sample 9 region proposals for the random sampling strategy. For these two strategies, we take 4 permutations of the regions to obtain richer bag-of-regions embeddings so that there would be 36 regions for each image. For the neighborhood sampling, we introduce a reduced version of the strategy that restricts the number of region proposals per image to 12 and takes 1 bag per proposal. This is because we record that the average number of regions in a bag is 3 with <math id="S4.SS2.p3.2.m2.1" class="ltx_Math" alttext="p_{b}=0.3" display="inline"><semantics id="S4.SS2.p3.2.m2.1a"><mrow id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml"><msub id="S4.SS2.p3.2.m2.1.1.2" xref="S4.SS2.p3.2.m2.1.1.2.cmml"><mi id="S4.SS2.p3.2.m2.1.1.2.2" xref="S4.SS2.p3.2.m2.1.1.2.2.cmml">p</mi><mi id="S4.SS2.p3.2.m2.1.1.2.3" xref="S4.SS2.p3.2.m2.1.1.2.3.cmml">b</mi></msub><mo id="S4.SS2.p3.2.m2.1.1.1" xref="S4.SS2.p3.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS2.p3.2.m2.1.1.3" xref="S4.SS2.p3.2.m2.1.1.3.cmml">0.3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><apply id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1"><eq id="S4.SS2.p3.2.m2.1.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1.1"></eq><apply id="S4.SS2.p3.2.m2.1.1.2.cmml" xref="S4.SS2.p3.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p3.2.m2.1.1.2.1.cmml" xref="S4.SS2.p3.2.m2.1.1.2">subscript</csymbol><ci id="S4.SS2.p3.2.m2.1.1.2.2.cmml" xref="S4.SS2.p3.2.m2.1.1.2.2">𝑝</ci><ci id="S4.SS2.p3.2.m2.1.1.2.3.cmml" xref="S4.SS2.p3.2.m2.1.1.2.3">𝑏</ci></apply><cn type="float" id="S4.SS2.p3.2.m2.1.1.3.cmml" xref="S4.SS2.p3.2.m2.1.1.3">0.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">p_{b}=0.3</annotation></semantics></math> and <math id="S4.SS2.p3.3.m3.1" class="ltx_Math" alttext="\alpha=3.0" display="inline"><semantics id="S4.SS2.p3.3.m3.1a"><mrow id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml"><mi id="S4.SS2.p3.3.m3.1.1.2" xref="S4.SS2.p3.3.m3.1.1.2.cmml">α</mi><mo id="S4.SS2.p3.3.m3.1.1.1" xref="S4.SS2.p3.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS2.p3.3.m3.1.1.3" xref="S4.SS2.p3.3.m3.1.1.3.cmml">3.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.1b"><apply id="S4.SS2.p3.3.m3.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1"><eq id="S4.SS2.p3.3.m3.1.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1.1"></eq><ci id="S4.SS2.p3.3.m3.1.1.2.cmml" xref="S4.SS2.p3.3.m3.1.1.2">𝛼</ci><cn type="float" id="S4.SS2.p3.3.m3.1.1.3.cmml" xref="S4.SS2.p3.3.m3.1.1.3">3.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.1c">\alpha=3.0</annotation></semantics></math>, meaning the average sampled regions for each image in the neighborhood sampling strategy is close to <math id="S4.SS2.p3.4.m4.1" class="ltx_Math" alttext="3\times 12=36" display="inline"><semantics id="S4.SS2.p3.4.m4.1a"><mrow id="S4.SS2.p3.4.m4.1.1" xref="S4.SS2.p3.4.m4.1.1.cmml"><mrow id="S4.SS2.p3.4.m4.1.1.2" xref="S4.SS2.p3.4.m4.1.1.2.cmml"><mn id="S4.SS2.p3.4.m4.1.1.2.2" xref="S4.SS2.p3.4.m4.1.1.2.2.cmml">3</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p3.4.m4.1.1.2.1" xref="S4.SS2.p3.4.m4.1.1.2.1.cmml">×</mo><mn id="S4.SS2.p3.4.m4.1.1.2.3" xref="S4.SS2.p3.4.m4.1.1.2.3.cmml">12</mn></mrow><mo id="S4.SS2.p3.4.m4.1.1.1" xref="S4.SS2.p3.4.m4.1.1.1.cmml">=</mo><mn id="S4.SS2.p3.4.m4.1.1.3" xref="S4.SS2.p3.4.m4.1.1.3.cmml">36</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.4.m4.1b"><apply id="S4.SS2.p3.4.m4.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1"><eq id="S4.SS2.p3.4.m4.1.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1.1"></eq><apply id="S4.SS2.p3.4.m4.1.1.2.cmml" xref="S4.SS2.p3.4.m4.1.1.2"><times id="S4.SS2.p3.4.m4.1.1.2.1.cmml" xref="S4.SS2.p3.4.m4.1.1.2.1"></times><cn type="integer" id="S4.SS2.p3.4.m4.1.1.2.2.cmml" xref="S4.SS2.p3.4.m4.1.1.2.2">3</cn><cn type="integer" id="S4.SS2.p3.4.m4.1.1.2.3.cmml" xref="S4.SS2.p3.4.m4.1.1.2.3">12</cn></apply><cn type="integer" id="S4.SS2.p3.4.m4.1.1.3.cmml" xref="S4.SS2.p3.4.m4.1.1.3">36</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.4.m4.1c">3\times 12=36</annotation></semantics></math>.</p>
</div>
<div id="S4.SS2.p4" class="ltx_para">
<p id="S4.SS2.p4.6" class="ltx_p">The grid sampling strategy, whose fixed regions may either contain too many objects or only small parts of an object, achieves 25.4 mAP<sub id="S4.SS2.p4.6.1" class="ltx_sub"><span id="S4.SS2.p4.6.1.1" class="ltx_text ltx_font_italic">50</span></sub> on the novel categories as shown in Table <a href="#S4.T6" title="Table 6 ‣ 4.2 Ablation Study ‣ 4 Experiments ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>(<math id="S4.SS2.p4.2.m2.1" class="ltx_Math" alttext="\#1" display="inline"><semantics id="S4.SS2.p4.2.m2.1a"><mrow id="S4.SS2.p4.2.m2.1.1" xref="S4.SS2.p4.2.m2.1.1.cmml"><mi mathvariant="normal" id="S4.SS2.p4.2.m2.1.1.2" xref="S4.SS2.p4.2.m2.1.1.2.cmml">#</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p4.2.m2.1.1.1" xref="S4.SS2.p4.2.m2.1.1.1.cmml">​</mo><mn id="S4.SS2.p4.2.m2.1.1.3" xref="S4.SS2.p4.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.2.m2.1b"><apply id="S4.SS2.p4.2.m2.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1"><times id="S4.SS2.p4.2.m2.1.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1.1"></times><ci id="S4.SS2.p4.2.m2.1.1.2.cmml" xref="S4.SS2.p4.2.m2.1.1.2">#</ci><cn type="integer" id="S4.SS2.p4.2.m2.1.1.3.cmml" xref="S4.SS2.p4.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.2.m2.1c">\#1</annotation></semantics></math>). For the random sampling strategy, regions in a bag have different sizes and shapes and the distance between the regions can be large, which hinders the image encoder to exactly represent the bag of regions. It achieves 27.3 mAP<sub id="S4.SS2.p4.6.2" class="ltx_sub"><span id="S4.SS2.p4.6.2.1" class="ltx_text ltx_font_italic">50</span></sub> as shown in Table <a href="#S4.T6" title="Table 6 ‣ 4.2 Ablation Study ‣ 4 Experiments ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>(<math id="S4.SS2.p4.4.m4.1" class="ltx_Math" alttext="\#2" display="inline"><semantics id="S4.SS2.p4.4.m4.1a"><mrow id="S4.SS2.p4.4.m4.1.1" xref="S4.SS2.p4.4.m4.1.1.cmml"><mi mathvariant="normal" id="S4.SS2.p4.4.m4.1.1.2" xref="S4.SS2.p4.4.m4.1.1.2.cmml">#</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p4.4.m4.1.1.1" xref="S4.SS2.p4.4.m4.1.1.1.cmml">​</mo><mn id="S4.SS2.p4.4.m4.1.1.3" xref="S4.SS2.p4.4.m4.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.4.m4.1b"><apply id="S4.SS2.p4.4.m4.1.1.cmml" xref="S4.SS2.p4.4.m4.1.1"><times id="S4.SS2.p4.4.m4.1.1.1.cmml" xref="S4.SS2.p4.4.m4.1.1.1"></times><ci id="S4.SS2.p4.4.m4.1.1.2.cmml" xref="S4.SS2.p4.4.m4.1.1.2">#</ci><cn type="integer" id="S4.SS2.p4.4.m4.1.1.3.cmml" xref="S4.SS2.p4.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.4.m4.1c">\#2</annotation></semantics></math>). While our neighborhood sampling strategy utilizes the same amount of regions, we record 32.2 mAP on the novel categories in Table <a href="#S4.T6" title="Table 6 ‣ 4.2 Ablation Study ‣ 4 Experiments ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>(<math id="S4.SS2.p4.5.m5.1" class="ltx_Math" alttext="\#3" display="inline"><semantics id="S4.SS2.p4.5.m5.1a"><mrow id="S4.SS2.p4.5.m5.1.1" xref="S4.SS2.p4.5.m5.1.1.cmml"><mi mathvariant="normal" id="S4.SS2.p4.5.m5.1.1.2" xref="S4.SS2.p4.5.m5.1.1.2.cmml">#</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p4.5.m5.1.1.1" xref="S4.SS2.p4.5.m5.1.1.1.cmml">​</mo><mn id="S4.SS2.p4.5.m5.1.1.3" xref="S4.SS2.p4.5.m5.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.5.m5.1b"><apply id="S4.SS2.p4.5.m5.1.1.cmml" xref="S4.SS2.p4.5.m5.1.1"><times id="S4.SS2.p4.5.m5.1.1.1.cmml" xref="S4.SS2.p4.5.m5.1.1.1"></times><ci id="S4.SS2.p4.5.m5.1.1.2.cmml" xref="S4.SS2.p4.5.m5.1.1.2">#</ci><cn type="integer" id="S4.SS2.p4.5.m5.1.1.3.cmml" xref="S4.SS2.p4.5.m5.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.5.m5.1c">\#3</annotation></semantics></math>). Compared to these two baselines, our neighborhood sampling strategy captures potential objects in the vicinity of region proposals and ensures the teacher embedding exactly represents the bag of regions by sampling the neighboring boxes of region proposals. Note that our result in Table <a href="#S4.T6" title="Table 6 ‣ 4.2 Ablation Study ‣ 4 Experiments ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>(<math id="S4.SS2.p4.6.m6.1" class="ltx_Math" alttext="\#4" display="inline"><semantics id="S4.SS2.p4.6.m6.1a"><mrow id="S4.SS2.p4.6.m6.1.1" xref="S4.SS2.p4.6.m6.1.1.cmml"><mi mathvariant="normal" id="S4.SS2.p4.6.m6.1.1.2" xref="S4.SS2.p4.6.m6.1.1.2.cmml">#</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p4.6.m6.1.1.1" xref="S4.SS2.p4.6.m6.1.1.1.cmml">​</mo><mn id="S4.SS2.p4.6.m6.1.1.3" xref="S4.SS2.p4.6.m6.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.6.m6.1b"><apply id="S4.SS2.p4.6.m6.1.1.cmml" xref="S4.SS2.p4.6.m6.1.1"><times id="S4.SS2.p4.6.m6.1.1.1.cmml" xref="S4.SS2.p4.6.m6.1.1.1"></times><ci id="S4.SS2.p4.6.m6.1.1.2.cmml" xref="S4.SS2.p4.6.m6.1.1.2">#</ci><cn type="integer" id="S4.SS2.p4.6.m6.1.1.3.cmml" xref="S4.SS2.p4.6.m6.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.6.m6.1c">\#4</annotation></semantics></math>) is achieved with 3 groups per region proposal and no limitation on the number of region proposals. More details on how we develop the sampling strategy are in the appendix.</p>
</div>
<div id="S4.SS2.p5" class="ltx_para ltx_noindent">
<p id="S4.SS2.p5.4" class="ltx_p"><span id="S4.SS2.p5.4.1" class="ltx_text ltx_font_bold">Box Overlap between Regions in a Bag.</span> We let the sampled regions in a group overlap at a certain IOF. In Table <a href="#S4.T6" title="Table 6 ‣ 4.2 Ablation Study ‣ 4 Experiments ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>, we show how the overlap between boxes affects the performance. The scalar smaller than 0.0 in Table <a href="#S4.T6" title="Table 6 ‣ 4.2 Ablation Study ‣ 4 Experiments ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>(<math id="S4.SS2.p5.1.m1.1" class="ltx_Math" alttext="\#1" display="inline"><semantics id="S4.SS2.p5.1.m1.1a"><mrow id="S4.SS2.p5.1.m1.1.1" xref="S4.SS2.p5.1.m1.1.1.cmml"><mi mathvariant="normal" id="S4.SS2.p5.1.m1.1.1.2" xref="S4.SS2.p5.1.m1.1.1.2.cmml">#</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p5.1.m1.1.1.1" xref="S4.SS2.p5.1.m1.1.1.1.cmml">​</mo><mn id="S4.SS2.p5.1.m1.1.1.3" xref="S4.SS2.p5.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.1.m1.1b"><apply id="S4.SS2.p5.1.m1.1.1.cmml" xref="S4.SS2.p5.1.m1.1.1"><times id="S4.SS2.p5.1.m1.1.1.1.cmml" xref="S4.SS2.p5.1.m1.1.1.1"></times><ci id="S4.SS2.p5.1.m1.1.1.2.cmml" xref="S4.SS2.p5.1.m1.1.1.2">#</ci><cn type="integer" id="S4.SS2.p5.1.m1.1.1.3.cmml" xref="S4.SS2.p5.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.1.m1.1c">\#1</annotation></semantics></math>) means that we keep an interval between the sampled boxes. The best performance (34.0 mAP<math id="S4.SS2.p5.2.m2.1" class="ltx_Math" alttext="{}_{\text{50}}" display="inline"><semantics id="S4.SS2.p5.2.m2.1a"><msub id="S4.SS2.p5.2.m2.1.1" xref="S4.SS2.p5.2.m2.1.1.cmml"><mi id="S4.SS2.p5.2.m2.1.1a" xref="S4.SS2.p5.2.m2.1.1.cmml"></mi><mtext id="S4.SS2.p5.2.m2.1.1.1" xref="S4.SS2.p5.2.m2.1.1.1a.cmml">50</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.2.m2.1b"><apply id="S4.SS2.p5.2.m2.1.1.cmml" xref="S4.SS2.p5.2.m2.1.1"><ci id="S4.SS2.p5.2.m2.1.1.1a.cmml" xref="S4.SS2.p5.2.m2.1.1.1"><mtext mathsize="70%" id="S4.SS2.p5.2.m2.1.1.1.cmml" xref="S4.SS2.p5.2.m2.1.1.1">50</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.2.m2.1c">{}_{\text{50}}</annotation></semantics></math>) comes with an overlap of 0.1. Table <a href="#S4.T6" title="Table 6 ‣ 4.2 Ablation Study ‣ 4 Experiments ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>(<math id="S4.SS2.p5.3.m3.1" class="ltx_Math" alttext="\#1-3" display="inline"><semantics id="S4.SS2.p5.3.m3.1a"><mrow id="S4.SS2.p5.3.m3.1.1" xref="S4.SS2.p5.3.m3.1.1.cmml"><mrow id="S4.SS2.p5.3.m3.1.1.2" xref="S4.SS2.p5.3.m3.1.1.2.cmml"><mi mathvariant="normal" id="S4.SS2.p5.3.m3.1.1.2.2" xref="S4.SS2.p5.3.m3.1.1.2.2.cmml">#</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p5.3.m3.1.1.2.1" xref="S4.SS2.p5.3.m3.1.1.2.1.cmml">​</mo><mn id="S4.SS2.p5.3.m3.1.1.2.3" xref="S4.SS2.p5.3.m3.1.1.2.3.cmml">1</mn></mrow><mo id="S4.SS2.p5.3.m3.1.1.1" xref="S4.SS2.p5.3.m3.1.1.1.cmml">−</mo><mn id="S4.SS2.p5.3.m3.1.1.3" xref="S4.SS2.p5.3.m3.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.3.m3.1b"><apply id="S4.SS2.p5.3.m3.1.1.cmml" xref="S4.SS2.p5.3.m3.1.1"><minus id="S4.SS2.p5.3.m3.1.1.1.cmml" xref="S4.SS2.p5.3.m3.1.1.1"></minus><apply id="S4.SS2.p5.3.m3.1.1.2.cmml" xref="S4.SS2.p5.3.m3.1.1.2"><times id="S4.SS2.p5.3.m3.1.1.2.1.cmml" xref="S4.SS2.p5.3.m3.1.1.2.1"></times><ci id="S4.SS2.p5.3.m3.1.1.2.2.cmml" xref="S4.SS2.p5.3.m3.1.1.2.2">#</ci><cn type="integer" id="S4.SS2.p5.3.m3.1.1.2.3.cmml" xref="S4.SS2.p5.3.m3.1.1.2.3">1</cn></apply><cn type="integer" id="S4.SS2.p5.3.m3.1.1.3.cmml" xref="S4.SS2.p5.3.m3.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.3.m3.1c">\#1-3</annotation></semantics></math>) indicate that the regions in a group need to have a continuity of semantics. Table <a href="#S4.T6" title="Table 6 ‣ 4.2 Ablation Study ‣ 4 Experiments ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>(<math id="S4.SS2.p5.4.m4.1" class="ltx_Math" alttext="\#3-5" display="inline"><semantics id="S4.SS2.p5.4.m4.1a"><mrow id="S4.SS2.p5.4.m4.1.1" xref="S4.SS2.p5.4.m4.1.1.cmml"><mrow id="S4.SS2.p5.4.m4.1.1.2" xref="S4.SS2.p5.4.m4.1.1.2.cmml"><mi mathvariant="normal" id="S4.SS2.p5.4.m4.1.1.2.2" xref="S4.SS2.p5.4.m4.1.1.2.2.cmml">#</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p5.4.m4.1.1.2.1" xref="S4.SS2.p5.4.m4.1.1.2.1.cmml">​</mo><mn id="S4.SS2.p5.4.m4.1.1.2.3" xref="S4.SS2.p5.4.m4.1.1.2.3.cmml">3</mn></mrow><mo id="S4.SS2.p5.4.m4.1.1.1" xref="S4.SS2.p5.4.m4.1.1.1.cmml">−</mo><mn id="S4.SS2.p5.4.m4.1.1.3" xref="S4.SS2.p5.4.m4.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.4.m4.1b"><apply id="S4.SS2.p5.4.m4.1.1.cmml" xref="S4.SS2.p5.4.m4.1.1"><minus id="S4.SS2.p5.4.m4.1.1.1.cmml" xref="S4.SS2.p5.4.m4.1.1.1"></minus><apply id="S4.SS2.p5.4.m4.1.1.2.cmml" xref="S4.SS2.p5.4.m4.1.1.2"><times id="S4.SS2.p5.4.m4.1.1.2.1.cmml" xref="S4.SS2.p5.4.m4.1.1.2.1"></times><ci id="S4.SS2.p5.4.m4.1.1.2.2.cmml" xref="S4.SS2.p5.4.m4.1.1.2.2">#</ci><cn type="integer" id="S4.SS2.p5.4.m4.1.1.2.3.cmml" xref="S4.SS2.p5.4.m4.1.1.2.3">3</cn></apply><cn type="integer" id="S4.SS2.p5.4.m4.1.1.3.cmml" xref="S4.SS2.p5.4.m4.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.4.m4.1c">\#3-5</annotation></semantics></math>) indicate that the regions also need to cover diverse image contents.</p>
</div>
<div id="S4.SS2.p6" class="ltx_para ltx_noindent">
<p id="S4.SS2.p6.6" class="ltx_p"><span id="S4.SS2.p6.6.1" class="ltx_text ltx_font_bold">Sampling Probability.</span> We study the effect of the probability <math id="S4.SS2.p6.1.m1.1" class="ltx_Math" alttext="p_{b}" display="inline"><semantics id="S4.SS2.p6.1.m1.1a"><msub id="S4.SS2.p6.1.m1.1.1" xref="S4.SS2.p6.1.m1.1.1.cmml"><mi id="S4.SS2.p6.1.m1.1.1.2" xref="S4.SS2.p6.1.m1.1.1.2.cmml">p</mi><mi id="S4.SS2.p6.1.m1.1.1.3" xref="S4.SS2.p6.1.m1.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p6.1.m1.1b"><apply id="S4.SS2.p6.1.m1.1.1.cmml" xref="S4.SS2.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p6.1.m1.1.1.1.cmml" xref="S4.SS2.p6.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p6.1.m1.1.1.2.cmml" xref="S4.SS2.p6.1.m1.1.1.2">𝑝</ci><ci id="S4.SS2.p6.1.m1.1.1.3.cmml" xref="S4.SS2.p6.1.m1.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p6.1.m1.1c">p_{b}</annotation></semantics></math> to sample the candidate boxes, which affects the number of regions in a bag. The details are in Sec. <a href="#S3.SS2" title="3.2 Forming Bag of Regions ‣ 3 Method ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>. Note that the <math id="S4.SS2.p6.2.m2.1" class="ltx_Math" alttext="p_{b}" display="inline"><semantics id="S4.SS2.p6.2.m2.1a"><msub id="S4.SS2.p6.2.m2.1.1" xref="S4.SS2.p6.2.m2.1.1.cmml"><mi id="S4.SS2.p6.2.m2.1.1.2" xref="S4.SS2.p6.2.m2.1.1.2.cmml">p</mi><mi id="S4.SS2.p6.2.m2.1.1.3" xref="S4.SS2.p6.2.m2.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p6.2.m2.1b"><apply id="S4.SS2.p6.2.m2.1.1.cmml" xref="S4.SS2.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p6.2.m2.1.1.1.cmml" xref="S4.SS2.p6.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p6.2.m2.1.1.2.cmml" xref="S4.SS2.p6.2.m2.1.1.2">𝑝</ci><ci id="S4.SS2.p6.2.m2.1.1.3.cmml" xref="S4.SS2.p6.2.m2.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p6.2.m2.1c">p_{b}</annotation></semantics></math> will be adjusted by the aspect ratio scaled with the scale factor <math id="S4.SS2.p6.3.m3.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS2.p6.3.m3.1a"><mi id="S4.SS2.p6.3.m3.1.1" xref="S4.SS2.p6.3.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p6.3.m3.1b"><ci id="S4.SS2.p6.3.m3.1.1.cmml" xref="S4.SS2.p6.3.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p6.3.m3.1c">\alpha</annotation></semantics></math>. We fix <math id="S4.SS2.p6.4.m4.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS2.p6.4.m4.1a"><mi id="S4.SS2.p6.4.m4.1.1" xref="S4.SS2.p6.4.m4.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p6.4.m4.1b"><ci id="S4.SS2.p6.4.m4.1.1.cmml" xref="S4.SS2.p6.4.m4.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p6.4.m4.1c">\alpha</annotation></semantics></math> as 3.0 and sample 3 bags for each region proposal. We observe that the best result on novel categories (34.0 mAP<sub id="S4.SS2.p6.6.2" class="ltx_sub"><span id="S4.SS2.p6.6.2.1" class="ltx_text ltx_font_italic">50</span></sub>) is achieved with <math id="S4.SS2.p6.6.m6.1" class="ltx_Math" alttext="p_{b}=0.3" display="inline"><semantics id="S4.SS2.p6.6.m6.1a"><mrow id="S4.SS2.p6.6.m6.1.1" xref="S4.SS2.p6.6.m6.1.1.cmml"><msub id="S4.SS2.p6.6.m6.1.1.2" xref="S4.SS2.p6.6.m6.1.1.2.cmml"><mi id="S4.SS2.p6.6.m6.1.1.2.2" xref="S4.SS2.p6.6.m6.1.1.2.2.cmml">p</mi><mi id="S4.SS2.p6.6.m6.1.1.2.3" xref="S4.SS2.p6.6.m6.1.1.2.3.cmml">b</mi></msub><mo id="S4.SS2.p6.6.m6.1.1.1" xref="S4.SS2.p6.6.m6.1.1.1.cmml">=</mo><mn id="S4.SS2.p6.6.m6.1.1.3" xref="S4.SS2.p6.6.m6.1.1.3.cmml">0.3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p6.6.m6.1b"><apply id="S4.SS2.p6.6.m6.1.1.cmml" xref="S4.SS2.p6.6.m6.1.1"><eq id="S4.SS2.p6.6.m6.1.1.1.cmml" xref="S4.SS2.p6.6.m6.1.1.1"></eq><apply id="S4.SS2.p6.6.m6.1.1.2.cmml" xref="S4.SS2.p6.6.m6.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p6.6.m6.1.1.2.1.cmml" xref="S4.SS2.p6.6.m6.1.1.2">subscript</csymbol><ci id="S4.SS2.p6.6.m6.1.1.2.2.cmml" xref="S4.SS2.p6.6.m6.1.1.2.2">𝑝</ci><ci id="S4.SS2.p6.6.m6.1.1.2.3.cmml" xref="S4.SS2.p6.6.m6.1.1.2.3">𝑏</ci></apply><cn type="float" id="S4.SS2.p6.6.m6.1.1.3.cmml" xref="S4.SS2.p6.6.m6.1.1.3">0.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p6.6.m6.1c">p_{b}=0.3</annotation></semantics></math> in Table <a href="#S4.T9" title="Table 9 ‣ 4.2 Ablation Study ‣ 4 Experiments ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>.</p>
</div>
<div id="S4.SS2.p7" class="ltx_para ltx_noindent">
<p id="S4.SS2.p7.4" class="ltx_p"><span id="S4.SS2.p7.4.1" class="ltx_text ltx_font_bold">Number of Bags Per Proposal.</span> We show the effect of the number of sampled bags (<math id="S4.SS2.p7.1.m1.1" class="ltx_Math" alttext="\#" display="inline"><semantics id="S4.SS2.p7.1.m1.1a"><mi mathvariant="normal" id="S4.SS2.p7.1.m1.1.1" xref="S4.SS2.p7.1.m1.1.1.cmml">#</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p7.1.m1.1b"><ci id="S4.SS2.p7.1.m1.1.1.cmml" xref="S4.SS2.p7.1.m1.1.1">#</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p7.1.m1.1c">\#</annotation></semantics></math>bags) for each region proposal in Table <a href="#S4.T9" title="Table 9 ‣ 4.2 Ablation Study ‣ 4 Experiments ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>. For details, please refer to Sec <a href="#S3.SS2" title="3.2 Forming Bag of Regions ‣ 3 Method ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>. We fix <math id="S4.SS2.p7.2.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS2.p7.2.m2.1a"><mi id="S4.SS2.p7.2.m2.1.1" xref="S4.SS2.p7.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p7.2.m2.1b"><ci id="S4.SS2.p7.2.m2.1.1.cmml" xref="S4.SS2.p7.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p7.2.m2.1c">\alpha</annotation></semantics></math> as 3.0 and the sampling probability <math id="S4.SS2.p7.3.m3.1" class="ltx_Math" alttext="p_{b}" display="inline"><semantics id="S4.SS2.p7.3.m3.1a"><msub id="S4.SS2.p7.3.m3.1.1" xref="S4.SS2.p7.3.m3.1.1.cmml"><mi id="S4.SS2.p7.3.m3.1.1.2" xref="S4.SS2.p7.3.m3.1.1.2.cmml">p</mi><mi id="S4.SS2.p7.3.m3.1.1.3" xref="S4.SS2.p7.3.m3.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p7.3.m3.1b"><apply id="S4.SS2.p7.3.m3.1.1.cmml" xref="S4.SS2.p7.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p7.3.m3.1.1.1.cmml" xref="S4.SS2.p7.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.p7.3.m3.1.1.2.cmml" xref="S4.SS2.p7.3.m3.1.1.2">𝑝</ci><ci id="S4.SS2.p7.3.m3.1.1.3.cmml" xref="S4.SS2.p7.3.m3.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p7.3.m3.1c">p_{b}</annotation></semantics></math> as 0.3. We observe that the best result on novel categories (34.0 mAP<sub id="S4.SS2.p7.4.2" class="ltx_sub"><span id="S4.SS2.p7.4.2.1" class="ltx_text ltx_font_italic">50</span></sub>) is achieved with three bags of regions for each region proposal in Table <a href="#S4.T9" title="Table 9 ‣ 4.2 Ablation Study ‣ 4 Experiments ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>.</p>
</div>
<div id="S4.SS2.p8" class="ltx_para ltx_noindent">
<p id="S4.SS2.p8.3" class="ltx_p"><span id="S4.SS2.p8.3.1" class="ltx_text ltx_font_bold">Number of Pseudo Words Per Region.</span> As an object category often needs many words to reach a precise description, we study the number of pseudo words (<math id="S4.SS2.p8.1.m1.1" class="ltx_Math" alttext="\#" display="inline"><semantics id="S4.SS2.p8.1.m1.1a"><mi mathvariant="normal" id="S4.SS2.p8.1.m1.1.1" xref="S4.SS2.p8.1.m1.1.1.cmml">#</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p8.1.m1.1b"><ci id="S4.SS2.p8.1.m1.1.1.cmml" xref="S4.SS2.p8.1.m1.1.1">#</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p8.1.m1.1c">\#</annotation></semantics></math>wordss) predicted for each region of interest. Table <a href="#S4.T9" title="Table 9 ‣ 4.2 Ablation Study ‣ 4 Experiments ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>(<math id="S4.SS2.p8.2.m2.1" class="ltx_Math" alttext="\#1-3" display="inline"><semantics id="S4.SS2.p8.2.m2.1a"><mrow id="S4.SS2.p8.2.m2.1.1" xref="S4.SS2.p8.2.m2.1.1.cmml"><mrow id="S4.SS2.p8.2.m2.1.1.2" xref="S4.SS2.p8.2.m2.1.1.2.cmml"><mi mathvariant="normal" id="S4.SS2.p8.2.m2.1.1.2.2" xref="S4.SS2.p8.2.m2.1.1.2.2.cmml">#</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p8.2.m2.1.1.2.1" xref="S4.SS2.p8.2.m2.1.1.2.1.cmml">​</mo><mn id="S4.SS2.p8.2.m2.1.1.2.3" xref="S4.SS2.p8.2.m2.1.1.2.3.cmml">1</mn></mrow><mo id="S4.SS2.p8.2.m2.1.1.1" xref="S4.SS2.p8.2.m2.1.1.1.cmml">−</mo><mn id="S4.SS2.p8.2.m2.1.1.3" xref="S4.SS2.p8.2.m2.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p8.2.m2.1b"><apply id="S4.SS2.p8.2.m2.1.1.cmml" xref="S4.SS2.p8.2.m2.1.1"><minus id="S4.SS2.p8.2.m2.1.1.1.cmml" xref="S4.SS2.p8.2.m2.1.1.1"></minus><apply id="S4.SS2.p8.2.m2.1.1.2.cmml" xref="S4.SS2.p8.2.m2.1.1.2"><times id="S4.SS2.p8.2.m2.1.1.2.1.cmml" xref="S4.SS2.p8.2.m2.1.1.2.1"></times><ci id="S4.SS2.p8.2.m2.1.1.2.2.cmml" xref="S4.SS2.p8.2.m2.1.1.2.2">#</ci><cn type="integer" id="S4.SS2.p8.2.m2.1.1.2.3.cmml" xref="S4.SS2.p8.2.m2.1.1.2.3">1</cn></apply><cn type="integer" id="S4.SS2.p8.2.m2.1.1.3.cmml" xref="S4.SS2.p8.2.m2.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p8.2.m2.1c">\#1-3</annotation></semantics></math>) show that the performance on novel categories increases with the number of pseudo words, indicating that stacking more pseudo words to a certain extent can strengthen the detector’s ability to distinguish object categories. However, the results in Table <a href="#S4.T9" title="Table 9 ‣ 4.2 Ablation Study ‣ 4 Experiments ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>(<math id="S4.SS2.p8.3.m3.1" class="ltx_Math" alttext="\#1-3" display="inline"><semantics id="S4.SS2.p8.3.m3.1a"><mrow id="S4.SS2.p8.3.m3.1.1" xref="S4.SS2.p8.3.m3.1.1.cmml"><mrow id="S4.SS2.p8.3.m3.1.1.2" xref="S4.SS2.p8.3.m3.1.1.2.cmml"><mi mathvariant="normal" id="S4.SS2.p8.3.m3.1.1.2.2" xref="S4.SS2.p8.3.m3.1.1.2.2.cmml">#</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p8.3.m3.1.1.2.1" xref="S4.SS2.p8.3.m3.1.1.2.1.cmml">​</mo><mn id="S4.SS2.p8.3.m3.1.1.2.3" xref="S4.SS2.p8.3.m3.1.1.2.3.cmml">1</mn></mrow><mo id="S4.SS2.p8.3.m3.1.1.1" xref="S4.SS2.p8.3.m3.1.1.1.cmml">−</mo><mn id="S4.SS2.p8.3.m3.1.1.3" xref="S4.SS2.p8.3.m3.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p8.3.m3.1b"><apply id="S4.SS2.p8.3.m3.1.1.cmml" xref="S4.SS2.p8.3.m3.1.1"><minus id="S4.SS2.p8.3.m3.1.1.1.cmml" xref="S4.SS2.p8.3.m3.1.1.1"></minus><apply id="S4.SS2.p8.3.m3.1.1.2.cmml" xref="S4.SS2.p8.3.m3.1.1.2"><times id="S4.SS2.p8.3.m3.1.1.2.1.cmml" xref="S4.SS2.p8.3.m3.1.1.2.1"></times><ci id="S4.SS2.p8.3.m3.1.1.2.2.cmml" xref="S4.SS2.p8.3.m3.1.1.2.2">#</ci><cn type="integer" id="S4.SS2.p8.3.m3.1.1.2.3.cmml" xref="S4.SS2.p8.3.m3.1.1.2.3">1</cn></apply><cn type="integer" id="S4.SS2.p8.3.m3.1.1.3.cmml" xref="S4.SS2.p8.3.m3.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p8.3.m3.1c">\#1-3</annotation></semantics></math>) show that further increasing the number of pseudo words does not bring performance gain, and redundant words can even do harm to the performance.</p>
</div>
<figure id="S4.F5" class="ltx_figure"><img src="/html/2302.13996/assets/figs/visualization.jpg" id="S4.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="201" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F5.7.2.1" class="ltx_text" style="font-size:90%;">Figure 5</span>: </span><span id="S4.F5.2.1" class="ltx_text" style="font-size:90%;">Qualitative comparisons of BARON and the individual-level baseline in Table <a href="#S4.T6" title="Table 6 ‣ 4.2 Ablation Study ‣ 4 Experiments ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>(<math id="S4.F5.2.1.m1.1" class="ltx_Math" alttext="\#1" display="inline"><semantics id="S4.F5.2.1.m1.1b"><mrow id="S4.F5.2.1.m1.1.1" xref="S4.F5.2.1.m1.1.1.cmml"><mi mathvariant="normal" id="S4.F5.2.1.m1.1.1.2" xref="S4.F5.2.1.m1.1.1.2.cmml">#</mi><mo lspace="0em" rspace="0em" id="S4.F5.2.1.m1.1.1.1" xref="S4.F5.2.1.m1.1.1.1.cmml">​</mo><mn id="S4.F5.2.1.m1.1.1.3" xref="S4.F5.2.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F5.2.1.m1.1c"><apply id="S4.F5.2.1.m1.1.1.cmml" xref="S4.F5.2.1.m1.1.1"><times id="S4.F5.2.1.m1.1.1.1.cmml" xref="S4.F5.2.1.m1.1.1.1"></times><ci id="S4.F5.2.1.m1.1.1.2.cmml" xref="S4.F5.2.1.m1.1.1.2">#</ci><cn type="integer" id="S4.F5.2.1.m1.1.1.3.cmml" xref="S4.F5.2.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.2.1.m1.1d">\#1</annotation></semantics></math>).
<span id="S4.F5.2.1.1" class="ltx_text ltx_font_bold">Top:</span> Red boxes are for the novel categories and blue for the base categories. <span id="S4.F5.2.1.2" class="ltx_text ltx_font_bold">Bottom:</span> Feature map’s responses to the queried novel object categories. From (a) to (c), the queried novel categories are ‘skateboard’, ‘airplane’ and ‘dog’, respectively.
<span id="S4.F5.2.1.3" class="ltx_text">BARON</span> detects objects of novel categories that are missed by the baseline.
</span></figcaption>
</figure>
<figure id="S4.F6" class="ltx_figure"><img src="/html/2302.13996/assets/figs/composition.jpg" id="S4.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="223" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F6.2.1.1" class="ltx_text" style="font-size:90%;">Figure 6</span>: </span><span id="S4.F6.3.2" class="ltx_text" style="font-size:90%;">For each image, we incrementally add the object categories that appear in it to the text description. The similarity score between the image and text embeddings increases as the text description becomes more complete and precise.</span></figcaption>
</figure>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Further Analysis</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">We show qualitative results in this section to further analyze the effectiveness of our method.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para ltx_noindent">
<p id="S4.SS3.p2.1" class="ltx_p"><span id="S4.SS3.p2.1.1" class="ltx_text ltx_font_bold">Co-occurrence of Objects.</span> We first illustrate how a pre-trained VLM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite> captures the co-occurrence of objects by comparing the image-text similarity in Fig. <a href="#S4.F6" title="Fig. 6 ‣ 4.2 Ablation Study ‣ 4 Experiments ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>.
We use the CLIP-ViT-B/32 model pre-trained on more than 400 million image-text pairs to obtain the image and text embeddings.
For each image, we incrementally add the object categories that appear to the text description.
We observe that the similarity score between the image and text embeddings increases as the text description includes more concepts as shown in Fig. <a href="#S4.F6" title="Fig. 6 ‣ 4.2 Ablation Study ‣ 4 Experiments ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>.
The examples reveal that the large-scale VLMs could capture the co-occurrence of multiple concepts in an image, although they are not explicitly trained to do so.
We believe this is because each image-text pair naturally contains multiple concepts and the VLMs could implicitly learn the underlying connections when training on massive-scale image-text pairs. We also find simple relationship between objects can also be captured by the VLMs, <em id="S4.SS3.p2.1.2" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S4.SS3.p2.1.3" class="ltx_text"></span>, the similarity increases when we add the relation ‘in front of’ to the text description in the second example of Fig <a href="#S4.F6" title="Fig. 6 ‣ 4.2 Ablation Study ‣ 4 Experiments ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>.</p>
</div>
<div id="S4.SS3.p3" class="ltx_para ltx_noindent">
<p id="S4.SS3.p3.1" class="ltx_p"><span id="S4.SS3.p3.1.1" class="ltx_text ltx_font_bold">Visualization.</span> We further visualize the predictions of detectors learned through <span id="S4.SS3.p3.1.2" class="ltx_text">BARON</span> and the individual-level baseline in Fig. <a href="#S4.F5" title="Fig. 5 ‣ 4.2 Ablation Study ‣ 4 Experiments ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.
The images are from COCO’s validation set. We visualize the feature map’s response to the novel categories using the Grad-CAM++ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>.
We find that the model learned through <span id="S4.SS3.p3.1.3" class="ltx_text">BARON</span> generates responses at locations of novel categories while the individual-level baseline induces weaker, incomplete or diffused responses.
We also notice that semantically related objects can respond to the queried object category.
For example, in Fig <a href="#S4.F5" title="Fig. 5 ‣ 4.2 Ablation Study ‣ 4 Experiments ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>(c) the location of a flock of sheep chased by a dog responds to the queried object ‘dog’. Note the ‘dog’ and the ‘flock of sheep’ are not in neighboring regions and the ‘dog’ is much smaller in size. Even though we form bags of regions by neighboring regions of equal size in training, the model has the ability to capture the relationship between objects with imbalanced sizes or large distance. This phenomenon resembles the generalization ability of human language, where learned concepts can be applied to describe or recognize new things.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Discussion and Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">This paper goes beyond the learning of individual regions to bag of regions in OVD, exploring the ability of large-scale VLMs to represent the compositional structure of multiple concepts that naturally exists in image-text pairs.
We develop a neighborhood sampling strategy to group contextually related regions into a bag and adopt the contrastive learning approach to align the bag-of-regions representations of the detector and pre-trained VLMs, which achieves new state-of-the-art performance on multiple OVD benchmarks.</p>
</div>
<div id="S5.p2" class="ltx_para">
<p id="S5.p2.1" class="ltx_p">The compositional structure explored in this paper is mainly about the co-occurrence of objects, and behaves like bag of words <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib54" title="" class="ltx_ref">54</a>, <a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite>.
The more complex compositional structure in the language is still under-explored and whether modern pre-trained vision-language models capture such structure still remains an open problem for the community.
We look forward to further unveiling the behavior of the VLMs, and more importantly endowing the VLMs with human-like compositional representation to move to more generalized intelligence.</p>
</div>
<div id="S5.p3" class="ltx_para">
<p id="S5.p3.1" class="ltx_p"><span id="S5.p3.1.1" class="ltx_text ltx_font_bold">Acknowledgement.</span>
This study is supported under the RIE2020 Industry Alignment Fund Industry Collaboration Projects (IAF-ICP) Funding Initiative, as well as cash and in-kind contribution from the industry partner(s). The work is also suported by Singapore MOE AcRF Tier 2 (MOE-T2EP20120-0001) and NTU NAP Grant. We also thank Lumin Xu and Yuanhan Zhang for valuable discussions.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A1 </span>Implementation Details</h2>

<div id="A1.p1" class="ltx_para">
<p id="A1.p1.1" class="ltx_p">We provide more details of the implementation of BARON on OV-COCO <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> and OV-LVIS <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> benchmarks.</p>
</div>
<div id="A1.p2" class="ltx_para ltx_noindent">
<p id="A1.p2.6" class="ltx_p"><span id="A1.p2.6.1" class="ltx_text ltx_font_bold">Sampling.</span> For neighborhood sampling strategy, we obtain top <math id="A1.p2.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="A1.p2.1.m1.1a"><mi id="A1.p2.1.m1.1.1" xref="A1.p2.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A1.p2.1.m1.1b"><ci id="A1.p2.1.m1.1.1.cmml" xref="A1.p2.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.1.m1.1c">K</annotation></semantics></math> region proposals from the RPN and filter out those with an objectness score lower than 0.85. We also discard regions with an aspect ratio smaller than 0.25 or larger than 4.0. And regions with an area ratio smaller than 0.01 are also discarded. Then we apply NMS on the region proposals with IOU threshold 0.1. The region proposals after NMS are used for neighborhood sampling. We sample <math id="A1.p2.2.m2.1" class="ltx_Math" alttext="G" display="inline"><semantics id="A1.p2.2.m2.1a"><mi id="A1.p2.2.m2.1.1" xref="A1.p2.2.m2.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="A1.p2.2.m2.1b"><ci id="A1.p2.2.m2.1.1.cmml" xref="A1.p2.2.m2.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.2.m2.1c">G</annotation></semantics></math> bags of regions for each region proposal with a probability 0.3 to sample each surrounding candidate box. For OV-COCO, we set <math id="A1.p2.3.m3.1" class="ltx_Math" alttext="K=300" display="inline"><semantics id="A1.p2.3.m3.1a"><mrow id="A1.p2.3.m3.1.1" xref="A1.p2.3.m3.1.1.cmml"><mi id="A1.p2.3.m3.1.1.2" xref="A1.p2.3.m3.1.1.2.cmml">K</mi><mo id="A1.p2.3.m3.1.1.1" xref="A1.p2.3.m3.1.1.1.cmml">=</mo><mn id="A1.p2.3.m3.1.1.3" xref="A1.p2.3.m3.1.1.3.cmml">300</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p2.3.m3.1b"><apply id="A1.p2.3.m3.1.1.cmml" xref="A1.p2.3.m3.1.1"><eq id="A1.p2.3.m3.1.1.1.cmml" xref="A1.p2.3.m3.1.1.1"></eq><ci id="A1.p2.3.m3.1.1.2.cmml" xref="A1.p2.3.m3.1.1.2">𝐾</ci><cn type="integer" id="A1.p2.3.m3.1.1.3.cmml" xref="A1.p2.3.m3.1.1.3">300</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.3.m3.1c">K=300</annotation></semantics></math> and <math id="A1.p2.4.m4.1" class="ltx_Math" alttext="G=3" display="inline"><semantics id="A1.p2.4.m4.1a"><mrow id="A1.p2.4.m4.1.1" xref="A1.p2.4.m4.1.1.cmml"><mi id="A1.p2.4.m4.1.1.2" xref="A1.p2.4.m4.1.1.2.cmml">G</mi><mo id="A1.p2.4.m4.1.1.1" xref="A1.p2.4.m4.1.1.1.cmml">=</mo><mn id="A1.p2.4.m4.1.1.3" xref="A1.p2.4.m4.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p2.4.m4.1b"><apply id="A1.p2.4.m4.1.1.cmml" xref="A1.p2.4.m4.1.1"><eq id="A1.p2.4.m4.1.1.1.cmml" xref="A1.p2.4.m4.1.1.1"></eq><ci id="A1.p2.4.m4.1.1.2.cmml" xref="A1.p2.4.m4.1.1.2">𝐺</ci><cn type="integer" id="A1.p2.4.m4.1.1.3.cmml" xref="A1.p2.4.m4.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.4.m4.1c">G=3</annotation></semantics></math>. For OV-LVIS, we set <math id="A1.p2.5.m5.1" class="ltx_Math" alttext="K=500" display="inline"><semantics id="A1.p2.5.m5.1a"><mrow id="A1.p2.5.m5.1.1" xref="A1.p2.5.m5.1.1.cmml"><mi id="A1.p2.5.m5.1.1.2" xref="A1.p2.5.m5.1.1.2.cmml">K</mi><mo id="A1.p2.5.m5.1.1.1" xref="A1.p2.5.m5.1.1.1.cmml">=</mo><mn id="A1.p2.5.m5.1.1.3" xref="A1.p2.5.m5.1.1.3.cmml">500</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p2.5.m5.1b"><apply id="A1.p2.5.m5.1.1.cmml" xref="A1.p2.5.m5.1.1"><eq id="A1.p2.5.m5.1.1.1.cmml" xref="A1.p2.5.m5.1.1.1"></eq><ci id="A1.p2.5.m5.1.1.2.cmml" xref="A1.p2.5.m5.1.1.2">𝐾</ci><cn type="integer" id="A1.p2.5.m5.1.1.3.cmml" xref="A1.p2.5.m5.1.1.3">500</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.5.m5.1c">K=500</annotation></semantics></math> and <math id="A1.p2.6.m6.1" class="ltx_Math" alttext="G=4" display="inline"><semantics id="A1.p2.6.m6.1a"><mrow id="A1.p2.6.m6.1.1" xref="A1.p2.6.m6.1.1.cmml"><mi id="A1.p2.6.m6.1.1.2" xref="A1.p2.6.m6.1.1.2.cmml">G</mi><mo id="A1.p2.6.m6.1.1.1" xref="A1.p2.6.m6.1.1.1.cmml">=</mo><mn id="A1.p2.6.m6.1.1.3" xref="A1.p2.6.m6.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p2.6.m6.1b"><apply id="A1.p2.6.m6.1.1.cmml" xref="A1.p2.6.m6.1.1"><eq id="A1.p2.6.m6.1.1.1.cmml" xref="A1.p2.6.m6.1.1.1"></eq><ci id="A1.p2.6.m6.1.1.2.cmml" xref="A1.p2.6.m6.1.1.2">𝐺</ci><cn type="integer" id="A1.p2.6.m6.1.1.3.cmml" xref="A1.p2.6.m6.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.6.m6.1c">G=4</annotation></semantics></math> due to the denser spatial distribution of object boxes in the LVIS dataset.</p>
</div>
<div id="A1.p3" class="ltx_para ltx_noindent">
<p id="A1.p3.6" class="ltx_p"><span id="A1.p3.6.1" class="ltx_text ltx_font_bold">Classification Loss.</span>We use CE loss as the classification loss <math id="A1.p3.1.m1.1" class="ltx_Math" alttext="\mathcal{L_{\mathrm{cls}}}" display="inline"><semantics id="A1.p3.1.m1.1a"><msub id="A1.p3.1.m1.1.1" xref="A1.p3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.p3.1.m1.1.1.2" xref="A1.p3.1.m1.1.1.2.cmml">ℒ</mi><mi id="A1.p3.1.m1.1.1.3" xref="A1.p3.1.m1.1.1.3.cmml">cls</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p3.1.m1.1b"><apply id="A1.p3.1.m1.1.1.cmml" xref="A1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="A1.p3.1.m1.1.1.1.cmml" xref="A1.p3.1.m1.1.1">subscript</csymbol><ci id="A1.p3.1.m1.1.1.2.cmml" xref="A1.p3.1.m1.1.1.2">ℒ</ci><ci id="A1.p3.1.m1.1.1.3.cmml" xref="A1.p3.1.m1.1.1.3">cls</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.1.m1.1c">\mathcal{L_{\mathrm{cls}}}</annotation></semantics></math> on base categories. Given <math id="A1.p3.2.m2.1" class="ltx_Math" alttext="C" display="inline"><semantics id="A1.p3.2.m2.1a"><mi id="A1.p3.2.m2.1.1" xref="A1.p3.2.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="A1.p3.2.m2.1b"><ci id="A1.p3.2.m2.1.1.cmml" xref="A1.p3.2.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.2.m2.1c">C</annotation></semantics></math> object categories, we obtain the embedding <math id="A1.p3.3.m3.1" class="ltx_Math" alttext="f_{i}" display="inline"><semantics id="A1.p3.3.m3.1a"><msub id="A1.p3.3.m3.1.1" xref="A1.p3.3.m3.1.1.cmml"><mi id="A1.p3.3.m3.1.1.2" xref="A1.p3.3.m3.1.1.2.cmml">f</mi><mi id="A1.p3.3.m3.1.1.3" xref="A1.p3.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p3.3.m3.1b"><apply id="A1.p3.3.m3.1.1.cmml" xref="A1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="A1.p3.3.m3.1.1.1.cmml" xref="A1.p3.3.m3.1.1">subscript</csymbol><ci id="A1.p3.3.m3.1.1.2.cmml" xref="A1.p3.3.m3.1.1.2">𝑓</ci><ci id="A1.p3.3.m3.1.1.3.cmml" xref="A1.p3.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.3.m3.1c">f_{i}</annotation></semantics></math> for the name of the <math id="A1.p3.4.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="A1.p3.4.m4.1a"><mi id="A1.p3.4.m4.1.1" xref="A1.p3.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A1.p3.4.m4.1b"><ci id="A1.p3.4.m4.1.1.cmml" xref="A1.p3.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.4.m4.1c">i</annotation></semantics></math>-th category by the text encoder (<math id="A1.p3.5.m5.1" class="ltx_Math" alttext="\mathcal{T}" display="inline"><semantics id="A1.p3.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="A1.p3.5.m5.1.1" xref="A1.p3.5.m5.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="A1.p3.5.m5.1b"><ci id="A1.p3.5.m5.1.1.cmml" xref="A1.p3.5.m5.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.5.m5.1c">\mathcal{T}</annotation></semantics></math>) of the VLM. We also learn a background embedding for non-object regions. If a region is labeled as the <math id="A1.p3.6.m6.1" class="ltx_Math" alttext="c" display="inline"><semantics id="A1.p3.6.m6.1a"><mi id="A1.p3.6.m6.1.1" xref="A1.p3.6.m6.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="A1.p3.6.m6.1b"><ci id="A1.p3.6.m6.1.1.cmml" xref="A1.p3.6.m6.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.6.m6.1c">c</annotation></semantics></math>-th category, the classification loss is</p>
</div>
<div id="A1.p4" class="ltx_para">
<table id="A1.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.E5.m1.7" class="ltx_Math" alttext="\mathcal{L_{\mathrm{cls}}}=-\log\frac{\exp(\tau_{\mathrm{cls}}\cdot\langle\mathcal{T}(w),f_{c}\rangle)}{\sum_{i=0}^{C}\exp(\tau_{\mathrm{cls}}\cdot\langle\mathcal{T}(w),f_{i}\rangle)}," display="block"><semantics id="A1.E5.m1.7a"><mrow id="A1.E5.m1.7.7.1" xref="A1.E5.m1.7.7.1.1.cmml"><mrow id="A1.E5.m1.7.7.1.1" xref="A1.E5.m1.7.7.1.1.cmml"><msub id="A1.E5.m1.7.7.1.1.2" xref="A1.E5.m1.7.7.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E5.m1.7.7.1.1.2.2" xref="A1.E5.m1.7.7.1.1.2.2.cmml">ℒ</mi><mi id="A1.E5.m1.7.7.1.1.2.3" xref="A1.E5.m1.7.7.1.1.2.3.cmml">cls</mi></msub><mo id="A1.E5.m1.7.7.1.1.1" xref="A1.E5.m1.7.7.1.1.1.cmml">=</mo><mrow id="A1.E5.m1.7.7.1.1.3" xref="A1.E5.m1.7.7.1.1.3.cmml"><mo rspace="0.167em" id="A1.E5.m1.7.7.1.1.3a" xref="A1.E5.m1.7.7.1.1.3.cmml">−</mo><mrow id="A1.E5.m1.7.7.1.1.3.2" xref="A1.E5.m1.7.7.1.1.3.2.cmml"><mi id="A1.E5.m1.7.7.1.1.3.2.1" xref="A1.E5.m1.7.7.1.1.3.2.1.cmml">log</mi><mo lspace="0.167em" id="A1.E5.m1.7.7.1.1.3.2a" xref="A1.E5.m1.7.7.1.1.3.2.cmml">⁡</mo><mfrac id="A1.E5.m1.6.6" xref="A1.E5.m1.6.6.cmml"><mrow id="A1.E5.m1.3.3.3.3" xref="A1.E5.m1.3.3.3.4.cmml"><mi id="A1.E5.m1.2.2.2.2" xref="A1.E5.m1.2.2.2.2.cmml">exp</mi><mo id="A1.E5.m1.3.3.3.3a" xref="A1.E5.m1.3.3.3.4.cmml">⁡</mo><mrow id="A1.E5.m1.3.3.3.3.1" xref="A1.E5.m1.3.3.3.4.cmml"><mo stretchy="false" id="A1.E5.m1.3.3.3.3.1.2" xref="A1.E5.m1.3.3.3.4.cmml">(</mo><mrow id="A1.E5.m1.3.3.3.3.1.1" xref="A1.E5.m1.3.3.3.3.1.1.cmml"><msub id="A1.E5.m1.3.3.3.3.1.1.4" xref="A1.E5.m1.3.3.3.3.1.1.4.cmml"><mi id="A1.E5.m1.3.3.3.3.1.1.4.2" xref="A1.E5.m1.3.3.3.3.1.1.4.2.cmml">τ</mi><mi id="A1.E5.m1.3.3.3.3.1.1.4.3" xref="A1.E5.m1.3.3.3.3.1.1.4.3.cmml">cls</mi></msub><mo lspace="0.222em" rspace="0.222em" id="A1.E5.m1.3.3.3.3.1.1.3" xref="A1.E5.m1.3.3.3.3.1.1.3.cmml">⋅</mo><mrow id="A1.E5.m1.3.3.3.3.1.1.2.2" xref="A1.E5.m1.3.3.3.3.1.1.2.3.cmml"><mo stretchy="false" id="A1.E5.m1.3.3.3.3.1.1.2.2.3" xref="A1.E5.m1.3.3.3.3.1.1.2.3.cmml">⟨</mo><mrow id="A1.E5.m1.3.3.3.3.1.1.1.1.1" xref="A1.E5.m1.3.3.3.3.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E5.m1.3.3.3.3.1.1.1.1.1.2" xref="A1.E5.m1.3.3.3.3.1.1.1.1.1.2.cmml">𝒯</mi><mo lspace="0em" rspace="0em" id="A1.E5.m1.3.3.3.3.1.1.1.1.1.1" xref="A1.E5.m1.3.3.3.3.1.1.1.1.1.1.cmml">​</mo><mrow id="A1.E5.m1.3.3.3.3.1.1.1.1.1.3.2" xref="A1.E5.m1.3.3.3.3.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.E5.m1.3.3.3.3.1.1.1.1.1.3.2.1" xref="A1.E5.m1.3.3.3.3.1.1.1.1.1.cmml">(</mo><mi id="A1.E5.m1.1.1.1.1" xref="A1.E5.m1.1.1.1.1.cmml">w</mi><mo stretchy="false" id="A1.E5.m1.3.3.3.3.1.1.1.1.1.3.2.2" xref="A1.E5.m1.3.3.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E5.m1.3.3.3.3.1.1.2.2.4" xref="A1.E5.m1.3.3.3.3.1.1.2.3.cmml">,</mo><msub id="A1.E5.m1.3.3.3.3.1.1.2.2.2" xref="A1.E5.m1.3.3.3.3.1.1.2.2.2.cmml"><mi id="A1.E5.m1.3.3.3.3.1.1.2.2.2.2" xref="A1.E5.m1.3.3.3.3.1.1.2.2.2.2.cmml">f</mi><mi id="A1.E5.m1.3.3.3.3.1.1.2.2.2.3" xref="A1.E5.m1.3.3.3.3.1.1.2.2.2.3.cmml">c</mi></msub><mo stretchy="false" id="A1.E5.m1.3.3.3.3.1.1.2.2.5" xref="A1.E5.m1.3.3.3.3.1.1.2.3.cmml">⟩</mo></mrow></mrow><mo stretchy="false" id="A1.E5.m1.3.3.3.3.1.3" xref="A1.E5.m1.3.3.3.4.cmml">)</mo></mrow></mrow><mrow id="A1.E5.m1.6.6.6" xref="A1.E5.m1.6.6.6.cmml"><msubsup id="A1.E5.m1.6.6.6.4" xref="A1.E5.m1.6.6.6.4.cmml"><mo id="A1.E5.m1.6.6.6.4.2.2" xref="A1.E5.m1.6.6.6.4.2.2.cmml">∑</mo><mrow id="A1.E5.m1.6.6.6.4.2.3" xref="A1.E5.m1.6.6.6.4.2.3.cmml"><mi id="A1.E5.m1.6.6.6.4.2.3.2" xref="A1.E5.m1.6.6.6.4.2.3.2.cmml">i</mi><mo id="A1.E5.m1.6.6.6.4.2.3.1" xref="A1.E5.m1.6.6.6.4.2.3.1.cmml">=</mo><mn id="A1.E5.m1.6.6.6.4.2.3.3" xref="A1.E5.m1.6.6.6.4.2.3.3.cmml">0</mn></mrow><mi id="A1.E5.m1.6.6.6.4.3" xref="A1.E5.m1.6.6.6.4.3.cmml">C</mi></msubsup><mrow id="A1.E5.m1.6.6.6.3.1" xref="A1.E5.m1.6.6.6.3.2.cmml"><mi id="A1.E5.m1.5.5.5.2" xref="A1.E5.m1.5.5.5.2.cmml">exp</mi><mo id="A1.E5.m1.6.6.6.3.1a" xref="A1.E5.m1.6.6.6.3.2.cmml">⁡</mo><mrow id="A1.E5.m1.6.6.6.3.1.1" xref="A1.E5.m1.6.6.6.3.2.cmml"><mo stretchy="false" id="A1.E5.m1.6.6.6.3.1.1.2" xref="A1.E5.m1.6.6.6.3.2.cmml">(</mo><mrow id="A1.E5.m1.6.6.6.3.1.1.1" xref="A1.E5.m1.6.6.6.3.1.1.1.cmml"><msub id="A1.E5.m1.6.6.6.3.1.1.1.4" xref="A1.E5.m1.6.6.6.3.1.1.1.4.cmml"><mi id="A1.E5.m1.6.6.6.3.1.1.1.4.2" xref="A1.E5.m1.6.6.6.3.1.1.1.4.2.cmml">τ</mi><mi id="A1.E5.m1.6.6.6.3.1.1.1.4.3" xref="A1.E5.m1.6.6.6.3.1.1.1.4.3.cmml">cls</mi></msub><mo lspace="0.222em" rspace="0.222em" id="A1.E5.m1.6.6.6.3.1.1.1.3" xref="A1.E5.m1.6.6.6.3.1.1.1.3.cmml">⋅</mo><mrow id="A1.E5.m1.6.6.6.3.1.1.1.2.2" xref="A1.E5.m1.6.6.6.3.1.1.1.2.3.cmml"><mo stretchy="false" id="A1.E5.m1.6.6.6.3.1.1.1.2.2.3" xref="A1.E5.m1.6.6.6.3.1.1.1.2.3.cmml">⟨</mo><mrow id="A1.E5.m1.6.6.6.3.1.1.1.1.1.1" xref="A1.E5.m1.6.6.6.3.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E5.m1.6.6.6.3.1.1.1.1.1.1.2" xref="A1.E5.m1.6.6.6.3.1.1.1.1.1.1.2.cmml">𝒯</mi><mo lspace="0em" rspace="0em" id="A1.E5.m1.6.6.6.3.1.1.1.1.1.1.1" xref="A1.E5.m1.6.6.6.3.1.1.1.1.1.1.1.cmml">​</mo><mrow id="A1.E5.m1.6.6.6.3.1.1.1.1.1.1.3.2" xref="A1.E5.m1.6.6.6.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.E5.m1.6.6.6.3.1.1.1.1.1.1.3.2.1" xref="A1.E5.m1.6.6.6.3.1.1.1.1.1.1.cmml">(</mo><mi id="A1.E5.m1.4.4.4.1" xref="A1.E5.m1.4.4.4.1.cmml">w</mi><mo stretchy="false" id="A1.E5.m1.6.6.6.3.1.1.1.1.1.1.3.2.2" xref="A1.E5.m1.6.6.6.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E5.m1.6.6.6.3.1.1.1.2.2.4" xref="A1.E5.m1.6.6.6.3.1.1.1.2.3.cmml">,</mo><msub id="A1.E5.m1.6.6.6.3.1.1.1.2.2.2" xref="A1.E5.m1.6.6.6.3.1.1.1.2.2.2.cmml"><mi id="A1.E5.m1.6.6.6.3.1.1.1.2.2.2.2" xref="A1.E5.m1.6.6.6.3.1.1.1.2.2.2.2.cmml">f</mi><mi id="A1.E5.m1.6.6.6.3.1.1.1.2.2.2.3" xref="A1.E5.m1.6.6.6.3.1.1.1.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="A1.E5.m1.6.6.6.3.1.1.1.2.2.5" xref="A1.E5.m1.6.6.6.3.1.1.1.2.3.cmml">⟩</mo></mrow></mrow><mo stretchy="false" id="A1.E5.m1.6.6.6.3.1.1.3" xref="A1.E5.m1.6.6.6.3.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow></mrow></mrow><mo id="A1.E5.m1.7.7.1.2" xref="A1.E5.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E5.m1.7b"><apply id="A1.E5.m1.7.7.1.1.cmml" xref="A1.E5.m1.7.7.1"><eq id="A1.E5.m1.7.7.1.1.1.cmml" xref="A1.E5.m1.7.7.1.1.1"></eq><apply id="A1.E5.m1.7.7.1.1.2.cmml" xref="A1.E5.m1.7.7.1.1.2"><csymbol cd="ambiguous" id="A1.E5.m1.7.7.1.1.2.1.cmml" xref="A1.E5.m1.7.7.1.1.2">subscript</csymbol><ci id="A1.E5.m1.7.7.1.1.2.2.cmml" xref="A1.E5.m1.7.7.1.1.2.2">ℒ</ci><ci id="A1.E5.m1.7.7.1.1.2.3.cmml" xref="A1.E5.m1.7.7.1.1.2.3">cls</ci></apply><apply id="A1.E5.m1.7.7.1.1.3.cmml" xref="A1.E5.m1.7.7.1.1.3"><minus id="A1.E5.m1.7.7.1.1.3.1.cmml" xref="A1.E5.m1.7.7.1.1.3"></minus><apply id="A1.E5.m1.7.7.1.1.3.2.cmml" xref="A1.E5.m1.7.7.1.1.3.2"><log id="A1.E5.m1.7.7.1.1.3.2.1.cmml" xref="A1.E5.m1.7.7.1.1.3.2.1"></log><apply id="A1.E5.m1.6.6.cmml" xref="A1.E5.m1.6.6"><divide id="A1.E5.m1.6.6.7.cmml" xref="A1.E5.m1.6.6"></divide><apply id="A1.E5.m1.3.3.3.4.cmml" xref="A1.E5.m1.3.3.3.3"><exp id="A1.E5.m1.2.2.2.2.cmml" xref="A1.E5.m1.2.2.2.2"></exp><apply id="A1.E5.m1.3.3.3.3.1.1.cmml" xref="A1.E5.m1.3.3.3.3.1.1"><ci id="A1.E5.m1.3.3.3.3.1.1.3.cmml" xref="A1.E5.m1.3.3.3.3.1.1.3">⋅</ci><apply id="A1.E5.m1.3.3.3.3.1.1.4.cmml" xref="A1.E5.m1.3.3.3.3.1.1.4"><csymbol cd="ambiguous" id="A1.E5.m1.3.3.3.3.1.1.4.1.cmml" xref="A1.E5.m1.3.3.3.3.1.1.4">subscript</csymbol><ci id="A1.E5.m1.3.3.3.3.1.1.4.2.cmml" xref="A1.E5.m1.3.3.3.3.1.1.4.2">𝜏</ci><ci id="A1.E5.m1.3.3.3.3.1.1.4.3.cmml" xref="A1.E5.m1.3.3.3.3.1.1.4.3">cls</ci></apply><list id="A1.E5.m1.3.3.3.3.1.1.2.3.cmml" xref="A1.E5.m1.3.3.3.3.1.1.2.2"><apply id="A1.E5.m1.3.3.3.3.1.1.1.1.1.cmml" xref="A1.E5.m1.3.3.3.3.1.1.1.1.1"><times id="A1.E5.m1.3.3.3.3.1.1.1.1.1.1.cmml" xref="A1.E5.m1.3.3.3.3.1.1.1.1.1.1"></times><ci id="A1.E5.m1.3.3.3.3.1.1.1.1.1.2.cmml" xref="A1.E5.m1.3.3.3.3.1.1.1.1.1.2">𝒯</ci><ci id="A1.E5.m1.1.1.1.1.cmml" xref="A1.E5.m1.1.1.1.1">𝑤</ci></apply><apply id="A1.E5.m1.3.3.3.3.1.1.2.2.2.cmml" xref="A1.E5.m1.3.3.3.3.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.E5.m1.3.3.3.3.1.1.2.2.2.1.cmml" xref="A1.E5.m1.3.3.3.3.1.1.2.2.2">subscript</csymbol><ci id="A1.E5.m1.3.3.3.3.1.1.2.2.2.2.cmml" xref="A1.E5.m1.3.3.3.3.1.1.2.2.2.2">𝑓</ci><ci id="A1.E5.m1.3.3.3.3.1.1.2.2.2.3.cmml" xref="A1.E5.m1.3.3.3.3.1.1.2.2.2.3">𝑐</ci></apply></list></apply></apply><apply id="A1.E5.m1.6.6.6.cmml" xref="A1.E5.m1.6.6.6"><apply id="A1.E5.m1.6.6.6.4.cmml" xref="A1.E5.m1.6.6.6.4"><csymbol cd="ambiguous" id="A1.E5.m1.6.6.6.4.1.cmml" xref="A1.E5.m1.6.6.6.4">superscript</csymbol><apply id="A1.E5.m1.6.6.6.4.2.cmml" xref="A1.E5.m1.6.6.6.4"><csymbol cd="ambiguous" id="A1.E5.m1.6.6.6.4.2.1.cmml" xref="A1.E5.m1.6.6.6.4">subscript</csymbol><sum id="A1.E5.m1.6.6.6.4.2.2.cmml" xref="A1.E5.m1.6.6.6.4.2.2"></sum><apply id="A1.E5.m1.6.6.6.4.2.3.cmml" xref="A1.E5.m1.6.6.6.4.2.3"><eq id="A1.E5.m1.6.6.6.4.2.3.1.cmml" xref="A1.E5.m1.6.6.6.4.2.3.1"></eq><ci id="A1.E5.m1.6.6.6.4.2.3.2.cmml" xref="A1.E5.m1.6.6.6.4.2.3.2">𝑖</ci><cn type="integer" id="A1.E5.m1.6.6.6.4.2.3.3.cmml" xref="A1.E5.m1.6.6.6.4.2.3.3">0</cn></apply></apply><ci id="A1.E5.m1.6.6.6.4.3.cmml" xref="A1.E5.m1.6.6.6.4.3">𝐶</ci></apply><apply id="A1.E5.m1.6.6.6.3.2.cmml" xref="A1.E5.m1.6.6.6.3.1"><exp id="A1.E5.m1.5.5.5.2.cmml" xref="A1.E5.m1.5.5.5.2"></exp><apply id="A1.E5.m1.6.6.6.3.1.1.1.cmml" xref="A1.E5.m1.6.6.6.3.1.1.1"><ci id="A1.E5.m1.6.6.6.3.1.1.1.3.cmml" xref="A1.E5.m1.6.6.6.3.1.1.1.3">⋅</ci><apply id="A1.E5.m1.6.6.6.3.1.1.1.4.cmml" xref="A1.E5.m1.6.6.6.3.1.1.1.4"><csymbol cd="ambiguous" id="A1.E5.m1.6.6.6.3.1.1.1.4.1.cmml" xref="A1.E5.m1.6.6.6.3.1.1.1.4">subscript</csymbol><ci id="A1.E5.m1.6.6.6.3.1.1.1.4.2.cmml" xref="A1.E5.m1.6.6.6.3.1.1.1.4.2">𝜏</ci><ci id="A1.E5.m1.6.6.6.3.1.1.1.4.3.cmml" xref="A1.E5.m1.6.6.6.3.1.1.1.4.3">cls</ci></apply><list id="A1.E5.m1.6.6.6.3.1.1.1.2.3.cmml" xref="A1.E5.m1.6.6.6.3.1.1.1.2.2"><apply id="A1.E5.m1.6.6.6.3.1.1.1.1.1.1.cmml" xref="A1.E5.m1.6.6.6.3.1.1.1.1.1.1"><times id="A1.E5.m1.6.6.6.3.1.1.1.1.1.1.1.cmml" xref="A1.E5.m1.6.6.6.3.1.1.1.1.1.1.1"></times><ci id="A1.E5.m1.6.6.6.3.1.1.1.1.1.1.2.cmml" xref="A1.E5.m1.6.6.6.3.1.1.1.1.1.1.2">𝒯</ci><ci id="A1.E5.m1.4.4.4.1.cmml" xref="A1.E5.m1.4.4.4.1">𝑤</ci></apply><apply id="A1.E5.m1.6.6.6.3.1.1.1.2.2.2.cmml" xref="A1.E5.m1.6.6.6.3.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.E5.m1.6.6.6.3.1.1.1.2.2.2.1.cmml" xref="A1.E5.m1.6.6.6.3.1.1.1.2.2.2">subscript</csymbol><ci id="A1.E5.m1.6.6.6.3.1.1.1.2.2.2.2.cmml" xref="A1.E5.m1.6.6.6.3.1.1.1.2.2.2.2">𝑓</ci><ci id="A1.E5.m1.6.6.6.3.1.1.1.2.2.2.3.cmml" xref="A1.E5.m1.6.6.6.3.1.1.1.2.2.2.3">𝑖</ci></apply></list></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E5.m1.7c">\mathcal{L_{\mathrm{cls}}}=-\log\frac{\exp(\tau_{\mathrm{cls}}\cdot\langle\mathcal{T}(w),f_{c}\rangle)}{\sum_{i=0}^{C}\exp(\tau_{\mathrm{cls}}\cdot\langle\mathcal{T}(w),f_{i}\rangle)},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div id="A1.p5" class="ltx_para ltx_noindent">
<p id="A1.p5.5" class="ltx_p">where <math id="A1.p5.1.m1.1" class="ltx_Math" alttext="\tau_{\mathrm{cls}}" display="inline"><semantics id="A1.p5.1.m1.1a"><msub id="A1.p5.1.m1.1.1" xref="A1.p5.1.m1.1.1.cmml"><mi id="A1.p5.1.m1.1.1.2" xref="A1.p5.1.m1.1.1.2.cmml">τ</mi><mi id="A1.p5.1.m1.1.1.3" xref="A1.p5.1.m1.1.1.3.cmml">cls</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p5.1.m1.1b"><apply id="A1.p5.1.m1.1.1.cmml" xref="A1.p5.1.m1.1.1"><csymbol cd="ambiguous" id="A1.p5.1.m1.1.1.1.cmml" xref="A1.p5.1.m1.1.1">subscript</csymbol><ci id="A1.p5.1.m1.1.1.2.cmml" xref="A1.p5.1.m1.1.1.2">𝜏</ci><ci id="A1.p5.1.m1.1.1.3.cmml" xref="A1.p5.1.m1.1.1.3">cls</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p5.1.m1.1c">\tau_{\mathrm{cls}}</annotation></semantics></math> is the temperature to re-scale the cosine similarity, <math id="A1.p5.2.m2.1" class="ltx_Math" alttext="f_{C}" display="inline"><semantics id="A1.p5.2.m2.1a"><msub id="A1.p5.2.m2.1.1" xref="A1.p5.2.m2.1.1.cmml"><mi id="A1.p5.2.m2.1.1.2" xref="A1.p5.2.m2.1.1.2.cmml">f</mi><mi id="A1.p5.2.m2.1.1.3" xref="A1.p5.2.m2.1.1.3.cmml">C</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p5.2.m2.1b"><apply id="A1.p5.2.m2.1.1.cmml" xref="A1.p5.2.m2.1.1"><csymbol cd="ambiguous" id="A1.p5.2.m2.1.1.1.cmml" xref="A1.p5.2.m2.1.1">subscript</csymbol><ci id="A1.p5.2.m2.1.1.2.cmml" xref="A1.p5.2.m2.1.1.2">𝑓</ci><ci id="A1.p5.2.m2.1.1.3.cmml" xref="A1.p5.2.m2.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p5.2.m2.1c">f_{C}</annotation></semantics></math> is the background embedding and <math id="A1.p5.3.m3.1" class="ltx_Math" alttext="w" display="inline"><semantics id="A1.p5.3.m3.1a"><mi id="A1.p5.3.m3.1.1" xref="A1.p5.3.m3.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="A1.p5.3.m3.1b"><ci id="A1.p5.3.m3.1.1.cmml" xref="A1.p5.3.m3.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p5.3.m3.1c">w</annotation></semantics></math> is the embedding (pseudo words) of the region. On OV-COCO, we set <math id="A1.p5.4.m4.1" class="ltx_Math" alttext="\tau_{\mathrm{cls}}=50.0" display="inline"><semantics id="A1.p5.4.m4.1a"><mrow id="A1.p5.4.m4.1.1" xref="A1.p5.4.m4.1.1.cmml"><msub id="A1.p5.4.m4.1.1.2" xref="A1.p5.4.m4.1.1.2.cmml"><mi id="A1.p5.4.m4.1.1.2.2" xref="A1.p5.4.m4.1.1.2.2.cmml">τ</mi><mi id="A1.p5.4.m4.1.1.2.3" xref="A1.p5.4.m4.1.1.2.3.cmml">cls</mi></msub><mo id="A1.p5.4.m4.1.1.1" xref="A1.p5.4.m4.1.1.1.cmml">=</mo><mn id="A1.p5.4.m4.1.1.3" xref="A1.p5.4.m4.1.1.3.cmml">50.0</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p5.4.m4.1b"><apply id="A1.p5.4.m4.1.1.cmml" xref="A1.p5.4.m4.1.1"><eq id="A1.p5.4.m4.1.1.1.cmml" xref="A1.p5.4.m4.1.1.1"></eq><apply id="A1.p5.4.m4.1.1.2.cmml" xref="A1.p5.4.m4.1.1.2"><csymbol cd="ambiguous" id="A1.p5.4.m4.1.1.2.1.cmml" xref="A1.p5.4.m4.1.1.2">subscript</csymbol><ci id="A1.p5.4.m4.1.1.2.2.cmml" xref="A1.p5.4.m4.1.1.2.2">𝜏</ci><ci id="A1.p5.4.m4.1.1.2.3.cmml" xref="A1.p5.4.m4.1.1.2.3">cls</ci></apply><cn type="float" id="A1.p5.4.m4.1.1.3.cmml" xref="A1.p5.4.m4.1.1.3">50.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p5.4.m4.1c">\tau_{\mathrm{cls}}=50.0</annotation></semantics></math>. And on OV-LVIS, we set <math id="A1.p5.5.m5.1" class="ltx_Math" alttext="\tau_{\mathrm{cls}}=100.0" display="inline"><semantics id="A1.p5.5.m5.1a"><mrow id="A1.p5.5.m5.1.1" xref="A1.p5.5.m5.1.1.cmml"><msub id="A1.p5.5.m5.1.1.2" xref="A1.p5.5.m5.1.1.2.cmml"><mi id="A1.p5.5.m5.1.1.2.2" xref="A1.p5.5.m5.1.1.2.2.cmml">τ</mi><mi id="A1.p5.5.m5.1.1.2.3" xref="A1.p5.5.m5.1.1.2.3.cmml">cls</mi></msub><mo id="A1.p5.5.m5.1.1.1" xref="A1.p5.5.m5.1.1.1.cmml">=</mo><mn id="A1.p5.5.m5.1.1.3" xref="A1.p5.5.m5.1.1.3.cmml">100.0</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p5.5.m5.1b"><apply id="A1.p5.5.m5.1.1.cmml" xref="A1.p5.5.m5.1.1"><eq id="A1.p5.5.m5.1.1.1.cmml" xref="A1.p5.5.m5.1.1.1"></eq><apply id="A1.p5.5.m5.1.1.2.cmml" xref="A1.p5.5.m5.1.1.2"><csymbol cd="ambiguous" id="A1.p5.5.m5.1.1.2.1.cmml" xref="A1.p5.5.m5.1.1.2">subscript</csymbol><ci id="A1.p5.5.m5.1.1.2.2.cmml" xref="A1.p5.5.m5.1.1.2.2">𝜏</ci><ci id="A1.p5.5.m5.1.1.2.3.cmml" xref="A1.p5.5.m5.1.1.2.3">cls</ci></apply><cn type="float" id="A1.p5.5.m5.1.1.3.cmml" xref="A1.p5.5.m5.1.1.3">100.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p5.5.m5.1c">\tau_{\mathrm{cls}}=100.0</annotation></semantics></math> since there are orders of magnitude more categories defined in the LVIS dataset.</p>
</div>
<div id="A1.p6" class="ltx_para ltx_noindent">
<p id="A1.p6.5" class="ltx_p"><span id="A1.p6.5.1" class="ltx_text ltx_font_bold">Alignment Loss.</span>
Assuming there are <math id="A1.p6.1.m1.1" class="ltx_Math" alttext="G" display="inline"><semantics id="A1.p6.1.m1.1a"><mi id="A1.p6.1.m1.1.1" xref="A1.p6.1.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="A1.p6.1.m1.1b"><ci id="A1.p6.1.m1.1.1.cmml" xref="A1.p6.1.m1.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p6.1.m1.1c">G</annotation></semantics></math> bags of regions and the image (teacher) and text (student) embeddings for the <math id="A1.p6.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="A1.p6.2.m2.1a"><mi id="A1.p6.2.m2.1.1" xref="A1.p6.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A1.p6.2.m2.1b"><ci id="A1.p6.2.m2.1.1.cmml" xref="A1.p6.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p6.2.m2.1c">k</annotation></semantics></math>-th bag of regions are <math id="A1.p6.3.m3.1" class="ltx_Math" alttext="f_{v}^{k}" display="inline"><semantics id="A1.p6.3.m3.1a"><msubsup id="A1.p6.3.m3.1.1" xref="A1.p6.3.m3.1.1.cmml"><mi id="A1.p6.3.m3.1.1.2.2" xref="A1.p6.3.m3.1.1.2.2.cmml">f</mi><mi id="A1.p6.3.m3.1.1.2.3" xref="A1.p6.3.m3.1.1.2.3.cmml">v</mi><mi id="A1.p6.3.m3.1.1.3" xref="A1.p6.3.m3.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.p6.3.m3.1b"><apply id="A1.p6.3.m3.1.1.cmml" xref="A1.p6.3.m3.1.1"><csymbol cd="ambiguous" id="A1.p6.3.m3.1.1.1.cmml" xref="A1.p6.3.m3.1.1">superscript</csymbol><apply id="A1.p6.3.m3.1.1.2.cmml" xref="A1.p6.3.m3.1.1"><csymbol cd="ambiguous" id="A1.p6.3.m3.1.1.2.1.cmml" xref="A1.p6.3.m3.1.1">subscript</csymbol><ci id="A1.p6.3.m3.1.1.2.2.cmml" xref="A1.p6.3.m3.1.1.2.2">𝑓</ci><ci id="A1.p6.3.m3.1.1.2.3.cmml" xref="A1.p6.3.m3.1.1.2.3">𝑣</ci></apply><ci id="A1.p6.3.m3.1.1.3.cmml" xref="A1.p6.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p6.3.m3.1c">f_{v}^{k}</annotation></semantics></math> and <math id="A1.p6.4.m4.1" class="ltx_Math" alttext="f_{t}^{k}" display="inline"><semantics id="A1.p6.4.m4.1a"><msubsup id="A1.p6.4.m4.1.1" xref="A1.p6.4.m4.1.1.cmml"><mi id="A1.p6.4.m4.1.1.2.2" xref="A1.p6.4.m4.1.1.2.2.cmml">f</mi><mi id="A1.p6.4.m4.1.1.2.3" xref="A1.p6.4.m4.1.1.2.3.cmml">t</mi><mi id="A1.p6.4.m4.1.1.3" xref="A1.p6.4.m4.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.p6.4.m4.1b"><apply id="A1.p6.4.m4.1.1.cmml" xref="A1.p6.4.m4.1.1"><csymbol cd="ambiguous" id="A1.p6.4.m4.1.1.1.cmml" xref="A1.p6.4.m4.1.1">superscript</csymbol><apply id="A1.p6.4.m4.1.1.2.cmml" xref="A1.p6.4.m4.1.1"><csymbol cd="ambiguous" id="A1.p6.4.m4.1.1.2.1.cmml" xref="A1.p6.4.m4.1.1">subscript</csymbol><ci id="A1.p6.4.m4.1.1.2.2.cmml" xref="A1.p6.4.m4.1.1.2.2">𝑓</ci><ci id="A1.p6.4.m4.1.1.2.3.cmml" xref="A1.p6.4.m4.1.1.2.3">𝑡</ci></apply><ci id="A1.p6.4.m4.1.1.3.cmml" xref="A1.p6.4.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p6.4.m4.1c">f_{t}^{k}</annotation></semantics></math>, the alignment loss <math id="A1.p6.5.m5.1" class="ltx_Math" alttext="\mathcal{L_{\mathrm{bag}}}" display="inline"><semantics id="A1.p6.5.m5.1a"><msub id="A1.p6.5.m5.1.1" xref="A1.p6.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.p6.5.m5.1.1.2" xref="A1.p6.5.m5.1.1.2.cmml">ℒ</mi><mi id="A1.p6.5.m5.1.1.3" xref="A1.p6.5.m5.1.1.3.cmml">bag</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p6.5.m5.1b"><apply id="A1.p6.5.m5.1.1.cmml" xref="A1.p6.5.m5.1.1"><csymbol cd="ambiguous" id="A1.p6.5.m5.1.1.1.cmml" xref="A1.p6.5.m5.1.1">subscript</csymbol><ci id="A1.p6.5.m5.1.1.2.cmml" xref="A1.p6.5.m5.1.1.2">ℒ</ci><ci id="A1.p6.5.m5.1.1.3.cmml" xref="A1.p6.5.m5.1.1.3">bag</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p6.5.m5.1c">\mathcal{L_{\mathrm{bag}}}</annotation></semantics></math> on bag of regions is calculated as</p>
</div>
<div id="A1.p7" class="ltx_para">
<table id="A1.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.E6.m1.7" class="ltx_Math" alttext="\mathcal{L}_{\mathrm{bag}}=-\frac{1}{2}\sum_{k=0}^{G-1}(\log(p_{t,v}^{k})+\log(p_{v,t}^{k}))." display="block"><semantics id="A1.E6.m1.7a"><mrow id="A1.E6.m1.7.7.1" xref="A1.E6.m1.7.7.1.1.cmml"><mrow id="A1.E6.m1.7.7.1.1" xref="A1.E6.m1.7.7.1.1.cmml"><msub id="A1.E6.m1.7.7.1.1.3" xref="A1.E6.m1.7.7.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E6.m1.7.7.1.1.3.2" xref="A1.E6.m1.7.7.1.1.3.2.cmml">ℒ</mi><mi id="A1.E6.m1.7.7.1.1.3.3" xref="A1.E6.m1.7.7.1.1.3.3.cmml">bag</mi></msub><mo id="A1.E6.m1.7.7.1.1.2" xref="A1.E6.m1.7.7.1.1.2.cmml">=</mo><mrow id="A1.E6.m1.7.7.1.1.1" xref="A1.E6.m1.7.7.1.1.1.cmml"><mo id="A1.E6.m1.7.7.1.1.1a" xref="A1.E6.m1.7.7.1.1.1.cmml">−</mo><mrow id="A1.E6.m1.7.7.1.1.1.1" xref="A1.E6.m1.7.7.1.1.1.1.cmml"><mfrac id="A1.E6.m1.7.7.1.1.1.1.3" xref="A1.E6.m1.7.7.1.1.1.1.3.cmml"><mn id="A1.E6.m1.7.7.1.1.1.1.3.2" xref="A1.E6.m1.7.7.1.1.1.1.3.2.cmml">1</mn><mn id="A1.E6.m1.7.7.1.1.1.1.3.3" xref="A1.E6.m1.7.7.1.1.1.1.3.3.cmml">2</mn></mfrac><mo lspace="0em" rspace="0em" id="A1.E6.m1.7.7.1.1.1.1.2" xref="A1.E6.m1.7.7.1.1.1.1.2.cmml">​</mo><mrow id="A1.E6.m1.7.7.1.1.1.1.1" xref="A1.E6.m1.7.7.1.1.1.1.1.cmml"><munderover id="A1.E6.m1.7.7.1.1.1.1.1.2" xref="A1.E6.m1.7.7.1.1.1.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="A1.E6.m1.7.7.1.1.1.1.1.2.2.2" xref="A1.E6.m1.7.7.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="A1.E6.m1.7.7.1.1.1.1.1.2.2.3" xref="A1.E6.m1.7.7.1.1.1.1.1.2.2.3.cmml"><mi id="A1.E6.m1.7.7.1.1.1.1.1.2.2.3.2" xref="A1.E6.m1.7.7.1.1.1.1.1.2.2.3.2.cmml">k</mi><mo id="A1.E6.m1.7.7.1.1.1.1.1.2.2.3.1" xref="A1.E6.m1.7.7.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="A1.E6.m1.7.7.1.1.1.1.1.2.2.3.3" xref="A1.E6.m1.7.7.1.1.1.1.1.2.2.3.3.cmml">0</mn></mrow><mrow id="A1.E6.m1.7.7.1.1.1.1.1.2.3" xref="A1.E6.m1.7.7.1.1.1.1.1.2.3.cmml"><mi id="A1.E6.m1.7.7.1.1.1.1.1.2.3.2" xref="A1.E6.m1.7.7.1.1.1.1.1.2.3.2.cmml">G</mi><mo id="A1.E6.m1.7.7.1.1.1.1.1.2.3.1" xref="A1.E6.m1.7.7.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="A1.E6.m1.7.7.1.1.1.1.1.2.3.3" xref="A1.E6.m1.7.7.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></munderover><mrow id="A1.E6.m1.7.7.1.1.1.1.1.1.1" xref="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.E6.m1.7.7.1.1.1.1.1.1.1.2" xref="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E6.m1.7.7.1.1.1.1.1.1.1.1" xref="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.cmml"><mrow id="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1" xref="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A1.E6.m1.5.5" xref="A1.E6.m1.5.5.cmml">log</mi><mo id="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1a" xref="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><msubsup id="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">p</mi><mrow id="A1.E6.m1.2.2.2.4" xref="A1.E6.m1.2.2.2.3.cmml"><mi id="A1.E6.m1.1.1.1.1" xref="A1.E6.m1.1.1.1.1.cmml">t</mi><mo id="A1.E6.m1.2.2.2.4.1" xref="A1.E6.m1.2.2.2.3.cmml">,</mo><mi id="A1.E6.m1.2.2.2.2" xref="A1.E6.m1.2.2.2.2.cmml">v</mi></mrow><mi id="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msubsup><mo stretchy="false" id="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.3" xref="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.3.cmml">+</mo><mrow id="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.2.1" xref="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="A1.E6.m1.6.6" xref="A1.E6.m1.6.6.cmml">log</mi><mo id="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.2.1a" xref="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.2.2.cmml">⁡</mo><mrow id="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.2.1.1" xref="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.2.2.cmml"><mo stretchy="false" id="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.2" xref="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.2.2.cmml">(</mo><msubsup id="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1" xref="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mi id="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1.2.2" xref="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1.2.2.cmml">p</mi><mrow id="A1.E6.m1.4.4.2.4" xref="A1.E6.m1.4.4.2.3.cmml"><mi id="A1.E6.m1.3.3.1.1" xref="A1.E6.m1.3.3.1.1.cmml">v</mi><mo id="A1.E6.m1.4.4.2.4.1" xref="A1.E6.m1.4.4.2.3.cmml">,</mo><mi id="A1.E6.m1.4.4.2.2" xref="A1.E6.m1.4.4.2.2.cmml">t</mi></mrow><mi id="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1.3" xref="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml">k</mi></msubsup><mo stretchy="false" id="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.3" xref="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.2.2.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="A1.E6.m1.7.7.1.1.1.1.1.1.1.3" xref="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="A1.E6.m1.7.7.1.2" xref="A1.E6.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E6.m1.7b"><apply id="A1.E6.m1.7.7.1.1.cmml" xref="A1.E6.m1.7.7.1"><eq id="A1.E6.m1.7.7.1.1.2.cmml" xref="A1.E6.m1.7.7.1.1.2"></eq><apply id="A1.E6.m1.7.7.1.1.3.cmml" xref="A1.E6.m1.7.7.1.1.3"><csymbol cd="ambiguous" id="A1.E6.m1.7.7.1.1.3.1.cmml" xref="A1.E6.m1.7.7.1.1.3">subscript</csymbol><ci id="A1.E6.m1.7.7.1.1.3.2.cmml" xref="A1.E6.m1.7.7.1.1.3.2">ℒ</ci><ci id="A1.E6.m1.7.7.1.1.3.3.cmml" xref="A1.E6.m1.7.7.1.1.3.3">bag</ci></apply><apply id="A1.E6.m1.7.7.1.1.1.cmml" xref="A1.E6.m1.7.7.1.1.1"><minus id="A1.E6.m1.7.7.1.1.1.2.cmml" xref="A1.E6.m1.7.7.1.1.1"></minus><apply id="A1.E6.m1.7.7.1.1.1.1.cmml" xref="A1.E6.m1.7.7.1.1.1.1"><times id="A1.E6.m1.7.7.1.1.1.1.2.cmml" xref="A1.E6.m1.7.7.1.1.1.1.2"></times><apply id="A1.E6.m1.7.7.1.1.1.1.3.cmml" xref="A1.E6.m1.7.7.1.1.1.1.3"><divide id="A1.E6.m1.7.7.1.1.1.1.3.1.cmml" xref="A1.E6.m1.7.7.1.1.1.1.3"></divide><cn type="integer" id="A1.E6.m1.7.7.1.1.1.1.3.2.cmml" xref="A1.E6.m1.7.7.1.1.1.1.3.2">1</cn><cn type="integer" id="A1.E6.m1.7.7.1.1.1.1.3.3.cmml" xref="A1.E6.m1.7.7.1.1.1.1.3.3">2</cn></apply><apply id="A1.E6.m1.7.7.1.1.1.1.1.cmml" xref="A1.E6.m1.7.7.1.1.1.1.1"><apply id="A1.E6.m1.7.7.1.1.1.1.1.2.cmml" xref="A1.E6.m1.7.7.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E6.m1.7.7.1.1.1.1.1.2.1.cmml" xref="A1.E6.m1.7.7.1.1.1.1.1.2">superscript</csymbol><apply id="A1.E6.m1.7.7.1.1.1.1.1.2.2.cmml" xref="A1.E6.m1.7.7.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E6.m1.7.7.1.1.1.1.1.2.2.1.cmml" xref="A1.E6.m1.7.7.1.1.1.1.1.2">subscript</csymbol><sum id="A1.E6.m1.7.7.1.1.1.1.1.2.2.2.cmml" xref="A1.E6.m1.7.7.1.1.1.1.1.2.2.2"></sum><apply id="A1.E6.m1.7.7.1.1.1.1.1.2.2.3.cmml" xref="A1.E6.m1.7.7.1.1.1.1.1.2.2.3"><eq id="A1.E6.m1.7.7.1.1.1.1.1.2.2.3.1.cmml" xref="A1.E6.m1.7.7.1.1.1.1.1.2.2.3.1"></eq><ci id="A1.E6.m1.7.7.1.1.1.1.1.2.2.3.2.cmml" xref="A1.E6.m1.7.7.1.1.1.1.1.2.2.3.2">𝑘</ci><cn type="integer" id="A1.E6.m1.7.7.1.1.1.1.1.2.2.3.3.cmml" xref="A1.E6.m1.7.7.1.1.1.1.1.2.2.3.3">0</cn></apply></apply><apply id="A1.E6.m1.7.7.1.1.1.1.1.2.3.cmml" xref="A1.E6.m1.7.7.1.1.1.1.1.2.3"><minus id="A1.E6.m1.7.7.1.1.1.1.1.2.3.1.cmml" xref="A1.E6.m1.7.7.1.1.1.1.1.2.3.1"></minus><ci id="A1.E6.m1.7.7.1.1.1.1.1.2.3.2.cmml" xref="A1.E6.m1.7.7.1.1.1.1.1.2.3.2">𝐺</ci><cn type="integer" id="A1.E6.m1.7.7.1.1.1.1.1.2.3.3.cmml" xref="A1.E6.m1.7.7.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="A1.E6.m1.7.7.1.1.1.1.1.1.1"><plus id="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.3"></plus><apply id="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1"><log id="A1.E6.m1.5.5.cmml" xref="A1.E6.m1.5.5"></log><apply id="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑝</ci><list id="A1.E6.m1.2.2.2.3.cmml" xref="A1.E6.m1.2.2.2.4"><ci id="A1.E6.m1.1.1.1.1.cmml" xref="A1.E6.m1.1.1.1.1">𝑡</ci><ci id="A1.E6.m1.2.2.2.2.cmml" xref="A1.E6.m1.2.2.2.2">𝑣</ci></list></apply><ci id="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply></apply><apply id="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.2.1"><log id="A1.E6.m1.6.6.cmml" xref="A1.E6.m1.6.6"></log><apply id="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1"><csymbol cd="ambiguous" id="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1">superscript</csymbol><apply id="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1"><csymbol cd="ambiguous" id="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1.2.1.cmml" xref="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1">subscript</csymbol><ci id="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1.2.2.cmml" xref="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1.2.2">𝑝</ci><list id="A1.E6.m1.4.4.2.3.cmml" xref="A1.E6.m1.4.4.2.4"><ci id="A1.E6.m1.3.3.1.1.cmml" xref="A1.E6.m1.3.3.1.1">𝑣</ci><ci id="A1.E6.m1.4.4.2.2.cmml" xref="A1.E6.m1.4.4.2.2">𝑡</ci></list></apply><ci id="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="A1.E6.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1.3">𝑘</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E6.m1.7c">\mathcal{L}_{\mathrm{bag}}=-\frac{1}{2}\sum_{k=0}^{G-1}(\log(p_{t,v}^{k})+\log(p_{v,t}^{k})).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="A1.p7.2" class="ltx_p">The <math id="A1.p7.1.m1.2" class="ltx_Math" alttext="p_{t,v}^{k}" display="inline"><semantics id="A1.p7.1.m1.2a"><msubsup id="A1.p7.1.m1.2.3" xref="A1.p7.1.m1.2.3.cmml"><mi id="A1.p7.1.m1.2.3.2.2" xref="A1.p7.1.m1.2.3.2.2.cmml">p</mi><mrow id="A1.p7.1.m1.2.2.2.4" xref="A1.p7.1.m1.2.2.2.3.cmml"><mi id="A1.p7.1.m1.1.1.1.1" xref="A1.p7.1.m1.1.1.1.1.cmml">t</mi><mo id="A1.p7.1.m1.2.2.2.4.1" xref="A1.p7.1.m1.2.2.2.3.cmml">,</mo><mi id="A1.p7.1.m1.2.2.2.2" xref="A1.p7.1.m1.2.2.2.2.cmml">v</mi></mrow><mi id="A1.p7.1.m1.2.3.3" xref="A1.p7.1.m1.2.3.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.p7.1.m1.2b"><apply id="A1.p7.1.m1.2.3.cmml" xref="A1.p7.1.m1.2.3"><csymbol cd="ambiguous" id="A1.p7.1.m1.2.3.1.cmml" xref="A1.p7.1.m1.2.3">superscript</csymbol><apply id="A1.p7.1.m1.2.3.2.cmml" xref="A1.p7.1.m1.2.3"><csymbol cd="ambiguous" id="A1.p7.1.m1.2.3.2.1.cmml" xref="A1.p7.1.m1.2.3">subscript</csymbol><ci id="A1.p7.1.m1.2.3.2.2.cmml" xref="A1.p7.1.m1.2.3.2.2">𝑝</ci><list id="A1.p7.1.m1.2.2.2.3.cmml" xref="A1.p7.1.m1.2.2.2.4"><ci id="A1.p7.1.m1.1.1.1.1.cmml" xref="A1.p7.1.m1.1.1.1.1">𝑡</ci><ci id="A1.p7.1.m1.2.2.2.2.cmml" xref="A1.p7.1.m1.2.2.2.2">𝑣</ci></list></apply><ci id="A1.p7.1.m1.2.3.3.cmml" xref="A1.p7.1.m1.2.3.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p7.1.m1.2c">p_{t,v}^{k}</annotation></semantics></math> and <math id="A1.p7.2.m2.2" class="ltx_Math" alttext="p_{v,t}^{k}" display="inline"><semantics id="A1.p7.2.m2.2a"><msubsup id="A1.p7.2.m2.2.3" xref="A1.p7.2.m2.2.3.cmml"><mi id="A1.p7.2.m2.2.3.2.2" xref="A1.p7.2.m2.2.3.2.2.cmml">p</mi><mrow id="A1.p7.2.m2.2.2.2.4" xref="A1.p7.2.m2.2.2.2.3.cmml"><mi id="A1.p7.2.m2.1.1.1.1" xref="A1.p7.2.m2.1.1.1.1.cmml">v</mi><mo id="A1.p7.2.m2.2.2.2.4.1" xref="A1.p7.2.m2.2.2.2.3.cmml">,</mo><mi id="A1.p7.2.m2.2.2.2.2" xref="A1.p7.2.m2.2.2.2.2.cmml">t</mi></mrow><mi id="A1.p7.2.m2.2.3.3" xref="A1.p7.2.m2.2.3.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.p7.2.m2.2b"><apply id="A1.p7.2.m2.2.3.cmml" xref="A1.p7.2.m2.2.3"><csymbol cd="ambiguous" id="A1.p7.2.m2.2.3.1.cmml" xref="A1.p7.2.m2.2.3">superscript</csymbol><apply id="A1.p7.2.m2.2.3.2.cmml" xref="A1.p7.2.m2.2.3"><csymbol cd="ambiguous" id="A1.p7.2.m2.2.3.2.1.cmml" xref="A1.p7.2.m2.2.3">subscript</csymbol><ci id="A1.p7.2.m2.2.3.2.2.cmml" xref="A1.p7.2.m2.2.3.2.2">𝑝</ci><list id="A1.p7.2.m2.2.2.2.3.cmml" xref="A1.p7.2.m2.2.2.2.4"><ci id="A1.p7.2.m2.1.1.1.1.cmml" xref="A1.p7.2.m2.1.1.1.1">𝑣</ci><ci id="A1.p7.2.m2.2.2.2.2.cmml" xref="A1.p7.2.m2.2.2.2.2">𝑡</ci></list></apply><ci id="A1.p7.2.m2.2.3.3.cmml" xref="A1.p7.2.m2.2.3.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p7.2.m2.2c">p_{v,t}^{k}</annotation></semantics></math> are calculated as</p>
<table id="A6.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A1.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A1.E7.m1.6" class="ltx_Math" alttext="\displaystyle p_{t,v}^{k}=\frac{\exp(\tau_{\mathrm{bag}}\cdot\langle f_{t}^{k},f_{v}^{k}\rangle)}{\sum_{l=0}^{G-1}\exp(\tau_{\mathrm{bag}}\cdot\langle f_{t}^{k},f_{v}^{l}\rangle)}" display="inline"><semantics id="A1.E7.m1.6a"><mrow id="A1.E7.m1.6.7" xref="A1.E7.m1.6.7.cmml"><msubsup id="A1.E7.m1.6.7.2" xref="A1.E7.m1.6.7.2.cmml"><mi id="A1.E7.m1.6.7.2.2.2" xref="A1.E7.m1.6.7.2.2.2.cmml">p</mi><mrow id="A1.E7.m1.2.2.2.4" xref="A1.E7.m1.2.2.2.3.cmml"><mi id="A1.E7.m1.1.1.1.1" xref="A1.E7.m1.1.1.1.1.cmml">t</mi><mo id="A1.E7.m1.2.2.2.4.1" xref="A1.E7.m1.2.2.2.3.cmml">,</mo><mi id="A1.E7.m1.2.2.2.2" xref="A1.E7.m1.2.2.2.2.cmml">v</mi></mrow><mi id="A1.E7.m1.6.7.2.3" xref="A1.E7.m1.6.7.2.3.cmml">k</mi></msubsup><mo id="A1.E7.m1.6.7.1" xref="A1.E7.m1.6.7.1.cmml">=</mo><mstyle displaystyle="true" id="A1.E7.m1.6.6" xref="A1.E7.m1.6.6.cmml"><mfrac id="A1.E7.m1.6.6a" xref="A1.E7.m1.6.6.cmml"><mrow id="A1.E7.m1.4.4.2.2" xref="A1.E7.m1.4.4.2.3.cmml"><mi id="A1.E7.m1.3.3.1.1" xref="A1.E7.m1.3.3.1.1.cmml">exp</mi><mo id="A1.E7.m1.4.4.2.2a" xref="A1.E7.m1.4.4.2.3.cmml">⁡</mo><mrow id="A1.E7.m1.4.4.2.2.1" xref="A1.E7.m1.4.4.2.3.cmml"><mo stretchy="false" id="A1.E7.m1.4.4.2.2.1.2" xref="A1.E7.m1.4.4.2.3.cmml">(</mo><mrow id="A1.E7.m1.4.4.2.2.1.1" xref="A1.E7.m1.4.4.2.2.1.1.cmml"><msub id="A1.E7.m1.4.4.2.2.1.1.4" xref="A1.E7.m1.4.4.2.2.1.1.4.cmml"><mi id="A1.E7.m1.4.4.2.2.1.1.4.2" xref="A1.E7.m1.4.4.2.2.1.1.4.2.cmml">τ</mi><mi id="A1.E7.m1.4.4.2.2.1.1.4.3" xref="A1.E7.m1.4.4.2.2.1.1.4.3.cmml">bag</mi></msub><mo lspace="0.222em" rspace="0.222em" id="A1.E7.m1.4.4.2.2.1.1.3" xref="A1.E7.m1.4.4.2.2.1.1.3.cmml">⋅</mo><mrow id="A1.E7.m1.4.4.2.2.1.1.2.2" xref="A1.E7.m1.4.4.2.2.1.1.2.3.cmml"><mo stretchy="false" id="A1.E7.m1.4.4.2.2.1.1.2.2.3" xref="A1.E7.m1.4.4.2.2.1.1.2.3.cmml">⟨</mo><msubsup id="A1.E7.m1.4.4.2.2.1.1.1.1.1" xref="A1.E7.m1.4.4.2.2.1.1.1.1.1.cmml"><mi id="A1.E7.m1.4.4.2.2.1.1.1.1.1.2.2" xref="A1.E7.m1.4.4.2.2.1.1.1.1.1.2.2.cmml">f</mi><mi id="A1.E7.m1.4.4.2.2.1.1.1.1.1.2.3" xref="A1.E7.m1.4.4.2.2.1.1.1.1.1.2.3.cmml">t</mi><mi id="A1.E7.m1.4.4.2.2.1.1.1.1.1.3" xref="A1.E7.m1.4.4.2.2.1.1.1.1.1.3.cmml">k</mi></msubsup><mo id="A1.E7.m1.4.4.2.2.1.1.2.2.4" xref="A1.E7.m1.4.4.2.2.1.1.2.3.cmml">,</mo><msubsup id="A1.E7.m1.4.4.2.2.1.1.2.2.2" xref="A1.E7.m1.4.4.2.2.1.1.2.2.2.cmml"><mi id="A1.E7.m1.4.4.2.2.1.1.2.2.2.2.2" xref="A1.E7.m1.4.4.2.2.1.1.2.2.2.2.2.cmml">f</mi><mi id="A1.E7.m1.4.4.2.2.1.1.2.2.2.2.3" xref="A1.E7.m1.4.4.2.2.1.1.2.2.2.2.3.cmml">v</mi><mi id="A1.E7.m1.4.4.2.2.1.1.2.2.2.3" xref="A1.E7.m1.4.4.2.2.1.1.2.2.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="A1.E7.m1.4.4.2.2.1.1.2.2.5" xref="A1.E7.m1.4.4.2.2.1.1.2.3.cmml">⟩</mo></mrow></mrow><mo stretchy="false" id="A1.E7.m1.4.4.2.2.1.3" xref="A1.E7.m1.4.4.2.3.cmml">)</mo></mrow></mrow><mrow id="A1.E7.m1.6.6.4" xref="A1.E7.m1.6.6.4.cmml"><msubsup id="A1.E7.m1.6.6.4.3" xref="A1.E7.m1.6.6.4.3.cmml"><mo id="A1.E7.m1.6.6.4.3.2.2" xref="A1.E7.m1.6.6.4.3.2.2.cmml">∑</mo><mrow id="A1.E7.m1.6.6.4.3.2.3" xref="A1.E7.m1.6.6.4.3.2.3.cmml"><mi id="A1.E7.m1.6.6.4.3.2.3.2" xref="A1.E7.m1.6.6.4.3.2.3.2.cmml">l</mi><mo id="A1.E7.m1.6.6.4.3.2.3.1" xref="A1.E7.m1.6.6.4.3.2.3.1.cmml">=</mo><mn id="A1.E7.m1.6.6.4.3.2.3.3" xref="A1.E7.m1.6.6.4.3.2.3.3.cmml">0</mn></mrow><mrow id="A1.E7.m1.6.6.4.3.3" xref="A1.E7.m1.6.6.4.3.3.cmml"><mi id="A1.E7.m1.6.6.4.3.3.2" xref="A1.E7.m1.6.6.4.3.3.2.cmml">G</mi><mo id="A1.E7.m1.6.6.4.3.3.1" xref="A1.E7.m1.6.6.4.3.3.1.cmml">−</mo><mn id="A1.E7.m1.6.6.4.3.3.3" xref="A1.E7.m1.6.6.4.3.3.3.cmml">1</mn></mrow></msubsup><mrow id="A1.E7.m1.6.6.4.2.1" xref="A1.E7.m1.6.6.4.2.2.cmml"><mi id="A1.E7.m1.5.5.3.1" xref="A1.E7.m1.5.5.3.1.cmml">exp</mi><mo id="A1.E7.m1.6.6.4.2.1a" xref="A1.E7.m1.6.6.4.2.2.cmml">⁡</mo><mrow id="A1.E7.m1.6.6.4.2.1.1" xref="A1.E7.m1.6.6.4.2.2.cmml"><mo stretchy="false" id="A1.E7.m1.6.6.4.2.1.1.2" xref="A1.E7.m1.6.6.4.2.2.cmml">(</mo><mrow id="A1.E7.m1.6.6.4.2.1.1.1" xref="A1.E7.m1.6.6.4.2.1.1.1.cmml"><msub id="A1.E7.m1.6.6.4.2.1.1.1.4" xref="A1.E7.m1.6.6.4.2.1.1.1.4.cmml"><mi id="A1.E7.m1.6.6.4.2.1.1.1.4.2" xref="A1.E7.m1.6.6.4.2.1.1.1.4.2.cmml">τ</mi><mi id="A1.E7.m1.6.6.4.2.1.1.1.4.3" xref="A1.E7.m1.6.6.4.2.1.1.1.4.3.cmml">bag</mi></msub><mo lspace="0.222em" rspace="0.222em" id="A1.E7.m1.6.6.4.2.1.1.1.3" xref="A1.E7.m1.6.6.4.2.1.1.1.3.cmml">⋅</mo><mrow id="A1.E7.m1.6.6.4.2.1.1.1.2.2" xref="A1.E7.m1.6.6.4.2.1.1.1.2.3.cmml"><mo stretchy="false" id="A1.E7.m1.6.6.4.2.1.1.1.2.2.3" xref="A1.E7.m1.6.6.4.2.1.1.1.2.3.cmml">⟨</mo><msubsup id="A1.E7.m1.6.6.4.2.1.1.1.1.1.1" xref="A1.E7.m1.6.6.4.2.1.1.1.1.1.1.cmml"><mi id="A1.E7.m1.6.6.4.2.1.1.1.1.1.1.2.2" xref="A1.E7.m1.6.6.4.2.1.1.1.1.1.1.2.2.cmml">f</mi><mi id="A1.E7.m1.6.6.4.2.1.1.1.1.1.1.2.3" xref="A1.E7.m1.6.6.4.2.1.1.1.1.1.1.2.3.cmml">t</mi><mi id="A1.E7.m1.6.6.4.2.1.1.1.1.1.1.3" xref="A1.E7.m1.6.6.4.2.1.1.1.1.1.1.3.cmml">k</mi></msubsup><mo id="A1.E7.m1.6.6.4.2.1.1.1.2.2.4" xref="A1.E7.m1.6.6.4.2.1.1.1.2.3.cmml">,</mo><msubsup id="A1.E7.m1.6.6.4.2.1.1.1.2.2.2" xref="A1.E7.m1.6.6.4.2.1.1.1.2.2.2.cmml"><mi id="A1.E7.m1.6.6.4.2.1.1.1.2.2.2.2.2" xref="A1.E7.m1.6.6.4.2.1.1.1.2.2.2.2.2.cmml">f</mi><mi id="A1.E7.m1.6.6.4.2.1.1.1.2.2.2.2.3" xref="A1.E7.m1.6.6.4.2.1.1.1.2.2.2.2.3.cmml">v</mi><mi id="A1.E7.m1.6.6.4.2.1.1.1.2.2.2.3" xref="A1.E7.m1.6.6.4.2.1.1.1.2.2.2.3.cmml">l</mi></msubsup><mo stretchy="false" id="A1.E7.m1.6.6.4.2.1.1.1.2.2.5" xref="A1.E7.m1.6.6.4.2.1.1.1.2.3.cmml">⟩</mo></mrow></mrow><mo stretchy="false" id="A1.E7.m1.6.6.4.2.1.1.3" xref="A1.E7.m1.6.6.4.2.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="A1.E7.m1.6b"><apply id="A1.E7.m1.6.7.cmml" xref="A1.E7.m1.6.7"><eq id="A1.E7.m1.6.7.1.cmml" xref="A1.E7.m1.6.7.1"></eq><apply id="A1.E7.m1.6.7.2.cmml" xref="A1.E7.m1.6.7.2"><csymbol cd="ambiguous" id="A1.E7.m1.6.7.2.1.cmml" xref="A1.E7.m1.6.7.2">superscript</csymbol><apply id="A1.E7.m1.6.7.2.2.cmml" xref="A1.E7.m1.6.7.2"><csymbol cd="ambiguous" id="A1.E7.m1.6.7.2.2.1.cmml" xref="A1.E7.m1.6.7.2">subscript</csymbol><ci id="A1.E7.m1.6.7.2.2.2.cmml" xref="A1.E7.m1.6.7.2.2.2">𝑝</ci><list id="A1.E7.m1.2.2.2.3.cmml" xref="A1.E7.m1.2.2.2.4"><ci id="A1.E7.m1.1.1.1.1.cmml" xref="A1.E7.m1.1.1.1.1">𝑡</ci><ci id="A1.E7.m1.2.2.2.2.cmml" xref="A1.E7.m1.2.2.2.2">𝑣</ci></list></apply><ci id="A1.E7.m1.6.7.2.3.cmml" xref="A1.E7.m1.6.7.2.3">𝑘</ci></apply><apply id="A1.E7.m1.6.6.cmml" xref="A1.E7.m1.6.6"><divide id="A1.E7.m1.6.6.5.cmml" xref="A1.E7.m1.6.6"></divide><apply id="A1.E7.m1.4.4.2.3.cmml" xref="A1.E7.m1.4.4.2.2"><exp id="A1.E7.m1.3.3.1.1.cmml" xref="A1.E7.m1.3.3.1.1"></exp><apply id="A1.E7.m1.4.4.2.2.1.1.cmml" xref="A1.E7.m1.4.4.2.2.1.1"><ci id="A1.E7.m1.4.4.2.2.1.1.3.cmml" xref="A1.E7.m1.4.4.2.2.1.1.3">⋅</ci><apply id="A1.E7.m1.4.4.2.2.1.1.4.cmml" xref="A1.E7.m1.4.4.2.2.1.1.4"><csymbol cd="ambiguous" id="A1.E7.m1.4.4.2.2.1.1.4.1.cmml" xref="A1.E7.m1.4.4.2.2.1.1.4">subscript</csymbol><ci id="A1.E7.m1.4.4.2.2.1.1.4.2.cmml" xref="A1.E7.m1.4.4.2.2.1.1.4.2">𝜏</ci><ci id="A1.E7.m1.4.4.2.2.1.1.4.3.cmml" xref="A1.E7.m1.4.4.2.2.1.1.4.3">bag</ci></apply><list id="A1.E7.m1.4.4.2.2.1.1.2.3.cmml" xref="A1.E7.m1.4.4.2.2.1.1.2.2"><apply id="A1.E7.m1.4.4.2.2.1.1.1.1.1.cmml" xref="A1.E7.m1.4.4.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E7.m1.4.4.2.2.1.1.1.1.1.1.cmml" xref="A1.E7.m1.4.4.2.2.1.1.1.1.1">superscript</csymbol><apply id="A1.E7.m1.4.4.2.2.1.1.1.1.1.2.cmml" xref="A1.E7.m1.4.4.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E7.m1.4.4.2.2.1.1.1.1.1.2.1.cmml" xref="A1.E7.m1.4.4.2.2.1.1.1.1.1">subscript</csymbol><ci id="A1.E7.m1.4.4.2.2.1.1.1.1.1.2.2.cmml" xref="A1.E7.m1.4.4.2.2.1.1.1.1.1.2.2">𝑓</ci><ci id="A1.E7.m1.4.4.2.2.1.1.1.1.1.2.3.cmml" xref="A1.E7.m1.4.4.2.2.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="A1.E7.m1.4.4.2.2.1.1.1.1.1.3.cmml" xref="A1.E7.m1.4.4.2.2.1.1.1.1.1.3">𝑘</ci></apply><apply id="A1.E7.m1.4.4.2.2.1.1.2.2.2.cmml" xref="A1.E7.m1.4.4.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.E7.m1.4.4.2.2.1.1.2.2.2.1.cmml" xref="A1.E7.m1.4.4.2.2.1.1.2.2.2">superscript</csymbol><apply id="A1.E7.m1.4.4.2.2.1.1.2.2.2.2.cmml" xref="A1.E7.m1.4.4.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.E7.m1.4.4.2.2.1.1.2.2.2.2.1.cmml" xref="A1.E7.m1.4.4.2.2.1.1.2.2.2">subscript</csymbol><ci id="A1.E7.m1.4.4.2.2.1.1.2.2.2.2.2.cmml" xref="A1.E7.m1.4.4.2.2.1.1.2.2.2.2.2">𝑓</ci><ci id="A1.E7.m1.4.4.2.2.1.1.2.2.2.2.3.cmml" xref="A1.E7.m1.4.4.2.2.1.1.2.2.2.2.3">𝑣</ci></apply><ci id="A1.E7.m1.4.4.2.2.1.1.2.2.2.3.cmml" xref="A1.E7.m1.4.4.2.2.1.1.2.2.2.3">𝑘</ci></apply></list></apply></apply><apply id="A1.E7.m1.6.6.4.cmml" xref="A1.E7.m1.6.6.4"><apply id="A1.E7.m1.6.6.4.3.cmml" xref="A1.E7.m1.6.6.4.3"><csymbol cd="ambiguous" id="A1.E7.m1.6.6.4.3.1.cmml" xref="A1.E7.m1.6.6.4.3">superscript</csymbol><apply id="A1.E7.m1.6.6.4.3.2.cmml" xref="A1.E7.m1.6.6.4.3"><csymbol cd="ambiguous" id="A1.E7.m1.6.6.4.3.2.1.cmml" xref="A1.E7.m1.6.6.4.3">subscript</csymbol><sum id="A1.E7.m1.6.6.4.3.2.2.cmml" xref="A1.E7.m1.6.6.4.3.2.2"></sum><apply id="A1.E7.m1.6.6.4.3.2.3.cmml" xref="A1.E7.m1.6.6.4.3.2.3"><eq id="A1.E7.m1.6.6.4.3.2.3.1.cmml" xref="A1.E7.m1.6.6.4.3.2.3.1"></eq><ci id="A1.E7.m1.6.6.4.3.2.3.2.cmml" xref="A1.E7.m1.6.6.4.3.2.3.2">𝑙</ci><cn type="integer" id="A1.E7.m1.6.6.4.3.2.3.3.cmml" xref="A1.E7.m1.6.6.4.3.2.3.3">0</cn></apply></apply><apply id="A1.E7.m1.6.6.4.3.3.cmml" xref="A1.E7.m1.6.6.4.3.3"><minus id="A1.E7.m1.6.6.4.3.3.1.cmml" xref="A1.E7.m1.6.6.4.3.3.1"></minus><ci id="A1.E7.m1.6.6.4.3.3.2.cmml" xref="A1.E7.m1.6.6.4.3.3.2">𝐺</ci><cn type="integer" id="A1.E7.m1.6.6.4.3.3.3.cmml" xref="A1.E7.m1.6.6.4.3.3.3">1</cn></apply></apply><apply id="A1.E7.m1.6.6.4.2.2.cmml" xref="A1.E7.m1.6.6.4.2.1"><exp id="A1.E7.m1.5.5.3.1.cmml" xref="A1.E7.m1.5.5.3.1"></exp><apply id="A1.E7.m1.6.6.4.2.1.1.1.cmml" xref="A1.E7.m1.6.6.4.2.1.1.1"><ci id="A1.E7.m1.6.6.4.2.1.1.1.3.cmml" xref="A1.E7.m1.6.6.4.2.1.1.1.3">⋅</ci><apply id="A1.E7.m1.6.6.4.2.1.1.1.4.cmml" xref="A1.E7.m1.6.6.4.2.1.1.1.4"><csymbol cd="ambiguous" id="A1.E7.m1.6.6.4.2.1.1.1.4.1.cmml" xref="A1.E7.m1.6.6.4.2.1.1.1.4">subscript</csymbol><ci id="A1.E7.m1.6.6.4.2.1.1.1.4.2.cmml" xref="A1.E7.m1.6.6.4.2.1.1.1.4.2">𝜏</ci><ci id="A1.E7.m1.6.6.4.2.1.1.1.4.3.cmml" xref="A1.E7.m1.6.6.4.2.1.1.1.4.3">bag</ci></apply><list id="A1.E7.m1.6.6.4.2.1.1.1.2.3.cmml" xref="A1.E7.m1.6.6.4.2.1.1.1.2.2"><apply id="A1.E7.m1.6.6.4.2.1.1.1.1.1.1.cmml" xref="A1.E7.m1.6.6.4.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E7.m1.6.6.4.2.1.1.1.1.1.1.1.cmml" xref="A1.E7.m1.6.6.4.2.1.1.1.1.1.1">superscript</csymbol><apply id="A1.E7.m1.6.6.4.2.1.1.1.1.1.1.2.cmml" xref="A1.E7.m1.6.6.4.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E7.m1.6.6.4.2.1.1.1.1.1.1.2.1.cmml" xref="A1.E7.m1.6.6.4.2.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E7.m1.6.6.4.2.1.1.1.1.1.1.2.2.cmml" xref="A1.E7.m1.6.6.4.2.1.1.1.1.1.1.2.2">𝑓</ci><ci id="A1.E7.m1.6.6.4.2.1.1.1.1.1.1.2.3.cmml" xref="A1.E7.m1.6.6.4.2.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="A1.E7.m1.6.6.4.2.1.1.1.1.1.1.3.cmml" xref="A1.E7.m1.6.6.4.2.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="A1.E7.m1.6.6.4.2.1.1.1.2.2.2.cmml" xref="A1.E7.m1.6.6.4.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.E7.m1.6.6.4.2.1.1.1.2.2.2.1.cmml" xref="A1.E7.m1.6.6.4.2.1.1.1.2.2.2">superscript</csymbol><apply id="A1.E7.m1.6.6.4.2.1.1.1.2.2.2.2.cmml" xref="A1.E7.m1.6.6.4.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.E7.m1.6.6.4.2.1.1.1.2.2.2.2.1.cmml" xref="A1.E7.m1.6.6.4.2.1.1.1.2.2.2">subscript</csymbol><ci id="A1.E7.m1.6.6.4.2.1.1.1.2.2.2.2.2.cmml" xref="A1.E7.m1.6.6.4.2.1.1.1.2.2.2.2.2">𝑓</ci><ci id="A1.E7.m1.6.6.4.2.1.1.1.2.2.2.2.3.cmml" xref="A1.E7.m1.6.6.4.2.1.1.1.2.2.2.2.3">𝑣</ci></apply><ci id="A1.E7.m1.6.6.4.2.1.1.1.2.2.2.3.cmml" xref="A1.E7.m1.6.6.4.2.1.1.1.2.2.2.3">𝑙</ci></apply></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E7.m1.6c">\displaystyle p_{t,v}^{k}=\frac{\exp(\tau_{\mathrm{bag}}\cdot\langle f_{t}^{k},f_{v}^{k}\rangle)}{\sum_{l=0}^{G-1}\exp(\tau_{\mathrm{bag}}\cdot\langle f_{t}^{k},f_{v}^{l}\rangle)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
<tbody id="A1.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A1.E8.m1.7" class="ltx_Math" alttext="\displaystyle p_{v,t}^{k}=\frac{\exp(\tau_{\mathrm{bag}}\cdot\langle f_{v}^{k},f_{t}^{k}\rangle)}{\sum_{l=0}^{G-1}\exp(\tau_{\mathrm{bag}}\cdot\langle f_{v}^{k},f_{t}^{l}\rangle)}," display="inline"><semantics id="A1.E8.m1.7a"><mrow id="A1.E8.m1.7.7.1" xref="A1.E8.m1.7.7.1.1.cmml"><mrow id="A1.E8.m1.7.7.1.1" xref="A1.E8.m1.7.7.1.1.cmml"><msubsup id="A1.E8.m1.7.7.1.1.2" xref="A1.E8.m1.7.7.1.1.2.cmml"><mi id="A1.E8.m1.7.7.1.1.2.2.2" xref="A1.E8.m1.7.7.1.1.2.2.2.cmml">p</mi><mrow id="A1.E8.m1.2.2.2.4" xref="A1.E8.m1.2.2.2.3.cmml"><mi id="A1.E8.m1.1.1.1.1" xref="A1.E8.m1.1.1.1.1.cmml">v</mi><mo id="A1.E8.m1.2.2.2.4.1" xref="A1.E8.m1.2.2.2.3.cmml">,</mo><mi id="A1.E8.m1.2.2.2.2" xref="A1.E8.m1.2.2.2.2.cmml">t</mi></mrow><mi id="A1.E8.m1.7.7.1.1.2.3" xref="A1.E8.m1.7.7.1.1.2.3.cmml">k</mi></msubsup><mo id="A1.E8.m1.7.7.1.1.1" xref="A1.E8.m1.7.7.1.1.1.cmml">=</mo><mstyle displaystyle="true" id="A1.E8.m1.6.6" xref="A1.E8.m1.6.6.cmml"><mfrac id="A1.E8.m1.6.6a" xref="A1.E8.m1.6.6.cmml"><mrow id="A1.E8.m1.4.4.2.2" xref="A1.E8.m1.4.4.2.3.cmml"><mi id="A1.E8.m1.3.3.1.1" xref="A1.E8.m1.3.3.1.1.cmml">exp</mi><mo id="A1.E8.m1.4.4.2.2a" xref="A1.E8.m1.4.4.2.3.cmml">⁡</mo><mrow id="A1.E8.m1.4.4.2.2.1" xref="A1.E8.m1.4.4.2.3.cmml"><mo stretchy="false" id="A1.E8.m1.4.4.2.2.1.2" xref="A1.E8.m1.4.4.2.3.cmml">(</mo><mrow id="A1.E8.m1.4.4.2.2.1.1" xref="A1.E8.m1.4.4.2.2.1.1.cmml"><msub id="A1.E8.m1.4.4.2.2.1.1.4" xref="A1.E8.m1.4.4.2.2.1.1.4.cmml"><mi id="A1.E8.m1.4.4.2.2.1.1.4.2" xref="A1.E8.m1.4.4.2.2.1.1.4.2.cmml">τ</mi><mi id="A1.E8.m1.4.4.2.2.1.1.4.3" xref="A1.E8.m1.4.4.2.2.1.1.4.3.cmml">bag</mi></msub><mo lspace="0.222em" rspace="0.222em" id="A1.E8.m1.4.4.2.2.1.1.3" xref="A1.E8.m1.4.4.2.2.1.1.3.cmml">⋅</mo><mrow id="A1.E8.m1.4.4.2.2.1.1.2.2" xref="A1.E8.m1.4.4.2.2.1.1.2.3.cmml"><mo stretchy="false" id="A1.E8.m1.4.4.2.2.1.1.2.2.3" xref="A1.E8.m1.4.4.2.2.1.1.2.3.cmml">⟨</mo><msubsup id="A1.E8.m1.4.4.2.2.1.1.1.1.1" xref="A1.E8.m1.4.4.2.2.1.1.1.1.1.cmml"><mi id="A1.E8.m1.4.4.2.2.1.1.1.1.1.2.2" xref="A1.E8.m1.4.4.2.2.1.1.1.1.1.2.2.cmml">f</mi><mi id="A1.E8.m1.4.4.2.2.1.1.1.1.1.2.3" xref="A1.E8.m1.4.4.2.2.1.1.1.1.1.2.3.cmml">v</mi><mi id="A1.E8.m1.4.4.2.2.1.1.1.1.1.3" xref="A1.E8.m1.4.4.2.2.1.1.1.1.1.3.cmml">k</mi></msubsup><mo id="A1.E8.m1.4.4.2.2.1.1.2.2.4" xref="A1.E8.m1.4.4.2.2.1.1.2.3.cmml">,</mo><msubsup id="A1.E8.m1.4.4.2.2.1.1.2.2.2" xref="A1.E8.m1.4.4.2.2.1.1.2.2.2.cmml"><mi id="A1.E8.m1.4.4.2.2.1.1.2.2.2.2.2" xref="A1.E8.m1.4.4.2.2.1.1.2.2.2.2.2.cmml">f</mi><mi id="A1.E8.m1.4.4.2.2.1.1.2.2.2.2.3" xref="A1.E8.m1.4.4.2.2.1.1.2.2.2.2.3.cmml">t</mi><mi id="A1.E8.m1.4.4.2.2.1.1.2.2.2.3" xref="A1.E8.m1.4.4.2.2.1.1.2.2.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="A1.E8.m1.4.4.2.2.1.1.2.2.5" xref="A1.E8.m1.4.4.2.2.1.1.2.3.cmml">⟩</mo></mrow></mrow><mo stretchy="false" id="A1.E8.m1.4.4.2.2.1.3" xref="A1.E8.m1.4.4.2.3.cmml">)</mo></mrow></mrow><mrow id="A1.E8.m1.6.6.4" xref="A1.E8.m1.6.6.4.cmml"><msubsup id="A1.E8.m1.6.6.4.3" xref="A1.E8.m1.6.6.4.3.cmml"><mo id="A1.E8.m1.6.6.4.3.2.2" xref="A1.E8.m1.6.6.4.3.2.2.cmml">∑</mo><mrow id="A1.E8.m1.6.6.4.3.2.3" xref="A1.E8.m1.6.6.4.3.2.3.cmml"><mi id="A1.E8.m1.6.6.4.3.2.3.2" xref="A1.E8.m1.6.6.4.3.2.3.2.cmml">l</mi><mo id="A1.E8.m1.6.6.4.3.2.3.1" xref="A1.E8.m1.6.6.4.3.2.3.1.cmml">=</mo><mn id="A1.E8.m1.6.6.4.3.2.3.3" xref="A1.E8.m1.6.6.4.3.2.3.3.cmml">0</mn></mrow><mrow id="A1.E8.m1.6.6.4.3.3" xref="A1.E8.m1.6.6.4.3.3.cmml"><mi id="A1.E8.m1.6.6.4.3.3.2" xref="A1.E8.m1.6.6.4.3.3.2.cmml">G</mi><mo id="A1.E8.m1.6.6.4.3.3.1" xref="A1.E8.m1.6.6.4.3.3.1.cmml">−</mo><mn id="A1.E8.m1.6.6.4.3.3.3" xref="A1.E8.m1.6.6.4.3.3.3.cmml">1</mn></mrow></msubsup><mrow id="A1.E8.m1.6.6.4.2.1" xref="A1.E8.m1.6.6.4.2.2.cmml"><mi id="A1.E8.m1.5.5.3.1" xref="A1.E8.m1.5.5.3.1.cmml">exp</mi><mo id="A1.E8.m1.6.6.4.2.1a" xref="A1.E8.m1.6.6.4.2.2.cmml">⁡</mo><mrow id="A1.E8.m1.6.6.4.2.1.1" xref="A1.E8.m1.6.6.4.2.2.cmml"><mo stretchy="false" id="A1.E8.m1.6.6.4.2.1.1.2" xref="A1.E8.m1.6.6.4.2.2.cmml">(</mo><mrow id="A1.E8.m1.6.6.4.2.1.1.1" xref="A1.E8.m1.6.6.4.2.1.1.1.cmml"><msub id="A1.E8.m1.6.6.4.2.1.1.1.4" xref="A1.E8.m1.6.6.4.2.1.1.1.4.cmml"><mi id="A1.E8.m1.6.6.4.2.1.1.1.4.2" xref="A1.E8.m1.6.6.4.2.1.1.1.4.2.cmml">τ</mi><mi id="A1.E8.m1.6.6.4.2.1.1.1.4.3" xref="A1.E8.m1.6.6.4.2.1.1.1.4.3.cmml">bag</mi></msub><mo lspace="0.222em" rspace="0.222em" id="A1.E8.m1.6.6.4.2.1.1.1.3" xref="A1.E8.m1.6.6.4.2.1.1.1.3.cmml">⋅</mo><mrow id="A1.E8.m1.6.6.4.2.1.1.1.2.2" xref="A1.E8.m1.6.6.4.2.1.1.1.2.3.cmml"><mo stretchy="false" id="A1.E8.m1.6.6.4.2.1.1.1.2.2.3" xref="A1.E8.m1.6.6.4.2.1.1.1.2.3.cmml">⟨</mo><msubsup id="A1.E8.m1.6.6.4.2.1.1.1.1.1.1" xref="A1.E8.m1.6.6.4.2.1.1.1.1.1.1.cmml"><mi id="A1.E8.m1.6.6.4.2.1.1.1.1.1.1.2.2" xref="A1.E8.m1.6.6.4.2.1.1.1.1.1.1.2.2.cmml">f</mi><mi id="A1.E8.m1.6.6.4.2.1.1.1.1.1.1.2.3" xref="A1.E8.m1.6.6.4.2.1.1.1.1.1.1.2.3.cmml">v</mi><mi id="A1.E8.m1.6.6.4.2.1.1.1.1.1.1.3" xref="A1.E8.m1.6.6.4.2.1.1.1.1.1.1.3.cmml">k</mi></msubsup><mo id="A1.E8.m1.6.6.4.2.1.1.1.2.2.4" xref="A1.E8.m1.6.6.4.2.1.1.1.2.3.cmml">,</mo><msubsup id="A1.E8.m1.6.6.4.2.1.1.1.2.2.2" xref="A1.E8.m1.6.6.4.2.1.1.1.2.2.2.cmml"><mi id="A1.E8.m1.6.6.4.2.1.1.1.2.2.2.2.2" xref="A1.E8.m1.6.6.4.2.1.1.1.2.2.2.2.2.cmml">f</mi><mi id="A1.E8.m1.6.6.4.2.1.1.1.2.2.2.2.3" xref="A1.E8.m1.6.6.4.2.1.1.1.2.2.2.2.3.cmml">t</mi><mi id="A1.E8.m1.6.6.4.2.1.1.1.2.2.2.3" xref="A1.E8.m1.6.6.4.2.1.1.1.2.2.2.3.cmml">l</mi></msubsup><mo stretchy="false" id="A1.E8.m1.6.6.4.2.1.1.1.2.2.5" xref="A1.E8.m1.6.6.4.2.1.1.1.2.3.cmml">⟩</mo></mrow></mrow><mo stretchy="false" id="A1.E8.m1.6.6.4.2.1.1.3" xref="A1.E8.m1.6.6.4.2.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle></mrow><mo id="A1.E8.m1.7.7.1.2" xref="A1.E8.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E8.m1.7b"><apply id="A1.E8.m1.7.7.1.1.cmml" xref="A1.E8.m1.7.7.1"><eq id="A1.E8.m1.7.7.1.1.1.cmml" xref="A1.E8.m1.7.7.1.1.1"></eq><apply id="A1.E8.m1.7.7.1.1.2.cmml" xref="A1.E8.m1.7.7.1.1.2"><csymbol cd="ambiguous" id="A1.E8.m1.7.7.1.1.2.1.cmml" xref="A1.E8.m1.7.7.1.1.2">superscript</csymbol><apply id="A1.E8.m1.7.7.1.1.2.2.cmml" xref="A1.E8.m1.7.7.1.1.2"><csymbol cd="ambiguous" id="A1.E8.m1.7.7.1.1.2.2.1.cmml" xref="A1.E8.m1.7.7.1.1.2">subscript</csymbol><ci id="A1.E8.m1.7.7.1.1.2.2.2.cmml" xref="A1.E8.m1.7.7.1.1.2.2.2">𝑝</ci><list id="A1.E8.m1.2.2.2.3.cmml" xref="A1.E8.m1.2.2.2.4"><ci id="A1.E8.m1.1.1.1.1.cmml" xref="A1.E8.m1.1.1.1.1">𝑣</ci><ci id="A1.E8.m1.2.2.2.2.cmml" xref="A1.E8.m1.2.2.2.2">𝑡</ci></list></apply><ci id="A1.E8.m1.7.7.1.1.2.3.cmml" xref="A1.E8.m1.7.7.1.1.2.3">𝑘</ci></apply><apply id="A1.E8.m1.6.6.cmml" xref="A1.E8.m1.6.6"><divide id="A1.E8.m1.6.6.5.cmml" xref="A1.E8.m1.6.6"></divide><apply id="A1.E8.m1.4.4.2.3.cmml" xref="A1.E8.m1.4.4.2.2"><exp id="A1.E8.m1.3.3.1.1.cmml" xref="A1.E8.m1.3.3.1.1"></exp><apply id="A1.E8.m1.4.4.2.2.1.1.cmml" xref="A1.E8.m1.4.4.2.2.1.1"><ci id="A1.E8.m1.4.4.2.2.1.1.3.cmml" xref="A1.E8.m1.4.4.2.2.1.1.3">⋅</ci><apply id="A1.E8.m1.4.4.2.2.1.1.4.cmml" xref="A1.E8.m1.4.4.2.2.1.1.4"><csymbol cd="ambiguous" id="A1.E8.m1.4.4.2.2.1.1.4.1.cmml" xref="A1.E8.m1.4.4.2.2.1.1.4">subscript</csymbol><ci id="A1.E8.m1.4.4.2.2.1.1.4.2.cmml" xref="A1.E8.m1.4.4.2.2.1.1.4.2">𝜏</ci><ci id="A1.E8.m1.4.4.2.2.1.1.4.3.cmml" xref="A1.E8.m1.4.4.2.2.1.1.4.3">bag</ci></apply><list id="A1.E8.m1.4.4.2.2.1.1.2.3.cmml" xref="A1.E8.m1.4.4.2.2.1.1.2.2"><apply id="A1.E8.m1.4.4.2.2.1.1.1.1.1.cmml" xref="A1.E8.m1.4.4.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E8.m1.4.4.2.2.1.1.1.1.1.1.cmml" xref="A1.E8.m1.4.4.2.2.1.1.1.1.1">superscript</csymbol><apply id="A1.E8.m1.4.4.2.2.1.1.1.1.1.2.cmml" xref="A1.E8.m1.4.4.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E8.m1.4.4.2.2.1.1.1.1.1.2.1.cmml" xref="A1.E8.m1.4.4.2.2.1.1.1.1.1">subscript</csymbol><ci id="A1.E8.m1.4.4.2.2.1.1.1.1.1.2.2.cmml" xref="A1.E8.m1.4.4.2.2.1.1.1.1.1.2.2">𝑓</ci><ci id="A1.E8.m1.4.4.2.2.1.1.1.1.1.2.3.cmml" xref="A1.E8.m1.4.4.2.2.1.1.1.1.1.2.3">𝑣</ci></apply><ci id="A1.E8.m1.4.4.2.2.1.1.1.1.1.3.cmml" xref="A1.E8.m1.4.4.2.2.1.1.1.1.1.3">𝑘</ci></apply><apply id="A1.E8.m1.4.4.2.2.1.1.2.2.2.cmml" xref="A1.E8.m1.4.4.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.E8.m1.4.4.2.2.1.1.2.2.2.1.cmml" xref="A1.E8.m1.4.4.2.2.1.1.2.2.2">superscript</csymbol><apply id="A1.E8.m1.4.4.2.2.1.1.2.2.2.2.cmml" xref="A1.E8.m1.4.4.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.E8.m1.4.4.2.2.1.1.2.2.2.2.1.cmml" xref="A1.E8.m1.4.4.2.2.1.1.2.2.2">subscript</csymbol><ci id="A1.E8.m1.4.4.2.2.1.1.2.2.2.2.2.cmml" xref="A1.E8.m1.4.4.2.2.1.1.2.2.2.2.2">𝑓</ci><ci id="A1.E8.m1.4.4.2.2.1.1.2.2.2.2.3.cmml" xref="A1.E8.m1.4.4.2.2.1.1.2.2.2.2.3">𝑡</ci></apply><ci id="A1.E8.m1.4.4.2.2.1.1.2.2.2.3.cmml" xref="A1.E8.m1.4.4.2.2.1.1.2.2.2.3">𝑘</ci></apply></list></apply></apply><apply id="A1.E8.m1.6.6.4.cmml" xref="A1.E8.m1.6.6.4"><apply id="A1.E8.m1.6.6.4.3.cmml" xref="A1.E8.m1.6.6.4.3"><csymbol cd="ambiguous" id="A1.E8.m1.6.6.4.3.1.cmml" xref="A1.E8.m1.6.6.4.3">superscript</csymbol><apply id="A1.E8.m1.6.6.4.3.2.cmml" xref="A1.E8.m1.6.6.4.3"><csymbol cd="ambiguous" id="A1.E8.m1.6.6.4.3.2.1.cmml" xref="A1.E8.m1.6.6.4.3">subscript</csymbol><sum id="A1.E8.m1.6.6.4.3.2.2.cmml" xref="A1.E8.m1.6.6.4.3.2.2"></sum><apply id="A1.E8.m1.6.6.4.3.2.3.cmml" xref="A1.E8.m1.6.6.4.3.2.3"><eq id="A1.E8.m1.6.6.4.3.2.3.1.cmml" xref="A1.E8.m1.6.6.4.3.2.3.1"></eq><ci id="A1.E8.m1.6.6.4.3.2.3.2.cmml" xref="A1.E8.m1.6.6.4.3.2.3.2">𝑙</ci><cn type="integer" id="A1.E8.m1.6.6.4.3.2.3.3.cmml" xref="A1.E8.m1.6.6.4.3.2.3.3">0</cn></apply></apply><apply id="A1.E8.m1.6.6.4.3.3.cmml" xref="A1.E8.m1.6.6.4.3.3"><minus id="A1.E8.m1.6.6.4.3.3.1.cmml" xref="A1.E8.m1.6.6.4.3.3.1"></minus><ci id="A1.E8.m1.6.6.4.3.3.2.cmml" xref="A1.E8.m1.6.6.4.3.3.2">𝐺</ci><cn type="integer" id="A1.E8.m1.6.6.4.3.3.3.cmml" xref="A1.E8.m1.6.6.4.3.3.3">1</cn></apply></apply><apply id="A1.E8.m1.6.6.4.2.2.cmml" xref="A1.E8.m1.6.6.4.2.1"><exp id="A1.E8.m1.5.5.3.1.cmml" xref="A1.E8.m1.5.5.3.1"></exp><apply id="A1.E8.m1.6.6.4.2.1.1.1.cmml" xref="A1.E8.m1.6.6.4.2.1.1.1"><ci id="A1.E8.m1.6.6.4.2.1.1.1.3.cmml" xref="A1.E8.m1.6.6.4.2.1.1.1.3">⋅</ci><apply id="A1.E8.m1.6.6.4.2.1.1.1.4.cmml" xref="A1.E8.m1.6.6.4.2.1.1.1.4"><csymbol cd="ambiguous" id="A1.E8.m1.6.6.4.2.1.1.1.4.1.cmml" xref="A1.E8.m1.6.6.4.2.1.1.1.4">subscript</csymbol><ci id="A1.E8.m1.6.6.4.2.1.1.1.4.2.cmml" xref="A1.E8.m1.6.6.4.2.1.1.1.4.2">𝜏</ci><ci id="A1.E8.m1.6.6.4.2.1.1.1.4.3.cmml" xref="A1.E8.m1.6.6.4.2.1.1.1.4.3">bag</ci></apply><list id="A1.E8.m1.6.6.4.2.1.1.1.2.3.cmml" xref="A1.E8.m1.6.6.4.2.1.1.1.2.2"><apply id="A1.E8.m1.6.6.4.2.1.1.1.1.1.1.cmml" xref="A1.E8.m1.6.6.4.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E8.m1.6.6.4.2.1.1.1.1.1.1.1.cmml" xref="A1.E8.m1.6.6.4.2.1.1.1.1.1.1">superscript</csymbol><apply id="A1.E8.m1.6.6.4.2.1.1.1.1.1.1.2.cmml" xref="A1.E8.m1.6.6.4.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E8.m1.6.6.4.2.1.1.1.1.1.1.2.1.cmml" xref="A1.E8.m1.6.6.4.2.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E8.m1.6.6.4.2.1.1.1.1.1.1.2.2.cmml" xref="A1.E8.m1.6.6.4.2.1.1.1.1.1.1.2.2">𝑓</ci><ci id="A1.E8.m1.6.6.4.2.1.1.1.1.1.1.2.3.cmml" xref="A1.E8.m1.6.6.4.2.1.1.1.1.1.1.2.3">𝑣</ci></apply><ci id="A1.E8.m1.6.6.4.2.1.1.1.1.1.1.3.cmml" xref="A1.E8.m1.6.6.4.2.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="A1.E8.m1.6.6.4.2.1.1.1.2.2.2.cmml" xref="A1.E8.m1.6.6.4.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.E8.m1.6.6.4.2.1.1.1.2.2.2.1.cmml" xref="A1.E8.m1.6.6.4.2.1.1.1.2.2.2">superscript</csymbol><apply id="A1.E8.m1.6.6.4.2.1.1.1.2.2.2.2.cmml" xref="A1.E8.m1.6.6.4.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.E8.m1.6.6.4.2.1.1.1.2.2.2.2.1.cmml" xref="A1.E8.m1.6.6.4.2.1.1.1.2.2.2">subscript</csymbol><ci id="A1.E8.m1.6.6.4.2.1.1.1.2.2.2.2.2.cmml" xref="A1.E8.m1.6.6.4.2.1.1.1.2.2.2.2.2">𝑓</ci><ci id="A1.E8.m1.6.6.4.2.1.1.1.2.2.2.2.3.cmml" xref="A1.E8.m1.6.6.4.2.1.1.1.2.2.2.2.3">𝑡</ci></apply><ci id="A1.E8.m1.6.6.4.2.1.1.1.2.2.2.3.cmml" xref="A1.E8.m1.6.6.4.2.1.1.1.2.2.2.3">𝑙</ci></apply></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E8.m1.7c">\displaystyle p_{v,t}^{k}=\frac{\exp(\tau_{\mathrm{bag}}\cdot\langle f_{v}^{k},f_{t}^{k}\rangle)}{\sum_{l=0}^{G-1}\exp(\tau_{\mathrm{bag}}\cdot\langle f_{v}^{k},f_{t}^{l}\rangle)},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="A1.p7.8" class="ltx_p">respectively, where <math id="A1.p7.3.m1.1" class="ltx_Math" alttext="\tau_{\mathrm{bag}}" display="inline"><semantics id="A1.p7.3.m1.1a"><msub id="A1.p7.3.m1.1.1" xref="A1.p7.3.m1.1.1.cmml"><mi id="A1.p7.3.m1.1.1.2" xref="A1.p7.3.m1.1.1.2.cmml">τ</mi><mi id="A1.p7.3.m1.1.1.3" xref="A1.p7.3.m1.1.1.3.cmml">bag</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p7.3.m1.1b"><apply id="A1.p7.3.m1.1.1.cmml" xref="A1.p7.3.m1.1.1"><csymbol cd="ambiguous" id="A1.p7.3.m1.1.1.1.cmml" xref="A1.p7.3.m1.1.1">subscript</csymbol><ci id="A1.p7.3.m1.1.1.2.cmml" xref="A1.p7.3.m1.1.1.2">𝜏</ci><ci id="A1.p7.3.m1.1.1.3.cmml" xref="A1.p7.3.m1.1.1.3">bag</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p7.3.m1.1c">\tau_{\mathrm{bag}}</annotation></semantics></math> is the temperature to re-scale the cosine similarity. Assuming there are totally <math id="A1.p7.4.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="A1.p7.4.m2.1a"><mi id="A1.p7.4.m2.1.1" xref="A1.p7.4.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="A1.p7.4.m2.1b"><ci id="A1.p7.4.m2.1.1.cmml" xref="A1.p7.4.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p7.4.m2.1c">N</annotation></semantics></math> regions and the image (teacher) and text (student) embeddings for the <math id="A1.p7.5.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="A1.p7.5.m3.1a"><mi id="A1.p7.5.m3.1.1" xref="A1.p7.5.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A1.p7.5.m3.1b"><ci id="A1.p7.5.m3.1.1.cmml" xref="A1.p7.5.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p7.5.m3.1c">k</annotation></semantics></math>-th region are <math id="A1.p7.6.m4.1" class="ltx_Math" alttext="g_{v}^{k}" display="inline"><semantics id="A1.p7.6.m4.1a"><msubsup id="A1.p7.6.m4.1.1" xref="A1.p7.6.m4.1.1.cmml"><mi id="A1.p7.6.m4.1.1.2.2" xref="A1.p7.6.m4.1.1.2.2.cmml">g</mi><mi id="A1.p7.6.m4.1.1.2.3" xref="A1.p7.6.m4.1.1.2.3.cmml">v</mi><mi id="A1.p7.6.m4.1.1.3" xref="A1.p7.6.m4.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.p7.6.m4.1b"><apply id="A1.p7.6.m4.1.1.cmml" xref="A1.p7.6.m4.1.1"><csymbol cd="ambiguous" id="A1.p7.6.m4.1.1.1.cmml" xref="A1.p7.6.m4.1.1">superscript</csymbol><apply id="A1.p7.6.m4.1.1.2.cmml" xref="A1.p7.6.m4.1.1"><csymbol cd="ambiguous" id="A1.p7.6.m4.1.1.2.1.cmml" xref="A1.p7.6.m4.1.1">subscript</csymbol><ci id="A1.p7.6.m4.1.1.2.2.cmml" xref="A1.p7.6.m4.1.1.2.2">𝑔</ci><ci id="A1.p7.6.m4.1.1.2.3.cmml" xref="A1.p7.6.m4.1.1.2.3">𝑣</ci></apply><ci id="A1.p7.6.m4.1.1.3.cmml" xref="A1.p7.6.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p7.6.m4.1c">g_{v}^{k}</annotation></semantics></math> and <math id="A1.p7.7.m5.1" class="ltx_Math" alttext="g_{t}^{k}" display="inline"><semantics id="A1.p7.7.m5.1a"><msubsup id="A1.p7.7.m5.1.1" xref="A1.p7.7.m5.1.1.cmml"><mi id="A1.p7.7.m5.1.1.2.2" xref="A1.p7.7.m5.1.1.2.2.cmml">g</mi><mi id="A1.p7.7.m5.1.1.2.3" xref="A1.p7.7.m5.1.1.2.3.cmml">t</mi><mi id="A1.p7.7.m5.1.1.3" xref="A1.p7.7.m5.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.p7.7.m5.1b"><apply id="A1.p7.7.m5.1.1.cmml" xref="A1.p7.7.m5.1.1"><csymbol cd="ambiguous" id="A1.p7.7.m5.1.1.1.cmml" xref="A1.p7.7.m5.1.1">superscript</csymbol><apply id="A1.p7.7.m5.1.1.2.cmml" xref="A1.p7.7.m5.1.1"><csymbol cd="ambiguous" id="A1.p7.7.m5.1.1.2.1.cmml" xref="A1.p7.7.m5.1.1">subscript</csymbol><ci id="A1.p7.7.m5.1.1.2.2.cmml" xref="A1.p7.7.m5.1.1.2.2">𝑔</ci><ci id="A1.p7.7.m5.1.1.2.3.cmml" xref="A1.p7.7.m5.1.1.2.3">𝑡</ci></apply><ci id="A1.p7.7.m5.1.1.3.cmml" xref="A1.p7.7.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p7.7.m5.1c">g_{t}^{k}</annotation></semantics></math>, the alignment loss <math id="A1.p7.8.m6.1" class="ltx_Math" alttext="\mathcal{L_{\mathrm{individual}}}" display="inline"><semantics id="A1.p7.8.m6.1a"><msub id="A1.p7.8.m6.1.1" xref="A1.p7.8.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.p7.8.m6.1.1.2" xref="A1.p7.8.m6.1.1.2.cmml">ℒ</mi><mi id="A1.p7.8.m6.1.1.3" xref="A1.p7.8.m6.1.1.3.cmml">individual</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p7.8.m6.1b"><apply id="A1.p7.8.m6.1.1.cmml" xref="A1.p7.8.m6.1.1"><csymbol cd="ambiguous" id="A1.p7.8.m6.1.1.1.cmml" xref="A1.p7.8.m6.1.1">subscript</csymbol><ci id="A1.p7.8.m6.1.1.2.cmml" xref="A1.p7.8.m6.1.1.2">ℒ</ci><ci id="A1.p7.8.m6.1.1.3.cmml" xref="A1.p7.8.m6.1.1.3">individual</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p7.8.m6.1c">\mathcal{L_{\mathrm{individual}}}</annotation></semantics></math> on individual regions is calculated as</p>
</div>
<div id="A1.p8" class="ltx_para">
<table id="A1.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.E9.m1.7" class="ltx_Math" alttext="\mathcal{L}_{\mathrm{individual}}=-\frac{1}{2}\sum_{k=0}^{N-1}(\log(q_{t,v}^{k})+\log(q_{v,t}^{k}))." display="block"><semantics id="A1.E9.m1.7a"><mrow id="A1.E9.m1.7.7.1" xref="A1.E9.m1.7.7.1.1.cmml"><mrow id="A1.E9.m1.7.7.1.1" xref="A1.E9.m1.7.7.1.1.cmml"><msub id="A1.E9.m1.7.7.1.1.3" xref="A1.E9.m1.7.7.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E9.m1.7.7.1.1.3.2" xref="A1.E9.m1.7.7.1.1.3.2.cmml">ℒ</mi><mi id="A1.E9.m1.7.7.1.1.3.3" xref="A1.E9.m1.7.7.1.1.3.3.cmml">individual</mi></msub><mo id="A1.E9.m1.7.7.1.1.2" xref="A1.E9.m1.7.7.1.1.2.cmml">=</mo><mrow id="A1.E9.m1.7.7.1.1.1" xref="A1.E9.m1.7.7.1.1.1.cmml"><mo id="A1.E9.m1.7.7.1.1.1a" xref="A1.E9.m1.7.7.1.1.1.cmml">−</mo><mrow id="A1.E9.m1.7.7.1.1.1.1" xref="A1.E9.m1.7.7.1.1.1.1.cmml"><mfrac id="A1.E9.m1.7.7.1.1.1.1.3" xref="A1.E9.m1.7.7.1.1.1.1.3.cmml"><mn id="A1.E9.m1.7.7.1.1.1.1.3.2" xref="A1.E9.m1.7.7.1.1.1.1.3.2.cmml">1</mn><mn id="A1.E9.m1.7.7.1.1.1.1.3.3" xref="A1.E9.m1.7.7.1.1.1.1.3.3.cmml">2</mn></mfrac><mo lspace="0em" rspace="0em" id="A1.E9.m1.7.7.1.1.1.1.2" xref="A1.E9.m1.7.7.1.1.1.1.2.cmml">​</mo><mrow id="A1.E9.m1.7.7.1.1.1.1.1" xref="A1.E9.m1.7.7.1.1.1.1.1.cmml"><munderover id="A1.E9.m1.7.7.1.1.1.1.1.2" xref="A1.E9.m1.7.7.1.1.1.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="A1.E9.m1.7.7.1.1.1.1.1.2.2.2" xref="A1.E9.m1.7.7.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="A1.E9.m1.7.7.1.1.1.1.1.2.2.3" xref="A1.E9.m1.7.7.1.1.1.1.1.2.2.3.cmml"><mi id="A1.E9.m1.7.7.1.1.1.1.1.2.2.3.2" xref="A1.E9.m1.7.7.1.1.1.1.1.2.2.3.2.cmml">k</mi><mo id="A1.E9.m1.7.7.1.1.1.1.1.2.2.3.1" xref="A1.E9.m1.7.7.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="A1.E9.m1.7.7.1.1.1.1.1.2.2.3.3" xref="A1.E9.m1.7.7.1.1.1.1.1.2.2.3.3.cmml">0</mn></mrow><mrow id="A1.E9.m1.7.7.1.1.1.1.1.2.3" xref="A1.E9.m1.7.7.1.1.1.1.1.2.3.cmml"><mi id="A1.E9.m1.7.7.1.1.1.1.1.2.3.2" xref="A1.E9.m1.7.7.1.1.1.1.1.2.3.2.cmml">N</mi><mo id="A1.E9.m1.7.7.1.1.1.1.1.2.3.1" xref="A1.E9.m1.7.7.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="A1.E9.m1.7.7.1.1.1.1.1.2.3.3" xref="A1.E9.m1.7.7.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></munderover><mrow id="A1.E9.m1.7.7.1.1.1.1.1.1.1" xref="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.E9.m1.7.7.1.1.1.1.1.1.1.2" xref="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E9.m1.7.7.1.1.1.1.1.1.1.1" xref="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.cmml"><mrow id="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.1.1" xref="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A1.E9.m1.5.5" xref="A1.E9.m1.5.5.cmml">log</mi><mo id="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.1.1a" xref="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><msubsup id="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">q</mi><mrow id="A1.E9.m1.2.2.2.4" xref="A1.E9.m1.2.2.2.3.cmml"><mi id="A1.E9.m1.1.1.1.1" xref="A1.E9.m1.1.1.1.1.cmml">t</mi><mo id="A1.E9.m1.2.2.2.4.1" xref="A1.E9.m1.2.2.2.3.cmml">,</mo><mi id="A1.E9.m1.2.2.2.2" xref="A1.E9.m1.2.2.2.2.cmml">v</mi></mrow><mi id="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msubsup><mo stretchy="false" id="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.3" xref="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.3.cmml">+</mo><mrow id="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.2.1" xref="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="A1.E9.m1.6.6" xref="A1.E9.m1.6.6.cmml">log</mi><mo id="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.2.1a" xref="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.2.2.cmml">⁡</mo><mrow id="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.2.1.1" xref="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.2.2.cmml"><mo stretchy="false" id="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.2" xref="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.2.2.cmml">(</mo><msubsup id="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1" xref="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mi id="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1.2.2" xref="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1.2.2.cmml">q</mi><mrow id="A1.E9.m1.4.4.2.4" xref="A1.E9.m1.4.4.2.3.cmml"><mi id="A1.E9.m1.3.3.1.1" xref="A1.E9.m1.3.3.1.1.cmml">v</mi><mo id="A1.E9.m1.4.4.2.4.1" xref="A1.E9.m1.4.4.2.3.cmml">,</mo><mi id="A1.E9.m1.4.4.2.2" xref="A1.E9.m1.4.4.2.2.cmml">t</mi></mrow><mi id="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1.3" xref="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml">k</mi></msubsup><mo stretchy="false" id="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.3" xref="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.2.2.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="A1.E9.m1.7.7.1.1.1.1.1.1.1.3" xref="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="A1.E9.m1.7.7.1.2" xref="A1.E9.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E9.m1.7b"><apply id="A1.E9.m1.7.7.1.1.cmml" xref="A1.E9.m1.7.7.1"><eq id="A1.E9.m1.7.7.1.1.2.cmml" xref="A1.E9.m1.7.7.1.1.2"></eq><apply id="A1.E9.m1.7.7.1.1.3.cmml" xref="A1.E9.m1.7.7.1.1.3"><csymbol cd="ambiguous" id="A1.E9.m1.7.7.1.1.3.1.cmml" xref="A1.E9.m1.7.7.1.1.3">subscript</csymbol><ci id="A1.E9.m1.7.7.1.1.3.2.cmml" xref="A1.E9.m1.7.7.1.1.3.2">ℒ</ci><ci id="A1.E9.m1.7.7.1.1.3.3.cmml" xref="A1.E9.m1.7.7.1.1.3.3">individual</ci></apply><apply id="A1.E9.m1.7.7.1.1.1.cmml" xref="A1.E9.m1.7.7.1.1.1"><minus id="A1.E9.m1.7.7.1.1.1.2.cmml" xref="A1.E9.m1.7.7.1.1.1"></minus><apply id="A1.E9.m1.7.7.1.1.1.1.cmml" xref="A1.E9.m1.7.7.1.1.1.1"><times id="A1.E9.m1.7.7.1.1.1.1.2.cmml" xref="A1.E9.m1.7.7.1.1.1.1.2"></times><apply id="A1.E9.m1.7.7.1.1.1.1.3.cmml" xref="A1.E9.m1.7.7.1.1.1.1.3"><divide id="A1.E9.m1.7.7.1.1.1.1.3.1.cmml" xref="A1.E9.m1.7.7.1.1.1.1.3"></divide><cn type="integer" id="A1.E9.m1.7.7.1.1.1.1.3.2.cmml" xref="A1.E9.m1.7.7.1.1.1.1.3.2">1</cn><cn type="integer" id="A1.E9.m1.7.7.1.1.1.1.3.3.cmml" xref="A1.E9.m1.7.7.1.1.1.1.3.3">2</cn></apply><apply id="A1.E9.m1.7.7.1.1.1.1.1.cmml" xref="A1.E9.m1.7.7.1.1.1.1.1"><apply id="A1.E9.m1.7.7.1.1.1.1.1.2.cmml" xref="A1.E9.m1.7.7.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E9.m1.7.7.1.1.1.1.1.2.1.cmml" xref="A1.E9.m1.7.7.1.1.1.1.1.2">superscript</csymbol><apply id="A1.E9.m1.7.7.1.1.1.1.1.2.2.cmml" xref="A1.E9.m1.7.7.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E9.m1.7.7.1.1.1.1.1.2.2.1.cmml" xref="A1.E9.m1.7.7.1.1.1.1.1.2">subscript</csymbol><sum id="A1.E9.m1.7.7.1.1.1.1.1.2.2.2.cmml" xref="A1.E9.m1.7.7.1.1.1.1.1.2.2.2"></sum><apply id="A1.E9.m1.7.7.1.1.1.1.1.2.2.3.cmml" xref="A1.E9.m1.7.7.1.1.1.1.1.2.2.3"><eq id="A1.E9.m1.7.7.1.1.1.1.1.2.2.3.1.cmml" xref="A1.E9.m1.7.7.1.1.1.1.1.2.2.3.1"></eq><ci id="A1.E9.m1.7.7.1.1.1.1.1.2.2.3.2.cmml" xref="A1.E9.m1.7.7.1.1.1.1.1.2.2.3.2">𝑘</ci><cn type="integer" id="A1.E9.m1.7.7.1.1.1.1.1.2.2.3.3.cmml" xref="A1.E9.m1.7.7.1.1.1.1.1.2.2.3.3">0</cn></apply></apply><apply id="A1.E9.m1.7.7.1.1.1.1.1.2.3.cmml" xref="A1.E9.m1.7.7.1.1.1.1.1.2.3"><minus id="A1.E9.m1.7.7.1.1.1.1.1.2.3.1.cmml" xref="A1.E9.m1.7.7.1.1.1.1.1.2.3.1"></minus><ci id="A1.E9.m1.7.7.1.1.1.1.1.2.3.2.cmml" xref="A1.E9.m1.7.7.1.1.1.1.1.2.3.2">𝑁</ci><cn type="integer" id="A1.E9.m1.7.7.1.1.1.1.1.2.3.3.cmml" xref="A1.E9.m1.7.7.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="A1.E9.m1.7.7.1.1.1.1.1.1.1"><plus id="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.3"></plus><apply id="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.1.1"><log id="A1.E9.m1.5.5.cmml" xref="A1.E9.m1.5.5"></log><apply id="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑞</ci><list id="A1.E9.m1.2.2.2.3.cmml" xref="A1.E9.m1.2.2.2.4"><ci id="A1.E9.m1.1.1.1.1.cmml" xref="A1.E9.m1.1.1.1.1">𝑡</ci><ci id="A1.E9.m1.2.2.2.2.cmml" xref="A1.E9.m1.2.2.2.2">𝑣</ci></list></apply><ci id="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply></apply><apply id="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.2.1"><log id="A1.E9.m1.6.6.cmml" xref="A1.E9.m1.6.6"></log><apply id="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1"><csymbol cd="ambiguous" id="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1">superscript</csymbol><apply id="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1"><csymbol cd="ambiguous" id="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1.2.1.cmml" xref="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1">subscript</csymbol><ci id="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1.2.2.cmml" xref="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1.2.2">𝑞</ci><list id="A1.E9.m1.4.4.2.3.cmml" xref="A1.E9.m1.4.4.2.4"><ci id="A1.E9.m1.3.3.1.1.cmml" xref="A1.E9.m1.3.3.1.1">𝑣</ci><ci id="A1.E9.m1.4.4.2.2.cmml" xref="A1.E9.m1.4.4.2.2">𝑡</ci></list></apply><ci id="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="A1.E9.m1.7.7.1.1.1.1.1.1.1.1.2.1.1.1.3">𝑘</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E9.m1.7c">\mathcal{L}_{\mathrm{individual}}=-\frac{1}{2}\sum_{k=0}^{N-1}(\log(q_{t,v}^{k})+\log(q_{v,t}^{k})).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="A1.p8.2" class="ltx_p">The <math id="A1.p8.1.m1.2" class="ltx_Math" alttext="q_{t,v}^{k}" display="inline"><semantics id="A1.p8.1.m1.2a"><msubsup id="A1.p8.1.m1.2.3" xref="A1.p8.1.m1.2.3.cmml"><mi id="A1.p8.1.m1.2.3.2.2" xref="A1.p8.1.m1.2.3.2.2.cmml">q</mi><mrow id="A1.p8.1.m1.2.2.2.4" xref="A1.p8.1.m1.2.2.2.3.cmml"><mi id="A1.p8.1.m1.1.1.1.1" xref="A1.p8.1.m1.1.1.1.1.cmml">t</mi><mo id="A1.p8.1.m1.2.2.2.4.1" xref="A1.p8.1.m1.2.2.2.3.cmml">,</mo><mi id="A1.p8.1.m1.2.2.2.2" xref="A1.p8.1.m1.2.2.2.2.cmml">v</mi></mrow><mi id="A1.p8.1.m1.2.3.3" xref="A1.p8.1.m1.2.3.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.p8.1.m1.2b"><apply id="A1.p8.1.m1.2.3.cmml" xref="A1.p8.1.m1.2.3"><csymbol cd="ambiguous" id="A1.p8.1.m1.2.3.1.cmml" xref="A1.p8.1.m1.2.3">superscript</csymbol><apply id="A1.p8.1.m1.2.3.2.cmml" xref="A1.p8.1.m1.2.3"><csymbol cd="ambiguous" id="A1.p8.1.m1.2.3.2.1.cmml" xref="A1.p8.1.m1.2.3">subscript</csymbol><ci id="A1.p8.1.m1.2.3.2.2.cmml" xref="A1.p8.1.m1.2.3.2.2">𝑞</ci><list id="A1.p8.1.m1.2.2.2.3.cmml" xref="A1.p8.1.m1.2.2.2.4"><ci id="A1.p8.1.m1.1.1.1.1.cmml" xref="A1.p8.1.m1.1.1.1.1">𝑡</ci><ci id="A1.p8.1.m1.2.2.2.2.cmml" xref="A1.p8.1.m1.2.2.2.2">𝑣</ci></list></apply><ci id="A1.p8.1.m1.2.3.3.cmml" xref="A1.p8.1.m1.2.3.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p8.1.m1.2c">q_{t,v}^{k}</annotation></semantics></math> and <math id="A1.p8.2.m2.2" class="ltx_Math" alttext="q_{v,t}^{k}" display="inline"><semantics id="A1.p8.2.m2.2a"><msubsup id="A1.p8.2.m2.2.3" xref="A1.p8.2.m2.2.3.cmml"><mi id="A1.p8.2.m2.2.3.2.2" xref="A1.p8.2.m2.2.3.2.2.cmml">q</mi><mrow id="A1.p8.2.m2.2.2.2.4" xref="A1.p8.2.m2.2.2.2.3.cmml"><mi id="A1.p8.2.m2.1.1.1.1" xref="A1.p8.2.m2.1.1.1.1.cmml">v</mi><mo id="A1.p8.2.m2.2.2.2.4.1" xref="A1.p8.2.m2.2.2.2.3.cmml">,</mo><mi id="A1.p8.2.m2.2.2.2.2" xref="A1.p8.2.m2.2.2.2.2.cmml">t</mi></mrow><mi id="A1.p8.2.m2.2.3.3" xref="A1.p8.2.m2.2.3.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.p8.2.m2.2b"><apply id="A1.p8.2.m2.2.3.cmml" xref="A1.p8.2.m2.2.3"><csymbol cd="ambiguous" id="A1.p8.2.m2.2.3.1.cmml" xref="A1.p8.2.m2.2.3">superscript</csymbol><apply id="A1.p8.2.m2.2.3.2.cmml" xref="A1.p8.2.m2.2.3"><csymbol cd="ambiguous" id="A1.p8.2.m2.2.3.2.1.cmml" xref="A1.p8.2.m2.2.3">subscript</csymbol><ci id="A1.p8.2.m2.2.3.2.2.cmml" xref="A1.p8.2.m2.2.3.2.2">𝑞</ci><list id="A1.p8.2.m2.2.2.2.3.cmml" xref="A1.p8.2.m2.2.2.2.4"><ci id="A1.p8.2.m2.1.1.1.1.cmml" xref="A1.p8.2.m2.1.1.1.1">𝑣</ci><ci id="A1.p8.2.m2.2.2.2.2.cmml" xref="A1.p8.2.m2.2.2.2.2">𝑡</ci></list></apply><ci id="A1.p8.2.m2.2.3.3.cmml" xref="A1.p8.2.m2.2.3.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p8.2.m2.2c">q_{v,t}^{k}</annotation></semantics></math> are calculated as</p>
<table id="A6.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A1.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A1.E10.m1.6" class="ltx_Math" alttext="\displaystyle q_{t,v}^{k}=\frac{\exp(\tau_{\mathrm{individual}}\cdot\langle g_{t}^{k},g_{v}^{k}\rangle)}{\sum_{l=0}^{N-1}\exp(\tau_{\mathrm{individual}}\cdot\langle g_{t}^{k},g_{v}^{l}\rangle)}" display="inline"><semantics id="A1.E10.m1.6a"><mrow id="A1.E10.m1.6.7" xref="A1.E10.m1.6.7.cmml"><msubsup id="A1.E10.m1.6.7.2" xref="A1.E10.m1.6.7.2.cmml"><mi id="A1.E10.m1.6.7.2.2.2" xref="A1.E10.m1.6.7.2.2.2.cmml">q</mi><mrow id="A1.E10.m1.2.2.2.4" xref="A1.E10.m1.2.2.2.3.cmml"><mi id="A1.E10.m1.1.1.1.1" xref="A1.E10.m1.1.1.1.1.cmml">t</mi><mo id="A1.E10.m1.2.2.2.4.1" xref="A1.E10.m1.2.2.2.3.cmml">,</mo><mi id="A1.E10.m1.2.2.2.2" xref="A1.E10.m1.2.2.2.2.cmml">v</mi></mrow><mi id="A1.E10.m1.6.7.2.3" xref="A1.E10.m1.6.7.2.3.cmml">k</mi></msubsup><mo id="A1.E10.m1.6.7.1" xref="A1.E10.m1.6.7.1.cmml">=</mo><mstyle displaystyle="true" id="A1.E10.m1.6.6" xref="A1.E10.m1.6.6.cmml"><mfrac id="A1.E10.m1.6.6a" xref="A1.E10.m1.6.6.cmml"><mrow id="A1.E10.m1.4.4.2.2" xref="A1.E10.m1.4.4.2.3.cmml"><mi id="A1.E10.m1.3.3.1.1" xref="A1.E10.m1.3.3.1.1.cmml">exp</mi><mo id="A1.E10.m1.4.4.2.2a" xref="A1.E10.m1.4.4.2.3.cmml">⁡</mo><mrow id="A1.E10.m1.4.4.2.2.1" xref="A1.E10.m1.4.4.2.3.cmml"><mo stretchy="false" id="A1.E10.m1.4.4.2.2.1.2" xref="A1.E10.m1.4.4.2.3.cmml">(</mo><mrow id="A1.E10.m1.4.4.2.2.1.1" xref="A1.E10.m1.4.4.2.2.1.1.cmml"><msub id="A1.E10.m1.4.4.2.2.1.1.4" xref="A1.E10.m1.4.4.2.2.1.1.4.cmml"><mi id="A1.E10.m1.4.4.2.2.1.1.4.2" xref="A1.E10.m1.4.4.2.2.1.1.4.2.cmml">τ</mi><mi id="A1.E10.m1.4.4.2.2.1.1.4.3" xref="A1.E10.m1.4.4.2.2.1.1.4.3.cmml">individual</mi></msub><mo lspace="0.222em" rspace="0.222em" id="A1.E10.m1.4.4.2.2.1.1.3" xref="A1.E10.m1.4.4.2.2.1.1.3.cmml">⋅</mo><mrow id="A1.E10.m1.4.4.2.2.1.1.2.2" xref="A1.E10.m1.4.4.2.2.1.1.2.3.cmml"><mo stretchy="false" id="A1.E10.m1.4.4.2.2.1.1.2.2.3" xref="A1.E10.m1.4.4.2.2.1.1.2.3.cmml">⟨</mo><msubsup id="A1.E10.m1.4.4.2.2.1.1.1.1.1" xref="A1.E10.m1.4.4.2.2.1.1.1.1.1.cmml"><mi id="A1.E10.m1.4.4.2.2.1.1.1.1.1.2.2" xref="A1.E10.m1.4.4.2.2.1.1.1.1.1.2.2.cmml">g</mi><mi id="A1.E10.m1.4.4.2.2.1.1.1.1.1.2.3" xref="A1.E10.m1.4.4.2.2.1.1.1.1.1.2.3.cmml">t</mi><mi id="A1.E10.m1.4.4.2.2.1.1.1.1.1.3" xref="A1.E10.m1.4.4.2.2.1.1.1.1.1.3.cmml">k</mi></msubsup><mo id="A1.E10.m1.4.4.2.2.1.1.2.2.4" xref="A1.E10.m1.4.4.2.2.1.1.2.3.cmml">,</mo><msubsup id="A1.E10.m1.4.4.2.2.1.1.2.2.2" xref="A1.E10.m1.4.4.2.2.1.1.2.2.2.cmml"><mi id="A1.E10.m1.4.4.2.2.1.1.2.2.2.2.2" xref="A1.E10.m1.4.4.2.2.1.1.2.2.2.2.2.cmml">g</mi><mi id="A1.E10.m1.4.4.2.2.1.1.2.2.2.2.3" xref="A1.E10.m1.4.4.2.2.1.1.2.2.2.2.3.cmml">v</mi><mi id="A1.E10.m1.4.4.2.2.1.1.2.2.2.3" xref="A1.E10.m1.4.4.2.2.1.1.2.2.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="A1.E10.m1.4.4.2.2.1.1.2.2.5" xref="A1.E10.m1.4.4.2.2.1.1.2.3.cmml">⟩</mo></mrow></mrow><mo stretchy="false" id="A1.E10.m1.4.4.2.2.1.3" xref="A1.E10.m1.4.4.2.3.cmml">)</mo></mrow></mrow><mrow id="A1.E10.m1.6.6.4" xref="A1.E10.m1.6.6.4.cmml"><msubsup id="A1.E10.m1.6.6.4.3" xref="A1.E10.m1.6.6.4.3.cmml"><mo id="A1.E10.m1.6.6.4.3.2.2" xref="A1.E10.m1.6.6.4.3.2.2.cmml">∑</mo><mrow id="A1.E10.m1.6.6.4.3.2.3" xref="A1.E10.m1.6.6.4.3.2.3.cmml"><mi id="A1.E10.m1.6.6.4.3.2.3.2" xref="A1.E10.m1.6.6.4.3.2.3.2.cmml">l</mi><mo id="A1.E10.m1.6.6.4.3.2.3.1" xref="A1.E10.m1.6.6.4.3.2.3.1.cmml">=</mo><mn id="A1.E10.m1.6.6.4.3.2.3.3" xref="A1.E10.m1.6.6.4.3.2.3.3.cmml">0</mn></mrow><mrow id="A1.E10.m1.6.6.4.3.3" xref="A1.E10.m1.6.6.4.3.3.cmml"><mi id="A1.E10.m1.6.6.4.3.3.2" xref="A1.E10.m1.6.6.4.3.3.2.cmml">N</mi><mo id="A1.E10.m1.6.6.4.3.3.1" xref="A1.E10.m1.6.6.4.3.3.1.cmml">−</mo><mn id="A1.E10.m1.6.6.4.3.3.3" xref="A1.E10.m1.6.6.4.3.3.3.cmml">1</mn></mrow></msubsup><mrow id="A1.E10.m1.6.6.4.2.1" xref="A1.E10.m1.6.6.4.2.2.cmml"><mi id="A1.E10.m1.5.5.3.1" xref="A1.E10.m1.5.5.3.1.cmml">exp</mi><mo id="A1.E10.m1.6.6.4.2.1a" xref="A1.E10.m1.6.6.4.2.2.cmml">⁡</mo><mrow id="A1.E10.m1.6.6.4.2.1.1" xref="A1.E10.m1.6.6.4.2.2.cmml"><mo stretchy="false" id="A1.E10.m1.6.6.4.2.1.1.2" xref="A1.E10.m1.6.6.4.2.2.cmml">(</mo><mrow id="A1.E10.m1.6.6.4.2.1.1.1" xref="A1.E10.m1.6.6.4.2.1.1.1.cmml"><msub id="A1.E10.m1.6.6.4.2.1.1.1.4" xref="A1.E10.m1.6.6.4.2.1.1.1.4.cmml"><mi id="A1.E10.m1.6.6.4.2.1.1.1.4.2" xref="A1.E10.m1.6.6.4.2.1.1.1.4.2.cmml">τ</mi><mi id="A1.E10.m1.6.6.4.2.1.1.1.4.3" xref="A1.E10.m1.6.6.4.2.1.1.1.4.3.cmml">individual</mi></msub><mo lspace="0.222em" rspace="0.222em" id="A1.E10.m1.6.6.4.2.1.1.1.3" xref="A1.E10.m1.6.6.4.2.1.1.1.3.cmml">⋅</mo><mrow id="A1.E10.m1.6.6.4.2.1.1.1.2.2" xref="A1.E10.m1.6.6.4.2.1.1.1.2.3.cmml"><mo stretchy="false" id="A1.E10.m1.6.6.4.2.1.1.1.2.2.3" xref="A1.E10.m1.6.6.4.2.1.1.1.2.3.cmml">⟨</mo><msubsup id="A1.E10.m1.6.6.4.2.1.1.1.1.1.1" xref="A1.E10.m1.6.6.4.2.1.1.1.1.1.1.cmml"><mi id="A1.E10.m1.6.6.4.2.1.1.1.1.1.1.2.2" xref="A1.E10.m1.6.6.4.2.1.1.1.1.1.1.2.2.cmml">g</mi><mi id="A1.E10.m1.6.6.4.2.1.1.1.1.1.1.2.3" xref="A1.E10.m1.6.6.4.2.1.1.1.1.1.1.2.3.cmml">t</mi><mi id="A1.E10.m1.6.6.4.2.1.1.1.1.1.1.3" xref="A1.E10.m1.6.6.4.2.1.1.1.1.1.1.3.cmml">k</mi></msubsup><mo id="A1.E10.m1.6.6.4.2.1.1.1.2.2.4" xref="A1.E10.m1.6.6.4.2.1.1.1.2.3.cmml">,</mo><msubsup id="A1.E10.m1.6.6.4.2.1.1.1.2.2.2" xref="A1.E10.m1.6.6.4.2.1.1.1.2.2.2.cmml"><mi id="A1.E10.m1.6.6.4.2.1.1.1.2.2.2.2.2" xref="A1.E10.m1.6.6.4.2.1.1.1.2.2.2.2.2.cmml">g</mi><mi id="A1.E10.m1.6.6.4.2.1.1.1.2.2.2.2.3" xref="A1.E10.m1.6.6.4.2.1.1.1.2.2.2.2.3.cmml">v</mi><mi id="A1.E10.m1.6.6.4.2.1.1.1.2.2.2.3" xref="A1.E10.m1.6.6.4.2.1.1.1.2.2.2.3.cmml">l</mi></msubsup><mo stretchy="false" id="A1.E10.m1.6.6.4.2.1.1.1.2.2.5" xref="A1.E10.m1.6.6.4.2.1.1.1.2.3.cmml">⟩</mo></mrow></mrow><mo stretchy="false" id="A1.E10.m1.6.6.4.2.1.1.3" xref="A1.E10.m1.6.6.4.2.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="A1.E10.m1.6b"><apply id="A1.E10.m1.6.7.cmml" xref="A1.E10.m1.6.7"><eq id="A1.E10.m1.6.7.1.cmml" xref="A1.E10.m1.6.7.1"></eq><apply id="A1.E10.m1.6.7.2.cmml" xref="A1.E10.m1.6.7.2"><csymbol cd="ambiguous" id="A1.E10.m1.6.7.2.1.cmml" xref="A1.E10.m1.6.7.2">superscript</csymbol><apply id="A1.E10.m1.6.7.2.2.cmml" xref="A1.E10.m1.6.7.2"><csymbol cd="ambiguous" id="A1.E10.m1.6.7.2.2.1.cmml" xref="A1.E10.m1.6.7.2">subscript</csymbol><ci id="A1.E10.m1.6.7.2.2.2.cmml" xref="A1.E10.m1.6.7.2.2.2">𝑞</ci><list id="A1.E10.m1.2.2.2.3.cmml" xref="A1.E10.m1.2.2.2.4"><ci id="A1.E10.m1.1.1.1.1.cmml" xref="A1.E10.m1.1.1.1.1">𝑡</ci><ci id="A1.E10.m1.2.2.2.2.cmml" xref="A1.E10.m1.2.2.2.2">𝑣</ci></list></apply><ci id="A1.E10.m1.6.7.2.3.cmml" xref="A1.E10.m1.6.7.2.3">𝑘</ci></apply><apply id="A1.E10.m1.6.6.cmml" xref="A1.E10.m1.6.6"><divide id="A1.E10.m1.6.6.5.cmml" xref="A1.E10.m1.6.6"></divide><apply id="A1.E10.m1.4.4.2.3.cmml" xref="A1.E10.m1.4.4.2.2"><exp id="A1.E10.m1.3.3.1.1.cmml" xref="A1.E10.m1.3.3.1.1"></exp><apply id="A1.E10.m1.4.4.2.2.1.1.cmml" xref="A1.E10.m1.4.4.2.2.1.1"><ci id="A1.E10.m1.4.4.2.2.1.1.3.cmml" xref="A1.E10.m1.4.4.2.2.1.1.3">⋅</ci><apply id="A1.E10.m1.4.4.2.2.1.1.4.cmml" xref="A1.E10.m1.4.4.2.2.1.1.4"><csymbol cd="ambiguous" id="A1.E10.m1.4.4.2.2.1.1.4.1.cmml" xref="A1.E10.m1.4.4.2.2.1.1.4">subscript</csymbol><ci id="A1.E10.m1.4.4.2.2.1.1.4.2.cmml" xref="A1.E10.m1.4.4.2.2.1.1.4.2">𝜏</ci><ci id="A1.E10.m1.4.4.2.2.1.1.4.3.cmml" xref="A1.E10.m1.4.4.2.2.1.1.4.3">individual</ci></apply><list id="A1.E10.m1.4.4.2.2.1.1.2.3.cmml" xref="A1.E10.m1.4.4.2.2.1.1.2.2"><apply id="A1.E10.m1.4.4.2.2.1.1.1.1.1.cmml" xref="A1.E10.m1.4.4.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E10.m1.4.4.2.2.1.1.1.1.1.1.cmml" xref="A1.E10.m1.4.4.2.2.1.1.1.1.1">superscript</csymbol><apply id="A1.E10.m1.4.4.2.2.1.1.1.1.1.2.cmml" xref="A1.E10.m1.4.4.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E10.m1.4.4.2.2.1.1.1.1.1.2.1.cmml" xref="A1.E10.m1.4.4.2.2.1.1.1.1.1">subscript</csymbol><ci id="A1.E10.m1.4.4.2.2.1.1.1.1.1.2.2.cmml" xref="A1.E10.m1.4.4.2.2.1.1.1.1.1.2.2">𝑔</ci><ci id="A1.E10.m1.4.4.2.2.1.1.1.1.1.2.3.cmml" xref="A1.E10.m1.4.4.2.2.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="A1.E10.m1.4.4.2.2.1.1.1.1.1.3.cmml" xref="A1.E10.m1.4.4.2.2.1.1.1.1.1.3">𝑘</ci></apply><apply id="A1.E10.m1.4.4.2.2.1.1.2.2.2.cmml" xref="A1.E10.m1.4.4.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.E10.m1.4.4.2.2.1.1.2.2.2.1.cmml" xref="A1.E10.m1.4.4.2.2.1.1.2.2.2">superscript</csymbol><apply id="A1.E10.m1.4.4.2.2.1.1.2.2.2.2.cmml" xref="A1.E10.m1.4.4.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.E10.m1.4.4.2.2.1.1.2.2.2.2.1.cmml" xref="A1.E10.m1.4.4.2.2.1.1.2.2.2">subscript</csymbol><ci id="A1.E10.m1.4.4.2.2.1.1.2.2.2.2.2.cmml" xref="A1.E10.m1.4.4.2.2.1.1.2.2.2.2.2">𝑔</ci><ci id="A1.E10.m1.4.4.2.2.1.1.2.2.2.2.3.cmml" xref="A1.E10.m1.4.4.2.2.1.1.2.2.2.2.3">𝑣</ci></apply><ci id="A1.E10.m1.4.4.2.2.1.1.2.2.2.3.cmml" xref="A1.E10.m1.4.4.2.2.1.1.2.2.2.3">𝑘</ci></apply></list></apply></apply><apply id="A1.E10.m1.6.6.4.cmml" xref="A1.E10.m1.6.6.4"><apply id="A1.E10.m1.6.6.4.3.cmml" xref="A1.E10.m1.6.6.4.3"><csymbol cd="ambiguous" id="A1.E10.m1.6.6.4.3.1.cmml" xref="A1.E10.m1.6.6.4.3">superscript</csymbol><apply id="A1.E10.m1.6.6.4.3.2.cmml" xref="A1.E10.m1.6.6.4.3"><csymbol cd="ambiguous" id="A1.E10.m1.6.6.4.3.2.1.cmml" xref="A1.E10.m1.6.6.4.3">subscript</csymbol><sum id="A1.E10.m1.6.6.4.3.2.2.cmml" xref="A1.E10.m1.6.6.4.3.2.2"></sum><apply id="A1.E10.m1.6.6.4.3.2.3.cmml" xref="A1.E10.m1.6.6.4.3.2.3"><eq id="A1.E10.m1.6.6.4.3.2.3.1.cmml" xref="A1.E10.m1.6.6.4.3.2.3.1"></eq><ci id="A1.E10.m1.6.6.4.3.2.3.2.cmml" xref="A1.E10.m1.6.6.4.3.2.3.2">𝑙</ci><cn type="integer" id="A1.E10.m1.6.6.4.3.2.3.3.cmml" xref="A1.E10.m1.6.6.4.3.2.3.3">0</cn></apply></apply><apply id="A1.E10.m1.6.6.4.3.3.cmml" xref="A1.E10.m1.6.6.4.3.3"><minus id="A1.E10.m1.6.6.4.3.3.1.cmml" xref="A1.E10.m1.6.6.4.3.3.1"></minus><ci id="A1.E10.m1.6.6.4.3.3.2.cmml" xref="A1.E10.m1.6.6.4.3.3.2">𝑁</ci><cn type="integer" id="A1.E10.m1.6.6.4.3.3.3.cmml" xref="A1.E10.m1.6.6.4.3.3.3">1</cn></apply></apply><apply id="A1.E10.m1.6.6.4.2.2.cmml" xref="A1.E10.m1.6.6.4.2.1"><exp id="A1.E10.m1.5.5.3.1.cmml" xref="A1.E10.m1.5.5.3.1"></exp><apply id="A1.E10.m1.6.6.4.2.1.1.1.cmml" xref="A1.E10.m1.6.6.4.2.1.1.1"><ci id="A1.E10.m1.6.6.4.2.1.1.1.3.cmml" xref="A1.E10.m1.6.6.4.2.1.1.1.3">⋅</ci><apply id="A1.E10.m1.6.6.4.2.1.1.1.4.cmml" xref="A1.E10.m1.6.6.4.2.1.1.1.4"><csymbol cd="ambiguous" id="A1.E10.m1.6.6.4.2.1.1.1.4.1.cmml" xref="A1.E10.m1.6.6.4.2.1.1.1.4">subscript</csymbol><ci id="A1.E10.m1.6.6.4.2.1.1.1.4.2.cmml" xref="A1.E10.m1.6.6.4.2.1.1.1.4.2">𝜏</ci><ci id="A1.E10.m1.6.6.4.2.1.1.1.4.3.cmml" xref="A1.E10.m1.6.6.4.2.1.1.1.4.3">individual</ci></apply><list id="A1.E10.m1.6.6.4.2.1.1.1.2.3.cmml" xref="A1.E10.m1.6.6.4.2.1.1.1.2.2"><apply id="A1.E10.m1.6.6.4.2.1.1.1.1.1.1.cmml" xref="A1.E10.m1.6.6.4.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E10.m1.6.6.4.2.1.1.1.1.1.1.1.cmml" xref="A1.E10.m1.6.6.4.2.1.1.1.1.1.1">superscript</csymbol><apply id="A1.E10.m1.6.6.4.2.1.1.1.1.1.1.2.cmml" xref="A1.E10.m1.6.6.4.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E10.m1.6.6.4.2.1.1.1.1.1.1.2.1.cmml" xref="A1.E10.m1.6.6.4.2.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E10.m1.6.6.4.2.1.1.1.1.1.1.2.2.cmml" xref="A1.E10.m1.6.6.4.2.1.1.1.1.1.1.2.2">𝑔</ci><ci id="A1.E10.m1.6.6.4.2.1.1.1.1.1.1.2.3.cmml" xref="A1.E10.m1.6.6.4.2.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="A1.E10.m1.6.6.4.2.1.1.1.1.1.1.3.cmml" xref="A1.E10.m1.6.6.4.2.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="A1.E10.m1.6.6.4.2.1.1.1.2.2.2.cmml" xref="A1.E10.m1.6.6.4.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.E10.m1.6.6.4.2.1.1.1.2.2.2.1.cmml" xref="A1.E10.m1.6.6.4.2.1.1.1.2.2.2">superscript</csymbol><apply id="A1.E10.m1.6.6.4.2.1.1.1.2.2.2.2.cmml" xref="A1.E10.m1.6.6.4.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.E10.m1.6.6.4.2.1.1.1.2.2.2.2.1.cmml" xref="A1.E10.m1.6.6.4.2.1.1.1.2.2.2">subscript</csymbol><ci id="A1.E10.m1.6.6.4.2.1.1.1.2.2.2.2.2.cmml" xref="A1.E10.m1.6.6.4.2.1.1.1.2.2.2.2.2">𝑔</ci><ci id="A1.E10.m1.6.6.4.2.1.1.1.2.2.2.2.3.cmml" xref="A1.E10.m1.6.6.4.2.1.1.1.2.2.2.2.3">𝑣</ci></apply><ci id="A1.E10.m1.6.6.4.2.1.1.1.2.2.2.3.cmml" xref="A1.E10.m1.6.6.4.2.1.1.1.2.2.2.3">𝑙</ci></apply></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E10.m1.6c">\displaystyle q_{t,v}^{k}=\frac{\exp(\tau_{\mathrm{individual}}\cdot\langle g_{t}^{k},g_{v}^{k}\rangle)}{\sum_{l=0}^{N-1}\exp(\tau_{\mathrm{individual}}\cdot\langle g_{t}^{k},g_{v}^{l}\rangle)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
<tbody id="A1.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A1.E11.m1.7" class="ltx_Math" alttext="\displaystyle q_{v,t}^{k}=\frac{\exp(\tau_{\mathrm{individual}}\cdot\langle g_{v}^{k},g_{t}^{k}\rangle)}{\sum_{l=0}^{N-1}\exp(\tau_{\mathrm{individual}}\cdot\langle g_{v}^{k},g_{t}^{l}\rangle)}," display="inline"><semantics id="A1.E11.m1.7a"><mrow id="A1.E11.m1.7.7.1" xref="A1.E11.m1.7.7.1.1.cmml"><mrow id="A1.E11.m1.7.7.1.1" xref="A1.E11.m1.7.7.1.1.cmml"><msubsup id="A1.E11.m1.7.7.1.1.2" xref="A1.E11.m1.7.7.1.1.2.cmml"><mi id="A1.E11.m1.7.7.1.1.2.2.2" xref="A1.E11.m1.7.7.1.1.2.2.2.cmml">q</mi><mrow id="A1.E11.m1.2.2.2.4" xref="A1.E11.m1.2.2.2.3.cmml"><mi id="A1.E11.m1.1.1.1.1" xref="A1.E11.m1.1.1.1.1.cmml">v</mi><mo id="A1.E11.m1.2.2.2.4.1" xref="A1.E11.m1.2.2.2.3.cmml">,</mo><mi id="A1.E11.m1.2.2.2.2" xref="A1.E11.m1.2.2.2.2.cmml">t</mi></mrow><mi id="A1.E11.m1.7.7.1.1.2.3" xref="A1.E11.m1.7.7.1.1.2.3.cmml">k</mi></msubsup><mo id="A1.E11.m1.7.7.1.1.1" xref="A1.E11.m1.7.7.1.1.1.cmml">=</mo><mstyle displaystyle="true" id="A1.E11.m1.6.6" xref="A1.E11.m1.6.6.cmml"><mfrac id="A1.E11.m1.6.6a" xref="A1.E11.m1.6.6.cmml"><mrow id="A1.E11.m1.4.4.2.2" xref="A1.E11.m1.4.4.2.3.cmml"><mi id="A1.E11.m1.3.3.1.1" xref="A1.E11.m1.3.3.1.1.cmml">exp</mi><mo id="A1.E11.m1.4.4.2.2a" xref="A1.E11.m1.4.4.2.3.cmml">⁡</mo><mrow id="A1.E11.m1.4.4.2.2.1" xref="A1.E11.m1.4.4.2.3.cmml"><mo stretchy="false" id="A1.E11.m1.4.4.2.2.1.2" xref="A1.E11.m1.4.4.2.3.cmml">(</mo><mrow id="A1.E11.m1.4.4.2.2.1.1" xref="A1.E11.m1.4.4.2.2.1.1.cmml"><msub id="A1.E11.m1.4.4.2.2.1.1.4" xref="A1.E11.m1.4.4.2.2.1.1.4.cmml"><mi id="A1.E11.m1.4.4.2.2.1.1.4.2" xref="A1.E11.m1.4.4.2.2.1.1.4.2.cmml">τ</mi><mi id="A1.E11.m1.4.4.2.2.1.1.4.3" xref="A1.E11.m1.4.4.2.2.1.1.4.3.cmml">individual</mi></msub><mo lspace="0.222em" rspace="0.222em" id="A1.E11.m1.4.4.2.2.1.1.3" xref="A1.E11.m1.4.4.2.2.1.1.3.cmml">⋅</mo><mrow id="A1.E11.m1.4.4.2.2.1.1.2.2" xref="A1.E11.m1.4.4.2.2.1.1.2.3.cmml"><mo stretchy="false" id="A1.E11.m1.4.4.2.2.1.1.2.2.3" xref="A1.E11.m1.4.4.2.2.1.1.2.3.cmml">⟨</mo><msubsup id="A1.E11.m1.4.4.2.2.1.1.1.1.1" xref="A1.E11.m1.4.4.2.2.1.1.1.1.1.cmml"><mi id="A1.E11.m1.4.4.2.2.1.1.1.1.1.2.2" xref="A1.E11.m1.4.4.2.2.1.1.1.1.1.2.2.cmml">g</mi><mi id="A1.E11.m1.4.4.2.2.1.1.1.1.1.2.3" xref="A1.E11.m1.4.4.2.2.1.1.1.1.1.2.3.cmml">v</mi><mi id="A1.E11.m1.4.4.2.2.1.1.1.1.1.3" xref="A1.E11.m1.4.4.2.2.1.1.1.1.1.3.cmml">k</mi></msubsup><mo id="A1.E11.m1.4.4.2.2.1.1.2.2.4" xref="A1.E11.m1.4.4.2.2.1.1.2.3.cmml">,</mo><msubsup id="A1.E11.m1.4.4.2.2.1.1.2.2.2" xref="A1.E11.m1.4.4.2.2.1.1.2.2.2.cmml"><mi id="A1.E11.m1.4.4.2.2.1.1.2.2.2.2.2" xref="A1.E11.m1.4.4.2.2.1.1.2.2.2.2.2.cmml">g</mi><mi id="A1.E11.m1.4.4.2.2.1.1.2.2.2.2.3" xref="A1.E11.m1.4.4.2.2.1.1.2.2.2.2.3.cmml">t</mi><mi id="A1.E11.m1.4.4.2.2.1.1.2.2.2.3" xref="A1.E11.m1.4.4.2.2.1.1.2.2.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="A1.E11.m1.4.4.2.2.1.1.2.2.5" xref="A1.E11.m1.4.4.2.2.1.1.2.3.cmml">⟩</mo></mrow></mrow><mo stretchy="false" id="A1.E11.m1.4.4.2.2.1.3" xref="A1.E11.m1.4.4.2.3.cmml">)</mo></mrow></mrow><mrow id="A1.E11.m1.6.6.4" xref="A1.E11.m1.6.6.4.cmml"><msubsup id="A1.E11.m1.6.6.4.3" xref="A1.E11.m1.6.6.4.3.cmml"><mo id="A1.E11.m1.6.6.4.3.2.2" xref="A1.E11.m1.6.6.4.3.2.2.cmml">∑</mo><mrow id="A1.E11.m1.6.6.4.3.2.3" xref="A1.E11.m1.6.6.4.3.2.3.cmml"><mi id="A1.E11.m1.6.6.4.3.2.3.2" xref="A1.E11.m1.6.6.4.3.2.3.2.cmml">l</mi><mo id="A1.E11.m1.6.6.4.3.2.3.1" xref="A1.E11.m1.6.6.4.3.2.3.1.cmml">=</mo><mn id="A1.E11.m1.6.6.4.3.2.3.3" xref="A1.E11.m1.6.6.4.3.2.3.3.cmml">0</mn></mrow><mrow id="A1.E11.m1.6.6.4.3.3" xref="A1.E11.m1.6.6.4.3.3.cmml"><mi id="A1.E11.m1.6.6.4.3.3.2" xref="A1.E11.m1.6.6.4.3.3.2.cmml">N</mi><mo id="A1.E11.m1.6.6.4.3.3.1" xref="A1.E11.m1.6.6.4.3.3.1.cmml">−</mo><mn id="A1.E11.m1.6.6.4.3.3.3" xref="A1.E11.m1.6.6.4.3.3.3.cmml">1</mn></mrow></msubsup><mrow id="A1.E11.m1.6.6.4.2.1" xref="A1.E11.m1.6.6.4.2.2.cmml"><mi id="A1.E11.m1.5.5.3.1" xref="A1.E11.m1.5.5.3.1.cmml">exp</mi><mo id="A1.E11.m1.6.6.4.2.1a" xref="A1.E11.m1.6.6.4.2.2.cmml">⁡</mo><mrow id="A1.E11.m1.6.6.4.2.1.1" xref="A1.E11.m1.6.6.4.2.2.cmml"><mo stretchy="false" id="A1.E11.m1.6.6.4.2.1.1.2" xref="A1.E11.m1.6.6.4.2.2.cmml">(</mo><mrow id="A1.E11.m1.6.6.4.2.1.1.1" xref="A1.E11.m1.6.6.4.2.1.1.1.cmml"><msub id="A1.E11.m1.6.6.4.2.1.1.1.4" xref="A1.E11.m1.6.6.4.2.1.1.1.4.cmml"><mi id="A1.E11.m1.6.6.4.2.1.1.1.4.2" xref="A1.E11.m1.6.6.4.2.1.1.1.4.2.cmml">τ</mi><mi id="A1.E11.m1.6.6.4.2.1.1.1.4.3" xref="A1.E11.m1.6.6.4.2.1.1.1.4.3.cmml">individual</mi></msub><mo lspace="0.222em" rspace="0.222em" id="A1.E11.m1.6.6.4.2.1.1.1.3" xref="A1.E11.m1.6.6.4.2.1.1.1.3.cmml">⋅</mo><mrow id="A1.E11.m1.6.6.4.2.1.1.1.2.2" xref="A1.E11.m1.6.6.4.2.1.1.1.2.3.cmml"><mo stretchy="false" id="A1.E11.m1.6.6.4.2.1.1.1.2.2.3" xref="A1.E11.m1.6.6.4.2.1.1.1.2.3.cmml">⟨</mo><msubsup id="A1.E11.m1.6.6.4.2.1.1.1.1.1.1" xref="A1.E11.m1.6.6.4.2.1.1.1.1.1.1.cmml"><mi id="A1.E11.m1.6.6.4.2.1.1.1.1.1.1.2.2" xref="A1.E11.m1.6.6.4.2.1.1.1.1.1.1.2.2.cmml">g</mi><mi id="A1.E11.m1.6.6.4.2.1.1.1.1.1.1.2.3" xref="A1.E11.m1.6.6.4.2.1.1.1.1.1.1.2.3.cmml">v</mi><mi id="A1.E11.m1.6.6.4.2.1.1.1.1.1.1.3" xref="A1.E11.m1.6.6.4.2.1.1.1.1.1.1.3.cmml">k</mi></msubsup><mo id="A1.E11.m1.6.6.4.2.1.1.1.2.2.4" xref="A1.E11.m1.6.6.4.2.1.1.1.2.3.cmml">,</mo><msubsup id="A1.E11.m1.6.6.4.2.1.1.1.2.2.2" xref="A1.E11.m1.6.6.4.2.1.1.1.2.2.2.cmml"><mi id="A1.E11.m1.6.6.4.2.1.1.1.2.2.2.2.2" xref="A1.E11.m1.6.6.4.2.1.1.1.2.2.2.2.2.cmml">g</mi><mi id="A1.E11.m1.6.6.4.2.1.1.1.2.2.2.2.3" xref="A1.E11.m1.6.6.4.2.1.1.1.2.2.2.2.3.cmml">t</mi><mi id="A1.E11.m1.6.6.4.2.1.1.1.2.2.2.3" xref="A1.E11.m1.6.6.4.2.1.1.1.2.2.2.3.cmml">l</mi></msubsup><mo stretchy="false" id="A1.E11.m1.6.6.4.2.1.1.1.2.2.5" xref="A1.E11.m1.6.6.4.2.1.1.1.2.3.cmml">⟩</mo></mrow></mrow><mo stretchy="false" id="A1.E11.m1.6.6.4.2.1.1.3" xref="A1.E11.m1.6.6.4.2.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle></mrow><mo id="A1.E11.m1.7.7.1.2" xref="A1.E11.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E11.m1.7b"><apply id="A1.E11.m1.7.7.1.1.cmml" xref="A1.E11.m1.7.7.1"><eq id="A1.E11.m1.7.7.1.1.1.cmml" xref="A1.E11.m1.7.7.1.1.1"></eq><apply id="A1.E11.m1.7.7.1.1.2.cmml" xref="A1.E11.m1.7.7.1.1.2"><csymbol cd="ambiguous" id="A1.E11.m1.7.7.1.1.2.1.cmml" xref="A1.E11.m1.7.7.1.1.2">superscript</csymbol><apply id="A1.E11.m1.7.7.1.1.2.2.cmml" xref="A1.E11.m1.7.7.1.1.2"><csymbol cd="ambiguous" id="A1.E11.m1.7.7.1.1.2.2.1.cmml" xref="A1.E11.m1.7.7.1.1.2">subscript</csymbol><ci id="A1.E11.m1.7.7.1.1.2.2.2.cmml" xref="A1.E11.m1.7.7.1.1.2.2.2">𝑞</ci><list id="A1.E11.m1.2.2.2.3.cmml" xref="A1.E11.m1.2.2.2.4"><ci id="A1.E11.m1.1.1.1.1.cmml" xref="A1.E11.m1.1.1.1.1">𝑣</ci><ci id="A1.E11.m1.2.2.2.2.cmml" xref="A1.E11.m1.2.2.2.2">𝑡</ci></list></apply><ci id="A1.E11.m1.7.7.1.1.2.3.cmml" xref="A1.E11.m1.7.7.1.1.2.3">𝑘</ci></apply><apply id="A1.E11.m1.6.6.cmml" xref="A1.E11.m1.6.6"><divide id="A1.E11.m1.6.6.5.cmml" xref="A1.E11.m1.6.6"></divide><apply id="A1.E11.m1.4.4.2.3.cmml" xref="A1.E11.m1.4.4.2.2"><exp id="A1.E11.m1.3.3.1.1.cmml" xref="A1.E11.m1.3.3.1.1"></exp><apply id="A1.E11.m1.4.4.2.2.1.1.cmml" xref="A1.E11.m1.4.4.2.2.1.1"><ci id="A1.E11.m1.4.4.2.2.1.1.3.cmml" xref="A1.E11.m1.4.4.2.2.1.1.3">⋅</ci><apply id="A1.E11.m1.4.4.2.2.1.1.4.cmml" xref="A1.E11.m1.4.4.2.2.1.1.4"><csymbol cd="ambiguous" id="A1.E11.m1.4.4.2.2.1.1.4.1.cmml" xref="A1.E11.m1.4.4.2.2.1.1.4">subscript</csymbol><ci id="A1.E11.m1.4.4.2.2.1.1.4.2.cmml" xref="A1.E11.m1.4.4.2.2.1.1.4.2">𝜏</ci><ci id="A1.E11.m1.4.4.2.2.1.1.4.3.cmml" xref="A1.E11.m1.4.4.2.2.1.1.4.3">individual</ci></apply><list id="A1.E11.m1.4.4.2.2.1.1.2.3.cmml" xref="A1.E11.m1.4.4.2.2.1.1.2.2"><apply id="A1.E11.m1.4.4.2.2.1.1.1.1.1.cmml" xref="A1.E11.m1.4.4.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E11.m1.4.4.2.2.1.1.1.1.1.1.cmml" xref="A1.E11.m1.4.4.2.2.1.1.1.1.1">superscript</csymbol><apply id="A1.E11.m1.4.4.2.2.1.1.1.1.1.2.cmml" xref="A1.E11.m1.4.4.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E11.m1.4.4.2.2.1.1.1.1.1.2.1.cmml" xref="A1.E11.m1.4.4.2.2.1.1.1.1.1">subscript</csymbol><ci id="A1.E11.m1.4.4.2.2.1.1.1.1.1.2.2.cmml" xref="A1.E11.m1.4.4.2.2.1.1.1.1.1.2.2">𝑔</ci><ci id="A1.E11.m1.4.4.2.2.1.1.1.1.1.2.3.cmml" xref="A1.E11.m1.4.4.2.2.1.1.1.1.1.2.3">𝑣</ci></apply><ci id="A1.E11.m1.4.4.2.2.1.1.1.1.1.3.cmml" xref="A1.E11.m1.4.4.2.2.1.1.1.1.1.3">𝑘</ci></apply><apply id="A1.E11.m1.4.4.2.2.1.1.2.2.2.cmml" xref="A1.E11.m1.4.4.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.E11.m1.4.4.2.2.1.1.2.2.2.1.cmml" xref="A1.E11.m1.4.4.2.2.1.1.2.2.2">superscript</csymbol><apply id="A1.E11.m1.4.4.2.2.1.1.2.2.2.2.cmml" xref="A1.E11.m1.4.4.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.E11.m1.4.4.2.2.1.1.2.2.2.2.1.cmml" xref="A1.E11.m1.4.4.2.2.1.1.2.2.2">subscript</csymbol><ci id="A1.E11.m1.4.4.2.2.1.1.2.2.2.2.2.cmml" xref="A1.E11.m1.4.4.2.2.1.1.2.2.2.2.2">𝑔</ci><ci id="A1.E11.m1.4.4.2.2.1.1.2.2.2.2.3.cmml" xref="A1.E11.m1.4.4.2.2.1.1.2.2.2.2.3">𝑡</ci></apply><ci id="A1.E11.m1.4.4.2.2.1.1.2.2.2.3.cmml" xref="A1.E11.m1.4.4.2.2.1.1.2.2.2.3">𝑘</ci></apply></list></apply></apply><apply id="A1.E11.m1.6.6.4.cmml" xref="A1.E11.m1.6.6.4"><apply id="A1.E11.m1.6.6.4.3.cmml" xref="A1.E11.m1.6.6.4.3"><csymbol cd="ambiguous" id="A1.E11.m1.6.6.4.3.1.cmml" xref="A1.E11.m1.6.6.4.3">superscript</csymbol><apply id="A1.E11.m1.6.6.4.3.2.cmml" xref="A1.E11.m1.6.6.4.3"><csymbol cd="ambiguous" id="A1.E11.m1.6.6.4.3.2.1.cmml" xref="A1.E11.m1.6.6.4.3">subscript</csymbol><sum id="A1.E11.m1.6.6.4.3.2.2.cmml" xref="A1.E11.m1.6.6.4.3.2.2"></sum><apply id="A1.E11.m1.6.6.4.3.2.3.cmml" xref="A1.E11.m1.6.6.4.3.2.3"><eq id="A1.E11.m1.6.6.4.3.2.3.1.cmml" xref="A1.E11.m1.6.6.4.3.2.3.1"></eq><ci id="A1.E11.m1.6.6.4.3.2.3.2.cmml" xref="A1.E11.m1.6.6.4.3.2.3.2">𝑙</ci><cn type="integer" id="A1.E11.m1.6.6.4.3.2.3.3.cmml" xref="A1.E11.m1.6.6.4.3.2.3.3">0</cn></apply></apply><apply id="A1.E11.m1.6.6.4.3.3.cmml" xref="A1.E11.m1.6.6.4.3.3"><minus id="A1.E11.m1.6.6.4.3.3.1.cmml" xref="A1.E11.m1.6.6.4.3.3.1"></minus><ci id="A1.E11.m1.6.6.4.3.3.2.cmml" xref="A1.E11.m1.6.6.4.3.3.2">𝑁</ci><cn type="integer" id="A1.E11.m1.6.6.4.3.3.3.cmml" xref="A1.E11.m1.6.6.4.3.3.3">1</cn></apply></apply><apply id="A1.E11.m1.6.6.4.2.2.cmml" xref="A1.E11.m1.6.6.4.2.1"><exp id="A1.E11.m1.5.5.3.1.cmml" xref="A1.E11.m1.5.5.3.1"></exp><apply id="A1.E11.m1.6.6.4.2.1.1.1.cmml" xref="A1.E11.m1.6.6.4.2.1.1.1"><ci id="A1.E11.m1.6.6.4.2.1.1.1.3.cmml" xref="A1.E11.m1.6.6.4.2.1.1.1.3">⋅</ci><apply id="A1.E11.m1.6.6.4.2.1.1.1.4.cmml" xref="A1.E11.m1.6.6.4.2.1.1.1.4"><csymbol cd="ambiguous" id="A1.E11.m1.6.6.4.2.1.1.1.4.1.cmml" xref="A1.E11.m1.6.6.4.2.1.1.1.4">subscript</csymbol><ci id="A1.E11.m1.6.6.4.2.1.1.1.4.2.cmml" xref="A1.E11.m1.6.6.4.2.1.1.1.4.2">𝜏</ci><ci id="A1.E11.m1.6.6.4.2.1.1.1.4.3.cmml" xref="A1.E11.m1.6.6.4.2.1.1.1.4.3">individual</ci></apply><list id="A1.E11.m1.6.6.4.2.1.1.1.2.3.cmml" xref="A1.E11.m1.6.6.4.2.1.1.1.2.2"><apply id="A1.E11.m1.6.6.4.2.1.1.1.1.1.1.cmml" xref="A1.E11.m1.6.6.4.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E11.m1.6.6.4.2.1.1.1.1.1.1.1.cmml" xref="A1.E11.m1.6.6.4.2.1.1.1.1.1.1">superscript</csymbol><apply id="A1.E11.m1.6.6.4.2.1.1.1.1.1.1.2.cmml" xref="A1.E11.m1.6.6.4.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E11.m1.6.6.4.2.1.1.1.1.1.1.2.1.cmml" xref="A1.E11.m1.6.6.4.2.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E11.m1.6.6.4.2.1.1.1.1.1.1.2.2.cmml" xref="A1.E11.m1.6.6.4.2.1.1.1.1.1.1.2.2">𝑔</ci><ci id="A1.E11.m1.6.6.4.2.1.1.1.1.1.1.2.3.cmml" xref="A1.E11.m1.6.6.4.2.1.1.1.1.1.1.2.3">𝑣</ci></apply><ci id="A1.E11.m1.6.6.4.2.1.1.1.1.1.1.3.cmml" xref="A1.E11.m1.6.6.4.2.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="A1.E11.m1.6.6.4.2.1.1.1.2.2.2.cmml" xref="A1.E11.m1.6.6.4.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.E11.m1.6.6.4.2.1.1.1.2.2.2.1.cmml" xref="A1.E11.m1.6.6.4.2.1.1.1.2.2.2">superscript</csymbol><apply id="A1.E11.m1.6.6.4.2.1.1.1.2.2.2.2.cmml" xref="A1.E11.m1.6.6.4.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.E11.m1.6.6.4.2.1.1.1.2.2.2.2.1.cmml" xref="A1.E11.m1.6.6.4.2.1.1.1.2.2.2">subscript</csymbol><ci id="A1.E11.m1.6.6.4.2.1.1.1.2.2.2.2.2.cmml" xref="A1.E11.m1.6.6.4.2.1.1.1.2.2.2.2.2">𝑔</ci><ci id="A1.E11.m1.6.6.4.2.1.1.1.2.2.2.2.3.cmml" xref="A1.E11.m1.6.6.4.2.1.1.1.2.2.2.2.3">𝑡</ci></apply><ci id="A1.E11.m1.6.6.4.2.1.1.1.2.2.2.3.cmml" xref="A1.E11.m1.6.6.4.2.1.1.1.2.2.2.3">𝑙</ci></apply></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E11.m1.7c">\displaystyle q_{v,t}^{k}=\frac{\exp(\tau_{\mathrm{individual}}\cdot\langle g_{v}^{k},g_{t}^{k}\rangle)}{\sum_{l=0}^{N-1}\exp(\tau_{\mathrm{individual}}\cdot\langle g_{v}^{k},g_{t}^{l}\rangle)},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p id="A1.p8.3" class="ltx_p">respectively, where <math id="A1.p8.3.m1.1" class="ltx_Math" alttext="\tau_{\mathrm{individual}}" display="inline"><semantics id="A1.p8.3.m1.1a"><msub id="A1.p8.3.m1.1.1" xref="A1.p8.3.m1.1.1.cmml"><mi id="A1.p8.3.m1.1.1.2" xref="A1.p8.3.m1.1.1.2.cmml">τ</mi><mi id="A1.p8.3.m1.1.1.3" xref="A1.p8.3.m1.1.1.3.cmml">individual</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p8.3.m1.1b"><apply id="A1.p8.3.m1.1.1.cmml" xref="A1.p8.3.m1.1.1"><csymbol cd="ambiguous" id="A1.p8.3.m1.1.1.1.cmml" xref="A1.p8.3.m1.1.1">subscript</csymbol><ci id="A1.p8.3.m1.1.1.2.cmml" xref="A1.p8.3.m1.1.1.2">𝜏</ci><ci id="A1.p8.3.m1.1.1.3.cmml" xref="A1.p8.3.m1.1.1.3">individual</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p8.3.m1.1c">\tau_{\mathrm{individual}}</annotation></semantics></math> is the temperature to re-scale the cosine similarity.</p>
</div>
<div id="A1.p9" class="ltx_para">
<p id="A1.p9.4" class="ltx_p">On OV-COCO, we set <math id="A1.p9.1.m1.1" class="ltx_Math" alttext="\tau_{\mathrm{bag}}=30.0" display="inline"><semantics id="A1.p9.1.m1.1a"><mrow id="A1.p9.1.m1.1.1" xref="A1.p9.1.m1.1.1.cmml"><msub id="A1.p9.1.m1.1.1.2" xref="A1.p9.1.m1.1.1.2.cmml"><mi id="A1.p9.1.m1.1.1.2.2" xref="A1.p9.1.m1.1.1.2.2.cmml">τ</mi><mi id="A1.p9.1.m1.1.1.2.3" xref="A1.p9.1.m1.1.1.2.3.cmml">bag</mi></msub><mo id="A1.p9.1.m1.1.1.1" xref="A1.p9.1.m1.1.1.1.cmml">=</mo><mn id="A1.p9.1.m1.1.1.3" xref="A1.p9.1.m1.1.1.3.cmml">30.0</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p9.1.m1.1b"><apply id="A1.p9.1.m1.1.1.cmml" xref="A1.p9.1.m1.1.1"><eq id="A1.p9.1.m1.1.1.1.cmml" xref="A1.p9.1.m1.1.1.1"></eq><apply id="A1.p9.1.m1.1.1.2.cmml" xref="A1.p9.1.m1.1.1.2"><csymbol cd="ambiguous" id="A1.p9.1.m1.1.1.2.1.cmml" xref="A1.p9.1.m1.1.1.2">subscript</csymbol><ci id="A1.p9.1.m1.1.1.2.2.cmml" xref="A1.p9.1.m1.1.1.2.2">𝜏</ci><ci id="A1.p9.1.m1.1.1.2.3.cmml" xref="A1.p9.1.m1.1.1.2.3">bag</ci></apply><cn type="float" id="A1.p9.1.m1.1.1.3.cmml" xref="A1.p9.1.m1.1.1.3">30.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p9.1.m1.1c">\tau_{\mathrm{bag}}=30.0</annotation></semantics></math> and <math id="A1.p9.2.m2.1" class="ltx_Math" alttext="\tau_{\mathrm{individual}}=50.0" display="inline"><semantics id="A1.p9.2.m2.1a"><mrow id="A1.p9.2.m2.1.1" xref="A1.p9.2.m2.1.1.cmml"><msub id="A1.p9.2.m2.1.1.2" xref="A1.p9.2.m2.1.1.2.cmml"><mi id="A1.p9.2.m2.1.1.2.2" xref="A1.p9.2.m2.1.1.2.2.cmml">τ</mi><mi id="A1.p9.2.m2.1.1.2.3" xref="A1.p9.2.m2.1.1.2.3.cmml">individual</mi></msub><mo id="A1.p9.2.m2.1.1.1" xref="A1.p9.2.m2.1.1.1.cmml">=</mo><mn id="A1.p9.2.m2.1.1.3" xref="A1.p9.2.m2.1.1.3.cmml">50.0</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p9.2.m2.1b"><apply id="A1.p9.2.m2.1.1.cmml" xref="A1.p9.2.m2.1.1"><eq id="A1.p9.2.m2.1.1.1.cmml" xref="A1.p9.2.m2.1.1.1"></eq><apply id="A1.p9.2.m2.1.1.2.cmml" xref="A1.p9.2.m2.1.1.2"><csymbol cd="ambiguous" id="A1.p9.2.m2.1.1.2.1.cmml" xref="A1.p9.2.m2.1.1.2">subscript</csymbol><ci id="A1.p9.2.m2.1.1.2.2.cmml" xref="A1.p9.2.m2.1.1.2.2">𝜏</ci><ci id="A1.p9.2.m2.1.1.2.3.cmml" xref="A1.p9.2.m2.1.1.2.3">individual</ci></apply><cn type="float" id="A1.p9.2.m2.1.1.3.cmml" xref="A1.p9.2.m2.1.1.3">50.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p9.2.m2.1c">\tau_{\mathrm{individual}}=50.0</annotation></semantics></math>. Since there are finer-grained definition of categories and denser distribution of object boxes in the LVIS dataset, we set <math id="A1.p9.3.m3.1" class="ltx_Math" alttext="\tau_{\mathrm{bag}}=20.0" display="inline"><semantics id="A1.p9.3.m3.1a"><mrow id="A1.p9.3.m3.1.1" xref="A1.p9.3.m3.1.1.cmml"><msub id="A1.p9.3.m3.1.1.2" xref="A1.p9.3.m3.1.1.2.cmml"><mi id="A1.p9.3.m3.1.1.2.2" xref="A1.p9.3.m3.1.1.2.2.cmml">τ</mi><mi id="A1.p9.3.m3.1.1.2.3" xref="A1.p9.3.m3.1.1.2.3.cmml">bag</mi></msub><mo id="A1.p9.3.m3.1.1.1" xref="A1.p9.3.m3.1.1.1.cmml">=</mo><mn id="A1.p9.3.m3.1.1.3" xref="A1.p9.3.m3.1.1.3.cmml">20.0</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p9.3.m3.1b"><apply id="A1.p9.3.m3.1.1.cmml" xref="A1.p9.3.m3.1.1"><eq id="A1.p9.3.m3.1.1.1.cmml" xref="A1.p9.3.m3.1.1.1"></eq><apply id="A1.p9.3.m3.1.1.2.cmml" xref="A1.p9.3.m3.1.1.2"><csymbol cd="ambiguous" id="A1.p9.3.m3.1.1.2.1.cmml" xref="A1.p9.3.m3.1.1.2">subscript</csymbol><ci id="A1.p9.3.m3.1.1.2.2.cmml" xref="A1.p9.3.m3.1.1.2.2">𝜏</ci><ci id="A1.p9.3.m3.1.1.2.3.cmml" xref="A1.p9.3.m3.1.1.2.3">bag</ci></apply><cn type="float" id="A1.p9.3.m3.1.1.3.cmml" xref="A1.p9.3.m3.1.1.3">20.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p9.3.m3.1c">\tau_{\mathrm{bag}}=20.0</annotation></semantics></math> and <math id="A1.p9.4.m4.1" class="ltx_Math" alttext="\tau_{\mathrm{individual}}=30.0" display="inline"><semantics id="A1.p9.4.m4.1a"><mrow id="A1.p9.4.m4.1.1" xref="A1.p9.4.m4.1.1.cmml"><msub id="A1.p9.4.m4.1.1.2" xref="A1.p9.4.m4.1.1.2.cmml"><mi id="A1.p9.4.m4.1.1.2.2" xref="A1.p9.4.m4.1.1.2.2.cmml">τ</mi><mi id="A1.p9.4.m4.1.1.2.3" xref="A1.p9.4.m4.1.1.2.3.cmml">individual</mi></msub><mo id="A1.p9.4.m4.1.1.1" xref="A1.p9.4.m4.1.1.1.cmml">=</mo><mn id="A1.p9.4.m4.1.1.3" xref="A1.p9.4.m4.1.1.3.cmml">30.0</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p9.4.m4.1b"><apply id="A1.p9.4.m4.1.1.cmml" xref="A1.p9.4.m4.1.1"><eq id="A1.p9.4.m4.1.1.1.cmml" xref="A1.p9.4.m4.1.1.1"></eq><apply id="A1.p9.4.m4.1.1.2.cmml" xref="A1.p9.4.m4.1.1.2"><csymbol cd="ambiguous" id="A1.p9.4.m4.1.1.2.1.cmml" xref="A1.p9.4.m4.1.1.2">subscript</csymbol><ci id="A1.p9.4.m4.1.1.2.2.cmml" xref="A1.p9.4.m4.1.1.2.2">𝜏</ci><ci id="A1.p9.4.m4.1.1.2.3.cmml" xref="A1.p9.4.m4.1.1.2.3">individual</ci></apply><cn type="float" id="A1.p9.4.m4.1.1.3.cmml" xref="A1.p9.4.m4.1.1.3">30.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p9.4.m4.1c">\tau_{\mathrm{individual}}=30.0</annotation></semantics></math> on OV-LVIS to make the contrastive learning harder.</p>
</div>
<figure id="A1.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="A1.T1.5.1.1" class="ltx_text" style="font-size:90%;">Table A1</span>: </span><span id="A1.T1.6.2" class="ltx_text" style="font-size:90%;">
Number of linear layers (#Layers) mapping region features to pseudo-words
</span></figcaption>
<div id="A1.T1.3" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:116.7pt;height:72pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1.0,1.0) ;">
<table id="A1.T1.3.3" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A1.T1.3.3.3" class="ltx_tr">
<th id="A1.T1.3.3.3.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="A1.T1.3.3.3.4.1" class="ltx_text" style="font-size:90%;">#Layers</span></th>
<th id="A1.T1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding:0.45pt 3.0pt;">
<span id="A1.T1.1.1.1.1.1" class="ltx_text" style="font-size:90%;">AP</span><math id="A1.T1.1.1.1.1.m1.1" class="ltx_Math" alttext="{}_{50}^{\text{novel}}" display="inline"><semantics id="A1.T1.1.1.1.1.m1.1a"><mmultiscripts id="A1.T1.1.1.1.1.m1.1.1" xref="A1.T1.1.1.1.1.m1.1.1.cmml"><mi id="A1.T1.1.1.1.1.m1.1.1.2.2" xref="A1.T1.1.1.1.1.m1.1.1.2.2.cmml"></mi><mprescripts id="A1.T1.1.1.1.1.m1.1.1a" xref="A1.T1.1.1.1.1.m1.1.1.cmml"></mprescripts><mrow id="A1.T1.1.1.1.1.m1.1.1b" xref="A1.T1.1.1.1.1.m1.1.1.cmml"></mrow><mtext mathsize="90%" id="A1.T1.1.1.1.1.m1.1.1.3" xref="A1.T1.1.1.1.1.m1.1.1.3a.cmml">novel</mtext><mn mathsize="90%" id="A1.T1.1.1.1.1.m1.1.1.2.3" xref="A1.T1.1.1.1.1.m1.1.1.2.3.cmml">50</mn><mrow id="A1.T1.1.1.1.1.m1.1.1c" xref="A1.T1.1.1.1.1.m1.1.1.cmml"></mrow></mmultiscripts><annotation-xml encoding="MathML-Content" id="A1.T1.1.1.1.1.m1.1b"><apply id="A1.T1.1.1.1.1.m1.1.1.cmml" xref="A1.T1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.T1.1.1.1.1.m1.1.1.1.cmml" xref="A1.T1.1.1.1.1.m1.1.1">superscript</csymbol><apply id="A1.T1.1.1.1.1.m1.1.1.2.cmml" xref="A1.T1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.T1.1.1.1.1.m1.1.1.2.1.cmml" xref="A1.T1.1.1.1.1.m1.1.1">subscript</csymbol><csymbol cd="latexml" id="A1.T1.1.1.1.1.m1.1.1.2.2.cmml" xref="A1.T1.1.1.1.1.m1.1.1.2.2">absent</csymbol><cn type="integer" id="A1.T1.1.1.1.1.m1.1.1.2.3.cmml" xref="A1.T1.1.1.1.1.m1.1.1.2.3">50</cn></apply><ci id="A1.T1.1.1.1.1.m1.1.1.3a.cmml" xref="A1.T1.1.1.1.1.m1.1.1.3"><mtext mathsize="63%" id="A1.T1.1.1.1.1.m1.1.1.3.cmml" xref="A1.T1.1.1.1.1.m1.1.1.3">novel</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.1.1.1.1.m1.1c">{}_{50}^{\text{novel}}</annotation></semantics></math>
</th>
<th id="A1.T1.2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding:0.45pt 3.0pt;">
<span id="A1.T1.2.2.2.2.1" class="ltx_text" style="font-size:90%;">AP</span><math id="A1.T1.2.2.2.2.m1.1" class="ltx_Math" alttext="{}_{50}^{\text{base}}" display="inline"><semantics id="A1.T1.2.2.2.2.m1.1a"><mmultiscripts id="A1.T1.2.2.2.2.m1.1.1" xref="A1.T1.2.2.2.2.m1.1.1.cmml"><mi id="A1.T1.2.2.2.2.m1.1.1.2.2" xref="A1.T1.2.2.2.2.m1.1.1.2.2.cmml"></mi><mprescripts id="A1.T1.2.2.2.2.m1.1.1a" xref="A1.T1.2.2.2.2.m1.1.1.cmml"></mprescripts><mrow id="A1.T1.2.2.2.2.m1.1.1b" xref="A1.T1.2.2.2.2.m1.1.1.cmml"></mrow><mtext mathsize="90%" id="A1.T1.2.2.2.2.m1.1.1.3" xref="A1.T1.2.2.2.2.m1.1.1.3a.cmml">base</mtext><mn mathsize="90%" id="A1.T1.2.2.2.2.m1.1.1.2.3" xref="A1.T1.2.2.2.2.m1.1.1.2.3.cmml">50</mn><mrow id="A1.T1.2.2.2.2.m1.1.1c" xref="A1.T1.2.2.2.2.m1.1.1.cmml"></mrow></mmultiscripts><annotation-xml encoding="MathML-Content" id="A1.T1.2.2.2.2.m1.1b"><apply id="A1.T1.2.2.2.2.m1.1.1.cmml" xref="A1.T1.2.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="A1.T1.2.2.2.2.m1.1.1.1.cmml" xref="A1.T1.2.2.2.2.m1.1.1">superscript</csymbol><apply id="A1.T1.2.2.2.2.m1.1.1.2.cmml" xref="A1.T1.2.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="A1.T1.2.2.2.2.m1.1.1.2.1.cmml" xref="A1.T1.2.2.2.2.m1.1.1">subscript</csymbol><csymbol cd="latexml" id="A1.T1.2.2.2.2.m1.1.1.2.2.cmml" xref="A1.T1.2.2.2.2.m1.1.1.2.2">absent</csymbol><cn type="integer" id="A1.T1.2.2.2.2.m1.1.1.2.3.cmml" xref="A1.T1.2.2.2.2.m1.1.1.2.3">50</cn></apply><ci id="A1.T1.2.2.2.2.m1.1.1.3a.cmml" xref="A1.T1.2.2.2.2.m1.1.1.3"><mtext mathsize="63%" id="A1.T1.2.2.2.2.m1.1.1.3.cmml" xref="A1.T1.2.2.2.2.m1.1.1.3">base</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.2.2.2.2.m1.1c">{}_{50}^{\text{base}}</annotation></semantics></math>
</th>
<th id="A1.T1.3.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding:0.45pt 3.0pt;">
<span id="A1.T1.3.3.3.3.1" class="ltx_text" style="font-size:90%;">AP</span><sub id="A1.T1.3.3.3.3.2" class="ltx_sub"><span id="A1.T1.3.3.3.3.2.1" class="ltx_text ltx_font_italic" style="font-size:90%;">50</span></sub>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A1.T1.3.3.4.1" class="ltx_tr">
<th id="A1.T1.3.3.4.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="A1.T1.3.3.4.1.1.1" class="ltx_text" style="font-size:90%;">1</span></th>
<td id="A1.T1.3.3.4.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="A1.T1.3.3.4.1.2.1" class="ltx_text" style="font-size:90%;">34.0</span></td>
<td id="A1.T1.3.3.4.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="A1.T1.3.3.4.1.3.1" class="ltx_text" style="font-size:90%;">60.4</span></td>
<td id="A1.T1.3.3.4.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="A1.T1.3.3.4.1.4.1" class="ltx_text" style="font-size:90%;">53.5</span></td>
</tr>
<tr id="A1.T1.3.3.5.2" class="ltx_tr">
<th id="A1.T1.3.3.5.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="A1.T1.3.3.5.2.1.1" class="ltx_text" style="font-size:90%;">2</span></th>
<td id="A1.T1.3.3.5.2.2" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="A1.T1.3.3.5.2.2.1" class="ltx_text" style="font-size:90%;">33.9</span></td>
<td id="A1.T1.3.3.5.2.3" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="A1.T1.3.3.5.2.3.1" class="ltx_text" style="font-size:90%;">60.5</span></td>
<td id="A1.T1.3.3.5.2.4" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="A1.T1.3.3.5.2.4.1" class="ltx_text" style="font-size:90%;">53.5</span></td>
</tr>
<tr id="A1.T1.3.3.6.3" class="ltx_tr">
<th id="A1.T1.3.3.6.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="A1.T1.3.3.6.3.1.1" class="ltx_text" style="font-size:90%;">3</span></th>
<td id="A1.T1.3.3.6.3.2" class="ltx_td ltx_align_center ltx_border_b" style="padding:0.45pt 3.0pt;"><span id="A1.T1.3.3.6.3.2.1" class="ltx_text" style="font-size:90%;">34.1</span></td>
<td id="A1.T1.3.3.6.3.3" class="ltx_td ltx_align_center ltx_border_b" style="padding:0.45pt 3.0pt;"><span id="A1.T1.3.3.6.3.3.1" class="ltx_text" style="font-size:90%;">60.8</span></td>
<td id="A1.T1.3.3.6.3.4" class="ltx_td ltx_align_center ltx_border_b" style="padding:0.45pt 3.0pt;"><span id="A1.T1.3.3.6.3.4.1" class="ltx_text" style="font-size:90%;">53.8</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="A1.p10" class="ltx_para ltx_noindent">
<p id="A1.p10.1" class="ltx_p"><span id="A1.p10.1.1" class="ltx_text ltx_font_bold">Mapping Region Features to Pseudo-words.</span> In our implementation, we used a single linear layer to map region features from the detector to pseudo-words. In Table <a href="#A1.T1" title="Table A1 ‣ Appendix A1 Implementation Details ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A1</span></a>, we show that adding more linear layers (#Layers) brings no noticeable improvements. This observation is also in line with Maaz <em id="A1.p10.1.2" class="ltx_emph ltx_font_italic">et al</em>.<span id="A1.p10.1.3" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite> that visual properties can be transferred to language models (LMs) by linearly mapping visual features to the input space of LMs.</p>
</div>
<div id="A1.p11" class="ltx_para ltx_noindent">
<p id="A1.p11.2" class="ltx_p"><span id="A1.p11.2.1" class="ltx_text ltx_font_bold">Random Word Dropout.</span> As we apply two different supervision to the pseudo words, the training can lead certain words to overfit to certain losses. To alleviate overfitting, we borrow the idea of Dropout <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite> in neural networks where neurons are randomly dropped during training to avoid overfitting to specific neurons. We randomly discard pseudo words for each region with a probability <math id="A1.p11.1.m1.1" class="ltx_Math" alttext="p_{\mathrm{drop}}" display="inline"><semantics id="A1.p11.1.m1.1a"><msub id="A1.p11.1.m1.1.1" xref="A1.p11.1.m1.1.1.cmml"><mi id="A1.p11.1.m1.1.1.2" xref="A1.p11.1.m1.1.1.2.cmml">p</mi><mi id="A1.p11.1.m1.1.1.3" xref="A1.p11.1.m1.1.1.3.cmml">drop</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p11.1.m1.1b"><apply id="A1.p11.1.m1.1.1.cmml" xref="A1.p11.1.m1.1.1"><csymbol cd="ambiguous" id="A1.p11.1.m1.1.1.1.cmml" xref="A1.p11.1.m1.1.1">subscript</csymbol><ci id="A1.p11.1.m1.1.1.2.cmml" xref="A1.p11.1.m1.1.1.2">𝑝</ci><ci id="A1.p11.1.m1.1.1.3.cmml" xref="A1.p11.1.m1.1.1.3">drop</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p11.1.m1.1c">p_{\mathrm{drop}}</annotation></semantics></math>. By default, we set <math id="A1.p11.2.m2.1" class="ltx_Math" alttext="p_{\mathrm{drop}}=0.5" display="inline"><semantics id="A1.p11.2.m2.1a"><mrow id="A1.p11.2.m2.1.1" xref="A1.p11.2.m2.1.1.cmml"><msub id="A1.p11.2.m2.1.1.2" xref="A1.p11.2.m2.1.1.2.cmml"><mi id="A1.p11.2.m2.1.1.2.2" xref="A1.p11.2.m2.1.1.2.2.cmml">p</mi><mi id="A1.p11.2.m2.1.1.2.3" xref="A1.p11.2.m2.1.1.2.3.cmml">drop</mi></msub><mo id="A1.p11.2.m2.1.1.1" xref="A1.p11.2.m2.1.1.1.cmml">=</mo><mn id="A1.p11.2.m2.1.1.3" xref="A1.p11.2.m2.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p11.2.m2.1b"><apply id="A1.p11.2.m2.1.1.cmml" xref="A1.p11.2.m2.1.1"><eq id="A1.p11.2.m2.1.1.1.cmml" xref="A1.p11.2.m2.1.1.1"></eq><apply id="A1.p11.2.m2.1.1.2.cmml" xref="A1.p11.2.m2.1.1.2"><csymbol cd="ambiguous" id="A1.p11.2.m2.1.1.2.1.cmml" xref="A1.p11.2.m2.1.1.2">subscript</csymbol><ci id="A1.p11.2.m2.1.1.2.2.cmml" xref="A1.p11.2.m2.1.1.2.2">𝑝</ci><ci id="A1.p11.2.m2.1.1.2.3.cmml" xref="A1.p11.2.m2.1.1.2.3">drop</ci></apply><cn type="float" id="A1.p11.2.m2.1.1.3.cmml" xref="A1.p11.2.m2.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p11.2.m2.1c">p_{\mathrm{drop}}=0.5</annotation></semantics></math> for training on both OV-COCO and OV-LVIS.</p>
</div>
<div id="A1.p12" class="ltx_para ltx_noindent">
<p id="A1.p12.1" class="ltx_p"><span id="A1.p12.1.1" class="ltx_text ltx_font_bold">Suppression on Novel Categories.</span>
On OV-COCO, we observe a tendency to overfit on base categories due to the smaller number of categories. And compared with OV-LVIS where the tail categories act as the novel categories, the distribution of novel and base categories on COCO is more balanced. We adopt the following strategies to alleviate suppression on novel categories: (1) detach the objectness prediction branch so that the suppression onto novel categories would not be back-propagated to the backbone; (2) save the sampled region proposals into a cache so that regions covering potential novel categories detected in certain iteration can be preserved throughout the training phase; (3) use the output of the second last layer of the VLM (CLIP) for classification and the final output for aligning bag of regions to reduce the competition between the two types of losses.</p>
</div>
<figure id="A1.F1" class="ltx_figure"><img src="/html/2302.13996/assets/figs/compare_sampling.jpg" id="A1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="592" height="113" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A1.F1.2.1.1" class="ltx_text" style="font-size:90%;">Figure A1</span>: </span><span id="A1.F1.3.2" class="ltx_text" style="font-size:90%;">Comparisons of different sampling strategies. Green boxes denote the region proposals. Blue boxes stand for sampled region boxes. The purple box represents the image crop of a bag of regions (a region group).</span></figcaption>
</figure>
<figure id="A1.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="A1.T2.5.1.1" class="ltx_text" style="font-size:90%;">Table A2</span>: </span><span id="A1.T2.6.2" class="ltx_text" style="font-size:90%;">
Different sampling strategies
</span></figcaption>
<div id="A1.T2.3" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:210.2pt;height:126pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1.0,1.0) ;">
<table id="A1.T2.3.3" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A1.T2.3.3.3" class="ltx_tr">
<th id="A1.T2.3.3.3.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="A1.T2.3.3.3.4.1" class="ltx_text" style="font-size:90%;">#</span></th>
<th id="A1.T2.3.3.3.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="A1.T2.3.3.3.5.1" class="ltx_text" style="font-size:90%;">Strategy</span></th>
<th id="A1.T2.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding:0.45pt 3.0pt;">
<span id="A1.T2.1.1.1.1.1" class="ltx_text" style="font-size:90%;">AP</span><math id="A1.T2.1.1.1.1.m1.1" class="ltx_Math" alttext="{}_{50}^{\text{novel}}" display="inline"><semantics id="A1.T2.1.1.1.1.m1.1a"><mmultiscripts id="A1.T2.1.1.1.1.m1.1.1" xref="A1.T2.1.1.1.1.m1.1.1.cmml"><mi id="A1.T2.1.1.1.1.m1.1.1.2.2" xref="A1.T2.1.1.1.1.m1.1.1.2.2.cmml"></mi><mprescripts id="A1.T2.1.1.1.1.m1.1.1a" xref="A1.T2.1.1.1.1.m1.1.1.cmml"></mprescripts><mrow id="A1.T2.1.1.1.1.m1.1.1b" xref="A1.T2.1.1.1.1.m1.1.1.cmml"></mrow><mtext mathsize="90%" id="A1.T2.1.1.1.1.m1.1.1.3" xref="A1.T2.1.1.1.1.m1.1.1.3a.cmml">novel</mtext><mn mathsize="90%" id="A1.T2.1.1.1.1.m1.1.1.2.3" xref="A1.T2.1.1.1.1.m1.1.1.2.3.cmml">50</mn><mrow id="A1.T2.1.1.1.1.m1.1.1c" xref="A1.T2.1.1.1.1.m1.1.1.cmml"></mrow></mmultiscripts><annotation-xml encoding="MathML-Content" id="A1.T2.1.1.1.1.m1.1b"><apply id="A1.T2.1.1.1.1.m1.1.1.cmml" xref="A1.T2.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.T2.1.1.1.1.m1.1.1.1.cmml" xref="A1.T2.1.1.1.1.m1.1.1">superscript</csymbol><apply id="A1.T2.1.1.1.1.m1.1.1.2.cmml" xref="A1.T2.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.T2.1.1.1.1.m1.1.1.2.1.cmml" xref="A1.T2.1.1.1.1.m1.1.1">subscript</csymbol><csymbol cd="latexml" id="A1.T2.1.1.1.1.m1.1.1.2.2.cmml" xref="A1.T2.1.1.1.1.m1.1.1.2.2">absent</csymbol><cn type="integer" id="A1.T2.1.1.1.1.m1.1.1.2.3.cmml" xref="A1.T2.1.1.1.1.m1.1.1.2.3">50</cn></apply><ci id="A1.T2.1.1.1.1.m1.1.1.3a.cmml" xref="A1.T2.1.1.1.1.m1.1.1.3"><mtext mathsize="63%" id="A1.T2.1.1.1.1.m1.1.1.3.cmml" xref="A1.T2.1.1.1.1.m1.1.1.3">novel</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.1.1.1.1.m1.1c">{}_{50}^{\text{novel}}</annotation></semantics></math>
</th>
<th id="A1.T2.2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding:0.45pt 3.0pt;">
<span id="A1.T2.2.2.2.2.1" class="ltx_text" style="font-size:90%;">AP</span><math id="A1.T2.2.2.2.2.m1.1" class="ltx_Math" alttext="{}_{50}^{\text{base}}" display="inline"><semantics id="A1.T2.2.2.2.2.m1.1a"><mmultiscripts id="A1.T2.2.2.2.2.m1.1.1" xref="A1.T2.2.2.2.2.m1.1.1.cmml"><mi id="A1.T2.2.2.2.2.m1.1.1.2.2" xref="A1.T2.2.2.2.2.m1.1.1.2.2.cmml"></mi><mprescripts id="A1.T2.2.2.2.2.m1.1.1a" xref="A1.T2.2.2.2.2.m1.1.1.cmml"></mprescripts><mrow id="A1.T2.2.2.2.2.m1.1.1b" xref="A1.T2.2.2.2.2.m1.1.1.cmml"></mrow><mtext mathsize="90%" id="A1.T2.2.2.2.2.m1.1.1.3" xref="A1.T2.2.2.2.2.m1.1.1.3a.cmml">base</mtext><mn mathsize="90%" id="A1.T2.2.2.2.2.m1.1.1.2.3" xref="A1.T2.2.2.2.2.m1.1.1.2.3.cmml">50</mn><mrow id="A1.T2.2.2.2.2.m1.1.1c" xref="A1.T2.2.2.2.2.m1.1.1.cmml"></mrow></mmultiscripts><annotation-xml encoding="MathML-Content" id="A1.T2.2.2.2.2.m1.1b"><apply id="A1.T2.2.2.2.2.m1.1.1.cmml" xref="A1.T2.2.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="A1.T2.2.2.2.2.m1.1.1.1.cmml" xref="A1.T2.2.2.2.2.m1.1.1">superscript</csymbol><apply id="A1.T2.2.2.2.2.m1.1.1.2.cmml" xref="A1.T2.2.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="A1.T2.2.2.2.2.m1.1.1.2.1.cmml" xref="A1.T2.2.2.2.2.m1.1.1">subscript</csymbol><csymbol cd="latexml" id="A1.T2.2.2.2.2.m1.1.1.2.2.cmml" xref="A1.T2.2.2.2.2.m1.1.1.2.2">absent</csymbol><cn type="integer" id="A1.T2.2.2.2.2.m1.1.1.2.3.cmml" xref="A1.T2.2.2.2.2.m1.1.1.2.3">50</cn></apply><ci id="A1.T2.2.2.2.2.m1.1.1.3a.cmml" xref="A1.T2.2.2.2.2.m1.1.1.3"><mtext mathsize="63%" id="A1.T2.2.2.2.2.m1.1.1.3.cmml" xref="A1.T2.2.2.2.2.m1.1.1.3">base</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.2.2.2.2.m1.1c">{}_{50}^{\text{base}}</annotation></semantics></math>
</th>
<th id="A1.T2.3.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding:0.45pt 3.0pt;">
<span id="A1.T2.3.3.3.3.1" class="ltx_text" style="font-size:90%;">AP</span><sub id="A1.T2.3.3.3.3.2" class="ltx_sub"><span id="A1.T2.3.3.3.3.2.1" class="ltx_text ltx_font_italic" style="font-size:90%;">50</span></sub>
</th>
<th id="A1.T2.3.3.3.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="A1.T2.3.3.3.6.1" class="ltx_text" style="font-size:90%;">#regions</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A1.T2.3.3.4.1" class="ltx_tr">
<td id="A1.T2.3.3.4.1.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="A1.T2.3.3.4.1.1.1" class="ltx_text" style="font-size:90%;">1</span></td>
<td id="A1.T2.3.3.4.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="A1.T2.3.3.4.1.2.1" class="ltx_text" style="font-size:90%;">Grid</span></td>
<td id="A1.T2.3.3.4.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="A1.T2.3.3.4.1.3.1" class="ltx_text" style="font-size:90%;">25.4</span></td>
<td id="A1.T2.3.3.4.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="A1.T2.3.3.4.1.4.1" class="ltx_text" style="font-size:90%;">58.0</span></td>
<td id="A1.T2.3.3.4.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="A1.T2.3.3.4.1.5.1" class="ltx_text" style="font-size:90%;">49.5</span></td>
<td id="A1.T2.3.3.4.1.6" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.45pt 3.0pt;"><span id="A1.T2.3.3.4.1.6.1" class="ltx_text" style="font-size:90%;">36</span></td>
</tr>
<tr id="A1.T2.3.3.5.2" class="ltx_tr">
<td id="A1.T2.3.3.5.2.1" class="ltx_td ltx_align_left ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="A1.T2.3.3.5.2.1.1" class="ltx_text" style="font-size:90%;">2</span></td>
<td id="A1.T2.3.3.5.2.2" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="A1.T2.3.3.5.2.2.1" class="ltx_text" style="font-size:90%;">Random</span></td>
<td id="A1.T2.3.3.5.2.3" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="A1.T2.3.3.5.2.3.1" class="ltx_text" style="font-size:90%;">27.3</span></td>
<td id="A1.T2.3.3.5.2.4" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="A1.T2.3.3.5.2.4.1" class="ltx_text" style="font-size:90%;">53.3</span></td>
<td id="A1.T2.3.3.5.2.5" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="A1.T2.3.3.5.2.5.1" class="ltx_text" style="font-size:90%;">46.5</span></td>
<td id="A1.T2.3.3.5.2.6" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="A1.T2.3.3.5.2.6.1" class="ltx_text" style="font-size:90%;">36</span></td>
</tr>
<tr id="A1.T2.3.3.6.3" class="ltx_tr">
<td id="A1.T2.3.3.6.3.1" class="ltx_td ltx_align_left ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="A1.T2.3.3.6.3.1.1" class="ltx_text" style="font-size:90%;">3</span></td>
<td id="A1.T2.3.3.6.3.2" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="A1.T2.3.3.6.3.2.1" class="ltx_text" style="font-size:90%;">Random-Tight</span></td>
<td id="A1.T2.3.3.6.3.3" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="A1.T2.3.3.6.3.3.1" class="ltx_text" style="font-size:90%;">29.5</span></td>
<td id="A1.T2.3.3.6.3.4" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="A1.T2.3.3.6.3.4.1" class="ltx_text" style="font-size:90%;">56.9</span></td>
<td id="A1.T2.3.3.6.3.5" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="A1.T2.3.3.6.3.5.1" class="ltx_text" style="font-size:90%;">49.7</span></td>
<td id="A1.T2.3.3.6.3.6" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="A1.T2.3.3.6.3.6.1" class="ltx_text" style="font-size:90%;">36</span></td>
</tr>
<tr id="A1.T2.3.3.7.4" class="ltx_tr">
<td id="A1.T2.3.3.7.4.1" class="ltx_td ltx_align_left ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="A1.T2.3.3.7.4.1.1" class="ltx_text" style="font-size:90%;">4</span></td>
<td id="A1.T2.3.3.7.4.2" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="A1.T2.3.3.7.4.2.1" class="ltx_text" style="font-size:90%;">Random-Neighbor</span></td>
<td id="A1.T2.3.3.7.4.3" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="A1.T2.3.3.7.4.3.1" class="ltx_text" style="font-size:90%;">30.7</span></td>
<td id="A1.T2.3.3.7.4.4" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="A1.T2.3.3.7.4.4.1" class="ltx_text" style="font-size:90%;">56.9</span></td>
<td id="A1.T2.3.3.7.4.5" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="A1.T2.3.3.7.4.5.1" class="ltx_text" style="font-size:90%;">50.0</span></td>
<td id="A1.T2.3.3.7.4.6" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="A1.T2.3.3.7.4.6.1" class="ltx_text" style="font-size:90%;">36</span></td>
</tr>
<tr id="A1.T2.3.3.8.5" class="ltx_tr">
<td id="A1.T2.3.3.8.5.1" class="ltx_td ltx_align_left ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="A1.T2.3.3.8.5.1.1" class="ltx_text" style="font-size:90%;">5</span></td>
<td id="A1.T2.3.3.8.5.2" class="ltx_td ltx_align_center ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="A1.T2.3.3.8.5.2.1" class="ltx_text" style="font-size:90%;">Ours (reduced)</span></td>
<td id="A1.T2.3.3.8.5.3" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="A1.T2.3.3.8.5.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">32.2</span></td>
<td id="A1.T2.3.3.8.5.4" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="A1.T2.3.3.8.5.4.1" class="ltx_text" style="font-size:90%;">58.3</span></td>
<td id="A1.T2.3.3.8.5.5" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="A1.T2.3.3.8.5.5.1" class="ltx_text" style="font-size:90%;">51.5</span></td>
<td id="A1.T2.3.3.8.5.6" class="ltx_td ltx_align_center" style="padding:0.45pt 3.0pt;"><span id="A1.T2.3.3.8.5.6.1" class="ltx_text" style="font-size:90%;">36</span></td>
</tr>
<tr id="A1.T2.3.3.9.6" class="ltx_tr">
<td id="A1.T2.3.3.9.6.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="A1.T2.3.3.9.6.1.1" class="ltx_text" style="font-size:90%;">6</span></td>
<td id="A1.T2.3.3.9.6.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r" style="padding:0.45pt 3.0pt;"><span id="A1.T2.3.3.9.6.2.1" class="ltx_text" style="font-size:90%;">Ours</span></td>
<td id="A1.T2.3.3.9.6.3" class="ltx_td ltx_align_center ltx_border_b" style="padding:0.45pt 3.0pt;"><span id="A1.T2.3.3.9.6.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">34.0</span></td>
<td id="A1.T2.3.3.9.6.4" class="ltx_td ltx_align_center ltx_border_b" style="padding:0.45pt 3.0pt;"><span id="A1.T2.3.3.9.6.4.1" class="ltx_text" style="font-size:90%;">60.4</span></td>
<td id="A1.T2.3.3.9.6.5" class="ltx_td ltx_align_center ltx_border_b" style="padding:0.45pt 3.0pt;"><span id="A1.T2.3.3.9.6.5.1" class="ltx_text" style="font-size:90%;">53.5</span></td>
<td id="A1.T2.3.3.9.6.6" class="ltx_td ltx_align_center ltx_border_b" style="padding:0.45pt 3.0pt;"><span id="A1.T2.3.3.9.6.6.1" class="ltx_text" style="font-size:90%;">216</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A2 </span>Sampling Strategy</h2>

<div id="A2.p1" class="ltx_para">
<p id="A2.p1.1" class="ltx_p">We have introduced two baseline sampling strategies, <em id="A2.p1.1.1" class="ltx_emph ltx_font_italic">i.e</em>. grid sampling and random sampling. The grid sampling strategy is to equally split an image into grids like the pre-training stage in OVR-CNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib56" title="" class="ltx_ref">56</a>]</cite>. And the random sampling strategy is to
randomly sample region proposals to form a bag of regions. These two baseline strategies let the bag of regions represent the whole image. We add two other strategies to shift the focus to neighboring (local) regions.</p>
</div>
<div id="A2.p2" class="ltx_para">
<p id="A2.p2.1" class="ltx_p">We start from the random sampling strategy and let the bag of regions represent the image crop that tightly encloses them instead of the whole image (dubbed as Random-Tight). Then we move to the neighborhood centered on region proposals (dubbed as Random-Neighbor). For each center region proposal, we randomly sample 2 nearby region proposals with GIOU larger than 0.5 to make a bag of regions. We randomly take 12 region proposals as centers so that the total number of regions is 36, ensuring a fair comparison with other strategies. Table <a href="#A1.T2" title="Table A2 ‣ Appendix A1 Implementation Details ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A2</span></a> shows the performance of these strategies.</p>
</div>
<div id="A2.p3" class="ltx_para">
<p id="A2.p3.1" class="ltx_p">In Fig <a href="#A1.F1" title="Fig. A1 ‣ Appendix A1 Implementation Details ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A1</span></a>, we show how these sampling strategies differ and how it gradually develops to our final option. In (a), we find the equally split grids may either contain too many objects or only small parts of an object. From (b) to (c), the bag of regions gradually shift to representing neighboring local regions from representing the whole image. However, we observe that there is always box size imbalance such as the left bottom bag of regions in (d). And there are also large area of redundant image contents between the regions in a bag as shown in (c). The box size imbalance and the redundant image contents hinder the image encoder of a VLM to effectively represent a bag of regions. As shown in (e), our sampling strategy obtains a bag of neighboring regions of equal size while capturing potential objects. Although we still observe image contents between sampled regions that do not belong to a bag of regions, they only account for a small portion of the image crop enclosing the bag of regions.</p>
</div>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A3 </span>Pseudo Word Encoding</h2>

<figure id="A3.F2" class="ltx_figure"><img src="/html/2302.13996/assets/figs/tsne.jpg" id="A3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="323" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A3.F2.6.1.1" class="ltx_text" style="font-size:90%;">Figure A2</span>: </span><span id="A3.F2.7.2" class="ltx_text" style="font-size:90%;">tSNE visualization of embeddings on COCO categories. <span id="A3.F2.7.2.1" class="ltx_text ltx_font_bold">Left:</span> the region features <em id="A3.F2.7.2.2" class="ltx_emph ltx_font_italic">before</em> being projected to pseudo words. <span id="A3.F2.7.2.3" class="ltx_text ltx_font_bold">Right:</span> embeddings <em id="A3.F2.7.2.4" class="ltx_emph ltx_font_italic">after</em> sending pseudo words to the text encoder.</span></figcaption>
</figure>
<div id="A3.p1" class="ltx_para">
<p id="A3.p1.1" class="ltx_p">Projecting visual features to word embedding space is common in region-based visual-language representation learning methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>. In BARON, we project region features into pseudo words to fully exploit the inherent compositional structure of multiple semantic concepts and obtain more distinctive feature embeddings.
In Fig <a href="#A3.F2" title="Fig. A2 ‣ Appendix A3 Pseudo Word Encoding ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A2</span></a>, we show the tSNE visualization of the region features <em id="A3.p1.1.1" class="ltx_emph ltx_font_italic">before</em> being projected to pseudo words and embeddings <em id="A3.p1.1.2" class="ltx_emph ltx_font_italic">after</em> sending pseudo words to the text encoder (TE), <em id="A3.p1.1.3" class="ltx_emph ltx_font_italic">i.e</em>.<span id="A3.p1.1.4" class="ltx_text"></span> <math id="A3.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{T}(w)" display="inline"><semantics id="A3.p1.1.m1.1a"><mrow id="A3.p1.1.m1.1.2" xref="A3.p1.1.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.p1.1.m1.1.2.2" xref="A3.p1.1.m1.1.2.2.cmml">𝒯</mi><mo lspace="0em" rspace="0em" id="A3.p1.1.m1.1.2.1" xref="A3.p1.1.m1.1.2.1.cmml">​</mo><mrow id="A3.p1.1.m1.1.2.3.2" xref="A3.p1.1.m1.1.2.cmml"><mo stretchy="false" id="A3.p1.1.m1.1.2.3.2.1" xref="A3.p1.1.m1.1.2.cmml">(</mo><mi id="A3.p1.1.m1.1.1" xref="A3.p1.1.m1.1.1.cmml">w</mi><mo stretchy="false" id="A3.p1.1.m1.1.2.3.2.2" xref="A3.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.1.m1.1b"><apply id="A3.p1.1.m1.1.2.cmml" xref="A3.p1.1.m1.1.2"><times id="A3.p1.1.m1.1.2.1.cmml" xref="A3.p1.1.m1.1.2.1"></times><ci id="A3.p1.1.m1.1.2.2.cmml" xref="A3.p1.1.m1.1.2.2">𝒯</ci><ci id="A3.p1.1.m1.1.1.cmml" xref="A3.p1.1.m1.1.1">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.1.m1.1c">\mathcal{T}(w)</annotation></semantics></math>. Gray points represent base categories while chromatic points represent novel categories.
With pseudo words encoded by TE, the categories are split into clusters of a more diverse distribution and distinct boundaries.</p>
</div>
<figure id="A3.F3" class="ltx_figure"><img src="/html/2302.13996/assets/figs/coco_dets.jpg" id="A3.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="325" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A3.F3.2.1.1" class="ltx_text" style="font-size:90%;">Figure A3</span>: </span><span id="A3.F3.3.2" class="ltx_text" style="font-size:90%;">Visualization of detection results on OV-COCO. Red boxes are for novel categories, while blue boxes are for base categories.</span></figcaption>
</figure>
</section>
<section id="A4" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A4 </span>Image-Guided Inference</h2>

<div id="A4.p1" class="ltx_para">
<p id="A4.p1.1" class="ltx_p">We further examine the generalization ability of our method by using images to guide the inference of the detector. We use the image encoder of CLIP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite> to encode the reference image. And the detector used in this experiment is trained on the LVIS dataset. Given a reference image, our detector is able to detect the object in the reference image as shown in Fig <a href="#A4.F4" title="Fig. A4 ‣ Appendix A4 Image-Guided Inference ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A4</span></a>. Our detector can even recognize the cartoon characters in the reference images (‘pikachu’ and ‘winnie pooh’).</p>
</div>
<figure id="A4.F4" class="ltx_figure"><img src="/html/2302.13996/assets/figs/ref_images.jpg" id="A4.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="295" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A4.F4.2.1.1" class="ltx_text" style="font-size:90%;">Figure A4</span>: </span><span id="A4.F4.3.2" class="ltx_text" style="font-size:90%;">Image-guided inference of the detector trained on LVIS dataset. BARON can even recognize the cartoon characters in the reference images (‘pikachu’ and ‘winnie pooh’).</span></figcaption>
</figure>
</section>
<section id="A5" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A5 </span>Detection Results</h2>

<div id="A5.p1" class="ltx_para">
<p id="A5.p1.1" class="ltx_p">We show more detection results of our method in Fig <a href="#A3.F3" title="Fig. A3 ‣ Appendix A3 Pseudo Word Encoding ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A3</span></a> and Fig <a href="#A6.F5" title="Fig. A5 ‣ Appendix A6 Potential Negative Societal Impacts ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A5</span></a>. On COCO dataset, BARON correctly detects novel categories including bus, keyboard, couch and so on. On LVIS dataset, BARON detects rare categories like salad plate, fedora hat, gas mask and so on. We also visualize the results when transferring the LVIS-trained detector to Objects365 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite> dataset in Fig <a href="#A6.F6" title="Fig. A6 ‣ Appendix A6 Potential Negative Societal Impacts ‣ Aligning Bag of Regions for Open-Vocabulary Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A6</span></a>. We find that the LVIS-trained detector is able to correctly recognize a wide range of object concepts defined in Objects365 dataset, exhibiting impressive generalization ability.</p>
</div>
</section>
<section id="A6" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A6 </span>Potential Negative Societal Impacts</h2>

<div id="A6.p1" class="ltx_para">
<p id="A6.p1.1" class="ltx_p">Our models have learned knowledge from vision-language models (VLMs) that are pre-trained on large-scale web image-text pairs. They potentially inherit and even reinforce harmful biases and stereotypes in the pre-trained VLMs. We suggest scrupulous probing before applying our models for any purpose.</p>
</div>
<figure id="A6.F5" class="ltx_figure"><img src="/html/2302.13996/assets/figs/lvis_dets.jpg" id="A6.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="313" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A6.F5.2.1.1" class="ltx_text" style="font-size:90%;">Figure A5</span>: </span><span id="A6.F5.3.2" class="ltx_text" style="font-size:90%;">Visualization of detection results on OV-LVIS dataset. Red boxes and masks are for novel (rare) categories, while blue boxes and masks are for base categories.</span></figcaption>
</figure>
<figure id="A6.F6" class="ltx_figure"><img src="/html/2302.13996/assets/figs/obj365_dets.jpg" id="A6.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="309" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A6.F6.2.1.1" class="ltx_text" style="font-size:90%;">Figure A6</span>: </span><span id="A6.F6.3.2" class="ltx_text" style="font-size:90%;">Visualization of transfer detection results on Objects365 dataset.</span></figcaption>
</figure>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text" style="font-size:90%;">
Edward H. Adelson.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.2.1" class="ltx_text" style="font-size:90%;">On seeing stuff: the perception of materials by humans and machines.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.3.1" class="ltx_text" style="font-size:90%;">In Bernice E. Rogowitz and Thrasyvoulos N. Pappas, editors, </span><span id="bib.bib1.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Human Vision and Electronic Imaging VI</span><span id="bib.bib1.5.3" class="ltx_text" style="font-size:90%;">, SPIE Proceedings, pages 1–12,
2001.
</span>
</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text" style="font-size:90%;">
Ankan Bansal, Karan Sikka, Gaurav Sharma, Rama Chellappa, and Ajay Divakaran.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.2.1" class="ltx_text" style="font-size:90%;">Zero-shot object detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib2.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Eur. Conf. Comput. Vis.</span><span id="bib.bib2.5.3" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text" style="font-size:90%;">
Nicolas Carion, Francisco Massa, Gabriel Synnaeve, Nicolas Usunier, Alexander
Kirillov, and Sergey Zagoruyko.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.2.1" class="ltx_text" style="font-size:90%;">End-to-end object detection with transformers.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib3.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Eur. Conf. Comput. Vis.</span><span id="bib.bib3.5.3" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text" style="font-size:90%;">
Aditya Chattopadhay, Anirban Sarkar, Prantik Howlader, and Vineeth N
Balasubramanian.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.2.1" class="ltx_text" style="font-size:90%;">Grad-CAM++: Generalized gradient-based visual explanations for deep
convolutional networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib4.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Winter App. Comput. Vis.</span><span id="bib.bib4.5.3" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text" style="font-size:90%;">
Kai Chen, Jiangmiao Pang, Jiaqi Wang, Yu Xiong, Xiaoxiao Li, Shuyang Sun,
Wansen Feng, Ziwei Liu, Jianping Shi, Wanli Ouyang, Chen Change Loy, and
Dahua Lin.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.2.1" class="ltx_text" style="font-size:90%;">Hybrid task cascade for instance segmentation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib5.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Conf. Comput. Vis. Pattern Recog.</span><span id="bib.bib5.5.3" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text" style="font-size:90%;">
Kai Chen, Jiaqi Wang, Jiangmiao Pang, Yuhang Cao, Yu Xiong, Xiaoxiao Li,
Shuyang Sun, Wansen Feng, Ziwei Liu, Jiarui Xu, Zheng Zhang, Dazhi Cheng,
Chenchen Zhu, Tianheng Cheng, Qijie Zhao, Buyu Li, Xin Lu, Rui Zhu, Yue Wu,
Jifeng Dai, Jingdong Wang, Jianping Shi, Wanli Ouyang, Chen Change Loy, and
Dahua Lin.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.2.1" class="ltx_text" style="font-size:90%;">MMDetection: Open mmlab detection toolbox and benchmark.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1906.07155</span><span id="bib.bib6.4.2" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text" style="font-size:90%;">
Xinlei Chen, Hao Fang, Tsung-Yi Lin, Ramakrishna Vedantam, Saurabh Gupta, Piotr
Dollár, and C Lawrence Zitnick.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.2.1" class="ltx_text" style="font-size:90%;">Microsoft coco captions: Data collection and evaluation server.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1504.00325</span><span id="bib.bib7.4.2" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text" style="font-size:90%;">
Yen-Chun Chen, Linjie Li, Licheng Yu, Ahmed El Kholy, Faisal Ahmed, Zhe Gan, Yu
Cheng, and Jingjing Liu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.2.1" class="ltx_text" style="font-size:90%;">Uniter: Universal image-text representation learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib8.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Eur. Conf. Comput. Vis.</span><span id="bib.bib8.5.3" class="ltx_text" style="font-size:90%;">, pages 104–120, 2020.
</span>
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text" style="font-size:90%;">
Berkan Demirel, Ramazan Gokberk Cinbis, and Nazli Ikizler-Cinbis.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.2.1" class="ltx_text" style="font-size:90%;">Zero-shot object detection by hybrid region embedding.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib9.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Brit. Mach. Vis. Conf.</span><span id="bib.bib9.5.3" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text" style="font-size:90%;">
Alexey Dosovitskiy, Lucas Beyer, Alexander Kolesnikov, Dirk Weissenborn,
Xiaohua Zhai, Thomas Unterthiner, Mostafa Dehghani, Matthias Minderer, Georg
Heigold, Sylvain Gelly, Jakob Uszkoreit, and Neil Houlsby.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.2.1" class="ltx_text" style="font-size:90%;">An image is worth 16x16 words: Transformers for image recognition at
scale.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib10.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Int. Conf. Learn. Represent.</span><span id="bib.bib10.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text" style="font-size:90%;">
Yu Du, Fangyun Wei, Zihe Zhang, Miaojing Shi, Yue Gao, and Guoqi Li.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.2.1" class="ltx_text" style="font-size:90%;">Learning to prompt for open-vocabulary object detection with
vision-language model.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib11.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Conf. Comput. Vis. Pattern Recog.</span><span id="bib.bib11.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text" style="font-size:90%;">
Mark Everingham, Luc Van Gool, Christopher KI Williams, John Winn, and Andrew
Zisserman.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.2.1" class="ltx_text" style="font-size:90%;">The pascal visual object classes (voc) challenge.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Int. J. Comput. Vis.</span><span id="bib.bib12.4.2" class="ltx_text" style="font-size:90%;">, 88(2):303–338, 2010.
</span>
</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text" style="font-size:90%;">
Andrea Frome, Greg S Corrado, Jon Shlens, Samy Bengio, Jeff Dean, Marc’Aurelio
Ranzato, and Tomas Mikolov.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.2.1" class="ltx_text" style="font-size:90%;">Devise: A deep visual-semantic embedding model.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Adv. Neural Inform. Process. Syst.</span><span id="bib.bib13.4.2" class="ltx_text" style="font-size:90%;">, 2013.
</span>
</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text" style="font-size:90%;">
Mingfei Gao, Chen Xing, Juan Carlos Niebles, Junnan Li, Ran Xu, Wenhao Liu, and
Caiming Xiong.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.2.1" class="ltx_text" style="font-size:90%;">Open vocabulary object detection with pseudo bounding-box labels.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Eur. Conf. Comput. Vis.</span><span id="bib.bib14.4.2" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text" style="font-size:90%;">
Golnaz Ghiasi, Yin Cui, Aravind Srinivas, Rui Qian, Tsung-Yi Lin, Ekin D.
Cubuk, Quoc V. Le, and Barret Zoph.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.2.1" class="ltx_text" style="font-size:90%;">Simple copy-paste is a strong data augmentation method for instance
segmentation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib15.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Conf. Comput. Vis. Pattern Recog.</span><span id="bib.bib15.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text" style="font-size:90%;">
Xiuye Gu, Tsung-Yi Lin, Weicheng Kuo, and Yin Cui.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.2.1" class="ltx_text" style="font-size:90%;">Open-vocabulary object detection via vision and language knowledge
distillation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib16.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Int. Conf. Learn. Represent.</span><span id="bib.bib16.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text" style="font-size:90%;">
Agrim Gupta, Piotr Dollar, and Ross Girshick.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.2.1" class="ltx_text" style="font-size:90%;">Lvis: A dataset for large vocabulary instance segmentation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib17.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Conf. Comput. Vis. Pattern Recog.</span><span id="bib.bib17.5.3" class="ltx_text" style="font-size:90%;">, pages 5356–5364,
2019.
</span>
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text" style="font-size:90%;">
Agrim Gupta, Piotr Dollár, and Ross B. Girshick.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.2.1" class="ltx_text" style="font-size:90%;">LVIS: A dataset for large vocabulary instance segmentation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib18.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Conf. Comput. Vis. Pattern Recog.</span><span id="bib.bib18.5.3" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text" style="font-size:90%;">
Nasir Hayat, Munawar Hayat, Shafin Rahman, Salman H. Khan, Syed Waqas Zamir,
and Fahad Shahbaz Khan.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.2.1" class="ltx_text" style="font-size:90%;">Synthesizing the unseen for zero-shot object detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib19.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Asian Conf. Comput. Vis.</span><span id="bib.bib19.5.3" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text" style="font-size:90%;">
Kaiming He, Haoqi Fan, Yuxin Wu, Saining Xie, and Ross Girshick.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.2.1" class="ltx_text" style="font-size:90%;">Momentum contrast for unsupervised visual representation learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib20.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Conf. Comput. Vis. Pattern Recog.</span><span id="bib.bib20.5.3" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock"><span id="bib.bib21.1.1" class="ltx_text" style="font-size:90%;">
Kaiming He, Georgia Gkioxari, Piotr Dollár, and Ross Girshick.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.2.1" class="ltx_text" style="font-size:90%;">Mask R-CNN.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib21.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Int. Conf. Comput. Vis.</span><span id="bib.bib21.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text" style="font-size:90%;">
Dinesh Jayaraman and Kristen Grauman.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.2.1" class="ltx_text" style="font-size:90%;">Zero-shot recognition with unreliable attributes.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib22.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Adv. Neural Inform. Process. Syst.</span><span id="bib.bib22.5.3" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text" style="font-size:90%;">
Chao Jia, Yinfei Yang, Ye Xia, Yi-Ting Chen, Zarana Parekh, Hieu Pham, Quoc Le,
Yun-Hsuan Sung, Zhen Li, and Tom Duerig.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.2.1" class="ltx_text" style="font-size:90%;">Scaling up visual and vision-language representation learning with
noisy text supervision.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib23.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Int. Conf. Mach. Learn.</span><span id="bib.bib23.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock"><span id="bib.bib24.1.1" class="ltx_text" style="font-size:90%;">
Wonjae Kim, Bokyung Son, and Ildoo Kim.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.2.1" class="ltx_text" style="font-size:90%;">ViLT: Vision-and-language transformer without convolution or region
supervision.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib24.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Int. Conf. Mach. Learn.</span><span id="bib.bib24.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock"><span id="bib.bib25.1.1" class="ltx_text" style="font-size:90%;">
Alexander Kirillov, Kaiming He, Ross Girshick, Carsten Rother, and Piotr
Dollár.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.2.1" class="ltx_text" style="font-size:90%;">Panoptic segmentation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib25.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Conf. Comput. Vis. Pattern Recog.</span><span id="bib.bib25.5.3" class="ltx_text" style="font-size:90%;">, pages 9404–9413,
2019.
</span>
</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock"><span id="bib.bib26.1.1" class="ltx_text" style="font-size:90%;">
Boyi Li, Kilian Q Weinberger, Serge Belongie, Vladlen Koltun, and René
Ranftl.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.2.1" class="ltx_text" style="font-size:90%;">Language-driven semantic segmentation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Int. Conf. Learn. Represent.</span><span id="bib.bib26.4.2" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock"><span id="bib.bib27.1.1" class="ltx_text" style="font-size:90%;">
Junnan Li, Dongxu Li, Caiming Xiong, and Steven C. H. Hoi.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.2.1" class="ltx_text" style="font-size:90%;">BLIP: Bootstrapping language-image pre-training for unified
vision-language understanding and generation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib27.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Int. Conf. Mach. Learn.</span><span id="bib.bib27.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock"><span id="bib.bib28.1.1" class="ltx_text" style="font-size:90%;">
Junnan Li, Ramprasaath R. Selvaraju, Akhilesh Gotmare, Shafiq R. Joty, Caiming
Xiong, and Steven Chu-Hong Hoi.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.2.1" class="ltx_text" style="font-size:90%;">Align before fuse: Vision and language representation learning with
momentum distillation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib28.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Adv. Neural Inform. Process. Syst.</span><span id="bib.bib28.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock"><span id="bib.bib29.1.1" class="ltx_text" style="font-size:90%;">
Liunian Harold Li, Pengchuan Zhang, Haotian Zhang, Jianwei Yang, Chunyuan Li,
Yiwu Zhong, Lijuan Wang, Lu Yuan, Lei Zhang, Jenq-Neng Hwang, Kai-Wei
Chang, and Jianfeng Gao.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.2.1" class="ltx_text" style="font-size:90%;">Grounded language-image pre-training.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib29.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Conf. Comput. Vis. Pattern Recog.</span><span id="bib.bib29.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock"><span id="bib.bib30.1.1" class="ltx_text" style="font-size:90%;">
Chuang Lin, Peize Sun, Yi Jiang, Ping Luo, Lizhen Qu, Gholamreza Haffari,
Zehuan Yuan, and Jianfei Cai.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.2.1" class="ltx_text" style="font-size:90%;">Learning object-language alignments for open-vocabulary object
detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Int. Conf. Learn. Represent.</span><span id="bib.bib30.4.2" class="ltx_text" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock"><span id="bib.bib31.1.1" class="ltx_text" style="font-size:90%;">
Tsung-Yi Lin, Piotr Dollár, Ross B. Girshick, Kaiming He, Bharath
Hariharan, and Serge J. Belongie.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.2.1" class="ltx_text" style="font-size:90%;">Feature pyramid networks for object detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib31.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Int. Conf. Comput. Vis.</span><span id="bib.bib31.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock"><span id="bib.bib32.1.1" class="ltx_text" style="font-size:90%;">
Tsung-Yi Lin, Priya Goyal, Ross B. Girshick, Kaiming He, and Piotr
Dollár.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.2.1" class="ltx_text" style="font-size:90%;">Focal loss for dense object detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib32.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Int. Conf. Comput. Vis.</span><span id="bib.bib32.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock"><span id="bib.bib33.1.1" class="ltx_text" style="font-size:90%;">
Tsung-Yi Lin, Michael Maire, Serge Belongie, James Hays, Pietro Perona, Deva
Ramanan, Piotr Dollár, and C Lawrence Zitnick.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib33.2.1" class="ltx_text" style="font-size:90%;">Microsoft coco: Common objects in context.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib33.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib33.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Eur. Conf. Comput. Vis.</span><span id="bib.bib33.5.3" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock"><span id="bib.bib34.1.1" class="ltx_text" style="font-size:90%;">
Li Liu, Wanli Ouyang, Xiaogang Wang, Paul W. Fieguth, Jie Chen, Xinwang Liu,
and Matti Pietikäinen.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib34.2.1" class="ltx_text" style="font-size:90%;">Deep learning for generic object detection: A survey.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib34.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Int. J. Comput. Vis.</span><span id="bib.bib34.4.2" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock"><span id="bib.bib35.1.1" class="ltx_text" style="font-size:90%;">
Jiasen Lu, Dhruv Batra, Devi Parikh, and Stefan Lee.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib35.2.1" class="ltx_text" style="font-size:90%;">Vilbert: Pretraining task-agnostic visiolinguistic representations
for vision-and-language tasks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib35.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib35.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Adv. Neural Inform. Process. Syst.</span><span id="bib.bib35.5.3" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock"><span id="bib.bib36.1.1" class="ltx_text" style="font-size:90%;">
Muhammad Maaz, Hanoona Rasheed, Salman Khan, Fahad Shahbaz Khan, Rao Muhammad
Anwer, and Ming-Hsuan Yang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib36.2.1" class="ltx_text" style="font-size:90%;">Class-agnostic object detection with multi-modal transformer.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib36.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib36.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Eur. Conf. Comput. Vis.</span><span id="bib.bib36.5.3" class="ltx_text" style="font-size:90%;">, pages 512–531, 2022.
</span>
</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock"><span id="bib.bib37.1.1" class="ltx_text" style="font-size:90%;">
Mohammad Norouzi, Tomás Mikolov, Samy Bengio, Yoram Singer, Jonathon
Shlens, Andrea Frome, Greg Corrado, and Jeffrey Dean.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib37.2.1" class="ltx_text" style="font-size:90%;">Zero-shot learning by convex combination of semantic embeddings.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib37.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib37.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Int. Conf. Learn. Represent.</span><span id="bib.bib37.5.3" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock"><span id="bib.bib38.1.1" class="ltx_text" style="font-size:90%;">
Aaron van den Oord, Yazhe Li, and Oriol Vinyals.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib38.2.1" class="ltx_text" style="font-size:90%;">Representation learning with contrastive predictive coding.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib38.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1807.03748</span><span id="bib.bib38.4.2" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock"><span id="bib.bib39.1.1" class="ltx_text" style="font-size:90%;">
Chao Peng, Tete Xiao, Zeming Li, Yuning Jiang, Xiangyu Zhang, Kai Jia, Gang Yu,
and Jian Sun.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib39.2.1" class="ltx_text" style="font-size:90%;">MegDet: A large mini-batch object detector.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib39.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib39.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Conf. Comput. Vis. Pattern Recog.</span><span id="bib.bib39.5.3" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock"><span id="bib.bib40.1.1" class="ltx_text" style="font-size:90%;">
Alec Radford, Jong Wook Kim, Chris Hallacy, Aditya Ramesh, Gabriel Goh,
Sandhini Agarwal, Girish Sastry, Amanda Askell, Pamela Mishkin, Jack Clark,
et al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib40.2.1" class="ltx_text" style="font-size:90%;">Learning transferable visual models from natural language
supervision.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib40.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib40.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Int. Conf. Mach. Learn.</span><span id="bib.bib40.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock"><span id="bib.bib41.1.1" class="ltx_text" style="font-size:90%;">
Shafin Rahman, Salman H. Khan, and Nick Barnes.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib41.2.1" class="ltx_text" style="font-size:90%;">Transductive learning for zero-shot object detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib41.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib41.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Int. Conf. Comput. Vis.</span><span id="bib.bib41.5.3" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock"><span id="bib.bib42.1.1" class="ltx_text" style="font-size:90%;">
Yongming Rao, Wenliang Zhao, Guangyi Chen, Yansong Tang, Zheng Zhu, Guan Huang,
Jie Zhou, and Jiwen Lu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib42.2.1" class="ltx_text" style="font-size:90%;">DenseCLIP: Language-guided dense prediction with context-aware
prompting.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib42.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib42.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Conf. Comput. Vis. Pattern Recog.</span><span id="bib.bib42.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock"><span id="bib.bib43.1.1" class="ltx_text" style="font-size:90%;">
Hanoona Abdul Rasheed, Muhammad Maaz, Muhammd Uzair Khattak, Salman Khan, and
Fahad Khan.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib43.2.1" class="ltx_text" style="font-size:90%;">Bridging the gap between object and image-level representations for
open-vocabulary detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib43.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib43.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Adv. Neural Inform. Process. Syst.</span><span id="bib.bib43.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock"><span id="bib.bib44.1.1" class="ltx_text" style="font-size:90%;">
Shaoqing Ren, Kaiming He, Ross Girshick, and Jian Sun.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib44.2.1" class="ltx_text" style="font-size:90%;">Faster R-CNN: Towards real-time object detection with region
proposal networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib44.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib44.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Adv. Neural Inform. Process. Syst.</span><span id="bib.bib44.5.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock"><span id="bib.bib45.1.1" class="ltx_text" style="font-size:90%;">
Shuai Shao, Zeming Li, Tianyuan Zhang, Chao Peng, Gang Yu, Xiangyu Zhang, Jing
Li, and Jian Sun.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib45.2.1" class="ltx_text" style="font-size:90%;">Objects365: A large-scale, high-quality dataset for object detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib45.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib45.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Int. Conf. Comput. Vis.</span><span id="bib.bib45.5.3" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock"><span id="bib.bib46.1.1" class="ltx_text" style="font-size:90%;">
Hengcan Shi, Munawar Hayat, Yicheng Wu, and Jianfei Cai.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib46.2.1" class="ltx_text" style="font-size:90%;">ProposalCLIP: Unsupervised open-category object proposal generation
via exploiting clip cues.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib46.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib46.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Conf. Comput. Vis. Pattern Recog.</span><span id="bib.bib46.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock"><span id="bib.bib47.1.1" class="ltx_text" style="font-size:90%;">
Nitish Srivastava, Geoffrey Hinton, Alex Krizhevsky, Ilya Sutskever, and Ruslan
Salakhutdinov.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib47.2.1" class="ltx_text" style="font-size:90%;">Dropout: A simple way to prevent neural networks from overfitting.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib47.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">The journal of machine learning research</span><span id="bib.bib47.4.2" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock"><span id="bib.bib48.1.1" class="ltx_text" style="font-size:90%;">
Ajinkya Tejankar, Maziar Sanjabi, Bichen Wu, Saining Xie, Madian Khabsa, Hamed
Pirsiavash, and Hamed Firooz.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib48.2.1" class="ltx_text" style="font-size:90%;">A fistful of words: Learning transferable visual models from
bag-of-words supervision.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib48.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">CoRR</span><span id="bib.bib48.4.2" class="ltx_text" style="font-size:90%;">, abs/2112.13884, 2021.
</span>
</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock"><span id="bib.bib49.1.1" class="ltx_text" style="font-size:90%;">
Yonglong Tian, Dilip Krishnan, and Phillip Isola.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib49.2.1" class="ltx_text" style="font-size:90%;">Contrastive multiview coding.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib49.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib49.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Eur. Conf. Comput. Vis.</span><span id="bib.bib49.5.3" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock"><span id="bib.bib50.1.1" class="ltx_text" style="font-size:90%;">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones,
Aidan N. Gomez, Lukasz Kaiser, and Illia Polosukhin.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib50.2.1" class="ltx_text" style="font-size:90%;">Attention is all you need.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib50.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib50.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Adv. Neural Inform. Process. Syst.</span><span id="bib.bib50.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock"><span id="bib.bib51.1.1" class="ltx_text" style="font-size:90%;">
Fangyun Wei, Yue Gao, Zhirong Wu, Han Hu, and Stephen Lin.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib51.2.1" class="ltx_text" style="font-size:90%;">Aligning pretraining for detection via object-level contrastive
learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib51.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Adv. Neural Inform. Process. Syst.</span><span id="bib.bib51.4.2" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock"><span id="bib.bib52.1.1" class="ltx_text" style="font-size:90%;">
Yuxin Wu, Alexander Kirillov, Francisco Massa, Wan-Yen Lo, and Ross Girshick.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib52.2.1" class="ltx_text" style="font-size:90%;">Detectron2.
</span>
</span>
<span class="ltx_bibblock"><a target="_blank" href="https://github.com/facebookresearch/detectron2" title="" class="ltx_ref ltx_url ltx_font_typewriter" style="font-size:90%;">https://github.com/facebookresearch/detectron2</a><span id="bib.bib52.3.1" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[53]</span>
<span class="ltx_bibblock"><span id="bib.bib53.1.1" class="ltx_text" style="font-size:90%;">
Jianwei Yang, Chunyuan Li, Pengchuan Zhang, Bin Xiao, Ce Liu, Lu Yuan, and
Jianfeng Gao.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib53.2.1" class="ltx_text" style="font-size:90%;">Unified contrastive learning in image-text-label space.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib53.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib53.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Conf. Comput. Vis. Pattern Recog.</span><span id="bib.bib53.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[54]</span>
<span class="ltx_bibblock"><span id="bib.bib54.1.1" class="ltx_text" style="font-size:90%;">
Mert Yüksekgönül, Federico Bianchi, Pratyusha Kalluri, Dan
Jurafsky, and James Zou.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib54.2.1" class="ltx_text" style="font-size:90%;">When and why vision-language models behave like bags-of-words, and
what to do about it?
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib54.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">CoRR</span><span id="bib.bib54.4.2" class="ltx_text" style="font-size:90%;">, abs/2210.01936, 2022.
</span>
</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[55]</span>
<span class="ltx_bibblock"><span id="bib.bib55.1.1" class="ltx_text" style="font-size:90%;">
Yuhang Zang, Wei Li, Kaiyang Zhou, Chen Huang, and Chen Change Loy.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib55.2.1" class="ltx_text" style="font-size:90%;">Open-vocabulary DETR with conditional matching.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib55.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Eur. Conf. Comput. Vis.</span><span id="bib.bib55.4.2" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[56]</span>
<span class="ltx_bibblock"><span id="bib.bib56.1.1" class="ltx_text" style="font-size:90%;">
Alireza Zareian, Kevin Dela Rosa, Derek Hao Hu, and Shih-Fu Chang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib56.2.1" class="ltx_text" style="font-size:90%;">Open-vocabulary object detection using captions.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib56.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib56.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Conf. Comput. Vis. Pattern Recog.</span><span id="bib.bib56.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[57]</span>
<span class="ltx_bibblock"><span id="bib.bib57.1.1" class="ltx_text" style="font-size:90%;">
Xiaohua Zhai, Xiao Wang, Basil Mustafa, Andreas Steiner, Daniel Keysers,
Alexander Kolesnikov, and Lucas Beyer.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib57.2.1" class="ltx_text" style="font-size:90%;">LiT: Zero-shot transfer with locked-image text tuning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib57.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib57.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Conf. Comput. Vis. Pattern Recog.</span><span id="bib.bib57.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[58]</span>
<span class="ltx_bibblock"><span id="bib.bib58.1.1" class="ltx_text" style="font-size:90%;">
Ye Zheng, Ruoran Huang, Chuanqi Han, Xi Huang, and Li Cui.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib58.2.1" class="ltx_text" style="font-size:90%;">Background learnable cascade for zero-shot object detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib58.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib58.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Asian Conf. Comput. Vis.</span><span id="bib.bib58.5.3" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib59" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[59]</span>
<span class="ltx_bibblock"><span id="bib.bib59.1.1" class="ltx_text" style="font-size:90%;">
Yiwu Zhong, Jianwei Yang, Pengchuan Zhang, Chunyuan Li, Noel Codella,
Liunian Harold Li, Luowei Zhou, Xiyang Dai, Lu Yuan, Yin Li, et al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib59.2.1" class="ltx_text" style="font-size:90%;">RegionCLIP: Region-based language-image pretraining.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib59.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib59.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Conf. Comput. Vis. Pattern Recog.</span><span id="bib.bib59.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib60" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[60]</span>
<span class="ltx_bibblock"><span id="bib.bib60.1.1" class="ltx_text" style="font-size:90%;">
Chong Zhou, Chen Change Loy, and Bo Dai.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib60.2.1" class="ltx_text" style="font-size:90%;">Extract free dense labels from clip.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib60.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib60.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Eur. Conf. Comput. Vis.</span><span id="bib.bib60.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib61" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[61]</span>
<span class="ltx_bibblock"><span id="bib.bib61.1.1" class="ltx_text" style="font-size:90%;">
Xingyi Zhou, Rohit Girdhar, Armand Joulin, Phillip Krähenbühl, and
Ishan Misra.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib61.2.1" class="ltx_text" style="font-size:90%;">Detecting twenty-thousand classes using image-level supervision.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib61.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Eur. Conf. Comput. Vis.</span><span id="bib.bib61.4.2" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib62" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[62]</span>
<span class="ltx_bibblock"><span id="bib.bib62.1.1" class="ltx_text" style="font-size:90%;">
Xizhou Zhu, Weijie Su, Lewei Lu, Bin Li, Xiaogang Wang, and Jifeng Dai.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib62.2.1" class="ltx_text" style="font-size:90%;">Deformable DETR: Deformable transformers for end-to-end object
detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib62.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Int. Conf. Learn. Represent.</span><span id="bib.bib62.4.2" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2302.13995" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2302.13996" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2302.13996">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2302.13996" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2302.13997" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Feb 29 23:46:55 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
