<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2308.03982] PARTNER: Level up the Polar Representation for LiDAR 3D Object Detection</title><meta property="og:description" content="Recently, polar-based representation has shown promising properties in perceptual tasks.
In addition to Cartesian-based approaches, which separate point clouds unevenly, representing point clouds as polar grids has bee…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="PARTNER: Level up the Polar Representation for LiDAR 3D Object Detection">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="PARTNER: Level up the Polar Representation for LiDAR 3D Object Detection">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2308.03982">

<!--Generated on Wed Feb 28 13:46:21 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">PARTNER: Level up the Polar Representation for LiDAR 3D Object Detection</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Ming Nie<sup id="id3.3.id1" class="ltx_sup">1</sup>
 Yujing Xue<sup id="id4.4.id2" class="ltx_sup">2,5</sup><sup id="id5.5.id3" class="ltx_sup">∗</sup>
 Chunwei Wang<sup id="id6.6.id4" class="ltx_sup">3</sup><sup id="id7.7.id5" class="ltx_sup">∗</sup>
 Chaoqiang Ye<sup id="id8.8.id6" class="ltx_sup">3</sup>
 Hang Xu<sup id="id9.9.id7" class="ltx_sup">3</sup>
 
<br class="ltx_break">Xinge Zhu<sup id="id10.10.id8" class="ltx_sup">4</sup>
 Qingqiu Huang<sup id="id11.11.id9" class="ltx_sup">4</sup>
 Michael Bi Mi<sup id="id12.12.id10" class="ltx_sup">5</sup>
 Xinchao Wang<sup id="id13.13.id11" class="ltx_sup">2</sup>
 Li Zhang<sup id="id14.14.id12" class="ltx_sup">1</sup> 
<br class="ltx_break"><sup id="id15.15.id13" class="ltx_sup">1</sup>School of Data Science, Fudan University
 <sup id="id16.16.id14" class="ltx_sup">2</sup>National University of Singapore
 
<br class="ltx_break"><sup id="id17.17.id15" class="ltx_sup">3</sup>Huawei Noah’s Ark Lab
 <sup id="id18.18.id16" class="ltx_sup">4</sup>Huawei ADS
 <sup id="id19.19.id17" class="ltx_sup">5</sup>Huawei International Pte Ltd
 
<br class="ltx_break">

<br class="ltx_break"><a target="_blank" href="https://github.com/fudan-zvg/PARTNER" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/fudan-zvg/PARTNER</a>
</span><span class="ltx_author_notes">Equally contributed.Li Zhang (lizhangfd@fudan.edu.cn) is the corresponding author at School of Data Science, Fudan University</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id20.id1" class="ltx_p">Recently, polar-based representation has shown promising properties in perceptual tasks.
In addition to Cartesian-based approaches, which separate point clouds unevenly, representing point clouds as polar grids has been recognized as an alternative due to (1) its advantage in robust performance under different resolutions and (2) its superiority in streaming-based approaches.
However, state-of-the-art polar-based detection methods inevitably suffer from the feature distortion problem because of the non-uniform division of polar representation, resulting in a non-negligible performance gap compared to Cartesian-based approaches.
To tackle this issue, we present PARTNER, a novel 3D object detector in the polar coordinate.
PARTNER alleviates the dilemma of feature distortion with global representation re-alignment and facilitates the regression by introducing instance-level geometric information into the detection head.
Extensive experiments show overwhelming advantages in streaming-based detection and different resolutions.
Furthermore, our method outperforms the previous polar-based works with remarkable margins of 3.68% and 9.15% on Waymo and ONCE validation set, thus achieving competitive results over the state-of-the-art methods.
</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">3D object detection serves as an indispensable component in 3D scene understanding for autonomous driving.
With increased affordability and accessibility, LiDAR sensors are now widely adopted for accurate localization.
Unlike regular camera images, LiDAR point cloud has its own unordered, unstructured and sparse nature, thus requiring an effective representation for 3D object detection algorithms in real world.
</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2308.03982/assets/x1.png" id="S1.F1.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="258" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>The superiority of polar representation. Experiments are conducted on Waymo val. set. (a) Performance comparison between different volumetric representations. When enlarging the voxel size of 3D detector CenterPoint <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>, replacing cuboid-shaped voxelization with a polar-based one could significantly reduce the performance drop, indicating the accuracy robustness of polar representation.
(b) Performance in a streaming-based architecture.
Our PARTNER outperforms the state-of-the-art streaming detector PolarStream <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> with remarkable margins.
</figcaption>
</figure>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Prior arts have explored a variety of representations for point clouds.
Point-based approaches <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> directly process raw points by PointNet and its variants <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>, which also suffer from time-consuming neighbor sampling and grouping operations.
Range-based methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> represent the LiDAR points in a 2.5D manifold structure.
Its compactness enables fast neighbor queries and avoids computation on the empty zone, yet its performance still falls behind other representations.
Alternatively, grid-based methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>, <a href="#bib.bib32" title="" class="ltx_ref">32</a>, <a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> generally transform irregular point clouds into 2D pillars or 3D voxels, and generate 3D boxes in bird’s-eye-view (BEV).
Due to their reasonable computation cost and high performance, these methods have currently dominated the 3D detection benchmark on large-scale datasets <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>.
Nevertheless, popular Cartesian-based volumetric representation encounters the problem of non-uniform density distribution over distances, where nearby region has much greater density than the distant.
To guarantee affordable memory cost, cells close to sensors have to discard many points during encoding, thus blurring out fine details of nearby objects.
While polar representation shows the ability to relieve this problem, for its volume varying with distance naturally matches the unbalanced distribution of point clouds.
Moreover, its success on LiDAR semantic segmentation task <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite> motivates us to exploit polar representation in LiDAR 3D object detection.</p>
</div>
<figure id="S1.F2" class="ltx_figure"><img src="/html/2308.03982/assets/x2.png" id="S1.F2.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="415" height="230" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>An example of polar feature distortion. Due to the non-uniform division of polar representation, even identical objects in different ranges and headings present diverse distorted appearances, resulting in a global misalignment between objects and regression difficulty for polar-based 3D detectors.</figcaption>
</figure>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Polar representation has its potential superiority in several applications.
On the one hand, it benefits robust performance under different resolutions due to the consistency between its partition property and the uneven sparsity of point clouds.
As illustrated in Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ PARTNER: Level up the Polar Representation for LiDAR 3D Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>(a), enlarging the voxel size of Cartesian-based 3D detector CenterPoint <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> leads to an exponential performance drop, as enlarged voxelization induces more information loss.
In contrast, the accuracy of the polar-based detector decreases linearly due to the non-uniform voxelization process, which aligns with real-world applications in autonomous driving.
On the other hand, polar representation naturally resolves the efficiency challenges of existing streaming-based architectures <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, which processes LiDAR sectors sequentially as soon as scanned data arrives in order to reduce the system latency.
Under this setting, the traditional cuboid-shaped voxelization would inevitably waste both computation and memory on empty voxel regions <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>.
In comparison, polar-shaped voxels follow the circular nature of rotating LiDAR emitter and represent wedge-shaped sectors compactly, thus serving as a more suitable solution for streaming-based approaches (shown in Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ PARTNER: Level up the Polar Representation for LiDAR 3D Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>(b)).</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Despite its promising characteristics, polar-based 3D detector inevitably suffers from severe feature distortions. As illustrated in Fig. <a href="#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ PARTNER: Level up the Polar Representation for LiDAR 3D Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, identical objects in different ranges and headings present diverse distorted appearances, which reveals two main problems in polar representation.
First of all, due to the salient occupation variations between objects, the translation-invariant convolution is not compatible with non-rectangular structures and is also limited by local receptive fields, which leads to misalignment over global feature maps.
Although PolarStream <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> has attempted to address this issue by employing range-stratified convolutions, the cumbersome design fails to re-align the features for feasible object recognition.
Moreover, traditional CNN-based polar heads undergo difficulties in box prediction.
Owing to the difference in the coordinate system between feature representation and our targeted 3D bounding box, the convolution operation fails to capture the geometric clues in Cartesian coordinates, resulting in regression difficulty.
</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">To address the above issues, we present a novel <span id="S1.p5.1.1" class="ltx_text ltx_font_bold">P</span>ol<span id="S1.p5.1.2" class="ltx_text ltx_font_bold">A</span>r <span id="S1.p5.1.3" class="ltx_text ltx_font_bold">R</span>epresen<span id="S1.p5.1.4" class="ltx_text ltx_font_bold">T</span>atio<span id="S1.p5.1.5" class="ltx_text ltx_font_bold">N</span> det<span id="S1.p5.1.6" class="ltx_text ltx_font_bold">E</span>cto<span id="S1.p5.1.7" class="ltx_text ltx_font_bold">R</span>, dubbed PARTNER, to learn effective representation in polar coordinates.
We introduce two key components, namely global representation re-alignment module and geometry-aware adaptive module.
Global representation re-alignment module employs a novel attention mechanism to re-align the features between objects.
To avoid introducing background noise and efficiently enlarge the receptive field for information interaction, we first condense each column of polar features into a few representative points.
This operation is based on polar-specific observation that features along radial direction only contain limited information due to the occlusion in LiDAR scanning.
After radial feature condensing, angular-wise self-attention is conducted based on those representative points for global feature alignment.
In addition, to facilitate box regression, geometry-aware adaptive module leverages auxiliary supervision to introduce extra geometric and instance information to each pixel.
Then the predicted information is explicitly introduced into a self-attention mechanism for feature aggregation.
Equipped with the proposed designs, our polar 3D detector achieves superior performance over Cartesian-based methods.
</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">In brief, our contributions are summarized as follows:
<span id="S1.p6.1.1" class="ltx_text ltx_font_bold">(i)</span>
We explore the feature distortion problem in polar representation and propose a novel LiDAR-based 3D object detector, dubbed PARTNER, in the polar coordinate system.
<span id="S1.p6.1.2" class="ltx_text ltx_font_bold">(ii)</span>
We introduce two polar-tailored designs: a global representation re-alignment module to undistort polar-based features and a geometry-aware adaptive module for accurate box prediction.
<span id="S1.p6.1.3" class="ltx_text ltx_font_bold">(iii)</span>
We extensively validate the effectiveness of our designs on the Waymo and ONCE datasets.
Particularly,
our PARTNER achieves competitive results over the state-of-the-art methods and demonstrates overwhelming advantages in streaming and low resolution scenarios.</p>
</div>
<figure id="S1.F3" class="ltx_figure"><img src="/html/2308.03982/assets/x3.png" id="S1.F3.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="227" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>
The overall architecture of our framework. PARTNER contains four major components: the 3D backbone, the global representation re-alignment module, the 2D FPN, and the geometry-aware adaptive module.
The 3D backbone takes the rasterized point cloud as input and produces the Bird-Eye-View (BEV) feature map for the 3D scene.
The global representation re-alignement module introduces cross-attention between representative features and the corresponding columns as well as self-attention among representative features to re-align the feature representation.
Finally, after the 2D FPN backbone, the geometry-aware adaptive module introduces geometric clues to the feature aggregation process with the help of two auxiliary tasks and detection head produces predicted results.
</figcaption>
</figure>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related work</h2>

<section id="S2.SS0.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Cartesian-based 3D object detection.</h4>

<div id="S2.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="S2.SS0.SSS0.Px1.p1.1" class="ltx_p">Current LiDAR-based 3D object detection methods generally transform irregular point clouds to grid representation in Cartesian coordinates and detect objects in bird’s-eye-view (BEV).
Pioneer work PointPillars <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> typically groups the points into BEV pillars and employs 2D CNNs to generate 3D proposals.
In VoxelNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite>, points are divided into 3D voxels, and 3D CNNs are leveraged for voxel feature aggregation.
SECOND <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> further proposes a sparse convolution operation for efficient voxel processing.
CenterPoint <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> replaces the general anchor-based detector with a center-based assignment for accurate box localization.
Until now, grid-based methods dominate the majority of 3D detection benchmarks, especially on large-scale datasets <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>.</p>
</div>
</section>
<section id="S2.SS0.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Polar-based 3D object detection.</h4>

<div id="S2.SS0.SSS0.Px2.p1" class="ltx_para">
<p id="S2.SS0.SSS0.Px2.p1.1" class="ltx_p">Polar or polar-like coordinate system was first explored in LiDAR semantic segmentation tasks. PolarNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> and Cylinder3D <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite> point out the varying-density property caused by Cartesian voxels and employ polar-shaped partition to balance the points across grid cells.
However, unlike classification-style tasks, 3D detection additionally requires regression of the object bounding box, thus challenging more on the feature distortion problem in polar representation. PolarStream <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> proposes a polar-to-Cartesian sampling module for classification and applies range-stratified convolution and normalization to process features over different ranges.
Considering the limitation of translation-invariant convolution, we resort to the attention mechanism for tackling the challenges of appearance distortion in polar coordinate.</p>
</div>
</section>
<section id="S2.SS0.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Transformer.</h4>

<div id="S2.SS0.SSS0.Px3.p1" class="ltx_para">
<p id="S2.SS0.SSS0.Px3.p1.1" class="ltx_p">The success of the transformer has been demonstrated in computer vision tasks. Building upon the pioneering work ViT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>, many efforts have been devoted to attention mechanism designs.
Axial Attention <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> proposes stacked axis-wise transformers for computation efficiency while Swin Transformer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> introduces local window attention with window shifting.
FAN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite> introduces channel-wise global attention for emerging visual groups of transformers.
Recently, transformer-based architectures are also adopted in LiDAR-based 3D object detection.
VoTr <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> and SST <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> first apply transformer-based 3D backbones to sparse voxels.
Voxel Set Transformer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> introduces voxel-based set attention to reduce the self-attention in each voxel.
Compared with previous methods, PARTNER is designed with priors in polar representation to solve the feature distortion issue by learning effective representation.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Method</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">This section presents our <span id="S3.p1.1.1" class="ltx_text ltx_font_bold">P</span>ol<span id="S3.p1.1.2" class="ltx_text ltx_font_bold">A</span>r <span id="S3.p1.1.3" class="ltx_text ltx_font_bold">R</span>epresen<span id="S3.p1.1.4" class="ltx_text ltx_font_bold">T</span>atio<span id="S3.p1.1.5" class="ltx_text ltx_font_bold">N</span> det<span id="S3.p1.1.6" class="ltx_text ltx_font_bold">E</span>cto<span id="S3.p1.1.7" class="ltx_text ltx_font_bold">R</span> (PARTNER), a single stage detector designed for polar BEV representation.
The overall architecture is first introduced in Sec. <a href="#S3.SS1" title="3.1 Overall architecture ‣ 3 Method ‣ PARTNER: Level up the Polar Representation for LiDAR 3D Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1</span></a>.
Then we detail two key components in PARTNER: global representation re-alignment module in Sec. <a href="#S3.SS2" title="3.2 Global representation re-alignment module ‣ 3 Method ‣ PARTNER: Level up the Polar Representation for LiDAR 3D Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a> and geometry-aware adaptive module in Sec. <a href="#S3.SS3" title="3.3 Geometry-aware adaptive module ‣ 3 Method ‣ PARTNER: Level up the Polar Representation for LiDAR 3D Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a>.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Overall architecture</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.5" class="ltx_p">For each 3D scene, PARTNER takes a point cloud consisting of <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="N_{p}" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><msub id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">N</mi><mi id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">𝑁</ci><ci id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">N_{p}</annotation></semantics></math> points as input. Each LiDAR point is represented by a vector of point feature <math id="S3.SS1.p1.2.m2.6" class="ltx_Math" alttext="(r_{p},a_{p},x_{p},y_{p},z_{p},i_{p})" display="inline"><semantics id="S3.SS1.p1.2.m2.6a"><mrow id="S3.SS1.p1.2.m2.6.6.6" xref="S3.SS1.p1.2.m2.6.6.7.cmml"><mo stretchy="false" id="S3.SS1.p1.2.m2.6.6.6.7" xref="S3.SS1.p1.2.m2.6.6.7.cmml">(</mo><msub id="S3.SS1.p1.2.m2.1.1.1.1" xref="S3.SS1.p1.2.m2.1.1.1.1.cmml"><mi id="S3.SS1.p1.2.m2.1.1.1.1.2" xref="S3.SS1.p1.2.m2.1.1.1.1.2.cmml">r</mi><mi id="S3.SS1.p1.2.m2.1.1.1.1.3" xref="S3.SS1.p1.2.m2.1.1.1.1.3.cmml">p</mi></msub><mo id="S3.SS1.p1.2.m2.6.6.6.8" xref="S3.SS1.p1.2.m2.6.6.7.cmml">,</mo><msub id="S3.SS1.p1.2.m2.2.2.2.2" xref="S3.SS1.p1.2.m2.2.2.2.2.cmml"><mi id="S3.SS1.p1.2.m2.2.2.2.2.2" xref="S3.SS1.p1.2.m2.2.2.2.2.2.cmml">a</mi><mi id="S3.SS1.p1.2.m2.2.2.2.2.3" xref="S3.SS1.p1.2.m2.2.2.2.2.3.cmml">p</mi></msub><mo id="S3.SS1.p1.2.m2.6.6.6.9" xref="S3.SS1.p1.2.m2.6.6.7.cmml">,</mo><msub id="S3.SS1.p1.2.m2.3.3.3.3" xref="S3.SS1.p1.2.m2.3.3.3.3.cmml"><mi id="S3.SS1.p1.2.m2.3.3.3.3.2" xref="S3.SS1.p1.2.m2.3.3.3.3.2.cmml">x</mi><mi id="S3.SS1.p1.2.m2.3.3.3.3.3" xref="S3.SS1.p1.2.m2.3.3.3.3.3.cmml">p</mi></msub><mo id="S3.SS1.p1.2.m2.6.6.6.10" xref="S3.SS1.p1.2.m2.6.6.7.cmml">,</mo><msub id="S3.SS1.p1.2.m2.4.4.4.4" xref="S3.SS1.p1.2.m2.4.4.4.4.cmml"><mi id="S3.SS1.p1.2.m2.4.4.4.4.2" xref="S3.SS1.p1.2.m2.4.4.4.4.2.cmml">y</mi><mi id="S3.SS1.p1.2.m2.4.4.4.4.3" xref="S3.SS1.p1.2.m2.4.4.4.4.3.cmml">p</mi></msub><mo id="S3.SS1.p1.2.m2.6.6.6.11" xref="S3.SS1.p1.2.m2.6.6.7.cmml">,</mo><msub id="S3.SS1.p1.2.m2.5.5.5.5" xref="S3.SS1.p1.2.m2.5.5.5.5.cmml"><mi id="S3.SS1.p1.2.m2.5.5.5.5.2" xref="S3.SS1.p1.2.m2.5.5.5.5.2.cmml">z</mi><mi id="S3.SS1.p1.2.m2.5.5.5.5.3" xref="S3.SS1.p1.2.m2.5.5.5.5.3.cmml">p</mi></msub><mo id="S3.SS1.p1.2.m2.6.6.6.12" xref="S3.SS1.p1.2.m2.6.6.7.cmml">,</mo><msub id="S3.SS1.p1.2.m2.6.6.6.6" xref="S3.SS1.p1.2.m2.6.6.6.6.cmml"><mi id="S3.SS1.p1.2.m2.6.6.6.6.2" xref="S3.SS1.p1.2.m2.6.6.6.6.2.cmml">i</mi><mi id="S3.SS1.p1.2.m2.6.6.6.6.3" xref="S3.SS1.p1.2.m2.6.6.6.6.3.cmml">p</mi></msub><mo stretchy="false" id="S3.SS1.p1.2.m2.6.6.6.13" xref="S3.SS1.p1.2.m2.6.6.7.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.6b"><vector id="S3.SS1.p1.2.m2.6.6.7.cmml" xref="S3.SS1.p1.2.m2.6.6.6"><apply id="S3.SS1.p1.2.m2.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1.2">𝑟</ci><ci id="S3.SS1.p1.2.m2.1.1.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1.3">𝑝</ci></apply><apply id="S3.SS1.p1.2.m2.2.2.2.2.cmml" xref="S3.SS1.p1.2.m2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.2.2.2.2.1.cmml" xref="S3.SS1.p1.2.m2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.2.m2.2.2.2.2.2.cmml" xref="S3.SS1.p1.2.m2.2.2.2.2.2">𝑎</ci><ci id="S3.SS1.p1.2.m2.2.2.2.2.3.cmml" xref="S3.SS1.p1.2.m2.2.2.2.2.3">𝑝</ci></apply><apply id="S3.SS1.p1.2.m2.3.3.3.3.cmml" xref="S3.SS1.p1.2.m2.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.3.3.3.3.1.cmml" xref="S3.SS1.p1.2.m2.3.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.2.m2.3.3.3.3.2.cmml" xref="S3.SS1.p1.2.m2.3.3.3.3.2">𝑥</ci><ci id="S3.SS1.p1.2.m2.3.3.3.3.3.cmml" xref="S3.SS1.p1.2.m2.3.3.3.3.3">𝑝</ci></apply><apply id="S3.SS1.p1.2.m2.4.4.4.4.cmml" xref="S3.SS1.p1.2.m2.4.4.4.4"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.4.4.4.4.1.cmml" xref="S3.SS1.p1.2.m2.4.4.4.4">subscript</csymbol><ci id="S3.SS1.p1.2.m2.4.4.4.4.2.cmml" xref="S3.SS1.p1.2.m2.4.4.4.4.2">𝑦</ci><ci id="S3.SS1.p1.2.m2.4.4.4.4.3.cmml" xref="S3.SS1.p1.2.m2.4.4.4.4.3">𝑝</ci></apply><apply id="S3.SS1.p1.2.m2.5.5.5.5.cmml" xref="S3.SS1.p1.2.m2.5.5.5.5"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.5.5.5.5.1.cmml" xref="S3.SS1.p1.2.m2.5.5.5.5">subscript</csymbol><ci id="S3.SS1.p1.2.m2.5.5.5.5.2.cmml" xref="S3.SS1.p1.2.m2.5.5.5.5.2">𝑧</ci><ci id="S3.SS1.p1.2.m2.5.5.5.5.3.cmml" xref="S3.SS1.p1.2.m2.5.5.5.5.3">𝑝</ci></apply><apply id="S3.SS1.p1.2.m2.6.6.6.6.cmml" xref="S3.SS1.p1.2.m2.6.6.6.6"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.6.6.6.6.1.cmml" xref="S3.SS1.p1.2.m2.6.6.6.6">subscript</csymbol><ci id="S3.SS1.p1.2.m2.6.6.6.6.2.cmml" xref="S3.SS1.p1.2.m2.6.6.6.6.2">𝑖</ci><ci id="S3.SS1.p1.2.m2.6.6.6.6.3.cmml" xref="S3.SS1.p1.2.m2.6.6.6.6.3">𝑝</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.6c">(r_{p},a_{p},x_{p},y_{p},z_{p},i_{p})</annotation></semantics></math>, where <math id="S3.SS1.p1.3.m3.3" class="ltx_Math" alttext="(x_{p},y_{p},z_{p})" display="inline"><semantics id="S3.SS1.p1.3.m3.3a"><mrow id="S3.SS1.p1.3.m3.3.3.3" xref="S3.SS1.p1.3.m3.3.3.4.cmml"><mo stretchy="false" id="S3.SS1.p1.3.m3.3.3.3.4" xref="S3.SS1.p1.3.m3.3.3.4.cmml">(</mo><msub id="S3.SS1.p1.3.m3.1.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.1.cmml"><mi id="S3.SS1.p1.3.m3.1.1.1.1.2" xref="S3.SS1.p1.3.m3.1.1.1.1.2.cmml">x</mi><mi id="S3.SS1.p1.3.m3.1.1.1.1.3" xref="S3.SS1.p1.3.m3.1.1.1.1.3.cmml">p</mi></msub><mo id="S3.SS1.p1.3.m3.3.3.3.5" xref="S3.SS1.p1.3.m3.3.3.4.cmml">,</mo><msub id="S3.SS1.p1.3.m3.2.2.2.2" xref="S3.SS1.p1.3.m3.2.2.2.2.cmml"><mi id="S3.SS1.p1.3.m3.2.2.2.2.2" xref="S3.SS1.p1.3.m3.2.2.2.2.2.cmml">y</mi><mi id="S3.SS1.p1.3.m3.2.2.2.2.3" xref="S3.SS1.p1.3.m3.2.2.2.2.3.cmml">p</mi></msub><mo id="S3.SS1.p1.3.m3.3.3.3.6" xref="S3.SS1.p1.3.m3.3.3.4.cmml">,</mo><msub id="S3.SS1.p1.3.m3.3.3.3.3" xref="S3.SS1.p1.3.m3.3.3.3.3.cmml"><mi id="S3.SS1.p1.3.m3.3.3.3.3.2" xref="S3.SS1.p1.3.m3.3.3.3.3.2.cmml">z</mi><mi id="S3.SS1.p1.3.m3.3.3.3.3.3" xref="S3.SS1.p1.3.m3.3.3.3.3.3.cmml">p</mi></msub><mo stretchy="false" id="S3.SS1.p1.3.m3.3.3.3.7" xref="S3.SS1.p1.3.m3.3.3.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.3b"><vector id="S3.SS1.p1.3.m3.3.3.4.cmml" xref="S3.SS1.p1.3.m3.3.3.3"><apply id="S3.SS1.p1.3.m3.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.2">𝑥</ci><ci id="S3.SS1.p1.3.m3.1.1.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.3">𝑝</ci></apply><apply id="S3.SS1.p1.3.m3.2.2.2.2.cmml" xref="S3.SS1.p1.3.m3.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.2.2.2.2.1.cmml" xref="S3.SS1.p1.3.m3.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.3.m3.2.2.2.2.2.cmml" xref="S3.SS1.p1.3.m3.2.2.2.2.2">𝑦</ci><ci id="S3.SS1.p1.3.m3.2.2.2.2.3.cmml" xref="S3.SS1.p1.3.m3.2.2.2.2.3">𝑝</ci></apply><apply id="S3.SS1.p1.3.m3.3.3.3.3.cmml" xref="S3.SS1.p1.3.m3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.3.3.3.3.1.cmml" xref="S3.SS1.p1.3.m3.3.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.3.m3.3.3.3.3.2.cmml" xref="S3.SS1.p1.3.m3.3.3.3.3.2">𝑧</ci><ci id="S3.SS1.p1.3.m3.3.3.3.3.3.cmml" xref="S3.SS1.p1.3.m3.3.3.3.3.3">𝑝</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.3c">(x_{p},y_{p},z_{p})</annotation></semantics></math> is the Cartesian coordinates, <math id="S3.SS1.p1.4.m4.2" class="ltx_Math" alttext="(r_{p},a_{p})" display="inline"><semantics id="S3.SS1.p1.4.m4.2a"><mrow id="S3.SS1.p1.4.m4.2.2.2" xref="S3.SS1.p1.4.m4.2.2.3.cmml"><mo stretchy="false" id="S3.SS1.p1.4.m4.2.2.2.3" xref="S3.SS1.p1.4.m4.2.2.3.cmml">(</mo><msub id="S3.SS1.p1.4.m4.1.1.1.1" xref="S3.SS1.p1.4.m4.1.1.1.1.cmml"><mi id="S3.SS1.p1.4.m4.1.1.1.1.2" xref="S3.SS1.p1.4.m4.1.1.1.1.2.cmml">r</mi><mi id="S3.SS1.p1.4.m4.1.1.1.1.3" xref="S3.SS1.p1.4.m4.1.1.1.1.3.cmml">p</mi></msub><mo id="S3.SS1.p1.4.m4.2.2.2.4" xref="S3.SS1.p1.4.m4.2.2.3.cmml">,</mo><msub id="S3.SS1.p1.4.m4.2.2.2.2" xref="S3.SS1.p1.4.m4.2.2.2.2.cmml"><mi id="S3.SS1.p1.4.m4.2.2.2.2.2" xref="S3.SS1.p1.4.m4.2.2.2.2.2.cmml">a</mi><mi id="S3.SS1.p1.4.m4.2.2.2.2.3" xref="S3.SS1.p1.4.m4.2.2.2.2.3.cmml">p</mi></msub><mo stretchy="false" id="S3.SS1.p1.4.m4.2.2.2.5" xref="S3.SS1.p1.4.m4.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.2b"><interval closure="open" id="S3.SS1.p1.4.m4.2.2.3.cmml" xref="S3.SS1.p1.4.m4.2.2.2"><apply id="S3.SS1.p1.4.m4.1.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1.2">𝑟</ci><ci id="S3.SS1.p1.4.m4.1.1.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1.3">𝑝</ci></apply><apply id="S3.SS1.p1.4.m4.2.2.2.2.cmml" xref="S3.SS1.p1.4.m4.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.2.2.2.2.1.cmml" xref="S3.SS1.p1.4.m4.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.4.m4.2.2.2.2.2.cmml" xref="S3.SS1.p1.4.m4.2.2.2.2.2">𝑎</ci><ci id="S3.SS1.p1.4.m4.2.2.2.2.3.cmml" xref="S3.SS1.p1.4.m4.2.2.2.2.3">𝑝</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.2c">(r_{p},a_{p})</annotation></semantics></math> is the polar coordinates, and <math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="i_{p}" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><msub id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml"><mi id="S3.SS1.p1.5.m5.1.1.2" xref="S3.SS1.p1.5.m5.1.1.2.cmml">i</mi><mi id="S3.SS1.p1.5.m5.1.1.3" xref="S3.SS1.p1.5.m5.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2">𝑖</ci><ci id="S3.SS1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">i_{p}</annotation></semantics></math> is the reflection intensity.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.1" class="ltx_p">Fig. <a href="#S1.F3" title="Figure 3 ‣ 1 Introduction ‣ PARTNER: Level up the Polar Representation for LiDAR 3D Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> illustrates the architecture of our proposed <span id="S3.SS1.p2.1.1" class="ltx_text ltx_font_italic">PARTNER</span>, which consists of four parts:
(1) <span id="S3.SS1.p2.1.2" class="ltx_text ltx_font_italic">The grid-based 3D backbone</span> leverages grid feature embeddings from points in voxels or pillars and compresses sparse point features into a dense BEV feature map in polar coordinates.
(2) <span id="S3.SS1.p2.1.3" class="ltx_text ltx_font_italic">Global representation re-alignment module</span> takes BEV maps as input and produces re-aligned features by applying self-attention to representative features.
(3) <span id="S3.SS1.p2.1.4" class="ltx_text ltx_font_italic">FPN backbone</span> takes the re-aligned features for feature aggregation and then
(4) <span id="S3.SS1.p2.1.5" class="ltx_text ltx_font_italic">geometry-aware adaptive module</span> enhances the feature map with both geometry cues and instance information before producing detection results.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Global representation re-alignment module</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">In this section, we introduce the Global Representation Re-alignment (GRR) module, a simple yet effective module that applies attention to those essential representative features for global alignment.
The idea behind this design is based on the observation that the spatial resolution of polar grids varies depending on the range.
With such differences, two identical objects in different ranges could occupy a different number of pixels, which results in the feature distortion problem found in existing polar detectors and worsens the performance of the CNN-based feature extractor.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.1" class="ltx_p">To this end, the global representation re-alignment is designed with two kinds of attention sub-modules:
the condense attention for column feature condensing and the angular attention for feature re-alignment.
Details of two sub-modules will be presented in the following.</p>
</div>
<section id="S3.SS2.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Condense attention.</h4>

<div id="S3.SS2.SSS0.Px1.p1" class="ltx_para">
<p id="S3.SS2.SSS0.Px1.p1.4" class="ltx_p">As is shown in Fig. <a href="#S1.F3" title="Figure 3 ‣ 1 Introduction ‣ PARTNER: Level up the Polar Representation for LiDAR 3D Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, the proposed condense attention takes the BEV feature <math id="S3.SS2.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="F\in\mathbb{R}^{R\times A\times C}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p1.1.m1.1a"><mrow id="S3.SS2.SSS0.Px1.p1.1.m1.1.1" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.2" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.2.cmml">F</mi><mo id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.1" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.2" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.3" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.2" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.2.cmml">R</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.1" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.3" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.3.cmml">A</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.1a" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.4" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.4.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.1.m1.1b"><apply id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1"><in id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.1"></in><ci id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.2">𝐹</ci><apply id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.3"><times id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.1"></times><ci id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.2">𝑅</ci><ci id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.3">𝐴</ci><ci id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.4.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.4">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.1.m1.1c">F\in\mathbb{R}^{R\times A\times C}</annotation></semantics></math> from the 3D backbone as input, where <math id="S3.SS2.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="R" display="inline"><semantics id="S3.SS2.SSS0.Px1.p1.2.m2.1a"><mi id="S3.SS2.SSS0.Px1.p1.2.m2.1.1" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.2.m2.1b"><ci id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.2.m2.1c">R</annotation></semantics></math> and <math id="S3.SS2.SSS0.Px1.p1.3.m3.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S3.SS2.SSS0.Px1.p1.3.m3.1a"><mi id="S3.SS2.SSS0.Px1.p1.3.m3.1.1" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.3.m3.1b"><ci id="S3.SS2.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.3.m3.1c">A</annotation></semantics></math> denote the resolution of the radial and azimuth space, and <math id="S3.SS2.SSS0.Px1.p1.4.m4.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.SS2.SSS0.Px1.p1.4.m4.1a"><mi id="S3.SS2.SSS0.Px1.p1.4.m4.1.1" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.4.m4.1b"><ci id="S3.SS2.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.4.m4.1c">C</annotation></semantics></math> denotes the number of feature channels.
In order to select representative features, a 1D local max filtering operation along the radial direction is first applied:
</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.4" class="ltx_Math" alttext="F^{score}_{sparse}=\mathop{maxfil}\limits_{r=(S,1)}(F)," display="block"><semantics id="S3.E1.m1.4a"><mrow id="S3.E1.m1.4.4.1" xref="S3.E1.m1.4.4.1.1.cmml"><mrow id="S3.E1.m1.4.4.1.1" xref="S3.E1.m1.4.4.1.1.cmml"><msubsup id="S3.E1.m1.4.4.1.1.2" xref="S3.E1.m1.4.4.1.1.2.cmml"><mi id="S3.E1.m1.4.4.1.1.2.2.2" xref="S3.E1.m1.4.4.1.1.2.2.2.cmml">F</mi><mrow id="S3.E1.m1.4.4.1.1.2.3" xref="S3.E1.m1.4.4.1.1.2.3.cmml"><mi id="S3.E1.m1.4.4.1.1.2.3.2" xref="S3.E1.m1.4.4.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.4.1.1.2.3.1" xref="S3.E1.m1.4.4.1.1.2.3.1.cmml">​</mo><mi id="S3.E1.m1.4.4.1.1.2.3.3" xref="S3.E1.m1.4.4.1.1.2.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.4.1.1.2.3.1a" xref="S3.E1.m1.4.4.1.1.2.3.1.cmml">​</mo><mi id="S3.E1.m1.4.4.1.1.2.3.4" xref="S3.E1.m1.4.4.1.1.2.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.4.1.1.2.3.1b" xref="S3.E1.m1.4.4.1.1.2.3.1.cmml">​</mo><mi id="S3.E1.m1.4.4.1.1.2.3.5" xref="S3.E1.m1.4.4.1.1.2.3.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.4.1.1.2.3.1c" xref="S3.E1.m1.4.4.1.1.2.3.1.cmml">​</mo><mi id="S3.E1.m1.4.4.1.1.2.3.6" xref="S3.E1.m1.4.4.1.1.2.3.6.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.4.1.1.2.3.1d" xref="S3.E1.m1.4.4.1.1.2.3.1.cmml">​</mo><mi id="S3.E1.m1.4.4.1.1.2.3.7" xref="S3.E1.m1.4.4.1.1.2.3.7.cmml">e</mi></mrow><mrow id="S3.E1.m1.4.4.1.1.2.2.3" xref="S3.E1.m1.4.4.1.1.2.2.3.cmml"><mi id="S3.E1.m1.4.4.1.1.2.2.3.2" xref="S3.E1.m1.4.4.1.1.2.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.4.1.1.2.2.3.1" xref="S3.E1.m1.4.4.1.1.2.2.3.1.cmml">​</mo><mi id="S3.E1.m1.4.4.1.1.2.2.3.3" xref="S3.E1.m1.4.4.1.1.2.2.3.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.4.1.1.2.2.3.1a" xref="S3.E1.m1.4.4.1.1.2.2.3.1.cmml">​</mo><mi id="S3.E1.m1.4.4.1.1.2.2.3.4" xref="S3.E1.m1.4.4.1.1.2.2.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.4.1.1.2.2.3.1b" xref="S3.E1.m1.4.4.1.1.2.2.3.1.cmml">​</mo><mi id="S3.E1.m1.4.4.1.1.2.2.3.5" xref="S3.E1.m1.4.4.1.1.2.2.3.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.4.1.1.2.2.3.1c" xref="S3.E1.m1.4.4.1.1.2.2.3.1.cmml">​</mo><mi id="S3.E1.m1.4.4.1.1.2.2.3.6" xref="S3.E1.m1.4.4.1.1.2.2.3.6.cmml">e</mi></mrow></msubsup><mo id="S3.E1.m1.4.4.1.1.1" xref="S3.E1.m1.4.4.1.1.1.cmml">=</mo><mrow id="S3.E1.m1.4.4.1.1.3" xref="S3.E1.m1.4.4.1.1.3.cmml"><munder id="S3.E1.m1.4.4.1.1.3.1" xref="S3.E1.m1.4.4.1.1.3.1.cmml"><mrow id="S3.E1.m1.4.4.1.1.3.1.2" xref="S3.E1.m1.4.4.1.1.3.1.2.cmml"><mi id="S3.E1.m1.4.4.1.1.3.1.2.2" xref="S3.E1.m1.4.4.1.1.3.1.2.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.4.1.1.3.1.2.1" xref="S3.E1.m1.4.4.1.1.3.1.2.1.cmml">​</mo><mi id="S3.E1.m1.4.4.1.1.3.1.2.3" xref="S3.E1.m1.4.4.1.1.3.1.2.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.4.1.1.3.1.2.1a" xref="S3.E1.m1.4.4.1.1.3.1.2.1.cmml">​</mo><mi id="S3.E1.m1.4.4.1.1.3.1.2.4" xref="S3.E1.m1.4.4.1.1.3.1.2.4.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.4.1.1.3.1.2.1b" xref="S3.E1.m1.4.4.1.1.3.1.2.1.cmml">​</mo><mi id="S3.E1.m1.4.4.1.1.3.1.2.5" xref="S3.E1.m1.4.4.1.1.3.1.2.5.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.4.1.1.3.1.2.1c" xref="S3.E1.m1.4.4.1.1.3.1.2.1.cmml">​</mo><mi id="S3.E1.m1.4.4.1.1.3.1.2.6" xref="S3.E1.m1.4.4.1.1.3.1.2.6.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.4.1.1.3.1.2.1d" xref="S3.E1.m1.4.4.1.1.3.1.2.1.cmml">​</mo><mi id="S3.E1.m1.4.4.1.1.3.1.2.7" xref="S3.E1.m1.4.4.1.1.3.1.2.7.cmml">l</mi></mrow><mrow id="S3.E1.m1.2.2.2" xref="S3.E1.m1.2.2.2.cmml"><mi id="S3.E1.m1.2.2.2.4" xref="S3.E1.m1.2.2.2.4.cmml">r</mi><mo id="S3.E1.m1.2.2.2.3" xref="S3.E1.m1.2.2.2.3.cmml">=</mo><mrow id="S3.E1.m1.2.2.2.5.2" xref="S3.E1.m1.2.2.2.5.1.cmml"><mo stretchy="false" id="S3.E1.m1.2.2.2.5.2.1" xref="S3.E1.m1.2.2.2.5.1.cmml">(</mo><mi id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml">S</mi><mo id="S3.E1.m1.2.2.2.5.2.2" xref="S3.E1.m1.2.2.2.5.1.cmml">,</mo><mn id="S3.E1.m1.2.2.2.2" xref="S3.E1.m1.2.2.2.2.cmml">1</mn><mo stretchy="false" id="S3.E1.m1.2.2.2.5.2.3" xref="S3.E1.m1.2.2.2.5.1.cmml">)</mo></mrow></mrow></munder><mrow id="S3.E1.m1.4.4.1.1.3.2.2" xref="S3.E1.m1.4.4.1.1.3.cmml"><mo stretchy="false" id="S3.E1.m1.4.4.1.1.3.2.2.1" xref="S3.E1.m1.4.4.1.1.3.cmml">(</mo><mi id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml">F</mi><mo stretchy="false" id="S3.E1.m1.4.4.1.1.3.2.2.2" xref="S3.E1.m1.4.4.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1.m1.4.4.1.2" xref="S3.E1.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.4b"><apply id="S3.E1.m1.4.4.1.1.cmml" xref="S3.E1.m1.4.4.1"><eq id="S3.E1.m1.4.4.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.1"></eq><apply id="S3.E1.m1.4.4.1.1.2.cmml" xref="S3.E1.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.2.1.cmml" xref="S3.E1.m1.4.4.1.1.2">subscript</csymbol><apply id="S3.E1.m1.4.4.1.1.2.2.cmml" xref="S3.E1.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.2.2.1.cmml" xref="S3.E1.m1.4.4.1.1.2">superscript</csymbol><ci id="S3.E1.m1.4.4.1.1.2.2.2.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2">𝐹</ci><apply id="S3.E1.m1.4.4.1.1.2.2.3.cmml" xref="S3.E1.m1.4.4.1.1.2.2.3"><times id="S3.E1.m1.4.4.1.1.2.2.3.1.cmml" xref="S3.E1.m1.4.4.1.1.2.2.3.1"></times><ci id="S3.E1.m1.4.4.1.1.2.2.3.2.cmml" xref="S3.E1.m1.4.4.1.1.2.2.3.2">𝑠</ci><ci id="S3.E1.m1.4.4.1.1.2.2.3.3.cmml" xref="S3.E1.m1.4.4.1.1.2.2.3.3">𝑐</ci><ci id="S3.E1.m1.4.4.1.1.2.2.3.4.cmml" xref="S3.E1.m1.4.4.1.1.2.2.3.4">𝑜</ci><ci id="S3.E1.m1.4.4.1.1.2.2.3.5.cmml" xref="S3.E1.m1.4.4.1.1.2.2.3.5">𝑟</ci><ci id="S3.E1.m1.4.4.1.1.2.2.3.6.cmml" xref="S3.E1.m1.4.4.1.1.2.2.3.6">𝑒</ci></apply></apply><apply id="S3.E1.m1.4.4.1.1.2.3.cmml" xref="S3.E1.m1.4.4.1.1.2.3"><times id="S3.E1.m1.4.4.1.1.2.3.1.cmml" xref="S3.E1.m1.4.4.1.1.2.3.1"></times><ci id="S3.E1.m1.4.4.1.1.2.3.2.cmml" xref="S3.E1.m1.4.4.1.1.2.3.2">𝑠</ci><ci id="S3.E1.m1.4.4.1.1.2.3.3.cmml" xref="S3.E1.m1.4.4.1.1.2.3.3">𝑝</ci><ci id="S3.E1.m1.4.4.1.1.2.3.4.cmml" xref="S3.E1.m1.4.4.1.1.2.3.4">𝑎</ci><ci id="S3.E1.m1.4.4.1.1.2.3.5.cmml" xref="S3.E1.m1.4.4.1.1.2.3.5">𝑟</ci><ci id="S3.E1.m1.4.4.1.1.2.3.6.cmml" xref="S3.E1.m1.4.4.1.1.2.3.6">𝑠</ci><ci id="S3.E1.m1.4.4.1.1.2.3.7.cmml" xref="S3.E1.m1.4.4.1.1.2.3.7">𝑒</ci></apply></apply><apply id="S3.E1.m1.4.4.1.1.3.cmml" xref="S3.E1.m1.4.4.1.1.3"><apply id="S3.E1.m1.4.4.1.1.3.1.cmml" xref="S3.E1.m1.4.4.1.1.3.1"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.3.1.1.cmml" xref="S3.E1.m1.4.4.1.1.3.1">subscript</csymbol><apply id="S3.E1.m1.4.4.1.1.3.1.2.cmml" xref="S3.E1.m1.4.4.1.1.3.1.2"><times id="S3.E1.m1.4.4.1.1.3.1.2.1.cmml" xref="S3.E1.m1.4.4.1.1.3.1.2.1"></times><ci id="S3.E1.m1.4.4.1.1.3.1.2.2.cmml" xref="S3.E1.m1.4.4.1.1.3.1.2.2">𝑚</ci><ci id="S3.E1.m1.4.4.1.1.3.1.2.3.cmml" xref="S3.E1.m1.4.4.1.1.3.1.2.3">𝑎</ci><ci id="S3.E1.m1.4.4.1.1.3.1.2.4.cmml" xref="S3.E1.m1.4.4.1.1.3.1.2.4">𝑥</ci><ci id="S3.E1.m1.4.4.1.1.3.1.2.5.cmml" xref="S3.E1.m1.4.4.1.1.3.1.2.5">𝑓</ci><ci id="S3.E1.m1.4.4.1.1.3.1.2.6.cmml" xref="S3.E1.m1.4.4.1.1.3.1.2.6">𝑖</ci><ci id="S3.E1.m1.4.4.1.1.3.1.2.7.cmml" xref="S3.E1.m1.4.4.1.1.3.1.2.7">𝑙</ci></apply><apply id="S3.E1.m1.2.2.2.cmml" xref="S3.E1.m1.2.2.2"><eq id="S3.E1.m1.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.3"></eq><ci id="S3.E1.m1.2.2.2.4.cmml" xref="S3.E1.m1.2.2.2.4">𝑟</ci><interval closure="open" id="S3.E1.m1.2.2.2.5.1.cmml" xref="S3.E1.m1.2.2.2.5.2"><ci id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1">𝑆</ci><cn type="integer" id="S3.E1.m1.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2">1</cn></interval></apply></apply><ci id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3">𝐹</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.4c">F^{score}_{sparse}=\mathop{maxfil}\limits_{r=(S,1)}(F),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS0.Px1.p1.6" class="ltx_p">where <math id="S3.SS2.SSS0.Px1.p1.5.m1.1" class="ltx_Math" alttext="\mathop{maxfil}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p1.5.m1.1a"><mrow id="S3.SS2.SSS0.Px1.p1.5.m1.1.1" xref="S3.SS2.SSS0.Px1.p1.5.m1.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.5.m1.1.1.2" xref="S3.SS2.SSS0.Px1.p1.5.m1.1.1.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS0.Px1.p1.5.m1.1.1.1" xref="S3.SS2.SSS0.Px1.p1.5.m1.1.1.1.cmml">​</mo><mi id="S3.SS2.SSS0.Px1.p1.5.m1.1.1.3" xref="S3.SS2.SSS0.Px1.p1.5.m1.1.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS0.Px1.p1.5.m1.1.1.1a" xref="S3.SS2.SSS0.Px1.p1.5.m1.1.1.1.cmml">​</mo><mi id="S3.SS2.SSS0.Px1.p1.5.m1.1.1.4" xref="S3.SS2.SSS0.Px1.p1.5.m1.1.1.4.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS0.Px1.p1.5.m1.1.1.1b" xref="S3.SS2.SSS0.Px1.p1.5.m1.1.1.1.cmml">​</mo><mi id="S3.SS2.SSS0.Px1.p1.5.m1.1.1.5" xref="S3.SS2.SSS0.Px1.p1.5.m1.1.1.5.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS0.Px1.p1.5.m1.1.1.1c" xref="S3.SS2.SSS0.Px1.p1.5.m1.1.1.1.cmml">​</mo><mi id="S3.SS2.SSS0.Px1.p1.5.m1.1.1.6" xref="S3.SS2.SSS0.Px1.p1.5.m1.1.1.6.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS0.Px1.p1.5.m1.1.1.1d" xref="S3.SS2.SSS0.Px1.p1.5.m1.1.1.1.cmml">​</mo><mi id="S3.SS2.SSS0.Px1.p1.5.m1.1.1.7" xref="S3.SS2.SSS0.Px1.p1.5.m1.1.1.7.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.5.m1.1b"><apply id="S3.SS2.SSS0.Px1.p1.5.m1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m1.1.1"><times id="S3.SS2.SSS0.Px1.p1.5.m1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m1.1.1.1"></times><ci id="S3.SS2.SSS0.Px1.p1.5.m1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m1.1.1.2">𝑚</ci><ci id="S3.SS2.SSS0.Px1.p1.5.m1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m1.1.1.3">𝑎</ci><ci id="S3.SS2.SSS0.Px1.p1.5.m1.1.1.4.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m1.1.1.4">𝑥</ci><ci id="S3.SS2.SSS0.Px1.p1.5.m1.1.1.5.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m1.1.1.5">𝑓</ci><ci id="S3.SS2.SSS0.Px1.p1.5.m1.1.1.6.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m1.1.1.6">𝑖</ci><ci id="S3.SS2.SSS0.Px1.p1.5.m1.1.1.7.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m1.1.1.7">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.5.m1.1c">\mathop{maxfil}</annotation></semantics></math> is an operation that seeks out local-maxima in a <math id="S3.SS2.SSS0.Px1.p1.6.m2.1" class="ltx_Math" alttext="S\times 1" display="inline"><semantics id="S3.SS2.SSS0.Px1.p1.6.m2.1a"><mrow id="S3.SS2.SSS0.Px1.p1.6.m2.1.1" xref="S3.SS2.SSS0.Px1.p1.6.m2.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.6.m2.1.1.2" xref="S3.SS2.SSS0.Px1.p1.6.m2.1.1.2.cmml">S</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.SSS0.Px1.p1.6.m2.1.1.1" xref="S3.SS2.SSS0.Px1.p1.6.m2.1.1.1.cmml">×</mo><mn id="S3.SS2.SSS0.Px1.p1.6.m2.1.1.3" xref="S3.SS2.SSS0.Px1.p1.6.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.6.m2.1b"><apply id="S3.SS2.SSS0.Px1.p1.6.m2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m2.1.1"><times id="S3.SS2.SSS0.Px1.p1.6.m2.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m2.1.1.1"></times><ci id="S3.SS2.SSS0.Px1.p1.6.m2.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m2.1.1.2">𝑆</ci><cn type="integer" id="S3.SS2.SSS0.Px1.p1.6.m2.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.6.m2.1c">S\times 1</annotation></semantics></math> neighborhood, preventing the following selection operation from choosing features representing the same object.
The filtering operation maintains the diversity of the representative features without introducing noise from background pixels.
Then we can get the index of the essential features for each column:</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.2" class="ltx_Math" alttext="(I_{1},\cdots,I_{A})=\mathop{topk}\limits_{dim=0}(F^{score}_{sparse})," display="block"><semantics id="S3.E2.m1.2a"><mrow id="S3.E2.m1.2.2.1" xref="S3.E2.m1.2.2.1.1.cmml"><mrow id="S3.E2.m1.2.2.1.1" xref="S3.E2.m1.2.2.1.1.cmml"><mrow id="S3.E2.m1.2.2.1.1.2.2" xref="S3.E2.m1.2.2.1.1.2.3.cmml"><mo stretchy="false" id="S3.E2.m1.2.2.1.1.2.2.3" xref="S3.E2.m1.2.2.1.1.2.3.cmml">(</mo><msub id="S3.E2.m1.2.2.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.cmml"><mi id="S3.E2.m1.2.2.1.1.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.1.1.2.cmml">I</mi><mn id="S3.E2.m1.2.2.1.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.E2.m1.2.2.1.1.2.2.4" xref="S3.E2.m1.2.2.1.1.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">⋯</mi><mo id="S3.E2.m1.2.2.1.1.2.2.5" xref="S3.E2.m1.2.2.1.1.2.3.cmml">,</mo><msub id="S3.E2.m1.2.2.1.1.2.2.2" xref="S3.E2.m1.2.2.1.1.2.2.2.cmml"><mi id="S3.E2.m1.2.2.1.1.2.2.2.2" xref="S3.E2.m1.2.2.1.1.2.2.2.2.cmml">I</mi><mi id="S3.E2.m1.2.2.1.1.2.2.2.3" xref="S3.E2.m1.2.2.1.1.2.2.2.3.cmml">A</mi></msub><mo stretchy="false" id="S3.E2.m1.2.2.1.1.2.2.6" xref="S3.E2.m1.2.2.1.1.2.3.cmml">)</mo></mrow><mo id="S3.E2.m1.2.2.1.1.4" xref="S3.E2.m1.2.2.1.1.4.cmml">=</mo><mrow id="S3.E2.m1.2.2.1.1.3" xref="S3.E2.m1.2.2.1.1.3.cmml"><munder id="S3.E2.m1.2.2.1.1.3.2" xref="S3.E2.m1.2.2.1.1.3.2.cmml"><mrow id="S3.E2.m1.2.2.1.1.3.2.2" xref="S3.E2.m1.2.2.1.1.3.2.2.cmml"><mi id="S3.E2.m1.2.2.1.1.3.2.2.2" xref="S3.E2.m1.2.2.1.1.3.2.2.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.3.2.2.1" xref="S3.E2.m1.2.2.1.1.3.2.2.1.cmml">​</mo><mi id="S3.E2.m1.2.2.1.1.3.2.2.3" xref="S3.E2.m1.2.2.1.1.3.2.2.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.3.2.2.1a" xref="S3.E2.m1.2.2.1.1.3.2.2.1.cmml">​</mo><mi id="S3.E2.m1.2.2.1.1.3.2.2.4" xref="S3.E2.m1.2.2.1.1.3.2.2.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.3.2.2.1b" xref="S3.E2.m1.2.2.1.1.3.2.2.1.cmml">​</mo><mi id="S3.E2.m1.2.2.1.1.3.2.2.5" xref="S3.E2.m1.2.2.1.1.3.2.2.5.cmml">k</mi></mrow><mrow id="S3.E2.m1.2.2.1.1.3.2.3" xref="S3.E2.m1.2.2.1.1.3.2.3.cmml"><mrow id="S3.E2.m1.2.2.1.1.3.2.3.2" xref="S3.E2.m1.2.2.1.1.3.2.3.2.cmml"><mi id="S3.E2.m1.2.2.1.1.3.2.3.2.2" xref="S3.E2.m1.2.2.1.1.3.2.3.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.3.2.3.2.1" xref="S3.E2.m1.2.2.1.1.3.2.3.2.1.cmml">​</mo><mi id="S3.E2.m1.2.2.1.1.3.2.3.2.3" xref="S3.E2.m1.2.2.1.1.3.2.3.2.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.3.2.3.2.1a" xref="S3.E2.m1.2.2.1.1.3.2.3.2.1.cmml">​</mo><mi id="S3.E2.m1.2.2.1.1.3.2.3.2.4" xref="S3.E2.m1.2.2.1.1.3.2.3.2.4.cmml">m</mi></mrow><mo id="S3.E2.m1.2.2.1.1.3.2.3.1" xref="S3.E2.m1.2.2.1.1.3.2.3.1.cmml">=</mo><mn id="S3.E2.m1.2.2.1.1.3.2.3.3" xref="S3.E2.m1.2.2.1.1.3.2.3.3.cmml">0</mn></mrow></munder><mrow id="S3.E2.m1.2.2.1.1.3.1.1" xref="S3.E2.m1.2.2.1.1.3.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.2.2.1.1.3.1.1.2" xref="S3.E2.m1.2.2.1.1.3.1.1.1.cmml">(</mo><msubsup id="S3.E2.m1.2.2.1.1.3.1.1.1" xref="S3.E2.m1.2.2.1.1.3.1.1.1.cmml"><mi id="S3.E2.m1.2.2.1.1.3.1.1.1.2.2" xref="S3.E2.m1.2.2.1.1.3.1.1.1.2.2.cmml">F</mi><mrow id="S3.E2.m1.2.2.1.1.3.1.1.1.3" xref="S3.E2.m1.2.2.1.1.3.1.1.1.3.cmml"><mi id="S3.E2.m1.2.2.1.1.3.1.1.1.3.2" xref="S3.E2.m1.2.2.1.1.3.1.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.3.1.1.1.3.1" xref="S3.E2.m1.2.2.1.1.3.1.1.1.3.1.cmml">​</mo><mi id="S3.E2.m1.2.2.1.1.3.1.1.1.3.3" xref="S3.E2.m1.2.2.1.1.3.1.1.1.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.3.1.1.1.3.1a" xref="S3.E2.m1.2.2.1.1.3.1.1.1.3.1.cmml">​</mo><mi id="S3.E2.m1.2.2.1.1.3.1.1.1.3.4" xref="S3.E2.m1.2.2.1.1.3.1.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.3.1.1.1.3.1b" xref="S3.E2.m1.2.2.1.1.3.1.1.1.3.1.cmml">​</mo><mi id="S3.E2.m1.2.2.1.1.3.1.1.1.3.5" xref="S3.E2.m1.2.2.1.1.3.1.1.1.3.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.3.1.1.1.3.1c" xref="S3.E2.m1.2.2.1.1.3.1.1.1.3.1.cmml">​</mo><mi id="S3.E2.m1.2.2.1.1.3.1.1.1.3.6" xref="S3.E2.m1.2.2.1.1.3.1.1.1.3.6.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.3.1.1.1.3.1d" xref="S3.E2.m1.2.2.1.1.3.1.1.1.3.1.cmml">​</mo><mi id="S3.E2.m1.2.2.1.1.3.1.1.1.3.7" xref="S3.E2.m1.2.2.1.1.3.1.1.1.3.7.cmml">e</mi></mrow><mrow id="S3.E2.m1.2.2.1.1.3.1.1.1.2.3" xref="S3.E2.m1.2.2.1.1.3.1.1.1.2.3.cmml"><mi id="S3.E2.m1.2.2.1.1.3.1.1.1.2.3.2" xref="S3.E2.m1.2.2.1.1.3.1.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.3.1.1.1.2.3.1" xref="S3.E2.m1.2.2.1.1.3.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E2.m1.2.2.1.1.3.1.1.1.2.3.3" xref="S3.E2.m1.2.2.1.1.3.1.1.1.2.3.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.3.1.1.1.2.3.1a" xref="S3.E2.m1.2.2.1.1.3.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E2.m1.2.2.1.1.3.1.1.1.2.3.4" xref="S3.E2.m1.2.2.1.1.3.1.1.1.2.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.3.1.1.1.2.3.1b" xref="S3.E2.m1.2.2.1.1.3.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E2.m1.2.2.1.1.3.1.1.1.2.3.5" xref="S3.E2.m1.2.2.1.1.3.1.1.1.2.3.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.3.1.1.1.2.3.1c" xref="S3.E2.m1.2.2.1.1.3.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E2.m1.2.2.1.1.3.1.1.1.2.3.6" xref="S3.E2.m1.2.2.1.1.3.1.1.1.2.3.6.cmml">e</mi></mrow></msubsup><mo stretchy="false" id="S3.E2.m1.2.2.1.1.3.1.1.3" xref="S3.E2.m1.2.2.1.1.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E2.m1.2.2.1.2" xref="S3.E2.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.2b"><apply id="S3.E2.m1.2.2.1.1.cmml" xref="S3.E2.m1.2.2.1"><eq id="S3.E2.m1.2.2.1.1.4.cmml" xref="S3.E2.m1.2.2.1.1.4"></eq><vector id="S3.E2.m1.2.2.1.1.2.3.cmml" xref="S3.E2.m1.2.2.1.1.2.2"><apply id="S3.E2.m1.2.2.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.2">𝐼</ci><cn type="integer" id="S3.E2.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.3">1</cn></apply><ci id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">⋯</ci><apply id="S3.E2.m1.2.2.1.1.2.2.2.cmml" xref="S3.E2.m1.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.2.2.2.1.cmml" xref="S3.E2.m1.2.2.1.1.2.2.2">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.1.1.2.2.2.2">𝐼</ci><ci id="S3.E2.m1.2.2.1.1.2.2.2.3.cmml" xref="S3.E2.m1.2.2.1.1.2.2.2.3">𝐴</ci></apply></vector><apply id="S3.E2.m1.2.2.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.3"><apply id="S3.E2.m1.2.2.1.1.3.2.cmml" xref="S3.E2.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.3.2.1.cmml" xref="S3.E2.m1.2.2.1.1.3.2">subscript</csymbol><apply id="S3.E2.m1.2.2.1.1.3.2.2.cmml" xref="S3.E2.m1.2.2.1.1.3.2.2"><times id="S3.E2.m1.2.2.1.1.3.2.2.1.cmml" xref="S3.E2.m1.2.2.1.1.3.2.2.1"></times><ci id="S3.E2.m1.2.2.1.1.3.2.2.2.cmml" xref="S3.E2.m1.2.2.1.1.3.2.2.2">𝑡</ci><ci id="S3.E2.m1.2.2.1.1.3.2.2.3.cmml" xref="S3.E2.m1.2.2.1.1.3.2.2.3">𝑜</ci><ci id="S3.E2.m1.2.2.1.1.3.2.2.4.cmml" xref="S3.E2.m1.2.2.1.1.3.2.2.4">𝑝</ci><ci id="S3.E2.m1.2.2.1.1.3.2.2.5.cmml" xref="S3.E2.m1.2.2.1.1.3.2.2.5">𝑘</ci></apply><apply id="S3.E2.m1.2.2.1.1.3.2.3.cmml" xref="S3.E2.m1.2.2.1.1.3.2.3"><eq id="S3.E2.m1.2.2.1.1.3.2.3.1.cmml" xref="S3.E2.m1.2.2.1.1.3.2.3.1"></eq><apply id="S3.E2.m1.2.2.1.1.3.2.3.2.cmml" xref="S3.E2.m1.2.2.1.1.3.2.3.2"><times id="S3.E2.m1.2.2.1.1.3.2.3.2.1.cmml" xref="S3.E2.m1.2.2.1.1.3.2.3.2.1"></times><ci id="S3.E2.m1.2.2.1.1.3.2.3.2.2.cmml" xref="S3.E2.m1.2.2.1.1.3.2.3.2.2">𝑑</ci><ci id="S3.E2.m1.2.2.1.1.3.2.3.2.3.cmml" xref="S3.E2.m1.2.2.1.1.3.2.3.2.3">𝑖</ci><ci id="S3.E2.m1.2.2.1.1.3.2.3.2.4.cmml" xref="S3.E2.m1.2.2.1.1.3.2.3.2.4">𝑚</ci></apply><cn type="integer" id="S3.E2.m1.2.2.1.1.3.2.3.3.cmml" xref="S3.E2.m1.2.2.1.1.3.2.3.3">0</cn></apply></apply><apply id="S3.E2.m1.2.2.1.1.3.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.3.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.3.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.3.1.1">subscript</csymbol><apply id="S3.E2.m1.2.2.1.1.3.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.3.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.3.1.1.1.2.1.cmml" xref="S3.E2.m1.2.2.1.1.3.1.1">superscript</csymbol><ci id="S3.E2.m1.2.2.1.1.3.1.1.1.2.2.cmml" xref="S3.E2.m1.2.2.1.1.3.1.1.1.2.2">𝐹</ci><apply id="S3.E2.m1.2.2.1.1.3.1.1.1.2.3.cmml" xref="S3.E2.m1.2.2.1.1.3.1.1.1.2.3"><times id="S3.E2.m1.2.2.1.1.3.1.1.1.2.3.1.cmml" xref="S3.E2.m1.2.2.1.1.3.1.1.1.2.3.1"></times><ci id="S3.E2.m1.2.2.1.1.3.1.1.1.2.3.2.cmml" xref="S3.E2.m1.2.2.1.1.3.1.1.1.2.3.2">𝑠</ci><ci id="S3.E2.m1.2.2.1.1.3.1.1.1.2.3.3.cmml" xref="S3.E2.m1.2.2.1.1.3.1.1.1.2.3.3">𝑐</ci><ci id="S3.E2.m1.2.2.1.1.3.1.1.1.2.3.4.cmml" xref="S3.E2.m1.2.2.1.1.3.1.1.1.2.3.4">𝑜</ci><ci id="S3.E2.m1.2.2.1.1.3.1.1.1.2.3.5.cmml" xref="S3.E2.m1.2.2.1.1.3.1.1.1.2.3.5">𝑟</ci><ci id="S3.E2.m1.2.2.1.1.3.1.1.1.2.3.6.cmml" xref="S3.E2.m1.2.2.1.1.3.1.1.1.2.3.6">𝑒</ci></apply></apply><apply id="S3.E2.m1.2.2.1.1.3.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.3.1.1.1.3"><times id="S3.E2.m1.2.2.1.1.3.1.1.1.3.1.cmml" xref="S3.E2.m1.2.2.1.1.3.1.1.1.3.1"></times><ci id="S3.E2.m1.2.2.1.1.3.1.1.1.3.2.cmml" xref="S3.E2.m1.2.2.1.1.3.1.1.1.3.2">𝑠</ci><ci id="S3.E2.m1.2.2.1.1.3.1.1.1.3.3.cmml" xref="S3.E2.m1.2.2.1.1.3.1.1.1.3.3">𝑝</ci><ci id="S3.E2.m1.2.2.1.1.3.1.1.1.3.4.cmml" xref="S3.E2.m1.2.2.1.1.3.1.1.1.3.4">𝑎</ci><ci id="S3.E2.m1.2.2.1.1.3.1.1.1.3.5.cmml" xref="S3.E2.m1.2.2.1.1.3.1.1.1.3.5">𝑟</ci><ci id="S3.E2.m1.2.2.1.1.3.1.1.1.3.6.cmml" xref="S3.E2.m1.2.2.1.1.3.1.1.1.3.6">𝑠</ci><ci id="S3.E2.m1.2.2.1.1.3.1.1.1.3.7.cmml" xref="S3.E2.m1.2.2.1.1.3.1.1.1.3.7">𝑒</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.2c">(I_{1},\cdots,I_{A})=\mathop{topk}\limits_{dim=0}(F^{score}_{sparse}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS0.Px1.p1.14" class="ltx_p">where <math id="S3.SS2.SSS0.Px1.p1.7.m1.1" class="ltx_Math" alttext="I_{i}\in\mathbb{Z}^{N}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p1.7.m1.1a"><mrow id="S3.SS2.SSS0.Px1.p1.7.m1.1.1" xref="S3.SS2.SSS0.Px1.p1.7.m1.1.1.cmml"><msub id="S3.SS2.SSS0.Px1.p1.7.m1.1.1.2" xref="S3.SS2.SSS0.Px1.p1.7.m1.1.1.2.cmml"><mi id="S3.SS2.SSS0.Px1.p1.7.m1.1.1.2.2" xref="S3.SS2.SSS0.Px1.p1.7.m1.1.1.2.2.cmml">I</mi><mi id="S3.SS2.SSS0.Px1.p1.7.m1.1.1.2.3" xref="S3.SS2.SSS0.Px1.p1.7.m1.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS2.SSS0.Px1.p1.7.m1.1.1.1" xref="S3.SS2.SSS0.Px1.p1.7.m1.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS0.Px1.p1.7.m1.1.1.3" xref="S3.SS2.SSS0.Px1.p1.7.m1.1.1.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.7.m1.1.1.3.2" xref="S3.SS2.SSS0.Px1.p1.7.m1.1.1.3.2.cmml">ℤ</mi><mi id="S3.SS2.SSS0.Px1.p1.7.m1.1.1.3.3" xref="S3.SS2.SSS0.Px1.p1.7.m1.1.1.3.3.cmml">N</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.7.m1.1b"><apply id="S3.SS2.SSS0.Px1.p1.7.m1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m1.1.1"><in id="S3.SS2.SSS0.Px1.p1.7.m1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m1.1.1.1"></in><apply id="S3.SS2.SSS0.Px1.p1.7.m1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.7.m1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m1.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.7.m1.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m1.1.1.2.2">𝐼</ci><ci id="S3.SS2.SSS0.Px1.p1.7.m1.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m1.1.1.2.3">𝑖</ci></apply><apply id="S3.SS2.SSS0.Px1.p1.7.m1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.7.m1.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m1.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.7.m1.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m1.1.1.3.2">ℤ</ci><ci id="S3.SS2.SSS0.Px1.p1.7.m1.1.1.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m1.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.7.m1.1c">I_{i}\in\mathbb{Z}^{N}</annotation></semantics></math> denotes the <math id="S3.SS2.SSS0.Px1.p1.8.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS2.SSS0.Px1.p1.8.m2.1a"><mi id="S3.SS2.SSS0.Px1.p1.8.m2.1.1" xref="S3.SS2.SSS0.Px1.p1.8.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.8.m2.1b"><ci id="S3.SS2.SSS0.Px1.p1.8.m2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.8.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.8.m2.1c">N</annotation></semantics></math> indexes of the pixels with the top-k scores in the <math id="S3.SS2.SSS0.Px1.p1.9.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.SSS0.Px1.p1.9.m3.1a"><mi id="S3.SS2.SSS0.Px1.p1.9.m3.1.1" xref="S3.SS2.SSS0.Px1.p1.9.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.9.m3.1b"><ci id="S3.SS2.SSS0.Px1.p1.9.m3.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.9.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.9.m3.1c">i</annotation></semantics></math>-th column.
This top-k operator takes advantage of the data prior: in polar BEV maps, the pixels along the radial direction encode points from a small scanning angle.
The information in each column is limited due to the occlusion between objects and is distributed in a concentrated manner on the objects or stuff.
Therefore, the selected pixels generally indicate where the 3D object is likely to appear in the 3D scene and could be regarded as representative querying pixels of the column.
Introducing these representative features avoids the noise and computational overhead introduced by the background area and maintains the diversity of object features in the range aspect.
Afterward, we compress each column to its representative features.
Let <math id="S3.SS2.SSS0.Px1.p1.10.m4.3" class="ltx_Math" alttext="f^{{}^{\prime}}_{i}=F[I_{i},i,:]\in\mathbb{R}^{N\times C}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p1.10.m4.3a"><mrow id="S3.SS2.SSS0.Px1.p1.10.m4.3.3" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.cmml"><msubsup id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.3" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.3.2.2" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.3.2.2.cmml">f</mi><mi id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.3.3" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.3.3.cmml">i</mi><msup id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.3.2.3" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.3.2.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.3.2.3a" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.3.2.3.cmml"></mi><mo id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.3.2.3.1" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.3.2.3.1.cmml">′</mo></msup></msubsup><mo id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.4" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.4.cmml">=</mo><mrow id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.1" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.1.3" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.1.3.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.1.2" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.1.2.cmml">​</mo><mrow id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.1.1.1" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.1.1.1.2" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.1.1.2.cmml">[</mo><msub id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.1.1.1.1" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.1.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.1.1.1.1.2" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.1.1.1.1.2.cmml">I</mi><mi id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.1.1.1.1.3" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.1.1.1.3" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.1.1.2.cmml">,</mo><mi id="S3.SS2.SSS0.Px1.p1.10.m4.1.1" xref="S3.SS2.SSS0.Px1.p1.10.m4.1.1.cmml">i</mi><mo id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.1.1.1.4" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.1.1.2.cmml">,</mo><mo rspace="0em" id="S3.SS2.SSS0.Px1.p1.10.m4.2.2" xref="S3.SS2.SSS0.Px1.p1.10.m4.2.2.cmml">:</mo><mo stretchy="false" id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.1.1.1.5" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.1.1.2.cmml">]</mo></mrow></mrow><mo id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.5" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.5.cmml">∈</mo><msup id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.6" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.6.cmml"><mi id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.6.2" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.6.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.6.3" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.6.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.6.3.2" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.6.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.6.3.1" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.6.3.1.cmml">×</mo><mi id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.6.3.3" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.6.3.3.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.10.m4.3b"><apply id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3"><and id="S3.SS2.SSS0.Px1.p1.10.m4.3.3a.cmml" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3"></and><apply id="S3.SS2.SSS0.Px1.p1.10.m4.3.3b.cmml" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3"><eq id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.4.cmml" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.4"></eq><apply id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.3">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.3.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.3.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.3.2.2">𝑓</ci><apply id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.3.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.3.2.3"><ci id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.3.2.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.3.2.3.1">′</ci></apply></apply><ci id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.3.3">𝑖</ci></apply><apply id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.1"><times id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.1.2"></times><ci id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.1.3">𝐹</ci><list id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.1.1.1"><apply id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.1.1.1.1.2">𝐼</ci><ci id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.1.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.1.1.1.1.3">𝑖</ci></apply><ci id="S3.SS2.SSS0.Px1.p1.10.m4.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.10.m4.1.1">𝑖</ci><ci id="S3.SS2.SSS0.Px1.p1.10.m4.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.10.m4.2.2">:</ci></list></apply></apply><apply id="S3.SS2.SSS0.Px1.p1.10.m4.3.3c.cmml" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3"><in id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.5.cmml" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.5"></in><share href="#S3.SS2.SSS0.Px1.p1.10.m4.3.3.1.cmml" id="S3.SS2.SSS0.Px1.p1.10.m4.3.3d.cmml" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3"></share><apply id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.6.cmml" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.6"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.6.1.cmml" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.6">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.6.2.cmml" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.6.2">ℝ</ci><apply id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.6.3.cmml" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.6.3"><times id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.6.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.6.3.1"></times><ci id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.6.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.6.3.2">𝑁</ci><ci id="S3.SS2.SSS0.Px1.p1.10.m4.3.3.6.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.10.m4.3.3.6.3.3">𝐶</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.10.m4.3c">f^{{}^{\prime}}_{i}=F[I_{i},i,:]\in\mathbb{R}^{N\times C}</annotation></semantics></math> and <math id="S3.SS2.SSS0.Px1.p1.11.m5.3" class="ltx_Math" alttext="f_{i}=F[:,i,:]\in\mathbb{R}^{R\times C}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p1.11.m5.3a"><mrow id="S3.SS2.SSS0.Px1.p1.11.m5.3.4" xref="S3.SS2.SSS0.Px1.p1.11.m5.3.4.cmml"><msub id="S3.SS2.SSS0.Px1.p1.11.m5.3.4.2" xref="S3.SS2.SSS0.Px1.p1.11.m5.3.4.2.cmml"><mi id="S3.SS2.SSS0.Px1.p1.11.m5.3.4.2.2" xref="S3.SS2.SSS0.Px1.p1.11.m5.3.4.2.2.cmml">f</mi><mi id="S3.SS2.SSS0.Px1.p1.11.m5.3.4.2.3" xref="S3.SS2.SSS0.Px1.p1.11.m5.3.4.2.3.cmml">i</mi></msub><mo id="S3.SS2.SSS0.Px1.p1.11.m5.3.4.3" xref="S3.SS2.SSS0.Px1.p1.11.m5.3.4.3.cmml">=</mo><mrow id="S3.SS2.SSS0.Px1.p1.11.m5.3.4.4" xref="S3.SS2.SSS0.Px1.p1.11.m5.3.4.4.cmml"><mi id="S3.SS2.SSS0.Px1.p1.11.m5.3.4.4.2" xref="S3.SS2.SSS0.Px1.p1.11.m5.3.4.4.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS0.Px1.p1.11.m5.3.4.4.1" xref="S3.SS2.SSS0.Px1.p1.11.m5.3.4.4.1.cmml">​</mo><mrow id="S3.SS2.SSS0.Px1.p1.11.m5.3.4.4.3.2" xref="S3.SS2.SSS0.Px1.p1.11.m5.3.4.4.3.1.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px1.p1.11.m5.3.4.4.3.2.1" xref="S3.SS2.SSS0.Px1.p1.11.m5.3.4.4.3.1.cmml">[</mo><mo rspace="0em" id="S3.SS2.SSS0.Px1.p1.11.m5.1.1" xref="S3.SS2.SSS0.Px1.p1.11.m5.1.1.cmml">:</mo><mo id="S3.SS2.SSS0.Px1.p1.11.m5.3.4.4.3.2.2" xref="S3.SS2.SSS0.Px1.p1.11.m5.3.4.4.3.1.cmml">,</mo><mi id="S3.SS2.SSS0.Px1.p1.11.m5.2.2" xref="S3.SS2.SSS0.Px1.p1.11.m5.2.2.cmml">i</mi><mo id="S3.SS2.SSS0.Px1.p1.11.m5.3.4.4.3.2.3" xref="S3.SS2.SSS0.Px1.p1.11.m5.3.4.4.3.1.cmml">,</mo><mo rspace="0em" id="S3.SS2.SSS0.Px1.p1.11.m5.3.3" xref="S3.SS2.SSS0.Px1.p1.11.m5.3.3.cmml">:</mo><mo stretchy="false" id="S3.SS2.SSS0.Px1.p1.11.m5.3.4.4.3.2.4" xref="S3.SS2.SSS0.Px1.p1.11.m5.3.4.4.3.1.cmml">]</mo></mrow></mrow><mo id="S3.SS2.SSS0.Px1.p1.11.m5.3.4.5" xref="S3.SS2.SSS0.Px1.p1.11.m5.3.4.5.cmml">∈</mo><msup id="S3.SS2.SSS0.Px1.p1.11.m5.3.4.6" xref="S3.SS2.SSS0.Px1.p1.11.m5.3.4.6.cmml"><mi id="S3.SS2.SSS0.Px1.p1.11.m5.3.4.6.2" xref="S3.SS2.SSS0.Px1.p1.11.m5.3.4.6.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS0.Px1.p1.11.m5.3.4.6.3" xref="S3.SS2.SSS0.Px1.p1.11.m5.3.4.6.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.11.m5.3.4.6.3.2" xref="S3.SS2.SSS0.Px1.p1.11.m5.3.4.6.3.2.cmml">R</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.SSS0.Px1.p1.11.m5.3.4.6.3.1" xref="S3.SS2.SSS0.Px1.p1.11.m5.3.4.6.3.1.cmml">×</mo><mi id="S3.SS2.SSS0.Px1.p1.11.m5.3.4.6.3.3" xref="S3.SS2.SSS0.Px1.p1.11.m5.3.4.6.3.3.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.11.m5.3b"><apply id="S3.SS2.SSS0.Px1.p1.11.m5.3.4.cmml" xref="S3.SS2.SSS0.Px1.p1.11.m5.3.4"><and id="S3.SS2.SSS0.Px1.p1.11.m5.3.4a.cmml" xref="S3.SS2.SSS0.Px1.p1.11.m5.3.4"></and><apply id="S3.SS2.SSS0.Px1.p1.11.m5.3.4b.cmml" xref="S3.SS2.SSS0.Px1.p1.11.m5.3.4"><eq id="S3.SS2.SSS0.Px1.p1.11.m5.3.4.3.cmml" xref="S3.SS2.SSS0.Px1.p1.11.m5.3.4.3"></eq><apply id="S3.SS2.SSS0.Px1.p1.11.m5.3.4.2.cmml" xref="S3.SS2.SSS0.Px1.p1.11.m5.3.4.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.11.m5.3.4.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.11.m5.3.4.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.11.m5.3.4.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.11.m5.3.4.2.2">𝑓</ci><ci id="S3.SS2.SSS0.Px1.p1.11.m5.3.4.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.11.m5.3.4.2.3">𝑖</ci></apply><apply id="S3.SS2.SSS0.Px1.p1.11.m5.3.4.4.cmml" xref="S3.SS2.SSS0.Px1.p1.11.m5.3.4.4"><times id="S3.SS2.SSS0.Px1.p1.11.m5.3.4.4.1.cmml" xref="S3.SS2.SSS0.Px1.p1.11.m5.3.4.4.1"></times><ci id="S3.SS2.SSS0.Px1.p1.11.m5.3.4.4.2.cmml" xref="S3.SS2.SSS0.Px1.p1.11.m5.3.4.4.2">𝐹</ci><list id="S3.SS2.SSS0.Px1.p1.11.m5.3.4.4.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.11.m5.3.4.4.3.2"><ci id="S3.SS2.SSS0.Px1.p1.11.m5.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.11.m5.1.1">:</ci><ci id="S3.SS2.SSS0.Px1.p1.11.m5.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.11.m5.2.2">𝑖</ci><ci id="S3.SS2.SSS0.Px1.p1.11.m5.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.11.m5.3.3">:</ci></list></apply></apply><apply id="S3.SS2.SSS0.Px1.p1.11.m5.3.4c.cmml" xref="S3.SS2.SSS0.Px1.p1.11.m5.3.4"><in id="S3.SS2.SSS0.Px1.p1.11.m5.3.4.5.cmml" xref="S3.SS2.SSS0.Px1.p1.11.m5.3.4.5"></in><share href="#S3.SS2.SSS0.Px1.p1.11.m5.3.4.4.cmml" id="S3.SS2.SSS0.Px1.p1.11.m5.3.4d.cmml" xref="S3.SS2.SSS0.Px1.p1.11.m5.3.4"></share><apply id="S3.SS2.SSS0.Px1.p1.11.m5.3.4.6.cmml" xref="S3.SS2.SSS0.Px1.p1.11.m5.3.4.6"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.11.m5.3.4.6.1.cmml" xref="S3.SS2.SSS0.Px1.p1.11.m5.3.4.6">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.11.m5.3.4.6.2.cmml" xref="S3.SS2.SSS0.Px1.p1.11.m5.3.4.6.2">ℝ</ci><apply id="S3.SS2.SSS0.Px1.p1.11.m5.3.4.6.3.cmml" xref="S3.SS2.SSS0.Px1.p1.11.m5.3.4.6.3"><times id="S3.SS2.SSS0.Px1.p1.11.m5.3.4.6.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.11.m5.3.4.6.3.1"></times><ci id="S3.SS2.SSS0.Px1.p1.11.m5.3.4.6.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.11.m5.3.4.6.3.2">𝑅</ci><ci id="S3.SS2.SSS0.Px1.p1.11.m5.3.4.6.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.11.m5.3.4.6.3.3">𝐶</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.11.m5.3c">f_{i}=F[:,i,:]\in\mathbb{R}^{R\times C}</annotation></semantics></math> be the query and attending features of the <math id="S3.SS2.SSS0.Px1.p1.12.m6.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.SSS0.Px1.p1.12.m6.1a"><mi id="S3.SS2.SSS0.Px1.p1.12.m6.1.1" xref="S3.SS2.SSS0.Px1.p1.12.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.12.m6.1b"><ci id="S3.SS2.SSS0.Px1.p1.12.m6.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.12.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.12.m6.1c">i</annotation></semantics></math>-th column, and <math id="S3.SS2.SSS0.Px1.p1.13.m7.2" class="ltx_Math" alttext="p_{i},p^{{}^{\prime}}_{i}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p1.13.m7.2a"><mrow id="S3.SS2.SSS0.Px1.p1.13.m7.2.2.2" xref="S3.SS2.SSS0.Px1.p1.13.m7.2.2.3.cmml"><msub id="S3.SS2.SSS0.Px1.p1.13.m7.1.1.1.1" xref="S3.SS2.SSS0.Px1.p1.13.m7.1.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.13.m7.1.1.1.1.2" xref="S3.SS2.SSS0.Px1.p1.13.m7.1.1.1.1.2.cmml">p</mi><mi id="S3.SS2.SSS0.Px1.p1.13.m7.1.1.1.1.3" xref="S3.SS2.SSS0.Px1.p1.13.m7.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.SSS0.Px1.p1.13.m7.2.2.2.3" xref="S3.SS2.SSS0.Px1.p1.13.m7.2.2.3.cmml">,</mo><msubsup id="S3.SS2.SSS0.Px1.p1.13.m7.2.2.2.2" xref="S3.SS2.SSS0.Px1.p1.13.m7.2.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px1.p1.13.m7.2.2.2.2.2.2" xref="S3.SS2.SSS0.Px1.p1.13.m7.2.2.2.2.2.2.cmml">p</mi><mi id="S3.SS2.SSS0.Px1.p1.13.m7.2.2.2.2.3" xref="S3.SS2.SSS0.Px1.p1.13.m7.2.2.2.2.3.cmml">i</mi><msup id="S3.SS2.SSS0.Px1.p1.13.m7.2.2.2.2.2.3" xref="S3.SS2.SSS0.Px1.p1.13.m7.2.2.2.2.2.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.13.m7.2.2.2.2.2.3a" xref="S3.SS2.SSS0.Px1.p1.13.m7.2.2.2.2.2.3.cmml"></mi><mo id="S3.SS2.SSS0.Px1.p1.13.m7.2.2.2.2.2.3.1" xref="S3.SS2.SSS0.Px1.p1.13.m7.2.2.2.2.2.3.1.cmml">′</mo></msup></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.13.m7.2b"><list id="S3.SS2.SSS0.Px1.p1.13.m7.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.13.m7.2.2.2"><apply id="S3.SS2.SSS0.Px1.p1.13.m7.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.13.m7.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.13.m7.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.13.m7.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.13.m7.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.13.m7.1.1.1.1.2">𝑝</ci><ci id="S3.SS2.SSS0.Px1.p1.13.m7.1.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.13.m7.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS2.SSS0.Px1.p1.13.m7.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.13.m7.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.13.m7.2.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.13.m7.2.2.2.2">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p1.13.m7.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.13.m7.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.13.m7.2.2.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.13.m7.2.2.2.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.13.m7.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.13.m7.2.2.2.2.2.2">𝑝</ci><apply id="S3.SS2.SSS0.Px1.p1.13.m7.2.2.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.13.m7.2.2.2.2.2.3"><ci id="S3.SS2.SSS0.Px1.p1.13.m7.2.2.2.2.2.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.13.m7.2.2.2.2.2.3.1">′</ci></apply></apply><ci id="S3.SS2.SSS0.Px1.p1.13.m7.2.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.13.m7.2.2.2.2.3">𝑖</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.13.m7.2c">p_{i},p^{{}^{\prime}}_{i}</annotation></semantics></math> be the corresponding coordinates of the real pixel centers in both polar and Cartesian systems.
For the <math id="S3.SS2.SSS0.Px1.p1.14.m8.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.SSS0.Px1.p1.14.m8.1a"><mi id="S3.SS2.SSS0.Px1.p1.14.m8.1.1" xref="S3.SS2.SSS0.Px1.p1.14.m8.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.14.m8.1b"><ci id="S3.SS2.SSS0.Px1.p1.14.m8.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.14.m8.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.14.m8.1c">i</annotation></semantics></math>-th column, we conduct dot-product attention as follows:</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.56" class="ltx_Math" alttext="\begin{split}&amp;Q_{i}=f^{{}^{\prime}}_{i}W_{q},K_{i}=f_{i}W_{k},V_{i}=f_{i}W_{v},\\
&amp;f^{rep}_{i}=softmax(\frac{Q_{i}K_{i}^{T}}{\sqrt{d}})\cdot V_{i}+E(p_{i},p^{{}^{\prime}}_{i}),\end{split}" display="block"><semantics id="S3.E3.m1.56a"><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt" id="S3.E3.m1.56.56.3"><mtr id="S3.E3.m1.56.56.3a"><mtd id="S3.E3.m1.56.56.3b"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E3.m1.56.56.3c"><mrow id="S3.E3.m1.55.55.2.54.26.26.26"><mrow id="S3.E3.m1.55.55.2.54.26.26.26.1"><mrow id="S3.E3.m1.55.55.2.54.26.26.26.1.1.1"><msub id="S3.E3.m1.55.55.2.54.26.26.26.1.1.1.1"><mi id="S3.E3.m1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.cmml">Q</mi><mi id="S3.E3.m1.2.2.2.2.2.2.1" xref="S3.E3.m1.2.2.2.2.2.2.1.cmml">i</mi></msub><mo id="S3.E3.m1.3.3.3.3.3.3" xref="S3.E3.m1.3.3.3.3.3.3.cmml">=</mo><mrow id="S3.E3.m1.55.55.2.54.26.26.26.1.1.1.2"><msubsup id="S3.E3.m1.55.55.2.54.26.26.26.1.1.1.2.2"><mi id="S3.E3.m1.4.4.4.4.4.4" xref="S3.E3.m1.4.4.4.4.4.4.cmml">f</mi><mi id="S3.E3.m1.6.6.6.6.6.6.1" xref="S3.E3.m1.6.6.6.6.6.6.1.cmml">i</mi><msup id="S3.E3.m1.5.5.5.5.5.5.1" xref="S3.E3.m1.5.5.5.5.5.5.1.cmml"><mi id="S3.E3.m1.5.5.5.5.5.5.1a" xref="S3.E3.m1.5.5.5.5.5.5.1.cmml"></mi><mo id="S3.E3.m1.5.5.5.5.5.5.1.1" xref="S3.E3.m1.5.5.5.5.5.5.1.1.cmml">′</mo></msup></msubsup><mo lspace="0em" rspace="0em" id="S3.E3.m1.55.55.2.54.26.26.26.1.1.1.2.1">​</mo><msub id="S3.E3.m1.55.55.2.54.26.26.26.1.1.1.2.3"><mi id="S3.E3.m1.7.7.7.7.7.7" xref="S3.E3.m1.7.7.7.7.7.7.cmml">W</mi><mi id="S3.E3.m1.8.8.8.8.8.8.1" xref="S3.E3.m1.8.8.8.8.8.8.1.cmml">q</mi></msub></mrow></mrow><mo id="S3.E3.m1.9.9.9.9.9.9">,</mo><mrow id="S3.E3.m1.55.55.2.54.26.26.26.1.2.2"><mrow id="S3.E3.m1.55.55.2.54.26.26.26.1.2.2.1.1"><msub id="S3.E3.m1.55.55.2.54.26.26.26.1.2.2.1.1.1"><mi id="S3.E3.m1.10.10.10.10.10.10" xref="S3.E3.m1.10.10.10.10.10.10.cmml">K</mi><mi id="S3.E3.m1.11.11.11.11.11.11.1" xref="S3.E3.m1.11.11.11.11.11.11.1.cmml">i</mi></msub><mo id="S3.E3.m1.12.12.12.12.12.12" xref="S3.E3.m1.12.12.12.12.12.12.cmml">=</mo><mrow id="S3.E3.m1.55.55.2.54.26.26.26.1.2.2.1.1.2"><msub id="S3.E3.m1.55.55.2.54.26.26.26.1.2.2.1.1.2.2"><mi id="S3.E3.m1.13.13.13.13.13.13" xref="S3.E3.m1.13.13.13.13.13.13.cmml">f</mi><mi id="S3.E3.m1.14.14.14.14.14.14.1" xref="S3.E3.m1.14.14.14.14.14.14.1.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.55.55.2.54.26.26.26.1.2.2.1.1.2.1">​</mo><msub id="S3.E3.m1.55.55.2.54.26.26.26.1.2.2.1.1.2.3"><mi id="S3.E3.m1.15.15.15.15.15.15" xref="S3.E3.m1.15.15.15.15.15.15.cmml">W</mi><mi id="S3.E3.m1.16.16.16.16.16.16.1" xref="S3.E3.m1.16.16.16.16.16.16.1.cmml">k</mi></msub></mrow></mrow><mo id="S3.E3.m1.17.17.17.17.17.17">,</mo><mrow id="S3.E3.m1.55.55.2.54.26.26.26.1.2.2.2.2"><msub id="S3.E3.m1.55.55.2.54.26.26.26.1.2.2.2.2.1"><mi id="S3.E3.m1.18.18.18.18.18.18" xref="S3.E3.m1.18.18.18.18.18.18.cmml">V</mi><mi id="S3.E3.m1.19.19.19.19.19.19.1" xref="S3.E3.m1.19.19.19.19.19.19.1.cmml">i</mi></msub><mo id="S3.E3.m1.20.20.20.20.20.20" xref="S3.E3.m1.20.20.20.20.20.20.cmml">=</mo><mrow id="S3.E3.m1.55.55.2.54.26.26.26.1.2.2.2.2.2"><msub id="S3.E3.m1.55.55.2.54.26.26.26.1.2.2.2.2.2.2"><mi id="S3.E3.m1.21.21.21.21.21.21" xref="S3.E3.m1.21.21.21.21.21.21.cmml">f</mi><mi id="S3.E3.m1.22.22.22.22.22.22.1" xref="S3.E3.m1.22.22.22.22.22.22.1.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.55.55.2.54.26.26.26.1.2.2.2.2.2.1">​</mo><msub id="S3.E3.m1.55.55.2.54.26.26.26.1.2.2.2.2.2.3"><mi id="S3.E3.m1.23.23.23.23.23.23" xref="S3.E3.m1.23.23.23.23.23.23.cmml">W</mi><mi id="S3.E3.m1.24.24.24.24.24.24.1" xref="S3.E3.m1.24.24.24.24.24.24.1.cmml">v</mi></msub></mrow></mrow></mrow></mrow><mo id="S3.E3.m1.25.25.25.25.25.25">,</mo></mrow></mtd></mtr><mtr id="S3.E3.m1.56.56.3d"><mtd id="S3.E3.m1.56.56.3e"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E3.m1.56.56.3f"><mrow id="S3.E3.m1.56.56.3.55.29.29.29"><mrow id="S3.E3.m1.56.56.3.55.29.29.29.1"><msubsup id="S3.E3.m1.56.56.3.55.29.29.29.1.3"><mi id="S3.E3.m1.26.26.26.1.1.1" xref="S3.E3.m1.26.26.26.1.1.1.cmml">f</mi><mi id="S3.E3.m1.28.28.28.3.3.3.1" xref="S3.E3.m1.28.28.28.3.3.3.1.cmml">i</mi><mrow id="S3.E3.m1.27.27.27.2.2.2.1" xref="S3.E3.m1.27.27.27.2.2.2.1.cmml"><mi id="S3.E3.m1.27.27.27.2.2.2.1.2" xref="S3.E3.m1.27.27.27.2.2.2.1.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.27.27.27.2.2.2.1.1" xref="S3.E3.m1.27.27.27.2.2.2.1.1.cmml">​</mo><mi id="S3.E3.m1.27.27.27.2.2.2.1.3" xref="S3.E3.m1.27.27.27.2.2.2.1.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.27.27.27.2.2.2.1.1a" xref="S3.E3.m1.27.27.27.2.2.2.1.1.cmml">​</mo><mi id="S3.E3.m1.27.27.27.2.2.2.1.4" xref="S3.E3.m1.27.27.27.2.2.2.1.4.cmml">p</mi></mrow></msubsup><mo id="S3.E3.m1.29.29.29.4.4.4" xref="S3.E3.m1.29.29.29.4.4.4.cmml">=</mo><mrow id="S3.E3.m1.56.56.3.55.29.29.29.1.2"><mrow id="S3.E3.m1.56.56.3.55.29.29.29.1.2.3"><mrow id="S3.E3.m1.56.56.3.55.29.29.29.1.2.3.1"><mi id="S3.E3.m1.30.30.30.5.5.5" xref="S3.E3.m1.30.30.30.5.5.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.56.56.3.55.29.29.29.1.2.3.1.1">​</mo><mi id="S3.E3.m1.31.31.31.6.6.6" xref="S3.E3.m1.31.31.31.6.6.6.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.56.56.3.55.29.29.29.1.2.3.1.1a">​</mo><mi id="S3.E3.m1.32.32.32.7.7.7" xref="S3.E3.m1.32.32.32.7.7.7.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.56.56.3.55.29.29.29.1.2.3.1.1b">​</mo><mi id="S3.E3.m1.33.33.33.8.8.8" xref="S3.E3.m1.33.33.33.8.8.8.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.56.56.3.55.29.29.29.1.2.3.1.1c">​</mo><mi id="S3.E3.m1.34.34.34.9.9.9" xref="S3.E3.m1.34.34.34.9.9.9.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.56.56.3.55.29.29.29.1.2.3.1.1d">​</mo><mi id="S3.E3.m1.35.35.35.10.10.10" xref="S3.E3.m1.35.35.35.10.10.10.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.56.56.3.55.29.29.29.1.2.3.1.1e">​</mo><mi id="S3.E3.m1.36.36.36.11.11.11" xref="S3.E3.m1.36.36.36.11.11.11.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.56.56.3.55.29.29.29.1.2.3.1.1f">​</mo><mrow id="S3.E3.m1.56.56.3.55.29.29.29.1.2.3.1.2"><mo stretchy="false" id="S3.E3.m1.37.37.37.12.12.12">(</mo><mfrac id="S3.E3.m1.38.38.38.13.13.13" xref="S3.E3.m1.38.38.38.13.13.13.cmml"><mrow id="S3.E3.m1.38.38.38.13.13.13.2" xref="S3.E3.m1.38.38.38.13.13.13.2.cmml"><msub id="S3.E3.m1.38.38.38.13.13.13.2.2" xref="S3.E3.m1.38.38.38.13.13.13.2.2.cmml"><mi id="S3.E3.m1.38.38.38.13.13.13.2.2.2" xref="S3.E3.m1.38.38.38.13.13.13.2.2.2.cmml">Q</mi><mi id="S3.E3.m1.38.38.38.13.13.13.2.2.3" xref="S3.E3.m1.38.38.38.13.13.13.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.38.38.38.13.13.13.2.1" xref="S3.E3.m1.38.38.38.13.13.13.2.1.cmml">​</mo><msubsup id="S3.E3.m1.38.38.38.13.13.13.2.3" xref="S3.E3.m1.38.38.38.13.13.13.2.3.cmml"><mi id="S3.E3.m1.38.38.38.13.13.13.2.3.2.2" xref="S3.E3.m1.38.38.38.13.13.13.2.3.2.2.cmml">K</mi><mi id="S3.E3.m1.38.38.38.13.13.13.2.3.2.3" xref="S3.E3.m1.38.38.38.13.13.13.2.3.2.3.cmml">i</mi><mi id="S3.E3.m1.38.38.38.13.13.13.2.3.3" xref="S3.E3.m1.38.38.38.13.13.13.2.3.3.cmml">T</mi></msubsup></mrow><msqrt id="S3.E3.m1.38.38.38.13.13.13.3" xref="S3.E3.m1.38.38.38.13.13.13.3.cmml"><mi id="S3.E3.m1.38.38.38.13.13.13.3.2" xref="S3.E3.m1.38.38.38.13.13.13.3.2.cmml">d</mi></msqrt></mfrac><mo rspace="0.055em" stretchy="false" id="S3.E3.m1.39.39.39.14.14.14">)</mo></mrow></mrow><mo rspace="0.222em" id="S3.E3.m1.40.40.40.15.15.15" xref="S3.E3.m1.40.40.40.15.15.15.cmml">⋅</mo><msub id="S3.E3.m1.56.56.3.55.29.29.29.1.2.3.2"><mi id="S3.E3.m1.41.41.41.16.16.16" xref="S3.E3.m1.41.41.41.16.16.16.cmml">V</mi><mi id="S3.E3.m1.42.42.42.17.17.17.1" xref="S3.E3.m1.42.42.42.17.17.17.1.cmml">i</mi></msub></mrow><mo id="S3.E3.m1.43.43.43.18.18.18" xref="S3.E3.m1.43.43.43.18.18.18.cmml">+</mo><mrow id="S3.E3.m1.56.56.3.55.29.29.29.1.2.2"><mi id="S3.E3.m1.44.44.44.19.19.19" xref="S3.E3.m1.44.44.44.19.19.19.cmml">E</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.56.56.3.55.29.29.29.1.2.2.3">​</mo><mrow id="S3.E3.m1.56.56.3.55.29.29.29.1.2.2.2.2"><mo stretchy="false" id="S3.E3.m1.45.45.45.20.20.20">(</mo><msub id="S3.E3.m1.56.56.3.55.29.29.29.1.1.1.1.1.1"><mi id="S3.E3.m1.46.46.46.21.21.21" xref="S3.E3.m1.46.46.46.21.21.21.cmml">p</mi><mi id="S3.E3.m1.47.47.47.22.22.22.1" xref="S3.E3.m1.47.47.47.22.22.22.1.cmml">i</mi></msub><mo id="S3.E3.m1.48.48.48.23.23.23">,</mo><msubsup id="S3.E3.m1.56.56.3.55.29.29.29.1.2.2.2.2.2"><mi id="S3.E3.m1.49.49.49.24.24.24" xref="S3.E3.m1.49.49.49.24.24.24.cmml">p</mi><mi id="S3.E3.m1.51.51.51.26.26.26.1" xref="S3.E3.m1.51.51.51.26.26.26.1.cmml">i</mi><msup id="S3.E3.m1.50.50.50.25.25.25.1" xref="S3.E3.m1.50.50.50.25.25.25.1.cmml"><mi id="S3.E3.m1.50.50.50.25.25.25.1a" xref="S3.E3.m1.50.50.50.25.25.25.1.cmml"></mi><mo id="S3.E3.m1.50.50.50.25.25.25.1.1" xref="S3.E3.m1.50.50.50.25.25.25.1.1.cmml">′</mo></msup></msubsup><mo stretchy="false" id="S3.E3.m1.52.52.52.27.27.27">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E3.m1.53.53.53.28.28.28">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E3.m1.56b"><apply id="S3.E3.m1.54.54.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S3.E3.m1.54.54.1.1.1.3a.cmml">formulae-sequence</csymbol><apply id="S3.E3.m1.54.54.1.1.1.1.1.cmml"><eq id="S3.E3.m1.3.3.3.3.3.3.cmml" xref="S3.E3.m1.3.3.3.3.3.3"></eq><apply id="S3.E3.m1.54.54.1.1.1.1.1.2.cmml"><csymbol cd="ambiguous" id="S3.E3.m1.54.54.1.1.1.1.1.2.1.cmml">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1">𝑄</ci><ci id="S3.E3.m1.2.2.2.2.2.2.1.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1">𝑖</ci></apply><apply id="S3.E3.m1.54.54.1.1.1.1.1.3.cmml"><times id="S3.E3.m1.54.54.1.1.1.1.1.3.1.cmml"></times><apply id="S3.E3.m1.54.54.1.1.1.1.1.3.2.cmml"><csymbol cd="ambiguous" id="S3.E3.m1.54.54.1.1.1.1.1.3.2.1.cmml">subscript</csymbol><apply id="S3.E3.m1.54.54.1.1.1.1.1.3.2.2.cmml"><csymbol cd="ambiguous" id="S3.E3.m1.54.54.1.1.1.1.1.3.2.2.1.cmml">superscript</csymbol><ci id="S3.E3.m1.4.4.4.4.4.4.cmml" xref="S3.E3.m1.4.4.4.4.4.4">𝑓</ci><apply id="S3.E3.m1.5.5.5.5.5.5.1.cmml" xref="S3.E3.m1.5.5.5.5.5.5.1"><ci id="S3.E3.m1.5.5.5.5.5.5.1.1.cmml" xref="S3.E3.m1.5.5.5.5.5.5.1.1">′</ci></apply></apply><ci id="S3.E3.m1.6.6.6.6.6.6.1.cmml" xref="S3.E3.m1.6.6.6.6.6.6.1">𝑖</ci></apply><apply id="S3.E3.m1.54.54.1.1.1.1.1.3.3.cmml"><csymbol cd="ambiguous" id="S3.E3.m1.54.54.1.1.1.1.1.3.3.1.cmml">subscript</csymbol><ci id="S3.E3.m1.7.7.7.7.7.7.cmml" xref="S3.E3.m1.7.7.7.7.7.7">𝑊</ci><ci id="S3.E3.m1.8.8.8.8.8.8.1.cmml" xref="S3.E3.m1.8.8.8.8.8.8.1">𝑞</ci></apply></apply></apply><apply id="S3.E3.m1.54.54.1.1.1.2.2.3.cmml"><csymbol cd="ambiguous" id="S3.E3.m1.54.54.1.1.1.2.2.3a.cmml">formulae-sequence</csymbol><apply id="S3.E3.m1.54.54.1.1.1.2.2.1.1.cmml"><eq id="S3.E3.m1.12.12.12.12.12.12.cmml" xref="S3.E3.m1.12.12.12.12.12.12"></eq><apply id="S3.E3.m1.54.54.1.1.1.2.2.1.1.2.cmml"><csymbol cd="ambiguous" id="S3.E3.m1.54.54.1.1.1.2.2.1.1.2.1.cmml">subscript</csymbol><ci id="S3.E3.m1.10.10.10.10.10.10.cmml" xref="S3.E3.m1.10.10.10.10.10.10">𝐾</ci><ci id="S3.E3.m1.11.11.11.11.11.11.1.cmml" xref="S3.E3.m1.11.11.11.11.11.11.1">𝑖</ci></apply><apply id="S3.E3.m1.54.54.1.1.1.2.2.1.1.3.cmml"><times id="S3.E3.m1.54.54.1.1.1.2.2.1.1.3.1.cmml"></times><apply id="S3.E3.m1.54.54.1.1.1.2.2.1.1.3.2.cmml"><csymbol cd="ambiguous" id="S3.E3.m1.54.54.1.1.1.2.2.1.1.3.2.1.cmml">subscript</csymbol><ci id="S3.E3.m1.13.13.13.13.13.13.cmml" xref="S3.E3.m1.13.13.13.13.13.13">𝑓</ci><ci id="S3.E3.m1.14.14.14.14.14.14.1.cmml" xref="S3.E3.m1.14.14.14.14.14.14.1">𝑖</ci></apply><apply id="S3.E3.m1.54.54.1.1.1.2.2.1.1.3.3.cmml"><csymbol cd="ambiguous" id="S3.E3.m1.54.54.1.1.1.2.2.1.1.3.3.1.cmml">subscript</csymbol><ci id="S3.E3.m1.15.15.15.15.15.15.cmml" xref="S3.E3.m1.15.15.15.15.15.15">𝑊</ci><ci id="S3.E3.m1.16.16.16.16.16.16.1.cmml" xref="S3.E3.m1.16.16.16.16.16.16.1">𝑘</ci></apply></apply></apply><apply id="S3.E3.m1.54.54.1.1.1.2.2.2.2.3.cmml"><csymbol cd="ambiguous" id="S3.E3.m1.54.54.1.1.1.2.2.2.2.3a.cmml">formulae-sequence</csymbol><apply id="S3.E3.m1.54.54.1.1.1.2.2.2.2.1.1.cmml"><eq id="S3.E3.m1.20.20.20.20.20.20.cmml" xref="S3.E3.m1.20.20.20.20.20.20"></eq><apply id="S3.E3.m1.54.54.1.1.1.2.2.2.2.1.1.2.cmml"><csymbol cd="ambiguous" id="S3.E3.m1.54.54.1.1.1.2.2.2.2.1.1.2.1.cmml">subscript</csymbol><ci id="S3.E3.m1.18.18.18.18.18.18.cmml" xref="S3.E3.m1.18.18.18.18.18.18">𝑉</ci><ci id="S3.E3.m1.19.19.19.19.19.19.1.cmml" xref="S3.E3.m1.19.19.19.19.19.19.1">𝑖</ci></apply><apply id="S3.E3.m1.54.54.1.1.1.2.2.2.2.1.1.3.cmml"><times id="S3.E3.m1.54.54.1.1.1.2.2.2.2.1.1.3.1.cmml"></times><apply id="S3.E3.m1.54.54.1.1.1.2.2.2.2.1.1.3.2.cmml"><csymbol cd="ambiguous" id="S3.E3.m1.54.54.1.1.1.2.2.2.2.1.1.3.2.1.cmml">subscript</csymbol><ci id="S3.E3.m1.21.21.21.21.21.21.cmml" xref="S3.E3.m1.21.21.21.21.21.21">𝑓</ci><ci id="S3.E3.m1.22.22.22.22.22.22.1.cmml" xref="S3.E3.m1.22.22.22.22.22.22.1">𝑖</ci></apply><apply id="S3.E3.m1.54.54.1.1.1.2.2.2.2.1.1.3.3.cmml"><csymbol cd="ambiguous" id="S3.E3.m1.54.54.1.1.1.2.2.2.2.1.1.3.3.1.cmml">subscript</csymbol><ci id="S3.E3.m1.23.23.23.23.23.23.cmml" xref="S3.E3.m1.23.23.23.23.23.23">𝑊</ci><ci id="S3.E3.m1.24.24.24.24.24.24.1.cmml" xref="S3.E3.m1.24.24.24.24.24.24.1">𝑣</ci></apply></apply></apply><apply id="S3.E3.m1.54.54.1.1.1.2.2.2.2.2.2.cmml"><eq id="S3.E3.m1.29.29.29.4.4.4.cmml" xref="S3.E3.m1.29.29.29.4.4.4"></eq><apply id="S3.E3.m1.54.54.1.1.1.2.2.2.2.2.2.4.cmml"><csymbol cd="ambiguous" id="S3.E3.m1.54.54.1.1.1.2.2.2.2.2.2.4.1.cmml">subscript</csymbol><apply id="S3.E3.m1.54.54.1.1.1.2.2.2.2.2.2.4.2.cmml"><csymbol cd="ambiguous" id="S3.E3.m1.54.54.1.1.1.2.2.2.2.2.2.4.2.1.cmml">superscript</csymbol><ci id="S3.E3.m1.26.26.26.1.1.1.cmml" xref="S3.E3.m1.26.26.26.1.1.1">𝑓</ci><apply id="S3.E3.m1.27.27.27.2.2.2.1.cmml" xref="S3.E3.m1.27.27.27.2.2.2.1"><times id="S3.E3.m1.27.27.27.2.2.2.1.1.cmml" xref="S3.E3.m1.27.27.27.2.2.2.1.1"></times><ci id="S3.E3.m1.27.27.27.2.2.2.1.2.cmml" xref="S3.E3.m1.27.27.27.2.2.2.1.2">𝑟</ci><ci id="S3.E3.m1.27.27.27.2.2.2.1.3.cmml" xref="S3.E3.m1.27.27.27.2.2.2.1.3">𝑒</ci><ci id="S3.E3.m1.27.27.27.2.2.2.1.4.cmml" xref="S3.E3.m1.27.27.27.2.2.2.1.4">𝑝</ci></apply></apply><ci id="S3.E3.m1.28.28.28.3.3.3.1.cmml" xref="S3.E3.m1.28.28.28.3.3.3.1">𝑖</ci></apply><apply id="S3.E3.m1.54.54.1.1.1.2.2.2.2.2.2.2.cmml"><plus id="S3.E3.m1.43.43.43.18.18.18.cmml" xref="S3.E3.m1.43.43.43.18.18.18"></plus><apply id="S3.E3.m1.54.54.1.1.1.2.2.2.2.2.2.2.4.cmml"><ci id="S3.E3.m1.40.40.40.15.15.15.cmml" xref="S3.E3.m1.40.40.40.15.15.15">⋅</ci><apply id="S3.E3.m1.54.54.1.1.1.2.2.2.2.2.2.2.4.2.cmml"><times id="S3.E3.m1.54.54.1.1.1.2.2.2.2.2.2.2.4.2.1.cmml"></times><ci id="S3.E3.m1.30.30.30.5.5.5.cmml" xref="S3.E3.m1.30.30.30.5.5.5">𝑠</ci><ci id="S3.E3.m1.31.31.31.6.6.6.cmml" xref="S3.E3.m1.31.31.31.6.6.6">𝑜</ci><ci id="S3.E3.m1.32.32.32.7.7.7.cmml" xref="S3.E3.m1.32.32.32.7.7.7">𝑓</ci><ci id="S3.E3.m1.33.33.33.8.8.8.cmml" xref="S3.E3.m1.33.33.33.8.8.8">𝑡</ci><ci id="S3.E3.m1.34.34.34.9.9.9.cmml" xref="S3.E3.m1.34.34.34.9.9.9">𝑚</ci><ci id="S3.E3.m1.35.35.35.10.10.10.cmml" xref="S3.E3.m1.35.35.35.10.10.10">𝑎</ci><ci id="S3.E3.m1.36.36.36.11.11.11.cmml" xref="S3.E3.m1.36.36.36.11.11.11">𝑥</ci><apply id="S3.E3.m1.38.38.38.13.13.13.cmml" xref="S3.E3.m1.38.38.38.13.13.13"><divide id="S3.E3.m1.38.38.38.13.13.13.1.cmml" xref="S3.E3.m1.38.38.38.13.13.13"></divide><apply id="S3.E3.m1.38.38.38.13.13.13.2.cmml" xref="S3.E3.m1.38.38.38.13.13.13.2"><times id="S3.E3.m1.38.38.38.13.13.13.2.1.cmml" xref="S3.E3.m1.38.38.38.13.13.13.2.1"></times><apply id="S3.E3.m1.38.38.38.13.13.13.2.2.cmml" xref="S3.E3.m1.38.38.38.13.13.13.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.38.38.38.13.13.13.2.2.1.cmml" xref="S3.E3.m1.38.38.38.13.13.13.2.2">subscript</csymbol><ci id="S3.E3.m1.38.38.38.13.13.13.2.2.2.cmml" xref="S3.E3.m1.38.38.38.13.13.13.2.2.2">𝑄</ci><ci id="S3.E3.m1.38.38.38.13.13.13.2.2.3.cmml" xref="S3.E3.m1.38.38.38.13.13.13.2.2.3">𝑖</ci></apply><apply id="S3.E3.m1.38.38.38.13.13.13.2.3.cmml" xref="S3.E3.m1.38.38.38.13.13.13.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.38.38.38.13.13.13.2.3.1.cmml" xref="S3.E3.m1.38.38.38.13.13.13.2.3">superscript</csymbol><apply id="S3.E3.m1.38.38.38.13.13.13.2.3.2.cmml" xref="S3.E3.m1.38.38.38.13.13.13.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.38.38.38.13.13.13.2.3.2.1.cmml" xref="S3.E3.m1.38.38.38.13.13.13.2.3">subscript</csymbol><ci id="S3.E3.m1.38.38.38.13.13.13.2.3.2.2.cmml" xref="S3.E3.m1.38.38.38.13.13.13.2.3.2.2">𝐾</ci><ci id="S3.E3.m1.38.38.38.13.13.13.2.3.2.3.cmml" xref="S3.E3.m1.38.38.38.13.13.13.2.3.2.3">𝑖</ci></apply><ci id="S3.E3.m1.38.38.38.13.13.13.2.3.3.cmml" xref="S3.E3.m1.38.38.38.13.13.13.2.3.3">𝑇</ci></apply></apply><apply id="S3.E3.m1.38.38.38.13.13.13.3.cmml" xref="S3.E3.m1.38.38.38.13.13.13.3"><root id="S3.E3.m1.38.38.38.13.13.13.3a.cmml" xref="S3.E3.m1.38.38.38.13.13.13.3"></root><ci id="S3.E3.m1.38.38.38.13.13.13.3.2.cmml" xref="S3.E3.m1.38.38.38.13.13.13.3.2">𝑑</ci></apply></apply></apply><apply id="S3.E3.m1.54.54.1.1.1.2.2.2.2.2.2.2.4.3.cmml"><csymbol cd="ambiguous" id="S3.E3.m1.54.54.1.1.1.2.2.2.2.2.2.2.4.3.1.cmml">subscript</csymbol><ci id="S3.E3.m1.41.41.41.16.16.16.cmml" xref="S3.E3.m1.41.41.41.16.16.16">𝑉</ci><ci id="S3.E3.m1.42.42.42.17.17.17.1.cmml" xref="S3.E3.m1.42.42.42.17.17.17.1">𝑖</ci></apply></apply><apply id="S3.E3.m1.54.54.1.1.1.2.2.2.2.2.2.2.2.cmml"><times id="S3.E3.m1.54.54.1.1.1.2.2.2.2.2.2.2.2.3.cmml"></times><ci id="S3.E3.m1.44.44.44.19.19.19.cmml" xref="S3.E3.m1.44.44.44.19.19.19">𝐸</ci><interval closure="open" id="S3.E3.m1.54.54.1.1.1.2.2.2.2.2.2.2.2.2.3.cmml"><apply id="S3.E3.m1.54.54.1.1.1.2.2.2.2.2.2.1.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S3.E3.m1.54.54.1.1.1.2.2.2.2.2.2.1.1.1.1.1.1.cmml">subscript</csymbol><ci id="S3.E3.m1.46.46.46.21.21.21.cmml" xref="S3.E3.m1.46.46.46.21.21.21">𝑝</ci><ci id="S3.E3.m1.47.47.47.22.22.22.1.cmml" xref="S3.E3.m1.47.47.47.22.22.22.1">𝑖</ci></apply><apply id="S3.E3.m1.54.54.1.1.1.2.2.2.2.2.2.2.2.2.2.2.cmml"><csymbol cd="ambiguous" id="S3.E3.m1.54.54.1.1.1.2.2.2.2.2.2.2.2.2.2.2.1.cmml">subscript</csymbol><apply id="S3.E3.m1.54.54.1.1.1.2.2.2.2.2.2.2.2.2.2.2.2.cmml"><csymbol cd="ambiguous" id="S3.E3.m1.54.54.1.1.1.2.2.2.2.2.2.2.2.2.2.2.2.1.cmml">superscript</csymbol><ci id="S3.E3.m1.49.49.49.24.24.24.cmml" xref="S3.E3.m1.49.49.49.24.24.24">𝑝</ci><apply id="S3.E3.m1.50.50.50.25.25.25.1.cmml" xref="S3.E3.m1.50.50.50.25.25.25.1"><ci id="S3.E3.m1.50.50.50.25.25.25.1.1.cmml" xref="S3.E3.m1.50.50.50.25.25.25.1.1">′</ci></apply></apply><ci id="S3.E3.m1.51.51.51.26.26.26.1.cmml" xref="S3.E3.m1.51.51.51.26.26.26.1">𝑖</ci></apply></interval></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.56c">\begin{split}&amp;Q_{i}=f^{{}^{\prime}}_{i}W_{q},K_{i}=f_{i}W_{k},V_{i}=f_{i}W_{v},\\
&amp;f^{rep}_{i}=softmax(\frac{Q_{i}K_{i}^{T}}{\sqrt{d}})\cdot V_{i}+E(p_{i},p^{{}^{\prime}}_{i}),\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS0.Px1.p1.17" class="ltx_p">where <math id="S3.SS2.SSS0.Px1.p1.15.m1.3" class="ltx_Math" alttext="W_{q},W_{k},W_{v}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p1.15.m1.3a"><mrow id="S3.SS2.SSS0.Px1.p1.15.m1.3.3.3" xref="S3.SS2.SSS0.Px1.p1.15.m1.3.3.4.cmml"><msub id="S3.SS2.SSS0.Px1.p1.15.m1.1.1.1.1" xref="S3.SS2.SSS0.Px1.p1.15.m1.1.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.15.m1.1.1.1.1.2" xref="S3.SS2.SSS0.Px1.p1.15.m1.1.1.1.1.2.cmml">W</mi><mi id="S3.SS2.SSS0.Px1.p1.15.m1.1.1.1.1.3" xref="S3.SS2.SSS0.Px1.p1.15.m1.1.1.1.1.3.cmml">q</mi></msub><mo id="S3.SS2.SSS0.Px1.p1.15.m1.3.3.3.4" xref="S3.SS2.SSS0.Px1.p1.15.m1.3.3.4.cmml">,</mo><msub id="S3.SS2.SSS0.Px1.p1.15.m1.2.2.2.2" xref="S3.SS2.SSS0.Px1.p1.15.m1.2.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px1.p1.15.m1.2.2.2.2.2" xref="S3.SS2.SSS0.Px1.p1.15.m1.2.2.2.2.2.cmml">W</mi><mi id="S3.SS2.SSS0.Px1.p1.15.m1.2.2.2.2.3" xref="S3.SS2.SSS0.Px1.p1.15.m1.2.2.2.2.3.cmml">k</mi></msub><mo id="S3.SS2.SSS0.Px1.p1.15.m1.3.3.3.5" xref="S3.SS2.SSS0.Px1.p1.15.m1.3.3.4.cmml">,</mo><msub id="S3.SS2.SSS0.Px1.p1.15.m1.3.3.3.3" xref="S3.SS2.SSS0.Px1.p1.15.m1.3.3.3.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.15.m1.3.3.3.3.2" xref="S3.SS2.SSS0.Px1.p1.15.m1.3.3.3.3.2.cmml">W</mi><mi id="S3.SS2.SSS0.Px1.p1.15.m1.3.3.3.3.3" xref="S3.SS2.SSS0.Px1.p1.15.m1.3.3.3.3.3.cmml">v</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.15.m1.3b"><list id="S3.SS2.SSS0.Px1.p1.15.m1.3.3.4.cmml" xref="S3.SS2.SSS0.Px1.p1.15.m1.3.3.3"><apply id="S3.SS2.SSS0.Px1.p1.15.m1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.15.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.15.m1.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.15.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.15.m1.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.15.m1.1.1.1.1.2">𝑊</ci><ci id="S3.SS2.SSS0.Px1.p1.15.m1.1.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.15.m1.1.1.1.1.3">𝑞</ci></apply><apply id="S3.SS2.SSS0.Px1.p1.15.m1.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.15.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.15.m1.2.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.15.m1.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.15.m1.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.15.m1.2.2.2.2.2">𝑊</ci><ci id="S3.SS2.SSS0.Px1.p1.15.m1.2.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.15.m1.2.2.2.2.3">𝑘</ci></apply><apply id="S3.SS2.SSS0.Px1.p1.15.m1.3.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.15.m1.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.15.m1.3.3.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.15.m1.3.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.15.m1.3.3.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.15.m1.3.3.3.3.2">𝑊</ci><ci id="S3.SS2.SSS0.Px1.p1.15.m1.3.3.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.15.m1.3.3.3.3.3">𝑣</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.15.m1.3c">W_{q},W_{k},W_{v}</annotation></semantics></math> are the linear projection of query, key, and value, <math id="S3.SS2.SSS0.Px1.p1.16.m2.1" class="ltx_Math" alttext="I^{{}^{\prime}}_{i}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p1.16.m2.1a"><msubsup id="S3.SS2.SSS0.Px1.p1.16.m2.1.1" xref="S3.SS2.SSS0.Px1.p1.16.m2.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.16.m2.1.1.2.2" xref="S3.SS2.SSS0.Px1.p1.16.m2.1.1.2.2.cmml">I</mi><mi id="S3.SS2.SSS0.Px1.p1.16.m2.1.1.3" xref="S3.SS2.SSS0.Px1.p1.16.m2.1.1.3.cmml">i</mi><msup id="S3.SS2.SSS0.Px1.p1.16.m2.1.1.2.3" xref="S3.SS2.SSS0.Px1.p1.16.m2.1.1.2.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.16.m2.1.1.2.3a" xref="S3.SS2.SSS0.Px1.p1.16.m2.1.1.2.3.cmml"></mi><mo id="S3.SS2.SSS0.Px1.p1.16.m2.1.1.2.3.1" xref="S3.SS2.SSS0.Px1.p1.16.m2.1.1.2.3.1.cmml">′</mo></msup></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.16.m2.1b"><apply id="S3.SS2.SSS0.Px1.p1.16.m2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.16.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.16.m2.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.16.m2.1.1">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p1.16.m2.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.16.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.16.m2.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.16.m2.1.1">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.16.m2.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.16.m2.1.1.2.2">𝐼</ci><apply id="S3.SS2.SSS0.Px1.p1.16.m2.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.16.m2.1.1.2.3"><ci id="S3.SS2.SSS0.Px1.p1.16.m2.1.1.2.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.16.m2.1.1.2.3.1">′</ci></apply></apply><ci id="S3.SS2.SSS0.Px1.p1.16.m2.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.16.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.16.m2.1c">I^{{}^{\prime}}_{i}</annotation></semantics></math> is the index of the whole column, and <math id="S3.SS2.SSS0.Px1.p1.17.m3.2" class="ltx_Math" alttext="E(p_{i},p^{{}^{\prime}}_{i})" display="inline"><semantics id="S3.SS2.SSS0.Px1.p1.17.m3.2a"><mrow id="S3.SS2.SSS0.Px1.p1.17.m3.2.2" xref="S3.SS2.SSS0.Px1.p1.17.m3.2.2.cmml"><mi id="S3.SS2.SSS0.Px1.p1.17.m3.2.2.4" xref="S3.SS2.SSS0.Px1.p1.17.m3.2.2.4.cmml">E</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS0.Px1.p1.17.m3.2.2.3" xref="S3.SS2.SSS0.Px1.p1.17.m3.2.2.3.cmml">​</mo><mrow id="S3.SS2.SSS0.Px1.p1.17.m3.2.2.2.2" xref="S3.SS2.SSS0.Px1.p1.17.m3.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px1.p1.17.m3.2.2.2.2.3" xref="S3.SS2.SSS0.Px1.p1.17.m3.2.2.2.3.cmml">(</mo><msub id="S3.SS2.SSS0.Px1.p1.17.m3.1.1.1.1.1" xref="S3.SS2.SSS0.Px1.p1.17.m3.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.17.m3.1.1.1.1.1.2" xref="S3.SS2.SSS0.Px1.p1.17.m3.1.1.1.1.1.2.cmml">p</mi><mi id="S3.SS2.SSS0.Px1.p1.17.m3.1.1.1.1.1.3" xref="S3.SS2.SSS0.Px1.p1.17.m3.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.SSS0.Px1.p1.17.m3.2.2.2.2.4" xref="S3.SS2.SSS0.Px1.p1.17.m3.2.2.2.3.cmml">,</mo><msubsup id="S3.SS2.SSS0.Px1.p1.17.m3.2.2.2.2.2" xref="S3.SS2.SSS0.Px1.p1.17.m3.2.2.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px1.p1.17.m3.2.2.2.2.2.2.2" xref="S3.SS2.SSS0.Px1.p1.17.m3.2.2.2.2.2.2.2.cmml">p</mi><mi id="S3.SS2.SSS0.Px1.p1.17.m3.2.2.2.2.2.3" xref="S3.SS2.SSS0.Px1.p1.17.m3.2.2.2.2.2.3.cmml">i</mi><msup id="S3.SS2.SSS0.Px1.p1.17.m3.2.2.2.2.2.2.3" xref="S3.SS2.SSS0.Px1.p1.17.m3.2.2.2.2.2.2.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.17.m3.2.2.2.2.2.2.3a" xref="S3.SS2.SSS0.Px1.p1.17.m3.2.2.2.2.2.2.3.cmml"></mi><mo id="S3.SS2.SSS0.Px1.p1.17.m3.2.2.2.2.2.2.3.1" xref="S3.SS2.SSS0.Px1.p1.17.m3.2.2.2.2.2.2.3.1.cmml">′</mo></msup></msubsup><mo stretchy="false" id="S3.SS2.SSS0.Px1.p1.17.m3.2.2.2.2.5" xref="S3.SS2.SSS0.Px1.p1.17.m3.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.17.m3.2b"><apply id="S3.SS2.SSS0.Px1.p1.17.m3.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.17.m3.2.2"><times id="S3.SS2.SSS0.Px1.p1.17.m3.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.17.m3.2.2.3"></times><ci id="S3.SS2.SSS0.Px1.p1.17.m3.2.2.4.cmml" xref="S3.SS2.SSS0.Px1.p1.17.m3.2.2.4">𝐸</ci><interval closure="open" id="S3.SS2.SSS0.Px1.p1.17.m3.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.17.m3.2.2.2.2"><apply id="S3.SS2.SSS0.Px1.p1.17.m3.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.17.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.17.m3.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.17.m3.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.17.m3.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.17.m3.1.1.1.1.1.2">𝑝</ci><ci id="S3.SS2.SSS0.Px1.p1.17.m3.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.17.m3.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS2.SSS0.Px1.p1.17.m3.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.17.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.17.m3.2.2.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.17.m3.2.2.2.2.2">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p1.17.m3.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.17.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.17.m3.2.2.2.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.17.m3.2.2.2.2.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.17.m3.2.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.17.m3.2.2.2.2.2.2.2">𝑝</ci><apply id="S3.SS2.SSS0.Px1.p1.17.m3.2.2.2.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.17.m3.2.2.2.2.2.2.3"><ci id="S3.SS2.SSS0.Px1.p1.17.m3.2.2.2.2.2.2.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.17.m3.2.2.2.2.2.2.3.1">′</ci></apply></apply><ci id="S3.SS2.SSS0.Px1.p1.17.m3.2.2.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.17.m3.2.2.2.2.2.3">𝑖</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.17.m3.2c">E(p_{i},p^{{}^{\prime}}_{i})</annotation></semantics></math> is a function of the relative positional encoding:</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.1" class="ltx_Math" alttext="E(p_{i},p^{{}^{\prime}}_{i})=ReLU((p_{i}-p^{{}^{\prime}}_{i})\cdot W_{pos})." display="block"><semantics id="S3.E4.m1.1a"><mrow id="S3.E4.m1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml"><mrow id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml"><mrow id="S3.E4.m1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.2.cmml"><mi id="S3.E4.m1.1.1.1.1.2.4" xref="S3.E4.m1.1.1.1.1.2.4.cmml">E</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.1.1.2.3" xref="S3.E4.m1.1.1.1.1.2.3.cmml">​</mo><mrow id="S3.E4.m1.1.1.1.1.2.2.2" xref="S3.E4.m1.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E4.m1.1.1.1.1.2.2.2.3" xref="S3.E4.m1.1.1.1.1.2.2.3.cmml">(</mo><msub id="S3.E4.m1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.2.cmml">p</mi><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E4.m1.1.1.1.1.2.2.2.4" xref="S3.E4.m1.1.1.1.1.2.2.3.cmml">,</mo><msubsup id="S3.E4.m1.1.1.1.1.2.2.2.2" xref="S3.E4.m1.1.1.1.1.2.2.2.2.cmml"><mi id="S3.E4.m1.1.1.1.1.2.2.2.2.2.2" xref="S3.E4.m1.1.1.1.1.2.2.2.2.2.2.cmml">p</mi><mi id="S3.E4.m1.1.1.1.1.2.2.2.2.3" xref="S3.E4.m1.1.1.1.1.2.2.2.2.3.cmml">i</mi><msup id="S3.E4.m1.1.1.1.1.2.2.2.2.2.3" xref="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.cmml"><mi id="S3.E4.m1.1.1.1.1.2.2.2.2.2.3a" xref="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.cmml"></mi><mo id="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.1" xref="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.1.cmml">′</mo></msup></msubsup><mo stretchy="false" id="S3.E4.m1.1.1.1.1.2.2.2.5" xref="S3.E4.m1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.1.1.1.1.4" xref="S3.E4.m1.1.1.1.1.4.cmml">=</mo><mrow id="S3.E4.m1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.1.1.1.1.3.3" xref="S3.E4.m1.1.1.1.1.3.3.cmml">R</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.1.3.2.cmml">​</mo><mi id="S3.E4.m1.1.1.1.1.3.4" xref="S3.E4.m1.1.1.1.1.3.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.1.1.3.2a" xref="S3.E4.m1.1.1.1.1.3.2.cmml">​</mo><mi id="S3.E4.m1.1.1.1.1.3.5" xref="S3.E4.m1.1.1.1.1.3.5.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.1.1.3.2b" xref="S3.E4.m1.1.1.1.1.3.2.cmml">​</mo><mi id="S3.E4.m1.1.1.1.1.3.6" xref="S3.E4.m1.1.1.1.1.3.6.cmml">U</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.1.1.3.2c" xref="S3.E4.m1.1.1.1.1.3.2.cmml">​</mo><mrow id="S3.E4.m1.1.1.1.1.3.1.1" xref="S3.E4.m1.1.1.1.1.3.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.1.1.1.1.3.1.1.2" xref="S3.E4.m1.1.1.1.1.3.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.1.1.1.1.3.1.1.1" xref="S3.E4.m1.1.1.1.1.3.1.1.1.cmml"><mrow id="S3.E4.m1.1.1.1.1.3.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.cmml"><msub id="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.2.cmml"><mi id="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.2.2" xref="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.2.2.cmml">p</mi><mi id="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.2.3" xref="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.1.cmml">−</mo><msubsup id="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.3.2.2" xref="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.3.2.2.cmml">p</mi><mi id="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.3.3" xref="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.3.3.cmml">i</mi><msup id="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.3.2.3" xref="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.3.2.3.cmml"><mi id="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.3.2.3a" xref="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.3.2.3.cmml"></mi><mo id="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.3.2.3.1" xref="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.3.2.3.1.cmml">′</mo></msup></msubsup></mrow><mo rspace="0.055em" stretchy="false" id="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S3.E4.m1.1.1.1.1.3.1.1.1.2" xref="S3.E4.m1.1.1.1.1.3.1.1.1.2.cmml">⋅</mo><msub id="S3.E4.m1.1.1.1.1.3.1.1.1.3" xref="S3.E4.m1.1.1.1.1.3.1.1.1.3.cmml"><mi id="S3.E4.m1.1.1.1.1.3.1.1.1.3.2" xref="S3.E4.m1.1.1.1.1.3.1.1.1.3.2.cmml">W</mi><mrow id="S3.E4.m1.1.1.1.1.3.1.1.1.3.3" xref="S3.E4.m1.1.1.1.1.3.1.1.1.3.3.cmml"><mi id="S3.E4.m1.1.1.1.1.3.1.1.1.3.3.2" xref="S3.E4.m1.1.1.1.1.3.1.1.1.3.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.1.1.3.1.1.1.3.3.1" xref="S3.E4.m1.1.1.1.1.3.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E4.m1.1.1.1.1.3.1.1.1.3.3.3" xref="S3.E4.m1.1.1.1.1.3.1.1.1.3.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.1.1.3.1.1.1.3.3.1a" xref="S3.E4.m1.1.1.1.1.3.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E4.m1.1.1.1.1.3.1.1.1.3.3.4" xref="S3.E4.m1.1.1.1.1.3.1.1.1.3.3.4.cmml">s</mi></mrow></msub></mrow><mo stretchy="false" id="S3.E4.m1.1.1.1.1.3.1.1.3" xref="S3.E4.m1.1.1.1.1.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E4.m1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.1b"><apply id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1"><eq id="S3.E4.m1.1.1.1.1.4.cmml" xref="S3.E4.m1.1.1.1.1.4"></eq><apply id="S3.E4.m1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.2"><times id="S3.E4.m1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.1.1.1.1.2.3"></times><ci id="S3.E4.m1.1.1.1.1.2.4.cmml" xref="S3.E4.m1.1.1.1.1.2.4">𝐸</ci><interval closure="open" id="S3.E4.m1.1.1.1.1.2.2.3.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2"><apply id="S3.E4.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.2">𝑝</ci><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E4.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.2">subscript</csymbol><apply id="S3.E4.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.2">superscript</csymbol><ci id="S3.E4.m1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.2.2.2">𝑝</ci><apply id="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.2.2.3"><ci id="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.1.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.1">′</ci></apply></apply><ci id="S3.E4.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.2.3">𝑖</ci></apply></interval></apply><apply id="S3.E4.m1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.3"><times id="S3.E4.m1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.1.3.2"></times><ci id="S3.E4.m1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.1.1.3.3">𝑅</ci><ci id="S3.E4.m1.1.1.1.1.3.4.cmml" xref="S3.E4.m1.1.1.1.1.3.4">𝑒</ci><ci id="S3.E4.m1.1.1.1.1.3.5.cmml" xref="S3.E4.m1.1.1.1.1.3.5">𝐿</ci><ci id="S3.E4.m1.1.1.1.1.3.6.cmml" xref="S3.E4.m1.1.1.1.1.3.6">𝑈</ci><apply id="S3.E4.m1.1.1.1.1.3.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.3.1.1"><ci id="S3.E4.m1.1.1.1.1.3.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.3.1.1.1.2">⋅</ci><apply id="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.3.1.1.1.1.1"><minus id="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.1"></minus><apply id="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.2.2">𝑝</ci><ci id="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.3.2.2">𝑝</ci><apply id="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.3.2.3"><ci id="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.3.2.3.1.cmml" xref="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.3.2.3.1">′</ci></apply></apply><ci id="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.1.1.3.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply><apply id="S3.E4.m1.1.1.1.1.3.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.3.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.1.3.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.3.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.1.3.1.1.1.3.2">𝑊</ci><apply id="S3.E4.m1.1.1.1.1.3.1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.1.1.3.1.1.1.3.3"><times id="S3.E4.m1.1.1.1.1.3.1.1.1.3.3.1.cmml" xref="S3.E4.m1.1.1.1.1.3.1.1.1.3.3.1"></times><ci id="S3.E4.m1.1.1.1.1.3.1.1.1.3.3.2.cmml" xref="S3.E4.m1.1.1.1.1.3.1.1.1.3.3.2">𝑝</ci><ci id="S3.E4.m1.1.1.1.1.3.1.1.1.3.3.3.cmml" xref="S3.E4.m1.1.1.1.1.3.1.1.1.3.3.3">𝑜</ci><ci id="S3.E4.m1.1.1.1.1.3.1.1.1.3.3.4.cmml" xref="S3.E4.m1.1.1.1.1.3.1.1.1.3.3.4">𝑠</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.1c">E(p_{i},p^{{}^{\prime}}_{i})=ReLU((p_{i}-p^{{}^{\prime}}_{i})\cdot W_{pos}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.SSS0.Px1.p2" class="ltx_para">
<p id="S3.SS2.SSS0.Px1.p2.1" class="ltx_p">The cross-attention will be executed for each column to get a condensed feature map <math id="S3.SS2.SSS0.Px1.p2.1.m1.3" class="ltx_Math" alttext="F^{rep}=(f^{rep}_{1},\cdots,f^{rep}_{A})\in\mathbb{R}^{N\times A\times C}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p2.1.m1.3a"><mrow id="S3.SS2.SSS0.Px1.p2.1.m1.3.3" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.cmml"><msup id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.4" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.4.cmml"><mi id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.4.2" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.4.2.cmml">F</mi><mrow id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.4.3" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.4.3.cmml"><mi id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.4.3.2" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.4.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.4.3.1" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.4.3.1.cmml">​</mo><mi id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.4.3.3" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.4.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.4.3.1a" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.4.3.1.cmml">​</mo><mi id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.4.3.4" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.4.3.4.cmml">p</mi></mrow></msup><mo id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.5" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.5.cmml">=</mo><mrow id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.2" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.3.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.2.3" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.3.cmml">(</mo><msubsup id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.1.1.1" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.2" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.2.cmml">f</mi><mn id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.1.1.1.3" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.1.1.1.3.cmml">1</mn><mrow id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.3" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.3.cmml"><mi id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.3.2" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.3.1" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.3.1.cmml">​</mo><mi id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.3.3" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.3.1a" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.3.1.cmml">​</mo><mi id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.3.4" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.3.4.cmml">p</mi></mrow></msubsup><mo id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.2.4" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.SSS0.Px1.p2.1.m1.1.1" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.cmml">⋯</mi><mo id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.2.5" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.3.cmml">,</mo><msubsup id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.2.2" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.2.2.2.2" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.2.2.2.2.cmml">f</mi><mi id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.2.2.3" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.2.2.3.cmml">A</mi><mrow id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.2.2.2.3" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.2.2.2.3.cmml"><mi id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.2.2.2.3.2" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.2.2.2.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.2.2.2.3.1" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.2.2.2.3.1.cmml">​</mo><mi id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.2.2.2.3.3" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.2.2.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.2.2.2.3.1a" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.2.2.2.3.1.cmml">​</mo><mi id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.2.2.2.3.4" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.2.2.2.3.4.cmml">p</mi></mrow></msubsup><mo stretchy="false" id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.2.6" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.3.cmml">)</mo></mrow><mo id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.6" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.6.cmml">∈</mo><msup id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.7" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.7.cmml"><mi id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.7.2" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.7.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.7.3" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.7.3.cmml"><mi id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.7.3.2" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.7.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.7.3.1" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.7.3.1.cmml">×</mo><mi id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.7.3.3" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.7.3.3.cmml">A</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.7.3.1a" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.7.3.1.cmml">×</mo><mi id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.7.3.4" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.7.3.4.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.1.m1.3b"><apply id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3"><and id="S3.SS2.SSS0.Px1.p2.1.m1.3.3a.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3"></and><apply id="S3.SS2.SSS0.Px1.p2.1.m1.3.3b.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3"><eq id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.5.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.5"></eq><apply id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.4.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.4"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.4.1.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.4">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.4.2.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.4.2">𝐹</ci><apply id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.4.3.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.4.3"><times id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.4.3.1.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.4.3.1"></times><ci id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.4.3.2.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.4.3.2">𝑟</ci><ci id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.4.3.3.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.4.3.3">𝑒</ci><ci id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.4.3.4.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.4.3.4">𝑝</ci></apply></apply><vector id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.3.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.2"><apply id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.1.1.1">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.1.1.1">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.2">𝑓</ci><apply id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.3"><times id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.3.1.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.3.1"></times><ci id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.3.2.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.3.2">𝑟</ci><ci id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.3.3.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.3.3">𝑒</ci><ci id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.3.4.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.3.4">𝑝</ci></apply></apply><cn type="integer" id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1">⋯</ci><apply id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.2.2">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.2.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.2.2.2.2">𝑓</ci><apply id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.2.2.2.3"><times id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.2.2.2.3.1.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.2.2.2.3.1"></times><ci id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.2.2.2.3.2.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.2.2.2.3.2">𝑟</ci><ci id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.2.2.2.3.3.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.2.2.2.3.3">𝑒</ci><ci id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.2.2.2.3.4.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.2.2.2.3.4">𝑝</ci></apply></apply><ci id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.2.2.3">𝐴</ci></apply></vector></apply><apply id="S3.SS2.SSS0.Px1.p2.1.m1.3.3c.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3"><in id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.6.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.6"></in><share href="#S3.SS2.SSS0.Px1.p2.1.m1.3.3.2.cmml" id="S3.SS2.SSS0.Px1.p2.1.m1.3.3d.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3"></share><apply id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.7.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.7"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.7.1.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.7">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.7.2.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.7.2">ℝ</ci><apply id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.7.3.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.7.3"><times id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.7.3.1.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.7.3.1"></times><ci id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.7.3.2.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.7.3.2">𝑁</ci><ci id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.7.3.3.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.7.3.3">𝐴</ci><ci id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.7.3.4.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.7.3.4">𝐶</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.1.m1.3c">F^{rep}=(f^{rep}_{1},\cdots,f^{rep}_{A})\in\mathbb{R}^{N\times A\times C}</annotation></semantics></math> for the following re-alignment operation.</p>
</div>
</section>
<section id="S3.SS2.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Angular attention.</h4>

<div id="S3.SS2.SSS0.Px2.p1" class="ltx_para">
<p id="S3.SS2.SSS0.Px2.p1.4" class="ltx_p">With the above condensed representative features, angular attention uses self-attention for global re-alignment.
The design is based on the observation that a distant feature encodes a much larger region than nearby features.
Thus, it is necessary to introduce an appropriate receptive field in azimuth, which helps distant features access enough nearby features for re-alignment without introducing too much computational overhead.
With the above prior, we introduce local window attention with window shifting.
The condensed feature map <math id="S3.SS2.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="F^{rep}\in\mathbb{R}^{N\times A\times C}" display="inline"><semantics id="S3.SS2.SSS0.Px2.p1.1.m1.1a"><mrow id="S3.SS2.SSS0.Px2.p1.1.m1.1.1" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.cmml"><msup id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2.cmml"><mi id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2.2" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2.2.cmml">F</mi><mrow id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2.3" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2.3.cmml"><mi id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2.3.2" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2.3.1" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2.3.3" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2.3.1a" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2.3.4" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2.3.4.cmml">p</mi></mrow></msup><mo id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.1" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3.cmml"><mi id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3.2" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3.3" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3.3.cmml"><mi id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3.3.2" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3.3.1" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3.3.3" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3.3.3.cmml">A</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3.3.1a" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3.3.4" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3.3.4.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.1.m1.1b"><apply id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1"><in id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.1"></in><apply id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2.2">𝐹</ci><apply id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2.3"><times id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2.3.1.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2.3.1"></times><ci id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2.3.2.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2.3.2">𝑟</ci><ci id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2.3.3.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2.3.3">𝑒</ci><ci id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2.3.4.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2.3.4">𝑝</ci></apply></apply><apply id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3.3.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3.3"><times id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3.3.1.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3.3.1"></times><ci id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3.3.2.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3.3.2">𝑁</ci><ci id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3.3.3.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3.3.3">𝐴</ci><ci id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3.3.4.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3.3.4">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.1.m1.1c">F^{rep}\in\mathbb{R}^{N\times A\times C}</annotation></semantics></math> is first divided into non-overlapping windows, where the window size is set to <math id="S3.SS2.SSS0.Px2.p1.2.m2.1" class="ltx_Math" alttext="N\times W_{a}" display="inline"><semantics id="S3.SS2.SSS0.Px2.p1.2.m2.1a"><mrow id="S3.SS2.SSS0.Px2.p1.2.m2.1.1" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p1.2.m2.1.1.2" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.SSS0.Px2.p1.2.m2.1.1.1" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1.1.cmml">×</mo><msub id="S3.SS2.SSS0.Px2.p1.2.m2.1.1.3" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1.3.cmml"><mi id="S3.SS2.SSS0.Px2.p1.2.m2.1.1.3.2" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1.3.2.cmml">W</mi><mi id="S3.SS2.SSS0.Px2.p1.2.m2.1.1.3.3" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1.3.3.cmml">a</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.2.m2.1b"><apply id="S3.SS2.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1"><times id="S3.SS2.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1.1"></times><ci id="S3.SS2.SSS0.Px2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1.2">𝑁</ci><apply id="S3.SS2.SSS0.Px2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.2.m2.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.2.m2.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1.3.2">𝑊</ci><ci id="S3.SS2.SSS0.Px2.p1.2.m2.1.1.3.3.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1.3.3">𝑎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.2.m2.1c">N\times W_{a}</annotation></semantics></math>. For feature <math id="S3.SS2.SSS0.Px2.p1.3.m3.1" class="ltx_Math" alttext="f_{i}^{w}" display="inline"><semantics id="S3.SS2.SSS0.Px2.p1.3.m3.1a"><msubsup id="S3.SS2.SSS0.Px2.p1.3.m3.1.1" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.2.2" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1.2.2.cmml">f</mi><mi id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.2.3" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1.2.3.cmml">i</mi><mi id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.3" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1.3.cmml">w</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.3.m3.1b"><apply id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1">superscript</csymbol><apply id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1.2.2">𝑓</ci><ci id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1.2.3">𝑖</ci></apply><ci id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.3.m3.1c">f_{i}^{w}</annotation></semantics></math> in the <math id="S3.SS2.SSS0.Px2.p1.4.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.SSS0.Px2.p1.4.m4.1a"><mi id="S3.SS2.SSS0.Px2.p1.4.m4.1.1" xref="S3.SS2.SSS0.Px2.p1.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.4.m4.1b"><ci id="S3.SS2.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.4.m4.1c">i</annotation></semantics></math>-th window, self-attention is applied following Eq. <a href="#S3.E3" title="In Condense attention. ‣ 3.2 Global representation re-alignment module ‣ 3 Method ‣ PARTNER: Level up the Polar Representation for LiDAR 3D Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> and Eq. <a href="#S3.E4" title="In Condense attention. ‣ 3.2 Global representation re-alignment module ‣ 3 Method ‣ PARTNER: Level up the Polar Representation for LiDAR 3D Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<div id="S3.SS2.SSS0.Px2.p2" class="ltx_para">
<p id="S3.SS2.SSS0.Px2.p2.5" class="ltx_p">After angular attentions, the module applies a reverse condense attention to <math id="S3.SS2.SSS0.Px2.p2.1.m1.1" class="ltx_Math" alttext="f^{r}" display="inline"><semantics id="S3.SS2.SSS0.Px2.p2.1.m1.1a"><msup id="S3.SS2.SSS0.Px2.p2.1.m1.1.1" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.cmml">f</mi><mi id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.cmml">r</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.1.m1.1b"><apply id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2">𝑓</ci><ci id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.1.m1.1c">f^{r}</annotation></semantics></math> and <math id="S3.SS2.SSS0.Px2.p2.2.m2.1" class="ltx_Math" alttext="F" display="inline"><semantics id="S3.SS2.SSS0.Px2.p2.2.m2.1a"><mi id="S3.SS2.SSS0.Px2.p2.2.m2.1.1" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.2.m2.1b"><ci id="S3.SS2.SSS0.Px2.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.2.m2.1c">F</annotation></semantics></math> to broadcast the re-aligned representative features to each column of the BEV map.
Let <math id="S3.SS2.SSS0.Px2.p2.3.m3.1" class="ltx_Math" alttext="F^{A}\in\mathbb{R}^{N\times A\times C}" display="inline"><semantics id="S3.SS2.SSS0.Px2.p2.3.m3.1a"><mrow id="S3.SS2.SSS0.Px2.p2.3.m3.1.1" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.cmml"><msup id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.2" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.2.cmml"><mi id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.2.2" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.2.2.cmml">F</mi><mi id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.2.3" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.2.3.cmml">A</mi></msup><mo id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.3" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.3.cmml"><mi id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.3.2" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.3.3" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.3.3.cmml"><mi id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.3.3.2" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.3.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.3.3.1" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.3.3.3" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.3.3.3.cmml">A</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.3.3.1a" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.3.3.4" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.3.3.4.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.3.m3.1b"><apply id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1"><in id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1"></in><apply id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.2.2">𝐹</ci><ci id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.2.3">𝐴</ci></apply><apply id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.3.2">ℝ</ci><apply id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.3.3.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.3.3"><times id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.3.3.1.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.3.3.1"></times><ci id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.3.3.2.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.3.3.2">𝑁</ci><ci id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.3.3.3.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.3.3.3">𝐴</ci><ci id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.3.3.4.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.3.3.4">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.3.m3.1c">F^{A}\in\mathbb{R}^{N\times A\times C}</annotation></semantics></math> denote the output feature of the last angular attention.
With <math id="S3.SS2.SSS0.Px2.p2.4.m4.3" class="ltx_Math" alttext="f_{i}=F[:,i,:]\in\mathbb{R}^{R\times C}" display="inline"><semantics id="S3.SS2.SSS0.Px2.p2.4.m4.3a"><mrow id="S3.SS2.SSS0.Px2.p2.4.m4.3.4" xref="S3.SS2.SSS0.Px2.p2.4.m4.3.4.cmml"><msub id="S3.SS2.SSS0.Px2.p2.4.m4.3.4.2" xref="S3.SS2.SSS0.Px2.p2.4.m4.3.4.2.cmml"><mi id="S3.SS2.SSS0.Px2.p2.4.m4.3.4.2.2" xref="S3.SS2.SSS0.Px2.p2.4.m4.3.4.2.2.cmml">f</mi><mi id="S3.SS2.SSS0.Px2.p2.4.m4.3.4.2.3" xref="S3.SS2.SSS0.Px2.p2.4.m4.3.4.2.3.cmml">i</mi></msub><mo id="S3.SS2.SSS0.Px2.p2.4.m4.3.4.3" xref="S3.SS2.SSS0.Px2.p2.4.m4.3.4.3.cmml">=</mo><mrow id="S3.SS2.SSS0.Px2.p2.4.m4.3.4.4" xref="S3.SS2.SSS0.Px2.p2.4.m4.3.4.4.cmml"><mi id="S3.SS2.SSS0.Px2.p2.4.m4.3.4.4.2" xref="S3.SS2.SSS0.Px2.p2.4.m4.3.4.4.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS0.Px2.p2.4.m4.3.4.4.1" xref="S3.SS2.SSS0.Px2.p2.4.m4.3.4.4.1.cmml">​</mo><mrow id="S3.SS2.SSS0.Px2.p2.4.m4.3.4.4.3.2" xref="S3.SS2.SSS0.Px2.p2.4.m4.3.4.4.3.1.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px2.p2.4.m4.3.4.4.3.2.1" xref="S3.SS2.SSS0.Px2.p2.4.m4.3.4.4.3.1.cmml">[</mo><mo rspace="0em" id="S3.SS2.SSS0.Px2.p2.4.m4.1.1" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.cmml">:</mo><mo id="S3.SS2.SSS0.Px2.p2.4.m4.3.4.4.3.2.2" xref="S3.SS2.SSS0.Px2.p2.4.m4.3.4.4.3.1.cmml">,</mo><mi id="S3.SS2.SSS0.Px2.p2.4.m4.2.2" xref="S3.SS2.SSS0.Px2.p2.4.m4.2.2.cmml">i</mi><mo id="S3.SS2.SSS0.Px2.p2.4.m4.3.4.4.3.2.3" xref="S3.SS2.SSS0.Px2.p2.4.m4.3.4.4.3.1.cmml">,</mo><mo rspace="0em" id="S3.SS2.SSS0.Px2.p2.4.m4.3.3" xref="S3.SS2.SSS0.Px2.p2.4.m4.3.3.cmml">:</mo><mo stretchy="false" id="S3.SS2.SSS0.Px2.p2.4.m4.3.4.4.3.2.4" xref="S3.SS2.SSS0.Px2.p2.4.m4.3.4.4.3.1.cmml">]</mo></mrow></mrow><mo id="S3.SS2.SSS0.Px2.p2.4.m4.3.4.5" xref="S3.SS2.SSS0.Px2.p2.4.m4.3.4.5.cmml">∈</mo><msup id="S3.SS2.SSS0.Px2.p2.4.m4.3.4.6" xref="S3.SS2.SSS0.Px2.p2.4.m4.3.4.6.cmml"><mi id="S3.SS2.SSS0.Px2.p2.4.m4.3.4.6.2" xref="S3.SS2.SSS0.Px2.p2.4.m4.3.4.6.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS0.Px2.p2.4.m4.3.4.6.3" xref="S3.SS2.SSS0.Px2.p2.4.m4.3.4.6.3.cmml"><mi id="S3.SS2.SSS0.Px2.p2.4.m4.3.4.6.3.2" xref="S3.SS2.SSS0.Px2.p2.4.m4.3.4.6.3.2.cmml">R</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.SSS0.Px2.p2.4.m4.3.4.6.3.1" xref="S3.SS2.SSS0.Px2.p2.4.m4.3.4.6.3.1.cmml">×</mo><mi id="S3.SS2.SSS0.Px2.p2.4.m4.3.4.6.3.3" xref="S3.SS2.SSS0.Px2.p2.4.m4.3.4.6.3.3.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.4.m4.3b"><apply id="S3.SS2.SSS0.Px2.p2.4.m4.3.4.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.3.4"><and id="S3.SS2.SSS0.Px2.p2.4.m4.3.4a.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.3.4"></and><apply id="S3.SS2.SSS0.Px2.p2.4.m4.3.4b.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.3.4"><eq id="S3.SS2.SSS0.Px2.p2.4.m4.3.4.3.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.3.4.3"></eq><apply id="S3.SS2.SSS0.Px2.p2.4.m4.3.4.2.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.3.4.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.4.m4.3.4.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.3.4.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.4.m4.3.4.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.3.4.2.2">𝑓</ci><ci id="S3.SS2.SSS0.Px2.p2.4.m4.3.4.2.3.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.3.4.2.3">𝑖</ci></apply><apply id="S3.SS2.SSS0.Px2.p2.4.m4.3.4.4.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.3.4.4"><times id="S3.SS2.SSS0.Px2.p2.4.m4.3.4.4.1.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.3.4.4.1"></times><ci id="S3.SS2.SSS0.Px2.p2.4.m4.3.4.4.2.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.3.4.4.2">𝐹</ci><list id="S3.SS2.SSS0.Px2.p2.4.m4.3.4.4.3.1.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.3.4.4.3.2"><ci id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1">:</ci><ci id="S3.SS2.SSS0.Px2.p2.4.m4.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.2.2">𝑖</ci><ci id="S3.SS2.SSS0.Px2.p2.4.m4.3.3.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.3.3">:</ci></list></apply></apply><apply id="S3.SS2.SSS0.Px2.p2.4.m4.3.4c.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.3.4"><in id="S3.SS2.SSS0.Px2.p2.4.m4.3.4.5.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.3.4.5"></in><share href="#S3.SS2.SSS0.Px2.p2.4.m4.3.4.4.cmml" id="S3.SS2.SSS0.Px2.p2.4.m4.3.4d.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.3.4"></share><apply id="S3.SS2.SSS0.Px2.p2.4.m4.3.4.6.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.3.4.6"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.4.m4.3.4.6.1.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.3.4.6">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.4.m4.3.4.6.2.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.3.4.6.2">ℝ</ci><apply id="S3.SS2.SSS0.Px2.p2.4.m4.3.4.6.3.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.3.4.6.3"><times id="S3.SS2.SSS0.Px2.p2.4.m4.3.4.6.3.1.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.3.4.6.3.1"></times><ci id="S3.SS2.SSS0.Px2.p2.4.m4.3.4.6.3.2.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.3.4.6.3.2">𝑅</ci><ci id="S3.SS2.SSS0.Px2.p2.4.m4.3.4.6.3.3.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.3.4.6.3.3">𝐶</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.4.m4.3c">f_{i}=F[:,i,:]\in\mathbb{R}^{R\times C}</annotation></semantics></math> and <math id="S3.SS2.SSS0.Px2.p2.5.m5.3" class="ltx_Math" alttext="f^{a}_{i}=F^{A}[:,i,:]\in\mathbb{R}^{N\times C}" display="inline"><semantics id="S3.SS2.SSS0.Px2.p2.5.m5.3a"><mrow id="S3.SS2.SSS0.Px2.p2.5.m5.3.4" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4.cmml"><msubsup id="S3.SS2.SSS0.Px2.p2.5.m5.3.4.2" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4.2.cmml"><mi id="S3.SS2.SSS0.Px2.p2.5.m5.3.4.2.2.2" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4.2.2.2.cmml">f</mi><mi id="S3.SS2.SSS0.Px2.p2.5.m5.3.4.2.3" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4.2.3.cmml">i</mi><mi id="S3.SS2.SSS0.Px2.p2.5.m5.3.4.2.2.3" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4.2.2.3.cmml">a</mi></msubsup><mo id="S3.SS2.SSS0.Px2.p2.5.m5.3.4.3" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4.3.cmml">=</mo><mrow id="S3.SS2.SSS0.Px2.p2.5.m5.3.4.4" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4.4.cmml"><msup id="S3.SS2.SSS0.Px2.p2.5.m5.3.4.4.2" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4.4.2.cmml"><mi id="S3.SS2.SSS0.Px2.p2.5.m5.3.4.4.2.2" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4.4.2.2.cmml">F</mi><mi id="S3.SS2.SSS0.Px2.p2.5.m5.3.4.4.2.3" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4.4.2.3.cmml">A</mi></msup><mo lspace="0em" rspace="0em" id="S3.SS2.SSS0.Px2.p2.5.m5.3.4.4.1" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4.4.1.cmml">​</mo><mrow id="S3.SS2.SSS0.Px2.p2.5.m5.3.4.4.3.2" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4.4.3.1.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px2.p2.5.m5.3.4.4.3.2.1" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4.4.3.1.cmml">[</mo><mo rspace="0em" id="S3.SS2.SSS0.Px2.p2.5.m5.1.1" xref="S3.SS2.SSS0.Px2.p2.5.m5.1.1.cmml">:</mo><mo id="S3.SS2.SSS0.Px2.p2.5.m5.3.4.4.3.2.2" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4.4.3.1.cmml">,</mo><mi id="S3.SS2.SSS0.Px2.p2.5.m5.2.2" xref="S3.SS2.SSS0.Px2.p2.5.m5.2.2.cmml">i</mi><mo id="S3.SS2.SSS0.Px2.p2.5.m5.3.4.4.3.2.3" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4.4.3.1.cmml">,</mo><mo rspace="0em" id="S3.SS2.SSS0.Px2.p2.5.m5.3.3" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.3.cmml">:</mo><mo stretchy="false" id="S3.SS2.SSS0.Px2.p2.5.m5.3.4.4.3.2.4" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4.4.3.1.cmml">]</mo></mrow></mrow><mo id="S3.SS2.SSS0.Px2.p2.5.m5.3.4.5" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4.5.cmml">∈</mo><msup id="S3.SS2.SSS0.Px2.p2.5.m5.3.4.6" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4.6.cmml"><mi id="S3.SS2.SSS0.Px2.p2.5.m5.3.4.6.2" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4.6.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS0.Px2.p2.5.m5.3.4.6.3" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4.6.3.cmml"><mi id="S3.SS2.SSS0.Px2.p2.5.m5.3.4.6.3.2" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4.6.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.SSS0.Px2.p2.5.m5.3.4.6.3.1" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4.6.3.1.cmml">×</mo><mi id="S3.SS2.SSS0.Px2.p2.5.m5.3.4.6.3.3" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4.6.3.3.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.5.m5.3b"><apply id="S3.SS2.SSS0.Px2.p2.5.m5.3.4.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4"><and id="S3.SS2.SSS0.Px2.p2.5.m5.3.4a.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4"></and><apply id="S3.SS2.SSS0.Px2.p2.5.m5.3.4b.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4"><eq id="S3.SS2.SSS0.Px2.p2.5.m5.3.4.3.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4.3"></eq><apply id="S3.SS2.SSS0.Px2.p2.5.m5.3.4.2.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.5.m5.3.4.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4.2">subscript</csymbol><apply id="S3.SS2.SSS0.Px2.p2.5.m5.3.4.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.5.m5.3.4.2.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.5.m5.3.4.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4.2.2.2">𝑓</ci><ci id="S3.SS2.SSS0.Px2.p2.5.m5.3.4.2.2.3.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4.2.2.3">𝑎</ci></apply><ci id="S3.SS2.SSS0.Px2.p2.5.m5.3.4.2.3.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4.2.3">𝑖</ci></apply><apply id="S3.SS2.SSS0.Px2.p2.5.m5.3.4.4.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4.4"><times id="S3.SS2.SSS0.Px2.p2.5.m5.3.4.4.1.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4.4.1"></times><apply id="S3.SS2.SSS0.Px2.p2.5.m5.3.4.4.2.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4.4.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.5.m5.3.4.4.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4.4.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.5.m5.3.4.4.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4.4.2.2">𝐹</ci><ci id="S3.SS2.SSS0.Px2.p2.5.m5.3.4.4.2.3.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4.4.2.3">𝐴</ci></apply><list id="S3.SS2.SSS0.Px2.p2.5.m5.3.4.4.3.1.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4.4.3.2"><ci id="S3.SS2.SSS0.Px2.p2.5.m5.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.1.1">:</ci><ci id="S3.SS2.SSS0.Px2.p2.5.m5.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.2.2">𝑖</ci><ci id="S3.SS2.SSS0.Px2.p2.5.m5.3.3.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.3">:</ci></list></apply></apply><apply id="S3.SS2.SSS0.Px2.p2.5.m5.3.4c.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4"><in id="S3.SS2.SSS0.Px2.p2.5.m5.3.4.5.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4.5"></in><share href="#S3.SS2.SSS0.Px2.p2.5.m5.3.4.4.cmml" id="S3.SS2.SSS0.Px2.p2.5.m5.3.4d.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4"></share><apply id="S3.SS2.SSS0.Px2.p2.5.m5.3.4.6.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4.6"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.5.m5.3.4.6.1.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4.6">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.5.m5.3.4.6.2.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4.6.2">ℝ</ci><apply id="S3.SS2.SSS0.Px2.p2.5.m5.3.4.6.3.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4.6.3"><times id="S3.SS2.SSS0.Px2.p2.5.m5.3.4.6.3.1.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4.6.3.1"></times><ci id="S3.SS2.SSS0.Px2.p2.5.m5.3.4.6.3.2.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4.6.3.2">𝑁</ci><ci id="S3.SS2.SSS0.Px2.p2.5.m5.3.4.6.3.3.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.4.6.3.3">𝐶</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.5.m5.3c">f^{a}_{i}=F^{A}[:,i,:]\in\mathbb{R}^{N\times C}</annotation></semantics></math> as the query and attending features respectively, the formulation of the cross-attention is the same as Eq. <a href="#S3.E3" title="In Condense attention. ‣ 3.2 Global representation re-alignment module ‣ 3 Method ‣ PARTNER: Level up the Polar Representation for LiDAR 3D Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> and Eq. <a href="#S3.E4" title="In Condense attention. ‣ 3.2 Global representation re-alignment module ‣ 3 Method ‣ PARTNER: Level up the Polar Representation for LiDAR 3D Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<div id="S3.SS2.SSS0.Px2.p3" class="ltx_para">
<p id="S3.SS2.SSS0.Px2.p3.1" class="ltx_p">Our model employs two stacked modules for information interaction, where the second angular attention uses a shifted window partition.
Slightly different from the shifting mechanism in Swin Transformer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>, the window is directly rolled without multiplying an attention mask, owing to the existing connection between the most left column and most right column of the polar BEV map.</p>
</div>
<figure id="S3.F4" class="ltx_figure"><img src="/html/2308.03982/assets/x4.png" id="S3.F4.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="160" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>
The overall architecture of geometry-aware adaptive module.
The geometry-aware prediction module takes 2D BEV features as input, and predicts the foreground segmentation and center regression results.
The geometry-aware aggregation module takes the predicted clues and processes them through an MLP with the positional clues and the BEV features to produce query, key, and value map.
Then two stacked multi-head window attentions are deployed to the maps.
</figcaption>
</figure>
</section>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Geometry-aware adaptive module</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">In this section, we first investigate the potential drawbacks of the polar framework on detection heads.
As is discussed in Sec. <a href="#S1" title="1 Introduction ‣ PARTNER: Level up the Polar Representation for LiDAR 3D Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, the spatial resolution of polar grids varies depending on the range, which brings the following problems for the detection head: 1) feature blurring that distant scenes are represented with low resolution, making distant objects close to each other indistinguishable,
and 2) shape variation where traditional CNN-based regression heads tend to fail due to the diverse distorted appearances of objects in different ranges or with different heading angles.
Both of the two issues would lead to regression difficulties in polar detectors.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.1" class="ltx_p">To address these challenges, we present the Geometry-aware Adaptive (GA) module, a plug-and-play module that is deployed right before the detection head.
The module discriminates features from different instances and explicitly introduces both instance information and geometric clues to the feature aggregation process.
In the following part, we first introduce the geometry-aware prediction module, followed by the details of the geometry-aware aggregation module.
</p>
</div>
<section id="S3.SS3.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Geometry-aware prediction.</h4>

<div id="S3.SS3.SSS0.Px1.p1" class="ltx_para">
<p id="S3.SS3.SSS0.Px1.p1.7" class="ltx_p">To obtain fine-grained instance and geometric information, we leverage auxiliary supervisions with two prediction branches: a foreground segmentation branch and a regression branch.
Detailedly, both branches take the BEV features <math id="S3.SS3.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="F^{neck}" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.1.m1.1a"><msup id="S3.SS3.SSS0.Px1.p1.1.m1.1.1" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.2" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.2.cmml">F</mi><mrow id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3.cmml"><mi id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3.2" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3.1" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3.3" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3.1a" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3.4" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3.1b" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3.5" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3.5.cmml">k</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.1.m1.1b"><apply id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1">superscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.2">𝐹</ci><apply id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3"><times id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3.1"></times><ci id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3.2.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3.2">𝑛</ci><ci id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3.3.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3.3">𝑒</ci><ci id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3.4.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3.4">𝑐</ci><ci id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3.5.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3.5">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.1.m1.1c">F^{neck}</annotation></semantics></math> produced by the 2D backbone as input.
The segmentation branch produces a heatmap <math id="S3.SS3.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="H\in\mathbb{R}^{R\times A}" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.2.m2.1a"><mrow id="S3.SS3.SSS0.Px1.p1.2.m2.1.1" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.2" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.2.cmml">H</mi><mo id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.1" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.cmml"><mi id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.2" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.3" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.3.cmml"><mi id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.3.2" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.3.2.cmml">R</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.3.1" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.3.3" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.3.3.cmml">A</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.2.m2.1b"><apply id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1"><in id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.1"></in><ci id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.2">𝐻</ci><apply id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.2.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.2">ℝ</ci><apply id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.3.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.3"><times id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.3.1.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.3.1"></times><ci id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.3.2.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.3.2">𝑅</ci><ci id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.3.3.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.3.3">𝐴</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.2.m2.1c">H\in\mathbb{R}^{R\times A}</annotation></semantics></math>.
Let <math id="S3.SS3.SSS0.Px1.p1.3.m3.1" class="ltx_Math" alttext="\hat{H}\in\mathbb{R}^{R\times A}" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.3.m3.1a"><mrow id="S3.SS3.SSS0.Px1.p1.3.m3.1.1" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.cmml"><mover accent="true" id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.2" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.2.cmml"><mi id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.2.2" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.2.2.cmml">H</mi><mo id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.2.1" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.2.1.cmml">^</mo></mover><mo id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.3" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.3.cmml"><mi id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.3.2" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.3.3" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.3.3.cmml"><mi id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.3.3.2" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.3.3.2.cmml">R</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.3.3.1" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.3.3.3" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.3.3.3.cmml">A</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.3.m3.1b"><apply id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1"><in id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1"></in><apply id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.2"><ci id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.2.1">^</ci><ci id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.2.2">𝐻</ci></apply><apply id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.3.2.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.3.2">ℝ</ci><apply id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.3.3.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.3.3"><times id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.3.3.1.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.3.3.1"></times><ci id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.3.3.2.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.3.3.2">𝑅</ci><ci id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.3.3.3.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.3.3.3">𝐴</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.3.m3.1c">\hat{H}\in\mathbb{R}^{R\times A}</annotation></semantics></math> denote the corresponding target map of <math id="S3.SS3.SSS0.Px1.p1.4.m4.1" class="ltx_Math" alttext="H" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.4.m4.1a"><mi id="S3.SS3.SSS0.Px1.p1.4.m4.1.1" xref="S3.SS3.SSS0.Px1.p1.4.m4.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.4.m4.1b"><ci id="S3.SS3.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.4.m4.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.4.m4.1c">H</annotation></semantics></math> and <math id="S3.SS3.SSS0.Px1.p1.5.m5.1" class="ltx_Math" alttext="B_{bev}\in\mathbb{R}^{M\times 5}" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.5.m5.1a"><mrow id="S3.SS3.SSS0.Px1.p1.5.m5.1.1" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.cmml"><msub id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.2" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.2.cmml"><mi id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.2.2" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.2.2.cmml">B</mi><mrow id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.2.3" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.2.3.cmml"><mi id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.2.3.2" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.2.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.2.3.1" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.2.3.3" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.2.3.1a" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.2.3.4" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.2.3.4.cmml">v</mi></mrow></msub><mo id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.3" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.3.cmml"><mi id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.3.2" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.3.3" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.3.3.cmml"><mi id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.3.3.2" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.3.3.2.cmml">M</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.3.3.1" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.3.3.1.cmml">×</mo><mn id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.3.3.3" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.3.3.3.cmml">5</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.5.m5.1b"><apply id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1"><in id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1"></in><apply id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.2.2">𝐵</ci><apply id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.2.3.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.2.3"><times id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.2.3.1.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.2.3.1"></times><ci id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.2.3.2.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.2.3.2">𝑏</ci><ci id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.2.3.3.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.2.3.3">𝑒</ci><ci id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.2.3.4.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.2.3.4">𝑣</ci></apply></apply><apply id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.3.2.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.3.2">ℝ</ci><apply id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.3.3.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.3.3"><times id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.3.3.1.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.3.3.1"></times><ci id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.3.3.2.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.3.3.2">𝑀</ci><cn type="integer" id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.3.3.3.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.3.3.3">5</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.5.m5.1c">B_{bev}\in\mathbb{R}^{M\times 5}</annotation></semantics></math> denote the BEV bounding boxes <math id="S3.SS3.SSS0.Px1.p1.6.m6.5" class="ltx_Math" alttext="(x,y,w,h,\theta)" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.6.m6.5a"><mrow id="S3.SS3.SSS0.Px1.p1.6.m6.5.6.2" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.6.1.cmml"><mo stretchy="false" id="S3.SS3.SSS0.Px1.p1.6.m6.5.6.2.1" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.6.1.cmml">(</mo><mi id="S3.SS3.SSS0.Px1.p1.6.m6.1.1" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.1.cmml">x</mi><mo id="S3.SS3.SSS0.Px1.p1.6.m6.5.6.2.2" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.6.1.cmml">,</mo><mi id="S3.SS3.SSS0.Px1.p1.6.m6.2.2" xref="S3.SS3.SSS0.Px1.p1.6.m6.2.2.cmml">y</mi><mo id="S3.SS3.SSS0.Px1.p1.6.m6.5.6.2.3" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.6.1.cmml">,</mo><mi id="S3.SS3.SSS0.Px1.p1.6.m6.3.3" xref="S3.SS3.SSS0.Px1.p1.6.m6.3.3.cmml">w</mi><mo id="S3.SS3.SSS0.Px1.p1.6.m6.5.6.2.4" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.6.1.cmml">,</mo><mi id="S3.SS3.SSS0.Px1.p1.6.m6.4.4" xref="S3.SS3.SSS0.Px1.p1.6.m6.4.4.cmml">h</mi><mo id="S3.SS3.SSS0.Px1.p1.6.m6.5.6.2.5" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.6.1.cmml">,</mo><mi id="S3.SS3.SSS0.Px1.p1.6.m6.5.5" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.5.cmml">θ</mi><mo stretchy="false" id="S3.SS3.SSS0.Px1.p1.6.m6.5.6.2.6" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.6.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.6.m6.5b"><vector id="S3.SS3.SSS0.Px1.p1.6.m6.5.6.1.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.6.2"><ci id="S3.SS3.SSS0.Px1.p1.6.m6.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.1">𝑥</ci><ci id="S3.SS3.SSS0.Px1.p1.6.m6.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.2.2">𝑦</ci><ci id="S3.SS3.SSS0.Px1.p1.6.m6.3.3.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.3.3">𝑤</ci><ci id="S3.SS3.SSS0.Px1.p1.6.m6.4.4.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.4.4">ℎ</ci><ci id="S3.SS3.SSS0.Px1.p1.6.m6.5.5.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.5">𝜃</ci></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.6.m6.5c">(x,y,w,h,\theta)</annotation></semantics></math> of the ground-truth objects.
The target map of <math id="S3.SS3.SSS0.Px1.p1.7.m7.1" class="ltx_Math" alttext="\hat{H}" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.7.m7.1a"><mover accent="true" id="S3.SS3.SSS0.Px1.p1.7.m7.1.1" xref="S3.SS3.SSS0.Px1.p1.7.m7.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p1.7.m7.1.1.2" xref="S3.SS3.SSS0.Px1.p1.7.m7.1.1.2.cmml">H</mi><mo id="S3.SS3.SSS0.Px1.p1.7.m7.1.1.1" xref="S3.SS3.SSS0.Px1.p1.7.m7.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.7.m7.1b"><apply id="S3.SS3.SSS0.Px1.p1.7.m7.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.7.m7.1.1"><ci id="S3.SS3.SSS0.Px1.p1.7.m7.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.7.m7.1.1.1">^</ci><ci id="S3.SS3.SSS0.Px1.p1.7.m7.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.7.m7.1.1.2">𝐻</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.7.m7.1c">\hat{H}</annotation></semantics></math> can be formulated as:</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.6" class="ltx_Math" alttext="\hat{H}[i]=\begin{cases}1&amp;\text{if }\exists B_{bev}[j],p_{i}\text{ is inside }B_{bev}[j]\\
0&amp;\text{otherwise}\end{cases}," display="block"><semantics id="S3.E5.m1.6a"><mrow id="S3.E5.m1.6.6.1" xref="S3.E5.m1.6.6.1.1.cmml"><mrow id="S3.E5.m1.6.6.1.1" xref="S3.E5.m1.6.6.1.1.cmml"><mrow id="S3.E5.m1.6.6.1.1.2" xref="S3.E5.m1.6.6.1.1.2.cmml"><mover accent="true" id="S3.E5.m1.6.6.1.1.2.2" xref="S3.E5.m1.6.6.1.1.2.2.cmml"><mi id="S3.E5.m1.6.6.1.1.2.2.2" xref="S3.E5.m1.6.6.1.1.2.2.2.cmml">H</mi><mo id="S3.E5.m1.6.6.1.1.2.2.1" xref="S3.E5.m1.6.6.1.1.2.2.1.cmml">^</mo></mover><mo lspace="0em" rspace="0em" id="S3.E5.m1.6.6.1.1.2.1" xref="S3.E5.m1.6.6.1.1.2.1.cmml">​</mo><mrow id="S3.E5.m1.6.6.1.1.2.3.2" xref="S3.E5.m1.6.6.1.1.2.3.1.cmml"><mo stretchy="false" id="S3.E5.m1.6.6.1.1.2.3.2.1" xref="S3.E5.m1.6.6.1.1.2.3.1.1.cmml">[</mo><mi id="S3.E5.m1.5.5" xref="S3.E5.m1.5.5.cmml">i</mi><mo stretchy="false" id="S3.E5.m1.6.6.1.1.2.3.2.2" xref="S3.E5.m1.6.6.1.1.2.3.1.1.cmml">]</mo></mrow></mrow><mo id="S3.E5.m1.6.6.1.1.1" xref="S3.E5.m1.6.6.1.1.1.cmml">=</mo><mrow id="S3.E5.m1.4.4" xref="S3.E5.m1.6.6.1.1.3.1.cmml"><mo id="S3.E5.m1.4.4.5" xref="S3.E5.m1.6.6.1.1.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt" id="S3.E5.m1.4.4.4" xref="S3.E5.m1.6.6.1.1.3.1.cmml"><mtr id="S3.E5.m1.4.4.4a" xref="S3.E5.m1.6.6.1.1.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m1.4.4.4b" xref="S3.E5.m1.6.6.1.1.3.1.cmml"><mn id="S3.E5.m1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.cmml">1</mn></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m1.4.4.4c" xref="S3.E5.m1.6.6.1.1.3.1.cmml"><mrow id="S3.E5.m1.2.2.2.2.2.1.4" xref="S3.E5.m1.2.2.2.2.2.1.5.cmml"><mrow id="S3.E5.m1.2.2.2.2.2.1.3.1" xref="S3.E5.m1.2.2.2.2.2.1.3.1.cmml"><mtext id="S3.E5.m1.2.2.2.2.2.1.3.1.2" xref="S3.E5.m1.2.2.2.2.2.1.3.1.2a.cmml">if </mtext><mo lspace="0.167em" rspace="0em" id="S3.E5.m1.2.2.2.2.2.1.3.1.1" xref="S3.E5.m1.2.2.2.2.2.1.3.1.1.cmml">​</mo><mrow id="S3.E5.m1.2.2.2.2.2.1.3.1.3" xref="S3.E5.m1.2.2.2.2.2.1.3.1.3.cmml"><mo rspace="0.167em" id="S3.E5.m1.2.2.2.2.2.1.3.1.3.1" xref="S3.E5.m1.2.2.2.2.2.1.3.1.3.1.cmml">∃</mo><mrow id="S3.E5.m1.2.2.2.2.2.1.3.1.3.2" xref="S3.E5.m1.2.2.2.2.2.1.3.1.3.2.cmml"><msub id="S3.E5.m1.2.2.2.2.2.1.3.1.3.2.2" xref="S3.E5.m1.2.2.2.2.2.1.3.1.3.2.2.cmml"><mi id="S3.E5.m1.2.2.2.2.2.1.3.1.3.2.2.2" xref="S3.E5.m1.2.2.2.2.2.1.3.1.3.2.2.2.cmml">B</mi><mrow id="S3.E5.m1.2.2.2.2.2.1.3.1.3.2.2.3" xref="S3.E5.m1.2.2.2.2.2.1.3.1.3.2.2.3.cmml"><mi id="S3.E5.m1.2.2.2.2.2.1.3.1.3.2.2.3.2" xref="S3.E5.m1.2.2.2.2.2.1.3.1.3.2.2.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.2.2.2.2.2.1.3.1.3.2.2.3.1" xref="S3.E5.m1.2.2.2.2.2.1.3.1.3.2.2.3.1.cmml">​</mo><mi id="S3.E5.m1.2.2.2.2.2.1.3.1.3.2.2.3.3" xref="S3.E5.m1.2.2.2.2.2.1.3.1.3.2.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.2.2.2.2.2.1.3.1.3.2.2.3.1a" xref="S3.E5.m1.2.2.2.2.2.1.3.1.3.2.2.3.1.cmml">​</mo><mi id="S3.E5.m1.2.2.2.2.2.1.3.1.3.2.2.3.4" xref="S3.E5.m1.2.2.2.2.2.1.3.1.3.2.2.3.4.cmml">v</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.2.2.2.2.2.1.3.1.3.2.1" xref="S3.E5.m1.2.2.2.2.2.1.3.1.3.2.1.cmml">​</mo><mrow id="S3.E5.m1.2.2.2.2.2.1.3.1.3.2.3.2" xref="S3.E5.m1.2.2.2.2.2.1.3.1.3.2.3.1.cmml"><mo stretchy="false" id="S3.E5.m1.2.2.2.2.2.1.3.1.3.2.3.2.1" xref="S3.E5.m1.2.2.2.2.2.1.3.1.3.2.3.1.1.cmml">[</mo><mi id="S3.E5.m1.2.2.2.2.2.1.1" xref="S3.E5.m1.2.2.2.2.2.1.1.cmml">j</mi><mo stretchy="false" id="S3.E5.m1.2.2.2.2.2.1.3.1.3.2.3.2.2" xref="S3.E5.m1.2.2.2.2.2.1.3.1.3.2.3.1.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo id="S3.E5.m1.2.2.2.2.2.1.4.3" xref="S3.E5.m1.2.2.2.2.2.1.5.cmml">,</mo><mrow id="S3.E5.m1.2.2.2.2.2.1.4.2" xref="S3.E5.m1.2.2.2.2.2.1.4.2.cmml"><msub id="S3.E5.m1.2.2.2.2.2.1.4.2.2" xref="S3.E5.m1.2.2.2.2.2.1.4.2.2.cmml"><mi id="S3.E5.m1.2.2.2.2.2.1.4.2.2.2" xref="S3.E5.m1.2.2.2.2.2.1.4.2.2.2.cmml">p</mi><mi id="S3.E5.m1.2.2.2.2.2.1.4.2.2.3" xref="S3.E5.m1.2.2.2.2.2.1.4.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.2.2.2.2.2.1.4.2.1" xref="S3.E5.m1.2.2.2.2.2.1.4.2.1.cmml">​</mo><mtext id="S3.E5.m1.2.2.2.2.2.1.4.2.3" xref="S3.E5.m1.2.2.2.2.2.1.4.2.3a.cmml"> is inside </mtext><mo lspace="0em" rspace="0em" id="S3.E5.m1.2.2.2.2.2.1.4.2.1a" xref="S3.E5.m1.2.2.2.2.2.1.4.2.1.cmml">​</mo><msub id="S3.E5.m1.2.2.2.2.2.1.4.2.4" xref="S3.E5.m1.2.2.2.2.2.1.4.2.4.cmml"><mi id="S3.E5.m1.2.2.2.2.2.1.4.2.4.2" xref="S3.E5.m1.2.2.2.2.2.1.4.2.4.2.cmml">B</mi><mrow id="S3.E5.m1.2.2.2.2.2.1.4.2.4.3" xref="S3.E5.m1.2.2.2.2.2.1.4.2.4.3.cmml"><mi id="S3.E5.m1.2.2.2.2.2.1.4.2.4.3.2" xref="S3.E5.m1.2.2.2.2.2.1.4.2.4.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.2.2.2.2.2.1.4.2.4.3.1" xref="S3.E5.m1.2.2.2.2.2.1.4.2.4.3.1.cmml">​</mo><mi id="S3.E5.m1.2.2.2.2.2.1.4.2.4.3.3" xref="S3.E5.m1.2.2.2.2.2.1.4.2.4.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.2.2.2.2.2.1.4.2.4.3.1a" xref="S3.E5.m1.2.2.2.2.2.1.4.2.4.3.1.cmml">​</mo><mi id="S3.E5.m1.2.2.2.2.2.1.4.2.4.3.4" xref="S3.E5.m1.2.2.2.2.2.1.4.2.4.3.4.cmml">v</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.2.2.2.2.2.1.4.2.1b" xref="S3.E5.m1.2.2.2.2.2.1.4.2.1.cmml">​</mo><mrow id="S3.E5.m1.2.2.2.2.2.1.4.2.5.2" xref="S3.E5.m1.2.2.2.2.2.1.4.2.5.1.cmml"><mo stretchy="false" id="S3.E5.m1.2.2.2.2.2.1.4.2.5.2.1" xref="S3.E5.m1.2.2.2.2.2.1.4.2.5.1.1.cmml">[</mo><mi id="S3.E5.m1.2.2.2.2.2.1.2" xref="S3.E5.m1.2.2.2.2.2.1.2.cmml">j</mi><mo stretchy="false" id="S3.E5.m1.2.2.2.2.2.1.4.2.5.2.2" xref="S3.E5.m1.2.2.2.2.2.1.4.2.5.1.1.cmml">]</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E5.m1.4.4.4d" xref="S3.E5.m1.6.6.1.1.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m1.4.4.4e" xref="S3.E5.m1.6.6.1.1.3.1.cmml"><mn id="S3.E5.m1.3.3.3.3.1.1" xref="S3.E5.m1.3.3.3.3.1.1.cmml">0</mn></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m1.4.4.4f" xref="S3.E5.m1.6.6.1.1.3.1.cmml"><mtext id="S3.E5.m1.4.4.4.4.2.1" xref="S3.E5.m1.4.4.4.4.2.1a.cmml">otherwise</mtext></mtd></mtr></mtable></mrow></mrow><mo id="S3.E5.m1.6.6.1.2" xref="S3.E5.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.6b"><apply id="S3.E5.m1.6.6.1.1.cmml" xref="S3.E5.m1.6.6.1"><eq id="S3.E5.m1.6.6.1.1.1.cmml" xref="S3.E5.m1.6.6.1.1.1"></eq><apply id="S3.E5.m1.6.6.1.1.2.cmml" xref="S3.E5.m1.6.6.1.1.2"><times id="S3.E5.m1.6.6.1.1.2.1.cmml" xref="S3.E5.m1.6.6.1.1.2.1"></times><apply id="S3.E5.m1.6.6.1.1.2.2.cmml" xref="S3.E5.m1.6.6.1.1.2.2"><ci id="S3.E5.m1.6.6.1.1.2.2.1.cmml" xref="S3.E5.m1.6.6.1.1.2.2.1">^</ci><ci id="S3.E5.m1.6.6.1.1.2.2.2.cmml" xref="S3.E5.m1.6.6.1.1.2.2.2">𝐻</ci></apply><apply id="S3.E5.m1.6.6.1.1.2.3.1.cmml" xref="S3.E5.m1.6.6.1.1.2.3.2"><csymbol cd="latexml" id="S3.E5.m1.6.6.1.1.2.3.1.1.cmml" xref="S3.E5.m1.6.6.1.1.2.3.2.1">delimited-[]</csymbol><ci id="S3.E5.m1.5.5.cmml" xref="S3.E5.m1.5.5">𝑖</ci></apply></apply><apply id="S3.E5.m1.6.6.1.1.3.1.cmml" xref="S3.E5.m1.4.4"><csymbol cd="latexml" id="S3.E5.m1.6.6.1.1.3.1.1.cmml" xref="S3.E5.m1.4.4.5">cases</csymbol><cn type="integer" id="S3.E5.m1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1">1</cn><list id="S3.E5.m1.2.2.2.2.2.1.5.cmml" xref="S3.E5.m1.2.2.2.2.2.1.4"><apply id="S3.E5.m1.2.2.2.2.2.1.3.1.cmml" xref="S3.E5.m1.2.2.2.2.2.1.3.1"><times id="S3.E5.m1.2.2.2.2.2.1.3.1.1.cmml" xref="S3.E5.m1.2.2.2.2.2.1.3.1.1"></times><ci id="S3.E5.m1.2.2.2.2.2.1.3.1.2a.cmml" xref="S3.E5.m1.2.2.2.2.2.1.3.1.2"><mtext id="S3.E5.m1.2.2.2.2.2.1.3.1.2.cmml" xref="S3.E5.m1.2.2.2.2.2.1.3.1.2">if </mtext></ci><apply id="S3.E5.m1.2.2.2.2.2.1.3.1.3.cmml" xref="S3.E5.m1.2.2.2.2.2.1.3.1.3"><exists id="S3.E5.m1.2.2.2.2.2.1.3.1.3.1.cmml" xref="S3.E5.m1.2.2.2.2.2.1.3.1.3.1"></exists><apply id="S3.E5.m1.2.2.2.2.2.1.3.1.3.2.cmml" xref="S3.E5.m1.2.2.2.2.2.1.3.1.3.2"><times id="S3.E5.m1.2.2.2.2.2.1.3.1.3.2.1.cmml" xref="S3.E5.m1.2.2.2.2.2.1.3.1.3.2.1"></times><apply id="S3.E5.m1.2.2.2.2.2.1.3.1.3.2.2.cmml" xref="S3.E5.m1.2.2.2.2.2.1.3.1.3.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.2.2.1.3.1.3.2.2.1.cmml" xref="S3.E5.m1.2.2.2.2.2.1.3.1.3.2.2">subscript</csymbol><ci id="S3.E5.m1.2.2.2.2.2.1.3.1.3.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2.2.1.3.1.3.2.2.2">𝐵</ci><apply id="S3.E5.m1.2.2.2.2.2.1.3.1.3.2.2.3.cmml" xref="S3.E5.m1.2.2.2.2.2.1.3.1.3.2.2.3"><times id="S3.E5.m1.2.2.2.2.2.1.3.1.3.2.2.3.1.cmml" xref="S3.E5.m1.2.2.2.2.2.1.3.1.3.2.2.3.1"></times><ci id="S3.E5.m1.2.2.2.2.2.1.3.1.3.2.2.3.2.cmml" xref="S3.E5.m1.2.2.2.2.2.1.3.1.3.2.2.3.2">𝑏</ci><ci id="S3.E5.m1.2.2.2.2.2.1.3.1.3.2.2.3.3.cmml" xref="S3.E5.m1.2.2.2.2.2.1.3.1.3.2.2.3.3">𝑒</ci><ci id="S3.E5.m1.2.2.2.2.2.1.3.1.3.2.2.3.4.cmml" xref="S3.E5.m1.2.2.2.2.2.1.3.1.3.2.2.3.4">𝑣</ci></apply></apply><apply id="S3.E5.m1.2.2.2.2.2.1.3.1.3.2.3.1.cmml" xref="S3.E5.m1.2.2.2.2.2.1.3.1.3.2.3.2"><csymbol cd="latexml" id="S3.E5.m1.2.2.2.2.2.1.3.1.3.2.3.1.1.cmml" xref="S3.E5.m1.2.2.2.2.2.1.3.1.3.2.3.2.1">delimited-[]</csymbol><ci id="S3.E5.m1.2.2.2.2.2.1.1.cmml" xref="S3.E5.m1.2.2.2.2.2.1.1">𝑗</ci></apply></apply></apply></apply><apply id="S3.E5.m1.2.2.2.2.2.1.4.2.cmml" xref="S3.E5.m1.2.2.2.2.2.1.4.2"><times id="S3.E5.m1.2.2.2.2.2.1.4.2.1.cmml" xref="S3.E5.m1.2.2.2.2.2.1.4.2.1"></times><apply id="S3.E5.m1.2.2.2.2.2.1.4.2.2.cmml" xref="S3.E5.m1.2.2.2.2.2.1.4.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.2.2.1.4.2.2.1.cmml" xref="S3.E5.m1.2.2.2.2.2.1.4.2.2">subscript</csymbol><ci id="S3.E5.m1.2.2.2.2.2.1.4.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2.2.1.4.2.2.2">𝑝</ci><ci id="S3.E5.m1.2.2.2.2.2.1.4.2.2.3.cmml" xref="S3.E5.m1.2.2.2.2.2.1.4.2.2.3">𝑖</ci></apply><ci id="S3.E5.m1.2.2.2.2.2.1.4.2.3a.cmml" xref="S3.E5.m1.2.2.2.2.2.1.4.2.3"><mtext id="S3.E5.m1.2.2.2.2.2.1.4.2.3.cmml" xref="S3.E5.m1.2.2.2.2.2.1.4.2.3"> is inside </mtext></ci><apply id="S3.E5.m1.2.2.2.2.2.1.4.2.4.cmml" xref="S3.E5.m1.2.2.2.2.2.1.4.2.4"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.2.2.1.4.2.4.1.cmml" xref="S3.E5.m1.2.2.2.2.2.1.4.2.4">subscript</csymbol><ci id="S3.E5.m1.2.2.2.2.2.1.4.2.4.2.cmml" xref="S3.E5.m1.2.2.2.2.2.1.4.2.4.2">𝐵</ci><apply id="S3.E5.m1.2.2.2.2.2.1.4.2.4.3.cmml" xref="S3.E5.m1.2.2.2.2.2.1.4.2.4.3"><times id="S3.E5.m1.2.2.2.2.2.1.4.2.4.3.1.cmml" xref="S3.E5.m1.2.2.2.2.2.1.4.2.4.3.1"></times><ci id="S3.E5.m1.2.2.2.2.2.1.4.2.4.3.2.cmml" xref="S3.E5.m1.2.2.2.2.2.1.4.2.4.3.2">𝑏</ci><ci id="S3.E5.m1.2.2.2.2.2.1.4.2.4.3.3.cmml" xref="S3.E5.m1.2.2.2.2.2.1.4.2.4.3.3">𝑒</ci><ci id="S3.E5.m1.2.2.2.2.2.1.4.2.4.3.4.cmml" xref="S3.E5.m1.2.2.2.2.2.1.4.2.4.3.4">𝑣</ci></apply></apply><apply id="S3.E5.m1.2.2.2.2.2.1.4.2.5.1.cmml" xref="S3.E5.m1.2.2.2.2.2.1.4.2.5.2"><csymbol cd="latexml" id="S3.E5.m1.2.2.2.2.2.1.4.2.5.1.1.cmml" xref="S3.E5.m1.2.2.2.2.2.1.4.2.5.2.1">delimited-[]</csymbol><ci id="S3.E5.m1.2.2.2.2.2.1.2.cmml" xref="S3.E5.m1.2.2.2.2.2.1.2">𝑗</ci></apply></apply></list><cn type="integer" id="S3.E5.m1.3.3.3.3.1.1.cmml" xref="S3.E5.m1.3.3.3.3.1.1">0</cn><ci id="S3.E5.m1.4.4.4.4.2.1a.cmml" xref="S3.E5.m1.4.4.4.4.2.1"><mtext id="S3.E5.m1.4.4.4.4.2.1.cmml" xref="S3.E5.m1.4.4.4.4.2.1">otherwise</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.6c">\hat{H}[i]=\begin{cases}1&amp;\text{if }\exists B_{bev}[j],p_{i}\text{ is inside }B_{bev}[j]\\
0&amp;\text{otherwise}\end{cases},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.SSS0.Px1.p1.12" class="ltx_p">where <math id="S3.SS3.SSS0.Px1.p1.8.m1.1" class="ltx_Math" alttext="\hat{H}[i]" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.8.m1.1a"><mrow id="S3.SS3.SSS0.Px1.p1.8.m1.1.2" xref="S3.SS3.SSS0.Px1.p1.8.m1.1.2.cmml"><mover accent="true" id="S3.SS3.SSS0.Px1.p1.8.m1.1.2.2" xref="S3.SS3.SSS0.Px1.p1.8.m1.1.2.2.cmml"><mi id="S3.SS3.SSS0.Px1.p1.8.m1.1.2.2.2" xref="S3.SS3.SSS0.Px1.p1.8.m1.1.2.2.2.cmml">H</mi><mo id="S3.SS3.SSS0.Px1.p1.8.m1.1.2.2.1" xref="S3.SS3.SSS0.Px1.p1.8.m1.1.2.2.1.cmml">^</mo></mover><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.8.m1.1.2.1" xref="S3.SS3.SSS0.Px1.p1.8.m1.1.2.1.cmml">​</mo><mrow id="S3.SS3.SSS0.Px1.p1.8.m1.1.2.3.2" xref="S3.SS3.SSS0.Px1.p1.8.m1.1.2.3.1.cmml"><mo stretchy="false" id="S3.SS3.SSS0.Px1.p1.8.m1.1.2.3.2.1" xref="S3.SS3.SSS0.Px1.p1.8.m1.1.2.3.1.1.cmml">[</mo><mi id="S3.SS3.SSS0.Px1.p1.8.m1.1.1" xref="S3.SS3.SSS0.Px1.p1.8.m1.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS3.SSS0.Px1.p1.8.m1.1.2.3.2.2" xref="S3.SS3.SSS0.Px1.p1.8.m1.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.8.m1.1b"><apply id="S3.SS3.SSS0.Px1.p1.8.m1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m1.1.2"><times id="S3.SS3.SSS0.Px1.p1.8.m1.1.2.1.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m1.1.2.1"></times><apply id="S3.SS3.SSS0.Px1.p1.8.m1.1.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m1.1.2.2"><ci id="S3.SS3.SSS0.Px1.p1.8.m1.1.2.2.1.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m1.1.2.2.1">^</ci><ci id="S3.SS3.SSS0.Px1.p1.8.m1.1.2.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m1.1.2.2.2">𝐻</ci></apply><apply id="S3.SS3.SSS0.Px1.p1.8.m1.1.2.3.1.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m1.1.2.3.2"><csymbol cd="latexml" id="S3.SS3.SSS0.Px1.p1.8.m1.1.2.3.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m1.1.2.3.2.1">delimited-[]</csymbol><ci id="S3.SS3.SSS0.Px1.p1.8.m1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m1.1.1">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.8.m1.1c">\hat{H}[i]</annotation></semantics></math> is the <math id="S3.SS3.SSS0.Px1.p1.9.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.9.m2.1a"><mi id="S3.SS3.SSS0.Px1.p1.9.m2.1.1" xref="S3.SS3.SSS0.Px1.p1.9.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.9.m2.1b"><ci id="S3.SS3.SSS0.Px1.p1.9.m2.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.9.m2.1c">i</annotation></semantics></math>-th pixel in <math id="S3.SS3.SSS0.Px1.p1.10.m3.1" class="ltx_Math" alttext="\hat{H}" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.10.m3.1a"><mover accent="true" id="S3.SS3.SSS0.Px1.p1.10.m3.1.1" xref="S3.SS3.SSS0.Px1.p1.10.m3.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p1.10.m3.1.1.2" xref="S3.SS3.SSS0.Px1.p1.10.m3.1.1.2.cmml">H</mi><mo id="S3.SS3.SSS0.Px1.p1.10.m3.1.1.1" xref="S3.SS3.SSS0.Px1.p1.10.m3.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.10.m3.1b"><apply id="S3.SS3.SSS0.Px1.p1.10.m3.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.10.m3.1.1"><ci id="S3.SS3.SSS0.Px1.p1.10.m3.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.10.m3.1.1.1">^</ci><ci id="S3.SS3.SSS0.Px1.p1.10.m3.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.10.m3.1.1.2">𝐻</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.10.m3.1c">\hat{H}</annotation></semantics></math>, and <math id="S3.SS3.SSS0.Px1.p1.11.m4.1" class="ltx_Math" alttext="p_{i}" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.11.m4.1a"><msub id="S3.SS3.SSS0.Px1.p1.11.m4.1.1" xref="S3.SS3.SSS0.Px1.p1.11.m4.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p1.11.m4.1.1.2" xref="S3.SS3.SSS0.Px1.p1.11.m4.1.1.2.cmml">p</mi><mi id="S3.SS3.SSS0.Px1.p1.11.m4.1.1.3" xref="S3.SS3.SSS0.Px1.p1.11.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.11.m4.1b"><apply id="S3.SS3.SSS0.Px1.p1.11.m4.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.11.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.11.m4.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.11.m4.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.11.m4.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.11.m4.1.1.2">𝑝</ci><ci id="S3.SS3.SSS0.Px1.p1.11.m4.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.11.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.11.m4.1c">p_{i}</annotation></semantics></math> is the center coordinate of the <math id="S3.SS3.SSS0.Px1.p1.12.m5.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.12.m5.1a"><mi id="S3.SS3.SSS0.Px1.p1.12.m5.1.1" xref="S3.SS3.SSS0.Px1.p1.12.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.12.m5.1b"><ci id="S3.SS3.SSS0.Px1.p1.12.m5.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.12.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.12.m5.1c">i</annotation></semantics></math>-th pixel. Then, the branch can be optimized with a focal loss <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>:</p>
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.3" class="ltx_Math" alttext="\mathcal{L}_{fg}=\frac{1}{N_{pos}}\sum^{R\times A}_{i=1}-\alpha(1-\tilde{H}[i])^{\gamma}log(\tilde{H}[i])," display="block"><semantics id="S3.E6.m1.3a"><mrow id="S3.E6.m1.3.3.1" xref="S3.E6.m1.3.3.1.1.cmml"><mrow id="S3.E6.m1.3.3.1.1" xref="S3.E6.m1.3.3.1.1.cmml"><msub id="S3.E6.m1.3.3.1.1.4" xref="S3.E6.m1.3.3.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.3.3.1.1.4.2" xref="S3.E6.m1.3.3.1.1.4.2.cmml">ℒ</mi><mrow id="S3.E6.m1.3.3.1.1.4.3" xref="S3.E6.m1.3.3.1.1.4.3.cmml"><mi id="S3.E6.m1.3.3.1.1.4.3.2" xref="S3.E6.m1.3.3.1.1.4.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.1.1.4.3.1" xref="S3.E6.m1.3.3.1.1.4.3.1.cmml">​</mo><mi id="S3.E6.m1.3.3.1.1.4.3.3" xref="S3.E6.m1.3.3.1.1.4.3.3.cmml">g</mi></mrow></msub><mo id="S3.E6.m1.3.3.1.1.3" xref="S3.E6.m1.3.3.1.1.3.cmml">=</mo><mrow id="S3.E6.m1.3.3.1.1.2" xref="S3.E6.m1.3.3.1.1.2.cmml"><mrow id="S3.E6.m1.3.3.1.1.2.4" xref="S3.E6.m1.3.3.1.1.2.4.cmml"><mfrac id="S3.E6.m1.3.3.1.1.2.4.2" xref="S3.E6.m1.3.3.1.1.2.4.2.cmml"><mn id="S3.E6.m1.3.3.1.1.2.4.2.2" xref="S3.E6.m1.3.3.1.1.2.4.2.2.cmml">1</mn><msub id="S3.E6.m1.3.3.1.1.2.4.2.3" xref="S3.E6.m1.3.3.1.1.2.4.2.3.cmml"><mi id="S3.E6.m1.3.3.1.1.2.4.2.3.2" xref="S3.E6.m1.3.3.1.1.2.4.2.3.2.cmml">N</mi><mrow id="S3.E6.m1.3.3.1.1.2.4.2.3.3" xref="S3.E6.m1.3.3.1.1.2.4.2.3.3.cmml"><mi id="S3.E6.m1.3.3.1.1.2.4.2.3.3.2" xref="S3.E6.m1.3.3.1.1.2.4.2.3.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.1.1.2.4.2.3.3.1" xref="S3.E6.m1.3.3.1.1.2.4.2.3.3.1.cmml">​</mo><mi id="S3.E6.m1.3.3.1.1.2.4.2.3.3.3" xref="S3.E6.m1.3.3.1.1.2.4.2.3.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.1.1.2.4.2.3.3.1a" xref="S3.E6.m1.3.3.1.1.2.4.2.3.3.1.cmml">​</mo><mi id="S3.E6.m1.3.3.1.1.2.4.2.3.3.4" xref="S3.E6.m1.3.3.1.1.2.4.2.3.3.4.cmml">s</mi></mrow></msub></mfrac><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.1.1.2.4.1" xref="S3.E6.m1.3.3.1.1.2.4.1.cmml">​</mo><munderover id="S3.E6.m1.3.3.1.1.2.4.3" xref="S3.E6.m1.3.3.1.1.2.4.3.cmml"><mo movablelimits="false" rspace="0em" id="S3.E6.m1.3.3.1.1.2.4.3.2.2" xref="S3.E6.m1.3.3.1.1.2.4.3.2.2.cmml">∑</mo><mrow id="S3.E6.m1.3.3.1.1.2.4.3.3" xref="S3.E6.m1.3.3.1.1.2.4.3.3.cmml"><mi id="S3.E6.m1.3.3.1.1.2.4.3.3.2" xref="S3.E6.m1.3.3.1.1.2.4.3.3.2.cmml">i</mi><mo id="S3.E6.m1.3.3.1.1.2.4.3.3.1" xref="S3.E6.m1.3.3.1.1.2.4.3.3.1.cmml">=</mo><mn id="S3.E6.m1.3.3.1.1.2.4.3.3.3" xref="S3.E6.m1.3.3.1.1.2.4.3.3.3.cmml">1</mn></mrow><mrow id="S3.E6.m1.3.3.1.1.2.4.3.2.3" xref="S3.E6.m1.3.3.1.1.2.4.3.2.3.cmml"><mi id="S3.E6.m1.3.3.1.1.2.4.3.2.3.2" xref="S3.E6.m1.3.3.1.1.2.4.3.2.3.2.cmml">R</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E6.m1.3.3.1.1.2.4.3.2.3.1" xref="S3.E6.m1.3.3.1.1.2.4.3.2.3.1.cmml">×</mo><mi id="S3.E6.m1.3.3.1.1.2.4.3.2.3.3" xref="S3.E6.m1.3.3.1.1.2.4.3.2.3.3.cmml">A</mi></mrow></munderover></mrow><mo lspace="0em" id="S3.E6.m1.3.3.1.1.2.3" xref="S3.E6.m1.3.3.1.1.2.3.cmml">−</mo><mrow id="S3.E6.m1.3.3.1.1.2.2" xref="S3.E6.m1.3.3.1.1.2.2.cmml"><mi id="S3.E6.m1.3.3.1.1.2.2.4" xref="S3.E6.m1.3.3.1.1.2.2.4.cmml">α</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.1.1.2.2.3" xref="S3.E6.m1.3.3.1.1.2.2.3.cmml">​</mo><msup id="S3.E6.m1.3.3.1.1.1.1.1" xref="S3.E6.m1.3.3.1.1.1.1.1.cmml"><mrow id="S3.E6.m1.3.3.1.1.1.1.1.1.1" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mn id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.3.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.3.2.2.cmml">H</mi><mo id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.3.2.1" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.3.2.1.cmml">~</mo></mover><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.3.1" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mrow id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.3.3.1.cmml"><mo stretchy="false" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.3.3.2.1" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.3.3.1.1.cmml">[</mo><mi id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml">i</mi><mo stretchy="false" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.3.3.2.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.3.3.1.1.cmml">]</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.E6.m1.3.3.1.1.1.1.1.3" xref="S3.E6.m1.3.3.1.1.1.1.1.3.cmml">γ</mi></msup><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.1.1.2.2.3a" xref="S3.E6.m1.3.3.1.1.2.2.3.cmml">​</mo><mi id="S3.E6.m1.3.3.1.1.2.2.5" xref="S3.E6.m1.3.3.1.1.2.2.5.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.1.1.2.2.3b" xref="S3.E6.m1.3.3.1.1.2.2.3.cmml">​</mo><mi id="S3.E6.m1.3.3.1.1.2.2.6" xref="S3.E6.m1.3.3.1.1.2.2.6.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.1.1.2.2.3c" xref="S3.E6.m1.3.3.1.1.2.2.3.cmml">​</mo><mi id="S3.E6.m1.3.3.1.1.2.2.7" xref="S3.E6.m1.3.3.1.1.2.2.7.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.1.1.2.2.3d" xref="S3.E6.m1.3.3.1.1.2.2.3.cmml">​</mo><mrow id="S3.E6.m1.3.3.1.1.2.2.2.1" xref="S3.E6.m1.3.3.1.1.2.2.2.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.3.3.1.1.2.2.2.1.2" xref="S3.E6.m1.3.3.1.1.2.2.2.1.1.cmml">(</mo><mrow id="S3.E6.m1.3.3.1.1.2.2.2.1.1" xref="S3.E6.m1.3.3.1.1.2.2.2.1.1.cmml"><mover accent="true" id="S3.E6.m1.3.3.1.1.2.2.2.1.1.2" xref="S3.E6.m1.3.3.1.1.2.2.2.1.1.2.cmml"><mi id="S3.E6.m1.3.3.1.1.2.2.2.1.1.2.2" xref="S3.E6.m1.3.3.1.1.2.2.2.1.1.2.2.cmml">H</mi><mo id="S3.E6.m1.3.3.1.1.2.2.2.1.1.2.1" xref="S3.E6.m1.3.3.1.1.2.2.2.1.1.2.1.cmml">~</mo></mover><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.1.1.2.2.2.1.1.1" xref="S3.E6.m1.3.3.1.1.2.2.2.1.1.1.cmml">​</mo><mrow id="S3.E6.m1.3.3.1.1.2.2.2.1.1.3.2" xref="S3.E6.m1.3.3.1.1.2.2.2.1.1.3.1.cmml"><mo stretchy="false" id="S3.E6.m1.3.3.1.1.2.2.2.1.1.3.2.1" xref="S3.E6.m1.3.3.1.1.2.2.2.1.1.3.1.1.cmml">[</mo><mi id="S3.E6.m1.2.2" xref="S3.E6.m1.2.2.cmml">i</mi><mo stretchy="false" id="S3.E6.m1.3.3.1.1.2.2.2.1.1.3.2.2" xref="S3.E6.m1.3.3.1.1.2.2.2.1.1.3.1.1.cmml">]</mo></mrow></mrow><mo stretchy="false" id="S3.E6.m1.3.3.1.1.2.2.2.1.3" xref="S3.E6.m1.3.3.1.1.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E6.m1.3.3.1.2" xref="S3.E6.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.3b"><apply id="S3.E6.m1.3.3.1.1.cmml" xref="S3.E6.m1.3.3.1"><eq id="S3.E6.m1.3.3.1.1.3.cmml" xref="S3.E6.m1.3.3.1.1.3"></eq><apply id="S3.E6.m1.3.3.1.1.4.cmml" xref="S3.E6.m1.3.3.1.1.4"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.4.1.cmml" xref="S3.E6.m1.3.3.1.1.4">subscript</csymbol><ci id="S3.E6.m1.3.3.1.1.4.2.cmml" xref="S3.E6.m1.3.3.1.1.4.2">ℒ</ci><apply id="S3.E6.m1.3.3.1.1.4.3.cmml" xref="S3.E6.m1.3.3.1.1.4.3"><times id="S3.E6.m1.3.3.1.1.4.3.1.cmml" xref="S3.E6.m1.3.3.1.1.4.3.1"></times><ci id="S3.E6.m1.3.3.1.1.4.3.2.cmml" xref="S3.E6.m1.3.3.1.1.4.3.2">𝑓</ci><ci id="S3.E6.m1.3.3.1.1.4.3.3.cmml" xref="S3.E6.m1.3.3.1.1.4.3.3">𝑔</ci></apply></apply><apply id="S3.E6.m1.3.3.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.2"><minus id="S3.E6.m1.3.3.1.1.2.3.cmml" xref="S3.E6.m1.3.3.1.1.2.3"></minus><apply id="S3.E6.m1.3.3.1.1.2.4.cmml" xref="S3.E6.m1.3.3.1.1.2.4"><times id="S3.E6.m1.3.3.1.1.2.4.1.cmml" xref="S3.E6.m1.3.3.1.1.2.4.1"></times><apply id="S3.E6.m1.3.3.1.1.2.4.2.cmml" xref="S3.E6.m1.3.3.1.1.2.4.2"><divide id="S3.E6.m1.3.3.1.1.2.4.2.1.cmml" xref="S3.E6.m1.3.3.1.1.2.4.2"></divide><cn type="integer" id="S3.E6.m1.3.3.1.1.2.4.2.2.cmml" xref="S3.E6.m1.3.3.1.1.2.4.2.2">1</cn><apply id="S3.E6.m1.3.3.1.1.2.4.2.3.cmml" xref="S3.E6.m1.3.3.1.1.2.4.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.2.4.2.3.1.cmml" xref="S3.E6.m1.3.3.1.1.2.4.2.3">subscript</csymbol><ci id="S3.E6.m1.3.3.1.1.2.4.2.3.2.cmml" xref="S3.E6.m1.3.3.1.1.2.4.2.3.2">𝑁</ci><apply id="S3.E6.m1.3.3.1.1.2.4.2.3.3.cmml" xref="S3.E6.m1.3.3.1.1.2.4.2.3.3"><times id="S3.E6.m1.3.3.1.1.2.4.2.3.3.1.cmml" xref="S3.E6.m1.3.3.1.1.2.4.2.3.3.1"></times><ci id="S3.E6.m1.3.3.1.1.2.4.2.3.3.2.cmml" xref="S3.E6.m1.3.3.1.1.2.4.2.3.3.2">𝑝</ci><ci id="S3.E6.m1.3.3.1.1.2.4.2.3.3.3.cmml" xref="S3.E6.m1.3.3.1.1.2.4.2.3.3.3">𝑜</ci><ci id="S3.E6.m1.3.3.1.1.2.4.2.3.3.4.cmml" xref="S3.E6.m1.3.3.1.1.2.4.2.3.3.4">𝑠</ci></apply></apply></apply><apply id="S3.E6.m1.3.3.1.1.2.4.3.cmml" xref="S3.E6.m1.3.3.1.1.2.4.3"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.2.4.3.1.cmml" xref="S3.E6.m1.3.3.1.1.2.4.3">subscript</csymbol><apply id="S3.E6.m1.3.3.1.1.2.4.3.2.cmml" xref="S3.E6.m1.3.3.1.1.2.4.3"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.2.4.3.2.1.cmml" xref="S3.E6.m1.3.3.1.1.2.4.3">superscript</csymbol><sum id="S3.E6.m1.3.3.1.1.2.4.3.2.2.cmml" xref="S3.E6.m1.3.3.1.1.2.4.3.2.2"></sum><apply id="S3.E6.m1.3.3.1.1.2.4.3.2.3.cmml" xref="S3.E6.m1.3.3.1.1.2.4.3.2.3"><times id="S3.E6.m1.3.3.1.1.2.4.3.2.3.1.cmml" xref="S3.E6.m1.3.3.1.1.2.4.3.2.3.1"></times><ci id="S3.E6.m1.3.3.1.1.2.4.3.2.3.2.cmml" xref="S3.E6.m1.3.3.1.1.2.4.3.2.3.2">𝑅</ci><ci id="S3.E6.m1.3.3.1.1.2.4.3.2.3.3.cmml" xref="S3.E6.m1.3.3.1.1.2.4.3.2.3.3">𝐴</ci></apply></apply><apply id="S3.E6.m1.3.3.1.1.2.4.3.3.cmml" xref="S3.E6.m1.3.3.1.1.2.4.3.3"><eq id="S3.E6.m1.3.3.1.1.2.4.3.3.1.cmml" xref="S3.E6.m1.3.3.1.1.2.4.3.3.1"></eq><ci id="S3.E6.m1.3.3.1.1.2.4.3.3.2.cmml" xref="S3.E6.m1.3.3.1.1.2.4.3.3.2">𝑖</ci><cn type="integer" id="S3.E6.m1.3.3.1.1.2.4.3.3.3.cmml" xref="S3.E6.m1.3.3.1.1.2.4.3.3.3">1</cn></apply></apply></apply><apply id="S3.E6.m1.3.3.1.1.2.2.cmml" xref="S3.E6.m1.3.3.1.1.2.2"><times id="S3.E6.m1.3.3.1.1.2.2.3.cmml" xref="S3.E6.m1.3.3.1.1.2.2.3"></times><ci id="S3.E6.m1.3.3.1.1.2.2.4.cmml" xref="S3.E6.m1.3.3.1.1.2.2.4">𝛼</ci><apply id="S3.E6.m1.3.3.1.1.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1">superscript</csymbol><apply id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1"><minus id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.2">1</cn><apply id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.3"><times id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.3.1"></times><apply id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.3.2"><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.3.2.1">~</ci><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.3.2.2">𝐻</ci></apply><apply id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.3.3.2"><csymbol cd="latexml" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.3.3.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.3.3.2.1">delimited-[]</csymbol><ci id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1">𝑖</ci></apply></apply></apply><ci id="S3.E6.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.3">𝛾</ci></apply><ci id="S3.E6.m1.3.3.1.1.2.2.5.cmml" xref="S3.E6.m1.3.3.1.1.2.2.5">𝑙</ci><ci id="S3.E6.m1.3.3.1.1.2.2.6.cmml" xref="S3.E6.m1.3.3.1.1.2.2.6">𝑜</ci><ci id="S3.E6.m1.3.3.1.1.2.2.7.cmml" xref="S3.E6.m1.3.3.1.1.2.2.7">𝑔</ci><apply id="S3.E6.m1.3.3.1.1.2.2.2.1.1.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2.1"><times id="S3.E6.m1.3.3.1.1.2.2.2.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2.1.1.1"></times><apply id="S3.E6.m1.3.3.1.1.2.2.2.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2.1.1.2"><ci id="S3.E6.m1.3.3.1.1.2.2.2.1.1.2.1.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2.1.1.2.1">~</ci><ci id="S3.E6.m1.3.3.1.1.2.2.2.1.1.2.2.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2.1.1.2.2">𝐻</ci></apply><apply id="S3.E6.m1.3.3.1.1.2.2.2.1.1.3.1.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2.1.1.3.2"><csymbol cd="latexml" id="S3.E6.m1.3.3.1.1.2.2.2.1.1.3.1.1.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2.1.1.3.2.1">delimited-[]</csymbol><ci id="S3.E6.m1.2.2.cmml" xref="S3.E6.m1.2.2">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.3c">\mathcal{L}_{fg}=\frac{1}{N_{pos}}\sum^{R\times A}_{i=1}-\alpha(1-\tilde{H}[i])^{\gamma}log(\tilde{H}[i]),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.SSS0.Px1.p1.13" class="ltx_p">where</p>
<table id="S3.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E7.m1.6" class="ltx_Math" alttext="\tilde{H}[i]=\begin{cases}H[i]&amp;\text{if }\hat{H}[i]=1\\
1-H[i]&amp;\text{otherwise}\end{cases}." display="block"><semantics id="S3.E7.m1.6a"><mrow id="S3.E7.m1.6.6.1" xref="S3.E7.m1.6.6.1.1.cmml"><mrow id="S3.E7.m1.6.6.1.1" xref="S3.E7.m1.6.6.1.1.cmml"><mrow id="S3.E7.m1.6.6.1.1.2" xref="S3.E7.m1.6.6.1.1.2.cmml"><mover accent="true" id="S3.E7.m1.6.6.1.1.2.2" xref="S3.E7.m1.6.6.1.1.2.2.cmml"><mi id="S3.E7.m1.6.6.1.1.2.2.2" xref="S3.E7.m1.6.6.1.1.2.2.2.cmml">H</mi><mo id="S3.E7.m1.6.6.1.1.2.2.1" xref="S3.E7.m1.6.6.1.1.2.2.1.cmml">~</mo></mover><mo lspace="0em" rspace="0em" id="S3.E7.m1.6.6.1.1.2.1" xref="S3.E7.m1.6.6.1.1.2.1.cmml">​</mo><mrow id="S3.E7.m1.6.6.1.1.2.3.2" xref="S3.E7.m1.6.6.1.1.2.3.1.cmml"><mo stretchy="false" id="S3.E7.m1.6.6.1.1.2.3.2.1" xref="S3.E7.m1.6.6.1.1.2.3.1.1.cmml">[</mo><mi id="S3.E7.m1.5.5" xref="S3.E7.m1.5.5.cmml">i</mi><mo stretchy="false" id="S3.E7.m1.6.6.1.1.2.3.2.2" xref="S3.E7.m1.6.6.1.1.2.3.1.1.cmml">]</mo></mrow></mrow><mo id="S3.E7.m1.6.6.1.1.1" xref="S3.E7.m1.6.6.1.1.1.cmml">=</mo><mrow id="S3.E7.m1.4.4" xref="S3.E7.m1.6.6.1.1.3.1.cmml"><mo id="S3.E7.m1.4.4.5" xref="S3.E7.m1.6.6.1.1.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt" id="S3.E7.m1.4.4.4" xref="S3.E7.m1.6.6.1.1.3.1.cmml"><mtr id="S3.E7.m1.4.4.4a" xref="S3.E7.m1.6.6.1.1.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E7.m1.4.4.4b" xref="S3.E7.m1.6.6.1.1.3.1.cmml"><mrow id="S3.E7.m1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.3.cmml">H</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E7.m1.1.1.1.1.1.1.4.2" xref="S3.E7.m1.1.1.1.1.1.1.4.1.cmml"><mo stretchy="false" id="S3.E7.m1.1.1.1.1.1.1.4.2.1" xref="S3.E7.m1.1.1.1.1.1.1.4.1.1.cmml">[</mo><mi id="S3.E7.m1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.E7.m1.1.1.1.1.1.1.4.2.2" xref="S3.E7.m1.1.1.1.1.1.1.4.1.1.cmml">]</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E7.m1.4.4.4c" xref="S3.E7.m1.6.6.1.1.3.1.cmml"><mrow id="S3.E7.m1.2.2.2.2.2.1" xref="S3.E7.m1.2.2.2.2.2.1.cmml"><mrow id="S3.E7.m1.2.2.2.2.2.1.3" xref="S3.E7.m1.2.2.2.2.2.1.3.cmml"><mtext id="S3.E7.m1.2.2.2.2.2.1.3.2" xref="S3.E7.m1.2.2.2.2.2.1.3.2a.cmml">if </mtext><mo lspace="0em" rspace="0em" id="S3.E7.m1.2.2.2.2.2.1.3.1" xref="S3.E7.m1.2.2.2.2.2.1.3.1.cmml">​</mo><mover accent="true" id="S3.E7.m1.2.2.2.2.2.1.3.3" xref="S3.E7.m1.2.2.2.2.2.1.3.3.cmml"><mi id="S3.E7.m1.2.2.2.2.2.1.3.3.2" xref="S3.E7.m1.2.2.2.2.2.1.3.3.2.cmml">H</mi><mo id="S3.E7.m1.2.2.2.2.2.1.3.3.1" xref="S3.E7.m1.2.2.2.2.2.1.3.3.1.cmml">^</mo></mover><mo lspace="0em" rspace="0em" id="S3.E7.m1.2.2.2.2.2.1.3.1a" xref="S3.E7.m1.2.2.2.2.2.1.3.1.cmml">​</mo><mrow id="S3.E7.m1.2.2.2.2.2.1.3.4.2" xref="S3.E7.m1.2.2.2.2.2.1.3.4.1.cmml"><mo stretchy="false" id="S3.E7.m1.2.2.2.2.2.1.3.4.2.1" xref="S3.E7.m1.2.2.2.2.2.1.3.4.1.1.cmml">[</mo><mi id="S3.E7.m1.2.2.2.2.2.1.1" xref="S3.E7.m1.2.2.2.2.2.1.1.cmml">i</mi><mo stretchy="false" id="S3.E7.m1.2.2.2.2.2.1.3.4.2.2" xref="S3.E7.m1.2.2.2.2.2.1.3.4.1.1.cmml">]</mo></mrow></mrow><mo id="S3.E7.m1.2.2.2.2.2.1.2" xref="S3.E7.m1.2.2.2.2.2.1.2.cmml">=</mo><mn id="S3.E7.m1.2.2.2.2.2.1.4" xref="S3.E7.m1.2.2.2.2.2.1.4.cmml">1</mn></mrow></mtd></mtr><mtr id="S3.E7.m1.4.4.4d" xref="S3.E7.m1.6.6.1.1.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E7.m1.4.4.4e" xref="S3.E7.m1.6.6.1.1.3.1.cmml"><mrow id="S3.E7.m1.3.3.3.3.1.1" xref="S3.E7.m1.3.3.3.3.1.1.cmml"><mn id="S3.E7.m1.3.3.3.3.1.1.3" xref="S3.E7.m1.3.3.3.3.1.1.3.cmml">1</mn><mo id="S3.E7.m1.3.3.3.3.1.1.2" xref="S3.E7.m1.3.3.3.3.1.1.2.cmml">−</mo><mrow id="S3.E7.m1.3.3.3.3.1.1.4" xref="S3.E7.m1.3.3.3.3.1.1.4.cmml"><mi id="S3.E7.m1.3.3.3.3.1.1.4.2" xref="S3.E7.m1.3.3.3.3.1.1.4.2.cmml">H</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.3.3.3.3.1.1.4.1" xref="S3.E7.m1.3.3.3.3.1.1.4.1.cmml">​</mo><mrow id="S3.E7.m1.3.3.3.3.1.1.4.3.2" xref="S3.E7.m1.3.3.3.3.1.1.4.3.1.cmml"><mo stretchy="false" id="S3.E7.m1.3.3.3.3.1.1.4.3.2.1" xref="S3.E7.m1.3.3.3.3.1.1.4.3.1.1.cmml">[</mo><mi id="S3.E7.m1.3.3.3.3.1.1.1" xref="S3.E7.m1.3.3.3.3.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.E7.m1.3.3.3.3.1.1.4.3.2.2" xref="S3.E7.m1.3.3.3.3.1.1.4.3.1.1.cmml">]</mo></mrow></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E7.m1.4.4.4f" xref="S3.E7.m1.6.6.1.1.3.1.cmml"><mtext id="S3.E7.m1.4.4.4.4.2.1" xref="S3.E7.m1.4.4.4.4.2.1a.cmml">otherwise</mtext></mtd></mtr></mtable></mrow></mrow><mo lspace="0em" id="S3.E7.m1.6.6.1.2" xref="S3.E7.m1.6.6.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.6b"><apply id="S3.E7.m1.6.6.1.1.cmml" xref="S3.E7.m1.6.6.1"><eq id="S3.E7.m1.6.6.1.1.1.cmml" xref="S3.E7.m1.6.6.1.1.1"></eq><apply id="S3.E7.m1.6.6.1.1.2.cmml" xref="S3.E7.m1.6.6.1.1.2"><times id="S3.E7.m1.6.6.1.1.2.1.cmml" xref="S3.E7.m1.6.6.1.1.2.1"></times><apply id="S3.E7.m1.6.6.1.1.2.2.cmml" xref="S3.E7.m1.6.6.1.1.2.2"><ci id="S3.E7.m1.6.6.1.1.2.2.1.cmml" xref="S3.E7.m1.6.6.1.1.2.2.1">~</ci><ci id="S3.E7.m1.6.6.1.1.2.2.2.cmml" xref="S3.E7.m1.6.6.1.1.2.2.2">𝐻</ci></apply><apply id="S3.E7.m1.6.6.1.1.2.3.1.cmml" xref="S3.E7.m1.6.6.1.1.2.3.2"><csymbol cd="latexml" id="S3.E7.m1.6.6.1.1.2.3.1.1.cmml" xref="S3.E7.m1.6.6.1.1.2.3.2.1">delimited-[]</csymbol><ci id="S3.E7.m1.5.5.cmml" xref="S3.E7.m1.5.5">𝑖</ci></apply></apply><apply id="S3.E7.m1.6.6.1.1.3.1.cmml" xref="S3.E7.m1.4.4"><csymbol cd="latexml" id="S3.E7.m1.6.6.1.1.3.1.1.cmml" xref="S3.E7.m1.4.4.5">cases</csymbol><apply id="S3.E7.m1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1"><times id="S3.E7.m1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.2"></times><ci id="S3.E7.m1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.3">𝐻</ci><apply id="S3.E7.m1.1.1.1.1.1.1.4.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.4.2"><csymbol cd="latexml" id="S3.E7.m1.1.1.1.1.1.1.4.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.4.2.1">delimited-[]</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1">𝑖</ci></apply></apply><apply id="S3.E7.m1.2.2.2.2.2.1.cmml" xref="S3.E7.m1.2.2.2.2.2.1"><eq id="S3.E7.m1.2.2.2.2.2.1.2.cmml" xref="S3.E7.m1.2.2.2.2.2.1.2"></eq><apply id="S3.E7.m1.2.2.2.2.2.1.3.cmml" xref="S3.E7.m1.2.2.2.2.2.1.3"><times id="S3.E7.m1.2.2.2.2.2.1.3.1.cmml" xref="S3.E7.m1.2.2.2.2.2.1.3.1"></times><ci id="S3.E7.m1.2.2.2.2.2.1.3.2a.cmml" xref="S3.E7.m1.2.2.2.2.2.1.3.2"><mtext id="S3.E7.m1.2.2.2.2.2.1.3.2.cmml" xref="S3.E7.m1.2.2.2.2.2.1.3.2">if </mtext></ci><apply id="S3.E7.m1.2.2.2.2.2.1.3.3.cmml" xref="S3.E7.m1.2.2.2.2.2.1.3.3"><ci id="S3.E7.m1.2.2.2.2.2.1.3.3.1.cmml" xref="S3.E7.m1.2.2.2.2.2.1.3.3.1">^</ci><ci id="S3.E7.m1.2.2.2.2.2.1.3.3.2.cmml" xref="S3.E7.m1.2.2.2.2.2.1.3.3.2">𝐻</ci></apply><apply id="S3.E7.m1.2.2.2.2.2.1.3.4.1.cmml" xref="S3.E7.m1.2.2.2.2.2.1.3.4.2"><csymbol cd="latexml" id="S3.E7.m1.2.2.2.2.2.1.3.4.1.1.cmml" xref="S3.E7.m1.2.2.2.2.2.1.3.4.2.1">delimited-[]</csymbol><ci id="S3.E7.m1.2.2.2.2.2.1.1.cmml" xref="S3.E7.m1.2.2.2.2.2.1.1">𝑖</ci></apply></apply><cn type="integer" id="S3.E7.m1.2.2.2.2.2.1.4.cmml" xref="S3.E7.m1.2.2.2.2.2.1.4">1</cn></apply><apply id="S3.E7.m1.3.3.3.3.1.1.cmml" xref="S3.E7.m1.3.3.3.3.1.1"><minus id="S3.E7.m1.3.3.3.3.1.1.2.cmml" xref="S3.E7.m1.3.3.3.3.1.1.2"></minus><cn type="integer" id="S3.E7.m1.3.3.3.3.1.1.3.cmml" xref="S3.E7.m1.3.3.3.3.1.1.3">1</cn><apply id="S3.E7.m1.3.3.3.3.1.1.4.cmml" xref="S3.E7.m1.3.3.3.3.1.1.4"><times id="S3.E7.m1.3.3.3.3.1.1.4.1.cmml" xref="S3.E7.m1.3.3.3.3.1.1.4.1"></times><ci id="S3.E7.m1.3.3.3.3.1.1.4.2.cmml" xref="S3.E7.m1.3.3.3.3.1.1.4.2">𝐻</ci><apply id="S3.E7.m1.3.3.3.3.1.1.4.3.1.cmml" xref="S3.E7.m1.3.3.3.3.1.1.4.3.2"><csymbol cd="latexml" id="S3.E7.m1.3.3.3.3.1.1.4.3.1.1.cmml" xref="S3.E7.m1.3.3.3.3.1.1.4.3.2.1">delimited-[]</csymbol><ci id="S3.E7.m1.3.3.3.3.1.1.1.cmml" xref="S3.E7.m1.3.3.3.3.1.1.1">𝑖</ci></apply></apply></apply><ci id="S3.E7.m1.4.4.4.4.2.1a.cmml" xref="S3.E7.m1.4.4.4.4.2.1"><mtext id="S3.E7.m1.4.4.4.4.2.1.cmml" xref="S3.E7.m1.4.4.4.4.2.1">otherwise</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.6c">\tilde{H}[i]=\begin{cases}H[i]&amp;\text{if }\hat{H}[i]=1\\
1-H[i]&amp;\text{otherwise}\end{cases}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS3.SSS0.Px1.p2" class="ltx_para">
<p id="S3.SS3.SSS0.Px1.p2.6" class="ltx_p">The regression branch predicts the relative distance between the foreground pixels and the centers of their corresponding instances.
Let <math id="S3.SS3.SSS0.Px1.p2.1.m1.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S3.SS3.SSS0.Px1.p2.1.m1.1a"><mi id="S3.SS3.SSS0.Px1.p2.1.m1.1.1" xref="S3.SS3.SSS0.Px1.p2.1.m1.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.1.m1.1b"><ci id="S3.SS3.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.1.m1.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.1.m1.1c">D</annotation></semantics></math> and <math id="S3.SS3.SSS0.Px1.p2.2.m2.1" class="ltx_Math" alttext="\hat{D}\in\mathbb{R}^{R\times A\times 4}" display="inline"><semantics id="S3.SS3.SSS0.Px1.p2.2.m2.1a"><mrow id="S3.SS3.SSS0.Px1.p2.2.m2.1.1" xref="S3.SS3.SSS0.Px1.p2.2.m2.1.1.cmml"><mover accent="true" id="S3.SS3.SSS0.Px1.p2.2.m2.1.1.2" xref="S3.SS3.SSS0.Px1.p2.2.m2.1.1.2.cmml"><mi id="S3.SS3.SSS0.Px1.p2.2.m2.1.1.2.2" xref="S3.SS3.SSS0.Px1.p2.2.m2.1.1.2.2.cmml">D</mi><mo id="S3.SS3.SSS0.Px1.p2.2.m2.1.1.2.1" xref="S3.SS3.SSS0.Px1.p2.2.m2.1.1.2.1.cmml">^</mo></mover><mo id="S3.SS3.SSS0.Px1.p2.2.m2.1.1.1" xref="S3.SS3.SSS0.Px1.p2.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS0.Px1.p2.2.m2.1.1.3" xref="S3.SS3.SSS0.Px1.p2.2.m2.1.1.3.cmml"><mi id="S3.SS3.SSS0.Px1.p2.2.m2.1.1.3.2" xref="S3.SS3.SSS0.Px1.p2.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS0.Px1.p2.2.m2.1.1.3.3" xref="S3.SS3.SSS0.Px1.p2.2.m2.1.1.3.3.cmml"><mi id="S3.SS3.SSS0.Px1.p2.2.m2.1.1.3.3.2" xref="S3.SS3.SSS0.Px1.p2.2.m2.1.1.3.3.2.cmml">R</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.SSS0.Px1.p2.2.m2.1.1.3.3.1" xref="S3.SS3.SSS0.Px1.p2.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S3.SS3.SSS0.Px1.p2.2.m2.1.1.3.3.3" xref="S3.SS3.SSS0.Px1.p2.2.m2.1.1.3.3.3.cmml">A</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.SSS0.Px1.p2.2.m2.1.1.3.3.1a" xref="S3.SS3.SSS0.Px1.p2.2.m2.1.1.3.3.1.cmml">×</mo><mn id="S3.SS3.SSS0.Px1.p2.2.m2.1.1.3.3.4" xref="S3.SS3.SSS0.Px1.p2.2.m2.1.1.3.3.4.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.2.m2.1b"><apply id="S3.SS3.SSS0.Px1.p2.2.m2.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.2.m2.1.1"><in id="S3.SS3.SSS0.Px1.p2.2.m2.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.2.m2.1.1.1"></in><apply id="S3.SS3.SSS0.Px1.p2.2.m2.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p2.2.m2.1.1.2"><ci id="S3.SS3.SSS0.Px1.p2.2.m2.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px1.p2.2.m2.1.1.2.1">^</ci><ci id="S3.SS3.SSS0.Px1.p2.2.m2.1.1.2.2.cmml" xref="S3.SS3.SSS0.Px1.p2.2.m2.1.1.2.2">𝐷</ci></apply><apply id="S3.SS3.SSS0.Px1.p2.2.m2.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.2.m2.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px1.p2.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS0.Px1.p2.2.m2.1.1.3.2.cmml" xref="S3.SS3.SSS0.Px1.p2.2.m2.1.1.3.2">ℝ</ci><apply id="S3.SS3.SSS0.Px1.p2.2.m2.1.1.3.3.cmml" xref="S3.SS3.SSS0.Px1.p2.2.m2.1.1.3.3"><times id="S3.SS3.SSS0.Px1.p2.2.m2.1.1.3.3.1.cmml" xref="S3.SS3.SSS0.Px1.p2.2.m2.1.1.3.3.1"></times><ci id="S3.SS3.SSS0.Px1.p2.2.m2.1.1.3.3.2.cmml" xref="S3.SS3.SSS0.Px1.p2.2.m2.1.1.3.3.2">𝑅</ci><ci id="S3.SS3.SSS0.Px1.p2.2.m2.1.1.3.3.3.cmml" xref="S3.SS3.SSS0.Px1.p2.2.m2.1.1.3.3.3">𝐴</ci><cn type="integer" id="S3.SS3.SSS0.Px1.p2.2.m2.1.1.3.3.4.cmml" xref="S3.SS3.SSS0.Px1.p2.2.m2.1.1.3.3.4">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.2.m2.1c">\hat{D}\in\mathbb{R}^{R\times A\times 4}</annotation></semantics></math> denote the predicted regression map and its corresponding target map, and <math id="S3.SS3.SSS0.Px1.p2.3.m3.1" class="ltx_Math" alttext="C_{bev}\in\mathbb{R}^{M\times 4}" display="inline"><semantics id="S3.SS3.SSS0.Px1.p2.3.m3.1a"><mrow id="S3.SS3.SSS0.Px1.p2.3.m3.1.1" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1.cmml"><msub id="S3.SS3.SSS0.Px1.p2.3.m3.1.1.2" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1.2.cmml"><mi id="S3.SS3.SSS0.Px1.p2.3.m3.1.1.2.2" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1.2.2.cmml">C</mi><mrow id="S3.SS3.SSS0.Px1.p2.3.m3.1.1.2.3" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1.2.3.cmml"><mi id="S3.SS3.SSS0.Px1.p2.3.m3.1.1.2.3.2" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1.2.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p2.3.m3.1.1.2.3.1" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px1.p2.3.m3.1.1.2.3.3" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p2.3.m3.1.1.2.3.1a" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px1.p2.3.m3.1.1.2.3.4" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1.2.3.4.cmml">v</mi></mrow></msub><mo id="S3.SS3.SSS0.Px1.p2.3.m3.1.1.1" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS0.Px1.p2.3.m3.1.1.3" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1.3.cmml"><mi id="S3.SS3.SSS0.Px1.p2.3.m3.1.1.3.2" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS0.Px1.p2.3.m3.1.1.3.3" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1.3.3.cmml"><mi id="S3.SS3.SSS0.Px1.p2.3.m3.1.1.3.3.2" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1.3.3.2.cmml">M</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.SSS0.Px1.p2.3.m3.1.1.3.3.1" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1.3.3.1.cmml">×</mo><mn id="S3.SS3.SSS0.Px1.p2.3.m3.1.1.3.3.3" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1.3.3.3.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.3.m3.1b"><apply id="S3.SS3.SSS0.Px1.p2.3.m3.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1"><in id="S3.SS3.SSS0.Px1.p2.3.m3.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1.1"></in><apply id="S3.SS3.SSS0.Px1.p2.3.m3.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.3.m3.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p2.3.m3.1.1.2.2.cmml" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1.2.2">𝐶</ci><apply id="S3.SS3.SSS0.Px1.p2.3.m3.1.1.2.3.cmml" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1.2.3"><times id="S3.SS3.SSS0.Px1.p2.3.m3.1.1.2.3.1.cmml" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1.2.3.1"></times><ci id="S3.SS3.SSS0.Px1.p2.3.m3.1.1.2.3.2.cmml" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1.2.3.2">𝑏</ci><ci id="S3.SS3.SSS0.Px1.p2.3.m3.1.1.2.3.3.cmml" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1.2.3.3">𝑒</ci><ci id="S3.SS3.SSS0.Px1.p2.3.m3.1.1.2.3.4.cmml" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1.2.3.4">𝑣</ci></apply></apply><apply id="S3.SS3.SSS0.Px1.p2.3.m3.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.3.m3.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS0.Px1.p2.3.m3.1.1.3.2.cmml" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1.3.2">ℝ</ci><apply id="S3.SS3.SSS0.Px1.p2.3.m3.1.1.3.3.cmml" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1.3.3"><times id="S3.SS3.SSS0.Px1.p2.3.m3.1.1.3.3.1.cmml" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1.3.3.1"></times><ci id="S3.SS3.SSS0.Px1.p2.3.m3.1.1.3.3.2.cmml" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1.3.3.2">𝑀</ci><cn type="integer" id="S3.SS3.SSS0.Px1.p2.3.m3.1.1.3.3.3.cmml" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1.3.3.3">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.3.m3.1c">C_{bev}\in\mathbb{R}^{M\times 4}</annotation></semantics></math> denote the centers of the ground-truth objects, where each center is represented by both Cartesian coordinate <math id="S3.SS3.SSS0.Px1.p2.4.m4.2" class="ltx_Math" alttext="(x_{i},y_{i})" display="inline"><semantics id="S3.SS3.SSS0.Px1.p2.4.m4.2a"><mrow id="S3.SS3.SSS0.Px1.p2.4.m4.2.2.2" xref="S3.SS3.SSS0.Px1.p2.4.m4.2.2.3.cmml"><mo stretchy="false" id="S3.SS3.SSS0.Px1.p2.4.m4.2.2.2.3" xref="S3.SS3.SSS0.Px1.p2.4.m4.2.2.3.cmml">(</mo><msub id="S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1" xref="S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1.2" xref="S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1.2.cmml">x</mi><mi id="S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1.3" xref="S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS3.SSS0.Px1.p2.4.m4.2.2.2.4" xref="S3.SS3.SSS0.Px1.p2.4.m4.2.2.3.cmml">,</mo><msub id="S3.SS3.SSS0.Px1.p2.4.m4.2.2.2.2" xref="S3.SS3.SSS0.Px1.p2.4.m4.2.2.2.2.cmml"><mi id="S3.SS3.SSS0.Px1.p2.4.m4.2.2.2.2.2" xref="S3.SS3.SSS0.Px1.p2.4.m4.2.2.2.2.2.cmml">y</mi><mi id="S3.SS3.SSS0.Px1.p2.4.m4.2.2.2.2.3" xref="S3.SS3.SSS0.Px1.p2.4.m4.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS3.SSS0.Px1.p2.4.m4.2.2.2.5" xref="S3.SS3.SSS0.Px1.p2.4.m4.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.4.m4.2b"><interval closure="open" id="S3.SS3.SSS0.Px1.p2.4.m4.2.2.3.cmml" xref="S3.SS3.SSS0.Px1.p2.4.m4.2.2.2"><apply id="S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1.2">𝑥</ci><ci id="S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS3.SSS0.Px1.p2.4.m4.2.2.2.2.cmml" xref="S3.SS3.SSS0.Px1.p2.4.m4.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.4.m4.2.2.2.2.1.cmml" xref="S3.SS3.SSS0.Px1.p2.4.m4.2.2.2.2">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p2.4.m4.2.2.2.2.2.cmml" xref="S3.SS3.SSS0.Px1.p2.4.m4.2.2.2.2.2">𝑦</ci><ci id="S3.SS3.SSS0.Px1.p2.4.m4.2.2.2.2.3.cmml" xref="S3.SS3.SSS0.Px1.p2.4.m4.2.2.2.2.3">𝑖</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.4.m4.2c">(x_{i},y_{i})</annotation></semantics></math> and polar coordinate <math id="S3.SS3.SSS0.Px1.p2.5.m5.2" class="ltx_Math" alttext="(\rho_{i},\phi_{i})" display="inline"><semantics id="S3.SS3.SSS0.Px1.p2.5.m5.2a"><mrow id="S3.SS3.SSS0.Px1.p2.5.m5.2.2.2" xref="S3.SS3.SSS0.Px1.p2.5.m5.2.2.3.cmml"><mo stretchy="false" id="S3.SS3.SSS0.Px1.p2.5.m5.2.2.2.3" xref="S3.SS3.SSS0.Px1.p2.5.m5.2.2.3.cmml">(</mo><msub id="S3.SS3.SSS0.Px1.p2.5.m5.1.1.1.1" xref="S3.SS3.SSS0.Px1.p2.5.m5.1.1.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p2.5.m5.1.1.1.1.2" xref="S3.SS3.SSS0.Px1.p2.5.m5.1.1.1.1.2.cmml">ρ</mi><mi id="S3.SS3.SSS0.Px1.p2.5.m5.1.1.1.1.3" xref="S3.SS3.SSS0.Px1.p2.5.m5.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS3.SSS0.Px1.p2.5.m5.2.2.2.4" xref="S3.SS3.SSS0.Px1.p2.5.m5.2.2.3.cmml">,</mo><msub id="S3.SS3.SSS0.Px1.p2.5.m5.2.2.2.2" xref="S3.SS3.SSS0.Px1.p2.5.m5.2.2.2.2.cmml"><mi id="S3.SS3.SSS0.Px1.p2.5.m5.2.2.2.2.2" xref="S3.SS3.SSS0.Px1.p2.5.m5.2.2.2.2.2.cmml">ϕ</mi><mi id="S3.SS3.SSS0.Px1.p2.5.m5.2.2.2.2.3" xref="S3.SS3.SSS0.Px1.p2.5.m5.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS3.SSS0.Px1.p2.5.m5.2.2.2.5" xref="S3.SS3.SSS0.Px1.p2.5.m5.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.5.m5.2b"><interval closure="open" id="S3.SS3.SSS0.Px1.p2.5.m5.2.2.3.cmml" xref="S3.SS3.SSS0.Px1.p2.5.m5.2.2.2"><apply id="S3.SS3.SSS0.Px1.p2.5.m5.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.5.m5.1.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.5.m5.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p2.5.m5.1.1.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p2.5.m5.1.1.1.1.2">𝜌</ci><ci id="S3.SS3.SSS0.Px1.p2.5.m5.1.1.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p2.5.m5.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS3.SSS0.Px1.p2.5.m5.2.2.2.2.cmml" xref="S3.SS3.SSS0.Px1.p2.5.m5.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.5.m5.2.2.2.2.1.cmml" xref="S3.SS3.SSS0.Px1.p2.5.m5.2.2.2.2">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p2.5.m5.2.2.2.2.2.cmml" xref="S3.SS3.SSS0.Px1.p2.5.m5.2.2.2.2.2">italic-ϕ</ci><ci id="S3.SS3.SSS0.Px1.p2.5.m5.2.2.2.2.3.cmml" xref="S3.SS3.SSS0.Px1.p2.5.m5.2.2.2.2.3">𝑖</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.5.m5.2c">(\rho_{i},\phi_{i})</annotation></semantics></math>.
The target map of <math id="S3.SS3.SSS0.Px1.p2.6.m6.1" class="ltx_Math" alttext="\hat{D}" display="inline"><semantics id="S3.SS3.SSS0.Px1.p2.6.m6.1a"><mover accent="true" id="S3.SS3.SSS0.Px1.p2.6.m6.1.1" xref="S3.SS3.SSS0.Px1.p2.6.m6.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p2.6.m6.1.1.2" xref="S3.SS3.SSS0.Px1.p2.6.m6.1.1.2.cmml">D</mi><mo id="S3.SS3.SSS0.Px1.p2.6.m6.1.1.1" xref="S3.SS3.SSS0.Px1.p2.6.m6.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.6.m6.1b"><apply id="S3.SS3.SSS0.Px1.p2.6.m6.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.6.m6.1.1"><ci id="S3.SS3.SSS0.Px1.p2.6.m6.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.6.m6.1.1.1">^</ci><ci id="S3.SS3.SSS0.Px1.p2.6.m6.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p2.6.m6.1.1.2">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.6.m6.1c">\hat{D}</annotation></semantics></math> can be formulated as:</p>
<table id="S3.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E8.m1.6" class="ltx_Math" alttext="\hat{D}[i]=\begin{cases}C_{bev}[k]&amp;\text{if }p_{i}\text{ is inside }B_{bev}[k]\\
(0,0,0,0)&amp;\text{otherwise}\end{cases}." display="block"><semantics id="S3.E8.m1.6a"><mrow id="S3.E8.m1.6.6.1" xref="S3.E8.m1.6.6.1.1.cmml"><mrow id="S3.E8.m1.6.6.1.1" xref="S3.E8.m1.6.6.1.1.cmml"><mrow id="S3.E8.m1.6.6.1.1.2" xref="S3.E8.m1.6.6.1.1.2.cmml"><mover accent="true" id="S3.E8.m1.6.6.1.1.2.2" xref="S3.E8.m1.6.6.1.1.2.2.cmml"><mi id="S3.E8.m1.6.6.1.1.2.2.2" xref="S3.E8.m1.6.6.1.1.2.2.2.cmml">D</mi><mo id="S3.E8.m1.6.6.1.1.2.2.1" xref="S3.E8.m1.6.6.1.1.2.2.1.cmml">^</mo></mover><mo lspace="0em" rspace="0em" id="S3.E8.m1.6.6.1.1.2.1" xref="S3.E8.m1.6.6.1.1.2.1.cmml">​</mo><mrow id="S3.E8.m1.6.6.1.1.2.3.2" xref="S3.E8.m1.6.6.1.1.2.3.1.cmml"><mo stretchy="false" id="S3.E8.m1.6.6.1.1.2.3.2.1" xref="S3.E8.m1.6.6.1.1.2.3.1.1.cmml">[</mo><mi id="S3.E8.m1.5.5" xref="S3.E8.m1.5.5.cmml">i</mi><mo stretchy="false" id="S3.E8.m1.6.6.1.1.2.3.2.2" xref="S3.E8.m1.6.6.1.1.2.3.1.1.cmml">]</mo></mrow></mrow><mo id="S3.E8.m1.6.6.1.1.1" xref="S3.E8.m1.6.6.1.1.1.cmml">=</mo><mrow id="S3.E8.m1.4.4" xref="S3.E8.m1.6.6.1.1.3.1.cmml"><mo id="S3.E8.m1.4.4.5" xref="S3.E8.m1.6.6.1.1.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt" id="S3.E8.m1.4.4.4" xref="S3.E8.m1.6.6.1.1.3.1.cmml"><mtr id="S3.E8.m1.4.4.4a" xref="S3.E8.m1.6.6.1.1.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E8.m1.4.4.4b" xref="S3.E8.m1.6.6.1.1.3.1.cmml"><mrow id="S3.E8.m1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.cmml"><msub id="S3.E8.m1.1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E8.m1.1.1.1.1.1.1.3.2" xref="S3.E8.m1.1.1.1.1.1.1.3.2.cmml">C</mi><mrow id="S3.E8.m1.1.1.1.1.1.1.3.3" xref="S3.E8.m1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E8.m1.1.1.1.1.1.1.3.3.2" xref="S3.E8.m1.1.1.1.1.1.1.3.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.1.1.1.1.3.3.1" xref="S3.E8.m1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E8.m1.1.1.1.1.1.1.3.3.3" xref="S3.E8.m1.1.1.1.1.1.1.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.1.1.1.1.3.3.1a" xref="S3.E8.m1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E8.m1.1.1.1.1.1.1.3.3.4" xref="S3.E8.m1.1.1.1.1.1.1.3.3.4.cmml">v</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E8.m1.1.1.1.1.1.1.4.2" xref="S3.E8.m1.1.1.1.1.1.1.4.1.cmml"><mo stretchy="false" id="S3.E8.m1.1.1.1.1.1.1.4.2.1" xref="S3.E8.m1.1.1.1.1.1.1.4.1.1.cmml">[</mo><mi id="S3.E8.m1.1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.1.cmml">k</mi><mo stretchy="false" id="S3.E8.m1.1.1.1.1.1.1.4.2.2" xref="S3.E8.m1.1.1.1.1.1.1.4.1.1.cmml">]</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E8.m1.4.4.4c" xref="S3.E8.m1.6.6.1.1.3.1.cmml"><mrow id="S3.E8.m1.2.2.2.2.2.1" xref="S3.E8.m1.2.2.2.2.2.1.cmml"><mtext id="S3.E8.m1.2.2.2.2.2.1.3" xref="S3.E8.m1.2.2.2.2.2.1.3a.cmml">if </mtext><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.2.2.2.1.2" xref="S3.E8.m1.2.2.2.2.2.1.2.cmml">​</mo><msub id="S3.E8.m1.2.2.2.2.2.1.4" xref="S3.E8.m1.2.2.2.2.2.1.4.cmml"><mi id="S3.E8.m1.2.2.2.2.2.1.4.2" xref="S3.E8.m1.2.2.2.2.2.1.4.2.cmml">p</mi><mi id="S3.E8.m1.2.2.2.2.2.1.4.3" xref="S3.E8.m1.2.2.2.2.2.1.4.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.2.2.2.1.2a" xref="S3.E8.m1.2.2.2.2.2.1.2.cmml">​</mo><mtext id="S3.E8.m1.2.2.2.2.2.1.5" xref="S3.E8.m1.2.2.2.2.2.1.5a.cmml"> is inside </mtext><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.2.2.2.1.2b" xref="S3.E8.m1.2.2.2.2.2.1.2.cmml">​</mo><msub id="S3.E8.m1.2.2.2.2.2.1.6" xref="S3.E8.m1.2.2.2.2.2.1.6.cmml"><mi id="S3.E8.m1.2.2.2.2.2.1.6.2" xref="S3.E8.m1.2.2.2.2.2.1.6.2.cmml">B</mi><mrow id="S3.E8.m1.2.2.2.2.2.1.6.3" xref="S3.E8.m1.2.2.2.2.2.1.6.3.cmml"><mi id="S3.E8.m1.2.2.2.2.2.1.6.3.2" xref="S3.E8.m1.2.2.2.2.2.1.6.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.2.2.2.1.6.3.1" xref="S3.E8.m1.2.2.2.2.2.1.6.3.1.cmml">​</mo><mi id="S3.E8.m1.2.2.2.2.2.1.6.3.3" xref="S3.E8.m1.2.2.2.2.2.1.6.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.2.2.2.1.6.3.1a" xref="S3.E8.m1.2.2.2.2.2.1.6.3.1.cmml">​</mo><mi id="S3.E8.m1.2.2.2.2.2.1.6.3.4" xref="S3.E8.m1.2.2.2.2.2.1.6.3.4.cmml">v</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.2.2.2.1.2c" xref="S3.E8.m1.2.2.2.2.2.1.2.cmml">​</mo><mrow id="S3.E8.m1.2.2.2.2.2.1.7.2" xref="S3.E8.m1.2.2.2.2.2.1.7.1.cmml"><mo stretchy="false" id="S3.E8.m1.2.2.2.2.2.1.7.2.1" xref="S3.E8.m1.2.2.2.2.2.1.7.1.1.cmml">[</mo><mi id="S3.E8.m1.2.2.2.2.2.1.1" xref="S3.E8.m1.2.2.2.2.2.1.1.cmml">k</mi><mo stretchy="false" id="S3.E8.m1.2.2.2.2.2.1.7.2.2" xref="S3.E8.m1.2.2.2.2.2.1.7.1.1.cmml">]</mo></mrow></mrow></mtd></mtr><mtr id="S3.E8.m1.4.4.4d" xref="S3.E8.m1.6.6.1.1.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E8.m1.4.4.4e" xref="S3.E8.m1.6.6.1.1.3.1.cmml"><mrow id="S3.E8.m1.3.3.3.3.1.1.6" xref="S3.E8.m1.3.3.3.3.1.1.5.cmml"><mo stretchy="false" id="S3.E8.m1.3.3.3.3.1.1.6.1" xref="S3.E8.m1.3.3.3.3.1.1.5.cmml">(</mo><mn id="S3.E8.m1.3.3.3.3.1.1.1" xref="S3.E8.m1.3.3.3.3.1.1.1.cmml">0</mn><mo id="S3.E8.m1.3.3.3.3.1.1.6.2" xref="S3.E8.m1.3.3.3.3.1.1.5.cmml">,</mo><mn id="S3.E8.m1.3.3.3.3.1.1.2" xref="S3.E8.m1.3.3.3.3.1.1.2.cmml">0</mn><mo id="S3.E8.m1.3.3.3.3.1.1.6.3" xref="S3.E8.m1.3.3.3.3.1.1.5.cmml">,</mo><mn id="S3.E8.m1.3.3.3.3.1.1.3" xref="S3.E8.m1.3.3.3.3.1.1.3.cmml">0</mn><mo id="S3.E8.m1.3.3.3.3.1.1.6.4" xref="S3.E8.m1.3.3.3.3.1.1.5.cmml">,</mo><mn id="S3.E8.m1.3.3.3.3.1.1.4" xref="S3.E8.m1.3.3.3.3.1.1.4.cmml">0</mn><mo stretchy="false" id="S3.E8.m1.3.3.3.3.1.1.6.5" xref="S3.E8.m1.3.3.3.3.1.1.5.cmml">)</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E8.m1.4.4.4f" xref="S3.E8.m1.6.6.1.1.3.1.cmml"><mtext id="S3.E8.m1.4.4.4.4.2.1" xref="S3.E8.m1.4.4.4.4.2.1a.cmml">otherwise</mtext></mtd></mtr></mtable></mrow></mrow><mo lspace="0em" id="S3.E8.m1.6.6.1.2" xref="S3.E8.m1.6.6.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.6b"><apply id="S3.E8.m1.6.6.1.1.cmml" xref="S3.E8.m1.6.6.1"><eq id="S3.E8.m1.6.6.1.1.1.cmml" xref="S3.E8.m1.6.6.1.1.1"></eq><apply id="S3.E8.m1.6.6.1.1.2.cmml" xref="S3.E8.m1.6.6.1.1.2"><times id="S3.E8.m1.6.6.1.1.2.1.cmml" xref="S3.E8.m1.6.6.1.1.2.1"></times><apply id="S3.E8.m1.6.6.1.1.2.2.cmml" xref="S3.E8.m1.6.6.1.1.2.2"><ci id="S3.E8.m1.6.6.1.1.2.2.1.cmml" xref="S3.E8.m1.6.6.1.1.2.2.1">^</ci><ci id="S3.E8.m1.6.6.1.1.2.2.2.cmml" xref="S3.E8.m1.6.6.1.1.2.2.2">𝐷</ci></apply><apply id="S3.E8.m1.6.6.1.1.2.3.1.cmml" xref="S3.E8.m1.6.6.1.1.2.3.2"><csymbol cd="latexml" id="S3.E8.m1.6.6.1.1.2.3.1.1.cmml" xref="S3.E8.m1.6.6.1.1.2.3.2.1">delimited-[]</csymbol><ci id="S3.E8.m1.5.5.cmml" xref="S3.E8.m1.5.5">𝑖</ci></apply></apply><apply id="S3.E8.m1.6.6.1.1.3.1.cmml" xref="S3.E8.m1.4.4"><csymbol cd="latexml" id="S3.E8.m1.6.6.1.1.3.1.1.cmml" xref="S3.E8.m1.4.4.5">cases</csymbol><apply id="S3.E8.m1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1"><times id="S3.E8.m1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.2"></times><apply id="S3.E8.m1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.2">𝐶</ci><apply id="S3.E8.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.3"><times id="S3.E8.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.3.1"></times><ci id="S3.E8.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.3.2">𝑏</ci><ci id="S3.E8.m1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.3.3">𝑒</ci><ci id="S3.E8.m1.1.1.1.1.1.1.3.3.4.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.3.4">𝑣</ci></apply></apply><apply id="S3.E8.m1.1.1.1.1.1.1.4.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.4.2"><csymbol cd="latexml" id="S3.E8.m1.1.1.1.1.1.1.4.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.4.2.1">delimited-[]</csymbol><ci id="S3.E8.m1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1">𝑘</ci></apply></apply><apply id="S3.E8.m1.2.2.2.2.2.1.cmml" xref="S3.E8.m1.2.2.2.2.2.1"><times id="S3.E8.m1.2.2.2.2.2.1.2.cmml" xref="S3.E8.m1.2.2.2.2.2.1.2"></times><ci id="S3.E8.m1.2.2.2.2.2.1.3a.cmml" xref="S3.E8.m1.2.2.2.2.2.1.3"><mtext id="S3.E8.m1.2.2.2.2.2.1.3.cmml" xref="S3.E8.m1.2.2.2.2.2.1.3">if </mtext></ci><apply id="S3.E8.m1.2.2.2.2.2.1.4.cmml" xref="S3.E8.m1.2.2.2.2.2.1.4"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.2.2.2.1.4.1.cmml" xref="S3.E8.m1.2.2.2.2.2.1.4">subscript</csymbol><ci id="S3.E8.m1.2.2.2.2.2.1.4.2.cmml" xref="S3.E8.m1.2.2.2.2.2.1.4.2">𝑝</ci><ci id="S3.E8.m1.2.2.2.2.2.1.4.3.cmml" xref="S3.E8.m1.2.2.2.2.2.1.4.3">𝑖</ci></apply><ci id="S3.E8.m1.2.2.2.2.2.1.5a.cmml" xref="S3.E8.m1.2.2.2.2.2.1.5"><mtext id="S3.E8.m1.2.2.2.2.2.1.5.cmml" xref="S3.E8.m1.2.2.2.2.2.1.5"> is inside </mtext></ci><apply id="S3.E8.m1.2.2.2.2.2.1.6.cmml" xref="S3.E8.m1.2.2.2.2.2.1.6"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.2.2.2.1.6.1.cmml" xref="S3.E8.m1.2.2.2.2.2.1.6">subscript</csymbol><ci id="S3.E8.m1.2.2.2.2.2.1.6.2.cmml" xref="S3.E8.m1.2.2.2.2.2.1.6.2">𝐵</ci><apply id="S3.E8.m1.2.2.2.2.2.1.6.3.cmml" xref="S3.E8.m1.2.2.2.2.2.1.6.3"><times id="S3.E8.m1.2.2.2.2.2.1.6.3.1.cmml" xref="S3.E8.m1.2.2.2.2.2.1.6.3.1"></times><ci id="S3.E8.m1.2.2.2.2.2.1.6.3.2.cmml" xref="S3.E8.m1.2.2.2.2.2.1.6.3.2">𝑏</ci><ci id="S3.E8.m1.2.2.2.2.2.1.6.3.3.cmml" xref="S3.E8.m1.2.2.2.2.2.1.6.3.3">𝑒</ci><ci id="S3.E8.m1.2.2.2.2.2.1.6.3.4.cmml" xref="S3.E8.m1.2.2.2.2.2.1.6.3.4">𝑣</ci></apply></apply><apply id="S3.E8.m1.2.2.2.2.2.1.7.1.cmml" xref="S3.E8.m1.2.2.2.2.2.1.7.2"><csymbol cd="latexml" id="S3.E8.m1.2.2.2.2.2.1.7.1.1.cmml" xref="S3.E8.m1.2.2.2.2.2.1.7.2.1">delimited-[]</csymbol><ci id="S3.E8.m1.2.2.2.2.2.1.1.cmml" xref="S3.E8.m1.2.2.2.2.2.1.1">𝑘</ci></apply></apply><vector id="S3.E8.m1.3.3.3.3.1.1.5.cmml" xref="S3.E8.m1.3.3.3.3.1.1.6"><cn type="integer" id="S3.E8.m1.3.3.3.3.1.1.1.cmml" xref="S3.E8.m1.3.3.3.3.1.1.1">0</cn><cn type="integer" id="S3.E8.m1.3.3.3.3.1.1.2.cmml" xref="S3.E8.m1.3.3.3.3.1.1.2">0</cn><cn type="integer" id="S3.E8.m1.3.3.3.3.1.1.3.cmml" xref="S3.E8.m1.3.3.3.3.1.1.3">0</cn><cn type="integer" id="S3.E8.m1.3.3.3.3.1.1.4.cmml" xref="S3.E8.m1.3.3.3.3.1.1.4">0</cn></vector><ci id="S3.E8.m1.4.4.4.4.2.1a.cmml" xref="S3.E8.m1.4.4.4.4.2.1"><mtext id="S3.E8.m1.4.4.4.4.2.1.cmml" xref="S3.E8.m1.4.4.4.4.2.1">otherwise</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.6c">\hat{D}[i]=\begin{cases}C_{bev}[k]&amp;\text{if }p_{i}\text{ is inside }B_{bev}[k]\\
(0,0,0,0)&amp;\text{otherwise}\end{cases}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.SSS0.Px1.p2.7" class="ltx_p">For pixels that belong to two or more instances, we randomly choose the corresponding instance it belongs to.
The branch is optimized with a Smooth-<math id="S3.SS3.SSS0.Px1.p2.7.m1.1" class="ltx_Math" alttext="l_{1}" display="inline"><semantics id="S3.SS3.SSS0.Px1.p2.7.m1.1a"><msub id="S3.SS3.SSS0.Px1.p2.7.m1.1.1" xref="S3.SS3.SSS0.Px1.p2.7.m1.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p2.7.m1.1.1.2" xref="S3.SS3.SSS0.Px1.p2.7.m1.1.1.2.cmml">l</mi><mn id="S3.SS3.SSS0.Px1.p2.7.m1.1.1.3" xref="S3.SS3.SSS0.Px1.p2.7.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.7.m1.1b"><apply id="S3.SS3.SSS0.Px1.p2.7.m1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.7.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.7.m1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.7.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p2.7.m1.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p2.7.m1.1.1.2">𝑙</ci><cn type="integer" id="S3.SS3.SSS0.Px1.p2.7.m1.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p2.7.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.7.m1.1c">l_{1}</annotation></semantics></math> loss <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>:</p>
<table id="S3.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E9.m1.3" class="ltx_Math" alttext="\mathcal{L}_{dis}=\sum^{R\times A}_{i=1}\text{Smooth-}l_{1}(D[i],\hat{D}[i])." display="block"><semantics id="S3.E9.m1.3a"><mrow id="S3.E9.m1.3.3.1" xref="S3.E9.m1.3.3.1.1.cmml"><mrow id="S3.E9.m1.3.3.1.1" xref="S3.E9.m1.3.3.1.1.cmml"><msub id="S3.E9.m1.3.3.1.1.4" xref="S3.E9.m1.3.3.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E9.m1.3.3.1.1.4.2" xref="S3.E9.m1.3.3.1.1.4.2.cmml">ℒ</mi><mrow id="S3.E9.m1.3.3.1.1.4.3" xref="S3.E9.m1.3.3.1.1.4.3.cmml"><mi id="S3.E9.m1.3.3.1.1.4.3.2" xref="S3.E9.m1.3.3.1.1.4.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.3.3.1.1.4.3.1" xref="S3.E9.m1.3.3.1.1.4.3.1.cmml">​</mo><mi id="S3.E9.m1.3.3.1.1.4.3.3" xref="S3.E9.m1.3.3.1.1.4.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.3.3.1.1.4.3.1a" xref="S3.E9.m1.3.3.1.1.4.3.1.cmml">​</mo><mi id="S3.E9.m1.3.3.1.1.4.3.4" xref="S3.E9.m1.3.3.1.1.4.3.4.cmml">s</mi></mrow></msub><mo rspace="0.111em" id="S3.E9.m1.3.3.1.1.3" xref="S3.E9.m1.3.3.1.1.3.cmml">=</mo><mrow id="S3.E9.m1.3.3.1.1.2" xref="S3.E9.m1.3.3.1.1.2.cmml"><munderover id="S3.E9.m1.3.3.1.1.2.3" xref="S3.E9.m1.3.3.1.1.2.3.cmml"><mo movablelimits="false" id="S3.E9.m1.3.3.1.1.2.3.2.2" xref="S3.E9.m1.3.3.1.1.2.3.2.2.cmml">∑</mo><mrow id="S3.E9.m1.3.3.1.1.2.3.3" xref="S3.E9.m1.3.3.1.1.2.3.3.cmml"><mi id="S3.E9.m1.3.3.1.1.2.3.3.2" xref="S3.E9.m1.3.3.1.1.2.3.3.2.cmml">i</mi><mo id="S3.E9.m1.3.3.1.1.2.3.3.1" xref="S3.E9.m1.3.3.1.1.2.3.3.1.cmml">=</mo><mn id="S3.E9.m1.3.3.1.1.2.3.3.3" xref="S3.E9.m1.3.3.1.1.2.3.3.3.cmml">1</mn></mrow><mrow id="S3.E9.m1.3.3.1.1.2.3.2.3" xref="S3.E9.m1.3.3.1.1.2.3.2.3.cmml"><mi id="S3.E9.m1.3.3.1.1.2.3.2.3.2" xref="S3.E9.m1.3.3.1.1.2.3.2.3.2.cmml">R</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E9.m1.3.3.1.1.2.3.2.3.1" xref="S3.E9.m1.3.3.1.1.2.3.2.3.1.cmml">×</mo><mi id="S3.E9.m1.3.3.1.1.2.3.2.3.3" xref="S3.E9.m1.3.3.1.1.2.3.2.3.3.cmml">A</mi></mrow></munderover><mrow id="S3.E9.m1.3.3.1.1.2.2" xref="S3.E9.m1.3.3.1.1.2.2.cmml"><mtext id="S3.E9.m1.3.3.1.1.2.2.4" xref="S3.E9.m1.3.3.1.1.2.2.4a.cmml">Smooth-</mtext><mo lspace="0em" rspace="0em" id="S3.E9.m1.3.3.1.1.2.2.3" xref="S3.E9.m1.3.3.1.1.2.2.3.cmml">​</mo><msub id="S3.E9.m1.3.3.1.1.2.2.5" xref="S3.E9.m1.3.3.1.1.2.2.5.cmml"><mi id="S3.E9.m1.3.3.1.1.2.2.5.2" xref="S3.E9.m1.3.3.1.1.2.2.5.2.cmml">l</mi><mn id="S3.E9.m1.3.3.1.1.2.2.5.3" xref="S3.E9.m1.3.3.1.1.2.2.5.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="S3.E9.m1.3.3.1.1.2.2.3a" xref="S3.E9.m1.3.3.1.1.2.2.3.cmml">​</mo><mrow id="S3.E9.m1.3.3.1.1.2.2.2.2" xref="S3.E9.m1.3.3.1.1.2.2.2.3.cmml"><mo stretchy="false" id="S3.E9.m1.3.3.1.1.2.2.2.2.3" xref="S3.E9.m1.3.3.1.1.2.2.2.3.cmml">(</mo><mrow id="S3.E9.m1.3.3.1.1.1.1.1.1.1" xref="S3.E9.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="S3.E9.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E9.m1.3.3.1.1.1.1.1.1.1.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E9.m1.3.3.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S3.E9.m1.3.3.1.1.1.1.1.1.1.3.2" xref="S3.E9.m1.3.3.1.1.1.1.1.1.1.3.1.cmml"><mo stretchy="false" id="S3.E9.m1.3.3.1.1.1.1.1.1.1.3.2.1" xref="S3.E9.m1.3.3.1.1.1.1.1.1.1.3.1.1.cmml">[</mo><mi id="S3.E9.m1.1.1" xref="S3.E9.m1.1.1.cmml">i</mi><mo stretchy="false" id="S3.E9.m1.3.3.1.1.1.1.1.1.1.3.2.2" xref="S3.E9.m1.3.3.1.1.1.1.1.1.1.3.1.1.cmml">]</mo></mrow></mrow><mo id="S3.E9.m1.3.3.1.1.2.2.2.2.4" xref="S3.E9.m1.3.3.1.1.2.2.2.3.cmml">,</mo><mrow id="S3.E9.m1.3.3.1.1.2.2.2.2.2" xref="S3.E9.m1.3.3.1.1.2.2.2.2.2.cmml"><mover accent="true" id="S3.E9.m1.3.3.1.1.2.2.2.2.2.2" xref="S3.E9.m1.3.3.1.1.2.2.2.2.2.2.cmml"><mi id="S3.E9.m1.3.3.1.1.2.2.2.2.2.2.2" xref="S3.E9.m1.3.3.1.1.2.2.2.2.2.2.2.cmml">D</mi><mo id="S3.E9.m1.3.3.1.1.2.2.2.2.2.2.1" xref="S3.E9.m1.3.3.1.1.2.2.2.2.2.2.1.cmml">^</mo></mover><mo lspace="0em" rspace="0em" id="S3.E9.m1.3.3.1.1.2.2.2.2.2.1" xref="S3.E9.m1.3.3.1.1.2.2.2.2.2.1.cmml">​</mo><mrow id="S3.E9.m1.3.3.1.1.2.2.2.2.2.3.2" xref="S3.E9.m1.3.3.1.1.2.2.2.2.2.3.1.cmml"><mo stretchy="false" id="S3.E9.m1.3.3.1.1.2.2.2.2.2.3.2.1" xref="S3.E9.m1.3.3.1.1.2.2.2.2.2.3.1.1.cmml">[</mo><mi id="S3.E9.m1.2.2" xref="S3.E9.m1.2.2.cmml">i</mi><mo stretchy="false" id="S3.E9.m1.3.3.1.1.2.2.2.2.2.3.2.2" xref="S3.E9.m1.3.3.1.1.2.2.2.2.2.3.1.1.cmml">]</mo></mrow></mrow><mo stretchy="false" id="S3.E9.m1.3.3.1.1.2.2.2.2.5" xref="S3.E9.m1.3.3.1.1.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E9.m1.3.3.1.2" xref="S3.E9.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.3b"><apply id="S3.E9.m1.3.3.1.1.cmml" xref="S3.E9.m1.3.3.1"><eq id="S3.E9.m1.3.3.1.1.3.cmml" xref="S3.E9.m1.3.3.1.1.3"></eq><apply id="S3.E9.m1.3.3.1.1.4.cmml" xref="S3.E9.m1.3.3.1.1.4"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.1.1.4.1.cmml" xref="S3.E9.m1.3.3.1.1.4">subscript</csymbol><ci id="S3.E9.m1.3.3.1.1.4.2.cmml" xref="S3.E9.m1.3.3.1.1.4.2">ℒ</ci><apply id="S3.E9.m1.3.3.1.1.4.3.cmml" xref="S3.E9.m1.3.3.1.1.4.3"><times id="S3.E9.m1.3.3.1.1.4.3.1.cmml" xref="S3.E9.m1.3.3.1.1.4.3.1"></times><ci id="S3.E9.m1.3.3.1.1.4.3.2.cmml" xref="S3.E9.m1.3.3.1.1.4.3.2">𝑑</ci><ci id="S3.E9.m1.3.3.1.1.4.3.3.cmml" xref="S3.E9.m1.3.3.1.1.4.3.3">𝑖</ci><ci id="S3.E9.m1.3.3.1.1.4.3.4.cmml" xref="S3.E9.m1.3.3.1.1.4.3.4">𝑠</ci></apply></apply><apply id="S3.E9.m1.3.3.1.1.2.cmml" xref="S3.E9.m1.3.3.1.1.2"><apply id="S3.E9.m1.3.3.1.1.2.3.cmml" xref="S3.E9.m1.3.3.1.1.2.3"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.1.1.2.3.1.cmml" xref="S3.E9.m1.3.3.1.1.2.3">subscript</csymbol><apply id="S3.E9.m1.3.3.1.1.2.3.2.cmml" xref="S3.E9.m1.3.3.1.1.2.3"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.1.1.2.3.2.1.cmml" xref="S3.E9.m1.3.3.1.1.2.3">superscript</csymbol><sum id="S3.E9.m1.3.3.1.1.2.3.2.2.cmml" xref="S3.E9.m1.3.3.1.1.2.3.2.2"></sum><apply id="S3.E9.m1.3.3.1.1.2.3.2.3.cmml" xref="S3.E9.m1.3.3.1.1.2.3.2.3"><times id="S3.E9.m1.3.3.1.1.2.3.2.3.1.cmml" xref="S3.E9.m1.3.3.1.1.2.3.2.3.1"></times><ci id="S3.E9.m1.3.3.1.1.2.3.2.3.2.cmml" xref="S3.E9.m1.3.3.1.1.2.3.2.3.2">𝑅</ci><ci id="S3.E9.m1.3.3.1.1.2.3.2.3.3.cmml" xref="S3.E9.m1.3.3.1.1.2.3.2.3.3">𝐴</ci></apply></apply><apply id="S3.E9.m1.3.3.1.1.2.3.3.cmml" xref="S3.E9.m1.3.3.1.1.2.3.3"><eq id="S3.E9.m1.3.3.1.1.2.3.3.1.cmml" xref="S3.E9.m1.3.3.1.1.2.3.3.1"></eq><ci id="S3.E9.m1.3.3.1.1.2.3.3.2.cmml" xref="S3.E9.m1.3.3.1.1.2.3.3.2">𝑖</ci><cn type="integer" id="S3.E9.m1.3.3.1.1.2.3.3.3.cmml" xref="S3.E9.m1.3.3.1.1.2.3.3.3">1</cn></apply></apply><apply id="S3.E9.m1.3.3.1.1.2.2.cmml" xref="S3.E9.m1.3.3.1.1.2.2"><times id="S3.E9.m1.3.3.1.1.2.2.3.cmml" xref="S3.E9.m1.3.3.1.1.2.2.3"></times><ci id="S3.E9.m1.3.3.1.1.2.2.4a.cmml" xref="S3.E9.m1.3.3.1.1.2.2.4"><mtext id="S3.E9.m1.3.3.1.1.2.2.4.cmml" xref="S3.E9.m1.3.3.1.1.2.2.4">Smooth-</mtext></ci><apply id="S3.E9.m1.3.3.1.1.2.2.5.cmml" xref="S3.E9.m1.3.3.1.1.2.2.5"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.1.1.2.2.5.1.cmml" xref="S3.E9.m1.3.3.1.1.2.2.5">subscript</csymbol><ci id="S3.E9.m1.3.3.1.1.2.2.5.2.cmml" xref="S3.E9.m1.3.3.1.1.2.2.5.2">𝑙</ci><cn type="integer" id="S3.E9.m1.3.3.1.1.2.2.5.3.cmml" xref="S3.E9.m1.3.3.1.1.2.2.5.3">1</cn></apply><interval closure="open" id="S3.E9.m1.3.3.1.1.2.2.2.3.cmml" xref="S3.E9.m1.3.3.1.1.2.2.2.2"><apply id="S3.E9.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.1.1"><times id="S3.E9.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.1.1.1"></times><ci id="S3.E9.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.1.1.2">𝐷</ci><apply id="S3.E9.m1.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.1.1.3.2"><csymbol cd="latexml" id="S3.E9.m1.3.3.1.1.1.1.1.1.1.3.1.1.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.1.1.3.2.1">delimited-[]</csymbol><ci id="S3.E9.m1.1.1.cmml" xref="S3.E9.m1.1.1">𝑖</ci></apply></apply><apply id="S3.E9.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S3.E9.m1.3.3.1.1.2.2.2.2.2"><times id="S3.E9.m1.3.3.1.1.2.2.2.2.2.1.cmml" xref="S3.E9.m1.3.3.1.1.2.2.2.2.2.1"></times><apply id="S3.E9.m1.3.3.1.1.2.2.2.2.2.2.cmml" xref="S3.E9.m1.3.3.1.1.2.2.2.2.2.2"><ci id="S3.E9.m1.3.3.1.1.2.2.2.2.2.2.1.cmml" xref="S3.E9.m1.3.3.1.1.2.2.2.2.2.2.1">^</ci><ci id="S3.E9.m1.3.3.1.1.2.2.2.2.2.2.2.cmml" xref="S3.E9.m1.3.3.1.1.2.2.2.2.2.2.2">𝐷</ci></apply><apply id="S3.E9.m1.3.3.1.1.2.2.2.2.2.3.1.cmml" xref="S3.E9.m1.3.3.1.1.2.2.2.2.2.3.2"><csymbol cd="latexml" id="S3.E9.m1.3.3.1.1.2.2.2.2.2.3.1.1.cmml" xref="S3.E9.m1.3.3.1.1.2.2.2.2.2.3.2.1">delimited-[]</csymbol><ci id="S3.E9.m1.2.2.cmml" xref="S3.E9.m1.2.2">𝑖</ci></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.3c">\mathcal{L}_{dis}=\sum^{R\times A}_{i=1}\text{Smooth-}l_{1}(D[i],\hat{D}[i]).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS3.SSS0.Px1.p3" class="ltx_para">
<p id="S3.SS3.SSS0.Px1.p3.1" class="ltx_p">The output of the module <math id="S3.SS3.SSS0.Px1.p3.1.m1.3" class="ltx_Math" alttext="G=Cat([H,D])" display="inline"><semantics id="S3.SS3.SSS0.Px1.p3.1.m1.3a"><mrow id="S3.SS3.SSS0.Px1.p3.1.m1.3.3" xref="S3.SS3.SSS0.Px1.p3.1.m1.3.3.cmml"><mi id="S3.SS3.SSS0.Px1.p3.1.m1.3.3.3" xref="S3.SS3.SSS0.Px1.p3.1.m1.3.3.3.cmml">G</mi><mo id="S3.SS3.SSS0.Px1.p3.1.m1.3.3.2" xref="S3.SS3.SSS0.Px1.p3.1.m1.3.3.2.cmml">=</mo><mrow id="S3.SS3.SSS0.Px1.p3.1.m1.3.3.1" xref="S3.SS3.SSS0.Px1.p3.1.m1.3.3.1.cmml"><mi id="S3.SS3.SSS0.Px1.p3.1.m1.3.3.1.3" xref="S3.SS3.SSS0.Px1.p3.1.m1.3.3.1.3.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p3.1.m1.3.3.1.2" xref="S3.SS3.SSS0.Px1.p3.1.m1.3.3.1.2.cmml">​</mo><mi id="S3.SS3.SSS0.Px1.p3.1.m1.3.3.1.4" xref="S3.SS3.SSS0.Px1.p3.1.m1.3.3.1.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p3.1.m1.3.3.1.2a" xref="S3.SS3.SSS0.Px1.p3.1.m1.3.3.1.2.cmml">​</mo><mi id="S3.SS3.SSS0.Px1.p3.1.m1.3.3.1.5" xref="S3.SS3.SSS0.Px1.p3.1.m1.3.3.1.5.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p3.1.m1.3.3.1.2b" xref="S3.SS3.SSS0.Px1.p3.1.m1.3.3.1.2.cmml">​</mo><mrow id="S3.SS3.SSS0.Px1.p3.1.m1.3.3.1.1.1" xref="S3.SS3.SSS0.Px1.p3.1.m1.3.3.1.cmml"><mo stretchy="false" id="S3.SS3.SSS0.Px1.p3.1.m1.3.3.1.1.1.2" xref="S3.SS3.SSS0.Px1.p3.1.m1.3.3.1.cmml">(</mo><mrow id="S3.SS3.SSS0.Px1.p3.1.m1.3.3.1.1.1.1.2" xref="S3.SS3.SSS0.Px1.p3.1.m1.3.3.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.SSS0.Px1.p3.1.m1.3.3.1.1.1.1.2.1" xref="S3.SS3.SSS0.Px1.p3.1.m1.3.3.1.1.1.1.1.cmml">[</mo><mi id="S3.SS3.SSS0.Px1.p3.1.m1.1.1" xref="S3.SS3.SSS0.Px1.p3.1.m1.1.1.cmml">H</mi><mo id="S3.SS3.SSS0.Px1.p3.1.m1.3.3.1.1.1.1.2.2" xref="S3.SS3.SSS0.Px1.p3.1.m1.3.3.1.1.1.1.1.cmml">,</mo><mi id="S3.SS3.SSS0.Px1.p3.1.m1.2.2" xref="S3.SS3.SSS0.Px1.p3.1.m1.2.2.cmml">D</mi><mo stretchy="false" id="S3.SS3.SSS0.Px1.p3.1.m1.3.3.1.1.1.1.2.3" xref="S3.SS3.SSS0.Px1.p3.1.m1.3.3.1.1.1.1.1.cmml">]</mo></mrow><mo stretchy="false" id="S3.SS3.SSS0.Px1.p3.1.m1.3.3.1.1.1.3" xref="S3.SS3.SSS0.Px1.p3.1.m1.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p3.1.m1.3b"><apply id="S3.SS3.SSS0.Px1.p3.1.m1.3.3.cmml" xref="S3.SS3.SSS0.Px1.p3.1.m1.3.3"><eq id="S3.SS3.SSS0.Px1.p3.1.m1.3.3.2.cmml" xref="S3.SS3.SSS0.Px1.p3.1.m1.3.3.2"></eq><ci id="S3.SS3.SSS0.Px1.p3.1.m1.3.3.3.cmml" xref="S3.SS3.SSS0.Px1.p3.1.m1.3.3.3">𝐺</ci><apply id="S3.SS3.SSS0.Px1.p3.1.m1.3.3.1.cmml" xref="S3.SS3.SSS0.Px1.p3.1.m1.3.3.1"><times id="S3.SS3.SSS0.Px1.p3.1.m1.3.3.1.2.cmml" xref="S3.SS3.SSS0.Px1.p3.1.m1.3.3.1.2"></times><ci id="S3.SS3.SSS0.Px1.p3.1.m1.3.3.1.3.cmml" xref="S3.SS3.SSS0.Px1.p3.1.m1.3.3.1.3">𝐶</ci><ci id="S3.SS3.SSS0.Px1.p3.1.m1.3.3.1.4.cmml" xref="S3.SS3.SSS0.Px1.p3.1.m1.3.3.1.4">𝑎</ci><ci id="S3.SS3.SSS0.Px1.p3.1.m1.3.3.1.5.cmml" xref="S3.SS3.SSS0.Px1.p3.1.m1.3.3.1.5">𝑡</ci><interval closure="closed" id="S3.SS3.SSS0.Px1.p3.1.m1.3.3.1.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p3.1.m1.3.3.1.1.1.1.2"><ci id="S3.SS3.SSS0.Px1.p3.1.m1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p3.1.m1.1.1">𝐻</ci><ci id="S3.SS3.SSS0.Px1.p3.1.m1.2.2.cmml" xref="S3.SS3.SSS0.Px1.p3.1.m1.2.2">𝐷</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p3.1.m1.3c">G=Cat([H,D])</annotation></semantics></math> could be regarded as instance-wise geometric clues, which are supposed to help solve the occupation difference and the feature blurring issue.
However, we find that the auxiliary supervision itself does not introduce performance gain for polar detectors.
To tackle the issue, we further propose a geometry-aware attention module to fully utilize the predicted information.</p>
</div>
<figure id="S3.T1" class="ltx_table">
<table id="S3.T1.5" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S3.T1.5.6" class="ltx_tr">
<td id="S3.T1.5.6.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" rowspan="2"><span id="S3.T1.5.6.1.1" class="ltx_text">Method</span></td>
<td id="S3.T1.5.6.2" class="ltx_td ltx_align_center ltx_border_t" rowspan="2"><span id="S3.T1.5.6.2.1" class="ltx_text">Backbone</span></td>
<td id="S3.T1.5.6.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="2"><span id="S3.T1.5.6.3.1" class="ltx_text">Coordinate</span></td>
<td id="S3.T1.5.6.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2">Vehicle LEVEL 1</td>
<td id="S3.T1.5.6.5" class="ltx_td ltx_align_center ltx_border_t" colspan="2">Vehicle LEVEL 2</td>
</tr>
<tr id="S3.T1.5.7" class="ltx_tr">
<td id="S3.T1.5.7.1" class="ltx_td ltx_align_center">3D mAP(%)</td>
<td id="S3.T1.5.7.2" class="ltx_td ltx_align_center ltx_border_r">3D mAPH(%)</td>
<td id="S3.T1.5.7.3" class="ltx_td ltx_align_center">3D mAP(%)</td>
<td id="S3.T1.5.7.4" class="ltx_td ltx_align_center">3D mAPH(%)</td>
</tr>
<tr id="S3.T1.5.8" class="ltx_tr">
<td id="S3.T1.5.8.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt">PointPillars <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>
</td>
<td id="S3.T1.5.8.2" class="ltx_td ltx_align_center ltx_border_tt">Pillar</td>
<td id="S3.T1.5.8.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">Cartesian</td>
<td id="S3.T1.5.8.4" class="ltx_td ltx_align_center ltx_border_tt">63.3</td>
<td id="S3.T1.5.8.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">62.7</td>
<td id="S3.T1.5.8.6" class="ltx_td ltx_align_center ltx_border_tt">55.2</td>
<td id="S3.T1.5.8.7" class="ltx_td ltx_align_center ltx_border_tt">54.7</td>
</tr>
<tr id="S3.T1.5.9" class="ltx_tr">
<td id="S3.T1.5.9.1" class="ltx_td ltx_align_left ltx_border_r">Pillar-OD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>
</td>
<td id="S3.T1.5.9.2" class="ltx_td ltx_align_center">Pillar</td>
<td id="S3.T1.5.9.3" class="ltx_td ltx_align_center ltx_border_r">Cartesian</td>
<td id="S3.T1.5.9.4" class="ltx_td ltx_align_center">69.8</td>
<td id="S3.T1.5.9.5" class="ltx_td ltx_align_center ltx_border_r">-</td>
<td id="S3.T1.5.9.6" class="ltx_td ltx_align_center">-</td>
<td id="S3.T1.5.9.7" class="ltx_td ltx_align_center">-</td>
</tr>
<tr id="S3.T1.5.10" class="ltx_tr">
<td id="S3.T1.5.10.1" class="ltx_td ltx_align_left ltx_border_r">MVF <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>
</td>
<td id="S3.T1.5.10.2" class="ltx_td ltx_align_center">Voxel</td>
<td id="S3.T1.5.10.3" class="ltx_td ltx_align_center ltx_border_r">Cartesian</td>
<td id="S3.T1.5.10.4" class="ltx_td ltx_align_center">62.93</td>
<td id="S3.T1.5.10.5" class="ltx_td ltx_align_center ltx_border_r">-</td>
<td id="S3.T1.5.10.6" class="ltx_td ltx_align_center">-</td>
<td id="S3.T1.5.10.7" class="ltx_td ltx_align_center">-</td>
</tr>
<tr id="S3.T1.5.11" class="ltx_tr">
<td id="S3.T1.5.11.1" class="ltx_td ltx_align_left ltx_border_r">PV-RCNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>
</td>
<td id="S3.T1.5.11.2" class="ltx_td ltx_align_center">Voxel</td>
<td id="S3.T1.5.11.3" class="ltx_td ltx_align_center ltx_border_r">Cartesian</td>
<td id="S3.T1.5.11.4" class="ltx_td ltx_align_center">77.51</td>
<td id="S3.T1.5.11.5" class="ltx_td ltx_align_center ltx_border_r">76.89</td>
<td id="S3.T1.5.11.6" class="ltx_td ltx_align_center">68.98</td>
<td id="S3.T1.5.11.7" class="ltx_td ltx_align_center">68.41</td>
</tr>
<tr id="S3.T1.5.12" class="ltx_tr">
<td id="S3.T1.5.12.1" class="ltx_td ltx_align_left ltx_border_r">VoTr-TSD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>
</td>
<td id="S3.T1.5.12.2" class="ltx_td ltx_align_center">Voxel</td>
<td id="S3.T1.5.12.3" class="ltx_td ltx_align_center ltx_border_r">Cartesian</td>
<td id="S3.T1.5.12.4" class="ltx_td ltx_align_center">74.95</td>
<td id="S3.T1.5.12.5" class="ltx_td ltx_align_center ltx_border_r">74.25</td>
<td id="S3.T1.5.12.6" class="ltx_td ltx_align_center">65.91</td>
<td id="S3.T1.5.12.7" class="ltx_td ltx_align_center">65.29</td>
</tr>
<tr id="S3.T1.5.13" class="ltx_tr">
<td id="S3.T1.5.13.1" class="ltx_td ltx_align_left ltx_border_r">Pyramid-RCNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>
</td>
<td id="S3.T1.5.13.2" class="ltx_td ltx_align_center">Voxel</td>
<td id="S3.T1.5.13.3" class="ltx_td ltx_align_center ltx_border_r">Cartesian</td>
<td id="S3.T1.5.13.4" class="ltx_td ltx_align_center">76.3</td>
<td id="S3.T1.5.13.5" class="ltx_td ltx_align_center ltx_border_r">75.68</td>
<td id="S3.T1.5.13.6" class="ltx_td ltx_align_center">67.23</td>
<td id="S3.T1.5.13.7" class="ltx_td ltx_align_center">66.68</td>
</tr>
<tr id="S3.T1.1.1" class="ltx_tr">
<td id="S3.T1.1.1.1" class="ltx_td ltx_align_left ltx_border_r">PolarStream<sup id="S3.T1.1.1.1.1" class="ltx_sup"><span id="S3.T1.1.1.1.1.1" class="ltx_text ltx_font_italic">†</span></sup> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>
</td>
<td id="S3.T1.1.1.2" class="ltx_td ltx_align_center">Voxel</td>
<td id="S3.T1.1.1.3" class="ltx_td ltx_align_center ltx_border_r">Polar</td>
<td id="S3.T1.1.1.4" class="ltx_td ltx_align_center">72.37</td>
<td id="S3.T1.1.1.5" class="ltx_td ltx_align_center ltx_border_r">71.81</td>
<td id="S3.T1.1.1.6" class="ltx_td ltx_align_center">64.56</td>
<td id="S3.T1.1.1.7" class="ltx_td ltx_align_center">64.04</td>
</tr>
<tr id="S3.T1.2.2" class="ltx_tr">
<td id="S3.T1.2.2.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">CenterPoint<sup id="S3.T1.2.2.1.1" class="ltx_sup"><span id="S3.T1.2.2.1.1.1" class="ltx_text ltx_font_italic">†</span></sup> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>
</td>
<td id="S3.T1.2.2.2" class="ltx_td ltx_align_center ltx_border_t">Voxel</td>
<td id="S3.T1.2.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Cartesian</td>
<td id="S3.T1.2.2.4" class="ltx_td ltx_align_center ltx_border_t">75.58</td>
<td id="S3.T1.2.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">75.01</td>
<td id="S3.T1.2.2.6" class="ltx_td ltx_align_center ltx_border_t">67.00</td>
<td id="S3.T1.2.2.7" class="ltx_td ltx_align_center ltx_border_t">66.52</td>
</tr>
<tr id="S3.T1.3.3" class="ltx_tr">
<td id="S3.T1.3.3.1" class="ltx_td ltx_align_left ltx_border_r">CenterPoint<sup id="S3.T1.3.3.1.1" class="ltx_sup"><span id="S3.T1.3.3.1.1.1" class="ltx_text ltx_font_italic">†</span></sup> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>
</td>
<td id="S3.T1.3.3.2" class="ltx_td ltx_align_center">Voxel</td>
<td id="S3.T1.3.3.3" class="ltx_td ltx_align_center ltx_border_r">Polar</td>
<td id="S3.T1.3.3.4" class="ltx_td ltx_align_center">72.24</td>
<td id="S3.T1.3.3.5" class="ltx_td ltx_align_center ltx_border_r">71.70</td>
<td id="S3.T1.3.3.6" class="ltx_td ltx_align_center">63.65</td>
<td id="S3.T1.3.3.7" class="ltx_td ltx_align_center">63.17</td>
</tr>
<tr id="S3.T1.5.14" class="ltx_tr">
<td id="S3.T1.5.14.1" class="ltx_td ltx_align_left ltx_border_r">PARTNER-CP (Ours)</td>
<td id="S3.T1.5.14.2" class="ltx_td ltx_align_center">Voxel</td>
<td id="S3.T1.5.14.3" class="ltx_td ltx_align_center ltx_border_r">Polar</td>
<td id="S3.T1.5.14.4" class="ltx_td ltx_align_center"><span id="S3.T1.5.14.4.1" class="ltx_text ltx_font_bold">76.05</span></td>
<td id="S3.T1.5.14.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T1.5.14.5.1" class="ltx_text ltx_font_bold">75.52</span></td>
<td id="S3.T1.5.14.6" class="ltx_td ltx_align_center"><span id="S3.T1.5.14.6.1" class="ltx_text ltx_font_bold">68.58</span></td>
<td id="S3.T1.5.14.7" class="ltx_td ltx_align_center"><span id="S3.T1.5.14.7.1" class="ltx_text ltx_font_bold">68.11</span></td>
</tr>
<tr id="S3.T1.4.4" class="ltx_tr">
<td id="S3.T1.4.4.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">CenterFormer<sup id="S3.T1.4.4.1.1" class="ltx_sup"><span id="S3.T1.4.4.1.1.1" class="ltx_text ltx_font_italic">†</span></sup> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>
</td>
<td id="S3.T1.4.4.2" class="ltx_td ltx_align_center ltx_border_t">Voxel</td>
<td id="S3.T1.4.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Cartesian</td>
<td id="S3.T1.4.4.4" class="ltx_td ltx_align_center ltx_border_t">75.83</td>
<td id="S3.T1.4.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">75.32</td>
<td id="S3.T1.4.4.6" class="ltx_td ltx_align_center ltx_border_t">69.52</td>
<td id="S3.T1.4.4.7" class="ltx_td ltx_align_center ltx_border_t">68.98</td>
</tr>
<tr id="S3.T1.5.5" class="ltx_tr">
<td id="S3.T1.5.5.1" class="ltx_td ltx_align_left ltx_border_r">CenterFormer<sup id="S3.T1.5.5.1.1" class="ltx_sup"><span id="S3.T1.5.5.1.1.1" class="ltx_text ltx_font_italic">†</span></sup> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>
</td>
<td id="S3.T1.5.5.2" class="ltx_td ltx_align_center">Voxel</td>
<td id="S3.T1.5.5.3" class="ltx_td ltx_align_center ltx_border_r">Polar</td>
<td id="S3.T1.5.5.4" class="ltx_td ltx_align_center">74.79</td>
<td id="S3.T1.5.5.5" class="ltx_td ltx_align_center ltx_border_r">74.30</td>
<td id="S3.T1.5.5.6" class="ltx_td ltx_align_center">68.56</td>
<td id="S3.T1.5.5.7" class="ltx_td ltx_align_center">68.04</td>
</tr>
<tr id="S3.T1.5.15" class="ltx_tr">
<td id="S3.T1.5.15.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_r">PARTNER-CF (Ours)</td>
<td id="S3.T1.5.15.2" class="ltx_td ltx_align_center ltx_border_b">Voxel</td>
<td id="S3.T1.5.15.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">Polar</td>
<td id="S3.T1.5.15.4" class="ltx_td ltx_align_center ltx_border_b"><span id="S3.T1.5.15.4.1" class="ltx_text ltx_font_bold">77.76</span></td>
<td id="S3.T1.5.15.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S3.T1.5.15.5.1" class="ltx_text ltx_font_bold">77.24</span></td>
<td id="S3.T1.5.15.6" class="ltx_td ltx_align_center ltx_border_b"><span id="S3.T1.5.15.6.1" class="ltx_text ltx_font_bold">70.30</span></td>
<td id="S3.T1.5.15.7" class="ltx_td ltx_align_center ltx_border_b"><span id="S3.T1.5.15.7.1" class="ltx_text ltx_font_bold">69.84</span></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Performance comparisons of 3D object detection on the Waymo val. set for vehicle detection.
We show the mAP/mAPH in the L1/L2 difficulty levels.
<sup id="S3.T1.9.1" class="ltx_sup"><span id="S3.T1.9.1.1" class="ltx_text ltx_font_italic">†</span></sup>: re-implemented using the official code.
</figcaption>
</figure>
</section>
<section id="S3.SS3.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Geometry-aware aggregation.</h4>

<div id="S3.SS3.SSS0.Px2.p1" class="ltx_para">
<p id="S3.SS3.SSS0.Px2.p1.5" class="ltx_p">This sub-module exploits the self-attention mechanism with the supplement of positional priors of pixels in global coordinates for the following prediction of instance-wise geometric information.
The proposed module takes the input of the BEV map <math id="S3.SS3.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="F^{neck}" display="inline"><semantics id="S3.SS3.SSS0.Px2.p1.1.m1.1a"><msup id="S3.SS3.SSS0.Px2.p1.1.m1.1.1" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.2" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.2.cmml">F</mi><mrow id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.cmml"><mi id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.2" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.1" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.3" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.1a" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.4" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.1b" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.5" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.5.cmml">k</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.1.m1.1b"><apply id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1">superscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.2">𝐹</ci><apply id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3"><times id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.1"></times><ci id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.2.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.2">𝑛</ci><ci id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.3.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.3">𝑒</ci><ci id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.4.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.4">𝑐</ci><ci id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.5.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.5">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.1.m1.1c">F^{neck}</annotation></semantics></math> as well as the output <math id="S3.SS3.SSS0.Px2.p1.2.m2.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S3.SS3.SSS0.Px2.p1.2.m2.1a"><mi id="S3.SS3.SSS0.Px2.p1.2.m2.1.1" xref="S3.SS3.SSS0.Px2.p1.2.m2.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.2.m2.1b"><ci id="S3.SS3.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.2.m2.1c">G</annotation></semantics></math> of the geometry-aware prediction module. We first calculate the geometry-aware embedding map <math id="S3.SS3.SSS0.Px2.p1.3.m3.1" class="ltx_Math" alttext="F^{geo}" display="inline"><semantics id="S3.SS3.SSS0.Px2.p1.3.m3.1a"><msup id="S3.SS3.SSS0.Px2.p1.3.m3.1.1" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.2" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.2.cmml">F</mi><mrow id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.cmml"><mi id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.2" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.1" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.3" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.1a" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.4" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.4.cmml">o</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.3.m3.1b"><apply id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1">superscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.2">𝐹</ci><apply id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3"><times id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.1"></times><ci id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.2.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.2">𝑔</ci><ci id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.3.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.3">𝑒</ci><ci id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.4.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.4">𝑜</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.3.m3.1c">F^{geo}</annotation></semantics></math> from the geometric clues <math id="S3.SS3.SSS0.Px2.p1.4.m4.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S3.SS3.SSS0.Px2.p1.4.m4.1a"><mi id="S3.SS3.SSS0.Px2.p1.4.m4.1.1" xref="S3.SS3.SSS0.Px2.p1.4.m4.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.4.m4.1b"><ci id="S3.SS3.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.4.m4.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.4.m4.1c">G</annotation></semantics></math> and the real-world positional clues <math id="S3.SS3.SSS0.Px2.p1.5.m5.1" class="ltx_Math" alttext="P\in\mathbb{R}^{R\times A\times 4}" display="inline"><semantics id="S3.SS3.SSS0.Px2.p1.5.m5.1a"><mrow id="S3.SS3.SSS0.Px2.p1.5.m5.1.1" xref="S3.SS3.SSS0.Px2.p1.5.m5.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.5.m5.1.1.2" xref="S3.SS3.SSS0.Px2.p1.5.m5.1.1.2.cmml">P</mi><mo id="S3.SS3.SSS0.Px2.p1.5.m5.1.1.1" xref="S3.SS3.SSS0.Px2.p1.5.m5.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS0.Px2.p1.5.m5.1.1.3" xref="S3.SS3.SSS0.Px2.p1.5.m5.1.1.3.cmml"><mi id="S3.SS3.SSS0.Px2.p1.5.m5.1.1.3.2" xref="S3.SS3.SSS0.Px2.p1.5.m5.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS0.Px2.p1.5.m5.1.1.3.3" xref="S3.SS3.SSS0.Px2.p1.5.m5.1.1.3.3.cmml"><mi id="S3.SS3.SSS0.Px2.p1.5.m5.1.1.3.3.2" xref="S3.SS3.SSS0.Px2.p1.5.m5.1.1.3.3.2.cmml">R</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.SSS0.Px2.p1.5.m5.1.1.3.3.1" xref="S3.SS3.SSS0.Px2.p1.5.m5.1.1.3.3.1.cmml">×</mo><mi id="S3.SS3.SSS0.Px2.p1.5.m5.1.1.3.3.3" xref="S3.SS3.SSS0.Px2.p1.5.m5.1.1.3.3.3.cmml">A</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.SSS0.Px2.p1.5.m5.1.1.3.3.1a" xref="S3.SS3.SSS0.Px2.p1.5.m5.1.1.3.3.1.cmml">×</mo><mn id="S3.SS3.SSS0.Px2.p1.5.m5.1.1.3.3.4" xref="S3.SS3.SSS0.Px2.p1.5.m5.1.1.3.3.4.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.5.m5.1b"><apply id="S3.SS3.SSS0.Px2.p1.5.m5.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.5.m5.1.1"><in id="S3.SS3.SSS0.Px2.p1.5.m5.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.5.m5.1.1.1"></in><ci id="S3.SS3.SSS0.Px2.p1.5.m5.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.5.m5.1.1.2">𝑃</ci><apply id="S3.SS3.SSS0.Px2.p1.5.m5.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.5.m5.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.5.m5.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.5.m5.1.1.3.2.cmml" xref="S3.SS3.SSS0.Px2.p1.5.m5.1.1.3.2">ℝ</ci><apply id="S3.SS3.SSS0.Px2.p1.5.m5.1.1.3.3.cmml" xref="S3.SS3.SSS0.Px2.p1.5.m5.1.1.3.3"><times id="S3.SS3.SSS0.Px2.p1.5.m5.1.1.3.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.5.m5.1.1.3.3.1"></times><ci id="S3.SS3.SSS0.Px2.p1.5.m5.1.1.3.3.2.cmml" xref="S3.SS3.SSS0.Px2.p1.5.m5.1.1.3.3.2">𝑅</ci><ci id="S3.SS3.SSS0.Px2.p1.5.m5.1.1.3.3.3.cmml" xref="S3.SS3.SSS0.Px2.p1.5.m5.1.1.3.3.3">𝐴</ci><cn type="integer" id="S3.SS3.SSS0.Px2.p1.5.m5.1.1.3.3.4.cmml" xref="S3.SS3.SSS0.Px2.p1.5.m5.1.1.3.3.4">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.5.m5.1c">P\in\mathbb{R}^{R\times A\times 4}</annotation></semantics></math>:</p>
<table id="S3.E10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E10.m1.3" class="ltx_Math" alttext="F^{geo}=MLP(Cat([G,P]))." display="block"><semantics id="S3.E10.m1.3a"><mrow id="S3.E10.m1.3.3.1" xref="S3.E10.m1.3.3.1.1.cmml"><mrow id="S3.E10.m1.3.3.1.1" xref="S3.E10.m1.3.3.1.1.cmml"><msup id="S3.E10.m1.3.3.1.1.3" xref="S3.E10.m1.3.3.1.1.3.cmml"><mi id="S3.E10.m1.3.3.1.1.3.2" xref="S3.E10.m1.3.3.1.1.3.2.cmml">F</mi><mrow id="S3.E10.m1.3.3.1.1.3.3" xref="S3.E10.m1.3.3.1.1.3.3.cmml"><mi id="S3.E10.m1.3.3.1.1.3.3.2" xref="S3.E10.m1.3.3.1.1.3.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.3.3.1.1.3.3.1" xref="S3.E10.m1.3.3.1.1.3.3.1.cmml">​</mo><mi id="S3.E10.m1.3.3.1.1.3.3.3" xref="S3.E10.m1.3.3.1.1.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.3.3.1.1.3.3.1a" xref="S3.E10.m1.3.3.1.1.3.3.1.cmml">​</mo><mi id="S3.E10.m1.3.3.1.1.3.3.4" xref="S3.E10.m1.3.3.1.1.3.3.4.cmml">o</mi></mrow></msup><mo id="S3.E10.m1.3.3.1.1.2" xref="S3.E10.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.E10.m1.3.3.1.1.1" xref="S3.E10.m1.3.3.1.1.1.cmml"><mi id="S3.E10.m1.3.3.1.1.1.3" xref="S3.E10.m1.3.3.1.1.1.3.cmml">M</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.3.3.1.1.1.2" xref="S3.E10.m1.3.3.1.1.1.2.cmml">​</mo><mi id="S3.E10.m1.3.3.1.1.1.4" xref="S3.E10.m1.3.3.1.1.1.4.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.3.3.1.1.1.2a" xref="S3.E10.m1.3.3.1.1.1.2.cmml">​</mo><mi id="S3.E10.m1.3.3.1.1.1.5" xref="S3.E10.m1.3.3.1.1.1.5.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.3.3.1.1.1.2b" xref="S3.E10.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S3.E10.m1.3.3.1.1.1.1.1" xref="S3.E10.m1.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E10.m1.3.3.1.1.1.1.1.2" xref="S3.E10.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E10.m1.3.3.1.1.1.1.1.1" xref="S3.E10.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S3.E10.m1.3.3.1.1.1.1.1.1.3" xref="S3.E10.m1.3.3.1.1.1.1.1.1.3.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.3.3.1.1.1.1.1.1.2" xref="S3.E10.m1.3.3.1.1.1.1.1.1.2.cmml">​</mo><mi id="S3.E10.m1.3.3.1.1.1.1.1.1.4" xref="S3.E10.m1.3.3.1.1.1.1.1.1.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.3.3.1.1.1.1.1.1.2a" xref="S3.E10.m1.3.3.1.1.1.1.1.1.2.cmml">​</mo><mi id="S3.E10.m1.3.3.1.1.1.1.1.1.5" xref="S3.E10.m1.3.3.1.1.1.1.1.1.5.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.3.3.1.1.1.1.1.1.2b" xref="S3.E10.m1.3.3.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E10.m1.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S3.E10.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.2.1" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">[</mo><mi id="S3.E10.m1.1.1" xref="S3.E10.m1.1.1.cmml">G</mi><mo id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">,</mo><mi id="S3.E10.m1.2.2" xref="S3.E10.m1.2.2.cmml">P</mi><mo stretchy="false" id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">]</mo></mrow><mo stretchy="false" id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S3.E10.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E10.m1.3.3.1.1.1.1.1.3" xref="S3.E10.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E10.m1.3.3.1.2" xref="S3.E10.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.3b"><apply id="S3.E10.m1.3.3.1.1.cmml" xref="S3.E10.m1.3.3.1"><eq id="S3.E10.m1.3.3.1.1.2.cmml" xref="S3.E10.m1.3.3.1.1.2"></eq><apply id="S3.E10.m1.3.3.1.1.3.cmml" xref="S3.E10.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.3.3.1.1.3.1.cmml" xref="S3.E10.m1.3.3.1.1.3">superscript</csymbol><ci id="S3.E10.m1.3.3.1.1.3.2.cmml" xref="S3.E10.m1.3.3.1.1.3.2">𝐹</ci><apply id="S3.E10.m1.3.3.1.1.3.3.cmml" xref="S3.E10.m1.3.3.1.1.3.3"><times id="S3.E10.m1.3.3.1.1.3.3.1.cmml" xref="S3.E10.m1.3.3.1.1.3.3.1"></times><ci id="S3.E10.m1.3.3.1.1.3.3.2.cmml" xref="S3.E10.m1.3.3.1.1.3.3.2">𝑔</ci><ci id="S3.E10.m1.3.3.1.1.3.3.3.cmml" xref="S3.E10.m1.3.3.1.1.3.3.3">𝑒</ci><ci id="S3.E10.m1.3.3.1.1.3.3.4.cmml" xref="S3.E10.m1.3.3.1.1.3.3.4">𝑜</ci></apply></apply><apply id="S3.E10.m1.3.3.1.1.1.cmml" xref="S3.E10.m1.3.3.1.1.1"><times id="S3.E10.m1.3.3.1.1.1.2.cmml" xref="S3.E10.m1.3.3.1.1.1.2"></times><ci id="S3.E10.m1.3.3.1.1.1.3.cmml" xref="S3.E10.m1.3.3.1.1.1.3">𝑀</ci><ci id="S3.E10.m1.3.3.1.1.1.4.cmml" xref="S3.E10.m1.3.3.1.1.1.4">𝐿</ci><ci id="S3.E10.m1.3.3.1.1.1.5.cmml" xref="S3.E10.m1.3.3.1.1.1.5">𝑃</ci><apply id="S3.E10.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1"><times id="S3.E10.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.2"></times><ci id="S3.E10.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.3">𝐶</ci><ci id="S3.E10.m1.3.3.1.1.1.1.1.1.4.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.4">𝑎</ci><ci id="S3.E10.m1.3.3.1.1.1.1.1.1.5.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.5">𝑡</ci><interval closure="closed" id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.2"><ci id="S3.E10.m1.1.1.cmml" xref="S3.E10.m1.1.1">𝐺</ci><ci id="S3.E10.m1.2.2.cmml" xref="S3.E10.m1.2.2">𝑃</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.3c">F^{geo}=MLP(Cat([G,P])).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.SSS0.Px2.p1.15" class="ltx_p">Then, we divide <math id="S3.SS3.SSS0.Px2.p1.6.m1.1" class="ltx_Math" alttext="F^{geo}" display="inline"><semantics id="S3.SS3.SSS0.Px2.p1.6.m1.1a"><msup id="S3.SS3.SSS0.Px2.p1.6.m1.1.1" xref="S3.SS3.SSS0.Px2.p1.6.m1.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.6.m1.1.1.2" xref="S3.SS3.SSS0.Px2.p1.6.m1.1.1.2.cmml">F</mi><mrow id="S3.SS3.SSS0.Px2.p1.6.m1.1.1.3" xref="S3.SS3.SSS0.Px2.p1.6.m1.1.1.3.cmml"><mi id="S3.SS3.SSS0.Px2.p1.6.m1.1.1.3.2" xref="S3.SS3.SSS0.Px2.p1.6.m1.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px2.p1.6.m1.1.1.3.1" xref="S3.SS3.SSS0.Px2.p1.6.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px2.p1.6.m1.1.1.3.3" xref="S3.SS3.SSS0.Px2.p1.6.m1.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px2.p1.6.m1.1.1.3.1a" xref="S3.SS3.SSS0.Px2.p1.6.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px2.p1.6.m1.1.1.3.4" xref="S3.SS3.SSS0.Px2.p1.6.m1.1.1.3.4.cmml">o</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.6.m1.1b"><apply id="S3.SS3.SSS0.Px2.p1.6.m1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.6.m1.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m1.1.1">superscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.6.m1.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m1.1.1.2">𝐹</ci><apply id="S3.SS3.SSS0.Px2.p1.6.m1.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m1.1.1.3"><times id="S3.SS3.SSS0.Px2.p1.6.m1.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m1.1.1.3.1"></times><ci id="S3.SS3.SSS0.Px2.p1.6.m1.1.1.3.2.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m1.1.1.3.2">𝑔</ci><ci id="S3.SS3.SSS0.Px2.p1.6.m1.1.1.3.3.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m1.1.1.3.3">𝑒</ci><ci id="S3.SS3.SSS0.Px2.p1.6.m1.1.1.3.4.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m1.1.1.3.4">𝑜</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.6.m1.1c">F^{geo}</annotation></semantics></math> and <math id="S3.SS3.SSS0.Px2.p1.7.m2.1" class="ltx_Math" alttext="F^{neck}" display="inline"><semantics id="S3.SS3.SSS0.Px2.p1.7.m2.1a"><msup id="S3.SS3.SSS0.Px2.p1.7.m2.1.1" xref="S3.SS3.SSS0.Px2.p1.7.m2.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.7.m2.1.1.2" xref="S3.SS3.SSS0.Px2.p1.7.m2.1.1.2.cmml">F</mi><mrow id="S3.SS3.SSS0.Px2.p1.7.m2.1.1.3" xref="S3.SS3.SSS0.Px2.p1.7.m2.1.1.3.cmml"><mi id="S3.SS3.SSS0.Px2.p1.7.m2.1.1.3.2" xref="S3.SS3.SSS0.Px2.p1.7.m2.1.1.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px2.p1.7.m2.1.1.3.1" xref="S3.SS3.SSS0.Px2.p1.7.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px2.p1.7.m2.1.1.3.3" xref="S3.SS3.SSS0.Px2.p1.7.m2.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px2.p1.7.m2.1.1.3.1a" xref="S3.SS3.SSS0.Px2.p1.7.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px2.p1.7.m2.1.1.3.4" xref="S3.SS3.SSS0.Px2.p1.7.m2.1.1.3.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px2.p1.7.m2.1.1.3.1b" xref="S3.SS3.SSS0.Px2.p1.7.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px2.p1.7.m2.1.1.3.5" xref="S3.SS3.SSS0.Px2.p1.7.m2.1.1.3.5.cmml">k</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.7.m2.1b"><apply id="S3.SS3.SSS0.Px2.p1.7.m2.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.7.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.7.m2.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.7.m2.1.1">superscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.7.m2.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.7.m2.1.1.2">𝐹</ci><apply id="S3.SS3.SSS0.Px2.p1.7.m2.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p1.7.m2.1.1.3"><times id="S3.SS3.SSS0.Px2.p1.7.m2.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.7.m2.1.1.3.1"></times><ci id="S3.SS3.SSS0.Px2.p1.7.m2.1.1.3.2.cmml" xref="S3.SS3.SSS0.Px2.p1.7.m2.1.1.3.2">𝑛</ci><ci id="S3.SS3.SSS0.Px2.p1.7.m2.1.1.3.3.cmml" xref="S3.SS3.SSS0.Px2.p1.7.m2.1.1.3.3">𝑒</ci><ci id="S3.SS3.SSS0.Px2.p1.7.m2.1.1.3.4.cmml" xref="S3.SS3.SSS0.Px2.p1.7.m2.1.1.3.4">𝑐</ci><ci id="S3.SS3.SSS0.Px2.p1.7.m2.1.1.3.5.cmml" xref="S3.SS3.SSS0.Px2.p1.7.m2.1.1.3.5">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.7.m2.1c">F^{neck}</annotation></semantics></math> into non-overlapping windows with size <math id="S3.SS3.SSS0.Px2.p1.8.m3.1" class="ltx_Math" alttext="W_{g}\times W_{g}" display="inline"><semantics id="S3.SS3.SSS0.Px2.p1.8.m3.1a"><mrow id="S3.SS3.SSS0.Px2.p1.8.m3.1.1" xref="S3.SS3.SSS0.Px2.p1.8.m3.1.1.cmml"><msub id="S3.SS3.SSS0.Px2.p1.8.m3.1.1.2" xref="S3.SS3.SSS0.Px2.p1.8.m3.1.1.2.cmml"><mi id="S3.SS3.SSS0.Px2.p1.8.m3.1.1.2.2" xref="S3.SS3.SSS0.Px2.p1.8.m3.1.1.2.2.cmml">W</mi><mi id="S3.SS3.SSS0.Px2.p1.8.m3.1.1.2.3" xref="S3.SS3.SSS0.Px2.p1.8.m3.1.1.2.3.cmml">g</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.SSS0.Px2.p1.8.m3.1.1.1" xref="S3.SS3.SSS0.Px2.p1.8.m3.1.1.1.cmml">×</mo><msub id="S3.SS3.SSS0.Px2.p1.8.m3.1.1.3" xref="S3.SS3.SSS0.Px2.p1.8.m3.1.1.3.cmml"><mi id="S3.SS3.SSS0.Px2.p1.8.m3.1.1.3.2" xref="S3.SS3.SSS0.Px2.p1.8.m3.1.1.3.2.cmml">W</mi><mi id="S3.SS3.SSS0.Px2.p1.8.m3.1.1.3.3" xref="S3.SS3.SSS0.Px2.p1.8.m3.1.1.3.3.cmml">g</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.8.m3.1b"><apply id="S3.SS3.SSS0.Px2.p1.8.m3.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.8.m3.1.1"><times id="S3.SS3.SSS0.Px2.p1.8.m3.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.8.m3.1.1.1"></times><apply id="S3.SS3.SSS0.Px2.p1.8.m3.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.8.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.8.m3.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px2.p1.8.m3.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.8.m3.1.1.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.8.m3.1.1.2.2">𝑊</ci><ci id="S3.SS3.SSS0.Px2.p1.8.m3.1.1.2.3.cmml" xref="S3.SS3.SSS0.Px2.p1.8.m3.1.1.2.3">𝑔</ci></apply><apply id="S3.SS3.SSS0.Px2.p1.8.m3.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p1.8.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.8.m3.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.8.m3.1.1.3">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.8.m3.1.1.3.2.cmml" xref="S3.SS3.SSS0.Px2.p1.8.m3.1.1.3.2">𝑊</ci><ci id="S3.SS3.SSS0.Px2.p1.8.m3.1.1.3.3.cmml" xref="S3.SS3.SSS0.Px2.p1.8.m3.1.1.3.3">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.8.m3.1c">W_{g}\times W_{g}</annotation></semantics></math>. Let <math id="S3.SS3.SSS0.Px2.p1.9.m4.2" class="ltx_Math" alttext="F^{neck}_{i},F^{geo}_{i}\in\mathbb{R}^{W_{g}\times W_{g}\times C}" display="inline"><semantics id="S3.SS3.SSS0.Px2.p1.9.m4.2a"><mrow id="S3.SS3.SSS0.Px2.p1.9.m4.2.2" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.cmml"><mrow id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.2.2" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.2.3.cmml"><msubsup id="S3.SS3.SSS0.Px2.p1.9.m4.1.1.1.1.1" xref="S3.SS3.SSS0.Px2.p1.9.m4.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.9.m4.1.1.1.1.1.2.2" xref="S3.SS3.SSS0.Px2.p1.9.m4.1.1.1.1.1.2.2.cmml">F</mi><mi id="S3.SS3.SSS0.Px2.p1.9.m4.1.1.1.1.1.3" xref="S3.SS3.SSS0.Px2.p1.9.m4.1.1.1.1.1.3.cmml">i</mi><mrow id="S3.SS3.SSS0.Px2.p1.9.m4.1.1.1.1.1.2.3" xref="S3.SS3.SSS0.Px2.p1.9.m4.1.1.1.1.1.2.3.cmml"><mi id="S3.SS3.SSS0.Px2.p1.9.m4.1.1.1.1.1.2.3.2" xref="S3.SS3.SSS0.Px2.p1.9.m4.1.1.1.1.1.2.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px2.p1.9.m4.1.1.1.1.1.2.3.1" xref="S3.SS3.SSS0.Px2.p1.9.m4.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px2.p1.9.m4.1.1.1.1.1.2.3.3" xref="S3.SS3.SSS0.Px2.p1.9.m4.1.1.1.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px2.p1.9.m4.1.1.1.1.1.2.3.1a" xref="S3.SS3.SSS0.Px2.p1.9.m4.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px2.p1.9.m4.1.1.1.1.1.2.3.4" xref="S3.SS3.SSS0.Px2.p1.9.m4.1.1.1.1.1.2.3.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px2.p1.9.m4.1.1.1.1.1.2.3.1b" xref="S3.SS3.SSS0.Px2.p1.9.m4.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px2.p1.9.m4.1.1.1.1.1.2.3.5" xref="S3.SS3.SSS0.Px2.p1.9.m4.1.1.1.1.1.2.3.5.cmml">k</mi></mrow></msubsup><mo id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.2.2.3" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.2.3.cmml">,</mo><msubsup id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.2.2.2" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.2.2.2.cmml"><mi id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.2.2.2.2.2" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.2.2.2.2.2.cmml">F</mi><mi id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.2.2.2.3" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.2.2.2.3.cmml">i</mi><mrow id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.2.2.2.2.3" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.2.2.2.2.3.cmml"><mi id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.2.2.2.2.3.2" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.2.2.2.2.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.2.2.2.2.3.1" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.2.2.2.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.2.2.2.2.3.3" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.2.2.2.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.2.2.2.2.3.1a" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.2.2.2.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.2.2.2.2.3.4" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.2.2.2.2.3.4.cmml">o</mi></mrow></msubsup></mrow><mo id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.3" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.3.cmml">∈</mo><msup id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.cmml"><mi id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.2" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.3" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.3.cmml"><msub id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.3.2" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.3.2.cmml"><mi id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.3.2.2" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.3.2.2.cmml">W</mi><mi id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.3.2.3" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.3.2.3.cmml">g</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.3.1" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.3.1.cmml">×</mo><msub id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.3.3" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.3.3.cmml"><mi id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.3.3.2" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.3.3.2.cmml">W</mi><mi id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.3.3.3" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.3.3.3.cmml">g</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.3.1a" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.3.1.cmml">×</mo><mi id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.3.4" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.3.4.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.9.m4.2b"><apply id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2"><in id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.3.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.3"></in><list id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.2.3.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.2.2"><apply id="S3.SS3.SSS0.Px2.p1.9.m4.1.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.9.m4.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m4.1.1.1.1.1">subscript</csymbol><apply id="S3.SS3.SSS0.Px2.p1.9.m4.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.9.m4.1.1.1.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m4.1.1.1.1.1">superscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.9.m4.1.1.1.1.1.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m4.1.1.1.1.1.2.2">𝐹</ci><apply id="S3.SS3.SSS0.Px2.p1.9.m4.1.1.1.1.1.2.3.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m4.1.1.1.1.1.2.3"><times id="S3.SS3.SSS0.Px2.p1.9.m4.1.1.1.1.1.2.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m4.1.1.1.1.1.2.3.1"></times><ci id="S3.SS3.SSS0.Px2.p1.9.m4.1.1.1.1.1.2.3.2.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m4.1.1.1.1.1.2.3.2">𝑛</ci><ci id="S3.SS3.SSS0.Px2.p1.9.m4.1.1.1.1.1.2.3.3.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m4.1.1.1.1.1.2.3.3">𝑒</ci><ci id="S3.SS3.SSS0.Px2.p1.9.m4.1.1.1.1.1.2.3.4.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m4.1.1.1.1.1.2.3.4">𝑐</ci><ci id="S3.SS3.SSS0.Px2.p1.9.m4.1.1.1.1.1.2.3.5.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m4.1.1.1.1.1.2.3.5">𝑘</ci></apply></apply><ci id="S3.SS3.SSS0.Px2.p1.9.m4.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m4.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.2.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.2.2.2.1.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.2.2.2">subscript</csymbol><apply id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.2.2.2.2.1.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.2.2.2">superscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.2.2.2.2.2">𝐹</ci><apply id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.2.2.2.2.3.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.2.2.2.2.3"><times id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.2.2.2.2.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.2.2.2.2.3.1"></times><ci id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.2.2.2.2.3.2.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.2.2.2.2.3.2">𝑔</ci><ci id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.2.2.2.2.3.3.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.2.2.2.2.3.3">𝑒</ci><ci id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.2.2.2.2.3.4.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.2.2.2.2.3.4">𝑜</ci></apply></apply><ci id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.2.2.2.3.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.2.2.2.3">𝑖</ci></apply></list><apply id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.1.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4">superscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.2.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.2">ℝ</ci><apply id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.3.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.3"><times id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.3.1"></times><apply id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.3.2.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.3.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.3.2.1.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.3.2">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.3.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.3.2.2">𝑊</ci><ci id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.3.2.3.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.3.2.3">𝑔</ci></apply><apply id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.3.3.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.3.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.3.3">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.3.3.2.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.3.3.2">𝑊</ci><ci id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.3.3.3.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.3.3.3">𝑔</ci></apply><ci id="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.3.4.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m4.2.2.4.3.4">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.9.m4.2c">F^{neck}_{i},F^{geo}_{i}\in\mathbb{R}^{W_{g}\times W_{g}\times C}</annotation></semantics></math> be the feature of <math id="S3.SS3.SSS0.Px2.p1.10.m5.1" class="ltx_Math" alttext="F^{neck}" display="inline"><semantics id="S3.SS3.SSS0.Px2.p1.10.m5.1a"><msup id="S3.SS3.SSS0.Px2.p1.10.m5.1.1" xref="S3.SS3.SSS0.Px2.p1.10.m5.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.10.m5.1.1.2" xref="S3.SS3.SSS0.Px2.p1.10.m5.1.1.2.cmml">F</mi><mrow id="S3.SS3.SSS0.Px2.p1.10.m5.1.1.3" xref="S3.SS3.SSS0.Px2.p1.10.m5.1.1.3.cmml"><mi id="S3.SS3.SSS0.Px2.p1.10.m5.1.1.3.2" xref="S3.SS3.SSS0.Px2.p1.10.m5.1.1.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px2.p1.10.m5.1.1.3.1" xref="S3.SS3.SSS0.Px2.p1.10.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px2.p1.10.m5.1.1.3.3" xref="S3.SS3.SSS0.Px2.p1.10.m5.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px2.p1.10.m5.1.1.3.1a" xref="S3.SS3.SSS0.Px2.p1.10.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px2.p1.10.m5.1.1.3.4" xref="S3.SS3.SSS0.Px2.p1.10.m5.1.1.3.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px2.p1.10.m5.1.1.3.1b" xref="S3.SS3.SSS0.Px2.p1.10.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px2.p1.10.m5.1.1.3.5" xref="S3.SS3.SSS0.Px2.p1.10.m5.1.1.3.5.cmml">k</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.10.m5.1b"><apply id="S3.SS3.SSS0.Px2.p1.10.m5.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.10.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.10.m5.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.10.m5.1.1">superscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.10.m5.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.10.m5.1.1.2">𝐹</ci><apply id="S3.SS3.SSS0.Px2.p1.10.m5.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p1.10.m5.1.1.3"><times id="S3.SS3.SSS0.Px2.p1.10.m5.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.10.m5.1.1.3.1"></times><ci id="S3.SS3.SSS0.Px2.p1.10.m5.1.1.3.2.cmml" xref="S3.SS3.SSS0.Px2.p1.10.m5.1.1.3.2">𝑛</ci><ci id="S3.SS3.SSS0.Px2.p1.10.m5.1.1.3.3.cmml" xref="S3.SS3.SSS0.Px2.p1.10.m5.1.1.3.3">𝑒</ci><ci id="S3.SS3.SSS0.Px2.p1.10.m5.1.1.3.4.cmml" xref="S3.SS3.SSS0.Px2.p1.10.m5.1.1.3.4">𝑐</ci><ci id="S3.SS3.SSS0.Px2.p1.10.m5.1.1.3.5.cmml" xref="S3.SS3.SSS0.Px2.p1.10.m5.1.1.3.5">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.10.m5.1c">F^{neck}</annotation></semantics></math> and <math id="S3.SS3.SSS0.Px2.p1.11.m6.1" class="ltx_Math" alttext="F^{geo}" display="inline"><semantics id="S3.SS3.SSS0.Px2.p1.11.m6.1a"><msup id="S3.SS3.SSS0.Px2.p1.11.m6.1.1" xref="S3.SS3.SSS0.Px2.p1.11.m6.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.11.m6.1.1.2" xref="S3.SS3.SSS0.Px2.p1.11.m6.1.1.2.cmml">F</mi><mrow id="S3.SS3.SSS0.Px2.p1.11.m6.1.1.3" xref="S3.SS3.SSS0.Px2.p1.11.m6.1.1.3.cmml"><mi id="S3.SS3.SSS0.Px2.p1.11.m6.1.1.3.2" xref="S3.SS3.SSS0.Px2.p1.11.m6.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px2.p1.11.m6.1.1.3.1" xref="S3.SS3.SSS0.Px2.p1.11.m6.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px2.p1.11.m6.1.1.3.3" xref="S3.SS3.SSS0.Px2.p1.11.m6.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px2.p1.11.m6.1.1.3.1a" xref="S3.SS3.SSS0.Px2.p1.11.m6.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px2.p1.11.m6.1.1.3.4" xref="S3.SS3.SSS0.Px2.p1.11.m6.1.1.3.4.cmml">o</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.11.m6.1b"><apply id="S3.SS3.SSS0.Px2.p1.11.m6.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.11.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.11.m6.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.11.m6.1.1">superscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.11.m6.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.11.m6.1.1.2">𝐹</ci><apply id="S3.SS3.SSS0.Px2.p1.11.m6.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p1.11.m6.1.1.3"><times id="S3.SS3.SSS0.Px2.p1.11.m6.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.11.m6.1.1.3.1"></times><ci id="S3.SS3.SSS0.Px2.p1.11.m6.1.1.3.2.cmml" xref="S3.SS3.SSS0.Px2.p1.11.m6.1.1.3.2">𝑔</ci><ci id="S3.SS3.SSS0.Px2.p1.11.m6.1.1.3.3.cmml" xref="S3.SS3.SSS0.Px2.p1.11.m6.1.1.3.3">𝑒</ci><ci id="S3.SS3.SSS0.Px2.p1.11.m6.1.1.3.4.cmml" xref="S3.SS3.SSS0.Px2.p1.11.m6.1.1.3.4">𝑜</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.11.m6.1c">F^{geo}</annotation></semantics></math> in the <math id="S3.SS3.SSS0.Px2.p1.12.m7.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS3.SSS0.Px2.p1.12.m7.1a"><mi id="S3.SS3.SSS0.Px2.p1.12.m7.1.1" xref="S3.SS3.SSS0.Px2.p1.12.m7.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.12.m7.1b"><ci id="S3.SS3.SSS0.Px2.p1.12.m7.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.12.m7.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.12.m7.1c">i</annotation></semantics></math>-th window, then the query <math id="S3.SS3.SSS0.Px2.p1.13.m8.1" class="ltx_Math" alttext="Q_{i}" display="inline"><semantics id="S3.SS3.SSS0.Px2.p1.13.m8.1a"><msub id="S3.SS3.SSS0.Px2.p1.13.m8.1.1" xref="S3.SS3.SSS0.Px2.p1.13.m8.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.13.m8.1.1.2" xref="S3.SS3.SSS0.Px2.p1.13.m8.1.1.2.cmml">Q</mi><mi id="S3.SS3.SSS0.Px2.p1.13.m8.1.1.3" xref="S3.SS3.SSS0.Px2.p1.13.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.13.m8.1b"><apply id="S3.SS3.SSS0.Px2.p1.13.m8.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.13.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.13.m8.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.13.m8.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.13.m8.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.13.m8.1.1.2">𝑄</ci><ci id="S3.SS3.SSS0.Px2.p1.13.m8.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p1.13.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.13.m8.1c">Q_{i}</annotation></semantics></math>, key <math id="S3.SS3.SSS0.Px2.p1.14.m9.1" class="ltx_Math" alttext="K_{i}" display="inline"><semantics id="S3.SS3.SSS0.Px2.p1.14.m9.1a"><msub id="S3.SS3.SSS0.Px2.p1.14.m9.1.1" xref="S3.SS3.SSS0.Px2.p1.14.m9.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.14.m9.1.1.2" xref="S3.SS3.SSS0.Px2.p1.14.m9.1.1.2.cmml">K</mi><mi id="S3.SS3.SSS0.Px2.p1.14.m9.1.1.3" xref="S3.SS3.SSS0.Px2.p1.14.m9.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.14.m9.1b"><apply id="S3.SS3.SSS0.Px2.p1.14.m9.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.14.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.14.m9.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.14.m9.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.14.m9.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.14.m9.1.1.2">𝐾</ci><ci id="S3.SS3.SSS0.Px2.p1.14.m9.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p1.14.m9.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.14.m9.1c">K_{i}</annotation></semantics></math> and value <math id="S3.SS3.SSS0.Px2.p1.15.m10.1" class="ltx_Math" alttext="V_{i}" display="inline"><semantics id="S3.SS3.SSS0.Px2.p1.15.m10.1a"><msub id="S3.SS3.SSS0.Px2.p1.15.m10.1.1" xref="S3.SS3.SSS0.Px2.p1.15.m10.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.15.m10.1.1.2" xref="S3.SS3.SSS0.Px2.p1.15.m10.1.1.2.cmml">V</mi><mi id="S3.SS3.SSS0.Px2.p1.15.m10.1.1.3" xref="S3.SS3.SSS0.Px2.p1.15.m10.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.15.m10.1b"><apply id="S3.SS3.SSS0.Px2.p1.15.m10.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.15.m10.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.15.m10.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.15.m10.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.15.m10.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.15.m10.1.1.2">𝑉</ci><ci id="S3.SS3.SSS0.Px2.p1.15.m10.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p1.15.m10.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.15.m10.1c">V_{i}</annotation></semantics></math> can be calculated as Eq. <a href="#S3.E11" title="In Geometry-aware aggregation. ‣ 3.3 Geometry-aware adaptive module ‣ 3 Method ‣ PARTNER: Level up the Polar Representation for LiDAR 3D Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a>.</p>
</div>
<div id="S3.SS3.SSS0.Px2.p2" class="ltx_para">
<table id="S3.E11" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E11X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E11X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle Q_{i}=F^{neck}_{i}W_{q}+F_{i}^{geo}," display="inline"><semantics id="S3.E11X.2.1.1.m1.1a"><mrow id="S3.E11X.2.1.1.m1.1.1.1" xref="S3.E11X.2.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E11X.2.1.1.m1.1.1.1.1" xref="S3.E11X.2.1.1.m1.1.1.1.1.cmml"><msub id="S3.E11X.2.1.1.m1.1.1.1.1.2" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.cmml"><mi id="S3.E11X.2.1.1.m1.1.1.1.1.2.2" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.2.cmml">Q</mi><mi id="S3.E11X.2.1.1.m1.1.1.1.1.2.3" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.E11X.2.1.1.m1.1.1.1.1.1" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E11X.2.1.1.m1.1.1.1.1.3" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.cmml"><mrow id="S3.E11X.2.1.1.m1.1.1.1.1.3.2" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.2.cmml"><msubsup id="S3.E11X.2.1.1.m1.1.1.1.1.3.2.2" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.2.2.cmml"><mi id="S3.E11X.2.1.1.m1.1.1.1.1.3.2.2.2.2" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.2.2.2.2.cmml">F</mi><mi id="S3.E11X.2.1.1.m1.1.1.1.1.3.2.2.3" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.2.2.3.cmml">i</mi><mrow id="S3.E11X.2.1.1.m1.1.1.1.1.3.2.2.2.3" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.2.2.2.3.cmml"><mi id="S3.E11X.2.1.1.m1.1.1.1.1.3.2.2.2.3.2" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.2.2.2.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E11X.2.1.1.m1.1.1.1.1.3.2.2.2.3.1" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.2.2.2.3.1.cmml">​</mo><mi id="S3.E11X.2.1.1.m1.1.1.1.1.3.2.2.2.3.3" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.2.2.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E11X.2.1.1.m1.1.1.1.1.3.2.2.2.3.1a" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.2.2.2.3.1.cmml">​</mo><mi id="S3.E11X.2.1.1.m1.1.1.1.1.3.2.2.2.3.4" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.2.2.2.3.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E11X.2.1.1.m1.1.1.1.1.3.2.2.2.3.1b" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.2.2.2.3.1.cmml">​</mo><mi id="S3.E11X.2.1.1.m1.1.1.1.1.3.2.2.2.3.5" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.2.2.2.3.5.cmml">k</mi></mrow></msubsup><mo lspace="0em" rspace="0em" id="S3.E11X.2.1.1.m1.1.1.1.1.3.2.1" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.2.1.cmml">​</mo><msub id="S3.E11X.2.1.1.m1.1.1.1.1.3.2.3" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.2.3.cmml"><mi id="S3.E11X.2.1.1.m1.1.1.1.1.3.2.3.2" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.2.3.2.cmml">W</mi><mi id="S3.E11X.2.1.1.m1.1.1.1.1.3.2.3.3" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.2.3.3.cmml">q</mi></msub></mrow><mo id="S3.E11X.2.1.1.m1.1.1.1.1.3.1" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.1.cmml">+</mo><msubsup id="S3.E11X.2.1.1.m1.1.1.1.1.3.3" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.3.cmml"><mi id="S3.E11X.2.1.1.m1.1.1.1.1.3.3.2.2" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.3.2.2.cmml">F</mi><mi id="S3.E11X.2.1.1.m1.1.1.1.1.3.3.2.3" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.3.2.3.cmml">i</mi><mrow id="S3.E11X.2.1.1.m1.1.1.1.1.3.3.3" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.3.3.cmml"><mi id="S3.E11X.2.1.1.m1.1.1.1.1.3.3.3.2" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.3.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E11X.2.1.1.m1.1.1.1.1.3.3.3.1" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E11X.2.1.1.m1.1.1.1.1.3.3.3.3" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E11X.2.1.1.m1.1.1.1.1.3.3.3.1a" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E11X.2.1.1.m1.1.1.1.1.3.3.3.4" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.3.3.4.cmml">o</mi></mrow></msubsup></mrow></mrow><mo id="S3.E11X.2.1.1.m1.1.1.1.2" xref="S3.E11X.2.1.1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E11X.2.1.1.m1.1b"><apply id="S3.E11X.2.1.1.m1.1.1.1.1.cmml" xref="S3.E11X.2.1.1.m1.1.1.1"><eq id="S3.E11X.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.1"></eq><apply id="S3.E11X.2.1.1.m1.1.1.1.1.2.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E11X.2.1.1.m1.1.1.1.1.2.1.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E11X.2.1.1.m1.1.1.1.1.2.2.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.2">𝑄</ci><ci id="S3.E11X.2.1.1.m1.1.1.1.1.2.3.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E11X.2.1.1.m1.1.1.1.1.3.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.3"><plus id="S3.E11X.2.1.1.m1.1.1.1.1.3.1.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.1"></plus><apply id="S3.E11X.2.1.1.m1.1.1.1.1.3.2.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.2"><times id="S3.E11X.2.1.1.m1.1.1.1.1.3.2.1.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.2.1"></times><apply id="S3.E11X.2.1.1.m1.1.1.1.1.3.2.2.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E11X.2.1.1.m1.1.1.1.1.3.2.2.1.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.2.2">subscript</csymbol><apply id="S3.E11X.2.1.1.m1.1.1.1.1.3.2.2.2.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E11X.2.1.1.m1.1.1.1.1.3.2.2.2.1.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.2.2">superscript</csymbol><ci id="S3.E11X.2.1.1.m1.1.1.1.1.3.2.2.2.2.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.2.2.2.2">𝐹</ci><apply id="S3.E11X.2.1.1.m1.1.1.1.1.3.2.2.2.3.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.2.2.2.3"><times id="S3.E11X.2.1.1.m1.1.1.1.1.3.2.2.2.3.1.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.2.2.2.3.1"></times><ci id="S3.E11X.2.1.1.m1.1.1.1.1.3.2.2.2.3.2.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.2.2.2.3.2">𝑛</ci><ci id="S3.E11X.2.1.1.m1.1.1.1.1.3.2.2.2.3.3.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.2.2.2.3.3">𝑒</ci><ci id="S3.E11X.2.1.1.m1.1.1.1.1.3.2.2.2.3.4.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.2.2.2.3.4">𝑐</ci><ci id="S3.E11X.2.1.1.m1.1.1.1.1.3.2.2.2.3.5.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.2.2.2.3.5">𝑘</ci></apply></apply><ci id="S3.E11X.2.1.1.m1.1.1.1.1.3.2.2.3.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.2.2.3">𝑖</ci></apply><apply id="S3.E11X.2.1.1.m1.1.1.1.1.3.2.3.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E11X.2.1.1.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.2.3">subscript</csymbol><ci id="S3.E11X.2.1.1.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.2.3.2">𝑊</ci><ci id="S3.E11X.2.1.1.m1.1.1.1.1.3.2.3.3.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.2.3.3">𝑞</ci></apply></apply><apply id="S3.E11X.2.1.1.m1.1.1.1.1.3.3.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E11X.2.1.1.m1.1.1.1.1.3.3.1.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.3">superscript</csymbol><apply id="S3.E11X.2.1.1.m1.1.1.1.1.3.3.2.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E11X.2.1.1.m1.1.1.1.1.3.3.2.1.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E11X.2.1.1.m1.1.1.1.1.3.3.2.2.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.3.2.2">𝐹</ci><ci id="S3.E11X.2.1.1.m1.1.1.1.1.3.3.2.3.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.3.2.3">𝑖</ci></apply><apply id="S3.E11X.2.1.1.m1.1.1.1.1.3.3.3.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.3.3"><times id="S3.E11X.2.1.1.m1.1.1.1.1.3.3.3.1.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.3.3.1"></times><ci id="S3.E11X.2.1.1.m1.1.1.1.1.3.3.3.2.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.3.3.2">𝑔</ci><ci id="S3.E11X.2.1.1.m1.1.1.1.1.3.3.3.3.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.3.3.3">𝑒</ci><ci id="S3.E11X.2.1.1.m1.1.1.1.1.3.3.3.4.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.3.3.4">𝑜</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11X.2.1.1.m1.1c">\displaystyle Q_{i}=F^{neck}_{i}W_{q}+F_{i}^{geo},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="3" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(11)</span></td>
</tr>
<tr id="S3.E11Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E11Xa.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle K_{i}=F^{neck}_{i}W_{k}+F_{i}^{geo}," display="inline"><semantics id="S3.E11Xa.2.1.1.m1.1a"><mrow id="S3.E11Xa.2.1.1.m1.1.1.1" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E11Xa.2.1.1.m1.1.1.1.1" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.cmml"><msub id="S3.E11Xa.2.1.1.m1.1.1.1.1.2" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.2.cmml"><mi id="S3.E11Xa.2.1.1.m1.1.1.1.1.2.2" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.2.2.cmml">K</mi><mi id="S3.E11Xa.2.1.1.m1.1.1.1.1.2.3" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.E11Xa.2.1.1.m1.1.1.1.1.1" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E11Xa.2.1.1.m1.1.1.1.1.3" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.cmml"><mrow id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.cmml"><msubsup id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.2" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.2.cmml"><mi id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.2.2.2" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.2.2.2.cmml">F</mi><mi id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.2.3" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.2.3.cmml">i</mi><mrow id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.2.2.3" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.2.2.3.cmml"><mi id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.2.2.3.2" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.2.2.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.2.2.3.1" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.2.2.3.1.cmml">​</mo><mi id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.2.2.3.3" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.2.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.2.2.3.1a" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.2.2.3.1.cmml">​</mo><mi id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.2.2.3.4" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.2.2.3.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.2.2.3.1b" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.2.2.3.1.cmml">​</mo><mi id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.2.2.3.5" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.2.2.3.5.cmml">k</mi></mrow></msubsup><mo lspace="0em" rspace="0em" id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.1" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.1.cmml">​</mo><msub id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.3" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.3.cmml"><mi id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.3.2" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.3.2.cmml">W</mi><mi id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.3.3" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.3.3.cmml">k</mi></msub></mrow><mo id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.1" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.1.cmml">+</mo><msubsup id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.3" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.3.cmml"><mi id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.3.2.2" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.3.2.2.cmml">F</mi><mi id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.3.2.3" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.3.2.3.cmml">i</mi><mrow id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.3.3" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.3.3.cmml"><mi id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.3.3.2" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.3.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.3.3.1" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.3.3.3" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.3.3.1a" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.3.3.4" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.3.3.4.cmml">o</mi></mrow></msubsup></mrow></mrow><mo id="S3.E11Xa.2.1.1.m1.1.1.1.2" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E11Xa.2.1.1.m1.1b"><apply id="S3.E11Xa.2.1.1.m1.1.1.1.1.cmml" xref="S3.E11Xa.2.1.1.m1.1.1.1"><eq id="S3.E11Xa.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.1"></eq><apply id="S3.E11Xa.2.1.1.m1.1.1.1.1.2.cmml" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E11Xa.2.1.1.m1.1.1.1.1.2.1.cmml" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E11Xa.2.1.1.m1.1.1.1.1.2.2.cmml" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.2.2">𝐾</ci><ci id="S3.E11Xa.2.1.1.m1.1.1.1.1.2.3.cmml" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.cmml" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3"><plus id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.1.cmml" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.1"></plus><apply id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.cmml" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2"><times id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.1.cmml" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.1"></times><apply id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.2.cmml" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.2.1.cmml" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.2">subscript</csymbol><apply id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.2.2.cmml" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.2.2.1.cmml" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.2">superscript</csymbol><ci id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.2.2.2.cmml" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.2.2.2">𝐹</ci><apply id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.2.2.3.cmml" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.2.2.3"><times id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.2.2.3.1.cmml" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.2.2.3.1"></times><ci id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.2.2.3.2.cmml" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.2.2.3.2">𝑛</ci><ci id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.2.2.3.3.cmml" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.2.2.3.3">𝑒</ci><ci id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.2.2.3.4.cmml" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.2.2.3.4">𝑐</ci><ci id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.2.2.3.5.cmml" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.2.2.3.5">𝑘</ci></apply></apply><ci id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.2.3.cmml" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.2.3">𝑖</ci></apply><apply id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.3.cmml" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.3">subscript</csymbol><ci id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.3.2">𝑊</ci><ci id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.3.3.cmml" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.2.3.3">𝑘</ci></apply></apply><apply id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.3.cmml" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.3.1.cmml" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.3">superscript</csymbol><apply id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.3.2.cmml" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.3.2.1.cmml" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.3.2.2.cmml" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.3.2.2">𝐹</ci><ci id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.3.2.3.cmml" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.3.2.3">𝑖</ci></apply><apply id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.3.3.cmml" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.3.3"><times id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.3.3.1.cmml" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.3.3.1"></times><ci id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.3.3.2.cmml" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.3.3.2">𝑔</ci><ci id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.3.3.3.cmml" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.3.3.3">𝑒</ci><ci id="S3.E11Xa.2.1.1.m1.1.1.1.1.3.3.3.4.cmml" xref="S3.E11Xa.2.1.1.m1.1.1.1.1.3.3.3.4">𝑜</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11Xa.2.1.1.m1.1c">\displaystyle K_{i}=F^{neck}_{i}W_{k}+F_{i}^{geo},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S3.E11Xb" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E11Xb.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle V_{i}=F^{neck}_{i}W_{v}+F_{i}^{geo}." display="inline"><semantics id="S3.E11Xb.2.1.1.m1.1a"><mrow id="S3.E11Xb.2.1.1.m1.1.1.1" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E11Xb.2.1.1.m1.1.1.1.1" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.cmml"><msub id="S3.E11Xb.2.1.1.m1.1.1.1.1.2" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.2.cmml"><mi id="S3.E11Xb.2.1.1.m1.1.1.1.1.2.2" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.2.2.cmml">V</mi><mi id="S3.E11Xb.2.1.1.m1.1.1.1.1.2.3" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.E11Xb.2.1.1.m1.1.1.1.1.1" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E11Xb.2.1.1.m1.1.1.1.1.3" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.cmml"><mrow id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.cmml"><msubsup id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.2" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.2.cmml"><mi id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.2.2.2" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.2.2.2.cmml">F</mi><mi id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.2.3" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.2.3.cmml">i</mi><mrow id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.2.2.3" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.2.2.3.cmml"><mi id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.2.2.3.2" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.2.2.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.2.2.3.1" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.2.2.3.1.cmml">​</mo><mi id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.2.2.3.3" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.2.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.2.2.3.1a" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.2.2.3.1.cmml">​</mo><mi id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.2.2.3.4" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.2.2.3.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.2.2.3.1b" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.2.2.3.1.cmml">​</mo><mi id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.2.2.3.5" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.2.2.3.5.cmml">k</mi></mrow></msubsup><mo lspace="0em" rspace="0em" id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.1" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.1.cmml">​</mo><msub id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.3" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.3.cmml"><mi id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.3.2" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.3.2.cmml">W</mi><mi id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.3.3" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.3.3.cmml">v</mi></msub></mrow><mo id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.1" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.1.cmml">+</mo><msubsup id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.3" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.3.cmml"><mi id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.3.2.2" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.3.2.2.cmml">F</mi><mi id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.3.2.3" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.3.2.3.cmml">i</mi><mrow id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.3.3" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.3.3.cmml"><mi id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.3.3.2" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.3.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.3.3.1" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.3.3.3" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.3.3.1a" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.3.3.4" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.3.3.4.cmml">o</mi></mrow></msubsup></mrow></mrow><mo lspace="0em" id="S3.E11Xb.2.1.1.m1.1.1.1.2" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E11Xb.2.1.1.m1.1b"><apply id="S3.E11Xb.2.1.1.m1.1.1.1.1.cmml" xref="S3.E11Xb.2.1.1.m1.1.1.1"><eq id="S3.E11Xb.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.1"></eq><apply id="S3.E11Xb.2.1.1.m1.1.1.1.1.2.cmml" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E11Xb.2.1.1.m1.1.1.1.1.2.1.cmml" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E11Xb.2.1.1.m1.1.1.1.1.2.2.cmml" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.2.2">𝑉</ci><ci id="S3.E11Xb.2.1.1.m1.1.1.1.1.2.3.cmml" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.cmml" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3"><plus id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.1.cmml" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.1"></plus><apply id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.cmml" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2"><times id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.1.cmml" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.1"></times><apply id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.2.cmml" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.2.1.cmml" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.2">subscript</csymbol><apply id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.2.2.cmml" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.2.2.1.cmml" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.2">superscript</csymbol><ci id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.2.2.2.cmml" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.2.2.2">𝐹</ci><apply id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.2.2.3.cmml" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.2.2.3"><times id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.2.2.3.1.cmml" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.2.2.3.1"></times><ci id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.2.2.3.2.cmml" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.2.2.3.2">𝑛</ci><ci id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.2.2.3.3.cmml" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.2.2.3.3">𝑒</ci><ci id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.2.2.3.4.cmml" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.2.2.3.4">𝑐</ci><ci id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.2.2.3.5.cmml" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.2.2.3.5">𝑘</ci></apply></apply><ci id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.2.3.cmml" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.2.3">𝑖</ci></apply><apply id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.3.cmml" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.3">subscript</csymbol><ci id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.3.2">𝑊</ci><ci id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.3.3.cmml" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.2.3.3">𝑣</ci></apply></apply><apply id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.3.cmml" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.3.1.cmml" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.3">superscript</csymbol><apply id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.3.2.cmml" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.3.2.1.cmml" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.3.2.2.cmml" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.3.2.2">𝐹</ci><ci id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.3.2.3.cmml" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.3.2.3">𝑖</ci></apply><apply id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.3.3.cmml" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.3.3"><times id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.3.3.1.cmml" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.3.3.1"></times><ci id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.3.3.2.cmml" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.3.3.2">𝑔</ci><ci id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.3.3.3.cmml" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.3.3.3">𝑒</ci><ci id="S3.E11Xb.2.1.1.m1.1.1.1.1.3.3.3.4.cmml" xref="S3.E11Xb.2.1.1.m1.1.1.1.1.3.3.3.4">𝑜</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11Xb.2.1.1.m1.1c">\displaystyle V_{i}=F^{neck}_{i}W_{v}+F_{i}^{geo}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S3.SS3.SSS0.Px2.p2.1" class="ltx_p">After that, self-attention can be formulated as Eq. <a href="#S3.E12" title="In Geometry-aware aggregation. ‣ 3.3 Geometry-aware adaptive module ‣ 3 Method ‣ PARTNER: Level up the Polar Representation for LiDAR 3D Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">12</span></a> and we obtain the aggregated feature of the window <math id="S3.SS3.SSS0.Px2.p2.1.m1.1" class="ltx_Math" alttext="F^{agg}_{i}" display="inline"><semantics id="S3.SS3.SSS0.Px2.p2.1.m1.1a"><msubsup id="S3.SS3.SSS0.Px2.p2.1.m1.1.1" xref="S3.SS3.SSS0.Px2.p2.1.m1.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p2.1.m1.1.1.2.2" xref="S3.SS3.SSS0.Px2.p2.1.m1.1.1.2.2.cmml">F</mi><mi id="S3.SS3.SSS0.Px2.p2.1.m1.1.1.3" xref="S3.SS3.SSS0.Px2.p2.1.m1.1.1.3.cmml">i</mi><mrow id="S3.SS3.SSS0.Px2.p2.1.m1.1.1.2.3" xref="S3.SS3.SSS0.Px2.p2.1.m1.1.1.2.3.cmml"><mi id="S3.SS3.SSS0.Px2.p2.1.m1.1.1.2.3.2" xref="S3.SS3.SSS0.Px2.p2.1.m1.1.1.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px2.p2.1.m1.1.1.2.3.1" xref="S3.SS3.SSS0.Px2.p2.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px2.p2.1.m1.1.1.2.3.3" xref="S3.SS3.SSS0.Px2.p2.1.m1.1.1.2.3.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px2.p2.1.m1.1.1.2.3.1a" xref="S3.SS3.SSS0.Px2.p2.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px2.p2.1.m1.1.1.2.3.4" xref="S3.SS3.SSS0.Px2.p2.1.m1.1.1.2.3.4.cmml">g</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p2.1.m1.1b"><apply id="S3.SS3.SSS0.Px2.p2.1.m1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p2.1.m1.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p2.1.m1.1.1">subscript</csymbol><apply id="S3.SS3.SSS0.Px2.p2.1.m1.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p2.1.m1.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px2.p2.1.m1.1.1">superscript</csymbol><ci id="S3.SS3.SSS0.Px2.p2.1.m1.1.1.2.2.cmml" xref="S3.SS3.SSS0.Px2.p2.1.m1.1.1.2.2">𝐹</ci><apply id="S3.SS3.SSS0.Px2.p2.1.m1.1.1.2.3.cmml" xref="S3.SS3.SSS0.Px2.p2.1.m1.1.1.2.3"><times id="S3.SS3.SSS0.Px2.p2.1.m1.1.1.2.3.1.cmml" xref="S3.SS3.SSS0.Px2.p2.1.m1.1.1.2.3.1"></times><ci id="S3.SS3.SSS0.Px2.p2.1.m1.1.1.2.3.2.cmml" xref="S3.SS3.SSS0.Px2.p2.1.m1.1.1.2.3.2">𝑎</ci><ci id="S3.SS3.SSS0.Px2.p2.1.m1.1.1.2.3.3.cmml" xref="S3.SS3.SSS0.Px2.p2.1.m1.1.1.2.3.3">𝑔</ci><ci id="S3.SS3.SSS0.Px2.p2.1.m1.1.1.2.3.4.cmml" xref="S3.SS3.SSS0.Px2.p2.1.m1.1.1.2.3.4">𝑔</ci></apply></apply><ci id="S3.SS3.SSS0.Px2.p2.1.m1.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p2.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p2.1.m1.1c">F^{agg}_{i}</annotation></semantics></math>:</p>
<table id="S3.E12" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E12.m1.2" class="ltx_Math" alttext="F^{agg}_{i}=softmax(\frac{Q_{i}K_{i}^{T}}{\sqrt{d}})\cdot V_{i}." display="block"><semantics id="S3.E12.m1.2a"><mrow id="S3.E12.m1.2.2.1" xref="S3.E12.m1.2.2.1.1.cmml"><mrow id="S3.E12.m1.2.2.1.1" xref="S3.E12.m1.2.2.1.1.cmml"><msubsup id="S3.E12.m1.2.2.1.1.2" xref="S3.E12.m1.2.2.1.1.2.cmml"><mi id="S3.E12.m1.2.2.1.1.2.2.2" xref="S3.E12.m1.2.2.1.1.2.2.2.cmml">F</mi><mi id="S3.E12.m1.2.2.1.1.2.3" xref="S3.E12.m1.2.2.1.1.2.3.cmml">i</mi><mrow id="S3.E12.m1.2.2.1.1.2.2.3" xref="S3.E12.m1.2.2.1.1.2.2.3.cmml"><mi id="S3.E12.m1.2.2.1.1.2.2.3.2" xref="S3.E12.m1.2.2.1.1.2.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.2.2.1.1.2.2.3.1" xref="S3.E12.m1.2.2.1.1.2.2.3.1.cmml">​</mo><mi id="S3.E12.m1.2.2.1.1.2.2.3.3" xref="S3.E12.m1.2.2.1.1.2.2.3.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.2.2.1.1.2.2.3.1a" xref="S3.E12.m1.2.2.1.1.2.2.3.1.cmml">​</mo><mi id="S3.E12.m1.2.2.1.1.2.2.3.4" xref="S3.E12.m1.2.2.1.1.2.2.3.4.cmml">g</mi></mrow></msubsup><mo id="S3.E12.m1.2.2.1.1.1" xref="S3.E12.m1.2.2.1.1.1.cmml">=</mo><mrow id="S3.E12.m1.2.2.1.1.3" xref="S3.E12.m1.2.2.1.1.3.cmml"><mrow id="S3.E12.m1.2.2.1.1.3.2" xref="S3.E12.m1.2.2.1.1.3.2.cmml"><mi id="S3.E12.m1.2.2.1.1.3.2.2" xref="S3.E12.m1.2.2.1.1.3.2.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.2.2.1.1.3.2.1" xref="S3.E12.m1.2.2.1.1.3.2.1.cmml">​</mo><mi id="S3.E12.m1.2.2.1.1.3.2.3" xref="S3.E12.m1.2.2.1.1.3.2.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.2.2.1.1.3.2.1a" xref="S3.E12.m1.2.2.1.1.3.2.1.cmml">​</mo><mi id="S3.E12.m1.2.2.1.1.3.2.4" xref="S3.E12.m1.2.2.1.1.3.2.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.2.2.1.1.3.2.1b" xref="S3.E12.m1.2.2.1.1.3.2.1.cmml">​</mo><mi id="S3.E12.m1.2.2.1.1.3.2.5" xref="S3.E12.m1.2.2.1.1.3.2.5.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.2.2.1.1.3.2.1c" xref="S3.E12.m1.2.2.1.1.3.2.1.cmml">​</mo><mi id="S3.E12.m1.2.2.1.1.3.2.6" xref="S3.E12.m1.2.2.1.1.3.2.6.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.2.2.1.1.3.2.1d" xref="S3.E12.m1.2.2.1.1.3.2.1.cmml">​</mo><mi id="S3.E12.m1.2.2.1.1.3.2.7" xref="S3.E12.m1.2.2.1.1.3.2.7.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.2.2.1.1.3.2.1e" xref="S3.E12.m1.2.2.1.1.3.2.1.cmml">​</mo><mi id="S3.E12.m1.2.2.1.1.3.2.8" xref="S3.E12.m1.2.2.1.1.3.2.8.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.2.2.1.1.3.2.1f" xref="S3.E12.m1.2.2.1.1.3.2.1.cmml">​</mo><mrow id="S3.E12.m1.2.2.1.1.3.2.9.2" xref="S3.E12.m1.1.1.cmml"><mo stretchy="false" id="S3.E12.m1.2.2.1.1.3.2.9.2.1" xref="S3.E12.m1.1.1.cmml">(</mo><mfrac id="S3.E12.m1.1.1" xref="S3.E12.m1.1.1.cmml"><mrow id="S3.E12.m1.1.1.2" xref="S3.E12.m1.1.1.2.cmml"><msub id="S3.E12.m1.1.1.2.2" xref="S3.E12.m1.1.1.2.2.cmml"><mi id="S3.E12.m1.1.1.2.2.2" xref="S3.E12.m1.1.1.2.2.2.cmml">Q</mi><mi id="S3.E12.m1.1.1.2.2.3" xref="S3.E12.m1.1.1.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E12.m1.1.1.2.1" xref="S3.E12.m1.1.1.2.1.cmml">​</mo><msubsup id="S3.E12.m1.1.1.2.3" xref="S3.E12.m1.1.1.2.3.cmml"><mi id="S3.E12.m1.1.1.2.3.2.2" xref="S3.E12.m1.1.1.2.3.2.2.cmml">K</mi><mi id="S3.E12.m1.1.1.2.3.2.3" xref="S3.E12.m1.1.1.2.3.2.3.cmml">i</mi><mi id="S3.E12.m1.1.1.2.3.3" xref="S3.E12.m1.1.1.2.3.3.cmml">T</mi></msubsup></mrow><msqrt id="S3.E12.m1.1.1.3" xref="S3.E12.m1.1.1.3.cmml"><mi id="S3.E12.m1.1.1.3.2" xref="S3.E12.m1.1.1.3.2.cmml">d</mi></msqrt></mfrac><mo rspace="0.055em" stretchy="false" id="S3.E12.m1.2.2.1.1.3.2.9.2.2" xref="S3.E12.m1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="S3.E12.m1.2.2.1.1.3.1" xref="S3.E12.m1.2.2.1.1.3.1.cmml">⋅</mo><msub id="S3.E12.m1.2.2.1.1.3.3" xref="S3.E12.m1.2.2.1.1.3.3.cmml"><mi id="S3.E12.m1.2.2.1.1.3.3.2" xref="S3.E12.m1.2.2.1.1.3.3.2.cmml">V</mi><mi id="S3.E12.m1.2.2.1.1.3.3.3" xref="S3.E12.m1.2.2.1.1.3.3.3.cmml">i</mi></msub></mrow></mrow><mo lspace="0em" id="S3.E12.m1.2.2.1.2" xref="S3.E12.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E12.m1.2b"><apply id="S3.E12.m1.2.2.1.1.cmml" xref="S3.E12.m1.2.2.1"><eq id="S3.E12.m1.2.2.1.1.1.cmml" xref="S3.E12.m1.2.2.1.1.1"></eq><apply id="S3.E12.m1.2.2.1.1.2.cmml" xref="S3.E12.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E12.m1.2.2.1.1.2.1.cmml" xref="S3.E12.m1.2.2.1.1.2">subscript</csymbol><apply id="S3.E12.m1.2.2.1.1.2.2.cmml" xref="S3.E12.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E12.m1.2.2.1.1.2.2.1.cmml" xref="S3.E12.m1.2.2.1.1.2">superscript</csymbol><ci id="S3.E12.m1.2.2.1.1.2.2.2.cmml" xref="S3.E12.m1.2.2.1.1.2.2.2">𝐹</ci><apply id="S3.E12.m1.2.2.1.1.2.2.3.cmml" xref="S3.E12.m1.2.2.1.1.2.2.3"><times id="S3.E12.m1.2.2.1.1.2.2.3.1.cmml" xref="S3.E12.m1.2.2.1.1.2.2.3.1"></times><ci id="S3.E12.m1.2.2.1.1.2.2.3.2.cmml" xref="S3.E12.m1.2.2.1.1.2.2.3.2">𝑎</ci><ci id="S3.E12.m1.2.2.1.1.2.2.3.3.cmml" xref="S3.E12.m1.2.2.1.1.2.2.3.3">𝑔</ci><ci id="S3.E12.m1.2.2.1.1.2.2.3.4.cmml" xref="S3.E12.m1.2.2.1.1.2.2.3.4">𝑔</ci></apply></apply><ci id="S3.E12.m1.2.2.1.1.2.3.cmml" xref="S3.E12.m1.2.2.1.1.2.3">𝑖</ci></apply><apply id="S3.E12.m1.2.2.1.1.3.cmml" xref="S3.E12.m1.2.2.1.1.3"><ci id="S3.E12.m1.2.2.1.1.3.1.cmml" xref="S3.E12.m1.2.2.1.1.3.1">⋅</ci><apply id="S3.E12.m1.2.2.1.1.3.2.cmml" xref="S3.E12.m1.2.2.1.1.3.2"><times id="S3.E12.m1.2.2.1.1.3.2.1.cmml" xref="S3.E12.m1.2.2.1.1.3.2.1"></times><ci id="S3.E12.m1.2.2.1.1.3.2.2.cmml" xref="S3.E12.m1.2.2.1.1.3.2.2">𝑠</ci><ci id="S3.E12.m1.2.2.1.1.3.2.3.cmml" xref="S3.E12.m1.2.2.1.1.3.2.3">𝑜</ci><ci id="S3.E12.m1.2.2.1.1.3.2.4.cmml" xref="S3.E12.m1.2.2.1.1.3.2.4">𝑓</ci><ci id="S3.E12.m1.2.2.1.1.3.2.5.cmml" xref="S3.E12.m1.2.2.1.1.3.2.5">𝑡</ci><ci id="S3.E12.m1.2.2.1.1.3.2.6.cmml" xref="S3.E12.m1.2.2.1.1.3.2.6">𝑚</ci><ci id="S3.E12.m1.2.2.1.1.3.2.7.cmml" xref="S3.E12.m1.2.2.1.1.3.2.7">𝑎</ci><ci id="S3.E12.m1.2.2.1.1.3.2.8.cmml" xref="S3.E12.m1.2.2.1.1.3.2.8">𝑥</ci><apply id="S3.E12.m1.1.1.cmml" xref="S3.E12.m1.2.2.1.1.3.2.9.2"><divide id="S3.E12.m1.1.1.1.cmml" xref="S3.E12.m1.2.2.1.1.3.2.9.2"></divide><apply id="S3.E12.m1.1.1.2.cmml" xref="S3.E12.m1.1.1.2"><times id="S3.E12.m1.1.1.2.1.cmml" xref="S3.E12.m1.1.1.2.1"></times><apply id="S3.E12.m1.1.1.2.2.cmml" xref="S3.E12.m1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.2.2.1.cmml" xref="S3.E12.m1.1.1.2.2">subscript</csymbol><ci id="S3.E12.m1.1.1.2.2.2.cmml" xref="S3.E12.m1.1.1.2.2.2">𝑄</ci><ci id="S3.E12.m1.1.1.2.2.3.cmml" xref="S3.E12.m1.1.1.2.2.3">𝑖</ci></apply><apply id="S3.E12.m1.1.1.2.3.cmml" xref="S3.E12.m1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.2.3.1.cmml" xref="S3.E12.m1.1.1.2.3">superscript</csymbol><apply id="S3.E12.m1.1.1.2.3.2.cmml" xref="S3.E12.m1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.2.3.2.1.cmml" xref="S3.E12.m1.1.1.2.3">subscript</csymbol><ci id="S3.E12.m1.1.1.2.3.2.2.cmml" xref="S3.E12.m1.1.1.2.3.2.2">𝐾</ci><ci id="S3.E12.m1.1.1.2.3.2.3.cmml" xref="S3.E12.m1.1.1.2.3.2.3">𝑖</ci></apply><ci id="S3.E12.m1.1.1.2.3.3.cmml" xref="S3.E12.m1.1.1.2.3.3">𝑇</ci></apply></apply><apply id="S3.E12.m1.1.1.3.cmml" xref="S3.E12.m1.1.1.3"><root id="S3.E12.m1.1.1.3a.cmml" xref="S3.E12.m1.1.1.3"></root><ci id="S3.E12.m1.1.1.3.2.cmml" xref="S3.E12.m1.1.1.3.2">𝑑</ci></apply></apply></apply><apply id="S3.E12.m1.2.2.1.1.3.3.cmml" xref="S3.E12.m1.2.2.1.1.3.3"><csymbol cd="ambiguous" id="S3.E12.m1.2.2.1.1.3.3.1.cmml" xref="S3.E12.m1.2.2.1.1.3.3">subscript</csymbol><ci id="S3.E12.m1.2.2.1.1.3.3.2.cmml" xref="S3.E12.m1.2.2.1.1.3.3.2">𝑉</ci><ci id="S3.E12.m1.2.2.1.1.3.3.3.cmml" xref="S3.E12.m1.2.2.1.1.3.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.m1.2c">F^{agg}_{i}=softmax(\frac{Q_{i}K_{i}^{T}}{\sqrt{d}})\cdot V_{i}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.SSS0.Px2.p2.2" class="ltx_p">Similar to the global representation re-alignment module, we stack two geometry-aware aggregation modules with window shifting to enlarge the receptive field.</p>
</div>
<div id="S3.SS3.SSS0.Px2.p3" class="ltx_para">
<p id="S3.SS3.SSS0.Px2.p3.1" class="ltx_p">With the geometry-guided self-attention, the proposed module is capable of leveraging instance and geometric clues into the feature aggregation and learning process, producing features with rich prior for the following heads.</p>
</div>
</section>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Implementation of detection heads</h3>

<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.4" class="ltx_p">For simplicity, the design of the task heads follows CenterPoint <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>.
To demonstrate the scalability of our method, we also modify the task heads of CenterFormer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> in the main experiments.
We use smooth-<math id="S3.SS4.p1.1.m1.1" class="ltx_Math" alttext="l_{1}" display="inline"><semantics id="S3.SS4.p1.1.m1.1a"><msub id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml"><mi id="S3.SS4.p1.1.m1.1.1.2" xref="S3.SS4.p1.1.m1.1.1.2.cmml">l</mi><mn id="S3.SS4.p1.1.m1.1.1.3" xref="S3.SS4.p1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><apply id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.1.m1.1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS4.p1.1.m1.1.1.2.cmml" xref="S3.SS4.p1.1.m1.1.1.2">𝑙</ci><cn type="integer" id="S3.SS4.p1.1.m1.1.1.3.cmml" xref="S3.SS4.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">l_{1}</annotation></semantics></math> to optimize the predicted box parameters and the focal loss to supervise the classification score.
The hyper-parameters of the task heads just follow <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> and <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>.
Besides, inspired by RangeDet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>, we add an IoU regression head to predict the IoU between the bounding box and the best-matched ground truth annotations, which is also supervised in a smooth L1 loss.
When evaluated, the predicted confidence scores are aligned with regression results by <math id="S3.SS4.p1.2.m2.1" class="ltx_Math" alttext="score^{\prime}=score*iou^{\alpha}" display="inline"><semantics id="S3.SS4.p1.2.m2.1a"><mrow id="S3.SS4.p1.2.m2.1.1" xref="S3.SS4.p1.2.m2.1.1.cmml"><mrow id="S3.SS4.p1.2.m2.1.1.2" xref="S3.SS4.p1.2.m2.1.1.2.cmml"><mi id="S3.SS4.p1.2.m2.1.1.2.2" xref="S3.SS4.p1.2.m2.1.1.2.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.2.m2.1.1.2.1" xref="S3.SS4.p1.2.m2.1.1.2.1.cmml">​</mo><mi id="S3.SS4.p1.2.m2.1.1.2.3" xref="S3.SS4.p1.2.m2.1.1.2.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.2.m2.1.1.2.1a" xref="S3.SS4.p1.2.m2.1.1.2.1.cmml">​</mo><mi id="S3.SS4.p1.2.m2.1.1.2.4" xref="S3.SS4.p1.2.m2.1.1.2.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.2.m2.1.1.2.1b" xref="S3.SS4.p1.2.m2.1.1.2.1.cmml">​</mo><mi id="S3.SS4.p1.2.m2.1.1.2.5" xref="S3.SS4.p1.2.m2.1.1.2.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.2.m2.1.1.2.1c" xref="S3.SS4.p1.2.m2.1.1.2.1.cmml">​</mo><msup id="S3.SS4.p1.2.m2.1.1.2.6" xref="S3.SS4.p1.2.m2.1.1.2.6.cmml"><mi id="S3.SS4.p1.2.m2.1.1.2.6.2" xref="S3.SS4.p1.2.m2.1.1.2.6.2.cmml">e</mi><mo id="S3.SS4.p1.2.m2.1.1.2.6.3" xref="S3.SS4.p1.2.m2.1.1.2.6.3.cmml">′</mo></msup></mrow><mo id="S3.SS4.p1.2.m2.1.1.1" xref="S3.SS4.p1.2.m2.1.1.1.cmml">=</mo><mrow id="S3.SS4.p1.2.m2.1.1.3" xref="S3.SS4.p1.2.m2.1.1.3.cmml"><mrow id="S3.SS4.p1.2.m2.1.1.3.2" xref="S3.SS4.p1.2.m2.1.1.3.2.cmml"><mrow id="S3.SS4.p1.2.m2.1.1.3.2.2" xref="S3.SS4.p1.2.m2.1.1.3.2.2.cmml"><mi id="S3.SS4.p1.2.m2.1.1.3.2.2.2" xref="S3.SS4.p1.2.m2.1.1.3.2.2.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.2.m2.1.1.3.2.2.1" xref="S3.SS4.p1.2.m2.1.1.3.2.2.1.cmml">​</mo><mi id="S3.SS4.p1.2.m2.1.1.3.2.2.3" xref="S3.SS4.p1.2.m2.1.1.3.2.2.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.2.m2.1.1.3.2.2.1a" xref="S3.SS4.p1.2.m2.1.1.3.2.2.1.cmml">​</mo><mi id="S3.SS4.p1.2.m2.1.1.3.2.2.4" xref="S3.SS4.p1.2.m2.1.1.3.2.2.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.2.m2.1.1.3.2.2.1b" xref="S3.SS4.p1.2.m2.1.1.3.2.2.1.cmml">​</mo><mi id="S3.SS4.p1.2.m2.1.1.3.2.2.5" xref="S3.SS4.p1.2.m2.1.1.3.2.2.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.2.m2.1.1.3.2.2.1c" xref="S3.SS4.p1.2.m2.1.1.3.2.2.1.cmml">​</mo><mi id="S3.SS4.p1.2.m2.1.1.3.2.2.6" xref="S3.SS4.p1.2.m2.1.1.3.2.2.6.cmml">e</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="S3.SS4.p1.2.m2.1.1.3.2.1" xref="S3.SS4.p1.2.m2.1.1.3.2.1.cmml">∗</mo><mi id="S3.SS4.p1.2.m2.1.1.3.2.3" xref="S3.SS4.p1.2.m2.1.1.3.2.3.cmml">i</mi></mrow><mo lspace="0em" rspace="0em" id="S3.SS4.p1.2.m2.1.1.3.1" xref="S3.SS4.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.2.m2.1.1.3.3" xref="S3.SS4.p1.2.m2.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.2.m2.1.1.3.1a" xref="S3.SS4.p1.2.m2.1.1.3.1.cmml">​</mo><msup id="S3.SS4.p1.2.m2.1.1.3.4" xref="S3.SS4.p1.2.m2.1.1.3.4.cmml"><mi id="S3.SS4.p1.2.m2.1.1.3.4.2" xref="S3.SS4.p1.2.m2.1.1.3.4.2.cmml">u</mi><mi id="S3.SS4.p1.2.m2.1.1.3.4.3" xref="S3.SS4.p1.2.m2.1.1.3.4.3.cmml">α</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m2.1b"><apply id="S3.SS4.p1.2.m2.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1"><eq id="S3.SS4.p1.2.m2.1.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1.1"></eq><apply id="S3.SS4.p1.2.m2.1.1.2.cmml" xref="S3.SS4.p1.2.m2.1.1.2"><times id="S3.SS4.p1.2.m2.1.1.2.1.cmml" xref="S3.SS4.p1.2.m2.1.1.2.1"></times><ci id="S3.SS4.p1.2.m2.1.1.2.2.cmml" xref="S3.SS4.p1.2.m2.1.1.2.2">𝑠</ci><ci id="S3.SS4.p1.2.m2.1.1.2.3.cmml" xref="S3.SS4.p1.2.m2.1.1.2.3">𝑐</ci><ci id="S3.SS4.p1.2.m2.1.1.2.4.cmml" xref="S3.SS4.p1.2.m2.1.1.2.4">𝑜</ci><ci id="S3.SS4.p1.2.m2.1.1.2.5.cmml" xref="S3.SS4.p1.2.m2.1.1.2.5">𝑟</ci><apply id="S3.SS4.p1.2.m2.1.1.2.6.cmml" xref="S3.SS4.p1.2.m2.1.1.2.6"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.1.1.2.6.1.cmml" xref="S3.SS4.p1.2.m2.1.1.2.6">superscript</csymbol><ci id="S3.SS4.p1.2.m2.1.1.2.6.2.cmml" xref="S3.SS4.p1.2.m2.1.1.2.6.2">𝑒</ci><ci id="S3.SS4.p1.2.m2.1.1.2.6.3.cmml" xref="S3.SS4.p1.2.m2.1.1.2.6.3">′</ci></apply></apply><apply id="S3.SS4.p1.2.m2.1.1.3.cmml" xref="S3.SS4.p1.2.m2.1.1.3"><times id="S3.SS4.p1.2.m2.1.1.3.1.cmml" xref="S3.SS4.p1.2.m2.1.1.3.1"></times><apply id="S3.SS4.p1.2.m2.1.1.3.2.cmml" xref="S3.SS4.p1.2.m2.1.1.3.2"><times id="S3.SS4.p1.2.m2.1.1.3.2.1.cmml" xref="S3.SS4.p1.2.m2.1.1.3.2.1"></times><apply id="S3.SS4.p1.2.m2.1.1.3.2.2.cmml" xref="S3.SS4.p1.2.m2.1.1.3.2.2"><times id="S3.SS4.p1.2.m2.1.1.3.2.2.1.cmml" xref="S3.SS4.p1.2.m2.1.1.3.2.2.1"></times><ci id="S3.SS4.p1.2.m2.1.1.3.2.2.2.cmml" xref="S3.SS4.p1.2.m2.1.1.3.2.2.2">𝑠</ci><ci id="S3.SS4.p1.2.m2.1.1.3.2.2.3.cmml" xref="S3.SS4.p1.2.m2.1.1.3.2.2.3">𝑐</ci><ci id="S3.SS4.p1.2.m2.1.1.3.2.2.4.cmml" xref="S3.SS4.p1.2.m2.1.1.3.2.2.4">𝑜</ci><ci id="S3.SS4.p1.2.m2.1.1.3.2.2.5.cmml" xref="S3.SS4.p1.2.m2.1.1.3.2.2.5">𝑟</ci><ci id="S3.SS4.p1.2.m2.1.1.3.2.2.6.cmml" xref="S3.SS4.p1.2.m2.1.1.3.2.2.6">𝑒</ci></apply><ci id="S3.SS4.p1.2.m2.1.1.3.2.3.cmml" xref="S3.SS4.p1.2.m2.1.1.3.2.3">𝑖</ci></apply><ci id="S3.SS4.p1.2.m2.1.1.3.3.cmml" xref="S3.SS4.p1.2.m2.1.1.3.3">𝑜</ci><apply id="S3.SS4.p1.2.m2.1.1.3.4.cmml" xref="S3.SS4.p1.2.m2.1.1.3.4"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.1.1.3.4.1.cmml" xref="S3.SS4.p1.2.m2.1.1.3.4">superscript</csymbol><ci id="S3.SS4.p1.2.m2.1.1.3.4.2.cmml" xref="S3.SS4.p1.2.m2.1.1.3.4.2">𝑢</ci><ci id="S3.SS4.p1.2.m2.1.1.3.4.3.cmml" xref="S3.SS4.p1.2.m2.1.1.3.4.3">𝛼</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m2.1c">score^{\prime}=score*iou^{\alpha}</annotation></semantics></math>, where <math id="S3.SS4.p1.3.m3.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS4.p1.3.m3.1a"><mi id="S3.SS4.p1.3.m3.1.1" xref="S3.SS4.p1.3.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.3.m3.1b"><ci id="S3.SS4.p1.3.m3.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.3.m3.1c">\alpha</annotation></semantics></math> is set to be <math id="S3.SS4.p1.4.m4.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S3.SS4.p1.4.m4.1a"><mn id="S3.SS4.p1.4.m4.1.1" xref="S3.SS4.p1.4.m4.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.4.m4.1b"><cn type="integer" id="S3.SS4.p1.4.m4.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.4.m4.1c">1</annotation></semantics></math> in the experiment.
The overall loss of the proposed head can be formulated as follows:</p>
<table id="S3.E13" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E13.m1.1" class="ltx_Math" alttext="\small\mathcal{L}=\mathcal{L}_{cls}+w_{reg}\mathcal{L}_{reg}+w_{fg}\mathcal{L}_{fg}+w_{dis}\mathcal{L}_{dis}+w_{iou}\mathcal{L}_{iou}," display="block"><semantics id="S3.E13.m1.1a"><mrow id="S3.E13.m1.1.1.1" xref="S3.E13.m1.1.1.1.1.cmml"><mrow id="S3.E13.m1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S3.E13.m1.1.1.1.1.2" xref="S3.E13.m1.1.1.1.1.2.cmml">ℒ</mi><mo mathsize="90%" id="S3.E13.m1.1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E13.m1.1.1.1.1.3" xref="S3.E13.m1.1.1.1.1.3.cmml"><msub id="S3.E13.m1.1.1.1.1.3.2" xref="S3.E13.m1.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S3.E13.m1.1.1.1.1.3.2.2" xref="S3.E13.m1.1.1.1.1.3.2.2.cmml">ℒ</mi><mrow id="S3.E13.m1.1.1.1.1.3.2.3" xref="S3.E13.m1.1.1.1.1.3.2.3.cmml"><mi mathsize="90%" id="S3.E13.m1.1.1.1.1.3.2.3.2" xref="S3.E13.m1.1.1.1.1.3.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.1.1.1.1.3.2.3.1" xref="S3.E13.m1.1.1.1.1.3.2.3.1.cmml">​</mo><mi mathsize="90%" id="S3.E13.m1.1.1.1.1.3.2.3.3" xref="S3.E13.m1.1.1.1.1.3.2.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.1.1.1.1.3.2.3.1a" xref="S3.E13.m1.1.1.1.1.3.2.3.1.cmml">​</mo><mi mathsize="90%" id="S3.E13.m1.1.1.1.1.3.2.3.4" xref="S3.E13.m1.1.1.1.1.3.2.3.4.cmml">s</mi></mrow></msub><mo mathsize="90%" id="S3.E13.m1.1.1.1.1.3.1" xref="S3.E13.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S3.E13.m1.1.1.1.1.3.3" xref="S3.E13.m1.1.1.1.1.3.3.cmml"><msub id="S3.E13.m1.1.1.1.1.3.3.2" xref="S3.E13.m1.1.1.1.1.3.3.2.cmml"><mi mathsize="90%" id="S3.E13.m1.1.1.1.1.3.3.2.2" xref="S3.E13.m1.1.1.1.1.3.3.2.2.cmml">w</mi><mrow id="S3.E13.m1.1.1.1.1.3.3.2.3" xref="S3.E13.m1.1.1.1.1.3.3.2.3.cmml"><mi mathsize="90%" id="S3.E13.m1.1.1.1.1.3.3.2.3.2" xref="S3.E13.m1.1.1.1.1.3.3.2.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.1.1.1.1.3.3.2.3.1" xref="S3.E13.m1.1.1.1.1.3.3.2.3.1.cmml">​</mo><mi mathsize="90%" id="S3.E13.m1.1.1.1.1.3.3.2.3.3" xref="S3.E13.m1.1.1.1.1.3.3.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.1.1.1.1.3.3.2.3.1a" xref="S3.E13.m1.1.1.1.1.3.3.2.3.1.cmml">​</mo><mi mathsize="90%" id="S3.E13.m1.1.1.1.1.3.3.2.3.4" xref="S3.E13.m1.1.1.1.1.3.3.2.3.4.cmml">g</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E13.m1.1.1.1.1.3.3.1" xref="S3.E13.m1.1.1.1.1.3.3.1.cmml">​</mo><msub id="S3.E13.m1.1.1.1.1.3.3.3" xref="S3.E13.m1.1.1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S3.E13.m1.1.1.1.1.3.3.3.2" xref="S3.E13.m1.1.1.1.1.3.3.3.2.cmml">ℒ</mi><mrow id="S3.E13.m1.1.1.1.1.3.3.3.3" xref="S3.E13.m1.1.1.1.1.3.3.3.3.cmml"><mi mathsize="90%" id="S3.E13.m1.1.1.1.1.3.3.3.3.2" xref="S3.E13.m1.1.1.1.1.3.3.3.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.1.1.1.1.3.3.3.3.1" xref="S3.E13.m1.1.1.1.1.3.3.3.3.1.cmml">​</mo><mi mathsize="90%" id="S3.E13.m1.1.1.1.1.3.3.3.3.3" xref="S3.E13.m1.1.1.1.1.3.3.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.1.1.1.1.3.3.3.3.1a" xref="S3.E13.m1.1.1.1.1.3.3.3.3.1.cmml">​</mo><mi mathsize="90%" id="S3.E13.m1.1.1.1.1.3.3.3.3.4" xref="S3.E13.m1.1.1.1.1.3.3.3.3.4.cmml">g</mi></mrow></msub></mrow><mo mathsize="90%" id="S3.E13.m1.1.1.1.1.3.1a" xref="S3.E13.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S3.E13.m1.1.1.1.1.3.4" xref="S3.E13.m1.1.1.1.1.3.4.cmml"><msub id="S3.E13.m1.1.1.1.1.3.4.2" xref="S3.E13.m1.1.1.1.1.3.4.2.cmml"><mi mathsize="90%" id="S3.E13.m1.1.1.1.1.3.4.2.2" xref="S3.E13.m1.1.1.1.1.3.4.2.2.cmml">w</mi><mrow id="S3.E13.m1.1.1.1.1.3.4.2.3" xref="S3.E13.m1.1.1.1.1.3.4.2.3.cmml"><mi mathsize="90%" id="S3.E13.m1.1.1.1.1.3.4.2.3.2" xref="S3.E13.m1.1.1.1.1.3.4.2.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.1.1.1.1.3.4.2.3.1" xref="S3.E13.m1.1.1.1.1.3.4.2.3.1.cmml">​</mo><mi mathsize="90%" id="S3.E13.m1.1.1.1.1.3.4.2.3.3" xref="S3.E13.m1.1.1.1.1.3.4.2.3.3.cmml">g</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E13.m1.1.1.1.1.3.4.1" xref="S3.E13.m1.1.1.1.1.3.4.1.cmml">​</mo><msub id="S3.E13.m1.1.1.1.1.3.4.3" xref="S3.E13.m1.1.1.1.1.3.4.3.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S3.E13.m1.1.1.1.1.3.4.3.2" xref="S3.E13.m1.1.1.1.1.3.4.3.2.cmml">ℒ</mi><mrow id="S3.E13.m1.1.1.1.1.3.4.3.3" xref="S3.E13.m1.1.1.1.1.3.4.3.3.cmml"><mi mathsize="90%" id="S3.E13.m1.1.1.1.1.3.4.3.3.2" xref="S3.E13.m1.1.1.1.1.3.4.3.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.1.1.1.1.3.4.3.3.1" xref="S3.E13.m1.1.1.1.1.3.4.3.3.1.cmml">​</mo><mi mathsize="90%" id="S3.E13.m1.1.1.1.1.3.4.3.3.3" xref="S3.E13.m1.1.1.1.1.3.4.3.3.3.cmml">g</mi></mrow></msub></mrow><mo mathsize="90%" id="S3.E13.m1.1.1.1.1.3.1b" xref="S3.E13.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S3.E13.m1.1.1.1.1.3.5" xref="S3.E13.m1.1.1.1.1.3.5.cmml"><msub id="S3.E13.m1.1.1.1.1.3.5.2" xref="S3.E13.m1.1.1.1.1.3.5.2.cmml"><mi mathsize="90%" id="S3.E13.m1.1.1.1.1.3.5.2.2" xref="S3.E13.m1.1.1.1.1.3.5.2.2.cmml">w</mi><mrow id="S3.E13.m1.1.1.1.1.3.5.2.3" xref="S3.E13.m1.1.1.1.1.3.5.2.3.cmml"><mi mathsize="90%" id="S3.E13.m1.1.1.1.1.3.5.2.3.2" xref="S3.E13.m1.1.1.1.1.3.5.2.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.1.1.1.1.3.5.2.3.1" xref="S3.E13.m1.1.1.1.1.3.5.2.3.1.cmml">​</mo><mi mathsize="90%" id="S3.E13.m1.1.1.1.1.3.5.2.3.3" xref="S3.E13.m1.1.1.1.1.3.5.2.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.1.1.1.1.3.5.2.3.1a" xref="S3.E13.m1.1.1.1.1.3.5.2.3.1.cmml">​</mo><mi mathsize="90%" id="S3.E13.m1.1.1.1.1.3.5.2.3.4" xref="S3.E13.m1.1.1.1.1.3.5.2.3.4.cmml">s</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E13.m1.1.1.1.1.3.5.1" xref="S3.E13.m1.1.1.1.1.3.5.1.cmml">​</mo><msub id="S3.E13.m1.1.1.1.1.3.5.3" xref="S3.E13.m1.1.1.1.1.3.5.3.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S3.E13.m1.1.1.1.1.3.5.3.2" xref="S3.E13.m1.1.1.1.1.3.5.3.2.cmml">ℒ</mi><mrow id="S3.E13.m1.1.1.1.1.3.5.3.3" xref="S3.E13.m1.1.1.1.1.3.5.3.3.cmml"><mi mathsize="90%" id="S3.E13.m1.1.1.1.1.3.5.3.3.2" xref="S3.E13.m1.1.1.1.1.3.5.3.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.1.1.1.1.3.5.3.3.1" xref="S3.E13.m1.1.1.1.1.3.5.3.3.1.cmml">​</mo><mi mathsize="90%" id="S3.E13.m1.1.1.1.1.3.5.3.3.3" xref="S3.E13.m1.1.1.1.1.3.5.3.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.1.1.1.1.3.5.3.3.1a" xref="S3.E13.m1.1.1.1.1.3.5.3.3.1.cmml">​</mo><mi mathsize="90%" id="S3.E13.m1.1.1.1.1.3.5.3.3.4" xref="S3.E13.m1.1.1.1.1.3.5.3.3.4.cmml">s</mi></mrow></msub></mrow><mo mathsize="90%" id="S3.E13.m1.1.1.1.1.3.1c" xref="S3.E13.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S3.E13.m1.1.1.1.1.3.6" xref="S3.E13.m1.1.1.1.1.3.6.cmml"><msub id="S3.E13.m1.1.1.1.1.3.6.2" xref="S3.E13.m1.1.1.1.1.3.6.2.cmml"><mi mathsize="90%" id="S3.E13.m1.1.1.1.1.3.6.2.2" xref="S3.E13.m1.1.1.1.1.3.6.2.2.cmml">w</mi><mrow id="S3.E13.m1.1.1.1.1.3.6.2.3" xref="S3.E13.m1.1.1.1.1.3.6.2.3.cmml"><mi mathsize="90%" id="S3.E13.m1.1.1.1.1.3.6.2.3.2" xref="S3.E13.m1.1.1.1.1.3.6.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.1.1.1.1.3.6.2.3.1" xref="S3.E13.m1.1.1.1.1.3.6.2.3.1.cmml">​</mo><mi mathsize="90%" id="S3.E13.m1.1.1.1.1.3.6.2.3.3" xref="S3.E13.m1.1.1.1.1.3.6.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.1.1.1.1.3.6.2.3.1a" xref="S3.E13.m1.1.1.1.1.3.6.2.3.1.cmml">​</mo><mi mathsize="90%" id="S3.E13.m1.1.1.1.1.3.6.2.3.4" xref="S3.E13.m1.1.1.1.1.3.6.2.3.4.cmml">u</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E13.m1.1.1.1.1.3.6.1" xref="S3.E13.m1.1.1.1.1.3.6.1.cmml">​</mo><msub id="S3.E13.m1.1.1.1.1.3.6.3" xref="S3.E13.m1.1.1.1.1.3.6.3.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S3.E13.m1.1.1.1.1.3.6.3.2" xref="S3.E13.m1.1.1.1.1.3.6.3.2.cmml">ℒ</mi><mrow id="S3.E13.m1.1.1.1.1.3.6.3.3" xref="S3.E13.m1.1.1.1.1.3.6.3.3.cmml"><mi mathsize="90%" id="S3.E13.m1.1.1.1.1.3.6.3.3.2" xref="S3.E13.m1.1.1.1.1.3.6.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.1.1.1.1.3.6.3.3.1" xref="S3.E13.m1.1.1.1.1.3.6.3.3.1.cmml">​</mo><mi mathsize="90%" id="S3.E13.m1.1.1.1.1.3.6.3.3.3" xref="S3.E13.m1.1.1.1.1.3.6.3.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.1.1.1.1.3.6.3.3.1a" xref="S3.E13.m1.1.1.1.1.3.6.3.3.1.cmml">​</mo><mi mathsize="90%" id="S3.E13.m1.1.1.1.1.3.6.3.3.4" xref="S3.E13.m1.1.1.1.1.3.6.3.3.4.cmml">u</mi></mrow></msub></mrow></mrow></mrow><mo mathsize="90%" id="S3.E13.m1.1.1.1.2" xref="S3.E13.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E13.m1.1b"><apply id="S3.E13.m1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1"><eq id="S3.E13.m1.1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1.1.1"></eq><ci id="S3.E13.m1.1.1.1.1.2.cmml" xref="S3.E13.m1.1.1.1.1.2">ℒ</ci><apply id="S3.E13.m1.1.1.1.1.3.cmml" xref="S3.E13.m1.1.1.1.1.3"><plus id="S3.E13.m1.1.1.1.1.3.1.cmml" xref="S3.E13.m1.1.1.1.1.3.1"></plus><apply id="S3.E13.m1.1.1.1.1.3.2.cmml" xref="S3.E13.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.3.2.1.cmml" xref="S3.E13.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E13.m1.1.1.1.1.3.2.2.cmml" xref="S3.E13.m1.1.1.1.1.3.2.2">ℒ</ci><apply id="S3.E13.m1.1.1.1.1.3.2.3.cmml" xref="S3.E13.m1.1.1.1.1.3.2.3"><times id="S3.E13.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.E13.m1.1.1.1.1.3.2.3.1"></times><ci id="S3.E13.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.E13.m1.1.1.1.1.3.2.3.2">𝑐</ci><ci id="S3.E13.m1.1.1.1.1.3.2.3.3.cmml" xref="S3.E13.m1.1.1.1.1.3.2.3.3">𝑙</ci><ci id="S3.E13.m1.1.1.1.1.3.2.3.4.cmml" xref="S3.E13.m1.1.1.1.1.3.2.3.4">𝑠</ci></apply></apply><apply id="S3.E13.m1.1.1.1.1.3.3.cmml" xref="S3.E13.m1.1.1.1.1.3.3"><times id="S3.E13.m1.1.1.1.1.3.3.1.cmml" xref="S3.E13.m1.1.1.1.1.3.3.1"></times><apply id="S3.E13.m1.1.1.1.1.3.3.2.cmml" xref="S3.E13.m1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.3.3.2.1.cmml" xref="S3.E13.m1.1.1.1.1.3.3.2">subscript</csymbol><ci id="S3.E13.m1.1.1.1.1.3.3.2.2.cmml" xref="S3.E13.m1.1.1.1.1.3.3.2.2">𝑤</ci><apply id="S3.E13.m1.1.1.1.1.3.3.2.3.cmml" xref="S3.E13.m1.1.1.1.1.3.3.2.3"><times id="S3.E13.m1.1.1.1.1.3.3.2.3.1.cmml" xref="S3.E13.m1.1.1.1.1.3.3.2.3.1"></times><ci id="S3.E13.m1.1.1.1.1.3.3.2.3.2.cmml" xref="S3.E13.m1.1.1.1.1.3.3.2.3.2">𝑟</ci><ci id="S3.E13.m1.1.1.1.1.3.3.2.3.3.cmml" xref="S3.E13.m1.1.1.1.1.3.3.2.3.3">𝑒</ci><ci id="S3.E13.m1.1.1.1.1.3.3.2.3.4.cmml" xref="S3.E13.m1.1.1.1.1.3.3.2.3.4">𝑔</ci></apply></apply><apply id="S3.E13.m1.1.1.1.1.3.3.3.cmml" xref="S3.E13.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.3.3.3.1.cmml" xref="S3.E13.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E13.m1.1.1.1.1.3.3.3.2.cmml" xref="S3.E13.m1.1.1.1.1.3.3.3.2">ℒ</ci><apply id="S3.E13.m1.1.1.1.1.3.3.3.3.cmml" xref="S3.E13.m1.1.1.1.1.3.3.3.3"><times id="S3.E13.m1.1.1.1.1.3.3.3.3.1.cmml" xref="S3.E13.m1.1.1.1.1.3.3.3.3.1"></times><ci id="S3.E13.m1.1.1.1.1.3.3.3.3.2.cmml" xref="S3.E13.m1.1.1.1.1.3.3.3.3.2">𝑟</ci><ci id="S3.E13.m1.1.1.1.1.3.3.3.3.3.cmml" xref="S3.E13.m1.1.1.1.1.3.3.3.3.3">𝑒</ci><ci id="S3.E13.m1.1.1.1.1.3.3.3.3.4.cmml" xref="S3.E13.m1.1.1.1.1.3.3.3.3.4">𝑔</ci></apply></apply></apply><apply id="S3.E13.m1.1.1.1.1.3.4.cmml" xref="S3.E13.m1.1.1.1.1.3.4"><times id="S3.E13.m1.1.1.1.1.3.4.1.cmml" xref="S3.E13.m1.1.1.1.1.3.4.1"></times><apply id="S3.E13.m1.1.1.1.1.3.4.2.cmml" xref="S3.E13.m1.1.1.1.1.3.4.2"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.3.4.2.1.cmml" xref="S3.E13.m1.1.1.1.1.3.4.2">subscript</csymbol><ci id="S3.E13.m1.1.1.1.1.3.4.2.2.cmml" xref="S3.E13.m1.1.1.1.1.3.4.2.2">𝑤</ci><apply id="S3.E13.m1.1.1.1.1.3.4.2.3.cmml" xref="S3.E13.m1.1.1.1.1.3.4.2.3"><times id="S3.E13.m1.1.1.1.1.3.4.2.3.1.cmml" xref="S3.E13.m1.1.1.1.1.3.4.2.3.1"></times><ci id="S3.E13.m1.1.1.1.1.3.4.2.3.2.cmml" xref="S3.E13.m1.1.1.1.1.3.4.2.3.2">𝑓</ci><ci id="S3.E13.m1.1.1.1.1.3.4.2.3.3.cmml" xref="S3.E13.m1.1.1.1.1.3.4.2.3.3">𝑔</ci></apply></apply><apply id="S3.E13.m1.1.1.1.1.3.4.3.cmml" xref="S3.E13.m1.1.1.1.1.3.4.3"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.3.4.3.1.cmml" xref="S3.E13.m1.1.1.1.1.3.4.3">subscript</csymbol><ci id="S3.E13.m1.1.1.1.1.3.4.3.2.cmml" xref="S3.E13.m1.1.1.1.1.3.4.3.2">ℒ</ci><apply id="S3.E13.m1.1.1.1.1.3.4.3.3.cmml" xref="S3.E13.m1.1.1.1.1.3.4.3.3"><times id="S3.E13.m1.1.1.1.1.3.4.3.3.1.cmml" xref="S3.E13.m1.1.1.1.1.3.4.3.3.1"></times><ci id="S3.E13.m1.1.1.1.1.3.4.3.3.2.cmml" xref="S3.E13.m1.1.1.1.1.3.4.3.3.2">𝑓</ci><ci id="S3.E13.m1.1.1.1.1.3.4.3.3.3.cmml" xref="S3.E13.m1.1.1.1.1.3.4.3.3.3">𝑔</ci></apply></apply></apply><apply id="S3.E13.m1.1.1.1.1.3.5.cmml" xref="S3.E13.m1.1.1.1.1.3.5"><times id="S3.E13.m1.1.1.1.1.3.5.1.cmml" xref="S3.E13.m1.1.1.1.1.3.5.1"></times><apply id="S3.E13.m1.1.1.1.1.3.5.2.cmml" xref="S3.E13.m1.1.1.1.1.3.5.2"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.3.5.2.1.cmml" xref="S3.E13.m1.1.1.1.1.3.5.2">subscript</csymbol><ci id="S3.E13.m1.1.1.1.1.3.5.2.2.cmml" xref="S3.E13.m1.1.1.1.1.3.5.2.2">𝑤</ci><apply id="S3.E13.m1.1.1.1.1.3.5.2.3.cmml" xref="S3.E13.m1.1.1.1.1.3.5.2.3"><times id="S3.E13.m1.1.1.1.1.3.5.2.3.1.cmml" xref="S3.E13.m1.1.1.1.1.3.5.2.3.1"></times><ci id="S3.E13.m1.1.1.1.1.3.5.2.3.2.cmml" xref="S3.E13.m1.1.1.1.1.3.5.2.3.2">𝑑</ci><ci id="S3.E13.m1.1.1.1.1.3.5.2.3.3.cmml" xref="S3.E13.m1.1.1.1.1.3.5.2.3.3">𝑖</ci><ci id="S3.E13.m1.1.1.1.1.3.5.2.3.4.cmml" xref="S3.E13.m1.1.1.1.1.3.5.2.3.4">𝑠</ci></apply></apply><apply id="S3.E13.m1.1.1.1.1.3.5.3.cmml" xref="S3.E13.m1.1.1.1.1.3.5.3"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.3.5.3.1.cmml" xref="S3.E13.m1.1.1.1.1.3.5.3">subscript</csymbol><ci id="S3.E13.m1.1.1.1.1.3.5.3.2.cmml" xref="S3.E13.m1.1.1.1.1.3.5.3.2">ℒ</ci><apply id="S3.E13.m1.1.1.1.1.3.5.3.3.cmml" xref="S3.E13.m1.1.1.1.1.3.5.3.3"><times id="S3.E13.m1.1.1.1.1.3.5.3.3.1.cmml" xref="S3.E13.m1.1.1.1.1.3.5.3.3.1"></times><ci id="S3.E13.m1.1.1.1.1.3.5.3.3.2.cmml" xref="S3.E13.m1.1.1.1.1.3.5.3.3.2">𝑑</ci><ci id="S3.E13.m1.1.1.1.1.3.5.3.3.3.cmml" xref="S3.E13.m1.1.1.1.1.3.5.3.3.3">𝑖</ci><ci id="S3.E13.m1.1.1.1.1.3.5.3.3.4.cmml" xref="S3.E13.m1.1.1.1.1.3.5.3.3.4">𝑠</ci></apply></apply></apply><apply id="S3.E13.m1.1.1.1.1.3.6.cmml" xref="S3.E13.m1.1.1.1.1.3.6"><times id="S3.E13.m1.1.1.1.1.3.6.1.cmml" xref="S3.E13.m1.1.1.1.1.3.6.1"></times><apply id="S3.E13.m1.1.1.1.1.3.6.2.cmml" xref="S3.E13.m1.1.1.1.1.3.6.2"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.3.6.2.1.cmml" xref="S3.E13.m1.1.1.1.1.3.6.2">subscript</csymbol><ci id="S3.E13.m1.1.1.1.1.3.6.2.2.cmml" xref="S3.E13.m1.1.1.1.1.3.6.2.2">𝑤</ci><apply id="S3.E13.m1.1.1.1.1.3.6.2.3.cmml" xref="S3.E13.m1.1.1.1.1.3.6.2.3"><times id="S3.E13.m1.1.1.1.1.3.6.2.3.1.cmml" xref="S3.E13.m1.1.1.1.1.3.6.2.3.1"></times><ci id="S3.E13.m1.1.1.1.1.3.6.2.3.2.cmml" xref="S3.E13.m1.1.1.1.1.3.6.2.3.2">𝑖</ci><ci id="S3.E13.m1.1.1.1.1.3.6.2.3.3.cmml" xref="S3.E13.m1.1.1.1.1.3.6.2.3.3">𝑜</ci><ci id="S3.E13.m1.1.1.1.1.3.6.2.3.4.cmml" xref="S3.E13.m1.1.1.1.1.3.6.2.3.4">𝑢</ci></apply></apply><apply id="S3.E13.m1.1.1.1.1.3.6.3.cmml" xref="S3.E13.m1.1.1.1.1.3.6.3"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.3.6.3.1.cmml" xref="S3.E13.m1.1.1.1.1.3.6.3">subscript</csymbol><ci id="S3.E13.m1.1.1.1.1.3.6.3.2.cmml" xref="S3.E13.m1.1.1.1.1.3.6.3.2">ℒ</ci><apply id="S3.E13.m1.1.1.1.1.3.6.3.3.cmml" xref="S3.E13.m1.1.1.1.1.3.6.3.3"><times id="S3.E13.m1.1.1.1.1.3.6.3.3.1.cmml" xref="S3.E13.m1.1.1.1.1.3.6.3.3.1"></times><ci id="S3.E13.m1.1.1.1.1.3.6.3.3.2.cmml" xref="S3.E13.m1.1.1.1.1.3.6.3.3.2">𝑖</ci><ci id="S3.E13.m1.1.1.1.1.3.6.3.3.3.cmml" xref="S3.E13.m1.1.1.1.1.3.6.3.3.3">𝑜</ci><ci id="S3.E13.m1.1.1.1.1.3.6.3.3.4.cmml" xref="S3.E13.m1.1.1.1.1.3.6.3.3.4">𝑢</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13.m1.1c">\small\mathcal{L}=\mathcal{L}_{cls}+w_{reg}\mathcal{L}_{reg}+w_{fg}\mathcal{L}_{fg}+w_{dis}\mathcal{L}_{dis}+w_{iou}\mathcal{L}_{iou},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p1.8" class="ltx_p">where <math id="S3.SS4.p1.5.m1.1" class="ltx_Math" alttext="w_{reg}" display="inline"><semantics id="S3.SS4.p1.5.m1.1a"><msub id="S3.SS4.p1.5.m1.1.1" xref="S3.SS4.p1.5.m1.1.1.cmml"><mi id="S3.SS4.p1.5.m1.1.1.2" xref="S3.SS4.p1.5.m1.1.1.2.cmml">w</mi><mrow id="S3.SS4.p1.5.m1.1.1.3" xref="S3.SS4.p1.5.m1.1.1.3.cmml"><mi id="S3.SS4.p1.5.m1.1.1.3.2" xref="S3.SS4.p1.5.m1.1.1.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.5.m1.1.1.3.1" xref="S3.SS4.p1.5.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.5.m1.1.1.3.3" xref="S3.SS4.p1.5.m1.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.5.m1.1.1.3.1a" xref="S3.SS4.p1.5.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.5.m1.1.1.3.4" xref="S3.SS4.p1.5.m1.1.1.3.4.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.5.m1.1b"><apply id="S3.SS4.p1.5.m1.1.1.cmml" xref="S3.SS4.p1.5.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m1.1.1.1.cmml" xref="S3.SS4.p1.5.m1.1.1">subscript</csymbol><ci id="S3.SS4.p1.5.m1.1.1.2.cmml" xref="S3.SS4.p1.5.m1.1.1.2">𝑤</ci><apply id="S3.SS4.p1.5.m1.1.1.3.cmml" xref="S3.SS4.p1.5.m1.1.1.3"><times id="S3.SS4.p1.5.m1.1.1.3.1.cmml" xref="S3.SS4.p1.5.m1.1.1.3.1"></times><ci id="S3.SS4.p1.5.m1.1.1.3.2.cmml" xref="S3.SS4.p1.5.m1.1.1.3.2">𝑟</ci><ci id="S3.SS4.p1.5.m1.1.1.3.3.cmml" xref="S3.SS4.p1.5.m1.1.1.3.3">𝑒</ci><ci id="S3.SS4.p1.5.m1.1.1.3.4.cmml" xref="S3.SS4.p1.5.m1.1.1.3.4">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.5.m1.1c">w_{reg}</annotation></semantics></math>, <math id="S3.SS4.p1.6.m2.1" class="ltx_Math" alttext="w_{fg}" display="inline"><semantics id="S3.SS4.p1.6.m2.1a"><msub id="S3.SS4.p1.6.m2.1.1" xref="S3.SS4.p1.6.m2.1.1.cmml"><mi id="S3.SS4.p1.6.m2.1.1.2" xref="S3.SS4.p1.6.m2.1.1.2.cmml">w</mi><mrow id="S3.SS4.p1.6.m2.1.1.3" xref="S3.SS4.p1.6.m2.1.1.3.cmml"><mi id="S3.SS4.p1.6.m2.1.1.3.2" xref="S3.SS4.p1.6.m2.1.1.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.6.m2.1.1.3.1" xref="S3.SS4.p1.6.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.6.m2.1.1.3.3" xref="S3.SS4.p1.6.m2.1.1.3.3.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.6.m2.1b"><apply id="S3.SS4.p1.6.m2.1.1.cmml" xref="S3.SS4.p1.6.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.6.m2.1.1.1.cmml" xref="S3.SS4.p1.6.m2.1.1">subscript</csymbol><ci id="S3.SS4.p1.6.m2.1.1.2.cmml" xref="S3.SS4.p1.6.m2.1.1.2">𝑤</ci><apply id="S3.SS4.p1.6.m2.1.1.3.cmml" xref="S3.SS4.p1.6.m2.1.1.3"><times id="S3.SS4.p1.6.m2.1.1.3.1.cmml" xref="S3.SS4.p1.6.m2.1.1.3.1"></times><ci id="S3.SS4.p1.6.m2.1.1.3.2.cmml" xref="S3.SS4.p1.6.m2.1.1.3.2">𝑓</ci><ci id="S3.SS4.p1.6.m2.1.1.3.3.cmml" xref="S3.SS4.p1.6.m2.1.1.3.3">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.6.m2.1c">w_{fg}</annotation></semantics></math>, <math id="S3.SS4.p1.7.m3.1" class="ltx_Math" alttext="w_{dis}" display="inline"><semantics id="S3.SS4.p1.7.m3.1a"><msub id="S3.SS4.p1.7.m3.1.1" xref="S3.SS4.p1.7.m3.1.1.cmml"><mi id="S3.SS4.p1.7.m3.1.1.2" xref="S3.SS4.p1.7.m3.1.1.2.cmml">w</mi><mrow id="S3.SS4.p1.7.m3.1.1.3" xref="S3.SS4.p1.7.m3.1.1.3.cmml"><mi id="S3.SS4.p1.7.m3.1.1.3.2" xref="S3.SS4.p1.7.m3.1.1.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.7.m3.1.1.3.1" xref="S3.SS4.p1.7.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.7.m3.1.1.3.3" xref="S3.SS4.p1.7.m3.1.1.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.7.m3.1.1.3.1a" xref="S3.SS4.p1.7.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.7.m3.1.1.3.4" xref="S3.SS4.p1.7.m3.1.1.3.4.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.7.m3.1b"><apply id="S3.SS4.p1.7.m3.1.1.cmml" xref="S3.SS4.p1.7.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.7.m3.1.1.1.cmml" xref="S3.SS4.p1.7.m3.1.1">subscript</csymbol><ci id="S3.SS4.p1.7.m3.1.1.2.cmml" xref="S3.SS4.p1.7.m3.1.1.2">𝑤</ci><apply id="S3.SS4.p1.7.m3.1.1.3.cmml" xref="S3.SS4.p1.7.m3.1.1.3"><times id="S3.SS4.p1.7.m3.1.1.3.1.cmml" xref="S3.SS4.p1.7.m3.1.1.3.1"></times><ci id="S3.SS4.p1.7.m3.1.1.3.2.cmml" xref="S3.SS4.p1.7.m3.1.1.3.2">𝑑</ci><ci id="S3.SS4.p1.7.m3.1.1.3.3.cmml" xref="S3.SS4.p1.7.m3.1.1.3.3">𝑖</ci><ci id="S3.SS4.p1.7.m3.1.1.3.4.cmml" xref="S3.SS4.p1.7.m3.1.1.3.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.7.m3.1c">w_{dis}</annotation></semantics></math> and <math id="S3.SS4.p1.8.m4.1" class="ltx_Math" alttext="w_{iou}" display="inline"><semantics id="S3.SS4.p1.8.m4.1a"><msub id="S3.SS4.p1.8.m4.1.1" xref="S3.SS4.p1.8.m4.1.1.cmml"><mi id="S3.SS4.p1.8.m4.1.1.2" xref="S3.SS4.p1.8.m4.1.1.2.cmml">w</mi><mrow id="S3.SS4.p1.8.m4.1.1.3" xref="S3.SS4.p1.8.m4.1.1.3.cmml"><mi id="S3.SS4.p1.8.m4.1.1.3.2" xref="S3.SS4.p1.8.m4.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.8.m4.1.1.3.1" xref="S3.SS4.p1.8.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.8.m4.1.1.3.3" xref="S3.SS4.p1.8.m4.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.8.m4.1.1.3.1a" xref="S3.SS4.p1.8.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.8.m4.1.1.3.4" xref="S3.SS4.p1.8.m4.1.1.3.4.cmml">u</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.8.m4.1b"><apply id="S3.SS4.p1.8.m4.1.1.cmml" xref="S3.SS4.p1.8.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.8.m4.1.1.1.cmml" xref="S3.SS4.p1.8.m4.1.1">subscript</csymbol><ci id="S3.SS4.p1.8.m4.1.1.2.cmml" xref="S3.SS4.p1.8.m4.1.1.2">𝑤</ci><apply id="S3.SS4.p1.8.m4.1.1.3.cmml" xref="S3.SS4.p1.8.m4.1.1.3"><times id="S3.SS4.p1.8.m4.1.1.3.1.cmml" xref="S3.SS4.p1.8.m4.1.1.3.1"></times><ci id="S3.SS4.p1.8.m4.1.1.3.2.cmml" xref="S3.SS4.p1.8.m4.1.1.3.2">𝑖</ci><ci id="S3.SS4.p1.8.m4.1.1.3.3.cmml" xref="S3.SS4.p1.8.m4.1.1.3.3">𝑜</ci><ci id="S3.SS4.p1.8.m4.1.1.3.4.cmml" xref="S3.SS4.p1.8.m4.1.1.3.4">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.8.m4.1c">w_{iou}</annotation></semantics></math> are the coefficients that balance the losses and are set to be [2, 1, 0.75, 2] on Waymo models and [0.75, 1, 0.75, 2] on ONCE models.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<figure id="S4.T2" class="ltx_table">
<div id="S4.T2.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:223.6pt;height:59.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-57.8pt,15.3pt) scale(0.659357114543286,0.659357114543286) ;">
<table id="S4.T2.1.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T2.1.1.1" class="ltx_tr">
<td id="S4.T2.1.1.1.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" style="padding-left:11.4pt;padding-right:11.4pt;" rowspan="2"><span id="S4.T2.1.1.1.1.1" class="ltx_text" style="font-size:144%;">Methods</span></td>
<td id="S4.T2.1.1.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:11.4pt;padding-right:11.4pt;" colspan="5"><span id="S4.T2.1.1.1.2.1" class="ltx_text" style="font-size:144%;">Voxel size</span></td>
</tr>
<tr id="S4.T2.1.1.2" class="ltx_tr">
<td id="S4.T2.1.1.2.1" class="ltx_td ltx_align_center" style="padding-left:11.4pt;padding-right:11.4pt;"><span id="S4.T2.1.1.2.1.1" class="ltx_text" style="font-size:144%;">1x</span></td>
<td id="S4.T2.1.1.2.2" class="ltx_td ltx_align_center" style="padding-left:11.4pt;padding-right:11.4pt;"><span id="S4.T2.1.1.2.2.1" class="ltx_text" style="font-size:144%;">2x</span></td>
<td id="S4.T2.1.1.2.3" class="ltx_td ltx_align_center" style="padding-left:11.4pt;padding-right:11.4pt;"><span id="S4.T2.1.1.2.3.1" class="ltx_text" style="font-size:144%;">3x</span></td>
<td id="S4.T2.1.1.2.4" class="ltx_td ltx_align_center" style="padding-left:11.4pt;padding-right:11.4pt;"><span id="S4.T2.1.1.2.4.1" class="ltx_text" style="font-size:144%;">4x</span></td>
<td id="S4.T2.1.1.2.5" class="ltx_td ltx_align_center" style="padding-left:11.4pt;padding-right:11.4pt;"><span id="S4.T2.1.1.2.5.1" class="ltx_text" style="font-size:144%;">5x</span></td>
</tr>
<tr id="S4.T2.1.1.3" class="ltx_tr">
<td id="S4.T2.1.1.3.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" style="padding-left:11.4pt;padding-right:11.4pt;"><span id="S4.T2.1.1.3.1.1" class="ltx_text" style="font-size:144%;">Cartesian</span></td>
<td id="S4.T2.1.1.3.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:11.4pt;padding-right:11.4pt;"><span id="S4.T2.1.1.3.2.1" class="ltx_text" style="font-size:144%;">65.5</span></td>
<td id="S4.T2.1.1.3.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:11.4pt;padding-right:11.4pt;"><span id="S4.T2.1.1.3.3.1" class="ltx_text" style="font-size:144%;">61.3</span></td>
<td id="S4.T2.1.1.3.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:11.4pt;padding-right:11.4pt;"><span id="S4.T2.1.1.3.4.1" class="ltx_text" style="font-size:144%;">56.2</span></td>
<td id="S4.T2.1.1.3.5" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:11.4pt;padding-right:11.4pt;"><span id="S4.T2.1.1.3.5.1" class="ltx_text" style="font-size:144%;">47.0</span></td>
<td id="S4.T2.1.1.3.6" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:11.4pt;padding-right:11.4pt;"><span id="S4.T2.1.1.3.6.1" class="ltx_text" style="font-size:144%;">35.6</span></td>
</tr>
<tr id="S4.T2.1.1.4" class="ltx_tr">
<td id="S4.T2.1.1.4.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-left:11.4pt;padding-right:11.4pt;"><span id="S4.T2.1.1.4.1.1" class="ltx_text" style="font-size:144%;">Polar</span></td>
<td id="S4.T2.1.1.4.2" class="ltx_td ltx_align_center" style="padding-left:11.4pt;padding-right:11.4pt;"><span id="S4.T2.1.1.4.2.1" class="ltx_text" style="font-size:144%;">62.1</span></td>
<td id="S4.T2.1.1.4.3" class="ltx_td ltx_align_center" style="padding-left:11.4pt;padding-right:11.4pt;"><span id="S4.T2.1.1.4.3.1" class="ltx_text" style="font-size:144%;">58.5</span></td>
<td id="S4.T2.1.1.4.4" class="ltx_td ltx_align_center" style="padding-left:11.4pt;padding-right:11.4pt;"><span id="S4.T2.1.1.4.4.1" class="ltx_text" style="font-size:144%;">54.9</span></td>
<td id="S4.T2.1.1.4.5" class="ltx_td ltx_align_center" style="padding-left:11.4pt;padding-right:11.4pt;"><span id="S4.T2.1.1.4.5.1" class="ltx_text" style="font-size:144%;">50.0</span></td>
<td id="S4.T2.1.1.4.6" class="ltx_td ltx_align_center" style="padding-left:11.4pt;padding-right:11.4pt;"><span id="S4.T2.1.1.4.6.1" class="ltx_text" style="font-size:144%;">46.0</span></td>
</tr>
<tr id="S4.T2.1.1.5" class="ltx_tr">
<td id="S4.T2.1.1.5.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_r" style="padding-left:11.4pt;padding-right:11.4pt;"><span id="S4.T2.1.1.5.1.1" class="ltx_text" style="font-size:144%;">Ours</span></td>
<td id="S4.T2.1.1.5.2" class="ltx_td ltx_align_center ltx_border_b" style="padding-left:11.4pt;padding-right:11.4pt;"><span id="S4.T2.1.1.5.2.1" class="ltx_text ltx_font_bold" style="font-size:144%;">66.8</span></td>
<td id="S4.T2.1.1.5.3" class="ltx_td ltx_align_center ltx_border_b" style="padding-left:11.4pt;padding-right:11.4pt;"><span id="S4.T2.1.1.5.3.1" class="ltx_text ltx_font_bold" style="font-size:144%;">62.4</span></td>
<td id="S4.T2.1.1.5.4" class="ltx_td ltx_align_center ltx_border_b" style="padding-left:11.4pt;padding-right:11.4pt;"><span id="S4.T2.1.1.5.4.1" class="ltx_text ltx_font_bold" style="font-size:144%;">57.0</span></td>
<td id="S4.T2.1.1.5.5" class="ltx_td ltx_align_center ltx_border_b" style="padding-left:11.4pt;padding-right:11.4pt;"><span id="S4.T2.1.1.5.5.1" class="ltx_text ltx_font_bold" style="font-size:144%;">54.7</span></td>
<td id="S4.T2.1.1.5.6" class="ltx_td ltx_align_center ltx_border_b" style="padding-left:11.4pt;padding-right:11.4pt;"><span id="S4.T2.1.1.5.6.1" class="ltx_text ltx_font_bold" style="font-size:144%;">50.3</span></td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption" style="font-size:144%;"><span class="ltx_tag ltx_tag_table">Table 2: </span>Performance of L2 mAPH under different resolutions (1x to 5x) on the Waymo val. set for vehicle detection.
</figcaption>
</figure>
<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">Experiments are conducted on two large-scale LiDAR object detection benchmarks: Waymo Open Dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> and ONCE dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>.
In Sec. <a href="#S4.SS1" title="4.1 Experimental setup ‣ 4 Experiments ‣ PARTNER: Level up the Polar Representation for LiDAR 3D Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a>, we introduce the experimental details.
Then we compare our method with other state-of-the-art methods in Sec. <a href="#S4.SS2" title="4.2 Experiments on the Waymo Open Dataset ‣ 4 Experiments ‣ PARTNER: Level up the Polar Representation for LiDAR 3D Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a> and Sec. <a href="#S4.SS3" title="4.3 Experiments on the ONCE dataset ‣ 4 Experiments ‣ PARTNER: Level up the Polar Representation for LiDAR 3D Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.3</span></a>.
Finally, to investigate the effect of different components in our method, we conduct ablation studies in Sec. <a href="#S4.SS4" title="4.4 Ablation studies ‣ 4 Experiments ‣ PARTNER: Level up the Polar Representation for LiDAR 3D Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.4</span></a>.</p>
</div>
<figure id="S4.F5" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F5.fig1" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_middle" style="width:238.5pt;">
<div id="S4.F5.fig1.1" class="ltx_inline-block ltx_transformed_outer" style="width:506.8pt;height:182.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(53.1pt,-19.1pt) scale(1.26537104111858,1.26537104111858) ;">
<table id="S4.F5.fig1.1.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.F5.fig1.1.1.1" class="ltx_tr">
<td id="S4.F5.fig1.1.1.1.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_r ltx_border_t" style="padding:2.5pt 1.7pt;" rowspan="2"><span id="S4.F5.fig1.1.1.1.1.1" class="ltx_text">Method</span></td>
<td id="S4.F5.fig1.1.1.1.2" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t" style="padding:2.5pt 1.7pt;" colspan="5">Number of streaming sectors</td>
</tr>
<tr id="S4.F5.fig1.1.1.2" class="ltx_tr">
<td id="S4.F5.fig1.1.1.2.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:2.5pt 1.7pt;">1</td>
<td id="S4.F5.fig1.1.1.2.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:2.5pt 1.7pt;">2</td>
<td id="S4.F5.fig1.1.1.2.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:2.5pt 1.7pt;">4</td>
<td id="S4.F5.fig1.1.1.2.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:2.5pt 1.7pt;">6</td>
<td id="S4.F5.fig1.1.1.2.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:2.5pt 1.7pt;">8</td>
</tr>
<tr id="S4.F5.fig1.1.1.3" class="ltx_tr">
<td id="S4.F5.fig1.1.1.3.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_r ltx_border_tt" style="padding:2.5pt 1.7pt;">STROBE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>
</td>
<td id="S4.F5.fig1.1.1.3.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_tt" style="padding:2.5pt 1.7pt;">60.5/59.8</td>
<td id="S4.F5.fig1.1.1.3.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_tt" style="padding:2.5pt 1.7pt;">59.5/58.9</td>
<td id="S4.F5.fig1.1.1.3.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_tt" style="padding:2.5pt 1.7pt;">58.8/58.3</td>
<td id="S4.F5.fig1.1.1.3.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_tt" style="padding:2.5pt 1.7pt;">58.3/57.6</td>
<td id="S4.F5.fig1.1.1.3.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_tt" style="padding:2.5pt 1.7pt;">58.0/57.3</td>
</tr>
<tr id="S4.F5.fig1.1.1.4" class="ltx_tr">
<td id="S4.F5.fig1.1.1.4.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_r" style="padding:2.5pt 1.7pt;">Han <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>
</td>
<td id="S4.F5.fig1.1.1.4.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:2.5pt 1.7pt;">61.8/61.4</td>
<td id="S4.F5.fig1.1.1.4.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:2.5pt 1.7pt;">61.7/61.1</td>
<td id="S4.F5.fig1.1.1.4.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:2.5pt 1.7pt;">60.7/60.2</td>
<td id="S4.F5.fig1.1.1.4.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:2.5pt 1.7pt;">60.0/59.3</td>
<td id="S4.F5.fig1.1.1.4.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:2.5pt 1.7pt;">59.9/59.3</td>
</tr>
<tr id="S4.F5.fig1.1.1.5" class="ltx_tr">
<td id="S4.F5.fig1.1.1.5.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_r ltx_border_t" style="padding:2.5pt 1.7pt;">Cartesian <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>
</td>
<td id="S4.F5.fig1.1.1.5.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding:2.5pt 1.7pt;">62.5/61.8</td>
<td id="S4.F5.fig1.1.1.5.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding:2.5pt 1.7pt;">61.6/60.9</td>
<td id="S4.F5.fig1.1.1.5.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding:2.5pt 1.7pt;">60.5/60.0</td>
<td id="S4.F5.fig1.1.1.5.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding:2.5pt 1.7pt;">59.8/59.1</td>
<td id="S4.F5.fig1.1.1.5.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding:2.5pt 1.7pt;">59.4/58.7</td>
</tr>
<tr id="S4.F5.fig1.1.1.6" class="ltx_tr">
<td id="S4.F5.fig1.1.1.6.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_r" style="padding:2.5pt 1.7pt;">Polar <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>
</td>
<td id="S4.F5.fig1.1.1.6.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:2.5pt 1.7pt;">61.0/60.4</td>
<td id="S4.F5.fig1.1.1.6.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:2.5pt 1.7pt;">61.5/60.9</td>
<td id="S4.F5.fig1.1.1.6.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:2.5pt 1.7pt;">61.0/60.6</td>
<td id="S4.F5.fig1.1.1.6.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:2.5pt 1.7pt;">60.2/59.5</td>
<td id="S4.F5.fig1.1.1.6.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:2.5pt 1.7pt;">60.4/59.9</td>
</tr>
<tr id="S4.F5.fig1.1.1.7" class="ltx_tr">
<td id="S4.F5.fig1.1.1.7.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_r ltx_border_t" style="padding:2.5pt 1.7pt;">PolarStream <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>
</td>
<td id="S4.F5.fig1.1.1.7.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding:2.5pt 1.7pt;">61.4/60.8</td>
<td id="S4.F5.fig1.1.1.7.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding:2.5pt 1.7pt;">61.8/61.2</td>
<td id="S4.F5.fig1.1.1.7.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding:2.5pt 1.7pt;">61.2/60.7</td>
<td id="S4.F5.fig1.1.1.7.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding:2.5pt 1.7pt;">60.3/59.7</td>
<td id="S4.F5.fig1.1.1.7.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding:2.5pt 1.7pt;">60.7/60.2</td>
</tr>
<tr id="S4.F5.fig1.1.1.8" class="ltx_tr">
<td id="S4.F5.fig1.1.1.8.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_b ltx_border_r" style="padding:2.5pt 1.7pt;">Ours</td>
<td id="S4.F5.fig1.1.1.8.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b" style="padding:2.5pt 1.7pt;"><span id="S4.F5.fig1.1.1.8.2.1" class="ltx_text ltx_font_bold">63.8/63.2</span></td>
<td id="S4.F5.fig1.1.1.8.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b" style="padding:2.5pt 1.7pt;"><span id="S4.F5.fig1.1.1.8.3.1" class="ltx_text ltx_font_bold">64.3/63.8</span></td>
<td id="S4.F5.fig1.1.1.8.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b" style="padding:2.5pt 1.7pt;"><span id="S4.F5.fig1.1.1.8.4.1" class="ltx_text ltx_font_bold">66.0/65.5</span></td>
<td id="S4.F5.fig1.1.1.8.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b" style="padding:2.5pt 1.7pt;"><span id="S4.F5.fig1.1.1.8.5.1" class="ltx_text ltx_font_bold">65.3/64.7</span></td>
<td id="S4.F5.fig1.1.1.8.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b" style="padding:2.5pt 1.7pt;"><span id="S4.F5.fig1.1.1.8.6.1" class="ltx_text ltx_font_bold">64.5/64.0</span></td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Table 3: </span>Performance of streaming detection on the Waymo val. set for vehicle detection.
We show the 6 epochs results in L2.</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F5.1" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_middle" style="width:223.6pt;"><img src="/html/2308.03982/assets/x5.png" id="S4.F5.1.g1" class="ltx_graphics ltx_img_landscape" width="188" height="126" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Comparison of different streaming methods wrt. detection results vs latency on Waymo val. set.</figcaption>
</figure>
</div>
</div>
</figure>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Experimental setup</h3>

<div id="S4.SS1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS1.p1.4" class="ltx_p"><span id="S4.SS1.p1.4.1" class="ltx_text ltx_font_bold">Waymo Open Dataset.</span>
The Waymo Open Dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> contains 798 point cloud sequences for training and 202 sequences for validation.
The evaluation metrics on the Waymo Open Dataset are 3D mean Average Precision (mAP) and mAP weighted by heading accuracy (mAPH).
The mAP and mAPH are based on an IoU threshold of 0.7 for vehicles and 0.5 for other categories.
The evaluated detection results are also provided with two difficulty levels: LEVEL 1 for boxes with more than 5 LiDAR points and LEVEL 2 for boxes with at least 1 LiDAR point.
Our model adopts a detection range of [0.3m, 75.18m] for the <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mi id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">r</annotation></semantics></math> axis, [<math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="-\pi" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><mrow id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><mo id="S4.SS1.p1.2.m2.1.1a" xref="S4.SS1.p1.2.m2.1.1.cmml">−</mo><mi id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml">π</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"><minus id="S4.SS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"></minus><ci id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2">𝜋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">-\pi</annotation></semantics></math>, <math id="S4.SS1.p1.3.m3.1" class="ltx_Math" alttext="\pi" display="inline"><semantics id="S4.SS1.p1.3.m3.1a"><mi id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><ci id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">\pi</annotation></semantics></math>] for the <math id="S4.SS1.p1.4.m4.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S4.SS1.p1.4.m4.1a"><mi id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><ci id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">a</annotation></semantics></math> axis, and [-2m, 4m] for the <span id="S4.SS1.p1.4.2" class="ltx_text ltx_font_italic">z</span> axis.</p>
</div>
<figure id="S4.T4" class="ltx_table">
<div id="S4.T4.2" class="ltx_inline-block ltx_transformed_outer" style="width:248.4pt;height:68.6pt;vertical-align:-0.5pt;"><span class="ltx_transformed_inner" style="transform:translate(-139.6pt,38.2pt) scale(0.470832437200811,0.470832437200811) ;">
<table id="S4.T4.2.2" class="ltx_tabular ltx_align_middle">
<tr id="S4.T4.2.2.3" class="ltx_tr">
<td id="S4.T4.2.2.3.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="S4.T4.2.2.3.1.1" class="ltx_text" style="font-size:144%;">Method</span></td>
<td id="S4.T4.2.2.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="S4.T4.2.2.3.2.1" class="ltx_text" style="font-size:144%;">Overall</span></td>
<td id="S4.T4.2.2.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="S4.T4.2.2.3.3.1" class="ltx_text" style="font-size:144%;">Vehicle</span></td>
<td id="S4.T4.2.2.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="S4.T4.2.2.3.4.1" class="ltx_text" style="font-size:144%;">Pedestrian</span></td>
<td id="S4.T4.2.2.3.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="S4.T4.2.2.3.5.1" class="ltx_text" style="font-size:144%;">Cyclist</span></td>
</tr>
<tr id="S4.T4.2.2.4" class="ltx_tr">
<td id="S4.T4.2.2.4.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" style="padding-top:2.9pt;padding-bottom:2.9pt;">
<span id="S4.T4.2.2.4.1.1" class="ltx_text" style="font-size:144%;">PointRCNN </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T4.2.2.4.1.2.1" class="ltx_text" style="font-size:144%;">[</span><a href="#bib.bib24" title="" class="ltx_ref">24</a><span id="S4.T4.2.2.4.1.3.2" class="ltx_text" style="font-size:144%;">]</span></cite>
</td>
<td id="S4.T4.2.2.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="S4.T4.2.2.4.2.1" class="ltx_text" style="font-size:144%;">28.74</span></td>
<td id="S4.T4.2.2.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="S4.T4.2.2.4.3.1" class="ltx_text" style="font-size:144%;">52.09</span></td>
<td id="S4.T4.2.2.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="S4.T4.2.2.4.4.1" class="ltx_text" style="font-size:144%;">4.28</span></td>
<td id="S4.T4.2.2.4.5" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="S4.T4.2.2.4.5.1" class="ltx_text" style="font-size:144%;">29.84</span></td>
</tr>
<tr id="S4.T4.2.2.5" class="ltx_tr">
<td id="S4.T4.2.2.5.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:2.9pt;padding-bottom:2.9pt;">
<span id="S4.T4.2.2.5.1.1" class="ltx_text" style="font-size:144%;">PointPillars </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T4.2.2.5.1.2.1" class="ltx_text" style="font-size:144%;">[</span><a href="#bib.bib12" title="" class="ltx_ref">12</a><span id="S4.T4.2.2.5.1.3.2" class="ltx_text" style="font-size:144%;">]</span></cite>
</td>
<td id="S4.T4.2.2.5.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="S4.T4.2.2.5.2.1" class="ltx_text" style="font-size:144%;">44.34</span></td>
<td id="S4.T4.2.2.5.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="S4.T4.2.2.5.3.1" class="ltx_text" style="font-size:144%;">68.57</span></td>
<td id="S4.T4.2.2.5.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="S4.T4.2.2.5.4.1" class="ltx_text" style="font-size:144%;">17.63</span></td>
<td id="S4.T4.2.2.5.5" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="S4.T4.2.2.5.5.1" class="ltx_text" style="font-size:144%;">46.81</span></td>
</tr>
<tr id="S4.T4.2.2.6" class="ltx_tr">
<td id="S4.T4.2.2.6.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:2.9pt;padding-bottom:2.9pt;">
<span id="S4.T4.2.2.6.1.1" class="ltx_text" style="font-size:144%;">PV-RCNN </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T4.2.2.6.1.2.1" class="ltx_text" style="font-size:144%;">[</span><a href="#bib.bib23" title="" class="ltx_ref">23</a><span id="S4.T4.2.2.6.1.3.2" class="ltx_text" style="font-size:144%;">]</span></cite>
</td>
<td id="S4.T4.2.2.6.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="S4.T4.2.2.6.2.1" class="ltx_text" style="font-size:144%;">55.35</span></td>
<td id="S4.T4.2.2.6.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="S4.T4.2.2.6.3.1" class="ltx_text" style="font-size:144%;">77.77</span></td>
<td id="S4.T4.2.2.6.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="S4.T4.2.2.6.4.1" class="ltx_text" style="font-size:144%;">23.50</span></td>
<td id="S4.T4.2.2.6.5" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="S4.T4.2.2.6.5.1" class="ltx_text" style="font-size:144%;">59.37</span></td>
</tr>
<tr id="S4.T4.2.2.7" class="ltx_tr">
<td id="S4.T4.2.2.7.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:2.9pt;padding-bottom:2.9pt;">
<span id="S4.T4.2.2.7.1.1" class="ltx_text" style="font-size:144%;">CenterPoint-Cartesian </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T4.2.2.7.1.2.1" class="ltx_text" style="font-size:144%;">[</span><a href="#bib.bib32" title="" class="ltx_ref">32</a><span id="S4.T4.2.2.7.1.3.2" class="ltx_text" style="font-size:144%;">]</span></cite>
</td>
<td id="S4.T4.2.2.7.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="S4.T4.2.2.7.2.1" class="ltx_text" style="font-size:144%;">60.05</span></td>
<td id="S4.T4.2.2.7.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="S4.T4.2.2.7.3.1" class="ltx_text" style="font-size:144%;">66.79</span></td>
<td id="S4.T4.2.2.7.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="S4.T4.2.2.7.4.1" class="ltx_text" style="font-size:144%;">49.90</span></td>
<td id="S4.T4.2.2.7.5" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="S4.T4.2.2.7.5.1" class="ltx_text" style="font-size:144%;">63.45</span></td>
</tr>
<tr id="S4.T4.1.1.1" class="ltx_tr">
<td id="S4.T4.1.1.1.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" style="padding-top:2.9pt;padding-bottom:2.9pt;">
<span id="S4.T4.1.1.1.1.1" class="ltx_text" style="font-size:144%;">CenterPoint-Polar</span><sup id="S4.T4.1.1.1.1.2" class="ltx_sup"><span id="S4.T4.1.1.1.1.2.1" class="ltx_text ltx_font_italic" style="font-size:144%;">†</span></sup><span id="S4.T4.1.1.1.1.3" class="ltx_text" style="font-size:144%;"> </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T4.1.1.1.1.4.1" class="ltx_text" style="font-size:144%;">[</span><a href="#bib.bib32" title="" class="ltx_ref">32</a><span id="S4.T4.1.1.1.1.5.2" class="ltx_text" style="font-size:144%;">]</span></cite>
</td>
<td id="S4.T4.1.1.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="S4.T4.1.1.1.2.1" class="ltx_text" style="font-size:144%;">49.55</span></td>
<td id="S4.T4.1.1.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="S4.T4.1.1.1.3.1" class="ltx_text" style="font-size:144%;">64.62</span></td>
<td id="S4.T4.1.1.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="S4.T4.1.1.1.4.1" class="ltx_text" style="font-size:144%;">24.67</span></td>
<td id="S4.T4.1.1.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="S4.T4.1.1.1.5.1" class="ltx_text" style="font-size:144%;">59.35</span></td>
</tr>
<tr id="S4.T4.2.2.2" class="ltx_tr">
<td id="S4.T4.2.2.2.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:2.9pt;padding-bottom:2.9pt;">
<span id="S4.T4.2.2.2.1.1" class="ltx_text" style="font-size:144%;">PolarStream</span><sup id="S4.T4.2.2.2.1.2" class="ltx_sup"><span id="S4.T4.2.2.2.1.2.1" class="ltx_text ltx_font_italic" style="font-size:144%;">†</span></sup><span id="S4.T4.2.2.2.1.3" class="ltx_text" style="font-size:144%;"> </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T4.2.2.2.1.4.1" class="ltx_text" style="font-size:144%;">[</span><a href="#bib.bib3" title="" class="ltx_ref">3</a><span id="S4.T4.2.2.2.1.5.2" class="ltx_text" style="font-size:144%;">]</span></cite>
</td>
<td id="S4.T4.2.2.2.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="S4.T4.2.2.2.2.1" class="ltx_text" style="font-size:144%;">53.33</span></td>
<td id="S4.T4.2.2.2.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="S4.T4.2.2.2.3.1" class="ltx_text" style="font-size:144%;">65.54</span></td>
<td id="S4.T4.2.2.2.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="S4.T4.2.2.2.4.1" class="ltx_text" style="font-size:144%;">33.76</span></td>
<td id="S4.T4.2.2.2.5" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="S4.T4.2.2.2.5.1" class="ltx_text" style="font-size:144%;">60.69</span></td>
</tr>
<tr id="S4.T4.2.2.8" class="ltx_tr">
<td id="S4.T4.2.2.8.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_r" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="S4.T4.2.2.8.1.1" class="ltx_text" style="font-size:144%;">PARTNER (Ours)</span></td>
<td id="S4.T4.2.2.8.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="S4.T4.2.2.8.2.1" class="ltx_text ltx_font_bold" style="font-size:144%;">63.15</span></td>
<td id="S4.T4.2.2.8.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="S4.T4.2.2.8.3.1" class="ltx_text ltx_font_bold" style="font-size:144%;">68.07</span></td>
<td id="S4.T4.2.2.8.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="S4.T4.2.2.8.4.1" class="ltx_text ltx_font_bold" style="font-size:144%;">53.45</span></td>
<td id="S4.T4.2.2.8.5" class="ltx_td ltx_align_center ltx_border_b" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="S4.T4.2.2.8.5.1" class="ltx_text ltx_font_bold" style="font-size:144%;">65.93</span></td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption" style="font-size:144%;"><span class="ltx_tag ltx_tag_table">Table 4: </span>Performance comparisons of 3D object detection on the ONCE val. set.
<sup id="S4.T4.9.1" class="ltx_sup"><span id="S4.T4.9.1.1" class="ltx_text ltx_font_italic">†</span></sup>: re-implemented using the official code.
</figcaption>
</figure>
<div id="S4.SS1.p2" class="ltx_para ltx_noindent">
<p id="S4.SS1.p2.4" class="ltx_p"><span id="S4.SS1.p2.4.1" class="ltx_text ltx_font_bold">ONCE dataset.</span>
In the ONCE dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>, there are one million point cloud frames in total, with 5k, 3k, and 8k frames annotated for training, validation, and testing.
The unlabeled point cloud frames are kept for self-supervised learning or semi-supervised learning.
Our ONCE model is trained on the training set and evaluated on the validation and testing set without using the unlabeled data.
The evaluation metric follows Waymo Open Dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> and it does not differentiate between L1 and L2.
On the ONCE Dataset, the detection range is set to [0.3m, 75.18m] for the <math id="S4.SS1.p2.1.m1.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S4.SS1.p2.1.m1.1a"><mi id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><ci id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">r</annotation></semantics></math> axis, [<math id="S4.SS1.p2.2.m2.1" class="ltx_Math" alttext="-\pi" display="inline"><semantics id="S4.SS1.p2.2.m2.1a"><mrow id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml"><mo id="S4.SS1.p2.2.m2.1.1a" xref="S4.SS1.p2.2.m2.1.1.cmml">−</mo><mi id="S4.SS1.p2.2.m2.1.1.2" xref="S4.SS1.p2.2.m2.1.1.2.cmml">π</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><apply id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1"><minus id="S4.SS1.p2.2.m2.1.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1"></minus><ci id="S4.SS1.p2.2.m2.1.1.2.cmml" xref="S4.SS1.p2.2.m2.1.1.2">𝜋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">-\pi</annotation></semantics></math>, <math id="S4.SS1.p2.3.m3.1" class="ltx_Math" alttext="\pi" display="inline"><semantics id="S4.SS1.p2.3.m3.1a"><mi id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b"><ci id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">\pi</annotation></semantics></math>] for the <math id="S4.SS1.p2.4.m4.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S4.SS1.p2.4.m4.1a"><mi id="S4.SS1.p2.4.m4.1.1" xref="S4.SS1.p2.4.m4.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m4.1b"><ci id="S4.SS1.p2.4.m4.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.4.m4.1c">a</annotation></semantics></math> axis, and [-5m, 3m] for the <span id="S4.SS1.p2.4.2" class="ltx_text ltx_font_italic">z</span> axis.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para ltx_noindent">
<p id="S4.SS1.p3.1" class="ltx_p"><span id="S4.SS1.p3.1.1" class="ltx_text ltx_font_bold">Implementation details.</span>
We use the same 3D backbone design, and training schedules as  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>.
The model is trained with the ADAM optimizer and the cosine annealing learning rate scheduler on both two datasets.
On the Waymo Open Dataset, we train our model with batch size 32 and the initial learning rate of 0.003 for 36 epochs on 8 V100 GPUs.
On the ONCE dataset, the batch size and the initial learning rate are not changed, and the training epochs are adapted to 80.
Other training settings follow the respective benchmark.
The voxel size is [0.065, 0.00307, 0.15] for the 1x model.
Due to computational resource limitations, we report the results of streaming-based pipeline, different resolutions, and ablation studies with models trained within 6 or 12 epochs on the Waymo Open Dataset.
More details are included in the appendix.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Experiments on the Waymo Open Dataset</h3>

<div id="S4.SS2.p1" class="ltx_para ltx_noindent">
<p id="S4.SS2.p1.3" class="ltx_p"><span id="S4.SS2.p1.3.1" class="ltx_text ltx_font_bold">Comparison with previous methods.</span>
For a fair comparison, we re-implement two baseline models from their official implementations: CenterPoint <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>, a Cartesian-based method, and PolarStream <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, the state-of-the-art polar-based method.
Our proposed PARTNER, re-implemented PolarStream, and CenterPoint have the same voxel-based 3D backbone, task heads, data augmentations, and training epochs to ensure a fair comparison.
Table <a href="#S3.T1" title="Table 1 ‣ Geometry-aware prediction. ‣ 3.3 Geometry-aware adaptive module ‣ 3 Method ‣ PARTNER: Level up the Polar Representation for LiDAR 3D Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows the detection results on the Waymo validation set.
Adopting CenterPoint <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> as baseline, our method attains <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="76.05\%" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mrow id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><mn id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml">76.05</mn><mo id="S4.SS2.p1.1.m1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><csymbol cd="latexml" id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1">percent</csymbol><cn type="float" id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2">76.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">76.05\%</annotation></semantics></math> LEVEL 1 mAP and <math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="68.58\%" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><mrow id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml"><mn id="S4.SS2.p1.2.m2.1.1.2" xref="S4.SS2.p1.2.m2.1.1.2.cmml">68.58</mn><mo id="S4.SS2.p1.2.m2.1.1.1" xref="S4.SS2.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><apply id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1"><csymbol cd="latexml" id="S4.SS2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1.1">percent</csymbol><cn type="float" id="S4.SS2.p1.2.m2.1.1.2.cmml" xref="S4.SS2.p1.2.m2.1.1.2">68.58</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">68.58\%</annotation></semantics></math> LEVEL 2 mAP for vehicle detection, surpassing existing polar-based methods by a significant margin.
Also, our approach outperforms those Cartesian-based 3D detectors <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>, manifesting the effectiveness of our method.
Besides, we also report our results with CenterFormer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> as a stronger baseline.
Experimental results present the state-of-the-art L2 mAP (<math id="S4.SS2.p1.3.m3.1" class="ltx_Math" alttext="70.3\%" display="inline"><semantics id="S4.SS2.p1.3.m3.1a"><mrow id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml"><mn id="S4.SS2.p1.3.m3.1.1.2" xref="S4.SS2.p1.3.m3.1.1.2.cmml">70.3</mn><mo id="S4.SS2.p1.3.m3.1.1.1" xref="S4.SS2.p1.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><apply id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1"><csymbol cd="latexml" id="S4.SS2.p1.3.m3.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1">percent</csymbol><cn type="float" id="S4.SS2.p1.3.m3.1.1.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2">70.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">70.3\%</annotation></semantics></math>), proving the potentiality of polar representation.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para ltx_noindent">
<p id="S4.SS2.p2.1" class="ltx_p"><span id="S4.SS2.p2.1.1" class="ltx_text ltx_font_bold">Comparison on streaming-based pipeline.</span>
We perform 3D detection in a streaming manner by separating the point cloud into individual polar sectors and processing each sector similarly to the full-sweep method.
For benchmarking streaming detection, we also re-implement Cartesian representation methods following PolarStream <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>.
As is shown in Table <a href="#S4.F5" title="Figure 5 ‣ 4 Experiments ‣ PARTNER: Level up the Polar Representation for LiDAR 3D Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, our method outperforms previous state-of-the-art methods under any number of sectors with a large margin, proving the superiority of our method in steaming-based detection.
Moreover, the trade-offs between latency and accuracy, as illustrated in Figure <a href="#S4.F5" title="Figure 5 ‣ 4 Experiments ‣ PARTNER: Level up the Polar Representation for LiDAR 3D Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, also demonstrate the significant advantages of our method.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.1" class="ltx_p">To further validate the effectiveness of our PARTNER and its consistency under different grid-based methods, <em id="S4.SS2.p3.1.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S4.SS2.p3.1.2" class="ltx_text"></span>, pillar-based approaches, we deploy our proposed global representation realignment and geometry-aware adaptive head onto PointPillars <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> under streaming scenarios.
As is shown in Table <a href="#S4.T5" title="Table 5 ‣ 4.2 Experiments on the Waymo Open Dataset ‣ 4 Experiments ‣ PARTNER: Level up the Polar Representation for LiDAR 3D Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, our method still outperforms PolarStream <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> with a pillar-based backbone under any number of sectors with a large margin, indicating both the effectiveness and the generalization of our method.</p>
</div>
<figure id="S4.T5" class="ltx_table">
<div id="S4.T5.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:238.5pt;height:32pt;vertical-align:-0.4pt;"><span class="ltx_transformed_inner" style="transform:translate(-152.8pt,20.2pt) scale(0.438369291319612,0.438369291319612) ;">
<table id="S4.T5.1.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T5.1.1.1" class="ltx_tr">
<td id="S4.T5.1.1.1.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" style="padding-top:1.45pt;padding-bottom:1.45pt;" rowspan="2"><span id="S4.T5.1.1.1.1.1" class="ltx_text" style="font-size:144%;">Method</span></td>
<td id="S4.T5.1.1.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.45pt;padding-bottom:1.45pt;" colspan="4"><span id="S4.T5.1.1.1.2.1" class="ltx_text" style="font-size:144%;">Number of streaming sectors</span></td>
</tr>
<tr id="S4.T5.1.1.2" class="ltx_tr">
<td id="S4.T5.1.1.2.1" class="ltx_td ltx_align_center" style="padding-top:1.45pt;padding-bottom:1.45pt;"><span id="S4.T5.1.1.2.1.1" class="ltx_text" style="font-size:144%;">1</span></td>
<td id="S4.T5.1.1.2.2" class="ltx_td ltx_align_center" style="padding-top:1.45pt;padding-bottom:1.45pt;"><span id="S4.T5.1.1.2.2.1" class="ltx_text" style="font-size:144%;">2</span></td>
<td id="S4.T5.1.1.2.3" class="ltx_td ltx_align_center" style="padding-top:1.45pt;padding-bottom:1.45pt;"><span id="S4.T5.1.1.2.3.1" class="ltx_text" style="font-size:144%;">4</span></td>
<td id="S4.T5.1.1.2.4" class="ltx_td ltx_align_center" style="padding-top:1.45pt;padding-bottom:1.45pt;"><span id="S4.T5.1.1.2.4.1" class="ltx_text" style="font-size:144%;">8</span></td>
</tr>
<tr id="S4.T5.1.1.3" class="ltx_tr">
<td id="S4.T5.1.1.3.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" style="padding-top:1.45pt;padding-bottom:1.45pt;">
<span id="S4.T5.1.1.3.1.1" class="ltx_text" style="font-size:144%;">PolarStream </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T5.1.1.3.1.2.1" class="ltx_text" style="font-size:144%;">[</span><a href="#bib.bib3" title="" class="ltx_ref">3</a><span id="S4.T5.1.1.3.1.3.2" class="ltx_text" style="font-size:144%;">]</span></cite>
</td>
<td id="S4.T5.1.1.3.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:1.45pt;padding-bottom:1.45pt;"><span id="S4.T5.1.1.3.2.1" class="ltx_text" style="font-size:144%;">61.2/60.6</span></td>
<td id="S4.T5.1.1.3.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:1.45pt;padding-bottom:1.45pt;"><span id="S4.T5.1.1.3.3.1" class="ltx_text" style="font-size:144%;">60.5/59.9</span></td>
<td id="S4.T5.1.1.3.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:1.45pt;padding-bottom:1.45pt;"><span id="S4.T5.1.1.3.4.1" class="ltx_text" style="font-size:144%;">60.3/59.7</span></td>
<td id="S4.T5.1.1.3.5" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:1.45pt;padding-bottom:1.45pt;"><span id="S4.T5.1.1.3.5.1" class="ltx_text" style="font-size:144%;">58.6/58.0</span></td>
</tr>
<tr id="S4.T5.1.1.4" class="ltx_tr">
<td id="S4.T5.1.1.4.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_r" style="padding-top:1.45pt;padding-bottom:1.45pt;"><span id="S4.T5.1.1.4.1.1" class="ltx_text" style="font-size:144%;">Ours</span></td>
<td id="S4.T5.1.1.4.2" class="ltx_td ltx_align_center ltx_border_b" style="padding-top:1.45pt;padding-bottom:1.45pt;"><span id="S4.T5.1.1.4.2.1" class="ltx_text ltx_font_bold" style="font-size:144%;">62.4/61.8</span></td>
<td id="S4.T5.1.1.4.3" class="ltx_td ltx_align_center ltx_border_b" style="padding-top:1.45pt;padding-bottom:1.45pt;"><span id="S4.T5.1.1.4.3.1" class="ltx_text ltx_font_bold" style="font-size:144%;">62.8/62.2</span></td>
<td id="S4.T5.1.1.4.4" class="ltx_td ltx_align_center ltx_border_b" style="padding-top:1.45pt;padding-bottom:1.45pt;"><span id="S4.T5.1.1.4.4.1" class="ltx_text ltx_font_bold" style="font-size:144%;">62.6/62.0</span></td>
<td id="S4.T5.1.1.4.5" class="ltx_td ltx_align_center ltx_border_b" style="padding-top:1.45pt;padding-bottom:1.45pt;"><span id="S4.T5.1.1.4.5.1" class="ltx_text ltx_font_bold" style="font-size:144%;">63.1/62.6</span></td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption" style="font-size:144%;"><span class="ltx_tag ltx_tag_table">Table 5: </span>Performance of streaming detection based on PointPillars for vehicle detection.
We show the mAP/mAPH of 6 epochs in the L2 difficulty level for Waymo dataset.
</figcaption>
</figure>
<div id="S4.SS2.p4" class="ltx_para ltx_noindent">
<p id="S4.SS2.p4.1" class="ltx_p"><span id="S4.SS2.p4.1.1" class="ltx_text ltx_font_bold">Comparison on different resolutions.</span>
Another promising intrinsic characteristic of polar-based LiDAR detection is the robust performance under different resolutions.
The experimental results in Table <a href="#S4.T2" title="Table 2 ‣ 4 Experiments ‣ PARTNER: Level up the Polar Representation for LiDAR 3D Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> demonstrate that the Cartesian-based method suffers an exponential performance drop (35.6% in the 5x model), whereas polar-based methods are less affected (50.3% in the 5x model).
Meanwhile, with the increase of resolution, <em id="S4.SS2.p4.1.2" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S4.SS2.p4.1.3" class="ltx_text"></span>, the decrease of the grid scale, PolarStream <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> shows that it is limited by feature distortion, which is overcome by our method (+4.7% in 1x model).</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Experiments on the ONCE dataset</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.6" class="ltx_p">The ONCE dataset benchmarks different voxel-based detectors using the same backbone network, and we also follow this rule for a fair comparison.
As is shown in Table <a href="#A1.T9" title="Table 9 ‣ A.2 Global representation re-alignment ‣ Appendix A Implementation details ‣ PARTNER: Level up the Polar Representation for LiDAR 3D Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>, PARTNER attains competitive results in all classes, with <math id="S4.SS3.p1.1.m1.1" class="ltx_Math" alttext="68.07\%" display="inline"><semantics id="S4.SS3.p1.1.m1.1a"><mrow id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml"><mn id="S4.SS3.p1.1.m1.1.1.2" xref="S4.SS3.p1.1.m1.1.1.2.cmml">68.07</mn><mo id="S4.SS3.p1.1.m1.1.1.1" xref="S4.SS3.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><apply id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1"><csymbol cd="latexml" id="S4.SS3.p1.1.m1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1.1">percent</csymbol><cn type="float" id="S4.SS3.p1.1.m1.1.1.2.cmml" xref="S4.SS3.p1.1.m1.1.1.2">68.07</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">68.07\%</annotation></semantics></math> mAP for vehicle detection, <math id="S4.SS3.p1.2.m2.1" class="ltx_Math" alttext="53.45\%" display="inline"><semantics id="S4.SS3.p1.2.m2.1a"><mrow id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml"><mn id="S4.SS3.p1.2.m2.1.1.2" xref="S4.SS3.p1.2.m2.1.1.2.cmml">53.45</mn><mo id="S4.SS3.p1.2.m2.1.1.1" xref="S4.SS3.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><apply id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1"><csymbol cd="latexml" id="S4.SS3.p1.2.m2.1.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1.1">percent</csymbol><cn type="float" id="S4.SS3.p1.2.m2.1.1.2.cmml" xref="S4.SS3.p1.2.m2.1.1.2">53.45</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">53.45\%</annotation></semantics></math> mAP for pedestrian detection, and <math id="S4.SS3.p1.3.m3.1" class="ltx_Math" alttext="65.93\%" display="inline"><semantics id="S4.SS3.p1.3.m3.1a"><mrow id="S4.SS3.p1.3.m3.1.1" xref="S4.SS3.p1.3.m3.1.1.cmml"><mn id="S4.SS3.p1.3.m3.1.1.2" xref="S4.SS3.p1.3.m3.1.1.2.cmml">65.93</mn><mo id="S4.SS3.p1.3.m3.1.1.1" xref="S4.SS3.p1.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.1b"><apply id="S4.SS3.p1.3.m3.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1"><csymbol cd="latexml" id="S4.SS3.p1.3.m3.1.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1.1">percent</csymbol><cn type="float" id="S4.SS3.p1.3.m3.1.1.2.cmml" xref="S4.SS3.p1.3.m3.1.1.2">65.93</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.1c">65.93\%</annotation></semantics></math> for cyclist detection.
The overall mAP of our approach is <math id="S4.SS3.p1.4.m4.1" class="ltx_Math" alttext="63.15\%" display="inline"><semantics id="S4.SS3.p1.4.m4.1a"><mrow id="S4.SS3.p1.4.m4.1.1" xref="S4.SS3.p1.4.m4.1.1.cmml"><mn id="S4.SS3.p1.4.m4.1.1.2" xref="S4.SS3.p1.4.m4.1.1.2.cmml">63.15</mn><mo id="S4.SS3.p1.4.m4.1.1.1" xref="S4.SS3.p1.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.m4.1b"><apply id="S4.SS3.p1.4.m4.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1"><csymbol cd="latexml" id="S4.SS3.p1.4.m4.1.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1.1">percent</csymbol><cn type="float" id="S4.SS3.p1.4.m4.1.1.2.cmml" xref="S4.SS3.p1.4.m4.1.1.2">63.15</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.4.m4.1c">63.15\%</annotation></semantics></math>, <math id="S4.SS3.p1.5.m5.1" class="ltx_Math" alttext="3.10\%" display="inline"><semantics id="S4.SS3.p1.5.m5.1a"><mrow id="S4.SS3.p1.5.m5.1.1" xref="S4.SS3.p1.5.m5.1.1.cmml"><mn id="S4.SS3.p1.5.m5.1.1.2" xref="S4.SS3.p1.5.m5.1.1.2.cmml">3.10</mn><mo id="S4.SS3.p1.5.m5.1.1.1" xref="S4.SS3.p1.5.m5.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.5.m5.1b"><apply id="S4.SS3.p1.5.m5.1.1.cmml" xref="S4.SS3.p1.5.m5.1.1"><csymbol cd="latexml" id="S4.SS3.p1.5.m5.1.1.1.cmml" xref="S4.SS3.p1.5.m5.1.1.1">percent</csymbol><cn type="float" id="S4.SS3.p1.5.m5.1.1.2.cmml" xref="S4.SS3.p1.5.m5.1.1.2">3.10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.5.m5.1c">3.10\%</annotation></semantics></math> higher than the Cartesian-based 3D object detector <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>, and <math id="S4.SS3.p1.6.m6.1" class="ltx_Math" alttext="9.82\%" display="inline"><semantics id="S4.SS3.p1.6.m6.1a"><mrow id="S4.SS3.p1.6.m6.1.1" xref="S4.SS3.p1.6.m6.1.1.cmml"><mn id="S4.SS3.p1.6.m6.1.1.2" xref="S4.SS3.p1.6.m6.1.1.2.cmml">9.82</mn><mo id="S4.SS3.p1.6.m6.1.1.1" xref="S4.SS3.p1.6.m6.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.6.m6.1b"><apply id="S4.SS3.p1.6.m6.1.1.cmml" xref="S4.SS3.p1.6.m6.1.1"><csymbol cd="latexml" id="S4.SS3.p1.6.m6.1.1.1.cmml" xref="S4.SS3.p1.6.m6.1.1.1">percent</csymbol><cn type="float" id="S4.SS3.p1.6.m6.1.1.2.cmml" xref="S4.SS3.p1.6.m6.1.1.2">9.82</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.6.m6.1c">9.82\%</annotation></semantics></math> more elevated than the polar-based 3D object detector <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>.
The observations on the ONCE dataset are consistent with those on the Waymo Open Dataset, indicating both the effectiveness and the generalization of our method.</p>
</div>
<figure id="S4.F6" class="ltx_figure"><img src="/html/2308.03982/assets/x6.png" id="S4.F6.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="211" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Visualization of t-SNE features with and without GRR. Blue dots are foreground while red dots are background.</figcaption>
</figure>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Ablation studies</h3>

<div id="S4.SS4.p1" class="ltx_para ltx_noindent">
<p id="S4.SS4.p1.1" class="ltx_p"><span id="S4.SS4.p1.1.1" class="ltx_text ltx_font_bold">Effects of different components in PARTNER.</span></p>
</div>
<figure id="S4.T6" class="ltx_table">
<div id="S4.T6.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:164.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(74.2pt,-28.1pt) scale(1.52006629775267,1.52006629775267) ;">
<table id="S4.T6.1.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T6.1.1.1" class="ltx_tr">
<td id="S4.T6.1.1.1.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" style="padding-top:1.5pt;padding-bottom:1.5pt;" rowspan="2"><span id="S4.T6.1.1.1.1.1" class="ltx_text">Coord.</span></td>
<td id="S4.T6.1.1.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:1.5pt;padding-bottom:1.5pt;" rowspan="2"><span id="S4.T6.1.1.1.2.1" class="ltx_text">GRR</span></td>
<td id="S4.T6.1.1.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:1.5pt;padding-bottom:1.5pt;" rowspan="2"><span id="S4.T6.1.1.1.3.1" class="ltx_text">GA</span></td>
<td id="S4.T6.1.1.1.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="S4.T6.1.1.1.4.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T6.1.1.1.4.1.1" class="ltx_p" style="width:71.1pt;">Veh. LEVEL 1</span>
</span>
</td>
<td id="S4.T6.1.1.1.5" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="S4.T6.1.1.1.5.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T6.1.1.1.5.1.1" class="ltx_p" style="width:71.1pt;">Veh. LEVEL 2</span>
</span>
</td>
</tr>
<tr id="S4.T6.1.1.2" class="ltx_tr">
<td id="S4.T6.1.1.2.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="S4.T6.1.1.2.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T6.1.1.2.1.1.1" class="ltx_p" style="width:71.1pt;">mAP/mAPH(%)</span>
</span>
</td>
<td id="S4.T6.1.1.2.2" class="ltx_td ltx_align_justify ltx_align_top" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="S4.T6.1.1.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T6.1.1.2.2.1.1" class="ltx_p" style="width:71.1pt;">mAP/mAPH(%)</span>
</span>
</td>
</tr>
<tr id="S4.T6.1.1.3" class="ltx_tr">
<td id="S4.T6.1.1.3.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" style="padding-top:1.5pt;padding-bottom:1.5pt;">Cartesian</td>
<td id="S4.T6.1.1.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-top:1.5pt;padding-bottom:1.5pt;">✗</td>
<td id="S4.T6.1.1.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-top:1.5pt;padding-bottom:1.5pt;">✗</td>
<td id="S4.T6.1.1.3.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_tt" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="S4.T6.1.1.3.4.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T6.1.1.3.4.1.1" class="ltx_p" style="width:71.1pt;">73.51/72.96</span>
</span>
</td>
<td id="S4.T6.1.1.3.5" class="ltx_td ltx_align_justify ltx_align_top ltx_border_tt" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="S4.T6.1.1.3.5.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T6.1.1.3.5.1.1" class="ltx_p" style="width:71.1pt;">65.86/65.33</span>
</span>
</td>
</tr>
<tr id="S4.T6.1.1.4" class="ltx_tr">
<td id="S4.T6.1.1.4.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">Polar</td>
<td id="S4.T6.1.1.4.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">✗</td>
<td id="S4.T6.1.1.4.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">✗</td>
<td id="S4.T6.1.1.4.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="S4.T6.1.1.4.4.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T6.1.1.4.4.1.1" class="ltx_p" style="width:71.1pt;">70.31/69.82</span>
</span>
</td>
<td id="S4.T6.1.1.4.5" class="ltx_td ltx_align_justify ltx_align_top" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="S4.T6.1.1.4.5.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T6.1.1.4.5.1.1" class="ltx_p" style="width:71.1pt;">62.74/62.23</span>
</span>
</td>
</tr>
<tr id="S4.T6.1.1.5" class="ltx_tr">
<td id="S4.T6.1.1.5.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">Polar</td>
<td id="S4.T6.1.1.5.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">✓</td>
<td id="S4.T6.1.1.5.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">✗</td>
<td id="S4.T6.1.1.5.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="S4.T6.1.1.5.4.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T6.1.1.5.4.1.1" class="ltx_p" style="width:71.1pt;">72.62/72.07</span>
</span>
</td>
<td id="S4.T6.1.1.5.5" class="ltx_td ltx_align_justify ltx_align_top" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="S4.T6.1.1.5.5.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T6.1.1.5.5.1.1" class="ltx_p" style="width:71.1pt;">65.02/64.50</span>
</span>
</td>
</tr>
<tr id="S4.T6.1.1.6" class="ltx_tr">
<td id="S4.T6.1.1.6.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">Polar</td>
<td id="S4.T6.1.1.6.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">✓</td>
<td id="S4.T6.1.1.6.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">✓</td>
<td id="S4.T6.1.1.6.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="S4.T6.1.1.6.4.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T6.1.1.6.4.1.1" class="ltx_p" style="width:71.1pt;"><span id="S4.T6.1.1.6.4.1.1.1" class="ltx_text ltx_font_bold">75.35/74.85</span></span>
</span>
</td>
<td id="S4.T6.1.1.6.5" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="S4.T6.1.1.6.5.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T6.1.1.6.5.1.1" class="ltx_p" style="width:71.1pt;"><span id="S4.T6.1.1.6.5.1.1.1" class="ltx_text ltx_font_bold">67.84/67.35</span></span>
</span>
</td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 6: </span>Effects of different components in PARTNER.
We show the 12 epochs results on the Waymo val. set for vehicle detection.
</figcaption>
</figure>
<div id="S4.SS4.p2" class="ltx_para">
<p id="S4.SS4.p2.2" class="ltx_p">In Table <a href="#S4.T6" title="Table 6 ‣ 4.4 Ablation studies ‣ 4 Experiments ‣ PARTNER: Level up the Polar Representation for LiDAR 3D Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>, we investigate the effectiveness of each component in our proposed method.
The global representation re-alignment module can be independently applied on the detector and boost the performance by <math id="S4.SS4.p2.1.m1.1" class="ltx_Math" alttext="2.31\%" display="inline"><semantics id="S4.SS4.p2.1.m1.1a"><mrow id="S4.SS4.p2.1.m1.1.1" xref="S4.SS4.p2.1.m1.1.1.cmml"><mn id="S4.SS4.p2.1.m1.1.1.2" xref="S4.SS4.p2.1.m1.1.1.2.cmml">2.31</mn><mo id="S4.SS4.p2.1.m1.1.1.1" xref="S4.SS4.p2.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.1.m1.1b"><apply id="S4.SS4.p2.1.m1.1.1.cmml" xref="S4.SS4.p2.1.m1.1.1"><csymbol cd="latexml" id="S4.SS4.p2.1.m1.1.1.1.cmml" xref="S4.SS4.p2.1.m1.1.1.1">percent</csymbol><cn type="float" id="S4.SS4.p2.1.m1.1.1.2.cmml" xref="S4.SS4.p2.1.m1.1.1.2">2.31</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.1.m1.1c">2.31\%</annotation></semantics></math> mAP compared to the raw baseline.
Combing the two proposed components, we can obtain a performance gain of <math id="S4.SS4.p2.2.m2.1" class="ltx_Math" alttext="5.04\%" display="inline"><semantics id="S4.SS4.p2.2.m2.1a"><mrow id="S4.SS4.p2.2.m2.1.1" xref="S4.SS4.p2.2.m2.1.1.cmml"><mn id="S4.SS4.p2.2.m2.1.1.2" xref="S4.SS4.p2.2.m2.1.1.2.cmml">5.04</mn><mo id="S4.SS4.p2.2.m2.1.1.1" xref="S4.SS4.p2.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.2.m2.1b"><apply id="S4.SS4.p2.2.m2.1.1.cmml" xref="S4.SS4.p2.2.m2.1.1"><csymbol cd="latexml" id="S4.SS4.p2.2.m2.1.1.1.cmml" xref="S4.SS4.p2.2.m2.1.1.1">percent</csymbol><cn type="float" id="S4.SS4.p2.2.m2.1.1.2.cmml" xref="S4.SS4.p2.2.m2.1.1.2">5.04</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.2.m2.1c">5.04\%</annotation></semantics></math> mAP.</p>
</div>
<figure id="S4.F7" class="ltx_figure"><img src="/html/2308.03982/assets/x7.png" id="S4.F7.g1" class="ltx_graphics ltx_img_landscape" width="379" height="107" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Visualization of detection performance on Waymo Open Dataset.
The green box denotes the ground truth box.
The red box denotes the predictions.
Best viewed in color.</figcaption>
</figure>
<div id="S4.SS4.p3" class="ltx_para ltx_noindent">
<p id="S4.SS4.p3.1" class="ltx_p"><span id="S4.SS4.p3.1.1" class="ltx_text ltx_font_bold">Effects of GRR.</span></p>
</div>
<figure id="S4.T7" class="ltx_table">
<div id="S4.T7.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:152.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(63.2pt,-22.2pt) scale(1.41097439869024,1.41097439869024) ;">
<table id="S4.T7.1.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T7.1.1.1" class="ltx_tr">
<td id="S4.T7.1.1.1.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" style="padding-top:1.5pt;padding-bottom:1.5pt;" rowspan="2"><span id="S4.T7.1.1.1.1.1" class="ltx_text">Coord.</span></td>
<td id="S4.T7.1.1.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:1.5pt;padding-bottom:1.5pt;" rowspan="2"><span id="S4.T7.1.1.1.2.1" class="ltx_text">Re-alignment</span></td>
<td id="S4.T7.1.1.1.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="S4.T7.1.1.1.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T7.1.1.1.3.1.1" class="ltx_p" style="width:71.1pt;">Veh. LEVEL 1</span>
</span>
</td>
<td id="S4.T7.1.1.1.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="S4.T7.1.1.1.4.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T7.1.1.1.4.1.1" class="ltx_p" style="width:71.1pt;">Veh. LEVEL 2</span>
</span>
</td>
</tr>
<tr id="S4.T7.1.1.2" class="ltx_tr">
<td id="S4.T7.1.1.2.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="S4.T7.1.1.2.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T7.1.1.2.1.1.1" class="ltx_p" style="width:71.1pt;">mAP/mAPH(%)</span>
</span>
</td>
<td id="S4.T7.1.1.2.2" class="ltx_td ltx_align_justify ltx_align_top" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="S4.T7.1.1.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T7.1.1.2.2.1.1" class="ltx_p" style="width:71.1pt;">mAP/mAPH(%)</span>
</span>
</td>
</tr>
<tr id="S4.T7.1.1.3" class="ltx_tr">
<td id="S4.T7.1.1.3.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" style="padding-top:1.5pt;padding-bottom:1.5pt;">Cartesian</td>
<td id="S4.T7.1.1.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
<td id="S4.T7.1.1.3.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_tt" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="S4.T7.1.1.3.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T7.1.1.3.3.1.1" class="ltx_p" style="width:71.1pt;">73.51/72.96</span>
</span>
</td>
<td id="S4.T7.1.1.3.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_tt" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="S4.T7.1.1.3.4.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T7.1.1.3.4.1.1" class="ltx_p" style="width:71.1pt;">65.86/65.33</span>
</span>
</td>
</tr>
<tr id="S4.T7.1.1.4" class="ltx_tr">
<td id="S4.T7.1.1.4.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">Cartesian</td>
<td id="S4.T7.1.1.4.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">GRR</td>
<td id="S4.T7.1.1.4.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="S4.T7.1.1.4.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T7.1.1.4.3.1.1" class="ltx_p" style="width:71.1pt;">73.04/72.50</span>
</span>
</td>
<td id="S4.T7.1.1.4.4" class="ltx_td ltx_align_justify ltx_align_top" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="S4.T7.1.1.4.4.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T7.1.1.4.4.1.1" class="ltx_p" style="width:71.1pt;">65.38/64.86</span>
</span>
</td>
</tr>
<tr id="S4.T7.1.1.5" class="ltx_tr">
<td id="S4.T7.1.1.5.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" style="padding-top:1.5pt;padding-bottom:1.5pt;">Polar</td>
<td id="S4.T7.1.1.5.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
<td id="S4.T7.1.1.5.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="S4.T7.1.1.5.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T7.1.1.5.3.1.1" class="ltx_p" style="width:71.1pt;">73.33/72.63</span>
</span>
</td>
<td id="S4.T7.1.1.5.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="S4.T7.1.1.5.4.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T7.1.1.5.4.1.1" class="ltx_p" style="width:71.1pt;">64.83/64.23</span>
</span>
</td>
</tr>
<tr id="S4.T7.1.1.6" class="ltx_tr">
<td id="S4.T7.1.1.6.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">Polar (Ours)</td>
<td id="S4.T7.1.1.6.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">GRR</td>
<td id="S4.T7.1.1.6.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="S4.T7.1.1.6.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T7.1.1.6.3.1.1" class="ltx_p" style="width:71.1pt;"><span id="S4.T7.1.1.6.3.1.1.1" class="ltx_text ltx_font_bold">75.35/74.85</span></span>
</span>
</td>
<td id="S4.T7.1.1.6.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="S4.T7.1.1.6.4.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T7.1.1.6.4.1.1" class="ltx_p" style="width:71.1pt;"><span id="S4.T7.1.1.6.4.1.1.1" class="ltx_text ltx_font_bold">67.84/67.35</span></span>
</span>
</td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 7: </span>Effects of GRR applied on the Cartesian and polar coordinates respectively.
We show the 12 epochs results on the Waymo val. set for vehicle detection.
</figcaption>
</figure>
<div id="S4.SS4.p4" class="ltx_para">
<p id="S4.SS4.p4.1" class="ltx_p">In the above part we ablate the effects of global representation re-alignment and demonstrate its significant improvement on polar-based representation.
Another inquiry that might pique our interest is how our GRR will influence the Cartesian-based ones.
To further investigate this question, we apply the GRR module to the detectors based on Cartesian representation.
Interestingly, as is shown in Table <a href="#S4.T7" title="Table 7 ‣ 4.4 Ablation studies ‣ 4 Experiments ‣ PARTNER: Level up the Polar Representation for LiDAR 3D Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>, Cartesian-based detector with the proposed global representation re-alignment module achieves even lower performance compared to before, which further proves the rationality and pertinence of our method towards polar representation.
Additionally, we visualize the t-SNE of features from GRR.
As is shown in Figure <a href="#S4.F6" title="Figure 6 ‣ 4.3 Experiments on the ONCE dataset ‣ 4 Experiments ‣ PARTNER: Level up the Polar Representation for LiDAR 3D Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>, with the help of GRR, foreground features are better aligned and separated from background features.</p>
</div>
<figure id="S4.T8" class="ltx_table">
<div id="S4.T8.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:186.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(70.5pt,-30.4pt) scale(1.48214405113421,1.48214405113421) ;">
<table id="S4.T8.1.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T8.1.1.1" class="ltx_tr">
<td id="S4.T8.1.1.1.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="S4.T8.1.1.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T8.1.1.1.1.1.1" class="ltx_p" style="width:71.1pt;"><span id="S4.T8.1.1.1.1.1.1.1" class="ltx_text">Components</span></span>
</span>
</td>
<td id="S4.T8.1.1.1.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="S4.T8.1.1.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T8.1.1.1.2.1.1" class="ltx_p" style="width:91.0pt;">Veh. LEVEL 1</span>
</span>
</td>
<td id="S4.T8.1.1.1.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="S4.T8.1.1.1.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T8.1.1.1.3.1.1" class="ltx_p" style="width:91.0pt;">Veh. LEVEL 2</span>
</span>
</td>
</tr>
<tr id="S4.T8.1.1.2" class="ltx_tr">
<td id="S4.T8.1.1.2.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="S4.T8.1.1.2.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T8.1.1.2.1.1.1" class="ltx_p" style="width:71.1pt;"></span>
</span>
</td>
<td id="S4.T8.1.1.2.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="S4.T8.1.1.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T8.1.1.2.2.1.1" class="ltx_p" style="width:91.0pt;">mAP/mAPH(%)</span>
</span>
</td>
<td id="S4.T8.1.1.2.3" class="ltx_td ltx_align_justify ltx_align_top" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="S4.T8.1.1.2.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T8.1.1.2.3.1.1" class="ltx_p" style="width:91.0pt;">mAP/mAPH(%)</span>
</span>
</td>
</tr>
<tr id="S4.T8.1.1.3" class="ltx_tr">
<td id="S4.T8.1.1.3.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_tt" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="S4.T8.1.1.3.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T8.1.1.3.1.1.1" class="ltx_p" style="width:71.1pt;">Baseline</span>
</span>
</td>
<td id="S4.T8.1.1.3.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_tt" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="S4.T8.1.1.3.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T8.1.1.3.2.1.1" class="ltx_p" style="width:91.0pt;">72.62/72.07</span>
</span>
</td>
<td id="S4.T8.1.1.3.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_tt" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="S4.T8.1.1.3.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T8.1.1.3.3.1.1" class="ltx_p" style="width:91.0pt;">65.02/64.50</span>
</span>
</td>
</tr>
<tr id="S4.T8.1.1.4" class="ltx_tr">
<td id="S4.T8.1.1.4.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="S4.T8.1.1.4.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T8.1.1.4.1.1.1" class="ltx_p" style="width:71.1pt;">+ aux. loss</span>
</span>
</td>
<td id="S4.T8.1.1.4.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="S4.T8.1.1.4.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T8.1.1.4.2.1.1" class="ltx_p" style="width:91.0pt;">72.48/71.92</span>
</span>
</td>
<td id="S4.T8.1.1.4.3" class="ltx_td ltx_align_justify ltx_align_top" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="S4.T8.1.1.4.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T8.1.1.4.3.1.1" class="ltx_p" style="width:91.0pt;">64.89/64.36</span>
</span>
</td>
</tr>
<tr id="S4.T8.1.1.5" class="ltx_tr">
<td id="S4.T8.1.1.5.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="S4.T8.1.1.5.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T8.1.1.5.1.1.1" class="ltx_p" style="width:71.1pt;">+ win. attn.</span>
</span>
</td>
<td id="S4.T8.1.1.5.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="S4.T8.1.1.5.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T8.1.1.5.2.1.1" class="ltx_p" style="width:91.0pt;">73.11/72.58</span>
</span>
</td>
<td id="S4.T8.1.1.5.3" class="ltx_td ltx_align_justify ltx_align_top" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="S4.T8.1.1.5.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T8.1.1.5.3.1.1" class="ltx_p" style="width:91.0pt;">65.46/64.95</span>
</span>
</td>
</tr>
<tr id="S4.T8.1.1.6" class="ltx_tr">
<td id="S4.T8.1.1.6.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="S4.T8.1.1.6.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T8.1.1.6.1.1.1" class="ltx_p" style="width:71.1pt;">+ pos. clues</span>
</span>
</td>
<td id="S4.T8.1.1.6.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="S4.T8.1.1.6.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T8.1.1.6.2.1.1" class="ltx_p" style="width:91.0pt;">74.34/73.79</span>
</span>
</td>
<td id="S4.T8.1.1.6.3" class="ltx_td ltx_align_justify ltx_align_top" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="S4.T8.1.1.6.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T8.1.1.6.3.1.1" class="ltx_p" style="width:91.0pt;">66.57/66.06</span>
</span>
</td>
</tr>
<tr id="S4.T8.1.1.7" class="ltx_tr">
<td id="S4.T8.1.1.7.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="S4.T8.1.1.7.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T8.1.1.7.1.1.1" class="ltx_p" style="width:71.1pt;">+ geo. clues</span>
</span>
</td>
<td id="S4.T8.1.1.7.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="S4.T8.1.1.7.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T8.1.1.7.2.1.1" class="ltx_p" style="width:91.0pt;"><span id="S4.T8.1.1.7.2.1.1.1" class="ltx_text ltx_font_bold">75.35/74.85</span></span>
</span>
</td>
<td id="S4.T8.1.1.7.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="S4.T8.1.1.7.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T8.1.1.7.3.1.1" class="ltx_p" style="width:91.0pt;"><span id="S4.T8.1.1.7.3.1.1.1" class="ltx_text ltx_font_bold">67.84/67.35</span></span>
</span>
</td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 8: </span>Comparison of different designs in GA module.
We show the 12 epochs results on the Waymo val. set.
</figcaption>
</figure>
<div id="S4.SS4.p5" class="ltx_para ltx_noindent">
<p id="S4.SS4.p5.1" class="ltx_p"><span id="S4.SS4.p5.1.1" class="ltx_text ltx_font_bold">Effects of geometry-aware adaptive module.</span>
To verify the effectiveness of instance-wise geometric information in geometry-aware adaptive module, we conduct ablation studies in Table <a href="#S4.T8" title="Table 8 ‣ 4.4 Ablation studies ‣ 4 Experiments ‣ PARTNER: Level up the Polar Representation for LiDAR 3D Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a> to pinpoint where the improvements come from.
We can observe that auxiliary supervision alone does not provide a gain but instead leads to a slight performance drop, which proves that auxiliary loss itself did not lead to improvements.
Meanwhile, the window attention only brings a 0.49% edge up.
Furthermore, the performance is constantly improved with the gradual introduction of geometric and positional clues by 1.72% and 1.01%, indicating the crucial rule of instance-wise geometric information.
</p>
</div>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Qualitative results</h3>

<div id="S4.SS5.p1" class="ltx_para">
<p id="S4.SS5.p1.1" class="ltx_p">We have compared the quantified results of our PARTNER on two major object detection benchmarks: Waymo Open Dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> and ONCE dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>.
In this section, we present our visualization results on Waymo <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>.
As is shown in Figure <a href="#S4.F7" title="Figure 7 ‣ 4.4 Ablation studies ‣ 4 Experiments ‣ PARTNER: Level up the Polar Representation for LiDAR 3D Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>, our method could successfully detect objects in the challenging scenes.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusions</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this work, we revisit the problem of feature distortion in the polar representation, which restricts the polar-based 3D detectors severely.
To tackle this issue, we present PARTNER, a novel 3D object detector in the polar coordinate.
PARTNER alleviates the dilemma of feature distortion with global representation re-alignment and facilitates the regression by introducing instance-level geometric information into the detection head.
Results demonstrate that the proposed method outperforms the previous polar-based works with a large margin and achieves competitive results over the state-of-the-art methods.
Furthermore, PARTNER exhibits overwhelming advantages in streaming and different resolutions settings.
We expect our work could inspire future research into polar-based 3D object detection.</p>
</div>
<div id="S5.p2" class="ltx_para ltx_noindent">
<p id="S5.p2.1" class="ltx_p"><span id="S5.p2.1.1" class="ltx_text ltx_font_bold">Acknowledgments</span>
This work was supported in part by
STI2030-Major Projects (Grant No. 2021ZD0200204),
National Natural Science Foundation of China (Grant No. 62106050),
Lingang Laboratory (Grant No. LG-QS-202202-07), Natural Science Foundation of Shanghai (Grant No. 22ZR1407500),
USyd-Fudan BISA Flagship Research Program,
and the National Research Foundation, Singapore under its Medium Sized Center for Advanced Robotics Technology Innovation.
We thank MindSpore for the partial support of this work, which is a new deep learning computing framework.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Holger Caesar, Varun Bankiti, Alex H Lang, Sourabh Vora, Venice Erin Liong,
Qiang Xu, Anush Krishnan, Yu Pan, Giancarlo Baldan, and Oscar Beijbom.

</span>
<span class="ltx_bibblock">nuscenes: A multimodal dataset for autonomous driving.

</span>
<span class="ltx_bibblock">In <span id="bib.bib1.1.1" class="ltx_text ltx_font_italic">CVPR</span>, 2020.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Yuning Chai, Pei Sun, Jiquan Ngiam, Weiyue Wang, Benjamin Caine, Vijay
Vasudevan, Xiao Zhang, and Dragomir Anguelov.

</span>
<span class="ltx_bibblock">To the point: Efficient 3d object detection in the range image with
graph convolution kernels.

</span>
<span class="ltx_bibblock">In <span id="bib.bib2.1.1" class="ltx_text ltx_font_italic">CVPR</span>, 2021.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Qi Chen, Sourabh Vora, and Oscar Beijbom.

</span>
<span class="ltx_bibblock">Polarstream: Streaming object detection and segmentation with polar
pillars.

</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>, 2021.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Shuai Li Chenhang He, Ruihuang Li and Lei Zhang.

</span>
<span class="ltx_bibblock">Voxel set transformer: A set-to-set approach to 3d object detection
from point clouds.

</span>
<span class="ltx_bibblock">In <span id="bib.bib4.1.1" class="ltx_text ltx_font_italic">CVPR</span>, 2022.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Alexey Dosovitskiy, Lucas Beyer, Alexander Kolesnikov, Dirk Weissenborn,
Xiaohua Zhai, Thomas Unterthiner, Mostafa Dehghani, Matthias Minderer, Georg
Heigold, Sylvain Gelly, et al.

</span>
<span class="ltx_bibblock">An image is worth 16x16 words: Transformers for image recognition at
scale.

</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text ltx_font_italic">arXiv preprint</span>, 2020.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Lue Fan, Ziqi Pang, Tianyuan Zhang, Yu-Xiong Wang, Hang Zhao, Feng Wang, Naiyan
Wang, and Zhaoxiang Zhang.

</span>
<span class="ltx_bibblock">Embracing single stride 3d object detector with sparse transformer.

</span>
<span class="ltx_bibblock">In <span id="bib.bib6.1.1" class="ltx_text ltx_font_italic">CVPR</span>, 2022.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Lue Fan, Xuan Xiong, Feng Wang, Naiyan Wang, and Zhaoxiang Zhang.

</span>
<span class="ltx_bibblock">Rangedet: In defense of range view for lidar-based 3d object
detection.

</span>
<span class="ltx_bibblock">In <span id="bib.bib7.1.1" class="ltx_text ltx_font_italic">ICCV</span>, 2021.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Davi Frossard, Shun Da Suo, Sergio Casas, James Tu, and Raquel Urtasun.

</span>
<span class="ltx_bibblock">Strobe: Streaming object detection from lidar packets.

</span>
<span class="ltx_bibblock">In <span id="bib.bib8.1.1" class="ltx_text ltx_font_italic">CoRL</span>, 2021.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Huan Fu, Mingming Gong, Chaohui Wang, Kayhan Batmanghelich, and Dacheng Tao.

</span>
<span class="ltx_bibblock">Deep ordinal regression network for monocular depth estimation.

</span>
<span class="ltx_bibblock">In <span id="bib.bib9.1.1" class="ltx_text ltx_font_italic">CVPR</span>, 2018.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Wei Han, Zhengdong Zhang, Benjamin Caine, Brandon Yang, Christoph Sprunk, Ouais
Alsharif, Jiquan Ngiam, Vijay Vasudevan, Jonathon Shlens, and Zhifeng Chen.

</span>
<span class="ltx_bibblock">Streaming object detection for 3-d point clouds.

</span>
<span class="ltx_bibblock">In <span id="bib.bib10.1.1" class="ltx_text ltx_font_italic">ECCV</span>, 2020.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Jonathan Ho, Nal Kalchbrenner, Dirk Weissenborn, and Tim Salimans.

</span>
<span class="ltx_bibblock">Axial attention in multidimensional transformers.

</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text ltx_font_italic">arXiv preprint</span>, 2019.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Alex H Lang, Sourabh Vora, Holger Caesar, Lubing Zhou, Jiong Yang, and Oscar
Beijbom.

</span>
<span class="ltx_bibblock">Pointpillars: Fast encoders for object detection from point clouds.

</span>
<span class="ltx_bibblock">In <span id="bib.bib12.1.1" class="ltx_text ltx_font_italic">CVPR</span>, 2019.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Zhidong Liang, Ming Zhang, Zehan Zhang, Xian Zhao, and Shiliang Pu.

</span>
<span class="ltx_bibblock">Rangercnn: Towards fast and accurate 3d object detection with range
image representation.

</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text ltx_font_italic">arXiv preprint</span>, 2020.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Tsung-Yi Lin, Priya Goyal, Ross Girshick, Kaiming He, and Piotr Dollar.

</span>
<span class="ltx_bibblock">Focal loss for dense object detection.

</span>
<span class="ltx_bibblock">In <span id="bib.bib14.1.1" class="ltx_text ltx_font_italic">ICCV</span>, 2017.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Wei Liu, Dragomir Anguelov, Dumitru Erhan, Christian Szegedy, Scott Reed,
Cheng-Yang Fu, and Alexander C. Berg.

</span>
<span class="ltx_bibblock">Ssd: Single shot multibox detector.

</span>
<span class="ltx_bibblock">In Bastian Leibe, Jiri Matas, Nicu Sebe, and Max Welling, editors,
<span id="bib.bib15.1.1" class="ltx_text ltx_font_italic">ECCV</span>, 2016.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Ze Liu, Yutong Lin, Yue Cao, Han Hu, Yixuan Wei, Zheng Zhang, Stephen Lin, and
Baining Guo.

</span>
<span class="ltx_bibblock">Swin transformer: Hierarchical vision transformer using shifted
windows.

</span>
<span class="ltx_bibblock">In <span id="bib.bib16.1.1" class="ltx_text ltx_font_italic">ICCV</span>, 2021.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Jiageng Mao, Minzhe Niu, Haoyue Bai, Xiaodan Liang, Hang Xu, and Chunjing Xu.

</span>
<span class="ltx_bibblock">Pyramid r-cnn: Towards better performance and adaptability for 3d
object detection.

</span>
<span class="ltx_bibblock">In <span id="bib.bib17.1.1" class="ltx_text ltx_font_italic">ICCV</span>, 2021.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Jiageng Mao, Minzhe Niu, Chenhan Jiang, Hanxue Liang, Jingheng Chen, Xiaodan
Liang, Yamin Li, Chaoqiang Ye, Wei Zhang, Zhenguo Li, et al.

</span>
<span class="ltx_bibblock">One million scenes for autonomous driving: Once dataset.

</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text ltx_font_italic">arXiv preprint</span>, 2021.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Jiageng Mao, Yujing Xue, Minzhe Niu, Haoyue Bai, Jiashi Feng, Xiaodan Liang,
Hang Xu, and Chunjing Xu.

</span>
<span class="ltx_bibblock">Voxel transformer for 3d object detection.

</span>
<span class="ltx_bibblock">In <span id="bib.bib19.1.1" class="ltx_text ltx_font_italic">ICCV</span>, 2021.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Charles R Qi, Hao Su, Kaichun Mo, and Leonidas J Guibas.

</span>
<span class="ltx_bibblock">Pointnet: Deep learning on point sets for 3d classification and
segmentation.

</span>
<span class="ltx_bibblock">In <span id="bib.bib20.1.1" class="ltx_text ltx_font_italic">CVPR</span>, 2017.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Charles Ruizhongtai Qi, Li Yi, Hao Su, and Leonidas J Guibas.

</span>
<span class="ltx_bibblock">Pointnet++: Deep hierarchical feature learning on point sets in a
metric space.

</span>
<span class="ltx_bibblock"><span id="bib.bib21.1.1" class="ltx_text ltx_font_italic">Advances in neural information processing systems</span>, 2017.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Cody Reading, Ali Harakeh, Julia Chae, and Steven L Waslander.

</span>
<span class="ltx_bibblock">Categorical depth distribution network for monocular 3d object
detection.

</span>
<span class="ltx_bibblock">In <span id="bib.bib22.1.1" class="ltx_text ltx_font_italic">CVPR</span>, 2021.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Shaoshuai Shi, Chaoxu Guo, Li Jiang, Zhe Wang, Jianping Shi, Xiaogang Wang, and
Hongsheng Li.

</span>
<span class="ltx_bibblock">Pv-rcnn: Point-voxel feature set abstraction for 3d object detection.

</span>
<span class="ltx_bibblock">In <span id="bib.bib23.1.1" class="ltx_text ltx_font_italic">CVPR</span>, 2020.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Shaoshuai Shi, Xiaogang Wang, and Hongsheng Li.

</span>
<span class="ltx_bibblock">Pointrcnn: 3d object proposal generation and detection from point
cloud.

</span>
<span class="ltx_bibblock">In <span id="bib.bib24.1.1" class="ltx_text ltx_font_italic">CVPR</span>, 2019.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Pei Sun, Henrik Kretzschmar, Xerxes Dotiwalla, Aurelien Chouard, Vijaysai
Patnaik, Paul Tsui, James Guo, Yin Zhou, Yuning Chai, Benjamin Caine, et al.

</span>
<span class="ltx_bibblock">Scalability in perception for autonomous driving: Waymo open dataset.

</span>
<span class="ltx_bibblock">In <span id="bib.bib25.1.1" class="ltx_text ltx_font_italic">CVPR</span>, 2020.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Pei Sun, Mingxing Tan, Weiyue Wang, Chenxi Liu, Fei Xia, Zhaoqi Leng, and
Dragomir Anguelov.

</span>
<span class="ltx_bibblock">Swformer: Sparse window transformer for 3d object detection in point
clouds.

</span>
<span class="ltx_bibblock">In <span id="bib.bib26.1.1" class="ltx_text ltx_font_italic">ECCV</span>, 2022.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Yue Wang, Alireza Fathi, Abhijit Kundu, David A. Ross, Caroline Pantofaru,
Thomas A. Funkhouser, and Justin M. Solomon.

</span>
<span class="ltx_bibblock">Pillar-based object detection for autonomous driving.

</span>
<span class="ltx_bibblock">In <span id="bib.bib27.1.1" class="ltx_text ltx_font_italic">ECCV</span>, 2020.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Yujing Xue, Jiageng Mao, Minzhe Niu, Hang Xu, Michael Bi Mi, Wei Zhang,
Xiaogang Wang, and Xinchao Wang.

</span>
<span class="ltx_bibblock">Point2seq: Detecting 3d objects as sequences.

</span>
<span class="ltx_bibblock">In <span id="bib.bib28.1.1" class="ltx_text ltx_font_italic">CVPR</span>, 2022.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Yan Yan, Yuxing Mao, and Bo Li.

</span>
<span class="ltx_bibblock">Second: Sparsely embedded convolutional detection.

</span>
<span class="ltx_bibblock"><span id="bib.bib29.1.1" class="ltx_text ltx_font_italic">Sensors</span>, 2018.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Zetong Yang, Yanan Sun, Shu Liu, and Jiaya Jia.

</span>
<span class="ltx_bibblock">3dssd: Point-based 3d single stage object detector.

</span>
<span class="ltx_bibblock">In <span id="bib.bib30.1.1" class="ltx_text ltx_font_italic">CVPR</span>, 2020.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Zetong Yang, Yanan Sun, Shu Liu, Xiaoyong Shen, and Jiaya Jia.

</span>
<span class="ltx_bibblock">Std: Sparse-to-dense 3d object detector for point cloud.

</span>
<span class="ltx_bibblock">In <span id="bib.bib31.1.1" class="ltx_text ltx_font_italic">ICCV</span>, 2019.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Tianwei Yin, Xingyi Zhou, and Philipp Krähenbühl.

</span>
<span class="ltx_bibblock">Center-based 3d object detection and tracking.

</span>
<span class="ltx_bibblock"><span id="bib.bib32.1.1" class="ltx_text ltx_font_italic">arXiv preprint</span>, 2020.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Yang Zhang, Zixiang Zhou, Philip David, Xiangyu Yue, Zerong Xi, Boqing Gong,
and Hassan Foroosh.

</span>
<span class="ltx_bibblock">Polarnet: An improved grid representation for online lidar point
clouds semantic segmentation.

</span>
<span class="ltx_bibblock">In <span id="bib.bib33.1.1" class="ltx_text ltx_font_italic">CVPR</span>, 2020.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Daquan Zhou, Zhiding Yu, Enze Xie, Chaowei Xiao, Animashree Anandkumar, Jiashi
Feng, and Jose M. Alvarez.

</span>
<span class="ltx_bibblock">Understanding the robustness in vision transformers.

</span>
<span class="ltx_bibblock">In <span id="bib.bib34.1.1" class="ltx_text ltx_font_italic">ICML</span>, 2022.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
Yin Zhou, Pei Sun, Yu Zhang, Dragomir Anguelov, Jiyang Gao, Tom Ouyang, James
Guo, Jiquan Ngiam, and Vijay Vasudevan.

</span>
<span class="ltx_bibblock">End-to-end multi-view fusion for 3d object detection in lidar point
clouds.

</span>
<span class="ltx_bibblock">In <span id="bib.bib35.1.1" class="ltx_text ltx_font_italic">CoRL</span>, 2020.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
Yin Zhou and Oncel Tuzel.

</span>
<span class="ltx_bibblock">Voxelnet: End-to-end learning for point cloud based 3d object
detection.

</span>
<span class="ltx_bibblock">In <span id="bib.bib36.1.1" class="ltx_text ltx_font_italic">CVPR</span>, 2018.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
Zixiang Zhou, Xiangchen Zhao, Yu Wang, Panqu Wang, and Hassan Foroosh.

</span>
<span class="ltx_bibblock">Centerformer: Center-based transformer for 3d object detection.

</span>
<span class="ltx_bibblock">In <span id="bib.bib37.1.1" class="ltx_text ltx_font_italic">ECCV</span>, 2022.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
Benjin Zhu, Zhe Wang, Shaoshuai Shi, Hang Xu, Lanqing Hong, and Hongsheng Li.

</span>
<span class="ltx_bibblock">Conquer: Query contrast voxel-detr for 3d object detection.

</span>
<span class="ltx_bibblock">In <span id="bib.bib38.1.1" class="ltx_text ltx_font_italic">CVPR</span>, 2023.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
Xinge Zhu, Hui Zhou, Tai Wang, Fangzhou Hong, Yuexin Ma, Wei Li, Hongsheng Li,
and Dahua Lin.

</span>
<span class="ltx_bibblock">Cylindrical and asymmetrical 3d convolution networks for lidar
segmentation.

</span>
<span class="ltx_bibblock">In <span id="bib.bib39.1.1" class="ltx_text ltx_font_italic">CVPR</span>, 2021.

</span>
</li>
</ul>
</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Implementation details</h2>

<section id="A1.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>3D backbone</h3>

<div id="A1.SS1.p1" class="ltx_para">
<p id="A1.SS1.p1.12" class="ltx_p">We adopt the same 3D backbone network VoxelNet following CenterPoint <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> in our experiments.
For polar voxel representation, we replace the original <math id="A1.SS1.p1.1.m1.1" class="ltx_Math" alttext="x-y" display="inline"><semantics id="A1.SS1.p1.1.m1.1a"><mrow id="A1.SS1.p1.1.m1.1.1" xref="A1.SS1.p1.1.m1.1.1.cmml"><mi id="A1.SS1.p1.1.m1.1.1.2" xref="A1.SS1.p1.1.m1.1.1.2.cmml">x</mi><mo id="A1.SS1.p1.1.m1.1.1.1" xref="A1.SS1.p1.1.m1.1.1.1.cmml">−</mo><mi id="A1.SS1.p1.1.m1.1.1.3" xref="A1.SS1.p1.1.m1.1.1.3.cmml">y</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.1.m1.1b"><apply id="A1.SS1.p1.1.m1.1.1.cmml" xref="A1.SS1.p1.1.m1.1.1"><minus id="A1.SS1.p1.1.m1.1.1.1.cmml" xref="A1.SS1.p1.1.m1.1.1.1"></minus><ci id="A1.SS1.p1.1.m1.1.1.2.cmml" xref="A1.SS1.p1.1.m1.1.1.2">𝑥</ci><ci id="A1.SS1.p1.1.m1.1.1.3.cmml" xref="A1.SS1.p1.1.m1.1.1.3">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.1.m1.1c">x-y</annotation></semantics></math> axis with <math id="A1.SS1.p1.2.m2.1" class="ltx_Math" alttext="r-a" display="inline"><semantics id="A1.SS1.p1.2.m2.1a"><mrow id="A1.SS1.p1.2.m2.1.1" xref="A1.SS1.p1.2.m2.1.1.cmml"><mi id="A1.SS1.p1.2.m2.1.1.2" xref="A1.SS1.p1.2.m2.1.1.2.cmml">r</mi><mo id="A1.SS1.p1.2.m2.1.1.1" xref="A1.SS1.p1.2.m2.1.1.1.cmml">−</mo><mi id="A1.SS1.p1.2.m2.1.1.3" xref="A1.SS1.p1.2.m2.1.1.3.cmml">a</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.2.m2.1b"><apply id="A1.SS1.p1.2.m2.1.1.cmml" xref="A1.SS1.p1.2.m2.1.1"><minus id="A1.SS1.p1.2.m2.1.1.1.cmml" xref="A1.SS1.p1.2.m2.1.1.1"></minus><ci id="A1.SS1.p1.2.m2.1.1.2.cmml" xref="A1.SS1.p1.2.m2.1.1.2">𝑟</ci><ci id="A1.SS1.p1.2.m2.1.1.3.cmml" xref="A1.SS1.p1.2.m2.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.2.m2.1c">r-a</annotation></semantics></math> axis in polar, where <math id="A1.SS1.p1.3.m3.1" class="ltx_Math" alttext="r" display="inline"><semantics id="A1.SS1.p1.3.m3.1a"><mi id="A1.SS1.p1.3.m3.1.1" xref="A1.SS1.p1.3.m3.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.3.m3.1b"><ci id="A1.SS1.p1.3.m3.1.1.cmml" xref="A1.SS1.p1.3.m3.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.3.m3.1c">r</annotation></semantics></math> indicates range (distance to the ego in <math id="A1.SS1.p1.4.m4.1" class="ltx_Math" alttext="x" display="inline"><semantics id="A1.SS1.p1.4.m4.1a"><mi id="A1.SS1.p1.4.m4.1.1" xref="A1.SS1.p1.4.m4.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.4.m4.1b"><ci id="A1.SS1.p1.4.m4.1.1.cmml" xref="A1.SS1.p1.4.m4.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.4.m4.1c">x</annotation></semantics></math>-<math id="A1.SS1.p1.5.m5.1" class="ltx_Math" alttext="y" display="inline"><semantics id="A1.SS1.p1.5.m5.1a"><mi id="A1.SS1.p1.5.m5.1.1" xref="A1.SS1.p1.5.m5.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.5.m5.1b"><ci id="A1.SS1.p1.5.m5.1.1.cmml" xref="A1.SS1.p1.5.m5.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.5.m5.1c">y</annotation></semantics></math> axis) and <math id="A1.SS1.p1.6.m6.1" class="ltx_Math" alttext="a" display="inline"><semantics id="A1.SS1.p1.6.m6.1a"><mi id="A1.SS1.p1.6.m6.1.1" xref="A1.SS1.p1.6.m6.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.6.m6.1b"><ci id="A1.SS1.p1.6.m6.1.1.cmml" xref="A1.SS1.p1.6.m6.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.6.m6.1c">a</annotation></semantics></math> indicates azimuth.
After voxelization, the normal sparse convolution network is used to extract 3D feature map, which is no different from the Cartesian one.
The 3D backbone downsamples the dimensions of <math id="A1.SS1.p1.7.m7.1" class="ltx_Math" alttext="r" display="inline"><semantics id="A1.SS1.p1.7.m7.1a"><mi id="A1.SS1.p1.7.m7.1.1" xref="A1.SS1.p1.7.m7.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.7.m7.1b"><ci id="A1.SS1.p1.7.m7.1.1.cmml" xref="A1.SS1.p1.7.m7.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.7.m7.1c">r</annotation></semantics></math> and <math id="A1.SS1.p1.8.m8.1" class="ltx_Math" alttext="a" display="inline"><semantics id="A1.SS1.p1.8.m8.1a"><mi id="A1.SS1.p1.8.m8.1.1" xref="A1.SS1.p1.8.m8.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.8.m8.1b"><ci id="A1.SS1.p1.8.m8.1.1.cmml" xref="A1.SS1.p1.8.m8.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.8.m8.1c">a</annotation></semantics></math> axis with a scale factor of <math id="A1.SS1.p1.9.m9.1" class="ltx_Math" alttext="8" display="inline"><semantics id="A1.SS1.p1.9.m9.1a"><mn id="A1.SS1.p1.9.m9.1.1" xref="A1.SS1.p1.9.m9.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.9.m9.1b"><cn type="integer" id="A1.SS1.p1.9.m9.1.1.cmml" xref="A1.SS1.p1.9.m9.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.9.m9.1c">8</annotation></semantics></math> and the <math id="A1.SS1.p1.10.m10.1" class="ltx_Math" alttext="z" display="inline"><semantics id="A1.SS1.p1.10.m10.1a"><mi id="A1.SS1.p1.10.m10.1.1" xref="A1.SS1.p1.10.m10.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.10.m10.1b"><ci id="A1.SS1.p1.10.m10.1.1.cmml" xref="A1.SS1.p1.10.m10.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.10.m10.1c">z</annotation></semantics></math> axis with <math id="A1.SS1.p1.11.m11.1" class="ltx_Math" alttext="16" display="inline"><semantics id="A1.SS1.p1.11.m11.1a"><mn id="A1.SS1.p1.11.m11.1.1" xref="A1.SS1.p1.11.m11.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.11.m11.1b"><cn type="integer" id="A1.SS1.p1.11.m11.1.1.cmml" xref="A1.SS1.p1.11.m11.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.11.m11.1c">16</annotation></semantics></math>.
And then the 3D feature map is mapped to the BEV and obtain the BEV feature <math id="A1.SS1.p1.12.m12.1" class="ltx_Math" alttext="F\in\mathbb{R}^{R\times A\times C}" display="inline"><semantics id="A1.SS1.p1.12.m12.1a"><mrow id="A1.SS1.p1.12.m12.1.1" xref="A1.SS1.p1.12.m12.1.1.cmml"><mi id="A1.SS1.p1.12.m12.1.1.2" xref="A1.SS1.p1.12.m12.1.1.2.cmml">F</mi><mo id="A1.SS1.p1.12.m12.1.1.1" xref="A1.SS1.p1.12.m12.1.1.1.cmml">∈</mo><msup id="A1.SS1.p1.12.m12.1.1.3" xref="A1.SS1.p1.12.m12.1.1.3.cmml"><mi id="A1.SS1.p1.12.m12.1.1.3.2" xref="A1.SS1.p1.12.m12.1.1.3.2.cmml">ℝ</mi><mrow id="A1.SS1.p1.12.m12.1.1.3.3" xref="A1.SS1.p1.12.m12.1.1.3.3.cmml"><mi id="A1.SS1.p1.12.m12.1.1.3.3.2" xref="A1.SS1.p1.12.m12.1.1.3.3.2.cmml">R</mi><mo lspace="0.222em" rspace="0.222em" id="A1.SS1.p1.12.m12.1.1.3.3.1" xref="A1.SS1.p1.12.m12.1.1.3.3.1.cmml">×</mo><mi id="A1.SS1.p1.12.m12.1.1.3.3.3" xref="A1.SS1.p1.12.m12.1.1.3.3.3.cmml">A</mi><mo lspace="0.222em" rspace="0.222em" id="A1.SS1.p1.12.m12.1.1.3.3.1a" xref="A1.SS1.p1.12.m12.1.1.3.3.1.cmml">×</mo><mi id="A1.SS1.p1.12.m12.1.1.3.3.4" xref="A1.SS1.p1.12.m12.1.1.3.3.4.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.12.m12.1b"><apply id="A1.SS1.p1.12.m12.1.1.cmml" xref="A1.SS1.p1.12.m12.1.1"><in id="A1.SS1.p1.12.m12.1.1.1.cmml" xref="A1.SS1.p1.12.m12.1.1.1"></in><ci id="A1.SS1.p1.12.m12.1.1.2.cmml" xref="A1.SS1.p1.12.m12.1.1.2">𝐹</ci><apply id="A1.SS1.p1.12.m12.1.1.3.cmml" xref="A1.SS1.p1.12.m12.1.1.3"><csymbol cd="ambiguous" id="A1.SS1.p1.12.m12.1.1.3.1.cmml" xref="A1.SS1.p1.12.m12.1.1.3">superscript</csymbol><ci id="A1.SS1.p1.12.m12.1.1.3.2.cmml" xref="A1.SS1.p1.12.m12.1.1.3.2">ℝ</ci><apply id="A1.SS1.p1.12.m12.1.1.3.3.cmml" xref="A1.SS1.p1.12.m12.1.1.3.3"><times id="A1.SS1.p1.12.m12.1.1.3.3.1.cmml" xref="A1.SS1.p1.12.m12.1.1.3.3.1"></times><ci id="A1.SS1.p1.12.m12.1.1.3.3.2.cmml" xref="A1.SS1.p1.12.m12.1.1.3.3.2">𝑅</ci><ci id="A1.SS1.p1.12.m12.1.1.3.3.3.cmml" xref="A1.SS1.p1.12.m12.1.1.3.3.3">𝐴</ci><ci id="A1.SS1.p1.12.m12.1.1.3.3.4.cmml" xref="A1.SS1.p1.12.m12.1.1.3.3.4">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.12.m12.1c">F\in\mathbb{R}^{R\times A\times C}</annotation></semantics></math> for the following pipeline.</p>
</div>
</section>
<section id="A1.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Global representation re-alignment</h3>

<div id="A1.SS2.p1" class="ltx_para">
<p id="A1.SS2.p1.6" class="ltx_p">The GRR applies attention to the representative features for non-local alignment.
It is composed of two attention sub-modules: Condense attention and Angular attention.
We design Condense attention to select representative features to facilitate long-range re-alignment.
In our experiments, the neighborhood of the 1D local max filtering operation is <math id="A1.SS2.p1.1.m1.1" class="ltx_Math" alttext="3" display="inline"><semantics id="A1.SS2.p1.1.m1.1a"><mn id="A1.SS2.p1.1.m1.1.1" xref="A1.SS2.p1.1.m1.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.1.m1.1b"><cn type="integer" id="A1.SS2.p1.1.m1.1.1.cmml" xref="A1.SS2.p1.1.m1.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.1.m1.1c">3</annotation></semantics></math>, and the number of essential features selected from each column (<math id="A1.SS2.p1.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="A1.SS2.p1.2.m2.1a"><mi id="A1.SS2.p1.2.m2.1.1" xref="A1.SS2.p1.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.2.m2.1b"><ci id="A1.SS2.p1.2.m2.1.1.cmml" xref="A1.SS2.p1.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.2.m2.1c">N</annotation></semantics></math>) is set to be <math id="A1.SS2.p1.3.m3.1" class="ltx_Math" alttext="4" display="inline"><semantics id="A1.SS2.p1.3.m3.1a"><mn id="A1.SS2.p1.3.m3.1.1" xref="A1.SS2.p1.3.m3.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.3.m3.1b"><cn type="integer" id="A1.SS2.p1.3.m3.1.1.cmml" xref="A1.SS2.p1.3.m3.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.3.m3.1c">4</annotation></semantics></math>.
In Angular attention, the angular window size <math id="A1.SS2.p1.4.m4.1" class="ltx_Math" alttext="W_{a}" display="inline"><semantics id="A1.SS2.p1.4.m4.1a"><msub id="A1.SS2.p1.4.m4.1.1" xref="A1.SS2.p1.4.m4.1.1.cmml"><mi id="A1.SS2.p1.4.m4.1.1.2" xref="A1.SS2.p1.4.m4.1.1.2.cmml">W</mi><mi id="A1.SS2.p1.4.m4.1.1.3" xref="A1.SS2.p1.4.m4.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.4.m4.1b"><apply id="A1.SS2.p1.4.m4.1.1.cmml" xref="A1.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="A1.SS2.p1.4.m4.1.1.1.cmml" xref="A1.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="A1.SS2.p1.4.m4.1.1.2.cmml" xref="A1.SS2.p1.4.m4.1.1.2">𝑊</ci><ci id="A1.SS2.p1.4.m4.1.1.3.cmml" xref="A1.SS2.p1.4.m4.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.4.m4.1c">W_{a}</annotation></semantics></math> is set to be <math id="A1.SS2.p1.5.m5.1" class="ltx_Math" alttext="8" display="inline"><semantics id="A1.SS2.p1.5.m5.1a"><mn id="A1.SS2.p1.5.m5.1.1" xref="A1.SS2.p1.5.m5.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.5.m5.1b"><cn type="integer" id="A1.SS2.p1.5.m5.1.1.cmml" xref="A1.SS2.p1.5.m5.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.5.m5.1c">8</annotation></semantics></math> and the window shifting stride of the second Angular attention is <math id="A1.SS2.p1.6.m6.1" class="ltx_Math" alttext="4" display="inline"><semantics id="A1.SS2.p1.6.m6.1a"><mn id="A1.SS2.p1.6.m6.1.1" xref="A1.SS2.p1.6.m6.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.6.m6.1b"><cn type="integer" id="A1.SS2.p1.6.m6.1.1.cmml" xref="A1.SS2.p1.6.m6.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.6.m6.1c">4</annotation></semantics></math>, which is the half of the angular window size.
All the parameters are guaranteed to be the best configuration.</p>
</div>
<figure id="A1.T9" class="ltx_table">
<div id="A1.T9.2" class="ltx_inline-block ltx_transformed_outer" style="width:496.9pt;height:80.5pt;vertical-align:-0.5pt;"><span class="ltx_transformed_inner" style="transform:translate(-256.3pt,41.3pt) scale(0.492172170146559,0.492172170146559) ;">
<table id="A1.T9.2.2" class="ltx_tabular ltx_align_middle">
<tr id="A1.T9.2.2.3" class="ltx_tr">
<td id="A1.T9.2.2.3.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" style="padding-top:2.9pt;padding-bottom:2.9pt;" rowspan="2"><span id="A1.T9.2.2.3.1.1" class="ltx_text" style="font-size:144%;">Method</span></td>
<td id="A1.T9.2.2.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:2.9pt;padding-bottom:2.9pt;" rowspan="2"><span id="A1.T9.2.2.3.2.1" class="ltx_text" style="font-size:144%;">mAP(%)</span></td>
<td id="A1.T9.2.2.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:2.9pt;padding-bottom:2.9pt;" colspan="4"><span id="A1.T9.2.2.3.3.1" class="ltx_text" style="font-size:144%;">Vehicle mAP(%)</span></td>
<td id="A1.T9.2.2.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:2.9pt;padding-bottom:2.9pt;" colspan="4"><span id="A1.T9.2.2.3.4.1" class="ltx_text" style="font-size:144%;">Pedestrian mAP(%)</span></td>
<td id="A1.T9.2.2.3.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.9pt;padding-bottom:2.9pt;" colspan="4"><span id="A1.T9.2.2.3.5.1" class="ltx_text" style="font-size:144%;">Cyclist mAP(%)</span></td>
</tr>
<tr id="A1.T9.2.2.4" class="ltx_tr">
<td id="A1.T9.2.2.4.1" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.4.1.1" class="ltx_text" style="font-size:144%;">overall</span></td>
<td id="A1.T9.2.2.4.2" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.4.2.1" class="ltx_text" style="font-size:144%;">0-30m</span></td>
<td id="A1.T9.2.2.4.3" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.4.3.1" class="ltx_text" style="font-size:144%;">30-50m</span></td>
<td id="A1.T9.2.2.4.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.4.4.1" class="ltx_text" style="font-size:144%;">50m-inf</span></td>
<td id="A1.T9.2.2.4.5" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.4.5.1" class="ltx_text" style="font-size:144%;">overall</span></td>
<td id="A1.T9.2.2.4.6" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.4.6.1" class="ltx_text" style="font-size:144%;">0-30m</span></td>
<td id="A1.T9.2.2.4.7" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.4.7.1" class="ltx_text" style="font-size:144%;">30-50m</span></td>
<td id="A1.T9.2.2.4.8" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.4.8.1" class="ltx_text" style="font-size:144%;">50m-inf</span></td>
<td id="A1.T9.2.2.4.9" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.4.9.1" class="ltx_text" style="font-size:144%;">overall</span></td>
<td id="A1.T9.2.2.4.10" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.4.10.1" class="ltx_text" style="font-size:144%;">0-30m</span></td>
<td id="A1.T9.2.2.4.11" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.4.11.1" class="ltx_text" style="font-size:144%;">30-50m</span></td>
<td id="A1.T9.2.2.4.12" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.4.12.1" class="ltx_text" style="font-size:144%;">50m-inf</span></td>
</tr>
<tr id="A1.T9.2.2.5" class="ltx_tr">
<td id="A1.T9.2.2.5.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" style="padding-top:2.9pt;padding-bottom:2.9pt;">
<span id="A1.T9.2.2.5.1.1" class="ltx_text" style="font-size:144%;">PointRCNN </span><cite class="ltx_cite ltx_citemacro_cite"><span id="A1.T9.2.2.5.1.2.1" class="ltx_text" style="font-size:144%;">[</span><a href="#bib.bib24" title="" class="ltx_ref">24</a><span id="A1.T9.2.2.5.1.3.2" class="ltx_text" style="font-size:144%;">]</span></cite>
</td>
<td id="A1.T9.2.2.5.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.5.2.1" class="ltx_text" style="font-size:144%;">28.74</span></td>
<td id="A1.T9.2.2.5.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.5.3.1" class="ltx_text" style="font-size:144%;">52.09</span></td>
<td id="A1.T9.2.2.5.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.5.4.1" class="ltx_text" style="font-size:144%;">74.45</span></td>
<td id="A1.T9.2.2.5.5" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.5.5.1" class="ltx_text" style="font-size:144%;">40.89</span></td>
<td id="A1.T9.2.2.5.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.5.6.1" class="ltx_text" style="font-size:144%;">16.81</span></td>
<td id="A1.T9.2.2.5.7" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.5.7.1" class="ltx_text" style="font-size:144%;">4.28</span></td>
<td id="A1.T9.2.2.5.8" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.5.8.1" class="ltx_text" style="font-size:144%;">6.17</span></td>
<td id="A1.T9.2.2.5.9" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.5.9.1" class="ltx_text" style="font-size:144%;">2.4</span></td>
<td id="A1.T9.2.2.5.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.5.10.1" class="ltx_text" style="font-size:144%;">0.91</span></td>
<td id="A1.T9.2.2.5.11" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.5.11.1" class="ltx_text" style="font-size:144%;">29.84</span></td>
<td id="A1.T9.2.2.5.12" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.5.12.1" class="ltx_text" style="font-size:144%;">46.03</span></td>
<td id="A1.T9.2.2.5.13" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.5.13.1" class="ltx_text" style="font-size:144%;">20.94</span></td>
<td id="A1.T9.2.2.5.14" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.5.14.1" class="ltx_text" style="font-size:144%;">5.46</span></td>
</tr>
<tr id="A1.T9.2.2.6" class="ltx_tr">
<td id="A1.T9.2.2.6.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:2.9pt;padding-bottom:2.9pt;">
<span id="A1.T9.2.2.6.1.1" class="ltx_text" style="font-size:144%;">PointPillars </span><cite class="ltx_cite ltx_citemacro_cite"><span id="A1.T9.2.2.6.1.2.1" class="ltx_text" style="font-size:144%;">[</span><a href="#bib.bib12" title="" class="ltx_ref">12</a><span id="A1.T9.2.2.6.1.3.2" class="ltx_text" style="font-size:144%;">]</span></cite>
</td>
<td id="A1.T9.2.2.6.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.6.2.1" class="ltx_text" style="font-size:144%;">44.34</span></td>
<td id="A1.T9.2.2.6.3" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.6.3.1" class="ltx_text" style="font-size:144%;">68.57</span></td>
<td id="A1.T9.2.2.6.4" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.6.4.1" class="ltx_text" style="font-size:144%;">80.86</span></td>
<td id="A1.T9.2.2.6.5" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.6.5.1" class="ltx_text" style="font-size:144%;">62.07</span></td>
<td id="A1.T9.2.2.6.6" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.6.6.1" class="ltx_text" style="font-size:144%;">47.04</span></td>
<td id="A1.T9.2.2.6.7" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.6.7.1" class="ltx_text" style="font-size:144%;">17.63</span></td>
<td id="A1.T9.2.2.6.8" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.6.8.1" class="ltx_text" style="font-size:144%;">19.74</span></td>
<td id="A1.T9.2.2.6.9" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.6.9.1" class="ltx_text" style="font-size:144%;">15.15</span></td>
<td id="A1.T9.2.2.6.10" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.6.10.1" class="ltx_text" style="font-size:144%;">10.23</span></td>
<td id="A1.T9.2.2.6.11" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.6.11.1" class="ltx_text" style="font-size:144%;">46.81</span></td>
<td id="A1.T9.2.2.6.12" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.6.12.1" class="ltx_text" style="font-size:144%;">58.33</span></td>
<td id="A1.T9.2.2.6.13" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.6.13.1" class="ltx_text" style="font-size:144%;">40.32</span></td>
<td id="A1.T9.2.2.6.14" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.6.14.1" class="ltx_text" style="font-size:144%;">25.86</span></td>
</tr>
<tr id="A1.T9.2.2.7" class="ltx_tr">
<td id="A1.T9.2.2.7.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:2.9pt;padding-bottom:2.9pt;">
<span id="A1.T9.2.2.7.1.1" class="ltx_text" style="font-size:144%;">PV-RCNN </span><cite class="ltx_cite ltx_citemacro_cite"><span id="A1.T9.2.2.7.1.2.1" class="ltx_text" style="font-size:144%;">[</span><a href="#bib.bib23" title="" class="ltx_ref">23</a><span id="A1.T9.2.2.7.1.3.2" class="ltx_text" style="font-size:144%;">]</span></cite>
</td>
<td id="A1.T9.2.2.7.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.7.2.1" class="ltx_text" style="font-size:144%;">55.35</span></td>
<td id="A1.T9.2.2.7.3" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.7.3.1" class="ltx_text" style="font-size:144%;">77.77</span></td>
<td id="A1.T9.2.2.7.4" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.7.4.1" class="ltx_text" style="font-size:144%;">89.39</span></td>
<td id="A1.T9.2.2.7.5" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.7.5.1" class="ltx_text" style="font-size:144%;">72.55</span></td>
<td id="A1.T9.2.2.7.6" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.7.6.1" class="ltx_text" style="font-size:144%;">58.64</span></td>
<td id="A1.T9.2.2.7.7" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.7.7.1" class="ltx_text" style="font-size:144%;">23.50</span></td>
<td id="A1.T9.2.2.7.8" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.7.8.1" class="ltx_text" style="font-size:144%;">25.61</span></td>
<td id="A1.T9.2.2.7.9" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.7.9.1" class="ltx_text" style="font-size:144%;">22.84</span></td>
<td id="A1.T9.2.2.7.10" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.7.10.1" class="ltx_text" style="font-size:144%;">17.27</span></td>
<td id="A1.T9.2.2.7.11" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.7.11.1" class="ltx_text" style="font-size:144%;">59.37</span></td>
<td id="A1.T9.2.2.7.12" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.7.12.1" class="ltx_text" style="font-size:144%;">71.66</span></td>
<td id="A1.T9.2.2.7.13" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.7.13.1" class="ltx_text" style="font-size:144%;">52.58</span></td>
<td id="A1.T9.2.2.7.14" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.7.14.1" class="ltx_text" style="font-size:144%;">36.17</span></td>
</tr>
<tr id="A1.T9.2.2.8" class="ltx_tr">
<td id="A1.T9.2.2.8.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:2.9pt;padding-bottom:2.9pt;">
<span id="A1.T9.2.2.8.1.1" class="ltx_text" style="font-size:144%;">CenterPoint-Cartesian </span><cite class="ltx_cite ltx_citemacro_cite"><span id="A1.T9.2.2.8.1.2.1" class="ltx_text" style="font-size:144%;">[</span><a href="#bib.bib32" title="" class="ltx_ref">32</a><span id="A1.T9.2.2.8.1.3.2" class="ltx_text" style="font-size:144%;">]</span></cite>
</td>
<td id="A1.T9.2.2.8.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.8.2.1" class="ltx_text" style="font-size:144%;">60.05</span></td>
<td id="A1.T9.2.2.8.3" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.8.3.1" class="ltx_text" style="font-size:144%;">66.79</span></td>
<td id="A1.T9.2.2.8.4" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.8.4.1" class="ltx_text" style="font-size:144%;">80.10</span></td>
<td id="A1.T9.2.2.8.5" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.8.5.1" class="ltx_text" style="font-size:144%;">59.55</span></td>
<td id="A1.T9.2.2.8.6" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.8.6.1" class="ltx_text" style="font-size:144%;">43.39</span></td>
<td id="A1.T9.2.2.8.7" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.8.7.1" class="ltx_text" style="font-size:144%;">49.90</span></td>
<td id="A1.T9.2.2.8.8" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.8.8.1" class="ltx_text" style="font-size:144%;">56.24</span></td>
<td id="A1.T9.2.2.8.9" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.8.9.1" class="ltx_text" style="font-size:144%;">42.61</span></td>
<td id="A1.T9.2.2.8.10" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.8.10.1" class="ltx_text" style="font-size:144%;">26.27</span></td>
<td id="A1.T9.2.2.8.11" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.8.11.1" class="ltx_text" style="font-size:144%;">63.45</span></td>
<td id="A1.T9.2.2.8.12" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.8.12.1" class="ltx_text" style="font-size:144%;">74.28</span></td>
<td id="A1.T9.2.2.8.13" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.8.13.1" class="ltx_text" style="font-size:144%;">57.94</span></td>
<td id="A1.T9.2.2.8.14" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.8.14.1" class="ltx_text" style="font-size:144%;">41.48</span></td>
</tr>
<tr id="A1.T9.1.1.1" class="ltx_tr">
<td id="A1.T9.1.1.1.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" style="padding-top:2.9pt;padding-bottom:2.9pt;">
<span id="A1.T9.1.1.1.1.1" class="ltx_text" style="font-size:144%;">CenterPoint-Polar</span><sup id="A1.T9.1.1.1.1.2" class="ltx_sup"><span id="A1.T9.1.1.1.1.2.1" class="ltx_text ltx_font_italic" style="font-size:144%;">†</span></sup><span id="A1.T9.1.1.1.1.3" class="ltx_text" style="font-size:144%;"> </span><cite class="ltx_cite ltx_citemacro_cite"><span id="A1.T9.1.1.1.1.4.1" class="ltx_text" style="font-size:144%;">[</span><a href="#bib.bib32" title="" class="ltx_ref">32</a><span id="A1.T9.1.1.1.1.5.2" class="ltx_text" style="font-size:144%;">]</span></cite>
</td>
<td id="A1.T9.1.1.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.1.1.1.2.1" class="ltx_text" style="font-size:144%;">49.55</span></td>
<td id="A1.T9.1.1.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.1.1.1.3.1" class="ltx_text" style="font-size:144%;">64.62</span></td>
<td id="A1.T9.1.1.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.1.1.1.4.1" class="ltx_text" style="font-size:144%;">77.29</span></td>
<td id="A1.T9.1.1.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.1.1.1.5.1" class="ltx_text" style="font-size:144%;">59.75</span></td>
<td id="A1.T9.1.1.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.1.1.1.6.1" class="ltx_text" style="font-size:144%;">38.21</span></td>
<td id="A1.T9.1.1.1.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.1.1.1.7.1" class="ltx_text" style="font-size:144%;">24.67</span></td>
<td id="A1.T9.1.1.1.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.1.1.1.8.1" class="ltx_text" style="font-size:144%;">30.12</span></td>
<td id="A1.T9.1.1.1.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.1.1.1.9.1" class="ltx_text" style="font-size:144%;">20.68</span></td>
<td id="A1.T9.1.1.1.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.1.1.1.10.1" class="ltx_text" style="font-size:144%;">11.42</span></td>
<td id="A1.T9.1.1.1.11" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.1.1.1.11.1" class="ltx_text" style="font-size:144%;">59.35</span></td>
<td id="A1.T9.1.1.1.12" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.1.1.1.12.1" class="ltx_text" style="font-size:144%;">71.31</span></td>
<td id="A1.T9.1.1.1.13" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.1.1.1.13.1" class="ltx_text" style="font-size:144%;">55.90</span></td>
<td id="A1.T9.1.1.1.14" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.1.1.1.14.1" class="ltx_text" style="font-size:144%;">31.95</span></td>
</tr>
<tr id="A1.T9.2.2.2" class="ltx_tr">
<td id="A1.T9.2.2.2.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:2.9pt;padding-bottom:2.9pt;">
<span id="A1.T9.2.2.2.1.1" class="ltx_text" style="font-size:144%;">PolarStream</span><sup id="A1.T9.2.2.2.1.2" class="ltx_sup"><span id="A1.T9.2.2.2.1.2.1" class="ltx_text ltx_font_italic" style="font-size:144%;">†</span></sup><span id="A1.T9.2.2.2.1.3" class="ltx_text" style="font-size:144%;"> </span><cite class="ltx_cite ltx_citemacro_cite"><span id="A1.T9.2.2.2.1.4.1" class="ltx_text" style="font-size:144%;">[</span><a href="#bib.bib3" title="" class="ltx_ref">3</a><span id="A1.T9.2.2.2.1.5.2" class="ltx_text" style="font-size:144%;">]</span></cite>
</td>
<td id="A1.T9.2.2.2.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.2.2.1" class="ltx_text" style="font-size:144%;">53.33</span></td>
<td id="A1.T9.2.2.2.3" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.2.3.1" class="ltx_text" style="font-size:144%;">65.54</span></td>
<td id="A1.T9.2.2.2.4" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.2.4.1" class="ltx_text" style="font-size:144%;">78.03</span></td>
<td id="A1.T9.2.2.2.5" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.2.5.1" class="ltx_text" style="font-size:144%;">60.13</span></td>
<td id="A1.T9.2.2.2.6" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.2.6.1" class="ltx_text" style="font-size:144%;">38.76</span></td>
<td id="A1.T9.2.2.2.7" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.2.7.1" class="ltx_text" style="font-size:144%;">33.76</span></td>
<td id="A1.T9.2.2.2.8" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.2.8.1" class="ltx_text" style="font-size:144%;">40.94</span></td>
<td id="A1.T9.2.2.2.9" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.2.9.1" class="ltx_text" style="font-size:144%;">29.57</span></td>
<td id="A1.T9.2.2.2.10" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.2.10.1" class="ltx_text" style="font-size:144%;">15.32</span></td>
<td id="A1.T9.2.2.2.11" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.2.11.1" class="ltx_text" style="font-size:144%;">60.69</span></td>
<td id="A1.T9.2.2.2.12" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.2.12.1" class="ltx_text" style="font-size:144%;">72.53</span></td>
<td id="A1.T9.2.2.2.13" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.2.13.1" class="ltx_text" style="font-size:144%;">57.10</span></td>
<td id="A1.T9.2.2.2.14" class="ltx_td ltx_align_center" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.2.14.1" class="ltx_text" style="font-size:144%;">32.34</span></td>
</tr>
<tr id="A1.T9.2.2.9" class="ltx_tr">
<td id="A1.T9.2.2.9.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_r" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.9.1.1" class="ltx_text" style="font-size:144%;">PARTNER (Ours)</span></td>
<td id="A1.T9.2.2.9.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.9.2.1" class="ltx_text ltx_font_bold" style="font-size:144%;">63.15</span></td>
<td id="A1.T9.2.2.9.3" class="ltx_td ltx_align_center ltx_border_b" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.9.3.1" class="ltx_text ltx_font_bold" style="font-size:144%;">68.07</span></td>
<td id="A1.T9.2.2.9.4" class="ltx_td ltx_align_center ltx_border_b" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.9.4.1" class="ltx_text ltx_font_bold" style="font-size:144%;">79.41</span></td>
<td id="A1.T9.2.2.9.5" class="ltx_td ltx_align_center ltx_border_b" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.9.5.1" class="ltx_text ltx_font_bold" style="font-size:144%;">62.77</span></td>
<td id="A1.T9.2.2.9.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_r" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.9.6.1" class="ltx_text ltx_font_bold" style="font-size:144%;">44.35</span></td>
<td id="A1.T9.2.2.9.7" class="ltx_td ltx_align_center ltx_border_b" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.9.7.1" class="ltx_text ltx_font_bold" style="font-size:144%;">53.45</span></td>
<td id="A1.T9.2.2.9.8" class="ltx_td ltx_align_center ltx_border_b" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.9.8.1" class="ltx_text ltx_font_bold" style="font-size:144%;">66.56</span></td>
<td id="A1.T9.2.2.9.9" class="ltx_td ltx_align_center ltx_border_b" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.9.9.1" class="ltx_text ltx_font_bold" style="font-size:144%;">41.08</span></td>
<td id="A1.T9.2.2.9.10" class="ltx_td ltx_align_center ltx_border_b ltx_border_r" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.9.10.1" class="ltx_text ltx_font_bold" style="font-size:144%;">26.76</span></td>
<td id="A1.T9.2.2.9.11" class="ltx_td ltx_align_center ltx_border_b" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.9.11.1" class="ltx_text ltx_font_bold" style="font-size:144%;">65.93</span></td>
<td id="A1.T9.2.2.9.12" class="ltx_td ltx_align_center ltx_border_b" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.9.12.1" class="ltx_text ltx_font_bold" style="font-size:144%;">78.86</span></td>
<td id="A1.T9.2.2.9.13" class="ltx_td ltx_align_center ltx_border_b" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.9.13.1" class="ltx_text ltx_font_bold" style="font-size:144%;">62.17</span></td>
<td id="A1.T9.2.2.9.14" class="ltx_td ltx_align_center ltx_border_b" style="padding-top:2.9pt;padding-bottom:2.9pt;"><span id="A1.T9.2.2.9.14.1" class="ltx_text ltx_font_bold" style="font-size:144%;">42.23</span></td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption" style="font-size:144%;"><span class="ltx_tag ltx_tag_table">Table 9: </span>Performance comparisons of 3D object detection on the ONCE val. set.
We maintain the same backbone architecture and training configurations with the baselines on the ONCE benchmark.
<sup id="A1.T9.9.1" class="ltx_sup"><span id="A1.T9.9.1.1" class="ltx_text ltx_font_italic">†</span></sup>: re-implemented using the official code.
We re-implement CenterPoints in polar coordinates for fair comparison.
</figcaption>
</figure>
</section>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Detailed experimental results on the ONCE dataset</h2>

<div id="A2.p1" class="ltx_para">
<p id="A2.p1.4" class="ltx_p">In the ONCE dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>, there are one million point cloud frames in total, with 5k, 3k, and 8k frames annotated for training, validation, and testing.
The unlabeled point cloud frames are kept for self-supervised learning or semi-supervised learning.
Our ONCE model is trained on the training set and evaluated on the validation and testing set without using the unlabeled data.
The evaluation metric follows Waymo Open Dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> and it does not differentiate between L1 and L2.
On the ONCE Dataset, the detection range is set to [0.3m, 75.18m] for the <math id="A2.p1.1.m1.1" class="ltx_Math" alttext="r" display="inline"><semantics id="A2.p1.1.m1.1a"><mi id="A2.p1.1.m1.1.1" xref="A2.p1.1.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="A2.p1.1.m1.1b"><ci id="A2.p1.1.m1.1.1.cmml" xref="A2.p1.1.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.1.m1.1c">r</annotation></semantics></math> axis, [<math id="A2.p1.2.m2.1" class="ltx_Math" alttext="-\pi" display="inline"><semantics id="A2.p1.2.m2.1a"><mrow id="A2.p1.2.m2.1.1" xref="A2.p1.2.m2.1.1.cmml"><mo id="A2.p1.2.m2.1.1a" xref="A2.p1.2.m2.1.1.cmml">−</mo><mi id="A2.p1.2.m2.1.1.2" xref="A2.p1.2.m2.1.1.2.cmml">π</mi></mrow><annotation-xml encoding="MathML-Content" id="A2.p1.2.m2.1b"><apply id="A2.p1.2.m2.1.1.cmml" xref="A2.p1.2.m2.1.1"><minus id="A2.p1.2.m2.1.1.1.cmml" xref="A2.p1.2.m2.1.1"></minus><ci id="A2.p1.2.m2.1.1.2.cmml" xref="A2.p1.2.m2.1.1.2">𝜋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.2.m2.1c">-\pi</annotation></semantics></math>, <math id="A2.p1.3.m3.1" class="ltx_Math" alttext="\pi" display="inline"><semantics id="A2.p1.3.m3.1a"><mi id="A2.p1.3.m3.1.1" xref="A2.p1.3.m3.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="A2.p1.3.m3.1b"><ci id="A2.p1.3.m3.1.1.cmml" xref="A2.p1.3.m3.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.3.m3.1c">\pi</annotation></semantics></math>] for the <math id="A2.p1.4.m4.1" class="ltx_Math" alttext="a" display="inline"><semantics id="A2.p1.4.m4.1a"><mi id="A2.p1.4.m4.1.1" xref="A2.p1.4.m4.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="A2.p1.4.m4.1b"><ci id="A2.p1.4.m4.1.1.cmml" xref="A2.p1.4.m4.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.4.m4.1c">a</annotation></semantics></math> axis, and [-5m, 3m] for the <span id="A2.p1.4.1" class="ltx_text ltx_font_italic">z</span> axis.</p>
</div>
<div id="A2.p2" class="ltx_para">
<p id="A2.p2.1" class="ltx_p">The detection results are divided according to the object distances to the sensor: 0-30m, 30-50m, and 50m-inf.
Due to page limitation, in the main paper we only evaluate the performance ignoring the distance.
In this section, we report the detailed performance according to distance in Table <a href="#A1.T9" title="Table 9 ‣ A.2 Global representation re-alignment ‣ Appendix A Implementation details ‣ PARTNER: Level up the Polar Representation for LiDAR 3D Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>.
Our method attains consistent advantages in different ranges compared to the Cartesian-based 3D object detectors <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> as well as polar-based state-of-the-art method <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>.</p>
</div>
<figure id="A2.T10" class="ltx_table">
<div id="A2.T10.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:325.2pt;height:140.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(58.6pt,-25.3pt) scale(1.56316771373936,1.56316771373936) ;">
<table id="A2.T10.1.1" class="ltx_tabular ltx_align_middle">
<tr id="A2.T10.1.1.1" class="ltx_tr">
<td id="A2.T10.1.1.1.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">Methods</td>
<td id="A2.T10.1.1.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">Frames</td>
<td id="A2.T10.1.1.1.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">
<span id="A2.T10.1.1.1.3.1" class="ltx_inline-block ltx_align_top">
<span id="A2.T10.1.1.1.3.1.1" class="ltx_p" style="width:71.1pt;">L2 mAPH</span>
</span>
</td>
</tr>
<tr id="A2.T10.1.1.2" class="ltx_tr">
<td id="A2.T10.1.1.2.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">SWFormer</td>
<td id="A2.T10.1.1.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">3</td>
<td id="A2.T10.1.1.2.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">
<span id="A2.T10.1.1.2.3.1" class="ltx_inline-block ltx_align_top">
<span id="A2.T10.1.1.2.3.1.1" class="ltx_p" style="width:71.1pt;">74.7</span>
</span>
</td>
</tr>
<tr id="A2.T10.1.1.3" class="ltx_tr">
<td id="A2.T10.1.1.3.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">ConQueR</td>
<td id="A2.T10.1.1.3.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">1</td>
<td id="A2.T10.1.1.3.3" class="ltx_td ltx_align_justify ltx_align_top" style="padding-top:1pt;padding-bottom:1pt;">
<span id="A2.T10.1.1.3.3.1" class="ltx_inline-block ltx_align_top">
<span id="A2.T10.1.1.3.3.1.1" class="ltx_p" style="width:71.1pt;">73.3</span>
</span>
</td>
</tr>
<tr id="A2.T10.1.1.4" class="ltx_tr">
<td id="A2.T10.1.1.4.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">PARTNER-CP</td>
<td id="A2.T10.1.1.4.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">1</td>
<td id="A2.T10.1.1.4.3" class="ltx_td ltx_align_justify ltx_align_top" style="padding-top:1pt;padding-bottom:1pt;">
<span id="A2.T10.1.1.4.3.1" class="ltx_inline-block ltx_align_top">
<span id="A2.T10.1.1.4.3.1.1" class="ltx_p" style="width:71.1pt;">73.2</span>
</span>
</td>
</tr>
<tr id="A2.T10.1.1.5" class="ltx_tr">
<td id="A2.T10.1.1.5.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">PARTNER-CF</td>
<td id="A2.T10.1.1.5.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">1</td>
<td id="A2.T10.1.1.5.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b" style="padding-top:1pt;padding-bottom:1pt;">
<span id="A2.T10.1.1.5.3.1" class="ltx_inline-block ltx_align_top">
<span id="A2.T10.1.1.5.3.1.1" class="ltx_p" style="width:71.1pt;"><span id="A2.T10.1.1.5.3.1.1.1" class="ltx_text ltx_font_bold">75.0</span></span>
</span>
</td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 10: </span>Results on Waymo test set.
</figcaption>
</figure>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Experimental results on the Waymo test set</h2>

<div id="A3.p1" class="ltx_para">
<p id="A3.p1.1" class="ltx_p">To make fully comparison, we compare with two recent state-of-the-art works, SWFormer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> and ConQueR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite> on the Waymo <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> test set.
Actually, our PARTNER-CF has outperformed SWFormer (single-frame) and ConQueR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite> (1x resolution) in L2 on the validation set.
As ConQueR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite> only reports its results with 2x resolution backbone (mentioned in ConQueR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite>) on the test set, to make comparison fairly, we also utilize the 2x resolution trick and report our results in Tab. <a href="#A2.T10" title="Table 10 ‣ Appendix B Detailed experimental results on the ONCE dataset ‣ PARTNER: Level up the Polar Representation for LiDAR 3D Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>.
Results prove the advantages of our algorithm even compared with state-of-the-art methods.</p>
</div>
</section>
<section id="A4" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>More ablations</h2>

<section id="A4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.1 </span>Effects of different partition patterns</h3>

<figure id="A4.T11" class="ltx_table">
<div id="A4.T11.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:133.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(70.5pt,-21.7pt) scale(1.48214405113421,1.48214405113421) ;">
<table id="A4.T11.1.1" class="ltx_tabular ltx_align_middle">
<tr id="A4.T11.1.1.1" class="ltx_tr">
<td id="A4.T11.1.1.1.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="A4.T11.1.1.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="A4.T11.1.1.1.1.1.1" class="ltx_p" style="width:71.1pt;"><span id="A4.T11.1.1.1.1.1.1.1" class="ltx_text">Discretization</span></span>
</span>
</td>
<td id="A4.T11.1.1.1.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="A4.T11.1.1.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="A4.T11.1.1.1.2.1.1" class="ltx_p" style="width:91.0pt;">Veh. LEVEL 1</span>
</span>
</td>
<td id="A4.T11.1.1.1.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="A4.T11.1.1.1.3.1" class="ltx_inline-block ltx_align_top">
<span id="A4.T11.1.1.1.3.1.1" class="ltx_p" style="width:91.0pt;">Veh. LEVEL 2</span>
</span>
</td>
</tr>
<tr id="A4.T11.1.1.2" class="ltx_tr">
<td id="A4.T11.1.1.2.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="A4.T11.1.1.2.1.1" class="ltx_inline-block ltx_align_top">
<span id="A4.T11.1.1.2.1.1.1" class="ltx_p" style="width:71.1pt;"></span>
</span>
</td>
<td id="A4.T11.1.1.2.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="A4.T11.1.1.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="A4.T11.1.1.2.2.1.1" class="ltx_p" style="width:91.0pt;">mAP/mAPH(%)</span>
</span>
</td>
<td id="A4.T11.1.1.2.3" class="ltx_td ltx_align_justify ltx_align_top" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="A4.T11.1.1.2.3.1" class="ltx_inline-block ltx_align_top">
<span id="A4.T11.1.1.2.3.1.1" class="ltx_p" style="width:91.0pt;">mAP/mAPH(%)</span>
</span>
</td>
</tr>
<tr id="A4.T11.1.1.3" class="ltx_tr">
<td id="A4.T11.1.1.3.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_tt" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="A4.T11.1.1.3.1.1" class="ltx_inline-block ltx_align_top">
<span id="A4.T11.1.1.3.1.1.1" class="ltx_p" style="width:71.1pt;">SID <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite></span>
</span>
</td>
<td id="A4.T11.1.1.3.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_tt" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="A4.T11.1.1.3.2.1" class="ltx_inline-block ltx_align_top">
<span id="A4.T11.1.1.3.2.1.1" class="ltx_p" style="width:91.0pt;">74.32/73.69</span>
</span>
</td>
<td id="A4.T11.1.1.3.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_tt" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="A4.T11.1.1.3.3.1" class="ltx_inline-block ltx_align_top">
<span id="A4.T11.1.1.3.3.1.1" class="ltx_p" style="width:91.0pt;">65.81/65.30</span>
</span>
</td>
</tr>
<tr id="A4.T11.1.1.4" class="ltx_tr">
<td id="A4.T11.1.1.4.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="A4.T11.1.1.4.1.1" class="ltx_inline-block ltx_align_top">
<span id="A4.T11.1.1.4.1.1.1" class="ltx_p" style="width:71.1pt;">LID <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite></span>
</span>
</td>
<td id="A4.T11.1.1.4.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="A4.T11.1.1.4.2.1" class="ltx_inline-block ltx_align_top">
<span id="A4.T11.1.1.4.2.1.1" class="ltx_p" style="width:91.0pt;">74.61/73.91</span>
</span>
</td>
<td id="A4.T11.1.1.4.3" class="ltx_td ltx_align_justify ltx_align_top" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="A4.T11.1.1.4.3.1" class="ltx_inline-block ltx_align_top">
<span id="A4.T11.1.1.4.3.1.1" class="ltx_p" style="width:91.0pt;">66.14/65.61</span>
</span>
</td>
</tr>
<tr id="A4.T11.1.1.5" class="ltx_tr">
<td id="A4.T11.1.1.5.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="A4.T11.1.1.5.1.1" class="ltx_inline-block ltx_align_top">
<span id="A4.T11.1.1.5.1.1.1" class="ltx_p" style="width:71.1pt;">UD (Ours)</span>
</span>
</td>
<td id="A4.T11.1.1.5.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="A4.T11.1.1.5.2.1" class="ltx_inline-block ltx_align_top">
<span id="A4.T11.1.1.5.2.1.1" class="ltx_p" style="width:91.0pt;"><span id="A4.T11.1.1.5.2.1.1.1" class="ltx_text ltx_font_bold">75.35/74.85</span></span>
</span>
</td>
<td id="A4.T11.1.1.5.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="A4.T11.1.1.5.3.1" class="ltx_inline-block ltx_align_top">
<span id="A4.T11.1.1.5.3.1.1" class="ltx_p" style="width:91.0pt;"><span id="A4.T11.1.1.5.3.1.1.1" class="ltx_text ltx_font_bold">67.84/67.35</span></span>
</span>
</td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 11: </span>Comparison of different discretization strategies.
We show the 12 epochs results on the Waymo val. set.
</figcaption>
</figure>
<div id="A4.SS1.p1" class="ltx_para">
<p id="A4.SS1.p1.2" class="ltx_p">In the main paper, we first transform the points on Cartesian coordinate system to the polar system by transforming the points <math id="A4.SS1.p1.1.m1.4" class="ltx_Math" alttext="\{(x,y,z)\}" display="inline"><semantics id="A4.SS1.p1.1.m1.4a"><mrow id="A4.SS1.p1.1.m1.4.4.1" xref="A4.SS1.p1.1.m1.4.4.2.cmml"><mo stretchy="false" id="A4.SS1.p1.1.m1.4.4.1.2" xref="A4.SS1.p1.1.m1.4.4.2.cmml">{</mo><mrow id="A4.SS1.p1.1.m1.4.4.1.1.2" xref="A4.SS1.p1.1.m1.4.4.1.1.1.cmml"><mo stretchy="false" id="A4.SS1.p1.1.m1.4.4.1.1.2.1" xref="A4.SS1.p1.1.m1.4.4.1.1.1.cmml">(</mo><mi id="A4.SS1.p1.1.m1.1.1" xref="A4.SS1.p1.1.m1.1.1.cmml">x</mi><mo id="A4.SS1.p1.1.m1.4.4.1.1.2.2" xref="A4.SS1.p1.1.m1.4.4.1.1.1.cmml">,</mo><mi id="A4.SS1.p1.1.m1.2.2" xref="A4.SS1.p1.1.m1.2.2.cmml">y</mi><mo id="A4.SS1.p1.1.m1.4.4.1.1.2.3" xref="A4.SS1.p1.1.m1.4.4.1.1.1.cmml">,</mo><mi id="A4.SS1.p1.1.m1.3.3" xref="A4.SS1.p1.1.m1.3.3.cmml">z</mi><mo stretchy="false" id="A4.SS1.p1.1.m1.4.4.1.1.2.4" xref="A4.SS1.p1.1.m1.4.4.1.1.1.cmml">)</mo></mrow><mo stretchy="false" id="A4.SS1.p1.1.m1.4.4.1.3" xref="A4.SS1.p1.1.m1.4.4.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.SS1.p1.1.m1.4b"><set id="A4.SS1.p1.1.m1.4.4.2.cmml" xref="A4.SS1.p1.1.m1.4.4.1"><vector id="A4.SS1.p1.1.m1.4.4.1.1.1.cmml" xref="A4.SS1.p1.1.m1.4.4.1.1.2"><ci id="A4.SS1.p1.1.m1.1.1.cmml" xref="A4.SS1.p1.1.m1.1.1">𝑥</ci><ci id="A4.SS1.p1.1.m1.2.2.cmml" xref="A4.SS1.p1.1.m1.2.2">𝑦</ci><ci id="A4.SS1.p1.1.m1.3.3.cmml" xref="A4.SS1.p1.1.m1.3.3">𝑧</ci></vector></set></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p1.1.m1.4c">\{(x,y,z)\}</annotation></semantics></math> to points <math id="A4.SS1.p1.2.m2.4" class="ltx_Math" alttext="\{(r,a,z)\}" display="inline"><semantics id="A4.SS1.p1.2.m2.4a"><mrow id="A4.SS1.p1.2.m2.4.4.1" xref="A4.SS1.p1.2.m2.4.4.2.cmml"><mo stretchy="false" id="A4.SS1.p1.2.m2.4.4.1.2" xref="A4.SS1.p1.2.m2.4.4.2.cmml">{</mo><mrow id="A4.SS1.p1.2.m2.4.4.1.1.2" xref="A4.SS1.p1.2.m2.4.4.1.1.1.cmml"><mo stretchy="false" id="A4.SS1.p1.2.m2.4.4.1.1.2.1" xref="A4.SS1.p1.2.m2.4.4.1.1.1.cmml">(</mo><mi id="A4.SS1.p1.2.m2.1.1" xref="A4.SS1.p1.2.m2.1.1.cmml">r</mi><mo id="A4.SS1.p1.2.m2.4.4.1.1.2.2" xref="A4.SS1.p1.2.m2.4.4.1.1.1.cmml">,</mo><mi id="A4.SS1.p1.2.m2.2.2" xref="A4.SS1.p1.2.m2.2.2.cmml">a</mi><mo id="A4.SS1.p1.2.m2.4.4.1.1.2.3" xref="A4.SS1.p1.2.m2.4.4.1.1.1.cmml">,</mo><mi id="A4.SS1.p1.2.m2.3.3" xref="A4.SS1.p1.2.m2.3.3.cmml">z</mi><mo stretchy="false" id="A4.SS1.p1.2.m2.4.4.1.1.2.4" xref="A4.SS1.p1.2.m2.4.4.1.1.1.cmml">)</mo></mrow><mo stretchy="false" id="A4.SS1.p1.2.m2.4.4.1.3" xref="A4.SS1.p1.2.m2.4.4.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.SS1.p1.2.m2.4b"><set id="A4.SS1.p1.2.m2.4.4.2.cmml" xref="A4.SS1.p1.2.m2.4.4.1"><vector id="A4.SS1.p1.2.m2.4.4.1.1.1.cmml" xref="A4.SS1.p1.2.m2.4.4.1.1.2"><ci id="A4.SS1.p1.2.m2.1.1.cmml" xref="A4.SS1.p1.2.m2.1.1">𝑟</ci><ci id="A4.SS1.p1.2.m2.2.2.cmml" xref="A4.SS1.p1.2.m2.2.2">𝑎</ci><ci id="A4.SS1.p1.2.m2.3.3.cmml" xref="A4.SS1.p1.2.m2.3.3">𝑧</ci></vector></set></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p1.2.m2.4c">\{(r,a,z)\}</annotation></semantics></math>.
Then the voxelization performs the split on these three dimensions evenly.
Due to polarizing, the evenly partitioned grid will have varying volumes according to range (more farther-away region, larger grid), which coincides with the imbalanced distribution of point clouds.
Nevertheless, partition range evenly may not be the most appropriate setting.
In addition to uniform partition (UD), two widely used range discretization strategies, <em id="A4.SS1.p1.2.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="A4.SS1.p1.2.2" class="ltx_text"></span>, spacing-increasing discretization <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> (SID) and linear-increasing discretization <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> (LID), are also studied.
SID (increasing bin sizes in log space) is defined as</p>
<table id="A4.E14" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A4.E14.m1.3" class="ltx_Math" alttext="r_{i}=e^{log(r_{min})}+\frac{log(r_{max}/r_{min})\cdot i}{N_{r}}," display="block"><semantics id="A4.E14.m1.3a"><mrow id="A4.E14.m1.3.3.1" xref="A4.E14.m1.3.3.1.1.cmml"><mrow id="A4.E14.m1.3.3.1.1" xref="A4.E14.m1.3.3.1.1.cmml"><msub id="A4.E14.m1.3.3.1.1.2" xref="A4.E14.m1.3.3.1.1.2.cmml"><mi id="A4.E14.m1.3.3.1.1.2.2" xref="A4.E14.m1.3.3.1.1.2.2.cmml">r</mi><mi id="A4.E14.m1.3.3.1.1.2.3" xref="A4.E14.m1.3.3.1.1.2.3.cmml">i</mi></msub><mo id="A4.E14.m1.3.3.1.1.1" xref="A4.E14.m1.3.3.1.1.1.cmml">=</mo><mrow id="A4.E14.m1.3.3.1.1.3" xref="A4.E14.m1.3.3.1.1.3.cmml"><msup id="A4.E14.m1.3.3.1.1.3.2" xref="A4.E14.m1.3.3.1.1.3.2.cmml"><mi id="A4.E14.m1.3.3.1.1.3.2.2" xref="A4.E14.m1.3.3.1.1.3.2.2.cmml">e</mi><mrow id="A4.E14.m1.1.1.1" xref="A4.E14.m1.1.1.1.cmml"><mi id="A4.E14.m1.1.1.1.3" xref="A4.E14.m1.1.1.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="A4.E14.m1.1.1.1.2" xref="A4.E14.m1.1.1.1.2.cmml">​</mo><mi id="A4.E14.m1.1.1.1.4" xref="A4.E14.m1.1.1.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="A4.E14.m1.1.1.1.2a" xref="A4.E14.m1.1.1.1.2.cmml">​</mo><mi id="A4.E14.m1.1.1.1.5" xref="A4.E14.m1.1.1.1.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="A4.E14.m1.1.1.1.2b" xref="A4.E14.m1.1.1.1.2.cmml">​</mo><mrow id="A4.E14.m1.1.1.1.1.1" xref="A4.E14.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A4.E14.m1.1.1.1.1.1.2" xref="A4.E14.m1.1.1.1.1.1.1.cmml">(</mo><msub id="A4.E14.m1.1.1.1.1.1.1" xref="A4.E14.m1.1.1.1.1.1.1.cmml"><mi id="A4.E14.m1.1.1.1.1.1.1.2" xref="A4.E14.m1.1.1.1.1.1.1.2.cmml">r</mi><mrow id="A4.E14.m1.1.1.1.1.1.1.3" xref="A4.E14.m1.1.1.1.1.1.1.3.cmml"><mi id="A4.E14.m1.1.1.1.1.1.1.3.2" xref="A4.E14.m1.1.1.1.1.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="A4.E14.m1.1.1.1.1.1.1.3.1" xref="A4.E14.m1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="A4.E14.m1.1.1.1.1.1.1.3.3" xref="A4.E14.m1.1.1.1.1.1.1.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="A4.E14.m1.1.1.1.1.1.1.3.1a" xref="A4.E14.m1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="A4.E14.m1.1.1.1.1.1.1.3.4" xref="A4.E14.m1.1.1.1.1.1.1.3.4.cmml">n</mi></mrow></msub><mo stretchy="false" id="A4.E14.m1.1.1.1.1.1.3" xref="A4.E14.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msup><mo id="A4.E14.m1.3.3.1.1.3.1" xref="A4.E14.m1.3.3.1.1.3.1.cmml">+</mo><mfrac id="A4.E14.m1.2.2" xref="A4.E14.m1.2.2.cmml"><mrow id="A4.E14.m1.2.2.1" xref="A4.E14.m1.2.2.1.cmml"><mrow id="A4.E14.m1.2.2.1.1" xref="A4.E14.m1.2.2.1.1.cmml"><mi id="A4.E14.m1.2.2.1.1.3" xref="A4.E14.m1.2.2.1.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="A4.E14.m1.2.2.1.1.2" xref="A4.E14.m1.2.2.1.1.2.cmml">​</mo><mi id="A4.E14.m1.2.2.1.1.4" xref="A4.E14.m1.2.2.1.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="A4.E14.m1.2.2.1.1.2a" xref="A4.E14.m1.2.2.1.1.2.cmml">​</mo><mi id="A4.E14.m1.2.2.1.1.5" xref="A4.E14.m1.2.2.1.1.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="A4.E14.m1.2.2.1.1.2b" xref="A4.E14.m1.2.2.1.1.2.cmml">​</mo><mrow id="A4.E14.m1.2.2.1.1.1.1" xref="A4.E14.m1.2.2.1.1.1.1.1.cmml"><mo stretchy="false" id="A4.E14.m1.2.2.1.1.1.1.2" xref="A4.E14.m1.2.2.1.1.1.1.1.cmml">(</mo><mrow id="A4.E14.m1.2.2.1.1.1.1.1" xref="A4.E14.m1.2.2.1.1.1.1.1.cmml"><msub id="A4.E14.m1.2.2.1.1.1.1.1.2" xref="A4.E14.m1.2.2.1.1.1.1.1.2.cmml"><mi id="A4.E14.m1.2.2.1.1.1.1.1.2.2" xref="A4.E14.m1.2.2.1.1.1.1.1.2.2.cmml">r</mi><mrow id="A4.E14.m1.2.2.1.1.1.1.1.2.3" xref="A4.E14.m1.2.2.1.1.1.1.1.2.3.cmml"><mi id="A4.E14.m1.2.2.1.1.1.1.1.2.3.2" xref="A4.E14.m1.2.2.1.1.1.1.1.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="A4.E14.m1.2.2.1.1.1.1.1.2.3.1" xref="A4.E14.m1.2.2.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="A4.E14.m1.2.2.1.1.1.1.1.2.3.3" xref="A4.E14.m1.2.2.1.1.1.1.1.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="A4.E14.m1.2.2.1.1.1.1.1.2.3.1a" xref="A4.E14.m1.2.2.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="A4.E14.m1.2.2.1.1.1.1.1.2.3.4" xref="A4.E14.m1.2.2.1.1.1.1.1.2.3.4.cmml">x</mi></mrow></msub><mo id="A4.E14.m1.2.2.1.1.1.1.1.1" xref="A4.E14.m1.2.2.1.1.1.1.1.1.cmml">/</mo><msub id="A4.E14.m1.2.2.1.1.1.1.1.3" xref="A4.E14.m1.2.2.1.1.1.1.1.3.cmml"><mi id="A4.E14.m1.2.2.1.1.1.1.1.3.2" xref="A4.E14.m1.2.2.1.1.1.1.1.3.2.cmml">r</mi><mrow id="A4.E14.m1.2.2.1.1.1.1.1.3.3" xref="A4.E14.m1.2.2.1.1.1.1.1.3.3.cmml"><mi id="A4.E14.m1.2.2.1.1.1.1.1.3.3.2" xref="A4.E14.m1.2.2.1.1.1.1.1.3.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="A4.E14.m1.2.2.1.1.1.1.1.3.3.1" xref="A4.E14.m1.2.2.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="A4.E14.m1.2.2.1.1.1.1.1.3.3.3" xref="A4.E14.m1.2.2.1.1.1.1.1.3.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="A4.E14.m1.2.2.1.1.1.1.1.3.3.1a" xref="A4.E14.m1.2.2.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="A4.E14.m1.2.2.1.1.1.1.1.3.3.4" xref="A4.E14.m1.2.2.1.1.1.1.1.3.3.4.cmml">n</mi></mrow></msub></mrow><mo rspace="0.055em" stretchy="false" id="A4.E14.m1.2.2.1.1.1.1.3" xref="A4.E14.m1.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="A4.E14.m1.2.2.1.2" xref="A4.E14.m1.2.2.1.2.cmml">⋅</mo><mi id="A4.E14.m1.2.2.1.3" xref="A4.E14.m1.2.2.1.3.cmml">i</mi></mrow><msub id="A4.E14.m1.2.2.3" xref="A4.E14.m1.2.2.3.cmml"><mi id="A4.E14.m1.2.2.3.2" xref="A4.E14.m1.2.2.3.2.cmml">N</mi><mi id="A4.E14.m1.2.2.3.3" xref="A4.E14.m1.2.2.3.3.cmml">r</mi></msub></mfrac></mrow></mrow><mo id="A4.E14.m1.3.3.1.2" xref="A4.E14.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.E14.m1.3b"><apply id="A4.E14.m1.3.3.1.1.cmml" xref="A4.E14.m1.3.3.1"><eq id="A4.E14.m1.3.3.1.1.1.cmml" xref="A4.E14.m1.3.3.1.1.1"></eq><apply id="A4.E14.m1.3.3.1.1.2.cmml" xref="A4.E14.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="A4.E14.m1.3.3.1.1.2.1.cmml" xref="A4.E14.m1.3.3.1.1.2">subscript</csymbol><ci id="A4.E14.m1.3.3.1.1.2.2.cmml" xref="A4.E14.m1.3.3.1.1.2.2">𝑟</ci><ci id="A4.E14.m1.3.3.1.1.2.3.cmml" xref="A4.E14.m1.3.3.1.1.2.3">𝑖</ci></apply><apply id="A4.E14.m1.3.3.1.1.3.cmml" xref="A4.E14.m1.3.3.1.1.3"><plus id="A4.E14.m1.3.3.1.1.3.1.cmml" xref="A4.E14.m1.3.3.1.1.3.1"></plus><apply id="A4.E14.m1.3.3.1.1.3.2.cmml" xref="A4.E14.m1.3.3.1.1.3.2"><csymbol cd="ambiguous" id="A4.E14.m1.3.3.1.1.3.2.1.cmml" xref="A4.E14.m1.3.3.1.1.3.2">superscript</csymbol><ci id="A4.E14.m1.3.3.1.1.3.2.2.cmml" xref="A4.E14.m1.3.3.1.1.3.2.2">𝑒</ci><apply id="A4.E14.m1.1.1.1.cmml" xref="A4.E14.m1.1.1.1"><times id="A4.E14.m1.1.1.1.2.cmml" xref="A4.E14.m1.1.1.1.2"></times><ci id="A4.E14.m1.1.1.1.3.cmml" xref="A4.E14.m1.1.1.1.3">𝑙</ci><ci id="A4.E14.m1.1.1.1.4.cmml" xref="A4.E14.m1.1.1.1.4">𝑜</ci><ci id="A4.E14.m1.1.1.1.5.cmml" xref="A4.E14.m1.1.1.1.5">𝑔</ci><apply id="A4.E14.m1.1.1.1.1.1.1.cmml" xref="A4.E14.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.E14.m1.1.1.1.1.1.1.1.cmml" xref="A4.E14.m1.1.1.1.1.1">subscript</csymbol><ci id="A4.E14.m1.1.1.1.1.1.1.2.cmml" xref="A4.E14.m1.1.1.1.1.1.1.2">𝑟</ci><apply id="A4.E14.m1.1.1.1.1.1.1.3.cmml" xref="A4.E14.m1.1.1.1.1.1.1.3"><times id="A4.E14.m1.1.1.1.1.1.1.3.1.cmml" xref="A4.E14.m1.1.1.1.1.1.1.3.1"></times><ci id="A4.E14.m1.1.1.1.1.1.1.3.2.cmml" xref="A4.E14.m1.1.1.1.1.1.1.3.2">𝑚</ci><ci id="A4.E14.m1.1.1.1.1.1.1.3.3.cmml" xref="A4.E14.m1.1.1.1.1.1.1.3.3">𝑖</ci><ci id="A4.E14.m1.1.1.1.1.1.1.3.4.cmml" xref="A4.E14.m1.1.1.1.1.1.1.3.4">𝑛</ci></apply></apply></apply></apply><apply id="A4.E14.m1.2.2.cmml" xref="A4.E14.m1.2.2"><divide id="A4.E14.m1.2.2.2.cmml" xref="A4.E14.m1.2.2"></divide><apply id="A4.E14.m1.2.2.1.cmml" xref="A4.E14.m1.2.2.1"><ci id="A4.E14.m1.2.2.1.2.cmml" xref="A4.E14.m1.2.2.1.2">⋅</ci><apply id="A4.E14.m1.2.2.1.1.cmml" xref="A4.E14.m1.2.2.1.1"><times id="A4.E14.m1.2.2.1.1.2.cmml" xref="A4.E14.m1.2.2.1.1.2"></times><ci id="A4.E14.m1.2.2.1.1.3.cmml" xref="A4.E14.m1.2.2.1.1.3">𝑙</ci><ci id="A4.E14.m1.2.2.1.1.4.cmml" xref="A4.E14.m1.2.2.1.1.4">𝑜</ci><ci id="A4.E14.m1.2.2.1.1.5.cmml" xref="A4.E14.m1.2.2.1.1.5">𝑔</ci><apply id="A4.E14.m1.2.2.1.1.1.1.1.cmml" xref="A4.E14.m1.2.2.1.1.1.1"><divide id="A4.E14.m1.2.2.1.1.1.1.1.1.cmml" xref="A4.E14.m1.2.2.1.1.1.1.1.1"></divide><apply id="A4.E14.m1.2.2.1.1.1.1.1.2.cmml" xref="A4.E14.m1.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A4.E14.m1.2.2.1.1.1.1.1.2.1.cmml" xref="A4.E14.m1.2.2.1.1.1.1.1.2">subscript</csymbol><ci id="A4.E14.m1.2.2.1.1.1.1.1.2.2.cmml" xref="A4.E14.m1.2.2.1.1.1.1.1.2.2">𝑟</ci><apply id="A4.E14.m1.2.2.1.1.1.1.1.2.3.cmml" xref="A4.E14.m1.2.2.1.1.1.1.1.2.3"><times id="A4.E14.m1.2.2.1.1.1.1.1.2.3.1.cmml" xref="A4.E14.m1.2.2.1.1.1.1.1.2.3.1"></times><ci id="A4.E14.m1.2.2.1.1.1.1.1.2.3.2.cmml" xref="A4.E14.m1.2.2.1.1.1.1.1.2.3.2">𝑚</ci><ci id="A4.E14.m1.2.2.1.1.1.1.1.2.3.3.cmml" xref="A4.E14.m1.2.2.1.1.1.1.1.2.3.3">𝑎</ci><ci id="A4.E14.m1.2.2.1.1.1.1.1.2.3.4.cmml" xref="A4.E14.m1.2.2.1.1.1.1.1.2.3.4">𝑥</ci></apply></apply><apply id="A4.E14.m1.2.2.1.1.1.1.1.3.cmml" xref="A4.E14.m1.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A4.E14.m1.2.2.1.1.1.1.1.3.1.cmml" xref="A4.E14.m1.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="A4.E14.m1.2.2.1.1.1.1.1.3.2.cmml" xref="A4.E14.m1.2.2.1.1.1.1.1.3.2">𝑟</ci><apply id="A4.E14.m1.2.2.1.1.1.1.1.3.3.cmml" xref="A4.E14.m1.2.2.1.1.1.1.1.3.3"><times id="A4.E14.m1.2.2.1.1.1.1.1.3.3.1.cmml" xref="A4.E14.m1.2.2.1.1.1.1.1.3.3.1"></times><ci id="A4.E14.m1.2.2.1.1.1.1.1.3.3.2.cmml" xref="A4.E14.m1.2.2.1.1.1.1.1.3.3.2">𝑚</ci><ci id="A4.E14.m1.2.2.1.1.1.1.1.3.3.3.cmml" xref="A4.E14.m1.2.2.1.1.1.1.1.3.3.3">𝑖</ci><ci id="A4.E14.m1.2.2.1.1.1.1.1.3.3.4.cmml" xref="A4.E14.m1.2.2.1.1.1.1.1.3.3.4">𝑛</ci></apply></apply></apply></apply><ci id="A4.E14.m1.2.2.1.3.cmml" xref="A4.E14.m1.2.2.1.3">𝑖</ci></apply><apply id="A4.E14.m1.2.2.3.cmml" xref="A4.E14.m1.2.2.3"><csymbol cd="ambiguous" id="A4.E14.m1.2.2.3.1.cmml" xref="A4.E14.m1.2.2.3">subscript</csymbol><ci id="A4.E14.m1.2.2.3.2.cmml" xref="A4.E14.m1.2.2.3.2">𝑁</ci><ci id="A4.E14.m1.2.2.3.3.cmml" xref="A4.E14.m1.2.2.3.3">𝑟</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.E14.m1.3c">r_{i}=e^{log(r_{min})}+\frac{log(r_{max}/r_{min})\cdot i}{N_{r}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p id="A4.SS1.p1.7" class="ltx_p">while LID is defined as:</p>
<table id="A4.E15" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A4.E15.m1.2" class="ltx_Math" alttext="r_{i}=r_{min}+\frac{r_{max}-r_{min}}{N_{r}(N_{r}+1)}\cdot i(i+1)," display="block"><semantics id="A4.E15.m1.2a"><mrow id="A4.E15.m1.2.2.1" xref="A4.E15.m1.2.2.1.1.cmml"><mrow id="A4.E15.m1.2.2.1.1" xref="A4.E15.m1.2.2.1.1.cmml"><msub id="A4.E15.m1.2.2.1.1.3" xref="A4.E15.m1.2.2.1.1.3.cmml"><mi id="A4.E15.m1.2.2.1.1.3.2" xref="A4.E15.m1.2.2.1.1.3.2.cmml">r</mi><mi id="A4.E15.m1.2.2.1.1.3.3" xref="A4.E15.m1.2.2.1.1.3.3.cmml">i</mi></msub><mo id="A4.E15.m1.2.2.1.1.2" xref="A4.E15.m1.2.2.1.1.2.cmml">=</mo><mrow id="A4.E15.m1.2.2.1.1.1" xref="A4.E15.m1.2.2.1.1.1.cmml"><msub id="A4.E15.m1.2.2.1.1.1.3" xref="A4.E15.m1.2.2.1.1.1.3.cmml"><mi id="A4.E15.m1.2.2.1.1.1.3.2" xref="A4.E15.m1.2.2.1.1.1.3.2.cmml">r</mi><mrow id="A4.E15.m1.2.2.1.1.1.3.3" xref="A4.E15.m1.2.2.1.1.1.3.3.cmml"><mi id="A4.E15.m1.2.2.1.1.1.3.3.2" xref="A4.E15.m1.2.2.1.1.1.3.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="A4.E15.m1.2.2.1.1.1.3.3.1" xref="A4.E15.m1.2.2.1.1.1.3.3.1.cmml">​</mo><mi id="A4.E15.m1.2.2.1.1.1.3.3.3" xref="A4.E15.m1.2.2.1.1.1.3.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="A4.E15.m1.2.2.1.1.1.3.3.1a" xref="A4.E15.m1.2.2.1.1.1.3.3.1.cmml">​</mo><mi id="A4.E15.m1.2.2.1.1.1.3.3.4" xref="A4.E15.m1.2.2.1.1.1.3.3.4.cmml">n</mi></mrow></msub><mo id="A4.E15.m1.2.2.1.1.1.2" xref="A4.E15.m1.2.2.1.1.1.2.cmml">+</mo><mrow id="A4.E15.m1.2.2.1.1.1.1" xref="A4.E15.m1.2.2.1.1.1.1.cmml"><mrow id="A4.E15.m1.2.2.1.1.1.1.3" xref="A4.E15.m1.2.2.1.1.1.1.3.cmml"><mfrac id="A4.E15.m1.1.1" xref="A4.E15.m1.1.1.cmml"><mrow id="A4.E15.m1.1.1.3" xref="A4.E15.m1.1.1.3.cmml"><msub id="A4.E15.m1.1.1.3.2" xref="A4.E15.m1.1.1.3.2.cmml"><mi id="A4.E15.m1.1.1.3.2.2" xref="A4.E15.m1.1.1.3.2.2.cmml">r</mi><mrow id="A4.E15.m1.1.1.3.2.3" xref="A4.E15.m1.1.1.3.2.3.cmml"><mi id="A4.E15.m1.1.1.3.2.3.2" xref="A4.E15.m1.1.1.3.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="A4.E15.m1.1.1.3.2.3.1" xref="A4.E15.m1.1.1.3.2.3.1.cmml">​</mo><mi id="A4.E15.m1.1.1.3.2.3.3" xref="A4.E15.m1.1.1.3.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="A4.E15.m1.1.1.3.2.3.1a" xref="A4.E15.m1.1.1.3.2.3.1.cmml">​</mo><mi id="A4.E15.m1.1.1.3.2.3.4" xref="A4.E15.m1.1.1.3.2.3.4.cmml">x</mi></mrow></msub><mo id="A4.E15.m1.1.1.3.1" xref="A4.E15.m1.1.1.3.1.cmml">−</mo><msub id="A4.E15.m1.1.1.3.3" xref="A4.E15.m1.1.1.3.3.cmml"><mi id="A4.E15.m1.1.1.3.3.2" xref="A4.E15.m1.1.1.3.3.2.cmml">r</mi><mrow id="A4.E15.m1.1.1.3.3.3" xref="A4.E15.m1.1.1.3.3.3.cmml"><mi id="A4.E15.m1.1.1.3.3.3.2" xref="A4.E15.m1.1.1.3.3.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="A4.E15.m1.1.1.3.3.3.1" xref="A4.E15.m1.1.1.3.3.3.1.cmml">​</mo><mi id="A4.E15.m1.1.1.3.3.3.3" xref="A4.E15.m1.1.1.3.3.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="A4.E15.m1.1.1.3.3.3.1a" xref="A4.E15.m1.1.1.3.3.3.1.cmml">​</mo><mi id="A4.E15.m1.1.1.3.3.3.4" xref="A4.E15.m1.1.1.3.3.3.4.cmml">n</mi></mrow></msub></mrow><mrow id="A4.E15.m1.1.1.1" xref="A4.E15.m1.1.1.1.cmml"><msub id="A4.E15.m1.1.1.1.3" xref="A4.E15.m1.1.1.1.3.cmml"><mi id="A4.E15.m1.1.1.1.3.2" xref="A4.E15.m1.1.1.1.3.2.cmml">N</mi><mi id="A4.E15.m1.1.1.1.3.3" xref="A4.E15.m1.1.1.1.3.3.cmml">r</mi></msub><mo lspace="0em" rspace="0em" id="A4.E15.m1.1.1.1.2" xref="A4.E15.m1.1.1.1.2.cmml">​</mo><mrow id="A4.E15.m1.1.1.1.1.1" xref="A4.E15.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A4.E15.m1.1.1.1.1.1.2" xref="A4.E15.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="A4.E15.m1.1.1.1.1.1.1" xref="A4.E15.m1.1.1.1.1.1.1.cmml"><msub id="A4.E15.m1.1.1.1.1.1.1.2" xref="A4.E15.m1.1.1.1.1.1.1.2.cmml"><mi id="A4.E15.m1.1.1.1.1.1.1.2.2" xref="A4.E15.m1.1.1.1.1.1.1.2.2.cmml">N</mi><mi id="A4.E15.m1.1.1.1.1.1.1.2.3" xref="A4.E15.m1.1.1.1.1.1.1.2.3.cmml">r</mi></msub><mo id="A4.E15.m1.1.1.1.1.1.1.1" xref="A4.E15.m1.1.1.1.1.1.1.1.cmml">+</mo><mn id="A4.E15.m1.1.1.1.1.1.1.3" xref="A4.E15.m1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="A4.E15.m1.1.1.1.1.1.3" xref="A4.E15.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mfrac><mo lspace="0.222em" rspace="0.222em" id="A4.E15.m1.2.2.1.1.1.1.3.1" xref="A4.E15.m1.2.2.1.1.1.1.3.1.cmml">⋅</mo><mi id="A4.E15.m1.2.2.1.1.1.1.3.2" xref="A4.E15.m1.2.2.1.1.1.1.3.2.cmml">i</mi></mrow><mo lspace="0em" rspace="0em" id="A4.E15.m1.2.2.1.1.1.1.2" xref="A4.E15.m1.2.2.1.1.1.1.2.cmml">​</mo><mrow id="A4.E15.m1.2.2.1.1.1.1.1.1" xref="A4.E15.m1.2.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A4.E15.m1.2.2.1.1.1.1.1.1.2" xref="A4.E15.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A4.E15.m1.2.2.1.1.1.1.1.1.1" xref="A4.E15.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="A4.E15.m1.2.2.1.1.1.1.1.1.1.2" xref="A4.E15.m1.2.2.1.1.1.1.1.1.1.2.cmml">i</mi><mo id="A4.E15.m1.2.2.1.1.1.1.1.1.1.1" xref="A4.E15.m1.2.2.1.1.1.1.1.1.1.1.cmml">+</mo><mn id="A4.E15.m1.2.2.1.1.1.1.1.1.1.3" xref="A4.E15.m1.2.2.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="A4.E15.m1.2.2.1.1.1.1.1.1.3" xref="A4.E15.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A4.E15.m1.2.2.1.2" xref="A4.E15.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.E15.m1.2b"><apply id="A4.E15.m1.2.2.1.1.cmml" xref="A4.E15.m1.2.2.1"><eq id="A4.E15.m1.2.2.1.1.2.cmml" xref="A4.E15.m1.2.2.1.1.2"></eq><apply id="A4.E15.m1.2.2.1.1.3.cmml" xref="A4.E15.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="A4.E15.m1.2.2.1.1.3.1.cmml" xref="A4.E15.m1.2.2.1.1.3">subscript</csymbol><ci id="A4.E15.m1.2.2.1.1.3.2.cmml" xref="A4.E15.m1.2.2.1.1.3.2">𝑟</ci><ci id="A4.E15.m1.2.2.1.1.3.3.cmml" xref="A4.E15.m1.2.2.1.1.3.3">𝑖</ci></apply><apply id="A4.E15.m1.2.2.1.1.1.cmml" xref="A4.E15.m1.2.2.1.1.1"><plus id="A4.E15.m1.2.2.1.1.1.2.cmml" xref="A4.E15.m1.2.2.1.1.1.2"></plus><apply id="A4.E15.m1.2.2.1.1.1.3.cmml" xref="A4.E15.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="A4.E15.m1.2.2.1.1.1.3.1.cmml" xref="A4.E15.m1.2.2.1.1.1.3">subscript</csymbol><ci id="A4.E15.m1.2.2.1.1.1.3.2.cmml" xref="A4.E15.m1.2.2.1.1.1.3.2">𝑟</ci><apply id="A4.E15.m1.2.2.1.1.1.3.3.cmml" xref="A4.E15.m1.2.2.1.1.1.3.3"><times id="A4.E15.m1.2.2.1.1.1.3.3.1.cmml" xref="A4.E15.m1.2.2.1.1.1.3.3.1"></times><ci id="A4.E15.m1.2.2.1.1.1.3.3.2.cmml" xref="A4.E15.m1.2.2.1.1.1.3.3.2">𝑚</ci><ci id="A4.E15.m1.2.2.1.1.1.3.3.3.cmml" xref="A4.E15.m1.2.2.1.1.1.3.3.3">𝑖</ci><ci id="A4.E15.m1.2.2.1.1.1.3.3.4.cmml" xref="A4.E15.m1.2.2.1.1.1.3.3.4">𝑛</ci></apply></apply><apply id="A4.E15.m1.2.2.1.1.1.1.cmml" xref="A4.E15.m1.2.2.1.1.1.1"><times id="A4.E15.m1.2.2.1.1.1.1.2.cmml" xref="A4.E15.m1.2.2.1.1.1.1.2"></times><apply id="A4.E15.m1.2.2.1.1.1.1.3.cmml" xref="A4.E15.m1.2.2.1.1.1.1.3"><ci id="A4.E15.m1.2.2.1.1.1.1.3.1.cmml" xref="A4.E15.m1.2.2.1.1.1.1.3.1">⋅</ci><apply id="A4.E15.m1.1.1.cmml" xref="A4.E15.m1.1.1"><divide id="A4.E15.m1.1.1.2.cmml" xref="A4.E15.m1.1.1"></divide><apply id="A4.E15.m1.1.1.3.cmml" xref="A4.E15.m1.1.1.3"><minus id="A4.E15.m1.1.1.3.1.cmml" xref="A4.E15.m1.1.1.3.1"></minus><apply id="A4.E15.m1.1.1.3.2.cmml" xref="A4.E15.m1.1.1.3.2"><csymbol cd="ambiguous" id="A4.E15.m1.1.1.3.2.1.cmml" xref="A4.E15.m1.1.1.3.2">subscript</csymbol><ci id="A4.E15.m1.1.1.3.2.2.cmml" xref="A4.E15.m1.1.1.3.2.2">𝑟</ci><apply id="A4.E15.m1.1.1.3.2.3.cmml" xref="A4.E15.m1.1.1.3.2.3"><times id="A4.E15.m1.1.1.3.2.3.1.cmml" xref="A4.E15.m1.1.1.3.2.3.1"></times><ci id="A4.E15.m1.1.1.3.2.3.2.cmml" xref="A4.E15.m1.1.1.3.2.3.2">𝑚</ci><ci id="A4.E15.m1.1.1.3.2.3.3.cmml" xref="A4.E15.m1.1.1.3.2.3.3">𝑎</ci><ci id="A4.E15.m1.1.1.3.2.3.4.cmml" xref="A4.E15.m1.1.1.3.2.3.4">𝑥</ci></apply></apply><apply id="A4.E15.m1.1.1.3.3.cmml" xref="A4.E15.m1.1.1.3.3"><csymbol cd="ambiguous" id="A4.E15.m1.1.1.3.3.1.cmml" xref="A4.E15.m1.1.1.3.3">subscript</csymbol><ci id="A4.E15.m1.1.1.3.3.2.cmml" xref="A4.E15.m1.1.1.3.3.2">𝑟</ci><apply id="A4.E15.m1.1.1.3.3.3.cmml" xref="A4.E15.m1.1.1.3.3.3"><times id="A4.E15.m1.1.1.3.3.3.1.cmml" xref="A4.E15.m1.1.1.3.3.3.1"></times><ci id="A4.E15.m1.1.1.3.3.3.2.cmml" xref="A4.E15.m1.1.1.3.3.3.2">𝑚</ci><ci id="A4.E15.m1.1.1.3.3.3.3.cmml" xref="A4.E15.m1.1.1.3.3.3.3">𝑖</ci><ci id="A4.E15.m1.1.1.3.3.3.4.cmml" xref="A4.E15.m1.1.1.3.3.3.4">𝑛</ci></apply></apply></apply><apply id="A4.E15.m1.1.1.1.cmml" xref="A4.E15.m1.1.1.1"><times id="A4.E15.m1.1.1.1.2.cmml" xref="A4.E15.m1.1.1.1.2"></times><apply id="A4.E15.m1.1.1.1.3.cmml" xref="A4.E15.m1.1.1.1.3"><csymbol cd="ambiguous" id="A4.E15.m1.1.1.1.3.1.cmml" xref="A4.E15.m1.1.1.1.3">subscript</csymbol><ci id="A4.E15.m1.1.1.1.3.2.cmml" xref="A4.E15.m1.1.1.1.3.2">𝑁</ci><ci id="A4.E15.m1.1.1.1.3.3.cmml" xref="A4.E15.m1.1.1.1.3.3">𝑟</ci></apply><apply id="A4.E15.m1.1.1.1.1.1.1.cmml" xref="A4.E15.m1.1.1.1.1.1"><plus id="A4.E15.m1.1.1.1.1.1.1.1.cmml" xref="A4.E15.m1.1.1.1.1.1.1.1"></plus><apply id="A4.E15.m1.1.1.1.1.1.1.2.cmml" xref="A4.E15.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A4.E15.m1.1.1.1.1.1.1.2.1.cmml" xref="A4.E15.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A4.E15.m1.1.1.1.1.1.1.2.2.cmml" xref="A4.E15.m1.1.1.1.1.1.1.2.2">𝑁</ci><ci id="A4.E15.m1.1.1.1.1.1.1.2.3.cmml" xref="A4.E15.m1.1.1.1.1.1.1.2.3">𝑟</ci></apply><cn type="integer" id="A4.E15.m1.1.1.1.1.1.1.3.cmml" xref="A4.E15.m1.1.1.1.1.1.1.3">1</cn></apply></apply></apply><ci id="A4.E15.m1.2.2.1.1.1.1.3.2.cmml" xref="A4.E15.m1.2.2.1.1.1.1.3.2">𝑖</ci></apply><apply id="A4.E15.m1.2.2.1.1.1.1.1.1.1.cmml" xref="A4.E15.m1.2.2.1.1.1.1.1.1"><plus id="A4.E15.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="A4.E15.m1.2.2.1.1.1.1.1.1.1.1"></plus><ci id="A4.E15.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="A4.E15.m1.2.2.1.1.1.1.1.1.1.2">𝑖</ci><cn type="integer" id="A4.E15.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="A4.E15.m1.2.2.1.1.1.1.1.1.1.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.E15.m1.2c">r_{i}=r_{min}+\frac{r_{max}-r_{min}}{N_{r}(N_{r}+1)}\cdot i(i+1),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
<p id="A4.SS1.p1.6" class="ltx_p">where <math id="A4.SS1.p1.3.m1.1" class="ltx_Math" alttext="r_{i}" display="inline"><semantics id="A4.SS1.p1.3.m1.1a"><msub id="A4.SS1.p1.3.m1.1.1" xref="A4.SS1.p1.3.m1.1.1.cmml"><mi id="A4.SS1.p1.3.m1.1.1.2" xref="A4.SS1.p1.3.m1.1.1.2.cmml">r</mi><mi id="A4.SS1.p1.3.m1.1.1.3" xref="A4.SS1.p1.3.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A4.SS1.p1.3.m1.1b"><apply id="A4.SS1.p1.3.m1.1.1.cmml" xref="A4.SS1.p1.3.m1.1.1"><csymbol cd="ambiguous" id="A4.SS1.p1.3.m1.1.1.1.cmml" xref="A4.SS1.p1.3.m1.1.1">subscript</csymbol><ci id="A4.SS1.p1.3.m1.1.1.2.cmml" xref="A4.SS1.p1.3.m1.1.1.2">𝑟</ci><ci id="A4.SS1.p1.3.m1.1.1.3.cmml" xref="A4.SS1.p1.3.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p1.3.m1.1c">r_{i}</annotation></semantics></math> is the range value of the i-th range grid index, [<math id="A4.SS1.p1.4.m2.1" class="ltx_Math" alttext="r_{min}" display="inline"><semantics id="A4.SS1.p1.4.m2.1a"><msub id="A4.SS1.p1.4.m2.1.1" xref="A4.SS1.p1.4.m2.1.1.cmml"><mi id="A4.SS1.p1.4.m2.1.1.2" xref="A4.SS1.p1.4.m2.1.1.2.cmml">r</mi><mrow id="A4.SS1.p1.4.m2.1.1.3" xref="A4.SS1.p1.4.m2.1.1.3.cmml"><mi id="A4.SS1.p1.4.m2.1.1.3.2" xref="A4.SS1.p1.4.m2.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="A4.SS1.p1.4.m2.1.1.3.1" xref="A4.SS1.p1.4.m2.1.1.3.1.cmml">​</mo><mi id="A4.SS1.p1.4.m2.1.1.3.3" xref="A4.SS1.p1.4.m2.1.1.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="A4.SS1.p1.4.m2.1.1.3.1a" xref="A4.SS1.p1.4.m2.1.1.3.1.cmml">​</mo><mi id="A4.SS1.p1.4.m2.1.1.3.4" xref="A4.SS1.p1.4.m2.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A4.SS1.p1.4.m2.1b"><apply id="A4.SS1.p1.4.m2.1.1.cmml" xref="A4.SS1.p1.4.m2.1.1"><csymbol cd="ambiguous" id="A4.SS1.p1.4.m2.1.1.1.cmml" xref="A4.SS1.p1.4.m2.1.1">subscript</csymbol><ci id="A4.SS1.p1.4.m2.1.1.2.cmml" xref="A4.SS1.p1.4.m2.1.1.2">𝑟</ci><apply id="A4.SS1.p1.4.m2.1.1.3.cmml" xref="A4.SS1.p1.4.m2.1.1.3"><times id="A4.SS1.p1.4.m2.1.1.3.1.cmml" xref="A4.SS1.p1.4.m2.1.1.3.1"></times><ci id="A4.SS1.p1.4.m2.1.1.3.2.cmml" xref="A4.SS1.p1.4.m2.1.1.3.2">𝑚</ci><ci id="A4.SS1.p1.4.m2.1.1.3.3.cmml" xref="A4.SS1.p1.4.m2.1.1.3.3">𝑖</ci><ci id="A4.SS1.p1.4.m2.1.1.3.4.cmml" xref="A4.SS1.p1.4.m2.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p1.4.m2.1c">r_{min}</annotation></semantics></math>, <math id="A4.SS1.p1.5.m3.1" class="ltx_Math" alttext="r_{max}" display="inline"><semantics id="A4.SS1.p1.5.m3.1a"><msub id="A4.SS1.p1.5.m3.1.1" xref="A4.SS1.p1.5.m3.1.1.cmml"><mi id="A4.SS1.p1.5.m3.1.1.2" xref="A4.SS1.p1.5.m3.1.1.2.cmml">r</mi><mrow id="A4.SS1.p1.5.m3.1.1.3" xref="A4.SS1.p1.5.m3.1.1.3.cmml"><mi id="A4.SS1.p1.5.m3.1.1.3.2" xref="A4.SS1.p1.5.m3.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="A4.SS1.p1.5.m3.1.1.3.1" xref="A4.SS1.p1.5.m3.1.1.3.1.cmml">​</mo><mi id="A4.SS1.p1.5.m3.1.1.3.3" xref="A4.SS1.p1.5.m3.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="A4.SS1.p1.5.m3.1.1.3.1a" xref="A4.SS1.p1.5.m3.1.1.3.1.cmml">​</mo><mi id="A4.SS1.p1.5.m3.1.1.3.4" xref="A4.SS1.p1.5.m3.1.1.3.4.cmml">x</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A4.SS1.p1.5.m3.1b"><apply id="A4.SS1.p1.5.m3.1.1.cmml" xref="A4.SS1.p1.5.m3.1.1"><csymbol cd="ambiguous" id="A4.SS1.p1.5.m3.1.1.1.cmml" xref="A4.SS1.p1.5.m3.1.1">subscript</csymbol><ci id="A4.SS1.p1.5.m3.1.1.2.cmml" xref="A4.SS1.p1.5.m3.1.1.2">𝑟</ci><apply id="A4.SS1.p1.5.m3.1.1.3.cmml" xref="A4.SS1.p1.5.m3.1.1.3"><times id="A4.SS1.p1.5.m3.1.1.3.1.cmml" xref="A4.SS1.p1.5.m3.1.1.3.1"></times><ci id="A4.SS1.p1.5.m3.1.1.3.2.cmml" xref="A4.SS1.p1.5.m3.1.1.3.2">𝑚</ci><ci id="A4.SS1.p1.5.m3.1.1.3.3.cmml" xref="A4.SS1.p1.5.m3.1.1.3.3">𝑎</ci><ci id="A4.SS1.p1.5.m3.1.1.3.4.cmml" xref="A4.SS1.p1.5.m3.1.1.3.4">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p1.5.m3.1c">r_{max}</annotation></semantics></math>] is the full range to be discretized, and <math id="A4.SS1.p1.6.m4.1" class="ltx_Math" alttext="N_{r}" display="inline"><semantics id="A4.SS1.p1.6.m4.1a"><msub id="A4.SS1.p1.6.m4.1.1" xref="A4.SS1.p1.6.m4.1.1.cmml"><mi id="A4.SS1.p1.6.m4.1.1.2" xref="A4.SS1.p1.6.m4.1.1.2.cmml">N</mi><mi id="A4.SS1.p1.6.m4.1.1.3" xref="A4.SS1.p1.6.m4.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="A4.SS1.p1.6.m4.1b"><apply id="A4.SS1.p1.6.m4.1.1.cmml" xref="A4.SS1.p1.6.m4.1.1"><csymbol cd="ambiguous" id="A4.SS1.p1.6.m4.1.1.1.cmml" xref="A4.SS1.p1.6.m4.1.1">subscript</csymbol><ci id="A4.SS1.p1.6.m4.1.1.2.cmml" xref="A4.SS1.p1.6.m4.1.1.2">𝑁</ci><ci id="A4.SS1.p1.6.m4.1.1.3.cmml" xref="A4.SS1.p1.6.m4.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p1.6.m4.1c">N_{r}</annotation></semantics></math> is the number of grids along the range axis.
As is shown in Table <a href="#A4.T11" title="Table 11 ‣ D.1 Effects of different partition patterns ‣ Appendix D More ablations ‣ PARTNER: Level up the Polar Representation for LiDAR 3D Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a>, uniform partition obtains the best performance compared to SID and LID, which indicates the spatial distribution of UD is more consistent with that of point clouds.</p>
</div>
<figure id="A4.F8" class="ltx_figure"><img src="/html/2308.03982/assets/x8.png" id="A4.F8.g1" class="ltx_graphics ltx_img_landscape" width="380" height="107" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Visualization of detection performance on ONCE dataset.
The green box denotes the ground truth box.
The red box denotes the predictions.
Best viewed in color.</figcaption>
</figure>
</section>
<section id="A4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.2 </span>Further study on GRR</h3>

<figure id="A4.T12" class="ltx_table">
<div id="A4.T12.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:174.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(60.6pt,-24.4pt) scale(1.38767505055019,1.38767505055019) ;">
<table id="A4.T12.1.1" class="ltx_tabular ltx_align_middle">
<tr id="A4.T12.1.1.1" class="ltx_tr">
<td id="A4.T12.1.1.1.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="A4.T12.1.1.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="A4.T12.1.1.1.1.1.1" class="ltx_p" style="width:91.0pt;"><span id="A4.T12.1.1.1.1.1.1.1" class="ltx_text">Re-alignment</span></span>
</span>
</td>
<td id="A4.T12.1.1.1.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="A4.T12.1.1.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="A4.T12.1.1.1.2.1.1" class="ltx_p" style="width:91.0pt;">Veh. LEVEL 1</span>
</span>
</td>
<td id="A4.T12.1.1.1.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="A4.T12.1.1.1.3.1" class="ltx_inline-block ltx_align_top">
<span id="A4.T12.1.1.1.3.1.1" class="ltx_p" style="width:91.0pt;">Veh. LEVEL 2</span>
</span>
</td>
</tr>
<tr id="A4.T12.1.1.2" class="ltx_tr">
<td id="A4.T12.1.1.2.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="A4.T12.1.1.2.1.1" class="ltx_inline-block ltx_align_top">
<span id="A4.T12.1.1.2.1.1.1" class="ltx_p" style="width:91.0pt;"></span>
</span>
</td>
<td id="A4.T12.1.1.2.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="A4.T12.1.1.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="A4.T12.1.1.2.2.1.1" class="ltx_p" style="width:91.0pt;">mAP/mAPH(%)</span>
</span>
</td>
<td id="A4.T12.1.1.2.3" class="ltx_td ltx_align_justify ltx_align_top" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="A4.T12.1.1.2.3.1" class="ltx_inline-block ltx_align_top">
<span id="A4.T12.1.1.2.3.1.1" class="ltx_p" style="width:91.0pt;">mAP/mAPH(%)</span>
</span>
</td>
</tr>
<tr id="A4.T12.1.1.3" class="ltx_tr">
<td id="A4.T12.1.1.3.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_tt" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="A4.T12.1.1.3.1.1" class="ltx_inline-block ltx_align_top">
<span id="A4.T12.1.1.3.1.1.1" class="ltx_p" style="width:91.0pt;">Baseline</span>
</span>
</td>
<td id="A4.T12.1.1.3.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_tt" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="A4.T12.1.1.3.2.1" class="ltx_inline-block ltx_align_top">
<span id="A4.T12.1.1.3.2.1.1" class="ltx_p" style="width:91.0pt;">73.33/72.63</span>
</span>
</td>
<td id="A4.T12.1.1.3.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_tt" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="A4.T12.1.1.3.3.1" class="ltx_inline-block ltx_align_top">
<span id="A4.T12.1.1.3.3.1.1" class="ltx_p" style="width:91.0pt;">64.83/64.23</span>
</span>
</td>
</tr>
<tr id="A4.T12.1.1.4" class="ltx_tr">
<td id="A4.T12.1.1.4.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="A4.T12.1.1.4.1.1" class="ltx_inline-block ltx_align_top">
<span id="A4.T12.1.1.4.1.1.1" class="ltx_p" style="width:91.0pt;">Axial <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite></span>
</span>
</td>
<td id="A4.T12.1.1.4.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="A4.T12.1.1.4.2.1" class="ltx_inline-block ltx_align_top">
<span id="A4.T12.1.1.4.2.1.1" class="ltx_p" style="width:91.0pt;">73.41/72.72</span>
</span>
</td>
<td id="A4.T12.1.1.4.3" class="ltx_td ltx_align_justify ltx_align_top" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="A4.T12.1.1.4.3.1" class="ltx_inline-block ltx_align_top">
<span id="A4.T12.1.1.4.3.1.1" class="ltx_p" style="width:91.0pt;">64.92/64.33</span>
</span>
</td>
</tr>
<tr id="A4.T12.1.1.5" class="ltx_tr">
<td id="A4.T12.1.1.5.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="A4.T12.1.1.5.1.1" class="ltx_inline-block ltx_align_top">
<span id="A4.T12.1.1.5.1.1.1" class="ltx_p" style="width:91.0pt;">Channel-wise <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite></span>
</span>
</td>
<td id="A4.T12.1.1.5.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="A4.T12.1.1.5.2.1" class="ltx_inline-block ltx_align_top">
<span id="A4.T12.1.1.5.2.1.1" class="ltx_p" style="width:91.0pt;">73.71/73.00</span>
</span>
</td>
<td id="A4.T12.1.1.5.3" class="ltx_td ltx_align_justify ltx_align_top" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="A4.T12.1.1.5.3.1" class="ltx_inline-block ltx_align_top">
<span id="A4.T12.1.1.5.3.1.1" class="ltx_p" style="width:91.0pt;">65.22/64.61</span>
</span>
</td>
</tr>
<tr id="A4.T12.1.1.6" class="ltx_tr">
<td id="A4.T12.1.1.6.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="A4.T12.1.1.6.1.1" class="ltx_inline-block ltx_align_top">
<span id="A4.T12.1.1.6.1.1.1" class="ltx_p" style="width:91.0pt;">Swin <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite></span>
</span>
</td>
<td id="A4.T12.1.1.6.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="A4.T12.1.1.6.2.1" class="ltx_inline-block ltx_align_top">
<span id="A4.T12.1.1.6.2.1.1" class="ltx_p" style="width:91.0pt;">73.62/72.93</span>
</span>
</td>
<td id="A4.T12.1.1.6.3" class="ltx_td ltx_align_justify ltx_align_top" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="A4.T12.1.1.6.3.1" class="ltx_inline-block ltx_align_top">
<span id="A4.T12.1.1.6.3.1.1" class="ltx_p" style="width:91.0pt;">65.13/64.54</span>
</span>
</td>
</tr>
<tr id="A4.T12.1.1.7" class="ltx_tr">
<td id="A4.T12.1.1.7.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="A4.T12.1.1.7.1.1" class="ltx_inline-block ltx_align_top">
<span id="A4.T12.1.1.7.1.1.1" class="ltx_p" style="width:91.0pt;">GRR</span>
</span>
</td>
<td id="A4.T12.1.1.7.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="A4.T12.1.1.7.2.1" class="ltx_inline-block ltx_align_top">
<span id="A4.T12.1.1.7.2.1.1" class="ltx_p" style="width:91.0pt;"><span id="A4.T12.1.1.7.2.1.1.1" class="ltx_text ltx_font_bold">75.35/74.85</span></span>
</span>
</td>
<td id="A4.T12.1.1.7.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="A4.T12.1.1.7.3.1" class="ltx_inline-block ltx_align_top">
<span id="A4.T12.1.1.7.3.1.1" class="ltx_p" style="width:91.0pt;"><span id="A4.T12.1.1.7.3.1.1.1" class="ltx_text ltx_font_bold">67.84/67.35</span></span>
</span>
</td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 12: </span>Comparison of different attention mechanisms in the re-alignment.
We show the 12 epochs results on the Waymo val. set.
</figcaption>
</figure>
<figure id="A4.T13" class="ltx_table">
<div id="A4.T13.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:129.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(66.5pt,-19.9pt) scale(1.44212826085677,1.44212826085677) ;">
<table id="A4.T13.1.1" class="ltx_tabular ltx_align_middle">
<tr id="A4.T13.1.1.1" class="ltx_tr">
<td id="A4.T13.1.1.1.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" style="padding-top:1.5pt;padding-bottom:1.5pt;" rowspan="2"><span id="A4.T13.1.1.1.1.1" class="ltx_text">Coords.</span></td>
<td id="A4.T13.1.1.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:1.5pt;padding-bottom:1.5pt;" rowspan="2"><span id="A4.T13.1.1.1.2.1" class="ltx_text">Reg. Target</span></td>
<td id="A4.T13.1.1.1.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="A4.T13.1.1.1.3.1" class="ltx_inline-block ltx_align_top">
<span id="A4.T13.1.1.1.3.1.1" class="ltx_p" style="width:71.1pt;">Veh. LEVEL 1</span>
</span>
</td>
<td id="A4.T13.1.1.1.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="A4.T13.1.1.1.4.1" class="ltx_inline-block ltx_align_top">
<span id="A4.T13.1.1.1.4.1.1" class="ltx_p" style="width:71.1pt;">Veh. LEVEL 2</span>
</span>
</td>
</tr>
<tr id="A4.T13.1.1.2" class="ltx_tr">
<td id="A4.T13.1.1.2.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="A4.T13.1.1.2.1.1" class="ltx_inline-block ltx_align_top">
<span id="A4.T13.1.1.2.1.1.1" class="ltx_p" style="width:71.1pt;">mAP/mAPH(%)</span>
</span>
</td>
<td id="A4.T13.1.1.2.2" class="ltx_td ltx_align_justify ltx_align_top" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="A4.T13.1.1.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="A4.T13.1.1.2.2.1.1" class="ltx_p" style="width:71.1pt;">mAP/mAPH(%)</span>
</span>
</td>
</tr>
<tr id="A4.T13.1.1.3" class="ltx_tr">
<td id="A4.T13.1.1.3.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" style="padding-top:1.5pt;padding-bottom:1.5pt;">Cartesian</td>
<td id="A4.T13.1.1.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-top:1.5pt;padding-bottom:1.5pt;">Cartesian</td>
<td id="A4.T13.1.1.3.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_tt" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="A4.T13.1.1.3.3.1" class="ltx_inline-block ltx_align_top">
<span id="A4.T13.1.1.3.3.1.1" class="ltx_p" style="width:71.1pt;">73.51/72.96</span>
</span>
</td>
<td id="A4.T13.1.1.3.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_tt" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="A4.T13.1.1.3.4.1" class="ltx_inline-block ltx_align_top">
<span id="A4.T13.1.1.3.4.1.1" class="ltx_p" style="width:71.1pt;">65.86/65.33</span>
</span>
</td>
</tr>
<tr id="A4.T13.1.1.4" class="ltx_tr">
<td id="A4.T13.1.1.4.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" style="padding-top:1.5pt;padding-bottom:1.5pt;">Polar</td>
<td id="A4.T13.1.1.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:1.5pt;padding-bottom:1.5pt;">Polar</td>
<td id="A4.T13.1.1.4.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="A4.T13.1.1.4.3.1" class="ltx_inline-block ltx_align_top">
<span id="A4.T13.1.1.4.3.1.1" class="ltx_p" style="width:71.1pt;">75.02/74.55</span>
</span>
</td>
<td id="A4.T13.1.1.4.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="A4.T13.1.1.4.4.1" class="ltx_inline-block ltx_align_top">
<span id="A4.T13.1.1.4.4.1.1" class="ltx_p" style="width:71.1pt;">67.52/67.04</span>
</span>
</td>
</tr>
<tr id="A4.T13.1.1.5" class="ltx_tr">
<td id="A4.T13.1.1.5.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">Polar (Ours)</td>
<td id="A4.T13.1.1.5.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">Cartesian</td>
<td id="A4.T13.1.1.5.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="A4.T13.1.1.5.3.1" class="ltx_inline-block ltx_align_top">
<span id="A4.T13.1.1.5.3.1.1" class="ltx_p" style="width:71.1pt;"><span id="A4.T13.1.1.5.3.1.1.1" class="ltx_text ltx_font_bold">75.35/74.85</span></span>
</span>
</td>
<td id="A4.T13.1.1.5.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span id="A4.T13.1.1.5.4.1" class="ltx_inline-block ltx_align_top">
<span id="A4.T13.1.1.5.4.1.1" class="ltx_p" style="width:71.1pt;"><span id="A4.T13.1.1.5.4.1.1.1" class="ltx_text ltx_font_bold">67.84/67.35</span></span>
</span>
</td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 13: </span>Ablation study on the coordinate of box regression target.
We show the 12 epochs results on the Waymo val. set for vehicle detection.
</figcaption>
</figure>
<div id="A4.SS2.p1" class="ltx_para">
<p id="A4.SS2.p1.3" class="ltx_p">In Table <a href="#A4.T12" title="Table 12 ‣ D.2 Further study on GRR ‣ Appendix D More ablations ‣ PARTNER: Level up the Polar Representation for LiDAR 3D Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">12</span></a>, we evaluate different attention mechanisms used for feature re-alignment.
An attempt to enlarge the receptive field efficiently is to integrate polar feature maps globally along the range and angular axis using axial attention <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>.
However, experimental results demonstrate this method is not feasible (only <math id="A4.SS2.p1.1.m1.1" class="ltx_Math" alttext="0.08\%" display="inline"><semantics id="A4.SS2.p1.1.m1.1a"><mrow id="A4.SS2.p1.1.m1.1.1" xref="A4.SS2.p1.1.m1.1.1.cmml"><mn id="A4.SS2.p1.1.m1.1.1.2" xref="A4.SS2.p1.1.m1.1.1.2.cmml">0.08</mn><mo id="A4.SS2.p1.1.m1.1.1.1" xref="A4.SS2.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.1.m1.1b"><apply id="A4.SS2.p1.1.m1.1.1.cmml" xref="A4.SS2.p1.1.m1.1.1"><csymbol cd="latexml" id="A4.SS2.p1.1.m1.1.1.1.cmml" xref="A4.SS2.p1.1.m1.1.1.1">percent</csymbol><cn type="float" id="A4.SS2.p1.1.m1.1.1.2.cmml" xref="A4.SS2.p1.1.m1.1.1.2">0.08</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.1.m1.1c">0.08\%</annotation></semantics></math> gain).
Another attempt is to introduce channel-wise attention <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite> during polar feature re-alignment, by which distorted representations can also be integrated efficiently in a global manner.
Unfortunately, this practice attains limited improvement with <math id="A4.SS2.p1.2.m2.1" class="ltx_Math" alttext="0.38\%" display="inline"><semantics id="A4.SS2.p1.2.m2.1a"><mrow id="A4.SS2.p1.2.m2.1.1" xref="A4.SS2.p1.2.m2.1.1.cmml"><mn id="A4.SS2.p1.2.m2.1.1.2" xref="A4.SS2.p1.2.m2.1.1.2.cmml">0.38</mn><mo id="A4.SS2.p1.2.m2.1.1.1" xref="A4.SS2.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.2.m2.1b"><apply id="A4.SS2.p1.2.m2.1.1.cmml" xref="A4.SS2.p1.2.m2.1.1"><csymbol cd="latexml" id="A4.SS2.p1.2.m2.1.1.1.cmml" xref="A4.SS2.p1.2.m2.1.1.1">percent</csymbol><cn type="float" id="A4.SS2.p1.2.m2.1.1.2.cmml" xref="A4.SS2.p1.2.m2.1.1.2">0.38</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.2.m2.1c">0.38\%</annotation></semantics></math> gain.
One reasonable explanation for the failure of both approaches is that conducting alignment blindly at the global level introduces more background noise and produces feature representations with low quality.
Meanwhile, we try to use swin attention <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> to carry out feature alignment within the local region, trivial performance proved by the ablations (<math id="A4.SS2.p1.3.m3.1" class="ltx_Math" alttext="0.29\%" display="inline"><semantics id="A4.SS2.p1.3.m3.1a"><mrow id="A4.SS2.p1.3.m3.1.1" xref="A4.SS2.p1.3.m3.1.1.cmml"><mn id="A4.SS2.p1.3.m3.1.1.2" xref="A4.SS2.p1.3.m3.1.1.2.cmml">0.29</mn><mo id="A4.SS2.p1.3.m3.1.1.1" xref="A4.SS2.p1.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.3.m3.1b"><apply id="A4.SS2.p1.3.m3.1.1.cmml" xref="A4.SS2.p1.3.m3.1.1"><csymbol cd="latexml" id="A4.SS2.p1.3.m3.1.1.1.cmml" xref="A4.SS2.p1.3.m3.1.1.1">percent</csymbol><cn type="float" id="A4.SS2.p1.3.m3.1.1.2.cmml" xref="A4.SS2.p1.3.m3.1.1.2">0.29</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.3.m3.1c">0.29\%</annotation></semantics></math> gain), limited by background noise and restricted receptive field.</p>
</div>
</section>
<section id="A4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.3 </span>Study on different regression targets</h3>

<div id="A4.SS3.p1" class="ltx_para">
<p id="A4.SS3.p1.7" class="ltx_p">In this section, we ablate different regression coordinates.
In our main paper, we regress targets in the Cartesian coordinates, <em id="A4.SS3.p1.7.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="A4.SS3.p1.7.2" class="ltx_text"></span>, [<math id="A4.SS3.p1.1.m1.1" class="ltx_Math" alttext="x" display="inline"><semantics id="A4.SS3.p1.1.m1.1a"><mi id="A4.SS3.p1.1.m1.1.1" xref="A4.SS3.p1.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="A4.SS3.p1.1.m1.1b"><ci id="A4.SS3.p1.1.m1.1.1.cmml" xref="A4.SS3.p1.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS3.p1.1.m1.1c">x</annotation></semantics></math>, <math id="A4.SS3.p1.2.m2.1" class="ltx_Math" alttext="y" display="inline"><semantics id="A4.SS3.p1.2.m2.1a"><mi id="A4.SS3.p1.2.m2.1.1" xref="A4.SS3.p1.2.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="A4.SS3.p1.2.m2.1b"><ci id="A4.SS3.p1.2.m2.1.1.cmml" xref="A4.SS3.p1.2.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS3.p1.2.m2.1c">y</annotation></semantics></math>, <math id="A4.SS3.p1.3.m3.1" class="ltx_Math" alttext="z" display="inline"><semantics id="A4.SS3.p1.3.m3.1a"><mi id="A4.SS3.p1.3.m3.1.1" xref="A4.SS3.p1.3.m3.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="A4.SS3.p1.3.m3.1b"><ci id="A4.SS3.p1.3.m3.1.1.cmml" xref="A4.SS3.p1.3.m3.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS3.p1.3.m3.1c">z</annotation></semantics></math>, <math id="A4.SS3.p1.4.m4.1" class="ltx_Math" alttext="w" display="inline"><semantics id="A4.SS3.p1.4.m4.1a"><mi id="A4.SS3.p1.4.m4.1.1" xref="A4.SS3.p1.4.m4.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="A4.SS3.p1.4.m4.1b"><ci id="A4.SS3.p1.4.m4.1.1.cmml" xref="A4.SS3.p1.4.m4.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS3.p1.4.m4.1c">w</annotation></semantics></math>, <math id="A4.SS3.p1.5.m5.1" class="ltx_Math" alttext="l" display="inline"><semantics id="A4.SS3.p1.5.m5.1a"><mi id="A4.SS3.p1.5.m5.1.1" xref="A4.SS3.p1.5.m5.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="A4.SS3.p1.5.m5.1b"><ci id="A4.SS3.p1.5.m5.1.1.cmml" xref="A4.SS3.p1.5.m5.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS3.p1.5.m5.1c">l</annotation></semantics></math>, <math id="A4.SS3.p1.6.m6.1" class="ltx_Math" alttext="h" display="inline"><semantics id="A4.SS3.p1.6.m6.1a"><mi id="A4.SS3.p1.6.m6.1.1" xref="A4.SS3.p1.6.m6.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="A4.SS3.p1.6.m6.1b"><ci id="A4.SS3.p1.6.m6.1.1.cmml" xref="A4.SS3.p1.6.m6.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS3.p1.6.m6.1c">h</annotation></semantics></math>].
As we conduct feature representation in polar space, a reasonable attempt is to regress targets also in polar coordinates.
We perform this experiment in Table <a href="#A4.T13" title="Table 13 ‣ D.2 Further study on GRR ‣ Appendix D More ablations ‣ PARTNER: Level up the Polar Representation for LiDAR 3D Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">13</span></a>.
The experimental results show that regression in polar coordinates is less proper.
One reasonable explanation for this phenomenon is that polar-based representation is robust enough to regress targets in the real world, while regression in polar will bring unnecessary difficulties in optimization and convergence.
For example, the azumith’s restricted range of 0 to 2<math id="A4.SS3.p1.7.m7.1" class="ltx_Math" alttext="\pi" display="inline"><semantics id="A4.SS3.p1.7.m7.1a"><mi id="A4.SS3.p1.7.m7.1.1" xref="A4.SS3.p1.7.m7.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="A4.SS3.p1.7.m7.1b"><ci id="A4.SS3.p1.7.m7.1.1.cmml" xref="A4.SS3.p1.7.m7.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS3.p1.7.m7.1c">\pi</annotation></semantics></math> is a numerical obstacle for regression but significantly impacts box prediction results.
We observe a performance degradation, which coincides with our analysis.</p>
</div>
</section>
</section>
<section id="A5" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Qualitative results</h2>

<div id="A5.p1" class="ltx_para">
<p id="A5.p1.1" class="ltx_p">We have compared the quantified results of our PARTNER on two major object detection benchmarks: Waymo Open Dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> and ONCE dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>.
In this section, we present our visualization results on ONCE dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>.
As is shown in Figure <a href="#A4.F8" title="Figure 8 ‣ D.1 Effects of different partition patterns ‣ Appendix D More ablations ‣ PARTNER: Level up the Polar Representation for LiDAR 3D Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>, our method could successfully detect objects in the challenging scenes and make considerably accurate predictions.</p>
</div>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2308.03981" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2308.03982" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2308.03982">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2308.03982" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2308.03983" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Wed Feb 28 13:46:21 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
