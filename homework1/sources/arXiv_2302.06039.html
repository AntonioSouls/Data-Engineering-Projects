<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2302.06039] Predicting Class Distribution Shift for Reliable Domain Adaptive Object Detection</title><meta property="og:description" content="Unsupervised Domain Adaptive Object Detection (UDA-OD) uses unlabelled data to improve the reliability of robotic vision systems in open-world environments. Previous approaches to UDA-OD based on self-training have bee…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Predicting Class Distribution Shift for Reliable Domain Adaptive Object Detection">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Predicting Class Distribution Shift for Reliable Domain Adaptive Object Detection">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2302.06039">

<!--Generated on Fri Mar  1 02:23:48 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="
Object Detection,  Deep Learning for Visual Perception; Visual Learning

">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Predicting Class Distribution Shift for Reliable Domain Adaptive Object Detection</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Nicolas Harvey Chapman<sup id="id7.7.id1" class="ltx_sup"><span id="id7.7.id1.1" class="ltx_text ltx_font_italic">1</span></sup>, Feras Dayoub<sup id="id8.8.id2" class="ltx_sup"><span id="id8.8.id2.1" class="ltx_text ltx_font_italic">2</span></sup>, Will Browne<sup id="id9.9.id3" class="ltx_sup"><span id="id9.9.id3.1" class="ltx_text ltx_font_italic">1</span></sup> and Christopher Lehnert<sup id="id10.10.id4" class="ltx_sup"><span id="id10.10.id4.1" class="ltx_text ltx_font_italic">1</span></sup>
</span><span class="ltx_author_notes">Manuscript received: February 5, 2023; Revised May 8, 2023; Accepted June 14, 2023. This paper was recommended for publication by Editor Markus Vincze upon evaluation of the Associate Editor and Reviewers’ comments.<sup id="id11.11.id1" class="ltx_sup"><span id="id11.11.id1.1" class="ltx_text ltx_font_italic">1</span></sup>Nicolas Harvey Chapman, Will Browne and Christopher Lehnert are with the School of Electrical Engineering and Robotics, Queensland University of Technology, Brisbane, Australia (<span id="id12.12.id2" class="ltx_text ltx_font_typewriter" style="font-size:80%;">will.browne@qut.edu.au; c.lehnert@qut.edu.au; nicolasharvey.chapman@hdr.qut.edu.au</span>).<sup id="id13.13.id1" class="ltx_sup"><span id="id13.13.id1.1" class="ltx_text ltx_font_italic">2</span></sup>Feras Dayoub is with the School of Computer Science and the Australian Institute of Machine Learning at the University of Adelaide, Adelaide, Australia (<span id="id14.14.id2" class="ltx_text ltx_font_typewriter" style="font-size:80%;">feras.dayoub@adelaide.edu.au</span>).Digital Object Identifier (DOI): see top of this page.</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id15.id1" class="ltx_p">Unsupervised Domain Adaptive Object Detection (UDA-OD) uses unlabelled data to improve the reliability of robotic vision systems in open-world environments. Previous approaches to UDA-OD based on self-training have been effective in overcoming changes in the general appearance of images. However, shifts in a robot’s deployment environment can also impact the likelihood that different objects will occur, termed class distribution shift. Motivated by this, we propose a framework for explicitly addressing class distribution shift to improve pseudo-label reliability in self-training. Our approach uses the domain invariance and contextual understanding of a pre-trained joint vision and language model to predict the class distribution of unlabelled data. By aligning the class distribution of pseudo-labels with this prediction, we provide weak supervision of pseudo-label accuracy. To further account for low quality pseudo-labels early in self-training, we propose an approach to dynamically adjust the number of pseudo-labels per image based on model confidence. Our method outperforms state-of-the-art approaches on several benchmarks, including a 4.7 mAP improvement when facing challenging class distribution shift. Code available at <a target="_blank" href="https://github.com/nhcha6/ClassDistributionPrediction" title="" class="ltx_ref ltx_href" style="color:#0000FF;">https://github.com/nhcha6/ClassDistributionPrediction</a></p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>
Object Detection, Deep Learning for Visual Perception; Visual Learning


</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">Introduction</span>
</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Object detection is a crucial component of many robotic systems, from self-driving cars to service robots. Existing object detectors based on deep learning require the collection of large, annotated datasets for training. However, in open-world deployment a robot will encounter changes in object appearance due to factors such as weather, lighting conditions, or image corruptions <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>. Furthermore, shifts in a robot’s deployment environment can impact the likelihood that different objects will occur, termed class distribution shift <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>. Due to the high costs of annotation, it is infeasible to gather labelled data for all potential conditions and environments <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. Thus, it is inevitable that an object detector deployed on a robot will face the problem of domain shift, where the images being processed do not match those used for training. Unfortunately, the performance of deep learning-based object detectors degrades significantly when facing such domain shift <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>. To address this issue, Unsupervised Domain Adaptive Object Detection (UDA-OD) has been proposed to adapt a model from a known source domain to a shifted target domain using only unlabelled data. This strategy can help the model generalise and improve its performance in the target domain, without the need for expensive labelling.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Self-training methods have recently produced State-Of-The-Art (SOTA) results on UDA-OD benchmarks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. Such approaches leverage the Mean Teacher framework <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> to enforce consistency between a student and teacher model on unlabelled images (Section III-B). Key to this framework is the use of confident detections from the teacher as pseudo-labels for training the student. These methods were initially used for Semi-Supervised Object Detection (SSOD) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, where the labelled and unlabelled data come from the same distribution. Thus, when applied to a challenging domain adaptation problem, the reliability of pseudo-labels generated by the teacher may degrade significantly <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. Focusing on this challenge, recent work has adapted Mean Teacher to UDA-OD by improving pseudo-label reliability in the presence of domain shift <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2302.06039/assets/Figures/hook_figure.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="592" height="140" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Our framework for explicitly incorporating class distribution shift into self-training to improve pseudo-label reliability. As per the standard implementation of Mean Teacher, confident detections from a teacher model are used as pseudo-labels to train a student model using unlabelled data. The Exponential Moving Average (EMA) of the weights of the student are then used to update the teacher to make it more stable during training. Traditionally, a static confidence threshold is defined for all classes to generate pseudo-labels. Our method (shown in green) instead predicts the class distribution of the unlabelled data, and selects confidence thresholds to align the class distribution of the pseudo-labels with this prediction. To further address the poor performance of the teacher model in the target domain, we dynamically adjust the number of pseudo-labels per image as teacher confidence increases.
</figcaption>
</figure>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">While promising, existing UDA-OD methods and benchmarks focus largely on changes to the appearance of images <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>. Thus, the benefit of explicitly addressing class distribution shift during self-training is unexplored. Furthermore, in robotics there are opportunities to use contextual cues to generate a prediction for the likelihood of object occurrence. For example, one expects an autonomous vehicle to encounter more pedestrians on city streets than on the highway <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>. Motivated by this, we propose a framework for explicitly addressing class distribution shift during self-training. We find that our approach can significantly increase the reliability of pseudo-labels produced by Mean Teacher, leading to improved domain adaptation.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Our framework involves firstly predicting the class distribution of unlabelled data in novel deployment environments. Due to their strong understanding of image context and resistance to domain shift, we find that pre-trained joint vision and language models are useful for this task <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>. We then use Adapative label distribution aware Confidence Thresholding (ACT) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> (Section III-C) to incorporate our prediction into Mean Teacher. Proposed for SSOD, ACT improves performance on low probability classes and provides weak supervision of the teacher model by aligning the distribution of pseudo-labels with that of the labelled data. By using our prediction instead of the labelled prior, the reliability of pseudo-labels used in Mean Teacher improves substantially. However, even with a perfectly accurate class distribution, we find that the pseudo-labels generated with ACT remain unreliable early in self-training. To address this, we propose an approach for dynamically adjusting the number of pseudo-labels per image based on the confidence of the teacher model. Extensive experiments show that our proposed method returns SOTA performance on several benchmarks, including a 4.3 mAP improvement when adapting from a small to large scale dataset. On a novel scenario containing more challenging class distribution shift, we return a 4.7 mAP improvement.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">To summarise, this letter makes the following contributions:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">A framework for explicitly addressing class distribution shift during self-training, leading to an improvement in pseudo-label reliability.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">A method to predict the class distribution of unlabelled data using a pre-trained joint vision and language model.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">An approach for dynamically adjusting the number of pseudo-labels per image to account for the confidence of the teacher in the target domain.</p>
</div>
</li>
<li id="S1.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i4.p1" class="ltx_para">
<p id="S1.I1.i4.p1.1" class="ltx_p">Experimental results showing that the proposed method returns SOTA performance on several benchmarks, including scenarios with realistic class distribution shift.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">Related Work</span>
</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS1.5.1.1" class="ltx_text">II-A</span> </span><span id="S2.SS1.6.2" class="ltx_text ltx_font_italic">Self-training in Unsupervised Domain Adaptive Object Detection</span>
</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">Initially proposed for semi-supervised learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>, self-training methods have recently produced SOTA results on UDA-OD benchmarks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. Several
augmentations have been made to the standard Mean Teacher framework <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> to improve pseudo-label reliability under domain shift. Methods have been proposed for merging patches from labelled and unlabelled images <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, selecting optimal pseudo-labels to balance true positive and false negative detections <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> and performing style transfer between the source and target domains <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. Recognising that pseudo-labels are inevitably unreliable, Chen <span id="S2.SS1.p1.1.1" class="ltx_text ltx_font_italic">et al.<cite class="ltx_cite ltx_citemacro_cite"><span id="S2.SS1.p1.1.1.1.1" class="ltx_text ltx_font_upright">[</span><a href="#bib.bib4" title="" class="ltx_ref">4</a><span id="S2.SS1.p1.1.1.2.2" class="ltx_text ltx_font_upright">]</span></cite></span> propose a probabilistic self-training framework that does not require confidence thresholds <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>. Instead, they implement an entropy focal loss that encourages the student to pay more attention to high certainty detections. While promising, these methods fail to leverage the rich contextual information available during robotic deployment and focus on shifts in the general appearance of images. Consequently, the potential for contextual and class distribution shift is largely ignored. Motivated by this, Xu <span id="S2.SS1.p1.1.2" class="ltx_text ltx_font_italic">et al.<cite class="ltx_cite ltx_citemacro_cite"><span id="S2.SS1.p1.1.2.1.1" class="ltx_text ltx_font_upright">[</span><a href="#bib.bib15" title="" class="ltx_ref">15</a><span id="S2.SS1.p1.1.2.2.2" class="ltx_text ltx_font_upright">]</span></cite></span> enforce consistency between the object detector and an image-level multilabel classifier, which is more robust to arbitrary changes in image background. However, this method was proposed for use in domain alignment instead of self-training. Cai <span id="S2.SS1.p1.1.3" class="ltx_text ltx_font_italic">et al.<cite class="ltx_cite ltx_citemacro_cite"><span id="S2.SS1.p1.1.3.1.1" class="ltx_text ltx_font_upright">[</span><a href="#bib.bib10" title="" class="ltx_ref">10</a><span id="S2.SS1.p1.1.3.2.2" class="ltx_text ltx_font_upright">]</span></cite></span> model the relationships between objects in a scene using a graph structure, and enforces consistency between student and teacher graphs. While incorporating contextual information improves robustness, the pseudo-labels and relational graphs generated using arbitrary thresholds remain unreliable. Furthermore, these methods do not consider the impact of class distribution shift on self-training. In response, we model image context to predict the class distribution of unlabelled data in novel deployment environments. This prior can be incorporated into self-training via ACT, which generates pseudo-labels to match the predicted class distribution <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. This method has shown promising results in SSOD, and we propose a series of changes to optimise it for domain adaptation.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS2.5.1.1" class="ltx_text">II-B</span> </span><span id="S2.SS2.6.2" class="ltx_text ltx_font_italic">Class Imbalance in Self-training</span>
</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">It is well established that class imbalance leads to severe confirmation bias during self-training, as dominant classes are predicted with high confidence and subsequently reinforced <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>. Solutions to this problem have been proposed for SSOD, such as the weighting of low probability classes <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> or ACT to align the distribution of pseudo-labels with a known class distribution <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. However, existing methods fail to address the class imbalance problem in the presence of domain shift.</p>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS3.5.1.1" class="ltx_text">II-C</span> </span><span id="S2.SS3.6.2" class="ltx_text ltx_font_italic">Class Distribution Shift in UDA-OD</span>
</h3>

<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.1" class="ltx_p">Existing UDA-OD benchmarks often focus on appearance changes due to factors such as weather, lighting conditions, or image corruptions <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>, but do not adequately assess realistic class distribution shifts. Ignoring class distribution shift is a critical limitation, as they are standard in open-world robotic deployment and can significantly impact the performance of object detection algorithms <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>. In particular, the Cityscapes <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> to Foggy Cityscapes <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> adaptation scenario contains no class distribution shift as the target domain is an augmented version of the source images <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>. Similarly, the cross camera adaptation and simulation to real scenarios only contain a single class <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>. The final benchmark studies adaptation from a small to large-scale dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>, reflecting the challenge of deploying a robot in a new environment with a broad array of conditions. We find that the shift in location produces significant class distribution shift, making it useful for this work. However, the impact of class distribution shift on UDA-OD is poorly evaluated using existing benchmarks. In turn, the benefits of explicitly addressing this problem during self-training are largely unexplored.</p>
</div>
</section>
<section id="S2.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS4.5.1.1" class="ltx_text">II-D</span> </span><span id="S2.SS4.6.2" class="ltx_text ltx_font_italic">Pre-trained Joint Vision and Language Models</span>
</h3>

<div id="S2.SS4.p1" class="ltx_para">
<p id="S2.SS4.p1.1" class="ltx_p">The abundance of captioned images has allowed the learning of transferable image representations using natural language supervision. One notable example is Contrastive Language-Image Pretraining (CLIP), which trains a model to predict the images and text that occur together using 400 million image-text pairs <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>. Because natural language descriptions are highly generalisable, CLIP can be easily transferred to new tasks and exhibits superior resistance to domain shift compared to supervised pre-training methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>. Language descriptions also contain a wealth of contextual information <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>, making them useful for modelling the deployment environment of a robot. Recent work proposes using the similarity between an image and a series of text prompts produced by CLIP as a representation of image context <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>. This representation is a strong predictor of object occurrence in an image, helping to improve semantic segmentation performance in open-world settings. In this work, we leverage the domain invariance and contextual detail of these image-text similarity scores to predict the class distribution of unlabelled data.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">Preliminaries</span>
</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS1.5.1.1" class="ltx_text">III-A</span> </span><span id="S3.SS1.6.2" class="ltx_text ltx_font_italic">Problem Formulation</span>
</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.5" class="ltx_p">In UDA-OD, a set of <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="n_{l}" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><msub id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">n</mi><mi id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">𝑛</ci><ci id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">n_{l}</annotation></semantics></math> labelled images <math id="S3.SS1.p1.2.m2.2" class="ltx_Math" alttext="D_{l}=\left\{X_{l},Y_{l}\right\}" display="inline"><semantics id="S3.SS1.p1.2.m2.2a"><mrow id="S3.SS1.p1.2.m2.2.2" xref="S3.SS1.p1.2.m2.2.2.cmml"><msub id="S3.SS1.p1.2.m2.2.2.4" xref="S3.SS1.p1.2.m2.2.2.4.cmml"><mi id="S3.SS1.p1.2.m2.2.2.4.2" xref="S3.SS1.p1.2.m2.2.2.4.2.cmml">D</mi><mi id="S3.SS1.p1.2.m2.2.2.4.3" xref="S3.SS1.p1.2.m2.2.2.4.3.cmml">l</mi></msub><mo id="S3.SS1.p1.2.m2.2.2.3" xref="S3.SS1.p1.2.m2.2.2.3.cmml">=</mo><mrow id="S3.SS1.p1.2.m2.2.2.2.2" xref="S3.SS1.p1.2.m2.2.2.2.3.cmml"><mo id="S3.SS1.p1.2.m2.2.2.2.2.3" xref="S3.SS1.p1.2.m2.2.2.2.3.cmml">{</mo><msub id="S3.SS1.p1.2.m2.1.1.1.1.1" xref="S3.SS1.p1.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.2.m2.1.1.1.1.1.2" xref="S3.SS1.p1.2.m2.1.1.1.1.1.2.cmml">X</mi><mi id="S3.SS1.p1.2.m2.1.1.1.1.1.3" xref="S3.SS1.p1.2.m2.1.1.1.1.1.3.cmml">l</mi></msub><mo id="S3.SS1.p1.2.m2.2.2.2.2.4" xref="S3.SS1.p1.2.m2.2.2.2.3.cmml">,</mo><msub id="S3.SS1.p1.2.m2.2.2.2.2.2" xref="S3.SS1.p1.2.m2.2.2.2.2.2.cmml"><mi id="S3.SS1.p1.2.m2.2.2.2.2.2.2" xref="S3.SS1.p1.2.m2.2.2.2.2.2.2.cmml">Y</mi><mi id="S3.SS1.p1.2.m2.2.2.2.2.2.3" xref="S3.SS1.p1.2.m2.2.2.2.2.2.3.cmml">l</mi></msub><mo id="S3.SS1.p1.2.m2.2.2.2.2.5" xref="S3.SS1.p1.2.m2.2.2.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.2b"><apply id="S3.SS1.p1.2.m2.2.2.cmml" xref="S3.SS1.p1.2.m2.2.2"><eq id="S3.SS1.p1.2.m2.2.2.3.cmml" xref="S3.SS1.p1.2.m2.2.2.3"></eq><apply id="S3.SS1.p1.2.m2.2.2.4.cmml" xref="S3.SS1.p1.2.m2.2.2.4"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.2.2.4.1.cmml" xref="S3.SS1.p1.2.m2.2.2.4">subscript</csymbol><ci id="S3.SS1.p1.2.m2.2.2.4.2.cmml" xref="S3.SS1.p1.2.m2.2.2.4.2">𝐷</ci><ci id="S3.SS1.p1.2.m2.2.2.4.3.cmml" xref="S3.SS1.p1.2.m2.2.2.4.3">𝑙</ci></apply><set id="S3.SS1.p1.2.m2.2.2.2.3.cmml" xref="S3.SS1.p1.2.m2.2.2.2.2"><apply id="S3.SS1.p1.2.m2.1.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1.1.2">𝑋</ci><ci id="S3.SS1.p1.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1.1.3">𝑙</ci></apply><apply id="S3.SS1.p1.2.m2.2.2.2.2.2.cmml" xref="S3.SS1.p1.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.2.2.2.2.2.1.cmml" xref="S3.SS1.p1.2.m2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.2.m2.2.2.2.2.2.2.cmml" xref="S3.SS1.p1.2.m2.2.2.2.2.2.2">𝑌</ci><ci id="S3.SS1.p1.2.m2.2.2.2.2.2.3.cmml" xref="S3.SS1.p1.2.m2.2.2.2.2.2.3">𝑙</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.2c">D_{l}=\left\{X_{l},Y_{l}\right\}</annotation></semantics></math> containing <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="n_{c}" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><msub id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><mi id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">n</mi><mi id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2">𝑛</ci><ci id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">n_{c}</annotation></semantics></math> classes from the the source domain and <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="n_{u}" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><msub id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><mi id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml">n</mi><mi id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2">𝑛</ci><ci id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">n_{u}</annotation></semantics></math> unlabelled images <math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="D_{u}=\left\{X_{u}\right\}" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><mrow id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml"><msub id="S3.SS1.p1.5.m5.1.1.3" xref="S3.SS1.p1.5.m5.1.1.3.cmml"><mi id="S3.SS1.p1.5.m5.1.1.3.2" xref="S3.SS1.p1.5.m5.1.1.3.2.cmml">D</mi><mi id="S3.SS1.p1.5.m5.1.1.3.3" xref="S3.SS1.p1.5.m5.1.1.3.3.cmml">u</mi></msub><mo id="S3.SS1.p1.5.m5.1.1.2" xref="S3.SS1.p1.5.m5.1.1.2.cmml">=</mo><mrow id="S3.SS1.p1.5.m5.1.1.1.1" xref="S3.SS1.p1.5.m5.1.1.1.2.cmml"><mo id="S3.SS1.p1.5.m5.1.1.1.1.2" xref="S3.SS1.p1.5.m5.1.1.1.2.cmml">{</mo><msub id="S3.SS1.p1.5.m5.1.1.1.1.1" xref="S3.SS1.p1.5.m5.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.5.m5.1.1.1.1.1.2" xref="S3.SS1.p1.5.m5.1.1.1.1.1.2.cmml">X</mi><mi id="S3.SS1.p1.5.m5.1.1.1.1.1.3" xref="S3.SS1.p1.5.m5.1.1.1.1.1.3.cmml">u</mi></msub><mo id="S3.SS1.p1.5.m5.1.1.1.1.3" xref="S3.SS1.p1.5.m5.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"><eq id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2"></eq><apply id="S3.SS1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.3.1.cmml" xref="S3.SS1.p1.5.m5.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.3.2.cmml" xref="S3.SS1.p1.5.m5.1.1.3.2">𝐷</ci><ci id="S3.SS1.p1.5.m5.1.1.3.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3.3">𝑢</ci></apply><set id="S3.SS1.p1.5.m5.1.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.1.1"><apply id="S3.SS1.p1.5.m5.1.1.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.1.1.1.2">𝑋</ci><ci id="S3.SS1.p1.5.m5.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.1.1.1.3">𝑢</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">D_{u}=\left\{X_{u}\right\}</annotation></semantics></math> from the target domain are provided. The goal of UDA-OD is to use both the labelled source and unlabelled target data to optimise performance of the object detector in the target domain.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS2.5.1.1" class="ltx_text">III-B</span> </span><span id="S3.SS2.6.2" class="ltx_text ltx_font_italic">Mean Teacher</span>
</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.8" class="ltx_p">The Mean Teacher framework <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> encourages consistent predictions by a student and teacher model on augmented versions of the unlabelled data. This process leads the student and teacher to learn a solution from the source domain that is transferable to the target domain. An overview of this method is provided in Figure <a href="#S1.F1" title="Figure 1 ‣ I Introduction ‣ Predicting Class Distribution Shift for Reliable Domain Adaptive Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. The student and teacher models share the same network architecture, but different weights <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="\theta^{s}" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><msup id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">θ</mi><mi id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml">s</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">superscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">𝜃</ci><ci id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\theta^{s}</annotation></semantics></math> and <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="\theta^{t}" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><msup id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">θ</mi><mi id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">superscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">𝜃</ci><ci id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\theta^{t}</annotation></semantics></math> respectively. For a given unlabelled sample <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="x_{u}" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><msub id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml">x</mi><mi id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2">𝑥</ci><ci id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">x_{u}</annotation></semantics></math>, a weakly augmented version <math id="S3.SS2.p1.4.m4.1" class="ltx_Math" alttext="x_{u}^{t}" display="inline"><semantics id="S3.SS2.p1.4.m4.1a"><msubsup id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><mi id="S3.SS2.p1.4.m4.1.1.2.2" xref="S3.SS2.p1.4.m4.1.1.2.2.cmml">x</mi><mi id="S3.SS2.p1.4.m4.1.1.2.3" xref="S3.SS2.p1.4.m4.1.1.2.3.cmml">u</mi><mi id="S3.SS2.p1.4.m4.1.1.3" xref="S3.SS2.p1.4.m4.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">superscript</csymbol><apply id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.2.1.cmml" xref="S3.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.2.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2.2">𝑥</ci><ci id="S3.SS2.p1.4.m4.1.1.2.3.cmml" xref="S3.SS2.p1.4.m4.1.1.2.3">𝑢</ci></apply><ci id="S3.SS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">x_{u}^{t}</annotation></semantics></math> is created for input into the teacher model by applying horizontal flipping and multi-scaling <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. After non-maximum suppression (NMS), a confidence threshold is applied to the teacher’s predictions <math id="S3.SS2.p1.5.m5.2" class="ltx_Math" alttext="f(x_{u}^{t},\theta^{t})" display="inline"><semantics id="S3.SS2.p1.5.m5.2a"><mrow id="S3.SS2.p1.5.m5.2.2" xref="S3.SS2.p1.5.m5.2.2.cmml"><mi id="S3.SS2.p1.5.m5.2.2.4" xref="S3.SS2.p1.5.m5.2.2.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.5.m5.2.2.3" xref="S3.SS2.p1.5.m5.2.2.3.cmml">​</mo><mrow id="S3.SS2.p1.5.m5.2.2.2.2" xref="S3.SS2.p1.5.m5.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS2.p1.5.m5.2.2.2.2.3" xref="S3.SS2.p1.5.m5.2.2.2.3.cmml">(</mo><msubsup id="S3.SS2.p1.5.m5.1.1.1.1.1" xref="S3.SS2.p1.5.m5.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.5.m5.1.1.1.1.1.2.2" xref="S3.SS2.p1.5.m5.1.1.1.1.1.2.2.cmml">x</mi><mi id="S3.SS2.p1.5.m5.1.1.1.1.1.2.3" xref="S3.SS2.p1.5.m5.1.1.1.1.1.2.3.cmml">u</mi><mi id="S3.SS2.p1.5.m5.1.1.1.1.1.3" xref="S3.SS2.p1.5.m5.1.1.1.1.1.3.cmml">t</mi></msubsup><mo id="S3.SS2.p1.5.m5.2.2.2.2.4" xref="S3.SS2.p1.5.m5.2.2.2.3.cmml">,</mo><msup id="S3.SS2.p1.5.m5.2.2.2.2.2" xref="S3.SS2.p1.5.m5.2.2.2.2.2.cmml"><mi id="S3.SS2.p1.5.m5.2.2.2.2.2.2" xref="S3.SS2.p1.5.m5.2.2.2.2.2.2.cmml">θ</mi><mi id="S3.SS2.p1.5.m5.2.2.2.2.2.3" xref="S3.SS2.p1.5.m5.2.2.2.2.2.3.cmml">t</mi></msup><mo stretchy="false" id="S3.SS2.p1.5.m5.2.2.2.2.5" xref="S3.SS2.p1.5.m5.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.2b"><apply id="S3.SS2.p1.5.m5.2.2.cmml" xref="S3.SS2.p1.5.m5.2.2"><times id="S3.SS2.p1.5.m5.2.2.3.cmml" xref="S3.SS2.p1.5.m5.2.2.3"></times><ci id="S3.SS2.p1.5.m5.2.2.4.cmml" xref="S3.SS2.p1.5.m5.2.2.4">𝑓</ci><interval closure="open" id="S3.SS2.p1.5.m5.2.2.2.3.cmml" xref="S3.SS2.p1.5.m5.2.2.2.2"><apply id="S3.SS2.p1.5.m5.1.1.1.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1.1.1.1">superscript</csymbol><apply id="S3.SS2.p1.5.m5.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.5.m5.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p1.5.m5.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.5.m5.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p1.5.m5.1.1.1.1.1.2.2">𝑥</ci><ci id="S3.SS2.p1.5.m5.1.1.1.1.1.2.3.cmml" xref="S3.SS2.p1.5.m5.1.1.1.1.1.2.3">𝑢</ci></apply><ci id="S3.SS2.p1.5.m5.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.5.m5.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.SS2.p1.5.m5.2.2.2.2.2.cmml" xref="S3.SS2.p1.5.m5.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.2.2.2.2.2.1.cmml" xref="S3.SS2.p1.5.m5.2.2.2.2.2">superscript</csymbol><ci id="S3.SS2.p1.5.m5.2.2.2.2.2.2.cmml" xref="S3.SS2.p1.5.m5.2.2.2.2.2.2">𝜃</ci><ci id="S3.SS2.p1.5.m5.2.2.2.2.2.3.cmml" xref="S3.SS2.p1.5.m5.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.2c">f(x_{u}^{t},\theta^{t})</annotation></semantics></math> to generate pseudo-labels <math id="S3.SS2.p1.6.m6.1" class="ltx_Math" alttext="y_{u}" display="inline"><semantics id="S3.SS2.p1.6.m6.1a"><msub id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml"><mi id="S3.SS2.p1.6.m6.1.1.2" xref="S3.SS2.p1.6.m6.1.1.2.cmml">y</mi><mi id="S3.SS2.p1.6.m6.1.1.3" xref="S3.SS2.p1.6.m6.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><apply id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.p1.6.m6.1.1.2.cmml" xref="S3.SS2.p1.6.m6.1.1.2">𝑦</ci><ci id="S3.SS2.p1.6.m6.1.1.3.cmml" xref="S3.SS2.p1.6.m6.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">y_{u}</annotation></semantics></math>. Strong augmentations including color jittering, grayscale, gaussian blurring and cutout patches <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> are applied to create <math id="S3.SS2.p1.7.m7.1" class="ltx_Math" alttext="x_{u}^{s}" display="inline"><semantics id="S3.SS2.p1.7.m7.1a"><msubsup id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml"><mi id="S3.SS2.p1.7.m7.1.1.2.2" xref="S3.SS2.p1.7.m7.1.1.2.2.cmml">x</mi><mi id="S3.SS2.p1.7.m7.1.1.2.3" xref="S3.SS2.p1.7.m7.1.1.2.3.cmml">u</mi><mi id="S3.SS2.p1.7.m7.1.1.3" xref="S3.SS2.p1.7.m7.1.1.3.cmml">s</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><apply id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.1.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1">superscript</csymbol><apply id="S3.SS2.p1.7.m7.1.1.2.cmml" xref="S3.SS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.1.1.2.1.cmml" xref="S3.SS2.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.p1.7.m7.1.1.2.2.cmml" xref="S3.SS2.p1.7.m7.1.1.2.2">𝑥</ci><ci id="S3.SS2.p1.7.m7.1.1.2.3.cmml" xref="S3.SS2.p1.7.m7.1.1.2.3">𝑢</ci></apply><ci id="S3.SS2.p1.7.m7.1.1.3.cmml" xref="S3.SS2.p1.7.m7.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">x_{u}^{s}</annotation></semantics></math>, which is used to generate the student’s predictions <math id="S3.SS2.p1.8.m8.2" class="ltx_Math" alttext="f(x_{u}^{s},\theta^{s})" display="inline"><semantics id="S3.SS2.p1.8.m8.2a"><mrow id="S3.SS2.p1.8.m8.2.2" xref="S3.SS2.p1.8.m8.2.2.cmml"><mi id="S3.SS2.p1.8.m8.2.2.4" xref="S3.SS2.p1.8.m8.2.2.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.8.m8.2.2.3" xref="S3.SS2.p1.8.m8.2.2.3.cmml">​</mo><mrow id="S3.SS2.p1.8.m8.2.2.2.2" xref="S3.SS2.p1.8.m8.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS2.p1.8.m8.2.2.2.2.3" xref="S3.SS2.p1.8.m8.2.2.2.3.cmml">(</mo><msubsup id="S3.SS2.p1.8.m8.1.1.1.1.1" xref="S3.SS2.p1.8.m8.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.8.m8.1.1.1.1.1.2.2" xref="S3.SS2.p1.8.m8.1.1.1.1.1.2.2.cmml">x</mi><mi id="S3.SS2.p1.8.m8.1.1.1.1.1.2.3" xref="S3.SS2.p1.8.m8.1.1.1.1.1.2.3.cmml">u</mi><mi id="S3.SS2.p1.8.m8.1.1.1.1.1.3" xref="S3.SS2.p1.8.m8.1.1.1.1.1.3.cmml">s</mi></msubsup><mo id="S3.SS2.p1.8.m8.2.2.2.2.4" xref="S3.SS2.p1.8.m8.2.2.2.3.cmml">,</mo><msup id="S3.SS2.p1.8.m8.2.2.2.2.2" xref="S3.SS2.p1.8.m8.2.2.2.2.2.cmml"><mi id="S3.SS2.p1.8.m8.2.2.2.2.2.2" xref="S3.SS2.p1.8.m8.2.2.2.2.2.2.cmml">θ</mi><mi id="S3.SS2.p1.8.m8.2.2.2.2.2.3" xref="S3.SS2.p1.8.m8.2.2.2.2.2.3.cmml">s</mi></msup><mo stretchy="false" id="S3.SS2.p1.8.m8.2.2.2.2.5" xref="S3.SS2.p1.8.m8.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m8.2b"><apply id="S3.SS2.p1.8.m8.2.2.cmml" xref="S3.SS2.p1.8.m8.2.2"><times id="S3.SS2.p1.8.m8.2.2.3.cmml" xref="S3.SS2.p1.8.m8.2.2.3"></times><ci id="S3.SS2.p1.8.m8.2.2.4.cmml" xref="S3.SS2.p1.8.m8.2.2.4">𝑓</ci><interval closure="open" id="S3.SS2.p1.8.m8.2.2.2.3.cmml" xref="S3.SS2.p1.8.m8.2.2.2.2"><apply id="S3.SS2.p1.8.m8.1.1.1.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m8.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1.1.1.1">superscript</csymbol><apply id="S3.SS2.p1.8.m8.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.8.m8.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m8.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p1.8.m8.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.8.m8.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p1.8.m8.1.1.1.1.1.2.2">𝑥</ci><ci id="S3.SS2.p1.8.m8.1.1.1.1.1.2.3.cmml" xref="S3.SS2.p1.8.m8.1.1.1.1.1.2.3">𝑢</ci></apply><ci id="S3.SS2.p1.8.m8.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.8.m8.1.1.1.1.1.3">𝑠</ci></apply><apply id="S3.SS2.p1.8.m8.2.2.2.2.2.cmml" xref="S3.SS2.p1.8.m8.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m8.2.2.2.2.2.1.cmml" xref="S3.SS2.p1.8.m8.2.2.2.2.2">superscript</csymbol><ci id="S3.SS2.p1.8.m8.2.2.2.2.2.2.cmml" xref="S3.SS2.p1.8.m8.2.2.2.2.2.2">𝜃</ci><ci id="S3.SS2.p1.8.m8.2.2.2.2.2.3.cmml" xref="S3.SS2.p1.8.m8.2.2.2.2.2.3">𝑠</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m8.2c">f(x_{u}^{s},\theta^{s})</annotation></semantics></math>. In turn, an unsupervised loss can be calculated as:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.4" class="ltx_Math" alttext="\vspace{-0.25em}\mathcal{L}_{u}=\mathcal{L}_{cls}(f(x_{u}^{s},\theta^{s}),y_{u})+\mathcal{L}_{reg}(f(x_{u}^{s},\theta^{s}),y_{u})" display="block"><semantics id="S3.E1.m1.4a"><mrow id="S3.E1.m1.4.4" xref="S3.E1.m1.4.4.cmml"><msub id="S3.E1.m1.4.4.6" xref="S3.E1.m1.4.4.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.4.4.6.2" xref="S3.E1.m1.4.4.6.2.cmml">ℒ</mi><mi id="S3.E1.m1.4.4.6.3" xref="S3.E1.m1.4.4.6.3.cmml">u</mi></msub><mo id="S3.E1.m1.4.4.5" xref="S3.E1.m1.4.4.5.cmml">=</mo><mrow id="S3.E1.m1.4.4.4" xref="S3.E1.m1.4.4.4.cmml"><mrow id="S3.E1.m1.2.2.2.2" xref="S3.E1.m1.2.2.2.2.cmml"><msub id="S3.E1.m1.2.2.2.2.4" xref="S3.E1.m1.2.2.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.2.2.2.2.4.2" xref="S3.E1.m1.2.2.2.2.4.2.cmml">ℒ</mi><mrow id="S3.E1.m1.2.2.2.2.4.3" xref="S3.E1.m1.2.2.2.2.4.3.cmml"><mi id="S3.E1.m1.2.2.2.2.4.3.2" xref="S3.E1.m1.2.2.2.2.4.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.2.2.4.3.1" xref="S3.E1.m1.2.2.2.2.4.3.1.cmml">​</mo><mi id="S3.E1.m1.2.2.2.2.4.3.3" xref="S3.E1.m1.2.2.2.2.4.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.2.2.4.3.1a" xref="S3.E1.m1.2.2.2.2.4.3.1.cmml">​</mo><mi id="S3.E1.m1.2.2.2.2.4.3.4" xref="S3.E1.m1.2.2.2.2.4.3.4.cmml">s</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.2.2.3" xref="S3.E1.m1.2.2.2.2.3.cmml">​</mo><mrow id="S3.E1.m1.2.2.2.2.2.2" xref="S3.E1.m1.2.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.E1.m1.2.2.2.2.2.2.3" xref="S3.E1.m1.2.2.2.2.2.3.cmml">(</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.4" xref="S3.E1.m1.1.1.1.1.1.1.1.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.3.cmml">​</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1.2.2" xref="S3.E1.m1.1.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.1.1.2.2.3" xref="S3.E1.m1.1.1.1.1.1.1.1.2.3.cmml">(</mo><msubsup id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">u</mi><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">s</mi></msubsup><mo id="S3.E1.m1.1.1.1.1.1.1.1.2.2.4" xref="S3.E1.m1.1.1.1.1.1.1.1.2.3.cmml">,</mo><msup id="S3.E1.m1.1.1.1.1.1.1.1.2.2.2" xref="S3.E1.m1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E1.m1.1.1.1.1.1.1.1.2.2.2.2.cmml">θ</mi><mi id="S3.E1.m1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E1.m1.1.1.1.1.1.1.1.2.2.2.3.cmml">s</mi></msup><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.1.1.2.2.5" xref="S3.E1.m1.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.2.2.2.2.2.2.4" xref="S3.E1.m1.2.2.2.2.2.3.cmml">,</mo><msub id="S3.E1.m1.2.2.2.2.2.2.2" xref="S3.E1.m1.2.2.2.2.2.2.2.cmml"><mi id="S3.E1.m1.2.2.2.2.2.2.2.2" xref="S3.E1.m1.2.2.2.2.2.2.2.2.cmml">y</mi><mi id="S3.E1.m1.2.2.2.2.2.2.2.3" xref="S3.E1.m1.2.2.2.2.2.2.2.3.cmml">u</mi></msub><mo stretchy="false" id="S3.E1.m1.2.2.2.2.2.2.5" xref="S3.E1.m1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.4.4.4.5" xref="S3.E1.m1.4.4.4.5.cmml">+</mo><mrow id="S3.E1.m1.4.4.4.4" xref="S3.E1.m1.4.4.4.4.cmml"><msub id="S3.E1.m1.4.4.4.4.4" xref="S3.E1.m1.4.4.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.4.4.4.4.4.2" xref="S3.E1.m1.4.4.4.4.4.2.cmml">ℒ</mi><mrow id="S3.E1.m1.4.4.4.4.4.3" xref="S3.E1.m1.4.4.4.4.4.3.cmml"><mi id="S3.E1.m1.4.4.4.4.4.3.2" xref="S3.E1.m1.4.4.4.4.4.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.4.4.4.4.3.1" xref="S3.E1.m1.4.4.4.4.4.3.1.cmml">​</mo><mi id="S3.E1.m1.4.4.4.4.4.3.3" xref="S3.E1.m1.4.4.4.4.4.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.4.4.4.4.3.1a" xref="S3.E1.m1.4.4.4.4.4.3.1.cmml">​</mo><mi id="S3.E1.m1.4.4.4.4.4.3.4" xref="S3.E1.m1.4.4.4.4.4.3.4.cmml">g</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.4.4.4.3" xref="S3.E1.m1.4.4.4.4.3.cmml">​</mo><mrow id="S3.E1.m1.4.4.4.4.2.2" xref="S3.E1.m1.4.4.4.4.2.3.cmml"><mo stretchy="false" id="S3.E1.m1.4.4.4.4.2.2.3" xref="S3.E1.m1.4.4.4.4.2.3.cmml">(</mo><mrow id="S3.E1.m1.3.3.3.3.1.1.1" xref="S3.E1.m1.3.3.3.3.1.1.1.cmml"><mi id="S3.E1.m1.3.3.3.3.1.1.1.4" xref="S3.E1.m1.3.3.3.3.1.1.1.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.3.3.1.1.1.3" xref="S3.E1.m1.3.3.3.3.1.1.1.3.cmml">​</mo><mrow id="S3.E1.m1.3.3.3.3.1.1.1.2.2" xref="S3.E1.m1.3.3.3.3.1.1.1.2.3.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.3.3.1.1.1.2.2.3" xref="S3.E1.m1.3.3.3.3.1.1.1.2.3.cmml">(</mo><msubsup id="S3.E1.m1.3.3.3.3.1.1.1.1.1.1" xref="S3.E1.m1.3.3.3.3.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.3.3.3.3.1.1.1.1.1.1.2.2" xref="S3.E1.m1.3.3.3.3.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S3.E1.m1.3.3.3.3.1.1.1.1.1.1.2.3" xref="S3.E1.m1.3.3.3.3.1.1.1.1.1.1.2.3.cmml">u</mi><mi id="S3.E1.m1.3.3.3.3.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.3.3.1.1.1.1.1.1.3.cmml">s</mi></msubsup><mo id="S3.E1.m1.3.3.3.3.1.1.1.2.2.4" xref="S3.E1.m1.3.3.3.3.1.1.1.2.3.cmml">,</mo><msup id="S3.E1.m1.3.3.3.3.1.1.1.2.2.2" xref="S3.E1.m1.3.3.3.3.1.1.1.2.2.2.cmml"><mi id="S3.E1.m1.3.3.3.3.1.1.1.2.2.2.2" xref="S3.E1.m1.3.3.3.3.1.1.1.2.2.2.2.cmml">θ</mi><mi id="S3.E1.m1.3.3.3.3.1.1.1.2.2.2.3" xref="S3.E1.m1.3.3.3.3.1.1.1.2.2.2.3.cmml">s</mi></msup><mo stretchy="false" id="S3.E1.m1.3.3.3.3.1.1.1.2.2.5" xref="S3.E1.m1.3.3.3.3.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.4.4.4.4.2.2.4" xref="S3.E1.m1.4.4.4.4.2.3.cmml">,</mo><msub id="S3.E1.m1.4.4.4.4.2.2.2" xref="S3.E1.m1.4.4.4.4.2.2.2.cmml"><mi id="S3.E1.m1.4.4.4.4.2.2.2.2" xref="S3.E1.m1.4.4.4.4.2.2.2.2.cmml">y</mi><mi id="S3.E1.m1.4.4.4.4.2.2.2.3" xref="S3.E1.m1.4.4.4.4.2.2.2.3.cmml">u</mi></msub><mo stretchy="false" id="S3.E1.m1.4.4.4.4.2.2.5" xref="S3.E1.m1.4.4.4.4.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.4b"><apply id="S3.E1.m1.4.4.cmml" xref="S3.E1.m1.4.4"><eq id="S3.E1.m1.4.4.5.cmml" xref="S3.E1.m1.4.4.5"></eq><apply id="S3.E1.m1.4.4.6.cmml" xref="S3.E1.m1.4.4.6"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.6.1.cmml" xref="S3.E1.m1.4.4.6">subscript</csymbol><ci id="S3.E1.m1.4.4.6.2.cmml" xref="S3.E1.m1.4.4.6.2">ℒ</ci><ci id="S3.E1.m1.4.4.6.3.cmml" xref="S3.E1.m1.4.4.6.3">𝑢</ci></apply><apply id="S3.E1.m1.4.4.4.cmml" xref="S3.E1.m1.4.4.4"><plus id="S3.E1.m1.4.4.4.5.cmml" xref="S3.E1.m1.4.4.4.5"></plus><apply id="S3.E1.m1.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2"><times id="S3.E1.m1.2.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.2.3"></times><apply id="S3.E1.m1.2.2.2.2.4.cmml" xref="S3.E1.m1.2.2.2.2.4"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.4.1.cmml" xref="S3.E1.m1.2.2.2.2.4">subscript</csymbol><ci id="S3.E1.m1.2.2.2.2.4.2.cmml" xref="S3.E1.m1.2.2.2.2.4.2">ℒ</ci><apply id="S3.E1.m1.2.2.2.2.4.3.cmml" xref="S3.E1.m1.2.2.2.2.4.3"><times id="S3.E1.m1.2.2.2.2.4.3.1.cmml" xref="S3.E1.m1.2.2.2.2.4.3.1"></times><ci id="S3.E1.m1.2.2.2.2.4.3.2.cmml" xref="S3.E1.m1.2.2.2.2.4.3.2">𝑐</ci><ci id="S3.E1.m1.2.2.2.2.4.3.3.cmml" xref="S3.E1.m1.2.2.2.2.4.3.3">𝑙</ci><ci id="S3.E1.m1.2.2.2.2.4.3.4.cmml" xref="S3.E1.m1.2.2.2.2.4.3.4">𝑠</ci></apply></apply><interval closure="open" id="S3.E1.m1.2.2.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.2.2.2"><apply id="S3.E1.m1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1"><times id="S3.E1.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.3"></times><ci id="S3.E1.m1.1.1.1.1.1.1.1.4.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.4">𝑓</ci><interval closure="open" id="S3.E1.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.2.2"><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.3">𝑢</ci></apply><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3">𝑠</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.2.2.2.2">𝜃</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.2.2.2.3">𝑠</ci></apply></interval></apply><apply id="S3.E1.m1.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.2.2.2.1.cmml" xref="S3.E1.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E1.m1.2.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2.2.2.2.2">𝑦</ci><ci id="S3.E1.m1.2.2.2.2.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.2.2.2.2.3">𝑢</ci></apply></interval></apply><apply id="S3.E1.m1.4.4.4.4.cmml" xref="S3.E1.m1.4.4.4.4"><times id="S3.E1.m1.4.4.4.4.3.cmml" xref="S3.E1.m1.4.4.4.4.3"></times><apply id="S3.E1.m1.4.4.4.4.4.cmml" xref="S3.E1.m1.4.4.4.4.4"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.4.4.4.1.cmml" xref="S3.E1.m1.4.4.4.4.4">subscript</csymbol><ci id="S3.E1.m1.4.4.4.4.4.2.cmml" xref="S3.E1.m1.4.4.4.4.4.2">ℒ</ci><apply id="S3.E1.m1.4.4.4.4.4.3.cmml" xref="S3.E1.m1.4.4.4.4.4.3"><times id="S3.E1.m1.4.4.4.4.4.3.1.cmml" xref="S3.E1.m1.4.4.4.4.4.3.1"></times><ci id="S3.E1.m1.4.4.4.4.4.3.2.cmml" xref="S3.E1.m1.4.4.4.4.4.3.2">𝑟</ci><ci id="S3.E1.m1.4.4.4.4.4.3.3.cmml" xref="S3.E1.m1.4.4.4.4.4.3.3">𝑒</ci><ci id="S3.E1.m1.4.4.4.4.4.3.4.cmml" xref="S3.E1.m1.4.4.4.4.4.3.4">𝑔</ci></apply></apply><interval closure="open" id="S3.E1.m1.4.4.4.4.2.3.cmml" xref="S3.E1.m1.4.4.4.4.2.2"><apply id="S3.E1.m1.3.3.3.3.1.1.1.cmml" xref="S3.E1.m1.3.3.3.3.1.1.1"><times id="S3.E1.m1.3.3.3.3.1.1.1.3.cmml" xref="S3.E1.m1.3.3.3.3.1.1.1.3"></times><ci id="S3.E1.m1.3.3.3.3.1.1.1.4.cmml" xref="S3.E1.m1.3.3.3.3.1.1.1.4">𝑓</ci><interval closure="open" id="S3.E1.m1.3.3.3.3.1.1.1.2.3.cmml" xref="S3.E1.m1.3.3.3.3.1.1.1.2.2"><apply id="S3.E1.m1.3.3.3.3.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.3.3.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E1.m1.3.3.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.3.3.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.3.3.3.3.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.3.3.3.3.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S3.E1.m1.3.3.3.3.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.3.3.3.3.1.1.1.1.1.1.2.3">𝑢</ci></apply><ci id="S3.E1.m1.3.3.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.3.3.1.1.1.1.1.1.3">𝑠</ci></apply><apply id="S3.E1.m1.3.3.3.3.1.1.1.2.2.2.cmml" xref="S3.E1.m1.3.3.3.3.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.3.3.1.1.1.2.2.2.1.cmml" xref="S3.E1.m1.3.3.3.3.1.1.1.2.2.2">superscript</csymbol><ci id="S3.E1.m1.3.3.3.3.1.1.1.2.2.2.2.cmml" xref="S3.E1.m1.3.3.3.3.1.1.1.2.2.2.2">𝜃</ci><ci id="S3.E1.m1.3.3.3.3.1.1.1.2.2.2.3.cmml" xref="S3.E1.m1.3.3.3.3.1.1.1.2.2.2.3">𝑠</ci></apply></interval></apply><apply id="S3.E1.m1.4.4.4.4.2.2.2.cmml" xref="S3.E1.m1.4.4.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.4.4.2.2.2.1.cmml" xref="S3.E1.m1.4.4.4.4.2.2.2">subscript</csymbol><ci id="S3.E1.m1.4.4.4.4.2.2.2.2.cmml" xref="S3.E1.m1.4.4.4.4.2.2.2.2">𝑦</ci><ci id="S3.E1.m1.4.4.4.4.2.2.2.3.cmml" xref="S3.E1.m1.4.4.4.4.2.2.2.3">𝑢</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.4c">\vspace{-0.25em}\mathcal{L}_{u}=\mathcal{L}_{cls}(f(x_{u}^{s},\theta^{s}),y_{u})+\mathcal{L}_{reg}(f(x_{u}^{s},\theta^{s}),y_{u})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.11" class="ltx_p">where <math id="S3.SS2.p1.9.m1.1" class="ltx_Math" alttext="\mathcal{L}_{cls}" display="inline"><semantics id="S3.SS2.p1.9.m1.1a"><msub id="S3.SS2.p1.9.m1.1.1" xref="S3.SS2.p1.9.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.9.m1.1.1.2" xref="S3.SS2.p1.9.m1.1.1.2.cmml">ℒ</mi><mrow id="S3.SS2.p1.9.m1.1.1.3" xref="S3.SS2.p1.9.m1.1.1.3.cmml"><mi id="S3.SS2.p1.9.m1.1.1.3.2" xref="S3.SS2.p1.9.m1.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.9.m1.1.1.3.1" xref="S3.SS2.p1.9.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p1.9.m1.1.1.3.3" xref="S3.SS2.p1.9.m1.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.9.m1.1.1.3.1a" xref="S3.SS2.p1.9.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p1.9.m1.1.1.3.4" xref="S3.SS2.p1.9.m1.1.1.3.4.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m1.1b"><apply id="S3.SS2.p1.9.m1.1.1.cmml" xref="S3.SS2.p1.9.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m1.1.1.1.cmml" xref="S3.SS2.p1.9.m1.1.1">subscript</csymbol><ci id="S3.SS2.p1.9.m1.1.1.2.cmml" xref="S3.SS2.p1.9.m1.1.1.2">ℒ</ci><apply id="S3.SS2.p1.9.m1.1.1.3.cmml" xref="S3.SS2.p1.9.m1.1.1.3"><times id="S3.SS2.p1.9.m1.1.1.3.1.cmml" xref="S3.SS2.p1.9.m1.1.1.3.1"></times><ci id="S3.SS2.p1.9.m1.1.1.3.2.cmml" xref="S3.SS2.p1.9.m1.1.1.3.2">𝑐</ci><ci id="S3.SS2.p1.9.m1.1.1.3.3.cmml" xref="S3.SS2.p1.9.m1.1.1.3.3">𝑙</ci><ci id="S3.SS2.p1.9.m1.1.1.3.4.cmml" xref="S3.SS2.p1.9.m1.1.1.3.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m1.1c">\mathcal{L}_{cls}</annotation></semantics></math> is the classification loss of the object detector, and <math id="S3.SS2.p1.10.m2.1" class="ltx_Math" alttext="\mathcal{L}_{reg}" display="inline"><semantics id="S3.SS2.p1.10.m2.1a"><msub id="S3.SS2.p1.10.m2.1.1" xref="S3.SS2.p1.10.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.10.m2.1.1.2" xref="S3.SS2.p1.10.m2.1.1.2.cmml">ℒ</mi><mrow id="S3.SS2.p1.10.m2.1.1.3" xref="S3.SS2.p1.10.m2.1.1.3.cmml"><mi id="S3.SS2.p1.10.m2.1.1.3.2" xref="S3.SS2.p1.10.m2.1.1.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.10.m2.1.1.3.1" xref="S3.SS2.p1.10.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p1.10.m2.1.1.3.3" xref="S3.SS2.p1.10.m2.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.10.m2.1.1.3.1a" xref="S3.SS2.p1.10.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p1.10.m2.1.1.3.4" xref="S3.SS2.p1.10.m2.1.1.3.4.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.m2.1b"><apply id="S3.SS2.p1.10.m2.1.1.cmml" xref="S3.SS2.p1.10.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.10.m2.1.1.1.cmml" xref="S3.SS2.p1.10.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.10.m2.1.1.2.cmml" xref="S3.SS2.p1.10.m2.1.1.2">ℒ</ci><apply id="S3.SS2.p1.10.m2.1.1.3.cmml" xref="S3.SS2.p1.10.m2.1.1.3"><times id="S3.SS2.p1.10.m2.1.1.3.1.cmml" xref="S3.SS2.p1.10.m2.1.1.3.1"></times><ci id="S3.SS2.p1.10.m2.1.1.3.2.cmml" xref="S3.SS2.p1.10.m2.1.1.3.2">𝑟</ci><ci id="S3.SS2.p1.10.m2.1.1.3.3.cmml" xref="S3.SS2.p1.10.m2.1.1.3.3">𝑒</ci><ci id="S3.SS2.p1.10.m2.1.1.3.4.cmml" xref="S3.SS2.p1.10.m2.1.1.3.4">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.10.m2.1c">\mathcal{L}_{reg}</annotation></semantics></math> is the box regression loss. A standard supervised loss of the same form is calculated using a labelled sample <math id="S3.SS2.p1.11.m3.2" class="ltx_Math" alttext="(x_{l},y_{l})" display="inline"><semantics id="S3.SS2.p1.11.m3.2a"><mrow id="S3.SS2.p1.11.m3.2.2.2" xref="S3.SS2.p1.11.m3.2.2.3.cmml"><mo stretchy="false" id="S3.SS2.p1.11.m3.2.2.2.3" xref="S3.SS2.p1.11.m3.2.2.3.cmml">(</mo><msub id="S3.SS2.p1.11.m3.1.1.1.1" xref="S3.SS2.p1.11.m3.1.1.1.1.cmml"><mi id="S3.SS2.p1.11.m3.1.1.1.1.2" xref="S3.SS2.p1.11.m3.1.1.1.1.2.cmml">x</mi><mi id="S3.SS2.p1.11.m3.1.1.1.1.3" xref="S3.SS2.p1.11.m3.1.1.1.1.3.cmml">l</mi></msub><mo id="S3.SS2.p1.11.m3.2.2.2.4" xref="S3.SS2.p1.11.m3.2.2.3.cmml">,</mo><msub id="S3.SS2.p1.11.m3.2.2.2.2" xref="S3.SS2.p1.11.m3.2.2.2.2.cmml"><mi id="S3.SS2.p1.11.m3.2.2.2.2.2" xref="S3.SS2.p1.11.m3.2.2.2.2.2.cmml">y</mi><mi id="S3.SS2.p1.11.m3.2.2.2.2.3" xref="S3.SS2.p1.11.m3.2.2.2.2.3.cmml">l</mi></msub><mo stretchy="false" id="S3.SS2.p1.11.m3.2.2.2.5" xref="S3.SS2.p1.11.m3.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.11.m3.2b"><interval closure="open" id="S3.SS2.p1.11.m3.2.2.3.cmml" xref="S3.SS2.p1.11.m3.2.2.2"><apply id="S3.SS2.p1.11.m3.1.1.1.1.cmml" xref="S3.SS2.p1.11.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.11.m3.1.1.1.1.1.cmml" xref="S3.SS2.p1.11.m3.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.11.m3.1.1.1.1.2.cmml" xref="S3.SS2.p1.11.m3.1.1.1.1.2">𝑥</ci><ci id="S3.SS2.p1.11.m3.1.1.1.1.3.cmml" xref="S3.SS2.p1.11.m3.1.1.1.1.3">𝑙</ci></apply><apply id="S3.SS2.p1.11.m3.2.2.2.2.cmml" xref="S3.SS2.p1.11.m3.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.11.m3.2.2.2.2.1.cmml" xref="S3.SS2.p1.11.m3.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p1.11.m3.2.2.2.2.2.cmml" xref="S3.SS2.p1.11.m3.2.2.2.2.2">𝑦</ci><ci id="S3.SS2.p1.11.m3.2.2.2.2.3.cmml" xref="S3.SS2.p1.11.m3.2.2.2.2.3">𝑙</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.11.m3.2c">(x_{l},y_{l})</annotation></semantics></math> from the source domain:</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.4" class="ltx_Math" alttext="\vspace{-0.25em}\mathcal{L}_{l}=\mathcal{L}_{cls}(f(x_{l}^{s},\theta^{s}),y_{l})+\mathcal{L}_{reg}(f(x_{l}^{s},\theta^{s}),y_{l})" display="block"><semantics id="S3.E2.m1.4a"><mrow id="S3.E2.m1.4.4" xref="S3.E2.m1.4.4.cmml"><msub id="S3.E2.m1.4.4.6" xref="S3.E2.m1.4.4.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.4.4.6.2" xref="S3.E2.m1.4.4.6.2.cmml">ℒ</mi><mi id="S3.E2.m1.4.4.6.3" xref="S3.E2.m1.4.4.6.3.cmml">l</mi></msub><mo id="S3.E2.m1.4.4.5" xref="S3.E2.m1.4.4.5.cmml">=</mo><mrow id="S3.E2.m1.4.4.4" xref="S3.E2.m1.4.4.4.cmml"><mrow id="S3.E2.m1.2.2.2.2" xref="S3.E2.m1.2.2.2.2.cmml"><msub id="S3.E2.m1.2.2.2.2.4" xref="S3.E2.m1.2.2.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.2.2.2.2.4.2" xref="S3.E2.m1.2.2.2.2.4.2.cmml">ℒ</mi><mrow id="S3.E2.m1.2.2.2.2.4.3" xref="S3.E2.m1.2.2.2.2.4.3.cmml"><mi id="S3.E2.m1.2.2.2.2.4.3.2" xref="S3.E2.m1.2.2.2.2.4.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.2.4.3.1" xref="S3.E2.m1.2.2.2.2.4.3.1.cmml">​</mo><mi id="S3.E2.m1.2.2.2.2.4.3.3" xref="S3.E2.m1.2.2.2.2.4.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.2.4.3.1a" xref="S3.E2.m1.2.2.2.2.4.3.1.cmml">​</mo><mi id="S3.E2.m1.2.2.2.2.4.3.4" xref="S3.E2.m1.2.2.2.2.4.3.4.cmml">s</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.2.3" xref="S3.E2.m1.2.2.2.2.3.cmml">​</mo><mrow id="S3.E2.m1.2.2.2.2.2.2" xref="S3.E2.m1.2.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.E2.m1.2.2.2.2.2.2.3" xref="S3.E2.m1.2.2.2.2.2.3.cmml">(</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.4" xref="S3.E2.m1.1.1.1.1.1.1.1.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.3.cmml">​</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.1.2.2" xref="S3.E2.m1.1.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.1.1.2.2.3" xref="S3.E2.m1.1.1.1.1.1.1.1.2.3.cmml">(</mo><msubsup id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">l</mi><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">s</mi></msubsup><mo id="S3.E2.m1.1.1.1.1.1.1.1.2.2.4" xref="S3.E2.m1.1.1.1.1.1.1.1.2.3.cmml">,</mo><msup id="S3.E2.m1.1.1.1.1.1.1.1.2.2.2" xref="S3.E2.m1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E2.m1.1.1.1.1.1.1.1.2.2.2.2.cmml">θ</mi><mi id="S3.E2.m1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E2.m1.1.1.1.1.1.1.1.2.2.2.3.cmml">s</mi></msup><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.1.1.2.2.5" xref="S3.E2.m1.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.2.2.2.2.2.2.4" xref="S3.E2.m1.2.2.2.2.2.3.cmml">,</mo><msub id="S3.E2.m1.2.2.2.2.2.2.2" xref="S3.E2.m1.2.2.2.2.2.2.2.cmml"><mi id="S3.E2.m1.2.2.2.2.2.2.2.2" xref="S3.E2.m1.2.2.2.2.2.2.2.2.cmml">y</mi><mi id="S3.E2.m1.2.2.2.2.2.2.2.3" xref="S3.E2.m1.2.2.2.2.2.2.2.3.cmml">l</mi></msub><mo stretchy="false" id="S3.E2.m1.2.2.2.2.2.2.5" xref="S3.E2.m1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.4.4.4.5" xref="S3.E2.m1.4.4.4.5.cmml">+</mo><mrow id="S3.E2.m1.4.4.4.4" xref="S3.E2.m1.4.4.4.4.cmml"><msub id="S3.E2.m1.4.4.4.4.4" xref="S3.E2.m1.4.4.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.4.4.4.4.4.2" xref="S3.E2.m1.4.4.4.4.4.2.cmml">ℒ</mi><mrow id="S3.E2.m1.4.4.4.4.4.3" xref="S3.E2.m1.4.4.4.4.4.3.cmml"><mi id="S3.E2.m1.4.4.4.4.4.3.2" xref="S3.E2.m1.4.4.4.4.4.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.4.4.4.4.4.3.1" xref="S3.E2.m1.4.4.4.4.4.3.1.cmml">​</mo><mi id="S3.E2.m1.4.4.4.4.4.3.3" xref="S3.E2.m1.4.4.4.4.4.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.4.4.4.4.4.3.1a" xref="S3.E2.m1.4.4.4.4.4.3.1.cmml">​</mo><mi id="S3.E2.m1.4.4.4.4.4.3.4" xref="S3.E2.m1.4.4.4.4.4.3.4.cmml">g</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.4.4.4.4.3" xref="S3.E2.m1.4.4.4.4.3.cmml">​</mo><mrow id="S3.E2.m1.4.4.4.4.2.2" xref="S3.E2.m1.4.4.4.4.2.3.cmml"><mo stretchy="false" id="S3.E2.m1.4.4.4.4.2.2.3" xref="S3.E2.m1.4.4.4.4.2.3.cmml">(</mo><mrow id="S3.E2.m1.3.3.3.3.1.1.1" xref="S3.E2.m1.3.3.3.3.1.1.1.cmml"><mi id="S3.E2.m1.3.3.3.3.1.1.1.4" xref="S3.E2.m1.3.3.3.3.1.1.1.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.3.3.3.1.1.1.3" xref="S3.E2.m1.3.3.3.3.1.1.1.3.cmml">​</mo><mrow id="S3.E2.m1.3.3.3.3.1.1.1.2.2" xref="S3.E2.m1.3.3.3.3.1.1.1.2.3.cmml"><mo stretchy="false" id="S3.E2.m1.3.3.3.3.1.1.1.2.2.3" xref="S3.E2.m1.3.3.3.3.1.1.1.2.3.cmml">(</mo><msubsup id="S3.E2.m1.3.3.3.3.1.1.1.1.1.1" xref="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.2.2" xref="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.2.3" xref="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.2.3.cmml">l</mi><mi id="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.3" xref="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.3.cmml">s</mi></msubsup><mo id="S3.E2.m1.3.3.3.3.1.1.1.2.2.4" xref="S3.E2.m1.3.3.3.3.1.1.1.2.3.cmml">,</mo><msup id="S3.E2.m1.3.3.3.3.1.1.1.2.2.2" xref="S3.E2.m1.3.3.3.3.1.1.1.2.2.2.cmml"><mi id="S3.E2.m1.3.3.3.3.1.1.1.2.2.2.2" xref="S3.E2.m1.3.3.3.3.1.1.1.2.2.2.2.cmml">θ</mi><mi id="S3.E2.m1.3.3.3.3.1.1.1.2.2.2.3" xref="S3.E2.m1.3.3.3.3.1.1.1.2.2.2.3.cmml">s</mi></msup><mo stretchy="false" id="S3.E2.m1.3.3.3.3.1.1.1.2.2.5" xref="S3.E2.m1.3.3.3.3.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.4.4.4.4.2.2.4" xref="S3.E2.m1.4.4.4.4.2.3.cmml">,</mo><msub id="S3.E2.m1.4.4.4.4.2.2.2" xref="S3.E2.m1.4.4.4.4.2.2.2.cmml"><mi id="S3.E2.m1.4.4.4.4.2.2.2.2" xref="S3.E2.m1.4.4.4.4.2.2.2.2.cmml">y</mi><mi id="S3.E2.m1.4.4.4.4.2.2.2.3" xref="S3.E2.m1.4.4.4.4.2.2.2.3.cmml">l</mi></msub><mo stretchy="false" id="S3.E2.m1.4.4.4.4.2.2.5" xref="S3.E2.m1.4.4.4.4.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.4b"><apply id="S3.E2.m1.4.4.cmml" xref="S3.E2.m1.4.4"><eq id="S3.E2.m1.4.4.5.cmml" xref="S3.E2.m1.4.4.5"></eq><apply id="S3.E2.m1.4.4.6.cmml" xref="S3.E2.m1.4.4.6"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.6.1.cmml" xref="S3.E2.m1.4.4.6">subscript</csymbol><ci id="S3.E2.m1.4.4.6.2.cmml" xref="S3.E2.m1.4.4.6.2">ℒ</ci><ci id="S3.E2.m1.4.4.6.3.cmml" xref="S3.E2.m1.4.4.6.3">𝑙</ci></apply><apply id="S3.E2.m1.4.4.4.cmml" xref="S3.E2.m1.4.4.4"><plus id="S3.E2.m1.4.4.4.5.cmml" xref="S3.E2.m1.4.4.4.5"></plus><apply id="S3.E2.m1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2"><times id="S3.E2.m1.2.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2.3"></times><apply id="S3.E2.m1.2.2.2.2.4.cmml" xref="S3.E2.m1.2.2.2.2.4"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.4.1.cmml" xref="S3.E2.m1.2.2.2.2.4">subscript</csymbol><ci id="S3.E2.m1.2.2.2.2.4.2.cmml" xref="S3.E2.m1.2.2.2.2.4.2">ℒ</ci><apply id="S3.E2.m1.2.2.2.2.4.3.cmml" xref="S3.E2.m1.2.2.2.2.4.3"><times id="S3.E2.m1.2.2.2.2.4.3.1.cmml" xref="S3.E2.m1.2.2.2.2.4.3.1"></times><ci id="S3.E2.m1.2.2.2.2.4.3.2.cmml" xref="S3.E2.m1.2.2.2.2.4.3.2">𝑐</ci><ci id="S3.E2.m1.2.2.2.2.4.3.3.cmml" xref="S3.E2.m1.2.2.2.2.4.3.3">𝑙</ci><ci id="S3.E2.m1.2.2.2.2.4.3.4.cmml" xref="S3.E2.m1.2.2.2.2.4.3.4">𝑠</ci></apply></apply><interval closure="open" id="S3.E2.m1.2.2.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2.2.2"><apply id="S3.E2.m1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1"><times id="S3.E2.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.3"></times><ci id="S3.E2.m1.1.1.1.1.1.1.1.4.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.4">𝑓</ci><interval closure="open" id="S3.E2.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2.2"><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.3">𝑙</ci></apply><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3">𝑠</ci></apply><apply id="S3.E2.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2.2.2.2">𝜃</ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2.2.2.3">𝑠</ci></apply></interval></apply><apply id="S3.E2.m1.2.2.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.2.2.2.1.cmml" xref="S3.E2.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E2.m1.2.2.2.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2.2.2">𝑦</ci><ci id="S3.E2.m1.2.2.2.2.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2.2.2.2.3">𝑙</ci></apply></interval></apply><apply id="S3.E2.m1.4.4.4.4.cmml" xref="S3.E2.m1.4.4.4.4"><times id="S3.E2.m1.4.4.4.4.3.cmml" xref="S3.E2.m1.4.4.4.4.3"></times><apply id="S3.E2.m1.4.4.4.4.4.cmml" xref="S3.E2.m1.4.4.4.4.4"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.4.4.4.1.cmml" xref="S3.E2.m1.4.4.4.4.4">subscript</csymbol><ci id="S3.E2.m1.4.4.4.4.4.2.cmml" xref="S3.E2.m1.4.4.4.4.4.2">ℒ</ci><apply id="S3.E2.m1.4.4.4.4.4.3.cmml" xref="S3.E2.m1.4.4.4.4.4.3"><times id="S3.E2.m1.4.4.4.4.4.3.1.cmml" xref="S3.E2.m1.4.4.4.4.4.3.1"></times><ci id="S3.E2.m1.4.4.4.4.4.3.2.cmml" xref="S3.E2.m1.4.4.4.4.4.3.2">𝑟</ci><ci id="S3.E2.m1.4.4.4.4.4.3.3.cmml" xref="S3.E2.m1.4.4.4.4.4.3.3">𝑒</ci><ci id="S3.E2.m1.4.4.4.4.4.3.4.cmml" xref="S3.E2.m1.4.4.4.4.4.3.4">𝑔</ci></apply></apply><interval closure="open" id="S3.E2.m1.4.4.4.4.2.3.cmml" xref="S3.E2.m1.4.4.4.4.2.2"><apply id="S3.E2.m1.3.3.3.3.1.1.1.cmml" xref="S3.E2.m1.3.3.3.3.1.1.1"><times id="S3.E2.m1.3.3.3.3.1.1.1.3.cmml" xref="S3.E2.m1.3.3.3.3.1.1.1.3"></times><ci id="S3.E2.m1.3.3.3.3.1.1.1.4.cmml" xref="S3.E2.m1.3.3.3.3.1.1.1.4">𝑓</ci><interval closure="open" id="S3.E2.m1.3.3.3.3.1.1.1.2.3.cmml" xref="S3.E2.m1.3.3.3.3.1.1.1.2.2"><apply id="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.3.3.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.3.3.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.3.3.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.2.3">𝑙</ci></apply><ci id="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.3">𝑠</ci></apply><apply id="S3.E2.m1.3.3.3.3.1.1.1.2.2.2.cmml" xref="S3.E2.m1.3.3.3.3.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.3.3.1.1.1.2.2.2.1.cmml" xref="S3.E2.m1.3.3.3.3.1.1.1.2.2.2">superscript</csymbol><ci id="S3.E2.m1.3.3.3.3.1.1.1.2.2.2.2.cmml" xref="S3.E2.m1.3.3.3.3.1.1.1.2.2.2.2">𝜃</ci><ci id="S3.E2.m1.3.3.3.3.1.1.1.2.2.2.3.cmml" xref="S3.E2.m1.3.3.3.3.1.1.1.2.2.2.3">𝑠</ci></apply></interval></apply><apply id="S3.E2.m1.4.4.4.4.2.2.2.cmml" xref="S3.E2.m1.4.4.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.4.4.2.2.2.1.cmml" xref="S3.E2.m1.4.4.4.4.2.2.2">subscript</csymbol><ci id="S3.E2.m1.4.4.4.4.2.2.2.2.cmml" xref="S3.E2.m1.4.4.4.4.2.2.2.2">𝑦</ci><ci id="S3.E2.m1.4.4.4.4.2.2.2.3.cmml" xref="S3.E2.m1.4.4.4.4.2.2.2.3">𝑙</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.4c">\vspace{-0.25em}\mathcal{L}_{l}=\mathcal{L}_{cls}(f(x_{l}^{s},\theta^{s}),y_{l})+\mathcal{L}_{reg}(f(x_{l}^{s},\theta^{s}),y_{l})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.14" class="ltx_p">The overall loss for a batch containing both labelled and unlabelled samples is then calculated as:</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.1" class="ltx_Math" alttext="\vspace{-0.25em}\mathcal{L}=\mathcal{L}_{l}+\lambda\mathcal{L}_{u}" display="block"><semantics id="S3.E3.m1.1a"><mrow id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.1.1.2" xref="S3.E3.m1.1.1.2.cmml">ℒ</mi><mo id="S3.E3.m1.1.1.1" xref="S3.E3.m1.1.1.1.cmml">=</mo><mrow id="S3.E3.m1.1.1.3" xref="S3.E3.m1.1.1.3.cmml"><msub id="S3.E3.m1.1.1.3.2" xref="S3.E3.m1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.1.1.3.2.2" xref="S3.E3.m1.1.1.3.2.2.cmml">ℒ</mi><mi id="S3.E3.m1.1.1.3.2.3" xref="S3.E3.m1.1.1.3.2.3.cmml">l</mi></msub><mo id="S3.E3.m1.1.1.3.1" xref="S3.E3.m1.1.1.3.1.cmml">+</mo><mrow id="S3.E3.m1.1.1.3.3" xref="S3.E3.m1.1.1.3.3.cmml"><mi id="S3.E3.m1.1.1.3.3.2" xref="S3.E3.m1.1.1.3.3.2.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.3.3.1" xref="S3.E3.m1.1.1.3.3.1.cmml">​</mo><msub id="S3.E3.m1.1.1.3.3.3" xref="S3.E3.m1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.1.1.3.3.3.2" xref="S3.E3.m1.1.1.3.3.3.2.cmml">ℒ</mi><mi id="S3.E3.m1.1.1.3.3.3.3" xref="S3.E3.m1.1.1.3.3.3.3.cmml">u</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.1b"><apply id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1"><eq id="S3.E3.m1.1.1.1.cmml" xref="S3.E3.m1.1.1.1"></eq><ci id="S3.E3.m1.1.1.2.cmml" xref="S3.E3.m1.1.1.2">ℒ</ci><apply id="S3.E3.m1.1.1.3.cmml" xref="S3.E3.m1.1.1.3"><plus id="S3.E3.m1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.3.1"></plus><apply id="S3.E3.m1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.3.2.1.cmml" xref="S3.E3.m1.1.1.3.2">subscript</csymbol><ci id="S3.E3.m1.1.1.3.2.2.cmml" xref="S3.E3.m1.1.1.3.2.2">ℒ</ci><ci id="S3.E3.m1.1.1.3.2.3.cmml" xref="S3.E3.m1.1.1.3.2.3">𝑙</ci></apply><apply id="S3.E3.m1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.3.3"><times id="S3.E3.m1.1.1.3.3.1.cmml" xref="S3.E3.m1.1.1.3.3.1"></times><ci id="S3.E3.m1.1.1.3.3.2.cmml" xref="S3.E3.m1.1.1.3.3.2">𝜆</ci><apply id="S3.E3.m1.1.1.3.3.3.cmml" xref="S3.E3.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.3.3.3.1.cmml" xref="S3.E3.m1.1.1.3.3.3">subscript</csymbol><ci id="S3.E3.m1.1.1.3.3.3.2.cmml" xref="S3.E3.m1.1.1.3.3.3.2">ℒ</ci><ci id="S3.E3.m1.1.1.3.3.3.3.cmml" xref="S3.E3.m1.1.1.3.3.3.3">𝑢</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.1c">\vspace{-0.25em}\mathcal{L}=\mathcal{L}_{l}+\lambda\mathcal{L}_{u}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.12" class="ltx_p">where <math id="S3.SS2.p1.12.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S3.SS2.p1.12.m1.1a"><mi id="S3.SS2.p1.12.m1.1.1" xref="S3.SS2.p1.12.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.12.m1.1b"><ci id="S3.SS2.p1.12.m1.1.1.cmml" xref="S3.SS2.p1.12.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.12.m1.1c">\lambda</annotation></semantics></math> is a hyperparameter to weight the unsupervised loss.
This loss is used to update the student via gradient descent, and the exponential moving average (EMA) of the student’s weights are used to update the teacher model. That is, after each training iteration <span id="S3.SS2.p1.12.1" class="ltx_text ltx_font_italic">t</span> the weights of the teacher model are calculated as:</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.1" class="ltx_Math" alttext="\vspace{-0.25em}\theta_{t}^{t}=\alpha\theta_{t-1}^{t}+(1-\alpha)\theta_{s}" display="block"><semantics id="S3.E4.m1.1a"><mrow id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml"><msubsup id="S3.E4.m1.1.1.3" xref="S3.E4.m1.1.1.3.cmml"><mi id="S3.E4.m1.1.1.3.2.2" xref="S3.E4.m1.1.1.3.2.2.cmml">θ</mi><mi id="S3.E4.m1.1.1.3.2.3" xref="S3.E4.m1.1.1.3.2.3.cmml">t</mi><mi id="S3.E4.m1.1.1.3.3" xref="S3.E4.m1.1.1.3.3.cmml">t</mi></msubsup><mo id="S3.E4.m1.1.1.2" xref="S3.E4.m1.1.1.2.cmml">=</mo><mrow id="S3.E4.m1.1.1.1" xref="S3.E4.m1.1.1.1.cmml"><mrow id="S3.E4.m1.1.1.1.3" xref="S3.E4.m1.1.1.1.3.cmml"><mi id="S3.E4.m1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.3.2.cmml">α</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.1.3.1" xref="S3.E4.m1.1.1.1.3.1.cmml">​</mo><msubsup id="S3.E4.m1.1.1.1.3.3" xref="S3.E4.m1.1.1.1.3.3.cmml"><mi id="S3.E4.m1.1.1.1.3.3.2.2" xref="S3.E4.m1.1.1.1.3.3.2.2.cmml">θ</mi><mrow id="S3.E4.m1.1.1.1.3.3.2.3" xref="S3.E4.m1.1.1.1.3.3.2.3.cmml"><mi id="S3.E4.m1.1.1.1.3.3.2.3.2" xref="S3.E4.m1.1.1.1.3.3.2.3.2.cmml">t</mi><mo id="S3.E4.m1.1.1.1.3.3.2.3.1" xref="S3.E4.m1.1.1.1.3.3.2.3.1.cmml">−</mo><mn id="S3.E4.m1.1.1.1.3.3.2.3.3" xref="S3.E4.m1.1.1.1.3.3.2.3.3.cmml">1</mn></mrow><mi id="S3.E4.m1.1.1.1.3.3.3" xref="S3.E4.m1.1.1.1.3.3.3.cmml">t</mi></msubsup></mrow><mo id="S3.E4.m1.1.1.1.2" xref="S3.E4.m1.1.1.1.2.cmml">+</mo><mrow id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml"><mrow id="S3.E4.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.cmml"><mn id="S3.E4.m1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E4.m1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E4.m1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.1.3.cmml">α</mi></mrow><mo stretchy="false" id="S3.E4.m1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.2.cmml">​</mo><msub id="S3.E4.m1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.1.3.2.cmml">θ</mi><mi id="S3.E4.m1.1.1.1.1.3.3" xref="S3.E4.m1.1.1.1.1.3.3.cmml">s</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.1b"><apply id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1"><eq id="S3.E4.m1.1.1.2.cmml" xref="S3.E4.m1.1.1.2"></eq><apply id="S3.E4.m1.1.1.3.cmml" xref="S3.E4.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.3">superscript</csymbol><apply id="S3.E4.m1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.3.2.1.cmml" xref="S3.E4.m1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.1.1.3.2.2.cmml" xref="S3.E4.m1.1.1.3.2.2">𝜃</ci><ci id="S3.E4.m1.1.1.3.2.3.cmml" xref="S3.E4.m1.1.1.3.2.3">𝑡</ci></apply><ci id="S3.E4.m1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.3.3">𝑡</ci></apply><apply id="S3.E4.m1.1.1.1.cmml" xref="S3.E4.m1.1.1.1"><plus id="S3.E4.m1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.2"></plus><apply id="S3.E4.m1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.3"><times id="S3.E4.m1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.3.1"></times><ci id="S3.E4.m1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.3.2">𝛼</ci><apply id="S3.E4.m1.1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.3.3.1.cmml" xref="S3.E4.m1.1.1.1.3.3">superscript</csymbol><apply id="S3.E4.m1.1.1.1.3.3.2.cmml" xref="S3.E4.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.3.3.2.1.cmml" xref="S3.E4.m1.1.1.1.3.3">subscript</csymbol><ci id="S3.E4.m1.1.1.1.3.3.2.2.cmml" xref="S3.E4.m1.1.1.1.3.3.2.2">𝜃</ci><apply id="S3.E4.m1.1.1.1.3.3.2.3.cmml" xref="S3.E4.m1.1.1.1.3.3.2.3"><minus id="S3.E4.m1.1.1.1.3.3.2.3.1.cmml" xref="S3.E4.m1.1.1.1.3.3.2.3.1"></minus><ci id="S3.E4.m1.1.1.1.3.3.2.3.2.cmml" xref="S3.E4.m1.1.1.1.3.3.2.3.2">𝑡</ci><cn type="integer" id="S3.E4.m1.1.1.1.3.3.2.3.3.cmml" xref="S3.E4.m1.1.1.1.3.3.2.3.3">1</cn></apply></apply><ci id="S3.E4.m1.1.1.1.3.3.3.cmml" xref="S3.E4.m1.1.1.1.3.3.3">𝑡</ci></apply></apply><apply id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1"><times id="S3.E4.m1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.2"></times><apply id="S3.E4.m1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1"><minus id="S3.E4.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S3.E4.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.2">1</cn><ci id="S3.E4.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.3">𝛼</ci></apply><apply id="S3.E4.m1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.1.3.2">𝜃</ci><ci id="S3.E4.m1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.1.1.3.3">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.1c">\vspace{-0.25em}\theta_{t}^{t}=\alpha\theta_{t-1}^{t}+(1-\alpha)\theta_{s}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.13" class="ltx_p">where <math id="S3.SS2.p1.13.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS2.p1.13.m1.1a"><mi id="S3.SS2.p1.13.m1.1.1" xref="S3.SS2.p1.13.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.13.m1.1b"><ci id="S3.SS2.p1.13.m1.1.1.cmml" xref="S3.SS2.p1.13.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.13.m1.1c">\alpha</annotation></semantics></math> controls the stability of the teacher model.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS3.5.1.1" class="ltx_text">III-C</span> </span><span id="S3.SS3.6.2" class="ltx_text ltx_font_italic">Adaptive Label Distribution-aware Confidence Thresholding (ACT)</span>
</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.3" class="ltx_p">ACT aims to select confidence thresholds for Mean Teacher to overcome the class imbalance problem. It does so by aligning the class distribution of the pseudo-labels with that of the labelled data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. The method firstly calculates the class ratio of the labelled data <math id="S3.SS3.p1.1.m1.3" class="ltx_Math" alttext="\bm{r^{l}}=[r^{l}_{1},...,r^{l}_{n_{c}}]" display="inline"><semantics id="S3.SS3.p1.1.m1.3a"><mrow id="S3.SS3.p1.1.m1.3.3" xref="S3.SS3.p1.1.m1.3.3.cmml"><msup id="S3.SS3.p1.1.m1.3.3.4" xref="S3.SS3.p1.1.m1.3.3.4.cmml"><mi id="S3.SS3.p1.1.m1.3.3.4.2" xref="S3.SS3.p1.1.m1.3.3.4.2.cmml">𝒓</mi><mi id="S3.SS3.p1.1.m1.3.3.4.3" xref="S3.SS3.p1.1.m1.3.3.4.3.cmml">𝒍</mi></msup><mo id="S3.SS3.p1.1.m1.3.3.3" xref="S3.SS3.p1.1.m1.3.3.3.cmml">=</mo><mrow id="S3.SS3.p1.1.m1.3.3.2.2" xref="S3.SS3.p1.1.m1.3.3.2.3.cmml"><mo stretchy="false" id="S3.SS3.p1.1.m1.3.3.2.2.3" xref="S3.SS3.p1.1.m1.3.3.2.3.cmml">[</mo><msubsup id="S3.SS3.p1.1.m1.2.2.1.1.1" xref="S3.SS3.p1.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS3.p1.1.m1.2.2.1.1.1.2.2" xref="S3.SS3.p1.1.m1.2.2.1.1.1.2.2.cmml">r</mi><mn id="S3.SS3.p1.1.m1.2.2.1.1.1.3" xref="S3.SS3.p1.1.m1.2.2.1.1.1.3.cmml">1</mn><mi id="S3.SS3.p1.1.m1.2.2.1.1.1.2.3" xref="S3.SS3.p1.1.m1.2.2.1.1.1.2.3.cmml">l</mi></msubsup><mo id="S3.SS3.p1.1.m1.3.3.2.2.4" xref="S3.SS3.p1.1.m1.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">…</mi><mo id="S3.SS3.p1.1.m1.3.3.2.2.5" xref="S3.SS3.p1.1.m1.3.3.2.3.cmml">,</mo><msubsup id="S3.SS3.p1.1.m1.3.3.2.2.2" xref="S3.SS3.p1.1.m1.3.3.2.2.2.cmml"><mi id="S3.SS3.p1.1.m1.3.3.2.2.2.2.2" xref="S3.SS3.p1.1.m1.3.3.2.2.2.2.2.cmml">r</mi><msub id="S3.SS3.p1.1.m1.3.3.2.2.2.3" xref="S3.SS3.p1.1.m1.3.3.2.2.2.3.cmml"><mi id="S3.SS3.p1.1.m1.3.3.2.2.2.3.2" xref="S3.SS3.p1.1.m1.3.3.2.2.2.3.2.cmml">n</mi><mi id="S3.SS3.p1.1.m1.3.3.2.2.2.3.3" xref="S3.SS3.p1.1.m1.3.3.2.2.2.3.3.cmml">c</mi></msub><mi id="S3.SS3.p1.1.m1.3.3.2.2.2.2.3" xref="S3.SS3.p1.1.m1.3.3.2.2.2.2.3.cmml">l</mi></msubsup><mo stretchy="false" id="S3.SS3.p1.1.m1.3.3.2.2.6" xref="S3.SS3.p1.1.m1.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.3b"><apply id="S3.SS3.p1.1.m1.3.3.cmml" xref="S3.SS3.p1.1.m1.3.3"><eq id="S3.SS3.p1.1.m1.3.3.3.cmml" xref="S3.SS3.p1.1.m1.3.3.3"></eq><apply id="S3.SS3.p1.1.m1.3.3.4.cmml" xref="S3.SS3.p1.1.m1.3.3.4"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.3.3.4.1.cmml" xref="S3.SS3.p1.1.m1.3.3.4">superscript</csymbol><ci id="S3.SS3.p1.1.m1.3.3.4.2.cmml" xref="S3.SS3.p1.1.m1.3.3.4.2">𝒓</ci><ci id="S3.SS3.p1.1.m1.3.3.4.3.cmml" xref="S3.SS3.p1.1.m1.3.3.4.3">𝒍</ci></apply><list id="S3.SS3.p1.1.m1.3.3.2.3.cmml" xref="S3.SS3.p1.1.m1.3.3.2.2"><apply id="S3.SS3.p1.1.m1.2.2.1.1.1.cmml" xref="S3.SS3.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.2.2.1.1.1">subscript</csymbol><apply id="S3.SS3.p1.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.2.2.1.1.1.2.1.cmml" xref="S3.SS3.p1.1.m1.2.2.1.1.1">superscript</csymbol><ci id="S3.SS3.p1.1.m1.2.2.1.1.1.2.2.cmml" xref="S3.SS3.p1.1.m1.2.2.1.1.1.2.2">𝑟</ci><ci id="S3.SS3.p1.1.m1.2.2.1.1.1.2.3.cmml" xref="S3.SS3.p1.1.m1.2.2.1.1.1.2.3">𝑙</ci></apply><cn type="integer" id="S3.SS3.p1.1.m1.2.2.1.1.1.3.cmml" xref="S3.SS3.p1.1.m1.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">…</ci><apply id="S3.SS3.p1.1.m1.3.3.2.2.2.cmml" xref="S3.SS3.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS3.p1.1.m1.3.3.2.2.2">subscript</csymbol><apply id="S3.SS3.p1.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS3.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.3.3.2.2.2.2.1.cmml" xref="S3.SS3.p1.1.m1.3.3.2.2.2">superscript</csymbol><ci id="S3.SS3.p1.1.m1.3.3.2.2.2.2.2.cmml" xref="S3.SS3.p1.1.m1.3.3.2.2.2.2.2">𝑟</ci><ci id="S3.SS3.p1.1.m1.3.3.2.2.2.2.3.cmml" xref="S3.SS3.p1.1.m1.3.3.2.2.2.2.3">𝑙</ci></apply><apply id="S3.SS3.p1.1.m1.3.3.2.2.2.3.cmml" xref="S3.SS3.p1.1.m1.3.3.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.3.3.2.2.2.3.1.cmml" xref="S3.SS3.p1.1.m1.3.3.2.2.2.3">subscript</csymbol><ci id="S3.SS3.p1.1.m1.3.3.2.2.2.3.2.cmml" xref="S3.SS3.p1.1.m1.3.3.2.2.2.3.2">𝑛</ci><ci id="S3.SS3.p1.1.m1.3.3.2.2.2.3.3.cmml" xref="S3.SS3.p1.1.m1.3.3.2.2.2.3.3">𝑐</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.3c">\bm{r^{l}}=[r^{l}_{1},...,r^{l}_{n_{c}}]</annotation></semantics></math> and the number of objects per image <math id="S3.SS3.p1.2.m2.1" class="ltx_Math" alttext="n^{l}_{o}" display="inline"><semantics id="S3.SS3.p1.2.m2.1a"><msubsup id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml"><mi id="S3.SS3.p1.2.m2.1.1.2.2" xref="S3.SS3.p1.2.m2.1.1.2.2.cmml">n</mi><mi id="S3.SS3.p1.2.m2.1.1.3" xref="S3.SS3.p1.2.m2.1.1.3.cmml">o</mi><mi id="S3.SS3.p1.2.m2.1.1.2.3" xref="S3.SS3.p1.2.m2.1.1.2.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><apply id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">subscript</csymbol><apply id="S3.SS3.p1.2.m2.1.1.2.cmml" xref="S3.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.1.2.1.cmml" xref="S3.SS3.p1.2.m2.1.1">superscript</csymbol><ci id="S3.SS3.p1.2.m2.1.1.2.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2.2">𝑛</ci><ci id="S3.SS3.p1.2.m2.1.1.2.3.cmml" xref="S3.SS3.p1.2.m2.1.1.2.3">𝑙</ci></apply><ci id="S3.SS3.p1.2.m2.1.1.3.cmml" xref="S3.SS3.p1.2.m2.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">n^{l}_{o}</annotation></semantics></math>. Using this class distribution prior, the expected number of objects in the unlabelled data for each class <math id="S3.SS3.p1.3.m3.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS3.p1.3.m3.1a"><mi id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><ci id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">c</annotation></semantics></math> is calculated as:</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.1" class="ltx_Math" alttext="\vspace{-0.25em}n_{c}^{u}=r^{l}_{c}\cdot n^{l}_{o}\cdot n_{u}" display="block"><semantics id="S3.E5.m1.1a"><mrow id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml"><msubsup id="S3.E5.m1.1.1.2" xref="S3.E5.m1.1.1.2.cmml"><mi id="S3.E5.m1.1.1.2.2.2" xref="S3.E5.m1.1.1.2.2.2.cmml">n</mi><mi id="S3.E5.m1.1.1.2.2.3" xref="S3.E5.m1.1.1.2.2.3.cmml">c</mi><mi id="S3.E5.m1.1.1.2.3" xref="S3.E5.m1.1.1.2.3.cmml">u</mi></msubsup><mo id="S3.E5.m1.1.1.1" xref="S3.E5.m1.1.1.1.cmml">=</mo><mrow id="S3.E5.m1.1.1.3" xref="S3.E5.m1.1.1.3.cmml"><msubsup id="S3.E5.m1.1.1.3.2" xref="S3.E5.m1.1.1.3.2.cmml"><mi id="S3.E5.m1.1.1.3.2.2.2" xref="S3.E5.m1.1.1.3.2.2.2.cmml">r</mi><mi id="S3.E5.m1.1.1.3.2.3" xref="S3.E5.m1.1.1.3.2.3.cmml">c</mi><mi id="S3.E5.m1.1.1.3.2.2.3" xref="S3.E5.m1.1.1.3.2.2.3.cmml">l</mi></msubsup><mo lspace="0.222em" rspace="0.222em" id="S3.E5.m1.1.1.3.1" xref="S3.E5.m1.1.1.3.1.cmml">⋅</mo><msubsup id="S3.E5.m1.1.1.3.3" xref="S3.E5.m1.1.1.3.3.cmml"><mi id="S3.E5.m1.1.1.3.3.2.2" xref="S3.E5.m1.1.1.3.3.2.2.cmml">n</mi><mi id="S3.E5.m1.1.1.3.3.3" xref="S3.E5.m1.1.1.3.3.3.cmml">o</mi><mi id="S3.E5.m1.1.1.3.3.2.3" xref="S3.E5.m1.1.1.3.3.2.3.cmml">l</mi></msubsup><mo lspace="0.222em" rspace="0.222em" id="S3.E5.m1.1.1.3.1a" xref="S3.E5.m1.1.1.3.1.cmml">⋅</mo><msub id="S3.E5.m1.1.1.3.4" xref="S3.E5.m1.1.1.3.4.cmml"><mi id="S3.E5.m1.1.1.3.4.2" xref="S3.E5.m1.1.1.3.4.2.cmml">n</mi><mi id="S3.E5.m1.1.1.3.4.3" xref="S3.E5.m1.1.1.3.4.3.cmml">u</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.1b"><apply id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1"><eq id="S3.E5.m1.1.1.1.cmml" xref="S3.E5.m1.1.1.1"></eq><apply id="S3.E5.m1.1.1.2.cmml" xref="S3.E5.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.2.1.cmml" xref="S3.E5.m1.1.1.2">superscript</csymbol><apply id="S3.E5.m1.1.1.2.2.cmml" xref="S3.E5.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.2.2.1.cmml" xref="S3.E5.m1.1.1.2">subscript</csymbol><ci id="S3.E5.m1.1.1.2.2.2.cmml" xref="S3.E5.m1.1.1.2.2.2">𝑛</ci><ci id="S3.E5.m1.1.1.2.2.3.cmml" xref="S3.E5.m1.1.1.2.2.3">𝑐</ci></apply><ci id="S3.E5.m1.1.1.2.3.cmml" xref="S3.E5.m1.1.1.2.3">𝑢</ci></apply><apply id="S3.E5.m1.1.1.3.cmml" xref="S3.E5.m1.1.1.3"><ci id="S3.E5.m1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.3.1">⋅</ci><apply id="S3.E5.m1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.2.1.cmml" xref="S3.E5.m1.1.1.3.2">subscript</csymbol><apply id="S3.E5.m1.1.1.3.2.2.cmml" xref="S3.E5.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.2.2.1.cmml" xref="S3.E5.m1.1.1.3.2">superscript</csymbol><ci id="S3.E5.m1.1.1.3.2.2.2.cmml" xref="S3.E5.m1.1.1.3.2.2.2">𝑟</ci><ci id="S3.E5.m1.1.1.3.2.2.3.cmml" xref="S3.E5.m1.1.1.3.2.2.3">𝑙</ci></apply><ci id="S3.E5.m1.1.1.3.2.3.cmml" xref="S3.E5.m1.1.1.3.2.3">𝑐</ci></apply><apply id="S3.E5.m1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.3.1.cmml" xref="S3.E5.m1.1.1.3.3">subscript</csymbol><apply id="S3.E5.m1.1.1.3.3.2.cmml" xref="S3.E5.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.3.2.1.cmml" xref="S3.E5.m1.1.1.3.3">superscript</csymbol><ci id="S3.E5.m1.1.1.3.3.2.2.cmml" xref="S3.E5.m1.1.1.3.3.2.2">𝑛</ci><ci id="S3.E5.m1.1.1.3.3.2.3.cmml" xref="S3.E5.m1.1.1.3.3.2.3">𝑙</ci></apply><ci id="S3.E5.m1.1.1.3.3.3.cmml" xref="S3.E5.m1.1.1.3.3.3">𝑜</ci></apply><apply id="S3.E5.m1.1.1.3.4.cmml" xref="S3.E5.m1.1.1.3.4"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.4.1.cmml" xref="S3.E5.m1.1.1.3.4">subscript</csymbol><ci id="S3.E5.m1.1.1.3.4.2.cmml" xref="S3.E5.m1.1.1.3.4.2">𝑛</ci><ci id="S3.E5.m1.1.1.3.4.3.cmml" xref="S3.E5.m1.1.1.3.4.3">𝑢</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.1c">\vspace{-0.25em}n_{c}^{u}=r^{l}_{c}\cdot n^{l}_{o}\cdot n_{u}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p1.5" class="ltx_p">The confidence threshold for class <math id="S3.SS3.p1.4.m1.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS3.p1.4.m1.1a"><mi id="S3.SS3.p1.4.m1.1.1" xref="S3.SS3.p1.4.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m1.1b"><ci id="S3.SS3.p1.4.m1.1.1.cmml" xref="S3.SS3.p1.4.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m1.1c">c</annotation></semantics></math> is then selected such that <math id="S3.SS3.p1.5.m2.1" class="ltx_Math" alttext="n_{c}^{u}" display="inline"><semantics id="S3.SS3.p1.5.m2.1a"><msubsup id="S3.SS3.p1.5.m2.1.1" xref="S3.SS3.p1.5.m2.1.1.cmml"><mi id="S3.SS3.p1.5.m2.1.1.2.2" xref="S3.SS3.p1.5.m2.1.1.2.2.cmml">n</mi><mi id="S3.SS3.p1.5.m2.1.1.2.3" xref="S3.SS3.p1.5.m2.1.1.2.3.cmml">c</mi><mi id="S3.SS3.p1.5.m2.1.1.3" xref="S3.SS3.p1.5.m2.1.1.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m2.1b"><apply id="S3.SS3.p1.5.m2.1.1.cmml" xref="S3.SS3.p1.5.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m2.1.1.1.cmml" xref="S3.SS3.p1.5.m2.1.1">superscript</csymbol><apply id="S3.SS3.p1.5.m2.1.1.2.cmml" xref="S3.SS3.p1.5.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m2.1.1.2.1.cmml" xref="S3.SS3.p1.5.m2.1.1">subscript</csymbol><ci id="S3.SS3.p1.5.m2.1.1.2.2.cmml" xref="S3.SS3.p1.5.m2.1.1.2.2">𝑛</ci><ci id="S3.SS3.p1.5.m2.1.1.2.3.cmml" xref="S3.SS3.p1.5.m2.1.1.2.3">𝑐</ci></apply><ci id="S3.SS3.p1.5.m2.1.1.3.cmml" xref="S3.SS3.p1.5.m2.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m2.1c">n_{c}^{u}</annotation></semantics></math> pseudo-labels are generated. That is:</p>
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.1" class="ltx_Math" alttext="\vspace{-0.25em}t_{c}=\bm{p_{c}}^{sort}[n_{c}^{u}]" display="block"><semantics id="S3.E6.m1.1a"><mrow id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml"><msub id="S3.E6.m1.1.1.3" xref="S3.E6.m1.1.1.3.cmml"><mi id="S3.E6.m1.1.1.3.2" xref="S3.E6.m1.1.1.3.2.cmml">t</mi><mi id="S3.E6.m1.1.1.3.3" xref="S3.E6.m1.1.1.3.3.cmml">c</mi></msub><mo id="S3.E6.m1.1.1.2" xref="S3.E6.m1.1.1.2.cmml">=</mo><mrow id="S3.E6.m1.1.1.1" xref="S3.E6.m1.1.1.1.cmml"><mmultiscripts id="S3.E6.m1.1.1.1.3" xref="S3.E6.m1.1.1.1.3.cmml"><mi id="S3.E6.m1.1.1.1.3.2.2" xref="S3.E6.m1.1.1.1.3.2.2.cmml">𝒑</mi><mi id="S3.E6.m1.1.1.1.3.2.3" xref="S3.E6.m1.1.1.1.3.2.3.cmml">𝒄</mi><mrow id="S3.E6.m1.1.1.1.3a" xref="S3.E6.m1.1.1.1.3.cmml"></mrow><mrow id="S3.E6.m1.1.1.1.3b" xref="S3.E6.m1.1.1.1.3.cmml"></mrow><mrow id="S3.E6.m1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.3.3.cmml"><mi id="S3.E6.m1.1.1.1.3.3.2" xref="S3.E6.m1.1.1.1.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.3.3.1" xref="S3.E6.m1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E6.m1.1.1.1.3.3.3" xref="S3.E6.m1.1.1.1.3.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.3.3.1a" xref="S3.E6.m1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E6.m1.1.1.1.3.3.4" xref="S3.E6.m1.1.1.1.3.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.3.3.1b" xref="S3.E6.m1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E6.m1.1.1.1.3.3.5" xref="S3.E6.m1.1.1.1.3.3.5.cmml">t</mi></mrow></mmultiscripts><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.2" xref="S3.E6.m1.1.1.1.2.cmml">​</mo><mrow id="S3.E6.m1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E6.m1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.2.1.cmml">[</mo><msubsup id="S3.E6.m1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.2.2" xref="S3.E6.m1.1.1.1.1.1.1.2.2.cmml">n</mi><mi id="S3.E6.m1.1.1.1.1.1.1.2.3" xref="S3.E6.m1.1.1.1.1.1.1.2.3.cmml">c</mi><mi id="S3.E6.m1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.3.cmml">u</mi></msubsup><mo stretchy="false" id="S3.E6.m1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1"><eq id="S3.E6.m1.1.1.2.cmml" xref="S3.E6.m1.1.1.2"></eq><apply id="S3.E6.m1.1.1.3.cmml" xref="S3.E6.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.3.2">𝑡</ci><ci id="S3.E6.m1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.3.3">𝑐</ci></apply><apply id="S3.E6.m1.1.1.1.cmml" xref="S3.E6.m1.1.1.1"><times id="S3.E6.m1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.2"></times><apply id="S3.E6.m1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.3">superscript</csymbol><apply id="S3.E6.m1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.3.2.1.cmml" xref="S3.E6.m1.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.1.1.1.3.2.2.cmml" xref="S3.E6.m1.1.1.1.3.2.2">𝒑</ci><ci id="S3.E6.m1.1.1.1.3.2.3.cmml" xref="S3.E6.m1.1.1.1.3.2.3">𝒄</ci></apply><apply id="S3.E6.m1.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.3.3"><times id="S3.E6.m1.1.1.1.3.3.1.cmml" xref="S3.E6.m1.1.1.1.3.3.1"></times><ci id="S3.E6.m1.1.1.1.3.3.2.cmml" xref="S3.E6.m1.1.1.1.3.3.2">𝑠</ci><ci id="S3.E6.m1.1.1.1.3.3.3.cmml" xref="S3.E6.m1.1.1.1.3.3.3">𝑜</ci><ci id="S3.E6.m1.1.1.1.3.3.4.cmml" xref="S3.E6.m1.1.1.1.3.3.4">𝑟</ci><ci id="S3.E6.m1.1.1.1.3.3.5.cmml" xref="S3.E6.m1.1.1.1.3.3.5">𝑡</ci></apply></apply><apply id="S3.E6.m1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E6.m1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E6.m1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E6.m1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2.2">𝑛</ci><ci id="S3.E6.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2.3">𝑐</ci></apply><ci id="S3.E6.m1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.3">𝑢</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">\vspace{-0.25em}t_{c}=\bm{p_{c}}^{sort}[n_{c}^{u}]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p1.7" class="ltx_p">where <math id="S3.SS3.p1.6.m1.1" class="ltx_Math" alttext="\bm{p_{c}^{sort}}" display="inline"><semantics id="S3.SS3.p1.6.m1.1a"><msubsup id="S3.SS3.p1.6.m1.1.1" xref="S3.SS3.p1.6.m1.1.1.cmml"><mi id="S3.SS3.p1.6.m1.1.1.2.2" xref="S3.SS3.p1.6.m1.1.1.2.2.cmml">𝒑</mi><mi id="S3.SS3.p1.6.m1.1.1.2.3" xref="S3.SS3.p1.6.m1.1.1.2.3.cmml">𝒄</mi><mrow id="S3.SS3.p1.6.m1.1.1.3" xref="S3.SS3.p1.6.m1.1.1.3.cmml"><mi id="S3.SS3.p1.6.m1.1.1.3.2" xref="S3.SS3.p1.6.m1.1.1.3.2.cmml">𝒔</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.6.m1.1.1.3.1" xref="S3.SS3.p1.6.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p1.6.m1.1.1.3.3" xref="S3.SS3.p1.6.m1.1.1.3.3.cmml">𝒐</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.6.m1.1.1.3.1a" xref="S3.SS3.p1.6.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p1.6.m1.1.1.3.4" xref="S3.SS3.p1.6.m1.1.1.3.4.cmml">𝒓</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.6.m1.1.1.3.1b" xref="S3.SS3.p1.6.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p1.6.m1.1.1.3.5" xref="S3.SS3.p1.6.m1.1.1.3.5.cmml">𝒕</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m1.1b"><apply id="S3.SS3.p1.6.m1.1.1.cmml" xref="S3.SS3.p1.6.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.6.m1.1.1.1.cmml" xref="S3.SS3.p1.6.m1.1.1">superscript</csymbol><apply id="S3.SS3.p1.6.m1.1.1.2.cmml" xref="S3.SS3.p1.6.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.6.m1.1.1.2.1.cmml" xref="S3.SS3.p1.6.m1.1.1">subscript</csymbol><ci id="S3.SS3.p1.6.m1.1.1.2.2.cmml" xref="S3.SS3.p1.6.m1.1.1.2.2">𝒑</ci><ci id="S3.SS3.p1.6.m1.1.1.2.3.cmml" xref="S3.SS3.p1.6.m1.1.1.2.3">𝒄</ci></apply><apply id="S3.SS3.p1.6.m1.1.1.3.cmml" xref="S3.SS3.p1.6.m1.1.1.3"><times id="S3.SS3.p1.6.m1.1.1.3.1.cmml" xref="S3.SS3.p1.6.m1.1.1.3.1"></times><ci id="S3.SS3.p1.6.m1.1.1.3.2.cmml" xref="S3.SS3.p1.6.m1.1.1.3.2">𝒔</ci><ci id="S3.SS3.p1.6.m1.1.1.3.3.cmml" xref="S3.SS3.p1.6.m1.1.1.3.3">𝒐</ci><ci id="S3.SS3.p1.6.m1.1.1.3.4.cmml" xref="S3.SS3.p1.6.m1.1.1.3.4">𝒓</ci><ci id="S3.SS3.p1.6.m1.1.1.3.5.cmml" xref="S3.SS3.p1.6.m1.1.1.3.5">𝒕</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m1.1c">\bm{p_{c}^{sort}}</annotation></semantics></math> is a list of the confidence scores predicted for class <math id="S3.SS3.p1.7.m2.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS3.p1.7.m2.1a"><mi id="S3.SS3.p1.7.m2.1.1" xref="S3.SS3.p1.7.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m2.1b"><ci id="S3.SS3.p1.7.m2.1.1.cmml" xref="S3.SS3.p1.7.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.7.m2.1c">c</annotation></semantics></math> by the teacher, sorted in descending order. ACT can be used with any self-training approach based on Mean Teacher, but specific changes to the standard implementation are recommended by the authors <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. A proportion of the pseudo-labels are defined as reliable and used to calculate the hard classification and box regression losses defined in (<a href="#S3.E1" title="In III-B Mean Teacher ‣ III Preliminaries ‣ Predicting Class Distribution Shift for Reliable Domain Adaptive Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>). To deal with the noise present in the unreliable pseudo-labels, a soft classification loss is calculated using the cross-entropy between student and teacher classification predictions <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. This results in a reformulation of (<a href="#S3.E1" title="In III-B Mean Teacher ‣ III Preliminaries ‣ Predicting Class Distribution Shift for Reliable Domain Adaptive Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) as:</p>
<table id="S3.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E7.m1.65" class="ltx_Math" alttext="\vspace{-0.25em}\begin{split}\mathcal{L}_{u}=\mathcal{L}_{cls}(f(x_{u}^{s},\theta^{s}),y_{ur})+\mathcal{L}_{reg}(f(x_{u}^{s},\theta^{s}),y_{ur})\\
+\widehat{\mathcal{L}}_{cls}(f(x_{u}^{s},\theta^{s}),y_{uu})\end{split}" display="block"><semantics id="S3.E7.m1.65a"><mtable displaystyle="true" rowspacing="0pt" id="S3.E7.m1.65.65.12" xref="S3.E7.m1.59.59.6.cmml"><mtr id="S3.E7.m1.65.65.12a" xref="S3.E7.m1.59.59.6.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E7.m1.65.65.12b" xref="S3.E7.m1.59.59.6.cmml"><mrow id="S3.E7.m1.63.63.10.57.40.40" xref="S3.E7.m1.59.59.6.cmml"><msub id="S3.E7.m1.63.63.10.57.40.40.41" xref="S3.E7.m1.59.59.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.cmml">ℒ</mi><mi id="S3.E7.m1.2.2.2.2.2.2.1" xref="S3.E7.m1.2.2.2.2.2.2.1.cmml">u</mi></msub><mo id="S3.E7.m1.3.3.3.3.3.3" xref="S3.E7.m1.3.3.3.3.3.3.cmml">=</mo><mrow id="S3.E7.m1.63.63.10.57.40.40.40" xref="S3.E7.m1.59.59.6.cmml"><mrow id="S3.E7.m1.61.61.8.55.38.38.38.2" xref="S3.E7.m1.59.59.6.cmml"><msub id="S3.E7.m1.61.61.8.55.38.38.38.2.4" xref="S3.E7.m1.59.59.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.4.4.4.4.4.4" xref="S3.E7.m1.4.4.4.4.4.4.cmml">ℒ</mi><mrow id="S3.E7.m1.5.5.5.5.5.5.1" xref="S3.E7.m1.5.5.5.5.5.5.1.cmml"><mi id="S3.E7.m1.5.5.5.5.5.5.1.2" xref="S3.E7.m1.5.5.5.5.5.5.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.5.5.5.5.5.5.1.1" xref="S3.E7.m1.5.5.5.5.5.5.1.1.cmml">​</mo><mi id="S3.E7.m1.5.5.5.5.5.5.1.3" xref="S3.E7.m1.5.5.5.5.5.5.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.5.5.5.5.5.5.1.1a" xref="S3.E7.m1.5.5.5.5.5.5.1.1.cmml">​</mo><mi id="S3.E7.m1.5.5.5.5.5.5.1.4" xref="S3.E7.m1.5.5.5.5.5.5.1.4.cmml">s</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E7.m1.61.61.8.55.38.38.38.2.3" xref="S3.E7.m1.59.59.6.cmml">​</mo><mrow id="S3.E7.m1.61.61.8.55.38.38.38.2.2.2" xref="S3.E7.m1.59.59.6.cmml"><mo stretchy="false" id="S3.E7.m1.6.6.6.6.6.6" xref="S3.E7.m1.59.59.6.cmml">(</mo><mrow id="S3.E7.m1.60.60.7.54.37.37.37.1.1.1.1" xref="S3.E7.m1.59.59.6.cmml"><mi id="S3.E7.m1.7.7.7.7.7.7" xref="S3.E7.m1.7.7.7.7.7.7.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.60.60.7.54.37.37.37.1.1.1.1.3" xref="S3.E7.m1.59.59.6.cmml">​</mo><mrow id="S3.E7.m1.60.60.7.54.37.37.37.1.1.1.1.2.2" xref="S3.E7.m1.59.59.6.cmml"><mo stretchy="false" id="S3.E7.m1.8.8.8.8.8.8" xref="S3.E7.m1.59.59.6.cmml">(</mo><msubsup id="S3.E7.m1.60.60.7.54.37.37.37.1.1.1.1.1.1.1" xref="S3.E7.m1.59.59.6.cmml"><mi id="S3.E7.m1.9.9.9.9.9.9" xref="S3.E7.m1.9.9.9.9.9.9.cmml">x</mi><mi id="S3.E7.m1.10.10.10.10.10.10.1" xref="S3.E7.m1.10.10.10.10.10.10.1.cmml">u</mi><mi id="S3.E7.m1.11.11.11.11.11.11.1" xref="S3.E7.m1.11.11.11.11.11.11.1.cmml">s</mi></msubsup><mo id="S3.E7.m1.12.12.12.12.12.12" xref="S3.E7.m1.59.59.6.cmml">,</mo><msup id="S3.E7.m1.60.60.7.54.37.37.37.1.1.1.1.2.2.2" xref="S3.E7.m1.59.59.6.cmml"><mi id="S3.E7.m1.13.13.13.13.13.13" xref="S3.E7.m1.13.13.13.13.13.13.cmml">θ</mi><mi id="S3.E7.m1.14.14.14.14.14.14.1" xref="S3.E7.m1.14.14.14.14.14.14.1.cmml">s</mi></msup><mo stretchy="false" id="S3.E7.m1.15.15.15.15.15.15" xref="S3.E7.m1.59.59.6.cmml">)</mo></mrow></mrow><mo id="S3.E7.m1.16.16.16.16.16.16" xref="S3.E7.m1.59.59.6.cmml">,</mo><msub id="S3.E7.m1.61.61.8.55.38.38.38.2.2.2.2" xref="S3.E7.m1.59.59.6.cmml"><mi id="S3.E7.m1.17.17.17.17.17.17" xref="S3.E7.m1.17.17.17.17.17.17.cmml">y</mi><mrow id="S3.E7.m1.18.18.18.18.18.18.1" xref="S3.E7.m1.18.18.18.18.18.18.1.cmml"><mi id="S3.E7.m1.18.18.18.18.18.18.1.2" xref="S3.E7.m1.18.18.18.18.18.18.1.2.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.18.18.18.18.18.18.1.1" xref="S3.E7.m1.18.18.18.18.18.18.1.1.cmml">​</mo><mi id="S3.E7.m1.18.18.18.18.18.18.1.3" xref="S3.E7.m1.18.18.18.18.18.18.1.3.cmml">r</mi></mrow></msub><mo stretchy="false" id="S3.E7.m1.19.19.19.19.19.19" xref="S3.E7.m1.59.59.6.cmml">)</mo></mrow></mrow><mo id="S3.E7.m1.20.20.20.20.20.20" xref="S3.E7.m1.20.20.20.20.20.20.cmml">+</mo><mrow id="S3.E7.m1.63.63.10.57.40.40.40.4" xref="S3.E7.m1.59.59.6.cmml"><msub id="S3.E7.m1.63.63.10.57.40.40.40.4.4" xref="S3.E7.m1.59.59.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.21.21.21.21.21.21" xref="S3.E7.m1.21.21.21.21.21.21.cmml">ℒ</mi><mrow id="S3.E7.m1.22.22.22.22.22.22.1" xref="S3.E7.m1.22.22.22.22.22.22.1.cmml"><mi id="S3.E7.m1.22.22.22.22.22.22.1.2" xref="S3.E7.m1.22.22.22.22.22.22.1.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.22.22.22.22.22.22.1.1" xref="S3.E7.m1.22.22.22.22.22.22.1.1.cmml">​</mo><mi id="S3.E7.m1.22.22.22.22.22.22.1.3" xref="S3.E7.m1.22.22.22.22.22.22.1.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.22.22.22.22.22.22.1.1a" xref="S3.E7.m1.22.22.22.22.22.22.1.1.cmml">​</mo><mi id="S3.E7.m1.22.22.22.22.22.22.1.4" xref="S3.E7.m1.22.22.22.22.22.22.1.4.cmml">g</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E7.m1.63.63.10.57.40.40.40.4.3" xref="S3.E7.m1.59.59.6.cmml">​</mo><mrow id="S3.E7.m1.63.63.10.57.40.40.40.4.2.2" xref="S3.E7.m1.59.59.6.cmml"><mo stretchy="false" id="S3.E7.m1.23.23.23.23.23.23" xref="S3.E7.m1.59.59.6.cmml">(</mo><mrow id="S3.E7.m1.62.62.9.56.39.39.39.3.1.1.1" xref="S3.E7.m1.59.59.6.cmml"><mi id="S3.E7.m1.24.24.24.24.24.24" xref="S3.E7.m1.24.24.24.24.24.24.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.62.62.9.56.39.39.39.3.1.1.1.3" xref="S3.E7.m1.59.59.6.cmml">​</mo><mrow id="S3.E7.m1.62.62.9.56.39.39.39.3.1.1.1.2.2" xref="S3.E7.m1.59.59.6.cmml"><mo stretchy="false" id="S3.E7.m1.25.25.25.25.25.25" xref="S3.E7.m1.59.59.6.cmml">(</mo><msubsup id="S3.E7.m1.62.62.9.56.39.39.39.3.1.1.1.1.1.1" xref="S3.E7.m1.59.59.6.cmml"><mi id="S3.E7.m1.26.26.26.26.26.26" xref="S3.E7.m1.26.26.26.26.26.26.cmml">x</mi><mi id="S3.E7.m1.27.27.27.27.27.27.1" xref="S3.E7.m1.27.27.27.27.27.27.1.cmml">u</mi><mi id="S3.E7.m1.28.28.28.28.28.28.1" xref="S3.E7.m1.28.28.28.28.28.28.1.cmml">s</mi></msubsup><mo id="S3.E7.m1.29.29.29.29.29.29" xref="S3.E7.m1.59.59.6.cmml">,</mo><msup id="S3.E7.m1.62.62.9.56.39.39.39.3.1.1.1.2.2.2" xref="S3.E7.m1.59.59.6.cmml"><mi id="S3.E7.m1.30.30.30.30.30.30" xref="S3.E7.m1.30.30.30.30.30.30.cmml">θ</mi><mi id="S3.E7.m1.31.31.31.31.31.31.1" xref="S3.E7.m1.31.31.31.31.31.31.1.cmml">s</mi></msup><mo stretchy="false" id="S3.E7.m1.32.32.32.32.32.32" xref="S3.E7.m1.59.59.6.cmml">)</mo></mrow></mrow><mo id="S3.E7.m1.33.33.33.33.33.33" xref="S3.E7.m1.59.59.6.cmml">,</mo><msub id="S3.E7.m1.63.63.10.57.40.40.40.4.2.2.2" xref="S3.E7.m1.59.59.6.cmml"><mi id="S3.E7.m1.34.34.34.34.34.34" xref="S3.E7.m1.34.34.34.34.34.34.cmml">y</mi><mrow id="S3.E7.m1.35.35.35.35.35.35.1" xref="S3.E7.m1.35.35.35.35.35.35.1.cmml"><mi id="S3.E7.m1.35.35.35.35.35.35.1.2" xref="S3.E7.m1.35.35.35.35.35.35.1.2.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.35.35.35.35.35.35.1.1" xref="S3.E7.m1.35.35.35.35.35.35.1.1.cmml">​</mo><mi id="S3.E7.m1.35.35.35.35.35.35.1.3" xref="S3.E7.m1.35.35.35.35.35.35.1.3.cmml">r</mi></mrow></msub><mo stretchy="false" id="S3.E7.m1.36.36.36.36.36.36" xref="S3.E7.m1.59.59.6.cmml">)</mo></mrow></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E7.m1.65.65.12c" xref="S3.E7.m1.59.59.6.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E7.m1.65.65.12d" xref="S3.E7.m1.59.59.6.cmml"><mrow id="S3.E7.m1.65.65.12.59.19.19" xref="S3.E7.m1.59.59.6.cmml"><mo id="S3.E7.m1.65.65.12.59.19.19a" xref="S3.E7.m1.59.59.6.cmml">+</mo><mrow id="S3.E7.m1.65.65.12.59.19.19.19" xref="S3.E7.m1.59.59.6.cmml"><msub id="S3.E7.m1.65.65.12.59.19.19.19.4" xref="S3.E7.m1.59.59.6.cmml"><mover accent="true" id="S3.E7.m1.38.38.38.2.2.2" xref="S3.E7.m1.38.38.38.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.38.38.38.2.2.2.2" xref="S3.E7.m1.38.38.38.2.2.2.2.cmml">ℒ</mi><mo id="S3.E7.m1.38.38.38.2.2.2.1" xref="S3.E7.m1.38.38.38.2.2.2.1.cmml">^</mo></mover><mrow id="S3.E7.m1.39.39.39.3.3.3.1" xref="S3.E7.m1.39.39.39.3.3.3.1.cmml"><mi id="S3.E7.m1.39.39.39.3.3.3.1.2" xref="S3.E7.m1.39.39.39.3.3.3.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.39.39.39.3.3.3.1.1" xref="S3.E7.m1.39.39.39.3.3.3.1.1.cmml">​</mo><mi id="S3.E7.m1.39.39.39.3.3.3.1.3" xref="S3.E7.m1.39.39.39.3.3.3.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.39.39.39.3.3.3.1.1a" xref="S3.E7.m1.39.39.39.3.3.3.1.1.cmml">​</mo><mi id="S3.E7.m1.39.39.39.3.3.3.1.4" xref="S3.E7.m1.39.39.39.3.3.3.1.4.cmml">s</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E7.m1.65.65.12.59.19.19.19.3" xref="S3.E7.m1.59.59.6.cmml">​</mo><mrow id="S3.E7.m1.65.65.12.59.19.19.19.2.2" xref="S3.E7.m1.59.59.6.cmml"><mo stretchy="false" id="S3.E7.m1.40.40.40.4.4.4" xref="S3.E7.m1.59.59.6.cmml">(</mo><mrow id="S3.E7.m1.64.64.11.58.18.18.18.1.1.1" xref="S3.E7.m1.59.59.6.cmml"><mi id="S3.E7.m1.41.41.41.5.5.5" xref="S3.E7.m1.41.41.41.5.5.5.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.64.64.11.58.18.18.18.1.1.1.3" xref="S3.E7.m1.59.59.6.cmml">​</mo><mrow id="S3.E7.m1.64.64.11.58.18.18.18.1.1.1.2.2" xref="S3.E7.m1.59.59.6.cmml"><mo stretchy="false" id="S3.E7.m1.42.42.42.6.6.6" xref="S3.E7.m1.59.59.6.cmml">(</mo><msubsup id="S3.E7.m1.64.64.11.58.18.18.18.1.1.1.1.1.1" xref="S3.E7.m1.59.59.6.cmml"><mi id="S3.E7.m1.43.43.43.7.7.7" xref="S3.E7.m1.43.43.43.7.7.7.cmml">x</mi><mi id="S3.E7.m1.44.44.44.8.8.8.1" xref="S3.E7.m1.44.44.44.8.8.8.1.cmml">u</mi><mi id="S3.E7.m1.45.45.45.9.9.9.1" xref="S3.E7.m1.45.45.45.9.9.9.1.cmml">s</mi></msubsup><mo id="S3.E7.m1.46.46.46.10.10.10" xref="S3.E7.m1.59.59.6.cmml">,</mo><msup id="S3.E7.m1.64.64.11.58.18.18.18.1.1.1.2.2.2" xref="S3.E7.m1.59.59.6.cmml"><mi id="S3.E7.m1.47.47.47.11.11.11" xref="S3.E7.m1.47.47.47.11.11.11.cmml">θ</mi><mi id="S3.E7.m1.48.48.48.12.12.12.1" xref="S3.E7.m1.48.48.48.12.12.12.1.cmml">s</mi></msup><mo stretchy="false" id="S3.E7.m1.49.49.49.13.13.13" xref="S3.E7.m1.59.59.6.cmml">)</mo></mrow></mrow><mo id="S3.E7.m1.50.50.50.14.14.14" xref="S3.E7.m1.59.59.6.cmml">,</mo><msub id="S3.E7.m1.65.65.12.59.19.19.19.2.2.2" xref="S3.E7.m1.59.59.6.cmml"><mi id="S3.E7.m1.51.51.51.15.15.15" xref="S3.E7.m1.51.51.51.15.15.15.cmml">y</mi><mrow id="S3.E7.m1.52.52.52.16.16.16.1" xref="S3.E7.m1.52.52.52.16.16.16.1.cmml"><mi id="S3.E7.m1.52.52.52.16.16.16.1.2" xref="S3.E7.m1.52.52.52.16.16.16.1.2.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.52.52.52.16.16.16.1.1" xref="S3.E7.m1.52.52.52.16.16.16.1.1.cmml">​</mo><mi id="S3.E7.m1.52.52.52.16.16.16.1.3" xref="S3.E7.m1.52.52.52.16.16.16.1.3.cmml">u</mi></mrow></msub><mo stretchy="false" id="S3.E7.m1.53.53.53.17.17.17" xref="S3.E7.m1.59.59.6.cmml">)</mo></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E7.m1.65b"><apply id="S3.E7.m1.59.59.6.cmml" xref="S3.E7.m1.65.65.12"><eq id="S3.E7.m1.3.3.3.3.3.3.cmml" xref="S3.E7.m1.3.3.3.3.3.3"></eq><apply id="S3.E7.m1.59.59.6.8.cmml" xref="S3.E7.m1.65.65.12"><csymbol cd="ambiguous" id="S3.E7.m1.59.59.6.8.1.cmml" xref="S3.E7.m1.65.65.12">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1">ℒ</ci><ci id="S3.E7.m1.2.2.2.2.2.2.1.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1">𝑢</ci></apply><apply id="S3.E7.m1.59.59.6.6.cmml" xref="S3.E7.m1.65.65.12"><plus id="S3.E7.m1.20.20.20.20.20.20.cmml" xref="S3.E7.m1.20.20.20.20.20.20"></plus><apply id="S3.E7.m1.55.55.2.2.2.cmml" xref="S3.E7.m1.65.65.12"><times id="S3.E7.m1.55.55.2.2.2.3.cmml" xref="S3.E7.m1.65.65.12"></times><apply id="S3.E7.m1.55.55.2.2.2.4.cmml" xref="S3.E7.m1.65.65.12"><csymbol cd="ambiguous" id="S3.E7.m1.55.55.2.2.2.4.1.cmml" xref="S3.E7.m1.65.65.12">subscript</csymbol><ci id="S3.E7.m1.4.4.4.4.4.4.cmml" xref="S3.E7.m1.4.4.4.4.4.4">ℒ</ci><apply id="S3.E7.m1.5.5.5.5.5.5.1.cmml" xref="S3.E7.m1.5.5.5.5.5.5.1"><times id="S3.E7.m1.5.5.5.5.5.5.1.1.cmml" xref="S3.E7.m1.5.5.5.5.5.5.1.1"></times><ci id="S3.E7.m1.5.5.5.5.5.5.1.2.cmml" xref="S3.E7.m1.5.5.5.5.5.5.1.2">𝑐</ci><ci id="S3.E7.m1.5.5.5.5.5.5.1.3.cmml" xref="S3.E7.m1.5.5.5.5.5.5.1.3">𝑙</ci><ci id="S3.E7.m1.5.5.5.5.5.5.1.4.cmml" xref="S3.E7.m1.5.5.5.5.5.5.1.4">𝑠</ci></apply></apply><interval closure="open" id="S3.E7.m1.55.55.2.2.2.2.3.cmml" xref="S3.E7.m1.65.65.12"><apply id="S3.E7.m1.54.54.1.1.1.1.1.1.cmml" xref="S3.E7.m1.65.65.12"><times id="S3.E7.m1.54.54.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.65.65.12"></times><ci id="S3.E7.m1.7.7.7.7.7.7.cmml" xref="S3.E7.m1.7.7.7.7.7.7">𝑓</ci><interval closure="open" id="S3.E7.m1.54.54.1.1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.65.65.12"><apply id="S3.E7.m1.54.54.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.65.65.12"><csymbol cd="ambiguous" id="S3.E7.m1.54.54.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.65.65.12">superscript</csymbol><apply id="S3.E7.m1.54.54.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.65.65.12"><csymbol cd="ambiguous" id="S3.E7.m1.54.54.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.65.65.12">subscript</csymbol><ci id="S3.E7.m1.9.9.9.9.9.9.cmml" xref="S3.E7.m1.9.9.9.9.9.9">𝑥</ci><ci id="S3.E7.m1.10.10.10.10.10.10.1.cmml" xref="S3.E7.m1.10.10.10.10.10.10.1">𝑢</ci></apply><ci id="S3.E7.m1.11.11.11.11.11.11.1.cmml" xref="S3.E7.m1.11.11.11.11.11.11.1">𝑠</ci></apply><apply id="S3.E7.m1.54.54.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E7.m1.65.65.12"><csymbol cd="ambiguous" id="S3.E7.m1.54.54.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E7.m1.65.65.12">superscript</csymbol><ci id="S3.E7.m1.13.13.13.13.13.13.cmml" xref="S3.E7.m1.13.13.13.13.13.13">𝜃</ci><ci id="S3.E7.m1.14.14.14.14.14.14.1.cmml" xref="S3.E7.m1.14.14.14.14.14.14.1">𝑠</ci></apply></interval></apply><apply id="S3.E7.m1.55.55.2.2.2.2.2.2.cmml" xref="S3.E7.m1.65.65.12"><csymbol cd="ambiguous" id="S3.E7.m1.55.55.2.2.2.2.2.2.1.cmml" xref="S3.E7.m1.65.65.12">subscript</csymbol><ci id="S3.E7.m1.17.17.17.17.17.17.cmml" xref="S3.E7.m1.17.17.17.17.17.17">𝑦</ci><apply id="S3.E7.m1.18.18.18.18.18.18.1.cmml" xref="S3.E7.m1.18.18.18.18.18.18.1"><times id="S3.E7.m1.18.18.18.18.18.18.1.1.cmml" xref="S3.E7.m1.18.18.18.18.18.18.1.1"></times><ci id="S3.E7.m1.18.18.18.18.18.18.1.2.cmml" xref="S3.E7.m1.18.18.18.18.18.18.1.2">𝑢</ci><ci id="S3.E7.m1.18.18.18.18.18.18.1.3.cmml" xref="S3.E7.m1.18.18.18.18.18.18.1.3">𝑟</ci></apply></apply></interval></apply><apply id="S3.E7.m1.57.57.4.4.4.cmml" xref="S3.E7.m1.65.65.12"><times id="S3.E7.m1.57.57.4.4.4.3.cmml" xref="S3.E7.m1.65.65.12"></times><apply id="S3.E7.m1.57.57.4.4.4.4.cmml" xref="S3.E7.m1.65.65.12"><csymbol cd="ambiguous" id="S3.E7.m1.57.57.4.4.4.4.1.cmml" xref="S3.E7.m1.65.65.12">subscript</csymbol><ci id="S3.E7.m1.21.21.21.21.21.21.cmml" xref="S3.E7.m1.21.21.21.21.21.21">ℒ</ci><apply id="S3.E7.m1.22.22.22.22.22.22.1.cmml" xref="S3.E7.m1.22.22.22.22.22.22.1"><times id="S3.E7.m1.22.22.22.22.22.22.1.1.cmml" xref="S3.E7.m1.22.22.22.22.22.22.1.1"></times><ci id="S3.E7.m1.22.22.22.22.22.22.1.2.cmml" xref="S3.E7.m1.22.22.22.22.22.22.1.2">𝑟</ci><ci id="S3.E7.m1.22.22.22.22.22.22.1.3.cmml" xref="S3.E7.m1.22.22.22.22.22.22.1.3">𝑒</ci><ci id="S3.E7.m1.22.22.22.22.22.22.1.4.cmml" xref="S3.E7.m1.22.22.22.22.22.22.1.4">𝑔</ci></apply></apply><interval closure="open" id="S3.E7.m1.57.57.4.4.4.2.3.cmml" xref="S3.E7.m1.65.65.12"><apply id="S3.E7.m1.56.56.3.3.3.1.1.1.cmml" xref="S3.E7.m1.65.65.12"><times id="S3.E7.m1.56.56.3.3.3.1.1.1.3.cmml" xref="S3.E7.m1.65.65.12"></times><ci id="S3.E7.m1.24.24.24.24.24.24.cmml" xref="S3.E7.m1.24.24.24.24.24.24">𝑓</ci><interval closure="open" id="S3.E7.m1.56.56.3.3.3.1.1.1.2.3.cmml" xref="S3.E7.m1.65.65.12"><apply id="S3.E7.m1.56.56.3.3.3.1.1.1.1.1.1.cmml" xref="S3.E7.m1.65.65.12"><csymbol cd="ambiguous" id="S3.E7.m1.56.56.3.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.65.65.12">superscript</csymbol><apply id="S3.E7.m1.56.56.3.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.65.65.12"><csymbol cd="ambiguous" id="S3.E7.m1.56.56.3.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.65.65.12">subscript</csymbol><ci id="S3.E7.m1.26.26.26.26.26.26.cmml" xref="S3.E7.m1.26.26.26.26.26.26">𝑥</ci><ci id="S3.E7.m1.27.27.27.27.27.27.1.cmml" xref="S3.E7.m1.27.27.27.27.27.27.1">𝑢</ci></apply><ci id="S3.E7.m1.28.28.28.28.28.28.1.cmml" xref="S3.E7.m1.28.28.28.28.28.28.1">𝑠</ci></apply><apply id="S3.E7.m1.56.56.3.3.3.1.1.1.2.2.2.cmml" xref="S3.E7.m1.65.65.12"><csymbol cd="ambiguous" id="S3.E7.m1.56.56.3.3.3.1.1.1.2.2.2.1.cmml" xref="S3.E7.m1.65.65.12">superscript</csymbol><ci id="S3.E7.m1.30.30.30.30.30.30.cmml" xref="S3.E7.m1.30.30.30.30.30.30">𝜃</ci><ci id="S3.E7.m1.31.31.31.31.31.31.1.cmml" xref="S3.E7.m1.31.31.31.31.31.31.1">𝑠</ci></apply></interval></apply><apply id="S3.E7.m1.57.57.4.4.4.2.2.2.cmml" xref="S3.E7.m1.65.65.12"><csymbol cd="ambiguous" id="S3.E7.m1.57.57.4.4.4.2.2.2.1.cmml" xref="S3.E7.m1.65.65.12">subscript</csymbol><ci id="S3.E7.m1.34.34.34.34.34.34.cmml" xref="S3.E7.m1.34.34.34.34.34.34">𝑦</ci><apply id="S3.E7.m1.35.35.35.35.35.35.1.cmml" xref="S3.E7.m1.35.35.35.35.35.35.1"><times id="S3.E7.m1.35.35.35.35.35.35.1.1.cmml" xref="S3.E7.m1.35.35.35.35.35.35.1.1"></times><ci id="S3.E7.m1.35.35.35.35.35.35.1.2.cmml" xref="S3.E7.m1.35.35.35.35.35.35.1.2">𝑢</ci><ci id="S3.E7.m1.35.35.35.35.35.35.1.3.cmml" xref="S3.E7.m1.35.35.35.35.35.35.1.3">𝑟</ci></apply></apply></interval></apply><apply id="S3.E7.m1.59.59.6.6.6.cmml" xref="S3.E7.m1.65.65.12"><times id="S3.E7.m1.59.59.6.6.6.3.cmml" xref="S3.E7.m1.65.65.12"></times><apply id="S3.E7.m1.59.59.6.6.6.4.cmml" xref="S3.E7.m1.65.65.12"><csymbol cd="ambiguous" id="S3.E7.m1.59.59.6.6.6.4.1.cmml" xref="S3.E7.m1.65.65.12">subscript</csymbol><apply id="S3.E7.m1.38.38.38.2.2.2.cmml" xref="S3.E7.m1.38.38.38.2.2.2"><ci id="S3.E7.m1.38.38.38.2.2.2.1.cmml" xref="S3.E7.m1.38.38.38.2.2.2.1">^</ci><ci id="S3.E7.m1.38.38.38.2.2.2.2.cmml" xref="S3.E7.m1.38.38.38.2.2.2.2">ℒ</ci></apply><apply id="S3.E7.m1.39.39.39.3.3.3.1.cmml" xref="S3.E7.m1.39.39.39.3.3.3.1"><times id="S3.E7.m1.39.39.39.3.3.3.1.1.cmml" xref="S3.E7.m1.39.39.39.3.3.3.1.1"></times><ci id="S3.E7.m1.39.39.39.3.3.3.1.2.cmml" xref="S3.E7.m1.39.39.39.3.3.3.1.2">𝑐</ci><ci id="S3.E7.m1.39.39.39.3.3.3.1.3.cmml" xref="S3.E7.m1.39.39.39.3.3.3.1.3">𝑙</ci><ci id="S3.E7.m1.39.39.39.3.3.3.1.4.cmml" xref="S3.E7.m1.39.39.39.3.3.3.1.4">𝑠</ci></apply></apply><interval closure="open" id="S3.E7.m1.59.59.6.6.6.2.3.cmml" xref="S3.E7.m1.65.65.12"><apply id="S3.E7.m1.58.58.5.5.5.1.1.1.cmml" xref="S3.E7.m1.65.65.12"><times id="S3.E7.m1.58.58.5.5.5.1.1.1.3.cmml" xref="S3.E7.m1.65.65.12"></times><ci id="S3.E7.m1.41.41.41.5.5.5.cmml" xref="S3.E7.m1.41.41.41.5.5.5">𝑓</ci><interval closure="open" id="S3.E7.m1.58.58.5.5.5.1.1.1.2.3.cmml" xref="S3.E7.m1.65.65.12"><apply id="S3.E7.m1.58.58.5.5.5.1.1.1.1.1.1.cmml" xref="S3.E7.m1.65.65.12"><csymbol cd="ambiguous" id="S3.E7.m1.58.58.5.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.65.65.12">superscript</csymbol><apply id="S3.E7.m1.58.58.5.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.65.65.12"><csymbol cd="ambiguous" id="S3.E7.m1.58.58.5.5.5.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.65.65.12">subscript</csymbol><ci id="S3.E7.m1.43.43.43.7.7.7.cmml" xref="S3.E7.m1.43.43.43.7.7.7">𝑥</ci><ci id="S3.E7.m1.44.44.44.8.8.8.1.cmml" xref="S3.E7.m1.44.44.44.8.8.8.1">𝑢</ci></apply><ci id="S3.E7.m1.45.45.45.9.9.9.1.cmml" xref="S3.E7.m1.45.45.45.9.9.9.1">𝑠</ci></apply><apply id="S3.E7.m1.58.58.5.5.5.1.1.1.2.2.2.cmml" xref="S3.E7.m1.65.65.12"><csymbol cd="ambiguous" id="S3.E7.m1.58.58.5.5.5.1.1.1.2.2.2.1.cmml" xref="S3.E7.m1.65.65.12">superscript</csymbol><ci id="S3.E7.m1.47.47.47.11.11.11.cmml" xref="S3.E7.m1.47.47.47.11.11.11">𝜃</ci><ci id="S3.E7.m1.48.48.48.12.12.12.1.cmml" xref="S3.E7.m1.48.48.48.12.12.12.1">𝑠</ci></apply></interval></apply><apply id="S3.E7.m1.59.59.6.6.6.2.2.2.cmml" xref="S3.E7.m1.65.65.12"><csymbol cd="ambiguous" id="S3.E7.m1.59.59.6.6.6.2.2.2.1.cmml" xref="S3.E7.m1.65.65.12">subscript</csymbol><ci id="S3.E7.m1.51.51.51.15.15.15.cmml" xref="S3.E7.m1.51.51.51.15.15.15">𝑦</ci><apply id="S3.E7.m1.52.52.52.16.16.16.1.cmml" xref="S3.E7.m1.52.52.52.16.16.16.1"><times id="S3.E7.m1.52.52.52.16.16.16.1.1.cmml" xref="S3.E7.m1.52.52.52.16.16.16.1.1"></times><ci id="S3.E7.m1.52.52.52.16.16.16.1.2.cmml" xref="S3.E7.m1.52.52.52.16.16.16.1.2">𝑢</ci><ci id="S3.E7.m1.52.52.52.16.16.16.1.3.cmml" xref="S3.E7.m1.52.52.52.16.16.16.1.3">𝑢</ci></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.65c">\vspace{-0.25em}\begin{split}\mathcal{L}_{u}=\mathcal{L}_{cls}(f(x_{u}^{s},\theta^{s}),y_{ur})+\mathcal{L}_{reg}(f(x_{u}^{s},\theta^{s}),y_{ur})\\
+\widehat{\mathcal{L}}_{cls}(f(x_{u}^{s},\theta^{s}),y_{uu})\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p1.10" class="ltx_p">where <math id="S3.SS3.p1.8.m1.1" class="ltx_Math" alttext="y_{ur}" display="inline"><semantics id="S3.SS3.p1.8.m1.1a"><msub id="S3.SS3.p1.8.m1.1.1" xref="S3.SS3.p1.8.m1.1.1.cmml"><mi id="S3.SS3.p1.8.m1.1.1.2" xref="S3.SS3.p1.8.m1.1.1.2.cmml">y</mi><mrow id="S3.SS3.p1.8.m1.1.1.3" xref="S3.SS3.p1.8.m1.1.1.3.cmml"><mi id="S3.SS3.p1.8.m1.1.1.3.2" xref="S3.SS3.p1.8.m1.1.1.3.2.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.8.m1.1.1.3.1" xref="S3.SS3.p1.8.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p1.8.m1.1.1.3.3" xref="S3.SS3.p1.8.m1.1.1.3.3.cmml">r</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.8.m1.1b"><apply id="S3.SS3.p1.8.m1.1.1.cmml" xref="S3.SS3.p1.8.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.8.m1.1.1.1.cmml" xref="S3.SS3.p1.8.m1.1.1">subscript</csymbol><ci id="S3.SS3.p1.8.m1.1.1.2.cmml" xref="S3.SS3.p1.8.m1.1.1.2">𝑦</ci><apply id="S3.SS3.p1.8.m1.1.1.3.cmml" xref="S3.SS3.p1.8.m1.1.1.3"><times id="S3.SS3.p1.8.m1.1.1.3.1.cmml" xref="S3.SS3.p1.8.m1.1.1.3.1"></times><ci id="S3.SS3.p1.8.m1.1.1.3.2.cmml" xref="S3.SS3.p1.8.m1.1.1.3.2">𝑢</ci><ci id="S3.SS3.p1.8.m1.1.1.3.3.cmml" xref="S3.SS3.p1.8.m1.1.1.3.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.8.m1.1c">y_{ur}</annotation></semantics></math> and <math id="S3.SS3.p1.9.m2.1" class="ltx_Math" alttext="y_{uu}" display="inline"><semantics id="S3.SS3.p1.9.m2.1a"><msub id="S3.SS3.p1.9.m2.1.1" xref="S3.SS3.p1.9.m2.1.1.cmml"><mi id="S3.SS3.p1.9.m2.1.1.2" xref="S3.SS3.p1.9.m2.1.1.2.cmml">y</mi><mrow id="S3.SS3.p1.9.m2.1.1.3" xref="S3.SS3.p1.9.m2.1.1.3.cmml"><mi id="S3.SS3.p1.9.m2.1.1.3.2" xref="S3.SS3.p1.9.m2.1.1.3.2.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.9.m2.1.1.3.1" xref="S3.SS3.p1.9.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p1.9.m2.1.1.3.3" xref="S3.SS3.p1.9.m2.1.1.3.3.cmml">u</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.9.m2.1b"><apply id="S3.SS3.p1.9.m2.1.1.cmml" xref="S3.SS3.p1.9.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.9.m2.1.1.1.cmml" xref="S3.SS3.p1.9.m2.1.1">subscript</csymbol><ci id="S3.SS3.p1.9.m2.1.1.2.cmml" xref="S3.SS3.p1.9.m2.1.1.2">𝑦</ci><apply id="S3.SS3.p1.9.m2.1.1.3.cmml" xref="S3.SS3.p1.9.m2.1.1.3"><times id="S3.SS3.p1.9.m2.1.1.3.1.cmml" xref="S3.SS3.p1.9.m2.1.1.3.1"></times><ci id="S3.SS3.p1.9.m2.1.1.3.2.cmml" xref="S3.SS3.p1.9.m2.1.1.3.2">𝑢</ci><ci id="S3.SS3.p1.9.m2.1.1.3.3.cmml" xref="S3.SS3.p1.9.m2.1.1.3.3">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.9.m2.1c">y_{uu}</annotation></semantics></math> refer to the reliable and unreliable pseudo-labels, and <math id="S3.SS3.p1.10.m3.1" class="ltx_Math" alttext="\widehat{\mathcal{L}}_{cls}" display="inline"><semantics id="S3.SS3.p1.10.m3.1a"><msub id="S3.SS3.p1.10.m3.1.1" xref="S3.SS3.p1.10.m3.1.1.cmml"><mover accent="true" id="S3.SS3.p1.10.m3.1.1.2" xref="S3.SS3.p1.10.m3.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.10.m3.1.1.2.2" xref="S3.SS3.p1.10.m3.1.1.2.2.cmml">ℒ</mi><mo id="S3.SS3.p1.10.m3.1.1.2.1" xref="S3.SS3.p1.10.m3.1.1.2.1.cmml">^</mo></mover><mrow id="S3.SS3.p1.10.m3.1.1.3" xref="S3.SS3.p1.10.m3.1.1.3.cmml"><mi id="S3.SS3.p1.10.m3.1.1.3.2" xref="S3.SS3.p1.10.m3.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.10.m3.1.1.3.1" xref="S3.SS3.p1.10.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p1.10.m3.1.1.3.3" xref="S3.SS3.p1.10.m3.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.10.m3.1.1.3.1a" xref="S3.SS3.p1.10.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p1.10.m3.1.1.3.4" xref="S3.SS3.p1.10.m3.1.1.3.4.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.10.m3.1b"><apply id="S3.SS3.p1.10.m3.1.1.cmml" xref="S3.SS3.p1.10.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.10.m3.1.1.1.cmml" xref="S3.SS3.p1.10.m3.1.1">subscript</csymbol><apply id="S3.SS3.p1.10.m3.1.1.2.cmml" xref="S3.SS3.p1.10.m3.1.1.2"><ci id="S3.SS3.p1.10.m3.1.1.2.1.cmml" xref="S3.SS3.p1.10.m3.1.1.2.1">^</ci><ci id="S3.SS3.p1.10.m3.1.1.2.2.cmml" xref="S3.SS3.p1.10.m3.1.1.2.2">ℒ</ci></apply><apply id="S3.SS3.p1.10.m3.1.1.3.cmml" xref="S3.SS3.p1.10.m3.1.1.3"><times id="S3.SS3.p1.10.m3.1.1.3.1.cmml" xref="S3.SS3.p1.10.m3.1.1.3.1"></times><ci id="S3.SS3.p1.10.m3.1.1.3.2.cmml" xref="S3.SS3.p1.10.m3.1.1.3.2">𝑐</ci><ci id="S3.SS3.p1.10.m3.1.1.3.3.cmml" xref="S3.SS3.p1.10.m3.1.1.3.3">𝑙</ci><ci id="S3.SS3.p1.10.m3.1.1.3.4.cmml" xref="S3.SS3.p1.10.m3.1.1.3.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.10.m3.1c">\widehat{\mathcal{L}}_{cls}</annotation></semantics></math> denotes the soft classification loss.</p>
</div>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS4.5.1.1" class="ltx_text">III-D</span> </span><span id="S3.SS4.6.2" class="ltx_text ltx_font_italic">Contrasting Language-Image Pretraining (CLIP)</span>
</h3>

<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.10" class="ltx_p">Given a batch of <math id="S3.SS4.p1.1.m1.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS4.p1.1.m1.1a"><mi id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><ci id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">n</annotation></semantics></math> images <math id="S3.SS4.p1.2.m2.1" class="ltx_Math" alttext="X_{i}" display="inline"><semantics id="S3.SS4.p1.2.m2.1a"><msub id="S3.SS4.p1.2.m2.1.1" xref="S3.SS4.p1.2.m2.1.1.cmml"><mi id="S3.SS4.p1.2.m2.1.1.2" xref="S3.SS4.p1.2.m2.1.1.2.cmml">X</mi><mi id="S3.SS4.p1.2.m2.1.1.3" xref="S3.SS4.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m2.1b"><apply id="S3.SS4.p1.2.m2.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.1.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS4.p1.2.m2.1.1.2.cmml" xref="S3.SS4.p1.2.m2.1.1.2">𝑋</ci><ci id="S3.SS4.p1.2.m2.1.1.3.cmml" xref="S3.SS4.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m2.1c">X_{i}</annotation></semantics></math> and associated texts <math id="S3.SS4.p1.3.m3.1" class="ltx_Math" alttext="X_{t}" display="inline"><semantics id="S3.SS4.p1.3.m3.1a"><msub id="S3.SS4.p1.3.m3.1.1" xref="S3.SS4.p1.3.m3.1.1.cmml"><mi id="S3.SS4.p1.3.m3.1.1.2" xref="S3.SS4.p1.3.m3.1.1.2.cmml">X</mi><mi id="S3.SS4.p1.3.m3.1.1.3" xref="S3.SS4.p1.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.3.m3.1b"><apply id="S3.SS4.p1.3.m3.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.3.m3.1.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS4.p1.3.m3.1.1.2.cmml" xref="S3.SS4.p1.3.m3.1.1.2">𝑋</ci><ci id="S3.SS4.p1.3.m3.1.1.3.cmml" xref="S3.SS4.p1.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.3.m3.1c">X_{t}</annotation></semantics></math>, CLIP is trained to predict which possible image-text pairs <math id="S3.SS4.p1.4.m4.1" class="ltx_Math" alttext="X_{i}\times X_{t}" display="inline"><semantics id="S3.SS4.p1.4.m4.1a"><mrow id="S3.SS4.p1.4.m4.1.1" xref="S3.SS4.p1.4.m4.1.1.cmml"><msub id="S3.SS4.p1.4.m4.1.1.2" xref="S3.SS4.p1.4.m4.1.1.2.cmml"><mi id="S3.SS4.p1.4.m4.1.1.2.2" xref="S3.SS4.p1.4.m4.1.1.2.2.cmml">X</mi><mi id="S3.SS4.p1.4.m4.1.1.2.3" xref="S3.SS4.p1.4.m4.1.1.2.3.cmml">i</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS4.p1.4.m4.1.1.1" xref="S3.SS4.p1.4.m4.1.1.1.cmml">×</mo><msub id="S3.SS4.p1.4.m4.1.1.3" xref="S3.SS4.p1.4.m4.1.1.3.cmml"><mi id="S3.SS4.p1.4.m4.1.1.3.2" xref="S3.SS4.p1.4.m4.1.1.3.2.cmml">X</mi><mi id="S3.SS4.p1.4.m4.1.1.3.3" xref="S3.SS4.p1.4.m4.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.4.m4.1b"><apply id="S3.SS4.p1.4.m4.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1"><times id="S3.SS4.p1.4.m4.1.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1.1"></times><apply id="S3.SS4.p1.4.m4.1.1.2.cmml" xref="S3.SS4.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p1.4.m4.1.1.2.1.cmml" xref="S3.SS4.p1.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS4.p1.4.m4.1.1.2.2.cmml" xref="S3.SS4.p1.4.m4.1.1.2.2">𝑋</ci><ci id="S3.SS4.p1.4.m4.1.1.2.3.cmml" xref="S3.SS4.p1.4.m4.1.1.2.3">𝑖</ci></apply><apply id="S3.SS4.p1.4.m4.1.1.3.cmml" xref="S3.SS4.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.4.m4.1.1.3.1.cmml" xref="S3.SS4.p1.4.m4.1.1.3">subscript</csymbol><ci id="S3.SS4.p1.4.m4.1.1.3.2.cmml" xref="S3.SS4.p1.4.m4.1.1.3.2">𝑋</ci><ci id="S3.SS4.p1.4.m4.1.1.3.3.cmml" xref="S3.SS4.p1.4.m4.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.4.m4.1c">X_{i}\times X_{t}</annotation></semantics></math> actually occurred. Images and texts are input to an image encoder <math id="S3.SS4.p1.5.m5.1" class="ltx_Math" alttext="I" display="inline"><semantics id="S3.SS4.p1.5.m5.1a"><mi id="S3.SS4.p1.5.m5.1.1" xref="S3.SS4.p1.5.m5.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.5.m5.1b"><ci id="S3.SS4.p1.5.m5.1.1.cmml" xref="S3.SS4.p1.5.m5.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.5.m5.1c">I</annotation></semantics></math> and text encoder <math id="S3.SS4.p1.6.m6.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS4.p1.6.m6.1a"><mi id="S3.SS4.p1.6.m6.1.1" xref="S3.SS4.p1.6.m6.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.6.m6.1b"><ci id="S3.SS4.p1.6.m6.1.1.cmml" xref="S3.SS4.p1.6.m6.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.6.m6.1c">T</annotation></semantics></math> to extract their respective embeddings. These embeddings are then projected into a shared, multi-modal representation space with learnt projection matrices <math id="S3.SS4.p1.7.m7.1" class="ltx_Math" alttext="W_{i}" display="inline"><semantics id="S3.SS4.p1.7.m7.1a"><msub id="S3.SS4.p1.7.m7.1.1" xref="S3.SS4.p1.7.m7.1.1.cmml"><mi id="S3.SS4.p1.7.m7.1.1.2" xref="S3.SS4.p1.7.m7.1.1.2.cmml">W</mi><mi id="S3.SS4.p1.7.m7.1.1.3" xref="S3.SS4.p1.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.7.m7.1b"><apply id="S3.SS4.p1.7.m7.1.1.cmml" xref="S3.SS4.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.7.m7.1.1.1.cmml" xref="S3.SS4.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS4.p1.7.m7.1.1.2.cmml" xref="S3.SS4.p1.7.m7.1.1.2">𝑊</ci><ci id="S3.SS4.p1.7.m7.1.1.3.cmml" xref="S3.SS4.p1.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.7.m7.1c">W_{i}</annotation></semantics></math> and <math id="S3.SS4.p1.8.m8.1" class="ltx_Math" alttext="W_{t}" display="inline"><semantics id="S3.SS4.p1.8.m8.1a"><msub id="S3.SS4.p1.8.m8.1.1" xref="S3.SS4.p1.8.m8.1.1.cmml"><mi id="S3.SS4.p1.8.m8.1.1.2" xref="S3.SS4.p1.8.m8.1.1.2.cmml">W</mi><mi id="S3.SS4.p1.8.m8.1.1.3" xref="S3.SS4.p1.8.m8.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.8.m8.1b"><apply id="S3.SS4.p1.8.m8.1.1.cmml" xref="S3.SS4.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.8.m8.1.1.1.cmml" xref="S3.SS4.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS4.p1.8.m8.1.1.2.cmml" xref="S3.SS4.p1.8.m8.1.1.2">𝑊</ci><ci id="S3.SS4.p1.8.m8.1.1.3.cmml" xref="S3.SS4.p1.8.m8.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.8.m8.1c">W_{t}</annotation></semantics></math>. L2-normalisation is then applied to extract the final multi-modal embeddings <math id="S3.SS4.p1.9.m9.1" class="ltx_Math" alttext="Z_{i}\in\mathbb{R}^{n\times d}" display="inline"><semantics id="S3.SS4.p1.9.m9.1a"><mrow id="S3.SS4.p1.9.m9.1.1" xref="S3.SS4.p1.9.m9.1.1.cmml"><msub id="S3.SS4.p1.9.m9.1.1.2" xref="S3.SS4.p1.9.m9.1.1.2.cmml"><mi id="S3.SS4.p1.9.m9.1.1.2.2" xref="S3.SS4.p1.9.m9.1.1.2.2.cmml">Z</mi><mi id="S3.SS4.p1.9.m9.1.1.2.3" xref="S3.SS4.p1.9.m9.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS4.p1.9.m9.1.1.1" xref="S3.SS4.p1.9.m9.1.1.1.cmml">∈</mo><msup id="S3.SS4.p1.9.m9.1.1.3" xref="S3.SS4.p1.9.m9.1.1.3.cmml"><mi id="S3.SS4.p1.9.m9.1.1.3.2" xref="S3.SS4.p1.9.m9.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS4.p1.9.m9.1.1.3.3" xref="S3.SS4.p1.9.m9.1.1.3.3.cmml"><mi id="S3.SS4.p1.9.m9.1.1.3.3.2" xref="S3.SS4.p1.9.m9.1.1.3.3.2.cmml">n</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS4.p1.9.m9.1.1.3.3.1" xref="S3.SS4.p1.9.m9.1.1.3.3.1.cmml">×</mo><mi id="S3.SS4.p1.9.m9.1.1.3.3.3" xref="S3.SS4.p1.9.m9.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.9.m9.1b"><apply id="S3.SS4.p1.9.m9.1.1.cmml" xref="S3.SS4.p1.9.m9.1.1"><in id="S3.SS4.p1.9.m9.1.1.1.cmml" xref="S3.SS4.p1.9.m9.1.1.1"></in><apply id="S3.SS4.p1.9.m9.1.1.2.cmml" xref="S3.SS4.p1.9.m9.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p1.9.m9.1.1.2.1.cmml" xref="S3.SS4.p1.9.m9.1.1.2">subscript</csymbol><ci id="S3.SS4.p1.9.m9.1.1.2.2.cmml" xref="S3.SS4.p1.9.m9.1.1.2.2">𝑍</ci><ci id="S3.SS4.p1.9.m9.1.1.2.3.cmml" xref="S3.SS4.p1.9.m9.1.1.2.3">𝑖</ci></apply><apply id="S3.SS4.p1.9.m9.1.1.3.cmml" xref="S3.SS4.p1.9.m9.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.9.m9.1.1.3.1.cmml" xref="S3.SS4.p1.9.m9.1.1.3">superscript</csymbol><ci id="S3.SS4.p1.9.m9.1.1.3.2.cmml" xref="S3.SS4.p1.9.m9.1.1.3.2">ℝ</ci><apply id="S3.SS4.p1.9.m9.1.1.3.3.cmml" xref="S3.SS4.p1.9.m9.1.1.3.3"><times id="S3.SS4.p1.9.m9.1.1.3.3.1.cmml" xref="S3.SS4.p1.9.m9.1.1.3.3.1"></times><ci id="S3.SS4.p1.9.m9.1.1.3.3.2.cmml" xref="S3.SS4.p1.9.m9.1.1.3.3.2">𝑛</ci><ci id="S3.SS4.p1.9.m9.1.1.3.3.3.cmml" xref="S3.SS4.p1.9.m9.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.9.m9.1c">Z_{i}\in\mathbb{R}^{n\times d}</annotation></semantics></math> and <math id="S3.SS4.p1.10.m10.1" class="ltx_Math" alttext="Z_{t}\in\mathbb{R}^{n\times d}" display="inline"><semantics id="S3.SS4.p1.10.m10.1a"><mrow id="S3.SS4.p1.10.m10.1.1" xref="S3.SS4.p1.10.m10.1.1.cmml"><msub id="S3.SS4.p1.10.m10.1.1.2" xref="S3.SS4.p1.10.m10.1.1.2.cmml"><mi id="S3.SS4.p1.10.m10.1.1.2.2" xref="S3.SS4.p1.10.m10.1.1.2.2.cmml">Z</mi><mi id="S3.SS4.p1.10.m10.1.1.2.3" xref="S3.SS4.p1.10.m10.1.1.2.3.cmml">t</mi></msub><mo id="S3.SS4.p1.10.m10.1.1.1" xref="S3.SS4.p1.10.m10.1.1.1.cmml">∈</mo><msup id="S3.SS4.p1.10.m10.1.1.3" xref="S3.SS4.p1.10.m10.1.1.3.cmml"><mi id="S3.SS4.p1.10.m10.1.1.3.2" xref="S3.SS4.p1.10.m10.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS4.p1.10.m10.1.1.3.3" xref="S3.SS4.p1.10.m10.1.1.3.3.cmml"><mi id="S3.SS4.p1.10.m10.1.1.3.3.2" xref="S3.SS4.p1.10.m10.1.1.3.3.2.cmml">n</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS4.p1.10.m10.1.1.3.3.1" xref="S3.SS4.p1.10.m10.1.1.3.3.1.cmml">×</mo><mi id="S3.SS4.p1.10.m10.1.1.3.3.3" xref="S3.SS4.p1.10.m10.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.10.m10.1b"><apply id="S3.SS4.p1.10.m10.1.1.cmml" xref="S3.SS4.p1.10.m10.1.1"><in id="S3.SS4.p1.10.m10.1.1.1.cmml" xref="S3.SS4.p1.10.m10.1.1.1"></in><apply id="S3.SS4.p1.10.m10.1.1.2.cmml" xref="S3.SS4.p1.10.m10.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p1.10.m10.1.1.2.1.cmml" xref="S3.SS4.p1.10.m10.1.1.2">subscript</csymbol><ci id="S3.SS4.p1.10.m10.1.1.2.2.cmml" xref="S3.SS4.p1.10.m10.1.1.2.2">𝑍</ci><ci id="S3.SS4.p1.10.m10.1.1.2.3.cmml" xref="S3.SS4.p1.10.m10.1.1.2.3">𝑡</ci></apply><apply id="S3.SS4.p1.10.m10.1.1.3.cmml" xref="S3.SS4.p1.10.m10.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.10.m10.1.1.3.1.cmml" xref="S3.SS4.p1.10.m10.1.1.3">superscript</csymbol><ci id="S3.SS4.p1.10.m10.1.1.3.2.cmml" xref="S3.SS4.p1.10.m10.1.1.3.2">ℝ</ci><apply id="S3.SS4.p1.10.m10.1.1.3.3.cmml" xref="S3.SS4.p1.10.m10.1.1.3.3"><times id="S3.SS4.p1.10.m10.1.1.3.3.1.cmml" xref="S3.SS4.p1.10.m10.1.1.3.3.1"></times><ci id="S3.SS4.p1.10.m10.1.1.3.3.2.cmml" xref="S3.SS4.p1.10.m10.1.1.3.3.2">𝑛</ci><ci id="S3.SS4.p1.10.m10.1.1.3.3.3.cmml" xref="S3.SS4.p1.10.m10.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.10.m10.1c">Z_{t}\in\mathbb{R}^{n\times d}</annotation></semantics></math>:</p>
<table id="S3.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E8.m1.1" class="ltx_Math" alttext="\vspace{-0.25em}Z_{i}=\left\|I(X_{i})\cdot W_{i}\right\|_{2}" display="block"><semantics id="S3.E8.m1.1a"><mrow id="S3.E8.m1.1.1" xref="S3.E8.m1.1.1.cmml"><msub id="S3.E8.m1.1.1.3" xref="S3.E8.m1.1.1.3.cmml"><mi id="S3.E8.m1.1.1.3.2" xref="S3.E8.m1.1.1.3.2.cmml">Z</mi><mi id="S3.E8.m1.1.1.3.3" xref="S3.E8.m1.1.1.3.3.cmml">i</mi></msub><mo id="S3.E8.m1.1.1.2" xref="S3.E8.m1.1.1.2.cmml">=</mo><msub id="S3.E8.m1.1.1.1" xref="S3.E8.m1.1.1.1.cmml"><mrow id="S3.E8.m1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.2.cmml"><mo id="S3.E8.m1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E8.m1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.cmml"><mrow id="S3.E8.m1.1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.1.1.3.cmml">I</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E8.m1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E8.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">X</mi><mi id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo rspace="0.055em" stretchy="false" id="S3.E8.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="S3.E8.m1.1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.1.2.cmml">⋅</mo><msub id="S3.E8.m1.1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E8.m1.1.1.1.1.1.1.3.2" xref="S3.E8.m1.1.1.1.1.1.1.3.2.cmml">W</mi><mi id="S3.E8.m1.1.1.1.1.1.1.3.3" xref="S3.E8.m1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S3.E8.m1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E8.m1.1.1.1.3" xref="S3.E8.m1.1.1.1.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.1b"><apply id="S3.E8.m1.1.1.cmml" xref="S3.E8.m1.1.1"><eq id="S3.E8.m1.1.1.2.cmml" xref="S3.E8.m1.1.1.2"></eq><apply id="S3.E8.m1.1.1.3.cmml" xref="S3.E8.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.3.1.cmml" xref="S3.E8.m1.1.1.3">subscript</csymbol><ci id="S3.E8.m1.1.1.3.2.cmml" xref="S3.E8.m1.1.1.3.2">𝑍</ci><ci id="S3.E8.m1.1.1.3.3.cmml" xref="S3.E8.m1.1.1.3.3">𝑖</ci></apply><apply id="S3.E8.m1.1.1.1.cmml" xref="S3.E8.m1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1">subscript</csymbol><apply id="S3.E8.m1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E8.m1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E8.m1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1"><ci id="S3.E8.m1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.2">⋅</ci><apply id="S3.E8.m1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1"><times id="S3.E8.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.2"></times><ci id="S3.E8.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.3">𝐼</ci><apply id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.2">𝑋</ci><ci id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E8.m1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.2">𝑊</ci><ci id="S3.E8.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply><cn type="integer" id="S3.E8.m1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.1c">\vspace{-0.25em}Z_{i}=\left\|I(X_{i})\cdot W_{i}\right\|_{2}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<table id="S3.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E9.m1.1" class="ltx_Math" alttext="Z_{t}=\left\|T(X_{t})\cdot W_{t}\right\|_{2}\vspace{-0.25em}" display="block"><semantics id="S3.E9.m1.1a"><mrow id="S3.E9.m1.1.1" xref="S3.E9.m1.1.1.cmml"><msub id="S3.E9.m1.1.1.3" xref="S3.E9.m1.1.1.3.cmml"><mi id="S3.E9.m1.1.1.3.2" xref="S3.E9.m1.1.1.3.2.cmml">Z</mi><mi id="S3.E9.m1.1.1.3.3" xref="S3.E9.m1.1.1.3.3.cmml">t</mi></msub><mo id="S3.E9.m1.1.1.2" xref="S3.E9.m1.1.1.2.cmml">=</mo><msub id="S3.E9.m1.1.1.1" xref="S3.E9.m1.1.1.1.cmml"><mrow id="S3.E9.m1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.2.cmml"><mo id="S3.E9.m1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E9.m1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.cmml"><mrow id="S3.E9.m1.1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E9.m1.1.1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.1.1.3.cmml">T</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.1.1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E9.m1.1.1.1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E9.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">X</mi><mi id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo rspace="0.055em" stretchy="false" id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="S3.E9.m1.1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.1.2.cmml">⋅</mo><msub id="S3.E9.m1.1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E9.m1.1.1.1.1.1.1.3.2" xref="S3.E9.m1.1.1.1.1.1.1.3.2.cmml">W</mi><mi id="S3.E9.m1.1.1.1.1.1.1.3.3" xref="S3.E9.m1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S3.E9.m1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E9.m1.1.1.1.3" xref="S3.E9.m1.1.1.1.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.1b"><apply id="S3.E9.m1.1.1.cmml" xref="S3.E9.m1.1.1"><eq id="S3.E9.m1.1.1.2.cmml" xref="S3.E9.m1.1.1.2"></eq><apply id="S3.E9.m1.1.1.3.cmml" xref="S3.E9.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.3.1.cmml" xref="S3.E9.m1.1.1.3">subscript</csymbol><ci id="S3.E9.m1.1.1.3.2.cmml" xref="S3.E9.m1.1.1.3.2">𝑍</ci><ci id="S3.E9.m1.1.1.3.3.cmml" xref="S3.E9.m1.1.1.3.3">𝑡</ci></apply><apply id="S3.E9.m1.1.1.1.cmml" xref="S3.E9.m1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1">subscript</csymbol><apply id="S3.E9.m1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E9.m1.1.1.1.1.2.1.cmml" xref="S3.E9.m1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E9.m1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1"><ci id="S3.E9.m1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.2">⋅</ci><apply id="S3.E9.m1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1"><times id="S3.E9.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.2"></times><ci id="S3.E9.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.3">𝑇</ci><apply id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.2">𝑋</ci><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply><apply id="S3.E9.m1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E9.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.3.2">𝑊</ci><ci id="S3.E9.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply><cn type="integer" id="S3.E9.m1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.1c">Z_{t}=\left\|T(X_{t})\cdot W_{t}\right\|_{2}\vspace{-0.25em}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p1.12" class="ltx_p">The cosine similarity of the shared embeddings is then calculated, and multiplied by a learnt temperature parameter <math id="S3.SS4.p1.11.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS4.p1.11.m1.1a"><mi id="S3.SS4.p1.11.m1.1.1" xref="S3.SS4.p1.11.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.11.m1.1b"><ci id="S3.SS4.p1.11.m1.1.1.cmml" xref="S3.SS4.p1.11.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.11.m1.1c">t</annotation></semantics></math> to calculate similarity scores <math id="S3.SS4.p1.12.m2.1" class="ltx_Math" alttext="S\in\mathbb{R}^{n\times n}" display="inline"><semantics id="S3.SS4.p1.12.m2.1a"><mrow id="S3.SS4.p1.12.m2.1.1" xref="S3.SS4.p1.12.m2.1.1.cmml"><mi id="S3.SS4.p1.12.m2.1.1.2" xref="S3.SS4.p1.12.m2.1.1.2.cmml">S</mi><mo id="S3.SS4.p1.12.m2.1.1.1" xref="S3.SS4.p1.12.m2.1.1.1.cmml">∈</mo><msup id="S3.SS4.p1.12.m2.1.1.3" xref="S3.SS4.p1.12.m2.1.1.3.cmml"><mi id="S3.SS4.p1.12.m2.1.1.3.2" xref="S3.SS4.p1.12.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS4.p1.12.m2.1.1.3.3" xref="S3.SS4.p1.12.m2.1.1.3.3.cmml"><mi id="S3.SS4.p1.12.m2.1.1.3.3.2" xref="S3.SS4.p1.12.m2.1.1.3.3.2.cmml">n</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS4.p1.12.m2.1.1.3.3.1" xref="S3.SS4.p1.12.m2.1.1.3.3.1.cmml">×</mo><mi id="S3.SS4.p1.12.m2.1.1.3.3.3" xref="S3.SS4.p1.12.m2.1.1.3.3.3.cmml">n</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.12.m2.1b"><apply id="S3.SS4.p1.12.m2.1.1.cmml" xref="S3.SS4.p1.12.m2.1.1"><in id="S3.SS4.p1.12.m2.1.1.1.cmml" xref="S3.SS4.p1.12.m2.1.1.1"></in><ci id="S3.SS4.p1.12.m2.1.1.2.cmml" xref="S3.SS4.p1.12.m2.1.1.2">𝑆</ci><apply id="S3.SS4.p1.12.m2.1.1.3.cmml" xref="S3.SS4.p1.12.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.12.m2.1.1.3.1.cmml" xref="S3.SS4.p1.12.m2.1.1.3">superscript</csymbol><ci id="S3.SS4.p1.12.m2.1.1.3.2.cmml" xref="S3.SS4.p1.12.m2.1.1.3.2">ℝ</ci><apply id="S3.SS4.p1.12.m2.1.1.3.3.cmml" xref="S3.SS4.p1.12.m2.1.1.3.3"><times id="S3.SS4.p1.12.m2.1.1.3.3.1.cmml" xref="S3.SS4.p1.12.m2.1.1.3.3.1"></times><ci id="S3.SS4.p1.12.m2.1.1.3.3.2.cmml" xref="S3.SS4.p1.12.m2.1.1.3.3.2">𝑛</ci><ci id="S3.SS4.p1.12.m2.1.1.3.3.3.cmml" xref="S3.SS4.p1.12.m2.1.1.3.3.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.12.m2.1c">S\in\mathbb{R}^{n\times n}</annotation></semantics></math> for each text and image pair in the batch:</p>
<table id="S3.E10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E10.m1.2" class="ltx_Math" alttext="S=(Z_{i}\cdot Z_{t}^{T})*exp(t)" display="block"><semantics id="S3.E10.m1.2a"><mrow id="S3.E10.m1.2.2" xref="S3.E10.m1.2.2.cmml"><mi id="S3.E10.m1.2.2.3" xref="S3.E10.m1.2.2.3.cmml">S</mi><mo id="S3.E10.m1.2.2.2" xref="S3.E10.m1.2.2.2.cmml">=</mo><mrow id="S3.E10.m1.2.2.1" xref="S3.E10.m1.2.2.1.cmml"><mrow id="S3.E10.m1.2.2.1.1" xref="S3.E10.m1.2.2.1.1.cmml"><mrow id="S3.E10.m1.2.2.1.1.1.1" xref="S3.E10.m1.2.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E10.m1.2.2.1.1.1.1.2" xref="S3.E10.m1.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S3.E10.m1.2.2.1.1.1.1.1" xref="S3.E10.m1.2.2.1.1.1.1.1.cmml"><msub id="S3.E10.m1.2.2.1.1.1.1.1.2" xref="S3.E10.m1.2.2.1.1.1.1.1.2.cmml"><mi id="S3.E10.m1.2.2.1.1.1.1.1.2.2" xref="S3.E10.m1.2.2.1.1.1.1.1.2.2.cmml">Z</mi><mi id="S3.E10.m1.2.2.1.1.1.1.1.2.3" xref="S3.E10.m1.2.2.1.1.1.1.1.2.3.cmml">i</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E10.m1.2.2.1.1.1.1.1.1" xref="S3.E10.m1.2.2.1.1.1.1.1.1.cmml">⋅</mo><msubsup id="S3.E10.m1.2.2.1.1.1.1.1.3" xref="S3.E10.m1.2.2.1.1.1.1.1.3.cmml"><mi id="S3.E10.m1.2.2.1.1.1.1.1.3.2.2" xref="S3.E10.m1.2.2.1.1.1.1.1.3.2.2.cmml">Z</mi><mi id="S3.E10.m1.2.2.1.1.1.1.1.3.2.3" xref="S3.E10.m1.2.2.1.1.1.1.1.3.2.3.cmml">t</mi><mi id="S3.E10.m1.2.2.1.1.1.1.1.3.3" xref="S3.E10.m1.2.2.1.1.1.1.1.3.3.cmml">T</mi></msubsup></mrow><mo rspace="0.055em" stretchy="false" id="S3.E10.m1.2.2.1.1.1.1.3" xref="S3.E10.m1.2.2.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S3.E10.m1.2.2.1.1.2" xref="S3.E10.m1.2.2.1.1.2.cmml">∗</mo><mi id="S3.E10.m1.2.2.1.1.3" xref="S3.E10.m1.2.2.1.1.3.cmml">e</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E10.m1.2.2.1.2" xref="S3.E10.m1.2.2.1.2.cmml">​</mo><mi id="S3.E10.m1.2.2.1.3" xref="S3.E10.m1.2.2.1.3.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.2.2.1.2a" xref="S3.E10.m1.2.2.1.2.cmml">​</mo><mi id="S3.E10.m1.2.2.1.4" xref="S3.E10.m1.2.2.1.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.2.2.1.2b" xref="S3.E10.m1.2.2.1.2.cmml">​</mo><mrow id="S3.E10.m1.2.2.1.5.2" xref="S3.E10.m1.2.2.1.cmml"><mo stretchy="false" id="S3.E10.m1.2.2.1.5.2.1" xref="S3.E10.m1.2.2.1.cmml">(</mo><mi id="S3.E10.m1.1.1" xref="S3.E10.m1.1.1.cmml">t</mi><mo stretchy="false" id="S3.E10.m1.2.2.1.5.2.2" xref="S3.E10.m1.2.2.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.2b"><apply id="S3.E10.m1.2.2.cmml" xref="S3.E10.m1.2.2"><eq id="S3.E10.m1.2.2.2.cmml" xref="S3.E10.m1.2.2.2"></eq><ci id="S3.E10.m1.2.2.3.cmml" xref="S3.E10.m1.2.2.3">𝑆</ci><apply id="S3.E10.m1.2.2.1.cmml" xref="S3.E10.m1.2.2.1"><times id="S3.E10.m1.2.2.1.2.cmml" xref="S3.E10.m1.2.2.1.2"></times><apply id="S3.E10.m1.2.2.1.1.cmml" xref="S3.E10.m1.2.2.1.1"><times id="S3.E10.m1.2.2.1.1.2.cmml" xref="S3.E10.m1.2.2.1.1.2"></times><apply id="S3.E10.m1.2.2.1.1.1.1.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1"><ci id="S3.E10.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1">⋅</ci><apply id="S3.E10.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.1.1.1.2.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E10.m1.2.2.1.1.1.1.1.2.2.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.2.2">𝑍</ci><ci id="S3.E10.m1.2.2.1.1.1.1.1.2.3.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E10.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.1.1.1.3.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.3">superscript</csymbol><apply id="S3.E10.m1.2.2.1.1.1.1.1.3.2.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.1.1.1.3.2.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E10.m1.2.2.1.1.1.1.1.3.2.2.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.3.2.2">𝑍</ci><ci id="S3.E10.m1.2.2.1.1.1.1.1.3.2.3.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.3.2.3">𝑡</ci></apply><ci id="S3.E10.m1.2.2.1.1.1.1.1.3.3.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.3.3">𝑇</ci></apply></apply><ci id="S3.E10.m1.2.2.1.1.3.cmml" xref="S3.E10.m1.2.2.1.1.3">𝑒</ci></apply><ci id="S3.E10.m1.2.2.1.3.cmml" xref="S3.E10.m1.2.2.1.3">𝑥</ci><ci id="S3.E10.m1.2.2.1.4.cmml" xref="S3.E10.m1.2.2.1.4">𝑝</ci><ci id="S3.E10.m1.1.1.cmml" xref="S3.E10.m1.1.1">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.2c">S=(Z_{i}\cdot Z_{t}^{T})*exp(t)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p1.13" class="ltx_p">During training, a cross-entropy loss is applied to the similarity scores to encourage similarity between true image-text pairs and discourage similarity between false pairs. Our work uses the pretrained model to generate similarity scores between images and image classification labels.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">Method</span>
</h2>

<figure id="S4.F2" class="ltx_figure"><img src="/html/2302.06039/assets/Figures/class_ratio_prediction_1.4.png" id="S4.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="1190" height="112" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Our proposed method for predicting the class ratio of the unlabelled data. CLIP is used to calculate the similarity between the labelled images <math id="S4.F2.10.m1.1" class="ltx_Math" alttext="X_{l}" display="inline"><semantics id="S4.F2.10.m1.1b"><msub id="S4.F2.10.m1.1.1" xref="S4.F2.10.m1.1.1.cmml"><mi id="S4.F2.10.m1.1.1.2" xref="S4.F2.10.m1.1.1.2.cmml">X</mi><mi id="S4.F2.10.m1.1.1.3" xref="S4.F2.10.m1.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S4.F2.10.m1.1c"><apply id="S4.F2.10.m1.1.1.cmml" xref="S4.F2.10.m1.1.1"><csymbol cd="ambiguous" id="S4.F2.10.m1.1.1.1.cmml" xref="S4.F2.10.m1.1.1">subscript</csymbol><ci id="S4.F2.10.m1.1.1.2.cmml" xref="S4.F2.10.m1.1.1.2">𝑋</ci><ci id="S4.F2.10.m1.1.1.3.cmml" xref="S4.F2.10.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.10.m1.1d">X_{l}</annotation></semantics></math> and a series of natural language labels <math id="S4.F2.11.m2.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S4.F2.11.m2.1b"><mi id="S4.F2.11.m2.1.1" xref="S4.F2.11.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.F2.11.m2.1c"><ci id="S4.F2.11.m2.1.1.cmml" xref="S4.F2.11.m2.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.11.m2.1d">L</annotation></semantics></math> of the form “a photo of class <math id="S4.F2.12.m3.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S4.F2.12.m3.1b"><mi id="S4.F2.12.m3.1.1" xref="S4.F2.12.m3.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.F2.12.m3.1c"><ci id="S4.F2.12.m3.1.1.cmml" xref="S4.F2.12.m3.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.12.m3.1d">c</annotation></semantics></math>”. Using the labelled similarity vector <math id="S4.F2.13.m4.1" class="ltx_Math" alttext="\bm{s_{l}}" display="inline"><semantics id="S4.F2.13.m4.1b"><msub id="S4.F2.13.m4.1.1" xref="S4.F2.13.m4.1.1.cmml"><mi id="S4.F2.13.m4.1.1.2" xref="S4.F2.13.m4.1.1.2.cmml">𝒔</mi><mi id="S4.F2.13.m4.1.1.3" xref="S4.F2.13.m4.1.1.3.cmml">𝒍</mi></msub><annotation-xml encoding="MathML-Content" id="S4.F2.13.m4.1c"><apply id="S4.F2.13.m4.1.1.cmml" xref="S4.F2.13.m4.1.1"><csymbol cd="ambiguous" id="S4.F2.13.m4.1.1.1.cmml" xref="S4.F2.13.m4.1.1">subscript</csymbol><ci id="S4.F2.13.m4.1.1.2.cmml" xref="S4.F2.13.m4.1.1.2">𝒔</ci><ci id="S4.F2.13.m4.1.1.3.cmml" xref="S4.F2.13.m4.1.1.3">𝒍</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.13.m4.1d">\bm{s_{l}}</annotation></semantics></math> as a domain invariant representation of semantic context, two linear regression models are fit to predict the number of instances <math id="S4.F2.14.m5.2" class="ltx_Math" alttext="g(\bm{s},\beta_{g})" display="inline"><semantics id="S4.F2.14.m5.2b"><mrow id="S4.F2.14.m5.2.2" xref="S4.F2.14.m5.2.2.cmml"><mi id="S4.F2.14.m5.2.2.3" xref="S4.F2.14.m5.2.2.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.F2.14.m5.2.2.2" xref="S4.F2.14.m5.2.2.2.cmml">​</mo><mrow id="S4.F2.14.m5.2.2.1.1" xref="S4.F2.14.m5.2.2.1.2.cmml"><mo stretchy="false" id="S4.F2.14.m5.2.2.1.1.2" xref="S4.F2.14.m5.2.2.1.2.cmml">(</mo><mi id="S4.F2.14.m5.1.1" xref="S4.F2.14.m5.1.1.cmml">𝒔</mi><mo id="S4.F2.14.m5.2.2.1.1.3" xref="S4.F2.14.m5.2.2.1.2.cmml">,</mo><msub id="S4.F2.14.m5.2.2.1.1.1" xref="S4.F2.14.m5.2.2.1.1.1.cmml"><mi id="S4.F2.14.m5.2.2.1.1.1.2" xref="S4.F2.14.m5.2.2.1.1.1.2.cmml">β</mi><mi id="S4.F2.14.m5.2.2.1.1.1.3" xref="S4.F2.14.m5.2.2.1.1.1.3.cmml">g</mi></msub><mo stretchy="false" id="S4.F2.14.m5.2.2.1.1.4" xref="S4.F2.14.m5.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.F2.14.m5.2c"><apply id="S4.F2.14.m5.2.2.cmml" xref="S4.F2.14.m5.2.2"><times id="S4.F2.14.m5.2.2.2.cmml" xref="S4.F2.14.m5.2.2.2"></times><ci id="S4.F2.14.m5.2.2.3.cmml" xref="S4.F2.14.m5.2.2.3">𝑔</ci><interval closure="open" id="S4.F2.14.m5.2.2.1.2.cmml" xref="S4.F2.14.m5.2.2.1.1"><ci id="S4.F2.14.m5.1.1.cmml" xref="S4.F2.14.m5.1.1">𝒔</ci><apply id="S4.F2.14.m5.2.2.1.1.1.cmml" xref="S4.F2.14.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.F2.14.m5.2.2.1.1.1.1.cmml" xref="S4.F2.14.m5.2.2.1.1.1">subscript</csymbol><ci id="S4.F2.14.m5.2.2.1.1.1.2.cmml" xref="S4.F2.14.m5.2.2.1.1.1.2">𝛽</ci><ci id="S4.F2.14.m5.2.2.1.1.1.3.cmml" xref="S4.F2.14.m5.2.2.1.1.1.3">𝑔</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.14.m5.2d">g(\bm{s},\beta_{g})</annotation></semantics></math> and the class ratio <math id="S4.F2.15.m6.2" class="ltx_Math" alttext="k(\bm{s},\beta_{k})" display="inline"><semantics id="S4.F2.15.m6.2b"><mrow id="S4.F2.15.m6.2.2" xref="S4.F2.15.m6.2.2.cmml"><mi id="S4.F2.15.m6.2.2.3" xref="S4.F2.15.m6.2.2.3.cmml">k</mi><mo lspace="0em" rspace="0em" id="S4.F2.15.m6.2.2.2" xref="S4.F2.15.m6.2.2.2.cmml">​</mo><mrow id="S4.F2.15.m6.2.2.1.1" xref="S4.F2.15.m6.2.2.1.2.cmml"><mo stretchy="false" id="S4.F2.15.m6.2.2.1.1.2" xref="S4.F2.15.m6.2.2.1.2.cmml">(</mo><mi id="S4.F2.15.m6.1.1" xref="S4.F2.15.m6.1.1.cmml">𝒔</mi><mo id="S4.F2.15.m6.2.2.1.1.3" xref="S4.F2.15.m6.2.2.1.2.cmml">,</mo><msub id="S4.F2.15.m6.2.2.1.1.1" xref="S4.F2.15.m6.2.2.1.1.1.cmml"><mi id="S4.F2.15.m6.2.2.1.1.1.2" xref="S4.F2.15.m6.2.2.1.1.1.2.cmml">β</mi><mi id="S4.F2.15.m6.2.2.1.1.1.3" xref="S4.F2.15.m6.2.2.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S4.F2.15.m6.2.2.1.1.4" xref="S4.F2.15.m6.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.F2.15.m6.2c"><apply id="S4.F2.15.m6.2.2.cmml" xref="S4.F2.15.m6.2.2"><times id="S4.F2.15.m6.2.2.2.cmml" xref="S4.F2.15.m6.2.2.2"></times><ci id="S4.F2.15.m6.2.2.3.cmml" xref="S4.F2.15.m6.2.2.3">𝑘</ci><interval closure="open" id="S4.F2.15.m6.2.2.1.2.cmml" xref="S4.F2.15.m6.2.2.1.1"><ci id="S4.F2.15.m6.1.1.cmml" xref="S4.F2.15.m6.1.1">𝒔</ci><apply id="S4.F2.15.m6.2.2.1.1.1.cmml" xref="S4.F2.15.m6.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.F2.15.m6.2.2.1.1.1.1.cmml" xref="S4.F2.15.m6.2.2.1.1.1">subscript</csymbol><ci id="S4.F2.15.m6.2.2.1.1.1.2.cmml" xref="S4.F2.15.m6.2.2.1.1.1.2">𝛽</ci><ci id="S4.F2.15.m6.2.2.1.1.1.3.cmml" xref="S4.F2.15.m6.2.2.1.1.1.3">𝑘</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.15.m6.2d">k(\bm{s},\beta_{k})</annotation></semantics></math> in each labelled image. To make a prediction for the class ratio of the unlabelled images <math id="S4.F2.16.m7.1" class="ltx_Math" alttext="X_{u}" display="inline"><semantics id="S4.F2.16.m7.1b"><msub id="S4.F2.16.m7.1.1" xref="S4.F2.16.m7.1.1.cmml"><mi id="S4.F2.16.m7.1.1.2" xref="S4.F2.16.m7.1.1.2.cmml">X</mi><mi id="S4.F2.16.m7.1.1.3" xref="S4.F2.16.m7.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S4.F2.16.m7.1c"><apply id="S4.F2.16.m7.1.1.cmml" xref="S4.F2.16.m7.1.1"><csymbol cd="ambiguous" id="S4.F2.16.m7.1.1.1.cmml" xref="S4.F2.16.m7.1.1">subscript</csymbol><ci id="S4.F2.16.m7.1.1.2.cmml" xref="S4.F2.16.m7.1.1.2">𝑋</ci><ci id="S4.F2.16.m7.1.1.3.cmml" xref="S4.F2.16.m7.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.16.m7.1d">X_{u}</annotation></semantics></math>, CLIP is used to extract the similarity vectors <math id="S4.F2.17.m8.1" class="ltx_Math" alttext="\bm{s_{u}}" display="inline"><semantics id="S4.F2.17.m8.1b"><msub id="S4.F2.17.m8.1.1" xref="S4.F2.17.m8.1.1.cmml"><mi id="S4.F2.17.m8.1.1.2" xref="S4.F2.17.m8.1.1.2.cmml">𝒔</mi><mi id="S4.F2.17.m8.1.1.3" xref="S4.F2.17.m8.1.1.3.cmml">𝒖</mi></msub><annotation-xml encoding="MathML-Content" id="S4.F2.17.m8.1c"><apply id="S4.F2.17.m8.1.1.cmml" xref="S4.F2.17.m8.1.1"><csymbol cd="ambiguous" id="S4.F2.17.m8.1.1.1.cmml" xref="S4.F2.17.m8.1.1">subscript</csymbol><ci id="S4.F2.17.m8.1.1.2.cmml" xref="S4.F2.17.m8.1.1.2">𝒔</ci><ci id="S4.F2.17.m8.1.1.3.cmml" xref="S4.F2.17.m8.1.1.3">𝒖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.17.m8.1d">\bm{s_{u}}</annotation></semantics></math>. The mean similarity vector <math id="S4.F2.18.m9.1" class="ltx_Math" alttext="\bm{\overline{s_{u}}}" display="inline"><semantics id="S4.F2.18.m9.1b"><mover accent="true" id="S4.F2.18.m9.1.1" xref="S4.F2.18.m9.1.1.cmml"><msub id="S4.F2.18.m9.1.1.2" xref="S4.F2.18.m9.1.1.2.cmml"><mi id="S4.F2.18.m9.1.1.2.2" xref="S4.F2.18.m9.1.1.2.2.cmml">𝒔</mi><mi id="S4.F2.18.m9.1.1.2.3" xref="S4.F2.18.m9.1.1.2.3.cmml">𝒖</mi></msub><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S4.F2.18.m9.1.1.1" xref="S4.F2.18.m9.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S4.F2.18.m9.1c"><apply id="S4.F2.18.m9.1.1.cmml" xref="S4.F2.18.m9.1.1"><ci id="S4.F2.18.m9.1.1.1.cmml" xref="S4.F2.18.m9.1.1.1">bold-¯</ci><apply id="S4.F2.18.m9.1.1.2.cmml" xref="S4.F2.18.m9.1.1.2"><csymbol cd="ambiguous" id="S4.F2.18.m9.1.1.2.1.cmml" xref="S4.F2.18.m9.1.1.2">subscript</csymbol><ci id="S4.F2.18.m9.1.1.2.2.cmml" xref="S4.F2.18.m9.1.1.2.2">𝒔</ci><ci id="S4.F2.18.m9.1.1.2.3.cmml" xref="S4.F2.18.m9.1.1.2.3">𝒖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.18.m9.1d">\bm{\overline{s_{u}}}</annotation></semantics></math> is then calculated and input to the linear regression models to generate two distinct predictions for the class ratio of the entire unlabelled dataset. These predictions are merged by calculating the geometric mean, and the relative change in class ratio squared to account for persistent underestimation.</figcaption>
</figure>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS1.5.1.1" class="ltx_text">IV-A</span> </span><span id="S4.SS1.6.2" class="ltx_text ltx_font_italic">Class Distribution Prediction</span>
</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.7" class="ltx_p">We aim to predict the class ratio of the unlabelled data <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="\bm{r^{u}}\in\mathbb{R}^{n_{c}}" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mrow id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml"><msup id="S4.SS1.p1.1.m1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.2.cmml"><mi id="S4.SS1.p1.1.m1.1.1.2.2" xref="S4.SS1.p1.1.m1.1.1.2.2.cmml">𝒓</mi><mi id="S4.SS1.p1.1.m1.1.1.2.3" xref="S4.SS1.p1.1.m1.1.1.2.3.cmml">𝒖</mi></msup><mo id="S4.SS1.p1.1.m1.1.1.1" xref="S4.SS1.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S4.SS1.p1.1.m1.1.1.3" xref="S4.SS1.p1.1.m1.1.1.3.cmml"><mi id="S4.SS1.p1.1.m1.1.1.3.2" xref="S4.SS1.p1.1.m1.1.1.3.2.cmml">ℝ</mi><msub id="S4.SS1.p1.1.m1.1.1.3.3" xref="S4.SS1.p1.1.m1.1.1.3.3.cmml"><mi id="S4.SS1.p1.1.m1.1.1.3.3.2" xref="S4.SS1.p1.1.m1.1.1.3.3.2.cmml">n</mi><mi id="S4.SS1.p1.1.m1.1.1.3.3.3" xref="S4.SS1.p1.1.m1.1.1.3.3.3.cmml">c</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"><in id="S4.SS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1"></in><apply id="S4.SS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.1.2.1.cmml" xref="S4.SS1.p1.1.m1.1.1.2">superscript</csymbol><ci id="S4.SS1.p1.1.m1.1.1.2.2.cmml" xref="S4.SS1.p1.1.m1.1.1.2.2">𝒓</ci><ci id="S4.SS1.p1.1.m1.1.1.2.3.cmml" xref="S4.SS1.p1.1.m1.1.1.2.3">𝒖</ci></apply><apply id="S4.SS1.p1.1.m1.1.1.3.cmml" xref="S4.SS1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.1.3.1.cmml" xref="S4.SS1.p1.1.m1.1.1.3">superscript</csymbol><ci id="S4.SS1.p1.1.m1.1.1.3.2.cmml" xref="S4.SS1.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S4.SS1.p1.1.m1.1.1.3.3.cmml" xref="S4.SS1.p1.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.1.3.3.1.cmml" xref="S4.SS1.p1.1.m1.1.1.3.3">subscript</csymbol><ci id="S4.SS1.p1.1.m1.1.1.3.3.2.cmml" xref="S4.SS1.p1.1.m1.1.1.3.3.2">𝑛</ci><ci id="S4.SS1.p1.1.m1.1.1.3.3.3.cmml" xref="S4.SS1.p1.1.m1.1.1.3.3.3">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">\bm{r^{u}}\in\mathbb{R}^{n_{c}}</annotation></semantics></math>, such that it can be used as prior for performing ACT. An overview of this approach can be found in Figure <a href="#S4.F2" title="Figure 2 ‣ IV Method ‣ Predicting Class Distribution Shift for Reliable Domain Adaptive Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. We start by using CLIP to generate a representation of the semantic context of each image. To do so, we calculate the similarity between the labelled images <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="X_{l}" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><msub id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><mi id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml">X</mi><mi id="S4.SS1.p1.2.m2.1.1.3" xref="S4.SS1.p1.2.m2.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2">𝑋</ci><ci id="S4.SS1.p1.2.m2.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">X_{l}</annotation></semantics></math> and a series of natural language prompts <math id="S4.SS1.p1.3.m3.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S4.SS1.p1.3.m3.1a"><mi id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><ci id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">L</annotation></semantics></math>. The performance of vision-language models on downstream tasks is sensitive to the format of natural language labels, leading to the development of prompt optimisation techniques <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>. We implement a simple approach to generate <math id="S4.SS1.p1.4.m4.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S4.SS1.p1.4.m4.1a"><mi id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><ci id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">L</annotation></semantics></math> where each class label <math id="S4.SS1.p1.5.m5.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S4.SS1.p1.5.m5.1a"><mi id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><ci id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">c</annotation></semantics></math> is converted to a prompt of the form “a photo of <math id="S4.SS1.p1.6.m6.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S4.SS1.p1.6.m6.1a"><mi id="S4.SS1.p1.6.m6.1.1" xref="S4.SS1.p1.6.m6.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m6.1b"><ci id="S4.SS1.p1.6.m6.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m6.1c">c</annotation></semantics></math>” <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>. For each labelled image, this results in a vector of similarity scores <math id="S4.SS1.p1.7.m7.1" class="ltx_Math" alttext="\bm{s_{l}}\in\mathbb{R}^{n_{c}}" display="inline"><semantics id="S4.SS1.p1.7.m7.1a"><mrow id="S4.SS1.p1.7.m7.1.1" xref="S4.SS1.p1.7.m7.1.1.cmml"><msub id="S4.SS1.p1.7.m7.1.1.2" xref="S4.SS1.p1.7.m7.1.1.2.cmml"><mi id="S4.SS1.p1.7.m7.1.1.2.2" xref="S4.SS1.p1.7.m7.1.1.2.2.cmml">𝒔</mi><mi id="S4.SS1.p1.7.m7.1.1.2.3" xref="S4.SS1.p1.7.m7.1.1.2.3.cmml">𝒍</mi></msub><mo id="S4.SS1.p1.7.m7.1.1.1" xref="S4.SS1.p1.7.m7.1.1.1.cmml">∈</mo><msup id="S4.SS1.p1.7.m7.1.1.3" xref="S4.SS1.p1.7.m7.1.1.3.cmml"><mi id="S4.SS1.p1.7.m7.1.1.3.2" xref="S4.SS1.p1.7.m7.1.1.3.2.cmml">ℝ</mi><msub id="S4.SS1.p1.7.m7.1.1.3.3" xref="S4.SS1.p1.7.m7.1.1.3.3.cmml"><mi id="S4.SS1.p1.7.m7.1.1.3.3.2" xref="S4.SS1.p1.7.m7.1.1.3.3.2.cmml">n</mi><mi id="S4.SS1.p1.7.m7.1.1.3.3.3" xref="S4.SS1.p1.7.m7.1.1.3.3.3.cmml">c</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m7.1b"><apply id="S4.SS1.p1.7.m7.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1"><in id="S4.SS1.p1.7.m7.1.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1.1"></in><apply id="S4.SS1.p1.7.m7.1.1.2.cmml" xref="S4.SS1.p1.7.m7.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.7.m7.1.1.2.1.cmml" xref="S4.SS1.p1.7.m7.1.1.2">subscript</csymbol><ci id="S4.SS1.p1.7.m7.1.1.2.2.cmml" xref="S4.SS1.p1.7.m7.1.1.2.2">𝒔</ci><ci id="S4.SS1.p1.7.m7.1.1.2.3.cmml" xref="S4.SS1.p1.7.m7.1.1.2.3">𝒍</ci></apply><apply id="S4.SS1.p1.7.m7.1.1.3.cmml" xref="S4.SS1.p1.7.m7.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.7.m7.1.1.3.1.cmml" xref="S4.SS1.p1.7.m7.1.1.3">superscript</csymbol><ci id="S4.SS1.p1.7.m7.1.1.3.2.cmml" xref="S4.SS1.p1.7.m7.1.1.3.2">ℝ</ci><apply id="S4.SS1.p1.7.m7.1.1.3.3.cmml" xref="S4.SS1.p1.7.m7.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS1.p1.7.m7.1.1.3.3.1.cmml" xref="S4.SS1.p1.7.m7.1.1.3.3">subscript</csymbol><ci id="S4.SS1.p1.7.m7.1.1.3.3.2.cmml" xref="S4.SS1.p1.7.m7.1.1.3.3.2">𝑛</ci><ci id="S4.SS1.p1.7.m7.1.1.3.3.3.cmml" xref="S4.SS1.p1.7.m7.1.1.3.3.3">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m7.1c">\bm{s_{l}}\in\mathbb{R}^{n_{c}}</annotation></semantics></math> that characterise how the image relates to the text prompts <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>. As the natural language descriptions used to generate the similarity vectors are resistant to domain shift <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>, this results in a contextual representation that is consistent across the source and target data.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.4" class="ltx_p">We investigate two linear regression models, g and k, for predicting the class ratio given the similarity vector <math id="S4.SS1.p2.1.m1.1" class="ltx_Math" alttext="\bm{s}" display="inline"><semantics id="S4.SS1.p2.1.m1.1a"><mi id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml">𝒔</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><ci id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">𝒔</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">\bm{s}</annotation></semantics></math> as a domain invariant input. The absolute model <math id="S4.SS1.p2.2.m2.2" class="ltx_Math" alttext="g(\bm{s},\beta_{g})" display="inline"><semantics id="S4.SS1.p2.2.m2.2a"><mrow id="S4.SS1.p2.2.m2.2.2" xref="S4.SS1.p2.2.m2.2.2.cmml"><mi id="S4.SS1.p2.2.m2.2.2.3" xref="S4.SS1.p2.2.m2.2.2.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p2.2.m2.2.2.2" xref="S4.SS1.p2.2.m2.2.2.2.cmml">​</mo><mrow id="S4.SS1.p2.2.m2.2.2.1.1" xref="S4.SS1.p2.2.m2.2.2.1.2.cmml"><mo stretchy="false" id="S4.SS1.p2.2.m2.2.2.1.1.2" xref="S4.SS1.p2.2.m2.2.2.1.2.cmml">(</mo><mi id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml">𝒔</mi><mo id="S4.SS1.p2.2.m2.2.2.1.1.3" xref="S4.SS1.p2.2.m2.2.2.1.2.cmml">,</mo><msub id="S4.SS1.p2.2.m2.2.2.1.1.1" xref="S4.SS1.p2.2.m2.2.2.1.1.1.cmml"><mi id="S4.SS1.p2.2.m2.2.2.1.1.1.2" xref="S4.SS1.p2.2.m2.2.2.1.1.1.2.cmml">β</mi><mi id="S4.SS1.p2.2.m2.2.2.1.1.1.3" xref="S4.SS1.p2.2.m2.2.2.1.1.1.3.cmml">g</mi></msub><mo stretchy="false" id="S4.SS1.p2.2.m2.2.2.1.1.4" xref="S4.SS1.p2.2.m2.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.2b"><apply id="S4.SS1.p2.2.m2.2.2.cmml" xref="S4.SS1.p2.2.m2.2.2"><times id="S4.SS1.p2.2.m2.2.2.2.cmml" xref="S4.SS1.p2.2.m2.2.2.2"></times><ci id="S4.SS1.p2.2.m2.2.2.3.cmml" xref="S4.SS1.p2.2.m2.2.2.3">𝑔</ci><interval closure="open" id="S4.SS1.p2.2.m2.2.2.1.2.cmml" xref="S4.SS1.p2.2.m2.2.2.1.1"><ci id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1">𝒔</ci><apply id="S4.SS1.p2.2.m2.2.2.1.1.1.cmml" xref="S4.SS1.p2.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.2.m2.2.2.1.1.1.1.cmml" xref="S4.SS1.p2.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S4.SS1.p2.2.m2.2.2.1.1.1.2.cmml" xref="S4.SS1.p2.2.m2.2.2.1.1.1.2">𝛽</ci><ci id="S4.SS1.p2.2.m2.2.2.1.1.1.3.cmml" xref="S4.SS1.p2.2.m2.2.2.1.1.1.3">𝑔</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.2c">g(\bm{s},\beta_{g})</annotation></semantics></math> is optimised using the labelled data to predict the absolute number of instances of each class in an image. By normalising the output of <math id="S4.SS1.p2.3.m3.2" class="ltx_Math" alttext="g(\bm{s},\beta_{g})" display="inline"><semantics id="S4.SS1.p2.3.m3.2a"><mrow id="S4.SS1.p2.3.m3.2.2" xref="S4.SS1.p2.3.m3.2.2.cmml"><mi id="S4.SS1.p2.3.m3.2.2.3" xref="S4.SS1.p2.3.m3.2.2.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p2.3.m3.2.2.2" xref="S4.SS1.p2.3.m3.2.2.2.cmml">​</mo><mrow id="S4.SS1.p2.3.m3.2.2.1.1" xref="S4.SS1.p2.3.m3.2.2.1.2.cmml"><mo stretchy="false" id="S4.SS1.p2.3.m3.2.2.1.1.2" xref="S4.SS1.p2.3.m3.2.2.1.2.cmml">(</mo><mi id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml">𝒔</mi><mo id="S4.SS1.p2.3.m3.2.2.1.1.3" xref="S4.SS1.p2.3.m3.2.2.1.2.cmml">,</mo><msub id="S4.SS1.p2.3.m3.2.2.1.1.1" xref="S4.SS1.p2.3.m3.2.2.1.1.1.cmml"><mi id="S4.SS1.p2.3.m3.2.2.1.1.1.2" xref="S4.SS1.p2.3.m3.2.2.1.1.1.2.cmml">β</mi><mi id="S4.SS1.p2.3.m3.2.2.1.1.1.3" xref="S4.SS1.p2.3.m3.2.2.1.1.1.3.cmml">g</mi></msub><mo stretchy="false" id="S4.SS1.p2.3.m3.2.2.1.1.4" xref="S4.SS1.p2.3.m3.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.2b"><apply id="S4.SS1.p2.3.m3.2.2.cmml" xref="S4.SS1.p2.3.m3.2.2"><times id="S4.SS1.p2.3.m3.2.2.2.cmml" xref="S4.SS1.p2.3.m3.2.2.2"></times><ci id="S4.SS1.p2.3.m3.2.2.3.cmml" xref="S4.SS1.p2.3.m3.2.2.3">𝑔</ci><interval closure="open" id="S4.SS1.p2.3.m3.2.2.1.2.cmml" xref="S4.SS1.p2.3.m3.2.2.1.1"><ci id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1">𝒔</ci><apply id="S4.SS1.p2.3.m3.2.2.1.1.1.cmml" xref="S4.SS1.p2.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.3.m3.2.2.1.1.1.1.cmml" xref="S4.SS1.p2.3.m3.2.2.1.1.1">subscript</csymbol><ci id="S4.SS1.p2.3.m3.2.2.1.1.1.2.cmml" xref="S4.SS1.p2.3.m3.2.2.1.1.1.2">𝛽</ci><ci id="S4.SS1.p2.3.m3.2.2.1.1.1.3.cmml" xref="S4.SS1.p2.3.m3.2.2.1.1.1.3">𝑔</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.2c">g(\bm{s},\beta_{g})</annotation></semantics></math> to sum to 1, this model can be used to predict the class ratio. The relative model <math id="S4.SS1.p2.4.m4.2" class="ltx_Math" alttext="k(\bm{s},\beta_{k})" display="inline"><semantics id="S4.SS1.p2.4.m4.2a"><mrow id="S4.SS1.p2.4.m4.2.2" xref="S4.SS1.p2.4.m4.2.2.cmml"><mi id="S4.SS1.p2.4.m4.2.2.3" xref="S4.SS1.p2.4.m4.2.2.3.cmml">k</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p2.4.m4.2.2.2" xref="S4.SS1.p2.4.m4.2.2.2.cmml">​</mo><mrow id="S4.SS1.p2.4.m4.2.2.1.1" xref="S4.SS1.p2.4.m4.2.2.1.2.cmml"><mo stretchy="false" id="S4.SS1.p2.4.m4.2.2.1.1.2" xref="S4.SS1.p2.4.m4.2.2.1.2.cmml">(</mo><mi id="S4.SS1.p2.4.m4.1.1" xref="S4.SS1.p2.4.m4.1.1.cmml">𝒔</mi><mo id="S4.SS1.p2.4.m4.2.2.1.1.3" xref="S4.SS1.p2.4.m4.2.2.1.2.cmml">,</mo><msub id="S4.SS1.p2.4.m4.2.2.1.1.1" xref="S4.SS1.p2.4.m4.2.2.1.1.1.cmml"><mi id="S4.SS1.p2.4.m4.2.2.1.1.1.2" xref="S4.SS1.p2.4.m4.2.2.1.1.1.2.cmml">β</mi><mi id="S4.SS1.p2.4.m4.2.2.1.1.1.3" xref="S4.SS1.p2.4.m4.2.2.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S4.SS1.p2.4.m4.2.2.1.1.4" xref="S4.SS1.p2.4.m4.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m4.2b"><apply id="S4.SS1.p2.4.m4.2.2.cmml" xref="S4.SS1.p2.4.m4.2.2"><times id="S4.SS1.p2.4.m4.2.2.2.cmml" xref="S4.SS1.p2.4.m4.2.2.2"></times><ci id="S4.SS1.p2.4.m4.2.2.3.cmml" xref="S4.SS1.p2.4.m4.2.2.3">𝑘</ci><interval closure="open" id="S4.SS1.p2.4.m4.2.2.1.2.cmml" xref="S4.SS1.p2.4.m4.2.2.1.1"><ci id="S4.SS1.p2.4.m4.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1">𝒔</ci><apply id="S4.SS1.p2.4.m4.2.2.1.1.1.cmml" xref="S4.SS1.p2.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.4.m4.2.2.1.1.1.1.cmml" xref="S4.SS1.p2.4.m4.2.2.1.1.1">subscript</csymbol><ci id="S4.SS1.p2.4.m4.2.2.1.1.1.2.cmml" xref="S4.SS1.p2.4.m4.2.2.1.1.1.2">𝛽</ci><ci id="S4.SS1.p2.4.m4.2.2.1.1.1.3.cmml" xref="S4.SS1.p2.4.m4.2.2.1.1.1.3">𝑘</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.4.m4.2c">k(\bm{s},\beta_{k})</annotation></semantics></math> is optimised using the labelled data to directly predict the ratio of each class in an image. The relative model does not consider how many objects occur in an image, instead learning how likely a class is to occur relative to other classes.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para">
<p id="S4.SS1.p3.2" class="ltx_p">To make a prediction for the class distribution of the unlabelled dataset, we use CLIP to extract the similarity vector <math id="S4.SS1.p3.1.m1.1" class="ltx_Math" alttext="s_{u}" display="inline"><semantics id="S4.SS1.p3.1.m1.1a"><msub id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml"><mi id="S4.SS1.p3.1.m1.1.1.2" xref="S4.SS1.p3.1.m1.1.1.2.cmml">s</mi><mi id="S4.SS1.p3.1.m1.1.1.3" xref="S4.SS1.p3.1.m1.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><apply id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.1.m1.1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p3.1.m1.1.1.2.cmml" xref="S4.SS1.p3.1.m1.1.1.2">𝑠</ci><ci id="S4.SS1.p3.1.m1.1.1.3.cmml" xref="S4.SS1.p3.1.m1.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">s_{u}</annotation></semantics></math> for each unlabelled image. We then calculate the mean similarity vector across the unlabelled dataset <math id="S4.SS1.p3.2.m2.1" class="ltx_Math" alttext="\bm{\overline{s_{u}}}\in\mathbb{R}^{n_{c}}" display="inline"><semantics id="S4.SS1.p3.2.m2.1a"><mrow id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml"><mover accent="true" id="S4.SS1.p3.2.m2.1.1.2" xref="S4.SS1.p3.2.m2.1.1.2.cmml"><msub id="S4.SS1.p3.2.m2.1.1.2.2" xref="S4.SS1.p3.2.m2.1.1.2.2.cmml"><mi id="S4.SS1.p3.2.m2.1.1.2.2.2" xref="S4.SS1.p3.2.m2.1.1.2.2.2.cmml">𝒔</mi><mi id="S4.SS1.p3.2.m2.1.1.2.2.3" xref="S4.SS1.p3.2.m2.1.1.2.2.3.cmml">𝒖</mi></msub><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S4.SS1.p3.2.m2.1.1.2.1" xref="S4.SS1.p3.2.m2.1.1.2.1.cmml">¯</mo></mover><mo id="S4.SS1.p3.2.m2.1.1.1" xref="S4.SS1.p3.2.m2.1.1.1.cmml">∈</mo><msup id="S4.SS1.p3.2.m2.1.1.3" xref="S4.SS1.p3.2.m2.1.1.3.cmml"><mi id="S4.SS1.p3.2.m2.1.1.3.2" xref="S4.SS1.p3.2.m2.1.1.3.2.cmml">ℝ</mi><msub id="S4.SS1.p3.2.m2.1.1.3.3" xref="S4.SS1.p3.2.m2.1.1.3.3.cmml"><mi id="S4.SS1.p3.2.m2.1.1.3.3.2" xref="S4.SS1.p3.2.m2.1.1.3.3.2.cmml">n</mi><mi id="S4.SS1.p3.2.m2.1.1.3.3.3" xref="S4.SS1.p3.2.m2.1.1.3.3.3.cmml">c</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.1b"><apply id="S4.SS1.p3.2.m2.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1"><in id="S4.SS1.p3.2.m2.1.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1.1"></in><apply id="S4.SS1.p3.2.m2.1.1.2.cmml" xref="S4.SS1.p3.2.m2.1.1.2"><ci id="S4.SS1.p3.2.m2.1.1.2.1.cmml" xref="S4.SS1.p3.2.m2.1.1.2.1">bold-¯</ci><apply id="S4.SS1.p3.2.m2.1.1.2.2.cmml" xref="S4.SS1.p3.2.m2.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.p3.2.m2.1.1.2.2.1.cmml" xref="S4.SS1.p3.2.m2.1.1.2.2">subscript</csymbol><ci id="S4.SS1.p3.2.m2.1.1.2.2.2.cmml" xref="S4.SS1.p3.2.m2.1.1.2.2.2">𝒔</ci><ci id="S4.SS1.p3.2.m2.1.1.2.2.3.cmml" xref="S4.SS1.p3.2.m2.1.1.2.2.3">𝒖</ci></apply></apply><apply id="S4.SS1.p3.2.m2.1.1.3.cmml" xref="S4.SS1.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p3.2.m2.1.1.3.1.cmml" xref="S4.SS1.p3.2.m2.1.1.3">superscript</csymbol><ci id="S4.SS1.p3.2.m2.1.1.3.2.cmml" xref="S4.SS1.p3.2.m2.1.1.3.2">ℝ</ci><apply id="S4.SS1.p3.2.m2.1.1.3.3.cmml" xref="S4.SS1.p3.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS1.p3.2.m2.1.1.3.3.1.cmml" xref="S4.SS1.p3.2.m2.1.1.3.3">subscript</csymbol><ci id="S4.SS1.p3.2.m2.1.1.3.3.2.cmml" xref="S4.SS1.p3.2.m2.1.1.3.3.2">𝑛</ci><ci id="S4.SS1.p3.2.m2.1.1.3.3.3.cmml" xref="S4.SS1.p3.2.m2.1.1.3.3.3">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.1c">\bm{\overline{s_{u}}}\in\mathbb{R}^{n_{c}}</annotation></semantics></math> and input it to the linear regression models:</p>
<table id="S4.E11" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E11.m1.4" class="ltx_Math" alttext="\vspace{-0.25em}\bm{r^{u}_{a}}=\frac{g(\bm{\overline{s_{u}}},\beta_{g})}{\left|g(\bm{\overline{s_{u}}},\beta_{g})\right|}" display="block"><semantics id="S4.E11.m1.4a"><mrow id="S4.E11.m1.4.5" xref="S4.E11.m1.4.5.cmml"><msubsup id="S4.E11.m1.4.5.2" xref="S4.E11.m1.4.5.2.cmml"><mi id="S4.E11.m1.4.5.2.2.2" xref="S4.E11.m1.4.5.2.2.2.cmml">𝒓</mi><mi id="S4.E11.m1.4.5.2.3" xref="S4.E11.m1.4.5.2.3.cmml">𝒂</mi><mi id="S4.E11.m1.4.5.2.2.3" xref="S4.E11.m1.4.5.2.2.3.cmml">𝒖</mi></msubsup><mo id="S4.E11.m1.4.5.1" xref="S4.E11.m1.4.5.1.cmml">=</mo><mfrac id="S4.E11.m1.4.4" xref="S4.E11.m1.4.4.cmml"><mrow id="S4.E11.m1.2.2.2" xref="S4.E11.m1.2.2.2.cmml"><mi id="S4.E11.m1.2.2.2.4" xref="S4.E11.m1.2.2.2.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.E11.m1.2.2.2.3" xref="S4.E11.m1.2.2.2.3.cmml">​</mo><mrow id="S4.E11.m1.2.2.2.2.1" xref="S4.E11.m1.2.2.2.2.2.cmml"><mo stretchy="false" id="S4.E11.m1.2.2.2.2.1.2" xref="S4.E11.m1.2.2.2.2.2.cmml">(</mo><mover accent="true" id="S4.E11.m1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.cmml"><msub id="S4.E11.m1.1.1.1.1.2" xref="S4.E11.m1.1.1.1.1.2.cmml"><mi id="S4.E11.m1.1.1.1.1.2.2" xref="S4.E11.m1.1.1.1.1.2.2.cmml">𝒔</mi><mi id="S4.E11.m1.1.1.1.1.2.3" xref="S4.E11.m1.1.1.1.1.2.3.cmml">𝒖</mi></msub><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S4.E11.m1.1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.1.cmml">¯</mo></mover><mo id="S4.E11.m1.2.2.2.2.1.3" xref="S4.E11.m1.2.2.2.2.2.cmml">,</mo><msub id="S4.E11.m1.2.2.2.2.1.1" xref="S4.E11.m1.2.2.2.2.1.1.cmml"><mi id="S4.E11.m1.2.2.2.2.1.1.2" xref="S4.E11.m1.2.2.2.2.1.1.2.cmml">β</mi><mi id="S4.E11.m1.2.2.2.2.1.1.3" xref="S4.E11.m1.2.2.2.2.1.1.3.cmml">g</mi></msub><mo stretchy="false" id="S4.E11.m1.2.2.2.2.1.4" xref="S4.E11.m1.2.2.2.2.2.cmml">)</mo></mrow></mrow><mrow id="S4.E11.m1.4.4.4.2" xref="S4.E11.m1.4.4.4.3.cmml"><mo id="S4.E11.m1.4.4.4.2.2" xref="S4.E11.m1.4.4.4.3.1.cmml">|</mo><mrow id="S4.E11.m1.4.4.4.2.1" xref="S4.E11.m1.4.4.4.2.1.cmml"><mi id="S4.E11.m1.4.4.4.2.1.3" xref="S4.E11.m1.4.4.4.2.1.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.E11.m1.4.4.4.2.1.2" xref="S4.E11.m1.4.4.4.2.1.2.cmml">​</mo><mrow id="S4.E11.m1.4.4.4.2.1.1.1" xref="S4.E11.m1.4.4.4.2.1.1.2.cmml"><mo stretchy="false" id="S4.E11.m1.4.4.4.2.1.1.1.2" xref="S4.E11.m1.4.4.4.2.1.1.2.cmml">(</mo><mover accent="true" id="S4.E11.m1.3.3.3.1" xref="S4.E11.m1.3.3.3.1.cmml"><msub id="S4.E11.m1.3.3.3.1.2" xref="S4.E11.m1.3.3.3.1.2.cmml"><mi id="S4.E11.m1.3.3.3.1.2.2" xref="S4.E11.m1.3.3.3.1.2.2.cmml">𝒔</mi><mi id="S4.E11.m1.3.3.3.1.2.3" xref="S4.E11.m1.3.3.3.1.2.3.cmml">𝒖</mi></msub><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S4.E11.m1.3.3.3.1.1" xref="S4.E11.m1.3.3.3.1.1.cmml">¯</mo></mover><mo id="S4.E11.m1.4.4.4.2.1.1.1.3" xref="S4.E11.m1.4.4.4.2.1.1.2.cmml">,</mo><msub id="S4.E11.m1.4.4.4.2.1.1.1.1" xref="S4.E11.m1.4.4.4.2.1.1.1.1.cmml"><mi id="S4.E11.m1.4.4.4.2.1.1.1.1.2" xref="S4.E11.m1.4.4.4.2.1.1.1.1.2.cmml">β</mi><mi id="S4.E11.m1.4.4.4.2.1.1.1.1.3" xref="S4.E11.m1.4.4.4.2.1.1.1.1.3.cmml">g</mi></msub><mo stretchy="false" id="S4.E11.m1.4.4.4.2.1.1.1.4" xref="S4.E11.m1.4.4.4.2.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E11.m1.4.4.4.2.3" xref="S4.E11.m1.4.4.4.3.1.cmml">|</mo></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S4.E11.m1.4b"><apply id="S4.E11.m1.4.5.cmml" xref="S4.E11.m1.4.5"><eq id="S4.E11.m1.4.5.1.cmml" xref="S4.E11.m1.4.5.1"></eq><apply id="S4.E11.m1.4.5.2.cmml" xref="S4.E11.m1.4.5.2"><csymbol cd="ambiguous" id="S4.E11.m1.4.5.2.1.cmml" xref="S4.E11.m1.4.5.2">subscript</csymbol><apply id="S4.E11.m1.4.5.2.2.cmml" xref="S4.E11.m1.4.5.2"><csymbol cd="ambiguous" id="S4.E11.m1.4.5.2.2.1.cmml" xref="S4.E11.m1.4.5.2">superscript</csymbol><ci id="S4.E11.m1.4.5.2.2.2.cmml" xref="S4.E11.m1.4.5.2.2.2">𝒓</ci><ci id="S4.E11.m1.4.5.2.2.3.cmml" xref="S4.E11.m1.4.5.2.2.3">𝒖</ci></apply><ci id="S4.E11.m1.4.5.2.3.cmml" xref="S4.E11.m1.4.5.2.3">𝒂</ci></apply><apply id="S4.E11.m1.4.4.cmml" xref="S4.E11.m1.4.4"><divide id="S4.E11.m1.4.4.5.cmml" xref="S4.E11.m1.4.4"></divide><apply id="S4.E11.m1.2.2.2.cmml" xref="S4.E11.m1.2.2.2"><times id="S4.E11.m1.2.2.2.3.cmml" xref="S4.E11.m1.2.2.2.3"></times><ci id="S4.E11.m1.2.2.2.4.cmml" xref="S4.E11.m1.2.2.2.4">𝑔</ci><interval closure="open" id="S4.E11.m1.2.2.2.2.2.cmml" xref="S4.E11.m1.2.2.2.2.1"><apply id="S4.E11.m1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1"><ci id="S4.E11.m1.1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1.1">bold-¯</ci><apply id="S4.E11.m1.1.1.1.1.2.cmml" xref="S4.E11.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.1.2.1.cmml" xref="S4.E11.m1.1.1.1.1.2">subscript</csymbol><ci id="S4.E11.m1.1.1.1.1.2.2.cmml" xref="S4.E11.m1.1.1.1.1.2.2">𝒔</ci><ci id="S4.E11.m1.1.1.1.1.2.3.cmml" xref="S4.E11.m1.1.1.1.1.2.3">𝒖</ci></apply></apply><apply id="S4.E11.m1.2.2.2.2.1.1.cmml" xref="S4.E11.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.2.2.1.1.1.cmml" xref="S4.E11.m1.2.2.2.2.1.1">subscript</csymbol><ci id="S4.E11.m1.2.2.2.2.1.1.2.cmml" xref="S4.E11.m1.2.2.2.2.1.1.2">𝛽</ci><ci id="S4.E11.m1.2.2.2.2.1.1.3.cmml" xref="S4.E11.m1.2.2.2.2.1.1.3">𝑔</ci></apply></interval></apply><apply id="S4.E11.m1.4.4.4.3.cmml" xref="S4.E11.m1.4.4.4.2"><abs id="S4.E11.m1.4.4.4.3.1.cmml" xref="S4.E11.m1.4.4.4.2.2"></abs><apply id="S4.E11.m1.4.4.4.2.1.cmml" xref="S4.E11.m1.4.4.4.2.1"><times id="S4.E11.m1.4.4.4.2.1.2.cmml" xref="S4.E11.m1.4.4.4.2.1.2"></times><ci id="S4.E11.m1.4.4.4.2.1.3.cmml" xref="S4.E11.m1.4.4.4.2.1.3">𝑔</ci><interval closure="open" id="S4.E11.m1.4.4.4.2.1.1.2.cmml" xref="S4.E11.m1.4.4.4.2.1.1.1"><apply id="S4.E11.m1.3.3.3.1.cmml" xref="S4.E11.m1.3.3.3.1"><ci id="S4.E11.m1.3.3.3.1.1.cmml" xref="S4.E11.m1.3.3.3.1.1">bold-¯</ci><apply id="S4.E11.m1.3.3.3.1.2.cmml" xref="S4.E11.m1.3.3.3.1.2"><csymbol cd="ambiguous" id="S4.E11.m1.3.3.3.1.2.1.cmml" xref="S4.E11.m1.3.3.3.1.2">subscript</csymbol><ci id="S4.E11.m1.3.3.3.1.2.2.cmml" xref="S4.E11.m1.3.3.3.1.2.2">𝒔</ci><ci id="S4.E11.m1.3.3.3.1.2.3.cmml" xref="S4.E11.m1.3.3.3.1.2.3">𝒖</ci></apply></apply><apply id="S4.E11.m1.4.4.4.2.1.1.1.1.cmml" xref="S4.E11.m1.4.4.4.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.E11.m1.4.4.4.2.1.1.1.1.1.cmml" xref="S4.E11.m1.4.4.4.2.1.1.1.1">subscript</csymbol><ci id="S4.E11.m1.4.4.4.2.1.1.1.1.2.cmml" xref="S4.E11.m1.4.4.4.2.1.1.1.1.2">𝛽</ci><ci id="S4.E11.m1.4.4.4.2.1.1.1.1.3.cmml" xref="S4.E11.m1.4.4.4.2.1.1.1.1.3">𝑔</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E11.m1.4c">\vspace{-0.25em}\bm{r^{u}_{a}}=\frac{g(\bm{\overline{s_{u}}},\beta_{g})}{\left|g(\bm{\overline{s_{u}}},\beta_{g})\right|}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<table id="S4.E12" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E12.m1.2" class="ltx_Math" alttext="\bm{r^{u}_{r}}=k(\bm{\overline{s_{u}}},\beta_{k})" display="block"><semantics id="S4.E12.m1.2a"><mrow id="S4.E12.m1.2.2" xref="S4.E12.m1.2.2.cmml"><msubsup id="S4.E12.m1.2.2.3" xref="S4.E12.m1.2.2.3.cmml"><mi id="S4.E12.m1.2.2.3.2.2" xref="S4.E12.m1.2.2.3.2.2.cmml">𝒓</mi><mi id="S4.E12.m1.2.2.3.3" xref="S4.E12.m1.2.2.3.3.cmml">𝒓</mi><mi id="S4.E12.m1.2.2.3.2.3" xref="S4.E12.m1.2.2.3.2.3.cmml">𝒖</mi></msubsup><mo id="S4.E12.m1.2.2.2" xref="S4.E12.m1.2.2.2.cmml">=</mo><mrow id="S4.E12.m1.2.2.1" xref="S4.E12.m1.2.2.1.cmml"><mi id="S4.E12.m1.2.2.1.3" xref="S4.E12.m1.2.2.1.3.cmml">k</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.2.2.1.2" xref="S4.E12.m1.2.2.1.2.cmml">​</mo><mrow id="S4.E12.m1.2.2.1.1.1" xref="S4.E12.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="S4.E12.m1.2.2.1.1.1.2" xref="S4.E12.m1.2.2.1.1.2.cmml">(</mo><mover accent="true" id="S4.E12.m1.1.1" xref="S4.E12.m1.1.1.cmml"><msub id="S4.E12.m1.1.1.2" xref="S4.E12.m1.1.1.2.cmml"><mi id="S4.E12.m1.1.1.2.2" xref="S4.E12.m1.1.1.2.2.cmml">𝒔</mi><mi id="S4.E12.m1.1.1.2.3" xref="S4.E12.m1.1.1.2.3.cmml">𝒖</mi></msub><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S4.E12.m1.1.1.1" xref="S4.E12.m1.1.1.1.cmml">¯</mo></mover><mo id="S4.E12.m1.2.2.1.1.1.3" xref="S4.E12.m1.2.2.1.1.2.cmml">,</mo><msub id="S4.E12.m1.2.2.1.1.1.1" xref="S4.E12.m1.2.2.1.1.1.1.cmml"><mi id="S4.E12.m1.2.2.1.1.1.1.2" xref="S4.E12.m1.2.2.1.1.1.1.2.cmml">β</mi><mi id="S4.E12.m1.2.2.1.1.1.1.3" xref="S4.E12.m1.2.2.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S4.E12.m1.2.2.1.1.1.4" xref="S4.E12.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E12.m1.2b"><apply id="S4.E12.m1.2.2.cmml" xref="S4.E12.m1.2.2"><eq id="S4.E12.m1.2.2.2.cmml" xref="S4.E12.m1.2.2.2"></eq><apply id="S4.E12.m1.2.2.3.cmml" xref="S4.E12.m1.2.2.3"><csymbol cd="ambiguous" id="S4.E12.m1.2.2.3.1.cmml" xref="S4.E12.m1.2.2.3">subscript</csymbol><apply id="S4.E12.m1.2.2.3.2.cmml" xref="S4.E12.m1.2.2.3"><csymbol cd="ambiguous" id="S4.E12.m1.2.2.3.2.1.cmml" xref="S4.E12.m1.2.2.3">superscript</csymbol><ci id="S4.E12.m1.2.2.3.2.2.cmml" xref="S4.E12.m1.2.2.3.2.2">𝒓</ci><ci id="S4.E12.m1.2.2.3.2.3.cmml" xref="S4.E12.m1.2.2.3.2.3">𝒖</ci></apply><ci id="S4.E12.m1.2.2.3.3.cmml" xref="S4.E12.m1.2.2.3.3">𝒓</ci></apply><apply id="S4.E12.m1.2.2.1.cmml" xref="S4.E12.m1.2.2.1"><times id="S4.E12.m1.2.2.1.2.cmml" xref="S4.E12.m1.2.2.1.2"></times><ci id="S4.E12.m1.2.2.1.3.cmml" xref="S4.E12.m1.2.2.1.3">𝑘</ci><interval closure="open" id="S4.E12.m1.2.2.1.1.2.cmml" xref="S4.E12.m1.2.2.1.1.1"><apply id="S4.E12.m1.1.1.cmml" xref="S4.E12.m1.1.1"><ci id="S4.E12.m1.1.1.1.cmml" xref="S4.E12.m1.1.1.1">bold-¯</ci><apply id="S4.E12.m1.1.1.2.cmml" xref="S4.E12.m1.1.1.2"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.2.1.cmml" xref="S4.E12.m1.1.1.2">subscript</csymbol><ci id="S4.E12.m1.1.1.2.2.cmml" xref="S4.E12.m1.1.1.2.2">𝒔</ci><ci id="S4.E12.m1.1.1.2.3.cmml" xref="S4.E12.m1.1.1.2.3">𝒖</ci></apply></apply><apply id="S4.E12.m1.2.2.1.1.1.1.cmml" xref="S4.E12.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.E12.m1.2.2.1.1.1.1.1.cmml" xref="S4.E12.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S4.E12.m1.2.2.1.1.1.1.2.cmml" xref="S4.E12.m1.2.2.1.1.1.1.2">𝛽</ci><ci id="S4.E12.m1.2.2.1.1.1.1.3.cmml" xref="S4.E12.m1.2.2.1.1.1.1.3">𝑘</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E12.m1.2c">\bm{r^{u}_{r}}=k(\bm{\overline{s_{u}}},\beta_{k})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS1.p4" class="ltx_para">
<p id="S4.SS1.p4.3" class="ltx_p">The relative and absolute models produce distinct predictions <math id="S4.SS1.p4.1.m1.1" class="ltx_Math" alttext="\bm{r^{u}_{a}}\in\mathbb{R}^{n_{c}}" display="inline"><semantics id="S4.SS1.p4.1.m1.1a"><mrow id="S4.SS1.p4.1.m1.1.1" xref="S4.SS1.p4.1.m1.1.1.cmml"><msubsup id="S4.SS1.p4.1.m1.1.1.2" xref="S4.SS1.p4.1.m1.1.1.2.cmml"><mi id="S4.SS1.p4.1.m1.1.1.2.2.2" xref="S4.SS1.p4.1.m1.1.1.2.2.2.cmml">𝒓</mi><mi id="S4.SS1.p4.1.m1.1.1.2.3" xref="S4.SS1.p4.1.m1.1.1.2.3.cmml">𝒂</mi><mi id="S4.SS1.p4.1.m1.1.1.2.2.3" xref="S4.SS1.p4.1.m1.1.1.2.2.3.cmml">𝒖</mi></msubsup><mo id="S4.SS1.p4.1.m1.1.1.1" xref="S4.SS1.p4.1.m1.1.1.1.cmml">∈</mo><msup id="S4.SS1.p4.1.m1.1.1.3" xref="S4.SS1.p4.1.m1.1.1.3.cmml"><mi id="S4.SS1.p4.1.m1.1.1.3.2" xref="S4.SS1.p4.1.m1.1.1.3.2.cmml">ℝ</mi><msub id="S4.SS1.p4.1.m1.1.1.3.3" xref="S4.SS1.p4.1.m1.1.1.3.3.cmml"><mi id="S4.SS1.p4.1.m1.1.1.3.3.2" xref="S4.SS1.p4.1.m1.1.1.3.3.2.cmml">n</mi><mi id="S4.SS1.p4.1.m1.1.1.3.3.3" xref="S4.SS1.p4.1.m1.1.1.3.3.3.cmml">c</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.1.m1.1b"><apply id="S4.SS1.p4.1.m1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1"><in id="S4.SS1.p4.1.m1.1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1.1"></in><apply id="S4.SS1.p4.1.m1.1.1.2.cmml" xref="S4.SS1.p4.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p4.1.m1.1.1.2.1.cmml" xref="S4.SS1.p4.1.m1.1.1.2">subscript</csymbol><apply id="S4.SS1.p4.1.m1.1.1.2.2.cmml" xref="S4.SS1.p4.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p4.1.m1.1.1.2.2.1.cmml" xref="S4.SS1.p4.1.m1.1.1.2">superscript</csymbol><ci id="S4.SS1.p4.1.m1.1.1.2.2.2.cmml" xref="S4.SS1.p4.1.m1.1.1.2.2.2">𝒓</ci><ci id="S4.SS1.p4.1.m1.1.1.2.2.3.cmml" xref="S4.SS1.p4.1.m1.1.1.2.2.3">𝒖</ci></apply><ci id="S4.SS1.p4.1.m1.1.1.2.3.cmml" xref="S4.SS1.p4.1.m1.1.1.2.3">𝒂</ci></apply><apply id="S4.SS1.p4.1.m1.1.1.3.cmml" xref="S4.SS1.p4.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p4.1.m1.1.1.3.1.cmml" xref="S4.SS1.p4.1.m1.1.1.3">superscript</csymbol><ci id="S4.SS1.p4.1.m1.1.1.3.2.cmml" xref="S4.SS1.p4.1.m1.1.1.3.2">ℝ</ci><apply id="S4.SS1.p4.1.m1.1.1.3.3.cmml" xref="S4.SS1.p4.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS1.p4.1.m1.1.1.3.3.1.cmml" xref="S4.SS1.p4.1.m1.1.1.3.3">subscript</csymbol><ci id="S4.SS1.p4.1.m1.1.1.3.3.2.cmml" xref="S4.SS1.p4.1.m1.1.1.3.3.2">𝑛</ci><ci id="S4.SS1.p4.1.m1.1.1.3.3.3.cmml" xref="S4.SS1.p4.1.m1.1.1.3.3.3">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.1.m1.1c">\bm{r^{u}_{a}}\in\mathbb{R}^{n_{c}}</annotation></semantics></math> and <math id="S4.SS1.p4.2.m2.1" class="ltx_Math" alttext="\bm{r^{u}_{r}}\in\mathbb{R}^{n_{c}}" display="inline"><semantics id="S4.SS1.p4.2.m2.1a"><mrow id="S4.SS1.p4.2.m2.1.1" xref="S4.SS1.p4.2.m2.1.1.cmml"><msubsup id="S4.SS1.p4.2.m2.1.1.2" xref="S4.SS1.p4.2.m2.1.1.2.cmml"><mi id="S4.SS1.p4.2.m2.1.1.2.2.2" xref="S4.SS1.p4.2.m2.1.1.2.2.2.cmml">𝒓</mi><mi id="S4.SS1.p4.2.m2.1.1.2.3" xref="S4.SS1.p4.2.m2.1.1.2.3.cmml">𝒓</mi><mi id="S4.SS1.p4.2.m2.1.1.2.2.3" xref="S4.SS1.p4.2.m2.1.1.2.2.3.cmml">𝒖</mi></msubsup><mo id="S4.SS1.p4.2.m2.1.1.1" xref="S4.SS1.p4.2.m2.1.1.1.cmml">∈</mo><msup id="S4.SS1.p4.2.m2.1.1.3" xref="S4.SS1.p4.2.m2.1.1.3.cmml"><mi id="S4.SS1.p4.2.m2.1.1.3.2" xref="S4.SS1.p4.2.m2.1.1.3.2.cmml">ℝ</mi><msub id="S4.SS1.p4.2.m2.1.1.3.3" xref="S4.SS1.p4.2.m2.1.1.3.3.cmml"><mi id="S4.SS1.p4.2.m2.1.1.3.3.2" xref="S4.SS1.p4.2.m2.1.1.3.3.2.cmml">n</mi><mi id="S4.SS1.p4.2.m2.1.1.3.3.3" xref="S4.SS1.p4.2.m2.1.1.3.3.3.cmml">c</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.2.m2.1b"><apply id="S4.SS1.p4.2.m2.1.1.cmml" xref="S4.SS1.p4.2.m2.1.1"><in id="S4.SS1.p4.2.m2.1.1.1.cmml" xref="S4.SS1.p4.2.m2.1.1.1"></in><apply id="S4.SS1.p4.2.m2.1.1.2.cmml" xref="S4.SS1.p4.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p4.2.m2.1.1.2.1.cmml" xref="S4.SS1.p4.2.m2.1.1.2">subscript</csymbol><apply id="S4.SS1.p4.2.m2.1.1.2.2.cmml" xref="S4.SS1.p4.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p4.2.m2.1.1.2.2.1.cmml" xref="S4.SS1.p4.2.m2.1.1.2">superscript</csymbol><ci id="S4.SS1.p4.2.m2.1.1.2.2.2.cmml" xref="S4.SS1.p4.2.m2.1.1.2.2.2">𝒓</ci><ci id="S4.SS1.p4.2.m2.1.1.2.2.3.cmml" xref="S4.SS1.p4.2.m2.1.1.2.2.3">𝒖</ci></apply><ci id="S4.SS1.p4.2.m2.1.1.2.3.cmml" xref="S4.SS1.p4.2.m2.1.1.2.3">𝒓</ci></apply><apply id="S4.SS1.p4.2.m2.1.1.3.cmml" xref="S4.SS1.p4.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p4.2.m2.1.1.3.1.cmml" xref="S4.SS1.p4.2.m2.1.1.3">superscript</csymbol><ci id="S4.SS1.p4.2.m2.1.1.3.2.cmml" xref="S4.SS1.p4.2.m2.1.1.3.2">ℝ</ci><apply id="S4.SS1.p4.2.m2.1.1.3.3.cmml" xref="S4.SS1.p4.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS1.p4.2.m2.1.1.3.3.1.cmml" xref="S4.SS1.p4.2.m2.1.1.3.3">subscript</csymbol><ci id="S4.SS1.p4.2.m2.1.1.3.3.2.cmml" xref="S4.SS1.p4.2.m2.1.1.3.3.2">𝑛</ci><ci id="S4.SS1.p4.2.m2.1.1.3.3.3.cmml" xref="S4.SS1.p4.2.m2.1.1.3.3.3">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.2.m2.1c">\bm{r^{u}_{r}}\in\mathbb{R}^{n_{c}}</annotation></semantics></math> for the class ratio, either of which can be used in our framework. However, neither prediction is consistently more accurate than the other, and the optimal prediction to use for a specific scenario cannot be determined without labelled data. To ensure consistent performance across all scenarios, we therefore average the output of the two models. To do so, we propose using the geometric mean, as it is more appropriate than the arithmetic mean for summarising the central tendency of ratios. We term the element-wise geometric mean of the class ratio predictions <math id="S4.SS1.p4.3.m3.1" class="ltx_Math" alttext="\bm{r^{u}_{merge}}\in\mathbb{R}^{n_{c}}" display="inline"><semantics id="S4.SS1.p4.3.m3.1a"><mrow id="S4.SS1.p4.3.m3.1.1" xref="S4.SS1.p4.3.m3.1.1.cmml"><msubsup id="S4.SS1.p4.3.m3.1.1.2" xref="S4.SS1.p4.3.m3.1.1.2.cmml"><mi id="S4.SS1.p4.3.m3.1.1.2.2.2" xref="S4.SS1.p4.3.m3.1.1.2.2.2.cmml">𝒓</mi><mrow id="S4.SS1.p4.3.m3.1.1.2.3" xref="S4.SS1.p4.3.m3.1.1.2.3.cmml"><mi id="S4.SS1.p4.3.m3.1.1.2.3.2" xref="S4.SS1.p4.3.m3.1.1.2.3.2.cmml">𝒎</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p4.3.m3.1.1.2.3.1" xref="S4.SS1.p4.3.m3.1.1.2.3.1.cmml">​</mo><mi id="S4.SS1.p4.3.m3.1.1.2.3.3" xref="S4.SS1.p4.3.m3.1.1.2.3.3.cmml">𝒆</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p4.3.m3.1.1.2.3.1a" xref="S4.SS1.p4.3.m3.1.1.2.3.1.cmml">​</mo><mi id="S4.SS1.p4.3.m3.1.1.2.3.4" xref="S4.SS1.p4.3.m3.1.1.2.3.4.cmml">𝒓</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p4.3.m3.1.1.2.3.1b" xref="S4.SS1.p4.3.m3.1.1.2.3.1.cmml">​</mo><mi id="S4.SS1.p4.3.m3.1.1.2.3.5" xref="S4.SS1.p4.3.m3.1.1.2.3.5.cmml">𝒈</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p4.3.m3.1.1.2.3.1c" xref="S4.SS1.p4.3.m3.1.1.2.3.1.cmml">​</mo><mi id="S4.SS1.p4.3.m3.1.1.2.3.6" xref="S4.SS1.p4.3.m3.1.1.2.3.6.cmml">𝒆</mi></mrow><mi id="S4.SS1.p4.3.m3.1.1.2.2.3" xref="S4.SS1.p4.3.m3.1.1.2.2.3.cmml">𝒖</mi></msubsup><mo id="S4.SS1.p4.3.m3.1.1.1" xref="S4.SS1.p4.3.m3.1.1.1.cmml">∈</mo><msup id="S4.SS1.p4.3.m3.1.1.3" xref="S4.SS1.p4.3.m3.1.1.3.cmml"><mi id="S4.SS1.p4.3.m3.1.1.3.2" xref="S4.SS1.p4.3.m3.1.1.3.2.cmml">ℝ</mi><msub id="S4.SS1.p4.3.m3.1.1.3.3" xref="S4.SS1.p4.3.m3.1.1.3.3.cmml"><mi id="S4.SS1.p4.3.m3.1.1.3.3.2" xref="S4.SS1.p4.3.m3.1.1.3.3.2.cmml">n</mi><mi id="S4.SS1.p4.3.m3.1.1.3.3.3" xref="S4.SS1.p4.3.m3.1.1.3.3.3.cmml">c</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.3.m3.1b"><apply id="S4.SS1.p4.3.m3.1.1.cmml" xref="S4.SS1.p4.3.m3.1.1"><in id="S4.SS1.p4.3.m3.1.1.1.cmml" xref="S4.SS1.p4.3.m3.1.1.1"></in><apply id="S4.SS1.p4.3.m3.1.1.2.cmml" xref="S4.SS1.p4.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p4.3.m3.1.1.2.1.cmml" xref="S4.SS1.p4.3.m3.1.1.2">subscript</csymbol><apply id="S4.SS1.p4.3.m3.1.1.2.2.cmml" xref="S4.SS1.p4.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p4.3.m3.1.1.2.2.1.cmml" xref="S4.SS1.p4.3.m3.1.1.2">superscript</csymbol><ci id="S4.SS1.p4.3.m3.1.1.2.2.2.cmml" xref="S4.SS1.p4.3.m3.1.1.2.2.2">𝒓</ci><ci id="S4.SS1.p4.3.m3.1.1.2.2.3.cmml" xref="S4.SS1.p4.3.m3.1.1.2.2.3">𝒖</ci></apply><apply id="S4.SS1.p4.3.m3.1.1.2.3.cmml" xref="S4.SS1.p4.3.m3.1.1.2.3"><times id="S4.SS1.p4.3.m3.1.1.2.3.1.cmml" xref="S4.SS1.p4.3.m3.1.1.2.3.1"></times><ci id="S4.SS1.p4.3.m3.1.1.2.3.2.cmml" xref="S4.SS1.p4.3.m3.1.1.2.3.2">𝒎</ci><ci id="S4.SS1.p4.3.m3.1.1.2.3.3.cmml" xref="S4.SS1.p4.3.m3.1.1.2.3.3">𝒆</ci><ci id="S4.SS1.p4.3.m3.1.1.2.3.4.cmml" xref="S4.SS1.p4.3.m3.1.1.2.3.4">𝒓</ci><ci id="S4.SS1.p4.3.m3.1.1.2.3.5.cmml" xref="S4.SS1.p4.3.m3.1.1.2.3.5">𝒈</ci><ci id="S4.SS1.p4.3.m3.1.1.2.3.6.cmml" xref="S4.SS1.p4.3.m3.1.1.2.3.6">𝒆</ci></apply></apply><apply id="S4.SS1.p4.3.m3.1.1.3.cmml" xref="S4.SS1.p4.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p4.3.m3.1.1.3.1.cmml" xref="S4.SS1.p4.3.m3.1.1.3">superscript</csymbol><ci id="S4.SS1.p4.3.m3.1.1.3.2.cmml" xref="S4.SS1.p4.3.m3.1.1.3.2">ℝ</ci><apply id="S4.SS1.p4.3.m3.1.1.3.3.cmml" xref="S4.SS1.p4.3.m3.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS1.p4.3.m3.1.1.3.3.1.cmml" xref="S4.SS1.p4.3.m3.1.1.3.3">subscript</csymbol><ci id="S4.SS1.p4.3.m3.1.1.3.3.2.cmml" xref="S4.SS1.p4.3.m3.1.1.3.3.2">𝑛</ci><ci id="S4.SS1.p4.3.m3.1.1.3.3.3.cmml" xref="S4.SS1.p4.3.m3.1.1.3.3.3">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.3.m3.1c">\bm{r^{u}_{merge}}\in\mathbb{R}^{n_{c}}</annotation></semantics></math> as the merged prediction:</p>
<table id="S4.E13" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E13.m1.1" class="ltx_Math" alttext="\bm{r^{u}_{merge}}=\sqrt{\bm{r^{u}_{a}}\cdot\bm{r^{u}_{r}}}" display="block"><semantics id="S4.E13.m1.1a"><mrow id="S4.E13.m1.1.1" xref="S4.E13.m1.1.1.cmml"><msubsup id="S4.E13.m1.1.1.2" xref="S4.E13.m1.1.1.2.cmml"><mi id="S4.E13.m1.1.1.2.2.2" xref="S4.E13.m1.1.1.2.2.2.cmml">𝒓</mi><mrow id="S4.E13.m1.1.1.2.3" xref="S4.E13.m1.1.1.2.3.cmml"><mi id="S4.E13.m1.1.1.2.3.2" xref="S4.E13.m1.1.1.2.3.2.cmml">𝒎</mi><mo lspace="0em" rspace="0em" id="S4.E13.m1.1.1.2.3.1" xref="S4.E13.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.E13.m1.1.1.2.3.3" xref="S4.E13.m1.1.1.2.3.3.cmml">𝒆</mi><mo lspace="0em" rspace="0em" id="S4.E13.m1.1.1.2.3.1a" xref="S4.E13.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.E13.m1.1.1.2.3.4" xref="S4.E13.m1.1.1.2.3.4.cmml">𝒓</mi><mo lspace="0em" rspace="0em" id="S4.E13.m1.1.1.2.3.1b" xref="S4.E13.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.E13.m1.1.1.2.3.5" xref="S4.E13.m1.1.1.2.3.5.cmml">𝒈</mi><mo lspace="0em" rspace="0em" id="S4.E13.m1.1.1.2.3.1c" xref="S4.E13.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.E13.m1.1.1.2.3.6" xref="S4.E13.m1.1.1.2.3.6.cmml">𝒆</mi></mrow><mi id="S4.E13.m1.1.1.2.2.3" xref="S4.E13.m1.1.1.2.2.3.cmml">𝒖</mi></msubsup><mo id="S4.E13.m1.1.1.1" xref="S4.E13.m1.1.1.1.cmml">=</mo><msqrt id="S4.E13.m1.1.1.3" xref="S4.E13.m1.1.1.3.cmml"><mrow id="S4.E13.m1.1.1.3.2" xref="S4.E13.m1.1.1.3.2.cmml"><msubsup id="S4.E13.m1.1.1.3.2.2" xref="S4.E13.m1.1.1.3.2.2.cmml"><mi id="S4.E13.m1.1.1.3.2.2.2.2" xref="S4.E13.m1.1.1.3.2.2.2.2.cmml">𝒓</mi><mi id="S4.E13.m1.1.1.3.2.2.3" xref="S4.E13.m1.1.1.3.2.2.3.cmml">𝒂</mi><mi id="S4.E13.m1.1.1.3.2.2.2.3" xref="S4.E13.m1.1.1.3.2.2.2.3.cmml">𝒖</mi></msubsup><mo lspace="0.222em" rspace="0.222em" id="S4.E13.m1.1.1.3.2.1" xref="S4.E13.m1.1.1.3.2.1.cmml">⋅</mo><msubsup id="S4.E13.m1.1.1.3.2.3" xref="S4.E13.m1.1.1.3.2.3.cmml"><mi id="S4.E13.m1.1.1.3.2.3.2.2" xref="S4.E13.m1.1.1.3.2.3.2.2.cmml">𝒓</mi><mi id="S4.E13.m1.1.1.3.2.3.3" xref="S4.E13.m1.1.1.3.2.3.3.cmml">𝒓</mi><mi id="S4.E13.m1.1.1.3.2.3.2.3" xref="S4.E13.m1.1.1.3.2.3.2.3.cmml">𝒖</mi></msubsup></mrow></msqrt></mrow><annotation-xml encoding="MathML-Content" id="S4.E13.m1.1b"><apply id="S4.E13.m1.1.1.cmml" xref="S4.E13.m1.1.1"><eq id="S4.E13.m1.1.1.1.cmml" xref="S4.E13.m1.1.1.1"></eq><apply id="S4.E13.m1.1.1.2.cmml" xref="S4.E13.m1.1.1.2"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.2.1.cmml" xref="S4.E13.m1.1.1.2">subscript</csymbol><apply id="S4.E13.m1.1.1.2.2.cmml" xref="S4.E13.m1.1.1.2"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.2.2.1.cmml" xref="S4.E13.m1.1.1.2">superscript</csymbol><ci id="S4.E13.m1.1.1.2.2.2.cmml" xref="S4.E13.m1.1.1.2.2.2">𝒓</ci><ci id="S4.E13.m1.1.1.2.2.3.cmml" xref="S4.E13.m1.1.1.2.2.3">𝒖</ci></apply><apply id="S4.E13.m1.1.1.2.3.cmml" xref="S4.E13.m1.1.1.2.3"><times id="S4.E13.m1.1.1.2.3.1.cmml" xref="S4.E13.m1.1.1.2.3.1"></times><ci id="S4.E13.m1.1.1.2.3.2.cmml" xref="S4.E13.m1.1.1.2.3.2">𝒎</ci><ci id="S4.E13.m1.1.1.2.3.3.cmml" xref="S4.E13.m1.1.1.2.3.3">𝒆</ci><ci id="S4.E13.m1.1.1.2.3.4.cmml" xref="S4.E13.m1.1.1.2.3.4">𝒓</ci><ci id="S4.E13.m1.1.1.2.3.5.cmml" xref="S4.E13.m1.1.1.2.3.5">𝒈</ci><ci id="S4.E13.m1.1.1.2.3.6.cmml" xref="S4.E13.m1.1.1.2.3.6">𝒆</ci></apply></apply><apply id="S4.E13.m1.1.1.3.cmml" xref="S4.E13.m1.1.1.3"><root id="S4.E13.m1.1.1.3a.cmml" xref="S4.E13.m1.1.1.3"></root><apply id="S4.E13.m1.1.1.3.2.cmml" xref="S4.E13.m1.1.1.3.2"><ci id="S4.E13.m1.1.1.3.2.1.cmml" xref="S4.E13.m1.1.1.3.2.1">⋅</ci><apply id="S4.E13.m1.1.1.3.2.2.cmml" xref="S4.E13.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.3.2.2.1.cmml" xref="S4.E13.m1.1.1.3.2.2">subscript</csymbol><apply id="S4.E13.m1.1.1.3.2.2.2.cmml" xref="S4.E13.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.3.2.2.2.1.cmml" xref="S4.E13.m1.1.1.3.2.2">superscript</csymbol><ci id="S4.E13.m1.1.1.3.2.2.2.2.cmml" xref="S4.E13.m1.1.1.3.2.2.2.2">𝒓</ci><ci id="S4.E13.m1.1.1.3.2.2.2.3.cmml" xref="S4.E13.m1.1.1.3.2.2.2.3">𝒖</ci></apply><ci id="S4.E13.m1.1.1.3.2.2.3.cmml" xref="S4.E13.m1.1.1.3.2.2.3">𝒂</ci></apply><apply id="S4.E13.m1.1.1.3.2.3.cmml" xref="S4.E13.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.3.2.3.1.cmml" xref="S4.E13.m1.1.1.3.2.3">subscript</csymbol><apply id="S4.E13.m1.1.1.3.2.3.2.cmml" xref="S4.E13.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.3.2.3.2.1.cmml" xref="S4.E13.m1.1.1.3.2.3">superscript</csymbol><ci id="S4.E13.m1.1.1.3.2.3.2.2.cmml" xref="S4.E13.m1.1.1.3.2.3.2.2">𝒓</ci><ci id="S4.E13.m1.1.1.3.2.3.2.3.cmml" xref="S4.E13.m1.1.1.3.2.3.2.3">𝒖</ci></apply><ci id="S4.E13.m1.1.1.3.2.3.3.cmml" xref="S4.E13.m1.1.1.3.2.3.3">𝒓</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E13.m1.1c">\bm{r^{u}_{merge}}=\sqrt{\bm{r^{u}_{a}}\cdot\bm{r^{u}_{r}}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS1.p5" class="ltx_para">
<p id="S4.SS1.p5.6" class="ltx_p">Secondly, we found that the merged prediction persistently underestimates the shift from the labelled class ratio <math id="S4.SS1.p5.1.m1.1" class="ltx_Math" alttext="\bm{r^{l}}" display="inline"><semantics id="S4.SS1.p5.1.m1.1a"><msup id="S4.SS1.p5.1.m1.1.1" xref="S4.SS1.p5.1.m1.1.1.cmml"><mi id="S4.SS1.p5.1.m1.1.1.2" xref="S4.SS1.p5.1.m1.1.1.2.cmml">𝒓</mi><mi id="S4.SS1.p5.1.m1.1.1.3" xref="S4.SS1.p5.1.m1.1.1.3.cmml">𝒍</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.1.m1.1b"><apply id="S4.SS1.p5.1.m1.1.1.cmml" xref="S4.SS1.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.1.m1.1.1.1.cmml" xref="S4.SS1.p5.1.m1.1.1">superscript</csymbol><ci id="S4.SS1.p5.1.m1.1.1.2.cmml" xref="S4.SS1.p5.1.m1.1.1.2">𝒓</ci><ci id="S4.SS1.p5.1.m1.1.1.3.cmml" xref="S4.SS1.p5.1.m1.1.1.3">𝒍</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.1.m1.1c">\bm{r^{l}}</annotation></semantics></math> to the unlabelled class ratio <math id="S4.SS1.p5.2.m2.1" class="ltx_Math" alttext="\bm{r^{u}}" display="inline"><semantics id="S4.SS1.p5.2.m2.1a"><msup id="S4.SS1.p5.2.m2.1.1" xref="S4.SS1.p5.2.m2.1.1.cmml"><mi id="S4.SS1.p5.2.m2.1.1.2" xref="S4.SS1.p5.2.m2.1.1.2.cmml">𝒓</mi><mi id="S4.SS1.p5.2.m2.1.1.3" xref="S4.SS1.p5.2.m2.1.1.3.cmml">𝒖</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.2.m2.1b"><apply id="S4.SS1.p5.2.m2.1.1.cmml" xref="S4.SS1.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.2.m2.1.1.1.cmml" xref="S4.SS1.p5.2.m2.1.1">superscript</csymbol><ci id="S4.SS1.p5.2.m2.1.1.2.cmml" xref="S4.SS1.p5.2.m2.1.1.2">𝒓</ci><ci id="S4.SS1.p5.2.m2.1.1.3.cmml" xref="S4.SS1.p5.2.m2.1.1.3">𝒖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.2.m2.1c">\bm{r^{u}}</annotation></semantics></math>.  A heuristic solution to this underestimation problem is to square the relative change in the class ratio predicted by <math id="S4.SS1.p5.3.m3.1" class="ltx_Math" alttext="\bm{r^{u}_{merge}}" display="inline"><semantics id="S4.SS1.p5.3.m3.1a"><msubsup id="S4.SS1.p5.3.m3.1.1" xref="S4.SS1.p5.3.m3.1.1.cmml"><mi id="S4.SS1.p5.3.m3.1.1.2.2" xref="S4.SS1.p5.3.m3.1.1.2.2.cmml">𝒓</mi><mrow id="S4.SS1.p5.3.m3.1.1.3" xref="S4.SS1.p5.3.m3.1.1.3.cmml"><mi id="S4.SS1.p5.3.m3.1.1.3.2" xref="S4.SS1.p5.3.m3.1.1.3.2.cmml">𝒎</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p5.3.m3.1.1.3.1" xref="S4.SS1.p5.3.m3.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p5.3.m3.1.1.3.3" xref="S4.SS1.p5.3.m3.1.1.3.3.cmml">𝒆</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p5.3.m3.1.1.3.1a" xref="S4.SS1.p5.3.m3.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p5.3.m3.1.1.3.4" xref="S4.SS1.p5.3.m3.1.1.3.4.cmml">𝒓</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p5.3.m3.1.1.3.1b" xref="S4.SS1.p5.3.m3.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p5.3.m3.1.1.3.5" xref="S4.SS1.p5.3.m3.1.1.3.5.cmml">𝒈</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p5.3.m3.1.1.3.1c" xref="S4.SS1.p5.3.m3.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p5.3.m3.1.1.3.6" xref="S4.SS1.p5.3.m3.1.1.3.6.cmml">𝒆</mi></mrow><mi id="S4.SS1.p5.3.m3.1.1.2.3" xref="S4.SS1.p5.3.m3.1.1.2.3.cmml">𝒖</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.3.m3.1b"><apply id="S4.SS1.p5.3.m3.1.1.cmml" xref="S4.SS1.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.3.m3.1.1.1.cmml" xref="S4.SS1.p5.3.m3.1.1">subscript</csymbol><apply id="S4.SS1.p5.3.m3.1.1.2.cmml" xref="S4.SS1.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.3.m3.1.1.2.1.cmml" xref="S4.SS1.p5.3.m3.1.1">superscript</csymbol><ci id="S4.SS1.p5.3.m3.1.1.2.2.cmml" xref="S4.SS1.p5.3.m3.1.1.2.2">𝒓</ci><ci id="S4.SS1.p5.3.m3.1.1.2.3.cmml" xref="S4.SS1.p5.3.m3.1.1.2.3">𝒖</ci></apply><apply id="S4.SS1.p5.3.m3.1.1.3.cmml" xref="S4.SS1.p5.3.m3.1.1.3"><times id="S4.SS1.p5.3.m3.1.1.3.1.cmml" xref="S4.SS1.p5.3.m3.1.1.3.1"></times><ci id="S4.SS1.p5.3.m3.1.1.3.2.cmml" xref="S4.SS1.p5.3.m3.1.1.3.2">𝒎</ci><ci id="S4.SS1.p5.3.m3.1.1.3.3.cmml" xref="S4.SS1.p5.3.m3.1.1.3.3">𝒆</ci><ci id="S4.SS1.p5.3.m3.1.1.3.4.cmml" xref="S4.SS1.p5.3.m3.1.1.3.4">𝒓</ci><ci id="S4.SS1.p5.3.m3.1.1.3.5.cmml" xref="S4.SS1.p5.3.m3.1.1.3.5">𝒈</ci><ci id="S4.SS1.p5.3.m3.1.1.3.6.cmml" xref="S4.SS1.p5.3.m3.1.1.3.6">𝒆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.3.m3.1c">\bm{r^{u}_{merge}}</annotation></semantics></math>. Formally, we express <math id="S4.SS1.p5.4.m4.1" class="ltx_Math" alttext="\bm{r^{u}_{merge}}" display="inline"><semantics id="S4.SS1.p5.4.m4.1a"><msubsup id="S4.SS1.p5.4.m4.1.1" xref="S4.SS1.p5.4.m4.1.1.cmml"><mi id="S4.SS1.p5.4.m4.1.1.2.2" xref="S4.SS1.p5.4.m4.1.1.2.2.cmml">𝒓</mi><mrow id="S4.SS1.p5.4.m4.1.1.3" xref="S4.SS1.p5.4.m4.1.1.3.cmml"><mi id="S4.SS1.p5.4.m4.1.1.3.2" xref="S4.SS1.p5.4.m4.1.1.3.2.cmml">𝒎</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p5.4.m4.1.1.3.1" xref="S4.SS1.p5.4.m4.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p5.4.m4.1.1.3.3" xref="S4.SS1.p5.4.m4.1.1.3.3.cmml">𝒆</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p5.4.m4.1.1.3.1a" xref="S4.SS1.p5.4.m4.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p5.4.m4.1.1.3.4" xref="S4.SS1.p5.4.m4.1.1.3.4.cmml">𝒓</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p5.4.m4.1.1.3.1b" xref="S4.SS1.p5.4.m4.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p5.4.m4.1.1.3.5" xref="S4.SS1.p5.4.m4.1.1.3.5.cmml">𝒈</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p5.4.m4.1.1.3.1c" xref="S4.SS1.p5.4.m4.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p5.4.m4.1.1.3.6" xref="S4.SS1.p5.4.m4.1.1.3.6.cmml">𝒆</mi></mrow><mi id="S4.SS1.p5.4.m4.1.1.2.3" xref="S4.SS1.p5.4.m4.1.1.2.3.cmml">𝒖</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.4.m4.1b"><apply id="S4.SS1.p5.4.m4.1.1.cmml" xref="S4.SS1.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.4.m4.1.1.1.cmml" xref="S4.SS1.p5.4.m4.1.1">subscript</csymbol><apply id="S4.SS1.p5.4.m4.1.1.2.cmml" xref="S4.SS1.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.4.m4.1.1.2.1.cmml" xref="S4.SS1.p5.4.m4.1.1">superscript</csymbol><ci id="S4.SS1.p5.4.m4.1.1.2.2.cmml" xref="S4.SS1.p5.4.m4.1.1.2.2">𝒓</ci><ci id="S4.SS1.p5.4.m4.1.1.2.3.cmml" xref="S4.SS1.p5.4.m4.1.1.2.3">𝒖</ci></apply><apply id="S4.SS1.p5.4.m4.1.1.3.cmml" xref="S4.SS1.p5.4.m4.1.1.3"><times id="S4.SS1.p5.4.m4.1.1.3.1.cmml" xref="S4.SS1.p5.4.m4.1.1.3.1"></times><ci id="S4.SS1.p5.4.m4.1.1.3.2.cmml" xref="S4.SS1.p5.4.m4.1.1.3.2">𝒎</ci><ci id="S4.SS1.p5.4.m4.1.1.3.3.cmml" xref="S4.SS1.p5.4.m4.1.1.3.3">𝒆</ci><ci id="S4.SS1.p5.4.m4.1.1.3.4.cmml" xref="S4.SS1.p5.4.m4.1.1.3.4">𝒓</ci><ci id="S4.SS1.p5.4.m4.1.1.3.5.cmml" xref="S4.SS1.p5.4.m4.1.1.3.5">𝒈</ci><ci id="S4.SS1.p5.4.m4.1.1.3.6.cmml" xref="S4.SS1.p5.4.m4.1.1.3.6">𝒆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.4.m4.1c">\bm{r^{u}_{merge}}</annotation></semantics></math> relative to <math id="S4.SS1.p5.5.m5.1" class="ltx_Math" alttext="\bm{r^{l}}" display="inline"><semantics id="S4.SS1.p5.5.m5.1a"><msup id="S4.SS1.p5.5.m5.1.1" xref="S4.SS1.p5.5.m5.1.1.cmml"><mi id="S4.SS1.p5.5.m5.1.1.2" xref="S4.SS1.p5.5.m5.1.1.2.cmml">𝒓</mi><mi id="S4.SS1.p5.5.m5.1.1.3" xref="S4.SS1.p5.5.m5.1.1.3.cmml">𝒍</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.5.m5.1b"><apply id="S4.SS1.p5.5.m5.1.1.cmml" xref="S4.SS1.p5.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.5.m5.1.1.1.cmml" xref="S4.SS1.p5.5.m5.1.1">superscript</csymbol><ci id="S4.SS1.p5.5.m5.1.1.2.cmml" xref="S4.SS1.p5.5.m5.1.1.2">𝒓</ci><ci id="S4.SS1.p5.5.m5.1.1.3.cmml" xref="S4.SS1.p5.5.m5.1.1.3">𝒍</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.5.m5.1c">\bm{r^{l}}</annotation></semantics></math> and calculate the squared prediction <math id="S4.SS1.p5.6.m6.1" class="ltx_Math" alttext="\bm{r^{u}_{square}}" display="inline"><semantics id="S4.SS1.p5.6.m6.1a"><msubsup id="S4.SS1.p5.6.m6.1.1" xref="S4.SS1.p5.6.m6.1.1.cmml"><mi id="S4.SS1.p5.6.m6.1.1.2.2" xref="S4.SS1.p5.6.m6.1.1.2.2.cmml">𝒓</mi><mrow id="S4.SS1.p5.6.m6.1.1.3" xref="S4.SS1.p5.6.m6.1.1.3.cmml"><mi id="S4.SS1.p5.6.m6.1.1.3.2" xref="S4.SS1.p5.6.m6.1.1.3.2.cmml">𝒔</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p5.6.m6.1.1.3.1" xref="S4.SS1.p5.6.m6.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p5.6.m6.1.1.3.3" xref="S4.SS1.p5.6.m6.1.1.3.3.cmml">𝒒</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p5.6.m6.1.1.3.1a" xref="S4.SS1.p5.6.m6.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p5.6.m6.1.1.3.4" xref="S4.SS1.p5.6.m6.1.1.3.4.cmml">𝒖</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p5.6.m6.1.1.3.1b" xref="S4.SS1.p5.6.m6.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p5.6.m6.1.1.3.5" xref="S4.SS1.p5.6.m6.1.1.3.5.cmml">𝒂</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p5.6.m6.1.1.3.1c" xref="S4.SS1.p5.6.m6.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p5.6.m6.1.1.3.6" xref="S4.SS1.p5.6.m6.1.1.3.6.cmml">𝒓</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p5.6.m6.1.1.3.1d" xref="S4.SS1.p5.6.m6.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p5.6.m6.1.1.3.7" xref="S4.SS1.p5.6.m6.1.1.3.7.cmml">𝒆</mi></mrow><mi id="S4.SS1.p5.6.m6.1.1.2.3" xref="S4.SS1.p5.6.m6.1.1.2.3.cmml">𝒖</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.6.m6.1b"><apply id="S4.SS1.p5.6.m6.1.1.cmml" xref="S4.SS1.p5.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.6.m6.1.1.1.cmml" xref="S4.SS1.p5.6.m6.1.1">subscript</csymbol><apply id="S4.SS1.p5.6.m6.1.1.2.cmml" xref="S4.SS1.p5.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.6.m6.1.1.2.1.cmml" xref="S4.SS1.p5.6.m6.1.1">superscript</csymbol><ci id="S4.SS1.p5.6.m6.1.1.2.2.cmml" xref="S4.SS1.p5.6.m6.1.1.2.2">𝒓</ci><ci id="S4.SS1.p5.6.m6.1.1.2.3.cmml" xref="S4.SS1.p5.6.m6.1.1.2.3">𝒖</ci></apply><apply id="S4.SS1.p5.6.m6.1.1.3.cmml" xref="S4.SS1.p5.6.m6.1.1.3"><times id="S4.SS1.p5.6.m6.1.1.3.1.cmml" xref="S4.SS1.p5.6.m6.1.1.3.1"></times><ci id="S4.SS1.p5.6.m6.1.1.3.2.cmml" xref="S4.SS1.p5.6.m6.1.1.3.2">𝒔</ci><ci id="S4.SS1.p5.6.m6.1.1.3.3.cmml" xref="S4.SS1.p5.6.m6.1.1.3.3">𝒒</ci><ci id="S4.SS1.p5.6.m6.1.1.3.4.cmml" xref="S4.SS1.p5.6.m6.1.1.3.4">𝒖</ci><ci id="S4.SS1.p5.6.m6.1.1.3.5.cmml" xref="S4.SS1.p5.6.m6.1.1.3.5">𝒂</ci><ci id="S4.SS1.p5.6.m6.1.1.3.6.cmml" xref="S4.SS1.p5.6.m6.1.1.3.6">𝒓</ci><ci id="S4.SS1.p5.6.m6.1.1.3.7.cmml" xref="S4.SS1.p5.6.m6.1.1.3.7">𝒆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.6.m6.1c">\bm{r^{u}_{square}}</annotation></semantics></math> for the class ratio as:</p>
<table id="S4.E14" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E14.m1.1" class="ltx_Math" alttext="\vspace{-0.25em}\bm{r^{u}_{square}}=\bm{r^{l}}\left(\frac{\bm{r^{u}_{merge}}}{\bm{r^{l}}}\right)^{2}=\frac{\bm{r^{u}_{a}}\cdot\bm{r^{u}_{r}}}{\bm{r^{l}}}" display="block"><semantics id="S4.E14.m1.1a"><mrow id="S4.E14.m1.1.2" xref="S4.E14.m1.1.2.cmml"><msubsup id="S4.E14.m1.1.2.2" xref="S4.E14.m1.1.2.2.cmml"><mi id="S4.E14.m1.1.2.2.2.2" xref="S4.E14.m1.1.2.2.2.2.cmml">𝒓</mi><mrow id="S4.E14.m1.1.2.2.3" xref="S4.E14.m1.1.2.2.3.cmml"><mi id="S4.E14.m1.1.2.2.3.2" xref="S4.E14.m1.1.2.2.3.2.cmml">𝒔</mi><mo lspace="0em" rspace="0em" id="S4.E14.m1.1.2.2.3.1" xref="S4.E14.m1.1.2.2.3.1.cmml">​</mo><mi id="S4.E14.m1.1.2.2.3.3" xref="S4.E14.m1.1.2.2.3.3.cmml">𝒒</mi><mo lspace="0em" rspace="0em" id="S4.E14.m1.1.2.2.3.1a" xref="S4.E14.m1.1.2.2.3.1.cmml">​</mo><mi id="S4.E14.m1.1.2.2.3.4" xref="S4.E14.m1.1.2.2.3.4.cmml">𝒖</mi><mo lspace="0em" rspace="0em" id="S4.E14.m1.1.2.2.3.1b" xref="S4.E14.m1.1.2.2.3.1.cmml">​</mo><mi id="S4.E14.m1.1.2.2.3.5" xref="S4.E14.m1.1.2.2.3.5.cmml">𝒂</mi><mo lspace="0em" rspace="0em" id="S4.E14.m1.1.2.2.3.1c" xref="S4.E14.m1.1.2.2.3.1.cmml">​</mo><mi id="S4.E14.m1.1.2.2.3.6" xref="S4.E14.m1.1.2.2.3.6.cmml">𝒓</mi><mo lspace="0em" rspace="0em" id="S4.E14.m1.1.2.2.3.1d" xref="S4.E14.m1.1.2.2.3.1.cmml">​</mo><mi id="S4.E14.m1.1.2.2.3.7" xref="S4.E14.m1.1.2.2.3.7.cmml">𝒆</mi></mrow><mi id="S4.E14.m1.1.2.2.2.3" xref="S4.E14.m1.1.2.2.2.3.cmml">𝒖</mi></msubsup><mo id="S4.E14.m1.1.2.3" xref="S4.E14.m1.1.2.3.cmml">=</mo><mrow id="S4.E14.m1.1.2.4" xref="S4.E14.m1.1.2.4.cmml"><msup id="S4.E14.m1.1.2.4.2" xref="S4.E14.m1.1.2.4.2.cmml"><mi id="S4.E14.m1.1.2.4.2.2" xref="S4.E14.m1.1.2.4.2.2.cmml">𝒓</mi><mi id="S4.E14.m1.1.2.4.2.3" xref="S4.E14.m1.1.2.4.2.3.cmml">𝒍</mi></msup><mo lspace="0em" rspace="0em" id="S4.E14.m1.1.2.4.1" xref="S4.E14.m1.1.2.4.1.cmml">​</mo><msup id="S4.E14.m1.1.2.4.3" xref="S4.E14.m1.1.2.4.3.cmml"><mrow id="S4.E14.m1.1.2.4.3.2.2" xref="S4.E14.m1.1.1.cmml"><mo id="S4.E14.m1.1.2.4.3.2.2.1" xref="S4.E14.m1.1.1.cmml">(</mo><mfrac id="S4.E14.m1.1.1" xref="S4.E14.m1.1.1.cmml"><msubsup id="S4.E14.m1.1.1.2" xref="S4.E14.m1.1.1.2.cmml"><mi id="S4.E14.m1.1.1.2.2.2" xref="S4.E14.m1.1.1.2.2.2.cmml">𝒓</mi><mrow id="S4.E14.m1.1.1.2.3" xref="S4.E14.m1.1.1.2.3.cmml"><mi id="S4.E14.m1.1.1.2.3.2" xref="S4.E14.m1.1.1.2.3.2.cmml">𝒎</mi><mo lspace="0em" rspace="0em" id="S4.E14.m1.1.1.2.3.1" xref="S4.E14.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.E14.m1.1.1.2.3.3" xref="S4.E14.m1.1.1.2.3.3.cmml">𝒆</mi><mo lspace="0em" rspace="0em" id="S4.E14.m1.1.1.2.3.1a" xref="S4.E14.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.E14.m1.1.1.2.3.4" xref="S4.E14.m1.1.1.2.3.4.cmml">𝒓</mi><mo lspace="0em" rspace="0em" id="S4.E14.m1.1.1.2.3.1b" xref="S4.E14.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.E14.m1.1.1.2.3.5" xref="S4.E14.m1.1.1.2.3.5.cmml">𝒈</mi><mo lspace="0em" rspace="0em" id="S4.E14.m1.1.1.2.3.1c" xref="S4.E14.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.E14.m1.1.1.2.3.6" xref="S4.E14.m1.1.1.2.3.6.cmml">𝒆</mi></mrow><mi id="S4.E14.m1.1.1.2.2.3" xref="S4.E14.m1.1.1.2.2.3.cmml">𝒖</mi></msubsup><msup id="S4.E14.m1.1.1.3" xref="S4.E14.m1.1.1.3.cmml"><mi id="S4.E14.m1.1.1.3.2" xref="S4.E14.m1.1.1.3.2.cmml">𝒓</mi><mi id="S4.E14.m1.1.1.3.3" xref="S4.E14.m1.1.1.3.3.cmml">𝒍</mi></msup></mfrac><mo id="S4.E14.m1.1.2.4.3.2.2.2" xref="S4.E14.m1.1.1.cmml">)</mo></mrow><mn id="S4.E14.m1.1.2.4.3.3" xref="S4.E14.m1.1.2.4.3.3.cmml">2</mn></msup></mrow><mo id="S4.E14.m1.1.2.5" xref="S4.E14.m1.1.2.5.cmml">=</mo><mfrac id="S4.E14.m1.1.2.6" xref="S4.E14.m1.1.2.6.cmml"><mrow id="S4.E14.m1.1.2.6.2" xref="S4.E14.m1.1.2.6.2.cmml"><msubsup id="S4.E14.m1.1.2.6.2.2" xref="S4.E14.m1.1.2.6.2.2.cmml"><mi id="S4.E14.m1.1.2.6.2.2.2.2" xref="S4.E14.m1.1.2.6.2.2.2.2.cmml">𝒓</mi><mi id="S4.E14.m1.1.2.6.2.2.3" xref="S4.E14.m1.1.2.6.2.2.3.cmml">𝒂</mi><mi id="S4.E14.m1.1.2.6.2.2.2.3" xref="S4.E14.m1.1.2.6.2.2.2.3.cmml">𝒖</mi></msubsup><mo lspace="0.222em" rspace="0.222em" id="S4.E14.m1.1.2.6.2.1" xref="S4.E14.m1.1.2.6.2.1.cmml">⋅</mo><msubsup id="S4.E14.m1.1.2.6.2.3" xref="S4.E14.m1.1.2.6.2.3.cmml"><mi id="S4.E14.m1.1.2.6.2.3.2.2" xref="S4.E14.m1.1.2.6.2.3.2.2.cmml">𝒓</mi><mi id="S4.E14.m1.1.2.6.2.3.3" xref="S4.E14.m1.1.2.6.2.3.3.cmml">𝒓</mi><mi id="S4.E14.m1.1.2.6.2.3.2.3" xref="S4.E14.m1.1.2.6.2.3.2.3.cmml">𝒖</mi></msubsup></mrow><msup id="S4.E14.m1.1.2.6.3" xref="S4.E14.m1.1.2.6.3.cmml"><mi id="S4.E14.m1.1.2.6.3.2" xref="S4.E14.m1.1.2.6.3.2.cmml">𝒓</mi><mi id="S4.E14.m1.1.2.6.3.3" xref="S4.E14.m1.1.2.6.3.3.cmml">𝒍</mi></msup></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S4.E14.m1.1b"><apply id="S4.E14.m1.1.2.cmml" xref="S4.E14.m1.1.2"><and id="S4.E14.m1.1.2a.cmml" xref="S4.E14.m1.1.2"></and><apply id="S4.E14.m1.1.2b.cmml" xref="S4.E14.m1.1.2"><eq id="S4.E14.m1.1.2.3.cmml" xref="S4.E14.m1.1.2.3"></eq><apply id="S4.E14.m1.1.2.2.cmml" xref="S4.E14.m1.1.2.2"><csymbol cd="ambiguous" id="S4.E14.m1.1.2.2.1.cmml" xref="S4.E14.m1.1.2.2">subscript</csymbol><apply id="S4.E14.m1.1.2.2.2.cmml" xref="S4.E14.m1.1.2.2"><csymbol cd="ambiguous" id="S4.E14.m1.1.2.2.2.1.cmml" xref="S4.E14.m1.1.2.2">superscript</csymbol><ci id="S4.E14.m1.1.2.2.2.2.cmml" xref="S4.E14.m1.1.2.2.2.2">𝒓</ci><ci id="S4.E14.m1.1.2.2.2.3.cmml" xref="S4.E14.m1.1.2.2.2.3">𝒖</ci></apply><apply id="S4.E14.m1.1.2.2.3.cmml" xref="S4.E14.m1.1.2.2.3"><times id="S4.E14.m1.1.2.2.3.1.cmml" xref="S4.E14.m1.1.2.2.3.1"></times><ci id="S4.E14.m1.1.2.2.3.2.cmml" xref="S4.E14.m1.1.2.2.3.2">𝒔</ci><ci id="S4.E14.m1.1.2.2.3.3.cmml" xref="S4.E14.m1.1.2.2.3.3">𝒒</ci><ci id="S4.E14.m1.1.2.2.3.4.cmml" xref="S4.E14.m1.1.2.2.3.4">𝒖</ci><ci id="S4.E14.m1.1.2.2.3.5.cmml" xref="S4.E14.m1.1.2.2.3.5">𝒂</ci><ci id="S4.E14.m1.1.2.2.3.6.cmml" xref="S4.E14.m1.1.2.2.3.6">𝒓</ci><ci id="S4.E14.m1.1.2.2.3.7.cmml" xref="S4.E14.m1.1.2.2.3.7">𝒆</ci></apply></apply><apply id="S4.E14.m1.1.2.4.cmml" xref="S4.E14.m1.1.2.4"><times id="S4.E14.m1.1.2.4.1.cmml" xref="S4.E14.m1.1.2.4.1"></times><apply id="S4.E14.m1.1.2.4.2.cmml" xref="S4.E14.m1.1.2.4.2"><csymbol cd="ambiguous" id="S4.E14.m1.1.2.4.2.1.cmml" xref="S4.E14.m1.1.2.4.2">superscript</csymbol><ci id="S4.E14.m1.1.2.4.2.2.cmml" xref="S4.E14.m1.1.2.4.2.2">𝒓</ci><ci id="S4.E14.m1.1.2.4.2.3.cmml" xref="S4.E14.m1.1.2.4.2.3">𝒍</ci></apply><apply id="S4.E14.m1.1.2.4.3.cmml" xref="S4.E14.m1.1.2.4.3"><csymbol cd="ambiguous" id="S4.E14.m1.1.2.4.3.1.cmml" xref="S4.E14.m1.1.2.4.3">superscript</csymbol><apply id="S4.E14.m1.1.1.cmml" xref="S4.E14.m1.1.2.4.3.2.2"><divide id="S4.E14.m1.1.1.1.cmml" xref="S4.E14.m1.1.2.4.3.2.2"></divide><apply id="S4.E14.m1.1.1.2.cmml" xref="S4.E14.m1.1.1.2"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.2.1.cmml" xref="S4.E14.m1.1.1.2">subscript</csymbol><apply id="S4.E14.m1.1.1.2.2.cmml" xref="S4.E14.m1.1.1.2"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.2.2.1.cmml" xref="S4.E14.m1.1.1.2">superscript</csymbol><ci id="S4.E14.m1.1.1.2.2.2.cmml" xref="S4.E14.m1.1.1.2.2.2">𝒓</ci><ci id="S4.E14.m1.1.1.2.2.3.cmml" xref="S4.E14.m1.1.1.2.2.3">𝒖</ci></apply><apply id="S4.E14.m1.1.1.2.3.cmml" xref="S4.E14.m1.1.1.2.3"><times id="S4.E14.m1.1.1.2.3.1.cmml" xref="S4.E14.m1.1.1.2.3.1"></times><ci id="S4.E14.m1.1.1.2.3.2.cmml" xref="S4.E14.m1.1.1.2.3.2">𝒎</ci><ci id="S4.E14.m1.1.1.2.3.3.cmml" xref="S4.E14.m1.1.1.2.3.3">𝒆</ci><ci id="S4.E14.m1.1.1.2.3.4.cmml" xref="S4.E14.m1.1.1.2.3.4">𝒓</ci><ci id="S4.E14.m1.1.1.2.3.5.cmml" xref="S4.E14.m1.1.1.2.3.5">𝒈</ci><ci id="S4.E14.m1.1.1.2.3.6.cmml" xref="S4.E14.m1.1.1.2.3.6">𝒆</ci></apply></apply><apply id="S4.E14.m1.1.1.3.cmml" xref="S4.E14.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.3.1.cmml" xref="S4.E14.m1.1.1.3">superscript</csymbol><ci id="S4.E14.m1.1.1.3.2.cmml" xref="S4.E14.m1.1.1.3.2">𝒓</ci><ci id="S4.E14.m1.1.1.3.3.cmml" xref="S4.E14.m1.1.1.3.3">𝒍</ci></apply></apply><cn type="integer" id="S4.E14.m1.1.2.4.3.3.cmml" xref="S4.E14.m1.1.2.4.3.3">2</cn></apply></apply></apply><apply id="S4.E14.m1.1.2c.cmml" xref="S4.E14.m1.1.2"><eq id="S4.E14.m1.1.2.5.cmml" xref="S4.E14.m1.1.2.5"></eq><share href="#S4.E14.m1.1.2.4.cmml" id="S4.E14.m1.1.2d.cmml" xref="S4.E14.m1.1.2"></share><apply id="S4.E14.m1.1.2.6.cmml" xref="S4.E14.m1.1.2.6"><divide id="S4.E14.m1.1.2.6.1.cmml" xref="S4.E14.m1.1.2.6"></divide><apply id="S4.E14.m1.1.2.6.2.cmml" xref="S4.E14.m1.1.2.6.2"><ci id="S4.E14.m1.1.2.6.2.1.cmml" xref="S4.E14.m1.1.2.6.2.1">⋅</ci><apply id="S4.E14.m1.1.2.6.2.2.cmml" xref="S4.E14.m1.1.2.6.2.2"><csymbol cd="ambiguous" id="S4.E14.m1.1.2.6.2.2.1.cmml" xref="S4.E14.m1.1.2.6.2.2">subscript</csymbol><apply id="S4.E14.m1.1.2.6.2.2.2.cmml" xref="S4.E14.m1.1.2.6.2.2"><csymbol cd="ambiguous" id="S4.E14.m1.1.2.6.2.2.2.1.cmml" xref="S4.E14.m1.1.2.6.2.2">superscript</csymbol><ci id="S4.E14.m1.1.2.6.2.2.2.2.cmml" xref="S4.E14.m1.1.2.6.2.2.2.2">𝒓</ci><ci id="S4.E14.m1.1.2.6.2.2.2.3.cmml" xref="S4.E14.m1.1.2.6.2.2.2.3">𝒖</ci></apply><ci id="S4.E14.m1.1.2.6.2.2.3.cmml" xref="S4.E14.m1.1.2.6.2.2.3">𝒂</ci></apply><apply id="S4.E14.m1.1.2.6.2.3.cmml" xref="S4.E14.m1.1.2.6.2.3"><csymbol cd="ambiguous" id="S4.E14.m1.1.2.6.2.3.1.cmml" xref="S4.E14.m1.1.2.6.2.3">subscript</csymbol><apply id="S4.E14.m1.1.2.6.2.3.2.cmml" xref="S4.E14.m1.1.2.6.2.3"><csymbol cd="ambiguous" id="S4.E14.m1.1.2.6.2.3.2.1.cmml" xref="S4.E14.m1.1.2.6.2.3">superscript</csymbol><ci id="S4.E14.m1.1.2.6.2.3.2.2.cmml" xref="S4.E14.m1.1.2.6.2.3.2.2">𝒓</ci><ci id="S4.E14.m1.1.2.6.2.3.2.3.cmml" xref="S4.E14.m1.1.2.6.2.3.2.3">𝒖</ci></apply><ci id="S4.E14.m1.1.2.6.2.3.3.cmml" xref="S4.E14.m1.1.2.6.2.3.3">𝒓</ci></apply></apply><apply id="S4.E14.m1.1.2.6.3.cmml" xref="S4.E14.m1.1.2.6.3"><csymbol cd="ambiguous" id="S4.E14.m1.1.2.6.3.1.cmml" xref="S4.E14.m1.1.2.6.3">superscript</csymbol><ci id="S4.E14.m1.1.2.6.3.2.cmml" xref="S4.E14.m1.1.2.6.3.2">𝒓</ci><ci id="S4.E14.m1.1.2.6.3.3.cmml" xref="S4.E14.m1.1.2.6.3.3">𝒍</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E14.m1.1c">\vspace{-0.25em}\bm{r^{u}_{square}}=\bm{r^{l}}\left(\frac{\bm{r^{u}_{merge}}}{\bm{r^{l}}}\right)^{2}=\frac{\bm{r^{u}_{a}}\cdot\bm{r^{u}_{r}}}{\bm{r^{l}}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p5.7" class="ltx_p">Finally, we apply L1 normalisation to <math id="S4.SS1.p5.7.m1.1" class="ltx_Math" alttext="\bm{r^{u}_{square}}" display="inline"><semantics id="S4.SS1.p5.7.m1.1a"><msubsup id="S4.SS1.p5.7.m1.1.1" xref="S4.SS1.p5.7.m1.1.1.cmml"><mi id="S4.SS1.p5.7.m1.1.1.2.2" xref="S4.SS1.p5.7.m1.1.1.2.2.cmml">𝒓</mi><mrow id="S4.SS1.p5.7.m1.1.1.3" xref="S4.SS1.p5.7.m1.1.1.3.cmml"><mi id="S4.SS1.p5.7.m1.1.1.3.2" xref="S4.SS1.p5.7.m1.1.1.3.2.cmml">𝒔</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p5.7.m1.1.1.3.1" xref="S4.SS1.p5.7.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p5.7.m1.1.1.3.3" xref="S4.SS1.p5.7.m1.1.1.3.3.cmml">𝒒</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p5.7.m1.1.1.3.1a" xref="S4.SS1.p5.7.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p5.7.m1.1.1.3.4" xref="S4.SS1.p5.7.m1.1.1.3.4.cmml">𝒖</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p5.7.m1.1.1.3.1b" xref="S4.SS1.p5.7.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p5.7.m1.1.1.3.5" xref="S4.SS1.p5.7.m1.1.1.3.5.cmml">𝒂</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p5.7.m1.1.1.3.1c" xref="S4.SS1.p5.7.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p5.7.m1.1.1.3.6" xref="S4.SS1.p5.7.m1.1.1.3.6.cmml">𝒓</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p5.7.m1.1.1.3.1d" xref="S4.SS1.p5.7.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p5.7.m1.1.1.3.7" xref="S4.SS1.p5.7.m1.1.1.3.7.cmml">𝒆</mi></mrow><mi id="S4.SS1.p5.7.m1.1.1.2.3" xref="S4.SS1.p5.7.m1.1.1.2.3.cmml">𝒖</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.7.m1.1b"><apply id="S4.SS1.p5.7.m1.1.1.cmml" xref="S4.SS1.p5.7.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.7.m1.1.1.1.cmml" xref="S4.SS1.p5.7.m1.1.1">subscript</csymbol><apply id="S4.SS1.p5.7.m1.1.1.2.cmml" xref="S4.SS1.p5.7.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.7.m1.1.1.2.1.cmml" xref="S4.SS1.p5.7.m1.1.1">superscript</csymbol><ci id="S4.SS1.p5.7.m1.1.1.2.2.cmml" xref="S4.SS1.p5.7.m1.1.1.2.2">𝒓</ci><ci id="S4.SS1.p5.7.m1.1.1.2.3.cmml" xref="S4.SS1.p5.7.m1.1.1.2.3">𝒖</ci></apply><apply id="S4.SS1.p5.7.m1.1.1.3.cmml" xref="S4.SS1.p5.7.m1.1.1.3"><times id="S4.SS1.p5.7.m1.1.1.3.1.cmml" xref="S4.SS1.p5.7.m1.1.1.3.1"></times><ci id="S4.SS1.p5.7.m1.1.1.3.2.cmml" xref="S4.SS1.p5.7.m1.1.1.3.2">𝒔</ci><ci id="S4.SS1.p5.7.m1.1.1.3.3.cmml" xref="S4.SS1.p5.7.m1.1.1.3.3">𝒒</ci><ci id="S4.SS1.p5.7.m1.1.1.3.4.cmml" xref="S4.SS1.p5.7.m1.1.1.3.4">𝒖</ci><ci id="S4.SS1.p5.7.m1.1.1.3.5.cmml" xref="S4.SS1.p5.7.m1.1.1.3.5">𝒂</ci><ci id="S4.SS1.p5.7.m1.1.1.3.6.cmml" xref="S4.SS1.p5.7.m1.1.1.3.6">𝒓</ci><ci id="S4.SS1.p5.7.m1.1.1.3.7.cmml" xref="S4.SS1.p5.7.m1.1.1.3.7">𝒆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.7.m1.1c">\bm{r^{u}_{square}}</annotation></semantics></math> so the distribution sums to 1.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS2.5.1.1" class="ltx_text">IV-B</span> </span><span id="S4.SS2.6.2" class="ltx_text ltx_font_italic">Dynamic Selection of Pseudo-labels per Image</span>
</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.9" class="ltx_p">Even with a perfectly accurate class distribution, we find that under significant domain shift the pseudo-labels generated by the teacher remain unreliable early in self-training. Thus, instead of estimating the average number of objects per image in the unlabelled data, we set this value to target a mean confidence score <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mi id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">\tau</annotation></semantics></math> across the generated pseudo-labels. This accounts for the initial poor performance of the teacher in the target domain, and allows the number of pseudo-labels per image to increase as the model becomes more confident. We use Algorithm <a href="#alg1" title="Algorithm 1 ‣ IV-B Dynamic Selection of Pseudo-labels per Image ‣ IV Method ‣ Predicting Class Distribution Shift for Reliable Domain Adaptive Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> to calculate the number of objects per image required to deliver a mean pseudo-label confidence score of <math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><mi id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><ci id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">\tau</annotation></semantics></math>. In this algorithm, the average number of objects per image <math id="S4.SS2.p1.3.m3.1" class="ltx_Math" alttext="n_{o}\in\mathbb{R}" display="inline"><semantics id="S4.SS2.p1.3.m3.1a"><mrow id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml"><msub id="S4.SS2.p1.3.m3.1.1.2" xref="S4.SS2.p1.3.m3.1.1.2.cmml"><mi id="S4.SS2.p1.3.m3.1.1.2.2" xref="S4.SS2.p1.3.m3.1.1.2.2.cmml">n</mi><mi id="S4.SS2.p1.3.m3.1.1.2.3" xref="S4.SS2.p1.3.m3.1.1.2.3.cmml">o</mi></msub><mo id="S4.SS2.p1.3.m3.1.1.1" xref="S4.SS2.p1.3.m3.1.1.1.cmml">∈</mo><mi id="S4.SS2.p1.3.m3.1.1.3" xref="S4.SS2.p1.3.m3.1.1.3.cmml">ℝ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><apply id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1"><in id="S4.SS2.p1.3.m3.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1"></in><apply id="S4.SS2.p1.3.m3.1.1.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m3.1.1.2.1.cmml" xref="S4.SS2.p1.3.m3.1.1.2">subscript</csymbol><ci id="S4.SS2.p1.3.m3.1.1.2.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2.2">𝑛</ci><ci id="S4.SS2.p1.3.m3.1.1.2.3.cmml" xref="S4.SS2.p1.3.m3.1.1.2.3">𝑜</ci></apply><ci id="S4.SS2.p1.3.m3.1.1.3.cmml" xref="S4.SS2.p1.3.m3.1.1.3">ℝ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">n_{o}\in\mathbb{R}</annotation></semantics></math> is iteratively increased by <math id="S4.SS2.p1.4.m4.1" class="ltx_Math" alttext="\Delta n_{o}" display="inline"><semantics id="S4.SS2.p1.4.m4.1a"><mrow id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml"><mi mathvariant="normal" id="S4.SS2.p1.4.m4.1.1.2" xref="S4.SS2.p1.4.m4.1.1.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.4.m4.1.1.1" xref="S4.SS2.p1.4.m4.1.1.1.cmml">​</mo><msub id="S4.SS2.p1.4.m4.1.1.3" xref="S4.SS2.p1.4.m4.1.1.3.cmml"><mi id="S4.SS2.p1.4.m4.1.1.3.2" xref="S4.SS2.p1.4.m4.1.1.3.2.cmml">n</mi><mi id="S4.SS2.p1.4.m4.1.1.3.3" xref="S4.SS2.p1.4.m4.1.1.3.3.cmml">o</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><apply id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1"><times id="S4.SS2.p1.4.m4.1.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1.1"></times><ci id="S4.SS2.p1.4.m4.1.1.2.cmml" xref="S4.SS2.p1.4.m4.1.1.2">Δ</ci><apply id="S4.SS2.p1.4.m4.1.1.3.cmml" xref="S4.SS2.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.1.1.3.1.cmml" xref="S4.SS2.p1.4.m4.1.1.3">subscript</csymbol><ci id="S4.SS2.p1.4.m4.1.1.3.2.cmml" xref="S4.SS2.p1.4.m4.1.1.3.2">𝑛</ci><ci id="S4.SS2.p1.4.m4.1.1.3.3.cmml" xref="S4.SS2.p1.4.m4.1.1.3.3">𝑜</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">\Delta n_{o}</annotation></semantics></math>. At each step, pseudo-labels <math id="S4.SS2.p1.5.m5.1" class="ltx_Math" alttext="y_{u}" display="inline"><semantics id="S4.SS2.p1.5.m5.1a"><msub id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml"><mi id="S4.SS2.p1.5.m5.1.1.2" xref="S4.SS2.p1.5.m5.1.1.2.cmml">y</mi><mi id="S4.SS2.p1.5.m5.1.1.3" xref="S4.SS2.p1.5.m5.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.1b"><apply id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m5.1.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1">subscript</csymbol><ci id="S4.SS2.p1.5.m5.1.1.2.cmml" xref="S4.SS2.p1.5.m5.1.1.2">𝑦</ci><ci id="S4.SS2.p1.5.m5.1.1.3.cmml" xref="S4.SS2.p1.5.m5.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.1c">y_{u}</annotation></semantics></math> are generated for the entire unlabelled dataset by aligning them with the predicted class ratio <math id="S4.SS2.p1.6.m6.1" class="ltx_Math" alttext="\bm{r^{u}}" display="inline"><semantics id="S4.SS2.p1.6.m6.1a"><msup id="S4.SS2.p1.6.m6.1.1" xref="S4.SS2.p1.6.m6.1.1.cmml"><mi id="S4.SS2.p1.6.m6.1.1.2" xref="S4.SS2.p1.6.m6.1.1.2.cmml">𝒓</mi><mi id="S4.SS2.p1.6.m6.1.1.3" xref="S4.SS2.p1.6.m6.1.1.3.cmml">𝒖</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m6.1b"><apply id="S4.SS2.p1.6.m6.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m6.1.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1">superscript</csymbol><ci id="S4.SS2.p1.6.m6.1.1.2.cmml" xref="S4.SS2.p1.6.m6.1.1.2">𝒓</ci><ci id="S4.SS2.p1.6.m6.1.1.3.cmml" xref="S4.SS2.p1.6.m6.1.1.3">𝒖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m6.1c">\bm{r^{u}}</annotation></semantics></math> and the current number of objects per image <math id="S4.SS2.p1.7.m7.1" class="ltx_Math" alttext="n_{o}" display="inline"><semantics id="S4.SS2.p1.7.m7.1a"><msub id="S4.SS2.p1.7.m7.1.1" xref="S4.SS2.p1.7.m7.1.1.cmml"><mi id="S4.SS2.p1.7.m7.1.1.2" xref="S4.SS2.p1.7.m7.1.1.2.cmml">n</mi><mi id="S4.SS2.p1.7.m7.1.1.3" xref="S4.SS2.p1.7.m7.1.1.3.cmml">o</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.7.m7.1b"><apply id="S4.SS2.p1.7.m7.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.7.m7.1.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1">subscript</csymbol><ci id="S4.SS2.p1.7.m7.1.1.2.cmml" xref="S4.SS2.p1.7.m7.1.1.2">𝑛</ci><ci id="S4.SS2.p1.7.m7.1.1.3.cmml" xref="S4.SS2.p1.7.m7.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.7.m7.1c">n_{o}</annotation></semantics></math>. The mean confidence score <math id="S4.SS2.p1.8.m8.1" class="ltx_Math" alttext="p_{mean}" display="inline"><semantics id="S4.SS2.p1.8.m8.1a"><msub id="S4.SS2.p1.8.m8.1.1" xref="S4.SS2.p1.8.m8.1.1.cmml"><mi id="S4.SS2.p1.8.m8.1.1.2" xref="S4.SS2.p1.8.m8.1.1.2.cmml">p</mi><mrow id="S4.SS2.p1.8.m8.1.1.3" xref="S4.SS2.p1.8.m8.1.1.3.cmml"><mi id="S4.SS2.p1.8.m8.1.1.3.2" xref="S4.SS2.p1.8.m8.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.8.m8.1.1.3.1" xref="S4.SS2.p1.8.m8.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p1.8.m8.1.1.3.3" xref="S4.SS2.p1.8.m8.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.8.m8.1.1.3.1a" xref="S4.SS2.p1.8.m8.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p1.8.m8.1.1.3.4" xref="S4.SS2.p1.8.m8.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.8.m8.1.1.3.1b" xref="S4.SS2.p1.8.m8.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p1.8.m8.1.1.3.5" xref="S4.SS2.p1.8.m8.1.1.3.5.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.8.m8.1b"><apply id="S4.SS2.p1.8.m8.1.1.cmml" xref="S4.SS2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.8.m8.1.1.1.cmml" xref="S4.SS2.p1.8.m8.1.1">subscript</csymbol><ci id="S4.SS2.p1.8.m8.1.1.2.cmml" xref="S4.SS2.p1.8.m8.1.1.2">𝑝</ci><apply id="S4.SS2.p1.8.m8.1.1.3.cmml" xref="S4.SS2.p1.8.m8.1.1.3"><times id="S4.SS2.p1.8.m8.1.1.3.1.cmml" xref="S4.SS2.p1.8.m8.1.1.3.1"></times><ci id="S4.SS2.p1.8.m8.1.1.3.2.cmml" xref="S4.SS2.p1.8.m8.1.1.3.2">𝑚</ci><ci id="S4.SS2.p1.8.m8.1.1.3.3.cmml" xref="S4.SS2.p1.8.m8.1.1.3.3">𝑒</ci><ci id="S4.SS2.p1.8.m8.1.1.3.4.cmml" xref="S4.SS2.p1.8.m8.1.1.3.4">𝑎</ci><ci id="S4.SS2.p1.8.m8.1.1.3.5.cmml" xref="S4.SS2.p1.8.m8.1.1.3.5">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.8.m8.1c">p_{mean}</annotation></semantics></math> is then calculated across the pseudo-labels, and the loop terminates when this value falls below the target value <math id="S4.SS2.p1.9.m9.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S4.SS2.p1.9.m9.1a"><mi id="S4.SS2.p1.9.m9.1.1" xref="S4.SS2.p1.9.m9.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.9.m9.1b"><ci id="S4.SS2.p1.9.m9.1.1.cmml" xref="S4.SS2.p1.9.m9.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.9.m9.1c">\tau</annotation></semantics></math>.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Dynamic Selection of Objects per Image</figcaption>
<div id="alg1.3" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">  
</div>
<div id="alg1.l2" class="ltx_listingline">  <math id="alg1.l2.m1.1" class="ltx_Math" alttext="\bm{r^{u}}" display="inline"><semantics id="alg1.l2.m1.1a"><msup id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">𝒓</mi><mi id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml">𝒖</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1">superscript</csymbol><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝒓</ci><ci id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3">𝒖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">\bm{r^{u}}</annotation></semantics></math> = <span id="alg1.l2.1" class="ltx_text ltx_font_smallcaps">PredictClassRatio</span>(<math id="alg1.l2.m2.1" class="ltx_Math" alttext="D_{l}" display="inline"><semantics id="alg1.l2.m2.1a"><msub id="alg1.l2.m2.1.1" xref="alg1.l2.m2.1.1.cmml"><mi id="alg1.l2.m2.1.1.2" xref="alg1.l2.m2.1.1.2.cmml">D</mi><mi id="alg1.l2.m2.1.1.3" xref="alg1.l2.m2.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.1b"><apply id="alg1.l2.m2.1.1.cmml" xref="alg1.l2.m2.1.1"><csymbol cd="ambiguous" id="alg1.l2.m2.1.1.1.cmml" xref="alg1.l2.m2.1.1">subscript</csymbol><ci id="alg1.l2.m2.1.1.2.cmml" xref="alg1.l2.m2.1.1.2">𝐷</ci><ci id="alg1.l2.m2.1.1.3.cmml" xref="alg1.l2.m2.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.1c">D_{l}</annotation></semantics></math>, <math id="alg1.l2.m3.1" class="ltx_Math" alttext="D_{u}" display="inline"><semantics id="alg1.l2.m3.1a"><msub id="alg1.l2.m3.1.1" xref="alg1.l2.m3.1.1.cmml"><mi id="alg1.l2.m3.1.1.2" xref="alg1.l2.m3.1.1.2.cmml">D</mi><mi id="alg1.l2.m3.1.1.3" xref="alg1.l2.m3.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l2.m3.1b"><apply id="alg1.l2.m3.1.1.cmml" xref="alg1.l2.m3.1.1"><csymbol cd="ambiguous" id="alg1.l2.m3.1.1.1.cmml" xref="alg1.l2.m3.1.1">subscript</csymbol><ci id="alg1.l2.m3.1.1.2.cmml" xref="alg1.l2.m3.1.1.2">𝐷</ci><ci id="alg1.l2.m3.1.1.3.cmml" xref="alg1.l2.m3.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m3.1c">D_{u}</annotation></semantics></math>)

</div>
<div id="alg1.l3" class="ltx_listingline">  <math id="alg1.l3.m1.1" class="ltx_Math" alttext="n_{o}=0" display="inline"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><msub id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml"><mi id="alg1.l3.m1.1.1.2.2" xref="alg1.l3.m1.1.1.2.2.cmml">n</mi><mi id="alg1.l3.m1.1.1.2.3" xref="alg1.l3.m1.1.1.2.3.cmml">o</mi></msub><mo id="alg1.l3.m1.1.1.1" xref="alg1.l3.m1.1.1.1.cmml">=</mo><mn id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><eq id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1"></eq><apply id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.2.1.cmml" xref="alg1.l3.m1.1.1.2">subscript</csymbol><ci id="alg1.l3.m1.1.1.2.2.cmml" xref="alg1.l3.m1.1.1.2.2">𝑛</ci><ci id="alg1.l3.m1.1.1.2.3.cmml" xref="alg1.l3.m1.1.1.2.3">𝑜</ci></apply><cn type="integer" id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">n_{o}=0</annotation></semantics></math>

</div>
<div id="alg1.l4" class="ltx_listingline">  <span id="alg1.l4.1" class="ltx_text ltx_font_bold">while</span> True <span id="alg1.l4.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l5" class="ltx_listingline">        <math id="alg1.l5.m1.1" class="ltx_Math" alttext="n_{o}=n_{o}+\Delta n_{o}" display="inline"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><msub id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml"><mi id="alg1.l5.m1.1.1.2.2" xref="alg1.l5.m1.1.1.2.2.cmml">n</mi><mi id="alg1.l5.m1.1.1.2.3" xref="alg1.l5.m1.1.1.2.3.cmml">o</mi></msub><mo id="alg1.l5.m1.1.1.1" xref="alg1.l5.m1.1.1.1.cmml">=</mo><mrow id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml"><msub id="alg1.l5.m1.1.1.3.2" xref="alg1.l5.m1.1.1.3.2.cmml"><mi id="alg1.l5.m1.1.1.3.2.2" xref="alg1.l5.m1.1.1.3.2.2.cmml">n</mi><mi id="alg1.l5.m1.1.1.3.2.3" xref="alg1.l5.m1.1.1.3.2.3.cmml">o</mi></msub><mo id="alg1.l5.m1.1.1.3.1" xref="alg1.l5.m1.1.1.3.1.cmml">+</mo><mrow id="alg1.l5.m1.1.1.3.3" xref="alg1.l5.m1.1.1.3.3.cmml"><mi mathvariant="normal" id="alg1.l5.m1.1.1.3.3.2" xref="alg1.l5.m1.1.1.3.3.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="alg1.l5.m1.1.1.3.3.1" xref="alg1.l5.m1.1.1.3.3.1.cmml">​</mo><msub id="alg1.l5.m1.1.1.3.3.3" xref="alg1.l5.m1.1.1.3.3.3.cmml"><mi id="alg1.l5.m1.1.1.3.3.3.2" xref="alg1.l5.m1.1.1.3.3.3.2.cmml">n</mi><mi id="alg1.l5.m1.1.1.3.3.3.3" xref="alg1.l5.m1.1.1.3.3.3.3.cmml">o</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><eq id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1"></eq><apply id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.2.1.cmml" xref="alg1.l5.m1.1.1.2">subscript</csymbol><ci id="alg1.l5.m1.1.1.2.2.cmml" xref="alg1.l5.m1.1.1.2.2">𝑛</ci><ci id="alg1.l5.m1.1.1.2.3.cmml" xref="alg1.l5.m1.1.1.2.3">𝑜</ci></apply><apply id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3"><plus id="alg1.l5.m1.1.1.3.1.cmml" xref="alg1.l5.m1.1.1.3.1"></plus><apply id="alg1.l5.m1.1.1.3.2.cmml" xref="alg1.l5.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.3.2.1.cmml" xref="alg1.l5.m1.1.1.3.2">subscript</csymbol><ci id="alg1.l5.m1.1.1.3.2.2.cmml" xref="alg1.l5.m1.1.1.3.2.2">𝑛</ci><ci id="alg1.l5.m1.1.1.3.2.3.cmml" xref="alg1.l5.m1.1.1.3.2.3">𝑜</ci></apply><apply id="alg1.l5.m1.1.1.3.3.cmml" xref="alg1.l5.m1.1.1.3.3"><times id="alg1.l5.m1.1.1.3.3.1.cmml" xref="alg1.l5.m1.1.1.3.3.1"></times><ci id="alg1.l5.m1.1.1.3.3.2.cmml" xref="alg1.l5.m1.1.1.3.3.2">Δ</ci><apply id="alg1.l5.m1.1.1.3.3.3.cmml" xref="alg1.l5.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.3.3.3.1.cmml" xref="alg1.l5.m1.1.1.3.3.3">subscript</csymbol><ci id="alg1.l5.m1.1.1.3.3.3.2.cmml" xref="alg1.l5.m1.1.1.3.3.3.2">𝑛</ci><ci id="alg1.l5.m1.1.1.3.3.3.3.cmml" xref="alg1.l5.m1.1.1.3.3.3.3">𝑜</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">n_{o}=n_{o}+\Delta n_{o}</annotation></semantics></math>

</div>
<div id="alg1.l6" class="ltx_listingline">        <math id="alg1.l6.m1.1" class="ltx_Math" alttext="y_{u}" display="inline"><semantics id="alg1.l6.m1.1a"><msub id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><mi id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml">y</mi><mi id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1">subscript</csymbol><ci id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2">𝑦</ci><ci id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">y_{u}</annotation></semantics></math> = <span id="alg1.l6.1" class="ltx_text ltx_font_smallcaps">ACT</span>(<math id="alg1.l6.m2.1" class="ltx_Math" alttext="\bm{r^{u}}" display="inline"><semantics id="alg1.l6.m2.1a"><msup id="alg1.l6.m2.1.1" xref="alg1.l6.m2.1.1.cmml"><mi id="alg1.l6.m2.1.1.2" xref="alg1.l6.m2.1.1.2.cmml">𝒓</mi><mi id="alg1.l6.m2.1.1.3" xref="alg1.l6.m2.1.1.3.cmml">𝒖</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l6.m2.1b"><apply id="alg1.l6.m2.1.1.cmml" xref="alg1.l6.m2.1.1"><csymbol cd="ambiguous" id="alg1.l6.m2.1.1.1.cmml" xref="alg1.l6.m2.1.1">superscript</csymbol><ci id="alg1.l6.m2.1.1.2.cmml" xref="alg1.l6.m2.1.1.2">𝒓</ci><ci id="alg1.l6.m2.1.1.3.cmml" xref="alg1.l6.m2.1.1.3">𝒖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m2.1c">\bm{r^{u}}</annotation></semantics></math>, <math id="alg1.l6.m3.1" class="ltx_Math" alttext="n_{o}" display="inline"><semantics id="alg1.l6.m3.1a"><msub id="alg1.l6.m3.1.1" xref="alg1.l6.m3.1.1.cmml"><mi id="alg1.l6.m3.1.1.2" xref="alg1.l6.m3.1.1.2.cmml">n</mi><mi id="alg1.l6.m3.1.1.3" xref="alg1.l6.m3.1.1.3.cmml">o</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l6.m3.1b"><apply id="alg1.l6.m3.1.1.cmml" xref="alg1.l6.m3.1.1"><csymbol cd="ambiguous" id="alg1.l6.m3.1.1.1.cmml" xref="alg1.l6.m3.1.1">subscript</csymbol><ci id="alg1.l6.m3.1.1.2.cmml" xref="alg1.l6.m3.1.1.2">𝑛</ci><ci id="alg1.l6.m3.1.1.3.cmml" xref="alg1.l6.m3.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m3.1c">n_{o}</annotation></semantics></math>)

</div>
<div id="alg1.l7" class="ltx_listingline">        <math id="alg1.l7.m1.1" class="ltx_Math" alttext="p_{mean}" display="inline"><semantics id="alg1.l7.m1.1a"><msub id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><mi id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml">p</mi><mrow id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml"><mi id="alg1.l7.m1.1.1.3.2" xref="alg1.l7.m1.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg1.l7.m1.1.1.3.1" xref="alg1.l7.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l7.m1.1.1.3.3" xref="alg1.l7.m1.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l7.m1.1.1.3.1a" xref="alg1.l7.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l7.m1.1.1.3.4" xref="alg1.l7.m1.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l7.m1.1.1.3.1b" xref="alg1.l7.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l7.m1.1.1.3.5" xref="alg1.l7.m1.1.1.3.5.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1">subscript</csymbol><ci id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2">𝑝</ci><apply id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3"><times id="alg1.l7.m1.1.1.3.1.cmml" xref="alg1.l7.m1.1.1.3.1"></times><ci id="alg1.l7.m1.1.1.3.2.cmml" xref="alg1.l7.m1.1.1.3.2">𝑚</ci><ci id="alg1.l7.m1.1.1.3.3.cmml" xref="alg1.l7.m1.1.1.3.3">𝑒</ci><ci id="alg1.l7.m1.1.1.3.4.cmml" xref="alg1.l7.m1.1.1.3.4">𝑎</ci><ci id="alg1.l7.m1.1.1.3.5.cmml" xref="alg1.l7.m1.1.1.3.5">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">p_{mean}</annotation></semantics></math> = <span id="alg1.l7.1" class="ltx_text ltx_font_smallcaps">MeanConfidenceScore</span>(<math id="alg1.l7.m2.1" class="ltx_Math" alttext="y_{u}" display="inline"><semantics id="alg1.l7.m2.1a"><msub id="alg1.l7.m2.1.1" xref="alg1.l7.m2.1.1.cmml"><mi id="alg1.l7.m2.1.1.2" xref="alg1.l7.m2.1.1.2.cmml">y</mi><mi id="alg1.l7.m2.1.1.3" xref="alg1.l7.m2.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l7.m2.1b"><apply id="alg1.l7.m2.1.1.cmml" xref="alg1.l7.m2.1.1"><csymbol cd="ambiguous" id="alg1.l7.m2.1.1.1.cmml" xref="alg1.l7.m2.1.1">subscript</csymbol><ci id="alg1.l7.m2.1.1.2.cmml" xref="alg1.l7.m2.1.1.2">𝑦</ci><ci id="alg1.l7.m2.1.1.3.cmml" xref="alg1.l7.m2.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m2.1c">y_{u}</annotation></semantics></math>)

</div>
<div id="alg1.l8" class="ltx_listingline">        <span id="alg1.l8.1" class="ltx_text ltx_font_bold">if</span> <math id="alg1.l8.m1.1" class="ltx_Math" alttext="p_{mean}&lt;\tau" display="inline"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><msub id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml"><mi id="alg1.l8.m1.1.1.2.2" xref="alg1.l8.m1.1.1.2.2.cmml">p</mi><mrow id="alg1.l8.m1.1.1.2.3" xref="alg1.l8.m1.1.1.2.3.cmml"><mi id="alg1.l8.m1.1.1.2.3.2" xref="alg1.l8.m1.1.1.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m1.1.1.2.3.1" xref="alg1.l8.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.l8.m1.1.1.2.3.3" xref="alg1.l8.m1.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m1.1.1.2.3.1a" xref="alg1.l8.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.l8.m1.1.1.2.3.4" xref="alg1.l8.m1.1.1.2.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m1.1.1.2.3.1b" xref="alg1.l8.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.l8.m1.1.1.2.3.5" xref="alg1.l8.m1.1.1.2.3.5.cmml">n</mi></mrow></msub><mo id="alg1.l8.m1.1.1.1" xref="alg1.l8.m1.1.1.1.cmml">&lt;</mo><mi id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml">τ</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><lt id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1"></lt><apply id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.2.1.cmml" xref="alg1.l8.m1.1.1.2">subscript</csymbol><ci id="alg1.l8.m1.1.1.2.2.cmml" xref="alg1.l8.m1.1.1.2.2">𝑝</ci><apply id="alg1.l8.m1.1.1.2.3.cmml" xref="alg1.l8.m1.1.1.2.3"><times id="alg1.l8.m1.1.1.2.3.1.cmml" xref="alg1.l8.m1.1.1.2.3.1"></times><ci id="alg1.l8.m1.1.1.2.3.2.cmml" xref="alg1.l8.m1.1.1.2.3.2">𝑚</ci><ci id="alg1.l8.m1.1.1.2.3.3.cmml" xref="alg1.l8.m1.1.1.2.3.3">𝑒</ci><ci id="alg1.l8.m1.1.1.2.3.4.cmml" xref="alg1.l8.m1.1.1.2.3.4">𝑎</ci><ci id="alg1.l8.m1.1.1.2.3.5.cmml" xref="alg1.l8.m1.1.1.2.3.5">𝑛</ci></apply></apply><ci id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">p_{mean}&lt;\tau</annotation></semantics></math> <span id="alg1.l8.2" class="ltx_text ltx_font_bold">then</span>

</div>
<div id="alg1.l9" class="ltx_listingline">            <span id="alg1.l9.1" class="ltx_text ltx_font_bold">return</span> <math id="alg1.l9.m1.1" class="ltx_Math" alttext="n_{o}-\Delta n_{o}" display="inline"><semantics id="alg1.l9.m1.1a"><mrow id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><msub id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml"><mi id="alg1.l9.m1.1.1.2.2" xref="alg1.l9.m1.1.1.2.2.cmml">n</mi><mi id="alg1.l9.m1.1.1.2.3" xref="alg1.l9.m1.1.1.2.3.cmml">o</mi></msub><mo id="alg1.l9.m1.1.1.1" xref="alg1.l9.m1.1.1.1.cmml">−</mo><mrow id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml"><mi mathvariant="normal" id="alg1.l9.m1.1.1.3.2" xref="alg1.l9.m1.1.1.3.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="alg1.l9.m1.1.1.3.1" xref="alg1.l9.m1.1.1.3.1.cmml">​</mo><msub id="alg1.l9.m1.1.1.3.3" xref="alg1.l9.m1.1.1.3.3.cmml"><mi id="alg1.l9.m1.1.1.3.3.2" xref="alg1.l9.m1.1.1.3.3.2.cmml">n</mi><mi id="alg1.l9.m1.1.1.3.3.3" xref="alg1.l9.m1.1.1.3.3.3.cmml">o</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><minus id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1"></minus><apply id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.2.1.cmml" xref="alg1.l9.m1.1.1.2">subscript</csymbol><ci id="alg1.l9.m1.1.1.2.2.cmml" xref="alg1.l9.m1.1.1.2.2">𝑛</ci><ci id="alg1.l9.m1.1.1.2.3.cmml" xref="alg1.l9.m1.1.1.2.3">𝑜</ci></apply><apply id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3"><times id="alg1.l9.m1.1.1.3.1.cmml" xref="alg1.l9.m1.1.1.3.1"></times><ci id="alg1.l9.m1.1.1.3.2.cmml" xref="alg1.l9.m1.1.1.3.2">Δ</ci><apply id="alg1.l9.m1.1.1.3.3.cmml" xref="alg1.l9.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.3.3.1.cmml" xref="alg1.l9.m1.1.1.3.3">subscript</csymbol><ci id="alg1.l9.m1.1.1.3.3.2.cmml" xref="alg1.l9.m1.1.1.3.3.2">𝑛</ci><ci id="alg1.l9.m1.1.1.3.3.3.cmml" xref="alg1.l9.m1.1.1.3.3.3">𝑜</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">n_{o}-\Delta n_{o}</annotation></semantics></math>

</div>
</div>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span id="S5.1.1" class="ltx_text ltx_font_smallcaps">Experiments</span>
</h2>

<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS1.5.1.1" class="ltx_text">V-A</span> </span><span id="S5.SS1.6.2" class="ltx_text ltx_font_italic">Experimental Settings</span>
</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.1" class="ltx_p"><span id="S5.SS1.p1.1.1" class="ltx_text ltx_font_bold">Scenarios</span>. We validate our proposed method using two scenarios previously used for UDA-OD, and one novel scenario that captures a more extreme class distribution shift.</p>
<ul id="S5.I1" class="ltx_itemize">
<li id="S5.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i1.p1" class="ltx_para">
<p id="S5.I1.i1.p1.1" class="ltx_p">Adaptation from small to large dataset (C2B): as in previous work <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>, we utilise Cityscapes <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> as a small source dataset and BDD100k daytime <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> images as the large and diverse target domain. The shift in location in this scenario produces significant class distribution shift.</p>
</div>
</li>
<li id="S5.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i2.p1" class="ltx_para">
<p id="S5.I1.i2.p1.1" class="ltx_p">Adaptation from normal to foggy weather (C2F): this commonly studied scenario uses Cityscapes <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> as the source domain and Foggy Cityscapes <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> as the target domain. To compare with the optimal performance of the current state of the art <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>, we use all three levels of fog.</p>
</div>
</li>
<li id="S5.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i3.p1" class="ltx_para">
<p id="S5.I1.i3.p1.1" class="ltx_p">Adaptation from daytime to night (C2N): we propose a novel benchmark to  explore the impact of more extreme class distribution shift on UDA-OD. We utilise Cityscapes <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> as the source domain and BDD100k night <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> as the target domain.</p>
</div>
</li>
</ul>
</div>
<div id="S5.SS1.p2" class="ltx_para">
<p id="S5.SS1.p2.1" class="ltx_p"><span id="S5.SS1.p2.1.1" class="ltx_text ltx_font_bold">Network Architecture.</span> A standard object detection architecture is used across all UDA-OD works to enable fair comparison between methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>. Following this trend, we use Faster-RCNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> as the detector architecture with VGG-16 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> pre-trained on ImageNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> as the backbone. The inference rate of this network is quoted at 5Hz on a Nvidia K40 GPU <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>, while our experiments return 20Hz on a Nvidia GeForce RTX 3090. However, our method could be easily extended to novel architectures, making it useful for diverse robotic applications <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>.</p>
</div>
<div id="S5.SS1.p3" class="ltx_para">
<p id="S5.SS1.p3.2" class="ltx_p"><span id="S5.SS1.p3.2.1" class="ltx_text ltx_font_bold">Implementation Details.</span> We follow the default implementation provided in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> to test our method, which leverages MMDetection <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>. Thus, we use a batch size of 16 for the labelled and unlabelled data and a learning rate of 0.016. The optimiser used is SGD, with a momentum rate of 0.9 and a weight decay of 0.0001. For all experiments, the model is pre-trained using source data for 4,000 iterations before beginning self-training. For the C2B and C2N scenarios, we implement 42,000 iterations of self-training. Due to slower convergence on C2F, we self-train for 72,000 iterations. Lastly, we use a target mean confidence score <math id="S5.SS1.p3.1.m1.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S5.SS1.p3.1.m1.1a"><mi id="S5.SS1.p3.1.m1.1.1" xref="S5.SS1.p3.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.1.m1.1b"><ci id="S5.SS1.p3.1.m1.1.1.cmml" xref="S5.SS1.p3.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.1.m1.1c">\tau</annotation></semantics></math> of 0.6 and a step size <math id="S5.SS1.p3.2.m2.1" class="ltx_Math" alttext="\Delta n_{o}" display="inline"><semantics id="S5.SS1.p3.2.m2.1a"><mrow id="S5.SS1.p3.2.m2.1.1" xref="S5.SS1.p3.2.m2.1.1.cmml"><mi mathvariant="normal" id="S5.SS1.p3.2.m2.1.1.2" xref="S5.SS1.p3.2.m2.1.1.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p3.2.m2.1.1.1" xref="S5.SS1.p3.2.m2.1.1.1.cmml">​</mo><msub id="S5.SS1.p3.2.m2.1.1.3" xref="S5.SS1.p3.2.m2.1.1.3.cmml"><mi id="S5.SS1.p3.2.m2.1.1.3.2" xref="S5.SS1.p3.2.m2.1.1.3.2.cmml">n</mi><mi id="S5.SS1.p3.2.m2.1.1.3.3" xref="S5.SS1.p3.2.m2.1.1.3.3.cmml">o</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.2.m2.1b"><apply id="S5.SS1.p3.2.m2.1.1.cmml" xref="S5.SS1.p3.2.m2.1.1"><times id="S5.SS1.p3.2.m2.1.1.1.cmml" xref="S5.SS1.p3.2.m2.1.1.1"></times><ci id="S5.SS1.p3.2.m2.1.1.2.cmml" xref="S5.SS1.p3.2.m2.1.1.2">Δ</ci><apply id="S5.SS1.p3.2.m2.1.1.3.cmml" xref="S5.SS1.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="S5.SS1.p3.2.m2.1.1.3.1.cmml" xref="S5.SS1.p3.2.m2.1.1.3">subscript</csymbol><ci id="S5.SS1.p3.2.m2.1.1.3.2.cmml" xref="S5.SS1.p3.2.m2.1.1.3.2">𝑛</ci><ci id="S5.SS1.p3.2.m2.1.1.3.3.cmml" xref="S5.SS1.p3.2.m2.1.1.3.3">𝑜</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.2.m2.1c">\Delta n_{o}</annotation></semantics></math> of 0.1 for selecting the number of objects per image.</p>
</div>
<div id="S5.SS1.p4" class="ltx_para">
<p id="S5.SS1.p4.1" class="ltx_p"><span id="S5.SS1.p4.1.1" class="ltx_text ltx_font_bold">Evaluation.</span> Standard mean average precision (mAP) at an IOU threshold of 0.5 is used to compare performance with that reported by existing works. In additional to implementing our approach, we conduct the following evaluations:</p>
<ul id="S5.I2" class="ltx_itemize">
<li id="S5.I2.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I2.i1.p1" class="ltx_para">
<p id="S5.I2.i1.p1.1" class="ltx_p">For comparison on the novel C2N scenario, we implement Probabilistic Teacher <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> as per the released code and report the peak performance recorded across 24,000 iterations. This method is the current state of the art on the C2B and C2F scenarios, and thus provides a strong baseline for evaluating our method under more extreme class distribution shift.</p>
</div>
</li>
<li id="S5.I2.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I2.i2.p1" class="ltx_para">
<p id="S5.I2.i2.p1.1" class="ltx_p">We evaluate the original ACT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> on all scenarios using the same implementation as our method.</p>
</div>
</li>
<li id="S5.I2.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I2.i3.p1" class="ltx_para">
<p id="S5.I2.i3.p1.1" class="ltx_p">Lastly, for the C2N scenario, we evaluate the model trained for 48,000 iterations on the source data, and target data only.</p>
</div>
</li>
</ul>
</div>
<figure id="S5.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE I: </span>Results of adaptation from small to large-scale dataset (C2B) and Cityscapes to BDD100k night (C2N) scenario.  “Source only” and “Target only” refer to the models trained by only using labelled source data and labelled target data.</figcaption>
<div id="S5.T1.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:429.3pt;height:160.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(22.2pt,-8.3pt) scale(1.11551032369615,1.11551032369615) ;">
<table id="S5.T1.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T1.1.1.1.1" class="ltx_tr">
<th id="S5.T1.1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_tt">Methods</th>
<td id="S5.T1.1.1.1.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">Reference</td>
<td id="S5.T1.1.1.1.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">C2B (mAP)</td>
<td id="S5.T1.1.1.1.1.4" class="ltx_td ltx_align_center ltx_border_tt">C2N (mAP)</td>
</tr>
<tr id="S5.T1.1.1.2.2" class="ltx_tr">
<th id="S5.T1.1.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Source only <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>
</th>
<td id="S5.T1.1.1.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">-</td>
<td id="S5.T1.1.1.2.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">20.6</td>
<td id="S5.T1.1.1.2.2.4" class="ltx_td ltx_align_center ltx_border_t">3.8</td>
</tr>
<tr id="S5.T1.1.1.3.3" class="ltx_tr">
<th id="S5.T1.1.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">ICR-CCR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>
</th>
<td id="S5.T1.1.1.3.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">CVPR’20</td>
<td id="S5.T1.1.1.3.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">26.9</td>
<td id="S5.T1.1.1.3.3.4" class="ltx_td ltx_align_center ltx_border_t">-</td>
</tr>
<tr id="S5.T1.1.1.4.4" class="ltx_tr">
<th id="S5.T1.1.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">SFOD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>
</th>
<td id="S5.T1.1.1.4.4.2" class="ltx_td ltx_align_center ltx_border_r">AAAI’21</td>
<td id="S5.T1.1.1.4.4.3" class="ltx_td ltx_align_center ltx_border_r">29.0</td>
<td id="S5.T1.1.1.4.4.4" class="ltx_td ltx_align_center">-</td>
</tr>
<tr id="S5.T1.1.1.5.5" class="ltx_tr">
<th id="S5.T1.1.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">PT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>
</th>
<td id="S5.T1.1.1.5.5.2" class="ltx_td ltx_align_center ltx_border_r">ICML’22</td>
<td id="S5.T1.1.1.5.5.3" class="ltx_td ltx_align_center ltx_border_r">34.9</td>
<td id="S5.T1.1.1.5.5.4" class="ltx_td ltx_align_center">19.5</td>
</tr>
<tr id="S5.T1.1.1.6.6" class="ltx_tr">
<th id="S5.T1.1.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">LabelMatch <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>
</th>
<td id="S5.T1.1.1.6.6.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">-</td>
<td id="S5.T1.1.1.6.6.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">30.3</td>
<td id="S5.T1.1.1.6.6.4" class="ltx_td ltx_align_center ltx_border_t">11.1</td>
</tr>
<tr id="S5.T1.1.1.7.7" class="ltx_tr">
<th id="S5.T1.1.1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Ours</th>
<td id="S5.T1.1.1.7.7.2" class="ltx_td ltx_align_center ltx_border_r">-</td>
<td id="S5.T1.1.1.7.7.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T1.1.1.7.7.3.1" class="ltx_text ltx_font_bold">39.2</span></td>
<td id="S5.T1.1.1.7.7.4" class="ltx_td ltx_align_center"><span id="S5.T1.1.1.7.7.4.1" class="ltx_text ltx_font_bold">24.2</span></td>
</tr>
<tr id="S5.T1.1.1.8.8" class="ltx_tr">
<th id="S5.T1.1.1.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t">Target only <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>
</th>
<td id="S5.T1.1.1.8.8.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">-</td>
<td id="S5.T1.1.1.8.8.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">51.7</td>
<td id="S5.T1.1.1.8.8.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">32.7</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS2.5.1.1" class="ltx_text">V-B</span> </span><span id="S5.SS2.6.2" class="ltx_text ltx_font_italic">Performance Comparison</span>
</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.1" class="ltx_p">Our method matches or outperforms existing approaches across all three scenarios (Table <a href="#S5.T1" title="TABLE I ‣ V-A Experimental Settings ‣ V Experiments ‣ Predicting Class Distribution Shift for Reliable Domain Adaptive Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a>, <a href="#S5.T2" title="TABLE II ‣ V-B Performance Comparison ‣ V Experiments ‣ Predicting Class Distribution Shift for Reliable Domain Adaptive Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a>). Strong performance occurs on scenarios with more extreme class distribution shift, a case that has been largely overlooked in existing benchmarks. We outperform the strongest baseline Probabilistic Teacher <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> by 4.3 mAP on the previously studied C2B scenario (Table <a href="#S5.T1" title="TABLE I ‣ V-A Experimental Settings ‣ V Experiments ‣ Predicting Class Distribution Shift for Reliable Domain Adaptive Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a>). We further return a 4.7 mAP improvement on the novel C2N scenario (Table <a href="#S5.T1" title="TABLE I ‣ V-A Experimental Settings ‣ V Experiments ‣ Predicting Class Distribution Shift for Reliable Domain Adaptive Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a>), which is more challenging due to extreme class distribution shift (Figure <a href="#S5.F5" title="Figure 5 ‣ V-D Class Distribution Prediction ‣ V Experiments ‣ Predicting Class Distribution Shift for Reliable Domain Adaptive Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>) and the discrete appearance change from daytime to night. A clear improvement is also noted on both scenarios relative to using the original ACT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. These results highlight that by modelling shifts in a robot’s deployment context, pseudo-label reliability can be improved in Mean Teacher. Furthermore, it emphasises that class distribution shift must be considered when designing UDA-OD methods for robotics applications.</p>
</div>
<div id="S5.SS2.p2" class="ltx_para">
<p id="S5.SS2.p2.1" class="ltx_p">Interestingly, our approach remains competitive with existing methods on the normal to foggy scenario (C2F) (Table <a href="#S5.T2" title="TABLE II ‣ V-B Performance Comparison ‣ V Experiments ‣ Predicting Class Distribution Shift for Reliable Domain Adaptive Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a>), where there is a large change in image appearance but no class distribution shift. The average performance across five trials of our method is identical to the optimal performance returned by Probabilistic Teacher. The benefit of our approach is  prominent in low probability classes such as train, truck and bus, indicating that we are effectively mitigating the class imbalance problem. Furthermore, we return a 4.1 mAP improvement on this scenario relative to the original ACT, emphasising the benefit of accounting for pseudo-label reliability by dynamically updating the number of objects per image.</p>
</div>
<figure id="S5.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE II: </span>Results of adaptation from normal to foggy weather (C2F) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>. Due to variability in training and similar performance to Probabilistic Teacher, we run our method five times and report the mean mAP and standard deviation. “0.01”, “0.02” and “ALL” in the column of “split” represent the level of fog included in the target domain. See Table <a href="#S5.T1" title="TABLE I ‣ V-A Experimental Settings ‣ V Experiments ‣ Predicting Class Distribution Shift for Reliable Domain Adaptive Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a> for details of naming conventions.</figcaption>
<div id="S5.T2.9" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:429.3pt;height:199.5pt;vertical-align:-0.6pt;"><span class="ltx_transformed_inner" style="transform:translate(-154.5pt,71.6pt) scale(0.581446663259323,0.581446663259323) ;">
<table id="S5.T2.9.9" class="ltx_tabular ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T2.9.9.10.1" class="ltx_tr">
<td id="S5.T2.9.9.10.1.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt">Methods</td>
<td id="S5.T2.9.9.10.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">Split</td>
<td id="S5.T2.9.9.10.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">Reference</td>
<td id="S5.T2.9.9.10.1.4" class="ltx_td ltx_align_center ltx_border_tt">truck</td>
<td id="S5.T2.9.9.10.1.5" class="ltx_td ltx_align_center ltx_border_tt">car</td>
<td id="S5.T2.9.9.10.1.6" class="ltx_td ltx_align_center ltx_border_tt">rider</td>
<td id="S5.T2.9.9.10.1.7" class="ltx_td ltx_align_center ltx_border_tt">person</td>
<td id="S5.T2.9.9.10.1.8" class="ltx_td ltx_align_center ltx_border_tt">train</td>
<td id="S5.T2.9.9.10.1.9" class="ltx_td ltx_align_center ltx_border_tt">motor</td>
<td id="S5.T2.9.9.10.1.10" class="ltx_td ltx_align_center ltx_border_tt">bicycle</td>
<td id="S5.T2.9.9.10.1.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">bus</td>
<td id="S5.T2.9.9.10.1.12" class="ltx_td ltx_align_center ltx_border_tt">mAP</td>
</tr>
<tr id="S5.T2.9.9.11.2" class="ltx_tr">
<td id="S5.T2.9.9.11.2.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Source only <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>
</td>
<td id="S5.T2.9.9.11.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">ALL</td>
<td id="S5.T2.9.9.11.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">-</td>
<td id="S5.T2.9.9.11.2.4" class="ltx_td ltx_align_center ltx_border_t">12.1</td>
<td id="S5.T2.9.9.11.2.5" class="ltx_td ltx_align_center ltx_border_t">40.4</td>
<td id="S5.T2.9.9.11.2.6" class="ltx_td ltx_align_center ltx_border_t">33.4</td>
<td id="S5.T2.9.9.11.2.7" class="ltx_td ltx_align_center ltx_border_t">27.9</td>
<td id="S5.T2.9.9.11.2.8" class="ltx_td ltx_align_center ltx_border_t">10.1</td>
<td id="S5.T2.9.9.11.2.9" class="ltx_td ltx_align_center ltx_border_t">20.7</td>
<td id="S5.T2.9.9.11.2.10" class="ltx_td ltx_align_center ltx_border_t">30.9</td>
<td id="S5.T2.9.9.11.2.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">23.2</td>
<td id="S5.T2.9.9.11.2.12" class="ltx_td ltx_align_center ltx_border_t">24.8</td>
</tr>
<tr id="S5.T2.9.9.12.3" class="ltx_tr">
<td id="S5.T2.9.9.12.3.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">MTOR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>
</td>
<td id="S5.T2.9.9.12.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.02</td>
<td id="S5.T2.9.9.12.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">CVPR’19</td>
<td id="S5.T2.9.9.12.3.4" class="ltx_td ltx_align_center ltx_border_t">21.9</td>
<td id="S5.T2.9.9.12.3.5" class="ltx_td ltx_align_center ltx_border_t">44.0</td>
<td id="S5.T2.9.9.12.3.6" class="ltx_td ltx_align_center ltx_border_t">41.4</td>
<td id="S5.T2.9.9.12.3.7" class="ltx_td ltx_align_center ltx_border_t">30.6</td>
<td id="S5.T2.9.9.12.3.8" class="ltx_td ltx_align_center ltx_border_t">40.2</td>
<td id="S5.T2.9.9.12.3.9" class="ltx_td ltx_align_center ltx_border_t">31.7</td>
<td id="S5.T2.9.9.12.3.10" class="ltx_td ltx_align_center ltx_border_t">33.2</td>
<td id="S5.T2.9.9.12.3.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">43.4</td>
<td id="S5.T2.9.9.12.3.12" class="ltx_td ltx_align_center ltx_border_t">35.1</td>
</tr>
<tr id="S5.T2.9.9.13.4" class="ltx_tr">
<td id="S5.T2.9.9.13.4.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">SW <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>
</td>
<td id="S5.T2.9.9.13.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.02</td>
<td id="S5.T2.9.9.13.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">CVPR’19</td>
<td id="S5.T2.9.9.13.4.4" class="ltx_td ltx_align_center ltx_border_t">24.5</td>
<td id="S5.T2.9.9.13.4.5" class="ltx_td ltx_align_center ltx_border_t">43.5</td>
<td id="S5.T2.9.9.13.4.6" class="ltx_td ltx_align_center ltx_border_t">42.3</td>
<td id="S5.T2.9.9.13.4.7" class="ltx_td ltx_align_center ltx_border_t">29.9</td>
<td id="S5.T2.9.9.13.4.8" class="ltx_td ltx_align_center ltx_border_t">32.6</td>
<td id="S5.T2.9.9.13.4.9" class="ltx_td ltx_align_center ltx_border_t">30.0</td>
<td id="S5.T2.9.9.13.4.10" class="ltx_td ltx_align_center ltx_border_t">35.3</td>
<td id="S5.T2.9.9.13.4.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">32.6</td>
<td id="S5.T2.9.9.13.4.12" class="ltx_td ltx_align_center ltx_border_t">34.3</td>
</tr>
<tr id="S5.T2.9.9.14.5" class="ltx_tr">
<td id="S5.T2.9.9.14.5.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">DM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>
</td>
<td id="S5.T2.9.9.14.5.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">UN</td>
<td id="S5.T2.9.9.14.5.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">CVPR’19</td>
<td id="S5.T2.9.9.14.5.4" class="ltx_td ltx_align_center ltx_border_t">27.2</td>
<td id="S5.T2.9.9.14.5.5" class="ltx_td ltx_align_center ltx_border_t">40.5</td>
<td id="S5.T2.9.9.14.5.6" class="ltx_td ltx_align_center ltx_border_t">40.5</td>
<td id="S5.T2.9.9.14.5.7" class="ltx_td ltx_align_center ltx_border_t">30.8</td>
<td id="S5.T2.9.9.14.5.8" class="ltx_td ltx_align_center ltx_border_t">34.5</td>
<td id="S5.T2.9.9.14.5.9" class="ltx_td ltx_align_center ltx_border_t">28.4</td>
<td id="S5.T2.9.9.14.5.10" class="ltx_td ltx_align_center ltx_border_t">32.3</td>
<td id="S5.T2.9.9.14.5.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">38.4</td>
<td id="S5.T2.9.9.14.5.12" class="ltx_td ltx_align_center ltx_border_t">34.6</td>
</tr>
<tr id="S5.T2.9.9.15.6" class="ltx_tr">
<td id="S5.T2.9.9.15.6.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">PDA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>
</td>
<td id="S5.T2.9.9.15.6.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">ALL</td>
<td id="S5.T2.9.9.15.6.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">WACV’20</td>
<td id="S5.T2.9.9.15.6.4" class="ltx_td ltx_align_center ltx_border_t">24.3</td>
<td id="S5.T2.9.9.15.6.5" class="ltx_td ltx_align_center ltx_border_t">54.4</td>
<td id="S5.T2.9.9.15.6.6" class="ltx_td ltx_align_center ltx_border_t">45.5</td>
<td id="S5.T2.9.9.15.6.7" class="ltx_td ltx_align_center ltx_border_t">36.0</td>
<td id="S5.T2.9.9.15.6.8" class="ltx_td ltx_align_center ltx_border_t">25.8</td>
<td id="S5.T2.9.9.15.6.9" class="ltx_td ltx_align_center ltx_border_t">29.1</td>
<td id="S5.T2.9.9.15.6.10" class="ltx_td ltx_align_center ltx_border_t">35.9</td>
<td id="S5.T2.9.9.15.6.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">44.1</td>
<td id="S5.T2.9.9.15.6.12" class="ltx_td ltx_align_center ltx_border_t">36.9</td>
</tr>
<tr id="S5.T2.9.9.16.7" class="ltx_tr">
<td id="S5.T2.9.9.16.7.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">GPA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>
</td>
<td id="S5.T2.9.9.16.7.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.01</td>
<td id="S5.T2.9.9.16.7.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">CVPR’20</td>
<td id="S5.T2.9.9.16.7.4" class="ltx_td ltx_align_center ltx_border_t">24.7</td>
<td id="S5.T2.9.9.16.7.5" class="ltx_td ltx_align_center ltx_border_t">54.1</td>
<td id="S5.T2.9.9.16.7.6" class="ltx_td ltx_align_center ltx_border_t">46.7</td>
<td id="S5.T2.9.9.16.7.7" class="ltx_td ltx_align_center ltx_border_t">32.9</td>
<td id="S5.T2.9.9.16.7.8" class="ltx_td ltx_align_center ltx_border_t">41.1</td>
<td id="S5.T2.9.9.16.7.9" class="ltx_td ltx_align_center ltx_border_t">32.4</td>
<td id="S5.T2.9.9.16.7.10" class="ltx_td ltx_align_center ltx_border_t">38.7</td>
<td id="S5.T2.9.9.16.7.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">45.7</td>
<td id="S5.T2.9.9.16.7.12" class="ltx_td ltx_align_center ltx_border_t">39.5</td>
</tr>
<tr id="S5.T2.9.9.17.8" class="ltx_tr">
<td id="S5.T2.9.9.17.8.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">ATF <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite>
</td>
<td id="S5.T2.9.9.17.8.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">UN</td>
<td id="S5.T2.9.9.17.8.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">ECCV’20</td>
<td id="S5.T2.9.9.17.8.4" class="ltx_td ltx_align_center ltx_border_t">23.7</td>
<td id="S5.T2.9.9.17.8.5" class="ltx_td ltx_align_center ltx_border_t">50.0</td>
<td id="S5.T2.9.9.17.8.6" class="ltx_td ltx_align_center ltx_border_t">47.0</td>
<td id="S5.T2.9.9.17.8.7" class="ltx_td ltx_align_center ltx_border_t">34.6</td>
<td id="S5.T2.9.9.17.8.8" class="ltx_td ltx_align_center ltx_border_t">38.7</td>
<td id="S5.T2.9.9.17.8.9" class="ltx_td ltx_align_center ltx_border_t">33.4</td>
<td id="S5.T2.9.9.17.8.10" class="ltx_td ltx_align_center ltx_border_t">38.8</td>
<td id="S5.T2.9.9.17.8.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">43.3</td>
<td id="S5.T2.9.9.17.8.12" class="ltx_td ltx_align_center ltx_border_t">38.7</td>
</tr>
<tr id="S5.T2.9.9.18.9" class="ltx_tr">
<td id="S5.T2.9.9.18.9.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">HTCN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>
</td>
<td id="S5.T2.9.9.18.9.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.02</td>
<td id="S5.T2.9.9.18.9.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">CVPR’20</td>
<td id="S5.T2.9.9.18.9.4" class="ltx_td ltx_align_center ltx_border_t">31.6</td>
<td id="S5.T2.9.9.18.9.5" class="ltx_td ltx_align_center ltx_border_t">47.9</td>
<td id="S5.T2.9.9.18.9.6" class="ltx_td ltx_align_center ltx_border_t">47.5</td>
<td id="S5.T2.9.9.18.9.7" class="ltx_td ltx_align_center ltx_border_t">33.2</td>
<td id="S5.T2.9.9.18.9.8" class="ltx_td ltx_align_center ltx_border_t">40.9</td>
<td id="S5.T2.9.9.18.9.9" class="ltx_td ltx_align_center ltx_border_t">32.3</td>
<td id="S5.T2.9.9.18.9.10" class="ltx_td ltx_align_center ltx_border_t">37.1</td>
<td id="S5.T2.9.9.18.9.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">47.4</td>
<td id="S5.T2.9.9.18.9.12" class="ltx_td ltx_align_center ltx_border_t">39.8</td>
</tr>
<tr id="S5.T2.9.9.19.10" class="ltx_tr">
<td id="S5.T2.9.9.19.10.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">ICR-CCR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>
</td>
<td id="S5.T2.9.9.19.10.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">ALL</td>
<td id="S5.T2.9.9.19.10.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">CVPR’20</td>
<td id="S5.T2.9.9.19.10.4" class="ltx_td ltx_align_center ltx_border_t">27.2</td>
<td id="S5.T2.9.9.19.10.5" class="ltx_td ltx_align_center ltx_border_t">49.2</td>
<td id="S5.T2.9.9.19.10.6" class="ltx_td ltx_align_center ltx_border_t">43.8</td>
<td id="S5.T2.9.9.19.10.7" class="ltx_td ltx_align_center ltx_border_t">32.9</td>
<td id="S5.T2.9.9.19.10.8" class="ltx_td ltx_align_center ltx_border_t">36.4</td>
<td id="S5.T2.9.9.19.10.9" class="ltx_td ltx_align_center ltx_border_t">30.3</td>
<td id="S5.T2.9.9.19.10.10" class="ltx_td ltx_align_center ltx_border_t">34.6</td>
<td id="S5.T2.9.9.19.10.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">36.4</td>
<td id="S5.T2.9.9.19.10.12" class="ltx_td ltx_align_center ltx_border_t">37.4</td>
</tr>
<tr id="S5.T2.9.9.20.11" class="ltx_tr">
<td id="S5.T2.9.9.20.11.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">CF <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite>
</td>
<td id="S5.T2.9.9.20.11.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">UN</td>
<td id="S5.T2.9.9.20.11.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">CVPR’20</td>
<td id="S5.T2.9.9.20.11.4" class="ltx_td ltx_align_center ltx_border_t">30.8</td>
<td id="S5.T2.9.9.20.11.5" class="ltx_td ltx_align_center ltx_border_t">52.1</td>
<td id="S5.T2.9.9.20.11.6" class="ltx_td ltx_align_center ltx_border_t">46.9</td>
<td id="S5.T2.9.9.20.11.7" class="ltx_td ltx_align_center ltx_border_t">34.0</td>
<td id="S5.T2.9.9.20.11.8" class="ltx_td ltx_align_center ltx_border_t">29.9</td>
<td id="S5.T2.9.9.20.11.9" class="ltx_td ltx_align_center ltx_border_t">34.7</td>
<td id="S5.T2.9.9.20.11.10" class="ltx_td ltx_align_center ltx_border_t">37.4</td>
<td id="S5.T2.9.9.20.11.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">43.2</td>
<td id="S5.T2.9.9.20.11.12" class="ltx_td ltx_align_center ltx_border_t">38.6</td>
</tr>
<tr id="S5.T2.9.9.21.12" class="ltx_tr">
<td id="S5.T2.9.9.21.12.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">iFAN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite>
</td>
<td id="S5.T2.9.9.21.12.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">UN</td>
<td id="S5.T2.9.9.21.12.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">AAAI’20</td>
<td id="S5.T2.9.9.21.12.4" class="ltx_td ltx_align_center ltx_border_t">27.9</td>
<td id="S5.T2.9.9.21.12.5" class="ltx_td ltx_align_center ltx_border_t">48.5</td>
<td id="S5.T2.9.9.21.12.6" class="ltx_td ltx_align_center ltx_border_t">40.0</td>
<td id="S5.T2.9.9.21.12.7" class="ltx_td ltx_align_center ltx_border_t">32.6</td>
<td id="S5.T2.9.9.21.12.8" class="ltx_td ltx_align_center ltx_border_t">31.7</td>
<td id="S5.T2.9.9.21.12.9" class="ltx_td ltx_align_center ltx_border_t">22.8</td>
<td id="S5.T2.9.9.21.12.10" class="ltx_td ltx_align_center ltx_border_t">33.0</td>
<td id="S5.T2.9.9.21.12.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">45.5</td>
<td id="S5.T2.9.9.21.12.12" class="ltx_td ltx_align_center ltx_border_t">35.3</td>
</tr>
<tr id="S5.T2.9.9.22.13" class="ltx_tr">
<td id="S5.T2.9.9.22.13.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">SFOD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>
</td>
<td id="S5.T2.9.9.22.13.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">ALL</td>
<td id="S5.T2.9.9.22.13.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">AAAI’21</td>
<td id="S5.T2.9.9.22.13.4" class="ltx_td ltx_align_center ltx_border_t">25.5</td>
<td id="S5.T2.9.9.22.13.5" class="ltx_td ltx_align_center ltx_border_t">44.5</td>
<td id="S5.T2.9.9.22.13.6" class="ltx_td ltx_align_center ltx_border_t">40.7</td>
<td id="S5.T2.9.9.22.13.7" class="ltx_td ltx_align_center ltx_border_t">33.2</td>
<td id="S5.T2.9.9.22.13.8" class="ltx_td ltx_align_center ltx_border_t">22.2</td>
<td id="S5.T2.9.9.22.13.9" class="ltx_td ltx_align_center ltx_border_t">28.4</td>
<td id="S5.T2.9.9.22.13.10" class="ltx_td ltx_align_center ltx_border_t">34.1</td>
<td id="S5.T2.9.9.22.13.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">39.0</td>
<td id="S5.T2.9.9.22.13.12" class="ltx_td ltx_align_center ltx_border_t">33.5</td>
</tr>
<tr id="S5.T2.9.9.23.14" class="ltx_tr">
<td id="S5.T2.9.9.23.14.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">MeGA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite>
</td>
<td id="S5.T2.9.9.23.14.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">UN</td>
<td id="S5.T2.9.9.23.14.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">CVPR’21</td>
<td id="S5.T2.9.9.23.14.4" class="ltx_td ltx_align_center ltx_border_t">25.4</td>
<td id="S5.T2.9.9.23.14.5" class="ltx_td ltx_align_center ltx_border_t">52.4</td>
<td id="S5.T2.9.9.23.14.6" class="ltx_td ltx_align_center ltx_border_t">49.0</td>
<td id="S5.T2.9.9.23.14.7" class="ltx_td ltx_align_center ltx_border_t">37.7</td>
<td id="S5.T2.9.9.23.14.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.9.9.23.14.8.1" class="ltx_text ltx_font_bold">46.9</span></td>
<td id="S5.T2.9.9.23.14.9" class="ltx_td ltx_align_center ltx_border_t">34.5</td>
<td id="S5.T2.9.9.23.14.10" class="ltx_td ltx_align_center ltx_border_t">39.0</td>
<td id="S5.T2.9.9.23.14.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">49.2</td>
<td id="S5.T2.9.9.23.14.12" class="ltx_td ltx_align_center ltx_border_t">41.8</td>
</tr>
<tr id="S5.T2.9.9.24.15" class="ltx_tr">
<td id="S5.T2.9.9.24.15.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">UMT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>
</td>
<td id="S5.T2.9.9.24.15.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.02</td>
<td id="S5.T2.9.9.24.15.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">CVPR’21</td>
<td id="S5.T2.9.9.24.15.4" class="ltx_td ltx_align_center ltx_border_t">34.1</td>
<td id="S5.T2.9.9.24.15.5" class="ltx_td ltx_align_center ltx_border_t">48.6</td>
<td id="S5.T2.9.9.24.15.6" class="ltx_td ltx_align_center ltx_border_t">46.7</td>
<td id="S5.T2.9.9.24.15.7" class="ltx_td ltx_align_center ltx_border_t">33.0</td>
<td id="S5.T2.9.9.24.15.8" class="ltx_td ltx_align_center ltx_border_t">46.8</td>
<td id="S5.T2.9.9.24.15.9" class="ltx_td ltx_align_center ltx_border_t">30.4</td>
<td id="S5.T2.9.9.24.15.10" class="ltx_td ltx_align_center ltx_border_t">37.3</td>
<td id="S5.T2.9.9.24.15.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">56.5</td>
<td id="S5.T2.9.9.24.15.12" class="ltx_td ltx_align_center ltx_border_t">41.7</td>
</tr>
<tr id="S5.T2.9.9.25.16" class="ltx_tr">
<td id="S5.T2.9.9.25.16.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">PT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>
</td>
<td id="S5.T2.9.9.25.16.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">ALL</td>
<td id="S5.T2.9.9.25.16.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">ICML’22</td>
<td id="S5.T2.9.9.25.16.4" class="ltx_td ltx_align_center ltx_border_t">33.4</td>
<td id="S5.T2.9.9.25.16.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.9.9.25.16.5.1" class="ltx_text ltx_font_bold">63.4</span></td>
<td id="S5.T2.9.9.25.16.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.9.9.25.16.6.1" class="ltx_text ltx_font_bold">52.4</span></td>
<td id="S5.T2.9.9.25.16.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.9.9.25.16.7.1" class="ltx_text ltx_font_bold">43.2</span></td>
<td id="S5.T2.9.9.25.16.8" class="ltx_td ltx_align_center ltx_border_t">37.8</td>
<td id="S5.T2.9.9.25.16.9" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.9.9.25.16.9.1" class="ltx_text ltx_font_bold">41.3</span></td>
<td id="S5.T2.9.9.25.16.10" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.9.9.25.16.10.1" class="ltx_text ltx_font_bold">48.7</span></td>
<td id="S5.T2.9.9.25.16.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">56.6</td>
<td id="S5.T2.9.9.25.16.12" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.9.9.25.16.12.1" class="ltx_text ltx_font_bold">47.1</span></td>
</tr>
<tr id="S5.T2.9.9.26.17" class="ltx_tr">
<td id="S5.T2.9.9.26.17.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">LabelMatch <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>
</td>
<td id="S5.T2.9.9.26.17.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">ALL</td>
<td id="S5.T2.9.9.26.17.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">-</td>
<td id="S5.T2.9.9.26.17.4" class="ltx_td ltx_align_center ltx_border_t">33.4</td>
<td id="S5.T2.9.9.26.17.5" class="ltx_td ltx_align_center ltx_border_t">61.3</td>
<td id="S5.T2.9.9.26.17.6" class="ltx_td ltx_align_center ltx_border_t">49.8</td>
<td id="S5.T2.9.9.26.17.7" class="ltx_td ltx_align_center ltx_border_t">38.7</td>
<td id="S5.T2.9.9.26.17.8" class="ltx_td ltx_align_center ltx_border_t">27.4</td>
<td id="S5.T2.9.9.26.17.9" class="ltx_td ltx_align_center ltx_border_t">32.7</td>
<td id="S5.T2.9.9.26.17.10" class="ltx_td ltx_align_center ltx_border_t">44.5</td>
<td id="S5.T2.9.9.26.17.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">55.8</td>
<td id="S5.T2.9.9.26.17.12" class="ltx_td ltx_align_center ltx_border_t">43.0</td>
</tr>
<tr id="S5.T2.9.9.9" class="ltx_tr">
<td id="S5.T2.9.9.9.10" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Ours</td>
<td id="S5.T2.9.9.9.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">ALL</td>
<td id="S5.T2.9.9.9.12" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">-</td>
<td id="S5.T2.1.1.1.1" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.1.1.1.1.1" class="ltx_text ltx_font_bold">36.3<math id="S5.T2.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.1.1.1.1.1.m1.1a"><mo id="S5.T2.1.1.1.1.1.m1.1.1" xref="S5.T2.1.1.1.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.1.1.1.1.1.m1.1b"><csymbol cd="latexml" id="S5.T2.1.1.1.1.1.m1.1.1.cmml" xref="S5.T2.1.1.1.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.1.1.1.1.1.m1.1c">\pm</annotation></semantics></math>3.8</span></td>
<td id="S5.T2.2.2.2.2" class="ltx_td ltx_align_center ltx_border_t">61.2<math id="S5.T2.2.2.2.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.2.2.2.2.m1.1a"><mo id="S5.T2.2.2.2.2.m1.1.1" xref="S5.T2.2.2.2.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.2.2.2.2.m1.1b"><csymbol cd="latexml" id="S5.T2.2.2.2.2.m1.1.1.cmml" xref="S5.T2.2.2.2.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.2.2.2.2.m1.1c">\pm</annotation></semantics></math>0.7</td>
<td id="S5.T2.3.3.3.3" class="ltx_td ltx_align_center ltx_border_t">49.2<math id="S5.T2.3.3.3.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.3.3.3.3.m1.1a"><mo id="S5.T2.3.3.3.3.m1.1.1" xref="S5.T2.3.3.3.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.3.3.3.3.m1.1b"><csymbol cd="latexml" id="S5.T2.3.3.3.3.m1.1.1.cmml" xref="S5.T2.3.3.3.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.3.3.3.3.m1.1c">\pm</annotation></semantics></math>2.3</td>
<td id="S5.T2.4.4.4.4" class="ltx_td ltx_align_center ltx_border_t">41.9<math id="S5.T2.4.4.4.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.4.4.4.4.m1.1a"><mo id="S5.T2.4.4.4.4.m1.1.1" xref="S5.T2.4.4.4.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.4.4.4.4.m1.1b"><csymbol cd="latexml" id="S5.T2.4.4.4.4.m1.1.1.cmml" xref="S5.T2.4.4.4.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.4.4.4.4.m1.1c">\pm</annotation></semantics></math>0.9</td>
<td id="S5.T2.5.5.5.5" class="ltx_td ltx_align_center ltx_border_t">44.2<math id="S5.T2.5.5.5.5.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.5.5.5.5.m1.1a"><mo id="S5.T2.5.5.5.5.m1.1.1" xref="S5.T2.5.5.5.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.5.5.5.5.m1.1b"><csymbol cd="latexml" id="S5.T2.5.5.5.5.m1.1.1.cmml" xref="S5.T2.5.5.5.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.5.5.5.5.m1.1c">\pm</annotation></semantics></math>5.9</td>
<td id="S5.T2.6.6.6.6" class="ltx_td ltx_align_center ltx_border_t">37.3<math id="S5.T2.6.6.6.6.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.6.6.6.6.m1.1a"><mo id="S5.T2.6.6.6.6.m1.1.1" xref="S5.T2.6.6.6.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.6.6.6.6.m1.1b"><csymbol cd="latexml" id="S5.T2.6.6.6.6.m1.1.1.cmml" xref="S5.T2.6.6.6.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.6.6.6.6.m1.1c">\pm</annotation></semantics></math>2.1</td>
<td id="S5.T2.7.7.7.7" class="ltx_td ltx_align_center ltx_border_t">47.7<math id="S5.T2.7.7.7.7.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.7.7.7.7.m1.1a"><mo id="S5.T2.7.7.7.7.m1.1.1" xref="S5.T2.7.7.7.7.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.7.7.7.7.m1.1b"><csymbol cd="latexml" id="S5.T2.7.7.7.7.m1.1.1.cmml" xref="S5.T2.7.7.7.7.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.7.7.7.7.m1.1c">\pm</annotation></semantics></math>0.5</td>
<td id="S5.T2.8.8.8.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T2.8.8.8.8.1" class="ltx_text ltx_font_bold">59.2<math id="S5.T2.8.8.8.8.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.8.8.8.8.1.m1.1a"><mo id="S5.T2.8.8.8.8.1.m1.1.1" xref="S5.T2.8.8.8.8.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.8.8.8.8.1.m1.1b"><csymbol cd="latexml" id="S5.T2.8.8.8.8.1.m1.1.1.cmml" xref="S5.T2.8.8.8.8.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.8.8.8.8.1.m1.1c">\pm</annotation></semantics></math>0.2</span></td>
<td id="S5.T2.9.9.9.9" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.9.9.9.9.1" class="ltx_text ltx_font_bold">47.1<math id="S5.T2.9.9.9.9.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.9.9.9.9.1.m1.1a"><mo id="S5.T2.9.9.9.9.1.m1.1.1" xref="S5.T2.9.9.9.9.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.9.9.9.9.1.m1.1b"><csymbol cd="latexml" id="S5.T2.9.9.9.9.1.m1.1.1.cmml" xref="S5.T2.9.9.9.9.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.9.9.9.9.1.m1.1c">\pm</annotation></semantics></math>1.3</span></td>
</tr>
<tr id="S5.T2.9.9.27.18" class="ltx_tr">
<td id="S5.T2.9.9.27.18.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t">Target only <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>
</td>
<td id="S5.T2.9.9.27.18.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">ALL</td>
<td id="S5.T2.9.9.27.18.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">-</td>
<td id="S5.T2.9.9.27.18.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">32.6</td>
<td id="S5.T2.9.9.27.18.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">61.6</td>
<td id="S5.T2.9.9.27.18.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">49.1</td>
<td id="S5.T2.9.9.27.18.7" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">41.2</td>
<td id="S5.T2.9.9.27.18.8" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">49.0</td>
<td id="S5.T2.9.9.27.18.9" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">37.9</td>
<td id="S5.T2.9.9.27.18.10" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">42.4</td>
<td id="S5.T2.9.9.27.18.11" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">56.6</td>
<td id="S5.T2.9.9.27.18.12" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">46.3</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S5.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE III: </span>Final validation performance on the C2B scenario when using alternative class ratios as the prior and different approaches to setting the number of pseudo-labels per image.</figcaption>
<table id="S5.T3.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T3.1.1.1" class="ltx_tr">
<th id="S5.T3.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt">Obj. per Img.</th>
<th id="S5.T3.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt">Class Ratio</th>
<th id="S5.T3.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">mAP</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T3.1.2.1" class="ltx_tr">
<th id="S5.T3.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Labelled Data</th>
<td id="S5.T3.1.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Labelled Data</td>
<td id="S5.T3.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">30.3</td>
</tr>
<tr id="S5.T3.1.3.2" class="ltx_tr">
<th id="S5.T3.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Dynamic (Ours)</th>
<td id="S5.T3.1.3.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Labelled Data</td>
<td id="S5.T3.1.3.2.3" class="ltx_td ltx_align_center ltx_border_t">35.4</td>
</tr>
<tr id="S5.T3.1.4.3" class="ltx_tr">
<th id="S5.T3.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Dynamic (Ours)</th>
<td id="S5.T3.1.4.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Predicted (Ours)</td>
<td id="S5.T3.1.4.3.3" class="ltx_td ltx_align_center ltx_border_t">39.2</td>
</tr>
<tr id="S5.T3.1.5.4" class="ltx_tr">
<th id="S5.T3.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t">Dynamic (Ours)</th>
<td id="S5.T3.1.5.4.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">Unlabelled Data</td>
<td id="S5.T3.1.5.4.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">40.2</td>
</tr>
</tbody>
</table>
</figure>
<figure id="S5.T4" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE IV: </span>Sensitivity of our approach on the C2B scenario to different settings of the target mean confidence threshold <math id="S5.T4.2.m1.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S5.T4.2.m1.1b"><mi id="S5.T4.2.m1.1.1" xref="S5.T4.2.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S5.T4.2.m1.1c"><ci id="S5.T4.2.m1.1.1.cmml" xref="S5.T4.2.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.2.m1.1d">\tau</annotation></semantics></math>.</figcaption>
<table id="S5.T4.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T4.3.1" class="ltx_tr">
<th id="S5.T4.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt"><math id="S5.T4.3.1.1.m1.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S5.T4.3.1.1.m1.1a"><mi id="S5.T4.3.1.1.m1.1.1" xref="S5.T4.3.1.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S5.T4.3.1.1.m1.1b"><ci id="S5.T4.3.1.1.m1.1.1.cmml" xref="S5.T4.3.1.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.3.1.1.m1.1c">\tau</annotation></semantics></math></th>
<th id="S5.T4.3.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt">0.4</th>
<th id="S5.T4.3.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt">0.5</th>
<th id="S5.T4.3.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt">0.6</th>
<th id="S5.T4.3.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt">0.7</th>
<th id="S5.T4.3.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">0.8</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T4.3.2.1" class="ltx_tr">
<th id="S5.T4.3.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t">mAP</th>
<td id="S5.T4.3.2.1.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">29.9</td>
<td id="S5.T4.3.2.1.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">36.1</td>
<td id="S5.T4.3.2.1.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">39.2</td>
<td id="S5.T4.3.2.1.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">40.5</td>
<td id="S5.T4.3.2.1.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">23.3</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS3.5.1.1" class="ltx_text">V-C</span> </span><span id="S5.SS3.6.2" class="ltx_text ltx_font_italic">Impact on Pseudo-label Reliability</span>
</h3>

<div id="S5.SS3.p1" class="ltx_para">
<p id="S5.SS3.p1.1" class="ltx_p">To further explore the proposed approach, we assess the pseudo-label reliability generated using alternative threshold selection techniques on the C2B scenario. To do so, we take the teacher model after 1000 iterations of self-training and calculate the F1 score of the generated pseudo-labels when different class ratios and number of objects per image are used (Figure <a href="#S5.F3" title="Figure 3 ‣ V-D Class Distribution Prediction ‣ V Experiments ‣ Predicting Class Distribution Shift for Reliable Domain Adaptive Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>a). This plot firstly highlights the benefit of using an accurate class distribution prediction to inform pseudo-label selection. When the predicted class ratio is used, there is a clear shift to higher F1 scores relative to using the naive prior provided by the labelled data. We further see that targeting a mean confidence score of 0.6 results in an F1 score that is close to the peak. Consequently, the proposed approach results in an improvement in the F1 score of 0.06 relative to the original ACT. We also plot how the selected number of objects per image evolves through training for the C2B and C2N scenarios, highlighting how the proposed method responds to the variable reliability of the teacher model (Figure <a href="#S5.F3" title="Figure 3 ‣ V-D Class Distribution Prediction ‣ V Experiments ‣ Predicting Class Distribution Shift for Reliable Domain Adaptive Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>b-c). As the pseudo-label accuracy improves with training, the number of objects per image is dynamically increased. We also see that for the more challenging C2N scenario, the number of pseudo-labels per image is lower to account for the poorer performance of the teacher in the target domain.</p>
</div>
</section>
<section id="S5.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS4.5.1.1" class="ltx_text">V-D</span> </span><span id="S5.SS4.6.2" class="ltx_text ltx_font_italic">Class Distribution Prediction</span>
</h3>

<div id="S5.SS4.p1" class="ltx_para">
<p id="S5.SS4.p1.1" class="ltx_p">We further investigate the accuracy of the proposed class ratio prediction method to assess if it is robust to different forms of domain shift. To do so, we utilise the four driving datasets used to assess UDA-OD performance; Cityscapes <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>, foggy Cityscapes <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>, BDD100k daytime and BDD100k night <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>. The permutation of these datasets into labelled and unlabelled pairs leads to 12 scenarios for predicting class distribution shift (Figure <a href="#S5.F5" title="Figure 5 ‣ V-D Class Distribution Prediction ‣ V Experiments ‣ Predicting Class Distribution Shift for Reliable Domain Adaptive Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>). Additionally, we use the Wanderlust dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> to assess realistic class distribution shift encountered across time by an egocentric agent. This dataset contains object annotations of an egocentric videostream collected by a graduate student over nine months of their life. The seven most common classes of bicycle, bus, car, chair, dining table, person and potted plant are considered. Temporally coherent splits of the training data are created by splitting it at the 2.5%, 5%, 10%, 25%. 50%, 75% and 90% mark of the datastream. We use the labels for all data before the split, resulting in 7 scenarios for assessing class distribution prediction (Figure <a href="#S5.F4" title="Figure 4 ‣ V-D Class Distribution Prediction ‣ V Experiments ‣ Predicting Class Distribution Shift for Reliable Domain Adaptive Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>).</p>
</div>
<div id="S5.SS4.p2" class="ltx_para">
<p id="S5.SS4.p2.1" class="ltx_p">For each scenario, we report the Kullback-Leibler (KL) divergence between the labelled class ratio, our merged and squared predictions, and the true class ratio. Generally, the squared prediction is much more accurate than using the labelled data alone, reducing KL divergence by 3-4 fold. On the driving scenarios, our method is robust to large and small class distribution shifts and significant appearance changes due to foggy weather and night driving (Figure <a href="#S5.F5" title="Figure 5 ‣ V-D Class Distribution Prediction ‣ V Experiments ‣ Predicting Class Distribution Shift for Reliable Domain Adaptive Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>). This emphasises that the representation of semantic context used to predict the class ratio is sufficiently resistant to domain shift. On the Wanderlust scenarios, our prediction remains accurate across a variable labelling budget (Figure <a href="#S5.F4" title="Figure 4 ‣ V-D Class Distribution Prediction ‣ V Experiments ‣ Predicting Class Distribution Shift for Reliable Domain Adaptive Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>).</p>
</div>
<div id="S5.SS4.p3" class="ltx_para">
<p id="S5.SS4.p3.1" class="ltx_p">We also investigate the regression models to ascertain why the squared prediction is consistently more accurate than the merged prediction (Figure <a href="#S5.F5" title="Figure 5 ‣ V-D Class Distribution Prediction ‣ V Experiments ‣ Predicting Class Distribution Shift for Reliable Domain Adaptive Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, <a href="#S5.F4" title="Figure 4 ‣ V-D Class Distribution Prediction ‣ V Experiments ‣ Predicting Class Distribution Shift for Reliable Domain Adaptive Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>). We find that the intercept coefficients of these models vary significantly across datasets. This implies that the class ratio is influenced by exogenous factors not captured by the CLIP similarity scores. As a result, a model fit to the labelled data will consistently be in error when making predictions on the shifted, unlabelled data. However, this intercept error is strongly correlated with the class distribution shift between the datasets (<math id="S5.SS4.p3.1.m1.1" class="ltx_Math" alttext="r=0.98" display="inline"><semantics id="S5.SS4.p3.1.m1.1a"><mrow id="S5.SS4.p3.1.m1.1.1" xref="S5.SS4.p3.1.m1.1.1.cmml"><mi id="S5.SS4.p3.1.m1.1.1.2" xref="S5.SS4.p3.1.m1.1.1.2.cmml">r</mi><mo id="S5.SS4.p3.1.m1.1.1.1" xref="S5.SS4.p3.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS4.p3.1.m1.1.1.3" xref="S5.SS4.p3.1.m1.1.1.3.cmml">0.98</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p3.1.m1.1b"><apply id="S5.SS4.p3.1.m1.1.1.cmml" xref="S5.SS4.p3.1.m1.1.1"><eq id="S5.SS4.p3.1.m1.1.1.1.cmml" xref="S5.SS4.p3.1.m1.1.1.1"></eq><ci id="S5.SS4.p3.1.m1.1.1.2.cmml" xref="S5.SS4.p3.1.m1.1.1.2">𝑟</ci><cn type="float" id="S5.SS4.p3.1.m1.1.1.3.cmml" xref="S5.SS4.p3.1.m1.1.1.3">0.98</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p3.1.m1.1c">r=0.98</annotation></semantics></math> for the driving scenarios in Figure <a href="#S5.F5" title="Figure 5 ‣ V-D Class Distribution Prediction ‣ V Experiments ‣ Predicting Class Distribution Shift for Reliable Domain Adaptive Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>). Thus, by predicting the relative change in class ratio between datasets, we are indirectly estimating the intercept error. Scaling up the predicted change in class ratio therefore improves accuracy by incorporating this prediction of the intercept error into our method. In future, prompt learning techniques <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> could be investigated to make the CLIP similarity scores more expressive of the class ratio, avoiding the need to heuristically account for the intercept error.</p>
</div>
<figure id="S5.F3" class="ltx_figure"><img src="/html/2302.06039/assets/Figures/pseudo-label-combined-new.png" id="S5.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="1190" height="105" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>a) The F1 score of pseudo-labels generated by the teacher model after 1000 iterations of self-training using different class distribution priors. The solid lines highlight how F1 score varies with respect to mean pseudo-label confidence when using different class ratios as prior. The dotted lines show the mean confidence score selected using each method. The pseudo-labels generated by our method (purple) have an F1 score of 0.3, while those generated using ACT (green) return 0.24. b) Evolution of the number of pseudo-labels per image while training the proposed method on the C2N and C2B scenarios. The dotted lines show the true number of objects per image in the target dataset for each scenario. c) Evolution of the number of pseudo-labels per image while training on the C2B scenario with different settings of the mean pseudo-label confidence <math id="S5.F3.2.m1.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S5.F3.2.m1.1b"><mi id="S5.F3.2.m1.1.1" xref="S5.F3.2.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S5.F3.2.m1.1c"><ci id="S5.F3.2.m1.1.1.cmml" xref="S5.F3.2.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F3.2.m1.1d">\tau</annotation></semantics></math>. The black dotted line shows the true number of objects per image.</figcaption>
</figure>
<figure id="S5.F4" class="ltx_figure"><img src="/html/2302.06039/assets/Figures/oak_class_pred.png" id="S5.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="592" height="126" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>KL divergence of alternative class ratio prediction methods for different temporal splits of the Wanderlust dataset. Each subplot shows an adaptation scenario, defined by the proportion of the data considered labelled. See Figure 4 for a description of the methods assessed.</figcaption>
</figure>
<figure id="S5.F5" class="ltx_figure"><img src="/html/2302.06039/assets/Figures/driving_class_pred.png" id="S5.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="592" height="175" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>KL divergence of alternative class ratio prediction methods from the true distribution on different combinations of the driving datasets. The title of each subplot shows the adaptation scenario. The blue bar represents the KL divergence between the labelled and unlabelled class ratio, with a larger value corresponding to scenarios with greater class distribution shift. The red and green bars show the KL-divergence between the unlabelled class ratio and the proposed merged and squared predictions respectively. Smaller values correspond to a more accurate prediction of the class ratio.</figcaption>
</figure>
</section>
<section id="S5.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS5.5.1.1" class="ltx_text">V-E</span> </span><span id="S5.SS5.6.2" class="ltx_text ltx_font_italic">Ablations</span>
</h3>

<div id="S5.SS5.p1" class="ltx_para">
<p id="S5.SS5.p1.1" class="ltx_p">Using the C2B scenario, we study the independent effect of using a more accurate class ratio and the dynamic adjustment of the number of objects per image. We first introduce the dynamic adjustment of the number of pseudo-labels per image, but continue using the labelled class distribution prior. The resulting 5.1 mAP improvement relative to the original ACT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> can therefore be accredited to using the mean confidence of the teacher to select the number of pseudo-labels per image (Table <a href="#S5.T3" title="TABLE III ‣ V-B Performance Comparison ‣ V Experiments ‣ Predicting Class Distribution Shift for Reliable Domain Adaptive Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a>). When the predicted prior is introduced instead of the labelled class ratio, a further improvement of 3.8 mAP results. Lastly, we test the performance of our method if the true class ratio of the unlabelled data was used as the prior, finding that it leads to only a minor increase in performance, from 39.2 to 40.2 mAP (Table <a href="#S5.T3" title="TABLE III ‣ V-B Performance Comparison ‣ V Experiments ‣ Predicting Class Distribution Shift for Reliable Domain Adaptive Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a>).</p>
</div>
<div id="S5.SS5.p2" class="ltx_para">
<p id="S5.SS5.p2.2" class="ltx_p">We also study the sensitivity of our approach under different settings of the target mean pseudo-label confidence <math id="S5.SS5.p2.1.m1.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S5.SS5.p2.1.m1.1a"><mi id="S5.SS5.p2.1.m1.1.1" xref="S5.SS5.p2.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.1.m1.1b"><ci id="S5.SS5.p2.1.m1.1.1.cmml" xref="S5.SS5.p2.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.1.m1.1c">\tau</annotation></semantics></math>. For values between 0.5 and 0.7, our approach maintains performance superior to the strongest baseline (Table <a href="#S5.T4" title="TABLE IV ‣ V-B Performance Comparison ‣ V Experiments ‣ Predicting Class Distribution Shift for Reliable Domain Adaptive Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">IV</span></a>). These values perform optimally as they lead the number of pseudo-labels per image to converge to the true number of objects per image in the target dataset (Figure <a href="#S5.F3" title="Figure 3 ‣ V-D Class Distribution Prediction ‣ V Experiments ‣ Predicting Class Distribution Shift for Reliable Domain Adaptive Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>b-c). We therefore recommend setting <math id="S5.SS5.p2.2.m2.1" class="ltx_Math" alttext="\tau=0.6" display="inline"><semantics id="S5.SS5.p2.2.m2.1a"><mrow id="S5.SS5.p2.2.m2.1.1" xref="S5.SS5.p2.2.m2.1.1.cmml"><mi id="S5.SS5.p2.2.m2.1.1.2" xref="S5.SS5.p2.2.m2.1.1.2.cmml">τ</mi><mo id="S5.SS5.p2.2.m2.1.1.1" xref="S5.SS5.p2.2.m2.1.1.1.cmml">=</mo><mn id="S5.SS5.p2.2.m2.1.1.3" xref="S5.SS5.p2.2.m2.1.1.3.cmml">0.6</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.2.m2.1b"><apply id="S5.SS5.p2.2.m2.1.1.cmml" xref="S5.SS5.p2.2.m2.1.1"><eq id="S5.SS5.p2.2.m2.1.1.1.cmml" xref="S5.SS5.p2.2.m2.1.1.1"></eq><ci id="S5.SS5.p2.2.m2.1.1.2.cmml" xref="S5.SS5.p2.2.m2.1.1.2">𝜏</ci><cn type="float" id="S5.SS5.p2.2.m2.1.1.3.cmml" xref="S5.SS5.p2.2.m2.1.1.3">0.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.2.m2.1c">\tau=0.6</annotation></semantics></math> as a starting point on novel scenarios, before confirming that the number of pseudo-labels per image is converging to an appropriate value. In future work, merging class distribution information with probabilistic self-training approaches <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> may reduce sensitivity to key parameters.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">VI </span><span id="S6.1.1" class="ltx_text ltx_font_smallcaps">Conclusion</span>
</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">In this work, we propose a framework for explicitly considering class distribution shift to improve the reliability of pseudo-labels in self-training. The resulting method improves upon existing baselines on a range of UDA-OD scenarios, showing strong performance when facing realistic contextual and class distribution shifts. The results motivate further research into how a robot’s deployment environment can be modelled to improve pseudo-label reliability in Mean Teacher. Furthermore, we show that class distribution shift must be considered when implementing UDA-OD methods for robotics applications. Lastly, the weak supervision provided by the class distribution prior may benefit other tasks crucial to reliable robotic deployment, such as run-time monitoring or out-of-distribution detection.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Y. Chen, W. Li, C. Sakaridis, D. Dai, and L. Van Gool, “Domain adaptive faster
r-cnn for object detection in the wild,” in <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE
conference on computer vision and pattern recognition</em>.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
G. Graffieti, G. Borghi, and D. Maltoni, “Continual learning in real-life
applications,” <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">IEEE Robotics and Automation Letters</em>, vol. 7, no. 3,
pp. 6195–6202, 2022.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
B. Liu, “Learning on the job: Online lifelong and continual learning,” in
<em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI Conference on Artificial Intelligence</em>,
vol. 34, no. 09, 2020, pp. 13 544–13 549.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
M. Chen, W. Chen, S. Yang, J. Song, X. Wang, L. Zhang, Y. Yan, D. Qi,
Y. Zhuang, D. Xie <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “Learning domain adaptive object detection
with probabilistic teacher,” in <em id="bib.bib4.2.2" class="ltx_emph ltx_font_italic">International Conference on Machine
Learning</em>.   PMLR, 2022, pp. 3040–3055.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
J. Deng, W. Li, Y. Chen, and L. Duan, “Unbiased mean teacher for cross-domain
object detection,” in <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on
Computer Vision and Pattern Recognition</em>, 2021, pp. 4091–4101.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
A. Tarvainen and H. Valpola, “Mean teachers are better role models:
Weight-averaged consistency targets improve semi-supervised deep learning
results,” <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, vol. 30,
2017.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
K. Sohn, Z. Zhang, C.-L. Li, H. Zhang, C.-Y. Lee, and T. Pfister, “A simple
semi-supervised learning framework for object detection,” <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">arXiv
preprint arXiv:2005.04757</em>, 2020.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Y.-C. Liu, C.-Y. Ma, Z. He, C.-W. Kuo, K. Chen, P. Zhang, B. Wu, Z. Kira, and
P. Vajda, “Unbiased teacher for semi-supervised object detection,”
<em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2102.09480</em>, 2021.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
R. Ramamonjison, A. Banitalebi-Dehkordi, X. Kang, X. Bai, and Y. Zhang,
“Simrod: A simple adaptation method for robust object detection,” in
<em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF International Conference on Computer
Vision</em>, 2021, pp. 3570–3579.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Q. Cai, Y. Pan, C.-W. Ngo, X. Tian, L. Duan, and T. Yao, “Exploring object
relation in mean teacher for cross-domain detection,” in <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Proceedings
of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, 2019,
pp. 11 457–11 466.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
X. Li, W. Chen, D. Xie, S. Yang, P. Yuan, S. Pu, and Y. Zhuang, “A free lunch
for unsupervised domain adaptive object detection without source data,” in
<em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI Conference on Artificial Intelligence</em>,
vol. 35, no. 10, 2021, pp. 8474–8481.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
A. Radford, J. W. Kim, C. Hallacy, A. Ramesh, G. Goh, S. Agarwal, G. Sastry,
A. Askell, P. Mishkin, J. Clark <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “Learning transferable visual
models from natural language supervision,” in <em id="bib.bib12.2.2" class="ltx_emph ltx_font_italic">International Conference
on Machine Learning</em>.   PMLR, 2021, pp.
8748–8763.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
B. Chen, W. Chen, S. Yang, Y. Xuan, J. Song, D. Xie, S. Pu, M. Song, and
Y. Zhuang, “Label matching semi-supervised object detection,” in
<em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern
Recognition</em>, 2022, pp. 14 381–14 390.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
H. Li, Z. Wu, A. Shrivastava, and L. S. Davis, “Rethinking pseudo labels for
semi-supervised object detection,” in <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI
Conference on Artificial Intelligence</em>, vol. 36, no. 2.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
C.-D. Xu, X.-R. Zhao, X. Jin, and X.-S. Wei, “Exploring categorical
regularization for domain adaptive object detection,” in <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Proceedings
of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, 2020,
pp. 11 724–11 733.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
H. Elsahar and M. Gallé, “To annotate or not? predicting performance drop
under domain shift,” in <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2019 Conference on
Empirical Methods in Natural Language Processing</em>, 2019, pp. 2163–2173.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
J. Wang, X. Wang, Y. Shang-Guan, and A. Gupta, “Wanderlust: Online continual
object detection in the real world,” in <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF
International Conference on Computer Vision</em>, 2021.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
M. Cordts, M. Omran, S. Ramos, T. Rehfeld, M. Enzweiler, R. Benenson,
U. Franke, S. Roth, and B. Schiele, “The cityscapes dataset for semantic
urban scene understanding,” in <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE conference on
computer vision and pattern recognition</em>.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
C. Sakaridis, D. Dai, and L. Van Gool, “Semantic foggy scene understanding
with synthetic data,” <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">International Journal of Computer Vision</em>, vol.
126, no. 9, pp. 973–992, 2018.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
F. Yu, W. Xian, Y. Chen, F. Liu, M. Liao, V. Madhavan, and T. Darrell,
“Bdd100k: A diverse driving video database with scalable annotation
tooling,” <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1805.04687</em>, vol. 2, no. 5, p. 6, 2018.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
J. Lu, V. Goswami, M. Rohrbach, D. Parikh, and S. Lee, “12-in-1: Multi-task
vision and language representation learning,” in <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">Proceedings of the
IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, 2020, pp.
10 437–10 446.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
S. Min, N. Park, S. Kim, S. Park, and J. Kim, “Grounding visual
representations with texts for domain generalization,” in <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">European
Conference on Computer Vision</em>.   Springer, 2022, pp. 37–53.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Z. Zhou, B. Zhang, Y. Lei, L. Liu, and Y. Liu, “ZegCLIP: Towards Adapting
CLIP for Zero-shot Semantic Segmentation,” <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">arXiv</em>, 2022.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
B. Krojer, V. Adlakha, V. Vineet, Y. Goyal, E. Ponti, and S. Reddy, “Image
retrieval from contextual descriptions,” <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">arXiv preprint
arXiv:2203.15867</em>, 2022.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
K. Zhou, J. Yang, C. C. Loy, and Z. Liu, “Learning to prompt for
vision-language models,” <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">International Journal of Computer Vision</em>,
vol. 130, no. 9, pp. 2337–2348, 2022.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Y. Ruan, Y. Dubois, and C. J. Maddison, “Optimal representations for covariate
shift,” <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2201.00057</em>, 2021.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
T. Huang, J. Chu, and F. Wei, “Unsupervised prompt learning for
vision-language models,” <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2204.03649</em>, 2022.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
S. Ren, K. He, R. Girshick, and J. Sun, “Faster r-cnn: Towards real-time
object detection with region proposal networks,” in <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">Advances in Neural
Information Processing Systems</em>, vol. 28, 2015.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
K. Simonyan and A. Zisserman, “Very deep convolutional networks for
large-scale image recognition,” <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1409.1556</em>, 2014.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
A. Krizhevsky, I. Sutskever, and G. E. Hinton, “Imagenet classification with
deep convolutional neural networks,” <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">Communications of the ACM</em>,
vol. 60, no. 6, pp. 84–90, 2017.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
K. Chen, J. Wang, J. Pang, Y. Cao, Y. Xiong, X. Li, S. Sun, W. Feng, Z. Liu,
J. Xu <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “Mmdetection: Open mmlab detection toolbox and
benchmark,” <em id="bib.bib31.2.2" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1906.07155</em>, 2019.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
K. Saito, Y. Ushiku, T. Harada, and K. Saenko, “Strong-weak distribution
alignment for adaptive object detection,” in <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">Proceedings of the
IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, 2019, pp.
6956–6965.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
T. Kim, M. Jeong, S. Kim, S. Choi, and C. Kim, “Diversify and match: A domain
adaptive representation learning paradigm for object detection,” in
<em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern
Recognition (CVPR)</em>, June 2019.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
H.-K. Hsu, C.-H. Yao, Y.-H. Tsai, W.-C. Hung, H.-Y. Tseng, M. Singh, and M.-H.
Yang, “Progressive domain adaptation for object detection,” in
<em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF winter conference on applications of
computer vision</em>, 2020, pp. 749–757.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
M. Xu, H. Wang, B. Ni, Q. Tian, and W. Zhang, “Cross-domain detection via
graph-induced prototype alignment,” in <em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF
Conference on Computer Vision and Pattern Recognition</em>, 2020, pp.
12 355–12 364.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
Z. He and L. Zhang, “Domain adaptive object detection via asymmetric tri-way
faster-rcnn,” in <em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">European conference on computer vision</em>.   Springer, 2020, pp. 309–324.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
C. Chen, Z. Zheng, X. Ding, Y. Huang, and Q. Dou, “Harmonizing transferability
and discriminability for adapting object detectors,” in <em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">Proceedings of
the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, 2020,
pp. 8869–8878.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
Y. Zheng, D. Huang, S. Liu, and Y. Wang, “Cross-domain object detection
through coarse-to-fine feature adaptation,” in <em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">Proceedings of the
IEEE/CVF conference on computer vision and pattern recognition</em>, 2020, pp.
13 766–13 775.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
C. Zhuang, X. Han, W. Huang, and M. Scott, “ifan: Image-instance full
alignment networks for adaptive object detection,” in <em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">Proceedings of
the AAAI Conference on Artificial Intelligence</em>, vol. 34, no. 07, 2020.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
V. Vs, V. Gupta, P. Oza, V. A. Sindagi, and V. M. Patel, “Mega-cda: Memory
guided attention for category-aware unsupervised domain adaptive object
detection,” in <em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer
Vision and Pattern Recognition</em>, 2021, pp. 4516–4526.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2302.06038" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2302.06039" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2302.06039">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2302.06039" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2302.06040" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Mar  1 02:23:48 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
