<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2303.09674] DiGeo: Discriminative Geometry-Aware Learning for Generalized Few-Shot Object Detection</title><meta property="og:description" content="Generalized few-shot object detection aims to achieve precise detection on both base classes with abundant annotations and novel classes with limited training data. Existing approaches enhance few-shot generalization w…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="DiGeo: Discriminative Geometry-Aware Learning for Generalized Few-Shot Object Detection">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="DiGeo: Discriminative Geometry-Aware Learning for Generalized Few-Shot Object Detection">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2303.09674">

<!--Generated on Thu Feb 29 19:32:04 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">DiGeo: Discriminative Geometry-Aware Learning for
<br class="ltx_break">Generalized Few-Shot Object Detection</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jiawei Ma  Yulei Niu<sup id="id2.2.id1" class="ltx_sup"><span id="id2.2.id1.1" class="ltx_text ltx_font_italic">∗</span></sup>  Jincheng Xu  Shiyuan Huang  Guangxing Han  Shih-Fu Chang
<br class="ltx_break">Columbia University
<br class="ltx_break"><span id="id3.3.id2" class="ltx_text ltx_font_typewriter" style="font-size:90%;">{jiawei.m, yulei.niu, jx2467, shiyuan.h, gh2561, sc250}@columbia.edu</span>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id4.id1" class="ltx_p">Generalized few-shot object detection aims to achieve precise detection on both base classes with abundant annotations and novel classes with limited training data. Existing approaches enhance few-shot generalization with the sacrifice of base-class performance, or maintain high precision in base-class detection with limited improvement in novel-class adaptation. In this paper, we point out the reason is insufficient
<span id="id4.id1.1" class="ltx_text ltx_framed ltx_framed_underline">Di</span>scriminative feature learning for all of the classes. As such, we propose a new training framework, DiGeo, to learn <span id="id4.id1.2" class="ltx_text ltx_framed ltx_framed_underline">Geo</span>metry-aware features of inter-class separation and intra-class compactness. To guide the separation of feature clusters, we derive an offline simplex equiangular tight frame (ETF) classifier whose weights serve as class centers and are maximally and equally separated. To tighten the cluster for each class, we include adaptive class-specific margins into the classification loss and encourage the features close to the class centers. Experimental studies on two few-shot benchmark datasets (VOC, COCO) and one long-tail dataset (LVIS) demonstrate that, with a single model, our method can effectively improve generalization on novel classes without hurting the detection of base classes. Our code can be found <a target="_blank" href="https://github.com/Phoenix-V/DiGeo" title="" class="ltx_ref ltx_href">here</a>.</p>
</div>
<span id="footnotex1" class="ltx_note ltx_role_footnotetext"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">footnotetext: </span><sup id="footnotex1.1" class="ltx_sup"><span id="footnotex1.1.1" class="ltx_text ltx_font_italic">∗</span></sup>Corresponding Author.</span></span></span>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Recent years have witnessed the tremendous growth of object detection through deep neural models and large-scale training <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib42" title="" class="ltx_ref">42</a>, <a href="#bib.bib69" title="" class="ltx_ref">69</a>, <a href="#bib.bib63" title="" class="ltx_ref">63</a>, <a href="#bib.bib47" title="" class="ltx_ref">47</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>. However, the success of detection models heavily relies on the amount and quality of annotations, which requires expensive annotation cost and time. In addition, traditional object detection models perform worse on the classes with a limited number of annotations <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib55" title="" class="ltx_ref">55</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib59" title="" class="ltx_ref">59</a>]</cite>, while human are able to learn from few observations. In order to close the gap between human vision system and detection models, recent studies have investigated how to generalize well on rare classes under the few-shot object detection (FSOD) setting.
Specifically, given many-shot (<span id="S1.p1.1.1" class="ltx_text ltx_font_italic">base</span>) classes with plenty of training data and few-shot (<span id="S1.p1.1.2" class="ltx_text ltx_font_italic">novel</span>) classes with extremely limited training data (<em id="S1.p1.1.3" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S1.p1.1.4" class="ltx_text"></span>, 5 annotated instances per class), FSOD expects the model to detect the objects in the novel classes well.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2303.09674/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="438" height="220" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.4.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S1.F1.5.2" class="ltx_text" style="font-size:90%;">Performance on few-shot object detection on Pascal VOC <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>.
Previous transfer-learning approaches (<span id="S1.F1.5.2.1" class="ltx_text" style="color:#00FFFF;">blue</span>) balancing the training data by aggressively down-sampling the base set and may result in overfitting. Instead, we (<span id="S1.F1.5.2.2" class="ltx_text" style="color:#FF0000;">red</span>) use the full train set, aiming to both maintain precise base detection but learn discriminative features from the limited annotations for few-shot classes.
</span></figcaption>
</figure>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">To improve the generalization ability on novel-class detection, recent studies <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib46" title="" class="ltx_ref">46</a>, <a href="#bib.bib55" title="" class="ltx_ref">55</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> conduct transfer learning in a two-step manner. In detail, the model is pre-trained on the whole set of base classes, and then fine-tuned on the union of the set of novel classes and an aggressively down-sampled base subset.
However, the efficient few-shot adaptation is often achieved at the expense of sacrificing precision on base detection (Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ DiGeo: Discriminative Geometry-Aware Learning for Generalized Few-Shot Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>).
Being aware of this limitation, Fan <em id="S1.p2.1.1" class="ltx_emph ltx_font_italic">et al</em>.<span id="S1.p2.1.2" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> proposed to evaluate the performance of both base and novel classes in the generalized few-shot object detection (GFSOD) setting. In addition, they proposed a consistency regularization to emphasize the pre-trained base knowledge during fine-tuning and employed an ensembling strategy.
However, they design different classifiers for base and novel classes, and the adaptation on novel classes is impeded due to a complex ensembling process.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">In this paper, we pointed out that the devil is in insufficient discriminative feature learning for few-shot object detection, including inefficient knowledge adaptation to novel classes and unexpected knowledge forgetting of base classes. First, as the novel instances are extremely limited during training, it is hard to capture the representative visual information of novel classes and adapt the knowledge learned from base classes to novel classes.
As a result, the model cannot distinguish between the novel classes, which weakens the few-shot adaptation. Secondly, balanced training strategies such as down-sampling fail to utilize the diverse training samples from base set. Thus, it is hard to preserve the complete knowledge of base classes, which leads to overfitting and further decreases the detection scores.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">To tackle these challenges, we proposed a new training framework, <span id="S1.p4.1.1" class="ltx_text ltx_font_bold">DiGeo</span>, to make the best of both worlds for generalized few-shot object detection, <em id="S1.p4.1.2" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S1.p4.1.3" class="ltx_text"></span>, improving generalization on novel classes without hurting the detection of base classes. Our motivation is to learn <span id="S1.p4.1.4" class="ltx_text ltx_font_bold">Di</span>scriminative <span id="S1.p4.1.5" class="ltx_text ltx_font_bold">Geo</span>metry-aware features via <span id="S1.p4.1.6" class="ltx_text ltx_font_italic">inter-class separation</span> and <span id="S1.p4.1.7" class="ltx_text ltx_font_italic">intra-class compactness</span>. For inter-class separation, we expect the class centers <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib56" title="" class="ltx_ref">56</a>]</cite> to be well distinct from each other.
Motivated by the symmetric geometry of simplex equiangular tight frame (ETF) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite>, we proposed to use ETF as classifier to guide the separation of features. To be specific, we derive an offline ETF whose weights are maximally &amp; equivalently separated (<em id="S1.p4.1.8" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S1.p4.1.9" class="ltx_text"></span>, independent from the training data distribution) and are assigned as fixed centers for all classes.
For intra-class compactness, we expect the features to be closed to the class centers for a clear decision boundary.
In practice, we add class-specific margins to output logits during training to
push the features close to the class centers.
The margins are based on instance distribution prior and are then adaptively adjusted though self-distillation. Meanwhile, we consider the huge imbalance between <span id="S1.p4.1.10" class="ltx_text ltx_font_italic">base</span> set and <span id="S1.p4.1.11" class="ltx_text ltx_font_italic">novel</span> set, and up-sample the <span id="S1.p4.1.12" class="ltx_text ltx_font_italic">novel</span> set to facilitate the feature extraction.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">We validate the effectiveness of DiGeo under the GFSOD setting on Pascal VOC <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> and MS COCO <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>.
Compared to existing methods, we can both achieve precise detection on base classes and sufficiently improve the adaptation efficiency on novel classes using a single model.
Furthermore, our DiGeo can be intuitively extended to long-tailed object detection. Experimental results on LVIS datasets demonstrate the generalizibility of our approach.
Our contributions are summarized as follows:

</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We revisit few-shot object detection from a perspective of discriminative feature learning, and point out that existing methods fail in knowledge adaptation to novel classes and suffer from knowledge forgetting of base classes.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We propose DiGeo to pursue an desired feature geometry, <em id="S1.I1.i2.p1.1.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S1.I1.i2.p1.1.2" class="ltx_text"></span>, inter-class separation and intra-class compactness, which consistently improves the performance on both base and novel classes.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">We conduct extensive experiments on three benchmark datasets for few-shot object detection and long-tailed object detection to verify the generalizability of DiGeo.
</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<figure id="S2.F2" class="ltx_figure"><img src="/html/2303.09674/assets/x2.png" id="S2.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="438" height="103" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S2.F2.11.5.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S2.F2.8.4" class="ltx_text" style="font-size:90%;">Comparison of training frameworks. (a) Conventional approaches first pre-train a base detector among the <span id="S2.F2.8.4.1" class="ltx_text ltx_font_italic">base</span> set <math id="S2.F2.5.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{b}{}" display="inline"><semantics id="S2.F2.5.1.m1.1b"><msub id="S2.F2.5.1.m1.1.1" xref="S2.F2.5.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.F2.5.1.m1.1.1.2" xref="S2.F2.5.1.m1.1.1.2.cmml">𝒟</mi><mi id="S2.F2.5.1.m1.1.1.3" xref="S2.F2.5.1.m1.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S2.F2.5.1.m1.1c"><apply id="S2.F2.5.1.m1.1.1.cmml" xref="S2.F2.5.1.m1.1.1"><csymbol cd="ambiguous" id="S2.F2.5.1.m1.1.1.1.cmml" xref="S2.F2.5.1.m1.1.1">subscript</csymbol><ci id="S2.F2.5.1.m1.1.1.2.cmml" xref="S2.F2.5.1.m1.1.1.2">𝒟</ci><ci id="S2.F2.5.1.m1.1.1.3.cmml" xref="S2.F2.5.1.m1.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.5.1.m1.1d">\mathcal{D}_{b}{}</annotation></semantics></math> and then finetune on the union of novel set <math id="S2.F2.6.2.m2.1" class="ltx_Math" alttext="\mathcal{D}_{n}{}" display="inline"><semantics id="S2.F2.6.2.m2.1b"><msub id="S2.F2.6.2.m2.1.1" xref="S2.F2.6.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.F2.6.2.m2.1.1.2" xref="S2.F2.6.2.m2.1.1.2.cmml">𝒟</mi><mi id="S2.F2.6.2.m2.1.1.3" xref="S2.F2.6.2.m2.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S2.F2.6.2.m2.1c"><apply id="S2.F2.6.2.m2.1.1.cmml" xref="S2.F2.6.2.m2.1.1"><csymbol cd="ambiguous" id="S2.F2.6.2.m2.1.1.1.cmml" xref="S2.F2.6.2.m2.1.1">subscript</csymbol><ci id="S2.F2.6.2.m2.1.1.2.cmml" xref="S2.F2.6.2.m2.1.1.2">𝒟</ci><ci id="S2.F2.6.2.m2.1.1.3.cmml" xref="S2.F2.6.2.m2.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.6.2.m2.1d">\mathcal{D}_{n}{}</annotation></semantics></math> and down-sampled subset of base classes <math id="S2.F2.7.3.m3.1" class="ltx_Math" alttext="\mathcal{D}^{-}_{b}{}" display="inline"><semantics id="S2.F2.7.3.m3.1b"><msubsup id="S2.F2.7.3.m3.1.1" xref="S2.F2.7.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.F2.7.3.m3.1.1.2.2" xref="S2.F2.7.3.m3.1.1.2.2.cmml">𝒟</mi><mi id="S2.F2.7.3.m3.1.1.3" xref="S2.F2.7.3.m3.1.1.3.cmml">b</mi><mo id="S2.F2.7.3.m3.1.1.2.3" xref="S2.F2.7.3.m3.1.1.2.3.cmml">−</mo></msubsup><annotation-xml encoding="MathML-Content" id="S2.F2.7.3.m3.1c"><apply id="S2.F2.7.3.m3.1.1.cmml" xref="S2.F2.7.3.m3.1.1"><csymbol cd="ambiguous" id="S2.F2.7.3.m3.1.1.1.cmml" xref="S2.F2.7.3.m3.1.1">subscript</csymbol><apply id="S2.F2.7.3.m3.1.1.2.cmml" xref="S2.F2.7.3.m3.1.1"><csymbol cd="ambiguous" id="S2.F2.7.3.m3.1.1.2.1.cmml" xref="S2.F2.7.3.m3.1.1">superscript</csymbol><ci id="S2.F2.7.3.m3.1.1.2.2.cmml" xref="S2.F2.7.3.m3.1.1.2.2">𝒟</ci><minus id="S2.F2.7.3.m3.1.1.2.3.cmml" xref="S2.F2.7.3.m3.1.1.2.3"></minus></apply><ci id="S2.F2.7.3.m3.1.1.3.cmml" xref="S2.F2.7.3.m3.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.7.3.m3.1d">\mathcal{D}^{-}_{b}{}</annotation></semantics></math>. (b) Instead, we choose to up-sample <math id="S2.F2.8.4.m4.1" class="ltx_Math" alttext="\mathcal{D}_{n}{}" display="inline"><semantics id="S2.F2.8.4.m4.1b"><msub id="S2.F2.8.4.m4.1.1" xref="S2.F2.8.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.F2.8.4.m4.1.1.2" xref="S2.F2.8.4.m4.1.1.2.cmml">𝒟</mi><mi id="S2.F2.8.4.m4.1.1.3" xref="S2.F2.8.4.m4.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S2.F2.8.4.m4.1c"><apply id="S2.F2.8.4.m4.1.1.cmml" xref="S2.F2.8.4.m4.1.1"><csymbol cd="ambiguous" id="S2.F2.8.4.m4.1.1.1.cmml" xref="S2.F2.8.4.m4.1.1">subscript</csymbol><ci id="S2.F2.8.4.m4.1.1.2.cmml" xref="S2.F2.8.4.m4.1.1.2">𝒟</ci><ci id="S2.F2.8.4.m4.1.1.3.cmml" xref="S2.F2.8.4.m4.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.8.4.m4.1d">\mathcal{D}_{n}{}</annotation></semantics></math> and directly train the detector on the full set. We derive a fixed classifier offline with maximally &amp; equally separated weights and learn the adaptive margins to tighten the feature clusters. The margins are estimated from priors of instance distribution and learned though self-distillation. The block with shading means training from scratch. We use the same design for localization and omit it for simplicity.</span></figcaption>
</figure>
<div id="S2.p1" class="ltx_para ltx_noindent">
<p id="S2.p1.1" class="ltx_p"><span id="S2.p1.1.1" class="ltx_text ltx_font_bold">Few-shot object detection (FSOD)</span> aims to detect objects of few-shot (<span id="S2.p1.1.2" class="ltx_text ltx_font_italic">novel</span>) classes at instance-level.
To improve the adaptation efficiency, the approaches based on the meta-learning and the transfer-learning are investigated.
The <em id="S2.p1.1.3" class="ltx_emph ltx_font_italic">meta-learning approaches <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite></em> learns a class-agnostic meta-learner to align instances of the same class from different images.
Under the Faster-RCNN framework, the attention-based meta-RPN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> and meta-detector <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> are proposed to generate class-relevant proposals and improve the instance alignment.
In addition, approaches based on Transformer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> and YoLo <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> are proposed to extract features jointly and align features at multiple scales.
The <span id="S2.p1.1.4" class="ltx_text ltx_font_italic">transfer-learning approaches <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib55" title="" class="ltx_ref">55</a>, <a href="#bib.bib57" title="" class="ltx_ref">57</a>, <a href="#bib.bib46" title="" class="ltx_ref">46</a>, <a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite></span> performs finetuning for few-shot adaptation.
Specifically, TFA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib55" title="" class="ltx_ref">55</a>]</cite> pre-trains an base detector from plenty of <span id="S2.p1.1.5" class="ltx_text ltx_font_italic">base</span> samples and finetune it for novel classes.
To improve the adaptation efficiency, multi-scale feature extraction <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib57" title="" class="ltx_ref">57</a>]</cite> and regularization such as contrastive loss <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite>, margin equilibrium <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> and transformation invariance <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> are employed.
Recently, DeFRCN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite> adjusts gradients back-propagated from different losses and achieve superior novel detection scores.</p>
</div>
<div id="S2.p2" class="ltx_para ltx_noindent">
<p id="S2.p2.1" class="ltx_p"><span id="S2.p2.1.1" class="ltx_text ltx_font_bold">Generalized Few-Shot Object Detection.</span>
For all FSOD approaches mentioned above, the precision on <span id="S2.p2.1.2" class="ltx_text ltx_font_italic">base</span> detection is sacrificed after few-shot adaptation.
This phenomenon has also been observed in various vision tasks where models forget the base knowledge due to domain gap or distribution gap <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib50" title="" class="ltx_ref">50</a>, <a href="#bib.bib36" title="" class="ltx_ref">36</a>, <a href="#bib.bib40" title="" class="ltx_ref">40</a>, <a href="#bib.bib37" title="" class="ltx_ref">37</a>, <a href="#bib.bib68" title="" class="ltx_ref">68</a>, <a href="#bib.bib67" title="" class="ltx_ref">67</a>, <a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>.
As pointed out by Fan <em id="S2.p2.1.3" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.p2.1.4" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>, different from the classification <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib45" title="" class="ltx_ref">45</a>, <a href="#bib.bib51" title="" class="ltx_ref">51</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib65" title="" class="ltx_ref">65</a>, <a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib62" title="" class="ltx_ref">62</a>]</cite>,
an image may contain instances from both novel and base classes and base detection is also important.
Then, they propose a consistency regularization few-shot fine-tuning and employ an model ensembling technique
to preserve the precision of base detection. However, the few-shot adaptation efficiency is inevitably limited.
In a more general case, <em id="S2.p2.1.5" class="ltx_emph ltx_font_italic">long-tail object detection</em> (LTOD) has been studied where techniques such as resampling <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib64" title="" class="ltx_ref">64</a>, <a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>, decoupling <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib53" title="" class="ltx_ref">53</a>]</cite> and reweighting <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib64" title="" class="ltx_ref">64</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> are studied. Also, ACSL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib54" title="" class="ltx_ref">54</a>]</cite> revisits LTOD from a statistic-free perspective and propose the adaptive suppression loss.</p>
</div>
<div id="S2.p3" class="ltx_para ltx_noindent">
<p id="S2.p3.1" class="ltx_p"><span id="S2.p3.1.1" class="ltx_text ltx_font_bold">Feature Distribution on a Balanced Set</span> has been studied in classification. To be specific, the weights in the last linear layer is treated as class centers where the geometry property of feature output by pernuminate layer is analyzed. Recently, Papyan <em id="S2.p3.1.2" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.p3.1.3" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite> summarized it as neural collapse (NC) and observed that 1) the features in the same class are maximally concentrated towards the class mean and different feature clusters are maximally separated <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib60" title="" class="ltx_ref">60</a>]</cite>. 2) The class means and the class centers converge to each other.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Background</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">We first introduce the few-shot object detection (FSOD) task, and analyze the limitations of existing FSOD methods.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Few-shot Object Detection</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.8" class="ltx_p">In this paper, we focus on the task of few-shot object detection (FSOD). The training data consists of a <span id="S3.SS1.p1.8.1" class="ltx_text ltx_font_italic">base</span> set <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{b}{}" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><msub id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">𝒟</ci><ci id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\mathcal{D}_{b}{}</annotation></semantics></math> and a <span id="S3.SS1.p1.8.2" class="ltx_text ltx_font_italic">novel</span> set <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{D}_{n}{}" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><msub id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2">𝒟</ci><ci id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">\mathcal{D}_{n}{}</annotation></semantics></math>, where the <span id="S3.SS1.p1.8.3" class="ltx_text ltx_font_italic">base</span> classes <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{C}_{b}{}" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><msub id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">𝒞</mi><mi id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2">𝒞</ci><ci id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">\mathcal{C}_{b}{}</annotation></semantics></math> have plenty of annotated object instances while <span id="S3.SS1.p1.8.4" class="ltx_text ltx_font_italic">novel</span> classes <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="\mathcal{C}_{n}{}" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><msub id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml">𝒞</mi><mi id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2">𝒞</ci><ci id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">\mathcal{C}_{n}{}</annotation></semantics></math> has limited annotations.
In an <math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="N_{n}" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><msub id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml"><mi id="S3.SS1.p1.5.m5.1.1.2" xref="S3.SS1.p1.5.m5.1.1.2.cmml">N</mi><mi id="S3.SS1.p1.5.m5.1.1.3" xref="S3.SS1.p1.5.m5.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2">𝑁</ci><ci id="S3.SS1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">N_{n}</annotation></semantics></math>-way <math id="S3.SS1.p1.6.m6.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS1.p1.6.m6.1a"><mi id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><ci id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">K</annotation></semantics></math>-shot FSOD task with <math id="S3.SS1.p1.7.m7.1" class="ltx_Math" alttext="|\mathcal{C}_{n}{}|=N_{n}" display="inline"><semantics id="S3.SS1.p1.7.m7.1a"><mrow id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml"><mrow id="S3.SS1.p1.7.m7.1.1.1.1" xref="S3.SS1.p1.7.m7.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.7.m7.1.1.1.1.2" xref="S3.SS1.p1.7.m7.1.1.1.2.1.cmml">|</mo><msub id="S3.SS1.p1.7.m7.1.1.1.1.1" xref="S3.SS1.p1.7.m7.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.7.m7.1.1.1.1.1.2" xref="S3.SS1.p1.7.m7.1.1.1.1.1.2.cmml">𝒞</mi><mi id="S3.SS1.p1.7.m7.1.1.1.1.1.3" xref="S3.SS1.p1.7.m7.1.1.1.1.1.3.cmml">n</mi></msub><mo stretchy="false" id="S3.SS1.p1.7.m7.1.1.1.1.3" xref="S3.SS1.p1.7.m7.1.1.1.2.1.cmml">|</mo></mrow><mo id="S3.SS1.p1.7.m7.1.1.2" xref="S3.SS1.p1.7.m7.1.1.2.cmml">=</mo><msub id="S3.SS1.p1.7.m7.1.1.3" xref="S3.SS1.p1.7.m7.1.1.3.cmml"><mi id="S3.SS1.p1.7.m7.1.1.3.2" xref="S3.SS1.p1.7.m7.1.1.3.2.cmml">N</mi><mi id="S3.SS1.p1.7.m7.1.1.3.3" xref="S3.SS1.p1.7.m7.1.1.3.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><apply id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1"><eq id="S3.SS1.p1.7.m7.1.1.2.cmml" xref="S3.SS1.p1.7.m7.1.1.2"></eq><apply id="S3.SS1.p1.7.m7.1.1.1.2.cmml" xref="S3.SS1.p1.7.m7.1.1.1.1"><abs id="S3.SS1.p1.7.m7.1.1.1.2.1.cmml" xref="S3.SS1.p1.7.m7.1.1.1.1.2"></abs><apply id="S3.SS1.p1.7.m7.1.1.1.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.7.m7.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.7.m7.1.1.1.1.1.2">𝒞</ci><ci id="S3.SS1.p1.7.m7.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.7.m7.1.1.1.1.1.3">𝑛</ci></apply></apply><apply id="S3.SS1.p1.7.m7.1.1.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.1.1.3.1.cmml" xref="S3.SS1.p1.7.m7.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.7.m7.1.1.3.2.cmml" xref="S3.SS1.p1.7.m7.1.1.3.2">𝑁</ci><ci id="S3.SS1.p1.7.m7.1.1.3.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">|\mathcal{C}_{n}{}|=N_{n}</annotation></semantics></math>, each novel class has <math id="S3.SS1.p1.8.m8.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS1.p1.8.m8.1a"><mi id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><ci id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">K</annotation></semantics></math> annotated instances.
Note that an image may contain multiple instances from different classes with associated bounding boxes, which is more challenging than the few-shot classification where each image contains one object to be recognized.
Then, we follow  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib55" title="" class="ltx_ref">55</a>]</cite> to validate the robustness of detection model under the generalized few-shot object detection (GFSOD) setting, where the test samples come from both base and novel classes, and the models are evaluated on all classes.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.8" class="ltx_p">Commonly, object detection models consist of a proposal generation module to generate a set of region candidates, and a detection module to localize &amp; classify objects on the extracted proposals <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>, <a href="#bib.bib42" title="" class="ltx_ref">42</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib69" title="" class="ltx_ref">69</a>, <a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite>.
For the classification part, an additional background class should be considered to recognize the proposal with no foreground objects. We regard the last linear layer as classifier, and its weights <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="W=\{\mathbf{w}_{i}\}_{i=1}^{N_{b}+N_{n}+1}" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><mrow id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml"><mi id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3.cmml">W</mi><mo id="S3.SS1.p2.1.m1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.2.cmml">=</mo><msubsup id="S3.SS1.p2.1.m1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.cmml"><mrow id="S3.SS1.p2.1.m1.1.1.1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p2.1.m1.1.1.1.1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.1.1.1.2.cmml">{</mo><msub id="S3.SS1.p2.1.m1.1.1.1.1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.2.cmml">𝐰</mi><mi id="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS1.p2.1.m1.1.1.1.1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS1.p2.1.m1.1.1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.1.1.3.cmml"><mi id="S3.SS1.p2.1.m1.1.1.1.1.3.2" xref="S3.SS1.p2.1.m1.1.1.1.1.3.2.cmml">i</mi><mo id="S3.SS1.p2.1.m1.1.1.1.1.3.1" xref="S3.SS1.p2.1.m1.1.1.1.1.3.1.cmml">=</mo><mn id="S3.SS1.p2.1.m1.1.1.1.1.3.3" xref="S3.SS1.p2.1.m1.1.1.1.1.3.3.cmml">1</mn></mrow><mrow id="S3.SS1.p2.1.m1.1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.1.3.cmml"><msub id="S3.SS1.p2.1.m1.1.1.1.3.2" xref="S3.SS1.p2.1.m1.1.1.1.3.2.cmml"><mi id="S3.SS1.p2.1.m1.1.1.1.3.2.2" xref="S3.SS1.p2.1.m1.1.1.1.3.2.2.cmml">N</mi><mi id="S3.SS1.p2.1.m1.1.1.1.3.2.3" xref="S3.SS1.p2.1.m1.1.1.1.3.2.3.cmml">b</mi></msub><mo id="S3.SS1.p2.1.m1.1.1.1.3.1" xref="S3.SS1.p2.1.m1.1.1.1.3.1.cmml">+</mo><msub id="S3.SS1.p2.1.m1.1.1.1.3.3" xref="S3.SS1.p2.1.m1.1.1.1.3.3.cmml"><mi id="S3.SS1.p2.1.m1.1.1.1.3.3.2" xref="S3.SS1.p2.1.m1.1.1.1.3.3.2.cmml">N</mi><mi id="S3.SS1.p2.1.m1.1.1.1.3.3.3" xref="S3.SS1.p2.1.m1.1.1.1.3.3.3.cmml">n</mi></msub><mo id="S3.SS1.p2.1.m1.1.1.1.3.1a" xref="S3.SS1.p2.1.m1.1.1.1.3.1.cmml">+</mo><mn id="S3.SS1.p2.1.m1.1.1.1.3.4" xref="S3.SS1.p2.1.m1.1.1.1.3.4.cmml">1</mn></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1"><eq id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2"></eq><ci id="S3.SS1.p2.1.m1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3">𝑊</ci><apply id="S3.SS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.1">superscript</csymbol><apply id="S3.SS1.p2.1.m1.1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.1">subscript</csymbol><set id="S3.SS1.p2.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1"><apply id="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.2">𝐰</ci><ci id="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S3.SS1.p2.1.m1.1.1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.3"><eq id="S3.SS1.p2.1.m1.1.1.1.1.3.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.3.1"></eq><ci id="S3.SS1.p2.1.m1.1.1.1.1.3.2.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="S3.SS1.p2.1.m1.1.1.1.1.3.3.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.SS1.p2.1.m1.1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.1.3"><plus id="S3.SS1.p2.1.m1.1.1.1.3.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.3.1"></plus><apply id="S3.SS1.p2.1.m1.1.1.1.3.2.cmml" xref="S3.SS1.p2.1.m1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.3.2.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.3.2">subscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.1.3.2.2.cmml" xref="S3.SS1.p2.1.m1.1.1.1.3.2.2">𝑁</ci><ci id="S3.SS1.p2.1.m1.1.1.1.3.2.3.cmml" xref="S3.SS1.p2.1.m1.1.1.1.3.2.3">𝑏</ci></apply><apply id="S3.SS1.p2.1.m1.1.1.1.3.3.cmml" xref="S3.SS1.p2.1.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.3.3.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.3.3">subscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.1.3.3.2.cmml" xref="S3.SS1.p2.1.m1.1.1.1.3.3.2">𝑁</ci><ci id="S3.SS1.p2.1.m1.1.1.1.3.3.3.cmml" xref="S3.SS1.p2.1.m1.1.1.1.3.3.3">𝑛</ci></apply><cn type="integer" id="S3.SS1.p2.1.m1.1.1.1.3.4.cmml" xref="S3.SS1.p2.1.m1.1.1.1.3.4">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">W=\{\mathbf{w}_{i}\}_{i=1}^{N_{b}+N_{n}+1}</annotation></semantics></math> as class centers where <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="N_{b}=|\mathcal{C}_{b}|" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><mrow id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml"><msub id="S3.SS1.p2.2.m2.1.1.3" xref="S3.SS1.p2.2.m2.1.1.3.cmml"><mi id="S3.SS1.p2.2.m2.1.1.3.2" xref="S3.SS1.p2.2.m2.1.1.3.2.cmml">N</mi><mi id="S3.SS1.p2.2.m2.1.1.3.3" xref="S3.SS1.p2.2.m2.1.1.3.3.cmml">b</mi></msub><mo id="S3.SS1.p2.2.m2.1.1.2" xref="S3.SS1.p2.2.m2.1.1.2.cmml">=</mo><mrow id="S3.SS1.p2.2.m2.1.1.1.1" xref="S3.SS1.p2.2.m2.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p2.2.m2.1.1.1.1.2" xref="S3.SS1.p2.2.m2.1.1.1.2.1.cmml">|</mo><msub id="S3.SS1.p2.2.m2.1.1.1.1.1" xref="S3.SS1.p2.2.m2.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.2.m2.1.1.1.1.1.2" xref="S3.SS1.p2.2.m2.1.1.1.1.1.2.cmml">𝒞</mi><mi id="S3.SS1.p2.2.m2.1.1.1.1.1.3" xref="S3.SS1.p2.2.m2.1.1.1.1.1.3.cmml">b</mi></msub><mo stretchy="false" id="S3.SS1.p2.2.m2.1.1.1.1.3" xref="S3.SS1.p2.2.m2.1.1.1.2.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"><eq id="S3.SS1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.2"></eq><apply id="S3.SS1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.3.1.cmml" xref="S3.SS1.p2.2.m2.1.1.3">subscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.3.2.cmml" xref="S3.SS1.p2.2.m2.1.1.3.2">𝑁</ci><ci id="S3.SS1.p2.2.m2.1.1.3.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3.3">𝑏</ci></apply><apply id="S3.SS1.p2.2.m2.1.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1"><abs id="S3.SS1.p2.2.m2.1.1.1.2.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.2"></abs><apply id="S3.SS1.p2.2.m2.1.1.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1.2">𝒞</ci><ci id="S3.SS1.p2.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1.3">𝑏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">N_{b}=|\mathcal{C}_{b}|</annotation></semantics></math>.
Without loss of generality, we set <math id="S3.SS1.p2.3.m3.1" class="ltx_Math" alttext="W_{b}=\{\mathbf{w}_{i}\}_{i=1}^{N_{b}}" display="inline"><semantics id="S3.SS1.p2.3.m3.1a"><mrow id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml"><msub id="S3.SS1.p2.3.m3.1.1.3" xref="S3.SS1.p2.3.m3.1.1.3.cmml"><mi id="S3.SS1.p2.3.m3.1.1.3.2" xref="S3.SS1.p2.3.m3.1.1.3.2.cmml">W</mi><mi id="S3.SS1.p2.3.m3.1.1.3.3" xref="S3.SS1.p2.3.m3.1.1.3.3.cmml">b</mi></msub><mo id="S3.SS1.p2.3.m3.1.1.2" xref="S3.SS1.p2.3.m3.1.1.2.cmml">=</mo><msubsup id="S3.SS1.p2.3.m3.1.1.1" xref="S3.SS1.p2.3.m3.1.1.1.cmml"><mrow id="S3.SS1.p2.3.m3.1.1.1.1.1.1" xref="S3.SS1.p2.3.m3.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p2.3.m3.1.1.1.1.1.1.2" xref="S3.SS1.p2.3.m3.1.1.1.1.1.2.cmml">{</mo><msub id="S3.SS1.p2.3.m3.1.1.1.1.1.1.1" xref="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.2" xref="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.2.cmml">𝐰</mi><mi id="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.3" xref="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS1.p2.3.m3.1.1.1.1.1.1.3" xref="S3.SS1.p2.3.m3.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS1.p2.3.m3.1.1.1.1.3" xref="S3.SS1.p2.3.m3.1.1.1.1.3.cmml"><mi id="S3.SS1.p2.3.m3.1.1.1.1.3.2" xref="S3.SS1.p2.3.m3.1.1.1.1.3.2.cmml">i</mi><mo id="S3.SS1.p2.3.m3.1.1.1.1.3.1" xref="S3.SS1.p2.3.m3.1.1.1.1.3.1.cmml">=</mo><mn id="S3.SS1.p2.3.m3.1.1.1.1.3.3" xref="S3.SS1.p2.3.m3.1.1.1.1.3.3.cmml">1</mn></mrow><msub id="S3.SS1.p2.3.m3.1.1.1.3" xref="S3.SS1.p2.3.m3.1.1.1.3.cmml"><mi id="S3.SS1.p2.3.m3.1.1.1.3.2" xref="S3.SS1.p2.3.m3.1.1.1.3.2.cmml">N</mi><mi id="S3.SS1.p2.3.m3.1.1.1.3.3" xref="S3.SS1.p2.3.m3.1.1.1.3.3.cmml">b</mi></msub></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><apply id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1"><eq id="S3.SS1.p2.3.m3.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2"></eq><apply id="S3.SS1.p2.3.m3.1.1.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.3.1.cmml" xref="S3.SS1.p2.3.m3.1.1.3">subscript</csymbol><ci id="S3.SS1.p2.3.m3.1.1.3.2.cmml" xref="S3.SS1.p2.3.m3.1.1.3.2">𝑊</ci><ci id="S3.SS1.p2.3.m3.1.1.3.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3.3">𝑏</ci></apply><apply id="S3.SS1.p2.3.m3.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.1">superscript</csymbol><apply id="S3.SS1.p2.3.m3.1.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.1">subscript</csymbol><set id="S3.SS1.p2.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.1.1.1.1"><apply id="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.2">𝐰</ci><ci id="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S3.SS1.p2.3.m3.1.1.1.1.3.cmml" xref="S3.SS1.p2.3.m3.1.1.1.1.3"><eq id="S3.SS1.p2.3.m3.1.1.1.1.3.1.cmml" xref="S3.SS1.p2.3.m3.1.1.1.1.3.1"></eq><ci id="S3.SS1.p2.3.m3.1.1.1.1.3.2.cmml" xref="S3.SS1.p2.3.m3.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="S3.SS1.p2.3.m3.1.1.1.1.3.3.cmml" xref="S3.SS1.p2.3.m3.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.SS1.p2.3.m3.1.1.1.3.cmml" xref="S3.SS1.p2.3.m3.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.1.3.1.cmml" xref="S3.SS1.p2.3.m3.1.1.1.3">subscript</csymbol><ci id="S3.SS1.p2.3.m3.1.1.1.3.2.cmml" xref="S3.SS1.p2.3.m3.1.1.1.3.2">𝑁</ci><ci id="S3.SS1.p2.3.m3.1.1.1.3.3.cmml" xref="S3.SS1.p2.3.m3.1.1.1.3.3">𝑏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">W_{b}=\{\mathbf{w}_{i}\}_{i=1}^{N_{b}}</annotation></semantics></math>, <math id="S3.SS1.p2.4.m4.1" class="ltx_Math" alttext="W_{n}=\{\mathbf{w}_{i}\}_{i=N_{b}+1}^{N_{b}+N_{n}}" display="inline"><semantics id="S3.SS1.p2.4.m4.1a"><mrow id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml"><msub id="S3.SS1.p2.4.m4.1.1.3" xref="S3.SS1.p2.4.m4.1.1.3.cmml"><mi id="S3.SS1.p2.4.m4.1.1.3.2" xref="S3.SS1.p2.4.m4.1.1.3.2.cmml">W</mi><mi id="S3.SS1.p2.4.m4.1.1.3.3" xref="S3.SS1.p2.4.m4.1.1.3.3.cmml">n</mi></msub><mo id="S3.SS1.p2.4.m4.1.1.2" xref="S3.SS1.p2.4.m4.1.1.2.cmml">=</mo><msubsup id="S3.SS1.p2.4.m4.1.1.1" xref="S3.SS1.p2.4.m4.1.1.1.cmml"><mrow id="S3.SS1.p2.4.m4.1.1.1.1.1.1" xref="S3.SS1.p2.4.m4.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p2.4.m4.1.1.1.1.1.1.2" xref="S3.SS1.p2.4.m4.1.1.1.1.1.2.cmml">{</mo><msub id="S3.SS1.p2.4.m4.1.1.1.1.1.1.1" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.2" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.2.cmml">𝐰</mi><mi id="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.3" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS1.p2.4.m4.1.1.1.1.1.1.3" xref="S3.SS1.p2.4.m4.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS1.p2.4.m4.1.1.1.1.3" xref="S3.SS1.p2.4.m4.1.1.1.1.3.cmml"><mi id="S3.SS1.p2.4.m4.1.1.1.1.3.2" xref="S3.SS1.p2.4.m4.1.1.1.1.3.2.cmml">i</mi><mo id="S3.SS1.p2.4.m4.1.1.1.1.3.1" xref="S3.SS1.p2.4.m4.1.1.1.1.3.1.cmml">=</mo><mrow id="S3.SS1.p2.4.m4.1.1.1.1.3.3" xref="S3.SS1.p2.4.m4.1.1.1.1.3.3.cmml"><msub id="S3.SS1.p2.4.m4.1.1.1.1.3.3.2" xref="S3.SS1.p2.4.m4.1.1.1.1.3.3.2.cmml"><mi id="S3.SS1.p2.4.m4.1.1.1.1.3.3.2.2" xref="S3.SS1.p2.4.m4.1.1.1.1.3.3.2.2.cmml">N</mi><mi id="S3.SS1.p2.4.m4.1.1.1.1.3.3.2.3" xref="S3.SS1.p2.4.m4.1.1.1.1.3.3.2.3.cmml">b</mi></msub><mo id="S3.SS1.p2.4.m4.1.1.1.1.3.3.1" xref="S3.SS1.p2.4.m4.1.1.1.1.3.3.1.cmml">+</mo><mn id="S3.SS1.p2.4.m4.1.1.1.1.3.3.3" xref="S3.SS1.p2.4.m4.1.1.1.1.3.3.3.cmml">1</mn></mrow></mrow><mrow id="S3.SS1.p2.4.m4.1.1.1.3" xref="S3.SS1.p2.4.m4.1.1.1.3.cmml"><msub id="S3.SS1.p2.4.m4.1.1.1.3.2" xref="S3.SS1.p2.4.m4.1.1.1.3.2.cmml"><mi id="S3.SS1.p2.4.m4.1.1.1.3.2.2" xref="S3.SS1.p2.4.m4.1.1.1.3.2.2.cmml">N</mi><mi id="S3.SS1.p2.4.m4.1.1.1.3.2.3" xref="S3.SS1.p2.4.m4.1.1.1.3.2.3.cmml">b</mi></msub><mo id="S3.SS1.p2.4.m4.1.1.1.3.1" xref="S3.SS1.p2.4.m4.1.1.1.3.1.cmml">+</mo><msub id="S3.SS1.p2.4.m4.1.1.1.3.3" xref="S3.SS1.p2.4.m4.1.1.1.3.3.cmml"><mi id="S3.SS1.p2.4.m4.1.1.1.3.3.2" xref="S3.SS1.p2.4.m4.1.1.1.3.3.2.cmml">N</mi><mi id="S3.SS1.p2.4.m4.1.1.1.3.3.3" xref="S3.SS1.p2.4.m4.1.1.1.3.3.3.cmml">n</mi></msub></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><apply id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1"><eq id="S3.SS1.p2.4.m4.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.2"></eq><apply id="S3.SS1.p2.4.m4.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.3.1.cmml" xref="S3.SS1.p2.4.m4.1.1.3">subscript</csymbol><ci id="S3.SS1.p2.4.m4.1.1.3.2.cmml" xref="S3.SS1.p2.4.m4.1.1.3.2">𝑊</ci><ci id="S3.SS1.p2.4.m4.1.1.3.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3.3">𝑛</ci></apply><apply id="S3.SS1.p2.4.m4.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.1">superscript</csymbol><apply id="S3.SS1.p2.4.m4.1.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.1">subscript</csymbol><set id="S3.SS1.p2.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1"><apply id="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.2">𝐰</ci><ci id="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S3.SS1.p2.4.m4.1.1.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.3"><eq id="S3.SS1.p2.4.m4.1.1.1.1.3.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.3.1"></eq><ci id="S3.SS1.p2.4.m4.1.1.1.1.3.2.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.3.2">𝑖</ci><apply id="S3.SS1.p2.4.m4.1.1.1.1.3.3.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.3.3"><plus id="S3.SS1.p2.4.m4.1.1.1.1.3.3.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.3.3.1"></plus><apply id="S3.SS1.p2.4.m4.1.1.1.1.3.3.2.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.1.1.3.3.2.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.3.3.2">subscript</csymbol><ci id="S3.SS1.p2.4.m4.1.1.1.1.3.3.2.2.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.3.3.2.2">𝑁</ci><ci id="S3.SS1.p2.4.m4.1.1.1.1.3.3.2.3.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.3.3.2.3">𝑏</ci></apply><cn type="integer" id="S3.SS1.p2.4.m4.1.1.1.1.3.3.3.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.3.3.3">1</cn></apply></apply></apply><apply id="S3.SS1.p2.4.m4.1.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.1.3"><plus id="S3.SS1.p2.4.m4.1.1.1.3.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1.3.1"></plus><apply id="S3.SS1.p2.4.m4.1.1.1.3.2.cmml" xref="S3.SS1.p2.4.m4.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.1.3.2.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1.3.2">subscript</csymbol><ci id="S3.SS1.p2.4.m4.1.1.1.3.2.2.cmml" xref="S3.SS1.p2.4.m4.1.1.1.3.2.2">𝑁</ci><ci id="S3.SS1.p2.4.m4.1.1.1.3.2.3.cmml" xref="S3.SS1.p2.4.m4.1.1.1.3.2.3">𝑏</ci></apply><apply id="S3.SS1.p2.4.m4.1.1.1.3.3.cmml" xref="S3.SS1.p2.4.m4.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.1.3.3.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1.3.3">subscript</csymbol><ci id="S3.SS1.p2.4.m4.1.1.1.3.3.2.cmml" xref="S3.SS1.p2.4.m4.1.1.1.3.3.2">𝑁</ci><ci id="S3.SS1.p2.4.m4.1.1.1.3.3.3.cmml" xref="S3.SS1.p2.4.m4.1.1.1.3.3.3">𝑛</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">W_{n}=\{\mathbf{w}_{i}\}_{i=N_{b}+1}^{N_{b}+N_{n}}</annotation></semantics></math>, and <math id="S3.SS1.p2.5.m5.1" class="ltx_Math" alttext="W_{-}=\{\mathbf{w}_{N+1}\}" display="inline"><semantics id="S3.SS1.p2.5.m5.1a"><mrow id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml"><msub id="S3.SS1.p2.5.m5.1.1.3" xref="S3.SS1.p2.5.m5.1.1.3.cmml"><mi id="S3.SS1.p2.5.m5.1.1.3.2" xref="S3.SS1.p2.5.m5.1.1.3.2.cmml">W</mi><mo id="S3.SS1.p2.5.m5.1.1.3.3" xref="S3.SS1.p2.5.m5.1.1.3.3.cmml">−</mo></msub><mo id="S3.SS1.p2.5.m5.1.1.2" xref="S3.SS1.p2.5.m5.1.1.2.cmml">=</mo><mrow id="S3.SS1.p2.5.m5.1.1.1.1" xref="S3.SS1.p2.5.m5.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p2.5.m5.1.1.1.1.2" xref="S3.SS1.p2.5.m5.1.1.1.2.cmml">{</mo><msub id="S3.SS1.p2.5.m5.1.1.1.1.1" xref="S3.SS1.p2.5.m5.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.5.m5.1.1.1.1.1.2" xref="S3.SS1.p2.5.m5.1.1.1.1.1.2.cmml">𝐰</mi><mrow id="S3.SS1.p2.5.m5.1.1.1.1.1.3" xref="S3.SS1.p2.5.m5.1.1.1.1.1.3.cmml"><mi id="S3.SS1.p2.5.m5.1.1.1.1.1.3.2" xref="S3.SS1.p2.5.m5.1.1.1.1.1.3.2.cmml">N</mi><mo id="S3.SS1.p2.5.m5.1.1.1.1.1.3.1" xref="S3.SS1.p2.5.m5.1.1.1.1.1.3.1.cmml">+</mo><mn id="S3.SS1.p2.5.m5.1.1.1.1.1.3.3" xref="S3.SS1.p2.5.m5.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S3.SS1.p2.5.m5.1.1.1.1.3" xref="S3.SS1.p2.5.m5.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><apply id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1"><eq id="S3.SS1.p2.5.m5.1.1.2.cmml" xref="S3.SS1.p2.5.m5.1.1.2"></eq><apply id="S3.SS1.p2.5.m5.1.1.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.1.1.3.1.cmml" xref="S3.SS1.p2.5.m5.1.1.3">subscript</csymbol><ci id="S3.SS1.p2.5.m5.1.1.3.2.cmml" xref="S3.SS1.p2.5.m5.1.1.3.2">𝑊</ci><minus id="S3.SS1.p2.5.m5.1.1.3.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3.3"></minus></apply><set id="S3.SS1.p2.5.m5.1.1.1.2.cmml" xref="S3.SS1.p2.5.m5.1.1.1.1"><apply id="S3.SS1.p2.5.m5.1.1.1.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.5.m5.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.5.m5.1.1.1.1.1.2">𝐰</ci><apply id="S3.SS1.p2.5.m5.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.5.m5.1.1.1.1.1.3"><plus id="S3.SS1.p2.5.m5.1.1.1.1.1.3.1.cmml" xref="S3.SS1.p2.5.m5.1.1.1.1.1.3.1"></plus><ci id="S3.SS1.p2.5.m5.1.1.1.1.1.3.2.cmml" xref="S3.SS1.p2.5.m5.1.1.1.1.1.3.2">𝑁</ci><cn type="integer" id="S3.SS1.p2.5.m5.1.1.1.1.1.3.3.cmml" xref="S3.SS1.p2.5.m5.1.1.1.1.1.3.3">1</cn></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">W_{-}=\{\mathbf{w}_{N+1}\}</annotation></semantics></math> as weights for base classes <math id="S3.SS1.p2.6.m6.1" class="ltx_Math" alttext="\mathcal{C}_{b}{}" display="inline"><semantics id="S3.SS1.p2.6.m6.1a"><msub id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.6.m6.1.1.2" xref="S3.SS1.p2.6.m6.1.1.2.cmml">𝒞</mi><mi id="S3.SS1.p2.6.m6.1.1.3" xref="S3.SS1.p2.6.m6.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.1b"><apply id="S3.SS1.p2.6.m6.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.1.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.p2.6.m6.1.1.2.cmml" xref="S3.SS1.p2.6.m6.1.1.2">𝒞</ci><ci id="S3.SS1.p2.6.m6.1.1.3.cmml" xref="S3.SS1.p2.6.m6.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.1c">\mathcal{C}_{b}{}</annotation></semantics></math>, novel classes <math id="S3.SS1.p2.7.m7.1" class="ltx_Math" alttext="\mathcal{C}_{n}{}" display="inline"><semantics id="S3.SS1.p2.7.m7.1a"><msub id="S3.SS1.p2.7.m7.1.1" xref="S3.SS1.p2.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.7.m7.1.1.2" xref="S3.SS1.p2.7.m7.1.1.2.cmml">𝒞</mi><mi id="S3.SS1.p2.7.m7.1.1.3" xref="S3.SS1.p2.7.m7.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m7.1b"><apply id="S3.SS1.p2.7.m7.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.1.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1">subscript</csymbol><ci id="S3.SS1.p2.7.m7.1.1.2.cmml" xref="S3.SS1.p2.7.m7.1.1.2">𝒞</ci><ci id="S3.SS1.p2.7.m7.1.1.3.cmml" xref="S3.SS1.p2.7.m7.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m7.1c">\mathcal{C}_{n}{}</annotation></semantics></math>, and background <math id="S3.SS1.p2.8.m8.1" class="ltx_Math" alttext="c_{-}{}" display="inline"><semantics id="S3.SS1.p2.8.m8.1a"><msub id="S3.SS1.p2.8.m8.1.1" xref="S3.SS1.p2.8.m8.1.1.cmml"><mi id="S3.SS1.p2.8.m8.1.1.2" xref="S3.SS1.p2.8.m8.1.1.2.cmml">c</mi><mo id="S3.SS1.p2.8.m8.1.1.3" xref="S3.SS1.p2.8.m8.1.1.3.cmml">−</mo></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m8.1b"><apply id="S3.SS1.p2.8.m8.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m8.1.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1">subscript</csymbol><ci id="S3.SS1.p2.8.m8.1.1.2.cmml" xref="S3.SS1.p2.8.m8.1.1.2">𝑐</ci><minus id="S3.SS1.p2.8.m8.1.1.3.cmml" xref="S3.SS1.p2.8.m8.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.8.m8.1c">c_{-}{}</annotation></semantics></math>.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Analysis of Existing Methods</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.13" class="ltx_p">As a representative <span id="S3.SS2.p1.13.1" class="ltx_text ltx_font_italic">transfer-learning</span> approach shown in Fig. <a href="#S2.F2" title="Figure 2 ‣ 2 Related Work ‣ DiGeo: Discriminative Geometry-Aware Learning for Generalized Few-Shot Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>(a), TFA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib55" title="" class="ltx_ref">55</a>]</cite> first trains a <span id="S3.SS2.p1.13.2" class="ltx_text ltx_font_italic">Base</span> detector on <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{b}{}" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><msub id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">𝒟</mi><mi id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">𝒟</ci><ci id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\mathcal{D}_{b}{}</annotation></semantics></math> for <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{C}_{b}{}" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><msub id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">𝒞</mi><mi id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">𝒞</ci><ci id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\mathcal{C}_{b}{}</annotation></semantics></math> as initialization. Then, in an <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="N_{n}" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><msub id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml">N</mi><mi id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2">𝑁</ci><ci id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">N_{n}</annotation></semantics></math>-way <math id="S3.SS2.p1.4.m4.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS2.p1.4.m4.1a"><mi id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><ci id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">K</annotation></semantics></math>-shot GFSOD task, <math id="S3.SS2.p1.5.m5.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS2.p1.5.m5.1a"><mi id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><ci id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">K</annotation></semantics></math> instances for each <span id="S3.SS2.p1.13.3" class="ltx_text ltx_font_italic">base</span> class <math id="S3.SS2.p1.6.m6.1" class="ltx_Math" alttext="c\in\mathcal{C}_{b}{}" display="inline"><semantics id="S3.SS2.p1.6.m6.1a"><mrow id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml"><mi id="S3.SS2.p1.6.m6.1.1.2" xref="S3.SS2.p1.6.m6.1.1.2.cmml">c</mi><mo id="S3.SS2.p1.6.m6.1.1.1" xref="S3.SS2.p1.6.m6.1.1.1.cmml">∈</mo><msub id="S3.SS2.p1.6.m6.1.1.3" xref="S3.SS2.p1.6.m6.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.6.m6.1.1.3.2" xref="S3.SS2.p1.6.m6.1.1.3.2.cmml">𝒞</mi><mi id="S3.SS2.p1.6.m6.1.1.3.3" xref="S3.SS2.p1.6.m6.1.1.3.3.cmml">b</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><apply id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1"><in id="S3.SS2.p1.6.m6.1.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1.1"></in><ci id="S3.SS2.p1.6.m6.1.1.2.cmml" xref="S3.SS2.p1.6.m6.1.1.2">𝑐</ci><apply id="S3.SS2.p1.6.m6.1.1.3.cmml" xref="S3.SS2.p1.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.1.3.1.cmml" xref="S3.SS2.p1.6.m6.1.1.3">subscript</csymbol><ci id="S3.SS2.p1.6.m6.1.1.3.2.cmml" xref="S3.SS2.p1.6.m6.1.1.3.2">𝒞</ci><ci id="S3.SS2.p1.6.m6.1.1.3.3.cmml" xref="S3.SS2.p1.6.m6.1.1.3.3">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">c\in\mathcal{C}_{b}{}</annotation></semantics></math> from <math id="S3.SS2.p1.7.m7.1" class="ltx_Math" alttext="\mathcal{D}_{b}{}" display="inline"><semantics id="S3.SS2.p1.7.m7.1a"><msub id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.7.m7.1.1.2" xref="S3.SS2.p1.7.m7.1.1.2.cmml">𝒟</mi><mi id="S3.SS2.p1.7.m7.1.1.3" xref="S3.SS2.p1.7.m7.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><apply id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.1.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.p1.7.m7.1.1.2.cmml" xref="S3.SS2.p1.7.m7.1.1.2">𝒟</ci><ci id="S3.SS2.p1.7.m7.1.1.3.cmml" xref="S3.SS2.p1.7.m7.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">\mathcal{D}_{b}{}</annotation></semantics></math> are selected to a subset <math id="S3.SS2.p1.8.m8.1" class="ltx_Math" alttext="\mathcal{D}^{-}_{b}{}" display="inline"><semantics id="S3.SS2.p1.8.m8.1a"><msubsup id="S3.SS2.p1.8.m8.1.1" xref="S3.SS2.p1.8.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.8.m8.1.1.2.2" xref="S3.SS2.p1.8.m8.1.1.2.2.cmml">𝒟</mi><mi id="S3.SS2.p1.8.m8.1.1.3" xref="S3.SS2.p1.8.m8.1.1.3.cmml">b</mi><mo id="S3.SS2.p1.8.m8.1.1.2.3" xref="S3.SS2.p1.8.m8.1.1.2.3.cmml">−</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m8.1b"><apply id="S3.SS2.p1.8.m8.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m8.1.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1">subscript</csymbol><apply id="S3.SS2.p1.8.m8.1.1.2.cmml" xref="S3.SS2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m8.1.1.2.1.cmml" xref="S3.SS2.p1.8.m8.1.1">superscript</csymbol><ci id="S3.SS2.p1.8.m8.1.1.2.2.cmml" xref="S3.SS2.p1.8.m8.1.1.2.2">𝒟</ci><minus id="S3.SS2.p1.8.m8.1.1.2.3.cmml" xref="S3.SS2.p1.8.m8.1.1.2.3"></minus></apply><ci id="S3.SS2.p1.8.m8.1.1.3.cmml" xref="S3.SS2.p1.8.m8.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m8.1c">\mathcal{D}^{-}_{b}{}</annotation></semantics></math>. The detector is fine-tuned on <math id="S3.SS2.p1.9.m9.1" class="ltx_Math" alttext="\mathcal{D}^{-}_{b}{}\cup\mathcal{D}_{n}{}" display="inline"><semantics id="S3.SS2.p1.9.m9.1a"><mrow id="S3.SS2.p1.9.m9.1.1" xref="S3.SS2.p1.9.m9.1.1.cmml"><msubsup id="S3.SS2.p1.9.m9.1.1.2" xref="S3.SS2.p1.9.m9.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.9.m9.1.1.2.2.2" xref="S3.SS2.p1.9.m9.1.1.2.2.2.cmml">𝒟</mi><mi id="S3.SS2.p1.9.m9.1.1.2.3" xref="S3.SS2.p1.9.m9.1.1.2.3.cmml">b</mi><mo id="S3.SS2.p1.9.m9.1.1.2.2.3" xref="S3.SS2.p1.9.m9.1.1.2.2.3.cmml">−</mo></msubsup><mo id="S3.SS2.p1.9.m9.1.1.1" xref="S3.SS2.p1.9.m9.1.1.1.cmml">∪</mo><msub id="S3.SS2.p1.9.m9.1.1.3" xref="S3.SS2.p1.9.m9.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.9.m9.1.1.3.2" xref="S3.SS2.p1.9.m9.1.1.3.2.cmml">𝒟</mi><mi id="S3.SS2.p1.9.m9.1.1.3.3" xref="S3.SS2.p1.9.m9.1.1.3.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m9.1b"><apply id="S3.SS2.p1.9.m9.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1"><union id="S3.SS2.p1.9.m9.1.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1.1"></union><apply id="S3.SS2.p1.9.m9.1.1.2.cmml" xref="S3.SS2.p1.9.m9.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m9.1.1.2.1.cmml" xref="S3.SS2.p1.9.m9.1.1.2">subscript</csymbol><apply id="S3.SS2.p1.9.m9.1.1.2.2.cmml" xref="S3.SS2.p1.9.m9.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m9.1.1.2.2.1.cmml" xref="S3.SS2.p1.9.m9.1.1.2">superscript</csymbol><ci id="S3.SS2.p1.9.m9.1.1.2.2.2.cmml" xref="S3.SS2.p1.9.m9.1.1.2.2.2">𝒟</ci><minus id="S3.SS2.p1.9.m9.1.1.2.2.3.cmml" xref="S3.SS2.p1.9.m9.1.1.2.2.3"></minus></apply><ci id="S3.SS2.p1.9.m9.1.1.2.3.cmml" xref="S3.SS2.p1.9.m9.1.1.2.3">𝑏</ci></apply><apply id="S3.SS2.p1.9.m9.1.1.3.cmml" xref="S3.SS2.p1.9.m9.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m9.1.1.3.1.cmml" xref="S3.SS2.p1.9.m9.1.1.3">subscript</csymbol><ci id="S3.SS2.p1.9.m9.1.1.3.2.cmml" xref="S3.SS2.p1.9.m9.1.1.3.2">𝒟</ci><ci id="S3.SS2.p1.9.m9.1.1.3.3.cmml" xref="S3.SS2.p1.9.m9.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m9.1c">\mathcal{D}^{-}_{b}{}\cup\mathcal{D}_{n}{}</annotation></semantics></math> with balanced training data distribution over <math id="S3.SS2.p1.10.m10.1" class="ltx_Math" alttext="\mathcal{C}_{b}{}\cup\mathcal{C}_{n}{}" display="inline"><semantics id="S3.SS2.p1.10.m10.1a"><mrow id="S3.SS2.p1.10.m10.1.1" xref="S3.SS2.p1.10.m10.1.1.cmml"><msub id="S3.SS2.p1.10.m10.1.1.2" xref="S3.SS2.p1.10.m10.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.10.m10.1.1.2.2" xref="S3.SS2.p1.10.m10.1.1.2.2.cmml">𝒞</mi><mi id="S3.SS2.p1.10.m10.1.1.2.3" xref="S3.SS2.p1.10.m10.1.1.2.3.cmml">b</mi></msub><mo id="S3.SS2.p1.10.m10.1.1.1" xref="S3.SS2.p1.10.m10.1.1.1.cmml">∪</mo><msub id="S3.SS2.p1.10.m10.1.1.3" xref="S3.SS2.p1.10.m10.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.10.m10.1.1.3.2" xref="S3.SS2.p1.10.m10.1.1.3.2.cmml">𝒞</mi><mi id="S3.SS2.p1.10.m10.1.1.3.3" xref="S3.SS2.p1.10.m10.1.1.3.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.m10.1b"><apply id="S3.SS2.p1.10.m10.1.1.cmml" xref="S3.SS2.p1.10.m10.1.1"><union id="S3.SS2.p1.10.m10.1.1.1.cmml" xref="S3.SS2.p1.10.m10.1.1.1"></union><apply id="S3.SS2.p1.10.m10.1.1.2.cmml" xref="S3.SS2.p1.10.m10.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.10.m10.1.1.2.1.cmml" xref="S3.SS2.p1.10.m10.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.10.m10.1.1.2.2.cmml" xref="S3.SS2.p1.10.m10.1.1.2.2">𝒞</ci><ci id="S3.SS2.p1.10.m10.1.1.2.3.cmml" xref="S3.SS2.p1.10.m10.1.1.2.3">𝑏</ci></apply><apply id="S3.SS2.p1.10.m10.1.1.3.cmml" xref="S3.SS2.p1.10.m10.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.10.m10.1.1.3.1.cmml" xref="S3.SS2.p1.10.m10.1.1.3">subscript</csymbol><ci id="S3.SS2.p1.10.m10.1.1.3.2.cmml" xref="S3.SS2.p1.10.m10.1.1.3.2">𝒞</ci><ci id="S3.SS2.p1.10.m10.1.1.3.3.cmml" xref="S3.SS2.p1.10.m10.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.10.m10.1c">\mathcal{C}_{b}{}\cup\mathcal{C}_{n}{}</annotation></semantics></math>. However, for each class, as the training data is extremely limited, overfitting to <math id="S3.SS2.p1.11.m11.1" class="ltx_Math" alttext="\mathcal{D}^{-}_{b}{}" display="inline"><semantics id="S3.SS2.p1.11.m11.1a"><msubsup id="S3.SS2.p1.11.m11.1.1" xref="S3.SS2.p1.11.m11.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.11.m11.1.1.2.2" xref="S3.SS2.p1.11.m11.1.1.2.2.cmml">𝒟</mi><mi id="S3.SS2.p1.11.m11.1.1.3" xref="S3.SS2.p1.11.m11.1.1.3.cmml">b</mi><mo id="S3.SS2.p1.11.m11.1.1.2.3" xref="S3.SS2.p1.11.m11.1.1.2.3.cmml">−</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.11.m11.1b"><apply id="S3.SS2.p1.11.m11.1.1.cmml" xref="S3.SS2.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.11.m11.1.1.1.cmml" xref="S3.SS2.p1.11.m11.1.1">subscript</csymbol><apply id="S3.SS2.p1.11.m11.1.1.2.cmml" xref="S3.SS2.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.11.m11.1.1.2.1.cmml" xref="S3.SS2.p1.11.m11.1.1">superscript</csymbol><ci id="S3.SS2.p1.11.m11.1.1.2.2.cmml" xref="S3.SS2.p1.11.m11.1.1.2.2">𝒟</ci><minus id="S3.SS2.p1.11.m11.1.1.2.3.cmml" xref="S3.SS2.p1.11.m11.1.1.2.3"></minus></apply><ci id="S3.SS2.p1.11.m11.1.1.3.cmml" xref="S3.SS2.p1.11.m11.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.11.m11.1c">\mathcal{D}^{-}_{b}{}</annotation></semantics></math> is unignorable and results in the drop of base detection. As such, Retentive RCNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> proposes to ensemble the detector adapted for <math id="S3.SS2.p1.12.m12.1" class="ltx_Math" alttext="\mathcal{C}_{b}{}\cup\mathcal{C}_{n}{}" display="inline"><semantics id="S3.SS2.p1.12.m12.1a"><mrow id="S3.SS2.p1.12.m12.1.1" xref="S3.SS2.p1.12.m12.1.1.cmml"><msub id="S3.SS2.p1.12.m12.1.1.2" xref="S3.SS2.p1.12.m12.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.12.m12.1.1.2.2" xref="S3.SS2.p1.12.m12.1.1.2.2.cmml">𝒞</mi><mi id="S3.SS2.p1.12.m12.1.1.2.3" xref="S3.SS2.p1.12.m12.1.1.2.3.cmml">b</mi></msub><mo id="S3.SS2.p1.12.m12.1.1.1" xref="S3.SS2.p1.12.m12.1.1.1.cmml">∪</mo><msub id="S3.SS2.p1.12.m12.1.1.3" xref="S3.SS2.p1.12.m12.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.12.m12.1.1.3.2" xref="S3.SS2.p1.12.m12.1.1.3.2.cmml">𝒞</mi><mi id="S3.SS2.p1.12.m12.1.1.3.3" xref="S3.SS2.p1.12.m12.1.1.3.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.12.m12.1b"><apply id="S3.SS2.p1.12.m12.1.1.cmml" xref="S3.SS2.p1.12.m12.1.1"><union id="S3.SS2.p1.12.m12.1.1.1.cmml" xref="S3.SS2.p1.12.m12.1.1.1"></union><apply id="S3.SS2.p1.12.m12.1.1.2.cmml" xref="S3.SS2.p1.12.m12.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.12.m12.1.1.2.1.cmml" xref="S3.SS2.p1.12.m12.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.12.m12.1.1.2.2.cmml" xref="S3.SS2.p1.12.m12.1.1.2.2">𝒞</ci><ci id="S3.SS2.p1.12.m12.1.1.2.3.cmml" xref="S3.SS2.p1.12.m12.1.1.2.3">𝑏</ci></apply><apply id="S3.SS2.p1.12.m12.1.1.3.cmml" xref="S3.SS2.p1.12.m12.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.12.m12.1.1.3.1.cmml" xref="S3.SS2.p1.12.m12.1.1.3">subscript</csymbol><ci id="S3.SS2.p1.12.m12.1.1.3.2.cmml" xref="S3.SS2.p1.12.m12.1.1.3.2">𝒞</ci><ci id="S3.SS2.p1.12.m12.1.1.3.3.cmml" xref="S3.SS2.p1.12.m12.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.12.m12.1c">\mathcal{C}_{b}{}\cup\mathcal{C}_{n}{}</annotation></semantics></math> and the <span id="S3.SS2.p1.13.4" class="ltx_text ltx_font_italic">Base</span> detector by combining their outputs as final prediction. However, the novel detection performance on <math id="S3.SS2.p1.13.m13.1" class="ltx_Math" alttext="\mathcal{C}_{n}{}" display="inline"><semantics id="S3.SS2.p1.13.m13.1a"><msub id="S3.SS2.p1.13.m13.1.1" xref="S3.SS2.p1.13.m13.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.13.m13.1.1.2" xref="S3.SS2.p1.13.m13.1.1.2.cmml">𝒞</mi><mi id="S3.SS2.p1.13.m13.1.1.3" xref="S3.SS2.p1.13.m13.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.13.m13.1b"><apply id="S3.SS2.p1.13.m13.1.1.cmml" xref="S3.SS2.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.13.m13.1.1.1.cmml" xref="S3.SS2.p1.13.m13.1.1">subscript</csymbol><ci id="S3.SS2.p1.13.m13.1.1.2.cmml" xref="S3.SS2.p1.13.m13.1.1.2">𝒞</ci><ci id="S3.SS2.p1.13.m13.1.1.3.cmml" xref="S3.SS2.p1.13.m13.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.13.m13.1c">\mathcal{C}_{n}{}</annotation></semantics></math> is limited.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.3" class="ltx_p">Nevertheless, training among <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{b}{}\cup\mathcal{D}_{n}{}" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><mrow id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><msub id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.1.m1.1.1.2.2" xref="S3.SS2.p2.1.m1.1.1.2.2.cmml">𝒟</mi><mi id="S3.SS2.p2.1.m1.1.1.2.3" xref="S3.SS2.p2.1.m1.1.1.2.3.cmml">b</mi></msub><mo id="S3.SS2.p2.1.m1.1.1.1" xref="S3.SS2.p2.1.m1.1.1.1.cmml">∪</mo><msub id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.1.m1.1.1.3.2" xref="S3.SS2.p2.1.m1.1.1.3.2.cmml">𝒟</mi><mi id="S3.SS2.p2.1.m1.1.1.3.3" xref="S3.SS2.p2.1.m1.1.1.3.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><union id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1"></union><apply id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.2.1.cmml" xref="S3.SS2.p2.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.2.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2.2">𝒟</ci><ci id="S3.SS2.p2.1.m1.1.1.2.3.cmml" xref="S3.SS2.p2.1.m1.1.1.2.3">𝑏</ci></apply><apply id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.3.1.cmml" xref="S3.SS2.p2.1.m1.1.1.3">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.3.2.cmml" xref="S3.SS2.p2.1.m1.1.1.3.2">𝒟</ci><ci id="S3.SS2.p2.1.m1.1.1.3.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">\mathcal{D}_{b}{}\cup\mathcal{D}_{n}{}</annotation></semantics></math> makes the model favor <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="\mathcal{C}_{b}{}" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><msub id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.2.m2.1.1.2" xref="S3.SS2.p2.2.m2.1.1.2.cmml">𝒞</mi><mi id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2">𝒞</ci><ci id="S3.SS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">\mathcal{C}_{b}{}</annotation></semantics></math>. As shown in Fig. <a href="#S5.F3" title="Figure 3 ‣ 5.2 Comparison with FSOD Methods ‣ 5 Experiment ‣ DiGeo: Discriminative Geometry-Aware Learning for Generalized Few-Shot Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>(a), the novel weights <math id="S3.SS2.p2.3.m3.1" class="ltx_Math" alttext="W_{n}" display="inline"><semantics id="S3.SS2.p2.3.m3.1a"><msub id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml"><mi id="S3.SS2.p2.3.m3.1.1.2" xref="S3.SS2.p2.3.m3.1.1.2.cmml">W</mi><mi id="S3.SS2.p2.3.m3.1.1.3" xref="S3.SS2.p2.3.m3.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><apply id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2">𝑊</ci><ci id="S3.SS2.p2.3.m3.1.1.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">W_{n}</annotation></semantics></math> are not well-learned and close to weights of other foreground classes.
With such a classifier, the proposal features (<em id="S3.SS2.p2.3.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S3.SS2.p2.3.2" class="ltx_text"></span>, input feature of classifier) cannot be separated. Thus, as shown in Fig. <a href="#S2.F2" title="Figure 2 ‣ 2 Related Work ‣ DiGeo: Discriminative Geometry-Aware Learning for Generalized Few-Shot Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>(b), we obtain a classifier offline with well-separated weights. For each class, the features are trained to be compact and close to the centers using learnable margins.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Approach</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">Considering the limitations mentioned above, we aim to achieve the best of both worlds using a single model, <em id="S4.p1.1.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S4.p1.1.2" class="ltx_text"></span>, improve the few-shot adaptation performance on novel classes without hurting the precision on base detection. Our motivation is to enhance the discriminative feature learning of detection models, <em id="S4.p1.1.3" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S4.p1.1.4" class="ltx_text"></span>, clear boundaries on the feature space to discriminate all classes. We realize this idea from two aspects, inter-class separation between all classes and intra-class compactness for each class.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Inter-Class Separation</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.2" class="ltx_p">We realize inter-class separation by maximizing the pair-wise distances between class centers. Specifically, for each <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="\mathbf{w}_{i}" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><msub id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml"><mi id="S4.SS1.p1.1.m1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.2.cmml">𝐰</mi><mi id="S4.SS1.p1.1.m1.1.1.3" xref="S4.SS1.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.2">𝐰</ci><ci id="S4.SS1.p1.1.m1.1.1.3.cmml" xref="S4.SS1.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">\mathbf{w}_{i}</annotation></semantics></math>, we maximize its minimum
distance with all other weights <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="W\setminus\{\mathbf{w}_{i}\}" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><mrow id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><mi id="S4.SS1.p1.2.m2.1.1.3" xref="S4.SS1.p1.2.m2.1.1.3.cmml">W</mi><mo id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml">∖</mo><mrow id="S4.SS1.p1.2.m2.1.1.1.1" xref="S4.SS1.p1.2.m2.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS1.p1.2.m2.1.1.1.1.2" xref="S4.SS1.p1.2.m2.1.1.1.2.cmml">{</mo><msub id="S4.SS1.p1.2.m2.1.1.1.1.1" xref="S4.SS1.p1.2.m2.1.1.1.1.1.cmml"><mi id="S4.SS1.p1.2.m2.1.1.1.1.1.2" xref="S4.SS1.p1.2.m2.1.1.1.1.1.2.cmml">𝐰</mi><mi id="S4.SS1.p1.2.m2.1.1.1.1.1.3" xref="S4.SS1.p1.2.m2.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S4.SS1.p1.2.m2.1.1.1.1.3" xref="S4.SS1.p1.2.m2.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"><setdiff id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2"></setdiff><ci id="S4.SS1.p1.2.m2.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3">𝑊</ci><set id="S4.SS1.p1.2.m2.1.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1"><apply id="S4.SS1.p1.2.m2.1.1.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.2.m2.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1.1.2">𝐰</ci><ci id="S4.SS1.p1.2.m2.1.1.1.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1.1.3">𝑖</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">W\setminus\{\mathbf{w}_{i}\}</annotation></semantics></math>:</p>
<table id="S4.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E1.m1.39" class="ltx_Math" alttext="\begin{gathered}W^{*}=\textrm{argmax}_{W}\sum\nolimits^{N_{c}}_{i=1}\min\nolimits_{j,i\neq j}\|\mathbf{w}_{i}-\mathbf{w}_{j}\|_{2}^{2}\\
s.t.~{}\|\mathbf{w}_{i}\|=1,~{}~{}\forall\mathbf{w}_{i}\in W\end{gathered}" display="block"><semantics id="S4.E1.m1.39a"><mtable displaystyle="true" rowspacing="0pt" id="S4.E1.m1.39.39.4"><mtr id="S4.E1.m1.39.39.4a"><mtd id="S4.E1.m1.39.39.4b"><mrow id="S4.E1.m1.38.38.3.36.20.20"><msup id="S4.E1.m1.38.38.3.36.20.20.21"><mi id="S4.E1.m1.1.1.1.1.1.1" xref="S4.E1.m1.1.1.1.1.1.1.cmml">W</mi><mo id="S4.E1.m1.2.2.2.2.2.2.1" xref="S4.E1.m1.2.2.2.2.2.2.1.cmml">∗</mo></msup><mo id="S4.E1.m1.3.3.3.3.3.3" xref="S4.E1.m1.3.3.3.3.3.3.cmml">=</mo><mrow id="S4.E1.m1.38.38.3.36.20.20.20"><msub id="S4.E1.m1.38.38.3.36.20.20.20.3"><mtext id="S4.E1.m1.4.4.4.4.4.4" xref="S4.E1.m1.4.4.4.4.4.4a.cmml">argmax</mtext><mi id="S4.E1.m1.5.5.5.5.5.5.1" xref="S4.E1.m1.5.5.5.5.5.5.1.cmml">W</mi></msub><mo lspace="0em" rspace="0em" id="S4.E1.m1.38.38.3.36.20.20.20.2" xref="S4.E1.m1.37.37.2.3.cmml">​</mo><mrow id="S4.E1.m1.38.38.3.36.20.20.20.1"><msubsup id="S4.E1.m1.38.38.3.36.20.20.20.1.2"><mo id="S4.E1.m1.6.6.6.6.6.6" xref="S4.E1.m1.6.6.6.6.6.6.cmml">∑</mo><mrow id="S4.E1.m1.8.8.8.8.8.8.1" xref="S4.E1.m1.8.8.8.8.8.8.1.cmml"><mi id="S4.E1.m1.8.8.8.8.8.8.1.2" xref="S4.E1.m1.8.8.8.8.8.8.1.2.cmml">i</mi><mo id="S4.E1.m1.8.8.8.8.8.8.1.1" xref="S4.E1.m1.8.8.8.8.8.8.1.1.cmml">=</mo><mn id="S4.E1.m1.8.8.8.8.8.8.1.3" xref="S4.E1.m1.8.8.8.8.8.8.1.3.cmml">1</mn></mrow><msub id="S4.E1.m1.7.7.7.7.7.7.1" xref="S4.E1.m1.7.7.7.7.7.7.1.cmml"><mi id="S4.E1.m1.7.7.7.7.7.7.1.2" xref="S4.E1.m1.7.7.7.7.7.7.1.2.cmml">N</mi><mi id="S4.E1.m1.7.7.7.7.7.7.1.3" xref="S4.E1.m1.7.7.7.7.7.7.1.3.cmml">c</mi></msub></msubsup><mrow id="S4.E1.m1.38.38.3.36.20.20.20.1.1"><msub id="S4.E1.m1.38.38.3.36.20.20.20.1.1.2"><mi id="S4.E1.m1.9.9.9.9.9.9" xref="S4.E1.m1.9.9.9.9.9.9.cmml">min</mi><mrow id="S4.E1.m1.10.10.10.10.10.10.1" xref="S4.E1.m1.10.10.10.10.10.10.1.cmml"><mrow id="S4.E1.m1.10.10.10.10.10.10.1.4.2" xref="S4.E1.m1.10.10.10.10.10.10.1.4.1.cmml"><mi id="S4.E1.m1.10.10.10.10.10.10.1.1" xref="S4.E1.m1.10.10.10.10.10.10.1.1.cmml">j</mi><mo id="S4.E1.m1.10.10.10.10.10.10.1.4.2.1" xref="S4.E1.m1.10.10.10.10.10.10.1.4.1.cmml">,</mo><mi id="S4.E1.m1.10.10.10.10.10.10.1.2" xref="S4.E1.m1.10.10.10.10.10.10.1.2.cmml">i</mi></mrow><mo id="S4.E1.m1.10.10.10.10.10.10.1.3" xref="S4.E1.m1.10.10.10.10.10.10.1.3.cmml">≠</mo><mi id="S4.E1.m1.10.10.10.10.10.10.1.5" xref="S4.E1.m1.10.10.10.10.10.10.1.5.cmml">j</mi></mrow></msub><mo id="S4.E1.m1.38.38.3.36.20.20.20.1.1a" xref="S4.E1.m1.37.37.2.3.cmml">⁡</mo><msubsup id="S4.E1.m1.38.38.3.36.20.20.20.1.1.1"><mrow id="S4.E1.m1.38.38.3.36.20.20.20.1.1.1.1.1.1"><mo stretchy="false" id="S4.E1.m1.11.11.11.11.11.11" xref="S4.E1.m1.37.37.2.3.cmml">‖</mo><mrow id="S4.E1.m1.38.38.3.36.20.20.20.1.1.1.1.1.1.1"><msub id="S4.E1.m1.38.38.3.36.20.20.20.1.1.1.1.1.1.1.1"><mi id="S4.E1.m1.12.12.12.12.12.12" xref="S4.E1.m1.12.12.12.12.12.12.cmml">𝐰</mi><mi id="S4.E1.m1.13.13.13.13.13.13.1" xref="S4.E1.m1.13.13.13.13.13.13.1.cmml">i</mi></msub><mo id="S4.E1.m1.14.14.14.14.14.14" xref="S4.E1.m1.14.14.14.14.14.14.cmml">−</mo><msub id="S4.E1.m1.38.38.3.36.20.20.20.1.1.1.1.1.1.1.2"><mi id="S4.E1.m1.15.15.15.15.15.15" xref="S4.E1.m1.15.15.15.15.15.15.cmml">𝐰</mi><mi id="S4.E1.m1.16.16.16.16.16.16.1" xref="S4.E1.m1.16.16.16.16.16.16.1.cmml">j</mi></msub></mrow><mo stretchy="false" id="S4.E1.m1.17.17.17.17.17.17" xref="S4.E1.m1.37.37.2.3.cmml">‖</mo></mrow><mn id="S4.E1.m1.18.18.18.18.18.18.1" xref="S4.E1.m1.18.18.18.18.18.18.1.cmml">2</mn><mn id="S4.E1.m1.19.19.19.19.19.19.1" xref="S4.E1.m1.19.19.19.19.19.19.1.cmml">2</mn></msubsup></mrow></mrow></mrow></mrow></mtd></mtr><mtr id="S4.E1.m1.39.39.4c"><mtd id="S4.E1.m1.39.39.4d"><mrow id="S4.E1.m1.39.39.4.37.17.17.17"><mi id="S4.E1.m1.20.20.20.1.1.1" xref="S4.E1.m1.20.20.20.1.1.1.cmml">s</mi><mo lspace="0em" rspace="0.167em" id="S4.E1.m1.21.21.21.2.2.2" xref="S4.E1.m1.37.37.2.3.cmml">.</mo><mi id="S4.E1.m1.22.22.22.3.3.3" xref="S4.E1.m1.22.22.22.3.3.3.cmml">t</mi><mo lspace="0em" rspace="0.497em" id="S4.E1.m1.23.23.23.4.4.4" xref="S4.E1.m1.37.37.2.3.cmml">.</mo><mrow id="S4.E1.m1.39.39.4.37.17.17.17.1"><mrow id="S4.E1.m1.39.39.4.37.17.17.17.1.1.1"><mrow id="S4.E1.m1.39.39.4.37.17.17.17.1.1.1.1.1"><mo stretchy="false" id="S4.E1.m1.24.24.24.5.5.5" xref="S4.E1.m1.37.37.2.3.cmml">‖</mo><msub id="S4.E1.m1.39.39.4.37.17.17.17.1.1.1.1.1.1"><mi id="S4.E1.m1.25.25.25.6.6.6" xref="S4.E1.m1.25.25.25.6.6.6.cmml">𝐰</mi><mi id="S4.E1.m1.26.26.26.7.7.7.1" xref="S4.E1.m1.26.26.26.7.7.7.1.cmml">i</mi></msub><mo stretchy="false" id="S4.E1.m1.27.27.27.8.8.8" xref="S4.E1.m1.37.37.2.3.cmml">‖</mo></mrow><mo id="S4.E1.m1.28.28.28.9.9.9" xref="S4.E1.m1.28.28.28.9.9.9.cmml">=</mo><mn id="S4.E1.m1.29.29.29.10.10.10" xref="S4.E1.m1.29.29.29.10.10.10.cmml">1</mn></mrow><mo rspace="0.827em" id="S4.E1.m1.30.30.30.11.11.11" xref="S4.E1.m1.37.37.2.3.cmml">,</mo><mrow id="S4.E1.m1.39.39.4.37.17.17.17.1.2.2"><mrow id="S4.E1.m1.39.39.4.37.17.17.17.1.2.2.1"><mo rspace="0.167em" id="S4.E1.m1.31.31.31.12.12.12" xref="S4.E1.m1.31.31.31.12.12.12.cmml">∀</mo><msub id="S4.E1.m1.39.39.4.37.17.17.17.1.2.2.1.1"><mi id="S4.E1.m1.32.32.32.13.13.13" xref="S4.E1.m1.32.32.32.13.13.13.cmml">𝐰</mi><mi id="S4.E1.m1.33.33.33.14.14.14.1" xref="S4.E1.m1.33.33.33.14.14.14.1.cmml">i</mi></msub></mrow><mo id="S4.E1.m1.34.34.34.15.15.15" xref="S4.E1.m1.34.34.34.15.15.15.cmml">∈</mo><mi id="S4.E1.m1.35.35.35.16.16.16" xref="S4.E1.m1.35.35.35.16.16.16.cmml">W</mi></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.E1.m1.39b"><apply id="S4.E1.m1.37.37.2.3.cmml" xref="S4.E1.m1.38.38.3.36.20.20.20.2"><csymbol cd="ambiguous" id="S4.E1.m1.37.37.2.3a.cmml" xref="S4.E1.m1.38.38.3.36.20.20.20.2">formulae-sequence</csymbol><apply id="S4.E1.m1.36.36.1.1.1.cmml" xref="S4.E1.m1.38.38.3.36.20.20.20.2"><eq id="S4.E1.m1.3.3.3.3.3.3.cmml" xref="S4.E1.m1.3.3.3.3.3.3"></eq><apply id="S4.E1.m1.36.36.1.1.1.3.cmml" xref="S4.E1.m1.38.38.3.36.20.20.20.2"><csymbol cd="ambiguous" id="S4.E1.m1.36.36.1.1.1.3.1.cmml" xref="S4.E1.m1.38.38.3.36.20.20.20.2">superscript</csymbol><ci id="S4.E1.m1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1.1.1">𝑊</ci><times id="S4.E1.m1.2.2.2.2.2.2.1.cmml" xref="S4.E1.m1.2.2.2.2.2.2.1"></times></apply><apply id="S4.E1.m1.36.36.1.1.1.1.cmml" xref="S4.E1.m1.38.38.3.36.20.20.20.2"><times id="S4.E1.m1.36.36.1.1.1.1.2.cmml" xref="S4.E1.m1.38.38.3.36.20.20.20.2"></times><apply id="S4.E1.m1.36.36.1.1.1.1.3.cmml" xref="S4.E1.m1.38.38.3.36.20.20.20.2"><csymbol cd="ambiguous" id="S4.E1.m1.36.36.1.1.1.1.3.1.cmml" xref="S4.E1.m1.38.38.3.36.20.20.20.2">subscript</csymbol><ci id="S4.E1.m1.4.4.4.4.4.4a.cmml" xref="S4.E1.m1.4.4.4.4.4.4"><mtext id="S4.E1.m1.4.4.4.4.4.4.cmml" xref="S4.E1.m1.4.4.4.4.4.4">argmax</mtext></ci><ci id="S4.E1.m1.5.5.5.5.5.5.1.cmml" xref="S4.E1.m1.5.5.5.5.5.5.1">𝑊</ci></apply><apply id="S4.E1.m1.36.36.1.1.1.1.1.cmml" xref="S4.E1.m1.38.38.3.36.20.20.20.2"><apply id="S4.E1.m1.36.36.1.1.1.1.1.2.cmml" xref="S4.E1.m1.38.38.3.36.20.20.20.2"><csymbol cd="ambiguous" id="S4.E1.m1.36.36.1.1.1.1.1.2.1.cmml" xref="S4.E1.m1.38.38.3.36.20.20.20.2">subscript</csymbol><apply id="S4.E1.m1.36.36.1.1.1.1.1.2.2.cmml" xref="S4.E1.m1.38.38.3.36.20.20.20.2"><csymbol cd="ambiguous" id="S4.E1.m1.36.36.1.1.1.1.1.2.2.1.cmml" xref="S4.E1.m1.38.38.3.36.20.20.20.2">superscript</csymbol><sum id="S4.E1.m1.6.6.6.6.6.6.cmml" xref="S4.E1.m1.6.6.6.6.6.6"></sum><apply id="S4.E1.m1.7.7.7.7.7.7.1.cmml" xref="S4.E1.m1.7.7.7.7.7.7.1"><csymbol cd="ambiguous" id="S4.E1.m1.7.7.7.7.7.7.1.1.cmml" xref="S4.E1.m1.7.7.7.7.7.7.1">subscript</csymbol><ci id="S4.E1.m1.7.7.7.7.7.7.1.2.cmml" xref="S4.E1.m1.7.7.7.7.7.7.1.2">𝑁</ci><ci id="S4.E1.m1.7.7.7.7.7.7.1.3.cmml" xref="S4.E1.m1.7.7.7.7.7.7.1.3">𝑐</ci></apply></apply><apply id="S4.E1.m1.8.8.8.8.8.8.1.cmml" xref="S4.E1.m1.8.8.8.8.8.8.1"><eq id="S4.E1.m1.8.8.8.8.8.8.1.1.cmml" xref="S4.E1.m1.8.8.8.8.8.8.1.1"></eq><ci id="S4.E1.m1.8.8.8.8.8.8.1.2.cmml" xref="S4.E1.m1.8.8.8.8.8.8.1.2">𝑖</ci><cn type="integer" id="S4.E1.m1.8.8.8.8.8.8.1.3.cmml" xref="S4.E1.m1.8.8.8.8.8.8.1.3">1</cn></apply></apply><apply id="S4.E1.m1.36.36.1.1.1.1.1.1.cmml" xref="S4.E1.m1.38.38.3.36.20.20.20.2"><apply id="S4.E1.m1.36.36.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.38.38.3.36.20.20.20.2"><csymbol cd="ambiguous" id="S4.E1.m1.36.36.1.1.1.1.1.1.2.1.cmml" xref="S4.E1.m1.38.38.3.36.20.20.20.2">subscript</csymbol><min id="S4.E1.m1.9.9.9.9.9.9.cmml" xref="S4.E1.m1.9.9.9.9.9.9"></min><apply id="S4.E1.m1.10.10.10.10.10.10.1.cmml" xref="S4.E1.m1.10.10.10.10.10.10.1"><neq id="S4.E1.m1.10.10.10.10.10.10.1.3.cmml" xref="S4.E1.m1.10.10.10.10.10.10.1.3"></neq><list id="S4.E1.m1.10.10.10.10.10.10.1.4.1.cmml" xref="S4.E1.m1.10.10.10.10.10.10.1.4.2"><ci id="S4.E1.m1.10.10.10.10.10.10.1.1.cmml" xref="S4.E1.m1.10.10.10.10.10.10.1.1">𝑗</ci><ci id="S4.E1.m1.10.10.10.10.10.10.1.2.cmml" xref="S4.E1.m1.10.10.10.10.10.10.1.2">𝑖</ci></list><ci id="S4.E1.m1.10.10.10.10.10.10.1.5.cmml" xref="S4.E1.m1.10.10.10.10.10.10.1.5">𝑗</ci></apply></apply><apply id="S4.E1.m1.36.36.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.38.38.3.36.20.20.20.2"><times id="S4.E1.m1.36.36.1.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.38.38.3.36.20.20.20.2"></times><apply id="S4.E1.m1.36.36.1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.38.38.3.36.20.20.20.2"><csymbol cd="ambiguous" id="S4.E1.m1.36.36.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.38.38.3.36.20.20.20.2">superscript</csymbol><apply id="S4.E1.m1.36.36.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.38.38.3.36.20.20.20.2"><csymbol cd="ambiguous" id="S4.E1.m1.36.36.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.38.38.3.36.20.20.20.2">subscript</csymbol><apply id="S4.E1.m1.36.36.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.38.38.3.36.20.20.20.2"><csymbol cd="latexml" id="S4.E1.m1.36.36.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E1.m1.38.38.3.36.20.20.20.2">delimited-∥∥</csymbol><apply id="S4.E1.m1.36.36.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.38.38.3.36.20.20.20.2"><minus id="S4.E1.m1.14.14.14.14.14.14.cmml" xref="S4.E1.m1.14.14.14.14.14.14"></minus><apply id="S4.E1.m1.36.36.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.38.38.3.36.20.20.20.2"><csymbol cd="ambiguous" id="S4.E1.m1.36.36.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E1.m1.38.38.3.36.20.20.20.2">subscript</csymbol><ci id="S4.E1.m1.12.12.12.12.12.12.cmml" xref="S4.E1.m1.12.12.12.12.12.12">𝐰</ci><ci id="S4.E1.m1.13.13.13.13.13.13.1.cmml" xref="S4.E1.m1.13.13.13.13.13.13.1">𝑖</ci></apply><apply id="S4.E1.m1.36.36.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E1.m1.38.38.3.36.20.20.20.2"><csymbol cd="ambiguous" id="S4.E1.m1.36.36.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E1.m1.38.38.3.36.20.20.20.2">subscript</csymbol><ci id="S4.E1.m1.15.15.15.15.15.15.cmml" xref="S4.E1.m1.15.15.15.15.15.15">𝐰</ci><ci id="S4.E1.m1.16.16.16.16.16.16.1.cmml" xref="S4.E1.m1.16.16.16.16.16.16.1">𝑗</ci></apply></apply></apply><cn type="integer" id="S4.E1.m1.18.18.18.18.18.18.1.cmml" xref="S4.E1.m1.18.18.18.18.18.18.1">2</cn></apply><cn type="integer" id="S4.E1.m1.19.19.19.19.19.19.1.cmml" xref="S4.E1.m1.19.19.19.19.19.19.1">2</cn></apply><ci id="S4.E1.m1.20.20.20.1.1.1.cmml" xref="S4.E1.m1.20.20.20.1.1.1">𝑠</ci></apply></apply></apply></apply></apply><ci id="S4.E1.m1.22.22.22.3.3.3.cmml" xref="S4.E1.m1.22.22.22.3.3.3">𝑡</ci><apply id="S4.E1.m1.37.37.2.2.2.3.cmml" xref="S4.E1.m1.38.38.3.36.20.20.20.2"><csymbol cd="ambiguous" id="S4.E1.m1.37.37.2.2.2.3a.cmml" xref="S4.E1.m1.38.38.3.36.20.20.20.2">formulae-sequence</csymbol><apply id="S4.E1.m1.37.37.2.2.2.1.1.cmml" xref="S4.E1.m1.38.38.3.36.20.20.20.2"><eq id="S4.E1.m1.28.28.28.9.9.9.cmml" xref="S4.E1.m1.28.28.28.9.9.9"></eq><apply id="S4.E1.m1.37.37.2.2.2.1.1.1.2.cmml" xref="S4.E1.m1.38.38.3.36.20.20.20.2"><csymbol cd="latexml" id="S4.E1.m1.37.37.2.2.2.1.1.1.2.1.cmml" xref="S4.E1.m1.38.38.3.36.20.20.20.2">delimited-∥∥</csymbol><apply id="S4.E1.m1.37.37.2.2.2.1.1.1.1.1.cmml" xref="S4.E1.m1.38.38.3.36.20.20.20.2"><csymbol cd="ambiguous" id="S4.E1.m1.37.37.2.2.2.1.1.1.1.1.1.cmml" xref="S4.E1.m1.38.38.3.36.20.20.20.2">subscript</csymbol><ci id="S4.E1.m1.25.25.25.6.6.6.cmml" xref="S4.E1.m1.25.25.25.6.6.6">𝐰</ci><ci id="S4.E1.m1.26.26.26.7.7.7.1.cmml" xref="S4.E1.m1.26.26.26.7.7.7.1">𝑖</ci></apply></apply><cn type="integer" id="S4.E1.m1.29.29.29.10.10.10.cmml" xref="S4.E1.m1.29.29.29.10.10.10">1</cn></apply><apply id="S4.E1.m1.37.37.2.2.2.2.2.cmml" xref="S4.E1.m1.38.38.3.36.20.20.20.2"><in id="S4.E1.m1.34.34.34.15.15.15.cmml" xref="S4.E1.m1.34.34.34.15.15.15"></in><apply id="S4.E1.m1.37.37.2.2.2.2.2.2.cmml" xref="S4.E1.m1.38.38.3.36.20.20.20.2"><csymbol cd="latexml" id="S4.E1.m1.31.31.31.12.12.12.cmml" xref="S4.E1.m1.31.31.31.12.12.12">for-all</csymbol><apply id="S4.E1.m1.37.37.2.2.2.2.2.2.2.cmml" xref="S4.E1.m1.38.38.3.36.20.20.20.2"><csymbol cd="ambiguous" id="S4.E1.m1.37.37.2.2.2.2.2.2.2.1.cmml" xref="S4.E1.m1.38.38.3.36.20.20.20.2">subscript</csymbol><ci id="S4.E1.m1.32.32.32.13.13.13.cmml" xref="S4.E1.m1.32.32.32.13.13.13">𝐰</ci><ci id="S4.E1.m1.33.33.33.14.14.14.1.cmml" xref="S4.E1.m1.33.33.33.14.14.14.1">𝑖</ci></apply></apply><ci id="S4.E1.m1.35.35.35.16.16.16.cmml" xref="S4.E1.m1.35.35.35.16.16.16">𝑊</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1.m1.39c">\begin{gathered}W^{*}=\textrm{argmax}_{W}\sum\nolimits^{N_{c}}_{i=1}\min\nolimits_{j,i\neq j}\|\mathbf{w}_{i}-\mathbf{w}_{j}\|_{2}^{2}\\
s.t.~{}\|\mathbf{w}_{i}\|=1,~{}~{}\forall\mathbf{w}_{i}\in W\end{gathered}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p1.7" class="ltx_p">where <math id="S4.SS1.p1.3.m1.1" class="ltx_Math" alttext="N_{c}=N_{b}+N_{n}+1" display="inline"><semantics id="S4.SS1.p1.3.m1.1a"><mrow id="S4.SS1.p1.3.m1.1.1" xref="S4.SS1.p1.3.m1.1.1.cmml"><msub id="S4.SS1.p1.3.m1.1.1.2" xref="S4.SS1.p1.3.m1.1.1.2.cmml"><mi id="S4.SS1.p1.3.m1.1.1.2.2" xref="S4.SS1.p1.3.m1.1.1.2.2.cmml">N</mi><mi id="S4.SS1.p1.3.m1.1.1.2.3" xref="S4.SS1.p1.3.m1.1.1.2.3.cmml">c</mi></msub><mo id="S4.SS1.p1.3.m1.1.1.1" xref="S4.SS1.p1.3.m1.1.1.1.cmml">=</mo><mrow id="S4.SS1.p1.3.m1.1.1.3" xref="S4.SS1.p1.3.m1.1.1.3.cmml"><msub id="S4.SS1.p1.3.m1.1.1.3.2" xref="S4.SS1.p1.3.m1.1.1.3.2.cmml"><mi id="S4.SS1.p1.3.m1.1.1.3.2.2" xref="S4.SS1.p1.3.m1.1.1.3.2.2.cmml">N</mi><mi id="S4.SS1.p1.3.m1.1.1.3.2.3" xref="S4.SS1.p1.3.m1.1.1.3.2.3.cmml">b</mi></msub><mo id="S4.SS1.p1.3.m1.1.1.3.1" xref="S4.SS1.p1.3.m1.1.1.3.1.cmml">+</mo><msub id="S4.SS1.p1.3.m1.1.1.3.3" xref="S4.SS1.p1.3.m1.1.1.3.3.cmml"><mi id="S4.SS1.p1.3.m1.1.1.3.3.2" xref="S4.SS1.p1.3.m1.1.1.3.3.2.cmml">N</mi><mi id="S4.SS1.p1.3.m1.1.1.3.3.3" xref="S4.SS1.p1.3.m1.1.1.3.3.3.cmml">n</mi></msub><mo id="S4.SS1.p1.3.m1.1.1.3.1a" xref="S4.SS1.p1.3.m1.1.1.3.1.cmml">+</mo><mn id="S4.SS1.p1.3.m1.1.1.3.4" xref="S4.SS1.p1.3.m1.1.1.3.4.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m1.1b"><apply id="S4.SS1.p1.3.m1.1.1.cmml" xref="S4.SS1.p1.3.m1.1.1"><eq id="S4.SS1.p1.3.m1.1.1.1.cmml" xref="S4.SS1.p1.3.m1.1.1.1"></eq><apply id="S4.SS1.p1.3.m1.1.1.2.cmml" xref="S4.SS1.p1.3.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m1.1.1.2.1.cmml" xref="S4.SS1.p1.3.m1.1.1.2">subscript</csymbol><ci id="S4.SS1.p1.3.m1.1.1.2.2.cmml" xref="S4.SS1.p1.3.m1.1.1.2.2">𝑁</ci><ci id="S4.SS1.p1.3.m1.1.1.2.3.cmml" xref="S4.SS1.p1.3.m1.1.1.2.3">𝑐</ci></apply><apply id="S4.SS1.p1.3.m1.1.1.3.cmml" xref="S4.SS1.p1.3.m1.1.1.3"><plus id="S4.SS1.p1.3.m1.1.1.3.1.cmml" xref="S4.SS1.p1.3.m1.1.1.3.1"></plus><apply id="S4.SS1.p1.3.m1.1.1.3.2.cmml" xref="S4.SS1.p1.3.m1.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m1.1.1.3.2.1.cmml" xref="S4.SS1.p1.3.m1.1.1.3.2">subscript</csymbol><ci id="S4.SS1.p1.3.m1.1.1.3.2.2.cmml" xref="S4.SS1.p1.3.m1.1.1.3.2.2">𝑁</ci><ci id="S4.SS1.p1.3.m1.1.1.3.2.3.cmml" xref="S4.SS1.p1.3.m1.1.1.3.2.3">𝑏</ci></apply><apply id="S4.SS1.p1.3.m1.1.1.3.3.cmml" xref="S4.SS1.p1.3.m1.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m1.1.1.3.3.1.cmml" xref="S4.SS1.p1.3.m1.1.1.3.3">subscript</csymbol><ci id="S4.SS1.p1.3.m1.1.1.3.3.2.cmml" xref="S4.SS1.p1.3.m1.1.1.3.3.2">𝑁</ci><ci id="S4.SS1.p1.3.m1.1.1.3.3.3.cmml" xref="S4.SS1.p1.3.m1.1.1.3.3.3">𝑛</ci></apply><cn type="integer" id="S4.SS1.p1.3.m1.1.1.3.4.cmml" xref="S4.SS1.p1.3.m1.1.1.3.4">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m1.1c">N_{c}=N_{b}+N_{n}+1</annotation></semantics></math> and all weight vectors are of the same norm (<em id="S4.SS1.p1.7.1" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S4.SS1.p1.7.2" class="ltx_text"></span>, 1). When the feature dimension <math id="S4.SS1.p1.4.m2.1" class="ltx_Math" alttext="d\geq N_{c}-1" display="inline"><semantics id="S4.SS1.p1.4.m2.1a"><mrow id="S4.SS1.p1.4.m2.1.1" xref="S4.SS1.p1.4.m2.1.1.cmml"><mi id="S4.SS1.p1.4.m2.1.1.2" xref="S4.SS1.p1.4.m2.1.1.2.cmml">d</mi><mo id="S4.SS1.p1.4.m2.1.1.1" xref="S4.SS1.p1.4.m2.1.1.1.cmml">≥</mo><mrow id="S4.SS1.p1.4.m2.1.1.3" xref="S4.SS1.p1.4.m2.1.1.3.cmml"><msub id="S4.SS1.p1.4.m2.1.1.3.2" xref="S4.SS1.p1.4.m2.1.1.3.2.cmml"><mi id="S4.SS1.p1.4.m2.1.1.3.2.2" xref="S4.SS1.p1.4.m2.1.1.3.2.2.cmml">N</mi><mi id="S4.SS1.p1.4.m2.1.1.3.2.3" xref="S4.SS1.p1.4.m2.1.1.3.2.3.cmml">c</mi></msub><mo id="S4.SS1.p1.4.m2.1.1.3.1" xref="S4.SS1.p1.4.m2.1.1.3.1.cmml">−</mo><mn id="S4.SS1.p1.4.m2.1.1.3.3" xref="S4.SS1.p1.4.m2.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m2.1b"><apply id="S4.SS1.p1.4.m2.1.1.cmml" xref="S4.SS1.p1.4.m2.1.1"><geq id="S4.SS1.p1.4.m2.1.1.1.cmml" xref="S4.SS1.p1.4.m2.1.1.1"></geq><ci id="S4.SS1.p1.4.m2.1.1.2.cmml" xref="S4.SS1.p1.4.m2.1.1.2">𝑑</ci><apply id="S4.SS1.p1.4.m2.1.1.3.cmml" xref="S4.SS1.p1.4.m2.1.1.3"><minus id="S4.SS1.p1.4.m2.1.1.3.1.cmml" xref="S4.SS1.p1.4.m2.1.1.3.1"></minus><apply id="S4.SS1.p1.4.m2.1.1.3.2.cmml" xref="S4.SS1.p1.4.m2.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m2.1.1.3.2.1.cmml" xref="S4.SS1.p1.4.m2.1.1.3.2">subscript</csymbol><ci id="S4.SS1.p1.4.m2.1.1.3.2.2.cmml" xref="S4.SS1.p1.4.m2.1.1.3.2.2">𝑁</ci><ci id="S4.SS1.p1.4.m2.1.1.3.2.3.cmml" xref="S4.SS1.p1.4.m2.1.1.3.2.3">𝑐</ci></apply><cn type="integer" id="S4.SS1.p1.4.m2.1.1.3.3.cmml" xref="S4.SS1.p1.4.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m2.1c">d\geq N_{c}-1</annotation></semantics></math>, the distances of all class center pairs in <math id="S4.SS1.p1.5.m3.1" class="ltx_Math" alttext="W^{*}" display="inline"><semantics id="S4.SS1.p1.5.m3.1a"><msup id="S4.SS1.p1.5.m3.1.1" xref="S4.SS1.p1.5.m3.1.1.cmml"><mi id="S4.SS1.p1.5.m3.1.1.2" xref="S4.SS1.p1.5.m3.1.1.2.cmml">W</mi><mo id="S4.SS1.p1.5.m3.1.1.3" xref="S4.SS1.p1.5.m3.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m3.1b"><apply id="S4.SS1.p1.5.m3.1.1.cmml" xref="S4.SS1.p1.5.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m3.1.1.1.cmml" xref="S4.SS1.p1.5.m3.1.1">superscript</csymbol><ci id="S4.SS1.p1.5.m3.1.1.2.cmml" xref="S4.SS1.p1.5.m3.1.1.2">𝑊</ci><times id="S4.SS1.p1.5.m3.1.1.3.cmml" xref="S4.SS1.p1.5.m3.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m3.1c">W^{*}</annotation></semantics></math> should be the same. Also, the angle between any two of the class centers has the same value given <math id="S4.SS1.p1.6.m4.1" class="ltx_Math" alttext="\|\mathbf{w}_{i}\|=1" display="inline"><semantics id="S4.SS1.p1.6.m4.1a"><mrow id="S4.SS1.p1.6.m4.1.1" xref="S4.SS1.p1.6.m4.1.1.cmml"><mrow id="S4.SS1.p1.6.m4.1.1.1.1" xref="S4.SS1.p1.6.m4.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS1.p1.6.m4.1.1.1.1.2" xref="S4.SS1.p1.6.m4.1.1.1.2.1.cmml">‖</mo><msub id="S4.SS1.p1.6.m4.1.1.1.1.1" xref="S4.SS1.p1.6.m4.1.1.1.1.1.cmml"><mi id="S4.SS1.p1.6.m4.1.1.1.1.1.2" xref="S4.SS1.p1.6.m4.1.1.1.1.1.2.cmml">𝐰</mi><mi id="S4.SS1.p1.6.m4.1.1.1.1.1.3" xref="S4.SS1.p1.6.m4.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S4.SS1.p1.6.m4.1.1.1.1.3" xref="S4.SS1.p1.6.m4.1.1.1.2.1.cmml">‖</mo></mrow><mo id="S4.SS1.p1.6.m4.1.1.2" xref="S4.SS1.p1.6.m4.1.1.2.cmml">=</mo><mn id="S4.SS1.p1.6.m4.1.1.3" xref="S4.SS1.p1.6.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m4.1b"><apply id="S4.SS1.p1.6.m4.1.1.cmml" xref="S4.SS1.p1.6.m4.1.1"><eq id="S4.SS1.p1.6.m4.1.1.2.cmml" xref="S4.SS1.p1.6.m4.1.1.2"></eq><apply id="S4.SS1.p1.6.m4.1.1.1.2.cmml" xref="S4.SS1.p1.6.m4.1.1.1.1"><csymbol cd="latexml" id="S4.SS1.p1.6.m4.1.1.1.2.1.cmml" xref="S4.SS1.p1.6.m4.1.1.1.1.2">norm</csymbol><apply id="S4.SS1.p1.6.m4.1.1.1.1.1.cmml" xref="S4.SS1.p1.6.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.6.m4.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.6.m4.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.6.m4.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.6.m4.1.1.1.1.1.2">𝐰</ci><ci id="S4.SS1.p1.6.m4.1.1.1.1.1.3.cmml" xref="S4.SS1.p1.6.m4.1.1.1.1.1.3">𝑖</ci></apply></apply><cn type="integer" id="S4.SS1.p1.6.m4.1.1.3.cmml" xref="S4.SS1.p1.6.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m4.1c">\|\mathbf{w}_{i}\|=1</annotation></semantics></math>. In this way, we expect the class centers to be evenly distributed in the feature space. In this case, <math id="S4.SS1.p1.7.m5.1" class="ltx_Math" alttext="W^{*}" display="inline"><semantics id="S4.SS1.p1.7.m5.1a"><msup id="S4.SS1.p1.7.m5.1.1" xref="S4.SS1.p1.7.m5.1.1.cmml"><mi id="S4.SS1.p1.7.m5.1.1.2" xref="S4.SS1.p1.7.m5.1.1.2.cmml">W</mi><mo id="S4.SS1.p1.7.m5.1.1.3" xref="S4.SS1.p1.7.m5.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m5.1b"><apply id="S4.SS1.p1.7.m5.1.1.cmml" xref="S4.SS1.p1.7.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.7.m5.1.1.1.cmml" xref="S4.SS1.p1.7.m5.1.1">superscript</csymbol><ci id="S4.SS1.p1.7.m5.1.1.2.cmml" xref="S4.SS1.p1.7.m5.1.1.2">𝑊</ci><times id="S4.SS1.p1.7.m5.1.1.3.cmml" xref="S4.SS1.p1.7.m5.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m5.1c">W^{*}</annotation></semantics></math> is equivalent to simplex equiangular tight frame (ETF) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite>. Furthermore, we have the following theorem for ETF.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para ltx_noindent">
<p id="S4.SS1.p2.3" class="ltx_p"><span id="S4.SS1.p2.3.4" class="ltx_text ltx_font_bold">Theorem</span> <span id="S4.SS1.p2.3.3" class="ltx_text ltx_font_italic">Suppose the vector space is <math id="S4.SS1.p2.1.1.m1.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S4.SS1.p2.1.1.m1.1a"><mi id="S4.SS1.p2.1.1.m1.1.1" xref="S4.SS1.p2.1.1.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.1.m1.1b"><ci id="S4.SS1.p2.1.1.m1.1.1.cmml" xref="S4.SS1.p2.1.1.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.1.m1.1c">d</annotation></semantics></math>-dimensional and the number of vectors is <math id="S4.SS1.p2.2.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.SS1.p2.2.2.m2.1a"><mi id="S4.SS1.p2.2.2.m2.1.1" xref="S4.SS1.p2.2.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.2.m2.1b"><ci id="S4.SS1.p2.2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.2.m2.1c">N</annotation></semantics></math>. When <math id="S4.SS1.p2.3.3.m3.1" class="ltx_Math" alttext="d\geq N-1" display="inline"><semantics id="S4.SS1.p2.3.3.m3.1a"><mrow id="S4.SS1.p2.3.3.m3.1.1" xref="S4.SS1.p2.3.3.m3.1.1.cmml"><mi id="S4.SS1.p2.3.3.m3.1.1.2" xref="S4.SS1.p2.3.3.m3.1.1.2.cmml">d</mi><mo id="S4.SS1.p2.3.3.m3.1.1.1" xref="S4.SS1.p2.3.3.m3.1.1.1.cmml">≥</mo><mrow id="S4.SS1.p2.3.3.m3.1.1.3" xref="S4.SS1.p2.3.3.m3.1.1.3.cmml"><mi id="S4.SS1.p2.3.3.m3.1.1.3.2" xref="S4.SS1.p2.3.3.m3.1.1.3.2.cmml">N</mi><mo id="S4.SS1.p2.3.3.m3.1.1.3.1" xref="S4.SS1.p2.3.3.m3.1.1.3.1.cmml">−</mo><mn id="S4.SS1.p2.3.3.m3.1.1.3.3" xref="S4.SS1.p2.3.3.m3.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.3.m3.1b"><apply id="S4.SS1.p2.3.3.m3.1.1.cmml" xref="S4.SS1.p2.3.3.m3.1.1"><geq id="S4.SS1.p2.3.3.m3.1.1.1.cmml" xref="S4.SS1.p2.3.3.m3.1.1.1"></geq><ci id="S4.SS1.p2.3.3.m3.1.1.2.cmml" xref="S4.SS1.p2.3.3.m3.1.1.2">𝑑</ci><apply id="S4.SS1.p2.3.3.m3.1.1.3.cmml" xref="S4.SS1.p2.3.3.m3.1.1.3"><minus id="S4.SS1.p2.3.3.m3.1.1.3.1.cmml" xref="S4.SS1.p2.3.3.m3.1.1.3.1"></minus><ci id="S4.SS1.p2.3.3.m3.1.1.3.2.cmml" xref="S4.SS1.p2.3.3.m3.1.1.3.2">𝑁</ci><cn type="integer" id="S4.SS1.p2.3.3.m3.1.1.3.3.cmml" xref="S4.SS1.p2.3.3.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.3.m3.1c">d\geq N-1</annotation></semantics></math>, we can always derive a simplex ETF whose vectors are maximally and equally separated from each other.</span></p>
</div>
<div id="S4.SS1.p3" class="ltx_para">
<p id="S4.SS1.p3.5" class="ltx_p">The above theorem guarantees the existence of ETF in application when <math id="S4.SS1.p3.1.m1.1" class="ltx_Math" alttext="d\geq N-1" display="inline"><semantics id="S4.SS1.p3.1.m1.1a"><mrow id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml"><mi id="S4.SS1.p3.1.m1.1.1.2" xref="S4.SS1.p3.1.m1.1.1.2.cmml">d</mi><mo id="S4.SS1.p3.1.m1.1.1.1" xref="S4.SS1.p3.1.m1.1.1.1.cmml">≥</mo><mrow id="S4.SS1.p3.1.m1.1.1.3" xref="S4.SS1.p3.1.m1.1.1.3.cmml"><mi id="S4.SS1.p3.1.m1.1.1.3.2" xref="S4.SS1.p3.1.m1.1.1.3.2.cmml">N</mi><mo id="S4.SS1.p3.1.m1.1.1.3.1" xref="S4.SS1.p3.1.m1.1.1.3.1.cmml">−</mo><mn id="S4.SS1.p3.1.m1.1.1.3.3" xref="S4.SS1.p3.1.m1.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><apply id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1"><geq id="S4.SS1.p3.1.m1.1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1.1"></geq><ci id="S4.SS1.p3.1.m1.1.1.2.cmml" xref="S4.SS1.p3.1.m1.1.1.2">𝑑</ci><apply id="S4.SS1.p3.1.m1.1.1.3.cmml" xref="S4.SS1.p3.1.m1.1.1.3"><minus id="S4.SS1.p3.1.m1.1.1.3.1.cmml" xref="S4.SS1.p3.1.m1.1.1.3.1"></minus><ci id="S4.SS1.p3.1.m1.1.1.3.2.cmml" xref="S4.SS1.p3.1.m1.1.1.3.2">𝑁</ci><cn type="integer" id="S4.SS1.p3.1.m1.1.1.3.3.cmml" xref="S4.SS1.p3.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">d\geq N-1</annotation></semantics></math>. For <math id="S4.SS1.p3.2.m2.1" class="ltx_Math" alttext="d&lt;N_{c}-1" display="inline"><semantics id="S4.SS1.p3.2.m2.1a"><mrow id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml"><mi id="S4.SS1.p3.2.m2.1.1.2" xref="S4.SS1.p3.2.m2.1.1.2.cmml">d</mi><mo id="S4.SS1.p3.2.m2.1.1.1" xref="S4.SS1.p3.2.m2.1.1.1.cmml">&lt;</mo><mrow id="S4.SS1.p3.2.m2.1.1.3" xref="S4.SS1.p3.2.m2.1.1.3.cmml"><msub id="S4.SS1.p3.2.m2.1.1.3.2" xref="S4.SS1.p3.2.m2.1.1.3.2.cmml"><mi id="S4.SS1.p3.2.m2.1.1.3.2.2" xref="S4.SS1.p3.2.m2.1.1.3.2.2.cmml">N</mi><mi id="S4.SS1.p3.2.m2.1.1.3.2.3" xref="S4.SS1.p3.2.m2.1.1.3.2.3.cmml">c</mi></msub><mo id="S4.SS1.p3.2.m2.1.1.3.1" xref="S4.SS1.p3.2.m2.1.1.3.1.cmml">−</mo><mn id="S4.SS1.p3.2.m2.1.1.3.3" xref="S4.SS1.p3.2.m2.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.1b"><apply id="S4.SS1.p3.2.m2.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1"><lt id="S4.SS1.p3.2.m2.1.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1.1"></lt><ci id="S4.SS1.p3.2.m2.1.1.2.cmml" xref="S4.SS1.p3.2.m2.1.1.2">𝑑</ci><apply id="S4.SS1.p3.2.m2.1.1.3.cmml" xref="S4.SS1.p3.2.m2.1.1.3"><minus id="S4.SS1.p3.2.m2.1.1.3.1.cmml" xref="S4.SS1.p3.2.m2.1.1.3.1"></minus><apply id="S4.SS1.p3.2.m2.1.1.3.2.cmml" xref="S4.SS1.p3.2.m2.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS1.p3.2.m2.1.1.3.2.1.cmml" xref="S4.SS1.p3.2.m2.1.1.3.2">subscript</csymbol><ci id="S4.SS1.p3.2.m2.1.1.3.2.2.cmml" xref="S4.SS1.p3.2.m2.1.1.3.2.2">𝑁</ci><ci id="S4.SS1.p3.2.m2.1.1.3.2.3.cmml" xref="S4.SS1.p3.2.m2.1.1.3.2.3">𝑐</ci></apply><cn type="integer" id="S4.SS1.p3.2.m2.1.1.3.3.cmml" xref="S4.SS1.p3.2.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.1c">d&lt;N_{c}-1</annotation></semantics></math>, <em id="S4.SS1.p3.5.1" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S4.SS1.p3.5.2" class="ltx_text"></span>, the number of classes is large while the feature dimension is compact, we can project the <math id="S4.SS1.p3.3.m3.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S4.SS1.p3.3.m3.1a"><mi id="S4.SS1.p3.3.m3.1.1" xref="S4.SS1.p3.3.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.3.m3.1b"><ci id="S4.SS1.p3.3.m3.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.3.m3.1c">d</annotation></semantics></math>-dim feature to a <math id="S4.SS1.p3.4.m4.1" class="ltx_Math" alttext="d^{\prime}" display="inline"><semantics id="S4.SS1.p3.4.m4.1a"><msup id="S4.SS1.p3.4.m4.1.1" xref="S4.SS1.p3.4.m4.1.1.cmml"><mi id="S4.SS1.p3.4.m4.1.1.2" xref="S4.SS1.p3.4.m4.1.1.2.cmml">d</mi><mo id="S4.SS1.p3.4.m4.1.1.3" xref="S4.SS1.p3.4.m4.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.4.m4.1b"><apply id="S4.SS1.p3.4.m4.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.4.m4.1.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1">superscript</csymbol><ci id="S4.SS1.p3.4.m4.1.1.2.cmml" xref="S4.SS1.p3.4.m4.1.1.2">𝑑</ci><ci id="S4.SS1.p3.4.m4.1.1.3.cmml" xref="S4.SS1.p3.4.m4.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.4.m4.1c">d^{\prime}</annotation></semantics></math>-space space with <math id="S4.SS1.p3.5.m5.1" class="ltx_Math" alttext="d^{\prime}\geq N_{c}-1" display="inline"><semantics id="S4.SS1.p3.5.m5.1a"><mrow id="S4.SS1.p3.5.m5.1.1" xref="S4.SS1.p3.5.m5.1.1.cmml"><msup id="S4.SS1.p3.5.m5.1.1.2" xref="S4.SS1.p3.5.m5.1.1.2.cmml"><mi id="S4.SS1.p3.5.m5.1.1.2.2" xref="S4.SS1.p3.5.m5.1.1.2.2.cmml">d</mi><mo id="S4.SS1.p3.5.m5.1.1.2.3" xref="S4.SS1.p3.5.m5.1.1.2.3.cmml">′</mo></msup><mo id="S4.SS1.p3.5.m5.1.1.1" xref="S4.SS1.p3.5.m5.1.1.1.cmml">≥</mo><mrow id="S4.SS1.p3.5.m5.1.1.3" xref="S4.SS1.p3.5.m5.1.1.3.cmml"><msub id="S4.SS1.p3.5.m5.1.1.3.2" xref="S4.SS1.p3.5.m5.1.1.3.2.cmml"><mi id="S4.SS1.p3.5.m5.1.1.3.2.2" xref="S4.SS1.p3.5.m5.1.1.3.2.2.cmml">N</mi><mi id="S4.SS1.p3.5.m5.1.1.3.2.3" xref="S4.SS1.p3.5.m5.1.1.3.2.3.cmml">c</mi></msub><mo id="S4.SS1.p3.5.m5.1.1.3.1" xref="S4.SS1.p3.5.m5.1.1.3.1.cmml">−</mo><mn id="S4.SS1.p3.5.m5.1.1.3.3" xref="S4.SS1.p3.5.m5.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.5.m5.1b"><apply id="S4.SS1.p3.5.m5.1.1.cmml" xref="S4.SS1.p3.5.m5.1.1"><geq id="S4.SS1.p3.5.m5.1.1.1.cmml" xref="S4.SS1.p3.5.m5.1.1.1"></geq><apply id="S4.SS1.p3.5.m5.1.1.2.cmml" xref="S4.SS1.p3.5.m5.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p3.5.m5.1.1.2.1.cmml" xref="S4.SS1.p3.5.m5.1.1.2">superscript</csymbol><ci id="S4.SS1.p3.5.m5.1.1.2.2.cmml" xref="S4.SS1.p3.5.m5.1.1.2.2">𝑑</ci><ci id="S4.SS1.p3.5.m5.1.1.2.3.cmml" xref="S4.SS1.p3.5.m5.1.1.2.3">′</ci></apply><apply id="S4.SS1.p3.5.m5.1.1.3.cmml" xref="S4.SS1.p3.5.m5.1.1.3"><minus id="S4.SS1.p3.5.m5.1.1.3.1.cmml" xref="S4.SS1.p3.5.m5.1.1.3.1"></minus><apply id="S4.SS1.p3.5.m5.1.1.3.2.cmml" xref="S4.SS1.p3.5.m5.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS1.p3.5.m5.1.1.3.2.1.cmml" xref="S4.SS1.p3.5.m5.1.1.3.2">subscript</csymbol><ci id="S4.SS1.p3.5.m5.1.1.3.2.2.cmml" xref="S4.SS1.p3.5.m5.1.1.3.2.2">𝑁</ci><ci id="S4.SS1.p3.5.m5.1.1.3.2.3.cmml" xref="S4.SS1.p3.5.m5.1.1.3.2.3">𝑐</ci></apply><cn type="integer" id="S4.SS1.p3.5.m5.1.1.3.3.cmml" xref="S4.SS1.p3.5.m5.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.5.m5.1c">d^{\prime}\geq N_{c}-1</annotation></semantics></math>. Then, we can always obtain a Simplex ETF classifier in the mapped feature space.</p>
</div>
<div id="S4.SS1.p4" class="ltx_para">
<p id="S4.SS1.p4.1" class="ltx_p">We have two options to obtain the Simplex ETF classifier. The <em id="S4.SS1.p4.1.1" class="ltx_emph ltx_font_italic">online</em> solution is to use Eq. (<a href="#S4.E1" title="Equation 1 ‣ 4.1 Inter-Class Separation ‣ 4 Approach ‣ DiGeo: Discriminative Geometry-Aware Learning for Generalized Few-Shot Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) as a regularization loss to learn the classifier during training. The <em id="S4.SS1.p4.1.2" class="ltx_emph ltx_font_italic">offline</em> solution is to manually set the Simplex ETF classifier for all classes <math id="S4.SS1.p4.1.m1.1" class="ltx_Math" alttext="\mathcal{C}=\mathcal{C}_{b}{}\cup\mathcal{C}_{n}{}\cup\{c_{-}{}\}" display="inline"><semantics id="S4.SS1.p4.1.m1.1a"><mrow id="S4.SS1.p4.1.m1.1.1" xref="S4.SS1.p4.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p4.1.m1.1.1.3" xref="S4.SS1.p4.1.m1.1.1.3.cmml">𝒞</mi><mo id="S4.SS1.p4.1.m1.1.1.2" xref="S4.SS1.p4.1.m1.1.1.2.cmml">=</mo><mrow id="S4.SS1.p4.1.m1.1.1.1" xref="S4.SS1.p4.1.m1.1.1.1.cmml"><msub id="S4.SS1.p4.1.m1.1.1.1.3" xref="S4.SS1.p4.1.m1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p4.1.m1.1.1.1.3.2" xref="S4.SS1.p4.1.m1.1.1.1.3.2.cmml">𝒞</mi><mi id="S4.SS1.p4.1.m1.1.1.1.3.3" xref="S4.SS1.p4.1.m1.1.1.1.3.3.cmml">b</mi></msub><mo id="S4.SS1.p4.1.m1.1.1.1.2" xref="S4.SS1.p4.1.m1.1.1.1.2.cmml">∪</mo><msub id="S4.SS1.p4.1.m1.1.1.1.4" xref="S4.SS1.p4.1.m1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p4.1.m1.1.1.1.4.2" xref="S4.SS1.p4.1.m1.1.1.1.4.2.cmml">𝒞</mi><mi id="S4.SS1.p4.1.m1.1.1.1.4.3" xref="S4.SS1.p4.1.m1.1.1.1.4.3.cmml">n</mi></msub><mo id="S4.SS1.p4.1.m1.1.1.1.2a" xref="S4.SS1.p4.1.m1.1.1.1.2.cmml">∪</mo><mrow id="S4.SS1.p4.1.m1.1.1.1.1.1" xref="S4.SS1.p4.1.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS1.p4.1.m1.1.1.1.1.1.2" xref="S4.SS1.p4.1.m1.1.1.1.1.2.cmml">{</mo><msub id="S4.SS1.p4.1.m1.1.1.1.1.1.1" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p4.1.m1.1.1.1.1.1.1.2" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.2.cmml">c</mi><mo id="S4.SS1.p4.1.m1.1.1.1.1.1.1.3" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.3.cmml">−</mo></msub><mo stretchy="false" id="S4.SS1.p4.1.m1.1.1.1.1.1.3" xref="S4.SS1.p4.1.m1.1.1.1.1.2.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.1.m1.1b"><apply id="S4.SS1.p4.1.m1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1"><eq id="S4.SS1.p4.1.m1.1.1.2.cmml" xref="S4.SS1.p4.1.m1.1.1.2"></eq><ci id="S4.SS1.p4.1.m1.1.1.3.cmml" xref="S4.SS1.p4.1.m1.1.1.3">𝒞</ci><apply id="S4.SS1.p4.1.m1.1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1.1"><union id="S4.SS1.p4.1.m1.1.1.1.2.cmml" xref="S4.SS1.p4.1.m1.1.1.1.2"></union><apply id="S4.SS1.p4.1.m1.1.1.1.3.cmml" xref="S4.SS1.p4.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p4.1.m1.1.1.1.3.1.cmml" xref="S4.SS1.p4.1.m1.1.1.1.3">subscript</csymbol><ci id="S4.SS1.p4.1.m1.1.1.1.3.2.cmml" xref="S4.SS1.p4.1.m1.1.1.1.3.2">𝒞</ci><ci id="S4.SS1.p4.1.m1.1.1.1.3.3.cmml" xref="S4.SS1.p4.1.m1.1.1.1.3.3">𝑏</ci></apply><apply id="S4.SS1.p4.1.m1.1.1.1.4.cmml" xref="S4.SS1.p4.1.m1.1.1.1.4"><csymbol cd="ambiguous" id="S4.SS1.p4.1.m1.1.1.1.4.1.cmml" xref="S4.SS1.p4.1.m1.1.1.1.4">subscript</csymbol><ci id="S4.SS1.p4.1.m1.1.1.1.4.2.cmml" xref="S4.SS1.p4.1.m1.1.1.1.4.2">𝒞</ci><ci id="S4.SS1.p4.1.m1.1.1.1.4.3.cmml" xref="S4.SS1.p4.1.m1.1.1.1.4.3">𝑛</ci></apply><set id="S4.SS1.p4.1.m1.1.1.1.1.2.cmml" xref="S4.SS1.p4.1.m1.1.1.1.1.1"><apply id="S4.SS1.p4.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.1.m1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p4.1.m1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.2">𝑐</ci><minus id="S4.SS1.p4.1.m1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.3"></minus></apply></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.1.m1.1c">\mathcal{C}=\mathcal{C}_{b}{}\cup\mathcal{C}_{n}{}\cup\{c_{-}{}\}</annotation></semantics></math> and fix it during training. We experimentally find the offline solution is more stable and better than the online solution (details discussed in Sec. <a href="#S5.SS4" title="5.4 Analysis of Intra-Class Compactness ‣ 5 Experiment ‣ DiGeo: Discriminative Geometry-Aware Learning for Generalized Few-Shot Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.4</span></a>) and thus use the offline solution in implementation.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Intra-Class Compactness</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.2" class="ltx_p">We realize intra-class compactness by tightening the clusters of features and push the samples close to the assigned center in <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="W^{*}" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><msup id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><mi id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml">W</mi><mo id="S4.SS2.p1.1.m1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">superscript</csymbol><ci id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2">𝑊</ci><times id="S4.SS2.p1.1.m1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">W^{*}</annotation></semantics></math>. The challenges are two folds. First, the number of training samples in base and novel classes extremely are imbalanced, which makes it hard to determine the boundaries of novel classes in the feature space. Second, as the number of novel classes is much smaller than that of base classes, <em id="S4.SS2.p1.2.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S4.SS2.p1.2.2" class="ltx_text"></span>, <math id="S4.SS2.p1.2.m2.2" class="ltx_Math" alttext="|\mathcal{D}_{n}{}|\ll|\mathcal{D}_{b}{}|" display="inline"><semantics id="S4.SS2.p1.2.m2.2a"><mrow id="S4.SS2.p1.2.m2.2.2" xref="S4.SS2.p1.2.m2.2.2.cmml"><mrow id="S4.SS2.p1.2.m2.1.1.1.1" xref="S4.SS2.p1.2.m2.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS2.p1.2.m2.1.1.1.1.2" xref="S4.SS2.p1.2.m2.1.1.1.2.1.cmml">|</mo><msub id="S4.SS2.p1.2.m2.1.1.1.1.1" xref="S4.SS2.p1.2.m2.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.2.m2.1.1.1.1.1.2" xref="S4.SS2.p1.2.m2.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S4.SS2.p1.2.m2.1.1.1.1.1.3" xref="S4.SS2.p1.2.m2.1.1.1.1.1.3.cmml">n</mi></msub><mo stretchy="false" id="S4.SS2.p1.2.m2.1.1.1.1.3" xref="S4.SS2.p1.2.m2.1.1.1.2.1.cmml">|</mo></mrow><mo id="S4.SS2.p1.2.m2.2.2.3" xref="S4.SS2.p1.2.m2.2.2.3.cmml">≪</mo><mrow id="S4.SS2.p1.2.m2.2.2.2.1" xref="S4.SS2.p1.2.m2.2.2.2.2.cmml"><mo stretchy="false" id="S4.SS2.p1.2.m2.2.2.2.1.2" xref="S4.SS2.p1.2.m2.2.2.2.2.1.cmml">|</mo><msub id="S4.SS2.p1.2.m2.2.2.2.1.1" xref="S4.SS2.p1.2.m2.2.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.2.m2.2.2.2.1.1.2" xref="S4.SS2.p1.2.m2.2.2.2.1.1.2.cmml">𝒟</mi><mi id="S4.SS2.p1.2.m2.2.2.2.1.1.3" xref="S4.SS2.p1.2.m2.2.2.2.1.1.3.cmml">b</mi></msub><mo stretchy="false" id="S4.SS2.p1.2.m2.2.2.2.1.3" xref="S4.SS2.p1.2.m2.2.2.2.2.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.2b"><apply id="S4.SS2.p1.2.m2.2.2.cmml" xref="S4.SS2.p1.2.m2.2.2"><csymbol cd="latexml" id="S4.SS2.p1.2.m2.2.2.3.cmml" xref="S4.SS2.p1.2.m2.2.2.3">much-less-than</csymbol><apply id="S4.SS2.p1.2.m2.1.1.1.2.cmml" xref="S4.SS2.p1.2.m2.1.1.1.1"><abs id="S4.SS2.p1.2.m2.1.1.1.2.1.cmml" xref="S4.SS2.p1.2.m2.1.1.1.1.2"></abs><apply id="S4.SS2.p1.2.m2.1.1.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p1.2.m2.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.2.m2.1.1.1.1.1.2">𝒟</ci><ci id="S4.SS2.p1.2.m2.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.2.m2.1.1.1.1.1.3">𝑛</ci></apply></apply><apply id="S4.SS2.p1.2.m2.2.2.2.2.cmml" xref="S4.SS2.p1.2.m2.2.2.2.1"><abs id="S4.SS2.p1.2.m2.2.2.2.2.1.cmml" xref="S4.SS2.p1.2.m2.2.2.2.1.2"></abs><apply id="S4.SS2.p1.2.m2.2.2.2.1.1.cmml" xref="S4.SS2.p1.2.m2.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.2.2.2.1.1.1.cmml" xref="S4.SS2.p1.2.m2.2.2.2.1.1">subscript</csymbol><ci id="S4.SS2.p1.2.m2.2.2.2.1.1.2.cmml" xref="S4.SS2.p1.2.m2.2.2.2.1.1.2">𝒟</ci><ci id="S4.SS2.p1.2.m2.2.2.2.1.1.3.cmml" xref="S4.SS2.p1.2.m2.2.2.2.1.1.3">𝑏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.2c">|\mathcal{D}_{n}{}|\ll|\mathcal{D}_{b}{}|</annotation></semantics></math>, the network receives less positive gradients for novel classes <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib54" title="" class="ltx_ref">54</a>]</cite>, which makes the features of instances in novel classes farther to the class centers and thus less discriminative.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">Inspired by the success of logit adjustment in long-tailed recognition <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>, we apply class-specific margins on logits to modify the classification loss and balance the optimization between base and novel classes. Specifically, we calculate the class-specific margins based on the frequencies of instance (<em id="S4.SS2.p2.1.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S4.SS2.p2.1.2" class="ltx_text"></span>, bounding box annotations) as priors:</p>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<table id="S4.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E2.m1.5" class="ltx_Math" alttext="m_{c}=\begin{cases}-\log(p_{c})&amp;\text{, if $c\in\mathcal{C}_{b}{}\cup\mathcal{C}_{n}{}$}\\
-\log(p_{-})&amp;\text{, if $c=c_{-}{}$}\\
\end{cases}," display="block"><semantics id="S4.E2.m1.5a"><mrow id="S4.E2.m1.5.5.1" xref="S4.E2.m1.5.5.1.1.cmml"><mrow id="S4.E2.m1.5.5.1.1" xref="S4.E2.m1.5.5.1.1.cmml"><msub id="S4.E2.m1.5.5.1.1.2" xref="S4.E2.m1.5.5.1.1.2.cmml"><mi id="S4.E2.m1.5.5.1.1.2.2" xref="S4.E2.m1.5.5.1.1.2.2.cmml">m</mi><mi id="S4.E2.m1.5.5.1.1.2.3" xref="S4.E2.m1.5.5.1.1.2.3.cmml">c</mi></msub><mo id="S4.E2.m1.5.5.1.1.1" xref="S4.E2.m1.5.5.1.1.1.cmml">=</mo><mrow id="S4.E2.m1.4.4" xref="S4.E2.m1.5.5.1.1.3.1.cmml"><mo id="S4.E2.m1.4.4.5" xref="S4.E2.m1.5.5.1.1.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt" id="S4.E2.m1.4.4.4" xref="S4.E2.m1.5.5.1.1.3.1.cmml"><mtr id="S4.E2.m1.4.4.4a" xref="S4.E2.m1.5.5.1.1.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E2.m1.4.4.4b" xref="S4.E2.m1.5.5.1.1.3.1.cmml"><mrow id="S4.E2.m1.3.3.3.3.2.1" xref="S4.E2.m1.3.3.3.3.2.1.cmml"><mo rspace="0.167em" id="S4.E2.m1.3.3.3.3.2.1a" xref="S4.E2.m1.3.3.3.3.2.1.cmml">−</mo><mrow id="S4.E2.m1.3.3.3.3.2.1.2.1" xref="S4.E2.m1.3.3.3.3.2.1.2.2.cmml"><mi id="S4.E2.m1.3.3.3.3.2.1.1" xref="S4.E2.m1.3.3.3.3.2.1.1.cmml">log</mi><mo id="S4.E2.m1.3.3.3.3.2.1.2.1a" xref="S4.E2.m1.3.3.3.3.2.1.2.2.cmml">⁡</mo><mrow id="S4.E2.m1.3.3.3.3.2.1.2.1.1" xref="S4.E2.m1.3.3.3.3.2.1.2.2.cmml"><mo stretchy="false" id="S4.E2.m1.3.3.3.3.2.1.2.1.1.2" xref="S4.E2.m1.3.3.3.3.2.1.2.2.cmml">(</mo><msub id="S4.E2.m1.3.3.3.3.2.1.2.1.1.1" xref="S4.E2.m1.3.3.3.3.2.1.2.1.1.1.cmml"><mi id="S4.E2.m1.3.3.3.3.2.1.2.1.1.1.2" xref="S4.E2.m1.3.3.3.3.2.1.2.1.1.1.2.cmml">p</mi><mi id="S4.E2.m1.3.3.3.3.2.1.2.1.1.1.3" xref="S4.E2.m1.3.3.3.3.2.1.2.1.1.1.3.cmml">c</mi></msub><mo stretchy="false" id="S4.E2.m1.3.3.3.3.2.1.2.1.1.3" xref="S4.E2.m1.3.3.3.3.2.1.2.2.cmml">)</mo></mrow></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E2.m1.4.4.4c" xref="S4.E2.m1.5.5.1.1.3.1.cmml"><mrow id="S4.E2.m1.1.1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.1.1b.cmml"><mtext id="S4.E2.m1.1.1.1.1.1.1a" xref="S4.E2.m1.1.1.1.1.1.1b.cmml">, if </mtext><mrow id="S4.E2.m1.1.1.1.1.1.1.1.1.m1.1.1" xref="S4.E2.m1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi id="S4.E2.m1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S4.E2.m1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">c</mi><mo id="S4.E2.m1.1.1.1.1.1.1.1.1.m1.1.1.1" xref="S4.E2.m1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml">∈</mo><mrow id="S4.E2.m1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S4.E2.m1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml"><msub id="S4.E2.m1.1.1.1.1.1.1.1.1.m1.1.1.3.2" xref="S4.E2.m1.1.1.1.1.1.1.1.1.m1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E2.m1.1.1.1.1.1.1.1.1.m1.1.1.3.2.2" xref="S4.E2.m1.1.1.1.1.1.1.1.1.m1.1.1.3.2.2.cmml">𝒞</mi><mi id="S4.E2.m1.1.1.1.1.1.1.1.1.m1.1.1.3.2.3" xref="S4.E2.m1.1.1.1.1.1.1.1.1.m1.1.1.3.2.3.cmml">b</mi></msub><mo id="S4.E2.m1.1.1.1.1.1.1.1.1.m1.1.1.3.1" xref="S4.E2.m1.1.1.1.1.1.1.1.1.m1.1.1.3.1.cmml">∪</mo><msub id="S4.E2.m1.1.1.1.1.1.1.1.1.m1.1.1.3.3" xref="S4.E2.m1.1.1.1.1.1.1.1.1.m1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E2.m1.1.1.1.1.1.1.1.1.m1.1.1.3.3.2" xref="S4.E2.m1.1.1.1.1.1.1.1.1.m1.1.1.3.3.2.cmml">𝒞</mi><mi id="S4.E2.m1.1.1.1.1.1.1.1.1.m1.1.1.3.3.3" xref="S4.E2.m1.1.1.1.1.1.1.1.1.m1.1.1.3.3.3.cmml">n</mi></msub></mrow></mrow></mrow></mtd></mtr><mtr id="S4.E2.m1.4.4.4d" xref="S4.E2.m1.5.5.1.1.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E2.m1.4.4.4e" xref="S4.E2.m1.5.5.1.1.3.1.cmml"><mrow id="S4.E2.m1.4.4.4.4.2.1" xref="S4.E2.m1.4.4.4.4.2.1.cmml"><mo rspace="0.167em" id="S4.E2.m1.4.4.4.4.2.1a" xref="S4.E2.m1.4.4.4.4.2.1.cmml">−</mo><mrow id="S4.E2.m1.4.4.4.4.2.1.2.1" xref="S4.E2.m1.4.4.4.4.2.1.2.2.cmml"><mi id="S4.E2.m1.4.4.4.4.2.1.1" xref="S4.E2.m1.4.4.4.4.2.1.1.cmml">log</mi><mo id="S4.E2.m1.4.4.4.4.2.1.2.1a" xref="S4.E2.m1.4.4.4.4.2.1.2.2.cmml">⁡</mo><mrow id="S4.E2.m1.4.4.4.4.2.1.2.1.1" xref="S4.E2.m1.4.4.4.4.2.1.2.2.cmml"><mo stretchy="false" id="S4.E2.m1.4.4.4.4.2.1.2.1.1.2" xref="S4.E2.m1.4.4.4.4.2.1.2.2.cmml">(</mo><msub id="S4.E2.m1.4.4.4.4.2.1.2.1.1.1" xref="S4.E2.m1.4.4.4.4.2.1.2.1.1.1.cmml"><mi id="S4.E2.m1.4.4.4.4.2.1.2.1.1.1.2" xref="S4.E2.m1.4.4.4.4.2.1.2.1.1.1.2.cmml">p</mi><mo id="S4.E2.m1.4.4.4.4.2.1.2.1.1.1.3" xref="S4.E2.m1.4.4.4.4.2.1.2.1.1.1.3.cmml">−</mo></msub><mo stretchy="false" id="S4.E2.m1.4.4.4.4.2.1.2.1.1.3" xref="S4.E2.m1.4.4.4.4.2.1.2.2.cmml">)</mo></mrow></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E2.m1.4.4.4f" xref="S4.E2.m1.5.5.1.1.3.1.cmml"><mrow id="S4.E2.m1.2.2.2.2.1.1" xref="S4.E2.m1.2.2.2.2.1.1b.cmml"><mtext id="S4.E2.m1.2.2.2.2.1.1a" xref="S4.E2.m1.2.2.2.2.1.1b.cmml">, if </mtext><mrow id="S4.E2.m1.2.2.2.2.1.1.1.1.m1.1.1" xref="S4.E2.m1.2.2.2.2.1.1.1.1.m1.1.1.cmml"><mi id="S4.E2.m1.2.2.2.2.1.1.1.1.m1.1.1.2" xref="S4.E2.m1.2.2.2.2.1.1.1.1.m1.1.1.2.cmml">c</mi><mo id="S4.E2.m1.2.2.2.2.1.1.1.1.m1.1.1.1" xref="S4.E2.m1.2.2.2.2.1.1.1.1.m1.1.1.1.cmml">=</mo><msub id="S4.E2.m1.2.2.2.2.1.1.1.1.m1.1.1.3" xref="S4.E2.m1.2.2.2.2.1.1.1.1.m1.1.1.3.cmml"><mi id="S4.E2.m1.2.2.2.2.1.1.1.1.m1.1.1.3.2" xref="S4.E2.m1.2.2.2.2.1.1.1.1.m1.1.1.3.2.cmml">c</mi><mo id="S4.E2.m1.2.2.2.2.1.1.1.1.m1.1.1.3.3" xref="S4.E2.m1.2.2.2.2.1.1.1.1.m1.1.1.3.3.cmml">−</mo></msub></mrow></mrow></mtd></mtr></mtable></mrow></mrow><mo id="S4.E2.m1.5.5.1.2" xref="S4.E2.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E2.m1.5b"><apply id="S4.E2.m1.5.5.1.1.cmml" xref="S4.E2.m1.5.5.1"><eq id="S4.E2.m1.5.5.1.1.1.cmml" xref="S4.E2.m1.5.5.1.1.1"></eq><apply id="S4.E2.m1.5.5.1.1.2.cmml" xref="S4.E2.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S4.E2.m1.5.5.1.1.2.1.cmml" xref="S4.E2.m1.5.5.1.1.2">subscript</csymbol><ci id="S4.E2.m1.5.5.1.1.2.2.cmml" xref="S4.E2.m1.5.5.1.1.2.2">𝑚</ci><ci id="S4.E2.m1.5.5.1.1.2.3.cmml" xref="S4.E2.m1.5.5.1.1.2.3">𝑐</ci></apply><apply id="S4.E2.m1.5.5.1.1.3.1.cmml" xref="S4.E2.m1.4.4"><csymbol cd="latexml" id="S4.E2.m1.5.5.1.1.3.1.1.cmml" xref="S4.E2.m1.4.4.5">cases</csymbol><apply id="S4.E2.m1.3.3.3.3.2.1.cmml" xref="S4.E2.m1.3.3.3.3.2.1"><minus id="S4.E2.m1.3.3.3.3.2.1.3.cmml" xref="S4.E2.m1.3.3.3.3.2.1"></minus><apply id="S4.E2.m1.3.3.3.3.2.1.2.2.cmml" xref="S4.E2.m1.3.3.3.3.2.1.2.1"><log id="S4.E2.m1.3.3.3.3.2.1.1.cmml" xref="S4.E2.m1.3.3.3.3.2.1.1"></log><apply id="S4.E2.m1.3.3.3.3.2.1.2.1.1.1.cmml" xref="S4.E2.m1.3.3.3.3.2.1.2.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.3.3.3.3.2.1.2.1.1.1.1.cmml" xref="S4.E2.m1.3.3.3.3.2.1.2.1.1.1">subscript</csymbol><ci id="S4.E2.m1.3.3.3.3.2.1.2.1.1.1.2.cmml" xref="S4.E2.m1.3.3.3.3.2.1.2.1.1.1.2">𝑝</ci><ci id="S4.E2.m1.3.3.3.3.2.1.2.1.1.1.3.cmml" xref="S4.E2.m1.3.3.3.3.2.1.2.1.1.1.3">𝑐</ci></apply></apply></apply><ci id="S4.E2.m1.1.1.1.1.1.1b.cmml" xref="S4.E2.m1.1.1.1.1.1.1"><mrow id="S4.E2.m1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1"><mtext id="S4.E2.m1.1.1.1.1.1.1a.cmml" xref="S4.E2.m1.1.1.1.1.1.1">, if </mtext><mrow id="S4.E2.m1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.m1.1.1"><mi id="S4.E2.m1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.m1.1.1.2">c</mi><mo id="S4.E2.m1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.m1.1.1.1">∈</mo><mrow id="S4.E2.m1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.m1.1.1.3"><msub id="S4.E2.m1.1.1.1.1.1.1.1.1.m1.1.1.3.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.m1.1.1.3.2"><mi class="ltx_font_mathcaligraphic" id="S4.E2.m1.1.1.1.1.1.1.1.1.m1.1.1.3.2.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.m1.1.1.3.2.2">𝒞</mi><mi id="S4.E2.m1.1.1.1.1.1.1.1.1.m1.1.1.3.2.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.m1.1.1.3.2.3">b</mi></msub><mo id="S4.E2.m1.1.1.1.1.1.1.1.1.m1.1.1.3.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.m1.1.1.3.1">∪</mo><msub id="S4.E2.m1.1.1.1.1.1.1.1.1.m1.1.1.3.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.m1.1.1.3.3"><mi class="ltx_font_mathcaligraphic" id="S4.E2.m1.1.1.1.1.1.1.1.1.m1.1.1.3.3.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.m1.1.1.3.3.2">𝒞</mi><mi id="S4.E2.m1.1.1.1.1.1.1.1.1.m1.1.1.3.3.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.m1.1.1.3.3.3">n</mi></msub></mrow></mrow></mrow></ci><apply id="S4.E2.m1.4.4.4.4.2.1.cmml" xref="S4.E2.m1.4.4.4.4.2.1"><minus id="S4.E2.m1.4.4.4.4.2.1.3.cmml" xref="S4.E2.m1.4.4.4.4.2.1"></minus><apply id="S4.E2.m1.4.4.4.4.2.1.2.2.cmml" xref="S4.E2.m1.4.4.4.4.2.1.2.1"><log id="S4.E2.m1.4.4.4.4.2.1.1.cmml" xref="S4.E2.m1.4.4.4.4.2.1.1"></log><apply id="S4.E2.m1.4.4.4.4.2.1.2.1.1.1.cmml" xref="S4.E2.m1.4.4.4.4.2.1.2.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.4.4.4.4.2.1.2.1.1.1.1.cmml" xref="S4.E2.m1.4.4.4.4.2.1.2.1.1.1">subscript</csymbol><ci id="S4.E2.m1.4.4.4.4.2.1.2.1.1.1.2.cmml" xref="S4.E2.m1.4.4.4.4.2.1.2.1.1.1.2">𝑝</ci><minus id="S4.E2.m1.4.4.4.4.2.1.2.1.1.1.3.cmml" xref="S4.E2.m1.4.4.4.4.2.1.2.1.1.1.3"></minus></apply></apply></apply><ci id="S4.E2.m1.2.2.2.2.1.1b.cmml" xref="S4.E2.m1.2.2.2.2.1.1"><mrow id="S4.E2.m1.2.2.2.2.1.1.cmml" xref="S4.E2.m1.2.2.2.2.1.1"><mtext id="S4.E2.m1.2.2.2.2.1.1a.cmml" xref="S4.E2.m1.2.2.2.2.1.1">, if </mtext><mrow id="S4.E2.m1.2.2.2.2.1.1.1.1.m1.1.1.cmml" xref="S4.E2.m1.2.2.2.2.1.1.1.1.m1.1.1"><mi id="S4.E2.m1.2.2.2.2.1.1.1.1.m1.1.1.2.cmml" xref="S4.E2.m1.2.2.2.2.1.1.1.1.m1.1.1.2">c</mi><mo id="S4.E2.m1.2.2.2.2.1.1.1.1.m1.1.1.1.cmml" xref="S4.E2.m1.2.2.2.2.1.1.1.1.m1.1.1.1">=</mo><msub id="S4.E2.m1.2.2.2.2.1.1.1.1.m1.1.1.3.cmml" xref="S4.E2.m1.2.2.2.2.1.1.1.1.m1.1.1.3"><mi id="S4.E2.m1.2.2.2.2.1.1.1.1.m1.1.1.3.2.cmml" xref="S4.E2.m1.2.2.2.2.1.1.1.1.m1.1.1.3.2">c</mi><mo id="S4.E2.m1.2.2.2.2.1.1.1.1.m1.1.1.3.3.cmml" xref="S4.E2.m1.2.2.2.2.1.1.1.1.m1.1.1.3.3">−</mo></msub></mrow></mrow></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.5c">m_{c}=\begin{cases}-\log(p_{c})&amp;\text{, if $c\in\mathcal{C}_{b}{}\cup\mathcal{C}_{n}{}$}\\
-\log(p_{-})&amp;\text{, if $c=c_{-}{}$}\\
\end{cases},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p3.4" class="ltx_p">where <math id="S4.SS2.p3.1.m1.1" class="ltx_Math" alttext="p_{c}" display="inline"><semantics id="S4.SS2.p3.1.m1.1a"><msub id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml"><mi id="S4.SS2.p3.1.m1.1.1.2" xref="S4.SS2.p3.1.m1.1.1.2.cmml">p</mi><mi id="S4.SS2.p3.1.m1.1.1.3" xref="S4.SS2.p3.1.m1.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><apply id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.1.m1.1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p3.1.m1.1.1.2.cmml" xref="S4.SS2.p3.1.m1.1.1.2">𝑝</ci><ci id="S4.SS2.p3.1.m1.1.1.3.cmml" xref="S4.SS2.p3.1.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">p_{c}</annotation></semantics></math> is the frequency of bounding box annotations for class <math id="S4.SS2.p3.2.m2.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S4.SS2.p3.2.m2.1a"><mi id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><ci id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">c</annotation></semantics></math>, and <math id="S4.SS2.p3.3.m3.1" class="ltx_Math" alttext="p_{-}" display="inline"><semantics id="S4.SS2.p3.3.m3.1a"><msub id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml"><mi id="S4.SS2.p3.3.m3.1.1.2" xref="S4.SS2.p3.3.m3.1.1.2.cmml">p</mi><mo id="S4.SS2.p3.3.m3.1.1.3" xref="S4.SS2.p3.3.m3.1.1.3.cmml">−</mo></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.1b"><apply id="S4.SS2.p3.3.m3.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.3.m3.1.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.p3.3.m3.1.1.2.cmml" xref="S4.SS2.p3.3.m3.1.1.2">𝑝</ci><minus id="S4.SS2.p3.3.m3.1.1.3.cmml" xref="S4.SS2.p3.3.m3.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.1c">p_{-}</annotation></semantics></math> is an estimated probability of background boxes to train the classifier, and <math id="S4.SS2.p3.4.m4.1" class="ltx_Math" alttext="p_{-}+\sum_{c\in\mathcal{C}_{b}{}\cup\mathcal{C}_{n}{}}p_{c}=1" display="inline"><semantics id="S4.SS2.p3.4.m4.1a"><mrow id="S4.SS2.p3.4.m4.1.1" xref="S4.SS2.p3.4.m4.1.1.cmml"><mrow id="S4.SS2.p3.4.m4.1.1.2" xref="S4.SS2.p3.4.m4.1.1.2.cmml"><msub id="S4.SS2.p3.4.m4.1.1.2.2" xref="S4.SS2.p3.4.m4.1.1.2.2.cmml"><mi id="S4.SS2.p3.4.m4.1.1.2.2.2" xref="S4.SS2.p3.4.m4.1.1.2.2.2.cmml">p</mi><mo id="S4.SS2.p3.4.m4.1.1.2.2.3" xref="S4.SS2.p3.4.m4.1.1.2.2.3.cmml">−</mo></msub><mo rspace="0.055em" id="S4.SS2.p3.4.m4.1.1.2.1" xref="S4.SS2.p3.4.m4.1.1.2.1.cmml">+</mo><mrow id="S4.SS2.p3.4.m4.1.1.2.3" xref="S4.SS2.p3.4.m4.1.1.2.3.cmml"><msub id="S4.SS2.p3.4.m4.1.1.2.3.1" xref="S4.SS2.p3.4.m4.1.1.2.3.1.cmml"><mo id="S4.SS2.p3.4.m4.1.1.2.3.1.2" xref="S4.SS2.p3.4.m4.1.1.2.3.1.2.cmml">∑</mo><mrow id="S4.SS2.p3.4.m4.1.1.2.3.1.3" xref="S4.SS2.p3.4.m4.1.1.2.3.1.3.cmml"><mi id="S4.SS2.p3.4.m4.1.1.2.3.1.3.2" xref="S4.SS2.p3.4.m4.1.1.2.3.1.3.2.cmml">c</mi><mo id="S4.SS2.p3.4.m4.1.1.2.3.1.3.1" xref="S4.SS2.p3.4.m4.1.1.2.3.1.3.1.cmml">∈</mo><mrow id="S4.SS2.p3.4.m4.1.1.2.3.1.3.3" xref="S4.SS2.p3.4.m4.1.1.2.3.1.3.3.cmml"><msub id="S4.SS2.p3.4.m4.1.1.2.3.1.3.3.2" xref="S4.SS2.p3.4.m4.1.1.2.3.1.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p3.4.m4.1.1.2.3.1.3.3.2.2" xref="S4.SS2.p3.4.m4.1.1.2.3.1.3.3.2.2.cmml">𝒞</mi><mi id="S4.SS2.p3.4.m4.1.1.2.3.1.3.3.2.3" xref="S4.SS2.p3.4.m4.1.1.2.3.1.3.3.2.3.cmml">b</mi></msub><mo id="S4.SS2.p3.4.m4.1.1.2.3.1.3.3.1" xref="S4.SS2.p3.4.m4.1.1.2.3.1.3.3.1.cmml">∪</mo><msub id="S4.SS2.p3.4.m4.1.1.2.3.1.3.3.3" xref="S4.SS2.p3.4.m4.1.1.2.3.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p3.4.m4.1.1.2.3.1.3.3.3.2" xref="S4.SS2.p3.4.m4.1.1.2.3.1.3.3.3.2.cmml">𝒞</mi><mi id="S4.SS2.p3.4.m4.1.1.2.3.1.3.3.3.3" xref="S4.SS2.p3.4.m4.1.1.2.3.1.3.3.3.3.cmml">n</mi></msub></mrow></mrow></msub><msub id="S4.SS2.p3.4.m4.1.1.2.3.2" xref="S4.SS2.p3.4.m4.1.1.2.3.2.cmml"><mi id="S4.SS2.p3.4.m4.1.1.2.3.2.2" xref="S4.SS2.p3.4.m4.1.1.2.3.2.2.cmml">p</mi><mi id="S4.SS2.p3.4.m4.1.1.2.3.2.3" xref="S4.SS2.p3.4.m4.1.1.2.3.2.3.cmml">c</mi></msub></mrow></mrow><mo id="S4.SS2.p3.4.m4.1.1.1" xref="S4.SS2.p3.4.m4.1.1.1.cmml">=</mo><mn id="S4.SS2.p3.4.m4.1.1.3" xref="S4.SS2.p3.4.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.4.m4.1b"><apply id="S4.SS2.p3.4.m4.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1"><eq id="S4.SS2.p3.4.m4.1.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1.1"></eq><apply id="S4.SS2.p3.4.m4.1.1.2.cmml" xref="S4.SS2.p3.4.m4.1.1.2"><plus id="S4.SS2.p3.4.m4.1.1.2.1.cmml" xref="S4.SS2.p3.4.m4.1.1.2.1"></plus><apply id="S4.SS2.p3.4.m4.1.1.2.2.cmml" xref="S4.SS2.p3.4.m4.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p3.4.m4.1.1.2.2.1.cmml" xref="S4.SS2.p3.4.m4.1.1.2.2">subscript</csymbol><ci id="S4.SS2.p3.4.m4.1.1.2.2.2.cmml" xref="S4.SS2.p3.4.m4.1.1.2.2.2">𝑝</ci><minus id="S4.SS2.p3.4.m4.1.1.2.2.3.cmml" xref="S4.SS2.p3.4.m4.1.1.2.2.3"></minus></apply><apply id="S4.SS2.p3.4.m4.1.1.2.3.cmml" xref="S4.SS2.p3.4.m4.1.1.2.3"><apply id="S4.SS2.p3.4.m4.1.1.2.3.1.cmml" xref="S4.SS2.p3.4.m4.1.1.2.3.1"><csymbol cd="ambiguous" id="S4.SS2.p3.4.m4.1.1.2.3.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1.2.3.1">subscript</csymbol><sum id="S4.SS2.p3.4.m4.1.1.2.3.1.2.cmml" xref="S4.SS2.p3.4.m4.1.1.2.3.1.2"></sum><apply id="S4.SS2.p3.4.m4.1.1.2.3.1.3.cmml" xref="S4.SS2.p3.4.m4.1.1.2.3.1.3"><in id="S4.SS2.p3.4.m4.1.1.2.3.1.3.1.cmml" xref="S4.SS2.p3.4.m4.1.1.2.3.1.3.1"></in><ci id="S4.SS2.p3.4.m4.1.1.2.3.1.3.2.cmml" xref="S4.SS2.p3.4.m4.1.1.2.3.1.3.2">𝑐</ci><apply id="S4.SS2.p3.4.m4.1.1.2.3.1.3.3.cmml" xref="S4.SS2.p3.4.m4.1.1.2.3.1.3.3"><union id="S4.SS2.p3.4.m4.1.1.2.3.1.3.3.1.cmml" xref="S4.SS2.p3.4.m4.1.1.2.3.1.3.3.1"></union><apply id="S4.SS2.p3.4.m4.1.1.2.3.1.3.3.2.cmml" xref="S4.SS2.p3.4.m4.1.1.2.3.1.3.3.2"><csymbol cd="ambiguous" id="S4.SS2.p3.4.m4.1.1.2.3.1.3.3.2.1.cmml" xref="S4.SS2.p3.4.m4.1.1.2.3.1.3.3.2">subscript</csymbol><ci id="S4.SS2.p3.4.m4.1.1.2.3.1.3.3.2.2.cmml" xref="S4.SS2.p3.4.m4.1.1.2.3.1.3.3.2.2">𝒞</ci><ci id="S4.SS2.p3.4.m4.1.1.2.3.1.3.3.2.3.cmml" xref="S4.SS2.p3.4.m4.1.1.2.3.1.3.3.2.3">𝑏</ci></apply><apply id="S4.SS2.p3.4.m4.1.1.2.3.1.3.3.3.cmml" xref="S4.SS2.p3.4.m4.1.1.2.3.1.3.3.3"><csymbol cd="ambiguous" id="S4.SS2.p3.4.m4.1.1.2.3.1.3.3.3.1.cmml" xref="S4.SS2.p3.4.m4.1.1.2.3.1.3.3.3">subscript</csymbol><ci id="S4.SS2.p3.4.m4.1.1.2.3.1.3.3.3.2.cmml" xref="S4.SS2.p3.4.m4.1.1.2.3.1.3.3.3.2">𝒞</ci><ci id="S4.SS2.p3.4.m4.1.1.2.3.1.3.3.3.3.cmml" xref="S4.SS2.p3.4.m4.1.1.2.3.1.3.3.3.3">𝑛</ci></apply></apply></apply></apply><apply id="S4.SS2.p3.4.m4.1.1.2.3.2.cmml" xref="S4.SS2.p3.4.m4.1.1.2.3.2"><csymbol cd="ambiguous" id="S4.SS2.p3.4.m4.1.1.2.3.2.1.cmml" xref="S4.SS2.p3.4.m4.1.1.2.3.2">subscript</csymbol><ci id="S4.SS2.p3.4.m4.1.1.2.3.2.2.cmml" xref="S4.SS2.p3.4.m4.1.1.2.3.2.2">𝑝</ci><ci id="S4.SS2.p3.4.m4.1.1.2.3.2.3.cmml" xref="S4.SS2.p3.4.m4.1.1.2.3.2.3">𝑐</ci></apply></apply></apply><cn type="integer" id="S4.SS2.p3.4.m4.1.1.3.cmml" xref="S4.SS2.p3.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.4.m4.1c">p_{-}+\sum_{c\in\mathcal{C}_{b}{}\cup\mathcal{C}_{n}{}}p_{c}=1</annotation></semantics></math>. Intuitively, the class with fewer data is assigned with a larger margin to guarantee the learning of this class.</p>
</div>
<div id="S4.SS2.p4" class="ltx_para">
<p id="S4.SS2.p4.2" class="ltx_p">Suppose that the logit outputs for sample <math id="S4.SS2.p4.1.m1.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S4.SS2.p4.1.m1.1a"><mi id="S4.SS2.p4.1.m1.1.1" xref="S4.SS2.p4.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.1b"><ci id="S4.SS2.p4.1.m1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.1c">x</annotation></semantics></math> are <math id="S4.SS2.p4.2.m2.1" class="ltx_Math" alttext="\mathbf{v}=\{v_{c}\}_{c\in\mathcal{C}}" display="inline"><semantics id="S4.SS2.p4.2.m2.1a"><mrow id="S4.SS2.p4.2.m2.1.1" xref="S4.SS2.p4.2.m2.1.1.cmml"><mi id="S4.SS2.p4.2.m2.1.1.3" xref="S4.SS2.p4.2.m2.1.1.3.cmml">𝐯</mi><mo id="S4.SS2.p4.2.m2.1.1.2" xref="S4.SS2.p4.2.m2.1.1.2.cmml">=</mo><msub id="S4.SS2.p4.2.m2.1.1.1" xref="S4.SS2.p4.2.m2.1.1.1.cmml"><mrow id="S4.SS2.p4.2.m2.1.1.1.1.1" xref="S4.SS2.p4.2.m2.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS2.p4.2.m2.1.1.1.1.1.2" xref="S4.SS2.p4.2.m2.1.1.1.1.2.cmml">{</mo><msub id="S4.SS2.p4.2.m2.1.1.1.1.1.1" xref="S4.SS2.p4.2.m2.1.1.1.1.1.1.cmml"><mi id="S4.SS2.p4.2.m2.1.1.1.1.1.1.2" xref="S4.SS2.p4.2.m2.1.1.1.1.1.1.2.cmml">v</mi><mi id="S4.SS2.p4.2.m2.1.1.1.1.1.1.3" xref="S4.SS2.p4.2.m2.1.1.1.1.1.1.3.cmml">c</mi></msub><mo stretchy="false" id="S4.SS2.p4.2.m2.1.1.1.1.1.3" xref="S4.SS2.p4.2.m2.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS2.p4.2.m2.1.1.1.3" xref="S4.SS2.p4.2.m2.1.1.1.3.cmml"><mi id="S4.SS2.p4.2.m2.1.1.1.3.2" xref="S4.SS2.p4.2.m2.1.1.1.3.2.cmml">c</mi><mo id="S4.SS2.p4.2.m2.1.1.1.3.1" xref="S4.SS2.p4.2.m2.1.1.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p4.2.m2.1.1.1.3.3" xref="S4.SS2.p4.2.m2.1.1.1.3.3.cmml">𝒞</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.2.m2.1b"><apply id="S4.SS2.p4.2.m2.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1"><eq id="S4.SS2.p4.2.m2.1.1.2.cmml" xref="S4.SS2.p4.2.m2.1.1.2"></eq><ci id="S4.SS2.p4.2.m2.1.1.3.cmml" xref="S4.SS2.p4.2.m2.1.1.3">𝐯</ci><apply id="S4.SS2.p4.2.m2.1.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.2.m2.1.1.1.2.cmml" xref="S4.SS2.p4.2.m2.1.1.1">subscript</csymbol><set id="S4.SS2.p4.2.m2.1.1.1.1.2.cmml" xref="S4.SS2.p4.2.m2.1.1.1.1.1"><apply id="S4.SS2.p4.2.m2.1.1.1.1.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.2.m2.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p4.2.m2.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p4.2.m2.1.1.1.1.1.1.2">𝑣</ci><ci id="S4.SS2.p4.2.m2.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p4.2.m2.1.1.1.1.1.1.3">𝑐</ci></apply></set><apply id="S4.SS2.p4.2.m2.1.1.1.3.cmml" xref="S4.SS2.p4.2.m2.1.1.1.3"><in id="S4.SS2.p4.2.m2.1.1.1.3.1.cmml" xref="S4.SS2.p4.2.m2.1.1.1.3.1"></in><ci id="S4.SS2.p4.2.m2.1.1.1.3.2.cmml" xref="S4.SS2.p4.2.m2.1.1.1.3.2">𝑐</ci><ci id="S4.SS2.p4.2.m2.1.1.1.3.3.cmml" xref="S4.SS2.p4.2.m2.1.1.1.3.3">𝒞</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.2.m2.1c">\mathbf{v}=\{v_{c}\}_{c\in\mathcal{C}}</annotation></semantics></math>, we use the following prior-margin cross-entropy loss by adding the margins to the logits:</p>
<table id="S4.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E3.m1.6" class="ltx_Math" alttext="\mathcal{L}_{\text{prior}}(x)=-\sum_{c\in\mathcal{C}}y_{c}\cdot\log\frac{\exp(v_{c}-m_{c})}{\sum_{c^{\prime}\in\mathcal{C}}\exp(v_{c^{\prime}}-m_{c^{\prime}})}." display="block"><semantics id="S4.E3.m1.6a"><mrow id="S4.E3.m1.6.6.1" xref="S4.E3.m1.6.6.1.1.cmml"><mrow id="S4.E3.m1.6.6.1.1" xref="S4.E3.m1.6.6.1.1.cmml"><mrow id="S4.E3.m1.6.6.1.1.2" xref="S4.E3.m1.6.6.1.1.2.cmml"><msub id="S4.E3.m1.6.6.1.1.2.2" xref="S4.E3.m1.6.6.1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E3.m1.6.6.1.1.2.2.2" xref="S4.E3.m1.6.6.1.1.2.2.2.cmml">ℒ</mi><mtext id="S4.E3.m1.6.6.1.1.2.2.3" xref="S4.E3.m1.6.6.1.1.2.2.3a.cmml">prior</mtext></msub><mo lspace="0em" rspace="0em" id="S4.E3.m1.6.6.1.1.2.1" xref="S4.E3.m1.6.6.1.1.2.1.cmml">​</mo><mrow id="S4.E3.m1.6.6.1.1.2.3.2" xref="S4.E3.m1.6.6.1.1.2.cmml"><mo stretchy="false" id="S4.E3.m1.6.6.1.1.2.3.2.1" xref="S4.E3.m1.6.6.1.1.2.cmml">(</mo><mi id="S4.E3.m1.5.5" xref="S4.E3.m1.5.5.cmml">x</mi><mo stretchy="false" id="S4.E3.m1.6.6.1.1.2.3.2.2" xref="S4.E3.m1.6.6.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E3.m1.6.6.1.1.1" xref="S4.E3.m1.6.6.1.1.1.cmml">=</mo><mrow id="S4.E3.m1.6.6.1.1.3" xref="S4.E3.m1.6.6.1.1.3.cmml"><mo id="S4.E3.m1.6.6.1.1.3a" xref="S4.E3.m1.6.6.1.1.3.cmml">−</mo><mrow id="S4.E3.m1.6.6.1.1.3.2" xref="S4.E3.m1.6.6.1.1.3.2.cmml"><munder id="S4.E3.m1.6.6.1.1.3.2.1" xref="S4.E3.m1.6.6.1.1.3.2.1.cmml"><mo movablelimits="false" id="S4.E3.m1.6.6.1.1.3.2.1.2" xref="S4.E3.m1.6.6.1.1.3.2.1.2.cmml">∑</mo><mrow id="S4.E3.m1.6.6.1.1.3.2.1.3" xref="S4.E3.m1.6.6.1.1.3.2.1.3.cmml"><mi id="S4.E3.m1.6.6.1.1.3.2.1.3.2" xref="S4.E3.m1.6.6.1.1.3.2.1.3.2.cmml">c</mi><mo id="S4.E3.m1.6.6.1.1.3.2.1.3.1" xref="S4.E3.m1.6.6.1.1.3.2.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.E3.m1.6.6.1.1.3.2.1.3.3" xref="S4.E3.m1.6.6.1.1.3.2.1.3.3.cmml">𝒞</mi></mrow></munder><mrow id="S4.E3.m1.6.6.1.1.3.2.2" xref="S4.E3.m1.6.6.1.1.3.2.2.cmml"><msub id="S4.E3.m1.6.6.1.1.3.2.2.2" xref="S4.E3.m1.6.6.1.1.3.2.2.2.cmml"><mi id="S4.E3.m1.6.6.1.1.3.2.2.2.2" xref="S4.E3.m1.6.6.1.1.3.2.2.2.2.cmml">y</mi><mi id="S4.E3.m1.6.6.1.1.3.2.2.2.3" xref="S4.E3.m1.6.6.1.1.3.2.2.2.3.cmml">c</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S4.E3.m1.6.6.1.1.3.2.2.1" xref="S4.E3.m1.6.6.1.1.3.2.2.1.cmml">⋅</mo><mrow id="S4.E3.m1.6.6.1.1.3.2.2.3" xref="S4.E3.m1.6.6.1.1.3.2.2.3.cmml"><mi id="S4.E3.m1.6.6.1.1.3.2.2.3.1" xref="S4.E3.m1.6.6.1.1.3.2.2.3.1.cmml">log</mi><mo lspace="0.167em" id="S4.E3.m1.6.6.1.1.3.2.2.3a" xref="S4.E3.m1.6.6.1.1.3.2.2.3.cmml">⁡</mo><mfrac id="S4.E3.m1.4.4" xref="S4.E3.m1.4.4.cmml"><mrow id="S4.E3.m1.2.2.2.2" xref="S4.E3.m1.2.2.2.3.cmml"><mi id="S4.E3.m1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.cmml">exp</mi><mo id="S4.E3.m1.2.2.2.2a" xref="S4.E3.m1.2.2.2.3.cmml">⁡</mo><mrow id="S4.E3.m1.2.2.2.2.1" xref="S4.E3.m1.2.2.2.3.cmml"><mo stretchy="false" id="S4.E3.m1.2.2.2.2.1.2" xref="S4.E3.m1.2.2.2.3.cmml">(</mo><mrow id="S4.E3.m1.2.2.2.2.1.1" xref="S4.E3.m1.2.2.2.2.1.1.cmml"><msub id="S4.E3.m1.2.2.2.2.1.1.2" xref="S4.E3.m1.2.2.2.2.1.1.2.cmml"><mi id="S4.E3.m1.2.2.2.2.1.1.2.2" xref="S4.E3.m1.2.2.2.2.1.1.2.2.cmml">v</mi><mi id="S4.E3.m1.2.2.2.2.1.1.2.3" xref="S4.E3.m1.2.2.2.2.1.1.2.3.cmml">c</mi></msub><mo id="S4.E3.m1.2.2.2.2.1.1.1" xref="S4.E3.m1.2.2.2.2.1.1.1.cmml">−</mo><msub id="S4.E3.m1.2.2.2.2.1.1.3" xref="S4.E3.m1.2.2.2.2.1.1.3.cmml"><mi id="S4.E3.m1.2.2.2.2.1.1.3.2" xref="S4.E3.m1.2.2.2.2.1.1.3.2.cmml">m</mi><mi id="S4.E3.m1.2.2.2.2.1.1.3.3" xref="S4.E3.m1.2.2.2.2.1.1.3.3.cmml">c</mi></msub></mrow><mo stretchy="false" id="S4.E3.m1.2.2.2.2.1.3" xref="S4.E3.m1.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="S4.E3.m1.4.4.4" xref="S4.E3.m1.4.4.4.cmml"><msub id="S4.E3.m1.4.4.4.3" xref="S4.E3.m1.4.4.4.3.cmml"><mo id="S4.E3.m1.4.4.4.3.2" xref="S4.E3.m1.4.4.4.3.2.cmml">∑</mo><mrow id="S4.E3.m1.4.4.4.3.3" xref="S4.E3.m1.4.4.4.3.3.cmml"><msup id="S4.E3.m1.4.4.4.3.3.2" xref="S4.E3.m1.4.4.4.3.3.2.cmml"><mi id="S4.E3.m1.4.4.4.3.3.2.2" xref="S4.E3.m1.4.4.4.3.3.2.2.cmml">c</mi><mo id="S4.E3.m1.4.4.4.3.3.2.3" xref="S4.E3.m1.4.4.4.3.3.2.3.cmml">′</mo></msup><mo id="S4.E3.m1.4.4.4.3.3.1" xref="S4.E3.m1.4.4.4.3.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.E3.m1.4.4.4.3.3.3" xref="S4.E3.m1.4.4.4.3.3.3.cmml">𝒞</mi></mrow></msub><mrow id="S4.E3.m1.4.4.4.2.1" xref="S4.E3.m1.4.4.4.2.2.cmml"><mi id="S4.E3.m1.3.3.3.1" xref="S4.E3.m1.3.3.3.1.cmml">exp</mi><mo id="S4.E3.m1.4.4.4.2.1a" xref="S4.E3.m1.4.4.4.2.2.cmml">⁡</mo><mrow id="S4.E3.m1.4.4.4.2.1.1" xref="S4.E3.m1.4.4.4.2.2.cmml"><mo stretchy="false" id="S4.E3.m1.4.4.4.2.1.1.2" xref="S4.E3.m1.4.4.4.2.2.cmml">(</mo><mrow id="S4.E3.m1.4.4.4.2.1.1.1" xref="S4.E3.m1.4.4.4.2.1.1.1.cmml"><msub id="S4.E3.m1.4.4.4.2.1.1.1.2" xref="S4.E3.m1.4.4.4.2.1.1.1.2.cmml"><mi id="S4.E3.m1.4.4.4.2.1.1.1.2.2" xref="S4.E3.m1.4.4.4.2.1.1.1.2.2.cmml">v</mi><msup id="S4.E3.m1.4.4.4.2.1.1.1.2.3" xref="S4.E3.m1.4.4.4.2.1.1.1.2.3.cmml"><mi id="S4.E3.m1.4.4.4.2.1.1.1.2.3.2" xref="S4.E3.m1.4.4.4.2.1.1.1.2.3.2.cmml">c</mi><mo id="S4.E3.m1.4.4.4.2.1.1.1.2.3.3" xref="S4.E3.m1.4.4.4.2.1.1.1.2.3.3.cmml">′</mo></msup></msub><mo id="S4.E3.m1.4.4.4.2.1.1.1.1" xref="S4.E3.m1.4.4.4.2.1.1.1.1.cmml">−</mo><msub id="S4.E3.m1.4.4.4.2.1.1.1.3" xref="S4.E3.m1.4.4.4.2.1.1.1.3.cmml"><mi id="S4.E3.m1.4.4.4.2.1.1.1.3.2" xref="S4.E3.m1.4.4.4.2.1.1.1.3.2.cmml">m</mi><msup id="S4.E3.m1.4.4.4.2.1.1.1.3.3" xref="S4.E3.m1.4.4.4.2.1.1.1.3.3.cmml"><mi id="S4.E3.m1.4.4.4.2.1.1.1.3.3.2" xref="S4.E3.m1.4.4.4.2.1.1.1.3.3.2.cmml">c</mi><mo id="S4.E3.m1.4.4.4.2.1.1.1.3.3.3" xref="S4.E3.m1.4.4.4.2.1.1.1.3.3.3.cmml">′</mo></msup></msub></mrow><mo stretchy="false" id="S4.E3.m1.4.4.4.2.1.1.3" xref="S4.E3.m1.4.4.4.2.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="S4.E3.m1.6.6.1.2" xref="S4.E3.m1.6.6.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m1.6b"><apply id="S4.E3.m1.6.6.1.1.cmml" xref="S4.E3.m1.6.6.1"><eq id="S4.E3.m1.6.6.1.1.1.cmml" xref="S4.E3.m1.6.6.1.1.1"></eq><apply id="S4.E3.m1.6.6.1.1.2.cmml" xref="S4.E3.m1.6.6.1.1.2"><times id="S4.E3.m1.6.6.1.1.2.1.cmml" xref="S4.E3.m1.6.6.1.1.2.1"></times><apply id="S4.E3.m1.6.6.1.1.2.2.cmml" xref="S4.E3.m1.6.6.1.1.2.2"><csymbol cd="ambiguous" id="S4.E3.m1.6.6.1.1.2.2.1.cmml" xref="S4.E3.m1.6.6.1.1.2.2">subscript</csymbol><ci id="S4.E3.m1.6.6.1.1.2.2.2.cmml" xref="S4.E3.m1.6.6.1.1.2.2.2">ℒ</ci><ci id="S4.E3.m1.6.6.1.1.2.2.3a.cmml" xref="S4.E3.m1.6.6.1.1.2.2.3"><mtext mathsize="70%" id="S4.E3.m1.6.6.1.1.2.2.3.cmml" xref="S4.E3.m1.6.6.1.1.2.2.3">prior</mtext></ci></apply><ci id="S4.E3.m1.5.5.cmml" xref="S4.E3.m1.5.5">𝑥</ci></apply><apply id="S4.E3.m1.6.6.1.1.3.cmml" xref="S4.E3.m1.6.6.1.1.3"><minus id="S4.E3.m1.6.6.1.1.3.1.cmml" xref="S4.E3.m1.6.6.1.1.3"></minus><apply id="S4.E3.m1.6.6.1.1.3.2.cmml" xref="S4.E3.m1.6.6.1.1.3.2"><apply id="S4.E3.m1.6.6.1.1.3.2.1.cmml" xref="S4.E3.m1.6.6.1.1.3.2.1"><csymbol cd="ambiguous" id="S4.E3.m1.6.6.1.1.3.2.1.1.cmml" xref="S4.E3.m1.6.6.1.1.3.2.1">subscript</csymbol><sum id="S4.E3.m1.6.6.1.1.3.2.1.2.cmml" xref="S4.E3.m1.6.6.1.1.3.2.1.2"></sum><apply id="S4.E3.m1.6.6.1.1.3.2.1.3.cmml" xref="S4.E3.m1.6.6.1.1.3.2.1.3"><in id="S4.E3.m1.6.6.1.1.3.2.1.3.1.cmml" xref="S4.E3.m1.6.6.1.1.3.2.1.3.1"></in><ci id="S4.E3.m1.6.6.1.1.3.2.1.3.2.cmml" xref="S4.E3.m1.6.6.1.1.3.2.1.3.2">𝑐</ci><ci id="S4.E3.m1.6.6.1.1.3.2.1.3.3.cmml" xref="S4.E3.m1.6.6.1.1.3.2.1.3.3">𝒞</ci></apply></apply><apply id="S4.E3.m1.6.6.1.1.3.2.2.cmml" xref="S4.E3.m1.6.6.1.1.3.2.2"><ci id="S4.E3.m1.6.6.1.1.3.2.2.1.cmml" xref="S4.E3.m1.6.6.1.1.3.2.2.1">⋅</ci><apply id="S4.E3.m1.6.6.1.1.3.2.2.2.cmml" xref="S4.E3.m1.6.6.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S4.E3.m1.6.6.1.1.3.2.2.2.1.cmml" xref="S4.E3.m1.6.6.1.1.3.2.2.2">subscript</csymbol><ci id="S4.E3.m1.6.6.1.1.3.2.2.2.2.cmml" xref="S4.E3.m1.6.6.1.1.3.2.2.2.2">𝑦</ci><ci id="S4.E3.m1.6.6.1.1.3.2.2.2.3.cmml" xref="S4.E3.m1.6.6.1.1.3.2.2.2.3">𝑐</ci></apply><apply id="S4.E3.m1.6.6.1.1.3.2.2.3.cmml" xref="S4.E3.m1.6.6.1.1.3.2.2.3"><log id="S4.E3.m1.6.6.1.1.3.2.2.3.1.cmml" xref="S4.E3.m1.6.6.1.1.3.2.2.3.1"></log><apply id="S4.E3.m1.4.4.cmml" xref="S4.E3.m1.4.4"><divide id="S4.E3.m1.4.4.5.cmml" xref="S4.E3.m1.4.4"></divide><apply id="S4.E3.m1.2.2.2.3.cmml" xref="S4.E3.m1.2.2.2.2"><exp id="S4.E3.m1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1"></exp><apply id="S4.E3.m1.2.2.2.2.1.1.cmml" xref="S4.E3.m1.2.2.2.2.1.1"><minus id="S4.E3.m1.2.2.2.2.1.1.1.cmml" xref="S4.E3.m1.2.2.2.2.1.1.1"></minus><apply id="S4.E3.m1.2.2.2.2.1.1.2.cmml" xref="S4.E3.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.2.2.1.1.2.1.cmml" xref="S4.E3.m1.2.2.2.2.1.1.2">subscript</csymbol><ci id="S4.E3.m1.2.2.2.2.1.1.2.2.cmml" xref="S4.E3.m1.2.2.2.2.1.1.2.2">𝑣</ci><ci id="S4.E3.m1.2.2.2.2.1.1.2.3.cmml" xref="S4.E3.m1.2.2.2.2.1.1.2.3">𝑐</ci></apply><apply id="S4.E3.m1.2.2.2.2.1.1.3.cmml" xref="S4.E3.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.2.2.1.1.3.1.cmml" xref="S4.E3.m1.2.2.2.2.1.1.3">subscript</csymbol><ci id="S4.E3.m1.2.2.2.2.1.1.3.2.cmml" xref="S4.E3.m1.2.2.2.2.1.1.3.2">𝑚</ci><ci id="S4.E3.m1.2.2.2.2.1.1.3.3.cmml" xref="S4.E3.m1.2.2.2.2.1.1.3.3">𝑐</ci></apply></apply></apply><apply id="S4.E3.m1.4.4.4.cmml" xref="S4.E3.m1.4.4.4"><apply id="S4.E3.m1.4.4.4.3.cmml" xref="S4.E3.m1.4.4.4.3"><csymbol cd="ambiguous" id="S4.E3.m1.4.4.4.3.1.cmml" xref="S4.E3.m1.4.4.4.3">subscript</csymbol><sum id="S4.E3.m1.4.4.4.3.2.cmml" xref="S4.E3.m1.4.4.4.3.2"></sum><apply id="S4.E3.m1.4.4.4.3.3.cmml" xref="S4.E3.m1.4.4.4.3.3"><in id="S4.E3.m1.4.4.4.3.3.1.cmml" xref="S4.E3.m1.4.4.4.3.3.1"></in><apply id="S4.E3.m1.4.4.4.3.3.2.cmml" xref="S4.E3.m1.4.4.4.3.3.2"><csymbol cd="ambiguous" id="S4.E3.m1.4.4.4.3.3.2.1.cmml" xref="S4.E3.m1.4.4.4.3.3.2">superscript</csymbol><ci id="S4.E3.m1.4.4.4.3.3.2.2.cmml" xref="S4.E3.m1.4.4.4.3.3.2.2">𝑐</ci><ci id="S4.E3.m1.4.4.4.3.3.2.3.cmml" xref="S4.E3.m1.4.4.4.3.3.2.3">′</ci></apply><ci id="S4.E3.m1.4.4.4.3.3.3.cmml" xref="S4.E3.m1.4.4.4.3.3.3">𝒞</ci></apply></apply><apply id="S4.E3.m1.4.4.4.2.2.cmml" xref="S4.E3.m1.4.4.4.2.1"><exp id="S4.E3.m1.3.3.3.1.cmml" xref="S4.E3.m1.3.3.3.1"></exp><apply id="S4.E3.m1.4.4.4.2.1.1.1.cmml" xref="S4.E3.m1.4.4.4.2.1.1.1"><minus id="S4.E3.m1.4.4.4.2.1.1.1.1.cmml" xref="S4.E3.m1.4.4.4.2.1.1.1.1"></minus><apply id="S4.E3.m1.4.4.4.2.1.1.1.2.cmml" xref="S4.E3.m1.4.4.4.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.E3.m1.4.4.4.2.1.1.1.2.1.cmml" xref="S4.E3.m1.4.4.4.2.1.1.1.2">subscript</csymbol><ci id="S4.E3.m1.4.4.4.2.1.1.1.2.2.cmml" xref="S4.E3.m1.4.4.4.2.1.1.1.2.2">𝑣</ci><apply id="S4.E3.m1.4.4.4.2.1.1.1.2.3.cmml" xref="S4.E3.m1.4.4.4.2.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E3.m1.4.4.4.2.1.1.1.2.3.1.cmml" xref="S4.E3.m1.4.4.4.2.1.1.1.2.3">superscript</csymbol><ci id="S4.E3.m1.4.4.4.2.1.1.1.2.3.2.cmml" xref="S4.E3.m1.4.4.4.2.1.1.1.2.3.2">𝑐</ci><ci id="S4.E3.m1.4.4.4.2.1.1.1.2.3.3.cmml" xref="S4.E3.m1.4.4.4.2.1.1.1.2.3.3">′</ci></apply></apply><apply id="S4.E3.m1.4.4.4.2.1.1.1.3.cmml" xref="S4.E3.m1.4.4.4.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.4.4.4.2.1.1.1.3.1.cmml" xref="S4.E3.m1.4.4.4.2.1.1.1.3">subscript</csymbol><ci id="S4.E3.m1.4.4.4.2.1.1.1.3.2.cmml" xref="S4.E3.m1.4.4.4.2.1.1.1.3.2">𝑚</ci><apply id="S4.E3.m1.4.4.4.2.1.1.1.3.3.cmml" xref="S4.E3.m1.4.4.4.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E3.m1.4.4.4.2.1.1.1.3.3.1.cmml" xref="S4.E3.m1.4.4.4.2.1.1.1.3.3">superscript</csymbol><ci id="S4.E3.m1.4.4.4.2.1.1.1.3.3.2.cmml" xref="S4.E3.m1.4.4.4.2.1.1.1.3.3.2">𝑐</ci><ci id="S4.E3.m1.4.4.4.2.1.1.1.3.3.3.cmml" xref="S4.E3.m1.4.4.4.2.1.1.1.3.3.3">′</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.6c">\mathcal{L}_{\text{prior}}(x)=-\sum_{c\in\mathcal{C}}y_{c}\cdot\log\frac{\exp(v_{c}-m_{c})}{\sum_{c^{\prime}\in\mathcal{C}}\exp(v_{c^{\prime}}-m_{c^{\prime}})}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p4.6" class="ltx_p">where <math id="S4.SS2.p4.3.m1.1" class="ltx_Math" alttext="y_{c}" display="inline"><semantics id="S4.SS2.p4.3.m1.1a"><msub id="S4.SS2.p4.3.m1.1.1" xref="S4.SS2.p4.3.m1.1.1.cmml"><mi id="S4.SS2.p4.3.m1.1.1.2" xref="S4.SS2.p4.3.m1.1.1.2.cmml">y</mi><mi id="S4.SS2.p4.3.m1.1.1.3" xref="S4.SS2.p4.3.m1.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.3.m1.1b"><apply id="S4.SS2.p4.3.m1.1.1.cmml" xref="S4.SS2.p4.3.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.3.m1.1.1.1.cmml" xref="S4.SS2.p4.3.m1.1.1">subscript</csymbol><ci id="S4.SS2.p4.3.m1.1.1.2.cmml" xref="S4.SS2.p4.3.m1.1.1.2">𝑦</ci><ci id="S4.SS2.p4.3.m1.1.1.3.cmml" xref="S4.SS2.p4.3.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.3.m1.1c">y_{c}</annotation></semantics></math> equals to 1 if <math id="S4.SS2.p4.4.m2.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S4.SS2.p4.4.m2.1a"><mi id="S4.SS2.p4.4.m2.1.1" xref="S4.SS2.p4.4.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.4.m2.1b"><ci id="S4.SS2.p4.4.m2.1.1.cmml" xref="S4.SS2.p4.4.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.4.m2.1c">c</annotation></semantics></math> is the ground-truth label, otherwise <math id="S4.SS2.p4.5.m3.1" class="ltx_Math" alttext="y_{c}=0" display="inline"><semantics id="S4.SS2.p4.5.m3.1a"><mrow id="S4.SS2.p4.5.m3.1.1" xref="S4.SS2.p4.5.m3.1.1.cmml"><msub id="S4.SS2.p4.5.m3.1.1.2" xref="S4.SS2.p4.5.m3.1.1.2.cmml"><mi id="S4.SS2.p4.5.m3.1.1.2.2" xref="S4.SS2.p4.5.m3.1.1.2.2.cmml">y</mi><mi id="S4.SS2.p4.5.m3.1.1.2.3" xref="S4.SS2.p4.5.m3.1.1.2.3.cmml">c</mi></msub><mo id="S4.SS2.p4.5.m3.1.1.1" xref="S4.SS2.p4.5.m3.1.1.1.cmml">=</mo><mn id="S4.SS2.p4.5.m3.1.1.3" xref="S4.SS2.p4.5.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.5.m3.1b"><apply id="S4.SS2.p4.5.m3.1.1.cmml" xref="S4.SS2.p4.5.m3.1.1"><eq id="S4.SS2.p4.5.m3.1.1.1.cmml" xref="S4.SS2.p4.5.m3.1.1.1"></eq><apply id="S4.SS2.p4.5.m3.1.1.2.cmml" xref="S4.SS2.p4.5.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p4.5.m3.1.1.2.1.cmml" xref="S4.SS2.p4.5.m3.1.1.2">subscript</csymbol><ci id="S4.SS2.p4.5.m3.1.1.2.2.cmml" xref="S4.SS2.p4.5.m3.1.1.2.2">𝑦</ci><ci id="S4.SS2.p4.5.m3.1.1.2.3.cmml" xref="S4.SS2.p4.5.m3.1.1.2.3">𝑐</ci></apply><cn type="integer" id="S4.SS2.p4.5.m3.1.1.3.cmml" xref="S4.SS2.p4.5.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.5.m3.1c">y_{c}=0</annotation></semantics></math>. Note that our prior-margin loss reduce to vanilla cross-entropy loss if all margins <math id="S4.SS2.p4.6.m4.1" class="ltx_Math" alttext="m_{c}" display="inline"><semantics id="S4.SS2.p4.6.m4.1a"><msub id="S4.SS2.p4.6.m4.1.1" xref="S4.SS2.p4.6.m4.1.1.cmml"><mi id="S4.SS2.p4.6.m4.1.1.2" xref="S4.SS2.p4.6.m4.1.1.2.cmml">m</mi><mi id="S4.SS2.p4.6.m4.1.1.3" xref="S4.SS2.p4.6.m4.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.6.m4.1b"><apply id="S4.SS2.p4.6.m4.1.1.cmml" xref="S4.SS2.p4.6.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.6.m4.1.1.1.cmml" xref="S4.SS2.p4.6.m4.1.1">subscript</csymbol><ci id="S4.SS2.p4.6.m4.1.1.2.cmml" xref="S4.SS2.p4.6.m4.1.1.2">𝑚</ci><ci id="S4.SS2.p4.6.m4.1.1.3.cmml" xref="S4.SS2.p4.6.m4.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.6.m4.1c">m_{c}</annotation></semantics></math> are set as 0. As the margins are obtained based on prior distribution and fixed during training, we term this baseline as Prior.</p>
</div>
<div id="S4.SS2.p5" class="ltx_para">
<p id="S4.SS2.p5.3" class="ltx_p">Though the margin-based loss is calculated over all the proposals, precisely calculating the margins from the proposals is time-consuming. Thus, we obtain the prior margins over all annotated bounding box instances. In this case, there is a misalignment between proposal-based loss and instance-based margin. To mitigate this gap, we proposed to adaptively learn the margins based on the priors. Motivated by the success of self distillation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib51" title="" class="ltx_ref">51</a>]</cite> in knowledge transfer, we use the detection module learned from <math id="S4.SS2.p5.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{\text{prior}}" display="inline"><semantics id="S4.SS2.p5.1.m1.1a"><msub id="S4.SS2.p5.1.m1.1.1" xref="S4.SS2.p5.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p5.1.m1.1.1.2" xref="S4.SS2.p5.1.m1.1.1.2.cmml">ℒ</mi><mtext id="S4.SS2.p5.1.m1.1.1.3" xref="S4.SS2.p5.1.m1.1.1.3a.cmml">prior</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.1.m1.1b"><apply id="S4.SS2.p5.1.m1.1.1.cmml" xref="S4.SS2.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.1.m1.1.1.1.cmml" xref="S4.SS2.p5.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p5.1.m1.1.1.2.cmml" xref="S4.SS2.p5.1.m1.1.1.2">ℒ</ci><ci id="S4.SS2.p5.1.m1.1.1.3a.cmml" xref="S4.SS2.p5.1.m1.1.1.3"><mtext mathsize="70%" id="S4.SS2.p5.1.m1.1.1.3.cmml" xref="S4.SS2.p5.1.m1.1.1.3">prior</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.1.m1.1c">\mathcal{L}_{\text{prior}}</annotation></semantics></math> in Eq. (<a href="#S4.E3" title="Equation 3 ‣ 4.2 Intra-Class Compactness ‣ 4 Approach ‣ DiGeo: Discriminative Geometry-Aware Learning for Generalized Few-Shot Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>) as teacher model, and distill its knowledge to a student model to adaptively learn and update the margins through soft labels, which has the same architecture as teacher model but different parameters. For sample <math id="S4.SS2.p5.2.m2.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S4.SS2.p5.2.m2.1a"><mi id="S4.SS2.p5.2.m2.1.1" xref="S4.SS2.p5.2.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.2.m2.1b"><ci id="S4.SS2.p5.2.m2.1.1.cmml" xref="S4.SS2.p5.2.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.2.m2.1c">x</annotation></semantics></math>, the ground-truth label is <math id="S4.SS2.p5.3.m3.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S4.SS2.p5.3.m3.1a"><mi id="S4.SS2.p5.3.m3.1.1" xref="S4.SS2.p5.3.m3.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.3.m3.1b"><ci id="S4.SS2.p5.3.m3.1.1.cmml" xref="S4.SS2.p5.3.m3.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.3.m3.1c">y</annotation></semantics></math>, the adaptive-margin distillation objective is:</p>
<table id="S4.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E4.m1.6" class="ltx_Math" alttext="\mathcal{L}_{\text{adapt}}(x)=-\sum_{c\in\mathcal{C}}\frac{p_{c}^{t}+y_{c}}{2}\log\frac{\exp(v^{s}_{c}-m_{c}^{s})}{\sum_{c^{\prime}\in\mathcal{C}}\exp(v^{s}_{c^{\prime}}-m_{c^{\prime}}^{s})}," display="block"><semantics id="S4.E4.m1.6a"><mrow id="S4.E4.m1.6.6.1" xref="S4.E4.m1.6.6.1.1.cmml"><mrow id="S4.E4.m1.6.6.1.1" xref="S4.E4.m1.6.6.1.1.cmml"><mrow id="S4.E4.m1.6.6.1.1.2" xref="S4.E4.m1.6.6.1.1.2.cmml"><msub id="S4.E4.m1.6.6.1.1.2.2" xref="S4.E4.m1.6.6.1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E4.m1.6.6.1.1.2.2.2" xref="S4.E4.m1.6.6.1.1.2.2.2.cmml">ℒ</mi><mtext id="S4.E4.m1.6.6.1.1.2.2.3" xref="S4.E4.m1.6.6.1.1.2.2.3a.cmml">adapt</mtext></msub><mo lspace="0em" rspace="0em" id="S4.E4.m1.6.6.1.1.2.1" xref="S4.E4.m1.6.6.1.1.2.1.cmml">​</mo><mrow id="S4.E4.m1.6.6.1.1.2.3.2" xref="S4.E4.m1.6.6.1.1.2.cmml"><mo stretchy="false" id="S4.E4.m1.6.6.1.1.2.3.2.1" xref="S4.E4.m1.6.6.1.1.2.cmml">(</mo><mi id="S4.E4.m1.5.5" xref="S4.E4.m1.5.5.cmml">x</mi><mo stretchy="false" id="S4.E4.m1.6.6.1.1.2.3.2.2" xref="S4.E4.m1.6.6.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E4.m1.6.6.1.1.1" xref="S4.E4.m1.6.6.1.1.1.cmml">=</mo><mrow id="S4.E4.m1.6.6.1.1.3" xref="S4.E4.m1.6.6.1.1.3.cmml"><mo id="S4.E4.m1.6.6.1.1.3a" xref="S4.E4.m1.6.6.1.1.3.cmml">−</mo><mrow id="S4.E4.m1.6.6.1.1.3.2" xref="S4.E4.m1.6.6.1.1.3.2.cmml"><munder id="S4.E4.m1.6.6.1.1.3.2.1" xref="S4.E4.m1.6.6.1.1.3.2.1.cmml"><mo movablelimits="false" id="S4.E4.m1.6.6.1.1.3.2.1.2" xref="S4.E4.m1.6.6.1.1.3.2.1.2.cmml">∑</mo><mrow id="S4.E4.m1.6.6.1.1.3.2.1.3" xref="S4.E4.m1.6.6.1.1.3.2.1.3.cmml"><mi id="S4.E4.m1.6.6.1.1.3.2.1.3.2" xref="S4.E4.m1.6.6.1.1.3.2.1.3.2.cmml">c</mi><mo id="S4.E4.m1.6.6.1.1.3.2.1.3.1" xref="S4.E4.m1.6.6.1.1.3.2.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.E4.m1.6.6.1.1.3.2.1.3.3" xref="S4.E4.m1.6.6.1.1.3.2.1.3.3.cmml">𝒞</mi></mrow></munder><mrow id="S4.E4.m1.6.6.1.1.3.2.2" xref="S4.E4.m1.6.6.1.1.3.2.2.cmml"><mfrac id="S4.E4.m1.6.6.1.1.3.2.2.2" xref="S4.E4.m1.6.6.1.1.3.2.2.2.cmml"><mrow id="S4.E4.m1.6.6.1.1.3.2.2.2.2" xref="S4.E4.m1.6.6.1.1.3.2.2.2.2.cmml"><msubsup id="S4.E4.m1.6.6.1.1.3.2.2.2.2.2" xref="S4.E4.m1.6.6.1.1.3.2.2.2.2.2.cmml"><mi id="S4.E4.m1.6.6.1.1.3.2.2.2.2.2.2.2" xref="S4.E4.m1.6.6.1.1.3.2.2.2.2.2.2.2.cmml">p</mi><mi id="S4.E4.m1.6.6.1.1.3.2.2.2.2.2.2.3" xref="S4.E4.m1.6.6.1.1.3.2.2.2.2.2.2.3.cmml">c</mi><mi id="S4.E4.m1.6.6.1.1.3.2.2.2.2.2.3" xref="S4.E4.m1.6.6.1.1.3.2.2.2.2.2.3.cmml">t</mi></msubsup><mo id="S4.E4.m1.6.6.1.1.3.2.2.2.2.1" xref="S4.E4.m1.6.6.1.1.3.2.2.2.2.1.cmml">+</mo><msub id="S4.E4.m1.6.6.1.1.3.2.2.2.2.3" xref="S4.E4.m1.6.6.1.1.3.2.2.2.2.3.cmml"><mi id="S4.E4.m1.6.6.1.1.3.2.2.2.2.3.2" xref="S4.E4.m1.6.6.1.1.3.2.2.2.2.3.2.cmml">y</mi><mi id="S4.E4.m1.6.6.1.1.3.2.2.2.2.3.3" xref="S4.E4.m1.6.6.1.1.3.2.2.2.2.3.3.cmml">c</mi></msub></mrow><mn id="S4.E4.m1.6.6.1.1.3.2.2.2.3" xref="S4.E4.m1.6.6.1.1.3.2.2.2.3.cmml">2</mn></mfrac><mo lspace="0.167em" rspace="0em" id="S4.E4.m1.6.6.1.1.3.2.2.1" xref="S4.E4.m1.6.6.1.1.3.2.2.1.cmml">​</mo><mrow id="S4.E4.m1.6.6.1.1.3.2.2.3" xref="S4.E4.m1.6.6.1.1.3.2.2.3.cmml"><mi id="S4.E4.m1.6.6.1.1.3.2.2.3.1" xref="S4.E4.m1.6.6.1.1.3.2.2.3.1.cmml">log</mi><mo lspace="0.167em" id="S4.E4.m1.6.6.1.1.3.2.2.3a" xref="S4.E4.m1.6.6.1.1.3.2.2.3.cmml">⁡</mo><mfrac id="S4.E4.m1.4.4" xref="S4.E4.m1.4.4.cmml"><mrow id="S4.E4.m1.2.2.2.2" xref="S4.E4.m1.2.2.2.3.cmml"><mi id="S4.E4.m1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.cmml">exp</mi><mo id="S4.E4.m1.2.2.2.2a" xref="S4.E4.m1.2.2.2.3.cmml">⁡</mo><mrow id="S4.E4.m1.2.2.2.2.1" xref="S4.E4.m1.2.2.2.3.cmml"><mo stretchy="false" id="S4.E4.m1.2.2.2.2.1.2" xref="S4.E4.m1.2.2.2.3.cmml">(</mo><mrow id="S4.E4.m1.2.2.2.2.1.1" xref="S4.E4.m1.2.2.2.2.1.1.cmml"><msubsup id="S4.E4.m1.2.2.2.2.1.1.2" xref="S4.E4.m1.2.2.2.2.1.1.2.cmml"><mi id="S4.E4.m1.2.2.2.2.1.1.2.2.2" xref="S4.E4.m1.2.2.2.2.1.1.2.2.2.cmml">v</mi><mi id="S4.E4.m1.2.2.2.2.1.1.2.3" xref="S4.E4.m1.2.2.2.2.1.1.2.3.cmml">c</mi><mi id="S4.E4.m1.2.2.2.2.1.1.2.2.3" xref="S4.E4.m1.2.2.2.2.1.1.2.2.3.cmml">s</mi></msubsup><mo id="S4.E4.m1.2.2.2.2.1.1.1" xref="S4.E4.m1.2.2.2.2.1.1.1.cmml">−</mo><msubsup id="S4.E4.m1.2.2.2.2.1.1.3" xref="S4.E4.m1.2.2.2.2.1.1.3.cmml"><mi id="S4.E4.m1.2.2.2.2.1.1.3.2.2" xref="S4.E4.m1.2.2.2.2.1.1.3.2.2.cmml">m</mi><mi id="S4.E4.m1.2.2.2.2.1.1.3.2.3" xref="S4.E4.m1.2.2.2.2.1.1.3.2.3.cmml">c</mi><mi id="S4.E4.m1.2.2.2.2.1.1.3.3" xref="S4.E4.m1.2.2.2.2.1.1.3.3.cmml">s</mi></msubsup></mrow><mo stretchy="false" id="S4.E4.m1.2.2.2.2.1.3" xref="S4.E4.m1.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="S4.E4.m1.4.4.4" xref="S4.E4.m1.4.4.4.cmml"><msub id="S4.E4.m1.4.4.4.3" xref="S4.E4.m1.4.4.4.3.cmml"><mo id="S4.E4.m1.4.4.4.3.2" xref="S4.E4.m1.4.4.4.3.2.cmml">∑</mo><mrow id="S4.E4.m1.4.4.4.3.3" xref="S4.E4.m1.4.4.4.3.3.cmml"><msup id="S4.E4.m1.4.4.4.3.3.2" xref="S4.E4.m1.4.4.4.3.3.2.cmml"><mi id="S4.E4.m1.4.4.4.3.3.2.2" xref="S4.E4.m1.4.4.4.3.3.2.2.cmml">c</mi><mo id="S4.E4.m1.4.4.4.3.3.2.3" xref="S4.E4.m1.4.4.4.3.3.2.3.cmml">′</mo></msup><mo id="S4.E4.m1.4.4.4.3.3.1" xref="S4.E4.m1.4.4.4.3.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.E4.m1.4.4.4.3.3.3" xref="S4.E4.m1.4.4.4.3.3.3.cmml">𝒞</mi></mrow></msub><mrow id="S4.E4.m1.4.4.4.2.1" xref="S4.E4.m1.4.4.4.2.2.cmml"><mi id="S4.E4.m1.3.3.3.1" xref="S4.E4.m1.3.3.3.1.cmml">exp</mi><mo id="S4.E4.m1.4.4.4.2.1a" xref="S4.E4.m1.4.4.4.2.2.cmml">⁡</mo><mrow id="S4.E4.m1.4.4.4.2.1.1" xref="S4.E4.m1.4.4.4.2.2.cmml"><mo stretchy="false" id="S4.E4.m1.4.4.4.2.1.1.2" xref="S4.E4.m1.4.4.4.2.2.cmml">(</mo><mrow id="S4.E4.m1.4.4.4.2.1.1.1" xref="S4.E4.m1.4.4.4.2.1.1.1.cmml"><msubsup id="S4.E4.m1.4.4.4.2.1.1.1.2" xref="S4.E4.m1.4.4.4.2.1.1.1.2.cmml"><mi id="S4.E4.m1.4.4.4.2.1.1.1.2.2.2" xref="S4.E4.m1.4.4.4.2.1.1.1.2.2.2.cmml">v</mi><msup id="S4.E4.m1.4.4.4.2.1.1.1.2.3" xref="S4.E4.m1.4.4.4.2.1.1.1.2.3.cmml"><mi id="S4.E4.m1.4.4.4.2.1.1.1.2.3.2" xref="S4.E4.m1.4.4.4.2.1.1.1.2.3.2.cmml">c</mi><mo id="S4.E4.m1.4.4.4.2.1.1.1.2.3.3" xref="S4.E4.m1.4.4.4.2.1.1.1.2.3.3.cmml">′</mo></msup><mi id="S4.E4.m1.4.4.4.2.1.1.1.2.2.3" xref="S4.E4.m1.4.4.4.2.1.1.1.2.2.3.cmml">s</mi></msubsup><mo id="S4.E4.m1.4.4.4.2.1.1.1.1" xref="S4.E4.m1.4.4.4.2.1.1.1.1.cmml">−</mo><msubsup id="S4.E4.m1.4.4.4.2.1.1.1.3" xref="S4.E4.m1.4.4.4.2.1.1.1.3.cmml"><mi id="S4.E4.m1.4.4.4.2.1.1.1.3.2.2" xref="S4.E4.m1.4.4.4.2.1.1.1.3.2.2.cmml">m</mi><msup id="S4.E4.m1.4.4.4.2.1.1.1.3.2.3" xref="S4.E4.m1.4.4.4.2.1.1.1.3.2.3.cmml"><mi id="S4.E4.m1.4.4.4.2.1.1.1.3.2.3.2" xref="S4.E4.m1.4.4.4.2.1.1.1.3.2.3.2.cmml">c</mi><mo id="S4.E4.m1.4.4.4.2.1.1.1.3.2.3.3" xref="S4.E4.m1.4.4.4.2.1.1.1.3.2.3.3.cmml">′</mo></msup><mi id="S4.E4.m1.4.4.4.2.1.1.1.3.3" xref="S4.E4.m1.4.4.4.2.1.1.1.3.3.cmml">s</mi></msubsup></mrow><mo stretchy="false" id="S4.E4.m1.4.4.4.2.1.1.3" xref="S4.E4.m1.4.4.4.2.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow></mrow></mrow></mrow></mrow><mo id="S4.E4.m1.6.6.1.2" xref="S4.E4.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.6b"><apply id="S4.E4.m1.6.6.1.1.cmml" xref="S4.E4.m1.6.6.1"><eq id="S4.E4.m1.6.6.1.1.1.cmml" xref="S4.E4.m1.6.6.1.1.1"></eq><apply id="S4.E4.m1.6.6.1.1.2.cmml" xref="S4.E4.m1.6.6.1.1.2"><times id="S4.E4.m1.6.6.1.1.2.1.cmml" xref="S4.E4.m1.6.6.1.1.2.1"></times><apply id="S4.E4.m1.6.6.1.1.2.2.cmml" xref="S4.E4.m1.6.6.1.1.2.2"><csymbol cd="ambiguous" id="S4.E4.m1.6.6.1.1.2.2.1.cmml" xref="S4.E4.m1.6.6.1.1.2.2">subscript</csymbol><ci id="S4.E4.m1.6.6.1.1.2.2.2.cmml" xref="S4.E4.m1.6.6.1.1.2.2.2">ℒ</ci><ci id="S4.E4.m1.6.6.1.1.2.2.3a.cmml" xref="S4.E4.m1.6.6.1.1.2.2.3"><mtext mathsize="70%" id="S4.E4.m1.6.6.1.1.2.2.3.cmml" xref="S4.E4.m1.6.6.1.1.2.2.3">adapt</mtext></ci></apply><ci id="S4.E4.m1.5.5.cmml" xref="S4.E4.m1.5.5">𝑥</ci></apply><apply id="S4.E4.m1.6.6.1.1.3.cmml" xref="S4.E4.m1.6.6.1.1.3"><minus id="S4.E4.m1.6.6.1.1.3.1.cmml" xref="S4.E4.m1.6.6.1.1.3"></minus><apply id="S4.E4.m1.6.6.1.1.3.2.cmml" xref="S4.E4.m1.6.6.1.1.3.2"><apply id="S4.E4.m1.6.6.1.1.3.2.1.cmml" xref="S4.E4.m1.6.6.1.1.3.2.1"><csymbol cd="ambiguous" id="S4.E4.m1.6.6.1.1.3.2.1.1.cmml" xref="S4.E4.m1.6.6.1.1.3.2.1">subscript</csymbol><sum id="S4.E4.m1.6.6.1.1.3.2.1.2.cmml" xref="S4.E4.m1.6.6.1.1.3.2.1.2"></sum><apply id="S4.E4.m1.6.6.1.1.3.2.1.3.cmml" xref="S4.E4.m1.6.6.1.1.3.2.1.3"><in id="S4.E4.m1.6.6.1.1.3.2.1.3.1.cmml" xref="S4.E4.m1.6.6.1.1.3.2.1.3.1"></in><ci id="S4.E4.m1.6.6.1.1.3.2.1.3.2.cmml" xref="S4.E4.m1.6.6.1.1.3.2.1.3.2">𝑐</ci><ci id="S4.E4.m1.6.6.1.1.3.2.1.3.3.cmml" xref="S4.E4.m1.6.6.1.1.3.2.1.3.3">𝒞</ci></apply></apply><apply id="S4.E4.m1.6.6.1.1.3.2.2.cmml" xref="S4.E4.m1.6.6.1.1.3.2.2"><times id="S4.E4.m1.6.6.1.1.3.2.2.1.cmml" xref="S4.E4.m1.6.6.1.1.3.2.2.1"></times><apply id="S4.E4.m1.6.6.1.1.3.2.2.2.cmml" xref="S4.E4.m1.6.6.1.1.3.2.2.2"><divide id="S4.E4.m1.6.6.1.1.3.2.2.2.1.cmml" xref="S4.E4.m1.6.6.1.1.3.2.2.2"></divide><apply id="S4.E4.m1.6.6.1.1.3.2.2.2.2.cmml" xref="S4.E4.m1.6.6.1.1.3.2.2.2.2"><plus id="S4.E4.m1.6.6.1.1.3.2.2.2.2.1.cmml" xref="S4.E4.m1.6.6.1.1.3.2.2.2.2.1"></plus><apply id="S4.E4.m1.6.6.1.1.3.2.2.2.2.2.cmml" xref="S4.E4.m1.6.6.1.1.3.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E4.m1.6.6.1.1.3.2.2.2.2.2.1.cmml" xref="S4.E4.m1.6.6.1.1.3.2.2.2.2.2">superscript</csymbol><apply id="S4.E4.m1.6.6.1.1.3.2.2.2.2.2.2.cmml" xref="S4.E4.m1.6.6.1.1.3.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E4.m1.6.6.1.1.3.2.2.2.2.2.2.1.cmml" xref="S4.E4.m1.6.6.1.1.3.2.2.2.2.2">subscript</csymbol><ci id="S4.E4.m1.6.6.1.1.3.2.2.2.2.2.2.2.cmml" xref="S4.E4.m1.6.6.1.1.3.2.2.2.2.2.2.2">𝑝</ci><ci id="S4.E4.m1.6.6.1.1.3.2.2.2.2.2.2.3.cmml" xref="S4.E4.m1.6.6.1.1.3.2.2.2.2.2.2.3">𝑐</ci></apply><ci id="S4.E4.m1.6.6.1.1.3.2.2.2.2.2.3.cmml" xref="S4.E4.m1.6.6.1.1.3.2.2.2.2.2.3">𝑡</ci></apply><apply id="S4.E4.m1.6.6.1.1.3.2.2.2.2.3.cmml" xref="S4.E4.m1.6.6.1.1.3.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E4.m1.6.6.1.1.3.2.2.2.2.3.1.cmml" xref="S4.E4.m1.6.6.1.1.3.2.2.2.2.3">subscript</csymbol><ci id="S4.E4.m1.6.6.1.1.3.2.2.2.2.3.2.cmml" xref="S4.E4.m1.6.6.1.1.3.2.2.2.2.3.2">𝑦</ci><ci id="S4.E4.m1.6.6.1.1.3.2.2.2.2.3.3.cmml" xref="S4.E4.m1.6.6.1.1.3.2.2.2.2.3.3">𝑐</ci></apply></apply><cn type="integer" id="S4.E4.m1.6.6.1.1.3.2.2.2.3.cmml" xref="S4.E4.m1.6.6.1.1.3.2.2.2.3">2</cn></apply><apply id="S4.E4.m1.6.6.1.1.3.2.2.3.cmml" xref="S4.E4.m1.6.6.1.1.3.2.2.3"><log id="S4.E4.m1.6.6.1.1.3.2.2.3.1.cmml" xref="S4.E4.m1.6.6.1.1.3.2.2.3.1"></log><apply id="S4.E4.m1.4.4.cmml" xref="S4.E4.m1.4.4"><divide id="S4.E4.m1.4.4.5.cmml" xref="S4.E4.m1.4.4"></divide><apply id="S4.E4.m1.2.2.2.3.cmml" xref="S4.E4.m1.2.2.2.2"><exp id="S4.E4.m1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1"></exp><apply id="S4.E4.m1.2.2.2.2.1.1.cmml" xref="S4.E4.m1.2.2.2.2.1.1"><minus id="S4.E4.m1.2.2.2.2.1.1.1.cmml" xref="S4.E4.m1.2.2.2.2.1.1.1"></minus><apply id="S4.E4.m1.2.2.2.2.1.1.2.cmml" xref="S4.E4.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S4.E4.m1.2.2.2.2.1.1.2.1.cmml" xref="S4.E4.m1.2.2.2.2.1.1.2">subscript</csymbol><apply id="S4.E4.m1.2.2.2.2.1.1.2.2.cmml" xref="S4.E4.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S4.E4.m1.2.2.2.2.1.1.2.2.1.cmml" xref="S4.E4.m1.2.2.2.2.1.1.2">superscript</csymbol><ci id="S4.E4.m1.2.2.2.2.1.1.2.2.2.cmml" xref="S4.E4.m1.2.2.2.2.1.1.2.2.2">𝑣</ci><ci id="S4.E4.m1.2.2.2.2.1.1.2.2.3.cmml" xref="S4.E4.m1.2.2.2.2.1.1.2.2.3">𝑠</ci></apply><ci id="S4.E4.m1.2.2.2.2.1.1.2.3.cmml" xref="S4.E4.m1.2.2.2.2.1.1.2.3">𝑐</ci></apply><apply id="S4.E4.m1.2.2.2.2.1.1.3.cmml" xref="S4.E4.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.2.2.2.2.1.1.3.1.cmml" xref="S4.E4.m1.2.2.2.2.1.1.3">superscript</csymbol><apply id="S4.E4.m1.2.2.2.2.1.1.3.2.cmml" xref="S4.E4.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.2.2.2.2.1.1.3.2.1.cmml" xref="S4.E4.m1.2.2.2.2.1.1.3">subscript</csymbol><ci id="S4.E4.m1.2.2.2.2.1.1.3.2.2.cmml" xref="S4.E4.m1.2.2.2.2.1.1.3.2.2">𝑚</ci><ci id="S4.E4.m1.2.2.2.2.1.1.3.2.3.cmml" xref="S4.E4.m1.2.2.2.2.1.1.3.2.3">𝑐</ci></apply><ci id="S4.E4.m1.2.2.2.2.1.1.3.3.cmml" xref="S4.E4.m1.2.2.2.2.1.1.3.3">𝑠</ci></apply></apply></apply><apply id="S4.E4.m1.4.4.4.cmml" xref="S4.E4.m1.4.4.4"><apply id="S4.E4.m1.4.4.4.3.cmml" xref="S4.E4.m1.4.4.4.3"><csymbol cd="ambiguous" id="S4.E4.m1.4.4.4.3.1.cmml" xref="S4.E4.m1.4.4.4.3">subscript</csymbol><sum id="S4.E4.m1.4.4.4.3.2.cmml" xref="S4.E4.m1.4.4.4.3.2"></sum><apply id="S4.E4.m1.4.4.4.3.3.cmml" xref="S4.E4.m1.4.4.4.3.3"><in id="S4.E4.m1.4.4.4.3.3.1.cmml" xref="S4.E4.m1.4.4.4.3.3.1"></in><apply id="S4.E4.m1.4.4.4.3.3.2.cmml" xref="S4.E4.m1.4.4.4.3.3.2"><csymbol cd="ambiguous" id="S4.E4.m1.4.4.4.3.3.2.1.cmml" xref="S4.E4.m1.4.4.4.3.3.2">superscript</csymbol><ci id="S4.E4.m1.4.4.4.3.3.2.2.cmml" xref="S4.E4.m1.4.4.4.3.3.2.2">𝑐</ci><ci id="S4.E4.m1.4.4.4.3.3.2.3.cmml" xref="S4.E4.m1.4.4.4.3.3.2.3">′</ci></apply><ci id="S4.E4.m1.4.4.4.3.3.3.cmml" xref="S4.E4.m1.4.4.4.3.3.3">𝒞</ci></apply></apply><apply id="S4.E4.m1.4.4.4.2.2.cmml" xref="S4.E4.m1.4.4.4.2.1"><exp id="S4.E4.m1.3.3.3.1.cmml" xref="S4.E4.m1.3.3.3.1"></exp><apply id="S4.E4.m1.4.4.4.2.1.1.1.cmml" xref="S4.E4.m1.4.4.4.2.1.1.1"><minus id="S4.E4.m1.4.4.4.2.1.1.1.1.cmml" xref="S4.E4.m1.4.4.4.2.1.1.1.1"></minus><apply id="S4.E4.m1.4.4.4.2.1.1.1.2.cmml" xref="S4.E4.m1.4.4.4.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.E4.m1.4.4.4.2.1.1.1.2.1.cmml" xref="S4.E4.m1.4.4.4.2.1.1.1.2">subscript</csymbol><apply id="S4.E4.m1.4.4.4.2.1.1.1.2.2.cmml" xref="S4.E4.m1.4.4.4.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.E4.m1.4.4.4.2.1.1.1.2.2.1.cmml" xref="S4.E4.m1.4.4.4.2.1.1.1.2">superscript</csymbol><ci id="S4.E4.m1.4.4.4.2.1.1.1.2.2.2.cmml" xref="S4.E4.m1.4.4.4.2.1.1.1.2.2.2">𝑣</ci><ci id="S4.E4.m1.4.4.4.2.1.1.1.2.2.3.cmml" xref="S4.E4.m1.4.4.4.2.1.1.1.2.2.3">𝑠</ci></apply><apply id="S4.E4.m1.4.4.4.2.1.1.1.2.3.cmml" xref="S4.E4.m1.4.4.4.2.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E4.m1.4.4.4.2.1.1.1.2.3.1.cmml" xref="S4.E4.m1.4.4.4.2.1.1.1.2.3">superscript</csymbol><ci id="S4.E4.m1.4.4.4.2.1.1.1.2.3.2.cmml" xref="S4.E4.m1.4.4.4.2.1.1.1.2.3.2">𝑐</ci><ci id="S4.E4.m1.4.4.4.2.1.1.1.2.3.3.cmml" xref="S4.E4.m1.4.4.4.2.1.1.1.2.3.3">′</ci></apply></apply><apply id="S4.E4.m1.4.4.4.2.1.1.1.3.cmml" xref="S4.E4.m1.4.4.4.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.4.4.4.2.1.1.1.3.1.cmml" xref="S4.E4.m1.4.4.4.2.1.1.1.3">superscript</csymbol><apply id="S4.E4.m1.4.4.4.2.1.1.1.3.2.cmml" xref="S4.E4.m1.4.4.4.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.4.4.4.2.1.1.1.3.2.1.cmml" xref="S4.E4.m1.4.4.4.2.1.1.1.3">subscript</csymbol><ci id="S4.E4.m1.4.4.4.2.1.1.1.3.2.2.cmml" xref="S4.E4.m1.4.4.4.2.1.1.1.3.2.2">𝑚</ci><apply id="S4.E4.m1.4.4.4.2.1.1.1.3.2.3.cmml" xref="S4.E4.m1.4.4.4.2.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E4.m1.4.4.4.2.1.1.1.3.2.3.1.cmml" xref="S4.E4.m1.4.4.4.2.1.1.1.3.2.3">superscript</csymbol><ci id="S4.E4.m1.4.4.4.2.1.1.1.3.2.3.2.cmml" xref="S4.E4.m1.4.4.4.2.1.1.1.3.2.3.2">𝑐</ci><ci id="S4.E4.m1.4.4.4.2.1.1.1.3.2.3.3.cmml" xref="S4.E4.m1.4.4.4.2.1.1.1.3.2.3.3">′</ci></apply></apply><ci id="S4.E4.m1.4.4.4.2.1.1.1.3.3.cmml" xref="S4.E4.m1.4.4.4.2.1.1.1.3.3">𝑠</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.6c">\mathcal{L}_{\text{adapt}}(x)=-\sum_{c\in\mathcal{C}}\frac{p_{c}^{t}+y_{c}}{2}\log\frac{\exp(v^{s}_{c}-m_{c}^{s})}{\sum_{c^{\prime}\in\mathcal{C}}\exp(v^{s}_{c^{\prime}}-m_{c^{\prime}}^{s})},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p5.11" class="ltx_p">where the predicted probability for class <math id="S4.SS2.p5.4.m1.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S4.SS2.p5.4.m1.1a"><mi id="S4.SS2.p5.4.m1.1.1" xref="S4.SS2.p5.4.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.4.m1.1b"><ci id="S4.SS2.p5.4.m1.1.1.cmml" xref="S4.SS2.p5.4.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.4.m1.1c">c</annotation></semantics></math> of the teacher model <math id="S4.SS2.p5.5.m2.1" class="ltx_Math" alttext="p^{t}_{c}" display="inline"><semantics id="S4.SS2.p5.5.m2.1a"><msubsup id="S4.SS2.p5.5.m2.1.1" xref="S4.SS2.p5.5.m2.1.1.cmml"><mi id="S4.SS2.p5.5.m2.1.1.2.2" xref="S4.SS2.p5.5.m2.1.1.2.2.cmml">p</mi><mi id="S4.SS2.p5.5.m2.1.1.3" xref="S4.SS2.p5.5.m2.1.1.3.cmml">c</mi><mi id="S4.SS2.p5.5.m2.1.1.2.3" xref="S4.SS2.p5.5.m2.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.5.m2.1b"><apply id="S4.SS2.p5.5.m2.1.1.cmml" xref="S4.SS2.p5.5.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.5.m2.1.1.1.cmml" xref="S4.SS2.p5.5.m2.1.1">subscript</csymbol><apply id="S4.SS2.p5.5.m2.1.1.2.cmml" xref="S4.SS2.p5.5.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.5.m2.1.1.2.1.cmml" xref="S4.SS2.p5.5.m2.1.1">superscript</csymbol><ci id="S4.SS2.p5.5.m2.1.1.2.2.cmml" xref="S4.SS2.p5.5.m2.1.1.2.2">𝑝</ci><ci id="S4.SS2.p5.5.m2.1.1.2.3.cmml" xref="S4.SS2.p5.5.m2.1.1.2.3">𝑡</ci></apply><ci id="S4.SS2.p5.5.m2.1.1.3.cmml" xref="S4.SS2.p5.5.m2.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.5.m2.1c">p^{t}_{c}</annotation></semantics></math> is obtained by <math id="S4.SS2.p5.6.m3.4" class="ltx_Math" alttext="\frac{\exp(v_{c}-m_{c})}{\sum_{c^{\prime}\in\mathcal{C}}\exp(v_{c^{\prime}}-m_{c^{\prime}})}" display="inline"><semantics id="S4.SS2.p5.6.m3.4a"><mfrac id="S4.SS2.p5.6.m3.4.4" xref="S4.SS2.p5.6.m3.4.4.cmml"><mrow id="S4.SS2.p5.6.m3.2.2.2.2" xref="S4.SS2.p5.6.m3.2.2.2.3.cmml"><mi id="S4.SS2.p5.6.m3.1.1.1.1" xref="S4.SS2.p5.6.m3.1.1.1.1.cmml">exp</mi><mo id="S4.SS2.p5.6.m3.2.2.2.2a" xref="S4.SS2.p5.6.m3.2.2.2.3.cmml">⁡</mo><mrow id="S4.SS2.p5.6.m3.2.2.2.2.1" xref="S4.SS2.p5.6.m3.2.2.2.3.cmml"><mo stretchy="false" id="S4.SS2.p5.6.m3.2.2.2.2.1.2" xref="S4.SS2.p5.6.m3.2.2.2.3.cmml">(</mo><mrow id="S4.SS2.p5.6.m3.2.2.2.2.1.1" xref="S4.SS2.p5.6.m3.2.2.2.2.1.1.cmml"><msub id="S4.SS2.p5.6.m3.2.2.2.2.1.1.2" xref="S4.SS2.p5.6.m3.2.2.2.2.1.1.2.cmml"><mi id="S4.SS2.p5.6.m3.2.2.2.2.1.1.2.2" xref="S4.SS2.p5.6.m3.2.2.2.2.1.1.2.2.cmml">v</mi><mi id="S4.SS2.p5.6.m3.2.2.2.2.1.1.2.3" xref="S4.SS2.p5.6.m3.2.2.2.2.1.1.2.3.cmml">c</mi></msub><mo id="S4.SS2.p5.6.m3.2.2.2.2.1.1.1" xref="S4.SS2.p5.6.m3.2.2.2.2.1.1.1.cmml">−</mo><msub id="S4.SS2.p5.6.m3.2.2.2.2.1.1.3" xref="S4.SS2.p5.6.m3.2.2.2.2.1.1.3.cmml"><mi id="S4.SS2.p5.6.m3.2.2.2.2.1.1.3.2" xref="S4.SS2.p5.6.m3.2.2.2.2.1.1.3.2.cmml">m</mi><mi id="S4.SS2.p5.6.m3.2.2.2.2.1.1.3.3" xref="S4.SS2.p5.6.m3.2.2.2.2.1.1.3.3.cmml">c</mi></msub></mrow><mo stretchy="false" id="S4.SS2.p5.6.m3.2.2.2.2.1.3" xref="S4.SS2.p5.6.m3.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="S4.SS2.p5.6.m3.4.4.4" xref="S4.SS2.p5.6.m3.4.4.4.cmml"><mstyle displaystyle="false" id="S4.SS2.p5.6.m3.4.4.4.3" xref="S4.SS2.p5.6.m3.4.4.4.3.cmml"><msub id="S4.SS2.p5.6.m3.4.4.4.3a" xref="S4.SS2.p5.6.m3.4.4.4.3.cmml"><mo id="S4.SS2.p5.6.m3.4.4.4.3.2" xref="S4.SS2.p5.6.m3.4.4.4.3.2.cmml">∑</mo><mrow id="S4.SS2.p5.6.m3.4.4.4.3.3" xref="S4.SS2.p5.6.m3.4.4.4.3.3.cmml"><msup id="S4.SS2.p5.6.m3.4.4.4.3.3.2" xref="S4.SS2.p5.6.m3.4.4.4.3.3.2.cmml"><mi id="S4.SS2.p5.6.m3.4.4.4.3.3.2.2" xref="S4.SS2.p5.6.m3.4.4.4.3.3.2.2.cmml">c</mi><mo id="S4.SS2.p5.6.m3.4.4.4.3.3.2.3" xref="S4.SS2.p5.6.m3.4.4.4.3.3.2.3.cmml">′</mo></msup><mo id="S4.SS2.p5.6.m3.4.4.4.3.3.1" xref="S4.SS2.p5.6.m3.4.4.4.3.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p5.6.m3.4.4.4.3.3.3" xref="S4.SS2.p5.6.m3.4.4.4.3.3.3.cmml">𝒞</mi></mrow></msub></mstyle><mrow id="S4.SS2.p5.6.m3.4.4.4.2.1" xref="S4.SS2.p5.6.m3.4.4.4.2.2.cmml"><mi id="S4.SS2.p5.6.m3.3.3.3.1" xref="S4.SS2.p5.6.m3.3.3.3.1.cmml">exp</mi><mo id="S4.SS2.p5.6.m3.4.4.4.2.1a" xref="S4.SS2.p5.6.m3.4.4.4.2.2.cmml">⁡</mo><mrow id="S4.SS2.p5.6.m3.4.4.4.2.1.1" xref="S4.SS2.p5.6.m3.4.4.4.2.2.cmml"><mo stretchy="false" id="S4.SS2.p5.6.m3.4.4.4.2.1.1.2" xref="S4.SS2.p5.6.m3.4.4.4.2.2.cmml">(</mo><mrow id="S4.SS2.p5.6.m3.4.4.4.2.1.1.1" xref="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.cmml"><msub id="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.2" xref="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.2.cmml"><mi id="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.2.2" xref="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.2.2.cmml">v</mi><msup id="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.2.3" xref="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.2.3.cmml"><mi id="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.2.3.2" xref="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.2.3.2.cmml">c</mi><mo id="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.2.3.3" xref="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.2.3.3.cmml">′</mo></msup></msub><mo id="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.1" xref="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.1.cmml">−</mo><msub id="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.3" xref="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.3.cmml"><mi id="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.3.2" xref="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.3.2.cmml">m</mi><msup id="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.3.3" xref="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.3.3.cmml"><mi id="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.3.3.2" xref="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.3.3.2.cmml">c</mi><mo id="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.3.3.3" xref="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.3.3.3.cmml">′</mo></msup></msub></mrow><mo stretchy="false" id="S4.SS2.p5.6.m3.4.4.4.2.1.1.3" xref="S4.SS2.p5.6.m3.4.4.4.2.2.cmml">)</mo></mrow></mrow></mrow></mfrac><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.6.m3.4b"><apply id="S4.SS2.p5.6.m3.4.4.cmml" xref="S4.SS2.p5.6.m3.4.4"><divide id="S4.SS2.p5.6.m3.4.4.5.cmml" xref="S4.SS2.p5.6.m3.4.4"></divide><apply id="S4.SS2.p5.6.m3.2.2.2.3.cmml" xref="S4.SS2.p5.6.m3.2.2.2.2"><exp id="S4.SS2.p5.6.m3.1.1.1.1.cmml" xref="S4.SS2.p5.6.m3.1.1.1.1"></exp><apply id="S4.SS2.p5.6.m3.2.2.2.2.1.1.cmml" xref="S4.SS2.p5.6.m3.2.2.2.2.1.1"><minus id="S4.SS2.p5.6.m3.2.2.2.2.1.1.1.cmml" xref="S4.SS2.p5.6.m3.2.2.2.2.1.1.1"></minus><apply id="S4.SS2.p5.6.m3.2.2.2.2.1.1.2.cmml" xref="S4.SS2.p5.6.m3.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p5.6.m3.2.2.2.2.1.1.2.1.cmml" xref="S4.SS2.p5.6.m3.2.2.2.2.1.1.2">subscript</csymbol><ci id="S4.SS2.p5.6.m3.2.2.2.2.1.1.2.2.cmml" xref="S4.SS2.p5.6.m3.2.2.2.2.1.1.2.2">𝑣</ci><ci id="S4.SS2.p5.6.m3.2.2.2.2.1.1.2.3.cmml" xref="S4.SS2.p5.6.m3.2.2.2.2.1.1.2.3">𝑐</ci></apply><apply id="S4.SS2.p5.6.m3.2.2.2.2.1.1.3.cmml" xref="S4.SS2.p5.6.m3.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p5.6.m3.2.2.2.2.1.1.3.1.cmml" xref="S4.SS2.p5.6.m3.2.2.2.2.1.1.3">subscript</csymbol><ci id="S4.SS2.p5.6.m3.2.2.2.2.1.1.3.2.cmml" xref="S4.SS2.p5.6.m3.2.2.2.2.1.1.3.2">𝑚</ci><ci id="S4.SS2.p5.6.m3.2.2.2.2.1.1.3.3.cmml" xref="S4.SS2.p5.6.m3.2.2.2.2.1.1.3.3">𝑐</ci></apply></apply></apply><apply id="S4.SS2.p5.6.m3.4.4.4.cmml" xref="S4.SS2.p5.6.m3.4.4.4"><apply id="S4.SS2.p5.6.m3.4.4.4.3.cmml" xref="S4.SS2.p5.6.m3.4.4.4.3"><csymbol cd="ambiguous" id="S4.SS2.p5.6.m3.4.4.4.3.1.cmml" xref="S4.SS2.p5.6.m3.4.4.4.3">subscript</csymbol><sum id="S4.SS2.p5.6.m3.4.4.4.3.2.cmml" xref="S4.SS2.p5.6.m3.4.4.4.3.2"></sum><apply id="S4.SS2.p5.6.m3.4.4.4.3.3.cmml" xref="S4.SS2.p5.6.m3.4.4.4.3.3"><in id="S4.SS2.p5.6.m3.4.4.4.3.3.1.cmml" xref="S4.SS2.p5.6.m3.4.4.4.3.3.1"></in><apply id="S4.SS2.p5.6.m3.4.4.4.3.3.2.cmml" xref="S4.SS2.p5.6.m3.4.4.4.3.3.2"><csymbol cd="ambiguous" id="S4.SS2.p5.6.m3.4.4.4.3.3.2.1.cmml" xref="S4.SS2.p5.6.m3.4.4.4.3.3.2">superscript</csymbol><ci id="S4.SS2.p5.6.m3.4.4.4.3.3.2.2.cmml" xref="S4.SS2.p5.6.m3.4.4.4.3.3.2.2">𝑐</ci><ci id="S4.SS2.p5.6.m3.4.4.4.3.3.2.3.cmml" xref="S4.SS2.p5.6.m3.4.4.4.3.3.2.3">′</ci></apply><ci id="S4.SS2.p5.6.m3.4.4.4.3.3.3.cmml" xref="S4.SS2.p5.6.m3.4.4.4.3.3.3">𝒞</ci></apply></apply><apply id="S4.SS2.p5.6.m3.4.4.4.2.2.cmml" xref="S4.SS2.p5.6.m3.4.4.4.2.1"><exp id="S4.SS2.p5.6.m3.3.3.3.1.cmml" xref="S4.SS2.p5.6.m3.3.3.3.1"></exp><apply id="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.cmml" xref="S4.SS2.p5.6.m3.4.4.4.2.1.1.1"><minus id="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.1.cmml" xref="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.1"></minus><apply id="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.2.cmml" xref="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.2.1.cmml" xref="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.2">subscript</csymbol><ci id="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.2.2.cmml" xref="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.2.2">𝑣</ci><apply id="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.2.3.cmml" xref="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.2.3.1.cmml" xref="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.2.3">superscript</csymbol><ci id="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.2.3.2.cmml" xref="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.2.3.2">𝑐</ci><ci id="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.2.3.3.cmml" xref="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.2.3.3">′</ci></apply></apply><apply id="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.3.cmml" xref="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.3.1.cmml" xref="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.3">subscript</csymbol><ci id="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.3.2.cmml" xref="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.3.2">𝑚</ci><apply id="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.3.3.cmml" xref="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.3.3.1.cmml" xref="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.3.3">superscript</csymbol><ci id="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.3.3.2.cmml" xref="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.3.3.2">𝑐</ci><ci id="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.3.3.3.cmml" xref="S4.SS2.p5.6.m3.4.4.4.2.1.1.1.3.3.3">′</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.6.m3.4c">\frac{\exp(v_{c}-m_{c})}{\sum_{c^{\prime}\in\mathcal{C}}\exp(v_{c^{\prime}}-m_{c^{\prime}})}</annotation></semantics></math>, <math id="S4.SS2.p5.7.m4.1" class="ltx_Math" alttext="v^{s}_{c}" display="inline"><semantics id="S4.SS2.p5.7.m4.1a"><msubsup id="S4.SS2.p5.7.m4.1.1" xref="S4.SS2.p5.7.m4.1.1.cmml"><mi id="S4.SS2.p5.7.m4.1.1.2.2" xref="S4.SS2.p5.7.m4.1.1.2.2.cmml">v</mi><mi id="S4.SS2.p5.7.m4.1.1.3" xref="S4.SS2.p5.7.m4.1.1.3.cmml">c</mi><mi id="S4.SS2.p5.7.m4.1.1.2.3" xref="S4.SS2.p5.7.m4.1.1.2.3.cmml">s</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.7.m4.1b"><apply id="S4.SS2.p5.7.m4.1.1.cmml" xref="S4.SS2.p5.7.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.7.m4.1.1.1.cmml" xref="S4.SS2.p5.7.m4.1.1">subscript</csymbol><apply id="S4.SS2.p5.7.m4.1.1.2.cmml" xref="S4.SS2.p5.7.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.7.m4.1.1.2.1.cmml" xref="S4.SS2.p5.7.m4.1.1">superscript</csymbol><ci id="S4.SS2.p5.7.m4.1.1.2.2.cmml" xref="S4.SS2.p5.7.m4.1.1.2.2">𝑣</ci><ci id="S4.SS2.p5.7.m4.1.1.2.3.cmml" xref="S4.SS2.p5.7.m4.1.1.2.3">𝑠</ci></apply><ci id="S4.SS2.p5.7.m4.1.1.3.cmml" xref="S4.SS2.p5.7.m4.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.7.m4.1c">v^{s}_{c}</annotation></semantics></math> denotes the logit output for class <math id="S4.SS2.p5.8.m5.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S4.SS2.p5.8.m5.1a"><mi id="S4.SS2.p5.8.m5.1.1" xref="S4.SS2.p5.8.m5.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.8.m5.1b"><ci id="S4.SS2.p5.8.m5.1.1.cmml" xref="S4.SS2.p5.8.m5.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.8.m5.1c">c</annotation></semantics></math> of the student model, and <math id="S4.SS2.p5.9.m6.1" class="ltx_Math" alttext="m^{s}_{c}" display="inline"><semantics id="S4.SS2.p5.9.m6.1a"><msubsup id="S4.SS2.p5.9.m6.1.1" xref="S4.SS2.p5.9.m6.1.1.cmml"><mi id="S4.SS2.p5.9.m6.1.1.2.2" xref="S4.SS2.p5.9.m6.1.1.2.2.cmml">m</mi><mi id="S4.SS2.p5.9.m6.1.1.3" xref="S4.SS2.p5.9.m6.1.1.3.cmml">c</mi><mi id="S4.SS2.p5.9.m6.1.1.2.3" xref="S4.SS2.p5.9.m6.1.1.2.3.cmml">s</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.9.m6.1b"><apply id="S4.SS2.p5.9.m6.1.1.cmml" xref="S4.SS2.p5.9.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.9.m6.1.1.1.cmml" xref="S4.SS2.p5.9.m6.1.1">subscript</csymbol><apply id="S4.SS2.p5.9.m6.1.1.2.cmml" xref="S4.SS2.p5.9.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.9.m6.1.1.2.1.cmml" xref="S4.SS2.p5.9.m6.1.1">superscript</csymbol><ci id="S4.SS2.p5.9.m6.1.1.2.2.cmml" xref="S4.SS2.p5.9.m6.1.1.2.2">𝑚</ci><ci id="S4.SS2.p5.9.m6.1.1.2.3.cmml" xref="S4.SS2.p5.9.m6.1.1.2.3">𝑠</ci></apply><ci id="S4.SS2.p5.9.m6.1.1.3.cmml" xref="S4.SS2.p5.9.m6.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.9.m6.1c">m^{s}_{c}</annotation></semantics></math> denotes the adaptive learnable margin for class <math id="S4.SS2.p5.10.m7.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S4.SS2.p5.10.m7.1a"><mi id="S4.SS2.p5.10.m7.1.1" xref="S4.SS2.p5.10.m7.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.10.m7.1b"><ci id="S4.SS2.p5.10.m7.1.1.cmml" xref="S4.SS2.p5.10.m7.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.10.m7.1c">c</annotation></semantics></math>. The teacher model is fixed during self distillation, and the student detection head uses the same ETF classifier weights <math id="S4.SS2.p5.11.m8.1" class="ltx_Math" alttext="W^{*}" display="inline"><semantics id="S4.SS2.p5.11.m8.1a"><msup id="S4.SS2.p5.11.m8.1.1" xref="S4.SS2.p5.11.m8.1.1.cmml"><mi id="S4.SS2.p5.11.m8.1.1.2" xref="S4.SS2.p5.11.m8.1.1.2.cmml">W</mi><mo id="S4.SS2.p5.11.m8.1.1.3" xref="S4.SS2.p5.11.m8.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.11.m8.1b"><apply id="S4.SS2.p5.11.m8.1.1.cmml" xref="S4.SS2.p5.11.m8.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.11.m8.1.1.1.cmml" xref="S4.SS2.p5.11.m8.1.1">superscript</csymbol><ci id="S4.SS2.p5.11.m8.1.1.2.cmml" xref="S4.SS2.p5.11.m8.1.1.2">𝑊</ci><times id="S4.SS2.p5.11.m8.1.1.3.cmml" xref="S4.SS2.p5.11.m8.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.11.m8.1c">W^{*}</annotation></semantics></math> with other parts in the detection module to be learned. Finally, we use the student model for evaluation.</p>
</div>
<div id="S4.SS2.p6" class="ltx_para">
<p id="S4.SS2.p6.1" class="ltx_p">Even though the margins are added during training, the extreme imbalance between base set and novel set still makes the detector favors more on base set. Considering this limitation and the challenge that the number of novel classes is very limited to provide the gradients for network updating, we proposed to up-sample the images containing annotations of novel classes (<math id="S4.SS2.p6.1.m1.1" class="ltx_Math" alttext="\mathcal{D}^{+}_{n}" display="inline"><semantics id="S4.SS2.p6.1.m1.1a"><msubsup id="S4.SS2.p6.1.m1.1.1" xref="S4.SS2.p6.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p6.1.m1.1.1.2.2" xref="S4.SS2.p6.1.m1.1.1.2.2.cmml">𝒟</mi><mi id="S4.SS2.p6.1.m1.1.1.3" xref="S4.SS2.p6.1.m1.1.1.3.cmml">n</mi><mo id="S4.SS2.p6.1.m1.1.1.2.3" xref="S4.SS2.p6.1.m1.1.1.2.3.cmml">+</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p6.1.m1.1b"><apply id="S4.SS2.p6.1.m1.1.1.cmml" xref="S4.SS2.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p6.1.m1.1.1.1.cmml" xref="S4.SS2.p6.1.m1.1.1">subscript</csymbol><apply id="S4.SS2.p6.1.m1.1.1.2.cmml" xref="S4.SS2.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p6.1.m1.1.1.2.1.cmml" xref="S4.SS2.p6.1.m1.1.1">superscript</csymbol><ci id="S4.SS2.p6.1.m1.1.1.2.2.cmml" xref="S4.SS2.p6.1.m1.1.1.2.2">𝒟</ci><plus id="S4.SS2.p6.1.m1.1.1.2.3.cmml" xref="S4.SS2.p6.1.m1.1.1.2.3"></plus></apply><ci id="S4.SS2.p6.1.m1.1.1.3.cmml" xref="S4.SS2.p6.1.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p6.1.m1.1c">\mathcal{D}^{+}_{n}</annotation></semantics></math>). Specifically, we use repeated factor sampling (RFS) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> and the repeating times is set by a hyper-parameter threshold in RFS. We experimentally found that using up-sampling itself can achieve marginal improvement, but can clearly improve the novel detection precision combined with our approach. This observation demonstrates that the up-sampling strategy works closely with our hypothesis rather than just a trivial trick.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiment</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">We mainly conduct experiments on the few-shot object detection (FSOD) benchmark datasets Pascal VOC and MS COCO to validate the effectiveness of our proposed DiGeo. We further apply DiGeo on long-tailed object detection and conduct experiments on LVIS to show its generalizability.</p>
</div>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Datasets &amp; Training Details</h3>

<div id="S5.SS1.p1" class="ltx_para ltx_noindent">
<p id="S5.SS1.p1.13" class="ltx_p"><span id="S5.SS1.p1.13.1" class="ltx_text ltx_font_bold">Pascal VOC</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> consists of 20 classes where the class split for <math id="S5.SS1.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{C}_{b}{}" display="inline"><semantics id="S5.SS1.p1.1.m1.1a"><msub id="S5.SS1.p1.1.m1.1.1" xref="S5.SS1.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS1.p1.1.m1.1.1.2" xref="S5.SS1.p1.1.m1.1.1.2.cmml">𝒞</mi><mi id="S5.SS1.p1.1.m1.1.1.3" xref="S5.SS1.p1.1.m1.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.m1.1b"><apply id="S5.SS1.p1.1.m1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS1.p1.1.m1.1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S5.SS1.p1.1.m1.1.1.2.cmml" xref="S5.SS1.p1.1.m1.1.1.2">𝒞</ci><ci id="S5.SS1.p1.1.m1.1.1.3.cmml" xref="S5.SS1.p1.1.m1.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.1.m1.1c">\mathcal{C}_{b}{}</annotation></semantics></math> and <math id="S5.SS1.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{C}_{n}{}" display="inline"><semantics id="S5.SS1.p1.2.m2.1a"><msub id="S5.SS1.p1.2.m2.1.1" xref="S5.SS1.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS1.p1.2.m2.1.1.2" xref="S5.SS1.p1.2.m2.1.1.2.cmml">𝒞</mi><mi id="S5.SS1.p1.2.m2.1.1.3" xref="S5.SS1.p1.2.m2.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.2.m2.1b"><apply id="S5.SS1.p1.2.m2.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS1.p1.2.m2.1.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S5.SS1.p1.2.m2.1.1.2.cmml" xref="S5.SS1.p1.2.m2.1.1.2">𝒞</ci><ci id="S5.SS1.p1.2.m2.1.1.3.cmml" xref="S5.SS1.p1.2.m2.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.2.m2.1c">\mathcal{C}_{n}{}</annotation></semantics></math> are 15 and 5 separately.
The train set <math id="S5.SS1.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{D}_{b}{}\cup\mathcal{D}_{n}{}" display="inline"><semantics id="S5.SS1.p1.3.m3.1a"><mrow id="S5.SS1.p1.3.m3.1.1" xref="S5.SS1.p1.3.m3.1.1.cmml"><msub id="S5.SS1.p1.3.m3.1.1.2" xref="S5.SS1.p1.3.m3.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS1.p1.3.m3.1.1.2.2" xref="S5.SS1.p1.3.m3.1.1.2.2.cmml">𝒟</mi><mi id="S5.SS1.p1.3.m3.1.1.2.3" xref="S5.SS1.p1.3.m3.1.1.2.3.cmml">b</mi></msub><mo id="S5.SS1.p1.3.m3.1.1.1" xref="S5.SS1.p1.3.m3.1.1.1.cmml">∪</mo><msub id="S5.SS1.p1.3.m3.1.1.3" xref="S5.SS1.p1.3.m3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS1.p1.3.m3.1.1.3.2" xref="S5.SS1.p1.3.m3.1.1.3.2.cmml">𝒟</mi><mi id="S5.SS1.p1.3.m3.1.1.3.3" xref="S5.SS1.p1.3.m3.1.1.3.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.3.m3.1b"><apply id="S5.SS1.p1.3.m3.1.1.cmml" xref="S5.SS1.p1.3.m3.1.1"><union id="S5.SS1.p1.3.m3.1.1.1.cmml" xref="S5.SS1.p1.3.m3.1.1.1"></union><apply id="S5.SS1.p1.3.m3.1.1.2.cmml" xref="S5.SS1.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S5.SS1.p1.3.m3.1.1.2.1.cmml" xref="S5.SS1.p1.3.m3.1.1.2">subscript</csymbol><ci id="S5.SS1.p1.3.m3.1.1.2.2.cmml" xref="S5.SS1.p1.3.m3.1.1.2.2">𝒟</ci><ci id="S5.SS1.p1.3.m3.1.1.2.3.cmml" xref="S5.SS1.p1.3.m3.1.1.2.3">𝑏</ci></apply><apply id="S5.SS1.p1.3.m3.1.1.3.cmml" xref="S5.SS1.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S5.SS1.p1.3.m3.1.1.3.1.cmml" xref="S5.SS1.p1.3.m3.1.1.3">subscript</csymbol><ci id="S5.SS1.p1.3.m3.1.1.3.2.cmml" xref="S5.SS1.p1.3.m3.1.1.3.2">𝒟</ci><ci id="S5.SS1.p1.3.m3.1.1.3.3.cmml" xref="S5.SS1.p1.3.m3.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.3.m3.1c">\mathcal{D}_{b}{}\cup\mathcal{D}_{n}{}</annotation></semantics></math> are from Pascal VOC 07+12 trainval sets <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> where <math id="S5.SS1.p1.4.m4.1" class="ltx_Math" alttext="\mathcal{D}_{n}{}" display="inline"><semantics id="S5.SS1.p1.4.m4.1a"><msub id="S5.SS1.p1.4.m4.1.1" xref="S5.SS1.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS1.p1.4.m4.1.1.2" xref="S5.SS1.p1.4.m4.1.1.2.cmml">𝒟</mi><mi id="S5.SS1.p1.4.m4.1.1.3" xref="S5.SS1.p1.4.m4.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.4.m4.1b"><apply id="S5.SS1.p1.4.m4.1.1.cmml" xref="S5.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS1.p1.4.m4.1.1.1.cmml" xref="S5.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S5.SS1.p1.4.m4.1.1.2.cmml" xref="S5.SS1.p1.4.m4.1.1.2">𝒟</ci><ci id="S5.SS1.p1.4.m4.1.1.3.cmml" xref="S5.SS1.p1.4.m4.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.4.m4.1c">\mathcal{D}_{n}{}</annotation></semantics></math> is randomly sampled with <math id="S5.SS1.p1.5.m5.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S5.SS1.p1.5.m5.1a"><mi id="S5.SS1.p1.5.m5.1.1" xref="S5.SS1.p1.5.m5.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.5.m5.1b"><ci id="S5.SS1.p1.5.m5.1.1.cmml" xref="S5.SS1.p1.5.m5.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.5.m5.1c">K</annotation></semantics></math> in <math id="S5.SS1.p1.6.m6.5" class="ltx_Math" alttext="\{1,2,3,5,10\}" display="inline"><semantics id="S5.SS1.p1.6.m6.5a"><mrow id="S5.SS1.p1.6.m6.5.6.2" xref="S5.SS1.p1.6.m6.5.6.1.cmml"><mo stretchy="false" id="S5.SS1.p1.6.m6.5.6.2.1" xref="S5.SS1.p1.6.m6.5.6.1.cmml">{</mo><mn id="S5.SS1.p1.6.m6.1.1" xref="S5.SS1.p1.6.m6.1.1.cmml">1</mn><mo id="S5.SS1.p1.6.m6.5.6.2.2" xref="S5.SS1.p1.6.m6.5.6.1.cmml">,</mo><mn id="S5.SS1.p1.6.m6.2.2" xref="S5.SS1.p1.6.m6.2.2.cmml">2</mn><mo id="S5.SS1.p1.6.m6.5.6.2.3" xref="S5.SS1.p1.6.m6.5.6.1.cmml">,</mo><mn id="S5.SS1.p1.6.m6.3.3" xref="S5.SS1.p1.6.m6.3.3.cmml">3</mn><mo id="S5.SS1.p1.6.m6.5.6.2.4" xref="S5.SS1.p1.6.m6.5.6.1.cmml">,</mo><mn id="S5.SS1.p1.6.m6.4.4" xref="S5.SS1.p1.6.m6.4.4.cmml">5</mn><mo id="S5.SS1.p1.6.m6.5.6.2.5" xref="S5.SS1.p1.6.m6.5.6.1.cmml">,</mo><mn id="S5.SS1.p1.6.m6.5.5" xref="S5.SS1.p1.6.m6.5.5.cmml">10</mn><mo stretchy="false" id="S5.SS1.p1.6.m6.5.6.2.6" xref="S5.SS1.p1.6.m6.5.6.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.6.m6.5b"><set id="S5.SS1.p1.6.m6.5.6.1.cmml" xref="S5.SS1.p1.6.m6.5.6.2"><cn type="integer" id="S5.SS1.p1.6.m6.1.1.cmml" xref="S5.SS1.p1.6.m6.1.1">1</cn><cn type="integer" id="S5.SS1.p1.6.m6.2.2.cmml" xref="S5.SS1.p1.6.m6.2.2">2</cn><cn type="integer" id="S5.SS1.p1.6.m6.3.3.cmml" xref="S5.SS1.p1.6.m6.3.3">3</cn><cn type="integer" id="S5.SS1.p1.6.m6.4.4.cmml" xref="S5.SS1.p1.6.m6.4.4">5</cn><cn type="integer" id="S5.SS1.p1.6.m6.5.5.cmml" xref="S5.SS1.p1.6.m6.5.5">10</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.6.m6.5c">\{1,2,3,5,10\}</annotation></semantics></math>.
Following TFA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib55" title="" class="ltx_ref">55</a>]</cite>, we conduct experiments on three base-novel class partitions marked as <math id="S5.SS1.p1.7.m7.3" class="ltx_Math" alttext="\{1,2,3\}" display="inline"><semantics id="S5.SS1.p1.7.m7.3a"><mrow id="S5.SS1.p1.7.m7.3.4.2" xref="S5.SS1.p1.7.m7.3.4.1.cmml"><mo stretchy="false" id="S5.SS1.p1.7.m7.3.4.2.1" xref="S5.SS1.p1.7.m7.3.4.1.cmml">{</mo><mn id="S5.SS1.p1.7.m7.1.1" xref="S5.SS1.p1.7.m7.1.1.cmml">1</mn><mo id="S5.SS1.p1.7.m7.3.4.2.2" xref="S5.SS1.p1.7.m7.3.4.1.cmml">,</mo><mn id="S5.SS1.p1.7.m7.2.2" xref="S5.SS1.p1.7.m7.2.2.cmml">2</mn><mo id="S5.SS1.p1.7.m7.3.4.2.3" xref="S5.SS1.p1.7.m7.3.4.1.cmml">,</mo><mn id="S5.SS1.p1.7.m7.3.3" xref="S5.SS1.p1.7.m7.3.3.cmml">3</mn><mo stretchy="false" id="S5.SS1.p1.7.m7.3.4.2.4" xref="S5.SS1.p1.7.m7.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.7.m7.3b"><set id="S5.SS1.p1.7.m7.3.4.1.cmml" xref="S5.SS1.p1.7.m7.3.4.2"><cn type="integer" id="S5.SS1.p1.7.m7.1.1.cmml" xref="S5.SS1.p1.7.m7.1.1">1</cn><cn type="integer" id="S5.SS1.p1.7.m7.2.2.cmml" xref="S5.SS1.p1.7.m7.2.2">2</cn><cn type="integer" id="S5.SS1.p1.7.m7.3.3.cmml" xref="S5.SS1.p1.7.m7.3.3">3</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.7.m7.3c">\{1,2,3\}</annotation></semantics></math>. In each partition, for fair comparison, we use the same sampled novel instances and report the detection precision for <math id="S5.SS1.p1.8.m8.1" class="ltx_Math" alttext="\mathcal{C}_{n}{}" display="inline"><semantics id="S5.SS1.p1.8.m8.1a"><msub id="S5.SS1.p1.8.m8.1.1" xref="S5.SS1.p1.8.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS1.p1.8.m8.1.1.2" xref="S5.SS1.p1.8.m8.1.1.2.cmml">𝒞</mi><mi id="S5.SS1.p1.8.m8.1.1.3" xref="S5.SS1.p1.8.m8.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.8.m8.1b"><apply id="S5.SS1.p1.8.m8.1.1.cmml" xref="S5.SS1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S5.SS1.p1.8.m8.1.1.1.cmml" xref="S5.SS1.p1.8.m8.1.1">subscript</csymbol><ci id="S5.SS1.p1.8.m8.1.1.2.cmml" xref="S5.SS1.p1.8.m8.1.1.2">𝒞</ci><ci id="S5.SS1.p1.8.m8.1.1.3.cmml" xref="S5.SS1.p1.8.m8.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.8.m8.1c">\mathcal{C}_{n}{}</annotation></semantics></math> (nAP<sub id="S5.SS1.p1.13.2" class="ltx_sub"><span id="S5.SS1.p1.13.2.1" class="ltx_text ltx_font_italic">50</span></sub>), <math id="S5.SS1.p1.10.m10.1" class="ltx_Math" alttext="\mathcal{C}_{b}{}" display="inline"><semantics id="S5.SS1.p1.10.m10.1a"><msub id="S5.SS1.p1.10.m10.1.1" xref="S5.SS1.p1.10.m10.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS1.p1.10.m10.1.1.2" xref="S5.SS1.p1.10.m10.1.1.2.cmml">𝒞</mi><mi id="S5.SS1.p1.10.m10.1.1.3" xref="S5.SS1.p1.10.m10.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.10.m10.1b"><apply id="S5.SS1.p1.10.m10.1.1.cmml" xref="S5.SS1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S5.SS1.p1.10.m10.1.1.1.cmml" xref="S5.SS1.p1.10.m10.1.1">subscript</csymbol><ci id="S5.SS1.p1.10.m10.1.1.2.cmml" xref="S5.SS1.p1.10.m10.1.1.2">𝒞</ci><ci id="S5.SS1.p1.10.m10.1.1.3.cmml" xref="S5.SS1.p1.10.m10.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.10.m10.1c">\mathcal{C}_{b}{}</annotation></semantics></math> (bAP<sub id="S5.SS1.p1.13.3" class="ltx_sub"><span id="S5.SS1.p1.13.3.1" class="ltx_text ltx_font_italic">50</span></sub>) and <math id="S5.SS1.p1.12.m12.1" class="ltx_Math" alttext="\mathcal{C}_{b}{}\cup\mathcal{C}_{n}{}" display="inline"><semantics id="S5.SS1.p1.12.m12.1a"><mrow id="S5.SS1.p1.12.m12.1.1" xref="S5.SS1.p1.12.m12.1.1.cmml"><msub id="S5.SS1.p1.12.m12.1.1.2" xref="S5.SS1.p1.12.m12.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS1.p1.12.m12.1.1.2.2" xref="S5.SS1.p1.12.m12.1.1.2.2.cmml">𝒞</mi><mi id="S5.SS1.p1.12.m12.1.1.2.3" xref="S5.SS1.p1.12.m12.1.1.2.3.cmml">b</mi></msub><mo id="S5.SS1.p1.12.m12.1.1.1" xref="S5.SS1.p1.12.m12.1.1.1.cmml">∪</mo><msub id="S5.SS1.p1.12.m12.1.1.3" xref="S5.SS1.p1.12.m12.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS1.p1.12.m12.1.1.3.2" xref="S5.SS1.p1.12.m12.1.1.3.2.cmml">𝒞</mi><mi id="S5.SS1.p1.12.m12.1.1.3.3" xref="S5.SS1.p1.12.m12.1.1.3.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.12.m12.1b"><apply id="S5.SS1.p1.12.m12.1.1.cmml" xref="S5.SS1.p1.12.m12.1.1"><union id="S5.SS1.p1.12.m12.1.1.1.cmml" xref="S5.SS1.p1.12.m12.1.1.1"></union><apply id="S5.SS1.p1.12.m12.1.1.2.cmml" xref="S5.SS1.p1.12.m12.1.1.2"><csymbol cd="ambiguous" id="S5.SS1.p1.12.m12.1.1.2.1.cmml" xref="S5.SS1.p1.12.m12.1.1.2">subscript</csymbol><ci id="S5.SS1.p1.12.m12.1.1.2.2.cmml" xref="S5.SS1.p1.12.m12.1.1.2.2">𝒞</ci><ci id="S5.SS1.p1.12.m12.1.1.2.3.cmml" xref="S5.SS1.p1.12.m12.1.1.2.3">𝑏</ci></apply><apply id="S5.SS1.p1.12.m12.1.1.3.cmml" xref="S5.SS1.p1.12.m12.1.1.3"><csymbol cd="ambiguous" id="S5.SS1.p1.12.m12.1.1.3.1.cmml" xref="S5.SS1.p1.12.m12.1.1.3">subscript</csymbol><ci id="S5.SS1.p1.12.m12.1.1.3.2.cmml" xref="S5.SS1.p1.12.m12.1.1.3.2">𝒞</ci><ci id="S5.SS1.p1.12.m12.1.1.3.3.cmml" xref="S5.SS1.p1.12.m12.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.12.m12.1c">\mathcal{C}_{b}{}\cup\mathcal{C}_{n}{}</annotation></semantics></math> (AP<sub id="S5.SS1.p1.13.4" class="ltx_sub"><span id="S5.SS1.p1.13.4.1" class="ltx_text ltx_font_italic">50</span></sub>) on Pascal VOC 07 test set <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>.</p>
</div>
<div id="S5.SS1.p2" class="ltx_para ltx_noindent">
<p id="S5.SS1.p2.8" class="ltx_p"><span id="S5.SS1.p2.8.1" class="ltx_text ltx_font_bold">MS COCO</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> is derived from COCO14 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> consisting of 80 classes where <math id="S5.SS1.p2.1.m1.2" class="ltx_Math" alttext="|\mathcal{C}_{b}{}|=60,|\mathcal{C}_{n}{}|=20" display="inline"><semantics id="S5.SS1.p2.1.m1.2a"><mrow id="S5.SS1.p2.1.m1.2.2.2" xref="S5.SS1.p2.1.m1.2.2.3.cmml"><mrow id="S5.SS1.p2.1.m1.1.1.1.1" xref="S5.SS1.p2.1.m1.1.1.1.1.cmml"><mrow id="S5.SS1.p2.1.m1.1.1.1.1.1.1" xref="S5.SS1.p2.1.m1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S5.SS1.p2.1.m1.1.1.1.1.1.1.2" xref="S5.SS1.p2.1.m1.1.1.1.1.1.2.1.cmml">|</mo><msub id="S5.SS1.p2.1.m1.1.1.1.1.1.1.1" xref="S5.SS1.p2.1.m1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS1.p2.1.m1.1.1.1.1.1.1.1.2" xref="S5.SS1.p2.1.m1.1.1.1.1.1.1.1.2.cmml">𝒞</mi><mi id="S5.SS1.p2.1.m1.1.1.1.1.1.1.1.3" xref="S5.SS1.p2.1.m1.1.1.1.1.1.1.1.3.cmml">b</mi></msub><mo stretchy="false" id="S5.SS1.p2.1.m1.1.1.1.1.1.1.3" xref="S5.SS1.p2.1.m1.1.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="S5.SS1.p2.1.m1.1.1.1.1.2" xref="S5.SS1.p2.1.m1.1.1.1.1.2.cmml">=</mo><mn id="S5.SS1.p2.1.m1.1.1.1.1.3" xref="S5.SS1.p2.1.m1.1.1.1.1.3.cmml">60</mn></mrow><mo id="S5.SS1.p2.1.m1.2.2.2.3" xref="S5.SS1.p2.1.m1.2.2.3a.cmml">,</mo><mrow id="S5.SS1.p2.1.m1.2.2.2.2" xref="S5.SS1.p2.1.m1.2.2.2.2.cmml"><mrow id="S5.SS1.p2.1.m1.2.2.2.2.1.1" xref="S5.SS1.p2.1.m1.2.2.2.2.1.2.cmml"><mo stretchy="false" id="S5.SS1.p2.1.m1.2.2.2.2.1.1.2" xref="S5.SS1.p2.1.m1.2.2.2.2.1.2.1.cmml">|</mo><msub id="S5.SS1.p2.1.m1.2.2.2.2.1.1.1" xref="S5.SS1.p2.1.m1.2.2.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS1.p2.1.m1.2.2.2.2.1.1.1.2" xref="S5.SS1.p2.1.m1.2.2.2.2.1.1.1.2.cmml">𝒞</mi><mi id="S5.SS1.p2.1.m1.2.2.2.2.1.1.1.3" xref="S5.SS1.p2.1.m1.2.2.2.2.1.1.1.3.cmml">n</mi></msub><mo stretchy="false" id="S5.SS1.p2.1.m1.2.2.2.2.1.1.3" xref="S5.SS1.p2.1.m1.2.2.2.2.1.2.1.cmml">|</mo></mrow><mo id="S5.SS1.p2.1.m1.2.2.2.2.2" xref="S5.SS1.p2.1.m1.2.2.2.2.2.cmml">=</mo><mn id="S5.SS1.p2.1.m1.2.2.2.2.3" xref="S5.SS1.p2.1.m1.2.2.2.2.3.cmml">20</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.1.m1.2b"><apply id="S5.SS1.p2.1.m1.2.2.3.cmml" xref="S5.SS1.p2.1.m1.2.2.2"><csymbol cd="ambiguous" id="S5.SS1.p2.1.m1.2.2.3a.cmml" xref="S5.SS1.p2.1.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S5.SS1.p2.1.m1.1.1.1.1.cmml" xref="S5.SS1.p2.1.m1.1.1.1.1"><eq id="S5.SS1.p2.1.m1.1.1.1.1.2.cmml" xref="S5.SS1.p2.1.m1.1.1.1.1.2"></eq><apply id="S5.SS1.p2.1.m1.1.1.1.1.1.2.cmml" xref="S5.SS1.p2.1.m1.1.1.1.1.1.1"><abs id="S5.SS1.p2.1.m1.1.1.1.1.1.2.1.cmml" xref="S5.SS1.p2.1.m1.1.1.1.1.1.1.2"></abs><apply id="S5.SS1.p2.1.m1.1.1.1.1.1.1.1.cmml" xref="S5.SS1.p2.1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S5.SS1.p2.1.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S5.SS1.p2.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S5.SS1.p2.1.m1.1.1.1.1.1.1.1.2">𝒞</ci><ci id="S5.SS1.p2.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S5.SS1.p2.1.m1.1.1.1.1.1.1.1.3">𝑏</ci></apply></apply><cn type="integer" id="S5.SS1.p2.1.m1.1.1.1.1.3.cmml" xref="S5.SS1.p2.1.m1.1.1.1.1.3">60</cn></apply><apply id="S5.SS1.p2.1.m1.2.2.2.2.cmml" xref="S5.SS1.p2.1.m1.2.2.2.2"><eq id="S5.SS1.p2.1.m1.2.2.2.2.2.cmml" xref="S5.SS1.p2.1.m1.2.2.2.2.2"></eq><apply id="S5.SS1.p2.1.m1.2.2.2.2.1.2.cmml" xref="S5.SS1.p2.1.m1.2.2.2.2.1.1"><abs id="S5.SS1.p2.1.m1.2.2.2.2.1.2.1.cmml" xref="S5.SS1.p2.1.m1.2.2.2.2.1.1.2"></abs><apply id="S5.SS1.p2.1.m1.2.2.2.2.1.1.1.cmml" xref="S5.SS1.p2.1.m1.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.1.m1.2.2.2.2.1.1.1.1.cmml" xref="S5.SS1.p2.1.m1.2.2.2.2.1.1.1">subscript</csymbol><ci id="S5.SS1.p2.1.m1.2.2.2.2.1.1.1.2.cmml" xref="S5.SS1.p2.1.m1.2.2.2.2.1.1.1.2">𝒞</ci><ci id="S5.SS1.p2.1.m1.2.2.2.2.1.1.1.3.cmml" xref="S5.SS1.p2.1.m1.2.2.2.2.1.1.1.3">𝑛</ci></apply></apply><cn type="integer" id="S5.SS1.p2.1.m1.2.2.2.2.3.cmml" xref="S5.SS1.p2.1.m1.2.2.2.2.3">20</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.1.m1.2c">|\mathcal{C}_{b}{}|=60,|\mathcal{C}_{n}{}|=20</annotation></semantics></math> and <math id="S5.SS1.p2.2.m2.1" class="ltx_Math" alttext="\mathcal{C}_{n}{}" display="inline"><semantics id="S5.SS1.p2.2.m2.1a"><msub id="S5.SS1.p2.2.m2.1.1" xref="S5.SS1.p2.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS1.p2.2.m2.1.1.2" xref="S5.SS1.p2.2.m2.1.1.2.cmml">𝒞</mi><mi id="S5.SS1.p2.2.m2.1.1.3" xref="S5.SS1.p2.2.m2.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.2.m2.1b"><apply id="S5.SS1.p2.2.m2.1.1.cmml" xref="S5.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.2.m2.1.1.1.cmml" xref="S5.SS1.p2.2.m2.1.1">subscript</csymbol><ci id="S5.SS1.p2.2.m2.1.1.2.cmml" xref="S5.SS1.p2.2.m2.1.1.2">𝒞</ci><ci id="S5.SS1.p2.2.m2.1.1.3.cmml" xref="S5.SS1.p2.2.m2.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.2.m2.1c">\mathcal{C}_{n}{}</annotation></semantics></math> are in common with Pascal VOC. The <math id="S5.SS1.p2.3.m3.1" class="ltx_Math" alttext="\mathcal{D}_{b}{}" display="inline"><semantics id="S5.SS1.p2.3.m3.1a"><msub id="S5.SS1.p2.3.m3.1.1" xref="S5.SS1.p2.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS1.p2.3.m3.1.1.2" xref="S5.SS1.p2.3.m3.1.1.2.cmml">𝒟</mi><mi id="S5.SS1.p2.3.m3.1.1.3" xref="S5.SS1.p2.3.m3.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.3.m3.1b"><apply id="S5.SS1.p2.3.m3.1.1.cmml" xref="S5.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.3.m3.1.1.1.cmml" xref="S5.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="S5.SS1.p2.3.m3.1.1.2.cmml" xref="S5.SS1.p2.3.m3.1.1.2">𝒟</ci><ci id="S5.SS1.p2.3.m3.1.1.3.cmml" xref="S5.SS1.p2.3.m3.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.3.m3.1c">\mathcal{D}_{b}{}</annotation></semantics></math> and <math id="S5.SS1.p2.4.m4.1" class="ltx_Math" alttext="\mathcal{D}_{n}{}" display="inline"><semantics id="S5.SS1.p2.4.m4.1a"><msub id="S5.SS1.p2.4.m4.1.1" xref="S5.SS1.p2.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS1.p2.4.m4.1.1.2" xref="S5.SS1.p2.4.m4.1.1.2.cmml">𝒟</mi><mi id="S5.SS1.p2.4.m4.1.1.3" xref="S5.SS1.p2.4.m4.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.4.m4.1b"><apply id="S5.SS1.p2.4.m4.1.1.cmml" xref="S5.SS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.4.m4.1.1.1.cmml" xref="S5.SS1.p2.4.m4.1.1">subscript</csymbol><ci id="S5.SS1.p2.4.m4.1.1.2.cmml" xref="S5.SS1.p2.4.m4.1.1.2">𝒟</ci><ci id="S5.SS1.p2.4.m4.1.1.3.cmml" xref="S5.SS1.p2.4.m4.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.4.m4.1c">\mathcal{D}_{n}{}</annotation></semantics></math> are from train set with <math id="S5.SS1.p2.5.m5.2" class="ltx_Math" alttext="K=\{10,30\}" display="inline"><semantics id="S5.SS1.p2.5.m5.2a"><mrow id="S5.SS1.p2.5.m5.2.3" xref="S5.SS1.p2.5.m5.2.3.cmml"><mi id="S5.SS1.p2.5.m5.2.3.2" xref="S5.SS1.p2.5.m5.2.3.2.cmml">K</mi><mo id="S5.SS1.p2.5.m5.2.3.1" xref="S5.SS1.p2.5.m5.2.3.1.cmml">=</mo><mrow id="S5.SS1.p2.5.m5.2.3.3.2" xref="S5.SS1.p2.5.m5.2.3.3.1.cmml"><mo stretchy="false" id="S5.SS1.p2.5.m5.2.3.3.2.1" xref="S5.SS1.p2.5.m5.2.3.3.1.cmml">{</mo><mn id="S5.SS1.p2.5.m5.1.1" xref="S5.SS1.p2.5.m5.1.1.cmml">10</mn><mo id="S5.SS1.p2.5.m5.2.3.3.2.2" xref="S5.SS1.p2.5.m5.2.3.3.1.cmml">,</mo><mn id="S5.SS1.p2.5.m5.2.2" xref="S5.SS1.p2.5.m5.2.2.cmml">30</mn><mo stretchy="false" id="S5.SS1.p2.5.m5.2.3.3.2.3" xref="S5.SS1.p2.5.m5.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.5.m5.2b"><apply id="S5.SS1.p2.5.m5.2.3.cmml" xref="S5.SS1.p2.5.m5.2.3"><eq id="S5.SS1.p2.5.m5.2.3.1.cmml" xref="S5.SS1.p2.5.m5.2.3.1"></eq><ci id="S5.SS1.p2.5.m5.2.3.2.cmml" xref="S5.SS1.p2.5.m5.2.3.2">𝐾</ci><set id="S5.SS1.p2.5.m5.2.3.3.1.cmml" xref="S5.SS1.p2.5.m5.2.3.3.2"><cn type="integer" id="S5.SS1.p2.5.m5.1.1.cmml" xref="S5.SS1.p2.5.m5.1.1">10</cn><cn type="integer" id="S5.SS1.p2.5.m5.2.2.cmml" xref="S5.SS1.p2.5.m5.2.2">30</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.5.m5.2c">K=\{10,30\}</annotation></semantics></math>. The detection precision of <math id="S5.SS1.p2.6.m6.1" class="ltx_Math" alttext="\mathcal{C}_{n}{}" display="inline"><semantics id="S5.SS1.p2.6.m6.1a"><msub id="S5.SS1.p2.6.m6.1.1" xref="S5.SS1.p2.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS1.p2.6.m6.1.1.2" xref="S5.SS1.p2.6.m6.1.1.2.cmml">𝒞</mi><mi id="S5.SS1.p2.6.m6.1.1.3" xref="S5.SS1.p2.6.m6.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.6.m6.1b"><apply id="S5.SS1.p2.6.m6.1.1.cmml" xref="S5.SS1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.6.m6.1.1.1.cmml" xref="S5.SS1.p2.6.m6.1.1">subscript</csymbol><ci id="S5.SS1.p2.6.m6.1.1.2.cmml" xref="S5.SS1.p2.6.m6.1.1.2">𝒞</ci><ci id="S5.SS1.p2.6.m6.1.1.3.cmml" xref="S5.SS1.p2.6.m6.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.6.m6.1c">\mathcal{C}_{n}{}</annotation></semantics></math> (nAP), <math id="S5.SS1.p2.7.m7.1" class="ltx_Math" alttext="\mathcal{C}_{b}{}" display="inline"><semantics id="S5.SS1.p2.7.m7.1a"><msub id="S5.SS1.p2.7.m7.1.1" xref="S5.SS1.p2.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS1.p2.7.m7.1.1.2" xref="S5.SS1.p2.7.m7.1.1.2.cmml">𝒞</mi><mi id="S5.SS1.p2.7.m7.1.1.3" xref="S5.SS1.p2.7.m7.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.7.m7.1b"><apply id="S5.SS1.p2.7.m7.1.1.cmml" xref="S5.SS1.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.7.m7.1.1.1.cmml" xref="S5.SS1.p2.7.m7.1.1">subscript</csymbol><ci id="S5.SS1.p2.7.m7.1.1.2.cmml" xref="S5.SS1.p2.7.m7.1.1.2">𝒞</ci><ci id="S5.SS1.p2.7.m7.1.1.3.cmml" xref="S5.SS1.p2.7.m7.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.7.m7.1c">\mathcal{C}_{b}{}</annotation></semantics></math>(bAP) and <math id="S5.SS1.p2.8.m8.1" class="ltx_Math" alttext="\mathcal{C}_{b}{}\cup\mathcal{C}_{n}{}" display="inline"><semantics id="S5.SS1.p2.8.m8.1a"><mrow id="S5.SS1.p2.8.m8.1.1" xref="S5.SS1.p2.8.m8.1.1.cmml"><msub id="S5.SS1.p2.8.m8.1.1.2" xref="S5.SS1.p2.8.m8.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS1.p2.8.m8.1.1.2.2" xref="S5.SS1.p2.8.m8.1.1.2.2.cmml">𝒞</mi><mi id="S5.SS1.p2.8.m8.1.1.2.3" xref="S5.SS1.p2.8.m8.1.1.2.3.cmml">b</mi></msub><mo id="S5.SS1.p2.8.m8.1.1.1" xref="S5.SS1.p2.8.m8.1.1.1.cmml">∪</mo><msub id="S5.SS1.p2.8.m8.1.1.3" xref="S5.SS1.p2.8.m8.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS1.p2.8.m8.1.1.3.2" xref="S5.SS1.p2.8.m8.1.1.3.2.cmml">𝒞</mi><mi id="S5.SS1.p2.8.m8.1.1.3.3" xref="S5.SS1.p2.8.m8.1.1.3.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.8.m8.1b"><apply id="S5.SS1.p2.8.m8.1.1.cmml" xref="S5.SS1.p2.8.m8.1.1"><union id="S5.SS1.p2.8.m8.1.1.1.cmml" xref="S5.SS1.p2.8.m8.1.1.1"></union><apply id="S5.SS1.p2.8.m8.1.1.2.cmml" xref="S5.SS1.p2.8.m8.1.1.2"><csymbol cd="ambiguous" id="S5.SS1.p2.8.m8.1.1.2.1.cmml" xref="S5.SS1.p2.8.m8.1.1.2">subscript</csymbol><ci id="S5.SS1.p2.8.m8.1.1.2.2.cmml" xref="S5.SS1.p2.8.m8.1.1.2.2">𝒞</ci><ci id="S5.SS1.p2.8.m8.1.1.2.3.cmml" xref="S5.SS1.p2.8.m8.1.1.2.3">𝑏</ci></apply><apply id="S5.SS1.p2.8.m8.1.1.3.cmml" xref="S5.SS1.p2.8.m8.1.1.3"><csymbol cd="ambiguous" id="S5.SS1.p2.8.m8.1.1.3.1.cmml" xref="S5.SS1.p2.8.m8.1.1.3">subscript</csymbol><ci id="S5.SS1.p2.8.m8.1.1.3.2.cmml" xref="S5.SS1.p2.8.m8.1.1.3.2">𝒞</ci><ci id="S5.SS1.p2.8.m8.1.1.3.3.cmml" xref="S5.SS1.p2.8.m8.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.8.m8.1c">\mathcal{C}_{b}{}\cup\mathcal{C}_{n}{}</annotation></semantics></math> (AP) on COCO 14 val set are reported.</p>
</div>
<div id="S5.SS1.p3" class="ltx_para ltx_noindent">
<p id="S5.SS1.p3.5" class="ltx_p"><span id="S5.SS1.p3.5.1" class="ltx_text ltx_font_bold">LVIS</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> is derived from COCO17 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> and contains <math id="S5.SS1.p3.1.m1.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S5.SS1.p3.1.m1.1a"><mo id="S5.SS1.p3.1.m1.1.1" xref="S5.SS1.p3.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.1.m1.1b"><csymbol cd="latexml" id="S5.SS1.p3.1.m1.1.1.cmml" xref="S5.SS1.p3.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.1.m1.1c">\sim</annotation></semantics></math>0.7M training instances of 1230 classes.
The classes are divided into three groups w.r.t. the amount of annotation, rare (1-10), common (11-100), and frequent (<math id="S5.SS1.p3.2.m2.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="S5.SS1.p3.2.m2.1a"><mo id="S5.SS1.p3.2.m2.1.1" xref="S5.SS1.p3.2.m2.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.2.m2.1b"><gt id="S5.SS1.p3.2.m2.1.1.cmml" xref="S5.SS1.p3.2.m2.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.2.m2.1c">&gt;</annotation></semantics></math>100).
Following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib55" title="" class="ltx_ref">55</a>]</cite>, we report the precision for all classes (AP) and class groups (AP<sub id="S5.SS1.p3.5.2" class="ltx_sub"><span id="S5.SS1.p3.5.2.1" class="ltx_text ltx_font_italic">r</span></sub>, AP<sub id="S5.SS1.p3.5.3" class="ltx_sub"><span id="S5.SS1.p3.5.3.1" class="ltx_text ltx_font_italic">c</span></sub>, and AP<sub id="S5.SS1.p3.5.4" class="ltx_sub"><span id="S5.SS1.p3.5.4.1" class="ltx_text ltx_font_italic">f</span></sub>) on the val set.</p>
</div>
<div id="S5.SS1.p4" class="ltx_para ltx_noindent">
<p id="S5.SS1.p4.1" class="ltx_p"><span id="S5.SS1.p4.1.1" class="ltx_text ltx_font_bold">Implementation Details.</span> We instanlize our approach on Faster-RCNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib55" title="" class="ltx_ref">55</a>, <a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite> which employs a region proposal network (RPN) to generate region candidates. For fair comparison, we use ResNet-101 with FPN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> as backbone to extract image feature maps where the Resnet-101 backbone is initialized by ImageNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>-pretrained model.
As the outputs of penultimate layer in original classification module are non-negative and does not meet the property of the ETF classifier, we add a linear layer (projector) with the same input and output dimension on top of the penultimate layer. The projector output is then used for classification.
For RFS <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>, we set the up-sampling threshold as 0.01 for PASCAL VOC and MS COCO and 0.001 for LVIS.
During distillation, we share and fix the parameters of ResNet101 and FPN and only learn a new detection head.
We follow the setup in TFA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib55" title="" class="ltx_ref">55</a>]</cite> baseline such as SGD optimizer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite>. More details can be found in Supp.</p>
</div>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Comparison with FSOD Methods</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.4" class="ltx_p">We show the comparisons between our methods and state-of-the-art few-shot object detection approaches on PASCAL VOC and MSCOCO. We follow previous works to conduct experiments on three data splits with different shots of novel classes.
As for the performance AP<sub id="S5.SS2.p1.4.1" class="ltx_sub"><span id="S5.SS2.p1.4.1.1" class="ltx_text ltx_font_italic">50</span></sub> over all classes in Table <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:tab:voc-all</span>, our DiGeo achieves the best performances for 12 out of 15 cases. Compared to the baseline method TFA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib55" title="" class="ltx_ref">55</a>]</cite>, our DiGeo outperformed TFA consistently in all shots &amp; splits. Compared to the state-of-the-art Retentative RCNN model, our DiGeo achieves better AP<sub id="S5.SS2.p1.4.2" class="ltx_sub"><span id="S5.SS2.p1.4.2.1" class="ltx_text ltx_font_italic">50</span></sub> when the number of shots is larger than 2, and obtains comparable performances for extremely few-shot cases. As for the detailed comparisons over novel classes (nAP<sub id="S5.SS2.p1.4.3" class="ltx_sub"><span id="S5.SS2.p1.4.3.1" class="ltx_text ltx_font_italic">50</span></sub>) and base classes (bAP<sub id="S5.SS2.p1.4.4" class="ltx_sub"><span id="S5.SS2.p1.4.4.1" class="ltx_text ltx_font_italic">50</span></sub>) in Table <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:tab:voc-all-detail</span>, our DiGeo still consistently outperforms the baseline TFA method for all the settings.</p>
</div>
<div id="S5.SS2.p2" class="ltx_para">
<p id="S5.SS2.p2.4" class="ltx_p">In addition, our DiGeo achieves a better trade-off between base-class performance and novel-class generalization. On the one hand, although MPSR achieved higher performance for extremely few-shot settings (<em id="S5.SS2.p2.4.1" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S5.SS2.p2.4.2" class="ltx_text"></span>, 36.2 vs. 31.6 for 1-shot) and competitive performances with <math id="S5.SS2.p2.1.m1.3" class="ltx_Math" alttext="\{3,5,10\}" display="inline"><semantics id="S5.SS2.p2.1.m1.3a"><mrow id="S5.SS2.p2.1.m1.3.4.2" xref="S5.SS2.p2.1.m1.3.4.1.cmml"><mo stretchy="false" id="S5.SS2.p2.1.m1.3.4.2.1" xref="S5.SS2.p2.1.m1.3.4.1.cmml">{</mo><mn id="S5.SS2.p2.1.m1.1.1" xref="S5.SS2.p2.1.m1.1.1.cmml">3</mn><mo id="S5.SS2.p2.1.m1.3.4.2.2" xref="S5.SS2.p2.1.m1.3.4.1.cmml">,</mo><mn id="S5.SS2.p2.1.m1.2.2" xref="S5.SS2.p2.1.m1.2.2.cmml">5</mn><mo id="S5.SS2.p2.1.m1.3.4.2.3" xref="S5.SS2.p2.1.m1.3.4.1.cmml">,</mo><mn id="S5.SS2.p2.1.m1.3.3" xref="S5.SS2.p2.1.m1.3.3.cmml">10</mn><mo stretchy="false" id="S5.SS2.p2.1.m1.3.4.2.4" xref="S5.SS2.p2.1.m1.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.1.m1.3b"><set id="S5.SS2.p2.1.m1.3.4.1.cmml" xref="S5.SS2.p2.1.m1.3.4.2"><cn type="integer" id="S5.SS2.p2.1.m1.1.1.cmml" xref="S5.SS2.p2.1.m1.1.1">3</cn><cn type="integer" id="S5.SS2.p2.1.m1.2.2.cmml" xref="S5.SS2.p2.1.m1.2.2">5</cn><cn type="integer" id="S5.SS2.p2.1.m1.3.3.cmml" xref="S5.SS2.p2.1.m1.3.3">10</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.1.m1.3c">\{3,5,10\}</annotation></semantics></math>-shots, its performance drops by large margins (<em id="S5.SS2.p2.4.3" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S5.SS2.p2.4.4" class="ltx_text"></span>, 68.1 vs. 81.3 for bAP<sub id="S5.SS2.p2.4.5" class="ltx_sub"><span id="S5.SS2.p2.4.5.1" class="ltx_text ltx_font_italic">50</span></sub>). This observation indicates that MPSR improves the few-shot generalization with the sacrifice of base-class knowledge. On the other hand, as Retentive RCNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> includes the base detector &amp; RPN through max ensembling at test time, the adapted detector can be trained to specifically detect novel instances, where the bAP<sub id="S5.SS2.p2.4.6" class="ltx_sub"><span id="S5.SS2.p2.4.6.1" class="ltx_text ltx_font_italic">50</span></sub> is slightly higher than ours (<em id="S5.SS2.p2.4.7" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S5.SS2.p2.4.8" class="ltx_text"></span>, 81.6 vs. 81.3). However, its few-shot generalization is not satisfying when the number of shots is larger than 2 (<em id="S5.SS2.p2.4.9" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S5.SS2.p2.4.10" class="ltx_text"></span>, 6.3 lower than ours with 10 shots). In contrast, our approach only train a single detector and achieves stable and consistent gain. Similarly, for the results on MSCOCO shown in Table <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:tab:coco</span>, our DiGeo outperforms Retentive RCNN for the novel-class metrics including nAP<sub id="S5.SS2.p2.4.11" class="ltx_sub"><span id="S5.SS2.p2.4.11.1" class="ltx_text ltx_font_italic">75</span></sub>, nAPs, nAPm and nAPl. These comparison demonstrate that our DiGeo has a strong few-shot generalization ability without base-class knowledge forgetting.</p>
</div>
<figure id="S5.F3" class="ltx_figure"><img src="/html/2303.09674/assets/x3.png" id="S5.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="415" height="92" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F3.11.4.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S5.F3.6.3" class="ltx_text" style="font-size:90%;">Comparison of pair-wise similarities of classifier weights. We follow the TFA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib55" title="" class="ltx_ref">55</a>]</cite> baseline but alter the train set at adaptation step between (a) full set <math id="S5.F3.4.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{b}{}\cup\mathcal{D}_{n}{}" display="inline"><semantics id="S5.F3.4.1.m1.1b"><mrow id="S5.F3.4.1.m1.1.1" xref="S5.F3.4.1.m1.1.1.cmml"><msub id="S5.F3.4.1.m1.1.1.2" xref="S5.F3.4.1.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.F3.4.1.m1.1.1.2.2" xref="S5.F3.4.1.m1.1.1.2.2.cmml">𝒟</mi><mi id="S5.F3.4.1.m1.1.1.2.3" xref="S5.F3.4.1.m1.1.1.2.3.cmml">b</mi></msub><mo id="S5.F3.4.1.m1.1.1.1" xref="S5.F3.4.1.m1.1.1.1.cmml">∪</mo><msub id="S5.F3.4.1.m1.1.1.3" xref="S5.F3.4.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.F3.4.1.m1.1.1.3.2" xref="S5.F3.4.1.m1.1.1.3.2.cmml">𝒟</mi><mi id="S5.F3.4.1.m1.1.1.3.3" xref="S5.F3.4.1.m1.1.1.3.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S5.F3.4.1.m1.1c"><apply id="S5.F3.4.1.m1.1.1.cmml" xref="S5.F3.4.1.m1.1.1"><union id="S5.F3.4.1.m1.1.1.1.cmml" xref="S5.F3.4.1.m1.1.1.1"></union><apply id="S5.F3.4.1.m1.1.1.2.cmml" xref="S5.F3.4.1.m1.1.1.2"><csymbol cd="ambiguous" id="S5.F3.4.1.m1.1.1.2.1.cmml" xref="S5.F3.4.1.m1.1.1.2">subscript</csymbol><ci id="S5.F3.4.1.m1.1.1.2.2.cmml" xref="S5.F3.4.1.m1.1.1.2.2">𝒟</ci><ci id="S5.F3.4.1.m1.1.1.2.3.cmml" xref="S5.F3.4.1.m1.1.1.2.3">𝑏</ci></apply><apply id="S5.F3.4.1.m1.1.1.3.cmml" xref="S5.F3.4.1.m1.1.1.3"><csymbol cd="ambiguous" id="S5.F3.4.1.m1.1.1.3.1.cmml" xref="S5.F3.4.1.m1.1.1.3">subscript</csymbol><ci id="S5.F3.4.1.m1.1.1.3.2.cmml" xref="S5.F3.4.1.m1.1.1.3.2">𝒟</ci><ci id="S5.F3.4.1.m1.1.1.3.3.cmml" xref="S5.F3.4.1.m1.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F3.4.1.m1.1d">\mathcal{D}_{b}{}\cup\mathcal{D}_{n}{}</annotation></semantics></math>, (b) a balanced set <math id="S5.F3.5.2.m2.1" class="ltx_Math" alttext="\mathcal{D}^{-}_{b}{}\cup\mathcal{D}_{n}{}" display="inline"><semantics id="S5.F3.5.2.m2.1b"><mrow id="S5.F3.5.2.m2.1.1" xref="S5.F3.5.2.m2.1.1.cmml"><msubsup id="S5.F3.5.2.m2.1.1.2" xref="S5.F3.5.2.m2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.F3.5.2.m2.1.1.2.2.2" xref="S5.F3.5.2.m2.1.1.2.2.2.cmml">𝒟</mi><mi id="S5.F3.5.2.m2.1.1.2.3" xref="S5.F3.5.2.m2.1.1.2.3.cmml">b</mi><mo id="S5.F3.5.2.m2.1.1.2.2.3" xref="S5.F3.5.2.m2.1.1.2.2.3.cmml">−</mo></msubsup><mo id="S5.F3.5.2.m2.1.1.1" xref="S5.F3.5.2.m2.1.1.1.cmml">∪</mo><msub id="S5.F3.5.2.m2.1.1.3" xref="S5.F3.5.2.m2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.F3.5.2.m2.1.1.3.2" xref="S5.F3.5.2.m2.1.1.3.2.cmml">𝒟</mi><mi id="S5.F3.5.2.m2.1.1.3.3" xref="S5.F3.5.2.m2.1.1.3.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S5.F3.5.2.m2.1c"><apply id="S5.F3.5.2.m2.1.1.cmml" xref="S5.F3.5.2.m2.1.1"><union id="S5.F3.5.2.m2.1.1.1.cmml" xref="S5.F3.5.2.m2.1.1.1"></union><apply id="S5.F3.5.2.m2.1.1.2.cmml" xref="S5.F3.5.2.m2.1.1.2"><csymbol cd="ambiguous" id="S5.F3.5.2.m2.1.1.2.1.cmml" xref="S5.F3.5.2.m2.1.1.2">subscript</csymbol><apply id="S5.F3.5.2.m2.1.1.2.2.cmml" xref="S5.F3.5.2.m2.1.1.2"><csymbol cd="ambiguous" id="S5.F3.5.2.m2.1.1.2.2.1.cmml" xref="S5.F3.5.2.m2.1.1.2">superscript</csymbol><ci id="S5.F3.5.2.m2.1.1.2.2.2.cmml" xref="S5.F3.5.2.m2.1.1.2.2.2">𝒟</ci><minus id="S5.F3.5.2.m2.1.1.2.2.3.cmml" xref="S5.F3.5.2.m2.1.1.2.2.3"></minus></apply><ci id="S5.F3.5.2.m2.1.1.2.3.cmml" xref="S5.F3.5.2.m2.1.1.2.3">𝑏</ci></apply><apply id="S5.F3.5.2.m2.1.1.3.cmml" xref="S5.F3.5.2.m2.1.1.3"><csymbol cd="ambiguous" id="S5.F3.5.2.m2.1.1.3.1.cmml" xref="S5.F3.5.2.m2.1.1.3">subscript</csymbol><ci id="S5.F3.5.2.m2.1.1.3.2.cmml" xref="S5.F3.5.2.m2.1.1.3.2">𝒟</ci><ci id="S5.F3.5.2.m2.1.1.3.3.cmml" xref="S5.F3.5.2.m2.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F3.5.2.m2.1d">\mathcal{D}^{-}_{b}{}\cup\mathcal{D}_{n}{}</annotation></semantics></math>, or (c) <span id="S5.F3.6.3.1" class="ltx_text ltx_font_italic">novel</span> set <math id="S5.F3.6.3.m3.1" class="ltx_Math" alttext="\mathcal{D}_{n}{}" display="inline"><semantics id="S5.F3.6.3.m3.1b"><msub id="S5.F3.6.3.m3.1.1" xref="S5.F3.6.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.F3.6.3.m3.1.1.2" xref="S5.F3.6.3.m3.1.1.2.cmml">𝒟</mi><mi id="S5.F3.6.3.m3.1.1.3" xref="S5.F3.6.3.m3.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S5.F3.6.3.m3.1c"><apply id="S5.F3.6.3.m3.1.1.cmml" xref="S5.F3.6.3.m3.1.1"><csymbol cd="ambiguous" id="S5.F3.6.3.m3.1.1.1.cmml" xref="S5.F3.6.3.m3.1.1">subscript</csymbol><ci id="S5.F3.6.3.m3.1.1.2.cmml" xref="S5.F3.6.3.m3.1.1.2">𝒟</ci><ci id="S5.F3.6.3.m3.1.1.3.cmml" xref="S5.F3.6.3.m3.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F3.6.3.m3.1d">\mathcal{D}_{n}{}</annotation></semantics></math>. For our approach, to maximally separate the classifier weights, we can (d) apply Eq. (<a href="#S4.E1" title="Equation 1 ‣ 4.1 Inter-Class Separation ‣ 4 Approach ‣ DiGeo: Discriminative Geometry-Aware Learning for Generalized Few-Shot Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) as a regularization term during training (online) or (e) derive the classifier weights offline and fix them. The weights for all classes are arranged w.r.t a decreasing order of the number of annotations per class, <em id="S5.F3.6.3.2" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S5.F3.6.3.3" class="ltx_text"></span>, from top (left) to bottom (right), from many-shot to few-shot.</span></figcaption>
</figure>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Analysis of Inter-Class Separation</h3>

<div id="S5.SS3.p1" class="ltx_para ltx_noindent">
<p id="S5.SS3.p1.5" class="ltx_p"><span id="S5.SS3.p1.5.1" class="ltx_text ltx_font_bold">Revisit the conventional adaptation strategy from the perspective of separation between classes.</span>
Recall that existing few-shot object detection methods follow in TFA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib55" title="" class="ltx_ref">55</a>]</cite> and employs a two-step strategy, <em id="S5.SS3.p1.5.2" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S5.SS3.p1.5.3" class="ltx_text"></span>, first pre-train on the base train set <math id="S5.SS3.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{b}{}" display="inline"><semantics id="S5.SS3.p1.1.m1.1a"><msub id="S5.SS3.p1.1.m1.1.1" xref="S5.SS3.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.p1.1.m1.1.1.2" xref="S5.SS3.p1.1.m1.1.1.2.cmml">𝒟</mi><mi id="S5.SS3.p1.1.m1.1.1.3" xref="S5.SS3.p1.1.m1.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.1.m1.1b"><apply id="S5.SS3.p1.1.m1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS3.p1.1.m1.1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S5.SS3.p1.1.m1.1.1.2.cmml" xref="S5.SS3.p1.1.m1.1.1.2">𝒟</ci><ci id="S5.SS3.p1.1.m1.1.1.3.cmml" xref="S5.SS3.p1.1.m1.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.1.m1.1c">\mathcal{D}_{b}{}</annotation></semantics></math> to learn a <span id="S5.SS3.p1.5.4" class="ltx_text ltx_font_italic">Base</span> detector, and then fine-tune on the union of the downsampled base set and the novel set, <em id="S5.SS3.p1.5.5" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S5.SS3.p1.5.6" class="ltx_text"></span>, <math id="S5.SS3.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{D}^{-}_{b}{}\cup\mathcal{D}_{n}{}" display="inline"><semantics id="S5.SS3.p1.2.m2.1a"><mrow id="S5.SS3.p1.2.m2.1.1" xref="S5.SS3.p1.2.m2.1.1.cmml"><msubsup id="S5.SS3.p1.2.m2.1.1.2" xref="S5.SS3.p1.2.m2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.p1.2.m2.1.1.2.2.2" xref="S5.SS3.p1.2.m2.1.1.2.2.2.cmml">𝒟</mi><mi id="S5.SS3.p1.2.m2.1.1.2.3" xref="S5.SS3.p1.2.m2.1.1.2.3.cmml">b</mi><mo id="S5.SS3.p1.2.m2.1.1.2.2.3" xref="S5.SS3.p1.2.m2.1.1.2.2.3.cmml">−</mo></msubsup><mo id="S5.SS3.p1.2.m2.1.1.1" xref="S5.SS3.p1.2.m2.1.1.1.cmml">∪</mo><msub id="S5.SS3.p1.2.m2.1.1.3" xref="S5.SS3.p1.2.m2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.p1.2.m2.1.1.3.2" xref="S5.SS3.p1.2.m2.1.1.3.2.cmml">𝒟</mi><mi id="S5.SS3.p1.2.m2.1.1.3.3" xref="S5.SS3.p1.2.m2.1.1.3.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.2.m2.1b"><apply id="S5.SS3.p1.2.m2.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1"><union id="S5.SS3.p1.2.m2.1.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1.1"></union><apply id="S5.SS3.p1.2.m2.1.1.2.cmml" xref="S5.SS3.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S5.SS3.p1.2.m2.1.1.2.1.cmml" xref="S5.SS3.p1.2.m2.1.1.2">subscript</csymbol><apply id="S5.SS3.p1.2.m2.1.1.2.2.cmml" xref="S5.SS3.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S5.SS3.p1.2.m2.1.1.2.2.1.cmml" xref="S5.SS3.p1.2.m2.1.1.2">superscript</csymbol><ci id="S5.SS3.p1.2.m2.1.1.2.2.2.cmml" xref="S5.SS3.p1.2.m2.1.1.2.2.2">𝒟</ci><minus id="S5.SS3.p1.2.m2.1.1.2.2.3.cmml" xref="S5.SS3.p1.2.m2.1.1.2.2.3"></minus></apply><ci id="S5.SS3.p1.2.m2.1.1.2.3.cmml" xref="S5.SS3.p1.2.m2.1.1.2.3">𝑏</ci></apply><apply id="S5.SS3.p1.2.m2.1.1.3.cmml" xref="S5.SS3.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S5.SS3.p1.2.m2.1.1.3.1.cmml" xref="S5.SS3.p1.2.m2.1.1.3">subscript</csymbol><ci id="S5.SS3.p1.2.m2.1.1.3.2.cmml" xref="S5.SS3.p1.2.m2.1.1.3.2">𝒟</ci><ci id="S5.SS3.p1.2.m2.1.1.3.3.cmml" xref="S5.SS3.p1.2.m2.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.2.m2.1c">\mathcal{D}^{-}_{b}{}\cup\mathcal{D}_{n}{}</annotation></semantics></math>. We take TFA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib55" title="" class="ltx_ref">55</a>]</cite> as the baseline and consider the following settings for the second step: (1) full set <math id="S5.SS3.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{D}_{b}{}\cup\mathcal{D}_{n}{}" display="inline"><semantics id="S5.SS3.p1.3.m3.1a"><mrow id="S5.SS3.p1.3.m3.1.1" xref="S5.SS3.p1.3.m3.1.1.cmml"><msub id="S5.SS3.p1.3.m3.1.1.2" xref="S5.SS3.p1.3.m3.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.p1.3.m3.1.1.2.2" xref="S5.SS3.p1.3.m3.1.1.2.2.cmml">𝒟</mi><mi id="S5.SS3.p1.3.m3.1.1.2.3" xref="S5.SS3.p1.3.m3.1.1.2.3.cmml">b</mi></msub><mo id="S5.SS3.p1.3.m3.1.1.1" xref="S5.SS3.p1.3.m3.1.1.1.cmml">∪</mo><msub id="S5.SS3.p1.3.m3.1.1.3" xref="S5.SS3.p1.3.m3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.p1.3.m3.1.1.3.2" xref="S5.SS3.p1.3.m3.1.1.3.2.cmml">𝒟</mi><mi id="S5.SS3.p1.3.m3.1.1.3.3" xref="S5.SS3.p1.3.m3.1.1.3.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.3.m3.1b"><apply id="S5.SS3.p1.3.m3.1.1.cmml" xref="S5.SS3.p1.3.m3.1.1"><union id="S5.SS3.p1.3.m3.1.1.1.cmml" xref="S5.SS3.p1.3.m3.1.1.1"></union><apply id="S5.SS3.p1.3.m3.1.1.2.cmml" xref="S5.SS3.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S5.SS3.p1.3.m3.1.1.2.1.cmml" xref="S5.SS3.p1.3.m3.1.1.2">subscript</csymbol><ci id="S5.SS3.p1.3.m3.1.1.2.2.cmml" xref="S5.SS3.p1.3.m3.1.1.2.2">𝒟</ci><ci id="S5.SS3.p1.3.m3.1.1.2.3.cmml" xref="S5.SS3.p1.3.m3.1.1.2.3">𝑏</ci></apply><apply id="S5.SS3.p1.3.m3.1.1.3.cmml" xref="S5.SS3.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S5.SS3.p1.3.m3.1.1.3.1.cmml" xref="S5.SS3.p1.3.m3.1.1.3">subscript</csymbol><ci id="S5.SS3.p1.3.m3.1.1.3.2.cmml" xref="S5.SS3.p1.3.m3.1.1.3.2">𝒟</ci><ci id="S5.SS3.p1.3.m3.1.1.3.3.cmml" xref="S5.SS3.p1.3.m3.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.3.m3.1c">\mathcal{D}_{b}{}\cup\mathcal{D}_{n}{}</annotation></semantics></math>, (2) balanced set <math id="S5.SS3.p1.4.m4.1" class="ltx_Math" alttext="\mathcal{D}^{-}_{b}{}\cup\mathcal{D}_{n}{}" display="inline"><semantics id="S5.SS3.p1.4.m4.1a"><mrow id="S5.SS3.p1.4.m4.1.1" xref="S5.SS3.p1.4.m4.1.1.cmml"><msubsup id="S5.SS3.p1.4.m4.1.1.2" xref="S5.SS3.p1.4.m4.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.p1.4.m4.1.1.2.2.2" xref="S5.SS3.p1.4.m4.1.1.2.2.2.cmml">𝒟</mi><mi id="S5.SS3.p1.4.m4.1.1.2.3" xref="S5.SS3.p1.4.m4.1.1.2.3.cmml">b</mi><mo id="S5.SS3.p1.4.m4.1.1.2.2.3" xref="S5.SS3.p1.4.m4.1.1.2.2.3.cmml">−</mo></msubsup><mo id="S5.SS3.p1.4.m4.1.1.1" xref="S5.SS3.p1.4.m4.1.1.1.cmml">∪</mo><msub id="S5.SS3.p1.4.m4.1.1.3" xref="S5.SS3.p1.4.m4.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.p1.4.m4.1.1.3.2" xref="S5.SS3.p1.4.m4.1.1.3.2.cmml">𝒟</mi><mi id="S5.SS3.p1.4.m4.1.1.3.3" xref="S5.SS3.p1.4.m4.1.1.3.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.4.m4.1b"><apply id="S5.SS3.p1.4.m4.1.1.cmml" xref="S5.SS3.p1.4.m4.1.1"><union id="S5.SS3.p1.4.m4.1.1.1.cmml" xref="S5.SS3.p1.4.m4.1.1.1"></union><apply id="S5.SS3.p1.4.m4.1.1.2.cmml" xref="S5.SS3.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S5.SS3.p1.4.m4.1.1.2.1.cmml" xref="S5.SS3.p1.4.m4.1.1.2">subscript</csymbol><apply id="S5.SS3.p1.4.m4.1.1.2.2.cmml" xref="S5.SS3.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S5.SS3.p1.4.m4.1.1.2.2.1.cmml" xref="S5.SS3.p1.4.m4.1.1.2">superscript</csymbol><ci id="S5.SS3.p1.4.m4.1.1.2.2.2.cmml" xref="S5.SS3.p1.4.m4.1.1.2.2.2">𝒟</ci><minus id="S5.SS3.p1.4.m4.1.1.2.2.3.cmml" xref="S5.SS3.p1.4.m4.1.1.2.2.3"></minus></apply><ci id="S5.SS3.p1.4.m4.1.1.2.3.cmml" xref="S5.SS3.p1.4.m4.1.1.2.3">𝑏</ci></apply><apply id="S5.SS3.p1.4.m4.1.1.3.cmml" xref="S5.SS3.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S5.SS3.p1.4.m4.1.1.3.1.cmml" xref="S5.SS3.p1.4.m4.1.1.3">subscript</csymbol><ci id="S5.SS3.p1.4.m4.1.1.3.2.cmml" xref="S5.SS3.p1.4.m4.1.1.3.2">𝒟</ci><ci id="S5.SS3.p1.4.m4.1.1.3.3.cmml" xref="S5.SS3.p1.4.m4.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.4.m4.1c">\mathcal{D}^{-}_{b}{}\cup\mathcal{D}_{n}{}</annotation></semantics></math>, (3) only novel set <math id="S5.SS3.p1.5.m5.1" class="ltx_Math" alttext="\mathcal{D}_{n}{}" display="inline"><semantics id="S5.SS3.p1.5.m5.1a"><msub id="S5.SS3.p1.5.m5.1.1" xref="S5.SS3.p1.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.p1.5.m5.1.1.2" xref="S5.SS3.p1.5.m5.1.1.2.cmml">𝒟</mi><mi id="S5.SS3.p1.5.m5.1.1.3" xref="S5.SS3.p1.5.m5.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.5.m5.1b"><apply id="S5.SS3.p1.5.m5.1.1.cmml" xref="S5.SS3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S5.SS3.p1.5.m5.1.1.1.cmml" xref="S5.SS3.p1.5.m5.1.1">subscript</csymbol><ci id="S5.SS3.p1.5.m5.1.1.2.cmml" xref="S5.SS3.p1.5.m5.1.1.2">𝒟</ci><ci id="S5.SS3.p1.5.m5.1.1.3.cmml" xref="S5.SS3.p1.5.m5.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.5.m5.1c">\mathcal{D}_{n}{}</annotation></semantics></math>.</p>
</div>
<div id="S5.SS3.p2" class="ltx_para">
<p id="S5.SS3.p2.7" class="ltx_p">As shown in Fig. <a href="#S5.F3" title="Figure 3 ‣ 5.2 Comparison with FSOD Methods ‣ 5 Experiment ‣ DiGeo: Discriminative Geometry-Aware Learning for Generalized Few-Shot Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, we visualize the separation of classifier weights based on their pair-wise cosine similarities.
By comparing Fig. <a href="#S5.F3" title="Figure 3 ‣ 5.2 Comparison with FSOD Methods ‣ 5 Experiment ‣ DiGeo: Discriminative Geometry-Aware Learning for Generalized Few-Shot Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>(a-c), fine-tuning among a balanced set is vital to learn the well-separated classifier weights for all classes <math id="S5.SS3.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{C}_{b}{}\cup\mathcal{C}_{n}{}" display="inline"><semantics id="S5.SS3.p2.1.m1.1a"><mrow id="S5.SS3.p2.1.m1.1.1" xref="S5.SS3.p2.1.m1.1.1.cmml"><msub id="S5.SS3.p2.1.m1.1.1.2" xref="S5.SS3.p2.1.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.p2.1.m1.1.1.2.2" xref="S5.SS3.p2.1.m1.1.1.2.2.cmml">𝒞</mi><mi id="S5.SS3.p2.1.m1.1.1.2.3" xref="S5.SS3.p2.1.m1.1.1.2.3.cmml">b</mi></msub><mo id="S5.SS3.p2.1.m1.1.1.1" xref="S5.SS3.p2.1.m1.1.1.1.cmml">∪</mo><msub id="S5.SS3.p2.1.m1.1.1.3" xref="S5.SS3.p2.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.p2.1.m1.1.1.3.2" xref="S5.SS3.p2.1.m1.1.1.3.2.cmml">𝒞</mi><mi id="S5.SS3.p2.1.m1.1.1.3.3" xref="S5.SS3.p2.1.m1.1.1.3.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.1.m1.1b"><apply id="S5.SS3.p2.1.m1.1.1.cmml" xref="S5.SS3.p2.1.m1.1.1"><union id="S5.SS3.p2.1.m1.1.1.1.cmml" xref="S5.SS3.p2.1.m1.1.1.1"></union><apply id="S5.SS3.p2.1.m1.1.1.2.cmml" xref="S5.SS3.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S5.SS3.p2.1.m1.1.1.2.1.cmml" xref="S5.SS3.p2.1.m1.1.1.2">subscript</csymbol><ci id="S5.SS3.p2.1.m1.1.1.2.2.cmml" xref="S5.SS3.p2.1.m1.1.1.2.2">𝒞</ci><ci id="S5.SS3.p2.1.m1.1.1.2.3.cmml" xref="S5.SS3.p2.1.m1.1.1.2.3">𝑏</ci></apply><apply id="S5.SS3.p2.1.m1.1.1.3.cmml" xref="S5.SS3.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S5.SS3.p2.1.m1.1.1.3.1.cmml" xref="S5.SS3.p2.1.m1.1.1.3">subscript</csymbol><ci id="S5.SS3.p2.1.m1.1.1.3.2.cmml" xref="S5.SS3.p2.1.m1.1.1.3.2">𝒞</ci><ci id="S5.SS3.p2.1.m1.1.1.3.3.cmml" xref="S5.SS3.p2.1.m1.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.1.m1.1c">\mathcal{C}_{b}{}\cup\mathcal{C}_{n}{}</annotation></semantics></math>.
Instead, using the full set would make the novel classes entangled in Fig. <a href="#S5.F3" title="Figure 3 ‣ 5.2 Comparison with FSOD Methods ‣ 5 Experiment ‣ DiGeo: Discriminative Geometry-Aware Learning for Generalized Few-Shot Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>(a) due to the extremely imbalanced class distribution (<em id="S5.SS3.p2.7.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S5.SS3.p2.7.2" class="ltx_text"></span>, <math id="S5.SS3.p2.2.m2.2" class="ltx_Math" alttext="|\mathcal{D}_{n}{}|\ll|\mathcal{D}_{b}{}|" display="inline"><semantics id="S5.SS3.p2.2.m2.2a"><mrow id="S5.SS3.p2.2.m2.2.2" xref="S5.SS3.p2.2.m2.2.2.cmml"><mrow id="S5.SS3.p2.2.m2.1.1.1.1" xref="S5.SS3.p2.2.m2.1.1.1.2.cmml"><mo stretchy="false" id="S5.SS3.p2.2.m2.1.1.1.1.2" xref="S5.SS3.p2.2.m2.1.1.1.2.1.cmml">|</mo><msub id="S5.SS3.p2.2.m2.1.1.1.1.1" xref="S5.SS3.p2.2.m2.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.p2.2.m2.1.1.1.1.1.2" xref="S5.SS3.p2.2.m2.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S5.SS3.p2.2.m2.1.1.1.1.1.3" xref="S5.SS3.p2.2.m2.1.1.1.1.1.3.cmml">n</mi></msub><mo stretchy="false" id="S5.SS3.p2.2.m2.1.1.1.1.3" xref="S5.SS3.p2.2.m2.1.1.1.2.1.cmml">|</mo></mrow><mo id="S5.SS3.p2.2.m2.2.2.3" xref="S5.SS3.p2.2.m2.2.2.3.cmml">≪</mo><mrow id="S5.SS3.p2.2.m2.2.2.2.1" xref="S5.SS3.p2.2.m2.2.2.2.2.cmml"><mo stretchy="false" id="S5.SS3.p2.2.m2.2.2.2.1.2" xref="S5.SS3.p2.2.m2.2.2.2.2.1.cmml">|</mo><msub id="S5.SS3.p2.2.m2.2.2.2.1.1" xref="S5.SS3.p2.2.m2.2.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.p2.2.m2.2.2.2.1.1.2" xref="S5.SS3.p2.2.m2.2.2.2.1.1.2.cmml">𝒟</mi><mi id="S5.SS3.p2.2.m2.2.2.2.1.1.3" xref="S5.SS3.p2.2.m2.2.2.2.1.1.3.cmml">b</mi></msub><mo stretchy="false" id="S5.SS3.p2.2.m2.2.2.2.1.3" xref="S5.SS3.p2.2.m2.2.2.2.2.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.2.m2.2b"><apply id="S5.SS3.p2.2.m2.2.2.cmml" xref="S5.SS3.p2.2.m2.2.2"><csymbol cd="latexml" id="S5.SS3.p2.2.m2.2.2.3.cmml" xref="S5.SS3.p2.2.m2.2.2.3">much-less-than</csymbol><apply id="S5.SS3.p2.2.m2.1.1.1.2.cmml" xref="S5.SS3.p2.2.m2.1.1.1.1"><abs id="S5.SS3.p2.2.m2.1.1.1.2.1.cmml" xref="S5.SS3.p2.2.m2.1.1.1.1.2"></abs><apply id="S5.SS3.p2.2.m2.1.1.1.1.1.cmml" xref="S5.SS3.p2.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.SS3.p2.2.m2.1.1.1.1.1.1.cmml" xref="S5.SS3.p2.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S5.SS3.p2.2.m2.1.1.1.1.1.2.cmml" xref="S5.SS3.p2.2.m2.1.1.1.1.1.2">𝒟</ci><ci id="S5.SS3.p2.2.m2.1.1.1.1.1.3.cmml" xref="S5.SS3.p2.2.m2.1.1.1.1.1.3">𝑛</ci></apply></apply><apply id="S5.SS3.p2.2.m2.2.2.2.2.cmml" xref="S5.SS3.p2.2.m2.2.2.2.1"><abs id="S5.SS3.p2.2.m2.2.2.2.2.1.cmml" xref="S5.SS3.p2.2.m2.2.2.2.1.2"></abs><apply id="S5.SS3.p2.2.m2.2.2.2.1.1.cmml" xref="S5.SS3.p2.2.m2.2.2.2.1.1"><csymbol cd="ambiguous" id="S5.SS3.p2.2.m2.2.2.2.1.1.1.cmml" xref="S5.SS3.p2.2.m2.2.2.2.1.1">subscript</csymbol><ci id="S5.SS3.p2.2.m2.2.2.2.1.1.2.cmml" xref="S5.SS3.p2.2.m2.2.2.2.1.1.2">𝒟</ci><ci id="S5.SS3.p2.2.m2.2.2.2.1.1.3.cmml" xref="S5.SS3.p2.2.m2.2.2.2.1.1.3">𝑏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.2.m2.2c">|\mathcal{D}_{n}{}|\ll|\mathcal{D}_{b}{}|</annotation></semantics></math>). Although only using <math id="S5.SS3.p2.3.m3.1" class="ltx_Math" alttext="\mathcal{D}_{n}{}" display="inline"><semantics id="S5.SS3.p2.3.m3.1a"><msub id="S5.SS3.p2.3.m3.1.1" xref="S5.SS3.p2.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.p2.3.m3.1.1.2" xref="S5.SS3.p2.3.m3.1.1.2.cmml">𝒟</mi><mi id="S5.SS3.p2.3.m3.1.1.3" xref="S5.SS3.p2.3.m3.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.3.m3.1b"><apply id="S5.SS3.p2.3.m3.1.1.cmml" xref="S5.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS3.p2.3.m3.1.1.1.cmml" xref="S5.SS3.p2.3.m3.1.1">subscript</csymbol><ci id="S5.SS3.p2.3.m3.1.1.2.cmml" xref="S5.SS3.p2.3.m3.1.1.2">𝒟</ci><ci id="S5.SS3.p2.3.m3.1.1.3.cmml" xref="S5.SS3.p2.3.m3.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.3.m3.1c">\mathcal{D}_{n}{}</annotation></semantics></math> can maximally separate the weights of <math id="S5.SS3.p2.4.m4.1" class="ltx_Math" alttext="W_{n}" display="inline"><semantics id="S5.SS3.p2.4.m4.1a"><msub id="S5.SS3.p2.4.m4.1.1" xref="S5.SS3.p2.4.m4.1.1.cmml"><mi id="S5.SS3.p2.4.m4.1.1.2" xref="S5.SS3.p2.4.m4.1.1.2.cmml">W</mi><mi id="S5.SS3.p2.4.m4.1.1.3" xref="S5.SS3.p2.4.m4.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.4.m4.1b"><apply id="S5.SS3.p2.4.m4.1.1.cmml" xref="S5.SS3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS3.p2.4.m4.1.1.1.cmml" xref="S5.SS3.p2.4.m4.1.1">subscript</csymbol><ci id="S5.SS3.p2.4.m4.1.1.2.cmml" xref="S5.SS3.p2.4.m4.1.1.2">𝑊</ci><ci id="S5.SS3.p2.4.m4.1.1.3.cmml" xref="S5.SS3.p2.4.m4.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.4.m4.1c">W_{n}</annotation></semantics></math>, as no training data of <math id="S5.SS3.p2.5.m5.1" class="ltx_Math" alttext="\mathcal{C}_{b}{}" display="inline"><semantics id="S5.SS3.p2.5.m5.1a"><msub id="S5.SS3.p2.5.m5.1.1" xref="S5.SS3.p2.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.p2.5.m5.1.1.2" xref="S5.SS3.p2.5.m5.1.1.2.cmml">𝒞</mi><mi id="S5.SS3.p2.5.m5.1.1.3" xref="S5.SS3.p2.5.m5.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.5.m5.1b"><apply id="S5.SS3.p2.5.m5.1.1.cmml" xref="S5.SS3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S5.SS3.p2.5.m5.1.1.1.cmml" xref="S5.SS3.p2.5.m5.1.1">subscript</csymbol><ci id="S5.SS3.p2.5.m5.1.1.2.cmml" xref="S5.SS3.p2.5.m5.1.1.2">𝒞</ci><ci id="S5.SS3.p2.5.m5.1.1.3.cmml" xref="S5.SS3.p2.5.m5.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.5.m5.1c">\mathcal{C}_{b}{}</annotation></semantics></math> is seen, the separation between <span id="S5.SS3.p2.7.3" class="ltx_text ltx_font_italic">base</span> weights in <math id="S5.SS3.p2.6.m6.1" class="ltx_Math" alttext="W_{b}" display="inline"><semantics id="S5.SS3.p2.6.m6.1a"><msub id="S5.SS3.p2.6.m6.1.1" xref="S5.SS3.p2.6.m6.1.1.cmml"><mi id="S5.SS3.p2.6.m6.1.1.2" xref="S5.SS3.p2.6.m6.1.1.2.cmml">W</mi><mi id="S5.SS3.p2.6.m6.1.1.3" xref="S5.SS3.p2.6.m6.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.6.m6.1b"><apply id="S5.SS3.p2.6.m6.1.1.cmml" xref="S5.SS3.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S5.SS3.p2.6.m6.1.1.1.cmml" xref="S5.SS3.p2.6.m6.1.1">subscript</csymbol><ci id="S5.SS3.p2.6.m6.1.1.2.cmml" xref="S5.SS3.p2.6.m6.1.1.2">𝑊</ci><ci id="S5.SS3.p2.6.m6.1.1.3.cmml" xref="S5.SS3.p2.6.m6.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.6.m6.1c">W_{b}</annotation></semantics></math> is hurt and each <span id="S5.SS3.p2.7.4" class="ltx_text ltx_font_italic">novel</span> class center <math id="S5.SS3.p2.7.m7.1" class="ltx_Math" alttext="\mathbf{w}_{i}\in W_{n}" display="inline"><semantics id="S5.SS3.p2.7.m7.1a"><mrow id="S5.SS3.p2.7.m7.1.1" xref="S5.SS3.p2.7.m7.1.1.cmml"><msub id="S5.SS3.p2.7.m7.1.1.2" xref="S5.SS3.p2.7.m7.1.1.2.cmml"><mi id="S5.SS3.p2.7.m7.1.1.2.2" xref="S5.SS3.p2.7.m7.1.1.2.2.cmml">𝐰</mi><mi id="S5.SS3.p2.7.m7.1.1.2.3" xref="S5.SS3.p2.7.m7.1.1.2.3.cmml">i</mi></msub><mo id="S5.SS3.p2.7.m7.1.1.1" xref="S5.SS3.p2.7.m7.1.1.1.cmml">∈</mo><msub id="S5.SS3.p2.7.m7.1.1.3" xref="S5.SS3.p2.7.m7.1.1.3.cmml"><mi id="S5.SS3.p2.7.m7.1.1.3.2" xref="S5.SS3.p2.7.m7.1.1.3.2.cmml">W</mi><mi id="S5.SS3.p2.7.m7.1.1.3.3" xref="S5.SS3.p2.7.m7.1.1.3.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.7.m7.1b"><apply id="S5.SS3.p2.7.m7.1.1.cmml" xref="S5.SS3.p2.7.m7.1.1"><in id="S5.SS3.p2.7.m7.1.1.1.cmml" xref="S5.SS3.p2.7.m7.1.1.1"></in><apply id="S5.SS3.p2.7.m7.1.1.2.cmml" xref="S5.SS3.p2.7.m7.1.1.2"><csymbol cd="ambiguous" id="S5.SS3.p2.7.m7.1.1.2.1.cmml" xref="S5.SS3.p2.7.m7.1.1.2">subscript</csymbol><ci id="S5.SS3.p2.7.m7.1.1.2.2.cmml" xref="S5.SS3.p2.7.m7.1.1.2.2">𝐰</ci><ci id="S5.SS3.p2.7.m7.1.1.2.3.cmml" xref="S5.SS3.p2.7.m7.1.1.2.3">𝑖</ci></apply><apply id="S5.SS3.p2.7.m7.1.1.3.cmml" xref="S5.SS3.p2.7.m7.1.1.3"><csymbol cd="ambiguous" id="S5.SS3.p2.7.m7.1.1.3.1.cmml" xref="S5.SS3.p2.7.m7.1.1.3">subscript</csymbol><ci id="S5.SS3.p2.7.m7.1.1.3.2.cmml" xref="S5.SS3.p2.7.m7.1.1.3.2">𝑊</ci><ci id="S5.SS3.p2.7.m7.1.1.3.3.cmml" xref="S5.SS3.p2.7.m7.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.7.m7.1c">\mathbf{w}_{i}\in W_{n}</annotation></semantics></math> may still close to some <span id="S5.SS3.p2.7.5" class="ltx_text ltx_font_italic">base</span> weight, <em id="S5.SS3.p2.7.6" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S5.SS3.p2.7.7" class="ltx_text"></span>, the similarity between classes “cat” and “cow” is relatively high in Fig. <a href="#S5.F3" title="Figure 3 ‣ 5.2 Comparison with FSOD Methods ‣ 5 Experiment ‣ DiGeo: Discriminative Geometry-Aware Learning for Generalized Few-Shot Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>(c).</p>
</div>
<div id="S5.SS3.p3" class="ltx_para">
<p id="S5.SS3.p3.6" class="ltx_p">As summarized in Table <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:tab:step</span>, the novel detection fails when the full set is used in fine-tuning (Row<sub id="S5.SS3.p3.6.1" class="ltx_sub"><span id="S5.SS3.p3.6.1.1" class="ltx_text ltx_font_italic">{1}</span></sub>). The detection precision on both <math id="S5.SS3.p3.2.m2.1" class="ltx_Math" alttext="\mathcal{C}_{b}{}\cup\mathcal{C}_{n}{}" display="inline"><semantics id="S5.SS3.p3.2.m2.1a"><mrow id="S5.SS3.p3.2.m2.1.1" xref="S5.SS3.p3.2.m2.1.1.cmml"><msub id="S5.SS3.p3.2.m2.1.1.2" xref="S5.SS3.p3.2.m2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.p3.2.m2.1.1.2.2" xref="S5.SS3.p3.2.m2.1.1.2.2.cmml">𝒞</mi><mi id="S5.SS3.p3.2.m2.1.1.2.3" xref="S5.SS3.p3.2.m2.1.1.2.3.cmml">b</mi></msub><mo id="S5.SS3.p3.2.m2.1.1.1" xref="S5.SS3.p3.2.m2.1.1.1.cmml">∪</mo><msub id="S5.SS3.p3.2.m2.1.1.3" xref="S5.SS3.p3.2.m2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.p3.2.m2.1.1.3.2" xref="S5.SS3.p3.2.m2.1.1.3.2.cmml">𝒞</mi><mi id="S5.SS3.p3.2.m2.1.1.3.3" xref="S5.SS3.p3.2.m2.1.1.3.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.2.m2.1b"><apply id="S5.SS3.p3.2.m2.1.1.cmml" xref="S5.SS3.p3.2.m2.1.1"><union id="S5.SS3.p3.2.m2.1.1.1.cmml" xref="S5.SS3.p3.2.m2.1.1.1"></union><apply id="S5.SS3.p3.2.m2.1.1.2.cmml" xref="S5.SS3.p3.2.m2.1.1.2"><csymbol cd="ambiguous" id="S5.SS3.p3.2.m2.1.1.2.1.cmml" xref="S5.SS3.p3.2.m2.1.1.2">subscript</csymbol><ci id="S5.SS3.p3.2.m2.1.1.2.2.cmml" xref="S5.SS3.p3.2.m2.1.1.2.2">𝒞</ci><ci id="S5.SS3.p3.2.m2.1.1.2.3.cmml" xref="S5.SS3.p3.2.m2.1.1.2.3">𝑏</ci></apply><apply id="S5.SS3.p3.2.m2.1.1.3.cmml" xref="S5.SS3.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="S5.SS3.p3.2.m2.1.1.3.1.cmml" xref="S5.SS3.p3.2.m2.1.1.3">subscript</csymbol><ci id="S5.SS3.p3.2.m2.1.1.3.2.cmml" xref="S5.SS3.p3.2.m2.1.1.3.2">𝒞</ci><ci id="S5.SS3.p3.2.m2.1.1.3.3.cmml" xref="S5.SS3.p3.2.m2.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.2.m2.1c">\mathcal{C}_{b}{}\cup\mathcal{C}_{n}{}</annotation></semantics></math> is sub-optimal when no annotation of base class is provided (Row<sub id="S5.SS3.p3.6.2" class="ltx_sub"><span id="S5.SS3.p3.6.2.1" class="ltx_text ltx_font_italic">{3}</span></sub>) and the detector can easily overfit to the small <math id="S5.SS3.p3.4.m4.1" class="ltx_Math" alttext="\mathcal{D}_{n}{}" display="inline"><semantics id="S5.SS3.p3.4.m4.1a"><msub id="S5.SS3.p3.4.m4.1.1" xref="S5.SS3.p3.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.p3.4.m4.1.1.2" xref="S5.SS3.p3.4.m4.1.1.2.cmml">𝒟</mi><mi id="S5.SS3.p3.4.m4.1.1.3" xref="S5.SS3.p3.4.m4.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.4.m4.1b"><apply id="S5.SS3.p3.4.m4.1.1.cmml" xref="S5.SS3.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS3.p3.4.m4.1.1.1.cmml" xref="S5.SS3.p3.4.m4.1.1">subscript</csymbol><ci id="S5.SS3.p3.4.m4.1.1.2.cmml" xref="S5.SS3.p3.4.m4.1.1.2">𝒟</ci><ci id="S5.SS3.p3.4.m4.1.1.3.cmml" xref="S5.SS3.p3.4.m4.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.4.m4.1c">\mathcal{D}_{n}{}</annotation></semantics></math>. Then, finetuning on the balanced set (Row<sub id="S5.SS3.p3.6.3" class="ltx_sub"><span id="S5.SS3.p3.6.3.1" class="ltx_text ltx_font_italic">{2}</span></sub>) can preserve the base knowledge, maximize the few-shot adaptation effect, and achieve the highest score among the three settings. However, such a balanced set has discarded the diverse training samples of <math id="S5.SS3.p3.6.m6.1" class="ltx_Math" alttext="\mathcal{C}_{b}{}" display="inline"><semantics id="S5.SS3.p3.6.m6.1a"><msub id="S5.SS3.p3.6.m6.1.1" xref="S5.SS3.p3.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.p3.6.m6.1.1.2" xref="S5.SS3.p3.6.m6.1.1.2.cmml">𝒞</mi><mi id="S5.SS3.p3.6.m6.1.1.3" xref="S5.SS3.p3.6.m6.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.6.m6.1b"><apply id="S5.SS3.p3.6.m6.1.1.cmml" xref="S5.SS3.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S5.SS3.p3.6.m6.1.1.1.cmml" xref="S5.SS3.p3.6.m6.1.1">subscript</csymbol><ci id="S5.SS3.p3.6.m6.1.1.2.cmml" xref="S5.SS3.p3.6.m6.1.1.2">𝒞</ci><ci id="S5.SS3.p3.6.m6.1.1.3.cmml" xref="S5.SS3.p3.6.m6.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.6.m6.1c">\mathcal{C}_{b}{}</annotation></semantics></math> and the performance drop in base detection is inevitable.</p>
</div>
<div id="S5.SS3.p4" class="ltx_para ltx_noindent">
<p id="S5.SS3.p4.6" class="ltx_p"><span id="S5.SS3.p4.6.1" class="ltx_text ltx_font_bold">Training on the union of whole base set and upsampled novel set.</span>
In contrast, we propose to train from <math id="S5.SS3.p4.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{b}{}\cup\mathcal{D}^{+}_{n}{}" display="inline"><semantics id="S5.SS3.p4.1.m1.1a"><mrow id="S5.SS3.p4.1.m1.1.1" xref="S5.SS3.p4.1.m1.1.1.cmml"><msub id="S5.SS3.p4.1.m1.1.1.2" xref="S5.SS3.p4.1.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.p4.1.m1.1.1.2.2" xref="S5.SS3.p4.1.m1.1.1.2.2.cmml">𝒟</mi><mi id="S5.SS3.p4.1.m1.1.1.2.3" xref="S5.SS3.p4.1.m1.1.1.2.3.cmml">b</mi></msub><mo id="S5.SS3.p4.1.m1.1.1.1" xref="S5.SS3.p4.1.m1.1.1.1.cmml">∪</mo><msubsup id="S5.SS3.p4.1.m1.1.1.3" xref="S5.SS3.p4.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.p4.1.m1.1.1.3.2.2" xref="S5.SS3.p4.1.m1.1.1.3.2.2.cmml">𝒟</mi><mi id="S5.SS3.p4.1.m1.1.1.3.3" xref="S5.SS3.p4.1.m1.1.1.3.3.cmml">n</mi><mo id="S5.SS3.p4.1.m1.1.1.3.2.3" xref="S5.SS3.p4.1.m1.1.1.3.2.3.cmml">+</mo></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p4.1.m1.1b"><apply id="S5.SS3.p4.1.m1.1.1.cmml" xref="S5.SS3.p4.1.m1.1.1"><union id="S5.SS3.p4.1.m1.1.1.1.cmml" xref="S5.SS3.p4.1.m1.1.1.1"></union><apply id="S5.SS3.p4.1.m1.1.1.2.cmml" xref="S5.SS3.p4.1.m1.1.1.2"><csymbol cd="ambiguous" id="S5.SS3.p4.1.m1.1.1.2.1.cmml" xref="S5.SS3.p4.1.m1.1.1.2">subscript</csymbol><ci id="S5.SS3.p4.1.m1.1.1.2.2.cmml" xref="S5.SS3.p4.1.m1.1.1.2.2">𝒟</ci><ci id="S5.SS3.p4.1.m1.1.1.2.3.cmml" xref="S5.SS3.p4.1.m1.1.1.2.3">𝑏</ci></apply><apply id="S5.SS3.p4.1.m1.1.1.3.cmml" xref="S5.SS3.p4.1.m1.1.1.3"><csymbol cd="ambiguous" id="S5.SS3.p4.1.m1.1.1.3.1.cmml" xref="S5.SS3.p4.1.m1.1.1.3">subscript</csymbol><apply id="S5.SS3.p4.1.m1.1.1.3.2.cmml" xref="S5.SS3.p4.1.m1.1.1.3"><csymbol cd="ambiguous" id="S5.SS3.p4.1.m1.1.1.3.2.1.cmml" xref="S5.SS3.p4.1.m1.1.1.3">superscript</csymbol><ci id="S5.SS3.p4.1.m1.1.1.3.2.2.cmml" xref="S5.SS3.p4.1.m1.1.1.3.2.2">𝒟</ci><plus id="S5.SS3.p4.1.m1.1.1.3.2.3.cmml" xref="S5.SS3.p4.1.m1.1.1.3.2.3"></plus></apply><ci id="S5.SS3.p4.1.m1.1.1.3.3.cmml" xref="S5.SS3.p4.1.m1.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p4.1.m1.1c">\mathcal{D}_{b}{}\cup\mathcal{D}^{+}_{n}{}</annotation></semantics></math> directly. Note that <math id="S5.SS3.p4.2.m2.1" class="ltx_Math" alttext="\mathcal{D}^{+}_{n}{}" display="inline"><semantics id="S5.SS3.p4.2.m2.1a"><msubsup id="S5.SS3.p4.2.m2.1.1" xref="S5.SS3.p4.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.p4.2.m2.1.1.2.2" xref="S5.SS3.p4.2.m2.1.1.2.2.cmml">𝒟</mi><mi id="S5.SS3.p4.2.m2.1.1.3" xref="S5.SS3.p4.2.m2.1.1.3.cmml">n</mi><mo id="S5.SS3.p4.2.m2.1.1.2.3" xref="S5.SS3.p4.2.m2.1.1.2.3.cmml">+</mo></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS3.p4.2.m2.1b"><apply id="S5.SS3.p4.2.m2.1.1.cmml" xref="S5.SS3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS3.p4.2.m2.1.1.1.cmml" xref="S5.SS3.p4.2.m2.1.1">subscript</csymbol><apply id="S5.SS3.p4.2.m2.1.1.2.cmml" xref="S5.SS3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS3.p4.2.m2.1.1.2.1.cmml" xref="S5.SS3.p4.2.m2.1.1">superscript</csymbol><ci id="S5.SS3.p4.2.m2.1.1.2.2.cmml" xref="S5.SS3.p4.2.m2.1.1.2.2">𝒟</ci><plus id="S5.SS3.p4.2.m2.1.1.2.3.cmml" xref="S5.SS3.p4.2.m2.1.1.2.3"></plus></apply><ci id="S5.SS3.p4.2.m2.1.1.3.cmml" xref="S5.SS3.p4.2.m2.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p4.2.m2.1c">\mathcal{D}^{+}_{n}{}</annotation></semantics></math> is a duplication of <math id="S5.SS3.p4.3.m3.1" class="ltx_Math" alttext="\mathcal{D}_{n}{}" display="inline"><semantics id="S5.SS3.p4.3.m3.1a"><msub id="S5.SS3.p4.3.m3.1.1" xref="S5.SS3.p4.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.p4.3.m3.1.1.2" xref="S5.SS3.p4.3.m3.1.1.2.cmml">𝒟</mi><mi id="S5.SS3.p4.3.m3.1.1.3" xref="S5.SS3.p4.3.m3.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p4.3.m3.1b"><apply id="S5.SS3.p4.3.m3.1.1.cmml" xref="S5.SS3.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS3.p4.3.m3.1.1.1.cmml" xref="S5.SS3.p4.3.m3.1.1">subscript</csymbol><ci id="S5.SS3.p4.3.m3.1.1.2.cmml" xref="S5.SS3.p4.3.m3.1.1.2">𝒟</ci><ci id="S5.SS3.p4.3.m3.1.1.3.cmml" xref="S5.SS3.p4.3.m3.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p4.3.m3.1c">\mathcal{D}_{n}{}</annotation></semantics></math> with same images but more copies. To properly separate the features of different classes, we use the data-independent optimization target in Eq. <a href="#S4.E1" title="Equation 1 ‣ 4.1 Inter-Class Separation ‣ 4 Approach ‣ DiGeo: Discriminative Geometry-Aware Learning for Generalized Few-Shot Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> to derive a ETF classifier weights <math id="S5.SS3.p4.4.m4.1" class="ltx_Math" alttext="W^{*}" display="inline"><semantics id="S5.SS3.p4.4.m4.1a"><msup id="S5.SS3.p4.4.m4.1.1" xref="S5.SS3.p4.4.m4.1.1.cmml"><mi id="S5.SS3.p4.4.m4.1.1.2" xref="S5.SS3.p4.4.m4.1.1.2.cmml">W</mi><mo id="S5.SS3.p4.4.m4.1.1.3" xref="S5.SS3.p4.4.m4.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S5.SS3.p4.4.m4.1b"><apply id="S5.SS3.p4.4.m4.1.1.cmml" xref="S5.SS3.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS3.p4.4.m4.1.1.1.cmml" xref="S5.SS3.p4.4.m4.1.1">superscript</csymbol><ci id="S5.SS3.p4.4.m4.1.1.2.cmml" xref="S5.SS3.p4.4.m4.1.1.2">𝑊</ci><times id="S5.SS3.p4.4.m4.1.1.3.cmml" xref="S5.SS3.p4.4.m4.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p4.4.m4.1c">W^{*}</annotation></semantics></math> offline.
As mentioned in Sec. <a href="#S4.SS1" title="4.1 Inter-Class Separation ‣ 4 Approach ‣ DiGeo: Discriminative Geometry-Aware Learning for Generalized Few-Shot Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a>, Eq. <a href="#S4.E1" title="Equation 1 ‣ 4.1 Inter-Class Separation ‣ 4 Approach ‣ DiGeo: Discriminative Geometry-Aware Learning for Generalized Few-Shot Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> can still be used as a regularization loss to supervised the learning of the last linear layer during training (online). However, as shown in Fig. <a href="#S5.F3" title="Figure 3 ‣ 5.2 Comparison with FSOD Methods ‣ 5 Experiment ‣ DiGeo: Discriminative Geometry-Aware Learning for Generalized Few-Shot Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>(d), it is still hard to get a perfect ETF classifier shown in Fig. <a href="#S5.F3" title="Figure 3 ‣ 5.2 Comparison with FSOD Methods ‣ 5 Experiment ‣ DiGeo: Discriminative Geometry-Aware Learning for Generalized Few-Shot Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>(e). After all, the update of classifier weights is also impacted by the weight decay regularization and classification loss, and the learning of weights is not stable, in particular, on an extremely imbalanced dataset.
As the classifier weights are kept being updated, the optimization direction of each feature cluster is not stable, which then impede the adaptation efficiency. As compared in Table. <a href="#S5.T1" title="Table 1 ‣ 5.3 Analysis of Inter-Class Separation ‣ 5 Experiment ‣ DiGeo: Discriminative Geometry-Aware Learning for Generalized Few-Shot Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, the performance by online optimization is slightly worse, in particular when <math id="S5.SS3.p4.5.m5.1" class="ltx_Math" alttext="K=1" display="inline"><semantics id="S5.SS3.p4.5.m5.1a"><mrow id="S5.SS3.p4.5.m5.1.1" xref="S5.SS3.p4.5.m5.1.1.cmml"><mi id="S5.SS3.p4.5.m5.1.1.2" xref="S5.SS3.p4.5.m5.1.1.2.cmml">K</mi><mo id="S5.SS3.p4.5.m5.1.1.1" xref="S5.SS3.p4.5.m5.1.1.1.cmml">=</mo><mn id="S5.SS3.p4.5.m5.1.1.3" xref="S5.SS3.p4.5.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p4.5.m5.1b"><apply id="S5.SS3.p4.5.m5.1.1.cmml" xref="S5.SS3.p4.5.m5.1.1"><eq id="S5.SS3.p4.5.m5.1.1.1.cmml" xref="S5.SS3.p4.5.m5.1.1.1"></eq><ci id="S5.SS3.p4.5.m5.1.1.2.cmml" xref="S5.SS3.p4.5.m5.1.1.2">𝐾</ci><cn type="integer" id="S5.SS3.p4.5.m5.1.1.3.cmml" xref="S5.SS3.p4.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p4.5.m5.1c">K=1</annotation></semantics></math>.
Though the classifier weights are fixed in ETF, as the pair-wise angles between weights are the same, we can equivalently assign the weights to all classes <math id="S5.SS3.p4.6.m6.1" class="ltx_Math" alttext="\mathcal{C}" display="inline"><semantics id="S5.SS3.p4.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.p4.6.m6.1.1" xref="S5.SS3.p4.6.m6.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p4.6.m6.1b"><ci id="S5.SS3.p4.6.m6.1.1.cmml" xref="S5.SS3.p4.6.m6.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p4.6.m6.1c">\mathcal{C}</annotation></semantics></math>.</p>
</div>
<figure id="S5.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S5.T1.8.1.1" class="ltx_text" style="font-size:90%;">Table 1</span>: </span><span id="S5.T1.9.2" class="ltx_text" style="font-size:90%;">Comparison between Offline and Online Classifiers</span></figcaption>
<div id="S5.T1.6" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:134.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(71.6pt,-22.2pt) scale(1.49315115637862,1.49315115637862) ;">
<table id="S5.T1.6.6" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T1.6.6.7.1" class="ltx_tr">
<th id="S5.T1.6.6.7.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r" rowspan="2">
<span id="S5.T1.6.6.7.1.1.1" class="ltx_ERROR undefined">\hlineB</span>3
<span id="S5.T1.6.6.7.1.1.2" class="ltx_text">Approach</span>
</th>
<th id="S5.T1.6.6.7.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" colspan="3">1-shot</th>
<th id="S5.T1.6.6.7.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column" colspan="3">5-shot</th>
</tr>
<tr id="S5.T1.6.6.6" class="ltx_tr">
<th id="S5.T1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column">AP<sub id="S5.T1.1.1.1.1.1" class="ltx_sub"><span id="S5.T1.1.1.1.1.1.1" class="ltx_text ltx_font_italic">50</span></sub>
</th>
<th id="S5.T1.2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column">bAP<sub id="S5.T1.2.2.2.2.1" class="ltx_sub"><span id="S5.T1.2.2.2.2.1.1" class="ltx_text ltx_font_italic">50</span></sub>
</th>
<th id="S5.T1.3.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">nAP<sub id="S5.T1.3.3.3.3.1" class="ltx_sub"><span id="S5.T1.3.3.3.3.1.1" class="ltx_text ltx_font_italic">50</span></sub>
</th>
<th id="S5.T1.4.4.4.4" class="ltx_td ltx_align_center ltx_th ltx_th_column">AP<sub id="S5.T1.4.4.4.4.1" class="ltx_sub"><span id="S5.T1.4.4.4.4.1.1" class="ltx_text ltx_font_italic">50</span></sub>
</th>
<th id="S5.T1.5.5.5.5" class="ltx_td ltx_align_center ltx_th ltx_th_column">bAP<sub id="S5.T1.5.5.5.5.1" class="ltx_sub"><span id="S5.T1.5.5.5.5.1.1" class="ltx_text ltx_font_italic">50</span></sub>
</th>
<th id="S5.T1.6.6.6.6" class="ltx_td ltx_align_center ltx_th ltx_th_column">nAP<sub id="S5.T1.6.6.6.6.1" class="ltx_sub"><span id="S5.T1.6.6.6.6.1.1" class="ltx_text ltx_font_italic">50</span></sub>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T1.6.6.8.1" class="ltx_tr">
<th id="S5.T1.6.6.8.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Offline</th>
<td id="S5.T1.6.6.8.1.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T1.6.6.8.1.2.1" class="ltx_text ltx_font_bold">68.9</span></td>
<td id="S5.T1.6.6.8.1.3" class="ltx_td ltx_align_center ltx_border_t">79.9</td>
<td id="S5.T1.6.6.8.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T1.6.6.8.1.4.1" class="ltx_text ltx_font_bold">35.8</span></td>
<td id="S5.T1.6.6.8.1.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T1.6.6.8.1.5.1" class="ltx_text ltx_font_bold">74.9</span></td>
<td id="S5.T1.6.6.8.1.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T1.6.6.8.1.6.1" class="ltx_text ltx_font_bold">81.0</span></td>
<td id="S5.T1.6.6.8.1.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T1.6.6.8.1.7.1" class="ltx_text ltx_font_bold">56.4</span></td>
</tr>
<tr id="S5.T1.6.6.9.2" class="ltx_tr">
<th id="S5.T1.6.6.9.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Online</th>
<td id="S5.T1.6.6.9.2.2" class="ltx_td ltx_align_center">68.4</td>
<td id="S5.T1.6.6.9.2.3" class="ltx_td ltx_align_center"><span id="S5.T1.6.6.9.2.3.1" class="ltx_text ltx_font_bold">80.2</span></td>
<td id="S5.T1.6.6.9.2.4" class="ltx_td ltx_align_center ltx_border_r">33.1</td>
<td id="S5.T1.6.6.9.2.5" class="ltx_td ltx_align_center">74.6</td>
<td id="S5.T1.6.6.9.2.6" class="ltx_td ltx_align_center">80.8</td>
<td id="S5.T1.6.6.9.2.7" class="ltx_td ltx_align_center">55.9</td>
</tr>
<tr id="S5.T1.6.6.10.3" class="ltx_tr">
<th id="S5.T1.6.6.10.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">
<span id="S5.T1.6.6.10.3.1.1" class="ltx_ERROR undefined">\hlineB</span>3</th>
<td id="S5.T1.6.6.10.3.2" class="ltx_td"></td>
<td id="S5.T1.6.6.10.3.3" class="ltx_td"></td>
<td id="S5.T1.6.6.10.3.4" class="ltx_td"></td>
<td id="S5.T1.6.6.10.3.5" class="ltx_td"></td>
<td id="S5.T1.6.6.10.3.6" class="ltx_td"></td>
<td id="S5.T1.6.6.10.3.7" class="ltx_td"></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="S5.SS3.p5" class="ltx_para">
<p id="S5.SS3.p5.9" class="ltx_p">Next, as compared in Table <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:tab:ablation</span> Row<sub id="S5.SS3.p5.9.1" class="ltx_sub"><span id="S5.SS3.p5.9.1.1" class="ltx_text ltx_font_italic">{1,3,4}</span></sub>, though adding margins or performing RFS may help with inter-class separation and improve nAP<sub id="S5.SS3.p5.9.2" class="ltx_sub"><span id="S5.SS3.p5.9.2.1" class="ltx_text ltx_font_italic">50</span></sub> on <math id="S5.SS3.p5.3.m3.1" class="ltx_Math" alttext="\mathcal{C}_{n}{}" display="inline"><semantics id="S5.SS3.p5.3.m3.1a"><msub id="S5.SS3.p5.3.m3.1.1" xref="S5.SS3.p5.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.p5.3.m3.1.1.2" xref="S5.SS3.p5.3.m3.1.1.2.cmml">𝒞</mi><mi id="S5.SS3.p5.3.m3.1.1.3" xref="S5.SS3.p5.3.m3.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p5.3.m3.1b"><apply id="S5.SS3.p5.3.m3.1.1.cmml" xref="S5.SS3.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS3.p5.3.m3.1.1.1.cmml" xref="S5.SS3.p5.3.m3.1.1">subscript</csymbol><ci id="S5.SS3.p5.3.m3.1.1.2.cmml" xref="S5.SS3.p5.3.m3.1.1.2">𝒞</ci><ci id="S5.SS3.p5.3.m3.1.1.3.cmml" xref="S5.SS3.p5.3.m3.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p5.3.m3.1c">\mathcal{C}_{n}{}</annotation></semantics></math>, since the weights <math id="S5.SS3.p5.4.m4.1" class="ltx_Math" alttext="W_{n}" display="inline"><semantics id="S5.SS3.p5.4.m4.1a"><msub id="S5.SS3.p5.4.m4.1.1" xref="S5.SS3.p5.4.m4.1.1.cmml"><mi id="S5.SS3.p5.4.m4.1.1.2" xref="S5.SS3.p5.4.m4.1.1.2.cmml">W</mi><mi id="S5.SS3.p5.4.m4.1.1.3" xref="S5.SS3.p5.4.m4.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p5.4.m4.1b"><apply id="S5.SS3.p5.4.m4.1.1.cmml" xref="S5.SS3.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS3.p5.4.m4.1.1.1.cmml" xref="S5.SS3.p5.4.m4.1.1">subscript</csymbol><ci id="S5.SS3.p5.4.m4.1.1.2.cmml" xref="S5.SS3.p5.4.m4.1.1.2">𝑊</ci><ci id="S5.SS3.p5.4.m4.1.1.3.cmml" xref="S5.SS3.p5.4.m4.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p5.4.m4.1c">W_{n}</annotation></semantics></math> are still not well-learned due to the extreme imbalance between <math id="S5.SS3.p5.5.m5.1" class="ltx_Math" alttext="\mathcal{D}_{b}{}" display="inline"><semantics id="S5.SS3.p5.5.m5.1a"><msub id="S5.SS3.p5.5.m5.1.1" xref="S5.SS3.p5.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.p5.5.m5.1.1.2" xref="S5.SS3.p5.5.m5.1.1.2.cmml">𝒟</mi><mi id="S5.SS3.p5.5.m5.1.1.3" xref="S5.SS3.p5.5.m5.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p5.5.m5.1b"><apply id="S5.SS3.p5.5.m5.1.1.cmml" xref="S5.SS3.p5.5.m5.1.1"><csymbol cd="ambiguous" id="S5.SS3.p5.5.m5.1.1.1.cmml" xref="S5.SS3.p5.5.m5.1.1">subscript</csymbol><ci id="S5.SS3.p5.5.m5.1.1.2.cmml" xref="S5.SS3.p5.5.m5.1.1.2">𝒟</ci><ci id="S5.SS3.p5.5.m5.1.1.3.cmml" xref="S5.SS3.p5.5.m5.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p5.5.m5.1c">\mathcal{D}_{b}{}</annotation></semantics></math> and <math id="S5.SS3.p5.6.m6.1" class="ltx_Math" alttext="\mathcal{D}_{n}{}" display="inline"><semantics id="S5.SS3.p5.6.m6.1a"><msub id="S5.SS3.p5.6.m6.1.1" xref="S5.SS3.p5.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.p5.6.m6.1.1.2" xref="S5.SS3.p5.6.m6.1.1.2.cmml">𝒟</mi><mi id="S5.SS3.p5.6.m6.1.1.3" xref="S5.SS3.p5.6.m6.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p5.6.m6.1b"><apply id="S5.SS3.p5.6.m6.1.1.cmml" xref="S5.SS3.p5.6.m6.1.1"><csymbol cd="ambiguous" id="S5.SS3.p5.6.m6.1.1.1.cmml" xref="S5.SS3.p5.6.m6.1.1">subscript</csymbol><ci id="S5.SS3.p5.6.m6.1.1.2.cmml" xref="S5.SS3.p5.6.m6.1.1.2">𝒟</ci><ci id="S5.SS3.p5.6.m6.1.1.3.cmml" xref="S5.SS3.p5.6.m6.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p5.6.m6.1c">\mathcal{D}_{n}{}</annotation></semantics></math>, the performance gain is limited. In contrast, fixing the weights as ETF (Row<sub id="S5.SS3.p5.9.3" class="ltx_sub"><span id="S5.SS3.p5.9.3.1" class="ltx_text ltx_font_italic">{(3,5),(4,6)}</span></sub>) can improve the novel detection, in particular, the nAP<sub id="S5.SS3.p5.9.4" class="ltx_sub"><span id="S5.SS3.p5.9.4.1" class="ltx_text ltx_font_italic">50</span></sub> is boosted from 12.2 to 35.8 in Row<sub id="S5.SS3.p5.9.5" class="ltx_sub"><span id="S5.SS3.p5.9.5.1" class="ltx_text ltx_font_italic">{3,5}</span></sub>, which shows that the inter-class separation is essential for distinguishing objects in GFSOD.</p>
</div>
<figure id="S5.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S5.T2.5.1.1" class="ltx_text" style="font-size:90%;">Table 2</span>: </span><span id="S5.T2.6.2" class="ltx_text" style="font-size:90%;">Comparison of Initialization.</span></figcaption>
<div id="S5.T2.3" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:118.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(19.1pt,-5.2pt) scale(1.09686970265344,1.09686970265344) ;">
<table id="S5.T2.3.3" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T2.3.3.4.1" class="ltx_tr">
<th id="S5.T2.3.3.4.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row" rowspan="2">
<span id="S5.T2.3.3.4.1.1.1" class="ltx_ERROR undefined">\hlineB</span>3
<span id="S5.T2.3.3.4.1.1.2" class="ltx_text">Init.</span>
</th>
<th id="S5.T2.3.3.4.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r" rowspan="2"><span id="S5.T2.3.3.4.1.2.1" class="ltx_text">Method</span></th>
<th id="S5.T2.3.3.4.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column" colspan="3">VOC 5-shot</th>
<th id="S5.T2.3.3.4.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column" colspan="3">COCO 10-shot</th>
</tr>
<tr id="S5.T2.3.3.3" class="ltx_tr">
<th id="S5.T2.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column">AP<sub id="S5.T2.1.1.1.1.1" class="ltx_sub"><span id="S5.T2.1.1.1.1.1.1" class="ltx_text ltx_font_italic">50</span></sub>
</th>
<th id="S5.T2.2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column">bAP<sub id="S5.T2.2.2.2.2.1" class="ltx_sub"><span id="S5.T2.2.2.2.2.1.1" class="ltx_text ltx_font_italic">50</span></sub>
</th>
<th id="S5.T2.3.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column">nAP<sub id="S5.T2.3.3.3.3.1" class="ltx_sub"><span id="S5.T2.3.3.3.3.1.1" class="ltx_text ltx_font_italic">50</span></sub>
</th>
<th id="S5.T2.3.3.3.4" class="ltx_td ltx_align_center ltx_th ltx_th_column">AP</th>
<th id="S5.T2.3.3.3.5" class="ltx_td ltx_align_center ltx_th ltx_th_column">bAP</th>
<th id="S5.T2.3.3.3.6" class="ltx_td ltx_align_center ltx_th ltx_th_column">nAP</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T2.3.3.5.1" class="ltx_tr">
<th id="S5.T2.3.3.5.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Base</th>
<th id="S5.T2.3.3.5.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Prior</th>
<td id="S5.T2.3.3.5.1.3" class="ltx_td ltx_align_center ltx_border_t">74.9</td>
<td id="S5.T2.3.3.5.1.4" class="ltx_td ltx_align_center ltx_border_t">80.9</td>
<td id="S5.T2.3.3.5.1.5" class="ltx_td ltx_align_center ltx_border_t">56.7</td>
<td id="S5.T2.3.3.5.1.6" class="ltx_td ltx_align_center ltx_border_t">31.7</td>
<td id="S5.T2.3.3.5.1.7" class="ltx_td ltx_align_center ltx_border_t">39.0</td>
<td id="S5.T2.3.3.5.1.8" class="ltx_td ltx_align_center ltx_border_t">9.7</td>
</tr>
<tr id="S5.T2.3.3.6.2" class="ltx_tr">
<th id="S5.T2.3.3.6.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Base</th>
<th id="S5.T2.3.3.6.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">DeFRCN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>
</th>
<td id="S5.T2.3.3.6.2.3" class="ltx_td ltx_align_center">74.1</td>
<td id="S5.T2.3.3.6.2.4" class="ltx_td ltx_align_center">77.1</td>
<td id="S5.T2.3.3.6.2.5" class="ltx_td ltx_align_center">65.1</td>
<td id="S5.T2.3.3.6.2.6" class="ltx_td ltx_align_center">30.1</td>
<td id="S5.T2.3.3.6.2.7" class="ltx_td ltx_align_center">34.4</td>
<td id="S5.T2.3.3.6.2.8" class="ltx_td ltx_align_center">17.3</td>
</tr>
<tr id="S5.T2.3.3.7.3" class="ltx_tr">
<th id="S5.T2.3.3.7.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Prior</th>
<th id="S5.T2.3.3.7.3.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">DeFRCN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>
</th>
<td id="S5.T2.3.3.7.3.3" class="ltx_td ltx_align_center">74.8</td>
<td id="S5.T2.3.3.7.3.4" class="ltx_td ltx_align_center">78.0</td>
<td id="S5.T2.3.3.7.3.5" class="ltx_td ltx_align_center">65.3</td>
<td id="S5.T2.3.3.7.3.6" class="ltx_td ltx_align_center">30.7</td>
<td id="S5.T2.3.3.7.3.7" class="ltx_td ltx_align_center">35.1</td>
<td id="S5.T2.3.3.7.3.8" class="ltx_td ltx_align_center">17.4</td>
</tr>
<tr id="S5.T2.3.3.8.4" class="ltx_tr">
<th id="S5.T2.3.3.8.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">
<span id="S5.T2.3.3.8.4.1.1" class="ltx_ERROR undefined">\hlineB</span>3</th>
<th id="S5.T2.3.3.8.4.2" class="ltx_td ltx_th ltx_th_row"></th>
<td id="S5.T2.3.3.8.4.3" class="ltx_td"></td>
<td id="S5.T2.3.3.8.4.4" class="ltx_td"></td>
<td id="S5.T2.3.3.8.4.5" class="ltx_td"></td>
<td id="S5.T2.3.3.8.4.6" class="ltx_td"></td>
<td id="S5.T2.3.3.8.4.7" class="ltx_td"></td>
<td id="S5.T2.3.3.8.4.8" class="ltx_td"></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="S5.SS3.p6" class="ltx_para">
<p id="S5.SS3.p6.5" class="ltx_p">Furthermore, being orthogonal to the previous FSOD approaches, our model can be intuitively used as initialization for their adaptation. For the sake of simplicity, we only consider Prior and use a strong baseline DeFRCN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite> for comparison. The PCB calibration <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite> is removed to better demonstrate the effect of Prior. As reported in Table <a href="#S5.T2" title="Table 2 ‣ 5.3 Analysis of Inter-Class Separation ‣ 5 Experiment ‣ DiGeo: Discriminative Geometry-Aware Learning for Generalized Few-Shot Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, though DeFRCN has improved <span id="S5.SS3.p6.5.1" class="ltx_text ltx_font_italic">novel</span> detection (nAP<sub id="S5.SS3.p6.5.2" class="ltx_sub"><span id="S5.SS3.p6.5.2.1" class="ltx_text ltx_font_italic">50</span></sub>) significantly, it still sacrifices the performance on base set. Then, comparing with using <span id="S5.SS3.p6.5.3" class="ltx_text ltx_font_italic">Base</span> detector as initialization, on both datasets, using our Prior can both help with the adaptation on <math id="S5.SS3.p6.2.m2.1" class="ltx_Math" alttext="\mathcal{C}_{n}{}" display="inline"><semantics id="S5.SS3.p6.2.m2.1a"><msub id="S5.SS3.p6.2.m2.1.1" xref="S5.SS3.p6.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.p6.2.m2.1.1.2" xref="S5.SS3.p6.2.m2.1.1.2.cmml">𝒞</mi><mi id="S5.SS3.p6.2.m2.1.1.3" xref="S5.SS3.p6.2.m2.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p6.2.m2.1b"><apply id="S5.SS3.p6.2.m2.1.1.cmml" xref="S5.SS3.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS3.p6.2.m2.1.1.1.cmml" xref="S5.SS3.p6.2.m2.1.1">subscript</csymbol><ci id="S5.SS3.p6.2.m2.1.1.2.cmml" xref="S5.SS3.p6.2.m2.1.1.2">𝒞</ci><ci id="S5.SS3.p6.2.m2.1.1.3.cmml" xref="S5.SS3.p6.2.m2.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p6.2.m2.1c">\mathcal{C}_{n}{}</annotation></semantics></math> and mitigate the drop in <math id="S5.SS3.p6.3.m3.1" class="ltx_Math" alttext="\mathcal{C}_{b}{}" display="inline"><semantics id="S5.SS3.p6.3.m3.1a"><msub id="S5.SS3.p6.3.m3.1.1" xref="S5.SS3.p6.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.p6.3.m3.1.1.2" xref="S5.SS3.p6.3.m3.1.1.2.cmml">𝒞</mi><mi id="S5.SS3.p6.3.m3.1.1.3" xref="S5.SS3.p6.3.m3.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p6.3.m3.1b"><apply id="S5.SS3.p6.3.m3.1.1.cmml" xref="S5.SS3.p6.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS3.p6.3.m3.1.1.1.cmml" xref="S5.SS3.p6.3.m3.1.1">subscript</csymbol><ci id="S5.SS3.p6.3.m3.1.1.2.cmml" xref="S5.SS3.p6.3.m3.1.1.2">𝒞</ci><ci id="S5.SS3.p6.3.m3.1.1.3.cmml" xref="S5.SS3.p6.3.m3.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p6.3.m3.1c">\mathcal{C}_{b}{}</annotation></semantics></math> (bAP<sub id="S5.SS3.p6.5.4" class="ltx_sub"><span id="S5.SS3.p6.5.4.1" class="ltx_text ltx_font_italic">50</span></sub>).
Finally, comparing Table <a href="#S5.T2" title="Table 2 ‣ 5.3 Analysis of Inter-Class Separation ‣ 5 Experiment ‣ DiGeo: Discriminative Geometry-Aware Learning for Generalized Few-Shot Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> Row<sub id="S5.SS3.p6.5.5" class="ltx_sub"><span id="S5.SS3.p6.5.5.1" class="ltx_text ltx_font_italic">{1}</span></sub> and Prior in Table  <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:tab:ablation</span>, adding the step of <span id="S5.SS3.p6.5.6" class="ltx_text ltx_font_italic">Base</span> detector initialization can only provide marginal improvement for Prior. As Prior has already outperformed TFA, we skip pre-training step for simplicity.</p>
</div>
</section>
<section id="S5.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4 </span>Analysis of Intra-Class Compactness</h3>

<figure id="S5.F4" class="ltx_figure"><img src="/html/2303.09674/assets/x4.png" id="S5.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="456" height="206" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F4.4.2.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S5.F4.2.1" class="ltx_text" style="font-size:90%;">Pair-wise cosine similarity between class means and weights. The class mean is obtained by averaging of features for each class. When the detector is trained on full set <math id="S5.F4.2.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{b}{}\cup\mathcal{D}_{n}{}" display="inline"><semantics id="S5.F4.2.1.m1.1b"><mrow id="S5.F4.2.1.m1.1.1" xref="S5.F4.2.1.m1.1.1.cmml"><msub id="S5.F4.2.1.m1.1.1.2" xref="S5.F4.2.1.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.F4.2.1.m1.1.1.2.2" xref="S5.F4.2.1.m1.1.1.2.2.cmml">𝒟</mi><mi id="S5.F4.2.1.m1.1.1.2.3" xref="S5.F4.2.1.m1.1.1.2.3.cmml">b</mi></msub><mo id="S5.F4.2.1.m1.1.1.1" xref="S5.F4.2.1.m1.1.1.1.cmml">∪</mo><msub id="S5.F4.2.1.m1.1.1.3" xref="S5.F4.2.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.F4.2.1.m1.1.1.3.2" xref="S5.F4.2.1.m1.1.1.3.2.cmml">𝒟</mi><mi id="S5.F4.2.1.m1.1.1.3.3" xref="S5.F4.2.1.m1.1.1.3.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S5.F4.2.1.m1.1c"><apply id="S5.F4.2.1.m1.1.1.cmml" xref="S5.F4.2.1.m1.1.1"><union id="S5.F4.2.1.m1.1.1.1.cmml" xref="S5.F4.2.1.m1.1.1.1"></union><apply id="S5.F4.2.1.m1.1.1.2.cmml" xref="S5.F4.2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S5.F4.2.1.m1.1.1.2.1.cmml" xref="S5.F4.2.1.m1.1.1.2">subscript</csymbol><ci id="S5.F4.2.1.m1.1.1.2.2.cmml" xref="S5.F4.2.1.m1.1.1.2.2">𝒟</ci><ci id="S5.F4.2.1.m1.1.1.2.3.cmml" xref="S5.F4.2.1.m1.1.1.2.3">𝑏</ci></apply><apply id="S5.F4.2.1.m1.1.1.3.cmml" xref="S5.F4.2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S5.F4.2.1.m1.1.1.3.1.cmml" xref="S5.F4.2.1.m1.1.1.3">subscript</csymbol><ci id="S5.F4.2.1.m1.1.1.3.2.cmml" xref="S5.F4.2.1.m1.1.1.3.2">𝒟</ci><ci id="S5.F4.2.1.m1.1.1.3.3.cmml" xref="S5.F4.2.1.m1.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F4.2.1.m1.1d">\mathcal{D}_{b}{}\cup\mathcal{D}_{n}{}</annotation></semantics></math>, we first (a) replace the linear classifier with ETF and (b) then use our Prior baseline. Our Prior can push the features close to the assigned weights effectively.</span></figcaption>
</figure>
<div id="S5.SS4.p1" class="ltx_para">
<p id="S5.SS4.p1.6" class="ltx_p">Even though the classifier weights have been maximally and equally separated in Fig. <a href="#S5.F3" title="Figure 3 ‣ 5.2 Comparison with FSOD Methods ‣ 5 Experiment ‣ DiGeo: Discriminative Geometry-Aware Learning for Generalized Few-Shot Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>(e), as the training data is limited, it is still necessary to effectively push the features towards the assigned weight. As compared in Fig. <a href="#S5.F4" title="Figure 4 ‣ 5.4 Analysis of Intra-Class Compactness ‣ 5 Experiment ‣ DiGeo: Discriminative Geometry-Aware Learning for Generalized Few-Shot Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, when ETF is used, for each <math id="S5.SS4.p1.1.m1.1" class="ltx_Math" alttext="c\in\mathcal{C}_{n}{}" display="inline"><semantics id="S5.SS4.p1.1.m1.1a"><mrow id="S5.SS4.p1.1.m1.1.1" xref="S5.SS4.p1.1.m1.1.1.cmml"><mi id="S5.SS4.p1.1.m1.1.1.2" xref="S5.SS4.p1.1.m1.1.1.2.cmml">c</mi><mo id="S5.SS4.p1.1.m1.1.1.1" xref="S5.SS4.p1.1.m1.1.1.1.cmml">∈</mo><msub id="S5.SS4.p1.1.m1.1.1.3" xref="S5.SS4.p1.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS4.p1.1.m1.1.1.3.2" xref="S5.SS4.p1.1.m1.1.1.3.2.cmml">𝒞</mi><mi id="S5.SS4.p1.1.m1.1.1.3.3" xref="S5.SS4.p1.1.m1.1.1.3.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.1.m1.1b"><apply id="S5.SS4.p1.1.m1.1.1.cmml" xref="S5.SS4.p1.1.m1.1.1"><in id="S5.SS4.p1.1.m1.1.1.1.cmml" xref="S5.SS4.p1.1.m1.1.1.1"></in><ci id="S5.SS4.p1.1.m1.1.1.2.cmml" xref="S5.SS4.p1.1.m1.1.1.2">𝑐</ci><apply id="S5.SS4.p1.1.m1.1.1.3.cmml" xref="S5.SS4.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S5.SS4.p1.1.m1.1.1.3.1.cmml" xref="S5.SS4.p1.1.m1.1.1.3">subscript</csymbol><ci id="S5.SS4.p1.1.m1.1.1.3.2.cmml" xref="S5.SS4.p1.1.m1.1.1.3.2">𝒞</ci><ci id="S5.SS4.p1.1.m1.1.1.3.3.cmml" xref="S5.SS4.p1.1.m1.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.1.m1.1c">c\in\mathcal{C}_{n}{}</annotation></semantics></math>, as <math id="S5.SS4.p1.2.m2.2" class="ltx_Math" alttext="|\mathcal{D}_{n}{}|\ll|\mathcal{D}_{b}{}|" display="inline"><semantics id="S5.SS4.p1.2.m2.2a"><mrow id="S5.SS4.p1.2.m2.2.2" xref="S5.SS4.p1.2.m2.2.2.cmml"><mrow id="S5.SS4.p1.2.m2.1.1.1.1" xref="S5.SS4.p1.2.m2.1.1.1.2.cmml"><mo stretchy="false" id="S5.SS4.p1.2.m2.1.1.1.1.2" xref="S5.SS4.p1.2.m2.1.1.1.2.1.cmml">|</mo><msub id="S5.SS4.p1.2.m2.1.1.1.1.1" xref="S5.SS4.p1.2.m2.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS4.p1.2.m2.1.1.1.1.1.2" xref="S5.SS4.p1.2.m2.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S5.SS4.p1.2.m2.1.1.1.1.1.3" xref="S5.SS4.p1.2.m2.1.1.1.1.1.3.cmml">n</mi></msub><mo stretchy="false" id="S5.SS4.p1.2.m2.1.1.1.1.3" xref="S5.SS4.p1.2.m2.1.1.1.2.1.cmml">|</mo></mrow><mo id="S5.SS4.p1.2.m2.2.2.3" xref="S5.SS4.p1.2.m2.2.2.3.cmml">≪</mo><mrow id="S5.SS4.p1.2.m2.2.2.2.1" xref="S5.SS4.p1.2.m2.2.2.2.2.cmml"><mo stretchy="false" id="S5.SS4.p1.2.m2.2.2.2.1.2" xref="S5.SS4.p1.2.m2.2.2.2.2.1.cmml">|</mo><msub id="S5.SS4.p1.2.m2.2.2.2.1.1" xref="S5.SS4.p1.2.m2.2.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS4.p1.2.m2.2.2.2.1.1.2" xref="S5.SS4.p1.2.m2.2.2.2.1.1.2.cmml">𝒟</mi><mi id="S5.SS4.p1.2.m2.2.2.2.1.1.3" xref="S5.SS4.p1.2.m2.2.2.2.1.1.3.cmml">b</mi></msub><mo stretchy="false" id="S5.SS4.p1.2.m2.2.2.2.1.3" xref="S5.SS4.p1.2.m2.2.2.2.2.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.2.m2.2b"><apply id="S5.SS4.p1.2.m2.2.2.cmml" xref="S5.SS4.p1.2.m2.2.2"><csymbol cd="latexml" id="S5.SS4.p1.2.m2.2.2.3.cmml" xref="S5.SS4.p1.2.m2.2.2.3">much-less-than</csymbol><apply id="S5.SS4.p1.2.m2.1.1.1.2.cmml" xref="S5.SS4.p1.2.m2.1.1.1.1"><abs id="S5.SS4.p1.2.m2.1.1.1.2.1.cmml" xref="S5.SS4.p1.2.m2.1.1.1.1.2"></abs><apply id="S5.SS4.p1.2.m2.1.1.1.1.1.cmml" xref="S5.SS4.p1.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.SS4.p1.2.m2.1.1.1.1.1.1.cmml" xref="S5.SS4.p1.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S5.SS4.p1.2.m2.1.1.1.1.1.2.cmml" xref="S5.SS4.p1.2.m2.1.1.1.1.1.2">𝒟</ci><ci id="S5.SS4.p1.2.m2.1.1.1.1.1.3.cmml" xref="S5.SS4.p1.2.m2.1.1.1.1.1.3">𝑛</ci></apply></apply><apply id="S5.SS4.p1.2.m2.2.2.2.2.cmml" xref="S5.SS4.p1.2.m2.2.2.2.1"><abs id="S5.SS4.p1.2.m2.2.2.2.2.1.cmml" xref="S5.SS4.p1.2.m2.2.2.2.1.2"></abs><apply id="S5.SS4.p1.2.m2.2.2.2.1.1.cmml" xref="S5.SS4.p1.2.m2.2.2.2.1.1"><csymbol cd="ambiguous" id="S5.SS4.p1.2.m2.2.2.2.1.1.1.cmml" xref="S5.SS4.p1.2.m2.2.2.2.1.1">subscript</csymbol><ci id="S5.SS4.p1.2.m2.2.2.2.1.1.2.cmml" xref="S5.SS4.p1.2.m2.2.2.2.1.1.2">𝒟</ci><ci id="S5.SS4.p1.2.m2.2.2.2.1.1.3.cmml" xref="S5.SS4.p1.2.m2.2.2.2.1.1.3">𝑏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.2.m2.2c">|\mathcal{D}_{n}{}|\ll|\mathcal{D}_{b}{}|</annotation></semantics></math>, the mean of the its features is still distant from the assigned weights. However, our Prior baseline clearly push the features to the assigned weights to facilitate the novel detection.
Similarly, in Table <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:tab:ablation</span>, only using the ETF classifier can introduce limited gain (Row<sub id="S5.SS4.p1.6.1" class="ltx_sub"><span id="S5.SS4.p1.6.1.1" class="ltx_text ltx_font_italic">{1,2}</span></sub>). Though the ETF classifier with dot-regression loss has been used for long-tail classification <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib61" title="" class="ltx_ref">61</a>, <a href="#bib.bib60" title="" class="ltx_ref">60</a>]</cite>, we note the efficiency in dealing with hugely imbalanced datasets is limited. By adding margins to tighten each cluster and/or up-sampling novel instances in RFS to ensure that sufficient features of <math id="S5.SS4.p1.4.m4.1" class="ltx_Math" alttext="\mathcal{C}_{n}{}" display="inline"><semantics id="S5.SS4.p1.4.m4.1a"><msub id="S5.SS4.p1.4.m4.1.1" xref="S5.SS4.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS4.p1.4.m4.1.1.2" xref="S5.SS4.p1.4.m4.1.1.2.cmml">𝒞</mi><mi id="S5.SS4.p1.4.m4.1.1.3" xref="S5.SS4.p1.4.m4.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.4.m4.1b"><apply id="S5.SS4.p1.4.m4.1.1.cmml" xref="S5.SS4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS4.p1.4.m4.1.1.1.cmml" xref="S5.SS4.p1.4.m4.1.1">subscript</csymbol><ci id="S5.SS4.p1.4.m4.1.1.2.cmml" xref="S5.SS4.p1.4.m4.1.1.2">𝒞</ci><ci id="S5.SS4.p1.4.m4.1.1.3.cmml" xref="S5.SS4.p1.4.m4.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.4.m4.1c">\mathcal{C}_{n}{}</annotation></semantics></math> are used for training, the nAP<sub id="S5.SS4.p1.6.2" class="ltx_sub"><span id="S5.SS4.p1.6.2.1" class="ltx_text ltx_font_italic">50</span></sub> can then be improved (Row<sub id="S5.SS4.p1.6.3" class="ltx_sub"><span id="S5.SS4.p1.6.3.1" class="ltx_text ltx_font_italic">{2,5,6,7}</span></sub>).</p>
</div>
<figure id="S5.F5" class="ltx_figure"><img src="/html/2303.09674/assets/x5.png" id="S5.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="122" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F5.6.3.1" class="ltx_text" style="font-size:90%;">Figure 5</span>: </span><span id="S5.F5.4.2" class="ltx_text" style="font-size:90%;">With a detector trained on the <math id="S5.F5.3.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{b}{}\cup\mathcal{D}_{n}{}" display="inline"><semantics id="S5.F5.3.1.m1.1b"><mrow id="S5.F5.3.1.m1.1.1" xref="S5.F5.3.1.m1.1.1.cmml"><msub id="S5.F5.3.1.m1.1.1.2" xref="S5.F5.3.1.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.F5.3.1.m1.1.1.2.2" xref="S5.F5.3.1.m1.1.1.2.2.cmml">𝒟</mi><mi id="S5.F5.3.1.m1.1.1.2.3" xref="S5.F5.3.1.m1.1.1.2.3.cmml">b</mi></msub><mo id="S5.F5.3.1.m1.1.1.1" xref="S5.F5.3.1.m1.1.1.1.cmml">∪</mo><msub id="S5.F5.3.1.m1.1.1.3" xref="S5.F5.3.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.F5.3.1.m1.1.1.3.2" xref="S5.F5.3.1.m1.1.1.3.2.cmml">𝒟</mi><mi id="S5.F5.3.1.m1.1.1.3.3" xref="S5.F5.3.1.m1.1.1.3.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S5.F5.3.1.m1.1c"><apply id="S5.F5.3.1.m1.1.1.cmml" xref="S5.F5.3.1.m1.1.1"><union id="S5.F5.3.1.m1.1.1.1.cmml" xref="S5.F5.3.1.m1.1.1.1"></union><apply id="S5.F5.3.1.m1.1.1.2.cmml" xref="S5.F5.3.1.m1.1.1.2"><csymbol cd="ambiguous" id="S5.F5.3.1.m1.1.1.2.1.cmml" xref="S5.F5.3.1.m1.1.1.2">subscript</csymbol><ci id="S5.F5.3.1.m1.1.1.2.2.cmml" xref="S5.F5.3.1.m1.1.1.2.2">𝒟</ci><ci id="S5.F5.3.1.m1.1.1.2.3.cmml" xref="S5.F5.3.1.m1.1.1.2.3">𝑏</ci></apply><apply id="S5.F5.3.1.m1.1.1.3.cmml" xref="S5.F5.3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S5.F5.3.1.m1.1.1.3.1.cmml" xref="S5.F5.3.1.m1.1.1.3">subscript</csymbol><ci id="S5.F5.3.1.m1.1.1.3.2.cmml" xref="S5.F5.3.1.m1.1.1.3.2">𝒟</ci><ci id="S5.F5.3.1.m1.1.1.3.3.cmml" xref="S5.F5.3.1.m1.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F5.3.1.m1.1d">\mathcal{D}_{b}{}\cup\mathcal{D}_{n}{}</annotation></semantics></math> with vanilla <math id="S5.F5.4.2.m2.1" class="ltx_Math" alttext="\mathcal{L}_{CE}" display="inline"><semantics id="S5.F5.4.2.m2.1b"><msub id="S5.F5.4.2.m2.1.1" xref="S5.F5.4.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.F5.4.2.m2.1.1.2" xref="S5.F5.4.2.m2.1.1.2.cmml">ℒ</mi><mrow id="S5.F5.4.2.m2.1.1.3" xref="S5.F5.4.2.m2.1.1.3.cmml"><mi id="S5.F5.4.2.m2.1.1.3.2" xref="S5.F5.4.2.m2.1.1.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S5.F5.4.2.m2.1.1.3.1" xref="S5.F5.4.2.m2.1.1.3.1.cmml">​</mo><mi id="S5.F5.4.2.m2.1.1.3.3" xref="S5.F5.4.2.m2.1.1.3.3.cmml">E</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.F5.4.2.m2.1c"><apply id="S5.F5.4.2.m2.1.1.cmml" xref="S5.F5.4.2.m2.1.1"><csymbol cd="ambiguous" id="S5.F5.4.2.m2.1.1.1.cmml" xref="S5.F5.4.2.m2.1.1">subscript</csymbol><ci id="S5.F5.4.2.m2.1.1.2.cmml" xref="S5.F5.4.2.m2.1.1.2">ℒ</ci><apply id="S5.F5.4.2.m2.1.1.3.cmml" xref="S5.F5.4.2.m2.1.1.3"><times id="S5.F5.4.2.m2.1.1.3.1.cmml" xref="S5.F5.4.2.m2.1.1.3.1"></times><ci id="S5.F5.4.2.m2.1.1.3.2.cmml" xref="S5.F5.4.2.m2.1.1.3.2">𝐶</ci><ci id="S5.F5.4.2.m2.1.1.3.3.cmml" xref="S5.F5.4.2.m2.1.1.3.3">𝐸</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F5.4.2.m2.1d">\mathcal{L}_{CE}</annotation></semantics></math>. For each class, we calculate the mean of a) the number of proposals per instance and b) classification confidence score where the number of annotations per class is plotted for reference.</span></figcaption>
</figure>
<div id="S5.SS4.p2" class="ltx_para ltx_noindent">
<p id="S5.SS4.p2.6" class="ltx_p"><span id="S5.SS4.p2.6.1" class="ltx_text ltx_font_bold">Obtaining effective margins</span> is essential to train on an extremely imbalanced dataset. As discussed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>, the margins to be added should meet conditions such as <span id="S5.SS4.p2.6.2" class="ltx_text ltx_font_italic">Fisher consistency</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> to balance the error among different classes.
As <math id="S5.SS4.p2.1.m1.2" class="ltx_Math" alttext="|\mathcal{D}_{n}{}|\ll|\mathcal{D}_{b}{}|" display="inline"><semantics id="S5.SS4.p2.1.m1.2a"><mrow id="S5.SS4.p2.1.m1.2.2" xref="S5.SS4.p2.1.m1.2.2.cmml"><mrow id="S5.SS4.p2.1.m1.1.1.1.1" xref="S5.SS4.p2.1.m1.1.1.1.2.cmml"><mo stretchy="false" id="S5.SS4.p2.1.m1.1.1.1.1.2" xref="S5.SS4.p2.1.m1.1.1.1.2.1.cmml">|</mo><msub id="S5.SS4.p2.1.m1.1.1.1.1.1" xref="S5.SS4.p2.1.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS4.p2.1.m1.1.1.1.1.1.2" xref="S5.SS4.p2.1.m1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S5.SS4.p2.1.m1.1.1.1.1.1.3" xref="S5.SS4.p2.1.m1.1.1.1.1.1.3.cmml">n</mi></msub><mo stretchy="false" id="S5.SS4.p2.1.m1.1.1.1.1.3" xref="S5.SS4.p2.1.m1.1.1.1.2.1.cmml">|</mo></mrow><mo id="S5.SS4.p2.1.m1.2.2.3" xref="S5.SS4.p2.1.m1.2.2.3.cmml">≪</mo><mrow id="S5.SS4.p2.1.m1.2.2.2.1" xref="S5.SS4.p2.1.m1.2.2.2.2.cmml"><mo stretchy="false" id="S5.SS4.p2.1.m1.2.2.2.1.2" xref="S5.SS4.p2.1.m1.2.2.2.2.1.cmml">|</mo><msub id="S5.SS4.p2.1.m1.2.2.2.1.1" xref="S5.SS4.p2.1.m1.2.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS4.p2.1.m1.2.2.2.1.1.2" xref="S5.SS4.p2.1.m1.2.2.2.1.1.2.cmml">𝒟</mi><mi id="S5.SS4.p2.1.m1.2.2.2.1.1.3" xref="S5.SS4.p2.1.m1.2.2.2.1.1.3.cmml">b</mi></msub><mo stretchy="false" id="S5.SS4.p2.1.m1.2.2.2.1.3" xref="S5.SS4.p2.1.m1.2.2.2.2.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p2.1.m1.2b"><apply id="S5.SS4.p2.1.m1.2.2.cmml" xref="S5.SS4.p2.1.m1.2.2"><csymbol cd="latexml" id="S5.SS4.p2.1.m1.2.2.3.cmml" xref="S5.SS4.p2.1.m1.2.2.3">much-less-than</csymbol><apply id="S5.SS4.p2.1.m1.1.1.1.2.cmml" xref="S5.SS4.p2.1.m1.1.1.1.1"><abs id="S5.SS4.p2.1.m1.1.1.1.2.1.cmml" xref="S5.SS4.p2.1.m1.1.1.1.1.2"></abs><apply id="S5.SS4.p2.1.m1.1.1.1.1.1.cmml" xref="S5.SS4.p2.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.SS4.p2.1.m1.1.1.1.1.1.1.cmml" xref="S5.SS4.p2.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S5.SS4.p2.1.m1.1.1.1.1.1.2.cmml" xref="S5.SS4.p2.1.m1.1.1.1.1.1.2">𝒟</ci><ci id="S5.SS4.p2.1.m1.1.1.1.1.1.3.cmml" xref="S5.SS4.p2.1.m1.1.1.1.1.1.3">𝑛</ci></apply></apply><apply id="S5.SS4.p2.1.m1.2.2.2.2.cmml" xref="S5.SS4.p2.1.m1.2.2.2.1"><abs id="S5.SS4.p2.1.m1.2.2.2.2.1.cmml" xref="S5.SS4.p2.1.m1.2.2.2.1.2"></abs><apply id="S5.SS4.p2.1.m1.2.2.2.1.1.cmml" xref="S5.SS4.p2.1.m1.2.2.2.1.1"><csymbol cd="ambiguous" id="S5.SS4.p2.1.m1.2.2.2.1.1.1.cmml" xref="S5.SS4.p2.1.m1.2.2.2.1.1">subscript</csymbol><ci id="S5.SS4.p2.1.m1.2.2.2.1.1.2.cmml" xref="S5.SS4.p2.1.m1.2.2.2.1.1.2">𝒟</ci><ci id="S5.SS4.p2.1.m1.2.2.2.1.1.3.cmml" xref="S5.SS4.p2.1.m1.2.2.2.1.1.3">𝑏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p2.1.m1.2c">|\mathcal{D}_{n}{}|\ll|\mathcal{D}_{b}{}|</annotation></semantics></math>, directly learning the margins for each class individually from scratch (Table <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:tab:margin</span> Row<sub id="S5.SS4.p2.6.3" class="ltx_sub"><span id="S5.SS4.p2.6.3.1" class="ltx_text ltx_font_italic">{1}</span></sub>) is difficult and may suffer from training instability such as gradient explosion. By sharing margins for classes in the same group, <em id="S5.SS4.p2.6.4" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S5.SS4.p2.6.5" class="ltx_text"></span>, <math id="S5.SS4.p2.3.m3.1" class="ltx_Math" alttext="\mathcal{C}_{b}{}" display="inline"><semantics id="S5.SS4.p2.3.m3.1a"><msub id="S5.SS4.p2.3.m3.1.1" xref="S5.SS4.p2.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS4.p2.3.m3.1.1.2" xref="S5.SS4.p2.3.m3.1.1.2.cmml">𝒞</mi><mi id="S5.SS4.p2.3.m3.1.1.3" xref="S5.SS4.p2.3.m3.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p2.3.m3.1b"><apply id="S5.SS4.p2.3.m3.1.1.cmml" xref="S5.SS4.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS4.p2.3.m3.1.1.1.cmml" xref="S5.SS4.p2.3.m3.1.1">subscript</csymbol><ci id="S5.SS4.p2.3.m3.1.1.2.cmml" xref="S5.SS4.p2.3.m3.1.1.2">𝒞</ci><ci id="S5.SS4.p2.3.m3.1.1.3.cmml" xref="S5.SS4.p2.3.m3.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p2.3.m3.1c">\mathcal{C}_{b}{}</annotation></semantics></math>, <math id="S5.SS4.p2.4.m4.1" class="ltx_Math" alttext="\mathcal{C}_{n}{}" display="inline"><semantics id="S5.SS4.p2.4.m4.1a"><msub id="S5.SS4.p2.4.m4.1.1" xref="S5.SS4.p2.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS4.p2.4.m4.1.1.2" xref="S5.SS4.p2.4.m4.1.1.2.cmml">𝒞</mi><mi id="S5.SS4.p2.4.m4.1.1.3" xref="S5.SS4.p2.4.m4.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p2.4.m4.1b"><apply id="S5.SS4.p2.4.m4.1.1.cmml" xref="S5.SS4.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS4.p2.4.m4.1.1.1.cmml" xref="S5.SS4.p2.4.m4.1.1">subscript</csymbol><ci id="S5.SS4.p2.4.m4.1.1.2.cmml" xref="S5.SS4.p2.4.m4.1.1.2">𝒞</ci><ci id="S5.SS4.p2.4.m4.1.1.3.cmml" xref="S5.SS4.p2.4.m4.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p2.4.m4.1c">\mathcal{C}_{n}{}</annotation></semantics></math>, and <math id="S5.SS4.p2.5.m5.1" class="ltx_Math" alttext="c_{-}{}" display="inline"><semantics id="S5.SS4.p2.5.m5.1a"><msub id="S5.SS4.p2.5.m5.1.1" xref="S5.SS4.p2.5.m5.1.1.cmml"><mi id="S5.SS4.p2.5.m5.1.1.2" xref="S5.SS4.p2.5.m5.1.1.2.cmml">c</mi><mo id="S5.SS4.p2.5.m5.1.1.3" xref="S5.SS4.p2.5.m5.1.1.3.cmml">−</mo></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p2.5.m5.1b"><apply id="S5.SS4.p2.5.m5.1.1.cmml" xref="S5.SS4.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S5.SS4.p2.5.m5.1.1.1.cmml" xref="S5.SS4.p2.5.m5.1.1">subscript</csymbol><ci id="S5.SS4.p2.5.m5.1.1.2.cmml" xref="S5.SS4.p2.5.m5.1.1.2">𝑐</ci><minus id="S5.SS4.p2.5.m5.1.1.3.cmml" xref="S5.SS4.p2.5.m5.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p2.5.m5.1c">c_{-}{}</annotation></semantics></math>, the nAP<sub id="S5.SS4.p2.6.6" class="ltx_sub"><span id="S5.SS4.p2.6.6.1" class="ltx_text ltx_font_italic">50</span></sub> can be improved slightly.</p>
</div>
<div id="S5.SS4.p3" class="ltx_para">
<p id="S5.SS4.p3.8" class="ltx_p">As summarized in Fig. <a href="#S5.F5" title="Figure 5 ‣ 5.4 Analysis of Intra-Class Compactness ‣ 5 Experiment ‣ DiGeo: Discriminative Geometry-Aware Learning for Generalized Few-Shot Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, for each class, the number of proposals used to train the detection module ranges from 11 to 17 per instance on average. As such, using the prior of instance distribution <math id="S5.SS4.p3.1.m1.1" class="ltx_Math" alttext="\{p_{c}\}_{c\in\mathcal{C}_{b}{}\cup\mathcal{C}_{n}{}}" display="inline"><semantics id="S5.SS4.p3.1.m1.1a"><msub id="S5.SS4.p3.1.m1.1.1" xref="S5.SS4.p3.1.m1.1.1.cmml"><mrow id="S5.SS4.p3.1.m1.1.1.1.1" xref="S5.SS4.p3.1.m1.1.1.1.2.cmml"><mo stretchy="false" id="S5.SS4.p3.1.m1.1.1.1.1.2" xref="S5.SS4.p3.1.m1.1.1.1.2.cmml">{</mo><msub id="S5.SS4.p3.1.m1.1.1.1.1.1" xref="S5.SS4.p3.1.m1.1.1.1.1.1.cmml"><mi id="S5.SS4.p3.1.m1.1.1.1.1.1.2" xref="S5.SS4.p3.1.m1.1.1.1.1.1.2.cmml">p</mi><mi id="S5.SS4.p3.1.m1.1.1.1.1.1.3" xref="S5.SS4.p3.1.m1.1.1.1.1.1.3.cmml">c</mi></msub><mo stretchy="false" id="S5.SS4.p3.1.m1.1.1.1.1.3" xref="S5.SS4.p3.1.m1.1.1.1.2.cmml">}</mo></mrow><mrow id="S5.SS4.p3.1.m1.1.1.3" xref="S5.SS4.p3.1.m1.1.1.3.cmml"><mi id="S5.SS4.p3.1.m1.1.1.3.2" xref="S5.SS4.p3.1.m1.1.1.3.2.cmml">c</mi><mo id="S5.SS4.p3.1.m1.1.1.3.1" xref="S5.SS4.p3.1.m1.1.1.3.1.cmml">∈</mo><mrow id="S5.SS4.p3.1.m1.1.1.3.3" xref="S5.SS4.p3.1.m1.1.1.3.3.cmml"><msub id="S5.SS4.p3.1.m1.1.1.3.3.2" xref="S5.SS4.p3.1.m1.1.1.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS4.p3.1.m1.1.1.3.3.2.2" xref="S5.SS4.p3.1.m1.1.1.3.3.2.2.cmml">𝒞</mi><mi id="S5.SS4.p3.1.m1.1.1.3.3.2.3" xref="S5.SS4.p3.1.m1.1.1.3.3.2.3.cmml">b</mi></msub><mo id="S5.SS4.p3.1.m1.1.1.3.3.1" xref="S5.SS4.p3.1.m1.1.1.3.3.1.cmml">∪</mo><msub id="S5.SS4.p3.1.m1.1.1.3.3.3" xref="S5.SS4.p3.1.m1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS4.p3.1.m1.1.1.3.3.3.2" xref="S5.SS4.p3.1.m1.1.1.3.3.3.2.cmml">𝒞</mi><mi id="S5.SS4.p3.1.m1.1.1.3.3.3.3" xref="S5.SS4.p3.1.m1.1.1.3.3.3.3.cmml">n</mi></msub></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p3.1.m1.1b"><apply id="S5.SS4.p3.1.m1.1.1.cmml" xref="S5.SS4.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS4.p3.1.m1.1.1.2.cmml" xref="S5.SS4.p3.1.m1.1.1">subscript</csymbol><set id="S5.SS4.p3.1.m1.1.1.1.2.cmml" xref="S5.SS4.p3.1.m1.1.1.1.1"><apply id="S5.SS4.p3.1.m1.1.1.1.1.1.cmml" xref="S5.SS4.p3.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.SS4.p3.1.m1.1.1.1.1.1.1.cmml" xref="S5.SS4.p3.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S5.SS4.p3.1.m1.1.1.1.1.1.2.cmml" xref="S5.SS4.p3.1.m1.1.1.1.1.1.2">𝑝</ci><ci id="S5.SS4.p3.1.m1.1.1.1.1.1.3.cmml" xref="S5.SS4.p3.1.m1.1.1.1.1.1.3">𝑐</ci></apply></set><apply id="S5.SS4.p3.1.m1.1.1.3.cmml" xref="S5.SS4.p3.1.m1.1.1.3"><in id="S5.SS4.p3.1.m1.1.1.3.1.cmml" xref="S5.SS4.p3.1.m1.1.1.3.1"></in><ci id="S5.SS4.p3.1.m1.1.1.3.2.cmml" xref="S5.SS4.p3.1.m1.1.1.3.2">𝑐</ci><apply id="S5.SS4.p3.1.m1.1.1.3.3.cmml" xref="S5.SS4.p3.1.m1.1.1.3.3"><union id="S5.SS4.p3.1.m1.1.1.3.3.1.cmml" xref="S5.SS4.p3.1.m1.1.1.3.3.1"></union><apply id="S5.SS4.p3.1.m1.1.1.3.3.2.cmml" xref="S5.SS4.p3.1.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S5.SS4.p3.1.m1.1.1.3.3.2.1.cmml" xref="S5.SS4.p3.1.m1.1.1.3.3.2">subscript</csymbol><ci id="S5.SS4.p3.1.m1.1.1.3.3.2.2.cmml" xref="S5.SS4.p3.1.m1.1.1.3.3.2.2">𝒞</ci><ci id="S5.SS4.p3.1.m1.1.1.3.3.2.3.cmml" xref="S5.SS4.p3.1.m1.1.1.3.3.2.3">𝑏</ci></apply><apply id="S5.SS4.p3.1.m1.1.1.3.3.3.cmml" xref="S5.SS4.p3.1.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S5.SS4.p3.1.m1.1.1.3.3.3.1.cmml" xref="S5.SS4.p3.1.m1.1.1.3.3.3">subscript</csymbol><ci id="S5.SS4.p3.1.m1.1.1.3.3.3.2.cmml" xref="S5.SS4.p3.1.m1.1.1.3.3.3.2">𝒞</ci><ci id="S5.SS4.p3.1.m1.1.1.3.3.3.3.cmml" xref="S5.SS4.p3.1.m1.1.1.3.3.3.3">𝑛</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p3.1.m1.1c">\{p_{c}\}_{c\in\mathcal{C}_{b}{}\cup\mathcal{C}_{n}{}}</annotation></semantics></math> can help estimate good margins (Prior). However, as the number of proposals for <math id="S5.SS4.p3.2.m2.1" class="ltx_Math" alttext="\mathcal{C}_{n}{}" display="inline"><semantics id="S5.SS4.p3.2.m2.1a"><msub id="S5.SS4.p3.2.m2.1.1" xref="S5.SS4.p3.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS4.p3.2.m2.1.1.2" xref="S5.SS4.p3.2.m2.1.1.2.cmml">𝒞</mi><mi id="S5.SS4.p3.2.m2.1.1.3" xref="S5.SS4.p3.2.m2.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p3.2.m2.1b"><apply id="S5.SS4.p3.2.m2.1.1.cmml" xref="S5.SS4.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS4.p3.2.m2.1.1.1.cmml" xref="S5.SS4.p3.2.m2.1.1">subscript</csymbol><ci id="S5.SS4.p3.2.m2.1.1.2.cmml" xref="S5.SS4.p3.2.m2.1.1.2">𝒞</ci><ci id="S5.SS4.p3.2.m2.1.1.3.cmml" xref="S5.SS4.p3.2.m2.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p3.2.m2.1c">\mathcal{C}_{n}{}</annotation></semantics></math> (11<math id="S5.SS4.p3.3.m3.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S5.SS4.p3.3.m3.1a"><mo id="S5.SS4.p3.3.m3.1.1" xref="S5.SS4.p3.3.m3.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S5.SS4.p3.3.m3.1b"><csymbol cd="latexml" id="S5.SS4.p3.3.m3.1.1.cmml" xref="S5.SS4.p3.3.m3.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p3.3.m3.1c">\sim</annotation></semantics></math>14) is still slightly less than that of <math id="S5.SS4.p3.4.m4.1" class="ltx_Math" alttext="\mathcal{C}_{b}{}" display="inline"><semantics id="S5.SS4.p3.4.m4.1a"><msub id="S5.SS4.p3.4.m4.1.1" xref="S5.SS4.p3.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS4.p3.4.m4.1.1.2" xref="S5.SS4.p3.4.m4.1.1.2.cmml">𝒞</mi><mi id="S5.SS4.p3.4.m4.1.1.3" xref="S5.SS4.p3.4.m4.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p3.4.m4.1b"><apply id="S5.SS4.p3.4.m4.1.1.cmml" xref="S5.SS4.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS4.p3.4.m4.1.1.1.cmml" xref="S5.SS4.p3.4.m4.1.1">subscript</csymbol><ci id="S5.SS4.p3.4.m4.1.1.2.cmml" xref="S5.SS4.p3.4.m4.1.1.2">𝒞</ci><ci id="S5.SS4.p3.4.m4.1.1.3.cmml" xref="S5.SS4.p3.4.m4.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p3.4.m4.1c">\mathcal{C}_{b}{}</annotation></semantics></math> (13<math id="S5.SS4.p3.5.m5.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S5.SS4.p3.5.m5.1a"><mo id="S5.SS4.p3.5.m5.1.1" xref="S5.SS4.p3.5.m5.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S5.SS4.p3.5.m5.1b"><csymbol cd="latexml" id="S5.SS4.p3.5.m5.1.1.cmml" xref="S5.SS4.p3.5.m5.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p3.5.m5.1c">\sim</annotation></semantics></math>17) and the margin <math id="S5.SS4.p3.6.m6.1" class="ltx_Math" alttext="m_{c_{-}{}}" display="inline"><semantics id="S5.SS4.p3.6.m6.1a"><msub id="S5.SS4.p3.6.m6.1.1" xref="S5.SS4.p3.6.m6.1.1.cmml"><mi id="S5.SS4.p3.6.m6.1.1.2" xref="S5.SS4.p3.6.m6.1.1.2.cmml">m</mi><msub id="S5.SS4.p3.6.m6.1.1.3" xref="S5.SS4.p3.6.m6.1.1.3.cmml"><mi id="S5.SS4.p3.6.m6.1.1.3.2" xref="S5.SS4.p3.6.m6.1.1.3.2.cmml">c</mi><mo id="S5.SS4.p3.6.m6.1.1.3.3" xref="S5.SS4.p3.6.m6.1.1.3.3.cmml">−</mo></msub></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p3.6.m6.1b"><apply id="S5.SS4.p3.6.m6.1.1.cmml" xref="S5.SS4.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S5.SS4.p3.6.m6.1.1.1.cmml" xref="S5.SS4.p3.6.m6.1.1">subscript</csymbol><ci id="S5.SS4.p3.6.m6.1.1.2.cmml" xref="S5.SS4.p3.6.m6.1.1.2">𝑚</ci><apply id="S5.SS4.p3.6.m6.1.1.3.cmml" xref="S5.SS4.p3.6.m6.1.1.3"><csymbol cd="ambiguous" id="S5.SS4.p3.6.m6.1.1.3.1.cmml" xref="S5.SS4.p3.6.m6.1.1.3">subscript</csymbol><ci id="S5.SS4.p3.6.m6.1.1.3.2.cmml" xref="S5.SS4.p3.6.m6.1.1.3.2">𝑐</ci><minus id="S5.SS4.p3.6.m6.1.1.3.3.cmml" xref="S5.SS4.p3.6.m6.1.1.3.3"></minus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p3.6.m6.1c">m_{c_{-}{}}</annotation></semantics></math> for <math id="S5.SS4.p3.7.m7.1" class="ltx_Math" alttext="c_{-}{}" display="inline"><semantics id="S5.SS4.p3.7.m7.1a"><msub id="S5.SS4.p3.7.m7.1.1" xref="S5.SS4.p3.7.m7.1.1.cmml"><mi id="S5.SS4.p3.7.m7.1.1.2" xref="S5.SS4.p3.7.m7.1.1.2.cmml">c</mi><mo id="S5.SS4.p3.7.m7.1.1.3" xref="S5.SS4.p3.7.m7.1.1.3.cmml">−</mo></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p3.7.m7.1b"><apply id="S5.SS4.p3.7.m7.1.1.cmml" xref="S5.SS4.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S5.SS4.p3.7.m7.1.1.1.cmml" xref="S5.SS4.p3.7.m7.1.1">subscript</csymbol><ci id="S5.SS4.p3.7.m7.1.1.2.cmml" xref="S5.SS4.p3.7.m7.1.1.2">𝑐</ci><minus id="S5.SS4.p3.7.m7.1.1.3.cmml" xref="S5.SS4.p3.7.m7.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p3.7.m7.1c">c_{-}{}</annotation></semantics></math> is roughly estimated, it is still necessary to learn margins adaptively. As no stronger prior knowledge can be used, directly learning the margins initialized by <math id="S5.SS4.p3.8.m8.2" class="ltx_Math" alttext="\{-\log(p_{c})\}" display="inline"><semantics id="S5.SS4.p3.8.m8.2a"><mrow id="S5.SS4.p3.8.m8.2.2.1" xref="S5.SS4.p3.8.m8.2.2.2.cmml"><mo stretchy="false" id="S5.SS4.p3.8.m8.2.2.1.2" xref="S5.SS4.p3.8.m8.2.2.2.cmml">{</mo><mrow id="S5.SS4.p3.8.m8.2.2.1.1" xref="S5.SS4.p3.8.m8.2.2.1.1.cmml"><mo rspace="0.167em" id="S5.SS4.p3.8.m8.2.2.1.1a" xref="S5.SS4.p3.8.m8.2.2.1.1.cmml">−</mo><mrow id="S5.SS4.p3.8.m8.2.2.1.1.1.1" xref="S5.SS4.p3.8.m8.2.2.1.1.1.2.cmml"><mi id="S5.SS4.p3.8.m8.1.1" xref="S5.SS4.p3.8.m8.1.1.cmml">log</mi><mo id="S5.SS4.p3.8.m8.2.2.1.1.1.1a" xref="S5.SS4.p3.8.m8.2.2.1.1.1.2.cmml">⁡</mo><mrow id="S5.SS4.p3.8.m8.2.2.1.1.1.1.1" xref="S5.SS4.p3.8.m8.2.2.1.1.1.2.cmml"><mo stretchy="false" id="S5.SS4.p3.8.m8.2.2.1.1.1.1.1.2" xref="S5.SS4.p3.8.m8.2.2.1.1.1.2.cmml">(</mo><msub id="S5.SS4.p3.8.m8.2.2.1.1.1.1.1.1" xref="S5.SS4.p3.8.m8.2.2.1.1.1.1.1.1.cmml"><mi id="S5.SS4.p3.8.m8.2.2.1.1.1.1.1.1.2" xref="S5.SS4.p3.8.m8.2.2.1.1.1.1.1.1.2.cmml">p</mi><mi id="S5.SS4.p3.8.m8.2.2.1.1.1.1.1.1.3" xref="S5.SS4.p3.8.m8.2.2.1.1.1.1.1.1.3.cmml">c</mi></msub><mo stretchy="false" id="S5.SS4.p3.8.m8.2.2.1.1.1.1.1.3" xref="S5.SS4.p3.8.m8.2.2.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S5.SS4.p3.8.m8.2.2.1.3" xref="S5.SS4.p3.8.m8.2.2.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p3.8.m8.2b"><set id="S5.SS4.p3.8.m8.2.2.2.cmml" xref="S5.SS4.p3.8.m8.2.2.1"><apply id="S5.SS4.p3.8.m8.2.2.1.1.cmml" xref="S5.SS4.p3.8.m8.2.2.1.1"><minus id="S5.SS4.p3.8.m8.2.2.1.1.2.cmml" xref="S5.SS4.p3.8.m8.2.2.1.1"></minus><apply id="S5.SS4.p3.8.m8.2.2.1.1.1.2.cmml" xref="S5.SS4.p3.8.m8.2.2.1.1.1.1"><log id="S5.SS4.p3.8.m8.1.1.cmml" xref="S5.SS4.p3.8.m8.1.1"></log><apply id="S5.SS4.p3.8.m8.2.2.1.1.1.1.1.1.cmml" xref="S5.SS4.p3.8.m8.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.SS4.p3.8.m8.2.2.1.1.1.1.1.1.1.cmml" xref="S5.SS4.p3.8.m8.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S5.SS4.p3.8.m8.2.2.1.1.1.1.1.1.2.cmml" xref="S5.SS4.p3.8.m8.2.2.1.1.1.1.1.1.2">𝑝</ci><ci id="S5.SS4.p3.8.m8.2.2.1.1.1.1.1.1.3.cmml" xref="S5.SS4.p3.8.m8.2.2.1.1.1.1.1.1.3">𝑐</ci></apply></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p3.8.m8.2c">\{-\log(p_{c})\}</annotation></semantics></math> does not help clearly (Prior+). However, through self-distillation, the logits output by pretrained Prior baseline model can be used to indicate the relationship between the proposals features and all class centers, which is then used as supervision signal in our DiGeo.</p>
</div>
</section>
<section id="S5.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.5 </span>Extension to Long-tailed Object Detection</h3>

<div id="S5.SS5.p1" class="ltx_para">
<p id="S5.SS5.p1.1" class="ltx_p">As compared in Table <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:tab:lvis</span>, we use TFA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib55" title="" class="ltx_ref">55</a>]</cite> and ACSL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib54" title="" class="ltx_ref">54</a>]</cite> as two baselines. By employing our design, our DiGeo can achieve higher detection precision on both cases. For comparison with ACSL, we follow the training procedure in ACSL and our approach can benefit from the prior of data distribution to learn discriminative features.
More detailed explanation &amp; results can be found in Supp.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">In this paper, we revisit generalized few-shot object detection from a perspective of discriminative feature learning. We further proposed a simple but effective framework, Discriminative Geometry-aware (DiGeo) learning, for inter-class separation and intra-class compactness. Experiments demonstrates that our DiGeo improves generalization on novel classes without hurting the detection of base classes, and can be extended to long-tail object detection. In the future, we will keep investigating the desired properties of features in object detection and adapted it more realistic scenarios such as domain adaptation.</p>
</div>
<div id="S6.p2" class="ltx_para ltx_noindent">
<p id="S6.p2.1" class="ltx_p"><span id="S6.p2.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Acknowledgement</span><span id="S6.p2.1.2" class="ltx_text" style="font-size:90%;"> This material is based on research sponsored by Air Force Research Laboratory (AFRL) under agreement number FA8750-19-1-1000.
The U.S. Government is authorized to reproduce and distribute reprints for Government purposes notwithstanding any copyright notation therein.
The views and conclusions contained herein are those of the authors and should not be interpreted as necessarily representing the official policies or endorsements, either expressed or implied, of Air Force Laboratory, DARPA or the U.S. Government.

</span><span id="S6.p2.1.3" class="ltx_text"></span></p>
</div>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Approach</h2>

<section id="S7.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.1 </span>Simplex ETF &amp; Neural Collapse</h3>

<div id="S7.SS1.p1" class="ltx_para">
<p id="S7.SS1.p1.6" class="ltx_p">The neural collapse (NC) phenomenon is revealed by <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite> in the fully-supervised learning, <em id="S7.SS1.p1.6.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S7.SS1.p1.6.2" class="ltx_text"></span>, an extremely simple mathematical structure on the last-layer features.
In particular, when the model is well-trained on a balanced dataset, the <math id="S7.SS1.p1.1.m1.1" class="ltx_Math" alttext="N_{f}" display="inline"><semantics id="S7.SS1.p1.1.m1.1a"><msub id="S7.SS1.p1.1.m1.1.1" xref="S7.SS1.p1.1.m1.1.1.cmml"><mi id="S7.SS1.p1.1.m1.1.1.2" xref="S7.SS1.p1.1.m1.1.1.2.cmml">N</mi><mi id="S7.SS1.p1.1.m1.1.1.3" xref="S7.SS1.p1.1.m1.1.1.3.cmml">f</mi></msub><annotation-xml encoding="MathML-Content" id="S7.SS1.p1.1.m1.1b"><apply id="S7.SS1.p1.1.m1.1.1.cmml" xref="S7.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S7.SS1.p1.1.m1.1.1.1.cmml" xref="S7.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S7.SS1.p1.1.m1.1.1.2.cmml" xref="S7.SS1.p1.1.m1.1.1.2">𝑁</ci><ci id="S7.SS1.p1.1.m1.1.1.3.cmml" xref="S7.SS1.p1.1.m1.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p1.1.m1.1c">N_{f}</annotation></semantics></math> features <math id="S7.SS1.p1.2.m2.3" class="ltx_Math" alttext="\{\mathbf{x}_{c,i}\}_{i=1}^{N_{f}}" display="inline"><semantics id="S7.SS1.p1.2.m2.3a"><msubsup id="S7.SS1.p1.2.m2.3.3" xref="S7.SS1.p1.2.m2.3.3.cmml"><mrow id="S7.SS1.p1.2.m2.3.3.1.1.1" xref="S7.SS1.p1.2.m2.3.3.1.1.2.cmml"><mo stretchy="false" id="S7.SS1.p1.2.m2.3.3.1.1.1.2" xref="S7.SS1.p1.2.m2.3.3.1.1.2.cmml">{</mo><msub id="S7.SS1.p1.2.m2.3.3.1.1.1.1" xref="S7.SS1.p1.2.m2.3.3.1.1.1.1.cmml"><mi id="S7.SS1.p1.2.m2.3.3.1.1.1.1.2" xref="S7.SS1.p1.2.m2.3.3.1.1.1.1.2.cmml">𝐱</mi><mrow id="S7.SS1.p1.2.m2.2.2.2.4" xref="S7.SS1.p1.2.m2.2.2.2.3.cmml"><mi id="S7.SS1.p1.2.m2.1.1.1.1" xref="S7.SS1.p1.2.m2.1.1.1.1.cmml">c</mi><mo id="S7.SS1.p1.2.m2.2.2.2.4.1" xref="S7.SS1.p1.2.m2.2.2.2.3.cmml">,</mo><mi id="S7.SS1.p1.2.m2.2.2.2.2" xref="S7.SS1.p1.2.m2.2.2.2.2.cmml">i</mi></mrow></msub><mo stretchy="false" id="S7.SS1.p1.2.m2.3.3.1.1.1.3" xref="S7.SS1.p1.2.m2.3.3.1.1.2.cmml">}</mo></mrow><mrow id="S7.SS1.p1.2.m2.3.3.1.3" xref="S7.SS1.p1.2.m2.3.3.1.3.cmml"><mi id="S7.SS1.p1.2.m2.3.3.1.3.2" xref="S7.SS1.p1.2.m2.3.3.1.3.2.cmml">i</mi><mo id="S7.SS1.p1.2.m2.3.3.1.3.1" xref="S7.SS1.p1.2.m2.3.3.1.3.1.cmml">=</mo><mn id="S7.SS1.p1.2.m2.3.3.1.3.3" xref="S7.SS1.p1.2.m2.3.3.1.3.3.cmml">1</mn></mrow><msub id="S7.SS1.p1.2.m2.3.3.3" xref="S7.SS1.p1.2.m2.3.3.3.cmml"><mi id="S7.SS1.p1.2.m2.3.3.3.2" xref="S7.SS1.p1.2.m2.3.3.3.2.cmml">N</mi><mi id="S7.SS1.p1.2.m2.3.3.3.3" xref="S7.SS1.p1.2.m2.3.3.3.3.cmml">f</mi></msub></msubsup><annotation-xml encoding="MathML-Content" id="S7.SS1.p1.2.m2.3b"><apply id="S7.SS1.p1.2.m2.3.3.cmml" xref="S7.SS1.p1.2.m2.3.3"><csymbol cd="ambiguous" id="S7.SS1.p1.2.m2.3.3.2.cmml" xref="S7.SS1.p1.2.m2.3.3">superscript</csymbol><apply id="S7.SS1.p1.2.m2.3.3.1.cmml" xref="S7.SS1.p1.2.m2.3.3"><csymbol cd="ambiguous" id="S7.SS1.p1.2.m2.3.3.1.2.cmml" xref="S7.SS1.p1.2.m2.3.3">subscript</csymbol><set id="S7.SS1.p1.2.m2.3.3.1.1.2.cmml" xref="S7.SS1.p1.2.m2.3.3.1.1.1"><apply id="S7.SS1.p1.2.m2.3.3.1.1.1.1.cmml" xref="S7.SS1.p1.2.m2.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S7.SS1.p1.2.m2.3.3.1.1.1.1.1.cmml" xref="S7.SS1.p1.2.m2.3.3.1.1.1.1">subscript</csymbol><ci id="S7.SS1.p1.2.m2.3.3.1.1.1.1.2.cmml" xref="S7.SS1.p1.2.m2.3.3.1.1.1.1.2">𝐱</ci><list id="S7.SS1.p1.2.m2.2.2.2.3.cmml" xref="S7.SS1.p1.2.m2.2.2.2.4"><ci id="S7.SS1.p1.2.m2.1.1.1.1.cmml" xref="S7.SS1.p1.2.m2.1.1.1.1">𝑐</ci><ci id="S7.SS1.p1.2.m2.2.2.2.2.cmml" xref="S7.SS1.p1.2.m2.2.2.2.2">𝑖</ci></list></apply></set><apply id="S7.SS1.p1.2.m2.3.3.1.3.cmml" xref="S7.SS1.p1.2.m2.3.3.1.3"><eq id="S7.SS1.p1.2.m2.3.3.1.3.1.cmml" xref="S7.SS1.p1.2.m2.3.3.1.3.1"></eq><ci id="S7.SS1.p1.2.m2.3.3.1.3.2.cmml" xref="S7.SS1.p1.2.m2.3.3.1.3.2">𝑖</ci><cn type="integer" id="S7.SS1.p1.2.m2.3.3.1.3.3.cmml" xref="S7.SS1.p1.2.m2.3.3.1.3.3">1</cn></apply></apply><apply id="S7.SS1.p1.2.m2.3.3.3.cmml" xref="S7.SS1.p1.2.m2.3.3.3"><csymbol cd="ambiguous" id="S7.SS1.p1.2.m2.3.3.3.1.cmml" xref="S7.SS1.p1.2.m2.3.3.3">subscript</csymbol><ci id="S7.SS1.p1.2.m2.3.3.3.2.cmml" xref="S7.SS1.p1.2.m2.3.3.3.2">𝑁</ci><ci id="S7.SS1.p1.2.m2.3.3.3.3.cmml" xref="S7.SS1.p1.2.m2.3.3.3.3">𝑓</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p1.2.m2.3c">\{\mathbf{x}_{c,i}\}_{i=1}^{N_{f}}</annotation></semantics></math> for class <math id="S7.SS1.p1.3.m3.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S7.SS1.p1.3.m3.1a"><mi id="S7.SS1.p1.3.m3.1.1" xref="S7.SS1.p1.3.m3.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S7.SS1.p1.3.m3.1b"><ci id="S7.SS1.p1.3.m3.1.1.cmml" xref="S7.SS1.p1.3.m3.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p1.3.m3.1c">c</annotation></semantics></math> will converge to its class mean <math id="S7.SS1.p1.4.m4.2" class="ltx_Math" alttext="\bar{\mathbf{x}}_{c}=\frac{1}{N_{f}}\sum_{i}\mathbf{x}_{c,i}" display="inline"><semantics id="S7.SS1.p1.4.m4.2a"><mrow id="S7.SS1.p1.4.m4.2.3" xref="S7.SS1.p1.4.m4.2.3.cmml"><msub id="S7.SS1.p1.4.m4.2.3.2" xref="S7.SS1.p1.4.m4.2.3.2.cmml"><mover accent="true" id="S7.SS1.p1.4.m4.2.3.2.2" xref="S7.SS1.p1.4.m4.2.3.2.2.cmml"><mi id="S7.SS1.p1.4.m4.2.3.2.2.2" xref="S7.SS1.p1.4.m4.2.3.2.2.2.cmml">𝐱</mi><mo id="S7.SS1.p1.4.m4.2.3.2.2.1" xref="S7.SS1.p1.4.m4.2.3.2.2.1.cmml">¯</mo></mover><mi id="S7.SS1.p1.4.m4.2.3.2.3" xref="S7.SS1.p1.4.m4.2.3.2.3.cmml">c</mi></msub><mo id="S7.SS1.p1.4.m4.2.3.1" xref="S7.SS1.p1.4.m4.2.3.1.cmml">=</mo><mrow id="S7.SS1.p1.4.m4.2.3.3" xref="S7.SS1.p1.4.m4.2.3.3.cmml"><mfrac id="S7.SS1.p1.4.m4.2.3.3.2" xref="S7.SS1.p1.4.m4.2.3.3.2.cmml"><mn id="S7.SS1.p1.4.m4.2.3.3.2.2" xref="S7.SS1.p1.4.m4.2.3.3.2.2.cmml">1</mn><msub id="S7.SS1.p1.4.m4.2.3.3.2.3" xref="S7.SS1.p1.4.m4.2.3.3.2.3.cmml"><mi id="S7.SS1.p1.4.m4.2.3.3.2.3.2" xref="S7.SS1.p1.4.m4.2.3.3.2.3.2.cmml">N</mi><mi id="S7.SS1.p1.4.m4.2.3.3.2.3.3" xref="S7.SS1.p1.4.m4.2.3.3.2.3.3.cmml">f</mi></msub></mfrac><mo lspace="0em" rspace="0em" id="S7.SS1.p1.4.m4.2.3.3.1" xref="S7.SS1.p1.4.m4.2.3.3.1.cmml">​</mo><mrow id="S7.SS1.p1.4.m4.2.3.3.3" xref="S7.SS1.p1.4.m4.2.3.3.3.cmml"><msub id="S7.SS1.p1.4.m4.2.3.3.3.1" xref="S7.SS1.p1.4.m4.2.3.3.3.1.cmml"><mo id="S7.SS1.p1.4.m4.2.3.3.3.1.2" xref="S7.SS1.p1.4.m4.2.3.3.3.1.2.cmml">∑</mo><mi id="S7.SS1.p1.4.m4.2.3.3.3.1.3" xref="S7.SS1.p1.4.m4.2.3.3.3.1.3.cmml">i</mi></msub><msub id="S7.SS1.p1.4.m4.2.3.3.3.2" xref="S7.SS1.p1.4.m4.2.3.3.3.2.cmml"><mi id="S7.SS1.p1.4.m4.2.3.3.3.2.2" xref="S7.SS1.p1.4.m4.2.3.3.3.2.2.cmml">𝐱</mi><mrow id="S7.SS1.p1.4.m4.2.2.2.4" xref="S7.SS1.p1.4.m4.2.2.2.3.cmml"><mi id="S7.SS1.p1.4.m4.1.1.1.1" xref="S7.SS1.p1.4.m4.1.1.1.1.cmml">c</mi><mo id="S7.SS1.p1.4.m4.2.2.2.4.1" xref="S7.SS1.p1.4.m4.2.2.2.3.cmml">,</mo><mi id="S7.SS1.p1.4.m4.2.2.2.2" xref="S7.SS1.p1.4.m4.2.2.2.2.cmml">i</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.SS1.p1.4.m4.2b"><apply id="S7.SS1.p1.4.m4.2.3.cmml" xref="S7.SS1.p1.4.m4.2.3"><eq id="S7.SS1.p1.4.m4.2.3.1.cmml" xref="S7.SS1.p1.4.m4.2.3.1"></eq><apply id="S7.SS1.p1.4.m4.2.3.2.cmml" xref="S7.SS1.p1.4.m4.2.3.2"><csymbol cd="ambiguous" id="S7.SS1.p1.4.m4.2.3.2.1.cmml" xref="S7.SS1.p1.4.m4.2.3.2">subscript</csymbol><apply id="S7.SS1.p1.4.m4.2.3.2.2.cmml" xref="S7.SS1.p1.4.m4.2.3.2.2"><ci id="S7.SS1.p1.4.m4.2.3.2.2.1.cmml" xref="S7.SS1.p1.4.m4.2.3.2.2.1">¯</ci><ci id="S7.SS1.p1.4.m4.2.3.2.2.2.cmml" xref="S7.SS1.p1.4.m4.2.3.2.2.2">𝐱</ci></apply><ci id="S7.SS1.p1.4.m4.2.3.2.3.cmml" xref="S7.SS1.p1.4.m4.2.3.2.3">𝑐</ci></apply><apply id="S7.SS1.p1.4.m4.2.3.3.cmml" xref="S7.SS1.p1.4.m4.2.3.3"><times id="S7.SS1.p1.4.m4.2.3.3.1.cmml" xref="S7.SS1.p1.4.m4.2.3.3.1"></times><apply id="S7.SS1.p1.4.m4.2.3.3.2.cmml" xref="S7.SS1.p1.4.m4.2.3.3.2"><divide id="S7.SS1.p1.4.m4.2.3.3.2.1.cmml" xref="S7.SS1.p1.4.m4.2.3.3.2"></divide><cn type="integer" id="S7.SS1.p1.4.m4.2.3.3.2.2.cmml" xref="S7.SS1.p1.4.m4.2.3.3.2.2">1</cn><apply id="S7.SS1.p1.4.m4.2.3.3.2.3.cmml" xref="S7.SS1.p1.4.m4.2.3.3.2.3"><csymbol cd="ambiguous" id="S7.SS1.p1.4.m4.2.3.3.2.3.1.cmml" xref="S7.SS1.p1.4.m4.2.3.3.2.3">subscript</csymbol><ci id="S7.SS1.p1.4.m4.2.3.3.2.3.2.cmml" xref="S7.SS1.p1.4.m4.2.3.3.2.3.2">𝑁</ci><ci id="S7.SS1.p1.4.m4.2.3.3.2.3.3.cmml" xref="S7.SS1.p1.4.m4.2.3.3.2.3.3">𝑓</ci></apply></apply><apply id="S7.SS1.p1.4.m4.2.3.3.3.cmml" xref="S7.SS1.p1.4.m4.2.3.3.3"><apply id="S7.SS1.p1.4.m4.2.3.3.3.1.cmml" xref="S7.SS1.p1.4.m4.2.3.3.3.1"><csymbol cd="ambiguous" id="S7.SS1.p1.4.m4.2.3.3.3.1.1.cmml" xref="S7.SS1.p1.4.m4.2.3.3.3.1">subscript</csymbol><sum id="S7.SS1.p1.4.m4.2.3.3.3.1.2.cmml" xref="S7.SS1.p1.4.m4.2.3.3.3.1.2"></sum><ci id="S7.SS1.p1.4.m4.2.3.3.3.1.3.cmml" xref="S7.SS1.p1.4.m4.2.3.3.3.1.3">𝑖</ci></apply><apply id="S7.SS1.p1.4.m4.2.3.3.3.2.cmml" xref="S7.SS1.p1.4.m4.2.3.3.3.2"><csymbol cd="ambiguous" id="S7.SS1.p1.4.m4.2.3.3.3.2.1.cmml" xref="S7.SS1.p1.4.m4.2.3.3.3.2">subscript</csymbol><ci id="S7.SS1.p1.4.m4.2.3.3.3.2.2.cmml" xref="S7.SS1.p1.4.m4.2.3.3.3.2.2">𝐱</ci><list id="S7.SS1.p1.4.m4.2.2.2.3.cmml" xref="S7.SS1.p1.4.m4.2.2.2.4"><ci id="S7.SS1.p1.4.m4.1.1.1.1.cmml" xref="S7.SS1.p1.4.m4.1.1.1.1">𝑐</ci><ci id="S7.SS1.p1.4.m4.2.2.2.2.cmml" xref="S7.SS1.p1.4.m4.2.2.2.2">𝑖</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p1.4.m4.2c">\bar{\mathbf{x}}_{c}=\frac{1}{N_{f}}\sum_{i}\mathbf{x}_{c,i}</annotation></semantics></math> where the class means <math id="S7.SS1.p1.5.m5.1" class="ltx_Math" alttext="\{\bar{\mathbf{x}}_{c}\}_{c\in\mathcal{C}}" display="inline"><semantics id="S7.SS1.p1.5.m5.1a"><msub id="S7.SS1.p1.5.m5.1.1" xref="S7.SS1.p1.5.m5.1.1.cmml"><mrow id="S7.SS1.p1.5.m5.1.1.1.1" xref="S7.SS1.p1.5.m5.1.1.1.2.cmml"><mo stretchy="false" id="S7.SS1.p1.5.m5.1.1.1.1.2" xref="S7.SS1.p1.5.m5.1.1.1.2.cmml">{</mo><msub id="S7.SS1.p1.5.m5.1.1.1.1.1" xref="S7.SS1.p1.5.m5.1.1.1.1.1.cmml"><mover accent="true" id="S7.SS1.p1.5.m5.1.1.1.1.1.2" xref="S7.SS1.p1.5.m5.1.1.1.1.1.2.cmml"><mi id="S7.SS1.p1.5.m5.1.1.1.1.1.2.2" xref="S7.SS1.p1.5.m5.1.1.1.1.1.2.2.cmml">𝐱</mi><mo id="S7.SS1.p1.5.m5.1.1.1.1.1.2.1" xref="S7.SS1.p1.5.m5.1.1.1.1.1.2.1.cmml">¯</mo></mover><mi id="S7.SS1.p1.5.m5.1.1.1.1.1.3" xref="S7.SS1.p1.5.m5.1.1.1.1.1.3.cmml">c</mi></msub><mo stretchy="false" id="S7.SS1.p1.5.m5.1.1.1.1.3" xref="S7.SS1.p1.5.m5.1.1.1.2.cmml">}</mo></mrow><mrow id="S7.SS1.p1.5.m5.1.1.3" xref="S7.SS1.p1.5.m5.1.1.3.cmml"><mi id="S7.SS1.p1.5.m5.1.1.3.2" xref="S7.SS1.p1.5.m5.1.1.3.2.cmml">c</mi><mo id="S7.SS1.p1.5.m5.1.1.3.1" xref="S7.SS1.p1.5.m5.1.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p1.5.m5.1.1.3.3" xref="S7.SS1.p1.5.m5.1.1.3.3.cmml">𝒞</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S7.SS1.p1.5.m5.1b"><apply id="S7.SS1.p1.5.m5.1.1.cmml" xref="S7.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S7.SS1.p1.5.m5.1.1.2.cmml" xref="S7.SS1.p1.5.m5.1.1">subscript</csymbol><set id="S7.SS1.p1.5.m5.1.1.1.2.cmml" xref="S7.SS1.p1.5.m5.1.1.1.1"><apply id="S7.SS1.p1.5.m5.1.1.1.1.1.cmml" xref="S7.SS1.p1.5.m5.1.1.1.1.1"><csymbol cd="ambiguous" id="S7.SS1.p1.5.m5.1.1.1.1.1.1.cmml" xref="S7.SS1.p1.5.m5.1.1.1.1.1">subscript</csymbol><apply id="S7.SS1.p1.5.m5.1.1.1.1.1.2.cmml" xref="S7.SS1.p1.5.m5.1.1.1.1.1.2"><ci id="S7.SS1.p1.5.m5.1.1.1.1.1.2.1.cmml" xref="S7.SS1.p1.5.m5.1.1.1.1.1.2.1">¯</ci><ci id="S7.SS1.p1.5.m5.1.1.1.1.1.2.2.cmml" xref="S7.SS1.p1.5.m5.1.1.1.1.1.2.2">𝐱</ci></apply><ci id="S7.SS1.p1.5.m5.1.1.1.1.1.3.cmml" xref="S7.SS1.p1.5.m5.1.1.1.1.1.3">𝑐</ci></apply></set><apply id="S7.SS1.p1.5.m5.1.1.3.cmml" xref="S7.SS1.p1.5.m5.1.1.3"><in id="S7.SS1.p1.5.m5.1.1.3.1.cmml" xref="S7.SS1.p1.5.m5.1.1.3.1"></in><ci id="S7.SS1.p1.5.m5.1.1.3.2.cmml" xref="S7.SS1.p1.5.m5.1.1.3.2">𝑐</ci><ci id="S7.SS1.p1.5.m5.1.1.3.3.cmml" xref="S7.SS1.p1.5.m5.1.1.3.3">𝒞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p1.5.m5.1c">\{\bar{\mathbf{x}}_{c}\}_{c\in\mathcal{C}}</annotation></semantics></math> together the class centers <math id="S7.SS1.p1.6.m6.1" class="ltx_Math" alttext="\{\mathbf{w}_{c}\}_{c\in\mathcal{C}}" display="inline"><semantics id="S7.SS1.p1.6.m6.1a"><msub id="S7.SS1.p1.6.m6.1.1" xref="S7.SS1.p1.6.m6.1.1.cmml"><mrow id="S7.SS1.p1.6.m6.1.1.1.1" xref="S7.SS1.p1.6.m6.1.1.1.2.cmml"><mo stretchy="false" id="S7.SS1.p1.6.m6.1.1.1.1.2" xref="S7.SS1.p1.6.m6.1.1.1.2.cmml">{</mo><msub id="S7.SS1.p1.6.m6.1.1.1.1.1" xref="S7.SS1.p1.6.m6.1.1.1.1.1.cmml"><mi id="S7.SS1.p1.6.m6.1.1.1.1.1.2" xref="S7.SS1.p1.6.m6.1.1.1.1.1.2.cmml">𝐰</mi><mi id="S7.SS1.p1.6.m6.1.1.1.1.1.3" xref="S7.SS1.p1.6.m6.1.1.1.1.1.3.cmml">c</mi></msub><mo stretchy="false" id="S7.SS1.p1.6.m6.1.1.1.1.3" xref="S7.SS1.p1.6.m6.1.1.1.2.cmml">}</mo></mrow><mrow id="S7.SS1.p1.6.m6.1.1.3" xref="S7.SS1.p1.6.m6.1.1.3.cmml"><mi id="S7.SS1.p1.6.m6.1.1.3.2" xref="S7.SS1.p1.6.m6.1.1.3.2.cmml">c</mi><mo id="S7.SS1.p1.6.m6.1.1.3.1" xref="S7.SS1.p1.6.m6.1.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p1.6.m6.1.1.3.3" xref="S7.SS1.p1.6.m6.1.1.3.3.cmml">𝒞</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S7.SS1.p1.6.m6.1b"><apply id="S7.SS1.p1.6.m6.1.1.cmml" xref="S7.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S7.SS1.p1.6.m6.1.1.2.cmml" xref="S7.SS1.p1.6.m6.1.1">subscript</csymbol><set id="S7.SS1.p1.6.m6.1.1.1.2.cmml" xref="S7.SS1.p1.6.m6.1.1.1.1"><apply id="S7.SS1.p1.6.m6.1.1.1.1.1.cmml" xref="S7.SS1.p1.6.m6.1.1.1.1.1"><csymbol cd="ambiguous" id="S7.SS1.p1.6.m6.1.1.1.1.1.1.cmml" xref="S7.SS1.p1.6.m6.1.1.1.1.1">subscript</csymbol><ci id="S7.SS1.p1.6.m6.1.1.1.1.1.2.cmml" xref="S7.SS1.p1.6.m6.1.1.1.1.1.2">𝐰</ci><ci id="S7.SS1.p1.6.m6.1.1.1.1.1.3.cmml" xref="S7.SS1.p1.6.m6.1.1.1.1.1.3">𝑐</ci></apply></set><apply id="S7.SS1.p1.6.m6.1.1.3.cmml" xref="S7.SS1.p1.6.m6.1.1.3"><in id="S7.SS1.p1.6.m6.1.1.3.1.cmml" xref="S7.SS1.p1.6.m6.1.1.3.1"></in><ci id="S7.SS1.p1.6.m6.1.1.3.2.cmml" xref="S7.SS1.p1.6.m6.1.1.3.2">𝑐</ci><ci id="S7.SS1.p1.6.m6.1.1.3.3.cmml" xref="S7.SS1.p1.6.m6.1.1.3.3">𝒞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p1.6.m6.1c">\{\mathbf{w}_{c}\}_{c\in\mathcal{C}}</annotation></semantics></math> will collapse to the simplex equiangular tight frame (Simplex ETF). Meanwhile, though the optimization objective of class mean and class centers (classifier weights) are not exactly the same, the class mean and class centers will still converge to each other.</p>
</div>
<div id="S7.SS1.p2" class="ltx_para ltx_noindent">
<p id="S7.SS1.p2.1" class="ltx_p"><em id="S7.SS1.p2.1.1" class="ltx_emph ltx_font_bold ltx_font_italic">Simplex Equiangular Tight Frame</em> denotes a collection of vectors <math id="S7.SS1.p2.1.m1.1" class="ltx_Math" alttext="\mathbf{W}^{*}=\{\mathbf{w}_{i}^{\prime}\}_{i=1}^{N_{c}}\in\mathcal{R}^{d\times N_{c}}" display="inline"><semantics id="S7.SS1.p2.1.m1.1a"><mrow id="S7.SS1.p2.1.m1.1.1" xref="S7.SS1.p2.1.m1.1.1.cmml"><msup id="S7.SS1.p2.1.m1.1.1.3" xref="S7.SS1.p2.1.m1.1.1.3.cmml"><mi id="S7.SS1.p2.1.m1.1.1.3.2" xref="S7.SS1.p2.1.m1.1.1.3.2.cmml">𝐖</mi><mo id="S7.SS1.p2.1.m1.1.1.3.3" xref="S7.SS1.p2.1.m1.1.1.3.3.cmml">∗</mo></msup><mo id="S7.SS1.p2.1.m1.1.1.4" xref="S7.SS1.p2.1.m1.1.1.4.cmml">=</mo><msubsup id="S7.SS1.p2.1.m1.1.1.1" xref="S7.SS1.p2.1.m1.1.1.1.cmml"><mrow id="S7.SS1.p2.1.m1.1.1.1.1.1.1" xref="S7.SS1.p2.1.m1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S7.SS1.p2.1.m1.1.1.1.1.1.1.2" xref="S7.SS1.p2.1.m1.1.1.1.1.1.2.cmml">{</mo><msubsup id="S7.SS1.p2.1.m1.1.1.1.1.1.1.1" xref="S7.SS1.p2.1.m1.1.1.1.1.1.1.1.cmml"><mi id="S7.SS1.p2.1.m1.1.1.1.1.1.1.1.2.2" xref="S7.SS1.p2.1.m1.1.1.1.1.1.1.1.2.2.cmml">𝐰</mi><mi id="S7.SS1.p2.1.m1.1.1.1.1.1.1.1.2.3" xref="S7.SS1.p2.1.m1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mo id="S7.SS1.p2.1.m1.1.1.1.1.1.1.1.3" xref="S7.SS1.p2.1.m1.1.1.1.1.1.1.1.3.cmml">′</mo></msubsup><mo stretchy="false" id="S7.SS1.p2.1.m1.1.1.1.1.1.1.3" xref="S7.SS1.p2.1.m1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S7.SS1.p2.1.m1.1.1.1.1.3" xref="S7.SS1.p2.1.m1.1.1.1.1.3.cmml"><mi id="S7.SS1.p2.1.m1.1.1.1.1.3.2" xref="S7.SS1.p2.1.m1.1.1.1.1.3.2.cmml">i</mi><mo id="S7.SS1.p2.1.m1.1.1.1.1.3.1" xref="S7.SS1.p2.1.m1.1.1.1.1.3.1.cmml">=</mo><mn id="S7.SS1.p2.1.m1.1.1.1.1.3.3" xref="S7.SS1.p2.1.m1.1.1.1.1.3.3.cmml">1</mn></mrow><msub id="S7.SS1.p2.1.m1.1.1.1.3" xref="S7.SS1.p2.1.m1.1.1.1.3.cmml"><mi id="S7.SS1.p2.1.m1.1.1.1.3.2" xref="S7.SS1.p2.1.m1.1.1.1.3.2.cmml">N</mi><mi id="S7.SS1.p2.1.m1.1.1.1.3.3" xref="S7.SS1.p2.1.m1.1.1.1.3.3.cmml">c</mi></msub></msubsup><mo id="S7.SS1.p2.1.m1.1.1.5" xref="S7.SS1.p2.1.m1.1.1.5.cmml">∈</mo><msup id="S7.SS1.p2.1.m1.1.1.6" xref="S7.SS1.p2.1.m1.1.1.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p2.1.m1.1.1.6.2" xref="S7.SS1.p2.1.m1.1.1.6.2.cmml">ℛ</mi><mrow id="S7.SS1.p2.1.m1.1.1.6.3" xref="S7.SS1.p2.1.m1.1.1.6.3.cmml"><mi id="S7.SS1.p2.1.m1.1.1.6.3.2" xref="S7.SS1.p2.1.m1.1.1.6.3.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="S7.SS1.p2.1.m1.1.1.6.3.1" xref="S7.SS1.p2.1.m1.1.1.6.3.1.cmml">×</mo><msub id="S7.SS1.p2.1.m1.1.1.6.3.3" xref="S7.SS1.p2.1.m1.1.1.6.3.3.cmml"><mi id="S7.SS1.p2.1.m1.1.1.6.3.3.2" xref="S7.SS1.p2.1.m1.1.1.6.3.3.2.cmml">N</mi><mi id="S7.SS1.p2.1.m1.1.1.6.3.3.3" xref="S7.SS1.p2.1.m1.1.1.6.3.3.3.cmml">c</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S7.SS1.p2.1.m1.1b"><apply id="S7.SS1.p2.1.m1.1.1.cmml" xref="S7.SS1.p2.1.m1.1.1"><and id="S7.SS1.p2.1.m1.1.1a.cmml" xref="S7.SS1.p2.1.m1.1.1"></and><apply id="S7.SS1.p2.1.m1.1.1b.cmml" xref="S7.SS1.p2.1.m1.1.1"><eq id="S7.SS1.p2.1.m1.1.1.4.cmml" xref="S7.SS1.p2.1.m1.1.1.4"></eq><apply id="S7.SS1.p2.1.m1.1.1.3.cmml" xref="S7.SS1.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S7.SS1.p2.1.m1.1.1.3.1.cmml" xref="S7.SS1.p2.1.m1.1.1.3">superscript</csymbol><ci id="S7.SS1.p2.1.m1.1.1.3.2.cmml" xref="S7.SS1.p2.1.m1.1.1.3.2">𝐖</ci><times id="S7.SS1.p2.1.m1.1.1.3.3.cmml" xref="S7.SS1.p2.1.m1.1.1.3.3"></times></apply><apply id="S7.SS1.p2.1.m1.1.1.1.cmml" xref="S7.SS1.p2.1.m1.1.1.1"><csymbol cd="ambiguous" id="S7.SS1.p2.1.m1.1.1.1.2.cmml" xref="S7.SS1.p2.1.m1.1.1.1">superscript</csymbol><apply id="S7.SS1.p2.1.m1.1.1.1.1.cmml" xref="S7.SS1.p2.1.m1.1.1.1"><csymbol cd="ambiguous" id="S7.SS1.p2.1.m1.1.1.1.1.2.cmml" xref="S7.SS1.p2.1.m1.1.1.1">subscript</csymbol><set id="S7.SS1.p2.1.m1.1.1.1.1.1.2.cmml" xref="S7.SS1.p2.1.m1.1.1.1.1.1.1"><apply id="S7.SS1.p2.1.m1.1.1.1.1.1.1.1.cmml" xref="S7.SS1.p2.1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S7.SS1.p2.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S7.SS1.p2.1.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S7.SS1.p2.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S7.SS1.p2.1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S7.SS1.p2.1.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S7.SS1.p2.1.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S7.SS1.p2.1.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S7.SS1.p2.1.m1.1.1.1.1.1.1.1.2.2">𝐰</ci><ci id="S7.SS1.p2.1.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S7.SS1.p2.1.m1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S7.SS1.p2.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S7.SS1.p2.1.m1.1.1.1.1.1.1.1.3">′</ci></apply></set><apply id="S7.SS1.p2.1.m1.1.1.1.1.3.cmml" xref="S7.SS1.p2.1.m1.1.1.1.1.3"><eq id="S7.SS1.p2.1.m1.1.1.1.1.3.1.cmml" xref="S7.SS1.p2.1.m1.1.1.1.1.3.1"></eq><ci id="S7.SS1.p2.1.m1.1.1.1.1.3.2.cmml" xref="S7.SS1.p2.1.m1.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="S7.SS1.p2.1.m1.1.1.1.1.3.3.cmml" xref="S7.SS1.p2.1.m1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S7.SS1.p2.1.m1.1.1.1.3.cmml" xref="S7.SS1.p2.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="S7.SS1.p2.1.m1.1.1.1.3.1.cmml" xref="S7.SS1.p2.1.m1.1.1.1.3">subscript</csymbol><ci id="S7.SS1.p2.1.m1.1.1.1.3.2.cmml" xref="S7.SS1.p2.1.m1.1.1.1.3.2">𝑁</ci><ci id="S7.SS1.p2.1.m1.1.1.1.3.3.cmml" xref="S7.SS1.p2.1.m1.1.1.1.3.3">𝑐</ci></apply></apply></apply><apply id="S7.SS1.p2.1.m1.1.1c.cmml" xref="S7.SS1.p2.1.m1.1.1"><in id="S7.SS1.p2.1.m1.1.1.5.cmml" xref="S7.SS1.p2.1.m1.1.1.5"></in><share href="#S7.SS1.p2.1.m1.1.1.1.cmml" id="S7.SS1.p2.1.m1.1.1d.cmml" xref="S7.SS1.p2.1.m1.1.1"></share><apply id="S7.SS1.p2.1.m1.1.1.6.cmml" xref="S7.SS1.p2.1.m1.1.1.6"><csymbol cd="ambiguous" id="S7.SS1.p2.1.m1.1.1.6.1.cmml" xref="S7.SS1.p2.1.m1.1.1.6">superscript</csymbol><ci id="S7.SS1.p2.1.m1.1.1.6.2.cmml" xref="S7.SS1.p2.1.m1.1.1.6.2">ℛ</ci><apply id="S7.SS1.p2.1.m1.1.1.6.3.cmml" xref="S7.SS1.p2.1.m1.1.1.6.3"><times id="S7.SS1.p2.1.m1.1.1.6.3.1.cmml" xref="S7.SS1.p2.1.m1.1.1.6.3.1"></times><ci id="S7.SS1.p2.1.m1.1.1.6.3.2.cmml" xref="S7.SS1.p2.1.m1.1.1.6.3.2">𝑑</ci><apply id="S7.SS1.p2.1.m1.1.1.6.3.3.cmml" xref="S7.SS1.p2.1.m1.1.1.6.3.3"><csymbol cd="ambiguous" id="S7.SS1.p2.1.m1.1.1.6.3.3.1.cmml" xref="S7.SS1.p2.1.m1.1.1.6.3.3">subscript</csymbol><ci id="S7.SS1.p2.1.m1.1.1.6.3.3.2.cmml" xref="S7.SS1.p2.1.m1.1.1.6.3.3.2">𝑁</ci><ci id="S7.SS1.p2.1.m1.1.1.6.3.3.3.cmml" xref="S7.SS1.p2.1.m1.1.1.6.3.3.3">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p2.1.m1.1c">\mathbf{W}^{*}=\{\mathbf{w}_{i}^{\prime}\}_{i=1}^{N_{c}}\in\mathcal{R}^{d\times N_{c}}</annotation></semantics></math> that</p>
<table id="S7.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S7.E5.m1.1" class="ltx_Math" alttext="\mathbf{W}^{*}=\sqrt{\frac{{N_{C}}}{{N_{C}}-1}}\mathbf{U}\big{(}\mathbf{I}_{N_{C}}-\frac{1}{N_{c}}\mathbf{1}_{N_{C}}\mathbf{1}_{N_{C}}^{T}\big{)}" display="block"><semantics id="S7.E5.m1.1a"><mrow id="S7.E5.m1.1.1" xref="S7.E5.m1.1.1.cmml"><msup id="S7.E5.m1.1.1.3" xref="S7.E5.m1.1.1.3.cmml"><mi id="S7.E5.m1.1.1.3.2" xref="S7.E5.m1.1.1.3.2.cmml">𝐖</mi><mo id="S7.E5.m1.1.1.3.3" xref="S7.E5.m1.1.1.3.3.cmml">∗</mo></msup><mo id="S7.E5.m1.1.1.2" xref="S7.E5.m1.1.1.2.cmml">=</mo><mrow id="S7.E5.m1.1.1.1" xref="S7.E5.m1.1.1.1.cmml"><msqrt id="S7.E5.m1.1.1.1.3" xref="S7.E5.m1.1.1.1.3.cmml"><mfrac id="S7.E5.m1.1.1.1.3.2" xref="S7.E5.m1.1.1.1.3.2.cmml"><msub id="S7.E5.m1.1.1.1.3.2.2" xref="S7.E5.m1.1.1.1.3.2.2.cmml"><mi id="S7.E5.m1.1.1.1.3.2.2.2" xref="S7.E5.m1.1.1.1.3.2.2.2.cmml">N</mi><mi id="S7.E5.m1.1.1.1.3.2.2.3" xref="S7.E5.m1.1.1.1.3.2.2.3.cmml">C</mi></msub><mrow id="S7.E5.m1.1.1.1.3.2.3" xref="S7.E5.m1.1.1.1.3.2.3.cmml"><msub id="S7.E5.m1.1.1.1.3.2.3.2" xref="S7.E5.m1.1.1.1.3.2.3.2.cmml"><mi id="S7.E5.m1.1.1.1.3.2.3.2.2" xref="S7.E5.m1.1.1.1.3.2.3.2.2.cmml">N</mi><mi id="S7.E5.m1.1.1.1.3.2.3.2.3" xref="S7.E5.m1.1.1.1.3.2.3.2.3.cmml">C</mi></msub><mo id="S7.E5.m1.1.1.1.3.2.3.1" xref="S7.E5.m1.1.1.1.3.2.3.1.cmml">−</mo><mn id="S7.E5.m1.1.1.1.3.2.3.3" xref="S7.E5.m1.1.1.1.3.2.3.3.cmml">1</mn></mrow></mfrac></msqrt><mo lspace="0em" rspace="0em" id="S7.E5.m1.1.1.1.2" xref="S7.E5.m1.1.1.1.2.cmml">​</mo><mi id="S7.E5.m1.1.1.1.4" xref="S7.E5.m1.1.1.1.4.cmml">𝐔</mi><mo lspace="0em" rspace="0em" id="S7.E5.m1.1.1.1.2a" xref="S7.E5.m1.1.1.1.2.cmml">​</mo><mrow id="S7.E5.m1.1.1.1.1.1" xref="S7.E5.m1.1.1.1.1.1.1.cmml"><mo maxsize="120%" minsize="120%" id="S7.E5.m1.1.1.1.1.1.2" xref="S7.E5.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S7.E5.m1.1.1.1.1.1.1" xref="S7.E5.m1.1.1.1.1.1.1.cmml"><msub id="S7.E5.m1.1.1.1.1.1.1.2" xref="S7.E5.m1.1.1.1.1.1.1.2.cmml"><mi id="S7.E5.m1.1.1.1.1.1.1.2.2" xref="S7.E5.m1.1.1.1.1.1.1.2.2.cmml">𝐈</mi><msub id="S7.E5.m1.1.1.1.1.1.1.2.3" xref="S7.E5.m1.1.1.1.1.1.1.2.3.cmml"><mi id="S7.E5.m1.1.1.1.1.1.1.2.3.2" xref="S7.E5.m1.1.1.1.1.1.1.2.3.2.cmml">N</mi><mi id="S7.E5.m1.1.1.1.1.1.1.2.3.3" xref="S7.E5.m1.1.1.1.1.1.1.2.3.3.cmml">C</mi></msub></msub><mo id="S7.E5.m1.1.1.1.1.1.1.1" xref="S7.E5.m1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S7.E5.m1.1.1.1.1.1.1.3" xref="S7.E5.m1.1.1.1.1.1.1.3.cmml"><mfrac id="S7.E5.m1.1.1.1.1.1.1.3.2" xref="S7.E5.m1.1.1.1.1.1.1.3.2.cmml"><mn id="S7.E5.m1.1.1.1.1.1.1.3.2.2" xref="S7.E5.m1.1.1.1.1.1.1.3.2.2.cmml">1</mn><msub id="S7.E5.m1.1.1.1.1.1.1.3.2.3" xref="S7.E5.m1.1.1.1.1.1.1.3.2.3.cmml"><mi id="S7.E5.m1.1.1.1.1.1.1.3.2.3.2" xref="S7.E5.m1.1.1.1.1.1.1.3.2.3.2.cmml">N</mi><mi id="S7.E5.m1.1.1.1.1.1.1.3.2.3.3" xref="S7.E5.m1.1.1.1.1.1.1.3.2.3.3.cmml">c</mi></msub></mfrac><mo lspace="0em" rspace="0em" id="S7.E5.m1.1.1.1.1.1.1.3.1" xref="S7.E5.m1.1.1.1.1.1.1.3.1.cmml">​</mo><msub id="S7.E5.m1.1.1.1.1.1.1.3.3" xref="S7.E5.m1.1.1.1.1.1.1.3.3.cmml"><mn id="S7.E5.m1.1.1.1.1.1.1.3.3.2" xref="S7.E5.m1.1.1.1.1.1.1.3.3.2.cmml">𝟏</mn><msub id="S7.E5.m1.1.1.1.1.1.1.3.3.3" xref="S7.E5.m1.1.1.1.1.1.1.3.3.3.cmml"><mi id="S7.E5.m1.1.1.1.1.1.1.3.3.3.2" xref="S7.E5.m1.1.1.1.1.1.1.3.3.3.2.cmml">N</mi><mi id="S7.E5.m1.1.1.1.1.1.1.3.3.3.3" xref="S7.E5.m1.1.1.1.1.1.1.3.3.3.3.cmml">C</mi></msub></msub><mo lspace="0em" rspace="0em" id="S7.E5.m1.1.1.1.1.1.1.3.1a" xref="S7.E5.m1.1.1.1.1.1.1.3.1.cmml">​</mo><msubsup id="S7.E5.m1.1.1.1.1.1.1.3.4" xref="S7.E5.m1.1.1.1.1.1.1.3.4.cmml"><mn id="S7.E5.m1.1.1.1.1.1.1.3.4.2.2" xref="S7.E5.m1.1.1.1.1.1.1.3.4.2.2.cmml">𝟏</mn><msub id="S7.E5.m1.1.1.1.1.1.1.3.4.2.3" xref="S7.E5.m1.1.1.1.1.1.1.3.4.2.3.cmml"><mi id="S7.E5.m1.1.1.1.1.1.1.3.4.2.3.2" xref="S7.E5.m1.1.1.1.1.1.1.3.4.2.3.2.cmml">N</mi><mi id="S7.E5.m1.1.1.1.1.1.1.3.4.2.3.3" xref="S7.E5.m1.1.1.1.1.1.1.3.4.2.3.3.cmml">C</mi></msub><mi id="S7.E5.m1.1.1.1.1.1.1.3.4.3" xref="S7.E5.m1.1.1.1.1.1.1.3.4.3.cmml">T</mi></msubsup></mrow></mrow><mo maxsize="120%" minsize="120%" id="S7.E5.m1.1.1.1.1.1.3" xref="S7.E5.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.E5.m1.1b"><apply id="S7.E5.m1.1.1.cmml" xref="S7.E5.m1.1.1"><eq id="S7.E5.m1.1.1.2.cmml" xref="S7.E5.m1.1.1.2"></eq><apply id="S7.E5.m1.1.1.3.cmml" xref="S7.E5.m1.1.1.3"><csymbol cd="ambiguous" id="S7.E5.m1.1.1.3.1.cmml" xref="S7.E5.m1.1.1.3">superscript</csymbol><ci id="S7.E5.m1.1.1.3.2.cmml" xref="S7.E5.m1.1.1.3.2">𝐖</ci><times id="S7.E5.m1.1.1.3.3.cmml" xref="S7.E5.m1.1.1.3.3"></times></apply><apply id="S7.E5.m1.1.1.1.cmml" xref="S7.E5.m1.1.1.1"><times id="S7.E5.m1.1.1.1.2.cmml" xref="S7.E5.m1.1.1.1.2"></times><apply id="S7.E5.m1.1.1.1.3.cmml" xref="S7.E5.m1.1.1.1.3"><root id="S7.E5.m1.1.1.1.3a.cmml" xref="S7.E5.m1.1.1.1.3"></root><apply id="S7.E5.m1.1.1.1.3.2.cmml" xref="S7.E5.m1.1.1.1.3.2"><divide id="S7.E5.m1.1.1.1.3.2.1.cmml" xref="S7.E5.m1.1.1.1.3.2"></divide><apply id="S7.E5.m1.1.1.1.3.2.2.cmml" xref="S7.E5.m1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S7.E5.m1.1.1.1.3.2.2.1.cmml" xref="S7.E5.m1.1.1.1.3.2.2">subscript</csymbol><ci id="S7.E5.m1.1.1.1.3.2.2.2.cmml" xref="S7.E5.m1.1.1.1.3.2.2.2">𝑁</ci><ci id="S7.E5.m1.1.1.1.3.2.2.3.cmml" xref="S7.E5.m1.1.1.1.3.2.2.3">𝐶</ci></apply><apply id="S7.E5.m1.1.1.1.3.2.3.cmml" xref="S7.E5.m1.1.1.1.3.2.3"><minus id="S7.E5.m1.1.1.1.3.2.3.1.cmml" xref="S7.E5.m1.1.1.1.3.2.3.1"></minus><apply id="S7.E5.m1.1.1.1.3.2.3.2.cmml" xref="S7.E5.m1.1.1.1.3.2.3.2"><csymbol cd="ambiguous" id="S7.E5.m1.1.1.1.3.2.3.2.1.cmml" xref="S7.E5.m1.1.1.1.3.2.3.2">subscript</csymbol><ci id="S7.E5.m1.1.1.1.3.2.3.2.2.cmml" xref="S7.E5.m1.1.1.1.3.2.3.2.2">𝑁</ci><ci id="S7.E5.m1.1.1.1.3.2.3.2.3.cmml" xref="S7.E5.m1.1.1.1.3.2.3.2.3">𝐶</ci></apply><cn type="integer" id="S7.E5.m1.1.1.1.3.2.3.3.cmml" xref="S7.E5.m1.1.1.1.3.2.3.3">1</cn></apply></apply></apply><ci id="S7.E5.m1.1.1.1.4.cmml" xref="S7.E5.m1.1.1.1.4">𝐔</ci><apply id="S7.E5.m1.1.1.1.1.1.1.cmml" xref="S7.E5.m1.1.1.1.1.1"><minus id="S7.E5.m1.1.1.1.1.1.1.1.cmml" xref="S7.E5.m1.1.1.1.1.1.1.1"></minus><apply id="S7.E5.m1.1.1.1.1.1.1.2.cmml" xref="S7.E5.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S7.E5.m1.1.1.1.1.1.1.2.1.cmml" xref="S7.E5.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S7.E5.m1.1.1.1.1.1.1.2.2.cmml" xref="S7.E5.m1.1.1.1.1.1.1.2.2">𝐈</ci><apply id="S7.E5.m1.1.1.1.1.1.1.2.3.cmml" xref="S7.E5.m1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S7.E5.m1.1.1.1.1.1.1.2.3.1.cmml" xref="S7.E5.m1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S7.E5.m1.1.1.1.1.1.1.2.3.2.cmml" xref="S7.E5.m1.1.1.1.1.1.1.2.3.2">𝑁</ci><ci id="S7.E5.m1.1.1.1.1.1.1.2.3.3.cmml" xref="S7.E5.m1.1.1.1.1.1.1.2.3.3">𝐶</ci></apply></apply><apply id="S7.E5.m1.1.1.1.1.1.1.3.cmml" xref="S7.E5.m1.1.1.1.1.1.1.3"><times id="S7.E5.m1.1.1.1.1.1.1.3.1.cmml" xref="S7.E5.m1.1.1.1.1.1.1.3.1"></times><apply id="S7.E5.m1.1.1.1.1.1.1.3.2.cmml" xref="S7.E5.m1.1.1.1.1.1.1.3.2"><divide id="S7.E5.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S7.E5.m1.1.1.1.1.1.1.3.2"></divide><cn type="integer" id="S7.E5.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S7.E5.m1.1.1.1.1.1.1.3.2.2">1</cn><apply id="S7.E5.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S7.E5.m1.1.1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S7.E5.m1.1.1.1.1.1.1.3.2.3.1.cmml" xref="S7.E5.m1.1.1.1.1.1.1.3.2.3">subscript</csymbol><ci id="S7.E5.m1.1.1.1.1.1.1.3.2.3.2.cmml" xref="S7.E5.m1.1.1.1.1.1.1.3.2.3.2">𝑁</ci><ci id="S7.E5.m1.1.1.1.1.1.1.3.2.3.3.cmml" xref="S7.E5.m1.1.1.1.1.1.1.3.2.3.3">𝑐</ci></apply></apply><apply id="S7.E5.m1.1.1.1.1.1.1.3.3.cmml" xref="S7.E5.m1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S7.E5.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S7.E5.m1.1.1.1.1.1.1.3.3">subscript</csymbol><cn type="integer" id="S7.E5.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S7.E5.m1.1.1.1.1.1.1.3.3.2">1</cn><apply id="S7.E5.m1.1.1.1.1.1.1.3.3.3.cmml" xref="S7.E5.m1.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S7.E5.m1.1.1.1.1.1.1.3.3.3.1.cmml" xref="S7.E5.m1.1.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S7.E5.m1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S7.E5.m1.1.1.1.1.1.1.3.3.3.2">𝑁</ci><ci id="S7.E5.m1.1.1.1.1.1.1.3.3.3.3.cmml" xref="S7.E5.m1.1.1.1.1.1.1.3.3.3.3">𝐶</ci></apply></apply><apply id="S7.E5.m1.1.1.1.1.1.1.3.4.cmml" xref="S7.E5.m1.1.1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="S7.E5.m1.1.1.1.1.1.1.3.4.1.cmml" xref="S7.E5.m1.1.1.1.1.1.1.3.4">superscript</csymbol><apply id="S7.E5.m1.1.1.1.1.1.1.3.4.2.cmml" xref="S7.E5.m1.1.1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="S7.E5.m1.1.1.1.1.1.1.3.4.2.1.cmml" xref="S7.E5.m1.1.1.1.1.1.1.3.4">subscript</csymbol><cn type="integer" id="S7.E5.m1.1.1.1.1.1.1.3.4.2.2.cmml" xref="S7.E5.m1.1.1.1.1.1.1.3.4.2.2">1</cn><apply id="S7.E5.m1.1.1.1.1.1.1.3.4.2.3.cmml" xref="S7.E5.m1.1.1.1.1.1.1.3.4.2.3"><csymbol cd="ambiguous" id="S7.E5.m1.1.1.1.1.1.1.3.4.2.3.1.cmml" xref="S7.E5.m1.1.1.1.1.1.1.3.4.2.3">subscript</csymbol><ci id="S7.E5.m1.1.1.1.1.1.1.3.4.2.3.2.cmml" xref="S7.E5.m1.1.1.1.1.1.1.3.4.2.3.2">𝑁</ci><ci id="S7.E5.m1.1.1.1.1.1.1.3.4.2.3.3.cmml" xref="S7.E5.m1.1.1.1.1.1.1.3.4.2.3.3">𝐶</ci></apply></apply><ci id="S7.E5.m1.1.1.1.1.1.1.3.4.3.cmml" xref="S7.E5.m1.1.1.1.1.1.1.3.4.3">𝑇</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.E5.m1.1c">\mathbf{W}^{*}=\sqrt{\frac{{N_{C}}}{{N_{C}}-1}}\mathbf{U}\big{(}\mathbf{I}_{N_{C}}-\frac{1}{N_{c}}\mathbf{1}_{N_{C}}\mathbf{1}_{N_{C}}^{T}\big{)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S7.SS1.p2.9" class="ltx_p">where each vector <math id="S7.SS1.p2.2.m1.1" class="ltx_Math" alttext="\mathbf{w}_{i}^{\prime}\in\mathcal{R}^{d}" display="inline"><semantics id="S7.SS1.p2.2.m1.1a"><mrow id="S7.SS1.p2.2.m1.1.1" xref="S7.SS1.p2.2.m1.1.1.cmml"><msubsup id="S7.SS1.p2.2.m1.1.1.2" xref="S7.SS1.p2.2.m1.1.1.2.cmml"><mi id="S7.SS1.p2.2.m1.1.1.2.2.2" xref="S7.SS1.p2.2.m1.1.1.2.2.2.cmml">𝐰</mi><mi id="S7.SS1.p2.2.m1.1.1.2.2.3" xref="S7.SS1.p2.2.m1.1.1.2.2.3.cmml">i</mi><mo id="S7.SS1.p2.2.m1.1.1.2.3" xref="S7.SS1.p2.2.m1.1.1.2.3.cmml">′</mo></msubsup><mo id="S7.SS1.p2.2.m1.1.1.1" xref="S7.SS1.p2.2.m1.1.1.1.cmml">∈</mo><msup id="S7.SS1.p2.2.m1.1.1.3" xref="S7.SS1.p2.2.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p2.2.m1.1.1.3.2" xref="S7.SS1.p2.2.m1.1.1.3.2.cmml">ℛ</mi><mi id="S7.SS1.p2.2.m1.1.1.3.3" xref="S7.SS1.p2.2.m1.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S7.SS1.p2.2.m1.1b"><apply id="S7.SS1.p2.2.m1.1.1.cmml" xref="S7.SS1.p2.2.m1.1.1"><in id="S7.SS1.p2.2.m1.1.1.1.cmml" xref="S7.SS1.p2.2.m1.1.1.1"></in><apply id="S7.SS1.p2.2.m1.1.1.2.cmml" xref="S7.SS1.p2.2.m1.1.1.2"><csymbol cd="ambiguous" id="S7.SS1.p2.2.m1.1.1.2.1.cmml" xref="S7.SS1.p2.2.m1.1.1.2">superscript</csymbol><apply id="S7.SS1.p2.2.m1.1.1.2.2.cmml" xref="S7.SS1.p2.2.m1.1.1.2"><csymbol cd="ambiguous" id="S7.SS1.p2.2.m1.1.1.2.2.1.cmml" xref="S7.SS1.p2.2.m1.1.1.2">subscript</csymbol><ci id="S7.SS1.p2.2.m1.1.1.2.2.2.cmml" xref="S7.SS1.p2.2.m1.1.1.2.2.2">𝐰</ci><ci id="S7.SS1.p2.2.m1.1.1.2.2.3.cmml" xref="S7.SS1.p2.2.m1.1.1.2.2.3">𝑖</ci></apply><ci id="S7.SS1.p2.2.m1.1.1.2.3.cmml" xref="S7.SS1.p2.2.m1.1.1.2.3">′</ci></apply><apply id="S7.SS1.p2.2.m1.1.1.3.cmml" xref="S7.SS1.p2.2.m1.1.1.3"><csymbol cd="ambiguous" id="S7.SS1.p2.2.m1.1.1.3.1.cmml" xref="S7.SS1.p2.2.m1.1.1.3">superscript</csymbol><ci id="S7.SS1.p2.2.m1.1.1.3.2.cmml" xref="S7.SS1.p2.2.m1.1.1.3.2">ℛ</ci><ci id="S7.SS1.p2.2.m1.1.1.3.3.cmml" xref="S7.SS1.p2.2.m1.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p2.2.m1.1c">\mathbf{w}_{i}^{\prime}\in\mathcal{R}^{d}</annotation></semantics></math> and <math id="S7.SS1.p2.3.m2.1" class="ltx_Math" alttext="\|\mathbf{w}_{i}^{\prime}\|_{2}=1" display="inline"><semantics id="S7.SS1.p2.3.m2.1a"><mrow id="S7.SS1.p2.3.m2.1.1" xref="S7.SS1.p2.3.m2.1.1.cmml"><msub id="S7.SS1.p2.3.m2.1.1.1" xref="S7.SS1.p2.3.m2.1.1.1.cmml"><mrow id="S7.SS1.p2.3.m2.1.1.1.1.1" xref="S7.SS1.p2.3.m2.1.1.1.1.2.cmml"><mo stretchy="false" id="S7.SS1.p2.3.m2.1.1.1.1.1.2" xref="S7.SS1.p2.3.m2.1.1.1.1.2.1.cmml">‖</mo><msubsup id="S7.SS1.p2.3.m2.1.1.1.1.1.1" xref="S7.SS1.p2.3.m2.1.1.1.1.1.1.cmml"><mi id="S7.SS1.p2.3.m2.1.1.1.1.1.1.2.2" xref="S7.SS1.p2.3.m2.1.1.1.1.1.1.2.2.cmml">𝐰</mi><mi id="S7.SS1.p2.3.m2.1.1.1.1.1.1.2.3" xref="S7.SS1.p2.3.m2.1.1.1.1.1.1.2.3.cmml">i</mi><mo id="S7.SS1.p2.3.m2.1.1.1.1.1.1.3" xref="S7.SS1.p2.3.m2.1.1.1.1.1.1.3.cmml">′</mo></msubsup><mo stretchy="false" id="S7.SS1.p2.3.m2.1.1.1.1.1.3" xref="S7.SS1.p2.3.m2.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S7.SS1.p2.3.m2.1.1.1.3" xref="S7.SS1.p2.3.m2.1.1.1.3.cmml">2</mn></msub><mo id="S7.SS1.p2.3.m2.1.1.2" xref="S7.SS1.p2.3.m2.1.1.2.cmml">=</mo><mn id="S7.SS1.p2.3.m2.1.1.3" xref="S7.SS1.p2.3.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS1.p2.3.m2.1b"><apply id="S7.SS1.p2.3.m2.1.1.cmml" xref="S7.SS1.p2.3.m2.1.1"><eq id="S7.SS1.p2.3.m2.1.1.2.cmml" xref="S7.SS1.p2.3.m2.1.1.2"></eq><apply id="S7.SS1.p2.3.m2.1.1.1.cmml" xref="S7.SS1.p2.3.m2.1.1.1"><csymbol cd="ambiguous" id="S7.SS1.p2.3.m2.1.1.1.2.cmml" xref="S7.SS1.p2.3.m2.1.1.1">subscript</csymbol><apply id="S7.SS1.p2.3.m2.1.1.1.1.2.cmml" xref="S7.SS1.p2.3.m2.1.1.1.1.1"><csymbol cd="latexml" id="S7.SS1.p2.3.m2.1.1.1.1.2.1.cmml" xref="S7.SS1.p2.3.m2.1.1.1.1.1.2">norm</csymbol><apply id="S7.SS1.p2.3.m2.1.1.1.1.1.1.cmml" xref="S7.SS1.p2.3.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S7.SS1.p2.3.m2.1.1.1.1.1.1.1.cmml" xref="S7.SS1.p2.3.m2.1.1.1.1.1.1">superscript</csymbol><apply id="S7.SS1.p2.3.m2.1.1.1.1.1.1.2.cmml" xref="S7.SS1.p2.3.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S7.SS1.p2.3.m2.1.1.1.1.1.1.2.1.cmml" xref="S7.SS1.p2.3.m2.1.1.1.1.1.1">subscript</csymbol><ci id="S7.SS1.p2.3.m2.1.1.1.1.1.1.2.2.cmml" xref="S7.SS1.p2.3.m2.1.1.1.1.1.1.2.2">𝐰</ci><ci id="S7.SS1.p2.3.m2.1.1.1.1.1.1.2.3.cmml" xref="S7.SS1.p2.3.m2.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S7.SS1.p2.3.m2.1.1.1.1.1.1.3.cmml" xref="S7.SS1.p2.3.m2.1.1.1.1.1.1.3">′</ci></apply></apply><cn type="integer" id="S7.SS1.p2.3.m2.1.1.1.3.cmml" xref="S7.SS1.p2.3.m2.1.1.1.3">2</cn></apply><cn type="integer" id="S7.SS1.p2.3.m2.1.1.3.cmml" xref="S7.SS1.p2.3.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p2.3.m2.1c">\|\mathbf{w}_{i}^{\prime}\|_{2}=1</annotation></semantics></math> for <math id="S7.SS1.p2.4.m3.1" class="ltx_Math" alttext="1\leq i\leq N_{C}" display="inline"><semantics id="S7.SS1.p2.4.m3.1a"><mrow id="S7.SS1.p2.4.m3.1.1" xref="S7.SS1.p2.4.m3.1.1.cmml"><mn id="S7.SS1.p2.4.m3.1.1.2" xref="S7.SS1.p2.4.m3.1.1.2.cmml">1</mn><mo id="S7.SS1.p2.4.m3.1.1.3" xref="S7.SS1.p2.4.m3.1.1.3.cmml">≤</mo><mi id="S7.SS1.p2.4.m3.1.1.4" xref="S7.SS1.p2.4.m3.1.1.4.cmml">i</mi><mo id="S7.SS1.p2.4.m3.1.1.5" xref="S7.SS1.p2.4.m3.1.1.5.cmml">≤</mo><msub id="S7.SS1.p2.4.m3.1.1.6" xref="S7.SS1.p2.4.m3.1.1.6.cmml"><mi id="S7.SS1.p2.4.m3.1.1.6.2" xref="S7.SS1.p2.4.m3.1.1.6.2.cmml">N</mi><mi id="S7.SS1.p2.4.m3.1.1.6.3" xref="S7.SS1.p2.4.m3.1.1.6.3.cmml">C</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S7.SS1.p2.4.m3.1b"><apply id="S7.SS1.p2.4.m3.1.1.cmml" xref="S7.SS1.p2.4.m3.1.1"><and id="S7.SS1.p2.4.m3.1.1a.cmml" xref="S7.SS1.p2.4.m3.1.1"></and><apply id="S7.SS1.p2.4.m3.1.1b.cmml" xref="S7.SS1.p2.4.m3.1.1"><leq id="S7.SS1.p2.4.m3.1.1.3.cmml" xref="S7.SS1.p2.4.m3.1.1.3"></leq><cn type="integer" id="S7.SS1.p2.4.m3.1.1.2.cmml" xref="S7.SS1.p2.4.m3.1.1.2">1</cn><ci id="S7.SS1.p2.4.m3.1.1.4.cmml" xref="S7.SS1.p2.4.m3.1.1.4">𝑖</ci></apply><apply id="S7.SS1.p2.4.m3.1.1c.cmml" xref="S7.SS1.p2.4.m3.1.1"><leq id="S7.SS1.p2.4.m3.1.1.5.cmml" xref="S7.SS1.p2.4.m3.1.1.5"></leq><share href="#S7.SS1.p2.4.m3.1.1.4.cmml" id="S7.SS1.p2.4.m3.1.1d.cmml" xref="S7.SS1.p2.4.m3.1.1"></share><apply id="S7.SS1.p2.4.m3.1.1.6.cmml" xref="S7.SS1.p2.4.m3.1.1.6"><csymbol cd="ambiguous" id="S7.SS1.p2.4.m3.1.1.6.1.cmml" xref="S7.SS1.p2.4.m3.1.1.6">subscript</csymbol><ci id="S7.SS1.p2.4.m3.1.1.6.2.cmml" xref="S7.SS1.p2.4.m3.1.1.6.2">𝑁</ci><ci id="S7.SS1.p2.4.m3.1.1.6.3.cmml" xref="S7.SS1.p2.4.m3.1.1.6.3">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p2.4.m3.1c">1\leq i\leq N_{C}</annotation></semantics></math>, <math id="S7.SS1.p2.5.m4.1" class="ltx_Math" alttext="\mathbf{I}_{N_{C}}\in\mathcal{R}^{N_{C}\times N_{C}}" display="inline"><semantics id="S7.SS1.p2.5.m4.1a"><mrow id="S7.SS1.p2.5.m4.1.1" xref="S7.SS1.p2.5.m4.1.1.cmml"><msub id="S7.SS1.p2.5.m4.1.1.2" xref="S7.SS1.p2.5.m4.1.1.2.cmml"><mi id="S7.SS1.p2.5.m4.1.1.2.2" xref="S7.SS1.p2.5.m4.1.1.2.2.cmml">𝐈</mi><msub id="S7.SS1.p2.5.m4.1.1.2.3" xref="S7.SS1.p2.5.m4.1.1.2.3.cmml"><mi id="S7.SS1.p2.5.m4.1.1.2.3.2" xref="S7.SS1.p2.5.m4.1.1.2.3.2.cmml">N</mi><mi id="S7.SS1.p2.5.m4.1.1.2.3.3" xref="S7.SS1.p2.5.m4.1.1.2.3.3.cmml">C</mi></msub></msub><mo id="S7.SS1.p2.5.m4.1.1.1" xref="S7.SS1.p2.5.m4.1.1.1.cmml">∈</mo><msup id="S7.SS1.p2.5.m4.1.1.3" xref="S7.SS1.p2.5.m4.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p2.5.m4.1.1.3.2" xref="S7.SS1.p2.5.m4.1.1.3.2.cmml">ℛ</mi><mrow id="S7.SS1.p2.5.m4.1.1.3.3" xref="S7.SS1.p2.5.m4.1.1.3.3.cmml"><msub id="S7.SS1.p2.5.m4.1.1.3.3.2" xref="S7.SS1.p2.5.m4.1.1.3.3.2.cmml"><mi id="S7.SS1.p2.5.m4.1.1.3.3.2.2" xref="S7.SS1.p2.5.m4.1.1.3.3.2.2.cmml">N</mi><mi id="S7.SS1.p2.5.m4.1.1.3.3.2.3" xref="S7.SS1.p2.5.m4.1.1.3.3.2.3.cmml">C</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S7.SS1.p2.5.m4.1.1.3.3.1" xref="S7.SS1.p2.5.m4.1.1.3.3.1.cmml">×</mo><msub id="S7.SS1.p2.5.m4.1.1.3.3.3" xref="S7.SS1.p2.5.m4.1.1.3.3.3.cmml"><mi id="S7.SS1.p2.5.m4.1.1.3.3.3.2" xref="S7.SS1.p2.5.m4.1.1.3.3.3.2.cmml">N</mi><mi id="S7.SS1.p2.5.m4.1.1.3.3.3.3" xref="S7.SS1.p2.5.m4.1.1.3.3.3.3.cmml">C</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S7.SS1.p2.5.m4.1b"><apply id="S7.SS1.p2.5.m4.1.1.cmml" xref="S7.SS1.p2.5.m4.1.1"><in id="S7.SS1.p2.5.m4.1.1.1.cmml" xref="S7.SS1.p2.5.m4.1.1.1"></in><apply id="S7.SS1.p2.5.m4.1.1.2.cmml" xref="S7.SS1.p2.5.m4.1.1.2"><csymbol cd="ambiguous" id="S7.SS1.p2.5.m4.1.1.2.1.cmml" xref="S7.SS1.p2.5.m4.1.1.2">subscript</csymbol><ci id="S7.SS1.p2.5.m4.1.1.2.2.cmml" xref="S7.SS1.p2.5.m4.1.1.2.2">𝐈</ci><apply id="S7.SS1.p2.5.m4.1.1.2.3.cmml" xref="S7.SS1.p2.5.m4.1.1.2.3"><csymbol cd="ambiguous" id="S7.SS1.p2.5.m4.1.1.2.3.1.cmml" xref="S7.SS1.p2.5.m4.1.1.2.3">subscript</csymbol><ci id="S7.SS1.p2.5.m4.1.1.2.3.2.cmml" xref="S7.SS1.p2.5.m4.1.1.2.3.2">𝑁</ci><ci id="S7.SS1.p2.5.m4.1.1.2.3.3.cmml" xref="S7.SS1.p2.5.m4.1.1.2.3.3">𝐶</ci></apply></apply><apply id="S7.SS1.p2.5.m4.1.1.3.cmml" xref="S7.SS1.p2.5.m4.1.1.3"><csymbol cd="ambiguous" id="S7.SS1.p2.5.m4.1.1.3.1.cmml" xref="S7.SS1.p2.5.m4.1.1.3">superscript</csymbol><ci id="S7.SS1.p2.5.m4.1.1.3.2.cmml" xref="S7.SS1.p2.5.m4.1.1.3.2">ℛ</ci><apply id="S7.SS1.p2.5.m4.1.1.3.3.cmml" xref="S7.SS1.p2.5.m4.1.1.3.3"><times id="S7.SS1.p2.5.m4.1.1.3.3.1.cmml" xref="S7.SS1.p2.5.m4.1.1.3.3.1"></times><apply id="S7.SS1.p2.5.m4.1.1.3.3.2.cmml" xref="S7.SS1.p2.5.m4.1.1.3.3.2"><csymbol cd="ambiguous" id="S7.SS1.p2.5.m4.1.1.3.3.2.1.cmml" xref="S7.SS1.p2.5.m4.1.1.3.3.2">subscript</csymbol><ci id="S7.SS1.p2.5.m4.1.1.3.3.2.2.cmml" xref="S7.SS1.p2.5.m4.1.1.3.3.2.2">𝑁</ci><ci id="S7.SS1.p2.5.m4.1.1.3.3.2.3.cmml" xref="S7.SS1.p2.5.m4.1.1.3.3.2.3">𝐶</ci></apply><apply id="S7.SS1.p2.5.m4.1.1.3.3.3.cmml" xref="S7.SS1.p2.5.m4.1.1.3.3.3"><csymbol cd="ambiguous" id="S7.SS1.p2.5.m4.1.1.3.3.3.1.cmml" xref="S7.SS1.p2.5.m4.1.1.3.3.3">subscript</csymbol><ci id="S7.SS1.p2.5.m4.1.1.3.3.3.2.cmml" xref="S7.SS1.p2.5.m4.1.1.3.3.3.2">𝑁</ci><ci id="S7.SS1.p2.5.m4.1.1.3.3.3.3.cmml" xref="S7.SS1.p2.5.m4.1.1.3.3.3.3">𝐶</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p2.5.m4.1c">\mathbf{I}_{N_{C}}\in\mathcal{R}^{N_{C}\times N_{C}}</annotation></semantics></math> and <math id="S7.SS1.p2.6.m5.1" class="ltx_Math" alttext="\mathbf{1}_{N_{C}}\in\mathcal{R}^{N_{C}}" display="inline"><semantics id="S7.SS1.p2.6.m5.1a"><mrow id="S7.SS1.p2.6.m5.1.1" xref="S7.SS1.p2.6.m5.1.1.cmml"><msub id="S7.SS1.p2.6.m5.1.1.2" xref="S7.SS1.p2.6.m5.1.1.2.cmml"><mn id="S7.SS1.p2.6.m5.1.1.2.2" xref="S7.SS1.p2.6.m5.1.1.2.2.cmml">𝟏</mn><msub id="S7.SS1.p2.6.m5.1.1.2.3" xref="S7.SS1.p2.6.m5.1.1.2.3.cmml"><mi id="S7.SS1.p2.6.m5.1.1.2.3.2" xref="S7.SS1.p2.6.m5.1.1.2.3.2.cmml">N</mi><mi id="S7.SS1.p2.6.m5.1.1.2.3.3" xref="S7.SS1.p2.6.m5.1.1.2.3.3.cmml">C</mi></msub></msub><mo id="S7.SS1.p2.6.m5.1.1.1" xref="S7.SS1.p2.6.m5.1.1.1.cmml">∈</mo><msup id="S7.SS1.p2.6.m5.1.1.3" xref="S7.SS1.p2.6.m5.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p2.6.m5.1.1.3.2" xref="S7.SS1.p2.6.m5.1.1.3.2.cmml">ℛ</mi><msub id="S7.SS1.p2.6.m5.1.1.3.3" xref="S7.SS1.p2.6.m5.1.1.3.3.cmml"><mi id="S7.SS1.p2.6.m5.1.1.3.3.2" xref="S7.SS1.p2.6.m5.1.1.3.3.2.cmml">N</mi><mi id="S7.SS1.p2.6.m5.1.1.3.3.3" xref="S7.SS1.p2.6.m5.1.1.3.3.3.cmml">C</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S7.SS1.p2.6.m5.1b"><apply id="S7.SS1.p2.6.m5.1.1.cmml" xref="S7.SS1.p2.6.m5.1.1"><in id="S7.SS1.p2.6.m5.1.1.1.cmml" xref="S7.SS1.p2.6.m5.1.1.1"></in><apply id="S7.SS1.p2.6.m5.1.1.2.cmml" xref="S7.SS1.p2.6.m5.1.1.2"><csymbol cd="ambiguous" id="S7.SS1.p2.6.m5.1.1.2.1.cmml" xref="S7.SS1.p2.6.m5.1.1.2">subscript</csymbol><cn type="integer" id="S7.SS1.p2.6.m5.1.1.2.2.cmml" xref="S7.SS1.p2.6.m5.1.1.2.2">1</cn><apply id="S7.SS1.p2.6.m5.1.1.2.3.cmml" xref="S7.SS1.p2.6.m5.1.1.2.3"><csymbol cd="ambiguous" id="S7.SS1.p2.6.m5.1.1.2.3.1.cmml" xref="S7.SS1.p2.6.m5.1.1.2.3">subscript</csymbol><ci id="S7.SS1.p2.6.m5.1.1.2.3.2.cmml" xref="S7.SS1.p2.6.m5.1.1.2.3.2">𝑁</ci><ci id="S7.SS1.p2.6.m5.1.1.2.3.3.cmml" xref="S7.SS1.p2.6.m5.1.1.2.3.3">𝐶</ci></apply></apply><apply id="S7.SS1.p2.6.m5.1.1.3.cmml" xref="S7.SS1.p2.6.m5.1.1.3"><csymbol cd="ambiguous" id="S7.SS1.p2.6.m5.1.1.3.1.cmml" xref="S7.SS1.p2.6.m5.1.1.3">superscript</csymbol><ci id="S7.SS1.p2.6.m5.1.1.3.2.cmml" xref="S7.SS1.p2.6.m5.1.1.3.2">ℛ</ci><apply id="S7.SS1.p2.6.m5.1.1.3.3.cmml" xref="S7.SS1.p2.6.m5.1.1.3.3"><csymbol cd="ambiguous" id="S7.SS1.p2.6.m5.1.1.3.3.1.cmml" xref="S7.SS1.p2.6.m5.1.1.3.3">subscript</csymbol><ci id="S7.SS1.p2.6.m5.1.1.3.3.2.cmml" xref="S7.SS1.p2.6.m5.1.1.3.3.2">𝑁</ci><ci id="S7.SS1.p2.6.m5.1.1.3.3.3.cmml" xref="S7.SS1.p2.6.m5.1.1.3.3.3">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p2.6.m5.1c">\mathbf{1}_{N_{C}}\in\mathcal{R}^{N_{C}}</annotation></semantics></math> denote the identity matrix and all-ones vector respectively. The rotation matrix <math id="S7.SS1.p2.7.m6.1" class="ltx_Math" alttext="\mathbf{U}\in\mathcal{R}^{d\times N_{C}}" display="inline"><semantics id="S7.SS1.p2.7.m6.1a"><mrow id="S7.SS1.p2.7.m6.1.1" xref="S7.SS1.p2.7.m6.1.1.cmml"><mi id="S7.SS1.p2.7.m6.1.1.2" xref="S7.SS1.p2.7.m6.1.1.2.cmml">𝐔</mi><mo id="S7.SS1.p2.7.m6.1.1.1" xref="S7.SS1.p2.7.m6.1.1.1.cmml">∈</mo><msup id="S7.SS1.p2.7.m6.1.1.3" xref="S7.SS1.p2.7.m6.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p2.7.m6.1.1.3.2" xref="S7.SS1.p2.7.m6.1.1.3.2.cmml">ℛ</mi><mrow id="S7.SS1.p2.7.m6.1.1.3.3" xref="S7.SS1.p2.7.m6.1.1.3.3.cmml"><mi id="S7.SS1.p2.7.m6.1.1.3.3.2" xref="S7.SS1.p2.7.m6.1.1.3.3.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="S7.SS1.p2.7.m6.1.1.3.3.1" xref="S7.SS1.p2.7.m6.1.1.3.3.1.cmml">×</mo><msub id="S7.SS1.p2.7.m6.1.1.3.3.3" xref="S7.SS1.p2.7.m6.1.1.3.3.3.cmml"><mi id="S7.SS1.p2.7.m6.1.1.3.3.3.2" xref="S7.SS1.p2.7.m6.1.1.3.3.3.2.cmml">N</mi><mi id="S7.SS1.p2.7.m6.1.1.3.3.3.3" xref="S7.SS1.p2.7.m6.1.1.3.3.3.3.cmml">C</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S7.SS1.p2.7.m6.1b"><apply id="S7.SS1.p2.7.m6.1.1.cmml" xref="S7.SS1.p2.7.m6.1.1"><in id="S7.SS1.p2.7.m6.1.1.1.cmml" xref="S7.SS1.p2.7.m6.1.1.1"></in><ci id="S7.SS1.p2.7.m6.1.1.2.cmml" xref="S7.SS1.p2.7.m6.1.1.2">𝐔</ci><apply id="S7.SS1.p2.7.m6.1.1.3.cmml" xref="S7.SS1.p2.7.m6.1.1.3"><csymbol cd="ambiguous" id="S7.SS1.p2.7.m6.1.1.3.1.cmml" xref="S7.SS1.p2.7.m6.1.1.3">superscript</csymbol><ci id="S7.SS1.p2.7.m6.1.1.3.2.cmml" xref="S7.SS1.p2.7.m6.1.1.3.2">ℛ</ci><apply id="S7.SS1.p2.7.m6.1.1.3.3.cmml" xref="S7.SS1.p2.7.m6.1.1.3.3"><times id="S7.SS1.p2.7.m6.1.1.3.3.1.cmml" xref="S7.SS1.p2.7.m6.1.1.3.3.1"></times><ci id="S7.SS1.p2.7.m6.1.1.3.3.2.cmml" xref="S7.SS1.p2.7.m6.1.1.3.3.2">𝑑</ci><apply id="S7.SS1.p2.7.m6.1.1.3.3.3.cmml" xref="S7.SS1.p2.7.m6.1.1.3.3.3"><csymbol cd="ambiguous" id="S7.SS1.p2.7.m6.1.1.3.3.3.1.cmml" xref="S7.SS1.p2.7.m6.1.1.3.3.3">subscript</csymbol><ci id="S7.SS1.p2.7.m6.1.1.3.3.3.2.cmml" xref="S7.SS1.p2.7.m6.1.1.3.3.3.2">𝑁</ci><ci id="S7.SS1.p2.7.m6.1.1.3.3.3.3.cmml" xref="S7.SS1.p2.7.m6.1.1.3.3.3.3">𝐶</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p2.7.m6.1c">\mathbf{U}\in\mathcal{R}^{d\times N_{C}}</annotation></semantics></math> satisfies <math id="S7.SS1.p2.8.m7.1" class="ltx_Math" alttext="\mathbf{U}^{T}\mathbf{U}=\mathbf{I}_{N_{C}}" display="inline"><semantics id="S7.SS1.p2.8.m7.1a"><mrow id="S7.SS1.p2.8.m7.1.1" xref="S7.SS1.p2.8.m7.1.1.cmml"><mrow id="S7.SS1.p2.8.m7.1.1.2" xref="S7.SS1.p2.8.m7.1.1.2.cmml"><msup id="S7.SS1.p2.8.m7.1.1.2.2" xref="S7.SS1.p2.8.m7.1.1.2.2.cmml"><mi id="S7.SS1.p2.8.m7.1.1.2.2.2" xref="S7.SS1.p2.8.m7.1.1.2.2.2.cmml">𝐔</mi><mi id="S7.SS1.p2.8.m7.1.1.2.2.3" xref="S7.SS1.p2.8.m7.1.1.2.2.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S7.SS1.p2.8.m7.1.1.2.1" xref="S7.SS1.p2.8.m7.1.1.2.1.cmml">​</mo><mi id="S7.SS1.p2.8.m7.1.1.2.3" xref="S7.SS1.p2.8.m7.1.1.2.3.cmml">𝐔</mi></mrow><mo id="S7.SS1.p2.8.m7.1.1.1" xref="S7.SS1.p2.8.m7.1.1.1.cmml">=</mo><msub id="S7.SS1.p2.8.m7.1.1.3" xref="S7.SS1.p2.8.m7.1.1.3.cmml"><mi id="S7.SS1.p2.8.m7.1.1.3.2" xref="S7.SS1.p2.8.m7.1.1.3.2.cmml">𝐈</mi><msub id="S7.SS1.p2.8.m7.1.1.3.3" xref="S7.SS1.p2.8.m7.1.1.3.3.cmml"><mi id="S7.SS1.p2.8.m7.1.1.3.3.2" xref="S7.SS1.p2.8.m7.1.1.3.3.2.cmml">N</mi><mi id="S7.SS1.p2.8.m7.1.1.3.3.3" xref="S7.SS1.p2.8.m7.1.1.3.3.3.cmml">C</mi></msub></msub></mrow><annotation-xml encoding="MathML-Content" id="S7.SS1.p2.8.m7.1b"><apply id="S7.SS1.p2.8.m7.1.1.cmml" xref="S7.SS1.p2.8.m7.1.1"><eq id="S7.SS1.p2.8.m7.1.1.1.cmml" xref="S7.SS1.p2.8.m7.1.1.1"></eq><apply id="S7.SS1.p2.8.m7.1.1.2.cmml" xref="S7.SS1.p2.8.m7.1.1.2"><times id="S7.SS1.p2.8.m7.1.1.2.1.cmml" xref="S7.SS1.p2.8.m7.1.1.2.1"></times><apply id="S7.SS1.p2.8.m7.1.1.2.2.cmml" xref="S7.SS1.p2.8.m7.1.1.2.2"><csymbol cd="ambiguous" id="S7.SS1.p2.8.m7.1.1.2.2.1.cmml" xref="S7.SS1.p2.8.m7.1.1.2.2">superscript</csymbol><ci id="S7.SS1.p2.8.m7.1.1.2.2.2.cmml" xref="S7.SS1.p2.8.m7.1.1.2.2.2">𝐔</ci><ci id="S7.SS1.p2.8.m7.1.1.2.2.3.cmml" xref="S7.SS1.p2.8.m7.1.1.2.2.3">𝑇</ci></apply><ci id="S7.SS1.p2.8.m7.1.1.2.3.cmml" xref="S7.SS1.p2.8.m7.1.1.2.3">𝐔</ci></apply><apply id="S7.SS1.p2.8.m7.1.1.3.cmml" xref="S7.SS1.p2.8.m7.1.1.3"><csymbol cd="ambiguous" id="S7.SS1.p2.8.m7.1.1.3.1.cmml" xref="S7.SS1.p2.8.m7.1.1.3">subscript</csymbol><ci id="S7.SS1.p2.8.m7.1.1.3.2.cmml" xref="S7.SS1.p2.8.m7.1.1.3.2">𝐈</ci><apply id="S7.SS1.p2.8.m7.1.1.3.3.cmml" xref="S7.SS1.p2.8.m7.1.1.3.3"><csymbol cd="ambiguous" id="S7.SS1.p2.8.m7.1.1.3.3.1.cmml" xref="S7.SS1.p2.8.m7.1.1.3.3">subscript</csymbol><ci id="S7.SS1.p2.8.m7.1.1.3.3.2.cmml" xref="S7.SS1.p2.8.m7.1.1.3.3.2">𝑁</ci><ci id="S7.SS1.p2.8.m7.1.1.3.3.3.cmml" xref="S7.SS1.p2.8.m7.1.1.3.3.3">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p2.8.m7.1c">\mathbf{U}^{T}\mathbf{U}=\mathbf{I}_{N_{C}}</annotation></semantics></math> and <math id="S7.SS1.p2.9.m8.1" class="ltx_Math" alttext="d\geq N_{C}-1" display="inline"><semantics id="S7.SS1.p2.9.m8.1a"><mrow id="S7.SS1.p2.9.m8.1.1" xref="S7.SS1.p2.9.m8.1.1.cmml"><mi id="S7.SS1.p2.9.m8.1.1.2" xref="S7.SS1.p2.9.m8.1.1.2.cmml">d</mi><mo id="S7.SS1.p2.9.m8.1.1.1" xref="S7.SS1.p2.9.m8.1.1.1.cmml">≥</mo><mrow id="S7.SS1.p2.9.m8.1.1.3" xref="S7.SS1.p2.9.m8.1.1.3.cmml"><msub id="S7.SS1.p2.9.m8.1.1.3.2" xref="S7.SS1.p2.9.m8.1.1.3.2.cmml"><mi id="S7.SS1.p2.9.m8.1.1.3.2.2" xref="S7.SS1.p2.9.m8.1.1.3.2.2.cmml">N</mi><mi id="S7.SS1.p2.9.m8.1.1.3.2.3" xref="S7.SS1.p2.9.m8.1.1.3.2.3.cmml">C</mi></msub><mo id="S7.SS1.p2.9.m8.1.1.3.1" xref="S7.SS1.p2.9.m8.1.1.3.1.cmml">−</mo><mn id="S7.SS1.p2.9.m8.1.1.3.3" xref="S7.SS1.p2.9.m8.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.SS1.p2.9.m8.1b"><apply id="S7.SS1.p2.9.m8.1.1.cmml" xref="S7.SS1.p2.9.m8.1.1"><geq id="S7.SS1.p2.9.m8.1.1.1.cmml" xref="S7.SS1.p2.9.m8.1.1.1"></geq><ci id="S7.SS1.p2.9.m8.1.1.2.cmml" xref="S7.SS1.p2.9.m8.1.1.2">𝑑</ci><apply id="S7.SS1.p2.9.m8.1.1.3.cmml" xref="S7.SS1.p2.9.m8.1.1.3"><minus id="S7.SS1.p2.9.m8.1.1.3.1.cmml" xref="S7.SS1.p2.9.m8.1.1.3.1"></minus><apply id="S7.SS1.p2.9.m8.1.1.3.2.cmml" xref="S7.SS1.p2.9.m8.1.1.3.2"><csymbol cd="ambiguous" id="S7.SS1.p2.9.m8.1.1.3.2.1.cmml" xref="S7.SS1.p2.9.m8.1.1.3.2">subscript</csymbol><ci id="S7.SS1.p2.9.m8.1.1.3.2.2.cmml" xref="S7.SS1.p2.9.m8.1.1.3.2.2">𝑁</ci><ci id="S7.SS1.p2.9.m8.1.1.3.2.3.cmml" xref="S7.SS1.p2.9.m8.1.1.3.2.3">𝐶</ci></apply><cn type="integer" id="S7.SS1.p2.9.m8.1.1.3.3.cmml" xref="S7.SS1.p2.9.m8.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p2.9.m8.1c">d\geq N_{C}-1</annotation></semantics></math>.
In this way, for all vectors in a simplex ETF, their pair-wise angles are identical, <em id="S7.SS1.p2.9.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S7.SS1.p2.9.2" class="ltx_text"></span>,</p>
<table id="S7.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S7.E6.m1.4" class="ltx_Math" alttext="\mathbf{w}_{i}^{\prime T}\mathbf{w}_{j}^{\prime}=-\frac{1}{{N_{C}}-1},\forall i,j\in[1,{N_{C}}]~{}~{}\text{and}~{}~{}i\neq j," display="block"><semantics id="S7.E6.m1.4a"><mrow id="S7.E6.m1.4.4.1"><mrow id="S7.E6.m1.4.4.1.1.2" xref="S7.E6.m1.4.4.1.1.3.cmml"><mrow id="S7.E6.m1.4.4.1.1.1.1" xref="S7.E6.m1.4.4.1.1.1.1.cmml"><mrow id="S7.E6.m1.4.4.1.1.1.1.4" xref="S7.E6.m1.4.4.1.1.1.1.4.cmml"><msubsup id="S7.E6.m1.4.4.1.1.1.1.4.2" xref="S7.E6.m1.4.4.1.1.1.1.4.2.cmml"><mi id="S7.E6.m1.4.4.1.1.1.1.4.2.2.2" xref="S7.E6.m1.4.4.1.1.1.1.4.2.2.2.cmml">𝐰</mi><mi id="S7.E6.m1.4.4.1.1.1.1.4.2.2.3" xref="S7.E6.m1.4.4.1.1.1.1.4.2.2.3.cmml">i</mi><mrow id="S7.E6.m1.2.2.2.2" xref="S7.E6.m1.2.2.2.3.cmml"><mo mathsize="142%" id="S7.E6.m1.2.2.2.2.1" xref="S7.E6.m1.2.2.2.2.1.cmml">′</mo><mo lspace="0em" id="S7.E6.m1.2.2.2.2.2" xref="S7.E6.m1.2.2.2.3.cmml">⁣</mo><mi id="S7.E6.m1.1.1.1.1" xref="S7.E6.m1.1.1.1.1.cmml">T</mi></mrow></msubsup><mo lspace="0em" rspace="0em" id="S7.E6.m1.4.4.1.1.1.1.4.1" xref="S7.E6.m1.4.4.1.1.1.1.4.1.cmml">​</mo><msubsup id="S7.E6.m1.4.4.1.1.1.1.4.3" xref="S7.E6.m1.4.4.1.1.1.1.4.3.cmml"><mi id="S7.E6.m1.4.4.1.1.1.1.4.3.2.2" xref="S7.E6.m1.4.4.1.1.1.1.4.3.2.2.cmml">𝐰</mi><mi id="S7.E6.m1.4.4.1.1.1.1.4.3.2.3" xref="S7.E6.m1.4.4.1.1.1.1.4.3.2.3.cmml">j</mi><mo id="S7.E6.m1.4.4.1.1.1.1.4.3.3" xref="S7.E6.m1.4.4.1.1.1.1.4.3.3.cmml">′</mo></msubsup></mrow><mo id="S7.E6.m1.4.4.1.1.1.1.3" xref="S7.E6.m1.4.4.1.1.1.1.3.cmml">=</mo><mrow id="S7.E6.m1.4.4.1.1.1.1.2.2" xref="S7.E6.m1.4.4.1.1.1.1.2.3.cmml"><mrow id="S7.E6.m1.4.4.1.1.1.1.1.1.1" xref="S7.E6.m1.4.4.1.1.1.1.1.1.1.cmml"><mo id="S7.E6.m1.4.4.1.1.1.1.1.1.1a" xref="S7.E6.m1.4.4.1.1.1.1.1.1.1.cmml">−</mo><mfrac id="S7.E6.m1.4.4.1.1.1.1.1.1.1.2" xref="S7.E6.m1.4.4.1.1.1.1.1.1.1.2.cmml"><mn id="S7.E6.m1.4.4.1.1.1.1.1.1.1.2.2" xref="S7.E6.m1.4.4.1.1.1.1.1.1.1.2.2.cmml">1</mn><mrow id="S7.E6.m1.4.4.1.1.1.1.1.1.1.2.3" xref="S7.E6.m1.4.4.1.1.1.1.1.1.1.2.3.cmml"><msub id="S7.E6.m1.4.4.1.1.1.1.1.1.1.2.3.2" xref="S7.E6.m1.4.4.1.1.1.1.1.1.1.2.3.2.cmml"><mi id="S7.E6.m1.4.4.1.1.1.1.1.1.1.2.3.2.2" xref="S7.E6.m1.4.4.1.1.1.1.1.1.1.2.3.2.2.cmml">N</mi><mi id="S7.E6.m1.4.4.1.1.1.1.1.1.1.2.3.2.3" xref="S7.E6.m1.4.4.1.1.1.1.1.1.1.2.3.2.3.cmml">C</mi></msub><mo id="S7.E6.m1.4.4.1.1.1.1.1.1.1.2.3.1" xref="S7.E6.m1.4.4.1.1.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="S7.E6.m1.4.4.1.1.1.1.1.1.1.2.3.3" xref="S7.E6.m1.4.4.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></mfrac></mrow><mo id="S7.E6.m1.4.4.1.1.1.1.2.2.3" xref="S7.E6.m1.4.4.1.1.1.1.2.3.cmml">,</mo><mrow id="S7.E6.m1.4.4.1.1.1.1.2.2.2" xref="S7.E6.m1.4.4.1.1.1.1.2.2.2.cmml"><mo rspace="0.167em" id="S7.E6.m1.4.4.1.1.1.1.2.2.2.1" xref="S7.E6.m1.4.4.1.1.1.1.2.2.2.1.cmml">∀</mo><mi id="S7.E6.m1.4.4.1.1.1.1.2.2.2.2" xref="S7.E6.m1.4.4.1.1.1.1.2.2.2.2.cmml">i</mi></mrow></mrow></mrow><mo id="S7.E6.m1.4.4.1.1.2.3" xref="S7.E6.m1.4.4.1.1.3a.cmml">,</mo><mrow id="S7.E6.m1.4.4.1.1.2.2" xref="S7.E6.m1.4.4.1.1.2.2.cmml"><mi id="S7.E6.m1.4.4.1.1.2.2.3" xref="S7.E6.m1.4.4.1.1.2.2.3.cmml">j</mi><mo id="S7.E6.m1.4.4.1.1.2.2.4" xref="S7.E6.m1.4.4.1.1.2.2.4.cmml">∈</mo><mrow id="S7.E6.m1.4.4.1.1.2.2.1" xref="S7.E6.m1.4.4.1.1.2.2.1.cmml"><mrow id="S7.E6.m1.4.4.1.1.2.2.1.1.1" xref="S7.E6.m1.4.4.1.1.2.2.1.1.2.cmml"><mo stretchy="false" id="S7.E6.m1.4.4.1.1.2.2.1.1.1.2" xref="S7.E6.m1.4.4.1.1.2.2.1.1.2.cmml">[</mo><mn id="S7.E6.m1.3.3" xref="S7.E6.m1.3.3.cmml">1</mn><mo id="S7.E6.m1.4.4.1.1.2.2.1.1.1.3" xref="S7.E6.m1.4.4.1.1.2.2.1.1.2.cmml">,</mo><msub id="S7.E6.m1.4.4.1.1.2.2.1.1.1.1" xref="S7.E6.m1.4.4.1.1.2.2.1.1.1.1.cmml"><mi id="S7.E6.m1.4.4.1.1.2.2.1.1.1.1.2" xref="S7.E6.m1.4.4.1.1.2.2.1.1.1.1.2.cmml">N</mi><mi id="S7.E6.m1.4.4.1.1.2.2.1.1.1.1.3" xref="S7.E6.m1.4.4.1.1.2.2.1.1.1.1.3.cmml">C</mi></msub><mo stretchy="false" id="S7.E6.m1.4.4.1.1.2.2.1.1.1.4" xref="S7.E6.m1.4.4.1.1.2.2.1.1.2.cmml">]</mo></mrow><mo lspace="0.660em" rspace="0em" id="S7.E6.m1.4.4.1.1.2.2.1.2" xref="S7.E6.m1.4.4.1.1.2.2.1.2.cmml">​</mo><mtext id="S7.E6.m1.4.4.1.1.2.2.1.3" xref="S7.E6.m1.4.4.1.1.2.2.1.3a.cmml">and</mtext><mo lspace="0.660em" rspace="0em" id="S7.E6.m1.4.4.1.1.2.2.1.2a" xref="S7.E6.m1.4.4.1.1.2.2.1.2.cmml">​</mo><mi id="S7.E6.m1.4.4.1.1.2.2.1.4" xref="S7.E6.m1.4.4.1.1.2.2.1.4.cmml">i</mi></mrow><mo id="S7.E6.m1.4.4.1.1.2.2.5" xref="S7.E6.m1.4.4.1.1.2.2.5.cmml">≠</mo><mi id="S7.E6.m1.4.4.1.1.2.2.6" xref="S7.E6.m1.4.4.1.1.2.2.6.cmml">j</mi></mrow></mrow><mo id="S7.E6.m1.4.4.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S7.E6.m1.4b"><apply id="S7.E6.m1.4.4.1.1.3.cmml" xref="S7.E6.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="S7.E6.m1.4.4.1.1.3a.cmml" xref="S7.E6.m1.4.4.1.1.2.3">formulae-sequence</csymbol><apply id="S7.E6.m1.4.4.1.1.1.1.cmml" xref="S7.E6.m1.4.4.1.1.1.1"><eq id="S7.E6.m1.4.4.1.1.1.1.3.cmml" xref="S7.E6.m1.4.4.1.1.1.1.3"></eq><apply id="S7.E6.m1.4.4.1.1.1.1.4.cmml" xref="S7.E6.m1.4.4.1.1.1.1.4"><times id="S7.E6.m1.4.4.1.1.1.1.4.1.cmml" xref="S7.E6.m1.4.4.1.1.1.1.4.1"></times><apply id="S7.E6.m1.4.4.1.1.1.1.4.2.cmml" xref="S7.E6.m1.4.4.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S7.E6.m1.4.4.1.1.1.1.4.2.1.cmml" xref="S7.E6.m1.4.4.1.1.1.1.4.2">superscript</csymbol><apply id="S7.E6.m1.4.4.1.1.1.1.4.2.2.cmml" xref="S7.E6.m1.4.4.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S7.E6.m1.4.4.1.1.1.1.4.2.2.1.cmml" xref="S7.E6.m1.4.4.1.1.1.1.4.2">subscript</csymbol><ci id="S7.E6.m1.4.4.1.1.1.1.4.2.2.2.cmml" xref="S7.E6.m1.4.4.1.1.1.1.4.2.2.2">𝐰</ci><ci id="S7.E6.m1.4.4.1.1.1.1.4.2.2.3.cmml" xref="S7.E6.m1.4.4.1.1.1.1.4.2.2.3">𝑖</ci></apply><list id="S7.E6.m1.2.2.2.3.cmml" xref="S7.E6.m1.2.2.2.2"><ci id="S7.E6.m1.2.2.2.2.1.cmml" xref="S7.E6.m1.2.2.2.2.1">′</ci><ci id="S7.E6.m1.1.1.1.1.cmml" xref="S7.E6.m1.1.1.1.1">𝑇</ci></list></apply><apply id="S7.E6.m1.4.4.1.1.1.1.4.3.cmml" xref="S7.E6.m1.4.4.1.1.1.1.4.3"><csymbol cd="ambiguous" id="S7.E6.m1.4.4.1.1.1.1.4.3.1.cmml" xref="S7.E6.m1.4.4.1.1.1.1.4.3">superscript</csymbol><apply id="S7.E6.m1.4.4.1.1.1.1.4.3.2.cmml" xref="S7.E6.m1.4.4.1.1.1.1.4.3"><csymbol cd="ambiguous" id="S7.E6.m1.4.4.1.1.1.1.4.3.2.1.cmml" xref="S7.E6.m1.4.4.1.1.1.1.4.3">subscript</csymbol><ci id="S7.E6.m1.4.4.1.1.1.1.4.3.2.2.cmml" xref="S7.E6.m1.4.4.1.1.1.1.4.3.2.2">𝐰</ci><ci id="S7.E6.m1.4.4.1.1.1.1.4.3.2.3.cmml" xref="S7.E6.m1.4.4.1.1.1.1.4.3.2.3">𝑗</ci></apply><ci id="S7.E6.m1.4.4.1.1.1.1.4.3.3.cmml" xref="S7.E6.m1.4.4.1.1.1.1.4.3.3">′</ci></apply></apply><list id="S7.E6.m1.4.4.1.1.1.1.2.3.cmml" xref="S7.E6.m1.4.4.1.1.1.1.2.2"><apply id="S7.E6.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S7.E6.m1.4.4.1.1.1.1.1.1.1"><minus id="S7.E6.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S7.E6.m1.4.4.1.1.1.1.1.1.1"></minus><apply id="S7.E6.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S7.E6.m1.4.4.1.1.1.1.1.1.1.2"><divide id="S7.E6.m1.4.4.1.1.1.1.1.1.1.2.1.cmml" xref="S7.E6.m1.4.4.1.1.1.1.1.1.1.2"></divide><cn type="integer" id="S7.E6.m1.4.4.1.1.1.1.1.1.1.2.2.cmml" xref="S7.E6.m1.4.4.1.1.1.1.1.1.1.2.2">1</cn><apply id="S7.E6.m1.4.4.1.1.1.1.1.1.1.2.3.cmml" xref="S7.E6.m1.4.4.1.1.1.1.1.1.1.2.3"><minus id="S7.E6.m1.4.4.1.1.1.1.1.1.1.2.3.1.cmml" xref="S7.E6.m1.4.4.1.1.1.1.1.1.1.2.3.1"></minus><apply id="S7.E6.m1.4.4.1.1.1.1.1.1.1.2.3.2.cmml" xref="S7.E6.m1.4.4.1.1.1.1.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S7.E6.m1.4.4.1.1.1.1.1.1.1.2.3.2.1.cmml" xref="S7.E6.m1.4.4.1.1.1.1.1.1.1.2.3.2">subscript</csymbol><ci id="S7.E6.m1.4.4.1.1.1.1.1.1.1.2.3.2.2.cmml" xref="S7.E6.m1.4.4.1.1.1.1.1.1.1.2.3.2.2">𝑁</ci><ci id="S7.E6.m1.4.4.1.1.1.1.1.1.1.2.3.2.3.cmml" xref="S7.E6.m1.4.4.1.1.1.1.1.1.1.2.3.2.3">𝐶</ci></apply><cn type="integer" id="S7.E6.m1.4.4.1.1.1.1.1.1.1.2.3.3.cmml" xref="S7.E6.m1.4.4.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply></apply><apply id="S7.E6.m1.4.4.1.1.1.1.2.2.2.cmml" xref="S7.E6.m1.4.4.1.1.1.1.2.2.2"><csymbol cd="latexml" id="S7.E6.m1.4.4.1.1.1.1.2.2.2.1.cmml" xref="S7.E6.m1.4.4.1.1.1.1.2.2.2.1">for-all</csymbol><ci id="S7.E6.m1.4.4.1.1.1.1.2.2.2.2.cmml" xref="S7.E6.m1.4.4.1.1.1.1.2.2.2.2">𝑖</ci></apply></list></apply><apply id="S7.E6.m1.4.4.1.1.2.2.cmml" xref="S7.E6.m1.4.4.1.1.2.2"><and id="S7.E6.m1.4.4.1.1.2.2a.cmml" xref="S7.E6.m1.4.4.1.1.2.2"></and><apply id="S7.E6.m1.4.4.1.1.2.2b.cmml" xref="S7.E6.m1.4.4.1.1.2.2"><in id="S7.E6.m1.4.4.1.1.2.2.4.cmml" xref="S7.E6.m1.4.4.1.1.2.2.4"></in><ci id="S7.E6.m1.4.4.1.1.2.2.3.cmml" xref="S7.E6.m1.4.4.1.1.2.2.3">𝑗</ci><apply id="S7.E6.m1.4.4.1.1.2.2.1.cmml" xref="S7.E6.m1.4.4.1.1.2.2.1"><times id="S7.E6.m1.4.4.1.1.2.2.1.2.cmml" xref="S7.E6.m1.4.4.1.1.2.2.1.2"></times><interval closure="closed" id="S7.E6.m1.4.4.1.1.2.2.1.1.2.cmml" xref="S7.E6.m1.4.4.1.1.2.2.1.1.1"><cn type="integer" id="S7.E6.m1.3.3.cmml" xref="S7.E6.m1.3.3">1</cn><apply id="S7.E6.m1.4.4.1.1.2.2.1.1.1.1.cmml" xref="S7.E6.m1.4.4.1.1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S7.E6.m1.4.4.1.1.2.2.1.1.1.1.1.cmml" xref="S7.E6.m1.4.4.1.1.2.2.1.1.1.1">subscript</csymbol><ci id="S7.E6.m1.4.4.1.1.2.2.1.1.1.1.2.cmml" xref="S7.E6.m1.4.4.1.1.2.2.1.1.1.1.2">𝑁</ci><ci id="S7.E6.m1.4.4.1.1.2.2.1.1.1.1.3.cmml" xref="S7.E6.m1.4.4.1.1.2.2.1.1.1.1.3">𝐶</ci></apply></interval><ci id="S7.E6.m1.4.4.1.1.2.2.1.3a.cmml" xref="S7.E6.m1.4.4.1.1.2.2.1.3"><mtext id="S7.E6.m1.4.4.1.1.2.2.1.3.cmml" xref="S7.E6.m1.4.4.1.1.2.2.1.3">and</mtext></ci><ci id="S7.E6.m1.4.4.1.1.2.2.1.4.cmml" xref="S7.E6.m1.4.4.1.1.2.2.1.4">𝑖</ci></apply></apply><apply id="S7.E6.m1.4.4.1.1.2.2c.cmml" xref="S7.E6.m1.4.4.1.1.2.2"><neq id="S7.E6.m1.4.4.1.1.2.2.5.cmml" xref="S7.E6.m1.4.4.1.1.2.2.5"></neq><share href="#S7.E6.m1.4.4.1.1.2.2.1.cmml" id="S7.E6.m1.4.4.1.1.2.2d.cmml" xref="S7.E6.m1.4.4.1.1.2.2"></share><ci id="S7.E6.m1.4.4.1.1.2.2.6.cmml" xref="S7.E6.m1.4.4.1.1.2.2.6">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.E6.m1.4c">\mathbf{w}_{i}^{\prime T}\mathbf{w}_{j}^{\prime}=-\frac{1}{{N_{C}}-1},\forall i,j\in[1,{N_{C}}]~{}~{}\text{and}~{}~{}i\neq j,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S7.SS1.p2.11" class="ltx_p">where the angle <math id="S7.SS1.p2.10.m1.1" class="ltx_Math" alttext="arccos(-\frac{1}{{N_{C}}-1})" display="inline"><semantics id="S7.SS1.p2.10.m1.1a"><mrow id="S7.SS1.p2.10.m1.1.1" xref="S7.SS1.p2.10.m1.1.1.cmml"><mi id="S7.SS1.p2.10.m1.1.1.3" xref="S7.SS1.p2.10.m1.1.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S7.SS1.p2.10.m1.1.1.2" xref="S7.SS1.p2.10.m1.1.1.2.cmml">​</mo><mi id="S7.SS1.p2.10.m1.1.1.4" xref="S7.SS1.p2.10.m1.1.1.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S7.SS1.p2.10.m1.1.1.2a" xref="S7.SS1.p2.10.m1.1.1.2.cmml">​</mo><mi id="S7.SS1.p2.10.m1.1.1.5" xref="S7.SS1.p2.10.m1.1.1.5.cmml">c</mi><mo lspace="0em" rspace="0em" id="S7.SS1.p2.10.m1.1.1.2b" xref="S7.SS1.p2.10.m1.1.1.2.cmml">​</mo><mi id="S7.SS1.p2.10.m1.1.1.6" xref="S7.SS1.p2.10.m1.1.1.6.cmml">c</mi><mo lspace="0em" rspace="0em" id="S7.SS1.p2.10.m1.1.1.2c" xref="S7.SS1.p2.10.m1.1.1.2.cmml">​</mo><mi id="S7.SS1.p2.10.m1.1.1.7" xref="S7.SS1.p2.10.m1.1.1.7.cmml">o</mi><mo lspace="0em" rspace="0em" id="S7.SS1.p2.10.m1.1.1.2d" xref="S7.SS1.p2.10.m1.1.1.2.cmml">​</mo><mi id="S7.SS1.p2.10.m1.1.1.8" xref="S7.SS1.p2.10.m1.1.1.8.cmml">s</mi><mo lspace="0em" rspace="0em" id="S7.SS1.p2.10.m1.1.1.2e" xref="S7.SS1.p2.10.m1.1.1.2.cmml">​</mo><mrow id="S7.SS1.p2.10.m1.1.1.1.1" xref="S7.SS1.p2.10.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S7.SS1.p2.10.m1.1.1.1.1.2" xref="S7.SS1.p2.10.m1.1.1.1.1.1.cmml">(</mo><mrow id="S7.SS1.p2.10.m1.1.1.1.1.1" xref="S7.SS1.p2.10.m1.1.1.1.1.1.cmml"><mo id="S7.SS1.p2.10.m1.1.1.1.1.1a" xref="S7.SS1.p2.10.m1.1.1.1.1.1.cmml">−</mo><mfrac id="S7.SS1.p2.10.m1.1.1.1.1.1.2" xref="S7.SS1.p2.10.m1.1.1.1.1.1.2.cmml"><mn id="S7.SS1.p2.10.m1.1.1.1.1.1.2.2" xref="S7.SS1.p2.10.m1.1.1.1.1.1.2.2.cmml">1</mn><mrow id="S7.SS1.p2.10.m1.1.1.1.1.1.2.3" xref="S7.SS1.p2.10.m1.1.1.1.1.1.2.3.cmml"><msub id="S7.SS1.p2.10.m1.1.1.1.1.1.2.3.2" xref="S7.SS1.p2.10.m1.1.1.1.1.1.2.3.2.cmml"><mi id="S7.SS1.p2.10.m1.1.1.1.1.1.2.3.2.2" xref="S7.SS1.p2.10.m1.1.1.1.1.1.2.3.2.2.cmml">N</mi><mi id="S7.SS1.p2.10.m1.1.1.1.1.1.2.3.2.3" xref="S7.SS1.p2.10.m1.1.1.1.1.1.2.3.2.3.cmml">C</mi></msub><mo id="S7.SS1.p2.10.m1.1.1.1.1.1.2.3.1" xref="S7.SS1.p2.10.m1.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="S7.SS1.p2.10.m1.1.1.1.1.1.2.3.3" xref="S7.SS1.p2.10.m1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></mfrac></mrow><mo stretchy="false" id="S7.SS1.p2.10.m1.1.1.1.1.3" xref="S7.SS1.p2.10.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.SS1.p2.10.m1.1b"><apply id="S7.SS1.p2.10.m1.1.1.cmml" xref="S7.SS1.p2.10.m1.1.1"><times id="S7.SS1.p2.10.m1.1.1.2.cmml" xref="S7.SS1.p2.10.m1.1.1.2"></times><ci id="S7.SS1.p2.10.m1.1.1.3.cmml" xref="S7.SS1.p2.10.m1.1.1.3">𝑎</ci><ci id="S7.SS1.p2.10.m1.1.1.4.cmml" xref="S7.SS1.p2.10.m1.1.1.4">𝑟</ci><ci id="S7.SS1.p2.10.m1.1.1.5.cmml" xref="S7.SS1.p2.10.m1.1.1.5">𝑐</ci><ci id="S7.SS1.p2.10.m1.1.1.6.cmml" xref="S7.SS1.p2.10.m1.1.1.6">𝑐</ci><ci id="S7.SS1.p2.10.m1.1.1.7.cmml" xref="S7.SS1.p2.10.m1.1.1.7">𝑜</ci><ci id="S7.SS1.p2.10.m1.1.1.8.cmml" xref="S7.SS1.p2.10.m1.1.1.8">𝑠</ci><apply id="S7.SS1.p2.10.m1.1.1.1.1.1.cmml" xref="S7.SS1.p2.10.m1.1.1.1.1"><minus id="S7.SS1.p2.10.m1.1.1.1.1.1.1.cmml" xref="S7.SS1.p2.10.m1.1.1.1.1"></minus><apply id="S7.SS1.p2.10.m1.1.1.1.1.1.2.cmml" xref="S7.SS1.p2.10.m1.1.1.1.1.1.2"><divide id="S7.SS1.p2.10.m1.1.1.1.1.1.2.1.cmml" xref="S7.SS1.p2.10.m1.1.1.1.1.1.2"></divide><cn type="integer" id="S7.SS1.p2.10.m1.1.1.1.1.1.2.2.cmml" xref="S7.SS1.p2.10.m1.1.1.1.1.1.2.2">1</cn><apply id="S7.SS1.p2.10.m1.1.1.1.1.1.2.3.cmml" xref="S7.SS1.p2.10.m1.1.1.1.1.1.2.3"><minus id="S7.SS1.p2.10.m1.1.1.1.1.1.2.3.1.cmml" xref="S7.SS1.p2.10.m1.1.1.1.1.1.2.3.1"></minus><apply id="S7.SS1.p2.10.m1.1.1.1.1.1.2.3.2.cmml" xref="S7.SS1.p2.10.m1.1.1.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S7.SS1.p2.10.m1.1.1.1.1.1.2.3.2.1.cmml" xref="S7.SS1.p2.10.m1.1.1.1.1.1.2.3.2">subscript</csymbol><ci id="S7.SS1.p2.10.m1.1.1.1.1.1.2.3.2.2.cmml" xref="S7.SS1.p2.10.m1.1.1.1.1.1.2.3.2.2">𝑁</ci><ci id="S7.SS1.p2.10.m1.1.1.1.1.1.2.3.2.3.cmml" xref="S7.SS1.p2.10.m1.1.1.1.1.1.2.3.2.3">𝐶</ci></apply><cn type="integer" id="S7.SS1.p2.10.m1.1.1.1.1.1.2.3.3.cmml" xref="S7.SS1.p2.10.m1.1.1.1.1.1.2.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p2.10.m1.1c">arccos(-\frac{1}{{N_{C}}-1})</annotation></semantics></math> shown in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite> ans is the maximal equiangular angle of <math id="S7.SS1.p2.11.m2.1" class="ltx_Math" alttext="N_{C}" display="inline"><semantics id="S7.SS1.p2.11.m2.1a"><msub id="S7.SS1.p2.11.m2.1.1" xref="S7.SS1.p2.11.m2.1.1.cmml"><mi id="S7.SS1.p2.11.m2.1.1.2" xref="S7.SS1.p2.11.m2.1.1.2.cmml">N</mi><mi id="S7.SS1.p2.11.m2.1.1.3" xref="S7.SS1.p2.11.m2.1.1.3.cmml">C</mi></msub><annotation-xml encoding="MathML-Content" id="S7.SS1.p2.11.m2.1b"><apply id="S7.SS1.p2.11.m2.1.1.cmml" xref="S7.SS1.p2.11.m2.1.1"><csymbol cd="ambiguous" id="S7.SS1.p2.11.m2.1.1.1.cmml" xref="S7.SS1.p2.11.m2.1.1">subscript</csymbol><ci id="S7.SS1.p2.11.m2.1.1.2.cmml" xref="S7.SS1.p2.11.m2.1.1.2">𝑁</ci><ci id="S7.SS1.p2.11.m2.1.1.3.cmml" xref="S7.SS1.p2.11.m2.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p2.11.m2.1c">N_{C}</annotation></semantics></math> vectors in the feature space.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Iterative algorithm for obtaining Simplex ETF)</figcaption>
<div id="alg1.3" class="ltx_listing ltx_listing">
<div id="algx1.l1" class="ltx_listingline">  <span id="algx1.l1.1" class="ltx_text ltx_font_bold">Input:</span> Number of classes <math id="algx1.l1.m1.1" class="ltx_Math" alttext="N_{C}" display="inline"><semantics id="algx1.l1.m1.1a"><msub id="algx1.l1.m1.1.1" xref="algx1.l1.m1.1.1.cmml"><mi id="algx1.l1.m1.1.1.2" xref="algx1.l1.m1.1.1.2.cmml">N</mi><mi id="algx1.l1.m1.1.1.3" xref="algx1.l1.m1.1.1.3.cmml">C</mi></msub><annotation-xml encoding="MathML-Content" id="algx1.l1.m1.1b"><apply id="algx1.l1.m1.1.1.cmml" xref="algx1.l1.m1.1.1"><csymbol cd="ambiguous" id="algx1.l1.m1.1.1.1.cmml" xref="algx1.l1.m1.1.1">subscript</csymbol><ci id="algx1.l1.m1.1.1.2.cmml" xref="algx1.l1.m1.1.1.2">𝑁</ci><ci id="algx1.l1.m1.1.1.3.cmml" xref="algx1.l1.m1.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l1.m1.1c">N_{C}</annotation></semantics></math>, feat. dim <math id="algx1.l1.m2.1" class="ltx_Math" alttext="d" display="inline"><semantics id="algx1.l1.m2.1a"><mi id="algx1.l1.m2.1.1" xref="algx1.l1.m2.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="algx1.l1.m2.1b"><ci id="algx1.l1.m2.1.1.cmml" xref="algx1.l1.m2.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l1.m2.1c">d</annotation></semantics></math> where <math id="algx1.l1.m3.1" class="ltx_Math" alttext="d\leq N_{C}-1" display="inline"><semantics id="algx1.l1.m3.1a"><mrow id="algx1.l1.m3.1.1" xref="algx1.l1.m3.1.1.cmml"><mi id="algx1.l1.m3.1.1.2" xref="algx1.l1.m3.1.1.2.cmml">d</mi><mo id="algx1.l1.m3.1.1.1" xref="algx1.l1.m3.1.1.1.cmml">≤</mo><mrow id="algx1.l1.m3.1.1.3" xref="algx1.l1.m3.1.1.3.cmml"><msub id="algx1.l1.m3.1.1.3.2" xref="algx1.l1.m3.1.1.3.2.cmml"><mi id="algx1.l1.m3.1.1.3.2.2" xref="algx1.l1.m3.1.1.3.2.2.cmml">N</mi><mi id="algx1.l1.m3.1.1.3.2.3" xref="algx1.l1.m3.1.1.3.2.3.cmml">C</mi></msub><mo id="algx1.l1.m3.1.1.3.1" xref="algx1.l1.m3.1.1.3.1.cmml">−</mo><mn id="algx1.l1.m3.1.1.3.3" xref="algx1.l1.m3.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx1.l1.m3.1b"><apply id="algx1.l1.m3.1.1.cmml" xref="algx1.l1.m3.1.1"><leq id="algx1.l1.m3.1.1.1.cmml" xref="algx1.l1.m3.1.1.1"></leq><ci id="algx1.l1.m3.1.1.2.cmml" xref="algx1.l1.m3.1.1.2">𝑑</ci><apply id="algx1.l1.m3.1.1.3.cmml" xref="algx1.l1.m3.1.1.3"><minus id="algx1.l1.m3.1.1.3.1.cmml" xref="algx1.l1.m3.1.1.3.1"></minus><apply id="algx1.l1.m3.1.1.3.2.cmml" xref="algx1.l1.m3.1.1.3.2"><csymbol cd="ambiguous" id="algx1.l1.m3.1.1.3.2.1.cmml" xref="algx1.l1.m3.1.1.3.2">subscript</csymbol><ci id="algx1.l1.m3.1.1.3.2.2.cmml" xref="algx1.l1.m3.1.1.3.2.2">𝑁</ci><ci id="algx1.l1.m3.1.1.3.2.3.cmml" xref="algx1.l1.m3.1.1.3.2.3">𝐶</ci></apply><cn type="integer" id="algx1.l1.m3.1.1.3.3.cmml" xref="algx1.l1.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l1.m3.1c">d\leq N_{C}-1</annotation></semantics></math> maximum iterations <math id="algx1.l1.m4.1" class="ltx_Math" alttext="T" display="inline"><semantics id="algx1.l1.m4.1a"><mi id="algx1.l1.m4.1.1" xref="algx1.l1.m4.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="algx1.l1.m4.1b"><ci id="algx1.l1.m4.1.1.cmml" xref="algx1.l1.m4.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l1.m4.1c">T</annotation></semantics></math>, stop threshold <math id="algx1.l1.m5.1" class="ltx_Math" alttext="\delta" display="inline"><semantics id="algx1.l1.m5.1a"><mi id="algx1.l1.m5.1.1" xref="algx1.l1.m5.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="algx1.l1.m5.1b"><ci id="algx1.l1.m5.1.1.cmml" xref="algx1.l1.m5.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l1.m5.1c">\delta</annotation></semantics></math>, learning rate <math id="algx1.l1.m6.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="algx1.l1.m6.1a"><mi id="algx1.l1.m6.1.1" xref="algx1.l1.m6.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="algx1.l1.m6.1b"><ci id="algx1.l1.m6.1.1.cmml" xref="algx1.l1.m6.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l1.m6.1c">\tau</annotation></semantics></math>.

</div>
<div id="algx1.l2" class="ltx_listingline">  1:  Initialization:

</div>
<div id="algx1.l3" class="ltx_listingline">           Randomly initialize <math id="algx1.l3.m1.1" class="ltx_Math" alttext="W" display="inline"><semantics id="algx1.l3.m1.1a"><mi id="algx1.l3.m1.1.1" xref="algx1.l3.m1.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="algx1.l3.m1.1b"><ci id="algx1.l3.m1.1.1.cmml" xref="algx1.l3.m1.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l3.m1.1c">W</annotation></semantics></math> = np.random.normal(size=(<math id="algx1.l3.m2.2" class="ltx_Math" alttext="N_{C},d" display="inline"><semantics id="algx1.l3.m2.2a"><mrow id="algx1.l3.m2.2.2.1" xref="algx1.l3.m2.2.2.2.cmml"><msub id="algx1.l3.m2.2.2.1.1" xref="algx1.l3.m2.2.2.1.1.cmml"><mi id="algx1.l3.m2.2.2.1.1.2" xref="algx1.l3.m2.2.2.1.1.2.cmml">N</mi><mi id="algx1.l3.m2.2.2.1.1.3" xref="algx1.l3.m2.2.2.1.1.3.cmml">C</mi></msub><mo id="algx1.l3.m2.2.2.1.2" xref="algx1.l3.m2.2.2.2.cmml">,</mo><mi id="algx1.l3.m2.1.1" xref="algx1.l3.m2.1.1.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="algx1.l3.m2.2b"><list id="algx1.l3.m2.2.2.2.cmml" xref="algx1.l3.m2.2.2.1"><apply id="algx1.l3.m2.2.2.1.1.cmml" xref="algx1.l3.m2.2.2.1.1"><csymbol cd="ambiguous" id="algx1.l3.m2.2.2.1.1.1.cmml" xref="algx1.l3.m2.2.2.1.1">subscript</csymbol><ci id="algx1.l3.m2.2.2.1.1.2.cmml" xref="algx1.l3.m2.2.2.1.1.2">𝑁</ci><ci id="algx1.l3.m2.2.2.1.1.3.cmml" xref="algx1.l3.m2.2.2.1.1.3">𝐶</ci></apply><ci id="algx1.l3.m2.1.1.cmml" xref="algx1.l3.m2.1.1">𝑑</ci></list></annotation-xml><annotation encoding="application/x-tex" id="algx1.l3.m2.2c">N_{C},d</annotation></semantics></math>)),

</div>
<div id="algx1.l4" class="ltx_listingline">  2:  for <math id="algx1.l4.m1.1" class="ltx_Math" alttext="t=1" display="inline"><semantics id="algx1.l4.m1.1a"><mrow id="algx1.l4.m1.1.1" xref="algx1.l4.m1.1.1.cmml"><mi id="algx1.l4.m1.1.1.2" xref="algx1.l4.m1.1.1.2.cmml">t</mi><mo id="algx1.l4.m1.1.1.1" xref="algx1.l4.m1.1.1.1.cmml">=</mo><mn id="algx1.l4.m1.1.1.3" xref="algx1.l4.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="algx1.l4.m1.1b"><apply id="algx1.l4.m1.1.1.cmml" xref="algx1.l4.m1.1.1"><eq id="algx1.l4.m1.1.1.1.cmml" xref="algx1.l4.m1.1.1.1"></eq><ci id="algx1.l4.m1.1.1.2.cmml" xref="algx1.l4.m1.1.1.2">𝑡</ci><cn type="integer" id="algx1.l4.m1.1.1.3.cmml" xref="algx1.l4.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l4.m1.1c">t=1</annotation></semantics></math> to <math id="algx1.l4.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="algx1.l4.m2.1a"><mi id="algx1.l4.m2.1.1" xref="algx1.l4.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="algx1.l4.m2.1b"><ci id="algx1.l4.m2.1.1.cmml" xref="algx1.l4.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l4.m2.1c">T</annotation></semantics></math>

</div>
<div id="algx1.l5" class="ltx_listingline">           <math id="algx1.l5.m1.1" class="ltx_Math" alttext="l_{2}" display="inline"><semantics id="algx1.l5.m1.1a"><msub id="algx1.l5.m1.1.1" xref="algx1.l5.m1.1.1.cmml"><mi id="algx1.l5.m1.1.1.2" xref="algx1.l5.m1.1.1.2.cmml">l</mi><mn id="algx1.l5.m1.1.1.3" xref="algx1.l5.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="algx1.l5.m1.1b"><apply id="algx1.l5.m1.1.1.cmml" xref="algx1.l5.m1.1.1"><csymbol cd="ambiguous" id="algx1.l5.m1.1.1.1.cmml" xref="algx1.l5.m1.1.1">subscript</csymbol><ci id="algx1.l5.m1.1.1.2.cmml" xref="algx1.l5.m1.1.1.2">𝑙</ci><cn type="integer" id="algx1.l5.m1.1.1.3.cmml" xref="algx1.l5.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l5.m1.1c">l_{2}</annotation></semantics></math>-normalize the vector <math id="algx1.l5.m2.1" class="ltx_Math" alttext="\mathbf{w}" display="inline"><semantics id="algx1.l5.m2.1a"><mi id="algx1.l5.m2.1.1" xref="algx1.l5.m2.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="algx1.l5.m2.1b"><ci id="algx1.l5.m2.1.1.cmml" xref="algx1.l5.m2.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l5.m2.1c">\mathbf{w}</annotation></semantics></math> in each row <math id="algx1.l5.m3.1" class="ltx_Math" alttext="W" display="inline"><semantics id="algx1.l5.m3.1a"><mi id="algx1.l5.m3.1.1" xref="algx1.l5.m3.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="algx1.l5.m3.1b"><ci id="algx1.l5.m3.1.1.cmml" xref="algx1.l5.m3.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l5.m3.1c">W</annotation></semantics></math> = normalize(<math id="algx1.l5.m4.1" class="ltx_Math" alttext="W" display="inline"><semantics id="algx1.l5.m4.1a"><mi id="algx1.l5.m4.1.1" xref="algx1.l5.m4.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="algx1.l5.m4.1b"><ci id="algx1.l5.m4.1.1.cmml" xref="algx1.l5.m4.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l5.m4.1c">W</annotation></semantics></math>),

</div>
<div id="algx1.l6" class="ltx_listingline">           calculate pair-wise <math id="algx1.l6.m1.1" class="ltx_Math" alttext="l_{2}" display="inline"><semantics id="algx1.l6.m1.1a"><msub id="algx1.l6.m1.1.1" xref="algx1.l6.m1.1.1.cmml"><mi id="algx1.l6.m1.1.1.2" xref="algx1.l6.m1.1.1.2.cmml">l</mi><mn id="algx1.l6.m1.1.1.3" xref="algx1.l6.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="algx1.l6.m1.1b"><apply id="algx1.l6.m1.1.1.cmml" xref="algx1.l6.m1.1.1"><csymbol cd="ambiguous" id="algx1.l6.m1.1.1.1.cmml" xref="algx1.l6.m1.1.1">subscript</csymbol><ci id="algx1.l6.m1.1.1.2.cmml" xref="algx1.l6.m1.1.1.2">𝑙</ci><cn type="integer" id="algx1.l6.m1.1.1.3.cmml" xref="algx1.l6.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l6.m1.1c">l_{2}</annotation></semantics></math> distance <math id="algx1.l6.m2.1" class="ltx_Math" alttext="W_{inner}\in\mathcal{R}^{N_{C}\times N_{C}}" display="inline"><semantics id="algx1.l6.m2.1a"><mrow id="algx1.l6.m2.1.1" xref="algx1.l6.m2.1.1.cmml"><msub id="algx1.l6.m2.1.1.2" xref="algx1.l6.m2.1.1.2.cmml"><mi id="algx1.l6.m2.1.1.2.2" xref="algx1.l6.m2.1.1.2.2.cmml">W</mi><mrow id="algx1.l6.m2.1.1.2.3" xref="algx1.l6.m2.1.1.2.3.cmml"><mi id="algx1.l6.m2.1.1.2.3.2" xref="algx1.l6.m2.1.1.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="algx1.l6.m2.1.1.2.3.1" xref="algx1.l6.m2.1.1.2.3.1.cmml">​</mo><mi id="algx1.l6.m2.1.1.2.3.3" xref="algx1.l6.m2.1.1.2.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="algx1.l6.m2.1.1.2.3.1a" xref="algx1.l6.m2.1.1.2.3.1.cmml">​</mo><mi id="algx1.l6.m2.1.1.2.3.4" xref="algx1.l6.m2.1.1.2.3.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="algx1.l6.m2.1.1.2.3.1b" xref="algx1.l6.m2.1.1.2.3.1.cmml">​</mo><mi id="algx1.l6.m2.1.1.2.3.5" xref="algx1.l6.m2.1.1.2.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="algx1.l6.m2.1.1.2.3.1c" xref="algx1.l6.m2.1.1.2.3.1.cmml">​</mo><mi id="algx1.l6.m2.1.1.2.3.6" xref="algx1.l6.m2.1.1.2.3.6.cmml">r</mi></mrow></msub><mo id="algx1.l6.m2.1.1.1" xref="algx1.l6.m2.1.1.1.cmml">∈</mo><msup id="algx1.l6.m2.1.1.3" xref="algx1.l6.m2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="algx1.l6.m2.1.1.3.2" xref="algx1.l6.m2.1.1.3.2.cmml">ℛ</mi><mrow id="algx1.l6.m2.1.1.3.3" xref="algx1.l6.m2.1.1.3.3.cmml"><msub id="algx1.l6.m2.1.1.3.3.2" xref="algx1.l6.m2.1.1.3.3.2.cmml"><mi id="algx1.l6.m2.1.1.3.3.2.2" xref="algx1.l6.m2.1.1.3.3.2.2.cmml">N</mi><mi id="algx1.l6.m2.1.1.3.3.2.3" xref="algx1.l6.m2.1.1.3.3.2.3.cmml">C</mi></msub><mo lspace="0.222em" rspace="0.222em" id="algx1.l6.m2.1.1.3.3.1" xref="algx1.l6.m2.1.1.3.3.1.cmml">×</mo><msub id="algx1.l6.m2.1.1.3.3.3" xref="algx1.l6.m2.1.1.3.3.3.cmml"><mi id="algx1.l6.m2.1.1.3.3.3.2" xref="algx1.l6.m2.1.1.3.3.3.2.cmml">N</mi><mi id="algx1.l6.m2.1.1.3.3.3.3" xref="algx1.l6.m2.1.1.3.3.3.3.cmml">C</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="algx1.l6.m2.1b"><apply id="algx1.l6.m2.1.1.cmml" xref="algx1.l6.m2.1.1"><in id="algx1.l6.m2.1.1.1.cmml" xref="algx1.l6.m2.1.1.1"></in><apply id="algx1.l6.m2.1.1.2.cmml" xref="algx1.l6.m2.1.1.2"><csymbol cd="ambiguous" id="algx1.l6.m2.1.1.2.1.cmml" xref="algx1.l6.m2.1.1.2">subscript</csymbol><ci id="algx1.l6.m2.1.1.2.2.cmml" xref="algx1.l6.m2.1.1.2.2">𝑊</ci><apply id="algx1.l6.m2.1.1.2.3.cmml" xref="algx1.l6.m2.1.1.2.3"><times id="algx1.l6.m2.1.1.2.3.1.cmml" xref="algx1.l6.m2.1.1.2.3.1"></times><ci id="algx1.l6.m2.1.1.2.3.2.cmml" xref="algx1.l6.m2.1.1.2.3.2">𝑖</ci><ci id="algx1.l6.m2.1.1.2.3.3.cmml" xref="algx1.l6.m2.1.1.2.3.3">𝑛</ci><ci id="algx1.l6.m2.1.1.2.3.4.cmml" xref="algx1.l6.m2.1.1.2.3.4">𝑛</ci><ci id="algx1.l6.m2.1.1.2.3.5.cmml" xref="algx1.l6.m2.1.1.2.3.5">𝑒</ci><ci id="algx1.l6.m2.1.1.2.3.6.cmml" xref="algx1.l6.m2.1.1.2.3.6">𝑟</ci></apply></apply><apply id="algx1.l6.m2.1.1.3.cmml" xref="algx1.l6.m2.1.1.3"><csymbol cd="ambiguous" id="algx1.l6.m2.1.1.3.1.cmml" xref="algx1.l6.m2.1.1.3">superscript</csymbol><ci id="algx1.l6.m2.1.1.3.2.cmml" xref="algx1.l6.m2.1.1.3.2">ℛ</ci><apply id="algx1.l6.m2.1.1.3.3.cmml" xref="algx1.l6.m2.1.1.3.3"><times id="algx1.l6.m2.1.1.3.3.1.cmml" xref="algx1.l6.m2.1.1.3.3.1"></times><apply id="algx1.l6.m2.1.1.3.3.2.cmml" xref="algx1.l6.m2.1.1.3.3.2"><csymbol cd="ambiguous" id="algx1.l6.m2.1.1.3.3.2.1.cmml" xref="algx1.l6.m2.1.1.3.3.2">subscript</csymbol><ci id="algx1.l6.m2.1.1.3.3.2.2.cmml" xref="algx1.l6.m2.1.1.3.3.2.2">𝑁</ci><ci id="algx1.l6.m2.1.1.3.3.2.3.cmml" xref="algx1.l6.m2.1.1.3.3.2.3">𝐶</ci></apply><apply id="algx1.l6.m2.1.1.3.3.3.cmml" xref="algx1.l6.m2.1.1.3.3.3"><csymbol cd="ambiguous" id="algx1.l6.m2.1.1.3.3.3.1.cmml" xref="algx1.l6.m2.1.1.3.3.3">subscript</csymbol><ci id="algx1.l6.m2.1.1.3.3.3.2.cmml" xref="algx1.l6.m2.1.1.3.3.3.2">𝑁</ci><ci id="algx1.l6.m2.1.1.3.3.3.3.cmml" xref="algx1.l6.m2.1.1.3.3.3.3">𝐶</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l6.m2.1c">W_{inner}\in\mathcal{R}^{N_{C}\times N_{C}}</annotation></semantics></math> and set diagonal value as max infinity

</div>
<div id="algx1.l7" class="ltx_listingline">           calculate minimum distance for each class (except for the diagonal value) <math id="algx1.l7.m1.2" class="ltx_Math" alttext="idx=np.argmin(W_{inner},axis=1)" display="inline"><semantics id="algx1.l7.m1.2a"><mrow id="algx1.l7.m1.2.2.2" xref="algx1.l7.m1.2.2.3.cmml"><mrow id="algx1.l7.m1.1.1.1.1" xref="algx1.l7.m1.1.1.1.1.cmml"><mrow id="algx1.l7.m1.1.1.1.1.2" xref="algx1.l7.m1.1.1.1.1.2.cmml"><mi id="algx1.l7.m1.1.1.1.1.2.2" xref="algx1.l7.m1.1.1.1.1.2.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="algx1.l7.m1.1.1.1.1.2.1" xref="algx1.l7.m1.1.1.1.1.2.1.cmml">​</mo><mi id="algx1.l7.m1.1.1.1.1.2.3" xref="algx1.l7.m1.1.1.1.1.2.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="algx1.l7.m1.1.1.1.1.2.1a" xref="algx1.l7.m1.1.1.1.1.2.1.cmml">​</mo><mi id="algx1.l7.m1.1.1.1.1.2.4" xref="algx1.l7.m1.1.1.1.1.2.4.cmml">x</mi></mrow><mo id="algx1.l7.m1.1.1.1.1.1" xref="algx1.l7.m1.1.1.1.1.1.cmml">=</mo><mrow id="algx1.l7.m1.1.1.1.1.3" xref="algx1.l7.m1.1.1.1.1.3.cmml"><mi id="algx1.l7.m1.1.1.1.1.3.2" xref="algx1.l7.m1.1.1.1.1.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="algx1.l7.m1.1.1.1.1.3.1" xref="algx1.l7.m1.1.1.1.1.3.1.cmml">​</mo><mi id="algx1.l7.m1.1.1.1.1.3.3" xref="algx1.l7.m1.1.1.1.1.3.3.cmml">p</mi></mrow></mrow><mo lspace="0em" rspace="0.167em" id="algx1.l7.m1.2.2.2.3" xref="algx1.l7.m1.2.2.3a.cmml">.</mo><mrow id="algx1.l7.m1.2.2.2.2" xref="algx1.l7.m1.2.2.2.2.cmml"><mi id="algx1.l7.m1.2.2.2.2.3" xref="algx1.l7.m1.2.2.2.2.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="algx1.l7.m1.2.2.2.2.2" xref="algx1.l7.m1.2.2.2.2.2.cmml">​</mo><mi id="algx1.l7.m1.2.2.2.2.4" xref="algx1.l7.m1.2.2.2.2.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="algx1.l7.m1.2.2.2.2.2a" xref="algx1.l7.m1.2.2.2.2.2.cmml">​</mo><mi id="algx1.l7.m1.2.2.2.2.5" xref="algx1.l7.m1.2.2.2.2.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="algx1.l7.m1.2.2.2.2.2b" xref="algx1.l7.m1.2.2.2.2.2.cmml">​</mo><mi id="algx1.l7.m1.2.2.2.2.6" xref="algx1.l7.m1.2.2.2.2.6.cmml">m</mi><mo lspace="0em" rspace="0em" id="algx1.l7.m1.2.2.2.2.2c" xref="algx1.l7.m1.2.2.2.2.2.cmml">​</mo><mi id="algx1.l7.m1.2.2.2.2.7" xref="algx1.l7.m1.2.2.2.2.7.cmml">i</mi><mo lspace="0em" rspace="0em" id="algx1.l7.m1.2.2.2.2.2d" xref="algx1.l7.m1.2.2.2.2.2.cmml">​</mo><mi id="algx1.l7.m1.2.2.2.2.8" xref="algx1.l7.m1.2.2.2.2.8.cmml">n</mi><mo lspace="0em" rspace="0em" id="algx1.l7.m1.2.2.2.2.2e" xref="algx1.l7.m1.2.2.2.2.2.cmml">​</mo><mrow id="algx1.l7.m1.2.2.2.2.1.1" xref="algx1.l7.m1.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="algx1.l7.m1.2.2.2.2.1.1.2" xref="algx1.l7.m1.2.2.2.2.1.1.1.cmml">(</mo><mrow id="algx1.l7.m1.2.2.2.2.1.1.1" xref="algx1.l7.m1.2.2.2.2.1.1.1.cmml"><mrow id="algx1.l7.m1.2.2.2.2.1.1.1.2.2" xref="algx1.l7.m1.2.2.2.2.1.1.1.2.3.cmml"><msub id="algx1.l7.m1.2.2.2.2.1.1.1.1.1.1" xref="algx1.l7.m1.2.2.2.2.1.1.1.1.1.1.cmml"><mi id="algx1.l7.m1.2.2.2.2.1.1.1.1.1.1.2" xref="algx1.l7.m1.2.2.2.2.1.1.1.1.1.1.2.cmml">W</mi><mrow id="algx1.l7.m1.2.2.2.2.1.1.1.1.1.1.3" xref="algx1.l7.m1.2.2.2.2.1.1.1.1.1.1.3.cmml"><mi id="algx1.l7.m1.2.2.2.2.1.1.1.1.1.1.3.2" xref="algx1.l7.m1.2.2.2.2.1.1.1.1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="algx1.l7.m1.2.2.2.2.1.1.1.1.1.1.3.1" xref="algx1.l7.m1.2.2.2.2.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="algx1.l7.m1.2.2.2.2.1.1.1.1.1.1.3.3" xref="algx1.l7.m1.2.2.2.2.1.1.1.1.1.1.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="algx1.l7.m1.2.2.2.2.1.1.1.1.1.1.3.1a" xref="algx1.l7.m1.2.2.2.2.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="algx1.l7.m1.2.2.2.2.1.1.1.1.1.1.3.4" xref="algx1.l7.m1.2.2.2.2.1.1.1.1.1.1.3.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="algx1.l7.m1.2.2.2.2.1.1.1.1.1.1.3.1b" xref="algx1.l7.m1.2.2.2.2.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="algx1.l7.m1.2.2.2.2.1.1.1.1.1.1.3.5" xref="algx1.l7.m1.2.2.2.2.1.1.1.1.1.1.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="algx1.l7.m1.2.2.2.2.1.1.1.1.1.1.3.1c" xref="algx1.l7.m1.2.2.2.2.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="algx1.l7.m1.2.2.2.2.1.1.1.1.1.1.3.6" xref="algx1.l7.m1.2.2.2.2.1.1.1.1.1.1.3.6.cmml">r</mi></mrow></msub><mo id="algx1.l7.m1.2.2.2.2.1.1.1.2.2.3" xref="algx1.l7.m1.2.2.2.2.1.1.1.2.3.cmml">,</mo><mrow id="algx1.l7.m1.2.2.2.2.1.1.1.2.2.2" xref="algx1.l7.m1.2.2.2.2.1.1.1.2.2.2.cmml"><mi id="algx1.l7.m1.2.2.2.2.1.1.1.2.2.2.2" xref="algx1.l7.m1.2.2.2.2.1.1.1.2.2.2.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="algx1.l7.m1.2.2.2.2.1.1.1.2.2.2.1" xref="algx1.l7.m1.2.2.2.2.1.1.1.2.2.2.1.cmml">​</mo><mi id="algx1.l7.m1.2.2.2.2.1.1.1.2.2.2.3" xref="algx1.l7.m1.2.2.2.2.1.1.1.2.2.2.3.cmml">x</mi><mo lspace="0em" rspace="0em" id="algx1.l7.m1.2.2.2.2.1.1.1.2.2.2.1a" xref="algx1.l7.m1.2.2.2.2.1.1.1.2.2.2.1.cmml">​</mo><mi id="algx1.l7.m1.2.2.2.2.1.1.1.2.2.2.4" xref="algx1.l7.m1.2.2.2.2.1.1.1.2.2.2.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="algx1.l7.m1.2.2.2.2.1.1.1.2.2.2.1b" xref="algx1.l7.m1.2.2.2.2.1.1.1.2.2.2.1.cmml">​</mo><mi id="algx1.l7.m1.2.2.2.2.1.1.1.2.2.2.5" xref="algx1.l7.m1.2.2.2.2.1.1.1.2.2.2.5.cmml">s</mi></mrow></mrow><mo id="algx1.l7.m1.2.2.2.2.1.1.1.3" xref="algx1.l7.m1.2.2.2.2.1.1.1.3.cmml">=</mo><mn id="algx1.l7.m1.2.2.2.2.1.1.1.4" xref="algx1.l7.m1.2.2.2.2.1.1.1.4.cmml">1</mn></mrow><mo stretchy="false" id="algx1.l7.m1.2.2.2.2.1.1.3" xref="algx1.l7.m1.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx1.l7.m1.2b"><apply id="algx1.l7.m1.2.2.3.cmml" xref="algx1.l7.m1.2.2.2"><csymbol cd="ambiguous" id="algx1.l7.m1.2.2.3a.cmml" xref="algx1.l7.m1.2.2.2.3">formulae-sequence</csymbol><apply id="algx1.l7.m1.1.1.1.1.cmml" xref="algx1.l7.m1.1.1.1.1"><eq id="algx1.l7.m1.1.1.1.1.1.cmml" xref="algx1.l7.m1.1.1.1.1.1"></eq><apply id="algx1.l7.m1.1.1.1.1.2.cmml" xref="algx1.l7.m1.1.1.1.1.2"><times id="algx1.l7.m1.1.1.1.1.2.1.cmml" xref="algx1.l7.m1.1.1.1.1.2.1"></times><ci id="algx1.l7.m1.1.1.1.1.2.2.cmml" xref="algx1.l7.m1.1.1.1.1.2.2">𝑖</ci><ci id="algx1.l7.m1.1.1.1.1.2.3.cmml" xref="algx1.l7.m1.1.1.1.1.2.3">𝑑</ci><ci id="algx1.l7.m1.1.1.1.1.2.4.cmml" xref="algx1.l7.m1.1.1.1.1.2.4">𝑥</ci></apply><apply id="algx1.l7.m1.1.1.1.1.3.cmml" xref="algx1.l7.m1.1.1.1.1.3"><times id="algx1.l7.m1.1.1.1.1.3.1.cmml" xref="algx1.l7.m1.1.1.1.1.3.1"></times><ci id="algx1.l7.m1.1.1.1.1.3.2.cmml" xref="algx1.l7.m1.1.1.1.1.3.2">𝑛</ci><ci id="algx1.l7.m1.1.1.1.1.3.3.cmml" xref="algx1.l7.m1.1.1.1.1.3.3">𝑝</ci></apply></apply><apply id="algx1.l7.m1.2.2.2.2.cmml" xref="algx1.l7.m1.2.2.2.2"><times id="algx1.l7.m1.2.2.2.2.2.cmml" xref="algx1.l7.m1.2.2.2.2.2"></times><ci id="algx1.l7.m1.2.2.2.2.3.cmml" xref="algx1.l7.m1.2.2.2.2.3">𝑎</ci><ci id="algx1.l7.m1.2.2.2.2.4.cmml" xref="algx1.l7.m1.2.2.2.2.4">𝑟</ci><ci id="algx1.l7.m1.2.2.2.2.5.cmml" xref="algx1.l7.m1.2.2.2.2.5">𝑔</ci><ci id="algx1.l7.m1.2.2.2.2.6.cmml" xref="algx1.l7.m1.2.2.2.2.6">𝑚</ci><ci id="algx1.l7.m1.2.2.2.2.7.cmml" xref="algx1.l7.m1.2.2.2.2.7">𝑖</ci><ci id="algx1.l7.m1.2.2.2.2.8.cmml" xref="algx1.l7.m1.2.2.2.2.8">𝑛</ci><apply id="algx1.l7.m1.2.2.2.2.1.1.1.cmml" xref="algx1.l7.m1.2.2.2.2.1.1"><eq id="algx1.l7.m1.2.2.2.2.1.1.1.3.cmml" xref="algx1.l7.m1.2.2.2.2.1.1.1.3"></eq><list id="algx1.l7.m1.2.2.2.2.1.1.1.2.3.cmml" xref="algx1.l7.m1.2.2.2.2.1.1.1.2.2"><apply id="algx1.l7.m1.2.2.2.2.1.1.1.1.1.1.cmml" xref="algx1.l7.m1.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algx1.l7.m1.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="algx1.l7.m1.2.2.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="algx1.l7.m1.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="algx1.l7.m1.2.2.2.2.1.1.1.1.1.1.2">𝑊</ci><apply id="algx1.l7.m1.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="algx1.l7.m1.2.2.2.2.1.1.1.1.1.1.3"><times id="algx1.l7.m1.2.2.2.2.1.1.1.1.1.1.3.1.cmml" xref="algx1.l7.m1.2.2.2.2.1.1.1.1.1.1.3.1"></times><ci id="algx1.l7.m1.2.2.2.2.1.1.1.1.1.1.3.2.cmml" xref="algx1.l7.m1.2.2.2.2.1.1.1.1.1.1.3.2">𝑖</ci><ci id="algx1.l7.m1.2.2.2.2.1.1.1.1.1.1.3.3.cmml" xref="algx1.l7.m1.2.2.2.2.1.1.1.1.1.1.3.3">𝑛</ci><ci id="algx1.l7.m1.2.2.2.2.1.1.1.1.1.1.3.4.cmml" xref="algx1.l7.m1.2.2.2.2.1.1.1.1.1.1.3.4">𝑛</ci><ci id="algx1.l7.m1.2.2.2.2.1.1.1.1.1.1.3.5.cmml" xref="algx1.l7.m1.2.2.2.2.1.1.1.1.1.1.3.5">𝑒</ci><ci id="algx1.l7.m1.2.2.2.2.1.1.1.1.1.1.3.6.cmml" xref="algx1.l7.m1.2.2.2.2.1.1.1.1.1.1.3.6">𝑟</ci></apply></apply><apply id="algx1.l7.m1.2.2.2.2.1.1.1.2.2.2.cmml" xref="algx1.l7.m1.2.2.2.2.1.1.1.2.2.2"><times id="algx1.l7.m1.2.2.2.2.1.1.1.2.2.2.1.cmml" xref="algx1.l7.m1.2.2.2.2.1.1.1.2.2.2.1"></times><ci id="algx1.l7.m1.2.2.2.2.1.1.1.2.2.2.2.cmml" xref="algx1.l7.m1.2.2.2.2.1.1.1.2.2.2.2">𝑎</ci><ci id="algx1.l7.m1.2.2.2.2.1.1.1.2.2.2.3.cmml" xref="algx1.l7.m1.2.2.2.2.1.1.1.2.2.2.3">𝑥</ci><ci id="algx1.l7.m1.2.2.2.2.1.1.1.2.2.2.4.cmml" xref="algx1.l7.m1.2.2.2.2.1.1.1.2.2.2.4">𝑖</ci><ci id="algx1.l7.m1.2.2.2.2.1.1.1.2.2.2.5.cmml" xref="algx1.l7.m1.2.2.2.2.1.1.1.2.2.2.5">𝑠</ci></apply></list><cn type="integer" id="algx1.l7.m1.2.2.2.2.1.1.1.4.cmml" xref="algx1.l7.m1.2.2.2.2.1.1.1.4">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l7.m1.2c">idx=np.argmin(W_{inner},axis=1)</annotation></semantics></math>

</div>
<div id="algx1.l8" class="ltx_listingline">           calculate objective funcdtion <math id="algx1.l8.m1.2" class="ltx_Math" alttext="obj=np.sum(W_{inner}[range(N_{C}),idx])" display="inline"><semantics id="algx1.l8.m1.2a"><mrow id="algx1.l8.m1.2.2.2" xref="algx1.l8.m1.2.2.3.cmml"><mrow id="algx1.l8.m1.1.1.1.1" xref="algx1.l8.m1.1.1.1.1.cmml"><mrow id="algx1.l8.m1.1.1.1.1.2" xref="algx1.l8.m1.1.1.1.1.2.cmml"><mi id="algx1.l8.m1.1.1.1.1.2.2" xref="algx1.l8.m1.1.1.1.1.2.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="algx1.l8.m1.1.1.1.1.2.1" xref="algx1.l8.m1.1.1.1.1.2.1.cmml">​</mo><mi id="algx1.l8.m1.1.1.1.1.2.3" xref="algx1.l8.m1.1.1.1.1.2.3.cmml">b</mi><mo lspace="0em" rspace="0em" id="algx1.l8.m1.1.1.1.1.2.1a" xref="algx1.l8.m1.1.1.1.1.2.1.cmml">​</mo><mi id="algx1.l8.m1.1.1.1.1.2.4" xref="algx1.l8.m1.1.1.1.1.2.4.cmml">j</mi></mrow><mo id="algx1.l8.m1.1.1.1.1.1" xref="algx1.l8.m1.1.1.1.1.1.cmml">=</mo><mrow id="algx1.l8.m1.1.1.1.1.3" xref="algx1.l8.m1.1.1.1.1.3.cmml"><mi id="algx1.l8.m1.1.1.1.1.3.2" xref="algx1.l8.m1.1.1.1.1.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="algx1.l8.m1.1.1.1.1.3.1" xref="algx1.l8.m1.1.1.1.1.3.1.cmml">​</mo><mi id="algx1.l8.m1.1.1.1.1.3.3" xref="algx1.l8.m1.1.1.1.1.3.3.cmml">p</mi></mrow></mrow><mo lspace="0em" rspace="0.167em" id="algx1.l8.m1.2.2.2.3" xref="algx1.l8.m1.2.2.3a.cmml">.</mo><mrow id="algx1.l8.m1.2.2.2.2" xref="algx1.l8.m1.2.2.2.2.cmml"><mi id="algx1.l8.m1.2.2.2.2.3" xref="algx1.l8.m1.2.2.2.2.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="algx1.l8.m1.2.2.2.2.2" xref="algx1.l8.m1.2.2.2.2.2.cmml">​</mo><mi id="algx1.l8.m1.2.2.2.2.4" xref="algx1.l8.m1.2.2.2.2.4.cmml">u</mi><mo lspace="0em" rspace="0em" id="algx1.l8.m1.2.2.2.2.2a" xref="algx1.l8.m1.2.2.2.2.2.cmml">​</mo><mi id="algx1.l8.m1.2.2.2.2.5" xref="algx1.l8.m1.2.2.2.2.5.cmml">m</mi><mo lspace="0em" rspace="0em" id="algx1.l8.m1.2.2.2.2.2b" xref="algx1.l8.m1.2.2.2.2.2.cmml">​</mo><mrow id="algx1.l8.m1.2.2.2.2.1.1" xref="algx1.l8.m1.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="algx1.l8.m1.2.2.2.2.1.1.2" xref="algx1.l8.m1.2.2.2.2.1.1.1.cmml">(</mo><mrow id="algx1.l8.m1.2.2.2.2.1.1.1" xref="algx1.l8.m1.2.2.2.2.1.1.1.cmml"><msub id="algx1.l8.m1.2.2.2.2.1.1.1.4" xref="algx1.l8.m1.2.2.2.2.1.1.1.4.cmml"><mi id="algx1.l8.m1.2.2.2.2.1.1.1.4.2" xref="algx1.l8.m1.2.2.2.2.1.1.1.4.2.cmml">W</mi><mrow id="algx1.l8.m1.2.2.2.2.1.1.1.4.3" xref="algx1.l8.m1.2.2.2.2.1.1.1.4.3.cmml"><mi id="algx1.l8.m1.2.2.2.2.1.1.1.4.3.2" xref="algx1.l8.m1.2.2.2.2.1.1.1.4.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="algx1.l8.m1.2.2.2.2.1.1.1.4.3.1" xref="algx1.l8.m1.2.2.2.2.1.1.1.4.3.1.cmml">​</mo><mi id="algx1.l8.m1.2.2.2.2.1.1.1.4.3.3" xref="algx1.l8.m1.2.2.2.2.1.1.1.4.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="algx1.l8.m1.2.2.2.2.1.1.1.4.3.1a" xref="algx1.l8.m1.2.2.2.2.1.1.1.4.3.1.cmml">​</mo><mi id="algx1.l8.m1.2.2.2.2.1.1.1.4.3.4" xref="algx1.l8.m1.2.2.2.2.1.1.1.4.3.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="algx1.l8.m1.2.2.2.2.1.1.1.4.3.1b" xref="algx1.l8.m1.2.2.2.2.1.1.1.4.3.1.cmml">​</mo><mi id="algx1.l8.m1.2.2.2.2.1.1.1.4.3.5" xref="algx1.l8.m1.2.2.2.2.1.1.1.4.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="algx1.l8.m1.2.2.2.2.1.1.1.4.3.1c" xref="algx1.l8.m1.2.2.2.2.1.1.1.4.3.1.cmml">​</mo><mi id="algx1.l8.m1.2.2.2.2.1.1.1.4.3.6" xref="algx1.l8.m1.2.2.2.2.1.1.1.4.3.6.cmml">r</mi></mrow></msub><mo lspace="0em" rspace="0em" id="algx1.l8.m1.2.2.2.2.1.1.1.3" xref="algx1.l8.m1.2.2.2.2.1.1.1.3.cmml">​</mo><mrow id="algx1.l8.m1.2.2.2.2.1.1.1.2.2" xref="algx1.l8.m1.2.2.2.2.1.1.1.2.3.cmml"><mo stretchy="false" id="algx1.l8.m1.2.2.2.2.1.1.1.2.2.3" xref="algx1.l8.m1.2.2.2.2.1.1.1.2.3.cmml">[</mo><mrow id="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1" xref="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.cmml"><mi id="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.3" xref="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.2" xref="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.2.cmml">​</mo><mi id="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.4" xref="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.2a" xref="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.2.cmml">​</mo><mi id="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.5" xref="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.2b" xref="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.2.cmml">​</mo><mi id="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.6" xref="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.6.cmml">g</mi><mo lspace="0em" rspace="0em" id="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.2c" xref="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.2.cmml">​</mo><mi id="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.7" xref="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.7.cmml">e</mi><mo lspace="0em" rspace="0em" id="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.2d" xref="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.2.cmml">​</mo><mrow id="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.1.1" xref="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.1.1.2" xref="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.1.1.1" xref="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.2" xref="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.2.cmml">N</mi><mi id="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.3" xref="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.3.cmml">C</mi></msub><mo stretchy="false" id="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.1.1.3" xref="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="algx1.l8.m1.2.2.2.2.1.1.1.2.2.4" xref="algx1.l8.m1.2.2.2.2.1.1.1.2.3.cmml">,</mo><mrow id="algx1.l8.m1.2.2.2.2.1.1.1.2.2.2" xref="algx1.l8.m1.2.2.2.2.1.1.1.2.2.2.cmml"><mi id="algx1.l8.m1.2.2.2.2.1.1.1.2.2.2.2" xref="algx1.l8.m1.2.2.2.2.1.1.1.2.2.2.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="algx1.l8.m1.2.2.2.2.1.1.1.2.2.2.1" xref="algx1.l8.m1.2.2.2.2.1.1.1.2.2.2.1.cmml">​</mo><mi id="algx1.l8.m1.2.2.2.2.1.1.1.2.2.2.3" xref="algx1.l8.m1.2.2.2.2.1.1.1.2.2.2.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="algx1.l8.m1.2.2.2.2.1.1.1.2.2.2.1a" xref="algx1.l8.m1.2.2.2.2.1.1.1.2.2.2.1.cmml">​</mo><mi id="algx1.l8.m1.2.2.2.2.1.1.1.2.2.2.4" xref="algx1.l8.m1.2.2.2.2.1.1.1.2.2.2.4.cmml">x</mi></mrow><mo stretchy="false" id="algx1.l8.m1.2.2.2.2.1.1.1.2.2.5" xref="algx1.l8.m1.2.2.2.2.1.1.1.2.3.cmml">]</mo></mrow></mrow><mo stretchy="false" id="algx1.l8.m1.2.2.2.2.1.1.3" xref="algx1.l8.m1.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx1.l8.m1.2b"><apply id="algx1.l8.m1.2.2.3.cmml" xref="algx1.l8.m1.2.2.2"><csymbol cd="ambiguous" id="algx1.l8.m1.2.2.3a.cmml" xref="algx1.l8.m1.2.2.2.3">formulae-sequence</csymbol><apply id="algx1.l8.m1.1.1.1.1.cmml" xref="algx1.l8.m1.1.1.1.1"><eq id="algx1.l8.m1.1.1.1.1.1.cmml" xref="algx1.l8.m1.1.1.1.1.1"></eq><apply id="algx1.l8.m1.1.1.1.1.2.cmml" xref="algx1.l8.m1.1.1.1.1.2"><times id="algx1.l8.m1.1.1.1.1.2.1.cmml" xref="algx1.l8.m1.1.1.1.1.2.1"></times><ci id="algx1.l8.m1.1.1.1.1.2.2.cmml" xref="algx1.l8.m1.1.1.1.1.2.2">𝑜</ci><ci id="algx1.l8.m1.1.1.1.1.2.3.cmml" xref="algx1.l8.m1.1.1.1.1.2.3">𝑏</ci><ci id="algx1.l8.m1.1.1.1.1.2.4.cmml" xref="algx1.l8.m1.1.1.1.1.2.4">𝑗</ci></apply><apply id="algx1.l8.m1.1.1.1.1.3.cmml" xref="algx1.l8.m1.1.1.1.1.3"><times id="algx1.l8.m1.1.1.1.1.3.1.cmml" xref="algx1.l8.m1.1.1.1.1.3.1"></times><ci id="algx1.l8.m1.1.1.1.1.3.2.cmml" xref="algx1.l8.m1.1.1.1.1.3.2">𝑛</ci><ci id="algx1.l8.m1.1.1.1.1.3.3.cmml" xref="algx1.l8.m1.1.1.1.1.3.3">𝑝</ci></apply></apply><apply id="algx1.l8.m1.2.2.2.2.cmml" xref="algx1.l8.m1.2.2.2.2"><times id="algx1.l8.m1.2.2.2.2.2.cmml" xref="algx1.l8.m1.2.2.2.2.2"></times><ci id="algx1.l8.m1.2.2.2.2.3.cmml" xref="algx1.l8.m1.2.2.2.2.3">𝑠</ci><ci id="algx1.l8.m1.2.2.2.2.4.cmml" xref="algx1.l8.m1.2.2.2.2.4">𝑢</ci><ci id="algx1.l8.m1.2.2.2.2.5.cmml" xref="algx1.l8.m1.2.2.2.2.5">𝑚</ci><apply id="algx1.l8.m1.2.2.2.2.1.1.1.cmml" xref="algx1.l8.m1.2.2.2.2.1.1"><times id="algx1.l8.m1.2.2.2.2.1.1.1.3.cmml" xref="algx1.l8.m1.2.2.2.2.1.1.1.3"></times><apply id="algx1.l8.m1.2.2.2.2.1.1.1.4.cmml" xref="algx1.l8.m1.2.2.2.2.1.1.1.4"><csymbol cd="ambiguous" id="algx1.l8.m1.2.2.2.2.1.1.1.4.1.cmml" xref="algx1.l8.m1.2.2.2.2.1.1.1.4">subscript</csymbol><ci id="algx1.l8.m1.2.2.2.2.1.1.1.4.2.cmml" xref="algx1.l8.m1.2.2.2.2.1.1.1.4.2">𝑊</ci><apply id="algx1.l8.m1.2.2.2.2.1.1.1.4.3.cmml" xref="algx1.l8.m1.2.2.2.2.1.1.1.4.3"><times id="algx1.l8.m1.2.2.2.2.1.1.1.4.3.1.cmml" xref="algx1.l8.m1.2.2.2.2.1.1.1.4.3.1"></times><ci id="algx1.l8.m1.2.2.2.2.1.1.1.4.3.2.cmml" xref="algx1.l8.m1.2.2.2.2.1.1.1.4.3.2">𝑖</ci><ci id="algx1.l8.m1.2.2.2.2.1.1.1.4.3.3.cmml" xref="algx1.l8.m1.2.2.2.2.1.1.1.4.3.3">𝑛</ci><ci id="algx1.l8.m1.2.2.2.2.1.1.1.4.3.4.cmml" xref="algx1.l8.m1.2.2.2.2.1.1.1.4.3.4">𝑛</ci><ci id="algx1.l8.m1.2.2.2.2.1.1.1.4.3.5.cmml" xref="algx1.l8.m1.2.2.2.2.1.1.1.4.3.5">𝑒</ci><ci id="algx1.l8.m1.2.2.2.2.1.1.1.4.3.6.cmml" xref="algx1.l8.m1.2.2.2.2.1.1.1.4.3.6">𝑟</ci></apply></apply><interval closure="closed" id="algx1.l8.m1.2.2.2.2.1.1.1.2.3.cmml" xref="algx1.l8.m1.2.2.2.2.1.1.1.2.2"><apply id="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.cmml" xref="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1"><times id="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.2"></times><ci id="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.3">𝑟</ci><ci id="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.4.cmml" xref="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.4">𝑎</ci><ci id="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.5.cmml" xref="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.5">𝑛</ci><ci id="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.6.cmml" xref="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.6">𝑔</ci><ci id="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.7.cmml" xref="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.7">𝑒</ci><apply id="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.2">𝑁</ci><ci id="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="algx1.l8.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.3">𝐶</ci></apply></apply><apply id="algx1.l8.m1.2.2.2.2.1.1.1.2.2.2.cmml" xref="algx1.l8.m1.2.2.2.2.1.1.1.2.2.2"><times id="algx1.l8.m1.2.2.2.2.1.1.1.2.2.2.1.cmml" xref="algx1.l8.m1.2.2.2.2.1.1.1.2.2.2.1"></times><ci id="algx1.l8.m1.2.2.2.2.1.1.1.2.2.2.2.cmml" xref="algx1.l8.m1.2.2.2.2.1.1.1.2.2.2.2">𝑖</ci><ci id="algx1.l8.m1.2.2.2.2.1.1.1.2.2.2.3.cmml" xref="algx1.l8.m1.2.2.2.2.1.1.1.2.2.2.3">𝑑</ci><ci id="algx1.l8.m1.2.2.2.2.1.1.1.2.2.2.4.cmml" xref="algx1.l8.m1.2.2.2.2.1.1.1.2.2.2.4">𝑥</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l8.m1.2c">obj=np.sum(W_{inner}[range(N_{C}),idx])</annotation></semantics></math>

</div>
<div id="algx1.l9" class="ltx_listingline">           calculate gradient <math id="algx1.l9.m1.2" class="ltx_Math" alttext="grad=(W-W[nn_{i}ndex,:])*2" display="inline"><semantics id="algx1.l9.m1.2a"><mrow id="algx1.l9.m1.2.2" xref="algx1.l9.m1.2.2.cmml"><mrow id="algx1.l9.m1.2.2.3" xref="algx1.l9.m1.2.2.3.cmml"><mi id="algx1.l9.m1.2.2.3.2" xref="algx1.l9.m1.2.2.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="algx1.l9.m1.2.2.3.1" xref="algx1.l9.m1.2.2.3.1.cmml">​</mo><mi id="algx1.l9.m1.2.2.3.3" xref="algx1.l9.m1.2.2.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="algx1.l9.m1.2.2.3.1a" xref="algx1.l9.m1.2.2.3.1.cmml">​</mo><mi id="algx1.l9.m1.2.2.3.4" xref="algx1.l9.m1.2.2.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="algx1.l9.m1.2.2.3.1b" xref="algx1.l9.m1.2.2.3.1.cmml">​</mo><mi id="algx1.l9.m1.2.2.3.5" xref="algx1.l9.m1.2.2.3.5.cmml">d</mi></mrow><mo id="algx1.l9.m1.2.2.2" xref="algx1.l9.m1.2.2.2.cmml">=</mo><mrow id="algx1.l9.m1.2.2.1" xref="algx1.l9.m1.2.2.1.cmml"><mrow id="algx1.l9.m1.2.2.1.1.1" xref="algx1.l9.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="algx1.l9.m1.2.2.1.1.1.2" xref="algx1.l9.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="algx1.l9.m1.2.2.1.1.1.1" xref="algx1.l9.m1.2.2.1.1.1.1.cmml"><mi id="algx1.l9.m1.2.2.1.1.1.1.3" xref="algx1.l9.m1.2.2.1.1.1.1.3.cmml">W</mi><mo id="algx1.l9.m1.2.2.1.1.1.1.2" xref="algx1.l9.m1.2.2.1.1.1.1.2.cmml">−</mo><mrow id="algx1.l9.m1.2.2.1.1.1.1.1" xref="algx1.l9.m1.2.2.1.1.1.1.1.cmml"><mi id="algx1.l9.m1.2.2.1.1.1.1.1.3" xref="algx1.l9.m1.2.2.1.1.1.1.1.3.cmml">W</mi><mo lspace="0em" rspace="0em" id="algx1.l9.m1.2.2.1.1.1.1.1.2" xref="algx1.l9.m1.2.2.1.1.1.1.1.2.cmml">​</mo><mrow id="algx1.l9.m1.2.2.1.1.1.1.1.1.1" xref="algx1.l9.m1.2.2.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="algx1.l9.m1.2.2.1.1.1.1.1.1.1.2" xref="algx1.l9.m1.2.2.1.1.1.1.1.1.2.cmml">[</mo><mrow id="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1" xref="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1.2" xref="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1.1" xref="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">​</mo><msub id="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1.3" xref="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1.3.2" xref="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml">n</mi><mi id="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1.3.3" xref="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1.1a" xref="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">​</mo><mi id="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1.4" xref="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1.1b" xref="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">​</mo><mi id="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1.5" xref="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1.5.cmml">d</mi><mo lspace="0em" rspace="0em" id="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1.1c" xref="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">​</mo><mi id="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1.6" xref="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1.1d" xref="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">​</mo><mi id="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1.7" xref="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1.7.cmml">x</mi></mrow><mo id="algx1.l9.m1.2.2.1.1.1.1.1.1.1.3" xref="algx1.l9.m1.2.2.1.1.1.1.1.1.2.cmml">,</mo><mo rspace="0em" id="algx1.l9.m1.1.1" xref="algx1.l9.m1.1.1.cmml">:</mo><mo stretchy="false" id="algx1.l9.m1.2.2.1.1.1.1.1.1.1.4" xref="algx1.l9.m1.2.2.1.1.1.1.1.1.2.cmml">]</mo></mrow></mrow></mrow><mo rspace="0.055em" stretchy="false" id="algx1.l9.m1.2.2.1.1.1.3" xref="algx1.l9.m1.2.2.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="algx1.l9.m1.2.2.1.2" xref="algx1.l9.m1.2.2.1.2.cmml">∗</mo><mn id="algx1.l9.m1.2.2.1.3" xref="algx1.l9.m1.2.2.1.3.cmml">2</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx1.l9.m1.2b"><apply id="algx1.l9.m1.2.2.cmml" xref="algx1.l9.m1.2.2"><eq id="algx1.l9.m1.2.2.2.cmml" xref="algx1.l9.m1.2.2.2"></eq><apply id="algx1.l9.m1.2.2.3.cmml" xref="algx1.l9.m1.2.2.3"><times id="algx1.l9.m1.2.2.3.1.cmml" xref="algx1.l9.m1.2.2.3.1"></times><ci id="algx1.l9.m1.2.2.3.2.cmml" xref="algx1.l9.m1.2.2.3.2">𝑔</ci><ci id="algx1.l9.m1.2.2.3.3.cmml" xref="algx1.l9.m1.2.2.3.3">𝑟</ci><ci id="algx1.l9.m1.2.2.3.4.cmml" xref="algx1.l9.m1.2.2.3.4">𝑎</ci><ci id="algx1.l9.m1.2.2.3.5.cmml" xref="algx1.l9.m1.2.2.3.5">𝑑</ci></apply><apply id="algx1.l9.m1.2.2.1.cmml" xref="algx1.l9.m1.2.2.1"><times id="algx1.l9.m1.2.2.1.2.cmml" xref="algx1.l9.m1.2.2.1.2"></times><apply id="algx1.l9.m1.2.2.1.1.1.1.cmml" xref="algx1.l9.m1.2.2.1.1.1"><minus id="algx1.l9.m1.2.2.1.1.1.1.2.cmml" xref="algx1.l9.m1.2.2.1.1.1.1.2"></minus><ci id="algx1.l9.m1.2.2.1.1.1.1.3.cmml" xref="algx1.l9.m1.2.2.1.1.1.1.3">𝑊</ci><apply id="algx1.l9.m1.2.2.1.1.1.1.1.cmml" xref="algx1.l9.m1.2.2.1.1.1.1.1"><times id="algx1.l9.m1.2.2.1.1.1.1.1.2.cmml" xref="algx1.l9.m1.2.2.1.1.1.1.1.2"></times><ci id="algx1.l9.m1.2.2.1.1.1.1.1.3.cmml" xref="algx1.l9.m1.2.2.1.1.1.1.1.3">𝑊</ci><interval closure="closed" id="algx1.l9.m1.2.2.1.1.1.1.1.1.2.cmml" xref="algx1.l9.m1.2.2.1.1.1.1.1.1.1"><apply id="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1"><times id="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1.1"></times><ci id="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1.2">𝑛</ci><apply id="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1.3.2">𝑛</ci><ci id="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply><ci id="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1.4.cmml" xref="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1.4">𝑛</ci><ci id="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1.5.cmml" xref="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1.5">𝑑</ci><ci id="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1.6.cmml" xref="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1.6">𝑒</ci><ci id="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1.7.cmml" xref="algx1.l9.m1.2.2.1.1.1.1.1.1.1.1.7">𝑥</ci></apply><ci id="algx1.l9.m1.1.1.cmml" xref="algx1.l9.m1.1.1">:</ci></interval></apply></apply><cn type="integer" id="algx1.l9.m1.2.2.1.3.cmml" xref="algx1.l9.m1.2.2.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l9.m1.2c">grad=(W-W[nn_{i}ndex,:])*2</annotation></semantics></math>

</div>
<div id="algx1.l10" class="ltx_listingline">           update the weight <math id="algx1.l10.m1.1" class="ltx_Math" alttext="W^{\prime}=W+grad*\tau" display="inline"><semantics id="algx1.l10.m1.1a"><mrow id="algx1.l10.m1.1.1" xref="algx1.l10.m1.1.1.cmml"><msup id="algx1.l10.m1.1.1.2" xref="algx1.l10.m1.1.1.2.cmml"><mi id="algx1.l10.m1.1.1.2.2" xref="algx1.l10.m1.1.1.2.2.cmml">W</mi><mo id="algx1.l10.m1.1.1.2.3" xref="algx1.l10.m1.1.1.2.3.cmml">′</mo></msup><mo id="algx1.l10.m1.1.1.1" xref="algx1.l10.m1.1.1.1.cmml">=</mo><mrow id="algx1.l10.m1.1.1.3" xref="algx1.l10.m1.1.1.3.cmml"><mi id="algx1.l10.m1.1.1.3.2" xref="algx1.l10.m1.1.1.3.2.cmml">W</mi><mo id="algx1.l10.m1.1.1.3.1" xref="algx1.l10.m1.1.1.3.1.cmml">+</mo><mrow id="algx1.l10.m1.1.1.3.3" xref="algx1.l10.m1.1.1.3.3.cmml"><mrow id="algx1.l10.m1.1.1.3.3.2" xref="algx1.l10.m1.1.1.3.3.2.cmml"><mi id="algx1.l10.m1.1.1.3.3.2.2" xref="algx1.l10.m1.1.1.3.3.2.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="algx1.l10.m1.1.1.3.3.2.1" xref="algx1.l10.m1.1.1.3.3.2.1.cmml">​</mo><mi id="algx1.l10.m1.1.1.3.3.2.3" xref="algx1.l10.m1.1.1.3.3.2.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="algx1.l10.m1.1.1.3.3.2.1a" xref="algx1.l10.m1.1.1.3.3.2.1.cmml">​</mo><mi id="algx1.l10.m1.1.1.3.3.2.4" xref="algx1.l10.m1.1.1.3.3.2.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="algx1.l10.m1.1.1.3.3.2.1b" xref="algx1.l10.m1.1.1.3.3.2.1.cmml">​</mo><mi id="algx1.l10.m1.1.1.3.3.2.5" xref="algx1.l10.m1.1.1.3.3.2.5.cmml">d</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="algx1.l10.m1.1.1.3.3.1" xref="algx1.l10.m1.1.1.3.3.1.cmml">∗</mo><mi id="algx1.l10.m1.1.1.3.3.3" xref="algx1.l10.m1.1.1.3.3.3.cmml">τ</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx1.l10.m1.1b"><apply id="algx1.l10.m1.1.1.cmml" xref="algx1.l10.m1.1.1"><eq id="algx1.l10.m1.1.1.1.cmml" xref="algx1.l10.m1.1.1.1"></eq><apply id="algx1.l10.m1.1.1.2.cmml" xref="algx1.l10.m1.1.1.2"><csymbol cd="ambiguous" id="algx1.l10.m1.1.1.2.1.cmml" xref="algx1.l10.m1.1.1.2">superscript</csymbol><ci id="algx1.l10.m1.1.1.2.2.cmml" xref="algx1.l10.m1.1.1.2.2">𝑊</ci><ci id="algx1.l10.m1.1.1.2.3.cmml" xref="algx1.l10.m1.1.1.2.3">′</ci></apply><apply id="algx1.l10.m1.1.1.3.cmml" xref="algx1.l10.m1.1.1.3"><plus id="algx1.l10.m1.1.1.3.1.cmml" xref="algx1.l10.m1.1.1.3.1"></plus><ci id="algx1.l10.m1.1.1.3.2.cmml" xref="algx1.l10.m1.1.1.3.2">𝑊</ci><apply id="algx1.l10.m1.1.1.3.3.cmml" xref="algx1.l10.m1.1.1.3.3"><times id="algx1.l10.m1.1.1.3.3.1.cmml" xref="algx1.l10.m1.1.1.3.3.1"></times><apply id="algx1.l10.m1.1.1.3.3.2.cmml" xref="algx1.l10.m1.1.1.3.3.2"><times id="algx1.l10.m1.1.1.3.3.2.1.cmml" xref="algx1.l10.m1.1.1.3.3.2.1"></times><ci id="algx1.l10.m1.1.1.3.3.2.2.cmml" xref="algx1.l10.m1.1.1.3.3.2.2">𝑔</ci><ci id="algx1.l10.m1.1.1.3.3.2.3.cmml" xref="algx1.l10.m1.1.1.3.3.2.3">𝑟</ci><ci id="algx1.l10.m1.1.1.3.3.2.4.cmml" xref="algx1.l10.m1.1.1.3.3.2.4">𝑎</ci><ci id="algx1.l10.m1.1.1.3.3.2.5.cmml" xref="algx1.l10.m1.1.1.3.3.2.5">𝑑</ci></apply><ci id="algx1.l10.m1.1.1.3.3.3.cmml" xref="algx1.l10.m1.1.1.3.3.3">𝜏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l10.m1.1c">W^{\prime}=W+grad*\tau</annotation></semantics></math>

</div>
<div id="algx1.l11" class="ltx_listingline">           <math id="algx1.l11.m1.1" class="ltx_Math" alttext="l_{2}" display="inline"><semantics id="algx1.l11.m1.1a"><msub id="algx1.l11.m1.1.1" xref="algx1.l11.m1.1.1.cmml"><mi id="algx1.l11.m1.1.1.2" xref="algx1.l11.m1.1.1.2.cmml">l</mi><mn id="algx1.l11.m1.1.1.3" xref="algx1.l11.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="algx1.l11.m1.1b"><apply id="algx1.l11.m1.1.1.cmml" xref="algx1.l11.m1.1.1"><csymbol cd="ambiguous" id="algx1.l11.m1.1.1.1.cmml" xref="algx1.l11.m1.1.1">subscript</csymbol><ci id="algx1.l11.m1.1.1.2.cmml" xref="algx1.l11.m1.1.1.2">𝑙</ci><cn type="integer" id="algx1.l11.m1.1.1.3.cmml" xref="algx1.l11.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l11.m1.1c">l_{2}</annotation></semantics></math>-normalize the vector <math id="algx1.l11.m2.1" class="ltx_Math" alttext="\mathbf{w}^{\prime}" display="inline"><semantics id="algx1.l11.m2.1a"><msup id="algx1.l11.m2.1.1" xref="algx1.l11.m2.1.1.cmml"><mi id="algx1.l11.m2.1.1.2" xref="algx1.l11.m2.1.1.2.cmml">𝐰</mi><mo id="algx1.l11.m2.1.1.3" xref="algx1.l11.m2.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="algx1.l11.m2.1b"><apply id="algx1.l11.m2.1.1.cmml" xref="algx1.l11.m2.1.1"><csymbol cd="ambiguous" id="algx1.l11.m2.1.1.1.cmml" xref="algx1.l11.m2.1.1">superscript</csymbol><ci id="algx1.l11.m2.1.1.2.cmml" xref="algx1.l11.m2.1.1.2">𝐰</ci><ci id="algx1.l11.m2.1.1.3.cmml" xref="algx1.l11.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l11.m2.1c">\mathbf{w}^{\prime}</annotation></semantics></math> in each row <math id="algx1.l11.m3.1" class="ltx_Math" alttext="W^{\prime}" display="inline"><semantics id="algx1.l11.m3.1a"><msup id="algx1.l11.m3.1.1" xref="algx1.l11.m3.1.1.cmml"><mi id="algx1.l11.m3.1.1.2" xref="algx1.l11.m3.1.1.2.cmml">W</mi><mo id="algx1.l11.m3.1.1.3" xref="algx1.l11.m3.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="algx1.l11.m3.1b"><apply id="algx1.l11.m3.1.1.cmml" xref="algx1.l11.m3.1.1"><csymbol cd="ambiguous" id="algx1.l11.m3.1.1.1.cmml" xref="algx1.l11.m3.1.1">superscript</csymbol><ci id="algx1.l11.m3.1.1.2.cmml" xref="algx1.l11.m3.1.1.2">𝑊</ci><ci id="algx1.l11.m3.1.1.3.cmml" xref="algx1.l11.m3.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l11.m3.1c">W^{\prime}</annotation></semantics></math> = normalize(<math id="algx1.l11.m4.1" class="ltx_Math" alttext="W^{\prime}" display="inline"><semantics id="algx1.l11.m4.1a"><msup id="algx1.l11.m4.1.1" xref="algx1.l11.m4.1.1.cmml"><mi id="algx1.l11.m4.1.1.2" xref="algx1.l11.m4.1.1.2.cmml">W</mi><mo id="algx1.l11.m4.1.1.3" xref="algx1.l11.m4.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="algx1.l11.m4.1b"><apply id="algx1.l11.m4.1.1.cmml" xref="algx1.l11.m4.1.1"><csymbol cd="ambiguous" id="algx1.l11.m4.1.1.1.cmml" xref="algx1.l11.m4.1.1">superscript</csymbol><ci id="algx1.l11.m4.1.1.2.cmml" xref="algx1.l11.m4.1.1.2">𝑊</ci><ci id="algx1.l11.m4.1.1.3.cmml" xref="algx1.l11.m4.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l11.m4.1c">W^{\prime}</annotation></semantics></math>),

</div>
<div id="algx1.l12" class="ltx_listingline">           update the weight <math id="algx1.l12.m1.1" class="ltx_Math" alttext="W^{\prime}=W" display="inline"><semantics id="algx1.l12.m1.1a"><mrow id="algx1.l12.m1.1.1" xref="algx1.l12.m1.1.1.cmml"><msup id="algx1.l12.m1.1.1.2" xref="algx1.l12.m1.1.1.2.cmml"><mi id="algx1.l12.m1.1.1.2.2" xref="algx1.l12.m1.1.1.2.2.cmml">W</mi><mo id="algx1.l12.m1.1.1.2.3" xref="algx1.l12.m1.1.1.2.3.cmml">′</mo></msup><mo id="algx1.l12.m1.1.1.1" xref="algx1.l12.m1.1.1.1.cmml">=</mo><mi id="algx1.l12.m1.1.1.3" xref="algx1.l12.m1.1.1.3.cmml">W</mi></mrow><annotation-xml encoding="MathML-Content" id="algx1.l12.m1.1b"><apply id="algx1.l12.m1.1.1.cmml" xref="algx1.l12.m1.1.1"><eq id="algx1.l12.m1.1.1.1.cmml" xref="algx1.l12.m1.1.1.1"></eq><apply id="algx1.l12.m1.1.1.2.cmml" xref="algx1.l12.m1.1.1.2"><csymbol cd="ambiguous" id="algx1.l12.m1.1.1.2.1.cmml" xref="algx1.l12.m1.1.1.2">superscript</csymbol><ci id="algx1.l12.m1.1.1.2.2.cmml" xref="algx1.l12.m1.1.1.2.2">𝑊</ci><ci id="algx1.l12.m1.1.1.2.3.cmml" xref="algx1.l12.m1.1.1.2.3">′</ci></apply><ci id="algx1.l12.m1.1.1.3.cmml" xref="algx1.l12.m1.1.1.3">𝑊</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l12.m1.1c">W^{\prime}=W</annotation></semantics></math>,

</div>
<div id="algx1.l13" class="ltx_listingline">           if <math id="algx1.l13.m1.1" class="ltx_Math" alttext="obj&lt;\tau" display="inline"><semantics id="algx1.l13.m1.1a"><mrow id="algx1.l13.m1.1.1" xref="algx1.l13.m1.1.1.cmml"><mrow id="algx1.l13.m1.1.1.2" xref="algx1.l13.m1.1.1.2.cmml"><mi id="algx1.l13.m1.1.1.2.2" xref="algx1.l13.m1.1.1.2.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="algx1.l13.m1.1.1.2.1" xref="algx1.l13.m1.1.1.2.1.cmml">​</mo><mi id="algx1.l13.m1.1.1.2.3" xref="algx1.l13.m1.1.1.2.3.cmml">b</mi><mo lspace="0em" rspace="0em" id="algx1.l13.m1.1.1.2.1a" xref="algx1.l13.m1.1.1.2.1.cmml">​</mo><mi id="algx1.l13.m1.1.1.2.4" xref="algx1.l13.m1.1.1.2.4.cmml">j</mi></mrow><mo id="algx1.l13.m1.1.1.1" xref="algx1.l13.m1.1.1.1.cmml">&lt;</mo><mi id="algx1.l13.m1.1.1.3" xref="algx1.l13.m1.1.1.3.cmml">τ</mi></mrow><annotation-xml encoding="MathML-Content" id="algx1.l13.m1.1b"><apply id="algx1.l13.m1.1.1.cmml" xref="algx1.l13.m1.1.1"><lt id="algx1.l13.m1.1.1.1.cmml" xref="algx1.l13.m1.1.1.1"></lt><apply id="algx1.l13.m1.1.1.2.cmml" xref="algx1.l13.m1.1.1.2"><times id="algx1.l13.m1.1.1.2.1.cmml" xref="algx1.l13.m1.1.1.2.1"></times><ci id="algx1.l13.m1.1.1.2.2.cmml" xref="algx1.l13.m1.1.1.2.2">𝑜</ci><ci id="algx1.l13.m1.1.1.2.3.cmml" xref="algx1.l13.m1.1.1.2.3">𝑏</ci><ci id="algx1.l13.m1.1.1.2.4.cmml" xref="algx1.l13.m1.1.1.2.4">𝑗</ci></apply><ci id="algx1.l13.m1.1.1.3.cmml" xref="algx1.l13.m1.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l13.m1.1c">obj&lt;\tau</annotation></semantics></math>:

</div>
<div id="algx1.l14" class="ltx_listingline">                    Early stop, set T as t

</div>
<div id="algx1.l15" class="ltx_listingline">       end for

</div>
<div id="algx1.l16" class="ltx_listingline">  <span id="algx1.l16.1" class="ltx_text ltx_font_bold">Output: </span> <math id="algx1.l16.m1.1" class="ltx_Math" alttext="\mathcal{X}^{(T+1)}" display="inline"><semantics id="algx1.l16.m1.1a"><msup id="algx1.l16.m1.1.2" xref="algx1.l16.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="algx1.l16.m1.1.2.2" xref="algx1.l16.m1.1.2.2.cmml">𝒳</mi><mrow id="algx1.l16.m1.1.1.1.1" xref="algx1.l16.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="algx1.l16.m1.1.1.1.1.2" xref="algx1.l16.m1.1.1.1.1.1.cmml">(</mo><mrow id="algx1.l16.m1.1.1.1.1.1" xref="algx1.l16.m1.1.1.1.1.1.cmml"><mi id="algx1.l16.m1.1.1.1.1.1.2" xref="algx1.l16.m1.1.1.1.1.1.2.cmml">T</mi><mo id="algx1.l16.m1.1.1.1.1.1.1" xref="algx1.l16.m1.1.1.1.1.1.1.cmml">+</mo><mn id="algx1.l16.m1.1.1.1.1.1.3" xref="algx1.l16.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="algx1.l16.m1.1.1.1.1.3" xref="algx1.l16.m1.1.1.1.1.1.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="algx1.l16.m1.1b"><apply id="algx1.l16.m1.1.2.cmml" xref="algx1.l16.m1.1.2"><csymbol cd="ambiguous" id="algx1.l16.m1.1.2.1.cmml" xref="algx1.l16.m1.1.2">superscript</csymbol><ci id="algx1.l16.m1.1.2.2.cmml" xref="algx1.l16.m1.1.2.2">𝒳</ci><apply id="algx1.l16.m1.1.1.1.1.1.cmml" xref="algx1.l16.m1.1.1.1.1"><plus id="algx1.l16.m1.1.1.1.1.1.1.cmml" xref="algx1.l16.m1.1.1.1.1.1.1"></plus><ci id="algx1.l16.m1.1.1.1.1.1.2.cmml" xref="algx1.l16.m1.1.1.1.1.1.2">𝑇</ci><cn type="integer" id="algx1.l16.m1.1.1.1.1.1.3.cmml" xref="algx1.l16.m1.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l16.m1.1c">\mathcal{X}^{(T+1)}</annotation></semantics></math>

</div>
</div>
</figure>
<div id="S7.SS1.p3" class="ltx_para">
<p id="S7.SS1.p3.4" class="ltx_p">Note that the equation in Eq. <a href="#S7.E5" title="Equation 5 ‣ 7.1 Simplex ETF &amp; Neural Collapse ‣ 7 Approach ‣ DiGeo: Discriminative Geometry-Aware Learning for Generalized Few-Shot Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> is a <em id="S7.SS1.p3.4.1" class="ltx_emph ltx_font_italic">closed-form</em> for obtaining an ETF but it is only used when <math id="S7.SS1.p3.1.m1.1" class="ltx_Math" alttext="d\leq N_{C}" display="inline"><semantics id="S7.SS1.p3.1.m1.1a"><mrow id="S7.SS1.p3.1.m1.1.1" xref="S7.SS1.p3.1.m1.1.1.cmml"><mi id="S7.SS1.p3.1.m1.1.1.2" xref="S7.SS1.p3.1.m1.1.1.2.cmml">d</mi><mo id="S7.SS1.p3.1.m1.1.1.1" xref="S7.SS1.p3.1.m1.1.1.1.cmml">≤</mo><msub id="S7.SS1.p3.1.m1.1.1.3" xref="S7.SS1.p3.1.m1.1.1.3.cmml"><mi id="S7.SS1.p3.1.m1.1.1.3.2" xref="S7.SS1.p3.1.m1.1.1.3.2.cmml">N</mi><mi id="S7.SS1.p3.1.m1.1.1.3.3" xref="S7.SS1.p3.1.m1.1.1.3.3.cmml">C</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S7.SS1.p3.1.m1.1b"><apply id="S7.SS1.p3.1.m1.1.1.cmml" xref="S7.SS1.p3.1.m1.1.1"><leq id="S7.SS1.p3.1.m1.1.1.1.cmml" xref="S7.SS1.p3.1.m1.1.1.1"></leq><ci id="S7.SS1.p3.1.m1.1.1.2.cmml" xref="S7.SS1.p3.1.m1.1.1.2">𝑑</ci><apply id="S7.SS1.p3.1.m1.1.1.3.cmml" xref="S7.SS1.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S7.SS1.p3.1.m1.1.1.3.1.cmml" xref="S7.SS1.p3.1.m1.1.1.3">subscript</csymbol><ci id="S7.SS1.p3.1.m1.1.1.3.2.cmml" xref="S7.SS1.p3.1.m1.1.1.3.2">𝑁</ci><ci id="S7.SS1.p3.1.m1.1.1.3.3.cmml" xref="S7.SS1.p3.1.m1.1.1.3.3">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p3.1.m1.1c">d\leq N_{C}</annotation></semantics></math>. When <math id="S7.SS1.p3.2.m2.1" class="ltx_Math" alttext="d=N_{C}+1" display="inline"><semantics id="S7.SS1.p3.2.m2.1a"><mrow id="S7.SS1.p3.2.m2.1.1" xref="S7.SS1.p3.2.m2.1.1.cmml"><mi id="S7.SS1.p3.2.m2.1.1.2" xref="S7.SS1.p3.2.m2.1.1.2.cmml">d</mi><mo id="S7.SS1.p3.2.m2.1.1.1" xref="S7.SS1.p3.2.m2.1.1.1.cmml">=</mo><mrow id="S7.SS1.p3.2.m2.1.1.3" xref="S7.SS1.p3.2.m2.1.1.3.cmml"><msub id="S7.SS1.p3.2.m2.1.1.3.2" xref="S7.SS1.p3.2.m2.1.1.3.2.cmml"><mi id="S7.SS1.p3.2.m2.1.1.3.2.2" xref="S7.SS1.p3.2.m2.1.1.3.2.2.cmml">N</mi><mi id="S7.SS1.p3.2.m2.1.1.3.2.3" xref="S7.SS1.p3.2.m2.1.1.3.2.3.cmml">C</mi></msub><mo id="S7.SS1.p3.2.m2.1.1.3.1" xref="S7.SS1.p3.2.m2.1.1.3.1.cmml">+</mo><mn id="S7.SS1.p3.2.m2.1.1.3.3" xref="S7.SS1.p3.2.m2.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.SS1.p3.2.m2.1b"><apply id="S7.SS1.p3.2.m2.1.1.cmml" xref="S7.SS1.p3.2.m2.1.1"><eq id="S7.SS1.p3.2.m2.1.1.1.cmml" xref="S7.SS1.p3.2.m2.1.1.1"></eq><ci id="S7.SS1.p3.2.m2.1.1.2.cmml" xref="S7.SS1.p3.2.m2.1.1.2">𝑑</ci><apply id="S7.SS1.p3.2.m2.1.1.3.cmml" xref="S7.SS1.p3.2.m2.1.1.3"><plus id="S7.SS1.p3.2.m2.1.1.3.1.cmml" xref="S7.SS1.p3.2.m2.1.1.3.1"></plus><apply id="S7.SS1.p3.2.m2.1.1.3.2.cmml" xref="S7.SS1.p3.2.m2.1.1.3.2"><csymbol cd="ambiguous" id="S7.SS1.p3.2.m2.1.1.3.2.1.cmml" xref="S7.SS1.p3.2.m2.1.1.3.2">subscript</csymbol><ci id="S7.SS1.p3.2.m2.1.1.3.2.2.cmml" xref="S7.SS1.p3.2.m2.1.1.3.2.2">𝑁</ci><ci id="S7.SS1.p3.2.m2.1.1.3.2.3.cmml" xref="S7.SS1.p3.2.m2.1.1.3.2.3">𝐶</ci></apply><cn type="integer" id="S7.SS1.p3.2.m2.1.1.3.3.cmml" xref="S7.SS1.p3.2.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p3.2.m2.1c">d=N_{C}+1</annotation></semantics></math>, we can then use an <em id="S7.SS1.p3.4.2" class="ltx_emph ltx_font_italic">iterative algorithm</em> to obtain the ETF. Specifically, we randomly initialize the values in <math id="S7.SS1.p3.3.m3.1" class="ltx_Math" alttext="W" display="inline"><semantics id="S7.SS1.p3.3.m3.1a"><mi id="S7.SS1.p3.3.m3.1.1" xref="S7.SS1.p3.3.m3.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S7.SS1.p3.3.m3.1b"><ci id="S7.SS1.p3.3.m3.1.1.cmml" xref="S7.SS1.p3.3.m3.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p3.3.m3.1c">W</annotation></semantics></math> and use the Eq.1 in the main paper to update the weight values. We provide the python-stype pseudo-code below. Note, since we want to maximize the objective function, we apply <math id="S7.SS1.p3.4.m4.1" class="ltx_Math" alttext="+" display="inline"><semantics id="S7.SS1.p3.4.m4.1a"><mo id="S7.SS1.p3.4.m4.1.1" xref="S7.SS1.p3.4.m4.1.1.cmml">+</mo><annotation-xml encoding="MathML-Content" id="S7.SS1.p3.4.m4.1b"><plus id="S7.SS1.p3.4.m4.1.1.cmml" xref="S7.SS1.p3.4.m4.1.1"></plus></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p3.4.m4.1c">+</annotation></semantics></math> in the weight updating part.</p>
</div>
</section>
</section>
<section id="S8" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">8 </span>Experiment</h2>

<section id="S8.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">8.1 </span>Implementation Details</h3>

<div id="S8.SS1.p1" class="ltx_para">
<p id="S8.SS1.p1.1" class="ltx_p">The Faster-RCNN system we are using consists of a ResNet-101 feature backbone, a RPN network, and a detection module. The detection module is used to extract features for each region proposal, a linear classifier and a regression for localization. As mentioned in the main paper,
since penultimate layer in the classification module is followed by a ReLU activation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, the proposal features are constrained to have non-negative entries and its distance to weights in <math id="S8.SS1.p1.1.m1.1" class="ltx_Math" alttext="W^{*}" display="inline"><semantics id="S8.SS1.p1.1.m1.1a"><msup id="S8.SS1.p1.1.m1.1.1" xref="S8.SS1.p1.1.m1.1.1.cmml"><mi id="S8.SS1.p1.1.m1.1.1.2" xref="S8.SS1.p1.1.m1.1.1.2.cmml">W</mi><mo id="S8.SS1.p1.1.m1.1.1.3" xref="S8.SS1.p1.1.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S8.SS1.p1.1.m1.1b"><apply id="S8.SS1.p1.1.m1.1.1.cmml" xref="S8.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S8.SS1.p1.1.m1.1.1.1.cmml" xref="S8.SS1.p1.1.m1.1.1">superscript</csymbol><ci id="S8.SS1.p1.1.m1.1.1.2.cmml" xref="S8.SS1.p1.1.m1.1.1.2">𝑊</ci><times id="S8.SS1.p1.1.m1.1.1.3.cmml" xref="S8.SS1.p1.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.SS1.p1.1.m1.1c">W^{*}</annotation></semantics></math> are lower-bounded, and we thus add a linear layer (projector) on top of the extractor of proposal feature. Meanwhile, as highlighted in Sec. 5.3 in the main paper, we do not need to pretrained the detector on the base set, but directly training everything from scratch, however, we will still use the ImageNet-pretrained model to initialize the feature extractor.</p>
</div>
<div id="S8.SS1.p2" class="ltx_para">
<p id="S8.SS1.p2.1" class="ltx_p">The dimension of proposal feature in Faster-RCNN is <math id="S8.SS1.p2.1.m1.1" class="ltx_Math" alttext="d=1024" display="inline"><semantics id="S8.SS1.p2.1.m1.1a"><mrow id="S8.SS1.p2.1.m1.1.1" xref="S8.SS1.p2.1.m1.1.1.cmml"><mi id="S8.SS1.p2.1.m1.1.1.2" xref="S8.SS1.p2.1.m1.1.1.2.cmml">d</mi><mo id="S8.SS1.p2.1.m1.1.1.1" xref="S8.SS1.p2.1.m1.1.1.1.cmml">=</mo><mn id="S8.SS1.p2.1.m1.1.1.3" xref="S8.SS1.p2.1.m1.1.1.3.cmml">1024</mn></mrow><annotation-xml encoding="MathML-Content" id="S8.SS1.p2.1.m1.1b"><apply id="S8.SS1.p2.1.m1.1.1.cmml" xref="S8.SS1.p2.1.m1.1.1"><eq id="S8.SS1.p2.1.m1.1.1.1.cmml" xref="S8.SS1.p2.1.m1.1.1.1"></eq><ci id="S8.SS1.p2.1.m1.1.1.2.cmml" xref="S8.SS1.p2.1.m1.1.1.2">𝑑</ci><cn type="integer" id="S8.SS1.p2.1.m1.1.1.3.cmml" xref="S8.SS1.p2.1.m1.1.1.3">1024</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.SS1.p2.1.m1.1c">d=1024</annotation></semantics></math> by default. As such, for experiments on MSCOCO and Pascao VOC, we set the projector with the same input and output dimension. However, for experiments on LVIS, since it has 1230 classes in v0.5 and 1203 classes in v1.0, we set the output dimension of projector as 1280.</p>
</div>
<div id="S8.SS1.p3" class="ltx_para">
<p id="S8.SS1.p3.1" class="ltx_p">During distillation, as we mainly focus on the learning of detector. As such, we fix the ResNet-101 feature backbone and the RPN network, and only distill the detection module. Also, during distillation, we do not apply any distillation strategy on the layer for localization. Then, we first use the fixed margin <math id="S8.SS1.p3.1.m1.2" class="ltx_Math" alttext="-\log(p_{c})" display="inline"><semantics id="S8.SS1.p3.1.m1.2a"><mrow id="S8.SS1.p3.1.m1.2.2" xref="S8.SS1.p3.1.m1.2.2.cmml"><mo rspace="0.167em" id="S8.SS1.p3.1.m1.2.2a" xref="S8.SS1.p3.1.m1.2.2.cmml">−</mo><mrow id="S8.SS1.p3.1.m1.2.2.1.1" xref="S8.SS1.p3.1.m1.2.2.1.2.cmml"><mi id="S8.SS1.p3.1.m1.1.1" xref="S8.SS1.p3.1.m1.1.1.cmml">log</mi><mo id="S8.SS1.p3.1.m1.2.2.1.1a" xref="S8.SS1.p3.1.m1.2.2.1.2.cmml">⁡</mo><mrow id="S8.SS1.p3.1.m1.2.2.1.1.1" xref="S8.SS1.p3.1.m1.2.2.1.2.cmml"><mo stretchy="false" id="S8.SS1.p3.1.m1.2.2.1.1.1.2" xref="S8.SS1.p3.1.m1.2.2.1.2.cmml">(</mo><msub id="S8.SS1.p3.1.m1.2.2.1.1.1.1" xref="S8.SS1.p3.1.m1.2.2.1.1.1.1.cmml"><mi id="S8.SS1.p3.1.m1.2.2.1.1.1.1.2" xref="S8.SS1.p3.1.m1.2.2.1.1.1.1.2.cmml">p</mi><mi id="S8.SS1.p3.1.m1.2.2.1.1.1.1.3" xref="S8.SS1.p3.1.m1.2.2.1.1.1.1.3.cmml">c</mi></msub><mo stretchy="false" id="S8.SS1.p3.1.m1.2.2.1.1.1.3" xref="S8.SS1.p3.1.m1.2.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S8.SS1.p3.1.m1.2b"><apply id="S8.SS1.p3.1.m1.2.2.cmml" xref="S8.SS1.p3.1.m1.2.2"><minus id="S8.SS1.p3.1.m1.2.2.2.cmml" xref="S8.SS1.p3.1.m1.2.2"></minus><apply id="S8.SS1.p3.1.m1.2.2.1.2.cmml" xref="S8.SS1.p3.1.m1.2.2.1.1"><log id="S8.SS1.p3.1.m1.1.1.cmml" xref="S8.SS1.p3.1.m1.1.1"></log><apply id="S8.SS1.p3.1.m1.2.2.1.1.1.1.cmml" xref="S8.SS1.p3.1.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S8.SS1.p3.1.m1.2.2.1.1.1.1.1.cmml" xref="S8.SS1.p3.1.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S8.SS1.p3.1.m1.2.2.1.1.1.1.2.cmml" xref="S8.SS1.p3.1.m1.2.2.1.1.1.1.2">𝑝</ci><ci id="S8.SS1.p3.1.m1.2.2.1.1.1.1.3.cmml" xref="S8.SS1.p3.1.m1.2.2.1.1.1.1.3">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.SS1.p3.1.m1.2c">-\log(p_{c})</annotation></semantics></math> in the loss and train the whole network. Then, during distillation, to fasten the training process, we can choose to also initialize the detector module with the pretrained teacher model.</p>
</div>
<section id="S8.SS1.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">RFS implementation details.</h4>

<div id="S8.SS1.SSS0.Px1.p1" class="ltx_para">
<p id="S8.SS1.SSS0.Px1.p1.1" class="ltx_p">We directly call the “RepeatFactorTrainingSample” as the training sampler function and send rfs parameter (0.01 for VOC &amp; COOC and 0.001 for LVIS) to the variable “SAMPLER TRAIN”</p>
</div>
</section>
</section>
<section id="S8.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">8.2 </span>Full experiment on Pascao VOC</h3>

<div id="S8.SS2.p1" class="ltx_para">
<p id="S8.SS2.p1.8" class="ltx_p">We summarize the performance of novel detection in Table <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:tab:voc-novel</span>.
Comparing with baseline TFA, over all 15 experiments on PASCAL VOC, the Prior baseline has already outperformed TFA by 3.6 gain in nAP<sub id="S8.SS2.p1.8.1" class="ltx_sub"><span id="S8.SS2.p1.8.1.1" class="ltx_text ltx_font_italic">50</span></sub> and 1.9 gain in bAP<sub id="S8.SS2.p1.8.2" class="ltx_sub"><span id="S8.SS2.p1.8.2.1" class="ltx_text ltx_font_italic">50</span></sub> on average. By performing the self-distillation to adjust margins for all classes <math id="S8.SS2.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{C}" display="inline"><semantics id="S8.SS2.p1.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S8.SS2.p1.3.m3.1.1" xref="S8.SS2.p1.3.m3.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S8.SS2.p1.3.m3.1b"><ci id="S8.SS2.p1.3.m3.1.1.cmml" xref="S8.SS2.p1.3.m3.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S8.SS2.p1.3.m3.1c">\mathcal{C}</annotation></semantics></math> adaptively, our full approach DiGeo can further improve the detection score, <em id="S8.SS2.p1.8.3" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S8.SS2.p1.8.4" class="ltx_text"></span>, comparable nAP<sub id="S8.SS2.p1.8.5" class="ltx_sub"><span id="S8.SS2.p1.8.5.1" class="ltx_text ltx_font_italic">50</span></sub> with MPSR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib57" title="" class="ltx_ref">57</a>]</cite> but maintaining high <span id="S8.SS2.p1.8.6" class="ltx_text ltx_font_italic">base</span> detection precision (81.3 Vs. 68.1).
As reported in Table 2 in the main paper, comparing with Retentive RCNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>, a state-of-the-art (SOTA) approach in GFSOD, besides maintaining precise base detection, our approach also improves the novel detection score (43.9 Vs. 41.1). Meanwhile, the superior performance by Retentive RCNN on split 1 when <math id="S8.SS2.p1.5.m5.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S8.SS2.p1.5.m5.1a"><mi id="S8.SS2.p1.5.m5.1.1" xref="S8.SS2.p1.5.m5.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S8.SS2.p1.5.m5.1b"><ci id="S8.SS2.p1.5.m5.1.1.cmml" xref="S8.SS2.p1.5.m5.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S8.SS2.p1.5.m5.1c">K</annotation></semantics></math> is <math id="S8.SS2.p1.6.m6.2" class="ltx_Math" alttext="\{1,2\}" display="inline"><semantics id="S8.SS2.p1.6.m6.2a"><mrow id="S8.SS2.p1.6.m6.2.3.2" xref="S8.SS2.p1.6.m6.2.3.1.cmml"><mo stretchy="false" id="S8.SS2.p1.6.m6.2.3.2.1" xref="S8.SS2.p1.6.m6.2.3.1.cmml">{</mo><mn id="S8.SS2.p1.6.m6.1.1" xref="S8.SS2.p1.6.m6.1.1.cmml">1</mn><mo id="S8.SS2.p1.6.m6.2.3.2.2" xref="S8.SS2.p1.6.m6.2.3.1.cmml">,</mo><mn id="S8.SS2.p1.6.m6.2.2" xref="S8.SS2.p1.6.m6.2.2.cmml">2</mn><mo stretchy="false" id="S8.SS2.p1.6.m6.2.3.2.3" xref="S8.SS2.p1.6.m6.2.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S8.SS2.p1.6.m6.2b"><set id="S8.SS2.p1.6.m6.2.3.1.cmml" xref="S8.SS2.p1.6.m6.2.3.2"><cn type="integer" id="S8.SS2.p1.6.m6.1.1.cmml" xref="S8.SS2.p1.6.m6.1.1">1</cn><cn type="integer" id="S8.SS2.p1.6.m6.2.2.cmml" xref="S8.SS2.p1.6.m6.2.2">2</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S8.SS2.p1.6.m6.2c">\{1,2\}</annotation></semantics></math> cannot be generalized to other splits. However, our approach achieves stable and consistent gain. Meanwhile, when more training data are provided, <em id="S8.SS2.p1.8.7" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S8.SS2.p1.8.8" class="ltx_text"></span>, <math id="S8.SS2.p1.7.m7.1" class="ltx_Math" alttext="K\geq 3" display="inline"><semantics id="S8.SS2.p1.7.m7.1a"><mrow id="S8.SS2.p1.7.m7.1.1" xref="S8.SS2.p1.7.m7.1.1.cmml"><mi id="S8.SS2.p1.7.m7.1.1.2" xref="S8.SS2.p1.7.m7.1.1.2.cmml">K</mi><mo id="S8.SS2.p1.7.m7.1.1.1" xref="S8.SS2.p1.7.m7.1.1.1.cmml">≥</mo><mn id="S8.SS2.p1.7.m7.1.1.3" xref="S8.SS2.p1.7.m7.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S8.SS2.p1.7.m7.1b"><apply id="S8.SS2.p1.7.m7.1.1.cmml" xref="S8.SS2.p1.7.m7.1.1"><geq id="S8.SS2.p1.7.m7.1.1.1.cmml" xref="S8.SS2.p1.7.m7.1.1.1"></geq><ci id="S8.SS2.p1.7.m7.1.1.2.cmml" xref="S8.SS2.p1.7.m7.1.1.2">𝐾</ci><cn type="integer" id="S8.SS2.p1.7.m7.1.1.3.cmml" xref="S8.SS2.p1.7.m7.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.SS2.p1.7.m7.1c">K\geq 3</annotation></semantics></math>, the advantage of our DiGeo is better explored and achieve 3.76 nAP<sub id="S8.SS2.p1.8.9" class="ltx_sub"><span id="S8.SS2.p1.8.9.1" class="ltx_text ltx_font_italic">50</span></sub> gain on average.</p>
</div>
<figure id="S8.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S8.T3.6.1.1" class="ltx_text" style="font-size:90%;">Table 3</span>: </span><span id="S8.T3.7.2" class="ltx_text" style="font-size:90%;">Detailed Performance of MS COCO dataset.</span></figcaption>
<div id="S8.T3.4" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:62.5pt;vertical-align:-0.7pt;"><span class="ltx_transformed_inner" style="transform:translate(-99.0pt,14.1pt) scale(0.686607456478714,0.686607456478714) ;">
<table id="S8.T3.4.4" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S8.T3.4.4.5.1" class="ltx_tr">
<th id="S8.T3.4.4.5.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r" style="padding-top:0.6pt;padding-bottom:0.6pt;" rowspan="2">
<span id="S8.T3.4.4.5.1.1.1" class="ltx_ERROR undefined">\hlineB</span>3
<span id="S8.T3.4.4.5.1.1.2" class="ltx_text">Approach</span>
</th>
<th id="S8.T3.4.4.5.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" style="padding-top:0.6pt;padding-bottom:0.6pt;" colspan="8">10-shot</th>
<th id="S8.T3.4.4.5.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column" style="padding-top:0.6pt;padding-bottom:0.6pt;" colspan="8">30-shot</th>
</tr>
<tr id="S8.T3.4.4.4" class="ltx_tr">
<th id="S8.T3.4.4.4.5" class="ltx_td ltx_align_center ltx_th ltx_th_column" style="padding-top:0.6pt;padding-bottom:0.6pt;">AP</th>
<th id="S8.T3.4.4.4.6" class="ltx_td ltx_align_center ltx_th ltx_th_column" style="padding-top:0.6pt;padding-bottom:0.6pt;">bAP</th>
<th id="S8.T3.4.4.4.7" class="ltx_td ltx_align_center ltx_th ltx_th_column" style="padding-top:0.6pt;padding-bottom:0.6pt;">nAP</th>
<th id="S8.T3.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column" style="padding-top:0.6pt;padding-bottom:0.6pt;">nAP<sub id="S8.T3.1.1.1.1.1" class="ltx_sub"><span id="S8.T3.1.1.1.1.1.1" class="ltx_text ltx_font_italic">50</span></sub>
</th>
<th id="S8.T3.2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column" style="padding-top:0.6pt;padding-bottom:0.6pt;">nAP<sub id="S8.T3.2.2.2.2.1" class="ltx_sub"><span id="S8.T3.2.2.2.2.1.1" class="ltx_text ltx_font_italic">75</span></sub>
</th>
<th id="S8.T3.4.4.4.8" class="ltx_td ltx_align_center ltx_th ltx_th_column" style="padding-top:0.6pt;padding-bottom:0.6pt;">nAPs</th>
<th id="S8.T3.4.4.4.9" class="ltx_td ltx_align_center ltx_th ltx_th_column" style="padding-top:0.6pt;padding-bottom:0.6pt;">nAPm</th>
<th id="S8.T3.4.4.4.10" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" style="padding-top:0.6pt;padding-bottom:0.6pt;">nAPl</th>
<th id="S8.T3.4.4.4.11" class="ltx_td ltx_align_center ltx_th ltx_th_column" style="padding-top:0.6pt;padding-bottom:0.6pt;">AP</th>
<th id="S8.T3.4.4.4.12" class="ltx_td ltx_align_center ltx_th ltx_th_column" style="padding-top:0.6pt;padding-bottom:0.6pt;">bAP</th>
<th id="S8.T3.4.4.4.13" class="ltx_td ltx_align_center ltx_th ltx_th_column" style="padding-top:0.6pt;padding-bottom:0.6pt;">nAP</th>
<th id="S8.T3.3.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column" style="padding-top:0.6pt;padding-bottom:0.6pt;">nAP<sub id="S8.T3.3.3.3.3.1" class="ltx_sub"><span id="S8.T3.3.3.3.3.1.1" class="ltx_text ltx_font_italic">50</span></sub>
</th>
<th id="S8.T3.4.4.4.4" class="ltx_td ltx_align_center ltx_th ltx_th_column" style="padding-top:0.6pt;padding-bottom:0.6pt;">nAP<sub id="S8.T3.4.4.4.4.1" class="ltx_sub"><span id="S8.T3.4.4.4.4.1.1" class="ltx_text ltx_font_italic">75</span></sub>
</th>
<th id="S8.T3.4.4.4.14" class="ltx_td ltx_align_center ltx_th ltx_th_column" style="padding-top:0.6pt;padding-bottom:0.6pt;">nAPs</th>
<th id="S8.T3.4.4.4.15" class="ltx_td ltx_align_center ltx_th ltx_th_column" style="padding-top:0.6pt;padding-bottom:0.6pt;">nAPm</th>
<th id="S8.T3.4.4.4.16" class="ltx_td ltx_align_center ltx_th ltx_th_column" style="padding-top:0.6pt;padding-bottom:0.6pt;">nAPl</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S8.T3.4.4.6.1" class="ltx_tr">
<th id="S8.T3.4.4.6.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">Prior</th>
<td id="S8.T3.4.4.6.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">31.5</td>
<td id="S8.T3.4.4.6.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">38.8</td>
<td id="S8.T3.4.4.6.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">9.6</td>
<td id="S8.T3.4.4.6.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">17.8</td>
<td id="S8.T3.4.4.6.1.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">9.2</td>
<td id="S8.T3.4.4.6.1.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">3.8</td>
<td id="S8.T3.4.4.6.1.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">9.3</td>
<td id="S8.T3.4.4.6.1.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">16.5</td>
<td id="S8.T3.4.4.6.1.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">32.5</td>
<td id="S8.T3.4.4.6.1.11" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">38.8</td>
<td id="S8.T3.4.4.6.1.12" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">13.6</td>
<td id="S8.T3.4.4.6.1.13" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">24.3</td>
<td id="S8.T3.4.4.6.1.14" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">13.3</td>
<td id="S8.T3.4.4.6.1.15" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">4.7</td>
<td id="S8.T3.4.4.6.1.16" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">11.9</td>
<td id="S8.T3.4.4.6.1.17" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">21.4</td>
</tr>
<tr id="S8.T3.4.4.7.2" class="ltx_tr">
<th id="S8.T3.4.4.7.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.6pt;padding-bottom:0.6pt;">DiGeo</th>
<td id="S8.T3.4.4.7.2.2" class="ltx_td ltx_align_center" style="padding-top:0.6pt;padding-bottom:0.6pt;">32.0</td>
<td id="S8.T3.4.4.7.2.3" class="ltx_td ltx_align_center" style="padding-top:0.6pt;padding-bottom:0.6pt;">39.2</td>
<td id="S8.T3.4.4.7.2.4" class="ltx_td ltx_align_center" style="padding-top:0.6pt;padding-bottom:0.6pt;">10.3</td>
<td id="S8.T3.4.4.7.2.5" class="ltx_td ltx_align_center" style="padding-top:0.6pt;padding-bottom:0.6pt;">18.7</td>
<td id="S8.T3.4.4.7.2.6" class="ltx_td ltx_align_center" style="padding-top:0.6pt;padding-bottom:0.6pt;">9.9</td>
<td id="S8.T3.4.4.7.2.7" class="ltx_td ltx_align_center" style="padding-top:0.6pt;padding-bottom:0.6pt;">4.5</td>
<td id="S8.T3.4.4.7.2.8" class="ltx_td ltx_align_center" style="padding-top:0.6pt;padding-bottom:0.6pt;">10.0</td>
<td id="S8.T3.4.4.7.2.9" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.6pt;padding-bottom:0.6pt;">16.8</td>
<td id="S8.T3.4.4.7.2.10" class="ltx_td ltx_align_center" style="padding-top:0.6pt;padding-bottom:0.6pt;">33.1</td>
<td id="S8.T3.4.4.7.2.11" class="ltx_td ltx_align_center" style="padding-top:0.6pt;padding-bottom:0.6pt;">39.4</td>
<td id="S8.T3.4.4.7.2.12" class="ltx_td ltx_align_center" style="padding-top:0.6pt;padding-bottom:0.6pt;">14.2</td>
<td id="S8.T3.4.4.7.2.13" class="ltx_td ltx_align_center" style="padding-top:0.6pt;padding-bottom:0.6pt;">26.2</td>
<td id="S8.T3.4.4.7.2.14" class="ltx_td ltx_align_center" style="padding-top:0.6pt;padding-bottom:0.6pt;">14.8</td>
<td id="S8.T3.4.4.7.2.15" class="ltx_td ltx_align_center" style="padding-top:0.6pt;padding-bottom:0.6pt;">5.3</td>
<td id="S8.T3.4.4.7.2.16" class="ltx_td ltx_align_center" style="padding-top:0.6pt;padding-bottom:0.6pt;">13.1</td>
<td id="S8.T3.4.4.7.2.17" class="ltx_td ltx_align_center" style="padding-top:0.6pt;padding-bottom:0.6pt;">23.9</td>
</tr>
<tr id="S8.T3.4.4.8.3" class="ltx_tr">
<th id="S8.T3.4.4.8.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.6pt;padding-bottom:0.6pt;">
<span id="S8.T3.4.4.8.3.1.1" class="ltx_ERROR undefined">\hlineB</span>3</th>
<td id="S8.T3.4.4.8.3.2" class="ltx_td" style="padding-top:0.6pt;padding-bottom:0.6pt;"></td>
<td id="S8.T3.4.4.8.3.3" class="ltx_td" style="padding-top:0.6pt;padding-bottom:0.6pt;"></td>
<td id="S8.T3.4.4.8.3.4" class="ltx_td" style="padding-top:0.6pt;padding-bottom:0.6pt;"></td>
<td id="S8.T3.4.4.8.3.5" class="ltx_td" style="padding-top:0.6pt;padding-bottom:0.6pt;"></td>
<td id="S8.T3.4.4.8.3.6" class="ltx_td" style="padding-top:0.6pt;padding-bottom:0.6pt;"></td>
<td id="S8.T3.4.4.8.3.7" class="ltx_td" style="padding-top:0.6pt;padding-bottom:0.6pt;"></td>
<td id="S8.T3.4.4.8.3.8" class="ltx_td" style="padding-top:0.6pt;padding-bottom:0.6pt;"></td>
<td id="S8.T3.4.4.8.3.9" class="ltx_td" style="padding-top:0.6pt;padding-bottom:0.6pt;"></td>
<td id="S8.T3.4.4.8.3.10" class="ltx_td" style="padding-top:0.6pt;padding-bottom:0.6pt;"></td>
<td id="S8.T3.4.4.8.3.11" class="ltx_td" style="padding-top:0.6pt;padding-bottom:0.6pt;"></td>
<td id="S8.T3.4.4.8.3.12" class="ltx_td" style="padding-top:0.6pt;padding-bottom:0.6pt;"></td>
<td id="S8.T3.4.4.8.3.13" class="ltx_td" style="padding-top:0.6pt;padding-bottom:0.6pt;"></td>
<td id="S8.T3.4.4.8.3.14" class="ltx_td" style="padding-top:0.6pt;padding-bottom:0.6pt;"></td>
<td id="S8.T3.4.4.8.3.15" class="ltx_td" style="padding-top:0.6pt;padding-bottom:0.6pt;"></td>
<td id="S8.T3.4.4.8.3.16" class="ltx_td" style="padding-top:0.6pt;padding-bottom:0.6pt;"></td>
<td id="S8.T3.4.4.8.3.17" class="ltx_td" style="padding-top:0.6pt;padding-bottom:0.6pt;"></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section id="S8.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">8.3 </span>Long-Tail Object Detection</h3>

<div id="S8.SS3.p1" class="ltx_para ltx_noindent">
<p id="S8.SS3.p1.6" class="ltx_p"><span id="S8.SS3.p1.6.1" class="ltx_text ltx_font_bold">LVIS</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> is derived from COCO17 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> and has two versions of annotations. The version v1.0 contains <math id="S8.SS3.p1.1.m1.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S8.SS3.p1.1.m1.1a"><mo id="S8.SS3.p1.1.m1.1.1" xref="S8.SS3.p1.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S8.SS3.p1.1.m1.1b"><csymbol cd="latexml" id="S8.SS3.p1.1.m1.1.1.cmml" xref="S8.SS3.p1.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S8.SS3.p1.1.m1.1c">\sim</annotation></semantics></math>1.3M training instances of 1203 classes while the version v0.5 has <math id="S8.SS3.p1.2.m2.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S8.SS3.p1.2.m2.1a"><mo id="S8.SS3.p1.2.m2.1.1" xref="S8.SS3.p1.2.m2.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S8.SS3.p1.2.m2.1b"><csymbol cd="latexml" id="S8.SS3.p1.2.m2.1.1.cmml" xref="S8.SS3.p1.2.m2.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S8.SS3.p1.2.m2.1c">\sim</annotation></semantics></math>0.7M training instances of 1230 classes. The one reported in the main paper is of v0.5. According to the number of training instances, the classes are divided into three groups, rare (1-10), common (11-100), and frequent (<math id="S8.SS3.p1.3.m3.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="S8.SS3.p1.3.m3.1a"><mo id="S8.SS3.p1.3.m3.1.1" xref="S8.SS3.p1.3.m3.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S8.SS3.p1.3.m3.1b"><gt id="S8.SS3.p1.3.m3.1.1.cmml" xref="S8.SS3.p1.3.m3.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S8.SS3.p1.3.m3.1c">&gt;</annotation></semantics></math>100).
Following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib55" title="" class="ltx_ref">55</a>]</cite>, apart from the precision for all classes (AP) on the validation set, we also report the precision for each group, <em id="S8.SS3.p1.6.2" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S8.SS3.p1.6.3" class="ltx_text"></span>, AP<sub id="S8.SS3.p1.6.4" class="ltx_sub"><span id="S8.SS3.p1.6.4.1" class="ltx_text ltx_font_italic">r</span></sub>, AP<sub id="S8.SS3.p1.6.5" class="ltx_sub"><span id="S8.SS3.p1.6.5.1" class="ltx_text ltx_font_italic">c</span></sub>, and AP<sub id="S8.SS3.p1.6.6" class="ltx_sub"><span id="S8.SS3.p1.6.6.1" class="ltx_text ltx_font_italic">f</span></sub>.
Meanwhile, following a common setup, we try two different backbones ResNet50 and ResNet101.</p>
</div>
<div id="S8.SS3.p2" class="ltx_para">
<p id="S8.SS3.p2.1" class="ltx_p">Here we try two different baseline, TFA and ACSL. We do acknowledge other related research on LVIS such as EFL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> and LOCE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>. However, these approaches are developed on Mask-RCNN framework, <em id="S8.SS3.p2.1.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S8.SS3.p2.1.2" class="ltx_text"></span>, both object detection and object segmentation are trained. Since object segmentation introduces extra supervision signals, while our focus is main on object detection, we thus choose ACSL as the baseline.</p>
</div>
<div id="S8.SS3.p3" class="ltx_para">
<p id="S8.SS3.p3.1" class="ltx_p">Comparing with ACSL, TFA also focus on object detection only but ACSL 1) applies a two step training strategy and 2) use the model pretrained on MSCOCO as initialization. In contrast, TFA only uses ImageNet-pretrained model to initialize the feature extractor. Meanwhile, it follow the configuration regarding learning rate and training epochs in the 1x Baseline but apply it on base training stage. As such, we consider both of these two setups. As such, we follow the training steps ACSL and use model pre-trained on MS COCO as initialization. From the Table  <a href="#S8.SS3" title="8.3 Long-Tail Object Detection ‣ 8 Experiment ‣ DiGeo: Discriminative Geometry-Aware Learning for Generalized Few-Shot Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8.3</span></a>, DiGeo can achieve consistent gain on two cases.</p>
</div>
<figure id="S8.SS3.tab1" class="ltx_table">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S8.SS3.tab1.1.1.1" class="ltx_text" style="font-size:90%;">Table M2</span>: </span><span id="S8.SS3.tab1.2.2" class="ltx_text" style="font-size:90%;">Performance comparison of LVIS dataset (Full Table)</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="S8.SS3.tab1.3" class="ltx_inline-block ltx_figure_panel ltx_transformed_outer" style="width:433.6pt;height:306pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(0.999962665534458,0.999962665534458) ;">
<table id="S8.SS3.tab1.3.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S8.SS3.tab1.3.1.1.1" class="ltx_tr">
<th id="S8.SS3.tab1.3.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" rowspan="2">
<span id="S8.SS3.tab1.3.1.1.1.1.1" class="ltx_ERROR undefined">\hlineB</span>3
<span id="S8.SS3.tab1.3.1.1.1.1.2" class="ltx_text">Approach</span>
</th>
<td id="S8.SS3.tab1.3.1.1.1.2" class="ltx_td ltx_align_center" colspan="4">ResNet-50</td>
<td id="S8.SS3.tab1.3.1.1.1.3" class="ltx_td ltx_align_center" colspan="4">ResNet-101</td>
</tr>
<tr id="S8.SS3.tab1.3.1.2.2" class="ltx_tr">
<td id="S8.SS3.tab1.3.1.2.2.1" class="ltx_td ltx_align_center">AP</td>
<td id="S8.SS3.tab1.3.1.2.2.2" class="ltx_td ltx_align_center">APr</td>
<td id="S8.SS3.tab1.3.1.2.2.3" class="ltx_td ltx_align_center">APc</td>
<td id="S8.SS3.tab1.3.1.2.2.4" class="ltx_td ltx_align_center">Apf</td>
<td id="S8.SS3.tab1.3.1.2.2.5" class="ltx_td ltx_align_center">AP</td>
<td id="S8.SS3.tab1.3.1.2.2.6" class="ltx_td ltx_align_center">APr</td>
<td id="S8.SS3.tab1.3.1.2.2.7" class="ltx_td ltx_align_center">APc</td>
<td id="S8.SS3.tab1.3.1.2.2.8" class="ltx_td ltx_align_center">Apf</td>
</tr>
<tr id="S8.SS3.tab1.3.1.3.3" class="ltx_tr">
<th id="S8.SS3.tab1.3.1.3.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="9">V0.5</th>
</tr>
<tr id="S8.SS3.tab1.3.1.4.4" class="ltx_tr">
<th id="S8.SS3.tab1.3.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">1x Baseline</th>
<td id="S8.SS3.tab1.3.1.4.4.2" class="ltx_td ltx_align_center ltx_border_t">22.7</td>
<td id="S8.SS3.tab1.3.1.4.4.3" class="ltx_td ltx_align_center ltx_border_t">10.6</td>
<td id="S8.SS3.tab1.3.1.4.4.4" class="ltx_td ltx_align_center ltx_border_t">22.0</td>
<td id="S8.SS3.tab1.3.1.4.4.5" class="ltx_td ltx_align_center ltx_border_t">28.0</td>
<td id="S8.SS3.tab1.3.1.4.4.6" class="ltx_td ltx_align_center ltx_border_t">24.5</td>
<td id="S8.SS3.tab1.3.1.4.4.7" class="ltx_td ltx_align_center ltx_border_t">13.1</td>
<td id="S8.SS3.tab1.3.1.4.4.8" class="ltx_td ltx_align_center ltx_border_t">23.9</td>
<td id="S8.SS3.tab1.3.1.4.4.9" class="ltx_td ltx_align_center ltx_border_t">30.0</td>
</tr>
<tr id="S8.SS3.tab1.3.1.5.5" class="ltx_tr">
<th id="S8.SS3.tab1.3.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">TFA w/ fc <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib55" title="" class="ltx_ref">55</a>]</cite>
</th>
<td id="S8.SS3.tab1.3.1.5.5.2" class="ltx_td ltx_align_center">24.1</td>
<td id="S8.SS3.tab1.3.1.5.5.3" class="ltx_td ltx_align_center">14.9</td>
<td id="S8.SS3.tab1.3.1.5.5.4" class="ltx_td ltx_align_center">23.9</td>
<td id="S8.SS3.tab1.3.1.5.5.5" class="ltx_td ltx_align_center">27.9</td>
<td id="S8.SS3.tab1.3.1.5.5.6" class="ltx_td ltx_align_center">-</td>
<td id="S8.SS3.tab1.3.1.5.5.7" class="ltx_td ltx_align_center">-</td>
<td id="S8.SS3.tab1.3.1.5.5.8" class="ltx_td ltx_align_center">-</td>
<td id="S8.SS3.tab1.3.1.5.5.9" class="ltx_td ltx_align_center">-</td>
</tr>
<tr id="S8.SS3.tab1.3.1.6.6" class="ltx_tr">
<th id="S8.SS3.tab1.3.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">TFA w/ cos <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib55" title="" class="ltx_ref">55</a>]</cite>
</th>
<td id="S8.SS3.tab1.3.1.6.6.2" class="ltx_td ltx_align_center">24.4</td>
<td id="S8.SS3.tab1.3.1.6.6.3" class="ltx_td ltx_align_center">16.9</td>
<td id="S8.SS3.tab1.3.1.6.6.4" class="ltx_td ltx_align_center">24.3</td>
<td id="S8.SS3.tab1.3.1.6.6.5" class="ltx_td ltx_align_center">27.7</td>
<td id="S8.SS3.tab1.3.1.6.6.6" class="ltx_td ltx_align_center">-</td>
<td id="S8.SS3.tab1.3.1.6.6.7" class="ltx_td ltx_align_center">-</td>
<td id="S8.SS3.tab1.3.1.6.6.8" class="ltx_td ltx_align_center">-</td>
<td id="S8.SS3.tab1.3.1.6.6.9" class="ltx_td ltx_align_center">-</td>
</tr>
<tr id="S8.SS3.tab1.3.1.7.7" class="ltx_tr">
<th id="S8.SS3.tab1.3.1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">DiGeo</th>
<td id="S8.SS3.tab1.3.1.7.7.2" class="ltx_td ltx_align_center">24.9</td>
<td id="S8.SS3.tab1.3.1.7.7.3" class="ltx_td ltx_align_center">17.3</td>
<td id="S8.SS3.tab1.3.1.7.7.4" class="ltx_td ltx_align_center">24.6</td>
<td id="S8.SS3.tab1.3.1.7.7.5" class="ltx_td ltx_align_center">28.5</td>
<td id="S8.SS3.tab1.3.1.7.7.6" class="ltx_td ltx_align_center">26.8</td>
<td id="S8.SS3.tab1.3.1.7.7.7" class="ltx_td ltx_align_center">18.5</td>
<td id="S8.SS3.tab1.3.1.7.7.8" class="ltx_td ltx_align_center">26.8</td>
<td id="S8.SS3.tab1.3.1.7.7.9" class="ltx_td ltx_align_center">30.1</td>
</tr>
<tr id="S8.SS3.tab1.3.1.8.8" class="ltx_tr">
<th id="S8.SS3.tab1.3.1.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">RFS <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>
</th>
<td id="S8.SS3.tab1.3.1.8.8.2" class="ltx_td ltx_align_center">24.9</td>
<td id="S8.SS3.tab1.3.1.8.8.3" class="ltx_td ltx_align_center">14.4</td>
<td id="S8.SS3.tab1.3.1.8.8.4" class="ltx_td ltx_align_center">24.5</td>
<td id="S8.SS3.tab1.3.1.8.8.5" class="ltx_td ltx_align_center">29.5</td>
<td id="S8.SS3.tab1.3.1.8.8.6" class="ltx_td ltx_align_center">-</td>
<td id="S8.SS3.tab1.3.1.8.8.7" class="ltx_td ltx_align_center">-</td>
<td id="S8.SS3.tab1.3.1.8.8.8" class="ltx_td ltx_align_center">-</td>
<td id="S8.SS3.tab1.3.1.8.8.9" class="ltx_td ltx_align_center">-</td>
</tr>
<tr id="S8.SS3.tab1.3.1.9.9" class="ltx_tr">
<th id="S8.SS3.tab1.3.1.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Focal Loss <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>
</th>
<td id="S8.SS3.tab1.3.1.9.9.2" class="ltx_td ltx_align_center">22.0</td>
<td id="S8.SS3.tab1.3.1.9.9.3" class="ltx_td ltx_align_center">10.5</td>
<td id="S8.SS3.tab1.3.1.9.9.4" class="ltx_td ltx_align_center">22.4</td>
<td id="S8.SS3.tab1.3.1.9.9.5" class="ltx_td ltx_align_center">25.9</td>
<td id="S8.SS3.tab1.3.1.9.9.6" class="ltx_td ltx_align_center">-</td>
<td id="S8.SS3.tab1.3.1.9.9.7" class="ltx_td ltx_align_center">-</td>
<td id="S8.SS3.tab1.3.1.9.9.8" class="ltx_td ltx_align_center">-</td>
<td id="S8.SS3.tab1.3.1.9.9.9" class="ltx_td ltx_align_center">-</td>
</tr>
<tr id="S8.SS3.tab1.3.1.10.10" class="ltx_tr">
<th id="S8.SS3.tab1.3.1.10.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">EQL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>]</cite>
</th>
<td id="S8.SS3.tab1.3.1.10.10.2" class="ltx_td ltx_align_center">25.1</td>
<td id="S8.SS3.tab1.3.1.10.10.3" class="ltx_td ltx_align_center">11.9</td>
<td id="S8.SS3.tab1.3.1.10.10.4" class="ltx_td ltx_align_center">26.0</td>
<td id="S8.SS3.tab1.3.1.10.10.5" class="ltx_td ltx_align_center">29.1</td>
<td id="S8.SS3.tab1.3.1.10.10.6" class="ltx_td ltx_align_center">26.1</td>
<td id="S8.SS3.tab1.3.1.10.10.7" class="ltx_td ltx_align_center">11.5</td>
<td id="S8.SS3.tab1.3.1.10.10.8" class="ltx_td ltx_align_center">27.1</td>
<td id="S8.SS3.tab1.3.1.10.10.9" class="ltx_td ltx_align_center">30.5</td>
</tr>
<tr id="S8.SS3.tab1.3.1.11.11" class="ltx_tr">
<th id="S8.SS3.tab1.3.1.11.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">BAGS <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>
</th>
<td id="S8.SS3.tab1.3.1.11.11.2" class="ltx_td ltx_align_center">26.0</td>
<td id="S8.SS3.tab1.3.1.11.11.3" class="ltx_td ltx_align_center">17.7</td>
<td id="S8.SS3.tab1.3.1.11.11.4" class="ltx_td ltx_align_center">25.8</td>
<td id="S8.SS3.tab1.3.1.11.11.5" class="ltx_td ltx_align_center">29.5</td>
<td id="S8.SS3.tab1.3.1.11.11.6" class="ltx_td ltx_align_center">26.4</td>
<td id="S8.SS3.tab1.3.1.11.11.7" class="ltx_td ltx_align_center">16.8</td>
<td id="S8.SS3.tab1.3.1.11.11.8" class="ltx_td ltx_align_center">25.8</td>
<td id="S8.SS3.tab1.3.1.11.11.9" class="ltx_td ltx_align_center">30.9</td>
</tr>
<tr id="S8.SS3.tab1.3.1.12.12" class="ltx_tr">
<th id="S8.SS3.tab1.3.1.12.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">ACSL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib54" title="" class="ltx_ref">54</a>]</cite>
</th>
<td id="S8.SS3.tab1.3.1.12.12.2" class="ltx_td ltx_align_center">26.4</td>
<td id="S8.SS3.tab1.3.1.12.12.3" class="ltx_td ltx_align_center">18.6</td>
<td id="S8.SS3.tab1.3.1.12.12.4" class="ltx_td ltx_align_center">26.4</td>
<td id="S8.SS3.tab1.3.1.12.12.5" class="ltx_td ltx_align_center">29.4</td>
<td id="S8.SS3.tab1.3.1.12.12.6" class="ltx_td ltx_align_center">27.5</td>
<td id="S8.SS3.tab1.3.1.12.12.7" class="ltx_td ltx_align_center">19.3</td>
<td id="S8.SS3.tab1.3.1.12.12.8" class="ltx_td ltx_align_center">27.6</td>
<td id="S8.SS3.tab1.3.1.12.12.9" class="ltx_td ltx_align_center">30.7</td>
</tr>
<tr id="S8.SS3.tab1.3.1.13.13" class="ltx_tr">
<th id="S8.SS3.tab1.3.1.13.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">DiGeo</th>
<td id="S8.SS3.tab1.3.1.13.13.2" class="ltx_td ltx_align_center">26.7</td>
<td id="S8.SS3.tab1.3.1.13.13.3" class="ltx_td ltx_align_center">18.9</td>
<td id="S8.SS3.tab1.3.1.13.13.4" class="ltx_td ltx_align_center">27.0</td>
<td id="S8.SS3.tab1.3.1.13.13.5" class="ltx_td ltx_align_center">29.0</td>
<td id="S8.SS3.tab1.3.1.13.13.6" class="ltx_td ltx_align_center">27.9</td>
<td id="S8.SS3.tab1.3.1.13.13.7" class="ltx_td ltx_align_center">19.5</td>
<td id="S8.SS3.tab1.3.1.13.13.8" class="ltx_td ltx_align_center">28.0</td>
<td id="S8.SS3.tab1.3.1.13.13.9" class="ltx_td ltx_align_center">31.0</td>
</tr>
<tr id="S8.SS3.tab1.3.1.14.14" class="ltx_tr">
<th id="S8.SS3.tab1.3.1.14.14.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="9">V1.0</th>
</tr>
<tr id="S8.SS3.tab1.3.1.15.15" class="ltx_tr">
<th id="S8.SS3.tab1.3.1.15.15.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">1x Baseline</th>
<td id="S8.SS3.tab1.3.1.15.15.2" class="ltx_td ltx_align_center ltx_border_t">19.3</td>
<td id="S8.SS3.tab1.3.1.15.15.3" class="ltx_td ltx_align_center ltx_border_t">6.4</td>
<td id="S8.SS3.tab1.3.1.15.15.4" class="ltx_td ltx_align_center ltx_border_t">17.1</td>
<td id="S8.SS3.tab1.3.1.15.15.5" class="ltx_td ltx_align_center ltx_border_t">27.6</td>
<td id="S8.SS3.tab1.3.1.15.15.6" class="ltx_td ltx_align_center ltx_border_t">21.1</td>
<td id="S8.SS3.tab1.3.1.15.15.7" class="ltx_td ltx_align_center ltx_border_t">10.1</td>
<td id="S8.SS3.tab1.3.1.15.15.8" class="ltx_td ltx_align_center ltx_border_t">21.7</td>
<td id="S8.SS3.tab1.3.1.15.15.9" class="ltx_td ltx_align_center ltx_border_t">25.8</td>
</tr>
<tr id="S8.SS3.tab1.3.1.16.16" class="ltx_tr">
<th id="S8.SS3.tab1.3.1.16.16.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">DiGeo</th>
<td id="S8.SS3.tab1.3.1.16.16.2" class="ltx_td ltx_align_center">22.5</td>
<td id="S8.SS3.tab1.3.1.16.16.3" class="ltx_td ltx_align_center">12.4</td>
<td id="S8.SS3.tab1.3.1.16.16.4" class="ltx_td ltx_align_center">20.6</td>
<td id="S8.SS3.tab1.3.1.16.16.5" class="ltx_td ltx_align_center">26.8</td>
<td id="S8.SS3.tab1.3.1.16.16.6" class="ltx_td ltx_align_center">24.4</td>
<td id="S8.SS3.tab1.3.1.16.16.7" class="ltx_td ltx_align_center">16.6</td>
<td id="S8.SS3.tab1.3.1.16.16.8" class="ltx_td ltx_align_center">22.8</td>
<td id="S8.SS3.tab1.3.1.16.16.9" class="ltx_td ltx_align_center">28.0</td>
</tr>
</tbody>
<tfoot class="ltx_tfoot">
<tr id="S8.SS3.tab1.3.1.17.1" class="ltx_tr">
<th id="S8.SS3.tab1.3.1.17.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" colspan="9">
<span id="S8.SS3.tab1.3.1.17.1.1.1" class="ltx_ERROR undefined">\hlineB</span>3                The configuration of 1x Baseline can be found in the TFA official repo.</th>
</tr>
</tfoot>
</table>
</span></div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<section id="S9" class="ltx_section ltx_figure_panel">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">9 </span>Discussion</h2>

<section id="S9.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">9.1 </span>Decoupling localization from classification.</h3>

<div id="S9.SS1.p1" class="ltx_para">
<p id="S9.SS1.p1.2" class="ltx_p">Consistent with the observation in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite>, by enhancing inter-class separation and intra-class compactness, the detection scores are improved. However, the features for localization should still be class-independent (<em id="S9.SS1.p1.2.1" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S9.SS1.p1.2.2" class="ltx_text"></span>, bus and elephant has similar shape).
From the implementation details, a projector is set where its input &amp; output are used for localization &amp; classification separately.
Then, sharing the features for localization and classification will lead to slight performance drop (<em id="S9.SS1.p1.2.3" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S9.SS1.p1.2.4" class="ltx_text"></span>, AP<sub id="S9.SS1.p1.2.5" class="ltx_sub"><span id="S9.SS1.p1.2.5.1" class="ltx_text ltx_font_italic">50</span></sub> 74.0, nAP<sub id="S9.SS1.p1.2.6" class="ltx_sub"><span id="S9.SS1.p1.2.6.1" class="ltx_text ltx_font_italic">50</span></sub> 55.6).
As such, it is important to decouple the features for localization and classification and employing a simple linear projector has been shown to be userful.</p>
</div>
</section>
<section id="S9.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">9.2 </span>Design of Background class</h3>

<div id="S9.SS2.p1" class="ltx_para">
<p id="S9.SS2.p1.1" class="ltx_p">An object detector should reject the background and not recognize it as any foreground object. As such, a background class <math id="S9.SS2.p1.1.m1.1" class="ltx_Math" alttext="c_{-}{}" display="inline"><semantics id="S9.SS2.p1.1.m1.1a"><msub id="S9.SS2.p1.1.m1.1.1" xref="S9.SS2.p1.1.m1.1.1.cmml"><mi id="S9.SS2.p1.1.m1.1.1.2" xref="S9.SS2.p1.1.m1.1.1.2.cmml">c</mi><mo id="S9.SS2.p1.1.m1.1.1.3" xref="S9.SS2.p1.1.m1.1.1.3.cmml">−</mo></msub><annotation-xml encoding="MathML-Content" id="S9.SS2.p1.1.m1.1b"><apply id="S9.SS2.p1.1.m1.1.1.cmml" xref="S9.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S9.SS2.p1.1.m1.1.1.1.cmml" xref="S9.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S9.SS2.p1.1.m1.1.1.2.cmml" xref="S9.SS2.p1.1.m1.1.1.2">𝑐</ci><minus id="S9.SS2.p1.1.m1.1.1.3.cmml" xref="S9.SS2.p1.1.m1.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="S9.SS2.p1.1.m1.1c">c_{-}{}</annotation></semantics></math> is set as a placeholder and is trained to have high similarity with background proposals. Different from foreground objects, as background proposals can be diverse, we considered different strategies in designing the background class center.</p>
</div>
<div id="S9.SS2.p2" class="ltx_para">
<p id="S9.SS2.p2.10" class="ltx_p">We first choose to separate the design of <math id="S9.SS2.p2.1.m1.1" class="ltx_Math" alttext="W_{b}\cup W_{n}" display="inline"><semantics id="S9.SS2.p2.1.m1.1a"><mrow id="S9.SS2.p2.1.m1.1.1" xref="S9.SS2.p2.1.m1.1.1.cmml"><msub id="S9.SS2.p2.1.m1.1.1.2" xref="S9.SS2.p2.1.m1.1.1.2.cmml"><mi id="S9.SS2.p2.1.m1.1.1.2.2" xref="S9.SS2.p2.1.m1.1.1.2.2.cmml">W</mi><mi id="S9.SS2.p2.1.m1.1.1.2.3" xref="S9.SS2.p2.1.m1.1.1.2.3.cmml">b</mi></msub><mo id="S9.SS2.p2.1.m1.1.1.1" xref="S9.SS2.p2.1.m1.1.1.1.cmml">∪</mo><msub id="S9.SS2.p2.1.m1.1.1.3" xref="S9.SS2.p2.1.m1.1.1.3.cmml"><mi id="S9.SS2.p2.1.m1.1.1.3.2" xref="S9.SS2.p2.1.m1.1.1.3.2.cmml">W</mi><mi id="S9.SS2.p2.1.m1.1.1.3.3" xref="S9.SS2.p2.1.m1.1.1.3.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S9.SS2.p2.1.m1.1b"><apply id="S9.SS2.p2.1.m1.1.1.cmml" xref="S9.SS2.p2.1.m1.1.1"><union id="S9.SS2.p2.1.m1.1.1.1.cmml" xref="S9.SS2.p2.1.m1.1.1.1"></union><apply id="S9.SS2.p2.1.m1.1.1.2.cmml" xref="S9.SS2.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S9.SS2.p2.1.m1.1.1.2.1.cmml" xref="S9.SS2.p2.1.m1.1.1.2">subscript</csymbol><ci id="S9.SS2.p2.1.m1.1.1.2.2.cmml" xref="S9.SS2.p2.1.m1.1.1.2.2">𝑊</ci><ci id="S9.SS2.p2.1.m1.1.1.2.3.cmml" xref="S9.SS2.p2.1.m1.1.1.2.3">𝑏</ci></apply><apply id="S9.SS2.p2.1.m1.1.1.3.cmml" xref="S9.SS2.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S9.SS2.p2.1.m1.1.1.3.1.cmml" xref="S9.SS2.p2.1.m1.1.1.3">subscript</csymbol><ci id="S9.SS2.p2.1.m1.1.1.3.2.cmml" xref="S9.SS2.p2.1.m1.1.1.3.2">𝑊</ci><ci id="S9.SS2.p2.1.m1.1.1.3.3.cmml" xref="S9.SS2.p2.1.m1.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S9.SS2.p2.1.m1.1c">W_{b}\cup W_{n}</annotation></semantics></math> and <math id="S9.SS2.p2.2.m2.1" class="ltx_Math" alttext="\mathbf{w}_{c_{-}{}}" display="inline"><semantics id="S9.SS2.p2.2.m2.1a"><msub id="S9.SS2.p2.2.m2.1.1" xref="S9.SS2.p2.2.m2.1.1.cmml"><mi id="S9.SS2.p2.2.m2.1.1.2" xref="S9.SS2.p2.2.m2.1.1.2.cmml">𝐰</mi><msub id="S9.SS2.p2.2.m2.1.1.3" xref="S9.SS2.p2.2.m2.1.1.3.cmml"><mi id="S9.SS2.p2.2.m2.1.1.3.2" xref="S9.SS2.p2.2.m2.1.1.3.2.cmml">c</mi><mo id="S9.SS2.p2.2.m2.1.1.3.3" xref="S9.SS2.p2.2.m2.1.1.3.3.cmml">−</mo></msub></msub><annotation-xml encoding="MathML-Content" id="S9.SS2.p2.2.m2.1b"><apply id="S9.SS2.p2.2.m2.1.1.cmml" xref="S9.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S9.SS2.p2.2.m2.1.1.1.cmml" xref="S9.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S9.SS2.p2.2.m2.1.1.2.cmml" xref="S9.SS2.p2.2.m2.1.1.2">𝐰</ci><apply id="S9.SS2.p2.2.m2.1.1.3.cmml" xref="S9.SS2.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S9.SS2.p2.2.m2.1.1.3.1.cmml" xref="S9.SS2.p2.2.m2.1.1.3">subscript</csymbol><ci id="S9.SS2.p2.2.m2.1.1.3.2.cmml" xref="S9.SS2.p2.2.m2.1.1.3.2">𝑐</ci><minus id="S9.SS2.p2.2.m2.1.1.3.3.cmml" xref="S9.SS2.p2.2.m2.1.1.3.3"></minus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S9.SS2.p2.2.m2.1c">\mathbf{w}_{c_{-}{}}</annotation></semantics></math>, <em id="S9.SS2.p2.10.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S9.SS2.p2.10.2" class="ltx_text"></span>, deriving fixed offline weights for <math id="S9.SS2.p2.3.m3.1" class="ltx_Math" alttext="\mathcal{C}_{b}{}\cup\mathcal{C}_{n}{}" display="inline"><semantics id="S9.SS2.p2.3.m3.1a"><mrow id="S9.SS2.p2.3.m3.1.1" xref="S9.SS2.p2.3.m3.1.1.cmml"><msub id="S9.SS2.p2.3.m3.1.1.2" xref="S9.SS2.p2.3.m3.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S9.SS2.p2.3.m3.1.1.2.2" xref="S9.SS2.p2.3.m3.1.1.2.2.cmml">𝒞</mi><mi id="S9.SS2.p2.3.m3.1.1.2.3" xref="S9.SS2.p2.3.m3.1.1.2.3.cmml">b</mi></msub><mo id="S9.SS2.p2.3.m3.1.1.1" xref="S9.SS2.p2.3.m3.1.1.1.cmml">∪</mo><msub id="S9.SS2.p2.3.m3.1.1.3" xref="S9.SS2.p2.3.m3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S9.SS2.p2.3.m3.1.1.3.2" xref="S9.SS2.p2.3.m3.1.1.3.2.cmml">𝒞</mi><mi id="S9.SS2.p2.3.m3.1.1.3.3" xref="S9.SS2.p2.3.m3.1.1.3.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S9.SS2.p2.3.m3.1b"><apply id="S9.SS2.p2.3.m3.1.1.cmml" xref="S9.SS2.p2.3.m3.1.1"><union id="S9.SS2.p2.3.m3.1.1.1.cmml" xref="S9.SS2.p2.3.m3.1.1.1"></union><apply id="S9.SS2.p2.3.m3.1.1.2.cmml" xref="S9.SS2.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="S9.SS2.p2.3.m3.1.1.2.1.cmml" xref="S9.SS2.p2.3.m3.1.1.2">subscript</csymbol><ci id="S9.SS2.p2.3.m3.1.1.2.2.cmml" xref="S9.SS2.p2.3.m3.1.1.2.2">𝒞</ci><ci id="S9.SS2.p2.3.m3.1.1.2.3.cmml" xref="S9.SS2.p2.3.m3.1.1.2.3">𝑏</ci></apply><apply id="S9.SS2.p2.3.m3.1.1.3.cmml" xref="S9.SS2.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S9.SS2.p2.3.m3.1.1.3.1.cmml" xref="S9.SS2.p2.3.m3.1.1.3">subscript</csymbol><ci id="S9.SS2.p2.3.m3.1.1.3.2.cmml" xref="S9.SS2.p2.3.m3.1.1.3.2">𝒞</ci><ci id="S9.SS2.p2.3.m3.1.1.3.3.cmml" xref="S9.SS2.p2.3.m3.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S9.SS2.p2.3.m3.1c">\mathcal{C}_{b}{}\cup\mathcal{C}_{n}{}</annotation></semantics></math> only but learn the weight <math id="S9.SS2.p2.4.m4.1" class="ltx_Math" alttext="\mathbf{w}_{c_{-}{}}" display="inline"><semantics id="S9.SS2.p2.4.m4.1a"><msub id="S9.SS2.p2.4.m4.1.1" xref="S9.SS2.p2.4.m4.1.1.cmml"><mi id="S9.SS2.p2.4.m4.1.1.2" xref="S9.SS2.p2.4.m4.1.1.2.cmml">𝐰</mi><msub id="S9.SS2.p2.4.m4.1.1.3" xref="S9.SS2.p2.4.m4.1.1.3.cmml"><mi id="S9.SS2.p2.4.m4.1.1.3.2" xref="S9.SS2.p2.4.m4.1.1.3.2.cmml">c</mi><mo id="S9.SS2.p2.4.m4.1.1.3.3" xref="S9.SS2.p2.4.m4.1.1.3.3.cmml">−</mo></msub></msub><annotation-xml encoding="MathML-Content" id="S9.SS2.p2.4.m4.1b"><apply id="S9.SS2.p2.4.m4.1.1.cmml" xref="S9.SS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S9.SS2.p2.4.m4.1.1.1.cmml" xref="S9.SS2.p2.4.m4.1.1">subscript</csymbol><ci id="S9.SS2.p2.4.m4.1.1.2.cmml" xref="S9.SS2.p2.4.m4.1.1.2">𝐰</ci><apply id="S9.SS2.p2.4.m4.1.1.3.cmml" xref="S9.SS2.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S9.SS2.p2.4.m4.1.1.3.1.cmml" xref="S9.SS2.p2.4.m4.1.1.3">subscript</csymbol><ci id="S9.SS2.p2.4.m4.1.1.3.2.cmml" xref="S9.SS2.p2.4.m4.1.1.3.2">𝑐</ci><minus id="S9.SS2.p2.4.m4.1.1.3.3.cmml" xref="S9.SS2.p2.4.m4.1.1.3.3"></minus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S9.SS2.p2.4.m4.1c">\mathbf{w}_{c_{-}{}}</annotation></semantics></math>. Then, we follow the open-set strategy <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib66" title="" class="ltx_ref">66</a>]</cite> to set multiple background centers <math id="S9.SS2.p2.5.m5.2" class="ltx_Math" alttext="W_{-}=\{\mathbf{w}_{c_{-}{}}^{(i)}\}_{i=1}^{N_{-}}" display="inline"><semantics id="S9.SS2.p2.5.m5.2a"><mrow id="S9.SS2.p2.5.m5.2.2" xref="S9.SS2.p2.5.m5.2.2.cmml"><msub id="S9.SS2.p2.5.m5.2.2.3" xref="S9.SS2.p2.5.m5.2.2.3.cmml"><mi id="S9.SS2.p2.5.m5.2.2.3.2" xref="S9.SS2.p2.5.m5.2.2.3.2.cmml">W</mi><mo id="S9.SS2.p2.5.m5.2.2.3.3" xref="S9.SS2.p2.5.m5.2.2.3.3.cmml">−</mo></msub><mo id="S9.SS2.p2.5.m5.2.2.2" xref="S9.SS2.p2.5.m5.2.2.2.cmml">=</mo><msubsup id="S9.SS2.p2.5.m5.2.2.1" xref="S9.SS2.p2.5.m5.2.2.1.cmml"><mrow id="S9.SS2.p2.5.m5.2.2.1.1.1.1" xref="S9.SS2.p2.5.m5.2.2.1.1.1.2.cmml"><mo stretchy="false" id="S9.SS2.p2.5.m5.2.2.1.1.1.1.2" xref="S9.SS2.p2.5.m5.2.2.1.1.1.2.cmml">{</mo><msubsup id="S9.SS2.p2.5.m5.2.2.1.1.1.1.1" xref="S9.SS2.p2.5.m5.2.2.1.1.1.1.1.cmml"><mi id="S9.SS2.p2.5.m5.2.2.1.1.1.1.1.2.2" xref="S9.SS2.p2.5.m5.2.2.1.1.1.1.1.2.2.cmml">𝐰</mi><msub id="S9.SS2.p2.5.m5.2.2.1.1.1.1.1.2.3" xref="S9.SS2.p2.5.m5.2.2.1.1.1.1.1.2.3.cmml"><mi id="S9.SS2.p2.5.m5.2.2.1.1.1.1.1.2.3.2" xref="S9.SS2.p2.5.m5.2.2.1.1.1.1.1.2.3.2.cmml">c</mi><mo id="S9.SS2.p2.5.m5.2.2.1.1.1.1.1.2.3.3" xref="S9.SS2.p2.5.m5.2.2.1.1.1.1.1.2.3.3.cmml">−</mo></msub><mrow id="S9.SS2.p2.5.m5.1.1.1.3" xref="S9.SS2.p2.5.m5.2.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S9.SS2.p2.5.m5.1.1.1.3.1" xref="S9.SS2.p2.5.m5.2.2.1.1.1.1.1.cmml">(</mo><mi id="S9.SS2.p2.5.m5.1.1.1.1" xref="S9.SS2.p2.5.m5.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S9.SS2.p2.5.m5.1.1.1.3.2" xref="S9.SS2.p2.5.m5.2.2.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S9.SS2.p2.5.m5.2.2.1.1.1.1.3" xref="S9.SS2.p2.5.m5.2.2.1.1.1.2.cmml">}</mo></mrow><mrow id="S9.SS2.p2.5.m5.2.2.1.1.3" xref="S9.SS2.p2.5.m5.2.2.1.1.3.cmml"><mi id="S9.SS2.p2.5.m5.2.2.1.1.3.2" xref="S9.SS2.p2.5.m5.2.2.1.1.3.2.cmml">i</mi><mo id="S9.SS2.p2.5.m5.2.2.1.1.3.1" xref="S9.SS2.p2.5.m5.2.2.1.1.3.1.cmml">=</mo><mn id="S9.SS2.p2.5.m5.2.2.1.1.3.3" xref="S9.SS2.p2.5.m5.2.2.1.1.3.3.cmml">1</mn></mrow><msub id="S9.SS2.p2.5.m5.2.2.1.3" xref="S9.SS2.p2.5.m5.2.2.1.3.cmml"><mi id="S9.SS2.p2.5.m5.2.2.1.3.2" xref="S9.SS2.p2.5.m5.2.2.1.3.2.cmml">N</mi><mo id="S9.SS2.p2.5.m5.2.2.1.3.3" xref="S9.SS2.p2.5.m5.2.2.1.3.3.cmml">−</mo></msub></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S9.SS2.p2.5.m5.2b"><apply id="S9.SS2.p2.5.m5.2.2.cmml" xref="S9.SS2.p2.5.m5.2.2"><eq id="S9.SS2.p2.5.m5.2.2.2.cmml" xref="S9.SS2.p2.5.m5.2.2.2"></eq><apply id="S9.SS2.p2.5.m5.2.2.3.cmml" xref="S9.SS2.p2.5.m5.2.2.3"><csymbol cd="ambiguous" id="S9.SS2.p2.5.m5.2.2.3.1.cmml" xref="S9.SS2.p2.5.m5.2.2.3">subscript</csymbol><ci id="S9.SS2.p2.5.m5.2.2.3.2.cmml" xref="S9.SS2.p2.5.m5.2.2.3.2">𝑊</ci><minus id="S9.SS2.p2.5.m5.2.2.3.3.cmml" xref="S9.SS2.p2.5.m5.2.2.3.3"></minus></apply><apply id="S9.SS2.p2.5.m5.2.2.1.cmml" xref="S9.SS2.p2.5.m5.2.2.1"><csymbol cd="ambiguous" id="S9.SS2.p2.5.m5.2.2.1.2.cmml" xref="S9.SS2.p2.5.m5.2.2.1">superscript</csymbol><apply id="S9.SS2.p2.5.m5.2.2.1.1.cmml" xref="S9.SS2.p2.5.m5.2.2.1"><csymbol cd="ambiguous" id="S9.SS2.p2.5.m5.2.2.1.1.2.cmml" xref="S9.SS2.p2.5.m5.2.2.1">subscript</csymbol><set id="S9.SS2.p2.5.m5.2.2.1.1.1.2.cmml" xref="S9.SS2.p2.5.m5.2.2.1.1.1.1"><apply id="S9.SS2.p2.5.m5.2.2.1.1.1.1.1.cmml" xref="S9.SS2.p2.5.m5.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S9.SS2.p2.5.m5.2.2.1.1.1.1.1.1.cmml" xref="S9.SS2.p2.5.m5.2.2.1.1.1.1.1">superscript</csymbol><apply id="S9.SS2.p2.5.m5.2.2.1.1.1.1.1.2.cmml" xref="S9.SS2.p2.5.m5.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S9.SS2.p2.5.m5.2.2.1.1.1.1.1.2.1.cmml" xref="S9.SS2.p2.5.m5.2.2.1.1.1.1.1">subscript</csymbol><ci id="S9.SS2.p2.5.m5.2.2.1.1.1.1.1.2.2.cmml" xref="S9.SS2.p2.5.m5.2.2.1.1.1.1.1.2.2">𝐰</ci><apply id="S9.SS2.p2.5.m5.2.2.1.1.1.1.1.2.3.cmml" xref="S9.SS2.p2.5.m5.2.2.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S9.SS2.p2.5.m5.2.2.1.1.1.1.1.2.3.1.cmml" xref="S9.SS2.p2.5.m5.2.2.1.1.1.1.1.2.3">subscript</csymbol><ci id="S9.SS2.p2.5.m5.2.2.1.1.1.1.1.2.3.2.cmml" xref="S9.SS2.p2.5.m5.2.2.1.1.1.1.1.2.3.2">𝑐</ci><minus id="S9.SS2.p2.5.m5.2.2.1.1.1.1.1.2.3.3.cmml" xref="S9.SS2.p2.5.m5.2.2.1.1.1.1.1.2.3.3"></minus></apply></apply><ci id="S9.SS2.p2.5.m5.1.1.1.1.cmml" xref="S9.SS2.p2.5.m5.1.1.1.1">𝑖</ci></apply></set><apply id="S9.SS2.p2.5.m5.2.2.1.1.3.cmml" xref="S9.SS2.p2.5.m5.2.2.1.1.3"><eq id="S9.SS2.p2.5.m5.2.2.1.1.3.1.cmml" xref="S9.SS2.p2.5.m5.2.2.1.1.3.1"></eq><ci id="S9.SS2.p2.5.m5.2.2.1.1.3.2.cmml" xref="S9.SS2.p2.5.m5.2.2.1.1.3.2">𝑖</ci><cn type="integer" id="S9.SS2.p2.5.m5.2.2.1.1.3.3.cmml" xref="S9.SS2.p2.5.m5.2.2.1.1.3.3">1</cn></apply></apply><apply id="S9.SS2.p2.5.m5.2.2.1.3.cmml" xref="S9.SS2.p2.5.m5.2.2.1.3"><csymbol cd="ambiguous" id="S9.SS2.p2.5.m5.2.2.1.3.1.cmml" xref="S9.SS2.p2.5.m5.2.2.1.3">subscript</csymbol><ci id="S9.SS2.p2.5.m5.2.2.1.3.2.cmml" xref="S9.SS2.p2.5.m5.2.2.1.3.2">𝑁</ci><minus id="S9.SS2.p2.5.m5.2.2.1.3.3.cmml" xref="S9.SS2.p2.5.m5.2.2.1.3.3"></minus></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S9.SS2.p2.5.m5.2c">W_{-}=\{\mathbf{w}_{c_{-}{}}^{(i)}\}_{i=1}^{N_{-}}</annotation></semantics></math> where <math id="S9.SS2.p2.6.m6.1" class="ltx_Math" alttext="N_{-}" display="inline"><semantics id="S9.SS2.p2.6.m6.1a"><msub id="S9.SS2.p2.6.m6.1.1" xref="S9.SS2.p2.6.m6.1.1.cmml"><mi id="S9.SS2.p2.6.m6.1.1.2" xref="S9.SS2.p2.6.m6.1.1.2.cmml">N</mi><mo id="S9.SS2.p2.6.m6.1.1.3" xref="S9.SS2.p2.6.m6.1.1.3.cmml">−</mo></msub><annotation-xml encoding="MathML-Content" id="S9.SS2.p2.6.m6.1b"><apply id="S9.SS2.p2.6.m6.1.1.cmml" xref="S9.SS2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S9.SS2.p2.6.m6.1.1.1.cmml" xref="S9.SS2.p2.6.m6.1.1">subscript</csymbol><ci id="S9.SS2.p2.6.m6.1.1.2.cmml" xref="S9.SS2.p2.6.m6.1.1.2">𝑁</ci><minus id="S9.SS2.p2.6.m6.1.1.3.cmml" xref="S9.SS2.p2.6.m6.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="S9.SS2.p2.6.m6.1c">N_{-}</annotation></semantics></math> is the number of background centers where the maximum logit, <em id="S9.SS2.p2.10.3" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S9.SS2.p2.10.4" class="ltx_text"></span>, <math id="S9.SS2.p2.7.m7.2" class="ltx_Math" alttext="\text{max}_{1\leq i\leq N_{-}}(\mathbf{x}^{T}\mathbf{w}_{c_{-}{}}^{(i)})" display="inline"><semantics id="S9.SS2.p2.7.m7.2a"><mrow id="S9.SS2.p2.7.m7.2.2" xref="S9.SS2.p2.7.m7.2.2.cmml"><msub id="S9.SS2.p2.7.m7.2.2.3" xref="S9.SS2.p2.7.m7.2.2.3.cmml"><mtext id="S9.SS2.p2.7.m7.2.2.3.2" xref="S9.SS2.p2.7.m7.2.2.3.2a.cmml">max</mtext><mrow id="S9.SS2.p2.7.m7.2.2.3.3" xref="S9.SS2.p2.7.m7.2.2.3.3.cmml"><mn id="S9.SS2.p2.7.m7.2.2.3.3.2" xref="S9.SS2.p2.7.m7.2.2.3.3.2.cmml">1</mn><mo id="S9.SS2.p2.7.m7.2.2.3.3.3" xref="S9.SS2.p2.7.m7.2.2.3.3.3.cmml">≤</mo><mi id="S9.SS2.p2.7.m7.2.2.3.3.4" xref="S9.SS2.p2.7.m7.2.2.3.3.4.cmml">i</mi><mo id="S9.SS2.p2.7.m7.2.2.3.3.5" xref="S9.SS2.p2.7.m7.2.2.3.3.5.cmml">≤</mo><msub id="S9.SS2.p2.7.m7.2.2.3.3.6" xref="S9.SS2.p2.7.m7.2.2.3.3.6.cmml"><mi id="S9.SS2.p2.7.m7.2.2.3.3.6.2" xref="S9.SS2.p2.7.m7.2.2.3.3.6.2.cmml">N</mi><mo id="S9.SS2.p2.7.m7.2.2.3.3.6.3" xref="S9.SS2.p2.7.m7.2.2.3.3.6.3.cmml">−</mo></msub></mrow></msub><mo lspace="0em" rspace="0em" id="S9.SS2.p2.7.m7.2.2.2" xref="S9.SS2.p2.7.m7.2.2.2.cmml">​</mo><mrow id="S9.SS2.p2.7.m7.2.2.1.1" xref="S9.SS2.p2.7.m7.2.2.1.1.1.cmml"><mo stretchy="false" id="S9.SS2.p2.7.m7.2.2.1.1.2" xref="S9.SS2.p2.7.m7.2.2.1.1.1.cmml">(</mo><mrow id="S9.SS2.p2.7.m7.2.2.1.1.1" xref="S9.SS2.p2.7.m7.2.2.1.1.1.cmml"><msup id="S9.SS2.p2.7.m7.2.2.1.1.1.2" xref="S9.SS2.p2.7.m7.2.2.1.1.1.2.cmml"><mi id="S9.SS2.p2.7.m7.2.2.1.1.1.2.2" xref="S9.SS2.p2.7.m7.2.2.1.1.1.2.2.cmml">𝐱</mi><mi id="S9.SS2.p2.7.m7.2.2.1.1.1.2.3" xref="S9.SS2.p2.7.m7.2.2.1.1.1.2.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S9.SS2.p2.7.m7.2.2.1.1.1.1" xref="S9.SS2.p2.7.m7.2.2.1.1.1.1.cmml">​</mo><msubsup id="S9.SS2.p2.7.m7.2.2.1.1.1.3" xref="S9.SS2.p2.7.m7.2.2.1.1.1.3.cmml"><mi id="S9.SS2.p2.7.m7.2.2.1.1.1.3.2.2" xref="S9.SS2.p2.7.m7.2.2.1.1.1.3.2.2.cmml">𝐰</mi><msub id="S9.SS2.p2.7.m7.2.2.1.1.1.3.2.3" xref="S9.SS2.p2.7.m7.2.2.1.1.1.3.2.3.cmml"><mi id="S9.SS2.p2.7.m7.2.2.1.1.1.3.2.3.2" xref="S9.SS2.p2.7.m7.2.2.1.1.1.3.2.3.2.cmml">c</mi><mo id="S9.SS2.p2.7.m7.2.2.1.1.1.3.2.3.3" xref="S9.SS2.p2.7.m7.2.2.1.1.1.3.2.3.3.cmml">−</mo></msub><mrow id="S9.SS2.p2.7.m7.1.1.1.3" xref="S9.SS2.p2.7.m7.2.2.1.1.1.3.cmml"><mo stretchy="false" id="S9.SS2.p2.7.m7.1.1.1.3.1" xref="S9.SS2.p2.7.m7.2.2.1.1.1.3.cmml">(</mo><mi id="S9.SS2.p2.7.m7.1.1.1.1" xref="S9.SS2.p2.7.m7.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S9.SS2.p2.7.m7.1.1.1.3.2" xref="S9.SS2.p2.7.m7.2.2.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo stretchy="false" id="S9.SS2.p2.7.m7.2.2.1.1.3" xref="S9.SS2.p2.7.m7.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S9.SS2.p2.7.m7.2b"><apply id="S9.SS2.p2.7.m7.2.2.cmml" xref="S9.SS2.p2.7.m7.2.2"><times id="S9.SS2.p2.7.m7.2.2.2.cmml" xref="S9.SS2.p2.7.m7.2.2.2"></times><apply id="S9.SS2.p2.7.m7.2.2.3.cmml" xref="S9.SS2.p2.7.m7.2.2.3"><csymbol cd="ambiguous" id="S9.SS2.p2.7.m7.2.2.3.1.cmml" xref="S9.SS2.p2.7.m7.2.2.3">subscript</csymbol><ci id="S9.SS2.p2.7.m7.2.2.3.2a.cmml" xref="S9.SS2.p2.7.m7.2.2.3.2"><mtext id="S9.SS2.p2.7.m7.2.2.3.2.cmml" xref="S9.SS2.p2.7.m7.2.2.3.2">max</mtext></ci><apply id="S9.SS2.p2.7.m7.2.2.3.3.cmml" xref="S9.SS2.p2.7.m7.2.2.3.3"><and id="S9.SS2.p2.7.m7.2.2.3.3a.cmml" xref="S9.SS2.p2.7.m7.2.2.3.3"></and><apply id="S9.SS2.p2.7.m7.2.2.3.3b.cmml" xref="S9.SS2.p2.7.m7.2.2.3.3"><leq id="S9.SS2.p2.7.m7.2.2.3.3.3.cmml" xref="S9.SS2.p2.7.m7.2.2.3.3.3"></leq><cn type="integer" id="S9.SS2.p2.7.m7.2.2.3.3.2.cmml" xref="S9.SS2.p2.7.m7.2.2.3.3.2">1</cn><ci id="S9.SS2.p2.7.m7.2.2.3.3.4.cmml" xref="S9.SS2.p2.7.m7.2.2.3.3.4">𝑖</ci></apply><apply id="S9.SS2.p2.7.m7.2.2.3.3c.cmml" xref="S9.SS2.p2.7.m7.2.2.3.3"><leq id="S9.SS2.p2.7.m7.2.2.3.3.5.cmml" xref="S9.SS2.p2.7.m7.2.2.3.3.5"></leq><share href="#S9.SS2.p2.7.m7.2.2.3.3.4.cmml" id="S9.SS2.p2.7.m7.2.2.3.3d.cmml" xref="S9.SS2.p2.7.m7.2.2.3.3"></share><apply id="S9.SS2.p2.7.m7.2.2.3.3.6.cmml" xref="S9.SS2.p2.7.m7.2.2.3.3.6"><csymbol cd="ambiguous" id="S9.SS2.p2.7.m7.2.2.3.3.6.1.cmml" xref="S9.SS2.p2.7.m7.2.2.3.3.6">subscript</csymbol><ci id="S9.SS2.p2.7.m7.2.2.3.3.6.2.cmml" xref="S9.SS2.p2.7.m7.2.2.3.3.6.2">𝑁</ci><minus id="S9.SS2.p2.7.m7.2.2.3.3.6.3.cmml" xref="S9.SS2.p2.7.m7.2.2.3.3.6.3"></minus></apply></apply></apply></apply><apply id="S9.SS2.p2.7.m7.2.2.1.1.1.cmml" xref="S9.SS2.p2.7.m7.2.2.1.1"><times id="S9.SS2.p2.7.m7.2.2.1.1.1.1.cmml" xref="S9.SS2.p2.7.m7.2.2.1.1.1.1"></times><apply id="S9.SS2.p2.7.m7.2.2.1.1.1.2.cmml" xref="S9.SS2.p2.7.m7.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S9.SS2.p2.7.m7.2.2.1.1.1.2.1.cmml" xref="S9.SS2.p2.7.m7.2.2.1.1.1.2">superscript</csymbol><ci id="S9.SS2.p2.7.m7.2.2.1.1.1.2.2.cmml" xref="S9.SS2.p2.7.m7.2.2.1.1.1.2.2">𝐱</ci><ci id="S9.SS2.p2.7.m7.2.2.1.1.1.2.3.cmml" xref="S9.SS2.p2.7.m7.2.2.1.1.1.2.3">𝑇</ci></apply><apply id="S9.SS2.p2.7.m7.2.2.1.1.1.3.cmml" xref="S9.SS2.p2.7.m7.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S9.SS2.p2.7.m7.2.2.1.1.1.3.1.cmml" xref="S9.SS2.p2.7.m7.2.2.1.1.1.3">superscript</csymbol><apply id="S9.SS2.p2.7.m7.2.2.1.1.1.3.2.cmml" xref="S9.SS2.p2.7.m7.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S9.SS2.p2.7.m7.2.2.1.1.1.3.2.1.cmml" xref="S9.SS2.p2.7.m7.2.2.1.1.1.3">subscript</csymbol><ci id="S9.SS2.p2.7.m7.2.2.1.1.1.3.2.2.cmml" xref="S9.SS2.p2.7.m7.2.2.1.1.1.3.2.2">𝐰</ci><apply id="S9.SS2.p2.7.m7.2.2.1.1.1.3.2.3.cmml" xref="S9.SS2.p2.7.m7.2.2.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S9.SS2.p2.7.m7.2.2.1.1.1.3.2.3.1.cmml" xref="S9.SS2.p2.7.m7.2.2.1.1.1.3.2.3">subscript</csymbol><ci id="S9.SS2.p2.7.m7.2.2.1.1.1.3.2.3.2.cmml" xref="S9.SS2.p2.7.m7.2.2.1.1.1.3.2.3.2">𝑐</ci><minus id="S9.SS2.p2.7.m7.2.2.1.1.1.3.2.3.3.cmml" xref="S9.SS2.p2.7.m7.2.2.1.1.1.3.2.3.3"></minus></apply></apply><ci id="S9.SS2.p2.7.m7.1.1.1.1.cmml" xref="S9.SS2.p2.7.m7.1.1.1.1">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S9.SS2.p2.7.m7.2c">\text{max}_{1\leq i\leq N_{-}}(\mathbf{x}^{T}\mathbf{w}_{c_{-}{}}^{(i)})</annotation></semantics></math>, is used in classification. As compared in Table <a href="#S9.T5" title="Table M3 ‣ 9.2 Design of Background class ‣ 9 Discussion ‣ 8.3 Long-Tail Object Detection ‣ 8 Experiment ‣ DiGeo: Discriminative Geometry-Aware Learning for Generalized Few-Shot Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">M3</span></a>, having more learnable class centers can introduce trivial performance improvement but will drop clearly when <math id="S9.SS2.p2.8.m8.1" class="ltx_Math" alttext="N_{-}" display="inline"><semantics id="S9.SS2.p2.8.m8.1a"><msub id="S9.SS2.p2.8.m8.1.1" xref="S9.SS2.p2.8.m8.1.1.cmml"><mi id="S9.SS2.p2.8.m8.1.1.2" xref="S9.SS2.p2.8.m8.1.1.2.cmml">N</mi><mo id="S9.SS2.p2.8.m8.1.1.3" xref="S9.SS2.p2.8.m8.1.1.3.cmml">−</mo></msub><annotation-xml encoding="MathML-Content" id="S9.SS2.p2.8.m8.1b"><apply id="S9.SS2.p2.8.m8.1.1.cmml" xref="S9.SS2.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S9.SS2.p2.8.m8.1.1.1.cmml" xref="S9.SS2.p2.8.m8.1.1">subscript</csymbol><ci id="S9.SS2.p2.8.m8.1.1.2.cmml" xref="S9.SS2.p2.8.m8.1.1.2">𝑁</ci><minus id="S9.SS2.p2.8.m8.1.1.3.cmml" xref="S9.SS2.p2.8.m8.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="S9.SS2.p2.8.m8.1c">N_{-}</annotation></semantics></math> is too large. However, when we directly set the classifier for the all classes ,<em id="S9.SS2.p2.10.5" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S9.SS2.p2.10.6" class="ltx_text"></span>, <math id="S9.SS2.p2.9.m9.1" class="ltx_Math" alttext="W_{n}\cup W_{b}\cup W_{-}" display="inline"><semantics id="S9.SS2.p2.9.m9.1a"><mrow id="S9.SS2.p2.9.m9.1.1" xref="S9.SS2.p2.9.m9.1.1.cmml"><msub id="S9.SS2.p2.9.m9.1.1.2" xref="S9.SS2.p2.9.m9.1.1.2.cmml"><mi id="S9.SS2.p2.9.m9.1.1.2.2" xref="S9.SS2.p2.9.m9.1.1.2.2.cmml">W</mi><mi id="S9.SS2.p2.9.m9.1.1.2.3" xref="S9.SS2.p2.9.m9.1.1.2.3.cmml">n</mi></msub><mo id="S9.SS2.p2.9.m9.1.1.1" xref="S9.SS2.p2.9.m9.1.1.1.cmml">∪</mo><msub id="S9.SS2.p2.9.m9.1.1.3" xref="S9.SS2.p2.9.m9.1.1.3.cmml"><mi id="S9.SS2.p2.9.m9.1.1.3.2" xref="S9.SS2.p2.9.m9.1.1.3.2.cmml">W</mi><mi id="S9.SS2.p2.9.m9.1.1.3.3" xref="S9.SS2.p2.9.m9.1.1.3.3.cmml">b</mi></msub><mo id="S9.SS2.p2.9.m9.1.1.1a" xref="S9.SS2.p2.9.m9.1.1.1.cmml">∪</mo><msub id="S9.SS2.p2.9.m9.1.1.4" xref="S9.SS2.p2.9.m9.1.1.4.cmml"><mi id="S9.SS2.p2.9.m9.1.1.4.2" xref="S9.SS2.p2.9.m9.1.1.4.2.cmml">W</mi><mo id="S9.SS2.p2.9.m9.1.1.4.3" xref="S9.SS2.p2.9.m9.1.1.4.3.cmml">−</mo></msub></mrow><annotation-xml encoding="MathML-Content" id="S9.SS2.p2.9.m9.1b"><apply id="S9.SS2.p2.9.m9.1.1.cmml" xref="S9.SS2.p2.9.m9.1.1"><union id="S9.SS2.p2.9.m9.1.1.1.cmml" xref="S9.SS2.p2.9.m9.1.1.1"></union><apply id="S9.SS2.p2.9.m9.1.1.2.cmml" xref="S9.SS2.p2.9.m9.1.1.2"><csymbol cd="ambiguous" id="S9.SS2.p2.9.m9.1.1.2.1.cmml" xref="S9.SS2.p2.9.m9.1.1.2">subscript</csymbol><ci id="S9.SS2.p2.9.m9.1.1.2.2.cmml" xref="S9.SS2.p2.9.m9.1.1.2.2">𝑊</ci><ci id="S9.SS2.p2.9.m9.1.1.2.3.cmml" xref="S9.SS2.p2.9.m9.1.1.2.3">𝑛</ci></apply><apply id="S9.SS2.p2.9.m9.1.1.3.cmml" xref="S9.SS2.p2.9.m9.1.1.3"><csymbol cd="ambiguous" id="S9.SS2.p2.9.m9.1.1.3.1.cmml" xref="S9.SS2.p2.9.m9.1.1.3">subscript</csymbol><ci id="S9.SS2.p2.9.m9.1.1.3.2.cmml" xref="S9.SS2.p2.9.m9.1.1.3.2">𝑊</ci><ci id="S9.SS2.p2.9.m9.1.1.3.3.cmml" xref="S9.SS2.p2.9.m9.1.1.3.3">𝑏</ci></apply><apply id="S9.SS2.p2.9.m9.1.1.4.cmml" xref="S9.SS2.p2.9.m9.1.1.4"><csymbol cd="ambiguous" id="S9.SS2.p2.9.m9.1.1.4.1.cmml" xref="S9.SS2.p2.9.m9.1.1.4">subscript</csymbol><ci id="S9.SS2.p2.9.m9.1.1.4.2.cmml" xref="S9.SS2.p2.9.m9.1.1.4.2">𝑊</ci><minus id="S9.SS2.p2.9.m9.1.1.4.3.cmml" xref="S9.SS2.p2.9.m9.1.1.4.3"></minus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S9.SS2.p2.9.m9.1c">W_{n}\cup W_{b}\cup W_{-}</annotation></semantics></math> as ETF , the performance drops when <math id="S9.SS2.p2.10.m10.1" class="ltx_Math" alttext="N_{-}&gt;1" display="inline"><semantics id="S9.SS2.p2.10.m10.1a"><mrow id="S9.SS2.p2.10.m10.1.1" xref="S9.SS2.p2.10.m10.1.1.cmml"><msub id="S9.SS2.p2.10.m10.1.1.2" xref="S9.SS2.p2.10.m10.1.1.2.cmml"><mi id="S9.SS2.p2.10.m10.1.1.2.2" xref="S9.SS2.p2.10.m10.1.1.2.2.cmml">N</mi><mo id="S9.SS2.p2.10.m10.1.1.2.3" xref="S9.SS2.p2.10.m10.1.1.2.3.cmml">−</mo></msub><mo id="S9.SS2.p2.10.m10.1.1.1" xref="S9.SS2.p2.10.m10.1.1.1.cmml">&gt;</mo><mn id="S9.SS2.p2.10.m10.1.1.3" xref="S9.SS2.p2.10.m10.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S9.SS2.p2.10.m10.1b"><apply id="S9.SS2.p2.10.m10.1.1.cmml" xref="S9.SS2.p2.10.m10.1.1"><gt id="S9.SS2.p2.10.m10.1.1.1.cmml" xref="S9.SS2.p2.10.m10.1.1.1"></gt><apply id="S9.SS2.p2.10.m10.1.1.2.cmml" xref="S9.SS2.p2.10.m10.1.1.2"><csymbol cd="ambiguous" id="S9.SS2.p2.10.m10.1.1.2.1.cmml" xref="S9.SS2.p2.10.m10.1.1.2">subscript</csymbol><ci id="S9.SS2.p2.10.m10.1.1.2.2.cmml" xref="S9.SS2.p2.10.m10.1.1.2.2">𝑁</ci><minus id="S9.SS2.p2.10.m10.1.1.2.3.cmml" xref="S9.SS2.p2.10.m10.1.1.2.3"></minus></apply><cn type="integer" id="S9.SS2.p2.10.m10.1.1.3.cmml" xref="S9.SS2.p2.10.m10.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S9.SS2.p2.10.m10.1c">N_{-}&gt;1</annotation></semantics></math>.</p>
</div>
<div id="S9.SS2.p3" class="ltx_para">
<p id="S9.SS2.p3.4" class="ltx_p">In practice, we observe all learnable negative weights <math id="S9.SS2.p3.1.m1.1" class="ltx_Math" alttext="W_{-}" display="inline"><semantics id="S9.SS2.p3.1.m1.1a"><msub id="S9.SS2.p3.1.m1.1.1" xref="S9.SS2.p3.1.m1.1.1.cmml"><mi id="S9.SS2.p3.1.m1.1.1.2" xref="S9.SS2.p3.1.m1.1.1.2.cmml">W</mi><mo id="S9.SS2.p3.1.m1.1.1.3" xref="S9.SS2.p3.1.m1.1.1.3.cmml">−</mo></msub><annotation-xml encoding="MathML-Content" id="S9.SS2.p3.1.m1.1b"><apply id="S9.SS2.p3.1.m1.1.1.cmml" xref="S9.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S9.SS2.p3.1.m1.1.1.1.cmml" xref="S9.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="S9.SS2.p3.1.m1.1.1.2.cmml" xref="S9.SS2.p3.1.m1.1.1.2">𝑊</ci><minus id="S9.SS2.p3.1.m1.1.1.3.cmml" xref="S9.SS2.p3.1.m1.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="S9.SS2.p3.1.m1.1c">W_{-}</annotation></semantics></math> are trained to separate from the <math id="S9.SS2.p3.2.m2.1" class="ltx_Math" alttext="W_{b}\cup W_{n}" display="inline"><semantics id="S9.SS2.p3.2.m2.1a"><mrow id="S9.SS2.p3.2.m2.1.1" xref="S9.SS2.p3.2.m2.1.1.cmml"><msub id="S9.SS2.p3.2.m2.1.1.2" xref="S9.SS2.p3.2.m2.1.1.2.cmml"><mi id="S9.SS2.p3.2.m2.1.1.2.2" xref="S9.SS2.p3.2.m2.1.1.2.2.cmml">W</mi><mi id="S9.SS2.p3.2.m2.1.1.2.3" xref="S9.SS2.p3.2.m2.1.1.2.3.cmml">b</mi></msub><mo id="S9.SS2.p3.2.m2.1.1.1" xref="S9.SS2.p3.2.m2.1.1.1.cmml">∪</mo><msub id="S9.SS2.p3.2.m2.1.1.3" xref="S9.SS2.p3.2.m2.1.1.3.cmml"><mi id="S9.SS2.p3.2.m2.1.1.3.2" xref="S9.SS2.p3.2.m2.1.1.3.2.cmml">W</mi><mi id="S9.SS2.p3.2.m2.1.1.3.3" xref="S9.SS2.p3.2.m2.1.1.3.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S9.SS2.p3.2.m2.1b"><apply id="S9.SS2.p3.2.m2.1.1.cmml" xref="S9.SS2.p3.2.m2.1.1"><union id="S9.SS2.p3.2.m2.1.1.1.cmml" xref="S9.SS2.p3.2.m2.1.1.1"></union><apply id="S9.SS2.p3.2.m2.1.1.2.cmml" xref="S9.SS2.p3.2.m2.1.1.2"><csymbol cd="ambiguous" id="S9.SS2.p3.2.m2.1.1.2.1.cmml" xref="S9.SS2.p3.2.m2.1.1.2">subscript</csymbol><ci id="S9.SS2.p3.2.m2.1.1.2.2.cmml" xref="S9.SS2.p3.2.m2.1.1.2.2">𝑊</ci><ci id="S9.SS2.p3.2.m2.1.1.2.3.cmml" xref="S9.SS2.p3.2.m2.1.1.2.3">𝑏</ci></apply><apply id="S9.SS2.p3.2.m2.1.1.3.cmml" xref="S9.SS2.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="S9.SS2.p3.2.m2.1.1.3.1.cmml" xref="S9.SS2.p3.2.m2.1.1.3">subscript</csymbol><ci id="S9.SS2.p3.2.m2.1.1.3.2.cmml" xref="S9.SS2.p3.2.m2.1.1.3.2">𝑊</ci><ci id="S9.SS2.p3.2.m2.1.1.3.3.cmml" xref="S9.SS2.p3.2.m2.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S9.SS2.p3.2.m2.1c">W_{b}\cup W_{n}</annotation></semantics></math> where the weights in <math id="S9.SS2.p3.3.m3.1" class="ltx_Math" alttext="W_{-}" display="inline"><semantics id="S9.SS2.p3.3.m3.1a"><msub id="S9.SS2.p3.3.m3.1.1" xref="S9.SS2.p3.3.m3.1.1.cmml"><mi id="S9.SS2.p3.3.m3.1.1.2" xref="S9.SS2.p3.3.m3.1.1.2.cmml">W</mi><mo id="S9.SS2.p3.3.m3.1.1.3" xref="S9.SS2.p3.3.m3.1.1.3.cmml">−</mo></msub><annotation-xml encoding="MathML-Content" id="S9.SS2.p3.3.m3.1b"><apply id="S9.SS2.p3.3.m3.1.1.cmml" xref="S9.SS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S9.SS2.p3.3.m3.1.1.1.cmml" xref="S9.SS2.p3.3.m3.1.1">subscript</csymbol><ci id="S9.SS2.p3.3.m3.1.1.2.cmml" xref="S9.SS2.p3.3.m3.1.1.2">𝑊</ci><minus id="S9.SS2.p3.3.m3.1.1.3.cmml" xref="S9.SS2.p3.3.m3.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="S9.SS2.p3.3.m3.1c">W_{-}</annotation></semantics></math> are still close to each other such that the diversity of background features are preserved indirectly. Instead, having all negative weights maximally separated from each other assume background features is very diverse and make the model hard to learn. As such, we choose to set <math id="S9.SS2.p3.4.m4.1" class="ltx_Math" alttext="N_{-}=1" display="inline"><semantics id="S9.SS2.p3.4.m4.1a"><mrow id="S9.SS2.p3.4.m4.1.1" xref="S9.SS2.p3.4.m4.1.1.cmml"><msub id="S9.SS2.p3.4.m4.1.1.2" xref="S9.SS2.p3.4.m4.1.1.2.cmml"><mi id="S9.SS2.p3.4.m4.1.1.2.2" xref="S9.SS2.p3.4.m4.1.1.2.2.cmml">N</mi><mo id="S9.SS2.p3.4.m4.1.1.2.3" xref="S9.SS2.p3.4.m4.1.1.2.3.cmml">−</mo></msub><mo id="S9.SS2.p3.4.m4.1.1.1" xref="S9.SS2.p3.4.m4.1.1.1.cmml">=</mo><mn id="S9.SS2.p3.4.m4.1.1.3" xref="S9.SS2.p3.4.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S9.SS2.p3.4.m4.1b"><apply id="S9.SS2.p3.4.m4.1.1.cmml" xref="S9.SS2.p3.4.m4.1.1"><eq id="S9.SS2.p3.4.m4.1.1.1.cmml" xref="S9.SS2.p3.4.m4.1.1.1"></eq><apply id="S9.SS2.p3.4.m4.1.1.2.cmml" xref="S9.SS2.p3.4.m4.1.1.2"><csymbol cd="ambiguous" id="S9.SS2.p3.4.m4.1.1.2.1.cmml" xref="S9.SS2.p3.4.m4.1.1.2">subscript</csymbol><ci id="S9.SS2.p3.4.m4.1.1.2.2.cmml" xref="S9.SS2.p3.4.m4.1.1.2.2">𝑁</ci><minus id="S9.SS2.p3.4.m4.1.1.2.3.cmml" xref="S9.SS2.p3.4.m4.1.1.2.3"></minus></apply><cn type="integer" id="S9.SS2.p3.4.m4.1.1.3.cmml" xref="S9.SS2.p3.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S9.SS2.p3.4.m4.1c">N_{-}=1</annotation></semantics></math> and adjust margins through self-distillation to maintain the diversity properly.</p>
</div>
<figure id="S9.T5" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S9.T5.6.1.1" class="ltx_text" style="font-size:90%;">Table M3</span>: </span><span id="S9.T5.7.2" class="ltx_text" style="font-size:90%;">Ablation study of Background Design.</span></figcaption>
<table id="S9.T5.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S9.T5.4.4" class="ltx_tr">
<th id="S9.T5.4.4.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row">
<span id="S9.T5.4.4.5.1" class="ltx_ERROR undefined">\hlineB</span>3
Idx</th>
<th id="S9.T5.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row"><math id="S9.T5.1.1.1.m1.1" class="ltx_Math" alttext="N_{-}" display="inline"><semantics id="S9.T5.1.1.1.m1.1a"><msub id="S9.T5.1.1.1.m1.1.1" xref="S9.T5.1.1.1.m1.1.1.cmml"><mi id="S9.T5.1.1.1.m1.1.1.2" xref="S9.T5.1.1.1.m1.1.1.2.cmml">N</mi><mo id="S9.T5.1.1.1.m1.1.1.3" xref="S9.T5.1.1.1.m1.1.1.3.cmml">−</mo></msub><annotation-xml encoding="MathML-Content" id="S9.T5.1.1.1.m1.1b"><apply id="S9.T5.1.1.1.m1.1.1.cmml" xref="S9.T5.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S9.T5.1.1.1.m1.1.1.1.cmml" xref="S9.T5.1.1.1.m1.1.1">subscript</csymbol><ci id="S9.T5.1.1.1.m1.1.1.2.cmml" xref="S9.T5.1.1.1.m1.1.1.2">𝑁</ci><minus id="S9.T5.1.1.1.m1.1.1.3.cmml" xref="S9.T5.1.1.1.m1.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="S9.T5.1.1.1.m1.1c">N_{-}</annotation></semantics></math></th>
<th id="S9.T5.4.4.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r">Fixed</th>
<th id="S9.T5.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column">AP<sub id="S9.T5.2.2.2.1" class="ltx_sub"><span id="S9.T5.2.2.2.1.1" class="ltx_text ltx_font_italic">50</span></sub>
</th>
<th id="S9.T5.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column">bAP<sub id="S9.T5.3.3.3.1" class="ltx_sub"><span id="S9.T5.3.3.3.1.1" class="ltx_text ltx_font_italic">50</span></sub>
</th>
<th id="S9.T5.4.4.4" class="ltx_td ltx_align_center ltx_th ltx_th_column">nAP<sub id="S9.T5.4.4.4.1" class="ltx_sub"><span id="S9.T5.4.4.4.1.1" class="ltx_text ltx_font_italic">50</span></sub>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S9.T5.4.5.1" class="ltx_tr">
<th id="S9.T5.4.5.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">1</th>
<th id="S9.T5.4.5.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">1</th>
<th id="S9.T5.4.5.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">✓</th>
<td id="S9.T5.4.5.1.4" class="ltx_td ltx_align_center ltx_border_t">74.9</td>
<td id="S9.T5.4.5.1.5" class="ltx_td ltx_align_center ltx_border_t">81.0</td>
<td id="S9.T5.4.5.1.6" class="ltx_td ltx_align_center ltx_border_t">56.4</td>
</tr>
<tr id="S9.T5.4.6.2" class="ltx_tr">
<th id="S9.T5.4.6.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">2</th>
<th id="S9.T5.4.6.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row">5</th>
<th id="S9.T5.4.6.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">✓</th>
<td id="S9.T5.4.6.2.4" class="ltx_td ltx_align_center">73.5</td>
<td id="S9.T5.4.6.2.5" class="ltx_td ltx_align_center">81.3</td>
<td id="S9.T5.4.6.2.6" class="ltx_td ltx_align_center">50.2</td>
</tr>
<tr id="S9.T5.4.7.3" class="ltx_tr">
<th id="S9.T5.4.7.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">3</th>
<th id="S9.T5.4.7.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_row">1</th>
<th id="S9.T5.4.7.3.3" class="ltx_td ltx_th ltx_th_row ltx_border_r"></th>
<td id="S9.T5.4.7.3.4" class="ltx_td ltx_align_center">74.9</td>
<td id="S9.T5.4.7.3.5" class="ltx_td ltx_align_center">81.0</td>
<td id="S9.T5.4.7.3.6" class="ltx_td ltx_align_center">56.4</td>
</tr>
<tr id="S9.T5.4.8.4" class="ltx_tr">
<th id="S9.T5.4.8.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">4</th>
<th id="S9.T5.4.8.4.2" class="ltx_td ltx_align_center ltx_th ltx_th_row">5</th>
<th id="S9.T5.4.8.4.3" class="ltx_td ltx_th ltx_th_row ltx_border_r"></th>
<td id="S9.T5.4.8.4.4" class="ltx_td ltx_align_center">74.9</td>
<td id="S9.T5.4.8.4.5" class="ltx_td ltx_align_center">80.9</td>
<td id="S9.T5.4.8.4.6" class="ltx_td ltx_align_center">56.7</td>
</tr>
<tr id="S9.T5.4.9.5" class="ltx_tr">
<th id="S9.T5.4.9.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">5</th>
<th id="S9.T5.4.9.5.2" class="ltx_td ltx_align_center ltx_th ltx_th_row">10</th>
<th id="S9.T5.4.9.5.3" class="ltx_td ltx_th ltx_th_row ltx_border_r"></th>
<td id="S9.T5.4.9.5.4" class="ltx_td ltx_align_center">74.9</td>
<td id="S9.T5.4.9.5.5" class="ltx_td ltx_align_center">80.9</td>
<td id="S9.T5.4.9.5.6" class="ltx_td ltx_align_center">57.0</td>
</tr>
<tr id="S9.T5.4.10.6" class="ltx_tr">
<th id="S9.T5.4.10.6.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">6</th>
<th id="S9.T5.4.10.6.2" class="ltx_td ltx_align_center ltx_th ltx_th_row">20</th>
<th id="S9.T5.4.10.6.3" class="ltx_td ltx_th ltx_th_row ltx_border_r"></th>
<td id="S9.T5.4.10.6.4" class="ltx_td ltx_align_center">74.6</td>
<td id="S9.T5.4.10.6.5" class="ltx_td ltx_align_center">81.1</td>
<td id="S9.T5.4.10.6.6" class="ltx_td ltx_align_center">55.2</td>
</tr>
<tr id="S9.T5.4.11.7" class="ltx_tr">
<th id="S9.T5.4.11.7.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">
<span id="S9.T5.4.11.7.1.1" class="ltx_ERROR undefined">\hlineB</span>3</th>
<th id="S9.T5.4.11.7.2" class="ltx_td ltx_th ltx_th_row"></th>
<th id="S9.T5.4.11.7.3" class="ltx_td ltx_th ltx_th_row"></th>
<td id="S9.T5.4.11.7.4" class="ltx_td"></td>
<td id="S9.T5.4.11.7.5" class="ltx_td"></td>
<td id="S9.T5.4.11.7.6" class="ltx_td"></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S9.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">9.3 </span>More Visualization</h3>

<div id="S9.SS3.p1" class="ltx_para">
<p id="S9.SS3.p1.1" class="ltx_p">As shown in Fig. <a href="#S9.F6" title="Figure M1 ‣ 9.3 More Visualization ‣ 9 Discussion ‣ 8.3 Long-Tail Object Detection ‣ 8 Experiment ‣ DiGeo: Discriminative Geometry-Aware Learning for Generalized Few-Shot Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">M1</span></a>, we visualize the classifier centers by their pair-wise cosine similarity when they are learned from scratch. Fig. <a href="#S9.F6" title="Figure M1 ‣ 9.3 More Visualization ‣ 9 Discussion ‣ 8.3 Long-Tail Object Detection ‣ 8 Experiment ‣ DiGeo: Discriminative Geometry-Aware Learning for Generalized Few-Shot Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">M1</span></a>(a) is the same as the Fig. 3(b) in the main paper but the background class center is also included (the rightmost and the bottom one). We can then see that when we have both base and novel annotation in the train set, the class centers can be trained to distance from all of the background classes. However, when we only use novel classes during the adaptation stage (Fig. <a href="#S9.F6" title="Figure M1 ‣ 9.3 More Visualization ‣ 9 Discussion ‣ 8.3 Long-Tail Object Detection ‣ 8 Experiment ‣ DiGeo: Discriminative Geometry-Aware Learning for Generalized Few-Shot Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">M1</span></a>(b)), the negative class center can be close to the novel class centers. Meanwhile, when we use the full set for training from scratch, we can see that the applying either RFS or adding margins can help with separating the novel class centers from the background class centers, while adding margins is more important.</p>
</div>
<div id="S9.SS3.p2" class="ltx_para">
<p id="S9.SS3.p2.1" class="ltx_p">The foreground class names (sorted by decreasing order) are person, chair, car, bottle, dog, potted plant, cat, boat, sheep, aeroplane, bicycle, tv monitor, horse, dining table, train, motorbike, cow, bus, bird, sofa.</p>
</div>
<figure id="S9.F6" class="ltx_figure"><img src="/html/2303.09674/assets/x6.png" id="S9.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="422" height="112" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S9.F6.2.1.1" class="ltx_text" style="font-size:90%;">Figure M1</span>: </span><span id="S9.F6.3.2" class="ltx_text" style="font-size:90%;">Visualization classifier centers.</span></figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="S10" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">10 </span>Comparison with related work</h2>

<div id="S10.p1" class="ltx_para">
<p id="S10.p1.1" class="ltx_p">In this section, we provide in-detail comparison with a few representation works to highlight our motivation and contribution. All of the approached listed below have been briefly mentioned in the sections of Related Work and Experiment.</p>
</div>
<section id="S10.SS0.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">CME</h4>

<div id="S10.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="S10.SS0.SSS0.Px1.p1.1" class="ltx_p"><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> similarly employs a margin equilibrium strategy in the few-shot finetuning. The determination of the margin value is based on the degree of feature disturbance which is measured by the scale of gradient among augmented samples.
Meanwhile, CME is motivated by the trade off between margins of base classes and the variance of novel classes.</p>
</div>
<div id="S10.SS0.SSS0.Px1.p2" class="ltx_para">
<p id="S10.SS0.SSS0.Px1.p2.1" class="ltx_p">However, we have used the geometric property of Simplex ETF to maximally separate the feature clusters for all classes. In this way, we decouple the learning for inter-class separation and intra-class compactness and only tighten the feature cluster to the corresponding class centers to reach a balanced distribution. As such, we can learn discriminative features for all of the classes even on an extremely imbalanced dataset.</p>
</div>
<div id="S10.SS0.SSS0.Px1.p3" class="ltx_para">
<p id="S10.SS0.SSS0.Px1.p3.1" class="ltx_p">In addition, CME is still trained on the balanced dataset <math id="S10.SS0.SSS0.Px1.p3.1.m1.1" class="ltx_Math" alttext="\mathcal{D}^{-}_{b}{}\cup\mathcal{D}_{n}{}" display="inline"><semantics id="S10.SS0.SSS0.Px1.p3.1.m1.1a"><mrow id="S10.SS0.SSS0.Px1.p3.1.m1.1.1" xref="S10.SS0.SSS0.Px1.p3.1.m1.1.1.cmml"><msubsup id="S10.SS0.SSS0.Px1.p3.1.m1.1.1.2" xref="S10.SS0.SSS0.Px1.p3.1.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S10.SS0.SSS0.Px1.p3.1.m1.1.1.2.2.2" xref="S10.SS0.SSS0.Px1.p3.1.m1.1.1.2.2.2.cmml">𝒟</mi><mi id="S10.SS0.SSS0.Px1.p3.1.m1.1.1.2.3" xref="S10.SS0.SSS0.Px1.p3.1.m1.1.1.2.3.cmml">b</mi><mo id="S10.SS0.SSS0.Px1.p3.1.m1.1.1.2.2.3" xref="S10.SS0.SSS0.Px1.p3.1.m1.1.1.2.2.3.cmml">−</mo></msubsup><mo id="S10.SS0.SSS0.Px1.p3.1.m1.1.1.1" xref="S10.SS0.SSS0.Px1.p3.1.m1.1.1.1.cmml">∪</mo><msub id="S10.SS0.SSS0.Px1.p3.1.m1.1.1.3" xref="S10.SS0.SSS0.Px1.p3.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S10.SS0.SSS0.Px1.p3.1.m1.1.1.3.2" xref="S10.SS0.SSS0.Px1.p3.1.m1.1.1.3.2.cmml">𝒟</mi><mi id="S10.SS0.SSS0.Px1.p3.1.m1.1.1.3.3" xref="S10.SS0.SSS0.Px1.p3.1.m1.1.1.3.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S10.SS0.SSS0.Px1.p3.1.m1.1b"><apply id="S10.SS0.SSS0.Px1.p3.1.m1.1.1.cmml" xref="S10.SS0.SSS0.Px1.p3.1.m1.1.1"><union id="S10.SS0.SSS0.Px1.p3.1.m1.1.1.1.cmml" xref="S10.SS0.SSS0.Px1.p3.1.m1.1.1.1"></union><apply id="S10.SS0.SSS0.Px1.p3.1.m1.1.1.2.cmml" xref="S10.SS0.SSS0.Px1.p3.1.m1.1.1.2"><csymbol cd="ambiguous" id="S10.SS0.SSS0.Px1.p3.1.m1.1.1.2.1.cmml" xref="S10.SS0.SSS0.Px1.p3.1.m1.1.1.2">subscript</csymbol><apply id="S10.SS0.SSS0.Px1.p3.1.m1.1.1.2.2.cmml" xref="S10.SS0.SSS0.Px1.p3.1.m1.1.1.2"><csymbol cd="ambiguous" id="S10.SS0.SSS0.Px1.p3.1.m1.1.1.2.2.1.cmml" xref="S10.SS0.SSS0.Px1.p3.1.m1.1.1.2">superscript</csymbol><ci id="S10.SS0.SSS0.Px1.p3.1.m1.1.1.2.2.2.cmml" xref="S10.SS0.SSS0.Px1.p3.1.m1.1.1.2.2.2">𝒟</ci><minus id="S10.SS0.SSS0.Px1.p3.1.m1.1.1.2.2.3.cmml" xref="S10.SS0.SSS0.Px1.p3.1.m1.1.1.2.2.3"></minus></apply><ci id="S10.SS0.SSS0.Px1.p3.1.m1.1.1.2.3.cmml" xref="S10.SS0.SSS0.Px1.p3.1.m1.1.1.2.3">𝑏</ci></apply><apply id="S10.SS0.SSS0.Px1.p3.1.m1.1.1.3.cmml" xref="S10.SS0.SSS0.Px1.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S10.SS0.SSS0.Px1.p3.1.m1.1.1.3.1.cmml" xref="S10.SS0.SSS0.Px1.p3.1.m1.1.1.3">subscript</csymbol><ci id="S10.SS0.SSS0.Px1.p3.1.m1.1.1.3.2.cmml" xref="S10.SS0.SSS0.Px1.p3.1.m1.1.1.3.2">𝒟</ci><ci id="S10.SS0.SSS0.Px1.p3.1.m1.1.1.3.3.cmml" xref="S10.SS0.SSS0.Px1.p3.1.m1.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S10.SS0.SSS0.Px1.p3.1.m1.1c">\mathcal{D}^{-}_{b}{}\cup\mathcal{D}_{n}{}</annotation></semantics></math> and the so-called margin equilibrium is realized when the model is trained on a balanced set. Thus, CME may still forget the base knowledge.
Instead, our margins are for all classes based on the prior of instance distribution and our approach is orthogonal to CME. Furthermore, the margin estimation strategy in CME can be used as an alternative of our self-distillation in margin adjustment.</p>
</div>
</section>
<section id="S10.SS0.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Negative margin on few-shot classification</h4>

<div id="S10.SS0.SSS0.Px2.p1" class="ltx_para">
<p id="S10.SS0.SSS0.Px2.p1.1" class="ltx_p">is studied in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite> and reveals the trade-off of classification accuracy between base recognition and novel recognition. Namely, for a feature extractor pre-trained on <span id="S10.SS0.SSS0.Px2.p1.1.1" class="ltx_text ltx_font_italic">base</span> classes, if the model achieves better test accuracy on the base classification, the adaptation accuracy towards classification accuracy is then minimized. As such, a comprehensive study is provided in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>.</p>
</div>
<div id="S10.SS0.SSS0.Px2.p2" class="ltx_para">
<p id="S10.SS0.SSS0.Px2.p2.1" class="ltx_p">In contrast, we focus on few-shot object detection and aims to improve the few-shot adaptation efficiency without scarifying the performance of base detection. We always add positive class-specific margins to all classes where the margin values are adaptively learned during network training.</p>
</div>
</section>
<section id="S10.SS0.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">LOCE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>
</h4>

<div id="S10.SS0.SSS0.Px3.p1" class="ltx_para">
<p id="S10.SS0.SSS0.Px3.p1.1" class="ltx_p">is applied on long-tail object detection, which is a more general case of generalized few-shot object detection (<em id="S10.SS0.SSS0.Px3.p1.1.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S10.SS0.SSS0.Px3.p1.1.2" class="ltx_text"></span>, in GFSOD, the imbalance between base set and novel set is more significant and thus more challenging). A common problems discussed in LOCE and our paper is that the instance distribution of classes cannot be directly used to estimate the margins.</p>
</div>
<div id="S10.SS0.SSS0.Px3.p2" class="ltx_para">
<p id="S10.SS0.SSS0.Px3.p2.1" class="ltx_p">As such, LOCE discards the prior and introduce the Equilibrium loss to use the mean classification score to determine the margin. In addition, they proposed a complex memory-augmented feature sampling to facilitate the network training.
In contrast, we clearly discuss and decouple the training objective for inter-class separation and intra-class compactness.</p>
</div>
<div id="S10.SS0.SSS0.Px3.p3" class="ltx_para">
<p id="S10.SS0.SSS0.Px3.p3.1" class="ltx_p">We consider the distribution of classifier weights in conventional training and use ETF as a fixed classifier. In this case, we used the assigned weights to guide the separation of feature clusters between different classes, and then apply different margins to push the features to the assigned centers. As we apply margins to facilitate the balanced distribution, we can use the instance distribution as prior and use a simple knowledge distillation to adjust the margins and facilitate training.</p>
</div>
</section>
<section id="S10.SS0.SSS0.Px4" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Margin modification techniques</h4>

<div id="S10.SS0.SSS0.Px4.p1" class="ltx_para">
<p id="S10.SS0.SSS0.Px4.p1.1" class="ltx_p">such as BALMS <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite> and Seesaw loss<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib52" title="" class="ltx_ref">52</a>]</cite> has been proposed. Specifically, BALMS considers the boundary shifting problem in long-tailed classification/segmentation and present a meta-sampling strategy to re-estiamte the boundary indicated in the Softmax function. Seasaw loss defines a compensation factor in vanilla cross entropy loss to balance the error for different classes. In both case, they in effect count on the real-time (online) distribution of selected samples during the training and then adjust the loss. Instead, we focus on the inter-class separation and intra-class compactness to guide the training of features, <em id="S10.SS0.SSS0.Px4.p1.1.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S10.SS0.SSS0.Px4.p1.1.2" class="ltx_text"></span>, re-arranging the feature distribution from the perspective of feature geometry. In addition, the margin modification techniques can be used as an alternative of our margin adjustment strategy for the intra-class compactness only.</p>
</div>
</section>
<section id="S10.SS0.SSS0.Px5" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Connection with FSCE</h4>

<div id="S10.SS0.SSS0.Px5.p1" class="ltx_para">
<p id="S10.SS0.SSS0.Px5.p1.1" class="ltx_p">In FSCE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite>, the authors has provided a strong baseline by adjusting the hyper-parameters in RPN and proposal selection. We have tried to apply it in our framework but the performance drops. As such, we still follow the hyper-paramter setting in TFA. Meanwhile, it also demonstrates that the observation in FSCE is only available in the two-step based training strategy such as TFA, and cannot be generalized to a universal case.</p>
</div>
<div id="S10.SS0.SSS0.Px5.p2" class="ltx_para">
<p id="S10.SS0.SSS0.Px5.p2.1" class="ltx_p">Furthermore, FSCE proposed a contrastive encoding approach and treats the proposals as augmentation of the same instance. However, we have also add the contrastive loss in our approach and observed that it may help improve the nove detection slightly but hurt the base detection significantly. We think the reason is that the data distribution is extremely imbalanced and and the contrastive loss cannot help.</p>
</div>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text" style="font-size:90%;">
Peter L Bartlett, Michael I Jordan, and Jon D McAuliffe.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.2.1" class="ltx_text" style="font-size:90%;">Convexity, classification, and risk bounds.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Journal of the American Statistical Association</span><span id="bib.bib1.4.2" class="ltx_text" style="font-size:90%;">,
101(473):138–156, 2006.
</span>
</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text" style="font-size:90%;">
Nicolas Carion, Francisco Massa, Gabriel Synnaeve, Nicolas Usunier, Alexander
Kirillov, and Sergey Zagoruyko.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.2.1" class="ltx_text" style="font-size:90%;">End-to-end object detection with transformers.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib2.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">European conference on computer vision</span><span id="bib.bib2.5.3" class="ltx_text" style="font-size:90%;">, pages 213–229.
Springer, 2020.
</span>
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text" style="font-size:90%;">
M. Everingham, L. Van Gool, C. K. I. Williams, J. Winn, and A. Zisserman.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.2.1" class="ltx_text" style="font-size:90%;">The PASCAL Visual Object Classes Challenge 2007 (VOC2007)
Results.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.3.1" class="ltx_text" style="font-size:90%;">http://www.pascal-network.org/challenges/VOC/voc2007/workshop/index.html.
</span>
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text" style="font-size:90%;">
M. Everingham, L. Van Gool, C. K. I. Williams, J. Winn, and A. Zisserman.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.2.1" class="ltx_text" style="font-size:90%;">The PASCAL Visual Object Classes Challenge 2012 (VOC2012)
Results.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.3.1" class="ltx_text" style="font-size:90%;">http://www.pascal-network.org/challenges/VOC/voc2012/workshop/index.html.
</span>
</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text" style="font-size:90%;">
Qi Fan, Wei Zhuo, Chi-Keung Tang, and Yu-Wing Tai.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.2.1" class="ltx_text" style="font-size:90%;">Few-shot object detection with attention-rpn and multi-relation
detector.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib5.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib5.5.3" class="ltx_text" style="font-size:90%;">, pages 4013–4022, 2020.
</span>
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text" style="font-size:90%;">
Zhibo Fan, Yuchen Ma, Zeming Li, and Jian Sun.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.2.1" class="ltx_text" style="font-size:90%;">Generalized few-shot object detection without forgetting.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib6.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib6.5.3" class="ltx_text" style="font-size:90%;">, pages 4527–4536, 2021.
</span>
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text" style="font-size:90%;">
Chengjian Feng, Yujie Zhong, and Weilin Huang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.2.1" class="ltx_text" style="font-size:90%;">Exploring classification equilibrium in long-tailed object detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib7.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF International Conference on
Computer Vision</span><span id="bib.bib7.5.3" class="ltx_text" style="font-size:90%;">, pages 3417–3426, 2021.
</span>
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text" style="font-size:90%;">
Chelsea Finn, Pieter Abbeel, and Sergey Levine.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.2.1" class="ltx_text" style="font-size:90%;">Model-agnostic meta-learning for fast adaptation of deep networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib8.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International conference on machine learning</span><span id="bib.bib8.5.3" class="ltx_text" style="font-size:90%;">, pages
1126–1135. PMLR, 2017.
</span>
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text" style="font-size:90%;">
Ian Goodfellow, Yoshua Bengio, and Aaron Courville.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.2.1" class="ltx_text" style="font-size:90%;">Deep learning (adaptive computation and machine learning series).
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Cambridge Massachusetts</span><span id="bib.bib9.4.2" class="ltx_text" style="font-size:90%;">, pages 321–359, 2017.
</span>
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text" style="font-size:90%;">
Agrim Gupta, Piotr Dollar, and Ross Girshick.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.2.1" class="ltx_text" style="font-size:90%;">Lvis: A dataset for large vocabulary instance segmentation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib10.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF conference on computer vision and
pattern recognition</span><span id="bib.bib10.5.3" class="ltx_text" style="font-size:90%;">, pages 5356–5364, 2019.
</span>
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text" style="font-size:90%;">
Guangxing Han, Yicheng He, Shiyuan Huang, Jiawei Ma, and Shih-Fu Chang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.2.1" class="ltx_text" style="font-size:90%;">Query adaptive few-shot object detection with heterogeneous graph
convolutional networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib11.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF International Conference on
Computer Vision (ICCV)</span><span id="bib.bib11.5.3" class="ltx_text" style="font-size:90%;">, pages 3263–3272, October 2021.
</span>
</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text" style="font-size:90%;">
Guangxing Han, Shiyuan Huang, Jiawei Ma, Yicheng He, and Shih-Fu Chang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.2.1" class="ltx_text" style="font-size:90%;">Meta faster r-cnn: Towards accurate few-shot object detection with
attentive feature alignment.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib12.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the AAAI Conference on Artificial
Intelligence</span><span id="bib.bib12.5.3" class="ltx_text" style="font-size:90%;">, volume 36, pages 780–789, 2022.
</span>
</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text" style="font-size:90%;">
Guangxing Han, Jiawei Ma, Shiyuan Huang, Long Chen, and Shih-Fu Chang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.2.1" class="ltx_text" style="font-size:90%;">Few-shot object detection with fully cross-transformer.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib13.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and
Pattern Recognition (CVPR)</span><span id="bib.bib13.5.3" class="ltx_text" style="font-size:90%;">, pages 5321–5330, June 2022.
</span>
</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text" style="font-size:90%;">
Guangxing Han, Jiawei Ma, Shiyuan Huang, Long Chen, Rama Chellappa, and Shih-Fu
Chang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.2.1" class="ltx_text" style="font-size:90%;">Multimodal few-shot object detection with meta-learning based
cross-modal prompting.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2204.07841</span><span id="bib.bib14.4.2" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text" style="font-size:90%;">
Guangxing Han, Xuan Zhang, and Chongrong Li.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.2.1" class="ltx_text" style="font-size:90%;">Revisiting faster r-cnn: A deeper look at region proposal network.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib15.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Neural Information Processing</span><span id="bib.bib15.5.3" class="ltx_text" style="font-size:90%;">,
pages 14–24, 2017.
</span>
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text" style="font-size:90%;">
Guangxing Han, Xuan Zhang, and Chongrong Li.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.2.1" class="ltx_text" style="font-size:90%;">Single shot object detection with top-down refinement.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib16.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">2017 IEEE International Conference on Image Processing
(ICIP)</span><span id="bib.bib16.5.3" class="ltx_text" style="font-size:90%;">, pages 3360–3364. IEEE, 2017.
</span>
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text" style="font-size:90%;">
Guangxing Han, Xuan Zhang, and Chongrong Li.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.2.1" class="ltx_text" style="font-size:90%;">Semi-supervised dff: Decoupling detection and feature flow for video
object detectors.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib17.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the 26th ACM international conference on
Multimedia</span><span id="bib.bib17.5.3" class="ltx_text" style="font-size:90%;">, pages 1811–1819, 2018.
</span>
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text" style="font-size:90%;">
Haibo He and Edwardo A Garcia.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.2.1" class="ltx_text" style="font-size:90%;">Learning from imbalanced data.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Transactions on knowledge and data engineering</span><span id="bib.bib18.4.2" class="ltx_text" style="font-size:90%;">,
21(9):1263–1284, 2009.
</span>
</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text" style="font-size:90%;">
Shiyuan Huang, Jiawei Ma, Guangxing Han, and Shih-Fu Chang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.2.1" class="ltx_text" style="font-size:90%;">Task-adaptive negative envision for few-shot open-set recognition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib19.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib19.5.3" class="ltx_text" style="font-size:90%;">, pages 7171–7180, 2022.
</span>
</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text" style="font-size:90%;">
Bingyi Kang, Zhuang Liu, Xin Wang, Fisher Yu, Jiashi Feng, and Trevor Darrell.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.2.1" class="ltx_text" style="font-size:90%;">Few-shot object detection via feature reweighting.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib20.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF International Conference on
Computer Vision</span><span id="bib.bib20.5.3" class="ltx_text" style="font-size:90%;">, pages 8420–8429, 2019.
</span>
</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock"><span id="bib.bib21.1.1" class="ltx_text" style="font-size:90%;">
Alex Krizhevsky, Ilya Sutskever, and Geoffrey E Hinton.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.2.1" class="ltx_text" style="font-size:90%;">Imagenet classification with deep convolutional neural networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Communications of the ACM</span><span id="bib.bib21.4.2" class="ltx_text" style="font-size:90%;">, 60(6):84–90, 2017.
</span>
</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text" style="font-size:90%;">
Aoxue Li and Zhenguo Li.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.2.1" class="ltx_text" style="font-size:90%;">Transformation invariant few-shot object detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib22.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib22.5.3" class="ltx_text" style="font-size:90%;">, pages 3094–3102, 2021.
</span>
</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text" style="font-size:90%;">
Bohao Li, Boyu Yang, Chang Liu, Feng Liu, Rongrong Ji, and Qixiang Ye.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.2.1" class="ltx_text" style="font-size:90%;">Beyond max-margin: Class margin equilibrium for few-shot object
detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib23.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib23.5.3" class="ltx_text" style="font-size:90%;">, pages 7363–7372, 2021.
</span>
</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock"><span id="bib.bib24.1.1" class="ltx_text" style="font-size:90%;">
Bo Li, Yongqiang Yao, Jingru Tan, Gang Zhang, Fengwei Yu, Jianwei Lu, and Ye
Luo.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.2.1" class="ltx_text" style="font-size:90%;">Equalized focal loss for dense long-tailed object detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib24.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib24.5.3" class="ltx_text" style="font-size:90%;">, pages 6990–6999, 2022.
</span>
</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock"><span id="bib.bib25.1.1" class="ltx_text" style="font-size:90%;">
Yu Li, Tao Wang, Bingyi Kang, Sheng Tang, Chunfeng Wang, Jintao Li, and Jiashi
Feng.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.2.1" class="ltx_text" style="font-size:90%;">Overcoming classifier imbalance for long-tail object detection with
balanced group softmax.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib25.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF conference on computer vision and
pattern recognition</span><span id="bib.bib25.5.3" class="ltx_text" style="font-size:90%;">, pages 10991–11000, 2020.
</span>
</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock"><span id="bib.bib26.1.1" class="ltx_text" style="font-size:90%;">
Han Lin, Guangxing Han, Jiawei Ma, Shiyuan Huang, Xudong Lin, and Shih-Fu
Chang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.2.1" class="ltx_text" style="font-size:90%;">Supervised masked knowledge distillation for few-shot transformers.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib26.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and
Pattern Recognition (CVPR)</span><span id="bib.bib26.5.3" class="ltx_text" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock"><span id="bib.bib27.1.1" class="ltx_text" style="font-size:90%;">
Tsung-Yi Lin, Piotr Dollár, Ross Girshick, Kaiming He, Bharath Hariharan,
and Serge Belongie.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.2.1" class="ltx_text" style="font-size:90%;">Feature pyramid networks for object detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib27.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE conference on computer vision and
pattern recognition</span><span id="bib.bib27.5.3" class="ltx_text" style="font-size:90%;">, pages 2117–2125, 2017.
</span>
</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock"><span id="bib.bib28.1.1" class="ltx_text" style="font-size:90%;">
Tsung-Yi Lin, Priya Goyal, Ross Girshick, Kaiming He, and Piotr Dollár.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.2.1" class="ltx_text" style="font-size:90%;">Focal loss for dense object detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib28.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE international conference on computer
vision</span><span id="bib.bib28.5.3" class="ltx_text" style="font-size:90%;">, pages 2980–2988, 2017.
</span>
</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock"><span id="bib.bib29.1.1" class="ltx_text" style="font-size:90%;">
Tsung-Yi Lin, Michael Maire, Serge Belongie, James Hays, Pietro Perona, Deva
Ramanan, Piotr Dollár, and C Lawrence Zitnick.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.2.1" class="ltx_text" style="font-size:90%;">Microsoft coco: Common objects in context.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib29.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">European conference on computer vision</span><span id="bib.bib29.5.3" class="ltx_text" style="font-size:90%;">, pages 740–755.
Springer, 2014.
</span>
</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock"><span id="bib.bib30.1.1" class="ltx_text" style="font-size:90%;">
Yi Lin.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.2.1" class="ltx_text" style="font-size:90%;">A note on margin-based loss functions in classification.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Statistics &amp; probability letters</span><span id="bib.bib30.4.2" class="ltx_text" style="font-size:90%;">, 68(1):73–82, 2004.
</span>
</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock"><span id="bib.bib31.1.1" class="ltx_text" style="font-size:90%;">
Bin Liu, Yue Cao, Yutong Lin, Qi Li, Zheng Zhang, Mingsheng Long, and Han Hu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.2.1" class="ltx_text" style="font-size:90%;">Negative margin matters: Understanding margin in few-shot
classification.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib31.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">European conference on computer vision</span><span id="bib.bib31.5.3" class="ltx_text" style="font-size:90%;">, pages 438–455.
Springer, 2020.
</span>
</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock"><span id="bib.bib32.1.1" class="ltx_text" style="font-size:90%;">
Jiawei Ma, Guangxing Han, Shiyuan Huang, Yuncong Yang, and Shih-Fu Chang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.2.1" class="ltx_text" style="font-size:90%;">Few-shot end-to-end object detection via constantly concentrated
encoding across heads.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib32.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Computer Vision–ECCV 2022: 17th European Conference, Tel
Aviv, Israel, October 23–27, 2022, Proceedings, Part XXVI</span><span id="bib.bib32.5.3" class="ltx_text" style="font-size:90%;">, pages 57–73.
Springer, 2022.
</span>
</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock"><span id="bib.bib33.1.1" class="ltx_text" style="font-size:90%;">
Jiawei Ma, Hanchen Xie, Guangxing Han, Shih-Fu Chang, Aram Galstyan, and Wael
Abd-Almageed.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib33.2.1" class="ltx_text" style="font-size:90%;">Partner-assisted learning for few-shot image classification.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib33.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib33.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF International Conference on
Computer Vision</span><span id="bib.bib33.5.3" class="ltx_text" style="font-size:90%;">, pages 10573–10582, 2021.
</span>
</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock"><span id="bib.bib34.1.1" class="ltx_text" style="font-size:90%;">
Aditya Krishna Menon, Sadeep Jayasumana, Ankit Singh Rawat, Himanshu Jain,
Andreas Veit, and Sanjiv Kumar.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib34.2.1" class="ltx_text" style="font-size:90%;">Long-tail learning via logit adjustment.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib34.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib34.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Learning Representations</span><span id="bib.bib34.5.3" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock"><span id="bib.bib35.1.1" class="ltx_text" style="font-size:90%;">
Yulei Niu, Long Chen, Chang Zhou, and Hanwang Zhang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib35.2.1" class="ltx_text" style="font-size:90%;">Respecting transfer gap in knowledge distillation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib35.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2210.12787</span><span id="bib.bib35.4.2" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock"><span id="bib.bib36.1.1" class="ltx_text" style="font-size:90%;">
Yulei Niu, Kaihua Tang, Hanwang Zhang, Zhiwu Lu, Xian-Sheng Hua, and Ji-Rong
Wen.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib36.2.1" class="ltx_text" style="font-size:90%;">Counterfactual vqa: A cause-effect look at language bias.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib36.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib36.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib36.5.3" class="ltx_text" style="font-size:90%;">, pages 12700–12710, 2021.
</span>
</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock"><span id="bib.bib37.1.1" class="ltx_text" style="font-size:90%;">
Yulei Niu and Hanwang Zhang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib37.2.1" class="ltx_text" style="font-size:90%;">Introspective distillation for robust question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib37.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in Neural Information Processing Systems</span><span id="bib.bib37.4.2" class="ltx_text" style="font-size:90%;">,
34:16292–16304, 2021.
</span>
</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock"><span id="bib.bib38.1.1" class="ltx_text" style="font-size:90%;">
Vardan Papyan, XY Han, and David L Donoho.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib38.2.1" class="ltx_text" style="font-size:90%;">Prevalence of neural collapse during the terminal phase of deep
learning training.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib38.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the National Academy of Sciences</span><span id="bib.bib38.4.2" class="ltx_text" style="font-size:90%;">,
117(40):24652–24663, 2020.
</span>
</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock"><span id="bib.bib39.1.1" class="ltx_text" style="font-size:90%;">
Juan-Manuel Perez-Rua, Xiatian Zhu, Timothy M Hospedales, and Tao Xiang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib39.2.1" class="ltx_text" style="font-size:90%;">Incremental few-shot object detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib39.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib39.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib39.5.3" class="ltx_text" style="font-size:90%;">, pages 13846–13855, 2020.
</span>
</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock"><span id="bib.bib40.1.1" class="ltx_text" style="font-size:90%;">
Jiaxin Qi, Yulei Niu, Jianqiang Huang, and Hanwang Zhang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib40.2.1" class="ltx_text" style="font-size:90%;">Two causal principles for improving visual dialog.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib40.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib40.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF conference on computer vision and
pattern recognition</span><span id="bib.bib40.5.3" class="ltx_text" style="font-size:90%;">, pages 10860–10869, 2020.
</span>
</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock"><span id="bib.bib41.1.1" class="ltx_text" style="font-size:90%;">
Limeng Qiao, Yuxuan Zhao, Zhiyuan Li, Xi Qiu, Jianan Wu, and Chi Zhang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib41.2.1" class="ltx_text" style="font-size:90%;">Defrcn: Decoupled faster r-cnn for few-shot object detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib41.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib41.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF International Conference on
Computer Vision</span><span id="bib.bib41.5.3" class="ltx_text" style="font-size:90%;">, pages 8681–8690, 2021.
</span>
</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock"><span id="bib.bib42.1.1" class="ltx_text" style="font-size:90%;">
Joseph Redmon, Santosh Divvala, Ross Girshick, and Ali Farhadi.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib42.2.1" class="ltx_text" style="font-size:90%;">You only look once: Unified, real-time object detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib42.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib42.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE conference on computer vision and
pattern recognition</span><span id="bib.bib42.5.3" class="ltx_text" style="font-size:90%;">, pages 779–788, 2016.
</span>
</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock"><span id="bib.bib43.1.1" class="ltx_text" style="font-size:90%;">
Jiawei Ren, Cunjun Yu, Xiao Ma, Haiyu Zhao, Shuai Yi, et al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib43.2.1" class="ltx_text" style="font-size:90%;">Balanced meta-softmax for long-tailed visual recognition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib43.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in neural information processing systems</span><span id="bib.bib43.4.2" class="ltx_text" style="font-size:90%;">,
33:4175–4186, 2020.
</span>
</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock"><span id="bib.bib44.1.1" class="ltx_text" style="font-size:90%;">
Shaoqing Ren, Kaiming He, Ross Girshick, and Jian Sun.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib44.2.1" class="ltx_text" style="font-size:90%;">Faster r-cnn: Towards real-time object detection with region proposal
networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib44.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in neural information processing systems</span><span id="bib.bib44.4.2" class="ltx_text" style="font-size:90%;">, 28, 2015.
</span>
</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock"><span id="bib.bib45.1.1" class="ltx_text" style="font-size:90%;">
Jake Snell, Kevin Swersky, and Richard Zemel.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib45.2.1" class="ltx_text" style="font-size:90%;">Prototypical networks for few-shot learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib45.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in neural information processing systems</span><span id="bib.bib45.4.2" class="ltx_text" style="font-size:90%;">, 30, 2017.
</span>
</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock"><span id="bib.bib46.1.1" class="ltx_text" style="font-size:90%;">
Bo Sun, Banghuai Li, Shengcai Cai, Ye Yuan, and Chi Zhang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib46.2.1" class="ltx_text" style="font-size:90%;">Fsce: Few-shot object detection via contrastive proposal encoding.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib46.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib46.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib46.5.3" class="ltx_text" style="font-size:90%;">, pages 7352–7362, 2021.
</span>
</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock"><span id="bib.bib47.1.1" class="ltx_text" style="font-size:90%;">
Peize Sun, Rufeng Zhang, Yi Jiang, Tao Kong, Chenfeng Xu, Wei Zhan, Masayoshi
Tomizuka, Lei Li, Zehuan Yuan, Changhu Wang, et al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib47.2.1" class="ltx_text" style="font-size:90%;">Sparse r-cnn: End-to-end object detection with learnable proposals.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib47.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib47.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF conference on computer vision and
pattern recognition</span><span id="bib.bib47.5.3" class="ltx_text" style="font-size:90%;">, pages 14454–14463, 2021.
</span>
</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock"><span id="bib.bib48.1.1" class="ltx_text" style="font-size:90%;">
Ilya Sutskever, James Martens, George Dahl, and Geoffrey Hinton.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib48.2.1" class="ltx_text" style="font-size:90%;">On the importance of initialization and momentum in deep learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib48.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib48.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International conference on machine learning</span><span id="bib.bib48.5.3" class="ltx_text" style="font-size:90%;">, pages
1139–1147. PMLR, 2013.
</span>
</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock"><span id="bib.bib49.1.1" class="ltx_text" style="font-size:90%;">
Jingru Tan, Changbao Wang, Buyu Li, Quanquan Li, Wanli Ouyang, Changqing Yin,
and Junjie Yan.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib49.2.1" class="ltx_text" style="font-size:90%;">Equalization loss for long-tailed object recognition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib49.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib49.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF conference on computer vision and
pattern recognition</span><span id="bib.bib49.5.3" class="ltx_text" style="font-size:90%;">, pages 11662–11671, 2020.
</span>
</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock"><span id="bib.bib50.1.1" class="ltx_text" style="font-size:90%;">
Kaihua Tang, Yulei Niu, Jianqiang Huang, Jiaxin Shi, and Hanwang Zhang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib50.2.1" class="ltx_text" style="font-size:90%;">Unbiased scene graph generation from biased training.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib50.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib50.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF conference on computer vision and
pattern recognition</span><span id="bib.bib50.5.3" class="ltx_text" style="font-size:90%;">, pages 3716–3725, 2020.
</span>
</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock"><span id="bib.bib51.1.1" class="ltx_text" style="font-size:90%;">
Yonglong Tian, Yue Wang, Dilip Krishnan, Joshua B Tenenbaum, and Phillip Isola.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib51.2.1" class="ltx_text" style="font-size:90%;">Rethinking few-shot image classification: a good embedding is all you
need?
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib51.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib51.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">European Conference on Computer Vision</span><span id="bib.bib51.5.3" class="ltx_text" style="font-size:90%;">, pages 266–282.
Springer, 2020.
</span>
</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock"><span id="bib.bib52.1.1" class="ltx_text" style="font-size:90%;">
Jiaqi Wang, Wenwei Zhang, Yuhang Zang, Yuhang Cao, Jiangmiao Pang, Tao Gong,
Kai Chen, Ziwei Liu, Chen Change Loy, and Dahua Lin.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib52.2.1" class="ltx_text" style="font-size:90%;">Seesaw loss for long-tailed instance segmentation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib52.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib52.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF conference on computer vision and
pattern recognition</span><span id="bib.bib52.5.3" class="ltx_text" style="font-size:90%;">, pages 9695–9704, 2021.
</span>
</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[53]</span>
<span class="ltx_bibblock"><span id="bib.bib53.1.1" class="ltx_text" style="font-size:90%;">
Tao Wang, Yu Li, Bingyi Kang, Junnan Li, Junhao Liew, Sheng Tang, Steven Hoi,
and Jiashi Feng.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib53.2.1" class="ltx_text" style="font-size:90%;">The devil is in classification: A simple framework for long-tail
instance segmentation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib53.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib53.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">European conference on computer vision</span><span id="bib.bib53.5.3" class="ltx_text" style="font-size:90%;">, pages 728–744.
Springer, 2020.
</span>
</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[54]</span>
<span class="ltx_bibblock"><span id="bib.bib54.1.1" class="ltx_text" style="font-size:90%;">
Tong Wang, Yousong Zhu, Chaoyang Zhao, Wei Zeng, Jinqiao Wang, and Ming Tang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib54.2.1" class="ltx_text" style="font-size:90%;">Adaptive class suppression loss for long-tail object detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib54.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib54.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF conference on computer vision and
pattern recognition</span><span id="bib.bib54.5.3" class="ltx_text" style="font-size:90%;">, pages 3103–3112, 2021.
</span>
</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[55]</span>
<span class="ltx_bibblock"><span id="bib.bib55.1.1" class="ltx_text" style="font-size:90%;">
Xin Wang, Thomas Huang, Joseph Gonzalez, Trevor Darrell, and Fisher Yu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib55.2.1" class="ltx_text" style="font-size:90%;">Frustratingly simple few-shot object detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib55.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib55.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Machine Learning</span><span id="bib.bib55.5.3" class="ltx_text" style="font-size:90%;">, pages
9919–9928. PMLR, 2020.
</span>
</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[56]</span>
<span class="ltx_bibblock"><span id="bib.bib56.1.1" class="ltx_text" style="font-size:90%;">
Yandong Wen, Kaipeng Zhang, Zhifeng Li, and Yu Qiao.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib56.2.1" class="ltx_text" style="font-size:90%;">A discriminative feature learning approach for deep face recognition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib56.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib56.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">European conference on computer vision</span><span id="bib.bib56.5.3" class="ltx_text" style="font-size:90%;">, pages 499–515.
Springer, 2016.
</span>
</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[57]</span>
<span class="ltx_bibblock"><span id="bib.bib57.1.1" class="ltx_text" style="font-size:90%;">
Jiaxi Wu, Songtao Liu, Di Huang, and Yunhong Wang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib57.2.1" class="ltx_text" style="font-size:90%;">Multi-scale positive sample refinement for few-shot object detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib57.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib57.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">European conference on computer vision</span><span id="bib.bib57.5.3" class="ltx_text" style="font-size:90%;">, pages 456–472.
Springer, 2020.
</span>
</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[58]</span>
<span class="ltx_bibblock"><span id="bib.bib58.1.1" class="ltx_text" style="font-size:90%;">
Yang Xiao and Renaud Marlet.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib58.2.1" class="ltx_text" style="font-size:90%;">Few-shot object detection and viewpoint estimation for objects in the
wild.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib58.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib58.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">European conference on computer vision</span><span id="bib.bib58.5.3" class="ltx_text" style="font-size:90%;">, pages 192–210.
Springer, 2020.
</span>
</span>
</li>
<li id="bib.bib59" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[59]</span>
<span class="ltx_bibblock"><span id="bib.bib59.1.1" class="ltx_text" style="font-size:90%;">
Xiaopeng Yan, Ziliang Chen, Anni Xu, Xiaoxi Wang, Xiaodan Liang, and Liang Lin.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib59.2.1" class="ltx_text" style="font-size:90%;">Meta r-cnn: Towards general solver for instance-level low-shot
learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib59.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib59.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF International Conference on
Computer Vision</span><span id="bib.bib59.5.3" class="ltx_text" style="font-size:90%;">, pages 9577–9586, 2019.
</span>
</span>
</li>
<li id="bib.bib60" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[60]</span>
<span class="ltx_bibblock"><span id="bib.bib60.1.1" class="ltx_text" style="font-size:90%;">
Yibo Yang, Liang Xie, Shixiang Chen, Xiangtai Li, Zhouchen Lin, and Dacheng
Tao.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib60.2.1" class="ltx_text" style="font-size:90%;">Do we really need a learnable classifier at the end of deep neural
network?
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib60.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2203.09081</span><span id="bib.bib60.4.2" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib61" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[61]</span>
<span class="ltx_bibblock"><span id="bib.bib61.1.1" class="ltx_text" style="font-size:90%;">
Yibo Yang, Haobo Yuan, Xiangtai Li, Zhouchen Lin, Philip Torr, and Dacheng Tao.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib61.2.1" class="ltx_text" style="font-size:90%;">Neural collapse inspired feature-classifier alignment for few-shot
class incremental learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib61.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2302.03004</span><span id="bib.bib61.4.2" class="ltx_text" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li id="bib.bib62" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[62]</span>
<span class="ltx_bibblock"><span id="bib.bib62.1.1" class="ltx_text" style="font-size:90%;">
Nikolaos-Antonios Ypsilantis, Noa Garcia, Guangxing Han, Sarah Ibrahimi, Nanne
Van Noord, and Giorgos Tolias.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib62.2.1" class="ltx_text" style="font-size:90%;">The met dataset: Instance-level recognition for artworks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib62.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib62.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Thirty-fifth Conference on Neural Information Processing
Systems Datasets and Benchmarks Track (Round 2)</span><span id="bib.bib62.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib63" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[63]</span>
<span class="ltx_bibblock"><span id="bib.bib63.1.1" class="ltx_text" style="font-size:90%;">
Hao Zhang, Feng Li, Shilong Liu, Lei Zhang, Hang Su, Jun Zhu, Lionel M Ni, and
Heung-Yeung Shum.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib63.2.1" class="ltx_text" style="font-size:90%;">Dino: Detr with improved denoising anchor boxes for end-to-end object
detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib63.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2203.03605</span><span id="bib.bib63.4.2" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib64" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[64]</span>
<span class="ltx_bibblock"><span id="bib.bib64.1.1" class="ltx_text" style="font-size:90%;">
Songyang Zhang, Zeming Li, Shipeng Yan, Xuming He, and Jian Sun.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib64.2.1" class="ltx_text" style="font-size:90%;">Distribution alignment: A unified framework for long-tail visual
recognition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib64.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib64.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF conference on computer vision and
pattern recognition</span><span id="bib.bib64.5.3" class="ltx_text" style="font-size:90%;">, pages 2361–2370, 2021.
</span>
</span>
</li>
<li id="bib.bib65" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[65]</span>
<span class="ltx_bibblock"><span id="bib.bib65.1.1" class="ltx_text" style="font-size:90%;">
An Zhao, Mingyu Ding, Zhiwu Lu, Tao Xiang, Yulei Niu, Jiechao Guan, and Ji-Rong
Wen.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib65.2.1" class="ltx_text" style="font-size:90%;">Domain-adaptive few-shot learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib65.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib65.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF Winter Conference on Applications
of Computer Vision</span><span id="bib.bib65.5.3" class="ltx_text" style="font-size:90%;">, pages 1390–1399, 2021.
</span>
</span>
</li>
<li id="bib.bib66" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[66]</span>
<span class="ltx_bibblock"><span id="bib.bib66.1.1" class="ltx_text" style="font-size:90%;">
Da-Wei Zhou, Han-Jia Ye, and De-Chuan Zhan.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib66.2.1" class="ltx_text" style="font-size:90%;">Learning placeholders for open-set recognition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib66.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib66.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib66.5.3" class="ltx_text" style="font-size:90%;">, pages 4401–4410, 2021.
</span>
</span>
</li>
<li id="bib.bib67" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[67]</span>
<span class="ltx_bibblock"><span id="bib.bib67.1.1" class="ltx_text" style="font-size:90%;">
Beier Zhu, Yulei Niu, Yucheng Han, Yue Wu, and Hanwang Zhang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib67.2.1" class="ltx_text" style="font-size:90%;">Prompt-aligned gradient for prompt tuning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib67.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2205.14865</span><span id="bib.bib67.4.2" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib68" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[68]</span>
<span class="ltx_bibblock"><span id="bib.bib68.1.1" class="ltx_text" style="font-size:90%;">
Beier Zhu, Yulei Niu, Xian-Sheng Hua, and Hanwang Zhang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib68.2.1" class="ltx_text" style="font-size:90%;">Cross-domain empirical risk minimization for unbiased long-tailed
classification.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib68.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib68.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the AAAI Conference on Artificial
Intelligence</span><span id="bib.bib68.5.3" class="ltx_text" style="font-size:90%;">, volume 36, pages 3589–3597, 2022.
</span>
</span>
</li>
<li id="bib.bib69" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[69]</span>
<span class="ltx_bibblock"><span id="bib.bib69.1.1" class="ltx_text" style="font-size:90%;">
Xizhou Zhu, Weijie Su, Lewei Lu, Bin Li, Xiaogang Wang, and Jifeng Dai.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib69.2.1" class="ltx_text" style="font-size:90%;">Deformable detr: Deformable transformers for end-to-end object
detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib69.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2010.04159</span><span id="bib.bib69.4.2" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
</ul>
</section>
</section>
</section>
</section>
</section>
</div>
</div>
</figure>
</section>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2303.09673" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2303.09674" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2303.09674">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2303.09674" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2303.09675" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Feb 29 19:32:04 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
