<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Enhanced Transformer architecture for in-context learning of dynamical systems</title>
<!--Generated on Fri Oct  4 09:41:50 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<!--Document created on October 2024.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.03291v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#S1" title="In Enhanced Transformer architecture for in-context learning of dynamical systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#S2" title="In Enhanced Transformer architecture for in-context learning of dynamical systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Problem description</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#S3" title="In Enhanced Transformer architecture for in-context learning of dynamical systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Advancing the Transformer Architecture</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#S3.SS1" title="In 3 Advancing the Transformer Architecture ‣ Enhanced Transformer architecture for in-context learning of dynamical systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Learning Probability Distributions</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#S3.SS2" title="In 3 Advancing the Transformer Architecture ‣ Enhanced Transformer architecture for in-context learning of dynamical systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Handling arbitrary initial conditions</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#S3.SS3" title="In 3 Advancing the Transformer Architecture ‣ Enhanced Transformer architecture for in-context learning of dynamical systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Patching for long context sequences</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#S4" title="In Enhanced Transformer architecture for in-context learning of dynamical systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Numerical Example</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#S4.SS1" title="In 4 Numerical Example ‣ Enhanced Transformer architecture for in-context learning of dynamical systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>System Class and Dataset Distribution</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#S4.SS2" title="In 4 Numerical Example ‣ Enhanced Transformer architecture for in-context learning of dynamical systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Transformer architecture</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#S4.SS3" title="In 4 Numerical Example ‣ Enhanced Transformer architecture for in-context learning of dynamical systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#S4.SS4" title="In 4 Numerical Example ‣ Enhanced Transformer architecture for in-context learning of dynamical systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Out-of-distribution</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#S5" title="In Enhanced Transformer architecture for in-context learning of dynamical systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusions</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_font_bold ltx_title_document" style="font-size:173%;">Enhanced Transformer architecture for in-context learning of dynamical systems
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Matteo Rufolo, Dario Piga, Gabriele Maroni, Marco Forgione
</span><span class="ltx_author_notes">The authors are with SUPSI, IDSIA, Lugano, 6962, Switzerland.
<span class="ltx_text ltx_font_typewriter" id="id1.1.id1" style="font-size:90%;">e-mails: name.surname@supsi.ch</span></span></span>
</div>
<div class="ltx_dates">(October 2024)</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id2.id1">Recently introduced by some of the authors, the in-context identification paradigm aims at estimating, offline and based on synthetic data, a meta-model that describes the behavior of a whole class of systems. Once trained, this meta-model is fed with an observed input/output sequence (<em class="ltx_emph ltx_font_italic" id="id2.id1.1">context</em>) generated by a real system to predict its behavior in a zero-shot learning fashion. In this paper, we enhance the original meta-modeling framework through three key innovations: by formulating the learning task within a probabilistic framework; by managing non-contiguous context and query windows; and by adopting recurrent patching to effectively handle long context sequences. The efficacy of these modifications is demonstrated through a numerical example focusing on the Wiener-Hammerstein system class, highlighting the model’s enhanced performance and scalability.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">In system identification (SYSID), the primary objective is to model dynamical systems, leveraging both measured input-output trajectories and prior knowledge of the system’s dynamics.
The SYSID setting is thus closely related to supervised machine learning (ML), with a specific focus on dynamical systems.
Due to this similarity, machine-learning techniques have become increasingly popular over the years for estimating dynamical systems through, e.g., neural network architectures <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#bib.bib1" title="">1</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#bib.bib2" title="">2</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#bib.bib3" title="">3</a>]</cite> and kernel-based methods <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#bib.bib4" title="">4</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#bib.bib5" title="">5</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Despite their success, standard supervised learning approaches
do not exploit the insight that could be gained by repeatedly identifying similar systems. While humans improve at solving related tasks, traditional ML (and SYSID) algorithms rely on fixed, predefined procedures that are applied uniformly across different datasets.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">The concept of <em class="ltx_emph ltx_font_italic" id="S1.p3.1.1">learning to learn</em>, or meta-learning, was introduced in the late eighties by the pioneering work <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#bib.bib6" title="">6</a>]</cite> to overcome this limitation and is gaining increasing attention, see <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#bib.bib7" title="">7</a>]</cite> for a recent survey. In the meta-learning settings, a <em class="ltx_emph ltx_font_italic" id="S1.p3.1.2">series</em> of related tasks are presented to an agent which adapts its behavior to act optimally with respect to that class of tasks. In the context of SYSID, the algorithmic agent receives streams of input/output datasets from a class of dynamical systems, and self-tune its behavior to make optimal predictions for those systems <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#bib.bib8" title="">8</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#bib.bib9" title="">9</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#bib.bib10" title="">10</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">The meta-model presented by some of the authors in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#bib.bib11" title="">11</a>]</cite> generates multi-step-ahead predictions over a class of dynamical systems. It receives as input a <em class="ltx_emph ltx_font_italic" id="S1.p4.1.1">context</em> of past input/output samples from a system, together with the future <em class="ltx_emph ltx_font_italic" id="S1.p4.1.2">query</em> input trajectory, and directly generates an estimate of the corresponding future outputs.
Training is carried out in a supervised learning manner over a (potentially infinite) stream of <em class="ltx_emph ltx_font_italic" id="S1.p4.1.3">synthetic datasets</em> obtained by processing randomly-generated input signals through systems randomly sampled from the class of interest.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">To address the meta-modeling task across a broad range of systems, the meta-model must be able to extract relevant knowledge from the context data.
Essentially, the meta-model should function as a SYSID algorithm, learning system-specific models from the context data and leveraging this information to solve the multi-step-ahead simulation task for the given query input.
The peculiar capability of meta-models to behave like learning algorithms is often referred to as <em class="ltx_emph ltx_font_italic" id="S1.p5.1.1">in-context</em> learning <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#bib.bib12" title="">12</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">In <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#bib.bib11" title="">11</a>]</cite>, the meta-model was parameterized as an encoder-decoder Transformer, leveraging the strong in-context learning capabilities previously demonstrated by this architecture in the field of natural language processing <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#bib.bib13" title="">13</a>]</cite>. However, although the Transformers achieved promising results for meta-modeling of dynamical systems, it also has inherent limitations that hinder its potential across common SYSID scenarios. In this paper, we modify the architecture in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#bib.bib11" title="">11</a>]</cite> to address some of the limitations discussed below.</p>
</div>
<div class="ltx_para" id="S1.p7">
<p class="ltx_p" id="S1.p7.1">A well-known critical aspect of Transformers is the computational complexity of their key <em class="ltx_emph ltx_font_italic" id="S1.p7.1.1">attention mechanism</em>, which grows quadratically with the sequence length. In <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#bib.bib11" title="">11</a>]</cite>, this constrained the context sequence to a few hundred time steps, which is arguably shorter than a typical SYSID dataset. This computational issue has been extensively analyzed in recent literature, with several attempts proposed to mitigate it. Certain approaches aim at approximating attention with simplified mechanisms that achieve comparable results, but with reduced computational complexity <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#bib.bib14" title="">14</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#bib.bib15" title="">15</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#bib.bib16" title="">16</a>]</cite>. Other contributions adopt a hierarchical processing pattern where sequences are first divided into sub-sequences denoted as <em class="ltx_emph ltx_font_italic" id="S1.p7.1.2">patches</em>, that are processed individually by a <em class="ltx_emph ltx_font_italic" id="S1.p7.1.3">patching network</em> which reduces their time dimensionality. The Transformer eventually processes the resulting (shorter) sequence of patch embeddings, instead of the raw samples <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#bib.bib17" title="">17</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#bib.bib18" title="">18</a>]</cite>. In this paper, we address the context length limitation with a patch-based approach inspired by <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#bib.bib18" title="">18</a>]</cite>, but utilizing a Recurrent Neural Network (RNN) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#bib.bib19" title="">19</a>]</cite> as patching network instead of a linear layer.</p>
</div>
<div class="ltx_para" id="S1.p8">
<p class="ltx_p" id="S1.p8.1">Another limitations of <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#bib.bib11" title="">11</a>]</cite> is that the meta-model’s output consists of point estimates, which do not convey information about predictive uncertainty. We address this issue by formulating the learning problem in a probabilistic setting and by estimating the conditional distribution of the query output given the observed context and the query input.</p>
</div>
<div class="ltx_para" id="S1.p9">
<p class="ltx_p" id="S1.p9.1">Finally, <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#bib.bib11" title="">11</a>]</cite> assumed contiguous context and query windows. The task was formalized as a time series forecasting problem, where the objective is to guess the future values of the time series, given the past observations and future inputs. However, SYSID generally aims at estimating simulation models, that can describe systems starting from arbitrary initial conditions. To align with the SYSID setting, we modify the task and also provide the first input/output samples of the query segment to the meta-model. These samples convey the initial condition information for the query sequence, thus allowing it to be detached from the context.</p>
</div>
<div class="ltx_para" id="S1.p10">
<p class="ltx_p" id="S1.p10.1">The rest of the paper is organized as follows. Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#S2" title="2 Problem description ‣ Enhanced Transformer architecture for in-context learning of dynamical systems"><span class="ltx_text ltx_ref_tag">2</span></a> describes the problem setting, analyzing in detail the meta-modeling framework in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#bib.bib11" title="">11</a>]</cite> and the limitations of the architecture introduced in that work. The salient architectural changes introduced in this paper to overcome these limitations are described in <a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#S3" title="3 Advancing the Transformer Architecture ‣ Enhanced Transformer architecture for in-context learning of dynamical systems"><span class="ltx_text ltx_ref_tag">3</span></a>.
A numerical example is illustrated in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#S4" title="4 Numerical Example ‣ Enhanced Transformer architecture for in-context learning of dynamical systems"><span class="ltx_text ltx_ref_tag">4</span></a> to demonstrate the effectiveness of the proposed methodology. Conclusions and the direction for future studies are discussed in the Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#S5" title="5 Conclusions ‣ Enhanced Transformer architecture for in-context learning of dynamical systems"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Problem description</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.8">In <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#bib.bib11" title="">11</a>]</cite>, an in-context parametric learner <math alttext="\mathcal{M}_{\phi}" class="ltx_Math" display="inline" id="S2.p1.1.m1.1"><semantics id="S2.p1.1.m1.1a"><msub id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.1.m1.1.1.2" xref="S2.p1.1.m1.1.1.2.cmml">ℳ</mi><mi id="S2.p1.1.m1.1.1.3" xref="S2.p1.1.m1.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.1b"><apply id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.p1.1.m1.1.1.1.cmml" xref="S2.p1.1.m1.1.1">subscript</csymbol><ci id="S2.p1.1.m1.1.1.2.cmml" xref="S2.p1.1.m1.1.1.2">ℳ</ci><ci id="S2.p1.1.m1.1.1.3.cmml" xref="S2.p1.1.m1.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.1c">\mathcal{M}_{\phi}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.1.m1.1d">caligraphic_M start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math>, referred to as meta-model, has been introduced to describe a class of dynamical systems.
The meta-model <math alttext="\mathcal{M}_{\phi}" class="ltx_Math" display="inline" id="S2.p1.2.m2.1"><semantics id="S2.p1.2.m2.1a"><msub id="S2.p1.2.m2.1.1" xref="S2.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.2.m2.1.1.2" xref="S2.p1.2.m2.1.1.2.cmml">ℳ</mi><mi id="S2.p1.2.m2.1.1.3" xref="S2.p1.2.m2.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.2.m2.1b"><apply id="S2.p1.2.m2.1.1.cmml" xref="S2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.p1.2.m2.1.1.1.cmml" xref="S2.p1.2.m2.1.1">subscript</csymbol><ci id="S2.p1.2.m2.1.1.2.cmml" xref="S2.p1.2.m2.1.1.2">ℳ</ci><ci id="S2.p1.2.m2.1.1.3.cmml" xref="S2.p1.2.m2.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.m2.1c">\mathcal{M}_{\phi}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.2.m2.1d">caligraphic_M start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math>, with tunable parameters <math alttext="\phi" class="ltx_Math" display="inline" id="S2.p1.3.m3.1"><semantics id="S2.p1.3.m3.1a"><mi id="S2.p1.3.m3.1.1" xref="S2.p1.3.m3.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S2.p1.3.m3.1b"><ci id="S2.p1.3.m3.1.1.cmml" xref="S2.p1.3.m3.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.3.m3.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="S2.p1.3.m3.1d">italic_ϕ</annotation></semantics></math>,
is trained on a “meta-dataset”.
To define the “meta-dataset”, two <em class="ltx_emph ltx_font_italic" id="S2.p1.8.1">probability distributions</em>, one over dynamical systems and one over input signals, are introduced. By sampling from these two distributions, it is possible to generate a sequence of systems and inputs that, together with the corresponding outputs, result in “usual” input/output datasets. This leads to a potentially infinite <em class="ltx_emph ltx_font_italic" id="S2.p1.8.2">stream</em> of datasets <math alttext="\{\mathcal{D}^{(i)}=(u_{1:N}^{(i)},y_{1:N}^{(i)}),\,i=1,2,\dots,\infty\}" class="ltx_Math" display="inline" id="S2.p1.4.m4.8"><semantics id="S2.p1.4.m4.8a"><mrow id="S2.p1.4.m4.8.8.1" xref="S2.p1.4.m4.8.8.2.cmml"><mo id="S2.p1.4.m4.8.8.1.2" stretchy="false" xref="S2.p1.4.m4.8.8.2.cmml">{</mo><mrow id="S2.p1.4.m4.8.8.1.1.2" xref="S2.p1.4.m4.8.8.1.1.3.cmml"><mrow id="S2.p1.4.m4.8.8.1.1.1.1" xref="S2.p1.4.m4.8.8.1.1.1.1.cmml"><msup id="S2.p1.4.m4.8.8.1.1.1.1.4" xref="S2.p1.4.m4.8.8.1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.4.m4.8.8.1.1.1.1.4.2" xref="S2.p1.4.m4.8.8.1.1.1.1.4.2.cmml">𝒟</mi><mrow id="S2.p1.4.m4.1.1.1.3" xref="S2.p1.4.m4.8.8.1.1.1.1.4.cmml"><mo id="S2.p1.4.m4.1.1.1.3.1" stretchy="false" xref="S2.p1.4.m4.8.8.1.1.1.1.4.cmml">(</mo><mi id="S2.p1.4.m4.1.1.1.1" xref="S2.p1.4.m4.1.1.1.1.cmml">i</mi><mo id="S2.p1.4.m4.1.1.1.3.2" stretchy="false" xref="S2.p1.4.m4.8.8.1.1.1.1.4.cmml">)</mo></mrow></msup><mo id="S2.p1.4.m4.8.8.1.1.1.1.3" xref="S2.p1.4.m4.8.8.1.1.1.1.3.cmml">=</mo><mrow id="S2.p1.4.m4.8.8.1.1.1.1.2.2" xref="S2.p1.4.m4.8.8.1.1.1.1.2.3.cmml"><mo id="S2.p1.4.m4.8.8.1.1.1.1.2.2.3" stretchy="false" xref="S2.p1.4.m4.8.8.1.1.1.1.2.3.cmml">(</mo><msubsup id="S2.p1.4.m4.8.8.1.1.1.1.1.1.1" xref="S2.p1.4.m4.8.8.1.1.1.1.1.1.1.cmml"><mi id="S2.p1.4.m4.8.8.1.1.1.1.1.1.1.2.2" xref="S2.p1.4.m4.8.8.1.1.1.1.1.1.1.2.2.cmml">u</mi><mrow id="S2.p1.4.m4.8.8.1.1.1.1.1.1.1.2.3" xref="S2.p1.4.m4.8.8.1.1.1.1.1.1.1.2.3.cmml"><mn id="S2.p1.4.m4.8.8.1.1.1.1.1.1.1.2.3.2" xref="S2.p1.4.m4.8.8.1.1.1.1.1.1.1.2.3.2.cmml">1</mn><mo id="S2.p1.4.m4.8.8.1.1.1.1.1.1.1.2.3.1" lspace="0.278em" rspace="0.278em" xref="S2.p1.4.m4.8.8.1.1.1.1.1.1.1.2.3.1.cmml">:</mo><mi id="S2.p1.4.m4.8.8.1.1.1.1.1.1.1.2.3.3" xref="S2.p1.4.m4.8.8.1.1.1.1.1.1.1.2.3.3.cmml">N</mi></mrow><mrow id="S2.p1.4.m4.2.2.1.3" xref="S2.p1.4.m4.8.8.1.1.1.1.1.1.1.cmml"><mo id="S2.p1.4.m4.2.2.1.3.1" stretchy="false" xref="S2.p1.4.m4.8.8.1.1.1.1.1.1.1.cmml">(</mo><mi id="S2.p1.4.m4.2.2.1.1" xref="S2.p1.4.m4.2.2.1.1.cmml">i</mi><mo id="S2.p1.4.m4.2.2.1.3.2" stretchy="false" xref="S2.p1.4.m4.8.8.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S2.p1.4.m4.8.8.1.1.1.1.2.2.4" xref="S2.p1.4.m4.8.8.1.1.1.1.2.3.cmml">,</mo><msubsup id="S2.p1.4.m4.8.8.1.1.1.1.2.2.2" xref="S2.p1.4.m4.8.8.1.1.1.1.2.2.2.cmml"><mi id="S2.p1.4.m4.8.8.1.1.1.1.2.2.2.2.2" xref="S2.p1.4.m4.8.8.1.1.1.1.2.2.2.2.2.cmml">y</mi><mrow id="S2.p1.4.m4.8.8.1.1.1.1.2.2.2.2.3" xref="S2.p1.4.m4.8.8.1.1.1.1.2.2.2.2.3.cmml"><mn id="S2.p1.4.m4.8.8.1.1.1.1.2.2.2.2.3.2" xref="S2.p1.4.m4.8.8.1.1.1.1.2.2.2.2.3.2.cmml">1</mn><mo id="S2.p1.4.m4.8.8.1.1.1.1.2.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S2.p1.4.m4.8.8.1.1.1.1.2.2.2.2.3.1.cmml">:</mo><mi id="S2.p1.4.m4.8.8.1.1.1.1.2.2.2.2.3.3" xref="S2.p1.4.m4.8.8.1.1.1.1.2.2.2.2.3.3.cmml">N</mi></mrow><mrow id="S2.p1.4.m4.3.3.1.3" xref="S2.p1.4.m4.8.8.1.1.1.1.2.2.2.cmml"><mo id="S2.p1.4.m4.3.3.1.3.1" stretchy="false" xref="S2.p1.4.m4.8.8.1.1.1.1.2.2.2.cmml">(</mo><mi id="S2.p1.4.m4.3.3.1.1" xref="S2.p1.4.m4.3.3.1.1.cmml">i</mi><mo id="S2.p1.4.m4.3.3.1.3.2" stretchy="false" xref="S2.p1.4.m4.8.8.1.1.1.1.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S2.p1.4.m4.8.8.1.1.1.1.2.2.5" stretchy="false" xref="S2.p1.4.m4.8.8.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S2.p1.4.m4.8.8.1.1.2.3" rspace="0.337em" xref="S2.p1.4.m4.8.8.1.1.3a.cmml">,</mo><mrow id="S2.p1.4.m4.8.8.1.1.2.2" xref="S2.p1.4.m4.8.8.1.1.2.2.cmml"><mi id="S2.p1.4.m4.8.8.1.1.2.2.2" xref="S2.p1.4.m4.8.8.1.1.2.2.2.cmml">i</mi><mo id="S2.p1.4.m4.8.8.1.1.2.2.1" xref="S2.p1.4.m4.8.8.1.1.2.2.1.cmml">=</mo><mrow id="S2.p1.4.m4.8.8.1.1.2.2.3.2" xref="S2.p1.4.m4.8.8.1.1.2.2.3.1.cmml"><mn id="S2.p1.4.m4.4.4" xref="S2.p1.4.m4.4.4.cmml">1</mn><mo id="S2.p1.4.m4.8.8.1.1.2.2.3.2.1" xref="S2.p1.4.m4.8.8.1.1.2.2.3.1.cmml">,</mo><mn id="S2.p1.4.m4.5.5" xref="S2.p1.4.m4.5.5.cmml">2</mn><mo id="S2.p1.4.m4.8.8.1.1.2.2.3.2.2" xref="S2.p1.4.m4.8.8.1.1.2.2.3.1.cmml">,</mo><mi id="S2.p1.4.m4.6.6" mathvariant="normal" xref="S2.p1.4.m4.6.6.cmml">…</mi><mo id="S2.p1.4.m4.8.8.1.1.2.2.3.2.3" xref="S2.p1.4.m4.8.8.1.1.2.2.3.1.cmml">,</mo><mi id="S2.p1.4.m4.7.7" mathvariant="normal" xref="S2.p1.4.m4.7.7.cmml">∞</mi></mrow></mrow></mrow><mo id="S2.p1.4.m4.8.8.1.3" stretchy="false" xref="S2.p1.4.m4.8.8.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.4.m4.8b"><set id="S2.p1.4.m4.8.8.2.cmml" xref="S2.p1.4.m4.8.8.1"><apply id="S2.p1.4.m4.8.8.1.1.3.cmml" xref="S2.p1.4.m4.8.8.1.1.2"><csymbol cd="ambiguous" id="S2.p1.4.m4.8.8.1.1.3a.cmml" xref="S2.p1.4.m4.8.8.1.1.2.3">formulae-sequence</csymbol><apply id="S2.p1.4.m4.8.8.1.1.1.1.cmml" xref="S2.p1.4.m4.8.8.1.1.1.1"><eq id="S2.p1.4.m4.8.8.1.1.1.1.3.cmml" xref="S2.p1.4.m4.8.8.1.1.1.1.3"></eq><apply id="S2.p1.4.m4.8.8.1.1.1.1.4.cmml" xref="S2.p1.4.m4.8.8.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.p1.4.m4.8.8.1.1.1.1.4.1.cmml" xref="S2.p1.4.m4.8.8.1.1.1.1.4">superscript</csymbol><ci id="S2.p1.4.m4.8.8.1.1.1.1.4.2.cmml" xref="S2.p1.4.m4.8.8.1.1.1.1.4.2">𝒟</ci><ci id="S2.p1.4.m4.1.1.1.1.cmml" xref="S2.p1.4.m4.1.1.1.1">𝑖</ci></apply><interval closure="open" id="S2.p1.4.m4.8.8.1.1.1.1.2.3.cmml" xref="S2.p1.4.m4.8.8.1.1.1.1.2.2"><apply id="S2.p1.4.m4.8.8.1.1.1.1.1.1.1.cmml" xref="S2.p1.4.m4.8.8.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p1.4.m4.8.8.1.1.1.1.1.1.1.1.cmml" xref="S2.p1.4.m4.8.8.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.p1.4.m4.8.8.1.1.1.1.1.1.1.2.cmml" xref="S2.p1.4.m4.8.8.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p1.4.m4.8.8.1.1.1.1.1.1.1.2.1.cmml" xref="S2.p1.4.m4.8.8.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.p1.4.m4.8.8.1.1.1.1.1.1.1.2.2.cmml" xref="S2.p1.4.m4.8.8.1.1.1.1.1.1.1.2.2">𝑢</ci><apply id="S2.p1.4.m4.8.8.1.1.1.1.1.1.1.2.3.cmml" xref="S2.p1.4.m4.8.8.1.1.1.1.1.1.1.2.3"><ci id="S2.p1.4.m4.8.8.1.1.1.1.1.1.1.2.3.1.cmml" xref="S2.p1.4.m4.8.8.1.1.1.1.1.1.1.2.3.1">:</ci><cn id="S2.p1.4.m4.8.8.1.1.1.1.1.1.1.2.3.2.cmml" type="integer" xref="S2.p1.4.m4.8.8.1.1.1.1.1.1.1.2.3.2">1</cn><ci id="S2.p1.4.m4.8.8.1.1.1.1.1.1.1.2.3.3.cmml" xref="S2.p1.4.m4.8.8.1.1.1.1.1.1.1.2.3.3">𝑁</ci></apply></apply><ci id="S2.p1.4.m4.2.2.1.1.cmml" xref="S2.p1.4.m4.2.2.1.1">𝑖</ci></apply><apply id="S2.p1.4.m4.8.8.1.1.1.1.2.2.2.cmml" xref="S2.p1.4.m4.8.8.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.p1.4.m4.8.8.1.1.1.1.2.2.2.1.cmml" xref="S2.p1.4.m4.8.8.1.1.1.1.2.2.2">superscript</csymbol><apply id="S2.p1.4.m4.8.8.1.1.1.1.2.2.2.2.cmml" xref="S2.p1.4.m4.8.8.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.p1.4.m4.8.8.1.1.1.1.2.2.2.2.1.cmml" xref="S2.p1.4.m4.8.8.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.p1.4.m4.8.8.1.1.1.1.2.2.2.2.2.cmml" xref="S2.p1.4.m4.8.8.1.1.1.1.2.2.2.2.2">𝑦</ci><apply id="S2.p1.4.m4.8.8.1.1.1.1.2.2.2.2.3.cmml" xref="S2.p1.4.m4.8.8.1.1.1.1.2.2.2.2.3"><ci id="S2.p1.4.m4.8.8.1.1.1.1.2.2.2.2.3.1.cmml" xref="S2.p1.4.m4.8.8.1.1.1.1.2.2.2.2.3.1">:</ci><cn id="S2.p1.4.m4.8.8.1.1.1.1.2.2.2.2.3.2.cmml" type="integer" xref="S2.p1.4.m4.8.8.1.1.1.1.2.2.2.2.3.2">1</cn><ci id="S2.p1.4.m4.8.8.1.1.1.1.2.2.2.2.3.3.cmml" xref="S2.p1.4.m4.8.8.1.1.1.1.2.2.2.2.3.3">𝑁</ci></apply></apply><ci id="S2.p1.4.m4.3.3.1.1.cmml" xref="S2.p1.4.m4.3.3.1.1">𝑖</ci></apply></interval></apply><apply id="S2.p1.4.m4.8.8.1.1.2.2.cmml" xref="S2.p1.4.m4.8.8.1.1.2.2"><eq id="S2.p1.4.m4.8.8.1.1.2.2.1.cmml" xref="S2.p1.4.m4.8.8.1.1.2.2.1"></eq><ci id="S2.p1.4.m4.8.8.1.1.2.2.2.cmml" xref="S2.p1.4.m4.8.8.1.1.2.2.2">𝑖</ci><list id="S2.p1.4.m4.8.8.1.1.2.2.3.1.cmml" xref="S2.p1.4.m4.8.8.1.1.2.2.3.2"><cn id="S2.p1.4.m4.4.4.cmml" type="integer" xref="S2.p1.4.m4.4.4">1</cn><cn id="S2.p1.4.m4.5.5.cmml" type="integer" xref="S2.p1.4.m4.5.5">2</cn><ci id="S2.p1.4.m4.6.6.cmml" xref="S2.p1.4.m4.6.6">…</ci><infinity id="S2.p1.4.m4.7.7.cmml" xref="S2.p1.4.m4.7.7"></infinity></list></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.4.m4.8c">\{\mathcal{D}^{(i)}=(u_{1:N}^{(i)},y_{1:N}^{(i)}),\,i=1,2,\dots,\infty\}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.4.m4.8d">{ caligraphic_D start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT = ( italic_u start_POSTSUBSCRIPT 1 : italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_y start_POSTSUBSCRIPT 1 : italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) , italic_i = 1 , 2 , … , ∞ }</annotation></semantics></math>
with <math alttext="u_{k}^{(i)}\in\mathbb{R}^{n_{u}}" class="ltx_Math" display="inline" id="S2.p1.5.m5.1"><semantics id="S2.p1.5.m5.1a"><mrow id="S2.p1.5.m5.1.2" xref="S2.p1.5.m5.1.2.cmml"><msubsup id="S2.p1.5.m5.1.2.2" xref="S2.p1.5.m5.1.2.2.cmml"><mi id="S2.p1.5.m5.1.2.2.2.2" xref="S2.p1.5.m5.1.2.2.2.2.cmml">u</mi><mi id="S2.p1.5.m5.1.2.2.2.3" xref="S2.p1.5.m5.1.2.2.2.3.cmml">k</mi><mrow id="S2.p1.5.m5.1.1.1.3" xref="S2.p1.5.m5.1.2.2.cmml"><mo id="S2.p1.5.m5.1.1.1.3.1" stretchy="false" xref="S2.p1.5.m5.1.2.2.cmml">(</mo><mi id="S2.p1.5.m5.1.1.1.1" xref="S2.p1.5.m5.1.1.1.1.cmml">i</mi><mo id="S2.p1.5.m5.1.1.1.3.2" stretchy="false" xref="S2.p1.5.m5.1.2.2.cmml">)</mo></mrow></msubsup><mo id="S2.p1.5.m5.1.2.1" xref="S2.p1.5.m5.1.2.1.cmml">∈</mo><msup id="S2.p1.5.m5.1.2.3" xref="S2.p1.5.m5.1.2.3.cmml"><mi id="S2.p1.5.m5.1.2.3.2" xref="S2.p1.5.m5.1.2.3.2.cmml">ℝ</mi><msub id="S2.p1.5.m5.1.2.3.3" xref="S2.p1.5.m5.1.2.3.3.cmml"><mi id="S2.p1.5.m5.1.2.3.3.2" xref="S2.p1.5.m5.1.2.3.3.2.cmml">n</mi><mi id="S2.p1.5.m5.1.2.3.3.3" xref="S2.p1.5.m5.1.2.3.3.3.cmml">u</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.5.m5.1b"><apply id="S2.p1.5.m5.1.2.cmml" xref="S2.p1.5.m5.1.2"><in id="S2.p1.5.m5.1.2.1.cmml" xref="S2.p1.5.m5.1.2.1"></in><apply id="S2.p1.5.m5.1.2.2.cmml" xref="S2.p1.5.m5.1.2.2"><csymbol cd="ambiguous" id="S2.p1.5.m5.1.2.2.1.cmml" xref="S2.p1.5.m5.1.2.2">superscript</csymbol><apply id="S2.p1.5.m5.1.2.2.2.cmml" xref="S2.p1.5.m5.1.2.2"><csymbol cd="ambiguous" id="S2.p1.5.m5.1.2.2.2.1.cmml" xref="S2.p1.5.m5.1.2.2">subscript</csymbol><ci id="S2.p1.5.m5.1.2.2.2.2.cmml" xref="S2.p1.5.m5.1.2.2.2.2">𝑢</ci><ci id="S2.p1.5.m5.1.2.2.2.3.cmml" xref="S2.p1.5.m5.1.2.2.2.3">𝑘</ci></apply><ci id="S2.p1.5.m5.1.1.1.1.cmml" xref="S2.p1.5.m5.1.1.1.1">𝑖</ci></apply><apply id="S2.p1.5.m5.1.2.3.cmml" xref="S2.p1.5.m5.1.2.3"><csymbol cd="ambiguous" id="S2.p1.5.m5.1.2.3.1.cmml" xref="S2.p1.5.m5.1.2.3">superscript</csymbol><ci id="S2.p1.5.m5.1.2.3.2.cmml" xref="S2.p1.5.m5.1.2.3.2">ℝ</ci><apply id="S2.p1.5.m5.1.2.3.3.cmml" xref="S2.p1.5.m5.1.2.3.3"><csymbol cd="ambiguous" id="S2.p1.5.m5.1.2.3.3.1.cmml" xref="S2.p1.5.m5.1.2.3.3">subscript</csymbol><ci id="S2.p1.5.m5.1.2.3.3.2.cmml" xref="S2.p1.5.m5.1.2.3.3.2">𝑛</ci><ci id="S2.p1.5.m5.1.2.3.3.3.cmml" xref="S2.p1.5.m5.1.2.3.3.3">𝑢</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.5.m5.1c">u_{k}^{(i)}\in\mathbb{R}^{n_{u}}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.5.m5.1d">italic_u start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_n start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="y_{k}^{(i)}\in\mathbb{R}^{n_{y}}" class="ltx_Math" display="inline" id="S2.p1.6.m6.1"><semantics id="S2.p1.6.m6.1a"><mrow id="S2.p1.6.m6.1.2" xref="S2.p1.6.m6.1.2.cmml"><msubsup id="S2.p1.6.m6.1.2.2" xref="S2.p1.6.m6.1.2.2.cmml"><mi id="S2.p1.6.m6.1.2.2.2.2" xref="S2.p1.6.m6.1.2.2.2.2.cmml">y</mi><mi id="S2.p1.6.m6.1.2.2.2.3" xref="S2.p1.6.m6.1.2.2.2.3.cmml">k</mi><mrow id="S2.p1.6.m6.1.1.1.3" xref="S2.p1.6.m6.1.2.2.cmml"><mo id="S2.p1.6.m6.1.1.1.3.1" stretchy="false" xref="S2.p1.6.m6.1.2.2.cmml">(</mo><mi id="S2.p1.6.m6.1.1.1.1" xref="S2.p1.6.m6.1.1.1.1.cmml">i</mi><mo id="S2.p1.6.m6.1.1.1.3.2" stretchy="false" xref="S2.p1.6.m6.1.2.2.cmml">)</mo></mrow></msubsup><mo id="S2.p1.6.m6.1.2.1" xref="S2.p1.6.m6.1.2.1.cmml">∈</mo><msup id="S2.p1.6.m6.1.2.3" xref="S2.p1.6.m6.1.2.3.cmml"><mi id="S2.p1.6.m6.1.2.3.2" xref="S2.p1.6.m6.1.2.3.2.cmml">ℝ</mi><msub id="S2.p1.6.m6.1.2.3.3" xref="S2.p1.6.m6.1.2.3.3.cmml"><mi id="S2.p1.6.m6.1.2.3.3.2" xref="S2.p1.6.m6.1.2.3.3.2.cmml">n</mi><mi id="S2.p1.6.m6.1.2.3.3.3" xref="S2.p1.6.m6.1.2.3.3.3.cmml">y</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.6.m6.1b"><apply id="S2.p1.6.m6.1.2.cmml" xref="S2.p1.6.m6.1.2"><in id="S2.p1.6.m6.1.2.1.cmml" xref="S2.p1.6.m6.1.2.1"></in><apply id="S2.p1.6.m6.1.2.2.cmml" xref="S2.p1.6.m6.1.2.2"><csymbol cd="ambiguous" id="S2.p1.6.m6.1.2.2.1.cmml" xref="S2.p1.6.m6.1.2.2">superscript</csymbol><apply id="S2.p1.6.m6.1.2.2.2.cmml" xref="S2.p1.6.m6.1.2.2"><csymbol cd="ambiguous" id="S2.p1.6.m6.1.2.2.2.1.cmml" xref="S2.p1.6.m6.1.2.2">subscript</csymbol><ci id="S2.p1.6.m6.1.2.2.2.2.cmml" xref="S2.p1.6.m6.1.2.2.2.2">𝑦</ci><ci id="S2.p1.6.m6.1.2.2.2.3.cmml" xref="S2.p1.6.m6.1.2.2.2.3">𝑘</ci></apply><ci id="S2.p1.6.m6.1.1.1.1.cmml" xref="S2.p1.6.m6.1.1.1.1">𝑖</ci></apply><apply id="S2.p1.6.m6.1.2.3.cmml" xref="S2.p1.6.m6.1.2.3"><csymbol cd="ambiguous" id="S2.p1.6.m6.1.2.3.1.cmml" xref="S2.p1.6.m6.1.2.3">superscript</csymbol><ci id="S2.p1.6.m6.1.2.3.2.cmml" xref="S2.p1.6.m6.1.2.3.2">ℝ</ci><apply id="S2.p1.6.m6.1.2.3.3.cmml" xref="S2.p1.6.m6.1.2.3.3"><csymbol cd="ambiguous" id="S2.p1.6.m6.1.2.3.3.1.cmml" xref="S2.p1.6.m6.1.2.3.3">subscript</csymbol><ci id="S2.p1.6.m6.1.2.3.3.2.cmml" xref="S2.p1.6.m6.1.2.3.3.2">𝑛</ci><ci id="S2.p1.6.m6.1.2.3.3.3.cmml" xref="S2.p1.6.m6.1.2.3.3.3">𝑦</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.6.m6.1c">y_{k}^{(i)}\in\mathbb{R}^{n_{y}}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.6.m6.1d">italic_y start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_n start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, each sampled from the dataset distribution <math alttext="p(\mathcal{D})" class="ltx_Math" display="inline" id="S2.p1.7.m7.1"><semantics id="S2.p1.7.m7.1a"><mrow id="S2.p1.7.m7.1.2" xref="S2.p1.7.m7.1.2.cmml"><mi id="S2.p1.7.m7.1.2.2" xref="S2.p1.7.m7.1.2.2.cmml">p</mi><mo id="S2.p1.7.m7.1.2.1" xref="S2.p1.7.m7.1.2.1.cmml">⁢</mo><mrow id="S2.p1.7.m7.1.2.3.2" xref="S2.p1.7.m7.1.2.cmml"><mo id="S2.p1.7.m7.1.2.3.2.1" stretchy="false" xref="S2.p1.7.m7.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S2.p1.7.m7.1.1" xref="S2.p1.7.m7.1.1.cmml">𝒟</mi><mo id="S2.p1.7.m7.1.2.3.2.2" stretchy="false" xref="S2.p1.7.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.7.m7.1b"><apply id="S2.p1.7.m7.1.2.cmml" xref="S2.p1.7.m7.1.2"><times id="S2.p1.7.m7.1.2.1.cmml" xref="S2.p1.7.m7.1.2.1"></times><ci id="S2.p1.7.m7.1.2.2.cmml" xref="S2.p1.7.m7.1.2.2">𝑝</ci><ci id="S2.p1.7.m7.1.1.cmml" xref="S2.p1.7.m7.1.1">𝒟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.7.m7.1c">p(\mathcal{D})</annotation><annotation encoding="application/x-llamapun" id="S2.p1.7.m7.1d">italic_p ( caligraphic_D )</annotation></semantics></math> induced by randomly sampling systems and inputs. The datasets <math alttext="\mathcal{D}^{(i)}" class="ltx_Math" display="inline" id="S2.p1.8.m8.1"><semantics id="S2.p1.8.m8.1a"><msup id="S2.p1.8.m8.1.2" xref="S2.p1.8.m8.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.8.m8.1.2.2" xref="S2.p1.8.m8.1.2.2.cmml">𝒟</mi><mrow id="S2.p1.8.m8.1.1.1.3" xref="S2.p1.8.m8.1.2.cmml"><mo id="S2.p1.8.m8.1.1.1.3.1" stretchy="false" xref="S2.p1.8.m8.1.2.cmml">(</mo><mi id="S2.p1.8.m8.1.1.1.1" xref="S2.p1.8.m8.1.1.1.1.cmml">i</mi><mo id="S2.p1.8.m8.1.1.1.3.2" stretchy="false" xref="S2.p1.8.m8.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.p1.8.m8.1b"><apply id="S2.p1.8.m8.1.2.cmml" xref="S2.p1.8.m8.1.2"><csymbol cd="ambiguous" id="S2.p1.8.m8.1.2.1.cmml" xref="S2.p1.8.m8.1.2">superscript</csymbol><ci id="S2.p1.8.m8.1.2.2.cmml" xref="S2.p1.8.m8.1.2.2">𝒟</ci><ci id="S2.p1.8.m8.1.1.1.1.cmml" xref="S2.p1.8.m8.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.8.m8.1c">\mathcal{D}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.8.m8.1d">caligraphic_D start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> are all different, but they are drawn from the same probability distribution, so it is possible to transfer the learned knowledge from one realization to another.</p>
</div>
<div class="ltx_para" id="S2.p2">
<p class="ltx_p" id="S2.p2.7">Each dataset realization <math alttext="\mathcal{D}^{(i)}" class="ltx_Math" display="inline" id="S2.p2.1.m1.1"><semantics id="S2.p2.1.m1.1a"><msup id="S2.p2.1.m1.1.2" xref="S2.p2.1.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p2.1.m1.1.2.2" xref="S2.p2.1.m1.1.2.2.cmml">𝒟</mi><mrow id="S2.p2.1.m1.1.1.1.3" xref="S2.p2.1.m1.1.2.cmml"><mo id="S2.p2.1.m1.1.1.1.3.1" stretchy="false" xref="S2.p2.1.m1.1.2.cmml">(</mo><mi id="S2.p2.1.m1.1.1.1.1" xref="S2.p2.1.m1.1.1.1.1.cmml">i</mi><mo id="S2.p2.1.m1.1.1.1.3.2" stretchy="false" xref="S2.p2.1.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.1b"><apply id="S2.p2.1.m1.1.2.cmml" xref="S2.p2.1.m1.1.2"><csymbol cd="ambiguous" id="S2.p2.1.m1.1.2.1.cmml" xref="S2.p2.1.m1.1.2">superscript</csymbol><ci id="S2.p2.1.m1.1.2.2.cmml" xref="S2.p2.1.m1.1.2.2">𝒟</ci><ci id="S2.p2.1.m1.1.1.1.1.cmml" xref="S2.p2.1.m1.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.1c">\mathcal{D}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.1.m1.1d">caligraphic_D start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> is split into an initial <em class="ltx_emph ltx_font_italic" id="S2.p2.7.1">context</em> segment of length <math alttext="m" class="ltx_Math" display="inline" id="S2.p2.2.m2.1"><semantics id="S2.p2.2.m2.1a"><mi id="S2.p2.2.m2.1.1" xref="S2.p2.2.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S2.p2.2.m2.1b"><ci id="S2.p2.2.m2.1.1.cmml" xref="S2.p2.2.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.2.m2.1c">m</annotation><annotation encoding="application/x-llamapun" id="S2.p2.2.m2.1d">italic_m</annotation></semantics></math> and a contiguous <em class="ltx_emph ltx_font_italic" id="S2.p2.7.2">query</em> segment of length <math alttext="N-m" class="ltx_Math" display="inline" id="S2.p2.3.m3.1"><semantics id="S2.p2.3.m3.1a"><mrow id="S2.p2.3.m3.1.1" xref="S2.p2.3.m3.1.1.cmml"><mi id="S2.p2.3.m3.1.1.2" xref="S2.p2.3.m3.1.1.2.cmml">N</mi><mo id="S2.p2.3.m3.1.1.1" xref="S2.p2.3.m3.1.1.1.cmml">−</mo><mi id="S2.p2.3.m3.1.1.3" xref="S2.p2.3.m3.1.1.3.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.3.m3.1b"><apply id="S2.p2.3.m3.1.1.cmml" xref="S2.p2.3.m3.1.1"><minus id="S2.p2.3.m3.1.1.1.cmml" xref="S2.p2.3.m3.1.1.1"></minus><ci id="S2.p2.3.m3.1.1.2.cmml" xref="S2.p2.3.m3.1.1.2">𝑁</ci><ci id="S2.p2.3.m3.1.1.3.cmml" xref="S2.p2.3.m3.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.3.m3.1c">N-m</annotation><annotation encoding="application/x-llamapun" id="S2.p2.3.m3.1d">italic_N - italic_m</annotation></semantics></math>.
The meta-model <math alttext="\mathcal{M}_{\phi}" class="ltx_Math" display="inline" id="S2.p2.4.m4.1"><semantics id="S2.p2.4.m4.1a"><msub id="S2.p2.4.m4.1.1" xref="S2.p2.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p2.4.m4.1.1.2" xref="S2.p2.4.m4.1.1.2.cmml">ℳ</mi><mi id="S2.p2.4.m4.1.1.3" xref="S2.p2.4.m4.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.4.m4.1b"><apply id="S2.p2.4.m4.1.1.cmml" xref="S2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S2.p2.4.m4.1.1.1.cmml" xref="S2.p2.4.m4.1.1">subscript</csymbol><ci id="S2.p2.4.m4.1.1.2.cmml" xref="S2.p2.4.m4.1.1.2">ℳ</ci><ci id="S2.p2.4.m4.1.1.3.cmml" xref="S2.p2.4.m4.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.4.m4.1c">\mathcal{M}_{\phi}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.4.m4.1d">caligraphic_M start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math> is trained to reconstruct the query output <math alttext="y_{m+1:N}^{(i)}" class="ltx_Math" display="inline" id="S2.p2.5.m5.1"><semantics id="S2.p2.5.m5.1a"><msubsup id="S2.p2.5.m5.1.2" xref="S2.p2.5.m5.1.2.cmml"><mi id="S2.p2.5.m5.1.2.2.2" xref="S2.p2.5.m5.1.2.2.2.cmml">y</mi><mrow id="S2.p2.5.m5.1.2.2.3" xref="S2.p2.5.m5.1.2.2.3.cmml"><mrow id="S2.p2.5.m5.1.2.2.3.2" xref="S2.p2.5.m5.1.2.2.3.2.cmml"><mi id="S2.p2.5.m5.1.2.2.3.2.2" xref="S2.p2.5.m5.1.2.2.3.2.2.cmml">m</mi><mo id="S2.p2.5.m5.1.2.2.3.2.1" xref="S2.p2.5.m5.1.2.2.3.2.1.cmml">+</mo><mn id="S2.p2.5.m5.1.2.2.3.2.3" xref="S2.p2.5.m5.1.2.2.3.2.3.cmml">1</mn></mrow><mo id="S2.p2.5.m5.1.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S2.p2.5.m5.1.2.2.3.1.cmml">:</mo><mi id="S2.p2.5.m5.1.2.2.3.3" xref="S2.p2.5.m5.1.2.2.3.3.cmml">N</mi></mrow><mrow id="S2.p2.5.m5.1.1.1.3" xref="S2.p2.5.m5.1.2.cmml"><mo id="S2.p2.5.m5.1.1.1.3.1" stretchy="false" xref="S2.p2.5.m5.1.2.cmml">(</mo><mi id="S2.p2.5.m5.1.1.1.1" xref="S2.p2.5.m5.1.1.1.1.cmml">i</mi><mo id="S2.p2.5.m5.1.1.1.3.2" stretchy="false" xref="S2.p2.5.m5.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.p2.5.m5.1b"><apply id="S2.p2.5.m5.1.2.cmml" xref="S2.p2.5.m5.1.2"><csymbol cd="ambiguous" id="S2.p2.5.m5.1.2.1.cmml" xref="S2.p2.5.m5.1.2">superscript</csymbol><apply id="S2.p2.5.m5.1.2.2.cmml" xref="S2.p2.5.m5.1.2"><csymbol cd="ambiguous" id="S2.p2.5.m5.1.2.2.1.cmml" xref="S2.p2.5.m5.1.2">subscript</csymbol><ci id="S2.p2.5.m5.1.2.2.2.cmml" xref="S2.p2.5.m5.1.2.2.2">𝑦</ci><apply id="S2.p2.5.m5.1.2.2.3.cmml" xref="S2.p2.5.m5.1.2.2.3"><ci id="S2.p2.5.m5.1.2.2.3.1.cmml" xref="S2.p2.5.m5.1.2.2.3.1">:</ci><apply id="S2.p2.5.m5.1.2.2.3.2.cmml" xref="S2.p2.5.m5.1.2.2.3.2"><plus id="S2.p2.5.m5.1.2.2.3.2.1.cmml" xref="S2.p2.5.m5.1.2.2.3.2.1"></plus><ci id="S2.p2.5.m5.1.2.2.3.2.2.cmml" xref="S2.p2.5.m5.1.2.2.3.2.2">𝑚</ci><cn id="S2.p2.5.m5.1.2.2.3.2.3.cmml" type="integer" xref="S2.p2.5.m5.1.2.2.3.2.3">1</cn></apply><ci id="S2.p2.5.m5.1.2.2.3.3.cmml" xref="S2.p2.5.m5.1.2.2.3.3">𝑁</ci></apply></apply><ci id="S2.p2.5.m5.1.1.1.1.cmml" xref="S2.p2.5.m5.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.5.m5.1c">y_{m+1:N}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.5.m5.1d">italic_y start_POSTSUBSCRIPT italic_m + 1 : italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> from the query input <math alttext="u_{m+1:N}^{(i)}" class="ltx_Math" display="inline" id="S2.p2.6.m6.1"><semantics id="S2.p2.6.m6.1a"><msubsup id="S2.p2.6.m6.1.2" xref="S2.p2.6.m6.1.2.cmml"><mi id="S2.p2.6.m6.1.2.2.2" xref="S2.p2.6.m6.1.2.2.2.cmml">u</mi><mrow id="S2.p2.6.m6.1.2.2.3" xref="S2.p2.6.m6.1.2.2.3.cmml"><mrow id="S2.p2.6.m6.1.2.2.3.2" xref="S2.p2.6.m6.1.2.2.3.2.cmml"><mi id="S2.p2.6.m6.1.2.2.3.2.2" xref="S2.p2.6.m6.1.2.2.3.2.2.cmml">m</mi><mo id="S2.p2.6.m6.1.2.2.3.2.1" xref="S2.p2.6.m6.1.2.2.3.2.1.cmml">+</mo><mn id="S2.p2.6.m6.1.2.2.3.2.3" xref="S2.p2.6.m6.1.2.2.3.2.3.cmml">1</mn></mrow><mo id="S2.p2.6.m6.1.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S2.p2.6.m6.1.2.2.3.1.cmml">:</mo><mi id="S2.p2.6.m6.1.2.2.3.3" xref="S2.p2.6.m6.1.2.2.3.3.cmml">N</mi></mrow><mrow id="S2.p2.6.m6.1.1.1.3" xref="S2.p2.6.m6.1.2.cmml"><mo id="S2.p2.6.m6.1.1.1.3.1" stretchy="false" xref="S2.p2.6.m6.1.2.cmml">(</mo><mi id="S2.p2.6.m6.1.1.1.1" xref="S2.p2.6.m6.1.1.1.1.cmml">i</mi><mo id="S2.p2.6.m6.1.1.1.3.2" stretchy="false" xref="S2.p2.6.m6.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.p2.6.m6.1b"><apply id="S2.p2.6.m6.1.2.cmml" xref="S2.p2.6.m6.1.2"><csymbol cd="ambiguous" id="S2.p2.6.m6.1.2.1.cmml" xref="S2.p2.6.m6.1.2">superscript</csymbol><apply id="S2.p2.6.m6.1.2.2.cmml" xref="S2.p2.6.m6.1.2"><csymbol cd="ambiguous" id="S2.p2.6.m6.1.2.2.1.cmml" xref="S2.p2.6.m6.1.2">subscript</csymbol><ci id="S2.p2.6.m6.1.2.2.2.cmml" xref="S2.p2.6.m6.1.2.2.2">𝑢</ci><apply id="S2.p2.6.m6.1.2.2.3.cmml" xref="S2.p2.6.m6.1.2.2.3"><ci id="S2.p2.6.m6.1.2.2.3.1.cmml" xref="S2.p2.6.m6.1.2.2.3.1">:</ci><apply id="S2.p2.6.m6.1.2.2.3.2.cmml" xref="S2.p2.6.m6.1.2.2.3.2"><plus id="S2.p2.6.m6.1.2.2.3.2.1.cmml" xref="S2.p2.6.m6.1.2.2.3.2.1"></plus><ci id="S2.p2.6.m6.1.2.2.3.2.2.cmml" xref="S2.p2.6.m6.1.2.2.3.2.2">𝑚</ci><cn id="S2.p2.6.m6.1.2.2.3.2.3.cmml" type="integer" xref="S2.p2.6.m6.1.2.2.3.2.3">1</cn></apply><ci id="S2.p2.6.m6.1.2.2.3.3.cmml" xref="S2.p2.6.m6.1.2.2.3.3">𝑁</ci></apply></apply><ci id="S2.p2.6.m6.1.1.1.1.cmml" xref="S2.p2.6.m6.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.6.m6.1c">u_{m+1:N}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.6.m6.1d">italic_u start_POSTSUBSCRIPT italic_m + 1 : italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> and the input/output context <math alttext="(u_{1:m}^{(i)},y_{1:m}^{(i)})" class="ltx_Math" display="inline" id="S2.p2.7.m7.4"><semantics id="S2.p2.7.m7.4a"><mrow id="S2.p2.7.m7.4.4.2" xref="S2.p2.7.m7.4.4.3.cmml"><mo id="S2.p2.7.m7.4.4.2.3" stretchy="false" xref="S2.p2.7.m7.4.4.3.cmml">(</mo><msubsup id="S2.p2.7.m7.3.3.1.1" xref="S2.p2.7.m7.3.3.1.1.cmml"><mi id="S2.p2.7.m7.3.3.1.1.2.2" xref="S2.p2.7.m7.3.3.1.1.2.2.cmml">u</mi><mrow id="S2.p2.7.m7.3.3.1.1.2.3" xref="S2.p2.7.m7.3.3.1.1.2.3.cmml"><mn id="S2.p2.7.m7.3.3.1.1.2.3.2" xref="S2.p2.7.m7.3.3.1.1.2.3.2.cmml">1</mn><mo id="S2.p2.7.m7.3.3.1.1.2.3.1" lspace="0.278em" rspace="0.278em" xref="S2.p2.7.m7.3.3.1.1.2.3.1.cmml">:</mo><mi id="S2.p2.7.m7.3.3.1.1.2.3.3" xref="S2.p2.7.m7.3.3.1.1.2.3.3.cmml">m</mi></mrow><mrow id="S2.p2.7.m7.1.1.1.3" xref="S2.p2.7.m7.3.3.1.1.cmml"><mo id="S2.p2.7.m7.1.1.1.3.1" stretchy="false" xref="S2.p2.7.m7.3.3.1.1.cmml">(</mo><mi id="S2.p2.7.m7.1.1.1.1" xref="S2.p2.7.m7.1.1.1.1.cmml">i</mi><mo id="S2.p2.7.m7.1.1.1.3.2" stretchy="false" xref="S2.p2.7.m7.3.3.1.1.cmml">)</mo></mrow></msubsup><mo id="S2.p2.7.m7.4.4.2.4" xref="S2.p2.7.m7.4.4.3.cmml">,</mo><msubsup id="S2.p2.7.m7.4.4.2.2" xref="S2.p2.7.m7.4.4.2.2.cmml"><mi id="S2.p2.7.m7.4.4.2.2.2.2" xref="S2.p2.7.m7.4.4.2.2.2.2.cmml">y</mi><mrow id="S2.p2.7.m7.4.4.2.2.2.3" xref="S2.p2.7.m7.4.4.2.2.2.3.cmml"><mn id="S2.p2.7.m7.4.4.2.2.2.3.2" xref="S2.p2.7.m7.4.4.2.2.2.3.2.cmml">1</mn><mo id="S2.p2.7.m7.4.4.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S2.p2.7.m7.4.4.2.2.2.3.1.cmml">:</mo><mi id="S2.p2.7.m7.4.4.2.2.2.3.3" xref="S2.p2.7.m7.4.4.2.2.2.3.3.cmml">m</mi></mrow><mrow id="S2.p2.7.m7.2.2.1.3" xref="S2.p2.7.m7.4.4.2.2.cmml"><mo id="S2.p2.7.m7.2.2.1.3.1" stretchy="false" xref="S2.p2.7.m7.4.4.2.2.cmml">(</mo><mi id="S2.p2.7.m7.2.2.1.1" xref="S2.p2.7.m7.2.2.1.1.cmml">i</mi><mo id="S2.p2.7.m7.2.2.1.3.2" stretchy="false" xref="S2.p2.7.m7.4.4.2.2.cmml">)</mo></mrow></msubsup><mo id="S2.p2.7.m7.4.4.2.5" stretchy="false" xref="S2.p2.7.m7.4.4.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.7.m7.4b"><interval closure="open" id="S2.p2.7.m7.4.4.3.cmml" xref="S2.p2.7.m7.4.4.2"><apply id="S2.p2.7.m7.3.3.1.1.cmml" xref="S2.p2.7.m7.3.3.1.1"><csymbol cd="ambiguous" id="S2.p2.7.m7.3.3.1.1.1.cmml" xref="S2.p2.7.m7.3.3.1.1">superscript</csymbol><apply id="S2.p2.7.m7.3.3.1.1.2.cmml" xref="S2.p2.7.m7.3.3.1.1"><csymbol cd="ambiguous" id="S2.p2.7.m7.3.3.1.1.2.1.cmml" xref="S2.p2.7.m7.3.3.1.1">subscript</csymbol><ci id="S2.p2.7.m7.3.3.1.1.2.2.cmml" xref="S2.p2.7.m7.3.3.1.1.2.2">𝑢</ci><apply id="S2.p2.7.m7.3.3.1.1.2.3.cmml" xref="S2.p2.7.m7.3.3.1.1.2.3"><ci id="S2.p2.7.m7.3.3.1.1.2.3.1.cmml" xref="S2.p2.7.m7.3.3.1.1.2.3.1">:</ci><cn id="S2.p2.7.m7.3.3.1.1.2.3.2.cmml" type="integer" xref="S2.p2.7.m7.3.3.1.1.2.3.2">1</cn><ci id="S2.p2.7.m7.3.3.1.1.2.3.3.cmml" xref="S2.p2.7.m7.3.3.1.1.2.3.3">𝑚</ci></apply></apply><ci id="S2.p2.7.m7.1.1.1.1.cmml" xref="S2.p2.7.m7.1.1.1.1">𝑖</ci></apply><apply id="S2.p2.7.m7.4.4.2.2.cmml" xref="S2.p2.7.m7.4.4.2.2"><csymbol cd="ambiguous" id="S2.p2.7.m7.4.4.2.2.1.cmml" xref="S2.p2.7.m7.4.4.2.2">superscript</csymbol><apply id="S2.p2.7.m7.4.4.2.2.2.cmml" xref="S2.p2.7.m7.4.4.2.2"><csymbol cd="ambiguous" id="S2.p2.7.m7.4.4.2.2.2.1.cmml" xref="S2.p2.7.m7.4.4.2.2">subscript</csymbol><ci id="S2.p2.7.m7.4.4.2.2.2.2.cmml" xref="S2.p2.7.m7.4.4.2.2.2.2">𝑦</ci><apply id="S2.p2.7.m7.4.4.2.2.2.3.cmml" xref="S2.p2.7.m7.4.4.2.2.2.3"><ci id="S2.p2.7.m7.4.4.2.2.2.3.1.cmml" xref="S2.p2.7.m7.4.4.2.2.2.3.1">:</ci><cn id="S2.p2.7.m7.4.4.2.2.2.3.2.cmml" type="integer" xref="S2.p2.7.m7.4.4.2.2.2.3.2">1</cn><ci id="S2.p2.7.m7.4.4.2.2.2.3.3.cmml" xref="S2.p2.7.m7.4.4.2.2.2.3.3">𝑚</ci></apply></apply><ci id="S2.p2.7.m7.2.2.1.1.cmml" xref="S2.p2.7.m7.2.2.1.1">𝑖</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.7.m7.4c">(u_{1:m}^{(i)},y_{1:m}^{(i)})</annotation><annotation encoding="application/x-llamapun" id="S2.p2.7.m7.4d">( italic_u start_POSTSUBSCRIPT 1 : italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_y start_POSTSUBSCRIPT 1 : italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT )</annotation></semantics></math>, namely:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{y}_{m+1:N}^{(i)}=\mathcal{M}_{\phi}(u_{m+1:N}^{(i)},u_{1:m}^{(i)},y_{1:m}%
^{(i)})," class="ltx_Math" display="block" id="S2.E1.m1.5"><semantics id="S2.E1.m1.5a"><mrow id="S2.E1.m1.5.5.1" xref="S2.E1.m1.5.5.1.1.cmml"><mrow id="S2.E1.m1.5.5.1.1" xref="S2.E1.m1.5.5.1.1.cmml"><msubsup id="S2.E1.m1.5.5.1.1.5" xref="S2.E1.m1.5.5.1.1.5.cmml"><mover accent="true" id="S2.E1.m1.5.5.1.1.5.2.2" xref="S2.E1.m1.5.5.1.1.5.2.2.cmml"><mi id="S2.E1.m1.5.5.1.1.5.2.2.2" xref="S2.E1.m1.5.5.1.1.5.2.2.2.cmml">y</mi><mo id="S2.E1.m1.5.5.1.1.5.2.2.1" xref="S2.E1.m1.5.5.1.1.5.2.2.1.cmml">^</mo></mover><mrow id="S2.E1.m1.5.5.1.1.5.2.3" xref="S2.E1.m1.5.5.1.1.5.2.3.cmml"><mrow id="S2.E1.m1.5.5.1.1.5.2.3.2" xref="S2.E1.m1.5.5.1.1.5.2.3.2.cmml"><mi id="S2.E1.m1.5.5.1.1.5.2.3.2.2" xref="S2.E1.m1.5.5.1.1.5.2.3.2.2.cmml">m</mi><mo id="S2.E1.m1.5.5.1.1.5.2.3.2.1" xref="S2.E1.m1.5.5.1.1.5.2.3.2.1.cmml">+</mo><mn id="S2.E1.m1.5.5.1.1.5.2.3.2.3" xref="S2.E1.m1.5.5.1.1.5.2.3.2.3.cmml">1</mn></mrow><mo id="S2.E1.m1.5.5.1.1.5.2.3.1" lspace="0.278em" rspace="0.278em" xref="S2.E1.m1.5.5.1.1.5.2.3.1.cmml">:</mo><mi id="S2.E1.m1.5.5.1.1.5.2.3.3" xref="S2.E1.m1.5.5.1.1.5.2.3.3.cmml">N</mi></mrow><mrow id="S2.E1.m1.1.1.1.3" xref="S2.E1.m1.5.5.1.1.5.cmml"><mo id="S2.E1.m1.1.1.1.3.1" stretchy="false" xref="S2.E1.m1.5.5.1.1.5.cmml">(</mo><mi id="S2.E1.m1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml">i</mi><mo id="S2.E1.m1.1.1.1.3.2" stretchy="false" xref="S2.E1.m1.5.5.1.1.5.cmml">)</mo></mrow></msubsup><mo id="S2.E1.m1.5.5.1.1.4" xref="S2.E1.m1.5.5.1.1.4.cmml">=</mo><mrow id="S2.E1.m1.5.5.1.1.3" xref="S2.E1.m1.5.5.1.1.3.cmml"><msub id="S2.E1.m1.5.5.1.1.3.5" xref="S2.E1.m1.5.5.1.1.3.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.5.5.1.1.3.5.2" xref="S2.E1.m1.5.5.1.1.3.5.2.cmml">ℳ</mi><mi id="S2.E1.m1.5.5.1.1.3.5.3" xref="S2.E1.m1.5.5.1.1.3.5.3.cmml">ϕ</mi></msub><mo id="S2.E1.m1.5.5.1.1.3.4" xref="S2.E1.m1.5.5.1.1.3.4.cmml">⁢</mo><mrow id="S2.E1.m1.5.5.1.1.3.3.3" xref="S2.E1.m1.5.5.1.1.3.3.4.cmml"><mo id="S2.E1.m1.5.5.1.1.3.3.3.4" stretchy="false" xref="S2.E1.m1.5.5.1.1.3.3.4.cmml">(</mo><msubsup id="S2.E1.m1.5.5.1.1.1.1.1.1" xref="S2.E1.m1.5.5.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.5.5.1.1.1.1.1.1.2.2" xref="S2.E1.m1.5.5.1.1.1.1.1.1.2.2.cmml">u</mi><mrow id="S2.E1.m1.5.5.1.1.1.1.1.1.2.3" xref="S2.E1.m1.5.5.1.1.1.1.1.1.2.3.cmml"><mrow id="S2.E1.m1.5.5.1.1.1.1.1.1.2.3.2" xref="S2.E1.m1.5.5.1.1.1.1.1.1.2.3.2.cmml"><mi id="S2.E1.m1.5.5.1.1.1.1.1.1.2.3.2.2" xref="S2.E1.m1.5.5.1.1.1.1.1.1.2.3.2.2.cmml">m</mi><mo id="S2.E1.m1.5.5.1.1.1.1.1.1.2.3.2.1" xref="S2.E1.m1.5.5.1.1.1.1.1.1.2.3.2.1.cmml">+</mo><mn id="S2.E1.m1.5.5.1.1.1.1.1.1.2.3.2.3" xref="S2.E1.m1.5.5.1.1.1.1.1.1.2.3.2.3.cmml">1</mn></mrow><mo id="S2.E1.m1.5.5.1.1.1.1.1.1.2.3.1" lspace="0.278em" rspace="0.278em" xref="S2.E1.m1.5.5.1.1.1.1.1.1.2.3.1.cmml">:</mo><mi id="S2.E1.m1.5.5.1.1.1.1.1.1.2.3.3" xref="S2.E1.m1.5.5.1.1.1.1.1.1.2.3.3.cmml">N</mi></mrow><mrow id="S2.E1.m1.2.2.1.3" xref="S2.E1.m1.5.5.1.1.1.1.1.1.cmml"><mo id="S2.E1.m1.2.2.1.3.1" stretchy="false" xref="S2.E1.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mi id="S2.E1.m1.2.2.1.1" xref="S2.E1.m1.2.2.1.1.cmml">i</mi><mo id="S2.E1.m1.2.2.1.3.2" stretchy="false" xref="S2.E1.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S2.E1.m1.5.5.1.1.3.3.3.5" xref="S2.E1.m1.5.5.1.1.3.3.4.cmml">,</mo><msubsup id="S2.E1.m1.5.5.1.1.2.2.2.2" xref="S2.E1.m1.5.5.1.1.2.2.2.2.cmml"><mi id="S2.E1.m1.5.5.1.1.2.2.2.2.2.2" xref="S2.E1.m1.5.5.1.1.2.2.2.2.2.2.cmml">u</mi><mrow id="S2.E1.m1.5.5.1.1.2.2.2.2.2.3" xref="S2.E1.m1.5.5.1.1.2.2.2.2.2.3.cmml"><mn id="S2.E1.m1.5.5.1.1.2.2.2.2.2.3.2" xref="S2.E1.m1.5.5.1.1.2.2.2.2.2.3.2.cmml">1</mn><mo id="S2.E1.m1.5.5.1.1.2.2.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S2.E1.m1.5.5.1.1.2.2.2.2.2.3.1.cmml">:</mo><mi id="S2.E1.m1.5.5.1.1.2.2.2.2.2.3.3" xref="S2.E1.m1.5.5.1.1.2.2.2.2.2.3.3.cmml">m</mi></mrow><mrow id="S2.E1.m1.3.3.1.3" xref="S2.E1.m1.5.5.1.1.2.2.2.2.cmml"><mo id="S2.E1.m1.3.3.1.3.1" stretchy="false" xref="S2.E1.m1.5.5.1.1.2.2.2.2.cmml">(</mo><mi id="S2.E1.m1.3.3.1.1" xref="S2.E1.m1.3.3.1.1.cmml">i</mi><mo id="S2.E1.m1.3.3.1.3.2" stretchy="false" xref="S2.E1.m1.5.5.1.1.2.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S2.E1.m1.5.5.1.1.3.3.3.6" xref="S2.E1.m1.5.5.1.1.3.3.4.cmml">,</mo><msubsup id="S2.E1.m1.5.5.1.1.3.3.3.3" xref="S2.E1.m1.5.5.1.1.3.3.3.3.cmml"><mi id="S2.E1.m1.5.5.1.1.3.3.3.3.2.2" xref="S2.E1.m1.5.5.1.1.3.3.3.3.2.2.cmml">y</mi><mrow id="S2.E1.m1.5.5.1.1.3.3.3.3.2.3" xref="S2.E1.m1.5.5.1.1.3.3.3.3.2.3.cmml"><mn id="S2.E1.m1.5.5.1.1.3.3.3.3.2.3.2" xref="S2.E1.m1.5.5.1.1.3.3.3.3.2.3.2.cmml">1</mn><mo id="S2.E1.m1.5.5.1.1.3.3.3.3.2.3.1" lspace="0.278em" rspace="0.278em" xref="S2.E1.m1.5.5.1.1.3.3.3.3.2.3.1.cmml">:</mo><mi id="S2.E1.m1.5.5.1.1.3.3.3.3.2.3.3" xref="S2.E1.m1.5.5.1.1.3.3.3.3.2.3.3.cmml">m</mi></mrow><mrow id="S2.E1.m1.4.4.1.3" xref="S2.E1.m1.5.5.1.1.3.3.3.3.cmml"><mo id="S2.E1.m1.4.4.1.3.1" stretchy="false" xref="S2.E1.m1.5.5.1.1.3.3.3.3.cmml">(</mo><mi id="S2.E1.m1.4.4.1.1" xref="S2.E1.m1.4.4.1.1.cmml">i</mi><mo id="S2.E1.m1.4.4.1.3.2" stretchy="false" xref="S2.E1.m1.5.5.1.1.3.3.3.3.cmml">)</mo></mrow></msubsup><mo id="S2.E1.m1.5.5.1.1.3.3.3.7" stretchy="false" xref="S2.E1.m1.5.5.1.1.3.3.4.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E1.m1.5.5.1.2" xref="S2.E1.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.5b"><apply id="S2.E1.m1.5.5.1.1.cmml" xref="S2.E1.m1.5.5.1"><eq id="S2.E1.m1.5.5.1.1.4.cmml" xref="S2.E1.m1.5.5.1.1.4"></eq><apply id="S2.E1.m1.5.5.1.1.5.cmml" xref="S2.E1.m1.5.5.1.1.5"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.1.1.5.1.cmml" xref="S2.E1.m1.5.5.1.1.5">superscript</csymbol><apply id="S2.E1.m1.5.5.1.1.5.2.cmml" xref="S2.E1.m1.5.5.1.1.5"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.1.1.5.2.1.cmml" xref="S2.E1.m1.5.5.1.1.5">subscript</csymbol><apply id="S2.E1.m1.5.5.1.1.5.2.2.cmml" xref="S2.E1.m1.5.5.1.1.5.2.2"><ci id="S2.E1.m1.5.5.1.1.5.2.2.1.cmml" xref="S2.E1.m1.5.5.1.1.5.2.2.1">^</ci><ci id="S2.E1.m1.5.5.1.1.5.2.2.2.cmml" xref="S2.E1.m1.5.5.1.1.5.2.2.2">𝑦</ci></apply><apply id="S2.E1.m1.5.5.1.1.5.2.3.cmml" xref="S2.E1.m1.5.5.1.1.5.2.3"><ci id="S2.E1.m1.5.5.1.1.5.2.3.1.cmml" xref="S2.E1.m1.5.5.1.1.5.2.3.1">:</ci><apply id="S2.E1.m1.5.5.1.1.5.2.3.2.cmml" xref="S2.E1.m1.5.5.1.1.5.2.3.2"><plus id="S2.E1.m1.5.5.1.1.5.2.3.2.1.cmml" xref="S2.E1.m1.5.5.1.1.5.2.3.2.1"></plus><ci id="S2.E1.m1.5.5.1.1.5.2.3.2.2.cmml" xref="S2.E1.m1.5.5.1.1.5.2.3.2.2">𝑚</ci><cn id="S2.E1.m1.5.5.1.1.5.2.3.2.3.cmml" type="integer" xref="S2.E1.m1.5.5.1.1.5.2.3.2.3">1</cn></apply><ci id="S2.E1.m1.5.5.1.1.5.2.3.3.cmml" xref="S2.E1.m1.5.5.1.1.5.2.3.3">𝑁</ci></apply></apply><ci id="S2.E1.m1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1">𝑖</ci></apply><apply id="S2.E1.m1.5.5.1.1.3.cmml" xref="S2.E1.m1.5.5.1.1.3"><times id="S2.E1.m1.5.5.1.1.3.4.cmml" xref="S2.E1.m1.5.5.1.1.3.4"></times><apply id="S2.E1.m1.5.5.1.1.3.5.cmml" xref="S2.E1.m1.5.5.1.1.3.5"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.1.1.3.5.1.cmml" xref="S2.E1.m1.5.5.1.1.3.5">subscript</csymbol><ci id="S2.E1.m1.5.5.1.1.3.5.2.cmml" xref="S2.E1.m1.5.5.1.1.3.5.2">ℳ</ci><ci id="S2.E1.m1.5.5.1.1.3.5.3.cmml" xref="S2.E1.m1.5.5.1.1.3.5.3">italic-ϕ</ci></apply><vector id="S2.E1.m1.5.5.1.1.3.3.4.cmml" xref="S2.E1.m1.5.5.1.1.3.3.3"><apply id="S2.E1.m1.5.5.1.1.1.1.1.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E1.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.5.5.1.1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.2.2">𝑢</ci><apply id="S2.E1.m1.5.5.1.1.1.1.1.1.2.3.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.2.3"><ci id="S2.E1.m1.5.5.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.2.3.1">:</ci><apply id="S2.E1.m1.5.5.1.1.1.1.1.1.2.3.2.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.2.3.2"><plus id="S2.E1.m1.5.5.1.1.1.1.1.1.2.3.2.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.2.3.2.1"></plus><ci id="S2.E1.m1.5.5.1.1.1.1.1.1.2.3.2.2.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.2.3.2.2">𝑚</ci><cn id="S2.E1.m1.5.5.1.1.1.1.1.1.2.3.2.3.cmml" type="integer" xref="S2.E1.m1.5.5.1.1.1.1.1.1.2.3.2.3">1</cn></apply><ci id="S2.E1.m1.5.5.1.1.1.1.1.1.2.3.3.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.2.3.3">𝑁</ci></apply></apply><ci id="S2.E1.m1.2.2.1.1.cmml" xref="S2.E1.m1.2.2.1.1">𝑖</ci></apply><apply id="S2.E1.m1.5.5.1.1.2.2.2.2.cmml" xref="S2.E1.m1.5.5.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.1.1.2.2.2.2.1.cmml" xref="S2.E1.m1.5.5.1.1.2.2.2.2">superscript</csymbol><apply id="S2.E1.m1.5.5.1.1.2.2.2.2.2.cmml" xref="S2.E1.m1.5.5.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.1.1.2.2.2.2.2.1.cmml" xref="S2.E1.m1.5.5.1.1.2.2.2.2">subscript</csymbol><ci id="S2.E1.m1.5.5.1.1.2.2.2.2.2.2.cmml" xref="S2.E1.m1.5.5.1.1.2.2.2.2.2.2">𝑢</ci><apply id="S2.E1.m1.5.5.1.1.2.2.2.2.2.3.cmml" xref="S2.E1.m1.5.5.1.1.2.2.2.2.2.3"><ci id="S2.E1.m1.5.5.1.1.2.2.2.2.2.3.1.cmml" xref="S2.E1.m1.5.5.1.1.2.2.2.2.2.3.1">:</ci><cn id="S2.E1.m1.5.5.1.1.2.2.2.2.2.3.2.cmml" type="integer" xref="S2.E1.m1.5.5.1.1.2.2.2.2.2.3.2">1</cn><ci id="S2.E1.m1.5.5.1.1.2.2.2.2.2.3.3.cmml" xref="S2.E1.m1.5.5.1.1.2.2.2.2.2.3.3">𝑚</ci></apply></apply><ci id="S2.E1.m1.3.3.1.1.cmml" xref="S2.E1.m1.3.3.1.1">𝑖</ci></apply><apply id="S2.E1.m1.5.5.1.1.3.3.3.3.cmml" xref="S2.E1.m1.5.5.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.1.1.3.3.3.3.1.cmml" xref="S2.E1.m1.5.5.1.1.3.3.3.3">superscript</csymbol><apply id="S2.E1.m1.5.5.1.1.3.3.3.3.2.cmml" xref="S2.E1.m1.5.5.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.1.1.3.3.3.3.2.1.cmml" xref="S2.E1.m1.5.5.1.1.3.3.3.3">subscript</csymbol><ci id="S2.E1.m1.5.5.1.1.3.3.3.3.2.2.cmml" xref="S2.E1.m1.5.5.1.1.3.3.3.3.2.2">𝑦</ci><apply id="S2.E1.m1.5.5.1.1.3.3.3.3.2.3.cmml" xref="S2.E1.m1.5.5.1.1.3.3.3.3.2.3"><ci id="S2.E1.m1.5.5.1.1.3.3.3.3.2.3.1.cmml" xref="S2.E1.m1.5.5.1.1.3.3.3.3.2.3.1">:</ci><cn id="S2.E1.m1.5.5.1.1.3.3.3.3.2.3.2.cmml" type="integer" xref="S2.E1.m1.5.5.1.1.3.3.3.3.2.3.2">1</cn><ci id="S2.E1.m1.5.5.1.1.3.3.3.3.2.3.3.cmml" xref="S2.E1.m1.5.5.1.1.3.3.3.3.2.3.3">𝑚</ci></apply></apply><ci id="S2.E1.m1.4.4.1.1.cmml" xref="S2.E1.m1.4.4.1.1">𝑖</ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.5c">\hat{y}_{m+1:N}^{(i)}=\mathcal{M}_{\phi}(u_{m+1:N}^{(i)},u_{1:m}^{(i)},y_{1:m}%
^{(i)}),</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.5d">over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_m + 1 : italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT = caligraphic_M start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_u start_POSTSUBSCRIPT italic_m + 1 : italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_u start_POSTSUBSCRIPT 1 : italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_y start_POSTSUBSCRIPT 1 : italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p2.9">where <math alttext="\hat{y}_{m+1:N}^{(i)}" class="ltx_Math" display="inline" id="S2.p2.8.m1.1"><semantics id="S2.p2.8.m1.1a"><msubsup id="S2.p2.8.m1.1.2" xref="S2.p2.8.m1.1.2.cmml"><mover accent="true" id="S2.p2.8.m1.1.2.2.2" xref="S2.p2.8.m1.1.2.2.2.cmml"><mi id="S2.p2.8.m1.1.2.2.2.2" xref="S2.p2.8.m1.1.2.2.2.2.cmml">y</mi><mo id="S2.p2.8.m1.1.2.2.2.1" xref="S2.p2.8.m1.1.2.2.2.1.cmml">^</mo></mover><mrow id="S2.p2.8.m1.1.2.2.3" xref="S2.p2.8.m1.1.2.2.3.cmml"><mrow id="S2.p2.8.m1.1.2.2.3.2" xref="S2.p2.8.m1.1.2.2.3.2.cmml"><mi id="S2.p2.8.m1.1.2.2.3.2.2" xref="S2.p2.8.m1.1.2.2.3.2.2.cmml">m</mi><mo id="S2.p2.8.m1.1.2.2.3.2.1" xref="S2.p2.8.m1.1.2.2.3.2.1.cmml">+</mo><mn id="S2.p2.8.m1.1.2.2.3.2.3" xref="S2.p2.8.m1.1.2.2.3.2.3.cmml">1</mn></mrow><mo id="S2.p2.8.m1.1.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S2.p2.8.m1.1.2.2.3.1.cmml">:</mo><mi id="S2.p2.8.m1.1.2.2.3.3" xref="S2.p2.8.m1.1.2.2.3.3.cmml">N</mi></mrow><mrow id="S2.p2.8.m1.1.1.1.3" xref="S2.p2.8.m1.1.2.cmml"><mo id="S2.p2.8.m1.1.1.1.3.1" stretchy="false" xref="S2.p2.8.m1.1.2.cmml">(</mo><mi id="S2.p2.8.m1.1.1.1.1" xref="S2.p2.8.m1.1.1.1.1.cmml">i</mi><mo id="S2.p2.8.m1.1.1.1.3.2" stretchy="false" xref="S2.p2.8.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.p2.8.m1.1b"><apply id="S2.p2.8.m1.1.2.cmml" xref="S2.p2.8.m1.1.2"><csymbol cd="ambiguous" id="S2.p2.8.m1.1.2.1.cmml" xref="S2.p2.8.m1.1.2">superscript</csymbol><apply id="S2.p2.8.m1.1.2.2.cmml" xref="S2.p2.8.m1.1.2"><csymbol cd="ambiguous" id="S2.p2.8.m1.1.2.2.1.cmml" xref="S2.p2.8.m1.1.2">subscript</csymbol><apply id="S2.p2.8.m1.1.2.2.2.cmml" xref="S2.p2.8.m1.1.2.2.2"><ci id="S2.p2.8.m1.1.2.2.2.1.cmml" xref="S2.p2.8.m1.1.2.2.2.1">^</ci><ci id="S2.p2.8.m1.1.2.2.2.2.cmml" xref="S2.p2.8.m1.1.2.2.2.2">𝑦</ci></apply><apply id="S2.p2.8.m1.1.2.2.3.cmml" xref="S2.p2.8.m1.1.2.2.3"><ci id="S2.p2.8.m1.1.2.2.3.1.cmml" xref="S2.p2.8.m1.1.2.2.3.1">:</ci><apply id="S2.p2.8.m1.1.2.2.3.2.cmml" xref="S2.p2.8.m1.1.2.2.3.2"><plus id="S2.p2.8.m1.1.2.2.3.2.1.cmml" xref="S2.p2.8.m1.1.2.2.3.2.1"></plus><ci id="S2.p2.8.m1.1.2.2.3.2.2.cmml" xref="S2.p2.8.m1.1.2.2.3.2.2">𝑚</ci><cn id="S2.p2.8.m1.1.2.2.3.2.3.cmml" type="integer" xref="S2.p2.8.m1.1.2.2.3.2.3">1</cn></apply><ci id="S2.p2.8.m1.1.2.2.3.3.cmml" xref="S2.p2.8.m1.1.2.2.3.3">𝑁</ci></apply></apply><ci id="S2.p2.8.m1.1.1.1.1.cmml" xref="S2.p2.8.m1.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.8.m1.1c">\hat{y}_{m+1:N}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.8.m1.1d">over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_m + 1 : italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> represents the estimate of the output <math alttext="y_{m+1:N}^{(i)}" class="ltx_Math" display="inline" id="S2.p2.9.m2.1"><semantics id="S2.p2.9.m2.1a"><msubsup id="S2.p2.9.m2.1.2" xref="S2.p2.9.m2.1.2.cmml"><mi id="S2.p2.9.m2.1.2.2.2" xref="S2.p2.9.m2.1.2.2.2.cmml">y</mi><mrow id="S2.p2.9.m2.1.2.2.3" xref="S2.p2.9.m2.1.2.2.3.cmml"><mrow id="S2.p2.9.m2.1.2.2.3.2" xref="S2.p2.9.m2.1.2.2.3.2.cmml"><mi id="S2.p2.9.m2.1.2.2.3.2.2" xref="S2.p2.9.m2.1.2.2.3.2.2.cmml">m</mi><mo id="S2.p2.9.m2.1.2.2.3.2.1" xref="S2.p2.9.m2.1.2.2.3.2.1.cmml">+</mo><mn id="S2.p2.9.m2.1.2.2.3.2.3" xref="S2.p2.9.m2.1.2.2.3.2.3.cmml">1</mn></mrow><mo id="S2.p2.9.m2.1.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S2.p2.9.m2.1.2.2.3.1.cmml">:</mo><mi id="S2.p2.9.m2.1.2.2.3.3" xref="S2.p2.9.m2.1.2.2.3.3.cmml">N</mi></mrow><mrow id="S2.p2.9.m2.1.1.1.3" xref="S2.p2.9.m2.1.2.cmml"><mo id="S2.p2.9.m2.1.1.1.3.1" stretchy="false" xref="S2.p2.9.m2.1.2.cmml">(</mo><mi id="S2.p2.9.m2.1.1.1.1" xref="S2.p2.9.m2.1.1.1.1.cmml">i</mi><mo id="S2.p2.9.m2.1.1.1.3.2" stretchy="false" xref="S2.p2.9.m2.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.p2.9.m2.1b"><apply id="S2.p2.9.m2.1.2.cmml" xref="S2.p2.9.m2.1.2"><csymbol cd="ambiguous" id="S2.p2.9.m2.1.2.1.cmml" xref="S2.p2.9.m2.1.2">superscript</csymbol><apply id="S2.p2.9.m2.1.2.2.cmml" xref="S2.p2.9.m2.1.2"><csymbol cd="ambiguous" id="S2.p2.9.m2.1.2.2.1.cmml" xref="S2.p2.9.m2.1.2">subscript</csymbol><ci id="S2.p2.9.m2.1.2.2.2.cmml" xref="S2.p2.9.m2.1.2.2.2">𝑦</ci><apply id="S2.p2.9.m2.1.2.2.3.cmml" xref="S2.p2.9.m2.1.2.2.3"><ci id="S2.p2.9.m2.1.2.2.3.1.cmml" xref="S2.p2.9.m2.1.2.2.3.1">:</ci><apply id="S2.p2.9.m2.1.2.2.3.2.cmml" xref="S2.p2.9.m2.1.2.2.3.2"><plus id="S2.p2.9.m2.1.2.2.3.2.1.cmml" xref="S2.p2.9.m2.1.2.2.3.2.1"></plus><ci id="S2.p2.9.m2.1.2.2.3.2.2.cmml" xref="S2.p2.9.m2.1.2.2.3.2.2">𝑚</ci><cn id="S2.p2.9.m2.1.2.2.3.2.3.cmml" type="integer" xref="S2.p2.9.m2.1.2.2.3.2.3">1</cn></apply><ci id="S2.p2.9.m2.1.2.2.3.3.cmml" xref="S2.p2.9.m2.1.2.2.3.3">𝑁</ci></apply></apply><ci id="S2.p2.9.m2.1.1.1.1.cmml" xref="S2.p2.9.m2.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.9.m2.1c">y_{m+1:N}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.9.m2.1d">italic_y start_POSTSUBSCRIPT italic_m + 1 : italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S2.p3">
<p class="ltx_p" id="S2.p3.5">Training is performed in a supervised manner, by minimizing the regression loss</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="J=\frac{1}{b}\sum_{i=1}^{b}\left\lVert y_{m+1:N}^{(i)}-\mathcal{M}_{\phi}(u_{m%
+1:N}^{(i)},u_{1:m}^{(i)},y_{1:m}^{(i)})\right\rVert^{2}," class="ltx_Math" display="block" id="S2.E2.m1.5"><semantics id="S2.E2.m1.5a"><mrow id="S2.E2.m1.5.5.1" xref="S2.E2.m1.5.5.1.1.cmml"><mrow id="S2.E2.m1.5.5.1.1" xref="S2.E2.m1.5.5.1.1.cmml"><mi id="S2.E2.m1.5.5.1.1.3" xref="S2.E2.m1.5.5.1.1.3.cmml">J</mi><mo id="S2.E2.m1.5.5.1.1.2" xref="S2.E2.m1.5.5.1.1.2.cmml">=</mo><mrow id="S2.E2.m1.5.5.1.1.1" xref="S2.E2.m1.5.5.1.1.1.cmml"><mfrac id="S2.E2.m1.5.5.1.1.1.3" xref="S2.E2.m1.5.5.1.1.1.3.cmml"><mn id="S2.E2.m1.5.5.1.1.1.3.2" xref="S2.E2.m1.5.5.1.1.1.3.2.cmml">1</mn><mi id="S2.E2.m1.5.5.1.1.1.3.3" xref="S2.E2.m1.5.5.1.1.1.3.3.cmml">b</mi></mfrac><mo id="S2.E2.m1.5.5.1.1.1.2" xref="S2.E2.m1.5.5.1.1.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.5.5.1.1.1.1" xref="S2.E2.m1.5.5.1.1.1.1.cmml"><munderover id="S2.E2.m1.5.5.1.1.1.1.2" xref="S2.E2.m1.5.5.1.1.1.1.2.cmml"><mo id="S2.E2.m1.5.5.1.1.1.1.2.2.2" movablelimits="false" rspace="0em" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E2.m1.5.5.1.1.1.1.2.2.3" xref="S2.E2.m1.5.5.1.1.1.1.2.2.3.cmml"><mi id="S2.E2.m1.5.5.1.1.1.1.2.2.3.2" xref="S2.E2.m1.5.5.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S2.E2.m1.5.5.1.1.1.1.2.2.3.1" xref="S2.E2.m1.5.5.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E2.m1.5.5.1.1.1.1.2.2.3.3" xref="S2.E2.m1.5.5.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E2.m1.5.5.1.1.1.1.2.3" xref="S2.E2.m1.5.5.1.1.1.1.2.3.cmml">b</mi></munderover><msup id="S2.E2.m1.5.5.1.1.1.1.1" xref="S2.E2.m1.5.5.1.1.1.1.1.cmml"><mrow id="S2.E2.m1.5.5.1.1.1.1.1.1.1" xref="S2.E2.m1.5.5.1.1.1.1.1.1.2.cmml"><mo fence="true" id="S2.E2.m1.5.5.1.1.1.1.1.1.1.2" lspace="0em" rspace="0em" stretchy="true" xref="S2.E2.m1.5.5.1.1.1.1.1.1.2.1.cmml">∥</mo><mrow id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.cmml"><msubsup id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.5" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.5.cmml"><mi id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.5.2.2" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.5.2.2.cmml">y</mi><mrow id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.5.2.3" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.5.2.3.cmml"><mrow id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.5.2.3.2" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.5.2.3.2.cmml"><mi id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.5.2.3.2.2" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.5.2.3.2.2.cmml">m</mi><mo id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.5.2.3.2.1" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.5.2.3.2.1.cmml">+</mo><mn id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.5.2.3.2.3" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.5.2.3.2.3.cmml">1</mn></mrow><mo id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.5.2.3.1" lspace="0.278em" rspace="0.278em" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.5.2.3.1.cmml">:</mo><mi id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.5.2.3.3" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.5.2.3.3.cmml">N</mi></mrow><mrow id="S2.E2.m1.1.1.1.3" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.5.cmml"><mo id="S2.E2.m1.1.1.1.3.1" stretchy="false" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.5.cmml">(</mo><mi id="S2.E2.m1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml">i</mi><mo id="S2.E2.m1.1.1.1.3.2" stretchy="false" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.5.cmml">)</mo></mrow></msubsup><mo id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.4" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.4.cmml">−</mo><mrow id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.cmml"><msub id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.5" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.5.2" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.5.2.cmml">ℳ</mi><mi id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.5.3" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.5.3.cmml">ϕ</mi></msub><mo id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.4" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.4.cmml">⁢</mo><mrow id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.3" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.4.cmml"><mo id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.4" stretchy="false" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.4.cmml">(</mo><msubsup id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">u</mi><mrow id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mrow id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml"><mi id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.2" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.2.cmml">m</mi><mo id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.1" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.1.cmml">+</mo><mn id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.3" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.3.cmml">1</mn></mrow><mo id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1" lspace="0.278em" rspace="0.278em" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">:</mo><mi id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">N</mi></mrow><mrow id="S2.E2.m1.2.2.1.3" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E2.m1.2.2.1.3.1" stretchy="false" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S2.E2.m1.2.2.1.1" xref="S2.E2.m1.2.2.1.1.cmml">i</mi><mo id="S2.E2.m1.2.2.1.3.2" stretchy="false" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.5" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.4.cmml">,</mo><msubsup id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.2.2" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.2.2.cmml">u</mi><mrow id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.2.3" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.2.3.cmml"><mn id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.2.3.2" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.2.3.2.cmml">1</mn><mo id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.2.3.1.cmml">:</mo><mi id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.2.3.3" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.2.3.3.cmml">m</mi></mrow><mrow id="S2.E2.m1.3.3.1.3" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.cmml"><mo id="S2.E2.m1.3.3.1.3.1" stretchy="false" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.cmml">(</mo><mi id="S2.E2.m1.3.3.1.1" xref="S2.E2.m1.3.3.1.1.cmml">i</mi><mo id="S2.E2.m1.3.3.1.3.2" stretchy="false" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.6" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.4.cmml">,</mo><msubsup id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.cmml"><mi id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.2.2" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.2.2.cmml">y</mi><mrow id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.2.3" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.2.3.cmml"><mn id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.2.3.2" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.2.3.2.cmml">1</mn><mo id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.2.3.1" lspace="0.278em" rspace="0.278em" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.2.3.1.cmml">:</mo><mi id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.2.3.3" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.2.3.3.cmml">m</mi></mrow><mrow id="S2.E2.m1.4.4.1.3" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.cmml"><mo id="S2.E2.m1.4.4.1.3.1" stretchy="false" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.cmml">(</mo><mi id="S2.E2.m1.4.4.1.1" xref="S2.E2.m1.4.4.1.1.cmml">i</mi><mo id="S2.E2.m1.4.4.1.3.2" stretchy="false" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.cmml">)</mo></mrow></msubsup><mo id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.7" stretchy="false" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.4.cmml">)</mo></mrow></mrow></mrow><mo fence="true" id="S2.E2.m1.5.5.1.1.1.1.1.1.1.3" lspace="0em" rspace="0em" stretchy="true" xref="S2.E2.m1.5.5.1.1.1.1.1.1.2.1.cmml">∥</mo></mrow><mn id="S2.E2.m1.5.5.1.1.1.1.1.3" xref="S2.E2.m1.5.5.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow></mrow><mo id="S2.E2.m1.5.5.1.2" xref="S2.E2.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.5b"><apply id="S2.E2.m1.5.5.1.1.cmml" xref="S2.E2.m1.5.5.1"><eq id="S2.E2.m1.5.5.1.1.2.cmml" xref="S2.E2.m1.5.5.1.1.2"></eq><ci id="S2.E2.m1.5.5.1.1.3.cmml" xref="S2.E2.m1.5.5.1.1.3">𝐽</ci><apply id="S2.E2.m1.5.5.1.1.1.cmml" xref="S2.E2.m1.5.5.1.1.1"><times id="S2.E2.m1.5.5.1.1.1.2.cmml" xref="S2.E2.m1.5.5.1.1.1.2"></times><apply id="S2.E2.m1.5.5.1.1.1.3.cmml" xref="S2.E2.m1.5.5.1.1.1.3"><divide id="S2.E2.m1.5.5.1.1.1.3.1.cmml" xref="S2.E2.m1.5.5.1.1.1.3"></divide><cn id="S2.E2.m1.5.5.1.1.1.3.2.cmml" type="integer" xref="S2.E2.m1.5.5.1.1.1.3.2">1</cn><ci id="S2.E2.m1.5.5.1.1.1.3.3.cmml" xref="S2.E2.m1.5.5.1.1.1.3.3">𝑏</ci></apply><apply id="S2.E2.m1.5.5.1.1.1.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1"><apply id="S2.E2.m1.5.5.1.1.1.1.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.1.1.2.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.2">superscript</csymbol><apply id="S2.E2.m1.5.5.1.1.1.1.2.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.1.1.2.2.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.2">subscript</csymbol><sum id="S2.E2.m1.5.5.1.1.1.1.2.2.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2"></sum><apply id="S2.E2.m1.5.5.1.1.1.1.2.2.3.cmml" xref="S2.E2.m1.5.5.1.1.1.1.2.2.3"><eq id="S2.E2.m1.5.5.1.1.1.1.2.2.3.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.2.2.3.1"></eq><ci id="S2.E2.m1.5.5.1.1.1.1.2.2.3.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.2.2.3.2">𝑖</ci><cn id="S2.E2.m1.5.5.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S2.E2.m1.5.5.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E2.m1.5.5.1.1.1.1.2.3.cmml" xref="S2.E2.m1.5.5.1.1.1.1.2.3">𝑏</ci></apply><apply id="S2.E2.m1.5.5.1.1.1.1.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.1.1.1.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1">superscript</csymbol><apply id="S2.E2.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.5.5.1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.2">delimited-∥∥</csymbol><apply id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1"><minus id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.4.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.4"></minus><apply id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.5.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.5.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.5">superscript</csymbol><apply id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.5.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.5.2.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.5">subscript</csymbol><ci id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.5.2.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.5.2.2">𝑦</ci><apply id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.5.2.3.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.5.2.3"><ci id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.5.2.3.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.5.2.3.1">:</ci><apply id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.5.2.3.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.5.2.3.2"><plus id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.5.2.3.2.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.5.2.3.2.1"></plus><ci id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.5.2.3.2.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.5.2.3.2.2">𝑚</ci><cn id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.5.2.3.2.3.cmml" type="integer" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.5.2.3.2.3">1</cn></apply><ci id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.5.2.3.3.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.5.2.3.3">𝑁</ci></apply></apply><ci id="S2.E2.m1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1">𝑖</ci></apply><apply id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3"><times id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.4.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.4"></times><apply id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.5.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.5"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.5.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.5">subscript</csymbol><ci id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.5.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.5.2">ℳ</ci><ci id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.5.3.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.5.3">italic-ϕ</ci></apply><vector id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.4.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.3"><apply id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑢</ci><apply id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.3"><ci id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1">:</ci><apply id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2"><plus id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.1"></plus><ci id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.2">𝑚</ci><cn id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.3.cmml" type="integer" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.3">1</cn></apply><ci id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3">𝑁</ci></apply></apply><ci id="S2.E2.m1.2.2.1.1.cmml" xref="S2.E2.m1.2.2.1.1">𝑖</ci></apply><apply id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2">superscript</csymbol><apply id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.2.2">𝑢</ci><apply id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.2.3"><ci id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.2.3.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.2.3.1">:</ci><cn id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.2.3.2.cmml" type="integer" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.2.3.2">1</cn><ci id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.2.3.3.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.2.3.3">𝑚</ci></apply></apply><ci id="S2.E2.m1.3.3.1.1.cmml" xref="S2.E2.m1.3.3.1.1">𝑖</ci></apply><apply id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3">superscript</csymbol><apply id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.2.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3">subscript</csymbol><ci id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.2.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.2.2">𝑦</ci><apply id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.2.3.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.2.3"><ci id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.2.3.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.2.3.1">:</ci><cn id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.2.3.2.cmml" type="integer" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.2.3.2">1</cn><ci id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.2.3.3.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.2.3.3">𝑚</ci></apply></apply><ci id="S2.E2.m1.4.4.1.1.cmml" xref="S2.E2.m1.4.4.1.1">𝑖</ci></apply></vector></apply></apply></apply><cn id="S2.E2.m1.5.5.1.1.1.1.1.3.cmml" type="integer" xref="S2.E2.m1.5.5.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.5c">J=\frac{1}{b}\sum_{i=1}^{b}\left\lVert y_{m+1:N}^{(i)}-\mathcal{M}_{\phi}(u_{m%
+1:N}^{(i)},u_{1:m}^{(i)},y_{1:m}^{(i)})\right\rVert^{2},</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.5d">italic_J = divide start_ARG 1 end_ARG start_ARG italic_b end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_b end_POSTSUPERSCRIPT ∥ italic_y start_POSTSUBSCRIPT italic_m + 1 : italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT - caligraphic_M start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_u start_POSTSUBSCRIPT italic_m + 1 : italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_u start_POSTSUBSCRIPT 1 : italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_y start_POSTSUBSCRIPT 1 : italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p3.4">where <math alttext="b" class="ltx_Math" display="inline" id="S2.p3.1.m1.1"><semantics id="S2.p3.1.m1.1a"><mi id="S2.p3.1.m1.1.1" xref="S2.p3.1.m1.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S2.p3.1.m1.1b"><ci id="S2.p3.1.m1.1.1.cmml" xref="S2.p3.1.m1.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.1.m1.1c">b</annotation><annotation encoding="application/x-llamapun" id="S2.p3.1.m1.1d">italic_b</annotation></semantics></math> denotes the minibatch size, namely the number of datasets randomly extracted at each iteration of gradient-based optimization. Note that each dataset <math alttext="\mathcal{D}^{(i)}" class="ltx_Math" display="inline" id="S2.p3.2.m2.1"><semantics id="S2.p3.2.m2.1a"><msup id="S2.p3.2.m2.1.2" xref="S2.p3.2.m2.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p3.2.m2.1.2.2" xref="S2.p3.2.m2.1.2.2.cmml">𝒟</mi><mrow id="S2.p3.2.m2.1.1.1.3" xref="S2.p3.2.m2.1.2.cmml"><mo id="S2.p3.2.m2.1.1.1.3.1" stretchy="false" xref="S2.p3.2.m2.1.2.cmml">(</mo><mi id="S2.p3.2.m2.1.1.1.1" xref="S2.p3.2.m2.1.1.1.1.cmml">i</mi><mo id="S2.p3.2.m2.1.1.1.3.2" stretchy="false" xref="S2.p3.2.m2.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.p3.2.m2.1b"><apply id="S2.p3.2.m2.1.2.cmml" xref="S2.p3.2.m2.1.2"><csymbol cd="ambiguous" id="S2.p3.2.m2.1.2.1.cmml" xref="S2.p3.2.m2.1.2">superscript</csymbol><ci id="S2.p3.2.m2.1.2.2.cmml" xref="S2.p3.2.m2.1.2.2">𝒟</ci><ci id="S2.p3.2.m2.1.1.1.1.cmml" xref="S2.p3.2.m2.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.2.m2.1c">\mathcal{D}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.2.m2.1d">caligraphic_D start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> is associated to a different dynamical system <math alttext="S^{(i)}" class="ltx_Math" display="inline" id="S2.p3.3.m3.1"><semantics id="S2.p3.3.m3.1a"><msup id="S2.p3.3.m3.1.2" xref="S2.p3.3.m3.1.2.cmml"><mi id="S2.p3.3.m3.1.2.2" xref="S2.p3.3.m3.1.2.2.cmml">S</mi><mrow id="S2.p3.3.m3.1.1.1.3" xref="S2.p3.3.m3.1.2.cmml"><mo id="S2.p3.3.m3.1.1.1.3.1" stretchy="false" xref="S2.p3.3.m3.1.2.cmml">(</mo><mi id="S2.p3.3.m3.1.1.1.1" xref="S2.p3.3.m3.1.1.1.1.cmml">i</mi><mo id="S2.p3.3.m3.1.1.1.3.2" stretchy="false" xref="S2.p3.3.m3.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.p3.3.m3.1b"><apply id="S2.p3.3.m3.1.2.cmml" xref="S2.p3.3.m3.1.2"><csymbol cd="ambiguous" id="S2.p3.3.m3.1.2.1.cmml" xref="S2.p3.3.m3.1.2">superscript</csymbol><ci id="S2.p3.3.m3.1.2.2.cmml" xref="S2.p3.3.m3.1.2.2">𝑆</ci><ci id="S2.p3.3.m3.1.1.1.1.cmml" xref="S2.p3.3.m3.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.3.m3.1c">S^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.3.m3.1d">italic_S start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math>, with <math alttext="i=1,\ldots,b" class="ltx_Math" display="inline" id="S2.p3.4.m4.3"><semantics id="S2.p3.4.m4.3a"><mrow id="S2.p3.4.m4.3.4" xref="S2.p3.4.m4.3.4.cmml"><mi id="S2.p3.4.m4.3.4.2" xref="S2.p3.4.m4.3.4.2.cmml">i</mi><mo id="S2.p3.4.m4.3.4.1" xref="S2.p3.4.m4.3.4.1.cmml">=</mo><mrow id="S2.p3.4.m4.3.4.3.2" xref="S2.p3.4.m4.3.4.3.1.cmml"><mn id="S2.p3.4.m4.1.1" xref="S2.p3.4.m4.1.1.cmml">1</mn><mo id="S2.p3.4.m4.3.4.3.2.1" xref="S2.p3.4.m4.3.4.3.1.cmml">,</mo><mi id="S2.p3.4.m4.2.2" mathvariant="normal" xref="S2.p3.4.m4.2.2.cmml">…</mi><mo id="S2.p3.4.m4.3.4.3.2.2" xref="S2.p3.4.m4.3.4.3.1.cmml">,</mo><mi id="S2.p3.4.m4.3.3" xref="S2.p3.4.m4.3.3.cmml">b</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.4.m4.3b"><apply id="S2.p3.4.m4.3.4.cmml" xref="S2.p3.4.m4.3.4"><eq id="S2.p3.4.m4.3.4.1.cmml" xref="S2.p3.4.m4.3.4.1"></eq><ci id="S2.p3.4.m4.3.4.2.cmml" xref="S2.p3.4.m4.3.4.2">𝑖</ci><list id="S2.p3.4.m4.3.4.3.1.cmml" xref="S2.p3.4.m4.3.4.3.2"><cn id="S2.p3.4.m4.1.1.cmml" type="integer" xref="S2.p3.4.m4.1.1">1</cn><ci id="S2.p3.4.m4.2.2.cmml" xref="S2.p3.4.m4.2.2">…</ci><ci id="S2.p3.4.m4.3.3.cmml" xref="S2.p3.4.m4.3.3">𝑏</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.4.m4.3c">i=1,\ldots,b</annotation><annotation encoding="application/x-llamapun" id="S2.p3.4.m4.3d">italic_i = 1 , … , italic_b</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S2.p4">
<p class="ltx_p" id="S2.p4.8">Intuitively, the meta-model <math alttext="\mathcal{M}_{\phi}" class="ltx_Math" display="inline" id="S2.p4.1.m1.1"><semantics id="S2.p4.1.m1.1a"><msub id="S2.p4.1.m1.1.1" xref="S2.p4.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p4.1.m1.1.1.2" xref="S2.p4.1.m1.1.1.2.cmml">ℳ</mi><mi id="S2.p4.1.m1.1.1.3" xref="S2.p4.1.m1.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p4.1.m1.1b"><apply id="S2.p4.1.m1.1.1.cmml" xref="S2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S2.p4.1.m1.1.1.1.cmml" xref="S2.p4.1.m1.1.1">subscript</csymbol><ci id="S2.p4.1.m1.1.1.2.cmml" xref="S2.p4.1.m1.1.1.2">ℳ</ci><ci id="S2.p4.1.m1.1.1.3.cmml" xref="S2.p4.1.m1.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.1.m1.1c">\mathcal{M}_{\phi}</annotation><annotation encoding="application/x-llamapun" id="S2.p4.1.m1.1d">caligraphic_M start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math> is expected to “understand” the dynamics of system <math alttext="S^{(i)}" class="ltx_Math" display="inline" id="S2.p4.2.m2.1"><semantics id="S2.p4.2.m2.1a"><msup id="S2.p4.2.m2.1.2" xref="S2.p4.2.m2.1.2.cmml"><mi id="S2.p4.2.m2.1.2.2" xref="S2.p4.2.m2.1.2.2.cmml">S</mi><mrow id="S2.p4.2.m2.1.1.1.3" xref="S2.p4.2.m2.1.2.cmml"><mo id="S2.p4.2.m2.1.1.1.3.1" stretchy="false" xref="S2.p4.2.m2.1.2.cmml">(</mo><mi id="S2.p4.2.m2.1.1.1.1" xref="S2.p4.2.m2.1.1.1.1.cmml">i</mi><mo id="S2.p4.2.m2.1.1.1.3.2" stretchy="false" xref="S2.p4.2.m2.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.p4.2.m2.1b"><apply id="S2.p4.2.m2.1.2.cmml" xref="S2.p4.2.m2.1.2"><csymbol cd="ambiguous" id="S2.p4.2.m2.1.2.1.cmml" xref="S2.p4.2.m2.1.2">superscript</csymbol><ci id="S2.p4.2.m2.1.2.2.cmml" xref="S2.p4.2.m2.1.2.2">𝑆</ci><ci id="S2.p4.2.m2.1.1.1.1.cmml" xref="S2.p4.2.m2.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.2.m2.1c">S^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S2.p4.2.m2.1d">italic_S start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> from the context data <math alttext="(u_{1:m}^{(i)},y_{1:m}^{(i)})" class="ltx_Math" display="inline" id="S2.p4.3.m3.4"><semantics id="S2.p4.3.m3.4a"><mrow id="S2.p4.3.m3.4.4.2" xref="S2.p4.3.m3.4.4.3.cmml"><mo id="S2.p4.3.m3.4.4.2.3" stretchy="false" xref="S2.p4.3.m3.4.4.3.cmml">(</mo><msubsup id="S2.p4.3.m3.3.3.1.1" xref="S2.p4.3.m3.3.3.1.1.cmml"><mi id="S2.p4.3.m3.3.3.1.1.2.2" xref="S2.p4.3.m3.3.3.1.1.2.2.cmml">u</mi><mrow id="S2.p4.3.m3.3.3.1.1.2.3" xref="S2.p4.3.m3.3.3.1.1.2.3.cmml"><mn id="S2.p4.3.m3.3.3.1.1.2.3.2" xref="S2.p4.3.m3.3.3.1.1.2.3.2.cmml">1</mn><mo id="S2.p4.3.m3.3.3.1.1.2.3.1" lspace="0.278em" rspace="0.278em" xref="S2.p4.3.m3.3.3.1.1.2.3.1.cmml">:</mo><mi id="S2.p4.3.m3.3.3.1.1.2.3.3" xref="S2.p4.3.m3.3.3.1.1.2.3.3.cmml">m</mi></mrow><mrow id="S2.p4.3.m3.1.1.1.3" xref="S2.p4.3.m3.3.3.1.1.cmml"><mo id="S2.p4.3.m3.1.1.1.3.1" stretchy="false" xref="S2.p4.3.m3.3.3.1.1.cmml">(</mo><mi id="S2.p4.3.m3.1.1.1.1" xref="S2.p4.3.m3.1.1.1.1.cmml">i</mi><mo id="S2.p4.3.m3.1.1.1.3.2" stretchy="false" xref="S2.p4.3.m3.3.3.1.1.cmml">)</mo></mrow></msubsup><mo id="S2.p4.3.m3.4.4.2.4" xref="S2.p4.3.m3.4.4.3.cmml">,</mo><msubsup id="S2.p4.3.m3.4.4.2.2" xref="S2.p4.3.m3.4.4.2.2.cmml"><mi id="S2.p4.3.m3.4.4.2.2.2.2" xref="S2.p4.3.m3.4.4.2.2.2.2.cmml">y</mi><mrow id="S2.p4.3.m3.4.4.2.2.2.3" xref="S2.p4.3.m3.4.4.2.2.2.3.cmml"><mn id="S2.p4.3.m3.4.4.2.2.2.3.2" xref="S2.p4.3.m3.4.4.2.2.2.3.2.cmml">1</mn><mo id="S2.p4.3.m3.4.4.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S2.p4.3.m3.4.4.2.2.2.3.1.cmml">:</mo><mi id="S2.p4.3.m3.4.4.2.2.2.3.3" xref="S2.p4.3.m3.4.4.2.2.2.3.3.cmml">m</mi></mrow><mrow id="S2.p4.3.m3.2.2.1.3" xref="S2.p4.3.m3.4.4.2.2.cmml"><mo id="S2.p4.3.m3.2.2.1.3.1" stretchy="false" xref="S2.p4.3.m3.4.4.2.2.cmml">(</mo><mi id="S2.p4.3.m3.2.2.1.1" xref="S2.p4.3.m3.2.2.1.1.cmml">i</mi><mo id="S2.p4.3.m3.2.2.1.3.2" stretchy="false" xref="S2.p4.3.m3.4.4.2.2.cmml">)</mo></mrow></msubsup><mo id="S2.p4.3.m3.4.4.2.5" stretchy="false" xref="S2.p4.3.m3.4.4.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.p4.3.m3.4b"><interval closure="open" id="S2.p4.3.m3.4.4.3.cmml" xref="S2.p4.3.m3.4.4.2"><apply id="S2.p4.3.m3.3.3.1.1.cmml" xref="S2.p4.3.m3.3.3.1.1"><csymbol cd="ambiguous" id="S2.p4.3.m3.3.3.1.1.1.cmml" xref="S2.p4.3.m3.3.3.1.1">superscript</csymbol><apply id="S2.p4.3.m3.3.3.1.1.2.cmml" xref="S2.p4.3.m3.3.3.1.1"><csymbol cd="ambiguous" id="S2.p4.3.m3.3.3.1.1.2.1.cmml" xref="S2.p4.3.m3.3.3.1.1">subscript</csymbol><ci id="S2.p4.3.m3.3.3.1.1.2.2.cmml" xref="S2.p4.3.m3.3.3.1.1.2.2">𝑢</ci><apply id="S2.p4.3.m3.3.3.1.1.2.3.cmml" xref="S2.p4.3.m3.3.3.1.1.2.3"><ci id="S2.p4.3.m3.3.3.1.1.2.3.1.cmml" xref="S2.p4.3.m3.3.3.1.1.2.3.1">:</ci><cn id="S2.p4.3.m3.3.3.1.1.2.3.2.cmml" type="integer" xref="S2.p4.3.m3.3.3.1.1.2.3.2">1</cn><ci id="S2.p4.3.m3.3.3.1.1.2.3.3.cmml" xref="S2.p4.3.m3.3.3.1.1.2.3.3">𝑚</ci></apply></apply><ci id="S2.p4.3.m3.1.1.1.1.cmml" xref="S2.p4.3.m3.1.1.1.1">𝑖</ci></apply><apply id="S2.p4.3.m3.4.4.2.2.cmml" xref="S2.p4.3.m3.4.4.2.2"><csymbol cd="ambiguous" id="S2.p4.3.m3.4.4.2.2.1.cmml" xref="S2.p4.3.m3.4.4.2.2">superscript</csymbol><apply id="S2.p4.3.m3.4.4.2.2.2.cmml" xref="S2.p4.3.m3.4.4.2.2"><csymbol cd="ambiguous" id="S2.p4.3.m3.4.4.2.2.2.1.cmml" xref="S2.p4.3.m3.4.4.2.2">subscript</csymbol><ci id="S2.p4.3.m3.4.4.2.2.2.2.cmml" xref="S2.p4.3.m3.4.4.2.2.2.2">𝑦</ci><apply id="S2.p4.3.m3.4.4.2.2.2.3.cmml" xref="S2.p4.3.m3.4.4.2.2.2.3"><ci id="S2.p4.3.m3.4.4.2.2.2.3.1.cmml" xref="S2.p4.3.m3.4.4.2.2.2.3.1">:</ci><cn id="S2.p4.3.m3.4.4.2.2.2.3.2.cmml" type="integer" xref="S2.p4.3.m3.4.4.2.2.2.3.2">1</cn><ci id="S2.p4.3.m3.4.4.2.2.2.3.3.cmml" xref="S2.p4.3.m3.4.4.2.2.2.3.3">𝑚</ci></apply></apply><ci id="S2.p4.3.m3.2.2.1.1.cmml" xref="S2.p4.3.m3.2.2.1.1">𝑖</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.3.m3.4c">(u_{1:m}^{(i)},y_{1:m}^{(i)})</annotation><annotation encoding="application/x-llamapun" id="S2.p4.3.m3.4d">( italic_u start_POSTSUBSCRIPT 1 : italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_y start_POSTSUBSCRIPT 1 : italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT )</annotation></semantics></math> and to use this knowledge to generate output predictions <math alttext="\hat{y}_{m+1:N}^{(i)}" class="ltx_Math" display="inline" id="S2.p4.4.m4.1"><semantics id="S2.p4.4.m4.1a"><msubsup id="S2.p4.4.m4.1.2" xref="S2.p4.4.m4.1.2.cmml"><mover accent="true" id="S2.p4.4.m4.1.2.2.2" xref="S2.p4.4.m4.1.2.2.2.cmml"><mi id="S2.p4.4.m4.1.2.2.2.2" xref="S2.p4.4.m4.1.2.2.2.2.cmml">y</mi><mo id="S2.p4.4.m4.1.2.2.2.1" xref="S2.p4.4.m4.1.2.2.2.1.cmml">^</mo></mover><mrow id="S2.p4.4.m4.1.2.2.3" xref="S2.p4.4.m4.1.2.2.3.cmml"><mrow id="S2.p4.4.m4.1.2.2.3.2" xref="S2.p4.4.m4.1.2.2.3.2.cmml"><mi id="S2.p4.4.m4.1.2.2.3.2.2" xref="S2.p4.4.m4.1.2.2.3.2.2.cmml">m</mi><mo id="S2.p4.4.m4.1.2.2.3.2.1" xref="S2.p4.4.m4.1.2.2.3.2.1.cmml">+</mo><mn id="S2.p4.4.m4.1.2.2.3.2.3" xref="S2.p4.4.m4.1.2.2.3.2.3.cmml">1</mn></mrow><mo id="S2.p4.4.m4.1.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S2.p4.4.m4.1.2.2.3.1.cmml">:</mo><mi id="S2.p4.4.m4.1.2.2.3.3" xref="S2.p4.4.m4.1.2.2.3.3.cmml">N</mi></mrow><mrow id="S2.p4.4.m4.1.1.1.3" xref="S2.p4.4.m4.1.2.cmml"><mo id="S2.p4.4.m4.1.1.1.3.1" stretchy="false" xref="S2.p4.4.m4.1.2.cmml">(</mo><mi id="S2.p4.4.m4.1.1.1.1" xref="S2.p4.4.m4.1.1.1.1.cmml">i</mi><mo id="S2.p4.4.m4.1.1.1.3.2" stretchy="false" xref="S2.p4.4.m4.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.p4.4.m4.1b"><apply id="S2.p4.4.m4.1.2.cmml" xref="S2.p4.4.m4.1.2"><csymbol cd="ambiguous" id="S2.p4.4.m4.1.2.1.cmml" xref="S2.p4.4.m4.1.2">superscript</csymbol><apply id="S2.p4.4.m4.1.2.2.cmml" xref="S2.p4.4.m4.1.2"><csymbol cd="ambiguous" id="S2.p4.4.m4.1.2.2.1.cmml" xref="S2.p4.4.m4.1.2">subscript</csymbol><apply id="S2.p4.4.m4.1.2.2.2.cmml" xref="S2.p4.4.m4.1.2.2.2"><ci id="S2.p4.4.m4.1.2.2.2.1.cmml" xref="S2.p4.4.m4.1.2.2.2.1">^</ci><ci id="S2.p4.4.m4.1.2.2.2.2.cmml" xref="S2.p4.4.m4.1.2.2.2.2">𝑦</ci></apply><apply id="S2.p4.4.m4.1.2.2.3.cmml" xref="S2.p4.4.m4.1.2.2.3"><ci id="S2.p4.4.m4.1.2.2.3.1.cmml" xref="S2.p4.4.m4.1.2.2.3.1">:</ci><apply id="S2.p4.4.m4.1.2.2.3.2.cmml" xref="S2.p4.4.m4.1.2.2.3.2"><plus id="S2.p4.4.m4.1.2.2.3.2.1.cmml" xref="S2.p4.4.m4.1.2.2.3.2.1"></plus><ci id="S2.p4.4.m4.1.2.2.3.2.2.cmml" xref="S2.p4.4.m4.1.2.2.3.2.2">𝑚</ci><cn id="S2.p4.4.m4.1.2.2.3.2.3.cmml" type="integer" xref="S2.p4.4.m4.1.2.2.3.2.3">1</cn></apply><ci id="S2.p4.4.m4.1.2.2.3.3.cmml" xref="S2.p4.4.m4.1.2.2.3.3">𝑁</ci></apply></apply><ci id="S2.p4.4.m4.1.1.1.1.cmml" xref="S2.p4.4.m4.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.4.m4.1c">\hat{y}_{m+1:N}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S2.p4.4.m4.1d">over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_m + 1 : italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> in the query segment. Eventually, the trained meta-model <math alttext="\mathcal{M}_{\phi}" class="ltx_Math" display="inline" id="S2.p4.5.m5.1"><semantics id="S2.p4.5.m5.1a"><msub id="S2.p4.5.m5.1.1" xref="S2.p4.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p4.5.m5.1.1.2" xref="S2.p4.5.m5.1.1.2.cmml">ℳ</mi><mi id="S2.p4.5.m5.1.1.3" xref="S2.p4.5.m5.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p4.5.m5.1b"><apply id="S2.p4.5.m5.1.1.cmml" xref="S2.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S2.p4.5.m5.1.1.1.cmml" xref="S2.p4.5.m5.1.1">subscript</csymbol><ci id="S2.p4.5.m5.1.1.2.cmml" xref="S2.p4.5.m5.1.1.2">ℳ</ci><ci id="S2.p4.5.m5.1.1.3.cmml" xref="S2.p4.5.m5.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.5.m5.1c">\mathcal{M}_{\phi}</annotation><annotation encoding="application/x-llamapun" id="S2.p4.5.m5.1d">caligraphic_M start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math>, will be able to generate multi-step-ahead predictions for a <em class="ltx_emph ltx_font_italic" id="S2.p4.8.1">new</em> system <math alttext="S" class="ltx_Math" display="inline" id="S2.p4.6.m6.1"><semantics id="S2.p4.6.m6.1a"><mi id="S2.p4.6.m6.1.1" xref="S2.p4.6.m6.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S2.p4.6.m6.1b"><ci id="S2.p4.6.m6.1.1.cmml" xref="S2.p4.6.m6.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.6.m6.1c">S</annotation><annotation encoding="application/x-llamapun" id="S2.p4.6.m6.1d">italic_S</annotation></semantics></math> given an input/output sequence <math alttext="(u_{1:m},y_{1:m})" class="ltx_Math" display="inline" id="S2.p4.7.m7.2"><semantics id="S2.p4.7.m7.2a"><mrow id="S2.p4.7.m7.2.2.2" xref="S2.p4.7.m7.2.2.3.cmml"><mo id="S2.p4.7.m7.2.2.2.3" stretchy="false" xref="S2.p4.7.m7.2.2.3.cmml">(</mo><msub id="S2.p4.7.m7.1.1.1.1" xref="S2.p4.7.m7.1.1.1.1.cmml"><mi id="S2.p4.7.m7.1.1.1.1.2" xref="S2.p4.7.m7.1.1.1.1.2.cmml">u</mi><mrow id="S2.p4.7.m7.1.1.1.1.3" xref="S2.p4.7.m7.1.1.1.1.3.cmml"><mn id="S2.p4.7.m7.1.1.1.1.3.2" xref="S2.p4.7.m7.1.1.1.1.3.2.cmml">1</mn><mo id="S2.p4.7.m7.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S2.p4.7.m7.1.1.1.1.3.1.cmml">:</mo><mi id="S2.p4.7.m7.1.1.1.1.3.3" xref="S2.p4.7.m7.1.1.1.1.3.3.cmml">m</mi></mrow></msub><mo id="S2.p4.7.m7.2.2.2.4" xref="S2.p4.7.m7.2.2.3.cmml">,</mo><msub id="S2.p4.7.m7.2.2.2.2" xref="S2.p4.7.m7.2.2.2.2.cmml"><mi id="S2.p4.7.m7.2.2.2.2.2" xref="S2.p4.7.m7.2.2.2.2.2.cmml">y</mi><mrow id="S2.p4.7.m7.2.2.2.2.3" xref="S2.p4.7.m7.2.2.2.2.3.cmml"><mn id="S2.p4.7.m7.2.2.2.2.3.2" xref="S2.p4.7.m7.2.2.2.2.3.2.cmml">1</mn><mo id="S2.p4.7.m7.2.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S2.p4.7.m7.2.2.2.2.3.1.cmml">:</mo><mi id="S2.p4.7.m7.2.2.2.2.3.3" xref="S2.p4.7.m7.2.2.2.2.3.3.cmml">m</mi></mrow></msub><mo id="S2.p4.7.m7.2.2.2.5" stretchy="false" xref="S2.p4.7.m7.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.p4.7.m7.2b"><interval closure="open" id="S2.p4.7.m7.2.2.3.cmml" xref="S2.p4.7.m7.2.2.2"><apply id="S2.p4.7.m7.1.1.1.1.cmml" xref="S2.p4.7.m7.1.1.1.1"><csymbol cd="ambiguous" id="S2.p4.7.m7.1.1.1.1.1.cmml" xref="S2.p4.7.m7.1.1.1.1">subscript</csymbol><ci id="S2.p4.7.m7.1.1.1.1.2.cmml" xref="S2.p4.7.m7.1.1.1.1.2">𝑢</ci><apply id="S2.p4.7.m7.1.1.1.1.3.cmml" xref="S2.p4.7.m7.1.1.1.1.3"><ci id="S2.p4.7.m7.1.1.1.1.3.1.cmml" xref="S2.p4.7.m7.1.1.1.1.3.1">:</ci><cn id="S2.p4.7.m7.1.1.1.1.3.2.cmml" type="integer" xref="S2.p4.7.m7.1.1.1.1.3.2">1</cn><ci id="S2.p4.7.m7.1.1.1.1.3.3.cmml" xref="S2.p4.7.m7.1.1.1.1.3.3">𝑚</ci></apply></apply><apply id="S2.p4.7.m7.2.2.2.2.cmml" xref="S2.p4.7.m7.2.2.2.2"><csymbol cd="ambiguous" id="S2.p4.7.m7.2.2.2.2.1.cmml" xref="S2.p4.7.m7.2.2.2.2">subscript</csymbol><ci id="S2.p4.7.m7.2.2.2.2.2.cmml" xref="S2.p4.7.m7.2.2.2.2.2">𝑦</ci><apply id="S2.p4.7.m7.2.2.2.2.3.cmml" xref="S2.p4.7.m7.2.2.2.2.3"><ci id="S2.p4.7.m7.2.2.2.2.3.1.cmml" xref="S2.p4.7.m7.2.2.2.2.3.1">:</ci><cn id="S2.p4.7.m7.2.2.2.2.3.2.cmml" type="integer" xref="S2.p4.7.m7.2.2.2.2.3.2">1</cn><ci id="S2.p4.7.m7.2.2.2.2.3.3.cmml" xref="S2.p4.7.m7.2.2.2.2.3.3">𝑚</ci></apply></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.7.m7.2c">(u_{1:m},y_{1:m})</annotation><annotation encoding="application/x-llamapun" id="S2.p4.7.m7.2d">( italic_u start_POSTSUBSCRIPT 1 : italic_m end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 1 : italic_m end_POSTSUBSCRIPT )</annotation></semantics></math> and the query input <math alttext="u_{m+1:N}" class="ltx_Math" display="inline" id="S2.p4.8.m8.1"><semantics id="S2.p4.8.m8.1a"><msub id="S2.p4.8.m8.1.1" xref="S2.p4.8.m8.1.1.cmml"><mi id="S2.p4.8.m8.1.1.2" xref="S2.p4.8.m8.1.1.2.cmml">u</mi><mrow id="S2.p4.8.m8.1.1.3" xref="S2.p4.8.m8.1.1.3.cmml"><mrow id="S2.p4.8.m8.1.1.3.2" xref="S2.p4.8.m8.1.1.3.2.cmml"><mi id="S2.p4.8.m8.1.1.3.2.2" xref="S2.p4.8.m8.1.1.3.2.2.cmml">m</mi><mo id="S2.p4.8.m8.1.1.3.2.1" xref="S2.p4.8.m8.1.1.3.2.1.cmml">+</mo><mn id="S2.p4.8.m8.1.1.3.2.3" xref="S2.p4.8.m8.1.1.3.2.3.cmml">1</mn></mrow><mo id="S2.p4.8.m8.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S2.p4.8.m8.1.1.3.1.cmml">:</mo><mi id="S2.p4.8.m8.1.1.3.3" xref="S2.p4.8.m8.1.1.3.3.cmml">N</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p4.8.m8.1b"><apply id="S2.p4.8.m8.1.1.cmml" xref="S2.p4.8.m8.1.1"><csymbol cd="ambiguous" id="S2.p4.8.m8.1.1.1.cmml" xref="S2.p4.8.m8.1.1">subscript</csymbol><ci id="S2.p4.8.m8.1.1.2.cmml" xref="S2.p4.8.m8.1.1.2">𝑢</ci><apply id="S2.p4.8.m8.1.1.3.cmml" xref="S2.p4.8.m8.1.1.3"><ci id="S2.p4.8.m8.1.1.3.1.cmml" xref="S2.p4.8.m8.1.1.3.1">:</ci><apply id="S2.p4.8.m8.1.1.3.2.cmml" xref="S2.p4.8.m8.1.1.3.2"><plus id="S2.p4.8.m8.1.1.3.2.1.cmml" xref="S2.p4.8.m8.1.1.3.2.1"></plus><ci id="S2.p4.8.m8.1.1.3.2.2.cmml" xref="S2.p4.8.m8.1.1.3.2.2">𝑚</ci><cn id="S2.p4.8.m8.1.1.3.2.3.cmml" type="integer" xref="S2.p4.8.m8.1.1.3.2.3">1</cn></apply><ci id="S2.p4.8.m8.1.1.3.3.cmml" xref="S2.p4.8.m8.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.8.m8.1c">u_{m+1:N}</annotation><annotation encoding="application/x-llamapun" id="S2.p4.8.m8.1d">italic_u start_POSTSUBSCRIPT italic_m + 1 : italic_N end_POSTSUBSCRIPT</annotation></semantics></math>, without the need of estimating a model for that system. It is worth remarking that, although training is done offline based on potentially synthetic data generated in simulation, the trained meta-model is supposed to be applied online to measured data from a real system.</p>
</div>
<div class="ltx_para" id="S2.p5">
<p class="ltx_p" id="S2.p5.6">In <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#bib.bib11" title="">11</a>]</cite>, an encoder-decoder Transformer architecture <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#bib.bib20" title="">20</a>]</cite> is used as meta-model.
The input/output context data <math alttext="(u_{1:m},y_{1:m})" class="ltx_Math" display="inline" id="S2.p5.1.m1.2"><semantics id="S2.p5.1.m1.2a"><mrow id="S2.p5.1.m1.2.2.2" xref="S2.p5.1.m1.2.2.3.cmml"><mo id="S2.p5.1.m1.2.2.2.3" stretchy="false" xref="S2.p5.1.m1.2.2.3.cmml">(</mo><msub id="S2.p5.1.m1.1.1.1.1" xref="S2.p5.1.m1.1.1.1.1.cmml"><mi id="S2.p5.1.m1.1.1.1.1.2" xref="S2.p5.1.m1.1.1.1.1.2.cmml">u</mi><mrow id="S2.p5.1.m1.1.1.1.1.3" xref="S2.p5.1.m1.1.1.1.1.3.cmml"><mn id="S2.p5.1.m1.1.1.1.1.3.2" xref="S2.p5.1.m1.1.1.1.1.3.2.cmml">1</mn><mo id="S2.p5.1.m1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S2.p5.1.m1.1.1.1.1.3.1.cmml">:</mo><mi id="S2.p5.1.m1.1.1.1.1.3.3" xref="S2.p5.1.m1.1.1.1.1.3.3.cmml">m</mi></mrow></msub><mo id="S2.p5.1.m1.2.2.2.4" xref="S2.p5.1.m1.2.2.3.cmml">,</mo><msub id="S2.p5.1.m1.2.2.2.2" xref="S2.p5.1.m1.2.2.2.2.cmml"><mi id="S2.p5.1.m1.2.2.2.2.2" xref="S2.p5.1.m1.2.2.2.2.2.cmml">y</mi><mrow id="S2.p5.1.m1.2.2.2.2.3" xref="S2.p5.1.m1.2.2.2.2.3.cmml"><mn id="S2.p5.1.m1.2.2.2.2.3.2" xref="S2.p5.1.m1.2.2.2.2.3.2.cmml">1</mn><mo id="S2.p5.1.m1.2.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S2.p5.1.m1.2.2.2.2.3.1.cmml">:</mo><mi id="S2.p5.1.m1.2.2.2.2.3.3" xref="S2.p5.1.m1.2.2.2.2.3.3.cmml">m</mi></mrow></msub><mo id="S2.p5.1.m1.2.2.2.5" stretchy="false" xref="S2.p5.1.m1.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.p5.1.m1.2b"><interval closure="open" id="S2.p5.1.m1.2.2.3.cmml" xref="S2.p5.1.m1.2.2.2"><apply id="S2.p5.1.m1.1.1.1.1.cmml" xref="S2.p5.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p5.1.m1.1.1.1.1.1.cmml" xref="S2.p5.1.m1.1.1.1.1">subscript</csymbol><ci id="S2.p5.1.m1.1.1.1.1.2.cmml" xref="S2.p5.1.m1.1.1.1.1.2">𝑢</ci><apply id="S2.p5.1.m1.1.1.1.1.3.cmml" xref="S2.p5.1.m1.1.1.1.1.3"><ci id="S2.p5.1.m1.1.1.1.1.3.1.cmml" xref="S2.p5.1.m1.1.1.1.1.3.1">:</ci><cn id="S2.p5.1.m1.1.1.1.1.3.2.cmml" type="integer" xref="S2.p5.1.m1.1.1.1.1.3.2">1</cn><ci id="S2.p5.1.m1.1.1.1.1.3.3.cmml" xref="S2.p5.1.m1.1.1.1.1.3.3">𝑚</ci></apply></apply><apply id="S2.p5.1.m1.2.2.2.2.cmml" xref="S2.p5.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S2.p5.1.m1.2.2.2.2.1.cmml" xref="S2.p5.1.m1.2.2.2.2">subscript</csymbol><ci id="S2.p5.1.m1.2.2.2.2.2.cmml" xref="S2.p5.1.m1.2.2.2.2.2">𝑦</ci><apply id="S2.p5.1.m1.2.2.2.2.3.cmml" xref="S2.p5.1.m1.2.2.2.2.3"><ci id="S2.p5.1.m1.2.2.2.2.3.1.cmml" xref="S2.p5.1.m1.2.2.2.2.3.1">:</ci><cn id="S2.p5.1.m1.2.2.2.2.3.2.cmml" type="integer" xref="S2.p5.1.m1.2.2.2.2.3.2">1</cn><ci id="S2.p5.1.m1.2.2.2.2.3.3.cmml" xref="S2.p5.1.m1.2.2.2.2.3.3">𝑚</ci></apply></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.1.m1.2c">(u_{1:m},y_{1:m})</annotation><annotation encoding="application/x-llamapun" id="S2.p5.1.m1.2d">( italic_u start_POSTSUBSCRIPT 1 : italic_m end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 1 : italic_m end_POSTSUBSCRIPT )</annotation></semantics></math> are processed by the encoder, which produces a real-valued sequence <math alttext="\zeta_{1:m},\,\zeta_{i}\in\mathbb{R}^{d_{\rm model}}" class="ltx_Math" display="inline" id="S2.p5.2.m2.2"><semantics id="S2.p5.2.m2.2a"><mrow id="S2.p5.2.m2.2.2" xref="S2.p5.2.m2.2.2.cmml"><mrow id="S2.p5.2.m2.2.2.2.2" xref="S2.p5.2.m2.2.2.2.3.cmml"><msub id="S2.p5.2.m2.1.1.1.1.1" xref="S2.p5.2.m2.1.1.1.1.1.cmml"><mi id="S2.p5.2.m2.1.1.1.1.1.2" xref="S2.p5.2.m2.1.1.1.1.1.2.cmml">ζ</mi><mrow id="S2.p5.2.m2.1.1.1.1.1.3" xref="S2.p5.2.m2.1.1.1.1.1.3.cmml"><mn id="S2.p5.2.m2.1.1.1.1.1.3.2" xref="S2.p5.2.m2.1.1.1.1.1.3.2.cmml">1</mn><mo id="S2.p5.2.m2.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S2.p5.2.m2.1.1.1.1.1.3.1.cmml">:</mo><mi id="S2.p5.2.m2.1.1.1.1.1.3.3" xref="S2.p5.2.m2.1.1.1.1.1.3.3.cmml">m</mi></mrow></msub><mo id="S2.p5.2.m2.2.2.2.2.3" rspace="0.337em" xref="S2.p5.2.m2.2.2.2.3.cmml">,</mo><msub id="S2.p5.2.m2.2.2.2.2.2" xref="S2.p5.2.m2.2.2.2.2.2.cmml"><mi id="S2.p5.2.m2.2.2.2.2.2.2" xref="S2.p5.2.m2.2.2.2.2.2.2.cmml">ζ</mi><mi id="S2.p5.2.m2.2.2.2.2.2.3" xref="S2.p5.2.m2.2.2.2.2.2.3.cmml">i</mi></msub></mrow><mo id="S2.p5.2.m2.2.2.3" xref="S2.p5.2.m2.2.2.3.cmml">∈</mo><msup id="S2.p5.2.m2.2.2.4" xref="S2.p5.2.m2.2.2.4.cmml"><mi id="S2.p5.2.m2.2.2.4.2" xref="S2.p5.2.m2.2.2.4.2.cmml">ℝ</mi><msub id="S2.p5.2.m2.2.2.4.3" xref="S2.p5.2.m2.2.2.4.3.cmml"><mi id="S2.p5.2.m2.2.2.4.3.2" xref="S2.p5.2.m2.2.2.4.3.2.cmml">d</mi><mi id="S2.p5.2.m2.2.2.4.3.3" xref="S2.p5.2.m2.2.2.4.3.3.cmml">model</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p5.2.m2.2b"><apply id="S2.p5.2.m2.2.2.cmml" xref="S2.p5.2.m2.2.2"><in id="S2.p5.2.m2.2.2.3.cmml" xref="S2.p5.2.m2.2.2.3"></in><list id="S2.p5.2.m2.2.2.2.3.cmml" xref="S2.p5.2.m2.2.2.2.2"><apply id="S2.p5.2.m2.1.1.1.1.1.cmml" xref="S2.p5.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p5.2.m2.1.1.1.1.1.1.cmml" xref="S2.p5.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S2.p5.2.m2.1.1.1.1.1.2.cmml" xref="S2.p5.2.m2.1.1.1.1.1.2">𝜁</ci><apply id="S2.p5.2.m2.1.1.1.1.1.3.cmml" xref="S2.p5.2.m2.1.1.1.1.1.3"><ci id="S2.p5.2.m2.1.1.1.1.1.3.1.cmml" xref="S2.p5.2.m2.1.1.1.1.1.3.1">:</ci><cn id="S2.p5.2.m2.1.1.1.1.1.3.2.cmml" type="integer" xref="S2.p5.2.m2.1.1.1.1.1.3.2">1</cn><ci id="S2.p5.2.m2.1.1.1.1.1.3.3.cmml" xref="S2.p5.2.m2.1.1.1.1.1.3.3">𝑚</ci></apply></apply><apply id="S2.p5.2.m2.2.2.2.2.2.cmml" xref="S2.p5.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.p5.2.m2.2.2.2.2.2.1.cmml" xref="S2.p5.2.m2.2.2.2.2.2">subscript</csymbol><ci id="S2.p5.2.m2.2.2.2.2.2.2.cmml" xref="S2.p5.2.m2.2.2.2.2.2.2">𝜁</ci><ci id="S2.p5.2.m2.2.2.2.2.2.3.cmml" xref="S2.p5.2.m2.2.2.2.2.2.3">𝑖</ci></apply></list><apply id="S2.p5.2.m2.2.2.4.cmml" xref="S2.p5.2.m2.2.2.4"><csymbol cd="ambiguous" id="S2.p5.2.m2.2.2.4.1.cmml" xref="S2.p5.2.m2.2.2.4">superscript</csymbol><ci id="S2.p5.2.m2.2.2.4.2.cmml" xref="S2.p5.2.m2.2.2.4.2">ℝ</ci><apply id="S2.p5.2.m2.2.2.4.3.cmml" xref="S2.p5.2.m2.2.2.4.3"><csymbol cd="ambiguous" id="S2.p5.2.m2.2.2.4.3.1.cmml" xref="S2.p5.2.m2.2.2.4.3">subscript</csymbol><ci id="S2.p5.2.m2.2.2.4.3.2.cmml" xref="S2.p5.2.m2.2.2.4.3.2">𝑑</ci><ci id="S2.p5.2.m2.2.2.4.3.3.cmml" xref="S2.p5.2.m2.2.2.4.3.3">model</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.2.m2.2c">\zeta_{1:m},\,\zeta_{i}\in\mathbb{R}^{d_{\rm model}}</annotation><annotation encoding="application/x-llamapun" id="S2.p5.2.m2.2d">italic_ζ start_POSTSUBSCRIPT 1 : italic_m end_POSTSUBSCRIPT , italic_ζ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT roman_model end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>. Then, the decoder generates output predictions <math alttext="\hat{y}_{m+1:N}" class="ltx_Math" display="inline" id="S2.p5.3.m3.1"><semantics id="S2.p5.3.m3.1a"><msub id="S2.p5.3.m3.1.1" xref="S2.p5.3.m3.1.1.cmml"><mover accent="true" id="S2.p5.3.m3.1.1.2" xref="S2.p5.3.m3.1.1.2.cmml"><mi id="S2.p5.3.m3.1.1.2.2" xref="S2.p5.3.m3.1.1.2.2.cmml">y</mi><mo id="S2.p5.3.m3.1.1.2.1" xref="S2.p5.3.m3.1.1.2.1.cmml">^</mo></mover><mrow id="S2.p5.3.m3.1.1.3" xref="S2.p5.3.m3.1.1.3.cmml"><mrow id="S2.p5.3.m3.1.1.3.2" xref="S2.p5.3.m3.1.1.3.2.cmml"><mi id="S2.p5.3.m3.1.1.3.2.2" xref="S2.p5.3.m3.1.1.3.2.2.cmml">m</mi><mo id="S2.p5.3.m3.1.1.3.2.1" xref="S2.p5.3.m3.1.1.3.2.1.cmml">+</mo><mn id="S2.p5.3.m3.1.1.3.2.3" xref="S2.p5.3.m3.1.1.3.2.3.cmml">1</mn></mrow><mo id="S2.p5.3.m3.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S2.p5.3.m3.1.1.3.1.cmml">:</mo><mi id="S2.p5.3.m3.1.1.3.3" xref="S2.p5.3.m3.1.1.3.3.cmml">N</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p5.3.m3.1b"><apply id="S2.p5.3.m3.1.1.cmml" xref="S2.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S2.p5.3.m3.1.1.1.cmml" xref="S2.p5.3.m3.1.1">subscript</csymbol><apply id="S2.p5.3.m3.1.1.2.cmml" xref="S2.p5.3.m3.1.1.2"><ci id="S2.p5.3.m3.1.1.2.1.cmml" xref="S2.p5.3.m3.1.1.2.1">^</ci><ci id="S2.p5.3.m3.1.1.2.2.cmml" xref="S2.p5.3.m3.1.1.2.2">𝑦</ci></apply><apply id="S2.p5.3.m3.1.1.3.cmml" xref="S2.p5.3.m3.1.1.3"><ci id="S2.p5.3.m3.1.1.3.1.cmml" xref="S2.p5.3.m3.1.1.3.1">:</ci><apply id="S2.p5.3.m3.1.1.3.2.cmml" xref="S2.p5.3.m3.1.1.3.2"><plus id="S2.p5.3.m3.1.1.3.2.1.cmml" xref="S2.p5.3.m3.1.1.3.2.1"></plus><ci id="S2.p5.3.m3.1.1.3.2.2.cmml" xref="S2.p5.3.m3.1.1.3.2.2">𝑚</ci><cn id="S2.p5.3.m3.1.1.3.2.3.cmml" type="integer" xref="S2.p5.3.m3.1.1.3.2.3">1</cn></apply><ci id="S2.p5.3.m3.1.1.3.3.cmml" xref="S2.p5.3.m3.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.3.m3.1c">\hat{y}_{m+1:N}</annotation><annotation encoding="application/x-llamapun" id="S2.p5.3.m3.1d">over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_m + 1 : italic_N end_POSTSUBSCRIPT</annotation></semantics></math> by processing the query input <math alttext="u_{m+1:N}" class="ltx_Math" display="inline" id="S2.p5.4.m4.1"><semantics id="S2.p5.4.m4.1a"><msub id="S2.p5.4.m4.1.1" xref="S2.p5.4.m4.1.1.cmml"><mi id="S2.p5.4.m4.1.1.2" xref="S2.p5.4.m4.1.1.2.cmml">u</mi><mrow id="S2.p5.4.m4.1.1.3" xref="S2.p5.4.m4.1.1.3.cmml"><mrow id="S2.p5.4.m4.1.1.3.2" xref="S2.p5.4.m4.1.1.3.2.cmml"><mi id="S2.p5.4.m4.1.1.3.2.2" xref="S2.p5.4.m4.1.1.3.2.2.cmml">m</mi><mo id="S2.p5.4.m4.1.1.3.2.1" xref="S2.p5.4.m4.1.1.3.2.1.cmml">+</mo><mn id="S2.p5.4.m4.1.1.3.2.3" xref="S2.p5.4.m4.1.1.3.2.3.cmml">1</mn></mrow><mo id="S2.p5.4.m4.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S2.p5.4.m4.1.1.3.1.cmml">:</mo><mi id="S2.p5.4.m4.1.1.3.3" xref="S2.p5.4.m4.1.1.3.3.cmml">N</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p5.4.m4.1b"><apply id="S2.p5.4.m4.1.1.cmml" xref="S2.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S2.p5.4.m4.1.1.1.cmml" xref="S2.p5.4.m4.1.1">subscript</csymbol><ci id="S2.p5.4.m4.1.1.2.cmml" xref="S2.p5.4.m4.1.1.2">𝑢</ci><apply id="S2.p5.4.m4.1.1.3.cmml" xref="S2.p5.4.m4.1.1.3"><ci id="S2.p5.4.m4.1.1.3.1.cmml" xref="S2.p5.4.m4.1.1.3.1">:</ci><apply id="S2.p5.4.m4.1.1.3.2.cmml" xref="S2.p5.4.m4.1.1.3.2"><plus id="S2.p5.4.m4.1.1.3.2.1.cmml" xref="S2.p5.4.m4.1.1.3.2.1"></plus><ci id="S2.p5.4.m4.1.1.3.2.2.cmml" xref="S2.p5.4.m4.1.1.3.2.2">𝑚</ci><cn id="S2.p5.4.m4.1.1.3.2.3.cmml" type="integer" xref="S2.p5.4.m4.1.1.3.2.3">1</cn></apply><ci id="S2.p5.4.m4.1.1.3.3.cmml" xref="S2.p5.4.m4.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.4.m4.1c">u_{m+1:N}</annotation><annotation encoding="application/x-llamapun" id="S2.p5.4.m4.1d">italic_u start_POSTSUBSCRIPT italic_m + 1 : italic_N end_POSTSUBSCRIPT</annotation></semantics></math> causally in time through masked self-attention, and integrating the encoder’s output <math alttext="\zeta_{1:m}" class="ltx_Math" display="inline" id="S2.p5.5.m5.1"><semantics id="S2.p5.5.m5.1a"><msub id="S2.p5.5.m5.1.1" xref="S2.p5.5.m5.1.1.cmml"><mi id="S2.p5.5.m5.1.1.2" xref="S2.p5.5.m5.1.1.2.cmml">ζ</mi><mrow id="S2.p5.5.m5.1.1.3" xref="S2.p5.5.m5.1.1.3.cmml"><mn id="S2.p5.5.m5.1.1.3.2" xref="S2.p5.5.m5.1.1.3.2.cmml">1</mn><mo id="S2.p5.5.m5.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S2.p5.5.m5.1.1.3.1.cmml">:</mo><mi id="S2.p5.5.m5.1.1.3.3" xref="S2.p5.5.m5.1.1.3.3.cmml">m</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p5.5.m5.1b"><apply id="S2.p5.5.m5.1.1.cmml" xref="S2.p5.5.m5.1.1"><csymbol cd="ambiguous" id="S2.p5.5.m5.1.1.1.cmml" xref="S2.p5.5.m5.1.1">subscript</csymbol><ci id="S2.p5.5.m5.1.1.2.cmml" xref="S2.p5.5.m5.1.1.2">𝜁</ci><apply id="S2.p5.5.m5.1.1.3.cmml" xref="S2.p5.5.m5.1.1.3"><ci id="S2.p5.5.m5.1.1.3.1.cmml" xref="S2.p5.5.m5.1.1.3.1">:</ci><cn id="S2.p5.5.m5.1.1.3.2.cmml" type="integer" xref="S2.p5.5.m5.1.1.3.2">1</cn><ci id="S2.p5.5.m5.1.1.3.3.cmml" xref="S2.p5.5.m5.1.1.3.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.5.m5.1c">\zeta_{1:m}</annotation><annotation encoding="application/x-llamapun" id="S2.p5.5.m5.1d">italic_ζ start_POSTSUBSCRIPT 1 : italic_m end_POSTSUBSCRIPT</annotation></semantics></math> through cross-attention. Basically, the encoder output <math alttext="\zeta_{1:m}" class="ltx_Math" display="inline" id="S2.p5.6.m6.1"><semantics id="S2.p5.6.m6.1a"><msub id="S2.p5.6.m6.1.1" xref="S2.p5.6.m6.1.1.cmml"><mi id="S2.p5.6.m6.1.1.2" xref="S2.p5.6.m6.1.1.2.cmml">ζ</mi><mrow id="S2.p5.6.m6.1.1.3" xref="S2.p5.6.m6.1.1.3.cmml"><mn id="S2.p5.6.m6.1.1.3.2" xref="S2.p5.6.m6.1.1.3.2.cmml">1</mn><mo id="S2.p5.6.m6.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S2.p5.6.m6.1.1.3.1.cmml">:</mo><mi id="S2.p5.6.m6.1.1.3.3" xref="S2.p5.6.m6.1.1.3.3.cmml">m</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p5.6.m6.1b"><apply id="S2.p5.6.m6.1.1.cmml" xref="S2.p5.6.m6.1.1"><csymbol cd="ambiguous" id="S2.p5.6.m6.1.1.1.cmml" xref="S2.p5.6.m6.1.1">subscript</csymbol><ci id="S2.p5.6.m6.1.1.2.cmml" xref="S2.p5.6.m6.1.1.2">𝜁</ci><apply id="S2.p5.6.m6.1.1.3.cmml" xref="S2.p5.6.m6.1.1.3"><ci id="S2.p5.6.m6.1.1.3.1.cmml" xref="S2.p5.6.m6.1.1.3.1">:</ci><cn id="S2.p5.6.m6.1.1.3.2.cmml" type="integer" xref="S2.p5.6.m6.1.1.3.2">1</cn><ci id="S2.p5.6.m6.1.1.3.3.cmml" xref="S2.p5.6.m6.1.1.3.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.6.m6.1c">\zeta_{1:m}</annotation><annotation encoding="application/x-llamapun" id="S2.p5.6.m6.1d">italic_ζ start_POSTSUBSCRIPT 1 : italic_m end_POSTSUBSCRIPT</annotation></semantics></math> provides the decoder with the required information about the underlying dynamics, and it could be interpreted as an implicit representation (thus, a model) of the system. For a visual representation of this architecture, see Fig. 2 in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#bib.bib11" title="">11</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S2.p6">
<p class="ltx_p" id="S2.p6.1">The contribution in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#bib.bib11" title="">11</a>]</cite> has some limitations, strictly related with the chosen architecture:</p>
<ol class="ltx_enumerate" id="S2.I1">
<li class="ltx_item" id="S2.I1.ix1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">L1:</span>
<div class="ltx_para" id="S2.I1.ix1.p1">
<p class="ltx_p" id="S2.I1.ix1.p1.1">The meta-model only provides point estimates of the future outputs, instead of a probabilistic distribution that could inform on predictive uncertainty.</p>
</div>
</li>
<li class="ltx_item" id="S2.I1.ix2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">L2:</span>
<div class="ltx_para" id="S2.I1.ix2.p1">
<p class="ltx_p" id="S2.I1.ix2.p1.1">The context and query segments are required to be contiguous, according to a <em class="ltx_emph ltx_font_italic" id="S2.I1.ix2.p1.1.1">time series forecasting</em> framework.
However, in SYSID, one usually seeks <em class="ltx_emph ltx_font_italic" id="S2.I1.ix2.p1.1.2">simulation model</em> that can provide future predictions for arbitrary initial conditions.</p>
</div>
</li>
<li class="ltx_item" id="S2.I1.ix3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">L3:</span>
<div class="ltx_para" id="S2.I1.ix3.p1">
<p class="ltx_p" id="S2.I1.ix3.p1.1">The multi-head attention layers in the Transformer’s encoder has a computational complexity that scales quadratically with respect to the length of the context. This limits the length of the context sequence (roughly, order of magnitude of 1000 samples when training on a single GPU).</p>
</div>
</li>
</ol>
</div>
<div class="ltx_para" id="S2.p7">
<p class="ltx_p" id="S2.p7.1">In this paper, we aim to overcome these limitations. Specifically: L1 is tackled by formulating the learning problem in a probabilistic setting; L2 through a modification of the architecture that allows the decoder to process input and output samples previous to the query as initial conditions; and L3 by dividing the context sequence into <em class="ltx_emph ltx_font_italic" id="S2.p7.1.1">patches</em>.</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Advancing the Transformer Architecture</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">The Transformer architecture in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#bib.bib11" title="">11</a>]</cite> has been extended to address the three limitations previously mentioned. In the next paragraphs, we will systematically address each limitation, detailing the specific modifications made to the original architecture. We anticipate the final extended architecture in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#S3.F1" title="Figure 1 ‣ 3 Advancing the Transformer Architecture ‣ Enhanced Transformer architecture for in-context learning of dynamical systems"><span class="ltx_text ltx_ref_tag">1</span></a>, with the following main changes:</p>
<ul class="ltx_itemize" id="S3.I1">
<li class="ltx_item" id="S3.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i1.p1">
<p class="ltx_p" id="S3.I1.i1.p1.1">to address L1, we modify the final output layer to provide both the mean and the standard deviation of the predicted output samples;</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i2.p1">
<p class="ltx_p" id="S3.I1.i2.p1.1">to address L2, we introduce an additional layer before the decoder to handle arbitrary initial conditions of the query sequence;</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i3.p1">
<p class="ltx_p" id="S3.I1.i3.p1.1">to address L3, we split the context sequence into patches, which are individually processed by a RNN before being fed into the multi-attention blocks of the Transformer’s encode.</p>
</div>
</li>
</ul>
</div>
<figure class="ltx_figure" id="S3.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="358" id="S3.F1.g1" src="extracted/5901228/encoder_decoder_architecture.png" width="568"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F1.2.1.1" style="font-size:90%;">Figure 1</span>: </span><span class="ltx_text" id="S3.F1.3.2" style="font-size:90%;">Final Transformer architecture to handle probabilistic prediction (top right: decoder’s output is a sequence of mean and standard deviation values); non-contiguous context and query (bottom right: initial input/output values of the query fed to the decoder); long context sequences (bottom left: context sequence split into patches and processed by an RNN).</span></figcaption>
</figure>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Learning Probability Distributions</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.6">To formulate the learning problem within a probabilistic setting, we introduce the conditional probability distribution <math alttext="p(y_{m+1:N}|u_{m+1:N},u_{1:m},y_{1:m})" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mrow id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml">p</mi><mo id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p1.1.m1.1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.1.1.cmml"><mo id="S3.SS1.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p1.1.m1.1.1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.1.1.cmml"><msub id="S3.SS1.p1.1.m1.1.1.1.1.1.5" xref="S3.SS1.p1.1.m1.1.1.1.1.1.5.cmml"><mi id="S3.SS1.p1.1.m1.1.1.1.1.1.5.2" xref="S3.SS1.p1.1.m1.1.1.1.1.1.5.2.cmml">y</mi><mrow id="S3.SS1.p1.1.m1.1.1.1.1.1.5.3" xref="S3.SS1.p1.1.m1.1.1.1.1.1.5.3.cmml"><mrow id="S3.SS1.p1.1.m1.1.1.1.1.1.5.3.2" xref="S3.SS1.p1.1.m1.1.1.1.1.1.5.3.2.cmml"><mi id="S3.SS1.p1.1.m1.1.1.1.1.1.5.3.2.2" xref="S3.SS1.p1.1.m1.1.1.1.1.1.5.3.2.2.cmml">m</mi><mo id="S3.SS1.p1.1.m1.1.1.1.1.1.5.3.2.1" xref="S3.SS1.p1.1.m1.1.1.1.1.1.5.3.2.1.cmml">+</mo><mn id="S3.SS1.p1.1.m1.1.1.1.1.1.5.3.2.3" xref="S3.SS1.p1.1.m1.1.1.1.1.1.5.3.2.3.cmml">1</mn></mrow><mo id="S3.SS1.p1.1.m1.1.1.1.1.1.5.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p1.1.m1.1.1.1.1.1.5.3.1.cmml">:</mo><mi id="S3.SS1.p1.1.m1.1.1.1.1.1.5.3.3" xref="S3.SS1.p1.1.m1.1.1.1.1.1.5.3.3.cmml">N</mi></mrow></msub><mo fence="false" id="S3.SS1.p1.1.m1.1.1.1.1.1.4" xref="S3.SS1.p1.1.m1.1.1.1.1.1.4.cmml">|</mo><mrow id="S3.SS1.p1.1.m1.1.1.1.1.1.3.3" xref="S3.SS1.p1.1.m1.1.1.1.1.1.3.4.cmml"><msub id="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.1.2.cmml">u</mi><mrow id="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.1.3.cmml"><mrow id="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.1.3.2.2.cmml">m</mi><mo id="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.1.3.2.1" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.1.3.2.1.cmml">+</mo><mn id="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.1.3.2.3.cmml">1</mn></mrow><mo id="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.1.3.3.cmml">N</mi></mrow></msub><mo id="S3.SS1.p1.1.m1.1.1.1.1.1.3.3.4" xref="S3.SS1.p1.1.m1.1.1.1.1.1.3.4.cmml">,</mo><msub id="S3.SS1.p1.1.m1.1.1.1.1.1.2.2.2" xref="S3.SS1.p1.1.m1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.SS1.p1.1.m1.1.1.1.1.1.2.2.2.2" xref="S3.SS1.p1.1.m1.1.1.1.1.1.2.2.2.2.cmml">u</mi><mrow id="S3.SS1.p1.1.m1.1.1.1.1.1.2.2.2.3" xref="S3.SS1.p1.1.m1.1.1.1.1.1.2.2.2.3.cmml"><mn id="S3.SS1.p1.1.m1.1.1.1.1.1.2.2.2.3.2" xref="S3.SS1.p1.1.m1.1.1.1.1.1.2.2.2.3.2.cmml">1</mn><mo id="S3.SS1.p1.1.m1.1.1.1.1.1.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p1.1.m1.1.1.1.1.1.2.2.2.3.1.cmml">:</mo><mi id="S3.SS1.p1.1.m1.1.1.1.1.1.2.2.2.3.3" xref="S3.SS1.p1.1.m1.1.1.1.1.1.2.2.2.3.3.cmml">m</mi></mrow></msub><mo id="S3.SS1.p1.1.m1.1.1.1.1.1.3.3.5" xref="S3.SS1.p1.1.m1.1.1.1.1.1.3.4.cmml">,</mo><msub id="S3.SS1.p1.1.m1.1.1.1.1.1.3.3.3" xref="S3.SS1.p1.1.m1.1.1.1.1.1.3.3.3.cmml"><mi id="S3.SS1.p1.1.m1.1.1.1.1.1.3.3.3.2" xref="S3.SS1.p1.1.m1.1.1.1.1.1.3.3.3.2.cmml">y</mi><mrow id="S3.SS1.p1.1.m1.1.1.1.1.1.3.3.3.3" xref="S3.SS1.p1.1.m1.1.1.1.1.1.3.3.3.3.cmml"><mn id="S3.SS1.p1.1.m1.1.1.1.1.1.3.3.3.3.2" xref="S3.SS1.p1.1.m1.1.1.1.1.1.3.3.3.3.2.cmml">1</mn><mo id="S3.SS1.p1.1.m1.1.1.1.1.1.3.3.3.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p1.1.m1.1.1.1.1.1.3.3.3.3.1.cmml">:</mo><mi id="S3.SS1.p1.1.m1.1.1.1.1.1.3.3.3.3.3" xref="S3.SS1.p1.1.m1.1.1.1.1.1.3.3.3.3.3.cmml">m</mi></mrow></msub></mrow></mrow><mo id="S3.SS1.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><times id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2"></times><ci id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3">𝑝</ci><apply id="S3.SS1.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p1.1.m1.1.1.1.1.1.4.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.4">conditional</csymbol><apply id="S3.SS1.p1.1.m1.1.1.1.1.1.5.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.1.1.5.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.5">subscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.1.1.1.5.2.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.5.2">𝑦</ci><apply id="S3.SS1.p1.1.m1.1.1.1.1.1.5.3.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.5.3"><ci id="S3.SS1.p1.1.m1.1.1.1.1.1.5.3.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.5.3.1">:</ci><apply id="S3.SS1.p1.1.m1.1.1.1.1.1.5.3.2.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.5.3.2"><plus id="S3.SS1.p1.1.m1.1.1.1.1.1.5.3.2.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.5.3.2.1"></plus><ci id="S3.SS1.p1.1.m1.1.1.1.1.1.5.3.2.2.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.5.3.2.2">𝑚</ci><cn id="S3.SS1.p1.1.m1.1.1.1.1.1.5.3.2.3.cmml" type="integer" xref="S3.SS1.p1.1.m1.1.1.1.1.1.5.3.2.3">1</cn></apply><ci id="S3.SS1.p1.1.m1.1.1.1.1.1.5.3.3.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.5.3.3">𝑁</ci></apply></apply><list id="S3.SS1.p1.1.m1.1.1.1.1.1.3.4.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.3.3"><apply id="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.1.2">𝑢</ci><apply id="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.1.3"><ci id="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.1.3.1">:</ci><apply id="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.1.3.2"><plus id="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.1.3.2.1"></plus><ci id="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.1.3.2.2">𝑚</ci><cn id="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.1.3.2.3.cmml" type="integer" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.1.3.2.3">1</cn></apply><ci id="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.1.3.3">𝑁</ci></apply></apply><apply id="S3.SS1.p1.1.m1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.2.2.2.2">𝑢</ci><apply id="S3.SS1.p1.1.m1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.2.2.2.3"><ci id="S3.SS1.p1.1.m1.1.1.1.1.1.2.2.2.3.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.2.2.2.3.1">:</ci><cn id="S3.SS1.p1.1.m1.1.1.1.1.1.2.2.2.3.2.cmml" type="integer" xref="S3.SS1.p1.1.m1.1.1.1.1.1.2.2.2.3.2">1</cn><ci id="S3.SS1.p1.1.m1.1.1.1.1.1.2.2.2.3.3.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.2.2.2.3.3">𝑚</ci></apply></apply><apply id="S3.SS1.p1.1.m1.1.1.1.1.1.3.3.3.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.3.3.3.2">𝑦</ci><apply id="S3.SS1.p1.1.m1.1.1.1.1.1.3.3.3.3.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.3.3.3.3"><ci id="S3.SS1.p1.1.m1.1.1.1.1.1.3.3.3.3.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.3.3.3.3.1">:</ci><cn id="S3.SS1.p1.1.m1.1.1.1.1.1.3.3.3.3.2.cmml" type="integer" xref="S3.SS1.p1.1.m1.1.1.1.1.1.3.3.3.3.2">1</cn><ci id="S3.SS1.p1.1.m1.1.1.1.1.1.3.3.3.3.3.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.3.3.3.3.3">𝑚</ci></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">p(y_{m+1:N}|u_{m+1:N},u_{1:m},y_{1:m})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">italic_p ( italic_y start_POSTSUBSCRIPT italic_m + 1 : italic_N end_POSTSUBSCRIPT | italic_u start_POSTSUBSCRIPT italic_m + 1 : italic_N end_POSTSUBSCRIPT , italic_u start_POSTSUBSCRIPT 1 : italic_m end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 1 : italic_m end_POSTSUBSCRIPT )</annotation></semantics></math> of the future output sequence <math alttext="y_{m+1:N}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><msub id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><mi id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml">y</mi><mrow id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml"><mrow id="S3.SS1.p1.2.m2.1.1.3.2" xref="S3.SS1.p1.2.m2.1.1.3.2.cmml"><mi id="S3.SS1.p1.2.m2.1.1.3.2.2" xref="S3.SS1.p1.2.m2.1.1.3.2.2.cmml">m</mi><mo id="S3.SS1.p1.2.m2.1.1.3.2.1" xref="S3.SS1.p1.2.m2.1.1.3.2.1.cmml">+</mo><mn id="S3.SS1.p1.2.m2.1.1.3.2.3" xref="S3.SS1.p1.2.m2.1.1.3.2.3.cmml">1</mn></mrow><mo id="S3.SS1.p1.2.m2.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p1.2.m2.1.1.3.1.cmml">:</mo><mi id="S3.SS1.p1.2.m2.1.1.3.3" xref="S3.SS1.p1.2.m2.1.1.3.3.cmml">N</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2">𝑦</ci><apply id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3"><ci id="S3.SS1.p1.2.m2.1.1.3.1.cmml" xref="S3.SS1.p1.2.m2.1.1.3.1">:</ci><apply id="S3.SS1.p1.2.m2.1.1.3.2.cmml" xref="S3.SS1.p1.2.m2.1.1.3.2"><plus id="S3.SS1.p1.2.m2.1.1.3.2.1.cmml" xref="S3.SS1.p1.2.m2.1.1.3.2.1"></plus><ci id="S3.SS1.p1.2.m2.1.1.3.2.2.cmml" xref="S3.SS1.p1.2.m2.1.1.3.2.2">𝑚</ci><cn id="S3.SS1.p1.2.m2.1.1.3.2.3.cmml" type="integer" xref="S3.SS1.p1.2.m2.1.1.3.2.3">1</cn></apply><ci id="S3.SS1.p1.2.m2.1.1.3.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">y_{m+1:N}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">italic_y start_POSTSUBSCRIPT italic_m + 1 : italic_N end_POSTSUBSCRIPT</annotation></semantics></math>, given the query input <math alttext="u_{m+1:N}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><msub id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><mi id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">u</mi><mrow id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml"><mrow id="S3.SS1.p1.3.m3.1.1.3.2" xref="S3.SS1.p1.3.m3.1.1.3.2.cmml"><mi id="S3.SS1.p1.3.m3.1.1.3.2.2" xref="S3.SS1.p1.3.m3.1.1.3.2.2.cmml">m</mi><mo id="S3.SS1.p1.3.m3.1.1.3.2.1" xref="S3.SS1.p1.3.m3.1.1.3.2.1.cmml">+</mo><mn id="S3.SS1.p1.3.m3.1.1.3.2.3" xref="S3.SS1.p1.3.m3.1.1.3.2.3.cmml">1</mn></mrow><mo id="S3.SS1.p1.3.m3.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p1.3.m3.1.1.3.1.cmml">:</mo><mi id="S3.SS1.p1.3.m3.1.1.3.3" xref="S3.SS1.p1.3.m3.1.1.3.3.cmml">N</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2">𝑢</ci><apply id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3"><ci id="S3.SS1.p1.3.m3.1.1.3.1.cmml" xref="S3.SS1.p1.3.m3.1.1.3.1">:</ci><apply id="S3.SS1.p1.3.m3.1.1.3.2.cmml" xref="S3.SS1.p1.3.m3.1.1.3.2"><plus id="S3.SS1.p1.3.m3.1.1.3.2.1.cmml" xref="S3.SS1.p1.3.m3.1.1.3.2.1"></plus><ci id="S3.SS1.p1.3.m3.1.1.3.2.2.cmml" xref="S3.SS1.p1.3.m3.1.1.3.2.2">𝑚</ci><cn id="S3.SS1.p1.3.m3.1.1.3.2.3.cmml" type="integer" xref="S3.SS1.p1.3.m3.1.1.3.2.3">1</cn></apply><ci id="S3.SS1.p1.3.m3.1.1.3.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">u_{m+1:N}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">italic_u start_POSTSUBSCRIPT italic_m + 1 : italic_N end_POSTSUBSCRIPT</annotation></semantics></math> and the context data <math alttext="u_{1:m},y_{1:m}" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.2"><semantics id="S3.SS1.p1.4.m4.2a"><mrow id="S3.SS1.p1.4.m4.2.2.2" xref="S3.SS1.p1.4.m4.2.2.3.cmml"><msub id="S3.SS1.p1.4.m4.1.1.1.1" xref="S3.SS1.p1.4.m4.1.1.1.1.cmml"><mi id="S3.SS1.p1.4.m4.1.1.1.1.2" xref="S3.SS1.p1.4.m4.1.1.1.1.2.cmml">u</mi><mrow id="S3.SS1.p1.4.m4.1.1.1.1.3" xref="S3.SS1.p1.4.m4.1.1.1.1.3.cmml"><mn id="S3.SS1.p1.4.m4.1.1.1.1.3.2" xref="S3.SS1.p1.4.m4.1.1.1.1.3.2.cmml">1</mn><mo id="S3.SS1.p1.4.m4.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p1.4.m4.1.1.1.1.3.1.cmml">:</mo><mi id="S3.SS1.p1.4.m4.1.1.1.1.3.3" xref="S3.SS1.p1.4.m4.1.1.1.1.3.3.cmml">m</mi></mrow></msub><mo id="S3.SS1.p1.4.m4.2.2.2.3" xref="S3.SS1.p1.4.m4.2.2.3.cmml">,</mo><msub id="S3.SS1.p1.4.m4.2.2.2.2" xref="S3.SS1.p1.4.m4.2.2.2.2.cmml"><mi id="S3.SS1.p1.4.m4.2.2.2.2.2" xref="S3.SS1.p1.4.m4.2.2.2.2.2.cmml">y</mi><mrow id="S3.SS1.p1.4.m4.2.2.2.2.3" xref="S3.SS1.p1.4.m4.2.2.2.2.3.cmml"><mn id="S3.SS1.p1.4.m4.2.2.2.2.3.2" xref="S3.SS1.p1.4.m4.2.2.2.2.3.2.cmml">1</mn><mo id="S3.SS1.p1.4.m4.2.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p1.4.m4.2.2.2.2.3.1.cmml">:</mo><mi id="S3.SS1.p1.4.m4.2.2.2.2.3.3" xref="S3.SS1.p1.4.m4.2.2.2.2.3.3.cmml">m</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.2b"><list id="S3.SS1.p1.4.m4.2.2.3.cmml" xref="S3.SS1.p1.4.m4.2.2.2"><apply id="S3.SS1.p1.4.m4.1.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1.2">𝑢</ci><apply id="S3.SS1.p1.4.m4.1.1.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1.3"><ci id="S3.SS1.p1.4.m4.1.1.1.1.3.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1.3.1">:</ci><cn id="S3.SS1.p1.4.m4.1.1.1.1.3.2.cmml" type="integer" xref="S3.SS1.p1.4.m4.1.1.1.1.3.2">1</cn><ci id="S3.SS1.p1.4.m4.1.1.1.1.3.3.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1.3.3">𝑚</ci></apply></apply><apply id="S3.SS1.p1.4.m4.2.2.2.2.cmml" xref="S3.SS1.p1.4.m4.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.2.2.2.2.1.cmml" xref="S3.SS1.p1.4.m4.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.4.m4.2.2.2.2.2.cmml" xref="S3.SS1.p1.4.m4.2.2.2.2.2">𝑦</ci><apply id="S3.SS1.p1.4.m4.2.2.2.2.3.cmml" xref="S3.SS1.p1.4.m4.2.2.2.2.3"><ci id="S3.SS1.p1.4.m4.2.2.2.2.3.1.cmml" xref="S3.SS1.p1.4.m4.2.2.2.2.3.1">:</ci><cn id="S3.SS1.p1.4.m4.2.2.2.2.3.2.cmml" type="integer" xref="S3.SS1.p1.4.m4.2.2.2.2.3.2">1</cn><ci id="S3.SS1.p1.4.m4.2.2.2.2.3.3.cmml" xref="S3.SS1.p1.4.m4.2.2.2.2.3.3">𝑚</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.2c">u_{1:m},y_{1:m}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.2d">italic_u start_POSTSUBSCRIPT 1 : italic_m end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 1 : italic_m end_POSTSUBSCRIPT</annotation></semantics></math>. For compactness, we denote by <math alttext="X" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.1"><semantics id="S3.SS1.p1.5.m5.1a"><mi id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">X</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.1d">italic_X</annotation></semantics></math> the conditioning variables <math alttext="u_{m+1:N},u_{1:m},y_{1:m}" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m6.3"><semantics id="S3.SS1.p1.6.m6.3a"><mrow id="S3.SS1.p1.6.m6.3.3.3" xref="S3.SS1.p1.6.m6.3.3.4.cmml"><msub id="S3.SS1.p1.6.m6.1.1.1.1" xref="S3.SS1.p1.6.m6.1.1.1.1.cmml"><mi id="S3.SS1.p1.6.m6.1.1.1.1.2" xref="S3.SS1.p1.6.m6.1.1.1.1.2.cmml">u</mi><mrow id="S3.SS1.p1.6.m6.1.1.1.1.3" xref="S3.SS1.p1.6.m6.1.1.1.1.3.cmml"><mrow id="S3.SS1.p1.6.m6.1.1.1.1.3.2" xref="S3.SS1.p1.6.m6.1.1.1.1.3.2.cmml"><mi id="S3.SS1.p1.6.m6.1.1.1.1.3.2.2" xref="S3.SS1.p1.6.m6.1.1.1.1.3.2.2.cmml">m</mi><mo id="S3.SS1.p1.6.m6.1.1.1.1.3.2.1" xref="S3.SS1.p1.6.m6.1.1.1.1.3.2.1.cmml">+</mo><mn id="S3.SS1.p1.6.m6.1.1.1.1.3.2.3" xref="S3.SS1.p1.6.m6.1.1.1.1.3.2.3.cmml">1</mn></mrow><mo id="S3.SS1.p1.6.m6.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p1.6.m6.1.1.1.1.3.1.cmml">:</mo><mi id="S3.SS1.p1.6.m6.1.1.1.1.3.3" xref="S3.SS1.p1.6.m6.1.1.1.1.3.3.cmml">N</mi></mrow></msub><mo id="S3.SS1.p1.6.m6.3.3.3.4" xref="S3.SS1.p1.6.m6.3.3.4.cmml">,</mo><msub id="S3.SS1.p1.6.m6.2.2.2.2" xref="S3.SS1.p1.6.m6.2.2.2.2.cmml"><mi id="S3.SS1.p1.6.m6.2.2.2.2.2" xref="S3.SS1.p1.6.m6.2.2.2.2.2.cmml">u</mi><mrow id="S3.SS1.p1.6.m6.2.2.2.2.3" xref="S3.SS1.p1.6.m6.2.2.2.2.3.cmml"><mn id="S3.SS1.p1.6.m6.2.2.2.2.3.2" xref="S3.SS1.p1.6.m6.2.2.2.2.3.2.cmml">1</mn><mo id="S3.SS1.p1.6.m6.2.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p1.6.m6.2.2.2.2.3.1.cmml">:</mo><mi id="S3.SS1.p1.6.m6.2.2.2.2.3.3" xref="S3.SS1.p1.6.m6.2.2.2.2.3.3.cmml">m</mi></mrow></msub><mo id="S3.SS1.p1.6.m6.3.3.3.5" xref="S3.SS1.p1.6.m6.3.3.4.cmml">,</mo><msub id="S3.SS1.p1.6.m6.3.3.3.3" xref="S3.SS1.p1.6.m6.3.3.3.3.cmml"><mi id="S3.SS1.p1.6.m6.3.3.3.3.2" xref="S3.SS1.p1.6.m6.3.3.3.3.2.cmml">y</mi><mrow id="S3.SS1.p1.6.m6.3.3.3.3.3" xref="S3.SS1.p1.6.m6.3.3.3.3.3.cmml"><mn id="S3.SS1.p1.6.m6.3.3.3.3.3.2" xref="S3.SS1.p1.6.m6.3.3.3.3.3.2.cmml">1</mn><mo id="S3.SS1.p1.6.m6.3.3.3.3.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p1.6.m6.3.3.3.3.3.1.cmml">:</mo><mi id="S3.SS1.p1.6.m6.3.3.3.3.3.3" xref="S3.SS1.p1.6.m6.3.3.3.3.3.3.cmml">m</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.3b"><list id="S3.SS1.p1.6.m6.3.3.4.cmml" xref="S3.SS1.p1.6.m6.3.3.3"><apply id="S3.SS1.p1.6.m6.1.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.6.m6.1.1.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.1.1.2">𝑢</ci><apply id="S3.SS1.p1.6.m6.1.1.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.1.1.3"><ci id="S3.SS1.p1.6.m6.1.1.1.1.3.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1.1.3.1">:</ci><apply id="S3.SS1.p1.6.m6.1.1.1.1.3.2.cmml" xref="S3.SS1.p1.6.m6.1.1.1.1.3.2"><plus id="S3.SS1.p1.6.m6.1.1.1.1.3.2.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1.1.3.2.1"></plus><ci id="S3.SS1.p1.6.m6.1.1.1.1.3.2.2.cmml" xref="S3.SS1.p1.6.m6.1.1.1.1.3.2.2">𝑚</ci><cn id="S3.SS1.p1.6.m6.1.1.1.1.3.2.3.cmml" type="integer" xref="S3.SS1.p1.6.m6.1.1.1.1.3.2.3">1</cn></apply><ci id="S3.SS1.p1.6.m6.1.1.1.1.3.3.cmml" xref="S3.SS1.p1.6.m6.1.1.1.1.3.3">𝑁</ci></apply></apply><apply id="S3.SS1.p1.6.m6.2.2.2.2.cmml" xref="S3.SS1.p1.6.m6.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.2.2.2.2.1.cmml" xref="S3.SS1.p1.6.m6.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.6.m6.2.2.2.2.2.cmml" xref="S3.SS1.p1.6.m6.2.2.2.2.2">𝑢</ci><apply id="S3.SS1.p1.6.m6.2.2.2.2.3.cmml" xref="S3.SS1.p1.6.m6.2.2.2.2.3"><ci id="S3.SS1.p1.6.m6.2.2.2.2.3.1.cmml" xref="S3.SS1.p1.6.m6.2.2.2.2.3.1">:</ci><cn id="S3.SS1.p1.6.m6.2.2.2.2.3.2.cmml" type="integer" xref="S3.SS1.p1.6.m6.2.2.2.2.3.2">1</cn><ci id="S3.SS1.p1.6.m6.2.2.2.2.3.3.cmml" xref="S3.SS1.p1.6.m6.2.2.2.2.3.3">𝑚</ci></apply></apply><apply id="S3.SS1.p1.6.m6.3.3.3.3.cmml" xref="S3.SS1.p1.6.m6.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.3.3.3.3.1.cmml" xref="S3.SS1.p1.6.m6.3.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.6.m6.3.3.3.3.2.cmml" xref="S3.SS1.p1.6.m6.3.3.3.3.2">𝑦</ci><apply id="S3.SS1.p1.6.m6.3.3.3.3.3.cmml" xref="S3.SS1.p1.6.m6.3.3.3.3.3"><ci id="S3.SS1.p1.6.m6.3.3.3.3.3.1.cmml" xref="S3.SS1.p1.6.m6.3.3.3.3.3.1">:</ci><cn id="S3.SS1.p1.6.m6.3.3.3.3.3.2.cmml" type="integer" xref="S3.SS1.p1.6.m6.3.3.3.3.3.2">1</cn><ci id="S3.SS1.p1.6.m6.3.3.3.3.3.3.cmml" xref="S3.SS1.p1.6.m6.3.3.3.3.3.3">𝑚</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.3c">u_{m+1:N},u_{1:m},y_{1:m}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m6.3d">italic_u start_POSTSUBSCRIPT italic_m + 1 : italic_N end_POSTSUBSCRIPT , italic_u start_POSTSUBSCRIPT 1 : italic_m end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 1 : italic_m end_POSTSUBSCRIPT</annotation></semantics></math> hereafter.</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.6">Our goal is to approximate <math alttext="p(y_{m+1:N}|X)" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><mrow id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml"><mi id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3.cmml">p</mi><mo id="S3.SS1.p2.1.m1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p2.1.m1.1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.1.1.cmml"><mo id="S3.SS1.p2.1.m1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p2.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p2.1.m1.1.1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.1.1.cmml"><msub id="S3.SS1.p2.1.m1.1.1.1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.1.1.1.2.cmml"><mi id="S3.SS1.p2.1.m1.1.1.1.1.1.2.2" xref="S3.SS1.p2.1.m1.1.1.1.1.1.2.2.cmml">y</mi><mrow id="S3.SS1.p2.1.m1.1.1.1.1.1.2.3" xref="S3.SS1.p2.1.m1.1.1.1.1.1.2.3.cmml"><mrow id="S3.SS1.p2.1.m1.1.1.1.1.1.2.3.2" xref="S3.SS1.p2.1.m1.1.1.1.1.1.2.3.2.cmml"><mi id="S3.SS1.p2.1.m1.1.1.1.1.1.2.3.2.2" xref="S3.SS1.p2.1.m1.1.1.1.1.1.2.3.2.2.cmml">m</mi><mo id="S3.SS1.p2.1.m1.1.1.1.1.1.2.3.2.1" xref="S3.SS1.p2.1.m1.1.1.1.1.1.2.3.2.1.cmml">+</mo><mn id="S3.SS1.p2.1.m1.1.1.1.1.1.2.3.2.3" xref="S3.SS1.p2.1.m1.1.1.1.1.1.2.3.2.3.cmml">1</mn></mrow><mo id="S3.SS1.p2.1.m1.1.1.1.1.1.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p2.1.m1.1.1.1.1.1.2.3.1.cmml">:</mo><mi id="S3.SS1.p2.1.m1.1.1.1.1.1.2.3.3" xref="S3.SS1.p2.1.m1.1.1.1.1.1.2.3.3.cmml">N</mi></mrow></msub><mo fence="false" id="S3.SS1.p2.1.m1.1.1.1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS1.p2.1.m1.1.1.1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.1.1.1.3.cmml">X</mi></mrow><mo id="S3.SS1.p2.1.m1.1.1.1.1.3" stretchy="false" xref="S3.SS1.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1"><times id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2"></times><ci id="S3.SS1.p2.1.m1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3">𝑝</ci><apply id="S3.SS1.p2.1.m1.1.1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p2.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.SS1.p2.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.2.2">𝑦</ci><apply id="S3.SS1.p2.1.m1.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.2.3"><ci id="S3.SS1.p2.1.m1.1.1.1.1.1.2.3.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.2.3.1">:</ci><apply id="S3.SS1.p2.1.m1.1.1.1.1.1.2.3.2.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.2.3.2"><plus id="S3.SS1.p2.1.m1.1.1.1.1.1.2.3.2.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.2.3.2.1"></plus><ci id="S3.SS1.p2.1.m1.1.1.1.1.1.2.3.2.2.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.2.3.2.2">𝑚</ci><cn id="S3.SS1.p2.1.m1.1.1.1.1.1.2.3.2.3.cmml" type="integer" xref="S3.SS1.p2.1.m1.1.1.1.1.1.2.3.2.3">1</cn></apply><ci id="S3.SS1.p2.1.m1.1.1.1.1.1.2.3.3.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.2.3.3">𝑁</ci></apply></apply><ci id="S3.SS1.p2.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.3">𝑋</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">p(y_{m+1:N}|X)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">italic_p ( italic_y start_POSTSUBSCRIPT italic_m + 1 : italic_N end_POSTSUBSCRIPT | italic_X )</annotation></semantics></math> with a parametric distribution <math alttext="q_{\phi}(y_{m+1:N}|X)" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><mrow id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml"><msub id="S3.SS1.p2.2.m2.1.1.3" xref="S3.SS1.p2.2.m2.1.1.3.cmml"><mi id="S3.SS1.p2.2.m2.1.1.3.2" xref="S3.SS1.p2.2.m2.1.1.3.2.cmml">q</mi><mi id="S3.SS1.p2.2.m2.1.1.3.3" xref="S3.SS1.p2.2.m2.1.1.3.3.cmml">ϕ</mi></msub><mo id="S3.SS1.p2.2.m2.1.1.2" xref="S3.SS1.p2.2.m2.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p2.2.m2.1.1.1.1" xref="S3.SS1.p2.2.m2.1.1.1.1.1.cmml"><mo id="S3.SS1.p2.2.m2.1.1.1.1.2" stretchy="false" xref="S3.SS1.p2.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p2.2.m2.1.1.1.1.1" xref="S3.SS1.p2.2.m2.1.1.1.1.1.cmml"><msub id="S3.SS1.p2.2.m2.1.1.1.1.1.2" xref="S3.SS1.p2.2.m2.1.1.1.1.1.2.cmml"><mi id="S3.SS1.p2.2.m2.1.1.1.1.1.2.2" xref="S3.SS1.p2.2.m2.1.1.1.1.1.2.2.cmml">y</mi><mrow id="S3.SS1.p2.2.m2.1.1.1.1.1.2.3" xref="S3.SS1.p2.2.m2.1.1.1.1.1.2.3.cmml"><mrow id="S3.SS1.p2.2.m2.1.1.1.1.1.2.3.2" xref="S3.SS1.p2.2.m2.1.1.1.1.1.2.3.2.cmml"><mi id="S3.SS1.p2.2.m2.1.1.1.1.1.2.3.2.2" xref="S3.SS1.p2.2.m2.1.1.1.1.1.2.3.2.2.cmml">m</mi><mo id="S3.SS1.p2.2.m2.1.1.1.1.1.2.3.2.1" xref="S3.SS1.p2.2.m2.1.1.1.1.1.2.3.2.1.cmml">+</mo><mn id="S3.SS1.p2.2.m2.1.1.1.1.1.2.3.2.3" xref="S3.SS1.p2.2.m2.1.1.1.1.1.2.3.2.3.cmml">1</mn></mrow><mo id="S3.SS1.p2.2.m2.1.1.1.1.1.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p2.2.m2.1.1.1.1.1.2.3.1.cmml">:</mo><mi id="S3.SS1.p2.2.m2.1.1.1.1.1.2.3.3" xref="S3.SS1.p2.2.m2.1.1.1.1.1.2.3.3.cmml">N</mi></mrow></msub><mo fence="false" id="S3.SS1.p2.2.m2.1.1.1.1.1.1" xref="S3.SS1.p2.2.m2.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS1.p2.2.m2.1.1.1.1.1.3" xref="S3.SS1.p2.2.m2.1.1.1.1.1.3.cmml">X</mi></mrow><mo id="S3.SS1.p2.2.m2.1.1.1.1.3" stretchy="false" xref="S3.SS1.p2.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"><times id="S3.SS1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.2"></times><apply id="S3.SS1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.3.1.cmml" xref="S3.SS1.p2.2.m2.1.1.3">subscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.3.2.cmml" xref="S3.SS1.p2.2.m2.1.1.3.2">𝑞</ci><ci id="S3.SS1.p2.2.m2.1.1.3.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3.3">italic-ϕ</ci></apply><apply id="S3.SS1.p2.2.m2.1.1.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p2.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1.1">conditional</csymbol><apply id="S3.SS1.p2.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1.2.2">𝑦</ci><apply id="S3.SS1.p2.2.m2.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1.2.3"><ci id="S3.SS1.p2.2.m2.1.1.1.1.1.2.3.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1.2.3.1">:</ci><apply id="S3.SS1.p2.2.m2.1.1.1.1.1.2.3.2.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1.2.3.2"><plus id="S3.SS1.p2.2.m2.1.1.1.1.1.2.3.2.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1.2.3.2.1"></plus><ci id="S3.SS1.p2.2.m2.1.1.1.1.1.2.3.2.2.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1.2.3.2.2">𝑚</ci><cn id="S3.SS1.p2.2.m2.1.1.1.1.1.2.3.2.3.cmml" type="integer" xref="S3.SS1.p2.2.m2.1.1.1.1.1.2.3.2.3">1</cn></apply><ci id="S3.SS1.p2.2.m2.1.1.1.1.1.2.3.3.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1.2.3.3">𝑁</ci></apply></apply><ci id="S3.SS1.p2.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1.3">𝑋</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">q_{\phi}(y_{m+1:N}|X)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">italic_q start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_m + 1 : italic_N end_POSTSUBSCRIPT | italic_X )</annotation></semantics></math> having free parameters <math alttext="\phi" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.1"><semantics id="S3.SS1.p2.3.m3.1a"><mi id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.1d">italic_ϕ</annotation></semantics></math>. To this end, we introduce the Kullback-Leibler divergence <math alttext="\text{KL}(p\parallel q_{\phi})" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m4.1"><semantics id="S3.SS1.p2.4.m4.1a"><mrow id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml"><mtext id="S3.SS1.p2.4.m4.1.1.3" xref="S3.SS1.p2.4.m4.1.1.3a.cmml">KL</mtext><mo id="S3.SS1.p2.4.m4.1.1.2" xref="S3.SS1.p2.4.m4.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p2.4.m4.1.1.1.1" xref="S3.SS1.p2.4.m4.1.1.1.1.1.cmml"><mo id="S3.SS1.p2.4.m4.1.1.1.1.2" stretchy="false" xref="S3.SS1.p2.4.m4.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p2.4.m4.1.1.1.1.1" xref="S3.SS1.p2.4.m4.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.4.m4.1.1.1.1.1.2" xref="S3.SS1.p2.4.m4.1.1.1.1.1.2.cmml">p</mi><mo id="S3.SS1.p2.4.m4.1.1.1.1.1.1" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1.cmml">∥</mo><msub id="S3.SS1.p2.4.m4.1.1.1.1.1.3" xref="S3.SS1.p2.4.m4.1.1.1.1.1.3.cmml"><mi id="S3.SS1.p2.4.m4.1.1.1.1.1.3.2" xref="S3.SS1.p2.4.m4.1.1.1.1.1.3.2.cmml">q</mi><mi id="S3.SS1.p2.4.m4.1.1.1.1.1.3.3" xref="S3.SS1.p2.4.m4.1.1.1.1.1.3.3.cmml">ϕ</mi></msub></mrow><mo id="S3.SS1.p2.4.m4.1.1.1.1.3" stretchy="false" xref="S3.SS1.p2.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><apply id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1"><times id="S3.SS1.p2.4.m4.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.2"></times><ci id="S3.SS1.p2.4.m4.1.1.3a.cmml" xref="S3.SS1.p2.4.m4.1.1.3"><mtext id="S3.SS1.p2.4.m4.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3">KL</mtext></ci><apply id="S3.SS1.p2.4.m4.1.1.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p2.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS1.p2.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1.2">𝑝</ci><apply id="S3.SS1.p2.4.m4.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.1.1.1.3.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS1.p2.4.m4.1.1.1.1.1.3.2.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1.3.2">𝑞</ci><ci id="S3.SS1.p2.4.m4.1.1.1.1.1.3.3.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1.3.3">italic-ϕ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">\text{KL}(p\parallel q_{\phi})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m4.1d">KL ( italic_p ∥ italic_q start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT )</annotation></semantics></math> between <math alttext="p" class="ltx_Math" display="inline" id="S3.SS1.p2.5.m5.1"><semantics id="S3.SS1.p2.5.m5.1a"><mi id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><ci id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">p</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.5.m5.1d">italic_p</annotation></semantics></math> and <math alttext="q_{\phi}" class="ltx_Math" display="inline" id="S3.SS1.p2.6.m6.1"><semantics id="S3.SS1.p2.6.m6.1a"><msub id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml"><mi id="S3.SS1.p2.6.m6.1.1.2" xref="S3.SS1.p2.6.m6.1.1.2.cmml">q</mi><mi id="S3.SS1.p2.6.m6.1.1.3" xref="S3.SS1.p2.6.m6.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.1b"><apply id="S3.SS1.p2.6.m6.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.1.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.p2.6.m6.1.1.2.cmml" xref="S3.SS1.p2.6.m6.1.1.2">𝑞</ci><ci id="S3.SS1.p2.6.m6.1.1.3.cmml" xref="S3.SS1.p2.6.m6.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.1c">q_{\phi}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.6.m6.1d">italic_q start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{KL}(p\parallel q_{\phi})=\mathbb{E}_{p({y_{m+1:N}}|X)}\left[\log\frac{p(%
y_{m+1:N}|X)}{q_{\phi}(y_{m+1:N}|X)}\right]." class="ltx_Math" display="block" id="S3.E3.m1.4"><semantics id="S3.E3.m1.4a"><mrow id="S3.E3.m1.4.4.1" xref="S3.E3.m1.4.4.1.1.cmml"><mrow id="S3.E3.m1.4.4.1.1" xref="S3.E3.m1.4.4.1.1.cmml"><mrow id="S3.E3.m1.4.4.1.1.1" xref="S3.E3.m1.4.4.1.1.1.cmml"><mtext id="S3.E3.m1.4.4.1.1.1.3" xref="S3.E3.m1.4.4.1.1.1.3a.cmml">KL</mtext><mo id="S3.E3.m1.4.4.1.1.1.2" xref="S3.E3.m1.4.4.1.1.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.4.4.1.1.1.1.1" xref="S3.E3.m1.4.4.1.1.1.1.1.1.cmml"><mo id="S3.E3.m1.4.4.1.1.1.1.1.2" stretchy="false" xref="S3.E3.m1.4.4.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.4.4.1.1.1.1.1.1" xref="S3.E3.m1.4.4.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.4.4.1.1.1.1.1.1.2" xref="S3.E3.m1.4.4.1.1.1.1.1.1.2.cmml">p</mi><mo id="S3.E3.m1.4.4.1.1.1.1.1.1.1" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.cmml">∥</mo><msub id="S3.E3.m1.4.4.1.1.1.1.1.1.3" xref="S3.E3.m1.4.4.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m1.4.4.1.1.1.1.1.1.3.2" xref="S3.E3.m1.4.4.1.1.1.1.1.1.3.2.cmml">q</mi><mi id="S3.E3.m1.4.4.1.1.1.1.1.1.3.3" xref="S3.E3.m1.4.4.1.1.1.1.1.1.3.3.cmml">ϕ</mi></msub></mrow><mo id="S3.E3.m1.4.4.1.1.1.1.1.3" stretchy="false" xref="S3.E3.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.4.4.1.1.3" xref="S3.E3.m1.4.4.1.1.3.cmml">=</mo><mrow id="S3.E3.m1.4.4.1.1.2" xref="S3.E3.m1.4.4.1.1.2.cmml"><msub id="S3.E3.m1.4.4.1.1.2.3" xref="S3.E3.m1.4.4.1.1.2.3.cmml"><mi id="S3.E3.m1.4.4.1.1.2.3.2" xref="S3.E3.m1.4.4.1.1.2.3.2.cmml">𝔼</mi><mrow id="S3.E3.m1.1.1.1" xref="S3.E3.m1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.3" xref="S3.E3.m1.1.1.1.3.cmml">p</mi><mo id="S3.E3.m1.1.1.1.2" xref="S3.E3.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.cmml"><mo id="S3.E3.m1.1.1.1.1.1.2" stretchy="false" xref="S3.E3.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.cmml"><msub id="S3.E3.m1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.2.2" xref="S3.E3.m1.1.1.1.1.1.1.2.2.cmml">y</mi><mrow id="S3.E3.m1.1.1.1.1.1.1.2.3" xref="S3.E3.m1.1.1.1.1.1.1.2.3.cmml"><mrow id="S3.E3.m1.1.1.1.1.1.1.2.3.2" xref="S3.E3.m1.1.1.1.1.1.1.2.3.2.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.2.3.2.2" xref="S3.E3.m1.1.1.1.1.1.1.2.3.2.2.cmml">m</mi><mo id="S3.E3.m1.1.1.1.1.1.1.2.3.2.1" xref="S3.E3.m1.1.1.1.1.1.1.2.3.2.1.cmml">+</mo><mn id="S3.E3.m1.1.1.1.1.1.1.2.3.2.3" xref="S3.E3.m1.1.1.1.1.1.1.2.3.2.3.cmml">1</mn></mrow><mo id="S3.E3.m1.1.1.1.1.1.1.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.E3.m1.1.1.1.1.1.1.2.3.1.cmml">:</mo><mi id="S3.E3.m1.1.1.1.1.1.1.2.3.3" xref="S3.E3.m1.1.1.1.1.1.1.2.3.3.cmml">N</mi></mrow></msub><mo fence="false" id="S3.E3.m1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.E3.m1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.3.cmml">X</mi></mrow><mo id="S3.E3.m1.1.1.1.1.1.3" stretchy="false" xref="S3.E3.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msub><mo id="S3.E3.m1.4.4.1.1.2.2" xref="S3.E3.m1.4.4.1.1.2.2.cmml">⁢</mo><mrow id="S3.E3.m1.4.4.1.1.2.1.1" xref="S3.E3.m1.4.4.1.1.2.1.2.cmml"><mo id="S3.E3.m1.4.4.1.1.2.1.1.2" xref="S3.E3.m1.4.4.1.1.2.1.2.1.cmml">[</mo><mrow id="S3.E3.m1.4.4.1.1.2.1.1.1" xref="S3.E3.m1.4.4.1.1.2.1.1.1.cmml"><mi id="S3.E3.m1.4.4.1.1.2.1.1.1.1" xref="S3.E3.m1.4.4.1.1.2.1.1.1.1.cmml">log</mi><mo id="S3.E3.m1.4.4.1.1.2.1.1.1a" lspace="0.167em" xref="S3.E3.m1.4.4.1.1.2.1.1.1.cmml">⁡</mo><mfrac id="S3.E3.m1.3.3" xref="S3.E3.m1.3.3.cmml"><mrow id="S3.E3.m1.2.2.1" xref="S3.E3.m1.2.2.1.cmml"><mi id="S3.E3.m1.2.2.1.3" xref="S3.E3.m1.2.2.1.3.cmml">p</mi><mo id="S3.E3.m1.2.2.1.2" xref="S3.E3.m1.2.2.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.2.2.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.cmml"><mo id="S3.E3.m1.2.2.1.1.1.2" stretchy="false" xref="S3.E3.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.2.2.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.cmml"><msub id="S3.E3.m1.2.2.1.1.1.1.2" xref="S3.E3.m1.2.2.1.1.1.1.2.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.2.2" xref="S3.E3.m1.2.2.1.1.1.1.2.2.cmml">y</mi><mrow id="S3.E3.m1.2.2.1.1.1.1.2.3" xref="S3.E3.m1.2.2.1.1.1.1.2.3.cmml"><mrow id="S3.E3.m1.2.2.1.1.1.1.2.3.2" xref="S3.E3.m1.2.2.1.1.1.1.2.3.2.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.2.3.2.2" xref="S3.E3.m1.2.2.1.1.1.1.2.3.2.2.cmml">m</mi><mo id="S3.E3.m1.2.2.1.1.1.1.2.3.2.1" xref="S3.E3.m1.2.2.1.1.1.1.2.3.2.1.cmml">+</mo><mn id="S3.E3.m1.2.2.1.1.1.1.2.3.2.3" xref="S3.E3.m1.2.2.1.1.1.1.2.3.2.3.cmml">1</mn></mrow><mo id="S3.E3.m1.2.2.1.1.1.1.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.E3.m1.2.2.1.1.1.1.2.3.1.cmml">:</mo><mi id="S3.E3.m1.2.2.1.1.1.1.2.3.3" xref="S3.E3.m1.2.2.1.1.1.1.2.3.3.cmml">N</mi></mrow></msub><mo fence="false" id="S3.E3.m1.2.2.1.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.cmml">|</mo><mi id="S3.E3.m1.2.2.1.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.1.3.cmml">X</mi></mrow><mo id="S3.E3.m1.2.2.1.1.1.3" stretchy="false" xref="S3.E3.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E3.m1.3.3.2" xref="S3.E3.m1.3.3.2.cmml"><msub id="S3.E3.m1.3.3.2.3" xref="S3.E3.m1.3.3.2.3.cmml"><mi id="S3.E3.m1.3.3.2.3.2" xref="S3.E3.m1.3.3.2.3.2.cmml">q</mi><mi id="S3.E3.m1.3.3.2.3.3" xref="S3.E3.m1.3.3.2.3.3.cmml">ϕ</mi></msub><mo id="S3.E3.m1.3.3.2.2" xref="S3.E3.m1.3.3.2.2.cmml">⁢</mo><mrow id="S3.E3.m1.3.3.2.1.1" xref="S3.E3.m1.3.3.2.1.1.1.cmml"><mo id="S3.E3.m1.3.3.2.1.1.2" stretchy="false" xref="S3.E3.m1.3.3.2.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.3.3.2.1.1.1" xref="S3.E3.m1.3.3.2.1.1.1.cmml"><msub id="S3.E3.m1.3.3.2.1.1.1.2" xref="S3.E3.m1.3.3.2.1.1.1.2.cmml"><mi id="S3.E3.m1.3.3.2.1.1.1.2.2" xref="S3.E3.m1.3.3.2.1.1.1.2.2.cmml">y</mi><mrow id="S3.E3.m1.3.3.2.1.1.1.2.3" xref="S3.E3.m1.3.3.2.1.1.1.2.3.cmml"><mrow id="S3.E3.m1.3.3.2.1.1.1.2.3.2" xref="S3.E3.m1.3.3.2.1.1.1.2.3.2.cmml"><mi id="S3.E3.m1.3.3.2.1.1.1.2.3.2.2" xref="S3.E3.m1.3.3.2.1.1.1.2.3.2.2.cmml">m</mi><mo id="S3.E3.m1.3.3.2.1.1.1.2.3.2.1" xref="S3.E3.m1.3.3.2.1.1.1.2.3.2.1.cmml">+</mo><mn id="S3.E3.m1.3.3.2.1.1.1.2.3.2.3" xref="S3.E3.m1.3.3.2.1.1.1.2.3.2.3.cmml">1</mn></mrow><mo id="S3.E3.m1.3.3.2.1.1.1.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.E3.m1.3.3.2.1.1.1.2.3.1.cmml">:</mo><mi id="S3.E3.m1.3.3.2.1.1.1.2.3.3" xref="S3.E3.m1.3.3.2.1.1.1.2.3.3.cmml">N</mi></mrow></msub><mo fence="false" id="S3.E3.m1.3.3.2.1.1.1.1" xref="S3.E3.m1.3.3.2.1.1.1.1.cmml">|</mo><mi id="S3.E3.m1.3.3.2.1.1.1.3" xref="S3.E3.m1.3.3.2.1.1.1.3.cmml">X</mi></mrow><mo id="S3.E3.m1.3.3.2.1.1.3" stretchy="false" xref="S3.E3.m1.3.3.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow><mo id="S3.E3.m1.4.4.1.1.2.1.1.3" xref="S3.E3.m1.4.4.1.1.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S3.E3.m1.4.4.1.2" lspace="0em" xref="S3.E3.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.4b"><apply id="S3.E3.m1.4.4.1.1.cmml" xref="S3.E3.m1.4.4.1"><eq id="S3.E3.m1.4.4.1.1.3.cmml" xref="S3.E3.m1.4.4.1.1.3"></eq><apply id="S3.E3.m1.4.4.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.1"><times id="S3.E3.m1.4.4.1.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.1.2"></times><ci id="S3.E3.m1.4.4.1.1.1.3a.cmml" xref="S3.E3.m1.4.4.1.1.1.3"><mtext id="S3.E3.m1.4.4.1.1.1.3.cmml" xref="S3.E3.m1.4.4.1.1.1.3">KL</mtext></ci><apply id="S3.E3.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.E3.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.2">𝑝</ci><apply id="S3.E3.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.4.4.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.3.2">𝑞</ci><ci id="S3.E3.m1.4.4.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.3.3">italic-ϕ</ci></apply></apply></apply><apply id="S3.E3.m1.4.4.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.2"><times id="S3.E3.m1.4.4.1.1.2.2.cmml" xref="S3.E3.m1.4.4.1.1.2.2"></times><apply id="S3.E3.m1.4.4.1.1.2.3.cmml" xref="S3.E3.m1.4.4.1.1.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.2.3.1.cmml" xref="S3.E3.m1.4.4.1.1.2.3">subscript</csymbol><ci id="S3.E3.m1.4.4.1.1.2.3.2.cmml" xref="S3.E3.m1.4.4.1.1.2.3.2">𝔼</ci><apply id="S3.E3.m1.1.1.1.cmml" xref="S3.E3.m1.1.1.1"><times id="S3.E3.m1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.2"></times><ci id="S3.E3.m1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.3">𝑝</ci><apply id="S3.E3.m1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.E3.m1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.2">𝑦</ci><apply id="S3.E3.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.3"><ci id="S3.E3.m1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.3.1">:</ci><apply id="S3.E3.m1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.3.2"><plus id="S3.E3.m1.1.1.1.1.1.1.2.3.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.3.2.1"></plus><ci id="S3.E3.m1.1.1.1.1.1.1.2.3.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.3.2.2">𝑚</ci><cn id="S3.E3.m1.1.1.1.1.1.1.2.3.2.3.cmml" type="integer" xref="S3.E3.m1.1.1.1.1.1.1.2.3.2.3">1</cn></apply><ci id="S3.E3.m1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.3.3">𝑁</ci></apply></apply><ci id="S3.E3.m1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3">𝑋</ci></apply></apply></apply><apply id="S3.E3.m1.4.4.1.1.2.1.2.cmml" xref="S3.E3.m1.4.4.1.1.2.1.1"><csymbol cd="latexml" id="S3.E3.m1.4.4.1.1.2.1.2.1.cmml" xref="S3.E3.m1.4.4.1.1.2.1.1.2">delimited-[]</csymbol><apply id="S3.E3.m1.4.4.1.1.2.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.2.1.1.1"><log id="S3.E3.m1.4.4.1.1.2.1.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.2.1.1.1.1"></log><apply id="S3.E3.m1.3.3.cmml" xref="S3.E3.m1.3.3"><divide id="S3.E3.m1.3.3.3.cmml" xref="S3.E3.m1.3.3"></divide><apply id="S3.E3.m1.2.2.1.cmml" xref="S3.E3.m1.2.2.1"><times id="S3.E3.m1.2.2.1.2.cmml" xref="S3.E3.m1.2.2.1.2"></times><ci id="S3.E3.m1.2.2.1.3.cmml" xref="S3.E3.m1.2.2.1.3">𝑝</ci><apply id="S3.E3.m1.2.2.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.2.2.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1">conditional</csymbol><apply id="S3.E3.m1.2.2.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.2.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.2">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.1.1.2.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.2.2">𝑦</ci><apply id="S3.E3.m1.2.2.1.1.1.1.2.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.2.3"><ci id="S3.E3.m1.2.2.1.1.1.1.2.3.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.2.3.1">:</ci><apply id="S3.E3.m1.2.2.1.1.1.1.2.3.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.2.3.2"><plus id="S3.E3.m1.2.2.1.1.1.1.2.3.2.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.2.3.2.1"></plus><ci id="S3.E3.m1.2.2.1.1.1.1.2.3.2.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.2.3.2.2">𝑚</ci><cn id="S3.E3.m1.2.2.1.1.1.1.2.3.2.3.cmml" type="integer" xref="S3.E3.m1.2.2.1.1.1.1.2.3.2.3">1</cn></apply><ci id="S3.E3.m1.2.2.1.1.1.1.2.3.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.2.3.3">𝑁</ci></apply></apply><ci id="S3.E3.m1.2.2.1.1.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3">𝑋</ci></apply></apply><apply id="S3.E3.m1.3.3.2.cmml" xref="S3.E3.m1.3.3.2"><times id="S3.E3.m1.3.3.2.2.cmml" xref="S3.E3.m1.3.3.2.2"></times><apply id="S3.E3.m1.3.3.2.3.cmml" xref="S3.E3.m1.3.3.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.2.3.1.cmml" xref="S3.E3.m1.3.3.2.3">subscript</csymbol><ci id="S3.E3.m1.3.3.2.3.2.cmml" xref="S3.E3.m1.3.3.2.3.2">𝑞</ci><ci id="S3.E3.m1.3.3.2.3.3.cmml" xref="S3.E3.m1.3.3.2.3.3">italic-ϕ</ci></apply><apply id="S3.E3.m1.3.3.2.1.1.1.cmml" xref="S3.E3.m1.3.3.2.1.1"><csymbol cd="latexml" id="S3.E3.m1.3.3.2.1.1.1.1.cmml" xref="S3.E3.m1.3.3.2.1.1.1.1">conditional</csymbol><apply id="S3.E3.m1.3.3.2.1.1.1.2.cmml" xref="S3.E3.m1.3.3.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.2.1.1.1.2.1.cmml" xref="S3.E3.m1.3.3.2.1.1.1.2">subscript</csymbol><ci id="S3.E3.m1.3.3.2.1.1.1.2.2.cmml" xref="S3.E3.m1.3.3.2.1.1.1.2.2">𝑦</ci><apply id="S3.E3.m1.3.3.2.1.1.1.2.3.cmml" xref="S3.E3.m1.3.3.2.1.1.1.2.3"><ci id="S3.E3.m1.3.3.2.1.1.1.2.3.1.cmml" xref="S3.E3.m1.3.3.2.1.1.1.2.3.1">:</ci><apply id="S3.E3.m1.3.3.2.1.1.1.2.3.2.cmml" xref="S3.E3.m1.3.3.2.1.1.1.2.3.2"><plus id="S3.E3.m1.3.3.2.1.1.1.2.3.2.1.cmml" xref="S3.E3.m1.3.3.2.1.1.1.2.3.2.1"></plus><ci id="S3.E3.m1.3.3.2.1.1.1.2.3.2.2.cmml" xref="S3.E3.m1.3.3.2.1.1.1.2.3.2.2">𝑚</ci><cn id="S3.E3.m1.3.3.2.1.1.1.2.3.2.3.cmml" type="integer" xref="S3.E3.m1.3.3.2.1.1.1.2.3.2.3">1</cn></apply><ci id="S3.E3.m1.3.3.2.1.1.1.2.3.3.cmml" xref="S3.E3.m1.3.3.2.1.1.1.2.3.3">𝑁</ci></apply></apply><ci id="S3.E3.m1.3.3.2.1.1.1.3.cmml" xref="S3.E3.m1.3.3.2.1.1.1.3">𝑋</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.4c">\text{KL}(p\parallel q_{\phi})=\mathbb{E}_{p({y_{m+1:N}}|X)}\left[\log\frac{p(%
y_{m+1:N}|X)}{q_{\phi}(y_{m+1:N}|X)}\right].</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.4d">KL ( italic_p ∥ italic_q start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ) = blackboard_E start_POSTSUBSCRIPT italic_p ( italic_y start_POSTSUBSCRIPT italic_m + 1 : italic_N end_POSTSUBSCRIPT | italic_X ) end_POSTSUBSCRIPT [ roman_log divide start_ARG italic_p ( italic_y start_POSTSUBSCRIPT italic_m + 1 : italic_N end_POSTSUBSCRIPT | italic_X ) end_ARG start_ARG italic_q start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_m + 1 : italic_N end_POSTSUBSCRIPT | italic_X ) end_ARG ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p2.9">According to the maximum likelihood estimation principle, the parameters <math alttext="\phi" class="ltx_Math" display="inline" id="S3.SS1.p2.7.m1.1"><semantics id="S3.SS1.p2.7.m1.1a"><mi id="S3.SS1.p2.7.m1.1.1" xref="S3.SS1.p2.7.m1.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m1.1b"><ci id="S3.SS1.p2.7.m1.1.1.cmml" xref="S3.SS1.p2.7.m1.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m1.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.7.m1.1d">italic_ϕ</annotation></semantics></math> are chosen so as to minimize <math alttext="E_{p(X)}\big{[}\text{KL}(p\parallel q_{\phi})\big{]}" class="ltx_Math" display="inline" id="S3.SS1.p2.8.m2.2"><semantics id="S3.SS1.p2.8.m2.2a"><mrow id="S3.SS1.p2.8.m2.2.2" xref="S3.SS1.p2.8.m2.2.2.cmml"><msub id="S3.SS1.p2.8.m2.2.2.3" xref="S3.SS1.p2.8.m2.2.2.3.cmml"><mi id="S3.SS1.p2.8.m2.2.2.3.2" xref="S3.SS1.p2.8.m2.2.2.3.2.cmml">E</mi><mrow id="S3.SS1.p2.8.m2.1.1.1" xref="S3.SS1.p2.8.m2.1.1.1.cmml"><mi id="S3.SS1.p2.8.m2.1.1.1.3" xref="S3.SS1.p2.8.m2.1.1.1.3.cmml">p</mi><mo id="S3.SS1.p2.8.m2.1.1.1.2" xref="S3.SS1.p2.8.m2.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p2.8.m2.1.1.1.4.2" xref="S3.SS1.p2.8.m2.1.1.1.cmml"><mo id="S3.SS1.p2.8.m2.1.1.1.4.2.1" stretchy="false" xref="S3.SS1.p2.8.m2.1.1.1.cmml">(</mo><mi id="S3.SS1.p2.8.m2.1.1.1.1" xref="S3.SS1.p2.8.m2.1.1.1.1.cmml">X</mi><mo id="S3.SS1.p2.8.m2.1.1.1.4.2.2" stretchy="false" xref="S3.SS1.p2.8.m2.1.1.1.cmml">)</mo></mrow></mrow></msub><mo id="S3.SS1.p2.8.m2.2.2.2" xref="S3.SS1.p2.8.m2.2.2.2.cmml">⁢</mo><mrow id="S3.SS1.p2.8.m2.2.2.1.1" xref="S3.SS1.p2.8.m2.2.2.1.2.cmml"><mo id="S3.SS1.p2.8.m2.2.2.1.1.2" maxsize="120%" minsize="120%" xref="S3.SS1.p2.8.m2.2.2.1.2.1.cmml">[</mo><mrow id="S3.SS1.p2.8.m2.2.2.1.1.1" xref="S3.SS1.p2.8.m2.2.2.1.1.1.cmml"><mtext id="S3.SS1.p2.8.m2.2.2.1.1.1.3" xref="S3.SS1.p2.8.m2.2.2.1.1.1.3a.cmml">KL</mtext><mo id="S3.SS1.p2.8.m2.2.2.1.1.1.2" xref="S3.SS1.p2.8.m2.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p2.8.m2.2.2.1.1.1.1.1" xref="S3.SS1.p2.8.m2.2.2.1.1.1.1.1.1.cmml"><mo id="S3.SS1.p2.8.m2.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p2.8.m2.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p2.8.m2.2.2.1.1.1.1.1.1" xref="S3.SS1.p2.8.m2.2.2.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.8.m2.2.2.1.1.1.1.1.1.2" xref="S3.SS1.p2.8.m2.2.2.1.1.1.1.1.1.2.cmml">p</mi><mo id="S3.SS1.p2.8.m2.2.2.1.1.1.1.1.1.1" xref="S3.SS1.p2.8.m2.2.2.1.1.1.1.1.1.1.cmml">∥</mo><msub id="S3.SS1.p2.8.m2.2.2.1.1.1.1.1.1.3" xref="S3.SS1.p2.8.m2.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.SS1.p2.8.m2.2.2.1.1.1.1.1.1.3.2" xref="S3.SS1.p2.8.m2.2.2.1.1.1.1.1.1.3.2.cmml">q</mi><mi id="S3.SS1.p2.8.m2.2.2.1.1.1.1.1.1.3.3" xref="S3.SS1.p2.8.m2.2.2.1.1.1.1.1.1.3.3.cmml">ϕ</mi></msub></mrow><mo id="S3.SS1.p2.8.m2.2.2.1.1.1.1.1.3" stretchy="false" xref="S3.SS1.p2.8.m2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p2.8.m2.2.2.1.1.3" maxsize="120%" minsize="120%" xref="S3.SS1.p2.8.m2.2.2.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m2.2b"><apply id="S3.SS1.p2.8.m2.2.2.cmml" xref="S3.SS1.p2.8.m2.2.2"><times id="S3.SS1.p2.8.m2.2.2.2.cmml" xref="S3.SS1.p2.8.m2.2.2.2"></times><apply id="S3.SS1.p2.8.m2.2.2.3.cmml" xref="S3.SS1.p2.8.m2.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m2.2.2.3.1.cmml" xref="S3.SS1.p2.8.m2.2.2.3">subscript</csymbol><ci id="S3.SS1.p2.8.m2.2.2.3.2.cmml" xref="S3.SS1.p2.8.m2.2.2.3.2">𝐸</ci><apply id="S3.SS1.p2.8.m2.1.1.1.cmml" xref="S3.SS1.p2.8.m2.1.1.1"><times id="S3.SS1.p2.8.m2.1.1.1.2.cmml" xref="S3.SS1.p2.8.m2.1.1.1.2"></times><ci id="S3.SS1.p2.8.m2.1.1.1.3.cmml" xref="S3.SS1.p2.8.m2.1.1.1.3">𝑝</ci><ci id="S3.SS1.p2.8.m2.1.1.1.1.cmml" xref="S3.SS1.p2.8.m2.1.1.1.1">𝑋</ci></apply></apply><apply id="S3.SS1.p2.8.m2.2.2.1.2.cmml" xref="S3.SS1.p2.8.m2.2.2.1.1"><csymbol cd="latexml" id="S3.SS1.p2.8.m2.2.2.1.2.1.cmml" xref="S3.SS1.p2.8.m2.2.2.1.1.2">delimited-[]</csymbol><apply id="S3.SS1.p2.8.m2.2.2.1.1.1.cmml" xref="S3.SS1.p2.8.m2.2.2.1.1.1"><times id="S3.SS1.p2.8.m2.2.2.1.1.1.2.cmml" xref="S3.SS1.p2.8.m2.2.2.1.1.1.2"></times><ci id="S3.SS1.p2.8.m2.2.2.1.1.1.3a.cmml" xref="S3.SS1.p2.8.m2.2.2.1.1.1.3"><mtext id="S3.SS1.p2.8.m2.2.2.1.1.1.3.cmml" xref="S3.SS1.p2.8.m2.2.2.1.1.1.3">KL</mtext></ci><apply id="S3.SS1.p2.8.m2.2.2.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.8.m2.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p2.8.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.8.m2.2.2.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS1.p2.8.m2.2.2.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.8.m2.2.2.1.1.1.1.1.1.2">𝑝</ci><apply id="S3.SS1.p2.8.m2.2.2.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.8.m2.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m2.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.SS1.p2.8.m2.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS1.p2.8.m2.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.SS1.p2.8.m2.2.2.1.1.1.1.1.1.3.2">𝑞</ci><ci id="S3.SS1.p2.8.m2.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.SS1.p2.8.m2.2.2.1.1.1.1.1.1.3.3">italic-ϕ</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.8.m2.2c">E_{p(X)}\big{[}\text{KL}(p\parallel q_{\phi})\big{]}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.8.m2.2d">italic_E start_POSTSUBSCRIPT italic_p ( italic_X ) end_POSTSUBSCRIPT [ KL ( italic_p ∥ italic_q start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ) ]</annotation></semantics></math>,
namely the expected value (over the conditioning variables <math alttext="X" class="ltx_Math" display="inline" id="S3.SS1.p2.9.m3.1"><semantics id="S3.SS1.p2.9.m3.1a"><mi id="S3.SS1.p2.9.m3.1.1" xref="S3.SS1.p2.9.m3.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.9.m3.1b"><ci id="S3.SS1.p2.9.m3.1.1.cmml" xref="S3.SS1.p2.9.m3.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.9.m3.1c">X</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.9.m3.1d">italic_X</annotation></semantics></math>) of the Kullback-Leibler divergence <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#bib.bib21" title="">21</a>]</cite>. We have:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="E_{p(X)}\big{[}\text{KL}(p\parallel q_{\phi})\big{]}=E_{p(\mathcal{D})}\left[%
\log\frac{p(y_{m+1:N}|X)}{q_{\phi}(y_{m+1:N}|X)}\right]\\
=\overbrace{E_{p(\mathcal{D})}[-\log q_{\phi}(y_{m+1:N}|X)]}^{J(\phi)}+K," class="ltx_Math" display="block" id="S3.E4.m1.28"><semantics id="S3.E4.m1.28a"><mtable displaystyle="true" id="S3.E4.m1.28.28.4" rowspacing="0pt"><mtr id="S3.E4.m1.28.28.4a"><mtd class="ltx_align_left" columnalign="left" id="S3.E4.m1.28.28.4b"><mrow id="S3.E4.m1.27.27.3.26.20.20"><mrow id="S3.E4.m1.26.26.2.25.19.19.19"><msub id="S3.E4.m1.26.26.2.25.19.19.19.3"><mi id="S3.E4.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.cmml">E</mi><mrow id="S3.E4.m1.2.2.2.2.2.2.1" xref="S3.E4.m1.2.2.2.2.2.2.1.cmml"><mi id="S3.E4.m1.2.2.2.2.2.2.1.3" xref="S3.E4.m1.2.2.2.2.2.2.1.3.cmml">p</mi><mo id="S3.E4.m1.2.2.2.2.2.2.1.2" xref="S3.E4.m1.2.2.2.2.2.2.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.2.2.2.2.2.2.1.4.2" xref="S3.E4.m1.2.2.2.2.2.2.1.cmml"><mo id="S3.E4.m1.2.2.2.2.2.2.1.4.2.1" stretchy="false" xref="S3.E4.m1.2.2.2.2.2.2.1.cmml">(</mo><mi id="S3.E4.m1.2.2.2.2.2.2.1.1" xref="S3.E4.m1.2.2.2.2.2.2.1.1.cmml">X</mi><mo id="S3.E4.m1.2.2.2.2.2.2.1.4.2.2" stretchy="false" xref="S3.E4.m1.2.2.2.2.2.2.1.cmml">)</mo></mrow></mrow></msub><mo id="S3.E4.m1.26.26.2.25.19.19.19.2" xref="S3.E4.m1.25.25.1.1.1.cmml">⁢</mo><mrow id="S3.E4.m1.26.26.2.25.19.19.19.1.1"><mo id="S3.E4.m1.3.3.3.3.3.3" maxsize="120%" minsize="120%" xref="S3.E4.m1.25.25.1.1.1.cmml">[</mo><mrow id="S3.E4.m1.26.26.2.25.19.19.19.1.1.1"><mtext id="S3.E4.m1.4.4.4.4.4.4" xref="S3.E4.m1.4.4.4.4.4.4a.cmml">KL</mtext><mo id="S3.E4.m1.26.26.2.25.19.19.19.1.1.1.2" xref="S3.E4.m1.25.25.1.1.1.cmml">⁢</mo><mrow id="S3.E4.m1.26.26.2.25.19.19.19.1.1.1.1.1"><mo id="S3.E4.m1.5.5.5.5.5.5" stretchy="false" xref="S3.E4.m1.25.25.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.26.26.2.25.19.19.19.1.1.1.1.1.1"><mi id="S3.E4.m1.6.6.6.6.6.6" xref="S3.E4.m1.6.6.6.6.6.6.cmml">p</mi><mo id="S3.E4.m1.7.7.7.7.7.7" xref="S3.E4.m1.7.7.7.7.7.7.cmml">∥</mo><msub id="S3.E4.m1.26.26.2.25.19.19.19.1.1.1.1.1.1.1"><mi id="S3.E4.m1.8.8.8.8.8.8" xref="S3.E4.m1.8.8.8.8.8.8.cmml">q</mi><mi id="S3.E4.m1.9.9.9.9.9.9.1" xref="S3.E4.m1.9.9.9.9.9.9.1.cmml">ϕ</mi></msub></mrow><mo id="S3.E4.m1.10.10.10.10.10.10" stretchy="false" xref="S3.E4.m1.25.25.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.11.11.11.11.11.11" maxsize="120%" minsize="120%" xref="S3.E4.m1.25.25.1.1.1.cmml">]</mo></mrow></mrow><mo id="S3.E4.m1.12.12.12.12.12.12" xref="S3.E4.m1.12.12.12.12.12.12.cmml">=</mo><mrow id="S3.E4.m1.27.27.3.26.20.20.20"><msub id="S3.E4.m1.27.27.3.26.20.20.20.3"><mi id="S3.E4.m1.13.13.13.13.13.13" xref="S3.E4.m1.13.13.13.13.13.13.cmml">E</mi><mrow id="S3.E4.m1.14.14.14.14.14.14.1" xref="S3.E4.m1.14.14.14.14.14.14.1.cmml"><mi id="S3.E4.m1.14.14.14.14.14.14.1.3" xref="S3.E4.m1.14.14.14.14.14.14.1.3.cmml">p</mi><mo id="S3.E4.m1.14.14.14.14.14.14.1.2" xref="S3.E4.m1.14.14.14.14.14.14.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.14.14.14.14.14.14.1.4.2" xref="S3.E4.m1.14.14.14.14.14.14.1.cmml"><mo id="S3.E4.m1.14.14.14.14.14.14.1.4.2.1" stretchy="false" xref="S3.E4.m1.14.14.14.14.14.14.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.14.14.14.14.14.14.1.1" xref="S3.E4.m1.14.14.14.14.14.14.1.1.cmml">𝒟</mi><mo id="S3.E4.m1.14.14.14.14.14.14.1.4.2.2" stretchy="false" xref="S3.E4.m1.14.14.14.14.14.14.1.cmml">)</mo></mrow></mrow></msub><mo id="S3.E4.m1.27.27.3.26.20.20.20.2" xref="S3.E4.m1.25.25.1.1.1.cmml">⁢</mo><mrow id="S3.E4.m1.27.27.3.26.20.20.20.1.1"><mo id="S3.E4.m1.15.15.15.15.15.15" xref="S3.E4.m1.25.25.1.1.1.cmml">[</mo><mrow id="S3.E4.m1.27.27.3.26.20.20.20.1.1.1"><mi id="S3.E4.m1.16.16.16.16.16.16" xref="S3.E4.m1.16.16.16.16.16.16.cmml">log</mi><mo id="S3.E4.m1.27.27.3.26.20.20.20.1.1.1a" lspace="0.167em" xref="S3.E4.m1.25.25.1.1.1.cmml">⁡</mo><mfrac id="S3.E4.m1.17.17.17.17.17.17" xref="S3.E4.m1.17.17.17.17.17.17.cmml"><mrow id="S3.E4.m1.17.17.17.17.17.17.1" xref="S3.E4.m1.17.17.17.17.17.17.1.cmml"><mi id="S3.E4.m1.17.17.17.17.17.17.1.3" xref="S3.E4.m1.17.17.17.17.17.17.1.3.cmml">p</mi><mo id="S3.E4.m1.17.17.17.17.17.17.1.2" xref="S3.E4.m1.17.17.17.17.17.17.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.17.17.17.17.17.17.1.1.1" xref="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.cmml"><mo id="S3.E4.m1.17.17.17.17.17.17.1.1.1.2" stretchy="false" xref="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.17.17.17.17.17.17.1.1.1.1" xref="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.cmml"><msub id="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.2" xref="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.2.cmml"><mi id="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.2.2" xref="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.2.2.cmml">y</mi><mrow id="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.2.3" xref="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.2.3.cmml"><mrow id="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.2.3.2" xref="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.2.3.2.cmml"><mi id="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.2.3.2.2" xref="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.2.3.2.2.cmml">m</mi><mo id="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.2.3.2.1" xref="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.2.3.2.1.cmml">+</mo><mn id="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.2.3.2.3" xref="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.2.3.2.3.cmml">1</mn></mrow><mo id="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.2.3.1.cmml">:</mo><mi id="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.2.3.3" xref="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.2.3.3.cmml">N</mi></mrow></msub><mo fence="false" id="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.1" xref="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.1.cmml">|</mo><mi id="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.3" xref="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.3.cmml">X</mi></mrow><mo id="S3.E4.m1.17.17.17.17.17.17.1.1.1.3" stretchy="false" xref="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E4.m1.17.17.17.17.17.17.2" xref="S3.E4.m1.17.17.17.17.17.17.2.cmml"><msub id="S3.E4.m1.17.17.17.17.17.17.2.3" xref="S3.E4.m1.17.17.17.17.17.17.2.3.cmml"><mi id="S3.E4.m1.17.17.17.17.17.17.2.3.2" xref="S3.E4.m1.17.17.17.17.17.17.2.3.2.cmml">q</mi><mi id="S3.E4.m1.17.17.17.17.17.17.2.3.3" xref="S3.E4.m1.17.17.17.17.17.17.2.3.3.cmml">ϕ</mi></msub><mo id="S3.E4.m1.17.17.17.17.17.17.2.2" xref="S3.E4.m1.17.17.17.17.17.17.2.2.cmml">⁢</mo><mrow id="S3.E4.m1.17.17.17.17.17.17.2.1.1" xref="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.cmml"><mo id="S3.E4.m1.17.17.17.17.17.17.2.1.1.2" stretchy="false" xref="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.17.17.17.17.17.17.2.1.1.1" xref="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.cmml"><msub id="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.2" xref="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.2.cmml"><mi id="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.2.2" xref="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.2.2.cmml">y</mi><mrow id="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.2.3" xref="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.2.3.cmml"><mrow id="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.2.3.2" xref="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.2.3.2.cmml"><mi id="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.2.3.2.2" xref="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.2.3.2.2.cmml">m</mi><mo id="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.2.3.2.1" xref="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.2.3.2.1.cmml">+</mo><mn id="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.2.3.2.3" xref="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.2.3.2.3.cmml">1</mn></mrow><mo id="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.2.3.1.cmml">:</mo><mi id="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.2.3.3" xref="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.2.3.3.cmml">N</mi></mrow></msub><mo fence="false" id="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.1" xref="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.1.cmml">|</mo><mi id="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.3" xref="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.3.cmml">X</mi></mrow><mo id="S3.E4.m1.17.17.17.17.17.17.2.1.1.3" stretchy="false" xref="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow><mo id="S3.E4.m1.18.18.18.18.18.18" xref="S3.E4.m1.25.25.1.1.1.cmml">]</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E4.m1.28.28.4c"><mtd class="ltx_align_right" columnalign="right" id="S3.E4.m1.28.28.4d"><mrow id="S3.E4.m1.28.28.4.27.7.7.7"><mrow id="S3.E4.m1.28.28.4.27.7.7.7.1"><mi id="S3.E4.m1.28.28.4.27.7.7.7.1.1" xref="S3.E4.m1.25.25.1.1.1.cmml"></mi><mo id="S3.E4.m1.19.19.19.1.1.1" xref="S3.E4.m1.19.19.19.1.1.1.cmml">=</mo><mrow id="S3.E4.m1.28.28.4.27.7.7.7.1.2"><mover id="S3.E4.m1.28.28.4.27.7.7.7.1.2.1"><mover accent="true" id="S3.E4.m1.20.20.20.2.2.2" xref="S3.E4.m1.20.20.20.2.2.2.cmml"><mrow id="S3.E4.m1.20.20.20.2.2.2.2" xref="S3.E4.m1.20.20.20.2.2.2.2.cmml"><msub id="S3.E4.m1.20.20.20.2.2.2.2.4" xref="S3.E4.m1.20.20.20.2.2.2.2.4.cmml"><mi id="S3.E4.m1.20.20.20.2.2.2.2.4.2" xref="S3.E4.m1.20.20.20.2.2.2.2.4.2.cmml">E</mi><mrow id="S3.E4.m1.20.20.20.2.2.2.1.1.1" xref="S3.E4.m1.20.20.20.2.2.2.1.1.1.cmml"><mi id="S3.E4.m1.20.20.20.2.2.2.1.1.1.3" xref="S3.E4.m1.20.20.20.2.2.2.1.1.1.3.cmml">p</mi><mo id="S3.E4.m1.20.20.20.2.2.2.1.1.1.2" xref="S3.E4.m1.20.20.20.2.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.20.20.20.2.2.2.1.1.1.4.2" xref="S3.E4.m1.20.20.20.2.2.2.1.1.1.cmml"><mo id="S3.E4.m1.20.20.20.2.2.2.1.1.1.4.2.1" stretchy="false" xref="S3.E4.m1.20.20.20.2.2.2.1.1.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.20.20.20.2.2.2.1.1.1.1" xref="S3.E4.m1.20.20.20.2.2.2.1.1.1.1.cmml">𝒟</mi><mo id="S3.E4.m1.20.20.20.2.2.2.1.1.1.4.2.2" stretchy="false" xref="S3.E4.m1.20.20.20.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></msub><mo id="S3.E4.m1.20.20.20.2.2.2.2.3" xref="S3.E4.m1.20.20.20.2.2.2.2.3.cmml">⁢</mo><mrow id="S3.E4.m1.20.20.20.2.2.2.2.2.1" xref="S3.E4.m1.20.20.20.2.2.2.2.2.2.cmml"><mo id="S3.E4.m1.20.20.20.2.2.2.2.2.1.2" stretchy="false" xref="S3.E4.m1.20.20.20.2.2.2.2.2.2.1.cmml">[</mo><mrow id="S3.E4.m1.20.20.20.2.2.2.2.2.1.1" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.cmml"><mo id="S3.E4.m1.20.20.20.2.2.2.2.2.1.1a" rspace="0.167em" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.cmml">−</mo><mrow id="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.cmml"><mrow id="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.3" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.3.cmml"><mi id="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.3.1" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.3.1.cmml">log</mi><mo id="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.3a" lspace="0.167em" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.3.cmml">⁡</mo><msub id="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.3.2" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.3.2.cmml"><mi id="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.3.2.2" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.3.2.2.cmml">q</mi><mi id="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.3.2.3" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.3.2.3.cmml">ϕ</mi></msub></mrow><mo id="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.2" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.cmml"><mo id="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.cmml"><msub id="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.2" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.2.cmml"><mi id="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.2.2" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.2.2.cmml">y</mi><mrow id="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.2.3" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.2.3.cmml"><mrow id="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.2.3.2" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.2.3.2.cmml"><mi id="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.2.3.2.2" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.2.3.2.2.cmml">m</mi><mo id="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.2.3.2.1" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.2.3.2.1.cmml">+</mo><mn id="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.2.3.2.3" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.2.3.2.3.cmml">1</mn></mrow><mo id="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.2.3.1.cmml">:</mo><mi id="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.2.3.3" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.2.3.3.cmml">N</mi></mrow></msub><mo fence="false" id="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.1" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.3" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.3.cmml">X</mi></mrow><mo id="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.3" stretchy="false" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E4.m1.20.20.20.2.2.2.2.2.1.3" stretchy="false" xref="S3.E4.m1.20.20.20.2.2.2.2.2.2.1.cmml">]</mo></mrow></mrow><mo id="S3.E4.m1.20.20.20.2.2.2.3" xref="S3.E4.m1.20.20.20.2.2.2.3.cmml">⏞</mo></mover><mrow id="S3.E4.m1.21.21.21.3.3.3.1" xref="S3.E4.m1.21.21.21.3.3.3.1.cmml"><mi id="S3.E4.m1.21.21.21.3.3.3.1.3" xref="S3.E4.m1.21.21.21.3.3.3.1.3.cmml">J</mi><mo id="S3.E4.m1.21.21.21.3.3.3.1.2" xref="S3.E4.m1.21.21.21.3.3.3.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.21.21.21.3.3.3.1.4.2" xref="S3.E4.m1.21.21.21.3.3.3.1.cmml"><mo id="S3.E4.m1.21.21.21.3.3.3.1.4.2.1" stretchy="false" xref="S3.E4.m1.21.21.21.3.3.3.1.cmml">(</mo><mi id="S3.E4.m1.21.21.21.3.3.3.1.1" xref="S3.E4.m1.21.21.21.3.3.3.1.1.cmml">ϕ</mi><mo id="S3.E4.m1.21.21.21.3.3.3.1.4.2.2" stretchy="false" xref="S3.E4.m1.21.21.21.3.3.3.1.cmml">)</mo></mrow></mrow></mover><mo id="S3.E4.m1.22.22.22.4.4.4" xref="S3.E4.m1.22.22.22.4.4.4.cmml">+</mo><mi id="S3.E4.m1.23.23.23.5.5.5" xref="S3.E4.m1.23.23.23.5.5.5.cmml">K</mi></mrow></mrow><mo id="S3.E4.m1.24.24.24.6.6.6" xref="S3.E4.m1.25.25.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E4.m1.28b"><apply id="S3.E4.m1.25.25.1.1.1.cmml" xref="S3.E4.m1.26.26.2.25.19.19.19.2"><and id="S3.E4.m1.25.25.1.1.1a.cmml" xref="S3.E4.m1.26.26.2.25.19.19.19.2"></and><apply id="S3.E4.m1.25.25.1.1.1b.cmml" xref="S3.E4.m1.26.26.2.25.19.19.19.2"><eq id="S3.E4.m1.12.12.12.12.12.12.cmml" xref="S3.E4.m1.12.12.12.12.12.12"></eq><apply id="S3.E4.m1.25.25.1.1.1.1.cmml" xref="S3.E4.m1.26.26.2.25.19.19.19.2"><times id="S3.E4.m1.25.25.1.1.1.1.2.cmml" xref="S3.E4.m1.26.26.2.25.19.19.19.2"></times><apply id="S3.E4.m1.25.25.1.1.1.1.3.cmml" xref="S3.E4.m1.26.26.2.25.19.19.19.2"><csymbol cd="ambiguous" id="S3.E4.m1.25.25.1.1.1.1.3.1.cmml" xref="S3.E4.m1.26.26.2.25.19.19.19.2">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1">𝐸</ci><apply id="S3.E4.m1.2.2.2.2.2.2.1.cmml" xref="S3.E4.m1.2.2.2.2.2.2.1"><times id="S3.E4.m1.2.2.2.2.2.2.1.2.cmml" xref="S3.E4.m1.2.2.2.2.2.2.1.2"></times><ci id="S3.E4.m1.2.2.2.2.2.2.1.3.cmml" xref="S3.E4.m1.2.2.2.2.2.2.1.3">𝑝</ci><ci id="S3.E4.m1.2.2.2.2.2.2.1.1.cmml" xref="S3.E4.m1.2.2.2.2.2.2.1.1">𝑋</ci></apply></apply><apply id="S3.E4.m1.25.25.1.1.1.1.1.2.cmml" xref="S3.E4.m1.26.26.2.25.19.19.19.2"><csymbol cd="latexml" id="S3.E4.m1.25.25.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.26.26.2.25.19.19.19.2">delimited-[]</csymbol><apply id="S3.E4.m1.25.25.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.26.26.2.25.19.19.19.2"><times id="S3.E4.m1.25.25.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.26.26.2.25.19.19.19.2"></times><ci id="S3.E4.m1.4.4.4.4.4.4a.cmml" xref="S3.E4.m1.4.4.4.4.4.4"><mtext id="S3.E4.m1.4.4.4.4.4.4.cmml" xref="S3.E4.m1.4.4.4.4.4.4">KL</mtext></ci><apply id="S3.E4.m1.25.25.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.26.26.2.25.19.19.19.2"><csymbol cd="latexml" id="S3.E4.m1.7.7.7.7.7.7.cmml" xref="S3.E4.m1.7.7.7.7.7.7">conditional</csymbol><ci id="S3.E4.m1.6.6.6.6.6.6.cmml" xref="S3.E4.m1.6.6.6.6.6.6">𝑝</ci><apply id="S3.E4.m1.25.25.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.26.26.2.25.19.19.19.2"><csymbol cd="ambiguous" id="S3.E4.m1.25.25.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.26.26.2.25.19.19.19.2">subscript</csymbol><ci id="S3.E4.m1.8.8.8.8.8.8.cmml" xref="S3.E4.m1.8.8.8.8.8.8">𝑞</ci><ci id="S3.E4.m1.9.9.9.9.9.9.1.cmml" xref="S3.E4.m1.9.9.9.9.9.9.1">italic-ϕ</ci></apply></apply></apply></apply></apply><apply id="S3.E4.m1.25.25.1.1.1.2.cmml" xref="S3.E4.m1.26.26.2.25.19.19.19.2"><times id="S3.E4.m1.25.25.1.1.1.2.2.cmml" xref="S3.E4.m1.26.26.2.25.19.19.19.2"></times><apply id="S3.E4.m1.25.25.1.1.1.2.3.cmml" xref="S3.E4.m1.26.26.2.25.19.19.19.2"><csymbol cd="ambiguous" id="S3.E4.m1.25.25.1.1.1.2.3.1.cmml" xref="S3.E4.m1.26.26.2.25.19.19.19.2">subscript</csymbol><ci id="S3.E4.m1.13.13.13.13.13.13.cmml" xref="S3.E4.m1.13.13.13.13.13.13">𝐸</ci><apply id="S3.E4.m1.14.14.14.14.14.14.1.cmml" xref="S3.E4.m1.14.14.14.14.14.14.1"><times id="S3.E4.m1.14.14.14.14.14.14.1.2.cmml" xref="S3.E4.m1.14.14.14.14.14.14.1.2"></times><ci id="S3.E4.m1.14.14.14.14.14.14.1.3.cmml" xref="S3.E4.m1.14.14.14.14.14.14.1.3">𝑝</ci><ci id="S3.E4.m1.14.14.14.14.14.14.1.1.cmml" xref="S3.E4.m1.14.14.14.14.14.14.1.1">𝒟</ci></apply></apply><apply id="S3.E4.m1.25.25.1.1.1.2.1.2.cmml" xref="S3.E4.m1.26.26.2.25.19.19.19.2"><csymbol cd="latexml" id="S3.E4.m1.25.25.1.1.1.2.1.2.1.cmml" xref="S3.E4.m1.26.26.2.25.19.19.19.2">delimited-[]</csymbol><apply id="S3.E4.m1.25.25.1.1.1.2.1.1.1.cmml" xref="S3.E4.m1.26.26.2.25.19.19.19.2"><log id="S3.E4.m1.16.16.16.16.16.16.cmml" xref="S3.E4.m1.16.16.16.16.16.16"></log><apply id="S3.E4.m1.17.17.17.17.17.17.cmml" xref="S3.E4.m1.17.17.17.17.17.17"><divide id="S3.E4.m1.17.17.17.17.17.17.3.cmml" xref="S3.E4.m1.17.17.17.17.17.17"></divide><apply id="S3.E4.m1.17.17.17.17.17.17.1.cmml" xref="S3.E4.m1.17.17.17.17.17.17.1"><times id="S3.E4.m1.17.17.17.17.17.17.1.2.cmml" xref="S3.E4.m1.17.17.17.17.17.17.1.2"></times><ci id="S3.E4.m1.17.17.17.17.17.17.1.3.cmml" xref="S3.E4.m1.17.17.17.17.17.17.1.3">𝑝</ci><apply id="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.cmml" xref="S3.E4.m1.17.17.17.17.17.17.1.1.1"><csymbol cd="latexml" id="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.1.cmml" xref="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.1">conditional</csymbol><apply id="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.2.cmml" xref="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.2.1.cmml" xref="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.2">subscript</csymbol><ci id="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.2.2.cmml" xref="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.2.2">𝑦</ci><apply id="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.2.3.cmml" xref="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.2.3"><ci id="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.2.3.1.cmml" xref="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.2.3.1">:</ci><apply id="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.2.3.2.cmml" xref="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.2.3.2"><plus id="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.2.3.2.1.cmml" xref="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.2.3.2.1"></plus><ci id="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.2.3.2.2.cmml" xref="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.2.3.2.2">𝑚</ci><cn id="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.2.3.2.3.cmml" type="integer" xref="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.2.3.2.3">1</cn></apply><ci id="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.2.3.3.cmml" xref="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.2.3.3">𝑁</ci></apply></apply><ci id="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.3.cmml" xref="S3.E4.m1.17.17.17.17.17.17.1.1.1.1.3">𝑋</ci></apply></apply><apply id="S3.E4.m1.17.17.17.17.17.17.2.cmml" xref="S3.E4.m1.17.17.17.17.17.17.2"><times id="S3.E4.m1.17.17.17.17.17.17.2.2.cmml" xref="S3.E4.m1.17.17.17.17.17.17.2.2"></times><apply id="S3.E4.m1.17.17.17.17.17.17.2.3.cmml" xref="S3.E4.m1.17.17.17.17.17.17.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.17.17.17.17.17.17.2.3.1.cmml" xref="S3.E4.m1.17.17.17.17.17.17.2.3">subscript</csymbol><ci id="S3.E4.m1.17.17.17.17.17.17.2.3.2.cmml" xref="S3.E4.m1.17.17.17.17.17.17.2.3.2">𝑞</ci><ci id="S3.E4.m1.17.17.17.17.17.17.2.3.3.cmml" xref="S3.E4.m1.17.17.17.17.17.17.2.3.3">italic-ϕ</ci></apply><apply id="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.cmml" xref="S3.E4.m1.17.17.17.17.17.17.2.1.1"><csymbol cd="latexml" id="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.1.cmml" xref="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.1">conditional</csymbol><apply id="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.2.cmml" xref="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.2.1.cmml" xref="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.2">subscript</csymbol><ci id="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.2.2.cmml" xref="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.2.2">𝑦</ci><apply id="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.2.3.cmml" xref="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.2.3"><ci id="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.2.3.1.cmml" xref="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.2.3.1">:</ci><apply id="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.2.3.2.cmml" xref="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.2.3.2"><plus id="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.2.3.2.1.cmml" xref="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.2.3.2.1"></plus><ci id="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.2.3.2.2.cmml" xref="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.2.3.2.2">𝑚</ci><cn id="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.2.3.2.3.cmml" type="integer" xref="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.2.3.2.3">1</cn></apply><ci id="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.2.3.3.cmml" xref="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.2.3.3">𝑁</ci></apply></apply><ci id="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.3.cmml" xref="S3.E4.m1.17.17.17.17.17.17.2.1.1.1.3">𝑋</ci></apply></apply></apply></apply></apply></apply></apply><apply id="S3.E4.m1.25.25.1.1.1c.cmml" xref="S3.E4.m1.26.26.2.25.19.19.19.2"><eq id="S3.E4.m1.19.19.19.1.1.1.cmml" xref="S3.E4.m1.19.19.19.1.1.1"></eq><share href="https://arxiv.org/html/2410.03291v1#S3.E4.m1.25.25.1.1.1.2.cmml" id="S3.E4.m1.25.25.1.1.1d.cmml" xref="S3.E4.m1.26.26.2.25.19.19.19.2"></share><apply id="S3.E4.m1.25.25.1.1.1.6.cmml" xref="S3.E4.m1.26.26.2.25.19.19.19.2"><plus id="S3.E4.m1.22.22.22.4.4.4.cmml" xref="S3.E4.m1.22.22.22.4.4.4"></plus><apply id="S3.E4.m1.25.25.1.1.1.6.2.cmml" xref="S3.E4.m1.26.26.2.25.19.19.19.2"><csymbol cd="ambiguous" id="S3.E4.m1.25.25.1.1.1.6.2.1.cmml" xref="S3.E4.m1.26.26.2.25.19.19.19.2">superscript</csymbol><apply id="S3.E4.m1.20.20.20.2.2.2.cmml" xref="S3.E4.m1.20.20.20.2.2.2"><ci id="S3.E4.m1.20.20.20.2.2.2.3.cmml" xref="S3.E4.m1.20.20.20.2.2.2.3">⏞</ci><apply id="S3.E4.m1.20.20.20.2.2.2.2.cmml" xref="S3.E4.m1.20.20.20.2.2.2.2"><times id="S3.E4.m1.20.20.20.2.2.2.2.3.cmml" xref="S3.E4.m1.20.20.20.2.2.2.2.3"></times><apply id="S3.E4.m1.20.20.20.2.2.2.2.4.cmml" xref="S3.E4.m1.20.20.20.2.2.2.2.4"><csymbol cd="ambiguous" id="S3.E4.m1.20.20.20.2.2.2.2.4.1.cmml" xref="S3.E4.m1.20.20.20.2.2.2.2.4">subscript</csymbol><ci id="S3.E4.m1.20.20.20.2.2.2.2.4.2.cmml" xref="S3.E4.m1.20.20.20.2.2.2.2.4.2">𝐸</ci><apply id="S3.E4.m1.20.20.20.2.2.2.1.1.1.cmml" xref="S3.E4.m1.20.20.20.2.2.2.1.1.1"><times id="S3.E4.m1.20.20.20.2.2.2.1.1.1.2.cmml" xref="S3.E4.m1.20.20.20.2.2.2.1.1.1.2"></times><ci id="S3.E4.m1.20.20.20.2.2.2.1.1.1.3.cmml" xref="S3.E4.m1.20.20.20.2.2.2.1.1.1.3">𝑝</ci><ci id="S3.E4.m1.20.20.20.2.2.2.1.1.1.1.cmml" xref="S3.E4.m1.20.20.20.2.2.2.1.1.1.1">𝒟</ci></apply></apply><apply id="S3.E4.m1.20.20.20.2.2.2.2.2.2.cmml" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1"><csymbol cd="latexml" id="S3.E4.m1.20.20.20.2.2.2.2.2.2.1.cmml" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.2">delimited-[]</csymbol><apply id="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.cmml" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.1"><minus id="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.2.cmml" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.1"></minus><apply id="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.cmml" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1"><times id="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.2.cmml" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.2"></times><apply id="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.3.cmml" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.3"><log id="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.3.1.cmml" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.3.1"></log><apply id="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.3.2.cmml" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.3.2.1.cmml" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.3.2">subscript</csymbol><ci id="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.3.2.2.cmml" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.3.2.2">𝑞</ci><ci id="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.3.2.3.cmml" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.3.2.3">italic-ϕ</ci></apply></apply><apply id="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.cmml" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.2.2">𝑦</ci><apply id="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.2.3"><ci id="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.2.3.1">:</ci><apply id="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.2.3.2"><plus id="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.2.3.2.1.cmml" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.2.3.2.1"></plus><ci id="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.2.3.2.2.cmml" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.2.3.2.2">𝑚</ci><cn id="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.2.3.2.3.cmml" type="integer" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.2.3.2.3">1</cn></apply><ci id="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.2.3.3">𝑁</ci></apply></apply><ci id="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.20.20.20.2.2.2.2.2.1.1.1.1.1.1.3">𝑋</ci></apply></apply></apply></apply></apply></apply><apply id="S3.E4.m1.21.21.21.3.3.3.1.cmml" xref="S3.E4.m1.21.21.21.3.3.3.1"><times id="S3.E4.m1.21.21.21.3.3.3.1.2.cmml" xref="S3.E4.m1.21.21.21.3.3.3.1.2"></times><ci id="S3.E4.m1.21.21.21.3.3.3.1.3.cmml" xref="S3.E4.m1.21.21.21.3.3.3.1.3">𝐽</ci><ci id="S3.E4.m1.21.21.21.3.3.3.1.1.cmml" xref="S3.E4.m1.21.21.21.3.3.3.1.1">italic-ϕ</ci></apply></apply><ci id="S3.E4.m1.23.23.23.5.5.5.cmml" xref="S3.E4.m1.23.23.23.5.5.5">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.28c">E_{p(X)}\big{[}\text{KL}(p\parallel q_{\phi})\big{]}=E_{p(\mathcal{D})}\left[%
\log\frac{p(y_{m+1:N}|X)}{q_{\phi}(y_{m+1:N}|X)}\right]\\
=\overbrace{E_{p(\mathcal{D})}[-\log q_{\phi}(y_{m+1:N}|X)]}^{J(\phi)}+K,</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.28d">start_ROW start_CELL italic_E start_POSTSUBSCRIPT italic_p ( italic_X ) end_POSTSUBSCRIPT [ KL ( italic_p ∥ italic_q start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ) ] = italic_E start_POSTSUBSCRIPT italic_p ( caligraphic_D ) end_POSTSUBSCRIPT [ roman_log divide start_ARG italic_p ( italic_y start_POSTSUBSCRIPT italic_m + 1 : italic_N end_POSTSUBSCRIPT | italic_X ) end_ARG start_ARG italic_q start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_m + 1 : italic_N end_POSTSUBSCRIPT | italic_X ) end_ARG ] end_CELL end_ROW start_ROW start_CELL = over⏞ start_ARG italic_E start_POSTSUBSCRIPT italic_p ( caligraphic_D ) end_POSTSUBSCRIPT [ - roman_log italic_q start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_m + 1 : italic_N end_POSTSUBSCRIPT | italic_X ) ] end_ARG start_POSTSUPERSCRIPT italic_J ( italic_ϕ ) end_POSTSUPERSCRIPT + italic_K , end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p2.16">where <math alttext="J(\phi)" class="ltx_Math" display="inline" id="S3.SS1.p2.10.m1.1"><semantics id="S3.SS1.p2.10.m1.1a"><mrow id="S3.SS1.p2.10.m1.1.2" xref="S3.SS1.p2.10.m1.1.2.cmml"><mi id="S3.SS1.p2.10.m1.1.2.2" xref="S3.SS1.p2.10.m1.1.2.2.cmml">J</mi><mo id="S3.SS1.p2.10.m1.1.2.1" xref="S3.SS1.p2.10.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.p2.10.m1.1.2.3.2" xref="S3.SS1.p2.10.m1.1.2.cmml"><mo id="S3.SS1.p2.10.m1.1.2.3.2.1" stretchy="false" xref="S3.SS1.p2.10.m1.1.2.cmml">(</mo><mi id="S3.SS1.p2.10.m1.1.1" xref="S3.SS1.p2.10.m1.1.1.cmml">ϕ</mi><mo id="S3.SS1.p2.10.m1.1.2.3.2.2" stretchy="false" xref="S3.SS1.p2.10.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.10.m1.1b"><apply id="S3.SS1.p2.10.m1.1.2.cmml" xref="S3.SS1.p2.10.m1.1.2"><times id="S3.SS1.p2.10.m1.1.2.1.cmml" xref="S3.SS1.p2.10.m1.1.2.1"></times><ci id="S3.SS1.p2.10.m1.1.2.2.cmml" xref="S3.SS1.p2.10.m1.1.2.2">𝐽</ci><ci id="S3.SS1.p2.10.m1.1.1.cmml" xref="S3.SS1.p2.10.m1.1.1">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.10.m1.1c">J(\phi)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.10.m1.1d">italic_J ( italic_ϕ )</annotation></semantics></math> is the loss function to be minimized w.r.t. <math alttext="\phi" class="ltx_Math" display="inline" id="S3.SS1.p2.11.m2.1"><semantics id="S3.SS1.p2.11.m2.1a"><mi id="S3.SS1.p2.11.m2.1.1" xref="S3.SS1.p2.11.m2.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.11.m2.1b"><ci id="S3.SS1.p2.11.m2.1.1.cmml" xref="S3.SS1.p2.11.m2.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.11.m2.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.11.m2.1d">italic_ϕ</annotation></semantics></math>, and <math alttext="K" class="ltx_Math" display="inline" id="S3.SS1.p2.12.m3.1"><semantics id="S3.SS1.p2.12.m3.1a"><mi id="S3.SS1.p2.12.m3.1.1" xref="S3.SS1.p2.12.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.12.m3.1b"><ci id="S3.SS1.p2.12.m3.1.1.cmml" xref="S3.SS1.p2.12.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.12.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.12.m3.1d">italic_K</annotation></semantics></math> is a term does not depend on <math alttext="\phi" class="ltx_Math" display="inline" id="S3.SS1.p2.13.m4.1"><semantics id="S3.SS1.p2.13.m4.1a"><mi id="S3.SS1.p2.13.m4.1.1" xref="S3.SS1.p2.13.m4.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.13.m4.1b"><ci id="S3.SS1.p2.13.m4.1.1.cmml" xref="S3.SS1.p2.13.m4.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.13.m4.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.13.m4.1d">italic_ϕ</annotation></semantics></math>.
To evaluate <math alttext="J(\phi)" class="ltx_Math" display="inline" id="S3.SS1.p2.14.m5.1"><semantics id="S3.SS1.p2.14.m5.1a"><mrow id="S3.SS1.p2.14.m5.1.2" xref="S3.SS1.p2.14.m5.1.2.cmml"><mi id="S3.SS1.p2.14.m5.1.2.2" xref="S3.SS1.p2.14.m5.1.2.2.cmml">J</mi><mo id="S3.SS1.p2.14.m5.1.2.1" xref="S3.SS1.p2.14.m5.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.p2.14.m5.1.2.3.2" xref="S3.SS1.p2.14.m5.1.2.cmml"><mo id="S3.SS1.p2.14.m5.1.2.3.2.1" stretchy="false" xref="S3.SS1.p2.14.m5.1.2.cmml">(</mo><mi id="S3.SS1.p2.14.m5.1.1" xref="S3.SS1.p2.14.m5.1.1.cmml">ϕ</mi><mo id="S3.SS1.p2.14.m5.1.2.3.2.2" stretchy="false" xref="S3.SS1.p2.14.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.14.m5.1b"><apply id="S3.SS1.p2.14.m5.1.2.cmml" xref="S3.SS1.p2.14.m5.1.2"><times id="S3.SS1.p2.14.m5.1.2.1.cmml" xref="S3.SS1.p2.14.m5.1.2.1"></times><ci id="S3.SS1.p2.14.m5.1.2.2.cmml" xref="S3.SS1.p2.14.m5.1.2.2">𝐽</ci><ci id="S3.SS1.p2.14.m5.1.1.cmml" xref="S3.SS1.p2.14.m5.1.1">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.14.m5.1c">J(\phi)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.14.m5.1d">italic_J ( italic_ϕ )</annotation></semantics></math>, the expectation over <math alttext="p(\mathcal{D})" class="ltx_Math" display="inline" id="S3.SS1.p2.15.m6.1"><semantics id="S3.SS1.p2.15.m6.1a"><mrow id="S3.SS1.p2.15.m6.1.2" xref="S3.SS1.p2.15.m6.1.2.cmml"><mi id="S3.SS1.p2.15.m6.1.2.2" xref="S3.SS1.p2.15.m6.1.2.2.cmml">p</mi><mo id="S3.SS1.p2.15.m6.1.2.1" xref="S3.SS1.p2.15.m6.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.p2.15.m6.1.2.3.2" xref="S3.SS1.p2.15.m6.1.2.cmml"><mo id="S3.SS1.p2.15.m6.1.2.3.2.1" stretchy="false" xref="S3.SS1.p2.15.m6.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.15.m6.1.1" xref="S3.SS1.p2.15.m6.1.1.cmml">𝒟</mi><mo id="S3.SS1.p2.15.m6.1.2.3.2.2" stretchy="false" xref="S3.SS1.p2.15.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.15.m6.1b"><apply id="S3.SS1.p2.15.m6.1.2.cmml" xref="S3.SS1.p2.15.m6.1.2"><times id="S3.SS1.p2.15.m6.1.2.1.cmml" xref="S3.SS1.p2.15.m6.1.2.1"></times><ci id="S3.SS1.p2.15.m6.1.2.2.cmml" xref="S3.SS1.p2.15.m6.1.2.2">𝑝</ci><ci id="S3.SS1.p2.15.m6.1.1.cmml" xref="S3.SS1.p2.15.m6.1.1">𝒟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.15.m6.1c">p(\mathcal{D})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.15.m6.1d">italic_p ( caligraphic_D )</annotation></semantics></math>, which is in general analytically intractable, is replaced by a Monte Carlo estimate over <math alttext="b" class="ltx_Math" display="inline" id="S3.SS1.p2.16.m7.1"><semantics id="S3.SS1.p2.16.m7.1a"><mi id="S3.SS1.p2.16.m7.1.1" xref="S3.SS1.p2.16.m7.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.16.m7.1b"><ci id="S3.SS1.p2.16.m7.1.1.cmml" xref="S3.SS1.p2.16.m7.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.16.m7.1c">b</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.16.m7.1d">italic_b</annotation></semantics></math> sampled datasets:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="J(\phi)\approx\frac{1}{b}\sum_{i=1}^{b}-\log q_{\phi}(y_{m+1:N}^{(i)}|X^{(i)})," class="ltx_Math" display="block" id="S3.E5.m1.4"><semantics id="S3.E5.m1.4a"><mrow id="S3.E5.m1.4.4.1" xref="S3.E5.m1.4.4.1.1.cmml"><mrow id="S3.E5.m1.4.4.1.1" xref="S3.E5.m1.4.4.1.1.cmml"><mrow id="S3.E5.m1.4.4.1.1.3" xref="S3.E5.m1.4.4.1.1.3.cmml"><mi id="S3.E5.m1.4.4.1.1.3.2" xref="S3.E5.m1.4.4.1.1.3.2.cmml">J</mi><mo id="S3.E5.m1.4.4.1.1.3.1" xref="S3.E5.m1.4.4.1.1.3.1.cmml">⁢</mo><mrow id="S3.E5.m1.4.4.1.1.3.3.2" xref="S3.E5.m1.4.4.1.1.3.cmml"><mo id="S3.E5.m1.4.4.1.1.3.3.2.1" stretchy="false" xref="S3.E5.m1.4.4.1.1.3.cmml">(</mo><mi id="S3.E5.m1.3.3" xref="S3.E5.m1.3.3.cmml">ϕ</mi><mo id="S3.E5.m1.4.4.1.1.3.3.2.2" stretchy="false" xref="S3.E5.m1.4.4.1.1.3.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.4.4.1.1.2" xref="S3.E5.m1.4.4.1.1.2.cmml">≈</mo><mrow id="S3.E5.m1.4.4.1.1.1" xref="S3.E5.m1.4.4.1.1.1.cmml"><mrow id="S3.E5.m1.4.4.1.1.1.3" xref="S3.E5.m1.4.4.1.1.1.3.cmml"><mfrac id="S3.E5.m1.4.4.1.1.1.3.2" xref="S3.E5.m1.4.4.1.1.1.3.2.cmml"><mn id="S3.E5.m1.4.4.1.1.1.3.2.2" xref="S3.E5.m1.4.4.1.1.1.3.2.2.cmml">1</mn><mi id="S3.E5.m1.4.4.1.1.1.3.2.3" xref="S3.E5.m1.4.4.1.1.1.3.2.3.cmml">b</mi></mfrac><mo id="S3.E5.m1.4.4.1.1.1.3.1" xref="S3.E5.m1.4.4.1.1.1.3.1.cmml">⁢</mo><munderover id="S3.E5.m1.4.4.1.1.1.3.3" xref="S3.E5.m1.4.4.1.1.1.3.3.cmml"><mo id="S3.E5.m1.4.4.1.1.1.3.3.2.2" movablelimits="false" rspace="0em" xref="S3.E5.m1.4.4.1.1.1.3.3.2.2.cmml">∑</mo><mrow id="S3.E5.m1.4.4.1.1.1.3.3.2.3" xref="S3.E5.m1.4.4.1.1.1.3.3.2.3.cmml"><mi id="S3.E5.m1.4.4.1.1.1.3.3.2.3.2" xref="S3.E5.m1.4.4.1.1.1.3.3.2.3.2.cmml">i</mi><mo id="S3.E5.m1.4.4.1.1.1.3.3.2.3.1" xref="S3.E5.m1.4.4.1.1.1.3.3.2.3.1.cmml">=</mo><mn id="S3.E5.m1.4.4.1.1.1.3.3.2.3.3" xref="S3.E5.m1.4.4.1.1.1.3.3.2.3.3.cmml">1</mn></mrow><mi id="S3.E5.m1.4.4.1.1.1.3.3.3" xref="S3.E5.m1.4.4.1.1.1.3.3.3.cmml">b</mi></munderover></mrow><mo id="S3.E5.m1.4.4.1.1.1.2" lspace="0em" xref="S3.E5.m1.4.4.1.1.1.2.cmml">−</mo><mrow id="S3.E5.m1.4.4.1.1.1.1" xref="S3.E5.m1.4.4.1.1.1.1.cmml"><mrow id="S3.E5.m1.4.4.1.1.1.1.3" xref="S3.E5.m1.4.4.1.1.1.1.3.cmml"><mi id="S3.E5.m1.4.4.1.1.1.1.3.1" xref="S3.E5.m1.4.4.1.1.1.1.3.1.cmml">log</mi><mo id="S3.E5.m1.4.4.1.1.1.1.3a" lspace="0.167em" xref="S3.E5.m1.4.4.1.1.1.1.3.cmml">⁡</mo><msub id="S3.E5.m1.4.4.1.1.1.1.3.2" xref="S3.E5.m1.4.4.1.1.1.1.3.2.cmml"><mi id="S3.E5.m1.4.4.1.1.1.1.3.2.2" xref="S3.E5.m1.4.4.1.1.1.1.3.2.2.cmml">q</mi><mi id="S3.E5.m1.4.4.1.1.1.1.3.2.3" xref="S3.E5.m1.4.4.1.1.1.1.3.2.3.cmml">ϕ</mi></msub></mrow><mo id="S3.E5.m1.4.4.1.1.1.1.2" xref="S3.E5.m1.4.4.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.4.4.1.1.1.1.1.1" xref="S3.E5.m1.4.4.1.1.1.1.1.1.1.cmml"><mo id="S3.E5.m1.4.4.1.1.1.1.1.1.2" stretchy="false" xref="S3.E5.m1.4.4.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.4.4.1.1.1.1.1.1.1" xref="S3.E5.m1.4.4.1.1.1.1.1.1.1.cmml"><msubsup id="S3.E5.m1.4.4.1.1.1.1.1.1.1.2" xref="S3.E5.m1.4.4.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E5.m1.4.4.1.1.1.1.1.1.1.2.2.2" xref="S3.E5.m1.4.4.1.1.1.1.1.1.1.2.2.2.cmml">y</mi><mrow id="S3.E5.m1.4.4.1.1.1.1.1.1.1.2.2.3" xref="S3.E5.m1.4.4.1.1.1.1.1.1.1.2.2.3.cmml"><mrow id="S3.E5.m1.4.4.1.1.1.1.1.1.1.2.2.3.2" xref="S3.E5.m1.4.4.1.1.1.1.1.1.1.2.2.3.2.cmml"><mi id="S3.E5.m1.4.4.1.1.1.1.1.1.1.2.2.3.2.2" xref="S3.E5.m1.4.4.1.1.1.1.1.1.1.2.2.3.2.2.cmml">m</mi><mo id="S3.E5.m1.4.4.1.1.1.1.1.1.1.2.2.3.2.1" xref="S3.E5.m1.4.4.1.1.1.1.1.1.1.2.2.3.2.1.cmml">+</mo><mn id="S3.E5.m1.4.4.1.1.1.1.1.1.1.2.2.3.2.3" xref="S3.E5.m1.4.4.1.1.1.1.1.1.1.2.2.3.2.3.cmml">1</mn></mrow><mo id="S3.E5.m1.4.4.1.1.1.1.1.1.1.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.E5.m1.4.4.1.1.1.1.1.1.1.2.2.3.1.cmml">:</mo><mi id="S3.E5.m1.4.4.1.1.1.1.1.1.1.2.2.3.3" xref="S3.E5.m1.4.4.1.1.1.1.1.1.1.2.2.3.3.cmml">N</mi></mrow><mrow id="S3.E5.m1.1.1.1.3" xref="S3.E5.m1.4.4.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E5.m1.1.1.1.3.1" stretchy="false" xref="S3.E5.m1.4.4.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml">i</mi><mo id="S3.E5.m1.1.1.1.3.2" stretchy="false" xref="S3.E5.m1.4.4.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></msubsup><mo fence="false" id="S3.E5.m1.4.4.1.1.1.1.1.1.1.1" xref="S3.E5.m1.4.4.1.1.1.1.1.1.1.1.cmml">|</mo><msup id="S3.E5.m1.4.4.1.1.1.1.1.1.1.3" xref="S3.E5.m1.4.4.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E5.m1.4.4.1.1.1.1.1.1.1.3.2" xref="S3.E5.m1.4.4.1.1.1.1.1.1.1.3.2.cmml">X</mi><mrow id="S3.E5.m1.2.2.1.3" xref="S3.E5.m1.4.4.1.1.1.1.1.1.1.3.cmml"><mo id="S3.E5.m1.2.2.1.3.1" stretchy="false" xref="S3.E5.m1.4.4.1.1.1.1.1.1.1.3.cmml">(</mo><mi id="S3.E5.m1.2.2.1.1" xref="S3.E5.m1.2.2.1.1.cmml">i</mi><mo id="S3.E5.m1.2.2.1.3.2" stretchy="false" xref="S3.E5.m1.4.4.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></msup></mrow><mo id="S3.E5.m1.4.4.1.1.1.1.1.1.3" stretchy="false" xref="S3.E5.m1.4.4.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E5.m1.4.4.1.2" xref="S3.E5.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.4b"><apply id="S3.E5.m1.4.4.1.1.cmml" xref="S3.E5.m1.4.4.1"><approx id="S3.E5.m1.4.4.1.1.2.cmml" xref="S3.E5.m1.4.4.1.1.2"></approx><apply id="S3.E5.m1.4.4.1.1.3.cmml" xref="S3.E5.m1.4.4.1.1.3"><times id="S3.E5.m1.4.4.1.1.3.1.cmml" xref="S3.E5.m1.4.4.1.1.3.1"></times><ci id="S3.E5.m1.4.4.1.1.3.2.cmml" xref="S3.E5.m1.4.4.1.1.3.2">𝐽</ci><ci id="S3.E5.m1.3.3.cmml" xref="S3.E5.m1.3.3">italic-ϕ</ci></apply><apply id="S3.E5.m1.4.4.1.1.1.cmml" xref="S3.E5.m1.4.4.1.1.1"><minus id="S3.E5.m1.4.4.1.1.1.2.cmml" xref="S3.E5.m1.4.4.1.1.1.2"></minus><apply id="S3.E5.m1.4.4.1.1.1.3.cmml" xref="S3.E5.m1.4.4.1.1.1.3"><times id="S3.E5.m1.4.4.1.1.1.3.1.cmml" xref="S3.E5.m1.4.4.1.1.1.3.1"></times><apply id="S3.E5.m1.4.4.1.1.1.3.2.cmml" xref="S3.E5.m1.4.4.1.1.1.3.2"><divide id="S3.E5.m1.4.4.1.1.1.3.2.1.cmml" xref="S3.E5.m1.4.4.1.1.1.3.2"></divide><cn id="S3.E5.m1.4.4.1.1.1.3.2.2.cmml" type="integer" xref="S3.E5.m1.4.4.1.1.1.3.2.2">1</cn><ci id="S3.E5.m1.4.4.1.1.1.3.2.3.cmml" xref="S3.E5.m1.4.4.1.1.1.3.2.3">𝑏</ci></apply><apply id="S3.E5.m1.4.4.1.1.1.3.3.cmml" xref="S3.E5.m1.4.4.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.1.1.1.3.3.1.cmml" xref="S3.E5.m1.4.4.1.1.1.3.3">superscript</csymbol><apply id="S3.E5.m1.4.4.1.1.1.3.3.2.cmml" xref="S3.E5.m1.4.4.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.1.1.1.3.3.2.1.cmml" xref="S3.E5.m1.4.4.1.1.1.3.3">subscript</csymbol><sum id="S3.E5.m1.4.4.1.1.1.3.3.2.2.cmml" xref="S3.E5.m1.4.4.1.1.1.3.3.2.2"></sum><apply id="S3.E5.m1.4.4.1.1.1.3.3.2.3.cmml" xref="S3.E5.m1.4.4.1.1.1.3.3.2.3"><eq id="S3.E5.m1.4.4.1.1.1.3.3.2.3.1.cmml" xref="S3.E5.m1.4.4.1.1.1.3.3.2.3.1"></eq><ci id="S3.E5.m1.4.4.1.1.1.3.3.2.3.2.cmml" xref="S3.E5.m1.4.4.1.1.1.3.3.2.3.2">𝑖</ci><cn id="S3.E5.m1.4.4.1.1.1.3.3.2.3.3.cmml" type="integer" xref="S3.E5.m1.4.4.1.1.1.3.3.2.3.3">1</cn></apply></apply><ci id="S3.E5.m1.4.4.1.1.1.3.3.3.cmml" xref="S3.E5.m1.4.4.1.1.1.3.3.3">𝑏</ci></apply></apply><apply id="S3.E5.m1.4.4.1.1.1.1.cmml" xref="S3.E5.m1.4.4.1.1.1.1"><times id="S3.E5.m1.4.4.1.1.1.1.2.cmml" xref="S3.E5.m1.4.4.1.1.1.1.2"></times><apply id="S3.E5.m1.4.4.1.1.1.1.3.cmml" xref="S3.E5.m1.4.4.1.1.1.1.3"><log id="S3.E5.m1.4.4.1.1.1.1.3.1.cmml" xref="S3.E5.m1.4.4.1.1.1.1.3.1"></log><apply id="S3.E5.m1.4.4.1.1.1.1.3.2.cmml" xref="S3.E5.m1.4.4.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.1.1.1.1.3.2.1.cmml" xref="S3.E5.m1.4.4.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E5.m1.4.4.1.1.1.1.3.2.2.cmml" xref="S3.E5.m1.4.4.1.1.1.1.3.2.2">𝑞</ci><ci id="S3.E5.m1.4.4.1.1.1.1.3.2.3.cmml" xref="S3.E5.m1.4.4.1.1.1.1.3.2.3">italic-ϕ</ci></apply></apply><apply id="S3.E5.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E5.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.E5.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E5.m1.4.4.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E5.m1.4.4.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1.1.2.2.2">𝑦</ci><apply id="S3.E5.m1.4.4.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1.1.2.2.3"><ci id="S3.E5.m1.4.4.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1.1.2.2.3.1">:</ci><apply id="S3.E5.m1.4.4.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1.1.2.2.3.2"><plus id="S3.E5.m1.4.4.1.1.1.1.1.1.1.2.2.3.2.1.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1.1.2.2.3.2.1"></plus><ci id="S3.E5.m1.4.4.1.1.1.1.1.1.1.2.2.3.2.2.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1.1.2.2.3.2.2">𝑚</ci><cn id="S3.E5.m1.4.4.1.1.1.1.1.1.1.2.2.3.2.3.cmml" type="integer" xref="S3.E5.m1.4.4.1.1.1.1.1.1.1.2.2.3.2.3">1</cn></apply><ci id="S3.E5.m1.4.4.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1.1.2.2.3.3">𝑁</ci></apply></apply><ci id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1">𝑖</ci></apply><apply id="S3.E5.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E5.m1.4.4.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1.1.3.2">𝑋</ci><ci id="S3.E5.m1.2.2.1.1.cmml" xref="S3.E5.m1.2.2.1.1">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.4c">J(\phi)\approx\frac{1}{b}\sum_{i=1}^{b}-\log q_{\phi}(y_{m+1:N}^{(i)}|X^{(i)}),</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.4d">italic_J ( italic_ϕ ) ≈ divide start_ARG 1 end_ARG start_ARG italic_b end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_b end_POSTSUPERSCRIPT - roman_log italic_q start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_m + 1 : italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT | italic_X start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p2.19">where <math alttext="y_{m+1:N}^{(i)}" class="ltx_Math" display="inline" id="S3.SS1.p2.17.m1.1"><semantics id="S3.SS1.p2.17.m1.1a"><msubsup id="S3.SS1.p2.17.m1.1.2" xref="S3.SS1.p2.17.m1.1.2.cmml"><mi id="S3.SS1.p2.17.m1.1.2.2.2" xref="S3.SS1.p2.17.m1.1.2.2.2.cmml">y</mi><mrow id="S3.SS1.p2.17.m1.1.2.2.3" xref="S3.SS1.p2.17.m1.1.2.2.3.cmml"><mrow id="S3.SS1.p2.17.m1.1.2.2.3.2" xref="S3.SS1.p2.17.m1.1.2.2.3.2.cmml"><mi id="S3.SS1.p2.17.m1.1.2.2.3.2.2" xref="S3.SS1.p2.17.m1.1.2.2.3.2.2.cmml">m</mi><mo id="S3.SS1.p2.17.m1.1.2.2.3.2.1" xref="S3.SS1.p2.17.m1.1.2.2.3.2.1.cmml">+</mo><mn id="S3.SS1.p2.17.m1.1.2.2.3.2.3" xref="S3.SS1.p2.17.m1.1.2.2.3.2.3.cmml">1</mn></mrow><mo id="S3.SS1.p2.17.m1.1.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p2.17.m1.1.2.2.3.1.cmml">:</mo><mi id="S3.SS1.p2.17.m1.1.2.2.3.3" xref="S3.SS1.p2.17.m1.1.2.2.3.3.cmml">N</mi></mrow><mrow id="S3.SS1.p2.17.m1.1.1.1.3" xref="S3.SS1.p2.17.m1.1.2.cmml"><mo id="S3.SS1.p2.17.m1.1.1.1.3.1" stretchy="false" xref="S3.SS1.p2.17.m1.1.2.cmml">(</mo><mi id="S3.SS1.p2.17.m1.1.1.1.1" xref="S3.SS1.p2.17.m1.1.1.1.1.cmml">i</mi><mo id="S3.SS1.p2.17.m1.1.1.1.3.2" stretchy="false" xref="S3.SS1.p2.17.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.17.m1.1b"><apply id="S3.SS1.p2.17.m1.1.2.cmml" xref="S3.SS1.p2.17.m1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.17.m1.1.2.1.cmml" xref="S3.SS1.p2.17.m1.1.2">superscript</csymbol><apply id="S3.SS1.p2.17.m1.1.2.2.cmml" xref="S3.SS1.p2.17.m1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.17.m1.1.2.2.1.cmml" xref="S3.SS1.p2.17.m1.1.2">subscript</csymbol><ci id="S3.SS1.p2.17.m1.1.2.2.2.cmml" xref="S3.SS1.p2.17.m1.1.2.2.2">𝑦</ci><apply id="S3.SS1.p2.17.m1.1.2.2.3.cmml" xref="S3.SS1.p2.17.m1.1.2.2.3"><ci id="S3.SS1.p2.17.m1.1.2.2.3.1.cmml" xref="S3.SS1.p2.17.m1.1.2.2.3.1">:</ci><apply id="S3.SS1.p2.17.m1.1.2.2.3.2.cmml" xref="S3.SS1.p2.17.m1.1.2.2.3.2"><plus id="S3.SS1.p2.17.m1.1.2.2.3.2.1.cmml" xref="S3.SS1.p2.17.m1.1.2.2.3.2.1"></plus><ci id="S3.SS1.p2.17.m1.1.2.2.3.2.2.cmml" xref="S3.SS1.p2.17.m1.1.2.2.3.2.2">𝑚</ci><cn id="S3.SS1.p2.17.m1.1.2.2.3.2.3.cmml" type="integer" xref="S3.SS1.p2.17.m1.1.2.2.3.2.3">1</cn></apply><ci id="S3.SS1.p2.17.m1.1.2.2.3.3.cmml" xref="S3.SS1.p2.17.m1.1.2.2.3.3">𝑁</ci></apply></apply><ci id="S3.SS1.p2.17.m1.1.1.1.1.cmml" xref="S3.SS1.p2.17.m1.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.17.m1.1c">y_{m+1:N}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.17.m1.1d">italic_y start_POSTSUBSCRIPT italic_m + 1 : italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="X^{(i)},i=1,\dots,b" class="ltx_Math" display="inline" id="S3.SS1.p2.18.m2.6"><semantics id="S3.SS1.p2.18.m2.6a"><mrow id="S3.SS1.p2.18.m2.6.6.2" xref="S3.SS1.p2.18.m2.6.6.3.cmml"><mrow id="S3.SS1.p2.18.m2.5.5.1.1" xref="S3.SS1.p2.18.m2.5.5.1.1.cmml"><mrow id="S3.SS1.p2.18.m2.5.5.1.1.1.1" xref="S3.SS1.p2.18.m2.5.5.1.1.1.2.cmml"><msup id="S3.SS1.p2.18.m2.5.5.1.1.1.1.1" xref="S3.SS1.p2.18.m2.5.5.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.18.m2.5.5.1.1.1.1.1.2" xref="S3.SS1.p2.18.m2.5.5.1.1.1.1.1.2.cmml">X</mi><mrow id="S3.SS1.p2.18.m2.1.1.1.3" xref="S3.SS1.p2.18.m2.5.5.1.1.1.1.1.cmml"><mo id="S3.SS1.p2.18.m2.1.1.1.3.1" stretchy="false" xref="S3.SS1.p2.18.m2.5.5.1.1.1.1.1.cmml">(</mo><mi id="S3.SS1.p2.18.m2.1.1.1.1" xref="S3.SS1.p2.18.m2.1.1.1.1.cmml">i</mi><mo id="S3.SS1.p2.18.m2.1.1.1.3.2" stretchy="false" xref="S3.SS1.p2.18.m2.5.5.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.SS1.p2.18.m2.5.5.1.1.1.1.2" xref="S3.SS1.p2.18.m2.5.5.1.1.1.2.cmml">,</mo><mi id="S3.SS1.p2.18.m2.2.2" xref="S3.SS1.p2.18.m2.2.2.cmml">i</mi></mrow><mo id="S3.SS1.p2.18.m2.5.5.1.1.2" xref="S3.SS1.p2.18.m2.5.5.1.1.2.cmml">=</mo><mn id="S3.SS1.p2.18.m2.5.5.1.1.3" xref="S3.SS1.p2.18.m2.5.5.1.1.3.cmml">1</mn></mrow><mo id="S3.SS1.p2.18.m2.6.6.2.3" xref="S3.SS1.p2.18.m2.6.6.3a.cmml">,</mo><mrow id="S3.SS1.p2.18.m2.6.6.2.2.2" xref="S3.SS1.p2.18.m2.6.6.2.2.1.cmml"><mi id="S3.SS1.p2.18.m2.3.3" mathvariant="normal" xref="S3.SS1.p2.18.m2.3.3.cmml">…</mi><mo id="S3.SS1.p2.18.m2.6.6.2.2.2.1" xref="S3.SS1.p2.18.m2.6.6.2.2.1.cmml">,</mo><mi id="S3.SS1.p2.18.m2.4.4" xref="S3.SS1.p2.18.m2.4.4.cmml">b</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.18.m2.6b"><apply id="S3.SS1.p2.18.m2.6.6.3.cmml" xref="S3.SS1.p2.18.m2.6.6.2"><csymbol cd="ambiguous" id="S3.SS1.p2.18.m2.6.6.3a.cmml" xref="S3.SS1.p2.18.m2.6.6.2.3">formulae-sequence</csymbol><apply id="S3.SS1.p2.18.m2.5.5.1.1.cmml" xref="S3.SS1.p2.18.m2.5.5.1.1"><eq id="S3.SS1.p2.18.m2.5.5.1.1.2.cmml" xref="S3.SS1.p2.18.m2.5.5.1.1.2"></eq><list id="S3.SS1.p2.18.m2.5.5.1.1.1.2.cmml" xref="S3.SS1.p2.18.m2.5.5.1.1.1.1"><apply id="S3.SS1.p2.18.m2.5.5.1.1.1.1.1.cmml" xref="S3.SS1.p2.18.m2.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.18.m2.5.5.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.18.m2.5.5.1.1.1.1.1">superscript</csymbol><ci id="S3.SS1.p2.18.m2.5.5.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.18.m2.5.5.1.1.1.1.1.2">𝑋</ci><ci id="S3.SS1.p2.18.m2.1.1.1.1.cmml" xref="S3.SS1.p2.18.m2.1.1.1.1">𝑖</ci></apply><ci id="S3.SS1.p2.18.m2.2.2.cmml" xref="S3.SS1.p2.18.m2.2.2">𝑖</ci></list><cn id="S3.SS1.p2.18.m2.5.5.1.1.3.cmml" type="integer" xref="S3.SS1.p2.18.m2.5.5.1.1.3">1</cn></apply><list id="S3.SS1.p2.18.m2.6.6.2.2.1.cmml" xref="S3.SS1.p2.18.m2.6.6.2.2.2"><ci id="S3.SS1.p2.18.m2.3.3.cmml" xref="S3.SS1.p2.18.m2.3.3">…</ci><ci id="S3.SS1.p2.18.m2.4.4.cmml" xref="S3.SS1.p2.18.m2.4.4">𝑏</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.18.m2.6c">X^{(i)},i=1,\dots,b</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.18.m2.6d">italic_X start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_i = 1 , … , italic_b</annotation></semantics></math> are samples from <math alttext="p(\mathcal{D})" class="ltx_Math" display="inline" id="S3.SS1.p2.19.m3.1"><semantics id="S3.SS1.p2.19.m3.1a"><mrow id="S3.SS1.p2.19.m3.1.2" xref="S3.SS1.p2.19.m3.1.2.cmml"><mi id="S3.SS1.p2.19.m3.1.2.2" xref="S3.SS1.p2.19.m3.1.2.2.cmml">p</mi><mo id="S3.SS1.p2.19.m3.1.2.1" xref="S3.SS1.p2.19.m3.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.p2.19.m3.1.2.3.2" xref="S3.SS1.p2.19.m3.1.2.cmml"><mo id="S3.SS1.p2.19.m3.1.2.3.2.1" stretchy="false" xref="S3.SS1.p2.19.m3.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.19.m3.1.1" xref="S3.SS1.p2.19.m3.1.1.cmml">𝒟</mi><mo id="S3.SS1.p2.19.m3.1.2.3.2.2" stretchy="false" xref="S3.SS1.p2.19.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.19.m3.1b"><apply id="S3.SS1.p2.19.m3.1.2.cmml" xref="S3.SS1.p2.19.m3.1.2"><times id="S3.SS1.p2.19.m3.1.2.1.cmml" xref="S3.SS1.p2.19.m3.1.2.1"></times><ci id="S3.SS1.p2.19.m3.1.2.2.cmml" xref="S3.SS1.p2.19.m3.1.2.2">𝑝</ci><ci id="S3.SS1.p2.19.m3.1.1.cmml" xref="S3.SS1.p2.19.m3.1.1">𝒟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.19.m3.1c">p(\mathcal{D})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.19.m3.1d">italic_p ( caligraphic_D )</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.4">In practice, an iterative gradient-based algorithm is applied to minimize <math alttext="J(\phi)" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.1"><semantics id="S3.SS1.p3.1.m1.1a"><mrow id="S3.SS1.p3.1.m1.1.2" xref="S3.SS1.p3.1.m1.1.2.cmml"><mi id="S3.SS1.p3.1.m1.1.2.2" xref="S3.SS1.p3.1.m1.1.2.2.cmml">J</mi><mo id="S3.SS1.p3.1.m1.1.2.1" xref="S3.SS1.p3.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.p3.1.m1.1.2.3.2" xref="S3.SS1.p3.1.m1.1.2.cmml"><mo id="S3.SS1.p3.1.m1.1.2.3.2.1" stretchy="false" xref="S3.SS1.p3.1.m1.1.2.cmml">(</mo><mi id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml">ϕ</mi><mo id="S3.SS1.p3.1.m1.1.2.3.2.2" stretchy="false" xref="S3.SS1.p3.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.2"><times id="S3.SS1.p3.1.m1.1.2.1.cmml" xref="S3.SS1.p3.1.m1.1.2.1"></times><ci id="S3.SS1.p3.1.m1.1.2.2.cmml" xref="S3.SS1.p3.1.m1.1.2.2">𝐽</ci><ci id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">J(\phi)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.1d">italic_J ( italic_ϕ )</annotation></semantics></math>.
Each optimization iteration involves evaluating (<a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#S3.E5" title="In 3.1 Learning Probability Distributions ‣ 3 Advancing the Transformer Architecture ‣ Enhanced Transformer architecture for in-context learning of dynamical systems"><span class="ltx_text ltx_ref_tag">5</span></a>) over <math alttext="b" class="ltx_Math" display="inline" id="S3.SS1.p3.2.m2.1"><semantics id="S3.SS1.p3.2.m2.1a"><mi id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><ci id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">b</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.2.m2.1d">italic_b</annotation></semantics></math> newly sampled datasets, computing its gradient with respect to <math alttext="\phi" class="ltx_Math" display="inline" id="S3.SS1.p3.3.m3.1"><semantics id="S3.SS1.p3.3.m3.1a"><mi id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><ci id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.3.m3.1d">italic_ϕ</annotation></semantics></math>, and updating the parameters accordingly. In other words, training is performed in a (minibatch) stochastic gradient descent fashion, where <math alttext="b" class="ltx_Math" display="inline" id="S3.SS1.p3.4.m4.1"><semantics id="S3.SS1.p3.4.m4.1a"><mi id="S3.SS1.p3.4.m4.1.1" xref="S3.SS1.p3.4.m4.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.1b"><ci id="S3.SS1.p3.4.m4.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.1c">b</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.4.m4.1d">italic_b</annotation></semantics></math> plays the role of the minibatch size.</p>
</div>
<div class="ltx_para" id="S3.SS1.p4">
<p class="ltx_p" id="S3.SS1.p4.3">In this work, we model the parametric distribution <math alttext="q_{\phi}" class="ltx_Math" display="inline" id="S3.SS1.p4.1.m1.1"><semantics id="S3.SS1.p4.1.m1.1a"><msub id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml"><mi id="S3.SS1.p4.1.m1.1.1.2" xref="S3.SS1.p4.1.m1.1.1.2.cmml">q</mi><mi id="S3.SS1.p4.1.m1.1.1.3" xref="S3.SS1.p4.1.m1.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b"><apply id="S3.SS1.p4.1.m1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p4.1.m1.1.1.2.cmml" xref="S3.SS1.p4.1.m1.1.1.2">𝑞</ci><ci id="S3.SS1.p4.1.m1.1.1.3.cmml" xref="S3.SS1.p4.1.m1.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">q_{\phi}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.1.m1.1d">italic_q start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math> as a multivariate Gaussian with diagonal covariance. For the sake of exposition, we consider the single-output case (i.e., <math alttext="n_{y}=1" class="ltx_Math" display="inline" id="S3.SS1.p4.2.m2.1"><semantics id="S3.SS1.p4.2.m2.1a"><mrow id="S3.SS1.p4.2.m2.1.1" xref="S3.SS1.p4.2.m2.1.1.cmml"><msub id="S3.SS1.p4.2.m2.1.1.2" xref="S3.SS1.p4.2.m2.1.1.2.cmml"><mi id="S3.SS1.p4.2.m2.1.1.2.2" xref="S3.SS1.p4.2.m2.1.1.2.2.cmml">n</mi><mi id="S3.SS1.p4.2.m2.1.1.2.3" xref="S3.SS1.p4.2.m2.1.1.2.3.cmml">y</mi></msub><mo id="S3.SS1.p4.2.m2.1.1.1" xref="S3.SS1.p4.2.m2.1.1.1.cmml">=</mo><mn id="S3.SS1.p4.2.m2.1.1.3" xref="S3.SS1.p4.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.2.m2.1b"><apply id="S3.SS1.p4.2.m2.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1"><eq id="S3.SS1.p4.2.m2.1.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1.1"></eq><apply id="S3.SS1.p4.2.m2.1.1.2.cmml" xref="S3.SS1.p4.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p4.2.m2.1.1.2.1.cmml" xref="S3.SS1.p4.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS1.p4.2.m2.1.1.2.2.cmml" xref="S3.SS1.p4.2.m2.1.1.2.2">𝑛</ci><ci id="S3.SS1.p4.2.m2.1.1.2.3.cmml" xref="S3.SS1.p4.2.m2.1.1.2.3">𝑦</ci></apply><cn id="S3.SS1.p4.2.m2.1.1.3.cmml" type="integer" xref="S3.SS1.p4.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.2.m2.1c">n_{y}=1</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.2.m2.1d">italic_n start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT = 1</annotation></semantics></math>) in the rest of this paragraph. Thus, <math alttext="q_{\phi}" class="ltx_Math" display="inline" id="S3.SS1.p4.3.m3.1"><semantics id="S3.SS1.p4.3.m3.1a"><msub id="S3.SS1.p4.3.m3.1.1" xref="S3.SS1.p4.3.m3.1.1.cmml"><mi id="S3.SS1.p4.3.m3.1.1.2" xref="S3.SS1.p4.3.m3.1.1.2.cmml">q</mi><mi id="S3.SS1.p4.3.m3.1.1.3" xref="S3.SS1.p4.3.m3.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.3.m3.1b"><apply id="S3.SS1.p4.3.m3.1.1.cmml" xref="S3.SS1.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.3.m3.1.1.1.cmml" xref="S3.SS1.p4.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p4.3.m3.1.1.2.cmml" xref="S3.SS1.p4.3.m3.1.1.2">𝑞</ci><ci id="S3.SS1.p4.3.m3.1.1.3.cmml" xref="S3.SS1.p4.3.m3.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.3.m3.1c">q_{\phi}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.3.m3.1d">italic_q start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math> takes form:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E6">
<tbody>
<tr class="ltx_eqn_row" id="S5.EGx1"><td class="ltx_eqn_cell" colspan="5"></td></tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E6.1">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle q_{\phi}(y_{m+1:N}|X)" class="ltx_Math" display="inline" id="S3.E6.1.m1.1"><semantics id="S3.E6.1.m1.1a"><mrow id="S3.E6.1.m1.1.1" xref="S3.E6.1.m1.1.1.cmml"><msub id="S3.E6.1.m1.1.1.3" xref="S3.E6.1.m1.1.1.3.cmml"><mi id="S3.E6.1.m1.1.1.3.2" xref="S3.E6.1.m1.1.1.3.2.cmml">q</mi><mi id="S3.E6.1.m1.1.1.3.3" xref="S3.E6.1.m1.1.1.3.3.cmml">ϕ</mi></msub><mo id="S3.E6.1.m1.1.1.2" xref="S3.E6.1.m1.1.1.2.cmml">⁢</mo><mrow id="S3.E6.1.m1.1.1.1.1" xref="S3.E6.1.m1.1.1.1.1.1.cmml"><mo id="S3.E6.1.m1.1.1.1.1.2" stretchy="false" xref="S3.E6.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.1.m1.1.1.1.1.1" xref="S3.E6.1.m1.1.1.1.1.1.cmml"><msub id="S3.E6.1.m1.1.1.1.1.1.2" xref="S3.E6.1.m1.1.1.1.1.1.2.cmml"><mi id="S3.E6.1.m1.1.1.1.1.1.2.2" xref="S3.E6.1.m1.1.1.1.1.1.2.2.cmml">y</mi><mrow id="S3.E6.1.m1.1.1.1.1.1.2.3" xref="S3.E6.1.m1.1.1.1.1.1.2.3.cmml"><mrow id="S3.E6.1.m1.1.1.1.1.1.2.3.2" xref="S3.E6.1.m1.1.1.1.1.1.2.3.2.cmml"><mi id="S3.E6.1.m1.1.1.1.1.1.2.3.2.2" xref="S3.E6.1.m1.1.1.1.1.1.2.3.2.2.cmml">m</mi><mo id="S3.E6.1.m1.1.1.1.1.1.2.3.2.1" xref="S3.E6.1.m1.1.1.1.1.1.2.3.2.1.cmml">+</mo><mn id="S3.E6.1.m1.1.1.1.1.1.2.3.2.3" xref="S3.E6.1.m1.1.1.1.1.1.2.3.2.3.cmml">1</mn></mrow><mo id="S3.E6.1.m1.1.1.1.1.1.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.E6.1.m1.1.1.1.1.1.2.3.1.cmml">:</mo><mi id="S3.E6.1.m1.1.1.1.1.1.2.3.3" xref="S3.E6.1.m1.1.1.1.1.1.2.3.3.cmml">N</mi></mrow></msub><mo fence="false" id="S3.E6.1.m1.1.1.1.1.1.1" xref="S3.E6.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.E6.1.m1.1.1.1.1.1.3" xref="S3.E6.1.m1.1.1.1.1.1.3.cmml">X</mi></mrow><mo id="S3.E6.1.m1.1.1.1.1.3" stretchy="false" xref="S3.E6.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.1.m1.1b"><apply id="S3.E6.1.m1.1.1.cmml" xref="S3.E6.1.m1.1.1"><times id="S3.E6.1.m1.1.1.2.cmml" xref="S3.E6.1.m1.1.1.2"></times><apply id="S3.E6.1.m1.1.1.3.cmml" xref="S3.E6.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.1.m1.1.1.3.1.cmml" xref="S3.E6.1.m1.1.1.3">subscript</csymbol><ci id="S3.E6.1.m1.1.1.3.2.cmml" xref="S3.E6.1.m1.1.1.3.2">𝑞</ci><ci id="S3.E6.1.m1.1.1.3.3.cmml" xref="S3.E6.1.m1.1.1.3.3">italic-ϕ</ci></apply><apply id="S3.E6.1.m1.1.1.1.1.1.cmml" xref="S3.E6.1.m1.1.1.1.1"><csymbol cd="latexml" id="S3.E6.1.m1.1.1.1.1.1.1.cmml" xref="S3.E6.1.m1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.E6.1.m1.1.1.1.1.1.2.cmml" xref="S3.E6.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.1.m1.1.1.1.1.1.2.1.cmml" xref="S3.E6.1.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E6.1.m1.1.1.1.1.1.2.2.cmml" xref="S3.E6.1.m1.1.1.1.1.1.2.2">𝑦</ci><apply id="S3.E6.1.m1.1.1.1.1.1.2.3.cmml" xref="S3.E6.1.m1.1.1.1.1.1.2.3"><ci id="S3.E6.1.m1.1.1.1.1.1.2.3.1.cmml" xref="S3.E6.1.m1.1.1.1.1.1.2.3.1">:</ci><apply id="S3.E6.1.m1.1.1.1.1.1.2.3.2.cmml" xref="S3.E6.1.m1.1.1.1.1.1.2.3.2"><plus id="S3.E6.1.m1.1.1.1.1.1.2.3.2.1.cmml" xref="S3.E6.1.m1.1.1.1.1.1.2.3.2.1"></plus><ci id="S3.E6.1.m1.1.1.1.1.1.2.3.2.2.cmml" xref="S3.E6.1.m1.1.1.1.1.1.2.3.2.2">𝑚</ci><cn id="S3.E6.1.m1.1.1.1.1.1.2.3.2.3.cmml" type="integer" xref="S3.E6.1.m1.1.1.1.1.1.2.3.2.3">1</cn></apply><ci id="S3.E6.1.m1.1.1.1.1.1.2.3.3.cmml" xref="S3.E6.1.m1.1.1.1.1.1.2.3.3">𝑁</ci></apply></apply><ci id="S3.E6.1.m1.1.1.1.1.1.3.cmml" xref="S3.E6.1.m1.1.1.1.1.1.3">𝑋</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.1.m1.1c">\displaystyle q_{\phi}(y_{m+1:N}|X)</annotation><annotation encoding="application/x-llamapun" id="S3.E6.1.m1.1d">italic_q start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_m + 1 : italic_N end_POSTSUBSCRIPT | italic_X )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\prod_{j=m+1}^{N}q_{\phi}(y_{j}|X)" class="ltx_Math" display="inline" id="S3.E6.1.m2.1"><semantics id="S3.E6.1.m2.1a"><mrow id="S3.E6.1.m2.1.1" xref="S3.E6.1.m2.1.1.cmml"><mi id="S3.E6.1.m2.1.1.3" xref="S3.E6.1.m2.1.1.3.cmml"></mi><mo id="S3.E6.1.m2.1.1.2" xref="S3.E6.1.m2.1.1.2.cmml">=</mo><mrow id="S3.E6.1.m2.1.1.1" xref="S3.E6.1.m2.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E6.1.m2.1.1.1.2" xref="S3.E6.1.m2.1.1.1.2.cmml"><munderover id="S3.E6.1.m2.1.1.1.2a" xref="S3.E6.1.m2.1.1.1.2.cmml"><mo id="S3.E6.1.m2.1.1.1.2.2.2" movablelimits="false" xref="S3.E6.1.m2.1.1.1.2.2.2.cmml">∏</mo><mrow id="S3.E6.1.m2.1.1.1.2.2.3" xref="S3.E6.1.m2.1.1.1.2.2.3.cmml"><mi id="S3.E6.1.m2.1.1.1.2.2.3.2" xref="S3.E6.1.m2.1.1.1.2.2.3.2.cmml">j</mi><mo id="S3.E6.1.m2.1.1.1.2.2.3.1" xref="S3.E6.1.m2.1.1.1.2.2.3.1.cmml">=</mo><mrow id="S3.E6.1.m2.1.1.1.2.2.3.3" xref="S3.E6.1.m2.1.1.1.2.2.3.3.cmml"><mi id="S3.E6.1.m2.1.1.1.2.2.3.3.2" xref="S3.E6.1.m2.1.1.1.2.2.3.3.2.cmml">m</mi><mo id="S3.E6.1.m2.1.1.1.2.2.3.3.1" xref="S3.E6.1.m2.1.1.1.2.2.3.3.1.cmml">+</mo><mn id="S3.E6.1.m2.1.1.1.2.2.3.3.3" xref="S3.E6.1.m2.1.1.1.2.2.3.3.3.cmml">1</mn></mrow></mrow><mi id="S3.E6.1.m2.1.1.1.2.3" xref="S3.E6.1.m2.1.1.1.2.3.cmml">N</mi></munderover></mstyle><mrow id="S3.E6.1.m2.1.1.1.1" xref="S3.E6.1.m2.1.1.1.1.cmml"><msub id="S3.E6.1.m2.1.1.1.1.3" xref="S3.E6.1.m2.1.1.1.1.3.cmml"><mi id="S3.E6.1.m2.1.1.1.1.3.2" xref="S3.E6.1.m2.1.1.1.1.3.2.cmml">q</mi><mi id="S3.E6.1.m2.1.1.1.1.3.3" xref="S3.E6.1.m2.1.1.1.1.3.3.cmml">ϕ</mi></msub><mo id="S3.E6.1.m2.1.1.1.1.2" xref="S3.E6.1.m2.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E6.1.m2.1.1.1.1.1.1" xref="S3.E6.1.m2.1.1.1.1.1.1.1.cmml"><mo id="S3.E6.1.m2.1.1.1.1.1.1.2" stretchy="false" xref="S3.E6.1.m2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.1.m2.1.1.1.1.1.1.1" xref="S3.E6.1.m2.1.1.1.1.1.1.1.cmml"><msub id="S3.E6.1.m2.1.1.1.1.1.1.1.2" xref="S3.E6.1.m2.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E6.1.m2.1.1.1.1.1.1.1.2.2" xref="S3.E6.1.m2.1.1.1.1.1.1.1.2.2.cmml">y</mi><mi id="S3.E6.1.m2.1.1.1.1.1.1.1.2.3" xref="S3.E6.1.m2.1.1.1.1.1.1.1.2.3.cmml">j</mi></msub><mo fence="false" id="S3.E6.1.m2.1.1.1.1.1.1.1.1" xref="S3.E6.1.m2.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.E6.1.m2.1.1.1.1.1.1.1.3" xref="S3.E6.1.m2.1.1.1.1.1.1.1.3.cmml">X</mi></mrow><mo id="S3.E6.1.m2.1.1.1.1.1.1.3" stretchy="false" xref="S3.E6.1.m2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.1.m2.1b"><apply id="S3.E6.1.m2.1.1.cmml" xref="S3.E6.1.m2.1.1"><eq id="S3.E6.1.m2.1.1.2.cmml" xref="S3.E6.1.m2.1.1.2"></eq><csymbol cd="latexml" id="S3.E6.1.m2.1.1.3.cmml" xref="S3.E6.1.m2.1.1.3">absent</csymbol><apply id="S3.E6.1.m2.1.1.1.cmml" xref="S3.E6.1.m2.1.1.1"><apply id="S3.E6.1.m2.1.1.1.2.cmml" xref="S3.E6.1.m2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.1.m2.1.1.1.2.1.cmml" xref="S3.E6.1.m2.1.1.1.2">superscript</csymbol><apply id="S3.E6.1.m2.1.1.1.2.2.cmml" xref="S3.E6.1.m2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.1.m2.1.1.1.2.2.1.cmml" xref="S3.E6.1.m2.1.1.1.2">subscript</csymbol><csymbol cd="latexml" id="S3.E6.1.m2.1.1.1.2.2.2.cmml" xref="S3.E6.1.m2.1.1.1.2.2.2">product</csymbol><apply id="S3.E6.1.m2.1.1.1.2.2.3.cmml" xref="S3.E6.1.m2.1.1.1.2.2.3"><eq id="S3.E6.1.m2.1.1.1.2.2.3.1.cmml" xref="S3.E6.1.m2.1.1.1.2.2.3.1"></eq><ci id="S3.E6.1.m2.1.1.1.2.2.3.2.cmml" xref="S3.E6.1.m2.1.1.1.2.2.3.2">𝑗</ci><apply id="S3.E6.1.m2.1.1.1.2.2.3.3.cmml" xref="S3.E6.1.m2.1.1.1.2.2.3.3"><plus id="S3.E6.1.m2.1.1.1.2.2.3.3.1.cmml" xref="S3.E6.1.m2.1.1.1.2.2.3.3.1"></plus><ci id="S3.E6.1.m2.1.1.1.2.2.3.3.2.cmml" xref="S3.E6.1.m2.1.1.1.2.2.3.3.2">𝑚</ci><cn id="S3.E6.1.m2.1.1.1.2.2.3.3.3.cmml" type="integer" xref="S3.E6.1.m2.1.1.1.2.2.3.3.3">1</cn></apply></apply></apply><ci id="S3.E6.1.m2.1.1.1.2.3.cmml" xref="S3.E6.1.m2.1.1.1.2.3">𝑁</ci></apply><apply id="S3.E6.1.m2.1.1.1.1.cmml" xref="S3.E6.1.m2.1.1.1.1"><times id="S3.E6.1.m2.1.1.1.1.2.cmml" xref="S3.E6.1.m2.1.1.1.1.2"></times><apply id="S3.E6.1.m2.1.1.1.1.3.cmml" xref="S3.E6.1.m2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.1.m2.1.1.1.1.3.1.cmml" xref="S3.E6.1.m2.1.1.1.1.3">subscript</csymbol><ci id="S3.E6.1.m2.1.1.1.1.3.2.cmml" xref="S3.E6.1.m2.1.1.1.1.3.2">𝑞</ci><ci id="S3.E6.1.m2.1.1.1.1.3.3.cmml" xref="S3.E6.1.m2.1.1.1.1.3.3">italic-ϕ</ci></apply><apply id="S3.E6.1.m2.1.1.1.1.1.1.1.cmml" xref="S3.E6.1.m2.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E6.1.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.1.m2.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.E6.1.m2.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.1.m2.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.1.m2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.1.m2.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E6.1.m2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.1.m2.1.1.1.1.1.1.1.2.2">𝑦</ci><ci id="S3.E6.1.m2.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.1.m2.1.1.1.1.1.1.1.2.3">𝑗</ci></apply><ci id="S3.E6.1.m2.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.1.m2.1.1.1.1.1.1.1.3">𝑋</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.1.m2.1c">\displaystyle=\prod_{j=m+1}^{N}q_{\phi}(y_{j}|X)</annotation><annotation encoding="application/x-llamapun" id="S3.E6.1.m2.1d">= ∏ start_POSTSUBSCRIPT italic_j = italic_m + 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT italic_q start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT | italic_X )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6a)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E6.2">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle q_{\phi}(y_{j}|X)" class="ltx_Math" display="inline" id="S3.E6.2.m1.1"><semantics id="S3.E6.2.m1.1a"><mrow id="S3.E6.2.m1.1.1" xref="S3.E6.2.m1.1.1.cmml"><msub id="S3.E6.2.m1.1.1.3" xref="S3.E6.2.m1.1.1.3.cmml"><mi id="S3.E6.2.m1.1.1.3.2" xref="S3.E6.2.m1.1.1.3.2.cmml">q</mi><mi id="S3.E6.2.m1.1.1.3.3" xref="S3.E6.2.m1.1.1.3.3.cmml">ϕ</mi></msub><mo id="S3.E6.2.m1.1.1.2" xref="S3.E6.2.m1.1.1.2.cmml">⁢</mo><mrow id="S3.E6.2.m1.1.1.1.1" xref="S3.E6.2.m1.1.1.1.1.1.cmml"><mo id="S3.E6.2.m1.1.1.1.1.2" stretchy="false" xref="S3.E6.2.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.2.m1.1.1.1.1.1" xref="S3.E6.2.m1.1.1.1.1.1.cmml"><msub id="S3.E6.2.m1.1.1.1.1.1.2" xref="S3.E6.2.m1.1.1.1.1.1.2.cmml"><mi id="S3.E6.2.m1.1.1.1.1.1.2.2" xref="S3.E6.2.m1.1.1.1.1.1.2.2.cmml">y</mi><mi id="S3.E6.2.m1.1.1.1.1.1.2.3" xref="S3.E6.2.m1.1.1.1.1.1.2.3.cmml">j</mi></msub><mo fence="false" id="S3.E6.2.m1.1.1.1.1.1.1" xref="S3.E6.2.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.E6.2.m1.1.1.1.1.1.3" xref="S3.E6.2.m1.1.1.1.1.1.3.cmml">X</mi></mrow><mo id="S3.E6.2.m1.1.1.1.1.3" stretchy="false" xref="S3.E6.2.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.2.m1.1b"><apply id="S3.E6.2.m1.1.1.cmml" xref="S3.E6.2.m1.1.1"><times id="S3.E6.2.m1.1.1.2.cmml" xref="S3.E6.2.m1.1.1.2"></times><apply id="S3.E6.2.m1.1.1.3.cmml" xref="S3.E6.2.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.2.m1.1.1.3.1.cmml" xref="S3.E6.2.m1.1.1.3">subscript</csymbol><ci id="S3.E6.2.m1.1.1.3.2.cmml" xref="S3.E6.2.m1.1.1.3.2">𝑞</ci><ci id="S3.E6.2.m1.1.1.3.3.cmml" xref="S3.E6.2.m1.1.1.3.3">italic-ϕ</ci></apply><apply id="S3.E6.2.m1.1.1.1.1.1.cmml" xref="S3.E6.2.m1.1.1.1.1"><csymbol cd="latexml" id="S3.E6.2.m1.1.1.1.1.1.1.cmml" xref="S3.E6.2.m1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.E6.2.m1.1.1.1.1.1.2.cmml" xref="S3.E6.2.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.2.m1.1.1.1.1.1.2.1.cmml" xref="S3.E6.2.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E6.2.m1.1.1.1.1.1.2.2.cmml" xref="S3.E6.2.m1.1.1.1.1.1.2.2">𝑦</ci><ci id="S3.E6.2.m1.1.1.1.1.1.2.3.cmml" xref="S3.E6.2.m1.1.1.1.1.1.2.3">𝑗</ci></apply><ci id="S3.E6.2.m1.1.1.1.1.1.3.cmml" xref="S3.E6.2.m1.1.1.1.1.1.3">𝑋</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.2.m1.1c">\displaystyle q_{\phi}(y_{j}|X)</annotation><annotation encoding="application/x-llamapun" id="S3.E6.2.m1.1d">italic_q start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT | italic_X )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{1}{\sqrt{2\pi\sigma_{j}^{2}(X,\phi)}}e^{\left(-\frac{(y_{j%
}-\mu_{j}(X,\phi))^{2}}{2\sigma_{j}^{2}(X,\phi)}\right)}," class="ltx_Math" display="inline" id="S3.E6.2.m2.9"><semantics id="S3.E6.2.m2.9a"><mrow id="S3.E6.2.m2.9.9.1" xref="S3.E6.2.m2.9.9.1.1.cmml"><mrow id="S3.E6.2.m2.9.9.1.1" xref="S3.E6.2.m2.9.9.1.1.cmml"><mi id="S3.E6.2.m2.9.9.1.1.2" xref="S3.E6.2.m2.9.9.1.1.2.cmml"></mi><mo id="S3.E6.2.m2.9.9.1.1.1" xref="S3.E6.2.m2.9.9.1.1.1.cmml">=</mo><mrow id="S3.E6.2.m2.9.9.1.1.3" xref="S3.E6.2.m2.9.9.1.1.3.cmml"><mstyle displaystyle="true" id="S3.E6.2.m2.2.2" xref="S3.E6.2.m2.2.2.cmml"><mfrac id="S3.E6.2.m2.2.2a" xref="S3.E6.2.m2.2.2.cmml"><mn id="S3.E6.2.m2.2.2.4" xref="S3.E6.2.m2.2.2.4.cmml">1</mn><msqrt id="S3.E6.2.m2.2.2.2" xref="S3.E6.2.m2.2.2.2.cmml"><mrow id="S3.E6.2.m2.2.2.2.2.2" xref="S3.E6.2.m2.2.2.2.2.2.cmml"><mn id="S3.E6.2.m2.2.2.2.2.2.4" xref="S3.E6.2.m2.2.2.2.2.2.4.cmml">2</mn><mo id="S3.E6.2.m2.2.2.2.2.2.3" xref="S3.E6.2.m2.2.2.2.2.2.3.cmml">⁢</mo><mi id="S3.E6.2.m2.2.2.2.2.2.5" xref="S3.E6.2.m2.2.2.2.2.2.5.cmml">π</mi><mo id="S3.E6.2.m2.2.2.2.2.2.3a" xref="S3.E6.2.m2.2.2.2.2.2.3.cmml">⁢</mo><msubsup id="S3.E6.2.m2.2.2.2.2.2.6" xref="S3.E6.2.m2.2.2.2.2.2.6.cmml"><mi id="S3.E6.2.m2.2.2.2.2.2.6.2.2" xref="S3.E6.2.m2.2.2.2.2.2.6.2.2.cmml">σ</mi><mi id="S3.E6.2.m2.2.2.2.2.2.6.2.3" xref="S3.E6.2.m2.2.2.2.2.2.6.2.3.cmml">j</mi><mn id="S3.E6.2.m2.2.2.2.2.2.6.3" xref="S3.E6.2.m2.2.2.2.2.2.6.3.cmml">2</mn></msubsup><mo id="S3.E6.2.m2.2.2.2.2.2.3b" xref="S3.E6.2.m2.2.2.2.2.2.3.cmml">⁢</mo><mrow id="S3.E6.2.m2.2.2.2.2.2.7.2" xref="S3.E6.2.m2.2.2.2.2.2.7.1.cmml"><mo id="S3.E6.2.m2.2.2.2.2.2.7.2.1" stretchy="false" xref="S3.E6.2.m2.2.2.2.2.2.7.1.cmml">(</mo><mi id="S3.E6.2.m2.1.1.1.1.1.1" xref="S3.E6.2.m2.1.1.1.1.1.1.cmml">X</mi><mo id="S3.E6.2.m2.2.2.2.2.2.7.2.2" xref="S3.E6.2.m2.2.2.2.2.2.7.1.cmml">,</mo><mi id="S3.E6.2.m2.2.2.2.2.2.2" xref="S3.E6.2.m2.2.2.2.2.2.2.cmml">ϕ</mi><mo id="S3.E6.2.m2.2.2.2.2.2.7.2.3" stretchy="false" xref="S3.E6.2.m2.2.2.2.2.2.7.1.cmml">)</mo></mrow></mrow></msqrt></mfrac></mstyle><mo id="S3.E6.2.m2.9.9.1.1.3.1" xref="S3.E6.2.m2.9.9.1.1.3.1.cmml">⁢</mo><msup id="S3.E6.2.m2.9.9.1.1.3.2" xref="S3.E6.2.m2.9.9.1.1.3.2.cmml"><mi id="S3.E6.2.m2.9.9.1.1.3.2.2" xref="S3.E6.2.m2.9.9.1.1.3.2.2.cmml">e</mi><mrow id="S3.E6.2.m2.8.8.6.6" xref="S3.E6.2.m2.8.8.6.6.1.cmml"><mo id="S3.E6.2.m2.8.8.6.6.2" xref="S3.E6.2.m2.8.8.6.6.1.cmml">(</mo><mrow id="S3.E6.2.m2.8.8.6.6.1" xref="S3.E6.2.m2.8.8.6.6.1.cmml"><mo id="S3.E6.2.m2.8.8.6.6.1a" xref="S3.E6.2.m2.8.8.6.6.1.cmml">−</mo><mfrac id="S3.E6.2.m2.7.7.5.5" xref="S3.E6.2.m2.7.7.5.5.cmml"><msup id="S3.E6.2.m2.5.5.3.3.3" xref="S3.E6.2.m2.5.5.3.3.3.cmml"><mrow id="S3.E6.2.m2.5.5.3.3.3.3.1" xref="S3.E6.2.m2.5.5.3.3.3.3.1.1.cmml"><mo id="S3.E6.2.m2.5.5.3.3.3.3.1.2" stretchy="false" xref="S3.E6.2.m2.5.5.3.3.3.3.1.1.cmml">(</mo><mrow id="S3.E6.2.m2.5.5.3.3.3.3.1.1" xref="S3.E6.2.m2.5.5.3.3.3.3.1.1.cmml"><msub id="S3.E6.2.m2.5.5.3.3.3.3.1.1.2" xref="S3.E6.2.m2.5.5.3.3.3.3.1.1.2.cmml"><mi id="S3.E6.2.m2.5.5.3.3.3.3.1.1.2.2" xref="S3.E6.2.m2.5.5.3.3.3.3.1.1.2.2.cmml">y</mi><mi id="S3.E6.2.m2.5.5.3.3.3.3.1.1.2.3" xref="S3.E6.2.m2.5.5.3.3.3.3.1.1.2.3.cmml">j</mi></msub><mo id="S3.E6.2.m2.5.5.3.3.3.3.1.1.1" xref="S3.E6.2.m2.5.5.3.3.3.3.1.1.1.cmml">−</mo><mrow id="S3.E6.2.m2.5.5.3.3.3.3.1.1.3" xref="S3.E6.2.m2.5.5.3.3.3.3.1.1.3.cmml"><msub id="S3.E6.2.m2.5.5.3.3.3.3.1.1.3.2" xref="S3.E6.2.m2.5.5.3.3.3.3.1.1.3.2.cmml"><mi id="S3.E6.2.m2.5.5.3.3.3.3.1.1.3.2.2" xref="S3.E6.2.m2.5.5.3.3.3.3.1.1.3.2.2.cmml">μ</mi><mi id="S3.E6.2.m2.5.5.3.3.3.3.1.1.3.2.3" xref="S3.E6.2.m2.5.5.3.3.3.3.1.1.3.2.3.cmml">j</mi></msub><mo id="S3.E6.2.m2.5.5.3.3.3.3.1.1.3.1" xref="S3.E6.2.m2.5.5.3.3.3.3.1.1.3.1.cmml">⁢</mo><mrow id="S3.E6.2.m2.5.5.3.3.3.3.1.1.3.3.2" xref="S3.E6.2.m2.5.5.3.3.3.3.1.1.3.3.1.cmml"><mo id="S3.E6.2.m2.5.5.3.3.3.3.1.1.3.3.2.1" stretchy="false" xref="S3.E6.2.m2.5.5.3.3.3.3.1.1.3.3.1.cmml">(</mo><mi id="S3.E6.2.m2.3.3.1.1.1.1" xref="S3.E6.2.m2.3.3.1.1.1.1.cmml">X</mi><mo id="S3.E6.2.m2.5.5.3.3.3.3.1.1.3.3.2.2" xref="S3.E6.2.m2.5.5.3.3.3.3.1.1.3.3.1.cmml">,</mo><mi id="S3.E6.2.m2.4.4.2.2.2.2" xref="S3.E6.2.m2.4.4.2.2.2.2.cmml">ϕ</mi><mo id="S3.E6.2.m2.5.5.3.3.3.3.1.1.3.3.2.3" stretchy="false" xref="S3.E6.2.m2.5.5.3.3.3.3.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E6.2.m2.5.5.3.3.3.3.1.3" stretchy="false" xref="S3.E6.2.m2.5.5.3.3.3.3.1.1.cmml">)</mo></mrow><mn id="S3.E6.2.m2.5.5.3.3.3.5" xref="S3.E6.2.m2.5.5.3.3.3.5.cmml">2</mn></msup><mrow id="S3.E6.2.m2.7.7.5.5.5" xref="S3.E6.2.m2.7.7.5.5.5.cmml"><mn id="S3.E6.2.m2.7.7.5.5.5.4" xref="S3.E6.2.m2.7.7.5.5.5.4.cmml">2</mn><mo id="S3.E6.2.m2.7.7.5.5.5.3" xref="S3.E6.2.m2.7.7.5.5.5.3.cmml">⁢</mo><msubsup id="S3.E6.2.m2.7.7.5.5.5.5" xref="S3.E6.2.m2.7.7.5.5.5.5.cmml"><mi id="S3.E6.2.m2.7.7.5.5.5.5.2.2" xref="S3.E6.2.m2.7.7.5.5.5.5.2.2.cmml">σ</mi><mi id="S3.E6.2.m2.7.7.5.5.5.5.2.3" xref="S3.E6.2.m2.7.7.5.5.5.5.2.3.cmml">j</mi><mn id="S3.E6.2.m2.7.7.5.5.5.5.3" xref="S3.E6.2.m2.7.7.5.5.5.5.3.cmml">2</mn></msubsup><mo id="S3.E6.2.m2.7.7.5.5.5.3a" xref="S3.E6.2.m2.7.7.5.5.5.3.cmml">⁢</mo><mrow id="S3.E6.2.m2.7.7.5.5.5.6.2" xref="S3.E6.2.m2.7.7.5.5.5.6.1.cmml"><mo id="S3.E6.2.m2.7.7.5.5.5.6.2.1" stretchy="false" xref="S3.E6.2.m2.7.7.5.5.5.6.1.cmml">(</mo><mi id="S3.E6.2.m2.6.6.4.4.4.1" xref="S3.E6.2.m2.6.6.4.4.4.1.cmml">X</mi><mo id="S3.E6.2.m2.7.7.5.5.5.6.2.2" xref="S3.E6.2.m2.7.7.5.5.5.6.1.cmml">,</mo><mi id="S3.E6.2.m2.7.7.5.5.5.2" xref="S3.E6.2.m2.7.7.5.5.5.2.cmml">ϕ</mi><mo id="S3.E6.2.m2.7.7.5.5.5.6.2.3" stretchy="false" xref="S3.E6.2.m2.7.7.5.5.5.6.1.cmml">)</mo></mrow></mrow></mfrac></mrow><mo id="S3.E6.2.m2.8.8.6.6.3" xref="S3.E6.2.m2.8.8.6.6.1.cmml">)</mo></mrow></msup></mrow></mrow><mo id="S3.E6.2.m2.9.9.1.2" xref="S3.E6.2.m2.9.9.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.2.m2.9b"><apply id="S3.E6.2.m2.9.9.1.1.cmml" xref="S3.E6.2.m2.9.9.1"><eq id="S3.E6.2.m2.9.9.1.1.1.cmml" xref="S3.E6.2.m2.9.9.1.1.1"></eq><csymbol cd="latexml" id="S3.E6.2.m2.9.9.1.1.2.cmml" xref="S3.E6.2.m2.9.9.1.1.2">absent</csymbol><apply id="S3.E6.2.m2.9.9.1.1.3.cmml" xref="S3.E6.2.m2.9.9.1.1.3"><times id="S3.E6.2.m2.9.9.1.1.3.1.cmml" xref="S3.E6.2.m2.9.9.1.1.3.1"></times><apply id="S3.E6.2.m2.2.2.cmml" xref="S3.E6.2.m2.2.2"><divide id="S3.E6.2.m2.2.2.3.cmml" xref="S3.E6.2.m2.2.2"></divide><cn id="S3.E6.2.m2.2.2.4.cmml" type="integer" xref="S3.E6.2.m2.2.2.4">1</cn><apply id="S3.E6.2.m2.2.2.2.cmml" xref="S3.E6.2.m2.2.2.2"><root id="S3.E6.2.m2.2.2.2a.cmml" xref="S3.E6.2.m2.2.2.2"></root><apply id="S3.E6.2.m2.2.2.2.2.2.cmml" xref="S3.E6.2.m2.2.2.2.2.2"><times id="S3.E6.2.m2.2.2.2.2.2.3.cmml" xref="S3.E6.2.m2.2.2.2.2.2.3"></times><cn id="S3.E6.2.m2.2.2.2.2.2.4.cmml" type="integer" xref="S3.E6.2.m2.2.2.2.2.2.4">2</cn><ci id="S3.E6.2.m2.2.2.2.2.2.5.cmml" xref="S3.E6.2.m2.2.2.2.2.2.5">𝜋</ci><apply id="S3.E6.2.m2.2.2.2.2.2.6.cmml" xref="S3.E6.2.m2.2.2.2.2.2.6"><csymbol cd="ambiguous" id="S3.E6.2.m2.2.2.2.2.2.6.1.cmml" xref="S3.E6.2.m2.2.2.2.2.2.6">superscript</csymbol><apply id="S3.E6.2.m2.2.2.2.2.2.6.2.cmml" xref="S3.E6.2.m2.2.2.2.2.2.6"><csymbol cd="ambiguous" id="S3.E6.2.m2.2.2.2.2.2.6.2.1.cmml" xref="S3.E6.2.m2.2.2.2.2.2.6">subscript</csymbol><ci id="S3.E6.2.m2.2.2.2.2.2.6.2.2.cmml" xref="S3.E6.2.m2.2.2.2.2.2.6.2.2">𝜎</ci><ci id="S3.E6.2.m2.2.2.2.2.2.6.2.3.cmml" xref="S3.E6.2.m2.2.2.2.2.2.6.2.3">𝑗</ci></apply><cn id="S3.E6.2.m2.2.2.2.2.2.6.3.cmml" type="integer" xref="S3.E6.2.m2.2.2.2.2.2.6.3">2</cn></apply><interval closure="open" id="S3.E6.2.m2.2.2.2.2.2.7.1.cmml" xref="S3.E6.2.m2.2.2.2.2.2.7.2"><ci id="S3.E6.2.m2.1.1.1.1.1.1.cmml" xref="S3.E6.2.m2.1.1.1.1.1.1">𝑋</ci><ci id="S3.E6.2.m2.2.2.2.2.2.2.cmml" xref="S3.E6.2.m2.2.2.2.2.2.2">italic-ϕ</ci></interval></apply></apply></apply><apply id="S3.E6.2.m2.9.9.1.1.3.2.cmml" xref="S3.E6.2.m2.9.9.1.1.3.2"><csymbol cd="ambiguous" id="S3.E6.2.m2.9.9.1.1.3.2.1.cmml" xref="S3.E6.2.m2.9.9.1.1.3.2">superscript</csymbol><ci id="S3.E6.2.m2.9.9.1.1.3.2.2.cmml" xref="S3.E6.2.m2.9.9.1.1.3.2.2">𝑒</ci><apply id="S3.E6.2.m2.8.8.6.6.1.cmml" xref="S3.E6.2.m2.8.8.6.6"><minus id="S3.E6.2.m2.8.8.6.6.1.1.cmml" xref="S3.E6.2.m2.8.8.6.6"></minus><apply id="S3.E6.2.m2.7.7.5.5.cmml" xref="S3.E6.2.m2.7.7.5.5"><divide id="S3.E6.2.m2.7.7.5.5.6.cmml" xref="S3.E6.2.m2.7.7.5.5"></divide><apply id="S3.E6.2.m2.5.5.3.3.3.cmml" xref="S3.E6.2.m2.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.E6.2.m2.5.5.3.3.3.4.cmml" xref="S3.E6.2.m2.5.5.3.3.3">superscript</csymbol><apply id="S3.E6.2.m2.5.5.3.3.3.3.1.1.cmml" xref="S3.E6.2.m2.5.5.3.3.3.3.1"><minus id="S3.E6.2.m2.5.5.3.3.3.3.1.1.1.cmml" xref="S3.E6.2.m2.5.5.3.3.3.3.1.1.1"></minus><apply id="S3.E6.2.m2.5.5.3.3.3.3.1.1.2.cmml" xref="S3.E6.2.m2.5.5.3.3.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E6.2.m2.5.5.3.3.3.3.1.1.2.1.cmml" xref="S3.E6.2.m2.5.5.3.3.3.3.1.1.2">subscript</csymbol><ci id="S3.E6.2.m2.5.5.3.3.3.3.1.1.2.2.cmml" xref="S3.E6.2.m2.5.5.3.3.3.3.1.1.2.2">𝑦</ci><ci id="S3.E6.2.m2.5.5.3.3.3.3.1.1.2.3.cmml" xref="S3.E6.2.m2.5.5.3.3.3.3.1.1.2.3">𝑗</ci></apply><apply id="S3.E6.2.m2.5.5.3.3.3.3.1.1.3.cmml" xref="S3.E6.2.m2.5.5.3.3.3.3.1.1.3"><times id="S3.E6.2.m2.5.5.3.3.3.3.1.1.3.1.cmml" xref="S3.E6.2.m2.5.5.3.3.3.3.1.1.3.1"></times><apply id="S3.E6.2.m2.5.5.3.3.3.3.1.1.3.2.cmml" xref="S3.E6.2.m2.5.5.3.3.3.3.1.1.3.2"><csymbol cd="ambiguous" id="S3.E6.2.m2.5.5.3.3.3.3.1.1.3.2.1.cmml" xref="S3.E6.2.m2.5.5.3.3.3.3.1.1.3.2">subscript</csymbol><ci id="S3.E6.2.m2.5.5.3.3.3.3.1.1.3.2.2.cmml" xref="S3.E6.2.m2.5.5.3.3.3.3.1.1.3.2.2">𝜇</ci><ci id="S3.E6.2.m2.5.5.3.3.3.3.1.1.3.2.3.cmml" xref="S3.E6.2.m2.5.5.3.3.3.3.1.1.3.2.3">𝑗</ci></apply><interval closure="open" id="S3.E6.2.m2.5.5.3.3.3.3.1.1.3.3.1.cmml" xref="S3.E6.2.m2.5.5.3.3.3.3.1.1.3.3.2"><ci id="S3.E6.2.m2.3.3.1.1.1.1.cmml" xref="S3.E6.2.m2.3.3.1.1.1.1">𝑋</ci><ci id="S3.E6.2.m2.4.4.2.2.2.2.cmml" xref="S3.E6.2.m2.4.4.2.2.2.2">italic-ϕ</ci></interval></apply></apply><cn id="S3.E6.2.m2.5.5.3.3.3.5.cmml" type="integer" xref="S3.E6.2.m2.5.5.3.3.3.5">2</cn></apply><apply id="S3.E6.2.m2.7.7.5.5.5.cmml" xref="S3.E6.2.m2.7.7.5.5.5"><times id="S3.E6.2.m2.7.7.5.5.5.3.cmml" xref="S3.E6.2.m2.7.7.5.5.5.3"></times><cn id="S3.E6.2.m2.7.7.5.5.5.4.cmml" type="integer" xref="S3.E6.2.m2.7.7.5.5.5.4">2</cn><apply id="S3.E6.2.m2.7.7.5.5.5.5.cmml" xref="S3.E6.2.m2.7.7.5.5.5.5"><csymbol cd="ambiguous" id="S3.E6.2.m2.7.7.5.5.5.5.1.cmml" xref="S3.E6.2.m2.7.7.5.5.5.5">superscript</csymbol><apply id="S3.E6.2.m2.7.7.5.5.5.5.2.cmml" xref="S3.E6.2.m2.7.7.5.5.5.5"><csymbol cd="ambiguous" id="S3.E6.2.m2.7.7.5.5.5.5.2.1.cmml" xref="S3.E6.2.m2.7.7.5.5.5.5">subscript</csymbol><ci id="S3.E6.2.m2.7.7.5.5.5.5.2.2.cmml" xref="S3.E6.2.m2.7.7.5.5.5.5.2.2">𝜎</ci><ci id="S3.E6.2.m2.7.7.5.5.5.5.2.3.cmml" xref="S3.E6.2.m2.7.7.5.5.5.5.2.3">𝑗</ci></apply><cn id="S3.E6.2.m2.7.7.5.5.5.5.3.cmml" type="integer" xref="S3.E6.2.m2.7.7.5.5.5.5.3">2</cn></apply><interval closure="open" id="S3.E6.2.m2.7.7.5.5.5.6.1.cmml" xref="S3.E6.2.m2.7.7.5.5.5.6.2"><ci id="S3.E6.2.m2.6.6.4.4.4.1.cmml" xref="S3.E6.2.m2.6.6.4.4.4.1">𝑋</ci><ci id="S3.E6.2.m2.7.7.5.5.5.2.cmml" xref="S3.E6.2.m2.7.7.5.5.5.2">italic-ϕ</ci></interval></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.2.m2.9c">\displaystyle=\frac{1}{\sqrt{2\pi\sigma_{j}^{2}(X,\phi)}}e^{\left(-\frac{(y_{j%
}-\mu_{j}(X,\phi))^{2}}{2\sigma_{j}^{2}(X,\phi)}\right)},</annotation><annotation encoding="application/x-llamapun" id="S3.E6.2.m2.9d">= divide start_ARG 1 end_ARG start_ARG square-root start_ARG 2 italic_π italic_σ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ( italic_X , italic_ϕ ) end_ARG end_ARG italic_e start_POSTSUPERSCRIPT ( - divide start_ARG ( italic_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT - italic_μ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( italic_X , italic_ϕ ) ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG 2 italic_σ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ( italic_X , italic_ϕ ) end_ARG ) end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6b)</span></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S3.SS1.p4.7">where the mean and standard deviation vectors <math alttext="\mu_{m+1:N}" class="ltx_Math" display="inline" id="S3.SS1.p4.4.m1.1"><semantics id="S3.SS1.p4.4.m1.1a"><msub id="S3.SS1.p4.4.m1.1.1" xref="S3.SS1.p4.4.m1.1.1.cmml"><mi id="S3.SS1.p4.4.m1.1.1.2" xref="S3.SS1.p4.4.m1.1.1.2.cmml">μ</mi><mrow id="S3.SS1.p4.4.m1.1.1.3" xref="S3.SS1.p4.4.m1.1.1.3.cmml"><mrow id="S3.SS1.p4.4.m1.1.1.3.2" xref="S3.SS1.p4.4.m1.1.1.3.2.cmml"><mi id="S3.SS1.p4.4.m1.1.1.3.2.2" xref="S3.SS1.p4.4.m1.1.1.3.2.2.cmml">m</mi><mo id="S3.SS1.p4.4.m1.1.1.3.2.1" xref="S3.SS1.p4.4.m1.1.1.3.2.1.cmml">+</mo><mn id="S3.SS1.p4.4.m1.1.1.3.2.3" xref="S3.SS1.p4.4.m1.1.1.3.2.3.cmml">1</mn></mrow><mo id="S3.SS1.p4.4.m1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p4.4.m1.1.1.3.1.cmml">:</mo><mi id="S3.SS1.p4.4.m1.1.1.3.3" xref="S3.SS1.p4.4.m1.1.1.3.3.cmml">N</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.4.m1.1b"><apply id="S3.SS1.p4.4.m1.1.1.cmml" xref="S3.SS1.p4.4.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.4.m1.1.1.1.cmml" xref="S3.SS1.p4.4.m1.1.1">subscript</csymbol><ci id="S3.SS1.p4.4.m1.1.1.2.cmml" xref="S3.SS1.p4.4.m1.1.1.2">𝜇</ci><apply id="S3.SS1.p4.4.m1.1.1.3.cmml" xref="S3.SS1.p4.4.m1.1.1.3"><ci id="S3.SS1.p4.4.m1.1.1.3.1.cmml" xref="S3.SS1.p4.4.m1.1.1.3.1">:</ci><apply id="S3.SS1.p4.4.m1.1.1.3.2.cmml" xref="S3.SS1.p4.4.m1.1.1.3.2"><plus id="S3.SS1.p4.4.m1.1.1.3.2.1.cmml" xref="S3.SS1.p4.4.m1.1.1.3.2.1"></plus><ci id="S3.SS1.p4.4.m1.1.1.3.2.2.cmml" xref="S3.SS1.p4.4.m1.1.1.3.2.2">𝑚</ci><cn id="S3.SS1.p4.4.m1.1.1.3.2.3.cmml" type="integer" xref="S3.SS1.p4.4.m1.1.1.3.2.3">1</cn></apply><ci id="S3.SS1.p4.4.m1.1.1.3.3.cmml" xref="S3.SS1.p4.4.m1.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.4.m1.1c">\mu_{m+1:N}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.4.m1.1d">italic_μ start_POSTSUBSCRIPT italic_m + 1 : italic_N end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\sigma_{m+1:N}\in\mathbb{R}^{N-m}" class="ltx_Math" display="inline" id="S3.SS1.p4.5.m2.1"><semantics id="S3.SS1.p4.5.m2.1a"><mrow id="S3.SS1.p4.5.m2.1.1" xref="S3.SS1.p4.5.m2.1.1.cmml"><msub id="S3.SS1.p4.5.m2.1.1.2" xref="S3.SS1.p4.5.m2.1.1.2.cmml"><mi id="S3.SS1.p4.5.m2.1.1.2.2" xref="S3.SS1.p4.5.m2.1.1.2.2.cmml">σ</mi><mrow id="S3.SS1.p4.5.m2.1.1.2.3" xref="S3.SS1.p4.5.m2.1.1.2.3.cmml"><mrow id="S3.SS1.p4.5.m2.1.1.2.3.2" xref="S3.SS1.p4.5.m2.1.1.2.3.2.cmml"><mi id="S3.SS1.p4.5.m2.1.1.2.3.2.2" xref="S3.SS1.p4.5.m2.1.1.2.3.2.2.cmml">m</mi><mo id="S3.SS1.p4.5.m2.1.1.2.3.2.1" xref="S3.SS1.p4.5.m2.1.1.2.3.2.1.cmml">+</mo><mn id="S3.SS1.p4.5.m2.1.1.2.3.2.3" xref="S3.SS1.p4.5.m2.1.1.2.3.2.3.cmml">1</mn></mrow><mo id="S3.SS1.p4.5.m2.1.1.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p4.5.m2.1.1.2.3.1.cmml">:</mo><mi id="S3.SS1.p4.5.m2.1.1.2.3.3" xref="S3.SS1.p4.5.m2.1.1.2.3.3.cmml">N</mi></mrow></msub><mo id="S3.SS1.p4.5.m2.1.1.1" xref="S3.SS1.p4.5.m2.1.1.1.cmml">∈</mo><msup id="S3.SS1.p4.5.m2.1.1.3" xref="S3.SS1.p4.5.m2.1.1.3.cmml"><mi id="S3.SS1.p4.5.m2.1.1.3.2" xref="S3.SS1.p4.5.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p4.5.m2.1.1.3.3" xref="S3.SS1.p4.5.m2.1.1.3.3.cmml"><mi id="S3.SS1.p4.5.m2.1.1.3.3.2" xref="S3.SS1.p4.5.m2.1.1.3.3.2.cmml">N</mi><mo id="S3.SS1.p4.5.m2.1.1.3.3.1" xref="S3.SS1.p4.5.m2.1.1.3.3.1.cmml">−</mo><mi id="S3.SS1.p4.5.m2.1.1.3.3.3" xref="S3.SS1.p4.5.m2.1.1.3.3.3.cmml">m</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.5.m2.1b"><apply id="S3.SS1.p4.5.m2.1.1.cmml" xref="S3.SS1.p4.5.m2.1.1"><in id="S3.SS1.p4.5.m2.1.1.1.cmml" xref="S3.SS1.p4.5.m2.1.1.1"></in><apply id="S3.SS1.p4.5.m2.1.1.2.cmml" xref="S3.SS1.p4.5.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p4.5.m2.1.1.2.1.cmml" xref="S3.SS1.p4.5.m2.1.1.2">subscript</csymbol><ci id="S3.SS1.p4.5.m2.1.1.2.2.cmml" xref="S3.SS1.p4.5.m2.1.1.2.2">𝜎</ci><apply id="S3.SS1.p4.5.m2.1.1.2.3.cmml" xref="S3.SS1.p4.5.m2.1.1.2.3"><ci id="S3.SS1.p4.5.m2.1.1.2.3.1.cmml" xref="S3.SS1.p4.5.m2.1.1.2.3.1">:</ci><apply id="S3.SS1.p4.5.m2.1.1.2.3.2.cmml" xref="S3.SS1.p4.5.m2.1.1.2.3.2"><plus id="S3.SS1.p4.5.m2.1.1.2.3.2.1.cmml" xref="S3.SS1.p4.5.m2.1.1.2.3.2.1"></plus><ci id="S3.SS1.p4.5.m2.1.1.2.3.2.2.cmml" xref="S3.SS1.p4.5.m2.1.1.2.3.2.2">𝑚</ci><cn id="S3.SS1.p4.5.m2.1.1.2.3.2.3.cmml" type="integer" xref="S3.SS1.p4.5.m2.1.1.2.3.2.3">1</cn></apply><ci id="S3.SS1.p4.5.m2.1.1.2.3.3.cmml" xref="S3.SS1.p4.5.m2.1.1.2.3.3">𝑁</ci></apply></apply><apply id="S3.SS1.p4.5.m2.1.1.3.cmml" xref="S3.SS1.p4.5.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p4.5.m2.1.1.3.1.cmml" xref="S3.SS1.p4.5.m2.1.1.3">superscript</csymbol><ci id="S3.SS1.p4.5.m2.1.1.3.2.cmml" xref="S3.SS1.p4.5.m2.1.1.3.2">ℝ</ci><apply id="S3.SS1.p4.5.m2.1.1.3.3.cmml" xref="S3.SS1.p4.5.m2.1.1.3.3"><minus id="S3.SS1.p4.5.m2.1.1.3.3.1.cmml" xref="S3.SS1.p4.5.m2.1.1.3.3.1"></minus><ci id="S3.SS1.p4.5.m2.1.1.3.3.2.cmml" xref="S3.SS1.p4.5.m2.1.1.3.3.2">𝑁</ci><ci id="S3.SS1.p4.5.m2.1.1.3.3.3.cmml" xref="S3.SS1.p4.5.m2.1.1.3.3.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.5.m2.1c">\sigma_{m+1:N}\in\mathbb{R}^{N-m}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.5.m2.1d">italic_σ start_POSTSUBSCRIPT italic_m + 1 : italic_N end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_N - italic_m end_POSTSUPERSCRIPT</annotation></semantics></math> are functions of <math alttext="X" class="ltx_Math" display="inline" id="S3.SS1.p4.6.m3.1"><semantics id="S3.SS1.p4.6.m3.1a"><mi id="S3.SS1.p4.6.m3.1.1" xref="S3.SS1.p4.6.m3.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.6.m3.1b"><ci id="S3.SS1.p4.6.m3.1.1.cmml" xref="S3.SS1.p4.6.m3.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.6.m3.1c">X</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.6.m3.1d">italic_X</annotation></semantics></math> and <math alttext="\phi" class="ltx_Math" display="inline" id="S3.SS1.p4.7.m4.1"><semantics id="S3.SS1.p4.7.m4.1a"><mi id="S3.SS1.p4.7.m4.1.1" xref="S3.SS1.p4.7.m4.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.7.m4.1b"><ci id="S3.SS1.p4.7.m4.1.1.cmml" xref="S3.SS1.p4.7.m4.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.7.m4.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.7.m4.1d">italic_ϕ</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS1.p5">
<p class="ltx_p" id="S3.SS1.p5.3">These two vectors are the output of the Transformer, when fed with the query input <math alttext="u_{m+1:N}" class="ltx_Math" display="inline" id="S3.SS1.p5.1.m1.1"><semantics id="S3.SS1.p5.1.m1.1a"><msub id="S3.SS1.p5.1.m1.1.1" xref="S3.SS1.p5.1.m1.1.1.cmml"><mi id="S3.SS1.p5.1.m1.1.1.2" xref="S3.SS1.p5.1.m1.1.1.2.cmml">u</mi><mrow id="S3.SS1.p5.1.m1.1.1.3" xref="S3.SS1.p5.1.m1.1.1.3.cmml"><mrow id="S3.SS1.p5.1.m1.1.1.3.2" xref="S3.SS1.p5.1.m1.1.1.3.2.cmml"><mi id="S3.SS1.p5.1.m1.1.1.3.2.2" xref="S3.SS1.p5.1.m1.1.1.3.2.2.cmml">m</mi><mo id="S3.SS1.p5.1.m1.1.1.3.2.1" xref="S3.SS1.p5.1.m1.1.1.3.2.1.cmml">+</mo><mn id="S3.SS1.p5.1.m1.1.1.3.2.3" xref="S3.SS1.p5.1.m1.1.1.3.2.3.cmml">1</mn></mrow><mo id="S3.SS1.p5.1.m1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p5.1.m1.1.1.3.1.cmml">:</mo><mi id="S3.SS1.p5.1.m1.1.1.3.3" xref="S3.SS1.p5.1.m1.1.1.3.3.cmml">N</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.1.m1.1b"><apply id="S3.SS1.p5.1.m1.1.1.cmml" xref="S3.SS1.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.1.m1.1.1.1.cmml" xref="S3.SS1.p5.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p5.1.m1.1.1.2.cmml" xref="S3.SS1.p5.1.m1.1.1.2">𝑢</ci><apply id="S3.SS1.p5.1.m1.1.1.3.cmml" xref="S3.SS1.p5.1.m1.1.1.3"><ci id="S3.SS1.p5.1.m1.1.1.3.1.cmml" xref="S3.SS1.p5.1.m1.1.1.3.1">:</ci><apply id="S3.SS1.p5.1.m1.1.1.3.2.cmml" xref="S3.SS1.p5.1.m1.1.1.3.2"><plus id="S3.SS1.p5.1.m1.1.1.3.2.1.cmml" xref="S3.SS1.p5.1.m1.1.1.3.2.1"></plus><ci id="S3.SS1.p5.1.m1.1.1.3.2.2.cmml" xref="S3.SS1.p5.1.m1.1.1.3.2.2">𝑚</ci><cn id="S3.SS1.p5.1.m1.1.1.3.2.3.cmml" type="integer" xref="S3.SS1.p5.1.m1.1.1.3.2.3">1</cn></apply><ci id="S3.SS1.p5.1.m1.1.1.3.3.cmml" xref="S3.SS1.p5.1.m1.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.1.m1.1c">u_{m+1:N}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.1.m1.1d">italic_u start_POSTSUBSCRIPT italic_m + 1 : italic_N end_POSTSUBSCRIPT</annotation></semantics></math> and the input/output context <math alttext="u_{1:m},y_{1:m}" class="ltx_Math" display="inline" id="S3.SS1.p5.2.m2.2"><semantics id="S3.SS1.p5.2.m2.2a"><mrow id="S3.SS1.p5.2.m2.2.2.2" xref="S3.SS1.p5.2.m2.2.2.3.cmml"><msub id="S3.SS1.p5.2.m2.1.1.1.1" xref="S3.SS1.p5.2.m2.1.1.1.1.cmml"><mi id="S3.SS1.p5.2.m2.1.1.1.1.2" xref="S3.SS1.p5.2.m2.1.1.1.1.2.cmml">u</mi><mrow id="S3.SS1.p5.2.m2.1.1.1.1.3" xref="S3.SS1.p5.2.m2.1.1.1.1.3.cmml"><mn id="S3.SS1.p5.2.m2.1.1.1.1.3.2" xref="S3.SS1.p5.2.m2.1.1.1.1.3.2.cmml">1</mn><mo id="S3.SS1.p5.2.m2.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p5.2.m2.1.1.1.1.3.1.cmml">:</mo><mi id="S3.SS1.p5.2.m2.1.1.1.1.3.3" xref="S3.SS1.p5.2.m2.1.1.1.1.3.3.cmml">m</mi></mrow></msub><mo id="S3.SS1.p5.2.m2.2.2.2.3" xref="S3.SS1.p5.2.m2.2.2.3.cmml">,</mo><msub id="S3.SS1.p5.2.m2.2.2.2.2" xref="S3.SS1.p5.2.m2.2.2.2.2.cmml"><mi id="S3.SS1.p5.2.m2.2.2.2.2.2" xref="S3.SS1.p5.2.m2.2.2.2.2.2.cmml">y</mi><mrow id="S3.SS1.p5.2.m2.2.2.2.2.3" xref="S3.SS1.p5.2.m2.2.2.2.2.3.cmml"><mn id="S3.SS1.p5.2.m2.2.2.2.2.3.2" xref="S3.SS1.p5.2.m2.2.2.2.2.3.2.cmml">1</mn><mo id="S3.SS1.p5.2.m2.2.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p5.2.m2.2.2.2.2.3.1.cmml">:</mo><mi id="S3.SS1.p5.2.m2.2.2.2.2.3.3" xref="S3.SS1.p5.2.m2.2.2.2.2.3.3.cmml">m</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.2.m2.2b"><list id="S3.SS1.p5.2.m2.2.2.3.cmml" xref="S3.SS1.p5.2.m2.2.2.2"><apply id="S3.SS1.p5.2.m2.1.1.1.1.cmml" xref="S3.SS1.p5.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.2.m2.1.1.1.1.1.cmml" xref="S3.SS1.p5.2.m2.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p5.2.m2.1.1.1.1.2.cmml" xref="S3.SS1.p5.2.m2.1.1.1.1.2">𝑢</ci><apply id="S3.SS1.p5.2.m2.1.1.1.1.3.cmml" xref="S3.SS1.p5.2.m2.1.1.1.1.3"><ci id="S3.SS1.p5.2.m2.1.1.1.1.3.1.cmml" xref="S3.SS1.p5.2.m2.1.1.1.1.3.1">:</ci><cn id="S3.SS1.p5.2.m2.1.1.1.1.3.2.cmml" type="integer" xref="S3.SS1.p5.2.m2.1.1.1.1.3.2">1</cn><ci id="S3.SS1.p5.2.m2.1.1.1.1.3.3.cmml" xref="S3.SS1.p5.2.m2.1.1.1.1.3.3">𝑚</ci></apply></apply><apply id="S3.SS1.p5.2.m2.2.2.2.2.cmml" xref="S3.SS1.p5.2.m2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p5.2.m2.2.2.2.2.1.cmml" xref="S3.SS1.p5.2.m2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p5.2.m2.2.2.2.2.2.cmml" xref="S3.SS1.p5.2.m2.2.2.2.2.2">𝑦</ci><apply id="S3.SS1.p5.2.m2.2.2.2.2.3.cmml" xref="S3.SS1.p5.2.m2.2.2.2.2.3"><ci id="S3.SS1.p5.2.m2.2.2.2.2.3.1.cmml" xref="S3.SS1.p5.2.m2.2.2.2.2.3.1">:</ci><cn id="S3.SS1.p5.2.m2.2.2.2.2.3.2.cmml" type="integer" xref="S3.SS1.p5.2.m2.2.2.2.2.3.2">1</cn><ci id="S3.SS1.p5.2.m2.2.2.2.2.3.3.cmml" xref="S3.SS1.p5.2.m2.2.2.2.2.3.3">𝑚</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.2.m2.2c">u_{1:m},y_{1:m}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.2.m2.2d">italic_u start_POSTSUBSCRIPT 1 : italic_m end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 1 : italic_m end_POSTSUBSCRIPT</annotation></semantics></math> from a system <math alttext="S" class="ltx_Math" display="inline" id="S3.SS1.p5.3.m3.1"><semantics id="S3.SS1.p5.3.m3.1a"><mi id="S3.SS1.p5.3.m3.1.1" xref="S3.SS1.p5.3.m3.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.3.m3.1b"><ci id="S3.SS1.p5.3.m3.1.1.cmml" xref="S3.SS1.p5.3.m3.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.3.m3.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.3.m3.1d">italic_S</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mu_{m+1:N},\sigma_{m+1:N}=\mathcal{M}_{\phi}(u_{m+1:N},u_{1:m},y_{1:m})." class="ltx_Math" display="block" id="S3.E7.m1.1"><semantics id="S3.E7.m1.1a"><mrow id="S3.E7.m1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml"><mrow id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml"><mrow id="S3.E7.m1.1.1.1.1.2.2" xref="S3.E7.m1.1.1.1.1.2.3.cmml"><msub id="S3.E7.m1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.2.cmml">μ</mi><mrow id="S3.E7.m1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.3.cmml"><mrow id="S3.E7.m1.1.1.1.1.1.1.1.3.2" xref="S3.E7.m1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.1.3.2.2" xref="S3.E7.m1.1.1.1.1.1.1.1.3.2.2.cmml">m</mi><mo id="S3.E7.m1.1.1.1.1.1.1.1.3.2.1" xref="S3.E7.m1.1.1.1.1.1.1.1.3.2.1.cmml">+</mo><mn id="S3.E7.m1.1.1.1.1.1.1.1.3.2.3" xref="S3.E7.m1.1.1.1.1.1.1.1.3.2.3.cmml">1</mn></mrow><mo id="S3.E7.m1.1.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.E7.m1.1.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="S3.E7.m1.1.1.1.1.1.1.1.3.3" xref="S3.E7.m1.1.1.1.1.1.1.1.3.3.cmml">N</mi></mrow></msub><mo id="S3.E7.m1.1.1.1.1.2.2.3" xref="S3.E7.m1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.E7.m1.1.1.1.1.2.2.2" xref="S3.E7.m1.1.1.1.1.2.2.2.cmml"><mi id="S3.E7.m1.1.1.1.1.2.2.2.2" xref="S3.E7.m1.1.1.1.1.2.2.2.2.cmml">σ</mi><mrow id="S3.E7.m1.1.1.1.1.2.2.2.3" xref="S3.E7.m1.1.1.1.1.2.2.2.3.cmml"><mrow id="S3.E7.m1.1.1.1.1.2.2.2.3.2" xref="S3.E7.m1.1.1.1.1.2.2.2.3.2.cmml"><mi id="S3.E7.m1.1.1.1.1.2.2.2.3.2.2" xref="S3.E7.m1.1.1.1.1.2.2.2.3.2.2.cmml">m</mi><mo id="S3.E7.m1.1.1.1.1.2.2.2.3.2.1" xref="S3.E7.m1.1.1.1.1.2.2.2.3.2.1.cmml">+</mo><mn id="S3.E7.m1.1.1.1.1.2.2.2.3.2.3" xref="S3.E7.m1.1.1.1.1.2.2.2.3.2.3.cmml">1</mn></mrow><mo id="S3.E7.m1.1.1.1.1.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.E7.m1.1.1.1.1.2.2.2.3.1.cmml">:</mo><mi id="S3.E7.m1.1.1.1.1.2.2.2.3.3" xref="S3.E7.m1.1.1.1.1.2.2.2.3.3.cmml">N</mi></mrow></msub></mrow><mo id="S3.E7.m1.1.1.1.1.6" xref="S3.E7.m1.1.1.1.1.6.cmml">=</mo><mrow id="S3.E7.m1.1.1.1.1.5" xref="S3.E7.m1.1.1.1.1.5.cmml"><msub id="S3.E7.m1.1.1.1.1.5.5" xref="S3.E7.m1.1.1.1.1.5.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.1.1.1.1.5.5.2" xref="S3.E7.m1.1.1.1.1.5.5.2.cmml">ℳ</mi><mi id="S3.E7.m1.1.1.1.1.5.5.3" xref="S3.E7.m1.1.1.1.1.5.5.3.cmml">ϕ</mi></msub><mo id="S3.E7.m1.1.1.1.1.5.4" xref="S3.E7.m1.1.1.1.1.5.4.cmml">⁢</mo><mrow id="S3.E7.m1.1.1.1.1.5.3.3" xref="S3.E7.m1.1.1.1.1.5.3.4.cmml"><mo id="S3.E7.m1.1.1.1.1.5.3.3.4" stretchy="false" xref="S3.E7.m1.1.1.1.1.5.3.4.cmml">(</mo><msub id="S3.E7.m1.1.1.1.1.3.1.1.1" xref="S3.E7.m1.1.1.1.1.3.1.1.1.cmml"><mi id="S3.E7.m1.1.1.1.1.3.1.1.1.2" xref="S3.E7.m1.1.1.1.1.3.1.1.1.2.cmml">u</mi><mrow id="S3.E7.m1.1.1.1.1.3.1.1.1.3" xref="S3.E7.m1.1.1.1.1.3.1.1.1.3.cmml"><mrow id="S3.E7.m1.1.1.1.1.3.1.1.1.3.2" xref="S3.E7.m1.1.1.1.1.3.1.1.1.3.2.cmml"><mi id="S3.E7.m1.1.1.1.1.3.1.1.1.3.2.2" xref="S3.E7.m1.1.1.1.1.3.1.1.1.3.2.2.cmml">m</mi><mo id="S3.E7.m1.1.1.1.1.3.1.1.1.3.2.1" xref="S3.E7.m1.1.1.1.1.3.1.1.1.3.2.1.cmml">+</mo><mn id="S3.E7.m1.1.1.1.1.3.1.1.1.3.2.3" xref="S3.E7.m1.1.1.1.1.3.1.1.1.3.2.3.cmml">1</mn></mrow><mo id="S3.E7.m1.1.1.1.1.3.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.E7.m1.1.1.1.1.3.1.1.1.3.1.cmml">:</mo><mi id="S3.E7.m1.1.1.1.1.3.1.1.1.3.3" xref="S3.E7.m1.1.1.1.1.3.1.1.1.3.3.cmml">N</mi></mrow></msub><mo id="S3.E7.m1.1.1.1.1.5.3.3.5" xref="S3.E7.m1.1.1.1.1.5.3.4.cmml">,</mo><msub id="S3.E7.m1.1.1.1.1.4.2.2.2" xref="S3.E7.m1.1.1.1.1.4.2.2.2.cmml"><mi id="S3.E7.m1.1.1.1.1.4.2.2.2.2" xref="S3.E7.m1.1.1.1.1.4.2.2.2.2.cmml">u</mi><mrow id="S3.E7.m1.1.1.1.1.4.2.2.2.3" xref="S3.E7.m1.1.1.1.1.4.2.2.2.3.cmml"><mn id="S3.E7.m1.1.1.1.1.4.2.2.2.3.2" xref="S3.E7.m1.1.1.1.1.4.2.2.2.3.2.cmml">1</mn><mo id="S3.E7.m1.1.1.1.1.4.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.E7.m1.1.1.1.1.4.2.2.2.3.1.cmml">:</mo><mi id="S3.E7.m1.1.1.1.1.4.2.2.2.3.3" xref="S3.E7.m1.1.1.1.1.4.2.2.2.3.3.cmml">m</mi></mrow></msub><mo id="S3.E7.m1.1.1.1.1.5.3.3.6" xref="S3.E7.m1.1.1.1.1.5.3.4.cmml">,</mo><msub id="S3.E7.m1.1.1.1.1.5.3.3.3" xref="S3.E7.m1.1.1.1.1.5.3.3.3.cmml"><mi id="S3.E7.m1.1.1.1.1.5.3.3.3.2" xref="S3.E7.m1.1.1.1.1.5.3.3.3.2.cmml">y</mi><mrow id="S3.E7.m1.1.1.1.1.5.3.3.3.3" xref="S3.E7.m1.1.1.1.1.5.3.3.3.3.cmml"><mn id="S3.E7.m1.1.1.1.1.5.3.3.3.3.2" xref="S3.E7.m1.1.1.1.1.5.3.3.3.3.2.cmml">1</mn><mo id="S3.E7.m1.1.1.1.1.5.3.3.3.3.1" lspace="0.278em" rspace="0.278em" xref="S3.E7.m1.1.1.1.1.5.3.3.3.3.1.cmml">:</mo><mi id="S3.E7.m1.1.1.1.1.5.3.3.3.3.3" xref="S3.E7.m1.1.1.1.1.5.3.3.3.3.3.cmml">m</mi></mrow></msub><mo id="S3.E7.m1.1.1.1.1.5.3.3.7" stretchy="false" xref="S3.E7.m1.1.1.1.1.5.3.4.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E7.m1.1.1.1.2" lspace="0em" xref="S3.E7.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.1b"><apply id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1"><eq id="S3.E7.m1.1.1.1.1.6.cmml" xref="S3.E7.m1.1.1.1.1.6"></eq><list id="S3.E7.m1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.1.1.1.1.2.2"><apply id="S3.E7.m1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2">𝜇</ci><apply id="S3.E7.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.3"><ci id="S3.E7.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.3.1">:</ci><apply id="S3.E7.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.3.2"><plus id="S3.E7.m1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.3.2.1"></plus><ci id="S3.E7.m1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.3.2.2">𝑚</ci><cn id="S3.E7.m1.1.1.1.1.1.1.1.3.2.3.cmml" type="integer" xref="S3.E7.m1.1.1.1.1.1.1.1.3.2.3">1</cn></apply><ci id="S3.E7.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.3.3">𝑁</ci></apply></apply><apply id="S3.E7.m1.1.1.1.1.2.2.2.cmml" xref="S3.E7.m1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.2.2.2.1.cmml" xref="S3.E7.m1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.E7.m1.1.1.1.1.2.2.2.2">𝜎</ci><apply id="S3.E7.m1.1.1.1.1.2.2.2.3.cmml" xref="S3.E7.m1.1.1.1.1.2.2.2.3"><ci id="S3.E7.m1.1.1.1.1.2.2.2.3.1.cmml" xref="S3.E7.m1.1.1.1.1.2.2.2.3.1">:</ci><apply id="S3.E7.m1.1.1.1.1.2.2.2.3.2.cmml" xref="S3.E7.m1.1.1.1.1.2.2.2.3.2"><plus id="S3.E7.m1.1.1.1.1.2.2.2.3.2.1.cmml" xref="S3.E7.m1.1.1.1.1.2.2.2.3.2.1"></plus><ci id="S3.E7.m1.1.1.1.1.2.2.2.3.2.2.cmml" xref="S3.E7.m1.1.1.1.1.2.2.2.3.2.2">𝑚</ci><cn id="S3.E7.m1.1.1.1.1.2.2.2.3.2.3.cmml" type="integer" xref="S3.E7.m1.1.1.1.1.2.2.2.3.2.3">1</cn></apply><ci id="S3.E7.m1.1.1.1.1.2.2.2.3.3.cmml" xref="S3.E7.m1.1.1.1.1.2.2.2.3.3">𝑁</ci></apply></apply></list><apply id="S3.E7.m1.1.1.1.1.5.cmml" xref="S3.E7.m1.1.1.1.1.5"><times id="S3.E7.m1.1.1.1.1.5.4.cmml" xref="S3.E7.m1.1.1.1.1.5.4"></times><apply id="S3.E7.m1.1.1.1.1.5.5.cmml" xref="S3.E7.m1.1.1.1.1.5.5"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.5.5.1.cmml" xref="S3.E7.m1.1.1.1.1.5.5">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.5.5.2.cmml" xref="S3.E7.m1.1.1.1.1.5.5.2">ℳ</ci><ci id="S3.E7.m1.1.1.1.1.5.5.3.cmml" xref="S3.E7.m1.1.1.1.1.5.5.3">italic-ϕ</ci></apply><vector id="S3.E7.m1.1.1.1.1.5.3.4.cmml" xref="S3.E7.m1.1.1.1.1.5.3.3"><apply id="S3.E7.m1.1.1.1.1.3.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.3.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.3.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.3.1.1.1">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.3.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.3.1.1.1.2">𝑢</ci><apply id="S3.E7.m1.1.1.1.1.3.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.3.1.1.1.3"><ci id="S3.E7.m1.1.1.1.1.3.1.1.1.3.1.cmml" xref="S3.E7.m1.1.1.1.1.3.1.1.1.3.1">:</ci><apply id="S3.E7.m1.1.1.1.1.3.1.1.1.3.2.cmml" xref="S3.E7.m1.1.1.1.1.3.1.1.1.3.2"><plus id="S3.E7.m1.1.1.1.1.3.1.1.1.3.2.1.cmml" xref="S3.E7.m1.1.1.1.1.3.1.1.1.3.2.1"></plus><ci id="S3.E7.m1.1.1.1.1.3.1.1.1.3.2.2.cmml" xref="S3.E7.m1.1.1.1.1.3.1.1.1.3.2.2">𝑚</ci><cn id="S3.E7.m1.1.1.1.1.3.1.1.1.3.2.3.cmml" type="integer" xref="S3.E7.m1.1.1.1.1.3.1.1.1.3.2.3">1</cn></apply><ci id="S3.E7.m1.1.1.1.1.3.1.1.1.3.3.cmml" xref="S3.E7.m1.1.1.1.1.3.1.1.1.3.3">𝑁</ci></apply></apply><apply id="S3.E7.m1.1.1.1.1.4.2.2.2.cmml" xref="S3.E7.m1.1.1.1.1.4.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.4.2.2.2.1.cmml" xref="S3.E7.m1.1.1.1.1.4.2.2.2">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.4.2.2.2.2.cmml" xref="S3.E7.m1.1.1.1.1.4.2.2.2.2">𝑢</ci><apply id="S3.E7.m1.1.1.1.1.4.2.2.2.3.cmml" xref="S3.E7.m1.1.1.1.1.4.2.2.2.3"><ci id="S3.E7.m1.1.1.1.1.4.2.2.2.3.1.cmml" xref="S3.E7.m1.1.1.1.1.4.2.2.2.3.1">:</ci><cn id="S3.E7.m1.1.1.1.1.4.2.2.2.3.2.cmml" type="integer" xref="S3.E7.m1.1.1.1.1.4.2.2.2.3.2">1</cn><ci id="S3.E7.m1.1.1.1.1.4.2.2.2.3.3.cmml" xref="S3.E7.m1.1.1.1.1.4.2.2.2.3.3">𝑚</ci></apply></apply><apply id="S3.E7.m1.1.1.1.1.5.3.3.3.cmml" xref="S3.E7.m1.1.1.1.1.5.3.3.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.5.3.3.3.1.cmml" xref="S3.E7.m1.1.1.1.1.5.3.3.3">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.5.3.3.3.2.cmml" xref="S3.E7.m1.1.1.1.1.5.3.3.3.2">𝑦</ci><apply id="S3.E7.m1.1.1.1.1.5.3.3.3.3.cmml" xref="S3.E7.m1.1.1.1.1.5.3.3.3.3"><ci id="S3.E7.m1.1.1.1.1.5.3.3.3.3.1.cmml" xref="S3.E7.m1.1.1.1.1.5.3.3.3.3.1">:</ci><cn id="S3.E7.m1.1.1.1.1.5.3.3.3.3.2.cmml" type="integer" xref="S3.E7.m1.1.1.1.1.5.3.3.3.3.2">1</cn><ci id="S3.E7.m1.1.1.1.1.5.3.3.3.3.3.cmml" xref="S3.E7.m1.1.1.1.1.5.3.3.3.3.3">𝑚</ci></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.1c">\mu_{m+1:N},\sigma_{m+1:N}=\mathcal{M}_{\phi}(u_{m+1:N},u_{1:m},y_{1:m}).</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.1d">italic_μ start_POSTSUBSCRIPT italic_m + 1 : italic_N end_POSTSUBSCRIPT , italic_σ start_POSTSUBSCRIPT italic_m + 1 : italic_N end_POSTSUBSCRIPT = caligraphic_M start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_u start_POSTSUBSCRIPT italic_m + 1 : italic_N end_POSTSUBSCRIPT , italic_u start_POSTSUBSCRIPT 1 : italic_m end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 1 : italic_m end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p5.9">Thus, with respect to <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#bib.bib11" title="">11</a>]</cite>, we modify the final layer of the decoder to output the two vectors: <math alttext="\mu_{m+1:N}" class="ltx_Math" display="inline" id="S3.SS1.p5.4.m1.1"><semantics id="S3.SS1.p5.4.m1.1a"><msub id="S3.SS1.p5.4.m1.1.1" xref="S3.SS1.p5.4.m1.1.1.cmml"><mi id="S3.SS1.p5.4.m1.1.1.2" xref="S3.SS1.p5.4.m1.1.1.2.cmml">μ</mi><mrow id="S3.SS1.p5.4.m1.1.1.3" xref="S3.SS1.p5.4.m1.1.1.3.cmml"><mrow id="S3.SS1.p5.4.m1.1.1.3.2" xref="S3.SS1.p5.4.m1.1.1.3.2.cmml"><mi id="S3.SS1.p5.4.m1.1.1.3.2.2" xref="S3.SS1.p5.4.m1.1.1.3.2.2.cmml">m</mi><mo id="S3.SS1.p5.4.m1.1.1.3.2.1" xref="S3.SS1.p5.4.m1.1.1.3.2.1.cmml">+</mo><mn id="S3.SS1.p5.4.m1.1.1.3.2.3" xref="S3.SS1.p5.4.m1.1.1.3.2.3.cmml">1</mn></mrow><mo id="S3.SS1.p5.4.m1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p5.4.m1.1.1.3.1.cmml">:</mo><mi id="S3.SS1.p5.4.m1.1.1.3.3" xref="S3.SS1.p5.4.m1.1.1.3.3.cmml">N</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.4.m1.1b"><apply id="S3.SS1.p5.4.m1.1.1.cmml" xref="S3.SS1.p5.4.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.4.m1.1.1.1.cmml" xref="S3.SS1.p5.4.m1.1.1">subscript</csymbol><ci id="S3.SS1.p5.4.m1.1.1.2.cmml" xref="S3.SS1.p5.4.m1.1.1.2">𝜇</ci><apply id="S3.SS1.p5.4.m1.1.1.3.cmml" xref="S3.SS1.p5.4.m1.1.1.3"><ci id="S3.SS1.p5.4.m1.1.1.3.1.cmml" xref="S3.SS1.p5.4.m1.1.1.3.1">:</ci><apply id="S3.SS1.p5.4.m1.1.1.3.2.cmml" xref="S3.SS1.p5.4.m1.1.1.3.2"><plus id="S3.SS1.p5.4.m1.1.1.3.2.1.cmml" xref="S3.SS1.p5.4.m1.1.1.3.2.1"></plus><ci id="S3.SS1.p5.4.m1.1.1.3.2.2.cmml" xref="S3.SS1.p5.4.m1.1.1.3.2.2">𝑚</ci><cn id="S3.SS1.p5.4.m1.1.1.3.2.3.cmml" type="integer" xref="S3.SS1.p5.4.m1.1.1.3.2.3">1</cn></apply><ci id="S3.SS1.p5.4.m1.1.1.3.3.cmml" xref="S3.SS1.p5.4.m1.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.4.m1.1c">\mu_{m+1:N}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.4.m1.1d">italic_μ start_POSTSUBSCRIPT italic_m + 1 : italic_N end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\sigma_{m+1}\in\mathbb{R}^{N-m}" class="ltx_Math" display="inline" id="S3.SS1.p5.5.m2.1"><semantics id="S3.SS1.p5.5.m2.1a"><mrow id="S3.SS1.p5.5.m2.1.1" xref="S3.SS1.p5.5.m2.1.1.cmml"><msub id="S3.SS1.p5.5.m2.1.1.2" xref="S3.SS1.p5.5.m2.1.1.2.cmml"><mi id="S3.SS1.p5.5.m2.1.1.2.2" xref="S3.SS1.p5.5.m2.1.1.2.2.cmml">σ</mi><mrow id="S3.SS1.p5.5.m2.1.1.2.3" xref="S3.SS1.p5.5.m2.1.1.2.3.cmml"><mi id="S3.SS1.p5.5.m2.1.1.2.3.2" xref="S3.SS1.p5.5.m2.1.1.2.3.2.cmml">m</mi><mo id="S3.SS1.p5.5.m2.1.1.2.3.1" xref="S3.SS1.p5.5.m2.1.1.2.3.1.cmml">+</mo><mn id="S3.SS1.p5.5.m2.1.1.2.3.3" xref="S3.SS1.p5.5.m2.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS1.p5.5.m2.1.1.1" xref="S3.SS1.p5.5.m2.1.1.1.cmml">∈</mo><msup id="S3.SS1.p5.5.m2.1.1.3" xref="S3.SS1.p5.5.m2.1.1.3.cmml"><mi id="S3.SS1.p5.5.m2.1.1.3.2" xref="S3.SS1.p5.5.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p5.5.m2.1.1.3.3" xref="S3.SS1.p5.5.m2.1.1.3.3.cmml"><mi id="S3.SS1.p5.5.m2.1.1.3.3.2" xref="S3.SS1.p5.5.m2.1.1.3.3.2.cmml">N</mi><mo id="S3.SS1.p5.5.m2.1.1.3.3.1" xref="S3.SS1.p5.5.m2.1.1.3.3.1.cmml">−</mo><mi id="S3.SS1.p5.5.m2.1.1.3.3.3" xref="S3.SS1.p5.5.m2.1.1.3.3.3.cmml">m</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.5.m2.1b"><apply id="S3.SS1.p5.5.m2.1.1.cmml" xref="S3.SS1.p5.5.m2.1.1"><in id="S3.SS1.p5.5.m2.1.1.1.cmml" xref="S3.SS1.p5.5.m2.1.1.1"></in><apply id="S3.SS1.p5.5.m2.1.1.2.cmml" xref="S3.SS1.p5.5.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p5.5.m2.1.1.2.1.cmml" xref="S3.SS1.p5.5.m2.1.1.2">subscript</csymbol><ci id="S3.SS1.p5.5.m2.1.1.2.2.cmml" xref="S3.SS1.p5.5.m2.1.1.2.2">𝜎</ci><apply id="S3.SS1.p5.5.m2.1.1.2.3.cmml" xref="S3.SS1.p5.5.m2.1.1.2.3"><plus id="S3.SS1.p5.5.m2.1.1.2.3.1.cmml" xref="S3.SS1.p5.5.m2.1.1.2.3.1"></plus><ci id="S3.SS1.p5.5.m2.1.1.2.3.2.cmml" xref="S3.SS1.p5.5.m2.1.1.2.3.2">𝑚</ci><cn id="S3.SS1.p5.5.m2.1.1.2.3.3.cmml" type="integer" xref="S3.SS1.p5.5.m2.1.1.2.3.3">1</cn></apply></apply><apply id="S3.SS1.p5.5.m2.1.1.3.cmml" xref="S3.SS1.p5.5.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p5.5.m2.1.1.3.1.cmml" xref="S3.SS1.p5.5.m2.1.1.3">superscript</csymbol><ci id="S3.SS1.p5.5.m2.1.1.3.2.cmml" xref="S3.SS1.p5.5.m2.1.1.3.2">ℝ</ci><apply id="S3.SS1.p5.5.m2.1.1.3.3.cmml" xref="S3.SS1.p5.5.m2.1.1.3.3"><minus id="S3.SS1.p5.5.m2.1.1.3.3.1.cmml" xref="S3.SS1.p5.5.m2.1.1.3.3.1"></minus><ci id="S3.SS1.p5.5.m2.1.1.3.3.2.cmml" xref="S3.SS1.p5.5.m2.1.1.3.3.2">𝑁</ci><ci id="S3.SS1.p5.5.m2.1.1.3.3.3.cmml" xref="S3.SS1.p5.5.m2.1.1.3.3.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.5.m2.1c">\sigma_{m+1}\in\mathbb{R}^{N-m}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.5.m2.1d">italic_σ start_POSTSUBSCRIPT italic_m + 1 end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_N - italic_m end_POSTSUPERSCRIPT</annotation></semantics></math> rather than providing a single point estimate vector <math alttext="\hat{y}_{m+1:N}\in\mathbb{R}^{N-m}" class="ltx_Math" display="inline" id="S3.SS1.p5.6.m3.1"><semantics id="S3.SS1.p5.6.m3.1a"><mrow id="S3.SS1.p5.6.m3.1.1" xref="S3.SS1.p5.6.m3.1.1.cmml"><msub id="S3.SS1.p5.6.m3.1.1.2" xref="S3.SS1.p5.6.m3.1.1.2.cmml"><mover accent="true" id="S3.SS1.p5.6.m3.1.1.2.2" xref="S3.SS1.p5.6.m3.1.1.2.2.cmml"><mi id="S3.SS1.p5.6.m3.1.1.2.2.2" xref="S3.SS1.p5.6.m3.1.1.2.2.2.cmml">y</mi><mo id="S3.SS1.p5.6.m3.1.1.2.2.1" xref="S3.SS1.p5.6.m3.1.1.2.2.1.cmml">^</mo></mover><mrow id="S3.SS1.p5.6.m3.1.1.2.3" xref="S3.SS1.p5.6.m3.1.1.2.3.cmml"><mrow id="S3.SS1.p5.6.m3.1.1.2.3.2" xref="S3.SS1.p5.6.m3.1.1.2.3.2.cmml"><mi id="S3.SS1.p5.6.m3.1.1.2.3.2.2" xref="S3.SS1.p5.6.m3.1.1.2.3.2.2.cmml">m</mi><mo id="S3.SS1.p5.6.m3.1.1.2.3.2.1" xref="S3.SS1.p5.6.m3.1.1.2.3.2.1.cmml">+</mo><mn id="S3.SS1.p5.6.m3.1.1.2.3.2.3" xref="S3.SS1.p5.6.m3.1.1.2.3.2.3.cmml">1</mn></mrow><mo id="S3.SS1.p5.6.m3.1.1.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p5.6.m3.1.1.2.3.1.cmml">:</mo><mi id="S3.SS1.p5.6.m3.1.1.2.3.3" xref="S3.SS1.p5.6.m3.1.1.2.3.3.cmml">N</mi></mrow></msub><mo id="S3.SS1.p5.6.m3.1.1.1" xref="S3.SS1.p5.6.m3.1.1.1.cmml">∈</mo><msup id="S3.SS1.p5.6.m3.1.1.3" xref="S3.SS1.p5.6.m3.1.1.3.cmml"><mi id="S3.SS1.p5.6.m3.1.1.3.2" xref="S3.SS1.p5.6.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p5.6.m3.1.1.3.3" xref="S3.SS1.p5.6.m3.1.1.3.3.cmml"><mi id="S3.SS1.p5.6.m3.1.1.3.3.2" xref="S3.SS1.p5.6.m3.1.1.3.3.2.cmml">N</mi><mo id="S3.SS1.p5.6.m3.1.1.3.3.1" xref="S3.SS1.p5.6.m3.1.1.3.3.1.cmml">−</mo><mi id="S3.SS1.p5.6.m3.1.1.3.3.3" xref="S3.SS1.p5.6.m3.1.1.3.3.3.cmml">m</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.6.m3.1b"><apply id="S3.SS1.p5.6.m3.1.1.cmml" xref="S3.SS1.p5.6.m3.1.1"><in id="S3.SS1.p5.6.m3.1.1.1.cmml" xref="S3.SS1.p5.6.m3.1.1.1"></in><apply id="S3.SS1.p5.6.m3.1.1.2.cmml" xref="S3.SS1.p5.6.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p5.6.m3.1.1.2.1.cmml" xref="S3.SS1.p5.6.m3.1.1.2">subscript</csymbol><apply id="S3.SS1.p5.6.m3.1.1.2.2.cmml" xref="S3.SS1.p5.6.m3.1.1.2.2"><ci id="S3.SS1.p5.6.m3.1.1.2.2.1.cmml" xref="S3.SS1.p5.6.m3.1.1.2.2.1">^</ci><ci id="S3.SS1.p5.6.m3.1.1.2.2.2.cmml" xref="S3.SS1.p5.6.m3.1.1.2.2.2">𝑦</ci></apply><apply id="S3.SS1.p5.6.m3.1.1.2.3.cmml" xref="S3.SS1.p5.6.m3.1.1.2.3"><ci id="S3.SS1.p5.6.m3.1.1.2.3.1.cmml" xref="S3.SS1.p5.6.m3.1.1.2.3.1">:</ci><apply id="S3.SS1.p5.6.m3.1.1.2.3.2.cmml" xref="S3.SS1.p5.6.m3.1.1.2.3.2"><plus id="S3.SS1.p5.6.m3.1.1.2.3.2.1.cmml" xref="S3.SS1.p5.6.m3.1.1.2.3.2.1"></plus><ci id="S3.SS1.p5.6.m3.1.1.2.3.2.2.cmml" xref="S3.SS1.p5.6.m3.1.1.2.3.2.2">𝑚</ci><cn id="S3.SS1.p5.6.m3.1.1.2.3.2.3.cmml" type="integer" xref="S3.SS1.p5.6.m3.1.1.2.3.2.3">1</cn></apply><ci id="S3.SS1.p5.6.m3.1.1.2.3.3.cmml" xref="S3.SS1.p5.6.m3.1.1.2.3.3">𝑁</ci></apply></apply><apply id="S3.SS1.p5.6.m3.1.1.3.cmml" xref="S3.SS1.p5.6.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p5.6.m3.1.1.3.1.cmml" xref="S3.SS1.p5.6.m3.1.1.3">superscript</csymbol><ci id="S3.SS1.p5.6.m3.1.1.3.2.cmml" xref="S3.SS1.p5.6.m3.1.1.3.2">ℝ</ci><apply id="S3.SS1.p5.6.m3.1.1.3.3.cmml" xref="S3.SS1.p5.6.m3.1.1.3.3"><minus id="S3.SS1.p5.6.m3.1.1.3.3.1.cmml" xref="S3.SS1.p5.6.m3.1.1.3.3.1"></minus><ci id="S3.SS1.p5.6.m3.1.1.3.3.2.cmml" xref="S3.SS1.p5.6.m3.1.1.3.3.2">𝑁</ci><ci id="S3.SS1.p5.6.m3.1.1.3.3.3.cmml" xref="S3.SS1.p5.6.m3.1.1.3.3.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.6.m3.1c">\hat{y}_{m+1:N}\in\mathbb{R}^{N-m}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.6.m3.1d">over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_m + 1 : italic_N end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_N - italic_m end_POSTSUPERSCRIPT</annotation></semantics></math>, see the upper right block in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#S3.F1" title="Figure 1 ‣ 3 Advancing the Transformer Architecture ‣ Enhanced Transformer architecture for in-context learning of dynamical systems"><span class="ltx_text ltx_ref_tag">1</span></a>. It is worth remarking that the vector of means <math alttext="\mu_{m+1:N}" class="ltx_Math" display="inline" id="S3.SS1.p5.7.m4.1"><semantics id="S3.SS1.p5.7.m4.1a"><msub id="S3.SS1.p5.7.m4.1.1" xref="S3.SS1.p5.7.m4.1.1.cmml"><mi id="S3.SS1.p5.7.m4.1.1.2" xref="S3.SS1.p5.7.m4.1.1.2.cmml">μ</mi><mrow id="S3.SS1.p5.7.m4.1.1.3" xref="S3.SS1.p5.7.m4.1.1.3.cmml"><mrow id="S3.SS1.p5.7.m4.1.1.3.2" xref="S3.SS1.p5.7.m4.1.1.3.2.cmml"><mi id="S3.SS1.p5.7.m4.1.1.3.2.2" xref="S3.SS1.p5.7.m4.1.1.3.2.2.cmml">m</mi><mo id="S3.SS1.p5.7.m4.1.1.3.2.1" xref="S3.SS1.p5.7.m4.1.1.3.2.1.cmml">+</mo><mn id="S3.SS1.p5.7.m4.1.1.3.2.3" xref="S3.SS1.p5.7.m4.1.1.3.2.3.cmml">1</mn></mrow><mo id="S3.SS1.p5.7.m4.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p5.7.m4.1.1.3.1.cmml">:</mo><mi id="S3.SS1.p5.7.m4.1.1.3.3" xref="S3.SS1.p5.7.m4.1.1.3.3.cmml">N</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.7.m4.1b"><apply id="S3.SS1.p5.7.m4.1.1.cmml" xref="S3.SS1.p5.7.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.7.m4.1.1.1.cmml" xref="S3.SS1.p5.7.m4.1.1">subscript</csymbol><ci id="S3.SS1.p5.7.m4.1.1.2.cmml" xref="S3.SS1.p5.7.m4.1.1.2">𝜇</ci><apply id="S3.SS1.p5.7.m4.1.1.3.cmml" xref="S3.SS1.p5.7.m4.1.1.3"><ci id="S3.SS1.p5.7.m4.1.1.3.1.cmml" xref="S3.SS1.p5.7.m4.1.1.3.1">:</ci><apply id="S3.SS1.p5.7.m4.1.1.3.2.cmml" xref="S3.SS1.p5.7.m4.1.1.3.2"><plus id="S3.SS1.p5.7.m4.1.1.3.2.1.cmml" xref="S3.SS1.p5.7.m4.1.1.3.2.1"></plus><ci id="S3.SS1.p5.7.m4.1.1.3.2.2.cmml" xref="S3.SS1.p5.7.m4.1.1.3.2.2">𝑚</ci><cn id="S3.SS1.p5.7.m4.1.1.3.2.3.cmml" type="integer" xref="S3.SS1.p5.7.m4.1.1.3.2.3">1</cn></apply><ci id="S3.SS1.p5.7.m4.1.1.3.3.cmml" xref="S3.SS1.p5.7.m4.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.7.m4.1c">\mu_{m+1:N}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.7.m4.1d">italic_μ start_POSTSUBSCRIPT italic_m + 1 : italic_N end_POSTSUBSCRIPT</annotation></semantics></math> corresponds to the point estimate <math alttext="\hat{y}_{m+1:N}" class="ltx_Math" display="inline" id="S3.SS1.p5.8.m5.1"><semantics id="S3.SS1.p5.8.m5.1a"><msub id="S3.SS1.p5.8.m5.1.1" xref="S3.SS1.p5.8.m5.1.1.cmml"><mover accent="true" id="S3.SS1.p5.8.m5.1.1.2" xref="S3.SS1.p5.8.m5.1.1.2.cmml"><mi id="S3.SS1.p5.8.m5.1.1.2.2" xref="S3.SS1.p5.8.m5.1.1.2.2.cmml">y</mi><mo id="S3.SS1.p5.8.m5.1.1.2.1" xref="S3.SS1.p5.8.m5.1.1.2.1.cmml">^</mo></mover><mrow id="S3.SS1.p5.8.m5.1.1.3" xref="S3.SS1.p5.8.m5.1.1.3.cmml"><mrow id="S3.SS1.p5.8.m5.1.1.3.2" xref="S3.SS1.p5.8.m5.1.1.3.2.cmml"><mi id="S3.SS1.p5.8.m5.1.1.3.2.2" xref="S3.SS1.p5.8.m5.1.1.3.2.2.cmml">m</mi><mo id="S3.SS1.p5.8.m5.1.1.3.2.1" xref="S3.SS1.p5.8.m5.1.1.3.2.1.cmml">+</mo><mn id="S3.SS1.p5.8.m5.1.1.3.2.3" xref="S3.SS1.p5.8.m5.1.1.3.2.3.cmml">1</mn></mrow><mo id="S3.SS1.p5.8.m5.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p5.8.m5.1.1.3.1.cmml">:</mo><mi id="S3.SS1.p5.8.m5.1.1.3.3" xref="S3.SS1.p5.8.m5.1.1.3.3.cmml">N</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.8.m5.1b"><apply id="S3.SS1.p5.8.m5.1.1.cmml" xref="S3.SS1.p5.8.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.8.m5.1.1.1.cmml" xref="S3.SS1.p5.8.m5.1.1">subscript</csymbol><apply id="S3.SS1.p5.8.m5.1.1.2.cmml" xref="S3.SS1.p5.8.m5.1.1.2"><ci id="S3.SS1.p5.8.m5.1.1.2.1.cmml" xref="S3.SS1.p5.8.m5.1.1.2.1">^</ci><ci id="S3.SS1.p5.8.m5.1.1.2.2.cmml" xref="S3.SS1.p5.8.m5.1.1.2.2">𝑦</ci></apply><apply id="S3.SS1.p5.8.m5.1.1.3.cmml" xref="S3.SS1.p5.8.m5.1.1.3"><ci id="S3.SS1.p5.8.m5.1.1.3.1.cmml" xref="S3.SS1.p5.8.m5.1.1.3.1">:</ci><apply id="S3.SS1.p5.8.m5.1.1.3.2.cmml" xref="S3.SS1.p5.8.m5.1.1.3.2"><plus id="S3.SS1.p5.8.m5.1.1.3.2.1.cmml" xref="S3.SS1.p5.8.m5.1.1.3.2.1"></plus><ci id="S3.SS1.p5.8.m5.1.1.3.2.2.cmml" xref="S3.SS1.p5.8.m5.1.1.3.2.2">𝑚</ci><cn id="S3.SS1.p5.8.m5.1.1.3.2.3.cmml" type="integer" xref="S3.SS1.p5.8.m5.1.1.3.2.3">1</cn></apply><ci id="S3.SS1.p5.8.m5.1.1.3.3.cmml" xref="S3.SS1.p5.8.m5.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.8.m5.1c">\hat{y}_{m+1:N}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.8.m5.1d">over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_m + 1 : italic_N end_POSTSUBSCRIPT</annotation></semantics></math> already provided by the previous architecture, while <math alttext="\sigma_{m+1:N}" class="ltx_Math" display="inline" id="S3.SS1.p5.9.m6.1"><semantics id="S3.SS1.p5.9.m6.1a"><msub id="S3.SS1.p5.9.m6.1.1" xref="S3.SS1.p5.9.m6.1.1.cmml"><mi id="S3.SS1.p5.9.m6.1.1.2" xref="S3.SS1.p5.9.m6.1.1.2.cmml">σ</mi><mrow id="S3.SS1.p5.9.m6.1.1.3" xref="S3.SS1.p5.9.m6.1.1.3.cmml"><mrow id="S3.SS1.p5.9.m6.1.1.3.2" xref="S3.SS1.p5.9.m6.1.1.3.2.cmml"><mi id="S3.SS1.p5.9.m6.1.1.3.2.2" xref="S3.SS1.p5.9.m6.1.1.3.2.2.cmml">m</mi><mo id="S3.SS1.p5.9.m6.1.1.3.2.1" xref="S3.SS1.p5.9.m6.1.1.3.2.1.cmml">+</mo><mn id="S3.SS1.p5.9.m6.1.1.3.2.3" xref="S3.SS1.p5.9.m6.1.1.3.2.3.cmml">1</mn></mrow><mo id="S3.SS1.p5.9.m6.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p5.9.m6.1.1.3.1.cmml">:</mo><mi id="S3.SS1.p5.9.m6.1.1.3.3" xref="S3.SS1.p5.9.m6.1.1.3.3.cmml">N</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.9.m6.1b"><apply id="S3.SS1.p5.9.m6.1.1.cmml" xref="S3.SS1.p5.9.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.9.m6.1.1.1.cmml" xref="S3.SS1.p5.9.m6.1.1">subscript</csymbol><ci id="S3.SS1.p5.9.m6.1.1.2.cmml" xref="S3.SS1.p5.9.m6.1.1.2">𝜎</ci><apply id="S3.SS1.p5.9.m6.1.1.3.cmml" xref="S3.SS1.p5.9.m6.1.1.3"><ci id="S3.SS1.p5.9.m6.1.1.3.1.cmml" xref="S3.SS1.p5.9.m6.1.1.3.1">:</ci><apply id="S3.SS1.p5.9.m6.1.1.3.2.cmml" xref="S3.SS1.p5.9.m6.1.1.3.2"><plus id="S3.SS1.p5.9.m6.1.1.3.2.1.cmml" xref="S3.SS1.p5.9.m6.1.1.3.2.1"></plus><ci id="S3.SS1.p5.9.m6.1.1.3.2.2.cmml" xref="S3.SS1.p5.9.m6.1.1.3.2.2">𝑚</ci><cn id="S3.SS1.p5.9.m6.1.1.3.2.3.cmml" type="integer" xref="S3.SS1.p5.9.m6.1.1.3.2.3">1</cn></apply><ci id="S3.SS1.p5.9.m6.1.1.3.3.cmml" xref="S3.SS1.p5.9.m6.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.9.m6.1c">\sigma_{m+1:N}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.9.m6.1d">italic_σ start_POSTSUBSCRIPT italic_m + 1 : italic_N end_POSTSUBSCRIPT</annotation></semantics></math> gives new insight about the meta-model’s predictive uncertainty.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Handling arbitrary initial conditions</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.6">In order to consider distinct context and query sequences, it is necessary to provide initial conditions along with a query input sequence. In this work, we feed the meta-model with <math alttext="n_{in}" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><msub id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">n</mi><mrow id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml"><mi id="S3.SS2.p1.1.m1.1.1.3.2" xref="S3.SS2.p1.1.m1.1.1.3.2.cmml">i</mi><mo id="S3.SS2.p1.1.m1.1.1.3.1" xref="S3.SS2.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.1.m1.1.1.3.3" xref="S3.SS2.p1.1.m1.1.1.3.3.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">𝑛</ci><apply id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3"><times id="S3.SS2.p1.1.m1.1.1.3.1.cmml" xref="S3.SS2.p1.1.m1.1.1.3.1"></times><ci id="S3.SS2.p1.1.m1.1.1.3.2.cmml" xref="S3.SS2.p1.1.m1.1.1.3.2">𝑖</ci><ci id="S3.SS2.p1.1.m1.1.1.3.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">n_{in}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">italic_n start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT</annotation></semantics></math> input-output samples preceding the query input as the initial conditions.
Thus, for supervised learning of this meta-model <math alttext="\mathcal{M}_{\phi}" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><msub id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">ℳ</mi><mi id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">ℳ</ci><ci id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\mathcal{M}_{\phi}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">caligraphic_M start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math>, two input/output sequences are generated from each system <math alttext="S" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><mi id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">italic_S</annotation></semantics></math>: a context sequence <math alttext="(u_{1:m},y_{1:m})" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m4.2"><semantics id="S3.SS2.p1.4.m4.2a"><mrow id="S3.SS2.p1.4.m4.2.2.2" xref="S3.SS2.p1.4.m4.2.2.3.cmml"><mo id="S3.SS2.p1.4.m4.2.2.2.3" stretchy="false" xref="S3.SS2.p1.4.m4.2.2.3.cmml">(</mo><msub id="S3.SS2.p1.4.m4.1.1.1.1" xref="S3.SS2.p1.4.m4.1.1.1.1.cmml"><mi id="S3.SS2.p1.4.m4.1.1.1.1.2" xref="S3.SS2.p1.4.m4.1.1.1.1.2.cmml">u</mi><mrow id="S3.SS2.p1.4.m4.1.1.1.1.3" xref="S3.SS2.p1.4.m4.1.1.1.1.3.cmml"><mn id="S3.SS2.p1.4.m4.1.1.1.1.3.2" xref="S3.SS2.p1.4.m4.1.1.1.1.3.2.cmml">1</mn><mo id="S3.SS2.p1.4.m4.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS2.p1.4.m4.1.1.1.1.3.1.cmml">:</mo><mi id="S3.SS2.p1.4.m4.1.1.1.1.3.3" xref="S3.SS2.p1.4.m4.1.1.1.1.3.3.cmml">m</mi></mrow></msub><mo id="S3.SS2.p1.4.m4.2.2.2.4" xref="S3.SS2.p1.4.m4.2.2.3.cmml">,</mo><msub id="S3.SS2.p1.4.m4.2.2.2.2" xref="S3.SS2.p1.4.m4.2.2.2.2.cmml"><mi id="S3.SS2.p1.4.m4.2.2.2.2.2" xref="S3.SS2.p1.4.m4.2.2.2.2.2.cmml">y</mi><mrow id="S3.SS2.p1.4.m4.2.2.2.2.3" xref="S3.SS2.p1.4.m4.2.2.2.2.3.cmml"><mn id="S3.SS2.p1.4.m4.2.2.2.2.3.2" xref="S3.SS2.p1.4.m4.2.2.2.2.3.2.cmml">1</mn><mo id="S3.SS2.p1.4.m4.2.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS2.p1.4.m4.2.2.2.2.3.1.cmml">:</mo><mi id="S3.SS2.p1.4.m4.2.2.2.2.3.3" xref="S3.SS2.p1.4.m4.2.2.2.2.3.3.cmml">m</mi></mrow></msub><mo id="S3.SS2.p1.4.m4.2.2.2.5" stretchy="false" xref="S3.SS2.p1.4.m4.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.2b"><interval closure="open" id="S3.SS2.p1.4.m4.2.2.3.cmml" xref="S3.SS2.p1.4.m4.2.2.2"><apply id="S3.SS2.p1.4.m4.1.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.2">𝑢</ci><apply id="S3.SS2.p1.4.m4.1.1.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.3"><ci id="S3.SS2.p1.4.m4.1.1.1.1.3.1.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.3.1">:</ci><cn id="S3.SS2.p1.4.m4.1.1.1.1.3.2.cmml" type="integer" xref="S3.SS2.p1.4.m4.1.1.1.1.3.2">1</cn><ci id="S3.SS2.p1.4.m4.1.1.1.1.3.3.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.3.3">𝑚</ci></apply></apply><apply id="S3.SS2.p1.4.m4.2.2.2.2.cmml" xref="S3.SS2.p1.4.m4.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.2.2.2.2.1.cmml" xref="S3.SS2.p1.4.m4.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p1.4.m4.2.2.2.2.2.cmml" xref="S3.SS2.p1.4.m4.2.2.2.2.2">𝑦</ci><apply id="S3.SS2.p1.4.m4.2.2.2.2.3.cmml" xref="S3.SS2.p1.4.m4.2.2.2.2.3"><ci id="S3.SS2.p1.4.m4.2.2.2.2.3.1.cmml" xref="S3.SS2.p1.4.m4.2.2.2.2.3.1">:</ci><cn id="S3.SS2.p1.4.m4.2.2.2.2.3.2.cmml" type="integer" xref="S3.SS2.p1.4.m4.2.2.2.2.3.2">1</cn><ci id="S3.SS2.p1.4.m4.2.2.2.2.3.3.cmml" xref="S3.SS2.p1.4.m4.2.2.2.2.3.3">𝑚</ci></apply></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.2c">(u_{1:m},y_{1:m})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m4.2d">( italic_u start_POSTSUBSCRIPT 1 : italic_m end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 1 : italic_m end_POSTSUBSCRIPT )</annotation></semantics></math> and a disjoint query sequence <math alttext="(\tilde{u}_{1:{N}},\tilde{y}_{1:{N}})" class="ltx_Math" display="inline" id="S3.SS2.p1.5.m5.2"><semantics id="S3.SS2.p1.5.m5.2a"><mrow id="S3.SS2.p1.5.m5.2.2.2" xref="S3.SS2.p1.5.m5.2.2.3.cmml"><mo id="S3.SS2.p1.5.m5.2.2.2.3" stretchy="false" xref="S3.SS2.p1.5.m5.2.2.3.cmml">(</mo><msub id="S3.SS2.p1.5.m5.1.1.1.1" xref="S3.SS2.p1.5.m5.1.1.1.1.cmml"><mover accent="true" id="S3.SS2.p1.5.m5.1.1.1.1.2" xref="S3.SS2.p1.5.m5.1.1.1.1.2.cmml"><mi id="S3.SS2.p1.5.m5.1.1.1.1.2.2" xref="S3.SS2.p1.5.m5.1.1.1.1.2.2.cmml">u</mi><mo id="S3.SS2.p1.5.m5.1.1.1.1.2.1" xref="S3.SS2.p1.5.m5.1.1.1.1.2.1.cmml">~</mo></mover><mrow id="S3.SS2.p1.5.m5.1.1.1.1.3" xref="S3.SS2.p1.5.m5.1.1.1.1.3.cmml"><mn id="S3.SS2.p1.5.m5.1.1.1.1.3.2" xref="S3.SS2.p1.5.m5.1.1.1.1.3.2.cmml">1</mn><mo id="S3.SS2.p1.5.m5.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS2.p1.5.m5.1.1.1.1.3.1.cmml">:</mo><mi id="S3.SS2.p1.5.m5.1.1.1.1.3.3" xref="S3.SS2.p1.5.m5.1.1.1.1.3.3.cmml">N</mi></mrow></msub><mo id="S3.SS2.p1.5.m5.2.2.2.4" xref="S3.SS2.p1.5.m5.2.2.3.cmml">,</mo><msub id="S3.SS2.p1.5.m5.2.2.2.2" xref="S3.SS2.p1.5.m5.2.2.2.2.cmml"><mover accent="true" id="S3.SS2.p1.5.m5.2.2.2.2.2" xref="S3.SS2.p1.5.m5.2.2.2.2.2.cmml"><mi id="S3.SS2.p1.5.m5.2.2.2.2.2.2" xref="S3.SS2.p1.5.m5.2.2.2.2.2.2.cmml">y</mi><mo id="S3.SS2.p1.5.m5.2.2.2.2.2.1" xref="S3.SS2.p1.5.m5.2.2.2.2.2.1.cmml">~</mo></mover><mrow id="S3.SS2.p1.5.m5.2.2.2.2.3" xref="S3.SS2.p1.5.m5.2.2.2.2.3.cmml"><mn id="S3.SS2.p1.5.m5.2.2.2.2.3.2" xref="S3.SS2.p1.5.m5.2.2.2.2.3.2.cmml">1</mn><mo id="S3.SS2.p1.5.m5.2.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS2.p1.5.m5.2.2.2.2.3.1.cmml">:</mo><mi id="S3.SS2.p1.5.m5.2.2.2.2.3.3" xref="S3.SS2.p1.5.m5.2.2.2.2.3.3.cmml">N</mi></mrow></msub><mo id="S3.SS2.p1.5.m5.2.2.2.5" stretchy="false" xref="S3.SS2.p1.5.m5.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.2b"><interval closure="open" id="S3.SS2.p1.5.m5.2.2.3.cmml" xref="S3.SS2.p1.5.m5.2.2.2"><apply id="S3.SS2.p1.5.m5.1.1.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.1.1.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1.1.1">subscript</csymbol><apply id="S3.SS2.p1.5.m5.1.1.1.1.2.cmml" xref="S3.SS2.p1.5.m5.1.1.1.1.2"><ci id="S3.SS2.p1.5.m5.1.1.1.1.2.1.cmml" xref="S3.SS2.p1.5.m5.1.1.1.1.2.1">~</ci><ci id="S3.SS2.p1.5.m5.1.1.1.1.2.2.cmml" xref="S3.SS2.p1.5.m5.1.1.1.1.2.2">𝑢</ci></apply><apply id="S3.SS2.p1.5.m5.1.1.1.1.3.cmml" xref="S3.SS2.p1.5.m5.1.1.1.1.3"><ci id="S3.SS2.p1.5.m5.1.1.1.1.3.1.cmml" xref="S3.SS2.p1.5.m5.1.1.1.1.3.1">:</ci><cn id="S3.SS2.p1.5.m5.1.1.1.1.3.2.cmml" type="integer" xref="S3.SS2.p1.5.m5.1.1.1.1.3.2">1</cn><ci id="S3.SS2.p1.5.m5.1.1.1.1.3.3.cmml" xref="S3.SS2.p1.5.m5.1.1.1.1.3.3">𝑁</ci></apply></apply><apply id="S3.SS2.p1.5.m5.2.2.2.2.cmml" xref="S3.SS2.p1.5.m5.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.2.2.2.2.1.cmml" xref="S3.SS2.p1.5.m5.2.2.2.2">subscript</csymbol><apply id="S3.SS2.p1.5.m5.2.2.2.2.2.cmml" xref="S3.SS2.p1.5.m5.2.2.2.2.2"><ci id="S3.SS2.p1.5.m5.2.2.2.2.2.1.cmml" xref="S3.SS2.p1.5.m5.2.2.2.2.2.1">~</ci><ci id="S3.SS2.p1.5.m5.2.2.2.2.2.2.cmml" xref="S3.SS2.p1.5.m5.2.2.2.2.2.2">𝑦</ci></apply><apply id="S3.SS2.p1.5.m5.2.2.2.2.3.cmml" xref="S3.SS2.p1.5.m5.2.2.2.2.3"><ci id="S3.SS2.p1.5.m5.2.2.2.2.3.1.cmml" xref="S3.SS2.p1.5.m5.2.2.2.2.3.1">:</ci><cn id="S3.SS2.p1.5.m5.2.2.2.2.3.2.cmml" type="integer" xref="S3.SS2.p1.5.m5.2.2.2.2.3.2">1</cn><ci id="S3.SS2.p1.5.m5.2.2.2.2.3.3.cmml" xref="S3.SS2.p1.5.m5.2.2.2.2.3.3">𝑁</ci></apply></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.2c">(\tilde{u}_{1:{N}},\tilde{y}_{1:{N}})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.5.m5.2d">( over~ start_ARG italic_u end_ARG start_POSTSUBSCRIPT 1 : italic_N end_POSTSUBSCRIPT , over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT 1 : italic_N end_POSTSUBSCRIPT )</annotation></semantics></math>, whose initial samples <math alttext="(\tilde{u}_{1:{n_{in}}},\tilde{y}_{1:{n_{in}}})" class="ltx_Math" display="inline" id="S3.SS2.p1.6.m6.2"><semantics id="S3.SS2.p1.6.m6.2a"><mrow id="S3.SS2.p1.6.m6.2.2.2" xref="S3.SS2.p1.6.m6.2.2.3.cmml"><mo id="S3.SS2.p1.6.m6.2.2.2.3" stretchy="false" xref="S3.SS2.p1.6.m6.2.2.3.cmml">(</mo><msub id="S3.SS2.p1.6.m6.1.1.1.1" xref="S3.SS2.p1.6.m6.1.1.1.1.cmml"><mover accent="true" id="S3.SS2.p1.6.m6.1.1.1.1.2" xref="S3.SS2.p1.6.m6.1.1.1.1.2.cmml"><mi id="S3.SS2.p1.6.m6.1.1.1.1.2.2" xref="S3.SS2.p1.6.m6.1.1.1.1.2.2.cmml">u</mi><mo id="S3.SS2.p1.6.m6.1.1.1.1.2.1" xref="S3.SS2.p1.6.m6.1.1.1.1.2.1.cmml">~</mo></mover><mrow id="S3.SS2.p1.6.m6.1.1.1.1.3" xref="S3.SS2.p1.6.m6.1.1.1.1.3.cmml"><mn id="S3.SS2.p1.6.m6.1.1.1.1.3.2" xref="S3.SS2.p1.6.m6.1.1.1.1.3.2.cmml">1</mn><mo id="S3.SS2.p1.6.m6.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS2.p1.6.m6.1.1.1.1.3.1.cmml">:</mo><msub id="S3.SS2.p1.6.m6.1.1.1.1.3.3" xref="S3.SS2.p1.6.m6.1.1.1.1.3.3.cmml"><mi id="S3.SS2.p1.6.m6.1.1.1.1.3.3.2" xref="S3.SS2.p1.6.m6.1.1.1.1.3.3.2.cmml">n</mi><mrow id="S3.SS2.p1.6.m6.1.1.1.1.3.3.3" xref="S3.SS2.p1.6.m6.1.1.1.1.3.3.3.cmml"><mi id="S3.SS2.p1.6.m6.1.1.1.1.3.3.3.2" xref="S3.SS2.p1.6.m6.1.1.1.1.3.3.3.2.cmml">i</mi><mo id="S3.SS2.p1.6.m6.1.1.1.1.3.3.3.1" xref="S3.SS2.p1.6.m6.1.1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.6.m6.1.1.1.1.3.3.3.3" xref="S3.SS2.p1.6.m6.1.1.1.1.3.3.3.3.cmml">n</mi></mrow></msub></mrow></msub><mo id="S3.SS2.p1.6.m6.2.2.2.4" xref="S3.SS2.p1.6.m6.2.2.3.cmml">,</mo><msub id="S3.SS2.p1.6.m6.2.2.2.2" xref="S3.SS2.p1.6.m6.2.2.2.2.cmml"><mover accent="true" id="S3.SS2.p1.6.m6.2.2.2.2.2" xref="S3.SS2.p1.6.m6.2.2.2.2.2.cmml"><mi id="S3.SS2.p1.6.m6.2.2.2.2.2.2" xref="S3.SS2.p1.6.m6.2.2.2.2.2.2.cmml">y</mi><mo id="S3.SS2.p1.6.m6.2.2.2.2.2.1" xref="S3.SS2.p1.6.m6.2.2.2.2.2.1.cmml">~</mo></mover><mrow id="S3.SS2.p1.6.m6.2.2.2.2.3" xref="S3.SS2.p1.6.m6.2.2.2.2.3.cmml"><mn id="S3.SS2.p1.6.m6.2.2.2.2.3.2" xref="S3.SS2.p1.6.m6.2.2.2.2.3.2.cmml">1</mn><mo id="S3.SS2.p1.6.m6.2.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS2.p1.6.m6.2.2.2.2.3.1.cmml">:</mo><msub id="S3.SS2.p1.6.m6.2.2.2.2.3.3" xref="S3.SS2.p1.6.m6.2.2.2.2.3.3.cmml"><mi id="S3.SS2.p1.6.m6.2.2.2.2.3.3.2" xref="S3.SS2.p1.6.m6.2.2.2.2.3.3.2.cmml">n</mi><mrow id="S3.SS2.p1.6.m6.2.2.2.2.3.3.3" xref="S3.SS2.p1.6.m6.2.2.2.2.3.3.3.cmml"><mi id="S3.SS2.p1.6.m6.2.2.2.2.3.3.3.2" xref="S3.SS2.p1.6.m6.2.2.2.2.3.3.3.2.cmml">i</mi><mo id="S3.SS2.p1.6.m6.2.2.2.2.3.3.3.1" xref="S3.SS2.p1.6.m6.2.2.2.2.3.3.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.6.m6.2.2.2.2.3.3.3.3" xref="S3.SS2.p1.6.m6.2.2.2.2.3.3.3.3.cmml">n</mi></mrow></msub></mrow></msub><mo id="S3.SS2.p1.6.m6.2.2.2.5" stretchy="false" xref="S3.SS2.p1.6.m6.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.2b"><interval closure="open" id="S3.SS2.p1.6.m6.2.2.3.cmml" xref="S3.SS2.p1.6.m6.2.2.2"><apply id="S3.SS2.p1.6.m6.1.1.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.1.1.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1">subscript</csymbol><apply id="S3.SS2.p1.6.m6.1.1.1.1.2.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1.2"><ci id="S3.SS2.p1.6.m6.1.1.1.1.2.1.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1.2.1">~</ci><ci id="S3.SS2.p1.6.m6.1.1.1.1.2.2.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1.2.2">𝑢</ci></apply><apply id="S3.SS2.p1.6.m6.1.1.1.1.3.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1.3"><ci id="S3.SS2.p1.6.m6.1.1.1.1.3.1.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1.3.1">:</ci><cn id="S3.SS2.p1.6.m6.1.1.1.1.3.2.cmml" type="integer" xref="S3.SS2.p1.6.m6.1.1.1.1.3.2">1</cn><apply id="S3.SS2.p1.6.m6.1.1.1.1.3.3.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.1.1.1.3.3.1.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1.3.3">subscript</csymbol><ci id="S3.SS2.p1.6.m6.1.1.1.1.3.3.2.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1.3.3.2">𝑛</ci><apply id="S3.SS2.p1.6.m6.1.1.1.1.3.3.3.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1.3.3.3"><times id="S3.SS2.p1.6.m6.1.1.1.1.3.3.3.1.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1.3.3.3.1"></times><ci id="S3.SS2.p1.6.m6.1.1.1.1.3.3.3.2.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1.3.3.3.2">𝑖</ci><ci id="S3.SS2.p1.6.m6.1.1.1.1.3.3.3.3.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1.3.3.3.3">𝑛</ci></apply></apply></apply></apply><apply id="S3.SS2.p1.6.m6.2.2.2.2.cmml" xref="S3.SS2.p1.6.m6.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.2.2.2.2.1.cmml" xref="S3.SS2.p1.6.m6.2.2.2.2">subscript</csymbol><apply id="S3.SS2.p1.6.m6.2.2.2.2.2.cmml" xref="S3.SS2.p1.6.m6.2.2.2.2.2"><ci id="S3.SS2.p1.6.m6.2.2.2.2.2.1.cmml" xref="S3.SS2.p1.6.m6.2.2.2.2.2.1">~</ci><ci id="S3.SS2.p1.6.m6.2.2.2.2.2.2.cmml" xref="S3.SS2.p1.6.m6.2.2.2.2.2.2">𝑦</ci></apply><apply id="S3.SS2.p1.6.m6.2.2.2.2.3.cmml" xref="S3.SS2.p1.6.m6.2.2.2.2.3"><ci id="S3.SS2.p1.6.m6.2.2.2.2.3.1.cmml" xref="S3.SS2.p1.6.m6.2.2.2.2.3.1">:</ci><cn id="S3.SS2.p1.6.m6.2.2.2.2.3.2.cmml" type="integer" xref="S3.SS2.p1.6.m6.2.2.2.2.3.2">1</cn><apply id="S3.SS2.p1.6.m6.2.2.2.2.3.3.cmml" xref="S3.SS2.p1.6.m6.2.2.2.2.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.2.2.2.2.3.3.1.cmml" xref="S3.SS2.p1.6.m6.2.2.2.2.3.3">subscript</csymbol><ci id="S3.SS2.p1.6.m6.2.2.2.2.3.3.2.cmml" xref="S3.SS2.p1.6.m6.2.2.2.2.3.3.2">𝑛</ci><apply id="S3.SS2.p1.6.m6.2.2.2.2.3.3.3.cmml" xref="S3.SS2.p1.6.m6.2.2.2.2.3.3.3"><times id="S3.SS2.p1.6.m6.2.2.2.2.3.3.3.1.cmml" xref="S3.SS2.p1.6.m6.2.2.2.2.3.3.3.1"></times><ci id="S3.SS2.p1.6.m6.2.2.2.2.3.3.3.2.cmml" xref="S3.SS2.p1.6.m6.2.2.2.2.3.3.3.2">𝑖</ci><ci id="S3.SS2.p1.6.m6.2.2.2.2.3.3.3.3.cmml" xref="S3.SS2.p1.6.m6.2.2.2.2.3.3.3.3">𝑛</ci></apply></apply></apply></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.2c">(\tilde{u}_{1:{n_{in}}},\tilde{y}_{1:{n_{in}}})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.6.m6.2d">( over~ start_ARG italic_u end_ARG start_POSTSUBSCRIPT 1 : italic_n start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT end_POSTSUBSCRIPT , over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT 1 : italic_n start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT end_POSTSUBSCRIPT )</annotation></semantics></math> are taken as initial conditions.</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.6">Then, given a query input <math alttext="\tilde{u}_{n_{in}+1:N}" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1"><semantics id="S3.SS2.p2.1.m1.1a"><msub id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mover accent="true" id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml"><mi id="S3.SS2.p2.1.m1.1.1.2.2" xref="S3.SS2.p2.1.m1.1.1.2.2.cmml">u</mi><mo id="S3.SS2.p2.1.m1.1.1.2.1" xref="S3.SS2.p2.1.m1.1.1.2.1.cmml">~</mo></mover><mrow id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml"><mrow id="S3.SS2.p2.1.m1.1.1.3.2" xref="S3.SS2.p2.1.m1.1.1.3.2.cmml"><msub id="S3.SS2.p2.1.m1.1.1.3.2.2" xref="S3.SS2.p2.1.m1.1.1.3.2.2.cmml"><mi id="S3.SS2.p2.1.m1.1.1.3.2.2.2" xref="S3.SS2.p2.1.m1.1.1.3.2.2.2.cmml">n</mi><mrow id="S3.SS2.p2.1.m1.1.1.3.2.2.3" xref="S3.SS2.p2.1.m1.1.1.3.2.2.3.cmml"><mi id="S3.SS2.p2.1.m1.1.1.3.2.2.3.2" xref="S3.SS2.p2.1.m1.1.1.3.2.2.3.2.cmml">i</mi><mo id="S3.SS2.p2.1.m1.1.1.3.2.2.3.1" xref="S3.SS2.p2.1.m1.1.1.3.2.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.1.m1.1.1.3.2.2.3.3" xref="S3.SS2.p2.1.m1.1.1.3.2.2.3.3.cmml">n</mi></mrow></msub><mo id="S3.SS2.p2.1.m1.1.1.3.2.1" xref="S3.SS2.p2.1.m1.1.1.3.2.1.cmml">+</mo><mn id="S3.SS2.p2.1.m1.1.1.3.2.3" xref="S3.SS2.p2.1.m1.1.1.3.2.3.cmml">1</mn></mrow><mo id="S3.SS2.p2.1.m1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS2.p2.1.m1.1.1.3.1.cmml">:</mo><mi id="S3.SS2.p2.1.m1.1.1.3.3" xref="S3.SS2.p2.1.m1.1.1.3.3.cmml">N</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">subscript</csymbol><apply id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2"><ci id="S3.SS2.p2.1.m1.1.1.2.1.cmml" xref="S3.SS2.p2.1.m1.1.1.2.1">~</ci><ci id="S3.SS2.p2.1.m1.1.1.2.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2.2">𝑢</ci></apply><apply id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3"><ci id="S3.SS2.p2.1.m1.1.1.3.1.cmml" xref="S3.SS2.p2.1.m1.1.1.3.1">:</ci><apply id="S3.SS2.p2.1.m1.1.1.3.2.cmml" xref="S3.SS2.p2.1.m1.1.1.3.2"><plus id="S3.SS2.p2.1.m1.1.1.3.2.1.cmml" xref="S3.SS2.p2.1.m1.1.1.3.2.1"></plus><apply id="S3.SS2.p2.1.m1.1.1.3.2.2.cmml" xref="S3.SS2.p2.1.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.3.2.2.1.cmml" xref="S3.SS2.p2.1.m1.1.1.3.2.2">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.3.2.2.2.cmml" xref="S3.SS2.p2.1.m1.1.1.3.2.2.2">𝑛</ci><apply id="S3.SS2.p2.1.m1.1.1.3.2.2.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3.2.2.3"><times id="S3.SS2.p2.1.m1.1.1.3.2.2.3.1.cmml" xref="S3.SS2.p2.1.m1.1.1.3.2.2.3.1"></times><ci id="S3.SS2.p2.1.m1.1.1.3.2.2.3.2.cmml" xref="S3.SS2.p2.1.m1.1.1.3.2.2.3.2">𝑖</ci><ci id="S3.SS2.p2.1.m1.1.1.3.2.2.3.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3.2.2.3.3">𝑛</ci></apply></apply><cn id="S3.SS2.p2.1.m1.1.1.3.2.3.cmml" type="integer" xref="S3.SS2.p2.1.m1.1.1.3.2.3">1</cn></apply><ci id="S3.SS2.p2.1.m1.1.1.3.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">\tilde{u}_{n_{in}+1:N}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.1d">over~ start_ARG italic_u end_ARG start_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT + 1 : italic_N end_POSTSUBSCRIPT</annotation></semantics></math>, initial conditions <math alttext="(\tilde{u}_{1:{n_{in}}},\tilde{y}_{1:{n_{in}}})" class="ltx_Math" display="inline" id="S3.SS2.p2.2.m2.2"><semantics id="S3.SS2.p2.2.m2.2a"><mrow id="S3.SS2.p2.2.m2.2.2.2" xref="S3.SS2.p2.2.m2.2.2.3.cmml"><mo id="S3.SS2.p2.2.m2.2.2.2.3" stretchy="false" xref="S3.SS2.p2.2.m2.2.2.3.cmml">(</mo><msub id="S3.SS2.p2.2.m2.1.1.1.1" xref="S3.SS2.p2.2.m2.1.1.1.1.cmml"><mover accent="true" id="S3.SS2.p2.2.m2.1.1.1.1.2" xref="S3.SS2.p2.2.m2.1.1.1.1.2.cmml"><mi id="S3.SS2.p2.2.m2.1.1.1.1.2.2" xref="S3.SS2.p2.2.m2.1.1.1.1.2.2.cmml">u</mi><mo id="S3.SS2.p2.2.m2.1.1.1.1.2.1" xref="S3.SS2.p2.2.m2.1.1.1.1.2.1.cmml">~</mo></mover><mrow id="S3.SS2.p2.2.m2.1.1.1.1.3" xref="S3.SS2.p2.2.m2.1.1.1.1.3.cmml"><mn id="S3.SS2.p2.2.m2.1.1.1.1.3.2" xref="S3.SS2.p2.2.m2.1.1.1.1.3.2.cmml">1</mn><mo id="S3.SS2.p2.2.m2.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS2.p2.2.m2.1.1.1.1.3.1.cmml">:</mo><msub id="S3.SS2.p2.2.m2.1.1.1.1.3.3" xref="S3.SS2.p2.2.m2.1.1.1.1.3.3.cmml"><mi id="S3.SS2.p2.2.m2.1.1.1.1.3.3.2" xref="S3.SS2.p2.2.m2.1.1.1.1.3.3.2.cmml">n</mi><mrow id="S3.SS2.p2.2.m2.1.1.1.1.3.3.3" xref="S3.SS2.p2.2.m2.1.1.1.1.3.3.3.cmml"><mi id="S3.SS2.p2.2.m2.1.1.1.1.3.3.3.2" xref="S3.SS2.p2.2.m2.1.1.1.1.3.3.3.2.cmml">i</mi><mo id="S3.SS2.p2.2.m2.1.1.1.1.3.3.3.1" xref="S3.SS2.p2.2.m2.1.1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.2.m2.1.1.1.1.3.3.3.3" xref="S3.SS2.p2.2.m2.1.1.1.1.3.3.3.3.cmml">n</mi></mrow></msub></mrow></msub><mo id="S3.SS2.p2.2.m2.2.2.2.4" xref="S3.SS2.p2.2.m2.2.2.3.cmml">,</mo><msub id="S3.SS2.p2.2.m2.2.2.2.2" xref="S3.SS2.p2.2.m2.2.2.2.2.cmml"><mover accent="true" id="S3.SS2.p2.2.m2.2.2.2.2.2" xref="S3.SS2.p2.2.m2.2.2.2.2.2.cmml"><mi id="S3.SS2.p2.2.m2.2.2.2.2.2.2" xref="S3.SS2.p2.2.m2.2.2.2.2.2.2.cmml">y</mi><mo id="S3.SS2.p2.2.m2.2.2.2.2.2.1" xref="S3.SS2.p2.2.m2.2.2.2.2.2.1.cmml">~</mo></mover><mrow id="S3.SS2.p2.2.m2.2.2.2.2.3" xref="S3.SS2.p2.2.m2.2.2.2.2.3.cmml"><mn id="S3.SS2.p2.2.m2.2.2.2.2.3.2" xref="S3.SS2.p2.2.m2.2.2.2.2.3.2.cmml">1</mn><mo id="S3.SS2.p2.2.m2.2.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS2.p2.2.m2.2.2.2.2.3.1.cmml">:</mo><msub id="S3.SS2.p2.2.m2.2.2.2.2.3.3" xref="S3.SS2.p2.2.m2.2.2.2.2.3.3.cmml"><mi id="S3.SS2.p2.2.m2.2.2.2.2.3.3.2" xref="S3.SS2.p2.2.m2.2.2.2.2.3.3.2.cmml">n</mi><mrow id="S3.SS2.p2.2.m2.2.2.2.2.3.3.3" xref="S3.SS2.p2.2.m2.2.2.2.2.3.3.3.cmml"><mi id="S3.SS2.p2.2.m2.2.2.2.2.3.3.3.2" xref="S3.SS2.p2.2.m2.2.2.2.2.3.3.3.2.cmml">i</mi><mo id="S3.SS2.p2.2.m2.2.2.2.2.3.3.3.1" xref="S3.SS2.p2.2.m2.2.2.2.2.3.3.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.2.m2.2.2.2.2.3.3.3.3" xref="S3.SS2.p2.2.m2.2.2.2.2.3.3.3.3.cmml">n</mi></mrow></msub></mrow></msub><mo id="S3.SS2.p2.2.m2.2.2.2.5" stretchy="false" xref="S3.SS2.p2.2.m2.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.2b"><interval closure="open" id="S3.SS2.p2.2.m2.2.2.3.cmml" xref="S3.SS2.p2.2.m2.2.2.2"><apply id="S3.SS2.p2.2.m2.1.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1">subscript</csymbol><apply id="S3.SS2.p2.2.m2.1.1.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.2"><ci id="S3.SS2.p2.2.m2.1.1.1.1.2.1.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.2.1">~</ci><ci id="S3.SS2.p2.2.m2.1.1.1.1.2.2.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.2.2">𝑢</ci></apply><apply id="S3.SS2.p2.2.m2.1.1.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.3"><ci id="S3.SS2.p2.2.m2.1.1.1.1.3.1.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.3.1">:</ci><cn id="S3.SS2.p2.2.m2.1.1.1.1.3.2.cmml" type="integer" xref="S3.SS2.p2.2.m2.1.1.1.1.3.2">1</cn><apply id="S3.SS2.p2.2.m2.1.1.1.1.3.3.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.1.3.3.1.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.3.3">subscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.1.1.3.3.2.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.3.3.2">𝑛</ci><apply id="S3.SS2.p2.2.m2.1.1.1.1.3.3.3.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.3.3.3"><times id="S3.SS2.p2.2.m2.1.1.1.1.3.3.3.1.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.3.3.3.1"></times><ci id="S3.SS2.p2.2.m2.1.1.1.1.3.3.3.2.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.3.3.3.2">𝑖</ci><ci id="S3.SS2.p2.2.m2.1.1.1.1.3.3.3.3.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.3.3.3.3">𝑛</ci></apply></apply></apply></apply><apply id="S3.SS2.p2.2.m2.2.2.2.2.cmml" xref="S3.SS2.p2.2.m2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.2.2.2.2.1.cmml" xref="S3.SS2.p2.2.m2.2.2.2.2">subscript</csymbol><apply id="S3.SS2.p2.2.m2.2.2.2.2.2.cmml" xref="S3.SS2.p2.2.m2.2.2.2.2.2"><ci id="S3.SS2.p2.2.m2.2.2.2.2.2.1.cmml" xref="S3.SS2.p2.2.m2.2.2.2.2.2.1">~</ci><ci id="S3.SS2.p2.2.m2.2.2.2.2.2.2.cmml" xref="S3.SS2.p2.2.m2.2.2.2.2.2.2">𝑦</ci></apply><apply id="S3.SS2.p2.2.m2.2.2.2.2.3.cmml" xref="S3.SS2.p2.2.m2.2.2.2.2.3"><ci id="S3.SS2.p2.2.m2.2.2.2.2.3.1.cmml" xref="S3.SS2.p2.2.m2.2.2.2.2.3.1">:</ci><cn id="S3.SS2.p2.2.m2.2.2.2.2.3.2.cmml" type="integer" xref="S3.SS2.p2.2.m2.2.2.2.2.3.2">1</cn><apply id="S3.SS2.p2.2.m2.2.2.2.2.3.3.cmml" xref="S3.SS2.p2.2.m2.2.2.2.2.3.3"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.2.2.2.2.3.3.1.cmml" xref="S3.SS2.p2.2.m2.2.2.2.2.3.3">subscript</csymbol><ci id="S3.SS2.p2.2.m2.2.2.2.2.3.3.2.cmml" xref="S3.SS2.p2.2.m2.2.2.2.2.3.3.2">𝑛</ci><apply id="S3.SS2.p2.2.m2.2.2.2.2.3.3.3.cmml" xref="S3.SS2.p2.2.m2.2.2.2.2.3.3.3"><times id="S3.SS2.p2.2.m2.2.2.2.2.3.3.3.1.cmml" xref="S3.SS2.p2.2.m2.2.2.2.2.3.3.3.1"></times><ci id="S3.SS2.p2.2.m2.2.2.2.2.3.3.3.2.cmml" xref="S3.SS2.p2.2.m2.2.2.2.2.3.3.3.2">𝑖</ci><ci id="S3.SS2.p2.2.m2.2.2.2.2.3.3.3.3.cmml" xref="S3.SS2.p2.2.m2.2.2.2.2.3.3.3.3">𝑛</ci></apply></apply></apply></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.2c">(\tilde{u}_{1:{n_{in}}},\tilde{y}_{1:{n_{in}}})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.2.m2.2d">( over~ start_ARG italic_u end_ARG start_POSTSUBSCRIPT 1 : italic_n start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT end_POSTSUBSCRIPT , over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT 1 : italic_n start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT end_POSTSUBSCRIPT )</annotation></semantics></math>, and context <math alttext="(u_{1:m},y_{1:m})" class="ltx_Math" display="inline" id="S3.SS2.p2.3.m3.2"><semantics id="S3.SS2.p2.3.m3.2a"><mrow id="S3.SS2.p2.3.m3.2.2.2" xref="S3.SS2.p2.3.m3.2.2.3.cmml"><mo id="S3.SS2.p2.3.m3.2.2.2.3" stretchy="false" xref="S3.SS2.p2.3.m3.2.2.3.cmml">(</mo><msub id="S3.SS2.p2.3.m3.1.1.1.1" xref="S3.SS2.p2.3.m3.1.1.1.1.cmml"><mi id="S3.SS2.p2.3.m3.1.1.1.1.2" xref="S3.SS2.p2.3.m3.1.1.1.1.2.cmml">u</mi><mrow id="S3.SS2.p2.3.m3.1.1.1.1.3" xref="S3.SS2.p2.3.m3.1.1.1.1.3.cmml"><mn id="S3.SS2.p2.3.m3.1.1.1.1.3.2" xref="S3.SS2.p2.3.m3.1.1.1.1.3.2.cmml">1</mn><mo id="S3.SS2.p2.3.m3.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS2.p2.3.m3.1.1.1.1.3.1.cmml">:</mo><mi id="S3.SS2.p2.3.m3.1.1.1.1.3.3" xref="S3.SS2.p2.3.m3.1.1.1.1.3.3.cmml">m</mi></mrow></msub><mo id="S3.SS2.p2.3.m3.2.2.2.4" xref="S3.SS2.p2.3.m3.2.2.3.cmml">,</mo><msub id="S3.SS2.p2.3.m3.2.2.2.2" xref="S3.SS2.p2.3.m3.2.2.2.2.cmml"><mi id="S3.SS2.p2.3.m3.2.2.2.2.2" xref="S3.SS2.p2.3.m3.2.2.2.2.2.cmml">y</mi><mrow id="S3.SS2.p2.3.m3.2.2.2.2.3" xref="S3.SS2.p2.3.m3.2.2.2.2.3.cmml"><mn id="S3.SS2.p2.3.m3.2.2.2.2.3.2" xref="S3.SS2.p2.3.m3.2.2.2.2.3.2.cmml">1</mn><mo id="S3.SS2.p2.3.m3.2.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS2.p2.3.m3.2.2.2.2.3.1.cmml">:</mo><mi id="S3.SS2.p2.3.m3.2.2.2.2.3.3" xref="S3.SS2.p2.3.m3.2.2.2.2.3.3.cmml">m</mi></mrow></msub><mo id="S3.SS2.p2.3.m3.2.2.2.5" stretchy="false" xref="S3.SS2.p2.3.m3.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.2b"><interval closure="open" id="S3.SS2.p2.3.m3.2.2.3.cmml" xref="S3.SS2.p2.3.m3.2.2.2"><apply id="S3.SS2.p2.3.m3.1.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.2">𝑢</ci><apply id="S3.SS2.p2.3.m3.1.1.1.1.3.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.3"><ci id="S3.SS2.p2.3.m3.1.1.1.1.3.1.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.3.1">:</ci><cn id="S3.SS2.p2.3.m3.1.1.1.1.3.2.cmml" type="integer" xref="S3.SS2.p2.3.m3.1.1.1.1.3.2">1</cn><ci id="S3.SS2.p2.3.m3.1.1.1.1.3.3.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.3.3">𝑚</ci></apply></apply><apply id="S3.SS2.p2.3.m3.2.2.2.2.cmml" xref="S3.SS2.p2.3.m3.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.2.2.2.2.1.cmml" xref="S3.SS2.p2.3.m3.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p2.3.m3.2.2.2.2.2.cmml" xref="S3.SS2.p2.3.m3.2.2.2.2.2">𝑦</ci><apply id="S3.SS2.p2.3.m3.2.2.2.2.3.cmml" xref="S3.SS2.p2.3.m3.2.2.2.2.3"><ci id="S3.SS2.p2.3.m3.2.2.2.2.3.1.cmml" xref="S3.SS2.p2.3.m3.2.2.2.2.3.1">:</ci><cn id="S3.SS2.p2.3.m3.2.2.2.2.3.2.cmml" type="integer" xref="S3.SS2.p2.3.m3.2.2.2.2.3.2">1</cn><ci id="S3.SS2.p2.3.m3.2.2.2.2.3.3.cmml" xref="S3.SS2.p2.3.m3.2.2.2.2.3.3">𝑚</ci></apply></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.2c">(u_{1:m},y_{1:m})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.3.m3.2d">( italic_u start_POSTSUBSCRIPT 1 : italic_m end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 1 : italic_m end_POSTSUBSCRIPT )</annotation></semantics></math>, the meta-model returns the mean and standard deviation vectors <math alttext="\mu_{n_{in}+1:N}" class="ltx_Math" display="inline" id="S3.SS2.p2.4.m4.1"><semantics id="S3.SS2.p2.4.m4.1a"><msub id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml"><mi id="S3.SS2.p2.4.m4.1.1.2" xref="S3.SS2.p2.4.m4.1.1.2.cmml">μ</mi><mrow id="S3.SS2.p2.4.m4.1.1.3" xref="S3.SS2.p2.4.m4.1.1.3.cmml"><mrow id="S3.SS2.p2.4.m4.1.1.3.2" xref="S3.SS2.p2.4.m4.1.1.3.2.cmml"><msub id="S3.SS2.p2.4.m4.1.1.3.2.2" xref="S3.SS2.p2.4.m4.1.1.3.2.2.cmml"><mi id="S3.SS2.p2.4.m4.1.1.3.2.2.2" xref="S3.SS2.p2.4.m4.1.1.3.2.2.2.cmml">n</mi><mrow id="S3.SS2.p2.4.m4.1.1.3.2.2.3" xref="S3.SS2.p2.4.m4.1.1.3.2.2.3.cmml"><mi id="S3.SS2.p2.4.m4.1.1.3.2.2.3.2" xref="S3.SS2.p2.4.m4.1.1.3.2.2.3.2.cmml">i</mi><mo id="S3.SS2.p2.4.m4.1.1.3.2.2.3.1" xref="S3.SS2.p2.4.m4.1.1.3.2.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.4.m4.1.1.3.2.2.3.3" xref="S3.SS2.p2.4.m4.1.1.3.2.2.3.3.cmml">n</mi></mrow></msub><mo id="S3.SS2.p2.4.m4.1.1.3.2.1" xref="S3.SS2.p2.4.m4.1.1.3.2.1.cmml">+</mo><mn id="S3.SS2.p2.4.m4.1.1.3.2.3" xref="S3.SS2.p2.4.m4.1.1.3.2.3.cmml">1</mn></mrow><mo id="S3.SS2.p2.4.m4.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS2.p2.4.m4.1.1.3.1.cmml">:</mo><mi id="S3.SS2.p2.4.m4.1.1.3.3" xref="S3.SS2.p2.4.m4.1.1.3.3.cmml">N</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><apply id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.1.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p2.4.m4.1.1.2.cmml" xref="S3.SS2.p2.4.m4.1.1.2">𝜇</ci><apply id="S3.SS2.p2.4.m4.1.1.3.cmml" xref="S3.SS2.p2.4.m4.1.1.3"><ci id="S3.SS2.p2.4.m4.1.1.3.1.cmml" xref="S3.SS2.p2.4.m4.1.1.3.1">:</ci><apply id="S3.SS2.p2.4.m4.1.1.3.2.cmml" xref="S3.SS2.p2.4.m4.1.1.3.2"><plus id="S3.SS2.p2.4.m4.1.1.3.2.1.cmml" xref="S3.SS2.p2.4.m4.1.1.3.2.1"></plus><apply id="S3.SS2.p2.4.m4.1.1.3.2.2.cmml" xref="S3.SS2.p2.4.m4.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.1.1.3.2.2.1.cmml" xref="S3.SS2.p2.4.m4.1.1.3.2.2">subscript</csymbol><ci id="S3.SS2.p2.4.m4.1.1.3.2.2.2.cmml" xref="S3.SS2.p2.4.m4.1.1.3.2.2.2">𝑛</ci><apply id="S3.SS2.p2.4.m4.1.1.3.2.2.3.cmml" xref="S3.SS2.p2.4.m4.1.1.3.2.2.3"><times id="S3.SS2.p2.4.m4.1.1.3.2.2.3.1.cmml" xref="S3.SS2.p2.4.m4.1.1.3.2.2.3.1"></times><ci id="S3.SS2.p2.4.m4.1.1.3.2.2.3.2.cmml" xref="S3.SS2.p2.4.m4.1.1.3.2.2.3.2">𝑖</ci><ci id="S3.SS2.p2.4.m4.1.1.3.2.2.3.3.cmml" xref="S3.SS2.p2.4.m4.1.1.3.2.2.3.3">𝑛</ci></apply></apply><cn id="S3.SS2.p2.4.m4.1.1.3.2.3.cmml" type="integer" xref="S3.SS2.p2.4.m4.1.1.3.2.3">1</cn></apply><ci id="S3.SS2.p2.4.m4.1.1.3.3.cmml" xref="S3.SS2.p2.4.m4.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">\mu_{n_{in}+1:N}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.4.m4.1d">italic_μ start_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT + 1 : italic_N end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\sigma_{n_{in}+1:N}" class="ltx_Math" display="inline" id="S3.SS2.p2.5.m5.1"><semantics id="S3.SS2.p2.5.m5.1a"><msub id="S3.SS2.p2.5.m5.1.1" xref="S3.SS2.p2.5.m5.1.1.cmml"><mi id="S3.SS2.p2.5.m5.1.1.2" xref="S3.SS2.p2.5.m5.1.1.2.cmml">σ</mi><mrow id="S3.SS2.p2.5.m5.1.1.3" xref="S3.SS2.p2.5.m5.1.1.3.cmml"><mrow id="S3.SS2.p2.5.m5.1.1.3.2" xref="S3.SS2.p2.5.m5.1.1.3.2.cmml"><msub id="S3.SS2.p2.5.m5.1.1.3.2.2" xref="S3.SS2.p2.5.m5.1.1.3.2.2.cmml"><mi id="S3.SS2.p2.5.m5.1.1.3.2.2.2" xref="S3.SS2.p2.5.m5.1.1.3.2.2.2.cmml">n</mi><mrow id="S3.SS2.p2.5.m5.1.1.3.2.2.3" xref="S3.SS2.p2.5.m5.1.1.3.2.2.3.cmml"><mi id="S3.SS2.p2.5.m5.1.1.3.2.2.3.2" xref="S3.SS2.p2.5.m5.1.1.3.2.2.3.2.cmml">i</mi><mo id="S3.SS2.p2.5.m5.1.1.3.2.2.3.1" xref="S3.SS2.p2.5.m5.1.1.3.2.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.5.m5.1.1.3.2.2.3.3" xref="S3.SS2.p2.5.m5.1.1.3.2.2.3.3.cmml">n</mi></mrow></msub><mo id="S3.SS2.p2.5.m5.1.1.3.2.1" xref="S3.SS2.p2.5.m5.1.1.3.2.1.cmml">+</mo><mn id="S3.SS2.p2.5.m5.1.1.3.2.3" xref="S3.SS2.p2.5.m5.1.1.3.2.3.cmml">1</mn></mrow><mo id="S3.SS2.p2.5.m5.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS2.p2.5.m5.1.1.3.1.cmml">:</mo><mi id="S3.SS2.p2.5.m5.1.1.3.3" xref="S3.SS2.p2.5.m5.1.1.3.3.cmml">N</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m5.1b"><apply id="S3.SS2.p2.5.m5.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.5.m5.1.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p2.5.m5.1.1.2.cmml" xref="S3.SS2.p2.5.m5.1.1.2">𝜎</ci><apply id="S3.SS2.p2.5.m5.1.1.3.cmml" xref="S3.SS2.p2.5.m5.1.1.3"><ci id="S3.SS2.p2.5.m5.1.1.3.1.cmml" xref="S3.SS2.p2.5.m5.1.1.3.1">:</ci><apply id="S3.SS2.p2.5.m5.1.1.3.2.cmml" xref="S3.SS2.p2.5.m5.1.1.3.2"><plus id="S3.SS2.p2.5.m5.1.1.3.2.1.cmml" xref="S3.SS2.p2.5.m5.1.1.3.2.1"></plus><apply id="S3.SS2.p2.5.m5.1.1.3.2.2.cmml" xref="S3.SS2.p2.5.m5.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.5.m5.1.1.3.2.2.1.cmml" xref="S3.SS2.p2.5.m5.1.1.3.2.2">subscript</csymbol><ci id="S3.SS2.p2.5.m5.1.1.3.2.2.2.cmml" xref="S3.SS2.p2.5.m5.1.1.3.2.2.2">𝑛</ci><apply id="S3.SS2.p2.5.m5.1.1.3.2.2.3.cmml" xref="S3.SS2.p2.5.m5.1.1.3.2.2.3"><times id="S3.SS2.p2.5.m5.1.1.3.2.2.3.1.cmml" xref="S3.SS2.p2.5.m5.1.1.3.2.2.3.1"></times><ci id="S3.SS2.p2.5.m5.1.1.3.2.2.3.2.cmml" xref="S3.SS2.p2.5.m5.1.1.3.2.2.3.2">𝑖</ci><ci id="S3.SS2.p2.5.m5.1.1.3.2.2.3.3.cmml" xref="S3.SS2.p2.5.m5.1.1.3.2.2.3.3">𝑛</ci></apply></apply><cn id="S3.SS2.p2.5.m5.1.1.3.2.3.cmml" type="integer" xref="S3.SS2.p2.5.m5.1.1.3.2.3">1</cn></apply><ci id="S3.SS2.p2.5.m5.1.1.3.3.cmml" xref="S3.SS2.p2.5.m5.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.1c">\sigma_{n_{in}+1:N}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.5.m5.1d">italic_σ start_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT + 1 : italic_N end_POSTSUBSCRIPT</annotation></semantics></math> of the probability distribution of the future output sequence <math alttext="\tilde{y}_{n_{in}+1:N}" class="ltx_Math" display="inline" id="S3.SS2.p2.6.m6.1"><semantics id="S3.SS2.p2.6.m6.1a"><msub id="S3.SS2.p2.6.m6.1.1" xref="S3.SS2.p2.6.m6.1.1.cmml"><mover accent="true" id="S3.SS2.p2.6.m6.1.1.2" xref="S3.SS2.p2.6.m6.1.1.2.cmml"><mi id="S3.SS2.p2.6.m6.1.1.2.2" xref="S3.SS2.p2.6.m6.1.1.2.2.cmml">y</mi><mo id="S3.SS2.p2.6.m6.1.1.2.1" xref="S3.SS2.p2.6.m6.1.1.2.1.cmml">~</mo></mover><mrow id="S3.SS2.p2.6.m6.1.1.3" xref="S3.SS2.p2.6.m6.1.1.3.cmml"><mrow id="S3.SS2.p2.6.m6.1.1.3.2" xref="S3.SS2.p2.6.m6.1.1.3.2.cmml"><msub id="S3.SS2.p2.6.m6.1.1.3.2.2" xref="S3.SS2.p2.6.m6.1.1.3.2.2.cmml"><mi id="S3.SS2.p2.6.m6.1.1.3.2.2.2" xref="S3.SS2.p2.6.m6.1.1.3.2.2.2.cmml">n</mi><mrow id="S3.SS2.p2.6.m6.1.1.3.2.2.3" xref="S3.SS2.p2.6.m6.1.1.3.2.2.3.cmml"><mi id="S3.SS2.p2.6.m6.1.1.3.2.2.3.2" xref="S3.SS2.p2.6.m6.1.1.3.2.2.3.2.cmml">i</mi><mo id="S3.SS2.p2.6.m6.1.1.3.2.2.3.1" xref="S3.SS2.p2.6.m6.1.1.3.2.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.6.m6.1.1.3.2.2.3.3" xref="S3.SS2.p2.6.m6.1.1.3.2.2.3.3.cmml">n</mi></mrow></msub><mo id="S3.SS2.p2.6.m6.1.1.3.2.1" xref="S3.SS2.p2.6.m6.1.1.3.2.1.cmml">+</mo><mn id="S3.SS2.p2.6.m6.1.1.3.2.3" xref="S3.SS2.p2.6.m6.1.1.3.2.3.cmml">1</mn></mrow><mo id="S3.SS2.p2.6.m6.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS2.p2.6.m6.1.1.3.1.cmml">:</mo><mi id="S3.SS2.p2.6.m6.1.1.3.3" xref="S3.SS2.p2.6.m6.1.1.3.3.cmml">N</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m6.1b"><apply id="S3.SS2.p2.6.m6.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m6.1.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1">subscript</csymbol><apply id="S3.SS2.p2.6.m6.1.1.2.cmml" xref="S3.SS2.p2.6.m6.1.1.2"><ci id="S3.SS2.p2.6.m6.1.1.2.1.cmml" xref="S3.SS2.p2.6.m6.1.1.2.1">~</ci><ci id="S3.SS2.p2.6.m6.1.1.2.2.cmml" xref="S3.SS2.p2.6.m6.1.1.2.2">𝑦</ci></apply><apply id="S3.SS2.p2.6.m6.1.1.3.cmml" xref="S3.SS2.p2.6.m6.1.1.3"><ci id="S3.SS2.p2.6.m6.1.1.3.1.cmml" xref="S3.SS2.p2.6.m6.1.1.3.1">:</ci><apply id="S3.SS2.p2.6.m6.1.1.3.2.cmml" xref="S3.SS2.p2.6.m6.1.1.3.2"><plus id="S3.SS2.p2.6.m6.1.1.3.2.1.cmml" xref="S3.SS2.p2.6.m6.1.1.3.2.1"></plus><apply id="S3.SS2.p2.6.m6.1.1.3.2.2.cmml" xref="S3.SS2.p2.6.m6.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m6.1.1.3.2.2.1.cmml" xref="S3.SS2.p2.6.m6.1.1.3.2.2">subscript</csymbol><ci id="S3.SS2.p2.6.m6.1.1.3.2.2.2.cmml" xref="S3.SS2.p2.6.m6.1.1.3.2.2.2">𝑛</ci><apply id="S3.SS2.p2.6.m6.1.1.3.2.2.3.cmml" xref="S3.SS2.p2.6.m6.1.1.3.2.2.3"><times id="S3.SS2.p2.6.m6.1.1.3.2.2.3.1.cmml" xref="S3.SS2.p2.6.m6.1.1.3.2.2.3.1"></times><ci id="S3.SS2.p2.6.m6.1.1.3.2.2.3.2.cmml" xref="S3.SS2.p2.6.m6.1.1.3.2.2.3.2">𝑖</ci><ci id="S3.SS2.p2.6.m6.1.1.3.2.2.3.3.cmml" xref="S3.SS2.p2.6.m6.1.1.3.2.2.3.3">𝑛</ci></apply></apply><cn id="S3.SS2.p2.6.m6.1.1.3.2.3.cmml" type="integer" xref="S3.SS2.p2.6.m6.1.1.3.2.3">1</cn></apply><ci id="S3.SS2.p2.6.m6.1.1.3.3.cmml" xref="S3.SS2.p2.6.m6.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m6.1c">\tilde{y}_{n_{in}+1:N}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.6.m6.1d">over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT + 1 : italic_N end_POSTSUBSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mu_{n_{in}+1:N},\sigma_{n_{in}+1:N}=\\
\mathcal{M}_{\phi}(\tilde{u}_{n_{in}+1:N},\tilde{u}_{1:{n_{in}}},\tilde{y}_{1:%
{n_{in}}},u_{1:m},y_{1:m})." class="ltx_Math" display="block" id="S3.E8.m1.1"><semantics id="S3.E8.m1.1a"><mrow id="S3.E8.m1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml"><mrow id="S3.E8.m1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml"><mrow id="S3.E8.m1.1.1.1.1.2.2" xref="S3.E8.m1.1.1.1.1.2.3.cmml"><msub id="S3.E8.m1.1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.1.1.2.cmml">μ</mi><mrow id="S3.E8.m1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.1.1.3.cmml"><mrow id="S3.E8.m1.1.1.1.1.1.1.1.3.2" xref="S3.E8.m1.1.1.1.1.1.1.1.3.2.cmml"><msub id="S3.E8.m1.1.1.1.1.1.1.1.3.2.2" xref="S3.E8.m1.1.1.1.1.1.1.1.3.2.2.cmml"><mi id="S3.E8.m1.1.1.1.1.1.1.1.3.2.2.2" xref="S3.E8.m1.1.1.1.1.1.1.1.3.2.2.2.cmml">n</mi><mrow id="S3.E8.m1.1.1.1.1.1.1.1.3.2.2.3" xref="S3.E8.m1.1.1.1.1.1.1.1.3.2.2.3.cmml"><mi id="S3.E8.m1.1.1.1.1.1.1.1.3.2.2.3.2" xref="S3.E8.m1.1.1.1.1.1.1.1.3.2.2.3.2.cmml">i</mi><mo id="S3.E8.m1.1.1.1.1.1.1.1.3.2.2.3.1" xref="S3.E8.m1.1.1.1.1.1.1.1.3.2.2.3.1.cmml">⁢</mo><mi id="S3.E8.m1.1.1.1.1.1.1.1.3.2.2.3.3" xref="S3.E8.m1.1.1.1.1.1.1.1.3.2.2.3.3.cmml">n</mi></mrow></msub><mo id="S3.E8.m1.1.1.1.1.1.1.1.3.2.1" xref="S3.E8.m1.1.1.1.1.1.1.1.3.2.1.cmml">+</mo><mn id="S3.E8.m1.1.1.1.1.1.1.1.3.2.3" xref="S3.E8.m1.1.1.1.1.1.1.1.3.2.3.cmml">1</mn></mrow><mo id="S3.E8.m1.1.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.E8.m1.1.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="S3.E8.m1.1.1.1.1.1.1.1.3.3" xref="S3.E8.m1.1.1.1.1.1.1.1.3.3.cmml">N</mi></mrow></msub><mo id="S3.E8.m1.1.1.1.1.2.2.3" xref="S3.E8.m1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.E8.m1.1.1.1.1.2.2.2" xref="S3.E8.m1.1.1.1.1.2.2.2.cmml"><mi id="S3.E8.m1.1.1.1.1.2.2.2.2" xref="S3.E8.m1.1.1.1.1.2.2.2.2.cmml">σ</mi><mrow id="S3.E8.m1.1.1.1.1.2.2.2.3" xref="S3.E8.m1.1.1.1.1.2.2.2.3.cmml"><mrow id="S3.E8.m1.1.1.1.1.2.2.2.3.2" xref="S3.E8.m1.1.1.1.1.2.2.2.3.2.cmml"><msub id="S3.E8.m1.1.1.1.1.2.2.2.3.2.2" xref="S3.E8.m1.1.1.1.1.2.2.2.3.2.2.cmml"><mi id="S3.E8.m1.1.1.1.1.2.2.2.3.2.2.2" xref="S3.E8.m1.1.1.1.1.2.2.2.3.2.2.2.cmml">n</mi><mrow id="S3.E8.m1.1.1.1.1.2.2.2.3.2.2.3" xref="S3.E8.m1.1.1.1.1.2.2.2.3.2.2.3.cmml"><mi id="S3.E8.m1.1.1.1.1.2.2.2.3.2.2.3.2" xref="S3.E8.m1.1.1.1.1.2.2.2.3.2.2.3.2.cmml">i</mi><mo id="S3.E8.m1.1.1.1.1.2.2.2.3.2.2.3.1" xref="S3.E8.m1.1.1.1.1.2.2.2.3.2.2.3.1.cmml">⁢</mo><mi id="S3.E8.m1.1.1.1.1.2.2.2.3.2.2.3.3" xref="S3.E8.m1.1.1.1.1.2.2.2.3.2.2.3.3.cmml">n</mi></mrow></msub><mo id="S3.E8.m1.1.1.1.1.2.2.2.3.2.1" xref="S3.E8.m1.1.1.1.1.2.2.2.3.2.1.cmml">+</mo><mn id="S3.E8.m1.1.1.1.1.2.2.2.3.2.3" xref="S3.E8.m1.1.1.1.1.2.2.2.3.2.3.cmml">1</mn></mrow><mo id="S3.E8.m1.1.1.1.1.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.E8.m1.1.1.1.1.2.2.2.3.1.cmml">:</mo><mi id="S3.E8.m1.1.1.1.1.2.2.2.3.3" xref="S3.E8.m1.1.1.1.1.2.2.2.3.3.cmml">N</mi></mrow></msub></mrow><mo id="S3.E8.m1.1.1.1.1.8" xref="S3.E8.m1.1.1.1.1.8.cmml">=</mo><mrow id="S3.E8.m1.1.1.1.1.7" xref="S3.E8.m1.1.1.1.1.7.cmml"><msub id="S3.E8.m1.1.1.1.1.7.7" xref="S3.E8.m1.1.1.1.1.7.7.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.1.1.1.1.7.7.2" xref="S3.E8.m1.1.1.1.1.7.7.2.cmml">ℳ</mi><mi id="S3.E8.m1.1.1.1.1.7.7.3" xref="S3.E8.m1.1.1.1.1.7.7.3.cmml">ϕ</mi></msub><mo id="S3.E8.m1.1.1.1.1.7.6" xref="S3.E8.m1.1.1.1.1.7.6.cmml">⁢</mo><mrow id="S3.E8.m1.1.1.1.1.7.5.5" xref="S3.E8.m1.1.1.1.1.7.5.6.cmml"><mo id="S3.E8.m1.1.1.1.1.7.5.5.6" stretchy="false" xref="S3.E8.m1.1.1.1.1.7.5.6.cmml">(</mo><msub id="S3.E8.m1.1.1.1.1.3.1.1.1" xref="S3.E8.m1.1.1.1.1.3.1.1.1.cmml"><mover accent="true" id="S3.E8.m1.1.1.1.1.3.1.1.1.2" xref="S3.E8.m1.1.1.1.1.3.1.1.1.2.cmml"><mi id="S3.E8.m1.1.1.1.1.3.1.1.1.2.2" xref="S3.E8.m1.1.1.1.1.3.1.1.1.2.2.cmml">u</mi><mo id="S3.E8.m1.1.1.1.1.3.1.1.1.2.1" xref="S3.E8.m1.1.1.1.1.3.1.1.1.2.1.cmml">~</mo></mover><mrow id="S3.E8.m1.1.1.1.1.3.1.1.1.3" xref="S3.E8.m1.1.1.1.1.3.1.1.1.3.cmml"><mrow id="S3.E8.m1.1.1.1.1.3.1.1.1.3.2" xref="S3.E8.m1.1.1.1.1.3.1.1.1.3.2.cmml"><msub id="S3.E8.m1.1.1.1.1.3.1.1.1.3.2.2" xref="S3.E8.m1.1.1.1.1.3.1.1.1.3.2.2.cmml"><mi id="S3.E8.m1.1.1.1.1.3.1.1.1.3.2.2.2" xref="S3.E8.m1.1.1.1.1.3.1.1.1.3.2.2.2.cmml">n</mi><mrow id="S3.E8.m1.1.1.1.1.3.1.1.1.3.2.2.3" xref="S3.E8.m1.1.1.1.1.3.1.1.1.3.2.2.3.cmml"><mi id="S3.E8.m1.1.1.1.1.3.1.1.1.3.2.2.3.2" xref="S3.E8.m1.1.1.1.1.3.1.1.1.3.2.2.3.2.cmml">i</mi><mo id="S3.E8.m1.1.1.1.1.3.1.1.1.3.2.2.3.1" xref="S3.E8.m1.1.1.1.1.3.1.1.1.3.2.2.3.1.cmml">⁢</mo><mi id="S3.E8.m1.1.1.1.1.3.1.1.1.3.2.2.3.3" xref="S3.E8.m1.1.1.1.1.3.1.1.1.3.2.2.3.3.cmml">n</mi></mrow></msub><mo id="S3.E8.m1.1.1.1.1.3.1.1.1.3.2.1" xref="S3.E8.m1.1.1.1.1.3.1.1.1.3.2.1.cmml">+</mo><mn id="S3.E8.m1.1.1.1.1.3.1.1.1.3.2.3" xref="S3.E8.m1.1.1.1.1.3.1.1.1.3.2.3.cmml">1</mn></mrow><mo id="S3.E8.m1.1.1.1.1.3.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.E8.m1.1.1.1.1.3.1.1.1.3.1.cmml">:</mo><mi id="S3.E8.m1.1.1.1.1.3.1.1.1.3.3" xref="S3.E8.m1.1.1.1.1.3.1.1.1.3.3.cmml">N</mi></mrow></msub><mo id="S3.E8.m1.1.1.1.1.7.5.5.7" xref="S3.E8.m1.1.1.1.1.7.5.6.cmml">,</mo><msub id="S3.E8.m1.1.1.1.1.4.2.2.2" xref="S3.E8.m1.1.1.1.1.4.2.2.2.cmml"><mover accent="true" id="S3.E8.m1.1.1.1.1.4.2.2.2.2" xref="S3.E8.m1.1.1.1.1.4.2.2.2.2.cmml"><mi id="S3.E8.m1.1.1.1.1.4.2.2.2.2.2" xref="S3.E8.m1.1.1.1.1.4.2.2.2.2.2.cmml">u</mi><mo id="S3.E8.m1.1.1.1.1.4.2.2.2.2.1" xref="S3.E8.m1.1.1.1.1.4.2.2.2.2.1.cmml">~</mo></mover><mrow id="S3.E8.m1.1.1.1.1.4.2.2.2.3" xref="S3.E8.m1.1.1.1.1.4.2.2.2.3.cmml"><mn id="S3.E8.m1.1.1.1.1.4.2.2.2.3.2" xref="S3.E8.m1.1.1.1.1.4.2.2.2.3.2.cmml">1</mn><mo id="S3.E8.m1.1.1.1.1.4.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.E8.m1.1.1.1.1.4.2.2.2.3.1.cmml">:</mo><msub id="S3.E8.m1.1.1.1.1.4.2.2.2.3.3" xref="S3.E8.m1.1.1.1.1.4.2.2.2.3.3.cmml"><mi id="S3.E8.m1.1.1.1.1.4.2.2.2.3.3.2" xref="S3.E8.m1.1.1.1.1.4.2.2.2.3.3.2.cmml">n</mi><mrow id="S3.E8.m1.1.1.1.1.4.2.2.2.3.3.3" xref="S3.E8.m1.1.1.1.1.4.2.2.2.3.3.3.cmml"><mi id="S3.E8.m1.1.1.1.1.4.2.2.2.3.3.3.2" xref="S3.E8.m1.1.1.1.1.4.2.2.2.3.3.3.2.cmml">i</mi><mo id="S3.E8.m1.1.1.1.1.4.2.2.2.3.3.3.1" xref="S3.E8.m1.1.1.1.1.4.2.2.2.3.3.3.1.cmml">⁢</mo><mi id="S3.E8.m1.1.1.1.1.4.2.2.2.3.3.3.3" xref="S3.E8.m1.1.1.1.1.4.2.2.2.3.3.3.3.cmml">n</mi></mrow></msub></mrow></msub><mo id="S3.E8.m1.1.1.1.1.7.5.5.8" xref="S3.E8.m1.1.1.1.1.7.5.6.cmml">,</mo><msub id="S3.E8.m1.1.1.1.1.5.3.3.3" xref="S3.E8.m1.1.1.1.1.5.3.3.3.cmml"><mover accent="true" id="S3.E8.m1.1.1.1.1.5.3.3.3.2" xref="S3.E8.m1.1.1.1.1.5.3.3.3.2.cmml"><mi id="S3.E8.m1.1.1.1.1.5.3.3.3.2.2" xref="S3.E8.m1.1.1.1.1.5.3.3.3.2.2.cmml">y</mi><mo id="S3.E8.m1.1.1.1.1.5.3.3.3.2.1" xref="S3.E8.m1.1.1.1.1.5.3.3.3.2.1.cmml">~</mo></mover><mrow id="S3.E8.m1.1.1.1.1.5.3.3.3.3" xref="S3.E8.m1.1.1.1.1.5.3.3.3.3.cmml"><mn id="S3.E8.m1.1.1.1.1.5.3.3.3.3.2" xref="S3.E8.m1.1.1.1.1.5.3.3.3.3.2.cmml">1</mn><mo id="S3.E8.m1.1.1.1.1.5.3.3.3.3.1" lspace="0.278em" rspace="0.278em" xref="S3.E8.m1.1.1.1.1.5.3.3.3.3.1.cmml">:</mo><msub id="S3.E8.m1.1.1.1.1.5.3.3.3.3.3" xref="S3.E8.m1.1.1.1.1.5.3.3.3.3.3.cmml"><mi id="S3.E8.m1.1.1.1.1.5.3.3.3.3.3.2" xref="S3.E8.m1.1.1.1.1.5.3.3.3.3.3.2.cmml">n</mi><mrow id="S3.E8.m1.1.1.1.1.5.3.3.3.3.3.3" xref="S3.E8.m1.1.1.1.1.5.3.3.3.3.3.3.cmml"><mi id="S3.E8.m1.1.1.1.1.5.3.3.3.3.3.3.2" xref="S3.E8.m1.1.1.1.1.5.3.3.3.3.3.3.2.cmml">i</mi><mo id="S3.E8.m1.1.1.1.1.5.3.3.3.3.3.3.1" xref="S3.E8.m1.1.1.1.1.5.3.3.3.3.3.3.1.cmml">⁢</mo><mi id="S3.E8.m1.1.1.1.1.5.3.3.3.3.3.3.3" xref="S3.E8.m1.1.1.1.1.5.3.3.3.3.3.3.3.cmml">n</mi></mrow></msub></mrow></msub><mo id="S3.E8.m1.1.1.1.1.7.5.5.9" xref="S3.E8.m1.1.1.1.1.7.5.6.cmml">,</mo><msub id="S3.E8.m1.1.1.1.1.6.4.4.4" xref="S3.E8.m1.1.1.1.1.6.4.4.4.cmml"><mi id="S3.E8.m1.1.1.1.1.6.4.4.4.2" xref="S3.E8.m1.1.1.1.1.6.4.4.4.2.cmml">u</mi><mrow id="S3.E8.m1.1.1.1.1.6.4.4.4.3" xref="S3.E8.m1.1.1.1.1.6.4.4.4.3.cmml"><mn id="S3.E8.m1.1.1.1.1.6.4.4.4.3.2" xref="S3.E8.m1.1.1.1.1.6.4.4.4.3.2.cmml">1</mn><mo id="S3.E8.m1.1.1.1.1.6.4.4.4.3.1" lspace="0.278em" rspace="0.278em" xref="S3.E8.m1.1.1.1.1.6.4.4.4.3.1.cmml">:</mo><mi id="S3.E8.m1.1.1.1.1.6.4.4.4.3.3" xref="S3.E8.m1.1.1.1.1.6.4.4.4.3.3.cmml">m</mi></mrow></msub><mo id="S3.E8.m1.1.1.1.1.7.5.5.10" xref="S3.E8.m1.1.1.1.1.7.5.6.cmml">,</mo><msub id="S3.E8.m1.1.1.1.1.7.5.5.5" xref="S3.E8.m1.1.1.1.1.7.5.5.5.cmml"><mi id="S3.E8.m1.1.1.1.1.7.5.5.5.2" xref="S3.E8.m1.1.1.1.1.7.5.5.5.2.cmml">y</mi><mrow id="S3.E8.m1.1.1.1.1.7.5.5.5.3" xref="S3.E8.m1.1.1.1.1.7.5.5.5.3.cmml"><mn id="S3.E8.m1.1.1.1.1.7.5.5.5.3.2" xref="S3.E8.m1.1.1.1.1.7.5.5.5.3.2.cmml">1</mn><mo id="S3.E8.m1.1.1.1.1.7.5.5.5.3.1" lspace="0.278em" rspace="0.278em" xref="S3.E8.m1.1.1.1.1.7.5.5.5.3.1.cmml">:</mo><mi id="S3.E8.m1.1.1.1.1.7.5.5.5.3.3" xref="S3.E8.m1.1.1.1.1.7.5.5.5.3.3.cmml">m</mi></mrow></msub><mo id="S3.E8.m1.1.1.1.1.7.5.5.11" stretchy="false" xref="S3.E8.m1.1.1.1.1.7.5.6.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E8.m1.1.1.1.2" lspace="0em" xref="S3.E8.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.1b"><apply id="S3.E8.m1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1"><eq id="S3.E8.m1.1.1.1.1.8.cmml" xref="S3.E8.m1.1.1.1.1.8"></eq><list id="S3.E8.m1.1.1.1.1.2.3.cmml" xref="S3.E8.m1.1.1.1.1.2.2"><apply id="S3.E8.m1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.2">𝜇</ci><apply id="S3.E8.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.3"><ci id="S3.E8.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.3.1">:</ci><apply id="S3.E8.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.3.2"><plus id="S3.E8.m1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.3.2.1"></plus><apply id="S3.E8.m1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.1.1.1.3.2.2.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.3.2.2">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.1.1.1.3.2.2.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.3.2.2.2">𝑛</ci><apply id="S3.E8.m1.1.1.1.1.1.1.1.3.2.2.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.3.2.2.3"><times id="S3.E8.m1.1.1.1.1.1.1.1.3.2.2.3.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.3.2.2.3.1"></times><ci id="S3.E8.m1.1.1.1.1.1.1.1.3.2.2.3.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.3.2.2.3.2">𝑖</ci><ci id="S3.E8.m1.1.1.1.1.1.1.1.3.2.2.3.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.3.2.2.3.3">𝑛</ci></apply></apply><cn id="S3.E8.m1.1.1.1.1.1.1.1.3.2.3.cmml" type="integer" xref="S3.E8.m1.1.1.1.1.1.1.1.3.2.3">1</cn></apply><ci id="S3.E8.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.3.3">𝑁</ci></apply></apply><apply id="S3.E8.m1.1.1.1.1.2.2.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.2.2.2.1.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2.2">𝜎</ci><apply id="S3.E8.m1.1.1.1.1.2.2.2.3.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2.3"><ci id="S3.E8.m1.1.1.1.1.2.2.2.3.1.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2.3.1">:</ci><apply id="S3.E8.m1.1.1.1.1.2.2.2.3.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2.3.2"><plus id="S3.E8.m1.1.1.1.1.2.2.2.3.2.1.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2.3.2.1"></plus><apply id="S3.E8.m1.1.1.1.1.2.2.2.3.2.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2.3.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.2.2.2.3.2.2.1.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2.3.2.2">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.2.2.2.3.2.2.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2.3.2.2.2">𝑛</ci><apply id="S3.E8.m1.1.1.1.1.2.2.2.3.2.2.3.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2.3.2.2.3"><times id="S3.E8.m1.1.1.1.1.2.2.2.3.2.2.3.1.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2.3.2.2.3.1"></times><ci id="S3.E8.m1.1.1.1.1.2.2.2.3.2.2.3.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2.3.2.2.3.2">𝑖</ci><ci id="S3.E8.m1.1.1.1.1.2.2.2.3.2.2.3.3.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2.3.2.2.3.3">𝑛</ci></apply></apply><cn id="S3.E8.m1.1.1.1.1.2.2.2.3.2.3.cmml" type="integer" xref="S3.E8.m1.1.1.1.1.2.2.2.3.2.3">1</cn></apply><ci id="S3.E8.m1.1.1.1.1.2.2.2.3.3.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2.3.3">𝑁</ci></apply></apply></list><apply id="S3.E8.m1.1.1.1.1.7.cmml" xref="S3.E8.m1.1.1.1.1.7"><times id="S3.E8.m1.1.1.1.1.7.6.cmml" xref="S3.E8.m1.1.1.1.1.7.6"></times><apply id="S3.E8.m1.1.1.1.1.7.7.cmml" xref="S3.E8.m1.1.1.1.1.7.7"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.7.7.1.cmml" xref="S3.E8.m1.1.1.1.1.7.7">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.7.7.2.cmml" xref="S3.E8.m1.1.1.1.1.7.7.2">ℳ</ci><ci id="S3.E8.m1.1.1.1.1.7.7.3.cmml" xref="S3.E8.m1.1.1.1.1.7.7.3">italic-ϕ</ci></apply><vector id="S3.E8.m1.1.1.1.1.7.5.6.cmml" xref="S3.E8.m1.1.1.1.1.7.5.5"><apply id="S3.E8.m1.1.1.1.1.3.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.3.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.3.1.1.1">subscript</csymbol><apply id="S3.E8.m1.1.1.1.1.3.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.3.1.1.1.2"><ci id="S3.E8.m1.1.1.1.1.3.1.1.1.2.1.cmml" xref="S3.E8.m1.1.1.1.1.3.1.1.1.2.1">~</ci><ci id="S3.E8.m1.1.1.1.1.3.1.1.1.2.2.cmml" xref="S3.E8.m1.1.1.1.1.3.1.1.1.2.2">𝑢</ci></apply><apply id="S3.E8.m1.1.1.1.1.3.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.3.1.1.1.3"><ci id="S3.E8.m1.1.1.1.1.3.1.1.1.3.1.cmml" xref="S3.E8.m1.1.1.1.1.3.1.1.1.3.1">:</ci><apply id="S3.E8.m1.1.1.1.1.3.1.1.1.3.2.cmml" xref="S3.E8.m1.1.1.1.1.3.1.1.1.3.2"><plus id="S3.E8.m1.1.1.1.1.3.1.1.1.3.2.1.cmml" xref="S3.E8.m1.1.1.1.1.3.1.1.1.3.2.1"></plus><apply id="S3.E8.m1.1.1.1.1.3.1.1.1.3.2.2.cmml" xref="S3.E8.m1.1.1.1.1.3.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.1.1.1.3.2.2.1.cmml" xref="S3.E8.m1.1.1.1.1.3.1.1.1.3.2.2">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.3.1.1.1.3.2.2.2.cmml" xref="S3.E8.m1.1.1.1.1.3.1.1.1.3.2.2.2">𝑛</ci><apply id="S3.E8.m1.1.1.1.1.3.1.1.1.3.2.2.3.cmml" xref="S3.E8.m1.1.1.1.1.3.1.1.1.3.2.2.3"><times id="S3.E8.m1.1.1.1.1.3.1.1.1.3.2.2.3.1.cmml" xref="S3.E8.m1.1.1.1.1.3.1.1.1.3.2.2.3.1"></times><ci id="S3.E8.m1.1.1.1.1.3.1.1.1.3.2.2.3.2.cmml" xref="S3.E8.m1.1.1.1.1.3.1.1.1.3.2.2.3.2">𝑖</ci><ci id="S3.E8.m1.1.1.1.1.3.1.1.1.3.2.2.3.3.cmml" xref="S3.E8.m1.1.1.1.1.3.1.1.1.3.2.2.3.3">𝑛</ci></apply></apply><cn id="S3.E8.m1.1.1.1.1.3.1.1.1.3.2.3.cmml" type="integer" xref="S3.E8.m1.1.1.1.1.3.1.1.1.3.2.3">1</cn></apply><ci id="S3.E8.m1.1.1.1.1.3.1.1.1.3.3.cmml" xref="S3.E8.m1.1.1.1.1.3.1.1.1.3.3">𝑁</ci></apply></apply><apply id="S3.E8.m1.1.1.1.1.4.2.2.2.cmml" xref="S3.E8.m1.1.1.1.1.4.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.4.2.2.2.1.cmml" xref="S3.E8.m1.1.1.1.1.4.2.2.2">subscript</csymbol><apply id="S3.E8.m1.1.1.1.1.4.2.2.2.2.cmml" xref="S3.E8.m1.1.1.1.1.4.2.2.2.2"><ci id="S3.E8.m1.1.1.1.1.4.2.2.2.2.1.cmml" xref="S3.E8.m1.1.1.1.1.4.2.2.2.2.1">~</ci><ci id="S3.E8.m1.1.1.1.1.4.2.2.2.2.2.cmml" xref="S3.E8.m1.1.1.1.1.4.2.2.2.2.2">𝑢</ci></apply><apply id="S3.E8.m1.1.1.1.1.4.2.2.2.3.cmml" xref="S3.E8.m1.1.1.1.1.4.2.2.2.3"><ci id="S3.E8.m1.1.1.1.1.4.2.2.2.3.1.cmml" xref="S3.E8.m1.1.1.1.1.4.2.2.2.3.1">:</ci><cn id="S3.E8.m1.1.1.1.1.4.2.2.2.3.2.cmml" type="integer" xref="S3.E8.m1.1.1.1.1.4.2.2.2.3.2">1</cn><apply id="S3.E8.m1.1.1.1.1.4.2.2.2.3.3.cmml" xref="S3.E8.m1.1.1.1.1.4.2.2.2.3.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.4.2.2.2.3.3.1.cmml" xref="S3.E8.m1.1.1.1.1.4.2.2.2.3.3">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.4.2.2.2.3.3.2.cmml" xref="S3.E8.m1.1.1.1.1.4.2.2.2.3.3.2">𝑛</ci><apply id="S3.E8.m1.1.1.1.1.4.2.2.2.3.3.3.cmml" xref="S3.E8.m1.1.1.1.1.4.2.2.2.3.3.3"><times id="S3.E8.m1.1.1.1.1.4.2.2.2.3.3.3.1.cmml" xref="S3.E8.m1.1.1.1.1.4.2.2.2.3.3.3.1"></times><ci id="S3.E8.m1.1.1.1.1.4.2.2.2.3.3.3.2.cmml" xref="S3.E8.m1.1.1.1.1.4.2.2.2.3.3.3.2">𝑖</ci><ci id="S3.E8.m1.1.1.1.1.4.2.2.2.3.3.3.3.cmml" xref="S3.E8.m1.1.1.1.1.4.2.2.2.3.3.3.3">𝑛</ci></apply></apply></apply></apply><apply id="S3.E8.m1.1.1.1.1.5.3.3.3.cmml" xref="S3.E8.m1.1.1.1.1.5.3.3.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.5.3.3.3.1.cmml" xref="S3.E8.m1.1.1.1.1.5.3.3.3">subscript</csymbol><apply id="S3.E8.m1.1.1.1.1.5.3.3.3.2.cmml" xref="S3.E8.m1.1.1.1.1.5.3.3.3.2"><ci id="S3.E8.m1.1.1.1.1.5.3.3.3.2.1.cmml" xref="S3.E8.m1.1.1.1.1.5.3.3.3.2.1">~</ci><ci id="S3.E8.m1.1.1.1.1.5.3.3.3.2.2.cmml" xref="S3.E8.m1.1.1.1.1.5.3.3.3.2.2">𝑦</ci></apply><apply id="S3.E8.m1.1.1.1.1.5.3.3.3.3.cmml" xref="S3.E8.m1.1.1.1.1.5.3.3.3.3"><ci id="S3.E8.m1.1.1.1.1.5.3.3.3.3.1.cmml" xref="S3.E8.m1.1.1.1.1.5.3.3.3.3.1">:</ci><cn id="S3.E8.m1.1.1.1.1.5.3.3.3.3.2.cmml" type="integer" xref="S3.E8.m1.1.1.1.1.5.3.3.3.3.2">1</cn><apply id="S3.E8.m1.1.1.1.1.5.3.3.3.3.3.cmml" xref="S3.E8.m1.1.1.1.1.5.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.5.3.3.3.3.3.1.cmml" xref="S3.E8.m1.1.1.1.1.5.3.3.3.3.3">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.5.3.3.3.3.3.2.cmml" xref="S3.E8.m1.1.1.1.1.5.3.3.3.3.3.2">𝑛</ci><apply id="S3.E8.m1.1.1.1.1.5.3.3.3.3.3.3.cmml" xref="S3.E8.m1.1.1.1.1.5.3.3.3.3.3.3"><times id="S3.E8.m1.1.1.1.1.5.3.3.3.3.3.3.1.cmml" xref="S3.E8.m1.1.1.1.1.5.3.3.3.3.3.3.1"></times><ci id="S3.E8.m1.1.1.1.1.5.3.3.3.3.3.3.2.cmml" xref="S3.E8.m1.1.1.1.1.5.3.3.3.3.3.3.2">𝑖</ci><ci id="S3.E8.m1.1.1.1.1.5.3.3.3.3.3.3.3.cmml" xref="S3.E8.m1.1.1.1.1.5.3.3.3.3.3.3.3">𝑛</ci></apply></apply></apply></apply><apply id="S3.E8.m1.1.1.1.1.6.4.4.4.cmml" xref="S3.E8.m1.1.1.1.1.6.4.4.4"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.6.4.4.4.1.cmml" xref="S3.E8.m1.1.1.1.1.6.4.4.4">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.6.4.4.4.2.cmml" xref="S3.E8.m1.1.1.1.1.6.4.4.4.2">𝑢</ci><apply id="S3.E8.m1.1.1.1.1.6.4.4.4.3.cmml" xref="S3.E8.m1.1.1.1.1.6.4.4.4.3"><ci id="S3.E8.m1.1.1.1.1.6.4.4.4.3.1.cmml" xref="S3.E8.m1.1.1.1.1.6.4.4.4.3.1">:</ci><cn id="S3.E8.m1.1.1.1.1.6.4.4.4.3.2.cmml" type="integer" xref="S3.E8.m1.1.1.1.1.6.4.4.4.3.2">1</cn><ci id="S3.E8.m1.1.1.1.1.6.4.4.4.3.3.cmml" xref="S3.E8.m1.1.1.1.1.6.4.4.4.3.3">𝑚</ci></apply></apply><apply id="S3.E8.m1.1.1.1.1.7.5.5.5.cmml" xref="S3.E8.m1.1.1.1.1.7.5.5.5"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.7.5.5.5.1.cmml" xref="S3.E8.m1.1.1.1.1.7.5.5.5">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.7.5.5.5.2.cmml" xref="S3.E8.m1.1.1.1.1.7.5.5.5.2">𝑦</ci><apply id="S3.E8.m1.1.1.1.1.7.5.5.5.3.cmml" xref="S3.E8.m1.1.1.1.1.7.5.5.5.3"><ci id="S3.E8.m1.1.1.1.1.7.5.5.5.3.1.cmml" xref="S3.E8.m1.1.1.1.1.7.5.5.5.3.1">:</ci><cn id="S3.E8.m1.1.1.1.1.7.5.5.5.3.2.cmml" type="integer" xref="S3.E8.m1.1.1.1.1.7.5.5.5.3.2">1</cn><ci id="S3.E8.m1.1.1.1.1.7.5.5.5.3.3.cmml" xref="S3.E8.m1.1.1.1.1.7.5.5.5.3.3">𝑚</ci></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.1c">\mu_{n_{in}+1:N},\sigma_{n_{in}+1:N}=\\
\mathcal{M}_{\phi}(\tilde{u}_{n_{in}+1:N},\tilde{u}_{1:{n_{in}}},\tilde{y}_{1:%
{n_{in}}},u_{1:m},y_{1:m}).</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.1d">italic_μ start_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT + 1 : italic_N end_POSTSUBSCRIPT , italic_σ start_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT + 1 : italic_N end_POSTSUBSCRIPT = caligraphic_M start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( over~ start_ARG italic_u end_ARG start_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT + 1 : italic_N end_POSTSUBSCRIPT , over~ start_ARG italic_u end_ARG start_POSTSUBSCRIPT 1 : italic_n start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT end_POSTSUBSCRIPT , over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT 1 : italic_n start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT end_POSTSUBSCRIPT , italic_u start_POSTSUBSCRIPT 1 : italic_m end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 1 : italic_m end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.6">To this end, we modify the Transformer architecture by introducing a linear layer that processes the initial conditions, mapping each time step from <math alttext="\mathbb{R}^{n_{u}+n_{y}}" class="ltx_Math" display="inline" id="S3.SS2.p3.1.m1.1"><semantics id="S3.SS2.p3.1.m1.1a"><msup id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml"><mi id="S3.SS2.p3.1.m1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.2.cmml">ℝ</mi><mrow id="S3.SS2.p3.1.m1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.3.cmml"><msub id="S3.SS2.p3.1.m1.1.1.3.2" xref="S3.SS2.p3.1.m1.1.1.3.2.cmml"><mi id="S3.SS2.p3.1.m1.1.1.3.2.2" xref="S3.SS2.p3.1.m1.1.1.3.2.2.cmml">n</mi><mi id="S3.SS2.p3.1.m1.1.1.3.2.3" xref="S3.SS2.p3.1.m1.1.1.3.2.3.cmml">u</mi></msub><mo id="S3.SS2.p3.1.m1.1.1.3.1" xref="S3.SS2.p3.1.m1.1.1.3.1.cmml">+</mo><msub id="S3.SS2.p3.1.m1.1.1.3.3" xref="S3.SS2.p3.1.m1.1.1.3.3.cmml"><mi id="S3.SS2.p3.1.m1.1.1.3.3.2" xref="S3.SS2.p3.1.m1.1.1.3.3.2.cmml">n</mi><mi id="S3.SS2.p3.1.m1.1.1.3.3.3" xref="S3.SS2.p3.1.m1.1.1.3.3.3.cmml">y</mi></msub></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><apply id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">superscript</csymbol><ci id="S3.SS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.1.2">ℝ</ci><apply id="S3.SS2.p3.1.m1.1.1.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3"><plus id="S3.SS2.p3.1.m1.1.1.3.1.cmml" xref="S3.SS2.p3.1.m1.1.1.3.1"></plus><apply id="S3.SS2.p3.1.m1.1.1.3.2.cmml" xref="S3.SS2.p3.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.3.2.1.cmml" xref="S3.SS2.p3.1.m1.1.1.3.2">subscript</csymbol><ci id="S3.SS2.p3.1.m1.1.1.3.2.2.cmml" xref="S3.SS2.p3.1.m1.1.1.3.2.2">𝑛</ci><ci id="S3.SS2.p3.1.m1.1.1.3.2.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3.2.3">𝑢</ci></apply><apply id="S3.SS2.p3.1.m1.1.1.3.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.3.3.1.cmml" xref="S3.SS2.p3.1.m1.1.1.3.3">subscript</csymbol><ci id="S3.SS2.p3.1.m1.1.1.3.3.2.cmml" xref="S3.SS2.p3.1.m1.1.1.3.3.2">𝑛</ci><ci id="S3.SS2.p3.1.m1.1.1.3.3.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3.3.3">𝑦</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">\mathbb{R}^{n_{u}+n_{y}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.1.m1.1d">blackboard_R start_POSTSUPERSCRIPT italic_n start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT + italic_n start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> to <math alttext="\mathbb{R}^{{d_{\rm model}}}" class="ltx_Math" display="inline" id="S3.SS2.p3.2.m2.1"><semantics id="S3.SS2.p3.2.m2.1a"><msup id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml"><mi id="S3.SS2.p3.2.m2.1.1.2" xref="S3.SS2.p3.2.m2.1.1.2.cmml">ℝ</mi><msub id="S3.SS2.p3.2.m2.1.1.3" xref="S3.SS2.p3.2.m2.1.1.3.cmml"><mi id="S3.SS2.p3.2.m2.1.1.3.2" xref="S3.SS2.p3.2.m2.1.1.3.2.cmml">d</mi><mi id="S3.SS2.p3.2.m2.1.1.3.3" xref="S3.SS2.p3.2.m2.1.1.3.3.cmml">model</mi></msub></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><apply id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.1.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1">superscript</csymbol><ci id="S3.SS2.p3.2.m2.1.1.2.cmml" xref="S3.SS2.p3.2.m2.1.1.2">ℝ</ci><apply id="S3.SS2.p3.2.m2.1.1.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.1.1.3.1.cmml" xref="S3.SS2.p3.2.m2.1.1.3">subscript</csymbol><ci id="S3.SS2.p3.2.m2.1.1.3.2.cmml" xref="S3.SS2.p3.2.m2.1.1.3.2">𝑑</ci><ci id="S3.SS2.p3.2.m2.1.1.3.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3.3">model</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">\mathbb{R}^{{d_{\rm model}}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.2.m2.1d">blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT roman_model end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>. Similarly, the query input is mapped from <math alttext="\mathbb{R}^{n_{u}}" class="ltx_Math" display="inline" id="S3.SS2.p3.3.m3.1"><semantics id="S3.SS2.p3.3.m3.1a"><msup id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml"><mi id="S3.SS2.p3.3.m3.1.1.2" xref="S3.SS2.p3.3.m3.1.1.2.cmml">ℝ</mi><msub id="S3.SS2.p3.3.m3.1.1.3" xref="S3.SS2.p3.3.m3.1.1.3.cmml"><mi id="S3.SS2.p3.3.m3.1.1.3.2" xref="S3.SS2.p3.3.m3.1.1.3.2.cmml">n</mi><mi id="S3.SS2.p3.3.m3.1.1.3.3" xref="S3.SS2.p3.3.m3.1.1.3.3.cmml">u</mi></msub></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b"><apply id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.1.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1">superscript</csymbol><ci id="S3.SS2.p3.3.m3.1.1.2.cmml" xref="S3.SS2.p3.3.m3.1.1.2">ℝ</ci><apply id="S3.SS2.p3.3.m3.1.1.3.cmml" xref="S3.SS2.p3.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.1.1.3.1.cmml" xref="S3.SS2.p3.3.m3.1.1.3">subscript</csymbol><ci id="S3.SS2.p3.3.m3.1.1.3.2.cmml" xref="S3.SS2.p3.3.m3.1.1.3.2">𝑛</ci><ci id="S3.SS2.p3.3.m3.1.1.3.3.cmml" xref="S3.SS2.p3.3.m3.1.1.3.3">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">\mathbb{R}^{n_{u}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.3.m3.1d">blackboard_R start_POSTSUPERSCRIPT italic_n start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> to <math alttext="\mathbb{R}^{{d_{\rm model}}}" class="ltx_Math" display="inline" id="S3.SS2.p3.4.m4.1"><semantics id="S3.SS2.p3.4.m4.1a"><msup id="S3.SS2.p3.4.m4.1.1" xref="S3.SS2.p3.4.m4.1.1.cmml"><mi id="S3.SS2.p3.4.m4.1.1.2" xref="S3.SS2.p3.4.m4.1.1.2.cmml">ℝ</mi><msub id="S3.SS2.p3.4.m4.1.1.3" xref="S3.SS2.p3.4.m4.1.1.3.cmml"><mi id="S3.SS2.p3.4.m4.1.1.3.2" xref="S3.SS2.p3.4.m4.1.1.3.2.cmml">d</mi><mi id="S3.SS2.p3.4.m4.1.1.3.3" xref="S3.SS2.p3.4.m4.1.1.3.3.cmml">model</mi></msub></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.1b"><apply id="S3.SS2.p3.4.m4.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.1.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1">superscript</csymbol><ci id="S3.SS2.p3.4.m4.1.1.2.cmml" xref="S3.SS2.p3.4.m4.1.1.2">ℝ</ci><apply id="S3.SS2.p3.4.m4.1.1.3.cmml" xref="S3.SS2.p3.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.1.1.3.1.cmml" xref="S3.SS2.p3.4.m4.1.1.3">subscript</csymbol><ci id="S3.SS2.p3.4.m4.1.1.3.2.cmml" xref="S3.SS2.p3.4.m4.1.1.3.2">𝑑</ci><ci id="S3.SS2.p3.4.m4.1.1.3.3.cmml" xref="S3.SS2.p3.4.m4.1.1.3.3">model</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.1c">\mathbb{R}^{{d_{\rm model}}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.4.m4.1d">blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT roman_model end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> through a separate linear layer. The corresponding output sequences are then concatenated to form a single sequence of length <math alttext="N" class="ltx_Math" display="inline" id="S3.SS2.p3.5.m5.1"><semantics id="S3.SS2.p3.5.m5.1a"><mi id="S3.SS2.p3.5.m5.1.1" xref="S3.SS2.p3.5.m5.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m5.1b"><ci id="S3.SS2.p3.5.m5.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m5.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.5.m5.1d">italic_N</annotation></semantics></math>, where all elements have dimension <math alttext="{d_{\rm model}}" class="ltx_Math" display="inline" id="S3.SS2.p3.6.m6.1"><semantics id="S3.SS2.p3.6.m6.1a"><msub id="S3.SS2.p3.6.m6.1.1" xref="S3.SS2.p3.6.m6.1.1.cmml"><mi id="S3.SS2.p3.6.m6.1.1.2" xref="S3.SS2.p3.6.m6.1.1.2.cmml">d</mi><mi id="S3.SS2.p3.6.m6.1.1.3" xref="S3.SS2.p3.6.m6.1.1.3.cmml">model</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.6.m6.1b"><apply id="S3.SS2.p3.6.m6.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.6.m6.1.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.p3.6.m6.1.1.2.cmml" xref="S3.SS2.p3.6.m6.1.1.2">𝑑</ci><ci id="S3.SS2.p3.6.m6.1.1.3.cmml" xref="S3.SS2.p3.6.m6.1.1.3">model</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.6.m6.1c">{d_{\rm model}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.6.m6.1d">italic_d start_POSTSUBSCRIPT roman_model end_POSTSUBSCRIPT</annotation></semantics></math>. This sequence is combined with positional encoding before being passed into the decoder backbone of the Transformer, as shown in the layers before the decoder in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#S3.F1" title="Figure 1 ‣ 3 Advancing the Transformer Architecture ‣ Enhanced Transformer architecture for in-context learning of dynamical systems"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div class="ltx_theorem ltx_theorem_remark" id="Thmremark1">
<h6 class="ltx_title ltx_runin ltx_title_theorem"><span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="Thmremark1.1.1.1">Remark 1</span></span></h6>
<div class="ltx_para" id="Thmremark1.p1">
<p class="ltx_p" id="Thmremark1.p1.3"><span class="ltx_text ltx_font_italic" id="Thmremark1.p1.3.3">The length <math alttext="m" class="ltx_Math" display="inline" id="Thmremark1.p1.1.1.m1.1"><semantics id="Thmremark1.p1.1.1.m1.1a"><mi id="Thmremark1.p1.1.1.m1.1.1" xref="Thmremark1.p1.1.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="Thmremark1.p1.1.1.m1.1b"><ci id="Thmremark1.p1.1.1.m1.1.1.cmml" xref="Thmremark1.p1.1.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmremark1.p1.1.1.m1.1c">m</annotation><annotation encoding="application/x-llamapun" id="Thmremark1.p1.1.1.m1.1d">italic_m</annotation></semantics></math> of the input/output context sequence should be sufficiently large to characterize the dynamics of the system. On the other hand, the number <math alttext="n_{in}" class="ltx_Math" display="inline" id="Thmremark1.p1.2.2.m2.1"><semantics id="Thmremark1.p1.2.2.m2.1a"><msub id="Thmremark1.p1.2.2.m2.1.1" xref="Thmremark1.p1.2.2.m2.1.1.cmml"><mi id="Thmremark1.p1.2.2.m2.1.1.2" xref="Thmremark1.p1.2.2.m2.1.1.2.cmml">n</mi><mrow id="Thmremark1.p1.2.2.m2.1.1.3" xref="Thmremark1.p1.2.2.m2.1.1.3.cmml"><mi id="Thmremark1.p1.2.2.m2.1.1.3.2" xref="Thmremark1.p1.2.2.m2.1.1.3.2.cmml">i</mi><mo id="Thmremark1.p1.2.2.m2.1.1.3.1" xref="Thmremark1.p1.2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="Thmremark1.p1.2.2.m2.1.1.3.3" xref="Thmremark1.p1.2.2.m2.1.1.3.3.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Thmremark1.p1.2.2.m2.1b"><apply id="Thmremark1.p1.2.2.m2.1.1.cmml" xref="Thmremark1.p1.2.2.m2.1.1"><csymbol cd="ambiguous" id="Thmremark1.p1.2.2.m2.1.1.1.cmml" xref="Thmremark1.p1.2.2.m2.1.1">subscript</csymbol><ci id="Thmremark1.p1.2.2.m2.1.1.2.cmml" xref="Thmremark1.p1.2.2.m2.1.1.2">𝑛</ci><apply id="Thmremark1.p1.2.2.m2.1.1.3.cmml" xref="Thmremark1.p1.2.2.m2.1.1.3"><times id="Thmremark1.p1.2.2.m2.1.1.3.1.cmml" xref="Thmremark1.p1.2.2.m2.1.1.3.1"></times><ci id="Thmremark1.p1.2.2.m2.1.1.3.2.cmml" xref="Thmremark1.p1.2.2.m2.1.1.3.2">𝑖</ci><ci id="Thmremark1.p1.2.2.m2.1.1.3.3.cmml" xref="Thmremark1.p1.2.2.m2.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmremark1.p1.2.2.m2.1c">n_{in}</annotation><annotation encoding="application/x-llamapun" id="Thmremark1.p1.2.2.m2.1d">italic_n start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT</annotation></semantics></math> of input/output samples used as initial conditions is typically small, of the order of magnitude of the number of dynamical states of the system.  <math alttext="\blacksquare" class="ltx_Math" display="inline" id="Thmremark1.p1.3.3.m3.1"><semantics id="Thmremark1.p1.3.3.m3.1a"><mi id="Thmremark1.p1.3.3.m3.1.1" mathvariant="normal" xref="Thmremark1.p1.3.3.m3.1.1.cmml">■</mi><annotation-xml encoding="MathML-Content" id="Thmremark1.p1.3.3.m3.1b"><ci id="Thmremark1.p1.3.3.m3.1.1.cmml" xref="Thmremark1.p1.3.3.m3.1.1">■</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmremark1.p1.3.3.m3.1c">\blacksquare</annotation><annotation encoding="application/x-llamapun" id="Thmremark1.p1.3.3.m3.1d">■</annotation></semantics></math></span></p>
</div>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Patching for long context sequences</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">In order to handle Limitation L3, and thus considering long context sequences, we adopt a patching approach tailored to the meta-learning problem introduced in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#S2" title="2 Problem description ‣ Enhanced Transformer architecture for in-context learning of dynamical systems"><span class="ltx_text ltx_ref_tag">2</span></a>, and described in the following paragraphs.</p>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.8">The input-output context sequence <math alttext="(u_{1:m},y_{1:m})" class="ltx_Math" display="inline" id="S3.SS3.p2.1.m1.2"><semantics id="S3.SS3.p2.1.m1.2a"><mrow id="S3.SS3.p2.1.m1.2.2.2" xref="S3.SS3.p2.1.m1.2.2.3.cmml"><mo id="S3.SS3.p2.1.m1.2.2.2.3" stretchy="false" xref="S3.SS3.p2.1.m1.2.2.3.cmml">(</mo><msub id="S3.SS3.p2.1.m1.1.1.1.1" xref="S3.SS3.p2.1.m1.1.1.1.1.cmml"><mi id="S3.SS3.p2.1.m1.1.1.1.1.2" xref="S3.SS3.p2.1.m1.1.1.1.1.2.cmml">u</mi><mrow id="S3.SS3.p2.1.m1.1.1.1.1.3" xref="S3.SS3.p2.1.m1.1.1.1.1.3.cmml"><mn id="S3.SS3.p2.1.m1.1.1.1.1.3.2" xref="S3.SS3.p2.1.m1.1.1.1.1.3.2.cmml">1</mn><mo id="S3.SS3.p2.1.m1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS3.p2.1.m1.1.1.1.1.3.1.cmml">:</mo><mi id="S3.SS3.p2.1.m1.1.1.1.1.3.3" xref="S3.SS3.p2.1.m1.1.1.1.1.3.3.cmml">m</mi></mrow></msub><mo id="S3.SS3.p2.1.m1.2.2.2.4" xref="S3.SS3.p2.1.m1.2.2.3.cmml">,</mo><msub id="S3.SS3.p2.1.m1.2.2.2.2" xref="S3.SS3.p2.1.m1.2.2.2.2.cmml"><mi id="S3.SS3.p2.1.m1.2.2.2.2.2" xref="S3.SS3.p2.1.m1.2.2.2.2.2.cmml">y</mi><mrow id="S3.SS3.p2.1.m1.2.2.2.2.3" xref="S3.SS3.p2.1.m1.2.2.2.2.3.cmml"><mn id="S3.SS3.p2.1.m1.2.2.2.2.3.2" xref="S3.SS3.p2.1.m1.2.2.2.2.3.2.cmml">1</mn><mo id="S3.SS3.p2.1.m1.2.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS3.p2.1.m1.2.2.2.2.3.1.cmml">:</mo><mi id="S3.SS3.p2.1.m1.2.2.2.2.3.3" xref="S3.SS3.p2.1.m1.2.2.2.2.3.3.cmml">m</mi></mrow></msub><mo id="S3.SS3.p2.1.m1.2.2.2.5" stretchy="false" xref="S3.SS3.p2.1.m1.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.2b"><interval closure="open" id="S3.SS3.p2.1.m1.2.2.3.cmml" xref="S3.SS3.p2.1.m1.2.2.2"><apply id="S3.SS3.p2.1.m1.1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p2.1.m1.1.1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1.1.1.2">𝑢</ci><apply id="S3.SS3.p2.1.m1.1.1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.1.1.1.1.3"><ci id="S3.SS3.p2.1.m1.1.1.1.1.3.1.cmml" xref="S3.SS3.p2.1.m1.1.1.1.1.3.1">:</ci><cn id="S3.SS3.p2.1.m1.1.1.1.1.3.2.cmml" type="integer" xref="S3.SS3.p2.1.m1.1.1.1.1.3.2">1</cn><ci id="S3.SS3.p2.1.m1.1.1.1.1.3.3.cmml" xref="S3.SS3.p2.1.m1.1.1.1.1.3.3">𝑚</ci></apply></apply><apply id="S3.SS3.p2.1.m1.2.2.2.2.cmml" xref="S3.SS3.p2.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.2.2.2.2.1.cmml" xref="S3.SS3.p2.1.m1.2.2.2.2">subscript</csymbol><ci id="S3.SS3.p2.1.m1.2.2.2.2.2.cmml" xref="S3.SS3.p2.1.m1.2.2.2.2.2">𝑦</ci><apply id="S3.SS3.p2.1.m1.2.2.2.2.3.cmml" xref="S3.SS3.p2.1.m1.2.2.2.2.3"><ci id="S3.SS3.p2.1.m1.2.2.2.2.3.1.cmml" xref="S3.SS3.p2.1.m1.2.2.2.2.3.1">:</ci><cn id="S3.SS3.p2.1.m1.2.2.2.2.3.2.cmml" type="integer" xref="S3.SS3.p2.1.m1.2.2.2.2.3.2">1</cn><ci id="S3.SS3.p2.1.m1.2.2.2.2.3.3.cmml" xref="S3.SS3.p2.1.m1.2.2.2.2.3.3">𝑚</ci></apply></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.2c">(u_{1:m},y_{1:m})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.1.m1.2d">( italic_u start_POSTSUBSCRIPT 1 : italic_m end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 1 : italic_m end_POSTSUBSCRIPT )</annotation></semantics></math> is divided into <math alttext="M" class="ltx_Math" display="inline" id="S3.SS3.p2.2.m2.1"><semantics id="S3.SS3.p2.2.m2.1a"><mi id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><ci id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.2.m2.1d">italic_M</annotation></semantics></math> non-overlapping patches<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>For simplicity of exposition, we assume that <math alttext="m" class="ltx_Math" display="inline" id="footnote1.m1.1"><semantics id="footnote1.m1.1b"><mi id="footnote1.m1.1.1" xref="footnote1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="footnote1.m1.1c"><ci id="footnote1.m1.1.1.cmml" xref="footnote1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="footnote1.m1.1d">m</annotation><annotation encoding="application/x-llamapun" id="footnote1.m1.1e">italic_m</annotation></semantics></math> is multiple of <math alttext="M" class="ltx_Math" display="inline" id="footnote1.m2.1"><semantics id="footnote1.m2.1b"><mi id="footnote1.m2.1.1" xref="footnote1.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="footnote1.m2.1c"><ci id="footnote1.m2.1.1.cmml" xref="footnote1.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="footnote1.m2.1d">M</annotation><annotation encoding="application/x-llamapun" id="footnote1.m2.1e">italic_M</annotation></semantics></math>.</span></span></span>, each of length <math alttext="L=\frac{m}{M}" class="ltx_Math" display="inline" id="S3.SS3.p2.3.m3.1"><semantics id="S3.SS3.p2.3.m3.1a"><mrow id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml"><mi id="S3.SS3.p2.3.m3.1.1.2" xref="S3.SS3.p2.3.m3.1.1.2.cmml">L</mi><mo id="S3.SS3.p2.3.m3.1.1.1" xref="S3.SS3.p2.3.m3.1.1.1.cmml">=</mo><mfrac id="S3.SS3.p2.3.m3.1.1.3" xref="S3.SS3.p2.3.m3.1.1.3.cmml"><mi id="S3.SS3.p2.3.m3.1.1.3.2" xref="S3.SS3.p2.3.m3.1.1.3.2.cmml">m</mi><mi id="S3.SS3.p2.3.m3.1.1.3.3" xref="S3.SS3.p2.3.m3.1.1.3.3.cmml">M</mi></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><apply id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1"><eq id="S3.SS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1.1"></eq><ci id="S3.SS3.p2.3.m3.1.1.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2">𝐿</ci><apply id="S3.SS3.p2.3.m3.1.1.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3"><divide id="S3.SS3.p2.3.m3.1.1.3.1.cmml" xref="S3.SS3.p2.3.m3.1.1.3"></divide><ci id="S3.SS3.p2.3.m3.1.1.3.2.cmml" xref="S3.SS3.p2.3.m3.1.1.3.2">𝑚</ci><ci id="S3.SS3.p2.3.m3.1.1.3.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3.3">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">L=\frac{m}{M}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.3.m3.1d">italic_L = divide start_ARG italic_m end_ARG start_ARG italic_M end_ARG</annotation></semantics></math> and dimension <math alttext="n_{u}+n_{y}" class="ltx_Math" display="inline" id="S3.SS3.p2.4.m4.1"><semantics id="S3.SS3.p2.4.m4.1a"><mrow id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml"><msub id="S3.SS3.p2.4.m4.1.1.2" xref="S3.SS3.p2.4.m4.1.1.2.cmml"><mi id="S3.SS3.p2.4.m4.1.1.2.2" xref="S3.SS3.p2.4.m4.1.1.2.2.cmml">n</mi><mi id="S3.SS3.p2.4.m4.1.1.2.3" xref="S3.SS3.p2.4.m4.1.1.2.3.cmml">u</mi></msub><mo id="S3.SS3.p2.4.m4.1.1.1" xref="S3.SS3.p2.4.m4.1.1.1.cmml">+</mo><msub id="S3.SS3.p2.4.m4.1.1.3" xref="S3.SS3.p2.4.m4.1.1.3.cmml"><mi id="S3.SS3.p2.4.m4.1.1.3.2" xref="S3.SS3.p2.4.m4.1.1.3.2.cmml">n</mi><mi id="S3.SS3.p2.4.m4.1.1.3.3" xref="S3.SS3.p2.4.m4.1.1.3.3.cmml">y</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><apply id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1"><plus id="S3.SS3.p2.4.m4.1.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1.1"></plus><apply id="S3.SS3.p2.4.m4.1.1.2.cmml" xref="S3.SS3.p2.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.1.1.2.1.cmml" xref="S3.SS3.p2.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS3.p2.4.m4.1.1.2.2.cmml" xref="S3.SS3.p2.4.m4.1.1.2.2">𝑛</ci><ci id="S3.SS3.p2.4.m4.1.1.2.3.cmml" xref="S3.SS3.p2.4.m4.1.1.2.3">𝑢</ci></apply><apply id="S3.SS3.p2.4.m4.1.1.3.cmml" xref="S3.SS3.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.1.1.3.1.cmml" xref="S3.SS3.p2.4.m4.1.1.3">subscript</csymbol><ci id="S3.SS3.p2.4.m4.1.1.3.2.cmml" xref="S3.SS3.p2.4.m4.1.1.3.2">𝑛</ci><ci id="S3.SS3.p2.4.m4.1.1.3.3.cmml" xref="S3.SS3.p2.4.m4.1.1.3.3">𝑦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">n_{u}+n_{y}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.4.m4.1d">italic_n start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT + italic_n start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT</annotation></semantics></math>. The patches are then processed by an RNN which maps each of them into a single vector of dimension <math alttext="{d_{\rm model}}" class="ltx_Math" display="inline" id="S3.SS3.p2.5.m5.1"><semantics id="S3.SS3.p2.5.m5.1a"><msub id="S3.SS3.p2.5.m5.1.1" xref="S3.SS3.p2.5.m5.1.1.cmml"><mi id="S3.SS3.p2.5.m5.1.1.2" xref="S3.SS3.p2.5.m5.1.1.2.cmml">d</mi><mi id="S3.SS3.p2.5.m5.1.1.3" xref="S3.SS3.p2.5.m5.1.1.3.cmml">model</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.1b"><apply id="S3.SS3.p2.5.m5.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.1.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.p2.5.m5.1.1.2.cmml" xref="S3.SS3.p2.5.m5.1.1.2">𝑑</ci><ci id="S3.SS3.p2.5.m5.1.1.3.cmml" xref="S3.SS3.p2.5.m5.1.1.3">model</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.1c">{d_{\rm model}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.5.m5.1d">italic_d start_POSTSUBSCRIPT roman_model end_POSTSUBSCRIPT</annotation></semantics></math>. The resulting <em class="ltx_emph ltx_font_italic" id="S3.SS3.p2.8.1">patch embedding</em> sequence <math alttext="p_{1:M}" class="ltx_Math" display="inline" id="S3.SS3.p2.6.m6.1"><semantics id="S3.SS3.p2.6.m6.1a"><msub id="S3.SS3.p2.6.m6.1.1" xref="S3.SS3.p2.6.m6.1.1.cmml"><mi id="S3.SS3.p2.6.m6.1.1.2" xref="S3.SS3.p2.6.m6.1.1.2.cmml">p</mi><mrow id="S3.SS3.p2.6.m6.1.1.3" xref="S3.SS3.p2.6.m6.1.1.3.cmml"><mn id="S3.SS3.p2.6.m6.1.1.3.2" xref="S3.SS3.p2.6.m6.1.1.3.2.cmml">1</mn><mo id="S3.SS3.p2.6.m6.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS3.p2.6.m6.1.1.3.1.cmml">:</mo><mi id="S3.SS3.p2.6.m6.1.1.3.3" xref="S3.SS3.p2.6.m6.1.1.3.3.cmml">M</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m6.1b"><apply id="S3.SS3.p2.6.m6.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m6.1.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1">subscript</csymbol><ci id="S3.SS3.p2.6.m6.1.1.2.cmml" xref="S3.SS3.p2.6.m6.1.1.2">𝑝</ci><apply id="S3.SS3.p2.6.m6.1.1.3.cmml" xref="S3.SS3.p2.6.m6.1.1.3"><ci id="S3.SS3.p2.6.m6.1.1.3.1.cmml" xref="S3.SS3.p2.6.m6.1.1.3.1">:</ci><cn id="S3.SS3.p2.6.m6.1.1.3.2.cmml" type="integer" xref="S3.SS3.p2.6.m6.1.1.3.2">1</cn><ci id="S3.SS3.p2.6.m6.1.1.3.3.cmml" xref="S3.SS3.p2.6.m6.1.1.3.3">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m6.1c">p_{1:M}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.6.m6.1d">italic_p start_POSTSUBSCRIPT 1 : italic_M end_POSTSUBSCRIPT</annotation></semantics></math> is then combined with position encoding to account for the temporal order and then fed as input to the encoder’s backbone (see Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#S3.F2" title="Figure 2 ‣ 3.3 Patching for long context sequences ‣ 3 Advancing the Transformer Architecture ‣ Enhanced Transformer architecture for in-context learning of dynamical systems"><span class="ltx_text ltx_ref_tag">2</span></a>).
The modifications of the architecture with respect to <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#bib.bib11" title="">11</a>]</cite> corresponds to the bottom-left blocks in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#S3.F1" title="Figure 1 ‣ 3 Advancing the Transformer Architecture ‣ Enhanced Transformer architecture for in-context learning of dynamical systems"><span class="ltx_text ltx_ref_tag">1</span></a>. Thus, the length of the sequence processed by the multi-head attention mechanism processes is reduced by a factor <math alttext="L" class="ltx_Math" display="inline" id="S3.SS3.p2.7.m7.1"><semantics id="S3.SS3.p2.7.m7.1a"><mi id="S3.SS3.p2.7.m7.1.1" xref="S3.SS3.p2.7.m7.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.7.m7.1b"><ci id="S3.SS3.p2.7.m7.1.1.cmml" xref="S3.SS3.p2.7.m7.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.7.m7.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.7.m7.1d">italic_L</annotation></semantics></math>, significantly decreasing the computational burden by a factor of <math alttext="O(L^{2})" class="ltx_Math" display="inline" id="S3.SS3.p2.8.m8.1"><semantics id="S3.SS3.p2.8.m8.1a"><mrow id="S3.SS3.p2.8.m8.1.1" xref="S3.SS3.p2.8.m8.1.1.cmml"><mi id="S3.SS3.p2.8.m8.1.1.3" xref="S3.SS3.p2.8.m8.1.1.3.cmml">O</mi><mo id="S3.SS3.p2.8.m8.1.1.2" xref="S3.SS3.p2.8.m8.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.p2.8.m8.1.1.1.1" xref="S3.SS3.p2.8.m8.1.1.1.1.1.cmml"><mo id="S3.SS3.p2.8.m8.1.1.1.1.2" stretchy="false" xref="S3.SS3.p2.8.m8.1.1.1.1.1.cmml">(</mo><msup id="S3.SS3.p2.8.m8.1.1.1.1.1" xref="S3.SS3.p2.8.m8.1.1.1.1.1.cmml"><mi id="S3.SS3.p2.8.m8.1.1.1.1.1.2" xref="S3.SS3.p2.8.m8.1.1.1.1.1.2.cmml">L</mi><mn id="S3.SS3.p2.8.m8.1.1.1.1.1.3" xref="S3.SS3.p2.8.m8.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S3.SS3.p2.8.m8.1.1.1.1.3" stretchy="false" xref="S3.SS3.p2.8.m8.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.8.m8.1b"><apply id="S3.SS3.p2.8.m8.1.1.cmml" xref="S3.SS3.p2.8.m8.1.1"><times id="S3.SS3.p2.8.m8.1.1.2.cmml" xref="S3.SS3.p2.8.m8.1.1.2"></times><ci id="S3.SS3.p2.8.m8.1.1.3.cmml" xref="S3.SS3.p2.8.m8.1.1.3">𝑂</ci><apply id="S3.SS3.p2.8.m8.1.1.1.1.1.cmml" xref="S3.SS3.p2.8.m8.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.8.m8.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.8.m8.1.1.1.1">superscript</csymbol><ci id="S3.SS3.p2.8.m8.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.8.m8.1.1.1.1.1.2">𝐿</ci><cn id="S3.SS3.p2.8.m8.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS3.p2.8.m8.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.8.m8.1c">O(L^{2})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.8.m8.1d">italic_O ( italic_L start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math>.</p>
</div>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="204" id="S3.F2.g1" src="extracted/5901228/patch_sequence.png" width="479"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F2.6.3.1" style="font-size:90%;">Figure 2</span>: </span><span class="ltx_text" id="S3.F2.4.2" style="font-size:90%;">Visual representation of the implemented patching approach. For the sake of visualization, a single-input (<math alttext="n_{u}=1" class="ltx_Math" display="inline" id="S3.F2.3.1.m1.1"><semantics id="S3.F2.3.1.m1.1b"><mrow id="S3.F2.3.1.m1.1.1" xref="S3.F2.3.1.m1.1.1.cmml"><msub id="S3.F2.3.1.m1.1.1.2" xref="S3.F2.3.1.m1.1.1.2.cmml"><mi id="S3.F2.3.1.m1.1.1.2.2" xref="S3.F2.3.1.m1.1.1.2.2.cmml">n</mi><mi id="S3.F2.3.1.m1.1.1.2.3" xref="S3.F2.3.1.m1.1.1.2.3.cmml">u</mi></msub><mo id="S3.F2.3.1.m1.1.1.1" xref="S3.F2.3.1.m1.1.1.1.cmml">=</mo><mn id="S3.F2.3.1.m1.1.1.3" xref="S3.F2.3.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.3.1.m1.1c"><apply id="S3.F2.3.1.m1.1.1.cmml" xref="S3.F2.3.1.m1.1.1"><eq id="S3.F2.3.1.m1.1.1.1.cmml" xref="S3.F2.3.1.m1.1.1.1"></eq><apply id="S3.F2.3.1.m1.1.1.2.cmml" xref="S3.F2.3.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.F2.3.1.m1.1.1.2.1.cmml" xref="S3.F2.3.1.m1.1.1.2">subscript</csymbol><ci id="S3.F2.3.1.m1.1.1.2.2.cmml" xref="S3.F2.3.1.m1.1.1.2.2">𝑛</ci><ci id="S3.F2.3.1.m1.1.1.2.3.cmml" xref="S3.F2.3.1.m1.1.1.2.3">𝑢</ci></apply><cn id="S3.F2.3.1.m1.1.1.3.cmml" type="integer" xref="S3.F2.3.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.3.1.m1.1d">n_{u}=1</annotation><annotation encoding="application/x-llamapun" id="S3.F2.3.1.m1.1e">italic_n start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT = 1</annotation></semantics></math>) single-output (<math alttext="n_{y}=1" class="ltx_Math" display="inline" id="S3.F2.4.2.m2.1"><semantics id="S3.F2.4.2.m2.1b"><mrow id="S3.F2.4.2.m2.1.1" xref="S3.F2.4.2.m2.1.1.cmml"><msub id="S3.F2.4.2.m2.1.1.2" xref="S3.F2.4.2.m2.1.1.2.cmml"><mi id="S3.F2.4.2.m2.1.1.2.2" xref="S3.F2.4.2.m2.1.1.2.2.cmml">n</mi><mi id="S3.F2.4.2.m2.1.1.2.3" xref="S3.F2.4.2.m2.1.1.2.3.cmml">y</mi></msub><mo id="S3.F2.4.2.m2.1.1.1" xref="S3.F2.4.2.m2.1.1.1.cmml">=</mo><mn id="S3.F2.4.2.m2.1.1.3" xref="S3.F2.4.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.4.2.m2.1c"><apply id="S3.F2.4.2.m2.1.1.cmml" xref="S3.F2.4.2.m2.1.1"><eq id="S3.F2.4.2.m2.1.1.1.cmml" xref="S3.F2.4.2.m2.1.1.1"></eq><apply id="S3.F2.4.2.m2.1.1.2.cmml" xref="S3.F2.4.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.F2.4.2.m2.1.1.2.1.cmml" xref="S3.F2.4.2.m2.1.1.2">subscript</csymbol><ci id="S3.F2.4.2.m2.1.1.2.2.cmml" xref="S3.F2.4.2.m2.1.1.2.2">𝑛</ci><ci id="S3.F2.4.2.m2.1.1.2.3.cmml" xref="S3.F2.4.2.m2.1.1.2.3">𝑦</ci></apply><cn id="S3.F2.4.2.m2.1.1.3.cmml" type="integer" xref="S3.F2.4.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.4.2.m2.1d">n_{y}=1</annotation><annotation encoding="application/x-llamapun" id="S3.F2.4.2.m2.1e">italic_n start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT = 1</annotation></semantics></math>) system is considered. Therefore, the context consists of an input (blu) and output (red) sequence.</span></figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Numerical Example</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.2">The presented meta-model architecture is assessed for in-context learning of dynamical systems belonging to the Wiener-Hammerstein (WH) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#bib.bib22" title="">22</a>]</cite> class.
For meta-model learning, the negative log-likelihood (<a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#S3.E5" title="In 3.1 Learning Probability Distributions ‣ 3 Advancing the Transformer Architecture ‣ Enhanced Transformer architecture for in-context learning of dynamical systems"><span class="ltx_text ltx_ref_tag">5</span></a>) is minimized over 1 million iterations of the AdamW algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#bib.bib23" title="">23</a>]</cite>, with minibatch size <math alttext="b=32" class="ltx_Math" display="inline" id="S4.p1.1.m1.1"><semantics id="S4.p1.1.m1.1a"><mrow id="S4.p1.1.m1.1.1" xref="S4.p1.1.m1.1.1.cmml"><mi id="S4.p1.1.m1.1.1.2" xref="S4.p1.1.m1.1.1.2.cmml">b</mi><mo id="S4.p1.1.m1.1.1.1" xref="S4.p1.1.m1.1.1.1.cmml">=</mo><mn id="S4.p1.1.m1.1.1.3" xref="S4.p1.1.m1.1.1.3.cmml">32</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.1.m1.1b"><apply id="S4.p1.1.m1.1.1.cmml" xref="S4.p1.1.m1.1.1"><eq id="S4.p1.1.m1.1.1.1.cmml" xref="S4.p1.1.m1.1.1.1"></eq><ci id="S4.p1.1.m1.1.1.2.cmml" xref="S4.p1.1.m1.1.1.2">𝑏</ci><cn id="S4.p1.1.m1.1.1.3.cmml" type="integer" xref="S4.p1.1.m1.1.1.3">32</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.1.m1.1c">b=32</annotation><annotation encoding="application/x-llamapun" id="S4.p1.1.m1.1d">italic_b = 32</annotation></semantics></math>. Training is repeated for different values of the context length <math alttext="m\in\{400,800,16000,40000\}" class="ltx_Math" display="inline" id="S4.p1.2.m2.4"><semantics id="S4.p1.2.m2.4a"><mrow id="S4.p1.2.m2.4.5" xref="S4.p1.2.m2.4.5.cmml"><mi id="S4.p1.2.m2.4.5.2" xref="S4.p1.2.m2.4.5.2.cmml">m</mi><mo id="S4.p1.2.m2.4.5.1" xref="S4.p1.2.m2.4.5.1.cmml">∈</mo><mrow id="S4.p1.2.m2.4.5.3.2" xref="S4.p1.2.m2.4.5.3.1.cmml"><mo id="S4.p1.2.m2.4.5.3.2.1" stretchy="false" xref="S4.p1.2.m2.4.5.3.1.cmml">{</mo><mn id="S4.p1.2.m2.1.1" xref="S4.p1.2.m2.1.1.cmml">400</mn><mo id="S4.p1.2.m2.4.5.3.2.2" xref="S4.p1.2.m2.4.5.3.1.cmml">,</mo><mn id="S4.p1.2.m2.2.2" xref="S4.p1.2.m2.2.2.cmml">800</mn><mo id="S4.p1.2.m2.4.5.3.2.3" xref="S4.p1.2.m2.4.5.3.1.cmml">,</mo><mn id="S4.p1.2.m2.3.3" xref="S4.p1.2.m2.3.3.cmml">16000</mn><mo id="S4.p1.2.m2.4.5.3.2.4" xref="S4.p1.2.m2.4.5.3.1.cmml">,</mo><mn id="S4.p1.2.m2.4.4" xref="S4.p1.2.m2.4.4.cmml">40000</mn><mo id="S4.p1.2.m2.4.5.3.2.5" stretchy="false" xref="S4.p1.2.m2.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.2.m2.4b"><apply id="S4.p1.2.m2.4.5.cmml" xref="S4.p1.2.m2.4.5"><in id="S4.p1.2.m2.4.5.1.cmml" xref="S4.p1.2.m2.4.5.1"></in><ci id="S4.p1.2.m2.4.5.2.cmml" xref="S4.p1.2.m2.4.5.2">𝑚</ci><set id="S4.p1.2.m2.4.5.3.1.cmml" xref="S4.p1.2.m2.4.5.3.2"><cn id="S4.p1.2.m2.1.1.cmml" type="integer" xref="S4.p1.2.m2.1.1">400</cn><cn id="S4.p1.2.m2.2.2.cmml" type="integer" xref="S4.p1.2.m2.2.2">800</cn><cn id="S4.p1.2.m2.3.3.cmml" type="integer" xref="S4.p1.2.m2.3.3">16000</cn><cn id="S4.p1.2.m2.4.4.cmml" type="integer" xref="S4.p1.2.m2.4.4">40000</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.2.m2.4c">m\in\{400,800,16000,40000\}</annotation><annotation encoding="application/x-llamapun" id="S4.p1.2.m2.4d">italic_m ∈ { 400 , 800 , 16000 , 40000 }</annotation></semantics></math>.
All computations are performed on a server equipped with an Nvidia RTX 3090 GPU. For reproducibility of the results, all codes made are available in the GitHub repository <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#bib.bib24" title="">24</a>]</cite>.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>System Class and Dataset Distribution</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.11">We generate synthetic datasets from random stable WH systems having structure <math alttext="G_{1}\!-\!F\!-\!G_{2}" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><mrow id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml"><msub id="S4.SS1.p1.1.m1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.2.cmml"><mi id="S4.SS1.p1.1.m1.1.1.2.2" xref="S4.SS1.p1.1.m1.1.1.2.2.cmml">G</mi><mn id="S4.SS1.p1.1.m1.1.1.2.3" xref="S4.SS1.p1.1.m1.1.1.2.3.cmml">1</mn></msub><mo id="S4.SS1.p1.1.m1.1.1.1" lspace="0.052em" rspace="0.052em" xref="S4.SS1.p1.1.m1.1.1.1.cmml">−</mo><mi id="S4.SS1.p1.1.m1.1.1.3" xref="S4.SS1.p1.1.m1.1.1.3.cmml">F</mi><mo id="S4.SS1.p1.1.m1.1.1.1a" lspace="0.052em" rspace="0.052em" xref="S4.SS1.p1.1.m1.1.1.1.cmml">−</mo><msub id="S4.SS1.p1.1.m1.1.1.4" xref="S4.SS1.p1.1.m1.1.1.4.cmml"><mi id="S4.SS1.p1.1.m1.1.1.4.2" xref="S4.SS1.p1.1.m1.1.1.4.2.cmml">G</mi><mn id="S4.SS1.p1.1.m1.1.1.4.3" xref="S4.SS1.p1.1.m1.1.1.4.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"><minus id="S4.SS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1"></minus><apply id="S4.SS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.1.2.1.cmml" xref="S4.SS1.p1.1.m1.1.1.2">subscript</csymbol><ci id="S4.SS1.p1.1.m1.1.1.2.2.cmml" xref="S4.SS1.p1.1.m1.1.1.2.2">𝐺</ci><cn id="S4.SS1.p1.1.m1.1.1.2.3.cmml" type="integer" xref="S4.SS1.p1.1.m1.1.1.2.3">1</cn></apply><ci id="S4.SS1.p1.1.m1.1.1.3.cmml" xref="S4.SS1.p1.1.m1.1.1.3">𝐹</ci><apply id="S4.SS1.p1.1.m1.1.1.4.cmml" xref="S4.SS1.p1.1.m1.1.1.4"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.1.4.1.cmml" xref="S4.SS1.p1.1.m1.1.1.4">subscript</csymbol><ci id="S4.SS1.p1.1.m1.1.1.4.2.cmml" xref="S4.SS1.p1.1.m1.1.1.4.2">𝐺</ci><cn id="S4.SS1.p1.1.m1.1.1.4.3.cmml" type="integer" xref="S4.SS1.p1.1.m1.1.1.4.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">G_{1}\!-\!F\!-\!G_{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">italic_G start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT - italic_F - italic_G start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, where <math alttext="F" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.1"><semantics id="S4.SS1.p1.2.m2.1a"><mi id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><ci id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">F</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m2.1d">italic_F</annotation></semantics></math> is a static non-linearity sandwiched between two Linear Time-Invariant (LTI) dynamical blocks <math alttext="G_{1}" class="ltx_Math" display="inline" id="S4.SS1.p1.3.m3.1"><semantics id="S4.SS1.p1.3.m3.1a"><msub id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml"><mi id="S4.SS1.p1.3.m3.1.1.2" xref="S4.SS1.p1.3.m3.1.1.2.cmml">G</mi><mn id="S4.SS1.p1.3.m3.1.1.3" xref="S4.SS1.p1.3.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><apply id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.1.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.p1.3.m3.1.1.2.cmml" xref="S4.SS1.p1.3.m3.1.1.2">𝐺</ci><cn id="S4.SS1.p1.3.m3.1.1.3.cmml" type="integer" xref="S4.SS1.p1.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">G_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.3.m3.1d">italic_G start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="G_{2}" class="ltx_Math" display="inline" id="S4.SS1.p1.4.m4.1"><semantics id="S4.SS1.p1.4.m4.1a"><msub id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml"><mi id="S4.SS1.p1.4.m4.1.1.2" xref="S4.SS1.p1.4.m4.1.1.2.cmml">G</mi><mn id="S4.SS1.p1.4.m4.1.1.3" xref="S4.SS1.p1.4.m4.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><apply id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS1.p1.4.m4.1.1.2.cmml" xref="S4.SS1.p1.4.m4.1.1.2">𝐺</ci><cn id="S4.SS1.p1.4.m4.1.1.3.cmml" type="integer" xref="S4.SS1.p1.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">G_{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.4.m4.1d">italic_G start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>. Systems are drawn from the same distribution considered in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#bib.bib11" title="">11</a>]</cite>. The discrete-time LTI blocks <math alttext="G_{1},G_{2}" class="ltx_Math" display="inline" id="S4.SS1.p1.5.m5.2"><semantics id="S4.SS1.p1.5.m5.2a"><mrow id="S4.SS1.p1.5.m5.2.2.2" xref="S4.SS1.p1.5.m5.2.2.3.cmml"><msub id="S4.SS1.p1.5.m5.1.1.1.1" xref="S4.SS1.p1.5.m5.1.1.1.1.cmml"><mi id="S4.SS1.p1.5.m5.1.1.1.1.2" xref="S4.SS1.p1.5.m5.1.1.1.1.2.cmml">G</mi><mn id="S4.SS1.p1.5.m5.1.1.1.1.3" xref="S4.SS1.p1.5.m5.1.1.1.1.3.cmml">1</mn></msub><mo id="S4.SS1.p1.5.m5.2.2.2.3" xref="S4.SS1.p1.5.m5.2.2.3.cmml">,</mo><msub id="S4.SS1.p1.5.m5.2.2.2.2" xref="S4.SS1.p1.5.m5.2.2.2.2.cmml"><mi id="S4.SS1.p1.5.m5.2.2.2.2.2" xref="S4.SS1.p1.5.m5.2.2.2.2.2.cmml">G</mi><mn id="S4.SS1.p1.5.m5.2.2.2.2.3" xref="S4.SS1.p1.5.m5.2.2.2.2.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.2b"><list id="S4.SS1.p1.5.m5.2.2.3.cmml" xref="S4.SS1.p1.5.m5.2.2.2"><apply id="S4.SS1.p1.5.m5.1.1.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m5.1.1.1.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.5.m5.1.1.1.1.2.cmml" xref="S4.SS1.p1.5.m5.1.1.1.1.2">𝐺</ci><cn id="S4.SS1.p1.5.m5.1.1.1.1.3.cmml" type="integer" xref="S4.SS1.p1.5.m5.1.1.1.1.3">1</cn></apply><apply id="S4.SS1.p1.5.m5.2.2.2.2.cmml" xref="S4.SS1.p1.5.m5.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m5.2.2.2.2.1.cmml" xref="S4.SS1.p1.5.m5.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p1.5.m5.2.2.2.2.2.cmml" xref="S4.SS1.p1.5.m5.2.2.2.2.2">𝐺</ci><cn id="S4.SS1.p1.5.m5.2.2.2.2.3.cmml" type="integer" xref="S4.SS1.p1.5.m5.2.2.2.2.3">2</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.2c">G_{1},G_{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.5.m5.2d">italic_G start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_G start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> are randomly chosen with order between <math alttext="1" class="ltx_Math" display="inline" id="S4.SS1.p1.6.m6.1"><semantics id="S4.SS1.p1.6.m6.1a"><mn id="S4.SS1.p1.6.m6.1.1" xref="S4.SS1.p1.6.m6.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m6.1b"><cn id="S4.SS1.p1.6.m6.1.1.cmml" type="integer" xref="S4.SS1.p1.6.m6.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m6.1c">1</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.6.m6.1d">1</annotation></semantics></math> and <math alttext="10" class="ltx_Math" display="inline" id="S4.SS1.p1.7.m7.1"><semantics id="S4.SS1.p1.7.m7.1a"><mn id="S4.SS1.p1.7.m7.1.1" xref="S4.SS1.p1.7.m7.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m7.1b"><cn id="S4.SS1.p1.7.m7.1.1.cmml" type="integer" xref="S4.SS1.p1.7.m7.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m7.1c">10</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.7.m7.1d">10</annotation></semantics></math>. The magnitude and phase of their poles are randomly chosen from uniform distributions in the ranges <math alttext="(0.5,0.97)" class="ltx_Math" display="inline" id="S4.SS1.p1.8.m8.2"><semantics id="S4.SS1.p1.8.m8.2a"><mrow id="S4.SS1.p1.8.m8.2.3.2" xref="S4.SS1.p1.8.m8.2.3.1.cmml"><mo id="S4.SS1.p1.8.m8.2.3.2.1" stretchy="false" xref="S4.SS1.p1.8.m8.2.3.1.cmml">(</mo><mn id="S4.SS1.p1.8.m8.1.1" xref="S4.SS1.p1.8.m8.1.1.cmml">0.5</mn><mo id="S4.SS1.p1.8.m8.2.3.2.2" xref="S4.SS1.p1.8.m8.2.3.1.cmml">,</mo><mn id="S4.SS1.p1.8.m8.2.2" xref="S4.SS1.p1.8.m8.2.2.cmml">0.97</mn><mo id="S4.SS1.p1.8.m8.2.3.2.3" stretchy="false" xref="S4.SS1.p1.8.m8.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.8.m8.2b"><interval closure="open" id="S4.SS1.p1.8.m8.2.3.1.cmml" xref="S4.SS1.p1.8.m8.2.3.2"><cn id="S4.SS1.p1.8.m8.1.1.cmml" type="float" xref="S4.SS1.p1.8.m8.1.1">0.5</cn><cn id="S4.SS1.p1.8.m8.2.2.cmml" type="float" xref="S4.SS1.p1.8.m8.2.2">0.97</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.8.m8.2c">(0.5,0.97)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.8.m8.2d">( 0.5 , 0.97 )</annotation></semantics></math> and <math alttext="(0,\pi/2)" class="ltx_Math" display="inline" id="S4.SS1.p1.9.m9.2"><semantics id="S4.SS1.p1.9.m9.2a"><mrow id="S4.SS1.p1.9.m9.2.2.1" xref="S4.SS1.p1.9.m9.2.2.2.cmml"><mo id="S4.SS1.p1.9.m9.2.2.1.2" stretchy="false" xref="S4.SS1.p1.9.m9.2.2.2.cmml">(</mo><mn id="S4.SS1.p1.9.m9.1.1" xref="S4.SS1.p1.9.m9.1.1.cmml">0</mn><mo id="S4.SS1.p1.9.m9.2.2.1.3" xref="S4.SS1.p1.9.m9.2.2.2.cmml">,</mo><mrow id="S4.SS1.p1.9.m9.2.2.1.1" xref="S4.SS1.p1.9.m9.2.2.1.1.cmml"><mi id="S4.SS1.p1.9.m9.2.2.1.1.2" xref="S4.SS1.p1.9.m9.2.2.1.1.2.cmml">π</mi><mo id="S4.SS1.p1.9.m9.2.2.1.1.1" xref="S4.SS1.p1.9.m9.2.2.1.1.1.cmml">/</mo><mn id="S4.SS1.p1.9.m9.2.2.1.1.3" xref="S4.SS1.p1.9.m9.2.2.1.1.3.cmml">2</mn></mrow><mo id="S4.SS1.p1.9.m9.2.2.1.4" stretchy="false" xref="S4.SS1.p1.9.m9.2.2.2.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.9.m9.2b"><interval closure="open" id="S4.SS1.p1.9.m9.2.2.2.cmml" xref="S4.SS1.p1.9.m9.2.2.1"><cn id="S4.SS1.p1.9.m9.1.1.cmml" type="integer" xref="S4.SS1.p1.9.m9.1.1">0</cn><apply id="S4.SS1.p1.9.m9.2.2.1.1.cmml" xref="S4.SS1.p1.9.m9.2.2.1.1"><divide id="S4.SS1.p1.9.m9.2.2.1.1.1.cmml" xref="S4.SS1.p1.9.m9.2.2.1.1.1"></divide><ci id="S4.SS1.p1.9.m9.2.2.1.1.2.cmml" xref="S4.SS1.p1.9.m9.2.2.1.1.2">𝜋</ci><cn id="S4.SS1.p1.9.m9.2.2.1.1.3.cmml" type="integer" xref="S4.SS1.p1.9.m9.2.2.1.1.3">2</cn></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.9.m9.2c">(0,\pi/2)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.9.m9.2d">( 0 , italic_π / 2 )</annotation></semantics></math>, respectively. The non-linear block <math alttext="F" class="ltx_Math" display="inline" id="S4.SS1.p1.10.m10.1"><semantics id="S4.SS1.p1.10.m10.1a"><mi id="S4.SS1.p1.10.m10.1.1" xref="S4.SS1.p1.10.m10.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.10.m10.1b"><ci id="S4.SS1.p1.10.m10.1.1.cmml" xref="S4.SS1.p1.10.m10.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.10.m10.1c">F</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.10.m10.1d">italic_F</annotation></semantics></math> is a feed-forward neural network with one hidden layer; 32 hidden units; and weights randomly generated from a Gaussian distribution with Kaiming scaling <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#bib.bib25" title="">25</a>]</cite>.
The input signals fed to the WH systems are drawn from a standard Normal distribution. The WH system output is standardized to have zero mean and unit variance and corrupted by additive white Gaussian noise with standard deviation <math alttext="\sigma_{\text{noise}}=0.1" class="ltx_Math" display="inline" id="S4.SS1.p1.11.m11.1"><semantics id="S4.SS1.p1.11.m11.1a"><mrow id="S4.SS1.p1.11.m11.1.1" xref="S4.SS1.p1.11.m11.1.1.cmml"><msub id="S4.SS1.p1.11.m11.1.1.2" xref="S4.SS1.p1.11.m11.1.1.2.cmml"><mi id="S4.SS1.p1.11.m11.1.1.2.2" xref="S4.SS1.p1.11.m11.1.1.2.2.cmml">σ</mi><mtext id="S4.SS1.p1.11.m11.1.1.2.3" xref="S4.SS1.p1.11.m11.1.1.2.3a.cmml">noise</mtext></msub><mo id="S4.SS1.p1.11.m11.1.1.1" xref="S4.SS1.p1.11.m11.1.1.1.cmml">=</mo><mn id="S4.SS1.p1.11.m11.1.1.3" xref="S4.SS1.p1.11.m11.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.11.m11.1b"><apply id="S4.SS1.p1.11.m11.1.1.cmml" xref="S4.SS1.p1.11.m11.1.1"><eq id="S4.SS1.p1.11.m11.1.1.1.cmml" xref="S4.SS1.p1.11.m11.1.1.1"></eq><apply id="S4.SS1.p1.11.m11.1.1.2.cmml" xref="S4.SS1.p1.11.m11.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.11.m11.1.1.2.1.cmml" xref="S4.SS1.p1.11.m11.1.1.2">subscript</csymbol><ci id="S4.SS1.p1.11.m11.1.1.2.2.cmml" xref="S4.SS1.p1.11.m11.1.1.2.2">𝜎</ci><ci id="S4.SS1.p1.11.m11.1.1.2.3a.cmml" xref="S4.SS1.p1.11.m11.1.1.2.3"><mtext id="S4.SS1.p1.11.m11.1.1.2.3.cmml" mathsize="70%" xref="S4.SS1.p1.11.m11.1.1.2.3">noise</mtext></ci></apply><cn id="S4.SS1.p1.11.m11.1.1.3.cmml" type="float" xref="S4.SS1.p1.11.m11.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.11.m11.1c">\sigma_{\text{noise}}=0.1</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.11.m11.1d">italic_σ start_POSTSUBSCRIPT noise end_POSTSUBSCRIPT = 0.1</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Transformer architecture</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.5">The chosen Transformer architecture is characterized by: <math alttext="n_{\rm layers}=12" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.1"><semantics id="S4.SS2.p1.1.m1.1a"><mrow id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><msub id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml"><mi id="S4.SS2.p1.1.m1.1.1.2.2" xref="S4.SS2.p1.1.m1.1.1.2.2.cmml">n</mi><mi id="S4.SS2.p1.1.m1.1.1.2.3" xref="S4.SS2.p1.1.m1.1.1.2.3.cmml">layers</mi></msub><mo id="S4.SS2.p1.1.m1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS2.p1.1.m1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.3.cmml">12</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><eq id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1"></eq><apply id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.1.2.1.cmml" xref="S4.SS2.p1.1.m1.1.1.2">subscript</csymbol><ci id="S4.SS2.p1.1.m1.1.1.2.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2.2">𝑛</ci><ci id="S4.SS2.p1.1.m1.1.1.2.3.cmml" xref="S4.SS2.p1.1.m1.1.1.2.3">layers</ci></apply><cn id="S4.SS2.p1.1.m1.1.1.3.cmml" type="integer" xref="S4.SS2.p1.1.m1.1.1.3">12</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">n_{\rm layers}=12</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.m1.1d">italic_n start_POSTSUBSCRIPT roman_layers end_POSTSUBSCRIPT = 12</annotation></semantics></math> layers; <math alttext="{d_{\rm model}}=128" class="ltx_Math" display="inline" id="S4.SS2.p1.2.m2.1"><semantics id="S4.SS2.p1.2.m2.1a"><mrow id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml"><msub id="S4.SS2.p1.2.m2.1.1.2" xref="S4.SS2.p1.2.m2.1.1.2.cmml"><mi id="S4.SS2.p1.2.m2.1.1.2.2" xref="S4.SS2.p1.2.m2.1.1.2.2.cmml">d</mi><mi id="S4.SS2.p1.2.m2.1.1.2.3" xref="S4.SS2.p1.2.m2.1.1.2.3.cmml">model</mi></msub><mo id="S4.SS2.p1.2.m2.1.1.1" xref="S4.SS2.p1.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS2.p1.2.m2.1.1.3" xref="S4.SS2.p1.2.m2.1.1.3.cmml">128</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><apply id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1"><eq id="S4.SS2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1.1"></eq><apply id="S4.SS2.p1.2.m2.1.1.2.cmml" xref="S4.SS2.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.1.1.2.1.cmml" xref="S4.SS2.p1.2.m2.1.1.2">subscript</csymbol><ci id="S4.SS2.p1.2.m2.1.1.2.2.cmml" xref="S4.SS2.p1.2.m2.1.1.2.2">𝑑</ci><ci id="S4.SS2.p1.2.m2.1.1.2.3.cmml" xref="S4.SS2.p1.2.m2.1.1.2.3">model</ci></apply><cn id="S4.SS2.p1.2.m2.1.1.3.cmml" type="integer" xref="S4.SS2.p1.2.m2.1.1.3">128</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">{d_{\rm model}}=128</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.2.m2.1d">italic_d start_POSTSUBSCRIPT roman_model end_POSTSUBSCRIPT = 128</annotation></semantics></math> hidden units; and <math alttext="n_{\rm heads}=4" class="ltx_Math" display="inline" id="S4.SS2.p1.3.m3.1"><semantics id="S4.SS2.p1.3.m3.1a"><mrow id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml"><msub id="S4.SS2.p1.3.m3.1.1.2" xref="S4.SS2.p1.3.m3.1.1.2.cmml"><mi id="S4.SS2.p1.3.m3.1.1.2.2" xref="S4.SS2.p1.3.m3.1.1.2.2.cmml">n</mi><mi id="S4.SS2.p1.3.m3.1.1.2.3" xref="S4.SS2.p1.3.m3.1.1.2.3.cmml">heads</mi></msub><mo id="S4.SS2.p1.3.m3.1.1.1" xref="S4.SS2.p1.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS2.p1.3.m3.1.1.3" xref="S4.SS2.p1.3.m3.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><apply id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1"><eq id="S4.SS2.p1.3.m3.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1"></eq><apply id="S4.SS2.p1.3.m3.1.1.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m3.1.1.2.1.cmml" xref="S4.SS2.p1.3.m3.1.1.2">subscript</csymbol><ci id="S4.SS2.p1.3.m3.1.1.2.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2.2">𝑛</ci><ci id="S4.SS2.p1.3.m3.1.1.2.3.cmml" xref="S4.SS2.p1.3.m3.1.1.2.3">heads</ci></apply><cn id="S4.SS2.p1.3.m3.1.1.3.cmml" type="integer" xref="S4.SS2.p1.3.m3.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">n_{\rm heads}=4</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.3.m3.1d">italic_n start_POSTSUBSCRIPT roman_heads end_POSTSUBSCRIPT = 4</annotation></semantics></math> attention heads, both in the encoder and the decoder. The number of the initial conditions is set to <math alttext="n_{\rm in}=10" class="ltx_Math" display="inline" id="S4.SS2.p1.4.m4.1"><semantics id="S4.SS2.p1.4.m4.1a"><mrow id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml"><msub id="S4.SS2.p1.4.m4.1.1.2" xref="S4.SS2.p1.4.m4.1.1.2.cmml"><mi id="S4.SS2.p1.4.m4.1.1.2.2" xref="S4.SS2.p1.4.m4.1.1.2.2.cmml">n</mi><mi id="S4.SS2.p1.4.m4.1.1.2.3" xref="S4.SS2.p1.4.m4.1.1.2.3.cmml">in</mi></msub><mo id="S4.SS2.p1.4.m4.1.1.1" xref="S4.SS2.p1.4.m4.1.1.1.cmml">=</mo><mn id="S4.SS2.p1.4.m4.1.1.3" xref="S4.SS2.p1.4.m4.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><apply id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1"><eq id="S4.SS2.p1.4.m4.1.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1.1"></eq><apply id="S4.SS2.p1.4.m4.1.1.2.cmml" xref="S4.SS2.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.1.1.2.1.cmml" xref="S4.SS2.p1.4.m4.1.1.2">subscript</csymbol><ci id="S4.SS2.p1.4.m4.1.1.2.2.cmml" xref="S4.SS2.p1.4.m4.1.1.2.2">𝑛</ci><ci id="S4.SS2.p1.4.m4.1.1.2.3.cmml" xref="S4.SS2.p1.4.m4.1.1.2.3">in</ci></apply><cn id="S4.SS2.p1.4.m4.1.1.3.cmml" type="integer" xref="S4.SS2.p1.4.m4.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">n_{\rm in}=10</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.4.m4.1d">italic_n start_POSTSUBSCRIPT roman_in end_POSTSUBSCRIPT = 10</annotation></semantics></math> and the query length to <math alttext="N-n_{\rm in}=100" class="ltx_Math" display="inline" id="S4.SS2.p1.5.m5.1"><semantics id="S4.SS2.p1.5.m5.1a"><mrow id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml"><mrow id="S4.SS2.p1.5.m5.1.1.2" xref="S4.SS2.p1.5.m5.1.1.2.cmml"><mi id="S4.SS2.p1.5.m5.1.1.2.2" xref="S4.SS2.p1.5.m5.1.1.2.2.cmml">N</mi><mo id="S4.SS2.p1.5.m5.1.1.2.1" xref="S4.SS2.p1.5.m5.1.1.2.1.cmml">−</mo><msub id="S4.SS2.p1.5.m5.1.1.2.3" xref="S4.SS2.p1.5.m5.1.1.2.3.cmml"><mi id="S4.SS2.p1.5.m5.1.1.2.3.2" xref="S4.SS2.p1.5.m5.1.1.2.3.2.cmml">n</mi><mi id="S4.SS2.p1.5.m5.1.1.2.3.3" xref="S4.SS2.p1.5.m5.1.1.2.3.3.cmml">in</mi></msub></mrow><mo id="S4.SS2.p1.5.m5.1.1.1" xref="S4.SS2.p1.5.m5.1.1.1.cmml">=</mo><mn id="S4.SS2.p1.5.m5.1.1.3" xref="S4.SS2.p1.5.m5.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.1b"><apply id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1"><eq id="S4.SS2.p1.5.m5.1.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1.1"></eq><apply id="S4.SS2.p1.5.m5.1.1.2.cmml" xref="S4.SS2.p1.5.m5.1.1.2"><minus id="S4.SS2.p1.5.m5.1.1.2.1.cmml" xref="S4.SS2.p1.5.m5.1.1.2.1"></minus><ci id="S4.SS2.p1.5.m5.1.1.2.2.cmml" xref="S4.SS2.p1.5.m5.1.1.2.2">𝑁</ci><apply id="S4.SS2.p1.5.m5.1.1.2.3.cmml" xref="S4.SS2.p1.5.m5.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m5.1.1.2.3.1.cmml" xref="S4.SS2.p1.5.m5.1.1.2.3">subscript</csymbol><ci id="S4.SS2.p1.5.m5.1.1.2.3.2.cmml" xref="S4.SS2.p1.5.m5.1.1.2.3.2">𝑛</ci><ci id="S4.SS2.p1.5.m5.1.1.2.3.3.cmml" xref="S4.SS2.p1.5.m5.1.1.2.3.3">in</ci></apply></apply><cn id="S4.SS2.p1.5.m5.1.1.3.cmml" type="integer" xref="S4.SS2.p1.5.m5.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.1c">N-n_{\rm in}=100</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.5.m5.1d">italic_N - italic_n start_POSTSUBSCRIPT roman_in end_POSTSUBSCRIPT = 100</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.7">As previously mentioned, training is performed for context length <math alttext="m\in\{400,800,16000,40000\}" class="ltx_Math" display="inline" id="S4.SS2.p2.1.m1.4"><semantics id="S4.SS2.p2.1.m1.4a"><mrow id="S4.SS2.p2.1.m1.4.5" xref="S4.SS2.p2.1.m1.4.5.cmml"><mi id="S4.SS2.p2.1.m1.4.5.2" xref="S4.SS2.p2.1.m1.4.5.2.cmml">m</mi><mo id="S4.SS2.p2.1.m1.4.5.1" xref="S4.SS2.p2.1.m1.4.5.1.cmml">∈</mo><mrow id="S4.SS2.p2.1.m1.4.5.3.2" xref="S4.SS2.p2.1.m1.4.5.3.1.cmml"><mo id="S4.SS2.p2.1.m1.4.5.3.2.1" stretchy="false" xref="S4.SS2.p2.1.m1.4.5.3.1.cmml">{</mo><mn id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml">400</mn><mo id="S4.SS2.p2.1.m1.4.5.3.2.2" xref="S4.SS2.p2.1.m1.4.5.3.1.cmml">,</mo><mn id="S4.SS2.p2.1.m1.2.2" xref="S4.SS2.p2.1.m1.2.2.cmml">800</mn><mo id="S4.SS2.p2.1.m1.4.5.3.2.3" xref="S4.SS2.p2.1.m1.4.5.3.1.cmml">,</mo><mn id="S4.SS2.p2.1.m1.3.3" xref="S4.SS2.p2.1.m1.3.3.cmml">16000</mn><mo id="S4.SS2.p2.1.m1.4.5.3.2.4" xref="S4.SS2.p2.1.m1.4.5.3.1.cmml">,</mo><mn id="S4.SS2.p2.1.m1.4.4" xref="S4.SS2.p2.1.m1.4.4.cmml">40000</mn><mo id="S4.SS2.p2.1.m1.4.5.3.2.5" stretchy="false" xref="S4.SS2.p2.1.m1.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.4b"><apply id="S4.SS2.p2.1.m1.4.5.cmml" xref="S4.SS2.p2.1.m1.4.5"><in id="S4.SS2.p2.1.m1.4.5.1.cmml" xref="S4.SS2.p2.1.m1.4.5.1"></in><ci id="S4.SS2.p2.1.m1.4.5.2.cmml" xref="S4.SS2.p2.1.m1.4.5.2">𝑚</ci><set id="S4.SS2.p2.1.m1.4.5.3.1.cmml" xref="S4.SS2.p2.1.m1.4.5.3.2"><cn id="S4.SS2.p2.1.m1.1.1.cmml" type="integer" xref="S4.SS2.p2.1.m1.1.1">400</cn><cn id="S4.SS2.p2.1.m1.2.2.cmml" type="integer" xref="S4.SS2.p2.1.m1.2.2">800</cn><cn id="S4.SS2.p2.1.m1.3.3.cmml" type="integer" xref="S4.SS2.p2.1.m1.3.3">16000</cn><cn id="S4.SS2.p2.1.m1.4.4.cmml" type="integer" xref="S4.SS2.p2.1.m1.4.4">40000</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.4c">m\in\{400,800,16000,40000\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.1.m1.4d">italic_m ∈ { 400 , 800 , 16000 , 40000 }</annotation></semantics></math>.
For the sake of comparison between the proposed patching-based approach and the non-patching method, for the shortest context length <math alttext="m=400" class="ltx_Math" display="inline" id="S4.SS2.p2.2.m2.1"><semantics id="S4.SS2.p2.2.m2.1a"><mrow id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml"><mi id="S4.SS2.p2.2.m2.1.1.2" xref="S4.SS2.p2.2.m2.1.1.2.cmml">m</mi><mo id="S4.SS2.p2.2.m2.1.1.1" xref="S4.SS2.p2.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS2.p2.2.m2.1.1.3" xref="S4.SS2.p2.2.m2.1.1.3.cmml">400</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><apply id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1"><eq id="S4.SS2.p2.2.m2.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1"></eq><ci id="S4.SS2.p2.2.m2.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1.2">𝑚</ci><cn id="S4.SS2.p2.2.m2.1.1.3.cmml" type="integer" xref="S4.SS2.p2.2.m2.1.1.3">400</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">m=400</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.2.m2.1d">italic_m = 400</annotation></semantics></math> the recurrent patching approach is not implemented and the sequence of embeddings <math alttext="p_{1:M}" class="ltx_Math" display="inline" id="S4.SS2.p2.3.m3.1"><semantics id="S4.SS2.p2.3.m3.1a"><msub id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml"><mi id="S4.SS2.p2.3.m3.1.1.2" xref="S4.SS2.p2.3.m3.1.1.2.cmml">p</mi><mrow id="S4.SS2.p2.3.m3.1.1.3" xref="S4.SS2.p2.3.m3.1.1.3.cmml"><mn id="S4.SS2.p2.3.m3.1.1.3.2" xref="S4.SS2.p2.3.m3.1.1.3.2.cmml">1</mn><mo id="S4.SS2.p2.3.m3.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S4.SS2.p2.3.m3.1.1.3.1.cmml">:</mo><mi id="S4.SS2.p2.3.m3.1.1.3.3" xref="S4.SS2.p2.3.m3.1.1.3.3.cmml">M</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><apply id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.3.m3.1.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.p2.3.m3.1.1.2.cmml" xref="S4.SS2.p2.3.m3.1.1.2">𝑝</ci><apply id="S4.SS2.p2.3.m3.1.1.3.cmml" xref="S4.SS2.p2.3.m3.1.1.3"><ci id="S4.SS2.p2.3.m3.1.1.3.1.cmml" xref="S4.SS2.p2.3.m3.1.1.3.1">:</ci><cn id="S4.SS2.p2.3.m3.1.1.3.2.cmml" type="integer" xref="S4.SS2.p2.3.m3.1.1.3.2">1</cn><ci id="S4.SS2.p2.3.m3.1.1.3.3.cmml" xref="S4.SS2.p2.3.m3.1.1.3.3">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">p_{1:M}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.3.m3.1d">italic_p start_POSTSUBSCRIPT 1 : italic_M end_POSTSUBSCRIPT</annotation></semantics></math> (with <math alttext="M=m" class="ltx_Math" display="inline" id="S4.SS2.p2.4.m4.1"><semantics id="S4.SS2.p2.4.m4.1a"><mrow id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml"><mi id="S4.SS2.p2.4.m4.1.1.2" xref="S4.SS2.p2.4.m4.1.1.2.cmml">M</mi><mo id="S4.SS2.p2.4.m4.1.1.1" xref="S4.SS2.p2.4.m4.1.1.1.cmml">=</mo><mi id="S4.SS2.p2.4.m4.1.1.3" xref="S4.SS2.p2.4.m4.1.1.3.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><apply id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1"><eq id="S4.SS2.p2.4.m4.1.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1.1"></eq><ci id="S4.SS2.p2.4.m4.1.1.2.cmml" xref="S4.SS2.p2.4.m4.1.1.2">𝑀</ci><ci id="S4.SS2.p2.4.m4.1.1.3.cmml" xref="S4.SS2.p2.4.m4.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.1c">M=m</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.4.m4.1d">italic_M = italic_m</annotation></semantics></math>) is obtained simply by processing the samples <math alttext="u_{1:m},y_{1:m}" class="ltx_Math" display="inline" id="S4.SS2.p2.5.m5.2"><semantics id="S4.SS2.p2.5.m5.2a"><mrow id="S4.SS2.p2.5.m5.2.2.2" xref="S4.SS2.p2.5.m5.2.2.3.cmml"><msub id="S4.SS2.p2.5.m5.1.1.1.1" xref="S4.SS2.p2.5.m5.1.1.1.1.cmml"><mi id="S4.SS2.p2.5.m5.1.1.1.1.2" xref="S4.SS2.p2.5.m5.1.1.1.1.2.cmml">u</mi><mrow id="S4.SS2.p2.5.m5.1.1.1.1.3" xref="S4.SS2.p2.5.m5.1.1.1.1.3.cmml"><mn id="S4.SS2.p2.5.m5.1.1.1.1.3.2" xref="S4.SS2.p2.5.m5.1.1.1.1.3.2.cmml">1</mn><mo id="S4.SS2.p2.5.m5.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S4.SS2.p2.5.m5.1.1.1.1.3.1.cmml">:</mo><mi id="S4.SS2.p2.5.m5.1.1.1.1.3.3" xref="S4.SS2.p2.5.m5.1.1.1.1.3.3.cmml">m</mi></mrow></msub><mo id="S4.SS2.p2.5.m5.2.2.2.3" xref="S4.SS2.p2.5.m5.2.2.3.cmml">,</mo><msub id="S4.SS2.p2.5.m5.2.2.2.2" xref="S4.SS2.p2.5.m5.2.2.2.2.cmml"><mi id="S4.SS2.p2.5.m5.2.2.2.2.2" xref="S4.SS2.p2.5.m5.2.2.2.2.2.cmml">y</mi><mrow id="S4.SS2.p2.5.m5.2.2.2.2.3" xref="S4.SS2.p2.5.m5.2.2.2.2.3.cmml"><mn id="S4.SS2.p2.5.m5.2.2.2.2.3.2" xref="S4.SS2.p2.5.m5.2.2.2.2.3.2.cmml">1</mn><mo id="S4.SS2.p2.5.m5.2.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S4.SS2.p2.5.m5.2.2.2.2.3.1.cmml">:</mo><mi id="S4.SS2.p2.5.m5.2.2.2.2.3.3" xref="S4.SS2.p2.5.m5.2.2.2.2.3.3.cmml">m</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.5.m5.2b"><list id="S4.SS2.p2.5.m5.2.2.3.cmml" xref="S4.SS2.p2.5.m5.2.2.2"><apply id="S4.SS2.p2.5.m5.1.1.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.1.1.1.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p2.5.m5.1.1.1.1.2.cmml" xref="S4.SS2.p2.5.m5.1.1.1.1.2">𝑢</ci><apply id="S4.SS2.p2.5.m5.1.1.1.1.3.cmml" xref="S4.SS2.p2.5.m5.1.1.1.1.3"><ci id="S4.SS2.p2.5.m5.1.1.1.1.3.1.cmml" xref="S4.SS2.p2.5.m5.1.1.1.1.3.1">:</ci><cn id="S4.SS2.p2.5.m5.1.1.1.1.3.2.cmml" type="integer" xref="S4.SS2.p2.5.m5.1.1.1.1.3.2">1</cn><ci id="S4.SS2.p2.5.m5.1.1.1.1.3.3.cmml" xref="S4.SS2.p2.5.m5.1.1.1.1.3.3">𝑚</ci></apply></apply><apply id="S4.SS2.p2.5.m5.2.2.2.2.cmml" xref="S4.SS2.p2.5.m5.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.2.2.2.2.1.cmml" xref="S4.SS2.p2.5.m5.2.2.2.2">subscript</csymbol><ci id="S4.SS2.p2.5.m5.2.2.2.2.2.cmml" xref="S4.SS2.p2.5.m5.2.2.2.2.2">𝑦</ci><apply id="S4.SS2.p2.5.m5.2.2.2.2.3.cmml" xref="S4.SS2.p2.5.m5.2.2.2.2.3"><ci id="S4.SS2.p2.5.m5.2.2.2.2.3.1.cmml" xref="S4.SS2.p2.5.m5.2.2.2.2.3.1">:</ci><cn id="S4.SS2.p2.5.m5.2.2.2.2.3.2.cmml" type="integer" xref="S4.SS2.p2.5.m5.2.2.2.2.3.2">1</cn><ci id="S4.SS2.p2.5.m5.2.2.2.2.3.3.cmml" xref="S4.SS2.p2.5.m5.2.2.2.2.3.3">𝑚</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.5.m5.2c">u_{1:m},y_{1:m}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.5.m5.2d">italic_u start_POSTSUBSCRIPT 1 : italic_m end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 1 : italic_m end_POSTSUBSCRIPT</annotation></semantics></math> through a linear layer with <math alttext="n_{u}+n_{y}" class="ltx_Math" display="inline" id="S4.SS2.p2.6.m6.1"><semantics id="S4.SS2.p2.6.m6.1a"><mrow id="S4.SS2.p2.6.m6.1.1" xref="S4.SS2.p2.6.m6.1.1.cmml"><msub id="S4.SS2.p2.6.m6.1.1.2" xref="S4.SS2.p2.6.m6.1.1.2.cmml"><mi id="S4.SS2.p2.6.m6.1.1.2.2" xref="S4.SS2.p2.6.m6.1.1.2.2.cmml">n</mi><mi id="S4.SS2.p2.6.m6.1.1.2.3" xref="S4.SS2.p2.6.m6.1.1.2.3.cmml">u</mi></msub><mo id="S4.SS2.p2.6.m6.1.1.1" xref="S4.SS2.p2.6.m6.1.1.1.cmml">+</mo><msub id="S4.SS2.p2.6.m6.1.1.3" xref="S4.SS2.p2.6.m6.1.1.3.cmml"><mi id="S4.SS2.p2.6.m6.1.1.3.2" xref="S4.SS2.p2.6.m6.1.1.3.2.cmml">n</mi><mi id="S4.SS2.p2.6.m6.1.1.3.3" xref="S4.SS2.p2.6.m6.1.1.3.3.cmml">y</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.6.m6.1b"><apply id="S4.SS2.p2.6.m6.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1"><plus id="S4.SS2.p2.6.m6.1.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1.1"></plus><apply id="S4.SS2.p2.6.m6.1.1.2.cmml" xref="S4.SS2.p2.6.m6.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p2.6.m6.1.1.2.1.cmml" xref="S4.SS2.p2.6.m6.1.1.2">subscript</csymbol><ci id="S4.SS2.p2.6.m6.1.1.2.2.cmml" xref="S4.SS2.p2.6.m6.1.1.2.2">𝑛</ci><ci id="S4.SS2.p2.6.m6.1.1.2.3.cmml" xref="S4.SS2.p2.6.m6.1.1.2.3">𝑢</ci></apply><apply id="S4.SS2.p2.6.m6.1.1.3.cmml" xref="S4.SS2.p2.6.m6.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p2.6.m6.1.1.3.1.cmml" xref="S4.SS2.p2.6.m6.1.1.3">subscript</csymbol><ci id="S4.SS2.p2.6.m6.1.1.3.2.cmml" xref="S4.SS2.p2.6.m6.1.1.3.2">𝑛</ci><ci id="S4.SS2.p2.6.m6.1.1.3.3.cmml" xref="S4.SS2.p2.6.m6.1.1.3.3">𝑦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.6.m6.1c">n_{u}+n_{y}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.6.m6.1d">italic_n start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT + italic_n start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT</annotation></semantics></math> inputs and <math alttext="{d_{\rm model}}" class="ltx_Math" display="inline" id="S4.SS2.p2.7.m7.1"><semantics id="S4.SS2.p2.7.m7.1a"><msub id="S4.SS2.p2.7.m7.1.1" xref="S4.SS2.p2.7.m7.1.1.cmml"><mi id="S4.SS2.p2.7.m7.1.1.2" xref="S4.SS2.p2.7.m7.1.1.2.cmml">d</mi><mi id="S4.SS2.p2.7.m7.1.1.3" xref="S4.SS2.p2.7.m7.1.1.3.cmml">model</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.7.m7.1b"><apply id="S4.SS2.p2.7.m7.1.1.cmml" xref="S4.SS2.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.7.m7.1.1.1.cmml" xref="S4.SS2.p2.7.m7.1.1">subscript</csymbol><ci id="S4.SS2.p2.7.m7.1.1.2.cmml" xref="S4.SS2.p2.7.m7.1.1.2">𝑑</ci><ci id="S4.SS2.p2.7.m7.1.1.3.cmml" xref="S4.SS2.p2.7.m7.1.1.3">model</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.7.m7.1c">{d_{\rm model}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.7.m7.1d">italic_d start_POSTSUBSCRIPT roman_model end_POSTSUBSCRIPT</annotation></semantics></math> outputs, as in the original work <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#bib.bib11" title="">11</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.10">For all other context lengths, the recurrent patching approach described in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#S3.SS3" title="3.3 Patching for long context sequences ‣ 3 Advancing the Transformer Architecture ‣ Enhanced Transformer architecture for in-context learning of dynamical systems"><span class="ltx_text ltx_ref_tag">3.3</span></a> has been followed with fixed embedding sequence length <math alttext="M=400" class="ltx_Math" display="inline" id="S4.SS2.p3.1.m1.1"><semantics id="S4.SS2.p3.1.m1.1a"><mrow id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml"><mi id="S4.SS2.p3.1.m1.1.1.2" xref="S4.SS2.p3.1.m1.1.1.2.cmml">M</mi><mo id="S4.SS2.p3.1.m1.1.1.1" xref="S4.SS2.p3.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS2.p3.1.m1.1.1.3" xref="S4.SS2.p3.1.m1.1.1.3.cmml">400</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><apply id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1"><eq id="S4.SS2.p3.1.m1.1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1.1"></eq><ci id="S4.SS2.p3.1.m1.1.1.2.cmml" xref="S4.SS2.p3.1.m1.1.1.2">𝑀</ci><cn id="S4.SS2.p3.1.m1.1.1.3.cmml" type="integer" xref="S4.SS2.p3.1.m1.1.1.3">400</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">M=400</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.1.m1.1d">italic_M = 400</annotation></semantics></math>, and patch length <math alttext="L=m/M" class="ltx_Math" display="inline" id="S4.SS2.p3.2.m2.1"><semantics id="S4.SS2.p3.2.m2.1a"><mrow id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml"><mi id="S4.SS2.p3.2.m2.1.1.2" xref="S4.SS2.p3.2.m2.1.1.2.cmml">L</mi><mo id="S4.SS2.p3.2.m2.1.1.1" xref="S4.SS2.p3.2.m2.1.1.1.cmml">=</mo><mrow id="S4.SS2.p3.2.m2.1.1.3" xref="S4.SS2.p3.2.m2.1.1.3.cmml"><mi id="S4.SS2.p3.2.m2.1.1.3.2" xref="S4.SS2.p3.2.m2.1.1.3.2.cmml">m</mi><mo id="S4.SS2.p3.2.m2.1.1.3.1" xref="S4.SS2.p3.2.m2.1.1.3.1.cmml">/</mo><mi id="S4.SS2.p3.2.m2.1.1.3.3" xref="S4.SS2.p3.2.m2.1.1.3.3.cmml">M</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><apply id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1"><eq id="S4.SS2.p3.2.m2.1.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1.1"></eq><ci id="S4.SS2.p3.2.m2.1.1.2.cmml" xref="S4.SS2.p3.2.m2.1.1.2">𝐿</ci><apply id="S4.SS2.p3.2.m2.1.1.3.cmml" xref="S4.SS2.p3.2.m2.1.1.3"><divide id="S4.SS2.p3.2.m2.1.1.3.1.cmml" xref="S4.SS2.p3.2.m2.1.1.3.1"></divide><ci id="S4.SS2.p3.2.m2.1.1.3.2.cmml" xref="S4.SS2.p3.2.m2.1.1.3.2">𝑚</ci><ci id="S4.SS2.p3.2.m2.1.1.3.3.cmml" xref="S4.SS2.p3.2.m2.1.1.3.3">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">L=m/M</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.2.m2.1d">italic_L = italic_m / italic_M</annotation></semantics></math>. A vanilla RNN with one hidden layer and <math alttext="{d_{\rm model}}=128" class="ltx_Math" display="inline" id="S4.SS2.p3.3.m3.1"><semantics id="S4.SS2.p3.3.m3.1a"><mrow id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml"><msub id="S4.SS2.p3.3.m3.1.1.2" xref="S4.SS2.p3.3.m3.1.1.2.cmml"><mi id="S4.SS2.p3.3.m3.1.1.2.2" xref="S4.SS2.p3.3.m3.1.1.2.2.cmml">d</mi><mi id="S4.SS2.p3.3.m3.1.1.2.3" xref="S4.SS2.p3.3.m3.1.1.2.3.cmml">model</mi></msub><mo id="S4.SS2.p3.3.m3.1.1.1" xref="S4.SS2.p3.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS2.p3.3.m3.1.1.3" xref="S4.SS2.p3.3.m3.1.1.3.cmml">128</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.1b"><apply id="S4.SS2.p3.3.m3.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1"><eq id="S4.SS2.p3.3.m3.1.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1.1"></eq><apply id="S4.SS2.p3.3.m3.1.1.2.cmml" xref="S4.SS2.p3.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p3.3.m3.1.1.2.1.cmml" xref="S4.SS2.p3.3.m3.1.1.2">subscript</csymbol><ci id="S4.SS2.p3.3.m3.1.1.2.2.cmml" xref="S4.SS2.p3.3.m3.1.1.2.2">𝑑</ci><ci id="S4.SS2.p3.3.m3.1.1.2.3.cmml" xref="S4.SS2.p3.3.m3.1.1.2.3">model</ci></apply><cn id="S4.SS2.p3.3.m3.1.1.3.cmml" type="integer" xref="S4.SS2.p3.3.m3.1.1.3">128</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.1c">{d_{\rm model}}=128</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.3.m3.1d">italic_d start_POSTSUBSCRIPT roman_model end_POSTSUBSCRIPT = 128</annotation></semantics></math> hidden units is used to process the <math alttext="M" class="ltx_Math" display="inline" id="S4.SS2.p3.4.m4.1"><semantics id="S4.SS2.p3.4.m4.1a"><mi id="S4.SS2.p3.4.m4.1.1" xref="S4.SS2.p3.4.m4.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.4.m4.1b"><ci id="S4.SS2.p3.4.m4.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.4.m4.1c">M</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.4.m4.1d">italic_M</annotation></semantics></math> patches, each of length <math alttext="L" class="ltx_Math" display="inline" id="S4.SS2.p3.5.m5.1"><semantics id="S4.SS2.p3.5.m5.1a"><mi id="S4.SS2.p3.5.m5.1.1" xref="S4.SS2.p3.5.m5.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.5.m5.1b"><ci id="S4.SS2.p3.5.m5.1.1.cmml" xref="S4.SS2.p3.5.m5.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.5.m5.1c">L</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.5.m5.1d">italic_L</annotation></semantics></math>.
The last hidden unit of each patch is extracted and further processed by a square linear layer of dimension <math alttext="{d_{\rm model}}" class="ltx_Math" display="inline" id="S4.SS2.p3.6.m6.1"><semantics id="S4.SS2.p3.6.m6.1a"><msub id="S4.SS2.p3.6.m6.1.1" xref="S4.SS2.p3.6.m6.1.1.cmml"><mi id="S4.SS2.p3.6.m6.1.1.2" xref="S4.SS2.p3.6.m6.1.1.2.cmml">d</mi><mi id="S4.SS2.p3.6.m6.1.1.3" xref="S4.SS2.p3.6.m6.1.1.3.cmml">model</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.6.m6.1b"><apply id="S4.SS2.p3.6.m6.1.1.cmml" xref="S4.SS2.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.6.m6.1.1.1.cmml" xref="S4.SS2.p3.6.m6.1.1">subscript</csymbol><ci id="S4.SS2.p3.6.m6.1.1.2.cmml" xref="S4.SS2.p3.6.m6.1.1.2">𝑑</ci><ci id="S4.SS2.p3.6.m6.1.1.3.cmml" xref="S4.SS2.p3.6.m6.1.1.3">model</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.6.m6.1c">{d_{\rm model}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.6.m6.1d">italic_d start_POSTSUBSCRIPT roman_model end_POSTSUBSCRIPT</annotation></semantics></math>,
and finally combined in the patch embedding sequence <math alttext="p_{1:M}" class="ltx_Math" display="inline" id="S4.SS2.p3.7.m7.1"><semantics id="S4.SS2.p3.7.m7.1a"><msub id="S4.SS2.p3.7.m7.1.1" xref="S4.SS2.p3.7.m7.1.1.cmml"><mi id="S4.SS2.p3.7.m7.1.1.2" xref="S4.SS2.p3.7.m7.1.1.2.cmml">p</mi><mrow id="S4.SS2.p3.7.m7.1.1.3" xref="S4.SS2.p3.7.m7.1.1.3.cmml"><mn id="S4.SS2.p3.7.m7.1.1.3.2" xref="S4.SS2.p3.7.m7.1.1.3.2.cmml">1</mn><mo id="S4.SS2.p3.7.m7.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S4.SS2.p3.7.m7.1.1.3.1.cmml">:</mo><mi id="S4.SS2.p3.7.m7.1.1.3.3" xref="S4.SS2.p3.7.m7.1.1.3.3.cmml">M</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.7.m7.1b"><apply id="S4.SS2.p3.7.m7.1.1.cmml" xref="S4.SS2.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.7.m7.1.1.1.cmml" xref="S4.SS2.p3.7.m7.1.1">subscript</csymbol><ci id="S4.SS2.p3.7.m7.1.1.2.cmml" xref="S4.SS2.p3.7.m7.1.1.2">𝑝</ci><apply id="S4.SS2.p3.7.m7.1.1.3.cmml" xref="S4.SS2.p3.7.m7.1.1.3"><ci id="S4.SS2.p3.7.m7.1.1.3.1.cmml" xref="S4.SS2.p3.7.m7.1.1.3.1">:</ci><cn id="S4.SS2.p3.7.m7.1.1.3.2.cmml" type="integer" xref="S4.SS2.p3.7.m7.1.1.3.2">1</cn><ci id="S4.SS2.p3.7.m7.1.1.3.3.cmml" xref="S4.SS2.p3.7.m7.1.1.3.3">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.7.m7.1c">p_{1:M}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.7.m7.1d">italic_p start_POSTSUBSCRIPT 1 : italic_M end_POSTSUBSCRIPT</annotation></semantics></math> fed to the encoder backbone.<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>More in general, the number of hidden units of the RNN could be different from <math alttext="{d_{\rm model}}" class="ltx_Math" display="inline" id="footnote2.m1.1"><semantics id="footnote2.m1.1b"><msub id="footnote2.m1.1.1" xref="footnote2.m1.1.1.cmml"><mi id="footnote2.m1.1.1.2" xref="footnote2.m1.1.1.2.cmml">d</mi><mi id="footnote2.m1.1.1.3" xref="footnote2.m1.1.1.3.cmml">model</mi></msub><annotation-xml encoding="MathML-Content" id="footnote2.m1.1c"><apply id="footnote2.m1.1.1.cmml" xref="footnote2.m1.1.1"><csymbol cd="ambiguous" id="footnote2.m1.1.1.1.cmml" xref="footnote2.m1.1.1">subscript</csymbol><ci id="footnote2.m1.1.1.2.cmml" xref="footnote2.m1.1.1.2">𝑑</ci><ci id="footnote2.m1.1.1.3.cmml" xref="footnote2.m1.1.1.3">model</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote2.m1.1d">{d_{\rm model}}</annotation><annotation encoding="application/x-llamapun" id="footnote2.m1.1e">italic_d start_POSTSUBSCRIPT roman_model end_POSTSUBSCRIPT</annotation></semantics></math>. In that the case, the final linear layer would not be square.</span></span></span>
The total number of parameters characterizing the Transformer is independent of the context length, and it is equal to <math alttext="5.54" class="ltx_Math" display="inline" id="S4.SS2.p3.8.m8.1"><semantics id="S4.SS2.p3.8.m8.1a"><mn id="S4.SS2.p3.8.m8.1.1" xref="S4.SS2.p3.8.m8.1.1.cmml">5.54</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.8.m8.1b"><cn id="S4.SS2.p3.8.m8.1.1.cmml" type="float" xref="S4.SS2.p3.8.m8.1.1">5.54</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.8.m8.1c">5.54</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.8.m8.1d">5.54</annotation></semantics></math> millions in all the cases with patching. When patching is not adopted (<math alttext="m=400" class="ltx_Math" display="inline" id="S4.SS2.p3.9.m9.1"><semantics id="S4.SS2.p3.9.m9.1a"><mrow id="S4.SS2.p3.9.m9.1.1" xref="S4.SS2.p3.9.m9.1.1.cmml"><mi id="S4.SS2.p3.9.m9.1.1.2" xref="S4.SS2.p3.9.m9.1.1.2.cmml">m</mi><mo id="S4.SS2.p3.9.m9.1.1.1" xref="S4.SS2.p3.9.m9.1.1.1.cmml">=</mo><mn id="S4.SS2.p3.9.m9.1.1.3" xref="S4.SS2.p3.9.m9.1.1.3.cmml">400</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.9.m9.1b"><apply id="S4.SS2.p3.9.m9.1.1.cmml" xref="S4.SS2.p3.9.m9.1.1"><eq id="S4.SS2.p3.9.m9.1.1.1.cmml" xref="S4.SS2.p3.9.m9.1.1.1"></eq><ci id="S4.SS2.p3.9.m9.1.1.2.cmml" xref="S4.SS2.p3.9.m9.1.1.2">𝑚</ci><cn id="S4.SS2.p3.9.m9.1.1.3.cmml" type="integer" xref="S4.SS2.p3.9.m9.1.1.3">400</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.9.m9.1c">m=400</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.9.m9.1d">italic_m = 400</annotation></semantics></math>), the number of parameters is <math alttext="5.5" class="ltx_Math" display="inline" id="S4.SS2.p3.10.m10.1"><semantics id="S4.SS2.p3.10.m10.1a"><mn id="S4.SS2.p3.10.m10.1.1" xref="S4.SS2.p3.10.m10.1.1.cmml">5.5</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.10.m10.1b"><cn id="S4.SS2.p3.10.m10.1.1.cmml" type="float" xref="S4.SS2.p3.10.m10.1.1">5.5</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.10.m10.1c">5.5</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.10.m10.1d">5.5</annotation></semantics></math> millions, slightly smaller since the RNN layer is not present.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Results</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">The test root mean square error (RMSE), train time, and number of parameters of the different meta-models are reported in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#S4.T1" title="Table 1 ‣ 4.3 Results ‣ 4 Numerical Example ‣ Enhanced Transformer architecture for in-context learning of dynamical systems"><span class="ltx_text ltx_ref_tag">1</span></a>.
Furthermore, the validation RMSE over the iterations of the AdamW optimization algorithm is visualized in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#S4.F3" title="Figure 3 ‣ 4.3 Results ‣ 4 Numerical Example ‣ Enhanced Transformer architecture for in-context learning of dynamical systems"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<figure class="ltx_table" id="S4.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T1.5.2.1" style="font-size:90%;">Table 1</span>: </span><span class="ltx_text" id="S4.T1.2.1" style="font-size:90%;">
Root mean square error in test, train time, and number of parameters of the meta-models for different context lengths <math alttext="m" class="ltx_Math" display="inline" id="S4.T1.2.1.m1.1"><semantics id="S4.T1.2.1.m1.1b"><mi id="S4.T1.2.1.m1.1.1" xref="S4.T1.2.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.T1.2.1.m1.1c"><ci id="S4.T1.2.1.m1.1.1.cmml" xref="S4.T1.2.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.1.m1.1d">m</annotation><annotation encoding="application/x-llamapun" id="S4.T1.2.1.m1.1e">italic_m</annotation></semantics></math>.
</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T1.3">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T1.3.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T1.3.1.1"><math alttext="m" class="ltx_Math" display="inline" id="S4.T1.3.1.1.m1.1"><semantics id="S4.T1.3.1.1.m1.1a"><mi id="S4.T1.3.1.1.m1.1.1" xref="S4.T1.3.1.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.T1.3.1.1.m1.1b"><ci id="S4.T1.3.1.1.m1.1.1.cmml" xref="S4.T1.3.1.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.1.1.m1.1c">m</annotation><annotation encoding="application/x-llamapun" id="S4.T1.3.1.1.m1.1d">italic_m</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.3.1.2">test RMSE</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.3.1.3">train time [days]</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.3.1.4">parameter count [M]</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.3.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S4.T1.3.2.1.1">400</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.2.1.2">0.166</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.2.1.3">1.00</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.2.1.4">5.50</td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T1.3.3.2.1">800</th>
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.2.2">0.143</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.2.3">1.04</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.2.4">5.54</td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.4.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T1.3.4.3.1">16000</th>
<td class="ltx_td ltx_align_center" id="S4.T1.3.4.3.2">0.128</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.4.3.3">1.67</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.4.3.4">5.54</td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.5.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="S4.T1.3.5.4.1">40000</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.3.5.4.2">0.128</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.3.5.4.3">3.75</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.3.5.4.4">5.54</td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_figure" id="S4.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="232" id="S4.F3.g1" src="extracted/5901228/loss_shape.jpg" width="479"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F3.4.2.1" style="font-size:90%;">Figure 3</span>: </span><span class="ltx_text" id="S4.F3.2.1" style="font-size:90%;">Root mean square error in validation vs. training iteration number for different context lengths <math alttext="m" class="ltx_Math" display="inline" id="S4.F3.2.1.m1.1"><semantics id="S4.F3.2.1.m1.1b"><mi id="S4.F3.2.1.m1.1.1" xref="S4.F3.2.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.F3.2.1.m1.1c"><ci id="S4.F3.2.1.m1.1.1.cmml" xref="S4.F3.2.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.2.1.m1.1d">m</annotation><annotation encoding="application/x-llamapun" id="S4.F3.2.1.m1.1e">italic_m</annotation></semantics></math>.
</span></figcaption>
</figure>
<div class="ltx_para" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.8">The difference between the achieved RMSE and the noise floor <math alttext="\sigma_{\rm noise}=0.1" class="ltx_Math" display="inline" id="S4.SS3.p2.1.m1.1"><semantics id="S4.SS3.p2.1.m1.1a"><mrow id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml"><msub id="S4.SS3.p2.1.m1.1.1.2" xref="S4.SS3.p2.1.m1.1.1.2.cmml"><mi id="S4.SS3.p2.1.m1.1.1.2.2" xref="S4.SS3.p2.1.m1.1.1.2.2.cmml">σ</mi><mi id="S4.SS3.p2.1.m1.1.1.2.3" xref="S4.SS3.p2.1.m1.1.1.2.3.cmml">noise</mi></msub><mo id="S4.SS3.p2.1.m1.1.1.1" xref="S4.SS3.p2.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS3.p2.1.m1.1.1.3" xref="S4.SS3.p2.1.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><apply id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1"><eq id="S4.SS3.p2.1.m1.1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1.1"></eq><apply id="S4.SS3.p2.1.m1.1.1.2.cmml" xref="S4.SS3.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p2.1.m1.1.1.2.1.cmml" xref="S4.SS3.p2.1.m1.1.1.2">subscript</csymbol><ci id="S4.SS3.p2.1.m1.1.1.2.2.cmml" xref="S4.SS3.p2.1.m1.1.1.2.2">𝜎</ci><ci id="S4.SS3.p2.1.m1.1.1.2.3.cmml" xref="S4.SS3.p2.1.m1.1.1.2.3">noise</ci></apply><cn id="S4.SS3.p2.1.m1.1.1.3.cmml" type="float" xref="S4.SS3.p2.1.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">\sigma_{\rm noise}=0.1</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.1.m1.1d">italic_σ start_POSTSUBSCRIPT roman_noise end_POSTSUBSCRIPT = 0.1</annotation></semantics></math> consistently decreases with the context length up to <math alttext="m=16000" class="ltx_Math" display="inline" id="S4.SS3.p2.2.m2.1"><semantics id="S4.SS3.p2.2.m2.1a"><mrow id="S4.SS3.p2.2.m2.1.1" xref="S4.SS3.p2.2.m2.1.1.cmml"><mi id="S4.SS3.p2.2.m2.1.1.2" xref="S4.SS3.p2.2.m2.1.1.2.cmml">m</mi><mo id="S4.SS3.p2.2.m2.1.1.1" xref="S4.SS3.p2.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS3.p2.2.m2.1.1.3" xref="S4.SS3.p2.2.m2.1.1.3.cmml">16000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.1b"><apply id="S4.SS3.p2.2.m2.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1"><eq id="S4.SS3.p2.2.m2.1.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1.1"></eq><ci id="S4.SS3.p2.2.m2.1.1.2.cmml" xref="S4.SS3.p2.2.m2.1.1.2">𝑚</ci><cn id="S4.SS3.p2.2.m2.1.1.3.cmml" type="integer" xref="S4.SS3.p2.2.m2.1.1.3">16000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.1c">m=16000</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.2.m2.1d">italic_m = 16000</annotation></semantics></math>.
We remark that, although it does not result in additional improvements for the benchmark under consideration, the recurrent patching approach allows processing of even longer context sequences. Indeed, we managed to train until convergence a meta-model with context length <math alttext="m=40000" class="ltx_Math" display="inline" id="S4.SS3.p2.3.m3.1"><semantics id="S4.SS3.p2.3.m3.1a"><mrow id="S4.SS3.p2.3.m3.1.1" xref="S4.SS3.p2.3.m3.1.1.cmml"><mi id="S4.SS3.p2.3.m3.1.1.2" xref="S4.SS3.p2.3.m3.1.1.2.cmml">m</mi><mo id="S4.SS3.p2.3.m3.1.1.1" xref="S4.SS3.p2.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS3.p2.3.m3.1.1.3" xref="S4.SS3.p2.3.m3.1.1.3.cmml">40000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.3.m3.1b"><apply id="S4.SS3.p2.3.m3.1.1.cmml" xref="S4.SS3.p2.3.m3.1.1"><eq id="S4.SS3.p2.3.m3.1.1.1.cmml" xref="S4.SS3.p2.3.m3.1.1.1"></eq><ci id="S4.SS3.p2.3.m3.1.1.2.cmml" xref="S4.SS3.p2.3.m3.1.1.2">𝑚</ci><cn id="S4.SS3.p2.3.m3.1.1.3.cmml" type="integer" xref="S4.SS3.p2.3.m3.1.1.3">40000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.3.m3.1c">m=40000</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.3.m3.1d">italic_m = 40000</annotation></semantics></math>, thus 100 times larger than the baseline <math alttext="m=400" class="ltx_Math" display="inline" id="S4.SS3.p2.4.m4.1"><semantics id="S4.SS3.p2.4.m4.1a"><mrow id="S4.SS3.p2.4.m4.1.1" xref="S4.SS3.p2.4.m4.1.1.cmml"><mi id="S4.SS3.p2.4.m4.1.1.2" xref="S4.SS3.p2.4.m4.1.1.2.cmml">m</mi><mo id="S4.SS3.p2.4.m4.1.1.1" xref="S4.SS3.p2.4.m4.1.1.1.cmml">=</mo><mn id="S4.SS3.p2.4.m4.1.1.3" xref="S4.SS3.p2.4.m4.1.1.3.cmml">400</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.4.m4.1b"><apply id="S4.SS3.p2.4.m4.1.1.cmml" xref="S4.SS3.p2.4.m4.1.1"><eq id="S4.SS3.p2.4.m4.1.1.1.cmml" xref="S4.SS3.p2.4.m4.1.1.1"></eq><ci id="S4.SS3.p2.4.m4.1.1.2.cmml" xref="S4.SS3.p2.4.m4.1.1.2">𝑚</ci><cn id="S4.SS3.p2.4.m4.1.1.3.cmml" type="integer" xref="S4.SS3.p2.4.m4.1.1.3">400</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.4.m4.1c">m=400</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.4.m4.1d">italic_m = 400</annotation></semantics></math> already demonstrated in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#bib.bib11" title="">11</a>]</cite>.
We also note that the <math alttext="\rm RMSE" class="ltx_Math" display="inline" id="S4.SS3.p2.5.m5.1"><semantics id="S4.SS3.p2.5.m5.1a"><mi id="S4.SS3.p2.5.m5.1.1" xref="S4.SS3.p2.5.m5.1.1.cmml">RMSE</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.5.m5.1b"><ci id="S4.SS3.p2.5.m5.1.1.cmml" xref="S4.SS3.p2.5.m5.1.1">RMSE</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.5.m5.1c">\rm RMSE</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.5.m5.1d">roman_RMSE</annotation></semantics></math> of <math alttext="0.128" class="ltx_Math" display="inline" id="S4.SS3.p2.6.m6.1"><semantics id="S4.SS3.p2.6.m6.1a"><mn id="S4.SS3.p2.6.m6.1.1" xref="S4.SS3.p2.6.m6.1.1.cmml">0.128</mn><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.6.m6.1b"><cn id="S4.SS3.p2.6.m6.1.1.cmml" type="float" xref="S4.SS3.p2.6.m6.1.1">0.128</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.6.m6.1c">0.128</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.6.m6.1d">0.128</annotation></semantics></math> achieved with <math alttext="m\geq 16000" class="ltx_Math" display="inline" id="S4.SS3.p2.7.m7.1"><semantics id="S4.SS3.p2.7.m7.1a"><mrow id="S4.SS3.p2.7.m7.1.1" xref="S4.SS3.p2.7.m7.1.1.cmml"><mi id="S4.SS3.p2.7.m7.1.1.2" xref="S4.SS3.p2.7.m7.1.1.2.cmml">m</mi><mo id="S4.SS3.p2.7.m7.1.1.1" xref="S4.SS3.p2.7.m7.1.1.1.cmml">≥</mo><mn id="S4.SS3.p2.7.m7.1.1.3" xref="S4.SS3.p2.7.m7.1.1.3.cmml">16000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.7.m7.1b"><apply id="S4.SS3.p2.7.m7.1.1.cmml" xref="S4.SS3.p2.7.m7.1.1"><geq id="S4.SS3.p2.7.m7.1.1.1.cmml" xref="S4.SS3.p2.7.m7.1.1.1"></geq><ci id="S4.SS3.p2.7.m7.1.1.2.cmml" xref="S4.SS3.p2.7.m7.1.1.2">𝑚</ci><cn id="S4.SS3.p2.7.m7.1.1.3.cmml" type="integer" xref="S4.SS3.p2.7.m7.1.1.3">16000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.7.m7.1c">m\geq 16000</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.7.m7.1d">italic_m ≥ 16000</annotation></semantics></math> is rather close to the noise floor <math alttext="\sigma_{\rm noise}=0.1" class="ltx_Math" display="inline" id="S4.SS3.p2.8.m8.1"><semantics id="S4.SS3.p2.8.m8.1a"><mrow id="S4.SS3.p2.8.m8.1.1" xref="S4.SS3.p2.8.m8.1.1.cmml"><msub id="S4.SS3.p2.8.m8.1.1.2" xref="S4.SS3.p2.8.m8.1.1.2.cmml"><mi id="S4.SS3.p2.8.m8.1.1.2.2" xref="S4.SS3.p2.8.m8.1.1.2.2.cmml">σ</mi><mi id="S4.SS3.p2.8.m8.1.1.2.3" xref="S4.SS3.p2.8.m8.1.1.2.3.cmml">noise</mi></msub><mo id="S4.SS3.p2.8.m8.1.1.1" xref="S4.SS3.p2.8.m8.1.1.1.cmml">=</mo><mn id="S4.SS3.p2.8.m8.1.1.3" xref="S4.SS3.p2.8.m8.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.8.m8.1b"><apply id="S4.SS3.p2.8.m8.1.1.cmml" xref="S4.SS3.p2.8.m8.1.1"><eq id="S4.SS3.p2.8.m8.1.1.1.cmml" xref="S4.SS3.p2.8.m8.1.1.1"></eq><apply id="S4.SS3.p2.8.m8.1.1.2.cmml" xref="S4.SS3.p2.8.m8.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p2.8.m8.1.1.2.1.cmml" xref="S4.SS3.p2.8.m8.1.1.2">subscript</csymbol><ci id="S4.SS3.p2.8.m8.1.1.2.2.cmml" xref="S4.SS3.p2.8.m8.1.1.2.2">𝜎</ci><ci id="S4.SS3.p2.8.m8.1.1.2.3.cmml" xref="S4.SS3.p2.8.m8.1.1.2.3">noise</ci></apply><cn id="S4.SS3.p2.8.m8.1.1.3.cmml" type="float" xref="S4.SS3.p2.8.m8.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.8.m8.1c">\sigma_{\rm noise}=0.1</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.8.m8.1d">italic_σ start_POSTSUBSCRIPT roman_noise end_POSTSUBSCRIPT = 0.1</annotation></semantics></math> induced by the (unpredictable) white Gaussian noise that corrupts the system output.</p>
</div>
<div class="ltx_para" id="S4.SS3.p3">
<p class="ltx_p" id="S4.SS3.p3.9">In Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#S4.F4" title="Figure 4 ‣ 4.3 Results ‣ 4 Numerical Example ‣ Enhanced Transformer architecture for in-context learning of dynamical systems"><span class="ltx_text ltx_ref_tag">4</span></a>, the performance of the trained meta-model is visualized. In the left panel, the true WH outputs <math alttext="\tilde{y}_{n_{in}+1:N}" class="ltx_Math" display="inline" id="S4.SS3.p3.1.m1.1"><semantics id="S4.SS3.p3.1.m1.1a"><msub id="S4.SS3.p3.1.m1.1.1" xref="S4.SS3.p3.1.m1.1.1.cmml"><mover accent="true" id="S4.SS3.p3.1.m1.1.1.2" xref="S4.SS3.p3.1.m1.1.1.2.cmml"><mi id="S4.SS3.p3.1.m1.1.1.2.2" xref="S4.SS3.p3.1.m1.1.1.2.2.cmml">y</mi><mo id="S4.SS3.p3.1.m1.1.1.2.1" xref="S4.SS3.p3.1.m1.1.1.2.1.cmml">~</mo></mover><mrow id="S4.SS3.p3.1.m1.1.1.3" xref="S4.SS3.p3.1.m1.1.1.3.cmml"><mrow id="S4.SS3.p3.1.m1.1.1.3.2" xref="S4.SS3.p3.1.m1.1.1.3.2.cmml"><msub id="S4.SS3.p3.1.m1.1.1.3.2.2" xref="S4.SS3.p3.1.m1.1.1.3.2.2.cmml"><mi id="S4.SS3.p3.1.m1.1.1.3.2.2.2" xref="S4.SS3.p3.1.m1.1.1.3.2.2.2.cmml">n</mi><mrow id="S4.SS3.p3.1.m1.1.1.3.2.2.3" xref="S4.SS3.p3.1.m1.1.1.3.2.2.3.cmml"><mi id="S4.SS3.p3.1.m1.1.1.3.2.2.3.2" xref="S4.SS3.p3.1.m1.1.1.3.2.2.3.2.cmml">i</mi><mo id="S4.SS3.p3.1.m1.1.1.3.2.2.3.1" xref="S4.SS3.p3.1.m1.1.1.3.2.2.3.1.cmml">⁢</mo><mi id="S4.SS3.p3.1.m1.1.1.3.2.2.3.3" xref="S4.SS3.p3.1.m1.1.1.3.2.2.3.3.cmml">n</mi></mrow></msub><mo id="S4.SS3.p3.1.m1.1.1.3.2.1" xref="S4.SS3.p3.1.m1.1.1.3.2.1.cmml">+</mo><mn id="S4.SS3.p3.1.m1.1.1.3.2.3" xref="S4.SS3.p3.1.m1.1.1.3.2.3.cmml">1</mn></mrow><mo id="S4.SS3.p3.1.m1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S4.SS3.p3.1.m1.1.1.3.1.cmml">:</mo><mi id="S4.SS3.p3.1.m1.1.1.3.3" xref="S4.SS3.p3.1.m1.1.1.3.3.cmml">N</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.1.m1.1b"><apply id="S4.SS3.p3.1.m1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.1.m1.1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1">subscript</csymbol><apply id="S4.SS3.p3.1.m1.1.1.2.cmml" xref="S4.SS3.p3.1.m1.1.1.2"><ci id="S4.SS3.p3.1.m1.1.1.2.1.cmml" xref="S4.SS3.p3.1.m1.1.1.2.1">~</ci><ci id="S4.SS3.p3.1.m1.1.1.2.2.cmml" xref="S4.SS3.p3.1.m1.1.1.2.2">𝑦</ci></apply><apply id="S4.SS3.p3.1.m1.1.1.3.cmml" xref="S4.SS3.p3.1.m1.1.1.3"><ci id="S4.SS3.p3.1.m1.1.1.3.1.cmml" xref="S4.SS3.p3.1.m1.1.1.3.1">:</ci><apply id="S4.SS3.p3.1.m1.1.1.3.2.cmml" xref="S4.SS3.p3.1.m1.1.1.3.2"><plus id="S4.SS3.p3.1.m1.1.1.3.2.1.cmml" xref="S4.SS3.p3.1.m1.1.1.3.2.1"></plus><apply id="S4.SS3.p3.1.m1.1.1.3.2.2.cmml" xref="S4.SS3.p3.1.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.SS3.p3.1.m1.1.1.3.2.2.1.cmml" xref="S4.SS3.p3.1.m1.1.1.3.2.2">subscript</csymbol><ci id="S4.SS3.p3.1.m1.1.1.3.2.2.2.cmml" xref="S4.SS3.p3.1.m1.1.1.3.2.2.2">𝑛</ci><apply id="S4.SS3.p3.1.m1.1.1.3.2.2.3.cmml" xref="S4.SS3.p3.1.m1.1.1.3.2.2.3"><times id="S4.SS3.p3.1.m1.1.1.3.2.2.3.1.cmml" xref="S4.SS3.p3.1.m1.1.1.3.2.2.3.1"></times><ci id="S4.SS3.p3.1.m1.1.1.3.2.2.3.2.cmml" xref="S4.SS3.p3.1.m1.1.1.3.2.2.3.2">𝑖</ci><ci id="S4.SS3.p3.1.m1.1.1.3.2.2.3.3.cmml" xref="S4.SS3.p3.1.m1.1.1.3.2.2.3.3">𝑛</ci></apply></apply><cn id="S4.SS3.p3.1.m1.1.1.3.2.3.cmml" type="integer" xref="S4.SS3.p3.1.m1.1.1.3.2.3">1</cn></apply><ci id="S4.SS3.p3.1.m1.1.1.3.3.cmml" xref="S4.SS3.p3.1.m1.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.1.m1.1c">\tilde{y}_{n_{in}+1:N}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.1.m1.1d">over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT + 1 : italic_N end_POSTSUBSCRIPT</annotation></semantics></math> and the simulation errors <math alttext="\tilde{y}_{n_{in}+1:N}-\mu_{n_{in}+1:N}" class="ltx_Math" display="inline" id="S4.SS3.p3.2.m2.1"><semantics id="S4.SS3.p3.2.m2.1a"><mrow id="S4.SS3.p3.2.m2.1.1" xref="S4.SS3.p3.2.m2.1.1.cmml"><msub id="S4.SS3.p3.2.m2.1.1.2" xref="S4.SS3.p3.2.m2.1.1.2.cmml"><mover accent="true" id="S4.SS3.p3.2.m2.1.1.2.2" xref="S4.SS3.p3.2.m2.1.1.2.2.cmml"><mi id="S4.SS3.p3.2.m2.1.1.2.2.2" xref="S4.SS3.p3.2.m2.1.1.2.2.2.cmml">y</mi><mo id="S4.SS3.p3.2.m2.1.1.2.2.1" xref="S4.SS3.p3.2.m2.1.1.2.2.1.cmml">~</mo></mover><mrow id="S4.SS3.p3.2.m2.1.1.2.3" xref="S4.SS3.p3.2.m2.1.1.2.3.cmml"><mrow id="S4.SS3.p3.2.m2.1.1.2.3.2" xref="S4.SS3.p3.2.m2.1.1.2.3.2.cmml"><msub id="S4.SS3.p3.2.m2.1.1.2.3.2.2" xref="S4.SS3.p3.2.m2.1.1.2.3.2.2.cmml"><mi id="S4.SS3.p3.2.m2.1.1.2.3.2.2.2" xref="S4.SS3.p3.2.m2.1.1.2.3.2.2.2.cmml">n</mi><mrow id="S4.SS3.p3.2.m2.1.1.2.3.2.2.3" xref="S4.SS3.p3.2.m2.1.1.2.3.2.2.3.cmml"><mi id="S4.SS3.p3.2.m2.1.1.2.3.2.2.3.2" xref="S4.SS3.p3.2.m2.1.1.2.3.2.2.3.2.cmml">i</mi><mo id="S4.SS3.p3.2.m2.1.1.2.3.2.2.3.1" xref="S4.SS3.p3.2.m2.1.1.2.3.2.2.3.1.cmml">⁢</mo><mi id="S4.SS3.p3.2.m2.1.1.2.3.2.2.3.3" xref="S4.SS3.p3.2.m2.1.1.2.3.2.2.3.3.cmml">n</mi></mrow></msub><mo id="S4.SS3.p3.2.m2.1.1.2.3.2.1" xref="S4.SS3.p3.2.m2.1.1.2.3.2.1.cmml">+</mo><mn id="S4.SS3.p3.2.m2.1.1.2.3.2.3" xref="S4.SS3.p3.2.m2.1.1.2.3.2.3.cmml">1</mn></mrow><mo id="S4.SS3.p3.2.m2.1.1.2.3.1" lspace="0.278em" rspace="0.278em" xref="S4.SS3.p3.2.m2.1.1.2.3.1.cmml">:</mo><mi id="S4.SS3.p3.2.m2.1.1.2.3.3" xref="S4.SS3.p3.2.m2.1.1.2.3.3.cmml">N</mi></mrow></msub><mo id="S4.SS3.p3.2.m2.1.1.1" xref="S4.SS3.p3.2.m2.1.1.1.cmml">−</mo><msub id="S4.SS3.p3.2.m2.1.1.3" xref="S4.SS3.p3.2.m2.1.1.3.cmml"><mi id="S4.SS3.p3.2.m2.1.1.3.2" xref="S4.SS3.p3.2.m2.1.1.3.2.cmml">μ</mi><mrow id="S4.SS3.p3.2.m2.1.1.3.3" xref="S4.SS3.p3.2.m2.1.1.3.3.cmml"><mrow id="S4.SS3.p3.2.m2.1.1.3.3.2" xref="S4.SS3.p3.2.m2.1.1.3.3.2.cmml"><msub id="S4.SS3.p3.2.m2.1.1.3.3.2.2" xref="S4.SS3.p3.2.m2.1.1.3.3.2.2.cmml"><mi id="S4.SS3.p3.2.m2.1.1.3.3.2.2.2" xref="S4.SS3.p3.2.m2.1.1.3.3.2.2.2.cmml">n</mi><mrow id="S4.SS3.p3.2.m2.1.1.3.3.2.2.3" xref="S4.SS3.p3.2.m2.1.1.3.3.2.2.3.cmml"><mi id="S4.SS3.p3.2.m2.1.1.3.3.2.2.3.2" xref="S4.SS3.p3.2.m2.1.1.3.3.2.2.3.2.cmml">i</mi><mo id="S4.SS3.p3.2.m2.1.1.3.3.2.2.3.1" xref="S4.SS3.p3.2.m2.1.1.3.3.2.2.3.1.cmml">⁢</mo><mi id="S4.SS3.p3.2.m2.1.1.3.3.2.2.3.3" xref="S4.SS3.p3.2.m2.1.1.3.3.2.2.3.3.cmml">n</mi></mrow></msub><mo id="S4.SS3.p3.2.m2.1.1.3.3.2.1" xref="S4.SS3.p3.2.m2.1.1.3.3.2.1.cmml">+</mo><mn id="S4.SS3.p3.2.m2.1.1.3.3.2.3" xref="S4.SS3.p3.2.m2.1.1.3.3.2.3.cmml">1</mn></mrow><mo id="S4.SS3.p3.2.m2.1.1.3.3.1" lspace="0.278em" rspace="0.278em" xref="S4.SS3.p3.2.m2.1.1.3.3.1.cmml">:</mo><mi id="S4.SS3.p3.2.m2.1.1.3.3.3" xref="S4.SS3.p3.2.m2.1.1.3.3.3.cmml">N</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.2.m2.1b"><apply id="S4.SS3.p3.2.m2.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1"><minus id="S4.SS3.p3.2.m2.1.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1.1"></minus><apply id="S4.SS3.p3.2.m2.1.1.2.cmml" xref="S4.SS3.p3.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p3.2.m2.1.1.2.1.cmml" xref="S4.SS3.p3.2.m2.1.1.2">subscript</csymbol><apply id="S4.SS3.p3.2.m2.1.1.2.2.cmml" xref="S4.SS3.p3.2.m2.1.1.2.2"><ci id="S4.SS3.p3.2.m2.1.1.2.2.1.cmml" xref="S4.SS3.p3.2.m2.1.1.2.2.1">~</ci><ci id="S4.SS3.p3.2.m2.1.1.2.2.2.cmml" xref="S4.SS3.p3.2.m2.1.1.2.2.2">𝑦</ci></apply><apply id="S4.SS3.p3.2.m2.1.1.2.3.cmml" xref="S4.SS3.p3.2.m2.1.1.2.3"><ci id="S4.SS3.p3.2.m2.1.1.2.3.1.cmml" xref="S4.SS3.p3.2.m2.1.1.2.3.1">:</ci><apply id="S4.SS3.p3.2.m2.1.1.2.3.2.cmml" xref="S4.SS3.p3.2.m2.1.1.2.3.2"><plus id="S4.SS3.p3.2.m2.1.1.2.3.2.1.cmml" xref="S4.SS3.p3.2.m2.1.1.2.3.2.1"></plus><apply id="S4.SS3.p3.2.m2.1.1.2.3.2.2.cmml" xref="S4.SS3.p3.2.m2.1.1.2.3.2.2"><csymbol cd="ambiguous" id="S4.SS3.p3.2.m2.1.1.2.3.2.2.1.cmml" xref="S4.SS3.p3.2.m2.1.1.2.3.2.2">subscript</csymbol><ci id="S4.SS3.p3.2.m2.1.1.2.3.2.2.2.cmml" xref="S4.SS3.p3.2.m2.1.1.2.3.2.2.2">𝑛</ci><apply id="S4.SS3.p3.2.m2.1.1.2.3.2.2.3.cmml" xref="S4.SS3.p3.2.m2.1.1.2.3.2.2.3"><times id="S4.SS3.p3.2.m2.1.1.2.3.2.2.3.1.cmml" xref="S4.SS3.p3.2.m2.1.1.2.3.2.2.3.1"></times><ci id="S4.SS3.p3.2.m2.1.1.2.3.2.2.3.2.cmml" xref="S4.SS3.p3.2.m2.1.1.2.3.2.2.3.2">𝑖</ci><ci id="S4.SS3.p3.2.m2.1.1.2.3.2.2.3.3.cmml" xref="S4.SS3.p3.2.m2.1.1.2.3.2.2.3.3">𝑛</ci></apply></apply><cn id="S4.SS3.p3.2.m2.1.1.2.3.2.3.cmml" type="integer" xref="S4.SS3.p3.2.m2.1.1.2.3.2.3">1</cn></apply><ci id="S4.SS3.p3.2.m2.1.1.2.3.3.cmml" xref="S4.SS3.p3.2.m2.1.1.2.3.3">𝑁</ci></apply></apply><apply id="S4.SS3.p3.2.m2.1.1.3.cmml" xref="S4.SS3.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p3.2.m2.1.1.3.1.cmml" xref="S4.SS3.p3.2.m2.1.1.3">subscript</csymbol><ci id="S4.SS3.p3.2.m2.1.1.3.2.cmml" xref="S4.SS3.p3.2.m2.1.1.3.2">𝜇</ci><apply id="S4.SS3.p3.2.m2.1.1.3.3.cmml" xref="S4.SS3.p3.2.m2.1.1.3.3"><ci id="S4.SS3.p3.2.m2.1.1.3.3.1.cmml" xref="S4.SS3.p3.2.m2.1.1.3.3.1">:</ci><apply id="S4.SS3.p3.2.m2.1.1.3.3.2.cmml" xref="S4.SS3.p3.2.m2.1.1.3.3.2"><plus id="S4.SS3.p3.2.m2.1.1.3.3.2.1.cmml" xref="S4.SS3.p3.2.m2.1.1.3.3.2.1"></plus><apply id="S4.SS3.p3.2.m2.1.1.3.3.2.2.cmml" xref="S4.SS3.p3.2.m2.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS3.p3.2.m2.1.1.3.3.2.2.1.cmml" xref="S4.SS3.p3.2.m2.1.1.3.3.2.2">subscript</csymbol><ci id="S4.SS3.p3.2.m2.1.1.3.3.2.2.2.cmml" xref="S4.SS3.p3.2.m2.1.1.3.3.2.2.2">𝑛</ci><apply id="S4.SS3.p3.2.m2.1.1.3.3.2.2.3.cmml" xref="S4.SS3.p3.2.m2.1.1.3.3.2.2.3"><times id="S4.SS3.p3.2.m2.1.1.3.3.2.2.3.1.cmml" xref="S4.SS3.p3.2.m2.1.1.3.3.2.2.3.1"></times><ci id="S4.SS3.p3.2.m2.1.1.3.3.2.2.3.2.cmml" xref="S4.SS3.p3.2.m2.1.1.3.3.2.2.3.2">𝑖</ci><ci id="S4.SS3.p3.2.m2.1.1.3.3.2.2.3.3.cmml" xref="S4.SS3.p3.2.m2.1.1.3.3.2.2.3.3">𝑛</ci></apply></apply><cn id="S4.SS3.p3.2.m2.1.1.3.3.2.3.cmml" type="integer" xref="S4.SS3.p3.2.m2.1.1.3.3.2.3">1</cn></apply><ci id="S4.SS3.p3.2.m2.1.1.3.3.3.cmml" xref="S4.SS3.p3.2.m2.1.1.3.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.2.m2.1c">\tilde{y}_{n_{in}+1:N}-\mu_{n_{in}+1:N}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.2.m2.1d">over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT + 1 : italic_N end_POSTSUBSCRIPT - italic_μ start_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT + 1 : italic_N end_POSTSUBSCRIPT</annotation></semantics></math> obtained by the Transformer trained with <math alttext="m=16000" class="ltx_Math" display="inline" id="S4.SS3.p3.3.m3.1"><semantics id="S4.SS3.p3.3.m3.1a"><mrow id="S4.SS3.p3.3.m3.1.1" xref="S4.SS3.p3.3.m3.1.1.cmml"><mi id="S4.SS3.p3.3.m3.1.1.2" xref="S4.SS3.p3.3.m3.1.1.2.cmml">m</mi><mo id="S4.SS3.p3.3.m3.1.1.1" xref="S4.SS3.p3.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS3.p3.3.m3.1.1.3" xref="S4.SS3.p3.3.m3.1.1.3.cmml">16000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.3.m3.1b"><apply id="S4.SS3.p3.3.m3.1.1.cmml" xref="S4.SS3.p3.3.m3.1.1"><eq id="S4.SS3.p3.3.m3.1.1.1.cmml" xref="S4.SS3.p3.3.m3.1.1.1"></eq><ci id="S4.SS3.p3.3.m3.1.1.2.cmml" xref="S4.SS3.p3.3.m3.1.1.2">𝑚</ci><cn id="S4.SS3.p3.3.m3.1.1.3.cmml" type="integer" xref="S4.SS3.p3.3.m3.1.1.3">16000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.3.m3.1c">m=16000</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.3.m3.1d">italic_m = 16000</annotation></semantics></math> over 256 randomly extracted WH systems are shown. In the right panel, for a particular WH realization, the output <math alttext="y_{n_{in}+1:N}" class="ltx_Math" display="inline" id="S4.SS3.p3.4.m4.1"><semantics id="S4.SS3.p3.4.m4.1a"><msub id="S4.SS3.p3.4.m4.1.1" xref="S4.SS3.p3.4.m4.1.1.cmml"><mi id="S4.SS3.p3.4.m4.1.1.2" xref="S4.SS3.p3.4.m4.1.1.2.cmml">y</mi><mrow id="S4.SS3.p3.4.m4.1.1.3" xref="S4.SS3.p3.4.m4.1.1.3.cmml"><mrow id="S4.SS3.p3.4.m4.1.1.3.2" xref="S4.SS3.p3.4.m4.1.1.3.2.cmml"><msub id="S4.SS3.p3.4.m4.1.1.3.2.2" xref="S4.SS3.p3.4.m4.1.1.3.2.2.cmml"><mi id="S4.SS3.p3.4.m4.1.1.3.2.2.2" xref="S4.SS3.p3.4.m4.1.1.3.2.2.2.cmml">n</mi><mrow id="S4.SS3.p3.4.m4.1.1.3.2.2.3" xref="S4.SS3.p3.4.m4.1.1.3.2.2.3.cmml"><mi id="S4.SS3.p3.4.m4.1.1.3.2.2.3.2" xref="S4.SS3.p3.4.m4.1.1.3.2.2.3.2.cmml">i</mi><mo id="S4.SS3.p3.4.m4.1.1.3.2.2.3.1" xref="S4.SS3.p3.4.m4.1.1.3.2.2.3.1.cmml">⁢</mo><mi id="S4.SS3.p3.4.m4.1.1.3.2.2.3.3" xref="S4.SS3.p3.4.m4.1.1.3.2.2.3.3.cmml">n</mi></mrow></msub><mo id="S4.SS3.p3.4.m4.1.1.3.2.1" xref="S4.SS3.p3.4.m4.1.1.3.2.1.cmml">+</mo><mn id="S4.SS3.p3.4.m4.1.1.3.2.3" xref="S4.SS3.p3.4.m4.1.1.3.2.3.cmml">1</mn></mrow><mo id="S4.SS3.p3.4.m4.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S4.SS3.p3.4.m4.1.1.3.1.cmml">:</mo><mi id="S4.SS3.p3.4.m4.1.1.3.3" xref="S4.SS3.p3.4.m4.1.1.3.3.cmml">N</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.4.m4.1b"><apply id="S4.SS3.p3.4.m4.1.1.cmml" xref="S4.SS3.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.4.m4.1.1.1.cmml" xref="S4.SS3.p3.4.m4.1.1">subscript</csymbol><ci id="S4.SS3.p3.4.m4.1.1.2.cmml" xref="S4.SS3.p3.4.m4.1.1.2">𝑦</ci><apply id="S4.SS3.p3.4.m4.1.1.3.cmml" xref="S4.SS3.p3.4.m4.1.1.3"><ci id="S4.SS3.p3.4.m4.1.1.3.1.cmml" xref="S4.SS3.p3.4.m4.1.1.3.1">:</ci><apply id="S4.SS3.p3.4.m4.1.1.3.2.cmml" xref="S4.SS3.p3.4.m4.1.1.3.2"><plus id="S4.SS3.p3.4.m4.1.1.3.2.1.cmml" xref="S4.SS3.p3.4.m4.1.1.3.2.1"></plus><apply id="S4.SS3.p3.4.m4.1.1.3.2.2.cmml" xref="S4.SS3.p3.4.m4.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.SS3.p3.4.m4.1.1.3.2.2.1.cmml" xref="S4.SS3.p3.4.m4.1.1.3.2.2">subscript</csymbol><ci id="S4.SS3.p3.4.m4.1.1.3.2.2.2.cmml" xref="S4.SS3.p3.4.m4.1.1.3.2.2.2">𝑛</ci><apply id="S4.SS3.p3.4.m4.1.1.3.2.2.3.cmml" xref="S4.SS3.p3.4.m4.1.1.3.2.2.3"><times id="S4.SS3.p3.4.m4.1.1.3.2.2.3.1.cmml" xref="S4.SS3.p3.4.m4.1.1.3.2.2.3.1"></times><ci id="S4.SS3.p3.4.m4.1.1.3.2.2.3.2.cmml" xref="S4.SS3.p3.4.m4.1.1.3.2.2.3.2">𝑖</ci><ci id="S4.SS3.p3.4.m4.1.1.3.2.2.3.3.cmml" xref="S4.SS3.p3.4.m4.1.1.3.2.2.3.3">𝑛</ci></apply></apply><cn id="S4.SS3.p3.4.m4.1.1.3.2.3.cmml" type="integer" xref="S4.SS3.p3.4.m4.1.1.3.2.3">1</cn></apply><ci id="S4.SS3.p3.4.m4.1.1.3.3.cmml" xref="S4.SS3.p3.4.m4.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.4.m4.1c">y_{n_{in}+1:N}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.4.m4.1d">italic_y start_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT + 1 : italic_N end_POSTSUBSCRIPT</annotation></semantics></math>, the output mean <math alttext="\mu_{n_{in}+1:N}" class="ltx_Math" display="inline" id="S4.SS3.p3.5.m5.1"><semantics id="S4.SS3.p3.5.m5.1a"><msub id="S4.SS3.p3.5.m5.1.1" xref="S4.SS3.p3.5.m5.1.1.cmml"><mi id="S4.SS3.p3.5.m5.1.1.2" xref="S4.SS3.p3.5.m5.1.1.2.cmml">μ</mi><mrow id="S4.SS3.p3.5.m5.1.1.3" xref="S4.SS3.p3.5.m5.1.1.3.cmml"><mrow id="S4.SS3.p3.5.m5.1.1.3.2" xref="S4.SS3.p3.5.m5.1.1.3.2.cmml"><msub id="S4.SS3.p3.5.m5.1.1.3.2.2" xref="S4.SS3.p3.5.m5.1.1.3.2.2.cmml"><mi id="S4.SS3.p3.5.m5.1.1.3.2.2.2" xref="S4.SS3.p3.5.m5.1.1.3.2.2.2.cmml">n</mi><mrow id="S4.SS3.p3.5.m5.1.1.3.2.2.3" xref="S4.SS3.p3.5.m5.1.1.3.2.2.3.cmml"><mi id="S4.SS3.p3.5.m5.1.1.3.2.2.3.2" xref="S4.SS3.p3.5.m5.1.1.3.2.2.3.2.cmml">i</mi><mo id="S4.SS3.p3.5.m5.1.1.3.2.2.3.1" xref="S4.SS3.p3.5.m5.1.1.3.2.2.3.1.cmml">⁢</mo><mi id="S4.SS3.p3.5.m5.1.1.3.2.2.3.3" xref="S4.SS3.p3.5.m5.1.1.3.2.2.3.3.cmml">n</mi></mrow></msub><mo id="S4.SS3.p3.5.m5.1.1.3.2.1" xref="S4.SS3.p3.5.m5.1.1.3.2.1.cmml">+</mo><mn id="S4.SS3.p3.5.m5.1.1.3.2.3" xref="S4.SS3.p3.5.m5.1.1.3.2.3.cmml">1</mn></mrow><mo id="S4.SS3.p3.5.m5.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S4.SS3.p3.5.m5.1.1.3.1.cmml">:</mo><mi id="S4.SS3.p3.5.m5.1.1.3.3" xref="S4.SS3.p3.5.m5.1.1.3.3.cmml">N</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.5.m5.1b"><apply id="S4.SS3.p3.5.m5.1.1.cmml" xref="S4.SS3.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.5.m5.1.1.1.cmml" xref="S4.SS3.p3.5.m5.1.1">subscript</csymbol><ci id="S4.SS3.p3.5.m5.1.1.2.cmml" xref="S4.SS3.p3.5.m5.1.1.2">𝜇</ci><apply id="S4.SS3.p3.5.m5.1.1.3.cmml" xref="S4.SS3.p3.5.m5.1.1.3"><ci id="S4.SS3.p3.5.m5.1.1.3.1.cmml" xref="S4.SS3.p3.5.m5.1.1.3.1">:</ci><apply id="S4.SS3.p3.5.m5.1.1.3.2.cmml" xref="S4.SS3.p3.5.m5.1.1.3.2"><plus id="S4.SS3.p3.5.m5.1.1.3.2.1.cmml" xref="S4.SS3.p3.5.m5.1.1.3.2.1"></plus><apply id="S4.SS3.p3.5.m5.1.1.3.2.2.cmml" xref="S4.SS3.p3.5.m5.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.SS3.p3.5.m5.1.1.3.2.2.1.cmml" xref="S4.SS3.p3.5.m5.1.1.3.2.2">subscript</csymbol><ci id="S4.SS3.p3.5.m5.1.1.3.2.2.2.cmml" xref="S4.SS3.p3.5.m5.1.1.3.2.2.2">𝑛</ci><apply id="S4.SS3.p3.5.m5.1.1.3.2.2.3.cmml" xref="S4.SS3.p3.5.m5.1.1.3.2.2.3"><times id="S4.SS3.p3.5.m5.1.1.3.2.2.3.1.cmml" xref="S4.SS3.p3.5.m5.1.1.3.2.2.3.1"></times><ci id="S4.SS3.p3.5.m5.1.1.3.2.2.3.2.cmml" xref="S4.SS3.p3.5.m5.1.1.3.2.2.3.2">𝑖</ci><ci id="S4.SS3.p3.5.m5.1.1.3.2.2.3.3.cmml" xref="S4.SS3.p3.5.m5.1.1.3.2.2.3.3">𝑛</ci></apply></apply><cn id="S4.SS3.p3.5.m5.1.1.3.2.3.cmml" type="integer" xref="S4.SS3.p3.5.m5.1.1.3.2.3">1</cn></apply><ci id="S4.SS3.p3.5.m5.1.1.3.3.cmml" xref="S4.SS3.p3.5.m5.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.5.m5.1c">\mu_{n_{in}+1:N}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.5.m5.1d">italic_μ start_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT + 1 : italic_N end_POSTSUBSCRIPT</annotation></semantics></math> predicted by the Transformer, and the prediction error <math alttext="\tilde{y}_{n_{in}+1:N}-\mu_{n_{in}+1:N}" class="ltx_Math" display="inline" id="S4.SS3.p3.6.m6.1"><semantics id="S4.SS3.p3.6.m6.1a"><mrow id="S4.SS3.p3.6.m6.1.1" xref="S4.SS3.p3.6.m6.1.1.cmml"><msub id="S4.SS3.p3.6.m6.1.1.2" xref="S4.SS3.p3.6.m6.1.1.2.cmml"><mover accent="true" id="S4.SS3.p3.6.m6.1.1.2.2" xref="S4.SS3.p3.6.m6.1.1.2.2.cmml"><mi id="S4.SS3.p3.6.m6.1.1.2.2.2" xref="S4.SS3.p3.6.m6.1.1.2.2.2.cmml">y</mi><mo id="S4.SS3.p3.6.m6.1.1.2.2.1" xref="S4.SS3.p3.6.m6.1.1.2.2.1.cmml">~</mo></mover><mrow id="S4.SS3.p3.6.m6.1.1.2.3" xref="S4.SS3.p3.6.m6.1.1.2.3.cmml"><mrow id="S4.SS3.p3.6.m6.1.1.2.3.2" xref="S4.SS3.p3.6.m6.1.1.2.3.2.cmml"><msub id="S4.SS3.p3.6.m6.1.1.2.3.2.2" xref="S4.SS3.p3.6.m6.1.1.2.3.2.2.cmml"><mi id="S4.SS3.p3.6.m6.1.1.2.3.2.2.2" xref="S4.SS3.p3.6.m6.1.1.2.3.2.2.2.cmml">n</mi><mrow id="S4.SS3.p3.6.m6.1.1.2.3.2.2.3" xref="S4.SS3.p3.6.m6.1.1.2.3.2.2.3.cmml"><mi id="S4.SS3.p3.6.m6.1.1.2.3.2.2.3.2" xref="S4.SS3.p3.6.m6.1.1.2.3.2.2.3.2.cmml">i</mi><mo id="S4.SS3.p3.6.m6.1.1.2.3.2.2.3.1" xref="S4.SS3.p3.6.m6.1.1.2.3.2.2.3.1.cmml">⁢</mo><mi id="S4.SS3.p3.6.m6.1.1.2.3.2.2.3.3" xref="S4.SS3.p3.6.m6.1.1.2.3.2.2.3.3.cmml">n</mi></mrow></msub><mo id="S4.SS3.p3.6.m6.1.1.2.3.2.1" xref="S4.SS3.p3.6.m6.1.1.2.3.2.1.cmml">+</mo><mn id="S4.SS3.p3.6.m6.1.1.2.3.2.3" xref="S4.SS3.p3.6.m6.1.1.2.3.2.3.cmml">1</mn></mrow><mo id="S4.SS3.p3.6.m6.1.1.2.3.1" lspace="0.278em" rspace="0.278em" xref="S4.SS3.p3.6.m6.1.1.2.3.1.cmml">:</mo><mi id="S4.SS3.p3.6.m6.1.1.2.3.3" xref="S4.SS3.p3.6.m6.1.1.2.3.3.cmml">N</mi></mrow></msub><mo id="S4.SS3.p3.6.m6.1.1.1" xref="S4.SS3.p3.6.m6.1.1.1.cmml">−</mo><msub id="S4.SS3.p3.6.m6.1.1.3" xref="S4.SS3.p3.6.m6.1.1.3.cmml"><mi id="S4.SS3.p3.6.m6.1.1.3.2" xref="S4.SS3.p3.6.m6.1.1.3.2.cmml">μ</mi><mrow id="S4.SS3.p3.6.m6.1.1.3.3" xref="S4.SS3.p3.6.m6.1.1.3.3.cmml"><mrow id="S4.SS3.p3.6.m6.1.1.3.3.2" xref="S4.SS3.p3.6.m6.1.1.3.3.2.cmml"><msub id="S4.SS3.p3.6.m6.1.1.3.3.2.2" xref="S4.SS3.p3.6.m6.1.1.3.3.2.2.cmml"><mi id="S4.SS3.p3.6.m6.1.1.3.3.2.2.2" xref="S4.SS3.p3.6.m6.1.1.3.3.2.2.2.cmml">n</mi><mrow id="S4.SS3.p3.6.m6.1.1.3.3.2.2.3" xref="S4.SS3.p3.6.m6.1.1.3.3.2.2.3.cmml"><mi id="S4.SS3.p3.6.m6.1.1.3.3.2.2.3.2" xref="S4.SS3.p3.6.m6.1.1.3.3.2.2.3.2.cmml">i</mi><mo id="S4.SS3.p3.6.m6.1.1.3.3.2.2.3.1" xref="S4.SS3.p3.6.m6.1.1.3.3.2.2.3.1.cmml">⁢</mo><mi id="S4.SS3.p3.6.m6.1.1.3.3.2.2.3.3" xref="S4.SS3.p3.6.m6.1.1.3.3.2.2.3.3.cmml">n</mi></mrow></msub><mo id="S4.SS3.p3.6.m6.1.1.3.3.2.1" xref="S4.SS3.p3.6.m6.1.1.3.3.2.1.cmml">+</mo><mn id="S4.SS3.p3.6.m6.1.1.3.3.2.3" xref="S4.SS3.p3.6.m6.1.1.3.3.2.3.cmml">1</mn></mrow><mo id="S4.SS3.p3.6.m6.1.1.3.3.1" lspace="0.278em" rspace="0.278em" xref="S4.SS3.p3.6.m6.1.1.3.3.1.cmml">:</mo><mi id="S4.SS3.p3.6.m6.1.1.3.3.3" xref="S4.SS3.p3.6.m6.1.1.3.3.3.cmml">N</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.6.m6.1b"><apply id="S4.SS3.p3.6.m6.1.1.cmml" xref="S4.SS3.p3.6.m6.1.1"><minus id="S4.SS3.p3.6.m6.1.1.1.cmml" xref="S4.SS3.p3.6.m6.1.1.1"></minus><apply id="S4.SS3.p3.6.m6.1.1.2.cmml" xref="S4.SS3.p3.6.m6.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p3.6.m6.1.1.2.1.cmml" xref="S4.SS3.p3.6.m6.1.1.2">subscript</csymbol><apply id="S4.SS3.p3.6.m6.1.1.2.2.cmml" xref="S4.SS3.p3.6.m6.1.1.2.2"><ci id="S4.SS3.p3.6.m6.1.1.2.2.1.cmml" xref="S4.SS3.p3.6.m6.1.1.2.2.1">~</ci><ci id="S4.SS3.p3.6.m6.1.1.2.2.2.cmml" xref="S4.SS3.p3.6.m6.1.1.2.2.2">𝑦</ci></apply><apply id="S4.SS3.p3.6.m6.1.1.2.3.cmml" xref="S4.SS3.p3.6.m6.1.1.2.3"><ci id="S4.SS3.p3.6.m6.1.1.2.3.1.cmml" xref="S4.SS3.p3.6.m6.1.1.2.3.1">:</ci><apply id="S4.SS3.p3.6.m6.1.1.2.3.2.cmml" xref="S4.SS3.p3.6.m6.1.1.2.3.2"><plus id="S4.SS3.p3.6.m6.1.1.2.3.2.1.cmml" xref="S4.SS3.p3.6.m6.1.1.2.3.2.1"></plus><apply id="S4.SS3.p3.6.m6.1.1.2.3.2.2.cmml" xref="S4.SS3.p3.6.m6.1.1.2.3.2.2"><csymbol cd="ambiguous" id="S4.SS3.p3.6.m6.1.1.2.3.2.2.1.cmml" xref="S4.SS3.p3.6.m6.1.1.2.3.2.2">subscript</csymbol><ci id="S4.SS3.p3.6.m6.1.1.2.3.2.2.2.cmml" xref="S4.SS3.p3.6.m6.1.1.2.3.2.2.2">𝑛</ci><apply id="S4.SS3.p3.6.m6.1.1.2.3.2.2.3.cmml" xref="S4.SS3.p3.6.m6.1.1.2.3.2.2.3"><times id="S4.SS3.p3.6.m6.1.1.2.3.2.2.3.1.cmml" xref="S4.SS3.p3.6.m6.1.1.2.3.2.2.3.1"></times><ci id="S4.SS3.p3.6.m6.1.1.2.3.2.2.3.2.cmml" xref="S4.SS3.p3.6.m6.1.1.2.3.2.2.3.2">𝑖</ci><ci id="S4.SS3.p3.6.m6.1.1.2.3.2.2.3.3.cmml" xref="S4.SS3.p3.6.m6.1.1.2.3.2.2.3.3">𝑛</ci></apply></apply><cn id="S4.SS3.p3.6.m6.1.1.2.3.2.3.cmml" type="integer" xref="S4.SS3.p3.6.m6.1.1.2.3.2.3">1</cn></apply><ci id="S4.SS3.p3.6.m6.1.1.2.3.3.cmml" xref="S4.SS3.p3.6.m6.1.1.2.3.3">𝑁</ci></apply></apply><apply id="S4.SS3.p3.6.m6.1.1.3.cmml" xref="S4.SS3.p3.6.m6.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p3.6.m6.1.1.3.1.cmml" xref="S4.SS3.p3.6.m6.1.1.3">subscript</csymbol><ci id="S4.SS3.p3.6.m6.1.1.3.2.cmml" xref="S4.SS3.p3.6.m6.1.1.3.2">𝜇</ci><apply id="S4.SS3.p3.6.m6.1.1.3.3.cmml" xref="S4.SS3.p3.6.m6.1.1.3.3"><ci id="S4.SS3.p3.6.m6.1.1.3.3.1.cmml" xref="S4.SS3.p3.6.m6.1.1.3.3.1">:</ci><apply id="S4.SS3.p3.6.m6.1.1.3.3.2.cmml" xref="S4.SS3.p3.6.m6.1.1.3.3.2"><plus id="S4.SS3.p3.6.m6.1.1.3.3.2.1.cmml" xref="S4.SS3.p3.6.m6.1.1.3.3.2.1"></plus><apply id="S4.SS3.p3.6.m6.1.1.3.3.2.2.cmml" xref="S4.SS3.p3.6.m6.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS3.p3.6.m6.1.1.3.3.2.2.1.cmml" xref="S4.SS3.p3.6.m6.1.1.3.3.2.2">subscript</csymbol><ci id="S4.SS3.p3.6.m6.1.1.3.3.2.2.2.cmml" xref="S4.SS3.p3.6.m6.1.1.3.3.2.2.2">𝑛</ci><apply id="S4.SS3.p3.6.m6.1.1.3.3.2.2.3.cmml" xref="S4.SS3.p3.6.m6.1.1.3.3.2.2.3"><times id="S4.SS3.p3.6.m6.1.1.3.3.2.2.3.1.cmml" xref="S4.SS3.p3.6.m6.1.1.3.3.2.2.3.1"></times><ci id="S4.SS3.p3.6.m6.1.1.3.3.2.2.3.2.cmml" xref="S4.SS3.p3.6.m6.1.1.3.3.2.2.3.2">𝑖</ci><ci id="S4.SS3.p3.6.m6.1.1.3.3.2.2.3.3.cmml" xref="S4.SS3.p3.6.m6.1.1.3.3.2.2.3.3">𝑛</ci></apply></apply><cn id="S4.SS3.p3.6.m6.1.1.3.3.2.3.cmml" type="integer" xref="S4.SS3.p3.6.m6.1.1.3.3.2.3">1</cn></apply><ci id="S4.SS3.p3.6.m6.1.1.3.3.3.cmml" xref="S4.SS3.p3.6.m6.1.1.3.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.6.m6.1c">\tilde{y}_{n_{in}+1:N}-\mu_{n_{in}+1:N}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.6.m6.1d">over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT + 1 : italic_N end_POSTSUBSCRIPT - italic_μ start_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT + 1 : italic_N end_POSTSUBSCRIPT</annotation></semantics></math> are shown.
Moreover, the <math alttext="95\%" class="ltx_Math" display="inline" id="S4.SS3.p3.7.m7.1"><semantics id="S4.SS3.p3.7.m7.1a"><mrow id="S4.SS3.p3.7.m7.1.1" xref="S4.SS3.p3.7.m7.1.1.cmml"><mn id="S4.SS3.p3.7.m7.1.1.2" xref="S4.SS3.p3.7.m7.1.1.2.cmml">95</mn><mo id="S4.SS3.p3.7.m7.1.1.1" xref="S4.SS3.p3.7.m7.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.7.m7.1b"><apply id="S4.SS3.p3.7.m7.1.1.cmml" xref="S4.SS3.p3.7.m7.1.1"><csymbol cd="latexml" id="S4.SS3.p3.7.m7.1.1.1.cmml" xref="S4.SS3.p3.7.m7.1.1.1">percent</csymbol><cn id="S4.SS3.p3.7.m7.1.1.2.cmml" type="integer" xref="S4.SS3.p3.7.m7.1.1.2">95</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.7.m7.1c">95\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.7.m7.1d">95 %</annotation></semantics></math> credible interval of the prediction computed as <math alttext="\mu_{n_{in}+1:N}\pm 3\sigma_{n_{in}+1:N}" class="ltx_Math" display="inline" id="S4.SS3.p3.8.m8.1"><semantics id="S4.SS3.p3.8.m8.1a"><mrow id="S4.SS3.p3.8.m8.1.1" xref="S4.SS3.p3.8.m8.1.1.cmml"><msub id="S4.SS3.p3.8.m8.1.1.2" xref="S4.SS3.p3.8.m8.1.1.2.cmml"><mi id="S4.SS3.p3.8.m8.1.1.2.2" xref="S4.SS3.p3.8.m8.1.1.2.2.cmml">μ</mi><mrow id="S4.SS3.p3.8.m8.1.1.2.3" xref="S4.SS3.p3.8.m8.1.1.2.3.cmml"><mrow id="S4.SS3.p3.8.m8.1.1.2.3.2" xref="S4.SS3.p3.8.m8.1.1.2.3.2.cmml"><msub id="S4.SS3.p3.8.m8.1.1.2.3.2.2" xref="S4.SS3.p3.8.m8.1.1.2.3.2.2.cmml"><mi id="S4.SS3.p3.8.m8.1.1.2.3.2.2.2" xref="S4.SS3.p3.8.m8.1.1.2.3.2.2.2.cmml">n</mi><mrow id="S4.SS3.p3.8.m8.1.1.2.3.2.2.3" xref="S4.SS3.p3.8.m8.1.1.2.3.2.2.3.cmml"><mi id="S4.SS3.p3.8.m8.1.1.2.3.2.2.3.2" xref="S4.SS3.p3.8.m8.1.1.2.3.2.2.3.2.cmml">i</mi><mo id="S4.SS3.p3.8.m8.1.1.2.3.2.2.3.1" xref="S4.SS3.p3.8.m8.1.1.2.3.2.2.3.1.cmml">⁢</mo><mi id="S4.SS3.p3.8.m8.1.1.2.3.2.2.3.3" xref="S4.SS3.p3.8.m8.1.1.2.3.2.2.3.3.cmml">n</mi></mrow></msub><mo id="S4.SS3.p3.8.m8.1.1.2.3.2.1" xref="S4.SS3.p3.8.m8.1.1.2.3.2.1.cmml">+</mo><mn id="S4.SS3.p3.8.m8.1.1.2.3.2.3" xref="S4.SS3.p3.8.m8.1.1.2.3.2.3.cmml">1</mn></mrow><mo id="S4.SS3.p3.8.m8.1.1.2.3.1" lspace="0.278em" rspace="0.278em" xref="S4.SS3.p3.8.m8.1.1.2.3.1.cmml">:</mo><mi id="S4.SS3.p3.8.m8.1.1.2.3.3" xref="S4.SS3.p3.8.m8.1.1.2.3.3.cmml">N</mi></mrow></msub><mo id="S4.SS3.p3.8.m8.1.1.1" xref="S4.SS3.p3.8.m8.1.1.1.cmml">±</mo><mrow id="S4.SS3.p3.8.m8.1.1.3" xref="S4.SS3.p3.8.m8.1.1.3.cmml"><mn id="S4.SS3.p3.8.m8.1.1.3.2" xref="S4.SS3.p3.8.m8.1.1.3.2.cmml">3</mn><mo id="S4.SS3.p3.8.m8.1.1.3.1" xref="S4.SS3.p3.8.m8.1.1.3.1.cmml">⁢</mo><msub id="S4.SS3.p3.8.m8.1.1.3.3" xref="S4.SS3.p3.8.m8.1.1.3.3.cmml"><mi id="S4.SS3.p3.8.m8.1.1.3.3.2" xref="S4.SS3.p3.8.m8.1.1.3.3.2.cmml">σ</mi><mrow id="S4.SS3.p3.8.m8.1.1.3.3.3" xref="S4.SS3.p3.8.m8.1.1.3.3.3.cmml"><mrow id="S4.SS3.p3.8.m8.1.1.3.3.3.2" xref="S4.SS3.p3.8.m8.1.1.3.3.3.2.cmml"><msub id="S4.SS3.p3.8.m8.1.1.3.3.3.2.2" xref="S4.SS3.p3.8.m8.1.1.3.3.3.2.2.cmml"><mi id="S4.SS3.p3.8.m8.1.1.3.3.3.2.2.2" xref="S4.SS3.p3.8.m8.1.1.3.3.3.2.2.2.cmml">n</mi><mrow id="S4.SS3.p3.8.m8.1.1.3.3.3.2.2.3" xref="S4.SS3.p3.8.m8.1.1.3.3.3.2.2.3.cmml"><mi id="S4.SS3.p3.8.m8.1.1.3.3.3.2.2.3.2" xref="S4.SS3.p3.8.m8.1.1.3.3.3.2.2.3.2.cmml">i</mi><mo id="S4.SS3.p3.8.m8.1.1.3.3.3.2.2.3.1" xref="S4.SS3.p3.8.m8.1.1.3.3.3.2.2.3.1.cmml">⁢</mo><mi id="S4.SS3.p3.8.m8.1.1.3.3.3.2.2.3.3" xref="S4.SS3.p3.8.m8.1.1.3.3.3.2.2.3.3.cmml">n</mi></mrow></msub><mo id="S4.SS3.p3.8.m8.1.1.3.3.3.2.1" xref="S4.SS3.p3.8.m8.1.1.3.3.3.2.1.cmml">+</mo><mn id="S4.SS3.p3.8.m8.1.1.3.3.3.2.3" xref="S4.SS3.p3.8.m8.1.1.3.3.3.2.3.cmml">1</mn></mrow><mo id="S4.SS3.p3.8.m8.1.1.3.3.3.1" lspace="0.278em" rspace="0.278em" xref="S4.SS3.p3.8.m8.1.1.3.3.3.1.cmml">:</mo><mi id="S4.SS3.p3.8.m8.1.1.3.3.3.3" xref="S4.SS3.p3.8.m8.1.1.3.3.3.3.cmml">N</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.8.m8.1b"><apply id="S4.SS3.p3.8.m8.1.1.cmml" xref="S4.SS3.p3.8.m8.1.1"><csymbol cd="latexml" id="S4.SS3.p3.8.m8.1.1.1.cmml" xref="S4.SS3.p3.8.m8.1.1.1">plus-or-minus</csymbol><apply id="S4.SS3.p3.8.m8.1.1.2.cmml" xref="S4.SS3.p3.8.m8.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p3.8.m8.1.1.2.1.cmml" xref="S4.SS3.p3.8.m8.1.1.2">subscript</csymbol><ci id="S4.SS3.p3.8.m8.1.1.2.2.cmml" xref="S4.SS3.p3.8.m8.1.1.2.2">𝜇</ci><apply id="S4.SS3.p3.8.m8.1.1.2.3.cmml" xref="S4.SS3.p3.8.m8.1.1.2.3"><ci id="S4.SS3.p3.8.m8.1.1.2.3.1.cmml" xref="S4.SS3.p3.8.m8.1.1.2.3.1">:</ci><apply id="S4.SS3.p3.8.m8.1.1.2.3.2.cmml" xref="S4.SS3.p3.8.m8.1.1.2.3.2"><plus id="S4.SS3.p3.8.m8.1.1.2.3.2.1.cmml" xref="S4.SS3.p3.8.m8.1.1.2.3.2.1"></plus><apply id="S4.SS3.p3.8.m8.1.1.2.3.2.2.cmml" xref="S4.SS3.p3.8.m8.1.1.2.3.2.2"><csymbol cd="ambiguous" id="S4.SS3.p3.8.m8.1.1.2.3.2.2.1.cmml" xref="S4.SS3.p3.8.m8.1.1.2.3.2.2">subscript</csymbol><ci id="S4.SS3.p3.8.m8.1.1.2.3.2.2.2.cmml" xref="S4.SS3.p3.8.m8.1.1.2.3.2.2.2">𝑛</ci><apply id="S4.SS3.p3.8.m8.1.1.2.3.2.2.3.cmml" xref="S4.SS3.p3.8.m8.1.1.2.3.2.2.3"><times id="S4.SS3.p3.8.m8.1.1.2.3.2.2.3.1.cmml" xref="S4.SS3.p3.8.m8.1.1.2.3.2.2.3.1"></times><ci id="S4.SS3.p3.8.m8.1.1.2.3.2.2.3.2.cmml" xref="S4.SS3.p3.8.m8.1.1.2.3.2.2.3.2">𝑖</ci><ci id="S4.SS3.p3.8.m8.1.1.2.3.2.2.3.3.cmml" xref="S4.SS3.p3.8.m8.1.1.2.3.2.2.3.3">𝑛</ci></apply></apply><cn id="S4.SS3.p3.8.m8.1.1.2.3.2.3.cmml" type="integer" xref="S4.SS3.p3.8.m8.1.1.2.3.2.3">1</cn></apply><ci id="S4.SS3.p3.8.m8.1.1.2.3.3.cmml" xref="S4.SS3.p3.8.m8.1.1.2.3.3">𝑁</ci></apply></apply><apply id="S4.SS3.p3.8.m8.1.1.3.cmml" xref="S4.SS3.p3.8.m8.1.1.3"><times id="S4.SS3.p3.8.m8.1.1.3.1.cmml" xref="S4.SS3.p3.8.m8.1.1.3.1"></times><cn id="S4.SS3.p3.8.m8.1.1.3.2.cmml" type="integer" xref="S4.SS3.p3.8.m8.1.1.3.2">3</cn><apply id="S4.SS3.p3.8.m8.1.1.3.3.cmml" xref="S4.SS3.p3.8.m8.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS3.p3.8.m8.1.1.3.3.1.cmml" xref="S4.SS3.p3.8.m8.1.1.3.3">subscript</csymbol><ci id="S4.SS3.p3.8.m8.1.1.3.3.2.cmml" xref="S4.SS3.p3.8.m8.1.1.3.3.2">𝜎</ci><apply id="S4.SS3.p3.8.m8.1.1.3.3.3.cmml" xref="S4.SS3.p3.8.m8.1.1.3.3.3"><ci id="S4.SS3.p3.8.m8.1.1.3.3.3.1.cmml" xref="S4.SS3.p3.8.m8.1.1.3.3.3.1">:</ci><apply id="S4.SS3.p3.8.m8.1.1.3.3.3.2.cmml" xref="S4.SS3.p3.8.m8.1.1.3.3.3.2"><plus id="S4.SS3.p3.8.m8.1.1.3.3.3.2.1.cmml" xref="S4.SS3.p3.8.m8.1.1.3.3.3.2.1"></plus><apply id="S4.SS3.p3.8.m8.1.1.3.3.3.2.2.cmml" xref="S4.SS3.p3.8.m8.1.1.3.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS3.p3.8.m8.1.1.3.3.3.2.2.1.cmml" xref="S4.SS3.p3.8.m8.1.1.3.3.3.2.2">subscript</csymbol><ci id="S4.SS3.p3.8.m8.1.1.3.3.3.2.2.2.cmml" xref="S4.SS3.p3.8.m8.1.1.3.3.3.2.2.2">𝑛</ci><apply id="S4.SS3.p3.8.m8.1.1.3.3.3.2.2.3.cmml" xref="S4.SS3.p3.8.m8.1.1.3.3.3.2.2.3"><times id="S4.SS3.p3.8.m8.1.1.3.3.3.2.2.3.1.cmml" xref="S4.SS3.p3.8.m8.1.1.3.3.3.2.2.3.1"></times><ci id="S4.SS3.p3.8.m8.1.1.3.3.3.2.2.3.2.cmml" xref="S4.SS3.p3.8.m8.1.1.3.3.3.2.2.3.2">𝑖</ci><ci id="S4.SS3.p3.8.m8.1.1.3.3.3.2.2.3.3.cmml" xref="S4.SS3.p3.8.m8.1.1.3.3.3.2.2.3.3">𝑛</ci></apply></apply><cn id="S4.SS3.p3.8.m8.1.1.3.3.3.2.3.cmml" type="integer" xref="S4.SS3.p3.8.m8.1.1.3.3.3.2.3">1</cn></apply><ci id="S4.SS3.p3.8.m8.1.1.3.3.3.3.cmml" xref="S4.SS3.p3.8.m8.1.1.3.3.3.3">𝑁</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.8.m8.1c">\mu_{n_{in}+1:N}\pm 3\sigma_{n_{in}+1:N}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.8.m8.1d">italic_μ start_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT + 1 : italic_N end_POSTSUBSCRIPT ± 3 italic_σ start_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT + 1 : italic_N end_POSTSUBSCRIPT</annotation></semantics></math> is shown as a shaded area around the nominal Transformer prediction <math alttext="\mu_{n_{in}+1:N}" class="ltx_Math" display="inline" id="S4.SS3.p3.9.m9.1"><semantics id="S4.SS3.p3.9.m9.1a"><msub id="S4.SS3.p3.9.m9.1.1" xref="S4.SS3.p3.9.m9.1.1.cmml"><mi id="S4.SS3.p3.9.m9.1.1.2" xref="S4.SS3.p3.9.m9.1.1.2.cmml">μ</mi><mrow id="S4.SS3.p3.9.m9.1.1.3" xref="S4.SS3.p3.9.m9.1.1.3.cmml"><mrow id="S4.SS3.p3.9.m9.1.1.3.2" xref="S4.SS3.p3.9.m9.1.1.3.2.cmml"><msub id="S4.SS3.p3.9.m9.1.1.3.2.2" xref="S4.SS3.p3.9.m9.1.1.3.2.2.cmml"><mi id="S4.SS3.p3.9.m9.1.1.3.2.2.2" xref="S4.SS3.p3.9.m9.1.1.3.2.2.2.cmml">n</mi><mrow id="S4.SS3.p3.9.m9.1.1.3.2.2.3" xref="S4.SS3.p3.9.m9.1.1.3.2.2.3.cmml"><mi id="S4.SS3.p3.9.m9.1.1.3.2.2.3.2" xref="S4.SS3.p3.9.m9.1.1.3.2.2.3.2.cmml">i</mi><mo id="S4.SS3.p3.9.m9.1.1.3.2.2.3.1" xref="S4.SS3.p3.9.m9.1.1.3.2.2.3.1.cmml">⁢</mo><mi id="S4.SS3.p3.9.m9.1.1.3.2.2.3.3" xref="S4.SS3.p3.9.m9.1.1.3.2.2.3.3.cmml">n</mi></mrow></msub><mo id="S4.SS3.p3.9.m9.1.1.3.2.1" xref="S4.SS3.p3.9.m9.1.1.3.2.1.cmml">+</mo><mn id="S4.SS3.p3.9.m9.1.1.3.2.3" xref="S4.SS3.p3.9.m9.1.1.3.2.3.cmml">1</mn></mrow><mo id="S4.SS3.p3.9.m9.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S4.SS3.p3.9.m9.1.1.3.1.cmml">:</mo><mi id="S4.SS3.p3.9.m9.1.1.3.3" xref="S4.SS3.p3.9.m9.1.1.3.3.cmml">N</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.9.m9.1b"><apply id="S4.SS3.p3.9.m9.1.1.cmml" xref="S4.SS3.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.9.m9.1.1.1.cmml" xref="S4.SS3.p3.9.m9.1.1">subscript</csymbol><ci id="S4.SS3.p3.9.m9.1.1.2.cmml" xref="S4.SS3.p3.9.m9.1.1.2">𝜇</ci><apply id="S4.SS3.p3.9.m9.1.1.3.cmml" xref="S4.SS3.p3.9.m9.1.1.3"><ci id="S4.SS3.p3.9.m9.1.1.3.1.cmml" xref="S4.SS3.p3.9.m9.1.1.3.1">:</ci><apply id="S4.SS3.p3.9.m9.1.1.3.2.cmml" xref="S4.SS3.p3.9.m9.1.1.3.2"><plus id="S4.SS3.p3.9.m9.1.1.3.2.1.cmml" xref="S4.SS3.p3.9.m9.1.1.3.2.1"></plus><apply id="S4.SS3.p3.9.m9.1.1.3.2.2.cmml" xref="S4.SS3.p3.9.m9.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.SS3.p3.9.m9.1.1.3.2.2.1.cmml" xref="S4.SS3.p3.9.m9.1.1.3.2.2">subscript</csymbol><ci id="S4.SS3.p3.9.m9.1.1.3.2.2.2.cmml" xref="S4.SS3.p3.9.m9.1.1.3.2.2.2">𝑛</ci><apply id="S4.SS3.p3.9.m9.1.1.3.2.2.3.cmml" xref="S4.SS3.p3.9.m9.1.1.3.2.2.3"><times id="S4.SS3.p3.9.m9.1.1.3.2.2.3.1.cmml" xref="S4.SS3.p3.9.m9.1.1.3.2.2.3.1"></times><ci id="S4.SS3.p3.9.m9.1.1.3.2.2.3.2.cmml" xref="S4.SS3.p3.9.m9.1.1.3.2.2.3.2">𝑖</ci><ci id="S4.SS3.p3.9.m9.1.1.3.2.2.3.3.cmml" xref="S4.SS3.p3.9.m9.1.1.3.2.2.3.3">𝑛</ci></apply></apply><cn id="S4.SS3.p3.9.m9.1.1.3.2.3.cmml" type="integer" xref="S4.SS3.p3.9.m9.1.1.3.2.3">1</cn></apply><ci id="S4.SS3.p3.9.m9.1.1.3.3.cmml" xref="S4.SS3.p3.9.m9.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.9.m9.1c">\mu_{n_{in}+1:N}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.9.m9.1d">italic_μ start_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT + 1 : italic_N end_POSTSUBSCRIPT</annotation></semantics></math>. We observe that the credible intervals effectively capture the actual predictive uncertainty.</p>
</div>
<figure class="ltx_figure" id="S4.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="132" id="S4.F4.g1" src="extracted/5901228/wh_sim_batch_single_16000ctx_inputnoise.jpg" width="419"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F4.12.6.1" style="font-size:90%;">Figure 4</span>: </span><span class="ltx_text" id="S4.F4.10.5" style="font-size:90%;">Multi-step-ahead simulation with white noise input of the Transformer trained with <math alttext="m=16k" class="ltx_Math" display="inline" id="S4.F4.6.1.m1.1"><semantics id="S4.F4.6.1.m1.1b"><mrow id="S4.F4.6.1.m1.1.1" xref="S4.F4.6.1.m1.1.1.cmml"><mi id="S4.F4.6.1.m1.1.1.2" xref="S4.F4.6.1.m1.1.1.2.cmml">m</mi><mo id="S4.F4.6.1.m1.1.1.1" xref="S4.F4.6.1.m1.1.1.1.cmml">=</mo><mrow id="S4.F4.6.1.m1.1.1.3" xref="S4.F4.6.1.m1.1.1.3.cmml"><mn id="S4.F4.6.1.m1.1.1.3.2" xref="S4.F4.6.1.m1.1.1.3.2.cmml">16</mn><mo id="S4.F4.6.1.m1.1.1.3.1" xref="S4.F4.6.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.F4.6.1.m1.1.1.3.3" xref="S4.F4.6.1.m1.1.1.3.3.cmml">k</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.F4.6.1.m1.1c"><apply id="S4.F4.6.1.m1.1.1.cmml" xref="S4.F4.6.1.m1.1.1"><eq id="S4.F4.6.1.m1.1.1.1.cmml" xref="S4.F4.6.1.m1.1.1.1"></eq><ci id="S4.F4.6.1.m1.1.1.2.cmml" xref="S4.F4.6.1.m1.1.1.2">𝑚</ci><apply id="S4.F4.6.1.m1.1.1.3.cmml" xref="S4.F4.6.1.m1.1.1.3"><times id="S4.F4.6.1.m1.1.1.3.1.cmml" xref="S4.F4.6.1.m1.1.1.3.1"></times><cn id="S4.F4.6.1.m1.1.1.3.2.cmml" type="integer" xref="S4.F4.6.1.m1.1.1.3.2">16</cn><ci id="S4.F4.6.1.m1.1.1.3.3.cmml" xref="S4.F4.6.1.m1.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.6.1.m1.1d">m=16k</annotation><annotation encoding="application/x-llamapun" id="S4.F4.6.1.m1.1e">italic_m = 16 italic_k</annotation></semantics></math>. Results on 256 randomly sampled systems superposed (left)
and on a particular system (right).
Actual output <math alttext="y" class="ltx_Math" display="inline" id="S4.F4.7.2.m2.1"><semantics id="S4.F4.7.2.m2.1b"><mi id="S4.F4.7.2.m2.1.1" xref="S4.F4.7.2.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S4.F4.7.2.m2.1c"><ci id="S4.F4.7.2.m2.1.1.cmml" xref="S4.F4.7.2.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.7.2.m2.1d">y</annotation><annotation encoding="application/x-llamapun" id="S4.F4.7.2.m2.1e">italic_y</annotation></semantics></math> (black), simulated output mean
<math alttext="\mu" class="ltx_Math" display="inline" id="S4.F4.8.3.m3.1"><semantics id="S4.F4.8.3.m3.1b"><mi id="S4.F4.8.3.m3.1.1" xref="S4.F4.8.3.m3.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.F4.8.3.m3.1c"><ci id="S4.F4.8.3.m3.1.1.cmml" xref="S4.F4.8.3.m3.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.8.3.m3.1d">\mu</annotation><annotation encoding="application/x-llamapun" id="S4.F4.8.3.m3.1e">italic_μ</annotation></semantics></math> (blue), and simulation error <math alttext="y-\mu" class="ltx_Math" display="inline" id="S4.F4.9.4.m4.1"><semantics id="S4.F4.9.4.m4.1b"><mrow id="S4.F4.9.4.m4.1.1" xref="S4.F4.9.4.m4.1.1.cmml"><mi id="S4.F4.9.4.m4.1.1.2" xref="S4.F4.9.4.m4.1.1.2.cmml">y</mi><mo id="S4.F4.9.4.m4.1.1.1" xref="S4.F4.9.4.m4.1.1.1.cmml">−</mo><mi id="S4.F4.9.4.m4.1.1.3" xref="S4.F4.9.4.m4.1.1.3.cmml">μ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.F4.9.4.m4.1c"><apply id="S4.F4.9.4.m4.1.1.cmml" xref="S4.F4.9.4.m4.1.1"><minus id="S4.F4.9.4.m4.1.1.1.cmml" xref="S4.F4.9.4.m4.1.1.1"></minus><ci id="S4.F4.9.4.m4.1.1.2.cmml" xref="S4.F4.9.4.m4.1.1.2">𝑦</ci><ci id="S4.F4.9.4.m4.1.1.3.cmml" xref="S4.F4.9.4.m4.1.1.3">𝜇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.9.4.m4.1d">y-\mu</annotation><annotation encoding="application/x-llamapun" id="S4.F4.9.4.m4.1e">italic_y - italic_μ</annotation></semantics></math> (red). The shaded area (light blue) is made by <math alttext="\pm 3" class="ltx_Math" display="inline" id="S4.F4.10.5.m5.1"><semantics id="S4.F4.10.5.m5.1b"><mrow id="S4.F4.10.5.m5.1.1" xref="S4.F4.10.5.m5.1.1.cmml"><mo id="S4.F4.10.5.m5.1.1b" xref="S4.F4.10.5.m5.1.1.cmml">±</mo><mn id="S4.F4.10.5.m5.1.1.2" xref="S4.F4.10.5.m5.1.1.2.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F4.10.5.m5.1c"><apply id="S4.F4.10.5.m5.1.1.cmml" xref="S4.F4.10.5.m5.1.1"><csymbol cd="latexml" id="S4.F4.10.5.m5.1.1.1.cmml" xref="S4.F4.10.5.m5.1.1">plus-or-minus</csymbol><cn id="S4.F4.10.5.m5.1.1.2.cmml" type="integer" xref="S4.F4.10.5.m5.1.1.2">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.10.5.m5.1d">\pm 3</annotation><annotation encoding="application/x-llamapun" id="S4.F4.10.5.m5.1e">± 3</annotation></semantics></math> standard deviations provided by the meta-model.</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Out-of-distribution</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.2">To assess robustness of the trained meta-model against a shift in the input distribution, we have generated test datasets from <math alttext="256" class="ltx_Math" display="inline" id="S4.SS4.p1.1.m1.1"><semantics id="S4.SS4.p1.1.m1.1a"><mn id="S4.SS4.p1.1.m1.1.1" xref="S4.SS4.p1.1.m1.1.1.cmml">256</mn><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.m1.1b"><cn id="S4.SS4.p1.1.m1.1.1.cmml" type="integer" xref="S4.SS4.p1.1.m1.1.1">256</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.m1.1c">256</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.1.m1.1d">256</annotation></semantics></math> different systems by applying as input a pseudo random binary signal (PRBS), thus with different characteristics with respect to the input used for meta-model training. The case of context length <math alttext="m=16000" class="ltx_Math" display="inline" id="S4.SS4.p1.2.m2.1"><semantics id="S4.SS4.p1.2.m2.1a"><mrow id="S4.SS4.p1.2.m2.1.1" xref="S4.SS4.p1.2.m2.1.1.cmml"><mi id="S4.SS4.p1.2.m2.1.1.2" xref="S4.SS4.p1.2.m2.1.1.2.cmml">m</mi><mo id="S4.SS4.p1.2.m2.1.1.1" xref="S4.SS4.p1.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS4.p1.2.m2.1.1.3" xref="S4.SS4.p1.2.m2.1.1.3.cmml">16000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.2.m2.1b"><apply id="S4.SS4.p1.2.m2.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1"><eq id="S4.SS4.p1.2.m2.1.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1.1"></eq><ci id="S4.SS4.p1.2.m2.1.1.2.cmml" xref="S4.SS4.p1.2.m2.1.1.2">𝑚</ci><cn id="S4.SS4.p1.2.m2.1.1.3.cmml" type="integer" xref="S4.SS4.p1.2.m2.1.1.3">16000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.2.m2.1c">m=16000</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.2.m2.1d">italic_m = 16000</annotation></semantics></math> is reported. Output trajectories are visualized
in Fig <a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#S4.F5.sf1" title="In Figure 5 ‣ 4.4 Out-of-distribution ‣ 4 Numerical Example ‣ Enhanced Transformer architecture for in-context learning of dynamical systems"><span class="ltx_text ltx_ref_tag">5(a)</span></a>, for all systems (left panel) and for one particular realization (right panel).
The average RMSE is 0.3094, about 2.4x larger than the in-distribution case (see Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#S4.T1" title="Table 1 ‣ 4.3 Results ‣ 4 Numerical Example ‣ Enhanced Transformer architecture for in-context learning of dynamical systems"><span class="ltx_text ltx_ref_tag">1</span></a>). It is interesting to observe that, as the performance decrease, the estimated uncertainty bands get wider.</p>
</div>
<figure class="ltx_figure" id="S4.F5">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F5.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="188" id="S4.F5.sf1.g1" src="extracted/5901228/wh_sim_batch_single_16000ctx_inputbinary.jpg" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F5.sf1.2.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S4.F5.sf1.3.2" style="font-size:90%;">PRBS input: simulation results on 256 randomly sampled systems superposed (left)
and on a particular system (right).</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F5.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="188" id="S4.F5.sf2.g1" src="extracted/5901228/wh_sim_batch_single_16000ctx_inputbinary_finetuned.jpg" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F5.sf2.2.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S4.F5.sf2.3.2" style="font-size:90%;">Fine-tuned meta-model for PRBS input: simulation results on 256 randomly sampled systems superposed (left)
and on a particular system (right).</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F5.10.5.1" style="font-size:90%;">Figure 5</span>: </span><span class="ltx_text" id="S4.F5.8.4" style="font-size:90%;">Multi-step-ahead simulation. Meta-model trained with white noise input and tested with PRBS input (top row). Meta-model fine-tuned on PRBS input signals (bottom row).
Actual output <math alttext="\tilde{y}" class="ltx_Math" display="inline" id="S4.F5.5.1.m1.1"><semantics id="S4.F5.5.1.m1.1b"><mover accent="true" id="S4.F5.5.1.m1.1.1" xref="S4.F5.5.1.m1.1.1.cmml"><mi id="S4.F5.5.1.m1.1.1.2" xref="S4.F5.5.1.m1.1.1.2.cmml">y</mi><mo id="S4.F5.5.1.m1.1.1.1" xref="S4.F5.5.1.m1.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S4.F5.5.1.m1.1c"><apply id="S4.F5.5.1.m1.1.1.cmml" xref="S4.F5.5.1.m1.1.1"><ci id="S4.F5.5.1.m1.1.1.1.cmml" xref="S4.F5.5.1.m1.1.1.1">~</ci><ci id="S4.F5.5.1.m1.1.1.2.cmml" xref="S4.F5.5.1.m1.1.1.2">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.5.1.m1.1d">\tilde{y}</annotation><annotation encoding="application/x-llamapun" id="S4.F5.5.1.m1.1e">over~ start_ARG italic_y end_ARG</annotation></semantics></math> (black), simulated output mean <math alttext="\mu" class="ltx_Math" display="inline" id="S4.F5.6.2.m2.1"><semantics id="S4.F5.6.2.m2.1b"><mi id="S4.F5.6.2.m2.1.1" xref="S4.F5.6.2.m2.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.F5.6.2.m2.1c"><ci id="S4.F5.6.2.m2.1.1.cmml" xref="S4.F5.6.2.m2.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.6.2.m2.1d">\mu</annotation><annotation encoding="application/x-llamapun" id="S4.F5.6.2.m2.1e">italic_μ</annotation></semantics></math> (blue), and simulation error <math alttext="\tilde{y}-\mu" class="ltx_Math" display="inline" id="S4.F5.7.3.m3.1"><semantics id="S4.F5.7.3.m3.1b"><mrow id="S4.F5.7.3.m3.1.1" xref="S4.F5.7.3.m3.1.1.cmml"><mover accent="true" id="S4.F5.7.3.m3.1.1.2" xref="S4.F5.7.3.m3.1.1.2.cmml"><mi id="S4.F5.7.3.m3.1.1.2.2" xref="S4.F5.7.3.m3.1.1.2.2.cmml">y</mi><mo id="S4.F5.7.3.m3.1.1.2.1" xref="S4.F5.7.3.m3.1.1.2.1.cmml">~</mo></mover><mo id="S4.F5.7.3.m3.1.1.1" xref="S4.F5.7.3.m3.1.1.1.cmml">−</mo><mi id="S4.F5.7.3.m3.1.1.3" xref="S4.F5.7.3.m3.1.1.3.cmml">μ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.F5.7.3.m3.1c"><apply id="S4.F5.7.3.m3.1.1.cmml" xref="S4.F5.7.3.m3.1.1"><minus id="S4.F5.7.3.m3.1.1.1.cmml" xref="S4.F5.7.3.m3.1.1.1"></minus><apply id="S4.F5.7.3.m3.1.1.2.cmml" xref="S4.F5.7.3.m3.1.1.2"><ci id="S4.F5.7.3.m3.1.1.2.1.cmml" xref="S4.F5.7.3.m3.1.1.2.1">~</ci><ci id="S4.F5.7.3.m3.1.1.2.2.cmml" xref="S4.F5.7.3.m3.1.1.2.2">𝑦</ci></apply><ci id="S4.F5.7.3.m3.1.1.3.cmml" xref="S4.F5.7.3.m3.1.1.3">𝜇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.7.3.m3.1d">\tilde{y}-\mu</annotation><annotation encoding="application/x-llamapun" id="S4.F5.7.3.m3.1e">over~ start_ARG italic_y end_ARG - italic_μ</annotation></semantics></math> (red). The shaded area (light blue) is made by <math alttext="\pm" class="ltx_Math" display="inline" id="S4.F5.8.4.m4.1"><semantics id="S4.F5.8.4.m4.1b"><mo id="S4.F5.8.4.m4.1.1" xref="S4.F5.8.4.m4.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.F5.8.4.m4.1c"><csymbol cd="latexml" id="S4.F5.8.4.m4.1.1.cmml" xref="S4.F5.8.4.m4.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.8.4.m4.1d">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.F5.8.4.m4.1e">±</annotation></semantics></math>3 standard deviation provided by the meta-model.</span></figcaption>
</figure>
<div class="ltx_para" id="S4.SS4.p2">
<p class="ltx_p" id="S4.SS4.p2.1">Following the approach in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#bib.bib26" title="">26</a>]</cite>, we performed a short fine-tuning of the meta-model for PRBS input over 40k iterations, corresponding to approximately 2 hours of training. Results are visualized in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#S4.F5.sf2" title="In Figure 5 ‣ 4.4 Out-of-distribution ‣ 4 Numerical Example ‣ Enhanced Transformer architecture for in-context learning of dynamical systems"><span class="ltx_text ltx_ref_tag">5(b)</span></a> for the same test datasets considered in the previous paragraph. We remark that fine-tuning leads to a significant improvement in the RMSE from 0.3094 to 0.1058 (thus very close to the noise floor <math alttext="\sigma_{\rm noise}=0.1" class="ltx_Math" display="inline" id="S4.SS4.p2.1.m1.1"><semantics id="S4.SS4.p2.1.m1.1a"><mrow id="S4.SS4.p2.1.m1.1.1" xref="S4.SS4.p2.1.m1.1.1.cmml"><msub id="S4.SS4.p2.1.m1.1.1.2" xref="S4.SS4.p2.1.m1.1.1.2.cmml"><mi id="S4.SS4.p2.1.m1.1.1.2.2" xref="S4.SS4.p2.1.m1.1.1.2.2.cmml">σ</mi><mi id="S4.SS4.p2.1.m1.1.1.2.3" xref="S4.SS4.p2.1.m1.1.1.2.3.cmml">noise</mi></msub><mo id="S4.SS4.p2.1.m1.1.1.1" xref="S4.SS4.p2.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS4.p2.1.m1.1.1.3" xref="S4.SS4.p2.1.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.1.m1.1b"><apply id="S4.SS4.p2.1.m1.1.1.cmml" xref="S4.SS4.p2.1.m1.1.1"><eq id="S4.SS4.p2.1.m1.1.1.1.cmml" xref="S4.SS4.p2.1.m1.1.1.1"></eq><apply id="S4.SS4.p2.1.m1.1.1.2.cmml" xref="S4.SS4.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS4.p2.1.m1.1.1.2.1.cmml" xref="S4.SS4.p2.1.m1.1.1.2">subscript</csymbol><ci id="S4.SS4.p2.1.m1.1.1.2.2.cmml" xref="S4.SS4.p2.1.m1.1.1.2.2">𝜎</ci><ci id="S4.SS4.p2.1.m1.1.1.2.3.cmml" xref="S4.SS4.p2.1.m1.1.1.2.3">noise</ci></apply><cn id="S4.SS4.p2.1.m1.1.1.3.cmml" type="float" xref="S4.SS4.p2.1.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.1.m1.1c">\sigma_{\rm noise}=0.1</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.1.m1.1d">italic_σ start_POSTSUBSCRIPT roman_noise end_POSTSUBSCRIPT = 0.1</annotation></semantics></math>), along with a shrinkage of the uncertainty bands.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusions</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">Major modifications to the Transformer-based meta-model architecture introduced in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#bib.bib11" title="">11</a>]</cite> for in-context system identification have been presented.
Numerical experiments show that using longer context windows results in a substantial accuracy improvement, with the trained meta-model approaching the noise floor. Furthermore, the meta-model maintains reasonable performance in the case of out-of-distribution inputs, with prediction capabilities that can be significantly improved through fast fine-tuning.</p>
</div>
<div class="ltx_para" id="S5.p2">
<p class="ltx_p" id="S5.p2.1">The statistical formulation, besides providing uncertainty quantification for the output predictions, opens up applications in other areas, such as meta-state estimation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#bib.bib27" title="">27</a>]</cite>, or in classical system identification tasks where the meta-model can be used to generate synthetic data as in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03291v1#bib.bib28" title="">28</a>]</cite>, and the uncertainty can be used to properly weight synthetic samples. This is the subject of ongoing research, along with activities to further enhance the scalability and computational efficiency of the approach.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
M. Forgione and D. Piga, “dynoNet: A neural network architecture for learning dynamical systems,” <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">International Journal of Adaptive Control and Signal Processing</em>, vol. 35, no. 4, pp. 612–626, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
A. Bemporad, “Training recurrent neural networks by sequential least squares and the alternating direction method of multipliers,” <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">Automatica</em>, vol. 156, p. 111183, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
G. I. Beintema, M. Schoukens, and R. Tóth, “Deep subspace encoders for nonlinear system identification,” <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">Automatica</em>, vol. 156, p. 111210, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
G. Pillonetto, F. Dinuzzo, T. Chen, G. De Nicolao, and L. Ljung, “Kernel methods in system identification, machine learning and function estimation: A survey,” <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">Automatica</em>, vol. 50, no. 3, pp. 657–682, 2014.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
T. Rogers, K. Worden, and E. Cross, “On the application of gaussian process latent force models for joint input-state-parameter estimation: With a view to bayesian operational identification,” <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Mechanical Systems and Signal Processing</em>, vol. 140, p. 106580, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
J. Schmidhuber, “Evolutionary principles in self-referential learning, or on learning how to learn: the meta-meta-… hook,” Ph.D. dissertation, Technische Universität München, 1987.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
T. Hospedales, A. Antoniou, P. Micaelli, and A. Storkey, “Meta-learning in neural networks: A survey,” <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">IEEE transactions on pattern analysis and machine intelligence</em>, vol. 44, no. 9, pp. 5149–5169, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
A. Chakrabarty, G. Wichern, and C. R. Laughman, “Meta-learning of neural state-space models using data from similar systems,” in <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">World Congress of the International Federation of Automatic Control (IFAC)</em>, Jul. 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Z. Du, H. Balim, S. Oymak, and N. Ozay, “Can transformers learn optimal filtering for unknown systems?” <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">IEEE Control Systems Letters</em>, vol. 7, pp. 3525–3530, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
J. Achiam, S. Adler, S. Agarwal, L. Ahmad, I. Akkaya, F. L. Aleman, D. Almeida, J. Altenschmidt, S. Altman, S. Anadkat <em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">et al.</em>, “GPT-4 technical report,” <em class="ltx_emph ltx_font_italic" id="bib.bib10.2.2">arXiv preprint arXiv:2303.08774</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
M. Forgione, F. Pura, and D. Piga, “From system models to class models: An in-context learning paradigm,” <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">IEEE Control Systems Letters</em>, vol. 7, pp. 3513–3518, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
T. B. Brown, “Language models are few-shot learners,” <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">arXiv preprint arXiv:2005.14165</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
A. Radford, J. Wu, R. Child, D. Luan, D. Amodei, I. Sutskever <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">et al.</em>, “Language models are unsupervised multitask learners,” <em class="ltx_emph ltx_font_italic" id="bib.bib13.2.2">OpenAI blog</em>, vol. 1, no. 8, p. 9, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
I. Beltagy, M. E. Peters, and A. Cohan, “Longformer: The long-document transformer,” <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">arXiv preprint arXiv:2004.05150</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
H. Wu, J. Xu, J. Wang, and M. Long, “Autoformer: Decomposition transformers with auto-correlation for long-term series forecasting,” in <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Advances in Neural Information Processing Systems</em>, vol. 34, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
H. Zhou, S. Zhang, J. Peng, S. Zhang, J. Li, H. Xiong, and W. Zhang, “Informer: Beyond efficient transformer for long sequence time-series forecasting,” in <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">Proceedings of the AAAI Conference on Artificial Intelligence</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
A. Dosovitskiy, L. Beyer, A. Kolesnikov, D. Weissenborn, X. Zhai, T. Unterthiner, M. Dehghani, M. Minderer, G. Heigold, S. Gelly, J. Uszkoreit, and N. Houlsby, “An image is worth 16x16 words: Transformers for image recognition at scale,” in <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">The Eighth International Conference on Learning Representations</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Y. Nie, N. H. Nguyen, P. Sinthong, and J. Kalagnanam, “A time series is worth 64 words: Long-term forecasting with transformers,” in <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">The Eleventh International Conference on Learning Representations</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
G. Pillonetto, F. Dinuzzo, T. Chen, G. De Nicolao, and L. Ljung, “Kernel methods in system identification, machine learning and function estimation: A survey,” <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">Automatica</em>, vol. 50, no. 3, pp. 657–682, 2014.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
A. Vaswani, N. Shazeer, N. Parmar, J. Uszkoreit, L. Jones, A. N. Gomez, Ł. Kaiser, and I. Polosukhin, “Attention is all you need,” <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">Advances in neural information processing systems</em>, vol. 30, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
K. P. Murphy, <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">Probabilistic machine learning: an introduction</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
F. Giri and E.-W. Bai, <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">Block-oriented nonlinear system identification</em>, 2010, vol. 1.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
I. Loshchilov and F. Hutter, “Decoupled weight decay regularization,” in <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">International Conference on Learning Representations</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
M. Rufolo and M. Forgione, “Sysid-meta-dist with patching,” https://github.com/mattrufolo/sysid-prob-transformer, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
K. He, X. Zhang, S. Ren, and J. Sun, “Delving deep into rectifiers: Surpassing human-level performance on imagenet classification,” in <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">Proceedings of the IEEE international conference on computer vision</em>, 2015, pp. 1026–1034.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
D. Piga, F. Pura, and M. Forgione, “On the adaptation of in-context learners for system identification,” in <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">Proceedings of the IFAC Symposium on System Identification</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
R. Busetto, V. Breschi, M. Forgione, D. Piga, and S. Formentin, “In-context learning of state estimators,” in <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">Proceedings of the IFAC Symposium on System Identification</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
D. Piga, M. Rufolo, G. Maroni, M. Mejari, and M. Forgione, “Synthetic data generation for system identification: leveraging knowledge transfer from similar systems,” <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">arXiv preprint arXiv:2403.05164</em>, 2024.

</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Fri Oct  4 09:41:50 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
