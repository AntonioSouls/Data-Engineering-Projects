<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning</title>
<!--Generated on Sun Oct  6 14:35:02 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.04498v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S1" title="In AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S2" title="In AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S2.SS1" title="In 2 Related work ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Memory-based RL</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S2.SS2" title="In 2 Related work ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Intrinsic motivation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S3" title="In AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Method</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S3.SS1" title="In 3 Method ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Memory-reflection module</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S3.SS1.SSS1" title="In 3.1 Memory-reflection module ‣ 3 Method ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1.1 </span>Prediction network</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S3.SS1.SSS2" title="In 3.1 Memory-reflection module ‣ 3 Method ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1.2 </span>Reflection network</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S3.SS2" title="In 3 Method ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Coarse-fine distinction module</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S3.SS2.SSS1" title="In 3.2 Coarse-fine distinction module ‣ 3 Method ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.1 </span>Intrinsic reward design</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S3.SS2.SSS2" title="In 3.2 Coarse-fine distinction module ‣ 3 Method ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.2 </span>Proof of the retaining of policy optimality</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S3.SS3" title="In 3 Method ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Ensemble learning for exploration-exploitation balance</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S3.SS3.SSS1" title="In 3.3 Ensemble learning for exploration-exploitation balance ‣ 3 Method ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.1 </span>Proof of memory effectiveness</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S4" title="In AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S4.SS1" title="In 4 Experiments ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Visualization Analysis</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S4.SS1.SSS1" title="In 4.1 Visualization Analysis ‣ 4 Experiments ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.1 </span>Visualization of the fine-grained distinction</span></a>
<ol class="ltx_toclist ltx_toclist_subsubsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S4.SS1.SSS1.Px1" title="In 4.1.1 Visualization of the fine-grained distinction ‣ 4.1 Visualization Analysis ‣ 4 Experiments ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_title">Dark Chamber.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S4.SS1.SSS1.Px2" title="In 4.1.1 Visualization of the fine-grained distinction ‣ 4.1 Visualization Analysis ‣ 4 Experiments ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_title">Four Rooms.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsubsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S4.SS1.SSS2" title="In 4.1 Visualization Analysis ‣ 4 Experiments ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.2 </span>Visualization of memory-reflection</span></a>
<ol class="ltx_toclist ltx_toclist_subsubsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S4.SS1.SSS2.Px1" title="In 4.1.2 Visualization of memory-reflection ‣ 4.1 Visualization Analysis ‣ 4 Experiments ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_title">Cliff Walking.</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S4.SS2" title="In 4 Experiments ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Main experiments</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S4.SS3" title="In 4 Experiments ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Generalization experiments</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S5" title="In AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#A1" title="In AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Additional related works</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#A1.SS1" title="In Appendix A Additional related works ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Sparse Reward Environments</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#A1.SS2" title="In Appendix A Additional related works ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2 </span>Memory motheds</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#A1.SS2.SSS0.Px1" title="In A.2 Memory motheds ‣ Appendix A Additional related works ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_title">Storage-based methods:</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#A1.SS2.SSS0.Px2" title="In A.2 Memory motheds ‣ Appendix A Additional related works ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_title">Experience Replay methods:</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#A1.SS3" title="In Appendix A Additional related works ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.3 </span>Intrinsic Motivation</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#A1.SS3.SSS0.Px1" title="In A.3 Intrinsic Motivation ‣ Appendix A Additional related works ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_title">Count-based Intrinsic Motivation:</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#A1.SS3.SSS0.Px2" title="In A.3 Intrinsic Motivation ‣ Appendix A Additional related works ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_title">Error-based Intrinsic Motivation:</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#A2" title="In AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Additional Preliminaries</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#A2.SS1" title="In Appendix B Additional Preliminaries ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.1 </span>Markov Decision Process (MDP)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#A2.SS2" title="In Appendix B Additional Preliminaries ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.2 </span>Intrinsic-Based Reinforcement Learning</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#A3" title="In AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Additional Proofs</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#A3.SS1" title="In Appendix C Additional Proofs ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.1 </span>Proof of Theorem <span class="ltx_text ltx_ref_tag">3.2</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#A3.SS2" title="In Appendix C Additional Proofs ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.2 </span>Proof of Theorem <span class="ltx_text ltx_ref_tag">3.3</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#A4" title="In AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D </span>Supplementary Experiment Details</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#A4.SS1" title="In Appendix D Supplementary Experiment Details ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.1 </span>Construction and update of memory buffers</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#A4.SS1.SSS0.Px1" title="In D.1 Construction and update of memory buffers ‣ Appendix D Supplementary Experiment Details ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_title">Memory Buffer:</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#A4.SS1.SSS0.Px2" title="In D.1 Construction and update of memory buffers ‣ Appendix D Supplementary Experiment Details ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_title">Reflection Buffer:</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#A4.SS2" title="In Appendix D Supplementary Experiment Details ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.2 </span>Visualization of Experimental Environments Setup</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#A4.SS2.SSS0.Px1" title="In D.2 Visualization of Experimental Environments Setup ‣ Appendix D Supplementary Experiment Details ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_title">Dark Chamber.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#A4.SS2.SSS0.Px2" title="In D.2 Visualization of Experimental Environments Setup ‣ Appendix D Supplementary Experiment Details ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_title">Four Rooms.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#A4.SS2.SSS0.Px3" title="In D.2 Visualization of Experimental Environments Setup ‣ Appendix D Supplementary Experiment Details ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_title">Cliff Walking.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#A4.SS3" title="In Appendix D Supplementary Experiment Details ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.3 </span>Algorithm Description</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#A4.SS4" title="In Appendix D Supplementary Experiment Details ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.4 </span>Parameter Settings</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#A5" title="In AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E </span>AdaMemento vs. Baseline Performance in All Atari Environments</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<div class="ltx_para ltx_noindent" id="p1">
<span class="ltx_ERROR undefined" id="p1.1">{CJK*}</span>
<p class="ltx_p" id="p1.2">UTF8gbsn</p>
</div>
<h1 class="ltx_title ltx_title_document">AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Renye Yan<sup class="ltx_sup" id="id1.1.id1">1</sup><span class="ltx_note ltx_role_footnotemark" id="footnotex1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">footnotemark: </span><span class="ltx_tag ltx_tag_note">1</span></span></span></span>, Yaozhong Gan, You Wu, Junliang Xing<sup class="ltx_sup" id="id2.2.id2">2</sup>, Ling Liangn<sup class="ltx_sup" id="id3.3.id3">1</sup>, Yeshang Zhu, Yimao Cai<sup class="ltx_sup" id="id4.4.id4">1</sup>
<br class="ltx_break"/><sup class="ltx_sup" id="id5.5.id5">1</sup>Peking University, <sup class="ltx_sup" id="id6.6.id6">2</sup> Tsinghua University
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id7.7.id7">victory@stu.pku.edu.cn, yzgancn@163.com</span>
</span><span class="ltx_author_notes">Equal contribution.</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id8.id1">In sparse reward scenarios of reinforcement learning (RL), the memory mechanism provides promising shortcuts to policy optimization by reflecting on past experiences like humans. However, current memory-based RL methods simply store and reuse high-value policies, lacking a deeper refining and filtering of diverse past experiences and hence limiting the capability of memory. In this paper, we propose AdaMemento, an adaptive memory-enhanced RL framework.
Instead of just memorizing positive past experiences, we design a memory-reflection module that exploits both positive and negative experiences by learning to predict known local optimal policies based on real-time states. To effectively gather informative trajectories for the memory, we further introduce a fine-grained intrinsic motivation paradigm, where nuances in similar states can be precisely distinguished to guide exploration. The exploitation of past experiences and exploration of new policies are then adaptively coordinated by ensemble learning to approach the global optimum. Furthermore, we theoretically prove the superiority of our new intrinsic motivation and ensemble mechanism. From 59 quantitative and visualization experiments, we confirm that AdaMemento can distinguish subtle states for better exploration and effectively exploiting past experiences in memory, achieving significant improvement over previous methods.
</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para ltx_noindent" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">In reinforcement learning (RL), policy optimization directly updates the policy function according to reward signals and hence efficiently converges to the optimum in simple tasks. However, in sparse reward environments, policy updates become unstable and ineffective due to insufficient feedback <cite class="ltx_cite ltx_citemacro_citep">(Bellemare et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#bib.bib6" title="">2016</a>; Liang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#bib.bib17" title="">2018</a>)</cite>.
This significantly increases the difficulty of learning effective long-horizon policies.
</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Memory offers a promising solution to the sparse reward problem, as humans can effectively learn from past experiences to avoid repeating mistakes in similar scenarios <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#bib.bib18" title="">2021</a>; Bransford &amp; Johnson, <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#bib.bib7" title="">1972</a>; Andrychowicz et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#bib.bib2" title="">2017</a>)</cite>.
Through memory, agents can utilize prior successful experiences to refine their policies in complex environments, hence reducing the reliance on dense reward feedback and improving both learning efficiency and policy stability <cite class="ltx_cite ltx_citemacro_citep">(Pathak et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#bib.bib21" title="">2017</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Existing memory-based RL methods can be roughly categorized into two classes.
Storage-based methods like NGU <cite class="ltx_cite ltx_citemacro_citep">(Badia et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#bib.bib4" title="">2020b</a>)</cite> maintain a memory buffer of visited states and avoid re-visitation of similar states.
This kind of approach essentially treats memory as a state counter, without leveraging past experiences to predict or guide future policies.
Experience replay methods, such as self-imitation learning (SIL) <cite class="ltx_cite ltx_citemacro_citep">(Oh et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#bib.bib19" title="">2018</a>)</cite>, aim to reuse past high-value experiences to optimize the policy by repeatedly imitating state-action pairs with a higher value.
<cite class="ltx_cite ltx_citemacro_citet">Guo et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#bib.bib14" title="">2020</a>)</cite> further extend SIL to replicate historical trajectories and guide the agent to explore on top of these paths. While existing experience replay methods have shown promising capabilities, they overly rely on past experiences and pay less attention to exploration, which may lead to premature policies. Moreover, these methods neglect the importance of failed experiences, despite the fact that failures often lie along the high-value trajectories. Therefore, ideal memory-based RL, like humans, should effectively generalize from both successful and failed experiences, as well as balancing the exploitation of past experiences and the exploration of new states.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">To address the above challenges, in this paper, we propose AdaMemento, a novel RL framework inspired by the memory reflection process of humans. AdaMemento consists of a memory-reflection module for exploitation and a coarse-fine distinction module for exploration. The former focuses on refining the generality from past experiences in memory, while the latter continues to discover new policies in a fine-grained way and update the memory. The two modules are trained separately and then adaptively combined through ensemble learning. Altogether, the exploitation of memory promotes deeper exploration, which in turn provides high-quality experiences for effective exploitation.
</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">Specifically, the memory-reflection module maintains memory buffers of successful and failed trajectories to train two networks to predict and evaluate actions based on real-time states. Firstly, the prediction network summarizes past trajectories into a local shortest-path policy. Then the reflection network receives both successful and failed experiences for memory reflection training, outputting confidence of the predicted policy. Collaboratively, the memory prediction and reflection learn the mapping from states to the optimal policy, enabling the agent to follow the current shortest path to the endpoint of the previous trajectory and continue exploring.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="189" id="S1.F1.g1" src="x1.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Different granularity of state discrimination. (a) versus (b) represents fine-grained distinction, where the state images look similar but are of completely different importance, which is not well addressed in previous research.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">Moreover, we argue that the effectiveness of memory depends heavily on the quality of data gathered during exploration. Therefore, instead of solely focusing on the memory mechanism, AdaMemento also improves the exploration policy and emphasizes on its collaboration with memory.
Existing exploration-centric methods formulate intrinsic rewards based on states’ visual novelty <cite class="ltx_cite ltx_citemacro_citep">(Burda et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#bib.bib9" title="">2018b</a>; Pathak et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#bib.bib21" title="">2017</a>; Guo et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#bib.bib15" title="">2022</a>)</cite>. However, the novelty based on the whole state is too coarse to precisely distinguish the potential importance differences of visually similar states, as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_tag">1</span></a>.
We propose a coarse-fine distinction module, which not only discovers novel states through reconstruction error of raw state images but also enables fine-grained discrimination of similar states via sparsity of latent representations. The fine-grained incentive avoids confusion between similar states and increases the likelihood of discovering potentially better policies.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p7">
<p class="ltx_p" id="S1.p7.1">In summary, AdaMemento’s memory mechanism considers both successful and failed policies in that it draws the shortest path from positive experiences and reflects on how to avoid risks from negative ones, as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_tag">2</span></a>. Thus, our exploitation of memory differs from simple experience replay or imitation (e.g., SIL, DTSIL). By incorporating fine-grained state distinction into intrinsic rewards, we establish a new intrinsic reward paradigm and theoretically prove its validity. Finally, through ensemble learning, AdaMemento achieves an adaptive balance between exploration and exploitation by adaptively choosing actions from the memory-based prediction and the enhanced exploration based on evaluated confidence after reflection. We theoretically prove that the coordinated policy outperforms the original one.</p>
</div>
<figure class="ltx_figure" id="S1.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="191" id="S1.F2.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>The figure shows that the left side represents past experience trajectories stored in the memory buffer. AdaMemento learns to avoid danger and continues updating the current optimal strategy by synthesizing and reflecting on the commonalities in these trajectories. The updated strategy is illustrated on the right side.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S1.p8">
<p class="ltx_p" id="S1.p8.1">To thoroughly validate the effectiveness and generalization ability of AdaMemento, we tested its performance across 56 Atari and MuJoCo environments. Experimental results demonstrate that AdaMemento performs well and stably generalizes to a broad range of environments, from discrete to continuous and from sparse reward to dense reward settings. Especially in the most challenging Montezuma’s Revenge, AdaMemento achieves more than 15 times gain in total rewards. In addition, to clearly illustrate the effectiveness of each module on exploration and exploitation capabilities, we conduct visualization experiments. The results show that the ensemble of memory reflection helps the agent to reach the goal with significantly fewer steps in hard environments, and the coarse-fine distinction enables a larger range of and finer-grained exploration even when rewards are extremely sparse. Besides, it is important to note that the major hyper-parameters of AdaMemento are kept the same across all experimental environments, confirming the advantage in robustness of our method.
In summary, this paper presents the following three contributions:
</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We propose a memory-reflection mechanism that embeds both successful and failed experiences into network weights, which, unlike the imitation in existing memory methods, enables more accurate prediction of trajectories and confidence levels.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">To supply memory with high-quality experience data, we propose a new paradigm of intrinsic motivation based on reconstruction errors of state images and sparsity of latent encodings, for which we provide theoretical proof of no deviation from the optimal policy.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">We leverage ensemble learning to adaptively coordinate between the exploitation of memory and the exploration of new policies, which makes AdaMemento flexible to integrate with existing methods and boosts their performance with a theoretical guarantee.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related work</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Memory-based RL</h3>
<div class="ltx_para ltx_noindent" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">Current memory-based RL methods can be divided into two main categories, i.e., storage-based methods and experience replay. Storage-based methods retain past states and manage the memory buffer using clustering, as seen in works like NGU <cite class="ltx_cite ltx_citemacro_citep">(Badia et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#bib.bib4" title="">2020b</a>)</cite> and BT-NGU <cite class="ltx_cite ltx_citemacro_citep">(Campos et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#bib.bib10" title="">2021</a>)</cite>. These methods compare the current state with the stored cluster centers to help the agent discover novel states and enhance exploration efficiency. However, these approaches are essentially state counting via a memory buffer rather than fully utilizing the knowledge of past experiences.
Experience replay methods, such as SIL <cite class="ltx_cite ltx_citemacro_citep">(Oh et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#bib.bib19" title="">2018</a>)</cite> and DTSIL <cite class="ltx_cite ltx_citemacro_citep">(Guo et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#bib.bib14" title="">2020</a>)</cite>, accelerate policy convergence by replaying past advantageous experiences. However, experience replay often overlooks the importance of exploring new policies and reflecting on failed experiences, which can lead to suboptimal policies.
Moreover, existing memory-based RL methods often manage the memory buffer through clustering, which can lead to incorrectly clustering similar states with different values in high-dimensional state spaces. This neglects critical nuances, potentially missing opportunities for policy optimization.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Intrinsic motivation</h3>
<div class="ltx_para ltx_noindent" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">Intrinsic motivation models based on curiosity to guide exploration have gained attention for addressing sparse and delayed rewards. These methods can be broadly categorized into two types: count-based and prediction error-based. Count-based methods <cite class="ltx_cite ltx_citemacro_citep">(Bellemare et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#bib.bib6" title="">2016</a>)</cite> track state visitation frequency and provide higher rewards for less-explored states. While simple and intuitive, they suffer from significant storage pressure in complex environments due to the large state space. In contrast, prediction error-based methods <cite class="ltx_cite ltx_citemacro_citep">(Burda et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#bib.bib9" title="">2018b</a>; Pathak et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#bib.bib21" title="">2017</a>)</cite> evaluate state density using neural networks and reward more on the low-density states, without requiring additional storage, offering a notable improvement in constructing intrinsic motivation compared to count-based approaches.</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.1">Current intrinsic motivation models essentially rely on state novelty as the measure of intrinsic rewards. While these methods perform well in early exploration, existing metrics of state novelty are insufficient. As the training progresses, the marginal benefit of intrinsic rewards diminishes once most states have been explored, leading to a significant drop in exploration efficiency and to the “aimless exploration dilemma” <cite class="ltx_cite ltx_citemacro_citep">(Barto et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#bib.bib5" title="">2013</a>)</cite>. A finer-grained metric for that can distinguish the nuances of similar states is needed for better intrinsic motivation.</p>
</div>
<figure class="ltx_figure" id="S2.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="374" id="S2.F3.g1" src="x3.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span><span class="ltx_text ltx_font_bold" id="S2.F3.2.1">AdaMemento’s framework.</span> We evaluate each sub-module in (a) and parameters in (b) and (c).</figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Method</h2>
<div class="ltx_para ltx_noindent" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">In RL, refining and extracting common patterns from diverse memory experiences to guide subsequent exploration is more efficient than starting from scratch.
Effective utilization of memory requires not only reflecting on and integrating diverse past experiences but also incorporating sufficient exploration to approach a globally optimal policy. Based on this motivation, we propose the AdaMemento, an innovative memory-guided RL framework. As illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S2.F3" title="Figure 3 ‣ 2.2 Intrinsic motivation ‣ 2 Related work ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_tag">3</span></a>, AdaMemento enhances the policy with a memory-reflection module for exploitation and a coarse-fine distinction module for exploration, and carefully balances the two mechanisms.
In Section <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S3.SS1" title="3.1 Memory-reflection module ‣ 3 Method ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_tag">3.1</span></a>, we describe the design of the memory-reflection mechanism. In Section <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S3.SS2" title="3.2 Coarse-fine distinction module ‣ 3 Method ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_tag">3.2</span></a>, we introduce the coarse-fine distinction mechanism and prove the rationality of the new paradigm of intrinsic rewards; in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S3.SS3" title="3.3 Ensemble learning for exploration-exploitation balance ‣ 3 Method ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_tag">3.3</span></a>, we employ ensemble learning to achieve adaptive coordination between exploration and exploitation, the effectiveness of which is theoretically guaranteed.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Memory-reflection module</h3>
<div class="ltx_para ltx_noindent" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">Unlike previous approaches that rely solely on successful experiences, an effective memory mechanism should extract valuable insights from successful experiences and learn to avoid risks from failures, which means the agent should possess the ability to reflect on memory. Therefore, we introduce a memory-reflection module that incorporates both positive and negative experiences to improve the utilization of memory, as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S2.F3" title="Figure 3 ‣ 2.2 Intrinsic motivation ‣ 2 Related work ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_tag">3</span></a>(A). During training, we maintain two fix-sized memory buffers of history trajectories and use them to train a prediction network and a reflection network.</p>
</div>
<section class="ltx_subsubsection" id="S3.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.1 </span>Prediction network</h4>
<figure class="ltx_figure" id="S3.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="221" id="S3.F4.g1" src="x4.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span><span class="ltx_text ltx_font_bold" id="S3.F4.2.1">Comparison in Montezuma’s Revenge Environment. </span>(a) illustrates a comparison between baseline methods before and after integration with our AdaMemento; (b) presents a performance comparison to other advanced baseline models.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS1.p1">
<p class="ltx_p" id="S3.SS1.SSS1.p1.1">In reality, common states in different trajectories often form the shortest path to the goal, making extracting and summarizing these shared experiences more critical than simply mimicking a single trajectory.
Therefore, unlike traditional memory methods that simply replicate or imitate specific trajectories, we design the prediction network to extract and summarize common experiences. It independently trains on state-action pairs selected from a memory buffer of past advantageous trajectories. The benefit of this approach is that the prediction network can identify and embed the common patterns of advantageous experiences into the network weights, thereby learning to capture the underlying policy that links states to actions rather than simply repeating past actions, which can be applied across various environments and conditions.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS1.p2">
<p class="ltx_p" id="S3.SS1.SSS1.p2.3">Given a pair of state <math alttext="s" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p2.1.m1.1"><semantics id="S3.SS1.SSS1.p2.1.m1.1a"><mi id="S3.SS1.SSS1.p2.1.m1.1.1" xref="S3.SS1.SSS1.p2.1.m1.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p2.1.m1.1b"><ci id="S3.SS1.SSS1.p2.1.m1.1.1.cmml" xref="S3.SS1.SSS1.p2.1.m1.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.1.m1.1c">s</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p2.1.m1.1d">italic_s</annotation></semantics></math> and the actual action <math alttext="a" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p2.2.m2.1"><semantics id="S3.SS1.SSS1.p2.2.m2.1a"><mi id="S3.SS1.SSS1.p2.2.m2.1.1" xref="S3.SS1.SSS1.p2.2.m2.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p2.2.m2.1b"><ci id="S3.SS1.SSS1.p2.2.m2.1.1.cmml" xref="S3.SS1.SSS1.p2.2.m2.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.2.m2.1c">a</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p2.2.m2.1d">italic_a</annotation></semantics></math> from the advantageous memory buffer, we align the output action <math alttext="\hat{a}" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p2.3.m3.1"><semantics id="S3.SS1.SSS1.p2.3.m3.1a"><mover accent="true" id="S3.SS1.SSS1.p2.3.m3.1.1" xref="S3.SS1.SSS1.p2.3.m3.1.1.cmml"><mi id="S3.SS1.SSS1.p2.3.m3.1.1.2" xref="S3.SS1.SSS1.p2.3.m3.1.1.2.cmml">a</mi><mo id="S3.SS1.SSS1.p2.3.m3.1.1.1" xref="S3.SS1.SSS1.p2.3.m3.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p2.3.m3.1b"><apply id="S3.SS1.SSS1.p2.3.m3.1.1.cmml" xref="S3.SS1.SSS1.p2.3.m3.1.1"><ci id="S3.SS1.SSS1.p2.3.m3.1.1.1.cmml" xref="S3.SS1.SSS1.p2.3.m3.1.1.1">^</ci><ci id="S3.SS1.SSS1.p2.3.m3.1.1.2.cmml" xref="S3.SS1.SSS1.p2.3.m3.1.1.2">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.3.m3.1c">\hat{a}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p2.3.m3.1d">over^ start_ARG italic_a end_ARG</annotation></semantics></math> of the prediction network with the goal of policy optimization, using the cross-entropy loss:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="loss(\pi_{\theta})=-\sum_{(s,a)\in M}\pi(a|s)\log\pi_{\theta}(\hat{a}|s)," class="ltx_Math" display="block" id="S3.E1.m1.3"><semantics id="S3.E1.m1.3a"><mrow id="S3.E1.m1.3.3.1" xref="S3.E1.m1.3.3.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1" xref="S3.E1.m1.3.3.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1.1" xref="S3.E1.m1.3.3.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.3.cmml">l</mi><mo id="S3.E1.m1.3.3.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.2.cmml">⁢</mo><mi id="S3.E1.m1.3.3.1.1.1.4" xref="S3.E1.m1.3.3.1.1.1.4.cmml">o</mi><mo id="S3.E1.m1.3.3.1.1.1.2a" xref="S3.E1.m1.3.3.1.1.1.2.cmml">⁢</mo><mi id="S3.E1.m1.3.3.1.1.1.5" xref="S3.E1.m1.3.3.1.1.1.5.cmml">s</mi><mo id="S3.E1.m1.3.3.1.1.1.2b" xref="S3.E1.m1.3.3.1.1.1.2.cmml">⁢</mo><mi id="S3.E1.m1.3.3.1.1.1.6" xref="S3.E1.m1.3.3.1.1.1.6.cmml">s</mi><mo id="S3.E1.m1.3.3.1.1.1.2c" xref="S3.E1.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S3.E1.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.3.3.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E1.m1.3.3.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.cmml">π</mi><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.3.cmml">θ</mi></msub><mo id="S3.E1.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="S3.E1.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.3.3.1.1.4" xref="S3.E1.m1.3.3.1.1.4.cmml">=</mo><mrow id="S3.E1.m1.3.3.1.1.3" xref="S3.E1.m1.3.3.1.1.3.cmml"><mo id="S3.E1.m1.3.3.1.1.3a" xref="S3.E1.m1.3.3.1.1.3.cmml">−</mo><mrow id="S3.E1.m1.3.3.1.1.3.2" xref="S3.E1.m1.3.3.1.1.3.2.cmml"><munder id="S3.E1.m1.3.3.1.1.3.2.3" xref="S3.E1.m1.3.3.1.1.3.2.3.cmml"><mo id="S3.E1.m1.3.3.1.1.3.2.3.2" movablelimits="false" xref="S3.E1.m1.3.3.1.1.3.2.3.2.cmml">∑</mo><mrow id="S3.E1.m1.2.2.2" xref="S3.E1.m1.2.2.2.cmml"><mrow id="S3.E1.m1.2.2.2.4.2" xref="S3.E1.m1.2.2.2.4.1.cmml"><mo id="S3.E1.m1.2.2.2.4.2.1" stretchy="false" xref="S3.E1.m1.2.2.2.4.1.cmml">(</mo><mi id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml">s</mi><mo id="S3.E1.m1.2.2.2.4.2.2" xref="S3.E1.m1.2.2.2.4.1.cmml">,</mo><mi id="S3.E1.m1.2.2.2.2" xref="S3.E1.m1.2.2.2.2.cmml">a</mi><mo id="S3.E1.m1.2.2.2.4.2.3" stretchy="false" xref="S3.E1.m1.2.2.2.4.1.cmml">)</mo></mrow><mo id="S3.E1.m1.2.2.2.3" xref="S3.E1.m1.2.2.2.3.cmml">∈</mo><mi id="S3.E1.m1.2.2.2.5" xref="S3.E1.m1.2.2.2.5.cmml">M</mi></mrow></munder><mrow id="S3.E1.m1.3.3.1.1.3.2.2" xref="S3.E1.m1.3.3.1.1.3.2.2.cmml"><mi id="S3.E1.m1.3.3.1.1.3.2.2.4" xref="S3.E1.m1.3.3.1.1.3.2.2.4.cmml">π</mi><mo id="S3.E1.m1.3.3.1.1.3.2.2.3" xref="S3.E1.m1.3.3.1.1.3.2.2.3.cmml">⁢</mo><mrow id="S3.E1.m1.3.3.1.1.2.1.1.1.1" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.cmml"><mo id="S3.E1.m1.3.3.1.1.2.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.cmml">|</mo><mi id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.3.cmml">s</mi></mrow><mo id="S3.E1.m1.3.3.1.1.2.1.1.1.1.3" stretchy="false" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E1.m1.3.3.1.1.3.2.2.3a" lspace="0.167em" xref="S3.E1.m1.3.3.1.1.3.2.2.3.cmml">⁢</mo><mrow id="S3.E1.m1.3.3.1.1.3.2.2.5" xref="S3.E1.m1.3.3.1.1.3.2.2.5.cmml"><mi id="S3.E1.m1.3.3.1.1.3.2.2.5.1" xref="S3.E1.m1.3.3.1.1.3.2.2.5.1.cmml">log</mi><mo id="S3.E1.m1.3.3.1.1.3.2.2.5a" lspace="0.167em" xref="S3.E1.m1.3.3.1.1.3.2.2.5.cmml">⁡</mo><msub id="S3.E1.m1.3.3.1.1.3.2.2.5.2" xref="S3.E1.m1.3.3.1.1.3.2.2.5.2.cmml"><mi id="S3.E1.m1.3.3.1.1.3.2.2.5.2.2" xref="S3.E1.m1.3.3.1.1.3.2.2.5.2.2.cmml">π</mi><mi id="S3.E1.m1.3.3.1.1.3.2.2.5.2.3" xref="S3.E1.m1.3.3.1.1.3.2.2.5.2.3.cmml">θ</mi></msub></mrow><mo id="S3.E1.m1.3.3.1.1.3.2.2.3b" xref="S3.E1.m1.3.3.1.1.3.2.2.3.cmml">⁢</mo><mrow id="S3.E1.m1.3.3.1.1.3.2.2.2.1" xref="S3.E1.m1.3.3.1.1.3.2.2.2.1.1.cmml"><mo id="S3.E1.m1.3.3.1.1.3.2.2.2.1.2" stretchy="false" xref="S3.E1.m1.3.3.1.1.3.2.2.2.1.1.cmml">(</mo><mrow id="S3.E1.m1.3.3.1.1.3.2.2.2.1.1" xref="S3.E1.m1.3.3.1.1.3.2.2.2.1.1.cmml"><mover accent="true" id="S3.E1.m1.3.3.1.1.3.2.2.2.1.1.2" xref="S3.E1.m1.3.3.1.1.3.2.2.2.1.1.2.cmml"><mi id="S3.E1.m1.3.3.1.1.3.2.2.2.1.1.2.2" xref="S3.E1.m1.3.3.1.1.3.2.2.2.1.1.2.2.cmml">a</mi><mo id="S3.E1.m1.3.3.1.1.3.2.2.2.1.1.2.1" xref="S3.E1.m1.3.3.1.1.3.2.2.2.1.1.2.1.cmml">^</mo></mover><mo fence="false" id="S3.E1.m1.3.3.1.1.3.2.2.2.1.1.1" xref="S3.E1.m1.3.3.1.1.3.2.2.2.1.1.1.cmml">|</mo><mi id="S3.E1.m1.3.3.1.1.3.2.2.2.1.1.3" xref="S3.E1.m1.3.3.1.1.3.2.2.2.1.1.3.cmml">s</mi></mrow><mo id="S3.E1.m1.3.3.1.1.3.2.2.2.1.3" stretchy="false" xref="S3.E1.m1.3.3.1.1.3.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E1.m1.3.3.1.2" xref="S3.E1.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.3b"><apply id="S3.E1.m1.3.3.1.1.cmml" xref="S3.E1.m1.3.3.1"><eq id="S3.E1.m1.3.3.1.1.4.cmml" xref="S3.E1.m1.3.3.1.1.4"></eq><apply id="S3.E1.m1.3.3.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1"><times id="S3.E1.m1.3.3.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.2"></times><ci id="S3.E1.m1.3.3.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.3">𝑙</ci><ci id="S3.E1.m1.3.3.1.1.1.4.cmml" xref="S3.E1.m1.3.3.1.1.1.4">𝑜</ci><ci id="S3.E1.m1.3.3.1.1.1.5.cmml" xref="S3.E1.m1.3.3.1.1.1.5">𝑠</ci><ci id="S3.E1.m1.3.3.1.1.1.6.cmml" xref="S3.E1.m1.3.3.1.1.1.6">𝑠</ci><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2">𝜋</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.3">𝜃</ci></apply></apply><apply id="S3.E1.m1.3.3.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.3"><minus id="S3.E1.m1.3.3.1.1.3.3.cmml" xref="S3.E1.m1.3.3.1.1.3"></minus><apply id="S3.E1.m1.3.3.1.1.3.2.cmml" xref="S3.E1.m1.3.3.1.1.3.2"><apply id="S3.E1.m1.3.3.1.1.3.2.3.cmml" xref="S3.E1.m1.3.3.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.3.2.3.1.cmml" xref="S3.E1.m1.3.3.1.1.3.2.3">subscript</csymbol><sum id="S3.E1.m1.3.3.1.1.3.2.3.2.cmml" xref="S3.E1.m1.3.3.1.1.3.2.3.2"></sum><apply id="S3.E1.m1.2.2.2.cmml" xref="S3.E1.m1.2.2.2"><in id="S3.E1.m1.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.3"></in><interval closure="open" id="S3.E1.m1.2.2.2.4.1.cmml" xref="S3.E1.m1.2.2.2.4.2"><ci id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1">𝑠</ci><ci id="S3.E1.m1.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2">𝑎</ci></interval><ci id="S3.E1.m1.2.2.2.5.cmml" xref="S3.E1.m1.2.2.2.5">𝑀</ci></apply></apply><apply id="S3.E1.m1.3.3.1.1.3.2.2.cmml" xref="S3.E1.m1.3.3.1.1.3.2.2"><times id="S3.E1.m1.3.3.1.1.3.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.3.2.2.3"></times><ci id="S3.E1.m1.3.3.1.1.3.2.2.4.cmml" xref="S3.E1.m1.3.3.1.1.3.2.2.4">𝜋</ci><apply id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1">conditional</csymbol><ci id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.2">𝑎</ci><ci id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.3">𝑠</ci></apply><apply id="S3.E1.m1.3.3.1.1.3.2.2.5.cmml" xref="S3.E1.m1.3.3.1.1.3.2.2.5"><log id="S3.E1.m1.3.3.1.1.3.2.2.5.1.cmml" xref="S3.E1.m1.3.3.1.1.3.2.2.5.1"></log><apply id="S3.E1.m1.3.3.1.1.3.2.2.5.2.cmml" xref="S3.E1.m1.3.3.1.1.3.2.2.5.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.3.2.2.5.2.1.cmml" xref="S3.E1.m1.3.3.1.1.3.2.2.5.2">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.3.2.2.5.2.2.cmml" xref="S3.E1.m1.3.3.1.1.3.2.2.5.2.2">𝜋</ci><ci id="S3.E1.m1.3.3.1.1.3.2.2.5.2.3.cmml" xref="S3.E1.m1.3.3.1.1.3.2.2.5.2.3">𝜃</ci></apply></apply><apply id="S3.E1.m1.3.3.1.1.3.2.2.2.1.1.cmml" xref="S3.E1.m1.3.3.1.1.3.2.2.2.1"><csymbol cd="latexml" id="S3.E1.m1.3.3.1.1.3.2.2.2.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.3.2.2.2.1.1.1">conditional</csymbol><apply id="S3.E1.m1.3.3.1.1.3.2.2.2.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.3.2.2.2.1.1.2"><ci id="S3.E1.m1.3.3.1.1.3.2.2.2.1.1.2.1.cmml" xref="S3.E1.m1.3.3.1.1.3.2.2.2.1.1.2.1">^</ci><ci id="S3.E1.m1.3.3.1.1.3.2.2.2.1.1.2.2.cmml" xref="S3.E1.m1.3.3.1.1.3.2.2.2.1.1.2.2">𝑎</ci></apply><ci id="S3.E1.m1.3.3.1.1.3.2.2.2.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.3.2.2.2.1.1.3">𝑠</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.3c">loss(\pi_{\theta})=-\sum_{(s,a)\in M}\pi(a|s)\log\pi_{\theta}(\hat{a}|s),</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.3d">italic_l italic_o italic_s italic_s ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ) = - ∑ start_POSTSUBSCRIPT ( italic_s , italic_a ) ∈ italic_M end_POSTSUBSCRIPT italic_π ( italic_a | italic_s ) roman_log italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( over^ start_ARG italic_a end_ARG | italic_s ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.SSS1.p2.5">where <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p2.4.m1.1"><semantics id="S3.SS1.SSS1.p2.4.m1.1a"><msub id="S3.SS1.SSS1.p2.4.m1.1.1" xref="S3.SS1.SSS1.p2.4.m1.1.1.cmml"><mi id="S3.SS1.SSS1.p2.4.m1.1.1.2" xref="S3.SS1.SSS1.p2.4.m1.1.1.2.cmml">π</mi><mi id="S3.SS1.SSS1.p2.4.m1.1.1.3" xref="S3.SS1.SSS1.p2.4.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p2.4.m1.1b"><apply id="S3.SS1.SSS1.p2.4.m1.1.1.cmml" xref="S3.SS1.SSS1.p2.4.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p2.4.m1.1.1.1.cmml" xref="S3.SS1.SSS1.p2.4.m1.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p2.4.m1.1.1.2.cmml" xref="S3.SS1.SSS1.p2.4.m1.1.1.2">𝜋</ci><ci id="S3.SS1.SSS1.p2.4.m1.1.1.3.cmml" xref="S3.SS1.SSS1.p2.4.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.4.m1.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p2.4.m1.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\pi" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p2.5.m2.1"><semantics id="S3.SS1.SSS1.p2.5.m2.1a"><mi id="S3.SS1.SSS1.p2.5.m2.1.1" xref="S3.SS1.SSS1.p2.5.m2.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p2.5.m2.1b"><ci id="S3.SS1.SSS1.p2.5.m2.1.1.cmml" xref="S3.SS1.SSS1.p2.5.m2.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.5.m2.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p2.5.m2.1d">italic_π</annotation></semantics></math> represent the policy from the prediction network and the policy drawn from the memory buffer of advantageous trajectories, respectively.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS1.p3">
<p class="ltx_p" id="S3.SS1.SSS1.p3.1">After training, the prediction network approximates the current local optimal policy from the consensus of past experiences to help the agent predict action sequences. This mechanism enables the agent to quickly leverage the shared patterns of advantageous trajectories from history to guide the agent to follow the shortest path and reach the previous endpoint to continue exploring, which improves training efficiency and accelerates the convergence to the globally optimal policy.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.2 </span>Reflection network</h4>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS2.p1">
<p class="ltx_p" id="S3.SS1.SSS2.p1.4">The reflection network is responsible for assessing the memory-based policy from the prediction network and outputting a corresponding confidence level (<math alttext="C_{\omega}" class="ltx_Math" display="inline" id="S3.SS1.SSS2.p1.1.m1.1"><semantics id="S3.SS1.SSS2.p1.1.m1.1a"><msub id="S3.SS1.SSS2.p1.1.m1.1.1" xref="S3.SS1.SSS2.p1.1.m1.1.1.cmml"><mi id="S3.SS1.SSS2.p1.1.m1.1.1.2" xref="S3.SS1.SSS2.p1.1.m1.1.1.2.cmml">C</mi><mi id="S3.SS1.SSS2.p1.1.m1.1.1.3" xref="S3.SS1.SSS2.p1.1.m1.1.1.3.cmml">ω</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p1.1.m1.1b"><apply id="S3.SS1.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p1.1.m1.1.1.1.cmml" xref="S3.SS1.SSS2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p1.1.m1.1.1.2.cmml" xref="S3.SS1.SSS2.p1.1.m1.1.1.2">𝐶</ci><ci id="S3.SS1.SSS2.p1.1.m1.1.1.3.cmml" xref="S3.SS1.SSS2.p1.1.m1.1.1.3">𝜔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p1.1.m1.1c">C_{\omega}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS2.p1.1.m1.1d">italic_C start_POSTSUBSCRIPT italic_ω end_POSTSUBSCRIPT</annotation></semantics></math>) indicating the quality of the action <math alttext="\hat{a}" class="ltx_Math" display="inline" id="S3.SS1.SSS2.p1.2.m2.1"><semantics id="S3.SS1.SSS2.p1.2.m2.1a"><mover accent="true" id="S3.SS1.SSS2.p1.2.m2.1.1" xref="S3.SS1.SSS2.p1.2.m2.1.1.cmml"><mi id="S3.SS1.SSS2.p1.2.m2.1.1.2" xref="S3.SS1.SSS2.p1.2.m2.1.1.2.cmml">a</mi><mo id="S3.SS1.SSS2.p1.2.m2.1.1.1" xref="S3.SS1.SSS2.p1.2.m2.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p1.2.m2.1b"><apply id="S3.SS1.SSS2.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS2.p1.2.m2.1.1"><ci id="S3.SS1.SSS2.p1.2.m2.1.1.1.cmml" xref="S3.SS1.SSS2.p1.2.m2.1.1.1">^</ci><ci id="S3.SS1.SSS2.p1.2.m2.1.1.2.cmml" xref="S3.SS1.SSS2.p1.2.m2.1.1.2">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p1.2.m2.1c">\hat{a}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS2.p1.2.m2.1d">over^ start_ARG italic_a end_ARG</annotation></semantics></math>. If <math alttext="\hat{a}" class="ltx_Math" display="inline" id="S3.SS1.SSS2.p1.3.m3.1"><semantics id="S3.SS1.SSS2.p1.3.m3.1a"><mover accent="true" id="S3.SS1.SSS2.p1.3.m3.1.1" xref="S3.SS1.SSS2.p1.3.m3.1.1.cmml"><mi id="S3.SS1.SSS2.p1.3.m3.1.1.2" xref="S3.SS1.SSS2.p1.3.m3.1.1.2.cmml">a</mi><mo id="S3.SS1.SSS2.p1.3.m3.1.1.1" xref="S3.SS1.SSS2.p1.3.m3.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p1.3.m3.1b"><apply id="S3.SS1.SSS2.p1.3.m3.1.1.cmml" xref="S3.SS1.SSS2.p1.3.m3.1.1"><ci id="S3.SS1.SSS2.p1.3.m3.1.1.1.cmml" xref="S3.SS1.SSS2.p1.3.m3.1.1.1">^</ci><ci id="S3.SS1.SSS2.p1.3.m3.1.1.2.cmml" xref="S3.SS1.SSS2.p1.3.m3.1.1.2">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p1.3.m3.1c">\hat{a}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS2.p1.3.m3.1d">over^ start_ARG italic_a end_ARG</annotation></semantics></math> tends to lead the agent to failure, the reflection confidence will be decreased; conversely, if <math alttext="\hat{a}" class="ltx_Math" display="inline" id="S3.SS1.SSS2.p1.4.m4.1"><semantics id="S3.SS1.SSS2.p1.4.m4.1a"><mover accent="true" id="S3.SS1.SSS2.p1.4.m4.1.1" xref="S3.SS1.SSS2.p1.4.m4.1.1.cmml"><mi id="S3.SS1.SSS2.p1.4.m4.1.1.2" xref="S3.SS1.SSS2.p1.4.m4.1.1.2.cmml">a</mi><mo id="S3.SS1.SSS2.p1.4.m4.1.1.1" xref="S3.SS1.SSS2.p1.4.m4.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p1.4.m4.1b"><apply id="S3.SS1.SSS2.p1.4.m4.1.1.cmml" xref="S3.SS1.SSS2.p1.4.m4.1.1"><ci id="S3.SS1.SSS2.p1.4.m4.1.1.1.cmml" xref="S3.SS1.SSS2.p1.4.m4.1.1.1">^</ci><ci id="S3.SS1.SSS2.p1.4.m4.1.1.2.cmml" xref="S3.SS1.SSS2.p1.4.m4.1.1.2">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p1.4.m4.1c">\hat{a}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS2.p1.4.m4.1d">over^ start_ARG italic_a end_ARG</annotation></semantics></math> contributes to the agent’s success, the reflection confidence is increased. The loss function is defined as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="loss_{C}(\omega)=\!\sum_{(s,a)\in M}\!\!\|C_{\omega}(s,a)-1\|^{2}+\!\sum_{(s,a%
)\in R}\!\!\|C_{\omega}(s,a)-0\|^{2}\!," class="ltx_Math" display="block" id="S3.E2.m1.10"><semantics id="S3.E2.m1.10a"><mrow id="S3.E2.m1.10.10.1" xref="S3.E2.m1.10.10.1.1.cmml"><mrow id="S3.E2.m1.10.10.1.1" xref="S3.E2.m1.10.10.1.1.cmml"><mrow id="S3.E2.m1.10.10.1.1.4" xref="S3.E2.m1.10.10.1.1.4.cmml"><mi id="S3.E2.m1.10.10.1.1.4.2" xref="S3.E2.m1.10.10.1.1.4.2.cmml">l</mi><mo id="S3.E2.m1.10.10.1.1.4.1" xref="S3.E2.m1.10.10.1.1.4.1.cmml">⁢</mo><mi id="S3.E2.m1.10.10.1.1.4.3" xref="S3.E2.m1.10.10.1.1.4.3.cmml">o</mi><mo id="S3.E2.m1.10.10.1.1.4.1a" xref="S3.E2.m1.10.10.1.1.4.1.cmml">⁢</mo><mi id="S3.E2.m1.10.10.1.1.4.4" xref="S3.E2.m1.10.10.1.1.4.4.cmml">s</mi><mo id="S3.E2.m1.10.10.1.1.4.1b" xref="S3.E2.m1.10.10.1.1.4.1.cmml">⁢</mo><msub id="S3.E2.m1.10.10.1.1.4.5" xref="S3.E2.m1.10.10.1.1.4.5.cmml"><mi id="S3.E2.m1.10.10.1.1.4.5.2" xref="S3.E2.m1.10.10.1.1.4.5.2.cmml">s</mi><mi id="S3.E2.m1.10.10.1.1.4.5.3" xref="S3.E2.m1.10.10.1.1.4.5.3.cmml">C</mi></msub><mo id="S3.E2.m1.10.10.1.1.4.1c" xref="S3.E2.m1.10.10.1.1.4.1.cmml">⁢</mo><mrow id="S3.E2.m1.10.10.1.1.4.6.2" xref="S3.E2.m1.10.10.1.1.4.cmml"><mo id="S3.E2.m1.10.10.1.1.4.6.2.1" stretchy="false" xref="S3.E2.m1.10.10.1.1.4.cmml">(</mo><mi id="S3.E2.m1.5.5" xref="S3.E2.m1.5.5.cmml">ω</mi><mo id="S3.E2.m1.10.10.1.1.4.6.2.2" stretchy="false" xref="S3.E2.m1.10.10.1.1.4.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.10.10.1.1.3" rspace="0.0539em" xref="S3.E2.m1.10.10.1.1.3.cmml">=</mo><mrow id="S3.E2.m1.10.10.1.1.2" xref="S3.E2.m1.10.10.1.1.2.cmml"><mrow id="S3.E2.m1.10.10.1.1.1.1" xref="S3.E2.m1.10.10.1.1.1.1.cmml"><munder id="S3.E2.m1.10.10.1.1.1.1.2" xref="S3.E2.m1.10.10.1.1.1.1.2.cmml"><mo id="S3.E2.m1.10.10.1.1.1.1.2.2" lspace="0.0539em" movablelimits="false" rspace="0em" xref="S3.E2.m1.10.10.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E2.m1.2.2.2" xref="S3.E2.m1.2.2.2.cmml"><mrow id="S3.E2.m1.2.2.2.4.2" xref="S3.E2.m1.2.2.2.4.1.cmml"><mo id="S3.E2.m1.2.2.2.4.2.1" stretchy="false" xref="S3.E2.m1.2.2.2.4.1.cmml">(</mo><mi id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">s</mi><mo id="S3.E2.m1.2.2.2.4.2.2" xref="S3.E2.m1.2.2.2.4.1.cmml">,</mo><mi id="S3.E2.m1.2.2.2.2" xref="S3.E2.m1.2.2.2.2.cmml">a</mi><mo id="S3.E2.m1.2.2.2.4.2.3" stretchy="false" xref="S3.E2.m1.2.2.2.4.1.cmml">)</mo></mrow><mo id="S3.E2.m1.2.2.2.3" xref="S3.E2.m1.2.2.2.3.cmml">∈</mo><mi id="S3.E2.m1.2.2.2.5" xref="S3.E2.m1.2.2.2.5.cmml">M</mi></mrow></munder><msup id="S3.E2.m1.10.10.1.1.1.1.1" xref="S3.E2.m1.10.10.1.1.1.1.1.cmml"><mrow id="S3.E2.m1.10.10.1.1.1.1.1.1.1" xref="S3.E2.m1.10.10.1.1.1.1.1.1.2.cmml"><mo id="S3.E2.m1.10.10.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E2.m1.10.10.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.2.cmml"><msub id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.2.2" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.2.2.2.cmml">C</mi><mi id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.2.2.3.cmml">ω</mi></msub><mo id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.2.1" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.2.3.1.cmml"><mo id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.2.3.2.1" stretchy="false" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.2.3.1.cmml">(</mo><mi id="S3.E2.m1.6.6" xref="S3.E2.m1.6.6.cmml">s</mi><mo id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.2.3.2.2" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.2.3.1.cmml">,</mo><mi id="S3.E2.m1.7.7" xref="S3.E2.m1.7.7.cmml">a</mi><mo id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.2.3.2.3" stretchy="false" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.cmml">−</mo><mn id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.E2.m1.10.10.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E2.m1.10.10.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E2.m1.10.10.1.1.1.1.1.3" xref="S3.E2.m1.10.10.1.1.1.1.1.3.cmml">2</mn></msup></mrow><mo id="S3.E2.m1.10.10.1.1.2.3" rspace="0.026em" xref="S3.E2.m1.10.10.1.1.2.3.cmml">+</mo><mrow id="S3.E2.m1.10.10.1.1.2.2" xref="S3.E2.m1.10.10.1.1.2.2.cmml"><munder id="S3.E2.m1.10.10.1.1.2.2.2" xref="S3.E2.m1.10.10.1.1.2.2.2.cmml"><mo id="S3.E2.m1.10.10.1.1.2.2.2.2" lspace="0.026em" movablelimits="false" rspace="0em" xref="S3.E2.m1.10.10.1.1.2.2.2.2.cmml">∑</mo><mrow id="S3.E2.m1.4.4.2" xref="S3.E2.m1.4.4.2.cmml"><mrow id="S3.E2.m1.4.4.2.4.2" xref="S3.E2.m1.4.4.2.4.1.cmml"><mo id="S3.E2.m1.4.4.2.4.2.1" stretchy="false" xref="S3.E2.m1.4.4.2.4.1.cmml">(</mo><mi id="S3.E2.m1.3.3.1.1" xref="S3.E2.m1.3.3.1.1.cmml">s</mi><mo id="S3.E2.m1.4.4.2.4.2.2" xref="S3.E2.m1.4.4.2.4.1.cmml">,</mo><mi id="S3.E2.m1.4.4.2.2" xref="S3.E2.m1.4.4.2.2.cmml">a</mi><mo id="S3.E2.m1.4.4.2.4.2.3" stretchy="false" xref="S3.E2.m1.4.4.2.4.1.cmml">)</mo></mrow><mo id="S3.E2.m1.4.4.2.3" xref="S3.E2.m1.4.4.2.3.cmml">∈</mo><mi id="S3.E2.m1.4.4.2.5" xref="S3.E2.m1.4.4.2.5.cmml">R</mi></mrow></munder><msup id="S3.E2.m1.10.10.1.1.2.2.1" xref="S3.E2.m1.10.10.1.1.2.2.1.cmml"><mrow id="S3.E2.m1.10.10.1.1.2.2.1.1.1" xref="S3.E2.m1.10.10.1.1.2.2.1.1.2.cmml"><mo id="S3.E2.m1.10.10.1.1.2.2.1.1.1.2" stretchy="false" xref="S3.E2.m1.10.10.1.1.2.2.1.1.2.1.cmml">‖</mo><mrow id="S3.E2.m1.10.10.1.1.2.2.1.1.1.1" xref="S3.E2.m1.10.10.1.1.2.2.1.1.1.1.cmml"><mrow id="S3.E2.m1.10.10.1.1.2.2.1.1.1.1.2" xref="S3.E2.m1.10.10.1.1.2.2.1.1.1.1.2.cmml"><msub id="S3.E2.m1.10.10.1.1.2.2.1.1.1.1.2.2" xref="S3.E2.m1.10.10.1.1.2.2.1.1.1.1.2.2.cmml"><mi id="S3.E2.m1.10.10.1.1.2.2.1.1.1.1.2.2.2" xref="S3.E2.m1.10.10.1.1.2.2.1.1.1.1.2.2.2.cmml">C</mi><mi id="S3.E2.m1.10.10.1.1.2.2.1.1.1.1.2.2.3" xref="S3.E2.m1.10.10.1.1.2.2.1.1.1.1.2.2.3.cmml">ω</mi></msub><mo id="S3.E2.m1.10.10.1.1.2.2.1.1.1.1.2.1" xref="S3.E2.m1.10.10.1.1.2.2.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S3.E2.m1.10.10.1.1.2.2.1.1.1.1.2.3.2" xref="S3.E2.m1.10.10.1.1.2.2.1.1.1.1.2.3.1.cmml"><mo id="S3.E2.m1.10.10.1.1.2.2.1.1.1.1.2.3.2.1" stretchy="false" xref="S3.E2.m1.10.10.1.1.2.2.1.1.1.1.2.3.1.cmml">(</mo><mi id="S3.E2.m1.8.8" xref="S3.E2.m1.8.8.cmml">s</mi><mo id="S3.E2.m1.10.10.1.1.2.2.1.1.1.1.2.3.2.2" xref="S3.E2.m1.10.10.1.1.2.2.1.1.1.1.2.3.1.cmml">,</mo><mi id="S3.E2.m1.9.9" xref="S3.E2.m1.9.9.cmml">a</mi><mo id="S3.E2.m1.10.10.1.1.2.2.1.1.1.1.2.3.2.3" stretchy="false" xref="S3.E2.m1.10.10.1.1.2.2.1.1.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.10.10.1.1.2.2.1.1.1.1.1" xref="S3.E2.m1.10.10.1.1.2.2.1.1.1.1.1.cmml">−</mo><mn id="S3.E2.m1.10.10.1.1.2.2.1.1.1.1.3" xref="S3.E2.m1.10.10.1.1.2.2.1.1.1.1.3.cmml">0</mn></mrow><mo id="S3.E2.m1.10.10.1.1.2.2.1.1.1.3" stretchy="false" xref="S3.E2.m1.10.10.1.1.2.2.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E2.m1.10.10.1.1.2.2.1.3" xref="S3.E2.m1.10.10.1.1.2.2.1.3.cmml">2</mn></msup></mrow></mrow></mrow><mo id="S3.E2.m1.10.10.1.2" xref="S3.E2.m1.10.10.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.10b"><apply id="S3.E2.m1.10.10.1.1.cmml" xref="S3.E2.m1.10.10.1"><eq id="S3.E2.m1.10.10.1.1.3.cmml" xref="S3.E2.m1.10.10.1.1.3"></eq><apply id="S3.E2.m1.10.10.1.1.4.cmml" xref="S3.E2.m1.10.10.1.1.4"><times id="S3.E2.m1.10.10.1.1.4.1.cmml" xref="S3.E2.m1.10.10.1.1.4.1"></times><ci id="S3.E2.m1.10.10.1.1.4.2.cmml" xref="S3.E2.m1.10.10.1.1.4.2">𝑙</ci><ci id="S3.E2.m1.10.10.1.1.4.3.cmml" xref="S3.E2.m1.10.10.1.1.4.3">𝑜</ci><ci id="S3.E2.m1.10.10.1.1.4.4.cmml" xref="S3.E2.m1.10.10.1.1.4.4">𝑠</ci><apply id="S3.E2.m1.10.10.1.1.4.5.cmml" xref="S3.E2.m1.10.10.1.1.4.5"><csymbol cd="ambiguous" id="S3.E2.m1.10.10.1.1.4.5.1.cmml" xref="S3.E2.m1.10.10.1.1.4.5">subscript</csymbol><ci id="S3.E2.m1.10.10.1.1.4.5.2.cmml" xref="S3.E2.m1.10.10.1.1.4.5.2">𝑠</ci><ci id="S3.E2.m1.10.10.1.1.4.5.3.cmml" xref="S3.E2.m1.10.10.1.1.4.5.3">𝐶</ci></apply><ci id="S3.E2.m1.5.5.cmml" xref="S3.E2.m1.5.5">𝜔</ci></apply><apply id="S3.E2.m1.10.10.1.1.2.cmml" xref="S3.E2.m1.10.10.1.1.2"><plus id="S3.E2.m1.10.10.1.1.2.3.cmml" xref="S3.E2.m1.10.10.1.1.2.3"></plus><apply id="S3.E2.m1.10.10.1.1.1.1.cmml" xref="S3.E2.m1.10.10.1.1.1.1"><apply id="S3.E2.m1.10.10.1.1.1.1.2.cmml" xref="S3.E2.m1.10.10.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.10.10.1.1.1.1.2.1.cmml" xref="S3.E2.m1.10.10.1.1.1.1.2">subscript</csymbol><sum id="S3.E2.m1.10.10.1.1.1.1.2.2.cmml" xref="S3.E2.m1.10.10.1.1.1.1.2.2"></sum><apply id="S3.E2.m1.2.2.2.cmml" xref="S3.E2.m1.2.2.2"><in id="S3.E2.m1.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.3"></in><interval closure="open" id="S3.E2.m1.2.2.2.4.1.cmml" xref="S3.E2.m1.2.2.2.4.2"><ci id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">𝑠</ci><ci id="S3.E2.m1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2">𝑎</ci></interval><ci id="S3.E2.m1.2.2.2.5.cmml" xref="S3.E2.m1.2.2.2.5">𝑀</ci></apply></apply><apply id="S3.E2.m1.10.10.1.1.1.1.1.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.10.10.1.1.1.1.1.2.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1">superscript</csymbol><apply id="S3.E2.m1.10.10.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.10.10.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1"><minus id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.2"><times id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.2.1"></times><apply id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.2.2.2">𝐶</ci><ci id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.2.2.3">𝜔</ci></apply><interval closure="open" id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.2.3.2"><ci id="S3.E2.m1.6.6.cmml" xref="S3.E2.m1.6.6">𝑠</ci><ci id="S3.E2.m1.7.7.cmml" xref="S3.E2.m1.7.7">𝑎</ci></interval></apply><cn id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.3">1</cn></apply></apply><cn id="S3.E2.m1.10.10.1.1.1.1.1.3.cmml" type="integer" xref="S3.E2.m1.10.10.1.1.1.1.1.3">2</cn></apply></apply><apply id="S3.E2.m1.10.10.1.1.2.2.cmml" xref="S3.E2.m1.10.10.1.1.2.2"><apply id="S3.E2.m1.10.10.1.1.2.2.2.cmml" xref="S3.E2.m1.10.10.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.10.10.1.1.2.2.2.1.cmml" xref="S3.E2.m1.10.10.1.1.2.2.2">subscript</csymbol><sum id="S3.E2.m1.10.10.1.1.2.2.2.2.cmml" xref="S3.E2.m1.10.10.1.1.2.2.2.2"></sum><apply id="S3.E2.m1.4.4.2.cmml" xref="S3.E2.m1.4.4.2"><in id="S3.E2.m1.4.4.2.3.cmml" xref="S3.E2.m1.4.4.2.3"></in><interval closure="open" id="S3.E2.m1.4.4.2.4.1.cmml" xref="S3.E2.m1.4.4.2.4.2"><ci id="S3.E2.m1.3.3.1.1.cmml" xref="S3.E2.m1.3.3.1.1">𝑠</ci><ci id="S3.E2.m1.4.4.2.2.cmml" xref="S3.E2.m1.4.4.2.2">𝑎</ci></interval><ci id="S3.E2.m1.4.4.2.5.cmml" xref="S3.E2.m1.4.4.2.5">𝑅</ci></apply></apply><apply id="S3.E2.m1.10.10.1.1.2.2.1.cmml" xref="S3.E2.m1.10.10.1.1.2.2.1"><csymbol cd="ambiguous" id="S3.E2.m1.10.10.1.1.2.2.1.2.cmml" xref="S3.E2.m1.10.10.1.1.2.2.1">superscript</csymbol><apply id="S3.E2.m1.10.10.1.1.2.2.1.1.2.cmml" xref="S3.E2.m1.10.10.1.1.2.2.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.10.10.1.1.2.2.1.1.2.1.cmml" xref="S3.E2.m1.10.10.1.1.2.2.1.1.1.2">norm</csymbol><apply id="S3.E2.m1.10.10.1.1.2.2.1.1.1.1.cmml" xref="S3.E2.m1.10.10.1.1.2.2.1.1.1.1"><minus id="S3.E2.m1.10.10.1.1.2.2.1.1.1.1.1.cmml" xref="S3.E2.m1.10.10.1.1.2.2.1.1.1.1.1"></minus><apply id="S3.E2.m1.10.10.1.1.2.2.1.1.1.1.2.cmml" xref="S3.E2.m1.10.10.1.1.2.2.1.1.1.1.2"><times id="S3.E2.m1.10.10.1.1.2.2.1.1.1.1.2.1.cmml" xref="S3.E2.m1.10.10.1.1.2.2.1.1.1.1.2.1"></times><apply id="S3.E2.m1.10.10.1.1.2.2.1.1.1.1.2.2.cmml" xref="S3.E2.m1.10.10.1.1.2.2.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.10.10.1.1.2.2.1.1.1.1.2.2.1.cmml" xref="S3.E2.m1.10.10.1.1.2.2.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E2.m1.10.10.1.1.2.2.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.10.10.1.1.2.2.1.1.1.1.2.2.2">𝐶</ci><ci id="S3.E2.m1.10.10.1.1.2.2.1.1.1.1.2.2.3.cmml" xref="S3.E2.m1.10.10.1.1.2.2.1.1.1.1.2.2.3">𝜔</ci></apply><interval closure="open" id="S3.E2.m1.10.10.1.1.2.2.1.1.1.1.2.3.1.cmml" xref="S3.E2.m1.10.10.1.1.2.2.1.1.1.1.2.3.2"><ci id="S3.E2.m1.8.8.cmml" xref="S3.E2.m1.8.8">𝑠</ci><ci id="S3.E2.m1.9.9.cmml" xref="S3.E2.m1.9.9">𝑎</ci></interval></apply><cn id="S3.E2.m1.10.10.1.1.2.2.1.1.1.1.3.cmml" type="integer" xref="S3.E2.m1.10.10.1.1.2.2.1.1.1.1.3">0</cn></apply></apply><cn id="S3.E2.m1.10.10.1.1.2.2.1.3.cmml" type="integer" xref="S3.E2.m1.10.10.1.1.2.2.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.10c">loss_{C}(\omega)=\!\sum_{(s,a)\in M}\!\!\|C_{\omega}(s,a)-1\|^{2}+\!\sum_{(s,a%
)\in R}\!\!\|C_{\omega}(s,a)-0\|^{2}\!,</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.10d">italic_l italic_o italic_s italic_s start_POSTSUBSCRIPT italic_C end_POSTSUBSCRIPT ( italic_ω ) = ∑ start_POSTSUBSCRIPT ( italic_s , italic_a ) ∈ italic_M end_POSTSUBSCRIPT ∥ italic_C start_POSTSUBSCRIPT italic_ω end_POSTSUBSCRIPT ( italic_s , italic_a ) - 1 ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + ∑ start_POSTSUBSCRIPT ( italic_s , italic_a ) ∈ italic_R end_POSTSUBSCRIPT ∥ italic_C start_POSTSUBSCRIPT italic_ω end_POSTSUBSCRIPT ( italic_s , italic_a ) - 0 ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.SSS2.p1.8">where <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.SSS2.p1.5.m1.1"><semantics id="S3.SS1.SSS2.p1.5.m1.1a"><mi id="S3.SS1.SSS2.p1.5.m1.1.1" xref="S3.SS1.SSS2.p1.5.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p1.5.m1.1b"><ci id="S3.SS1.SSS2.p1.5.m1.1.1.cmml" xref="S3.SS1.SSS2.p1.5.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p1.5.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS2.p1.5.m1.1d">italic_M</annotation></semantics></math> and <math alttext="R" class="ltx_Math" display="inline" id="S3.SS1.SSS2.p1.6.m2.1"><semantics id="S3.SS1.SSS2.p1.6.m2.1a"><mi id="S3.SS1.SSS2.p1.6.m2.1.1" xref="S3.SS1.SSS2.p1.6.m2.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p1.6.m2.1b"><ci id="S3.SS1.SSS2.p1.6.m2.1.1.cmml" xref="S3.SS1.SSS2.p1.6.m2.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p1.6.m2.1c">R</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS2.p1.6.m2.1d">italic_R</annotation></semantics></math> represent actions from two memory buffers, respectively, one containing successful experiences for memorization (referred to as <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.SSS2.p1.7.m3.1"><semantics id="S3.SS1.SSS2.p1.7.m3.1a"><mi id="S3.SS1.SSS2.p1.7.m3.1.1" xref="S3.SS1.SSS2.p1.7.m3.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p1.7.m3.1b"><ci id="S3.SS1.SSS2.p1.7.m3.1.1.cmml" xref="S3.SS1.SSS2.p1.7.m3.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p1.7.m3.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS2.p1.7.m3.1d">italic_M</annotation></semantics></math>-buffer) and the other containing failed experiences for reflection (referred to as <math alttext="R" class="ltx_Math" display="inline" id="S3.SS1.SSS2.p1.8.m4.1"><semantics id="S3.SS1.SSS2.p1.8.m4.1a"><mi id="S3.SS1.SSS2.p1.8.m4.1.1" xref="S3.SS1.SSS2.p1.8.m4.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p1.8.m4.1b"><ci id="S3.SS1.SSS2.p1.8.m4.1.1.cmml" xref="S3.SS1.SSS2.p1.8.m4.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p1.8.m4.1c">R</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS2.p1.8.m4.1d">italic_R</annotation></semantics></math>-buffer). Details of the two memory buffers are described in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#A4.SS1" title="D.1 Construction and update of memory buffers ‣ Appendix D Supplementary Experiment Details ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_tag">D.1</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS2.p2">
<p class="ltx_p" id="S3.SS1.SSS2.p2.5">Note that the above prediction network is trained only using the <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.SSS2.p2.1.m1.1"><semantics id="S3.SS1.SSS2.p2.1.m1.1a"><mi id="S3.SS1.SSS2.p2.1.m1.1.1" xref="S3.SS1.SSS2.p2.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.1.m1.1b"><ci id="S3.SS1.SSS2.p2.1.m1.1.1.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.1.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS2.p2.1.m1.1d">italic_M</annotation></semantics></math>-buffer while the reflection network is trained on both the <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.SSS2.p2.2.m2.1"><semantics id="S3.SS1.SSS2.p2.2.m2.1a"><mi id="S3.SS1.SSS2.p2.2.m2.1.1" xref="S3.SS1.SSS2.p2.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.2.m2.1b"><ci id="S3.SS1.SSS2.p2.2.m2.1.1.cmml" xref="S3.SS1.SSS2.p2.2.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.2.m2.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS2.p2.2.m2.1d">italic_M</annotation></semantics></math>-buffer and the <math alttext="R" class="ltx_Math" display="inline" id="S3.SS1.SSS2.p2.3.m3.1"><semantics id="S3.SS1.SSS2.p2.3.m3.1a"><mi id="S3.SS1.SSS2.p2.3.m3.1.1" xref="S3.SS1.SSS2.p2.3.m3.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.3.m3.1b"><ci id="S3.SS1.SSS2.p2.3.m3.1.1.cmml" xref="S3.SS1.SSS2.p2.3.m3.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.3.m3.1c">R</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS2.p2.3.m3.1d">italic_R</annotation></semantics></math>-buffer.
We force the confidence level of the action from the <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.SSS2.p2.4.m4.1"><semantics id="S3.SS1.SSS2.p2.4.m4.1a"><mi id="S3.SS1.SSS2.p2.4.m4.1.1" xref="S3.SS1.SSS2.p2.4.m4.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.4.m4.1b"><ci id="S3.SS1.SSS2.p2.4.m4.1.1.cmml" xref="S3.SS1.SSS2.p2.4.m4.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.4.m4.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS2.p2.4.m4.1d">italic_M</annotation></semantics></math>-buffer to be 1 and the action from the <math alttext="R" class="ltx_Math" display="inline" id="S3.SS1.SSS2.p2.5.m5.1"><semantics id="S3.SS1.SSS2.p2.5.m5.1a"><mi id="S3.SS1.SSS2.p2.5.m5.1.1" xref="S3.SS1.SSS2.p2.5.m5.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.5.m5.1b"><ci id="S3.SS1.SSS2.p2.5.m5.1.1.cmml" xref="S3.SS1.SSS2.p2.5.m5.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.5.m5.1c">R</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS2.p2.5.m5.1d">italic_R</annotation></semantics></math>-buffer to be 0.
This mechanism enhances the robustness of the overall decision-making system by offering dynamic feedback and optimization of prediction accuracy.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Coarse-fine distinction module</h3>
<figure class="ltx_figure" id="S3.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="443" id="S3.F5.g1" src="x5.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span><span class="ltx_text ltx_font_bold" id="S3.F5.2.1">Generalization experiments in discrete-space environments (Atari).</span> The x-axis represents timesteps in 10 million.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">Memory reflection requires diverse historical experiences to progressively approach the global optimum, which depends on high-quality exploration, particularly in complex tasks with sparse rewards. To address this, we propose an innovative coarse-fine distinction module, where we establish a new intrinsic motivation paradigm and introduce a fine-grained distinction mechanism. As illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S2.F3" title="Figure 3 ‣ 2.2 Intrinsic motivation ‣ 2 Related work ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_tag">3</span></a>(B), this paradigm integrates both state novelty and fine-grained distinctions between similar states while unifying the training of exploration policy networks with intrinsic motivation metrics. We also provide theoretical proof for its retaining of the optimal policy. Therefore, it not only enhances the generalizability of fine-grained exploration. More importantly, it provides high-quality exploration data to support the exploitation of memory proposed in this work.</p>
</div>
<section class="ltx_subsubsection" id="S3.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.1 </span>Intrinsic reward design</h4>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS1.p1">
<p class="ltx_p" id="S3.SS2.SSS1.p1.5">As illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S2.F3" title="Figure 3 ‣ 2.2 Intrinsic motivation ‣ 2 Related work ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_tag">3</span></a>(A), our intrinsic reward design is based on a two-level distinction scheme responsible for coarse state novelty and fine-grained distinctions between similar states, denoted as C-Discriminator and F-Discriminator respectively.
Given a raw image of a state as the input <math alttext="s_{t}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.1.m1.1"><semantics id="S3.SS2.SSS1.p1.1.m1.1a"><msub id="S3.SS2.SSS1.p1.1.m1.1.1" xref="S3.SS2.SSS1.p1.1.m1.1.1.cmml"><mi id="S3.SS2.SSS1.p1.1.m1.1.1.2" xref="S3.SS2.SSS1.p1.1.m1.1.1.2.cmml">s</mi><mi id="S3.SS2.SSS1.p1.1.m1.1.1.3" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.1.m1.1b"><apply id="S3.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.2">𝑠</ci><ci id="S3.SS2.SSS1.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.1.m1.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.1.m1.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, the C-Discriminator learns the feature representations <math alttext="f_{\theta}(s_{t})" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.2.m2.1"><semantics id="S3.SS2.SSS1.p1.2.m2.1a"><mrow id="S3.SS2.SSS1.p1.2.m2.1.1" xref="S3.SS2.SSS1.p1.2.m2.1.1.cmml"><msub id="S3.SS2.SSS1.p1.2.m2.1.1.3" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.cmml"><mi id="S3.SS2.SSS1.p1.2.m2.1.1.3.2" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.2.cmml">f</mi><mi id="S3.SS2.SSS1.p1.2.m2.1.1.3.3" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.3.cmml">θ</mi></msub><mo id="S3.SS2.SSS1.p1.2.m2.1.1.2" xref="S3.SS2.SSS1.p1.2.m2.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.SSS1.p1.2.m2.1.1.1.1" xref="S3.SS2.SSS1.p1.2.m2.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS1.p1.2.m2.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS1.p1.2.m2.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.SSS1.p1.2.m2.1.1.1.1.1" xref="S3.SS2.SSS1.p1.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p1.2.m2.1.1.1.1.1.2" xref="S3.SS2.SSS1.p1.2.m2.1.1.1.1.1.2.cmml">s</mi><mi id="S3.SS2.SSS1.p1.2.m2.1.1.1.1.1.3" xref="S3.SS2.SSS1.p1.2.m2.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS2.SSS1.p1.2.m2.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS1.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.2.m2.1b"><apply id="S3.SS2.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1"><times id="S3.SS2.SSS1.p1.2.m2.1.1.2.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.2"></times><apply id="S3.SS2.SSS1.p1.2.m2.1.1.3.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.2.m2.1.1.3.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS1.p1.2.m2.1.1.3.2.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.2">𝑓</ci><ci id="S3.SS2.SSS1.p1.2.m2.1.1.3.3.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.3">𝜃</ci></apply><apply id="S3.SS2.SSS1.p1.2.m2.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.1.1.1.2">𝑠</ci><ci id="S3.SS2.SSS1.p1.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.2.m2.1c">f_{\theta}(s_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.2.m2.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> and reconstructs the image <math alttext="\hat{s}_{t}=g_{\phi}(f_{\theta}(s_{t}))" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.3.m3.1"><semantics id="S3.SS2.SSS1.p1.3.m3.1a"><mrow id="S3.SS2.SSS1.p1.3.m3.1.1" xref="S3.SS2.SSS1.p1.3.m3.1.1.cmml"><msub id="S3.SS2.SSS1.p1.3.m3.1.1.3" xref="S3.SS2.SSS1.p1.3.m3.1.1.3.cmml"><mover accent="true" id="S3.SS2.SSS1.p1.3.m3.1.1.3.2" xref="S3.SS2.SSS1.p1.3.m3.1.1.3.2.cmml"><mi id="S3.SS2.SSS1.p1.3.m3.1.1.3.2.2" xref="S3.SS2.SSS1.p1.3.m3.1.1.3.2.2.cmml">s</mi><mo id="S3.SS2.SSS1.p1.3.m3.1.1.3.2.1" xref="S3.SS2.SSS1.p1.3.m3.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.SS2.SSS1.p1.3.m3.1.1.3.3" xref="S3.SS2.SSS1.p1.3.m3.1.1.3.3.cmml">t</mi></msub><mo id="S3.SS2.SSS1.p1.3.m3.1.1.2" xref="S3.SS2.SSS1.p1.3.m3.1.1.2.cmml">=</mo><mrow id="S3.SS2.SSS1.p1.3.m3.1.1.1" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.cmml"><msub id="S3.SS2.SSS1.p1.3.m3.1.1.1.3" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.3.cmml"><mi id="S3.SS2.SSS1.p1.3.m3.1.1.1.3.2" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.3.2.cmml">g</mi><mi id="S3.SS2.SSS1.p1.3.m3.1.1.1.3.3" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.3.3.cmml">ϕ</mi></msub><mo id="S3.SS2.SSS1.p1.3.m3.1.1.1.2" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.cmml"><msub id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.3" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.3.2" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.3.2.cmml">f</mi><mi id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.3.3" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.2" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.1.1" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.1.1.1" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.1.1.1.2" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.1.1.1.3" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.3.m3.1b"><apply id="S3.SS2.SSS1.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1"><eq id="S3.SS2.SSS1.p1.3.m3.1.1.2.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.2"></eq><apply id="S3.SS2.SSS1.p1.3.m3.1.1.3.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.3.m3.1.1.3.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.3">subscript</csymbol><apply id="S3.SS2.SSS1.p1.3.m3.1.1.3.2.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.3.2"><ci id="S3.SS2.SSS1.p1.3.m3.1.1.3.2.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.3.2.1">^</ci><ci id="S3.SS2.SSS1.p1.3.m3.1.1.3.2.2.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.3.2.2">𝑠</ci></apply><ci id="S3.SS2.SSS1.p1.3.m3.1.1.3.3.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.3.3">𝑡</ci></apply><apply id="S3.SS2.SSS1.p1.3.m3.1.1.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.1"><times id="S3.SS2.SSS1.p1.3.m3.1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.2"></times><apply id="S3.SS2.SSS1.p1.3.m3.1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.3.m3.1.1.1.3.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS1.p1.3.m3.1.1.1.3.2.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.3.2">𝑔</ci><ci id="S3.SS2.SSS1.p1.3.m3.1.1.1.3.3.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.3.3">italic-ϕ</ci></apply><apply id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1"><times id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.2"></times><apply id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.3.2">𝑓</ci><ci id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.3.3">𝜃</ci></apply><apply id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.3.m3.1c">\hat{s}_{t}=g_{\phi}(f_{\theta}(s_{t}))</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.3.m3.1d">over^ start_ARG italic_s end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_g start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) )</annotation></semantics></math>. Then we use the reconstruction error between <math alttext="\hat{s}_{t}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.4.m4.1"><semantics id="S3.SS2.SSS1.p1.4.m4.1a"><msub id="S3.SS2.SSS1.p1.4.m4.1.1" xref="S3.SS2.SSS1.p1.4.m4.1.1.cmml"><mover accent="true" id="S3.SS2.SSS1.p1.4.m4.1.1.2" xref="S3.SS2.SSS1.p1.4.m4.1.1.2.cmml"><mi id="S3.SS2.SSS1.p1.4.m4.1.1.2.2" xref="S3.SS2.SSS1.p1.4.m4.1.1.2.2.cmml">s</mi><mo id="S3.SS2.SSS1.p1.4.m4.1.1.2.1" xref="S3.SS2.SSS1.p1.4.m4.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS2.SSS1.p1.4.m4.1.1.3" xref="S3.SS2.SSS1.p1.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.4.m4.1b"><apply id="S3.SS2.SSS1.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.4.m4.1.1.1.cmml" xref="S3.SS2.SSS1.p1.4.m4.1.1">subscript</csymbol><apply id="S3.SS2.SSS1.p1.4.m4.1.1.2.cmml" xref="S3.SS2.SSS1.p1.4.m4.1.1.2"><ci id="S3.SS2.SSS1.p1.4.m4.1.1.2.1.cmml" xref="S3.SS2.SSS1.p1.4.m4.1.1.2.1">^</ci><ci id="S3.SS2.SSS1.p1.4.m4.1.1.2.2.cmml" xref="S3.SS2.SSS1.p1.4.m4.1.1.2.2">𝑠</ci></apply><ci id="S3.SS2.SSS1.p1.4.m4.1.1.3.cmml" xref="S3.SS2.SSS1.p1.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.4.m4.1c">\hat{s}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.4.m4.1d">over^ start_ARG italic_s end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="s_{t}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.5.m5.1"><semantics id="S3.SS2.SSS1.p1.5.m5.1a"><msub id="S3.SS2.SSS1.p1.5.m5.1.1" xref="S3.SS2.SSS1.p1.5.m5.1.1.cmml"><mi id="S3.SS2.SSS1.p1.5.m5.1.1.2" xref="S3.SS2.SSS1.p1.5.m5.1.1.2.cmml">s</mi><mi id="S3.SS2.SSS1.p1.5.m5.1.1.3" xref="S3.SS2.SSS1.p1.5.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.5.m5.1b"><apply id="S3.SS2.SSS1.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.5.m5.1.1.1.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.5.m5.1.1.2.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1.2">𝑠</ci><ci id="S3.SS2.SSS1.p1.5.m5.1.1.3.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.5.m5.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.5.m5.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> as the coarse-grained measurement to identify novel images from the frequently trained images. For example, the states that have been explored many times can be distinguished from the states similar to those in previous scenarios due to their different fitting degree in the reconstruction network.
Therefore, the reconstruction error can be used to guide the agent to explore unknown or infrequent states.
</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS1.p2">
<p class="ltx_p" id="S3.SS2.SSS1.p2.3">The C-Discriminator is useful for novel state exploration, but reconstruction error cannot distinguish visually similar states, which is necessary for challenging environments with subtle feedback. For instance, consecutive images may have similar reconstruction errors from the network, but the importance they represent could be entirely different, e.g., an image close to the reward versus its nearby image that traps the agent (Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_tag">1</span></a>(a) versus <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_tag">1</span></a>(b)). Therefore, we further propose an innovative F-Discriminator to support the fine-grained distinction of states. The F-Discriminator poses a sparse constraint to the feature vector <math alttext="f_{\theta}(s_{t})" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.1.m1.1"><semantics id="S3.SS2.SSS1.p2.1.m1.1a"><mrow id="S3.SS2.SSS1.p2.1.m1.1.1" xref="S3.SS2.SSS1.p2.1.m1.1.1.cmml"><msub id="S3.SS2.SSS1.p2.1.m1.1.1.3" xref="S3.SS2.SSS1.p2.1.m1.1.1.3.cmml"><mi id="S3.SS2.SSS1.p2.1.m1.1.1.3.2" xref="S3.SS2.SSS1.p2.1.m1.1.1.3.2.cmml">f</mi><mi id="S3.SS2.SSS1.p2.1.m1.1.1.3.3" xref="S3.SS2.SSS1.p2.1.m1.1.1.3.3.cmml">θ</mi></msub><mo id="S3.SS2.SSS1.p2.1.m1.1.1.2" xref="S3.SS2.SSS1.p2.1.m1.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.SSS1.p2.1.m1.1.1.1.1" xref="S3.SS2.SSS1.p2.1.m1.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS1.p2.1.m1.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS1.p2.1.m1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.SSS1.p2.1.m1.1.1.1.1.1" xref="S3.SS2.SSS1.p2.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p2.1.m1.1.1.1.1.1.2" xref="S3.SS2.SSS1.p2.1.m1.1.1.1.1.1.2.cmml">s</mi><mi id="S3.SS2.SSS1.p2.1.m1.1.1.1.1.1.3" xref="S3.SS2.SSS1.p2.1.m1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS2.SSS1.p2.1.m1.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS1.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.1.m1.1b"><apply id="S3.SS2.SSS1.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1"><times id="S3.SS2.SSS1.p2.1.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1.2"></times><apply id="S3.SS2.SSS1.p2.1.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.1.m1.1.1.3.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS1.p2.1.m1.1.1.3.2.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1.3.2">𝑓</ci><ci id="S3.SS2.SSS1.p2.1.m1.1.1.3.3.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1.3.3">𝜃</ci></apply><apply id="S3.SS2.SSS1.p2.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p2.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1.1.1.1.2">𝑠</ci><ci id="S3.SS2.SSS1.p2.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.1.m1.1c">f_{\theta}(s_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.1.m1.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> with a <math alttext="\ell_{1}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.2.m2.1"><semantics id="S3.SS2.SSS1.p2.2.m2.1a"><msub id="S3.SS2.SSS1.p2.2.m2.1.1" xref="S3.SS2.SSS1.p2.2.m2.1.1.cmml"><mi id="S3.SS2.SSS1.p2.2.m2.1.1.2" mathvariant="normal" xref="S3.SS2.SSS1.p2.2.m2.1.1.2.cmml">ℓ</mi><mn id="S3.SS2.SSS1.p2.2.m2.1.1.3" xref="S3.SS2.SSS1.p2.2.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.2.m2.1b"><apply id="S3.SS2.SSS1.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.2.m2.1.1.1.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p2.2.m2.1.1.2.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1.2">ℓ</ci><cn id="S3.SS2.SSS1.p2.2.m2.1.1.3.cmml" type="integer" xref="S3.SS2.SSS1.p2.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.2.m2.1c">\ell_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.2.m2.1d">roman_ℓ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>-norm regularization.
By analyzing the sparsity of <math alttext="f_{\theta}(s_{t})" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.3.m3.1"><semantics id="S3.SS2.SSS1.p2.3.m3.1a"><mrow id="S3.SS2.SSS1.p2.3.m3.1.1" xref="S3.SS2.SSS1.p2.3.m3.1.1.cmml"><msub id="S3.SS2.SSS1.p2.3.m3.1.1.3" xref="S3.SS2.SSS1.p2.3.m3.1.1.3.cmml"><mi id="S3.SS2.SSS1.p2.3.m3.1.1.3.2" xref="S3.SS2.SSS1.p2.3.m3.1.1.3.2.cmml">f</mi><mi id="S3.SS2.SSS1.p2.3.m3.1.1.3.3" xref="S3.SS2.SSS1.p2.3.m3.1.1.3.3.cmml">θ</mi></msub><mo id="S3.SS2.SSS1.p2.3.m3.1.1.2" xref="S3.SS2.SSS1.p2.3.m3.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.SSS1.p2.3.m3.1.1.1.1" xref="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS1.p2.3.m3.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1" xref="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.2" xref="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.2.cmml">s</mi><mi id="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.3" xref="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS2.SSS1.p2.3.m3.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.3.m3.1b"><apply id="S3.SS2.SSS1.p2.3.m3.1.1.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1"><times id="S3.SS2.SSS1.p2.3.m3.1.1.2.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1.2"></times><apply id="S3.SS2.SSS1.p2.3.m3.1.1.3.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.3.m3.1.1.3.1.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS1.p2.3.m3.1.1.3.2.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1.3.2">𝑓</ci><ci id="S3.SS2.SSS1.p2.3.m3.1.1.3.3.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1.3.3">𝜃</ci></apply><apply id="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.2">𝑠</ci><ci id="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.3.m3.1c">f_{\theta}(s_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.3.m3.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>, we can precisely distinguish between trained states, states similar to trained ones, and entirely new states.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS1.p3">
<p class="ltx_p" id="S3.SS2.SSS1.p3.3">We unify the exploration policy’s network training loss with the coarse-fine intrinsic motivation measure, formulating our new paradigm as below:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="R_{I}=loss_{f,g}(\theta,\phi)=\frac{1}{2}\left\|s_{t}-g_{\phi}(f_{\theta}(s_{t%
}))\right\|_{2}^{2}+\lambda\left\|f_{\theta}(s_{t})\right\|_{1}," class="ltx_Math" display="block" id="S3.E3.m1.5"><semantics id="S3.E3.m1.5a"><mrow id="S3.E3.m1.5.5.1" xref="S3.E3.m1.5.5.1.1.cmml"><mrow id="S3.E3.m1.5.5.1.1" xref="S3.E3.m1.5.5.1.1.cmml"><msub id="S3.E3.m1.5.5.1.1.4" xref="S3.E3.m1.5.5.1.1.4.cmml"><mi id="S3.E3.m1.5.5.1.1.4.2" xref="S3.E3.m1.5.5.1.1.4.2.cmml">R</mi><mi id="S3.E3.m1.5.5.1.1.4.3" xref="S3.E3.m1.5.5.1.1.4.3.cmml">I</mi></msub><mo id="S3.E3.m1.5.5.1.1.5" xref="S3.E3.m1.5.5.1.1.5.cmml">=</mo><mrow id="S3.E3.m1.5.5.1.1.6" xref="S3.E3.m1.5.5.1.1.6.cmml"><mi id="S3.E3.m1.5.5.1.1.6.2" xref="S3.E3.m1.5.5.1.1.6.2.cmml">l</mi><mo id="S3.E3.m1.5.5.1.1.6.1" xref="S3.E3.m1.5.5.1.1.6.1.cmml">⁢</mo><mi id="S3.E3.m1.5.5.1.1.6.3" xref="S3.E3.m1.5.5.1.1.6.3.cmml">o</mi><mo id="S3.E3.m1.5.5.1.1.6.1a" xref="S3.E3.m1.5.5.1.1.6.1.cmml">⁢</mo><mi id="S3.E3.m1.5.5.1.1.6.4" xref="S3.E3.m1.5.5.1.1.6.4.cmml">s</mi><mo id="S3.E3.m1.5.5.1.1.6.1b" xref="S3.E3.m1.5.5.1.1.6.1.cmml">⁢</mo><msub id="S3.E3.m1.5.5.1.1.6.5" xref="S3.E3.m1.5.5.1.1.6.5.cmml"><mi id="S3.E3.m1.5.5.1.1.6.5.2" xref="S3.E3.m1.5.5.1.1.6.5.2.cmml">s</mi><mrow id="S3.E3.m1.2.2.2.4" xref="S3.E3.m1.2.2.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml">f</mi><mo id="S3.E3.m1.2.2.2.4.1" xref="S3.E3.m1.2.2.2.3.cmml">,</mo><mi id="S3.E3.m1.2.2.2.2" xref="S3.E3.m1.2.2.2.2.cmml">g</mi></mrow></msub><mo id="S3.E3.m1.5.5.1.1.6.1c" xref="S3.E3.m1.5.5.1.1.6.1.cmml">⁢</mo><mrow id="S3.E3.m1.5.5.1.1.6.6.2" xref="S3.E3.m1.5.5.1.1.6.6.1.cmml"><mo id="S3.E3.m1.5.5.1.1.6.6.2.1" stretchy="false" xref="S3.E3.m1.5.5.1.1.6.6.1.cmml">(</mo><mi id="S3.E3.m1.3.3" xref="S3.E3.m1.3.3.cmml">θ</mi><mo id="S3.E3.m1.5.5.1.1.6.6.2.2" xref="S3.E3.m1.5.5.1.1.6.6.1.cmml">,</mo><mi id="S3.E3.m1.4.4" xref="S3.E3.m1.4.4.cmml">ϕ</mi><mo id="S3.E3.m1.5.5.1.1.6.6.2.3" stretchy="false" xref="S3.E3.m1.5.5.1.1.6.6.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.5.5.1.1.7" xref="S3.E3.m1.5.5.1.1.7.cmml">=</mo><mrow id="S3.E3.m1.5.5.1.1.2" xref="S3.E3.m1.5.5.1.1.2.cmml"><mrow id="S3.E3.m1.5.5.1.1.1.1" xref="S3.E3.m1.5.5.1.1.1.1.cmml"><mfrac id="S3.E3.m1.5.5.1.1.1.1.3" xref="S3.E3.m1.5.5.1.1.1.1.3.cmml"><mn id="S3.E3.m1.5.5.1.1.1.1.3.2" xref="S3.E3.m1.5.5.1.1.1.1.3.2.cmml">1</mn><mn id="S3.E3.m1.5.5.1.1.1.1.3.3" xref="S3.E3.m1.5.5.1.1.1.1.3.3.cmml">2</mn></mfrac><mo id="S3.E3.m1.5.5.1.1.1.1.2" xref="S3.E3.m1.5.5.1.1.1.1.2.cmml">⁢</mo><msubsup id="S3.E3.m1.5.5.1.1.1.1.1" xref="S3.E3.m1.5.5.1.1.1.1.1.cmml"><mrow id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.cmml">s</mi><mi id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub><mo id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml">−</mo><mrow id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.2.cmml">g</mi><mi id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.3.cmml">ϕ</mi></msub><mo id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">f</mi><mi id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E3.m1.5.5.1.1.1.1.1.1.3" xref="S3.E3.m1.5.5.1.1.1.1.1.1.3.cmml">2</mn><mn id="S3.E3.m1.5.5.1.1.1.1.1.3" xref="S3.E3.m1.5.5.1.1.1.1.1.3.cmml">2</mn></msubsup></mrow><mo id="S3.E3.m1.5.5.1.1.2.3" xref="S3.E3.m1.5.5.1.1.2.3.cmml">+</mo><mrow id="S3.E3.m1.5.5.1.1.2.2" xref="S3.E3.m1.5.5.1.1.2.2.cmml"><mi id="S3.E3.m1.5.5.1.1.2.2.3" xref="S3.E3.m1.5.5.1.1.2.2.3.cmml">λ</mi><mo id="S3.E3.m1.5.5.1.1.2.2.2" xref="S3.E3.m1.5.5.1.1.2.2.2.cmml">⁢</mo><msub id="S3.E3.m1.5.5.1.1.2.2.1" xref="S3.E3.m1.5.5.1.1.2.2.1.cmml"><mrow id="S3.E3.m1.5.5.1.1.2.2.1.1.1" xref="S3.E3.m1.5.5.1.1.2.2.1.1.2.cmml"><mo id="S3.E3.m1.5.5.1.1.2.2.1.1.1.2" xref="S3.E3.m1.5.5.1.1.2.2.1.1.2.1.cmml">‖</mo><mrow id="S3.E3.m1.5.5.1.1.2.2.1.1.1.1" xref="S3.E3.m1.5.5.1.1.2.2.1.1.1.1.cmml"><msub id="S3.E3.m1.5.5.1.1.2.2.1.1.1.1.3" xref="S3.E3.m1.5.5.1.1.2.2.1.1.1.1.3.cmml"><mi id="S3.E3.m1.5.5.1.1.2.2.1.1.1.1.3.2" xref="S3.E3.m1.5.5.1.1.2.2.1.1.1.1.3.2.cmml">f</mi><mi id="S3.E3.m1.5.5.1.1.2.2.1.1.1.1.3.3" xref="S3.E3.m1.5.5.1.1.2.2.1.1.1.1.3.3.cmml">θ</mi></msub><mo id="S3.E3.m1.5.5.1.1.2.2.1.1.1.1.2" xref="S3.E3.m1.5.5.1.1.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1" xref="S3.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.cmml"><mo id="S3.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.2" stretchy="false" xref="S3.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1" xref="S3.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.2" xref="S3.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S3.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.3" xref="S3.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.3" stretchy="false" xref="S3.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.5.5.1.1.2.2.1.1.1.3" xref="S3.E3.m1.5.5.1.1.2.2.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E3.m1.5.5.1.1.2.2.1.3" xref="S3.E3.m1.5.5.1.1.2.2.1.3.cmml">1</mn></msub></mrow></mrow></mrow><mo id="S3.E3.m1.5.5.1.2" xref="S3.E3.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.5b"><apply id="S3.E3.m1.5.5.1.1.cmml" xref="S3.E3.m1.5.5.1"><and id="S3.E3.m1.5.5.1.1a.cmml" xref="S3.E3.m1.5.5.1"></and><apply id="S3.E3.m1.5.5.1.1b.cmml" xref="S3.E3.m1.5.5.1"><eq id="S3.E3.m1.5.5.1.1.5.cmml" xref="S3.E3.m1.5.5.1.1.5"></eq><apply id="S3.E3.m1.5.5.1.1.4.cmml" xref="S3.E3.m1.5.5.1.1.4"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.4.1.cmml" xref="S3.E3.m1.5.5.1.1.4">subscript</csymbol><ci id="S3.E3.m1.5.5.1.1.4.2.cmml" xref="S3.E3.m1.5.5.1.1.4.2">𝑅</ci><ci id="S3.E3.m1.5.5.1.1.4.3.cmml" xref="S3.E3.m1.5.5.1.1.4.3">𝐼</ci></apply><apply id="S3.E3.m1.5.5.1.1.6.cmml" xref="S3.E3.m1.5.5.1.1.6"><times id="S3.E3.m1.5.5.1.1.6.1.cmml" xref="S3.E3.m1.5.5.1.1.6.1"></times><ci id="S3.E3.m1.5.5.1.1.6.2.cmml" xref="S3.E3.m1.5.5.1.1.6.2">𝑙</ci><ci id="S3.E3.m1.5.5.1.1.6.3.cmml" xref="S3.E3.m1.5.5.1.1.6.3">𝑜</ci><ci id="S3.E3.m1.5.5.1.1.6.4.cmml" xref="S3.E3.m1.5.5.1.1.6.4">𝑠</ci><apply id="S3.E3.m1.5.5.1.1.6.5.cmml" xref="S3.E3.m1.5.5.1.1.6.5"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.6.5.1.cmml" xref="S3.E3.m1.5.5.1.1.6.5">subscript</csymbol><ci id="S3.E3.m1.5.5.1.1.6.5.2.cmml" xref="S3.E3.m1.5.5.1.1.6.5.2">𝑠</ci><list id="S3.E3.m1.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.4"><ci id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1">𝑓</ci><ci id="S3.E3.m1.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2">𝑔</ci></list></apply><interval closure="open" id="S3.E3.m1.5.5.1.1.6.6.1.cmml" xref="S3.E3.m1.5.5.1.1.6.6.2"><ci id="S3.E3.m1.3.3.cmml" xref="S3.E3.m1.3.3">𝜃</ci><ci id="S3.E3.m1.4.4.cmml" xref="S3.E3.m1.4.4">italic-ϕ</ci></interval></apply></apply><apply id="S3.E3.m1.5.5.1.1c.cmml" xref="S3.E3.m1.5.5.1"><eq id="S3.E3.m1.5.5.1.1.7.cmml" xref="S3.E3.m1.5.5.1.1.7"></eq><share href="https://arxiv.org/html/2410.04498v1#S3.E3.m1.5.5.1.1.6.cmml" id="S3.E3.m1.5.5.1.1d.cmml" xref="S3.E3.m1.5.5.1"></share><apply id="S3.E3.m1.5.5.1.1.2.cmml" xref="S3.E3.m1.5.5.1.1.2"><plus id="S3.E3.m1.5.5.1.1.2.3.cmml" xref="S3.E3.m1.5.5.1.1.2.3"></plus><apply id="S3.E3.m1.5.5.1.1.1.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1"><times id="S3.E3.m1.5.5.1.1.1.1.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.2"></times><apply id="S3.E3.m1.5.5.1.1.1.1.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.3"><divide id="S3.E3.m1.5.5.1.1.1.1.3.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.3"></divide><cn id="S3.E3.m1.5.5.1.1.1.1.3.2.cmml" type="integer" xref="S3.E3.m1.5.5.1.1.1.1.3.2">1</cn><cn id="S3.E3.m1.5.5.1.1.1.1.3.3.cmml" type="integer" xref="S3.E3.m1.5.5.1.1.1.1.3.3">2</cn></apply><apply id="S3.E3.m1.5.5.1.1.1.1.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.1.1.1.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1">superscript</csymbol><apply id="S3.E3.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1">subscript</csymbol><apply id="S3.E3.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.5.5.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1"><minus id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.2"></minus><apply id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.3.2">𝑠</ci><ci id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply><apply id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1"><times id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.2">𝑔</ci><ci id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.3">italic-ϕ</ci></apply><apply id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1"><times id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑓</ci><ci id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝜃</ci></apply><apply id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply></apply></apply><cn id="S3.E3.m1.5.5.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E3.m1.5.5.1.1.1.1.1.1.3">2</cn></apply><cn id="S3.E3.m1.5.5.1.1.1.1.1.3.cmml" type="integer" xref="S3.E3.m1.5.5.1.1.1.1.1.3">2</cn></apply></apply><apply id="S3.E3.m1.5.5.1.1.2.2.cmml" xref="S3.E3.m1.5.5.1.1.2.2"><times id="S3.E3.m1.5.5.1.1.2.2.2.cmml" xref="S3.E3.m1.5.5.1.1.2.2.2"></times><ci id="S3.E3.m1.5.5.1.1.2.2.3.cmml" xref="S3.E3.m1.5.5.1.1.2.2.3">𝜆</ci><apply id="S3.E3.m1.5.5.1.1.2.2.1.cmml" xref="S3.E3.m1.5.5.1.1.2.2.1"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.2.2.1.2.cmml" xref="S3.E3.m1.5.5.1.1.2.2.1">subscript</csymbol><apply id="S3.E3.m1.5.5.1.1.2.2.1.1.2.cmml" xref="S3.E3.m1.5.5.1.1.2.2.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.5.5.1.1.2.2.1.1.2.1.cmml" xref="S3.E3.m1.5.5.1.1.2.2.1.1.1.2">norm</csymbol><apply id="S3.E3.m1.5.5.1.1.2.2.1.1.1.1.cmml" xref="S3.E3.m1.5.5.1.1.2.2.1.1.1.1"><times id="S3.E3.m1.5.5.1.1.2.2.1.1.1.1.2.cmml" xref="S3.E3.m1.5.5.1.1.2.2.1.1.1.1.2"></times><apply id="S3.E3.m1.5.5.1.1.2.2.1.1.1.1.3.cmml" xref="S3.E3.m1.5.5.1.1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.2.2.1.1.1.1.3.1.cmml" xref="S3.E3.m1.5.5.1.1.2.2.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.5.5.1.1.2.2.1.1.1.1.3.2.cmml" xref="S3.E3.m1.5.5.1.1.2.2.1.1.1.1.3.2">𝑓</ci><ci id="S3.E3.m1.5.5.1.1.2.2.1.1.1.1.3.3.cmml" xref="S3.E3.m1.5.5.1.1.2.2.1.1.1.1.3.3">𝜃</ci></apply><apply id="S3.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S3.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply><cn id="S3.E3.m1.5.5.1.1.2.2.1.3.cmml" type="integer" xref="S3.E3.m1.5.5.1.1.2.2.1.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.5c">R_{I}=loss_{f,g}(\theta,\phi)=\frac{1}{2}\left\|s_{t}-g_{\phi}(f_{\theta}(s_{t%
}))\right\|_{2}^{2}+\lambda\left\|f_{\theta}(s_{t})\right\|_{1},</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.5d">italic_R start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT = italic_l italic_o italic_s italic_s start_POSTSUBSCRIPT italic_f , italic_g end_POSTSUBSCRIPT ( italic_θ , italic_ϕ ) = divide start_ARG 1 end_ARG start_ARG 2 end_ARG ∥ italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT - italic_g start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ) ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_λ ∥ italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ∥ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS1.p3.2">where <math alttext="f_{\theta}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p3.1.m1.1"><semantics id="S3.SS2.SSS1.p3.1.m1.1a"><msub id="S3.SS2.SSS1.p3.1.m1.1.1" xref="S3.SS2.SSS1.p3.1.m1.1.1.cmml"><mi id="S3.SS2.SSS1.p3.1.m1.1.1.2" xref="S3.SS2.SSS1.p3.1.m1.1.1.2.cmml">f</mi><mi id="S3.SS2.SSS1.p3.1.m1.1.1.3" xref="S3.SS2.SSS1.p3.1.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.1.m1.1b"><apply id="S3.SS2.SSS1.p3.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p3.1.m1.1.1.1.cmml" xref="S3.SS2.SSS1.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p3.1.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p3.1.m1.1.1.2">𝑓</ci><ci id="S3.SS2.SSS1.p3.1.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p3.1.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.1.m1.1c">f_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p3.1.m1.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="g_{\phi}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p3.2.m2.1"><semantics id="S3.SS2.SSS1.p3.2.m2.1a"><msub id="S3.SS2.SSS1.p3.2.m2.1.1" xref="S3.SS2.SSS1.p3.2.m2.1.1.cmml"><mi id="S3.SS2.SSS1.p3.2.m2.1.1.2" xref="S3.SS2.SSS1.p3.2.m2.1.1.2.cmml">g</mi><mi id="S3.SS2.SSS1.p3.2.m2.1.1.3" xref="S3.SS2.SSS1.p3.2.m2.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.2.m2.1b"><apply id="S3.SS2.SSS1.p3.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p3.2.m2.1.1.1.cmml" xref="S3.SS2.SSS1.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p3.2.m2.1.1.2.cmml" xref="S3.SS2.SSS1.p3.2.m2.1.1.2">𝑔</ci><ci id="S3.SS2.SSS1.p3.2.m2.1.1.3.cmml" xref="S3.SS2.SSS1.p3.2.m2.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.2.m2.1c">g_{\phi}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p3.2.m2.1d">italic_g start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math> respectively denote the feature extraction network (encoder) and reconstruction network (decoder).</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS1.p4">
<p class="ltx_p" id="S3.SS2.SSS1.p4.1">This paradigm innovatively distinguishes the importance of closely related similar images, thereby improving the accuracy of intrinsic rewards and enabling more precise allocation of exploration effort. Furthermore, the unified paradigm integrates network loss and intrinsic reward evaluation, avoiding the need for manual design across different tasks and enhancing its generalization ability for multi-task adaptation. The coarse-fine motivation not only achieves more precise state exploration but also provides more accurate learning samples for memory learning. Subsequent visualization experiments further validate these findings.
</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.2 </span>Proof of the retaining of policy optimality</h4>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS2.p1">
<p class="ltx_p" id="S3.SS2.SSS2.p1.1">In RL, ensuring the reliability of intrinsic rewards is crucial, especially in environments with sparse rewards. For our AdaMemento design, introducing the coarse-fine intrinsic exploration reward must not skew or misguide the learning agent away from its optimal policy. Here, we aim to ascertain the impact of our intrinsic exploration reward on the policy’s optimality. We start by introducing an assumption.</p>
</div>
<div class="ltx_theorem ltx_theorem_assumption" id="S3.Thmtheorem1">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="S3.Thmtheorem1.1.1.1">Assumption 3.1</span></span><span class="ltx_text ltx_font_bold" id="S3.Thmtheorem1.2.2">.</span>
</h6>
<div class="ltx_para" id="S3.Thmtheorem1.p1">
<p class="ltx_p" id="S3.Thmtheorem1.p1.7">After <math alttext="k" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.1.m1.1"><semantics id="S3.Thmtheorem1.p1.1.m1.1a"><mi id="S3.Thmtheorem1.p1.1.m1.1.1" xref="S3.Thmtheorem1.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.1.m1.1b"><ci id="S3.Thmtheorem1.p1.1.m1.1.1.cmml" xref="S3.Thmtheorem1.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.1.m1.1d">italic_k</annotation></semantics></math> updates, we assume <math alttext="0\leq\beta R_{I}\leq(1-\gamma)\min_{s}[Q^{*}(s,a^{*})-Q^{*}(s,a^{sub})]" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.2.m2.5"><semantics id="S3.Thmtheorem1.p1.2.m2.5a"><mrow id="S3.Thmtheorem1.p1.2.m2.5.5" xref="S3.Thmtheorem1.p1.2.m2.5.5.cmml"><mn id="S3.Thmtheorem1.p1.2.m2.5.5.5" xref="S3.Thmtheorem1.p1.2.m2.5.5.5.cmml">0</mn><mo id="S3.Thmtheorem1.p1.2.m2.5.5.6" xref="S3.Thmtheorem1.p1.2.m2.5.5.6.cmml">≤</mo><mrow id="S3.Thmtheorem1.p1.2.m2.5.5.7" xref="S3.Thmtheorem1.p1.2.m2.5.5.7.cmml"><mi id="S3.Thmtheorem1.p1.2.m2.5.5.7.2" xref="S3.Thmtheorem1.p1.2.m2.5.5.7.2.cmml">β</mi><mo id="S3.Thmtheorem1.p1.2.m2.5.5.7.1" xref="S3.Thmtheorem1.p1.2.m2.5.5.7.1.cmml">⁢</mo><msub id="S3.Thmtheorem1.p1.2.m2.5.5.7.3" xref="S3.Thmtheorem1.p1.2.m2.5.5.7.3.cmml"><mi id="S3.Thmtheorem1.p1.2.m2.5.5.7.3.2" xref="S3.Thmtheorem1.p1.2.m2.5.5.7.3.2.cmml">R</mi><mi id="S3.Thmtheorem1.p1.2.m2.5.5.7.3.3" xref="S3.Thmtheorem1.p1.2.m2.5.5.7.3.3.cmml">I</mi></msub></mrow><mo id="S3.Thmtheorem1.p1.2.m2.5.5.8" xref="S3.Thmtheorem1.p1.2.m2.5.5.8.cmml">≤</mo><mrow id="S3.Thmtheorem1.p1.2.m2.5.5.3" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.cmml"><mrow id="S3.Thmtheorem1.p1.2.m2.3.3.1.1.1" xref="S3.Thmtheorem1.p1.2.m2.3.3.1.1.1.1.cmml"><mo id="S3.Thmtheorem1.p1.2.m2.3.3.1.1.1.2" stretchy="false" xref="S3.Thmtheorem1.p1.2.m2.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.Thmtheorem1.p1.2.m2.3.3.1.1.1.1" xref="S3.Thmtheorem1.p1.2.m2.3.3.1.1.1.1.cmml"><mn id="S3.Thmtheorem1.p1.2.m2.3.3.1.1.1.1.2" xref="S3.Thmtheorem1.p1.2.m2.3.3.1.1.1.1.2.cmml">1</mn><mo id="S3.Thmtheorem1.p1.2.m2.3.3.1.1.1.1.1" xref="S3.Thmtheorem1.p1.2.m2.3.3.1.1.1.1.1.cmml">−</mo><mi id="S3.Thmtheorem1.p1.2.m2.3.3.1.1.1.1.3" xref="S3.Thmtheorem1.p1.2.m2.3.3.1.1.1.1.3.cmml">γ</mi></mrow><mo id="S3.Thmtheorem1.p1.2.m2.3.3.1.1.1.3" stretchy="false" xref="S3.Thmtheorem1.p1.2.m2.3.3.1.1.1.1.cmml">)</mo></mrow><mo id="S3.Thmtheorem1.p1.2.m2.5.5.3.4" lspace="0.167em" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.4.cmml">⁢</mo><mrow id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.3.cmml"><msub id="S3.Thmtheorem1.p1.2.m2.4.4.2.2.1.1" xref="S3.Thmtheorem1.p1.2.m2.4.4.2.2.1.1.cmml"><mi id="S3.Thmtheorem1.p1.2.m2.4.4.2.2.1.1.2" xref="S3.Thmtheorem1.p1.2.m2.4.4.2.2.1.1.2.cmml">min</mi><mi id="S3.Thmtheorem1.p1.2.m2.4.4.2.2.1.1.3" xref="S3.Thmtheorem1.p1.2.m2.4.4.2.2.1.1.3.cmml">s</mi></msub><mo id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2a" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.3.cmml">⁡</mo><mrow id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.3.cmml"><mo id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.2" stretchy="false" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.3.cmml">[</mo><mrow id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.cmml"><mrow id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.1" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.1.cmml"><msup id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.1.3" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.1.3.cmml"><mi id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.1.3.2" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.1.3.2.cmml">Q</mi><mo id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.1.3.3" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.1.3.3.cmml">∗</mo></msup><mo id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.1.2" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.1.2.cmml">⁢</mo><mrow id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.1.1.1" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.1.1.2.cmml"><mo id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.1.1.1.2" stretchy="false" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.1.1.2.cmml">(</mo><mi id="S3.Thmtheorem1.p1.2.m2.1.1" xref="S3.Thmtheorem1.p1.2.m2.1.1.cmml">s</mi><mo id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.1.1.1.3" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.1.1.2.cmml">,</mo><msup id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.1.1.1.1" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.1.1.1.1.cmml"><mi id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.1.1.1.1.2" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.1.1.1.1.2.cmml">a</mi><mo id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.1.1.1.1.3" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.1.1.1.1.3.cmml">∗</mo></msup><mo id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.1.1.1.4" stretchy="false" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.3" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.3.cmml">−</mo><mrow id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.cmml"><msup id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.3" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.3.cmml"><mi id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.3.2" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.3.2.cmml">Q</mi><mo id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.3.3" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.3.3.cmml">∗</mo></msup><mo id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.2" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.2.cmml">⁢</mo><mrow id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.1.1" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.1.2.cmml"><mo id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.1.1.2" stretchy="false" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.1.2.cmml">(</mo><mi id="S3.Thmtheorem1.p1.2.m2.2.2" xref="S3.Thmtheorem1.p1.2.m2.2.2.cmml">s</mi><mo id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.1.1.3" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.1.2.cmml">,</mo><msup id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.1.1.1" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.1.1.1.cmml"><mi id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.1.1.1.2" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.1.1.1.2.cmml">a</mi><mrow id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.1.1.1.3" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.1.1.1.3.cmml"><mi id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.1.1.1.3.2" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.1.1.1.3.2.cmml">s</mi><mo id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.1.1.1.3.1" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.1.1.1.3.1.cmml">⁢</mo><mi id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.1.1.1.3.3" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.1.1.1.3.3.cmml">u</mi><mo id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.1.1.1.3.1a" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.1.1.1.3.1.cmml">⁢</mo><mi id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.1.1.1.3.4" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.1.1.1.3.4.cmml">b</mi></mrow></msup><mo id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.1.1.4" stretchy="false" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.3" stretchy="false" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.3.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.2.m2.5b"><apply id="S3.Thmtheorem1.p1.2.m2.5.5.cmml" xref="S3.Thmtheorem1.p1.2.m2.5.5"><and id="S3.Thmtheorem1.p1.2.m2.5.5a.cmml" xref="S3.Thmtheorem1.p1.2.m2.5.5"></and><apply id="S3.Thmtheorem1.p1.2.m2.5.5b.cmml" xref="S3.Thmtheorem1.p1.2.m2.5.5"><leq id="S3.Thmtheorem1.p1.2.m2.5.5.6.cmml" xref="S3.Thmtheorem1.p1.2.m2.5.5.6"></leq><cn id="S3.Thmtheorem1.p1.2.m2.5.5.5.cmml" type="integer" xref="S3.Thmtheorem1.p1.2.m2.5.5.5">0</cn><apply id="S3.Thmtheorem1.p1.2.m2.5.5.7.cmml" xref="S3.Thmtheorem1.p1.2.m2.5.5.7"><times id="S3.Thmtheorem1.p1.2.m2.5.5.7.1.cmml" xref="S3.Thmtheorem1.p1.2.m2.5.5.7.1"></times><ci id="S3.Thmtheorem1.p1.2.m2.5.5.7.2.cmml" xref="S3.Thmtheorem1.p1.2.m2.5.5.7.2">𝛽</ci><apply id="S3.Thmtheorem1.p1.2.m2.5.5.7.3.cmml" xref="S3.Thmtheorem1.p1.2.m2.5.5.7.3"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.2.m2.5.5.7.3.1.cmml" xref="S3.Thmtheorem1.p1.2.m2.5.5.7.3">subscript</csymbol><ci id="S3.Thmtheorem1.p1.2.m2.5.5.7.3.2.cmml" xref="S3.Thmtheorem1.p1.2.m2.5.5.7.3.2">𝑅</ci><ci id="S3.Thmtheorem1.p1.2.m2.5.5.7.3.3.cmml" xref="S3.Thmtheorem1.p1.2.m2.5.5.7.3.3">𝐼</ci></apply></apply></apply><apply id="S3.Thmtheorem1.p1.2.m2.5.5c.cmml" xref="S3.Thmtheorem1.p1.2.m2.5.5"><leq id="S3.Thmtheorem1.p1.2.m2.5.5.8.cmml" xref="S3.Thmtheorem1.p1.2.m2.5.5.8"></leq><share href="https://arxiv.org/html/2410.04498v1#S3.Thmtheorem1.p1.2.m2.5.5.7.cmml" id="S3.Thmtheorem1.p1.2.m2.5.5d.cmml" xref="S3.Thmtheorem1.p1.2.m2.5.5"></share><apply id="S3.Thmtheorem1.p1.2.m2.5.5.3.cmml" xref="S3.Thmtheorem1.p1.2.m2.5.5.3"><times id="S3.Thmtheorem1.p1.2.m2.5.5.3.4.cmml" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.4"></times><apply id="S3.Thmtheorem1.p1.2.m2.3.3.1.1.1.1.cmml" xref="S3.Thmtheorem1.p1.2.m2.3.3.1.1.1"><minus id="S3.Thmtheorem1.p1.2.m2.3.3.1.1.1.1.1.cmml" xref="S3.Thmtheorem1.p1.2.m2.3.3.1.1.1.1.1"></minus><cn id="S3.Thmtheorem1.p1.2.m2.3.3.1.1.1.1.2.cmml" type="integer" xref="S3.Thmtheorem1.p1.2.m2.3.3.1.1.1.1.2">1</cn><ci id="S3.Thmtheorem1.p1.2.m2.3.3.1.1.1.1.3.cmml" xref="S3.Thmtheorem1.p1.2.m2.3.3.1.1.1.1.3">𝛾</ci></apply><apply id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.3.cmml" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2"><apply id="S3.Thmtheorem1.p1.2.m2.4.4.2.2.1.1.cmml" xref="S3.Thmtheorem1.p1.2.m2.4.4.2.2.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.2.m2.4.4.2.2.1.1.1.cmml" xref="S3.Thmtheorem1.p1.2.m2.4.4.2.2.1.1">subscript</csymbol><min id="S3.Thmtheorem1.p1.2.m2.4.4.2.2.1.1.2.cmml" xref="S3.Thmtheorem1.p1.2.m2.4.4.2.2.1.1.2"></min><ci id="S3.Thmtheorem1.p1.2.m2.4.4.2.2.1.1.3.cmml" xref="S3.Thmtheorem1.p1.2.m2.4.4.2.2.1.1.3">𝑠</ci></apply><apply id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.cmml" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1"><minus id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.3.cmml" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.3"></minus><apply id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.1.cmml" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.1"><times id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.1.2.cmml" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.1.2"></times><apply id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.1.3.cmml" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.1.3.1.cmml" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.1.3">superscript</csymbol><ci id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.1.3.2.cmml" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.1.3.2">𝑄</ci><times id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.1.3.3.cmml" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.1.3.3"></times></apply><interval closure="open" id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.1.1.2.cmml" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.1.1.1"><ci id="S3.Thmtheorem1.p1.2.m2.1.1.cmml" xref="S3.Thmtheorem1.p1.2.m2.1.1">𝑠</ci><apply id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.1.1.1.1.cmml" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.1.1.1.1.1.cmml" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.1.1.1.1">superscript</csymbol><ci id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.1.1.1.1.2.cmml" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.1.1.1.1.2">𝑎</ci><times id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.1.1.1.1.3.cmml" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.1.1.1.1.3"></times></apply></interval></apply><apply id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.cmml" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2"><times id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.2.cmml" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.2"></times><apply id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.3.cmml" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.3"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.3.1.cmml" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.3">superscript</csymbol><ci id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.3.2.cmml" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.3.2">𝑄</ci><times id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.3.3.cmml" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.3.3"></times></apply><interval closure="open" id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.1.2.cmml" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.1.1"><ci id="S3.Thmtheorem1.p1.2.m2.2.2.cmml" xref="S3.Thmtheorem1.p1.2.m2.2.2">𝑠</ci><apply id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.1.1.1.cmml" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.1.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.1.1.1.1.cmml" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.1.1.1">superscript</csymbol><ci id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.1.1.1.2.cmml" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.1.1.1.2">𝑎</ci><apply id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.1.1.1.3.cmml" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.1.1.1.3"><times id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.1.1.1.3.1.cmml" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.1.1.1.3.1"></times><ci id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.1.1.1.3.2.cmml" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.1.1.1.3.2">𝑠</ci><ci id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.1.1.1.3.3.cmml" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.1.1.1.3.3">𝑢</ci><ci id="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.1.1.1.3.4.cmml" xref="S3.Thmtheorem1.p1.2.m2.5.5.3.3.2.2.1.2.1.1.1.3.4">𝑏</ci></apply></apply></interval></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.2.m2.5c">0\leq\beta R_{I}\leq(1-\gamma)\min_{s}[Q^{*}(s,a^{*})-Q^{*}(s,a^{sub})]</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.2.m2.5d">0 ≤ italic_β italic_R start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT ≤ ( 1 - italic_γ ) roman_min start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT [ italic_Q start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s , italic_a start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ) - italic_Q start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s , italic_a start_POSTSUPERSCRIPT italic_s italic_u italic_b end_POSTSUPERSCRIPT ) ]</annotation></semantics></math> holds, where <math alttext="Q^{*}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.3.m3.1"><semantics id="S3.Thmtheorem1.p1.3.m3.1a"><msup id="S3.Thmtheorem1.p1.3.m3.1.1" xref="S3.Thmtheorem1.p1.3.m3.1.1.cmml"><mi id="S3.Thmtheorem1.p1.3.m3.1.1.2" xref="S3.Thmtheorem1.p1.3.m3.1.1.2.cmml">Q</mi><mo id="S3.Thmtheorem1.p1.3.m3.1.1.3" xref="S3.Thmtheorem1.p1.3.m3.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.3.m3.1b"><apply id="S3.Thmtheorem1.p1.3.m3.1.1.cmml" xref="S3.Thmtheorem1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.3.m3.1.1.1.cmml" xref="S3.Thmtheorem1.p1.3.m3.1.1">superscript</csymbol><ci id="S3.Thmtheorem1.p1.3.m3.1.1.2.cmml" xref="S3.Thmtheorem1.p1.3.m3.1.1.2">𝑄</ci><times id="S3.Thmtheorem1.p1.3.m3.1.1.3.cmml" xref="S3.Thmtheorem1.p1.3.m3.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.3.m3.1c">Q^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.3.m3.1d">italic_Q start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> is the optimal <math alttext="Q" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.4.m4.1"><semantics id="S3.Thmtheorem1.p1.4.m4.1a"><mi id="S3.Thmtheorem1.p1.4.m4.1.1" xref="S3.Thmtheorem1.p1.4.m4.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.4.m4.1b"><ci id="S3.Thmtheorem1.p1.4.m4.1.1.cmml" xref="S3.Thmtheorem1.p1.4.m4.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.4.m4.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.4.m4.1d">italic_Q</annotation></semantics></math> function, <math alttext="a^{*}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.5.m5.1"><semantics id="S3.Thmtheorem1.p1.5.m5.1a"><msup id="S3.Thmtheorem1.p1.5.m5.1.1" xref="S3.Thmtheorem1.p1.5.m5.1.1.cmml"><mi id="S3.Thmtheorem1.p1.5.m5.1.1.2" xref="S3.Thmtheorem1.p1.5.m5.1.1.2.cmml">a</mi><mo id="S3.Thmtheorem1.p1.5.m5.1.1.3" xref="S3.Thmtheorem1.p1.5.m5.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.5.m5.1b"><apply id="S3.Thmtheorem1.p1.5.m5.1.1.cmml" xref="S3.Thmtheorem1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.5.m5.1.1.1.cmml" xref="S3.Thmtheorem1.p1.5.m5.1.1">superscript</csymbol><ci id="S3.Thmtheorem1.p1.5.m5.1.1.2.cmml" xref="S3.Thmtheorem1.p1.5.m5.1.1.2">𝑎</ci><times id="S3.Thmtheorem1.p1.5.m5.1.1.3.cmml" xref="S3.Thmtheorem1.p1.5.m5.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.5.m5.1c">a^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.5.m5.1d">italic_a start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="a^{sub}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.6.m6.1"><semantics id="S3.Thmtheorem1.p1.6.m6.1a"><msup id="S3.Thmtheorem1.p1.6.m6.1.1" xref="S3.Thmtheorem1.p1.6.m6.1.1.cmml"><mi id="S3.Thmtheorem1.p1.6.m6.1.1.2" xref="S3.Thmtheorem1.p1.6.m6.1.1.2.cmml">a</mi><mrow id="S3.Thmtheorem1.p1.6.m6.1.1.3" xref="S3.Thmtheorem1.p1.6.m6.1.1.3.cmml"><mi id="S3.Thmtheorem1.p1.6.m6.1.1.3.2" xref="S3.Thmtheorem1.p1.6.m6.1.1.3.2.cmml">s</mi><mo id="S3.Thmtheorem1.p1.6.m6.1.1.3.1" xref="S3.Thmtheorem1.p1.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S3.Thmtheorem1.p1.6.m6.1.1.3.3" xref="S3.Thmtheorem1.p1.6.m6.1.1.3.3.cmml">u</mi><mo id="S3.Thmtheorem1.p1.6.m6.1.1.3.1a" xref="S3.Thmtheorem1.p1.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S3.Thmtheorem1.p1.6.m6.1.1.3.4" xref="S3.Thmtheorem1.p1.6.m6.1.1.3.4.cmml">b</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.6.m6.1b"><apply id="S3.Thmtheorem1.p1.6.m6.1.1.cmml" xref="S3.Thmtheorem1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.6.m6.1.1.1.cmml" xref="S3.Thmtheorem1.p1.6.m6.1.1">superscript</csymbol><ci id="S3.Thmtheorem1.p1.6.m6.1.1.2.cmml" xref="S3.Thmtheorem1.p1.6.m6.1.1.2">𝑎</ci><apply id="S3.Thmtheorem1.p1.6.m6.1.1.3.cmml" xref="S3.Thmtheorem1.p1.6.m6.1.1.3"><times id="S3.Thmtheorem1.p1.6.m6.1.1.3.1.cmml" xref="S3.Thmtheorem1.p1.6.m6.1.1.3.1"></times><ci id="S3.Thmtheorem1.p1.6.m6.1.1.3.2.cmml" xref="S3.Thmtheorem1.p1.6.m6.1.1.3.2">𝑠</ci><ci id="S3.Thmtheorem1.p1.6.m6.1.1.3.3.cmml" xref="S3.Thmtheorem1.p1.6.m6.1.1.3.3">𝑢</ci><ci id="S3.Thmtheorem1.p1.6.m6.1.1.3.4.cmml" xref="S3.Thmtheorem1.p1.6.m6.1.1.3.4">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.6.m6.1c">a^{sub}</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.6.m6.1d">italic_a start_POSTSUPERSCRIPT italic_s italic_u italic_b end_POSTSUPERSCRIPT</annotation></semantics></math> are optimal and suboptimal actions under the state <math alttext="s" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.7.m7.1"><semantics id="S3.Thmtheorem1.p1.7.m7.1a"><mi id="S3.Thmtheorem1.p1.7.m7.1.1" xref="S3.Thmtheorem1.p1.7.m7.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.7.m7.1b"><ci id="S3.Thmtheorem1.p1.7.m7.1.1.cmml" xref="S3.Thmtheorem1.p1.7.m7.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.7.m7.1c">s</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.7.m7.1d">italic_s</annotation></semantics></math>, respectively.</p>
</div>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS2.p2">
<p class="ltx_p" id="S3.SS2.SSS2.p2.1">Assumption <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S3.Thmtheorem1" title="Assumption 3.1. ‣ 3.2.2 Proof of the retaining of policy optimality ‣ 3.2 Coarse-fine distinction module ‣ 3 Method ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_tag">3.1</span></a> is reasonable as the networks are trained to minimize the losses, and hence, the accompanying intrinsic rewards will be smaller enough after certain steps of training. Under this trivial assumption, we can prove that our new intrinsic motivation paradigm will retain the optimality of policy.</p>
</div>
<div class="ltx_theorem ltx_theorem_theorem" id="S3.Thmtheorem2">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="S3.Thmtheorem2.1.1.1">Theorem 3.2</span></span><span class="ltx_text ltx_font_bold" id="S3.Thmtheorem2.2.2">.</span>
</h6>
<div class="ltx_para" id="S3.Thmtheorem2.p1">
<p class="ltx_p" id="S3.Thmtheorem2.p1.2"><span class="ltx_text ltx_font_italic" id="S3.Thmtheorem2.p1.2.2">After <math alttext="k" class="ltx_Math" display="inline" id="S3.Thmtheorem2.p1.1.1.m1.1"><semantics id="S3.Thmtheorem2.p1.1.1.m1.1a"><mi id="S3.Thmtheorem2.p1.1.1.m1.1.1" xref="S3.Thmtheorem2.p1.1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem2.p1.1.1.m1.1b"><ci id="S3.Thmtheorem2.p1.1.1.m1.1.1.cmml" xref="S3.Thmtheorem2.p1.1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem2.p1.1.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem2.p1.1.1.m1.1d">italic_k</annotation></semantics></math> updates of the coarse-fine distinction network, under Assumption <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S3.Thmtheorem1" title="Assumption 3.1. ‣ 3.2.2 Proof of the retaining of policy optimality ‣ 3.2 Coarse-fine distinction module ‣ 3 Method ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_tag">3.1</span></a>, the optimal action remains the same after adding the intrinsic rewards. That is, for any state <math alttext="s" class="ltx_Math" display="inline" id="S3.Thmtheorem2.p1.2.2.m2.1"><semantics id="S3.Thmtheorem2.p1.2.2.m2.1a"><mi id="S3.Thmtheorem2.p1.2.2.m2.1.1" xref="S3.Thmtheorem2.p1.2.2.m2.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem2.p1.2.2.m2.1b"><ci id="S3.Thmtheorem2.p1.2.2.m2.1.1.cmml" xref="S3.Thmtheorem2.p1.2.2.m2.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem2.p1.2.2.m2.1c">s</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem2.p1.2.2.m2.1d">italic_s</annotation></semantics></math>, we have</span></p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\arg\max_{a}Q^{*}(s,a)=\arg\max_{a}Q^{*}_{1}(s,a)," class="ltx_Math" display="block" id="S3.E4.m1.5"><semantics id="S3.E4.m1.5a"><mrow id="S3.E4.m1.5.5.1" xref="S3.E4.m1.5.5.1.1.cmml"><mrow id="S3.E4.m1.5.5.1.1" xref="S3.E4.m1.5.5.1.1.cmml"><mrow id="S3.E4.m1.5.5.1.1.2" xref="S3.E4.m1.5.5.1.1.2.cmml"><mrow id="S3.E4.m1.5.5.1.1.2.2" xref="S3.E4.m1.5.5.1.1.2.2.cmml"><mi id="S3.E4.m1.5.5.1.1.2.2.1" xref="S3.E4.m1.5.5.1.1.2.2.1.cmml">arg</mi><mo id="S3.E4.m1.5.5.1.1.2.2a" lspace="0.167em" xref="S3.E4.m1.5.5.1.1.2.2.cmml">⁡</mo><mrow id="S3.E4.m1.5.5.1.1.2.2.2" xref="S3.E4.m1.5.5.1.1.2.2.2.cmml"><munder id="S3.E4.m1.5.5.1.1.2.2.2.1" xref="S3.E4.m1.5.5.1.1.2.2.2.1.cmml"><mi id="S3.E4.m1.5.5.1.1.2.2.2.1.2" xref="S3.E4.m1.5.5.1.1.2.2.2.1.2.cmml">max</mi><mi id="S3.E4.m1.5.5.1.1.2.2.2.1.3" xref="S3.E4.m1.5.5.1.1.2.2.2.1.3.cmml">a</mi></munder><mo id="S3.E4.m1.5.5.1.1.2.2.2a" lspace="0.167em" xref="S3.E4.m1.5.5.1.1.2.2.2.cmml">⁡</mo><msup id="S3.E4.m1.5.5.1.1.2.2.2.2" xref="S3.E4.m1.5.5.1.1.2.2.2.2.cmml"><mi id="S3.E4.m1.5.5.1.1.2.2.2.2.2" xref="S3.E4.m1.5.5.1.1.2.2.2.2.2.cmml">Q</mi><mo id="S3.E4.m1.5.5.1.1.2.2.2.2.3" xref="S3.E4.m1.5.5.1.1.2.2.2.2.3.cmml">∗</mo></msup></mrow></mrow><mo id="S3.E4.m1.5.5.1.1.2.1" xref="S3.E4.m1.5.5.1.1.2.1.cmml">⁢</mo><mrow id="S3.E4.m1.5.5.1.1.2.3.2" xref="S3.E4.m1.5.5.1.1.2.3.1.cmml"><mo id="S3.E4.m1.5.5.1.1.2.3.2.1" stretchy="false" xref="S3.E4.m1.5.5.1.1.2.3.1.cmml">(</mo><mi id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml">s</mi><mo id="S3.E4.m1.5.5.1.1.2.3.2.2" xref="S3.E4.m1.5.5.1.1.2.3.1.cmml">,</mo><mi id="S3.E4.m1.2.2" xref="S3.E4.m1.2.2.cmml">a</mi><mo id="S3.E4.m1.5.5.1.1.2.3.2.3" stretchy="false" xref="S3.E4.m1.5.5.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.5.5.1.1.1" xref="S3.E4.m1.5.5.1.1.1.cmml">=</mo><mrow id="S3.E4.m1.5.5.1.1.3" xref="S3.E4.m1.5.5.1.1.3.cmml"><mrow id="S3.E4.m1.5.5.1.1.3.2" xref="S3.E4.m1.5.5.1.1.3.2.cmml"><mi id="S3.E4.m1.5.5.1.1.3.2.1" xref="S3.E4.m1.5.5.1.1.3.2.1.cmml">arg</mi><mo id="S3.E4.m1.5.5.1.1.3.2a" lspace="0.167em" xref="S3.E4.m1.5.5.1.1.3.2.cmml">⁡</mo><mrow id="S3.E4.m1.5.5.1.1.3.2.2" xref="S3.E4.m1.5.5.1.1.3.2.2.cmml"><munder id="S3.E4.m1.5.5.1.1.3.2.2.1" xref="S3.E4.m1.5.5.1.1.3.2.2.1.cmml"><mi id="S3.E4.m1.5.5.1.1.3.2.2.1.2" xref="S3.E4.m1.5.5.1.1.3.2.2.1.2.cmml">max</mi><mi id="S3.E4.m1.5.5.1.1.3.2.2.1.3" xref="S3.E4.m1.5.5.1.1.3.2.2.1.3.cmml">a</mi></munder><mo id="S3.E4.m1.5.5.1.1.3.2.2a" lspace="0.167em" xref="S3.E4.m1.5.5.1.1.3.2.2.cmml">⁡</mo><msubsup id="S3.E4.m1.5.5.1.1.3.2.2.2" xref="S3.E4.m1.5.5.1.1.3.2.2.2.cmml"><mi id="S3.E4.m1.5.5.1.1.3.2.2.2.2.2" xref="S3.E4.m1.5.5.1.1.3.2.2.2.2.2.cmml">Q</mi><mn id="S3.E4.m1.5.5.1.1.3.2.2.2.3" xref="S3.E4.m1.5.5.1.1.3.2.2.2.3.cmml">1</mn><mo id="S3.E4.m1.5.5.1.1.3.2.2.2.2.3" xref="S3.E4.m1.5.5.1.1.3.2.2.2.2.3.cmml">∗</mo></msubsup></mrow></mrow><mo id="S3.E4.m1.5.5.1.1.3.1" xref="S3.E4.m1.5.5.1.1.3.1.cmml">⁢</mo><mrow id="S3.E4.m1.5.5.1.1.3.3.2" xref="S3.E4.m1.5.5.1.1.3.3.1.cmml"><mo id="S3.E4.m1.5.5.1.1.3.3.2.1" stretchy="false" xref="S3.E4.m1.5.5.1.1.3.3.1.cmml">(</mo><mi id="S3.E4.m1.3.3" xref="S3.E4.m1.3.3.cmml">s</mi><mo id="S3.E4.m1.5.5.1.1.3.3.2.2" xref="S3.E4.m1.5.5.1.1.3.3.1.cmml">,</mo><mi id="S3.E4.m1.4.4" xref="S3.E4.m1.4.4.cmml">a</mi><mo id="S3.E4.m1.5.5.1.1.3.3.2.3" stretchy="false" xref="S3.E4.m1.5.5.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E4.m1.5.5.1.2" xref="S3.E4.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.5b"><apply id="S3.E4.m1.5.5.1.1.cmml" xref="S3.E4.m1.5.5.1"><eq id="S3.E4.m1.5.5.1.1.1.cmml" xref="S3.E4.m1.5.5.1.1.1"></eq><apply id="S3.E4.m1.5.5.1.1.2.cmml" xref="S3.E4.m1.5.5.1.1.2"><times id="S3.E4.m1.5.5.1.1.2.1.cmml" xref="S3.E4.m1.5.5.1.1.2.1"></times><apply id="S3.E4.m1.5.5.1.1.2.2.cmml" xref="S3.E4.m1.5.5.1.1.2.2"><arg id="S3.E4.m1.5.5.1.1.2.2.1.cmml" xref="S3.E4.m1.5.5.1.1.2.2.1"></arg><apply id="S3.E4.m1.5.5.1.1.2.2.2.cmml" xref="S3.E4.m1.5.5.1.1.2.2.2"><apply id="S3.E4.m1.5.5.1.1.2.2.2.1.cmml" xref="S3.E4.m1.5.5.1.1.2.2.2.1"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.2.2.2.1.1.cmml" xref="S3.E4.m1.5.5.1.1.2.2.2.1">subscript</csymbol><max id="S3.E4.m1.5.5.1.1.2.2.2.1.2.cmml" xref="S3.E4.m1.5.5.1.1.2.2.2.1.2"></max><ci id="S3.E4.m1.5.5.1.1.2.2.2.1.3.cmml" xref="S3.E4.m1.5.5.1.1.2.2.2.1.3">𝑎</ci></apply><apply id="S3.E4.m1.5.5.1.1.2.2.2.2.cmml" xref="S3.E4.m1.5.5.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.2.2.2.2.1.cmml" xref="S3.E4.m1.5.5.1.1.2.2.2.2">superscript</csymbol><ci id="S3.E4.m1.5.5.1.1.2.2.2.2.2.cmml" xref="S3.E4.m1.5.5.1.1.2.2.2.2.2">𝑄</ci><times id="S3.E4.m1.5.5.1.1.2.2.2.2.3.cmml" xref="S3.E4.m1.5.5.1.1.2.2.2.2.3"></times></apply></apply></apply><interval closure="open" id="S3.E4.m1.5.5.1.1.2.3.1.cmml" xref="S3.E4.m1.5.5.1.1.2.3.2"><ci id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1">𝑠</ci><ci id="S3.E4.m1.2.2.cmml" xref="S3.E4.m1.2.2">𝑎</ci></interval></apply><apply id="S3.E4.m1.5.5.1.1.3.cmml" xref="S3.E4.m1.5.5.1.1.3"><times id="S3.E4.m1.5.5.1.1.3.1.cmml" xref="S3.E4.m1.5.5.1.1.3.1"></times><apply id="S3.E4.m1.5.5.1.1.3.2.cmml" xref="S3.E4.m1.5.5.1.1.3.2"><arg id="S3.E4.m1.5.5.1.1.3.2.1.cmml" xref="S3.E4.m1.5.5.1.1.3.2.1"></arg><apply id="S3.E4.m1.5.5.1.1.3.2.2.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2"><apply id="S3.E4.m1.5.5.1.1.3.2.2.1.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2.1"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.3.2.2.1.1.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2.1">subscript</csymbol><max id="S3.E4.m1.5.5.1.1.3.2.2.1.2.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2.1.2"></max><ci id="S3.E4.m1.5.5.1.1.3.2.2.1.3.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2.1.3">𝑎</ci></apply><apply id="S3.E4.m1.5.5.1.1.3.2.2.2.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.3.2.2.2.1.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2.2">subscript</csymbol><apply id="S3.E4.m1.5.5.1.1.3.2.2.2.2.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.3.2.2.2.2.1.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2.2">superscript</csymbol><ci id="S3.E4.m1.5.5.1.1.3.2.2.2.2.2.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2.2.2.2">𝑄</ci><times id="S3.E4.m1.5.5.1.1.3.2.2.2.2.3.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2.2.2.3"></times></apply><cn id="S3.E4.m1.5.5.1.1.3.2.2.2.3.cmml" type="integer" xref="S3.E4.m1.5.5.1.1.3.2.2.2.3">1</cn></apply></apply></apply><interval closure="open" id="S3.E4.m1.5.5.1.1.3.3.1.cmml" xref="S3.E4.m1.5.5.1.1.3.3.2"><ci id="S3.E4.m1.3.3.cmml" xref="S3.E4.m1.3.3">𝑠</ci><ci id="S3.E4.m1.4.4.cmml" xref="S3.E4.m1.4.4">𝑎</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.5c">\arg\max_{a}Q^{*}(s,a)=\arg\max_{a}Q^{*}_{1}(s,a),</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.5d">roman_arg roman_max start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT italic_Q start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s , italic_a ) = roman_arg roman_max start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT italic_Q start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_s , italic_a ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.Thmtheorem2.p1.4"><span class="ltx_text ltx_font_italic" id="S3.Thmtheorem2.p1.4.2">where <math alttext="Q^{*}_{1}" class="ltx_Math" display="inline" id="S3.Thmtheorem2.p1.3.1.m1.1"><semantics id="S3.Thmtheorem2.p1.3.1.m1.1a"><msubsup id="S3.Thmtheorem2.p1.3.1.m1.1.1" xref="S3.Thmtheorem2.p1.3.1.m1.1.1.cmml"><mi id="S3.Thmtheorem2.p1.3.1.m1.1.1.2.2" xref="S3.Thmtheorem2.p1.3.1.m1.1.1.2.2.cmml">Q</mi><mn id="S3.Thmtheorem2.p1.3.1.m1.1.1.3" xref="S3.Thmtheorem2.p1.3.1.m1.1.1.3.cmml">1</mn><mo id="S3.Thmtheorem2.p1.3.1.m1.1.1.2.3" xref="S3.Thmtheorem2.p1.3.1.m1.1.1.2.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem2.p1.3.1.m1.1b"><apply id="S3.Thmtheorem2.p1.3.1.m1.1.1.cmml" xref="S3.Thmtheorem2.p1.3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem2.p1.3.1.m1.1.1.1.cmml" xref="S3.Thmtheorem2.p1.3.1.m1.1.1">subscript</csymbol><apply id="S3.Thmtheorem2.p1.3.1.m1.1.1.2.cmml" xref="S3.Thmtheorem2.p1.3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem2.p1.3.1.m1.1.1.2.1.cmml" xref="S3.Thmtheorem2.p1.3.1.m1.1.1">superscript</csymbol><ci id="S3.Thmtheorem2.p1.3.1.m1.1.1.2.2.cmml" xref="S3.Thmtheorem2.p1.3.1.m1.1.1.2.2">𝑄</ci><times id="S3.Thmtheorem2.p1.3.1.m1.1.1.2.3.cmml" xref="S3.Thmtheorem2.p1.3.1.m1.1.1.2.3"></times></apply><cn id="S3.Thmtheorem2.p1.3.1.m1.1.1.3.cmml" type="integer" xref="S3.Thmtheorem2.p1.3.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem2.p1.3.1.m1.1c">Q^{*}_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem2.p1.3.1.m1.1d">italic_Q start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> is the optimal <math alttext="Q" class="ltx_Math" display="inline" id="S3.Thmtheorem2.p1.4.2.m2.1"><semantics id="S3.Thmtheorem2.p1.4.2.m2.1a"><mi id="S3.Thmtheorem2.p1.4.2.m2.1.1" xref="S3.Thmtheorem2.p1.4.2.m2.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem2.p1.4.2.m2.1b"><ci id="S3.Thmtheorem2.p1.4.2.m2.1.1.cmml" xref="S3.Thmtheorem2.p1.4.2.m2.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem2.p1.4.2.m2.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem2.p1.4.2.m2.1d">italic_Q</annotation></semantics></math> function after adding the intrinsic rewards.</span></p>
</div>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS2.p3">
<p class="ltx_p" id="S3.SS2.SSS2.p3.1">The proof is shown in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#A3.SS1" title="C.1 Proof of Theorem 3.2 ‣ Appendix C Additional Proofs ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_tag">C.1</span></a>. Theorem <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S3.Thmtheorem2" title="Theorem 3.2. ‣ 3.2.2 Proof of the retaining of policy optimality ‣ 3.2 Coarse-fine distinction module ‣ 3 Method ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_tag">3.2</span></a> reveals the rationale behind the intrinsic reward design based on loss functions, which has not been mentioned in existing work like RND. It also points out a new direction for future intrinsic reward design.</p>
</div>
<figure class="ltx_figure" id="S3.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="226" id="S3.F6.g1" src="x6.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span><span class="ltx_text ltx_font_bold" id="S3.F6.3.1">Generalization experiments in MuJuCo</span>, showing the generalizable performance of AdaMemento in different types of <span class="ltx_text ltx_font_bold" id="S3.F6.4.2">continuous space tasks</span>. The x-axis represents timesteps in millions.</figcaption>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Ensemble learning for exploration-exploitation balance</h3>
<div class="ltx_para ltx_noindent" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.4">The memory-reflection module and the coarse-fine distinction guide exploitation and exploration respectively. It is critical for the final policy to balance between the two branches of policy. Hence, we leverage ensemble learning to adaptively choose actions.
Denote the actions from the memory reflection as <math alttext="a_{mem}" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.1"><semantics id="S3.SS3.p1.1.m1.1a"><msub id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml"><mi id="S3.SS3.p1.1.m1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.2.cmml">a</mi><mrow id="S3.SS3.p1.1.m1.1.1.3" xref="S3.SS3.p1.1.m1.1.1.3.cmml"><mi id="S3.SS3.p1.1.m1.1.1.3.2" xref="S3.SS3.p1.1.m1.1.1.3.2.cmml">m</mi><mo id="S3.SS3.p1.1.m1.1.1.3.1" xref="S3.SS3.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p1.1.m1.1.1.3.3" xref="S3.SS3.p1.1.m1.1.1.3.3.cmml">e</mi><mo id="S3.SS3.p1.1.m1.1.1.3.1a" xref="S3.SS3.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p1.1.m1.1.1.3.4" xref="S3.SS3.p1.1.m1.1.1.3.4.cmml">m</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><apply id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1.2">𝑎</ci><apply id="S3.SS3.p1.1.m1.1.1.3.cmml" xref="S3.SS3.p1.1.m1.1.1.3"><times id="S3.SS3.p1.1.m1.1.1.3.1.cmml" xref="S3.SS3.p1.1.m1.1.1.3.1"></times><ci id="S3.SS3.p1.1.m1.1.1.3.2.cmml" xref="S3.SS3.p1.1.m1.1.1.3.2">𝑚</ci><ci id="S3.SS3.p1.1.m1.1.1.3.3.cmml" xref="S3.SS3.p1.1.m1.1.1.3.3">𝑒</ci><ci id="S3.SS3.p1.1.m1.1.1.3.4.cmml" xref="S3.SS3.p1.1.m1.1.1.3.4">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">a_{mem}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.1d">italic_a start_POSTSUBSCRIPT italic_m italic_e italic_m end_POSTSUBSCRIPT</annotation></semantics></math> and actions given by the original RL algorithm with our intrinsic rewards as <math alttext="a_{ori}" class="ltx_Math" display="inline" id="S3.SS3.p1.2.m2.1"><semantics id="S3.SS3.p1.2.m2.1a"><msub id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml"><mi id="S3.SS3.p1.2.m2.1.1.2" xref="S3.SS3.p1.2.m2.1.1.2.cmml">a</mi><mrow id="S3.SS3.p1.2.m2.1.1.3" xref="S3.SS3.p1.2.m2.1.1.3.cmml"><mi id="S3.SS3.p1.2.m2.1.1.3.2" xref="S3.SS3.p1.2.m2.1.1.3.2.cmml">o</mi><mo id="S3.SS3.p1.2.m2.1.1.3.1" xref="S3.SS3.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p1.2.m2.1.1.3.3" xref="S3.SS3.p1.2.m2.1.1.3.3.cmml">r</mi><mo id="S3.SS3.p1.2.m2.1.1.3.1a" xref="S3.SS3.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p1.2.m2.1.1.3.4" xref="S3.SS3.p1.2.m2.1.1.3.4.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><apply id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p1.2.m2.1.1.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2">𝑎</ci><apply id="S3.SS3.p1.2.m2.1.1.3.cmml" xref="S3.SS3.p1.2.m2.1.1.3"><times id="S3.SS3.p1.2.m2.1.1.3.1.cmml" xref="S3.SS3.p1.2.m2.1.1.3.1"></times><ci id="S3.SS3.p1.2.m2.1.1.3.2.cmml" xref="S3.SS3.p1.2.m2.1.1.3.2">𝑜</ci><ci id="S3.SS3.p1.2.m2.1.1.3.3.cmml" xref="S3.SS3.p1.2.m2.1.1.3.3">𝑟</ci><ci id="S3.SS3.p1.2.m2.1.1.3.4.cmml" xref="S3.SS3.p1.2.m2.1.1.3.4">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">a_{ori}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.2.m2.1d">italic_a start_POSTSUBSCRIPT italic_o italic_r italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. Given a policy <math alttext="\pi" class="ltx_Math" display="inline" id="S3.SS3.p1.3.m3.1"><semantics id="S3.SS3.p1.3.m3.1a"><mi id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><ci id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.3.m3.1d">italic_π</annotation></semantics></math>, e.g., PPO, we establish its greedy counterpart denoted as <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="S3.SS3.p1.4.m4.1"><semantics id="S3.SS3.p1.4.m4.1a"><msub id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml"><mi id="S3.SS3.p1.4.m4.1.1.2" xref="S3.SS3.p1.4.m4.1.1.2.cmml">π</mi><mi id="S3.SS3.p1.4.m4.1.1.3" xref="S3.SS3.p1.4.m4.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><apply id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.1.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.p1.4.m4.1.1.2.cmml" xref="S3.SS3.p1.4.m4.1.1.2">𝜋</ci><ci id="S3.SS3.p1.4.m4.1.1.3.cmml" xref="S3.SS3.p1.4.m4.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.4.m4.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>
and define a combination function:
</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\pi_{new}=(1-I_{\{C_{\omega}(s,a)\geq\kappa\}})\pi+I_{\{C_{\omega}(s,a)\geq%
\kappa\}}\pi_{\theta}," class="ltx_Math" display="block" id="S3.E5.m1.7"><semantics id="S3.E5.m1.7a"><mrow id="S3.E5.m1.7.7.1" xref="S3.E5.m1.7.7.1.1.cmml"><mrow id="S3.E5.m1.7.7.1.1" xref="S3.E5.m1.7.7.1.1.cmml"><msub id="S3.E5.m1.7.7.1.1.3" xref="S3.E5.m1.7.7.1.1.3.cmml"><mi id="S3.E5.m1.7.7.1.1.3.2" xref="S3.E5.m1.7.7.1.1.3.2.cmml">π</mi><mrow id="S3.E5.m1.7.7.1.1.3.3" xref="S3.E5.m1.7.7.1.1.3.3.cmml"><mi id="S3.E5.m1.7.7.1.1.3.3.2" xref="S3.E5.m1.7.7.1.1.3.3.2.cmml">n</mi><mo id="S3.E5.m1.7.7.1.1.3.3.1" xref="S3.E5.m1.7.7.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E5.m1.7.7.1.1.3.3.3" xref="S3.E5.m1.7.7.1.1.3.3.3.cmml">e</mi><mo id="S3.E5.m1.7.7.1.1.3.3.1a" xref="S3.E5.m1.7.7.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E5.m1.7.7.1.1.3.3.4" xref="S3.E5.m1.7.7.1.1.3.3.4.cmml">w</mi></mrow></msub><mo id="S3.E5.m1.7.7.1.1.2" xref="S3.E5.m1.7.7.1.1.2.cmml">=</mo><mrow id="S3.E5.m1.7.7.1.1.1" xref="S3.E5.m1.7.7.1.1.1.cmml"><mrow id="S3.E5.m1.7.7.1.1.1.1" xref="S3.E5.m1.7.7.1.1.1.1.cmml"><mrow id="S3.E5.m1.7.7.1.1.1.1.1.1" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.cmml"><mo id="S3.E5.m1.7.7.1.1.1.1.1.1.2" stretchy="false" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.7.7.1.1.1.1.1.1.1" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.cmml"><mn id="S3.E5.m1.7.7.1.1.1.1.1.1.1.2" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.E5.m1.7.7.1.1.1.1.1.1.1.3" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.2" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.2.cmml">I</mi><mrow id="S3.E5.m1.3.3.3.3" xref="S3.E5.m1.3.3.3.4.cmml"><mo id="S3.E5.m1.3.3.3.3.2" stretchy="false" xref="S3.E5.m1.3.3.3.4.cmml">{</mo><mrow id="S3.E5.m1.3.3.3.3.1" xref="S3.E5.m1.3.3.3.3.1.cmml"><mrow id="S3.E5.m1.3.3.3.3.1.2" xref="S3.E5.m1.3.3.3.3.1.2.cmml"><msub id="S3.E5.m1.3.3.3.3.1.2.2" xref="S3.E5.m1.3.3.3.3.1.2.2.cmml"><mi id="S3.E5.m1.3.3.3.3.1.2.2.2" xref="S3.E5.m1.3.3.3.3.1.2.2.2.cmml">C</mi><mi id="S3.E5.m1.3.3.3.3.1.2.2.3" xref="S3.E5.m1.3.3.3.3.1.2.2.3.cmml">ω</mi></msub><mo id="S3.E5.m1.3.3.3.3.1.2.1" xref="S3.E5.m1.3.3.3.3.1.2.1.cmml">⁢</mo><mrow id="S3.E5.m1.3.3.3.3.1.2.3.2" xref="S3.E5.m1.3.3.3.3.1.2.3.1.cmml"><mo id="S3.E5.m1.3.3.3.3.1.2.3.2.1" stretchy="false" xref="S3.E5.m1.3.3.3.3.1.2.3.1.cmml">(</mo><mi id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml">s</mi><mo id="S3.E5.m1.3.3.3.3.1.2.3.2.2" xref="S3.E5.m1.3.3.3.3.1.2.3.1.cmml">,</mo><mi id="S3.E5.m1.2.2.2.2" xref="S3.E5.m1.2.2.2.2.cmml">a</mi><mo id="S3.E5.m1.3.3.3.3.1.2.3.2.3" stretchy="false" xref="S3.E5.m1.3.3.3.3.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.3.3.3.3.1.1" xref="S3.E5.m1.3.3.3.3.1.1.cmml">≥</mo><mi id="S3.E5.m1.3.3.3.3.1.3" xref="S3.E5.m1.3.3.3.3.1.3.cmml">κ</mi></mrow><mo id="S3.E5.m1.3.3.3.3.3" stretchy="false" xref="S3.E5.m1.3.3.3.4.cmml">}</mo></mrow></msub></mrow><mo id="S3.E5.m1.7.7.1.1.1.1.1.1.3" stretchy="false" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E5.m1.7.7.1.1.1.1.2" xref="S3.E5.m1.7.7.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E5.m1.7.7.1.1.1.1.3" xref="S3.E5.m1.7.7.1.1.1.1.3.cmml">π</mi></mrow><mo id="S3.E5.m1.7.7.1.1.1.2" xref="S3.E5.m1.7.7.1.1.1.2.cmml">+</mo><mrow id="S3.E5.m1.7.7.1.1.1.3" xref="S3.E5.m1.7.7.1.1.1.3.cmml"><msub id="S3.E5.m1.7.7.1.1.1.3.2" xref="S3.E5.m1.7.7.1.1.1.3.2.cmml"><mi id="S3.E5.m1.7.7.1.1.1.3.2.2" xref="S3.E5.m1.7.7.1.1.1.3.2.2.cmml">I</mi><mrow id="S3.E5.m1.6.6.3.3" xref="S3.E5.m1.6.6.3.4.cmml"><mo id="S3.E5.m1.6.6.3.3.2" stretchy="false" xref="S3.E5.m1.6.6.3.4.cmml">{</mo><mrow id="S3.E5.m1.6.6.3.3.1" xref="S3.E5.m1.6.6.3.3.1.cmml"><mrow id="S3.E5.m1.6.6.3.3.1.2" xref="S3.E5.m1.6.6.3.3.1.2.cmml"><msub id="S3.E5.m1.6.6.3.3.1.2.2" xref="S3.E5.m1.6.6.3.3.1.2.2.cmml"><mi id="S3.E5.m1.6.6.3.3.1.2.2.2" xref="S3.E5.m1.6.6.3.3.1.2.2.2.cmml">C</mi><mi id="S3.E5.m1.6.6.3.3.1.2.2.3" xref="S3.E5.m1.6.6.3.3.1.2.2.3.cmml">ω</mi></msub><mo id="S3.E5.m1.6.6.3.3.1.2.1" xref="S3.E5.m1.6.6.3.3.1.2.1.cmml">⁢</mo><mrow id="S3.E5.m1.6.6.3.3.1.2.3.2" xref="S3.E5.m1.6.6.3.3.1.2.3.1.cmml"><mo id="S3.E5.m1.6.6.3.3.1.2.3.2.1" stretchy="false" xref="S3.E5.m1.6.6.3.3.1.2.3.1.cmml">(</mo><mi id="S3.E5.m1.4.4.1.1" xref="S3.E5.m1.4.4.1.1.cmml">s</mi><mo id="S3.E5.m1.6.6.3.3.1.2.3.2.2" xref="S3.E5.m1.6.6.3.3.1.2.3.1.cmml">,</mo><mi id="S3.E5.m1.5.5.2.2" xref="S3.E5.m1.5.5.2.2.cmml">a</mi><mo id="S3.E5.m1.6.6.3.3.1.2.3.2.3" stretchy="false" xref="S3.E5.m1.6.6.3.3.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.6.6.3.3.1.1" xref="S3.E5.m1.6.6.3.3.1.1.cmml">≥</mo><mi id="S3.E5.m1.6.6.3.3.1.3" xref="S3.E5.m1.6.6.3.3.1.3.cmml">κ</mi></mrow><mo id="S3.E5.m1.6.6.3.3.3" stretchy="false" xref="S3.E5.m1.6.6.3.4.cmml">}</mo></mrow></msub><mo id="S3.E5.m1.7.7.1.1.1.3.1" xref="S3.E5.m1.7.7.1.1.1.3.1.cmml">⁢</mo><msub id="S3.E5.m1.7.7.1.1.1.3.3" xref="S3.E5.m1.7.7.1.1.1.3.3.cmml"><mi id="S3.E5.m1.7.7.1.1.1.3.3.2" xref="S3.E5.m1.7.7.1.1.1.3.3.2.cmml">π</mi><mi id="S3.E5.m1.7.7.1.1.1.3.3.3" xref="S3.E5.m1.7.7.1.1.1.3.3.3.cmml">θ</mi></msub></mrow></mrow></mrow><mo id="S3.E5.m1.7.7.1.2" xref="S3.E5.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.7b"><apply id="S3.E5.m1.7.7.1.1.cmml" xref="S3.E5.m1.7.7.1"><eq id="S3.E5.m1.7.7.1.1.2.cmml" xref="S3.E5.m1.7.7.1.1.2"></eq><apply id="S3.E5.m1.7.7.1.1.3.cmml" xref="S3.E5.m1.7.7.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.3.1.cmml" xref="S3.E5.m1.7.7.1.1.3">subscript</csymbol><ci id="S3.E5.m1.7.7.1.1.3.2.cmml" xref="S3.E5.m1.7.7.1.1.3.2">𝜋</ci><apply id="S3.E5.m1.7.7.1.1.3.3.cmml" xref="S3.E5.m1.7.7.1.1.3.3"><times id="S3.E5.m1.7.7.1.1.3.3.1.cmml" xref="S3.E5.m1.7.7.1.1.3.3.1"></times><ci id="S3.E5.m1.7.7.1.1.3.3.2.cmml" xref="S3.E5.m1.7.7.1.1.3.3.2">𝑛</ci><ci id="S3.E5.m1.7.7.1.1.3.3.3.cmml" xref="S3.E5.m1.7.7.1.1.3.3.3">𝑒</ci><ci id="S3.E5.m1.7.7.1.1.3.3.4.cmml" xref="S3.E5.m1.7.7.1.1.3.3.4">𝑤</ci></apply></apply><apply id="S3.E5.m1.7.7.1.1.1.cmml" xref="S3.E5.m1.7.7.1.1.1"><plus id="S3.E5.m1.7.7.1.1.1.2.cmml" xref="S3.E5.m1.7.7.1.1.1.2"></plus><apply id="S3.E5.m1.7.7.1.1.1.1.cmml" xref="S3.E5.m1.7.7.1.1.1.1"><times id="S3.E5.m1.7.7.1.1.1.1.2.cmml" xref="S3.E5.m1.7.7.1.1.1.1.2"></times><apply id="S3.E5.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1"><minus id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1"></minus><cn id="S3.E5.m1.7.7.1.1.1.1.1.1.1.2.cmml" type="integer" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.2">1</cn><apply id="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.2">𝐼</ci><set id="S3.E5.m1.3.3.3.4.cmml" xref="S3.E5.m1.3.3.3.3"><apply id="S3.E5.m1.3.3.3.3.1.cmml" xref="S3.E5.m1.3.3.3.3.1"><geq id="S3.E5.m1.3.3.3.3.1.1.cmml" xref="S3.E5.m1.3.3.3.3.1.1"></geq><apply id="S3.E5.m1.3.3.3.3.1.2.cmml" xref="S3.E5.m1.3.3.3.3.1.2"><times id="S3.E5.m1.3.3.3.3.1.2.1.cmml" xref="S3.E5.m1.3.3.3.3.1.2.1"></times><apply id="S3.E5.m1.3.3.3.3.1.2.2.cmml" xref="S3.E5.m1.3.3.3.3.1.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.3.3.1.2.2.1.cmml" xref="S3.E5.m1.3.3.3.3.1.2.2">subscript</csymbol><ci id="S3.E5.m1.3.3.3.3.1.2.2.2.cmml" xref="S3.E5.m1.3.3.3.3.1.2.2.2">𝐶</ci><ci id="S3.E5.m1.3.3.3.3.1.2.2.3.cmml" xref="S3.E5.m1.3.3.3.3.1.2.2.3">𝜔</ci></apply><interval closure="open" id="S3.E5.m1.3.3.3.3.1.2.3.1.cmml" xref="S3.E5.m1.3.3.3.3.1.2.3.2"><ci id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1">𝑠</ci><ci id="S3.E5.m1.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2">𝑎</ci></interval></apply><ci id="S3.E5.m1.3.3.3.3.1.3.cmml" xref="S3.E5.m1.3.3.3.3.1.3">𝜅</ci></apply></set></apply></apply><ci id="S3.E5.m1.7.7.1.1.1.1.3.cmml" xref="S3.E5.m1.7.7.1.1.1.1.3">𝜋</ci></apply><apply id="S3.E5.m1.7.7.1.1.1.3.cmml" xref="S3.E5.m1.7.7.1.1.1.3"><times id="S3.E5.m1.7.7.1.1.1.3.1.cmml" xref="S3.E5.m1.7.7.1.1.1.3.1"></times><apply id="S3.E5.m1.7.7.1.1.1.3.2.cmml" xref="S3.E5.m1.7.7.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.1.3.2.1.cmml" xref="S3.E5.m1.7.7.1.1.1.3.2">subscript</csymbol><ci id="S3.E5.m1.7.7.1.1.1.3.2.2.cmml" xref="S3.E5.m1.7.7.1.1.1.3.2.2">𝐼</ci><set id="S3.E5.m1.6.6.3.4.cmml" xref="S3.E5.m1.6.6.3.3"><apply id="S3.E5.m1.6.6.3.3.1.cmml" xref="S3.E5.m1.6.6.3.3.1"><geq id="S3.E5.m1.6.6.3.3.1.1.cmml" xref="S3.E5.m1.6.6.3.3.1.1"></geq><apply id="S3.E5.m1.6.6.3.3.1.2.cmml" xref="S3.E5.m1.6.6.3.3.1.2"><times id="S3.E5.m1.6.6.3.3.1.2.1.cmml" xref="S3.E5.m1.6.6.3.3.1.2.1"></times><apply id="S3.E5.m1.6.6.3.3.1.2.2.cmml" xref="S3.E5.m1.6.6.3.3.1.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.3.3.1.2.2.1.cmml" xref="S3.E5.m1.6.6.3.3.1.2.2">subscript</csymbol><ci id="S3.E5.m1.6.6.3.3.1.2.2.2.cmml" xref="S3.E5.m1.6.6.3.3.1.2.2.2">𝐶</ci><ci id="S3.E5.m1.6.6.3.3.1.2.2.3.cmml" xref="S3.E5.m1.6.6.3.3.1.2.2.3">𝜔</ci></apply><interval closure="open" id="S3.E5.m1.6.6.3.3.1.2.3.1.cmml" xref="S3.E5.m1.6.6.3.3.1.2.3.2"><ci id="S3.E5.m1.4.4.1.1.cmml" xref="S3.E5.m1.4.4.1.1">𝑠</ci><ci id="S3.E5.m1.5.5.2.2.cmml" xref="S3.E5.m1.5.5.2.2">𝑎</ci></interval></apply><ci id="S3.E5.m1.6.6.3.3.1.3.cmml" xref="S3.E5.m1.6.6.3.3.1.3">𝜅</ci></apply></set></apply><apply id="S3.E5.m1.7.7.1.1.1.3.3.cmml" xref="S3.E5.m1.7.7.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.1.3.3.1.cmml" xref="S3.E5.m1.7.7.1.1.1.3.3">subscript</csymbol><ci id="S3.E5.m1.7.7.1.1.1.3.3.2.cmml" xref="S3.E5.m1.7.7.1.1.1.3.3.2">𝜋</ci><ci id="S3.E5.m1.7.7.1.1.1.3.3.3.cmml" xref="S3.E5.m1.7.7.1.1.1.3.3.3">𝜃</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.7c">\pi_{new}=(1-I_{\{C_{\omega}(s,a)\geq\kappa\}})\pi+I_{\{C_{\omega}(s,a)\geq%
\kappa\}}\pi_{\theta},</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.7d">italic_π start_POSTSUBSCRIPT italic_n italic_e italic_w end_POSTSUBSCRIPT = ( 1 - italic_I start_POSTSUBSCRIPT { italic_C start_POSTSUBSCRIPT italic_ω end_POSTSUBSCRIPT ( italic_s , italic_a ) ≥ italic_κ } end_POSTSUBSCRIPT ) italic_π + italic_I start_POSTSUBSCRIPT { italic_C start_POSTSUBSCRIPT italic_ω end_POSTSUBSCRIPT ( italic_s , italic_a ) ≥ italic_κ } end_POSTSUBSCRIPT italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p1.9">where <math alttext="\kappa" class="ltx_Math" display="inline" id="S3.SS3.p1.5.m1.1"><semantics id="S3.SS3.p1.5.m1.1a"><mi id="S3.SS3.p1.5.m1.1.1" xref="S3.SS3.p1.5.m1.1.1.cmml">κ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m1.1b"><ci id="S3.SS3.p1.5.m1.1.1.cmml" xref="S3.SS3.p1.5.m1.1.1">𝜅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m1.1c">\kappa</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.5.m1.1d">italic_κ</annotation></semantics></math> is the confidence threshold, and <math alttext="I_{\{C_{\omega}(s,a)\geq\kappa\}}=1" class="ltx_Math" display="inline" id="S3.SS3.p1.6.m2.3"><semantics id="S3.SS3.p1.6.m2.3a"><mrow id="S3.SS3.p1.6.m2.3.4" xref="S3.SS3.p1.6.m2.3.4.cmml"><msub id="S3.SS3.p1.6.m2.3.4.2" xref="S3.SS3.p1.6.m2.3.4.2.cmml"><mi id="S3.SS3.p1.6.m2.3.4.2.2" xref="S3.SS3.p1.6.m2.3.4.2.2.cmml">I</mi><mrow id="S3.SS3.p1.6.m2.3.3.3.3" xref="S3.SS3.p1.6.m2.3.3.3.4.cmml"><mo id="S3.SS3.p1.6.m2.3.3.3.3.2" stretchy="false" xref="S3.SS3.p1.6.m2.3.3.3.4.cmml">{</mo><mrow id="S3.SS3.p1.6.m2.3.3.3.3.1" xref="S3.SS3.p1.6.m2.3.3.3.3.1.cmml"><mrow id="S3.SS3.p1.6.m2.3.3.3.3.1.2" xref="S3.SS3.p1.6.m2.3.3.3.3.1.2.cmml"><msub id="S3.SS3.p1.6.m2.3.3.3.3.1.2.2" xref="S3.SS3.p1.6.m2.3.3.3.3.1.2.2.cmml"><mi id="S3.SS3.p1.6.m2.3.3.3.3.1.2.2.2" xref="S3.SS3.p1.6.m2.3.3.3.3.1.2.2.2.cmml">C</mi><mi id="S3.SS3.p1.6.m2.3.3.3.3.1.2.2.3" xref="S3.SS3.p1.6.m2.3.3.3.3.1.2.2.3.cmml">ω</mi></msub><mo id="S3.SS3.p1.6.m2.3.3.3.3.1.2.1" xref="S3.SS3.p1.6.m2.3.3.3.3.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.p1.6.m2.3.3.3.3.1.2.3.2" xref="S3.SS3.p1.6.m2.3.3.3.3.1.2.3.1.cmml"><mo id="S3.SS3.p1.6.m2.3.3.3.3.1.2.3.2.1" stretchy="false" xref="S3.SS3.p1.6.m2.3.3.3.3.1.2.3.1.cmml">(</mo><mi id="S3.SS3.p1.6.m2.1.1.1.1" xref="S3.SS3.p1.6.m2.1.1.1.1.cmml">s</mi><mo id="S3.SS3.p1.6.m2.3.3.3.3.1.2.3.2.2" xref="S3.SS3.p1.6.m2.3.3.3.3.1.2.3.1.cmml">,</mo><mi id="S3.SS3.p1.6.m2.2.2.2.2" xref="S3.SS3.p1.6.m2.2.2.2.2.cmml">a</mi><mo id="S3.SS3.p1.6.m2.3.3.3.3.1.2.3.2.3" stretchy="false" xref="S3.SS3.p1.6.m2.3.3.3.3.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p1.6.m2.3.3.3.3.1.1" xref="S3.SS3.p1.6.m2.3.3.3.3.1.1.cmml">≥</mo><mi id="S3.SS3.p1.6.m2.3.3.3.3.1.3" xref="S3.SS3.p1.6.m2.3.3.3.3.1.3.cmml">κ</mi></mrow><mo id="S3.SS3.p1.6.m2.3.3.3.3.3" stretchy="false" xref="S3.SS3.p1.6.m2.3.3.3.4.cmml">}</mo></mrow></msub><mo id="S3.SS3.p1.6.m2.3.4.1" xref="S3.SS3.p1.6.m2.3.4.1.cmml">=</mo><mn id="S3.SS3.p1.6.m2.3.4.3" xref="S3.SS3.p1.6.m2.3.4.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m2.3b"><apply id="S3.SS3.p1.6.m2.3.4.cmml" xref="S3.SS3.p1.6.m2.3.4"><eq id="S3.SS3.p1.6.m2.3.4.1.cmml" xref="S3.SS3.p1.6.m2.3.4.1"></eq><apply id="S3.SS3.p1.6.m2.3.4.2.cmml" xref="S3.SS3.p1.6.m2.3.4.2"><csymbol cd="ambiguous" id="S3.SS3.p1.6.m2.3.4.2.1.cmml" xref="S3.SS3.p1.6.m2.3.4.2">subscript</csymbol><ci id="S3.SS3.p1.6.m2.3.4.2.2.cmml" xref="S3.SS3.p1.6.m2.3.4.2.2">𝐼</ci><set id="S3.SS3.p1.6.m2.3.3.3.4.cmml" xref="S3.SS3.p1.6.m2.3.3.3.3"><apply id="S3.SS3.p1.6.m2.3.3.3.3.1.cmml" xref="S3.SS3.p1.6.m2.3.3.3.3.1"><geq id="S3.SS3.p1.6.m2.3.3.3.3.1.1.cmml" xref="S3.SS3.p1.6.m2.3.3.3.3.1.1"></geq><apply id="S3.SS3.p1.6.m2.3.3.3.3.1.2.cmml" xref="S3.SS3.p1.6.m2.3.3.3.3.1.2"><times id="S3.SS3.p1.6.m2.3.3.3.3.1.2.1.cmml" xref="S3.SS3.p1.6.m2.3.3.3.3.1.2.1"></times><apply id="S3.SS3.p1.6.m2.3.3.3.3.1.2.2.cmml" xref="S3.SS3.p1.6.m2.3.3.3.3.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.6.m2.3.3.3.3.1.2.2.1.cmml" xref="S3.SS3.p1.6.m2.3.3.3.3.1.2.2">subscript</csymbol><ci id="S3.SS3.p1.6.m2.3.3.3.3.1.2.2.2.cmml" xref="S3.SS3.p1.6.m2.3.3.3.3.1.2.2.2">𝐶</ci><ci id="S3.SS3.p1.6.m2.3.3.3.3.1.2.2.3.cmml" xref="S3.SS3.p1.6.m2.3.3.3.3.1.2.2.3">𝜔</ci></apply><interval closure="open" id="S3.SS3.p1.6.m2.3.3.3.3.1.2.3.1.cmml" xref="S3.SS3.p1.6.m2.3.3.3.3.1.2.3.2"><ci id="S3.SS3.p1.6.m2.1.1.1.1.cmml" xref="S3.SS3.p1.6.m2.1.1.1.1">𝑠</ci><ci id="S3.SS3.p1.6.m2.2.2.2.2.cmml" xref="S3.SS3.p1.6.m2.2.2.2.2">𝑎</ci></interval></apply><ci id="S3.SS3.p1.6.m2.3.3.3.3.1.3.cmml" xref="S3.SS3.p1.6.m2.3.3.3.3.1.3">𝜅</ci></apply></set></apply><cn id="S3.SS3.p1.6.m2.3.4.3.cmml" type="integer" xref="S3.SS3.p1.6.m2.3.4.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m2.3c">I_{\{C_{\omega}(s,a)\geq\kappa\}}=1</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.6.m2.3d">italic_I start_POSTSUBSCRIPT { italic_C start_POSTSUBSCRIPT italic_ω end_POSTSUBSCRIPT ( italic_s , italic_a ) ≥ italic_κ } end_POSTSUBSCRIPT = 1</annotation></semantics></math> when the prediction of memory reflection network <math alttext="C_{\omega}(s,a)\geq\kappa" class="ltx_Math" display="inline" id="S3.SS3.p1.7.m3.2"><semantics id="S3.SS3.p1.7.m3.2a"><mrow id="S3.SS3.p1.7.m3.2.3" xref="S3.SS3.p1.7.m3.2.3.cmml"><mrow id="S3.SS3.p1.7.m3.2.3.2" xref="S3.SS3.p1.7.m3.2.3.2.cmml"><msub id="S3.SS3.p1.7.m3.2.3.2.2" xref="S3.SS3.p1.7.m3.2.3.2.2.cmml"><mi id="S3.SS3.p1.7.m3.2.3.2.2.2" xref="S3.SS3.p1.7.m3.2.3.2.2.2.cmml">C</mi><mi id="S3.SS3.p1.7.m3.2.3.2.2.3" xref="S3.SS3.p1.7.m3.2.3.2.2.3.cmml">ω</mi></msub><mo id="S3.SS3.p1.7.m3.2.3.2.1" xref="S3.SS3.p1.7.m3.2.3.2.1.cmml">⁢</mo><mrow id="S3.SS3.p1.7.m3.2.3.2.3.2" xref="S3.SS3.p1.7.m3.2.3.2.3.1.cmml"><mo id="S3.SS3.p1.7.m3.2.3.2.3.2.1" stretchy="false" xref="S3.SS3.p1.7.m3.2.3.2.3.1.cmml">(</mo><mi id="S3.SS3.p1.7.m3.1.1" xref="S3.SS3.p1.7.m3.1.1.cmml">s</mi><mo id="S3.SS3.p1.7.m3.2.3.2.3.2.2" xref="S3.SS3.p1.7.m3.2.3.2.3.1.cmml">,</mo><mi id="S3.SS3.p1.7.m3.2.2" xref="S3.SS3.p1.7.m3.2.2.cmml">a</mi><mo id="S3.SS3.p1.7.m3.2.3.2.3.2.3" stretchy="false" xref="S3.SS3.p1.7.m3.2.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p1.7.m3.2.3.1" xref="S3.SS3.p1.7.m3.2.3.1.cmml">≥</mo><mi id="S3.SS3.p1.7.m3.2.3.3" xref="S3.SS3.p1.7.m3.2.3.3.cmml">κ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m3.2b"><apply id="S3.SS3.p1.7.m3.2.3.cmml" xref="S3.SS3.p1.7.m3.2.3"><geq id="S3.SS3.p1.7.m3.2.3.1.cmml" xref="S3.SS3.p1.7.m3.2.3.1"></geq><apply id="S3.SS3.p1.7.m3.2.3.2.cmml" xref="S3.SS3.p1.7.m3.2.3.2"><times id="S3.SS3.p1.7.m3.2.3.2.1.cmml" xref="S3.SS3.p1.7.m3.2.3.2.1"></times><apply id="S3.SS3.p1.7.m3.2.3.2.2.cmml" xref="S3.SS3.p1.7.m3.2.3.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.7.m3.2.3.2.2.1.cmml" xref="S3.SS3.p1.7.m3.2.3.2.2">subscript</csymbol><ci id="S3.SS3.p1.7.m3.2.3.2.2.2.cmml" xref="S3.SS3.p1.7.m3.2.3.2.2.2">𝐶</ci><ci id="S3.SS3.p1.7.m3.2.3.2.2.3.cmml" xref="S3.SS3.p1.7.m3.2.3.2.2.3">𝜔</ci></apply><interval closure="open" id="S3.SS3.p1.7.m3.2.3.2.3.1.cmml" xref="S3.SS3.p1.7.m3.2.3.2.3.2"><ci id="S3.SS3.p1.7.m3.1.1.cmml" xref="S3.SS3.p1.7.m3.1.1">𝑠</ci><ci id="S3.SS3.p1.7.m3.2.2.cmml" xref="S3.SS3.p1.7.m3.2.2">𝑎</ci></interval></apply><ci id="S3.SS3.p1.7.m3.2.3.3.cmml" xref="S3.SS3.p1.7.m3.2.3.3">𝜅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.7.m3.2c">C_{\omega}(s,a)\geq\kappa</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.7.m3.2d">italic_C start_POSTSUBSCRIPT italic_ω end_POSTSUBSCRIPT ( italic_s , italic_a ) ≥ italic_κ</annotation></semantics></math> is larger than the threshold <math alttext="\kappa" class="ltx_Math" display="inline" id="S3.SS3.p1.8.m4.1"><semantics id="S3.SS3.p1.8.m4.1a"><mi id="S3.SS3.p1.8.m4.1.1" xref="S3.SS3.p1.8.m4.1.1.cmml">κ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.8.m4.1b"><ci id="S3.SS3.p1.8.m4.1.1.cmml" xref="S3.SS3.p1.8.m4.1.1">𝜅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.8.m4.1c">\kappa</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.8.m4.1d">italic_κ</annotation></semantics></math>. It is important to note that we balance exploration and exploitation directly on the policy level instead of rewards and that <math alttext="I_{\{C_{\omega}(s,a)\geq\kappa\}}" class="ltx_Math" display="inline" id="S3.SS3.p1.9.m5.3"><semantics id="S3.SS3.p1.9.m5.3a"><msub id="S3.SS3.p1.9.m5.3.4" xref="S3.SS3.p1.9.m5.3.4.cmml"><mi id="S3.SS3.p1.9.m5.3.4.2" xref="S3.SS3.p1.9.m5.3.4.2.cmml">I</mi><mrow id="S3.SS3.p1.9.m5.3.3.3.3" xref="S3.SS3.p1.9.m5.3.3.3.4.cmml"><mo id="S3.SS3.p1.9.m5.3.3.3.3.2" stretchy="false" xref="S3.SS3.p1.9.m5.3.3.3.4.cmml">{</mo><mrow id="S3.SS3.p1.9.m5.3.3.3.3.1" xref="S3.SS3.p1.9.m5.3.3.3.3.1.cmml"><mrow id="S3.SS3.p1.9.m5.3.3.3.3.1.2" xref="S3.SS3.p1.9.m5.3.3.3.3.1.2.cmml"><msub id="S3.SS3.p1.9.m5.3.3.3.3.1.2.2" xref="S3.SS3.p1.9.m5.3.3.3.3.1.2.2.cmml"><mi id="S3.SS3.p1.9.m5.3.3.3.3.1.2.2.2" xref="S3.SS3.p1.9.m5.3.3.3.3.1.2.2.2.cmml">C</mi><mi id="S3.SS3.p1.9.m5.3.3.3.3.1.2.2.3" xref="S3.SS3.p1.9.m5.3.3.3.3.1.2.2.3.cmml">ω</mi></msub><mo id="S3.SS3.p1.9.m5.3.3.3.3.1.2.1" xref="S3.SS3.p1.9.m5.3.3.3.3.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.p1.9.m5.3.3.3.3.1.2.3.2" xref="S3.SS3.p1.9.m5.3.3.3.3.1.2.3.1.cmml"><mo id="S3.SS3.p1.9.m5.3.3.3.3.1.2.3.2.1" stretchy="false" xref="S3.SS3.p1.9.m5.3.3.3.3.1.2.3.1.cmml">(</mo><mi id="S3.SS3.p1.9.m5.1.1.1.1" xref="S3.SS3.p1.9.m5.1.1.1.1.cmml">s</mi><mo id="S3.SS3.p1.9.m5.3.3.3.3.1.2.3.2.2" xref="S3.SS3.p1.9.m5.3.3.3.3.1.2.3.1.cmml">,</mo><mi id="S3.SS3.p1.9.m5.2.2.2.2" xref="S3.SS3.p1.9.m5.2.2.2.2.cmml">a</mi><mo id="S3.SS3.p1.9.m5.3.3.3.3.1.2.3.2.3" stretchy="false" xref="S3.SS3.p1.9.m5.3.3.3.3.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p1.9.m5.3.3.3.3.1.1" xref="S3.SS3.p1.9.m5.3.3.3.3.1.1.cmml">≥</mo><mi id="S3.SS3.p1.9.m5.3.3.3.3.1.3" xref="S3.SS3.p1.9.m5.3.3.3.3.1.3.cmml">κ</mi></mrow><mo id="S3.SS3.p1.9.m5.3.3.3.3.3" stretchy="false" xref="S3.SS3.p1.9.m5.3.3.3.4.cmml">}</mo></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.9.m5.3b"><apply id="S3.SS3.p1.9.m5.3.4.cmml" xref="S3.SS3.p1.9.m5.3.4"><csymbol cd="ambiguous" id="S3.SS3.p1.9.m5.3.4.1.cmml" xref="S3.SS3.p1.9.m5.3.4">subscript</csymbol><ci id="S3.SS3.p1.9.m5.3.4.2.cmml" xref="S3.SS3.p1.9.m5.3.4.2">𝐼</ci><set id="S3.SS3.p1.9.m5.3.3.3.4.cmml" xref="S3.SS3.p1.9.m5.3.3.3.3"><apply id="S3.SS3.p1.9.m5.3.3.3.3.1.cmml" xref="S3.SS3.p1.9.m5.3.3.3.3.1"><geq id="S3.SS3.p1.9.m5.3.3.3.3.1.1.cmml" xref="S3.SS3.p1.9.m5.3.3.3.3.1.1"></geq><apply id="S3.SS3.p1.9.m5.3.3.3.3.1.2.cmml" xref="S3.SS3.p1.9.m5.3.3.3.3.1.2"><times id="S3.SS3.p1.9.m5.3.3.3.3.1.2.1.cmml" xref="S3.SS3.p1.9.m5.3.3.3.3.1.2.1"></times><apply id="S3.SS3.p1.9.m5.3.3.3.3.1.2.2.cmml" xref="S3.SS3.p1.9.m5.3.3.3.3.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.9.m5.3.3.3.3.1.2.2.1.cmml" xref="S3.SS3.p1.9.m5.3.3.3.3.1.2.2">subscript</csymbol><ci id="S3.SS3.p1.9.m5.3.3.3.3.1.2.2.2.cmml" xref="S3.SS3.p1.9.m5.3.3.3.3.1.2.2.2">𝐶</ci><ci id="S3.SS3.p1.9.m5.3.3.3.3.1.2.2.3.cmml" xref="S3.SS3.p1.9.m5.3.3.3.3.1.2.2.3">𝜔</ci></apply><interval closure="open" id="S3.SS3.p1.9.m5.3.3.3.3.1.2.3.1.cmml" xref="S3.SS3.p1.9.m5.3.3.3.3.1.2.3.2"><ci id="S3.SS3.p1.9.m5.1.1.1.1.cmml" xref="S3.SS3.p1.9.m5.1.1.1.1">𝑠</ci><ci id="S3.SS3.p1.9.m5.2.2.2.2.cmml" xref="S3.SS3.p1.9.m5.2.2.2.2">𝑎</ci></interval></apply><ci id="S3.SS3.p1.9.m5.3.3.3.3.1.3.cmml" xref="S3.SS3.p1.9.m5.3.3.3.3.1.3">𝜅</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.9.m5.3c">I_{\{C_{\omega}(s,a)\geq\kappa\}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.9.m5.3d">italic_I start_POSTSUBSCRIPT { italic_C start_POSTSUBSCRIPT italic_ω end_POSTSUBSCRIPT ( italic_s , italic_a ) ≥ italic_κ } end_POSTSUBSCRIPT</annotation></semantics></math> is entirely based on the network’s real-time output rather than being defined by human experience.</p>
</div>
<figure class="ltx_figure" id="S3.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="211" id="S3.F7.g1" src="x7.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span><span class="ltx_text ltx_font_bold" id="S3.F7.2.1">Exploration Visualization in Dark Chamber</span> in 50k steps. The exploration radius of AdaMemento with the F-Discriminator is the largest, leading to the largest number of valid paths.</figcaption>
</figure>
<section class="ltx_subsubsection" id="S3.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.1 </span>Proof of memory effectiveness</h4>
<div class="ltx_para ltx_noindent" id="S3.SS3.SSS1.p1">
<p class="ltx_p" id="S3.SS3.SSS1.p1.2">Through ensemble learning, AdaMemento combines exploration and exploitation and adaptively selects between memory prediction or exploration based on the confidence provided by the Reflection Network. our ensemble learning achieves adaptive coordination between exploration and exploitation.
To underscore the efficacy of this approach, we present Theorem <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S3.Thmtheorem3" title="Theorem 3.3. ‣ 3.3.1 Proof of memory effectiveness ‣ 3.3 Ensemble learning for exploration-exploitation balance ‣ 3 Method ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_tag">3.3</span></a> that highlights the policy value of <math alttext="\pi_{\text{new}}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.1.m1.1"><semantics id="S3.SS3.SSS1.p1.1.m1.1a"><msub id="S3.SS3.SSS1.p1.1.m1.1.1" xref="S3.SS3.SSS1.p1.1.m1.1.1.cmml"><mi id="S3.SS3.SSS1.p1.1.m1.1.1.2" xref="S3.SS3.SSS1.p1.1.m1.1.1.2.cmml">π</mi><mtext id="S3.SS3.SSS1.p1.1.m1.1.1.3" xref="S3.SS3.SSS1.p1.1.m1.1.1.3a.cmml">new</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.1.m1.1b"><apply id="S3.SS3.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.1.m1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p1.1.m1.1.1.2.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.2">𝜋</ci><ci id="S3.SS3.SSS1.p1.1.m1.1.1.3a.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.3"><mtext id="S3.SS3.SSS1.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS3.SSS1.p1.1.m1.1.1.3">new</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.1.m1.1c">\pi_{\text{new}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.1.m1.1d">italic_π start_POSTSUBSCRIPT new end_POSTSUBSCRIPT</annotation></semantics></math> is at least as good as that of <math alttext="\pi" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.2.m2.1"><semantics id="S3.SS3.SSS1.p1.2.m2.1a"><mi id="S3.SS3.SSS1.p1.2.m2.1.1" xref="S3.SS3.SSS1.p1.2.m2.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.2.m2.1b"><ci id="S3.SS3.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.2.m2.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.2.m2.1d">italic_π</annotation></semantics></math>.</p>
</div>
<div class="ltx_theorem ltx_theorem_theorem" id="S3.Thmtheorem3">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="S3.Thmtheorem3.1.1.1">Theorem 3.3</span></span><span class="ltx_text ltx_font_bold" id="S3.Thmtheorem3.2.2">.</span>
</h6>
<div class="ltx_para" id="S3.Thmtheorem3.p1">
<p class="ltx_p" id="S3.Thmtheorem3.p1.9"><span class="ltx_text ltx_font_italic" id="S3.Thmtheorem3.p1.9.9">According to Eqn. (<a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S3.E5" title="In 3.3 Ensemble learning for exploration-exploitation balance ‣ 3 Method ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_tag">5</span></a>), if <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="S3.Thmtheorem3.p1.1.1.m1.1"><semantics id="S3.Thmtheorem3.p1.1.1.m1.1a"><msub id="S3.Thmtheorem3.p1.1.1.m1.1.1" xref="S3.Thmtheorem3.p1.1.1.m1.1.1.cmml"><mi id="S3.Thmtheorem3.p1.1.1.m1.1.1.2" xref="S3.Thmtheorem3.p1.1.1.m1.1.1.2.cmml">π</mi><mi id="S3.Thmtheorem3.p1.1.1.m1.1.1.3" xref="S3.Thmtheorem3.p1.1.1.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem3.p1.1.1.m1.1b"><apply id="S3.Thmtheorem3.p1.1.1.m1.1.1.cmml" xref="S3.Thmtheorem3.p1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.1.1.m1.1.1.1.cmml" xref="S3.Thmtheorem3.p1.1.1.m1.1.1">subscript</csymbol><ci id="S3.Thmtheorem3.p1.1.1.m1.1.1.2.cmml" xref="S3.Thmtheorem3.p1.1.1.m1.1.1.2">𝜋</ci><ci id="S3.Thmtheorem3.p1.1.1.m1.1.1.3.cmml" xref="S3.Thmtheorem3.p1.1.1.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem3.p1.1.1.m1.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem3.p1.1.1.m1.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> is a greedy policy for <math alttext="\pi" class="ltx_Math" display="inline" id="S3.Thmtheorem3.p1.2.2.m2.1"><semantics id="S3.Thmtheorem3.p1.2.2.m2.1a"><mi id="S3.Thmtheorem3.p1.2.2.m2.1.1" xref="S3.Thmtheorem3.p1.2.2.m2.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem3.p1.2.2.m2.1b"><ci id="S3.Thmtheorem3.p1.2.2.m2.1.1.cmml" xref="S3.Thmtheorem3.p1.2.2.m2.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem3.p1.2.2.m2.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem3.p1.2.2.m2.1d">italic_π</annotation></semantics></math>, that is, for any state <math alttext="s" class="ltx_Math" display="inline" id="S3.Thmtheorem3.p1.3.3.m3.1"><semantics id="S3.Thmtheorem3.p1.3.3.m3.1a"><mi id="S3.Thmtheorem3.p1.3.3.m3.1.1" xref="S3.Thmtheorem3.p1.3.3.m3.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem3.p1.3.3.m3.1b"><ci id="S3.Thmtheorem3.p1.3.3.m3.1.1.cmml" xref="S3.Thmtheorem3.p1.3.3.m3.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem3.p1.3.3.m3.1c">s</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem3.p1.3.3.m3.1d">italic_s</annotation></semantics></math>, it have <math alttext="\pi_{\theta}(a^{*}|s)=1" class="ltx_Math" display="inline" id="S3.Thmtheorem3.p1.4.4.m4.1"><semantics id="S3.Thmtheorem3.p1.4.4.m4.1a"><mrow id="S3.Thmtheorem3.p1.4.4.m4.1.1" xref="S3.Thmtheorem3.p1.4.4.m4.1.1.cmml"><mrow id="S3.Thmtheorem3.p1.4.4.m4.1.1.1" xref="S3.Thmtheorem3.p1.4.4.m4.1.1.1.cmml"><msub id="S3.Thmtheorem3.p1.4.4.m4.1.1.1.3" xref="S3.Thmtheorem3.p1.4.4.m4.1.1.1.3.cmml"><mi id="S3.Thmtheorem3.p1.4.4.m4.1.1.1.3.2" xref="S3.Thmtheorem3.p1.4.4.m4.1.1.1.3.2.cmml">π</mi><mi id="S3.Thmtheorem3.p1.4.4.m4.1.1.1.3.3" xref="S3.Thmtheorem3.p1.4.4.m4.1.1.1.3.3.cmml">θ</mi></msub><mo id="S3.Thmtheorem3.p1.4.4.m4.1.1.1.2" xref="S3.Thmtheorem3.p1.4.4.m4.1.1.1.2.cmml">⁢</mo><mrow id="S3.Thmtheorem3.p1.4.4.m4.1.1.1.1.1" xref="S3.Thmtheorem3.p1.4.4.m4.1.1.1.1.1.1.cmml"><mo id="S3.Thmtheorem3.p1.4.4.m4.1.1.1.1.1.2" stretchy="false" xref="S3.Thmtheorem3.p1.4.4.m4.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Thmtheorem3.p1.4.4.m4.1.1.1.1.1.1" xref="S3.Thmtheorem3.p1.4.4.m4.1.1.1.1.1.1.cmml"><msup id="S3.Thmtheorem3.p1.4.4.m4.1.1.1.1.1.1.2" xref="S3.Thmtheorem3.p1.4.4.m4.1.1.1.1.1.1.2.cmml"><mi id="S3.Thmtheorem3.p1.4.4.m4.1.1.1.1.1.1.2.2" xref="S3.Thmtheorem3.p1.4.4.m4.1.1.1.1.1.1.2.2.cmml">a</mi><mo id="S3.Thmtheorem3.p1.4.4.m4.1.1.1.1.1.1.2.3" xref="S3.Thmtheorem3.p1.4.4.m4.1.1.1.1.1.1.2.3.cmml">∗</mo></msup><mo fence="false" id="S3.Thmtheorem3.p1.4.4.m4.1.1.1.1.1.1.1" xref="S3.Thmtheorem3.p1.4.4.m4.1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.Thmtheorem3.p1.4.4.m4.1.1.1.1.1.1.3" xref="S3.Thmtheorem3.p1.4.4.m4.1.1.1.1.1.1.3.cmml">s</mi></mrow><mo id="S3.Thmtheorem3.p1.4.4.m4.1.1.1.1.1.3" stretchy="false" xref="S3.Thmtheorem3.p1.4.4.m4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Thmtheorem3.p1.4.4.m4.1.1.2" xref="S3.Thmtheorem3.p1.4.4.m4.1.1.2.cmml">=</mo><mn id="S3.Thmtheorem3.p1.4.4.m4.1.1.3" xref="S3.Thmtheorem3.p1.4.4.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem3.p1.4.4.m4.1b"><apply id="S3.Thmtheorem3.p1.4.4.m4.1.1.cmml" xref="S3.Thmtheorem3.p1.4.4.m4.1.1"><eq id="S3.Thmtheorem3.p1.4.4.m4.1.1.2.cmml" xref="S3.Thmtheorem3.p1.4.4.m4.1.1.2"></eq><apply id="S3.Thmtheorem3.p1.4.4.m4.1.1.1.cmml" xref="S3.Thmtheorem3.p1.4.4.m4.1.1.1"><times id="S3.Thmtheorem3.p1.4.4.m4.1.1.1.2.cmml" xref="S3.Thmtheorem3.p1.4.4.m4.1.1.1.2"></times><apply id="S3.Thmtheorem3.p1.4.4.m4.1.1.1.3.cmml" xref="S3.Thmtheorem3.p1.4.4.m4.1.1.1.3"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.4.4.m4.1.1.1.3.1.cmml" xref="S3.Thmtheorem3.p1.4.4.m4.1.1.1.3">subscript</csymbol><ci id="S3.Thmtheorem3.p1.4.4.m4.1.1.1.3.2.cmml" xref="S3.Thmtheorem3.p1.4.4.m4.1.1.1.3.2">𝜋</ci><ci id="S3.Thmtheorem3.p1.4.4.m4.1.1.1.3.3.cmml" xref="S3.Thmtheorem3.p1.4.4.m4.1.1.1.3.3">𝜃</ci></apply><apply id="S3.Thmtheorem3.p1.4.4.m4.1.1.1.1.1.1.cmml" xref="S3.Thmtheorem3.p1.4.4.m4.1.1.1.1.1"><csymbol cd="latexml" id="S3.Thmtheorem3.p1.4.4.m4.1.1.1.1.1.1.1.cmml" xref="S3.Thmtheorem3.p1.4.4.m4.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.Thmtheorem3.p1.4.4.m4.1.1.1.1.1.1.2.cmml" xref="S3.Thmtheorem3.p1.4.4.m4.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.4.4.m4.1.1.1.1.1.1.2.1.cmml" xref="S3.Thmtheorem3.p1.4.4.m4.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.Thmtheorem3.p1.4.4.m4.1.1.1.1.1.1.2.2.cmml" xref="S3.Thmtheorem3.p1.4.4.m4.1.1.1.1.1.1.2.2">𝑎</ci><times id="S3.Thmtheorem3.p1.4.4.m4.1.1.1.1.1.1.2.3.cmml" xref="S3.Thmtheorem3.p1.4.4.m4.1.1.1.1.1.1.2.3"></times></apply><ci id="S3.Thmtheorem3.p1.4.4.m4.1.1.1.1.1.1.3.cmml" xref="S3.Thmtheorem3.p1.4.4.m4.1.1.1.1.1.1.3">𝑠</ci></apply></apply><cn id="S3.Thmtheorem3.p1.4.4.m4.1.1.3.cmml" type="integer" xref="S3.Thmtheorem3.p1.4.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem3.p1.4.4.m4.1c">\pi_{\theta}(a^{*}|s)=1</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem3.p1.4.4.m4.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT | italic_s ) = 1</annotation></semantics></math>, where <math alttext="a^{*}=\arg\max_{a}Q^{\pi}(s,a)" class="ltx_Math" display="inline" id="S3.Thmtheorem3.p1.5.5.m5.2"><semantics id="S3.Thmtheorem3.p1.5.5.m5.2a"><mrow id="S3.Thmtheorem3.p1.5.5.m5.2.3" xref="S3.Thmtheorem3.p1.5.5.m5.2.3.cmml"><msup id="S3.Thmtheorem3.p1.5.5.m5.2.3.2" xref="S3.Thmtheorem3.p1.5.5.m5.2.3.2.cmml"><mi id="S3.Thmtheorem3.p1.5.5.m5.2.3.2.2" xref="S3.Thmtheorem3.p1.5.5.m5.2.3.2.2.cmml">a</mi><mo id="S3.Thmtheorem3.p1.5.5.m5.2.3.2.3" xref="S3.Thmtheorem3.p1.5.5.m5.2.3.2.3.cmml">∗</mo></msup><mo id="S3.Thmtheorem3.p1.5.5.m5.2.3.1" xref="S3.Thmtheorem3.p1.5.5.m5.2.3.1.cmml">=</mo><mrow id="S3.Thmtheorem3.p1.5.5.m5.2.3.3" xref="S3.Thmtheorem3.p1.5.5.m5.2.3.3.cmml"><mrow id="S3.Thmtheorem3.p1.5.5.m5.2.3.3.2" xref="S3.Thmtheorem3.p1.5.5.m5.2.3.3.2.cmml"><mi id="S3.Thmtheorem3.p1.5.5.m5.2.3.3.2.1" xref="S3.Thmtheorem3.p1.5.5.m5.2.3.3.2.1.cmml">arg</mi><mo id="S3.Thmtheorem3.p1.5.5.m5.2.3.3.2a" lspace="0.167em" xref="S3.Thmtheorem3.p1.5.5.m5.2.3.3.2.cmml">⁡</mo><mrow id="S3.Thmtheorem3.p1.5.5.m5.2.3.3.2.2" xref="S3.Thmtheorem3.p1.5.5.m5.2.3.3.2.2.cmml"><msub id="S3.Thmtheorem3.p1.5.5.m5.2.3.3.2.2.1" xref="S3.Thmtheorem3.p1.5.5.m5.2.3.3.2.2.1.cmml"><mi id="S3.Thmtheorem3.p1.5.5.m5.2.3.3.2.2.1.2" xref="S3.Thmtheorem3.p1.5.5.m5.2.3.3.2.2.1.2.cmml">max</mi><mi id="S3.Thmtheorem3.p1.5.5.m5.2.3.3.2.2.1.3" xref="S3.Thmtheorem3.p1.5.5.m5.2.3.3.2.2.1.3.cmml">a</mi></msub><mo id="S3.Thmtheorem3.p1.5.5.m5.2.3.3.2.2a" lspace="0.167em" xref="S3.Thmtheorem3.p1.5.5.m5.2.3.3.2.2.cmml">⁡</mo><msup id="S3.Thmtheorem3.p1.5.5.m5.2.3.3.2.2.2" xref="S3.Thmtheorem3.p1.5.5.m5.2.3.3.2.2.2.cmml"><mi id="S3.Thmtheorem3.p1.5.5.m5.2.3.3.2.2.2.2" xref="S3.Thmtheorem3.p1.5.5.m5.2.3.3.2.2.2.2.cmml">Q</mi><mi id="S3.Thmtheorem3.p1.5.5.m5.2.3.3.2.2.2.3" xref="S3.Thmtheorem3.p1.5.5.m5.2.3.3.2.2.2.3.cmml">π</mi></msup></mrow></mrow><mo id="S3.Thmtheorem3.p1.5.5.m5.2.3.3.1" xref="S3.Thmtheorem3.p1.5.5.m5.2.3.3.1.cmml">⁢</mo><mrow id="S3.Thmtheorem3.p1.5.5.m5.2.3.3.3.2" xref="S3.Thmtheorem3.p1.5.5.m5.2.3.3.3.1.cmml"><mo id="S3.Thmtheorem3.p1.5.5.m5.2.3.3.3.2.1" stretchy="false" xref="S3.Thmtheorem3.p1.5.5.m5.2.3.3.3.1.cmml">(</mo><mi id="S3.Thmtheorem3.p1.5.5.m5.1.1" xref="S3.Thmtheorem3.p1.5.5.m5.1.1.cmml">s</mi><mo id="S3.Thmtheorem3.p1.5.5.m5.2.3.3.3.2.2" xref="S3.Thmtheorem3.p1.5.5.m5.2.3.3.3.1.cmml">,</mo><mi id="S3.Thmtheorem3.p1.5.5.m5.2.2" xref="S3.Thmtheorem3.p1.5.5.m5.2.2.cmml">a</mi><mo id="S3.Thmtheorem3.p1.5.5.m5.2.3.3.3.2.3" stretchy="false" xref="S3.Thmtheorem3.p1.5.5.m5.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem3.p1.5.5.m5.2b"><apply id="S3.Thmtheorem3.p1.5.5.m5.2.3.cmml" xref="S3.Thmtheorem3.p1.5.5.m5.2.3"><eq id="S3.Thmtheorem3.p1.5.5.m5.2.3.1.cmml" xref="S3.Thmtheorem3.p1.5.5.m5.2.3.1"></eq><apply id="S3.Thmtheorem3.p1.5.5.m5.2.3.2.cmml" xref="S3.Thmtheorem3.p1.5.5.m5.2.3.2"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.5.5.m5.2.3.2.1.cmml" xref="S3.Thmtheorem3.p1.5.5.m5.2.3.2">superscript</csymbol><ci id="S3.Thmtheorem3.p1.5.5.m5.2.3.2.2.cmml" xref="S3.Thmtheorem3.p1.5.5.m5.2.3.2.2">𝑎</ci><times id="S3.Thmtheorem3.p1.5.5.m5.2.3.2.3.cmml" xref="S3.Thmtheorem3.p1.5.5.m5.2.3.2.3"></times></apply><apply id="S3.Thmtheorem3.p1.5.5.m5.2.3.3.cmml" xref="S3.Thmtheorem3.p1.5.5.m5.2.3.3"><times id="S3.Thmtheorem3.p1.5.5.m5.2.3.3.1.cmml" xref="S3.Thmtheorem3.p1.5.5.m5.2.3.3.1"></times><apply id="S3.Thmtheorem3.p1.5.5.m5.2.3.3.2.cmml" xref="S3.Thmtheorem3.p1.5.5.m5.2.3.3.2"><arg id="S3.Thmtheorem3.p1.5.5.m5.2.3.3.2.1.cmml" xref="S3.Thmtheorem3.p1.5.5.m5.2.3.3.2.1"></arg><apply id="S3.Thmtheorem3.p1.5.5.m5.2.3.3.2.2.cmml" xref="S3.Thmtheorem3.p1.5.5.m5.2.3.3.2.2"><apply id="S3.Thmtheorem3.p1.5.5.m5.2.3.3.2.2.1.cmml" xref="S3.Thmtheorem3.p1.5.5.m5.2.3.3.2.2.1"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.5.5.m5.2.3.3.2.2.1.1.cmml" xref="S3.Thmtheorem3.p1.5.5.m5.2.3.3.2.2.1">subscript</csymbol><max id="S3.Thmtheorem3.p1.5.5.m5.2.3.3.2.2.1.2.cmml" xref="S3.Thmtheorem3.p1.5.5.m5.2.3.3.2.2.1.2"></max><ci id="S3.Thmtheorem3.p1.5.5.m5.2.3.3.2.2.1.3.cmml" xref="S3.Thmtheorem3.p1.5.5.m5.2.3.3.2.2.1.3">𝑎</ci></apply><apply id="S3.Thmtheorem3.p1.5.5.m5.2.3.3.2.2.2.cmml" xref="S3.Thmtheorem3.p1.5.5.m5.2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.5.5.m5.2.3.3.2.2.2.1.cmml" xref="S3.Thmtheorem3.p1.5.5.m5.2.3.3.2.2.2">superscript</csymbol><ci id="S3.Thmtheorem3.p1.5.5.m5.2.3.3.2.2.2.2.cmml" xref="S3.Thmtheorem3.p1.5.5.m5.2.3.3.2.2.2.2">𝑄</ci><ci id="S3.Thmtheorem3.p1.5.5.m5.2.3.3.2.2.2.3.cmml" xref="S3.Thmtheorem3.p1.5.5.m5.2.3.3.2.2.2.3">𝜋</ci></apply></apply></apply><interval closure="open" id="S3.Thmtheorem3.p1.5.5.m5.2.3.3.3.1.cmml" xref="S3.Thmtheorem3.p1.5.5.m5.2.3.3.3.2"><ci id="S3.Thmtheorem3.p1.5.5.m5.1.1.cmml" xref="S3.Thmtheorem3.p1.5.5.m5.1.1">𝑠</ci><ci id="S3.Thmtheorem3.p1.5.5.m5.2.2.cmml" xref="S3.Thmtheorem3.p1.5.5.m5.2.2">𝑎</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem3.p1.5.5.m5.2c">a^{*}=\arg\max_{a}Q^{\pi}(s,a)</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem3.p1.5.5.m5.2d">italic_a start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = roman_arg roman_max start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT italic_Q start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT ( italic_s , italic_a )</annotation></semantics></math>. For any state <math alttext="s" class="ltx_Math" display="inline" id="S3.Thmtheorem3.p1.6.6.m6.1"><semantics id="S3.Thmtheorem3.p1.6.6.m6.1a"><mi id="S3.Thmtheorem3.p1.6.6.m6.1.1" xref="S3.Thmtheorem3.p1.6.6.m6.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem3.p1.6.6.m6.1b"><ci id="S3.Thmtheorem3.p1.6.6.m6.1.1.cmml" xref="S3.Thmtheorem3.p1.6.6.m6.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem3.p1.6.6.m6.1c">s</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem3.p1.6.6.m6.1d">italic_s</annotation></semantics></math>, if it satisfies <math alttext="C_{\omega}(s,a^{*})&gt;C_{\omega}(s,a)" class="ltx_Math" display="inline" id="S3.Thmtheorem3.p1.7.7.m7.4"><semantics id="S3.Thmtheorem3.p1.7.7.m7.4a"><mrow id="S3.Thmtheorem3.p1.7.7.m7.4.4" xref="S3.Thmtheorem3.p1.7.7.m7.4.4.cmml"><mrow id="S3.Thmtheorem3.p1.7.7.m7.4.4.1" xref="S3.Thmtheorem3.p1.7.7.m7.4.4.1.cmml"><msub id="S3.Thmtheorem3.p1.7.7.m7.4.4.1.3" xref="S3.Thmtheorem3.p1.7.7.m7.4.4.1.3.cmml"><mi id="S3.Thmtheorem3.p1.7.7.m7.4.4.1.3.2" xref="S3.Thmtheorem3.p1.7.7.m7.4.4.1.3.2.cmml">C</mi><mi id="S3.Thmtheorem3.p1.7.7.m7.4.4.1.3.3" xref="S3.Thmtheorem3.p1.7.7.m7.4.4.1.3.3.cmml">ω</mi></msub><mo id="S3.Thmtheorem3.p1.7.7.m7.4.4.1.2" xref="S3.Thmtheorem3.p1.7.7.m7.4.4.1.2.cmml">⁢</mo><mrow id="S3.Thmtheorem3.p1.7.7.m7.4.4.1.1.1" xref="S3.Thmtheorem3.p1.7.7.m7.4.4.1.1.2.cmml"><mo id="S3.Thmtheorem3.p1.7.7.m7.4.4.1.1.1.2" stretchy="false" xref="S3.Thmtheorem3.p1.7.7.m7.4.4.1.1.2.cmml">(</mo><mi id="S3.Thmtheorem3.p1.7.7.m7.1.1" xref="S3.Thmtheorem3.p1.7.7.m7.1.1.cmml">s</mi><mo id="S3.Thmtheorem3.p1.7.7.m7.4.4.1.1.1.3" xref="S3.Thmtheorem3.p1.7.7.m7.4.4.1.1.2.cmml">,</mo><msup id="S3.Thmtheorem3.p1.7.7.m7.4.4.1.1.1.1" xref="S3.Thmtheorem3.p1.7.7.m7.4.4.1.1.1.1.cmml"><mi id="S3.Thmtheorem3.p1.7.7.m7.4.4.1.1.1.1.2" xref="S3.Thmtheorem3.p1.7.7.m7.4.4.1.1.1.1.2.cmml">a</mi><mo id="S3.Thmtheorem3.p1.7.7.m7.4.4.1.1.1.1.3" xref="S3.Thmtheorem3.p1.7.7.m7.4.4.1.1.1.1.3.cmml">∗</mo></msup><mo id="S3.Thmtheorem3.p1.7.7.m7.4.4.1.1.1.4" stretchy="false" xref="S3.Thmtheorem3.p1.7.7.m7.4.4.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.Thmtheorem3.p1.7.7.m7.4.4.2" xref="S3.Thmtheorem3.p1.7.7.m7.4.4.2.cmml">&gt;</mo><mrow id="S3.Thmtheorem3.p1.7.7.m7.4.4.3" xref="S3.Thmtheorem3.p1.7.7.m7.4.4.3.cmml"><msub id="S3.Thmtheorem3.p1.7.7.m7.4.4.3.2" xref="S3.Thmtheorem3.p1.7.7.m7.4.4.3.2.cmml"><mi id="S3.Thmtheorem3.p1.7.7.m7.4.4.3.2.2" xref="S3.Thmtheorem3.p1.7.7.m7.4.4.3.2.2.cmml">C</mi><mi id="S3.Thmtheorem3.p1.7.7.m7.4.4.3.2.3" xref="S3.Thmtheorem3.p1.7.7.m7.4.4.3.2.3.cmml">ω</mi></msub><mo id="S3.Thmtheorem3.p1.7.7.m7.4.4.3.1" xref="S3.Thmtheorem3.p1.7.7.m7.4.4.3.1.cmml">⁢</mo><mrow id="S3.Thmtheorem3.p1.7.7.m7.4.4.3.3.2" xref="S3.Thmtheorem3.p1.7.7.m7.4.4.3.3.1.cmml"><mo id="S3.Thmtheorem3.p1.7.7.m7.4.4.3.3.2.1" stretchy="false" xref="S3.Thmtheorem3.p1.7.7.m7.4.4.3.3.1.cmml">(</mo><mi id="S3.Thmtheorem3.p1.7.7.m7.2.2" xref="S3.Thmtheorem3.p1.7.7.m7.2.2.cmml">s</mi><mo id="S3.Thmtheorem3.p1.7.7.m7.4.4.3.3.2.2" xref="S3.Thmtheorem3.p1.7.7.m7.4.4.3.3.1.cmml">,</mo><mi id="S3.Thmtheorem3.p1.7.7.m7.3.3" xref="S3.Thmtheorem3.p1.7.7.m7.3.3.cmml">a</mi><mo id="S3.Thmtheorem3.p1.7.7.m7.4.4.3.3.2.3" stretchy="false" xref="S3.Thmtheorem3.p1.7.7.m7.4.4.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem3.p1.7.7.m7.4b"><apply id="S3.Thmtheorem3.p1.7.7.m7.4.4.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.4.4"><gt id="S3.Thmtheorem3.p1.7.7.m7.4.4.2.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.4.4.2"></gt><apply id="S3.Thmtheorem3.p1.7.7.m7.4.4.1.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.4.4.1"><times id="S3.Thmtheorem3.p1.7.7.m7.4.4.1.2.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.4.4.1.2"></times><apply id="S3.Thmtheorem3.p1.7.7.m7.4.4.1.3.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.4.4.1.3"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.7.7.m7.4.4.1.3.1.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.4.4.1.3">subscript</csymbol><ci id="S3.Thmtheorem3.p1.7.7.m7.4.4.1.3.2.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.4.4.1.3.2">𝐶</ci><ci id="S3.Thmtheorem3.p1.7.7.m7.4.4.1.3.3.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.4.4.1.3.3">𝜔</ci></apply><interval closure="open" id="S3.Thmtheorem3.p1.7.7.m7.4.4.1.1.2.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.4.4.1.1.1"><ci id="S3.Thmtheorem3.p1.7.7.m7.1.1.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.1.1">𝑠</ci><apply id="S3.Thmtheorem3.p1.7.7.m7.4.4.1.1.1.1.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.7.7.m7.4.4.1.1.1.1.1.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.4.4.1.1.1.1">superscript</csymbol><ci id="S3.Thmtheorem3.p1.7.7.m7.4.4.1.1.1.1.2.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.4.4.1.1.1.1.2">𝑎</ci><times id="S3.Thmtheorem3.p1.7.7.m7.4.4.1.1.1.1.3.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.4.4.1.1.1.1.3"></times></apply></interval></apply><apply id="S3.Thmtheorem3.p1.7.7.m7.4.4.3.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.4.4.3"><times id="S3.Thmtheorem3.p1.7.7.m7.4.4.3.1.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.4.4.3.1"></times><apply id="S3.Thmtheorem3.p1.7.7.m7.4.4.3.2.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.4.4.3.2"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.7.7.m7.4.4.3.2.1.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.4.4.3.2">subscript</csymbol><ci id="S3.Thmtheorem3.p1.7.7.m7.4.4.3.2.2.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.4.4.3.2.2">𝐶</ci><ci id="S3.Thmtheorem3.p1.7.7.m7.4.4.3.2.3.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.4.4.3.2.3">𝜔</ci></apply><interval closure="open" id="S3.Thmtheorem3.p1.7.7.m7.4.4.3.3.1.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.4.4.3.3.2"><ci id="S3.Thmtheorem3.p1.7.7.m7.2.2.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.2.2">𝑠</ci><ci id="S3.Thmtheorem3.p1.7.7.m7.3.3.cmml" xref="S3.Thmtheorem3.p1.7.7.m7.3.3">𝑎</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem3.p1.7.7.m7.4c">C_{\omega}(s,a^{*})&gt;C_{\omega}(s,a)</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem3.p1.7.7.m7.4d">italic_C start_POSTSUBSCRIPT italic_ω end_POSTSUBSCRIPT ( italic_s , italic_a start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ) &gt; italic_C start_POSTSUBSCRIPT italic_ω end_POSTSUBSCRIPT ( italic_s , italic_a )</annotation></semantics></math>, where <math alttext="a\in A\setminus\{a^{*}\}" class="ltx_Math" display="inline" id="S3.Thmtheorem3.p1.8.8.m8.1"><semantics id="S3.Thmtheorem3.p1.8.8.m8.1a"><mrow id="S3.Thmtheorem3.p1.8.8.m8.1.1" xref="S3.Thmtheorem3.p1.8.8.m8.1.1.cmml"><mi id="S3.Thmtheorem3.p1.8.8.m8.1.1.3" xref="S3.Thmtheorem3.p1.8.8.m8.1.1.3.cmml">a</mi><mo id="S3.Thmtheorem3.p1.8.8.m8.1.1.2" xref="S3.Thmtheorem3.p1.8.8.m8.1.1.2.cmml">∈</mo><mrow id="S3.Thmtheorem3.p1.8.8.m8.1.1.1" xref="S3.Thmtheorem3.p1.8.8.m8.1.1.1.cmml"><mi id="S3.Thmtheorem3.p1.8.8.m8.1.1.1.3" xref="S3.Thmtheorem3.p1.8.8.m8.1.1.1.3.cmml">A</mi><mo id="S3.Thmtheorem3.p1.8.8.m8.1.1.1.2" xref="S3.Thmtheorem3.p1.8.8.m8.1.1.1.2.cmml">∖</mo><mrow id="S3.Thmtheorem3.p1.8.8.m8.1.1.1.1.1" xref="S3.Thmtheorem3.p1.8.8.m8.1.1.1.1.2.cmml"><mo id="S3.Thmtheorem3.p1.8.8.m8.1.1.1.1.1.2" stretchy="false" xref="S3.Thmtheorem3.p1.8.8.m8.1.1.1.1.2.cmml">{</mo><msup id="S3.Thmtheorem3.p1.8.8.m8.1.1.1.1.1.1" xref="S3.Thmtheorem3.p1.8.8.m8.1.1.1.1.1.1.cmml"><mi id="S3.Thmtheorem3.p1.8.8.m8.1.1.1.1.1.1.2" xref="S3.Thmtheorem3.p1.8.8.m8.1.1.1.1.1.1.2.cmml">a</mi><mo id="S3.Thmtheorem3.p1.8.8.m8.1.1.1.1.1.1.3" xref="S3.Thmtheorem3.p1.8.8.m8.1.1.1.1.1.1.3.cmml">∗</mo></msup><mo id="S3.Thmtheorem3.p1.8.8.m8.1.1.1.1.1.3" stretchy="false" xref="S3.Thmtheorem3.p1.8.8.m8.1.1.1.1.2.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem3.p1.8.8.m8.1b"><apply id="S3.Thmtheorem3.p1.8.8.m8.1.1.cmml" xref="S3.Thmtheorem3.p1.8.8.m8.1.1"><in id="S3.Thmtheorem3.p1.8.8.m8.1.1.2.cmml" xref="S3.Thmtheorem3.p1.8.8.m8.1.1.2"></in><ci id="S3.Thmtheorem3.p1.8.8.m8.1.1.3.cmml" xref="S3.Thmtheorem3.p1.8.8.m8.1.1.3">𝑎</ci><apply id="S3.Thmtheorem3.p1.8.8.m8.1.1.1.cmml" xref="S3.Thmtheorem3.p1.8.8.m8.1.1.1"><setdiff id="S3.Thmtheorem3.p1.8.8.m8.1.1.1.2.cmml" xref="S3.Thmtheorem3.p1.8.8.m8.1.1.1.2"></setdiff><ci id="S3.Thmtheorem3.p1.8.8.m8.1.1.1.3.cmml" xref="S3.Thmtheorem3.p1.8.8.m8.1.1.1.3">𝐴</ci><set id="S3.Thmtheorem3.p1.8.8.m8.1.1.1.1.2.cmml" xref="S3.Thmtheorem3.p1.8.8.m8.1.1.1.1.1"><apply id="S3.Thmtheorem3.p1.8.8.m8.1.1.1.1.1.1.cmml" xref="S3.Thmtheorem3.p1.8.8.m8.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.8.8.m8.1.1.1.1.1.1.1.cmml" xref="S3.Thmtheorem3.p1.8.8.m8.1.1.1.1.1.1">superscript</csymbol><ci id="S3.Thmtheorem3.p1.8.8.m8.1.1.1.1.1.1.2.cmml" xref="S3.Thmtheorem3.p1.8.8.m8.1.1.1.1.1.1.2">𝑎</ci><times id="S3.Thmtheorem3.p1.8.8.m8.1.1.1.1.1.1.3.cmml" xref="S3.Thmtheorem3.p1.8.8.m8.1.1.1.1.1.1.3"></times></apply></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem3.p1.8.8.m8.1c">a\in A\setminus\{a^{*}\}</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem3.p1.8.8.m8.1d">italic_a ∈ italic_A ∖ { italic_a start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT }</annotation></semantics></math>. for any state <math alttext="s" class="ltx_Math" display="inline" id="S3.Thmtheorem3.p1.9.9.m9.1"><semantics id="S3.Thmtheorem3.p1.9.9.m9.1a"><mi id="S3.Thmtheorem3.p1.9.9.m9.1.1" xref="S3.Thmtheorem3.p1.9.9.m9.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem3.p1.9.9.m9.1b"><ci id="S3.Thmtheorem3.p1.9.9.m9.1.1.cmml" xref="S3.Thmtheorem3.p1.9.9.m9.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem3.p1.9.9.m9.1c">s</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem3.p1.9.9.m9.1d">italic_s</annotation></semantics></math>, we have</span></p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="V^{\pi_{\text{new}}}\geq V^{\pi}." class="ltx_Math" display="block" id="S3.Ex1.m1.1"><semantics id="S3.Ex1.m1.1a"><mrow id="S3.Ex1.m1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.cmml"><mrow id="S3.Ex1.m1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.cmml"><msup id="S3.Ex1.m1.1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.2.cmml"><mi id="S3.Ex1.m1.1.1.1.1.2.2" xref="S3.Ex1.m1.1.1.1.1.2.2.cmml">V</mi><msub id="S3.Ex1.m1.1.1.1.1.2.3" xref="S3.Ex1.m1.1.1.1.1.2.3.cmml"><mi id="S3.Ex1.m1.1.1.1.1.2.3.2" xref="S3.Ex1.m1.1.1.1.1.2.3.2.cmml">π</mi><mtext class="ltx_mathvariant_italic" id="S3.Ex1.m1.1.1.1.1.2.3.3" xref="S3.Ex1.m1.1.1.1.1.2.3.3a.cmml">new</mtext></msub></msup><mo id="S3.Ex1.m1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.cmml">≥</mo><msup id="S3.Ex1.m1.1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.3.cmml"><mi id="S3.Ex1.m1.1.1.1.1.3.2" xref="S3.Ex1.m1.1.1.1.1.3.2.cmml">V</mi><mi id="S3.Ex1.m1.1.1.1.1.3.3" xref="S3.Ex1.m1.1.1.1.1.3.3.cmml">π</mi></msup></mrow><mo id="S3.Ex1.m1.1.1.1.2" lspace="0em" xref="S3.Ex1.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.1b"><apply id="S3.Ex1.m1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1"><geq id="S3.Ex1.m1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1"></geq><apply id="S3.Ex1.m1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.2.1.cmml" xref="S3.Ex1.m1.1.1.1.1.2">superscript</csymbol><ci id="S3.Ex1.m1.1.1.1.1.2.2.cmml" xref="S3.Ex1.m1.1.1.1.1.2.2">𝑉</ci><apply id="S3.Ex1.m1.1.1.1.1.2.3.cmml" xref="S3.Ex1.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.2.3.1.cmml" xref="S3.Ex1.m1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.Ex1.m1.1.1.1.1.2.3.2.cmml" xref="S3.Ex1.m1.1.1.1.1.2.3.2">𝜋</ci><ci id="S3.Ex1.m1.1.1.1.1.2.3.3a.cmml" xref="S3.Ex1.m1.1.1.1.1.2.3.3"><mtext class="ltx_mathvariant_italic" id="S3.Ex1.m1.1.1.1.1.2.3.3.cmml" mathsize="50%" xref="S3.Ex1.m1.1.1.1.1.2.3.3">new</mtext></ci></apply></apply><apply id="S3.Ex1.m1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.3.1.cmml" xref="S3.Ex1.m1.1.1.1.1.3">superscript</csymbol><ci id="S3.Ex1.m1.1.1.1.1.3.2.cmml" xref="S3.Ex1.m1.1.1.1.1.3.2">𝑉</ci><ci id="S3.Ex1.m1.1.1.1.1.3.3.cmml" xref="S3.Ex1.m1.1.1.1.1.3.3">𝜋</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.1c">V^{\pi_{\text{new}}}\geq V^{\pi}.</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1.m1.1d">italic_V start_POSTSUPERSCRIPT italic_π start_POSTSUBSCRIPT new end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ≥ italic_V start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.SSS1.p2">
<p class="ltx_p" id="S3.SS3.SSS1.p2.1">The proof is shown in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#A3.SS2" title="C.2 Proof of Theorem 3.3 ‣ Appendix C Additional Proofs ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_tag">C.2</span></a>.
This assertion amplifies the significance of ensemble policies, showcasing the robustness of the integrated learning approach. By merging both policies, AdaMemento ensures that the newly derived policy does not compromise on quality.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>
<div class="ltx_para ltx_noindent" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">To demonstrate the impact of fine-grained state distinction on exploration and how memory reflection accelerates the convergence to optimal policies, we first conducted several visualization experiments in subsection <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S4.SS1" title="4.1 Visualization Analysis ‣ 4 Experiments ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_tag">4.1</span></a>, verifying these components’ individual and combined effects. As AdaMemento is flexible and can be easily integrated into existing algorithms, in the main experiment in subsection <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S4.SS2" title="4.2 Main experiments ‣ 4 Experiments ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_tag">4.2</span></a>, we rigorously evaluate its performance in Montezuma’s Revenge, one of the most challenging environments in the field. Additionally, in subsection <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S4.SS3" title="4.3 Generalization experiments ‣ 4 Experiments ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_tag">4.3</span></a>, we conducted extended experiments across a total of 56 environments, including the commonly used reinforcement learning platforms Atari and MuJoCo that cover scenarios ranging from dense to sparse reward environments and from continuous to discrete action spaces. These experiments confirmed the effectiveness and strong generalization of the AdaMemento framework.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.p2">
<p class="ltx_p" id="S4.p2.1">We selected the integration of PPO with AdaMemento as the representative version of our method for large-scale comparisons across various environments. For the remainder of this paper, unless otherwise specified, AdaMemento refers to the integrated version of PPO and AdaMemento, and experiments are conducted with 50 million interaction steps.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Visualization Analysis</h3>
<div class="ltx_para ltx_noindent" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">We selected the Cliff Walking, Four Rooms, and Dark Chamber environments for detailed visualization experiments and analytical argumentation. The settings of these environments are provided in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#A4.SS2" title="D.2 Visualization of Experimental Environments Setup ‣ Appendix D Supplementary Experiment Details ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_tag">D.2</span></a>. In each visualization experiment, we enable either the exploration or exploitation part of AdaMemento and disable the other part for a clear comparison.</p>
</div>
<figure class="ltx_figure" id="S4.F8"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="214" id="S4.F8.g1" src="x8.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span><span class="ltx_text ltx_font_bold" id="S4.F8.2.1">Visualization Experiments in Four Rooms</span> in 0.5 million steps. AdaMemento can form an efficient strategy heading for the reward. </figcaption>
</figure>
<section class="ltx_subsubsection" id="S4.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.1 </span>Visualization of the fine-grained distinction</h4>
<section class="ltx_paragraph" id="S4.SS1.SSS1.Px1">
<h5 class="ltx_title ltx_title_paragraph">Dark Chamber.</h5>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS1.Px1.p1">
<p class="ltx_p" id="S4.SS1.SSS1.Px1.p1.1">The results of Dark Chamber are as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S3.F7" title="Figure 7 ‣ 3.3 Ensemble learning for exploration-exploitation balance ‣ 3 Method ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_tag">7</span></a>, which indicate that both AdaMemento and AdaMemento (w/o F-Discriminator) outperform the baseline algorithms in terms of exploration range and depth. Moreover, AdaMemento with the state fine differentiation mechanism demonstrates superior deep exploration capabilities compared to its counterpart without this mechanism(the Ablation version). Comparing AdaMemento and AdaMemento (w/o F-Discriminator) with the domain’s leading exploration policy RND, it is evident that generating reconstructed images using a single network to build intrinsic motivation is more effective than using two networks to generate feature vectors.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS1.SSS1.Px2">
<h5 class="ltx_title ltx_title_paragraph">Four Rooms.</h5>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS1.Px2.p1">
<p class="ltx_p" id="S4.SS1.SSS1.Px2.p1.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S4.F8" title="Figure 8 ‣ 4.1 Visualization Analysis ‣ 4 Experiments ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_tag">8</span></a> indicates that AdaMemento achieves the largest exploration area and more comprehensive exploration of the environment, establishing a stable reward-acquiring policy, as illustrated by the red arrows. In contrast, the version without the state fine differentiation mechanism (the Ablation version), although superior to the baseline algorithms in exploration coverage, shows significantly less exploration area and quality than the full AdaMemento.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS1.Px2.p2">
<p class="ltx_p" id="S4.SS1.SSS1.Px2.p2.1">In summary, through comparative visualization experiments in both simple reward-free and complex sparse-reward environments, we conclude that our algorithm significantly outperforms the baseline algorithms. Moreover, the state fine differentiation mechanism clearly enhances exploration quality and depth, as evidenced by the comparison between RL methods with and without AdaMemento in both environments.</p>
</div>
</section>
</section>
<section class="ltx_subsubsection" id="S4.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.2 </span>Visualization of memory-reflection</h4>
<section class="ltx_paragraph" id="S4.SS1.SSS2.Px1">
<h5 class="ltx_title ltx_title_paragraph">Cliff Walking.</h5>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS2.Px1.p1">
<p class="ltx_p" id="S4.SS1.SSS2.Px1.p1.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S4.F9" title="Figure 9 ‣ Cliff Walking. ‣ 4.1.2 Visualization of memory-reflection ‣ 4.1 Visualization Analysis ‣ 4 Experiments ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_tag">9</span></a>(b) shows that after integrating the memory-reflection module, the baseline significantly reduces the number of times it falls off the cliffs, indicating that the memory mechanism enables the agent to learn how to avoid dangers by reflecting on past failures. Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S4.F9" title="Figure 9 ‣ Cliff Walking. ‣ 4.1.2 Visualization of memory-reflection ‣ 4.1 Visualization Analysis ‣ 4 Experiments ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_tag">9</span></a>(c) demonstrates that the baseline model integrated with the memory reflection module reduces the number of steps from the starting point to the endpoint more quickly than the model without this module. This indicates that the memory reflection mechanism accelerates discovering the shortest path by summarizing the commonalities of successful experiences, thereby promoting policy learning and optimization and helping the model approach the optimal policy faster. This result validates the effectiveness of the memory reflection module in improving the efficiency of police training.</p>
</div>
<figure class="ltx_figure" id="S4.F9"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="197" id="S4.F9.g1" src="x9.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>(a) is a Cliff Walking environment. (b) denotes the total number of times the agent falls off the cliff. (c) indicates the number of steps the agent takes to reach the goal G during training.</figcaption>
</figure>
</section>
</section>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Main experiments</h3>
<div class="ltx_para ltx_noindent" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">We selected Montezuma’s Revenge, one of the most challenging environments in RL, as the main experimental platform. For baselines, we compared our method with current state-of-the-art and widely used algorithms, including the classic PPO <cite class="ltx_cite ltx_citemacro_cite">Schulman et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#bib.bib24" title="">2017</a>)</cite>, the exploration-centric RND <cite class="ltx_cite ltx_citemacro_cite">Burda et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#bib.bib9" title="">2018b</a>)</cite>, and the recently proposed RPO <cite class="ltx_cite ltx_citemacro_cite">Gan et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#bib.bib13" title="">2024</a>)</cite>. Additionally, we compared mainstream memory utilization methods such as BT-NGU <cite class="ltx_cite ltx_citemacro_citep">(Campos et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#bib.bib10" title="">2021</a>)</cite> for state storage, SIL and DTSIL for experience imitation and trajectory replay, and other memory-based methods.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S3.F4" title="Figure 4 ‣ 3.1.1 Prediction network ‣ 3.1 Memory-reflection module ‣ 3 Method ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_tag">4</span></a> shows the performance of the RL algorithms equipped with and without AdaMemento. The integrated algorithms outperform the baselines in the final score, convergence speed, and stability. Notably, in the case of PPO, integrating AdaMemento led to a score increase of 15 times, along with significant improvements in convergence speed and stability. Additionally, Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S3.F4" title="Figure 4 ‣ 3.1.1 Prediction network ‣ 3.1 Memory-reflection module ‣ 3 Method ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_tag">4</span></a>(b) compares AdaMemento with other memory baselines, demonstrating its superiority. This is due to our method’s capability of summarizing shared knowledge from past experiences for policy prediction rather than simply imitating past behaviors, which promotes the discovery of new policies and leads to superior performance compared to other memory methods.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Generalization experiments</h3>
<div class="ltx_para ltx_noindent" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">To demonstrate the broad applicability of AdaMemento, this subsection presents its performance in several well-known RL environments, including the remaining 55 discrete-space Atari games and the continuous-space environments of MuJoCo.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S3.F5" title="Figure 5 ‣ 3.2 Coarse-fine distinction module ‣ 3 Method ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_tag">5</span></a> shows the performance of AdaMemento in six challenging Atari environments <cite class="ltx_cite ltx_citemacro_citep">(Bellemare et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#bib.bib6" title="">2016</a>)</cite>, excluding Montezuma. Except for a slight improvement in Venture, AdaMemento significantly improves performance in the other five environments. These results indicate that AdaMemento is effective in challenging discrete-space tasks. Additional results for the remaining 46 Atari environments are provided in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#A4" title="Appendix D Supplementary Experiment Details ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_tag">D</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p3">
<p class="ltx_p" id="S4.SS3.p3.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S3.F6" title="Figure 6 ‣ 3.2.2 Proof of the retaining of policy optimality ‣ 3.2 Coarse-fine distinction module ‣ 3 Method ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_tag">6</span></a> shows the performance of AdaMemento in continuous action spaces. The results indicate that our algorithm significantly outperforms the baseline in Swimmer, HalfCheetah, and HumanoidStandup environments. Notably, PPO integrated with AdaMemento achieved nearly three times the performance improvement in Swimmer and twice the improvement in HalfCheetah compared to the non-integrated version. These results demonstrate that AdaMemento is also effective in continuous spaces.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>
<div class="ltx_para ltx_noindent" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">This paper introduces the AdaMemento framework, inspired by the human ability to learn from past experiences and predict the future. AdaMemento innovatively employs a memory reflection mechanism to guide the agent’s predicted trajectory while avoiding potential pitfalls, accelerating the convergence of advantageous policies. Additionally, a coarse-fine distinction mechanism is proposed to promote precise exploration, providing high-quality reflection data for memory construction. For the coordination of exploration and exploitation, we leverage ensemble learning to perform joint inference, achieving an adaptive dynamic balance between exploration and exploitation and providing proof of the effectiveness of ensemble learning. This paper introduces a new intrinsic motivation paradigm in the RL field and theoretically proves its validity, eliminating the need for environment-specific designs while offering outstanding capabilities in terms of generalization and ease of integration. Experimental results across a wide range of environments demonstrate that AdaMemento exhibits strong robustness and generalization. AdaMemento exhibits theoretical innovation and demonstrates considerable potential in practical applications.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Achiam &amp; Sastry (2017)</span>
<span class="ltx_bibblock">
Joshua Achiam and Shankar Sastry.

</span>
<span class="ltx_bibblock">Surprise-based intrinsic motivation for deep reinforcement learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">arXiv preprint arXiv:1703.01732</em>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Andrychowicz et al. (2017)</span>
<span class="ltx_bibblock">
Marcin Andrychowicz, Filip Wolski, Alex Ray, Jonas Schneider, Rachel Fong,
Peter Welinder, Bob McGrew, Josh Tobin, OpenAI Pieter Abbeel, and Wojciech
Zaremba.

</span>
<span class="ltx_bibblock">Hindsight experience replay.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">Advances in Neural Information Processing Systems</em>, pp. 5048–5058, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Badia et al. (2020a)</span>
<span class="ltx_bibblock">
Adrià Puigdomènech Badia, Bilal Piot, Steven Kapturowski, Pablo
Sprechmann, Alex Vitvitskyi, Zhaohan Daniel Guo, and Charles Blundell.

</span>
<span class="ltx_bibblock">Agent57: Outperforming the Atari human benchmark.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">International Conference on Machine Learning</em>, pp. 507–517, 2020a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Badia et al. (2020b)</span>
<span class="ltx_bibblock">
Adrià Puigdomènech Badia, Pablo Sprechmann, Alex Vitvitskyi, Daniel
Guo, Bilal Piot, Steven Kapturowski, Olivier Tieleman, Martín Arjovsky,
Alexander Pritzel, Andew Bolt, et al.

</span>
<span class="ltx_bibblock">Never give up: Learning directed exploration strategies.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">arXiv preprint arXiv:2002.06038</em>, 2020b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Barto et al. (2013)</span>
<span class="ltx_bibblock">
Andrew Barto, Marco Mirolli, and Gianluca Baldassarre.

</span>
<span class="ltx_bibblock">Novelty or surprise?

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Frontiers in Psychology</em>, 4:907, 2013.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bellemare et al. (2016)</span>
<span class="ltx_bibblock">
Marc Bellemare, Sriram Srinivasan, Georg Ostrovski, Tom Schaul, David Saxton,
and Remi Munos.

</span>
<span class="ltx_bibblock">Unifying count-based exploration and intrinsic motivation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">Advances in Neural Information Processing Systems</em>, pp. 1471–1479, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bransford &amp; Johnson (1972)</span>
<span class="ltx_bibblock">
John D Bransford and Marcia K Johnson.

</span>
<span class="ltx_bibblock">Contextual prerequisites for understanding: Some investigations of
comprehension and recall.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">Verbal Learning and Verbal Behavior</em>, 11(6):717–726, 1972.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Burda et al. (2018a)</span>
<span class="ltx_bibblock">
Yuri Burda, Harri Edwards, Deepak Pathak, Amos Storkey, Trevor Darrell, and
Alexei A Efros.

</span>
<span class="ltx_bibblock">Large-scale study of curiosity-driven learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">arXiv preprint arXiv:1808.04355</em>, 2018a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Burda et al. (2018b)</span>
<span class="ltx_bibblock">
Yuri Burda, Harrison Edwards, Amos Storkey, and Oleg Klimov.

</span>
<span class="ltx_bibblock">Exploration by random network distillation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">arXiv preprint arXiv:1810.12894</em>, 2018b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Campos et al. (2021)</span>
<span class="ltx_bibblock">
Víctor Campos, Pablo Sprechmann, Steven Hansen, Andre Barreto, Steven
Kapturowski, Alex Vitvitskyi, Adria Puigdomenech Badia, and Charles Blundell.

</span>
<span class="ltx_bibblock">Beyond fine-tuning: Transferring behavior in reinforcement learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">arXiv preprint arXiv:2102.13515</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Devidze et al. (2022)</span>
<span class="ltx_bibblock">
Rati Devidze, Parameswaran Kamalaruban, and Adish Singla.

</span>
<span class="ltx_bibblock">Exploration-guided reward shaping for reinforcement learning under
sparse rewards.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">Advances in Neural Information Processing Systems</em>,
35:5829–5842, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gan et al. (2022)</span>
<span class="ltx_bibblock">
Yaozhong Gan, Zhe Zhang, and Xiaoyang Tan.

</span>
<span class="ltx_bibblock">Smoothing advantage learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">AAAI Conference on Artificial Intelligence</em>, pp. 6657–6664, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gan et al. (2024)</span>
<span class="ltx_bibblock">
Yaozhong Gan, Renye Yan, Zhe Wu, and Junliang Xing.

</span>
<span class="ltx_bibblock">Reflective policy optimization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">International Conference on Machine Learning</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al. (2020)</span>
<span class="ltx_bibblock">
Yijie Guo, Jongwook Choi, Marcin Moczulski, Shengyu Feng, Samy Bengio, Mohammad
Norouzi, and Honglak Lee.

</span>
<span class="ltx_bibblock">Memory based trajectory-conditioned policies for learning from sparse
rewards.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">Advances in Neural Information Processing Systems</em>,
33:4333–4345, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al. (2022)</span>
<span class="ltx_bibblock">
Zhaohan Guo, Shantanu Thakoor, Miruna Pîslar, Bernardo Avila Pires,
Florent Altché, Corentin Tallec, Alaa Saade, Daniele Calandriello,
Jean-Bastien Grill, Yunhao Tang, et al.

</span>
<span class="ltx_bibblock">Byol-explore: Exploration by bootstrapped prediction.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Advances in Neural Information Processing Systems</em>, pp. 31855–31870, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hare (2019)</span>
<span class="ltx_bibblock">
Joshua Hare.

</span>
<span class="ltx_bibblock">Dealing with sparse rewards in reinforcement learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">arXiv preprint arXiv:1910.09281</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liang et al. (2018)</span>
<span class="ltx_bibblock">
Chen Liang, Mohammad Norouzi, Jonathan Berant, Quoc V Le, and Ni Lao.

</span>
<span class="ltx_bibblock">Memory augmented policy optimization for program synthesis and
semantic parsing.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">Advances in Neural Information Processing Systems</em>, 31, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2021)</span>
<span class="ltx_bibblock">
Shuai Liu, Shuai Wang, Xinyu Liu, Amir H Gandomi, Mahmoud Daneshmand, Khan
Muhammad, and Victor Hugo C De Albuquerque.

</span>
<span class="ltx_bibblock">Human memory update strategy: a multi-layer template update mechanism
for remote visual monitoring.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">IEEE Transactions on Multimedia</em>, 23:2188–2198,
2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Oh et al. (2018)</span>
<span class="ltx_bibblock">
Junhyuk Oh, Yijie Guo, Satinder Singh, and Honglak Lee.

</span>
<span class="ltx_bibblock">Self-imitation learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">International Conference on Machine Learning</em>, pp. 3878–3887, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Oudeyer &amp; Kaplan (2007)</span>
<span class="ltx_bibblock">
Pierre-Yves Oudeyer and Frederic Kaplan.

</span>
<span class="ltx_bibblock">What is intrinsic motivation? A typology of computational
approaches.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">Frontiers in Neurorobotics</em>, 1:6, 2007.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pathak et al. (2017)</span>
<span class="ltx_bibblock">
Deepak Pathak, Pulkit Agrawal, Alexei A Efros, and Trevor Darrell.

</span>
<span class="ltx_bibblock">Curiosity-driven exploration by self-supervised prediction.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">International Conference on Machine Learning</em>, pp. 2778–2787, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Puterman (1990)</span>
<span class="ltx_bibblock">
Martin L Puterman.

</span>
<span class="ltx_bibblock">Markov decision processes.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">Handbooks in operations research and management science</em>,
2:331–434, 1990.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ryan &amp; Deci (2000)</span>
<span class="ltx_bibblock">
Richard M Ryan and Edward L Deci.

</span>
<span class="ltx_bibblock">Intrinsic and extrinsic motivations: Classic definitions and new
directions.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">Contemporary Educational Psychology</em>, 25(1):54–67, 2000.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schulman et al. (2017)</span>
<span class="ltx_bibblock">
John Schulman, Filip Wolski, Prafulla Dhariwal, Alec Radford, and Oleg Klimov.

</span>
<span class="ltx_bibblock">Proximal policy optimization algorithms.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">arXiv preprint arXiv:1707.06347</em>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Silvia (2012)</span>
<span class="ltx_bibblock">
Paul J Silvia.

</span>
<span class="ltx_bibblock">Curiosity and motivation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">The Oxford Handbook of Human Motivation</em>, pp.  157–166, 2012.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Additional related works</h2>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Sparse Reward Environments</h3>
<div class="ltx_para ltx_noindent" id="A1.SS1.p1">
<p class="ltx_p" id="A1.SS1.p1.1">Sparse reward environments <cite class="ltx_cite ltx_citemacro_citep">(Hare, <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#bib.bib16" title="">2019</a>; Devidze et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#bib.bib11" title="">2022</a>)</cite> in RL are scenarios where agents receive little to no feedback most of the time, only receiving rewards under specific conditions. This scarcity makes it difficult for agents to get enough guidance during training, causing traditional algorithms to perform poorly, as they rely on frequent reward signals to update policies and value functions.
To address this issue, researchers have proposed several approaches. First, improving exploration policies, such as using intrinsic rewards based on state novelty or prediction error, can encourage agents to explore unknown areas. Second, imitation and inverse reinforcement learning are widely applied, allowing agents to learn from expert demonstrations and find optimal paths more efficiently. Additionally, memory-based methods replay and mimic past successful experiences, substituting sparse reward signals, accelerating policy optimization, and easing the difficulty of updates in sparse reward environments.</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Memory motheds</h3>
<div class="ltx_para ltx_noindent" id="A1.SS2.p1">
<p class="ltx_p" id="A1.SS2.p1.1">Existing mainstream memory utilization methods can be broadly divided into memory storage and experience reuse. Below, we provide a more detailed overview of related work to help readers gain a better understanding.</p>
</div>
<section class="ltx_paragraph" id="A1.SS2.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Storage-based methods:</h5>
<div class="ltx_para ltx_noindent" id="A1.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="A1.SS2.SSS0.Px1.p1.1">Memory storage is the simplest and most intuitive method of memory utilization. It helps address the sparse reward problem by storing the agent’s experienced states to measure state novelty. A typical example of this approach is the NGU <cite class="ltx_cite ltx_citemacro_citep">(Badia et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#bib.bib4" title="">2020b</a>)</cite> method, which aims to solve exploration challenges in sparse reward environments by storing past state experiences. NGU memorizes processed state experiences and uses a clustering-based method to manage the memory buffer. By clustering visited states and using these cluster centers, the agent can identify and explore new states, providing additional intrinsic rewards based on state rarity. The agent receives higher intrinsic rewards when visiting rare states, encouraging the exploration of new areas. This memory comparison mechanism improves the agent’s exploration efficiency and learning ability in sparse reward environments.
However, the NGU algorithm has some limitations. First, managing and updating the cluster centers can become increasingly complex in high-dimensional state spaces, reducing computational efficiency. Additionally, clustering-based methods may incorrectly group similar states with different values in high-dimensional spaces, overlooking critical nuances and affecting policy optimization. Finally, memory storage methods mainly focus on constructing state counts via memory buffers rather than using stored experiences to predict and guide future policies.</p>
</div>
</section>
<section class="ltx_paragraph" id="A1.SS2.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Experience Replay methods:</h5>
<div class="ltx_para ltx_noindent" id="A1.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="A1.SS2.SSS0.Px2.p1.1">Imitation learning <cite class="ltx_cite ltx_citemacro_citep">(Oh et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#bib.bib19" title="">2018</a>; Guo et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#bib.bib14" title="">2020</a>)</cite> based on experience replay is a memory utilization approach that centers on using the agent’s past successful experiences to guide current policy optimization. Specifically, as the agent interacts with the environment, it stores information about its experienced states, actions, and corresponding rewards in a replay buffer. By analyzing this historical experience, particularly those associated with high rewards, the agent learns to imitate successful behaviors, reinforcing the positive effects of these experiences during policy optimization. Through replaying and mimicking high-reward actions, the agent improves decision-making quality, reduces reliance on random exploration, and accelerates policy convergence and improvement. By effectively leveraging valuable past experiences, such algorithms provide a more stable and efficient optimization path, helping the agent quickly learn and adapt to complex environments.
Despite significant progress in imitation learning based on experience replay, this approach has three notable limitations. First, these methods place too much emphasis on reproducing past high-value behaviors while falling short in exploring new policies. This can weaken the agent’s exploration capabilities, causing it to miss the global optimal policy and become stuck in local optima. Second, these methods primarily focus on leveraging successful experiences while neglecting the value of failed experiences. Failed experiences are equally important for policy optimization. Human learning can extract valuable insights from both positive and negative experiences. In reinforcement learning, paths with high rewards often hide potential risks or pitfalls. Thus, effectively using failed experiences to avoid repeated mistakes is crucial for improving policy optimization. Third, these methods focus on imitating past successful behaviors rather than truly understanding the experiences and using them to predict future decisions. As a result, the agent often merely replicates past behavior patterns rather than using those experiences to anticipate future scenarios and outcomes.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="A1.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.3 </span>Intrinsic Motivation</h3>
<div class="ltx_para ltx_noindent" id="A1.SS3.p1">
<p class="ltx_p" id="A1.SS3.p1.1">In addressing the problem of sparse and delayed rewards, intrinsic motivation models <cite class="ltx_cite ltx_citemacro_cite">Ryan &amp; Deci (<a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#bib.bib23" title="">2000</a>); Badia et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#bib.bib3" title="">2020a</a>); Oudeyer &amp; Kaplan (<a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#bib.bib20" title="">2007</a>)</cite> have gained increasing attention for their ability to enhance exploration efficiency. Intrinsic motivation methods simulate intrinsic drives in organisms, such as curiosity, to guide agents in exploration, thereby sustaining exploration efforts in environments lacking clear extrinsic rewards. These approaches can be broadly categorized into two types: count-based policies and prediction error-based policies.</p>
</div>
<section class="ltx_paragraph" id="A1.SS3.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Count-based Intrinsic Motivation:</h5>
<div class="ltx_para ltx_noindent" id="A1.SS3.SSS0.Px1.p1">
<p class="ltx_p" id="A1.SS3.SSS0.Px1.p1.1">Count-based policies <cite class="ltx_cite ltx_citemacro_cite">Bellemare et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#bib.bib6" title="">2016</a>)</cite> track the frequency of an agent’s state visits, using a decreasing function of state counts as exploration rewards. The basic principle is that the agent should receive higher rewards for visiting less frequently explored states, encouraging exploration of under-explored areas. The simplicity and intuitiveness of this mechanism have made it widely applicable in simple reinforcement learning environments. However, as the complexity of the environment increases, particularly in high-dimensional state spaces, the number of states grows rapidly. In such cases, the cost of maintaining and updating state counts significantly rises. Specifically, state counting requires substantial memory to record the visitation frequency of each state. Additionally, in dynamic environments, frequently updating the counts may lead to decreased computational efficiency. This not only increases resource consumption but may also slow down the agent’s real-time decision-making, reducing its practicality in complex environments.</p>
</div>
</section>
<section class="ltx_paragraph" id="A1.SS3.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Error-based Intrinsic Motivation:</h5>
<div class="ltx_para ltx_noindent" id="A1.SS3.SSS0.Px2.p1">
<p class="ltx_p" id="A1.SS3.SSS0.Px2.p1.1">Prediction error-based policies <cite class="ltx_cite ltx_citemacro_cite">Burda et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#bib.bib9" title="">2018b</a>); Pathak et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#bib.bib21" title="">2017</a>); Burda et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#bib.bib8" title="">2018a</a>); Achiam &amp; Sastry (<a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#bib.bib1" title="">2017</a>); Silvia (<a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#bib.bib25" title="">2012</a>)</cite> leverage neural network errors to assess state visit density, forming curiosity-driven exploration policies. Specifically, these methods calculate the agent’s prediction error in a given state to estimate how frequently the state has been visited. Visits to low-density states are encouraged, while visits to high-density states are reduced, promoting exploration of unknown or novel states. This approach eliminates the dependence on storage and computational efficiency inherent in count-based intrinsic reward methods. It significantly improves exploration quality in the early stages of a task, allowing the agent to gather more information and experience. By this mechanism, the agent can more flexibly address exploration challenges in complex environments, actively seeking under-explored states.
This policy’s effectiveness lies in broadening exploration and enabling the agent to adapt to environmental changes, thereby improving learning efficiency quickly. However, existing intrinsic motivation models often focus on enhancing exploration quality while paying less attention to exploitation. This tendency can lead to diminishing exploration returns in later stages as the agent’s interaction with the environment deepens, causing exploration efficiency to decline significantly—a phenomenon known as the ”intrinsic motivation fading problem” <cite class="ltx_cite ltx_citemacro_cite">Barto et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#bib.bib5" title="">2013</a>); Oudeyer &amp; Kaplan (<a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#bib.bib20" title="">2007</a>)</cite>. Additionally, current prediction error-based intrinsic motivation methods tend to overlook subtle differences between similar states, which can result in missed opportunities to explore critical states and, consequently, potential policy improvements.</p>
</div>
</section>
</section>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Additional Preliminaries</h2>
<section class="ltx_subsection" id="A2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span>Markov Decision Process (MDP)</h3>
<div class="ltx_para ltx_noindent" id="A2.SS1.p1">
<p class="ltx_p" id="A2.SS1.p1.5">A Markov Decision Process (MDP) <cite class="ltx_cite ltx_citemacro_cite">Puterman (<a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#bib.bib22" title="">1990</a>)</cite>, as described by Sutton and Barto (1999) and Puterman (2014), is defined by the tuple <math alttext="\langle S,A,P,R,\gamma\rangle" class="ltx_Math" display="inline" id="A2.SS1.p1.1.m1.5"><semantics id="A2.SS1.p1.1.m1.5a"><mrow id="A2.SS1.p1.1.m1.5.6.2" xref="A2.SS1.p1.1.m1.5.6.1.cmml"><mo id="A2.SS1.p1.1.m1.5.6.2.1" stretchy="false" xref="A2.SS1.p1.1.m1.5.6.1.cmml">⟨</mo><mi id="A2.SS1.p1.1.m1.1.1" xref="A2.SS1.p1.1.m1.1.1.cmml">S</mi><mo id="A2.SS1.p1.1.m1.5.6.2.2" xref="A2.SS1.p1.1.m1.5.6.1.cmml">,</mo><mi id="A2.SS1.p1.1.m1.2.2" xref="A2.SS1.p1.1.m1.2.2.cmml">A</mi><mo id="A2.SS1.p1.1.m1.5.6.2.3" xref="A2.SS1.p1.1.m1.5.6.1.cmml">,</mo><mi id="A2.SS1.p1.1.m1.3.3" xref="A2.SS1.p1.1.m1.3.3.cmml">P</mi><mo id="A2.SS1.p1.1.m1.5.6.2.4" xref="A2.SS1.p1.1.m1.5.6.1.cmml">,</mo><mi id="A2.SS1.p1.1.m1.4.4" xref="A2.SS1.p1.1.m1.4.4.cmml">R</mi><mo id="A2.SS1.p1.1.m1.5.6.2.5" xref="A2.SS1.p1.1.m1.5.6.1.cmml">,</mo><mi id="A2.SS1.p1.1.m1.5.5" xref="A2.SS1.p1.1.m1.5.5.cmml">γ</mi><mo id="A2.SS1.p1.1.m1.5.6.2.6" stretchy="false" xref="A2.SS1.p1.1.m1.5.6.1.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.1.m1.5b"><list id="A2.SS1.p1.1.m1.5.6.1.cmml" xref="A2.SS1.p1.1.m1.5.6.2"><ci id="A2.SS1.p1.1.m1.1.1.cmml" xref="A2.SS1.p1.1.m1.1.1">𝑆</ci><ci id="A2.SS1.p1.1.m1.2.2.cmml" xref="A2.SS1.p1.1.m1.2.2">𝐴</ci><ci id="A2.SS1.p1.1.m1.3.3.cmml" xref="A2.SS1.p1.1.m1.3.3">𝑃</ci><ci id="A2.SS1.p1.1.m1.4.4.cmml" xref="A2.SS1.p1.1.m1.4.4">𝑅</ci><ci id="A2.SS1.p1.1.m1.5.5.cmml" xref="A2.SS1.p1.1.m1.5.5">𝛾</ci></list></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.1.m1.5c">\langle S,A,P,R,\gamma\rangle</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.1.m1.5d">⟨ italic_S , italic_A , italic_P , italic_R , italic_γ ⟩</annotation></semantics></math>, where <math alttext="S" class="ltx_Math" display="inline" id="A2.SS1.p1.2.m2.1"><semantics id="A2.SS1.p1.2.m2.1a"><mi id="A2.SS1.p1.2.m2.1.1" xref="A2.SS1.p1.2.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.2.m2.1b"><ci id="A2.SS1.p1.2.m2.1.1.cmml" xref="A2.SS1.p1.2.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.2.m2.1c">S</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.2.m2.1d">italic_S</annotation></semantics></math> and <math alttext="A" class="ltx_Math" display="inline" id="A2.SS1.p1.3.m3.1"><semantics id="A2.SS1.p1.3.m3.1a"><mi id="A2.SS1.p1.3.m3.1.1" xref="A2.SS1.p1.3.m3.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.3.m3.1b"><ci id="A2.SS1.p1.3.m3.1.1.cmml" xref="A2.SS1.p1.3.m3.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.3.m3.1c">A</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.3.m3.1d">italic_A</annotation></semantics></math> denote the sets of states and actions, respectively. The function <math alttext="P" class="ltx_Math" display="inline" id="A2.SS1.p1.4.m4.1"><semantics id="A2.SS1.p1.4.m4.1a"><mi id="A2.SS1.p1.4.m4.1.1" xref="A2.SS1.p1.4.m4.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.4.m4.1b"><ci id="A2.SS1.p1.4.m4.1.1.cmml" xref="A2.SS1.p1.4.m4.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.4.m4.1c">P</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.4.m4.1d">italic_P</annotation></semantics></math> represents the state transition probabilities, describing the likelihood of transitioning from one state to another upon taking a specific action. The reward function <math alttext="R" class="ltx_Math" display="inline" id="A2.SS1.p1.5.m5.1"><semantics id="A2.SS1.p1.5.m5.1a"><mi id="A2.SS1.p1.5.m5.1.1" xref="A2.SS1.p1.5.m5.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.5.m5.1b"><ci id="A2.SS1.p1.5.m5.1.1.cmml" xref="A2.SS1.p1.5.m5.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.5.m5.1c">R</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.5.m5.1d">italic_R</annotation></semantics></math> assigns a scalar value (often assumed to be non-negative) for each state-action pair, reflecting the immediate feedback received after the transition.</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS1.p2">
<p class="ltx_p" id="A2.SS1.p2.4">The discount factor <math alttext="\gamma\in[0,1)" class="ltx_Math" display="inline" id="A2.SS1.p2.1.m1.2"><semantics id="A2.SS1.p2.1.m1.2a"><mrow id="A2.SS1.p2.1.m1.2.3" xref="A2.SS1.p2.1.m1.2.3.cmml"><mi id="A2.SS1.p2.1.m1.2.3.2" xref="A2.SS1.p2.1.m1.2.3.2.cmml">γ</mi><mo id="A2.SS1.p2.1.m1.2.3.1" xref="A2.SS1.p2.1.m1.2.3.1.cmml">∈</mo><mrow id="A2.SS1.p2.1.m1.2.3.3.2" xref="A2.SS1.p2.1.m1.2.3.3.1.cmml"><mo id="A2.SS1.p2.1.m1.2.3.3.2.1" stretchy="false" xref="A2.SS1.p2.1.m1.2.3.3.1.cmml">[</mo><mn id="A2.SS1.p2.1.m1.1.1" xref="A2.SS1.p2.1.m1.1.1.cmml">0</mn><mo id="A2.SS1.p2.1.m1.2.3.3.2.2" xref="A2.SS1.p2.1.m1.2.3.3.1.cmml">,</mo><mn id="A2.SS1.p2.1.m1.2.2" xref="A2.SS1.p2.1.m1.2.2.cmml">1</mn><mo id="A2.SS1.p2.1.m1.2.3.3.2.3" stretchy="false" xref="A2.SS1.p2.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p2.1.m1.2b"><apply id="A2.SS1.p2.1.m1.2.3.cmml" xref="A2.SS1.p2.1.m1.2.3"><in id="A2.SS1.p2.1.m1.2.3.1.cmml" xref="A2.SS1.p2.1.m1.2.3.1"></in><ci id="A2.SS1.p2.1.m1.2.3.2.cmml" xref="A2.SS1.p2.1.m1.2.3.2">𝛾</ci><interval closure="closed-open" id="A2.SS1.p2.1.m1.2.3.3.1.cmml" xref="A2.SS1.p2.1.m1.2.3.3.2"><cn id="A2.SS1.p2.1.m1.1.1.cmml" type="integer" xref="A2.SS1.p2.1.m1.1.1">0</cn><cn id="A2.SS1.p2.1.m1.2.2.cmml" type="integer" xref="A2.SS1.p2.1.m1.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p2.1.m1.2c">\gamma\in[0,1)</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p2.1.m1.2d">italic_γ ∈ [ 0 , 1 )</annotation></semantics></math> accounts for the agent’s preference for immediate versus future rewards by adjusting the value of rewards over time. During interactions in the MDP, the agent generates sequences (trajectories) consisting of states, actions, and rewards: <math alttext="\tau=(s_{0},a_{0},R(s_{0},a_{0})),\cdots,(s_{t},a_{t},R(s_{t},a_{t})),\cdots" class="ltx_Math" display="inline" id="A2.SS1.p2.2.m2.4"><semantics id="A2.SS1.p2.2.m2.4a"><mrow id="A2.SS1.p2.2.m2.4.4" xref="A2.SS1.p2.2.m2.4.4.cmml"><mi id="A2.SS1.p2.2.m2.4.4.4" xref="A2.SS1.p2.2.m2.4.4.4.cmml">τ</mi><mo id="A2.SS1.p2.2.m2.4.4.3" xref="A2.SS1.p2.2.m2.4.4.3.cmml">=</mo><mrow id="A2.SS1.p2.2.m2.4.4.2.2" xref="A2.SS1.p2.2.m2.4.4.2.3.cmml"><mrow id="A2.SS1.p2.2.m2.3.3.1.1.1.3" xref="A2.SS1.p2.2.m2.3.3.1.1.1.4.cmml"><mo id="A2.SS1.p2.2.m2.3.3.1.1.1.3.4" stretchy="false" xref="A2.SS1.p2.2.m2.3.3.1.1.1.4.cmml">(</mo><msub id="A2.SS1.p2.2.m2.3.3.1.1.1.1.1" xref="A2.SS1.p2.2.m2.3.3.1.1.1.1.1.cmml"><mi id="A2.SS1.p2.2.m2.3.3.1.1.1.1.1.2" xref="A2.SS1.p2.2.m2.3.3.1.1.1.1.1.2.cmml">s</mi><mn id="A2.SS1.p2.2.m2.3.3.1.1.1.1.1.3" xref="A2.SS1.p2.2.m2.3.3.1.1.1.1.1.3.cmml">0</mn></msub><mo id="A2.SS1.p2.2.m2.3.3.1.1.1.3.5" xref="A2.SS1.p2.2.m2.3.3.1.1.1.4.cmml">,</mo><msub id="A2.SS1.p2.2.m2.3.3.1.1.1.2.2" xref="A2.SS1.p2.2.m2.3.3.1.1.1.2.2.cmml"><mi id="A2.SS1.p2.2.m2.3.3.1.1.1.2.2.2" xref="A2.SS1.p2.2.m2.3.3.1.1.1.2.2.2.cmml">a</mi><mn id="A2.SS1.p2.2.m2.3.3.1.1.1.2.2.3" xref="A2.SS1.p2.2.m2.3.3.1.1.1.2.2.3.cmml">0</mn></msub><mo id="A2.SS1.p2.2.m2.3.3.1.1.1.3.6" xref="A2.SS1.p2.2.m2.3.3.1.1.1.4.cmml">,</mo><mrow id="A2.SS1.p2.2.m2.3.3.1.1.1.3.3" xref="A2.SS1.p2.2.m2.3.3.1.1.1.3.3.cmml"><mi id="A2.SS1.p2.2.m2.3.3.1.1.1.3.3.4" xref="A2.SS1.p2.2.m2.3.3.1.1.1.3.3.4.cmml">R</mi><mo id="A2.SS1.p2.2.m2.3.3.1.1.1.3.3.3" xref="A2.SS1.p2.2.m2.3.3.1.1.1.3.3.3.cmml">⁢</mo><mrow id="A2.SS1.p2.2.m2.3.3.1.1.1.3.3.2.2" xref="A2.SS1.p2.2.m2.3.3.1.1.1.3.3.2.3.cmml"><mo id="A2.SS1.p2.2.m2.3.3.1.1.1.3.3.2.2.3" stretchy="false" xref="A2.SS1.p2.2.m2.3.3.1.1.1.3.3.2.3.cmml">(</mo><msub id="A2.SS1.p2.2.m2.3.3.1.1.1.3.3.1.1.1" xref="A2.SS1.p2.2.m2.3.3.1.1.1.3.3.1.1.1.cmml"><mi id="A2.SS1.p2.2.m2.3.3.1.1.1.3.3.1.1.1.2" xref="A2.SS1.p2.2.m2.3.3.1.1.1.3.3.1.1.1.2.cmml">s</mi><mn id="A2.SS1.p2.2.m2.3.3.1.1.1.3.3.1.1.1.3" xref="A2.SS1.p2.2.m2.3.3.1.1.1.3.3.1.1.1.3.cmml">0</mn></msub><mo id="A2.SS1.p2.2.m2.3.3.1.1.1.3.3.2.2.4" xref="A2.SS1.p2.2.m2.3.3.1.1.1.3.3.2.3.cmml">,</mo><msub id="A2.SS1.p2.2.m2.3.3.1.1.1.3.3.2.2.2" xref="A2.SS1.p2.2.m2.3.3.1.1.1.3.3.2.2.2.cmml"><mi id="A2.SS1.p2.2.m2.3.3.1.1.1.3.3.2.2.2.2" xref="A2.SS1.p2.2.m2.3.3.1.1.1.3.3.2.2.2.2.cmml">a</mi><mn id="A2.SS1.p2.2.m2.3.3.1.1.1.3.3.2.2.2.3" xref="A2.SS1.p2.2.m2.3.3.1.1.1.3.3.2.2.2.3.cmml">0</mn></msub><mo id="A2.SS1.p2.2.m2.3.3.1.1.1.3.3.2.2.5" stretchy="false" xref="A2.SS1.p2.2.m2.3.3.1.1.1.3.3.2.3.cmml">)</mo></mrow></mrow><mo id="A2.SS1.p2.2.m2.3.3.1.1.1.3.7" stretchy="false" xref="A2.SS1.p2.2.m2.3.3.1.1.1.4.cmml">)</mo></mrow><mo id="A2.SS1.p2.2.m2.4.4.2.2.3" xref="A2.SS1.p2.2.m2.4.4.2.3.cmml">,</mo><mi id="A2.SS1.p2.2.m2.1.1" mathvariant="normal" xref="A2.SS1.p2.2.m2.1.1.cmml">⋯</mi><mo id="A2.SS1.p2.2.m2.4.4.2.2.4" xref="A2.SS1.p2.2.m2.4.4.2.3.cmml">,</mo><mrow id="A2.SS1.p2.2.m2.4.4.2.2.2.3" xref="A2.SS1.p2.2.m2.4.4.2.2.2.4.cmml"><mo id="A2.SS1.p2.2.m2.4.4.2.2.2.3.4" stretchy="false" xref="A2.SS1.p2.2.m2.4.4.2.2.2.4.cmml">(</mo><msub id="A2.SS1.p2.2.m2.4.4.2.2.2.1.1" xref="A2.SS1.p2.2.m2.4.4.2.2.2.1.1.cmml"><mi id="A2.SS1.p2.2.m2.4.4.2.2.2.1.1.2" xref="A2.SS1.p2.2.m2.4.4.2.2.2.1.1.2.cmml">s</mi><mi id="A2.SS1.p2.2.m2.4.4.2.2.2.1.1.3" xref="A2.SS1.p2.2.m2.4.4.2.2.2.1.1.3.cmml">t</mi></msub><mo id="A2.SS1.p2.2.m2.4.4.2.2.2.3.5" xref="A2.SS1.p2.2.m2.4.4.2.2.2.4.cmml">,</mo><msub id="A2.SS1.p2.2.m2.4.4.2.2.2.2.2" xref="A2.SS1.p2.2.m2.4.4.2.2.2.2.2.cmml"><mi id="A2.SS1.p2.2.m2.4.4.2.2.2.2.2.2" xref="A2.SS1.p2.2.m2.4.4.2.2.2.2.2.2.cmml">a</mi><mi id="A2.SS1.p2.2.m2.4.4.2.2.2.2.2.3" xref="A2.SS1.p2.2.m2.4.4.2.2.2.2.2.3.cmml">t</mi></msub><mo id="A2.SS1.p2.2.m2.4.4.2.2.2.3.6" xref="A2.SS1.p2.2.m2.4.4.2.2.2.4.cmml">,</mo><mrow id="A2.SS1.p2.2.m2.4.4.2.2.2.3.3" xref="A2.SS1.p2.2.m2.4.4.2.2.2.3.3.cmml"><mi id="A2.SS1.p2.2.m2.4.4.2.2.2.3.3.4" xref="A2.SS1.p2.2.m2.4.4.2.2.2.3.3.4.cmml">R</mi><mo id="A2.SS1.p2.2.m2.4.4.2.2.2.3.3.3" xref="A2.SS1.p2.2.m2.4.4.2.2.2.3.3.3.cmml">⁢</mo><mrow id="A2.SS1.p2.2.m2.4.4.2.2.2.3.3.2.2" xref="A2.SS1.p2.2.m2.4.4.2.2.2.3.3.2.3.cmml"><mo id="A2.SS1.p2.2.m2.4.4.2.2.2.3.3.2.2.3" stretchy="false" xref="A2.SS1.p2.2.m2.4.4.2.2.2.3.3.2.3.cmml">(</mo><msub id="A2.SS1.p2.2.m2.4.4.2.2.2.3.3.1.1.1" xref="A2.SS1.p2.2.m2.4.4.2.2.2.3.3.1.1.1.cmml"><mi id="A2.SS1.p2.2.m2.4.4.2.2.2.3.3.1.1.1.2" xref="A2.SS1.p2.2.m2.4.4.2.2.2.3.3.1.1.1.2.cmml">s</mi><mi id="A2.SS1.p2.2.m2.4.4.2.2.2.3.3.1.1.1.3" xref="A2.SS1.p2.2.m2.4.4.2.2.2.3.3.1.1.1.3.cmml">t</mi></msub><mo id="A2.SS1.p2.2.m2.4.4.2.2.2.3.3.2.2.4" xref="A2.SS1.p2.2.m2.4.4.2.2.2.3.3.2.3.cmml">,</mo><msub id="A2.SS1.p2.2.m2.4.4.2.2.2.3.3.2.2.2" xref="A2.SS1.p2.2.m2.4.4.2.2.2.3.3.2.2.2.cmml"><mi id="A2.SS1.p2.2.m2.4.4.2.2.2.3.3.2.2.2.2" xref="A2.SS1.p2.2.m2.4.4.2.2.2.3.3.2.2.2.2.cmml">a</mi><mi id="A2.SS1.p2.2.m2.4.4.2.2.2.3.3.2.2.2.3" xref="A2.SS1.p2.2.m2.4.4.2.2.2.3.3.2.2.2.3.cmml">t</mi></msub><mo id="A2.SS1.p2.2.m2.4.4.2.2.2.3.3.2.2.5" stretchy="false" xref="A2.SS1.p2.2.m2.4.4.2.2.2.3.3.2.3.cmml">)</mo></mrow></mrow><mo id="A2.SS1.p2.2.m2.4.4.2.2.2.3.7" stretchy="false" xref="A2.SS1.p2.2.m2.4.4.2.2.2.4.cmml">)</mo></mrow><mo id="A2.SS1.p2.2.m2.4.4.2.2.5" xref="A2.SS1.p2.2.m2.4.4.2.3.cmml">,</mo><mi id="A2.SS1.p2.2.m2.2.2" mathvariant="normal" xref="A2.SS1.p2.2.m2.2.2.cmml">⋯</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p2.2.m2.4b"><apply id="A2.SS1.p2.2.m2.4.4.cmml" xref="A2.SS1.p2.2.m2.4.4"><eq id="A2.SS1.p2.2.m2.4.4.3.cmml" xref="A2.SS1.p2.2.m2.4.4.3"></eq><ci id="A2.SS1.p2.2.m2.4.4.4.cmml" xref="A2.SS1.p2.2.m2.4.4.4">𝜏</ci><list id="A2.SS1.p2.2.m2.4.4.2.3.cmml" xref="A2.SS1.p2.2.m2.4.4.2.2"><vector id="A2.SS1.p2.2.m2.3.3.1.1.1.4.cmml" xref="A2.SS1.p2.2.m2.3.3.1.1.1.3"><apply id="A2.SS1.p2.2.m2.3.3.1.1.1.1.1.cmml" xref="A2.SS1.p2.2.m2.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.SS1.p2.2.m2.3.3.1.1.1.1.1.1.cmml" xref="A2.SS1.p2.2.m2.3.3.1.1.1.1.1">subscript</csymbol><ci id="A2.SS1.p2.2.m2.3.3.1.1.1.1.1.2.cmml" xref="A2.SS1.p2.2.m2.3.3.1.1.1.1.1.2">𝑠</ci><cn id="A2.SS1.p2.2.m2.3.3.1.1.1.1.1.3.cmml" type="integer" xref="A2.SS1.p2.2.m2.3.3.1.1.1.1.1.3">0</cn></apply><apply id="A2.SS1.p2.2.m2.3.3.1.1.1.2.2.cmml" xref="A2.SS1.p2.2.m2.3.3.1.1.1.2.2"><csymbol cd="ambiguous" id="A2.SS1.p2.2.m2.3.3.1.1.1.2.2.1.cmml" xref="A2.SS1.p2.2.m2.3.3.1.1.1.2.2">subscript</csymbol><ci id="A2.SS1.p2.2.m2.3.3.1.1.1.2.2.2.cmml" xref="A2.SS1.p2.2.m2.3.3.1.1.1.2.2.2">𝑎</ci><cn id="A2.SS1.p2.2.m2.3.3.1.1.1.2.2.3.cmml" type="integer" xref="A2.SS1.p2.2.m2.3.3.1.1.1.2.2.3">0</cn></apply><apply id="A2.SS1.p2.2.m2.3.3.1.1.1.3.3.cmml" xref="A2.SS1.p2.2.m2.3.3.1.1.1.3.3"><times id="A2.SS1.p2.2.m2.3.3.1.1.1.3.3.3.cmml" xref="A2.SS1.p2.2.m2.3.3.1.1.1.3.3.3"></times><ci id="A2.SS1.p2.2.m2.3.3.1.1.1.3.3.4.cmml" xref="A2.SS1.p2.2.m2.3.3.1.1.1.3.3.4">𝑅</ci><interval closure="open" id="A2.SS1.p2.2.m2.3.3.1.1.1.3.3.2.3.cmml" xref="A2.SS1.p2.2.m2.3.3.1.1.1.3.3.2.2"><apply id="A2.SS1.p2.2.m2.3.3.1.1.1.3.3.1.1.1.cmml" xref="A2.SS1.p2.2.m2.3.3.1.1.1.3.3.1.1.1"><csymbol cd="ambiguous" id="A2.SS1.p2.2.m2.3.3.1.1.1.3.3.1.1.1.1.cmml" xref="A2.SS1.p2.2.m2.3.3.1.1.1.3.3.1.1.1">subscript</csymbol><ci id="A2.SS1.p2.2.m2.3.3.1.1.1.3.3.1.1.1.2.cmml" xref="A2.SS1.p2.2.m2.3.3.1.1.1.3.3.1.1.1.2">𝑠</ci><cn id="A2.SS1.p2.2.m2.3.3.1.1.1.3.3.1.1.1.3.cmml" type="integer" xref="A2.SS1.p2.2.m2.3.3.1.1.1.3.3.1.1.1.3">0</cn></apply><apply id="A2.SS1.p2.2.m2.3.3.1.1.1.3.3.2.2.2.cmml" xref="A2.SS1.p2.2.m2.3.3.1.1.1.3.3.2.2.2"><csymbol cd="ambiguous" id="A2.SS1.p2.2.m2.3.3.1.1.1.3.3.2.2.2.1.cmml" xref="A2.SS1.p2.2.m2.3.3.1.1.1.3.3.2.2.2">subscript</csymbol><ci id="A2.SS1.p2.2.m2.3.3.1.1.1.3.3.2.2.2.2.cmml" xref="A2.SS1.p2.2.m2.3.3.1.1.1.3.3.2.2.2.2">𝑎</ci><cn id="A2.SS1.p2.2.m2.3.3.1.1.1.3.3.2.2.2.3.cmml" type="integer" xref="A2.SS1.p2.2.m2.3.3.1.1.1.3.3.2.2.2.3">0</cn></apply></interval></apply></vector><ci id="A2.SS1.p2.2.m2.1.1.cmml" xref="A2.SS1.p2.2.m2.1.1">⋯</ci><vector id="A2.SS1.p2.2.m2.4.4.2.2.2.4.cmml" xref="A2.SS1.p2.2.m2.4.4.2.2.2.3"><apply id="A2.SS1.p2.2.m2.4.4.2.2.2.1.1.cmml" xref="A2.SS1.p2.2.m2.4.4.2.2.2.1.1"><csymbol cd="ambiguous" id="A2.SS1.p2.2.m2.4.4.2.2.2.1.1.1.cmml" xref="A2.SS1.p2.2.m2.4.4.2.2.2.1.1">subscript</csymbol><ci id="A2.SS1.p2.2.m2.4.4.2.2.2.1.1.2.cmml" xref="A2.SS1.p2.2.m2.4.4.2.2.2.1.1.2">𝑠</ci><ci id="A2.SS1.p2.2.m2.4.4.2.2.2.1.1.3.cmml" xref="A2.SS1.p2.2.m2.4.4.2.2.2.1.1.3">𝑡</ci></apply><apply id="A2.SS1.p2.2.m2.4.4.2.2.2.2.2.cmml" xref="A2.SS1.p2.2.m2.4.4.2.2.2.2.2"><csymbol cd="ambiguous" id="A2.SS1.p2.2.m2.4.4.2.2.2.2.2.1.cmml" xref="A2.SS1.p2.2.m2.4.4.2.2.2.2.2">subscript</csymbol><ci id="A2.SS1.p2.2.m2.4.4.2.2.2.2.2.2.cmml" xref="A2.SS1.p2.2.m2.4.4.2.2.2.2.2.2">𝑎</ci><ci id="A2.SS1.p2.2.m2.4.4.2.2.2.2.2.3.cmml" xref="A2.SS1.p2.2.m2.4.4.2.2.2.2.2.3">𝑡</ci></apply><apply id="A2.SS1.p2.2.m2.4.4.2.2.2.3.3.cmml" xref="A2.SS1.p2.2.m2.4.4.2.2.2.3.3"><times id="A2.SS1.p2.2.m2.4.4.2.2.2.3.3.3.cmml" xref="A2.SS1.p2.2.m2.4.4.2.2.2.3.3.3"></times><ci id="A2.SS1.p2.2.m2.4.4.2.2.2.3.3.4.cmml" xref="A2.SS1.p2.2.m2.4.4.2.2.2.3.3.4">𝑅</ci><interval closure="open" id="A2.SS1.p2.2.m2.4.4.2.2.2.3.3.2.3.cmml" xref="A2.SS1.p2.2.m2.4.4.2.2.2.3.3.2.2"><apply id="A2.SS1.p2.2.m2.4.4.2.2.2.3.3.1.1.1.cmml" xref="A2.SS1.p2.2.m2.4.4.2.2.2.3.3.1.1.1"><csymbol cd="ambiguous" id="A2.SS1.p2.2.m2.4.4.2.2.2.3.3.1.1.1.1.cmml" xref="A2.SS1.p2.2.m2.4.4.2.2.2.3.3.1.1.1">subscript</csymbol><ci id="A2.SS1.p2.2.m2.4.4.2.2.2.3.3.1.1.1.2.cmml" xref="A2.SS1.p2.2.m2.4.4.2.2.2.3.3.1.1.1.2">𝑠</ci><ci id="A2.SS1.p2.2.m2.4.4.2.2.2.3.3.1.1.1.3.cmml" xref="A2.SS1.p2.2.m2.4.4.2.2.2.3.3.1.1.1.3">𝑡</ci></apply><apply id="A2.SS1.p2.2.m2.4.4.2.2.2.3.3.2.2.2.cmml" xref="A2.SS1.p2.2.m2.4.4.2.2.2.3.3.2.2.2"><csymbol cd="ambiguous" id="A2.SS1.p2.2.m2.4.4.2.2.2.3.3.2.2.2.1.cmml" xref="A2.SS1.p2.2.m2.4.4.2.2.2.3.3.2.2.2">subscript</csymbol><ci id="A2.SS1.p2.2.m2.4.4.2.2.2.3.3.2.2.2.2.cmml" xref="A2.SS1.p2.2.m2.4.4.2.2.2.3.3.2.2.2.2">𝑎</ci><ci id="A2.SS1.p2.2.m2.4.4.2.2.2.3.3.2.2.2.3.cmml" xref="A2.SS1.p2.2.m2.4.4.2.2.2.3.3.2.2.2.3">𝑡</ci></apply></interval></apply></vector><ci id="A2.SS1.p2.2.m2.2.2.cmml" xref="A2.SS1.p2.2.m2.2.2">⋯</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p2.2.m2.4c">\tau=(s_{0},a_{0},R(s_{0},a_{0})),\cdots,(s_{t},a_{t},R(s_{t},a_{t})),\cdots</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p2.2.m2.4d">italic_τ = ( italic_s start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_R ( italic_s start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) ) , ⋯ , ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_R ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ) , ⋯</annotation></semantics></math>. The value of a particular state-action pair under policy <math alttext="\pi" class="ltx_Math" display="inline" id="A2.SS1.p2.3.m3.1"><semantics id="A2.SS1.p2.3.m3.1a"><mi id="A2.SS1.p2.3.m3.1.1" xref="A2.SS1.p2.3.m3.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p2.3.m3.1b"><ci id="A2.SS1.p2.3.m3.1.1.cmml" xref="A2.SS1.p2.3.m3.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p2.3.m3.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p2.3.m3.1d">italic_π</annotation></semantics></math>, denoted as the state-action value function <math alttext="Q^{\pi}(s_{t},a_{t})" class="ltx_Math" display="inline" id="A2.SS1.p2.4.m4.2"><semantics id="A2.SS1.p2.4.m4.2a"><mrow id="A2.SS1.p2.4.m4.2.2" xref="A2.SS1.p2.4.m4.2.2.cmml"><msup id="A2.SS1.p2.4.m4.2.2.4" xref="A2.SS1.p2.4.m4.2.2.4.cmml"><mi id="A2.SS1.p2.4.m4.2.2.4.2" xref="A2.SS1.p2.4.m4.2.2.4.2.cmml">Q</mi><mi id="A2.SS1.p2.4.m4.2.2.4.3" xref="A2.SS1.p2.4.m4.2.2.4.3.cmml">π</mi></msup><mo id="A2.SS1.p2.4.m4.2.2.3" xref="A2.SS1.p2.4.m4.2.2.3.cmml">⁢</mo><mrow id="A2.SS1.p2.4.m4.2.2.2.2" xref="A2.SS1.p2.4.m4.2.2.2.3.cmml"><mo id="A2.SS1.p2.4.m4.2.2.2.2.3" stretchy="false" xref="A2.SS1.p2.4.m4.2.2.2.3.cmml">(</mo><msub id="A2.SS1.p2.4.m4.1.1.1.1.1" xref="A2.SS1.p2.4.m4.1.1.1.1.1.cmml"><mi id="A2.SS1.p2.4.m4.1.1.1.1.1.2" xref="A2.SS1.p2.4.m4.1.1.1.1.1.2.cmml">s</mi><mi id="A2.SS1.p2.4.m4.1.1.1.1.1.3" xref="A2.SS1.p2.4.m4.1.1.1.1.1.3.cmml">t</mi></msub><mo id="A2.SS1.p2.4.m4.2.2.2.2.4" xref="A2.SS1.p2.4.m4.2.2.2.3.cmml">,</mo><msub id="A2.SS1.p2.4.m4.2.2.2.2.2" xref="A2.SS1.p2.4.m4.2.2.2.2.2.cmml"><mi id="A2.SS1.p2.4.m4.2.2.2.2.2.2" xref="A2.SS1.p2.4.m4.2.2.2.2.2.2.cmml">a</mi><mi id="A2.SS1.p2.4.m4.2.2.2.2.2.3" xref="A2.SS1.p2.4.m4.2.2.2.2.2.3.cmml">t</mi></msub><mo id="A2.SS1.p2.4.m4.2.2.2.2.5" stretchy="false" xref="A2.SS1.p2.4.m4.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p2.4.m4.2b"><apply id="A2.SS1.p2.4.m4.2.2.cmml" xref="A2.SS1.p2.4.m4.2.2"><times id="A2.SS1.p2.4.m4.2.2.3.cmml" xref="A2.SS1.p2.4.m4.2.2.3"></times><apply id="A2.SS1.p2.4.m4.2.2.4.cmml" xref="A2.SS1.p2.4.m4.2.2.4"><csymbol cd="ambiguous" id="A2.SS1.p2.4.m4.2.2.4.1.cmml" xref="A2.SS1.p2.4.m4.2.2.4">superscript</csymbol><ci id="A2.SS1.p2.4.m4.2.2.4.2.cmml" xref="A2.SS1.p2.4.m4.2.2.4.2">𝑄</ci><ci id="A2.SS1.p2.4.m4.2.2.4.3.cmml" xref="A2.SS1.p2.4.m4.2.2.4.3">𝜋</ci></apply><interval closure="open" id="A2.SS1.p2.4.m4.2.2.2.3.cmml" xref="A2.SS1.p2.4.m4.2.2.2.2"><apply id="A2.SS1.p2.4.m4.1.1.1.1.1.cmml" xref="A2.SS1.p2.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.SS1.p2.4.m4.1.1.1.1.1.1.cmml" xref="A2.SS1.p2.4.m4.1.1.1.1.1">subscript</csymbol><ci id="A2.SS1.p2.4.m4.1.1.1.1.1.2.cmml" xref="A2.SS1.p2.4.m4.1.1.1.1.1.2">𝑠</ci><ci id="A2.SS1.p2.4.m4.1.1.1.1.1.3.cmml" xref="A2.SS1.p2.4.m4.1.1.1.1.1.3">𝑡</ci></apply><apply id="A2.SS1.p2.4.m4.2.2.2.2.2.cmml" xref="A2.SS1.p2.4.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="A2.SS1.p2.4.m4.2.2.2.2.2.1.cmml" xref="A2.SS1.p2.4.m4.2.2.2.2.2">subscript</csymbol><ci id="A2.SS1.p2.4.m4.2.2.2.2.2.2.cmml" xref="A2.SS1.p2.4.m4.2.2.2.2.2.2">𝑎</ci><ci id="A2.SS1.p2.4.m4.2.2.2.2.2.3.cmml" xref="A2.SS1.p2.4.m4.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p2.4.m4.2c">Q^{\pi}(s_{t},a_{t})</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p2.4.m4.2d">italic_Q start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>, is calculated as follows:</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS1.p3">
<table class="ltx_equation ltx_eqn_table" id="A2.Ex2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="Q^{\pi}(s_{t},a_{t})=\mathbb{E}_{\tau\sim\pi}\left[\sum_{i=0}^{\infty}\gamma^{%
i}R(s_{t+i},a_{t+i})\mid s_{t},a_{t}\right]." class="ltx_Math" display="block" id="A2.Ex2.m1.1"><semantics id="A2.Ex2.m1.1a"><mrow id="A2.Ex2.m1.1.1.1" xref="A2.Ex2.m1.1.1.1.1.cmml"><mrow id="A2.Ex2.m1.1.1.1.1" xref="A2.Ex2.m1.1.1.1.1.cmml"><mrow id="A2.Ex2.m1.1.1.1.1.2" xref="A2.Ex2.m1.1.1.1.1.2.cmml"><msup id="A2.Ex2.m1.1.1.1.1.2.4" xref="A2.Ex2.m1.1.1.1.1.2.4.cmml"><mi id="A2.Ex2.m1.1.1.1.1.2.4.2" xref="A2.Ex2.m1.1.1.1.1.2.4.2.cmml">Q</mi><mi id="A2.Ex2.m1.1.1.1.1.2.4.3" xref="A2.Ex2.m1.1.1.1.1.2.4.3.cmml">π</mi></msup><mo id="A2.Ex2.m1.1.1.1.1.2.3" xref="A2.Ex2.m1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="A2.Ex2.m1.1.1.1.1.2.2.2" xref="A2.Ex2.m1.1.1.1.1.2.2.3.cmml"><mo id="A2.Ex2.m1.1.1.1.1.2.2.2.3" stretchy="false" xref="A2.Ex2.m1.1.1.1.1.2.2.3.cmml">(</mo><msub id="A2.Ex2.m1.1.1.1.1.1.1.1.1" xref="A2.Ex2.m1.1.1.1.1.1.1.1.1.cmml"><mi id="A2.Ex2.m1.1.1.1.1.1.1.1.1.2" xref="A2.Ex2.m1.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="A2.Ex2.m1.1.1.1.1.1.1.1.1.3" xref="A2.Ex2.m1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="A2.Ex2.m1.1.1.1.1.2.2.2.4" xref="A2.Ex2.m1.1.1.1.1.2.2.3.cmml">,</mo><msub id="A2.Ex2.m1.1.1.1.1.2.2.2.2" xref="A2.Ex2.m1.1.1.1.1.2.2.2.2.cmml"><mi id="A2.Ex2.m1.1.1.1.1.2.2.2.2.2" xref="A2.Ex2.m1.1.1.1.1.2.2.2.2.2.cmml">a</mi><mi id="A2.Ex2.m1.1.1.1.1.2.2.2.2.3" xref="A2.Ex2.m1.1.1.1.1.2.2.2.2.3.cmml">t</mi></msub><mo id="A2.Ex2.m1.1.1.1.1.2.2.2.5" stretchy="false" xref="A2.Ex2.m1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="A2.Ex2.m1.1.1.1.1.4" xref="A2.Ex2.m1.1.1.1.1.4.cmml">=</mo><mrow id="A2.Ex2.m1.1.1.1.1.3" xref="A2.Ex2.m1.1.1.1.1.3.cmml"><msub id="A2.Ex2.m1.1.1.1.1.3.3" xref="A2.Ex2.m1.1.1.1.1.3.3.cmml"><mi id="A2.Ex2.m1.1.1.1.1.3.3.2" xref="A2.Ex2.m1.1.1.1.1.3.3.2.cmml">𝔼</mi><mrow id="A2.Ex2.m1.1.1.1.1.3.3.3" xref="A2.Ex2.m1.1.1.1.1.3.3.3.cmml"><mi id="A2.Ex2.m1.1.1.1.1.3.3.3.2" xref="A2.Ex2.m1.1.1.1.1.3.3.3.2.cmml">τ</mi><mo id="A2.Ex2.m1.1.1.1.1.3.3.3.1" xref="A2.Ex2.m1.1.1.1.1.3.3.3.1.cmml">∼</mo><mi id="A2.Ex2.m1.1.1.1.1.3.3.3.3" xref="A2.Ex2.m1.1.1.1.1.3.3.3.3.cmml">π</mi></mrow></msub><mo id="A2.Ex2.m1.1.1.1.1.3.2" xref="A2.Ex2.m1.1.1.1.1.3.2.cmml">⁢</mo><mrow id="A2.Ex2.m1.1.1.1.1.3.1.1" xref="A2.Ex2.m1.1.1.1.1.3.1.2.cmml"><mo id="A2.Ex2.m1.1.1.1.1.3.1.1.2" xref="A2.Ex2.m1.1.1.1.1.3.1.2.1.cmml">[</mo><mrow id="A2.Ex2.m1.1.1.1.1.3.1.1.1" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.cmml"><mrow id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.cmml"><munderover id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.3" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.3.cmml"><mo id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.3.2.2" lspace="0em" movablelimits="false" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.3.2.2.cmml">∑</mo><mrow id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.3.2.3" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.3.2.3.cmml"><mi id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.3.2.3.2" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.3.2.3.2.cmml">i</mi><mo id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.3.2.3.1" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.3.2.3.1.cmml">=</mo><mn id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.3.2.3.3" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.3.2.3.3.cmml">0</mn></mrow><mi id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.3.3" mathvariant="normal" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.3.3.cmml">∞</mi></munderover><mrow id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.cmml"><msup id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.4" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.4.cmml"><mi id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.4.2" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.4.2.cmml">γ</mi><mi id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.4.3" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.4.3.cmml">i</mi></msup><mo id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.3" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.3.cmml">⁢</mo><mi id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.5" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.5.cmml">R</mi><mo id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.3a" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.3.cmml">⁢</mo><mrow id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.2.2" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.2.3.cmml"><mo id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.2.2.3" stretchy="false" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.2.3.cmml">(</mo><msub id="A2.Ex2.m1.1.1.1.1.3.1.1.1.1.1.1.1.1" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.cmml"><mi id="A2.Ex2.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.2" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.2.cmml">s</mi><mrow id="A2.Ex2.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.3" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.3.cmml"><mi id="A2.Ex2.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.3.2" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="A2.Ex2.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.3.1" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.3.1.cmml">+</mo><mi id="A2.Ex2.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.3.3" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></mrow></msub><mo id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.2.2.4" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.2.3.cmml">,</mo><msub id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.2.2.2" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.2.2.2.cmml"><mi id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.2.2.2.2" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.2.2.2.2.cmml">a</mi><mrow id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.2.2.2.3" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.2.2.2.3.cmml"><mi id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.2.2.2.3.2" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.2.2.2.3.2.cmml">t</mi><mo id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.2.2.2.3.1" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.2.2.2.3.1.cmml">+</mo><mi id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.2.2.2.3.3" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.2.2.2.3.3.cmml">i</mi></mrow></msub><mo id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.2.2.5" stretchy="false" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="A2.Ex2.m1.1.1.1.1.3.1.1.1.5" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.5.cmml">∣</mo><mrow id="A2.Ex2.m1.1.1.1.1.3.1.1.1.4.2" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.4.3.cmml"><msub id="A2.Ex2.m1.1.1.1.1.3.1.1.1.3.1.1" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.3.1.1.cmml"><mi id="A2.Ex2.m1.1.1.1.1.3.1.1.1.3.1.1.2" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.3.1.1.2.cmml">s</mi><mi id="A2.Ex2.m1.1.1.1.1.3.1.1.1.3.1.1.3" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.3.1.1.3.cmml">t</mi></msub><mo id="A2.Ex2.m1.1.1.1.1.3.1.1.1.4.2.3" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.4.3.cmml">,</mo><msub id="A2.Ex2.m1.1.1.1.1.3.1.1.1.4.2.2" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.4.2.2.cmml"><mi id="A2.Ex2.m1.1.1.1.1.3.1.1.1.4.2.2.2" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.4.2.2.2.cmml">a</mi><mi id="A2.Ex2.m1.1.1.1.1.3.1.1.1.4.2.2.3" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.4.2.2.3.cmml">t</mi></msub></mrow></mrow><mo id="A2.Ex2.m1.1.1.1.1.3.1.1.3" xref="A2.Ex2.m1.1.1.1.1.3.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="A2.Ex2.m1.1.1.1.2" lspace="0em" xref="A2.Ex2.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.Ex2.m1.1b"><apply id="A2.Ex2.m1.1.1.1.1.cmml" xref="A2.Ex2.m1.1.1.1"><eq id="A2.Ex2.m1.1.1.1.1.4.cmml" xref="A2.Ex2.m1.1.1.1.1.4"></eq><apply id="A2.Ex2.m1.1.1.1.1.2.cmml" xref="A2.Ex2.m1.1.1.1.1.2"><times id="A2.Ex2.m1.1.1.1.1.2.3.cmml" xref="A2.Ex2.m1.1.1.1.1.2.3"></times><apply id="A2.Ex2.m1.1.1.1.1.2.4.cmml" xref="A2.Ex2.m1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="A2.Ex2.m1.1.1.1.1.2.4.1.cmml" xref="A2.Ex2.m1.1.1.1.1.2.4">superscript</csymbol><ci id="A2.Ex2.m1.1.1.1.1.2.4.2.cmml" xref="A2.Ex2.m1.1.1.1.1.2.4.2">𝑄</ci><ci id="A2.Ex2.m1.1.1.1.1.2.4.3.cmml" xref="A2.Ex2.m1.1.1.1.1.2.4.3">𝜋</ci></apply><interval closure="open" id="A2.Ex2.m1.1.1.1.1.2.2.3.cmml" xref="A2.Ex2.m1.1.1.1.1.2.2.2"><apply id="A2.Ex2.m1.1.1.1.1.1.1.1.1.cmml" xref="A2.Ex2.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.Ex2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.Ex2.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A2.Ex2.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A2.Ex2.m1.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="A2.Ex2.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A2.Ex2.m1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="A2.Ex2.m1.1.1.1.1.2.2.2.2.cmml" xref="A2.Ex2.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="A2.Ex2.m1.1.1.1.1.2.2.2.2.1.cmml" xref="A2.Ex2.m1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="A2.Ex2.m1.1.1.1.1.2.2.2.2.2.cmml" xref="A2.Ex2.m1.1.1.1.1.2.2.2.2.2">𝑎</ci><ci id="A2.Ex2.m1.1.1.1.1.2.2.2.2.3.cmml" xref="A2.Ex2.m1.1.1.1.1.2.2.2.2.3">𝑡</ci></apply></interval></apply><apply id="A2.Ex2.m1.1.1.1.1.3.cmml" xref="A2.Ex2.m1.1.1.1.1.3"><times id="A2.Ex2.m1.1.1.1.1.3.2.cmml" xref="A2.Ex2.m1.1.1.1.1.3.2"></times><apply id="A2.Ex2.m1.1.1.1.1.3.3.cmml" xref="A2.Ex2.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A2.Ex2.m1.1.1.1.1.3.3.1.cmml" xref="A2.Ex2.m1.1.1.1.1.3.3">subscript</csymbol><ci id="A2.Ex2.m1.1.1.1.1.3.3.2.cmml" xref="A2.Ex2.m1.1.1.1.1.3.3.2">𝔼</ci><apply id="A2.Ex2.m1.1.1.1.1.3.3.3.cmml" xref="A2.Ex2.m1.1.1.1.1.3.3.3"><csymbol cd="latexml" id="A2.Ex2.m1.1.1.1.1.3.3.3.1.cmml" xref="A2.Ex2.m1.1.1.1.1.3.3.3.1">similar-to</csymbol><ci id="A2.Ex2.m1.1.1.1.1.3.3.3.2.cmml" xref="A2.Ex2.m1.1.1.1.1.3.3.3.2">𝜏</ci><ci id="A2.Ex2.m1.1.1.1.1.3.3.3.3.cmml" xref="A2.Ex2.m1.1.1.1.1.3.3.3.3">𝜋</ci></apply></apply><apply id="A2.Ex2.m1.1.1.1.1.3.1.2.cmml" xref="A2.Ex2.m1.1.1.1.1.3.1.1"><csymbol cd="latexml" id="A2.Ex2.m1.1.1.1.1.3.1.2.1.cmml" xref="A2.Ex2.m1.1.1.1.1.3.1.1.2">delimited-[]</csymbol><apply id="A2.Ex2.m1.1.1.1.1.3.1.1.1.cmml" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1"><csymbol cd="latexml" id="A2.Ex2.m1.1.1.1.1.3.1.1.1.5.cmml" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.5">conditional</csymbol><apply id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.cmml" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2"><apply id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.3.cmml" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.3"><csymbol cd="ambiguous" id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.3.1.cmml" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.3">superscript</csymbol><apply id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.3.2.cmml" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.3"><csymbol cd="ambiguous" id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.3.2.1.cmml" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.3">subscript</csymbol><sum id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.3.2.2.cmml" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.3.2.2"></sum><apply id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.3.2.3.cmml" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.3.2.3"><eq id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.3.2.3.1.cmml" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.3.2.3.1"></eq><ci id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.3.2.3.2.cmml" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.3.2.3.2">𝑖</ci><cn id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.3.2.3.3.cmml" type="integer" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.3.2.3.3">0</cn></apply></apply><infinity id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.3.3.cmml" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.3.3"></infinity></apply><apply id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.cmml" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2"><times id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.3.cmml" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.3"></times><apply id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.4.cmml" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.4"><csymbol cd="ambiguous" id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.4.1.cmml" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.4">superscript</csymbol><ci id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.4.2.cmml" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.4.2">𝛾</ci><ci id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.4.3.cmml" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.4.3">𝑖</ci></apply><ci id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.5.cmml" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.5">𝑅</ci><interval closure="open" id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.2.3.cmml" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.2.2"><apply id="A2.Ex2.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.cmml" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.Ex2.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.1.cmml" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A2.Ex2.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.2.cmml" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.2">𝑠</ci><apply id="A2.Ex2.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.3.cmml" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.3"><plus id="A2.Ex2.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.3.1.cmml" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.3.1"></plus><ci id="A2.Ex2.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.3.2.cmml" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.3.2">𝑡</ci><ci id="A2.Ex2.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.3.3.cmml" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply><apply id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.2.2.2.cmml" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.2.2.2.1.cmml" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.2.2.2">subscript</csymbol><ci id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.2.2.2.2.cmml" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.2.2.2.2">𝑎</ci><apply id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.2.2.2.3.cmml" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.2.2.2.3"><plus id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.2.2.2.3.1.cmml" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.2.2.2.3.1"></plus><ci id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.2.2.2.3.2.cmml" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.2.2.2.3.2">𝑡</ci><ci id="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.2.2.2.3.3.cmml" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.2.2.2.2.2.3.3">𝑖</ci></apply></apply></interval></apply></apply><list id="A2.Ex2.m1.1.1.1.1.3.1.1.1.4.3.cmml" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.4.2"><apply id="A2.Ex2.m1.1.1.1.1.3.1.1.1.3.1.1.cmml" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.3.1.1"><csymbol cd="ambiguous" id="A2.Ex2.m1.1.1.1.1.3.1.1.1.3.1.1.1.cmml" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.3.1.1">subscript</csymbol><ci id="A2.Ex2.m1.1.1.1.1.3.1.1.1.3.1.1.2.cmml" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.3.1.1.2">𝑠</ci><ci id="A2.Ex2.m1.1.1.1.1.3.1.1.1.3.1.1.3.cmml" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.3.1.1.3">𝑡</ci></apply><apply id="A2.Ex2.m1.1.1.1.1.3.1.1.1.4.2.2.cmml" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.4.2.2"><csymbol cd="ambiguous" id="A2.Ex2.m1.1.1.1.1.3.1.1.1.4.2.2.1.cmml" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.4.2.2">subscript</csymbol><ci id="A2.Ex2.m1.1.1.1.1.3.1.1.1.4.2.2.2.cmml" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.4.2.2.2">𝑎</ci><ci id="A2.Ex2.m1.1.1.1.1.3.1.1.1.4.2.2.3.cmml" xref="A2.Ex2.m1.1.1.1.1.3.1.1.1.4.2.2.3">𝑡</ci></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.Ex2.m1.1c">Q^{\pi}(s_{t},a_{t})=\mathbb{E}_{\tau\sim\pi}\left[\sum_{i=0}^{\infty}\gamma^{%
i}R(s_{t+i},a_{t+i})\mid s_{t},a_{t}\right].</annotation><annotation encoding="application/x-llamapun" id="A2.Ex2.m1.1d">italic_Q start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) = blackboard_E start_POSTSUBSCRIPT italic_τ ∼ italic_π end_POSTSUBSCRIPT [ ∑ start_POSTSUBSCRIPT italic_i = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT italic_γ start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT italic_R ( italic_s start_POSTSUBSCRIPT italic_t + italic_i end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t + italic_i end_POSTSUBSCRIPT ) ∣ italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS1.p4">
<p class="ltx_p" id="A2.SS1.p4.1">The agent’s behavior is defined by a policy, which is a probability distribution over actions given states. The policy <math alttext="\pi(a_{i}\mid s)" class="ltx_Math" display="inline" id="A2.SS1.p4.1.m1.1"><semantics id="A2.SS1.p4.1.m1.1a"><mrow id="A2.SS1.p4.1.m1.1.1" xref="A2.SS1.p4.1.m1.1.1.cmml"><mi id="A2.SS1.p4.1.m1.1.1.3" xref="A2.SS1.p4.1.m1.1.1.3.cmml">π</mi><mo id="A2.SS1.p4.1.m1.1.1.2" xref="A2.SS1.p4.1.m1.1.1.2.cmml">⁢</mo><mrow id="A2.SS1.p4.1.m1.1.1.1.1" xref="A2.SS1.p4.1.m1.1.1.1.1.1.cmml"><mo id="A2.SS1.p4.1.m1.1.1.1.1.2" stretchy="false" xref="A2.SS1.p4.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="A2.SS1.p4.1.m1.1.1.1.1.1" xref="A2.SS1.p4.1.m1.1.1.1.1.1.cmml"><msub id="A2.SS1.p4.1.m1.1.1.1.1.1.2" xref="A2.SS1.p4.1.m1.1.1.1.1.1.2.cmml"><mi id="A2.SS1.p4.1.m1.1.1.1.1.1.2.2" xref="A2.SS1.p4.1.m1.1.1.1.1.1.2.2.cmml">a</mi><mi id="A2.SS1.p4.1.m1.1.1.1.1.1.2.3" xref="A2.SS1.p4.1.m1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="A2.SS1.p4.1.m1.1.1.1.1.1.1" xref="A2.SS1.p4.1.m1.1.1.1.1.1.1.cmml">∣</mo><mi id="A2.SS1.p4.1.m1.1.1.1.1.1.3" xref="A2.SS1.p4.1.m1.1.1.1.1.1.3.cmml">s</mi></mrow><mo id="A2.SS1.p4.1.m1.1.1.1.1.3" stretchy="false" xref="A2.SS1.p4.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p4.1.m1.1b"><apply id="A2.SS1.p4.1.m1.1.1.cmml" xref="A2.SS1.p4.1.m1.1.1"><times id="A2.SS1.p4.1.m1.1.1.2.cmml" xref="A2.SS1.p4.1.m1.1.1.2"></times><ci id="A2.SS1.p4.1.m1.1.1.3.cmml" xref="A2.SS1.p4.1.m1.1.1.3">𝜋</ci><apply id="A2.SS1.p4.1.m1.1.1.1.1.1.cmml" xref="A2.SS1.p4.1.m1.1.1.1.1"><csymbol cd="latexml" id="A2.SS1.p4.1.m1.1.1.1.1.1.1.cmml" xref="A2.SS1.p4.1.m1.1.1.1.1.1.1">conditional</csymbol><apply id="A2.SS1.p4.1.m1.1.1.1.1.1.2.cmml" xref="A2.SS1.p4.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A2.SS1.p4.1.m1.1.1.1.1.1.2.1.cmml" xref="A2.SS1.p4.1.m1.1.1.1.1.1.2">subscript</csymbol><ci id="A2.SS1.p4.1.m1.1.1.1.1.1.2.2.cmml" xref="A2.SS1.p4.1.m1.1.1.1.1.1.2.2">𝑎</ci><ci id="A2.SS1.p4.1.m1.1.1.1.1.1.2.3.cmml" xref="A2.SS1.p4.1.m1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="A2.SS1.p4.1.m1.1.1.1.1.1.3.cmml" xref="A2.SS1.p4.1.m1.1.1.1.1.1.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p4.1.m1.1c">\pi(a_{i}\mid s)</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p4.1.m1.1d">italic_π ( italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∣ italic_s )</annotation></semantics></math> in this context is derived using a softmax function applied to the state-action value function:</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS1.p5">
<table class="ltx_equation ltx_eqn_table" id="A2.Ex3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\pi(a_{i}\mid s)=\frac{e^{Q(s,a_{i})}}{\sum_{k}e^{Q(s,a_{k})}},\quad i=1,2,%
\cdots,n." class="ltx_Math" display="block" id="A2.Ex3.m1.9"><semantics id="A2.Ex3.m1.9a"><mrow id="A2.Ex3.m1.9.9.1"><mrow id="A2.Ex3.m1.9.9.1.1.2" xref="A2.Ex3.m1.9.9.1.1.3.cmml"><mrow id="A2.Ex3.m1.9.9.1.1.1.1" xref="A2.Ex3.m1.9.9.1.1.1.1.cmml"><mrow id="A2.Ex3.m1.9.9.1.1.1.1.1" xref="A2.Ex3.m1.9.9.1.1.1.1.1.cmml"><mi id="A2.Ex3.m1.9.9.1.1.1.1.1.3" xref="A2.Ex3.m1.9.9.1.1.1.1.1.3.cmml">π</mi><mo id="A2.Ex3.m1.9.9.1.1.1.1.1.2" xref="A2.Ex3.m1.9.9.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A2.Ex3.m1.9.9.1.1.1.1.1.1.1" xref="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.cmml"><mo id="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.2" stretchy="false" xref="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1" xref="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.cmml"><msub id="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.2" xref="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.2.cmml"><mi id="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.2.2" xref="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.2.2.cmml">a</mi><mi id="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.2.3" xref="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.1" xref="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.1.cmml">∣</mo><mi id="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.3" xref="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.3.cmml">s</mi></mrow><mo id="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.3" stretchy="false" xref="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A2.Ex3.m1.9.9.1.1.1.1.2" xref="A2.Ex3.m1.9.9.1.1.1.1.2.cmml">=</mo><mfrac id="A2.Ex3.m1.4.4" xref="A2.Ex3.m1.4.4.cmml"><msup id="A2.Ex3.m1.2.2.2" xref="A2.Ex3.m1.2.2.2.cmml"><mi id="A2.Ex3.m1.2.2.2.4" xref="A2.Ex3.m1.2.2.2.4.cmml">e</mi><mrow id="A2.Ex3.m1.2.2.2.2.2" xref="A2.Ex3.m1.2.2.2.2.2.cmml"><mi id="A2.Ex3.m1.2.2.2.2.2.4" xref="A2.Ex3.m1.2.2.2.2.2.4.cmml">Q</mi><mo id="A2.Ex3.m1.2.2.2.2.2.3" xref="A2.Ex3.m1.2.2.2.2.2.3.cmml">⁢</mo><mrow id="A2.Ex3.m1.2.2.2.2.2.2.1" xref="A2.Ex3.m1.2.2.2.2.2.2.2.cmml"><mo id="A2.Ex3.m1.2.2.2.2.2.2.1.2" stretchy="false" xref="A2.Ex3.m1.2.2.2.2.2.2.2.cmml">(</mo><mi id="A2.Ex3.m1.1.1.1.1.1.1" xref="A2.Ex3.m1.1.1.1.1.1.1.cmml">s</mi><mo id="A2.Ex3.m1.2.2.2.2.2.2.1.3" xref="A2.Ex3.m1.2.2.2.2.2.2.2.cmml">,</mo><msub id="A2.Ex3.m1.2.2.2.2.2.2.1.1" xref="A2.Ex3.m1.2.2.2.2.2.2.1.1.cmml"><mi id="A2.Ex3.m1.2.2.2.2.2.2.1.1.2" xref="A2.Ex3.m1.2.2.2.2.2.2.1.1.2.cmml">a</mi><mi id="A2.Ex3.m1.2.2.2.2.2.2.1.1.3" xref="A2.Ex3.m1.2.2.2.2.2.2.1.1.3.cmml">i</mi></msub><mo id="A2.Ex3.m1.2.2.2.2.2.2.1.4" stretchy="false" xref="A2.Ex3.m1.2.2.2.2.2.2.2.cmml">)</mo></mrow></mrow></msup><mrow id="A2.Ex3.m1.4.4.4" xref="A2.Ex3.m1.4.4.4.cmml"><msub id="A2.Ex3.m1.4.4.4.3" xref="A2.Ex3.m1.4.4.4.3.cmml"><mo id="A2.Ex3.m1.4.4.4.3.2" xref="A2.Ex3.m1.4.4.4.3.2.cmml">∑</mo><mi id="A2.Ex3.m1.4.4.4.3.3" xref="A2.Ex3.m1.4.4.4.3.3.cmml">k</mi></msub><msup id="A2.Ex3.m1.4.4.4.4" xref="A2.Ex3.m1.4.4.4.4.cmml"><mi id="A2.Ex3.m1.4.4.4.4.2" xref="A2.Ex3.m1.4.4.4.4.2.cmml">e</mi><mrow id="A2.Ex3.m1.4.4.4.2.2" xref="A2.Ex3.m1.4.4.4.2.2.cmml"><mi id="A2.Ex3.m1.4.4.4.2.2.4" xref="A2.Ex3.m1.4.4.4.2.2.4.cmml">Q</mi><mo id="A2.Ex3.m1.4.4.4.2.2.3" xref="A2.Ex3.m1.4.4.4.2.2.3.cmml">⁢</mo><mrow id="A2.Ex3.m1.4.4.4.2.2.2.1" xref="A2.Ex3.m1.4.4.4.2.2.2.2.cmml"><mo id="A2.Ex3.m1.4.4.4.2.2.2.1.2" stretchy="false" xref="A2.Ex3.m1.4.4.4.2.2.2.2.cmml">(</mo><mi id="A2.Ex3.m1.3.3.3.1.1.1" xref="A2.Ex3.m1.3.3.3.1.1.1.cmml">s</mi><mo id="A2.Ex3.m1.4.4.4.2.2.2.1.3" xref="A2.Ex3.m1.4.4.4.2.2.2.2.cmml">,</mo><msub id="A2.Ex3.m1.4.4.4.2.2.2.1.1" xref="A2.Ex3.m1.4.4.4.2.2.2.1.1.cmml"><mi id="A2.Ex3.m1.4.4.4.2.2.2.1.1.2" xref="A2.Ex3.m1.4.4.4.2.2.2.1.1.2.cmml">a</mi><mi id="A2.Ex3.m1.4.4.4.2.2.2.1.1.3" xref="A2.Ex3.m1.4.4.4.2.2.2.1.1.3.cmml">k</mi></msub><mo id="A2.Ex3.m1.4.4.4.2.2.2.1.4" stretchy="false" xref="A2.Ex3.m1.4.4.4.2.2.2.2.cmml">)</mo></mrow></mrow></msup></mrow></mfrac></mrow><mo id="A2.Ex3.m1.9.9.1.1.2.3" rspace="1.167em" xref="A2.Ex3.m1.9.9.1.1.3a.cmml">,</mo><mrow id="A2.Ex3.m1.9.9.1.1.2.2" xref="A2.Ex3.m1.9.9.1.1.2.2.cmml"><mi id="A2.Ex3.m1.9.9.1.1.2.2.2" xref="A2.Ex3.m1.9.9.1.1.2.2.2.cmml">i</mi><mo id="A2.Ex3.m1.9.9.1.1.2.2.1" xref="A2.Ex3.m1.9.9.1.1.2.2.1.cmml">=</mo><mrow id="A2.Ex3.m1.9.9.1.1.2.2.3.2" xref="A2.Ex3.m1.9.9.1.1.2.2.3.1.cmml"><mn id="A2.Ex3.m1.5.5" xref="A2.Ex3.m1.5.5.cmml">1</mn><mo id="A2.Ex3.m1.9.9.1.1.2.2.3.2.1" xref="A2.Ex3.m1.9.9.1.1.2.2.3.1.cmml">,</mo><mn id="A2.Ex3.m1.6.6" xref="A2.Ex3.m1.6.6.cmml">2</mn><mo id="A2.Ex3.m1.9.9.1.1.2.2.3.2.2" xref="A2.Ex3.m1.9.9.1.1.2.2.3.1.cmml">,</mo><mi id="A2.Ex3.m1.7.7" mathvariant="normal" xref="A2.Ex3.m1.7.7.cmml">⋯</mi><mo id="A2.Ex3.m1.9.9.1.1.2.2.3.2.3" xref="A2.Ex3.m1.9.9.1.1.2.2.3.1.cmml">,</mo><mi id="A2.Ex3.m1.8.8" xref="A2.Ex3.m1.8.8.cmml">n</mi></mrow></mrow></mrow><mo id="A2.Ex3.m1.9.9.1.2" lspace="0em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.Ex3.m1.9b"><apply id="A2.Ex3.m1.9.9.1.1.3.cmml" xref="A2.Ex3.m1.9.9.1.1.2"><csymbol cd="ambiguous" id="A2.Ex3.m1.9.9.1.1.3a.cmml" xref="A2.Ex3.m1.9.9.1.1.2.3">formulae-sequence</csymbol><apply id="A2.Ex3.m1.9.9.1.1.1.1.cmml" xref="A2.Ex3.m1.9.9.1.1.1.1"><eq id="A2.Ex3.m1.9.9.1.1.1.1.2.cmml" xref="A2.Ex3.m1.9.9.1.1.1.1.2"></eq><apply id="A2.Ex3.m1.9.9.1.1.1.1.1.cmml" xref="A2.Ex3.m1.9.9.1.1.1.1.1"><times id="A2.Ex3.m1.9.9.1.1.1.1.1.2.cmml" xref="A2.Ex3.m1.9.9.1.1.1.1.1.2"></times><ci id="A2.Ex3.m1.9.9.1.1.1.1.1.3.cmml" xref="A2.Ex3.m1.9.9.1.1.1.1.1.3">𝜋</ci><apply id="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.cmml" xref="A2.Ex3.m1.9.9.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.1.cmml" xref="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.2.cmml" xref="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.2.1.cmml" xref="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.2.2.cmml" xref="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.2.2">𝑎</ci><ci id="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.2.3.cmml" xref="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.3.cmml" xref="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.3">𝑠</ci></apply></apply><apply id="A2.Ex3.m1.4.4.cmml" xref="A2.Ex3.m1.4.4"><divide id="A2.Ex3.m1.4.4.5.cmml" xref="A2.Ex3.m1.4.4"></divide><apply id="A2.Ex3.m1.2.2.2.cmml" xref="A2.Ex3.m1.2.2.2"><csymbol cd="ambiguous" id="A2.Ex3.m1.2.2.2.3.cmml" xref="A2.Ex3.m1.2.2.2">superscript</csymbol><ci id="A2.Ex3.m1.2.2.2.4.cmml" xref="A2.Ex3.m1.2.2.2.4">𝑒</ci><apply id="A2.Ex3.m1.2.2.2.2.2.cmml" xref="A2.Ex3.m1.2.2.2.2.2"><times id="A2.Ex3.m1.2.2.2.2.2.3.cmml" xref="A2.Ex3.m1.2.2.2.2.2.3"></times><ci id="A2.Ex3.m1.2.2.2.2.2.4.cmml" xref="A2.Ex3.m1.2.2.2.2.2.4">𝑄</ci><interval closure="open" id="A2.Ex3.m1.2.2.2.2.2.2.2.cmml" xref="A2.Ex3.m1.2.2.2.2.2.2.1"><ci id="A2.Ex3.m1.1.1.1.1.1.1.cmml" xref="A2.Ex3.m1.1.1.1.1.1.1">𝑠</ci><apply id="A2.Ex3.m1.2.2.2.2.2.2.1.1.cmml" xref="A2.Ex3.m1.2.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="A2.Ex3.m1.2.2.2.2.2.2.1.1.1.cmml" xref="A2.Ex3.m1.2.2.2.2.2.2.1.1">subscript</csymbol><ci id="A2.Ex3.m1.2.2.2.2.2.2.1.1.2.cmml" xref="A2.Ex3.m1.2.2.2.2.2.2.1.1.2">𝑎</ci><ci id="A2.Ex3.m1.2.2.2.2.2.2.1.1.3.cmml" xref="A2.Ex3.m1.2.2.2.2.2.2.1.1.3">𝑖</ci></apply></interval></apply></apply><apply id="A2.Ex3.m1.4.4.4.cmml" xref="A2.Ex3.m1.4.4.4"><apply id="A2.Ex3.m1.4.4.4.3.cmml" xref="A2.Ex3.m1.4.4.4.3"><csymbol cd="ambiguous" id="A2.Ex3.m1.4.4.4.3.1.cmml" xref="A2.Ex3.m1.4.4.4.3">subscript</csymbol><sum id="A2.Ex3.m1.4.4.4.3.2.cmml" xref="A2.Ex3.m1.4.4.4.3.2"></sum><ci id="A2.Ex3.m1.4.4.4.3.3.cmml" xref="A2.Ex3.m1.4.4.4.3.3">𝑘</ci></apply><apply id="A2.Ex3.m1.4.4.4.4.cmml" xref="A2.Ex3.m1.4.4.4.4"><csymbol cd="ambiguous" id="A2.Ex3.m1.4.4.4.4.1.cmml" xref="A2.Ex3.m1.4.4.4.4">superscript</csymbol><ci id="A2.Ex3.m1.4.4.4.4.2.cmml" xref="A2.Ex3.m1.4.4.4.4.2">𝑒</ci><apply id="A2.Ex3.m1.4.4.4.2.2.cmml" xref="A2.Ex3.m1.4.4.4.2.2"><times id="A2.Ex3.m1.4.4.4.2.2.3.cmml" xref="A2.Ex3.m1.4.4.4.2.2.3"></times><ci id="A2.Ex3.m1.4.4.4.2.2.4.cmml" xref="A2.Ex3.m1.4.4.4.2.2.4">𝑄</ci><interval closure="open" id="A2.Ex3.m1.4.4.4.2.2.2.2.cmml" xref="A2.Ex3.m1.4.4.4.2.2.2.1"><ci id="A2.Ex3.m1.3.3.3.1.1.1.cmml" xref="A2.Ex3.m1.3.3.3.1.1.1">𝑠</ci><apply id="A2.Ex3.m1.4.4.4.2.2.2.1.1.cmml" xref="A2.Ex3.m1.4.4.4.2.2.2.1.1"><csymbol cd="ambiguous" id="A2.Ex3.m1.4.4.4.2.2.2.1.1.1.cmml" xref="A2.Ex3.m1.4.4.4.2.2.2.1.1">subscript</csymbol><ci id="A2.Ex3.m1.4.4.4.2.2.2.1.1.2.cmml" xref="A2.Ex3.m1.4.4.4.2.2.2.1.1.2">𝑎</ci><ci id="A2.Ex3.m1.4.4.4.2.2.2.1.1.3.cmml" xref="A2.Ex3.m1.4.4.4.2.2.2.1.1.3">𝑘</ci></apply></interval></apply></apply></apply></apply></apply><apply id="A2.Ex3.m1.9.9.1.1.2.2.cmml" xref="A2.Ex3.m1.9.9.1.1.2.2"><eq id="A2.Ex3.m1.9.9.1.1.2.2.1.cmml" xref="A2.Ex3.m1.9.9.1.1.2.2.1"></eq><ci id="A2.Ex3.m1.9.9.1.1.2.2.2.cmml" xref="A2.Ex3.m1.9.9.1.1.2.2.2">𝑖</ci><list id="A2.Ex3.m1.9.9.1.1.2.2.3.1.cmml" xref="A2.Ex3.m1.9.9.1.1.2.2.3.2"><cn id="A2.Ex3.m1.5.5.cmml" type="integer" xref="A2.Ex3.m1.5.5">1</cn><cn id="A2.Ex3.m1.6.6.cmml" type="integer" xref="A2.Ex3.m1.6.6">2</cn><ci id="A2.Ex3.m1.7.7.cmml" xref="A2.Ex3.m1.7.7">⋯</ci><ci id="A2.Ex3.m1.8.8.cmml" xref="A2.Ex3.m1.8.8">𝑛</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.Ex3.m1.9c">\pi(a_{i}\mid s)=\frac{e^{Q(s,a_{i})}}{\sum_{k}e^{Q(s,a_{k})}},\quad i=1,2,%
\cdots,n.</annotation><annotation encoding="application/x-llamapun" id="A2.Ex3.m1.9d">italic_π ( italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∣ italic_s ) = divide start_ARG italic_e start_POSTSUPERSCRIPT italic_Q ( italic_s , italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) end_POSTSUPERSCRIPT end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT italic_e start_POSTSUPERSCRIPT italic_Q ( italic_s , italic_a start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) end_POSTSUPERSCRIPT end_ARG , italic_i = 1 , 2 , ⋯ , italic_n .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS1.p6">
<p class="ltx_p" id="A2.SS1.p6.2">To ensure that the agent chooses actions that maximize its long-term accumulated rewards, the aim of policy optimization is to derive a policy <math alttext="\pi" class="ltx_Math" display="inline" id="A2.SS1.p6.1.m1.1"><semantics id="A2.SS1.p6.1.m1.1a"><mi id="A2.SS1.p6.1.m1.1.1" xref="A2.SS1.p6.1.m1.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p6.1.m1.1b"><ci id="A2.SS1.p6.1.m1.1.1.cmml" xref="A2.SS1.p6.1.m1.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p6.1.m1.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p6.1.m1.1d">italic_π</annotation></semantics></math> that maximizes the expected cumulative discounted reward <math alttext="\eta(\pi)" class="ltx_Math" display="inline" id="A2.SS1.p6.2.m2.1"><semantics id="A2.SS1.p6.2.m2.1a"><mrow id="A2.SS1.p6.2.m2.1.2" xref="A2.SS1.p6.2.m2.1.2.cmml"><mi id="A2.SS1.p6.2.m2.1.2.2" xref="A2.SS1.p6.2.m2.1.2.2.cmml">η</mi><mo id="A2.SS1.p6.2.m2.1.2.1" xref="A2.SS1.p6.2.m2.1.2.1.cmml">⁢</mo><mrow id="A2.SS1.p6.2.m2.1.2.3.2" xref="A2.SS1.p6.2.m2.1.2.cmml"><mo id="A2.SS1.p6.2.m2.1.2.3.2.1" stretchy="false" xref="A2.SS1.p6.2.m2.1.2.cmml">(</mo><mi id="A2.SS1.p6.2.m2.1.1" xref="A2.SS1.p6.2.m2.1.1.cmml">π</mi><mo id="A2.SS1.p6.2.m2.1.2.3.2.2" stretchy="false" xref="A2.SS1.p6.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p6.2.m2.1b"><apply id="A2.SS1.p6.2.m2.1.2.cmml" xref="A2.SS1.p6.2.m2.1.2"><times id="A2.SS1.p6.2.m2.1.2.1.cmml" xref="A2.SS1.p6.2.m2.1.2.1"></times><ci id="A2.SS1.p6.2.m2.1.2.2.cmml" xref="A2.SS1.p6.2.m2.1.2.2">𝜂</ci><ci id="A2.SS1.p6.2.m2.1.1.cmml" xref="A2.SS1.p6.2.m2.1.1">𝜋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p6.2.m2.1c">\eta(\pi)</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p6.2.m2.1d">italic_η ( italic_π )</annotation></semantics></math>. This is given by:</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS1.p7">
<table class="ltx_equation ltx_eqn_table" id="A2.Ex4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\eta(\pi)=\mathbb{E}_{\tau\sim\pi}\left[\sum_{i=0}^{\infty}\gamma^{i}R(s_{i},a%
_{i})\right]." class="ltx_Math" display="block" id="A2.Ex4.m1.2"><semantics id="A2.Ex4.m1.2a"><mrow id="A2.Ex4.m1.2.2.1" xref="A2.Ex4.m1.2.2.1.1.cmml"><mrow id="A2.Ex4.m1.2.2.1.1" xref="A2.Ex4.m1.2.2.1.1.cmml"><mrow id="A2.Ex4.m1.2.2.1.1.3" xref="A2.Ex4.m1.2.2.1.1.3.cmml"><mi id="A2.Ex4.m1.2.2.1.1.3.2" xref="A2.Ex4.m1.2.2.1.1.3.2.cmml">η</mi><mo id="A2.Ex4.m1.2.2.1.1.3.1" xref="A2.Ex4.m1.2.2.1.1.3.1.cmml">⁢</mo><mrow id="A2.Ex4.m1.2.2.1.1.3.3.2" xref="A2.Ex4.m1.2.2.1.1.3.cmml"><mo id="A2.Ex4.m1.2.2.1.1.3.3.2.1" stretchy="false" xref="A2.Ex4.m1.2.2.1.1.3.cmml">(</mo><mi id="A2.Ex4.m1.1.1" xref="A2.Ex4.m1.1.1.cmml">π</mi><mo id="A2.Ex4.m1.2.2.1.1.3.3.2.2" stretchy="false" xref="A2.Ex4.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow><mo id="A2.Ex4.m1.2.2.1.1.2" xref="A2.Ex4.m1.2.2.1.1.2.cmml">=</mo><mrow id="A2.Ex4.m1.2.2.1.1.1" xref="A2.Ex4.m1.2.2.1.1.1.cmml"><msub id="A2.Ex4.m1.2.2.1.1.1.3" xref="A2.Ex4.m1.2.2.1.1.1.3.cmml"><mi id="A2.Ex4.m1.2.2.1.1.1.3.2" xref="A2.Ex4.m1.2.2.1.1.1.3.2.cmml">𝔼</mi><mrow id="A2.Ex4.m1.2.2.1.1.1.3.3" xref="A2.Ex4.m1.2.2.1.1.1.3.3.cmml"><mi id="A2.Ex4.m1.2.2.1.1.1.3.3.2" xref="A2.Ex4.m1.2.2.1.1.1.3.3.2.cmml">τ</mi><mo id="A2.Ex4.m1.2.2.1.1.1.3.3.1" xref="A2.Ex4.m1.2.2.1.1.1.3.3.1.cmml">∼</mo><mi id="A2.Ex4.m1.2.2.1.1.1.3.3.3" xref="A2.Ex4.m1.2.2.1.1.1.3.3.3.cmml">π</mi></mrow></msub><mo id="A2.Ex4.m1.2.2.1.1.1.2" xref="A2.Ex4.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="A2.Ex4.m1.2.2.1.1.1.1.1" xref="A2.Ex4.m1.2.2.1.1.1.1.2.cmml"><mo id="A2.Ex4.m1.2.2.1.1.1.1.1.2" xref="A2.Ex4.m1.2.2.1.1.1.1.2.1.cmml">[</mo><mrow id="A2.Ex4.m1.2.2.1.1.1.1.1.1" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.cmml"><munderover id="A2.Ex4.m1.2.2.1.1.1.1.1.1.3" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.3.cmml"><mo id="A2.Ex4.m1.2.2.1.1.1.1.1.1.3.2.2" lspace="0em" movablelimits="false" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.3.2.2.cmml">∑</mo><mrow id="A2.Ex4.m1.2.2.1.1.1.1.1.1.3.2.3" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.3.2.3.cmml"><mi id="A2.Ex4.m1.2.2.1.1.1.1.1.1.3.2.3.2" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.3.2.3.2.cmml">i</mi><mo id="A2.Ex4.m1.2.2.1.1.1.1.1.1.3.2.3.1" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.3.2.3.1.cmml">=</mo><mn id="A2.Ex4.m1.2.2.1.1.1.1.1.1.3.2.3.3" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.3.2.3.3.cmml">0</mn></mrow><mi id="A2.Ex4.m1.2.2.1.1.1.1.1.1.3.3" mathvariant="normal" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.3.3.cmml">∞</mi></munderover><mrow id="A2.Ex4.m1.2.2.1.1.1.1.1.1.2" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.cmml"><msup id="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.4" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.4.cmml"><mi id="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.4.2" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.4.2.cmml">γ</mi><mi id="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.4.3" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.4.3.cmml">i</mi></msup><mo id="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.3" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.3.cmml">⁢</mo><mi id="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.5" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.5.cmml">R</mi><mo id="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.3a" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.2.2" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.2.3.cmml"><mo id="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.2.2.3" stretchy="false" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.2.3.cmml">(</mo><msub id="A2.Ex4.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A2.Ex4.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="A2.Ex4.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.2.2.4" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.2.3.cmml">,</mo><msub id="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.2.2.2" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.2.2.2.2" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.2.2.2.2.cmml">a</mi><mi id="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.2.2.2.3" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.2.2.2.3.cmml">i</mi></msub><mo id="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.2.2.5" stretchy="false" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="A2.Ex4.m1.2.2.1.1.1.1.1.3" xref="A2.Ex4.m1.2.2.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="A2.Ex4.m1.2.2.1.2" lspace="0em" xref="A2.Ex4.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.Ex4.m1.2b"><apply id="A2.Ex4.m1.2.2.1.1.cmml" xref="A2.Ex4.m1.2.2.1"><eq id="A2.Ex4.m1.2.2.1.1.2.cmml" xref="A2.Ex4.m1.2.2.1.1.2"></eq><apply id="A2.Ex4.m1.2.2.1.1.3.cmml" xref="A2.Ex4.m1.2.2.1.1.3"><times id="A2.Ex4.m1.2.2.1.1.3.1.cmml" xref="A2.Ex4.m1.2.2.1.1.3.1"></times><ci id="A2.Ex4.m1.2.2.1.1.3.2.cmml" xref="A2.Ex4.m1.2.2.1.1.3.2">𝜂</ci><ci id="A2.Ex4.m1.1.1.cmml" xref="A2.Ex4.m1.1.1">𝜋</ci></apply><apply id="A2.Ex4.m1.2.2.1.1.1.cmml" xref="A2.Ex4.m1.2.2.1.1.1"><times id="A2.Ex4.m1.2.2.1.1.1.2.cmml" xref="A2.Ex4.m1.2.2.1.1.1.2"></times><apply id="A2.Ex4.m1.2.2.1.1.1.3.cmml" xref="A2.Ex4.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="A2.Ex4.m1.2.2.1.1.1.3.1.cmml" xref="A2.Ex4.m1.2.2.1.1.1.3">subscript</csymbol><ci id="A2.Ex4.m1.2.2.1.1.1.3.2.cmml" xref="A2.Ex4.m1.2.2.1.1.1.3.2">𝔼</ci><apply id="A2.Ex4.m1.2.2.1.1.1.3.3.cmml" xref="A2.Ex4.m1.2.2.1.1.1.3.3"><csymbol cd="latexml" id="A2.Ex4.m1.2.2.1.1.1.3.3.1.cmml" xref="A2.Ex4.m1.2.2.1.1.1.3.3.1">similar-to</csymbol><ci id="A2.Ex4.m1.2.2.1.1.1.3.3.2.cmml" xref="A2.Ex4.m1.2.2.1.1.1.3.3.2">𝜏</ci><ci id="A2.Ex4.m1.2.2.1.1.1.3.3.3.cmml" xref="A2.Ex4.m1.2.2.1.1.1.3.3.3">𝜋</ci></apply></apply><apply id="A2.Ex4.m1.2.2.1.1.1.1.2.cmml" xref="A2.Ex4.m1.2.2.1.1.1.1.1"><csymbol cd="latexml" id="A2.Ex4.m1.2.2.1.1.1.1.2.1.cmml" xref="A2.Ex4.m1.2.2.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A2.Ex4.m1.2.2.1.1.1.1.1.1.cmml" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1"><apply id="A2.Ex4.m1.2.2.1.1.1.1.1.1.3.cmml" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.Ex4.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.3">superscript</csymbol><apply id="A2.Ex4.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.Ex4.m1.2.2.1.1.1.1.1.1.3.2.1.cmml" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.3">subscript</csymbol><sum id="A2.Ex4.m1.2.2.1.1.1.1.1.1.3.2.2.cmml" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.3.2.2"></sum><apply id="A2.Ex4.m1.2.2.1.1.1.1.1.1.3.2.3.cmml" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.3.2.3"><eq id="A2.Ex4.m1.2.2.1.1.1.1.1.1.3.2.3.1.cmml" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.3.2.3.1"></eq><ci id="A2.Ex4.m1.2.2.1.1.1.1.1.1.3.2.3.2.cmml" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.3.2.3.2">𝑖</ci><cn id="A2.Ex4.m1.2.2.1.1.1.1.1.1.3.2.3.3.cmml" type="integer" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.3.2.3.3">0</cn></apply></apply><infinity id="A2.Ex4.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.3.3"></infinity></apply><apply id="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.cmml" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.2"><times id="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.3"></times><apply id="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.4.cmml" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.4.1.cmml" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.4">superscript</csymbol><ci id="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.4.2.cmml" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.4.2">𝛾</ci><ci id="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.4.3.cmml" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.4.3">𝑖</ci></apply><ci id="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.5.cmml" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.5">𝑅</ci><interval closure="open" id="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.2.3.cmml" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.2.2"><apply id="A2.Ex4.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.Ex4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A2.Ex4.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="A2.Ex4.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.2.2.2.cmml" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.2.2.2.2">𝑎</ci><ci id="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="A2.Ex4.m1.2.2.1.1.1.1.1.1.2.2.2.2.3">𝑖</ci></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.Ex4.m1.2c">\eta(\pi)=\mathbb{E}_{\tau\sim\pi}\left[\sum_{i=0}^{\infty}\gamma^{i}R(s_{i},a%
_{i})\right].</annotation><annotation encoding="application/x-llamapun" id="A2.Ex4.m1.2d">italic_η ( italic_π ) = blackboard_E start_POSTSUBSCRIPT italic_τ ∼ italic_π end_POSTSUBSCRIPT [ ∑ start_POSTSUBSCRIPT italic_i = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT italic_γ start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT italic_R ( italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS1.p8">
<p class="ltx_p" id="A2.SS1.p8.1">The objective is to encourage the agent to make decisions that yield the highest total reward, balancing both immediate and future returns.</p>
</div>
</section>
<section class="ltx_subsection" id="A2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.2 </span>Intrinsic-Based Reinforcement Learning</h3>
<div class="ltx_para ltx_noindent" id="A2.SS2.p1">
<p class="ltx_p" id="A2.SS2.p1.1">Extending the traditional Markov Decision Process (MDP) framework, intrinsic rewards are introduced to facilitate agent exploration, particularly in environments characterized by sparse extrinsic rewards. In such settings, relying solely on extrinsic feedback can lead to inefficient exploration and poor learning outcomes, as the agent may not receive enough signals to optimize its policy effectively.</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS2.p2">
<p class="ltx_p" id="A2.SS2.p2.3">Intrinsic rewards serve as an additional incentive for the agent, promoting the discovery of novel states and encouraging behaviors that might eventually lead to higher extrinsic rewards. The total reward function <math alttext="R_{\text{total}}(s,a)" class="ltx_Math" display="inline" id="A2.SS2.p2.1.m1.2"><semantics id="A2.SS2.p2.1.m1.2a"><mrow id="A2.SS2.p2.1.m1.2.3" xref="A2.SS2.p2.1.m1.2.3.cmml"><msub id="A2.SS2.p2.1.m1.2.3.2" xref="A2.SS2.p2.1.m1.2.3.2.cmml"><mi id="A2.SS2.p2.1.m1.2.3.2.2" xref="A2.SS2.p2.1.m1.2.3.2.2.cmml">R</mi><mtext id="A2.SS2.p2.1.m1.2.3.2.3" xref="A2.SS2.p2.1.m1.2.3.2.3a.cmml">total</mtext></msub><mo id="A2.SS2.p2.1.m1.2.3.1" xref="A2.SS2.p2.1.m1.2.3.1.cmml">⁢</mo><mrow id="A2.SS2.p2.1.m1.2.3.3.2" xref="A2.SS2.p2.1.m1.2.3.3.1.cmml"><mo id="A2.SS2.p2.1.m1.2.3.3.2.1" stretchy="false" xref="A2.SS2.p2.1.m1.2.3.3.1.cmml">(</mo><mi id="A2.SS2.p2.1.m1.1.1" xref="A2.SS2.p2.1.m1.1.1.cmml">s</mi><mo id="A2.SS2.p2.1.m1.2.3.3.2.2" xref="A2.SS2.p2.1.m1.2.3.3.1.cmml">,</mo><mi id="A2.SS2.p2.1.m1.2.2" xref="A2.SS2.p2.1.m1.2.2.cmml">a</mi><mo id="A2.SS2.p2.1.m1.2.3.3.2.3" stretchy="false" xref="A2.SS2.p2.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS2.p2.1.m1.2b"><apply id="A2.SS2.p2.1.m1.2.3.cmml" xref="A2.SS2.p2.1.m1.2.3"><times id="A2.SS2.p2.1.m1.2.3.1.cmml" xref="A2.SS2.p2.1.m1.2.3.1"></times><apply id="A2.SS2.p2.1.m1.2.3.2.cmml" xref="A2.SS2.p2.1.m1.2.3.2"><csymbol cd="ambiguous" id="A2.SS2.p2.1.m1.2.3.2.1.cmml" xref="A2.SS2.p2.1.m1.2.3.2">subscript</csymbol><ci id="A2.SS2.p2.1.m1.2.3.2.2.cmml" xref="A2.SS2.p2.1.m1.2.3.2.2">𝑅</ci><ci id="A2.SS2.p2.1.m1.2.3.2.3a.cmml" xref="A2.SS2.p2.1.m1.2.3.2.3"><mtext id="A2.SS2.p2.1.m1.2.3.2.3.cmml" mathsize="70%" xref="A2.SS2.p2.1.m1.2.3.2.3">total</mtext></ci></apply><interval closure="open" id="A2.SS2.p2.1.m1.2.3.3.1.cmml" xref="A2.SS2.p2.1.m1.2.3.3.2"><ci id="A2.SS2.p2.1.m1.1.1.cmml" xref="A2.SS2.p2.1.m1.1.1">𝑠</ci><ci id="A2.SS2.p2.1.m1.2.2.cmml" xref="A2.SS2.p2.1.m1.2.2">𝑎</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p2.1.m1.2c">R_{\text{total}}(s,a)</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.p2.1.m1.2d">italic_R start_POSTSUBSCRIPT total end_POSTSUBSCRIPT ( italic_s , italic_a )</annotation></semantics></math> is thus composed of both extrinsic rewards <math alttext="R_{\text{ext}}" class="ltx_Math" display="inline" id="A2.SS2.p2.2.m2.1"><semantics id="A2.SS2.p2.2.m2.1a"><msub id="A2.SS2.p2.2.m2.1.1" xref="A2.SS2.p2.2.m2.1.1.cmml"><mi id="A2.SS2.p2.2.m2.1.1.2" xref="A2.SS2.p2.2.m2.1.1.2.cmml">R</mi><mtext id="A2.SS2.p2.2.m2.1.1.3" xref="A2.SS2.p2.2.m2.1.1.3a.cmml">ext</mtext></msub><annotation-xml encoding="MathML-Content" id="A2.SS2.p2.2.m2.1b"><apply id="A2.SS2.p2.2.m2.1.1.cmml" xref="A2.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="A2.SS2.p2.2.m2.1.1.1.cmml" xref="A2.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="A2.SS2.p2.2.m2.1.1.2.cmml" xref="A2.SS2.p2.2.m2.1.1.2">𝑅</ci><ci id="A2.SS2.p2.2.m2.1.1.3a.cmml" xref="A2.SS2.p2.2.m2.1.1.3"><mtext id="A2.SS2.p2.2.m2.1.1.3.cmml" mathsize="70%" xref="A2.SS2.p2.2.m2.1.1.3">ext</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p2.2.m2.1c">R_{\text{ext}}</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.p2.2.m2.1d">italic_R start_POSTSUBSCRIPT ext end_POSTSUBSCRIPT</annotation></semantics></math> and intrinsic rewards <math alttext="R_{\text{int}}" class="ltx_Math" display="inline" id="A2.SS2.p2.3.m3.1"><semantics id="A2.SS2.p2.3.m3.1a"><msub id="A2.SS2.p2.3.m3.1.1" xref="A2.SS2.p2.3.m3.1.1.cmml"><mi id="A2.SS2.p2.3.m3.1.1.2" xref="A2.SS2.p2.3.m3.1.1.2.cmml">R</mi><mtext id="A2.SS2.p2.3.m3.1.1.3" xref="A2.SS2.p2.3.m3.1.1.3a.cmml">int</mtext></msub><annotation-xml encoding="MathML-Content" id="A2.SS2.p2.3.m3.1b"><apply id="A2.SS2.p2.3.m3.1.1.cmml" xref="A2.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="A2.SS2.p2.3.m3.1.1.1.cmml" xref="A2.SS2.p2.3.m3.1.1">subscript</csymbol><ci id="A2.SS2.p2.3.m3.1.1.2.cmml" xref="A2.SS2.p2.3.m3.1.1.2">𝑅</ci><ci id="A2.SS2.p2.3.m3.1.1.3a.cmml" xref="A2.SS2.p2.3.m3.1.1.3"><mtext id="A2.SS2.p2.3.m3.1.1.3.cmml" mathsize="70%" xref="A2.SS2.p2.3.m3.1.1.3">int</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p2.3.m3.1c">R_{\text{int}}</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.p2.3.m3.1d">italic_R start_POSTSUBSCRIPT int end_POSTSUBSCRIPT</annotation></semantics></math>, which are combined to form a more comprehensive feedback mechanism:</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS2.p3">
<table class="ltx_equation ltx_eqn_table" id="A2.Ex5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="R_{\text{total}}(s,a)=R_{\text{ext}}(s,a)+\alpha R_{\text{int}}(s,a)." class="ltx_Math" display="block" id="A2.Ex5.m1.7"><semantics id="A2.Ex5.m1.7a"><mrow id="A2.Ex5.m1.7.7.1" xref="A2.Ex5.m1.7.7.1.1.cmml"><mrow id="A2.Ex5.m1.7.7.1.1" xref="A2.Ex5.m1.7.7.1.1.cmml"><mrow id="A2.Ex5.m1.7.7.1.1.2" xref="A2.Ex5.m1.7.7.1.1.2.cmml"><msub id="A2.Ex5.m1.7.7.1.1.2.2" xref="A2.Ex5.m1.7.7.1.1.2.2.cmml"><mi id="A2.Ex5.m1.7.7.1.1.2.2.2" xref="A2.Ex5.m1.7.7.1.1.2.2.2.cmml">R</mi><mtext id="A2.Ex5.m1.7.7.1.1.2.2.3" xref="A2.Ex5.m1.7.7.1.1.2.2.3a.cmml">total</mtext></msub><mo id="A2.Ex5.m1.7.7.1.1.2.1" xref="A2.Ex5.m1.7.7.1.1.2.1.cmml">⁢</mo><mrow id="A2.Ex5.m1.7.7.1.1.2.3.2" xref="A2.Ex5.m1.7.7.1.1.2.3.1.cmml"><mo id="A2.Ex5.m1.7.7.1.1.2.3.2.1" stretchy="false" xref="A2.Ex5.m1.7.7.1.1.2.3.1.cmml">(</mo><mi id="A2.Ex5.m1.1.1" xref="A2.Ex5.m1.1.1.cmml">s</mi><mo id="A2.Ex5.m1.7.7.1.1.2.3.2.2" xref="A2.Ex5.m1.7.7.1.1.2.3.1.cmml">,</mo><mi id="A2.Ex5.m1.2.2" xref="A2.Ex5.m1.2.2.cmml">a</mi><mo id="A2.Ex5.m1.7.7.1.1.2.3.2.3" stretchy="false" xref="A2.Ex5.m1.7.7.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="A2.Ex5.m1.7.7.1.1.1" xref="A2.Ex5.m1.7.7.1.1.1.cmml">=</mo><mrow id="A2.Ex5.m1.7.7.1.1.3" xref="A2.Ex5.m1.7.7.1.1.3.cmml"><mrow id="A2.Ex5.m1.7.7.1.1.3.2" xref="A2.Ex5.m1.7.7.1.1.3.2.cmml"><msub id="A2.Ex5.m1.7.7.1.1.3.2.2" xref="A2.Ex5.m1.7.7.1.1.3.2.2.cmml"><mi id="A2.Ex5.m1.7.7.1.1.3.2.2.2" xref="A2.Ex5.m1.7.7.1.1.3.2.2.2.cmml">R</mi><mtext id="A2.Ex5.m1.7.7.1.1.3.2.2.3" xref="A2.Ex5.m1.7.7.1.1.3.2.2.3a.cmml">ext</mtext></msub><mo id="A2.Ex5.m1.7.7.1.1.3.2.1" xref="A2.Ex5.m1.7.7.1.1.3.2.1.cmml">⁢</mo><mrow id="A2.Ex5.m1.7.7.1.1.3.2.3.2" xref="A2.Ex5.m1.7.7.1.1.3.2.3.1.cmml"><mo id="A2.Ex5.m1.7.7.1.1.3.2.3.2.1" stretchy="false" xref="A2.Ex5.m1.7.7.1.1.3.2.3.1.cmml">(</mo><mi id="A2.Ex5.m1.3.3" xref="A2.Ex5.m1.3.3.cmml">s</mi><mo id="A2.Ex5.m1.7.7.1.1.3.2.3.2.2" xref="A2.Ex5.m1.7.7.1.1.3.2.3.1.cmml">,</mo><mi id="A2.Ex5.m1.4.4" xref="A2.Ex5.m1.4.4.cmml">a</mi><mo id="A2.Ex5.m1.7.7.1.1.3.2.3.2.3" stretchy="false" xref="A2.Ex5.m1.7.7.1.1.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="A2.Ex5.m1.7.7.1.1.3.1" xref="A2.Ex5.m1.7.7.1.1.3.1.cmml">+</mo><mrow id="A2.Ex5.m1.7.7.1.1.3.3" xref="A2.Ex5.m1.7.7.1.1.3.3.cmml"><mi id="A2.Ex5.m1.7.7.1.1.3.3.2" xref="A2.Ex5.m1.7.7.1.1.3.3.2.cmml">α</mi><mo id="A2.Ex5.m1.7.7.1.1.3.3.1" xref="A2.Ex5.m1.7.7.1.1.3.3.1.cmml">⁢</mo><msub id="A2.Ex5.m1.7.7.1.1.3.3.3" xref="A2.Ex5.m1.7.7.1.1.3.3.3.cmml"><mi id="A2.Ex5.m1.7.7.1.1.3.3.3.2" xref="A2.Ex5.m1.7.7.1.1.3.3.3.2.cmml">R</mi><mtext id="A2.Ex5.m1.7.7.1.1.3.3.3.3" xref="A2.Ex5.m1.7.7.1.1.3.3.3.3a.cmml">int</mtext></msub><mo id="A2.Ex5.m1.7.7.1.1.3.3.1a" xref="A2.Ex5.m1.7.7.1.1.3.3.1.cmml">⁢</mo><mrow id="A2.Ex5.m1.7.7.1.1.3.3.4.2" xref="A2.Ex5.m1.7.7.1.1.3.3.4.1.cmml"><mo id="A2.Ex5.m1.7.7.1.1.3.3.4.2.1" stretchy="false" xref="A2.Ex5.m1.7.7.1.1.3.3.4.1.cmml">(</mo><mi id="A2.Ex5.m1.5.5" xref="A2.Ex5.m1.5.5.cmml">s</mi><mo id="A2.Ex5.m1.7.7.1.1.3.3.4.2.2" xref="A2.Ex5.m1.7.7.1.1.3.3.4.1.cmml">,</mo><mi id="A2.Ex5.m1.6.6" xref="A2.Ex5.m1.6.6.cmml">a</mi><mo id="A2.Ex5.m1.7.7.1.1.3.3.4.2.3" stretchy="false" xref="A2.Ex5.m1.7.7.1.1.3.3.4.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A2.Ex5.m1.7.7.1.2" lspace="0em" xref="A2.Ex5.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.Ex5.m1.7b"><apply id="A2.Ex5.m1.7.7.1.1.cmml" xref="A2.Ex5.m1.7.7.1"><eq id="A2.Ex5.m1.7.7.1.1.1.cmml" xref="A2.Ex5.m1.7.7.1.1.1"></eq><apply id="A2.Ex5.m1.7.7.1.1.2.cmml" xref="A2.Ex5.m1.7.7.1.1.2"><times id="A2.Ex5.m1.7.7.1.1.2.1.cmml" xref="A2.Ex5.m1.7.7.1.1.2.1"></times><apply id="A2.Ex5.m1.7.7.1.1.2.2.cmml" xref="A2.Ex5.m1.7.7.1.1.2.2"><csymbol cd="ambiguous" id="A2.Ex5.m1.7.7.1.1.2.2.1.cmml" xref="A2.Ex5.m1.7.7.1.1.2.2">subscript</csymbol><ci id="A2.Ex5.m1.7.7.1.1.2.2.2.cmml" xref="A2.Ex5.m1.7.7.1.1.2.2.2">𝑅</ci><ci id="A2.Ex5.m1.7.7.1.1.2.2.3a.cmml" xref="A2.Ex5.m1.7.7.1.1.2.2.3"><mtext id="A2.Ex5.m1.7.7.1.1.2.2.3.cmml" mathsize="70%" xref="A2.Ex5.m1.7.7.1.1.2.2.3">total</mtext></ci></apply><interval closure="open" id="A2.Ex5.m1.7.7.1.1.2.3.1.cmml" xref="A2.Ex5.m1.7.7.1.1.2.3.2"><ci id="A2.Ex5.m1.1.1.cmml" xref="A2.Ex5.m1.1.1">𝑠</ci><ci id="A2.Ex5.m1.2.2.cmml" xref="A2.Ex5.m1.2.2">𝑎</ci></interval></apply><apply id="A2.Ex5.m1.7.7.1.1.3.cmml" xref="A2.Ex5.m1.7.7.1.1.3"><plus id="A2.Ex5.m1.7.7.1.1.3.1.cmml" xref="A2.Ex5.m1.7.7.1.1.3.1"></plus><apply id="A2.Ex5.m1.7.7.1.1.3.2.cmml" xref="A2.Ex5.m1.7.7.1.1.3.2"><times id="A2.Ex5.m1.7.7.1.1.3.2.1.cmml" xref="A2.Ex5.m1.7.7.1.1.3.2.1"></times><apply id="A2.Ex5.m1.7.7.1.1.3.2.2.cmml" xref="A2.Ex5.m1.7.7.1.1.3.2.2"><csymbol cd="ambiguous" id="A2.Ex5.m1.7.7.1.1.3.2.2.1.cmml" xref="A2.Ex5.m1.7.7.1.1.3.2.2">subscript</csymbol><ci id="A2.Ex5.m1.7.7.1.1.3.2.2.2.cmml" xref="A2.Ex5.m1.7.7.1.1.3.2.2.2">𝑅</ci><ci id="A2.Ex5.m1.7.7.1.1.3.2.2.3a.cmml" xref="A2.Ex5.m1.7.7.1.1.3.2.2.3"><mtext id="A2.Ex5.m1.7.7.1.1.3.2.2.3.cmml" mathsize="70%" xref="A2.Ex5.m1.7.7.1.1.3.2.2.3">ext</mtext></ci></apply><interval closure="open" id="A2.Ex5.m1.7.7.1.1.3.2.3.1.cmml" xref="A2.Ex5.m1.7.7.1.1.3.2.3.2"><ci id="A2.Ex5.m1.3.3.cmml" xref="A2.Ex5.m1.3.3">𝑠</ci><ci id="A2.Ex5.m1.4.4.cmml" xref="A2.Ex5.m1.4.4">𝑎</ci></interval></apply><apply id="A2.Ex5.m1.7.7.1.1.3.3.cmml" xref="A2.Ex5.m1.7.7.1.1.3.3"><times id="A2.Ex5.m1.7.7.1.1.3.3.1.cmml" xref="A2.Ex5.m1.7.7.1.1.3.3.1"></times><ci id="A2.Ex5.m1.7.7.1.1.3.3.2.cmml" xref="A2.Ex5.m1.7.7.1.1.3.3.2">𝛼</ci><apply id="A2.Ex5.m1.7.7.1.1.3.3.3.cmml" xref="A2.Ex5.m1.7.7.1.1.3.3.3"><csymbol cd="ambiguous" id="A2.Ex5.m1.7.7.1.1.3.3.3.1.cmml" xref="A2.Ex5.m1.7.7.1.1.3.3.3">subscript</csymbol><ci id="A2.Ex5.m1.7.7.1.1.3.3.3.2.cmml" xref="A2.Ex5.m1.7.7.1.1.3.3.3.2">𝑅</ci><ci id="A2.Ex5.m1.7.7.1.1.3.3.3.3a.cmml" xref="A2.Ex5.m1.7.7.1.1.3.3.3.3"><mtext id="A2.Ex5.m1.7.7.1.1.3.3.3.3.cmml" mathsize="70%" xref="A2.Ex5.m1.7.7.1.1.3.3.3.3">int</mtext></ci></apply><interval closure="open" id="A2.Ex5.m1.7.7.1.1.3.3.4.1.cmml" xref="A2.Ex5.m1.7.7.1.1.3.3.4.2"><ci id="A2.Ex5.m1.5.5.cmml" xref="A2.Ex5.m1.5.5">𝑠</ci><ci id="A2.Ex5.m1.6.6.cmml" xref="A2.Ex5.m1.6.6">𝑎</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.Ex5.m1.7c">R_{\text{total}}(s,a)=R_{\text{ext}}(s,a)+\alpha R_{\text{int}}(s,a).</annotation><annotation encoding="application/x-llamapun" id="A2.Ex5.m1.7d">italic_R start_POSTSUBSCRIPT total end_POSTSUBSCRIPT ( italic_s , italic_a ) = italic_R start_POSTSUBSCRIPT ext end_POSTSUBSCRIPT ( italic_s , italic_a ) + italic_α italic_R start_POSTSUBSCRIPT int end_POSTSUBSCRIPT ( italic_s , italic_a ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS2.p4">
<p class="ltx_p" id="A2.SS2.p4.1">The intrinsic reward <math alttext="R_{\text{int}}(s,a)" class="ltx_Math" display="inline" id="A2.SS2.p4.1.m1.2"><semantics id="A2.SS2.p4.1.m1.2a"><mrow id="A2.SS2.p4.1.m1.2.3" xref="A2.SS2.p4.1.m1.2.3.cmml"><msub id="A2.SS2.p4.1.m1.2.3.2" xref="A2.SS2.p4.1.m1.2.3.2.cmml"><mi id="A2.SS2.p4.1.m1.2.3.2.2" xref="A2.SS2.p4.1.m1.2.3.2.2.cmml">R</mi><mtext id="A2.SS2.p4.1.m1.2.3.2.3" xref="A2.SS2.p4.1.m1.2.3.2.3a.cmml">int</mtext></msub><mo id="A2.SS2.p4.1.m1.2.3.1" xref="A2.SS2.p4.1.m1.2.3.1.cmml">⁢</mo><mrow id="A2.SS2.p4.1.m1.2.3.3.2" xref="A2.SS2.p4.1.m1.2.3.3.1.cmml"><mo id="A2.SS2.p4.1.m1.2.3.3.2.1" stretchy="false" xref="A2.SS2.p4.1.m1.2.3.3.1.cmml">(</mo><mi id="A2.SS2.p4.1.m1.1.1" xref="A2.SS2.p4.1.m1.1.1.cmml">s</mi><mo id="A2.SS2.p4.1.m1.2.3.3.2.2" xref="A2.SS2.p4.1.m1.2.3.3.1.cmml">,</mo><mi id="A2.SS2.p4.1.m1.2.2" xref="A2.SS2.p4.1.m1.2.2.cmml">a</mi><mo id="A2.SS2.p4.1.m1.2.3.3.2.3" stretchy="false" xref="A2.SS2.p4.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS2.p4.1.m1.2b"><apply id="A2.SS2.p4.1.m1.2.3.cmml" xref="A2.SS2.p4.1.m1.2.3"><times id="A2.SS2.p4.1.m1.2.3.1.cmml" xref="A2.SS2.p4.1.m1.2.3.1"></times><apply id="A2.SS2.p4.1.m1.2.3.2.cmml" xref="A2.SS2.p4.1.m1.2.3.2"><csymbol cd="ambiguous" id="A2.SS2.p4.1.m1.2.3.2.1.cmml" xref="A2.SS2.p4.1.m1.2.3.2">subscript</csymbol><ci id="A2.SS2.p4.1.m1.2.3.2.2.cmml" xref="A2.SS2.p4.1.m1.2.3.2.2">𝑅</ci><ci id="A2.SS2.p4.1.m1.2.3.2.3a.cmml" xref="A2.SS2.p4.1.m1.2.3.2.3"><mtext id="A2.SS2.p4.1.m1.2.3.2.3.cmml" mathsize="70%" xref="A2.SS2.p4.1.m1.2.3.2.3">int</mtext></ci></apply><interval closure="open" id="A2.SS2.p4.1.m1.2.3.3.1.cmml" xref="A2.SS2.p4.1.m1.2.3.3.2"><ci id="A2.SS2.p4.1.m1.1.1.cmml" xref="A2.SS2.p4.1.m1.1.1">𝑠</ci><ci id="A2.SS2.p4.1.m1.2.2.cmml" xref="A2.SS2.p4.1.m1.2.2">𝑎</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p4.1.m1.2c">R_{\text{int}}(s,a)</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.p4.1.m1.2d">italic_R start_POSTSUBSCRIPT int end_POSTSUBSCRIPT ( italic_s , italic_a )</annotation></semantics></math> often reflects properties such as state novelty, prediction error, or curiosity. These intrinsic signals help agents maintain a high level of exploration, ensuring that less frequently visited states are considered, thus improving the learning of optimal policies over time. By incorporating intrinsic rewards, intrinsic-based reinforcement learning aims to balance exploration and exploitation, allowing agents to learn effectively even when extrinsic rewards are sparse or delayed. This approach significantly improves learning efficiency in complex environments where traditional methods struggle to provide sufficient guidance.</p>
</div>
</section>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Additional Proofs</h2>
<section class="ltx_subsection" id="A3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.1 </span>Proof of Theorem <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S3.Thmtheorem2" title="Theorem 3.2. ‣ 3.2.2 Proof of the retaining of policy optimality ‣ 3.2 Coarse-fine distinction module ‣ 3 Method ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_tag">3.2</span></a>
</h3>
<div class="ltx_proof" id="A3.SS1.2">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div class="ltx_para ltx_noindent" id="A3.SS1.1.p1">
<p class="ltx_p" id="A3.SS1.1.p1.4">Under Assumption <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S3.Thmtheorem1" title="Assumption 3.1. ‣ 3.2.2 Proof of the retaining of policy optimality ‣ 3.2 Coarse-fine distinction module ‣ 3 Method ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_tag">3.1</span></a>, we define <math alttext="C\triangleq(1-\gamma)\min_{s}[Q^{*}(s,a^{*})-Q^{*}(s,a^{sub})]" class="ltx_Math" display="inline" id="A3.SS1.1.p1.1.m1.5"><semantics id="A3.SS1.1.p1.1.m1.5a"><mrow id="A3.SS1.1.p1.1.m1.5.5" xref="A3.SS1.1.p1.1.m1.5.5.cmml"><mi id="A3.SS1.1.p1.1.m1.5.5.5" xref="A3.SS1.1.p1.1.m1.5.5.5.cmml">C</mi><mo id="A3.SS1.1.p1.1.m1.5.5.4" xref="A3.SS1.1.p1.1.m1.5.5.4.cmml">≜</mo><mrow id="A3.SS1.1.p1.1.m1.5.5.3" xref="A3.SS1.1.p1.1.m1.5.5.3.cmml"><mrow id="A3.SS1.1.p1.1.m1.3.3.1.1.1" xref="A3.SS1.1.p1.1.m1.3.3.1.1.1.1.cmml"><mo id="A3.SS1.1.p1.1.m1.3.3.1.1.1.2" stretchy="false" xref="A3.SS1.1.p1.1.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="A3.SS1.1.p1.1.m1.3.3.1.1.1.1" xref="A3.SS1.1.p1.1.m1.3.3.1.1.1.1.cmml"><mn id="A3.SS1.1.p1.1.m1.3.3.1.1.1.1.2" xref="A3.SS1.1.p1.1.m1.3.3.1.1.1.1.2.cmml">1</mn><mo id="A3.SS1.1.p1.1.m1.3.3.1.1.1.1.1" xref="A3.SS1.1.p1.1.m1.3.3.1.1.1.1.1.cmml">−</mo><mi id="A3.SS1.1.p1.1.m1.3.3.1.1.1.1.3" xref="A3.SS1.1.p1.1.m1.3.3.1.1.1.1.3.cmml">γ</mi></mrow><mo id="A3.SS1.1.p1.1.m1.3.3.1.1.1.3" stretchy="false" xref="A3.SS1.1.p1.1.m1.3.3.1.1.1.1.cmml">)</mo></mrow><mo id="A3.SS1.1.p1.1.m1.5.5.3.4" lspace="0.167em" xref="A3.SS1.1.p1.1.m1.5.5.3.4.cmml">⁢</mo><mrow id="A3.SS1.1.p1.1.m1.5.5.3.3.2" xref="A3.SS1.1.p1.1.m1.5.5.3.3.3.cmml"><msub id="A3.SS1.1.p1.1.m1.4.4.2.2.1.1" xref="A3.SS1.1.p1.1.m1.4.4.2.2.1.1.cmml"><mi id="A3.SS1.1.p1.1.m1.4.4.2.2.1.1.2" xref="A3.SS1.1.p1.1.m1.4.4.2.2.1.1.2.cmml">min</mi><mi id="A3.SS1.1.p1.1.m1.4.4.2.2.1.1.3" xref="A3.SS1.1.p1.1.m1.4.4.2.2.1.1.3.cmml">s</mi></msub><mo id="A3.SS1.1.p1.1.m1.5.5.3.3.2a" xref="A3.SS1.1.p1.1.m1.5.5.3.3.3.cmml">⁡</mo><mrow id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2" xref="A3.SS1.1.p1.1.m1.5.5.3.3.3.cmml"><mo id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.2" stretchy="false" xref="A3.SS1.1.p1.1.m1.5.5.3.3.3.cmml">[</mo><mrow id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.cmml"><mrow id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.1" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.1.cmml"><msup id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.1.3" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.1.3.cmml"><mi id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.1.3.2" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.1.3.2.cmml">Q</mi><mo id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.1.3.3" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.1.3.3.cmml">∗</mo></msup><mo id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.1.2" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.1.2.cmml">⁢</mo><mrow id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.1.1.1" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.1.1.2.cmml"><mo id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.1.1.1.2" stretchy="false" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.1.1.2.cmml">(</mo><mi id="A3.SS1.1.p1.1.m1.1.1" xref="A3.SS1.1.p1.1.m1.1.1.cmml">s</mi><mo id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.1.1.1.3" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.1.1.2.cmml">,</mo><msup id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.1.1.1.1" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.1.1.1.1.cmml"><mi id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.1.1.1.1.2" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.1.1.1.1.2.cmml">a</mi><mo id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.1.1.1.1.3" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.1.1.1.1.3.cmml">∗</mo></msup><mo id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.1.1.1.4" stretchy="false" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.3" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.3.cmml">−</mo><mrow id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.cmml"><msup id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.3" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.3.cmml"><mi id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.3.2" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.3.2.cmml">Q</mi><mo id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.3.3" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.3.3.cmml">∗</mo></msup><mo id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.2" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.2.cmml">⁢</mo><mrow id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.1.1" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.1.2.cmml"><mo id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.1.1.2" stretchy="false" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.1.2.cmml">(</mo><mi id="A3.SS1.1.p1.1.m1.2.2" xref="A3.SS1.1.p1.1.m1.2.2.cmml">s</mi><mo id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.1.1.3" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.1.2.cmml">,</mo><msup id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.1.1.1" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.1.1.1.cmml"><mi id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.1.1.1.2" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.1.1.1.2.cmml">a</mi><mrow id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.1.1.1.3" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.1.1.1.3.cmml"><mi id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.1.1.1.3.2" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.1.1.1.3.2.cmml">s</mi><mo id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.1.1.1.3.1" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.1.1.1.3.1.cmml">⁢</mo><mi id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.1.1.1.3.3" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.1.1.1.3.3.cmml">u</mi><mo id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.1.1.1.3.1a" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.1.1.1.3.1.cmml">⁢</mo><mi id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.1.1.1.3.4" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.1.1.1.3.4.cmml">b</mi></mrow></msup><mo id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.1.1.4" stretchy="false" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.3" stretchy="false" xref="A3.SS1.1.p1.1.m1.5.5.3.3.3.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.1.p1.1.m1.5b"><apply id="A3.SS1.1.p1.1.m1.5.5.cmml" xref="A3.SS1.1.p1.1.m1.5.5"><ci id="A3.SS1.1.p1.1.m1.5.5.4.cmml" xref="A3.SS1.1.p1.1.m1.5.5.4">≜</ci><ci id="A3.SS1.1.p1.1.m1.5.5.5.cmml" xref="A3.SS1.1.p1.1.m1.5.5.5">𝐶</ci><apply id="A3.SS1.1.p1.1.m1.5.5.3.cmml" xref="A3.SS1.1.p1.1.m1.5.5.3"><times id="A3.SS1.1.p1.1.m1.5.5.3.4.cmml" xref="A3.SS1.1.p1.1.m1.5.5.3.4"></times><apply id="A3.SS1.1.p1.1.m1.3.3.1.1.1.1.cmml" xref="A3.SS1.1.p1.1.m1.3.3.1.1.1"><minus id="A3.SS1.1.p1.1.m1.3.3.1.1.1.1.1.cmml" xref="A3.SS1.1.p1.1.m1.3.3.1.1.1.1.1"></minus><cn id="A3.SS1.1.p1.1.m1.3.3.1.1.1.1.2.cmml" type="integer" xref="A3.SS1.1.p1.1.m1.3.3.1.1.1.1.2">1</cn><ci id="A3.SS1.1.p1.1.m1.3.3.1.1.1.1.3.cmml" xref="A3.SS1.1.p1.1.m1.3.3.1.1.1.1.3">𝛾</ci></apply><apply id="A3.SS1.1.p1.1.m1.5.5.3.3.3.cmml" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2"><apply id="A3.SS1.1.p1.1.m1.4.4.2.2.1.1.cmml" xref="A3.SS1.1.p1.1.m1.4.4.2.2.1.1"><csymbol cd="ambiguous" id="A3.SS1.1.p1.1.m1.4.4.2.2.1.1.1.cmml" xref="A3.SS1.1.p1.1.m1.4.4.2.2.1.1">subscript</csymbol><min id="A3.SS1.1.p1.1.m1.4.4.2.2.1.1.2.cmml" xref="A3.SS1.1.p1.1.m1.4.4.2.2.1.1.2"></min><ci id="A3.SS1.1.p1.1.m1.4.4.2.2.1.1.3.cmml" xref="A3.SS1.1.p1.1.m1.4.4.2.2.1.1.3">𝑠</ci></apply><apply id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.cmml" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1"><minus id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.3.cmml" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.3"></minus><apply id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.1.cmml" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.1"><times id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.1.2.cmml" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.1.2"></times><apply id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.1.3.cmml" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.1.3"><csymbol cd="ambiguous" id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.1.3.1.cmml" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.1.3">superscript</csymbol><ci id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.1.3.2.cmml" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.1.3.2">𝑄</ci><times id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.1.3.3.cmml" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.1.3.3"></times></apply><interval closure="open" id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.1.1.2.cmml" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.1.1.1"><ci id="A3.SS1.1.p1.1.m1.1.1.cmml" xref="A3.SS1.1.p1.1.m1.1.1">𝑠</ci><apply id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.1.1.1.1.cmml" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.1.1.1.1.1.cmml" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.1.1.1.1">superscript</csymbol><ci id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.1.1.1.1.2.cmml" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.1.1.1.1.2">𝑎</ci><times id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.1.1.1.1.3.cmml" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.1.1.1.1.3"></times></apply></interval></apply><apply id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.cmml" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2"><times id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.2.cmml" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.2"></times><apply id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.3.cmml" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.3"><csymbol cd="ambiguous" id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.3.1.cmml" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.3">superscript</csymbol><ci id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.3.2.cmml" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.3.2">𝑄</ci><times id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.3.3.cmml" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.3.3"></times></apply><interval closure="open" id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.1.2.cmml" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.1.1"><ci id="A3.SS1.1.p1.1.m1.2.2.cmml" xref="A3.SS1.1.p1.1.m1.2.2">𝑠</ci><apply id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.1.1.1.cmml" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.1.1.1"><csymbol cd="ambiguous" id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.1.1.1.1.cmml" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.1.1.1">superscript</csymbol><ci id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.1.1.1.2.cmml" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.1.1.1.2">𝑎</ci><apply id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.1.1.1.3.cmml" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.1.1.1.3"><times id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.1.1.1.3.1.cmml" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.1.1.1.3.1"></times><ci id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.1.1.1.3.2.cmml" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.1.1.1.3.2">𝑠</ci><ci id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.1.1.1.3.3.cmml" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.1.1.1.3.3">𝑢</ci><ci id="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.1.1.1.3.4.cmml" xref="A3.SS1.1.p1.1.m1.5.5.3.3.2.2.1.2.1.1.1.3.4">𝑏</ci></apply></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.1.p1.1.m1.5c">C\triangleq(1-\gamma)\min_{s}[Q^{*}(s,a^{*})-Q^{*}(s,a^{sub})]</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.1.p1.1.m1.5d">italic_C ≜ ( 1 - italic_γ ) roman_min start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT [ italic_Q start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s , italic_a start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ) - italic_Q start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s , italic_a start_POSTSUPERSCRIPT italic_s italic_u italic_b end_POSTSUPERSCRIPT ) ]</annotation></semantics></math>. So, for any state <math alttext="s" class="ltx_Math" display="inline" id="A3.SS1.1.p1.2.m2.1"><semantics id="A3.SS1.1.p1.2.m2.1a"><mi id="A3.SS1.1.p1.2.m2.1.1" xref="A3.SS1.1.p1.2.m2.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="A3.SS1.1.p1.2.m2.1b"><ci id="A3.SS1.1.p1.2.m2.1.1.cmml" xref="A3.SS1.1.p1.2.m2.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.1.p1.2.m2.1c">s</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.1.p1.2.m2.1d">italic_s</annotation></semantics></math> and action <math alttext="a" class="ltx_Math" display="inline" id="A3.SS1.1.p1.3.m3.1"><semantics id="A3.SS1.1.p1.3.m3.1a"><mi id="A3.SS1.1.p1.3.m3.1.1" xref="A3.SS1.1.p1.3.m3.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="A3.SS1.1.p1.3.m3.1b"><ci id="A3.SS1.1.p1.3.m3.1.1.cmml" xref="A3.SS1.1.p1.3.m3.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.1.p1.3.m3.1c">a</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.1.p1.3.m3.1d">italic_a</annotation></semantics></math>, we omit (<math alttext="s,a" class="ltx_Math" display="inline" id="A3.SS1.1.p1.4.m4.2"><semantics id="A3.SS1.1.p1.4.m4.2a"><mrow id="A3.SS1.1.p1.4.m4.2.3.2" xref="A3.SS1.1.p1.4.m4.2.3.1.cmml"><mi id="A3.SS1.1.p1.4.m4.1.1" xref="A3.SS1.1.p1.4.m4.1.1.cmml">s</mi><mo id="A3.SS1.1.p1.4.m4.2.3.2.1" xref="A3.SS1.1.p1.4.m4.2.3.1.cmml">,</mo><mi id="A3.SS1.1.p1.4.m4.2.2" xref="A3.SS1.1.p1.4.m4.2.2.cmml">a</mi></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.1.p1.4.m4.2b"><list id="A3.SS1.1.p1.4.m4.2.3.1.cmml" xref="A3.SS1.1.p1.4.m4.2.3.2"><ci id="A3.SS1.1.p1.4.m4.1.1.cmml" xref="A3.SS1.1.p1.4.m4.1.1">𝑠</ci><ci id="A3.SS1.1.p1.4.m4.2.2.cmml" xref="A3.SS1.1.p1.4.m4.2.2">𝑎</ci></list></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.1.p1.4.m4.2c">s,a</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.1.p1.4.m4.2d">italic_s , italic_a</annotation></semantics></math>), and have</p>
<table class="ltx_equation ltx_eqn_table" id="A3.Ex6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="R\leq R+\beta R_{I}\leq R+C" class="ltx_Math" display="block" id="A3.Ex6.m1.1"><semantics id="A3.Ex6.m1.1a"><mrow id="A3.Ex6.m1.1.1" xref="A3.Ex6.m1.1.1.cmml"><mi id="A3.Ex6.m1.1.1.2" xref="A3.Ex6.m1.1.1.2.cmml">R</mi><mo id="A3.Ex6.m1.1.1.3" xref="A3.Ex6.m1.1.1.3.cmml">≤</mo><mrow id="A3.Ex6.m1.1.1.4" xref="A3.Ex6.m1.1.1.4.cmml"><mi id="A3.Ex6.m1.1.1.4.2" xref="A3.Ex6.m1.1.1.4.2.cmml">R</mi><mo id="A3.Ex6.m1.1.1.4.1" xref="A3.Ex6.m1.1.1.4.1.cmml">+</mo><mrow id="A3.Ex6.m1.1.1.4.3" xref="A3.Ex6.m1.1.1.4.3.cmml"><mi id="A3.Ex6.m1.1.1.4.3.2" xref="A3.Ex6.m1.1.1.4.3.2.cmml">β</mi><mo id="A3.Ex6.m1.1.1.4.3.1" xref="A3.Ex6.m1.1.1.4.3.1.cmml">⁢</mo><msub id="A3.Ex6.m1.1.1.4.3.3" xref="A3.Ex6.m1.1.1.4.3.3.cmml"><mi id="A3.Ex6.m1.1.1.4.3.3.2" xref="A3.Ex6.m1.1.1.4.3.3.2.cmml">R</mi><mi id="A3.Ex6.m1.1.1.4.3.3.3" xref="A3.Ex6.m1.1.1.4.3.3.3.cmml">I</mi></msub></mrow></mrow><mo id="A3.Ex6.m1.1.1.5" xref="A3.Ex6.m1.1.1.5.cmml">≤</mo><mrow id="A3.Ex6.m1.1.1.6" xref="A3.Ex6.m1.1.1.6.cmml"><mi id="A3.Ex6.m1.1.1.6.2" xref="A3.Ex6.m1.1.1.6.2.cmml">R</mi><mo id="A3.Ex6.m1.1.1.6.1" xref="A3.Ex6.m1.1.1.6.1.cmml">+</mo><mi id="A3.Ex6.m1.1.1.6.3" xref="A3.Ex6.m1.1.1.6.3.cmml">C</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.Ex6.m1.1b"><apply id="A3.Ex6.m1.1.1.cmml" xref="A3.Ex6.m1.1.1"><and id="A3.Ex6.m1.1.1a.cmml" xref="A3.Ex6.m1.1.1"></and><apply id="A3.Ex6.m1.1.1b.cmml" xref="A3.Ex6.m1.1.1"><leq id="A3.Ex6.m1.1.1.3.cmml" xref="A3.Ex6.m1.1.1.3"></leq><ci id="A3.Ex6.m1.1.1.2.cmml" xref="A3.Ex6.m1.1.1.2">𝑅</ci><apply id="A3.Ex6.m1.1.1.4.cmml" xref="A3.Ex6.m1.1.1.4"><plus id="A3.Ex6.m1.1.1.4.1.cmml" xref="A3.Ex6.m1.1.1.4.1"></plus><ci id="A3.Ex6.m1.1.1.4.2.cmml" xref="A3.Ex6.m1.1.1.4.2">𝑅</ci><apply id="A3.Ex6.m1.1.1.4.3.cmml" xref="A3.Ex6.m1.1.1.4.3"><times id="A3.Ex6.m1.1.1.4.3.1.cmml" xref="A3.Ex6.m1.1.1.4.3.1"></times><ci id="A3.Ex6.m1.1.1.4.3.2.cmml" xref="A3.Ex6.m1.1.1.4.3.2">𝛽</ci><apply id="A3.Ex6.m1.1.1.4.3.3.cmml" xref="A3.Ex6.m1.1.1.4.3.3"><csymbol cd="ambiguous" id="A3.Ex6.m1.1.1.4.3.3.1.cmml" xref="A3.Ex6.m1.1.1.4.3.3">subscript</csymbol><ci id="A3.Ex6.m1.1.1.4.3.3.2.cmml" xref="A3.Ex6.m1.1.1.4.3.3.2">𝑅</ci><ci id="A3.Ex6.m1.1.1.4.3.3.3.cmml" xref="A3.Ex6.m1.1.1.4.3.3.3">𝐼</ci></apply></apply></apply></apply><apply id="A3.Ex6.m1.1.1c.cmml" xref="A3.Ex6.m1.1.1"><leq id="A3.Ex6.m1.1.1.5.cmml" xref="A3.Ex6.m1.1.1.5"></leq><share href="https://arxiv.org/html/2410.04498v1#A3.Ex6.m1.1.1.4.cmml" id="A3.Ex6.m1.1.1d.cmml" xref="A3.Ex6.m1.1.1"></share><apply id="A3.Ex6.m1.1.1.6.cmml" xref="A3.Ex6.m1.1.1.6"><plus id="A3.Ex6.m1.1.1.6.1.cmml" xref="A3.Ex6.m1.1.1.6.1"></plus><ci id="A3.Ex6.m1.1.1.6.2.cmml" xref="A3.Ex6.m1.1.1.6.2">𝑅</ci><ci id="A3.Ex6.m1.1.1.6.3.cmml" xref="A3.Ex6.m1.1.1.6.3">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex6.m1.1c">R\leq R+\beta R_{I}\leq R+C</annotation><annotation encoding="application/x-llamapun" id="A3.Ex6.m1.1d">italic_R ≤ italic_R + italic_β italic_R start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT ≤ italic_R + italic_C</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A3.SS1.1.p1.12">Then</p>
<table class="ltx_equation ltx_eqn_table" id="A3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="Q^{*}(s,a)\triangleq\max_{\pi}\mathbb{E}_{\tau}\left[\sum_{t}\gamma^{t}R_{t}|s%
,a\right]\leq\max_{\pi}\mathbb{E}_{\tau}\left[\sum_{t}\gamma^{t}(R_{t}+\beta R%
_{I})|s,a\right]\triangleq Q_{1}^{*}(s,a)" class="ltx_Math" display="block" id="A3.E6.m1.10"><semantics id="A3.E6.m1.10a"><mrow id="A3.E6.m1.10.10" xref="A3.E6.m1.10.10.cmml"><mrow id="A3.E6.m1.10.10.4" xref="A3.E6.m1.10.10.4.cmml"><msup id="A3.E6.m1.10.10.4.2" xref="A3.E6.m1.10.10.4.2.cmml"><mi id="A3.E6.m1.10.10.4.2.2" xref="A3.E6.m1.10.10.4.2.2.cmml">Q</mi><mo id="A3.E6.m1.10.10.4.2.3" xref="A3.E6.m1.10.10.4.2.3.cmml">∗</mo></msup><mo id="A3.E6.m1.10.10.4.1" xref="A3.E6.m1.10.10.4.1.cmml">⁢</mo><mrow id="A3.E6.m1.10.10.4.3.2" xref="A3.E6.m1.10.10.4.3.1.cmml"><mo id="A3.E6.m1.10.10.4.3.2.1" stretchy="false" xref="A3.E6.m1.10.10.4.3.1.cmml">(</mo><mi id="A3.E6.m1.1.1" xref="A3.E6.m1.1.1.cmml">s</mi><mo id="A3.E6.m1.10.10.4.3.2.2" xref="A3.E6.m1.10.10.4.3.1.cmml">,</mo><mi id="A3.E6.m1.2.2" xref="A3.E6.m1.2.2.cmml">a</mi><mo id="A3.E6.m1.10.10.4.3.2.3" stretchy="false" xref="A3.E6.m1.10.10.4.3.1.cmml">)</mo></mrow></mrow><mo id="A3.E6.m1.10.10.5" xref="A3.E6.m1.10.10.5.cmml">≜</mo><mrow id="A3.E6.m1.9.9.1" xref="A3.E6.m1.9.9.1.cmml"><mrow id="A3.E6.m1.9.9.1.3" xref="A3.E6.m1.9.9.1.3.cmml"><munder id="A3.E6.m1.9.9.1.3.1" xref="A3.E6.m1.9.9.1.3.1.cmml"><mi id="A3.E6.m1.9.9.1.3.1.2" xref="A3.E6.m1.9.9.1.3.1.2.cmml">max</mi><mi id="A3.E6.m1.9.9.1.3.1.3" xref="A3.E6.m1.9.9.1.3.1.3.cmml">π</mi></munder><mo id="A3.E6.m1.9.9.1.3a" lspace="0.167em" xref="A3.E6.m1.9.9.1.3.cmml">⁡</mo><msub id="A3.E6.m1.9.9.1.3.2" xref="A3.E6.m1.9.9.1.3.2.cmml"><mi id="A3.E6.m1.9.9.1.3.2.2" xref="A3.E6.m1.9.9.1.3.2.2.cmml">𝔼</mi><mi id="A3.E6.m1.9.9.1.3.2.3" xref="A3.E6.m1.9.9.1.3.2.3.cmml">τ</mi></msub></mrow><mo id="A3.E6.m1.9.9.1.2" xref="A3.E6.m1.9.9.1.2.cmml">⁢</mo><mrow id="A3.E6.m1.9.9.1.1.1" xref="A3.E6.m1.9.9.1.1.2.cmml"><mo id="A3.E6.m1.9.9.1.1.1.2" xref="A3.E6.m1.9.9.1.1.2.1.cmml">[</mo><mrow id="A3.E6.m1.9.9.1.1.1.1" xref="A3.E6.m1.9.9.1.1.1.1.cmml"><mrow id="A3.E6.m1.9.9.1.1.1.1.2" xref="A3.E6.m1.9.9.1.1.1.1.2.cmml"><munder id="A3.E6.m1.9.9.1.1.1.1.2.1" xref="A3.E6.m1.9.9.1.1.1.1.2.1.cmml"><mo id="A3.E6.m1.9.9.1.1.1.1.2.1.2" lspace="0em" movablelimits="false" xref="A3.E6.m1.9.9.1.1.1.1.2.1.2.cmml">∑</mo><mi id="A3.E6.m1.9.9.1.1.1.1.2.1.3" xref="A3.E6.m1.9.9.1.1.1.1.2.1.3.cmml">t</mi></munder><mrow id="A3.E6.m1.9.9.1.1.1.1.2.2" xref="A3.E6.m1.9.9.1.1.1.1.2.2.cmml"><msup id="A3.E6.m1.9.9.1.1.1.1.2.2.2" xref="A3.E6.m1.9.9.1.1.1.1.2.2.2.cmml"><mi id="A3.E6.m1.9.9.1.1.1.1.2.2.2.2" xref="A3.E6.m1.9.9.1.1.1.1.2.2.2.2.cmml">γ</mi><mi id="A3.E6.m1.9.9.1.1.1.1.2.2.2.3" xref="A3.E6.m1.9.9.1.1.1.1.2.2.2.3.cmml">t</mi></msup><mo id="A3.E6.m1.9.9.1.1.1.1.2.2.1" xref="A3.E6.m1.9.9.1.1.1.1.2.2.1.cmml">⁢</mo><msub id="A3.E6.m1.9.9.1.1.1.1.2.2.3" xref="A3.E6.m1.9.9.1.1.1.1.2.2.3.cmml"><mi id="A3.E6.m1.9.9.1.1.1.1.2.2.3.2" xref="A3.E6.m1.9.9.1.1.1.1.2.2.3.2.cmml">R</mi><mi id="A3.E6.m1.9.9.1.1.1.1.2.2.3.3" xref="A3.E6.m1.9.9.1.1.1.1.2.2.3.3.cmml">t</mi></msub></mrow></mrow><mo fence="false" id="A3.E6.m1.9.9.1.1.1.1.1" xref="A3.E6.m1.9.9.1.1.1.1.1.cmml">|</mo><mrow id="A3.E6.m1.9.9.1.1.1.1.3.2" xref="A3.E6.m1.9.9.1.1.1.1.3.1.cmml"><mi id="A3.E6.m1.3.3" xref="A3.E6.m1.3.3.cmml">s</mi><mo id="A3.E6.m1.9.9.1.1.1.1.3.2.1" xref="A3.E6.m1.9.9.1.1.1.1.3.1.cmml">,</mo><mi id="A3.E6.m1.4.4" xref="A3.E6.m1.4.4.cmml">a</mi></mrow></mrow><mo id="A3.E6.m1.9.9.1.1.1.3" xref="A3.E6.m1.9.9.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="A3.E6.m1.10.10.6" xref="A3.E6.m1.10.10.6.cmml">≤</mo><mrow id="A3.E6.m1.10.10.2" xref="A3.E6.m1.10.10.2.cmml"><mrow id="A3.E6.m1.10.10.2.3" xref="A3.E6.m1.10.10.2.3.cmml"><munder id="A3.E6.m1.10.10.2.3.1" xref="A3.E6.m1.10.10.2.3.1.cmml"><mi id="A3.E6.m1.10.10.2.3.1.2" xref="A3.E6.m1.10.10.2.3.1.2.cmml">max</mi><mi id="A3.E6.m1.10.10.2.3.1.3" xref="A3.E6.m1.10.10.2.3.1.3.cmml">π</mi></munder><mo id="A3.E6.m1.10.10.2.3a" lspace="0.167em" xref="A3.E6.m1.10.10.2.3.cmml">⁡</mo><msub id="A3.E6.m1.10.10.2.3.2" xref="A3.E6.m1.10.10.2.3.2.cmml"><mi id="A3.E6.m1.10.10.2.3.2.2" xref="A3.E6.m1.10.10.2.3.2.2.cmml">𝔼</mi><mi id="A3.E6.m1.10.10.2.3.2.3" xref="A3.E6.m1.10.10.2.3.2.3.cmml">τ</mi></msub></mrow><mo id="A3.E6.m1.10.10.2.2" xref="A3.E6.m1.10.10.2.2.cmml">⁢</mo><mrow id="A3.E6.m1.10.10.2.1.1" xref="A3.E6.m1.10.10.2.1.2.cmml"><mo id="A3.E6.m1.10.10.2.1.1.2" xref="A3.E6.m1.10.10.2.1.2.1.cmml">[</mo><mrow id="A3.E6.m1.10.10.2.1.1.1" xref="A3.E6.m1.10.10.2.1.1.1.cmml"><mrow id="A3.E6.m1.10.10.2.1.1.1.1" xref="A3.E6.m1.10.10.2.1.1.1.1.cmml"><munder id="A3.E6.m1.10.10.2.1.1.1.1.2" xref="A3.E6.m1.10.10.2.1.1.1.1.2.cmml"><mo id="A3.E6.m1.10.10.2.1.1.1.1.2.2" lspace="0em" movablelimits="false" xref="A3.E6.m1.10.10.2.1.1.1.1.2.2.cmml">∑</mo><mi id="A3.E6.m1.10.10.2.1.1.1.1.2.3" xref="A3.E6.m1.10.10.2.1.1.1.1.2.3.cmml">t</mi></munder><mrow id="A3.E6.m1.10.10.2.1.1.1.1.1" xref="A3.E6.m1.10.10.2.1.1.1.1.1.cmml"><msup id="A3.E6.m1.10.10.2.1.1.1.1.1.3" xref="A3.E6.m1.10.10.2.1.1.1.1.1.3.cmml"><mi id="A3.E6.m1.10.10.2.1.1.1.1.1.3.2" xref="A3.E6.m1.10.10.2.1.1.1.1.1.3.2.cmml">γ</mi><mi id="A3.E6.m1.10.10.2.1.1.1.1.1.3.3" xref="A3.E6.m1.10.10.2.1.1.1.1.1.3.3.cmml">t</mi></msup><mo id="A3.E6.m1.10.10.2.1.1.1.1.1.2" xref="A3.E6.m1.10.10.2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A3.E6.m1.10.10.2.1.1.1.1.1.1.1" xref="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.cmml"><mo id="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.2" stretchy="false" xref="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1" xref="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.cmml"><msub id="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.2" xref="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.2.cmml"><mi id="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.2.2" xref="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.2.2.cmml">R</mi><mi id="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.2.3" xref="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo id="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.1" xref="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.3" xref="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.3.2" xref="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.3.2.cmml">β</mi><mo id="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.3.1" xref="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.3.3" xref="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.3.3.2" xref="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.3.3.2.cmml">R</mi><mi id="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.3.3.3" xref="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.3.3.3.cmml">I</mi></msub></mrow></mrow><mo id="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.3" stretchy="false" xref="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo fence="false" id="A3.E6.m1.10.10.2.1.1.1.2" xref="A3.E6.m1.10.10.2.1.1.1.2.cmml">|</mo><mrow id="A3.E6.m1.10.10.2.1.1.1.3.2" xref="A3.E6.m1.10.10.2.1.1.1.3.1.cmml"><mi id="A3.E6.m1.5.5" xref="A3.E6.m1.5.5.cmml">s</mi><mo id="A3.E6.m1.10.10.2.1.1.1.3.2.1" xref="A3.E6.m1.10.10.2.1.1.1.3.1.cmml">,</mo><mi id="A3.E6.m1.6.6" xref="A3.E6.m1.6.6.cmml">a</mi></mrow></mrow><mo id="A3.E6.m1.10.10.2.1.1.3" xref="A3.E6.m1.10.10.2.1.2.1.cmml">]</mo></mrow></mrow><mo id="A3.E6.m1.10.10.7" xref="A3.E6.m1.10.10.7.cmml">≜</mo><mrow id="A3.E6.m1.10.10.8" xref="A3.E6.m1.10.10.8.cmml"><msubsup id="A3.E6.m1.10.10.8.2" xref="A3.E6.m1.10.10.8.2.cmml"><mi id="A3.E6.m1.10.10.8.2.2.2" xref="A3.E6.m1.10.10.8.2.2.2.cmml">Q</mi><mn id="A3.E6.m1.10.10.8.2.2.3" xref="A3.E6.m1.10.10.8.2.2.3.cmml">1</mn><mo id="A3.E6.m1.10.10.8.2.3" xref="A3.E6.m1.10.10.8.2.3.cmml">∗</mo></msubsup><mo id="A3.E6.m1.10.10.8.1" xref="A3.E6.m1.10.10.8.1.cmml">⁢</mo><mrow id="A3.E6.m1.10.10.8.3.2" xref="A3.E6.m1.10.10.8.3.1.cmml"><mo id="A3.E6.m1.10.10.8.3.2.1" stretchy="false" xref="A3.E6.m1.10.10.8.3.1.cmml">(</mo><mi id="A3.E6.m1.7.7" xref="A3.E6.m1.7.7.cmml">s</mi><mo id="A3.E6.m1.10.10.8.3.2.2" xref="A3.E6.m1.10.10.8.3.1.cmml">,</mo><mi id="A3.E6.m1.8.8" xref="A3.E6.m1.8.8.cmml">a</mi><mo id="A3.E6.m1.10.10.8.3.2.3" stretchy="false" xref="A3.E6.m1.10.10.8.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.E6.m1.10b"><apply id="A3.E6.m1.10.10.cmml" xref="A3.E6.m1.10.10"><and id="A3.E6.m1.10.10a.cmml" xref="A3.E6.m1.10.10"></and><apply id="A3.E6.m1.10.10b.cmml" xref="A3.E6.m1.10.10"><ci id="A3.E6.m1.10.10.5.cmml" xref="A3.E6.m1.10.10.5">≜</ci><apply id="A3.E6.m1.10.10.4.cmml" xref="A3.E6.m1.10.10.4"><times id="A3.E6.m1.10.10.4.1.cmml" xref="A3.E6.m1.10.10.4.1"></times><apply id="A3.E6.m1.10.10.4.2.cmml" xref="A3.E6.m1.10.10.4.2"><csymbol cd="ambiguous" id="A3.E6.m1.10.10.4.2.1.cmml" xref="A3.E6.m1.10.10.4.2">superscript</csymbol><ci id="A3.E6.m1.10.10.4.2.2.cmml" xref="A3.E6.m1.10.10.4.2.2">𝑄</ci><times id="A3.E6.m1.10.10.4.2.3.cmml" xref="A3.E6.m1.10.10.4.2.3"></times></apply><interval closure="open" id="A3.E6.m1.10.10.4.3.1.cmml" xref="A3.E6.m1.10.10.4.3.2"><ci id="A3.E6.m1.1.1.cmml" xref="A3.E6.m1.1.1">𝑠</ci><ci id="A3.E6.m1.2.2.cmml" xref="A3.E6.m1.2.2">𝑎</ci></interval></apply><apply id="A3.E6.m1.9.9.1.cmml" xref="A3.E6.m1.9.9.1"><times id="A3.E6.m1.9.9.1.2.cmml" xref="A3.E6.m1.9.9.1.2"></times><apply id="A3.E6.m1.9.9.1.3.cmml" xref="A3.E6.m1.9.9.1.3"><apply id="A3.E6.m1.9.9.1.3.1.cmml" xref="A3.E6.m1.9.9.1.3.1"><csymbol cd="ambiguous" id="A3.E6.m1.9.9.1.3.1.1.cmml" xref="A3.E6.m1.9.9.1.3.1">subscript</csymbol><max id="A3.E6.m1.9.9.1.3.1.2.cmml" xref="A3.E6.m1.9.9.1.3.1.2"></max><ci id="A3.E6.m1.9.9.1.3.1.3.cmml" xref="A3.E6.m1.9.9.1.3.1.3">𝜋</ci></apply><apply id="A3.E6.m1.9.9.1.3.2.cmml" xref="A3.E6.m1.9.9.1.3.2"><csymbol cd="ambiguous" id="A3.E6.m1.9.9.1.3.2.1.cmml" xref="A3.E6.m1.9.9.1.3.2">subscript</csymbol><ci id="A3.E6.m1.9.9.1.3.2.2.cmml" xref="A3.E6.m1.9.9.1.3.2.2">𝔼</ci><ci id="A3.E6.m1.9.9.1.3.2.3.cmml" xref="A3.E6.m1.9.9.1.3.2.3">𝜏</ci></apply></apply><apply id="A3.E6.m1.9.9.1.1.2.cmml" xref="A3.E6.m1.9.9.1.1.1"><csymbol cd="latexml" id="A3.E6.m1.9.9.1.1.2.1.cmml" xref="A3.E6.m1.9.9.1.1.1.2">delimited-[]</csymbol><apply id="A3.E6.m1.9.9.1.1.1.1.cmml" xref="A3.E6.m1.9.9.1.1.1.1"><csymbol cd="latexml" id="A3.E6.m1.9.9.1.1.1.1.1.cmml" xref="A3.E6.m1.9.9.1.1.1.1.1">conditional</csymbol><apply id="A3.E6.m1.9.9.1.1.1.1.2.cmml" xref="A3.E6.m1.9.9.1.1.1.1.2"><apply id="A3.E6.m1.9.9.1.1.1.1.2.1.cmml" xref="A3.E6.m1.9.9.1.1.1.1.2.1"><csymbol cd="ambiguous" id="A3.E6.m1.9.9.1.1.1.1.2.1.1.cmml" xref="A3.E6.m1.9.9.1.1.1.1.2.1">subscript</csymbol><sum id="A3.E6.m1.9.9.1.1.1.1.2.1.2.cmml" xref="A3.E6.m1.9.9.1.1.1.1.2.1.2"></sum><ci id="A3.E6.m1.9.9.1.1.1.1.2.1.3.cmml" xref="A3.E6.m1.9.9.1.1.1.1.2.1.3">𝑡</ci></apply><apply id="A3.E6.m1.9.9.1.1.1.1.2.2.cmml" xref="A3.E6.m1.9.9.1.1.1.1.2.2"><times id="A3.E6.m1.9.9.1.1.1.1.2.2.1.cmml" xref="A3.E6.m1.9.9.1.1.1.1.2.2.1"></times><apply id="A3.E6.m1.9.9.1.1.1.1.2.2.2.cmml" xref="A3.E6.m1.9.9.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A3.E6.m1.9.9.1.1.1.1.2.2.2.1.cmml" xref="A3.E6.m1.9.9.1.1.1.1.2.2.2">superscript</csymbol><ci id="A3.E6.m1.9.9.1.1.1.1.2.2.2.2.cmml" xref="A3.E6.m1.9.9.1.1.1.1.2.2.2.2">𝛾</ci><ci id="A3.E6.m1.9.9.1.1.1.1.2.2.2.3.cmml" xref="A3.E6.m1.9.9.1.1.1.1.2.2.2.3">𝑡</ci></apply><apply id="A3.E6.m1.9.9.1.1.1.1.2.2.3.cmml" xref="A3.E6.m1.9.9.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="A3.E6.m1.9.9.1.1.1.1.2.2.3.1.cmml" xref="A3.E6.m1.9.9.1.1.1.1.2.2.3">subscript</csymbol><ci id="A3.E6.m1.9.9.1.1.1.1.2.2.3.2.cmml" xref="A3.E6.m1.9.9.1.1.1.1.2.2.3.2">𝑅</ci><ci id="A3.E6.m1.9.9.1.1.1.1.2.2.3.3.cmml" xref="A3.E6.m1.9.9.1.1.1.1.2.2.3.3">𝑡</ci></apply></apply></apply><list id="A3.E6.m1.9.9.1.1.1.1.3.1.cmml" xref="A3.E6.m1.9.9.1.1.1.1.3.2"><ci id="A3.E6.m1.3.3.cmml" xref="A3.E6.m1.3.3">𝑠</ci><ci id="A3.E6.m1.4.4.cmml" xref="A3.E6.m1.4.4">𝑎</ci></list></apply></apply></apply></apply><apply id="A3.E6.m1.10.10c.cmml" xref="A3.E6.m1.10.10"><leq id="A3.E6.m1.10.10.6.cmml" xref="A3.E6.m1.10.10.6"></leq><share href="https://arxiv.org/html/2410.04498v1#A3.E6.m1.9.9.1.cmml" id="A3.E6.m1.10.10d.cmml" xref="A3.E6.m1.10.10"></share><apply id="A3.E6.m1.10.10.2.cmml" xref="A3.E6.m1.10.10.2"><times id="A3.E6.m1.10.10.2.2.cmml" xref="A3.E6.m1.10.10.2.2"></times><apply id="A3.E6.m1.10.10.2.3.cmml" xref="A3.E6.m1.10.10.2.3"><apply id="A3.E6.m1.10.10.2.3.1.cmml" xref="A3.E6.m1.10.10.2.3.1"><csymbol cd="ambiguous" id="A3.E6.m1.10.10.2.3.1.1.cmml" xref="A3.E6.m1.10.10.2.3.1">subscript</csymbol><max id="A3.E6.m1.10.10.2.3.1.2.cmml" xref="A3.E6.m1.10.10.2.3.1.2"></max><ci id="A3.E6.m1.10.10.2.3.1.3.cmml" xref="A3.E6.m1.10.10.2.3.1.3">𝜋</ci></apply><apply id="A3.E6.m1.10.10.2.3.2.cmml" xref="A3.E6.m1.10.10.2.3.2"><csymbol cd="ambiguous" id="A3.E6.m1.10.10.2.3.2.1.cmml" xref="A3.E6.m1.10.10.2.3.2">subscript</csymbol><ci id="A3.E6.m1.10.10.2.3.2.2.cmml" xref="A3.E6.m1.10.10.2.3.2.2">𝔼</ci><ci id="A3.E6.m1.10.10.2.3.2.3.cmml" xref="A3.E6.m1.10.10.2.3.2.3">𝜏</ci></apply></apply><apply id="A3.E6.m1.10.10.2.1.2.cmml" xref="A3.E6.m1.10.10.2.1.1"><csymbol cd="latexml" id="A3.E6.m1.10.10.2.1.2.1.cmml" xref="A3.E6.m1.10.10.2.1.1.2">delimited-[]</csymbol><apply id="A3.E6.m1.10.10.2.1.1.1.cmml" xref="A3.E6.m1.10.10.2.1.1.1"><csymbol cd="latexml" id="A3.E6.m1.10.10.2.1.1.1.2.cmml" xref="A3.E6.m1.10.10.2.1.1.1.2">conditional</csymbol><apply id="A3.E6.m1.10.10.2.1.1.1.1.cmml" xref="A3.E6.m1.10.10.2.1.1.1.1"><apply id="A3.E6.m1.10.10.2.1.1.1.1.2.cmml" xref="A3.E6.m1.10.10.2.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.E6.m1.10.10.2.1.1.1.1.2.1.cmml" xref="A3.E6.m1.10.10.2.1.1.1.1.2">subscript</csymbol><sum id="A3.E6.m1.10.10.2.1.1.1.1.2.2.cmml" xref="A3.E6.m1.10.10.2.1.1.1.1.2.2"></sum><ci id="A3.E6.m1.10.10.2.1.1.1.1.2.3.cmml" xref="A3.E6.m1.10.10.2.1.1.1.1.2.3">𝑡</ci></apply><apply id="A3.E6.m1.10.10.2.1.1.1.1.1.cmml" xref="A3.E6.m1.10.10.2.1.1.1.1.1"><times id="A3.E6.m1.10.10.2.1.1.1.1.1.2.cmml" xref="A3.E6.m1.10.10.2.1.1.1.1.1.2"></times><apply id="A3.E6.m1.10.10.2.1.1.1.1.1.3.cmml" xref="A3.E6.m1.10.10.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E6.m1.10.10.2.1.1.1.1.1.3.1.cmml" xref="A3.E6.m1.10.10.2.1.1.1.1.1.3">superscript</csymbol><ci id="A3.E6.m1.10.10.2.1.1.1.1.1.3.2.cmml" xref="A3.E6.m1.10.10.2.1.1.1.1.1.3.2">𝛾</ci><ci id="A3.E6.m1.10.10.2.1.1.1.1.1.3.3.cmml" xref="A3.E6.m1.10.10.2.1.1.1.1.1.3.3">𝑡</ci></apply><apply id="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.cmml" xref="A3.E6.m1.10.10.2.1.1.1.1.1.1.1"><plus id="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.1"></plus><apply id="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.2.2">𝑅</ci><ci id="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.3.cmml" xref="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.3"><times id="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.3.1"></times><ci id="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.3.2">𝛽</ci><apply id="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.3.3.2">𝑅</ci><ci id="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="A3.E6.m1.10.10.2.1.1.1.1.1.1.1.1.3.3.3">𝐼</ci></apply></apply></apply></apply></apply><list id="A3.E6.m1.10.10.2.1.1.1.3.1.cmml" xref="A3.E6.m1.10.10.2.1.1.1.3.2"><ci id="A3.E6.m1.5.5.cmml" xref="A3.E6.m1.5.5">𝑠</ci><ci id="A3.E6.m1.6.6.cmml" xref="A3.E6.m1.6.6">𝑎</ci></list></apply></apply></apply></apply><apply id="A3.E6.m1.10.10e.cmml" xref="A3.E6.m1.10.10"><ci id="A3.E6.m1.10.10.7.cmml" xref="A3.E6.m1.10.10.7">≜</ci><share href="https://arxiv.org/html/2410.04498v1#A3.E6.m1.10.10.2.cmml" id="A3.E6.m1.10.10f.cmml" xref="A3.E6.m1.10.10"></share><apply id="A3.E6.m1.10.10.8.cmml" xref="A3.E6.m1.10.10.8"><times id="A3.E6.m1.10.10.8.1.cmml" xref="A3.E6.m1.10.10.8.1"></times><apply id="A3.E6.m1.10.10.8.2.cmml" xref="A3.E6.m1.10.10.8.2"><csymbol cd="ambiguous" id="A3.E6.m1.10.10.8.2.1.cmml" xref="A3.E6.m1.10.10.8.2">superscript</csymbol><apply id="A3.E6.m1.10.10.8.2.2.cmml" xref="A3.E6.m1.10.10.8.2"><csymbol cd="ambiguous" id="A3.E6.m1.10.10.8.2.2.1.cmml" xref="A3.E6.m1.10.10.8.2">subscript</csymbol><ci id="A3.E6.m1.10.10.8.2.2.2.cmml" xref="A3.E6.m1.10.10.8.2.2.2">𝑄</ci><cn id="A3.E6.m1.10.10.8.2.2.3.cmml" type="integer" xref="A3.E6.m1.10.10.8.2.2.3">1</cn></apply><times id="A3.E6.m1.10.10.8.2.3.cmml" xref="A3.E6.m1.10.10.8.2.3"></times></apply><interval closure="open" id="A3.E6.m1.10.10.8.3.1.cmml" xref="A3.E6.m1.10.10.8.3.2"><ci id="A3.E6.m1.7.7.cmml" xref="A3.E6.m1.7.7">𝑠</ci><ci id="A3.E6.m1.8.8.cmml" xref="A3.E6.m1.8.8">𝑎</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E6.m1.10c">Q^{*}(s,a)\triangleq\max_{\pi}\mathbb{E}_{\tau}\left[\sum_{t}\gamma^{t}R_{t}|s%
,a\right]\leq\max_{\pi}\mathbb{E}_{\tau}\left[\sum_{t}\gamma^{t}(R_{t}+\beta R%
_{I})|s,a\right]\triangleq Q_{1}^{*}(s,a)</annotation><annotation encoding="application/x-llamapun" id="A3.E6.m1.10d">italic_Q start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s , italic_a ) ≜ roman_max start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT blackboard_E start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT [ ∑ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_γ start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT italic_R start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_s , italic_a ] ≤ roman_max start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT blackboard_E start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT [ ∑ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_γ start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ( italic_R start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + italic_β italic_R start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT ) | italic_s , italic_a ] ≜ italic_Q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s , italic_a )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A3.SS1.1.p1.13">and</p>
<table class="ltx_equation ltx_eqn_table" id="A3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="Q_{1}^{*}(s,a)=\max_{\pi}\mathbb{E}_{\tau}\left[\sum_{t}\gamma^{t}(R_{t}+\beta
R%
_{I})|s,a\right]\leq\max_{\pi}\mathbb{E}_{\tau}\left[\sum_{t}\gamma^{t}(R_{t}+%
C)|s,a\right]\triangleq\hat{Q}^{*}(s,a)" class="ltx_Math" display="block" id="A3.E7.m1.10"><semantics id="A3.E7.m1.10a"><mrow id="A3.E7.m1.10.10" xref="A3.E7.m1.10.10.cmml"><mrow id="A3.E7.m1.10.10.4" xref="A3.E7.m1.10.10.4.cmml"><msubsup id="A3.E7.m1.10.10.4.2" xref="A3.E7.m1.10.10.4.2.cmml"><mi id="A3.E7.m1.10.10.4.2.2.2" xref="A3.E7.m1.10.10.4.2.2.2.cmml">Q</mi><mn id="A3.E7.m1.10.10.4.2.2.3" xref="A3.E7.m1.10.10.4.2.2.3.cmml">1</mn><mo id="A3.E7.m1.10.10.4.2.3" xref="A3.E7.m1.10.10.4.2.3.cmml">∗</mo></msubsup><mo id="A3.E7.m1.10.10.4.1" xref="A3.E7.m1.10.10.4.1.cmml">⁢</mo><mrow id="A3.E7.m1.10.10.4.3.2" xref="A3.E7.m1.10.10.4.3.1.cmml"><mo id="A3.E7.m1.10.10.4.3.2.1" stretchy="false" xref="A3.E7.m1.10.10.4.3.1.cmml">(</mo><mi id="A3.E7.m1.1.1" xref="A3.E7.m1.1.1.cmml">s</mi><mo id="A3.E7.m1.10.10.4.3.2.2" xref="A3.E7.m1.10.10.4.3.1.cmml">,</mo><mi id="A3.E7.m1.2.2" xref="A3.E7.m1.2.2.cmml">a</mi><mo id="A3.E7.m1.10.10.4.3.2.3" stretchy="false" xref="A3.E7.m1.10.10.4.3.1.cmml">)</mo></mrow></mrow><mo id="A3.E7.m1.10.10.5" xref="A3.E7.m1.10.10.5.cmml">=</mo><mrow id="A3.E7.m1.9.9.1" xref="A3.E7.m1.9.9.1.cmml"><mrow id="A3.E7.m1.9.9.1.3" xref="A3.E7.m1.9.9.1.3.cmml"><munder id="A3.E7.m1.9.9.1.3.1" xref="A3.E7.m1.9.9.1.3.1.cmml"><mi id="A3.E7.m1.9.9.1.3.1.2" xref="A3.E7.m1.9.9.1.3.1.2.cmml">max</mi><mi id="A3.E7.m1.9.9.1.3.1.3" xref="A3.E7.m1.9.9.1.3.1.3.cmml">π</mi></munder><mo id="A3.E7.m1.9.9.1.3a" lspace="0.167em" xref="A3.E7.m1.9.9.1.3.cmml">⁡</mo><msub id="A3.E7.m1.9.9.1.3.2" xref="A3.E7.m1.9.9.1.3.2.cmml"><mi id="A3.E7.m1.9.9.1.3.2.2" xref="A3.E7.m1.9.9.1.3.2.2.cmml">𝔼</mi><mi id="A3.E7.m1.9.9.1.3.2.3" xref="A3.E7.m1.9.9.1.3.2.3.cmml">τ</mi></msub></mrow><mo id="A3.E7.m1.9.9.1.2" xref="A3.E7.m1.9.9.1.2.cmml">⁢</mo><mrow id="A3.E7.m1.9.9.1.1.1" xref="A3.E7.m1.9.9.1.1.2.cmml"><mo id="A3.E7.m1.9.9.1.1.1.2" xref="A3.E7.m1.9.9.1.1.2.1.cmml">[</mo><mrow id="A3.E7.m1.9.9.1.1.1.1" xref="A3.E7.m1.9.9.1.1.1.1.cmml"><mrow id="A3.E7.m1.9.9.1.1.1.1.1" xref="A3.E7.m1.9.9.1.1.1.1.1.cmml"><munder id="A3.E7.m1.9.9.1.1.1.1.1.2" xref="A3.E7.m1.9.9.1.1.1.1.1.2.cmml"><mo id="A3.E7.m1.9.9.1.1.1.1.1.2.2" lspace="0em" movablelimits="false" xref="A3.E7.m1.9.9.1.1.1.1.1.2.2.cmml">∑</mo><mi id="A3.E7.m1.9.9.1.1.1.1.1.2.3" xref="A3.E7.m1.9.9.1.1.1.1.1.2.3.cmml">t</mi></munder><mrow id="A3.E7.m1.9.9.1.1.1.1.1.1" xref="A3.E7.m1.9.9.1.1.1.1.1.1.cmml"><msup id="A3.E7.m1.9.9.1.1.1.1.1.1.3" xref="A3.E7.m1.9.9.1.1.1.1.1.1.3.cmml"><mi id="A3.E7.m1.9.9.1.1.1.1.1.1.3.2" xref="A3.E7.m1.9.9.1.1.1.1.1.1.3.2.cmml">γ</mi><mi id="A3.E7.m1.9.9.1.1.1.1.1.1.3.3" xref="A3.E7.m1.9.9.1.1.1.1.1.1.3.3.cmml">t</mi></msup><mo id="A3.E7.m1.9.9.1.1.1.1.1.1.2" xref="A3.E7.m1.9.9.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A3.E7.m1.9.9.1.1.1.1.1.1.1.1" xref="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.cmml"><mo id="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1" xref="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.cmml"><msub id="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.2" xref="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.2.2" xref="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.cmml">R</mi><mi id="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.2.3" xref="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo id="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.1" xref="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.3" xref="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.3.2" xref="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.3.2.cmml">β</mi><mo id="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.3.1" xref="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.3.3" xref="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.3.3.2" xref="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.3.3.2.cmml">R</mi><mi id="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.3.3.3" xref="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.3.3.3.cmml">I</mi></msub></mrow></mrow><mo id="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo fence="false" id="A3.E7.m1.9.9.1.1.1.1.2" xref="A3.E7.m1.9.9.1.1.1.1.2.cmml">|</mo><mrow id="A3.E7.m1.9.9.1.1.1.1.3.2" xref="A3.E7.m1.9.9.1.1.1.1.3.1.cmml"><mi id="A3.E7.m1.3.3" xref="A3.E7.m1.3.3.cmml">s</mi><mo id="A3.E7.m1.9.9.1.1.1.1.3.2.1" xref="A3.E7.m1.9.9.1.1.1.1.3.1.cmml">,</mo><mi id="A3.E7.m1.4.4" xref="A3.E7.m1.4.4.cmml">a</mi></mrow></mrow><mo id="A3.E7.m1.9.9.1.1.1.3" xref="A3.E7.m1.9.9.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="A3.E7.m1.10.10.6" xref="A3.E7.m1.10.10.6.cmml">≤</mo><mrow id="A3.E7.m1.10.10.2" xref="A3.E7.m1.10.10.2.cmml"><mrow id="A3.E7.m1.10.10.2.3" xref="A3.E7.m1.10.10.2.3.cmml"><munder id="A3.E7.m1.10.10.2.3.1" xref="A3.E7.m1.10.10.2.3.1.cmml"><mi id="A3.E7.m1.10.10.2.3.1.2" xref="A3.E7.m1.10.10.2.3.1.2.cmml">max</mi><mi id="A3.E7.m1.10.10.2.3.1.3" xref="A3.E7.m1.10.10.2.3.1.3.cmml">π</mi></munder><mo id="A3.E7.m1.10.10.2.3a" lspace="0.167em" xref="A3.E7.m1.10.10.2.3.cmml">⁡</mo><msub id="A3.E7.m1.10.10.2.3.2" xref="A3.E7.m1.10.10.2.3.2.cmml"><mi id="A3.E7.m1.10.10.2.3.2.2" xref="A3.E7.m1.10.10.2.3.2.2.cmml">𝔼</mi><mi id="A3.E7.m1.10.10.2.3.2.3" xref="A3.E7.m1.10.10.2.3.2.3.cmml">τ</mi></msub></mrow><mo id="A3.E7.m1.10.10.2.2" xref="A3.E7.m1.10.10.2.2.cmml">⁢</mo><mrow id="A3.E7.m1.10.10.2.1.1" xref="A3.E7.m1.10.10.2.1.2.cmml"><mo id="A3.E7.m1.10.10.2.1.1.2" xref="A3.E7.m1.10.10.2.1.2.1.cmml">[</mo><mrow id="A3.E7.m1.10.10.2.1.1.1" xref="A3.E7.m1.10.10.2.1.1.1.cmml"><mrow id="A3.E7.m1.10.10.2.1.1.1.1" xref="A3.E7.m1.10.10.2.1.1.1.1.cmml"><munder id="A3.E7.m1.10.10.2.1.1.1.1.2" xref="A3.E7.m1.10.10.2.1.1.1.1.2.cmml"><mo id="A3.E7.m1.10.10.2.1.1.1.1.2.2" lspace="0em" movablelimits="false" xref="A3.E7.m1.10.10.2.1.1.1.1.2.2.cmml">∑</mo><mi id="A3.E7.m1.10.10.2.1.1.1.1.2.3" xref="A3.E7.m1.10.10.2.1.1.1.1.2.3.cmml">t</mi></munder><mrow id="A3.E7.m1.10.10.2.1.1.1.1.1" xref="A3.E7.m1.10.10.2.1.1.1.1.1.cmml"><msup id="A3.E7.m1.10.10.2.1.1.1.1.1.3" xref="A3.E7.m1.10.10.2.1.1.1.1.1.3.cmml"><mi id="A3.E7.m1.10.10.2.1.1.1.1.1.3.2" xref="A3.E7.m1.10.10.2.1.1.1.1.1.3.2.cmml">γ</mi><mi id="A3.E7.m1.10.10.2.1.1.1.1.1.3.3" xref="A3.E7.m1.10.10.2.1.1.1.1.1.3.3.cmml">t</mi></msup><mo id="A3.E7.m1.10.10.2.1.1.1.1.1.2" xref="A3.E7.m1.10.10.2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A3.E7.m1.10.10.2.1.1.1.1.1.1.1" xref="A3.E7.m1.10.10.2.1.1.1.1.1.1.1.1.cmml"><mo id="A3.E7.m1.10.10.2.1.1.1.1.1.1.1.2" stretchy="false" xref="A3.E7.m1.10.10.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A3.E7.m1.10.10.2.1.1.1.1.1.1.1.1" xref="A3.E7.m1.10.10.2.1.1.1.1.1.1.1.1.cmml"><msub id="A3.E7.m1.10.10.2.1.1.1.1.1.1.1.1.2" xref="A3.E7.m1.10.10.2.1.1.1.1.1.1.1.1.2.cmml"><mi id="A3.E7.m1.10.10.2.1.1.1.1.1.1.1.1.2.2" xref="A3.E7.m1.10.10.2.1.1.1.1.1.1.1.1.2.2.cmml">R</mi><mi id="A3.E7.m1.10.10.2.1.1.1.1.1.1.1.1.2.3" xref="A3.E7.m1.10.10.2.1.1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo id="A3.E7.m1.10.10.2.1.1.1.1.1.1.1.1.1" xref="A3.E7.m1.10.10.2.1.1.1.1.1.1.1.1.1.cmml">+</mo><mi id="A3.E7.m1.10.10.2.1.1.1.1.1.1.1.1.3" xref="A3.E7.m1.10.10.2.1.1.1.1.1.1.1.1.3.cmml">C</mi></mrow><mo id="A3.E7.m1.10.10.2.1.1.1.1.1.1.1.3" stretchy="false" xref="A3.E7.m1.10.10.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo fence="false" id="A3.E7.m1.10.10.2.1.1.1.2" xref="A3.E7.m1.10.10.2.1.1.1.2.cmml">|</mo><mrow id="A3.E7.m1.10.10.2.1.1.1.3.2" xref="A3.E7.m1.10.10.2.1.1.1.3.1.cmml"><mi id="A3.E7.m1.5.5" xref="A3.E7.m1.5.5.cmml">s</mi><mo id="A3.E7.m1.10.10.2.1.1.1.3.2.1" xref="A3.E7.m1.10.10.2.1.1.1.3.1.cmml">,</mo><mi id="A3.E7.m1.6.6" xref="A3.E7.m1.6.6.cmml">a</mi></mrow></mrow><mo id="A3.E7.m1.10.10.2.1.1.3" xref="A3.E7.m1.10.10.2.1.2.1.cmml">]</mo></mrow></mrow><mo id="A3.E7.m1.10.10.7" xref="A3.E7.m1.10.10.7.cmml">≜</mo><mrow id="A3.E7.m1.10.10.8" xref="A3.E7.m1.10.10.8.cmml"><msup id="A3.E7.m1.10.10.8.2" xref="A3.E7.m1.10.10.8.2.cmml"><mover accent="true" id="A3.E7.m1.10.10.8.2.2" xref="A3.E7.m1.10.10.8.2.2.cmml"><mi id="A3.E7.m1.10.10.8.2.2.2" xref="A3.E7.m1.10.10.8.2.2.2.cmml">Q</mi><mo id="A3.E7.m1.10.10.8.2.2.1" xref="A3.E7.m1.10.10.8.2.2.1.cmml">^</mo></mover><mo id="A3.E7.m1.10.10.8.2.3" xref="A3.E7.m1.10.10.8.2.3.cmml">∗</mo></msup><mo id="A3.E7.m1.10.10.8.1" xref="A3.E7.m1.10.10.8.1.cmml">⁢</mo><mrow id="A3.E7.m1.10.10.8.3.2" xref="A3.E7.m1.10.10.8.3.1.cmml"><mo id="A3.E7.m1.10.10.8.3.2.1" stretchy="false" xref="A3.E7.m1.10.10.8.3.1.cmml">(</mo><mi id="A3.E7.m1.7.7" xref="A3.E7.m1.7.7.cmml">s</mi><mo id="A3.E7.m1.10.10.8.3.2.2" xref="A3.E7.m1.10.10.8.3.1.cmml">,</mo><mi id="A3.E7.m1.8.8" xref="A3.E7.m1.8.8.cmml">a</mi><mo id="A3.E7.m1.10.10.8.3.2.3" stretchy="false" xref="A3.E7.m1.10.10.8.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.E7.m1.10b"><apply id="A3.E7.m1.10.10.cmml" xref="A3.E7.m1.10.10"><and id="A3.E7.m1.10.10a.cmml" xref="A3.E7.m1.10.10"></and><apply id="A3.E7.m1.10.10b.cmml" xref="A3.E7.m1.10.10"><eq id="A3.E7.m1.10.10.5.cmml" xref="A3.E7.m1.10.10.5"></eq><apply id="A3.E7.m1.10.10.4.cmml" xref="A3.E7.m1.10.10.4"><times id="A3.E7.m1.10.10.4.1.cmml" xref="A3.E7.m1.10.10.4.1"></times><apply id="A3.E7.m1.10.10.4.2.cmml" xref="A3.E7.m1.10.10.4.2"><csymbol cd="ambiguous" id="A3.E7.m1.10.10.4.2.1.cmml" xref="A3.E7.m1.10.10.4.2">superscript</csymbol><apply id="A3.E7.m1.10.10.4.2.2.cmml" xref="A3.E7.m1.10.10.4.2"><csymbol cd="ambiguous" id="A3.E7.m1.10.10.4.2.2.1.cmml" xref="A3.E7.m1.10.10.4.2">subscript</csymbol><ci id="A3.E7.m1.10.10.4.2.2.2.cmml" xref="A3.E7.m1.10.10.4.2.2.2">𝑄</ci><cn id="A3.E7.m1.10.10.4.2.2.3.cmml" type="integer" xref="A3.E7.m1.10.10.4.2.2.3">1</cn></apply><times id="A3.E7.m1.10.10.4.2.3.cmml" xref="A3.E7.m1.10.10.4.2.3"></times></apply><interval closure="open" id="A3.E7.m1.10.10.4.3.1.cmml" xref="A3.E7.m1.10.10.4.3.2"><ci id="A3.E7.m1.1.1.cmml" xref="A3.E7.m1.1.1">𝑠</ci><ci id="A3.E7.m1.2.2.cmml" xref="A3.E7.m1.2.2">𝑎</ci></interval></apply><apply id="A3.E7.m1.9.9.1.cmml" xref="A3.E7.m1.9.9.1"><times id="A3.E7.m1.9.9.1.2.cmml" xref="A3.E7.m1.9.9.1.2"></times><apply id="A3.E7.m1.9.9.1.3.cmml" xref="A3.E7.m1.9.9.1.3"><apply id="A3.E7.m1.9.9.1.3.1.cmml" xref="A3.E7.m1.9.9.1.3.1"><csymbol cd="ambiguous" id="A3.E7.m1.9.9.1.3.1.1.cmml" xref="A3.E7.m1.9.9.1.3.1">subscript</csymbol><max id="A3.E7.m1.9.9.1.3.1.2.cmml" xref="A3.E7.m1.9.9.1.3.1.2"></max><ci id="A3.E7.m1.9.9.1.3.1.3.cmml" xref="A3.E7.m1.9.9.1.3.1.3">𝜋</ci></apply><apply id="A3.E7.m1.9.9.1.3.2.cmml" xref="A3.E7.m1.9.9.1.3.2"><csymbol cd="ambiguous" id="A3.E7.m1.9.9.1.3.2.1.cmml" xref="A3.E7.m1.9.9.1.3.2">subscript</csymbol><ci id="A3.E7.m1.9.9.1.3.2.2.cmml" xref="A3.E7.m1.9.9.1.3.2.2">𝔼</ci><ci id="A3.E7.m1.9.9.1.3.2.3.cmml" xref="A3.E7.m1.9.9.1.3.2.3">𝜏</ci></apply></apply><apply id="A3.E7.m1.9.9.1.1.2.cmml" xref="A3.E7.m1.9.9.1.1.1"><csymbol cd="latexml" id="A3.E7.m1.9.9.1.1.2.1.cmml" xref="A3.E7.m1.9.9.1.1.1.2">delimited-[]</csymbol><apply id="A3.E7.m1.9.9.1.1.1.1.cmml" xref="A3.E7.m1.9.9.1.1.1.1"><csymbol cd="latexml" id="A3.E7.m1.9.9.1.1.1.1.2.cmml" xref="A3.E7.m1.9.9.1.1.1.1.2">conditional</csymbol><apply id="A3.E7.m1.9.9.1.1.1.1.1.cmml" xref="A3.E7.m1.9.9.1.1.1.1.1"><apply id="A3.E7.m1.9.9.1.1.1.1.1.2.cmml" xref="A3.E7.m1.9.9.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.E7.m1.9.9.1.1.1.1.1.2.1.cmml" xref="A3.E7.m1.9.9.1.1.1.1.1.2">subscript</csymbol><sum id="A3.E7.m1.9.9.1.1.1.1.1.2.2.cmml" xref="A3.E7.m1.9.9.1.1.1.1.1.2.2"></sum><ci id="A3.E7.m1.9.9.1.1.1.1.1.2.3.cmml" xref="A3.E7.m1.9.9.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="A3.E7.m1.9.9.1.1.1.1.1.1.cmml" xref="A3.E7.m1.9.9.1.1.1.1.1.1"><times id="A3.E7.m1.9.9.1.1.1.1.1.1.2.cmml" xref="A3.E7.m1.9.9.1.1.1.1.1.1.2"></times><apply id="A3.E7.m1.9.9.1.1.1.1.1.1.3.cmml" xref="A3.E7.m1.9.9.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E7.m1.9.9.1.1.1.1.1.1.3.1.cmml" xref="A3.E7.m1.9.9.1.1.1.1.1.1.3">superscript</csymbol><ci id="A3.E7.m1.9.9.1.1.1.1.1.1.3.2.cmml" xref="A3.E7.m1.9.9.1.1.1.1.1.1.3.2">𝛾</ci><ci id="A3.E7.m1.9.9.1.1.1.1.1.1.3.3.cmml" xref="A3.E7.m1.9.9.1.1.1.1.1.1.3.3">𝑡</ci></apply><apply id="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E7.m1.9.9.1.1.1.1.1.1.1.1"><plus id="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.1"></plus><apply id="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.2.2">𝑅</ci><ci id="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.3.cmml" xref="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.3"><times id="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.3.2">𝛽</ci><apply id="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.3.3.2">𝑅</ci><ci id="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="A3.E7.m1.9.9.1.1.1.1.1.1.1.1.1.3.3.3">𝐼</ci></apply></apply></apply></apply></apply><list id="A3.E7.m1.9.9.1.1.1.1.3.1.cmml" xref="A3.E7.m1.9.9.1.1.1.1.3.2"><ci id="A3.E7.m1.3.3.cmml" xref="A3.E7.m1.3.3">𝑠</ci><ci id="A3.E7.m1.4.4.cmml" xref="A3.E7.m1.4.4">𝑎</ci></list></apply></apply></apply></apply><apply id="A3.E7.m1.10.10c.cmml" xref="A3.E7.m1.10.10"><leq id="A3.E7.m1.10.10.6.cmml" xref="A3.E7.m1.10.10.6"></leq><share href="https://arxiv.org/html/2410.04498v1#A3.E7.m1.9.9.1.cmml" id="A3.E7.m1.10.10d.cmml" xref="A3.E7.m1.10.10"></share><apply id="A3.E7.m1.10.10.2.cmml" xref="A3.E7.m1.10.10.2"><times id="A3.E7.m1.10.10.2.2.cmml" xref="A3.E7.m1.10.10.2.2"></times><apply id="A3.E7.m1.10.10.2.3.cmml" xref="A3.E7.m1.10.10.2.3"><apply id="A3.E7.m1.10.10.2.3.1.cmml" xref="A3.E7.m1.10.10.2.3.1"><csymbol cd="ambiguous" id="A3.E7.m1.10.10.2.3.1.1.cmml" xref="A3.E7.m1.10.10.2.3.1">subscript</csymbol><max id="A3.E7.m1.10.10.2.3.1.2.cmml" xref="A3.E7.m1.10.10.2.3.1.2"></max><ci id="A3.E7.m1.10.10.2.3.1.3.cmml" xref="A3.E7.m1.10.10.2.3.1.3">𝜋</ci></apply><apply id="A3.E7.m1.10.10.2.3.2.cmml" xref="A3.E7.m1.10.10.2.3.2"><csymbol cd="ambiguous" id="A3.E7.m1.10.10.2.3.2.1.cmml" xref="A3.E7.m1.10.10.2.3.2">subscript</csymbol><ci id="A3.E7.m1.10.10.2.3.2.2.cmml" xref="A3.E7.m1.10.10.2.3.2.2">𝔼</ci><ci id="A3.E7.m1.10.10.2.3.2.3.cmml" xref="A3.E7.m1.10.10.2.3.2.3">𝜏</ci></apply></apply><apply id="A3.E7.m1.10.10.2.1.2.cmml" xref="A3.E7.m1.10.10.2.1.1"><csymbol cd="latexml" id="A3.E7.m1.10.10.2.1.2.1.cmml" xref="A3.E7.m1.10.10.2.1.1.2">delimited-[]</csymbol><apply id="A3.E7.m1.10.10.2.1.1.1.cmml" xref="A3.E7.m1.10.10.2.1.1.1"><csymbol cd="latexml" id="A3.E7.m1.10.10.2.1.1.1.2.cmml" xref="A3.E7.m1.10.10.2.1.1.1.2">conditional</csymbol><apply id="A3.E7.m1.10.10.2.1.1.1.1.cmml" xref="A3.E7.m1.10.10.2.1.1.1.1"><apply id="A3.E7.m1.10.10.2.1.1.1.1.2.cmml" xref="A3.E7.m1.10.10.2.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.E7.m1.10.10.2.1.1.1.1.2.1.cmml" xref="A3.E7.m1.10.10.2.1.1.1.1.2">subscript</csymbol><sum id="A3.E7.m1.10.10.2.1.1.1.1.2.2.cmml" xref="A3.E7.m1.10.10.2.1.1.1.1.2.2"></sum><ci id="A3.E7.m1.10.10.2.1.1.1.1.2.3.cmml" xref="A3.E7.m1.10.10.2.1.1.1.1.2.3">𝑡</ci></apply><apply id="A3.E7.m1.10.10.2.1.1.1.1.1.cmml" xref="A3.E7.m1.10.10.2.1.1.1.1.1"><times id="A3.E7.m1.10.10.2.1.1.1.1.1.2.cmml" xref="A3.E7.m1.10.10.2.1.1.1.1.1.2"></times><apply id="A3.E7.m1.10.10.2.1.1.1.1.1.3.cmml" xref="A3.E7.m1.10.10.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E7.m1.10.10.2.1.1.1.1.1.3.1.cmml" xref="A3.E7.m1.10.10.2.1.1.1.1.1.3">superscript</csymbol><ci id="A3.E7.m1.10.10.2.1.1.1.1.1.3.2.cmml" xref="A3.E7.m1.10.10.2.1.1.1.1.1.3.2">𝛾</ci><ci id="A3.E7.m1.10.10.2.1.1.1.1.1.3.3.cmml" xref="A3.E7.m1.10.10.2.1.1.1.1.1.3.3">𝑡</ci></apply><apply id="A3.E7.m1.10.10.2.1.1.1.1.1.1.1.1.cmml" xref="A3.E7.m1.10.10.2.1.1.1.1.1.1.1"><plus id="A3.E7.m1.10.10.2.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E7.m1.10.10.2.1.1.1.1.1.1.1.1.1"></plus><apply id="A3.E7.m1.10.10.2.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E7.m1.10.10.2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.E7.m1.10.10.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="A3.E7.m1.10.10.2.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A3.E7.m1.10.10.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="A3.E7.m1.10.10.2.1.1.1.1.1.1.1.1.2.2">𝑅</ci><ci id="A3.E7.m1.10.10.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="A3.E7.m1.10.10.2.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="A3.E7.m1.10.10.2.1.1.1.1.1.1.1.1.3.cmml" xref="A3.E7.m1.10.10.2.1.1.1.1.1.1.1.1.3">𝐶</ci></apply></apply></apply><list id="A3.E7.m1.10.10.2.1.1.1.3.1.cmml" xref="A3.E7.m1.10.10.2.1.1.1.3.2"><ci id="A3.E7.m1.5.5.cmml" xref="A3.E7.m1.5.5">𝑠</ci><ci id="A3.E7.m1.6.6.cmml" xref="A3.E7.m1.6.6">𝑎</ci></list></apply></apply></apply></apply><apply id="A3.E7.m1.10.10e.cmml" xref="A3.E7.m1.10.10"><ci id="A3.E7.m1.10.10.7.cmml" xref="A3.E7.m1.10.10.7">≜</ci><share href="https://arxiv.org/html/2410.04498v1#A3.E7.m1.10.10.2.cmml" id="A3.E7.m1.10.10f.cmml" xref="A3.E7.m1.10.10"></share><apply id="A3.E7.m1.10.10.8.cmml" xref="A3.E7.m1.10.10.8"><times id="A3.E7.m1.10.10.8.1.cmml" xref="A3.E7.m1.10.10.8.1"></times><apply id="A3.E7.m1.10.10.8.2.cmml" xref="A3.E7.m1.10.10.8.2"><csymbol cd="ambiguous" id="A3.E7.m1.10.10.8.2.1.cmml" xref="A3.E7.m1.10.10.8.2">superscript</csymbol><apply id="A3.E7.m1.10.10.8.2.2.cmml" xref="A3.E7.m1.10.10.8.2.2"><ci id="A3.E7.m1.10.10.8.2.2.1.cmml" xref="A3.E7.m1.10.10.8.2.2.1">^</ci><ci id="A3.E7.m1.10.10.8.2.2.2.cmml" xref="A3.E7.m1.10.10.8.2.2.2">𝑄</ci></apply><times id="A3.E7.m1.10.10.8.2.3.cmml" xref="A3.E7.m1.10.10.8.2.3"></times></apply><interval closure="open" id="A3.E7.m1.10.10.8.3.1.cmml" xref="A3.E7.m1.10.10.8.3.2"><ci id="A3.E7.m1.7.7.cmml" xref="A3.E7.m1.7.7">𝑠</ci><ci id="A3.E7.m1.8.8.cmml" xref="A3.E7.m1.8.8">𝑎</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E7.m1.10c">Q_{1}^{*}(s,a)=\max_{\pi}\mathbb{E}_{\tau}\left[\sum_{t}\gamma^{t}(R_{t}+\beta
R%
_{I})|s,a\right]\leq\max_{\pi}\mathbb{E}_{\tau}\left[\sum_{t}\gamma^{t}(R_{t}+%
C)|s,a\right]\triangleq\hat{Q}^{*}(s,a)</annotation><annotation encoding="application/x-llamapun" id="A3.E7.m1.10d">italic_Q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s , italic_a ) = roman_max start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT blackboard_E start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT [ ∑ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_γ start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ( italic_R start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + italic_β italic_R start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT ) | italic_s , italic_a ] ≤ roman_max start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT blackboard_E start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT [ ∑ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_γ start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ( italic_R start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + italic_C ) | italic_s , italic_a ] ≜ over^ start_ARG italic_Q end_ARG start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s , italic_a )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A3.SS1.1.p1.14">According to the paper <cite class="ltx_cite ltx_citemacro_citep">(Gan et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#bib.bib12" title="">2022</a>)</cite>, we have</p>
<table class="ltx_equation ltx_eqn_table" id="A3.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{Q}^{*}(s,a)\triangleq\max_{\pi}\mathbb{E}_{\tau}\left[\sum_{t}\gamma^{t}(%
R_{t}+C)|s,a\right]=Q^{*}(s,a)+\frac{C}{1-\gamma}" class="ltx_Math" display="block" id="A3.E8.m1.7"><semantics id="A3.E8.m1.7a"><mrow id="A3.E8.m1.7.7" xref="A3.E8.m1.7.7.cmml"><mrow id="A3.E8.m1.7.7.3" xref="A3.E8.m1.7.7.3.cmml"><msup id="A3.E8.m1.7.7.3.2" xref="A3.E8.m1.7.7.3.2.cmml"><mover accent="true" id="A3.E8.m1.7.7.3.2.2" xref="A3.E8.m1.7.7.3.2.2.cmml"><mi id="A3.E8.m1.7.7.3.2.2.2" xref="A3.E8.m1.7.7.3.2.2.2.cmml">Q</mi><mo id="A3.E8.m1.7.7.3.2.2.1" xref="A3.E8.m1.7.7.3.2.2.1.cmml">^</mo></mover><mo id="A3.E8.m1.7.7.3.2.3" xref="A3.E8.m1.7.7.3.2.3.cmml">∗</mo></msup><mo id="A3.E8.m1.7.7.3.1" xref="A3.E8.m1.7.7.3.1.cmml">⁢</mo><mrow id="A3.E8.m1.7.7.3.3.2" xref="A3.E8.m1.7.7.3.3.1.cmml"><mo id="A3.E8.m1.7.7.3.3.2.1" stretchy="false" xref="A3.E8.m1.7.7.3.3.1.cmml">(</mo><mi id="A3.E8.m1.1.1" xref="A3.E8.m1.1.1.cmml">s</mi><mo id="A3.E8.m1.7.7.3.3.2.2" xref="A3.E8.m1.7.7.3.3.1.cmml">,</mo><mi id="A3.E8.m1.2.2" xref="A3.E8.m1.2.2.cmml">a</mi><mo id="A3.E8.m1.7.7.3.3.2.3" stretchy="false" xref="A3.E8.m1.7.7.3.3.1.cmml">)</mo></mrow></mrow><mo id="A3.E8.m1.7.7.4" xref="A3.E8.m1.7.7.4.cmml">≜</mo><mrow id="A3.E8.m1.7.7.1" xref="A3.E8.m1.7.7.1.cmml"><mrow id="A3.E8.m1.7.7.1.3" xref="A3.E8.m1.7.7.1.3.cmml"><munder id="A3.E8.m1.7.7.1.3.1" xref="A3.E8.m1.7.7.1.3.1.cmml"><mi id="A3.E8.m1.7.7.1.3.1.2" xref="A3.E8.m1.7.7.1.3.1.2.cmml">max</mi><mi id="A3.E8.m1.7.7.1.3.1.3" xref="A3.E8.m1.7.7.1.3.1.3.cmml">π</mi></munder><mo id="A3.E8.m1.7.7.1.3a" lspace="0.167em" xref="A3.E8.m1.7.7.1.3.cmml">⁡</mo><msub id="A3.E8.m1.7.7.1.3.2" xref="A3.E8.m1.7.7.1.3.2.cmml"><mi id="A3.E8.m1.7.7.1.3.2.2" xref="A3.E8.m1.7.7.1.3.2.2.cmml">𝔼</mi><mi id="A3.E8.m1.7.7.1.3.2.3" xref="A3.E8.m1.7.7.1.3.2.3.cmml">τ</mi></msub></mrow><mo id="A3.E8.m1.7.7.1.2" xref="A3.E8.m1.7.7.1.2.cmml">⁢</mo><mrow id="A3.E8.m1.7.7.1.1.1" xref="A3.E8.m1.7.7.1.1.2.cmml"><mo id="A3.E8.m1.7.7.1.1.1.2" xref="A3.E8.m1.7.7.1.1.2.1.cmml">[</mo><mrow id="A3.E8.m1.7.7.1.1.1.1" xref="A3.E8.m1.7.7.1.1.1.1.cmml"><mrow id="A3.E8.m1.7.7.1.1.1.1.1" xref="A3.E8.m1.7.7.1.1.1.1.1.cmml"><munder id="A3.E8.m1.7.7.1.1.1.1.1.2" xref="A3.E8.m1.7.7.1.1.1.1.1.2.cmml"><mo id="A3.E8.m1.7.7.1.1.1.1.1.2.2" lspace="0em" movablelimits="false" xref="A3.E8.m1.7.7.1.1.1.1.1.2.2.cmml">∑</mo><mi id="A3.E8.m1.7.7.1.1.1.1.1.2.3" xref="A3.E8.m1.7.7.1.1.1.1.1.2.3.cmml">t</mi></munder><mrow id="A3.E8.m1.7.7.1.1.1.1.1.1" xref="A3.E8.m1.7.7.1.1.1.1.1.1.cmml"><msup id="A3.E8.m1.7.7.1.1.1.1.1.1.3" xref="A3.E8.m1.7.7.1.1.1.1.1.1.3.cmml"><mi id="A3.E8.m1.7.7.1.1.1.1.1.1.3.2" xref="A3.E8.m1.7.7.1.1.1.1.1.1.3.2.cmml">γ</mi><mi id="A3.E8.m1.7.7.1.1.1.1.1.1.3.3" xref="A3.E8.m1.7.7.1.1.1.1.1.1.3.3.cmml">t</mi></msup><mo id="A3.E8.m1.7.7.1.1.1.1.1.1.2" xref="A3.E8.m1.7.7.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A3.E8.m1.7.7.1.1.1.1.1.1.1.1" xref="A3.E8.m1.7.7.1.1.1.1.1.1.1.1.1.cmml"><mo id="A3.E8.m1.7.7.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A3.E8.m1.7.7.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A3.E8.m1.7.7.1.1.1.1.1.1.1.1.1" xref="A3.E8.m1.7.7.1.1.1.1.1.1.1.1.1.cmml"><msub id="A3.E8.m1.7.7.1.1.1.1.1.1.1.1.1.2" xref="A3.E8.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A3.E8.m1.7.7.1.1.1.1.1.1.1.1.1.2.2" xref="A3.E8.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.cmml">R</mi><mi id="A3.E8.m1.7.7.1.1.1.1.1.1.1.1.1.2.3" xref="A3.E8.m1.7.7.1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo id="A3.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1" xref="A3.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mi id="A3.E8.m1.7.7.1.1.1.1.1.1.1.1.1.3" xref="A3.E8.m1.7.7.1.1.1.1.1.1.1.1.1.3.cmml">C</mi></mrow><mo id="A3.E8.m1.7.7.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A3.E8.m1.7.7.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo fence="false" id="A3.E8.m1.7.7.1.1.1.1.2" xref="A3.E8.m1.7.7.1.1.1.1.2.cmml">|</mo><mrow id="A3.E8.m1.7.7.1.1.1.1.3.2" xref="A3.E8.m1.7.7.1.1.1.1.3.1.cmml"><mi id="A3.E8.m1.3.3" xref="A3.E8.m1.3.3.cmml">s</mi><mo id="A3.E8.m1.7.7.1.1.1.1.3.2.1" xref="A3.E8.m1.7.7.1.1.1.1.3.1.cmml">,</mo><mi id="A3.E8.m1.4.4" xref="A3.E8.m1.4.4.cmml">a</mi></mrow></mrow><mo id="A3.E8.m1.7.7.1.1.1.3" xref="A3.E8.m1.7.7.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="A3.E8.m1.7.7.5" xref="A3.E8.m1.7.7.5.cmml">=</mo><mrow id="A3.E8.m1.7.7.6" xref="A3.E8.m1.7.7.6.cmml"><mrow id="A3.E8.m1.7.7.6.2" xref="A3.E8.m1.7.7.6.2.cmml"><msup id="A3.E8.m1.7.7.6.2.2" xref="A3.E8.m1.7.7.6.2.2.cmml"><mi id="A3.E8.m1.7.7.6.2.2.2" xref="A3.E8.m1.7.7.6.2.2.2.cmml">Q</mi><mo id="A3.E8.m1.7.7.6.2.2.3" xref="A3.E8.m1.7.7.6.2.2.3.cmml">∗</mo></msup><mo id="A3.E8.m1.7.7.6.2.1" xref="A3.E8.m1.7.7.6.2.1.cmml">⁢</mo><mrow id="A3.E8.m1.7.7.6.2.3.2" xref="A3.E8.m1.7.7.6.2.3.1.cmml"><mo id="A3.E8.m1.7.7.6.2.3.2.1" stretchy="false" xref="A3.E8.m1.7.7.6.2.3.1.cmml">(</mo><mi id="A3.E8.m1.5.5" xref="A3.E8.m1.5.5.cmml">s</mi><mo id="A3.E8.m1.7.7.6.2.3.2.2" xref="A3.E8.m1.7.7.6.2.3.1.cmml">,</mo><mi id="A3.E8.m1.6.6" xref="A3.E8.m1.6.6.cmml">a</mi><mo id="A3.E8.m1.7.7.6.2.3.2.3" stretchy="false" xref="A3.E8.m1.7.7.6.2.3.1.cmml">)</mo></mrow></mrow><mo id="A3.E8.m1.7.7.6.1" xref="A3.E8.m1.7.7.6.1.cmml">+</mo><mfrac id="A3.E8.m1.7.7.6.3" xref="A3.E8.m1.7.7.6.3.cmml"><mi id="A3.E8.m1.7.7.6.3.2" xref="A3.E8.m1.7.7.6.3.2.cmml">C</mi><mrow id="A3.E8.m1.7.7.6.3.3" xref="A3.E8.m1.7.7.6.3.3.cmml"><mn id="A3.E8.m1.7.7.6.3.3.2" xref="A3.E8.m1.7.7.6.3.3.2.cmml">1</mn><mo id="A3.E8.m1.7.7.6.3.3.1" xref="A3.E8.m1.7.7.6.3.3.1.cmml">−</mo><mi id="A3.E8.m1.7.7.6.3.3.3" xref="A3.E8.m1.7.7.6.3.3.3.cmml">γ</mi></mrow></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.E8.m1.7b"><apply id="A3.E8.m1.7.7.cmml" xref="A3.E8.m1.7.7"><and id="A3.E8.m1.7.7a.cmml" xref="A3.E8.m1.7.7"></and><apply id="A3.E8.m1.7.7b.cmml" xref="A3.E8.m1.7.7"><ci id="A3.E8.m1.7.7.4.cmml" xref="A3.E8.m1.7.7.4">≜</ci><apply id="A3.E8.m1.7.7.3.cmml" xref="A3.E8.m1.7.7.3"><times id="A3.E8.m1.7.7.3.1.cmml" xref="A3.E8.m1.7.7.3.1"></times><apply id="A3.E8.m1.7.7.3.2.cmml" xref="A3.E8.m1.7.7.3.2"><csymbol cd="ambiguous" id="A3.E8.m1.7.7.3.2.1.cmml" xref="A3.E8.m1.7.7.3.2">superscript</csymbol><apply id="A3.E8.m1.7.7.3.2.2.cmml" xref="A3.E8.m1.7.7.3.2.2"><ci id="A3.E8.m1.7.7.3.2.2.1.cmml" xref="A3.E8.m1.7.7.3.2.2.1">^</ci><ci id="A3.E8.m1.7.7.3.2.2.2.cmml" xref="A3.E8.m1.7.7.3.2.2.2">𝑄</ci></apply><times id="A3.E8.m1.7.7.3.2.3.cmml" xref="A3.E8.m1.7.7.3.2.3"></times></apply><interval closure="open" id="A3.E8.m1.7.7.3.3.1.cmml" xref="A3.E8.m1.7.7.3.3.2"><ci id="A3.E8.m1.1.1.cmml" xref="A3.E8.m1.1.1">𝑠</ci><ci id="A3.E8.m1.2.2.cmml" xref="A3.E8.m1.2.2">𝑎</ci></interval></apply><apply id="A3.E8.m1.7.7.1.cmml" xref="A3.E8.m1.7.7.1"><times id="A3.E8.m1.7.7.1.2.cmml" xref="A3.E8.m1.7.7.1.2"></times><apply id="A3.E8.m1.7.7.1.3.cmml" xref="A3.E8.m1.7.7.1.3"><apply id="A3.E8.m1.7.7.1.3.1.cmml" xref="A3.E8.m1.7.7.1.3.1"><csymbol cd="ambiguous" id="A3.E8.m1.7.7.1.3.1.1.cmml" xref="A3.E8.m1.7.7.1.3.1">subscript</csymbol><max id="A3.E8.m1.7.7.1.3.1.2.cmml" xref="A3.E8.m1.7.7.1.3.1.2"></max><ci id="A3.E8.m1.7.7.1.3.1.3.cmml" xref="A3.E8.m1.7.7.1.3.1.3">𝜋</ci></apply><apply id="A3.E8.m1.7.7.1.3.2.cmml" xref="A3.E8.m1.7.7.1.3.2"><csymbol cd="ambiguous" id="A3.E8.m1.7.7.1.3.2.1.cmml" xref="A3.E8.m1.7.7.1.3.2">subscript</csymbol><ci id="A3.E8.m1.7.7.1.3.2.2.cmml" xref="A3.E8.m1.7.7.1.3.2.2">𝔼</ci><ci id="A3.E8.m1.7.7.1.3.2.3.cmml" xref="A3.E8.m1.7.7.1.3.2.3">𝜏</ci></apply></apply><apply id="A3.E8.m1.7.7.1.1.2.cmml" xref="A3.E8.m1.7.7.1.1.1"><csymbol cd="latexml" id="A3.E8.m1.7.7.1.1.2.1.cmml" xref="A3.E8.m1.7.7.1.1.1.2">delimited-[]</csymbol><apply id="A3.E8.m1.7.7.1.1.1.1.cmml" xref="A3.E8.m1.7.7.1.1.1.1"><csymbol cd="latexml" id="A3.E8.m1.7.7.1.1.1.1.2.cmml" xref="A3.E8.m1.7.7.1.1.1.1.2">conditional</csymbol><apply id="A3.E8.m1.7.7.1.1.1.1.1.cmml" xref="A3.E8.m1.7.7.1.1.1.1.1"><apply id="A3.E8.m1.7.7.1.1.1.1.1.2.cmml" xref="A3.E8.m1.7.7.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.E8.m1.7.7.1.1.1.1.1.2.1.cmml" xref="A3.E8.m1.7.7.1.1.1.1.1.2">subscript</csymbol><sum id="A3.E8.m1.7.7.1.1.1.1.1.2.2.cmml" xref="A3.E8.m1.7.7.1.1.1.1.1.2.2"></sum><ci id="A3.E8.m1.7.7.1.1.1.1.1.2.3.cmml" xref="A3.E8.m1.7.7.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="A3.E8.m1.7.7.1.1.1.1.1.1.cmml" xref="A3.E8.m1.7.7.1.1.1.1.1.1"><times id="A3.E8.m1.7.7.1.1.1.1.1.1.2.cmml" xref="A3.E8.m1.7.7.1.1.1.1.1.1.2"></times><apply id="A3.E8.m1.7.7.1.1.1.1.1.1.3.cmml" xref="A3.E8.m1.7.7.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E8.m1.7.7.1.1.1.1.1.1.3.1.cmml" xref="A3.E8.m1.7.7.1.1.1.1.1.1.3">superscript</csymbol><ci id="A3.E8.m1.7.7.1.1.1.1.1.1.3.2.cmml" xref="A3.E8.m1.7.7.1.1.1.1.1.1.3.2">𝛾</ci><ci id="A3.E8.m1.7.7.1.1.1.1.1.1.3.3.cmml" xref="A3.E8.m1.7.7.1.1.1.1.1.1.3.3">𝑡</ci></apply><apply id="A3.E8.m1.7.7.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E8.m1.7.7.1.1.1.1.1.1.1.1"><plus id="A3.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1"></plus><apply id="A3.E8.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E8.m1.7.7.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.E8.m1.7.7.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A3.E8.m1.7.7.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A3.E8.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A3.E8.m1.7.7.1.1.1.1.1.1.1.1.1.2.2">𝑅</ci><ci id="A3.E8.m1.7.7.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A3.E8.m1.7.7.1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="A3.E8.m1.7.7.1.1.1.1.1.1.1.1.1.3.cmml" xref="A3.E8.m1.7.7.1.1.1.1.1.1.1.1.1.3">𝐶</ci></apply></apply></apply><list id="A3.E8.m1.7.7.1.1.1.1.3.1.cmml" xref="A3.E8.m1.7.7.1.1.1.1.3.2"><ci id="A3.E8.m1.3.3.cmml" xref="A3.E8.m1.3.3">𝑠</ci><ci id="A3.E8.m1.4.4.cmml" xref="A3.E8.m1.4.4">𝑎</ci></list></apply></apply></apply></apply><apply id="A3.E8.m1.7.7c.cmml" xref="A3.E8.m1.7.7"><eq id="A3.E8.m1.7.7.5.cmml" xref="A3.E8.m1.7.7.5"></eq><share href="https://arxiv.org/html/2410.04498v1#A3.E8.m1.7.7.1.cmml" id="A3.E8.m1.7.7d.cmml" xref="A3.E8.m1.7.7"></share><apply id="A3.E8.m1.7.7.6.cmml" xref="A3.E8.m1.7.7.6"><plus id="A3.E8.m1.7.7.6.1.cmml" xref="A3.E8.m1.7.7.6.1"></plus><apply id="A3.E8.m1.7.7.6.2.cmml" xref="A3.E8.m1.7.7.6.2"><times id="A3.E8.m1.7.7.6.2.1.cmml" xref="A3.E8.m1.7.7.6.2.1"></times><apply id="A3.E8.m1.7.7.6.2.2.cmml" xref="A3.E8.m1.7.7.6.2.2"><csymbol cd="ambiguous" id="A3.E8.m1.7.7.6.2.2.1.cmml" xref="A3.E8.m1.7.7.6.2.2">superscript</csymbol><ci id="A3.E8.m1.7.7.6.2.2.2.cmml" xref="A3.E8.m1.7.7.6.2.2.2">𝑄</ci><times id="A3.E8.m1.7.7.6.2.2.3.cmml" xref="A3.E8.m1.7.7.6.2.2.3"></times></apply><interval closure="open" id="A3.E8.m1.7.7.6.2.3.1.cmml" xref="A3.E8.m1.7.7.6.2.3.2"><ci id="A3.E8.m1.5.5.cmml" xref="A3.E8.m1.5.5">𝑠</ci><ci id="A3.E8.m1.6.6.cmml" xref="A3.E8.m1.6.6">𝑎</ci></interval></apply><apply id="A3.E8.m1.7.7.6.3.cmml" xref="A3.E8.m1.7.7.6.3"><divide id="A3.E8.m1.7.7.6.3.1.cmml" xref="A3.E8.m1.7.7.6.3"></divide><ci id="A3.E8.m1.7.7.6.3.2.cmml" xref="A3.E8.m1.7.7.6.3.2">𝐶</ci><apply id="A3.E8.m1.7.7.6.3.3.cmml" xref="A3.E8.m1.7.7.6.3.3"><minus id="A3.E8.m1.7.7.6.3.3.1.cmml" xref="A3.E8.m1.7.7.6.3.3.1"></minus><cn id="A3.E8.m1.7.7.6.3.3.2.cmml" type="integer" xref="A3.E8.m1.7.7.6.3.3.2">1</cn><ci id="A3.E8.m1.7.7.6.3.3.3.cmml" xref="A3.E8.m1.7.7.6.3.3.3">𝛾</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E8.m1.7c">\hat{Q}^{*}(s,a)\triangleq\max_{\pi}\mathbb{E}_{\tau}\left[\sum_{t}\gamma^{t}(%
R_{t}+C)|s,a\right]=Q^{*}(s,a)+\frac{C}{1-\gamma}</annotation><annotation encoding="application/x-llamapun" id="A3.E8.m1.7d">over^ start_ARG italic_Q end_ARG start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s , italic_a ) ≜ roman_max start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT blackboard_E start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT [ ∑ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_γ start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ( italic_R start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + italic_C ) | italic_s , italic_a ] = italic_Q start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s , italic_a ) + divide start_ARG italic_C end_ARG start_ARG 1 - italic_γ end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A3.SS1.1.p1.11">where <math alttext="Q^{*}" class="ltx_Math" display="inline" id="A3.SS1.1.p1.5.m1.1"><semantics id="A3.SS1.1.p1.5.m1.1a"><msup id="A3.SS1.1.p1.5.m1.1.1" xref="A3.SS1.1.p1.5.m1.1.1.cmml"><mi id="A3.SS1.1.p1.5.m1.1.1.2" xref="A3.SS1.1.p1.5.m1.1.1.2.cmml">Q</mi><mo id="A3.SS1.1.p1.5.m1.1.1.3" xref="A3.SS1.1.p1.5.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="A3.SS1.1.p1.5.m1.1b"><apply id="A3.SS1.1.p1.5.m1.1.1.cmml" xref="A3.SS1.1.p1.5.m1.1.1"><csymbol cd="ambiguous" id="A3.SS1.1.p1.5.m1.1.1.1.cmml" xref="A3.SS1.1.p1.5.m1.1.1">superscript</csymbol><ci id="A3.SS1.1.p1.5.m1.1.1.2.cmml" xref="A3.SS1.1.p1.5.m1.1.1.2">𝑄</ci><times id="A3.SS1.1.p1.5.m1.1.1.3.cmml" xref="A3.SS1.1.p1.5.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.1.p1.5.m1.1c">Q^{*}</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.1.p1.5.m1.1d">italic_Q start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> is the optimal <math alttext="Q" class="ltx_Math" display="inline" id="A3.SS1.1.p1.6.m2.1"><semantics id="A3.SS1.1.p1.6.m2.1a"><mi id="A3.SS1.1.p1.6.m2.1.1" xref="A3.SS1.1.p1.6.m2.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="A3.SS1.1.p1.6.m2.1b"><ci id="A3.SS1.1.p1.6.m2.1.1.cmml" xref="A3.SS1.1.p1.6.m2.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.1.p1.6.m2.1c">Q</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.1.p1.6.m2.1d">italic_Q</annotation></semantics></math> function.
Since <math alttext="a^{*}" class="ltx_Math" display="inline" id="A3.SS1.1.p1.7.m3.1"><semantics id="A3.SS1.1.p1.7.m3.1a"><msup id="A3.SS1.1.p1.7.m3.1.1" xref="A3.SS1.1.p1.7.m3.1.1.cmml"><mi id="A3.SS1.1.p1.7.m3.1.1.2" xref="A3.SS1.1.p1.7.m3.1.1.2.cmml">a</mi><mo id="A3.SS1.1.p1.7.m3.1.1.3" xref="A3.SS1.1.p1.7.m3.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="A3.SS1.1.p1.7.m3.1b"><apply id="A3.SS1.1.p1.7.m3.1.1.cmml" xref="A3.SS1.1.p1.7.m3.1.1"><csymbol cd="ambiguous" id="A3.SS1.1.p1.7.m3.1.1.1.cmml" xref="A3.SS1.1.p1.7.m3.1.1">superscript</csymbol><ci id="A3.SS1.1.p1.7.m3.1.1.2.cmml" xref="A3.SS1.1.p1.7.m3.1.1.2">𝑎</ci><times id="A3.SS1.1.p1.7.m3.1.1.3.cmml" xref="A3.SS1.1.p1.7.m3.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.1.p1.7.m3.1c">a^{*}</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.1.p1.7.m3.1d">italic_a start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="a^{sub}" class="ltx_Math" display="inline" id="A3.SS1.1.p1.8.m4.1"><semantics id="A3.SS1.1.p1.8.m4.1a"><msup id="A3.SS1.1.p1.8.m4.1.1" xref="A3.SS1.1.p1.8.m4.1.1.cmml"><mi id="A3.SS1.1.p1.8.m4.1.1.2" xref="A3.SS1.1.p1.8.m4.1.1.2.cmml">a</mi><mrow id="A3.SS1.1.p1.8.m4.1.1.3" xref="A3.SS1.1.p1.8.m4.1.1.3.cmml"><mi id="A3.SS1.1.p1.8.m4.1.1.3.2" xref="A3.SS1.1.p1.8.m4.1.1.3.2.cmml">s</mi><mo id="A3.SS1.1.p1.8.m4.1.1.3.1" xref="A3.SS1.1.p1.8.m4.1.1.3.1.cmml">⁢</mo><mi id="A3.SS1.1.p1.8.m4.1.1.3.3" xref="A3.SS1.1.p1.8.m4.1.1.3.3.cmml">u</mi><mo id="A3.SS1.1.p1.8.m4.1.1.3.1a" xref="A3.SS1.1.p1.8.m4.1.1.3.1.cmml">⁢</mo><mi id="A3.SS1.1.p1.8.m4.1.1.3.4" xref="A3.SS1.1.p1.8.m4.1.1.3.4.cmml">b</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="A3.SS1.1.p1.8.m4.1b"><apply id="A3.SS1.1.p1.8.m4.1.1.cmml" xref="A3.SS1.1.p1.8.m4.1.1"><csymbol cd="ambiguous" id="A3.SS1.1.p1.8.m4.1.1.1.cmml" xref="A3.SS1.1.p1.8.m4.1.1">superscript</csymbol><ci id="A3.SS1.1.p1.8.m4.1.1.2.cmml" xref="A3.SS1.1.p1.8.m4.1.1.2">𝑎</ci><apply id="A3.SS1.1.p1.8.m4.1.1.3.cmml" xref="A3.SS1.1.p1.8.m4.1.1.3"><times id="A3.SS1.1.p1.8.m4.1.1.3.1.cmml" xref="A3.SS1.1.p1.8.m4.1.1.3.1"></times><ci id="A3.SS1.1.p1.8.m4.1.1.3.2.cmml" xref="A3.SS1.1.p1.8.m4.1.1.3.2">𝑠</ci><ci id="A3.SS1.1.p1.8.m4.1.1.3.3.cmml" xref="A3.SS1.1.p1.8.m4.1.1.3.3">𝑢</ci><ci id="A3.SS1.1.p1.8.m4.1.1.3.4.cmml" xref="A3.SS1.1.p1.8.m4.1.1.3.4">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.1.p1.8.m4.1c">a^{sub}</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.1.p1.8.m4.1d">italic_a start_POSTSUPERSCRIPT italic_s italic_u italic_b end_POSTSUPERSCRIPT</annotation></semantics></math> are optimal and suboptimal actions under the state <math alttext="s" class="ltx_Math" display="inline" id="A3.SS1.1.p1.9.m5.1"><semantics id="A3.SS1.1.p1.9.m5.1a"><mi id="A3.SS1.1.p1.9.m5.1.1" xref="A3.SS1.1.p1.9.m5.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="A3.SS1.1.p1.9.m5.1b"><ci id="A3.SS1.1.p1.9.m5.1.1.cmml" xref="A3.SS1.1.p1.9.m5.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.1.p1.9.m5.1c">s</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.1.p1.9.m5.1d">italic_s</annotation></semantics></math>, respectively, we have
<math alttext="Q^{*}(s,a^{*})&gt;Q^{*}(s,a^{sub})" class="ltx_Math" display="inline" id="A3.SS1.1.p1.10.m6.4"><semantics id="A3.SS1.1.p1.10.m6.4a"><mrow id="A3.SS1.1.p1.10.m6.4.4" xref="A3.SS1.1.p1.10.m6.4.4.cmml"><mrow id="A3.SS1.1.p1.10.m6.3.3.1" xref="A3.SS1.1.p1.10.m6.3.3.1.cmml"><msup id="A3.SS1.1.p1.10.m6.3.3.1.3" xref="A3.SS1.1.p1.10.m6.3.3.1.3.cmml"><mi id="A3.SS1.1.p1.10.m6.3.3.1.3.2" xref="A3.SS1.1.p1.10.m6.3.3.1.3.2.cmml">Q</mi><mo id="A3.SS1.1.p1.10.m6.3.3.1.3.3" xref="A3.SS1.1.p1.10.m6.3.3.1.3.3.cmml">∗</mo></msup><mo id="A3.SS1.1.p1.10.m6.3.3.1.2" xref="A3.SS1.1.p1.10.m6.3.3.1.2.cmml">⁢</mo><mrow id="A3.SS1.1.p1.10.m6.3.3.1.1.1" xref="A3.SS1.1.p1.10.m6.3.3.1.1.2.cmml"><mo id="A3.SS1.1.p1.10.m6.3.3.1.1.1.2" stretchy="false" xref="A3.SS1.1.p1.10.m6.3.3.1.1.2.cmml">(</mo><mi id="A3.SS1.1.p1.10.m6.1.1" xref="A3.SS1.1.p1.10.m6.1.1.cmml">s</mi><mo id="A3.SS1.1.p1.10.m6.3.3.1.1.1.3" xref="A3.SS1.1.p1.10.m6.3.3.1.1.2.cmml">,</mo><msup id="A3.SS1.1.p1.10.m6.3.3.1.1.1.1" xref="A3.SS1.1.p1.10.m6.3.3.1.1.1.1.cmml"><mi id="A3.SS1.1.p1.10.m6.3.3.1.1.1.1.2" xref="A3.SS1.1.p1.10.m6.3.3.1.1.1.1.2.cmml">a</mi><mo id="A3.SS1.1.p1.10.m6.3.3.1.1.1.1.3" xref="A3.SS1.1.p1.10.m6.3.3.1.1.1.1.3.cmml">∗</mo></msup><mo id="A3.SS1.1.p1.10.m6.3.3.1.1.1.4" stretchy="false" xref="A3.SS1.1.p1.10.m6.3.3.1.1.2.cmml">)</mo></mrow></mrow><mo id="A3.SS1.1.p1.10.m6.4.4.3" xref="A3.SS1.1.p1.10.m6.4.4.3.cmml">&gt;</mo><mrow id="A3.SS1.1.p1.10.m6.4.4.2" xref="A3.SS1.1.p1.10.m6.4.4.2.cmml"><msup id="A3.SS1.1.p1.10.m6.4.4.2.3" xref="A3.SS1.1.p1.10.m6.4.4.2.3.cmml"><mi id="A3.SS1.1.p1.10.m6.4.4.2.3.2" xref="A3.SS1.1.p1.10.m6.4.4.2.3.2.cmml">Q</mi><mo id="A3.SS1.1.p1.10.m6.4.4.2.3.3" xref="A3.SS1.1.p1.10.m6.4.4.2.3.3.cmml">∗</mo></msup><mo id="A3.SS1.1.p1.10.m6.4.4.2.2" xref="A3.SS1.1.p1.10.m6.4.4.2.2.cmml">⁢</mo><mrow id="A3.SS1.1.p1.10.m6.4.4.2.1.1" xref="A3.SS1.1.p1.10.m6.4.4.2.1.2.cmml"><mo id="A3.SS1.1.p1.10.m6.4.4.2.1.1.2" stretchy="false" xref="A3.SS1.1.p1.10.m6.4.4.2.1.2.cmml">(</mo><mi id="A3.SS1.1.p1.10.m6.2.2" xref="A3.SS1.1.p1.10.m6.2.2.cmml">s</mi><mo id="A3.SS1.1.p1.10.m6.4.4.2.1.1.3" xref="A3.SS1.1.p1.10.m6.4.4.2.1.2.cmml">,</mo><msup id="A3.SS1.1.p1.10.m6.4.4.2.1.1.1" xref="A3.SS1.1.p1.10.m6.4.4.2.1.1.1.cmml"><mi id="A3.SS1.1.p1.10.m6.4.4.2.1.1.1.2" xref="A3.SS1.1.p1.10.m6.4.4.2.1.1.1.2.cmml">a</mi><mrow id="A3.SS1.1.p1.10.m6.4.4.2.1.1.1.3" xref="A3.SS1.1.p1.10.m6.4.4.2.1.1.1.3.cmml"><mi id="A3.SS1.1.p1.10.m6.4.4.2.1.1.1.3.2" xref="A3.SS1.1.p1.10.m6.4.4.2.1.1.1.3.2.cmml">s</mi><mo id="A3.SS1.1.p1.10.m6.4.4.2.1.1.1.3.1" xref="A3.SS1.1.p1.10.m6.4.4.2.1.1.1.3.1.cmml">⁢</mo><mi id="A3.SS1.1.p1.10.m6.4.4.2.1.1.1.3.3" xref="A3.SS1.1.p1.10.m6.4.4.2.1.1.1.3.3.cmml">u</mi><mo id="A3.SS1.1.p1.10.m6.4.4.2.1.1.1.3.1a" xref="A3.SS1.1.p1.10.m6.4.4.2.1.1.1.3.1.cmml">⁢</mo><mi id="A3.SS1.1.p1.10.m6.4.4.2.1.1.1.3.4" xref="A3.SS1.1.p1.10.m6.4.4.2.1.1.1.3.4.cmml">b</mi></mrow></msup><mo id="A3.SS1.1.p1.10.m6.4.4.2.1.1.4" stretchy="false" xref="A3.SS1.1.p1.10.m6.4.4.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.1.p1.10.m6.4b"><apply id="A3.SS1.1.p1.10.m6.4.4.cmml" xref="A3.SS1.1.p1.10.m6.4.4"><gt id="A3.SS1.1.p1.10.m6.4.4.3.cmml" xref="A3.SS1.1.p1.10.m6.4.4.3"></gt><apply id="A3.SS1.1.p1.10.m6.3.3.1.cmml" xref="A3.SS1.1.p1.10.m6.3.3.1"><times id="A3.SS1.1.p1.10.m6.3.3.1.2.cmml" xref="A3.SS1.1.p1.10.m6.3.3.1.2"></times><apply id="A3.SS1.1.p1.10.m6.3.3.1.3.cmml" xref="A3.SS1.1.p1.10.m6.3.3.1.3"><csymbol cd="ambiguous" id="A3.SS1.1.p1.10.m6.3.3.1.3.1.cmml" xref="A3.SS1.1.p1.10.m6.3.3.1.3">superscript</csymbol><ci id="A3.SS1.1.p1.10.m6.3.3.1.3.2.cmml" xref="A3.SS1.1.p1.10.m6.3.3.1.3.2">𝑄</ci><times id="A3.SS1.1.p1.10.m6.3.3.1.3.3.cmml" xref="A3.SS1.1.p1.10.m6.3.3.1.3.3"></times></apply><interval closure="open" id="A3.SS1.1.p1.10.m6.3.3.1.1.2.cmml" xref="A3.SS1.1.p1.10.m6.3.3.1.1.1"><ci id="A3.SS1.1.p1.10.m6.1.1.cmml" xref="A3.SS1.1.p1.10.m6.1.1">𝑠</ci><apply id="A3.SS1.1.p1.10.m6.3.3.1.1.1.1.cmml" xref="A3.SS1.1.p1.10.m6.3.3.1.1.1.1"><csymbol cd="ambiguous" id="A3.SS1.1.p1.10.m6.3.3.1.1.1.1.1.cmml" xref="A3.SS1.1.p1.10.m6.3.3.1.1.1.1">superscript</csymbol><ci id="A3.SS1.1.p1.10.m6.3.3.1.1.1.1.2.cmml" xref="A3.SS1.1.p1.10.m6.3.3.1.1.1.1.2">𝑎</ci><times id="A3.SS1.1.p1.10.m6.3.3.1.1.1.1.3.cmml" xref="A3.SS1.1.p1.10.m6.3.3.1.1.1.1.3"></times></apply></interval></apply><apply id="A3.SS1.1.p1.10.m6.4.4.2.cmml" xref="A3.SS1.1.p1.10.m6.4.4.2"><times id="A3.SS1.1.p1.10.m6.4.4.2.2.cmml" xref="A3.SS1.1.p1.10.m6.4.4.2.2"></times><apply id="A3.SS1.1.p1.10.m6.4.4.2.3.cmml" xref="A3.SS1.1.p1.10.m6.4.4.2.3"><csymbol cd="ambiguous" id="A3.SS1.1.p1.10.m6.4.4.2.3.1.cmml" xref="A3.SS1.1.p1.10.m6.4.4.2.3">superscript</csymbol><ci id="A3.SS1.1.p1.10.m6.4.4.2.3.2.cmml" xref="A3.SS1.1.p1.10.m6.4.4.2.3.2">𝑄</ci><times id="A3.SS1.1.p1.10.m6.4.4.2.3.3.cmml" xref="A3.SS1.1.p1.10.m6.4.4.2.3.3"></times></apply><interval closure="open" id="A3.SS1.1.p1.10.m6.4.4.2.1.2.cmml" xref="A3.SS1.1.p1.10.m6.4.4.2.1.1"><ci id="A3.SS1.1.p1.10.m6.2.2.cmml" xref="A3.SS1.1.p1.10.m6.2.2">𝑠</ci><apply id="A3.SS1.1.p1.10.m6.4.4.2.1.1.1.cmml" xref="A3.SS1.1.p1.10.m6.4.4.2.1.1.1"><csymbol cd="ambiguous" id="A3.SS1.1.p1.10.m6.4.4.2.1.1.1.1.cmml" xref="A3.SS1.1.p1.10.m6.4.4.2.1.1.1">superscript</csymbol><ci id="A3.SS1.1.p1.10.m6.4.4.2.1.1.1.2.cmml" xref="A3.SS1.1.p1.10.m6.4.4.2.1.1.1.2">𝑎</ci><apply id="A3.SS1.1.p1.10.m6.4.4.2.1.1.1.3.cmml" xref="A3.SS1.1.p1.10.m6.4.4.2.1.1.1.3"><times id="A3.SS1.1.p1.10.m6.4.4.2.1.1.1.3.1.cmml" xref="A3.SS1.1.p1.10.m6.4.4.2.1.1.1.3.1"></times><ci id="A3.SS1.1.p1.10.m6.4.4.2.1.1.1.3.2.cmml" xref="A3.SS1.1.p1.10.m6.4.4.2.1.1.1.3.2">𝑠</ci><ci id="A3.SS1.1.p1.10.m6.4.4.2.1.1.1.3.3.cmml" xref="A3.SS1.1.p1.10.m6.4.4.2.1.1.1.3.3">𝑢</ci><ci id="A3.SS1.1.p1.10.m6.4.4.2.1.1.1.3.4.cmml" xref="A3.SS1.1.p1.10.m6.4.4.2.1.1.1.3.4">𝑏</ci></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.1.p1.10.m6.4c">Q^{*}(s,a^{*})&gt;Q^{*}(s,a^{sub})</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.1.p1.10.m6.4d">italic_Q start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s , italic_a start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ) &gt; italic_Q start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s , italic_a start_POSTSUPERSCRIPT italic_s italic_u italic_b end_POSTSUPERSCRIPT )</annotation></semantics></math>. Next, we will prove that <math alttext="Q_{1}^{*}(s,a^{*})&gt;Q_{1}^{*}(s,a^{sub})" class="ltx_Math" display="inline" id="A3.SS1.1.p1.11.m7.4"><semantics id="A3.SS1.1.p1.11.m7.4a"><mrow id="A3.SS1.1.p1.11.m7.4.4" xref="A3.SS1.1.p1.11.m7.4.4.cmml"><mrow id="A3.SS1.1.p1.11.m7.3.3.1" xref="A3.SS1.1.p1.11.m7.3.3.1.cmml"><msubsup id="A3.SS1.1.p1.11.m7.3.3.1.3" xref="A3.SS1.1.p1.11.m7.3.3.1.3.cmml"><mi id="A3.SS1.1.p1.11.m7.3.3.1.3.2.2" xref="A3.SS1.1.p1.11.m7.3.3.1.3.2.2.cmml">Q</mi><mn id="A3.SS1.1.p1.11.m7.3.3.1.3.2.3" xref="A3.SS1.1.p1.11.m7.3.3.1.3.2.3.cmml">1</mn><mo id="A3.SS1.1.p1.11.m7.3.3.1.3.3" xref="A3.SS1.1.p1.11.m7.3.3.1.3.3.cmml">∗</mo></msubsup><mo id="A3.SS1.1.p1.11.m7.3.3.1.2" xref="A3.SS1.1.p1.11.m7.3.3.1.2.cmml">⁢</mo><mrow id="A3.SS1.1.p1.11.m7.3.3.1.1.1" xref="A3.SS1.1.p1.11.m7.3.3.1.1.2.cmml"><mo id="A3.SS1.1.p1.11.m7.3.3.1.1.1.2" stretchy="false" xref="A3.SS1.1.p1.11.m7.3.3.1.1.2.cmml">(</mo><mi id="A3.SS1.1.p1.11.m7.1.1" xref="A3.SS1.1.p1.11.m7.1.1.cmml">s</mi><mo id="A3.SS1.1.p1.11.m7.3.3.1.1.1.3" xref="A3.SS1.1.p1.11.m7.3.3.1.1.2.cmml">,</mo><msup id="A3.SS1.1.p1.11.m7.3.3.1.1.1.1" xref="A3.SS1.1.p1.11.m7.3.3.1.1.1.1.cmml"><mi id="A3.SS1.1.p1.11.m7.3.3.1.1.1.1.2" xref="A3.SS1.1.p1.11.m7.3.3.1.1.1.1.2.cmml">a</mi><mo id="A3.SS1.1.p1.11.m7.3.3.1.1.1.1.3" xref="A3.SS1.1.p1.11.m7.3.3.1.1.1.1.3.cmml">∗</mo></msup><mo id="A3.SS1.1.p1.11.m7.3.3.1.1.1.4" stretchy="false" xref="A3.SS1.1.p1.11.m7.3.3.1.1.2.cmml">)</mo></mrow></mrow><mo id="A3.SS1.1.p1.11.m7.4.4.3" xref="A3.SS1.1.p1.11.m7.4.4.3.cmml">&gt;</mo><mrow id="A3.SS1.1.p1.11.m7.4.4.2" xref="A3.SS1.1.p1.11.m7.4.4.2.cmml"><msubsup id="A3.SS1.1.p1.11.m7.4.4.2.3" xref="A3.SS1.1.p1.11.m7.4.4.2.3.cmml"><mi id="A3.SS1.1.p1.11.m7.4.4.2.3.2.2" xref="A3.SS1.1.p1.11.m7.4.4.2.3.2.2.cmml">Q</mi><mn id="A3.SS1.1.p1.11.m7.4.4.2.3.2.3" xref="A3.SS1.1.p1.11.m7.4.4.2.3.2.3.cmml">1</mn><mo id="A3.SS1.1.p1.11.m7.4.4.2.3.3" xref="A3.SS1.1.p1.11.m7.4.4.2.3.3.cmml">∗</mo></msubsup><mo id="A3.SS1.1.p1.11.m7.4.4.2.2" xref="A3.SS1.1.p1.11.m7.4.4.2.2.cmml">⁢</mo><mrow id="A3.SS1.1.p1.11.m7.4.4.2.1.1" xref="A3.SS1.1.p1.11.m7.4.4.2.1.2.cmml"><mo id="A3.SS1.1.p1.11.m7.4.4.2.1.1.2" stretchy="false" xref="A3.SS1.1.p1.11.m7.4.4.2.1.2.cmml">(</mo><mi id="A3.SS1.1.p1.11.m7.2.2" xref="A3.SS1.1.p1.11.m7.2.2.cmml">s</mi><mo id="A3.SS1.1.p1.11.m7.4.4.2.1.1.3" xref="A3.SS1.1.p1.11.m7.4.4.2.1.2.cmml">,</mo><msup id="A3.SS1.1.p1.11.m7.4.4.2.1.1.1" xref="A3.SS1.1.p1.11.m7.4.4.2.1.1.1.cmml"><mi id="A3.SS1.1.p1.11.m7.4.4.2.1.1.1.2" xref="A3.SS1.1.p1.11.m7.4.4.2.1.1.1.2.cmml">a</mi><mrow id="A3.SS1.1.p1.11.m7.4.4.2.1.1.1.3" xref="A3.SS1.1.p1.11.m7.4.4.2.1.1.1.3.cmml"><mi id="A3.SS1.1.p1.11.m7.4.4.2.1.1.1.3.2" xref="A3.SS1.1.p1.11.m7.4.4.2.1.1.1.3.2.cmml">s</mi><mo id="A3.SS1.1.p1.11.m7.4.4.2.1.1.1.3.1" xref="A3.SS1.1.p1.11.m7.4.4.2.1.1.1.3.1.cmml">⁢</mo><mi id="A3.SS1.1.p1.11.m7.4.4.2.1.1.1.3.3" xref="A3.SS1.1.p1.11.m7.4.4.2.1.1.1.3.3.cmml">u</mi><mo id="A3.SS1.1.p1.11.m7.4.4.2.1.1.1.3.1a" xref="A3.SS1.1.p1.11.m7.4.4.2.1.1.1.3.1.cmml">⁢</mo><mi id="A3.SS1.1.p1.11.m7.4.4.2.1.1.1.3.4" xref="A3.SS1.1.p1.11.m7.4.4.2.1.1.1.3.4.cmml">b</mi></mrow></msup><mo id="A3.SS1.1.p1.11.m7.4.4.2.1.1.4" stretchy="false" xref="A3.SS1.1.p1.11.m7.4.4.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.1.p1.11.m7.4b"><apply id="A3.SS1.1.p1.11.m7.4.4.cmml" xref="A3.SS1.1.p1.11.m7.4.4"><gt id="A3.SS1.1.p1.11.m7.4.4.3.cmml" xref="A3.SS1.1.p1.11.m7.4.4.3"></gt><apply id="A3.SS1.1.p1.11.m7.3.3.1.cmml" xref="A3.SS1.1.p1.11.m7.3.3.1"><times id="A3.SS1.1.p1.11.m7.3.3.1.2.cmml" xref="A3.SS1.1.p1.11.m7.3.3.1.2"></times><apply id="A3.SS1.1.p1.11.m7.3.3.1.3.cmml" xref="A3.SS1.1.p1.11.m7.3.3.1.3"><csymbol cd="ambiguous" id="A3.SS1.1.p1.11.m7.3.3.1.3.1.cmml" xref="A3.SS1.1.p1.11.m7.3.3.1.3">superscript</csymbol><apply id="A3.SS1.1.p1.11.m7.3.3.1.3.2.cmml" xref="A3.SS1.1.p1.11.m7.3.3.1.3"><csymbol cd="ambiguous" id="A3.SS1.1.p1.11.m7.3.3.1.3.2.1.cmml" xref="A3.SS1.1.p1.11.m7.3.3.1.3">subscript</csymbol><ci id="A3.SS1.1.p1.11.m7.3.3.1.3.2.2.cmml" xref="A3.SS1.1.p1.11.m7.3.3.1.3.2.2">𝑄</ci><cn id="A3.SS1.1.p1.11.m7.3.3.1.3.2.3.cmml" type="integer" xref="A3.SS1.1.p1.11.m7.3.3.1.3.2.3">1</cn></apply><times id="A3.SS1.1.p1.11.m7.3.3.1.3.3.cmml" xref="A3.SS1.1.p1.11.m7.3.3.1.3.3"></times></apply><interval closure="open" id="A3.SS1.1.p1.11.m7.3.3.1.1.2.cmml" xref="A3.SS1.1.p1.11.m7.3.3.1.1.1"><ci id="A3.SS1.1.p1.11.m7.1.1.cmml" xref="A3.SS1.1.p1.11.m7.1.1">𝑠</ci><apply id="A3.SS1.1.p1.11.m7.3.3.1.1.1.1.cmml" xref="A3.SS1.1.p1.11.m7.3.3.1.1.1.1"><csymbol cd="ambiguous" id="A3.SS1.1.p1.11.m7.3.3.1.1.1.1.1.cmml" xref="A3.SS1.1.p1.11.m7.3.3.1.1.1.1">superscript</csymbol><ci id="A3.SS1.1.p1.11.m7.3.3.1.1.1.1.2.cmml" xref="A3.SS1.1.p1.11.m7.3.3.1.1.1.1.2">𝑎</ci><times id="A3.SS1.1.p1.11.m7.3.3.1.1.1.1.3.cmml" xref="A3.SS1.1.p1.11.m7.3.3.1.1.1.1.3"></times></apply></interval></apply><apply id="A3.SS1.1.p1.11.m7.4.4.2.cmml" xref="A3.SS1.1.p1.11.m7.4.4.2"><times id="A3.SS1.1.p1.11.m7.4.4.2.2.cmml" xref="A3.SS1.1.p1.11.m7.4.4.2.2"></times><apply id="A3.SS1.1.p1.11.m7.4.4.2.3.cmml" xref="A3.SS1.1.p1.11.m7.4.4.2.3"><csymbol cd="ambiguous" id="A3.SS1.1.p1.11.m7.4.4.2.3.1.cmml" xref="A3.SS1.1.p1.11.m7.4.4.2.3">superscript</csymbol><apply id="A3.SS1.1.p1.11.m7.4.4.2.3.2.cmml" xref="A3.SS1.1.p1.11.m7.4.4.2.3"><csymbol cd="ambiguous" id="A3.SS1.1.p1.11.m7.4.4.2.3.2.1.cmml" xref="A3.SS1.1.p1.11.m7.4.4.2.3">subscript</csymbol><ci id="A3.SS1.1.p1.11.m7.4.4.2.3.2.2.cmml" xref="A3.SS1.1.p1.11.m7.4.4.2.3.2.2">𝑄</ci><cn id="A3.SS1.1.p1.11.m7.4.4.2.3.2.3.cmml" type="integer" xref="A3.SS1.1.p1.11.m7.4.4.2.3.2.3">1</cn></apply><times id="A3.SS1.1.p1.11.m7.4.4.2.3.3.cmml" xref="A3.SS1.1.p1.11.m7.4.4.2.3.3"></times></apply><interval closure="open" id="A3.SS1.1.p1.11.m7.4.4.2.1.2.cmml" xref="A3.SS1.1.p1.11.m7.4.4.2.1.1"><ci id="A3.SS1.1.p1.11.m7.2.2.cmml" xref="A3.SS1.1.p1.11.m7.2.2">𝑠</ci><apply id="A3.SS1.1.p1.11.m7.4.4.2.1.1.1.cmml" xref="A3.SS1.1.p1.11.m7.4.4.2.1.1.1"><csymbol cd="ambiguous" id="A3.SS1.1.p1.11.m7.4.4.2.1.1.1.1.cmml" xref="A3.SS1.1.p1.11.m7.4.4.2.1.1.1">superscript</csymbol><ci id="A3.SS1.1.p1.11.m7.4.4.2.1.1.1.2.cmml" xref="A3.SS1.1.p1.11.m7.4.4.2.1.1.1.2">𝑎</ci><apply id="A3.SS1.1.p1.11.m7.4.4.2.1.1.1.3.cmml" xref="A3.SS1.1.p1.11.m7.4.4.2.1.1.1.3"><times id="A3.SS1.1.p1.11.m7.4.4.2.1.1.1.3.1.cmml" xref="A3.SS1.1.p1.11.m7.4.4.2.1.1.1.3.1"></times><ci id="A3.SS1.1.p1.11.m7.4.4.2.1.1.1.3.2.cmml" xref="A3.SS1.1.p1.11.m7.4.4.2.1.1.1.3.2">𝑠</ci><ci id="A3.SS1.1.p1.11.m7.4.4.2.1.1.1.3.3.cmml" xref="A3.SS1.1.p1.11.m7.4.4.2.1.1.1.3.3">𝑢</ci><ci id="A3.SS1.1.p1.11.m7.4.4.2.1.1.1.3.4.cmml" xref="A3.SS1.1.p1.11.m7.4.4.2.1.1.1.3.4">𝑏</ci></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.1.p1.11.m7.4c">Q_{1}^{*}(s,a^{*})&gt;Q_{1}^{*}(s,a^{sub})</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.1.p1.11.m7.4d">italic_Q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s , italic_a start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ) &gt; italic_Q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s , italic_a start_POSTSUPERSCRIPT italic_s italic_u italic_b end_POSTSUPERSCRIPT )</annotation></semantics></math> holds.</p>
</div>
<div class="ltx_para" id="A3.SS1.2.p2">
<p class="ltx_p" id="A3.SS1.2.p2.2">For the optimal action <math alttext="a^{*}" class="ltx_Math" display="inline" id="A3.SS1.2.p2.1.m1.1"><semantics id="A3.SS1.2.p2.1.m1.1a"><msup id="A3.SS1.2.p2.1.m1.1.1" xref="A3.SS1.2.p2.1.m1.1.1.cmml"><mi id="A3.SS1.2.p2.1.m1.1.1.2" xref="A3.SS1.2.p2.1.m1.1.1.2.cmml">a</mi><mo id="A3.SS1.2.p2.1.m1.1.1.3" xref="A3.SS1.2.p2.1.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="A3.SS1.2.p2.1.m1.1b"><apply id="A3.SS1.2.p2.1.m1.1.1.cmml" xref="A3.SS1.2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="A3.SS1.2.p2.1.m1.1.1.1.cmml" xref="A3.SS1.2.p2.1.m1.1.1">superscript</csymbol><ci id="A3.SS1.2.p2.1.m1.1.1.2.cmml" xref="A3.SS1.2.p2.1.m1.1.1.2">𝑎</ci><times id="A3.SS1.2.p2.1.m1.1.1.3.cmml" xref="A3.SS1.2.p2.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.2.p2.1.m1.1c">a^{*}</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.2.p2.1.m1.1d">italic_a start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> and suboptimal action <math alttext="a^{sub}" class="ltx_Math" display="inline" id="A3.SS1.2.p2.2.m2.1"><semantics id="A3.SS1.2.p2.2.m2.1a"><msup id="A3.SS1.2.p2.2.m2.1.1" xref="A3.SS1.2.p2.2.m2.1.1.cmml"><mi id="A3.SS1.2.p2.2.m2.1.1.2" xref="A3.SS1.2.p2.2.m2.1.1.2.cmml">a</mi><mrow id="A3.SS1.2.p2.2.m2.1.1.3" xref="A3.SS1.2.p2.2.m2.1.1.3.cmml"><mi id="A3.SS1.2.p2.2.m2.1.1.3.2" xref="A3.SS1.2.p2.2.m2.1.1.3.2.cmml">s</mi><mo id="A3.SS1.2.p2.2.m2.1.1.3.1" xref="A3.SS1.2.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="A3.SS1.2.p2.2.m2.1.1.3.3" xref="A3.SS1.2.p2.2.m2.1.1.3.3.cmml">u</mi><mo id="A3.SS1.2.p2.2.m2.1.1.3.1a" xref="A3.SS1.2.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="A3.SS1.2.p2.2.m2.1.1.3.4" xref="A3.SS1.2.p2.2.m2.1.1.3.4.cmml">b</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="A3.SS1.2.p2.2.m2.1b"><apply id="A3.SS1.2.p2.2.m2.1.1.cmml" xref="A3.SS1.2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="A3.SS1.2.p2.2.m2.1.1.1.cmml" xref="A3.SS1.2.p2.2.m2.1.1">superscript</csymbol><ci id="A3.SS1.2.p2.2.m2.1.1.2.cmml" xref="A3.SS1.2.p2.2.m2.1.1.2">𝑎</ci><apply id="A3.SS1.2.p2.2.m2.1.1.3.cmml" xref="A3.SS1.2.p2.2.m2.1.1.3"><times id="A3.SS1.2.p2.2.m2.1.1.3.1.cmml" xref="A3.SS1.2.p2.2.m2.1.1.3.1"></times><ci id="A3.SS1.2.p2.2.m2.1.1.3.2.cmml" xref="A3.SS1.2.p2.2.m2.1.1.3.2">𝑠</ci><ci id="A3.SS1.2.p2.2.m2.1.1.3.3.cmml" xref="A3.SS1.2.p2.2.m2.1.1.3.3">𝑢</ci><ci id="A3.SS1.2.p2.2.m2.1.1.3.4.cmml" xref="A3.SS1.2.p2.2.m2.1.1.3.4">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.2.p2.2.m2.1c">a^{sub}</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.2.p2.2.m2.1d">italic_a start_POSTSUPERSCRIPT italic_s italic_u italic_b end_POSTSUPERSCRIPT</annotation></semantics></math>, we have</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A5.EGx1">
<tbody id="A3.Ex7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle Q^{*}(s,a^{*})\leq Q_{1}^{*}(s,a^{*})\leq\hat{Q}^{*}(s,a^{*})=Q^%
{*}(s,a^{*})+\frac{C}{1-\gamma}" class="ltx_Math" display="inline" id="A3.Ex7.m1.8"><semantics id="A3.Ex7.m1.8a"><mrow id="A3.Ex7.m1.8.8" xref="A3.Ex7.m1.8.8.cmml"><mrow id="A3.Ex7.m1.5.5.1" xref="A3.Ex7.m1.5.5.1.cmml"><msup id="A3.Ex7.m1.5.5.1.3" xref="A3.Ex7.m1.5.5.1.3.cmml"><mi id="A3.Ex7.m1.5.5.1.3.2" xref="A3.Ex7.m1.5.5.1.3.2.cmml">Q</mi><mo id="A3.Ex7.m1.5.5.1.3.3" xref="A3.Ex7.m1.5.5.1.3.3.cmml">∗</mo></msup><mo id="A3.Ex7.m1.5.5.1.2" xref="A3.Ex7.m1.5.5.1.2.cmml">⁢</mo><mrow id="A3.Ex7.m1.5.5.1.1.1" xref="A3.Ex7.m1.5.5.1.1.2.cmml"><mo id="A3.Ex7.m1.5.5.1.1.1.2" stretchy="false" xref="A3.Ex7.m1.5.5.1.1.2.cmml">(</mo><mi id="A3.Ex7.m1.1.1" xref="A3.Ex7.m1.1.1.cmml">s</mi><mo id="A3.Ex7.m1.5.5.1.1.1.3" xref="A3.Ex7.m1.5.5.1.1.2.cmml">,</mo><msup id="A3.Ex7.m1.5.5.1.1.1.1" xref="A3.Ex7.m1.5.5.1.1.1.1.cmml"><mi id="A3.Ex7.m1.5.5.1.1.1.1.2" xref="A3.Ex7.m1.5.5.1.1.1.1.2.cmml">a</mi><mo id="A3.Ex7.m1.5.5.1.1.1.1.3" xref="A3.Ex7.m1.5.5.1.1.1.1.3.cmml">∗</mo></msup><mo id="A3.Ex7.m1.5.5.1.1.1.4" stretchy="false" xref="A3.Ex7.m1.5.5.1.1.2.cmml">)</mo></mrow></mrow><mo id="A3.Ex7.m1.8.8.6" xref="A3.Ex7.m1.8.8.6.cmml">≤</mo><mrow id="A3.Ex7.m1.6.6.2" xref="A3.Ex7.m1.6.6.2.cmml"><msubsup id="A3.Ex7.m1.6.6.2.3" xref="A3.Ex7.m1.6.6.2.3.cmml"><mi id="A3.Ex7.m1.6.6.2.3.2.2" xref="A3.Ex7.m1.6.6.2.3.2.2.cmml">Q</mi><mn id="A3.Ex7.m1.6.6.2.3.2.3" xref="A3.Ex7.m1.6.6.2.3.2.3.cmml">1</mn><mo id="A3.Ex7.m1.6.6.2.3.3" xref="A3.Ex7.m1.6.6.2.3.3.cmml">∗</mo></msubsup><mo id="A3.Ex7.m1.6.6.2.2" xref="A3.Ex7.m1.6.6.2.2.cmml">⁢</mo><mrow id="A3.Ex7.m1.6.6.2.1.1" xref="A3.Ex7.m1.6.6.2.1.2.cmml"><mo id="A3.Ex7.m1.6.6.2.1.1.2" stretchy="false" xref="A3.Ex7.m1.6.6.2.1.2.cmml">(</mo><mi id="A3.Ex7.m1.2.2" xref="A3.Ex7.m1.2.2.cmml">s</mi><mo id="A3.Ex7.m1.6.6.2.1.1.3" xref="A3.Ex7.m1.6.6.2.1.2.cmml">,</mo><msup id="A3.Ex7.m1.6.6.2.1.1.1" xref="A3.Ex7.m1.6.6.2.1.1.1.cmml"><mi id="A3.Ex7.m1.6.6.2.1.1.1.2" xref="A3.Ex7.m1.6.6.2.1.1.1.2.cmml">a</mi><mo id="A3.Ex7.m1.6.6.2.1.1.1.3" xref="A3.Ex7.m1.6.6.2.1.1.1.3.cmml">∗</mo></msup><mo id="A3.Ex7.m1.6.6.2.1.1.4" stretchy="false" xref="A3.Ex7.m1.6.6.2.1.2.cmml">)</mo></mrow></mrow><mo id="A3.Ex7.m1.8.8.7" xref="A3.Ex7.m1.8.8.7.cmml">≤</mo><mrow id="A3.Ex7.m1.7.7.3" xref="A3.Ex7.m1.7.7.3.cmml"><msup id="A3.Ex7.m1.7.7.3.3" xref="A3.Ex7.m1.7.7.3.3.cmml"><mover accent="true" id="A3.Ex7.m1.7.7.3.3.2" xref="A3.Ex7.m1.7.7.3.3.2.cmml"><mi id="A3.Ex7.m1.7.7.3.3.2.2" xref="A3.Ex7.m1.7.7.3.3.2.2.cmml">Q</mi><mo id="A3.Ex7.m1.7.7.3.3.2.1" xref="A3.Ex7.m1.7.7.3.3.2.1.cmml">^</mo></mover><mo id="A3.Ex7.m1.7.7.3.3.3" xref="A3.Ex7.m1.7.7.3.3.3.cmml">∗</mo></msup><mo id="A3.Ex7.m1.7.7.3.2" xref="A3.Ex7.m1.7.7.3.2.cmml">⁢</mo><mrow id="A3.Ex7.m1.7.7.3.1.1" xref="A3.Ex7.m1.7.7.3.1.2.cmml"><mo id="A3.Ex7.m1.7.7.3.1.1.2" stretchy="false" xref="A3.Ex7.m1.7.7.3.1.2.cmml">(</mo><mi id="A3.Ex7.m1.3.3" xref="A3.Ex7.m1.3.3.cmml">s</mi><mo id="A3.Ex7.m1.7.7.3.1.1.3" xref="A3.Ex7.m1.7.7.3.1.2.cmml">,</mo><msup id="A3.Ex7.m1.7.7.3.1.1.1" xref="A3.Ex7.m1.7.7.3.1.1.1.cmml"><mi id="A3.Ex7.m1.7.7.3.1.1.1.2" xref="A3.Ex7.m1.7.7.3.1.1.1.2.cmml">a</mi><mo id="A3.Ex7.m1.7.7.3.1.1.1.3" xref="A3.Ex7.m1.7.7.3.1.1.1.3.cmml">∗</mo></msup><mo id="A3.Ex7.m1.7.7.3.1.1.4" stretchy="false" xref="A3.Ex7.m1.7.7.3.1.2.cmml">)</mo></mrow></mrow><mo id="A3.Ex7.m1.8.8.8" xref="A3.Ex7.m1.8.8.8.cmml">=</mo><mrow id="A3.Ex7.m1.8.8.4" xref="A3.Ex7.m1.8.8.4.cmml"><mrow id="A3.Ex7.m1.8.8.4.1" xref="A3.Ex7.m1.8.8.4.1.cmml"><msup id="A3.Ex7.m1.8.8.4.1.3" xref="A3.Ex7.m1.8.8.4.1.3.cmml"><mi id="A3.Ex7.m1.8.8.4.1.3.2" xref="A3.Ex7.m1.8.8.4.1.3.2.cmml">Q</mi><mo id="A3.Ex7.m1.8.8.4.1.3.3" xref="A3.Ex7.m1.8.8.4.1.3.3.cmml">∗</mo></msup><mo id="A3.Ex7.m1.8.8.4.1.2" xref="A3.Ex7.m1.8.8.4.1.2.cmml">⁢</mo><mrow id="A3.Ex7.m1.8.8.4.1.1.1" xref="A3.Ex7.m1.8.8.4.1.1.2.cmml"><mo id="A3.Ex7.m1.8.8.4.1.1.1.2" stretchy="false" xref="A3.Ex7.m1.8.8.4.1.1.2.cmml">(</mo><mi id="A3.Ex7.m1.4.4" xref="A3.Ex7.m1.4.4.cmml">s</mi><mo id="A3.Ex7.m1.8.8.4.1.1.1.3" xref="A3.Ex7.m1.8.8.4.1.1.2.cmml">,</mo><msup id="A3.Ex7.m1.8.8.4.1.1.1.1" xref="A3.Ex7.m1.8.8.4.1.1.1.1.cmml"><mi id="A3.Ex7.m1.8.8.4.1.1.1.1.2" xref="A3.Ex7.m1.8.8.4.1.1.1.1.2.cmml">a</mi><mo id="A3.Ex7.m1.8.8.4.1.1.1.1.3" xref="A3.Ex7.m1.8.8.4.1.1.1.1.3.cmml">∗</mo></msup><mo id="A3.Ex7.m1.8.8.4.1.1.1.4" stretchy="false" xref="A3.Ex7.m1.8.8.4.1.1.2.cmml">)</mo></mrow></mrow><mo id="A3.Ex7.m1.8.8.4.2" xref="A3.Ex7.m1.8.8.4.2.cmml">+</mo><mstyle displaystyle="true" id="A3.Ex7.m1.8.8.4.3" xref="A3.Ex7.m1.8.8.4.3.cmml"><mfrac id="A3.Ex7.m1.8.8.4.3a" xref="A3.Ex7.m1.8.8.4.3.cmml"><mi id="A3.Ex7.m1.8.8.4.3.2" xref="A3.Ex7.m1.8.8.4.3.2.cmml">C</mi><mrow id="A3.Ex7.m1.8.8.4.3.3" xref="A3.Ex7.m1.8.8.4.3.3.cmml"><mn id="A3.Ex7.m1.8.8.4.3.3.2" xref="A3.Ex7.m1.8.8.4.3.3.2.cmml">1</mn><mo id="A3.Ex7.m1.8.8.4.3.3.1" xref="A3.Ex7.m1.8.8.4.3.3.1.cmml">−</mo><mi id="A3.Ex7.m1.8.8.4.3.3.3" xref="A3.Ex7.m1.8.8.4.3.3.3.cmml">γ</mi></mrow></mfrac></mstyle></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.Ex7.m1.8b"><apply id="A3.Ex7.m1.8.8.cmml" xref="A3.Ex7.m1.8.8"><and id="A3.Ex7.m1.8.8a.cmml" xref="A3.Ex7.m1.8.8"></and><apply id="A3.Ex7.m1.8.8b.cmml" xref="A3.Ex7.m1.8.8"><leq id="A3.Ex7.m1.8.8.6.cmml" xref="A3.Ex7.m1.8.8.6"></leq><apply id="A3.Ex7.m1.5.5.1.cmml" xref="A3.Ex7.m1.5.5.1"><times id="A3.Ex7.m1.5.5.1.2.cmml" xref="A3.Ex7.m1.5.5.1.2"></times><apply id="A3.Ex7.m1.5.5.1.3.cmml" xref="A3.Ex7.m1.5.5.1.3"><csymbol cd="ambiguous" id="A3.Ex7.m1.5.5.1.3.1.cmml" xref="A3.Ex7.m1.5.5.1.3">superscript</csymbol><ci id="A3.Ex7.m1.5.5.1.3.2.cmml" xref="A3.Ex7.m1.5.5.1.3.2">𝑄</ci><times id="A3.Ex7.m1.5.5.1.3.3.cmml" xref="A3.Ex7.m1.5.5.1.3.3"></times></apply><interval closure="open" id="A3.Ex7.m1.5.5.1.1.2.cmml" xref="A3.Ex7.m1.5.5.1.1.1"><ci id="A3.Ex7.m1.1.1.cmml" xref="A3.Ex7.m1.1.1">𝑠</ci><apply id="A3.Ex7.m1.5.5.1.1.1.1.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1"><csymbol cd="ambiguous" id="A3.Ex7.m1.5.5.1.1.1.1.1.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1">superscript</csymbol><ci id="A3.Ex7.m1.5.5.1.1.1.1.2.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.2">𝑎</ci><times id="A3.Ex7.m1.5.5.1.1.1.1.3.cmml" xref="A3.Ex7.m1.5.5.1.1.1.1.3"></times></apply></interval></apply><apply id="A3.Ex7.m1.6.6.2.cmml" xref="A3.Ex7.m1.6.6.2"><times id="A3.Ex7.m1.6.6.2.2.cmml" xref="A3.Ex7.m1.6.6.2.2"></times><apply id="A3.Ex7.m1.6.6.2.3.cmml" xref="A3.Ex7.m1.6.6.2.3"><csymbol cd="ambiguous" id="A3.Ex7.m1.6.6.2.3.1.cmml" xref="A3.Ex7.m1.6.6.2.3">superscript</csymbol><apply id="A3.Ex7.m1.6.6.2.3.2.cmml" xref="A3.Ex7.m1.6.6.2.3"><csymbol cd="ambiguous" id="A3.Ex7.m1.6.6.2.3.2.1.cmml" xref="A3.Ex7.m1.6.6.2.3">subscript</csymbol><ci id="A3.Ex7.m1.6.6.2.3.2.2.cmml" xref="A3.Ex7.m1.6.6.2.3.2.2">𝑄</ci><cn id="A3.Ex7.m1.6.6.2.3.2.3.cmml" type="integer" xref="A3.Ex7.m1.6.6.2.3.2.3">1</cn></apply><times id="A3.Ex7.m1.6.6.2.3.3.cmml" xref="A3.Ex7.m1.6.6.2.3.3"></times></apply><interval closure="open" id="A3.Ex7.m1.6.6.2.1.2.cmml" xref="A3.Ex7.m1.6.6.2.1.1"><ci id="A3.Ex7.m1.2.2.cmml" xref="A3.Ex7.m1.2.2">𝑠</ci><apply id="A3.Ex7.m1.6.6.2.1.1.1.cmml" xref="A3.Ex7.m1.6.6.2.1.1.1"><csymbol cd="ambiguous" id="A3.Ex7.m1.6.6.2.1.1.1.1.cmml" xref="A3.Ex7.m1.6.6.2.1.1.1">superscript</csymbol><ci id="A3.Ex7.m1.6.6.2.1.1.1.2.cmml" xref="A3.Ex7.m1.6.6.2.1.1.1.2">𝑎</ci><times id="A3.Ex7.m1.6.6.2.1.1.1.3.cmml" xref="A3.Ex7.m1.6.6.2.1.1.1.3"></times></apply></interval></apply></apply><apply id="A3.Ex7.m1.8.8c.cmml" xref="A3.Ex7.m1.8.8"><leq id="A3.Ex7.m1.8.8.7.cmml" xref="A3.Ex7.m1.8.8.7"></leq><share href="https://arxiv.org/html/2410.04498v1#A3.Ex7.m1.6.6.2.cmml" id="A3.Ex7.m1.8.8d.cmml" xref="A3.Ex7.m1.8.8"></share><apply id="A3.Ex7.m1.7.7.3.cmml" xref="A3.Ex7.m1.7.7.3"><times id="A3.Ex7.m1.7.7.3.2.cmml" xref="A3.Ex7.m1.7.7.3.2"></times><apply id="A3.Ex7.m1.7.7.3.3.cmml" xref="A3.Ex7.m1.7.7.3.3"><csymbol cd="ambiguous" id="A3.Ex7.m1.7.7.3.3.1.cmml" xref="A3.Ex7.m1.7.7.3.3">superscript</csymbol><apply id="A3.Ex7.m1.7.7.3.3.2.cmml" xref="A3.Ex7.m1.7.7.3.3.2"><ci id="A3.Ex7.m1.7.7.3.3.2.1.cmml" xref="A3.Ex7.m1.7.7.3.3.2.1">^</ci><ci id="A3.Ex7.m1.7.7.3.3.2.2.cmml" xref="A3.Ex7.m1.7.7.3.3.2.2">𝑄</ci></apply><times id="A3.Ex7.m1.7.7.3.3.3.cmml" xref="A3.Ex7.m1.7.7.3.3.3"></times></apply><interval closure="open" id="A3.Ex7.m1.7.7.3.1.2.cmml" xref="A3.Ex7.m1.7.7.3.1.1"><ci id="A3.Ex7.m1.3.3.cmml" xref="A3.Ex7.m1.3.3">𝑠</ci><apply id="A3.Ex7.m1.7.7.3.1.1.1.cmml" xref="A3.Ex7.m1.7.7.3.1.1.1"><csymbol cd="ambiguous" id="A3.Ex7.m1.7.7.3.1.1.1.1.cmml" xref="A3.Ex7.m1.7.7.3.1.1.1">superscript</csymbol><ci id="A3.Ex7.m1.7.7.3.1.1.1.2.cmml" xref="A3.Ex7.m1.7.7.3.1.1.1.2">𝑎</ci><times id="A3.Ex7.m1.7.7.3.1.1.1.3.cmml" xref="A3.Ex7.m1.7.7.3.1.1.1.3"></times></apply></interval></apply></apply><apply id="A3.Ex7.m1.8.8e.cmml" xref="A3.Ex7.m1.8.8"><eq id="A3.Ex7.m1.8.8.8.cmml" xref="A3.Ex7.m1.8.8.8"></eq><share href="https://arxiv.org/html/2410.04498v1#A3.Ex7.m1.7.7.3.cmml" id="A3.Ex7.m1.8.8f.cmml" xref="A3.Ex7.m1.8.8"></share><apply id="A3.Ex7.m1.8.8.4.cmml" xref="A3.Ex7.m1.8.8.4"><plus id="A3.Ex7.m1.8.8.4.2.cmml" xref="A3.Ex7.m1.8.8.4.2"></plus><apply id="A3.Ex7.m1.8.8.4.1.cmml" xref="A3.Ex7.m1.8.8.4.1"><times id="A3.Ex7.m1.8.8.4.1.2.cmml" xref="A3.Ex7.m1.8.8.4.1.2"></times><apply id="A3.Ex7.m1.8.8.4.1.3.cmml" xref="A3.Ex7.m1.8.8.4.1.3"><csymbol cd="ambiguous" id="A3.Ex7.m1.8.8.4.1.3.1.cmml" xref="A3.Ex7.m1.8.8.4.1.3">superscript</csymbol><ci id="A3.Ex7.m1.8.8.4.1.3.2.cmml" xref="A3.Ex7.m1.8.8.4.1.3.2">𝑄</ci><times id="A3.Ex7.m1.8.8.4.1.3.3.cmml" xref="A3.Ex7.m1.8.8.4.1.3.3"></times></apply><interval closure="open" id="A3.Ex7.m1.8.8.4.1.1.2.cmml" xref="A3.Ex7.m1.8.8.4.1.1.1"><ci id="A3.Ex7.m1.4.4.cmml" xref="A3.Ex7.m1.4.4">𝑠</ci><apply id="A3.Ex7.m1.8.8.4.1.1.1.1.cmml" xref="A3.Ex7.m1.8.8.4.1.1.1.1"><csymbol cd="ambiguous" id="A3.Ex7.m1.8.8.4.1.1.1.1.1.cmml" xref="A3.Ex7.m1.8.8.4.1.1.1.1">superscript</csymbol><ci id="A3.Ex7.m1.8.8.4.1.1.1.1.2.cmml" xref="A3.Ex7.m1.8.8.4.1.1.1.1.2">𝑎</ci><times id="A3.Ex7.m1.8.8.4.1.1.1.1.3.cmml" xref="A3.Ex7.m1.8.8.4.1.1.1.1.3"></times></apply></interval></apply><apply id="A3.Ex7.m1.8.8.4.3.cmml" xref="A3.Ex7.m1.8.8.4.3"><divide id="A3.Ex7.m1.8.8.4.3.1.cmml" xref="A3.Ex7.m1.8.8.4.3"></divide><ci id="A3.Ex7.m1.8.8.4.3.2.cmml" xref="A3.Ex7.m1.8.8.4.3.2">𝐶</ci><apply id="A3.Ex7.m1.8.8.4.3.3.cmml" xref="A3.Ex7.m1.8.8.4.3.3"><minus id="A3.Ex7.m1.8.8.4.3.3.1.cmml" xref="A3.Ex7.m1.8.8.4.3.3.1"></minus><cn id="A3.Ex7.m1.8.8.4.3.3.2.cmml" type="integer" xref="A3.Ex7.m1.8.8.4.3.3.2">1</cn><ci id="A3.Ex7.m1.8.8.4.3.3.3.cmml" xref="A3.Ex7.m1.8.8.4.3.3.3">𝛾</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex7.m1.8c">\displaystyle Q^{*}(s,a^{*})\leq Q_{1}^{*}(s,a^{*})\leq\hat{Q}^{*}(s,a^{*})=Q^%
{*}(s,a^{*})+\frac{C}{1-\gamma}</annotation><annotation encoding="application/x-llamapun" id="A3.Ex7.m1.8d">italic_Q start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s , italic_a start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ) ≤ italic_Q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s , italic_a start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ) ≤ over^ start_ARG italic_Q end_ARG start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s , italic_a start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ) = italic_Q start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s , italic_a start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ) + divide start_ARG italic_C end_ARG start_ARG 1 - italic_γ end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A3.Ex8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle Q^{*}(s,a^{sub})\leq Q_{1}^{*}(s,a^{sub})\leq\hat{Q}^{*}(s,a^{%
sub})=Q^{*}(s,a^{sub})+\frac{C}{1-\gamma}" class="ltx_Math" display="inline" id="A3.Ex8.m1.8"><semantics id="A3.Ex8.m1.8a"><mrow id="A3.Ex8.m1.8.8" xref="A3.Ex8.m1.8.8.cmml"><mrow id="A3.Ex8.m1.5.5.1" xref="A3.Ex8.m1.5.5.1.cmml"><msup id="A3.Ex8.m1.5.5.1.3" xref="A3.Ex8.m1.5.5.1.3.cmml"><mi id="A3.Ex8.m1.5.5.1.3.2" xref="A3.Ex8.m1.5.5.1.3.2.cmml">Q</mi><mo id="A3.Ex8.m1.5.5.1.3.3" xref="A3.Ex8.m1.5.5.1.3.3.cmml">∗</mo></msup><mo id="A3.Ex8.m1.5.5.1.2" xref="A3.Ex8.m1.5.5.1.2.cmml">⁢</mo><mrow id="A3.Ex8.m1.5.5.1.1.1" xref="A3.Ex8.m1.5.5.1.1.2.cmml"><mo id="A3.Ex8.m1.5.5.1.1.1.2" stretchy="false" xref="A3.Ex8.m1.5.5.1.1.2.cmml">(</mo><mi id="A3.Ex8.m1.1.1" xref="A3.Ex8.m1.1.1.cmml">s</mi><mo id="A3.Ex8.m1.5.5.1.1.1.3" xref="A3.Ex8.m1.5.5.1.1.2.cmml">,</mo><msup id="A3.Ex8.m1.5.5.1.1.1.1" xref="A3.Ex8.m1.5.5.1.1.1.1.cmml"><mi id="A3.Ex8.m1.5.5.1.1.1.1.2" xref="A3.Ex8.m1.5.5.1.1.1.1.2.cmml">a</mi><mrow id="A3.Ex8.m1.5.5.1.1.1.1.3" xref="A3.Ex8.m1.5.5.1.1.1.1.3.cmml"><mi id="A3.Ex8.m1.5.5.1.1.1.1.3.2" xref="A3.Ex8.m1.5.5.1.1.1.1.3.2.cmml">s</mi><mo id="A3.Ex8.m1.5.5.1.1.1.1.3.1" xref="A3.Ex8.m1.5.5.1.1.1.1.3.1.cmml">⁢</mo><mi id="A3.Ex8.m1.5.5.1.1.1.1.3.3" xref="A3.Ex8.m1.5.5.1.1.1.1.3.3.cmml">u</mi><mo id="A3.Ex8.m1.5.5.1.1.1.1.3.1a" xref="A3.Ex8.m1.5.5.1.1.1.1.3.1.cmml">⁢</mo><mi id="A3.Ex8.m1.5.5.1.1.1.1.3.4" xref="A3.Ex8.m1.5.5.1.1.1.1.3.4.cmml">b</mi></mrow></msup><mo id="A3.Ex8.m1.5.5.1.1.1.4" stretchy="false" xref="A3.Ex8.m1.5.5.1.1.2.cmml">)</mo></mrow></mrow><mo id="A3.Ex8.m1.8.8.6" xref="A3.Ex8.m1.8.8.6.cmml">≤</mo><mrow id="A3.Ex8.m1.6.6.2" xref="A3.Ex8.m1.6.6.2.cmml"><msubsup id="A3.Ex8.m1.6.6.2.3" xref="A3.Ex8.m1.6.6.2.3.cmml"><mi id="A3.Ex8.m1.6.6.2.3.2.2" xref="A3.Ex8.m1.6.6.2.3.2.2.cmml">Q</mi><mn id="A3.Ex8.m1.6.6.2.3.2.3" xref="A3.Ex8.m1.6.6.2.3.2.3.cmml">1</mn><mo id="A3.Ex8.m1.6.6.2.3.3" xref="A3.Ex8.m1.6.6.2.3.3.cmml">∗</mo></msubsup><mo id="A3.Ex8.m1.6.6.2.2" xref="A3.Ex8.m1.6.6.2.2.cmml">⁢</mo><mrow id="A3.Ex8.m1.6.6.2.1.1" xref="A3.Ex8.m1.6.6.2.1.2.cmml"><mo id="A3.Ex8.m1.6.6.2.1.1.2" stretchy="false" xref="A3.Ex8.m1.6.6.2.1.2.cmml">(</mo><mi id="A3.Ex8.m1.2.2" xref="A3.Ex8.m1.2.2.cmml">s</mi><mo id="A3.Ex8.m1.6.6.2.1.1.3" xref="A3.Ex8.m1.6.6.2.1.2.cmml">,</mo><msup id="A3.Ex8.m1.6.6.2.1.1.1" xref="A3.Ex8.m1.6.6.2.1.1.1.cmml"><mi id="A3.Ex8.m1.6.6.2.1.1.1.2" xref="A3.Ex8.m1.6.6.2.1.1.1.2.cmml">a</mi><mrow id="A3.Ex8.m1.6.6.2.1.1.1.3" xref="A3.Ex8.m1.6.6.2.1.1.1.3.cmml"><mi id="A3.Ex8.m1.6.6.2.1.1.1.3.2" xref="A3.Ex8.m1.6.6.2.1.1.1.3.2.cmml">s</mi><mo id="A3.Ex8.m1.6.6.2.1.1.1.3.1" xref="A3.Ex8.m1.6.6.2.1.1.1.3.1.cmml">⁢</mo><mi id="A3.Ex8.m1.6.6.2.1.1.1.3.3" xref="A3.Ex8.m1.6.6.2.1.1.1.3.3.cmml">u</mi><mo id="A3.Ex8.m1.6.6.2.1.1.1.3.1a" xref="A3.Ex8.m1.6.6.2.1.1.1.3.1.cmml">⁢</mo><mi id="A3.Ex8.m1.6.6.2.1.1.1.3.4" xref="A3.Ex8.m1.6.6.2.1.1.1.3.4.cmml">b</mi></mrow></msup><mo id="A3.Ex8.m1.6.6.2.1.1.4" stretchy="false" xref="A3.Ex8.m1.6.6.2.1.2.cmml">)</mo></mrow></mrow><mo id="A3.Ex8.m1.8.8.7" xref="A3.Ex8.m1.8.8.7.cmml">≤</mo><mrow id="A3.Ex8.m1.7.7.3" xref="A3.Ex8.m1.7.7.3.cmml"><msup id="A3.Ex8.m1.7.7.3.3" xref="A3.Ex8.m1.7.7.3.3.cmml"><mover accent="true" id="A3.Ex8.m1.7.7.3.3.2" xref="A3.Ex8.m1.7.7.3.3.2.cmml"><mi id="A3.Ex8.m1.7.7.3.3.2.2" xref="A3.Ex8.m1.7.7.3.3.2.2.cmml">Q</mi><mo id="A3.Ex8.m1.7.7.3.3.2.1" xref="A3.Ex8.m1.7.7.3.3.2.1.cmml">^</mo></mover><mo id="A3.Ex8.m1.7.7.3.3.3" xref="A3.Ex8.m1.7.7.3.3.3.cmml">∗</mo></msup><mo id="A3.Ex8.m1.7.7.3.2" xref="A3.Ex8.m1.7.7.3.2.cmml">⁢</mo><mrow id="A3.Ex8.m1.7.7.3.1.1" xref="A3.Ex8.m1.7.7.3.1.2.cmml"><mo id="A3.Ex8.m1.7.7.3.1.1.2" stretchy="false" xref="A3.Ex8.m1.7.7.3.1.2.cmml">(</mo><mi id="A3.Ex8.m1.3.3" xref="A3.Ex8.m1.3.3.cmml">s</mi><mo id="A3.Ex8.m1.7.7.3.1.1.3" xref="A3.Ex8.m1.7.7.3.1.2.cmml">,</mo><msup id="A3.Ex8.m1.7.7.3.1.1.1" xref="A3.Ex8.m1.7.7.3.1.1.1.cmml"><mi id="A3.Ex8.m1.7.7.3.1.1.1.2" xref="A3.Ex8.m1.7.7.3.1.1.1.2.cmml">a</mi><mrow id="A3.Ex8.m1.7.7.3.1.1.1.3" xref="A3.Ex8.m1.7.7.3.1.1.1.3.cmml"><mi id="A3.Ex8.m1.7.7.3.1.1.1.3.2" xref="A3.Ex8.m1.7.7.3.1.1.1.3.2.cmml">s</mi><mo id="A3.Ex8.m1.7.7.3.1.1.1.3.1" xref="A3.Ex8.m1.7.7.3.1.1.1.3.1.cmml">⁢</mo><mi id="A3.Ex8.m1.7.7.3.1.1.1.3.3" xref="A3.Ex8.m1.7.7.3.1.1.1.3.3.cmml">u</mi><mo id="A3.Ex8.m1.7.7.3.1.1.1.3.1a" xref="A3.Ex8.m1.7.7.3.1.1.1.3.1.cmml">⁢</mo><mi id="A3.Ex8.m1.7.7.3.1.1.1.3.4" xref="A3.Ex8.m1.7.7.3.1.1.1.3.4.cmml">b</mi></mrow></msup><mo id="A3.Ex8.m1.7.7.3.1.1.4" stretchy="false" xref="A3.Ex8.m1.7.7.3.1.2.cmml">)</mo></mrow></mrow><mo id="A3.Ex8.m1.8.8.8" xref="A3.Ex8.m1.8.8.8.cmml">=</mo><mrow id="A3.Ex8.m1.8.8.4" xref="A3.Ex8.m1.8.8.4.cmml"><mrow id="A3.Ex8.m1.8.8.4.1" xref="A3.Ex8.m1.8.8.4.1.cmml"><msup id="A3.Ex8.m1.8.8.4.1.3" xref="A3.Ex8.m1.8.8.4.1.3.cmml"><mi id="A3.Ex8.m1.8.8.4.1.3.2" xref="A3.Ex8.m1.8.8.4.1.3.2.cmml">Q</mi><mo id="A3.Ex8.m1.8.8.4.1.3.3" xref="A3.Ex8.m1.8.8.4.1.3.3.cmml">∗</mo></msup><mo id="A3.Ex8.m1.8.8.4.1.2" xref="A3.Ex8.m1.8.8.4.1.2.cmml">⁢</mo><mrow id="A3.Ex8.m1.8.8.4.1.1.1" xref="A3.Ex8.m1.8.8.4.1.1.2.cmml"><mo id="A3.Ex8.m1.8.8.4.1.1.1.2" stretchy="false" xref="A3.Ex8.m1.8.8.4.1.1.2.cmml">(</mo><mi id="A3.Ex8.m1.4.4" xref="A3.Ex8.m1.4.4.cmml">s</mi><mo id="A3.Ex8.m1.8.8.4.1.1.1.3" xref="A3.Ex8.m1.8.8.4.1.1.2.cmml">,</mo><msup id="A3.Ex8.m1.8.8.4.1.1.1.1" xref="A3.Ex8.m1.8.8.4.1.1.1.1.cmml"><mi id="A3.Ex8.m1.8.8.4.1.1.1.1.2" xref="A3.Ex8.m1.8.8.4.1.1.1.1.2.cmml">a</mi><mrow id="A3.Ex8.m1.8.8.4.1.1.1.1.3" xref="A3.Ex8.m1.8.8.4.1.1.1.1.3.cmml"><mi id="A3.Ex8.m1.8.8.4.1.1.1.1.3.2" xref="A3.Ex8.m1.8.8.4.1.1.1.1.3.2.cmml">s</mi><mo id="A3.Ex8.m1.8.8.4.1.1.1.1.3.1" xref="A3.Ex8.m1.8.8.4.1.1.1.1.3.1.cmml">⁢</mo><mi id="A3.Ex8.m1.8.8.4.1.1.1.1.3.3" xref="A3.Ex8.m1.8.8.4.1.1.1.1.3.3.cmml">u</mi><mo id="A3.Ex8.m1.8.8.4.1.1.1.1.3.1a" xref="A3.Ex8.m1.8.8.4.1.1.1.1.3.1.cmml">⁢</mo><mi id="A3.Ex8.m1.8.8.4.1.1.1.1.3.4" xref="A3.Ex8.m1.8.8.4.1.1.1.1.3.4.cmml">b</mi></mrow></msup><mo id="A3.Ex8.m1.8.8.4.1.1.1.4" stretchy="false" xref="A3.Ex8.m1.8.8.4.1.1.2.cmml">)</mo></mrow></mrow><mo id="A3.Ex8.m1.8.8.4.2" xref="A3.Ex8.m1.8.8.4.2.cmml">+</mo><mstyle displaystyle="true" id="A3.Ex8.m1.8.8.4.3" xref="A3.Ex8.m1.8.8.4.3.cmml"><mfrac id="A3.Ex8.m1.8.8.4.3a" xref="A3.Ex8.m1.8.8.4.3.cmml"><mi id="A3.Ex8.m1.8.8.4.3.2" xref="A3.Ex8.m1.8.8.4.3.2.cmml">C</mi><mrow id="A3.Ex8.m1.8.8.4.3.3" xref="A3.Ex8.m1.8.8.4.3.3.cmml"><mn id="A3.Ex8.m1.8.8.4.3.3.2" xref="A3.Ex8.m1.8.8.4.3.3.2.cmml">1</mn><mo id="A3.Ex8.m1.8.8.4.3.3.1" xref="A3.Ex8.m1.8.8.4.3.3.1.cmml">−</mo><mi id="A3.Ex8.m1.8.8.4.3.3.3" xref="A3.Ex8.m1.8.8.4.3.3.3.cmml">γ</mi></mrow></mfrac></mstyle></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.Ex8.m1.8b"><apply id="A3.Ex8.m1.8.8.cmml" xref="A3.Ex8.m1.8.8"><and id="A3.Ex8.m1.8.8a.cmml" xref="A3.Ex8.m1.8.8"></and><apply id="A3.Ex8.m1.8.8b.cmml" xref="A3.Ex8.m1.8.8"><leq id="A3.Ex8.m1.8.8.6.cmml" xref="A3.Ex8.m1.8.8.6"></leq><apply id="A3.Ex8.m1.5.5.1.cmml" xref="A3.Ex8.m1.5.5.1"><times id="A3.Ex8.m1.5.5.1.2.cmml" xref="A3.Ex8.m1.5.5.1.2"></times><apply id="A3.Ex8.m1.5.5.1.3.cmml" xref="A3.Ex8.m1.5.5.1.3"><csymbol cd="ambiguous" id="A3.Ex8.m1.5.5.1.3.1.cmml" xref="A3.Ex8.m1.5.5.1.3">superscript</csymbol><ci id="A3.Ex8.m1.5.5.1.3.2.cmml" xref="A3.Ex8.m1.5.5.1.3.2">𝑄</ci><times id="A3.Ex8.m1.5.5.1.3.3.cmml" xref="A3.Ex8.m1.5.5.1.3.3"></times></apply><interval closure="open" id="A3.Ex8.m1.5.5.1.1.2.cmml" xref="A3.Ex8.m1.5.5.1.1.1"><ci id="A3.Ex8.m1.1.1.cmml" xref="A3.Ex8.m1.1.1">𝑠</ci><apply id="A3.Ex8.m1.5.5.1.1.1.1.cmml" xref="A3.Ex8.m1.5.5.1.1.1.1"><csymbol cd="ambiguous" id="A3.Ex8.m1.5.5.1.1.1.1.1.cmml" xref="A3.Ex8.m1.5.5.1.1.1.1">superscript</csymbol><ci id="A3.Ex8.m1.5.5.1.1.1.1.2.cmml" xref="A3.Ex8.m1.5.5.1.1.1.1.2">𝑎</ci><apply id="A3.Ex8.m1.5.5.1.1.1.1.3.cmml" xref="A3.Ex8.m1.5.5.1.1.1.1.3"><times id="A3.Ex8.m1.5.5.1.1.1.1.3.1.cmml" xref="A3.Ex8.m1.5.5.1.1.1.1.3.1"></times><ci id="A3.Ex8.m1.5.5.1.1.1.1.3.2.cmml" xref="A3.Ex8.m1.5.5.1.1.1.1.3.2">𝑠</ci><ci id="A3.Ex8.m1.5.5.1.1.1.1.3.3.cmml" xref="A3.Ex8.m1.5.5.1.1.1.1.3.3">𝑢</ci><ci id="A3.Ex8.m1.5.5.1.1.1.1.3.4.cmml" xref="A3.Ex8.m1.5.5.1.1.1.1.3.4">𝑏</ci></apply></apply></interval></apply><apply id="A3.Ex8.m1.6.6.2.cmml" xref="A3.Ex8.m1.6.6.2"><times id="A3.Ex8.m1.6.6.2.2.cmml" xref="A3.Ex8.m1.6.6.2.2"></times><apply id="A3.Ex8.m1.6.6.2.3.cmml" xref="A3.Ex8.m1.6.6.2.3"><csymbol cd="ambiguous" id="A3.Ex8.m1.6.6.2.3.1.cmml" xref="A3.Ex8.m1.6.6.2.3">superscript</csymbol><apply id="A3.Ex8.m1.6.6.2.3.2.cmml" xref="A3.Ex8.m1.6.6.2.3"><csymbol cd="ambiguous" id="A3.Ex8.m1.6.6.2.3.2.1.cmml" xref="A3.Ex8.m1.6.6.2.3">subscript</csymbol><ci id="A3.Ex8.m1.6.6.2.3.2.2.cmml" xref="A3.Ex8.m1.6.6.2.3.2.2">𝑄</ci><cn id="A3.Ex8.m1.6.6.2.3.2.3.cmml" type="integer" xref="A3.Ex8.m1.6.6.2.3.2.3">1</cn></apply><times id="A3.Ex8.m1.6.6.2.3.3.cmml" xref="A3.Ex8.m1.6.6.2.3.3"></times></apply><interval closure="open" id="A3.Ex8.m1.6.6.2.1.2.cmml" xref="A3.Ex8.m1.6.6.2.1.1"><ci id="A3.Ex8.m1.2.2.cmml" xref="A3.Ex8.m1.2.2">𝑠</ci><apply id="A3.Ex8.m1.6.6.2.1.1.1.cmml" xref="A3.Ex8.m1.6.6.2.1.1.1"><csymbol cd="ambiguous" id="A3.Ex8.m1.6.6.2.1.1.1.1.cmml" xref="A3.Ex8.m1.6.6.2.1.1.1">superscript</csymbol><ci id="A3.Ex8.m1.6.6.2.1.1.1.2.cmml" xref="A3.Ex8.m1.6.6.2.1.1.1.2">𝑎</ci><apply id="A3.Ex8.m1.6.6.2.1.1.1.3.cmml" xref="A3.Ex8.m1.6.6.2.1.1.1.3"><times id="A3.Ex8.m1.6.6.2.1.1.1.3.1.cmml" xref="A3.Ex8.m1.6.6.2.1.1.1.3.1"></times><ci id="A3.Ex8.m1.6.6.2.1.1.1.3.2.cmml" xref="A3.Ex8.m1.6.6.2.1.1.1.3.2">𝑠</ci><ci id="A3.Ex8.m1.6.6.2.1.1.1.3.3.cmml" xref="A3.Ex8.m1.6.6.2.1.1.1.3.3">𝑢</ci><ci id="A3.Ex8.m1.6.6.2.1.1.1.3.4.cmml" xref="A3.Ex8.m1.6.6.2.1.1.1.3.4">𝑏</ci></apply></apply></interval></apply></apply><apply id="A3.Ex8.m1.8.8c.cmml" xref="A3.Ex8.m1.8.8"><leq id="A3.Ex8.m1.8.8.7.cmml" xref="A3.Ex8.m1.8.8.7"></leq><share href="https://arxiv.org/html/2410.04498v1#A3.Ex8.m1.6.6.2.cmml" id="A3.Ex8.m1.8.8d.cmml" xref="A3.Ex8.m1.8.8"></share><apply id="A3.Ex8.m1.7.7.3.cmml" xref="A3.Ex8.m1.7.7.3"><times id="A3.Ex8.m1.7.7.3.2.cmml" xref="A3.Ex8.m1.7.7.3.2"></times><apply id="A3.Ex8.m1.7.7.3.3.cmml" xref="A3.Ex8.m1.7.7.3.3"><csymbol cd="ambiguous" id="A3.Ex8.m1.7.7.3.3.1.cmml" xref="A3.Ex8.m1.7.7.3.3">superscript</csymbol><apply id="A3.Ex8.m1.7.7.3.3.2.cmml" xref="A3.Ex8.m1.7.7.3.3.2"><ci id="A3.Ex8.m1.7.7.3.3.2.1.cmml" xref="A3.Ex8.m1.7.7.3.3.2.1">^</ci><ci id="A3.Ex8.m1.7.7.3.3.2.2.cmml" xref="A3.Ex8.m1.7.7.3.3.2.2">𝑄</ci></apply><times id="A3.Ex8.m1.7.7.3.3.3.cmml" xref="A3.Ex8.m1.7.7.3.3.3"></times></apply><interval closure="open" id="A3.Ex8.m1.7.7.3.1.2.cmml" xref="A3.Ex8.m1.7.7.3.1.1"><ci id="A3.Ex8.m1.3.3.cmml" xref="A3.Ex8.m1.3.3">𝑠</ci><apply id="A3.Ex8.m1.7.7.3.1.1.1.cmml" xref="A3.Ex8.m1.7.7.3.1.1.1"><csymbol cd="ambiguous" id="A3.Ex8.m1.7.7.3.1.1.1.1.cmml" xref="A3.Ex8.m1.7.7.3.1.1.1">superscript</csymbol><ci id="A3.Ex8.m1.7.7.3.1.1.1.2.cmml" xref="A3.Ex8.m1.7.7.3.1.1.1.2">𝑎</ci><apply id="A3.Ex8.m1.7.7.3.1.1.1.3.cmml" xref="A3.Ex8.m1.7.7.3.1.1.1.3"><times id="A3.Ex8.m1.7.7.3.1.1.1.3.1.cmml" xref="A3.Ex8.m1.7.7.3.1.1.1.3.1"></times><ci id="A3.Ex8.m1.7.7.3.1.1.1.3.2.cmml" xref="A3.Ex8.m1.7.7.3.1.1.1.3.2">𝑠</ci><ci id="A3.Ex8.m1.7.7.3.1.1.1.3.3.cmml" xref="A3.Ex8.m1.7.7.3.1.1.1.3.3">𝑢</ci><ci id="A3.Ex8.m1.7.7.3.1.1.1.3.4.cmml" xref="A3.Ex8.m1.7.7.3.1.1.1.3.4">𝑏</ci></apply></apply></interval></apply></apply><apply id="A3.Ex8.m1.8.8e.cmml" xref="A3.Ex8.m1.8.8"><eq id="A3.Ex8.m1.8.8.8.cmml" xref="A3.Ex8.m1.8.8.8"></eq><share href="https://arxiv.org/html/2410.04498v1#A3.Ex8.m1.7.7.3.cmml" id="A3.Ex8.m1.8.8f.cmml" xref="A3.Ex8.m1.8.8"></share><apply id="A3.Ex8.m1.8.8.4.cmml" xref="A3.Ex8.m1.8.8.4"><plus id="A3.Ex8.m1.8.8.4.2.cmml" xref="A3.Ex8.m1.8.8.4.2"></plus><apply id="A3.Ex8.m1.8.8.4.1.cmml" xref="A3.Ex8.m1.8.8.4.1"><times id="A3.Ex8.m1.8.8.4.1.2.cmml" xref="A3.Ex8.m1.8.8.4.1.2"></times><apply id="A3.Ex8.m1.8.8.4.1.3.cmml" xref="A3.Ex8.m1.8.8.4.1.3"><csymbol cd="ambiguous" id="A3.Ex8.m1.8.8.4.1.3.1.cmml" xref="A3.Ex8.m1.8.8.4.1.3">superscript</csymbol><ci id="A3.Ex8.m1.8.8.4.1.3.2.cmml" xref="A3.Ex8.m1.8.8.4.1.3.2">𝑄</ci><times id="A3.Ex8.m1.8.8.4.1.3.3.cmml" xref="A3.Ex8.m1.8.8.4.1.3.3"></times></apply><interval closure="open" id="A3.Ex8.m1.8.8.4.1.1.2.cmml" xref="A3.Ex8.m1.8.8.4.1.1.1"><ci id="A3.Ex8.m1.4.4.cmml" xref="A3.Ex8.m1.4.4">𝑠</ci><apply id="A3.Ex8.m1.8.8.4.1.1.1.1.cmml" xref="A3.Ex8.m1.8.8.4.1.1.1.1"><csymbol cd="ambiguous" id="A3.Ex8.m1.8.8.4.1.1.1.1.1.cmml" xref="A3.Ex8.m1.8.8.4.1.1.1.1">superscript</csymbol><ci id="A3.Ex8.m1.8.8.4.1.1.1.1.2.cmml" xref="A3.Ex8.m1.8.8.4.1.1.1.1.2">𝑎</ci><apply id="A3.Ex8.m1.8.8.4.1.1.1.1.3.cmml" xref="A3.Ex8.m1.8.8.4.1.1.1.1.3"><times id="A3.Ex8.m1.8.8.4.1.1.1.1.3.1.cmml" xref="A3.Ex8.m1.8.8.4.1.1.1.1.3.1"></times><ci id="A3.Ex8.m1.8.8.4.1.1.1.1.3.2.cmml" xref="A3.Ex8.m1.8.8.4.1.1.1.1.3.2">𝑠</ci><ci id="A3.Ex8.m1.8.8.4.1.1.1.1.3.3.cmml" xref="A3.Ex8.m1.8.8.4.1.1.1.1.3.3">𝑢</ci><ci id="A3.Ex8.m1.8.8.4.1.1.1.1.3.4.cmml" xref="A3.Ex8.m1.8.8.4.1.1.1.1.3.4">𝑏</ci></apply></apply></interval></apply><apply id="A3.Ex8.m1.8.8.4.3.cmml" xref="A3.Ex8.m1.8.8.4.3"><divide id="A3.Ex8.m1.8.8.4.3.1.cmml" xref="A3.Ex8.m1.8.8.4.3"></divide><ci id="A3.Ex8.m1.8.8.4.3.2.cmml" xref="A3.Ex8.m1.8.8.4.3.2">𝐶</ci><apply id="A3.Ex8.m1.8.8.4.3.3.cmml" xref="A3.Ex8.m1.8.8.4.3.3"><minus id="A3.Ex8.m1.8.8.4.3.3.1.cmml" xref="A3.Ex8.m1.8.8.4.3.3.1"></minus><cn id="A3.Ex8.m1.8.8.4.3.3.2.cmml" type="integer" xref="A3.Ex8.m1.8.8.4.3.3.2">1</cn><ci id="A3.Ex8.m1.8.8.4.3.3.3.cmml" xref="A3.Ex8.m1.8.8.4.3.3.3">𝛾</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex8.m1.8c">\displaystyle Q^{*}(s,a^{sub})\leq Q_{1}^{*}(s,a^{sub})\leq\hat{Q}^{*}(s,a^{%
sub})=Q^{*}(s,a^{sub})+\frac{C}{1-\gamma}</annotation><annotation encoding="application/x-llamapun" id="A3.Ex8.m1.8d">italic_Q start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s , italic_a start_POSTSUPERSCRIPT italic_s italic_u italic_b end_POSTSUPERSCRIPT ) ≤ italic_Q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s , italic_a start_POSTSUPERSCRIPT italic_s italic_u italic_b end_POSTSUPERSCRIPT ) ≤ over^ start_ARG italic_Q end_ARG start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s , italic_a start_POSTSUPERSCRIPT italic_s italic_u italic_b end_POSTSUPERSCRIPT ) = italic_Q start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s , italic_a start_POSTSUPERSCRIPT italic_s italic_u italic_b end_POSTSUPERSCRIPT ) + divide start_ARG italic_C end_ARG start_ARG 1 - italic_γ end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A3.SS1.2.p2.6">By simplifying, we have</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A5.EGx2">
<tbody id="A3.Ex9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle Q_{1}^{*}(s,a^{*})-Q_{1}^{*}(s,a^{sub})&gt;Q^{*}(s,a^{*})-Q^{*}(s,a%
^{sub})-\frac{C}{1-\gamma}" class="ltx_Math" display="inline" id="A3.Ex9.m1.8"><semantics id="A3.Ex9.m1.8a"><mrow id="A3.Ex9.m1.8.8" xref="A3.Ex9.m1.8.8.cmml"><mrow id="A3.Ex9.m1.6.6.2" xref="A3.Ex9.m1.6.6.2.cmml"><mrow id="A3.Ex9.m1.5.5.1.1" xref="A3.Ex9.m1.5.5.1.1.cmml"><msubsup id="A3.Ex9.m1.5.5.1.1.3" xref="A3.Ex9.m1.5.5.1.1.3.cmml"><mi id="A3.Ex9.m1.5.5.1.1.3.2.2" xref="A3.Ex9.m1.5.5.1.1.3.2.2.cmml">Q</mi><mn id="A3.Ex9.m1.5.5.1.1.3.2.3" xref="A3.Ex9.m1.5.5.1.1.3.2.3.cmml">1</mn><mo id="A3.Ex9.m1.5.5.1.1.3.3" xref="A3.Ex9.m1.5.5.1.1.3.3.cmml">∗</mo></msubsup><mo id="A3.Ex9.m1.5.5.1.1.2" xref="A3.Ex9.m1.5.5.1.1.2.cmml">⁢</mo><mrow id="A3.Ex9.m1.5.5.1.1.1.1" xref="A3.Ex9.m1.5.5.1.1.1.2.cmml"><mo id="A3.Ex9.m1.5.5.1.1.1.1.2" stretchy="false" xref="A3.Ex9.m1.5.5.1.1.1.2.cmml">(</mo><mi id="A3.Ex9.m1.1.1" xref="A3.Ex9.m1.1.1.cmml">s</mi><mo id="A3.Ex9.m1.5.5.1.1.1.1.3" xref="A3.Ex9.m1.5.5.1.1.1.2.cmml">,</mo><msup id="A3.Ex9.m1.5.5.1.1.1.1.1" xref="A3.Ex9.m1.5.5.1.1.1.1.1.cmml"><mi id="A3.Ex9.m1.5.5.1.1.1.1.1.2" xref="A3.Ex9.m1.5.5.1.1.1.1.1.2.cmml">a</mi><mo id="A3.Ex9.m1.5.5.1.1.1.1.1.3" xref="A3.Ex9.m1.5.5.1.1.1.1.1.3.cmml">∗</mo></msup><mo id="A3.Ex9.m1.5.5.1.1.1.1.4" stretchy="false" xref="A3.Ex9.m1.5.5.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A3.Ex9.m1.6.6.2.3" xref="A3.Ex9.m1.6.6.2.3.cmml">−</mo><mrow id="A3.Ex9.m1.6.6.2.2" xref="A3.Ex9.m1.6.6.2.2.cmml"><msubsup id="A3.Ex9.m1.6.6.2.2.3" xref="A3.Ex9.m1.6.6.2.2.3.cmml"><mi id="A3.Ex9.m1.6.6.2.2.3.2.2" xref="A3.Ex9.m1.6.6.2.2.3.2.2.cmml">Q</mi><mn id="A3.Ex9.m1.6.6.2.2.3.2.3" xref="A3.Ex9.m1.6.6.2.2.3.2.3.cmml">1</mn><mo id="A3.Ex9.m1.6.6.2.2.3.3" xref="A3.Ex9.m1.6.6.2.2.3.3.cmml">∗</mo></msubsup><mo id="A3.Ex9.m1.6.6.2.2.2" xref="A3.Ex9.m1.6.6.2.2.2.cmml">⁢</mo><mrow id="A3.Ex9.m1.6.6.2.2.1.1" xref="A3.Ex9.m1.6.6.2.2.1.2.cmml"><mo id="A3.Ex9.m1.6.6.2.2.1.1.2" stretchy="false" xref="A3.Ex9.m1.6.6.2.2.1.2.cmml">(</mo><mi id="A3.Ex9.m1.2.2" xref="A3.Ex9.m1.2.2.cmml">s</mi><mo id="A3.Ex9.m1.6.6.2.2.1.1.3" xref="A3.Ex9.m1.6.6.2.2.1.2.cmml">,</mo><msup id="A3.Ex9.m1.6.6.2.2.1.1.1" xref="A3.Ex9.m1.6.6.2.2.1.1.1.cmml"><mi id="A3.Ex9.m1.6.6.2.2.1.1.1.2" xref="A3.Ex9.m1.6.6.2.2.1.1.1.2.cmml">a</mi><mrow id="A3.Ex9.m1.6.6.2.2.1.1.1.3" xref="A3.Ex9.m1.6.6.2.2.1.1.1.3.cmml"><mi id="A3.Ex9.m1.6.6.2.2.1.1.1.3.2" xref="A3.Ex9.m1.6.6.2.2.1.1.1.3.2.cmml">s</mi><mo id="A3.Ex9.m1.6.6.2.2.1.1.1.3.1" xref="A3.Ex9.m1.6.6.2.2.1.1.1.3.1.cmml">⁢</mo><mi id="A3.Ex9.m1.6.6.2.2.1.1.1.3.3" xref="A3.Ex9.m1.6.6.2.2.1.1.1.3.3.cmml">u</mi><mo id="A3.Ex9.m1.6.6.2.2.1.1.1.3.1a" xref="A3.Ex9.m1.6.6.2.2.1.1.1.3.1.cmml">⁢</mo><mi id="A3.Ex9.m1.6.6.2.2.1.1.1.3.4" xref="A3.Ex9.m1.6.6.2.2.1.1.1.3.4.cmml">b</mi></mrow></msup><mo id="A3.Ex9.m1.6.6.2.2.1.1.4" stretchy="false" xref="A3.Ex9.m1.6.6.2.2.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="A3.Ex9.m1.8.8.5" xref="A3.Ex9.m1.8.8.5.cmml">&gt;</mo><mrow id="A3.Ex9.m1.8.8.4" xref="A3.Ex9.m1.8.8.4.cmml"><mrow id="A3.Ex9.m1.7.7.3.1" xref="A3.Ex9.m1.7.7.3.1.cmml"><msup id="A3.Ex9.m1.7.7.3.1.3" xref="A3.Ex9.m1.7.7.3.1.3.cmml"><mi id="A3.Ex9.m1.7.7.3.1.3.2" xref="A3.Ex9.m1.7.7.3.1.3.2.cmml">Q</mi><mo id="A3.Ex9.m1.7.7.3.1.3.3" xref="A3.Ex9.m1.7.7.3.1.3.3.cmml">∗</mo></msup><mo id="A3.Ex9.m1.7.7.3.1.2" xref="A3.Ex9.m1.7.7.3.1.2.cmml">⁢</mo><mrow id="A3.Ex9.m1.7.7.3.1.1.1" xref="A3.Ex9.m1.7.7.3.1.1.2.cmml"><mo id="A3.Ex9.m1.7.7.3.1.1.1.2" stretchy="false" xref="A3.Ex9.m1.7.7.3.1.1.2.cmml">(</mo><mi id="A3.Ex9.m1.3.3" xref="A3.Ex9.m1.3.3.cmml">s</mi><mo id="A3.Ex9.m1.7.7.3.1.1.1.3" xref="A3.Ex9.m1.7.7.3.1.1.2.cmml">,</mo><msup id="A3.Ex9.m1.7.7.3.1.1.1.1" xref="A3.Ex9.m1.7.7.3.1.1.1.1.cmml"><mi id="A3.Ex9.m1.7.7.3.1.1.1.1.2" xref="A3.Ex9.m1.7.7.3.1.1.1.1.2.cmml">a</mi><mo id="A3.Ex9.m1.7.7.3.1.1.1.1.3" xref="A3.Ex9.m1.7.7.3.1.1.1.1.3.cmml">∗</mo></msup><mo id="A3.Ex9.m1.7.7.3.1.1.1.4" stretchy="false" xref="A3.Ex9.m1.7.7.3.1.1.2.cmml">)</mo></mrow></mrow><mo id="A3.Ex9.m1.8.8.4.3" xref="A3.Ex9.m1.8.8.4.3.cmml">−</mo><mrow id="A3.Ex9.m1.8.8.4.2" xref="A3.Ex9.m1.8.8.4.2.cmml"><msup id="A3.Ex9.m1.8.8.4.2.3" xref="A3.Ex9.m1.8.8.4.2.3.cmml"><mi id="A3.Ex9.m1.8.8.4.2.3.2" xref="A3.Ex9.m1.8.8.4.2.3.2.cmml">Q</mi><mo id="A3.Ex9.m1.8.8.4.2.3.3" xref="A3.Ex9.m1.8.8.4.2.3.3.cmml">∗</mo></msup><mo id="A3.Ex9.m1.8.8.4.2.2" xref="A3.Ex9.m1.8.8.4.2.2.cmml">⁢</mo><mrow id="A3.Ex9.m1.8.8.4.2.1.1" xref="A3.Ex9.m1.8.8.4.2.1.2.cmml"><mo id="A3.Ex9.m1.8.8.4.2.1.1.2" stretchy="false" xref="A3.Ex9.m1.8.8.4.2.1.2.cmml">(</mo><mi id="A3.Ex9.m1.4.4" xref="A3.Ex9.m1.4.4.cmml">s</mi><mo id="A3.Ex9.m1.8.8.4.2.1.1.3" xref="A3.Ex9.m1.8.8.4.2.1.2.cmml">,</mo><msup id="A3.Ex9.m1.8.8.4.2.1.1.1" xref="A3.Ex9.m1.8.8.4.2.1.1.1.cmml"><mi id="A3.Ex9.m1.8.8.4.2.1.1.1.2" xref="A3.Ex9.m1.8.8.4.2.1.1.1.2.cmml">a</mi><mrow id="A3.Ex9.m1.8.8.4.2.1.1.1.3" xref="A3.Ex9.m1.8.8.4.2.1.1.1.3.cmml"><mi id="A3.Ex9.m1.8.8.4.2.1.1.1.3.2" xref="A3.Ex9.m1.8.8.4.2.1.1.1.3.2.cmml">s</mi><mo id="A3.Ex9.m1.8.8.4.2.1.1.1.3.1" xref="A3.Ex9.m1.8.8.4.2.1.1.1.3.1.cmml">⁢</mo><mi id="A3.Ex9.m1.8.8.4.2.1.1.1.3.3" xref="A3.Ex9.m1.8.8.4.2.1.1.1.3.3.cmml">u</mi><mo id="A3.Ex9.m1.8.8.4.2.1.1.1.3.1a" xref="A3.Ex9.m1.8.8.4.2.1.1.1.3.1.cmml">⁢</mo><mi id="A3.Ex9.m1.8.8.4.2.1.1.1.3.4" xref="A3.Ex9.m1.8.8.4.2.1.1.1.3.4.cmml">b</mi></mrow></msup><mo id="A3.Ex9.m1.8.8.4.2.1.1.4" stretchy="false" xref="A3.Ex9.m1.8.8.4.2.1.2.cmml">)</mo></mrow></mrow><mo id="A3.Ex9.m1.8.8.4.3a" xref="A3.Ex9.m1.8.8.4.3.cmml">−</mo><mstyle displaystyle="true" id="A3.Ex9.m1.8.8.4.4" xref="A3.Ex9.m1.8.8.4.4.cmml"><mfrac id="A3.Ex9.m1.8.8.4.4a" xref="A3.Ex9.m1.8.8.4.4.cmml"><mi id="A3.Ex9.m1.8.8.4.4.2" xref="A3.Ex9.m1.8.8.4.4.2.cmml">C</mi><mrow id="A3.Ex9.m1.8.8.4.4.3" xref="A3.Ex9.m1.8.8.4.4.3.cmml"><mn id="A3.Ex9.m1.8.8.4.4.3.2" xref="A3.Ex9.m1.8.8.4.4.3.2.cmml">1</mn><mo id="A3.Ex9.m1.8.8.4.4.3.1" xref="A3.Ex9.m1.8.8.4.4.3.1.cmml">−</mo><mi id="A3.Ex9.m1.8.8.4.4.3.3" xref="A3.Ex9.m1.8.8.4.4.3.3.cmml">γ</mi></mrow></mfrac></mstyle></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.Ex9.m1.8b"><apply id="A3.Ex9.m1.8.8.cmml" xref="A3.Ex9.m1.8.8"><gt id="A3.Ex9.m1.8.8.5.cmml" xref="A3.Ex9.m1.8.8.5"></gt><apply id="A3.Ex9.m1.6.6.2.cmml" xref="A3.Ex9.m1.6.6.2"><minus id="A3.Ex9.m1.6.6.2.3.cmml" xref="A3.Ex9.m1.6.6.2.3"></minus><apply id="A3.Ex9.m1.5.5.1.1.cmml" xref="A3.Ex9.m1.5.5.1.1"><times id="A3.Ex9.m1.5.5.1.1.2.cmml" xref="A3.Ex9.m1.5.5.1.1.2"></times><apply id="A3.Ex9.m1.5.5.1.1.3.cmml" xref="A3.Ex9.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="A3.Ex9.m1.5.5.1.1.3.1.cmml" xref="A3.Ex9.m1.5.5.1.1.3">superscript</csymbol><apply id="A3.Ex9.m1.5.5.1.1.3.2.cmml" xref="A3.Ex9.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="A3.Ex9.m1.5.5.1.1.3.2.1.cmml" xref="A3.Ex9.m1.5.5.1.1.3">subscript</csymbol><ci id="A3.Ex9.m1.5.5.1.1.3.2.2.cmml" xref="A3.Ex9.m1.5.5.1.1.3.2.2">𝑄</ci><cn id="A3.Ex9.m1.5.5.1.1.3.2.3.cmml" type="integer" xref="A3.Ex9.m1.5.5.1.1.3.2.3">1</cn></apply><times id="A3.Ex9.m1.5.5.1.1.3.3.cmml" xref="A3.Ex9.m1.5.5.1.1.3.3"></times></apply><interval closure="open" id="A3.Ex9.m1.5.5.1.1.1.2.cmml" xref="A3.Ex9.m1.5.5.1.1.1.1"><ci id="A3.Ex9.m1.1.1.cmml" xref="A3.Ex9.m1.1.1">𝑠</ci><apply id="A3.Ex9.m1.5.5.1.1.1.1.1.cmml" xref="A3.Ex9.m1.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.Ex9.m1.5.5.1.1.1.1.1.1.cmml" xref="A3.Ex9.m1.5.5.1.1.1.1.1">superscript</csymbol><ci id="A3.Ex9.m1.5.5.1.1.1.1.1.2.cmml" xref="A3.Ex9.m1.5.5.1.1.1.1.1.2">𝑎</ci><times id="A3.Ex9.m1.5.5.1.1.1.1.1.3.cmml" xref="A3.Ex9.m1.5.5.1.1.1.1.1.3"></times></apply></interval></apply><apply id="A3.Ex9.m1.6.6.2.2.cmml" xref="A3.Ex9.m1.6.6.2.2"><times id="A3.Ex9.m1.6.6.2.2.2.cmml" xref="A3.Ex9.m1.6.6.2.2.2"></times><apply id="A3.Ex9.m1.6.6.2.2.3.cmml" xref="A3.Ex9.m1.6.6.2.2.3"><csymbol cd="ambiguous" id="A3.Ex9.m1.6.6.2.2.3.1.cmml" xref="A3.Ex9.m1.6.6.2.2.3">superscript</csymbol><apply id="A3.Ex9.m1.6.6.2.2.3.2.cmml" xref="A3.Ex9.m1.6.6.2.2.3"><csymbol cd="ambiguous" id="A3.Ex9.m1.6.6.2.2.3.2.1.cmml" xref="A3.Ex9.m1.6.6.2.2.3">subscript</csymbol><ci id="A3.Ex9.m1.6.6.2.2.3.2.2.cmml" xref="A3.Ex9.m1.6.6.2.2.3.2.2">𝑄</ci><cn id="A3.Ex9.m1.6.6.2.2.3.2.3.cmml" type="integer" xref="A3.Ex9.m1.6.6.2.2.3.2.3">1</cn></apply><times id="A3.Ex9.m1.6.6.2.2.3.3.cmml" xref="A3.Ex9.m1.6.6.2.2.3.3"></times></apply><interval closure="open" id="A3.Ex9.m1.6.6.2.2.1.2.cmml" xref="A3.Ex9.m1.6.6.2.2.1.1"><ci id="A3.Ex9.m1.2.2.cmml" xref="A3.Ex9.m1.2.2">𝑠</ci><apply id="A3.Ex9.m1.6.6.2.2.1.1.1.cmml" xref="A3.Ex9.m1.6.6.2.2.1.1.1"><csymbol cd="ambiguous" id="A3.Ex9.m1.6.6.2.2.1.1.1.1.cmml" xref="A3.Ex9.m1.6.6.2.2.1.1.1">superscript</csymbol><ci id="A3.Ex9.m1.6.6.2.2.1.1.1.2.cmml" xref="A3.Ex9.m1.6.6.2.2.1.1.1.2">𝑎</ci><apply id="A3.Ex9.m1.6.6.2.2.1.1.1.3.cmml" xref="A3.Ex9.m1.6.6.2.2.1.1.1.3"><times id="A3.Ex9.m1.6.6.2.2.1.1.1.3.1.cmml" xref="A3.Ex9.m1.6.6.2.2.1.1.1.3.1"></times><ci id="A3.Ex9.m1.6.6.2.2.1.1.1.3.2.cmml" xref="A3.Ex9.m1.6.6.2.2.1.1.1.3.2">𝑠</ci><ci id="A3.Ex9.m1.6.6.2.2.1.1.1.3.3.cmml" xref="A3.Ex9.m1.6.6.2.2.1.1.1.3.3">𝑢</ci><ci id="A3.Ex9.m1.6.6.2.2.1.1.1.3.4.cmml" xref="A3.Ex9.m1.6.6.2.2.1.1.1.3.4">𝑏</ci></apply></apply></interval></apply></apply><apply id="A3.Ex9.m1.8.8.4.cmml" xref="A3.Ex9.m1.8.8.4"><minus id="A3.Ex9.m1.8.8.4.3.cmml" xref="A3.Ex9.m1.8.8.4.3"></minus><apply id="A3.Ex9.m1.7.7.3.1.cmml" xref="A3.Ex9.m1.7.7.3.1"><times id="A3.Ex9.m1.7.7.3.1.2.cmml" xref="A3.Ex9.m1.7.7.3.1.2"></times><apply id="A3.Ex9.m1.7.7.3.1.3.cmml" xref="A3.Ex9.m1.7.7.3.1.3"><csymbol cd="ambiguous" id="A3.Ex9.m1.7.7.3.1.3.1.cmml" xref="A3.Ex9.m1.7.7.3.1.3">superscript</csymbol><ci id="A3.Ex9.m1.7.7.3.1.3.2.cmml" xref="A3.Ex9.m1.7.7.3.1.3.2">𝑄</ci><times id="A3.Ex9.m1.7.7.3.1.3.3.cmml" xref="A3.Ex9.m1.7.7.3.1.3.3"></times></apply><interval closure="open" id="A3.Ex9.m1.7.7.3.1.1.2.cmml" xref="A3.Ex9.m1.7.7.3.1.1.1"><ci id="A3.Ex9.m1.3.3.cmml" xref="A3.Ex9.m1.3.3">𝑠</ci><apply id="A3.Ex9.m1.7.7.3.1.1.1.1.cmml" xref="A3.Ex9.m1.7.7.3.1.1.1.1"><csymbol cd="ambiguous" id="A3.Ex9.m1.7.7.3.1.1.1.1.1.cmml" xref="A3.Ex9.m1.7.7.3.1.1.1.1">superscript</csymbol><ci id="A3.Ex9.m1.7.7.3.1.1.1.1.2.cmml" xref="A3.Ex9.m1.7.7.3.1.1.1.1.2">𝑎</ci><times id="A3.Ex9.m1.7.7.3.1.1.1.1.3.cmml" xref="A3.Ex9.m1.7.7.3.1.1.1.1.3"></times></apply></interval></apply><apply id="A3.Ex9.m1.8.8.4.2.cmml" xref="A3.Ex9.m1.8.8.4.2"><times id="A3.Ex9.m1.8.8.4.2.2.cmml" xref="A3.Ex9.m1.8.8.4.2.2"></times><apply id="A3.Ex9.m1.8.8.4.2.3.cmml" xref="A3.Ex9.m1.8.8.4.2.3"><csymbol cd="ambiguous" id="A3.Ex9.m1.8.8.4.2.3.1.cmml" xref="A3.Ex9.m1.8.8.4.2.3">superscript</csymbol><ci id="A3.Ex9.m1.8.8.4.2.3.2.cmml" xref="A3.Ex9.m1.8.8.4.2.3.2">𝑄</ci><times id="A3.Ex9.m1.8.8.4.2.3.3.cmml" xref="A3.Ex9.m1.8.8.4.2.3.3"></times></apply><interval closure="open" id="A3.Ex9.m1.8.8.4.2.1.2.cmml" xref="A3.Ex9.m1.8.8.4.2.1.1"><ci id="A3.Ex9.m1.4.4.cmml" xref="A3.Ex9.m1.4.4">𝑠</ci><apply id="A3.Ex9.m1.8.8.4.2.1.1.1.cmml" xref="A3.Ex9.m1.8.8.4.2.1.1.1"><csymbol cd="ambiguous" id="A3.Ex9.m1.8.8.4.2.1.1.1.1.cmml" xref="A3.Ex9.m1.8.8.4.2.1.1.1">superscript</csymbol><ci id="A3.Ex9.m1.8.8.4.2.1.1.1.2.cmml" xref="A3.Ex9.m1.8.8.4.2.1.1.1.2">𝑎</ci><apply id="A3.Ex9.m1.8.8.4.2.1.1.1.3.cmml" xref="A3.Ex9.m1.8.8.4.2.1.1.1.3"><times id="A3.Ex9.m1.8.8.4.2.1.1.1.3.1.cmml" xref="A3.Ex9.m1.8.8.4.2.1.1.1.3.1"></times><ci id="A3.Ex9.m1.8.8.4.2.1.1.1.3.2.cmml" xref="A3.Ex9.m1.8.8.4.2.1.1.1.3.2">𝑠</ci><ci id="A3.Ex9.m1.8.8.4.2.1.1.1.3.3.cmml" xref="A3.Ex9.m1.8.8.4.2.1.1.1.3.3">𝑢</ci><ci id="A3.Ex9.m1.8.8.4.2.1.1.1.3.4.cmml" xref="A3.Ex9.m1.8.8.4.2.1.1.1.3.4">𝑏</ci></apply></apply></interval></apply><apply id="A3.Ex9.m1.8.8.4.4.cmml" xref="A3.Ex9.m1.8.8.4.4"><divide id="A3.Ex9.m1.8.8.4.4.1.cmml" xref="A3.Ex9.m1.8.8.4.4"></divide><ci id="A3.Ex9.m1.8.8.4.4.2.cmml" xref="A3.Ex9.m1.8.8.4.4.2">𝐶</ci><apply id="A3.Ex9.m1.8.8.4.4.3.cmml" xref="A3.Ex9.m1.8.8.4.4.3"><minus id="A3.Ex9.m1.8.8.4.4.3.1.cmml" xref="A3.Ex9.m1.8.8.4.4.3.1"></minus><cn id="A3.Ex9.m1.8.8.4.4.3.2.cmml" type="integer" xref="A3.Ex9.m1.8.8.4.4.3.2">1</cn><ci id="A3.Ex9.m1.8.8.4.4.3.3.cmml" xref="A3.Ex9.m1.8.8.4.4.3.3">𝛾</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex9.m1.8c">\displaystyle Q_{1}^{*}(s,a^{*})-Q_{1}^{*}(s,a^{sub})&gt;Q^{*}(s,a^{*})-Q^{*}(s,a%
^{sub})-\frac{C}{1-\gamma}</annotation><annotation encoding="application/x-llamapun" id="A3.Ex9.m1.8d">italic_Q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s , italic_a start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ) - italic_Q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s , italic_a start_POSTSUPERSCRIPT italic_s italic_u italic_b end_POSTSUPERSCRIPT ) &gt; italic_Q start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s , italic_a start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ) - italic_Q start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s , italic_a start_POSTSUPERSCRIPT italic_s italic_u italic_b end_POSTSUPERSCRIPT ) - divide start_ARG italic_C end_ARG start_ARG 1 - italic_γ end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A3.SS1.2.p2.5">By definition of <math alttext="C" class="ltx_Math" display="inline" id="A3.SS1.2.p2.3.m1.1"><semantics id="A3.SS1.2.p2.3.m1.1a"><mi id="A3.SS1.2.p2.3.m1.1.1" xref="A3.SS1.2.p2.3.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="A3.SS1.2.p2.3.m1.1b"><ci id="A3.SS1.2.p2.3.m1.1.1.cmml" xref="A3.SS1.2.p2.3.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.2.p2.3.m1.1c">C</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.2.p2.3.m1.1d">italic_C</annotation></semantics></math>, we know <math alttext="Q^{*}(s,a^{*})-Q^{*}(s,a^{sub})-\frac{C}{1-\gamma}&gt;0" class="ltx_Math" display="inline" id="A3.SS1.2.p2.4.m2.4"><semantics id="A3.SS1.2.p2.4.m2.4a"><mrow id="A3.SS1.2.p2.4.m2.4.4" xref="A3.SS1.2.p2.4.m2.4.4.cmml"><mrow id="A3.SS1.2.p2.4.m2.4.4.2" xref="A3.SS1.2.p2.4.m2.4.4.2.cmml"><mrow id="A3.SS1.2.p2.4.m2.3.3.1.1" xref="A3.SS1.2.p2.4.m2.3.3.1.1.cmml"><msup id="A3.SS1.2.p2.4.m2.3.3.1.1.3" xref="A3.SS1.2.p2.4.m2.3.3.1.1.3.cmml"><mi id="A3.SS1.2.p2.4.m2.3.3.1.1.3.2" xref="A3.SS1.2.p2.4.m2.3.3.1.1.3.2.cmml">Q</mi><mo id="A3.SS1.2.p2.4.m2.3.3.1.1.3.3" xref="A3.SS1.2.p2.4.m2.3.3.1.1.3.3.cmml">∗</mo></msup><mo id="A3.SS1.2.p2.4.m2.3.3.1.1.2" xref="A3.SS1.2.p2.4.m2.3.3.1.1.2.cmml">⁢</mo><mrow id="A3.SS1.2.p2.4.m2.3.3.1.1.1.1" xref="A3.SS1.2.p2.4.m2.3.3.1.1.1.2.cmml"><mo id="A3.SS1.2.p2.4.m2.3.3.1.1.1.1.2" stretchy="false" xref="A3.SS1.2.p2.4.m2.3.3.1.1.1.2.cmml">(</mo><mi id="A3.SS1.2.p2.4.m2.1.1" xref="A3.SS1.2.p2.4.m2.1.1.cmml">s</mi><mo id="A3.SS1.2.p2.4.m2.3.3.1.1.1.1.3" xref="A3.SS1.2.p2.4.m2.3.3.1.1.1.2.cmml">,</mo><msup id="A3.SS1.2.p2.4.m2.3.3.1.1.1.1.1" xref="A3.SS1.2.p2.4.m2.3.3.1.1.1.1.1.cmml"><mi id="A3.SS1.2.p2.4.m2.3.3.1.1.1.1.1.2" xref="A3.SS1.2.p2.4.m2.3.3.1.1.1.1.1.2.cmml">a</mi><mo id="A3.SS1.2.p2.4.m2.3.3.1.1.1.1.1.3" xref="A3.SS1.2.p2.4.m2.3.3.1.1.1.1.1.3.cmml">∗</mo></msup><mo id="A3.SS1.2.p2.4.m2.3.3.1.1.1.1.4" stretchy="false" xref="A3.SS1.2.p2.4.m2.3.3.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A3.SS1.2.p2.4.m2.4.4.2.3" xref="A3.SS1.2.p2.4.m2.4.4.2.3.cmml">−</mo><mrow id="A3.SS1.2.p2.4.m2.4.4.2.2" xref="A3.SS1.2.p2.4.m2.4.4.2.2.cmml"><msup id="A3.SS1.2.p2.4.m2.4.4.2.2.3" xref="A3.SS1.2.p2.4.m2.4.4.2.2.3.cmml"><mi id="A3.SS1.2.p2.4.m2.4.4.2.2.3.2" xref="A3.SS1.2.p2.4.m2.4.4.2.2.3.2.cmml">Q</mi><mo id="A3.SS1.2.p2.4.m2.4.4.2.2.3.3" xref="A3.SS1.2.p2.4.m2.4.4.2.2.3.3.cmml">∗</mo></msup><mo id="A3.SS1.2.p2.4.m2.4.4.2.2.2" xref="A3.SS1.2.p2.4.m2.4.4.2.2.2.cmml">⁢</mo><mrow id="A3.SS1.2.p2.4.m2.4.4.2.2.1.1" xref="A3.SS1.2.p2.4.m2.4.4.2.2.1.2.cmml"><mo id="A3.SS1.2.p2.4.m2.4.4.2.2.1.1.2" stretchy="false" xref="A3.SS1.2.p2.4.m2.4.4.2.2.1.2.cmml">(</mo><mi id="A3.SS1.2.p2.4.m2.2.2" xref="A3.SS1.2.p2.4.m2.2.2.cmml">s</mi><mo id="A3.SS1.2.p2.4.m2.4.4.2.2.1.1.3" xref="A3.SS1.2.p2.4.m2.4.4.2.2.1.2.cmml">,</mo><msup id="A3.SS1.2.p2.4.m2.4.4.2.2.1.1.1" xref="A3.SS1.2.p2.4.m2.4.4.2.2.1.1.1.cmml"><mi id="A3.SS1.2.p2.4.m2.4.4.2.2.1.1.1.2" xref="A3.SS1.2.p2.4.m2.4.4.2.2.1.1.1.2.cmml">a</mi><mrow id="A3.SS1.2.p2.4.m2.4.4.2.2.1.1.1.3" xref="A3.SS1.2.p2.4.m2.4.4.2.2.1.1.1.3.cmml"><mi id="A3.SS1.2.p2.4.m2.4.4.2.2.1.1.1.3.2" xref="A3.SS1.2.p2.4.m2.4.4.2.2.1.1.1.3.2.cmml">s</mi><mo id="A3.SS1.2.p2.4.m2.4.4.2.2.1.1.1.3.1" xref="A3.SS1.2.p2.4.m2.4.4.2.2.1.1.1.3.1.cmml">⁢</mo><mi id="A3.SS1.2.p2.4.m2.4.4.2.2.1.1.1.3.3" xref="A3.SS1.2.p2.4.m2.4.4.2.2.1.1.1.3.3.cmml">u</mi><mo id="A3.SS1.2.p2.4.m2.4.4.2.2.1.1.1.3.1a" xref="A3.SS1.2.p2.4.m2.4.4.2.2.1.1.1.3.1.cmml">⁢</mo><mi id="A3.SS1.2.p2.4.m2.4.4.2.2.1.1.1.3.4" xref="A3.SS1.2.p2.4.m2.4.4.2.2.1.1.1.3.4.cmml">b</mi></mrow></msup><mo id="A3.SS1.2.p2.4.m2.4.4.2.2.1.1.4" stretchy="false" xref="A3.SS1.2.p2.4.m2.4.4.2.2.1.2.cmml">)</mo></mrow></mrow><mo id="A3.SS1.2.p2.4.m2.4.4.2.3a" xref="A3.SS1.2.p2.4.m2.4.4.2.3.cmml">−</mo><mfrac id="A3.SS1.2.p2.4.m2.4.4.2.4" xref="A3.SS1.2.p2.4.m2.4.4.2.4.cmml"><mi id="A3.SS1.2.p2.4.m2.4.4.2.4.2" xref="A3.SS1.2.p2.4.m2.4.4.2.4.2.cmml">C</mi><mrow id="A3.SS1.2.p2.4.m2.4.4.2.4.3" xref="A3.SS1.2.p2.4.m2.4.4.2.4.3.cmml"><mn id="A3.SS1.2.p2.4.m2.4.4.2.4.3.2" xref="A3.SS1.2.p2.4.m2.4.4.2.4.3.2.cmml">1</mn><mo id="A3.SS1.2.p2.4.m2.4.4.2.4.3.1" xref="A3.SS1.2.p2.4.m2.4.4.2.4.3.1.cmml">−</mo><mi id="A3.SS1.2.p2.4.m2.4.4.2.4.3.3" xref="A3.SS1.2.p2.4.m2.4.4.2.4.3.3.cmml">γ</mi></mrow></mfrac></mrow><mo id="A3.SS1.2.p2.4.m2.4.4.3" xref="A3.SS1.2.p2.4.m2.4.4.3.cmml">&gt;</mo><mn id="A3.SS1.2.p2.4.m2.4.4.4" xref="A3.SS1.2.p2.4.m2.4.4.4.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.2.p2.4.m2.4b"><apply id="A3.SS1.2.p2.4.m2.4.4.cmml" xref="A3.SS1.2.p2.4.m2.4.4"><gt id="A3.SS1.2.p2.4.m2.4.4.3.cmml" xref="A3.SS1.2.p2.4.m2.4.4.3"></gt><apply id="A3.SS1.2.p2.4.m2.4.4.2.cmml" xref="A3.SS1.2.p2.4.m2.4.4.2"><minus id="A3.SS1.2.p2.4.m2.4.4.2.3.cmml" xref="A3.SS1.2.p2.4.m2.4.4.2.3"></minus><apply id="A3.SS1.2.p2.4.m2.3.3.1.1.cmml" xref="A3.SS1.2.p2.4.m2.3.3.1.1"><times id="A3.SS1.2.p2.4.m2.3.3.1.1.2.cmml" xref="A3.SS1.2.p2.4.m2.3.3.1.1.2"></times><apply id="A3.SS1.2.p2.4.m2.3.3.1.1.3.cmml" xref="A3.SS1.2.p2.4.m2.3.3.1.1.3"><csymbol cd="ambiguous" id="A3.SS1.2.p2.4.m2.3.3.1.1.3.1.cmml" xref="A3.SS1.2.p2.4.m2.3.3.1.1.3">superscript</csymbol><ci id="A3.SS1.2.p2.4.m2.3.3.1.1.3.2.cmml" xref="A3.SS1.2.p2.4.m2.3.3.1.1.3.2">𝑄</ci><times id="A3.SS1.2.p2.4.m2.3.3.1.1.3.3.cmml" xref="A3.SS1.2.p2.4.m2.3.3.1.1.3.3"></times></apply><interval closure="open" id="A3.SS1.2.p2.4.m2.3.3.1.1.1.2.cmml" xref="A3.SS1.2.p2.4.m2.3.3.1.1.1.1"><ci id="A3.SS1.2.p2.4.m2.1.1.cmml" xref="A3.SS1.2.p2.4.m2.1.1">𝑠</ci><apply id="A3.SS1.2.p2.4.m2.3.3.1.1.1.1.1.cmml" xref="A3.SS1.2.p2.4.m2.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.SS1.2.p2.4.m2.3.3.1.1.1.1.1.1.cmml" xref="A3.SS1.2.p2.4.m2.3.3.1.1.1.1.1">superscript</csymbol><ci id="A3.SS1.2.p2.4.m2.3.3.1.1.1.1.1.2.cmml" xref="A3.SS1.2.p2.4.m2.3.3.1.1.1.1.1.2">𝑎</ci><times id="A3.SS1.2.p2.4.m2.3.3.1.1.1.1.1.3.cmml" xref="A3.SS1.2.p2.4.m2.3.3.1.1.1.1.1.3"></times></apply></interval></apply><apply id="A3.SS1.2.p2.4.m2.4.4.2.2.cmml" xref="A3.SS1.2.p2.4.m2.4.4.2.2"><times id="A3.SS1.2.p2.4.m2.4.4.2.2.2.cmml" xref="A3.SS1.2.p2.4.m2.4.4.2.2.2"></times><apply id="A3.SS1.2.p2.4.m2.4.4.2.2.3.cmml" xref="A3.SS1.2.p2.4.m2.4.4.2.2.3"><csymbol cd="ambiguous" id="A3.SS1.2.p2.4.m2.4.4.2.2.3.1.cmml" xref="A3.SS1.2.p2.4.m2.4.4.2.2.3">superscript</csymbol><ci id="A3.SS1.2.p2.4.m2.4.4.2.2.3.2.cmml" xref="A3.SS1.2.p2.4.m2.4.4.2.2.3.2">𝑄</ci><times id="A3.SS1.2.p2.4.m2.4.4.2.2.3.3.cmml" xref="A3.SS1.2.p2.4.m2.4.4.2.2.3.3"></times></apply><interval closure="open" id="A3.SS1.2.p2.4.m2.4.4.2.2.1.2.cmml" xref="A3.SS1.2.p2.4.m2.4.4.2.2.1.1"><ci id="A3.SS1.2.p2.4.m2.2.2.cmml" xref="A3.SS1.2.p2.4.m2.2.2">𝑠</ci><apply id="A3.SS1.2.p2.4.m2.4.4.2.2.1.1.1.cmml" xref="A3.SS1.2.p2.4.m2.4.4.2.2.1.1.1"><csymbol cd="ambiguous" id="A3.SS1.2.p2.4.m2.4.4.2.2.1.1.1.1.cmml" xref="A3.SS1.2.p2.4.m2.4.4.2.2.1.1.1">superscript</csymbol><ci id="A3.SS1.2.p2.4.m2.4.4.2.2.1.1.1.2.cmml" xref="A3.SS1.2.p2.4.m2.4.4.2.2.1.1.1.2">𝑎</ci><apply id="A3.SS1.2.p2.4.m2.4.4.2.2.1.1.1.3.cmml" xref="A3.SS1.2.p2.4.m2.4.4.2.2.1.1.1.3"><times id="A3.SS1.2.p2.4.m2.4.4.2.2.1.1.1.3.1.cmml" xref="A3.SS1.2.p2.4.m2.4.4.2.2.1.1.1.3.1"></times><ci id="A3.SS1.2.p2.4.m2.4.4.2.2.1.1.1.3.2.cmml" xref="A3.SS1.2.p2.4.m2.4.4.2.2.1.1.1.3.2">𝑠</ci><ci id="A3.SS1.2.p2.4.m2.4.4.2.2.1.1.1.3.3.cmml" xref="A3.SS1.2.p2.4.m2.4.4.2.2.1.1.1.3.3">𝑢</ci><ci id="A3.SS1.2.p2.4.m2.4.4.2.2.1.1.1.3.4.cmml" xref="A3.SS1.2.p2.4.m2.4.4.2.2.1.1.1.3.4">𝑏</ci></apply></apply></interval></apply><apply id="A3.SS1.2.p2.4.m2.4.4.2.4.cmml" xref="A3.SS1.2.p2.4.m2.4.4.2.4"><divide id="A3.SS1.2.p2.4.m2.4.4.2.4.1.cmml" xref="A3.SS1.2.p2.4.m2.4.4.2.4"></divide><ci id="A3.SS1.2.p2.4.m2.4.4.2.4.2.cmml" xref="A3.SS1.2.p2.4.m2.4.4.2.4.2">𝐶</ci><apply id="A3.SS1.2.p2.4.m2.4.4.2.4.3.cmml" xref="A3.SS1.2.p2.4.m2.4.4.2.4.3"><minus id="A3.SS1.2.p2.4.m2.4.4.2.4.3.1.cmml" xref="A3.SS1.2.p2.4.m2.4.4.2.4.3.1"></minus><cn id="A3.SS1.2.p2.4.m2.4.4.2.4.3.2.cmml" type="integer" xref="A3.SS1.2.p2.4.m2.4.4.2.4.3.2">1</cn><ci id="A3.SS1.2.p2.4.m2.4.4.2.4.3.3.cmml" xref="A3.SS1.2.p2.4.m2.4.4.2.4.3.3">𝛾</ci></apply></apply></apply><cn id="A3.SS1.2.p2.4.m2.4.4.4.cmml" type="integer" xref="A3.SS1.2.p2.4.m2.4.4.4">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.2.p2.4.m2.4c">Q^{*}(s,a^{*})-Q^{*}(s,a^{sub})-\frac{C}{1-\gamma}&gt;0</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.2.p2.4.m2.4d">italic_Q start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s , italic_a start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ) - italic_Q start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s , italic_a start_POSTSUPERSCRIPT italic_s italic_u italic_b end_POSTSUPERSCRIPT ) - divide start_ARG italic_C end_ARG start_ARG 1 - italic_γ end_ARG &gt; 0</annotation></semantics></math> holds.
Therefore, <math alttext="Q_{1}^{*}(s,a^{*})&gt;Q_{1}^{*}(s,a^{sub})" class="ltx_Math" display="inline" id="A3.SS1.2.p2.5.m3.4"><semantics id="A3.SS1.2.p2.5.m3.4a"><mrow id="A3.SS1.2.p2.5.m3.4.4" xref="A3.SS1.2.p2.5.m3.4.4.cmml"><mrow id="A3.SS1.2.p2.5.m3.3.3.1" xref="A3.SS1.2.p2.5.m3.3.3.1.cmml"><msubsup id="A3.SS1.2.p2.5.m3.3.3.1.3" xref="A3.SS1.2.p2.5.m3.3.3.1.3.cmml"><mi id="A3.SS1.2.p2.5.m3.3.3.1.3.2.2" xref="A3.SS1.2.p2.5.m3.3.3.1.3.2.2.cmml">Q</mi><mn id="A3.SS1.2.p2.5.m3.3.3.1.3.2.3" xref="A3.SS1.2.p2.5.m3.3.3.1.3.2.3.cmml">1</mn><mo id="A3.SS1.2.p2.5.m3.3.3.1.3.3" xref="A3.SS1.2.p2.5.m3.3.3.1.3.3.cmml">∗</mo></msubsup><mo id="A3.SS1.2.p2.5.m3.3.3.1.2" xref="A3.SS1.2.p2.5.m3.3.3.1.2.cmml">⁢</mo><mrow id="A3.SS1.2.p2.5.m3.3.3.1.1.1" xref="A3.SS1.2.p2.5.m3.3.3.1.1.2.cmml"><mo id="A3.SS1.2.p2.5.m3.3.3.1.1.1.2" stretchy="false" xref="A3.SS1.2.p2.5.m3.3.3.1.1.2.cmml">(</mo><mi id="A3.SS1.2.p2.5.m3.1.1" xref="A3.SS1.2.p2.5.m3.1.1.cmml">s</mi><mo id="A3.SS1.2.p2.5.m3.3.3.1.1.1.3" xref="A3.SS1.2.p2.5.m3.3.3.1.1.2.cmml">,</mo><msup id="A3.SS1.2.p2.5.m3.3.3.1.1.1.1" xref="A3.SS1.2.p2.5.m3.3.3.1.1.1.1.cmml"><mi id="A3.SS1.2.p2.5.m3.3.3.1.1.1.1.2" xref="A3.SS1.2.p2.5.m3.3.3.1.1.1.1.2.cmml">a</mi><mo id="A3.SS1.2.p2.5.m3.3.3.1.1.1.1.3" xref="A3.SS1.2.p2.5.m3.3.3.1.1.1.1.3.cmml">∗</mo></msup><mo id="A3.SS1.2.p2.5.m3.3.3.1.1.1.4" stretchy="false" xref="A3.SS1.2.p2.5.m3.3.3.1.1.2.cmml">)</mo></mrow></mrow><mo id="A3.SS1.2.p2.5.m3.4.4.3" xref="A3.SS1.2.p2.5.m3.4.4.3.cmml">&gt;</mo><mrow id="A3.SS1.2.p2.5.m3.4.4.2" xref="A3.SS1.2.p2.5.m3.4.4.2.cmml"><msubsup id="A3.SS1.2.p2.5.m3.4.4.2.3" xref="A3.SS1.2.p2.5.m3.4.4.2.3.cmml"><mi id="A3.SS1.2.p2.5.m3.4.4.2.3.2.2" xref="A3.SS1.2.p2.5.m3.4.4.2.3.2.2.cmml">Q</mi><mn id="A3.SS1.2.p2.5.m3.4.4.2.3.2.3" xref="A3.SS1.2.p2.5.m3.4.4.2.3.2.3.cmml">1</mn><mo id="A3.SS1.2.p2.5.m3.4.4.2.3.3" xref="A3.SS1.2.p2.5.m3.4.4.2.3.3.cmml">∗</mo></msubsup><mo id="A3.SS1.2.p2.5.m3.4.4.2.2" xref="A3.SS1.2.p2.5.m3.4.4.2.2.cmml">⁢</mo><mrow id="A3.SS1.2.p2.5.m3.4.4.2.1.1" xref="A3.SS1.2.p2.5.m3.4.4.2.1.2.cmml"><mo id="A3.SS1.2.p2.5.m3.4.4.2.1.1.2" stretchy="false" xref="A3.SS1.2.p2.5.m3.4.4.2.1.2.cmml">(</mo><mi id="A3.SS1.2.p2.5.m3.2.2" xref="A3.SS1.2.p2.5.m3.2.2.cmml">s</mi><mo id="A3.SS1.2.p2.5.m3.4.4.2.1.1.3" xref="A3.SS1.2.p2.5.m3.4.4.2.1.2.cmml">,</mo><msup id="A3.SS1.2.p2.5.m3.4.4.2.1.1.1" xref="A3.SS1.2.p2.5.m3.4.4.2.1.1.1.cmml"><mi id="A3.SS1.2.p2.5.m3.4.4.2.1.1.1.2" xref="A3.SS1.2.p2.5.m3.4.4.2.1.1.1.2.cmml">a</mi><mrow id="A3.SS1.2.p2.5.m3.4.4.2.1.1.1.3" xref="A3.SS1.2.p2.5.m3.4.4.2.1.1.1.3.cmml"><mi id="A3.SS1.2.p2.5.m3.4.4.2.1.1.1.3.2" xref="A3.SS1.2.p2.5.m3.4.4.2.1.1.1.3.2.cmml">s</mi><mo id="A3.SS1.2.p2.5.m3.4.4.2.1.1.1.3.1" xref="A3.SS1.2.p2.5.m3.4.4.2.1.1.1.3.1.cmml">⁢</mo><mi id="A3.SS1.2.p2.5.m3.4.4.2.1.1.1.3.3" xref="A3.SS1.2.p2.5.m3.4.4.2.1.1.1.3.3.cmml">u</mi><mo id="A3.SS1.2.p2.5.m3.4.4.2.1.1.1.3.1a" xref="A3.SS1.2.p2.5.m3.4.4.2.1.1.1.3.1.cmml">⁢</mo><mi id="A3.SS1.2.p2.5.m3.4.4.2.1.1.1.3.4" xref="A3.SS1.2.p2.5.m3.4.4.2.1.1.1.3.4.cmml">b</mi></mrow></msup><mo id="A3.SS1.2.p2.5.m3.4.4.2.1.1.4" stretchy="false" xref="A3.SS1.2.p2.5.m3.4.4.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.2.p2.5.m3.4b"><apply id="A3.SS1.2.p2.5.m3.4.4.cmml" xref="A3.SS1.2.p2.5.m3.4.4"><gt id="A3.SS1.2.p2.5.m3.4.4.3.cmml" xref="A3.SS1.2.p2.5.m3.4.4.3"></gt><apply id="A3.SS1.2.p2.5.m3.3.3.1.cmml" xref="A3.SS1.2.p2.5.m3.3.3.1"><times id="A3.SS1.2.p2.5.m3.3.3.1.2.cmml" xref="A3.SS1.2.p2.5.m3.3.3.1.2"></times><apply id="A3.SS1.2.p2.5.m3.3.3.1.3.cmml" xref="A3.SS1.2.p2.5.m3.3.3.1.3"><csymbol cd="ambiguous" id="A3.SS1.2.p2.5.m3.3.3.1.3.1.cmml" xref="A3.SS1.2.p2.5.m3.3.3.1.3">superscript</csymbol><apply id="A3.SS1.2.p2.5.m3.3.3.1.3.2.cmml" xref="A3.SS1.2.p2.5.m3.3.3.1.3"><csymbol cd="ambiguous" id="A3.SS1.2.p2.5.m3.3.3.1.3.2.1.cmml" xref="A3.SS1.2.p2.5.m3.3.3.1.3">subscript</csymbol><ci id="A3.SS1.2.p2.5.m3.3.3.1.3.2.2.cmml" xref="A3.SS1.2.p2.5.m3.3.3.1.3.2.2">𝑄</ci><cn id="A3.SS1.2.p2.5.m3.3.3.1.3.2.3.cmml" type="integer" xref="A3.SS1.2.p2.5.m3.3.3.1.3.2.3">1</cn></apply><times id="A3.SS1.2.p2.5.m3.3.3.1.3.3.cmml" xref="A3.SS1.2.p2.5.m3.3.3.1.3.3"></times></apply><interval closure="open" id="A3.SS1.2.p2.5.m3.3.3.1.1.2.cmml" xref="A3.SS1.2.p2.5.m3.3.3.1.1.1"><ci id="A3.SS1.2.p2.5.m3.1.1.cmml" xref="A3.SS1.2.p2.5.m3.1.1">𝑠</ci><apply id="A3.SS1.2.p2.5.m3.3.3.1.1.1.1.cmml" xref="A3.SS1.2.p2.5.m3.3.3.1.1.1.1"><csymbol cd="ambiguous" id="A3.SS1.2.p2.5.m3.3.3.1.1.1.1.1.cmml" xref="A3.SS1.2.p2.5.m3.3.3.1.1.1.1">superscript</csymbol><ci id="A3.SS1.2.p2.5.m3.3.3.1.1.1.1.2.cmml" xref="A3.SS1.2.p2.5.m3.3.3.1.1.1.1.2">𝑎</ci><times id="A3.SS1.2.p2.5.m3.3.3.1.1.1.1.3.cmml" xref="A3.SS1.2.p2.5.m3.3.3.1.1.1.1.3"></times></apply></interval></apply><apply id="A3.SS1.2.p2.5.m3.4.4.2.cmml" xref="A3.SS1.2.p2.5.m3.4.4.2"><times id="A3.SS1.2.p2.5.m3.4.4.2.2.cmml" xref="A3.SS1.2.p2.5.m3.4.4.2.2"></times><apply id="A3.SS1.2.p2.5.m3.4.4.2.3.cmml" xref="A3.SS1.2.p2.5.m3.4.4.2.3"><csymbol cd="ambiguous" id="A3.SS1.2.p2.5.m3.4.4.2.3.1.cmml" xref="A3.SS1.2.p2.5.m3.4.4.2.3">superscript</csymbol><apply id="A3.SS1.2.p2.5.m3.4.4.2.3.2.cmml" xref="A3.SS1.2.p2.5.m3.4.4.2.3"><csymbol cd="ambiguous" id="A3.SS1.2.p2.5.m3.4.4.2.3.2.1.cmml" xref="A3.SS1.2.p2.5.m3.4.4.2.3">subscript</csymbol><ci id="A3.SS1.2.p2.5.m3.4.4.2.3.2.2.cmml" xref="A3.SS1.2.p2.5.m3.4.4.2.3.2.2">𝑄</ci><cn id="A3.SS1.2.p2.5.m3.4.4.2.3.2.3.cmml" type="integer" xref="A3.SS1.2.p2.5.m3.4.4.2.3.2.3">1</cn></apply><times id="A3.SS1.2.p2.5.m3.4.4.2.3.3.cmml" xref="A3.SS1.2.p2.5.m3.4.4.2.3.3"></times></apply><interval closure="open" id="A3.SS1.2.p2.5.m3.4.4.2.1.2.cmml" xref="A3.SS1.2.p2.5.m3.4.4.2.1.1"><ci id="A3.SS1.2.p2.5.m3.2.2.cmml" xref="A3.SS1.2.p2.5.m3.2.2">𝑠</ci><apply id="A3.SS1.2.p2.5.m3.4.4.2.1.1.1.cmml" xref="A3.SS1.2.p2.5.m3.4.4.2.1.1.1"><csymbol cd="ambiguous" id="A3.SS1.2.p2.5.m3.4.4.2.1.1.1.1.cmml" xref="A3.SS1.2.p2.5.m3.4.4.2.1.1.1">superscript</csymbol><ci id="A3.SS1.2.p2.5.m3.4.4.2.1.1.1.2.cmml" xref="A3.SS1.2.p2.5.m3.4.4.2.1.1.1.2">𝑎</ci><apply id="A3.SS1.2.p2.5.m3.4.4.2.1.1.1.3.cmml" xref="A3.SS1.2.p2.5.m3.4.4.2.1.1.1.3"><times id="A3.SS1.2.p2.5.m3.4.4.2.1.1.1.3.1.cmml" xref="A3.SS1.2.p2.5.m3.4.4.2.1.1.1.3.1"></times><ci id="A3.SS1.2.p2.5.m3.4.4.2.1.1.1.3.2.cmml" xref="A3.SS1.2.p2.5.m3.4.4.2.1.1.1.3.2">𝑠</ci><ci id="A3.SS1.2.p2.5.m3.4.4.2.1.1.1.3.3.cmml" xref="A3.SS1.2.p2.5.m3.4.4.2.1.1.1.3.3">𝑢</ci><ci id="A3.SS1.2.p2.5.m3.4.4.2.1.1.1.3.4.cmml" xref="A3.SS1.2.p2.5.m3.4.4.2.1.1.1.3.4">𝑏</ci></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.2.p2.5.m3.4c">Q_{1}^{*}(s,a^{*})&gt;Q_{1}^{*}(s,a^{sub})</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.2.p2.5.m3.4d">italic_Q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s , italic_a start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ) &gt; italic_Q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s , italic_a start_POSTSUPERSCRIPT italic_s italic_u italic_b end_POSTSUPERSCRIPT )</annotation></semantics></math> holds.
∎</p>
</div>
</div>
</section>
<section class="ltx_subsection" id="A3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.2 </span>Proof of Theorem <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S3.Thmtheorem3" title="Theorem 3.3. ‣ 3.3.1 Proof of memory effectiveness ‣ 3.3 Ensemble learning for exploration-exploitation balance ‣ 3 Method ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_tag">3.3</span></a>
</h3>
<div class="ltx_proof" id="A3.SS2.2">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div class="ltx_para ltx_noindent" id="A3.SS2.1.p1">
<p class="ltx_p" id="A3.SS2.1.p1.5">Since the value of <math alttext="C_{\omega}(s,a)" class="ltx_Math" display="inline" id="A3.SS2.1.p1.1.m1.2"><semantics id="A3.SS2.1.p1.1.m1.2a"><mrow id="A3.SS2.1.p1.1.m1.2.3" xref="A3.SS2.1.p1.1.m1.2.3.cmml"><msub id="A3.SS2.1.p1.1.m1.2.3.2" xref="A3.SS2.1.p1.1.m1.2.3.2.cmml"><mi id="A3.SS2.1.p1.1.m1.2.3.2.2" xref="A3.SS2.1.p1.1.m1.2.3.2.2.cmml">C</mi><mi id="A3.SS2.1.p1.1.m1.2.3.2.3" xref="A3.SS2.1.p1.1.m1.2.3.2.3.cmml">ω</mi></msub><mo id="A3.SS2.1.p1.1.m1.2.3.1" xref="A3.SS2.1.p1.1.m1.2.3.1.cmml">⁢</mo><mrow id="A3.SS2.1.p1.1.m1.2.3.3.2" xref="A3.SS2.1.p1.1.m1.2.3.3.1.cmml"><mo id="A3.SS2.1.p1.1.m1.2.3.3.2.1" stretchy="false" xref="A3.SS2.1.p1.1.m1.2.3.3.1.cmml">(</mo><mi id="A3.SS2.1.p1.1.m1.1.1" xref="A3.SS2.1.p1.1.m1.1.1.cmml">s</mi><mo id="A3.SS2.1.p1.1.m1.2.3.3.2.2" xref="A3.SS2.1.p1.1.m1.2.3.3.1.cmml">,</mo><mi id="A3.SS2.1.p1.1.m1.2.2" xref="A3.SS2.1.p1.1.m1.2.2.cmml">a</mi><mo id="A3.SS2.1.p1.1.m1.2.3.3.2.3" stretchy="false" xref="A3.SS2.1.p1.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS2.1.p1.1.m1.2b"><apply id="A3.SS2.1.p1.1.m1.2.3.cmml" xref="A3.SS2.1.p1.1.m1.2.3"><times id="A3.SS2.1.p1.1.m1.2.3.1.cmml" xref="A3.SS2.1.p1.1.m1.2.3.1"></times><apply id="A3.SS2.1.p1.1.m1.2.3.2.cmml" xref="A3.SS2.1.p1.1.m1.2.3.2"><csymbol cd="ambiguous" id="A3.SS2.1.p1.1.m1.2.3.2.1.cmml" xref="A3.SS2.1.p1.1.m1.2.3.2">subscript</csymbol><ci id="A3.SS2.1.p1.1.m1.2.3.2.2.cmml" xref="A3.SS2.1.p1.1.m1.2.3.2.2">𝐶</ci><ci id="A3.SS2.1.p1.1.m1.2.3.2.3.cmml" xref="A3.SS2.1.p1.1.m1.2.3.2.3">𝜔</ci></apply><interval closure="open" id="A3.SS2.1.p1.1.m1.2.3.3.1.cmml" xref="A3.SS2.1.p1.1.m1.2.3.3.2"><ci id="A3.SS2.1.p1.1.m1.1.1.cmml" xref="A3.SS2.1.p1.1.m1.1.1">𝑠</ci><ci id="A3.SS2.1.p1.1.m1.2.2.cmml" xref="A3.SS2.1.p1.1.m1.2.2">𝑎</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.1.p1.1.m1.2c">C_{\omega}(s,a)</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.1.p1.1.m1.2d">italic_C start_POSTSUBSCRIPT italic_ω end_POSTSUBSCRIPT ( italic_s , italic_a )</annotation></semantics></math> is related to the state <math alttext="s" class="ltx_Math" display="inline" id="A3.SS2.1.p1.2.m2.1"><semantics id="A3.SS2.1.p1.2.m2.1a"><mi id="A3.SS2.1.p1.2.m2.1.1" xref="A3.SS2.1.p1.2.m2.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="A3.SS2.1.p1.2.m2.1b"><ci id="A3.SS2.1.p1.2.m2.1.1.cmml" xref="A3.SS2.1.p1.2.m2.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.1.p1.2.m2.1c">s</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.1.p1.2.m2.1d">italic_s</annotation></semantics></math> and action <math alttext="a" class="ltx_Math" display="inline" id="A3.SS2.1.p1.3.m3.1"><semantics id="A3.SS2.1.p1.3.m3.1a"><mi id="A3.SS2.1.p1.3.m3.1.1" xref="A3.SS2.1.p1.3.m3.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="A3.SS2.1.p1.3.m3.1b"><ci id="A3.SS2.1.p1.3.m3.1.1.cmml" xref="A3.SS2.1.p1.3.m3.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.1.p1.3.m3.1c">a</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.1.p1.3.m3.1d">italic_a</annotation></semantics></math>. Under state <math alttext="s" class="ltx_Math" display="inline" id="A3.SS2.1.p1.4.m4.1"><semantics id="A3.SS2.1.p1.4.m4.1a"><mi id="A3.SS2.1.p1.4.m4.1.1" xref="A3.SS2.1.p1.4.m4.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="A3.SS2.1.p1.4.m4.1b"><ci id="A3.SS2.1.p1.4.m4.1.1.cmml" xref="A3.SS2.1.p1.4.m4.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.1.p1.4.m4.1c">s</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.1.p1.4.m4.1d">italic_s</annotation></semantics></math>, due to <math alttext="C_{\omega}(s,a^{*})&gt;C_{\omega}(s,a)" class="ltx_Math" display="inline" id="A3.SS2.1.p1.5.m5.4"><semantics id="A3.SS2.1.p1.5.m5.4a"><mrow id="A3.SS2.1.p1.5.m5.4.4" xref="A3.SS2.1.p1.5.m5.4.4.cmml"><mrow id="A3.SS2.1.p1.5.m5.4.4.1" xref="A3.SS2.1.p1.5.m5.4.4.1.cmml"><msub id="A3.SS2.1.p1.5.m5.4.4.1.3" xref="A3.SS2.1.p1.5.m5.4.4.1.3.cmml"><mi id="A3.SS2.1.p1.5.m5.4.4.1.3.2" xref="A3.SS2.1.p1.5.m5.4.4.1.3.2.cmml">C</mi><mi id="A3.SS2.1.p1.5.m5.4.4.1.3.3" xref="A3.SS2.1.p1.5.m5.4.4.1.3.3.cmml">ω</mi></msub><mo id="A3.SS2.1.p1.5.m5.4.4.1.2" xref="A3.SS2.1.p1.5.m5.4.4.1.2.cmml">⁢</mo><mrow id="A3.SS2.1.p1.5.m5.4.4.1.1.1" xref="A3.SS2.1.p1.5.m5.4.4.1.1.2.cmml"><mo id="A3.SS2.1.p1.5.m5.4.4.1.1.1.2" stretchy="false" xref="A3.SS2.1.p1.5.m5.4.4.1.1.2.cmml">(</mo><mi id="A3.SS2.1.p1.5.m5.1.1" xref="A3.SS2.1.p1.5.m5.1.1.cmml">s</mi><mo id="A3.SS2.1.p1.5.m5.4.4.1.1.1.3" xref="A3.SS2.1.p1.5.m5.4.4.1.1.2.cmml">,</mo><msup id="A3.SS2.1.p1.5.m5.4.4.1.1.1.1" xref="A3.SS2.1.p1.5.m5.4.4.1.1.1.1.cmml"><mi id="A3.SS2.1.p1.5.m5.4.4.1.1.1.1.2" xref="A3.SS2.1.p1.5.m5.4.4.1.1.1.1.2.cmml">a</mi><mo id="A3.SS2.1.p1.5.m5.4.4.1.1.1.1.3" xref="A3.SS2.1.p1.5.m5.4.4.1.1.1.1.3.cmml">∗</mo></msup><mo id="A3.SS2.1.p1.5.m5.4.4.1.1.1.4" stretchy="false" xref="A3.SS2.1.p1.5.m5.4.4.1.1.2.cmml">)</mo></mrow></mrow><mo id="A3.SS2.1.p1.5.m5.4.4.2" xref="A3.SS2.1.p1.5.m5.4.4.2.cmml">&gt;</mo><mrow id="A3.SS2.1.p1.5.m5.4.4.3" xref="A3.SS2.1.p1.5.m5.4.4.3.cmml"><msub id="A3.SS2.1.p1.5.m5.4.4.3.2" xref="A3.SS2.1.p1.5.m5.4.4.3.2.cmml"><mi id="A3.SS2.1.p1.5.m5.4.4.3.2.2" xref="A3.SS2.1.p1.5.m5.4.4.3.2.2.cmml">C</mi><mi id="A3.SS2.1.p1.5.m5.4.4.3.2.3" xref="A3.SS2.1.p1.5.m5.4.4.3.2.3.cmml">ω</mi></msub><mo id="A3.SS2.1.p1.5.m5.4.4.3.1" xref="A3.SS2.1.p1.5.m5.4.4.3.1.cmml">⁢</mo><mrow id="A3.SS2.1.p1.5.m5.4.4.3.3.2" xref="A3.SS2.1.p1.5.m5.4.4.3.3.1.cmml"><mo id="A3.SS2.1.p1.5.m5.4.4.3.3.2.1" stretchy="false" xref="A3.SS2.1.p1.5.m5.4.4.3.3.1.cmml">(</mo><mi id="A3.SS2.1.p1.5.m5.2.2" xref="A3.SS2.1.p1.5.m5.2.2.cmml">s</mi><mo id="A3.SS2.1.p1.5.m5.4.4.3.3.2.2" xref="A3.SS2.1.p1.5.m5.4.4.3.3.1.cmml">,</mo><mi id="A3.SS2.1.p1.5.m5.3.3" xref="A3.SS2.1.p1.5.m5.3.3.cmml">a</mi><mo id="A3.SS2.1.p1.5.m5.4.4.3.3.2.3" stretchy="false" xref="A3.SS2.1.p1.5.m5.4.4.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS2.1.p1.5.m5.4b"><apply id="A3.SS2.1.p1.5.m5.4.4.cmml" xref="A3.SS2.1.p1.5.m5.4.4"><gt id="A3.SS2.1.p1.5.m5.4.4.2.cmml" xref="A3.SS2.1.p1.5.m5.4.4.2"></gt><apply id="A3.SS2.1.p1.5.m5.4.4.1.cmml" xref="A3.SS2.1.p1.5.m5.4.4.1"><times id="A3.SS2.1.p1.5.m5.4.4.1.2.cmml" xref="A3.SS2.1.p1.5.m5.4.4.1.2"></times><apply id="A3.SS2.1.p1.5.m5.4.4.1.3.cmml" xref="A3.SS2.1.p1.5.m5.4.4.1.3"><csymbol cd="ambiguous" id="A3.SS2.1.p1.5.m5.4.4.1.3.1.cmml" xref="A3.SS2.1.p1.5.m5.4.4.1.3">subscript</csymbol><ci id="A3.SS2.1.p1.5.m5.4.4.1.3.2.cmml" xref="A3.SS2.1.p1.5.m5.4.4.1.3.2">𝐶</ci><ci id="A3.SS2.1.p1.5.m5.4.4.1.3.3.cmml" xref="A3.SS2.1.p1.5.m5.4.4.1.3.3">𝜔</ci></apply><interval closure="open" id="A3.SS2.1.p1.5.m5.4.4.1.1.2.cmml" xref="A3.SS2.1.p1.5.m5.4.4.1.1.1"><ci id="A3.SS2.1.p1.5.m5.1.1.cmml" xref="A3.SS2.1.p1.5.m5.1.1">𝑠</ci><apply id="A3.SS2.1.p1.5.m5.4.4.1.1.1.1.cmml" xref="A3.SS2.1.p1.5.m5.4.4.1.1.1.1"><csymbol cd="ambiguous" id="A3.SS2.1.p1.5.m5.4.4.1.1.1.1.1.cmml" xref="A3.SS2.1.p1.5.m5.4.4.1.1.1.1">superscript</csymbol><ci id="A3.SS2.1.p1.5.m5.4.4.1.1.1.1.2.cmml" xref="A3.SS2.1.p1.5.m5.4.4.1.1.1.1.2">𝑎</ci><times id="A3.SS2.1.p1.5.m5.4.4.1.1.1.1.3.cmml" xref="A3.SS2.1.p1.5.m5.4.4.1.1.1.1.3"></times></apply></interval></apply><apply id="A3.SS2.1.p1.5.m5.4.4.3.cmml" xref="A3.SS2.1.p1.5.m5.4.4.3"><times id="A3.SS2.1.p1.5.m5.4.4.3.1.cmml" xref="A3.SS2.1.p1.5.m5.4.4.3.1"></times><apply id="A3.SS2.1.p1.5.m5.4.4.3.2.cmml" xref="A3.SS2.1.p1.5.m5.4.4.3.2"><csymbol cd="ambiguous" id="A3.SS2.1.p1.5.m5.4.4.3.2.1.cmml" xref="A3.SS2.1.p1.5.m5.4.4.3.2">subscript</csymbol><ci id="A3.SS2.1.p1.5.m5.4.4.3.2.2.cmml" xref="A3.SS2.1.p1.5.m5.4.4.3.2.2">𝐶</ci><ci id="A3.SS2.1.p1.5.m5.4.4.3.2.3.cmml" xref="A3.SS2.1.p1.5.m5.4.4.3.2.3">𝜔</ci></apply><interval closure="open" id="A3.SS2.1.p1.5.m5.4.4.3.3.1.cmml" xref="A3.SS2.1.p1.5.m5.4.4.3.3.2"><ci id="A3.SS2.1.p1.5.m5.2.2.cmml" xref="A3.SS2.1.p1.5.m5.2.2">𝑠</ci><ci id="A3.SS2.1.p1.5.m5.3.3.cmml" xref="A3.SS2.1.p1.5.m5.3.3">𝑎</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.1.p1.5.m5.4c">C_{\omega}(s,a^{*})&gt;C_{\omega}(s,a)</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.1.p1.5.m5.4d">italic_C start_POSTSUBSCRIPT italic_ω end_POSTSUBSCRIPT ( italic_s , italic_a start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ) &gt; italic_C start_POSTSUBSCRIPT italic_ω end_POSTSUBSCRIPT ( italic_s , italic_a )</annotation></semantics></math>, we can get</p>
<table class="ltx_equationgroup ltx_eqn_table" id="A3.Ex10">
<tbody id="A3.Ex10X"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\sum_{a}I_{\{C_{\omega}(s,a)\geq\kappa\}}\pi(a|s)Q^{\pi}(s,a)" class="ltx_Math" display="inline" id="A3.Ex10X.2.1.1.m1.6"><semantics id="A3.Ex10X.2.1.1.m1.6a"><mrow id="A3.Ex10X.2.1.1.m1.6.6" xref="A3.Ex10X.2.1.1.m1.6.6.cmml"><mstyle displaystyle="true" id="A3.Ex10X.2.1.1.m1.6.6.2" xref="A3.Ex10X.2.1.1.m1.6.6.2.cmml"><munder id="A3.Ex10X.2.1.1.m1.6.6.2a" xref="A3.Ex10X.2.1.1.m1.6.6.2.cmml"><mo id="A3.Ex10X.2.1.1.m1.6.6.2.2" movablelimits="false" xref="A3.Ex10X.2.1.1.m1.6.6.2.2.cmml">∑</mo><mi id="A3.Ex10X.2.1.1.m1.6.6.2.3" xref="A3.Ex10X.2.1.1.m1.6.6.2.3.cmml">a</mi></munder></mstyle><mrow id="A3.Ex10X.2.1.1.m1.6.6.1" xref="A3.Ex10X.2.1.1.m1.6.6.1.cmml"><msub id="A3.Ex10X.2.1.1.m1.6.6.1.3" xref="A3.Ex10X.2.1.1.m1.6.6.1.3.cmml"><mi id="A3.Ex10X.2.1.1.m1.6.6.1.3.2" xref="A3.Ex10X.2.1.1.m1.6.6.1.3.2.cmml">I</mi><mrow id="A3.Ex10X.2.1.1.m1.3.3.3.3" xref="A3.Ex10X.2.1.1.m1.3.3.3.4.cmml"><mo id="A3.Ex10X.2.1.1.m1.3.3.3.3.2" stretchy="false" xref="A3.Ex10X.2.1.1.m1.3.3.3.4.cmml">{</mo><mrow id="A3.Ex10X.2.1.1.m1.3.3.3.3.1" xref="A3.Ex10X.2.1.1.m1.3.3.3.3.1.cmml"><mrow id="A3.Ex10X.2.1.1.m1.3.3.3.3.1.2" xref="A3.Ex10X.2.1.1.m1.3.3.3.3.1.2.cmml"><msub id="A3.Ex10X.2.1.1.m1.3.3.3.3.1.2.2" xref="A3.Ex10X.2.1.1.m1.3.3.3.3.1.2.2.cmml"><mi id="A3.Ex10X.2.1.1.m1.3.3.3.3.1.2.2.2" xref="A3.Ex10X.2.1.1.m1.3.3.3.3.1.2.2.2.cmml">C</mi><mi id="A3.Ex10X.2.1.1.m1.3.3.3.3.1.2.2.3" xref="A3.Ex10X.2.1.1.m1.3.3.3.3.1.2.2.3.cmml">ω</mi></msub><mo id="A3.Ex10X.2.1.1.m1.3.3.3.3.1.2.1" xref="A3.Ex10X.2.1.1.m1.3.3.3.3.1.2.1.cmml">⁢</mo><mrow id="A3.Ex10X.2.1.1.m1.3.3.3.3.1.2.3.2" xref="A3.Ex10X.2.1.1.m1.3.3.3.3.1.2.3.1.cmml"><mo id="A3.Ex10X.2.1.1.m1.3.3.3.3.1.2.3.2.1" stretchy="false" xref="A3.Ex10X.2.1.1.m1.3.3.3.3.1.2.3.1.cmml">(</mo><mi id="A3.Ex10X.2.1.1.m1.1.1.1.1" xref="A3.Ex10X.2.1.1.m1.1.1.1.1.cmml">s</mi><mo id="A3.Ex10X.2.1.1.m1.3.3.3.3.1.2.3.2.2" xref="A3.Ex10X.2.1.1.m1.3.3.3.3.1.2.3.1.cmml">,</mo><mi id="A3.Ex10X.2.1.1.m1.2.2.2.2" xref="A3.Ex10X.2.1.1.m1.2.2.2.2.cmml">a</mi><mo id="A3.Ex10X.2.1.1.m1.3.3.3.3.1.2.3.2.3" stretchy="false" xref="A3.Ex10X.2.1.1.m1.3.3.3.3.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="A3.Ex10X.2.1.1.m1.3.3.3.3.1.1" xref="A3.Ex10X.2.1.1.m1.3.3.3.3.1.1.cmml">≥</mo><mi id="A3.Ex10X.2.1.1.m1.3.3.3.3.1.3" xref="A3.Ex10X.2.1.1.m1.3.3.3.3.1.3.cmml">κ</mi></mrow><mo id="A3.Ex10X.2.1.1.m1.3.3.3.3.3" stretchy="false" xref="A3.Ex10X.2.1.1.m1.3.3.3.4.cmml">}</mo></mrow></msub><mo id="A3.Ex10X.2.1.1.m1.6.6.1.2" xref="A3.Ex10X.2.1.1.m1.6.6.1.2.cmml">⁢</mo><mi id="A3.Ex10X.2.1.1.m1.6.6.1.4" xref="A3.Ex10X.2.1.1.m1.6.6.1.4.cmml">π</mi><mo id="A3.Ex10X.2.1.1.m1.6.6.1.2a" xref="A3.Ex10X.2.1.1.m1.6.6.1.2.cmml">⁢</mo><mrow id="A3.Ex10X.2.1.1.m1.6.6.1.1.1" xref="A3.Ex10X.2.1.1.m1.6.6.1.1.1.1.cmml"><mo id="A3.Ex10X.2.1.1.m1.6.6.1.1.1.2" stretchy="false" xref="A3.Ex10X.2.1.1.m1.6.6.1.1.1.1.cmml">(</mo><mrow id="A3.Ex10X.2.1.1.m1.6.6.1.1.1.1" xref="A3.Ex10X.2.1.1.m1.6.6.1.1.1.1.cmml"><mi id="A3.Ex10X.2.1.1.m1.6.6.1.1.1.1.2" xref="A3.Ex10X.2.1.1.m1.6.6.1.1.1.1.2.cmml">a</mi><mo fence="false" id="A3.Ex10X.2.1.1.m1.6.6.1.1.1.1.1" xref="A3.Ex10X.2.1.1.m1.6.6.1.1.1.1.1.cmml">|</mo><mi id="A3.Ex10X.2.1.1.m1.6.6.1.1.1.1.3" xref="A3.Ex10X.2.1.1.m1.6.6.1.1.1.1.3.cmml">s</mi></mrow><mo id="A3.Ex10X.2.1.1.m1.6.6.1.1.1.3" stretchy="false" xref="A3.Ex10X.2.1.1.m1.6.6.1.1.1.1.cmml">)</mo></mrow><mo id="A3.Ex10X.2.1.1.m1.6.6.1.2b" xref="A3.Ex10X.2.1.1.m1.6.6.1.2.cmml">⁢</mo><msup id="A3.Ex10X.2.1.1.m1.6.6.1.5" xref="A3.Ex10X.2.1.1.m1.6.6.1.5.cmml"><mi id="A3.Ex10X.2.1.1.m1.6.6.1.5.2" xref="A3.Ex10X.2.1.1.m1.6.6.1.5.2.cmml">Q</mi><mi id="A3.Ex10X.2.1.1.m1.6.6.1.5.3" xref="A3.Ex10X.2.1.1.m1.6.6.1.5.3.cmml">π</mi></msup><mo id="A3.Ex10X.2.1.1.m1.6.6.1.2c" xref="A3.Ex10X.2.1.1.m1.6.6.1.2.cmml">⁢</mo><mrow id="A3.Ex10X.2.1.1.m1.6.6.1.6.2" xref="A3.Ex10X.2.1.1.m1.6.6.1.6.1.cmml"><mo id="A3.Ex10X.2.1.1.m1.6.6.1.6.2.1" stretchy="false" xref="A3.Ex10X.2.1.1.m1.6.6.1.6.1.cmml">(</mo><mi id="A3.Ex10X.2.1.1.m1.4.4" xref="A3.Ex10X.2.1.1.m1.4.4.cmml">s</mi><mo id="A3.Ex10X.2.1.1.m1.6.6.1.6.2.2" xref="A3.Ex10X.2.1.1.m1.6.6.1.6.1.cmml">,</mo><mi id="A3.Ex10X.2.1.1.m1.5.5" xref="A3.Ex10X.2.1.1.m1.5.5.cmml">a</mi><mo id="A3.Ex10X.2.1.1.m1.6.6.1.6.2.3" stretchy="false" xref="A3.Ex10X.2.1.1.m1.6.6.1.6.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.Ex10X.2.1.1.m1.6b"><apply id="A3.Ex10X.2.1.1.m1.6.6.cmml" xref="A3.Ex10X.2.1.1.m1.6.6"><apply id="A3.Ex10X.2.1.1.m1.6.6.2.cmml" xref="A3.Ex10X.2.1.1.m1.6.6.2"><csymbol cd="ambiguous" id="A3.Ex10X.2.1.1.m1.6.6.2.1.cmml" xref="A3.Ex10X.2.1.1.m1.6.6.2">subscript</csymbol><sum id="A3.Ex10X.2.1.1.m1.6.6.2.2.cmml" xref="A3.Ex10X.2.1.1.m1.6.6.2.2"></sum><ci id="A3.Ex10X.2.1.1.m1.6.6.2.3.cmml" xref="A3.Ex10X.2.1.1.m1.6.6.2.3">𝑎</ci></apply><apply id="A3.Ex10X.2.1.1.m1.6.6.1.cmml" xref="A3.Ex10X.2.1.1.m1.6.6.1"><times id="A3.Ex10X.2.1.1.m1.6.6.1.2.cmml" xref="A3.Ex10X.2.1.1.m1.6.6.1.2"></times><apply id="A3.Ex10X.2.1.1.m1.6.6.1.3.cmml" xref="A3.Ex10X.2.1.1.m1.6.6.1.3"><csymbol cd="ambiguous" id="A3.Ex10X.2.1.1.m1.6.6.1.3.1.cmml" xref="A3.Ex10X.2.1.1.m1.6.6.1.3">subscript</csymbol><ci id="A3.Ex10X.2.1.1.m1.6.6.1.3.2.cmml" xref="A3.Ex10X.2.1.1.m1.6.6.1.3.2">𝐼</ci><set id="A3.Ex10X.2.1.1.m1.3.3.3.4.cmml" xref="A3.Ex10X.2.1.1.m1.3.3.3.3"><apply id="A3.Ex10X.2.1.1.m1.3.3.3.3.1.cmml" xref="A3.Ex10X.2.1.1.m1.3.3.3.3.1"><geq id="A3.Ex10X.2.1.1.m1.3.3.3.3.1.1.cmml" xref="A3.Ex10X.2.1.1.m1.3.3.3.3.1.1"></geq><apply id="A3.Ex10X.2.1.1.m1.3.3.3.3.1.2.cmml" xref="A3.Ex10X.2.1.1.m1.3.3.3.3.1.2"><times id="A3.Ex10X.2.1.1.m1.3.3.3.3.1.2.1.cmml" xref="A3.Ex10X.2.1.1.m1.3.3.3.3.1.2.1"></times><apply id="A3.Ex10X.2.1.1.m1.3.3.3.3.1.2.2.cmml" xref="A3.Ex10X.2.1.1.m1.3.3.3.3.1.2.2"><csymbol cd="ambiguous" id="A3.Ex10X.2.1.1.m1.3.3.3.3.1.2.2.1.cmml" xref="A3.Ex10X.2.1.1.m1.3.3.3.3.1.2.2">subscript</csymbol><ci id="A3.Ex10X.2.1.1.m1.3.3.3.3.1.2.2.2.cmml" xref="A3.Ex10X.2.1.1.m1.3.3.3.3.1.2.2.2">𝐶</ci><ci id="A3.Ex10X.2.1.1.m1.3.3.3.3.1.2.2.3.cmml" xref="A3.Ex10X.2.1.1.m1.3.3.3.3.1.2.2.3">𝜔</ci></apply><interval closure="open" id="A3.Ex10X.2.1.1.m1.3.3.3.3.1.2.3.1.cmml" xref="A3.Ex10X.2.1.1.m1.3.3.3.3.1.2.3.2"><ci id="A3.Ex10X.2.1.1.m1.1.1.1.1.cmml" xref="A3.Ex10X.2.1.1.m1.1.1.1.1">𝑠</ci><ci id="A3.Ex10X.2.1.1.m1.2.2.2.2.cmml" xref="A3.Ex10X.2.1.1.m1.2.2.2.2">𝑎</ci></interval></apply><ci id="A3.Ex10X.2.1.1.m1.3.3.3.3.1.3.cmml" xref="A3.Ex10X.2.1.1.m1.3.3.3.3.1.3">𝜅</ci></apply></set></apply><ci id="A3.Ex10X.2.1.1.m1.6.6.1.4.cmml" xref="A3.Ex10X.2.1.1.m1.6.6.1.4">𝜋</ci><apply id="A3.Ex10X.2.1.1.m1.6.6.1.1.1.1.cmml" xref="A3.Ex10X.2.1.1.m1.6.6.1.1.1"><csymbol cd="latexml" id="A3.Ex10X.2.1.1.m1.6.6.1.1.1.1.1.cmml" xref="A3.Ex10X.2.1.1.m1.6.6.1.1.1.1.1">conditional</csymbol><ci id="A3.Ex10X.2.1.1.m1.6.6.1.1.1.1.2.cmml" xref="A3.Ex10X.2.1.1.m1.6.6.1.1.1.1.2">𝑎</ci><ci id="A3.Ex10X.2.1.1.m1.6.6.1.1.1.1.3.cmml" xref="A3.Ex10X.2.1.1.m1.6.6.1.1.1.1.3">𝑠</ci></apply><apply id="A3.Ex10X.2.1.1.m1.6.6.1.5.cmml" xref="A3.Ex10X.2.1.1.m1.6.6.1.5"><csymbol cd="ambiguous" id="A3.Ex10X.2.1.1.m1.6.6.1.5.1.cmml" xref="A3.Ex10X.2.1.1.m1.6.6.1.5">superscript</csymbol><ci id="A3.Ex10X.2.1.1.m1.6.6.1.5.2.cmml" xref="A3.Ex10X.2.1.1.m1.6.6.1.5.2">𝑄</ci><ci id="A3.Ex10X.2.1.1.m1.6.6.1.5.3.cmml" xref="A3.Ex10X.2.1.1.m1.6.6.1.5.3">𝜋</ci></apply><interval closure="open" id="A3.Ex10X.2.1.1.m1.6.6.1.6.1.cmml" xref="A3.Ex10X.2.1.1.m1.6.6.1.6.2"><ci id="A3.Ex10X.2.1.1.m1.4.4.cmml" xref="A3.Ex10X.2.1.1.m1.4.4">𝑠</ci><ci id="A3.Ex10X.2.1.1.m1.5.5.cmml" xref="A3.Ex10X.2.1.1.m1.5.5">𝑎</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex10X.2.1.1.m1.6c">\displaystyle\sum_{a}I_{\{C_{\omega}(s,a)\geq\kappa\}}\pi(a|s)Q^{\pi}(s,a)</annotation><annotation encoding="application/x-llamapun" id="A3.Ex10X.2.1.1.m1.6d">∑ start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT italic_I start_POSTSUBSCRIPT { italic_C start_POSTSUBSCRIPT italic_ω end_POSTSUBSCRIPT ( italic_s , italic_a ) ≥ italic_κ } end_POSTSUBSCRIPT italic_π ( italic_a | italic_s ) italic_Q start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT ( italic_s , italic_a )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A3.Ex10Xa"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\leq" class="ltx_Math" display="inline" id="A3.Ex10Xa.2.1.1.m1.1"><semantics id="A3.Ex10Xa.2.1.1.m1.1a"><mo id="A3.Ex10Xa.2.1.1.m1.1.1" xref="A3.Ex10Xa.2.1.1.m1.1.1.cmml">≤</mo><annotation-xml encoding="MathML-Content" id="A3.Ex10Xa.2.1.1.m1.1b"><leq id="A3.Ex10Xa.2.1.1.m1.1.1.cmml" xref="A3.Ex10Xa.2.1.1.m1.1.1"></leq></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex10Xa.2.1.1.m1.1c">\displaystyle\leq</annotation><annotation encoding="application/x-llamapun" id="A3.Ex10Xa.2.1.1.m1.1d">≤</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle I_{\{C_{\omega}(s,a^{*})\geq\kappa\}}\sum_{a}\pi(a|s)Q^{\pi}(s,a)" class="ltx_Math" display="inline" id="A3.Ex10Xa.3.2.2.m1.5"><semantics id="A3.Ex10Xa.3.2.2.m1.5a"><mrow id="A3.Ex10Xa.3.2.2.m1.5.5" xref="A3.Ex10Xa.3.2.2.m1.5.5.cmml"><msub id="A3.Ex10Xa.3.2.2.m1.5.5.3" xref="A3.Ex10Xa.3.2.2.m1.5.5.3.cmml"><mi id="A3.Ex10Xa.3.2.2.m1.5.5.3.2" xref="A3.Ex10Xa.3.2.2.m1.5.5.3.2.cmml">I</mi><mrow id="A3.Ex10Xa.3.2.2.m1.2.2.2.2" xref="A3.Ex10Xa.3.2.2.m1.2.2.2.3.cmml"><mo id="A3.Ex10Xa.3.2.2.m1.2.2.2.2.2" stretchy="false" xref="A3.Ex10Xa.3.2.2.m1.2.2.2.3.cmml">{</mo><mrow id="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1" xref="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.cmml"><mrow id="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.1" xref="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.1.cmml"><msub id="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.1.3" xref="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.1.3.cmml"><mi id="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.1.3.2" xref="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.1.3.2.cmml">C</mi><mi id="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.1.3.3" xref="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.1.3.3.cmml">ω</mi></msub><mo id="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.1.2" xref="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.1.2.cmml">⁢</mo><mrow id="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.1.1.1" xref="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.1.1.2.cmml"><mo id="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.1.1.1.2" stretchy="false" xref="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.1.1.2.cmml">(</mo><mi id="A3.Ex10Xa.3.2.2.m1.1.1.1.1" xref="A3.Ex10Xa.3.2.2.m1.1.1.1.1.cmml">s</mi><mo id="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.1.1.1.3" xref="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.1.1.2.cmml">,</mo><msup id="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.1.1.1.1" xref="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.1.1.1.1.cmml"><mi id="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.1.1.1.1.2" xref="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.1.1.1.1.2.cmml">a</mi><mo id="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.1.1.1.1.3" xref="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.1.1.1.1.3.cmml">∗</mo></msup><mo id="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.1.1.1.4" stretchy="false" xref="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.2" xref="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.2.cmml">≥</mo><mi id="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.3" xref="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.3.cmml">κ</mi></mrow><mo id="A3.Ex10Xa.3.2.2.m1.2.2.2.2.3" stretchy="false" xref="A3.Ex10Xa.3.2.2.m1.2.2.2.3.cmml">}</mo></mrow></msub><mo id="A3.Ex10Xa.3.2.2.m1.5.5.2" xref="A3.Ex10Xa.3.2.2.m1.5.5.2.cmml">⁢</mo><mrow id="A3.Ex10Xa.3.2.2.m1.5.5.1" xref="A3.Ex10Xa.3.2.2.m1.5.5.1.cmml"><mstyle displaystyle="true" id="A3.Ex10Xa.3.2.2.m1.5.5.1.2" xref="A3.Ex10Xa.3.2.2.m1.5.5.1.2.cmml"><munder id="A3.Ex10Xa.3.2.2.m1.5.5.1.2a" xref="A3.Ex10Xa.3.2.2.m1.5.5.1.2.cmml"><mo id="A3.Ex10Xa.3.2.2.m1.5.5.1.2.2" movablelimits="false" xref="A3.Ex10Xa.3.2.2.m1.5.5.1.2.2.cmml">∑</mo><mi id="A3.Ex10Xa.3.2.2.m1.5.5.1.2.3" xref="A3.Ex10Xa.3.2.2.m1.5.5.1.2.3.cmml">a</mi></munder></mstyle><mrow id="A3.Ex10Xa.3.2.2.m1.5.5.1.1" xref="A3.Ex10Xa.3.2.2.m1.5.5.1.1.cmml"><mi id="A3.Ex10Xa.3.2.2.m1.5.5.1.1.3" xref="A3.Ex10Xa.3.2.2.m1.5.5.1.1.3.cmml">π</mi><mo id="A3.Ex10Xa.3.2.2.m1.5.5.1.1.2" xref="A3.Ex10Xa.3.2.2.m1.5.5.1.1.2.cmml">⁢</mo><mrow id="A3.Ex10Xa.3.2.2.m1.5.5.1.1.1.1" xref="A3.Ex10Xa.3.2.2.m1.5.5.1.1.1.1.1.cmml"><mo id="A3.Ex10Xa.3.2.2.m1.5.5.1.1.1.1.2" stretchy="false" xref="A3.Ex10Xa.3.2.2.m1.5.5.1.1.1.1.1.cmml">(</mo><mrow id="A3.Ex10Xa.3.2.2.m1.5.5.1.1.1.1.1" xref="A3.Ex10Xa.3.2.2.m1.5.5.1.1.1.1.1.cmml"><mi id="A3.Ex10Xa.3.2.2.m1.5.5.1.1.1.1.1.2" xref="A3.Ex10Xa.3.2.2.m1.5.5.1.1.1.1.1.2.cmml">a</mi><mo fence="false" id="A3.Ex10Xa.3.2.2.m1.5.5.1.1.1.1.1.1" xref="A3.Ex10Xa.3.2.2.m1.5.5.1.1.1.1.1.1.cmml">|</mo><mi id="A3.Ex10Xa.3.2.2.m1.5.5.1.1.1.1.1.3" xref="A3.Ex10Xa.3.2.2.m1.5.5.1.1.1.1.1.3.cmml">s</mi></mrow><mo id="A3.Ex10Xa.3.2.2.m1.5.5.1.1.1.1.3" stretchy="false" xref="A3.Ex10Xa.3.2.2.m1.5.5.1.1.1.1.1.cmml">)</mo></mrow><mo id="A3.Ex10Xa.3.2.2.m1.5.5.1.1.2a" xref="A3.Ex10Xa.3.2.2.m1.5.5.1.1.2.cmml">⁢</mo><msup id="A3.Ex10Xa.3.2.2.m1.5.5.1.1.4" xref="A3.Ex10Xa.3.2.2.m1.5.5.1.1.4.cmml"><mi id="A3.Ex10Xa.3.2.2.m1.5.5.1.1.4.2" xref="A3.Ex10Xa.3.2.2.m1.5.5.1.1.4.2.cmml">Q</mi><mi id="A3.Ex10Xa.3.2.2.m1.5.5.1.1.4.3" xref="A3.Ex10Xa.3.2.2.m1.5.5.1.1.4.3.cmml">π</mi></msup><mo id="A3.Ex10Xa.3.2.2.m1.5.5.1.1.2b" xref="A3.Ex10Xa.3.2.2.m1.5.5.1.1.2.cmml">⁢</mo><mrow id="A3.Ex10Xa.3.2.2.m1.5.5.1.1.5.2" xref="A3.Ex10Xa.3.2.2.m1.5.5.1.1.5.1.cmml"><mo id="A3.Ex10Xa.3.2.2.m1.5.5.1.1.5.2.1" stretchy="false" xref="A3.Ex10Xa.3.2.2.m1.5.5.1.1.5.1.cmml">(</mo><mi id="A3.Ex10Xa.3.2.2.m1.3.3" xref="A3.Ex10Xa.3.2.2.m1.3.3.cmml">s</mi><mo id="A3.Ex10Xa.3.2.2.m1.5.5.1.1.5.2.2" xref="A3.Ex10Xa.3.2.2.m1.5.5.1.1.5.1.cmml">,</mo><mi id="A3.Ex10Xa.3.2.2.m1.4.4" xref="A3.Ex10Xa.3.2.2.m1.4.4.cmml">a</mi><mo id="A3.Ex10Xa.3.2.2.m1.5.5.1.1.5.2.3" stretchy="false" xref="A3.Ex10Xa.3.2.2.m1.5.5.1.1.5.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.Ex10Xa.3.2.2.m1.5b"><apply id="A3.Ex10Xa.3.2.2.m1.5.5.cmml" xref="A3.Ex10Xa.3.2.2.m1.5.5"><times id="A3.Ex10Xa.3.2.2.m1.5.5.2.cmml" xref="A3.Ex10Xa.3.2.2.m1.5.5.2"></times><apply id="A3.Ex10Xa.3.2.2.m1.5.5.3.cmml" xref="A3.Ex10Xa.3.2.2.m1.5.5.3"><csymbol cd="ambiguous" id="A3.Ex10Xa.3.2.2.m1.5.5.3.1.cmml" xref="A3.Ex10Xa.3.2.2.m1.5.5.3">subscript</csymbol><ci id="A3.Ex10Xa.3.2.2.m1.5.5.3.2.cmml" xref="A3.Ex10Xa.3.2.2.m1.5.5.3.2">𝐼</ci><set id="A3.Ex10Xa.3.2.2.m1.2.2.2.3.cmml" xref="A3.Ex10Xa.3.2.2.m1.2.2.2.2"><apply id="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.cmml" xref="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1"><geq id="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.2.cmml" xref="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.2"></geq><apply id="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.1.cmml" xref="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.1"><times id="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.1.2.cmml" xref="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.1.2"></times><apply id="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.1.3.cmml" xref="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.1.3.1.cmml" xref="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.1.3">subscript</csymbol><ci id="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.1.3.2.cmml" xref="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.1.3.2">𝐶</ci><ci id="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.1.3.3.cmml" xref="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.1.3.3">𝜔</ci></apply><interval closure="open" id="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.1.1.2.cmml" xref="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.1.1.1"><ci id="A3.Ex10Xa.3.2.2.m1.1.1.1.1.cmml" xref="A3.Ex10Xa.3.2.2.m1.1.1.1.1">𝑠</ci><apply id="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.1.1.1.1.cmml" xref="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.1.1.1.1.1.cmml" xref="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.1.1.1.1">superscript</csymbol><ci id="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.1.1.1.1.2.cmml" xref="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.1.1.1.1.2">𝑎</ci><times id="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.1.1.1.1.3.cmml" xref="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.1.1.1.1.3"></times></apply></interval></apply><ci id="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.3.cmml" xref="A3.Ex10Xa.3.2.2.m1.2.2.2.2.1.3">𝜅</ci></apply></set></apply><apply id="A3.Ex10Xa.3.2.2.m1.5.5.1.cmml" xref="A3.Ex10Xa.3.2.2.m1.5.5.1"><apply id="A3.Ex10Xa.3.2.2.m1.5.5.1.2.cmml" xref="A3.Ex10Xa.3.2.2.m1.5.5.1.2"><csymbol cd="ambiguous" id="A3.Ex10Xa.3.2.2.m1.5.5.1.2.1.cmml" xref="A3.Ex10Xa.3.2.2.m1.5.5.1.2">subscript</csymbol><sum id="A3.Ex10Xa.3.2.2.m1.5.5.1.2.2.cmml" xref="A3.Ex10Xa.3.2.2.m1.5.5.1.2.2"></sum><ci id="A3.Ex10Xa.3.2.2.m1.5.5.1.2.3.cmml" xref="A3.Ex10Xa.3.2.2.m1.5.5.1.2.3">𝑎</ci></apply><apply id="A3.Ex10Xa.3.2.2.m1.5.5.1.1.cmml" xref="A3.Ex10Xa.3.2.2.m1.5.5.1.1"><times id="A3.Ex10Xa.3.2.2.m1.5.5.1.1.2.cmml" xref="A3.Ex10Xa.3.2.2.m1.5.5.1.1.2"></times><ci id="A3.Ex10Xa.3.2.2.m1.5.5.1.1.3.cmml" xref="A3.Ex10Xa.3.2.2.m1.5.5.1.1.3">𝜋</ci><apply id="A3.Ex10Xa.3.2.2.m1.5.5.1.1.1.1.1.cmml" xref="A3.Ex10Xa.3.2.2.m1.5.5.1.1.1.1"><csymbol cd="latexml" id="A3.Ex10Xa.3.2.2.m1.5.5.1.1.1.1.1.1.cmml" xref="A3.Ex10Xa.3.2.2.m1.5.5.1.1.1.1.1.1">conditional</csymbol><ci id="A3.Ex10Xa.3.2.2.m1.5.5.1.1.1.1.1.2.cmml" xref="A3.Ex10Xa.3.2.2.m1.5.5.1.1.1.1.1.2">𝑎</ci><ci id="A3.Ex10Xa.3.2.2.m1.5.5.1.1.1.1.1.3.cmml" xref="A3.Ex10Xa.3.2.2.m1.5.5.1.1.1.1.1.3">𝑠</ci></apply><apply id="A3.Ex10Xa.3.2.2.m1.5.5.1.1.4.cmml" xref="A3.Ex10Xa.3.2.2.m1.5.5.1.1.4"><csymbol cd="ambiguous" id="A3.Ex10Xa.3.2.2.m1.5.5.1.1.4.1.cmml" xref="A3.Ex10Xa.3.2.2.m1.5.5.1.1.4">superscript</csymbol><ci id="A3.Ex10Xa.3.2.2.m1.5.5.1.1.4.2.cmml" xref="A3.Ex10Xa.3.2.2.m1.5.5.1.1.4.2">𝑄</ci><ci id="A3.Ex10Xa.3.2.2.m1.5.5.1.1.4.3.cmml" xref="A3.Ex10Xa.3.2.2.m1.5.5.1.1.4.3">𝜋</ci></apply><interval closure="open" id="A3.Ex10Xa.3.2.2.m1.5.5.1.1.5.1.cmml" xref="A3.Ex10Xa.3.2.2.m1.5.5.1.1.5.2"><ci id="A3.Ex10Xa.3.2.2.m1.3.3.cmml" xref="A3.Ex10Xa.3.2.2.m1.3.3">𝑠</ci><ci id="A3.Ex10Xa.3.2.2.m1.4.4.cmml" xref="A3.Ex10Xa.3.2.2.m1.4.4">𝑎</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex10Xa.3.2.2.m1.5c">\displaystyle I_{\{C_{\omega}(s,a^{*})\geq\kappa\}}\sum_{a}\pi(a|s)Q^{\pi}(s,a)</annotation><annotation encoding="application/x-llamapun" id="A3.Ex10Xa.3.2.2.m1.5d">italic_I start_POSTSUBSCRIPT { italic_C start_POSTSUBSCRIPT italic_ω end_POSTSUBSCRIPT ( italic_s , italic_a start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ) ≥ italic_κ } end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT italic_π ( italic_a | italic_s ) italic_Q start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT ( italic_s , italic_a )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A3.Ex10Xb"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\leq" class="ltx_Math" display="inline" id="A3.Ex10Xb.2.1.1.m1.1"><semantics id="A3.Ex10Xb.2.1.1.m1.1a"><mo id="A3.Ex10Xb.2.1.1.m1.1.1" xref="A3.Ex10Xb.2.1.1.m1.1.1.cmml">≤</mo><annotation-xml encoding="MathML-Content" id="A3.Ex10Xb.2.1.1.m1.1b"><leq id="A3.Ex10Xb.2.1.1.m1.1.1.cmml" xref="A3.Ex10Xb.2.1.1.m1.1.1"></leq></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex10Xb.2.1.1.m1.1c">\displaystyle\leq</annotation><annotation encoding="application/x-llamapun" id="A3.Ex10Xb.2.1.1.m1.1d">≤</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle I_{\{C_{\omega}(s,a^{*})\geq\kappa\}}Q^{\pi}(s,a^{*})" class="ltx_Math" display="inline" id="A3.Ex10Xb.3.2.2.m1.4"><semantics id="A3.Ex10Xb.3.2.2.m1.4a"><mrow id="A3.Ex10Xb.3.2.2.m1.4.4" xref="A3.Ex10Xb.3.2.2.m1.4.4.cmml"><msub id="A3.Ex10Xb.3.2.2.m1.4.4.3" xref="A3.Ex10Xb.3.2.2.m1.4.4.3.cmml"><mi id="A3.Ex10Xb.3.2.2.m1.4.4.3.2" xref="A3.Ex10Xb.3.2.2.m1.4.4.3.2.cmml">I</mi><mrow id="A3.Ex10Xb.3.2.2.m1.2.2.2.2" xref="A3.Ex10Xb.3.2.2.m1.2.2.2.3.cmml"><mo id="A3.Ex10Xb.3.2.2.m1.2.2.2.2.2" stretchy="false" xref="A3.Ex10Xb.3.2.2.m1.2.2.2.3.cmml">{</mo><mrow id="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1" xref="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.cmml"><mrow id="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.1" xref="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.1.cmml"><msub id="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.1.3" xref="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.1.3.cmml"><mi id="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.1.3.2" xref="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.1.3.2.cmml">C</mi><mi id="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.1.3.3" xref="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.1.3.3.cmml">ω</mi></msub><mo id="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.1.2" xref="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.1.2.cmml">⁢</mo><mrow id="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.1.1.1" xref="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.1.1.2.cmml"><mo id="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.1.1.1.2" stretchy="false" xref="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.1.1.2.cmml">(</mo><mi id="A3.Ex10Xb.3.2.2.m1.1.1.1.1" xref="A3.Ex10Xb.3.2.2.m1.1.1.1.1.cmml">s</mi><mo id="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.1.1.1.3" xref="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.1.1.2.cmml">,</mo><msup id="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.1.1.1.1" xref="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.1.1.1.1.cmml"><mi id="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.1.1.1.1.2" xref="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.1.1.1.1.2.cmml">a</mi><mo id="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.1.1.1.1.3" xref="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.1.1.1.1.3.cmml">∗</mo></msup><mo id="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.1.1.1.4" stretchy="false" xref="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.2" xref="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.2.cmml">≥</mo><mi id="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.3" xref="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.3.cmml">κ</mi></mrow><mo id="A3.Ex10Xb.3.2.2.m1.2.2.2.2.3" stretchy="false" xref="A3.Ex10Xb.3.2.2.m1.2.2.2.3.cmml">}</mo></mrow></msub><mo id="A3.Ex10Xb.3.2.2.m1.4.4.2" xref="A3.Ex10Xb.3.2.2.m1.4.4.2.cmml">⁢</mo><msup id="A3.Ex10Xb.3.2.2.m1.4.4.4" xref="A3.Ex10Xb.3.2.2.m1.4.4.4.cmml"><mi id="A3.Ex10Xb.3.2.2.m1.4.4.4.2" xref="A3.Ex10Xb.3.2.2.m1.4.4.4.2.cmml">Q</mi><mi id="A3.Ex10Xb.3.2.2.m1.4.4.4.3" xref="A3.Ex10Xb.3.2.2.m1.4.4.4.3.cmml">π</mi></msup><mo id="A3.Ex10Xb.3.2.2.m1.4.4.2a" xref="A3.Ex10Xb.3.2.2.m1.4.4.2.cmml">⁢</mo><mrow id="A3.Ex10Xb.3.2.2.m1.4.4.1.1" xref="A3.Ex10Xb.3.2.2.m1.4.4.1.2.cmml"><mo id="A3.Ex10Xb.3.2.2.m1.4.4.1.1.2" stretchy="false" xref="A3.Ex10Xb.3.2.2.m1.4.4.1.2.cmml">(</mo><mi id="A3.Ex10Xb.3.2.2.m1.3.3" xref="A3.Ex10Xb.3.2.2.m1.3.3.cmml">s</mi><mo id="A3.Ex10Xb.3.2.2.m1.4.4.1.1.3" xref="A3.Ex10Xb.3.2.2.m1.4.4.1.2.cmml">,</mo><msup id="A3.Ex10Xb.3.2.2.m1.4.4.1.1.1" xref="A3.Ex10Xb.3.2.2.m1.4.4.1.1.1.cmml"><mi id="A3.Ex10Xb.3.2.2.m1.4.4.1.1.1.2" xref="A3.Ex10Xb.3.2.2.m1.4.4.1.1.1.2.cmml">a</mi><mo id="A3.Ex10Xb.3.2.2.m1.4.4.1.1.1.3" xref="A3.Ex10Xb.3.2.2.m1.4.4.1.1.1.3.cmml">∗</mo></msup><mo id="A3.Ex10Xb.3.2.2.m1.4.4.1.1.4" stretchy="false" xref="A3.Ex10Xb.3.2.2.m1.4.4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.Ex10Xb.3.2.2.m1.4b"><apply id="A3.Ex10Xb.3.2.2.m1.4.4.cmml" xref="A3.Ex10Xb.3.2.2.m1.4.4"><times id="A3.Ex10Xb.3.2.2.m1.4.4.2.cmml" xref="A3.Ex10Xb.3.2.2.m1.4.4.2"></times><apply id="A3.Ex10Xb.3.2.2.m1.4.4.3.cmml" xref="A3.Ex10Xb.3.2.2.m1.4.4.3"><csymbol cd="ambiguous" id="A3.Ex10Xb.3.2.2.m1.4.4.3.1.cmml" xref="A3.Ex10Xb.3.2.2.m1.4.4.3">subscript</csymbol><ci id="A3.Ex10Xb.3.2.2.m1.4.4.3.2.cmml" xref="A3.Ex10Xb.3.2.2.m1.4.4.3.2">𝐼</ci><set id="A3.Ex10Xb.3.2.2.m1.2.2.2.3.cmml" xref="A3.Ex10Xb.3.2.2.m1.2.2.2.2"><apply id="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.cmml" xref="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1"><geq id="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.2.cmml" xref="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.2"></geq><apply id="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.1.cmml" xref="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.1"><times id="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.1.2.cmml" xref="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.1.2"></times><apply id="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.1.3.cmml" xref="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.1.3.1.cmml" xref="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.1.3">subscript</csymbol><ci id="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.1.3.2.cmml" xref="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.1.3.2">𝐶</ci><ci id="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.1.3.3.cmml" xref="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.1.3.3">𝜔</ci></apply><interval closure="open" id="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.1.1.2.cmml" xref="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.1.1.1"><ci id="A3.Ex10Xb.3.2.2.m1.1.1.1.1.cmml" xref="A3.Ex10Xb.3.2.2.m1.1.1.1.1">𝑠</ci><apply id="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.1.1.1.1.cmml" xref="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.1.1.1.1.1.cmml" xref="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.1.1.1.1">superscript</csymbol><ci id="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.1.1.1.1.2.cmml" xref="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.1.1.1.1.2">𝑎</ci><times id="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.1.1.1.1.3.cmml" xref="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.1.1.1.1.3"></times></apply></interval></apply><ci id="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.3.cmml" xref="A3.Ex10Xb.3.2.2.m1.2.2.2.2.1.3">𝜅</ci></apply></set></apply><apply id="A3.Ex10Xb.3.2.2.m1.4.4.4.cmml" xref="A3.Ex10Xb.3.2.2.m1.4.4.4"><csymbol cd="ambiguous" id="A3.Ex10Xb.3.2.2.m1.4.4.4.1.cmml" xref="A3.Ex10Xb.3.2.2.m1.4.4.4">superscript</csymbol><ci id="A3.Ex10Xb.3.2.2.m1.4.4.4.2.cmml" xref="A3.Ex10Xb.3.2.2.m1.4.4.4.2">𝑄</ci><ci id="A3.Ex10Xb.3.2.2.m1.4.4.4.3.cmml" xref="A3.Ex10Xb.3.2.2.m1.4.4.4.3">𝜋</ci></apply><interval closure="open" id="A3.Ex10Xb.3.2.2.m1.4.4.1.2.cmml" xref="A3.Ex10Xb.3.2.2.m1.4.4.1.1"><ci id="A3.Ex10Xb.3.2.2.m1.3.3.cmml" xref="A3.Ex10Xb.3.2.2.m1.3.3">𝑠</ci><apply id="A3.Ex10Xb.3.2.2.m1.4.4.1.1.1.cmml" xref="A3.Ex10Xb.3.2.2.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="A3.Ex10Xb.3.2.2.m1.4.4.1.1.1.1.cmml" xref="A3.Ex10Xb.3.2.2.m1.4.4.1.1.1">superscript</csymbol><ci id="A3.Ex10Xb.3.2.2.m1.4.4.1.1.1.2.cmml" xref="A3.Ex10Xb.3.2.2.m1.4.4.1.1.1.2">𝑎</ci><times id="A3.Ex10Xb.3.2.2.m1.4.4.1.1.1.3.cmml" xref="A3.Ex10Xb.3.2.2.m1.4.4.1.1.1.3"></times></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex10Xb.3.2.2.m1.4c">\displaystyle I_{\{C_{\omega}(s,a^{*})\geq\kappa\}}Q^{\pi}(s,a^{*})</annotation><annotation encoding="application/x-llamapun" id="A3.Ex10Xb.3.2.2.m1.4d">italic_I start_POSTSUBSCRIPT { italic_C start_POSTSUBSCRIPT italic_ω end_POSTSUBSCRIPT ( italic_s , italic_a start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ) ≥ italic_κ } end_POSTSUBSCRIPT italic_Q start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT ( italic_s , italic_a start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A3.Ex10Xc"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle=" class="ltx_Math" display="inline" id="A3.Ex10Xc.2.1.1.m1.1"><semantics id="A3.Ex10Xc.2.1.1.m1.1a"><mo id="A3.Ex10Xc.2.1.1.m1.1.1" xref="A3.Ex10Xc.2.1.1.m1.1.1.cmml">=</mo><annotation-xml encoding="MathML-Content" id="A3.Ex10Xc.2.1.1.m1.1b"><eq id="A3.Ex10Xc.2.1.1.m1.1.1.cmml" xref="A3.Ex10Xc.2.1.1.m1.1.1"></eq></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex10Xc.2.1.1.m1.1c">\displaystyle=</annotation><annotation encoding="application/x-llamapun" id="A3.Ex10Xc.2.1.1.m1.1d">=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\sum_{a}I_{\{C_{\omega}(s,a)\geq\kappa\}}\pi_{\theta}(a|s)Q^{\pi}%
(s,a)" class="ltx_Math" display="inline" id="A3.Ex10Xc.3.2.2.m1.6"><semantics id="A3.Ex10Xc.3.2.2.m1.6a"><mrow id="A3.Ex10Xc.3.2.2.m1.6.6" xref="A3.Ex10Xc.3.2.2.m1.6.6.cmml"><mstyle displaystyle="true" id="A3.Ex10Xc.3.2.2.m1.6.6.2" xref="A3.Ex10Xc.3.2.2.m1.6.6.2.cmml"><munder id="A3.Ex10Xc.3.2.2.m1.6.6.2a" xref="A3.Ex10Xc.3.2.2.m1.6.6.2.cmml"><mo id="A3.Ex10Xc.3.2.2.m1.6.6.2.2" movablelimits="false" xref="A3.Ex10Xc.3.2.2.m1.6.6.2.2.cmml">∑</mo><mi id="A3.Ex10Xc.3.2.2.m1.6.6.2.3" xref="A3.Ex10Xc.3.2.2.m1.6.6.2.3.cmml">a</mi></munder></mstyle><mrow id="A3.Ex10Xc.3.2.2.m1.6.6.1" xref="A3.Ex10Xc.3.2.2.m1.6.6.1.cmml"><msub id="A3.Ex10Xc.3.2.2.m1.6.6.1.3" xref="A3.Ex10Xc.3.2.2.m1.6.6.1.3.cmml"><mi id="A3.Ex10Xc.3.2.2.m1.6.6.1.3.2" xref="A3.Ex10Xc.3.2.2.m1.6.6.1.3.2.cmml">I</mi><mrow id="A3.Ex10Xc.3.2.2.m1.3.3.3.3" xref="A3.Ex10Xc.3.2.2.m1.3.3.3.4.cmml"><mo id="A3.Ex10Xc.3.2.2.m1.3.3.3.3.2" stretchy="false" xref="A3.Ex10Xc.3.2.2.m1.3.3.3.4.cmml">{</mo><mrow id="A3.Ex10Xc.3.2.2.m1.3.3.3.3.1" xref="A3.Ex10Xc.3.2.2.m1.3.3.3.3.1.cmml"><mrow id="A3.Ex10Xc.3.2.2.m1.3.3.3.3.1.2" xref="A3.Ex10Xc.3.2.2.m1.3.3.3.3.1.2.cmml"><msub id="A3.Ex10Xc.3.2.2.m1.3.3.3.3.1.2.2" xref="A3.Ex10Xc.3.2.2.m1.3.3.3.3.1.2.2.cmml"><mi id="A3.Ex10Xc.3.2.2.m1.3.3.3.3.1.2.2.2" xref="A3.Ex10Xc.3.2.2.m1.3.3.3.3.1.2.2.2.cmml">C</mi><mi id="A3.Ex10Xc.3.2.2.m1.3.3.3.3.1.2.2.3" xref="A3.Ex10Xc.3.2.2.m1.3.3.3.3.1.2.2.3.cmml">ω</mi></msub><mo id="A3.Ex10Xc.3.2.2.m1.3.3.3.3.1.2.1" xref="A3.Ex10Xc.3.2.2.m1.3.3.3.3.1.2.1.cmml">⁢</mo><mrow id="A3.Ex10Xc.3.2.2.m1.3.3.3.3.1.2.3.2" xref="A3.Ex10Xc.3.2.2.m1.3.3.3.3.1.2.3.1.cmml"><mo id="A3.Ex10Xc.3.2.2.m1.3.3.3.3.1.2.3.2.1" stretchy="false" xref="A3.Ex10Xc.3.2.2.m1.3.3.3.3.1.2.3.1.cmml">(</mo><mi id="A3.Ex10Xc.3.2.2.m1.1.1.1.1" xref="A3.Ex10Xc.3.2.2.m1.1.1.1.1.cmml">s</mi><mo id="A3.Ex10Xc.3.2.2.m1.3.3.3.3.1.2.3.2.2" xref="A3.Ex10Xc.3.2.2.m1.3.3.3.3.1.2.3.1.cmml">,</mo><mi id="A3.Ex10Xc.3.2.2.m1.2.2.2.2" xref="A3.Ex10Xc.3.2.2.m1.2.2.2.2.cmml">a</mi><mo id="A3.Ex10Xc.3.2.2.m1.3.3.3.3.1.2.3.2.3" stretchy="false" xref="A3.Ex10Xc.3.2.2.m1.3.3.3.3.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="A3.Ex10Xc.3.2.2.m1.3.3.3.3.1.1" xref="A3.Ex10Xc.3.2.2.m1.3.3.3.3.1.1.cmml">≥</mo><mi id="A3.Ex10Xc.3.2.2.m1.3.3.3.3.1.3" xref="A3.Ex10Xc.3.2.2.m1.3.3.3.3.1.3.cmml">κ</mi></mrow><mo id="A3.Ex10Xc.3.2.2.m1.3.3.3.3.3" stretchy="false" xref="A3.Ex10Xc.3.2.2.m1.3.3.3.4.cmml">}</mo></mrow></msub><mo id="A3.Ex10Xc.3.2.2.m1.6.6.1.2" xref="A3.Ex10Xc.3.2.2.m1.6.6.1.2.cmml">⁢</mo><msub id="A3.Ex10Xc.3.2.2.m1.6.6.1.4" xref="A3.Ex10Xc.3.2.2.m1.6.6.1.4.cmml"><mi id="A3.Ex10Xc.3.2.2.m1.6.6.1.4.2" xref="A3.Ex10Xc.3.2.2.m1.6.6.1.4.2.cmml">π</mi><mi id="A3.Ex10Xc.3.2.2.m1.6.6.1.4.3" xref="A3.Ex10Xc.3.2.2.m1.6.6.1.4.3.cmml">θ</mi></msub><mo id="A3.Ex10Xc.3.2.2.m1.6.6.1.2a" xref="A3.Ex10Xc.3.2.2.m1.6.6.1.2.cmml">⁢</mo><mrow id="A3.Ex10Xc.3.2.2.m1.6.6.1.1.1" xref="A3.Ex10Xc.3.2.2.m1.6.6.1.1.1.1.cmml"><mo id="A3.Ex10Xc.3.2.2.m1.6.6.1.1.1.2" stretchy="false" xref="A3.Ex10Xc.3.2.2.m1.6.6.1.1.1.1.cmml">(</mo><mrow id="A3.Ex10Xc.3.2.2.m1.6.6.1.1.1.1" xref="A3.Ex10Xc.3.2.2.m1.6.6.1.1.1.1.cmml"><mi id="A3.Ex10Xc.3.2.2.m1.6.6.1.1.1.1.2" xref="A3.Ex10Xc.3.2.2.m1.6.6.1.1.1.1.2.cmml">a</mi><mo fence="false" id="A3.Ex10Xc.3.2.2.m1.6.6.1.1.1.1.1" xref="A3.Ex10Xc.3.2.2.m1.6.6.1.1.1.1.1.cmml">|</mo><mi id="A3.Ex10Xc.3.2.2.m1.6.6.1.1.1.1.3" xref="A3.Ex10Xc.3.2.2.m1.6.6.1.1.1.1.3.cmml">s</mi></mrow><mo id="A3.Ex10Xc.3.2.2.m1.6.6.1.1.1.3" stretchy="false" xref="A3.Ex10Xc.3.2.2.m1.6.6.1.1.1.1.cmml">)</mo></mrow><mo id="A3.Ex10Xc.3.2.2.m1.6.6.1.2b" xref="A3.Ex10Xc.3.2.2.m1.6.6.1.2.cmml">⁢</mo><msup id="A3.Ex10Xc.3.2.2.m1.6.6.1.5" xref="A3.Ex10Xc.3.2.2.m1.6.6.1.5.cmml"><mi id="A3.Ex10Xc.3.2.2.m1.6.6.1.5.2" xref="A3.Ex10Xc.3.2.2.m1.6.6.1.5.2.cmml">Q</mi><mi id="A3.Ex10Xc.3.2.2.m1.6.6.1.5.3" xref="A3.Ex10Xc.3.2.2.m1.6.6.1.5.3.cmml">π</mi></msup><mo id="A3.Ex10Xc.3.2.2.m1.6.6.1.2c" xref="A3.Ex10Xc.3.2.2.m1.6.6.1.2.cmml">⁢</mo><mrow id="A3.Ex10Xc.3.2.2.m1.6.6.1.6.2" xref="A3.Ex10Xc.3.2.2.m1.6.6.1.6.1.cmml"><mo id="A3.Ex10Xc.3.2.2.m1.6.6.1.6.2.1" stretchy="false" xref="A3.Ex10Xc.3.2.2.m1.6.6.1.6.1.cmml">(</mo><mi id="A3.Ex10Xc.3.2.2.m1.4.4" xref="A3.Ex10Xc.3.2.2.m1.4.4.cmml">s</mi><mo id="A3.Ex10Xc.3.2.2.m1.6.6.1.6.2.2" xref="A3.Ex10Xc.3.2.2.m1.6.6.1.6.1.cmml">,</mo><mi id="A3.Ex10Xc.3.2.2.m1.5.5" xref="A3.Ex10Xc.3.2.2.m1.5.5.cmml">a</mi><mo id="A3.Ex10Xc.3.2.2.m1.6.6.1.6.2.3" stretchy="false" xref="A3.Ex10Xc.3.2.2.m1.6.6.1.6.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.Ex10Xc.3.2.2.m1.6b"><apply id="A3.Ex10Xc.3.2.2.m1.6.6.cmml" xref="A3.Ex10Xc.3.2.2.m1.6.6"><apply id="A3.Ex10Xc.3.2.2.m1.6.6.2.cmml" xref="A3.Ex10Xc.3.2.2.m1.6.6.2"><csymbol cd="ambiguous" id="A3.Ex10Xc.3.2.2.m1.6.6.2.1.cmml" xref="A3.Ex10Xc.3.2.2.m1.6.6.2">subscript</csymbol><sum id="A3.Ex10Xc.3.2.2.m1.6.6.2.2.cmml" xref="A3.Ex10Xc.3.2.2.m1.6.6.2.2"></sum><ci id="A3.Ex10Xc.3.2.2.m1.6.6.2.3.cmml" xref="A3.Ex10Xc.3.2.2.m1.6.6.2.3">𝑎</ci></apply><apply id="A3.Ex10Xc.3.2.2.m1.6.6.1.cmml" xref="A3.Ex10Xc.3.2.2.m1.6.6.1"><times id="A3.Ex10Xc.3.2.2.m1.6.6.1.2.cmml" xref="A3.Ex10Xc.3.2.2.m1.6.6.1.2"></times><apply id="A3.Ex10Xc.3.2.2.m1.6.6.1.3.cmml" xref="A3.Ex10Xc.3.2.2.m1.6.6.1.3"><csymbol cd="ambiguous" id="A3.Ex10Xc.3.2.2.m1.6.6.1.3.1.cmml" xref="A3.Ex10Xc.3.2.2.m1.6.6.1.3">subscript</csymbol><ci id="A3.Ex10Xc.3.2.2.m1.6.6.1.3.2.cmml" xref="A3.Ex10Xc.3.2.2.m1.6.6.1.3.2">𝐼</ci><set id="A3.Ex10Xc.3.2.2.m1.3.3.3.4.cmml" xref="A3.Ex10Xc.3.2.2.m1.3.3.3.3"><apply id="A3.Ex10Xc.3.2.2.m1.3.3.3.3.1.cmml" xref="A3.Ex10Xc.3.2.2.m1.3.3.3.3.1"><geq id="A3.Ex10Xc.3.2.2.m1.3.3.3.3.1.1.cmml" xref="A3.Ex10Xc.3.2.2.m1.3.3.3.3.1.1"></geq><apply id="A3.Ex10Xc.3.2.2.m1.3.3.3.3.1.2.cmml" xref="A3.Ex10Xc.3.2.2.m1.3.3.3.3.1.2"><times id="A3.Ex10Xc.3.2.2.m1.3.3.3.3.1.2.1.cmml" xref="A3.Ex10Xc.3.2.2.m1.3.3.3.3.1.2.1"></times><apply id="A3.Ex10Xc.3.2.2.m1.3.3.3.3.1.2.2.cmml" xref="A3.Ex10Xc.3.2.2.m1.3.3.3.3.1.2.2"><csymbol cd="ambiguous" id="A3.Ex10Xc.3.2.2.m1.3.3.3.3.1.2.2.1.cmml" xref="A3.Ex10Xc.3.2.2.m1.3.3.3.3.1.2.2">subscript</csymbol><ci id="A3.Ex10Xc.3.2.2.m1.3.3.3.3.1.2.2.2.cmml" xref="A3.Ex10Xc.3.2.2.m1.3.3.3.3.1.2.2.2">𝐶</ci><ci id="A3.Ex10Xc.3.2.2.m1.3.3.3.3.1.2.2.3.cmml" xref="A3.Ex10Xc.3.2.2.m1.3.3.3.3.1.2.2.3">𝜔</ci></apply><interval closure="open" id="A3.Ex10Xc.3.2.2.m1.3.3.3.3.1.2.3.1.cmml" xref="A3.Ex10Xc.3.2.2.m1.3.3.3.3.1.2.3.2"><ci id="A3.Ex10Xc.3.2.2.m1.1.1.1.1.cmml" xref="A3.Ex10Xc.3.2.2.m1.1.1.1.1">𝑠</ci><ci id="A3.Ex10Xc.3.2.2.m1.2.2.2.2.cmml" xref="A3.Ex10Xc.3.2.2.m1.2.2.2.2">𝑎</ci></interval></apply><ci id="A3.Ex10Xc.3.2.2.m1.3.3.3.3.1.3.cmml" xref="A3.Ex10Xc.3.2.2.m1.3.3.3.3.1.3">𝜅</ci></apply></set></apply><apply id="A3.Ex10Xc.3.2.2.m1.6.6.1.4.cmml" xref="A3.Ex10Xc.3.2.2.m1.6.6.1.4"><csymbol cd="ambiguous" id="A3.Ex10Xc.3.2.2.m1.6.6.1.4.1.cmml" xref="A3.Ex10Xc.3.2.2.m1.6.6.1.4">subscript</csymbol><ci id="A3.Ex10Xc.3.2.2.m1.6.6.1.4.2.cmml" xref="A3.Ex10Xc.3.2.2.m1.6.6.1.4.2">𝜋</ci><ci id="A3.Ex10Xc.3.2.2.m1.6.6.1.4.3.cmml" xref="A3.Ex10Xc.3.2.2.m1.6.6.1.4.3">𝜃</ci></apply><apply id="A3.Ex10Xc.3.2.2.m1.6.6.1.1.1.1.cmml" xref="A3.Ex10Xc.3.2.2.m1.6.6.1.1.1"><csymbol cd="latexml" id="A3.Ex10Xc.3.2.2.m1.6.6.1.1.1.1.1.cmml" xref="A3.Ex10Xc.3.2.2.m1.6.6.1.1.1.1.1">conditional</csymbol><ci id="A3.Ex10Xc.3.2.2.m1.6.6.1.1.1.1.2.cmml" xref="A3.Ex10Xc.3.2.2.m1.6.6.1.1.1.1.2">𝑎</ci><ci id="A3.Ex10Xc.3.2.2.m1.6.6.1.1.1.1.3.cmml" xref="A3.Ex10Xc.3.2.2.m1.6.6.1.1.1.1.3">𝑠</ci></apply><apply id="A3.Ex10Xc.3.2.2.m1.6.6.1.5.cmml" xref="A3.Ex10Xc.3.2.2.m1.6.6.1.5"><csymbol cd="ambiguous" id="A3.Ex10Xc.3.2.2.m1.6.6.1.5.1.cmml" xref="A3.Ex10Xc.3.2.2.m1.6.6.1.5">superscript</csymbol><ci id="A3.Ex10Xc.3.2.2.m1.6.6.1.5.2.cmml" xref="A3.Ex10Xc.3.2.2.m1.6.6.1.5.2">𝑄</ci><ci id="A3.Ex10Xc.3.2.2.m1.6.6.1.5.3.cmml" xref="A3.Ex10Xc.3.2.2.m1.6.6.1.5.3">𝜋</ci></apply><interval closure="open" id="A3.Ex10Xc.3.2.2.m1.6.6.1.6.1.cmml" xref="A3.Ex10Xc.3.2.2.m1.6.6.1.6.2"><ci id="A3.Ex10Xc.3.2.2.m1.4.4.cmml" xref="A3.Ex10Xc.3.2.2.m1.4.4">𝑠</ci><ci id="A3.Ex10Xc.3.2.2.m1.5.5.cmml" xref="A3.Ex10Xc.3.2.2.m1.5.5">𝑎</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex10Xc.3.2.2.m1.6c">\displaystyle\sum_{a}I_{\{C_{\omega}(s,a)\geq\kappa\}}\pi_{\theta}(a|s)Q^{\pi}%
(s,a)</annotation><annotation encoding="application/x-llamapun" id="A3.Ex10Xc.3.2.2.m1.6d">∑ start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT italic_I start_POSTSUBSCRIPT { italic_C start_POSTSUBSCRIPT italic_ω end_POSTSUBSCRIPT ( italic_s , italic_a ) ≥ italic_κ } end_POSTSUBSCRIPT italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a | italic_s ) italic_Q start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT ( italic_s , italic_a )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A3.SS2.1.p1.6">Therefore, we get</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A5.EGx3">
<tbody id="A3.Ex11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle V^{\pi}(s)" class="ltx_Math" display="inline" id="A3.Ex11.m1.1"><semantics id="A3.Ex11.m1.1a"><mrow id="A3.Ex11.m1.1.2" xref="A3.Ex11.m1.1.2.cmml"><msup id="A3.Ex11.m1.1.2.2" xref="A3.Ex11.m1.1.2.2.cmml"><mi id="A3.Ex11.m1.1.2.2.2" xref="A3.Ex11.m1.1.2.2.2.cmml">V</mi><mi id="A3.Ex11.m1.1.2.2.3" xref="A3.Ex11.m1.1.2.2.3.cmml">π</mi></msup><mo id="A3.Ex11.m1.1.2.1" xref="A3.Ex11.m1.1.2.1.cmml">⁢</mo><mrow id="A3.Ex11.m1.1.2.3.2" xref="A3.Ex11.m1.1.2.cmml"><mo id="A3.Ex11.m1.1.2.3.2.1" stretchy="false" xref="A3.Ex11.m1.1.2.cmml">(</mo><mi id="A3.Ex11.m1.1.1" xref="A3.Ex11.m1.1.1.cmml">s</mi><mo id="A3.Ex11.m1.1.2.3.2.2" stretchy="false" xref="A3.Ex11.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.Ex11.m1.1b"><apply id="A3.Ex11.m1.1.2.cmml" xref="A3.Ex11.m1.1.2"><times id="A3.Ex11.m1.1.2.1.cmml" xref="A3.Ex11.m1.1.2.1"></times><apply id="A3.Ex11.m1.1.2.2.cmml" xref="A3.Ex11.m1.1.2.2"><csymbol cd="ambiguous" id="A3.Ex11.m1.1.2.2.1.cmml" xref="A3.Ex11.m1.1.2.2">superscript</csymbol><ci id="A3.Ex11.m1.1.2.2.2.cmml" xref="A3.Ex11.m1.1.2.2.2">𝑉</ci><ci id="A3.Ex11.m1.1.2.2.3.cmml" xref="A3.Ex11.m1.1.2.2.3">𝜋</ci></apply><ci id="A3.Ex11.m1.1.1.cmml" xref="A3.Ex11.m1.1.1">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex11.m1.1c">\displaystyle V^{\pi}(s)</annotation><annotation encoding="application/x-llamapun" id="A3.Ex11.m1.1d">italic_V start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT ( italic_s )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sum_{a}\pi(a|s)Q^{\pi}(s,a)" class="ltx_Math" display="inline" id="A3.Ex11.m2.3"><semantics id="A3.Ex11.m2.3a"><mrow id="A3.Ex11.m2.3.3" xref="A3.Ex11.m2.3.3.cmml"><mi id="A3.Ex11.m2.3.3.3" xref="A3.Ex11.m2.3.3.3.cmml"></mi><mo id="A3.Ex11.m2.3.3.2" xref="A3.Ex11.m2.3.3.2.cmml">=</mo><mrow id="A3.Ex11.m2.3.3.1" xref="A3.Ex11.m2.3.3.1.cmml"><mstyle displaystyle="true" id="A3.Ex11.m2.3.3.1.2" xref="A3.Ex11.m2.3.3.1.2.cmml"><munder id="A3.Ex11.m2.3.3.1.2a" xref="A3.Ex11.m2.3.3.1.2.cmml"><mo id="A3.Ex11.m2.3.3.1.2.2" movablelimits="false" xref="A3.Ex11.m2.3.3.1.2.2.cmml">∑</mo><mi id="A3.Ex11.m2.3.3.1.2.3" xref="A3.Ex11.m2.3.3.1.2.3.cmml">a</mi></munder></mstyle><mrow id="A3.Ex11.m2.3.3.1.1" xref="A3.Ex11.m2.3.3.1.1.cmml"><mi id="A3.Ex11.m2.3.3.1.1.3" xref="A3.Ex11.m2.3.3.1.1.3.cmml">π</mi><mo id="A3.Ex11.m2.3.3.1.1.2" xref="A3.Ex11.m2.3.3.1.1.2.cmml">⁢</mo><mrow id="A3.Ex11.m2.3.3.1.1.1.1" xref="A3.Ex11.m2.3.3.1.1.1.1.1.cmml"><mo id="A3.Ex11.m2.3.3.1.1.1.1.2" stretchy="false" xref="A3.Ex11.m2.3.3.1.1.1.1.1.cmml">(</mo><mrow id="A3.Ex11.m2.3.3.1.1.1.1.1" xref="A3.Ex11.m2.3.3.1.1.1.1.1.cmml"><mi id="A3.Ex11.m2.3.3.1.1.1.1.1.2" xref="A3.Ex11.m2.3.3.1.1.1.1.1.2.cmml">a</mi><mo fence="false" id="A3.Ex11.m2.3.3.1.1.1.1.1.1" xref="A3.Ex11.m2.3.3.1.1.1.1.1.1.cmml">|</mo><mi id="A3.Ex11.m2.3.3.1.1.1.1.1.3" xref="A3.Ex11.m2.3.3.1.1.1.1.1.3.cmml">s</mi></mrow><mo id="A3.Ex11.m2.3.3.1.1.1.1.3" stretchy="false" xref="A3.Ex11.m2.3.3.1.1.1.1.1.cmml">)</mo></mrow><mo id="A3.Ex11.m2.3.3.1.1.2a" xref="A3.Ex11.m2.3.3.1.1.2.cmml">⁢</mo><msup id="A3.Ex11.m2.3.3.1.1.4" xref="A3.Ex11.m2.3.3.1.1.4.cmml"><mi id="A3.Ex11.m2.3.3.1.1.4.2" xref="A3.Ex11.m2.3.3.1.1.4.2.cmml">Q</mi><mi id="A3.Ex11.m2.3.3.1.1.4.3" xref="A3.Ex11.m2.3.3.1.1.4.3.cmml">π</mi></msup><mo id="A3.Ex11.m2.3.3.1.1.2b" xref="A3.Ex11.m2.3.3.1.1.2.cmml">⁢</mo><mrow id="A3.Ex11.m2.3.3.1.1.5.2" xref="A3.Ex11.m2.3.3.1.1.5.1.cmml"><mo id="A3.Ex11.m2.3.3.1.1.5.2.1" stretchy="false" xref="A3.Ex11.m2.3.3.1.1.5.1.cmml">(</mo><mi id="A3.Ex11.m2.1.1" xref="A3.Ex11.m2.1.1.cmml">s</mi><mo id="A3.Ex11.m2.3.3.1.1.5.2.2" xref="A3.Ex11.m2.3.3.1.1.5.1.cmml">,</mo><mi id="A3.Ex11.m2.2.2" xref="A3.Ex11.m2.2.2.cmml">a</mi><mo id="A3.Ex11.m2.3.3.1.1.5.2.3" stretchy="false" xref="A3.Ex11.m2.3.3.1.1.5.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.Ex11.m2.3b"><apply id="A3.Ex11.m2.3.3.cmml" xref="A3.Ex11.m2.3.3"><eq id="A3.Ex11.m2.3.3.2.cmml" xref="A3.Ex11.m2.3.3.2"></eq><csymbol cd="latexml" id="A3.Ex11.m2.3.3.3.cmml" xref="A3.Ex11.m2.3.3.3">absent</csymbol><apply id="A3.Ex11.m2.3.3.1.cmml" xref="A3.Ex11.m2.3.3.1"><apply id="A3.Ex11.m2.3.3.1.2.cmml" xref="A3.Ex11.m2.3.3.1.2"><csymbol cd="ambiguous" id="A3.Ex11.m2.3.3.1.2.1.cmml" xref="A3.Ex11.m2.3.3.1.2">subscript</csymbol><sum id="A3.Ex11.m2.3.3.1.2.2.cmml" xref="A3.Ex11.m2.3.3.1.2.2"></sum><ci id="A3.Ex11.m2.3.3.1.2.3.cmml" xref="A3.Ex11.m2.3.3.1.2.3">𝑎</ci></apply><apply id="A3.Ex11.m2.3.3.1.1.cmml" xref="A3.Ex11.m2.3.3.1.1"><times id="A3.Ex11.m2.3.3.1.1.2.cmml" xref="A3.Ex11.m2.3.3.1.1.2"></times><ci id="A3.Ex11.m2.3.3.1.1.3.cmml" xref="A3.Ex11.m2.3.3.1.1.3">𝜋</ci><apply id="A3.Ex11.m2.3.3.1.1.1.1.1.cmml" xref="A3.Ex11.m2.3.3.1.1.1.1"><csymbol cd="latexml" id="A3.Ex11.m2.3.3.1.1.1.1.1.1.cmml" xref="A3.Ex11.m2.3.3.1.1.1.1.1.1">conditional</csymbol><ci id="A3.Ex11.m2.3.3.1.1.1.1.1.2.cmml" xref="A3.Ex11.m2.3.3.1.1.1.1.1.2">𝑎</ci><ci id="A3.Ex11.m2.3.3.1.1.1.1.1.3.cmml" xref="A3.Ex11.m2.3.3.1.1.1.1.1.3">𝑠</ci></apply><apply id="A3.Ex11.m2.3.3.1.1.4.cmml" xref="A3.Ex11.m2.3.3.1.1.4"><csymbol cd="ambiguous" id="A3.Ex11.m2.3.3.1.1.4.1.cmml" xref="A3.Ex11.m2.3.3.1.1.4">superscript</csymbol><ci id="A3.Ex11.m2.3.3.1.1.4.2.cmml" xref="A3.Ex11.m2.3.3.1.1.4.2">𝑄</ci><ci id="A3.Ex11.m2.3.3.1.1.4.3.cmml" xref="A3.Ex11.m2.3.3.1.1.4.3">𝜋</ci></apply><interval closure="open" id="A3.Ex11.m2.3.3.1.1.5.1.cmml" xref="A3.Ex11.m2.3.3.1.1.5.2"><ci id="A3.Ex11.m2.1.1.cmml" xref="A3.Ex11.m2.1.1">𝑠</ci><ci id="A3.Ex11.m2.2.2.cmml" xref="A3.Ex11.m2.2.2">𝑎</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex11.m2.3c">\displaystyle=\sum_{a}\pi(a|s)Q^{\pi}(s,a)</annotation><annotation encoding="application/x-llamapun" id="A3.Ex11.m2.3d">= ∑ start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT italic_π ( italic_a | italic_s ) italic_Q start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT ( italic_s , italic_a )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A3.Ex12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sum_{a}\left(1-I_{\{C_{\omega}(s,a)\geq\kappa\}}\right)\pi(a|s)%
Q^{\pi}(s,a)+\sum_{a}I_{\{C_{\omega}(s,a)\geq\kappa\}}\pi(a|s)Q^{\pi}(s,a)" class="ltx_Math" display="inline" id="A3.Ex12.m1.13"><semantics id="A3.Ex12.m1.13a"><mrow id="A3.Ex12.m1.13.13" xref="A3.Ex12.m1.13.13.cmml"><mi id="A3.Ex12.m1.13.13.5" xref="A3.Ex12.m1.13.13.5.cmml"></mi><mo id="A3.Ex12.m1.13.13.4" xref="A3.Ex12.m1.13.13.4.cmml">=</mo><mrow id="A3.Ex12.m1.13.13.3" xref="A3.Ex12.m1.13.13.3.cmml"><mrow id="A3.Ex12.m1.12.12.2.2" xref="A3.Ex12.m1.12.12.2.2.cmml"><mstyle displaystyle="true" id="A3.Ex12.m1.12.12.2.2.3" xref="A3.Ex12.m1.12.12.2.2.3.cmml"><munder id="A3.Ex12.m1.12.12.2.2.3a" xref="A3.Ex12.m1.12.12.2.2.3.cmml"><mo id="A3.Ex12.m1.12.12.2.2.3.2" movablelimits="false" xref="A3.Ex12.m1.12.12.2.2.3.2.cmml">∑</mo><mi id="A3.Ex12.m1.12.12.2.2.3.3" xref="A3.Ex12.m1.12.12.2.2.3.3.cmml">a</mi></munder></mstyle><mrow id="A3.Ex12.m1.12.12.2.2.2" xref="A3.Ex12.m1.12.12.2.2.2.cmml"><mrow id="A3.Ex12.m1.11.11.1.1.1.1.1" xref="A3.Ex12.m1.11.11.1.1.1.1.1.1.cmml"><mo id="A3.Ex12.m1.11.11.1.1.1.1.1.2" xref="A3.Ex12.m1.11.11.1.1.1.1.1.1.cmml">(</mo><mrow id="A3.Ex12.m1.11.11.1.1.1.1.1.1" xref="A3.Ex12.m1.11.11.1.1.1.1.1.1.cmml"><mn id="A3.Ex12.m1.11.11.1.1.1.1.1.1.2" xref="A3.Ex12.m1.11.11.1.1.1.1.1.1.2.cmml">1</mn><mo id="A3.Ex12.m1.11.11.1.1.1.1.1.1.1" xref="A3.Ex12.m1.11.11.1.1.1.1.1.1.1.cmml">−</mo><msub id="A3.Ex12.m1.11.11.1.1.1.1.1.1.3" xref="A3.Ex12.m1.11.11.1.1.1.1.1.1.3.cmml"><mi id="A3.Ex12.m1.11.11.1.1.1.1.1.1.3.2" xref="A3.Ex12.m1.11.11.1.1.1.1.1.1.3.2.cmml">I</mi><mrow id="A3.Ex12.m1.3.3.3.3" xref="A3.Ex12.m1.3.3.3.4.cmml"><mo id="A3.Ex12.m1.3.3.3.3.2" stretchy="false" xref="A3.Ex12.m1.3.3.3.4.cmml">{</mo><mrow id="A3.Ex12.m1.3.3.3.3.1" xref="A3.Ex12.m1.3.3.3.3.1.cmml"><mrow id="A3.Ex12.m1.3.3.3.3.1.2" xref="A3.Ex12.m1.3.3.3.3.1.2.cmml"><msub id="A3.Ex12.m1.3.3.3.3.1.2.2" xref="A3.Ex12.m1.3.3.3.3.1.2.2.cmml"><mi id="A3.Ex12.m1.3.3.3.3.1.2.2.2" xref="A3.Ex12.m1.3.3.3.3.1.2.2.2.cmml">C</mi><mi id="A3.Ex12.m1.3.3.3.3.1.2.2.3" xref="A3.Ex12.m1.3.3.3.3.1.2.2.3.cmml">ω</mi></msub><mo id="A3.Ex12.m1.3.3.3.3.1.2.1" xref="A3.Ex12.m1.3.3.3.3.1.2.1.cmml">⁢</mo><mrow id="A3.Ex12.m1.3.3.3.3.1.2.3.2" xref="A3.Ex12.m1.3.3.3.3.1.2.3.1.cmml"><mo id="A3.Ex12.m1.3.3.3.3.1.2.3.2.1" stretchy="false" xref="A3.Ex12.m1.3.3.3.3.1.2.3.1.cmml">(</mo><mi id="A3.Ex12.m1.1.1.1.1" xref="A3.Ex12.m1.1.1.1.1.cmml">s</mi><mo id="A3.Ex12.m1.3.3.3.3.1.2.3.2.2" xref="A3.Ex12.m1.3.3.3.3.1.2.3.1.cmml">,</mo><mi id="A3.Ex12.m1.2.2.2.2" xref="A3.Ex12.m1.2.2.2.2.cmml">a</mi><mo id="A3.Ex12.m1.3.3.3.3.1.2.3.2.3" stretchy="false" xref="A3.Ex12.m1.3.3.3.3.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="A3.Ex12.m1.3.3.3.3.1.1" xref="A3.Ex12.m1.3.3.3.3.1.1.cmml">≥</mo><mi id="A3.Ex12.m1.3.3.3.3.1.3" xref="A3.Ex12.m1.3.3.3.3.1.3.cmml">κ</mi></mrow><mo id="A3.Ex12.m1.3.3.3.3.3" stretchy="false" xref="A3.Ex12.m1.3.3.3.4.cmml">}</mo></mrow></msub></mrow><mo id="A3.Ex12.m1.11.11.1.1.1.1.1.3" xref="A3.Ex12.m1.11.11.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A3.Ex12.m1.12.12.2.2.2.3" xref="A3.Ex12.m1.12.12.2.2.2.3.cmml">⁢</mo><mi id="A3.Ex12.m1.12.12.2.2.2.4" xref="A3.Ex12.m1.12.12.2.2.2.4.cmml">π</mi><mo id="A3.Ex12.m1.12.12.2.2.2.3a" xref="A3.Ex12.m1.12.12.2.2.2.3.cmml">⁢</mo><mrow id="A3.Ex12.m1.12.12.2.2.2.2.1" xref="A3.Ex12.m1.12.12.2.2.2.2.1.1.cmml"><mo id="A3.Ex12.m1.12.12.2.2.2.2.1.2" stretchy="false" xref="A3.Ex12.m1.12.12.2.2.2.2.1.1.cmml">(</mo><mrow id="A3.Ex12.m1.12.12.2.2.2.2.1.1" xref="A3.Ex12.m1.12.12.2.2.2.2.1.1.cmml"><mi id="A3.Ex12.m1.12.12.2.2.2.2.1.1.2" xref="A3.Ex12.m1.12.12.2.2.2.2.1.1.2.cmml">a</mi><mo fence="false" id="A3.Ex12.m1.12.12.2.2.2.2.1.1.1" xref="A3.Ex12.m1.12.12.2.2.2.2.1.1.1.cmml">|</mo><mi id="A3.Ex12.m1.12.12.2.2.2.2.1.1.3" xref="A3.Ex12.m1.12.12.2.2.2.2.1.1.3.cmml">s</mi></mrow><mo id="A3.Ex12.m1.12.12.2.2.2.2.1.3" stretchy="false" xref="A3.Ex12.m1.12.12.2.2.2.2.1.1.cmml">)</mo></mrow><mo id="A3.Ex12.m1.12.12.2.2.2.3b" xref="A3.Ex12.m1.12.12.2.2.2.3.cmml">⁢</mo><msup id="A3.Ex12.m1.12.12.2.2.2.5" xref="A3.Ex12.m1.12.12.2.2.2.5.cmml"><mi id="A3.Ex12.m1.12.12.2.2.2.5.2" xref="A3.Ex12.m1.12.12.2.2.2.5.2.cmml">Q</mi><mi id="A3.Ex12.m1.12.12.2.2.2.5.3" xref="A3.Ex12.m1.12.12.2.2.2.5.3.cmml">π</mi></msup><mo id="A3.Ex12.m1.12.12.2.2.2.3c" xref="A3.Ex12.m1.12.12.2.2.2.3.cmml">⁢</mo><mrow id="A3.Ex12.m1.12.12.2.2.2.6.2" xref="A3.Ex12.m1.12.12.2.2.2.6.1.cmml"><mo id="A3.Ex12.m1.12.12.2.2.2.6.2.1" stretchy="false" xref="A3.Ex12.m1.12.12.2.2.2.6.1.cmml">(</mo><mi id="A3.Ex12.m1.7.7" xref="A3.Ex12.m1.7.7.cmml">s</mi><mo id="A3.Ex12.m1.12.12.2.2.2.6.2.2" xref="A3.Ex12.m1.12.12.2.2.2.6.1.cmml">,</mo><mi id="A3.Ex12.m1.8.8" xref="A3.Ex12.m1.8.8.cmml">a</mi><mo id="A3.Ex12.m1.12.12.2.2.2.6.2.3" stretchy="false" xref="A3.Ex12.m1.12.12.2.2.2.6.1.cmml">)</mo></mrow></mrow></mrow><mo id="A3.Ex12.m1.13.13.3.4" xref="A3.Ex12.m1.13.13.3.4.cmml">+</mo><mrow id="A3.Ex12.m1.13.13.3.3" xref="A3.Ex12.m1.13.13.3.3.cmml"><mstyle displaystyle="true" id="A3.Ex12.m1.13.13.3.3.2" xref="A3.Ex12.m1.13.13.3.3.2.cmml"><munder id="A3.Ex12.m1.13.13.3.3.2a" xref="A3.Ex12.m1.13.13.3.3.2.cmml"><mo id="A3.Ex12.m1.13.13.3.3.2.2" movablelimits="false" xref="A3.Ex12.m1.13.13.3.3.2.2.cmml">∑</mo><mi id="A3.Ex12.m1.13.13.3.3.2.3" xref="A3.Ex12.m1.13.13.3.3.2.3.cmml">a</mi></munder></mstyle><mrow id="A3.Ex12.m1.13.13.3.3.1" xref="A3.Ex12.m1.13.13.3.3.1.cmml"><msub id="A3.Ex12.m1.13.13.3.3.1.3" xref="A3.Ex12.m1.13.13.3.3.1.3.cmml"><mi id="A3.Ex12.m1.13.13.3.3.1.3.2" xref="A3.Ex12.m1.13.13.3.3.1.3.2.cmml">I</mi><mrow id="A3.Ex12.m1.6.6.3.3" xref="A3.Ex12.m1.6.6.3.4.cmml"><mo id="A3.Ex12.m1.6.6.3.3.2" stretchy="false" xref="A3.Ex12.m1.6.6.3.4.cmml">{</mo><mrow id="A3.Ex12.m1.6.6.3.3.1" xref="A3.Ex12.m1.6.6.3.3.1.cmml"><mrow id="A3.Ex12.m1.6.6.3.3.1.2" xref="A3.Ex12.m1.6.6.3.3.1.2.cmml"><msub id="A3.Ex12.m1.6.6.3.3.1.2.2" xref="A3.Ex12.m1.6.6.3.3.1.2.2.cmml"><mi id="A3.Ex12.m1.6.6.3.3.1.2.2.2" xref="A3.Ex12.m1.6.6.3.3.1.2.2.2.cmml">C</mi><mi id="A3.Ex12.m1.6.6.3.3.1.2.2.3" xref="A3.Ex12.m1.6.6.3.3.1.2.2.3.cmml">ω</mi></msub><mo id="A3.Ex12.m1.6.6.3.3.1.2.1" xref="A3.Ex12.m1.6.6.3.3.1.2.1.cmml">⁢</mo><mrow id="A3.Ex12.m1.6.6.3.3.1.2.3.2" xref="A3.Ex12.m1.6.6.3.3.1.2.3.1.cmml"><mo id="A3.Ex12.m1.6.6.3.3.1.2.3.2.1" stretchy="false" xref="A3.Ex12.m1.6.6.3.3.1.2.3.1.cmml">(</mo><mi id="A3.Ex12.m1.4.4.1.1" xref="A3.Ex12.m1.4.4.1.1.cmml">s</mi><mo id="A3.Ex12.m1.6.6.3.3.1.2.3.2.2" xref="A3.Ex12.m1.6.6.3.3.1.2.3.1.cmml">,</mo><mi id="A3.Ex12.m1.5.5.2.2" xref="A3.Ex12.m1.5.5.2.2.cmml">a</mi><mo id="A3.Ex12.m1.6.6.3.3.1.2.3.2.3" stretchy="false" xref="A3.Ex12.m1.6.6.3.3.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="A3.Ex12.m1.6.6.3.3.1.1" xref="A3.Ex12.m1.6.6.3.3.1.1.cmml">≥</mo><mi id="A3.Ex12.m1.6.6.3.3.1.3" xref="A3.Ex12.m1.6.6.3.3.1.3.cmml">κ</mi></mrow><mo id="A3.Ex12.m1.6.6.3.3.3" stretchy="false" xref="A3.Ex12.m1.6.6.3.4.cmml">}</mo></mrow></msub><mo id="A3.Ex12.m1.13.13.3.3.1.2" xref="A3.Ex12.m1.13.13.3.3.1.2.cmml">⁢</mo><mi id="A3.Ex12.m1.13.13.3.3.1.4" xref="A3.Ex12.m1.13.13.3.3.1.4.cmml">π</mi><mo id="A3.Ex12.m1.13.13.3.3.1.2a" xref="A3.Ex12.m1.13.13.3.3.1.2.cmml">⁢</mo><mrow id="A3.Ex12.m1.13.13.3.3.1.1.1" xref="A3.Ex12.m1.13.13.3.3.1.1.1.1.cmml"><mo id="A3.Ex12.m1.13.13.3.3.1.1.1.2" stretchy="false" xref="A3.Ex12.m1.13.13.3.3.1.1.1.1.cmml">(</mo><mrow id="A3.Ex12.m1.13.13.3.3.1.1.1.1" xref="A3.Ex12.m1.13.13.3.3.1.1.1.1.cmml"><mi id="A3.Ex12.m1.13.13.3.3.1.1.1.1.2" xref="A3.Ex12.m1.13.13.3.3.1.1.1.1.2.cmml">a</mi><mo fence="false" id="A3.Ex12.m1.13.13.3.3.1.1.1.1.1" xref="A3.Ex12.m1.13.13.3.3.1.1.1.1.1.cmml">|</mo><mi id="A3.Ex12.m1.13.13.3.3.1.1.1.1.3" xref="A3.Ex12.m1.13.13.3.3.1.1.1.1.3.cmml">s</mi></mrow><mo id="A3.Ex12.m1.13.13.3.3.1.1.1.3" stretchy="false" xref="A3.Ex12.m1.13.13.3.3.1.1.1.1.cmml">)</mo></mrow><mo id="A3.Ex12.m1.13.13.3.3.1.2b" xref="A3.Ex12.m1.13.13.3.3.1.2.cmml">⁢</mo><msup id="A3.Ex12.m1.13.13.3.3.1.5" xref="A3.Ex12.m1.13.13.3.3.1.5.cmml"><mi id="A3.Ex12.m1.13.13.3.3.1.5.2" xref="A3.Ex12.m1.13.13.3.3.1.5.2.cmml">Q</mi><mi id="A3.Ex12.m1.13.13.3.3.1.5.3" xref="A3.Ex12.m1.13.13.3.3.1.5.3.cmml">π</mi></msup><mo id="A3.Ex12.m1.13.13.3.3.1.2c" xref="A3.Ex12.m1.13.13.3.3.1.2.cmml">⁢</mo><mrow id="A3.Ex12.m1.13.13.3.3.1.6.2" xref="A3.Ex12.m1.13.13.3.3.1.6.1.cmml"><mo id="A3.Ex12.m1.13.13.3.3.1.6.2.1" stretchy="false" xref="A3.Ex12.m1.13.13.3.3.1.6.1.cmml">(</mo><mi id="A3.Ex12.m1.9.9" xref="A3.Ex12.m1.9.9.cmml">s</mi><mo id="A3.Ex12.m1.13.13.3.3.1.6.2.2" xref="A3.Ex12.m1.13.13.3.3.1.6.1.cmml">,</mo><mi id="A3.Ex12.m1.10.10" xref="A3.Ex12.m1.10.10.cmml">a</mi><mo id="A3.Ex12.m1.13.13.3.3.1.6.2.3" stretchy="false" xref="A3.Ex12.m1.13.13.3.3.1.6.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.Ex12.m1.13b"><apply id="A3.Ex12.m1.13.13.cmml" xref="A3.Ex12.m1.13.13"><eq id="A3.Ex12.m1.13.13.4.cmml" xref="A3.Ex12.m1.13.13.4"></eq><csymbol cd="latexml" id="A3.Ex12.m1.13.13.5.cmml" xref="A3.Ex12.m1.13.13.5">absent</csymbol><apply id="A3.Ex12.m1.13.13.3.cmml" xref="A3.Ex12.m1.13.13.3"><plus id="A3.Ex12.m1.13.13.3.4.cmml" xref="A3.Ex12.m1.13.13.3.4"></plus><apply id="A3.Ex12.m1.12.12.2.2.cmml" xref="A3.Ex12.m1.12.12.2.2"><apply id="A3.Ex12.m1.12.12.2.2.3.cmml" xref="A3.Ex12.m1.12.12.2.2.3"><csymbol cd="ambiguous" id="A3.Ex12.m1.12.12.2.2.3.1.cmml" xref="A3.Ex12.m1.12.12.2.2.3">subscript</csymbol><sum id="A3.Ex12.m1.12.12.2.2.3.2.cmml" xref="A3.Ex12.m1.12.12.2.2.3.2"></sum><ci id="A3.Ex12.m1.12.12.2.2.3.3.cmml" xref="A3.Ex12.m1.12.12.2.2.3.3">𝑎</ci></apply><apply id="A3.Ex12.m1.12.12.2.2.2.cmml" xref="A3.Ex12.m1.12.12.2.2.2"><times id="A3.Ex12.m1.12.12.2.2.2.3.cmml" xref="A3.Ex12.m1.12.12.2.2.2.3"></times><apply id="A3.Ex12.m1.11.11.1.1.1.1.1.1.cmml" xref="A3.Ex12.m1.11.11.1.1.1.1.1"><minus id="A3.Ex12.m1.11.11.1.1.1.1.1.1.1.cmml" xref="A3.Ex12.m1.11.11.1.1.1.1.1.1.1"></minus><cn id="A3.Ex12.m1.11.11.1.1.1.1.1.1.2.cmml" type="integer" xref="A3.Ex12.m1.11.11.1.1.1.1.1.1.2">1</cn><apply id="A3.Ex12.m1.11.11.1.1.1.1.1.1.3.cmml" xref="A3.Ex12.m1.11.11.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.Ex12.m1.11.11.1.1.1.1.1.1.3.1.cmml" xref="A3.Ex12.m1.11.11.1.1.1.1.1.1.3">subscript</csymbol><ci id="A3.Ex12.m1.11.11.1.1.1.1.1.1.3.2.cmml" xref="A3.Ex12.m1.11.11.1.1.1.1.1.1.3.2">𝐼</ci><set id="A3.Ex12.m1.3.3.3.4.cmml" xref="A3.Ex12.m1.3.3.3.3"><apply id="A3.Ex12.m1.3.3.3.3.1.cmml" xref="A3.Ex12.m1.3.3.3.3.1"><geq id="A3.Ex12.m1.3.3.3.3.1.1.cmml" xref="A3.Ex12.m1.3.3.3.3.1.1"></geq><apply id="A3.Ex12.m1.3.3.3.3.1.2.cmml" xref="A3.Ex12.m1.3.3.3.3.1.2"><times id="A3.Ex12.m1.3.3.3.3.1.2.1.cmml" xref="A3.Ex12.m1.3.3.3.3.1.2.1"></times><apply id="A3.Ex12.m1.3.3.3.3.1.2.2.cmml" xref="A3.Ex12.m1.3.3.3.3.1.2.2"><csymbol cd="ambiguous" id="A3.Ex12.m1.3.3.3.3.1.2.2.1.cmml" xref="A3.Ex12.m1.3.3.3.3.1.2.2">subscript</csymbol><ci id="A3.Ex12.m1.3.3.3.3.1.2.2.2.cmml" xref="A3.Ex12.m1.3.3.3.3.1.2.2.2">𝐶</ci><ci id="A3.Ex12.m1.3.3.3.3.1.2.2.3.cmml" xref="A3.Ex12.m1.3.3.3.3.1.2.2.3">𝜔</ci></apply><interval closure="open" id="A3.Ex12.m1.3.3.3.3.1.2.3.1.cmml" xref="A3.Ex12.m1.3.3.3.3.1.2.3.2"><ci id="A3.Ex12.m1.1.1.1.1.cmml" xref="A3.Ex12.m1.1.1.1.1">𝑠</ci><ci id="A3.Ex12.m1.2.2.2.2.cmml" xref="A3.Ex12.m1.2.2.2.2">𝑎</ci></interval></apply><ci id="A3.Ex12.m1.3.3.3.3.1.3.cmml" xref="A3.Ex12.m1.3.3.3.3.1.3">𝜅</ci></apply></set></apply></apply><ci id="A3.Ex12.m1.12.12.2.2.2.4.cmml" xref="A3.Ex12.m1.12.12.2.2.2.4">𝜋</ci><apply id="A3.Ex12.m1.12.12.2.2.2.2.1.1.cmml" xref="A3.Ex12.m1.12.12.2.2.2.2.1"><csymbol cd="latexml" id="A3.Ex12.m1.12.12.2.2.2.2.1.1.1.cmml" xref="A3.Ex12.m1.12.12.2.2.2.2.1.1.1">conditional</csymbol><ci id="A3.Ex12.m1.12.12.2.2.2.2.1.1.2.cmml" xref="A3.Ex12.m1.12.12.2.2.2.2.1.1.2">𝑎</ci><ci id="A3.Ex12.m1.12.12.2.2.2.2.1.1.3.cmml" xref="A3.Ex12.m1.12.12.2.2.2.2.1.1.3">𝑠</ci></apply><apply id="A3.Ex12.m1.12.12.2.2.2.5.cmml" xref="A3.Ex12.m1.12.12.2.2.2.5"><csymbol cd="ambiguous" id="A3.Ex12.m1.12.12.2.2.2.5.1.cmml" xref="A3.Ex12.m1.12.12.2.2.2.5">superscript</csymbol><ci id="A3.Ex12.m1.12.12.2.2.2.5.2.cmml" xref="A3.Ex12.m1.12.12.2.2.2.5.2">𝑄</ci><ci id="A3.Ex12.m1.12.12.2.2.2.5.3.cmml" xref="A3.Ex12.m1.12.12.2.2.2.5.3">𝜋</ci></apply><interval closure="open" id="A3.Ex12.m1.12.12.2.2.2.6.1.cmml" xref="A3.Ex12.m1.12.12.2.2.2.6.2"><ci id="A3.Ex12.m1.7.7.cmml" xref="A3.Ex12.m1.7.7">𝑠</ci><ci id="A3.Ex12.m1.8.8.cmml" xref="A3.Ex12.m1.8.8">𝑎</ci></interval></apply></apply><apply id="A3.Ex12.m1.13.13.3.3.cmml" xref="A3.Ex12.m1.13.13.3.3"><apply id="A3.Ex12.m1.13.13.3.3.2.cmml" xref="A3.Ex12.m1.13.13.3.3.2"><csymbol cd="ambiguous" id="A3.Ex12.m1.13.13.3.3.2.1.cmml" xref="A3.Ex12.m1.13.13.3.3.2">subscript</csymbol><sum id="A3.Ex12.m1.13.13.3.3.2.2.cmml" xref="A3.Ex12.m1.13.13.3.3.2.2"></sum><ci id="A3.Ex12.m1.13.13.3.3.2.3.cmml" xref="A3.Ex12.m1.13.13.3.3.2.3">𝑎</ci></apply><apply id="A3.Ex12.m1.13.13.3.3.1.cmml" xref="A3.Ex12.m1.13.13.3.3.1"><times id="A3.Ex12.m1.13.13.3.3.1.2.cmml" xref="A3.Ex12.m1.13.13.3.3.1.2"></times><apply id="A3.Ex12.m1.13.13.3.3.1.3.cmml" xref="A3.Ex12.m1.13.13.3.3.1.3"><csymbol cd="ambiguous" id="A3.Ex12.m1.13.13.3.3.1.3.1.cmml" xref="A3.Ex12.m1.13.13.3.3.1.3">subscript</csymbol><ci id="A3.Ex12.m1.13.13.3.3.1.3.2.cmml" xref="A3.Ex12.m1.13.13.3.3.1.3.2">𝐼</ci><set id="A3.Ex12.m1.6.6.3.4.cmml" xref="A3.Ex12.m1.6.6.3.3"><apply id="A3.Ex12.m1.6.6.3.3.1.cmml" xref="A3.Ex12.m1.6.6.3.3.1"><geq id="A3.Ex12.m1.6.6.3.3.1.1.cmml" xref="A3.Ex12.m1.6.6.3.3.1.1"></geq><apply id="A3.Ex12.m1.6.6.3.3.1.2.cmml" xref="A3.Ex12.m1.6.6.3.3.1.2"><times id="A3.Ex12.m1.6.6.3.3.1.2.1.cmml" xref="A3.Ex12.m1.6.6.3.3.1.2.1"></times><apply id="A3.Ex12.m1.6.6.3.3.1.2.2.cmml" xref="A3.Ex12.m1.6.6.3.3.1.2.2"><csymbol cd="ambiguous" id="A3.Ex12.m1.6.6.3.3.1.2.2.1.cmml" xref="A3.Ex12.m1.6.6.3.3.1.2.2">subscript</csymbol><ci id="A3.Ex12.m1.6.6.3.3.1.2.2.2.cmml" xref="A3.Ex12.m1.6.6.3.3.1.2.2.2">𝐶</ci><ci id="A3.Ex12.m1.6.6.3.3.1.2.2.3.cmml" xref="A3.Ex12.m1.6.6.3.3.1.2.2.3">𝜔</ci></apply><interval closure="open" id="A3.Ex12.m1.6.6.3.3.1.2.3.1.cmml" xref="A3.Ex12.m1.6.6.3.3.1.2.3.2"><ci id="A3.Ex12.m1.4.4.1.1.cmml" xref="A3.Ex12.m1.4.4.1.1">𝑠</ci><ci id="A3.Ex12.m1.5.5.2.2.cmml" xref="A3.Ex12.m1.5.5.2.2">𝑎</ci></interval></apply><ci id="A3.Ex12.m1.6.6.3.3.1.3.cmml" xref="A3.Ex12.m1.6.6.3.3.1.3">𝜅</ci></apply></set></apply><ci id="A3.Ex12.m1.13.13.3.3.1.4.cmml" xref="A3.Ex12.m1.13.13.3.3.1.4">𝜋</ci><apply id="A3.Ex12.m1.13.13.3.3.1.1.1.1.cmml" xref="A3.Ex12.m1.13.13.3.3.1.1.1"><csymbol cd="latexml" id="A3.Ex12.m1.13.13.3.3.1.1.1.1.1.cmml" xref="A3.Ex12.m1.13.13.3.3.1.1.1.1.1">conditional</csymbol><ci id="A3.Ex12.m1.13.13.3.3.1.1.1.1.2.cmml" xref="A3.Ex12.m1.13.13.3.3.1.1.1.1.2">𝑎</ci><ci id="A3.Ex12.m1.13.13.3.3.1.1.1.1.3.cmml" xref="A3.Ex12.m1.13.13.3.3.1.1.1.1.3">𝑠</ci></apply><apply id="A3.Ex12.m1.13.13.3.3.1.5.cmml" xref="A3.Ex12.m1.13.13.3.3.1.5"><csymbol cd="ambiguous" id="A3.Ex12.m1.13.13.3.3.1.5.1.cmml" xref="A3.Ex12.m1.13.13.3.3.1.5">superscript</csymbol><ci id="A3.Ex12.m1.13.13.3.3.1.5.2.cmml" xref="A3.Ex12.m1.13.13.3.3.1.5.2">𝑄</ci><ci id="A3.Ex12.m1.13.13.3.3.1.5.3.cmml" xref="A3.Ex12.m1.13.13.3.3.1.5.3">𝜋</ci></apply><interval closure="open" id="A3.Ex12.m1.13.13.3.3.1.6.1.cmml" xref="A3.Ex12.m1.13.13.3.3.1.6.2"><ci id="A3.Ex12.m1.9.9.cmml" xref="A3.Ex12.m1.9.9">𝑠</ci><ci id="A3.Ex12.m1.10.10.cmml" xref="A3.Ex12.m1.10.10">𝑎</ci></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex12.m1.13c">\displaystyle=\sum_{a}\left(1-I_{\{C_{\omega}(s,a)\geq\kappa\}}\right)\pi(a|s)%
Q^{\pi}(s,a)+\sum_{a}I_{\{C_{\omega}(s,a)\geq\kappa\}}\pi(a|s)Q^{\pi}(s,a)</annotation><annotation encoding="application/x-llamapun" id="A3.Ex12.m1.13d">= ∑ start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ( 1 - italic_I start_POSTSUBSCRIPT { italic_C start_POSTSUBSCRIPT italic_ω end_POSTSUBSCRIPT ( italic_s , italic_a ) ≥ italic_κ } end_POSTSUBSCRIPT ) italic_π ( italic_a | italic_s ) italic_Q start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT ( italic_s , italic_a ) + ∑ start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT italic_I start_POSTSUBSCRIPT { italic_C start_POSTSUBSCRIPT italic_ω end_POSTSUBSCRIPT ( italic_s , italic_a ) ≥ italic_κ } end_POSTSUBSCRIPT italic_π ( italic_a | italic_s ) italic_Q start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT ( italic_s , italic_a )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A3.Ex13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\leq\sum_{a}\left(1-I_{\{C_{\omega}(s,a)\geq\kappa\}}\right)\pi(a%
|s)Q^{\pi}(s,a)+\sum_{a}I_{\{C_{\omega}(s,a)\geq\kappa\}}\pi^{*}(a|s)Q^{\pi}(s%
,a)" class="ltx_Math" display="inline" id="A3.Ex13.m1.13"><semantics id="A3.Ex13.m1.13a"><mrow id="A3.Ex13.m1.13.13" xref="A3.Ex13.m1.13.13.cmml"><mi id="A3.Ex13.m1.13.13.5" xref="A3.Ex13.m1.13.13.5.cmml"></mi><mo id="A3.Ex13.m1.13.13.4" xref="A3.Ex13.m1.13.13.4.cmml">≤</mo><mrow id="A3.Ex13.m1.13.13.3" xref="A3.Ex13.m1.13.13.3.cmml"><mrow id="A3.Ex13.m1.12.12.2.2" xref="A3.Ex13.m1.12.12.2.2.cmml"><mstyle displaystyle="true" id="A3.Ex13.m1.12.12.2.2.3" xref="A3.Ex13.m1.12.12.2.2.3.cmml"><munder id="A3.Ex13.m1.12.12.2.2.3a" xref="A3.Ex13.m1.12.12.2.2.3.cmml"><mo id="A3.Ex13.m1.12.12.2.2.3.2" movablelimits="false" xref="A3.Ex13.m1.12.12.2.2.3.2.cmml">∑</mo><mi id="A3.Ex13.m1.12.12.2.2.3.3" xref="A3.Ex13.m1.12.12.2.2.3.3.cmml">a</mi></munder></mstyle><mrow id="A3.Ex13.m1.12.12.2.2.2" xref="A3.Ex13.m1.12.12.2.2.2.cmml"><mrow id="A3.Ex13.m1.11.11.1.1.1.1.1" xref="A3.Ex13.m1.11.11.1.1.1.1.1.1.cmml"><mo id="A3.Ex13.m1.11.11.1.1.1.1.1.2" xref="A3.Ex13.m1.11.11.1.1.1.1.1.1.cmml">(</mo><mrow id="A3.Ex13.m1.11.11.1.1.1.1.1.1" xref="A3.Ex13.m1.11.11.1.1.1.1.1.1.cmml"><mn id="A3.Ex13.m1.11.11.1.1.1.1.1.1.2" xref="A3.Ex13.m1.11.11.1.1.1.1.1.1.2.cmml">1</mn><mo id="A3.Ex13.m1.11.11.1.1.1.1.1.1.1" xref="A3.Ex13.m1.11.11.1.1.1.1.1.1.1.cmml">−</mo><msub id="A3.Ex13.m1.11.11.1.1.1.1.1.1.3" xref="A3.Ex13.m1.11.11.1.1.1.1.1.1.3.cmml"><mi id="A3.Ex13.m1.11.11.1.1.1.1.1.1.3.2" xref="A3.Ex13.m1.11.11.1.1.1.1.1.1.3.2.cmml">I</mi><mrow id="A3.Ex13.m1.3.3.3.3" xref="A3.Ex13.m1.3.3.3.4.cmml"><mo id="A3.Ex13.m1.3.3.3.3.2" stretchy="false" xref="A3.Ex13.m1.3.3.3.4.cmml">{</mo><mrow id="A3.Ex13.m1.3.3.3.3.1" xref="A3.Ex13.m1.3.3.3.3.1.cmml"><mrow id="A3.Ex13.m1.3.3.3.3.1.2" xref="A3.Ex13.m1.3.3.3.3.1.2.cmml"><msub id="A3.Ex13.m1.3.3.3.3.1.2.2" xref="A3.Ex13.m1.3.3.3.3.1.2.2.cmml"><mi id="A3.Ex13.m1.3.3.3.3.1.2.2.2" xref="A3.Ex13.m1.3.3.3.3.1.2.2.2.cmml">C</mi><mi id="A3.Ex13.m1.3.3.3.3.1.2.2.3" xref="A3.Ex13.m1.3.3.3.3.1.2.2.3.cmml">ω</mi></msub><mo id="A3.Ex13.m1.3.3.3.3.1.2.1" xref="A3.Ex13.m1.3.3.3.3.1.2.1.cmml">⁢</mo><mrow id="A3.Ex13.m1.3.3.3.3.1.2.3.2" xref="A3.Ex13.m1.3.3.3.3.1.2.3.1.cmml"><mo id="A3.Ex13.m1.3.3.3.3.1.2.3.2.1" stretchy="false" xref="A3.Ex13.m1.3.3.3.3.1.2.3.1.cmml">(</mo><mi id="A3.Ex13.m1.1.1.1.1" xref="A3.Ex13.m1.1.1.1.1.cmml">s</mi><mo id="A3.Ex13.m1.3.3.3.3.1.2.3.2.2" xref="A3.Ex13.m1.3.3.3.3.1.2.3.1.cmml">,</mo><mi id="A3.Ex13.m1.2.2.2.2" xref="A3.Ex13.m1.2.2.2.2.cmml">a</mi><mo id="A3.Ex13.m1.3.3.3.3.1.2.3.2.3" stretchy="false" xref="A3.Ex13.m1.3.3.3.3.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="A3.Ex13.m1.3.3.3.3.1.1" xref="A3.Ex13.m1.3.3.3.3.1.1.cmml">≥</mo><mi id="A3.Ex13.m1.3.3.3.3.1.3" xref="A3.Ex13.m1.3.3.3.3.1.3.cmml">κ</mi></mrow><mo id="A3.Ex13.m1.3.3.3.3.3" stretchy="false" xref="A3.Ex13.m1.3.3.3.4.cmml">}</mo></mrow></msub></mrow><mo id="A3.Ex13.m1.11.11.1.1.1.1.1.3" xref="A3.Ex13.m1.11.11.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A3.Ex13.m1.12.12.2.2.2.3" xref="A3.Ex13.m1.12.12.2.2.2.3.cmml">⁢</mo><mi id="A3.Ex13.m1.12.12.2.2.2.4" xref="A3.Ex13.m1.12.12.2.2.2.4.cmml">π</mi><mo id="A3.Ex13.m1.12.12.2.2.2.3a" xref="A3.Ex13.m1.12.12.2.2.2.3.cmml">⁢</mo><mrow id="A3.Ex13.m1.12.12.2.2.2.2.1" xref="A3.Ex13.m1.12.12.2.2.2.2.1.1.cmml"><mo id="A3.Ex13.m1.12.12.2.2.2.2.1.2" stretchy="false" xref="A3.Ex13.m1.12.12.2.2.2.2.1.1.cmml">(</mo><mrow id="A3.Ex13.m1.12.12.2.2.2.2.1.1" xref="A3.Ex13.m1.12.12.2.2.2.2.1.1.cmml"><mi id="A3.Ex13.m1.12.12.2.2.2.2.1.1.2" xref="A3.Ex13.m1.12.12.2.2.2.2.1.1.2.cmml">a</mi><mo fence="false" id="A3.Ex13.m1.12.12.2.2.2.2.1.1.1" xref="A3.Ex13.m1.12.12.2.2.2.2.1.1.1.cmml">|</mo><mi id="A3.Ex13.m1.12.12.2.2.2.2.1.1.3" xref="A3.Ex13.m1.12.12.2.2.2.2.1.1.3.cmml">s</mi></mrow><mo id="A3.Ex13.m1.12.12.2.2.2.2.1.3" stretchy="false" xref="A3.Ex13.m1.12.12.2.2.2.2.1.1.cmml">)</mo></mrow><mo id="A3.Ex13.m1.12.12.2.2.2.3b" xref="A3.Ex13.m1.12.12.2.2.2.3.cmml">⁢</mo><msup id="A3.Ex13.m1.12.12.2.2.2.5" xref="A3.Ex13.m1.12.12.2.2.2.5.cmml"><mi id="A3.Ex13.m1.12.12.2.2.2.5.2" xref="A3.Ex13.m1.12.12.2.2.2.5.2.cmml">Q</mi><mi id="A3.Ex13.m1.12.12.2.2.2.5.3" xref="A3.Ex13.m1.12.12.2.2.2.5.3.cmml">π</mi></msup><mo id="A3.Ex13.m1.12.12.2.2.2.3c" xref="A3.Ex13.m1.12.12.2.2.2.3.cmml">⁢</mo><mrow id="A3.Ex13.m1.12.12.2.2.2.6.2" xref="A3.Ex13.m1.12.12.2.2.2.6.1.cmml"><mo id="A3.Ex13.m1.12.12.2.2.2.6.2.1" stretchy="false" xref="A3.Ex13.m1.12.12.2.2.2.6.1.cmml">(</mo><mi id="A3.Ex13.m1.7.7" xref="A3.Ex13.m1.7.7.cmml">s</mi><mo id="A3.Ex13.m1.12.12.2.2.2.6.2.2" xref="A3.Ex13.m1.12.12.2.2.2.6.1.cmml">,</mo><mi id="A3.Ex13.m1.8.8" xref="A3.Ex13.m1.8.8.cmml">a</mi><mo id="A3.Ex13.m1.12.12.2.2.2.6.2.3" stretchy="false" xref="A3.Ex13.m1.12.12.2.2.2.6.1.cmml">)</mo></mrow></mrow></mrow><mo id="A3.Ex13.m1.13.13.3.4" xref="A3.Ex13.m1.13.13.3.4.cmml">+</mo><mrow id="A3.Ex13.m1.13.13.3.3" xref="A3.Ex13.m1.13.13.3.3.cmml"><mstyle displaystyle="true" id="A3.Ex13.m1.13.13.3.3.2" xref="A3.Ex13.m1.13.13.3.3.2.cmml"><munder id="A3.Ex13.m1.13.13.3.3.2a" xref="A3.Ex13.m1.13.13.3.3.2.cmml"><mo id="A3.Ex13.m1.13.13.3.3.2.2" movablelimits="false" xref="A3.Ex13.m1.13.13.3.3.2.2.cmml">∑</mo><mi id="A3.Ex13.m1.13.13.3.3.2.3" xref="A3.Ex13.m1.13.13.3.3.2.3.cmml">a</mi></munder></mstyle><mrow id="A3.Ex13.m1.13.13.3.3.1" xref="A3.Ex13.m1.13.13.3.3.1.cmml"><msub id="A3.Ex13.m1.13.13.3.3.1.3" xref="A3.Ex13.m1.13.13.3.3.1.3.cmml"><mi id="A3.Ex13.m1.13.13.3.3.1.3.2" xref="A3.Ex13.m1.13.13.3.3.1.3.2.cmml">I</mi><mrow id="A3.Ex13.m1.6.6.3.3" xref="A3.Ex13.m1.6.6.3.4.cmml"><mo id="A3.Ex13.m1.6.6.3.3.2" stretchy="false" xref="A3.Ex13.m1.6.6.3.4.cmml">{</mo><mrow id="A3.Ex13.m1.6.6.3.3.1" xref="A3.Ex13.m1.6.6.3.3.1.cmml"><mrow id="A3.Ex13.m1.6.6.3.3.1.2" xref="A3.Ex13.m1.6.6.3.3.1.2.cmml"><msub id="A3.Ex13.m1.6.6.3.3.1.2.2" xref="A3.Ex13.m1.6.6.3.3.1.2.2.cmml"><mi id="A3.Ex13.m1.6.6.3.3.1.2.2.2" xref="A3.Ex13.m1.6.6.3.3.1.2.2.2.cmml">C</mi><mi id="A3.Ex13.m1.6.6.3.3.1.2.2.3" xref="A3.Ex13.m1.6.6.3.3.1.2.2.3.cmml">ω</mi></msub><mo id="A3.Ex13.m1.6.6.3.3.1.2.1" xref="A3.Ex13.m1.6.6.3.3.1.2.1.cmml">⁢</mo><mrow id="A3.Ex13.m1.6.6.3.3.1.2.3.2" xref="A3.Ex13.m1.6.6.3.3.1.2.3.1.cmml"><mo id="A3.Ex13.m1.6.6.3.3.1.2.3.2.1" stretchy="false" xref="A3.Ex13.m1.6.6.3.3.1.2.3.1.cmml">(</mo><mi id="A3.Ex13.m1.4.4.1.1" xref="A3.Ex13.m1.4.4.1.1.cmml">s</mi><mo id="A3.Ex13.m1.6.6.3.3.1.2.3.2.2" xref="A3.Ex13.m1.6.6.3.3.1.2.3.1.cmml">,</mo><mi id="A3.Ex13.m1.5.5.2.2" xref="A3.Ex13.m1.5.5.2.2.cmml">a</mi><mo id="A3.Ex13.m1.6.6.3.3.1.2.3.2.3" stretchy="false" xref="A3.Ex13.m1.6.6.3.3.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="A3.Ex13.m1.6.6.3.3.1.1" xref="A3.Ex13.m1.6.6.3.3.1.1.cmml">≥</mo><mi id="A3.Ex13.m1.6.6.3.3.1.3" xref="A3.Ex13.m1.6.6.3.3.1.3.cmml">κ</mi></mrow><mo id="A3.Ex13.m1.6.6.3.3.3" stretchy="false" xref="A3.Ex13.m1.6.6.3.4.cmml">}</mo></mrow></msub><mo id="A3.Ex13.m1.13.13.3.3.1.2" xref="A3.Ex13.m1.13.13.3.3.1.2.cmml">⁢</mo><msup id="A3.Ex13.m1.13.13.3.3.1.4" xref="A3.Ex13.m1.13.13.3.3.1.4.cmml"><mi id="A3.Ex13.m1.13.13.3.3.1.4.2" xref="A3.Ex13.m1.13.13.3.3.1.4.2.cmml">π</mi><mo id="A3.Ex13.m1.13.13.3.3.1.4.3" xref="A3.Ex13.m1.13.13.3.3.1.4.3.cmml">∗</mo></msup><mo id="A3.Ex13.m1.13.13.3.3.1.2a" xref="A3.Ex13.m1.13.13.3.3.1.2.cmml">⁢</mo><mrow id="A3.Ex13.m1.13.13.3.3.1.1.1" xref="A3.Ex13.m1.13.13.3.3.1.1.1.1.cmml"><mo id="A3.Ex13.m1.13.13.3.3.1.1.1.2" stretchy="false" xref="A3.Ex13.m1.13.13.3.3.1.1.1.1.cmml">(</mo><mrow id="A3.Ex13.m1.13.13.3.3.1.1.1.1" xref="A3.Ex13.m1.13.13.3.3.1.1.1.1.cmml"><mi id="A3.Ex13.m1.13.13.3.3.1.1.1.1.2" xref="A3.Ex13.m1.13.13.3.3.1.1.1.1.2.cmml">a</mi><mo fence="false" id="A3.Ex13.m1.13.13.3.3.1.1.1.1.1" xref="A3.Ex13.m1.13.13.3.3.1.1.1.1.1.cmml">|</mo><mi id="A3.Ex13.m1.13.13.3.3.1.1.1.1.3" xref="A3.Ex13.m1.13.13.3.3.1.1.1.1.3.cmml">s</mi></mrow><mo id="A3.Ex13.m1.13.13.3.3.1.1.1.3" stretchy="false" xref="A3.Ex13.m1.13.13.3.3.1.1.1.1.cmml">)</mo></mrow><mo id="A3.Ex13.m1.13.13.3.3.1.2b" xref="A3.Ex13.m1.13.13.3.3.1.2.cmml">⁢</mo><msup id="A3.Ex13.m1.13.13.3.3.1.5" xref="A3.Ex13.m1.13.13.3.3.1.5.cmml"><mi id="A3.Ex13.m1.13.13.3.3.1.5.2" xref="A3.Ex13.m1.13.13.3.3.1.5.2.cmml">Q</mi><mi id="A3.Ex13.m1.13.13.3.3.1.5.3" xref="A3.Ex13.m1.13.13.3.3.1.5.3.cmml">π</mi></msup><mo id="A3.Ex13.m1.13.13.3.3.1.2c" xref="A3.Ex13.m1.13.13.3.3.1.2.cmml">⁢</mo><mrow id="A3.Ex13.m1.13.13.3.3.1.6.2" xref="A3.Ex13.m1.13.13.3.3.1.6.1.cmml"><mo id="A3.Ex13.m1.13.13.3.3.1.6.2.1" stretchy="false" xref="A3.Ex13.m1.13.13.3.3.1.6.1.cmml">(</mo><mi id="A3.Ex13.m1.9.9" xref="A3.Ex13.m1.9.9.cmml">s</mi><mo id="A3.Ex13.m1.13.13.3.3.1.6.2.2" xref="A3.Ex13.m1.13.13.3.3.1.6.1.cmml">,</mo><mi id="A3.Ex13.m1.10.10" xref="A3.Ex13.m1.10.10.cmml">a</mi><mo id="A3.Ex13.m1.13.13.3.3.1.6.2.3" stretchy="false" xref="A3.Ex13.m1.13.13.3.3.1.6.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.Ex13.m1.13b"><apply id="A3.Ex13.m1.13.13.cmml" xref="A3.Ex13.m1.13.13"><leq id="A3.Ex13.m1.13.13.4.cmml" xref="A3.Ex13.m1.13.13.4"></leq><csymbol cd="latexml" id="A3.Ex13.m1.13.13.5.cmml" xref="A3.Ex13.m1.13.13.5">absent</csymbol><apply id="A3.Ex13.m1.13.13.3.cmml" xref="A3.Ex13.m1.13.13.3"><plus id="A3.Ex13.m1.13.13.3.4.cmml" xref="A3.Ex13.m1.13.13.3.4"></plus><apply id="A3.Ex13.m1.12.12.2.2.cmml" xref="A3.Ex13.m1.12.12.2.2"><apply id="A3.Ex13.m1.12.12.2.2.3.cmml" xref="A3.Ex13.m1.12.12.2.2.3"><csymbol cd="ambiguous" id="A3.Ex13.m1.12.12.2.2.3.1.cmml" xref="A3.Ex13.m1.12.12.2.2.3">subscript</csymbol><sum id="A3.Ex13.m1.12.12.2.2.3.2.cmml" xref="A3.Ex13.m1.12.12.2.2.3.2"></sum><ci id="A3.Ex13.m1.12.12.2.2.3.3.cmml" xref="A3.Ex13.m1.12.12.2.2.3.3">𝑎</ci></apply><apply id="A3.Ex13.m1.12.12.2.2.2.cmml" xref="A3.Ex13.m1.12.12.2.2.2"><times id="A3.Ex13.m1.12.12.2.2.2.3.cmml" xref="A3.Ex13.m1.12.12.2.2.2.3"></times><apply id="A3.Ex13.m1.11.11.1.1.1.1.1.1.cmml" xref="A3.Ex13.m1.11.11.1.1.1.1.1"><minus id="A3.Ex13.m1.11.11.1.1.1.1.1.1.1.cmml" xref="A3.Ex13.m1.11.11.1.1.1.1.1.1.1"></minus><cn id="A3.Ex13.m1.11.11.1.1.1.1.1.1.2.cmml" type="integer" xref="A3.Ex13.m1.11.11.1.1.1.1.1.1.2">1</cn><apply id="A3.Ex13.m1.11.11.1.1.1.1.1.1.3.cmml" xref="A3.Ex13.m1.11.11.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.Ex13.m1.11.11.1.1.1.1.1.1.3.1.cmml" xref="A3.Ex13.m1.11.11.1.1.1.1.1.1.3">subscript</csymbol><ci id="A3.Ex13.m1.11.11.1.1.1.1.1.1.3.2.cmml" xref="A3.Ex13.m1.11.11.1.1.1.1.1.1.3.2">𝐼</ci><set id="A3.Ex13.m1.3.3.3.4.cmml" xref="A3.Ex13.m1.3.3.3.3"><apply id="A3.Ex13.m1.3.3.3.3.1.cmml" xref="A3.Ex13.m1.3.3.3.3.1"><geq id="A3.Ex13.m1.3.3.3.3.1.1.cmml" xref="A3.Ex13.m1.3.3.3.3.1.1"></geq><apply id="A3.Ex13.m1.3.3.3.3.1.2.cmml" xref="A3.Ex13.m1.3.3.3.3.1.2"><times id="A3.Ex13.m1.3.3.3.3.1.2.1.cmml" xref="A3.Ex13.m1.3.3.3.3.1.2.1"></times><apply id="A3.Ex13.m1.3.3.3.3.1.2.2.cmml" xref="A3.Ex13.m1.3.3.3.3.1.2.2"><csymbol cd="ambiguous" id="A3.Ex13.m1.3.3.3.3.1.2.2.1.cmml" xref="A3.Ex13.m1.3.3.3.3.1.2.2">subscript</csymbol><ci id="A3.Ex13.m1.3.3.3.3.1.2.2.2.cmml" xref="A3.Ex13.m1.3.3.3.3.1.2.2.2">𝐶</ci><ci id="A3.Ex13.m1.3.3.3.3.1.2.2.3.cmml" xref="A3.Ex13.m1.3.3.3.3.1.2.2.3">𝜔</ci></apply><interval closure="open" id="A3.Ex13.m1.3.3.3.3.1.2.3.1.cmml" xref="A3.Ex13.m1.3.3.3.3.1.2.3.2"><ci id="A3.Ex13.m1.1.1.1.1.cmml" xref="A3.Ex13.m1.1.1.1.1">𝑠</ci><ci id="A3.Ex13.m1.2.2.2.2.cmml" xref="A3.Ex13.m1.2.2.2.2">𝑎</ci></interval></apply><ci id="A3.Ex13.m1.3.3.3.3.1.3.cmml" xref="A3.Ex13.m1.3.3.3.3.1.3">𝜅</ci></apply></set></apply></apply><ci id="A3.Ex13.m1.12.12.2.2.2.4.cmml" xref="A3.Ex13.m1.12.12.2.2.2.4">𝜋</ci><apply id="A3.Ex13.m1.12.12.2.2.2.2.1.1.cmml" xref="A3.Ex13.m1.12.12.2.2.2.2.1"><csymbol cd="latexml" id="A3.Ex13.m1.12.12.2.2.2.2.1.1.1.cmml" xref="A3.Ex13.m1.12.12.2.2.2.2.1.1.1">conditional</csymbol><ci id="A3.Ex13.m1.12.12.2.2.2.2.1.1.2.cmml" xref="A3.Ex13.m1.12.12.2.2.2.2.1.1.2">𝑎</ci><ci id="A3.Ex13.m1.12.12.2.2.2.2.1.1.3.cmml" xref="A3.Ex13.m1.12.12.2.2.2.2.1.1.3">𝑠</ci></apply><apply id="A3.Ex13.m1.12.12.2.2.2.5.cmml" xref="A3.Ex13.m1.12.12.2.2.2.5"><csymbol cd="ambiguous" id="A3.Ex13.m1.12.12.2.2.2.5.1.cmml" xref="A3.Ex13.m1.12.12.2.2.2.5">superscript</csymbol><ci id="A3.Ex13.m1.12.12.2.2.2.5.2.cmml" xref="A3.Ex13.m1.12.12.2.2.2.5.2">𝑄</ci><ci id="A3.Ex13.m1.12.12.2.2.2.5.3.cmml" xref="A3.Ex13.m1.12.12.2.2.2.5.3">𝜋</ci></apply><interval closure="open" id="A3.Ex13.m1.12.12.2.2.2.6.1.cmml" xref="A3.Ex13.m1.12.12.2.2.2.6.2"><ci id="A3.Ex13.m1.7.7.cmml" xref="A3.Ex13.m1.7.7">𝑠</ci><ci id="A3.Ex13.m1.8.8.cmml" xref="A3.Ex13.m1.8.8">𝑎</ci></interval></apply></apply><apply id="A3.Ex13.m1.13.13.3.3.cmml" xref="A3.Ex13.m1.13.13.3.3"><apply id="A3.Ex13.m1.13.13.3.3.2.cmml" xref="A3.Ex13.m1.13.13.3.3.2"><csymbol cd="ambiguous" id="A3.Ex13.m1.13.13.3.3.2.1.cmml" xref="A3.Ex13.m1.13.13.3.3.2">subscript</csymbol><sum id="A3.Ex13.m1.13.13.3.3.2.2.cmml" xref="A3.Ex13.m1.13.13.3.3.2.2"></sum><ci id="A3.Ex13.m1.13.13.3.3.2.3.cmml" xref="A3.Ex13.m1.13.13.3.3.2.3">𝑎</ci></apply><apply id="A3.Ex13.m1.13.13.3.3.1.cmml" xref="A3.Ex13.m1.13.13.3.3.1"><times id="A3.Ex13.m1.13.13.3.3.1.2.cmml" xref="A3.Ex13.m1.13.13.3.3.1.2"></times><apply id="A3.Ex13.m1.13.13.3.3.1.3.cmml" xref="A3.Ex13.m1.13.13.3.3.1.3"><csymbol cd="ambiguous" id="A3.Ex13.m1.13.13.3.3.1.3.1.cmml" xref="A3.Ex13.m1.13.13.3.3.1.3">subscript</csymbol><ci id="A3.Ex13.m1.13.13.3.3.1.3.2.cmml" xref="A3.Ex13.m1.13.13.3.3.1.3.2">𝐼</ci><set id="A3.Ex13.m1.6.6.3.4.cmml" xref="A3.Ex13.m1.6.6.3.3"><apply id="A3.Ex13.m1.6.6.3.3.1.cmml" xref="A3.Ex13.m1.6.6.3.3.1"><geq id="A3.Ex13.m1.6.6.3.3.1.1.cmml" xref="A3.Ex13.m1.6.6.3.3.1.1"></geq><apply id="A3.Ex13.m1.6.6.3.3.1.2.cmml" xref="A3.Ex13.m1.6.6.3.3.1.2"><times id="A3.Ex13.m1.6.6.3.3.1.2.1.cmml" xref="A3.Ex13.m1.6.6.3.3.1.2.1"></times><apply id="A3.Ex13.m1.6.6.3.3.1.2.2.cmml" xref="A3.Ex13.m1.6.6.3.3.1.2.2"><csymbol cd="ambiguous" id="A3.Ex13.m1.6.6.3.3.1.2.2.1.cmml" xref="A3.Ex13.m1.6.6.3.3.1.2.2">subscript</csymbol><ci id="A3.Ex13.m1.6.6.3.3.1.2.2.2.cmml" xref="A3.Ex13.m1.6.6.3.3.1.2.2.2">𝐶</ci><ci id="A3.Ex13.m1.6.6.3.3.1.2.2.3.cmml" xref="A3.Ex13.m1.6.6.3.3.1.2.2.3">𝜔</ci></apply><interval closure="open" id="A3.Ex13.m1.6.6.3.3.1.2.3.1.cmml" xref="A3.Ex13.m1.6.6.3.3.1.2.3.2"><ci id="A3.Ex13.m1.4.4.1.1.cmml" xref="A3.Ex13.m1.4.4.1.1">𝑠</ci><ci id="A3.Ex13.m1.5.5.2.2.cmml" xref="A3.Ex13.m1.5.5.2.2">𝑎</ci></interval></apply><ci id="A3.Ex13.m1.6.6.3.3.1.3.cmml" xref="A3.Ex13.m1.6.6.3.3.1.3">𝜅</ci></apply></set></apply><apply id="A3.Ex13.m1.13.13.3.3.1.4.cmml" xref="A3.Ex13.m1.13.13.3.3.1.4"><csymbol cd="ambiguous" id="A3.Ex13.m1.13.13.3.3.1.4.1.cmml" xref="A3.Ex13.m1.13.13.3.3.1.4">superscript</csymbol><ci id="A3.Ex13.m1.13.13.3.3.1.4.2.cmml" xref="A3.Ex13.m1.13.13.3.3.1.4.2">𝜋</ci><times id="A3.Ex13.m1.13.13.3.3.1.4.3.cmml" xref="A3.Ex13.m1.13.13.3.3.1.4.3"></times></apply><apply id="A3.Ex13.m1.13.13.3.3.1.1.1.1.cmml" xref="A3.Ex13.m1.13.13.3.3.1.1.1"><csymbol cd="latexml" id="A3.Ex13.m1.13.13.3.3.1.1.1.1.1.cmml" xref="A3.Ex13.m1.13.13.3.3.1.1.1.1.1">conditional</csymbol><ci id="A3.Ex13.m1.13.13.3.3.1.1.1.1.2.cmml" xref="A3.Ex13.m1.13.13.3.3.1.1.1.1.2">𝑎</ci><ci id="A3.Ex13.m1.13.13.3.3.1.1.1.1.3.cmml" xref="A3.Ex13.m1.13.13.3.3.1.1.1.1.3">𝑠</ci></apply><apply id="A3.Ex13.m1.13.13.3.3.1.5.cmml" xref="A3.Ex13.m1.13.13.3.3.1.5"><csymbol cd="ambiguous" id="A3.Ex13.m1.13.13.3.3.1.5.1.cmml" xref="A3.Ex13.m1.13.13.3.3.1.5">superscript</csymbol><ci id="A3.Ex13.m1.13.13.3.3.1.5.2.cmml" xref="A3.Ex13.m1.13.13.3.3.1.5.2">𝑄</ci><ci id="A3.Ex13.m1.13.13.3.3.1.5.3.cmml" xref="A3.Ex13.m1.13.13.3.3.1.5.3">𝜋</ci></apply><interval closure="open" id="A3.Ex13.m1.13.13.3.3.1.6.1.cmml" xref="A3.Ex13.m1.13.13.3.3.1.6.2"><ci id="A3.Ex13.m1.9.9.cmml" xref="A3.Ex13.m1.9.9">𝑠</ci><ci id="A3.Ex13.m1.10.10.cmml" xref="A3.Ex13.m1.10.10">𝑎</ci></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex13.m1.13c">\displaystyle\leq\sum_{a}\left(1-I_{\{C_{\omega}(s,a)\geq\kappa\}}\right)\pi(a%
|s)Q^{\pi}(s,a)+\sum_{a}I_{\{C_{\omega}(s,a)\geq\kappa\}}\pi^{*}(a|s)Q^{\pi}(s%
,a)</annotation><annotation encoding="application/x-llamapun" id="A3.Ex13.m1.13d">≤ ∑ start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ( 1 - italic_I start_POSTSUBSCRIPT { italic_C start_POSTSUBSCRIPT italic_ω end_POSTSUBSCRIPT ( italic_s , italic_a ) ≥ italic_κ } end_POSTSUBSCRIPT ) italic_π ( italic_a | italic_s ) italic_Q start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT ( italic_s , italic_a ) + ∑ start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT italic_I start_POSTSUBSCRIPT { italic_C start_POSTSUBSCRIPT italic_ω end_POSTSUBSCRIPT ( italic_s , italic_a ) ≥ italic_κ } end_POSTSUBSCRIPT italic_π start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_a | italic_s ) italic_Q start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT ( italic_s , italic_a )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A3.Ex14"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sum_{a}\pi_{\text{new}}(a|s)Q^{\pi}(s)" class="ltx_Math" display="inline" id="A3.Ex14.m1.2"><semantics id="A3.Ex14.m1.2a"><mrow id="A3.Ex14.m1.2.2" xref="A3.Ex14.m1.2.2.cmml"><mi id="A3.Ex14.m1.2.2.3" xref="A3.Ex14.m1.2.2.3.cmml"></mi><mo id="A3.Ex14.m1.2.2.2" xref="A3.Ex14.m1.2.2.2.cmml">=</mo><mrow id="A3.Ex14.m1.2.2.1" xref="A3.Ex14.m1.2.2.1.cmml"><mstyle displaystyle="true" id="A3.Ex14.m1.2.2.1.2" xref="A3.Ex14.m1.2.2.1.2.cmml"><munder id="A3.Ex14.m1.2.2.1.2a" xref="A3.Ex14.m1.2.2.1.2.cmml"><mo id="A3.Ex14.m1.2.2.1.2.2" movablelimits="false" xref="A3.Ex14.m1.2.2.1.2.2.cmml">∑</mo><mi id="A3.Ex14.m1.2.2.1.2.3" xref="A3.Ex14.m1.2.2.1.2.3.cmml">a</mi></munder></mstyle><mrow id="A3.Ex14.m1.2.2.1.1" xref="A3.Ex14.m1.2.2.1.1.cmml"><msub id="A3.Ex14.m1.2.2.1.1.3" xref="A3.Ex14.m1.2.2.1.1.3.cmml"><mi id="A3.Ex14.m1.2.2.1.1.3.2" xref="A3.Ex14.m1.2.2.1.1.3.2.cmml">π</mi><mtext id="A3.Ex14.m1.2.2.1.1.3.3" xref="A3.Ex14.m1.2.2.1.1.3.3a.cmml">new</mtext></msub><mo id="A3.Ex14.m1.2.2.1.1.2" xref="A3.Ex14.m1.2.2.1.1.2.cmml">⁢</mo><mrow id="A3.Ex14.m1.2.2.1.1.1.1" xref="A3.Ex14.m1.2.2.1.1.1.1.1.cmml"><mo id="A3.Ex14.m1.2.2.1.1.1.1.2" stretchy="false" xref="A3.Ex14.m1.2.2.1.1.1.1.1.cmml">(</mo><mrow id="A3.Ex14.m1.2.2.1.1.1.1.1" xref="A3.Ex14.m1.2.2.1.1.1.1.1.cmml"><mi id="A3.Ex14.m1.2.2.1.1.1.1.1.2" xref="A3.Ex14.m1.2.2.1.1.1.1.1.2.cmml">a</mi><mo fence="false" id="A3.Ex14.m1.2.2.1.1.1.1.1.1" xref="A3.Ex14.m1.2.2.1.1.1.1.1.1.cmml">|</mo><mi id="A3.Ex14.m1.2.2.1.1.1.1.1.3" xref="A3.Ex14.m1.2.2.1.1.1.1.1.3.cmml">s</mi></mrow><mo id="A3.Ex14.m1.2.2.1.1.1.1.3" stretchy="false" xref="A3.Ex14.m1.2.2.1.1.1.1.1.cmml">)</mo></mrow><mo id="A3.Ex14.m1.2.2.1.1.2a" xref="A3.Ex14.m1.2.2.1.1.2.cmml">⁢</mo><msup id="A3.Ex14.m1.2.2.1.1.4" xref="A3.Ex14.m1.2.2.1.1.4.cmml"><mi id="A3.Ex14.m1.2.2.1.1.4.2" xref="A3.Ex14.m1.2.2.1.1.4.2.cmml">Q</mi><mi id="A3.Ex14.m1.2.2.1.1.4.3" xref="A3.Ex14.m1.2.2.1.1.4.3.cmml">π</mi></msup><mo id="A3.Ex14.m1.2.2.1.1.2b" xref="A3.Ex14.m1.2.2.1.1.2.cmml">⁢</mo><mrow id="A3.Ex14.m1.2.2.1.1.5.2" xref="A3.Ex14.m1.2.2.1.1.cmml"><mo id="A3.Ex14.m1.2.2.1.1.5.2.1" stretchy="false" xref="A3.Ex14.m1.2.2.1.1.cmml">(</mo><mi id="A3.Ex14.m1.1.1" xref="A3.Ex14.m1.1.1.cmml">s</mi><mo id="A3.Ex14.m1.2.2.1.1.5.2.2" stretchy="false" xref="A3.Ex14.m1.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.Ex14.m1.2b"><apply id="A3.Ex14.m1.2.2.cmml" xref="A3.Ex14.m1.2.2"><eq id="A3.Ex14.m1.2.2.2.cmml" xref="A3.Ex14.m1.2.2.2"></eq><csymbol cd="latexml" id="A3.Ex14.m1.2.2.3.cmml" xref="A3.Ex14.m1.2.2.3">absent</csymbol><apply id="A3.Ex14.m1.2.2.1.cmml" xref="A3.Ex14.m1.2.2.1"><apply id="A3.Ex14.m1.2.2.1.2.cmml" xref="A3.Ex14.m1.2.2.1.2"><csymbol cd="ambiguous" id="A3.Ex14.m1.2.2.1.2.1.cmml" xref="A3.Ex14.m1.2.2.1.2">subscript</csymbol><sum id="A3.Ex14.m1.2.2.1.2.2.cmml" xref="A3.Ex14.m1.2.2.1.2.2"></sum><ci id="A3.Ex14.m1.2.2.1.2.3.cmml" xref="A3.Ex14.m1.2.2.1.2.3">𝑎</ci></apply><apply id="A3.Ex14.m1.2.2.1.1.cmml" xref="A3.Ex14.m1.2.2.1.1"><times id="A3.Ex14.m1.2.2.1.1.2.cmml" xref="A3.Ex14.m1.2.2.1.1.2"></times><apply id="A3.Ex14.m1.2.2.1.1.3.cmml" xref="A3.Ex14.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="A3.Ex14.m1.2.2.1.1.3.1.cmml" xref="A3.Ex14.m1.2.2.1.1.3">subscript</csymbol><ci id="A3.Ex14.m1.2.2.1.1.3.2.cmml" xref="A3.Ex14.m1.2.2.1.1.3.2">𝜋</ci><ci id="A3.Ex14.m1.2.2.1.1.3.3a.cmml" xref="A3.Ex14.m1.2.2.1.1.3.3"><mtext id="A3.Ex14.m1.2.2.1.1.3.3.cmml" mathsize="70%" xref="A3.Ex14.m1.2.2.1.1.3.3">new</mtext></ci></apply><apply id="A3.Ex14.m1.2.2.1.1.1.1.1.cmml" xref="A3.Ex14.m1.2.2.1.1.1.1"><csymbol cd="latexml" id="A3.Ex14.m1.2.2.1.1.1.1.1.1.cmml" xref="A3.Ex14.m1.2.2.1.1.1.1.1.1">conditional</csymbol><ci id="A3.Ex14.m1.2.2.1.1.1.1.1.2.cmml" xref="A3.Ex14.m1.2.2.1.1.1.1.1.2">𝑎</ci><ci id="A3.Ex14.m1.2.2.1.1.1.1.1.3.cmml" xref="A3.Ex14.m1.2.2.1.1.1.1.1.3">𝑠</ci></apply><apply id="A3.Ex14.m1.2.2.1.1.4.cmml" xref="A3.Ex14.m1.2.2.1.1.4"><csymbol cd="ambiguous" id="A3.Ex14.m1.2.2.1.1.4.1.cmml" xref="A3.Ex14.m1.2.2.1.1.4">superscript</csymbol><ci id="A3.Ex14.m1.2.2.1.1.4.2.cmml" xref="A3.Ex14.m1.2.2.1.1.4.2">𝑄</ci><ci id="A3.Ex14.m1.2.2.1.1.4.3.cmml" xref="A3.Ex14.m1.2.2.1.1.4.3">𝜋</ci></apply><ci id="A3.Ex14.m1.1.1.cmml" xref="A3.Ex14.m1.1.1">𝑠</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex14.m1.2c">\displaystyle=\sum_{a}\pi_{\text{new}}(a|s)Q^{\pi}(s)</annotation><annotation encoding="application/x-llamapun" id="A3.Ex14.m1.2d">= ∑ start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT italic_π start_POSTSUBSCRIPT new end_POSTSUBSCRIPT ( italic_a | italic_s ) italic_Q start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT ( italic_s )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A3.Ex15"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=E_{\pi_{\text{new}}}\{Q^{\pi}(s,a)|s_{t}=s\}" class="ltx_Math" display="inline" id="A3.Ex15.m1.4"><semantics id="A3.Ex15.m1.4a"><mrow id="A3.Ex15.m1.4.4" xref="A3.Ex15.m1.4.4.cmml"><mi id="A3.Ex15.m1.4.4.4" xref="A3.Ex15.m1.4.4.4.cmml"></mi><mo id="A3.Ex15.m1.4.4.3" xref="A3.Ex15.m1.4.4.3.cmml">=</mo><mrow id="A3.Ex15.m1.4.4.2" xref="A3.Ex15.m1.4.4.2.cmml"><msub id="A3.Ex15.m1.4.4.2.4" xref="A3.Ex15.m1.4.4.2.4.cmml"><mi id="A3.Ex15.m1.4.4.2.4.2" xref="A3.Ex15.m1.4.4.2.4.2.cmml">E</mi><msub id="A3.Ex15.m1.4.4.2.4.3" xref="A3.Ex15.m1.4.4.2.4.3.cmml"><mi id="A3.Ex15.m1.4.4.2.4.3.2" xref="A3.Ex15.m1.4.4.2.4.3.2.cmml">π</mi><mtext id="A3.Ex15.m1.4.4.2.4.3.3" xref="A3.Ex15.m1.4.4.2.4.3.3a.cmml">new</mtext></msub></msub><mo id="A3.Ex15.m1.4.4.2.3" xref="A3.Ex15.m1.4.4.2.3.cmml">⁢</mo><mrow id="A3.Ex15.m1.4.4.2.2.2" xref="A3.Ex15.m1.4.4.2.2.3.cmml"><mo id="A3.Ex15.m1.4.4.2.2.2.3" stretchy="false" xref="A3.Ex15.m1.4.4.2.2.3.1.cmml">{</mo><mrow id="A3.Ex15.m1.3.3.1.1.1.1" xref="A3.Ex15.m1.3.3.1.1.1.1.cmml"><msup id="A3.Ex15.m1.3.3.1.1.1.1.2" xref="A3.Ex15.m1.3.3.1.1.1.1.2.cmml"><mi id="A3.Ex15.m1.3.3.1.1.1.1.2.2" xref="A3.Ex15.m1.3.3.1.1.1.1.2.2.cmml">Q</mi><mi id="A3.Ex15.m1.3.3.1.1.1.1.2.3" xref="A3.Ex15.m1.3.3.1.1.1.1.2.3.cmml">π</mi></msup><mo id="A3.Ex15.m1.3.3.1.1.1.1.1" xref="A3.Ex15.m1.3.3.1.1.1.1.1.cmml">⁢</mo><mrow id="A3.Ex15.m1.3.3.1.1.1.1.3.2" xref="A3.Ex15.m1.3.3.1.1.1.1.3.1.cmml"><mo id="A3.Ex15.m1.3.3.1.1.1.1.3.2.1" stretchy="false" xref="A3.Ex15.m1.3.3.1.1.1.1.3.1.cmml">(</mo><mi id="A3.Ex15.m1.1.1" xref="A3.Ex15.m1.1.1.cmml">s</mi><mo id="A3.Ex15.m1.3.3.1.1.1.1.3.2.2" xref="A3.Ex15.m1.3.3.1.1.1.1.3.1.cmml">,</mo><mi id="A3.Ex15.m1.2.2" xref="A3.Ex15.m1.2.2.cmml">a</mi><mo id="A3.Ex15.m1.3.3.1.1.1.1.3.2.3" stretchy="false" xref="A3.Ex15.m1.3.3.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="A3.Ex15.m1.4.4.2.2.2.4" lspace="0em" rspace="0em" xref="A3.Ex15.m1.4.4.2.2.3.1.cmml">|</mo><mrow id="A3.Ex15.m1.4.4.2.2.2.2" xref="A3.Ex15.m1.4.4.2.2.2.2.cmml"><msub id="A3.Ex15.m1.4.4.2.2.2.2.2" xref="A3.Ex15.m1.4.4.2.2.2.2.2.cmml"><mi id="A3.Ex15.m1.4.4.2.2.2.2.2.2" xref="A3.Ex15.m1.4.4.2.2.2.2.2.2.cmml">s</mi><mi id="A3.Ex15.m1.4.4.2.2.2.2.2.3" xref="A3.Ex15.m1.4.4.2.2.2.2.2.3.cmml">t</mi></msub><mo id="A3.Ex15.m1.4.4.2.2.2.2.1" xref="A3.Ex15.m1.4.4.2.2.2.2.1.cmml">=</mo><mi id="A3.Ex15.m1.4.4.2.2.2.2.3" xref="A3.Ex15.m1.4.4.2.2.2.2.3.cmml">s</mi></mrow><mo id="A3.Ex15.m1.4.4.2.2.2.5" stretchy="false" xref="A3.Ex15.m1.4.4.2.2.3.1.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.Ex15.m1.4b"><apply id="A3.Ex15.m1.4.4.cmml" xref="A3.Ex15.m1.4.4"><eq id="A3.Ex15.m1.4.4.3.cmml" xref="A3.Ex15.m1.4.4.3"></eq><csymbol cd="latexml" id="A3.Ex15.m1.4.4.4.cmml" xref="A3.Ex15.m1.4.4.4">absent</csymbol><apply id="A3.Ex15.m1.4.4.2.cmml" xref="A3.Ex15.m1.4.4.2"><times id="A3.Ex15.m1.4.4.2.3.cmml" xref="A3.Ex15.m1.4.4.2.3"></times><apply id="A3.Ex15.m1.4.4.2.4.cmml" xref="A3.Ex15.m1.4.4.2.4"><csymbol cd="ambiguous" id="A3.Ex15.m1.4.4.2.4.1.cmml" xref="A3.Ex15.m1.4.4.2.4">subscript</csymbol><ci id="A3.Ex15.m1.4.4.2.4.2.cmml" xref="A3.Ex15.m1.4.4.2.4.2">𝐸</ci><apply id="A3.Ex15.m1.4.4.2.4.3.cmml" xref="A3.Ex15.m1.4.4.2.4.3"><csymbol cd="ambiguous" id="A3.Ex15.m1.4.4.2.4.3.1.cmml" xref="A3.Ex15.m1.4.4.2.4.3">subscript</csymbol><ci id="A3.Ex15.m1.4.4.2.4.3.2.cmml" xref="A3.Ex15.m1.4.4.2.4.3.2">𝜋</ci><ci id="A3.Ex15.m1.4.4.2.4.3.3a.cmml" xref="A3.Ex15.m1.4.4.2.4.3.3"><mtext id="A3.Ex15.m1.4.4.2.4.3.3.cmml" mathsize="50%" xref="A3.Ex15.m1.4.4.2.4.3.3">new</mtext></ci></apply></apply><apply id="A3.Ex15.m1.4.4.2.2.3.cmml" xref="A3.Ex15.m1.4.4.2.2.2"><csymbol cd="latexml" id="A3.Ex15.m1.4.4.2.2.3.1.cmml" xref="A3.Ex15.m1.4.4.2.2.2.3">conditional-set</csymbol><apply id="A3.Ex15.m1.3.3.1.1.1.1.cmml" xref="A3.Ex15.m1.3.3.1.1.1.1"><times id="A3.Ex15.m1.3.3.1.1.1.1.1.cmml" xref="A3.Ex15.m1.3.3.1.1.1.1.1"></times><apply id="A3.Ex15.m1.3.3.1.1.1.1.2.cmml" xref="A3.Ex15.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.Ex15.m1.3.3.1.1.1.1.2.1.cmml" xref="A3.Ex15.m1.3.3.1.1.1.1.2">superscript</csymbol><ci id="A3.Ex15.m1.3.3.1.1.1.1.2.2.cmml" xref="A3.Ex15.m1.3.3.1.1.1.1.2.2">𝑄</ci><ci id="A3.Ex15.m1.3.3.1.1.1.1.2.3.cmml" xref="A3.Ex15.m1.3.3.1.1.1.1.2.3">𝜋</ci></apply><interval closure="open" id="A3.Ex15.m1.3.3.1.1.1.1.3.1.cmml" xref="A3.Ex15.m1.3.3.1.1.1.1.3.2"><ci id="A3.Ex15.m1.1.1.cmml" xref="A3.Ex15.m1.1.1">𝑠</ci><ci id="A3.Ex15.m1.2.2.cmml" xref="A3.Ex15.m1.2.2">𝑎</ci></interval></apply><apply id="A3.Ex15.m1.4.4.2.2.2.2.cmml" xref="A3.Ex15.m1.4.4.2.2.2.2"><eq id="A3.Ex15.m1.4.4.2.2.2.2.1.cmml" xref="A3.Ex15.m1.4.4.2.2.2.2.1"></eq><apply id="A3.Ex15.m1.4.4.2.2.2.2.2.cmml" xref="A3.Ex15.m1.4.4.2.2.2.2.2"><csymbol cd="ambiguous" id="A3.Ex15.m1.4.4.2.2.2.2.2.1.cmml" xref="A3.Ex15.m1.4.4.2.2.2.2.2">subscript</csymbol><ci id="A3.Ex15.m1.4.4.2.2.2.2.2.2.cmml" xref="A3.Ex15.m1.4.4.2.2.2.2.2.2">𝑠</ci><ci id="A3.Ex15.m1.4.4.2.2.2.2.2.3.cmml" xref="A3.Ex15.m1.4.4.2.2.2.2.2.3">𝑡</ci></apply><ci id="A3.Ex15.m1.4.4.2.2.2.2.3.cmml" xref="A3.Ex15.m1.4.4.2.2.2.2.3">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex15.m1.4c">\displaystyle=E_{\pi_{\text{new}}}\{Q^{\pi}(s,a)|s_{t}=s\}</annotation><annotation encoding="application/x-llamapun" id="A3.Ex15.m1.4d">= italic_E start_POSTSUBSCRIPT italic_π start_POSTSUBSCRIPT new end_POSTSUBSCRIPT end_POSTSUBSCRIPT { italic_Q start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT ( italic_s , italic_a ) | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_s }</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A3.Ex16"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=E_{\pi_{\text{new}}}\{r_{t}+\gamma V^{\pi}(s_{t+1})|s_{t}=s\}" class="ltx_Math" display="inline" id="A3.Ex16.m1.2"><semantics id="A3.Ex16.m1.2a"><mrow id="A3.Ex16.m1.2.2" xref="A3.Ex16.m1.2.2.cmml"><mi id="A3.Ex16.m1.2.2.4" xref="A3.Ex16.m1.2.2.4.cmml"></mi><mo id="A3.Ex16.m1.2.2.3" xref="A3.Ex16.m1.2.2.3.cmml">=</mo><mrow id="A3.Ex16.m1.2.2.2" xref="A3.Ex16.m1.2.2.2.cmml"><msub id="A3.Ex16.m1.2.2.2.4" xref="A3.Ex16.m1.2.2.2.4.cmml"><mi id="A3.Ex16.m1.2.2.2.4.2" xref="A3.Ex16.m1.2.2.2.4.2.cmml">E</mi><msub id="A3.Ex16.m1.2.2.2.4.3" xref="A3.Ex16.m1.2.2.2.4.3.cmml"><mi id="A3.Ex16.m1.2.2.2.4.3.2" xref="A3.Ex16.m1.2.2.2.4.3.2.cmml">π</mi><mtext id="A3.Ex16.m1.2.2.2.4.3.3" xref="A3.Ex16.m1.2.2.2.4.3.3a.cmml">new</mtext></msub></msub><mo id="A3.Ex16.m1.2.2.2.3" xref="A3.Ex16.m1.2.2.2.3.cmml">⁢</mo><mrow id="A3.Ex16.m1.2.2.2.2.2" xref="A3.Ex16.m1.2.2.2.2.3.cmml"><mo id="A3.Ex16.m1.2.2.2.2.2.3" stretchy="false" xref="A3.Ex16.m1.2.2.2.2.3.1.cmml">{</mo><mrow id="A3.Ex16.m1.1.1.1.1.1.1" xref="A3.Ex16.m1.1.1.1.1.1.1.cmml"><msub id="A3.Ex16.m1.1.1.1.1.1.1.3" xref="A3.Ex16.m1.1.1.1.1.1.1.3.cmml"><mi id="A3.Ex16.m1.1.1.1.1.1.1.3.2" xref="A3.Ex16.m1.1.1.1.1.1.1.3.2.cmml">r</mi><mi id="A3.Ex16.m1.1.1.1.1.1.1.3.3" xref="A3.Ex16.m1.1.1.1.1.1.1.3.3.cmml">t</mi></msub><mo id="A3.Ex16.m1.1.1.1.1.1.1.2" xref="A3.Ex16.m1.1.1.1.1.1.1.2.cmml">+</mo><mrow id="A3.Ex16.m1.1.1.1.1.1.1.1" xref="A3.Ex16.m1.1.1.1.1.1.1.1.cmml"><mi id="A3.Ex16.m1.1.1.1.1.1.1.1.3" xref="A3.Ex16.m1.1.1.1.1.1.1.1.3.cmml">γ</mi><mo id="A3.Ex16.m1.1.1.1.1.1.1.1.2" xref="A3.Ex16.m1.1.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="A3.Ex16.m1.1.1.1.1.1.1.1.4" xref="A3.Ex16.m1.1.1.1.1.1.1.1.4.cmml"><mi id="A3.Ex16.m1.1.1.1.1.1.1.1.4.2" xref="A3.Ex16.m1.1.1.1.1.1.1.1.4.2.cmml">V</mi><mi id="A3.Ex16.m1.1.1.1.1.1.1.1.4.3" xref="A3.Ex16.m1.1.1.1.1.1.1.1.4.3.cmml">π</mi></msup><mo id="A3.Ex16.m1.1.1.1.1.1.1.1.2a" xref="A3.Ex16.m1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A3.Ex16.m1.1.1.1.1.1.1.1.1.1" xref="A3.Ex16.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A3.Ex16.m1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A3.Ex16.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A3.Ex16.m1.1.1.1.1.1.1.1.1.1.1" xref="A3.Ex16.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A3.Ex16.m1.1.1.1.1.1.1.1.1.1.1.2" xref="A3.Ex16.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">s</mi><mrow id="A3.Ex16.m1.1.1.1.1.1.1.1.1.1.1.3" xref="A3.Ex16.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A3.Ex16.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="A3.Ex16.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="A3.Ex16.m1.1.1.1.1.1.1.1.1.1.1.3.1" xref="A3.Ex16.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">+</mo><mn id="A3.Ex16.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="A3.Ex16.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="A3.Ex16.m1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A3.Ex16.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A3.Ex16.m1.2.2.2.2.2.4" lspace="0em" rspace="0em" xref="A3.Ex16.m1.2.2.2.2.3.1.cmml">|</mo><mrow id="A3.Ex16.m1.2.2.2.2.2.2" xref="A3.Ex16.m1.2.2.2.2.2.2.cmml"><msub id="A3.Ex16.m1.2.2.2.2.2.2.2" xref="A3.Ex16.m1.2.2.2.2.2.2.2.cmml"><mi id="A3.Ex16.m1.2.2.2.2.2.2.2.2" xref="A3.Ex16.m1.2.2.2.2.2.2.2.2.cmml">s</mi><mi id="A3.Ex16.m1.2.2.2.2.2.2.2.3" xref="A3.Ex16.m1.2.2.2.2.2.2.2.3.cmml">t</mi></msub><mo id="A3.Ex16.m1.2.2.2.2.2.2.1" xref="A3.Ex16.m1.2.2.2.2.2.2.1.cmml">=</mo><mi id="A3.Ex16.m1.2.2.2.2.2.2.3" xref="A3.Ex16.m1.2.2.2.2.2.2.3.cmml">s</mi></mrow><mo id="A3.Ex16.m1.2.2.2.2.2.5" stretchy="false" xref="A3.Ex16.m1.2.2.2.2.3.1.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.Ex16.m1.2b"><apply id="A3.Ex16.m1.2.2.cmml" xref="A3.Ex16.m1.2.2"><eq id="A3.Ex16.m1.2.2.3.cmml" xref="A3.Ex16.m1.2.2.3"></eq><csymbol cd="latexml" id="A3.Ex16.m1.2.2.4.cmml" xref="A3.Ex16.m1.2.2.4">absent</csymbol><apply id="A3.Ex16.m1.2.2.2.cmml" xref="A3.Ex16.m1.2.2.2"><times id="A3.Ex16.m1.2.2.2.3.cmml" xref="A3.Ex16.m1.2.2.2.3"></times><apply id="A3.Ex16.m1.2.2.2.4.cmml" xref="A3.Ex16.m1.2.2.2.4"><csymbol cd="ambiguous" id="A3.Ex16.m1.2.2.2.4.1.cmml" xref="A3.Ex16.m1.2.2.2.4">subscript</csymbol><ci id="A3.Ex16.m1.2.2.2.4.2.cmml" xref="A3.Ex16.m1.2.2.2.4.2">𝐸</ci><apply id="A3.Ex16.m1.2.2.2.4.3.cmml" xref="A3.Ex16.m1.2.2.2.4.3"><csymbol cd="ambiguous" id="A3.Ex16.m1.2.2.2.4.3.1.cmml" xref="A3.Ex16.m1.2.2.2.4.3">subscript</csymbol><ci id="A3.Ex16.m1.2.2.2.4.3.2.cmml" xref="A3.Ex16.m1.2.2.2.4.3.2">𝜋</ci><ci id="A3.Ex16.m1.2.2.2.4.3.3a.cmml" xref="A3.Ex16.m1.2.2.2.4.3.3"><mtext id="A3.Ex16.m1.2.2.2.4.3.3.cmml" mathsize="50%" xref="A3.Ex16.m1.2.2.2.4.3.3">new</mtext></ci></apply></apply><apply id="A3.Ex16.m1.2.2.2.2.3.cmml" xref="A3.Ex16.m1.2.2.2.2.2"><csymbol cd="latexml" id="A3.Ex16.m1.2.2.2.2.3.1.cmml" xref="A3.Ex16.m1.2.2.2.2.2.3">conditional-set</csymbol><apply id="A3.Ex16.m1.1.1.1.1.1.1.cmml" xref="A3.Ex16.m1.1.1.1.1.1.1"><plus id="A3.Ex16.m1.1.1.1.1.1.1.2.cmml" xref="A3.Ex16.m1.1.1.1.1.1.1.2"></plus><apply id="A3.Ex16.m1.1.1.1.1.1.1.3.cmml" xref="A3.Ex16.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.Ex16.m1.1.1.1.1.1.1.3.1.cmml" xref="A3.Ex16.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A3.Ex16.m1.1.1.1.1.1.1.3.2.cmml" xref="A3.Ex16.m1.1.1.1.1.1.1.3.2">𝑟</ci><ci id="A3.Ex16.m1.1.1.1.1.1.1.3.3.cmml" xref="A3.Ex16.m1.1.1.1.1.1.1.3.3">𝑡</ci></apply><apply id="A3.Ex16.m1.1.1.1.1.1.1.1.cmml" xref="A3.Ex16.m1.1.1.1.1.1.1.1"><times id="A3.Ex16.m1.1.1.1.1.1.1.1.2.cmml" xref="A3.Ex16.m1.1.1.1.1.1.1.1.2"></times><ci id="A3.Ex16.m1.1.1.1.1.1.1.1.3.cmml" xref="A3.Ex16.m1.1.1.1.1.1.1.1.3">𝛾</ci><apply id="A3.Ex16.m1.1.1.1.1.1.1.1.4.cmml" xref="A3.Ex16.m1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A3.Ex16.m1.1.1.1.1.1.1.1.4.1.cmml" xref="A3.Ex16.m1.1.1.1.1.1.1.1.4">superscript</csymbol><ci id="A3.Ex16.m1.1.1.1.1.1.1.1.4.2.cmml" xref="A3.Ex16.m1.1.1.1.1.1.1.1.4.2">𝑉</ci><ci id="A3.Ex16.m1.1.1.1.1.1.1.1.4.3.cmml" xref="A3.Ex16.m1.1.1.1.1.1.1.1.4.3">𝜋</ci></apply><apply id="A3.Ex16.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.Ex16.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.Ex16.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A3.Ex16.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.Ex16.m1.1.1.1.1.1.1.1.1.1.1.2">𝑠</ci><apply id="A3.Ex16.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A3.Ex16.m1.1.1.1.1.1.1.1.1.1.1.3"><plus id="A3.Ex16.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A3.Ex16.m1.1.1.1.1.1.1.1.1.1.1.3.1"></plus><ci id="A3.Ex16.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A3.Ex16.m1.1.1.1.1.1.1.1.1.1.1.3.2">𝑡</ci><cn id="A3.Ex16.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="A3.Ex16.m1.1.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply></apply><apply id="A3.Ex16.m1.2.2.2.2.2.2.cmml" xref="A3.Ex16.m1.2.2.2.2.2.2"><eq id="A3.Ex16.m1.2.2.2.2.2.2.1.cmml" xref="A3.Ex16.m1.2.2.2.2.2.2.1"></eq><apply id="A3.Ex16.m1.2.2.2.2.2.2.2.cmml" xref="A3.Ex16.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A3.Ex16.m1.2.2.2.2.2.2.2.1.cmml" xref="A3.Ex16.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="A3.Ex16.m1.2.2.2.2.2.2.2.2.cmml" xref="A3.Ex16.m1.2.2.2.2.2.2.2.2">𝑠</ci><ci id="A3.Ex16.m1.2.2.2.2.2.2.2.3.cmml" xref="A3.Ex16.m1.2.2.2.2.2.2.2.3">𝑡</ci></apply><ci id="A3.Ex16.m1.2.2.2.2.2.2.3.cmml" xref="A3.Ex16.m1.2.2.2.2.2.2.3">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex16.m1.2c">\displaystyle=E_{\pi_{\text{new}}}\{r_{t}+\gamma V^{\pi}(s_{t+1})|s_{t}=s\}</annotation><annotation encoding="application/x-llamapun" id="A3.Ex16.m1.2d">= italic_E start_POSTSUBSCRIPT italic_π start_POSTSUBSCRIPT new end_POSTSUBSCRIPT end_POSTSUBSCRIPT { italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + italic_γ italic_V start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ) | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_s }</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A3.Ex17"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\leq E_{\pi_{\text{new}}}\{r_{t}+\gamma\sum_{a_{t+1}}\pi_{\text{%
new}}(a_{t+1}|s_{t+1})Q^{\pi}(s_{t+1})|s_{t}=s\}" class="ltx_Math" display="inline" id="A3.Ex17.m1.1"><semantics id="A3.Ex17.m1.1a"><mrow id="A3.Ex17.m1.1.1" xref="A3.Ex17.m1.1.1.cmml"><mi id="A3.Ex17.m1.1.1.3" xref="A3.Ex17.m1.1.1.3.cmml"></mi><mo id="A3.Ex17.m1.1.1.2" xref="A3.Ex17.m1.1.1.2.cmml">≤</mo><mrow id="A3.Ex17.m1.1.1.1" xref="A3.Ex17.m1.1.1.1.cmml"><msub id="A3.Ex17.m1.1.1.1.3" xref="A3.Ex17.m1.1.1.1.3.cmml"><mi id="A3.Ex17.m1.1.1.1.3.2" xref="A3.Ex17.m1.1.1.1.3.2.cmml">E</mi><msub id="A3.Ex17.m1.1.1.1.3.3" xref="A3.Ex17.m1.1.1.1.3.3.cmml"><mi id="A3.Ex17.m1.1.1.1.3.3.2" xref="A3.Ex17.m1.1.1.1.3.3.2.cmml">π</mi><mtext id="A3.Ex17.m1.1.1.1.3.3.3" xref="A3.Ex17.m1.1.1.1.3.3.3a.cmml">new</mtext></msub></msub><mo id="A3.Ex17.m1.1.1.1.2" xref="A3.Ex17.m1.1.1.1.2.cmml">⁢</mo><mrow id="A3.Ex17.m1.1.1.1.1.1" xref="A3.Ex17.m1.1.1.1.1.2.cmml"><mo id="A3.Ex17.m1.1.1.1.1.1.2" stretchy="false" xref="A3.Ex17.m1.1.1.1.1.2.cmml">{</mo><mrow id="A3.Ex17.m1.1.1.1.1.1.1" xref="A3.Ex17.m1.1.1.1.1.1.1.cmml"><mrow id="A3.Ex17.m1.1.1.1.1.1.1.2" xref="A3.Ex17.m1.1.1.1.1.1.1.2.cmml"><msub id="A3.Ex17.m1.1.1.1.1.1.1.2.4" xref="A3.Ex17.m1.1.1.1.1.1.1.2.4.cmml"><mi id="A3.Ex17.m1.1.1.1.1.1.1.2.4.2" xref="A3.Ex17.m1.1.1.1.1.1.1.2.4.2.cmml">r</mi><mi id="A3.Ex17.m1.1.1.1.1.1.1.2.4.3" xref="A3.Ex17.m1.1.1.1.1.1.1.2.4.3.cmml">t</mi></msub><mo id="A3.Ex17.m1.1.1.1.1.1.1.2.3" xref="A3.Ex17.m1.1.1.1.1.1.1.2.3.cmml">+</mo><mrow id="A3.Ex17.m1.1.1.1.1.1.1.2.2" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.cmml"><mrow id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.cmml"><mi id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.4" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.4.cmml">γ</mi><mo id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.3" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.3.cmml">⁢</mo><mrow id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.cmml"><mstyle displaystyle="true" id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.3" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.3.cmml"><munder id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.3a" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.3.cmml"><mo id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.3.2" movablelimits="false" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.3.2.cmml">∑</mo><msub id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.3.3" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.3.3.cmml"><mi id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.3.3.2" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.3.3.2.cmml">a</mi><mrow id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.3.3.3" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.3.3.3.cmml"><mi id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.3.3.3.2" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.3.3.3.2.cmml">t</mi><mo id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.3.3.3.1" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.3.3.3.1.cmml">+</mo><mn id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.3.3.3.3" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.3.3.3.3.cmml">1</mn></mrow></msub></munder></mstyle><mrow id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.cmml"><msub id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.4" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.4.cmml"><mi id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.4.2" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.4.2.cmml">π</mi><mtext id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.4.3" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.4.3a.cmml">new</mtext></msub><mo id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.3" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.3.cmml">⁢</mo><mrow id="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">a</mi><mrow id="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1" xref="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">+</mo><mn id="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">s</mi><mrow id="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1" xref="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">+</mo><mn id="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.3a" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.3.cmml">⁢</mo><msup id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.5" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.5.cmml"><mi id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.5.2" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.5.2.cmml">Q</mi><mi id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.5.3" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.5.3.cmml">π</mi></msup><mo id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.3b" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.3.cmml">⁢</mo><mrow id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.2.1" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.2.1.1.cmml"><mo id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.2.1.2" stretchy="false" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.2.1.1.cmml">(</mo><msub id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.2.1.1" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.2.1.1.cmml"><mi id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.2.1.1.2" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.2.1.1.2.cmml">s</mi><mrow id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.2.1.1.3" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.2.1.1.3.cmml"><mi id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.2.1.1.3.2" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.2.1.1.3.2.cmml">t</mi><mo id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.2.1.1.3.1" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.2.1.1.3.1.cmml">+</mo><mn id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.2.1.1.3.3" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.2.1.1.3.3.cmml">1</mn></mrow></msub><mo id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.2.1.3" stretchy="false" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo fence="false" id="A3.Ex17.m1.1.1.1.1.1.1.2.2.3" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.3.cmml">|</mo><msub id="A3.Ex17.m1.1.1.1.1.1.1.2.2.4" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.4.cmml"><mi id="A3.Ex17.m1.1.1.1.1.1.1.2.2.4.2" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.4.2.cmml">s</mi><mi id="A3.Ex17.m1.1.1.1.1.1.1.2.2.4.3" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.4.3.cmml">t</mi></msub></mrow></mrow><mo id="A3.Ex17.m1.1.1.1.1.1.1.3" xref="A3.Ex17.m1.1.1.1.1.1.1.3.cmml">=</mo><mi id="A3.Ex17.m1.1.1.1.1.1.1.4" xref="A3.Ex17.m1.1.1.1.1.1.1.4.cmml">s</mi></mrow><mo id="A3.Ex17.m1.1.1.1.1.1.3" stretchy="false" xref="A3.Ex17.m1.1.1.1.1.2.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.Ex17.m1.1b"><apply id="A3.Ex17.m1.1.1.cmml" xref="A3.Ex17.m1.1.1"><leq id="A3.Ex17.m1.1.1.2.cmml" xref="A3.Ex17.m1.1.1.2"></leq><csymbol cd="latexml" id="A3.Ex17.m1.1.1.3.cmml" xref="A3.Ex17.m1.1.1.3">absent</csymbol><apply id="A3.Ex17.m1.1.1.1.cmml" xref="A3.Ex17.m1.1.1.1"><times id="A3.Ex17.m1.1.1.1.2.cmml" xref="A3.Ex17.m1.1.1.1.2"></times><apply id="A3.Ex17.m1.1.1.1.3.cmml" xref="A3.Ex17.m1.1.1.1.3"><csymbol cd="ambiguous" id="A3.Ex17.m1.1.1.1.3.1.cmml" xref="A3.Ex17.m1.1.1.1.3">subscript</csymbol><ci id="A3.Ex17.m1.1.1.1.3.2.cmml" xref="A3.Ex17.m1.1.1.1.3.2">𝐸</ci><apply id="A3.Ex17.m1.1.1.1.3.3.cmml" xref="A3.Ex17.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="A3.Ex17.m1.1.1.1.3.3.1.cmml" xref="A3.Ex17.m1.1.1.1.3.3">subscript</csymbol><ci id="A3.Ex17.m1.1.1.1.3.3.2.cmml" xref="A3.Ex17.m1.1.1.1.3.3.2">𝜋</ci><ci id="A3.Ex17.m1.1.1.1.3.3.3a.cmml" xref="A3.Ex17.m1.1.1.1.3.3.3"><mtext id="A3.Ex17.m1.1.1.1.3.3.3.cmml" mathsize="50%" xref="A3.Ex17.m1.1.1.1.3.3.3">new</mtext></ci></apply></apply><set id="A3.Ex17.m1.1.1.1.1.2.cmml" xref="A3.Ex17.m1.1.1.1.1.1"><apply id="A3.Ex17.m1.1.1.1.1.1.1.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1"><eq id="A3.Ex17.m1.1.1.1.1.1.1.3.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.3"></eq><apply id="A3.Ex17.m1.1.1.1.1.1.1.2.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.2"><plus id="A3.Ex17.m1.1.1.1.1.1.1.2.3.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.2.3"></plus><apply id="A3.Ex17.m1.1.1.1.1.1.1.2.4.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="A3.Ex17.m1.1.1.1.1.1.1.2.4.1.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.2.4">subscript</csymbol><ci id="A3.Ex17.m1.1.1.1.1.1.1.2.4.2.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.2.4.2">𝑟</ci><ci id="A3.Ex17.m1.1.1.1.1.1.1.2.4.3.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.2.4.3">𝑡</ci></apply><apply id="A3.Ex17.m1.1.1.1.1.1.1.2.2.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2"><csymbol cd="latexml" id="A3.Ex17.m1.1.1.1.1.1.1.2.2.3.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.3">conditional</csymbol><apply id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2"><times id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.3.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.3"></times><ci id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.4.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.4">𝛾</ci><apply id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2"><apply id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.3.1.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.3">subscript</csymbol><sum id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.3.2.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.3.2"></sum><apply id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.3.3.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.3.3"><csymbol cd="ambiguous" id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.3.3.1.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.3.3">subscript</csymbol><ci id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.3.3.2.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.3.3.2">𝑎</ci><apply id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.3.3.3.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.3.3.3"><plus id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.3.3.3.1.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.3.3.3.1"></plus><ci id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.3.3.3.2.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.3.3.3.2">𝑡</ci><cn id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.3.3.3.3.cmml" type="integer" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.3.3.3.3">1</cn></apply></apply></apply><apply id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2"><times id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.3.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.3"></times><apply id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.4.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.4"><csymbol cd="ambiguous" id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.4.1.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.4">subscript</csymbol><ci id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.4.2.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.4.2">𝜋</ci><ci id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.4.3a.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.4.3"><mtext id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.4.3.cmml" mathsize="70%" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.4.3">new</mtext></ci></apply><apply id="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑎</ci><apply id="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3"><plus id="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1"></plus><ci id="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2">𝑡</ci><cn id="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑠</ci><apply id="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3"><plus id="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1"></plus><ci id="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2">𝑡</ci><cn id="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="A3.Ex17.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply><apply id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.5.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.5"><csymbol cd="ambiguous" id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.5.1.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.5">superscript</csymbol><ci id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.5.2.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.5.2">𝑄</ci><ci id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.5.3.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.5.3">𝜋</ci></apply><apply id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.2.1.1.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.2.1"><csymbol cd="ambiguous" id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.2.1.1.1.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.2.1">subscript</csymbol><ci id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.2.1.1.2.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.2.1.1.2">𝑠</ci><apply id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.2.1.1.3.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.2.1.1.3"><plus id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.2.1.1.3.1.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.2.1.1.3.1"></plus><ci id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.2.1.1.3.2.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.2.1.1.3.2">𝑡</ci><cn id="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.2.1.1.3.3.cmml" type="integer" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.2.2.2.2.1.1.3.3">1</cn></apply></apply></apply></apply></apply><apply id="A3.Ex17.m1.1.1.1.1.1.1.2.2.4.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.4"><csymbol cd="ambiguous" id="A3.Ex17.m1.1.1.1.1.1.1.2.2.4.1.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.4">subscript</csymbol><ci id="A3.Ex17.m1.1.1.1.1.1.1.2.2.4.2.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.4.2">𝑠</ci><ci id="A3.Ex17.m1.1.1.1.1.1.1.2.2.4.3.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.2.2.4.3">𝑡</ci></apply></apply></apply><ci id="A3.Ex17.m1.1.1.1.1.1.1.4.cmml" xref="A3.Ex17.m1.1.1.1.1.1.1.4">𝑠</ci></apply></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex17.m1.1c">\displaystyle\leq E_{\pi_{\text{new}}}\{r_{t}+\gamma\sum_{a_{t+1}}\pi_{\text{%
new}}(a_{t+1}|s_{t+1})Q^{\pi}(s_{t+1})|s_{t}=s\}</annotation><annotation encoding="application/x-llamapun" id="A3.Ex17.m1.1d">≤ italic_E start_POSTSUBSCRIPT italic_π start_POSTSUBSCRIPT new end_POSTSUBSCRIPT end_POSTSUBSCRIPT { italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + italic_γ ∑ start_POSTSUBSCRIPT italic_a start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_π start_POSTSUBSCRIPT new end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ) italic_Q start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ) | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_s }</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A3.Ex18"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\vdots" class="ltx_Math" display="inline" id="A3.Ex18.m1.1"><semantics id="A3.Ex18.m1.1a"><mi id="A3.Ex18.m1.1.1" mathvariant="normal" xref="A3.Ex18.m1.1.1.cmml">⋮</mi><annotation-xml encoding="MathML-Content" id="A3.Ex18.m1.1b"><ci id="A3.Ex18.m1.1.1.cmml" xref="A3.Ex18.m1.1.1">⋮</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex18.m1.1c">\displaystyle\vdots</annotation><annotation encoding="application/x-llamapun" id="A3.Ex18.m1.1d">⋮</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A3.Ex19"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\leq V^{\pi_{\text{new}}}(s)." class="ltx_Math" display="inline" id="A3.Ex19.m1.2"><semantics id="A3.Ex19.m1.2a"><mrow id="A3.Ex19.m1.2.2.1" xref="A3.Ex19.m1.2.2.1.1.cmml"><mrow id="A3.Ex19.m1.2.2.1.1" xref="A3.Ex19.m1.2.2.1.1.cmml"><mi id="A3.Ex19.m1.2.2.1.1.2" xref="A3.Ex19.m1.2.2.1.1.2.cmml"></mi><mo id="A3.Ex19.m1.2.2.1.1.1" xref="A3.Ex19.m1.2.2.1.1.1.cmml">≤</mo><mrow id="A3.Ex19.m1.2.2.1.1.3" xref="A3.Ex19.m1.2.2.1.1.3.cmml"><msup id="A3.Ex19.m1.2.2.1.1.3.2" xref="A3.Ex19.m1.2.2.1.1.3.2.cmml"><mi id="A3.Ex19.m1.2.2.1.1.3.2.2" xref="A3.Ex19.m1.2.2.1.1.3.2.2.cmml">V</mi><msub id="A3.Ex19.m1.2.2.1.1.3.2.3" xref="A3.Ex19.m1.2.2.1.1.3.2.3.cmml"><mi id="A3.Ex19.m1.2.2.1.1.3.2.3.2" xref="A3.Ex19.m1.2.2.1.1.3.2.3.2.cmml">π</mi><mtext id="A3.Ex19.m1.2.2.1.1.3.2.3.3" xref="A3.Ex19.m1.2.2.1.1.3.2.3.3a.cmml">new</mtext></msub></msup><mo id="A3.Ex19.m1.2.2.1.1.3.1" xref="A3.Ex19.m1.2.2.1.1.3.1.cmml">⁢</mo><mrow id="A3.Ex19.m1.2.2.1.1.3.3.2" xref="A3.Ex19.m1.2.2.1.1.3.cmml"><mo id="A3.Ex19.m1.2.2.1.1.3.3.2.1" stretchy="false" xref="A3.Ex19.m1.2.2.1.1.3.cmml">(</mo><mi id="A3.Ex19.m1.1.1" xref="A3.Ex19.m1.1.1.cmml">s</mi><mo id="A3.Ex19.m1.2.2.1.1.3.3.2.2" stretchy="false" xref="A3.Ex19.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="A3.Ex19.m1.2.2.1.2" lspace="0em" xref="A3.Ex19.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.Ex19.m1.2b"><apply id="A3.Ex19.m1.2.2.1.1.cmml" xref="A3.Ex19.m1.2.2.1"><leq id="A3.Ex19.m1.2.2.1.1.1.cmml" xref="A3.Ex19.m1.2.2.1.1.1"></leq><csymbol cd="latexml" id="A3.Ex19.m1.2.2.1.1.2.cmml" xref="A3.Ex19.m1.2.2.1.1.2">absent</csymbol><apply id="A3.Ex19.m1.2.2.1.1.3.cmml" xref="A3.Ex19.m1.2.2.1.1.3"><times id="A3.Ex19.m1.2.2.1.1.3.1.cmml" xref="A3.Ex19.m1.2.2.1.1.3.1"></times><apply id="A3.Ex19.m1.2.2.1.1.3.2.cmml" xref="A3.Ex19.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="A3.Ex19.m1.2.2.1.1.3.2.1.cmml" xref="A3.Ex19.m1.2.2.1.1.3.2">superscript</csymbol><ci id="A3.Ex19.m1.2.2.1.1.3.2.2.cmml" xref="A3.Ex19.m1.2.2.1.1.3.2.2">𝑉</ci><apply id="A3.Ex19.m1.2.2.1.1.3.2.3.cmml" xref="A3.Ex19.m1.2.2.1.1.3.2.3"><csymbol cd="ambiguous" id="A3.Ex19.m1.2.2.1.1.3.2.3.1.cmml" xref="A3.Ex19.m1.2.2.1.1.3.2.3">subscript</csymbol><ci id="A3.Ex19.m1.2.2.1.1.3.2.3.2.cmml" xref="A3.Ex19.m1.2.2.1.1.3.2.3.2">𝜋</ci><ci id="A3.Ex19.m1.2.2.1.1.3.2.3.3a.cmml" xref="A3.Ex19.m1.2.2.1.1.3.2.3.3"><mtext id="A3.Ex19.m1.2.2.1.1.3.2.3.3.cmml" mathsize="50%" xref="A3.Ex19.m1.2.2.1.1.3.2.3.3">new</mtext></ci></apply></apply><ci id="A3.Ex19.m1.1.1.cmml" xref="A3.Ex19.m1.1.1">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex19.m1.2c">\displaystyle\leq V^{\pi_{\text{new}}}(s).</annotation><annotation encoding="application/x-llamapun" id="A3.Ex19.m1.2d">≤ italic_V start_POSTSUPERSCRIPT italic_π start_POSTSUBSCRIPT new end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ( italic_s ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A3.SS2.2.p2">
<p class="ltx_p" id="A3.SS2.2.p2.1">∎</p>
</div>
</div>
</section>
</section>
<section class="ltx_appendix" id="A4">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Supplementary Experiment Details</h2>
<section class="ltx_subsection" id="A4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.1 </span>Construction and update of memory buffers</h3>
<div class="ltx_para ltx_noindent" id="A4.SS1.p1">
<p class="ltx_p" id="A4.SS1.p1.1">In memory-reflection module, maintain two fix-sized memory buffer of history trajectories, namely the memory buffer and the reflection buffer.</p>
</div>
<section class="ltx_paragraph" id="A4.SS1.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Memory Buffer:</h5>
<div class="ltx_para ltx_noindent" id="A4.SS1.SSS0.Px1.p1">
<p class="ltx_p" id="A4.SS1.SSS0.Px1.p1.2">Memory mechanisms must not only adapt to new environments by incorporating new experiences but also ensure timely forgetting (or replacing) of outdated experiences to maintain a reasonable capacity and avoid excessive overhead. Based on this, we maintain a fixed-size buffer of advantageous trajectories, <math alttext="M=\{T_{1},T_{2},T_{3},\dots,T_{i}\}" class="ltx_Math" display="inline" id="A4.SS1.SSS0.Px1.p1.1.m1.5"><semantics id="A4.SS1.SSS0.Px1.p1.1.m1.5a"><mrow id="A4.SS1.SSS0.Px1.p1.1.m1.5.5" xref="A4.SS1.SSS0.Px1.p1.1.m1.5.5.cmml"><mi id="A4.SS1.SSS0.Px1.p1.1.m1.5.5.6" xref="A4.SS1.SSS0.Px1.p1.1.m1.5.5.6.cmml">M</mi><mo id="A4.SS1.SSS0.Px1.p1.1.m1.5.5.5" xref="A4.SS1.SSS0.Px1.p1.1.m1.5.5.5.cmml">=</mo><mrow id="A4.SS1.SSS0.Px1.p1.1.m1.5.5.4.4" xref="A4.SS1.SSS0.Px1.p1.1.m1.5.5.4.5.cmml"><mo id="A4.SS1.SSS0.Px1.p1.1.m1.5.5.4.4.5" stretchy="false" xref="A4.SS1.SSS0.Px1.p1.1.m1.5.5.4.5.cmml">{</mo><msub id="A4.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1" xref="A4.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.cmml"><mi id="A4.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.2" xref="A4.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.2.cmml">T</mi><mn id="A4.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.3" xref="A4.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="A4.SS1.SSS0.Px1.p1.1.m1.5.5.4.4.6" xref="A4.SS1.SSS0.Px1.p1.1.m1.5.5.4.5.cmml">,</mo><msub id="A4.SS1.SSS0.Px1.p1.1.m1.3.3.2.2.2" xref="A4.SS1.SSS0.Px1.p1.1.m1.3.3.2.2.2.cmml"><mi id="A4.SS1.SSS0.Px1.p1.1.m1.3.3.2.2.2.2" xref="A4.SS1.SSS0.Px1.p1.1.m1.3.3.2.2.2.2.cmml">T</mi><mn id="A4.SS1.SSS0.Px1.p1.1.m1.3.3.2.2.2.3" xref="A4.SS1.SSS0.Px1.p1.1.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="A4.SS1.SSS0.Px1.p1.1.m1.5.5.4.4.7" xref="A4.SS1.SSS0.Px1.p1.1.m1.5.5.4.5.cmml">,</mo><msub id="A4.SS1.SSS0.Px1.p1.1.m1.4.4.3.3.3" xref="A4.SS1.SSS0.Px1.p1.1.m1.4.4.3.3.3.cmml"><mi id="A4.SS1.SSS0.Px1.p1.1.m1.4.4.3.3.3.2" xref="A4.SS1.SSS0.Px1.p1.1.m1.4.4.3.3.3.2.cmml">T</mi><mn id="A4.SS1.SSS0.Px1.p1.1.m1.4.4.3.3.3.3" xref="A4.SS1.SSS0.Px1.p1.1.m1.4.4.3.3.3.3.cmml">3</mn></msub><mo id="A4.SS1.SSS0.Px1.p1.1.m1.5.5.4.4.8" xref="A4.SS1.SSS0.Px1.p1.1.m1.5.5.4.5.cmml">,</mo><mi id="A4.SS1.SSS0.Px1.p1.1.m1.1.1" mathvariant="normal" xref="A4.SS1.SSS0.Px1.p1.1.m1.1.1.cmml">…</mi><mo id="A4.SS1.SSS0.Px1.p1.1.m1.5.5.4.4.9" xref="A4.SS1.SSS0.Px1.p1.1.m1.5.5.4.5.cmml">,</mo><msub id="A4.SS1.SSS0.Px1.p1.1.m1.5.5.4.4.4" xref="A4.SS1.SSS0.Px1.p1.1.m1.5.5.4.4.4.cmml"><mi id="A4.SS1.SSS0.Px1.p1.1.m1.5.5.4.4.4.2" xref="A4.SS1.SSS0.Px1.p1.1.m1.5.5.4.4.4.2.cmml">T</mi><mi id="A4.SS1.SSS0.Px1.p1.1.m1.5.5.4.4.4.3" xref="A4.SS1.SSS0.Px1.p1.1.m1.5.5.4.4.4.3.cmml">i</mi></msub><mo id="A4.SS1.SSS0.Px1.p1.1.m1.5.5.4.4.10" stretchy="false" xref="A4.SS1.SSS0.Px1.p1.1.m1.5.5.4.5.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.SS1.SSS0.Px1.p1.1.m1.5b"><apply id="A4.SS1.SSS0.Px1.p1.1.m1.5.5.cmml" xref="A4.SS1.SSS0.Px1.p1.1.m1.5.5"><eq id="A4.SS1.SSS0.Px1.p1.1.m1.5.5.5.cmml" xref="A4.SS1.SSS0.Px1.p1.1.m1.5.5.5"></eq><ci id="A4.SS1.SSS0.Px1.p1.1.m1.5.5.6.cmml" xref="A4.SS1.SSS0.Px1.p1.1.m1.5.5.6">𝑀</ci><set id="A4.SS1.SSS0.Px1.p1.1.m1.5.5.4.5.cmml" xref="A4.SS1.SSS0.Px1.p1.1.m1.5.5.4.4"><apply id="A4.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.cmml" xref="A4.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="A4.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.1.cmml" xref="A4.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="A4.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.2.cmml" xref="A4.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.2">𝑇</ci><cn id="A4.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="A4.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="A4.SS1.SSS0.Px1.p1.1.m1.3.3.2.2.2.cmml" xref="A4.SS1.SSS0.Px1.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="A4.SS1.SSS0.Px1.p1.1.m1.3.3.2.2.2.1.cmml" xref="A4.SS1.SSS0.Px1.p1.1.m1.3.3.2.2.2">subscript</csymbol><ci id="A4.SS1.SSS0.Px1.p1.1.m1.3.3.2.2.2.2.cmml" xref="A4.SS1.SSS0.Px1.p1.1.m1.3.3.2.2.2.2">𝑇</ci><cn id="A4.SS1.SSS0.Px1.p1.1.m1.3.3.2.2.2.3.cmml" type="integer" xref="A4.SS1.SSS0.Px1.p1.1.m1.3.3.2.2.2.3">2</cn></apply><apply id="A4.SS1.SSS0.Px1.p1.1.m1.4.4.3.3.3.cmml" xref="A4.SS1.SSS0.Px1.p1.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="A4.SS1.SSS0.Px1.p1.1.m1.4.4.3.3.3.1.cmml" xref="A4.SS1.SSS0.Px1.p1.1.m1.4.4.3.3.3">subscript</csymbol><ci id="A4.SS1.SSS0.Px1.p1.1.m1.4.4.3.3.3.2.cmml" xref="A4.SS1.SSS0.Px1.p1.1.m1.4.4.3.3.3.2">𝑇</ci><cn id="A4.SS1.SSS0.Px1.p1.1.m1.4.4.3.3.3.3.cmml" type="integer" xref="A4.SS1.SSS0.Px1.p1.1.m1.4.4.3.3.3.3">3</cn></apply><ci id="A4.SS1.SSS0.Px1.p1.1.m1.1.1.cmml" xref="A4.SS1.SSS0.Px1.p1.1.m1.1.1">…</ci><apply id="A4.SS1.SSS0.Px1.p1.1.m1.5.5.4.4.4.cmml" xref="A4.SS1.SSS0.Px1.p1.1.m1.5.5.4.4.4"><csymbol cd="ambiguous" id="A4.SS1.SSS0.Px1.p1.1.m1.5.5.4.4.4.1.cmml" xref="A4.SS1.SSS0.Px1.p1.1.m1.5.5.4.4.4">subscript</csymbol><ci id="A4.SS1.SSS0.Px1.p1.1.m1.5.5.4.4.4.2.cmml" xref="A4.SS1.SSS0.Px1.p1.1.m1.5.5.4.4.4.2">𝑇</ci><ci id="A4.SS1.SSS0.Px1.p1.1.m1.5.5.4.4.4.3.cmml" xref="A4.SS1.SSS0.Px1.p1.1.m1.5.5.4.4.4.3">𝑖</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.SSS0.Px1.p1.1.m1.5c">M=\{T_{1},T_{2},T_{3},\dots,T_{i}\}</annotation><annotation encoding="application/x-llamapun" id="A4.SS1.SSS0.Px1.p1.1.m1.5d">italic_M = { italic_T start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_T start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_T start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT , … , italic_T start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT }</annotation></semantics></math>, where each <math alttext="T_{i}" class="ltx_Math" display="inline" id="A4.SS1.SSS0.Px1.p1.2.m2.1"><semantics id="A4.SS1.SSS0.Px1.p1.2.m2.1a"><msub id="A4.SS1.SSS0.Px1.p1.2.m2.1.1" xref="A4.SS1.SSS0.Px1.p1.2.m2.1.1.cmml"><mi id="A4.SS1.SSS0.Px1.p1.2.m2.1.1.2" xref="A4.SS1.SSS0.Px1.p1.2.m2.1.1.2.cmml">T</mi><mi id="A4.SS1.SSS0.Px1.p1.2.m2.1.1.3" xref="A4.SS1.SSS0.Px1.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A4.SS1.SSS0.Px1.p1.2.m2.1b"><apply id="A4.SS1.SSS0.Px1.p1.2.m2.1.1.cmml" xref="A4.SS1.SSS0.Px1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A4.SS1.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="A4.SS1.SSS0.Px1.p1.2.m2.1.1">subscript</csymbol><ci id="A4.SS1.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="A4.SS1.SSS0.Px1.p1.2.m2.1.1.2">𝑇</ci><ci id="A4.SS1.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="A4.SS1.SSS0.Px1.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.SSS0.Px1.p1.2.m2.1c">T_{i}</annotation><annotation encoding="application/x-llamapun" id="A4.SS1.SSS0.Px1.p1.2.m2.1d">italic_T start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> contains a complete sequence of state-action-reward tuples:</p>
<table class="ltx_equation ltx_eqn_table" id="A4.Ex20">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="T_{i}=\{(s_{1},a_{1},r_{1}),(s_{2},a_{2},r_{2}),\dots,(R_{i},N_{i})\}." class="ltx_Math" display="block" id="A4.Ex20.m1.2"><semantics id="A4.Ex20.m1.2a"><mrow id="A4.Ex20.m1.2.2.1" xref="A4.Ex20.m1.2.2.1.1.cmml"><mrow id="A4.Ex20.m1.2.2.1.1" xref="A4.Ex20.m1.2.2.1.1.cmml"><msub id="A4.Ex20.m1.2.2.1.1.5" xref="A4.Ex20.m1.2.2.1.1.5.cmml"><mi id="A4.Ex20.m1.2.2.1.1.5.2" xref="A4.Ex20.m1.2.2.1.1.5.2.cmml">T</mi><mi id="A4.Ex20.m1.2.2.1.1.5.3" xref="A4.Ex20.m1.2.2.1.1.5.3.cmml">i</mi></msub><mo id="A4.Ex20.m1.2.2.1.1.4" xref="A4.Ex20.m1.2.2.1.1.4.cmml">=</mo><mrow id="A4.Ex20.m1.2.2.1.1.3.3" xref="A4.Ex20.m1.2.2.1.1.3.4.cmml"><mo id="A4.Ex20.m1.2.2.1.1.3.3.4" stretchy="false" xref="A4.Ex20.m1.2.2.1.1.3.4.cmml">{</mo><mrow id="A4.Ex20.m1.2.2.1.1.1.1.1.3" xref="A4.Ex20.m1.2.2.1.1.1.1.1.4.cmml"><mo id="A4.Ex20.m1.2.2.1.1.1.1.1.3.4" stretchy="false" xref="A4.Ex20.m1.2.2.1.1.1.1.1.4.cmml">(</mo><msub id="A4.Ex20.m1.2.2.1.1.1.1.1.1.1" xref="A4.Ex20.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="A4.Ex20.m1.2.2.1.1.1.1.1.1.1.2" xref="A4.Ex20.m1.2.2.1.1.1.1.1.1.1.2.cmml">s</mi><mn id="A4.Ex20.m1.2.2.1.1.1.1.1.1.1.3" xref="A4.Ex20.m1.2.2.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="A4.Ex20.m1.2.2.1.1.1.1.1.3.5" xref="A4.Ex20.m1.2.2.1.1.1.1.1.4.cmml">,</mo><msub id="A4.Ex20.m1.2.2.1.1.1.1.1.2.2" xref="A4.Ex20.m1.2.2.1.1.1.1.1.2.2.cmml"><mi id="A4.Ex20.m1.2.2.1.1.1.1.1.2.2.2" xref="A4.Ex20.m1.2.2.1.1.1.1.1.2.2.2.cmml">a</mi><mn id="A4.Ex20.m1.2.2.1.1.1.1.1.2.2.3" xref="A4.Ex20.m1.2.2.1.1.1.1.1.2.2.3.cmml">1</mn></msub><mo id="A4.Ex20.m1.2.2.1.1.1.1.1.3.6" xref="A4.Ex20.m1.2.2.1.1.1.1.1.4.cmml">,</mo><msub id="A4.Ex20.m1.2.2.1.1.1.1.1.3.3" xref="A4.Ex20.m1.2.2.1.1.1.1.1.3.3.cmml"><mi id="A4.Ex20.m1.2.2.1.1.1.1.1.3.3.2" xref="A4.Ex20.m1.2.2.1.1.1.1.1.3.3.2.cmml">r</mi><mn id="A4.Ex20.m1.2.2.1.1.1.1.1.3.3.3" xref="A4.Ex20.m1.2.2.1.1.1.1.1.3.3.3.cmml">1</mn></msub><mo id="A4.Ex20.m1.2.2.1.1.1.1.1.3.7" stretchy="false" xref="A4.Ex20.m1.2.2.1.1.1.1.1.4.cmml">)</mo></mrow><mo id="A4.Ex20.m1.2.2.1.1.3.3.5" xref="A4.Ex20.m1.2.2.1.1.3.4.cmml">,</mo><mrow id="A4.Ex20.m1.2.2.1.1.2.2.2.3" xref="A4.Ex20.m1.2.2.1.1.2.2.2.4.cmml"><mo id="A4.Ex20.m1.2.2.1.1.2.2.2.3.4" stretchy="false" xref="A4.Ex20.m1.2.2.1.1.2.2.2.4.cmml">(</mo><msub id="A4.Ex20.m1.2.2.1.1.2.2.2.1.1" xref="A4.Ex20.m1.2.2.1.1.2.2.2.1.1.cmml"><mi id="A4.Ex20.m1.2.2.1.1.2.2.2.1.1.2" xref="A4.Ex20.m1.2.2.1.1.2.2.2.1.1.2.cmml">s</mi><mn id="A4.Ex20.m1.2.2.1.1.2.2.2.1.1.3" xref="A4.Ex20.m1.2.2.1.1.2.2.2.1.1.3.cmml">2</mn></msub><mo id="A4.Ex20.m1.2.2.1.1.2.2.2.3.5" xref="A4.Ex20.m1.2.2.1.1.2.2.2.4.cmml">,</mo><msub id="A4.Ex20.m1.2.2.1.1.2.2.2.2.2" xref="A4.Ex20.m1.2.2.1.1.2.2.2.2.2.cmml"><mi id="A4.Ex20.m1.2.2.1.1.2.2.2.2.2.2" xref="A4.Ex20.m1.2.2.1.1.2.2.2.2.2.2.cmml">a</mi><mn id="A4.Ex20.m1.2.2.1.1.2.2.2.2.2.3" xref="A4.Ex20.m1.2.2.1.1.2.2.2.2.2.3.cmml">2</mn></msub><mo id="A4.Ex20.m1.2.2.1.1.2.2.2.3.6" xref="A4.Ex20.m1.2.2.1.1.2.2.2.4.cmml">,</mo><msub id="A4.Ex20.m1.2.2.1.1.2.2.2.3.3" xref="A4.Ex20.m1.2.2.1.1.2.2.2.3.3.cmml"><mi id="A4.Ex20.m1.2.2.1.1.2.2.2.3.3.2" xref="A4.Ex20.m1.2.2.1.1.2.2.2.3.3.2.cmml">r</mi><mn id="A4.Ex20.m1.2.2.1.1.2.2.2.3.3.3" xref="A4.Ex20.m1.2.2.1.1.2.2.2.3.3.3.cmml">2</mn></msub><mo id="A4.Ex20.m1.2.2.1.1.2.2.2.3.7" stretchy="false" xref="A4.Ex20.m1.2.2.1.1.2.2.2.4.cmml">)</mo></mrow><mo id="A4.Ex20.m1.2.2.1.1.3.3.6" xref="A4.Ex20.m1.2.2.1.1.3.4.cmml">,</mo><mi id="A4.Ex20.m1.1.1" mathvariant="normal" xref="A4.Ex20.m1.1.1.cmml">…</mi><mo id="A4.Ex20.m1.2.2.1.1.3.3.7" xref="A4.Ex20.m1.2.2.1.1.3.4.cmml">,</mo><mrow id="A4.Ex20.m1.2.2.1.1.3.3.3.2" xref="A4.Ex20.m1.2.2.1.1.3.3.3.3.cmml"><mo id="A4.Ex20.m1.2.2.1.1.3.3.3.2.3" stretchy="false" xref="A4.Ex20.m1.2.2.1.1.3.3.3.3.cmml">(</mo><msub id="A4.Ex20.m1.2.2.1.1.3.3.3.1.1" xref="A4.Ex20.m1.2.2.1.1.3.3.3.1.1.cmml"><mi id="A4.Ex20.m1.2.2.1.1.3.3.3.1.1.2" xref="A4.Ex20.m1.2.2.1.1.3.3.3.1.1.2.cmml">R</mi><mi id="A4.Ex20.m1.2.2.1.1.3.3.3.1.1.3" xref="A4.Ex20.m1.2.2.1.1.3.3.3.1.1.3.cmml">i</mi></msub><mo id="A4.Ex20.m1.2.2.1.1.3.3.3.2.4" xref="A4.Ex20.m1.2.2.1.1.3.3.3.3.cmml">,</mo><msub id="A4.Ex20.m1.2.2.1.1.3.3.3.2.2" xref="A4.Ex20.m1.2.2.1.1.3.3.3.2.2.cmml"><mi id="A4.Ex20.m1.2.2.1.1.3.3.3.2.2.2" xref="A4.Ex20.m1.2.2.1.1.3.3.3.2.2.2.cmml">N</mi><mi id="A4.Ex20.m1.2.2.1.1.3.3.3.2.2.3" xref="A4.Ex20.m1.2.2.1.1.3.3.3.2.2.3.cmml">i</mi></msub><mo id="A4.Ex20.m1.2.2.1.1.3.3.3.2.5" stretchy="false" xref="A4.Ex20.m1.2.2.1.1.3.3.3.3.cmml">)</mo></mrow><mo id="A4.Ex20.m1.2.2.1.1.3.3.8" stretchy="false" xref="A4.Ex20.m1.2.2.1.1.3.4.cmml">}</mo></mrow></mrow><mo id="A4.Ex20.m1.2.2.1.2" lspace="0em" xref="A4.Ex20.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.Ex20.m1.2b"><apply id="A4.Ex20.m1.2.2.1.1.cmml" xref="A4.Ex20.m1.2.2.1"><eq id="A4.Ex20.m1.2.2.1.1.4.cmml" xref="A4.Ex20.m1.2.2.1.1.4"></eq><apply id="A4.Ex20.m1.2.2.1.1.5.cmml" xref="A4.Ex20.m1.2.2.1.1.5"><csymbol cd="ambiguous" id="A4.Ex20.m1.2.2.1.1.5.1.cmml" xref="A4.Ex20.m1.2.2.1.1.5">subscript</csymbol><ci id="A4.Ex20.m1.2.2.1.1.5.2.cmml" xref="A4.Ex20.m1.2.2.1.1.5.2">𝑇</ci><ci id="A4.Ex20.m1.2.2.1.1.5.3.cmml" xref="A4.Ex20.m1.2.2.1.1.5.3">𝑖</ci></apply><set id="A4.Ex20.m1.2.2.1.1.3.4.cmml" xref="A4.Ex20.m1.2.2.1.1.3.3"><vector id="A4.Ex20.m1.2.2.1.1.1.1.1.4.cmml" xref="A4.Ex20.m1.2.2.1.1.1.1.1.3"><apply id="A4.Ex20.m1.2.2.1.1.1.1.1.1.1.cmml" xref="A4.Ex20.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.Ex20.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="A4.Ex20.m1.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="A4.Ex20.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="A4.Ex20.m1.2.2.1.1.1.1.1.1.1.2">𝑠</ci><cn id="A4.Ex20.m1.2.2.1.1.1.1.1.1.1.3.cmml" type="integer" xref="A4.Ex20.m1.2.2.1.1.1.1.1.1.1.3">1</cn></apply><apply id="A4.Ex20.m1.2.2.1.1.1.1.1.2.2.cmml" xref="A4.Ex20.m1.2.2.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A4.Ex20.m1.2.2.1.1.1.1.1.2.2.1.cmml" xref="A4.Ex20.m1.2.2.1.1.1.1.1.2.2">subscript</csymbol><ci id="A4.Ex20.m1.2.2.1.1.1.1.1.2.2.2.cmml" xref="A4.Ex20.m1.2.2.1.1.1.1.1.2.2.2">𝑎</ci><cn id="A4.Ex20.m1.2.2.1.1.1.1.1.2.2.3.cmml" type="integer" xref="A4.Ex20.m1.2.2.1.1.1.1.1.2.2.3">1</cn></apply><apply id="A4.Ex20.m1.2.2.1.1.1.1.1.3.3.cmml" xref="A4.Ex20.m1.2.2.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A4.Ex20.m1.2.2.1.1.1.1.1.3.3.1.cmml" xref="A4.Ex20.m1.2.2.1.1.1.1.1.3.3">subscript</csymbol><ci id="A4.Ex20.m1.2.2.1.1.1.1.1.3.3.2.cmml" xref="A4.Ex20.m1.2.2.1.1.1.1.1.3.3.2">𝑟</ci><cn id="A4.Ex20.m1.2.2.1.1.1.1.1.3.3.3.cmml" type="integer" xref="A4.Ex20.m1.2.2.1.1.1.1.1.3.3.3">1</cn></apply></vector><vector id="A4.Ex20.m1.2.2.1.1.2.2.2.4.cmml" xref="A4.Ex20.m1.2.2.1.1.2.2.2.3"><apply id="A4.Ex20.m1.2.2.1.1.2.2.2.1.1.cmml" xref="A4.Ex20.m1.2.2.1.1.2.2.2.1.1"><csymbol cd="ambiguous" id="A4.Ex20.m1.2.2.1.1.2.2.2.1.1.1.cmml" xref="A4.Ex20.m1.2.2.1.1.2.2.2.1.1">subscript</csymbol><ci id="A4.Ex20.m1.2.2.1.1.2.2.2.1.1.2.cmml" xref="A4.Ex20.m1.2.2.1.1.2.2.2.1.1.2">𝑠</ci><cn id="A4.Ex20.m1.2.2.1.1.2.2.2.1.1.3.cmml" type="integer" xref="A4.Ex20.m1.2.2.1.1.2.2.2.1.1.3">2</cn></apply><apply id="A4.Ex20.m1.2.2.1.1.2.2.2.2.2.cmml" xref="A4.Ex20.m1.2.2.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="A4.Ex20.m1.2.2.1.1.2.2.2.2.2.1.cmml" xref="A4.Ex20.m1.2.2.1.1.2.2.2.2.2">subscript</csymbol><ci id="A4.Ex20.m1.2.2.1.1.2.2.2.2.2.2.cmml" xref="A4.Ex20.m1.2.2.1.1.2.2.2.2.2.2">𝑎</ci><cn id="A4.Ex20.m1.2.2.1.1.2.2.2.2.2.3.cmml" type="integer" xref="A4.Ex20.m1.2.2.1.1.2.2.2.2.2.3">2</cn></apply><apply id="A4.Ex20.m1.2.2.1.1.2.2.2.3.3.cmml" xref="A4.Ex20.m1.2.2.1.1.2.2.2.3.3"><csymbol cd="ambiguous" id="A4.Ex20.m1.2.2.1.1.2.2.2.3.3.1.cmml" xref="A4.Ex20.m1.2.2.1.1.2.2.2.3.3">subscript</csymbol><ci id="A4.Ex20.m1.2.2.1.1.2.2.2.3.3.2.cmml" xref="A4.Ex20.m1.2.2.1.1.2.2.2.3.3.2">𝑟</ci><cn id="A4.Ex20.m1.2.2.1.1.2.2.2.3.3.3.cmml" type="integer" xref="A4.Ex20.m1.2.2.1.1.2.2.2.3.3.3">2</cn></apply></vector><ci id="A4.Ex20.m1.1.1.cmml" xref="A4.Ex20.m1.1.1">…</ci><interval closure="open" id="A4.Ex20.m1.2.2.1.1.3.3.3.3.cmml" xref="A4.Ex20.m1.2.2.1.1.3.3.3.2"><apply id="A4.Ex20.m1.2.2.1.1.3.3.3.1.1.cmml" xref="A4.Ex20.m1.2.2.1.1.3.3.3.1.1"><csymbol cd="ambiguous" id="A4.Ex20.m1.2.2.1.1.3.3.3.1.1.1.cmml" xref="A4.Ex20.m1.2.2.1.1.3.3.3.1.1">subscript</csymbol><ci id="A4.Ex20.m1.2.2.1.1.3.3.3.1.1.2.cmml" xref="A4.Ex20.m1.2.2.1.1.3.3.3.1.1.2">𝑅</ci><ci id="A4.Ex20.m1.2.2.1.1.3.3.3.1.1.3.cmml" xref="A4.Ex20.m1.2.2.1.1.3.3.3.1.1.3">𝑖</ci></apply><apply id="A4.Ex20.m1.2.2.1.1.3.3.3.2.2.cmml" xref="A4.Ex20.m1.2.2.1.1.3.3.3.2.2"><csymbol cd="ambiguous" id="A4.Ex20.m1.2.2.1.1.3.3.3.2.2.1.cmml" xref="A4.Ex20.m1.2.2.1.1.3.3.3.2.2">subscript</csymbol><ci id="A4.Ex20.m1.2.2.1.1.3.3.3.2.2.2.cmml" xref="A4.Ex20.m1.2.2.1.1.3.3.3.2.2.2">𝑁</ci><ci id="A4.Ex20.m1.2.2.1.1.3.3.3.2.2.3.cmml" xref="A4.Ex20.m1.2.2.1.1.3.3.3.2.2.3">𝑖</ci></apply></interval></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.Ex20.m1.2c">T_{i}=\{(s_{1},a_{1},r_{1}),(s_{2},a_{2},r_{2}),\dots,(R_{i},N_{i})\}.</annotation><annotation encoding="application/x-llamapun" id="A4.Ex20.m1.2d">italic_T start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = { ( italic_s start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) , ( italic_s start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) , … , ( italic_R start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_N start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) } .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A4.SS1.SSS0.Px1.p1.7">Here, <math alttext="s_{i}" class="ltx_Math" display="inline" id="A4.SS1.SSS0.Px1.p1.3.m1.1"><semantics id="A4.SS1.SSS0.Px1.p1.3.m1.1a"><msub id="A4.SS1.SSS0.Px1.p1.3.m1.1.1" xref="A4.SS1.SSS0.Px1.p1.3.m1.1.1.cmml"><mi id="A4.SS1.SSS0.Px1.p1.3.m1.1.1.2" xref="A4.SS1.SSS0.Px1.p1.3.m1.1.1.2.cmml">s</mi><mi id="A4.SS1.SSS0.Px1.p1.3.m1.1.1.3" xref="A4.SS1.SSS0.Px1.p1.3.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A4.SS1.SSS0.Px1.p1.3.m1.1b"><apply id="A4.SS1.SSS0.Px1.p1.3.m1.1.1.cmml" xref="A4.SS1.SSS0.Px1.p1.3.m1.1.1"><csymbol cd="ambiguous" id="A4.SS1.SSS0.Px1.p1.3.m1.1.1.1.cmml" xref="A4.SS1.SSS0.Px1.p1.3.m1.1.1">subscript</csymbol><ci id="A4.SS1.SSS0.Px1.p1.3.m1.1.1.2.cmml" xref="A4.SS1.SSS0.Px1.p1.3.m1.1.1.2">𝑠</ci><ci id="A4.SS1.SSS0.Px1.p1.3.m1.1.1.3.cmml" xref="A4.SS1.SSS0.Px1.p1.3.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.SSS0.Px1.p1.3.m1.1c">s_{i}</annotation><annotation encoding="application/x-llamapun" id="A4.SS1.SSS0.Px1.p1.3.m1.1d">italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="a_{i}" class="ltx_Math" display="inline" id="A4.SS1.SSS0.Px1.p1.4.m2.1"><semantics id="A4.SS1.SSS0.Px1.p1.4.m2.1a"><msub id="A4.SS1.SSS0.Px1.p1.4.m2.1.1" xref="A4.SS1.SSS0.Px1.p1.4.m2.1.1.cmml"><mi id="A4.SS1.SSS0.Px1.p1.4.m2.1.1.2" xref="A4.SS1.SSS0.Px1.p1.4.m2.1.1.2.cmml">a</mi><mi id="A4.SS1.SSS0.Px1.p1.4.m2.1.1.3" xref="A4.SS1.SSS0.Px1.p1.4.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A4.SS1.SSS0.Px1.p1.4.m2.1b"><apply id="A4.SS1.SSS0.Px1.p1.4.m2.1.1.cmml" xref="A4.SS1.SSS0.Px1.p1.4.m2.1.1"><csymbol cd="ambiguous" id="A4.SS1.SSS0.Px1.p1.4.m2.1.1.1.cmml" xref="A4.SS1.SSS0.Px1.p1.4.m2.1.1">subscript</csymbol><ci id="A4.SS1.SSS0.Px1.p1.4.m2.1.1.2.cmml" xref="A4.SS1.SSS0.Px1.p1.4.m2.1.1.2">𝑎</ci><ci id="A4.SS1.SSS0.Px1.p1.4.m2.1.1.3.cmml" xref="A4.SS1.SSS0.Px1.p1.4.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.SSS0.Px1.p1.4.m2.1c">a_{i}</annotation><annotation encoding="application/x-llamapun" id="A4.SS1.SSS0.Px1.p1.4.m2.1d">italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="r_{i}" class="ltx_Math" display="inline" id="A4.SS1.SSS0.Px1.p1.5.m3.1"><semantics id="A4.SS1.SSS0.Px1.p1.5.m3.1a"><msub id="A4.SS1.SSS0.Px1.p1.5.m3.1.1" xref="A4.SS1.SSS0.Px1.p1.5.m3.1.1.cmml"><mi id="A4.SS1.SSS0.Px1.p1.5.m3.1.1.2" xref="A4.SS1.SSS0.Px1.p1.5.m3.1.1.2.cmml">r</mi><mi id="A4.SS1.SSS0.Px1.p1.5.m3.1.1.3" xref="A4.SS1.SSS0.Px1.p1.5.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A4.SS1.SSS0.Px1.p1.5.m3.1b"><apply id="A4.SS1.SSS0.Px1.p1.5.m3.1.1.cmml" xref="A4.SS1.SSS0.Px1.p1.5.m3.1.1"><csymbol cd="ambiguous" id="A4.SS1.SSS0.Px1.p1.5.m3.1.1.1.cmml" xref="A4.SS1.SSS0.Px1.p1.5.m3.1.1">subscript</csymbol><ci id="A4.SS1.SSS0.Px1.p1.5.m3.1.1.2.cmml" xref="A4.SS1.SSS0.Px1.p1.5.m3.1.1.2">𝑟</ci><ci id="A4.SS1.SSS0.Px1.p1.5.m3.1.1.3.cmml" xref="A4.SS1.SSS0.Px1.p1.5.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.SSS0.Px1.p1.5.m3.1c">r_{i}</annotation><annotation encoding="application/x-llamapun" id="A4.SS1.SSS0.Px1.p1.5.m3.1d">italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> represent the state, action, and reward, respectively, <math alttext="N_{i}" class="ltx_Math" display="inline" id="A4.SS1.SSS0.Px1.p1.6.m4.1"><semantics id="A4.SS1.SSS0.Px1.p1.6.m4.1a"><msub id="A4.SS1.SSS0.Px1.p1.6.m4.1.1" xref="A4.SS1.SSS0.Px1.p1.6.m4.1.1.cmml"><mi id="A4.SS1.SSS0.Px1.p1.6.m4.1.1.2" xref="A4.SS1.SSS0.Px1.p1.6.m4.1.1.2.cmml">N</mi><mi id="A4.SS1.SSS0.Px1.p1.6.m4.1.1.3" xref="A4.SS1.SSS0.Px1.p1.6.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A4.SS1.SSS0.Px1.p1.6.m4.1b"><apply id="A4.SS1.SSS0.Px1.p1.6.m4.1.1.cmml" xref="A4.SS1.SSS0.Px1.p1.6.m4.1.1"><csymbol cd="ambiguous" id="A4.SS1.SSS0.Px1.p1.6.m4.1.1.1.cmml" xref="A4.SS1.SSS0.Px1.p1.6.m4.1.1">subscript</csymbol><ci id="A4.SS1.SSS0.Px1.p1.6.m4.1.1.2.cmml" xref="A4.SS1.SSS0.Px1.p1.6.m4.1.1.2">𝑁</ci><ci id="A4.SS1.SSS0.Px1.p1.6.m4.1.1.3.cmml" xref="A4.SS1.SSS0.Px1.p1.6.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.SSS0.Px1.p1.6.m4.1c">N_{i}</annotation><annotation encoding="application/x-llamapun" id="A4.SS1.SSS0.Px1.p1.6.m4.1d">italic_N start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the total length of the trajectory excluding terminal (death) states, and <math alttext="R_{i}" class="ltx_Math" display="inline" id="A4.SS1.SSS0.Px1.p1.7.m5.1"><semantics id="A4.SS1.SSS0.Px1.p1.7.m5.1a"><msub id="A4.SS1.SSS0.Px1.p1.7.m5.1.1" xref="A4.SS1.SSS0.Px1.p1.7.m5.1.1.cmml"><mi id="A4.SS1.SSS0.Px1.p1.7.m5.1.1.2" xref="A4.SS1.SSS0.Px1.p1.7.m5.1.1.2.cmml">R</mi><mi id="A4.SS1.SSS0.Px1.p1.7.m5.1.1.3" xref="A4.SS1.SSS0.Px1.p1.7.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A4.SS1.SSS0.Px1.p1.7.m5.1b"><apply id="A4.SS1.SSS0.Px1.p1.7.m5.1.1.cmml" xref="A4.SS1.SSS0.Px1.p1.7.m5.1.1"><csymbol cd="ambiguous" id="A4.SS1.SSS0.Px1.p1.7.m5.1.1.1.cmml" xref="A4.SS1.SSS0.Px1.p1.7.m5.1.1">subscript</csymbol><ci id="A4.SS1.SSS0.Px1.p1.7.m5.1.1.2.cmml" xref="A4.SS1.SSS0.Px1.p1.7.m5.1.1.2">𝑅</ci><ci id="A4.SS1.SSS0.Px1.p1.7.m5.1.1.3.cmml" xref="A4.SS1.SSS0.Px1.p1.7.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.SSS0.Px1.p1.7.m5.1c">R_{i}</annotation><annotation encoding="application/x-llamapun" id="A4.SS1.SSS0.Px1.p1.7.m5.1d">italic_R start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the total reward accumulated in the trajectory. If the trajectory ends in a non-terminal state, it is entirely stored.</p>
</div>
<div class="ltx_para ltx_noindent" id="A4.SS1.SSS0.Px1.p2">
<p class="ltx_p" id="A4.SS1.SSS0.Px1.p2.7">The update strategy of memory buffer works as follows: if <math alttext="R_{i}=R_{k}" class="ltx_Math" display="inline" id="A4.SS1.SSS0.Px1.p2.1.m1.1"><semantics id="A4.SS1.SSS0.Px1.p2.1.m1.1a"><mrow id="A4.SS1.SSS0.Px1.p2.1.m1.1.1" xref="A4.SS1.SSS0.Px1.p2.1.m1.1.1.cmml"><msub id="A4.SS1.SSS0.Px1.p2.1.m1.1.1.2" xref="A4.SS1.SSS0.Px1.p2.1.m1.1.1.2.cmml"><mi id="A4.SS1.SSS0.Px1.p2.1.m1.1.1.2.2" xref="A4.SS1.SSS0.Px1.p2.1.m1.1.1.2.2.cmml">R</mi><mi id="A4.SS1.SSS0.Px1.p2.1.m1.1.1.2.3" xref="A4.SS1.SSS0.Px1.p2.1.m1.1.1.2.3.cmml">i</mi></msub><mo id="A4.SS1.SSS0.Px1.p2.1.m1.1.1.1" xref="A4.SS1.SSS0.Px1.p2.1.m1.1.1.1.cmml">=</mo><msub id="A4.SS1.SSS0.Px1.p2.1.m1.1.1.3" xref="A4.SS1.SSS0.Px1.p2.1.m1.1.1.3.cmml"><mi id="A4.SS1.SSS0.Px1.p2.1.m1.1.1.3.2" xref="A4.SS1.SSS0.Px1.p2.1.m1.1.1.3.2.cmml">R</mi><mi id="A4.SS1.SSS0.Px1.p2.1.m1.1.1.3.3" xref="A4.SS1.SSS0.Px1.p2.1.m1.1.1.3.3.cmml">k</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A4.SS1.SSS0.Px1.p2.1.m1.1b"><apply id="A4.SS1.SSS0.Px1.p2.1.m1.1.1.cmml" xref="A4.SS1.SSS0.Px1.p2.1.m1.1.1"><eq id="A4.SS1.SSS0.Px1.p2.1.m1.1.1.1.cmml" xref="A4.SS1.SSS0.Px1.p2.1.m1.1.1.1"></eq><apply id="A4.SS1.SSS0.Px1.p2.1.m1.1.1.2.cmml" xref="A4.SS1.SSS0.Px1.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="A4.SS1.SSS0.Px1.p2.1.m1.1.1.2.1.cmml" xref="A4.SS1.SSS0.Px1.p2.1.m1.1.1.2">subscript</csymbol><ci id="A4.SS1.SSS0.Px1.p2.1.m1.1.1.2.2.cmml" xref="A4.SS1.SSS0.Px1.p2.1.m1.1.1.2.2">𝑅</ci><ci id="A4.SS1.SSS0.Px1.p2.1.m1.1.1.2.3.cmml" xref="A4.SS1.SSS0.Px1.p2.1.m1.1.1.2.3">𝑖</ci></apply><apply id="A4.SS1.SSS0.Px1.p2.1.m1.1.1.3.cmml" xref="A4.SS1.SSS0.Px1.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="A4.SS1.SSS0.Px1.p2.1.m1.1.1.3.1.cmml" xref="A4.SS1.SSS0.Px1.p2.1.m1.1.1.3">subscript</csymbol><ci id="A4.SS1.SSS0.Px1.p2.1.m1.1.1.3.2.cmml" xref="A4.SS1.SSS0.Px1.p2.1.m1.1.1.3.2">𝑅</ci><ci id="A4.SS1.SSS0.Px1.p2.1.m1.1.1.3.3.cmml" xref="A4.SS1.SSS0.Px1.p2.1.m1.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.SSS0.Px1.p2.1.m1.1c">R_{i}=R_{k}</annotation><annotation encoding="application/x-llamapun" id="A4.SS1.SSS0.Px1.p2.1.m1.1d">italic_R start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_R start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, the trajectory with the shorter length, <math alttext="N_{i}" class="ltx_Math" display="inline" id="A4.SS1.SSS0.Px1.p2.2.m2.1"><semantics id="A4.SS1.SSS0.Px1.p2.2.m2.1a"><msub id="A4.SS1.SSS0.Px1.p2.2.m2.1.1" xref="A4.SS1.SSS0.Px1.p2.2.m2.1.1.cmml"><mi id="A4.SS1.SSS0.Px1.p2.2.m2.1.1.2" xref="A4.SS1.SSS0.Px1.p2.2.m2.1.1.2.cmml">N</mi><mi id="A4.SS1.SSS0.Px1.p2.2.m2.1.1.3" xref="A4.SS1.SSS0.Px1.p2.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A4.SS1.SSS0.Px1.p2.2.m2.1b"><apply id="A4.SS1.SSS0.Px1.p2.2.m2.1.1.cmml" xref="A4.SS1.SSS0.Px1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="A4.SS1.SSS0.Px1.p2.2.m2.1.1.1.cmml" xref="A4.SS1.SSS0.Px1.p2.2.m2.1.1">subscript</csymbol><ci id="A4.SS1.SSS0.Px1.p2.2.m2.1.1.2.cmml" xref="A4.SS1.SSS0.Px1.p2.2.m2.1.1.2">𝑁</ci><ci id="A4.SS1.SSS0.Px1.p2.2.m2.1.1.3.cmml" xref="A4.SS1.SSS0.Px1.p2.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.SSS0.Px1.p2.2.m2.1c">N_{i}</annotation><annotation encoding="application/x-llamapun" id="A4.SS1.SSS0.Px1.p2.2.m2.1d">italic_N start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> or <math alttext="N_{k}" class="ltx_Math" display="inline" id="A4.SS1.SSS0.Px1.p2.3.m3.1"><semantics id="A4.SS1.SSS0.Px1.p2.3.m3.1a"><msub id="A4.SS1.SSS0.Px1.p2.3.m3.1.1" xref="A4.SS1.SSS0.Px1.p2.3.m3.1.1.cmml"><mi id="A4.SS1.SSS0.Px1.p2.3.m3.1.1.2" xref="A4.SS1.SSS0.Px1.p2.3.m3.1.1.2.cmml">N</mi><mi id="A4.SS1.SSS0.Px1.p2.3.m3.1.1.3" xref="A4.SS1.SSS0.Px1.p2.3.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="A4.SS1.SSS0.Px1.p2.3.m3.1b"><apply id="A4.SS1.SSS0.Px1.p2.3.m3.1.1.cmml" xref="A4.SS1.SSS0.Px1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="A4.SS1.SSS0.Px1.p2.3.m3.1.1.1.cmml" xref="A4.SS1.SSS0.Px1.p2.3.m3.1.1">subscript</csymbol><ci id="A4.SS1.SSS0.Px1.p2.3.m3.1.1.2.cmml" xref="A4.SS1.SSS0.Px1.p2.3.m3.1.1.2">𝑁</ci><ci id="A4.SS1.SSS0.Px1.p2.3.m3.1.1.3.cmml" xref="A4.SS1.SSS0.Px1.p2.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.SSS0.Px1.p2.3.m3.1c">N_{k}</annotation><annotation encoding="application/x-llamapun" id="A4.SS1.SSS0.Px1.p2.3.m3.1d">italic_N start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, replaces the longer one; if <math alttext="R_{i}&lt;R_{k}" class="ltx_Math" display="inline" id="A4.SS1.SSS0.Px1.p2.4.m4.1"><semantics id="A4.SS1.SSS0.Px1.p2.4.m4.1a"><mrow id="A4.SS1.SSS0.Px1.p2.4.m4.1.1" xref="A4.SS1.SSS0.Px1.p2.4.m4.1.1.cmml"><msub id="A4.SS1.SSS0.Px1.p2.4.m4.1.1.2" xref="A4.SS1.SSS0.Px1.p2.4.m4.1.1.2.cmml"><mi id="A4.SS1.SSS0.Px1.p2.4.m4.1.1.2.2" xref="A4.SS1.SSS0.Px1.p2.4.m4.1.1.2.2.cmml">R</mi><mi id="A4.SS1.SSS0.Px1.p2.4.m4.1.1.2.3" xref="A4.SS1.SSS0.Px1.p2.4.m4.1.1.2.3.cmml">i</mi></msub><mo id="A4.SS1.SSS0.Px1.p2.4.m4.1.1.1" xref="A4.SS1.SSS0.Px1.p2.4.m4.1.1.1.cmml">&lt;</mo><msub id="A4.SS1.SSS0.Px1.p2.4.m4.1.1.3" xref="A4.SS1.SSS0.Px1.p2.4.m4.1.1.3.cmml"><mi id="A4.SS1.SSS0.Px1.p2.4.m4.1.1.3.2" xref="A4.SS1.SSS0.Px1.p2.4.m4.1.1.3.2.cmml">R</mi><mi id="A4.SS1.SSS0.Px1.p2.4.m4.1.1.3.3" xref="A4.SS1.SSS0.Px1.p2.4.m4.1.1.3.3.cmml">k</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A4.SS1.SSS0.Px1.p2.4.m4.1b"><apply id="A4.SS1.SSS0.Px1.p2.4.m4.1.1.cmml" xref="A4.SS1.SSS0.Px1.p2.4.m4.1.1"><lt id="A4.SS1.SSS0.Px1.p2.4.m4.1.1.1.cmml" xref="A4.SS1.SSS0.Px1.p2.4.m4.1.1.1"></lt><apply id="A4.SS1.SSS0.Px1.p2.4.m4.1.1.2.cmml" xref="A4.SS1.SSS0.Px1.p2.4.m4.1.1.2"><csymbol cd="ambiguous" id="A4.SS1.SSS0.Px1.p2.4.m4.1.1.2.1.cmml" xref="A4.SS1.SSS0.Px1.p2.4.m4.1.1.2">subscript</csymbol><ci id="A4.SS1.SSS0.Px1.p2.4.m4.1.1.2.2.cmml" xref="A4.SS1.SSS0.Px1.p2.4.m4.1.1.2.2">𝑅</ci><ci id="A4.SS1.SSS0.Px1.p2.4.m4.1.1.2.3.cmml" xref="A4.SS1.SSS0.Px1.p2.4.m4.1.1.2.3">𝑖</ci></apply><apply id="A4.SS1.SSS0.Px1.p2.4.m4.1.1.3.cmml" xref="A4.SS1.SSS0.Px1.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="A4.SS1.SSS0.Px1.p2.4.m4.1.1.3.1.cmml" xref="A4.SS1.SSS0.Px1.p2.4.m4.1.1.3">subscript</csymbol><ci id="A4.SS1.SSS0.Px1.p2.4.m4.1.1.3.2.cmml" xref="A4.SS1.SSS0.Px1.p2.4.m4.1.1.3.2">𝑅</ci><ci id="A4.SS1.SSS0.Px1.p2.4.m4.1.1.3.3.cmml" xref="A4.SS1.SSS0.Px1.p2.4.m4.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.SSS0.Px1.p2.4.m4.1c">R_{i}&lt;R_{k}</annotation><annotation encoding="application/x-llamapun" id="A4.SS1.SSS0.Px1.p2.4.m4.1d">italic_R start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT &lt; italic_R start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, the entire trajectory <math alttext="T_{i}" class="ltx_Math" display="inline" id="A4.SS1.SSS0.Px1.p2.5.m5.1"><semantics id="A4.SS1.SSS0.Px1.p2.5.m5.1a"><msub id="A4.SS1.SSS0.Px1.p2.5.m5.1.1" xref="A4.SS1.SSS0.Px1.p2.5.m5.1.1.cmml"><mi id="A4.SS1.SSS0.Px1.p2.5.m5.1.1.2" xref="A4.SS1.SSS0.Px1.p2.5.m5.1.1.2.cmml">T</mi><mi id="A4.SS1.SSS0.Px1.p2.5.m5.1.1.3" xref="A4.SS1.SSS0.Px1.p2.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A4.SS1.SSS0.Px1.p2.5.m5.1b"><apply id="A4.SS1.SSS0.Px1.p2.5.m5.1.1.cmml" xref="A4.SS1.SSS0.Px1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="A4.SS1.SSS0.Px1.p2.5.m5.1.1.1.cmml" xref="A4.SS1.SSS0.Px1.p2.5.m5.1.1">subscript</csymbol><ci id="A4.SS1.SSS0.Px1.p2.5.m5.1.1.2.cmml" xref="A4.SS1.SSS0.Px1.p2.5.m5.1.1.2">𝑇</ci><ci id="A4.SS1.SSS0.Px1.p2.5.m5.1.1.3.cmml" xref="A4.SS1.SSS0.Px1.p2.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.SSS0.Px1.p2.5.m5.1c">T_{i}</annotation><annotation encoding="application/x-llamapun" id="A4.SS1.SSS0.Px1.p2.5.m5.1d">italic_T start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is replaced by <math alttext="T_{k}" class="ltx_Math" display="inline" id="A4.SS1.SSS0.Px1.p2.6.m6.1"><semantics id="A4.SS1.SSS0.Px1.p2.6.m6.1a"><msub id="A4.SS1.SSS0.Px1.p2.6.m6.1.1" xref="A4.SS1.SSS0.Px1.p2.6.m6.1.1.cmml"><mi id="A4.SS1.SSS0.Px1.p2.6.m6.1.1.2" xref="A4.SS1.SSS0.Px1.p2.6.m6.1.1.2.cmml">T</mi><mi id="A4.SS1.SSS0.Px1.p2.6.m6.1.1.3" xref="A4.SS1.SSS0.Px1.p2.6.m6.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="A4.SS1.SSS0.Px1.p2.6.m6.1b"><apply id="A4.SS1.SSS0.Px1.p2.6.m6.1.1.cmml" xref="A4.SS1.SSS0.Px1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="A4.SS1.SSS0.Px1.p2.6.m6.1.1.1.cmml" xref="A4.SS1.SSS0.Px1.p2.6.m6.1.1">subscript</csymbol><ci id="A4.SS1.SSS0.Px1.p2.6.m6.1.1.2.cmml" xref="A4.SS1.SSS0.Px1.p2.6.m6.1.1.2">𝑇</ci><ci id="A4.SS1.SSS0.Px1.p2.6.m6.1.1.3.cmml" xref="A4.SS1.SSS0.Px1.p2.6.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.SSS0.Px1.p2.6.m6.1c">T_{k}</annotation><annotation encoding="application/x-llamapun" id="A4.SS1.SSS0.Px1.p2.6.m6.1d">italic_T start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>. The buffer <math alttext="G" class="ltx_Math" display="inline" id="A4.SS1.SSS0.Px1.p2.7.m7.1"><semantics id="A4.SS1.SSS0.Px1.p2.7.m7.1a"><mi id="A4.SS1.SSS0.Px1.p2.7.m7.1.1" xref="A4.SS1.SSS0.Px1.p2.7.m7.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="A4.SS1.SSS0.Px1.p2.7.m7.1b"><ci id="A4.SS1.SSS0.Px1.p2.7.m7.1.1.cmml" xref="A4.SS1.SSS0.Px1.p2.7.m7.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.SSS0.Px1.p2.7.m7.1c">G</annotation><annotation encoding="application/x-llamapun" id="A4.SS1.SSS0.Px1.p2.7.m7.1d">italic_G</annotation></semantics></math> is used for training both the Prediction Network and the Reflection Network.</p>
</div>
</section>
<section class="ltx_paragraph" id="A4.SS1.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Reflection Buffer:</h5>
<div class="ltx_para ltx_noindent" id="A4.SS1.SSS0.Px2.p1">
<p class="ltx_p" id="A4.SS1.SSS0.Px2.p1.1">In addition to utilizing successful experiences to optimize policies, it is crucial to repeatedly reflect on failed experiences until the agent learns to avoid potential risks, thereby creating more opportunities for deeper exploration. Therefore, unlike existing memory mechanisms focusing solely on advantageous experiences, our approach also emphasizes learning from failures. The buffer <math alttext="R" class="ltx_Math" display="inline" id="A4.SS1.SSS0.Px2.p1.1.m1.1"><semantics id="A4.SS1.SSS0.Px2.p1.1.m1.1a"><mi id="A4.SS1.SSS0.Px2.p1.1.m1.1.1" xref="A4.SS1.SSS0.Px2.p1.1.m1.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="A4.SS1.SSS0.Px2.p1.1.m1.1b"><ci id="A4.SS1.SSS0.Px2.p1.1.m1.1.1.cmml" xref="A4.SS1.SSS0.Px2.p1.1.m1.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.SSS0.Px2.p1.1.m1.1c">R</annotation><annotation encoding="application/x-llamapun" id="A4.SS1.SSS0.Px2.p1.1.m1.1d">italic_R</annotation></semantics></math> maintains a certain amount of failed prediction experiences. These experiences result from the Reflection Network’s incorrect assessments of predicted actions. The failed experiences are repeatedly fed into the Reflection Network for training until the predictions are accurate, and the agent learns to avoid dangers.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="A4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.2 </span>Visualization of Experimental Environments Setup</h3>
<section class="ltx_paragraph" id="A4.SS2.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Dark Chamber.</h5>
<div class="ltx_para ltx_noindent" id="A4.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="A4.SS2.SSS0.Px1.p1.1">To demonstrate the exploration capabilities of various algorithms in a reward-free environment, we constructed the <em class="ltx_emph ltx_font_italic" id="A4.SS2.SSS0.Px1.p1.1.1">Dark Chamber</em> environment, as shown in Figure  <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#A5.F11" title="Figure 11 ‣ Appendix E AdaMemento vs. Baseline Performance in All Atari Environments ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_tag">11</span></a>. This environment is 50x50 in size, with no rewards or penalties. The agent starts exploring from the bottom left, where unexplored areas are represented as black fog, and the color of explored areas gradually lightens based on exploration density.</p>
</div>
</section>
<section class="ltx_paragraph" id="A4.SS2.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Four Rooms.</h5>
<div class="ltx_para ltx_noindent" id="A4.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="A4.SS2.SSS0.Px2.p1.1">To further evaluate the agent’s exploration ability in a complex environment with sparse rewards and obstacles, we selected the <em class="ltx_emph ltx_font_italic" id="A4.SS2.SSS0.Px2.p1.1.1">Four Rooms</em> environment for comparative visualization experiments, as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#A5.F12" title="Figure 12 ‣ Appendix E AdaMemento vs. Baseline Performance in All Atari Environments ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_tag">12</span></a>. The agent starts from point S in the upper right, explores the environment, avoids the cross-shaped wall in the middle, and passes through the small doorway to reach the goal in the lower left for a reward.</p>
</div>
</section>
<section class="ltx_paragraph" id="A4.SS2.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Cliff Walking.</h5>
<div class="ltx_para ltx_noindent" id="A4.SS2.SSS0.Px3.p1">
<p class="ltx_p" id="A4.SS2.SSS0.Px3.p1.1">The Cliff Walking environment, filled with cliff traps, was selected as the visualization platform to evaluate the memory-reflection mechanism, as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#S4.F9" title="Figure 9 ‣ Cliff Walking. ‣ 4.1.2 Visualization of memory-reflection ‣ 4.1 Visualization Analysis ‣ 4 Experiments ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_tag">9</span></a>(a). In this environment, the gray areas represent cliffs, and the agent must move from point S to point G. To succeed, the agent needs to learn to avoid dangers while reaching goal G using a relatively short path, making this environment highly suitable for verifying the effectiveness of the memory-reflection mechanism.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="A4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.3 </span>Algorithm Description</h3>
<div class="ltx_para" id="A4.SS3.p1">
<p class="ltx_p" id="A4.SS3.p1.1">The algorithmic process of AdaMemento can be seen in Algorithm  <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#alg1" title="Algorithm 1 ‣ D.3 Algorithm Description ‣ Appendix D Supplementary Experiment Details ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span> </span> AdaMemento: Adaptive Memory-Assisted Policy Optimization</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.3">
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline">1:</span>Environment <math alttext="\mathcal{E}" class="ltx_Math" display="inline" id="alg1.l1.m1.1"><semantics id="alg1.l1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">ℰ</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">ℰ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">\mathcal{E}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.1d">caligraphic_E</annotation></semantics></math>, Policy Network Parameters <math alttext="\theta" class="ltx_Math" display="inline" id="alg1.l1.m2.1"><semantics id="alg1.l1.m2.1a"><mi id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><ci id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m2.1d">italic_θ</annotation></semantics></math>, Discount Factor <math alttext="\gamma" class="ltx_Math" display="inline" id="alg1.l1.m3.1"><semantics id="alg1.l1.m3.1a"><mi id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><ci id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m3.1d">italic_γ</annotation></semantics></math>, Batch Size <math alttext="n" class="ltx_Math" display="inline" id="alg1.l1.m4.1"><semantics id="alg1.l1.m4.1a"><mi id="alg1.l1.m4.1.1" xref="alg1.l1.m4.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m4.1b"><ci id="alg1.l1.m4.1.1.cmml" xref="alg1.l1.m4.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m4.1c">n</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m4.1d">italic_n</annotation></semantics></math>, Memory Buffer <math alttext="M" class="ltx_Math" display="inline" id="alg1.l1.m5.1"><semantics id="alg1.l1.m5.1a"><mi id="alg1.l1.m5.1.1" xref="alg1.l1.m5.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m5.1b"><ci id="alg1.l1.m5.1.1.cmml" xref="alg1.l1.m5.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m5.1c">M</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m5.1d">italic_M</annotation></semantics></math>, Reflection Buffer <math alttext="R" class="ltx_Math" display="inline" id="alg1.l1.m6.1"><semantics id="alg1.l1.m6.1a"><mi id="alg1.l1.m6.1.1" xref="alg1.l1.m6.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m6.1b"><ci id="alg1.l1.m6.1.1.cmml" xref="alg1.l1.m6.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m6.1c">R</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m6.1d">italic_R</annotation></semantics></math>, Intrinsic Reward Parameter <math alttext="\beta" class="ltx_Math" display="inline" id="alg1.l1.m7.1"><semantics id="alg1.l1.m7.1a"><mi id="alg1.l1.m7.1.1" xref="alg1.l1.m7.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m7.1b"><ci id="alg1.l1.m7.1.1.cmml" xref="alg1.l1.m7.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m7.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m7.1d">italic_β</annotation></semantics></math>, Learning Rate <math alttext="\alpha" class="ltx_Math" display="inline" id="alg1.l1.m8.1"><semantics id="alg1.l1.m8.1a"><mi id="alg1.l1.m8.1.1" xref="alg1.l1.m8.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m8.1b"><ci id="alg1.l1.m8.1.1.cmml" xref="alg1.l1.m8.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m8.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m8.1d">italic_α</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline">2:</span><span class="ltx_text ltx_font_bold" id="alg1.l2.1">Initialization:</span>
</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline">3:</span>Initialize policy network parameters <math alttext="\theta" class="ltx_Math" display="inline" id="alg1.l3.m1.1"><semantics id="alg1.l3.m1.1a"><mi id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><ci id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.1d">italic_θ</annotation></semantics></math>, memory buffer <math alttext="M" class="ltx_Math" display="inline" id="alg1.l3.m2.1"><semantics id="alg1.l3.m2.1a"><mi id="alg1.l3.m2.1.1" xref="alg1.l3.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="alg1.l3.m2.1b"><ci id="alg1.l3.m2.1.1.cmml" xref="alg1.l3.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m2.1c">M</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m2.1d">italic_M</annotation></semantics></math>, reflection buffer <math alttext="R" class="ltx_Math" display="inline" id="alg1.l3.m3.1"><semantics id="alg1.l3.m3.1a"><mi id="alg1.l3.m3.1.1" xref="alg1.l3.m3.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="alg1.l3.m3.1b"><ci id="alg1.l3.m3.1.1.cmml" xref="alg1.l3.m3.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m3.1c">R</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m3.1d">italic_R</annotation></semantics></math>, intrinsic reward parameter <math alttext="\beta" class="ltx_Math" display="inline" id="alg1.l3.m4.1"><semantics id="alg1.l3.m4.1a"><mi id="alg1.l3.m4.1.1" xref="alg1.l3.m4.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="alg1.l3.m4.1b"><ci id="alg1.l3.m4.1.1.cmml" xref="alg1.l3.m4.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m4.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m4.1d">italic_β</annotation></semantics></math>, learning rate <math alttext="\alpha" class="ltx_Math" display="inline" id="alg1.l3.m5.1"><semantics id="alg1.l3.m5.1a"><mi id="alg1.l3.m5.1.1" xref="alg1.l3.m5.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="alg1.l3.m5.1b"><ci id="alg1.l3.m5.1.1.cmml" xref="alg1.l3.m5.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m5.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m5.1d">italic_α</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline">4:</span><span class="ltx_text ltx_font_bold" id="alg1.l4.1">for</span> <math alttext="t=0,1,2,\dots" class="ltx_Math" display="inline" id="alg1.l4.m1.4"><semantics id="alg1.l4.m1.4a"><mrow id="alg1.l4.m1.4.5" xref="alg1.l4.m1.4.5.cmml"><mi id="alg1.l4.m1.4.5.2" xref="alg1.l4.m1.4.5.2.cmml">t</mi><mo id="alg1.l4.m1.4.5.1" xref="alg1.l4.m1.4.5.1.cmml">=</mo><mrow id="alg1.l4.m1.4.5.3.2" xref="alg1.l4.m1.4.5.3.1.cmml"><mn id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">0</mn><mo id="alg1.l4.m1.4.5.3.2.1" xref="alg1.l4.m1.4.5.3.1.cmml">,</mo><mn id="alg1.l4.m1.2.2" xref="alg1.l4.m1.2.2.cmml">1</mn><mo id="alg1.l4.m1.4.5.3.2.2" xref="alg1.l4.m1.4.5.3.1.cmml">,</mo><mn id="alg1.l4.m1.3.3" xref="alg1.l4.m1.3.3.cmml">2</mn><mo id="alg1.l4.m1.4.5.3.2.3" xref="alg1.l4.m1.4.5.3.1.cmml">,</mo><mi id="alg1.l4.m1.4.4" mathvariant="normal" xref="alg1.l4.m1.4.4.cmml">…</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.4b"><apply id="alg1.l4.m1.4.5.cmml" xref="alg1.l4.m1.4.5"><eq id="alg1.l4.m1.4.5.1.cmml" xref="alg1.l4.m1.4.5.1"></eq><ci id="alg1.l4.m1.4.5.2.cmml" xref="alg1.l4.m1.4.5.2">𝑡</ci><list id="alg1.l4.m1.4.5.3.1.cmml" xref="alg1.l4.m1.4.5.3.2"><cn id="alg1.l4.m1.1.1.cmml" type="integer" xref="alg1.l4.m1.1.1">0</cn><cn id="alg1.l4.m1.2.2.cmml" type="integer" xref="alg1.l4.m1.2.2">1</cn><cn id="alg1.l4.m1.3.3.cmml" type="integer" xref="alg1.l4.m1.3.3">2</cn><ci id="alg1.l4.m1.4.4.cmml" xref="alg1.l4.m1.4.4">…</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.4c">t=0,1,2,\dots</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.4d">italic_t = 0 , 1 , 2 , …</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l4.2">do</span>
</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline">5:</span>     <span class="ltx_text ltx_font_bold" id="alg1.l5.1">1. Data Collection:</span>
</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline">6:</span>     Use current policy <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="alg1.l6.m1.1"><semantics id="alg1.l6.m1.1a"><msub id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><mi id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml">π</mi><mi id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1">subscript</csymbol><ci id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2">𝜋</ci><ci id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> to interact with environment <math alttext="\mathcal{E}" class="ltx_Math" display="inline" id="alg1.l6.m2.1"><semantics id="alg1.l6.m2.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l6.m2.1.1" xref="alg1.l6.m2.1.1.cmml">ℰ</mi><annotation-xml encoding="MathML-Content" id="alg1.l6.m2.1b"><ci id="alg1.l6.m2.1.1.cmml" xref="alg1.l6.m2.1.1">ℰ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m2.1c">\mathcal{E}</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m2.1d">caligraphic_E</annotation></semantics></math> and collect <math alttext="n" class="ltx_Math" display="inline" id="alg1.l6.m3.1"><semantics id="alg1.l6.m3.1a"><mi id="alg1.l6.m3.1.1" xref="alg1.l6.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="alg1.l6.m3.1b"><ci id="alg1.l6.m3.1.1.cmml" xref="alg1.l6.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m3.1c">n</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m3.1d">italic_n</annotation></semantics></math> trajectories.

</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline">7:</span>     <span class="ltx_text ltx_font_bold" id="alg1.l7.1">2. Memory Reflection Module:</span>
</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline">8:</span>     Sample from memory buffer <math alttext="M" class="ltx_Math" display="inline" id="alg1.l8.m1.1"><semantics id="alg1.l8.m1.1a"><mi id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><ci id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.1d">italic_M</annotation></semantics></math> to update <span class="ltx_text ltx_font_bold" id="alg1.l8.1">Predictive Network</span>, summarizing shared experiences across trajectories.

</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline">9:</span>     Sample from both memory buffer <math alttext="M" class="ltx_Math" display="inline" id="alg1.l9.m1.1"><semantics id="alg1.l9.m1.1a"><mi id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><ci id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m1.1d">italic_M</annotation></semantics></math> and reflection buffer <math alttext="R" class="ltx_Math" display="inline" id="alg1.l9.m2.1"><semantics id="alg1.l9.m2.1a"><mi id="alg1.l9.m2.1.1" xref="alg1.l9.m2.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="alg1.l9.m2.1b"><ci id="alg1.l9.m2.1.1.cmml" xref="alg1.l9.m2.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m2.1c">R</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m2.1d">italic_R</annotation></semantics></math> to update <span class="ltx_text ltx_font_bold" id="alg1.l9.1">Reflection Network</span>, adjusting action confidence based on predictive error.

</div>
<div class="ltx_listingline" id="alg1.l10">
<span class="ltx_tag ltx_tag_listingline">10:</span>     <span class="ltx_text ltx_font_bold" id="alg1.l10.1">3. Coarse-fine distinction module:</span>
</div>
<div class="ltx_listingline" id="alg1.l11">
<span class="ltx_tag ltx_tag_listingline">11:</span>     Compute reward based on state reconstruction error and sparsity to encourage exploration of low-density states.

</div>
<div class="ltx_listingline" id="alg1.l12">
<span class="ltx_tag ltx_tag_listingline">12:</span>     Promote exploration of states with high novelty or insufficient exploration.

</div>
<div class="ltx_listingline" id="alg1.l13">
<span class="ltx_tag ltx_tag_listingline">13:</span>     <span class="ltx_text ltx_font_bold" id="alg1.l13.1">4. Exploration-Exploitation ensemble learning:</span>
</div>
<div class="ltx_listingline" id="alg1.l14">
<span class="ltx_tag ltx_tag_listingline">14:</span>     Based on the confidence level of the Reflection Network, adaptively select actions from memory, reflection, or stochastic policies.

</div>
<div class="ltx_listingline" id="alg1.l15">
<span class="ltx_tag ltx_tag_listingline">15:</span>     Update policy network parameters <math alttext="\theta" class="ltx_Math" display="inline" id="alg1.l15.m1.1"><semantics id="alg1.l15.m1.1a"><mi id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.1b"><ci id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="alg1.l15.m1.1d">italic_θ</annotation></semantics></math> by the following rule:

<table class="ltx_equation ltx_eqn_table" id="A4.Ex21">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\theta\leftarrow\theta+\alpha\nabla_{\theta}\mathcal{L}(\pi_{\theta})" class="ltx_Math" display="block" id="A4.Ex21.m1.1"><semantics id="A4.Ex21.m1.1a"><mrow id="A4.Ex21.m1.1.1" xref="A4.Ex21.m1.1.1.cmml"><mi id="A4.Ex21.m1.1.1.3" xref="A4.Ex21.m1.1.1.3.cmml">θ</mi><mo id="A4.Ex21.m1.1.1.2" stretchy="false" xref="A4.Ex21.m1.1.1.2.cmml">←</mo><mrow id="A4.Ex21.m1.1.1.1" xref="A4.Ex21.m1.1.1.1.cmml"><mi id="A4.Ex21.m1.1.1.1.3" xref="A4.Ex21.m1.1.1.1.3.cmml">θ</mi><mo id="A4.Ex21.m1.1.1.1.2" xref="A4.Ex21.m1.1.1.1.2.cmml">+</mo><mrow id="A4.Ex21.m1.1.1.1.1" xref="A4.Ex21.m1.1.1.1.1.cmml"><mi id="A4.Ex21.m1.1.1.1.1.3" xref="A4.Ex21.m1.1.1.1.1.3.cmml">α</mi><mo id="A4.Ex21.m1.1.1.1.1.2" lspace="0.167em" xref="A4.Ex21.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="A4.Ex21.m1.1.1.1.1.4" xref="A4.Ex21.m1.1.1.1.1.4.cmml"><msub id="A4.Ex21.m1.1.1.1.1.4.1" xref="A4.Ex21.m1.1.1.1.1.4.1.cmml"><mo id="A4.Ex21.m1.1.1.1.1.4.1.2" rspace="0.167em" xref="A4.Ex21.m1.1.1.1.1.4.1.2.cmml">∇</mo><mi id="A4.Ex21.m1.1.1.1.1.4.1.3" xref="A4.Ex21.m1.1.1.1.1.4.1.3.cmml">θ</mi></msub><mi class="ltx_font_mathcaligraphic" id="A4.Ex21.m1.1.1.1.1.4.2" xref="A4.Ex21.m1.1.1.1.1.4.2.cmml">ℒ</mi></mrow><mo id="A4.Ex21.m1.1.1.1.1.2a" xref="A4.Ex21.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="A4.Ex21.m1.1.1.1.1.1.1" xref="A4.Ex21.m1.1.1.1.1.1.1.1.cmml"><mo id="A4.Ex21.m1.1.1.1.1.1.1.2" stretchy="false" xref="A4.Ex21.m1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A4.Ex21.m1.1.1.1.1.1.1.1" xref="A4.Ex21.m1.1.1.1.1.1.1.1.cmml"><mi id="A4.Ex21.m1.1.1.1.1.1.1.1.2" xref="A4.Ex21.m1.1.1.1.1.1.1.1.2.cmml">π</mi><mi id="A4.Ex21.m1.1.1.1.1.1.1.1.3" xref="A4.Ex21.m1.1.1.1.1.1.1.1.3.cmml">θ</mi></msub><mo id="A4.Ex21.m1.1.1.1.1.1.1.3" stretchy="false" xref="A4.Ex21.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.Ex21.m1.1b"><apply id="A4.Ex21.m1.1.1.cmml" xref="A4.Ex21.m1.1.1"><ci id="A4.Ex21.m1.1.1.2.cmml" xref="A4.Ex21.m1.1.1.2">←</ci><ci id="A4.Ex21.m1.1.1.3.cmml" xref="A4.Ex21.m1.1.1.3">𝜃</ci><apply id="A4.Ex21.m1.1.1.1.cmml" xref="A4.Ex21.m1.1.1.1"><plus id="A4.Ex21.m1.1.1.1.2.cmml" xref="A4.Ex21.m1.1.1.1.2"></plus><ci id="A4.Ex21.m1.1.1.1.3.cmml" xref="A4.Ex21.m1.1.1.1.3">𝜃</ci><apply id="A4.Ex21.m1.1.1.1.1.cmml" xref="A4.Ex21.m1.1.1.1.1"><times id="A4.Ex21.m1.1.1.1.1.2.cmml" xref="A4.Ex21.m1.1.1.1.1.2"></times><ci id="A4.Ex21.m1.1.1.1.1.3.cmml" xref="A4.Ex21.m1.1.1.1.1.3">𝛼</ci><apply id="A4.Ex21.m1.1.1.1.1.4.cmml" xref="A4.Ex21.m1.1.1.1.1.4"><apply id="A4.Ex21.m1.1.1.1.1.4.1.cmml" xref="A4.Ex21.m1.1.1.1.1.4.1"><csymbol cd="ambiguous" id="A4.Ex21.m1.1.1.1.1.4.1.1.cmml" xref="A4.Ex21.m1.1.1.1.1.4.1">subscript</csymbol><ci id="A4.Ex21.m1.1.1.1.1.4.1.2.cmml" xref="A4.Ex21.m1.1.1.1.1.4.1.2">∇</ci><ci id="A4.Ex21.m1.1.1.1.1.4.1.3.cmml" xref="A4.Ex21.m1.1.1.1.1.4.1.3">𝜃</ci></apply><ci id="A4.Ex21.m1.1.1.1.1.4.2.cmml" xref="A4.Ex21.m1.1.1.1.1.4.2">ℒ</ci></apply><apply id="A4.Ex21.m1.1.1.1.1.1.1.1.cmml" xref="A4.Ex21.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.Ex21.m1.1.1.1.1.1.1.1.1.cmml" xref="A4.Ex21.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A4.Ex21.m1.1.1.1.1.1.1.1.2.cmml" xref="A4.Ex21.m1.1.1.1.1.1.1.1.2">𝜋</ci><ci id="A4.Ex21.m1.1.1.1.1.1.1.1.3.cmml" xref="A4.Ex21.m1.1.1.1.1.1.1.1.3">𝜃</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.Ex21.m1.1c">\theta\leftarrow\theta+\alpha\nabla_{\theta}\mathcal{L}(\pi_{\theta})</annotation><annotation encoding="application/x-llamapun" id="A4.Ex21.m1.1d">italic_θ ← italic_θ + italic_α ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT caligraphic_L ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
where <math alttext="\mathcal{L}(\pi_{\theta})" class="ltx_Math" display="inline" id="alg1.l15.m2.1"><semantics id="alg1.l15.m2.1a"><mrow id="alg1.l15.m2.1.1" xref="alg1.l15.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l15.m2.1.1.3" xref="alg1.l15.m2.1.1.3.cmml">ℒ</mi><mo id="alg1.l15.m2.1.1.2" xref="alg1.l15.m2.1.1.2.cmml">⁢</mo><mrow id="alg1.l15.m2.1.1.1.1" xref="alg1.l15.m2.1.1.1.1.1.cmml"><mo id="alg1.l15.m2.1.1.1.1.2" stretchy="false" xref="alg1.l15.m2.1.1.1.1.1.cmml">(</mo><msub id="alg1.l15.m2.1.1.1.1.1" xref="alg1.l15.m2.1.1.1.1.1.cmml"><mi id="alg1.l15.m2.1.1.1.1.1.2" xref="alg1.l15.m2.1.1.1.1.1.2.cmml">π</mi><mi id="alg1.l15.m2.1.1.1.1.1.3" xref="alg1.l15.m2.1.1.1.1.1.3.cmml">θ</mi></msub><mo id="alg1.l15.m2.1.1.1.1.3" stretchy="false" xref="alg1.l15.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m2.1b"><apply id="alg1.l15.m2.1.1.cmml" xref="alg1.l15.m2.1.1"><times id="alg1.l15.m2.1.1.2.cmml" xref="alg1.l15.m2.1.1.2"></times><ci id="alg1.l15.m2.1.1.3.cmml" xref="alg1.l15.m2.1.1.3">ℒ</ci><apply id="alg1.l15.m2.1.1.1.1.1.cmml" xref="alg1.l15.m2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l15.m2.1.1.1.1.1.1.cmml" xref="alg1.l15.m2.1.1.1.1">subscript</csymbol><ci id="alg1.l15.m2.1.1.1.1.1.2.cmml" xref="alg1.l15.m2.1.1.1.1.1.2">𝜋</ci><ci id="alg1.l15.m2.1.1.1.1.1.3.cmml" xref="alg1.l15.m2.1.1.1.1.1.3">𝜃</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m2.1c">\mathcal{L}(\pi_{\theta})</annotation><annotation encoding="application/x-llamapun" id="alg1.l15.m2.1d">caligraphic_L ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT )</annotation></semantics></math> is the optimization objective combining memory and intrinsic reward.

</div>
<div class="ltx_listingline" id="alg1.l16">
<span class="ltx_tag ltx_tag_listingline">16:</span><span class="ltx_text ltx_font_bold" id="alg1.l16.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l16.2">for</span>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="A4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.4 </span>Parameter Settings</h3>
<div class="ltx_para" id="A4.SS4.p1">
<p class="ltx_p" id="A4.SS4.p1.1">In this subsection, we present the parameter settings for the primary experimental platform, Atari, used in the majority of this paper. It is important to note that these settings represent only one possible configuration for running AdaMemento and do not necessarily guarantee optimal performance. For detailed parameter settings, see Table  <a class="ltx_ref" href="https://arxiv.org/html/2410.04498v1#A4.T1" title="Table 1 ‣ D.4 Parameter Settings ‣ Appendix D Supplementary Experiment Details ‣ AdaMemento: Adaptive Memory-Assisted Policy Optimization for Reinforcement Learning"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure class="ltx_table" id="A4.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>Hyperparameter Table</figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A4.T1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A4.T1.1.1.1">
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_tt" id="A4.T1.1.1.1.1" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.1.1.1.1">
<span class="ltx_p" id="A4.T1.1.1.1.1.1.1" style="width:198.7pt;">Hyperparameter</span>
</span>
</th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_tt" id="A4.T1.1.1.1.2" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.1.1.2.1">
<span class="ltx_p" id="A4.T1.1.1.1.2.1.1" style="width:198.7pt;">Value</span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A4.T1.1.2.1">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="A4.T1.1.2.1.1" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.2.1.1.1">
<span class="ltx_p" id="A4.T1.1.2.1.1.1.1" style="width:198.7pt;">MaxStepPerEpisode</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="A4.T1.1.2.1.2" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.2.1.2.1">
<span class="ltx_p" id="A4.T1.1.2.1.2.1.1" style="width:198.7pt;">4500</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T1.1.3.2">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.3.2.1" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.3.2.1.1">
<span class="ltx_p" id="A4.T1.1.3.2.1.1.1" style="width:198.7pt;">ExtCoef</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.3.2.2" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.3.2.2.1">
<span class="ltx_p" id="A4.T1.1.3.2.2.1.1" style="width:198.7pt;">2.0</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T1.1.4.3">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.4.3.1" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.4.3.1.1">
<span class="ltx_p" id="A4.T1.1.4.3.1.1.1" style="width:198.7pt;">LearningRate</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.4.3.2" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.4.3.2.1">
<span class="ltx_p" id="A4.T1.1.4.3.2.1.1" style="width:198.7pt;">1e-4</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T1.1.5.4">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.5.4.1" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.5.4.1.1">
<span class="ltx_p" id="A4.T1.1.5.4.1.1.1" style="width:198.7pt;">NumEnv</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.5.4.2" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.5.4.2.1">
<span class="ltx_p" id="A4.T1.1.5.4.2.1.1" style="width:198.7pt;">32</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T1.1.6.5">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.6.5.1" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.6.5.1.1">
<span class="ltx_p" id="A4.T1.1.6.5.1.1.1" style="width:198.7pt;">NumStep</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.6.5.2" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.6.5.2.1">
<span class="ltx_p" id="A4.T1.1.6.5.2.1.1" style="width:198.7pt;">128</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T1.1.7.6">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.7.6.1" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.7.6.1.1">
<span class="ltx_p" id="A4.T1.1.7.6.1.1.1" style="width:198.7pt;">Gamma</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.7.6.2" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.7.6.2.1">
<span class="ltx_p" id="A4.T1.1.7.6.2.1.1" style="width:198.7pt;">0.999</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T1.1.8.7">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.8.7.1" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.8.7.1.1">
<span class="ltx_p" id="A4.T1.1.8.7.1.1.1" style="width:198.7pt;">IntGamma</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.8.7.2" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.8.7.2.1">
<span class="ltx_p" id="A4.T1.1.8.7.2.1.1" style="width:198.7pt;">0.99</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T1.1.9.8">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.9.8.1" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.9.8.1.1">
<span class="ltx_p" id="A4.T1.1.9.8.1.1.1" style="width:198.7pt;">Lambda</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.9.8.2" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.9.8.2.1">
<span class="ltx_p" id="A4.T1.1.9.8.2.1.1" style="width:198.7pt;">0.95</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T1.1.10.9">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.10.9.1" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.10.9.1.1">
<span class="ltx_p" id="A4.T1.1.10.9.1.1.1" style="width:198.7pt;">StableEps</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.10.9.2" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.10.9.2.1">
<span class="ltx_p" id="A4.T1.1.10.9.2.1.1" style="width:198.7pt;">1e-8</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T1.1.11.10">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.11.10.1" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.11.10.1.1">
<span class="ltx_p" id="A4.T1.1.11.10.1.1.1" style="width:198.7pt;">StateStackSize</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.11.10.2" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.11.10.2.1">
<span class="ltx_p" id="A4.T1.1.11.10.2.1.1" style="width:198.7pt;">4</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T1.1.12.11">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.12.11.1" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.12.11.1.1">
<span class="ltx_p" id="A4.T1.1.12.11.1.1.1" style="width:198.7pt;">PreProcHeight</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.12.11.2" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.12.11.2.1">
<span class="ltx_p" id="A4.T1.1.12.11.2.1.1" style="width:198.7pt;">84</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T1.1.13.12">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.13.12.1" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.13.12.1.1">
<span class="ltx_p" id="A4.T1.1.13.12.1.1.1" style="width:198.7pt;">ProProcWidth</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.13.12.2" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.13.12.2.1">
<span class="ltx_p" id="A4.T1.1.13.12.2.1.1" style="width:198.7pt;">84</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T1.1.14.13">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.14.13.1" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.14.13.1.1">
<span class="ltx_p" id="A4.T1.1.14.13.1.1.1" style="width:198.7pt;">UseGAE</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.14.13.2" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.14.13.2.1">
<span class="ltx_p" id="A4.T1.1.14.13.2.1.1" style="width:198.7pt;">True</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T1.1.15.14">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.15.14.1" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.15.14.1.1">
<span class="ltx_p" id="A4.T1.1.15.14.1.1.1" style="width:198.7pt;">UseGPU</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.15.14.2" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.15.14.2.1">
<span class="ltx_p" id="A4.T1.1.15.14.2.1.1" style="width:198.7pt;">True</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T1.1.16.15">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.16.15.1" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.16.15.1.1">
<span class="ltx_p" id="A4.T1.1.16.15.1.1.1" style="width:198.7pt;">UseNorm</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.16.15.2" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.16.15.2.1">
<span class="ltx_p" id="A4.T1.1.16.15.2.1.1" style="width:198.7pt;">False</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T1.1.17.16">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.17.16.1" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.17.16.1.1">
<span class="ltx_p" id="A4.T1.1.17.16.1.1.1" style="width:198.7pt;">UseNoisyNet</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.17.16.2" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.17.16.2.1">
<span class="ltx_p" id="A4.T1.1.17.16.2.1.1" style="width:198.7pt;">False</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T1.1.18.17">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.18.17.1" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.18.17.1.1">
<span class="ltx_p" id="A4.T1.1.18.17.1.1.1" style="width:198.7pt;">ClipGradNorm</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.18.17.2" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.18.17.2.1">
<span class="ltx_p" id="A4.T1.1.18.17.2.1.1" style="width:198.7pt;">0.5</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T1.1.19.18">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.19.18.1" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.19.18.1.1">
<span class="ltx_p" id="A4.T1.1.19.18.1.1.1" style="width:198.7pt;">Entropy</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.19.18.2" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.19.18.2.1">
<span class="ltx_p" id="A4.T1.1.19.18.2.1.1" style="width:198.7pt;">0.001</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T1.1.20.19">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.20.19.1" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.20.19.1.1">
<span class="ltx_p" id="A4.T1.1.20.19.1.1.1" style="width:198.7pt;">Epoch</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.20.19.2" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.20.19.2.1">
<span class="ltx_p" id="A4.T1.1.20.19.2.1.1" style="width:198.7pt;">4</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T1.1.21.20">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.21.20.1" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.21.20.1.1">
<span class="ltx_p" id="A4.T1.1.21.20.1.1.1" style="width:198.7pt;">MiniBatch</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.21.20.2" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.21.20.2.1">
<span class="ltx_p" id="A4.T1.1.21.20.2.1.1" style="width:198.7pt;">4</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T1.1.22.21">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.22.21.1" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.22.21.1.1">
<span class="ltx_p" id="A4.T1.1.22.21.1.1.1" style="width:198.7pt;">PPOEps</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.22.21.2" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.22.21.2.1">
<span class="ltx_p" id="A4.T1.1.22.21.2.1.1" style="width:198.7pt;">0.1</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T1.1.23.22">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.23.22.1" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.23.22.1.1">
<span class="ltx_p" id="A4.T1.1.23.22.1.1.1" style="width:198.7pt;">IntCoef</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.23.22.2" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.23.22.2.1">
<span class="ltx_p" id="A4.T1.1.23.22.2.1.1" style="width:198.7pt;">1.0</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T1.1.24.23">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.24.23.1" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.24.23.1.1">
<span class="ltx_p" id="A4.T1.1.24.23.1.1.1" style="width:198.7pt;">StickyAction</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.24.23.2" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.24.23.2.1">
<span class="ltx_p" id="A4.T1.1.24.23.2.1.1" style="width:198.7pt;">True</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T1.1.25.24">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.25.24.1" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.25.24.1.1">
<span class="ltx_p" id="A4.T1.1.25.24.1.1.1" style="width:198.7pt;">ActionProb</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.25.24.2" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.25.24.2.1">
<span class="ltx_p" id="A4.T1.1.25.24.2.1.1" style="width:198.7pt;">0.25</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T1.1.26.25">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.26.25.1" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.26.25.1.1">
<span class="ltx_p" id="A4.T1.1.26.25.1.1.1" style="width:198.7pt;">UpdateProportion</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.26.25.2" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.26.25.2.1">
<span class="ltx_p" id="A4.T1.1.26.25.2.1.1" style="width:198.7pt;">0.25</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T1.1.27.26">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.27.26.1" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.27.26.1.1">
<span class="ltx_p" id="A4.T1.1.27.26.1.1.1" style="width:198.7pt;">ObsNormStep</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.27.26.2" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.27.26.2.1">
<span class="ltx_p" id="A4.T1.1.27.26.2.1.1" style="width:198.7pt;">50</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T1.1.28.27">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.28.27.1" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.28.27.1.1">
<span class="ltx_p" id="A4.T1.1.28.27.1.1.1" style="width:198.7pt;">Confidence</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.28.27.2" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.28.27.2.1">
<span class="ltx_p" id="A4.T1.1.28.27.2.1.1" style="width:198.7pt;">0.85</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T1.1.29.28">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.29.28.1" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.29.28.1.1">
<span class="ltx_p" id="A4.T1.1.29.28.1.1.1" style="width:198.7pt;">GoodBufferSize</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.29.28.2" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.29.28.2.1">
<span class="ltx_p" id="A4.T1.1.29.28.2.1.1" style="width:198.7pt;">10</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T1.1.30.29">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.30.29.1" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.30.29.1.1">
<span class="ltx_p" id="A4.T1.1.30.29.1.1.1" style="width:198.7pt;">BadBufferSize</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.30.29.2" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.30.29.2.1">
<span class="ltx_p" id="A4.T1.1.30.29.2.1.1" style="width:198.7pt;">5000</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T1.1.31.30">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.31.30.1" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.31.30.1.1">
<span class="ltx_p" id="A4.T1.1.31.30.1.1.1" style="width:198.7pt;">GoodBufferBatchSize</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.31.30.2" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.31.30.2.1">
<span class="ltx_p" id="A4.T1.1.31.30.2.1.1" style="width:198.7pt;">1</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T1.1.32.31">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.32.31.1" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.32.31.1.1">
<span class="ltx_p" id="A4.T1.1.32.31.1.1.1" style="width:198.7pt;">BadBufferBatchSize</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.32.31.2" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.32.31.2.1">
<span class="ltx_p" id="A4.T1.1.32.31.2.1.1" style="width:198.7pt;">128</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T1.1.33.32">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.33.32.1" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.33.32.1.1">
<span class="ltx_p" id="A4.T1.1.33.32.1.1.1" style="width:198.7pt;">CommonBufferSize</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.33.32.2" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.33.32.2.1">
<span class="ltx_p" id="A4.T1.1.33.32.2.1.1" style="width:198.7pt;">100000</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T1.1.34.33">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.34.33.1" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.34.33.1.1">
<span class="ltx_p" id="A4.T1.1.34.33.1.1.1" style="width:198.7pt;">OriPolicyEnvNum</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T1.1.34.33.2" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.34.33.2.1">
<span class="ltx_p" id="A4.T1.1.34.33.2.1.1" style="width:198.7pt;">16</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T1.1.35.34">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb" id="A4.T1.1.35.34.1" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.35.34.1.1">
<span class="ltx_p" id="A4.T1.1.35.34.1.1.1" style="width:198.7pt;">ExploitUpdate</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb" id="A4.T1.1.35.34.2" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T1.1.35.34.2.1">
<span class="ltx_p" id="A4.T1.1.35.34.2.1.1" style="width:198.7pt;">50</span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section class="ltx_appendix" id="A5">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>AdaMemento vs. Baseline Performance in All Atari Environments</h2>
<figure class="ltx_figure" id="A5.1">
<div class="ltx_block" id="A5.1.1">
<img alt="[Uncaptioned image]" class="ltx_graphics ltx_img_portrait" height="1074" id="A5.1.g1" src="x10.png" width="748"/><span class="ltx_ERROR ltx_centering undefined" id="A5.1.1.1">\phantomcaption</span>
</div>
</figure>
<figure class="ltx_figure" id="A5.2">
<div class="ltx_block" id="A5.2.1">
<img alt="[Uncaptioned image]" class="ltx_graphics ltx_img_portrait" height="1038" id="A5.2.g1" src="x11.png" width="746"/><span class="ltx_ERROR ltx_centering undefined" id="A5.2.1.1">\phantomcaption</span>
</div>
</figure>
<figure class="ltx_figure" id="A5.3">
<div class="ltx_block" id="A5.3.1">
<img alt="[Uncaptioned image]" class="ltx_graphics ltx_img_portrait" height="1063" id="A5.3.g1" src="x12.png" width="747"/><span class="ltx_ERROR ltx_centering undefined" id="A5.3.1.1">\phantomcaption</span>
</div>
</figure>
<figure class="ltx_figure" id="A5.F10"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="218" id="A5.F10.g1" src="x13.png" width="747"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span><span class="ltx_text ltx_font_bold" id="A5.F10.2.1">Supplementary experiments in Atari.</span>
</figcaption>
</figure>
<figure class="ltx_figure" id="A5.F11"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="474" id="A5.F11.g1" src="extracted/5905186/darkchamberchushi.png" width="479"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11: </span><span class="ltx_text ltx_font_bold" id="A5.F11.2.1">Dark Chamber environment</span> This environment contains no rewards or traps and is designed as a testing platform to evaluate the algorithm’s exploration capabilities under reward-free conditions.</figcaption>
</figure>
<figure class="ltx_figure" id="A5.F12"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="501" id="A5.F12.g1" src="extracted/5905186/fourroomchushizhuang.png" width="479"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 12: </span><span class="ltx_text ltx_font_bold" id="A5.F12.2.1">Four Rooms environment</span> The environment features a central obstacle made of four walls, with only one door the same size as the agent for it to pass through. The agent starts at the red point in the top right corner and must navigate through the obstacle to reach the blue point in the bottom left corner to obtain the only reward. As a setting with sparse rewards and obstacles, this environment is ideal for evaluating an algorithm’s ability to explore challenging scenarios.</figcaption>
</figure>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Sun Oct  6 14:35:02 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
