<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Learning Truncated Causal History Model for Video Restoration</title>
<!--Generated on Fri Oct  4 21:26:28 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.03936v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S1" title="In Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S2" title="In Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S2.SS0.SSS0.Px1" title="In 2 Related Work ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_title">Motion Compensation in Video Restoration.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S2.SS0.SSS0.Px2" title="In 2 Related Work ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_title">Video Processing Methods.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S3" title="In Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Methodology</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S3.SS1" title="In 3 Methodology ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Architecture Design</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S3.SS2" title="In 3 Methodology ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Causal History Model</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S3.SS2.SSS0.Px1" title="In 3.2 Causal History Model ‣ 3 Methodology ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_title">State Align Block (<math alttext="\phi" class="ltx_Math" display="inline"><semantics><mi>ϕ</mi><annotation-xml encoding="MathML-Content"><ci>italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex">\phi</annotation><annotation encoding="application/x-llamapun">italic_ϕ</annotation></semantics></math>).</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S3.SS2.SSS0.Px2" title="In 3.2 Causal History Model ‣ 3 Methodology ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_title">Frame History Router (<math alttext="\psi" class="ltx_Math" display="inline"><semantics><mi>ψ</mi><annotation-xml encoding="MathML-Content"><ci>𝜓</ci></annotation-xml><annotation encoding="application/x-tex">\psi</annotation><annotation encoding="application/x-llamapun">italic_ψ</annotation></semantics></math>).</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S4" title="In Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S4.SS1" title="In 4 Experiments ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Night Video Deraining</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S4.SS2" title="In 4 Experiments ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Video Desnowing</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S4.SS3" title="In 4 Experiments ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Real Video Deblurring</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S4.SS4" title="In 4 Experiments ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Synthetic Video Deblurring</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S4.SS5" title="In 4 Experiments ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.5 </span>Video Raindrops and Rain Streak Removal</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S4.SS6" title="In 4 Experiments ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.6 </span>Video Super-Resolution</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S4.SS7" title="In 4 Experiments ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.7 </span>Blind Video Denoising</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S4.SS8" title="In 4 Experiments ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.8 </span>Computational Cost Comparison</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S5" title="In Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Ablation Study</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S5.SS0.SSS0.Px1" title="In 5 Ablation Study ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_title">Block Configuration.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S5.SS0.SSS0.Px2" title="In 5 Ablation Study ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_title">Truncation Factor <math alttext="\tau" class="ltx_Math" display="inline"><semantics><mi>τ</mi><annotation-xml encoding="MathML-Content"><ci>𝜏</ci></annotation-xml><annotation encoding="application/x-tex">\tau</annotation><annotation encoding="application/x-llamapun">italic_τ</annotation></semantics></math>.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S5.SS0.SSS0.Px3" title="In 5 Ablation Study ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_title">Value of <math alttext="k" class="ltx_Math" display="inline"><semantics><mi>k</mi><annotation-xml encoding="MathML-Content"><ci>𝑘</ci></annotation-xml><annotation encoding="application/x-tex">k</annotation><annotation encoding="application/x-llamapun">italic_k</annotation></semantics></math> in <span class="ltx_text ltx_font_italic">topk</span>.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S6" title="In Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A1" title="In Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span><span class="ltx_text ltx_font_smallcaps">Turtle</span>’s Specifications &amp; Details</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A1.SS1" title="In Appendix A Turtle’s Specifications &amp; Details ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Motivation: Causal History Model</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A1.SS2" title="In Appendix A Turtle’s Specifications &amp; Details ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2 </span>Historyless FFN.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A2" title="In Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Limitations &amp; Discussion</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A2.SS1" title="In Appendix B Limitations &amp; Discussion ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.1 </span>Societal Impact</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A3" title="In Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Relationship to State Space Models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A4" title="In Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D </span>Further Visual Comparisons</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A4.SS1" title="In Appendix D Further Visual Comparisons ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.1 </span>Synthetic Video Deblurring</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A4.SS2" title="In Appendix D Further Visual Comparisons ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.2 </span>Video Raindrops and Rain Streaks Removal</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A4.SS3" title="In Appendix D Further Visual Comparisons ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.3 </span>Video Desnowing</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A4.SS4" title="In Appendix D Further Visual Comparisons ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.4 </span>Nighttime Video Deraining</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A4.SS5" title="In Appendix D Further Visual Comparisons ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.5 </span>Real-World Video Deblurring</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A5" title="In Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E </span>Computational Profile of <span class="ltx_text ltx_font_smallcaps">Turtle</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A6" title="In Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">F </span>Additional Literature Review</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A6.SS0.SSS0.Px1" title="In Appendix F Additional Literature Review ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_title">Temporal Modeling.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A6.SS0.SSS0.Px2" title="In Appendix F Additional Literature Review ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_title">Causal Learning in Videos.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A7" title="In Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">G </span>Dataset Information &amp; Summary</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Learning Truncated Causal History Model 
<br class="ltx_break"/>for Video Restoration</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname"><sup class="ltx_sup" id="id4.4.id1"><span class="ltx_text ltx_font_italic" id="id4.4.id1.1">♣</span></sup>Amirhosein Ghasemabadi 
<br class="ltx_break"/>ECE Department, University of Alberta
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id5.5.id2">ghasemab@ualberta.ca</span>
<br class="ltx_break"/>&amp;<sup class="ltx_sup" id="id6.6.id3"><span class="ltx_text ltx_font_italic" id="id6.6.id3.1">♣</span></sup>Muhammad Kamran Janjua 
<br class="ltx_break"/>Huawei Technologies, Canada 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id7.7.id4">kamran.janjua@huawei.com</span>
<br class="ltx_break"/>&amp;Mohammad Salameh 
<br class="ltx_break"/>Huawei Technologies, Canada 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id8.8.id5">mohammad.salameh@huawei.com</span>
<br class="ltx_break"/>&amp;Di Niu 
<br class="ltx_break"/>ECE Department, University of Alberta
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id9.9.id6">dniu@ualberta.ca</span>
</span><span class="ltx_author_notes"><math alttext="\clubsuit" class="ltx_Math" display="inline" id="id3.3.m1.1"><semantics id="id3.3.m1.1a"><mi id="id3.3.m1.1.1" mathvariant="normal" xref="id3.3.m1.1.1.cmml">♣</mi><annotation-xml encoding="MathML-Content" id="id3.3.m1.1b"><ci id="id3.3.m1.1.1.cmml" xref="id3.3.m1.1.1">♣</ci></annotation-xml><annotation encoding="application/x-tex" id="id3.3.m1.1c">\clubsuit</annotation><annotation encoding="application/x-llamapun" id="id3.3.m1.1d">♣</annotation></semantics></math> indicates equal contribution. </span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id10.id1">One key challenge to video restoration is to model the transition dynamics of video frames governed by motion.
In this work, we propose <span class="ltx_text ltx_font_smallcaps" id="id10.id1.1">Turtle</span> to learn the <span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="id10.id1.2">Tru</span>nca<span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="id10.id1.3">t</span>ed causa<span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="id10.id1.4">l</span> history mod<span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="id10.id1.5">e</span>l for efficient and high-performing video restoration. Unlike traditional methods that process a range of contextual frames in parallel, Turtle enhances efficiency by storing and summarizing a truncated history of the input frame latent representation into an evolving historical state. This is achieved through a sophisticated similarity-based retrieval mechanism that implicitly accounts for inter-frame motion and alignment. The causal design in <span class="ltx_text ltx_font_smallcaps" id="id10.id1.6">Turtle</span> enables recurrence in inference through state-memorized historical features while allowing parallel training by sampling truncated video clips. We report new state-of-the-art results on a multitude of video restoration benchmark tasks, including video desnowing, nighttime video deraining, video raindrops and rain streak removal, video super-resolution, real-world and synthetic video deblurring, and blind video denoising while reducing the computational cost compared to existing best contextual methods on all these tasks.</p>
<p class="ltx_p ltx_align_center" id="id11.id2"><a class="ltx_ref ltx_href" href="https://kjanjua26.github.io/turtle" title=""><span class="ltx_ERROR undefined" id="id11.id2.1.1">\faGithub</span><span class="ltx_text ltx_font_typewriter" id="id11.id2.2.2" style="color:#8E44AD;"> https://kjanjua26.github.io/turtle/</span></a></p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Video restoration aims to restore degraded low-quality videos.
Degradation in videos occurs due to noise during the acquisition process, camera sensor faults, or external factors such as weather or motion blur <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib53" title="">53</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib38" title="">38</a>]</cite>.
Several methods in the literature process the entire video either in parallel or with recurrence in design. In the former case, multiple contextual frames are processed simultaneously to facilitate information fusion and flow, which leads to increased memory consumption and inference cost as the context size increases <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib63" title="">63</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib4" title="">4</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib69" title="">69</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib86" title="">86</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib58" title="">58</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib28" title="">28</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib26" title="">26</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib5" title="">5</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib34" title="">34</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib62" title="">62</a>]</cite>. Methods with recurrence in design reuse the same network to process new frame sequentially based on previously refined ones <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib54" title="">54</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib14" title="">14</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib21" title="">21</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib25" title="">25</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib6" title="">6</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib7" title="">7</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib42" title="">42</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib57" title="">57</a>]</cite>.
Such sequential processing approaches often result in cumulative errors, leading to information loss in long-range temporal dependency modeling <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib8" title="">8</a>]</cite> and limiting parallelization capabilities.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Recently, methods based on state space models (SSMs) have seen applications across several machine vision tasks, including image restoration <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib19" title="">19</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib56" title="">56</a>]</cite>, and video understanding <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib30" title="">30</a>]</cite>. While VideoMamba <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib30" title="">30</a>]</cite> proposes a state space model for video understanding, the learned state space does not reason at the pixel level and, hence, can suffer from information collapse in restoration tasks <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib77" title="">77</a>]</cite>.
Additionally, the state evolves over time with respect to motion that affects the entire trajectory non-uniformly <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib51" title="">51</a>]</cite> at the pixel level.
Therefore, it is pertinent to learn a model capable of summarizing the history<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>In this manuscript, the term <span class="ltx_text ltx_inline-quote ltx_outerquote" id="footnote1.1">“history”</span> refers to temporally previous frames with respect to the input frame.</span></span></span> of the input as it operates on the spatiotemporal structure of the input video.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">In this work, we present <span class="ltx_text ltx_inline-quote ltx_outerquote" id="S1.p3.1.1">“<span class="ltx_text ltx_font_smallcaps" id="S1.p3.1.1.1">turtle</span>”</span>, a new video restoration framework to learn the <span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="S1.p3.1.2">Tru</span>nca<span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="S1.p3.1.3">t</span>ed causa<span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="S1.p3.1.4">l</span> history mod<span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="S1.p3.1.5">e</span>l of a video. <span class="ltx_text ltx_font_smallcaps" id="S1.p3.1.6">turtle</span> employs the proposed Causal History Model (<span class="ltx_text ltx_font_sansserif" id="S1.p3.1.7">CHM</span>) to align and borrow information from previously processed frames, maximizing feature utilization and efficiency by leveraging the frame history to enhance restoration quality. We outline our contributions.</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1"><span class="ltx_text ltx_font_smallcaps" id="S1.I1.i1.p1.1.1">turtle</span>’s encoder processes each frame individually, while its decoder, based on the proposed Causal History Model (<span class="ltx_text ltx_font_sansserif" id="S1.I1.i1.p1.1.2">CHM</span>), reuses features from previously restored frames. This structure dynamically propagates features and compensates for lost or obscured information by conditioning the decoder on the frame history. <span class="ltx_text ltx_font_sansserif" id="S1.I1.i1.p1.1.3">CHM</span> models the evolving state and compensates the history for motion relative to the input. Further, it learns to control the effect of history frames by scoring and aggregating motion-compensated features according to their relevance to the restoration of the current frame.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1"><span class="ltx_text ltx_font_smallcaps" id="S1.I1.i2.p1.1.1">turtle</span> facilitates training parallelism by sampling short clips from the entire video sequence. In inference, <span class="ltx_text ltx_font_smallcaps" id="S1.I1.i2.p1.1.2">turtle</span>’s recurrent view implicitly maintains the entire trajectory ensuring effective frame restoration.
</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1"><span class="ltx_text ltx_font_smallcaps" id="S1.I1.i3.p1.1.1">Turtle</span> sets new state-of-the-art results on several benchmark datasets and video restoration tasks, including video desnowing, nighttime video deraining, video raindrops and rain streak removal, video super-resolution, real and synthetic video deblurring, and achieves competitive results on the blind video denoising task.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">Video restoration is studied from several facets, mainly distributed in how the motion is estimated and compensated for in the learning procedure and how the frames are processed. Additional literature review is deferred to <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A6" title="Appendix F Additional Literature Review ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">appendix</span> <span class="ltx_text ltx_ref_tag">F</span></a>.</p>
</div>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Motion Compensation in Video Restoration.</h4>
<div class="ltx_para" id="S2.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px1.p1.1">Motion estimation and compensation are crucial for correcting camera and object movements in video restoration. Several methods employ optical flow to explicitly estimate motion and devise a compensation strategy as part of the learning procedure, such as deformable convolutions <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib33" title="">33</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib34" title="">34</a>]</cite>, or flow refinement <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib23" title="">23</a>]</cite>. However, optical flow can struggle with degraded inputs <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib84" title="">84</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib3" title="">3</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib20" title="">20</a>]</cite>, often requiring several refinement stages to achieve precise flow estimation. On the other end, methods also rely on the implicit learning of correspondences in the latent space across the temporal resolution of the video; a few techniques include temporal shift modules <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib29" title="">29</a>]</cite>, non-local search <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib64" title="">64</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib32" title="">32</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib85" title="">85</a>]</cite>, or deformable convolutions <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib69" title="">69</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib13" title="">13</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib80" title="">80</a>]</cite>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Video Processing Methods.</h4>
<div class="ltx_para" id="S2.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px2.p1.1">There is a similar distinction in how a video is processed, with several methods opting for either recurrence in design or restoring several frames simultaneously. Parallel methods, also known as sliding window methods, process multiple frames simultaneously. This sliding window approach can lead to inefficiencies in feature utilization and increased computational costs <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib63" title="">63</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib4" title="">4</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib69" title="">69</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib86" title="">86</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib58" title="">58</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib28" title="">28</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib26" title="">26</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib5" title="">5</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib34" title="">34</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib62" title="">62</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib9" title="">9</a>]</cite>. Although effective in learning joint features from the entire input context, their size and computational demands often render them unsuitable for resource-constrained devices. Conversely, recurrent methods restore frames sequentially, using multiple stages to propagate latent features <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib87" title="">87</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib81" title="">81</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib82" title="">82</a>]</cite>. These methods are prone to information loss <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib33" title="">33</a>]</cite>. Furthermore, while typical video restoration methods in the literature often rely on context from both past and future neighboring frames <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib34" title="">34</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib33" title="">33</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib29" title="">29</a>]</cite>, <span class="ltx_text ltx_font_smallcaps" id="S2.SS0.SSS0.Px2.p1.1.1">Turtle</span> is causal in design, focuses on using only past frames. This approach allows <span class="ltx_text ltx_font_smallcaps" id="S2.SS0.SSS0.Px2.p1.1.2">Turtle</span> to apply in scenarios like streaming and online video restoration, where future frames are unavailable.</p>
</div>
<figure class="ltx_figure" id="S2.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="331" id="S2.F1.g1" src="x1.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span><span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="S2.F1.3.1">Turtle<span class="ltx_text ltx_font_upright" id="S2.F1.3.1.1">’s Architecture.</span></span> The overall architecture diagram of the proposed method. <span class="ltx_text ltx_font_smallcaps" id="S2.F1.4.2">Turtle</span> is a U-Net <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib52" title="">52</a>]</cite> style architecture, wherein the encoder blocks are historyless feedforward blocks, while the decoder couples the causal history model (CHM) to condition the restoration procedure on truncated history of the input. We also present assorted restoration examples on the right–frame taken from video raindrops and rain streak removal <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib71" title="">71</a>]</cite>, night deraining <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib47" title="">47</a>]</cite>, and video deblurring <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib41" title="">41</a>]</cite> tasks, respectively.</figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methodology</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.18">Consider a low-quality video <math alttext="\mathbf{I}^{\text{LQ}}\in\mathbb{R}^{T\times H\times W\times C}" class="ltx_Math" display="inline" id="S3.p1.1.m1.1"><semantics id="S3.p1.1.m1.1a"><mrow id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml"><msup id="S3.p1.1.m1.1.1.2" xref="S3.p1.1.m1.1.1.2.cmml"><mi id="S3.p1.1.m1.1.1.2.2" xref="S3.p1.1.m1.1.1.2.2.cmml">𝐈</mi><mtext id="S3.p1.1.m1.1.1.2.3" xref="S3.p1.1.m1.1.1.2.3a.cmml">LQ</mtext></msup><mo id="S3.p1.1.m1.1.1.1" xref="S3.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S3.p1.1.m1.1.1.3" xref="S3.p1.1.m1.1.1.3.cmml"><mi id="S3.p1.1.m1.1.1.3.2" xref="S3.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.p1.1.m1.1.1.3.3" xref="S3.p1.1.m1.1.1.3.3.cmml"><mi id="S3.p1.1.m1.1.1.3.3.2" xref="S3.p1.1.m1.1.1.3.3.2.cmml">T</mi><mo id="S3.p1.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.p1.1.m1.1.1.3.3.3" xref="S3.p1.1.m1.1.1.3.3.3.cmml">H</mi><mo id="S3.p1.1.m1.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.p1.1.m1.1.1.3.3.4" xref="S3.p1.1.m1.1.1.3.3.4.cmml">W</mi><mo id="S3.p1.1.m1.1.1.3.3.1b" lspace="0.222em" rspace="0.222em" xref="S3.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.p1.1.m1.1.1.3.3.5" xref="S3.p1.1.m1.1.1.3.3.5.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><apply id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1"><in id="S3.p1.1.m1.1.1.1.cmml" xref="S3.p1.1.m1.1.1.1"></in><apply id="S3.p1.1.m1.1.1.2.cmml" xref="S3.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.p1.1.m1.1.1.2.1.cmml" xref="S3.p1.1.m1.1.1.2">superscript</csymbol><ci id="S3.p1.1.m1.1.1.2.2.cmml" xref="S3.p1.1.m1.1.1.2.2">𝐈</ci><ci id="S3.p1.1.m1.1.1.2.3a.cmml" xref="S3.p1.1.m1.1.1.2.3"><mtext id="S3.p1.1.m1.1.1.2.3.cmml" mathsize="70%" xref="S3.p1.1.m1.1.1.2.3">LQ</mtext></ci></apply><apply id="S3.p1.1.m1.1.1.3.cmml" xref="S3.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.1.m1.1.1.3.1.cmml" xref="S3.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.p1.1.m1.1.1.3.2.cmml" xref="S3.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S3.p1.1.m1.1.1.3.3.cmml" xref="S3.p1.1.m1.1.1.3.3"><times id="S3.p1.1.m1.1.1.3.3.1.cmml" xref="S3.p1.1.m1.1.1.3.3.1"></times><ci id="S3.p1.1.m1.1.1.3.3.2.cmml" xref="S3.p1.1.m1.1.1.3.3.2">𝑇</ci><ci id="S3.p1.1.m1.1.1.3.3.3.cmml" xref="S3.p1.1.m1.1.1.3.3.3">𝐻</ci><ci id="S3.p1.1.m1.1.1.3.3.4.cmml" xref="S3.p1.1.m1.1.1.3.3.4">𝑊</ci><ci id="S3.p1.1.m1.1.1.3.3.5.cmml" xref="S3.p1.1.m1.1.1.3.3.5">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">\mathbf{I}^{\text{LQ}}\in\mathbb{R}^{T\times H\times W\times C}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.1.m1.1d">bold_I start_POSTSUPERSCRIPT LQ end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_T × italic_H × italic_W × italic_C end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="T" class="ltx_Math" display="inline" id="S3.p1.2.m2.1"><semantics id="S3.p1.2.m2.1a"><mi id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><ci id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.p1.2.m2.1d">italic_T</annotation></semantics></math>, <math alttext="H" class="ltx_Math" display="inline" id="S3.p1.3.m3.1"><semantics id="S3.p1.3.m3.1a"><mi id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><ci id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">H</annotation><annotation encoding="application/x-llamapun" id="S3.p1.3.m3.1d">italic_H</annotation></semantics></math>, <math alttext="W" class="ltx_Math" display="inline" id="S3.p1.4.m4.1"><semantics id="S3.p1.4.m4.1a"><mi id="S3.p1.4.m4.1.1" xref="S3.p1.4.m4.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.1b"><ci id="S3.p1.4.m4.1.1.cmml" xref="S3.p1.4.m4.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.1c">W</annotation><annotation encoding="application/x-llamapun" id="S3.p1.4.m4.1d">italic_W</annotation></semantics></math>, <math alttext="C" class="ltx_Math" display="inline" id="S3.p1.5.m5.1"><semantics id="S3.p1.5.m5.1a"><mi id="S3.p1.5.m5.1.1" xref="S3.p1.5.m5.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.1b"><ci id="S3.p1.5.m5.1.1.cmml" xref="S3.p1.5.m5.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m5.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.p1.5.m5.1d">italic_C</annotation></semantics></math> denote the temporal resolution, height, width, and number of channels, respectively, that has been degraded with some degradation <math alttext="d\in\mathbb{D}" class="ltx_Math" display="inline" id="S3.p1.6.m6.1"><semantics id="S3.p1.6.m6.1a"><mrow id="S3.p1.6.m6.1.1" xref="S3.p1.6.m6.1.1.cmml"><mi id="S3.p1.6.m6.1.1.2" xref="S3.p1.6.m6.1.1.2.cmml">d</mi><mo id="S3.p1.6.m6.1.1.1" xref="S3.p1.6.m6.1.1.1.cmml">∈</mo><mi id="S3.p1.6.m6.1.1.3" xref="S3.p1.6.m6.1.1.3.cmml">𝔻</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.6.m6.1b"><apply id="S3.p1.6.m6.1.1.cmml" xref="S3.p1.6.m6.1.1"><in id="S3.p1.6.m6.1.1.1.cmml" xref="S3.p1.6.m6.1.1.1"></in><ci id="S3.p1.6.m6.1.1.2.cmml" xref="S3.p1.6.m6.1.1.2">𝑑</ci><ci id="S3.p1.6.m6.1.1.3.cmml" xref="S3.p1.6.m6.1.1.3">𝔻</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.6.m6.1c">d\in\mathbb{D}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.6.m6.1d">italic_d ∈ blackboard_D</annotation></semantics></math>. The goal of video restoration is to learn a model <math alttext="\boldsymbol{M}_{\theta}" class="ltx_Math" display="inline" id="S3.p1.7.m7.1"><semantics id="S3.p1.7.m7.1a"><msub id="S3.p1.7.m7.1.1" xref="S3.p1.7.m7.1.1.cmml"><mi id="S3.p1.7.m7.1.1.2" xref="S3.p1.7.m7.1.1.2.cmml">𝑴</mi><mi id="S3.p1.7.m7.1.1.3" xref="S3.p1.7.m7.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.7.m7.1b"><apply id="S3.p1.7.m7.1.1.cmml" xref="S3.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.p1.7.m7.1.1.1.cmml" xref="S3.p1.7.m7.1.1">subscript</csymbol><ci id="S3.p1.7.m7.1.1.2.cmml" xref="S3.p1.7.m7.1.1.2">𝑴</ci><ci id="S3.p1.7.m7.1.1.3.cmml" xref="S3.p1.7.m7.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.7.m7.1c">\boldsymbol{M}_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.7.m7.1d">bold_italic_M start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> parameterized by <math alttext="\theta" class="ltx_Math" display="inline" id="S3.p1.8.m8.1"><semantics id="S3.p1.8.m8.1a"><mi id="S3.p1.8.m8.1.1" xref="S3.p1.8.m8.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.p1.8.m8.1b"><ci id="S3.p1.8.m8.1.1.cmml" xref="S3.p1.8.m8.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.8.m8.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S3.p1.8.m8.1d">italic_θ</annotation></semantics></math> to restore high-quality video <math alttext="\mathbf{I}^{\text{HQ}}\in\mathbb{R}^{T\times sH\times sW\times C}" class="ltx_Math" display="inline" id="S3.p1.9.m9.1"><semantics id="S3.p1.9.m9.1a"><mrow id="S3.p1.9.m9.1.1" xref="S3.p1.9.m9.1.1.cmml"><msup id="S3.p1.9.m9.1.1.2" xref="S3.p1.9.m9.1.1.2.cmml"><mi id="S3.p1.9.m9.1.1.2.2" xref="S3.p1.9.m9.1.1.2.2.cmml">𝐈</mi><mtext id="S3.p1.9.m9.1.1.2.3" xref="S3.p1.9.m9.1.1.2.3a.cmml">HQ</mtext></msup><mo id="S3.p1.9.m9.1.1.1" xref="S3.p1.9.m9.1.1.1.cmml">∈</mo><msup id="S3.p1.9.m9.1.1.3" xref="S3.p1.9.m9.1.1.3.cmml"><mi id="S3.p1.9.m9.1.1.3.2" xref="S3.p1.9.m9.1.1.3.2.cmml">ℝ</mi><mrow id="S3.p1.9.m9.1.1.3.3" xref="S3.p1.9.m9.1.1.3.3.cmml"><mrow id="S3.p1.9.m9.1.1.3.3.2" xref="S3.p1.9.m9.1.1.3.3.2.cmml"><mrow id="S3.p1.9.m9.1.1.3.3.2.2" xref="S3.p1.9.m9.1.1.3.3.2.2.cmml"><mrow id="S3.p1.9.m9.1.1.3.3.2.2.2" xref="S3.p1.9.m9.1.1.3.3.2.2.2.cmml"><mrow id="S3.p1.9.m9.1.1.3.3.2.2.2.2" xref="S3.p1.9.m9.1.1.3.3.2.2.2.2.cmml"><mi id="S3.p1.9.m9.1.1.3.3.2.2.2.2.2" xref="S3.p1.9.m9.1.1.3.3.2.2.2.2.2.cmml">T</mi><mo id="S3.p1.9.m9.1.1.3.3.2.2.2.2.1" lspace="0.222em" rspace="0.222em" xref="S3.p1.9.m9.1.1.3.3.2.2.2.2.1.cmml">×</mo><mi id="S3.p1.9.m9.1.1.3.3.2.2.2.2.3" xref="S3.p1.9.m9.1.1.3.3.2.2.2.2.3.cmml">s</mi></mrow><mo id="S3.p1.9.m9.1.1.3.3.2.2.2.1" xref="S3.p1.9.m9.1.1.3.3.2.2.2.1.cmml">⁢</mo><mi id="S3.p1.9.m9.1.1.3.3.2.2.2.3" xref="S3.p1.9.m9.1.1.3.3.2.2.2.3.cmml">H</mi></mrow><mo id="S3.p1.9.m9.1.1.3.3.2.2.1" lspace="0.222em" rspace="0.222em" xref="S3.p1.9.m9.1.1.3.3.2.2.1.cmml">×</mo><mi id="S3.p1.9.m9.1.1.3.3.2.2.3" xref="S3.p1.9.m9.1.1.3.3.2.2.3.cmml">s</mi></mrow><mo id="S3.p1.9.m9.1.1.3.3.2.1" xref="S3.p1.9.m9.1.1.3.3.2.1.cmml">⁢</mo><mi id="S3.p1.9.m9.1.1.3.3.2.3" xref="S3.p1.9.m9.1.1.3.3.2.3.cmml">W</mi></mrow><mo id="S3.p1.9.m9.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.p1.9.m9.1.1.3.3.1.cmml">×</mo><mi id="S3.p1.9.m9.1.1.3.3.3" xref="S3.p1.9.m9.1.1.3.3.3.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.9.m9.1b"><apply id="S3.p1.9.m9.1.1.cmml" xref="S3.p1.9.m9.1.1"><in id="S3.p1.9.m9.1.1.1.cmml" xref="S3.p1.9.m9.1.1.1"></in><apply id="S3.p1.9.m9.1.1.2.cmml" xref="S3.p1.9.m9.1.1.2"><csymbol cd="ambiguous" id="S3.p1.9.m9.1.1.2.1.cmml" xref="S3.p1.9.m9.1.1.2">superscript</csymbol><ci id="S3.p1.9.m9.1.1.2.2.cmml" xref="S3.p1.9.m9.1.1.2.2">𝐈</ci><ci id="S3.p1.9.m9.1.1.2.3a.cmml" xref="S3.p1.9.m9.1.1.2.3"><mtext id="S3.p1.9.m9.1.1.2.3.cmml" mathsize="70%" xref="S3.p1.9.m9.1.1.2.3">HQ</mtext></ci></apply><apply id="S3.p1.9.m9.1.1.3.cmml" xref="S3.p1.9.m9.1.1.3"><csymbol cd="ambiguous" id="S3.p1.9.m9.1.1.3.1.cmml" xref="S3.p1.9.m9.1.1.3">superscript</csymbol><ci id="S3.p1.9.m9.1.1.3.2.cmml" xref="S3.p1.9.m9.1.1.3.2">ℝ</ci><apply id="S3.p1.9.m9.1.1.3.3.cmml" xref="S3.p1.9.m9.1.1.3.3"><times id="S3.p1.9.m9.1.1.3.3.1.cmml" xref="S3.p1.9.m9.1.1.3.3.1"></times><apply id="S3.p1.9.m9.1.1.3.3.2.cmml" xref="S3.p1.9.m9.1.1.3.3.2"><times id="S3.p1.9.m9.1.1.3.3.2.1.cmml" xref="S3.p1.9.m9.1.1.3.3.2.1"></times><apply id="S3.p1.9.m9.1.1.3.3.2.2.cmml" xref="S3.p1.9.m9.1.1.3.3.2.2"><times id="S3.p1.9.m9.1.1.3.3.2.2.1.cmml" xref="S3.p1.9.m9.1.1.3.3.2.2.1"></times><apply id="S3.p1.9.m9.1.1.3.3.2.2.2.cmml" xref="S3.p1.9.m9.1.1.3.3.2.2.2"><times id="S3.p1.9.m9.1.1.3.3.2.2.2.1.cmml" xref="S3.p1.9.m9.1.1.3.3.2.2.2.1"></times><apply id="S3.p1.9.m9.1.1.3.3.2.2.2.2.cmml" xref="S3.p1.9.m9.1.1.3.3.2.2.2.2"><times id="S3.p1.9.m9.1.1.3.3.2.2.2.2.1.cmml" xref="S3.p1.9.m9.1.1.3.3.2.2.2.2.1"></times><ci id="S3.p1.9.m9.1.1.3.3.2.2.2.2.2.cmml" xref="S3.p1.9.m9.1.1.3.3.2.2.2.2.2">𝑇</ci><ci id="S3.p1.9.m9.1.1.3.3.2.2.2.2.3.cmml" xref="S3.p1.9.m9.1.1.3.3.2.2.2.2.3">𝑠</ci></apply><ci id="S3.p1.9.m9.1.1.3.3.2.2.2.3.cmml" xref="S3.p1.9.m9.1.1.3.3.2.2.2.3">𝐻</ci></apply><ci id="S3.p1.9.m9.1.1.3.3.2.2.3.cmml" xref="S3.p1.9.m9.1.1.3.3.2.2.3">𝑠</ci></apply><ci id="S3.p1.9.m9.1.1.3.3.2.3.cmml" xref="S3.p1.9.m9.1.1.3.3.2.3">𝑊</ci></apply><ci id="S3.p1.9.m9.1.1.3.3.3.cmml" xref="S3.p1.9.m9.1.1.3.3.3">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.9.m9.1c">\mathbf{I}^{\text{HQ}}\in\mathbb{R}^{T\times sH\times sW\times C}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.9.m9.1d">bold_I start_POSTSUPERSCRIPT HQ end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_T × italic_s italic_H × italic_s italic_W × italic_C end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="s" class="ltx_Math" display="inline" id="S3.p1.10.m10.1"><semantics id="S3.p1.10.m10.1a"><mi id="S3.p1.10.m10.1.1" xref="S3.p1.10.m10.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.p1.10.m10.1b"><ci id="S3.p1.10.m10.1.1.cmml" xref="S3.p1.10.m10.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.10.m10.1c">s</annotation><annotation encoding="application/x-llamapun" id="S3.p1.10.m10.1d">italic_s</annotation></semantics></math> is the scale factor (where <math alttext="s&gt;1" class="ltx_Math" display="inline" id="S3.p1.11.m11.1"><semantics id="S3.p1.11.m11.1a"><mrow id="S3.p1.11.m11.1.1" xref="S3.p1.11.m11.1.1.cmml"><mi id="S3.p1.11.m11.1.1.2" xref="S3.p1.11.m11.1.1.2.cmml">s</mi><mo id="S3.p1.11.m11.1.1.1" xref="S3.p1.11.m11.1.1.1.cmml">&gt;</mo><mn id="S3.p1.11.m11.1.1.3" xref="S3.p1.11.m11.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.11.m11.1b"><apply id="S3.p1.11.m11.1.1.cmml" xref="S3.p1.11.m11.1.1"><gt id="S3.p1.11.m11.1.1.1.cmml" xref="S3.p1.11.m11.1.1.1"></gt><ci id="S3.p1.11.m11.1.1.2.cmml" xref="S3.p1.11.m11.1.1.2">𝑠</ci><cn id="S3.p1.11.m11.1.1.3.cmml" type="integer" xref="S3.p1.11.m11.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.11.m11.1c">s&gt;1</annotation><annotation encoding="application/x-llamapun" id="S3.p1.11.m11.1d">italic_s &gt; 1</annotation></semantics></math> for video super-resolution). To this end, we propose <span class="ltx_text ltx_font_smallcaps" id="S3.p1.18.1">Turtle</span>, a U-Net style <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib52" title="">52</a>]</cite> architecture, to process, and restore a single frame at any given timestep conditioned on the truncated history of the given frame. <span class="ltx_text ltx_font_smallcaps" id="S3.p1.18.2">Turtle</span>’s encoder focuses only on a single frame input and does not consider the broader temporal context of the video sequence. In contrast, the decoder, however, utilizes features from previously restored frames. This setup facilitates a dynamic propagation of features through time, effectively compensating for information that may be lost or obscured in the input frame. More specifically, we condition a decoder block at the different U-Net stages on the history of the frames. Given a frame at timestep <math alttext="t" class="ltx_Math" display="inline" id="S3.p1.12.m12.1"><semantics id="S3.p1.12.m12.1a"><mi id="S3.p1.12.m12.1.1" xref="S3.p1.12.m12.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.p1.12.m12.1b"><ci id="S3.p1.12.m12.1.1.cmml" xref="S3.p1.12.m12.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.12.m12.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.p1.12.m12.1d">italic_t</annotation></semantics></math>, each block learns to model the causal relationship <math alttext="p(\mathbf{y}_{t}|\mathbf{F}_{t},\mathbf{H}_{t})" class="ltx_Math" display="inline" id="S3.p1.13.m13.1"><semantics id="S3.p1.13.m13.1a"><mrow id="S3.p1.13.m13.1.1" xref="S3.p1.13.m13.1.1.cmml"><mi id="S3.p1.13.m13.1.1.3" xref="S3.p1.13.m13.1.1.3.cmml">p</mi><mo id="S3.p1.13.m13.1.1.2" xref="S3.p1.13.m13.1.1.2.cmml">⁢</mo><mrow id="S3.p1.13.m13.1.1.1.1" xref="S3.p1.13.m13.1.1.1.1.1.cmml"><mo id="S3.p1.13.m13.1.1.1.1.2" stretchy="false" xref="S3.p1.13.m13.1.1.1.1.1.cmml">(</mo><mrow id="S3.p1.13.m13.1.1.1.1.1" xref="S3.p1.13.m13.1.1.1.1.1.cmml"><msub id="S3.p1.13.m13.1.1.1.1.1.4" xref="S3.p1.13.m13.1.1.1.1.1.4.cmml"><mi id="S3.p1.13.m13.1.1.1.1.1.4.2" xref="S3.p1.13.m13.1.1.1.1.1.4.2.cmml">𝐲</mi><mi id="S3.p1.13.m13.1.1.1.1.1.4.3" xref="S3.p1.13.m13.1.1.1.1.1.4.3.cmml">t</mi></msub><mo fence="false" id="S3.p1.13.m13.1.1.1.1.1.3" xref="S3.p1.13.m13.1.1.1.1.1.3.cmml">|</mo><mrow id="S3.p1.13.m13.1.1.1.1.1.2.2" xref="S3.p1.13.m13.1.1.1.1.1.2.3.cmml"><msub id="S3.p1.13.m13.1.1.1.1.1.1.1.1" xref="S3.p1.13.m13.1.1.1.1.1.1.1.1.cmml"><mi id="S3.p1.13.m13.1.1.1.1.1.1.1.1.2" xref="S3.p1.13.m13.1.1.1.1.1.1.1.1.2.cmml">𝐅</mi><mi id="S3.p1.13.m13.1.1.1.1.1.1.1.1.3" xref="S3.p1.13.m13.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.p1.13.m13.1.1.1.1.1.2.2.3" xref="S3.p1.13.m13.1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.p1.13.m13.1.1.1.1.1.2.2.2" xref="S3.p1.13.m13.1.1.1.1.1.2.2.2.cmml"><mi id="S3.p1.13.m13.1.1.1.1.1.2.2.2.2" xref="S3.p1.13.m13.1.1.1.1.1.2.2.2.2.cmml">𝐇</mi><mi id="S3.p1.13.m13.1.1.1.1.1.2.2.2.3" xref="S3.p1.13.m13.1.1.1.1.1.2.2.2.3.cmml">t</mi></msub></mrow></mrow><mo id="S3.p1.13.m13.1.1.1.1.3" stretchy="false" xref="S3.p1.13.m13.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.13.m13.1b"><apply id="S3.p1.13.m13.1.1.cmml" xref="S3.p1.13.m13.1.1"><times id="S3.p1.13.m13.1.1.2.cmml" xref="S3.p1.13.m13.1.1.2"></times><ci id="S3.p1.13.m13.1.1.3.cmml" xref="S3.p1.13.m13.1.1.3">𝑝</ci><apply id="S3.p1.13.m13.1.1.1.1.1.cmml" xref="S3.p1.13.m13.1.1.1.1"><csymbol cd="latexml" id="S3.p1.13.m13.1.1.1.1.1.3.cmml" xref="S3.p1.13.m13.1.1.1.1.1.3">conditional</csymbol><apply id="S3.p1.13.m13.1.1.1.1.1.4.cmml" xref="S3.p1.13.m13.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.p1.13.m13.1.1.1.1.1.4.1.cmml" xref="S3.p1.13.m13.1.1.1.1.1.4">subscript</csymbol><ci id="S3.p1.13.m13.1.1.1.1.1.4.2.cmml" xref="S3.p1.13.m13.1.1.1.1.1.4.2">𝐲</ci><ci id="S3.p1.13.m13.1.1.1.1.1.4.3.cmml" xref="S3.p1.13.m13.1.1.1.1.1.4.3">𝑡</ci></apply><list id="S3.p1.13.m13.1.1.1.1.1.2.3.cmml" xref="S3.p1.13.m13.1.1.1.1.1.2.2"><apply id="S3.p1.13.m13.1.1.1.1.1.1.1.1.cmml" xref="S3.p1.13.m13.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.13.m13.1.1.1.1.1.1.1.1.1.cmml" xref="S3.p1.13.m13.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.p1.13.m13.1.1.1.1.1.1.1.1.2.cmml" xref="S3.p1.13.m13.1.1.1.1.1.1.1.1.2">𝐅</ci><ci id="S3.p1.13.m13.1.1.1.1.1.1.1.1.3.cmml" xref="S3.p1.13.m13.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.p1.13.m13.1.1.1.1.1.2.2.2.cmml" xref="S3.p1.13.m13.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.p1.13.m13.1.1.1.1.1.2.2.2.1.cmml" xref="S3.p1.13.m13.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.p1.13.m13.1.1.1.1.1.2.2.2.2.cmml" xref="S3.p1.13.m13.1.1.1.1.1.2.2.2.2">𝐇</ci><ci id="S3.p1.13.m13.1.1.1.1.1.2.2.2.3.cmml" xref="S3.p1.13.m13.1.1.1.1.1.2.2.2.3">𝑡</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.13.m13.1c">p(\mathbf{y}_{t}|\mathbf{F}_{t},\mathbf{H}_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.p1.13.m13.1d">italic_p ( bold_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | bold_F start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , bold_H start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>, where <math alttext="\mathbf{y}_{t}" class="ltx_Math" display="inline" id="S3.p1.14.m14.1"><semantics id="S3.p1.14.m14.1a"><msub id="S3.p1.14.m14.1.1" xref="S3.p1.14.m14.1.1.cmml"><mi id="S3.p1.14.m14.1.1.2" xref="S3.p1.14.m14.1.1.2.cmml">𝐲</mi><mi id="S3.p1.14.m14.1.1.3" xref="S3.p1.14.m14.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.14.m14.1b"><apply id="S3.p1.14.m14.1.1.cmml" xref="S3.p1.14.m14.1.1"><csymbol cd="ambiguous" id="S3.p1.14.m14.1.1.1.cmml" xref="S3.p1.14.m14.1.1">subscript</csymbol><ci id="S3.p1.14.m14.1.1.2.cmml" xref="S3.p1.14.m14.1.1.2">𝐲</ci><ci id="S3.p1.14.m14.1.1.3.cmml" xref="S3.p1.14.m14.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.14.m14.1c">\mathbf{y}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.14.m14.1d">bold_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is the output of a decoder block, <math alttext="\mathbf{F}_{t}" class="ltx_Math" display="inline" id="S3.p1.15.m15.1"><semantics id="S3.p1.15.m15.1a"><msub id="S3.p1.15.m15.1.1" xref="S3.p1.15.m15.1.1.cmml"><mi id="S3.p1.15.m15.1.1.2" xref="S3.p1.15.m15.1.1.2.cmml">𝐅</mi><mi id="S3.p1.15.m15.1.1.3" xref="S3.p1.15.m15.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.15.m15.1b"><apply id="S3.p1.15.m15.1.1.cmml" xref="S3.p1.15.m15.1.1"><csymbol cd="ambiguous" id="S3.p1.15.m15.1.1.1.cmml" xref="S3.p1.15.m15.1.1">subscript</csymbol><ci id="S3.p1.15.m15.1.1.2.cmml" xref="S3.p1.15.m15.1.1.2">𝐅</ci><ci id="S3.p1.15.m15.1.1.3.cmml" xref="S3.p1.15.m15.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.15.m15.1c">\mathbf{F}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.15.m15.1d">bold_F start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is the input feature map of the decoder block, and <math alttext="\mathbf{H}_{t}" class="ltx_Math" display="inline" id="S3.p1.16.m16.1"><semantics id="S3.p1.16.m16.1a"><msub id="S3.p1.16.m16.1.1" xref="S3.p1.16.m16.1.1.cmml"><mi id="S3.p1.16.m16.1.1.2" xref="S3.p1.16.m16.1.1.2.cmml">𝐇</mi><mi id="S3.p1.16.m16.1.1.3" xref="S3.p1.16.m16.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.16.m16.1b"><apply id="S3.p1.16.m16.1.1.cmml" xref="S3.p1.16.m16.1.1"><csymbol cd="ambiguous" id="S3.p1.16.m16.1.1.1.cmml" xref="S3.p1.16.m16.1.1">subscript</csymbol><ci id="S3.p1.16.m16.1.1.2.cmml" xref="S3.p1.16.m16.1.1.2">𝐇</ci><ci id="S3.p1.16.m16.1.1.3.cmml" xref="S3.p1.16.m16.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.16.m16.1c">\mathbf{H}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.16.m16.1d">bold_H start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is the history of corresponding features maps from the previous frames at the same block. We train the architecture with the standard L<sub class="ltx_sub" id="S3.p1.18.3">1</sub> loss function: <math alttext="\mathcal{L}=\frac{1}{N}\sum_{i=1}^{N}\|\mathbf{I}^{\text{GT}}-\mathbf{I}^{%
\text{HQ}}\|_{1}" class="ltx_Math" display="inline" id="S3.p1.18.m18.1"><semantics id="S3.p1.18.m18.1a"><mrow id="S3.p1.18.m18.1.1" xref="S3.p1.18.m18.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.18.m18.1.1.3" xref="S3.p1.18.m18.1.1.3.cmml">ℒ</mi><mo id="S3.p1.18.m18.1.1.2" xref="S3.p1.18.m18.1.1.2.cmml">=</mo><mrow id="S3.p1.18.m18.1.1.1" xref="S3.p1.18.m18.1.1.1.cmml"><mfrac id="S3.p1.18.m18.1.1.1.3" xref="S3.p1.18.m18.1.1.1.3.cmml"><mn id="S3.p1.18.m18.1.1.1.3.2" xref="S3.p1.18.m18.1.1.1.3.2.cmml">1</mn><mi id="S3.p1.18.m18.1.1.1.3.3" xref="S3.p1.18.m18.1.1.1.3.3.cmml">N</mi></mfrac><mo id="S3.p1.18.m18.1.1.1.2" xref="S3.p1.18.m18.1.1.1.2.cmml">⁢</mo><mrow id="S3.p1.18.m18.1.1.1.1" xref="S3.p1.18.m18.1.1.1.1.cmml"><msubsup id="S3.p1.18.m18.1.1.1.1.2" xref="S3.p1.18.m18.1.1.1.1.2.cmml"><mo id="S3.p1.18.m18.1.1.1.1.2.2.2" rspace="0em" xref="S3.p1.18.m18.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.p1.18.m18.1.1.1.1.2.2.3" xref="S3.p1.18.m18.1.1.1.1.2.2.3.cmml"><mi id="S3.p1.18.m18.1.1.1.1.2.2.3.2" xref="S3.p1.18.m18.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.p1.18.m18.1.1.1.1.2.2.3.1" xref="S3.p1.18.m18.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.p1.18.m18.1.1.1.1.2.2.3.3" xref="S3.p1.18.m18.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.p1.18.m18.1.1.1.1.2.3" xref="S3.p1.18.m18.1.1.1.1.2.3.cmml">N</mi></msubsup><msub id="S3.p1.18.m18.1.1.1.1.1" xref="S3.p1.18.m18.1.1.1.1.1.cmml"><mrow id="S3.p1.18.m18.1.1.1.1.1.1.1" xref="S3.p1.18.m18.1.1.1.1.1.1.2.cmml"><mo id="S3.p1.18.m18.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.p1.18.m18.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.p1.18.m18.1.1.1.1.1.1.1.1" xref="S3.p1.18.m18.1.1.1.1.1.1.1.1.cmml"><msup id="S3.p1.18.m18.1.1.1.1.1.1.1.1.2" xref="S3.p1.18.m18.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.p1.18.m18.1.1.1.1.1.1.1.1.2.2" xref="S3.p1.18.m18.1.1.1.1.1.1.1.1.2.2.cmml">𝐈</mi><mtext id="S3.p1.18.m18.1.1.1.1.1.1.1.1.2.3" xref="S3.p1.18.m18.1.1.1.1.1.1.1.1.2.3a.cmml">GT</mtext></msup><mo id="S3.p1.18.m18.1.1.1.1.1.1.1.1.1" xref="S3.p1.18.m18.1.1.1.1.1.1.1.1.1.cmml">−</mo><msup id="S3.p1.18.m18.1.1.1.1.1.1.1.1.3" xref="S3.p1.18.m18.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.p1.18.m18.1.1.1.1.1.1.1.1.3.2" xref="S3.p1.18.m18.1.1.1.1.1.1.1.1.3.2.cmml">𝐈</mi><mtext id="S3.p1.18.m18.1.1.1.1.1.1.1.1.3.3" xref="S3.p1.18.m18.1.1.1.1.1.1.1.1.3.3a.cmml">HQ</mtext></msup></mrow><mo id="S3.p1.18.m18.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.p1.18.m18.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.p1.18.m18.1.1.1.1.1.3" xref="S3.p1.18.m18.1.1.1.1.1.3.cmml">1</mn></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.18.m18.1b"><apply id="S3.p1.18.m18.1.1.cmml" xref="S3.p1.18.m18.1.1"><eq id="S3.p1.18.m18.1.1.2.cmml" xref="S3.p1.18.m18.1.1.2"></eq><ci id="S3.p1.18.m18.1.1.3.cmml" xref="S3.p1.18.m18.1.1.3">ℒ</ci><apply id="S3.p1.18.m18.1.1.1.cmml" xref="S3.p1.18.m18.1.1.1"><times id="S3.p1.18.m18.1.1.1.2.cmml" xref="S3.p1.18.m18.1.1.1.2"></times><apply id="S3.p1.18.m18.1.1.1.3.cmml" xref="S3.p1.18.m18.1.1.1.3"><divide id="S3.p1.18.m18.1.1.1.3.1.cmml" xref="S3.p1.18.m18.1.1.1.3"></divide><cn id="S3.p1.18.m18.1.1.1.3.2.cmml" type="integer" xref="S3.p1.18.m18.1.1.1.3.2">1</cn><ci id="S3.p1.18.m18.1.1.1.3.3.cmml" xref="S3.p1.18.m18.1.1.1.3.3">𝑁</ci></apply><apply id="S3.p1.18.m18.1.1.1.1.cmml" xref="S3.p1.18.m18.1.1.1.1"><apply id="S3.p1.18.m18.1.1.1.1.2.cmml" xref="S3.p1.18.m18.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.p1.18.m18.1.1.1.1.2.1.cmml" xref="S3.p1.18.m18.1.1.1.1.2">superscript</csymbol><apply id="S3.p1.18.m18.1.1.1.1.2.2.cmml" xref="S3.p1.18.m18.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.p1.18.m18.1.1.1.1.2.2.1.cmml" xref="S3.p1.18.m18.1.1.1.1.2">subscript</csymbol><sum id="S3.p1.18.m18.1.1.1.1.2.2.2.cmml" xref="S3.p1.18.m18.1.1.1.1.2.2.2"></sum><apply id="S3.p1.18.m18.1.1.1.1.2.2.3.cmml" xref="S3.p1.18.m18.1.1.1.1.2.2.3"><eq id="S3.p1.18.m18.1.1.1.1.2.2.3.1.cmml" xref="S3.p1.18.m18.1.1.1.1.2.2.3.1"></eq><ci id="S3.p1.18.m18.1.1.1.1.2.2.3.2.cmml" xref="S3.p1.18.m18.1.1.1.1.2.2.3.2">𝑖</ci><cn id="S3.p1.18.m18.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.p1.18.m18.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.p1.18.m18.1.1.1.1.2.3.cmml" xref="S3.p1.18.m18.1.1.1.1.2.3">𝑁</ci></apply><apply id="S3.p1.18.m18.1.1.1.1.1.cmml" xref="S3.p1.18.m18.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.18.m18.1.1.1.1.1.2.cmml" xref="S3.p1.18.m18.1.1.1.1.1">subscript</csymbol><apply id="S3.p1.18.m18.1.1.1.1.1.1.2.cmml" xref="S3.p1.18.m18.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.p1.18.m18.1.1.1.1.1.1.2.1.cmml" xref="S3.p1.18.m18.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.p1.18.m18.1.1.1.1.1.1.1.1.cmml" xref="S3.p1.18.m18.1.1.1.1.1.1.1.1"><minus id="S3.p1.18.m18.1.1.1.1.1.1.1.1.1.cmml" xref="S3.p1.18.m18.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.p1.18.m18.1.1.1.1.1.1.1.1.2.cmml" xref="S3.p1.18.m18.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.p1.18.m18.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.p1.18.m18.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.p1.18.m18.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.p1.18.m18.1.1.1.1.1.1.1.1.2.2">𝐈</ci><ci id="S3.p1.18.m18.1.1.1.1.1.1.1.1.2.3a.cmml" xref="S3.p1.18.m18.1.1.1.1.1.1.1.1.2.3"><mtext id="S3.p1.18.m18.1.1.1.1.1.1.1.1.2.3.cmml" mathsize="70%" xref="S3.p1.18.m18.1.1.1.1.1.1.1.1.2.3">GT</mtext></ci></apply><apply id="S3.p1.18.m18.1.1.1.1.1.1.1.1.3.cmml" xref="S3.p1.18.m18.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.18.m18.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.p1.18.m18.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.p1.18.m18.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.p1.18.m18.1.1.1.1.1.1.1.1.3.2">𝐈</ci><ci id="S3.p1.18.m18.1.1.1.1.1.1.1.1.3.3a.cmml" xref="S3.p1.18.m18.1.1.1.1.1.1.1.1.3.3"><mtext id="S3.p1.18.m18.1.1.1.1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S3.p1.18.m18.1.1.1.1.1.1.1.1.3.3">HQ</mtext></ci></apply></apply></apply><cn id="S3.p1.18.m18.1.1.1.1.1.3.cmml" type="integer" xref="S3.p1.18.m18.1.1.1.1.1.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.18.m18.1c">\mathcal{L}=\frac{1}{N}\sum_{i=1}^{N}\|\mathbf{I}^{\text{GT}}-\mathbf{I}^{%
\text{HQ}}\|_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.18.m18.1d">caligraphic_L = divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ∥ bold_I start_POSTSUPERSCRIPT GT end_POSTSUPERSCRIPT - bold_I start_POSTSUPERSCRIPT HQ end_POSTSUPERSCRIPT ∥ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> for all the restoration tasks. We present the visual illustration of <span class="ltx_text ltx_font_smallcaps" id="S3.p1.18.4">turtle</span>’s architecture in <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S2.F1" title="In Video Processing Methods. ‣ 2 Related Work ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Architecture Design</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.15">Given a model <math alttext="\boldsymbol{M}_{\theta}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><msub id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">𝑴</mi><mi id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">𝑴</ci><ci id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\boldsymbol{M}_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">bold_italic_M start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>, let <math alttext="\mathbf{F}_{t}^{[l]}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><msubsup id="S3.SS1.p1.2.m2.1.2" xref="S3.SS1.p1.2.m2.1.2.cmml"><mi id="S3.SS1.p1.2.m2.1.2.2.2" xref="S3.SS1.p1.2.m2.1.2.2.2.cmml">𝐅</mi><mi id="S3.SS1.p1.2.m2.1.2.2.3" xref="S3.SS1.p1.2.m2.1.2.2.3.cmml">t</mi><mrow id="S3.SS1.p1.2.m2.1.1.1.3" xref="S3.SS1.p1.2.m2.1.1.1.2.cmml"><mo id="S3.SS1.p1.2.m2.1.1.1.3.1" stretchy="false" xref="S3.SS1.p1.2.m2.1.1.1.2.1.cmml">[</mo><mi id="S3.SS1.p1.2.m2.1.1.1.1" xref="S3.SS1.p1.2.m2.1.1.1.1.cmml">l</mi><mo id="S3.SS1.p1.2.m2.1.1.1.3.2" stretchy="false" xref="S3.SS1.p1.2.m2.1.1.1.2.1.cmml">]</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.2.cmml" xref="S3.SS1.p1.2.m2.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.2.1.cmml" xref="S3.SS1.p1.2.m2.1.2">superscript</csymbol><apply id="S3.SS1.p1.2.m2.1.2.2.cmml" xref="S3.SS1.p1.2.m2.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.2.2.1.cmml" xref="S3.SS1.p1.2.m2.1.2">subscript</csymbol><ci id="S3.SS1.p1.2.m2.1.2.2.2.cmml" xref="S3.SS1.p1.2.m2.1.2.2.2">𝐅</ci><ci id="S3.SS1.p1.2.m2.1.2.2.3.cmml" xref="S3.SS1.p1.2.m2.1.2.2.3">𝑡</ci></apply><apply id="S3.SS1.p1.2.m2.1.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.1.3"><csymbol cd="latexml" id="S3.SS1.p1.2.m2.1.1.1.2.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS1.p1.2.m2.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">\mathbf{F}_{t}^{[l]}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">bold_F start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT</annotation></semantics></math> denote the feature map of a frame at timestep <math alttext="t" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><mi id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">italic_t</annotation></semantics></math>, taken from <math alttext="\boldsymbol{M}_{\theta}" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.1"><semantics id="S3.SS1.p1.4.m4.1a"><msub id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><mi id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml">𝑴</mi><mi id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2">𝑴</ci><ci id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">\boldsymbol{M}_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.1d">bold_italic_M start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> at layer <math alttext="l" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.1"><semantics id="S3.SS1.p1.5.m5.1a"><mi id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">l</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.1d">italic_l</annotation></semantics></math>. We, then, utilize <math alttext="\mathbf{F}_{t}^{[l]}" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m6.1"><semantics id="S3.SS1.p1.6.m6.1a"><msubsup id="S3.SS1.p1.6.m6.1.2" xref="S3.SS1.p1.6.m6.1.2.cmml"><mi id="S3.SS1.p1.6.m6.1.2.2.2" xref="S3.SS1.p1.6.m6.1.2.2.2.cmml">𝐅</mi><mi id="S3.SS1.p1.6.m6.1.2.2.3" xref="S3.SS1.p1.6.m6.1.2.2.3.cmml">t</mi><mrow id="S3.SS1.p1.6.m6.1.1.1.3" xref="S3.SS1.p1.6.m6.1.1.1.2.cmml"><mo id="S3.SS1.p1.6.m6.1.1.1.3.1" stretchy="false" xref="S3.SS1.p1.6.m6.1.1.1.2.1.cmml">[</mo><mi id="S3.SS1.p1.6.m6.1.1.1.1" xref="S3.SS1.p1.6.m6.1.1.1.1.cmml">l</mi><mo id="S3.SS1.p1.6.m6.1.1.1.3.2" stretchy="false" xref="S3.SS1.p1.6.m6.1.1.1.2.1.cmml">]</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.2.cmml" xref="S3.SS1.p1.6.m6.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.2.1.cmml" xref="S3.SS1.p1.6.m6.1.2">superscript</csymbol><apply id="S3.SS1.p1.6.m6.1.2.2.cmml" xref="S3.SS1.p1.6.m6.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.2.2.1.cmml" xref="S3.SS1.p1.6.m6.1.2">subscript</csymbol><ci id="S3.SS1.p1.6.m6.1.2.2.2.cmml" xref="S3.SS1.p1.6.m6.1.2.2.2">𝐅</ci><ci id="S3.SS1.p1.6.m6.1.2.2.3.cmml" xref="S3.SS1.p1.6.m6.1.2.2.3">𝑡</ci></apply><apply id="S3.SS1.p1.6.m6.1.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.1.3"><csymbol cd="latexml" id="S3.SS1.p1.6.m6.1.1.1.2.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS1.p1.6.m6.1.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1.1">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">\mathbf{F}_{t}^{[l]}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m6.1d">bold_F start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT</annotation></semantics></math> to construct the causal history states denoted as <math alttext="\mathbf{H}_{t}^{[l]}\in\mathbb{R}^{\tau\times h^{l}\times w^{l}\times c^{l}}" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m7.1"><semantics id="S3.SS1.p1.7.m7.1a"><mrow id="S3.SS1.p1.7.m7.1.2" xref="S3.SS1.p1.7.m7.1.2.cmml"><msubsup id="S3.SS1.p1.7.m7.1.2.2" xref="S3.SS1.p1.7.m7.1.2.2.cmml"><mi id="S3.SS1.p1.7.m7.1.2.2.2.2" xref="S3.SS1.p1.7.m7.1.2.2.2.2.cmml">𝐇</mi><mi id="S3.SS1.p1.7.m7.1.2.2.2.3" xref="S3.SS1.p1.7.m7.1.2.2.2.3.cmml">t</mi><mrow id="S3.SS1.p1.7.m7.1.1.1.3" xref="S3.SS1.p1.7.m7.1.1.1.2.cmml"><mo id="S3.SS1.p1.7.m7.1.1.1.3.1" stretchy="false" xref="S3.SS1.p1.7.m7.1.1.1.2.1.cmml">[</mo><mi id="S3.SS1.p1.7.m7.1.1.1.1" xref="S3.SS1.p1.7.m7.1.1.1.1.cmml">l</mi><mo id="S3.SS1.p1.7.m7.1.1.1.3.2" stretchy="false" xref="S3.SS1.p1.7.m7.1.1.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.SS1.p1.7.m7.1.2.1" xref="S3.SS1.p1.7.m7.1.2.1.cmml">∈</mo><msup id="S3.SS1.p1.7.m7.1.2.3" xref="S3.SS1.p1.7.m7.1.2.3.cmml"><mi id="S3.SS1.p1.7.m7.1.2.3.2" xref="S3.SS1.p1.7.m7.1.2.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p1.7.m7.1.2.3.3" xref="S3.SS1.p1.7.m7.1.2.3.3.cmml"><mi id="S3.SS1.p1.7.m7.1.2.3.3.2" xref="S3.SS1.p1.7.m7.1.2.3.3.2.cmml">τ</mi><mo id="S3.SS1.p1.7.m7.1.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.7.m7.1.2.3.3.1.cmml">×</mo><msup id="S3.SS1.p1.7.m7.1.2.3.3.3" xref="S3.SS1.p1.7.m7.1.2.3.3.3.cmml"><mi id="S3.SS1.p1.7.m7.1.2.3.3.3.2" xref="S3.SS1.p1.7.m7.1.2.3.3.3.2.cmml">h</mi><mi id="S3.SS1.p1.7.m7.1.2.3.3.3.3" xref="S3.SS1.p1.7.m7.1.2.3.3.3.3.cmml">l</mi></msup><mo id="S3.SS1.p1.7.m7.1.2.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.7.m7.1.2.3.3.1.cmml">×</mo><msup id="S3.SS1.p1.7.m7.1.2.3.3.4" xref="S3.SS1.p1.7.m7.1.2.3.3.4.cmml"><mi id="S3.SS1.p1.7.m7.1.2.3.3.4.2" xref="S3.SS1.p1.7.m7.1.2.3.3.4.2.cmml">w</mi><mi id="S3.SS1.p1.7.m7.1.2.3.3.4.3" xref="S3.SS1.p1.7.m7.1.2.3.3.4.3.cmml">l</mi></msup><mo id="S3.SS1.p1.7.m7.1.2.3.3.1b" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.7.m7.1.2.3.3.1.cmml">×</mo><msup id="S3.SS1.p1.7.m7.1.2.3.3.5" xref="S3.SS1.p1.7.m7.1.2.3.3.5.cmml"><mi id="S3.SS1.p1.7.m7.1.2.3.3.5.2" xref="S3.SS1.p1.7.m7.1.2.3.3.5.2.cmml">c</mi><mi id="S3.SS1.p1.7.m7.1.2.3.3.5.3" xref="S3.SS1.p1.7.m7.1.2.3.3.5.3.cmml">l</mi></msup></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><apply id="S3.SS1.p1.7.m7.1.2.cmml" xref="S3.SS1.p1.7.m7.1.2"><in id="S3.SS1.p1.7.m7.1.2.1.cmml" xref="S3.SS1.p1.7.m7.1.2.1"></in><apply id="S3.SS1.p1.7.m7.1.2.2.cmml" xref="S3.SS1.p1.7.m7.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.1.2.2.1.cmml" xref="S3.SS1.p1.7.m7.1.2.2">superscript</csymbol><apply id="S3.SS1.p1.7.m7.1.2.2.2.cmml" xref="S3.SS1.p1.7.m7.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.1.2.2.2.1.cmml" xref="S3.SS1.p1.7.m7.1.2.2">subscript</csymbol><ci id="S3.SS1.p1.7.m7.1.2.2.2.2.cmml" xref="S3.SS1.p1.7.m7.1.2.2.2.2">𝐇</ci><ci id="S3.SS1.p1.7.m7.1.2.2.2.3.cmml" xref="S3.SS1.p1.7.m7.1.2.2.2.3">𝑡</ci></apply><apply id="S3.SS1.p1.7.m7.1.1.1.2.cmml" xref="S3.SS1.p1.7.m7.1.1.1.3"><csymbol cd="latexml" id="S3.SS1.p1.7.m7.1.1.1.2.1.cmml" xref="S3.SS1.p1.7.m7.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS1.p1.7.m7.1.1.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1.1.1">𝑙</ci></apply></apply><apply id="S3.SS1.p1.7.m7.1.2.3.cmml" xref="S3.SS1.p1.7.m7.1.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.1.2.3.1.cmml" xref="S3.SS1.p1.7.m7.1.2.3">superscript</csymbol><ci id="S3.SS1.p1.7.m7.1.2.3.2.cmml" xref="S3.SS1.p1.7.m7.1.2.3.2">ℝ</ci><apply id="S3.SS1.p1.7.m7.1.2.3.3.cmml" xref="S3.SS1.p1.7.m7.1.2.3.3"><times id="S3.SS1.p1.7.m7.1.2.3.3.1.cmml" xref="S3.SS1.p1.7.m7.1.2.3.3.1"></times><ci id="S3.SS1.p1.7.m7.1.2.3.3.2.cmml" xref="S3.SS1.p1.7.m7.1.2.3.3.2">𝜏</ci><apply id="S3.SS1.p1.7.m7.1.2.3.3.3.cmml" xref="S3.SS1.p1.7.m7.1.2.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.1.2.3.3.3.1.cmml" xref="S3.SS1.p1.7.m7.1.2.3.3.3">superscript</csymbol><ci id="S3.SS1.p1.7.m7.1.2.3.3.3.2.cmml" xref="S3.SS1.p1.7.m7.1.2.3.3.3.2">ℎ</ci><ci id="S3.SS1.p1.7.m7.1.2.3.3.3.3.cmml" xref="S3.SS1.p1.7.m7.1.2.3.3.3.3">𝑙</ci></apply><apply id="S3.SS1.p1.7.m7.1.2.3.3.4.cmml" xref="S3.SS1.p1.7.m7.1.2.3.3.4"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.1.2.3.3.4.1.cmml" xref="S3.SS1.p1.7.m7.1.2.3.3.4">superscript</csymbol><ci id="S3.SS1.p1.7.m7.1.2.3.3.4.2.cmml" xref="S3.SS1.p1.7.m7.1.2.3.3.4.2">𝑤</ci><ci id="S3.SS1.p1.7.m7.1.2.3.3.4.3.cmml" xref="S3.SS1.p1.7.m7.1.2.3.3.4.3">𝑙</ci></apply><apply id="S3.SS1.p1.7.m7.1.2.3.3.5.cmml" xref="S3.SS1.p1.7.m7.1.2.3.3.5"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.1.2.3.3.5.1.cmml" xref="S3.SS1.p1.7.m7.1.2.3.3.5">superscript</csymbol><ci id="S3.SS1.p1.7.m7.1.2.3.3.5.2.cmml" xref="S3.SS1.p1.7.m7.1.2.3.3.5.2">𝑐</ci><ci id="S3.SS1.p1.7.m7.1.2.3.3.5.3.cmml" xref="S3.SS1.p1.7.m7.1.2.3.3.5.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">\mathbf{H}_{t}^{[l]}\in\mathbb{R}^{\tau\times h^{l}\times w^{l}\times c^{l}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m7.1d">bold_H start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_τ × italic_h start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT × italic_w start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT × italic_c start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="\tau" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m8.1"><semantics id="S3.SS1.p1.8.m8.1a"><mi id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><ci id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.8.m8.1d">italic_τ</annotation></semantics></math> is the truncation factor (or length of the history), <math alttext="h,w" class="ltx_Math" display="inline" id="S3.SS1.p1.9.m9.2"><semantics id="S3.SS1.p1.9.m9.2a"><mrow id="S3.SS1.p1.9.m9.2.3.2" xref="S3.SS1.p1.9.m9.2.3.1.cmml"><mi id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml">h</mi><mo id="S3.SS1.p1.9.m9.2.3.2.1" xref="S3.SS1.p1.9.m9.2.3.1.cmml">,</mo><mi id="S3.SS1.p1.9.m9.2.2" xref="S3.SS1.p1.9.m9.2.2.cmml">w</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.2b"><list id="S3.SS1.p1.9.m9.2.3.1.cmml" xref="S3.SS1.p1.9.m9.2.3.2"><ci id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1">ℎ</ci><ci id="S3.SS1.p1.9.m9.2.2.cmml" xref="S3.SS1.p1.9.m9.2.2">𝑤</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.2c">h,w</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.9.m9.2d">italic_h , italic_w</annotation></semantics></math> denote spatial resolution of the history, and <math alttext="c" class="ltx_Math" display="inline" id="S3.SS1.p1.10.m10.1"><semantics id="S3.SS1.p1.10.m10.1a"><mi id="S3.SS1.p1.10.m10.1.1" xref="S3.SS1.p1.10.m10.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m10.1b"><ci id="S3.SS1.p1.10.m10.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m10.1c">c</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.10.m10.1d">italic_c</annotation></semantics></math> denotes the channels. More specifically, <math alttext="\mathbf{H}_{t}^{[l]}=\{\mathbf{F}_{t-\tau}^{[l]}\oplus\mathbf{F}_{t-\tau+1}^{[%
l]}\oplus\ldots\oplus\mathbf{F}_{t-1}^{[l]}\}\in\mathbb{R}^{\tau\times h^{l}%
\times w^{l}\times c^{l}}" class="ltx_Math" display="inline" id="S3.SS1.p1.11.m11.5"><semantics id="S3.SS1.p1.11.m11.5a"><mrow id="S3.SS1.p1.11.m11.5.5" xref="S3.SS1.p1.11.m11.5.5.cmml"><msubsup id="S3.SS1.p1.11.m11.5.5.3" xref="S3.SS1.p1.11.m11.5.5.3.cmml"><mi id="S3.SS1.p1.11.m11.5.5.3.2.2" xref="S3.SS1.p1.11.m11.5.5.3.2.2.cmml">𝐇</mi><mi id="S3.SS1.p1.11.m11.5.5.3.2.3" xref="S3.SS1.p1.11.m11.5.5.3.2.3.cmml">t</mi><mrow id="S3.SS1.p1.11.m11.1.1.1.3" xref="S3.SS1.p1.11.m11.1.1.1.2.cmml"><mo id="S3.SS1.p1.11.m11.1.1.1.3.1" stretchy="false" xref="S3.SS1.p1.11.m11.1.1.1.2.1.cmml">[</mo><mi id="S3.SS1.p1.11.m11.1.1.1.1" xref="S3.SS1.p1.11.m11.1.1.1.1.cmml">l</mi><mo id="S3.SS1.p1.11.m11.1.1.1.3.2" stretchy="false" xref="S3.SS1.p1.11.m11.1.1.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.SS1.p1.11.m11.5.5.4" xref="S3.SS1.p1.11.m11.5.5.4.cmml">=</mo><mrow id="S3.SS1.p1.11.m11.5.5.1.1" xref="S3.SS1.p1.11.m11.5.5.1.2.cmml"><mo id="S3.SS1.p1.11.m11.5.5.1.1.2" stretchy="false" xref="S3.SS1.p1.11.m11.5.5.1.2.cmml">{</mo><mrow id="S3.SS1.p1.11.m11.5.5.1.1.1" xref="S3.SS1.p1.11.m11.5.5.1.1.1.cmml"><msubsup id="S3.SS1.p1.11.m11.5.5.1.1.1.2" xref="S3.SS1.p1.11.m11.5.5.1.1.1.2.cmml"><mi id="S3.SS1.p1.11.m11.5.5.1.1.1.2.2.2" xref="S3.SS1.p1.11.m11.5.5.1.1.1.2.2.2.cmml">𝐅</mi><mrow id="S3.SS1.p1.11.m11.5.5.1.1.1.2.2.3" xref="S3.SS1.p1.11.m11.5.5.1.1.1.2.2.3.cmml"><mi id="S3.SS1.p1.11.m11.5.5.1.1.1.2.2.3.2" xref="S3.SS1.p1.11.m11.5.5.1.1.1.2.2.3.2.cmml">t</mi><mo id="S3.SS1.p1.11.m11.5.5.1.1.1.2.2.3.1" xref="S3.SS1.p1.11.m11.5.5.1.1.1.2.2.3.1.cmml">−</mo><mi id="S3.SS1.p1.11.m11.5.5.1.1.1.2.2.3.3" xref="S3.SS1.p1.11.m11.5.5.1.1.1.2.2.3.3.cmml">τ</mi></mrow><mrow id="S3.SS1.p1.11.m11.2.2.1.3" xref="S3.SS1.p1.11.m11.2.2.1.2.cmml"><mo id="S3.SS1.p1.11.m11.2.2.1.3.1" stretchy="false" xref="S3.SS1.p1.11.m11.2.2.1.2.1.cmml">[</mo><mi id="S3.SS1.p1.11.m11.2.2.1.1" xref="S3.SS1.p1.11.m11.2.2.1.1.cmml">l</mi><mo id="S3.SS1.p1.11.m11.2.2.1.3.2" stretchy="false" xref="S3.SS1.p1.11.m11.2.2.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.SS1.p1.11.m11.5.5.1.1.1.1" xref="S3.SS1.p1.11.m11.5.5.1.1.1.1.cmml">⊕</mo><msubsup id="S3.SS1.p1.11.m11.5.5.1.1.1.3" xref="S3.SS1.p1.11.m11.5.5.1.1.1.3.cmml"><mi id="S3.SS1.p1.11.m11.5.5.1.1.1.3.2.2" xref="S3.SS1.p1.11.m11.5.5.1.1.1.3.2.2.cmml">𝐅</mi><mrow id="S3.SS1.p1.11.m11.5.5.1.1.1.3.2.3" xref="S3.SS1.p1.11.m11.5.5.1.1.1.3.2.3.cmml"><mrow id="S3.SS1.p1.11.m11.5.5.1.1.1.3.2.3.2" xref="S3.SS1.p1.11.m11.5.5.1.1.1.3.2.3.2.cmml"><mi id="S3.SS1.p1.11.m11.5.5.1.1.1.3.2.3.2.2" xref="S3.SS1.p1.11.m11.5.5.1.1.1.3.2.3.2.2.cmml">t</mi><mo id="S3.SS1.p1.11.m11.5.5.1.1.1.3.2.3.2.1" xref="S3.SS1.p1.11.m11.5.5.1.1.1.3.2.3.2.1.cmml">−</mo><mi id="S3.SS1.p1.11.m11.5.5.1.1.1.3.2.3.2.3" xref="S3.SS1.p1.11.m11.5.5.1.1.1.3.2.3.2.3.cmml">τ</mi></mrow><mo id="S3.SS1.p1.11.m11.5.5.1.1.1.3.2.3.1" xref="S3.SS1.p1.11.m11.5.5.1.1.1.3.2.3.1.cmml">+</mo><mn id="S3.SS1.p1.11.m11.5.5.1.1.1.3.2.3.3" xref="S3.SS1.p1.11.m11.5.5.1.1.1.3.2.3.3.cmml">1</mn></mrow><mrow id="S3.SS1.p1.11.m11.3.3.1.3" xref="S3.SS1.p1.11.m11.3.3.1.2.cmml"><mo id="S3.SS1.p1.11.m11.3.3.1.3.1" stretchy="false" xref="S3.SS1.p1.11.m11.3.3.1.2.1.cmml">[</mo><mi id="S3.SS1.p1.11.m11.3.3.1.1" xref="S3.SS1.p1.11.m11.3.3.1.1.cmml">l</mi><mo id="S3.SS1.p1.11.m11.3.3.1.3.2" stretchy="false" xref="S3.SS1.p1.11.m11.3.3.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.SS1.p1.11.m11.5.5.1.1.1.1a" xref="S3.SS1.p1.11.m11.5.5.1.1.1.1.cmml">⊕</mo><mi id="S3.SS1.p1.11.m11.5.5.1.1.1.4" mathvariant="normal" xref="S3.SS1.p1.11.m11.5.5.1.1.1.4.cmml">…</mi><mo id="S3.SS1.p1.11.m11.5.5.1.1.1.1b" xref="S3.SS1.p1.11.m11.5.5.1.1.1.1.cmml">⊕</mo><msubsup id="S3.SS1.p1.11.m11.5.5.1.1.1.5" xref="S3.SS1.p1.11.m11.5.5.1.1.1.5.cmml"><mi id="S3.SS1.p1.11.m11.5.5.1.1.1.5.2.2" xref="S3.SS1.p1.11.m11.5.5.1.1.1.5.2.2.cmml">𝐅</mi><mrow id="S3.SS1.p1.11.m11.5.5.1.1.1.5.2.3" xref="S3.SS1.p1.11.m11.5.5.1.1.1.5.2.3.cmml"><mi id="S3.SS1.p1.11.m11.5.5.1.1.1.5.2.3.2" xref="S3.SS1.p1.11.m11.5.5.1.1.1.5.2.3.2.cmml">t</mi><mo id="S3.SS1.p1.11.m11.5.5.1.1.1.5.2.3.1" xref="S3.SS1.p1.11.m11.5.5.1.1.1.5.2.3.1.cmml">−</mo><mn id="S3.SS1.p1.11.m11.5.5.1.1.1.5.2.3.3" xref="S3.SS1.p1.11.m11.5.5.1.1.1.5.2.3.3.cmml">1</mn></mrow><mrow id="S3.SS1.p1.11.m11.4.4.1.3" xref="S3.SS1.p1.11.m11.4.4.1.2.cmml"><mo id="S3.SS1.p1.11.m11.4.4.1.3.1" stretchy="false" xref="S3.SS1.p1.11.m11.4.4.1.2.1.cmml">[</mo><mi id="S3.SS1.p1.11.m11.4.4.1.1" xref="S3.SS1.p1.11.m11.4.4.1.1.cmml">l</mi><mo id="S3.SS1.p1.11.m11.4.4.1.3.2" stretchy="false" xref="S3.SS1.p1.11.m11.4.4.1.2.1.cmml">]</mo></mrow></msubsup></mrow><mo id="S3.SS1.p1.11.m11.5.5.1.1.3" stretchy="false" xref="S3.SS1.p1.11.m11.5.5.1.2.cmml">}</mo></mrow><mo id="S3.SS1.p1.11.m11.5.5.5" xref="S3.SS1.p1.11.m11.5.5.5.cmml">∈</mo><msup id="S3.SS1.p1.11.m11.5.5.6" xref="S3.SS1.p1.11.m11.5.5.6.cmml"><mi id="S3.SS1.p1.11.m11.5.5.6.2" xref="S3.SS1.p1.11.m11.5.5.6.2.cmml">ℝ</mi><mrow id="S3.SS1.p1.11.m11.5.5.6.3" xref="S3.SS1.p1.11.m11.5.5.6.3.cmml"><mi id="S3.SS1.p1.11.m11.5.5.6.3.2" xref="S3.SS1.p1.11.m11.5.5.6.3.2.cmml">τ</mi><mo id="S3.SS1.p1.11.m11.5.5.6.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.11.m11.5.5.6.3.1.cmml">×</mo><msup id="S3.SS1.p1.11.m11.5.5.6.3.3" xref="S3.SS1.p1.11.m11.5.5.6.3.3.cmml"><mi id="S3.SS1.p1.11.m11.5.5.6.3.3.2" xref="S3.SS1.p1.11.m11.5.5.6.3.3.2.cmml">h</mi><mi id="S3.SS1.p1.11.m11.5.5.6.3.3.3" xref="S3.SS1.p1.11.m11.5.5.6.3.3.3.cmml">l</mi></msup><mo id="S3.SS1.p1.11.m11.5.5.6.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.11.m11.5.5.6.3.1.cmml">×</mo><msup id="S3.SS1.p1.11.m11.5.5.6.3.4" xref="S3.SS1.p1.11.m11.5.5.6.3.4.cmml"><mi id="S3.SS1.p1.11.m11.5.5.6.3.4.2" xref="S3.SS1.p1.11.m11.5.5.6.3.4.2.cmml">w</mi><mi id="S3.SS1.p1.11.m11.5.5.6.3.4.3" xref="S3.SS1.p1.11.m11.5.5.6.3.4.3.cmml">l</mi></msup><mo id="S3.SS1.p1.11.m11.5.5.6.3.1b" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.11.m11.5.5.6.3.1.cmml">×</mo><msup id="S3.SS1.p1.11.m11.5.5.6.3.5" xref="S3.SS1.p1.11.m11.5.5.6.3.5.cmml"><mi id="S3.SS1.p1.11.m11.5.5.6.3.5.2" xref="S3.SS1.p1.11.m11.5.5.6.3.5.2.cmml">c</mi><mi id="S3.SS1.p1.11.m11.5.5.6.3.5.3" xref="S3.SS1.p1.11.m11.5.5.6.3.5.3.cmml">l</mi></msup></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m11.5b"><apply id="S3.SS1.p1.11.m11.5.5.cmml" xref="S3.SS1.p1.11.m11.5.5"><and id="S3.SS1.p1.11.m11.5.5a.cmml" xref="S3.SS1.p1.11.m11.5.5"></and><apply id="S3.SS1.p1.11.m11.5.5b.cmml" xref="S3.SS1.p1.11.m11.5.5"><eq id="S3.SS1.p1.11.m11.5.5.4.cmml" xref="S3.SS1.p1.11.m11.5.5.4"></eq><apply id="S3.SS1.p1.11.m11.5.5.3.cmml" xref="S3.SS1.p1.11.m11.5.5.3"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.5.5.3.1.cmml" xref="S3.SS1.p1.11.m11.5.5.3">superscript</csymbol><apply id="S3.SS1.p1.11.m11.5.5.3.2.cmml" xref="S3.SS1.p1.11.m11.5.5.3"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.5.5.3.2.1.cmml" xref="S3.SS1.p1.11.m11.5.5.3">subscript</csymbol><ci id="S3.SS1.p1.11.m11.5.5.3.2.2.cmml" xref="S3.SS1.p1.11.m11.5.5.3.2.2">𝐇</ci><ci id="S3.SS1.p1.11.m11.5.5.3.2.3.cmml" xref="S3.SS1.p1.11.m11.5.5.3.2.3">𝑡</ci></apply><apply id="S3.SS1.p1.11.m11.1.1.1.2.cmml" xref="S3.SS1.p1.11.m11.1.1.1.3"><csymbol cd="latexml" id="S3.SS1.p1.11.m11.1.1.1.2.1.cmml" xref="S3.SS1.p1.11.m11.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS1.p1.11.m11.1.1.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1.1.1">𝑙</ci></apply></apply><set id="S3.SS1.p1.11.m11.5.5.1.2.cmml" xref="S3.SS1.p1.11.m11.5.5.1.1"><apply id="S3.SS1.p1.11.m11.5.5.1.1.1.cmml" xref="S3.SS1.p1.11.m11.5.5.1.1.1"><csymbol cd="latexml" id="S3.SS1.p1.11.m11.5.5.1.1.1.1.cmml" xref="S3.SS1.p1.11.m11.5.5.1.1.1.1">direct-sum</csymbol><apply id="S3.SS1.p1.11.m11.5.5.1.1.1.2.cmml" xref="S3.SS1.p1.11.m11.5.5.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.5.5.1.1.1.2.1.cmml" xref="S3.SS1.p1.11.m11.5.5.1.1.1.2">superscript</csymbol><apply id="S3.SS1.p1.11.m11.5.5.1.1.1.2.2.cmml" xref="S3.SS1.p1.11.m11.5.5.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.5.5.1.1.1.2.2.1.cmml" xref="S3.SS1.p1.11.m11.5.5.1.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.11.m11.5.5.1.1.1.2.2.2.cmml" xref="S3.SS1.p1.11.m11.5.5.1.1.1.2.2.2">𝐅</ci><apply id="S3.SS1.p1.11.m11.5.5.1.1.1.2.2.3.cmml" xref="S3.SS1.p1.11.m11.5.5.1.1.1.2.2.3"><minus id="S3.SS1.p1.11.m11.5.5.1.1.1.2.2.3.1.cmml" xref="S3.SS1.p1.11.m11.5.5.1.1.1.2.2.3.1"></minus><ci id="S3.SS1.p1.11.m11.5.5.1.1.1.2.2.3.2.cmml" xref="S3.SS1.p1.11.m11.5.5.1.1.1.2.2.3.2">𝑡</ci><ci id="S3.SS1.p1.11.m11.5.5.1.1.1.2.2.3.3.cmml" xref="S3.SS1.p1.11.m11.5.5.1.1.1.2.2.3.3">𝜏</ci></apply></apply><apply id="S3.SS1.p1.11.m11.2.2.1.2.cmml" xref="S3.SS1.p1.11.m11.2.2.1.3"><csymbol cd="latexml" id="S3.SS1.p1.11.m11.2.2.1.2.1.cmml" xref="S3.SS1.p1.11.m11.2.2.1.3.1">delimited-[]</csymbol><ci id="S3.SS1.p1.11.m11.2.2.1.1.cmml" xref="S3.SS1.p1.11.m11.2.2.1.1">𝑙</ci></apply></apply><apply id="S3.SS1.p1.11.m11.5.5.1.1.1.3.cmml" xref="S3.SS1.p1.11.m11.5.5.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.5.5.1.1.1.3.1.cmml" xref="S3.SS1.p1.11.m11.5.5.1.1.1.3">superscript</csymbol><apply id="S3.SS1.p1.11.m11.5.5.1.1.1.3.2.cmml" xref="S3.SS1.p1.11.m11.5.5.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.5.5.1.1.1.3.2.1.cmml" xref="S3.SS1.p1.11.m11.5.5.1.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.11.m11.5.5.1.1.1.3.2.2.cmml" xref="S3.SS1.p1.11.m11.5.5.1.1.1.3.2.2">𝐅</ci><apply id="S3.SS1.p1.11.m11.5.5.1.1.1.3.2.3.cmml" xref="S3.SS1.p1.11.m11.5.5.1.1.1.3.2.3"><plus id="S3.SS1.p1.11.m11.5.5.1.1.1.3.2.3.1.cmml" xref="S3.SS1.p1.11.m11.5.5.1.1.1.3.2.3.1"></plus><apply id="S3.SS1.p1.11.m11.5.5.1.1.1.3.2.3.2.cmml" xref="S3.SS1.p1.11.m11.5.5.1.1.1.3.2.3.2"><minus id="S3.SS1.p1.11.m11.5.5.1.1.1.3.2.3.2.1.cmml" xref="S3.SS1.p1.11.m11.5.5.1.1.1.3.2.3.2.1"></minus><ci id="S3.SS1.p1.11.m11.5.5.1.1.1.3.2.3.2.2.cmml" xref="S3.SS1.p1.11.m11.5.5.1.1.1.3.2.3.2.2">𝑡</ci><ci id="S3.SS1.p1.11.m11.5.5.1.1.1.3.2.3.2.3.cmml" xref="S3.SS1.p1.11.m11.5.5.1.1.1.3.2.3.2.3">𝜏</ci></apply><cn id="S3.SS1.p1.11.m11.5.5.1.1.1.3.2.3.3.cmml" type="integer" xref="S3.SS1.p1.11.m11.5.5.1.1.1.3.2.3.3">1</cn></apply></apply><apply id="S3.SS1.p1.11.m11.3.3.1.2.cmml" xref="S3.SS1.p1.11.m11.3.3.1.3"><csymbol cd="latexml" id="S3.SS1.p1.11.m11.3.3.1.2.1.cmml" xref="S3.SS1.p1.11.m11.3.3.1.3.1">delimited-[]</csymbol><ci id="S3.SS1.p1.11.m11.3.3.1.1.cmml" xref="S3.SS1.p1.11.m11.3.3.1.1">𝑙</ci></apply></apply><ci id="S3.SS1.p1.11.m11.5.5.1.1.1.4.cmml" xref="S3.SS1.p1.11.m11.5.5.1.1.1.4">…</ci><apply id="S3.SS1.p1.11.m11.5.5.1.1.1.5.cmml" xref="S3.SS1.p1.11.m11.5.5.1.1.1.5"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.5.5.1.1.1.5.1.cmml" xref="S3.SS1.p1.11.m11.5.5.1.1.1.5">superscript</csymbol><apply id="S3.SS1.p1.11.m11.5.5.1.1.1.5.2.cmml" xref="S3.SS1.p1.11.m11.5.5.1.1.1.5"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.5.5.1.1.1.5.2.1.cmml" xref="S3.SS1.p1.11.m11.5.5.1.1.1.5">subscript</csymbol><ci id="S3.SS1.p1.11.m11.5.5.1.1.1.5.2.2.cmml" xref="S3.SS1.p1.11.m11.5.5.1.1.1.5.2.2">𝐅</ci><apply id="S3.SS1.p1.11.m11.5.5.1.1.1.5.2.3.cmml" xref="S3.SS1.p1.11.m11.5.5.1.1.1.5.2.3"><minus id="S3.SS1.p1.11.m11.5.5.1.1.1.5.2.3.1.cmml" xref="S3.SS1.p1.11.m11.5.5.1.1.1.5.2.3.1"></minus><ci id="S3.SS1.p1.11.m11.5.5.1.1.1.5.2.3.2.cmml" xref="S3.SS1.p1.11.m11.5.5.1.1.1.5.2.3.2">𝑡</ci><cn id="S3.SS1.p1.11.m11.5.5.1.1.1.5.2.3.3.cmml" type="integer" xref="S3.SS1.p1.11.m11.5.5.1.1.1.5.2.3.3">1</cn></apply></apply><apply id="S3.SS1.p1.11.m11.4.4.1.2.cmml" xref="S3.SS1.p1.11.m11.4.4.1.3"><csymbol cd="latexml" id="S3.SS1.p1.11.m11.4.4.1.2.1.cmml" xref="S3.SS1.p1.11.m11.4.4.1.3.1">delimited-[]</csymbol><ci id="S3.SS1.p1.11.m11.4.4.1.1.cmml" xref="S3.SS1.p1.11.m11.4.4.1.1">𝑙</ci></apply></apply></apply></set></apply><apply id="S3.SS1.p1.11.m11.5.5c.cmml" xref="S3.SS1.p1.11.m11.5.5"><in id="S3.SS1.p1.11.m11.5.5.5.cmml" xref="S3.SS1.p1.11.m11.5.5.5"></in><share href="https://arxiv.org/html/2410.03936v1#S3.SS1.p1.11.m11.5.5.1.cmml" id="S3.SS1.p1.11.m11.5.5d.cmml" xref="S3.SS1.p1.11.m11.5.5"></share><apply id="S3.SS1.p1.11.m11.5.5.6.cmml" xref="S3.SS1.p1.11.m11.5.5.6"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.5.5.6.1.cmml" xref="S3.SS1.p1.11.m11.5.5.6">superscript</csymbol><ci id="S3.SS1.p1.11.m11.5.5.6.2.cmml" xref="S3.SS1.p1.11.m11.5.5.6.2">ℝ</ci><apply id="S3.SS1.p1.11.m11.5.5.6.3.cmml" xref="S3.SS1.p1.11.m11.5.5.6.3"><times id="S3.SS1.p1.11.m11.5.5.6.3.1.cmml" xref="S3.SS1.p1.11.m11.5.5.6.3.1"></times><ci id="S3.SS1.p1.11.m11.5.5.6.3.2.cmml" xref="S3.SS1.p1.11.m11.5.5.6.3.2">𝜏</ci><apply id="S3.SS1.p1.11.m11.5.5.6.3.3.cmml" xref="S3.SS1.p1.11.m11.5.5.6.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.5.5.6.3.3.1.cmml" xref="S3.SS1.p1.11.m11.5.5.6.3.3">superscript</csymbol><ci id="S3.SS1.p1.11.m11.5.5.6.3.3.2.cmml" xref="S3.SS1.p1.11.m11.5.5.6.3.3.2">ℎ</ci><ci id="S3.SS1.p1.11.m11.5.5.6.3.3.3.cmml" xref="S3.SS1.p1.11.m11.5.5.6.3.3.3">𝑙</ci></apply><apply id="S3.SS1.p1.11.m11.5.5.6.3.4.cmml" xref="S3.SS1.p1.11.m11.5.5.6.3.4"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.5.5.6.3.4.1.cmml" xref="S3.SS1.p1.11.m11.5.5.6.3.4">superscript</csymbol><ci id="S3.SS1.p1.11.m11.5.5.6.3.4.2.cmml" xref="S3.SS1.p1.11.m11.5.5.6.3.4.2">𝑤</ci><ci id="S3.SS1.p1.11.m11.5.5.6.3.4.3.cmml" xref="S3.SS1.p1.11.m11.5.5.6.3.4.3">𝑙</ci></apply><apply id="S3.SS1.p1.11.m11.5.5.6.3.5.cmml" xref="S3.SS1.p1.11.m11.5.5.6.3.5"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.5.5.6.3.5.1.cmml" xref="S3.SS1.p1.11.m11.5.5.6.3.5">superscript</csymbol><ci id="S3.SS1.p1.11.m11.5.5.6.3.5.2.cmml" xref="S3.SS1.p1.11.m11.5.5.6.3.5.2">𝑐</ci><ci id="S3.SS1.p1.11.m11.5.5.6.3.5.3.cmml" xref="S3.SS1.p1.11.m11.5.5.6.3.5.3">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m11.5c">\mathbf{H}_{t}^{[l]}=\{\mathbf{F}_{t-\tau}^{[l]}\oplus\mathbf{F}_{t-\tau+1}^{[%
l]}\oplus\ldots\oplus\mathbf{F}_{t-1}^{[l]}\}\in\mathbb{R}^{\tau\times h^{l}%
\times w^{l}\times c^{l}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.11.m11.5d">bold_H start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT = { bold_F start_POSTSUBSCRIPT italic_t - italic_τ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT ⊕ bold_F start_POSTSUBSCRIPT italic_t - italic_τ + 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT ⊕ … ⊕ bold_F start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT } ∈ blackboard_R start_POSTSUPERSCRIPT italic_τ × italic_h start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT × italic_w start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT × italic_c start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="\oplus" class="ltx_Math" display="inline" id="S3.SS1.p1.12.m12.1"><semantics id="S3.SS1.p1.12.m12.1a"><mo id="S3.SS1.p1.12.m12.1.1" xref="S3.SS1.p1.12.m12.1.1.cmml">⊕</mo><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m12.1b"><csymbol cd="latexml" id="S3.SS1.p1.12.m12.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1">direct-sum</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m12.1c">\oplus</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.12.m12.1d">⊕</annotation></semantics></math> is the concatenation operation.
We denote the motion-compensated history at timestep <math alttext="t" class="ltx_Math" display="inline" id="S3.SS1.p1.13.m13.1"><semantics id="S3.SS1.p1.13.m13.1a"><mi id="S3.SS1.p1.13.m13.1.1" xref="S3.SS1.p1.13.m13.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m13.1b"><ci id="S3.SS1.p1.13.m13.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.13.m13.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.13.m13.1d">italic_t</annotation></semantics></math> as <math alttext="\mathbf{\hat{H}}_{t}^{[l]}" class="ltx_Math" display="inline" id="S3.SS1.p1.14.m14.1"><semantics id="S3.SS1.p1.14.m14.1a"><msubsup id="S3.SS1.p1.14.m14.1.2" xref="S3.SS1.p1.14.m14.1.2.cmml"><mover accent="true" id="S3.SS1.p1.14.m14.1.2.2.2" xref="S3.SS1.p1.14.m14.1.2.2.2.cmml"><mi id="S3.SS1.p1.14.m14.1.2.2.2.2" xref="S3.SS1.p1.14.m14.1.2.2.2.2.cmml">𝐇</mi><mo id="S3.SS1.p1.14.m14.1.2.2.2.1" xref="S3.SS1.p1.14.m14.1.2.2.2.1.cmml">^</mo></mover><mi id="S3.SS1.p1.14.m14.1.2.2.3" xref="S3.SS1.p1.14.m14.1.2.2.3.cmml">t</mi><mrow id="S3.SS1.p1.14.m14.1.1.1.3" xref="S3.SS1.p1.14.m14.1.1.1.2.cmml"><mo id="S3.SS1.p1.14.m14.1.1.1.3.1" stretchy="false" xref="S3.SS1.p1.14.m14.1.1.1.2.1.cmml">[</mo><mi id="S3.SS1.p1.14.m14.1.1.1.1" xref="S3.SS1.p1.14.m14.1.1.1.1.cmml">l</mi><mo id="S3.SS1.p1.14.m14.1.1.1.3.2" stretchy="false" xref="S3.SS1.p1.14.m14.1.1.1.2.1.cmml">]</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.14.m14.1b"><apply id="S3.SS1.p1.14.m14.1.2.cmml" xref="S3.SS1.p1.14.m14.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m14.1.2.1.cmml" xref="S3.SS1.p1.14.m14.1.2">superscript</csymbol><apply id="S3.SS1.p1.14.m14.1.2.2.cmml" xref="S3.SS1.p1.14.m14.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m14.1.2.2.1.cmml" xref="S3.SS1.p1.14.m14.1.2">subscript</csymbol><apply id="S3.SS1.p1.14.m14.1.2.2.2.cmml" xref="S3.SS1.p1.14.m14.1.2.2.2"><ci id="S3.SS1.p1.14.m14.1.2.2.2.1.cmml" xref="S3.SS1.p1.14.m14.1.2.2.2.1">^</ci><ci id="S3.SS1.p1.14.m14.1.2.2.2.2.cmml" xref="S3.SS1.p1.14.m14.1.2.2.2.2">𝐇</ci></apply><ci id="S3.SS1.p1.14.m14.1.2.2.3.cmml" xref="S3.SS1.p1.14.m14.1.2.2.3">𝑡</ci></apply><apply id="S3.SS1.p1.14.m14.1.1.1.2.cmml" xref="S3.SS1.p1.14.m14.1.1.1.3"><csymbol cd="latexml" id="S3.SS1.p1.14.m14.1.1.1.2.1.cmml" xref="S3.SS1.p1.14.m14.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS1.p1.14.m14.1.1.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1.1.1">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.14.m14.1c">\mathbf{\hat{H}}_{t}^{[l]}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.14.m14.1d">over^ start_ARG bold_H end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT</annotation></semantics></math>, which is compensated for motion with respect to the input frame features <math alttext="\mathbf{F}_{t}^{[l]}" class="ltx_Math" display="inline" id="S3.SS1.p1.15.m15.1"><semantics id="S3.SS1.p1.15.m15.1a"><msubsup id="S3.SS1.p1.15.m15.1.2" xref="S3.SS1.p1.15.m15.1.2.cmml"><mi id="S3.SS1.p1.15.m15.1.2.2.2" xref="S3.SS1.p1.15.m15.1.2.2.2.cmml">𝐅</mi><mi id="S3.SS1.p1.15.m15.1.2.2.3" xref="S3.SS1.p1.15.m15.1.2.2.3.cmml">t</mi><mrow id="S3.SS1.p1.15.m15.1.1.1.3" xref="S3.SS1.p1.15.m15.1.1.1.2.cmml"><mo id="S3.SS1.p1.15.m15.1.1.1.3.1" stretchy="false" xref="S3.SS1.p1.15.m15.1.1.1.2.1.cmml">[</mo><mi id="S3.SS1.p1.15.m15.1.1.1.1" xref="S3.SS1.p1.15.m15.1.1.1.1.cmml">l</mi><mo id="S3.SS1.p1.15.m15.1.1.1.3.2" stretchy="false" xref="S3.SS1.p1.15.m15.1.1.1.2.1.cmml">]</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.15.m15.1b"><apply id="S3.SS1.p1.15.m15.1.2.cmml" xref="S3.SS1.p1.15.m15.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.15.m15.1.2.1.cmml" xref="S3.SS1.p1.15.m15.1.2">superscript</csymbol><apply id="S3.SS1.p1.15.m15.1.2.2.cmml" xref="S3.SS1.p1.15.m15.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.15.m15.1.2.2.1.cmml" xref="S3.SS1.p1.15.m15.1.2">subscript</csymbol><ci id="S3.SS1.p1.15.m15.1.2.2.2.cmml" xref="S3.SS1.p1.15.m15.1.2.2.2">𝐅</ci><ci id="S3.SS1.p1.15.m15.1.2.2.3.cmml" xref="S3.SS1.p1.15.m15.1.2.2.3">𝑡</ci></apply><apply id="S3.SS1.p1.15.m15.1.1.1.2.cmml" xref="S3.SS1.p1.15.m15.1.1.1.3"><csymbol cd="latexml" id="S3.SS1.p1.15.m15.1.1.1.2.1.cmml" xref="S3.SS1.p1.15.m15.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS1.p1.15.m15.1.1.1.1.cmml" xref="S3.SS1.p1.15.m15.1.1.1.1">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.15.m15.1c">\mathbf{F}_{t}^{[l]}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.15.m15.1d">bold_F start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT</annotation></semantics></math>. In this work, the state refers to the representation of a frame of the video. Further, history states (or causal history states) refers to a set of certain frame features previous to the input at some timestep.</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.6"><span class="ltx_text ltx_font_smallcaps" id="S3.SS1.p2.6.1">Turtle</span>’s encoder learns a representation of each frame by downsampling the spatial resolution, while inflating the channel dimensions by a factor of <math alttext="2" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><mn id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><cn id="S3.SS1.p2.1.m1.1.1.cmml" type="integer" xref="S3.SS1.p2.1.m1.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">2</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">2</annotation></semantics></math>. At each stage of the encoder, we opt for several stacked convolutional feedforward blocks, termed as Historyless FFN,<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>We use the term <span class="ltx_text ltx_inline-quote ltx_outerquote" id="footnote2.1">“Historyless”</span> because the encoder is not conditioned on the history of input.</span></span></span>.
The learned representation at the last encoder stage onwards is fed to a running history queue <math alttext="\mathcal{Q}" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">𝒬</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">𝒬</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">\mathcal{Q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">caligraphic_Q</annotation></semantics></math> of length <math alttext="\gamma" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.1"><semantics id="S3.SS1.p2.3.m3.1a"><mi id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.1d">italic_γ</annotation></semantics></math>.<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>The space complexity is limited to <math alttext="\mathcal{O}(\gamma\times h\times w\times c)" class="ltx_Math" display="inline" id="footnote3.m1.1"><semantics id="footnote3.m1.1b"><mrow id="footnote3.m1.1.1" xref="footnote3.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="footnote3.m1.1.1.3" xref="footnote3.m1.1.1.3.cmml">𝒪</mi><mo id="footnote3.m1.1.1.2" xref="footnote3.m1.1.1.2.cmml">⁢</mo><mrow id="footnote3.m1.1.1.1.1" xref="footnote3.m1.1.1.1.1.1.cmml"><mo id="footnote3.m1.1.1.1.1.2" stretchy="false" xref="footnote3.m1.1.1.1.1.1.cmml">(</mo><mrow id="footnote3.m1.1.1.1.1.1" xref="footnote3.m1.1.1.1.1.1.cmml"><mi id="footnote3.m1.1.1.1.1.1.2" xref="footnote3.m1.1.1.1.1.1.2.cmml">γ</mi><mo id="footnote3.m1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="footnote3.m1.1.1.1.1.1.1.cmml">×</mo><mi id="footnote3.m1.1.1.1.1.1.3" xref="footnote3.m1.1.1.1.1.1.3.cmml">h</mi><mo id="footnote3.m1.1.1.1.1.1.1b" lspace="0.222em" rspace="0.222em" xref="footnote3.m1.1.1.1.1.1.1.cmml">×</mo><mi id="footnote3.m1.1.1.1.1.1.4" xref="footnote3.m1.1.1.1.1.1.4.cmml">w</mi><mo id="footnote3.m1.1.1.1.1.1.1c" lspace="0.222em" rspace="0.222em" xref="footnote3.m1.1.1.1.1.1.1.cmml">×</mo><mi id="footnote3.m1.1.1.1.1.1.5" xref="footnote3.m1.1.1.1.1.1.5.cmml">c</mi></mrow><mo id="footnote3.m1.1.1.1.1.3" stretchy="false" xref="footnote3.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="footnote3.m1.1c"><apply id="footnote3.m1.1.1.cmml" xref="footnote3.m1.1.1"><times id="footnote3.m1.1.1.2.cmml" xref="footnote3.m1.1.1.2"></times><ci id="footnote3.m1.1.1.3.cmml" xref="footnote3.m1.1.1.3">𝒪</ci><apply id="footnote3.m1.1.1.1.1.1.cmml" xref="footnote3.m1.1.1.1.1"><times id="footnote3.m1.1.1.1.1.1.1.cmml" xref="footnote3.m1.1.1.1.1.1.1"></times><ci id="footnote3.m1.1.1.1.1.1.2.cmml" xref="footnote3.m1.1.1.1.1.1.2">𝛾</ci><ci id="footnote3.m1.1.1.1.1.1.3.cmml" xref="footnote3.m1.1.1.1.1.1.3">ℎ</ci><ci id="footnote3.m1.1.1.1.1.1.4.cmml" xref="footnote3.m1.1.1.1.1.1.4">𝑤</ci><ci id="footnote3.m1.1.1.1.1.1.5.cmml" xref="footnote3.m1.1.1.1.1.1.5">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote3.m1.1d">\mathcal{O}(\gamma\times h\times w\times c)</annotation><annotation encoding="application/x-llamapun" id="footnote3.m1.1e">caligraphic_O ( italic_γ × italic_h × italic_w × italic_c )</annotation></semantics></math> and <math alttext="(\gamma\times h\times w\times c)&lt;&lt;(T\times H\times W\times C)" class="ltx_Math" display="inline" id="footnote3.m2.2"><semantics id="footnote3.m2.2b"><mrow id="footnote3.m2.2.2" xref="footnote3.m2.2.2.cmml"><mrow id="footnote3.m2.1.1.1.1" xref="footnote3.m2.1.1.1.1.1.cmml"><mo id="footnote3.m2.1.1.1.1.2" stretchy="false" xref="footnote3.m2.1.1.1.1.1.cmml">(</mo><mrow id="footnote3.m2.1.1.1.1.1" xref="footnote3.m2.1.1.1.1.1.cmml"><mi id="footnote3.m2.1.1.1.1.1.2" xref="footnote3.m2.1.1.1.1.1.2.cmml">γ</mi><mo id="footnote3.m2.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="footnote3.m2.1.1.1.1.1.1.cmml">×</mo><mi id="footnote3.m2.1.1.1.1.1.3" xref="footnote3.m2.1.1.1.1.1.3.cmml">h</mi><mo id="footnote3.m2.1.1.1.1.1.1b" lspace="0.222em" rspace="0.222em" xref="footnote3.m2.1.1.1.1.1.1.cmml">×</mo><mi id="footnote3.m2.1.1.1.1.1.4" xref="footnote3.m2.1.1.1.1.1.4.cmml">w</mi><mo id="footnote3.m2.1.1.1.1.1.1c" lspace="0.222em" rspace="0.222em" xref="footnote3.m2.1.1.1.1.1.1.cmml">×</mo><mi id="footnote3.m2.1.1.1.1.1.5" xref="footnote3.m2.1.1.1.1.1.5.cmml">c</mi></mrow><mo id="footnote3.m2.1.1.1.1.3" stretchy="false" xref="footnote3.m2.1.1.1.1.1.cmml">)</mo></mrow><mo id="footnote3.m2.2.2.3" xref="footnote3.m2.2.2.3.cmml">&lt;&lt;</mo><mrow id="footnote3.m2.2.2.2.1" xref="footnote3.m2.2.2.2.1.1.cmml"><mo id="footnote3.m2.2.2.2.1.2" stretchy="false" xref="footnote3.m2.2.2.2.1.1.cmml">(</mo><mrow id="footnote3.m2.2.2.2.1.1" xref="footnote3.m2.2.2.2.1.1.cmml"><mi id="footnote3.m2.2.2.2.1.1.2" xref="footnote3.m2.2.2.2.1.1.2.cmml">T</mi><mo id="footnote3.m2.2.2.2.1.1.1" lspace="0.222em" rspace="0.222em" xref="footnote3.m2.2.2.2.1.1.1.cmml">×</mo><mi id="footnote3.m2.2.2.2.1.1.3" xref="footnote3.m2.2.2.2.1.1.3.cmml">H</mi><mo id="footnote3.m2.2.2.2.1.1.1b" lspace="0.222em" rspace="0.222em" xref="footnote3.m2.2.2.2.1.1.1.cmml">×</mo><mi id="footnote3.m2.2.2.2.1.1.4" xref="footnote3.m2.2.2.2.1.1.4.cmml">W</mi><mo id="footnote3.m2.2.2.2.1.1.1c" lspace="0.222em" rspace="0.222em" xref="footnote3.m2.2.2.2.1.1.1.cmml">×</mo><mi id="footnote3.m2.2.2.2.1.1.5" xref="footnote3.m2.2.2.2.1.1.5.cmml">C</mi></mrow><mo id="footnote3.m2.2.2.2.1.3" stretchy="false" xref="footnote3.m2.2.2.2.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="footnote3.m2.2c"><apply id="footnote3.m2.2.2.cmml" xref="footnote3.m2.2.2"><csymbol cd="latexml" id="footnote3.m2.2.2.3.cmml" xref="footnote3.m2.2.2.3">much-less-than</csymbol><apply id="footnote3.m2.1.1.1.1.1.cmml" xref="footnote3.m2.1.1.1.1"><times id="footnote3.m2.1.1.1.1.1.1.cmml" xref="footnote3.m2.1.1.1.1.1.1"></times><ci id="footnote3.m2.1.1.1.1.1.2.cmml" xref="footnote3.m2.1.1.1.1.1.2">𝛾</ci><ci id="footnote3.m2.1.1.1.1.1.3.cmml" xref="footnote3.m2.1.1.1.1.1.3">ℎ</ci><ci id="footnote3.m2.1.1.1.1.1.4.cmml" xref="footnote3.m2.1.1.1.1.1.4">𝑤</ci><ci id="footnote3.m2.1.1.1.1.1.5.cmml" xref="footnote3.m2.1.1.1.1.1.5">𝑐</ci></apply><apply id="footnote3.m2.2.2.2.1.1.cmml" xref="footnote3.m2.2.2.2.1"><times id="footnote3.m2.2.2.2.1.1.1.cmml" xref="footnote3.m2.2.2.2.1.1.1"></times><ci id="footnote3.m2.2.2.2.1.1.2.cmml" xref="footnote3.m2.2.2.2.1.1.2">𝑇</ci><ci id="footnote3.m2.2.2.2.1.1.3.cmml" xref="footnote3.m2.2.2.2.1.1.3">𝐻</ci><ci id="footnote3.m2.2.2.2.1.1.4.cmml" xref="footnote3.m2.2.2.2.1.1.4">𝑊</ci><ci id="footnote3.m2.2.2.2.1.1.5.cmml" xref="footnote3.m2.2.2.2.1.1.5">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote3.m2.2d">(\gamma\times h\times w\times c)&lt;&lt;(T\times H\times W\times C)</annotation><annotation encoding="application/x-llamapun" id="footnote3.m2.2e">( italic_γ × italic_h × italic_w × italic_c ) &lt; &lt; ( italic_T × italic_H × italic_W × italic_C )</annotation></semantics></math> because <math alttext="\gamma&lt;&lt;T" class="ltx_Math" display="inline" id="footnote3.m3.1"><semantics id="footnote3.m3.1b"><mrow id="footnote3.m3.1.1" xref="footnote3.m3.1.1.cmml"><mi id="footnote3.m3.1.1.2" xref="footnote3.m3.1.1.2.cmml">γ</mi><mo id="footnote3.m3.1.1.1" xref="footnote3.m3.1.1.1.cmml">&lt;&lt;</mo><mi id="footnote3.m3.1.1.3" xref="footnote3.m3.1.1.3.cmml">T</mi></mrow><annotation-xml encoding="MathML-Content" id="footnote3.m3.1c"><apply id="footnote3.m3.1.1.cmml" xref="footnote3.m3.1.1"><csymbol cd="latexml" id="footnote3.m3.1.1.1.cmml" xref="footnote3.m3.1.1.1">much-less-than</csymbol><ci id="footnote3.m3.1.1.2.cmml" xref="footnote3.m3.1.1.2">𝛾</ci><ci id="footnote3.m3.1.1.3.cmml" xref="footnote3.m3.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote3.m3.1d">\gamma&lt;&lt;T</annotation><annotation encoding="application/x-llamapun" id="footnote3.m3.1e">italic_γ &lt; &lt; italic_T</annotation></semantics></math>, and <math alttext="h&lt;&lt;H,w&lt;&lt;W" class="ltx_Math" display="inline" id="footnote3.m4.4"><semantics id="footnote3.m4.4b"><mrow id="footnote3.m4.4.4.2" xref="footnote3.m4.4.4.3.cmml"><mrow id="footnote3.m4.3.3.1.1" xref="footnote3.m4.3.3.1.1.cmml"><mi id="footnote3.m4.3.3.1.1.2" xref="footnote3.m4.3.3.1.1.2.cmml">h</mi><mo id="footnote3.m4.3.3.1.1.1" xref="footnote3.m4.3.3.1.1.1.cmml">&lt;&lt;</mo><mi id="footnote3.m4.1.1" xref="footnote3.m4.1.1.cmml">H</mi></mrow><mo id="footnote3.m4.4.4.2.3" xref="footnote3.m4.4.4.3a.cmml">,</mo><mrow id="footnote3.m4.4.4.2.2" xref="footnote3.m4.4.4.2.2.cmml"><mi id="footnote3.m4.2.2" xref="footnote3.m4.2.2.cmml">w</mi><mo id="footnote3.m4.4.4.2.2.1" xref="footnote3.m4.4.4.2.2.1.cmml">&lt;&lt;</mo><mi id="footnote3.m4.4.4.2.2.2" xref="footnote3.m4.4.4.2.2.2.cmml">W</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="footnote3.m4.4c"><apply id="footnote3.m4.4.4.3.cmml" xref="footnote3.m4.4.4.2"><csymbol cd="ambiguous" id="footnote3.m4.4.4.3a.cmml" xref="footnote3.m4.4.4.2.3">formulae-sequence</csymbol><apply id="footnote3.m4.3.3.1.1.cmml" xref="footnote3.m4.3.3.1.1"><csymbol cd="latexml" id="footnote3.m4.3.3.1.1.1.cmml" xref="footnote3.m4.3.3.1.1.1">much-less-than</csymbol><ci id="footnote3.m4.3.3.1.1.2.cmml" xref="footnote3.m4.3.3.1.1.2">ℎ</ci><ci id="footnote3.m4.1.1.cmml" xref="footnote3.m4.1.1">𝐻</ci></apply><apply id="footnote3.m4.4.4.2.2.cmml" xref="footnote3.m4.4.4.2.2"><csymbol cd="latexml" id="footnote3.m4.4.4.2.2.1.cmml" xref="footnote3.m4.4.4.2.2.1">much-less-than</csymbol><ci id="footnote3.m4.2.2.cmml" xref="footnote3.m4.2.2">𝑤</ci><ci id="footnote3.m4.4.4.2.2.2.cmml" xref="footnote3.m4.4.4.2.2.2">𝑊</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote3.m4.4d">h&lt;&lt;H,w&lt;&lt;W</annotation><annotation encoding="application/x-llamapun" id="footnote3.m4.4e">italic_h &lt; &lt; italic_H , italic_w &lt; &lt; italic_W</annotation></semantics></math>, and all enqueue and dequeue operations are <math alttext="\mathcal{O}(1)" class="ltx_Math" display="inline" id="footnote3.m5.1"><semantics id="footnote3.m5.1b"><mrow id="footnote3.m5.1.2" xref="footnote3.m5.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="footnote3.m5.1.2.2" xref="footnote3.m5.1.2.2.cmml">𝒪</mi><mo id="footnote3.m5.1.2.1" xref="footnote3.m5.1.2.1.cmml">⁢</mo><mrow id="footnote3.m5.1.2.3.2" xref="footnote3.m5.1.2.cmml"><mo id="footnote3.m5.1.2.3.2.1" stretchy="false" xref="footnote3.m5.1.2.cmml">(</mo><mn id="footnote3.m5.1.1" xref="footnote3.m5.1.1.cmml">1</mn><mo id="footnote3.m5.1.2.3.2.2" stretchy="false" xref="footnote3.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="footnote3.m5.1c"><apply id="footnote3.m5.1.2.cmml" xref="footnote3.m5.1.2"><times id="footnote3.m5.1.2.1.cmml" xref="footnote3.m5.1.2.1"></times><ci id="footnote3.m5.1.2.2.cmml" xref="footnote3.m5.1.2.2">𝒪</ci><cn id="footnote3.m5.1.1.cmml" type="integer" xref="footnote3.m5.1.1">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote3.m5.1d">\mathcal{O}(1)</annotation><annotation encoding="application/x-llamapun" id="footnote3.m5.1e">caligraphic_O ( 1 )</annotation></semantics></math> in time complexity.</span></span></span>
We empirically set <math alttext="\gamma=5" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m4.1"><semantics id="S3.SS1.p2.4.m4.1a"><mrow id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml"><mi id="S3.SS1.p2.4.m4.1.1.2" xref="S3.SS1.p2.4.m4.1.1.2.cmml">γ</mi><mo id="S3.SS1.p2.4.m4.1.1.1" xref="S3.SS1.p2.4.m4.1.1.1.cmml">=</mo><mn id="S3.SS1.p2.4.m4.1.1.3" xref="S3.SS1.p2.4.m4.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><apply id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1"><eq id="S3.SS1.p2.4.m4.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1"></eq><ci id="S3.SS1.p2.4.m4.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.2">𝛾</ci><cn id="S3.SS1.p2.4.m4.1.1.3.cmml" type="integer" xref="S3.SS1.p2.4.m4.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">\gamma=5</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m4.1d">italic_γ = 5</annotation></semantics></math> for all the tasks, and consider sequence of <math alttext="5" class="ltx_Math" display="inline" id="S3.SS1.p2.5.m5.1"><semantics id="S3.SS1.p2.5.m5.1a"><mn id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><cn id="S3.SS1.p2.5.m5.1.1.cmml" type="integer" xref="S3.SS1.p2.5.m5.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">5</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.5.m5.1d">5</annotation></semantics></math> frames. The entire video sequence is reshaped into <math alttext="\mathbb{R}^{\frac{T}{\gamma}\times H\times W\times C}" class="ltx_Math" display="inline" id="S3.SS1.p2.6.m6.1"><semantics id="S3.SS1.p2.6.m6.1a"><msup id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml"><mi id="S3.SS1.p2.6.m6.1.1.2" xref="S3.SS1.p2.6.m6.1.1.2.cmml">ℝ</mi><mrow id="S3.SS1.p2.6.m6.1.1.3" xref="S3.SS1.p2.6.m6.1.1.3.cmml"><mfrac id="S3.SS1.p2.6.m6.1.1.3.2" xref="S3.SS1.p2.6.m6.1.1.3.2.cmml"><mi id="S3.SS1.p2.6.m6.1.1.3.2.2" xref="S3.SS1.p2.6.m6.1.1.3.2.2.cmml">T</mi><mi id="S3.SS1.p2.6.m6.1.1.3.2.3" xref="S3.SS1.p2.6.m6.1.1.3.2.3.cmml">γ</mi></mfrac><mo id="S3.SS1.p2.6.m6.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p2.6.m6.1.1.3.1.cmml">×</mo><mi id="S3.SS1.p2.6.m6.1.1.3.3" xref="S3.SS1.p2.6.m6.1.1.3.3.cmml">H</mi><mo id="S3.SS1.p2.6.m6.1.1.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p2.6.m6.1.1.3.1.cmml">×</mo><mi id="S3.SS1.p2.6.m6.1.1.3.4" xref="S3.SS1.p2.6.m6.1.1.3.4.cmml">W</mi><mo id="S3.SS1.p2.6.m6.1.1.3.1b" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p2.6.m6.1.1.3.1.cmml">×</mo><mi id="S3.SS1.p2.6.m6.1.1.3.5" xref="S3.SS1.p2.6.m6.1.1.3.5.cmml">C</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.1b"><apply id="S3.SS1.p2.6.m6.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.1.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1">superscript</csymbol><ci id="S3.SS1.p2.6.m6.1.1.2.cmml" xref="S3.SS1.p2.6.m6.1.1.2">ℝ</ci><apply id="S3.SS1.p2.6.m6.1.1.3.cmml" xref="S3.SS1.p2.6.m6.1.1.3"><times id="S3.SS1.p2.6.m6.1.1.3.1.cmml" xref="S3.SS1.p2.6.m6.1.1.3.1"></times><apply id="S3.SS1.p2.6.m6.1.1.3.2.cmml" xref="S3.SS1.p2.6.m6.1.1.3.2"><divide id="S3.SS1.p2.6.m6.1.1.3.2.1.cmml" xref="S3.SS1.p2.6.m6.1.1.3.2"></divide><ci id="S3.SS1.p2.6.m6.1.1.3.2.2.cmml" xref="S3.SS1.p2.6.m6.1.1.3.2.2">𝑇</ci><ci id="S3.SS1.p2.6.m6.1.1.3.2.3.cmml" xref="S3.SS1.p2.6.m6.1.1.3.2.3">𝛾</ci></apply><ci id="S3.SS1.p2.6.m6.1.1.3.3.cmml" xref="S3.SS1.p2.6.m6.1.1.3.3">𝐻</ci><ci id="S3.SS1.p2.6.m6.1.1.3.4.cmml" xref="S3.SS1.p2.6.m6.1.1.3.4">𝑊</ci><ci id="S3.SS1.p2.6.m6.1.1.3.5.cmml" xref="S3.SS1.p2.6.m6.1.1.3.5">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.1c">\mathbb{R}^{\frac{T}{\gamma}\times H\times W\times C}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.6.m6.1d">blackboard_R start_POSTSUPERSCRIPT divide start_ARG italic_T end_ARG start_ARG italic_γ end_ARG × italic_H × italic_W × italic_C end_POSTSUPERSCRIPT</annotation></semantics></math> thereby allowing parallelism in training while maintaining a dense representation of history states to condition the reconstruction procedure on.</p>
</div>
<div class="ltx_para" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.3">The decoder takes the feature map of the current frame, <math alttext="\mathbf{F}_{t}^{[l]}" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.1"><semantics id="S3.SS1.p3.1.m1.1a"><msubsup id="S3.SS1.p3.1.m1.1.2" xref="S3.SS1.p3.1.m1.1.2.cmml"><mi id="S3.SS1.p3.1.m1.1.2.2.2" xref="S3.SS1.p3.1.m1.1.2.2.2.cmml">𝐅</mi><mi id="S3.SS1.p3.1.m1.1.2.2.3" xref="S3.SS1.p3.1.m1.1.2.2.3.cmml">t</mi><mrow id="S3.SS1.p3.1.m1.1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.1.2.cmml"><mo id="S3.SS1.p3.1.m1.1.1.1.3.1" stretchy="false" xref="S3.SS1.p3.1.m1.1.1.1.2.1.cmml">[</mo><mi id="S3.SS1.p3.1.m1.1.1.1.1" xref="S3.SS1.p3.1.m1.1.1.1.1.cmml">l</mi><mo id="S3.SS1.p3.1.m1.1.1.1.3.2" stretchy="false" xref="S3.SS1.p3.1.m1.1.1.1.2.1.cmml">]</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.2.1.cmml" xref="S3.SS1.p3.1.m1.1.2">superscript</csymbol><apply id="S3.SS1.p3.1.m1.1.2.2.cmml" xref="S3.SS1.p3.1.m1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.2.2.1.cmml" xref="S3.SS1.p3.1.m1.1.2">subscript</csymbol><ci id="S3.SS1.p3.1.m1.1.2.2.2.cmml" xref="S3.SS1.p3.1.m1.1.2.2.2">𝐅</ci><ci id="S3.SS1.p3.1.m1.1.2.2.3.cmml" xref="S3.SS1.p3.1.m1.1.2.2.3">𝑡</ci></apply><apply id="S3.SS1.p3.1.m1.1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.1.3"><csymbol cd="latexml" id="S3.SS1.p3.1.m1.1.1.1.2.1.cmml" xref="S3.SS1.p3.1.m1.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS1.p3.1.m1.1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">\mathbf{F}_{t}^{[l]}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.1d">bold_F start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT</annotation></semantics></math>, and the history states <math alttext="\mathbf{H}_{t}^{[l]}" class="ltx_Math" display="inline" id="S3.SS1.p3.2.m2.1"><semantics id="S3.SS1.p3.2.m2.1a"><msubsup id="S3.SS1.p3.2.m2.1.2" xref="S3.SS1.p3.2.m2.1.2.cmml"><mi id="S3.SS1.p3.2.m2.1.2.2.2" xref="S3.SS1.p3.2.m2.1.2.2.2.cmml">𝐇</mi><mi id="S3.SS1.p3.2.m2.1.2.2.3" xref="S3.SS1.p3.2.m2.1.2.2.3.cmml">t</mi><mrow id="S3.SS1.p3.2.m2.1.1.1.3" xref="S3.SS1.p3.2.m2.1.1.1.2.cmml"><mo id="S3.SS1.p3.2.m2.1.1.1.3.1" stretchy="false" xref="S3.SS1.p3.2.m2.1.1.1.2.1.cmml">[</mo><mi id="S3.SS1.p3.2.m2.1.1.1.1" xref="S3.SS1.p3.2.m2.1.1.1.1.cmml">l</mi><mo id="S3.SS1.p3.2.m2.1.1.1.3.2" stretchy="false" xref="S3.SS1.p3.2.m2.1.1.1.2.1.cmml">]</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><apply id="S3.SS1.p3.2.m2.1.2.cmml" xref="S3.SS1.p3.2.m2.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.2.1.cmml" xref="S3.SS1.p3.2.m2.1.2">superscript</csymbol><apply id="S3.SS1.p3.2.m2.1.2.2.cmml" xref="S3.SS1.p3.2.m2.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.2.2.1.cmml" xref="S3.SS1.p3.2.m2.1.2">subscript</csymbol><ci id="S3.SS1.p3.2.m2.1.2.2.2.cmml" xref="S3.SS1.p3.2.m2.1.2.2.2">𝐇</ci><ci id="S3.SS1.p3.2.m2.1.2.2.3.cmml" xref="S3.SS1.p3.2.m2.1.2.2.3">𝑡</ci></apply><apply id="S3.SS1.p3.2.m2.1.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1.1.3"><csymbol cd="latexml" id="S3.SS1.p3.2.m2.1.1.1.2.1.cmml" xref="S3.SS1.p3.2.m2.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS1.p3.2.m2.1.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">\mathbf{H}_{t}^{[l]}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.2.m2.1d">bold_H start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT</annotation></semantics></math>. We propose a motion compensation module that operates on the feature space to implicitly align history states with respect to the input frame.
Next, a dynamic router learns to control the effect of history frames by scoring and aggregating motion-compensated features based on their relevance to the restoration of the current frame. Such a procedure accentuates the aligned history such that the following stages of the decoder can learn to reconstruct the high-quality frame appropriately.
Both of these procedures combine to form the Causal History Model <span class="ltx_text ltx_font_sansserif" id="S3.SS1.p3.3.1">CHM</span>(<math alttext="\mathbf{F}_{t}^{[l]},\mathbf{H}_{t}^{[l]}" class="ltx_Math" display="inline" id="S3.SS1.p3.3.m3.4"><semantics id="S3.SS1.p3.3.m3.4a"><mrow id="S3.SS1.p3.3.m3.4.4.2" xref="S3.SS1.p3.3.m3.4.4.3.cmml"><msubsup id="S3.SS1.p3.3.m3.3.3.1.1" xref="S3.SS1.p3.3.m3.3.3.1.1.cmml"><mi id="S3.SS1.p3.3.m3.3.3.1.1.2.2" xref="S3.SS1.p3.3.m3.3.3.1.1.2.2.cmml">𝐅</mi><mi id="S3.SS1.p3.3.m3.3.3.1.1.2.3" xref="S3.SS1.p3.3.m3.3.3.1.1.2.3.cmml">t</mi><mrow id="S3.SS1.p3.3.m3.1.1.1.3" xref="S3.SS1.p3.3.m3.1.1.1.2.cmml"><mo id="S3.SS1.p3.3.m3.1.1.1.3.1" stretchy="false" xref="S3.SS1.p3.3.m3.1.1.1.2.1.cmml">[</mo><mi id="S3.SS1.p3.3.m3.1.1.1.1" xref="S3.SS1.p3.3.m3.1.1.1.1.cmml">l</mi><mo id="S3.SS1.p3.3.m3.1.1.1.3.2" stretchy="false" xref="S3.SS1.p3.3.m3.1.1.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.SS1.p3.3.m3.4.4.2.3" xref="S3.SS1.p3.3.m3.4.4.3.cmml">,</mo><msubsup id="S3.SS1.p3.3.m3.4.4.2.2" xref="S3.SS1.p3.3.m3.4.4.2.2.cmml"><mi id="S3.SS1.p3.3.m3.4.4.2.2.2.2" xref="S3.SS1.p3.3.m3.4.4.2.2.2.2.cmml">𝐇</mi><mi id="S3.SS1.p3.3.m3.4.4.2.2.2.3" xref="S3.SS1.p3.3.m3.4.4.2.2.2.3.cmml">t</mi><mrow id="S3.SS1.p3.3.m3.2.2.1.3" xref="S3.SS1.p3.3.m3.2.2.1.2.cmml"><mo id="S3.SS1.p3.3.m3.2.2.1.3.1" stretchy="false" xref="S3.SS1.p3.3.m3.2.2.1.2.1.cmml">[</mo><mi id="S3.SS1.p3.3.m3.2.2.1.1" xref="S3.SS1.p3.3.m3.2.2.1.1.cmml">l</mi><mo id="S3.SS1.p3.3.m3.2.2.1.3.2" stretchy="false" xref="S3.SS1.p3.3.m3.2.2.1.2.1.cmml">]</mo></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.4b"><list id="S3.SS1.p3.3.m3.4.4.3.cmml" xref="S3.SS1.p3.3.m3.4.4.2"><apply id="S3.SS1.p3.3.m3.3.3.1.1.cmml" xref="S3.SS1.p3.3.m3.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.3.3.1.1.1.cmml" xref="S3.SS1.p3.3.m3.3.3.1.1">superscript</csymbol><apply id="S3.SS1.p3.3.m3.3.3.1.1.2.cmml" xref="S3.SS1.p3.3.m3.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.3.3.1.1.2.1.cmml" xref="S3.SS1.p3.3.m3.3.3.1.1">subscript</csymbol><ci id="S3.SS1.p3.3.m3.3.3.1.1.2.2.cmml" xref="S3.SS1.p3.3.m3.3.3.1.1.2.2">𝐅</ci><ci id="S3.SS1.p3.3.m3.3.3.1.1.2.3.cmml" xref="S3.SS1.p3.3.m3.3.3.1.1.2.3">𝑡</ci></apply><apply id="S3.SS1.p3.3.m3.1.1.1.2.cmml" xref="S3.SS1.p3.3.m3.1.1.1.3"><csymbol cd="latexml" id="S3.SS1.p3.3.m3.1.1.1.2.1.cmml" xref="S3.SS1.p3.3.m3.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS1.p3.3.m3.1.1.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1.1.1">𝑙</ci></apply></apply><apply id="S3.SS1.p3.3.m3.4.4.2.2.cmml" xref="S3.SS1.p3.3.m3.4.4.2.2"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.4.4.2.2.1.cmml" xref="S3.SS1.p3.3.m3.4.4.2.2">superscript</csymbol><apply id="S3.SS1.p3.3.m3.4.4.2.2.2.cmml" xref="S3.SS1.p3.3.m3.4.4.2.2"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.4.4.2.2.2.1.cmml" xref="S3.SS1.p3.3.m3.4.4.2.2">subscript</csymbol><ci id="S3.SS1.p3.3.m3.4.4.2.2.2.2.cmml" xref="S3.SS1.p3.3.m3.4.4.2.2.2.2">𝐇</ci><ci id="S3.SS1.p3.3.m3.4.4.2.2.2.3.cmml" xref="S3.SS1.p3.3.m3.4.4.2.2.2.3">𝑡</ci></apply><apply id="S3.SS1.p3.3.m3.2.2.1.2.cmml" xref="S3.SS1.p3.3.m3.2.2.1.3"><csymbol cd="latexml" id="S3.SS1.p3.3.m3.2.2.1.2.1.cmml" xref="S3.SS1.p3.3.m3.2.2.1.3.1">delimited-[]</csymbol><ci id="S3.SS1.p3.3.m3.2.2.1.1.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1">𝑙</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.4c">\mathbf{F}_{t}^{[l]},\mathbf{H}_{t}^{[l]}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.3.m3.4d">bold_F start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT , bold_H start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT</annotation></semantics></math>), detailed in <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S3.SS2" title="3.2 Causal History Model ‣ 3 Methodology ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">section</span> <span class="ltx_text ltx_ref_tag">3.2</span></a>. Further, multiple <span class="ltx_text ltx_font_sansserif" id="S3.SS1.p3.3.2">CHM</span>s are stacked as black box layers at different stages to construct the decoder of <span class="ltx_text ltx_font_smallcaps" id="S3.SS1.p3.3.3">Turtle</span>.</p>
</div>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="270" id="S3.F2.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span><span class="ltx_text ltx_font_bold" id="S3.F2.4.1">Causal History Model.</span> The diagrammatic illustration of the proposed Causal History Model (<span class="ltx_text ltx_font_sansserif" id="S3.F2.5.2">CHM</span>) detailing the internal function. In the initial phase, for each patch in the current frame (denoted by the stars), we identify and implicitly align the <span class="ltx_text ltx_font_italic" id="S3.F2.6.3">top-k</span> similar patches in the history. In the subsequent phase, we score and aggregate features from this aligned history to create a refined output that blends the input frame features with pertinent history data. We visualize frames in this diagram for exposition, but in practice the procedure operates on the feature maps.
</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Causal History Model</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.5"><span class="ltx_text ltx_font_sansserif" id="S3.SS2.p1.5.1">CHM</span> learns to align the history states with respect to the input feature map. Further, there could still exist potential degradation differences at the same feature locations along the entire sequence in the motion-compensated history states. To this end, <span class="ltx_text ltx_font_sansserif" id="S3.SS2.p1.5.2">CHM</span> re-weights the sequence along the temporal dimension to accentuate significant features and suppress irrelevant ones. Let <math alttext="\mathbf{\hat{H}}_{t}^{[l]}\in\mathbb{R}^{(\tau+1)\times h^{l}\times w^{l}%
\times c^{l}}" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.2"><semantics id="S3.SS2.p1.1.m1.2a"><mrow id="S3.SS2.p1.1.m1.2.3" xref="S3.SS2.p1.1.m1.2.3.cmml"><msubsup id="S3.SS2.p1.1.m1.2.3.2" xref="S3.SS2.p1.1.m1.2.3.2.cmml"><mover accent="true" id="S3.SS2.p1.1.m1.2.3.2.2.2" xref="S3.SS2.p1.1.m1.2.3.2.2.2.cmml"><mi id="S3.SS2.p1.1.m1.2.3.2.2.2.2" xref="S3.SS2.p1.1.m1.2.3.2.2.2.2.cmml">𝐇</mi><mo id="S3.SS2.p1.1.m1.2.3.2.2.2.1" xref="S3.SS2.p1.1.m1.2.3.2.2.2.1.cmml">^</mo></mover><mi id="S3.SS2.p1.1.m1.2.3.2.2.3" xref="S3.SS2.p1.1.m1.2.3.2.2.3.cmml">t</mi><mrow id="S3.SS2.p1.1.m1.1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.1.2.cmml"><mo id="S3.SS2.p1.1.m1.1.1.1.3.1" stretchy="false" xref="S3.SS2.p1.1.m1.1.1.1.2.1.cmml">[</mo><mi id="S3.SS2.p1.1.m1.1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.1.cmml">l</mi><mo id="S3.SS2.p1.1.m1.1.1.1.3.2" stretchy="false" xref="S3.SS2.p1.1.m1.1.1.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.SS2.p1.1.m1.2.3.1" xref="S3.SS2.p1.1.m1.2.3.1.cmml">∈</mo><msup id="S3.SS2.p1.1.m1.2.3.3" xref="S3.SS2.p1.1.m1.2.3.3.cmml"><mi id="S3.SS2.p1.1.m1.2.3.3.2" xref="S3.SS2.p1.1.m1.2.3.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p1.1.m1.2.2.1" xref="S3.SS2.p1.1.m1.2.2.1.cmml"><mrow id="S3.SS2.p1.1.m1.2.2.1.1.1" xref="S3.SS2.p1.1.m1.2.2.1.1.1.1.cmml"><mo id="S3.SS2.p1.1.m1.2.2.1.1.1.2" stretchy="false" xref="S3.SS2.p1.1.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p1.1.m1.2.2.1.1.1.1" xref="S3.SS2.p1.1.m1.2.2.1.1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.2.2.1.1.1.1.2" xref="S3.SS2.p1.1.m1.2.2.1.1.1.1.2.cmml">τ</mi><mo id="S3.SS2.p1.1.m1.2.2.1.1.1.1.1" xref="S3.SS2.p1.1.m1.2.2.1.1.1.1.1.cmml">+</mo><mn id="S3.SS2.p1.1.m1.2.2.1.1.1.1.3" xref="S3.SS2.p1.1.m1.2.2.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS2.p1.1.m1.2.2.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.SS2.p1.1.m1.2.2.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS2.p1.1.m1.2.2.1.2" rspace="0.222em" xref="S3.SS2.p1.1.m1.2.2.1.2.cmml">×</mo><msup id="S3.SS2.p1.1.m1.2.2.1.3" xref="S3.SS2.p1.1.m1.2.2.1.3.cmml"><mi id="S3.SS2.p1.1.m1.2.2.1.3.2" xref="S3.SS2.p1.1.m1.2.2.1.3.2.cmml">h</mi><mi id="S3.SS2.p1.1.m1.2.2.1.3.3" xref="S3.SS2.p1.1.m1.2.2.1.3.3.cmml">l</mi></msup><mo id="S3.SS2.p1.1.m1.2.2.1.2a" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p1.1.m1.2.2.1.2.cmml">×</mo><msup id="S3.SS2.p1.1.m1.2.2.1.4" xref="S3.SS2.p1.1.m1.2.2.1.4.cmml"><mi id="S3.SS2.p1.1.m1.2.2.1.4.2" xref="S3.SS2.p1.1.m1.2.2.1.4.2.cmml">w</mi><mi id="S3.SS2.p1.1.m1.2.2.1.4.3" xref="S3.SS2.p1.1.m1.2.2.1.4.3.cmml">l</mi></msup><mo id="S3.SS2.p1.1.m1.2.2.1.2b" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p1.1.m1.2.2.1.2.cmml">×</mo><msup id="S3.SS2.p1.1.m1.2.2.1.5" xref="S3.SS2.p1.1.m1.2.2.1.5.cmml"><mi id="S3.SS2.p1.1.m1.2.2.1.5.2" xref="S3.SS2.p1.1.m1.2.2.1.5.2.cmml">c</mi><mi id="S3.SS2.p1.1.m1.2.2.1.5.3" xref="S3.SS2.p1.1.m1.2.2.1.5.3.cmml">l</mi></msup></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.2b"><apply id="S3.SS2.p1.1.m1.2.3.cmml" xref="S3.SS2.p1.1.m1.2.3"><in id="S3.SS2.p1.1.m1.2.3.1.cmml" xref="S3.SS2.p1.1.m1.2.3.1"></in><apply id="S3.SS2.p1.1.m1.2.3.2.cmml" xref="S3.SS2.p1.1.m1.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.2.3.2.1.cmml" xref="S3.SS2.p1.1.m1.2.3.2">superscript</csymbol><apply id="S3.SS2.p1.1.m1.2.3.2.2.cmml" xref="S3.SS2.p1.1.m1.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.2.3.2.2.1.cmml" xref="S3.SS2.p1.1.m1.2.3.2">subscript</csymbol><apply id="S3.SS2.p1.1.m1.2.3.2.2.2.cmml" xref="S3.SS2.p1.1.m1.2.3.2.2.2"><ci id="S3.SS2.p1.1.m1.2.3.2.2.2.1.cmml" xref="S3.SS2.p1.1.m1.2.3.2.2.2.1">^</ci><ci id="S3.SS2.p1.1.m1.2.3.2.2.2.2.cmml" xref="S3.SS2.p1.1.m1.2.3.2.2.2.2">𝐇</ci></apply><ci id="S3.SS2.p1.1.m1.2.3.2.2.3.cmml" xref="S3.SS2.p1.1.m1.2.3.2.2.3">𝑡</ci></apply><apply id="S3.SS2.p1.1.m1.1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.1.3"><csymbol cd="latexml" id="S3.SS2.p1.1.m1.1.1.1.2.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.p1.1.m1.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1">𝑙</ci></apply></apply><apply id="S3.SS2.p1.1.m1.2.3.3.cmml" xref="S3.SS2.p1.1.m1.2.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.2.3.3.1.cmml" xref="S3.SS2.p1.1.m1.2.3.3">superscript</csymbol><ci id="S3.SS2.p1.1.m1.2.3.3.2.cmml" xref="S3.SS2.p1.1.m1.2.3.3.2">ℝ</ci><apply id="S3.SS2.p1.1.m1.2.2.1.cmml" xref="S3.SS2.p1.1.m1.2.2.1"><times id="S3.SS2.p1.1.m1.2.2.1.2.cmml" xref="S3.SS2.p1.1.m1.2.2.1.2"></times><apply id="S3.SS2.p1.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.1"><plus id="S3.SS2.p1.1.m1.2.2.1.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.1.1.1"></plus><ci id="S3.SS2.p1.1.m1.2.2.1.1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.1.1.2">𝜏</ci><cn id="S3.SS2.p1.1.m1.2.2.1.1.1.1.3.cmml" type="integer" xref="S3.SS2.p1.1.m1.2.2.1.1.1.1.3">1</cn></apply><apply id="S3.SS2.p1.1.m1.2.2.1.3.cmml" xref="S3.SS2.p1.1.m1.2.2.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.2.2.1.3.1.cmml" xref="S3.SS2.p1.1.m1.2.2.1.3">superscript</csymbol><ci id="S3.SS2.p1.1.m1.2.2.1.3.2.cmml" xref="S3.SS2.p1.1.m1.2.2.1.3.2">ℎ</ci><ci id="S3.SS2.p1.1.m1.2.2.1.3.3.cmml" xref="S3.SS2.p1.1.m1.2.2.1.3.3">𝑙</ci></apply><apply id="S3.SS2.p1.1.m1.2.2.1.4.cmml" xref="S3.SS2.p1.1.m1.2.2.1.4"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.2.2.1.4.1.cmml" xref="S3.SS2.p1.1.m1.2.2.1.4">superscript</csymbol><ci id="S3.SS2.p1.1.m1.2.2.1.4.2.cmml" xref="S3.SS2.p1.1.m1.2.2.1.4.2">𝑤</ci><ci id="S3.SS2.p1.1.m1.2.2.1.4.3.cmml" xref="S3.SS2.p1.1.m1.2.2.1.4.3">𝑙</ci></apply><apply id="S3.SS2.p1.1.m1.2.2.1.5.cmml" xref="S3.SS2.p1.1.m1.2.2.1.5"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.2.2.1.5.1.cmml" xref="S3.SS2.p1.1.m1.2.2.1.5">superscript</csymbol><ci id="S3.SS2.p1.1.m1.2.2.1.5.2.cmml" xref="S3.SS2.p1.1.m1.2.2.1.5.2">𝑐</ci><ci id="S3.SS2.p1.1.m1.2.2.1.5.3.cmml" xref="S3.SS2.p1.1.m1.2.2.1.5.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.2c">\mathbf{\hat{H}}_{t}^{[l]}\in\mathbb{R}^{(\tau+1)\times h^{l}\times w^{l}%
\times c^{l}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.2d">over^ start_ARG bold_H end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT ( italic_τ + 1 ) × italic_h start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT × italic_w start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT × italic_c start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> denote the motion-compensated causal history states, and let input feature map be <math alttext="\mathbf{F}_{t}^{[l]}\in\mathbb{R}^{h^{l}\times w^{l}\times c^{l}}" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><mrow id="S3.SS2.p1.2.m2.1.2" xref="S3.SS2.p1.2.m2.1.2.cmml"><msubsup id="S3.SS2.p1.2.m2.1.2.2" xref="S3.SS2.p1.2.m2.1.2.2.cmml"><mi id="S3.SS2.p1.2.m2.1.2.2.2.2" xref="S3.SS2.p1.2.m2.1.2.2.2.2.cmml">𝐅</mi><mi id="S3.SS2.p1.2.m2.1.2.2.2.3" xref="S3.SS2.p1.2.m2.1.2.2.2.3.cmml">t</mi><mrow id="S3.SS2.p1.2.m2.1.1.1.3" xref="S3.SS2.p1.2.m2.1.1.1.2.cmml"><mo id="S3.SS2.p1.2.m2.1.1.1.3.1" stretchy="false" xref="S3.SS2.p1.2.m2.1.1.1.2.1.cmml">[</mo><mi id="S3.SS2.p1.2.m2.1.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.1.cmml">l</mi><mo id="S3.SS2.p1.2.m2.1.1.1.3.2" stretchy="false" xref="S3.SS2.p1.2.m2.1.1.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.SS2.p1.2.m2.1.2.1" xref="S3.SS2.p1.2.m2.1.2.1.cmml">∈</mo><msup id="S3.SS2.p1.2.m2.1.2.3" xref="S3.SS2.p1.2.m2.1.2.3.cmml"><mi id="S3.SS2.p1.2.m2.1.2.3.2" xref="S3.SS2.p1.2.m2.1.2.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p1.2.m2.1.2.3.3" xref="S3.SS2.p1.2.m2.1.2.3.3.cmml"><msup id="S3.SS2.p1.2.m2.1.2.3.3.2" xref="S3.SS2.p1.2.m2.1.2.3.3.2.cmml"><mi id="S3.SS2.p1.2.m2.1.2.3.3.2.2" xref="S3.SS2.p1.2.m2.1.2.3.3.2.2.cmml">h</mi><mi id="S3.SS2.p1.2.m2.1.2.3.3.2.3" xref="S3.SS2.p1.2.m2.1.2.3.3.2.3.cmml">l</mi></msup><mo id="S3.SS2.p1.2.m2.1.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p1.2.m2.1.2.3.3.1.cmml">×</mo><msup id="S3.SS2.p1.2.m2.1.2.3.3.3" xref="S3.SS2.p1.2.m2.1.2.3.3.3.cmml"><mi id="S3.SS2.p1.2.m2.1.2.3.3.3.2" xref="S3.SS2.p1.2.m2.1.2.3.3.3.2.cmml">w</mi><mi id="S3.SS2.p1.2.m2.1.2.3.3.3.3" xref="S3.SS2.p1.2.m2.1.2.3.3.3.3.cmml">l</mi></msup><mo id="S3.SS2.p1.2.m2.1.2.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p1.2.m2.1.2.3.3.1.cmml">×</mo><msup id="S3.SS2.p1.2.m2.1.2.3.3.4" xref="S3.SS2.p1.2.m2.1.2.3.3.4.cmml"><mi id="S3.SS2.p1.2.m2.1.2.3.3.4.2" xref="S3.SS2.p1.2.m2.1.2.3.3.4.2.cmml">c</mi><mi id="S3.SS2.p1.2.m2.1.2.3.3.4.3" xref="S3.SS2.p1.2.m2.1.2.3.3.4.3.cmml">l</mi></msup></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.2.cmml" xref="S3.SS2.p1.2.m2.1.2"><in id="S3.SS2.p1.2.m2.1.2.1.cmml" xref="S3.SS2.p1.2.m2.1.2.1"></in><apply id="S3.SS2.p1.2.m2.1.2.2.cmml" xref="S3.SS2.p1.2.m2.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.2.2.1.cmml" xref="S3.SS2.p1.2.m2.1.2.2">superscript</csymbol><apply id="S3.SS2.p1.2.m2.1.2.2.2.cmml" xref="S3.SS2.p1.2.m2.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.2.2.2.1.cmml" xref="S3.SS2.p1.2.m2.1.2.2">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.2.2.2.2.cmml" xref="S3.SS2.p1.2.m2.1.2.2.2.2">𝐅</ci><ci id="S3.SS2.p1.2.m2.1.2.2.2.3.cmml" xref="S3.SS2.p1.2.m2.1.2.2.2.3">𝑡</ci></apply><apply id="S3.SS2.p1.2.m2.1.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.1.3"><csymbol cd="latexml" id="S3.SS2.p1.2.m2.1.1.1.2.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.p1.2.m2.1.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1">𝑙</ci></apply></apply><apply id="S3.SS2.p1.2.m2.1.2.3.cmml" xref="S3.SS2.p1.2.m2.1.2.3"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.2.3.1.cmml" xref="S3.SS2.p1.2.m2.1.2.3">superscript</csymbol><ci id="S3.SS2.p1.2.m2.1.2.3.2.cmml" xref="S3.SS2.p1.2.m2.1.2.3.2">ℝ</ci><apply id="S3.SS2.p1.2.m2.1.2.3.3.cmml" xref="S3.SS2.p1.2.m2.1.2.3.3"><times id="S3.SS2.p1.2.m2.1.2.3.3.1.cmml" xref="S3.SS2.p1.2.m2.1.2.3.3.1"></times><apply id="S3.SS2.p1.2.m2.1.2.3.3.2.cmml" xref="S3.SS2.p1.2.m2.1.2.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.2.3.3.2.1.cmml" xref="S3.SS2.p1.2.m2.1.2.3.3.2">superscript</csymbol><ci id="S3.SS2.p1.2.m2.1.2.3.3.2.2.cmml" xref="S3.SS2.p1.2.m2.1.2.3.3.2.2">ℎ</ci><ci id="S3.SS2.p1.2.m2.1.2.3.3.2.3.cmml" xref="S3.SS2.p1.2.m2.1.2.3.3.2.3">𝑙</ci></apply><apply id="S3.SS2.p1.2.m2.1.2.3.3.3.cmml" xref="S3.SS2.p1.2.m2.1.2.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.2.3.3.3.1.cmml" xref="S3.SS2.p1.2.m2.1.2.3.3.3">superscript</csymbol><ci id="S3.SS2.p1.2.m2.1.2.3.3.3.2.cmml" xref="S3.SS2.p1.2.m2.1.2.3.3.3.2">𝑤</ci><ci id="S3.SS2.p1.2.m2.1.2.3.3.3.3.cmml" xref="S3.SS2.p1.2.m2.1.2.3.3.3.3">𝑙</ci></apply><apply id="S3.SS2.p1.2.m2.1.2.3.3.4.cmml" xref="S3.SS2.p1.2.m2.1.2.3.3.4"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.2.3.3.4.1.cmml" xref="S3.SS2.p1.2.m2.1.2.3.3.4">superscript</csymbol><ci id="S3.SS2.p1.2.m2.1.2.3.3.4.2.cmml" xref="S3.SS2.p1.2.m2.1.2.3.3.4.2">𝑐</ci><ci id="S3.SS2.p1.2.m2.1.2.3.3.4.3.cmml" xref="S3.SS2.p1.2.m2.1.2.3.3.4.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\mathbf{F}_{t}^{[l]}\in\mathbb{R}^{h^{l}\times w^{l}\times c^{l}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">bold_F start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_h start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT × italic_w start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT × italic_c start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>. Let the transformation on the history states to align the features be denoted by <math alttext="\phi_{t}" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><msub id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml">ϕ</mi><mi id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2">italic-ϕ</ci><ci id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">\phi_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">italic_ϕ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, and let <math alttext="\psi_{t}" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m4.1"><semantics id="S3.SS2.p1.4.m4.1a"><msub id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><mi id="S3.SS2.p1.4.m4.1.1.2" xref="S3.SS2.p1.4.m4.1.1.2.cmml">ψ</mi><mi id="S3.SS2.p1.4.m4.1.1.3" xref="S3.SS2.p1.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2">𝜓</ci><ci id="S3.SS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">\psi_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m4.1d">italic_ψ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> denote the re-weighting scheme. If the output is given by <math alttext="\mathbf{y}^{[l]}_{t}\in\mathbb{R}^{h^{l}\times w^{l}\times c^{l}}" class="ltx_Math" display="inline" id="S3.SS2.p1.5.m5.1"><semantics id="S3.SS2.p1.5.m5.1a"><mrow id="S3.SS2.p1.5.m5.1.2" xref="S3.SS2.p1.5.m5.1.2.cmml"><msubsup id="S3.SS2.p1.5.m5.1.2.2" xref="S3.SS2.p1.5.m5.1.2.2.cmml"><mi id="S3.SS2.p1.5.m5.1.2.2.2.2" xref="S3.SS2.p1.5.m5.1.2.2.2.2.cmml">𝐲</mi><mi id="S3.SS2.p1.5.m5.1.2.2.3" xref="S3.SS2.p1.5.m5.1.2.2.3.cmml">t</mi><mrow id="S3.SS2.p1.5.m5.1.1.1.3" xref="S3.SS2.p1.5.m5.1.1.1.2.cmml"><mo id="S3.SS2.p1.5.m5.1.1.1.3.1" stretchy="false" xref="S3.SS2.p1.5.m5.1.1.1.2.1.cmml">[</mo><mi id="S3.SS2.p1.5.m5.1.1.1.1" xref="S3.SS2.p1.5.m5.1.1.1.1.cmml">l</mi><mo id="S3.SS2.p1.5.m5.1.1.1.3.2" stretchy="false" xref="S3.SS2.p1.5.m5.1.1.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.SS2.p1.5.m5.1.2.1" xref="S3.SS2.p1.5.m5.1.2.1.cmml">∈</mo><msup id="S3.SS2.p1.5.m5.1.2.3" xref="S3.SS2.p1.5.m5.1.2.3.cmml"><mi id="S3.SS2.p1.5.m5.1.2.3.2" xref="S3.SS2.p1.5.m5.1.2.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p1.5.m5.1.2.3.3" xref="S3.SS2.p1.5.m5.1.2.3.3.cmml"><msup id="S3.SS2.p1.5.m5.1.2.3.3.2" xref="S3.SS2.p1.5.m5.1.2.3.3.2.cmml"><mi id="S3.SS2.p1.5.m5.1.2.3.3.2.2" xref="S3.SS2.p1.5.m5.1.2.3.3.2.2.cmml">h</mi><mi id="S3.SS2.p1.5.m5.1.2.3.3.2.3" xref="S3.SS2.p1.5.m5.1.2.3.3.2.3.cmml">l</mi></msup><mo id="S3.SS2.p1.5.m5.1.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p1.5.m5.1.2.3.3.1.cmml">×</mo><msup id="S3.SS2.p1.5.m5.1.2.3.3.3" xref="S3.SS2.p1.5.m5.1.2.3.3.3.cmml"><mi id="S3.SS2.p1.5.m5.1.2.3.3.3.2" xref="S3.SS2.p1.5.m5.1.2.3.3.3.2.cmml">w</mi><mi id="S3.SS2.p1.5.m5.1.2.3.3.3.3" xref="S3.SS2.p1.5.m5.1.2.3.3.3.3.cmml">l</mi></msup><mo id="S3.SS2.p1.5.m5.1.2.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p1.5.m5.1.2.3.3.1.cmml">×</mo><msup id="S3.SS2.p1.5.m5.1.2.3.3.4" xref="S3.SS2.p1.5.m5.1.2.3.3.4.cmml"><mi id="S3.SS2.p1.5.m5.1.2.3.3.4.2" xref="S3.SS2.p1.5.m5.1.2.3.3.4.2.cmml">c</mi><mi id="S3.SS2.p1.5.m5.1.2.3.3.4.3" xref="S3.SS2.p1.5.m5.1.2.3.3.4.3.cmml">l</mi></msup></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><apply id="S3.SS2.p1.5.m5.1.2.cmml" xref="S3.SS2.p1.5.m5.1.2"><in id="S3.SS2.p1.5.m5.1.2.1.cmml" xref="S3.SS2.p1.5.m5.1.2.1"></in><apply id="S3.SS2.p1.5.m5.1.2.2.cmml" xref="S3.SS2.p1.5.m5.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.2.2.1.cmml" xref="S3.SS2.p1.5.m5.1.2.2">subscript</csymbol><apply id="S3.SS2.p1.5.m5.1.2.2.2.cmml" xref="S3.SS2.p1.5.m5.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.2.2.2.1.cmml" xref="S3.SS2.p1.5.m5.1.2.2">superscript</csymbol><ci id="S3.SS2.p1.5.m5.1.2.2.2.2.cmml" xref="S3.SS2.p1.5.m5.1.2.2.2.2">𝐲</ci><apply id="S3.SS2.p1.5.m5.1.1.1.2.cmml" xref="S3.SS2.p1.5.m5.1.1.1.3"><csymbol cd="latexml" id="S3.SS2.p1.5.m5.1.1.1.2.1.cmml" xref="S3.SS2.p1.5.m5.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.p1.5.m5.1.1.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1.1.1">𝑙</ci></apply></apply><ci id="S3.SS2.p1.5.m5.1.2.2.3.cmml" xref="S3.SS2.p1.5.m5.1.2.2.3">𝑡</ci></apply><apply id="S3.SS2.p1.5.m5.1.2.3.cmml" xref="S3.SS2.p1.5.m5.1.2.3"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.2.3.1.cmml" xref="S3.SS2.p1.5.m5.1.2.3">superscript</csymbol><ci id="S3.SS2.p1.5.m5.1.2.3.2.cmml" xref="S3.SS2.p1.5.m5.1.2.3.2">ℝ</ci><apply id="S3.SS2.p1.5.m5.1.2.3.3.cmml" xref="S3.SS2.p1.5.m5.1.2.3.3"><times id="S3.SS2.p1.5.m5.1.2.3.3.1.cmml" xref="S3.SS2.p1.5.m5.1.2.3.3.1"></times><apply id="S3.SS2.p1.5.m5.1.2.3.3.2.cmml" xref="S3.SS2.p1.5.m5.1.2.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.2.3.3.2.1.cmml" xref="S3.SS2.p1.5.m5.1.2.3.3.2">superscript</csymbol><ci id="S3.SS2.p1.5.m5.1.2.3.3.2.2.cmml" xref="S3.SS2.p1.5.m5.1.2.3.3.2.2">ℎ</ci><ci id="S3.SS2.p1.5.m5.1.2.3.3.2.3.cmml" xref="S3.SS2.p1.5.m5.1.2.3.3.2.3">𝑙</ci></apply><apply id="S3.SS2.p1.5.m5.1.2.3.3.3.cmml" xref="S3.SS2.p1.5.m5.1.2.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.2.3.3.3.1.cmml" xref="S3.SS2.p1.5.m5.1.2.3.3.3">superscript</csymbol><ci id="S3.SS2.p1.5.m5.1.2.3.3.3.2.cmml" xref="S3.SS2.p1.5.m5.1.2.3.3.3.2">𝑤</ci><ci id="S3.SS2.p1.5.m5.1.2.3.3.3.3.cmml" xref="S3.SS2.p1.5.m5.1.2.3.3.3.3">𝑙</ci></apply><apply id="S3.SS2.p1.5.m5.1.2.3.3.4.cmml" xref="S3.SS2.p1.5.m5.1.2.3.3.4"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.2.3.3.4.1.cmml" xref="S3.SS2.p1.5.m5.1.2.3.3.4">superscript</csymbol><ci id="S3.SS2.p1.5.m5.1.2.3.3.4.2.cmml" xref="S3.SS2.p1.5.m5.1.2.3.3.4.2">𝑐</ci><ci id="S3.SS2.p1.5.m5.1.2.3.3.4.3.cmml" xref="S3.SS2.p1.5.m5.1.2.3.3.4.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">\mathbf{y}^{[l]}_{t}\in\mathbb{R}^{h^{l}\times w^{l}\times c^{l}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.5.m5.1d">bold_y start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_h start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT × italic_w start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT × italic_c start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, we then, formalize the Causal History Model (<span class="ltx_text ltx_font_sansserif" id="S3.SS2.p1.5.3">CHM</span>) as,</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A7.EGx1">
<tbody id="S3.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{\hat{H}}_{t}^{[l]}" class="ltx_Math" display="inline" id="S3.E1.m1.1"><semantics id="S3.E1.m1.1a"><msubsup id="S3.E1.m1.1.2" xref="S3.E1.m1.1.2.cmml"><mover accent="true" id="S3.E1.m1.1.2.2.2" xref="S3.E1.m1.1.2.2.2.cmml"><mi id="S3.E1.m1.1.2.2.2.2" xref="S3.E1.m1.1.2.2.2.2.cmml">𝐇</mi><mo id="S3.E1.m1.1.2.2.2.1" xref="S3.E1.m1.1.2.2.2.1.cmml">^</mo></mover><mi id="S3.E1.m1.1.2.2.3" xref="S3.E1.m1.1.2.2.3.cmml">t</mi><mrow id="S3.E1.m1.1.1.1.3" xref="S3.E1.m1.1.1.1.2.cmml"><mo id="S3.E1.m1.1.1.1.3.1" stretchy="false" xref="S3.E1.m1.1.1.1.2.1.cmml">[</mo><mi id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml">l</mi><mo id="S3.E1.m1.1.1.1.3.2" stretchy="false" xref="S3.E1.m1.1.1.1.2.1.cmml">]</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><apply id="S3.E1.m1.1.2.cmml" xref="S3.E1.m1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.2.1.cmml" xref="S3.E1.m1.1.2">superscript</csymbol><apply id="S3.E1.m1.1.2.2.cmml" xref="S3.E1.m1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.2.2.1.cmml" xref="S3.E1.m1.1.2">subscript</csymbol><apply id="S3.E1.m1.1.2.2.2.cmml" xref="S3.E1.m1.1.2.2.2"><ci id="S3.E1.m1.1.2.2.2.1.cmml" xref="S3.E1.m1.1.2.2.2.1">^</ci><ci id="S3.E1.m1.1.2.2.2.2.cmml" xref="S3.E1.m1.1.2.2.2.2">𝐇</ci></apply><ci id="S3.E1.m1.1.2.2.3.cmml" xref="S3.E1.m1.1.2.2.3">𝑡</ci></apply><apply id="S3.E1.m1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.3"><csymbol cd="latexml" id="S3.E1.m1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">\displaystyle\mathbf{\hat{H}}_{t}^{[l]}</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.1d">over^ start_ARG bold_H end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\phi_{t}(\mathbf{H}_{t}^{[l]},\mathbf{F}_{t}^{[l]})\oplus%
\mathcal{B}_{t}(\mathbf{F}_{t}^{[l]})," class="ltx_Math" display="inline" id="S3.E1.m2.4"><semantics id="S3.E1.m2.4a"><mrow id="S3.E1.m2.4.4.1" xref="S3.E1.m2.4.4.1.1.cmml"><mrow id="S3.E1.m2.4.4.1.1" xref="S3.E1.m2.4.4.1.1.cmml"><mi id="S3.E1.m2.4.4.1.1.5" xref="S3.E1.m2.4.4.1.1.5.cmml"></mi><mo id="S3.E1.m2.4.4.1.1.4" xref="S3.E1.m2.4.4.1.1.4.cmml">=</mo><mrow id="S3.E1.m2.4.4.1.1.3" xref="S3.E1.m2.4.4.1.1.3.cmml"><mrow id="S3.E1.m2.4.4.1.1.2.2" xref="S3.E1.m2.4.4.1.1.2.2.cmml"><msub id="S3.E1.m2.4.4.1.1.2.2.4" xref="S3.E1.m2.4.4.1.1.2.2.4.cmml"><mi id="S3.E1.m2.4.4.1.1.2.2.4.2" xref="S3.E1.m2.4.4.1.1.2.2.4.2.cmml">ϕ</mi><mi id="S3.E1.m2.4.4.1.1.2.2.4.3" xref="S3.E1.m2.4.4.1.1.2.2.4.3.cmml">t</mi></msub><mo id="S3.E1.m2.4.4.1.1.2.2.3" xref="S3.E1.m2.4.4.1.1.2.2.3.cmml">⁢</mo><mrow id="S3.E1.m2.4.4.1.1.2.2.2.2" xref="S3.E1.m2.4.4.1.1.2.2.2.3.cmml"><mo id="S3.E1.m2.4.4.1.1.2.2.2.2.3" stretchy="false" xref="S3.E1.m2.4.4.1.1.2.2.2.3.cmml">(</mo><msubsup id="S3.E1.m2.4.4.1.1.1.1.1.1.1" xref="S3.E1.m2.4.4.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m2.4.4.1.1.1.1.1.1.1.2.2" xref="S3.E1.m2.4.4.1.1.1.1.1.1.1.2.2.cmml">𝐇</mi><mi id="S3.E1.m2.4.4.1.1.1.1.1.1.1.2.3" xref="S3.E1.m2.4.4.1.1.1.1.1.1.1.2.3.cmml">t</mi><mrow id="S3.E1.m2.1.1.1.3" xref="S3.E1.m2.1.1.1.2.cmml"><mo id="S3.E1.m2.1.1.1.3.1" stretchy="false" xref="S3.E1.m2.1.1.1.2.1.cmml">[</mo><mi id="S3.E1.m2.1.1.1.1" xref="S3.E1.m2.1.1.1.1.cmml">l</mi><mo id="S3.E1.m2.1.1.1.3.2" stretchy="false" xref="S3.E1.m2.1.1.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.E1.m2.4.4.1.1.2.2.2.2.4" xref="S3.E1.m2.4.4.1.1.2.2.2.3.cmml">,</mo><msubsup id="S3.E1.m2.4.4.1.1.2.2.2.2.2" xref="S3.E1.m2.4.4.1.1.2.2.2.2.2.cmml"><mi id="S3.E1.m2.4.4.1.1.2.2.2.2.2.2.2" xref="S3.E1.m2.4.4.1.1.2.2.2.2.2.2.2.cmml">𝐅</mi><mi id="S3.E1.m2.4.4.1.1.2.2.2.2.2.2.3" xref="S3.E1.m2.4.4.1.1.2.2.2.2.2.2.3.cmml">t</mi><mrow id="S3.E1.m2.2.2.1.3" xref="S3.E1.m2.2.2.1.2.cmml"><mo id="S3.E1.m2.2.2.1.3.1" stretchy="false" xref="S3.E1.m2.2.2.1.2.1.cmml">[</mo><mi id="S3.E1.m2.2.2.1.1" xref="S3.E1.m2.2.2.1.1.cmml">l</mi><mo id="S3.E1.m2.2.2.1.3.2" stretchy="false" xref="S3.E1.m2.2.2.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.E1.m2.4.4.1.1.2.2.2.2.5" stretchy="false" xref="S3.E1.m2.4.4.1.1.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E1.m2.4.4.1.1.3.4" xref="S3.E1.m2.4.4.1.1.3.4.cmml">⊕</mo><mrow id="S3.E1.m2.4.4.1.1.3.3" xref="S3.E1.m2.4.4.1.1.3.3.cmml"><msub id="S3.E1.m2.4.4.1.1.3.3.3" xref="S3.E1.m2.4.4.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m2.4.4.1.1.3.3.3.2" xref="S3.E1.m2.4.4.1.1.3.3.3.2.cmml">ℬ</mi><mi id="S3.E1.m2.4.4.1.1.3.3.3.3" xref="S3.E1.m2.4.4.1.1.3.3.3.3.cmml">t</mi></msub><mo id="S3.E1.m2.4.4.1.1.3.3.2" xref="S3.E1.m2.4.4.1.1.3.3.2.cmml">⁢</mo><mrow id="S3.E1.m2.4.4.1.1.3.3.1.1" xref="S3.E1.m2.4.4.1.1.3.3.1.1.1.cmml"><mo id="S3.E1.m2.4.4.1.1.3.3.1.1.2" stretchy="false" xref="S3.E1.m2.4.4.1.1.3.3.1.1.1.cmml">(</mo><msubsup id="S3.E1.m2.4.4.1.1.3.3.1.1.1" xref="S3.E1.m2.4.4.1.1.3.3.1.1.1.cmml"><mi id="S3.E1.m2.4.4.1.1.3.3.1.1.1.2.2" xref="S3.E1.m2.4.4.1.1.3.3.1.1.1.2.2.cmml">𝐅</mi><mi id="S3.E1.m2.4.4.1.1.3.3.1.1.1.2.3" xref="S3.E1.m2.4.4.1.1.3.3.1.1.1.2.3.cmml">t</mi><mrow id="S3.E1.m2.3.3.1.3" xref="S3.E1.m2.3.3.1.2.cmml"><mo id="S3.E1.m2.3.3.1.3.1" stretchy="false" xref="S3.E1.m2.3.3.1.2.1.cmml">[</mo><mi id="S3.E1.m2.3.3.1.1" xref="S3.E1.m2.3.3.1.1.cmml">l</mi><mo id="S3.E1.m2.3.3.1.3.2" stretchy="false" xref="S3.E1.m2.3.3.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.E1.m2.4.4.1.1.3.3.1.1.3" stretchy="false" xref="S3.E1.m2.4.4.1.1.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E1.m2.4.4.1.2" xref="S3.E1.m2.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m2.4b"><apply id="S3.E1.m2.4.4.1.1.cmml" xref="S3.E1.m2.4.4.1"><eq id="S3.E1.m2.4.4.1.1.4.cmml" xref="S3.E1.m2.4.4.1.1.4"></eq><csymbol cd="latexml" id="S3.E1.m2.4.4.1.1.5.cmml" xref="S3.E1.m2.4.4.1.1.5">absent</csymbol><apply id="S3.E1.m2.4.4.1.1.3.cmml" xref="S3.E1.m2.4.4.1.1.3"><csymbol cd="latexml" id="S3.E1.m2.4.4.1.1.3.4.cmml" xref="S3.E1.m2.4.4.1.1.3.4">direct-sum</csymbol><apply id="S3.E1.m2.4.4.1.1.2.2.cmml" xref="S3.E1.m2.4.4.1.1.2.2"><times id="S3.E1.m2.4.4.1.1.2.2.3.cmml" xref="S3.E1.m2.4.4.1.1.2.2.3"></times><apply id="S3.E1.m2.4.4.1.1.2.2.4.cmml" xref="S3.E1.m2.4.4.1.1.2.2.4"><csymbol cd="ambiguous" id="S3.E1.m2.4.4.1.1.2.2.4.1.cmml" xref="S3.E1.m2.4.4.1.1.2.2.4">subscript</csymbol><ci id="S3.E1.m2.4.4.1.1.2.2.4.2.cmml" xref="S3.E1.m2.4.4.1.1.2.2.4.2">italic-ϕ</ci><ci id="S3.E1.m2.4.4.1.1.2.2.4.3.cmml" xref="S3.E1.m2.4.4.1.1.2.2.4.3">𝑡</ci></apply><interval closure="open" id="S3.E1.m2.4.4.1.1.2.2.2.3.cmml" xref="S3.E1.m2.4.4.1.1.2.2.2.2"><apply id="S3.E1.m2.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E1.m2.4.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m2.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m2.4.4.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E1.m2.4.4.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m2.4.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m2.4.4.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m2.4.4.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m2.4.4.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m2.4.4.1.1.1.1.1.1.1.2.2">𝐇</ci><ci id="S3.E1.m2.4.4.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m2.4.4.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.E1.m2.1.1.1.2.cmml" xref="S3.E1.m2.1.1.1.3"><csymbol cd="latexml" id="S3.E1.m2.1.1.1.2.1.cmml" xref="S3.E1.m2.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.E1.m2.1.1.1.1.cmml" xref="S3.E1.m2.1.1.1.1">𝑙</ci></apply></apply><apply id="S3.E1.m2.4.4.1.1.2.2.2.2.2.cmml" xref="S3.E1.m2.4.4.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m2.4.4.1.1.2.2.2.2.2.1.cmml" xref="S3.E1.m2.4.4.1.1.2.2.2.2.2">superscript</csymbol><apply id="S3.E1.m2.4.4.1.1.2.2.2.2.2.2.cmml" xref="S3.E1.m2.4.4.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m2.4.4.1.1.2.2.2.2.2.2.1.cmml" xref="S3.E1.m2.4.4.1.1.2.2.2.2.2">subscript</csymbol><ci id="S3.E1.m2.4.4.1.1.2.2.2.2.2.2.2.cmml" xref="S3.E1.m2.4.4.1.1.2.2.2.2.2.2.2">𝐅</ci><ci id="S3.E1.m2.4.4.1.1.2.2.2.2.2.2.3.cmml" xref="S3.E1.m2.4.4.1.1.2.2.2.2.2.2.3">𝑡</ci></apply><apply id="S3.E1.m2.2.2.1.2.cmml" xref="S3.E1.m2.2.2.1.3"><csymbol cd="latexml" id="S3.E1.m2.2.2.1.2.1.cmml" xref="S3.E1.m2.2.2.1.3.1">delimited-[]</csymbol><ci id="S3.E1.m2.2.2.1.1.cmml" xref="S3.E1.m2.2.2.1.1">𝑙</ci></apply></apply></interval></apply><apply id="S3.E1.m2.4.4.1.1.3.3.cmml" xref="S3.E1.m2.4.4.1.1.3.3"><times id="S3.E1.m2.4.4.1.1.3.3.2.cmml" xref="S3.E1.m2.4.4.1.1.3.3.2"></times><apply id="S3.E1.m2.4.4.1.1.3.3.3.cmml" xref="S3.E1.m2.4.4.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E1.m2.4.4.1.1.3.3.3.1.cmml" xref="S3.E1.m2.4.4.1.1.3.3.3">subscript</csymbol><ci id="S3.E1.m2.4.4.1.1.3.3.3.2.cmml" xref="S3.E1.m2.4.4.1.1.3.3.3.2">ℬ</ci><ci id="S3.E1.m2.4.4.1.1.3.3.3.3.cmml" xref="S3.E1.m2.4.4.1.1.3.3.3.3">𝑡</ci></apply><apply id="S3.E1.m2.4.4.1.1.3.3.1.1.1.cmml" xref="S3.E1.m2.4.4.1.1.3.3.1.1"><csymbol cd="ambiguous" id="S3.E1.m2.4.4.1.1.3.3.1.1.1.1.cmml" xref="S3.E1.m2.4.4.1.1.3.3.1.1">superscript</csymbol><apply id="S3.E1.m2.4.4.1.1.3.3.1.1.1.2.cmml" xref="S3.E1.m2.4.4.1.1.3.3.1.1"><csymbol cd="ambiguous" id="S3.E1.m2.4.4.1.1.3.3.1.1.1.2.1.cmml" xref="S3.E1.m2.4.4.1.1.3.3.1.1">subscript</csymbol><ci id="S3.E1.m2.4.4.1.1.3.3.1.1.1.2.2.cmml" xref="S3.E1.m2.4.4.1.1.3.3.1.1.1.2.2">𝐅</ci><ci id="S3.E1.m2.4.4.1.1.3.3.1.1.1.2.3.cmml" xref="S3.E1.m2.4.4.1.1.3.3.1.1.1.2.3">𝑡</ci></apply><apply id="S3.E1.m2.3.3.1.2.cmml" xref="S3.E1.m2.3.3.1.3"><csymbol cd="latexml" id="S3.E1.m2.3.3.1.2.1.cmml" xref="S3.E1.m2.3.3.1.3.1">delimited-[]</csymbol><ci id="S3.E1.m2.3.3.1.1.cmml" xref="S3.E1.m2.3.3.1.1">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m2.4c">\displaystyle=\phi_{t}(\mathbf{H}_{t}^{[l]},\mathbf{F}_{t}^{[l]})\oplus%
\mathcal{B}_{t}(\mathbf{F}_{t}^{[l]}),</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m2.4d">= italic_ϕ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_H start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT , bold_F start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT ) ⊕ caligraphic_B start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_F start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
<tbody id="S3.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{y}_{t}^{[l]}" class="ltx_Math" display="inline" id="S3.E2.m1.1"><semantics id="S3.E2.m1.1a"><msubsup id="S3.E2.m1.1.2" xref="S3.E2.m1.1.2.cmml"><mi id="S3.E2.m1.1.2.2.2" xref="S3.E2.m1.1.2.2.2.cmml">𝐲</mi><mi id="S3.E2.m1.1.2.2.3" xref="S3.E2.m1.1.2.2.3.cmml">t</mi><mrow id="S3.E2.m1.1.1.1.3" xref="S3.E2.m1.1.1.1.2.cmml"><mo id="S3.E2.m1.1.1.1.3.1" stretchy="false" xref="S3.E2.m1.1.1.1.2.1.cmml">[</mo><mi id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">l</mi><mo id="S3.E2.m1.1.1.1.3.2" stretchy="false" xref="S3.E2.m1.1.1.1.2.1.cmml">]</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.E2.m1.1b"><apply id="S3.E2.m1.1.2.cmml" xref="S3.E2.m1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.2.1.cmml" xref="S3.E2.m1.1.2">superscript</csymbol><apply id="S3.E2.m1.1.2.2.cmml" xref="S3.E2.m1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.2.2.1.cmml" xref="S3.E2.m1.1.2">subscript</csymbol><ci id="S3.E2.m1.1.2.2.2.cmml" xref="S3.E2.m1.1.2.2.2">𝐲</ci><ci id="S3.E2.m1.1.2.2.3.cmml" xref="S3.E2.m1.1.2.2.3">𝑡</ci></apply><apply id="S3.E2.m1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.3"><csymbol cd="latexml" id="S3.E2.m1.1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.1c">\displaystyle\mathbf{y}_{t}^{[l]}</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.1d">bold_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\psi_{t}(\mathbf{\hat{H}}_{t}^{[l]},\mathbf{F}_{t}^{[l]})+%
\mathcal{D}_{t}(\mathbf{F}_{t}^{[l]})." class="ltx_Math" display="inline" id="S3.E2.m2.4"><semantics id="S3.E2.m2.4a"><mrow id="S3.E2.m2.4.4.1" xref="S3.E2.m2.4.4.1.1.cmml"><mrow id="S3.E2.m2.4.4.1.1" xref="S3.E2.m2.4.4.1.1.cmml"><mi id="S3.E2.m2.4.4.1.1.5" xref="S3.E2.m2.4.4.1.1.5.cmml"></mi><mo id="S3.E2.m2.4.4.1.1.4" xref="S3.E2.m2.4.4.1.1.4.cmml">=</mo><mrow id="S3.E2.m2.4.4.1.1.3" xref="S3.E2.m2.4.4.1.1.3.cmml"><mrow id="S3.E2.m2.4.4.1.1.2.2" xref="S3.E2.m2.4.4.1.1.2.2.cmml"><msub id="S3.E2.m2.4.4.1.1.2.2.4" xref="S3.E2.m2.4.4.1.1.2.2.4.cmml"><mi id="S3.E2.m2.4.4.1.1.2.2.4.2" xref="S3.E2.m2.4.4.1.1.2.2.4.2.cmml">ψ</mi><mi id="S3.E2.m2.4.4.1.1.2.2.4.3" xref="S3.E2.m2.4.4.1.1.2.2.4.3.cmml">t</mi></msub><mo id="S3.E2.m2.4.4.1.1.2.2.3" xref="S3.E2.m2.4.4.1.1.2.2.3.cmml">⁢</mo><mrow id="S3.E2.m2.4.4.1.1.2.2.2.2" xref="S3.E2.m2.4.4.1.1.2.2.2.3.cmml"><mo id="S3.E2.m2.4.4.1.1.2.2.2.2.3" stretchy="false" xref="S3.E2.m2.4.4.1.1.2.2.2.3.cmml">(</mo><msubsup id="S3.E2.m2.4.4.1.1.1.1.1.1.1" xref="S3.E2.m2.4.4.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E2.m2.4.4.1.1.1.1.1.1.1.2.2" xref="S3.E2.m2.4.4.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E2.m2.4.4.1.1.1.1.1.1.1.2.2.2" xref="S3.E2.m2.4.4.1.1.1.1.1.1.1.2.2.2.cmml">𝐇</mi><mo id="S3.E2.m2.4.4.1.1.1.1.1.1.1.2.2.1" xref="S3.E2.m2.4.4.1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.E2.m2.4.4.1.1.1.1.1.1.1.2.3" xref="S3.E2.m2.4.4.1.1.1.1.1.1.1.2.3.cmml">t</mi><mrow id="S3.E2.m2.1.1.1.3" xref="S3.E2.m2.1.1.1.2.cmml"><mo id="S3.E2.m2.1.1.1.3.1" stretchy="false" xref="S3.E2.m2.1.1.1.2.1.cmml">[</mo><mi id="S3.E2.m2.1.1.1.1" xref="S3.E2.m2.1.1.1.1.cmml">l</mi><mo id="S3.E2.m2.1.1.1.3.2" stretchy="false" xref="S3.E2.m2.1.1.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.E2.m2.4.4.1.1.2.2.2.2.4" xref="S3.E2.m2.4.4.1.1.2.2.2.3.cmml">,</mo><msubsup id="S3.E2.m2.4.4.1.1.2.2.2.2.2" xref="S3.E2.m2.4.4.1.1.2.2.2.2.2.cmml"><mi id="S3.E2.m2.4.4.1.1.2.2.2.2.2.2.2" xref="S3.E2.m2.4.4.1.1.2.2.2.2.2.2.2.cmml">𝐅</mi><mi id="S3.E2.m2.4.4.1.1.2.2.2.2.2.2.3" xref="S3.E2.m2.4.4.1.1.2.2.2.2.2.2.3.cmml">t</mi><mrow id="S3.E2.m2.2.2.1.3" xref="S3.E2.m2.2.2.1.2.cmml"><mo id="S3.E2.m2.2.2.1.3.1" stretchy="false" xref="S3.E2.m2.2.2.1.2.1.cmml">[</mo><mi id="S3.E2.m2.2.2.1.1" xref="S3.E2.m2.2.2.1.1.cmml">l</mi><mo id="S3.E2.m2.2.2.1.3.2" stretchy="false" xref="S3.E2.m2.2.2.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.E2.m2.4.4.1.1.2.2.2.2.5" stretchy="false" xref="S3.E2.m2.4.4.1.1.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E2.m2.4.4.1.1.3.4" xref="S3.E2.m2.4.4.1.1.3.4.cmml">+</mo><mrow id="S3.E2.m2.4.4.1.1.3.3" xref="S3.E2.m2.4.4.1.1.3.3.cmml"><msub id="S3.E2.m2.4.4.1.1.3.3.3" xref="S3.E2.m2.4.4.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m2.4.4.1.1.3.3.3.2" xref="S3.E2.m2.4.4.1.1.3.3.3.2.cmml">𝒟</mi><mi id="S3.E2.m2.4.4.1.1.3.3.3.3" xref="S3.E2.m2.4.4.1.1.3.3.3.3.cmml">t</mi></msub><mo id="S3.E2.m2.4.4.1.1.3.3.2" xref="S3.E2.m2.4.4.1.1.3.3.2.cmml">⁢</mo><mrow id="S3.E2.m2.4.4.1.1.3.3.1.1" xref="S3.E2.m2.4.4.1.1.3.3.1.1.1.cmml"><mo id="S3.E2.m2.4.4.1.1.3.3.1.1.2" stretchy="false" xref="S3.E2.m2.4.4.1.1.3.3.1.1.1.cmml">(</mo><msubsup id="S3.E2.m2.4.4.1.1.3.3.1.1.1" xref="S3.E2.m2.4.4.1.1.3.3.1.1.1.cmml"><mi id="S3.E2.m2.4.4.1.1.3.3.1.1.1.2.2" xref="S3.E2.m2.4.4.1.1.3.3.1.1.1.2.2.cmml">𝐅</mi><mi id="S3.E2.m2.4.4.1.1.3.3.1.1.1.2.3" xref="S3.E2.m2.4.4.1.1.3.3.1.1.1.2.3.cmml">t</mi><mrow id="S3.E2.m2.3.3.1.3" xref="S3.E2.m2.3.3.1.2.cmml"><mo id="S3.E2.m2.3.3.1.3.1" stretchy="false" xref="S3.E2.m2.3.3.1.2.1.cmml">[</mo><mi id="S3.E2.m2.3.3.1.1" xref="S3.E2.m2.3.3.1.1.cmml">l</mi><mo id="S3.E2.m2.3.3.1.3.2" stretchy="false" xref="S3.E2.m2.3.3.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.E2.m2.4.4.1.1.3.3.1.1.3" stretchy="false" xref="S3.E2.m2.4.4.1.1.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E2.m2.4.4.1.2" lspace="0em" xref="S3.E2.m2.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m2.4b"><apply id="S3.E2.m2.4.4.1.1.cmml" xref="S3.E2.m2.4.4.1"><eq id="S3.E2.m2.4.4.1.1.4.cmml" xref="S3.E2.m2.4.4.1.1.4"></eq><csymbol cd="latexml" id="S3.E2.m2.4.4.1.1.5.cmml" xref="S3.E2.m2.4.4.1.1.5">absent</csymbol><apply id="S3.E2.m2.4.4.1.1.3.cmml" xref="S3.E2.m2.4.4.1.1.3"><plus id="S3.E2.m2.4.4.1.1.3.4.cmml" xref="S3.E2.m2.4.4.1.1.3.4"></plus><apply id="S3.E2.m2.4.4.1.1.2.2.cmml" xref="S3.E2.m2.4.4.1.1.2.2"><times id="S3.E2.m2.4.4.1.1.2.2.3.cmml" xref="S3.E2.m2.4.4.1.1.2.2.3"></times><apply id="S3.E2.m2.4.4.1.1.2.2.4.cmml" xref="S3.E2.m2.4.4.1.1.2.2.4"><csymbol cd="ambiguous" id="S3.E2.m2.4.4.1.1.2.2.4.1.cmml" xref="S3.E2.m2.4.4.1.1.2.2.4">subscript</csymbol><ci id="S3.E2.m2.4.4.1.1.2.2.4.2.cmml" xref="S3.E2.m2.4.4.1.1.2.2.4.2">𝜓</ci><ci id="S3.E2.m2.4.4.1.1.2.2.4.3.cmml" xref="S3.E2.m2.4.4.1.1.2.2.4.3">𝑡</ci></apply><interval closure="open" id="S3.E2.m2.4.4.1.1.2.2.2.3.cmml" xref="S3.E2.m2.4.4.1.1.2.2.2.2"><apply id="S3.E2.m2.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E2.m2.4.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m2.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m2.4.4.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E2.m2.4.4.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m2.4.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m2.4.4.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m2.4.4.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E2.m2.4.4.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m2.4.4.1.1.1.1.1.1.1.2.2"><ci id="S3.E2.m2.4.4.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E2.m2.4.4.1.1.1.1.1.1.1.2.2.1">^</ci><ci id="S3.E2.m2.4.4.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E2.m2.4.4.1.1.1.1.1.1.1.2.2.2">𝐇</ci></apply><ci id="S3.E2.m2.4.4.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m2.4.4.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.E2.m2.1.1.1.2.cmml" xref="S3.E2.m2.1.1.1.3"><csymbol cd="latexml" id="S3.E2.m2.1.1.1.2.1.cmml" xref="S3.E2.m2.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.E2.m2.1.1.1.1.cmml" xref="S3.E2.m2.1.1.1.1">𝑙</ci></apply></apply><apply id="S3.E2.m2.4.4.1.1.2.2.2.2.2.cmml" xref="S3.E2.m2.4.4.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m2.4.4.1.1.2.2.2.2.2.1.cmml" xref="S3.E2.m2.4.4.1.1.2.2.2.2.2">superscript</csymbol><apply id="S3.E2.m2.4.4.1.1.2.2.2.2.2.2.cmml" xref="S3.E2.m2.4.4.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m2.4.4.1.1.2.2.2.2.2.2.1.cmml" xref="S3.E2.m2.4.4.1.1.2.2.2.2.2">subscript</csymbol><ci id="S3.E2.m2.4.4.1.1.2.2.2.2.2.2.2.cmml" xref="S3.E2.m2.4.4.1.1.2.2.2.2.2.2.2">𝐅</ci><ci id="S3.E2.m2.4.4.1.1.2.2.2.2.2.2.3.cmml" xref="S3.E2.m2.4.4.1.1.2.2.2.2.2.2.3">𝑡</ci></apply><apply id="S3.E2.m2.2.2.1.2.cmml" xref="S3.E2.m2.2.2.1.3"><csymbol cd="latexml" id="S3.E2.m2.2.2.1.2.1.cmml" xref="S3.E2.m2.2.2.1.3.1">delimited-[]</csymbol><ci id="S3.E2.m2.2.2.1.1.cmml" xref="S3.E2.m2.2.2.1.1">𝑙</ci></apply></apply></interval></apply><apply id="S3.E2.m2.4.4.1.1.3.3.cmml" xref="S3.E2.m2.4.4.1.1.3.3"><times id="S3.E2.m2.4.4.1.1.3.3.2.cmml" xref="S3.E2.m2.4.4.1.1.3.3.2"></times><apply id="S3.E2.m2.4.4.1.1.3.3.3.cmml" xref="S3.E2.m2.4.4.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E2.m2.4.4.1.1.3.3.3.1.cmml" xref="S3.E2.m2.4.4.1.1.3.3.3">subscript</csymbol><ci id="S3.E2.m2.4.4.1.1.3.3.3.2.cmml" xref="S3.E2.m2.4.4.1.1.3.3.3.2">𝒟</ci><ci id="S3.E2.m2.4.4.1.1.3.3.3.3.cmml" xref="S3.E2.m2.4.4.1.1.3.3.3.3">𝑡</ci></apply><apply id="S3.E2.m2.4.4.1.1.3.3.1.1.1.cmml" xref="S3.E2.m2.4.4.1.1.3.3.1.1"><csymbol cd="ambiguous" id="S3.E2.m2.4.4.1.1.3.3.1.1.1.1.cmml" xref="S3.E2.m2.4.4.1.1.3.3.1.1">superscript</csymbol><apply id="S3.E2.m2.4.4.1.1.3.3.1.1.1.2.cmml" xref="S3.E2.m2.4.4.1.1.3.3.1.1"><csymbol cd="ambiguous" id="S3.E2.m2.4.4.1.1.3.3.1.1.1.2.1.cmml" xref="S3.E2.m2.4.4.1.1.3.3.1.1">subscript</csymbol><ci id="S3.E2.m2.4.4.1.1.3.3.1.1.1.2.2.cmml" xref="S3.E2.m2.4.4.1.1.3.3.1.1.1.2.2">𝐅</ci><ci id="S3.E2.m2.4.4.1.1.3.3.1.1.1.2.3.cmml" xref="S3.E2.m2.4.4.1.1.3.3.1.1.1.2.3">𝑡</ci></apply><apply id="S3.E2.m2.3.3.1.2.cmml" xref="S3.E2.m2.3.3.1.3"><csymbol cd="latexml" id="S3.E2.m2.3.3.1.2.1.cmml" xref="S3.E2.m2.3.3.1.3.1">delimited-[]</csymbol><ci id="S3.E2.m2.3.3.1.1.cmml" xref="S3.E2.m2.3.3.1.1">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m2.4c">\displaystyle=\psi_{t}(\mathbf{\hat{H}}_{t}^{[l]},\mathbf{F}_{t}^{[l]})+%
\mathcal{D}_{t}(\mathbf{F}_{t}^{[l]}).</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m2.4d">= italic_ψ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( over^ start_ARG bold_H end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT , bold_F start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT ) + caligraphic_D start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_F start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.6">In <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S3.E1" title="In 3.2 Causal History Model ‣ 3 Methodology ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">eq.</span> <span class="ltx_text ltx_ref_tag">1</span></a>, <math alttext="\mathcal{B}_{t}" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1"><semantics id="S3.SS2.p2.1.m1.1a"><msub id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">ℬ</mi><mi id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">ℬ</ci><ci id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">\mathcal{B}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.1d">caligraphic_B start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> denotes transformation on the input, and <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S3.SS2.p2.2.m2.1"><semantics id="S3.SS2.p2.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><ci id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.2.m2.1d">caligraphic_D</annotation></semantics></math> denotes the skip connection, while <math alttext="\oplus" class="ltx_Math" display="inline" id="S3.SS2.p2.3.m3.1"><semantics id="S3.SS2.p2.3.m3.1a"><mo id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml">⊕</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><csymbol cd="latexml" id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">direct-sum</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">\oplus</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.3.m3.1d">⊕</annotation></semantics></math> is the concatenation operation. In practice, we learn <math alttext="\phi_{t}" class="ltx_Math" display="inline" id="S3.SS2.p2.4.m4.1"><semantics id="S3.SS2.p2.4.m4.1a"><msub id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml"><mi id="S3.SS2.p2.4.m4.1.1.2" xref="S3.SS2.p2.4.m4.1.1.2.cmml">ϕ</mi><mi id="S3.SS2.p2.4.m4.1.1.3" xref="S3.SS2.p2.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><apply id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.1.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p2.4.m4.1.1.2.cmml" xref="S3.SS2.p2.4.m4.1.1.2">italic-ϕ</ci><ci id="S3.SS2.p2.4.m4.1.1.3.cmml" xref="S3.SS2.p2.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">\phi_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.4.m4.1d">italic_ϕ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, and the input transformation matrix <math alttext="\mathcal{B}" class="ltx_Math" display="inline" id="S3.SS2.p2.5.m5.1"><semantics id="S3.SS2.p2.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.5.m5.1.1" xref="S3.SS2.p2.5.m5.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m5.1b"><ci id="S3.SS2.p2.5.m5.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.1c">\mathcal{B}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.5.m5.1d">caligraphic_B</annotation></semantics></math> following the procedure described in <span class="ltx_text ltx_font_italic" id="S3.SS2.p2.6.1">State Align Block</span>, while <math alttext="\psi_{t}" class="ltx_Math" display="inline" id="S3.SS2.p2.6.m6.1"><semantics id="S3.SS2.p2.6.m6.1a"><msub id="S3.SS2.p2.6.m6.1.1" xref="S3.SS2.p2.6.m6.1.1.cmml"><mi id="S3.SS2.p2.6.m6.1.1.2" xref="S3.SS2.p2.6.m6.1.1.2.cmml">ψ</mi><mi id="S3.SS2.p2.6.m6.1.1.3" xref="S3.SS2.p2.6.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m6.1b"><apply id="S3.SS2.p2.6.m6.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m6.1.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.p2.6.m6.1.1.2.cmml" xref="S3.SS2.p2.6.m6.1.1.2">𝜓</ci><ci id="S3.SS2.p2.6.m6.1.1.3.cmml" xref="S3.SS2.p2.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m6.1c">\psi_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.6.m6.1d">italic_ψ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is detailed in <span class="ltx_text ltx_font_italic" id="S3.SS2.p2.6.2">Frame History Router</span>. We present a visual illustration of Causal History Model (<span class="ltx_text ltx_font_sansserif" id="S3.SS2.p2.6.3">CHM</span>) in <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S3.F2" title="In 3.1 Architecture Design ‣ 3 Methodology ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">2</span></a>. We also present a special case of (<span class="ltx_text ltx_font_sansserif" id="S3.SS2.p2.6.4">CHM</span>) in <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A3" title="Appendix C Relationship to State Space Models ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">appendix</span> <span class="ltx_text ltx_ref_tag">C</span></a>, wherein we consider optimally compensated motion in videos.</p>
</div>
<section class="ltx_paragraph" id="S3.SS2.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">State Align Block (<math alttext="\phi" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.1.m1.1"><semantics id="S3.SS2.SSS0.Px1.1.m1.1b"><mi id="S3.SS2.SSS0.Px1.1.m1.1.1" xref="S3.SS2.SSS0.Px1.1.m1.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.1.m1.1c"><ci id="S3.SS2.SSS0.Px1.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px1.1.m1.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.1.m1.1d">\phi</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.1.m1.1e">italic_ϕ</annotation></semantics></math>).</h4>
<div class="ltx_para" id="S3.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p1.5">State Align Block (<math alttext="\phi" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.1.m1.1"><semantics id="S3.SS2.SSS0.Px1.p1.1.m1.1a"><mi id="S3.SS2.SSS0.Px1.p1.1.m1.1.1" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.1.m1.1b"><ci id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.1.m1.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.1.m1.1d">italic_ϕ</annotation></semantics></math>) implicitly tracks and aligns the corresponding regions defined as groups of pixels (or patches) (<math alttext="p_{1}\times p_{2}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.2.m2.1"><semantics id="S3.SS2.SSS0.Px1.p1.2.m2.1a"><mrow id="S3.SS2.SSS0.Px1.p1.2.m2.1.1" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.cmml"><msub id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.2" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.2.cmml"><mi id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.2.2" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.2.2.cmml">p</mi><mn id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.2.3" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.2.3.cmml">1</mn></msub><mo id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.1.cmml">×</mo><msub id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.3" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.3.2" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.3.2.cmml">p</mi><mn id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.3.3" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.3.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.2.m2.1b"><apply id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1"><times id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.1"></times><apply id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.2.2">𝑝</ci><cn id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.2.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.2.3">1</cn></apply><apply id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.3.2">𝑝</ci><cn id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.3.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.2.m2.1c">p_{1}\times p_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.2.m2.1d">italic_p start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT × italic_p start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>)—across each frame in the history. State Align Block computes attention scores through a dot product between any given patch from the current frame and all the patches from the history. Given the input feature map of a frame <math alttext="\mathbf{F}^{[l]}_{t}\in\mathbb{R}^{h^{l}\times w^{l}\times c^{l}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.3.m3.1"><semantics id="S3.SS2.SSS0.Px1.p1.3.m3.1a"><mrow id="S3.SS2.SSS0.Px1.p1.3.m3.1.2" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.2.cmml"><msubsup id="S3.SS2.SSS0.Px1.p1.3.m3.1.2.2" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.2.2.cmml"><mi id="S3.SS2.SSS0.Px1.p1.3.m3.1.2.2.2.2" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.2.2.2.2.cmml">𝐅</mi><mi id="S3.SS2.SSS0.Px1.p1.3.m3.1.2.2.3" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.2.2.3.cmml">t</mi><mrow id="S3.SS2.SSS0.Px1.p1.3.m3.1.1.1.3" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.1.1.2.cmml"><mo id="S3.SS2.SSS0.Px1.p1.3.m3.1.1.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.1.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px1.p1.3.m3.1.1.1.1" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.1.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px1.p1.3.m3.1.1.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.1.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.SS2.SSS0.Px1.p1.3.m3.1.2.1" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.2.1.cmml">∈</mo><msup id="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.2" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.cmml"><msup id="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.2" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.2.cmml"><mi id="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.2.2" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.2.2.cmml">h</mi><mi id="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.2.3" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.2.3.cmml">l</mi></msup><mo id="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.1.cmml">×</mo><msup id="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.3" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.3.2" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.3.2.cmml">w</mi><mi id="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.3.3" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.3.3.cmml">l</mi></msup><mo id="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.1.cmml">×</mo><msup id="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.4" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.4.cmml"><mi id="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.4.2" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.4.2.cmml">c</mi><mi id="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.4.3" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.4.3.cmml">l</mi></msup></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.3.m3.1b"><apply id="S3.SS2.SSS0.Px1.p1.3.m3.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.2"><in id="S3.SS2.SSS0.Px1.p1.3.m3.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.2.1"></in><apply id="S3.SS2.SSS0.Px1.p1.3.m3.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.3.m3.1.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.2.2">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p1.3.m3.1.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.3.m3.1.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.2.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.3.m3.1.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.2.2.2.2">𝐅</ci><apply id="S3.SS2.SSS0.Px1.p1.3.m3.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.1.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px1.p1.3.m3.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px1.p1.3.m3.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.1.1.1">𝑙</ci></apply></apply><ci id="S3.SS2.SSS0.Px1.p1.3.m3.1.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.2.2.3">𝑡</ci></apply><apply id="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.2">ℝ</ci><apply id="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3"><times id="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.1"></times><apply id="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.2.2">ℎ</ci><ci id="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.2.3">𝑙</ci></apply><apply id="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.3.2">𝑤</ci><ci id="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.3.3">𝑙</ci></apply><apply id="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.4.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.4"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.4.1.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.4">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.4.2.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.4.2">𝑐</ci><ci id="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.4.3.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.2.3.3.4.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.3.m3.1c">\mathbf{F}^{[l]}_{t}\in\mathbb{R}^{h^{l}\times w^{l}\times c^{l}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.3.m3.1d">bold_F start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_h start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT × italic_w start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT × italic_c start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, we calculate the patched projections as, <math alttext="\mathbf{Q}^{[l]}_{\mathbf{F}_{t}},\mathbf{K}^{[l]}_{\mathbf{F}_{t}},\mathbf{V}%
^{[l]}_{\mathbf{F}_{t}}\in\mathbb{R}^{\frac{h^{l}}{p_{1}}\times\frac{w^{l}}{p_%
{2}}\times(cp_{1}p_{2})^{l}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.4.m4.7"><semantics id="S3.SS2.SSS0.Px1.p1.4.m4.7a"><mrow id="S3.SS2.SSS0.Px1.p1.4.m4.7.7" xref="S3.SS2.SSS0.Px1.p1.4.m4.7.7.cmml"><mrow id="S3.SS2.SSS0.Px1.p1.4.m4.7.7.3.3" xref="S3.SS2.SSS0.Px1.p1.4.m4.7.7.3.4.cmml"><msubsup id="S3.SS2.SSS0.Px1.p1.4.m4.5.5.1.1.1" xref="S3.SS2.SSS0.Px1.p1.4.m4.5.5.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.4.m4.5.5.1.1.1.2.2" xref="S3.SS2.SSS0.Px1.p1.4.m4.5.5.1.1.1.2.2.cmml">𝐐</mi><msub id="S3.SS2.SSS0.Px1.p1.4.m4.5.5.1.1.1.3" xref="S3.SS2.SSS0.Px1.p1.4.m4.5.5.1.1.1.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.4.m4.5.5.1.1.1.3.2" xref="S3.SS2.SSS0.Px1.p1.4.m4.5.5.1.1.1.3.2.cmml">𝐅</mi><mi id="S3.SS2.SSS0.Px1.p1.4.m4.5.5.1.1.1.3.3" xref="S3.SS2.SSS0.Px1.p1.4.m4.5.5.1.1.1.3.3.cmml">t</mi></msub><mrow id="S3.SS2.SSS0.Px1.p1.4.m4.1.1.1.3" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.1.1.2.cmml"><mo id="S3.SS2.SSS0.Px1.p1.4.m4.1.1.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.1.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px1.p1.4.m4.1.1.1.1" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.1.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px1.p1.4.m4.1.1.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.1.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.SS2.SSS0.Px1.p1.4.m4.7.7.3.3.4" xref="S3.SS2.SSS0.Px1.p1.4.m4.7.7.3.4.cmml">,</mo><msubsup id="S3.SS2.SSS0.Px1.p1.4.m4.6.6.2.2.2" xref="S3.SS2.SSS0.Px1.p1.4.m4.6.6.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px1.p1.4.m4.6.6.2.2.2.2.2" xref="S3.SS2.SSS0.Px1.p1.4.m4.6.6.2.2.2.2.2.cmml">𝐊</mi><msub id="S3.SS2.SSS0.Px1.p1.4.m4.6.6.2.2.2.3" xref="S3.SS2.SSS0.Px1.p1.4.m4.6.6.2.2.2.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.4.m4.6.6.2.2.2.3.2" xref="S3.SS2.SSS0.Px1.p1.4.m4.6.6.2.2.2.3.2.cmml">𝐅</mi><mi id="S3.SS2.SSS0.Px1.p1.4.m4.6.6.2.2.2.3.3" xref="S3.SS2.SSS0.Px1.p1.4.m4.6.6.2.2.2.3.3.cmml">t</mi></msub><mrow id="S3.SS2.SSS0.Px1.p1.4.m4.2.2.1.3" xref="S3.SS2.SSS0.Px1.p1.4.m4.2.2.1.2.cmml"><mo id="S3.SS2.SSS0.Px1.p1.4.m4.2.2.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.4.m4.2.2.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px1.p1.4.m4.2.2.1.1" xref="S3.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px1.p1.4.m4.2.2.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.4.m4.2.2.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.SS2.SSS0.Px1.p1.4.m4.7.7.3.3.5" xref="S3.SS2.SSS0.Px1.p1.4.m4.7.7.3.4.cmml">,</mo><msubsup id="S3.SS2.SSS0.Px1.p1.4.m4.7.7.3.3.3" xref="S3.SS2.SSS0.Px1.p1.4.m4.7.7.3.3.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.4.m4.7.7.3.3.3.2.2" xref="S3.SS2.SSS0.Px1.p1.4.m4.7.7.3.3.3.2.2.cmml">𝐕</mi><msub id="S3.SS2.SSS0.Px1.p1.4.m4.7.7.3.3.3.3" xref="S3.SS2.SSS0.Px1.p1.4.m4.7.7.3.3.3.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.4.m4.7.7.3.3.3.3.2" xref="S3.SS2.SSS0.Px1.p1.4.m4.7.7.3.3.3.3.2.cmml">𝐅</mi><mi id="S3.SS2.SSS0.Px1.p1.4.m4.7.7.3.3.3.3.3" xref="S3.SS2.SSS0.Px1.p1.4.m4.7.7.3.3.3.3.3.cmml">t</mi></msub><mrow id="S3.SS2.SSS0.Px1.p1.4.m4.3.3.1.3" xref="S3.SS2.SSS0.Px1.p1.4.m4.3.3.1.2.cmml"><mo id="S3.SS2.SSS0.Px1.p1.4.m4.3.3.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.4.m4.3.3.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px1.p1.4.m4.3.3.1.1" xref="S3.SS2.SSS0.Px1.p1.4.m4.3.3.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px1.p1.4.m4.3.3.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.4.m4.3.3.1.2.1.cmml">]</mo></mrow></msubsup></mrow><mo id="S3.SS2.SSS0.Px1.p1.4.m4.7.7.4" xref="S3.SS2.SSS0.Px1.p1.4.m4.7.7.4.cmml">∈</mo><msup id="S3.SS2.SSS0.Px1.p1.4.m4.7.7.5" xref="S3.SS2.SSS0.Px1.p1.4.m4.7.7.5.cmml"><mi id="S3.SS2.SSS0.Px1.p1.4.m4.7.7.5.2" xref="S3.SS2.SSS0.Px1.p1.4.m4.7.7.5.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.cmml"><mfrac id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.3" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.3.cmml"><msup id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.3.2" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.3.2.cmml"><mi id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.3.2.2" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.3.2.2.cmml">h</mi><mi id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.3.2.3" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.3.2.3.cmml">l</mi></msup><msub id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.3.3" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.3.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.3.3.2" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.3.3.2.cmml">p</mi><mn id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.3.3.3" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.3.3.3.cmml">1</mn></msub></mfrac><mo id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.2" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.2.cmml">×</mo><mfrac id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.4" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.4.cmml"><msup id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.4.2" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.4.2.cmml"><mi id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.4.2.2" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.4.2.2.cmml">w</mi><mi id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.4.2.3" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.4.2.3.cmml">l</mi></msup><msub id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.4.3" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.4.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.4.3.2" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.4.3.2.cmml">p</mi><mn id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.4.3.3" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.4.3.3.cmml">2</mn></msub></mfrac><mo id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.2a" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.2.cmml">×</mo><msup id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.cmml"><mrow id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.1.1" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.1.1.1" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.1.1.1.2" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.1.1.1.2.cmml">c</mi><mo id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.1.1.1.1" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.1.1.1.1.cmml">⁢</mo><msub id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.1.1.1.3" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.1.1.1.3.2" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.1.1.1.3.2.cmml">p</mi><mn id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.1.1.1.3.3" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.1.1.1.3.3.cmml">1</mn></msub><mo id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.1.1.1.1a" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.1.1.1.1.cmml">⁢</mo><msub id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.1.1.1.4" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.1.1.1.4.cmml"><mi id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.1.1.1.4.2" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.1.1.1.4.2.cmml">p</mi><mn id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.1.1.1.4.3" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.1.1.1.4.3.cmml">2</mn></msub></mrow><mo id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.3" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.3.cmml">l</mi></msup></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.4.m4.7b"><apply id="S3.SS2.SSS0.Px1.p1.4.m4.7.7.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.7.7"><in id="S3.SS2.SSS0.Px1.p1.4.m4.7.7.4.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.7.7.4"></in><list id="S3.SS2.SSS0.Px1.p1.4.m4.7.7.3.4.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.7.7.3.3"><apply id="S3.SS2.SSS0.Px1.p1.4.m4.5.5.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.5.5.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.5.5.1.1.1">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p1.4.m4.5.5.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.5.5.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.4.m4.5.5.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.5.5.1.1.1">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.4.m4.5.5.1.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.5.5.1.1.1.2.2">𝐐</ci><apply id="S3.SS2.SSS0.Px1.p1.4.m4.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.1.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px1.p1.4.m4.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px1.p1.4.m4.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.1.1.1">𝑙</ci></apply></apply><apply id="S3.SS2.SSS0.Px1.p1.4.m4.5.5.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.5.5.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.4.m4.5.5.1.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.5.5.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.4.m4.5.5.1.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.5.5.1.1.1.3.2">𝐅</ci><ci id="S3.SS2.SSS0.Px1.p1.4.m4.5.5.1.1.1.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.5.5.1.1.1.3.3">𝑡</ci></apply></apply><apply id="S3.SS2.SSS0.Px1.p1.4.m4.6.6.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.6.6.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.4.m4.6.6.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.6.6.2.2.2">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p1.4.m4.6.6.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.6.6.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.4.m4.6.6.2.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.6.6.2.2.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.4.m4.6.6.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.6.6.2.2.2.2.2">𝐊</ci><apply id="S3.SS2.SSS0.Px1.p1.4.m4.2.2.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.2.2.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px1.p1.4.m4.2.2.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.2.2.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.2.2.1.1">𝑙</ci></apply></apply><apply id="S3.SS2.SSS0.Px1.p1.4.m4.6.6.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.6.6.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.4.m4.6.6.2.2.2.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.6.6.2.2.2.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.4.m4.6.6.2.2.2.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.6.6.2.2.2.3.2">𝐅</ci><ci id="S3.SS2.SSS0.Px1.p1.4.m4.6.6.2.2.2.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.6.6.2.2.2.3.3">𝑡</ci></apply></apply><apply id="S3.SS2.SSS0.Px1.p1.4.m4.7.7.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.7.7.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.4.m4.7.7.3.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.7.7.3.3.3">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p1.4.m4.7.7.3.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.7.7.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.4.m4.7.7.3.3.3.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.7.7.3.3.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.4.m4.7.7.3.3.3.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.7.7.3.3.3.2.2">𝐕</ci><apply id="S3.SS2.SSS0.Px1.p1.4.m4.3.3.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.3.3.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px1.p1.4.m4.3.3.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.3.3.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px1.p1.4.m4.3.3.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.3.3.1.1">𝑙</ci></apply></apply><apply id="S3.SS2.SSS0.Px1.p1.4.m4.7.7.3.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.7.7.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.4.m4.7.7.3.3.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.7.7.3.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.4.m4.7.7.3.3.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.7.7.3.3.3.3.2">𝐅</ci><ci id="S3.SS2.SSS0.Px1.p1.4.m4.7.7.3.3.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.7.7.3.3.3.3.3">𝑡</ci></apply></apply></list><apply id="S3.SS2.SSS0.Px1.p1.4.m4.7.7.5.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.7.7.5"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.4.m4.7.7.5.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.7.7.5">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.4.m4.7.7.5.2.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.7.7.5.2">ℝ</ci><apply id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1"><times id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.2"></times><apply id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.3"><divide id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.3"></divide><apply id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.3.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.3.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.3.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.3.2.2">ℎ</ci><ci id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.3.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.3.2.3">𝑙</ci></apply><apply id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.3.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.3.3.2">𝑝</ci><cn id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.3.3.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.3.3.3">1</cn></apply></apply><apply id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.4.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.4"><divide id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.4.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.4"></divide><apply id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.4.2.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.4.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.4.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.4.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.4.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.4.2.2">𝑤</ci><ci id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.4.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.4.2.3">𝑙</ci></apply><apply id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.4.3.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.4.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.4.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.4.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.4.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.4.3.2">𝑝</ci><cn id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.4.3.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.4.3.3">2</cn></apply></apply><apply id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1">superscript</csymbol><apply id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.1.1"><times id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.1.1.1.1"></times><ci id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.1.1.1.2">𝑐</ci><apply id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.1.1.1.3.2">𝑝</ci><cn id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.1.1.1.3.3">1</cn></apply><apply id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.1.1.1.4.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.1.1.1.4.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.1.1.1.4">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.1.1.1.4.2.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.1.1.1.4.2">𝑝</ci><cn id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.1.1.1.4.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.1.1.1.4.3">2</cn></apply></apply><ci id="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.4.4.1.1.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.4.m4.7c">\mathbf{Q}^{[l]}_{\mathbf{F}_{t}},\mathbf{K}^{[l]}_{\mathbf{F}_{t}},\mathbf{V}%
^{[l]}_{\mathbf{F}_{t}}\in\mathbb{R}^{\frac{h^{l}}{p_{1}}\times\frac{w^{l}}{p_%
{2}}\times(cp_{1}p_{2})^{l}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.4.m4.7d">bold_Q start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT bold_F start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT , bold_K start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT bold_F start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT , bold_V start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT bold_F start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT divide start_ARG italic_h start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT end_ARG start_ARG italic_p start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_ARG × divide start_ARG italic_w start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT end_ARG start_ARG italic_p start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG × ( italic_c italic_p start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, i.e., <math alttext="\mathbf{Q}^{[l]}_{\mathbf{F}_{t}},\mathbf{K}^{[l]}_{\mathbf{F}_{t}},\mathbf{V}%
^{[l]}_{\mathbf{F}_{t}}\leftarrow\mathbf{F}^{[l]}_{t}W^{\mathbf{F}^{[l]}_{t}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.5.m5.8"><semantics id="S3.SS2.SSS0.Px1.p1.5.m5.8a"><mrow id="S3.SS2.SSS0.Px1.p1.5.m5.8.8" xref="S3.SS2.SSS0.Px1.p1.5.m5.8.8.cmml"><mrow id="S3.SS2.SSS0.Px1.p1.5.m5.8.8.3.3" xref="S3.SS2.SSS0.Px1.p1.5.m5.8.8.3.4.cmml"><msubsup id="S3.SS2.SSS0.Px1.p1.5.m5.6.6.1.1.1" xref="S3.SS2.SSS0.Px1.p1.5.m5.6.6.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.5.m5.6.6.1.1.1.2.2" xref="S3.SS2.SSS0.Px1.p1.5.m5.6.6.1.1.1.2.2.cmml">𝐐</mi><msub id="S3.SS2.SSS0.Px1.p1.5.m5.6.6.1.1.1.3" xref="S3.SS2.SSS0.Px1.p1.5.m5.6.6.1.1.1.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.5.m5.6.6.1.1.1.3.2" xref="S3.SS2.SSS0.Px1.p1.5.m5.6.6.1.1.1.3.2.cmml">𝐅</mi><mi id="S3.SS2.SSS0.Px1.p1.5.m5.6.6.1.1.1.3.3" xref="S3.SS2.SSS0.Px1.p1.5.m5.6.6.1.1.1.3.3.cmml">t</mi></msub><mrow id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.1.3" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.1.2.cmml"><mo id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.1.1" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.SS2.SSS0.Px1.p1.5.m5.8.8.3.3.4" xref="S3.SS2.SSS0.Px1.p1.5.m5.8.8.3.4.cmml">,</mo><msubsup id="S3.SS2.SSS0.Px1.p1.5.m5.7.7.2.2.2" xref="S3.SS2.SSS0.Px1.p1.5.m5.7.7.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px1.p1.5.m5.7.7.2.2.2.2.2" xref="S3.SS2.SSS0.Px1.p1.5.m5.7.7.2.2.2.2.2.cmml">𝐊</mi><msub id="S3.SS2.SSS0.Px1.p1.5.m5.7.7.2.2.2.3" xref="S3.SS2.SSS0.Px1.p1.5.m5.7.7.2.2.2.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.5.m5.7.7.2.2.2.3.2" xref="S3.SS2.SSS0.Px1.p1.5.m5.7.7.2.2.2.3.2.cmml">𝐅</mi><mi id="S3.SS2.SSS0.Px1.p1.5.m5.7.7.2.2.2.3.3" xref="S3.SS2.SSS0.Px1.p1.5.m5.7.7.2.2.2.3.3.cmml">t</mi></msub><mrow id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.3" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.2.cmml"><mo id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.SS2.SSS0.Px1.p1.5.m5.8.8.3.3.5" xref="S3.SS2.SSS0.Px1.p1.5.m5.8.8.3.4.cmml">,</mo><msubsup id="S3.SS2.SSS0.Px1.p1.5.m5.8.8.3.3.3" xref="S3.SS2.SSS0.Px1.p1.5.m5.8.8.3.3.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.5.m5.8.8.3.3.3.2.2" xref="S3.SS2.SSS0.Px1.p1.5.m5.8.8.3.3.3.2.2.cmml">𝐕</mi><msub id="S3.SS2.SSS0.Px1.p1.5.m5.8.8.3.3.3.3" xref="S3.SS2.SSS0.Px1.p1.5.m5.8.8.3.3.3.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.5.m5.8.8.3.3.3.3.2" xref="S3.SS2.SSS0.Px1.p1.5.m5.8.8.3.3.3.3.2.cmml">𝐅</mi><mi id="S3.SS2.SSS0.Px1.p1.5.m5.8.8.3.3.3.3.3" xref="S3.SS2.SSS0.Px1.p1.5.m5.8.8.3.3.3.3.3.cmml">t</mi></msub><mrow id="S3.SS2.SSS0.Px1.p1.5.m5.3.3.1.3" xref="S3.SS2.SSS0.Px1.p1.5.m5.3.3.1.2.cmml"><mo id="S3.SS2.SSS0.Px1.p1.5.m5.3.3.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.5.m5.3.3.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px1.p1.5.m5.3.3.1.1" xref="S3.SS2.SSS0.Px1.p1.5.m5.3.3.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px1.p1.5.m5.3.3.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.5.m5.3.3.1.2.1.cmml">]</mo></mrow></msubsup></mrow><mo id="S3.SS2.SSS0.Px1.p1.5.m5.8.8.4" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.5.m5.8.8.4.cmml">←</mo><mrow id="S3.SS2.SSS0.Px1.p1.5.m5.8.8.5" xref="S3.SS2.SSS0.Px1.p1.5.m5.8.8.5.cmml"><msubsup id="S3.SS2.SSS0.Px1.p1.5.m5.8.8.5.2" xref="S3.SS2.SSS0.Px1.p1.5.m5.8.8.5.2.cmml"><mi id="S3.SS2.SSS0.Px1.p1.5.m5.8.8.5.2.2.2" xref="S3.SS2.SSS0.Px1.p1.5.m5.8.8.5.2.2.2.cmml">𝐅</mi><mi id="S3.SS2.SSS0.Px1.p1.5.m5.8.8.5.2.3" xref="S3.SS2.SSS0.Px1.p1.5.m5.8.8.5.2.3.cmml">t</mi><mrow id="S3.SS2.SSS0.Px1.p1.5.m5.4.4.1.3" xref="S3.SS2.SSS0.Px1.p1.5.m5.4.4.1.2.cmml"><mo id="S3.SS2.SSS0.Px1.p1.5.m5.4.4.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.5.m5.4.4.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px1.p1.5.m5.4.4.1.1" xref="S3.SS2.SSS0.Px1.p1.5.m5.4.4.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px1.p1.5.m5.4.4.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.5.m5.4.4.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.SS2.SSS0.Px1.p1.5.m5.8.8.5.1" xref="S3.SS2.SSS0.Px1.p1.5.m5.8.8.5.1.cmml">⁢</mo><msup id="S3.SS2.SSS0.Px1.p1.5.m5.8.8.5.3" xref="S3.SS2.SSS0.Px1.p1.5.m5.8.8.5.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.5.m5.8.8.5.3.2" xref="S3.SS2.SSS0.Px1.p1.5.m5.8.8.5.3.2.cmml">W</mi><msubsup id="S3.SS2.SSS0.Px1.p1.5.m5.5.5.1" xref="S3.SS2.SSS0.Px1.p1.5.m5.5.5.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.5.m5.5.5.1.3.2" xref="S3.SS2.SSS0.Px1.p1.5.m5.5.5.1.3.2.cmml">𝐅</mi><mi id="S3.SS2.SSS0.Px1.p1.5.m5.5.5.1.4" xref="S3.SS2.SSS0.Px1.p1.5.m5.5.5.1.4.cmml">t</mi><mrow id="S3.SS2.SSS0.Px1.p1.5.m5.5.5.1.1.1.3" xref="S3.SS2.SSS0.Px1.p1.5.m5.5.5.1.1.1.2.cmml"><mo id="S3.SS2.SSS0.Px1.p1.5.m5.5.5.1.1.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.5.m5.5.5.1.1.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px1.p1.5.m5.5.5.1.1.1.1" xref="S3.SS2.SSS0.Px1.p1.5.m5.5.5.1.1.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px1.p1.5.m5.5.5.1.1.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.5.m5.5.5.1.1.1.2.1.cmml">]</mo></mrow></msubsup></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.5.m5.8b"><apply id="S3.SS2.SSS0.Px1.p1.5.m5.8.8.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.8.8"><ci id="S3.SS2.SSS0.Px1.p1.5.m5.8.8.4.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.8.8.4">←</ci><list id="S3.SS2.SSS0.Px1.p1.5.m5.8.8.3.4.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.8.8.3.3"><apply id="S3.SS2.SSS0.Px1.p1.5.m5.6.6.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.6.6.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.5.m5.6.6.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.6.6.1.1.1">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p1.5.m5.6.6.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.6.6.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.5.m5.6.6.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.6.6.1.1.1">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.5.m5.6.6.1.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.6.6.1.1.1.2.2">𝐐</ci><apply id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.1.1">𝑙</ci></apply></apply><apply id="S3.SS2.SSS0.Px1.p1.5.m5.6.6.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.6.6.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.5.m5.6.6.1.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.6.6.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.5.m5.6.6.1.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.6.6.1.1.1.3.2">𝐅</ci><ci id="S3.SS2.SSS0.Px1.p1.5.m5.6.6.1.1.1.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.6.6.1.1.1.3.3">𝑡</ci></apply></apply><apply id="S3.SS2.SSS0.Px1.p1.5.m5.7.7.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.7.7.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.5.m5.7.7.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.7.7.2.2.2">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p1.5.m5.7.7.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.7.7.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.5.m5.7.7.2.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.7.7.2.2.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.5.m5.7.7.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.7.7.2.2.2.2.2">𝐊</ci><apply id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1">𝑙</ci></apply></apply><apply id="S3.SS2.SSS0.Px1.p1.5.m5.7.7.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.7.7.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.5.m5.7.7.2.2.2.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.7.7.2.2.2.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.5.m5.7.7.2.2.2.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.7.7.2.2.2.3.2">𝐅</ci><ci id="S3.SS2.SSS0.Px1.p1.5.m5.7.7.2.2.2.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.7.7.2.2.2.3.3">𝑡</ci></apply></apply><apply id="S3.SS2.SSS0.Px1.p1.5.m5.8.8.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.8.8.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.5.m5.8.8.3.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.8.8.3.3.3">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p1.5.m5.8.8.3.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.8.8.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.5.m5.8.8.3.3.3.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.8.8.3.3.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.5.m5.8.8.3.3.3.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.8.8.3.3.3.2.2">𝐕</ci><apply id="S3.SS2.SSS0.Px1.p1.5.m5.3.3.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.3.3.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px1.p1.5.m5.3.3.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.3.3.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px1.p1.5.m5.3.3.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.3.3.1.1">𝑙</ci></apply></apply><apply id="S3.SS2.SSS0.Px1.p1.5.m5.8.8.3.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.8.8.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.5.m5.8.8.3.3.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.8.8.3.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.5.m5.8.8.3.3.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.8.8.3.3.3.3.2">𝐅</ci><ci id="S3.SS2.SSS0.Px1.p1.5.m5.8.8.3.3.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.8.8.3.3.3.3.3">𝑡</ci></apply></apply></list><apply id="S3.SS2.SSS0.Px1.p1.5.m5.8.8.5.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.8.8.5"><times id="S3.SS2.SSS0.Px1.p1.5.m5.8.8.5.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.8.8.5.1"></times><apply id="S3.SS2.SSS0.Px1.p1.5.m5.8.8.5.2.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.8.8.5.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.5.m5.8.8.5.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.8.8.5.2">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p1.5.m5.8.8.5.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.8.8.5.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.5.m5.8.8.5.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.8.8.5.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.5.m5.8.8.5.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.8.8.5.2.2.2">𝐅</ci><apply id="S3.SS2.SSS0.Px1.p1.5.m5.4.4.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.4.4.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px1.p1.5.m5.4.4.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.4.4.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px1.p1.5.m5.4.4.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.4.4.1.1">𝑙</ci></apply></apply><ci id="S3.SS2.SSS0.Px1.p1.5.m5.8.8.5.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.8.8.5.2.3">𝑡</ci></apply><apply id="S3.SS2.SSS0.Px1.p1.5.m5.8.8.5.3.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.8.8.5.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.5.m5.8.8.5.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.8.8.5.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.5.m5.8.8.5.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.8.8.5.3.2">𝑊</ci><apply id="S3.SS2.SSS0.Px1.p1.5.m5.5.5.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.5.5.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.5.m5.5.5.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.5.5.1">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p1.5.m5.5.5.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.5.5.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.5.m5.5.5.1.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.5.5.1">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.5.m5.5.5.1.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.5.5.1.3.2">𝐅</ci><apply id="S3.SS2.SSS0.Px1.p1.5.m5.5.5.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.5.5.1.1.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px1.p1.5.m5.5.5.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.5.5.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px1.p1.5.m5.5.5.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.5.5.1.1.1.1">𝑙</ci></apply></apply><ci id="S3.SS2.SSS0.Px1.p1.5.m5.5.5.1.4.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.5.5.1.4">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.5.m5.8c">\mathbf{Q}^{[l]}_{\mathbf{F}_{t}},\mathbf{K}^{[l]}_{\mathbf{F}_{t}},\mathbf{V}%
^{[l]}_{\mathbf{F}_{t}}\leftarrow\mathbf{F}^{[l]}_{t}W^{\mathbf{F}^{[l]}_{t}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.5.m5.8d">bold_Q start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT bold_F start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT , bold_K start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT bold_F start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT , bold_V start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT bold_F start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT ← bold_F start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_W start_POSTSUPERSCRIPT bold_F start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math></p>
</div>
<div class="ltx_para" id="S3.SS2.SSS0.Px1.p2">
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p2.7">where <math alttext="W^{\mathbf{F}^{[l]}_{t}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.1.m1.1"><semantics id="S3.SS2.SSS0.Px1.p2.1.m1.1a"><msup id="S3.SS2.SSS0.Px1.p2.1.m1.1.2" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.2.cmml"><mi id="S3.SS2.SSS0.Px1.p2.1.m1.1.2.2" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.2.2.cmml">W</mi><msubsup id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.3.2" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.3.2.cmml">𝐅</mi><mi id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.4" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.4.cmml">t</mi><mrow id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1.3" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1.2.cmml"><mo id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1.1" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1.2.1.cmml">]</mo></mrow></msubsup></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.1.m1.1b"><apply id="S3.SS2.SSS0.Px1.p2.1.m1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.1.m1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.1.m1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.2.2">𝑊</ci><apply id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.3.2">𝐅</ci><apply id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1.1">𝑙</ci></apply></apply><ci id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.4.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.1.m1.1c">W^{\mathbf{F}^{[l]}_{t}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.1.m1.1d">italic_W start_POSTSUPERSCRIPT bold_F start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> is a learnable parameter matrix. For exposition, let the dimensions of projections be <math alttext="\mathbb{R}^{n^{l}_{h}\times n^{l}_{w}\times d^{l}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.2.m2.1"><semantics id="S3.SS2.SSS0.Px1.p2.2.m2.1a"><msup id="S3.SS2.SSS0.Px1.p2.2.m2.1.1" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.2" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.cmml"><msubsup id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.2" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.2.cmml"><mi id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.2.2.2" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.2.2.2.cmml">n</mi><mi id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.2.3" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.2.3.cmml">h</mi><mi id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.2.2.3" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.2.2.3.cmml">l</mi></msubsup><mo id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.1.cmml">×</mo><msubsup id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.cmml"><mi id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2.2" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2.2.cmml">n</mi><mi id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.3" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.3.cmml">w</mi><mi id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2.3" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2.3.cmml">l</mi></msubsup><mo id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.1.cmml">×</mo><msup id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.4" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.4.cmml"><mi id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.4.2" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.4.2.cmml">d</mi><mi id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.4.3" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.4.3.cmml">l</mi></msup></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.2.m2.1b"><apply id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.2">ℝ</ci><apply id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3"><times id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.1"></times><apply id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.2">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.2.2.2">𝑛</ci><ci id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.2.2.3">𝑙</ci></apply><ci id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.2.3.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.2.3">ℎ</ci></apply><apply id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2.2">𝑛</ci><ci id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2.3.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2.3">𝑙</ci></apply><ci id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.3">𝑤</ci></apply><apply id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.4.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.4"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.4.1.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.4">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.4.2.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.4.2">𝑑</ci><ci id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.4.3.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.4.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.2.m2.1c">\mathbb{R}^{n^{l}_{h}\times n^{l}_{w}\times d^{l}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.2.m2.1d">blackboard_R start_POSTSUPERSCRIPT italic_n start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT × italic_n start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT × italic_d start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, we subsequently rearrange the patches to <math alttext="\mathbb{R}^{(n_{h}n_{w})^{l}\times d^{l}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.3.m3.1"><semantics id="S3.SS2.SSS0.Px1.p2.3.m3.1a"><msup id="S3.SS2.SSS0.Px1.p2.3.m3.1.2" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.2.cmml"><mi id="S3.SS2.SSS0.Px1.p2.3.m3.1.2.2" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.2.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.cmml"><msup id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.cmml"><mrow id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.1" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.cmml"><msub id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.2" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.2.cmml"><mi id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.2.2" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.2.2.cmml">n</mi><mi id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.2.3" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.2.3.cmml">h</mi></msub><mo id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.1" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.3" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.3.2" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.3.2.cmml">n</mi><mi id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.3.3" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.3.3.cmml">w</mi></msub></mrow><mo id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.3" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.3.cmml">l</mi></msup><mo id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.2.cmml">×</mo><msup id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.3" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.3.cmml"><mi id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.3.2" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.3.2.cmml">d</mi><mi id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.3.3" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.3.3.cmml">l</mi></msup></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.3.m3.1b"><apply id="S3.SS2.SSS0.Px1.p2.3.m3.1.2.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.3.m3.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.3.m3.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.2.2">ℝ</ci><apply id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1"><times id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.2"></times><apply id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1">superscript</csymbol><apply id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.1"><times id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.1"></times><apply id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.2.2">𝑛</ci><ci id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.2.3">ℎ</ci></apply><apply id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.3.2">𝑛</ci><ci id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.3.3">𝑤</ci></apply></apply><ci id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.3">𝑙</ci></apply><apply id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.3.2">𝑑</ci><ci id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.3.3.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.3.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.3.m3.1c">\mathbb{R}^{(n_{h}n_{w})^{l}\times d^{l}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.3.m3.1d">blackboard_R start_POSTSUPERSCRIPT ( italic_n start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT × italic_d start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>. Here, <math alttext="n^{l}_{h}=\frac{h^{l}}{p_{1}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.4.m4.1"><semantics id="S3.SS2.SSS0.Px1.p2.4.m4.1a"><mrow id="S3.SS2.SSS0.Px1.p2.4.m4.1.1" xref="S3.SS2.SSS0.Px1.p2.4.m4.1.1.cmml"><msubsup id="S3.SS2.SSS0.Px1.p2.4.m4.1.1.2" xref="S3.SS2.SSS0.Px1.p2.4.m4.1.1.2.cmml"><mi id="S3.SS2.SSS0.Px1.p2.4.m4.1.1.2.2.2" xref="S3.SS2.SSS0.Px1.p2.4.m4.1.1.2.2.2.cmml">n</mi><mi id="S3.SS2.SSS0.Px1.p2.4.m4.1.1.2.3" xref="S3.SS2.SSS0.Px1.p2.4.m4.1.1.2.3.cmml">h</mi><mi id="S3.SS2.SSS0.Px1.p2.4.m4.1.1.2.2.3" xref="S3.SS2.SSS0.Px1.p2.4.m4.1.1.2.2.3.cmml">l</mi></msubsup><mo id="S3.SS2.SSS0.Px1.p2.4.m4.1.1.1" xref="S3.SS2.SSS0.Px1.p2.4.m4.1.1.1.cmml">=</mo><mfrac id="S3.SS2.SSS0.Px1.p2.4.m4.1.1.3" xref="S3.SS2.SSS0.Px1.p2.4.m4.1.1.3.cmml"><msup id="S3.SS2.SSS0.Px1.p2.4.m4.1.1.3.2" xref="S3.SS2.SSS0.Px1.p2.4.m4.1.1.3.2.cmml"><mi id="S3.SS2.SSS0.Px1.p2.4.m4.1.1.3.2.2" xref="S3.SS2.SSS0.Px1.p2.4.m4.1.1.3.2.2.cmml">h</mi><mi id="S3.SS2.SSS0.Px1.p2.4.m4.1.1.3.2.3" xref="S3.SS2.SSS0.Px1.p2.4.m4.1.1.3.2.3.cmml">l</mi></msup><msub id="S3.SS2.SSS0.Px1.p2.4.m4.1.1.3.3" xref="S3.SS2.SSS0.Px1.p2.4.m4.1.1.3.3.cmml"><mi id="S3.SS2.SSS0.Px1.p2.4.m4.1.1.3.3.2" xref="S3.SS2.SSS0.Px1.p2.4.m4.1.1.3.3.2.cmml">p</mi><mn id="S3.SS2.SSS0.Px1.p2.4.m4.1.1.3.3.3" xref="S3.SS2.SSS0.Px1.p2.4.m4.1.1.3.3.3.cmml">1</mn></msub></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.4.m4.1b"><apply id="S3.SS2.SSS0.Px1.p2.4.m4.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.4.m4.1.1"><eq id="S3.SS2.SSS0.Px1.p2.4.m4.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.4.m4.1.1.1"></eq><apply id="S3.SS2.SSS0.Px1.p2.4.m4.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p2.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.4.m4.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.4.m4.1.1.2">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p2.4.m4.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.4.m4.1.1.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.4.m4.1.1.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.4.m4.1.1.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.4.m4.1.1.2.2.2">𝑛</ci><ci id="S3.SS2.SSS0.Px1.p2.4.m4.1.1.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p2.4.m4.1.1.2.2.3">𝑙</ci></apply><ci id="S3.SS2.SSS0.Px1.p2.4.m4.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px1.p2.4.m4.1.1.2.3">ℎ</ci></apply><apply id="S3.SS2.SSS0.Px1.p2.4.m4.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p2.4.m4.1.1.3"><divide id="S3.SS2.SSS0.Px1.p2.4.m4.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px1.p2.4.m4.1.1.3"></divide><apply id="S3.SS2.SSS0.Px1.p2.4.m4.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px1.p2.4.m4.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.4.m4.1.1.3.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.4.m4.1.1.3.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.4.m4.1.1.3.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.4.m4.1.1.3.2.2">ℎ</ci><ci id="S3.SS2.SSS0.Px1.p2.4.m4.1.1.3.2.3.cmml" xref="S3.SS2.SSS0.Px1.p2.4.m4.1.1.3.2.3">𝑙</ci></apply><apply id="S3.SS2.SSS0.Px1.p2.4.m4.1.1.3.3.cmml" xref="S3.SS2.SSS0.Px1.p2.4.m4.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.4.m4.1.1.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p2.4.m4.1.1.3.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.4.m4.1.1.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p2.4.m4.1.1.3.3.2">𝑝</ci><cn id="S3.SS2.SSS0.Px1.p2.4.m4.1.1.3.3.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p2.4.m4.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.4.m4.1c">n^{l}_{h}=\frac{h^{l}}{p_{1}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.4.m4.1d">italic_n start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT = divide start_ARG italic_h start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT end_ARG start_ARG italic_p start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_ARG</annotation></semantics></math>, and <math alttext="n^{l}_{w}=\frac{w^{l}}{p_{2}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.5.m5.1"><semantics id="S3.SS2.SSS0.Px1.p2.5.m5.1a"><mrow id="S3.SS2.SSS0.Px1.p2.5.m5.1.1" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1.cmml"><msubsup id="S3.SS2.SSS0.Px1.p2.5.m5.1.1.2" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1.2.cmml"><mi id="S3.SS2.SSS0.Px1.p2.5.m5.1.1.2.2.2" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1.2.2.2.cmml">n</mi><mi id="S3.SS2.SSS0.Px1.p2.5.m5.1.1.2.3" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1.2.3.cmml">w</mi><mi id="S3.SS2.SSS0.Px1.p2.5.m5.1.1.2.2.3" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1.2.2.3.cmml">l</mi></msubsup><mo id="S3.SS2.SSS0.Px1.p2.5.m5.1.1.1" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1.1.cmml">=</mo><mfrac id="S3.SS2.SSS0.Px1.p2.5.m5.1.1.3" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1.3.cmml"><msup id="S3.SS2.SSS0.Px1.p2.5.m5.1.1.3.2" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1.3.2.cmml"><mi id="S3.SS2.SSS0.Px1.p2.5.m5.1.1.3.2.2" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1.3.2.2.cmml">w</mi><mi id="S3.SS2.SSS0.Px1.p2.5.m5.1.1.3.2.3" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1.3.2.3.cmml">l</mi></msup><msub id="S3.SS2.SSS0.Px1.p2.5.m5.1.1.3.3" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1.3.3.cmml"><mi id="S3.SS2.SSS0.Px1.p2.5.m5.1.1.3.3.2" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1.3.3.2.cmml">p</mi><mn id="S3.SS2.SSS0.Px1.p2.5.m5.1.1.3.3.3" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1.3.3.3.cmml">2</mn></msub></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.5.m5.1b"><apply id="S3.SS2.SSS0.Px1.p2.5.m5.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1"><eq id="S3.SS2.SSS0.Px1.p2.5.m5.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1.1"></eq><apply id="S3.SS2.SSS0.Px1.p2.5.m5.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.5.m5.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1.2">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p2.5.m5.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.5.m5.1.1.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.5.m5.1.1.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1.2.2.2">𝑛</ci><ci id="S3.SS2.SSS0.Px1.p2.5.m5.1.1.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1.2.2.3">𝑙</ci></apply><ci id="S3.SS2.SSS0.Px1.p2.5.m5.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1.2.3">𝑤</ci></apply><apply id="S3.SS2.SSS0.Px1.p2.5.m5.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1.3"><divide id="S3.SS2.SSS0.Px1.p2.5.m5.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1.3"></divide><apply id="S3.SS2.SSS0.Px1.p2.5.m5.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.5.m5.1.1.3.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1.3.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.5.m5.1.1.3.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1.3.2.2">𝑤</ci><ci id="S3.SS2.SSS0.Px1.p2.5.m5.1.1.3.2.3.cmml" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1.3.2.3">𝑙</ci></apply><apply id="S3.SS2.SSS0.Px1.p2.5.m5.1.1.3.3.cmml" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.5.m5.1.1.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1.3.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.5.m5.1.1.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1.3.3.2">𝑝</ci><cn id="S3.SS2.SSS0.Px1.p2.5.m5.1.1.3.3.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.5.m5.1c">n^{l}_{w}=\frac{w^{l}}{p_{2}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.5.m5.1d">italic_n start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT = divide start_ARG italic_w start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT end_ARG start_ARG italic_p start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG</annotation></semantics></math> denote the number of patches along the height and width dimension, and <math alttext="d^{l}=(cp_{1}p_{2})^{l}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.6.m6.1"><semantics id="S3.SS2.SSS0.Px1.p2.6.m6.1a"><mrow id="S3.SS2.SSS0.Px1.p2.6.m6.1.1" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.cmml"><msup id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.cmml"><mi id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.2" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.2.cmml">d</mi><mi id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.3" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.3.cmml">l</mi></msup><mo id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.2" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.2.cmml">=</mo><msup id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.cmml"><mrow id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.1" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.1.2" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.1.2.cmml">c</mi><mo id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.1.1" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.1.3" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.1.3.2" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.1.3.2.cmml">p</mi><mn id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.1.3.3" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.1.3.3.cmml">1</mn></msub><mo id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.1.1a" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.1.4" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.1.4.cmml"><mi id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.1.4.2" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.1.4.2.cmml">p</mi><mn id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.1.4.3" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.1.4.3.cmml">2</mn></msub></mrow><mo id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.3" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.3.cmml">l</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.6.m6.1b"><apply id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1"><eq id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.2"></eq><apply id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.2">𝑑</ci><ci id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.3.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.3">𝑙</ci></apply><apply id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1">superscript</csymbol><apply id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1"><times id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.1.1"></times><ci id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.1.2">𝑐</ci><apply id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.1.3.2">𝑝</ci><cn id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.1.3.3">1</cn></apply><apply id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.1.4.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.1.4.1.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.1.4.2.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.1.4.2">𝑝</ci><cn id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.1.4.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.1.4.3">2</cn></apply></apply><ci id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.6.m6.1c">d^{l}=(cp_{1}p_{2})^{l}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.6.m6.1d">italic_d start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT = ( italic_c italic_p start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT</annotation></semantics></math> represents the dimension of each patch. Formally, we define the history states <math alttext="\mathbf{H}^{[l]}_{t}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.7.m7.1"><semantics id="S3.SS2.SSS0.Px1.p2.7.m7.1a"><msubsup id="S3.SS2.SSS0.Px1.p2.7.m7.1.2" xref="S3.SS2.SSS0.Px1.p2.7.m7.1.2.cmml"><mi id="S3.SS2.SSS0.Px1.p2.7.m7.1.2.2.2" xref="S3.SS2.SSS0.Px1.p2.7.m7.1.2.2.2.cmml">𝐇</mi><mi id="S3.SS2.SSS0.Px1.p2.7.m7.1.2.3" xref="S3.SS2.SSS0.Px1.p2.7.m7.1.2.3.cmml">t</mi><mrow id="S3.SS2.SSS0.Px1.p2.7.m7.1.1.1.3" xref="S3.SS2.SSS0.Px1.p2.7.m7.1.1.1.2.cmml"><mo id="S3.SS2.SSS0.Px1.p2.7.m7.1.1.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p2.7.m7.1.1.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px1.p2.7.m7.1.1.1.1" xref="S3.SS2.SSS0.Px1.p2.7.m7.1.1.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px1.p2.7.m7.1.1.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p2.7.m7.1.1.1.2.1.cmml">]</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.7.m7.1b"><apply id="S3.SS2.SSS0.Px1.p2.7.m7.1.2.cmml" xref="S3.SS2.SSS0.Px1.p2.7.m7.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.7.m7.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.7.m7.1.2">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p2.7.m7.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.7.m7.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.7.m7.1.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.7.m7.1.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.7.m7.1.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.7.m7.1.2.2.2">𝐇</ci><apply id="S3.SS2.SSS0.Px1.p2.7.m7.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p2.7.m7.1.1.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px1.p2.7.m7.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.7.m7.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px1.p2.7.m7.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.7.m7.1.1.1.1">𝑙</ci></apply></apply><ci id="S3.SS2.SSS0.Px1.p2.7.m7.1.2.3.cmml" xref="S3.SS2.SSS0.Px1.p2.7.m7.1.2.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.7.m7.1c">\mathbf{H}^{[l]}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.7.m7.1d">bold_H start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> as a set of keys and values to facilitate the attention mechanism as,</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A7.EGx2">
<tbody id="S3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{H}^{[l]}_{t}" class="ltx_Math" display="inline" id="S3.E3.m1.1"><semantics id="S3.E3.m1.1a"><msubsup id="S3.E3.m1.1.2" xref="S3.E3.m1.1.2.cmml"><mi id="S3.E3.m1.1.2.2.2" xref="S3.E3.m1.1.2.2.2.cmml">𝐇</mi><mi id="S3.E3.m1.1.2.3" xref="S3.E3.m1.1.2.3.cmml">t</mi><mrow id="S3.E3.m1.1.1.1.3" xref="S3.E3.m1.1.1.1.2.cmml"><mo id="S3.E3.m1.1.1.1.3.1" stretchy="false" xref="S3.E3.m1.1.1.1.2.1.cmml">[</mo><mi id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml">l</mi><mo id="S3.E3.m1.1.1.1.3.2" stretchy="false" xref="S3.E3.m1.1.1.1.2.1.cmml">]</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.E3.m1.1b"><apply id="S3.E3.m1.1.2.cmml" xref="S3.E3.m1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.2.1.cmml" xref="S3.E3.m1.1.2">subscript</csymbol><apply id="S3.E3.m1.1.2.2.cmml" xref="S3.E3.m1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.2.2.1.cmml" xref="S3.E3.m1.1.2">superscript</csymbol><ci id="S3.E3.m1.1.2.2.2.cmml" xref="S3.E3.m1.1.2.2.2">𝐇</ci><apply id="S3.E3.m1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.3"><csymbol cd="latexml" id="S3.E3.m1.1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1">𝑙</ci></apply></apply><ci id="S3.E3.m1.1.2.3.cmml" xref="S3.E3.m1.1.2.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.1c">\displaystyle\mathbf{H}^{[l]}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.1d">bold_H start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\{\mathbf{K}^{[l]}_{\mathbf{H}_{t}},\mathbf{V}^{[l]}_{\mathbf{H}%
_{t}}\}," class="ltx_Math" display="inline" id="S3.E3.m2.3"><semantics id="S3.E3.m2.3a"><mrow id="S3.E3.m2.3.3.1" xref="S3.E3.m2.3.3.1.1.cmml"><mrow id="S3.E3.m2.3.3.1.1" xref="S3.E3.m2.3.3.1.1.cmml"><mi id="S3.E3.m2.3.3.1.1.4" xref="S3.E3.m2.3.3.1.1.4.cmml"></mi><mo id="S3.E3.m2.3.3.1.1.3" xref="S3.E3.m2.3.3.1.1.3.cmml">=</mo><mrow id="S3.E3.m2.3.3.1.1.2.2" xref="S3.E3.m2.3.3.1.1.2.3.cmml"><mo id="S3.E3.m2.3.3.1.1.2.2.3" stretchy="false" xref="S3.E3.m2.3.3.1.1.2.3.cmml">{</mo><msubsup id="S3.E3.m2.3.3.1.1.1.1.1" xref="S3.E3.m2.3.3.1.1.1.1.1.cmml"><mi id="S3.E3.m2.3.3.1.1.1.1.1.2.2" xref="S3.E3.m2.3.3.1.1.1.1.1.2.2.cmml">𝐊</mi><msub id="S3.E3.m2.3.3.1.1.1.1.1.3" xref="S3.E3.m2.3.3.1.1.1.1.1.3.cmml"><mi id="S3.E3.m2.3.3.1.1.1.1.1.3.2" xref="S3.E3.m2.3.3.1.1.1.1.1.3.2.cmml">𝐇</mi><mi id="S3.E3.m2.3.3.1.1.1.1.1.3.3" xref="S3.E3.m2.3.3.1.1.1.1.1.3.3.cmml">t</mi></msub><mrow id="S3.E3.m2.1.1.1.3" xref="S3.E3.m2.1.1.1.2.cmml"><mo id="S3.E3.m2.1.1.1.3.1" stretchy="false" xref="S3.E3.m2.1.1.1.2.1.cmml">[</mo><mi id="S3.E3.m2.1.1.1.1" xref="S3.E3.m2.1.1.1.1.cmml">l</mi><mo id="S3.E3.m2.1.1.1.3.2" stretchy="false" xref="S3.E3.m2.1.1.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.E3.m2.3.3.1.1.2.2.4" xref="S3.E3.m2.3.3.1.1.2.3.cmml">,</mo><msubsup id="S3.E3.m2.3.3.1.1.2.2.2" xref="S3.E3.m2.3.3.1.1.2.2.2.cmml"><mi id="S3.E3.m2.3.3.1.1.2.2.2.2.2" xref="S3.E3.m2.3.3.1.1.2.2.2.2.2.cmml">𝐕</mi><msub id="S3.E3.m2.3.3.1.1.2.2.2.3" xref="S3.E3.m2.3.3.1.1.2.2.2.3.cmml"><mi id="S3.E3.m2.3.3.1.1.2.2.2.3.2" xref="S3.E3.m2.3.3.1.1.2.2.2.3.2.cmml">𝐇</mi><mi id="S3.E3.m2.3.3.1.1.2.2.2.3.3" xref="S3.E3.m2.3.3.1.1.2.2.2.3.3.cmml">t</mi></msub><mrow id="S3.E3.m2.2.2.1.3" xref="S3.E3.m2.2.2.1.2.cmml"><mo id="S3.E3.m2.2.2.1.3.1" stretchy="false" xref="S3.E3.m2.2.2.1.2.1.cmml">[</mo><mi id="S3.E3.m2.2.2.1.1" xref="S3.E3.m2.2.2.1.1.cmml">l</mi><mo id="S3.E3.m2.2.2.1.3.2" stretchy="false" xref="S3.E3.m2.2.2.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.E3.m2.3.3.1.1.2.2.5" stretchy="false" xref="S3.E3.m2.3.3.1.1.2.3.cmml">}</mo></mrow></mrow><mo id="S3.E3.m2.3.3.1.2" xref="S3.E3.m2.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m2.3b"><apply id="S3.E3.m2.3.3.1.1.cmml" xref="S3.E3.m2.3.3.1"><eq id="S3.E3.m2.3.3.1.1.3.cmml" xref="S3.E3.m2.3.3.1.1.3"></eq><csymbol cd="latexml" id="S3.E3.m2.3.3.1.1.4.cmml" xref="S3.E3.m2.3.3.1.1.4">absent</csymbol><set id="S3.E3.m2.3.3.1.1.2.3.cmml" xref="S3.E3.m2.3.3.1.1.2.2"><apply id="S3.E3.m2.3.3.1.1.1.1.1.cmml" xref="S3.E3.m2.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m2.3.3.1.1.1.1.1.1.cmml" xref="S3.E3.m2.3.3.1.1.1.1.1">subscript</csymbol><apply id="S3.E3.m2.3.3.1.1.1.1.1.2.cmml" xref="S3.E3.m2.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m2.3.3.1.1.1.1.1.2.1.cmml" xref="S3.E3.m2.3.3.1.1.1.1.1">superscript</csymbol><ci id="S3.E3.m2.3.3.1.1.1.1.1.2.2.cmml" xref="S3.E3.m2.3.3.1.1.1.1.1.2.2">𝐊</ci><apply id="S3.E3.m2.1.1.1.2.cmml" xref="S3.E3.m2.1.1.1.3"><csymbol cd="latexml" id="S3.E3.m2.1.1.1.2.1.cmml" xref="S3.E3.m2.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.E3.m2.1.1.1.1.cmml" xref="S3.E3.m2.1.1.1.1">𝑙</ci></apply></apply><apply id="S3.E3.m2.3.3.1.1.1.1.1.3.cmml" xref="S3.E3.m2.3.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m2.3.3.1.1.1.1.1.3.1.cmml" xref="S3.E3.m2.3.3.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m2.3.3.1.1.1.1.1.3.2.cmml" xref="S3.E3.m2.3.3.1.1.1.1.1.3.2">𝐇</ci><ci id="S3.E3.m2.3.3.1.1.1.1.1.3.3.cmml" xref="S3.E3.m2.3.3.1.1.1.1.1.3.3">𝑡</ci></apply></apply><apply id="S3.E3.m2.3.3.1.1.2.2.2.cmml" xref="S3.E3.m2.3.3.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m2.3.3.1.1.2.2.2.1.cmml" xref="S3.E3.m2.3.3.1.1.2.2.2">subscript</csymbol><apply id="S3.E3.m2.3.3.1.1.2.2.2.2.cmml" xref="S3.E3.m2.3.3.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m2.3.3.1.1.2.2.2.2.1.cmml" xref="S3.E3.m2.3.3.1.1.2.2.2">superscript</csymbol><ci id="S3.E3.m2.3.3.1.1.2.2.2.2.2.cmml" xref="S3.E3.m2.3.3.1.1.2.2.2.2.2">𝐕</ci><apply id="S3.E3.m2.2.2.1.2.cmml" xref="S3.E3.m2.2.2.1.3"><csymbol cd="latexml" id="S3.E3.m2.2.2.1.2.1.cmml" xref="S3.E3.m2.2.2.1.3.1">delimited-[]</csymbol><ci id="S3.E3.m2.2.2.1.1.cmml" xref="S3.E3.m2.2.2.1.1">𝑙</ci></apply></apply><apply id="S3.E3.m2.3.3.1.1.2.2.2.3.cmml" xref="S3.E3.m2.3.3.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m2.3.3.1.1.2.2.2.3.1.cmml" xref="S3.E3.m2.3.3.1.1.2.2.2.3">subscript</csymbol><ci id="S3.E3.m2.3.3.1.1.2.2.2.3.2.cmml" xref="S3.E3.m2.3.3.1.1.2.2.2.3.2">𝐇</ci><ci id="S3.E3.m2.3.3.1.1.2.2.2.3.3.cmml" xref="S3.E3.m2.3.3.1.1.2.2.2.3.3">𝑡</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m2.3c">\displaystyle=\{\mathbf{K}^{[l]}_{\mathbf{H}_{t}},\mathbf{V}^{[l]}_{\mathbf{H}%
_{t}}\},</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m2.3d">= { bold_K start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT bold_H start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT , bold_V start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT bold_H start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT } ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.SSS0.Px1.p3">
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p3.4">where <math alttext="\mathbf{K}^{[l]}_{\mathbf{H}_{t}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p3.1.m1.1"><semantics id="S3.SS2.SSS0.Px1.p3.1.m1.1a"><msubsup id="S3.SS2.SSS0.Px1.p3.1.m1.1.2" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.2.cmml"><mi id="S3.SS2.SSS0.Px1.p3.1.m1.1.2.2.2" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.2.2.2.cmml">𝐊</mi><msub id="S3.SS2.SSS0.Px1.p3.1.m1.1.2.3" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.2.3.cmml"><mi id="S3.SS2.SSS0.Px1.p3.1.m1.1.2.3.2" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.2.3.2.cmml">𝐇</mi><mi id="S3.SS2.SSS0.Px1.p3.1.m1.1.2.3.3" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.2.3.3.cmml">t</mi></msub><mrow id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.1.3" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.1.2.cmml"><mo id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.1.1" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.1.2.1.cmml">]</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p3.1.m1.1b"><apply id="S3.SS2.SSS0.Px1.p3.1.m1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.1.m1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.2">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p3.1.m1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.1.m1.1.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.1.m1.1.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.2.2.2">𝐊</ci><apply id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.1.1">𝑙</ci></apply></apply><apply id="S3.SS2.SSS0.Px1.p3.1.m1.1.2.3.cmml" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.1.m1.1.2.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.2.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.1.m1.1.2.3.2.cmml" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.2.3.2">𝐇</ci><ci id="S3.SS2.SSS0.Px1.p3.1.m1.1.2.3.3.cmml" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.2.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p3.1.m1.1c">\mathbf{K}^{[l]}_{\mathbf{H}_{t}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p3.1.m1.1d">bold_K start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT bold_H start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\mathbf{V}^{[l]}_{\mathbf{H}_{t}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p3.2.m2.1"><semantics id="S3.SS2.SSS0.Px1.p3.2.m2.1a"><msubsup id="S3.SS2.SSS0.Px1.p3.2.m2.1.2" xref="S3.SS2.SSS0.Px1.p3.2.m2.1.2.cmml"><mi id="S3.SS2.SSS0.Px1.p3.2.m2.1.2.2.2" xref="S3.SS2.SSS0.Px1.p3.2.m2.1.2.2.2.cmml">𝐕</mi><msub id="S3.SS2.SSS0.Px1.p3.2.m2.1.2.3" xref="S3.SS2.SSS0.Px1.p3.2.m2.1.2.3.cmml"><mi id="S3.SS2.SSS0.Px1.p3.2.m2.1.2.3.2" xref="S3.SS2.SSS0.Px1.p3.2.m2.1.2.3.2.cmml">𝐇</mi><mi id="S3.SS2.SSS0.Px1.p3.2.m2.1.2.3.3" xref="S3.SS2.SSS0.Px1.p3.2.m2.1.2.3.3.cmml">t</mi></msub><mrow id="S3.SS2.SSS0.Px1.p3.2.m2.1.1.1.3" xref="S3.SS2.SSS0.Px1.p3.2.m2.1.1.1.2.cmml"><mo id="S3.SS2.SSS0.Px1.p3.2.m2.1.1.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p3.2.m2.1.1.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px1.p3.2.m2.1.1.1.1" xref="S3.SS2.SSS0.Px1.p3.2.m2.1.1.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px1.p3.2.m2.1.1.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p3.2.m2.1.1.1.2.1.cmml">]</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p3.2.m2.1b"><apply id="S3.SS2.SSS0.Px1.p3.2.m2.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.2.m2.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.2.m2.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.2.m2.1.2">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p3.2.m2.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.2.m2.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.2.m2.1.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.2.m2.1.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.2.m2.1.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.2.m2.1.2.2.2">𝐕</ci><apply id="S3.SS2.SSS0.Px1.p3.2.m2.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.2.m2.1.1.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px1.p3.2.m2.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.2.m2.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px1.p3.2.m2.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.2.m2.1.1.1.1">𝑙</ci></apply></apply><apply id="S3.SS2.SSS0.Px1.p3.2.m2.1.2.3.cmml" xref="S3.SS2.SSS0.Px1.p3.2.m2.1.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.2.m2.1.2.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.2.m2.1.2.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.2.m2.1.2.3.2.cmml" xref="S3.SS2.SSS0.Px1.p3.2.m2.1.2.3.2">𝐇</ci><ci id="S3.SS2.SSS0.Px1.p3.2.m2.1.2.3.3.cmml" xref="S3.SS2.SSS0.Px1.p3.2.m2.1.2.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p3.2.m2.1c">\mathbf{V}^{[l]}_{\mathbf{H}_{t}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p3.2.m2.1d">bold_V start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT bold_H start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> are formally written as <math alttext="\mathbf{K}^{[l]}_{\mathbf{H}_{t}}=\{\mathbf{K}^{[l]}_{\mathbf{F}_{t-\tau}},%
\mathbf{K}^{[l]}_{\mathbf{F}_{t-\tau+1}},\ldots,\mathbf{K}^{[l]}_{\mathbf{F}_{%
t-1}}\}\in\mathbb{R}^{\tau\times n_{h}n_{w}\times d}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p3.3.m3.8"><semantics id="S3.SS2.SSS0.Px1.p3.3.m3.8a"><mrow id="S3.SS2.SSS0.Px1.p3.3.m3.8.8" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.cmml"><msubsup id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.5" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.5.cmml"><mi id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.5.2.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.5.2.2.cmml">𝐊</mi><msub id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.5.3" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.5.3.cmml"><mi id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.5.3.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.5.3.2.cmml">𝐇</mi><mi id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.5.3.3" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.5.3.3.cmml">t</mi></msub><mrow id="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.3" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.2.cmml"><mo id="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.1" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.6" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.6.cmml">=</mo><mrow id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.3" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.4.cmml"><mo id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.3.4" stretchy="false" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.4.cmml">{</mo><msubsup id="S3.SS2.SSS0.Px1.p3.3.m3.6.6.1.1.1" xref="S3.SS2.SSS0.Px1.p3.3.m3.6.6.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p3.3.m3.6.6.1.1.1.2.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.6.6.1.1.1.2.2.cmml">𝐊</mi><msub id="S3.SS2.SSS0.Px1.p3.3.m3.6.6.1.1.1.3" xref="S3.SS2.SSS0.Px1.p3.3.m3.6.6.1.1.1.3.cmml"><mi id="S3.SS2.SSS0.Px1.p3.3.m3.6.6.1.1.1.3.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.6.6.1.1.1.3.2.cmml">𝐅</mi><mrow id="S3.SS2.SSS0.Px1.p3.3.m3.6.6.1.1.1.3.3" xref="S3.SS2.SSS0.Px1.p3.3.m3.6.6.1.1.1.3.3.cmml"><mi id="S3.SS2.SSS0.Px1.p3.3.m3.6.6.1.1.1.3.3.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.6.6.1.1.1.3.3.2.cmml">t</mi><mo id="S3.SS2.SSS0.Px1.p3.3.m3.6.6.1.1.1.3.3.1" xref="S3.SS2.SSS0.Px1.p3.3.m3.6.6.1.1.1.3.3.1.cmml">−</mo><mi id="S3.SS2.SSS0.Px1.p3.3.m3.6.6.1.1.1.3.3.3" xref="S3.SS2.SSS0.Px1.p3.3.m3.6.6.1.1.1.3.3.3.cmml">τ</mi></mrow></msub><mrow id="S3.SS2.SSS0.Px1.p3.3.m3.2.2.1.3" xref="S3.SS2.SSS0.Px1.p3.3.m3.2.2.1.2.cmml"><mo id="S3.SS2.SSS0.Px1.p3.3.m3.2.2.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p3.3.m3.2.2.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px1.p3.3.m3.2.2.1.1" xref="S3.SS2.SSS0.Px1.p3.3.m3.2.2.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px1.p3.3.m3.2.2.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p3.3.m3.2.2.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.3.5" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.4.cmml">,</mo><msubsup id="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2.2.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2.2.2.cmml">𝐊</mi><msub id="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2.3" xref="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2.3.cmml"><mi id="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2.3.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2.3.2.cmml">𝐅</mi><mrow id="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2.3.3" xref="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2.3.3.cmml"><mrow id="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2.3.3.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2.3.3.2.cmml"><mi id="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2.3.3.2.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2.3.3.2.2.cmml">t</mi><mo id="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2.3.3.2.1" xref="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2.3.3.2.1.cmml">−</mo><mi id="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2.3.3.2.3" xref="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2.3.3.2.3.cmml">τ</mi></mrow><mo id="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2.3.3.1" xref="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2.3.3.1.cmml">+</mo><mn id="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2.3.3.3" xref="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2.3.3.3.cmml">1</mn></mrow></msub><mrow id="S3.SS2.SSS0.Px1.p3.3.m3.3.3.1.3" xref="S3.SS2.SSS0.Px1.p3.3.m3.3.3.1.2.cmml"><mo id="S3.SS2.SSS0.Px1.p3.3.m3.3.3.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p3.3.m3.3.3.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px1.p3.3.m3.3.3.1.1" xref="S3.SS2.SSS0.Px1.p3.3.m3.3.3.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px1.p3.3.m3.3.3.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p3.3.m3.3.3.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.3.6" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.4.cmml">,</mo><mi id="S3.SS2.SSS0.Px1.p3.3.m3.5.5" mathvariant="normal" xref="S3.SS2.SSS0.Px1.p3.3.m3.5.5.cmml">…</mi><mo id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.3.7" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.4.cmml">,</mo><msubsup id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.3.3" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.3.3.cmml"><mi id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.3.3.2.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.3.3.2.2.cmml">𝐊</mi><msub id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.3.3.3" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.3.3.3.cmml"><mi id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.3.3.3.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.3.3.3.2.cmml">𝐅</mi><mrow id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.3.3.3.3" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.3.3.3.3.cmml"><mi id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.3.3.3.3.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.3.3.3.3.2.cmml">t</mi><mo id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.3.3.3.3.1" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.3.3.3.3.1.cmml">−</mo><mn id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.3.3.3.3.3" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.3.3.3.3.3.cmml">1</mn></mrow></msub><mrow id="S3.SS2.SSS0.Px1.p3.3.m3.4.4.1.3" xref="S3.SS2.SSS0.Px1.p3.3.m3.4.4.1.2.cmml"><mo id="S3.SS2.SSS0.Px1.p3.3.m3.4.4.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p3.3.m3.4.4.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px1.p3.3.m3.4.4.1.1" xref="S3.SS2.SSS0.Px1.p3.3.m3.4.4.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px1.p3.3.m3.4.4.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p3.3.m3.4.4.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.3.8" stretchy="false" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.4.cmml">}</mo></mrow><mo id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.7" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.7.cmml">∈</mo><msup id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.cmml"><mi id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.cmml"><mrow id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.2.cmml"><mrow id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.2.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.2.2.cmml"><mi id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.2.2.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.2.2.2.cmml">τ</mi><mo id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.2.2.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.2.2.1.cmml">×</mo><msub id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.2.2.3" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.2.2.3.cmml"><mi id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.2.2.3.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.2.2.3.2.cmml">n</mi><mi id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.2.2.3.3" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.2.2.3.3.cmml">h</mi></msub></mrow><mo id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.2.1" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.2.1.cmml">⁢</mo><msub id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.2.3" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.2.3.cmml"><mi id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.2.3.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.2.3.2.cmml">n</mi><mi id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.2.3.3" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.2.3.3.cmml">w</mi></msub></mrow><mo id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.1.cmml">×</mo><mi id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.3" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p3.3.m3.8b"><apply id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8"><and id="S3.SS2.SSS0.Px1.p3.3.m3.8.8a.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8"></and><apply id="S3.SS2.SSS0.Px1.p3.3.m3.8.8b.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8"><eq id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.6.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.6"></eq><apply id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.5.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.5"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.5.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.5">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.5.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.5"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.5.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.5">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.5.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.5.2.2">𝐊</ci><apply id="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.1">𝑙</ci></apply></apply><apply id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.5.3.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.5.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.5.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.5.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.5.3.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.5.3.2">𝐇</ci><ci id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.5.3.3.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.5.3.3">𝑡</ci></apply></apply><set id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.4.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.3"><apply id="S3.SS2.SSS0.Px1.p3.3.m3.6.6.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.6.6.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.3.m3.6.6.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.6.6.1.1.1">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p3.3.m3.6.6.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.6.6.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.3.m3.6.6.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.6.6.1.1.1">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.3.m3.6.6.1.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.6.6.1.1.1.2.2">𝐊</ci><apply id="S3.SS2.SSS0.Px1.p3.3.m3.2.2.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.2.2.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px1.p3.3.m3.2.2.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.2.2.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px1.p3.3.m3.2.2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.2.2.1.1">𝑙</ci></apply></apply><apply id="S3.SS2.SSS0.Px1.p3.3.m3.6.6.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.6.6.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.3.m3.6.6.1.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.6.6.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.3.m3.6.6.1.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.6.6.1.1.1.3.2">𝐅</ci><apply id="S3.SS2.SSS0.Px1.p3.3.m3.6.6.1.1.1.3.3.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.6.6.1.1.1.3.3"><minus id="S3.SS2.SSS0.Px1.p3.3.m3.6.6.1.1.1.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.6.6.1.1.1.3.3.1"></minus><ci id="S3.SS2.SSS0.Px1.p3.3.m3.6.6.1.1.1.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.6.6.1.1.1.3.3.2">𝑡</ci><ci id="S3.SS2.SSS0.Px1.p3.3.m3.6.6.1.1.1.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.6.6.1.1.1.3.3.3">𝜏</ci></apply></apply></apply><apply id="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2.2.2">𝐊</ci><apply id="S3.SS2.SSS0.Px1.p3.3.m3.3.3.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.3.3.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px1.p3.3.m3.3.3.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.3.3.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px1.p3.3.m3.3.3.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.3.3.1.1">𝑙</ci></apply></apply><apply id="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2.3.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2.3.2">𝐅</ci><apply id="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2.3.3.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2.3.3"><plus id="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2.3.3.1"></plus><apply id="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2.3.3.2"><minus id="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2.3.3.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2.3.3.2.1"></minus><ci id="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2.3.3.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2.3.3.2.2">𝑡</ci><ci id="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2.3.3.2.3.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2.3.3.2.3">𝜏</ci></apply><cn id="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2.3.3.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p3.3.m3.7.7.2.2.2.3.3.3">1</cn></apply></apply></apply><ci id="S3.SS2.SSS0.Px1.p3.3.m3.5.5.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.5.5">…</ci><apply id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.3.3">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.3.3.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.3.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.3.3.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.3.3.2.2">𝐊</ci><apply id="S3.SS2.SSS0.Px1.p3.3.m3.4.4.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.4.4.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px1.p3.3.m3.4.4.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.4.4.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px1.p3.3.m3.4.4.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.4.4.1.1">𝑙</ci></apply></apply><apply id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.3.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.3.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.3.3.3.2">𝐅</ci><apply id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.3.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.3.3.3.3"><minus id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.3.3.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.3.3.3.3.1"></minus><ci id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.3.3.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.3.3.3.3.2">𝑡</ci><cn id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.3.3.3.3.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.3.3.3.3.3">1</cn></apply></apply></apply></set></apply><apply id="S3.SS2.SSS0.Px1.p3.3.m3.8.8c.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8"><in id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.7.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.7"></in><share href="https://arxiv.org/html/2410.03936v1#S3.SS2.SSS0.Px1.p3.3.m3.8.8.3.cmml" id="S3.SS2.SSS0.Px1.p3.3.m3.8.8d.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8"></share><apply id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.2">ℝ</ci><apply id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3"><times id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.1"></times><apply id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.2"><times id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.2.1"></times><apply id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.2.2"><times id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.2.2.1"></times><ci id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.2.2.2">𝜏</ci><apply id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.2.2.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.2.2.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.2.2.3.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.2.2.3.2">𝑛</ci><ci id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.2.2.3.3.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.2.2.3.3">ℎ</ci></apply></apply><apply id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.2.3.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.2.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.2.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.2.3.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.2.3.2">𝑛</ci><ci id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.2.3.3.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.2.3.3">𝑤</ci></apply></apply><ci id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.3.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.8.3.3">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p3.3.m3.8c">\mathbf{K}^{[l]}_{\mathbf{H}_{t}}=\{\mathbf{K}^{[l]}_{\mathbf{F}_{t-\tau}},%
\mathbf{K}^{[l]}_{\mathbf{F}_{t-\tau+1}},\ldots,\mathbf{K}^{[l]}_{\mathbf{F}_{%
t-1}}\}\in\mathbb{R}^{\tau\times n_{h}n_{w}\times d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p3.3.m3.8d">bold_K start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT bold_H start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT = { bold_K start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT bold_F start_POSTSUBSCRIPT italic_t - italic_τ end_POSTSUBSCRIPT end_POSTSUBSCRIPT , bold_K start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT bold_F start_POSTSUBSCRIPT italic_t - italic_τ + 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , … , bold_K start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT bold_F start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT } ∈ blackboard_R start_POSTSUPERSCRIPT italic_τ × italic_n start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, and <math alttext="\mathbf{V}^{[l]}_{\mathbf{H}_{t}}=\{\mathbf{V}^{[l]}_{\mathbf{F}_{t-\tau}},%
\mathbf{V}^{[l]}_{\mathbf{F}_{t-\tau+1}},\ldots,\mathbf{V}^{[l]}_{\mathbf{F}_{%
t-1}}\}\in\mathbb{R}^{\tau\times n_{h}n_{w}\times d}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p3.4.m4.8"><semantics id="S3.SS2.SSS0.Px1.p3.4.m4.8a"><mrow id="S3.SS2.SSS0.Px1.p3.4.m4.8.8" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.cmml"><msubsup id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.5" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.5.cmml"><mi id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.5.2.2" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.5.2.2.cmml">𝐕</mi><msub id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.5.3" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.5.3.cmml"><mi id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.5.3.2" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.5.3.2.cmml">𝐇</mi><mi id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.5.3.3" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.5.3.3.cmml">t</mi></msub><mrow id="S3.SS2.SSS0.Px1.p3.4.m4.1.1.1.3" xref="S3.SS2.SSS0.Px1.p3.4.m4.1.1.1.2.cmml"><mo id="S3.SS2.SSS0.Px1.p3.4.m4.1.1.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p3.4.m4.1.1.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px1.p3.4.m4.1.1.1.1" xref="S3.SS2.SSS0.Px1.p3.4.m4.1.1.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px1.p3.4.m4.1.1.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p3.4.m4.1.1.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.6" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.6.cmml">=</mo><mrow id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.3" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.4.cmml"><mo id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.3.4" stretchy="false" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.4.cmml">{</mo><msubsup id="S3.SS2.SSS0.Px1.p3.4.m4.6.6.1.1.1" xref="S3.SS2.SSS0.Px1.p3.4.m4.6.6.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p3.4.m4.6.6.1.1.1.2.2" xref="S3.SS2.SSS0.Px1.p3.4.m4.6.6.1.1.1.2.2.cmml">𝐕</mi><msub id="S3.SS2.SSS0.Px1.p3.4.m4.6.6.1.1.1.3" xref="S3.SS2.SSS0.Px1.p3.4.m4.6.6.1.1.1.3.cmml"><mi id="S3.SS2.SSS0.Px1.p3.4.m4.6.6.1.1.1.3.2" xref="S3.SS2.SSS0.Px1.p3.4.m4.6.6.1.1.1.3.2.cmml">𝐅</mi><mrow id="S3.SS2.SSS0.Px1.p3.4.m4.6.6.1.1.1.3.3" xref="S3.SS2.SSS0.Px1.p3.4.m4.6.6.1.1.1.3.3.cmml"><mi id="S3.SS2.SSS0.Px1.p3.4.m4.6.6.1.1.1.3.3.2" xref="S3.SS2.SSS0.Px1.p3.4.m4.6.6.1.1.1.3.3.2.cmml">t</mi><mo id="S3.SS2.SSS0.Px1.p3.4.m4.6.6.1.1.1.3.3.1" xref="S3.SS2.SSS0.Px1.p3.4.m4.6.6.1.1.1.3.3.1.cmml">−</mo><mi id="S3.SS2.SSS0.Px1.p3.4.m4.6.6.1.1.1.3.3.3" xref="S3.SS2.SSS0.Px1.p3.4.m4.6.6.1.1.1.3.3.3.cmml">τ</mi></mrow></msub><mrow id="S3.SS2.SSS0.Px1.p3.4.m4.2.2.1.3" xref="S3.SS2.SSS0.Px1.p3.4.m4.2.2.1.2.cmml"><mo id="S3.SS2.SSS0.Px1.p3.4.m4.2.2.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p3.4.m4.2.2.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px1.p3.4.m4.2.2.1.1" xref="S3.SS2.SSS0.Px1.p3.4.m4.2.2.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px1.p3.4.m4.2.2.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p3.4.m4.2.2.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.3.5" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.4.cmml">,</mo><msubsup id="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2" xref="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2.2.2" xref="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2.2.2.cmml">𝐕</mi><msub id="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2.3" xref="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2.3.cmml"><mi id="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2.3.2" xref="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2.3.2.cmml">𝐅</mi><mrow id="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2.3.3" xref="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2.3.3.cmml"><mrow id="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2.3.3.2" xref="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2.3.3.2.cmml"><mi id="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2.3.3.2.2" xref="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2.3.3.2.2.cmml">t</mi><mo id="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2.3.3.2.1" xref="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2.3.3.2.1.cmml">−</mo><mi id="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2.3.3.2.3" xref="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2.3.3.2.3.cmml">τ</mi></mrow><mo id="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2.3.3.1" xref="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2.3.3.1.cmml">+</mo><mn id="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2.3.3.3" xref="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2.3.3.3.cmml">1</mn></mrow></msub><mrow id="S3.SS2.SSS0.Px1.p3.4.m4.3.3.1.3" xref="S3.SS2.SSS0.Px1.p3.4.m4.3.3.1.2.cmml"><mo id="S3.SS2.SSS0.Px1.p3.4.m4.3.3.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p3.4.m4.3.3.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px1.p3.4.m4.3.3.1.1" xref="S3.SS2.SSS0.Px1.p3.4.m4.3.3.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px1.p3.4.m4.3.3.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p3.4.m4.3.3.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.3.6" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.4.cmml">,</mo><mi id="S3.SS2.SSS0.Px1.p3.4.m4.5.5" mathvariant="normal" xref="S3.SS2.SSS0.Px1.p3.4.m4.5.5.cmml">…</mi><mo id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.3.7" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.4.cmml">,</mo><msubsup id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.3.3" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.3.3.cmml"><mi id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.3.3.2.2" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.3.3.2.2.cmml">𝐕</mi><msub id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.3.3.3" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.3.3.3.cmml"><mi id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.3.3.3.2" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.3.3.3.2.cmml">𝐅</mi><mrow id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.3.3.3.3" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.3.3.3.3.cmml"><mi id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.3.3.3.3.2" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.3.3.3.3.2.cmml">t</mi><mo id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.3.3.3.3.1" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.3.3.3.3.1.cmml">−</mo><mn id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.3.3.3.3.3" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.3.3.3.3.3.cmml">1</mn></mrow></msub><mrow id="S3.SS2.SSS0.Px1.p3.4.m4.4.4.1.3" xref="S3.SS2.SSS0.Px1.p3.4.m4.4.4.1.2.cmml"><mo id="S3.SS2.SSS0.Px1.p3.4.m4.4.4.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p3.4.m4.4.4.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px1.p3.4.m4.4.4.1.1" xref="S3.SS2.SSS0.Px1.p3.4.m4.4.4.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px1.p3.4.m4.4.4.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p3.4.m4.4.4.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.3.8" stretchy="false" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.4.cmml">}</mo></mrow><mo id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.7" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.7.cmml">∈</mo><msup id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.cmml"><mi id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.2" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.cmml"><mrow id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.2" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.2.cmml"><mrow id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.2.2" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.2.2.cmml"><mi id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.2.2.2" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.2.2.2.cmml">τ</mi><mo id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.2.2.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.2.2.1.cmml">×</mo><msub id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.2.2.3" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.2.2.3.cmml"><mi id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.2.2.3.2" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.2.2.3.2.cmml">n</mi><mi id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.2.2.3.3" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.2.2.3.3.cmml">h</mi></msub></mrow><mo id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.2.1" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.2.1.cmml">⁢</mo><msub id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.2.3" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.2.3.cmml"><mi id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.2.3.2" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.2.3.2.cmml">n</mi><mi id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.2.3.3" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.2.3.3.cmml">w</mi></msub></mrow><mo id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.1.cmml">×</mo><mi id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.3" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p3.4.m4.8b"><apply id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8"><and id="S3.SS2.SSS0.Px1.p3.4.m4.8.8a.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8"></and><apply id="S3.SS2.SSS0.Px1.p3.4.m4.8.8b.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8"><eq id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.6.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.6"></eq><apply id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.5.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.5"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.5.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.5">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.5.2.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.5"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.5.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.5">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.5.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.5.2.2">𝐕</ci><apply id="S3.SS2.SSS0.Px1.p3.4.m4.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.1.1.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px1.p3.4.m4.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px1.p3.4.m4.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.1.1.1.1">𝑙</ci></apply></apply><apply id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.5.3.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.5.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.5.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.5.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.5.3.2.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.5.3.2">𝐇</ci><ci id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.5.3.3.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.5.3.3">𝑡</ci></apply></apply><set id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.4.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.3"><apply id="S3.SS2.SSS0.Px1.p3.4.m4.6.6.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.6.6.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.4.m4.6.6.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.6.6.1.1.1">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p3.4.m4.6.6.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.6.6.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.4.m4.6.6.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.6.6.1.1.1">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.4.m4.6.6.1.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.6.6.1.1.1.2.2">𝐕</ci><apply id="S3.SS2.SSS0.Px1.p3.4.m4.2.2.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.2.2.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px1.p3.4.m4.2.2.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.2.2.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px1.p3.4.m4.2.2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.2.2.1.1">𝑙</ci></apply></apply><apply id="S3.SS2.SSS0.Px1.p3.4.m4.6.6.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.6.6.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.4.m4.6.6.1.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.6.6.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.4.m4.6.6.1.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.6.6.1.1.1.3.2">𝐅</ci><apply id="S3.SS2.SSS0.Px1.p3.4.m4.6.6.1.1.1.3.3.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.6.6.1.1.1.3.3"><minus id="S3.SS2.SSS0.Px1.p3.4.m4.6.6.1.1.1.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.6.6.1.1.1.3.3.1"></minus><ci id="S3.SS2.SSS0.Px1.p3.4.m4.6.6.1.1.1.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.6.6.1.1.1.3.3.2">𝑡</ci><ci id="S3.SS2.SSS0.Px1.p3.4.m4.6.6.1.1.1.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.6.6.1.1.1.3.3.3">𝜏</ci></apply></apply></apply><apply id="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2.2.2">𝐕</ci><apply id="S3.SS2.SSS0.Px1.p3.4.m4.3.3.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.3.3.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px1.p3.4.m4.3.3.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.3.3.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px1.p3.4.m4.3.3.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.3.3.1.1">𝑙</ci></apply></apply><apply id="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2.3.2.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2.3.2">𝐅</ci><apply id="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2.3.3.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2.3.3"><plus id="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2.3.3.1"></plus><apply id="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2.3.3.2"><minus id="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2.3.3.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2.3.3.2.1"></minus><ci id="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2.3.3.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2.3.3.2.2">𝑡</ci><ci id="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2.3.3.2.3.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2.3.3.2.3">𝜏</ci></apply><cn id="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2.3.3.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p3.4.m4.7.7.2.2.2.3.3.3">1</cn></apply></apply></apply><ci id="S3.SS2.SSS0.Px1.p3.4.m4.5.5.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.5.5">…</ci><apply id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.3.3">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.3.3.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.3.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.3.3.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.3.3.2.2">𝐕</ci><apply id="S3.SS2.SSS0.Px1.p3.4.m4.4.4.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.4.4.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px1.p3.4.m4.4.4.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.4.4.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px1.p3.4.m4.4.4.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.4.4.1.1">𝑙</ci></apply></apply><apply id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.3.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.3.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.3.3.3.2">𝐅</ci><apply id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.3.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.3.3.3.3"><minus id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.3.3.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.3.3.3.3.1"></minus><ci id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.3.3.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.3.3.3.3.2">𝑡</ci><cn id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.3.3.3.3.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.3.3.3.3.3">1</cn></apply></apply></apply></set></apply><apply id="S3.SS2.SSS0.Px1.p3.4.m4.8.8c.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8"><in id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.7.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.7"></in><share href="https://arxiv.org/html/2410.03936v1#S3.SS2.SSS0.Px1.p3.4.m4.8.8.3.cmml" id="S3.SS2.SSS0.Px1.p3.4.m4.8.8d.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8"></share><apply id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.2.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.2">ℝ</ci><apply id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3"><times id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.1"></times><apply id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.2.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.2"><times id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.2.1"></times><apply id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.2.2"><times id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.2.2.1"></times><ci id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.2.2.2">𝜏</ci><apply id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.2.2.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.2.2.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.2.2.3.2.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.2.2.3.2">𝑛</ci><ci id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.2.2.3.3.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.2.2.3.3">ℎ</ci></apply></apply><apply id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.2.3.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.2.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.2.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.2.3.2.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.2.3.2">𝑛</ci><ci id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.2.3.3.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.2.3.3">𝑤</ci></apply></apply><ci id="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.3.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.8.8.8.3.3">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p3.4.m4.8c">\mathbf{V}^{[l]}_{\mathbf{H}_{t}}=\{\mathbf{V}^{[l]}_{\mathbf{F}_{t-\tau}},%
\mathbf{V}^{[l]}_{\mathbf{F}_{t-\tau+1}},\ldots,\mathbf{V}^{[l]}_{\mathbf{F}_{%
t-1}}\}\in\mathbb{R}^{\tau\times n_{h}n_{w}\times d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p3.4.m4.8d">bold_V start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT bold_H start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT = { bold_V start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT bold_F start_POSTSUBSCRIPT italic_t - italic_τ end_POSTSUBSCRIPT end_POSTSUBSCRIPT , bold_V start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT bold_F start_POSTSUBSCRIPT italic_t - italic_τ + 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , … , bold_V start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT bold_F start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT } ∈ blackboard_R start_POSTSUPERSCRIPT italic_τ × italic_n start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS0.Px1.p4">
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p4.1">We, then, compute the attention, and limit it to the <span class="ltx_text ltx_font_italic" id="S3.SS2.SSS0.Px1.p4.1.1">top-k</span> most similar patches in the key vector for each patch in the query vector, and, hence, focus solely on those that align closely. This prevents the inclusion of unrelated patches, which can, potentially, introduce irrelevant correlations, and obscure principal features. We, then, formalize the <span class="ltx_text ltx_font_italic" id="S3.SS2.SSS0.Px1.p4.1.2">top-k</span> selection procedure as,</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A7.EGx3">
<tbody id="S3.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{A}_{t}^{[l]}" class="ltx_Math" display="inline" id="S3.E4.m1.1"><semantics id="S3.E4.m1.1a"><msubsup id="S3.E4.m1.1.2" xref="S3.E4.m1.1.2.cmml"><mi id="S3.E4.m1.1.2.2.2" xref="S3.E4.m1.1.2.2.2.cmml">𝐀</mi><mi id="S3.E4.m1.1.2.2.3" xref="S3.E4.m1.1.2.2.3.cmml">t</mi><mrow id="S3.E4.m1.1.1.1.3" xref="S3.E4.m1.1.1.1.2.cmml"><mo id="S3.E4.m1.1.1.1.3.1" stretchy="false" xref="S3.E4.m1.1.1.1.2.1.cmml">[</mo><mi id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml">l</mi><mo id="S3.E4.m1.1.1.1.3.2" stretchy="false" xref="S3.E4.m1.1.1.1.2.1.cmml">]</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.E4.m1.1b"><apply id="S3.E4.m1.1.2.cmml" xref="S3.E4.m1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.2.1.cmml" xref="S3.E4.m1.1.2">superscript</csymbol><apply id="S3.E4.m1.1.2.2.cmml" xref="S3.E4.m1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.2.2.1.cmml" xref="S3.E4.m1.1.2">subscript</csymbol><ci id="S3.E4.m1.1.2.2.2.cmml" xref="S3.E4.m1.1.2.2.2">𝐀</ci><ci id="S3.E4.m1.1.2.2.3.cmml" xref="S3.E4.m1.1.2.2.3">𝑡</ci></apply><apply id="S3.E4.m1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.3"><csymbol cd="latexml" id="S3.E4.m1.1.1.1.2.1.cmml" xref="S3.E4.m1.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.1c">\displaystyle\mathbf{A}_{t}^{[l]}</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.1d">bold_A start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=(\mathbf{Q}^{[l]}_{\mathbf{F}_{t}}\cdot\mathbf{K}^{[l]}_{\mathbf%
{H}_{t}})/\alpha\in\mathbb{R}^{\tau\times(n^{l}_{h}n^{l}_{w})\times(n^{l}_{h}n%
^{l}_{w})}," class="ltx_Math" display="inline" id="S3.E4.m2.5"><semantics id="S3.E4.m2.5a"><mrow id="S3.E4.m2.5.5.1" xref="S3.E4.m2.5.5.1.1.cmml"><mrow id="S3.E4.m2.5.5.1.1" xref="S3.E4.m2.5.5.1.1.cmml"><mi id="S3.E4.m2.5.5.1.1.3" xref="S3.E4.m2.5.5.1.1.3.cmml"></mi><mo id="S3.E4.m2.5.5.1.1.4" xref="S3.E4.m2.5.5.1.1.4.cmml">=</mo><mrow id="S3.E4.m2.5.5.1.1.1" xref="S3.E4.m2.5.5.1.1.1.cmml"><mrow id="S3.E4.m2.5.5.1.1.1.1.1" xref="S3.E4.m2.5.5.1.1.1.1.1.1.cmml"><mo id="S3.E4.m2.5.5.1.1.1.1.1.2" stretchy="false" xref="S3.E4.m2.5.5.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m2.5.5.1.1.1.1.1.1" xref="S3.E4.m2.5.5.1.1.1.1.1.1.cmml"><msubsup id="S3.E4.m2.5.5.1.1.1.1.1.1.2" xref="S3.E4.m2.5.5.1.1.1.1.1.1.2.cmml"><mi id="S3.E4.m2.5.5.1.1.1.1.1.1.2.2.2" xref="S3.E4.m2.5.5.1.1.1.1.1.1.2.2.2.cmml">𝐐</mi><msub id="S3.E4.m2.5.5.1.1.1.1.1.1.2.3" xref="S3.E4.m2.5.5.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E4.m2.5.5.1.1.1.1.1.1.2.3.2" xref="S3.E4.m2.5.5.1.1.1.1.1.1.2.3.2.cmml">𝐅</mi><mi id="S3.E4.m2.5.5.1.1.1.1.1.1.2.3.3" xref="S3.E4.m2.5.5.1.1.1.1.1.1.2.3.3.cmml">t</mi></msub><mrow id="S3.E4.m2.1.1.1.3" xref="S3.E4.m2.1.1.1.2.cmml"><mo id="S3.E4.m2.1.1.1.3.1" stretchy="false" xref="S3.E4.m2.1.1.1.2.1.cmml">[</mo><mi id="S3.E4.m2.1.1.1.1" xref="S3.E4.m2.1.1.1.1.cmml">l</mi><mo id="S3.E4.m2.1.1.1.3.2" stretchy="false" xref="S3.E4.m2.1.1.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.E4.m2.5.5.1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.E4.m2.5.5.1.1.1.1.1.1.1.cmml">⋅</mo><msubsup id="S3.E4.m2.5.5.1.1.1.1.1.1.3" xref="S3.E4.m2.5.5.1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m2.5.5.1.1.1.1.1.1.3.2.2" xref="S3.E4.m2.5.5.1.1.1.1.1.1.3.2.2.cmml">𝐊</mi><msub id="S3.E4.m2.5.5.1.1.1.1.1.1.3.3" xref="S3.E4.m2.5.5.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E4.m2.5.5.1.1.1.1.1.1.3.3.2" xref="S3.E4.m2.5.5.1.1.1.1.1.1.3.3.2.cmml">𝐇</mi><mi id="S3.E4.m2.5.5.1.1.1.1.1.1.3.3.3" xref="S3.E4.m2.5.5.1.1.1.1.1.1.3.3.3.cmml">t</mi></msub><mrow id="S3.E4.m2.2.2.1.3" xref="S3.E4.m2.2.2.1.2.cmml"><mo id="S3.E4.m2.2.2.1.3.1" stretchy="false" xref="S3.E4.m2.2.2.1.2.1.cmml">[</mo><mi id="S3.E4.m2.2.2.1.1" xref="S3.E4.m2.2.2.1.1.cmml">l</mi><mo id="S3.E4.m2.2.2.1.3.2" stretchy="false" xref="S3.E4.m2.2.2.1.2.1.cmml">]</mo></mrow></msubsup></mrow><mo id="S3.E4.m2.5.5.1.1.1.1.1.3" stretchy="false" xref="S3.E4.m2.5.5.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E4.m2.5.5.1.1.1.2" xref="S3.E4.m2.5.5.1.1.1.2.cmml">/</mo><mi id="S3.E4.m2.5.5.1.1.1.3" xref="S3.E4.m2.5.5.1.1.1.3.cmml">α</mi></mrow><mo id="S3.E4.m2.5.5.1.1.5" xref="S3.E4.m2.5.5.1.1.5.cmml">∈</mo><msup id="S3.E4.m2.5.5.1.1.6" xref="S3.E4.m2.5.5.1.1.6.cmml"><mi id="S3.E4.m2.5.5.1.1.6.2" xref="S3.E4.m2.5.5.1.1.6.2.cmml">ℝ</mi><mrow id="S3.E4.m2.4.4.2" xref="S3.E4.m2.4.4.2.cmml"><mi id="S3.E4.m2.4.4.2.4" xref="S3.E4.m2.4.4.2.4.cmml">τ</mi><mo id="S3.E4.m2.4.4.2.3" lspace="0.222em" rspace="0.222em" xref="S3.E4.m2.4.4.2.3.cmml">×</mo><mrow id="S3.E4.m2.3.3.1.1.1" xref="S3.E4.m2.3.3.1.1.1.1.cmml"><mo id="S3.E4.m2.3.3.1.1.1.2" stretchy="false" xref="S3.E4.m2.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m2.3.3.1.1.1.1" xref="S3.E4.m2.3.3.1.1.1.1.cmml"><msubsup id="S3.E4.m2.3.3.1.1.1.1.2" xref="S3.E4.m2.3.3.1.1.1.1.2.cmml"><mi id="S3.E4.m2.3.3.1.1.1.1.2.2.2" xref="S3.E4.m2.3.3.1.1.1.1.2.2.2.cmml">n</mi><mi id="S3.E4.m2.3.3.1.1.1.1.2.3" xref="S3.E4.m2.3.3.1.1.1.1.2.3.cmml">h</mi><mi id="S3.E4.m2.3.3.1.1.1.1.2.2.3" xref="S3.E4.m2.3.3.1.1.1.1.2.2.3.cmml">l</mi></msubsup><mo id="S3.E4.m2.3.3.1.1.1.1.1" xref="S3.E4.m2.3.3.1.1.1.1.1.cmml">⁢</mo><msubsup id="S3.E4.m2.3.3.1.1.1.1.3" xref="S3.E4.m2.3.3.1.1.1.1.3.cmml"><mi id="S3.E4.m2.3.3.1.1.1.1.3.2.2" xref="S3.E4.m2.3.3.1.1.1.1.3.2.2.cmml">n</mi><mi id="S3.E4.m2.3.3.1.1.1.1.3.3" xref="S3.E4.m2.3.3.1.1.1.1.3.3.cmml">w</mi><mi id="S3.E4.m2.3.3.1.1.1.1.3.2.3" xref="S3.E4.m2.3.3.1.1.1.1.3.2.3.cmml">l</mi></msubsup></mrow><mo id="S3.E4.m2.3.3.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.E4.m2.3.3.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E4.m2.4.4.2.3a" rspace="0.222em" xref="S3.E4.m2.4.4.2.3.cmml">×</mo><mrow id="S3.E4.m2.4.4.2.2.1" xref="S3.E4.m2.4.4.2.2.1.1.cmml"><mo id="S3.E4.m2.4.4.2.2.1.2" stretchy="false" xref="S3.E4.m2.4.4.2.2.1.1.cmml">(</mo><mrow id="S3.E4.m2.4.4.2.2.1.1" xref="S3.E4.m2.4.4.2.2.1.1.cmml"><msubsup id="S3.E4.m2.4.4.2.2.1.1.2" xref="S3.E4.m2.4.4.2.2.1.1.2.cmml"><mi id="S3.E4.m2.4.4.2.2.1.1.2.2.2" xref="S3.E4.m2.4.4.2.2.1.1.2.2.2.cmml">n</mi><mi id="S3.E4.m2.4.4.2.2.1.1.2.3" xref="S3.E4.m2.4.4.2.2.1.1.2.3.cmml">h</mi><mi id="S3.E4.m2.4.4.2.2.1.1.2.2.3" xref="S3.E4.m2.4.4.2.2.1.1.2.2.3.cmml">l</mi></msubsup><mo id="S3.E4.m2.4.4.2.2.1.1.1" xref="S3.E4.m2.4.4.2.2.1.1.1.cmml">⁢</mo><msubsup id="S3.E4.m2.4.4.2.2.1.1.3" xref="S3.E4.m2.4.4.2.2.1.1.3.cmml"><mi id="S3.E4.m2.4.4.2.2.1.1.3.2.2" xref="S3.E4.m2.4.4.2.2.1.1.3.2.2.cmml">n</mi><mi id="S3.E4.m2.4.4.2.2.1.1.3.3" xref="S3.E4.m2.4.4.2.2.1.1.3.3.cmml">w</mi><mi id="S3.E4.m2.4.4.2.2.1.1.3.2.3" xref="S3.E4.m2.4.4.2.2.1.1.3.2.3.cmml">l</mi></msubsup></mrow><mo id="S3.E4.m2.4.4.2.2.1.3" stretchy="false" xref="S3.E4.m2.4.4.2.2.1.1.cmml">)</mo></mrow></mrow></msup></mrow><mo id="S3.E4.m2.5.5.1.2" xref="S3.E4.m2.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m2.5b"><apply id="S3.E4.m2.5.5.1.1.cmml" xref="S3.E4.m2.5.5.1"><and id="S3.E4.m2.5.5.1.1a.cmml" xref="S3.E4.m2.5.5.1"></and><apply id="S3.E4.m2.5.5.1.1b.cmml" xref="S3.E4.m2.5.5.1"><eq id="S3.E4.m2.5.5.1.1.4.cmml" xref="S3.E4.m2.5.5.1.1.4"></eq><csymbol cd="latexml" id="S3.E4.m2.5.5.1.1.3.cmml" xref="S3.E4.m2.5.5.1.1.3">absent</csymbol><apply id="S3.E4.m2.5.5.1.1.1.cmml" xref="S3.E4.m2.5.5.1.1.1"><divide id="S3.E4.m2.5.5.1.1.1.2.cmml" xref="S3.E4.m2.5.5.1.1.1.2"></divide><apply id="S3.E4.m2.5.5.1.1.1.1.1.1.cmml" xref="S3.E4.m2.5.5.1.1.1.1.1"><ci id="S3.E4.m2.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E4.m2.5.5.1.1.1.1.1.1.1">⋅</ci><apply id="S3.E4.m2.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E4.m2.5.5.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m2.5.5.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m2.5.5.1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.E4.m2.5.5.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m2.5.5.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m2.5.5.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E4.m2.5.5.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.E4.m2.5.5.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E4.m2.5.5.1.1.1.1.1.1.2.2.2">𝐐</ci><apply id="S3.E4.m2.1.1.1.2.cmml" xref="S3.E4.m2.1.1.1.3"><csymbol cd="latexml" id="S3.E4.m2.1.1.1.2.1.cmml" xref="S3.E4.m2.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.E4.m2.1.1.1.1.cmml" xref="S3.E4.m2.1.1.1.1">𝑙</ci></apply></apply><apply id="S3.E4.m2.5.5.1.1.1.1.1.1.2.3.cmml" xref="S3.E4.m2.5.5.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E4.m2.5.5.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E4.m2.5.5.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E4.m2.5.5.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E4.m2.5.5.1.1.1.1.1.1.2.3.2">𝐅</ci><ci id="S3.E4.m2.5.5.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E4.m2.5.5.1.1.1.1.1.1.2.3.3">𝑡</ci></apply></apply><apply id="S3.E4.m2.5.5.1.1.1.1.1.1.3.cmml" xref="S3.E4.m2.5.5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m2.5.5.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m2.5.5.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E4.m2.5.5.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m2.5.5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m2.5.5.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E4.m2.5.5.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E4.m2.5.5.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E4.m2.5.5.1.1.1.1.1.1.3.2.2">𝐊</ci><apply id="S3.E4.m2.2.2.1.2.cmml" xref="S3.E4.m2.2.2.1.3"><csymbol cd="latexml" id="S3.E4.m2.2.2.1.2.1.cmml" xref="S3.E4.m2.2.2.1.3.1">delimited-[]</csymbol><ci id="S3.E4.m2.2.2.1.1.cmml" xref="S3.E4.m2.2.2.1.1">𝑙</ci></apply></apply><apply id="S3.E4.m2.5.5.1.1.1.1.1.1.3.3.cmml" xref="S3.E4.m2.5.5.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E4.m2.5.5.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E4.m2.5.5.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E4.m2.5.5.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E4.m2.5.5.1.1.1.1.1.1.3.3.2">𝐇</ci><ci id="S3.E4.m2.5.5.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E4.m2.5.5.1.1.1.1.1.1.3.3.3">𝑡</ci></apply></apply></apply><ci id="S3.E4.m2.5.5.1.1.1.3.cmml" xref="S3.E4.m2.5.5.1.1.1.3">𝛼</ci></apply></apply><apply id="S3.E4.m2.5.5.1.1c.cmml" xref="S3.E4.m2.5.5.1"><in id="S3.E4.m2.5.5.1.1.5.cmml" xref="S3.E4.m2.5.5.1.1.5"></in><share href="https://arxiv.org/html/2410.03936v1#S3.E4.m2.5.5.1.1.1.cmml" id="S3.E4.m2.5.5.1.1d.cmml" xref="S3.E4.m2.5.5.1"></share><apply id="S3.E4.m2.5.5.1.1.6.cmml" xref="S3.E4.m2.5.5.1.1.6"><csymbol cd="ambiguous" id="S3.E4.m2.5.5.1.1.6.1.cmml" xref="S3.E4.m2.5.5.1.1.6">superscript</csymbol><ci id="S3.E4.m2.5.5.1.1.6.2.cmml" xref="S3.E4.m2.5.5.1.1.6.2">ℝ</ci><apply id="S3.E4.m2.4.4.2.cmml" xref="S3.E4.m2.4.4.2"><times id="S3.E4.m2.4.4.2.3.cmml" xref="S3.E4.m2.4.4.2.3"></times><ci id="S3.E4.m2.4.4.2.4.cmml" xref="S3.E4.m2.4.4.2.4">𝜏</ci><apply id="S3.E4.m2.3.3.1.1.1.1.cmml" xref="S3.E4.m2.3.3.1.1.1"><times id="S3.E4.m2.3.3.1.1.1.1.1.cmml" xref="S3.E4.m2.3.3.1.1.1.1.1"></times><apply id="S3.E4.m2.3.3.1.1.1.1.2.cmml" xref="S3.E4.m2.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m2.3.3.1.1.1.1.2.1.cmml" xref="S3.E4.m2.3.3.1.1.1.1.2">subscript</csymbol><apply id="S3.E4.m2.3.3.1.1.1.1.2.2.cmml" xref="S3.E4.m2.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m2.3.3.1.1.1.1.2.2.1.cmml" xref="S3.E4.m2.3.3.1.1.1.1.2">superscript</csymbol><ci id="S3.E4.m2.3.3.1.1.1.1.2.2.2.cmml" xref="S3.E4.m2.3.3.1.1.1.1.2.2.2">𝑛</ci><ci id="S3.E4.m2.3.3.1.1.1.1.2.2.3.cmml" xref="S3.E4.m2.3.3.1.1.1.1.2.2.3">𝑙</ci></apply><ci id="S3.E4.m2.3.3.1.1.1.1.2.3.cmml" xref="S3.E4.m2.3.3.1.1.1.1.2.3">ℎ</ci></apply><apply id="S3.E4.m2.3.3.1.1.1.1.3.cmml" xref="S3.E4.m2.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m2.3.3.1.1.1.1.3.1.cmml" xref="S3.E4.m2.3.3.1.1.1.1.3">subscript</csymbol><apply id="S3.E4.m2.3.3.1.1.1.1.3.2.cmml" xref="S3.E4.m2.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m2.3.3.1.1.1.1.3.2.1.cmml" xref="S3.E4.m2.3.3.1.1.1.1.3">superscript</csymbol><ci id="S3.E4.m2.3.3.1.1.1.1.3.2.2.cmml" xref="S3.E4.m2.3.3.1.1.1.1.3.2.2">𝑛</ci><ci id="S3.E4.m2.3.3.1.1.1.1.3.2.3.cmml" xref="S3.E4.m2.3.3.1.1.1.1.3.2.3">𝑙</ci></apply><ci id="S3.E4.m2.3.3.1.1.1.1.3.3.cmml" xref="S3.E4.m2.3.3.1.1.1.1.3.3">𝑤</ci></apply></apply><apply id="S3.E4.m2.4.4.2.2.1.1.cmml" xref="S3.E4.m2.4.4.2.2.1"><times id="S3.E4.m2.4.4.2.2.1.1.1.cmml" xref="S3.E4.m2.4.4.2.2.1.1.1"></times><apply id="S3.E4.m2.4.4.2.2.1.1.2.cmml" xref="S3.E4.m2.4.4.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m2.4.4.2.2.1.1.2.1.cmml" xref="S3.E4.m2.4.4.2.2.1.1.2">subscript</csymbol><apply id="S3.E4.m2.4.4.2.2.1.1.2.2.cmml" xref="S3.E4.m2.4.4.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m2.4.4.2.2.1.1.2.2.1.cmml" xref="S3.E4.m2.4.4.2.2.1.1.2">superscript</csymbol><ci id="S3.E4.m2.4.4.2.2.1.1.2.2.2.cmml" xref="S3.E4.m2.4.4.2.2.1.1.2.2.2">𝑛</ci><ci id="S3.E4.m2.4.4.2.2.1.1.2.2.3.cmml" xref="S3.E4.m2.4.4.2.2.1.1.2.2.3">𝑙</ci></apply><ci id="S3.E4.m2.4.4.2.2.1.1.2.3.cmml" xref="S3.E4.m2.4.4.2.2.1.1.2.3">ℎ</ci></apply><apply id="S3.E4.m2.4.4.2.2.1.1.3.cmml" xref="S3.E4.m2.4.4.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m2.4.4.2.2.1.1.3.1.cmml" xref="S3.E4.m2.4.4.2.2.1.1.3">subscript</csymbol><apply id="S3.E4.m2.4.4.2.2.1.1.3.2.cmml" xref="S3.E4.m2.4.4.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m2.4.4.2.2.1.1.3.2.1.cmml" xref="S3.E4.m2.4.4.2.2.1.1.3">superscript</csymbol><ci id="S3.E4.m2.4.4.2.2.1.1.3.2.2.cmml" xref="S3.E4.m2.4.4.2.2.1.1.3.2.2">𝑛</ci><ci id="S3.E4.m2.4.4.2.2.1.1.3.2.3.cmml" xref="S3.E4.m2.4.4.2.2.1.1.3.2.3">𝑙</ci></apply><ci id="S3.E4.m2.4.4.2.2.1.1.3.3.cmml" xref="S3.E4.m2.4.4.2.2.1.1.3.3">𝑤</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m2.5c">\displaystyle=(\mathbf{Q}^{[l]}_{\mathbf{F}_{t}}\cdot\mathbf{K}^{[l]}_{\mathbf%
{H}_{t}})/\alpha\in\mathbb{R}^{\tau\times(n^{l}_{h}n^{l}_{w})\times(n^{l}_{h}n%
^{l}_{w})},</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m2.5d">= ( bold_Q start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT bold_F start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT ⋅ bold_K start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT bold_H start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) / italic_α ∈ blackboard_R start_POSTSUPERSCRIPT italic_τ × ( italic_n start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT italic_n start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT ) × ( italic_n start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT italic_n start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT ) end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
<tbody id="S3.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{A^{*}}_{t}^{[l]}" class="ltx_Math" display="inline" id="S3.E5.m1.1"><semantics id="S3.E5.m1.1a"><mmultiscripts id="S3.E5.m1.1.2" xref="S3.E5.m1.1.2.cmml"><mi id="S3.E5.m1.1.2.2.2.2" xref="S3.E5.m1.1.2.2.2.2.cmml">𝐀</mi><mrow id="S3.E5.m1.1.2a" xref="S3.E5.m1.1.2.cmml"></mrow><mo id="S3.E5.m1.1.2.2.2.3" xref="S3.E5.m1.1.2.2.2.3.cmml">∗</mo><mi id="S3.E5.m1.1.2.2.3" xref="S3.E5.m1.1.2.2.3.cmml">t</mi><mrow id="S3.E5.m1.1.1.1.3" xref="S3.E5.m1.1.1.1.2.cmml"><mo id="S3.E5.m1.1.1.1.3.1" stretchy="false" xref="S3.E5.m1.1.1.1.2.1.cmml">[</mo><mi id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml">l</mi><mo id="S3.E5.m1.1.1.1.3.2" stretchy="false" xref="S3.E5.m1.1.1.1.2.1.cmml">]</mo></mrow></mmultiscripts><annotation-xml encoding="MathML-Content" id="S3.E5.m1.1b"><apply id="S3.E5.m1.1.2.cmml" xref="S3.E5.m1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.2.1.cmml" xref="S3.E5.m1.1.2">superscript</csymbol><apply id="S3.E5.m1.1.2.2.cmml" xref="S3.E5.m1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.2.2.1.cmml" xref="S3.E5.m1.1.2">subscript</csymbol><apply id="S3.E5.m1.1.2.2.2.cmml" xref="S3.E5.m1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.2.2.2.1.cmml" xref="S3.E5.m1.1.2">superscript</csymbol><ci id="S3.E5.m1.1.2.2.2.2.cmml" xref="S3.E5.m1.1.2.2.2.2">𝐀</ci><times id="S3.E5.m1.1.2.2.2.3.cmml" xref="S3.E5.m1.1.2.2.2.3"></times></apply><ci id="S3.E5.m1.1.2.2.3.cmml" xref="S3.E5.m1.1.2.2.3">𝑡</ci></apply><apply id="S3.E5.m1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.3"><csymbol cd="latexml" id="S3.E5.m1.1.1.1.2.1.cmml" xref="S3.E5.m1.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.1c">\displaystyle\mathbf{A^{*}}_{t}^{[l]}</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.1d">bold_A start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\begin{cases}x,&amp;\text{if }x\in\textrm{topk}_{i\in(n^{l}_{h}n^{l}%
_{w})}(\mathbf{A_{(:,:,i)}}_{t}^{[l]},k),\\
-\infty,&amp;\text{otherwise}\end{cases}" class="ltx_Math" display="inline" id="S3.E5.m2.4"><semantics id="S3.E5.m2.4a"><mrow id="S3.E5.m2.4.5" xref="S3.E5.m2.4.5.cmml"><mi id="S3.E5.m2.4.5.2" xref="S3.E5.m2.4.5.2.cmml"></mi><mo id="S3.E5.m2.4.5.1" xref="S3.E5.m2.4.5.1.cmml">=</mo><mrow id="S3.E5.m2.4.4a" xref="S3.E5.m2.4.5.3.1.cmml"><mo id="S3.E5.m2.4.4a.5" xref="S3.E5.m2.4.5.3.1.1.cmml">{</mo><mtable columnspacing="5pt" id="S3.E5.m2.4.4.4a" rowspacing="0pt" xref="S3.E5.m2.4.5.3.1.cmml"><mtr id="S3.E5.m2.4.4.4aa" xref="S3.E5.m2.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m2.4.4.4ab" xref="S3.E5.m2.4.5.3.1.cmml"><mrow id="S3.E5.m2.1.1.1.1.1.1.3" xref="S3.E5.m2.4.5.3.1.cmml"><mi id="S3.E5.m2.1.1.1.1.1.1.1" xref="S3.E5.m2.1.1.1.1.1.1.1.cmml">x</mi><mo id="S3.E5.m2.1.1.1.1.1.1.3.1" xref="S3.E5.m2.4.5.3.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m2.4.4.4ac" xref="S3.E5.m2.4.5.3.1.cmml"><mrow id="S3.E5.m2.2.2.2.2.2.1.7" xref="S3.E5.m2.2.2.2.2.2.1.7.1.cmml"><mrow id="S3.E5.m2.2.2.2.2.2.1.7.1" xref="S3.E5.m2.2.2.2.2.2.1.7.1.cmml"><mrow id="S3.E5.m2.2.2.2.2.2.1.7.1.3" xref="S3.E5.m2.2.2.2.2.2.1.7.1.3.cmml"><mtext id="S3.E5.m2.2.2.2.2.2.1.7.1.3.2" xref="S3.E5.m2.2.2.2.2.2.1.7.1.3.2a.cmml">if </mtext><mo id="S3.E5.m2.2.2.2.2.2.1.7.1.3.1" xref="S3.E5.m2.2.2.2.2.2.1.7.1.3.1.cmml">⁢</mo><mi id="S3.E5.m2.2.2.2.2.2.1.7.1.3.3" xref="S3.E5.m2.2.2.2.2.2.1.7.1.3.3.cmml">x</mi></mrow><mo id="S3.E5.m2.2.2.2.2.2.1.7.1.2" xref="S3.E5.m2.2.2.2.2.2.1.7.1.2.cmml">∈</mo><mrow id="S3.E5.m2.2.2.2.2.2.1.7.1.1" xref="S3.E5.m2.2.2.2.2.2.1.7.1.1.cmml"><msub id="S3.E5.m2.2.2.2.2.2.1.7.1.1.3" xref="S3.E5.m2.2.2.2.2.2.1.7.1.1.3.cmml"><mtext id="S3.E5.m2.2.2.2.2.2.1.7.1.1.3.2" xref="S3.E5.m2.2.2.2.2.2.1.7.1.1.3.2a.cmml">topk</mtext><mrow id="S3.E5.m2.2.2.2.2.2.1.1.1" xref="S3.E5.m2.2.2.2.2.2.1.1.1.cmml"><mi id="S3.E5.m2.2.2.2.2.2.1.1.1.3" xref="S3.E5.m2.2.2.2.2.2.1.1.1.3.cmml">i</mi><mo id="S3.E5.m2.2.2.2.2.2.1.1.1.2" xref="S3.E5.m2.2.2.2.2.2.1.1.1.2.cmml">∈</mo><mrow id="S3.E5.m2.2.2.2.2.2.1.1.1.1.1" xref="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.cmml"><mo id="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1" xref="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.cmml"><msubsup id="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.2" xref="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.2.cmml"><mi id="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.2.2.2" xref="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.2.2.2.cmml">n</mi><mi id="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.2.3" xref="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.2.3.cmml">h</mi><mi id="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.2.2.3" xref="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.2.2.3.cmml">l</mi></msubsup><mo id="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.1" xref="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.1.cmml">⁢</mo><msubsup id="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.3" xref="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.3.2.2" xref="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.3.2.2.cmml">n</mi><mi id="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.3.3" xref="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.3.3.cmml">w</mi><mi id="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.3.2.3" xref="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.3.2.3.cmml">l</mi></msubsup></mrow><mo id="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.3" stretchy="false" xref="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msub><mo id="S3.E5.m2.2.2.2.2.2.1.7.1.1.2" xref="S3.E5.m2.2.2.2.2.2.1.7.1.1.2.cmml">⁢</mo><mrow id="S3.E5.m2.2.2.2.2.2.1.7.1.1.1.1" xref="S3.E5.m2.2.2.2.2.2.1.7.1.1.1.2.cmml"><mo id="S3.E5.m2.2.2.2.2.2.1.7.1.1.1.1.2" stretchy="false" xref="S3.E5.m2.2.2.2.2.2.1.7.1.1.1.2.cmml">(</mo><mmultiscripts id="S3.E5.m2.2.2.2.2.2.1.7.1.1.1.1.1" xref="S3.E5.m2.2.2.2.2.2.1.7.1.1.1.1.1.cmml"><mi id="S3.E5.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.2" xref="S3.E5.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.2.cmml">𝐀</mi><mrow id="S3.E5.m2.2.2.2.2.2.1.4.3.5" xref="S3.E5.m2.2.2.2.2.2.1.4.3.4.cmml"><mo id="S3.E5.m2.2.2.2.2.2.1.4.3.5.1" stretchy="false" xref="S3.E5.m2.2.2.2.2.2.1.4.3.4.cmml">(</mo><mo id="S3.E5.m2.2.2.2.2.2.1.2.1.1" rspace="0em" xref="S3.E5.m2.2.2.2.2.2.1.2.1.1.cmml">:</mo><mo id="S3.E5.m2.2.2.2.2.2.1.4.3.5.2" xref="S3.E5.m2.2.2.2.2.2.1.4.3.4.cmml">,</mo><mo id="S3.E5.m2.2.2.2.2.2.1.3.2.2" rspace="0em" xref="S3.E5.m2.2.2.2.2.2.1.3.2.2.cmml">:</mo><mo id="S3.E5.m2.2.2.2.2.2.1.4.3.5.3" xref="S3.E5.m2.2.2.2.2.2.1.4.3.4.cmml">,</mo><mi id="S3.E5.m2.2.2.2.2.2.1.4.3.3" xref="S3.E5.m2.2.2.2.2.2.1.4.3.3.cmml">𝐢</mi><mo id="S3.E5.m2.2.2.2.2.2.1.4.3.5.4" stretchy="false" xref="S3.E5.m2.2.2.2.2.2.1.4.3.4.cmml">)</mo></mrow><mrow id="S3.E5.m2.2.2.2.2.2.1.7.1.1.1.1.1a" xref="S3.E5.m2.2.2.2.2.2.1.7.1.1.1.1.1.cmml"></mrow><mi id="S3.E5.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.3" xref="S3.E5.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.3.cmml">t</mi><mrow id="S3.E5.m2.2.2.2.2.2.1.5.1.3" xref="S3.E5.m2.2.2.2.2.2.1.5.1.2.cmml"><mo id="S3.E5.m2.2.2.2.2.2.1.5.1.3.1" stretchy="false" xref="S3.E5.m2.2.2.2.2.2.1.5.1.2.1.cmml">[</mo><mi id="S3.E5.m2.2.2.2.2.2.1.5.1.1" xref="S3.E5.m2.2.2.2.2.2.1.5.1.1.cmml">l</mi><mo id="S3.E5.m2.2.2.2.2.2.1.5.1.3.2" stretchy="false" xref="S3.E5.m2.2.2.2.2.2.1.5.1.2.1.cmml">]</mo></mrow></mmultiscripts><mo id="S3.E5.m2.2.2.2.2.2.1.7.1.1.1.1.3" xref="S3.E5.m2.2.2.2.2.2.1.7.1.1.1.2.cmml">,</mo><mi id="S3.E5.m2.2.2.2.2.2.1.6" xref="S3.E5.m2.2.2.2.2.2.1.6.cmml">k</mi><mo id="S3.E5.m2.2.2.2.2.2.1.7.1.1.1.1.4" stretchy="false" xref="S3.E5.m2.2.2.2.2.2.1.7.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E5.m2.2.2.2.2.2.1.7.2" xref="S3.E5.m2.2.2.2.2.2.1.7.1.cmml">,</mo></mrow></mtd></mtr><mtr id="S3.E5.m2.4.4.4ad" xref="S3.E5.m2.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m2.4.4.4ae" xref="S3.E5.m2.4.5.3.1.cmml"><mrow id="S3.E5.m2.3.3.3.3.1.1.1" xref="S3.E5.m2.3.3.3.3.1.1.1.1.cmml"><mrow id="S3.E5.m2.3.3.3.3.1.1.1.1" xref="S3.E5.m2.3.3.3.3.1.1.1.1.cmml"><mo id="S3.E5.m2.3.3.3.3.1.1.1.1a" xref="S3.E5.m2.3.3.3.3.1.1.1.1.cmml">−</mo><mi id="S3.E5.m2.3.3.3.3.1.1.1.1.2" mathvariant="normal" xref="S3.E5.m2.3.3.3.3.1.1.1.1.2.cmml">∞</mi></mrow><mo id="S3.E5.m2.3.3.3.3.1.1.1.2" xref="S3.E5.m2.3.3.3.3.1.1.1.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m2.4.4.4af" xref="S3.E5.m2.4.5.3.1.cmml"><mtext id="S3.E5.m2.4.4.4.4.2.1" xref="S3.E5.m2.4.4.4.4.2.1a.cmml">otherwise</mtext></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m2.4b"><apply id="S3.E5.m2.4.5.cmml" xref="S3.E5.m2.4.5"><eq id="S3.E5.m2.4.5.1.cmml" xref="S3.E5.m2.4.5.1"></eq><csymbol cd="latexml" id="S3.E5.m2.4.5.2.cmml" xref="S3.E5.m2.4.5.2">absent</csymbol><apply id="S3.E5.m2.4.5.3.1.cmml" xref="S3.E5.m2.4.4a"><csymbol cd="latexml" id="S3.E5.m2.4.5.3.1.1.cmml" xref="S3.E5.m2.4.4a.5">cases</csymbol><ci id="S3.E5.m2.1.1.1.1.1.1.1.cmml" xref="S3.E5.m2.1.1.1.1.1.1.1">𝑥</ci><apply id="S3.E5.m2.2.2.2.2.2.1.7.1.cmml" xref="S3.E5.m2.2.2.2.2.2.1.7"><in id="S3.E5.m2.2.2.2.2.2.1.7.1.2.cmml" xref="S3.E5.m2.2.2.2.2.2.1.7.1.2"></in><apply id="S3.E5.m2.2.2.2.2.2.1.7.1.3.cmml" xref="S3.E5.m2.2.2.2.2.2.1.7.1.3"><times id="S3.E5.m2.2.2.2.2.2.1.7.1.3.1.cmml" xref="S3.E5.m2.2.2.2.2.2.1.7.1.3.1"></times><ci id="S3.E5.m2.2.2.2.2.2.1.7.1.3.2a.cmml" xref="S3.E5.m2.2.2.2.2.2.1.7.1.3.2"><mtext id="S3.E5.m2.2.2.2.2.2.1.7.1.3.2.cmml" xref="S3.E5.m2.2.2.2.2.2.1.7.1.3.2">if </mtext></ci><ci id="S3.E5.m2.2.2.2.2.2.1.7.1.3.3.cmml" xref="S3.E5.m2.2.2.2.2.2.1.7.1.3.3">𝑥</ci></apply><apply id="S3.E5.m2.2.2.2.2.2.1.7.1.1.cmml" xref="S3.E5.m2.2.2.2.2.2.1.7.1.1"><times id="S3.E5.m2.2.2.2.2.2.1.7.1.1.2.cmml" xref="S3.E5.m2.2.2.2.2.2.1.7.1.1.2"></times><apply id="S3.E5.m2.2.2.2.2.2.1.7.1.1.3.cmml" xref="S3.E5.m2.2.2.2.2.2.1.7.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m2.2.2.2.2.2.1.7.1.1.3.1.cmml" xref="S3.E5.m2.2.2.2.2.2.1.7.1.1.3">subscript</csymbol><ci id="S3.E5.m2.2.2.2.2.2.1.7.1.1.3.2a.cmml" xref="S3.E5.m2.2.2.2.2.2.1.7.1.1.3.2"><mtext id="S3.E5.m2.2.2.2.2.2.1.7.1.1.3.2.cmml" xref="S3.E5.m2.2.2.2.2.2.1.7.1.1.3.2">topk</mtext></ci><apply id="S3.E5.m2.2.2.2.2.2.1.1.1.cmml" xref="S3.E5.m2.2.2.2.2.2.1.1.1"><in id="S3.E5.m2.2.2.2.2.2.1.1.1.2.cmml" xref="S3.E5.m2.2.2.2.2.2.1.1.1.2"></in><ci id="S3.E5.m2.2.2.2.2.2.1.1.1.3.cmml" xref="S3.E5.m2.2.2.2.2.2.1.1.1.3">𝑖</ci><apply id="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.cmml" xref="S3.E5.m2.2.2.2.2.2.1.1.1.1.1"><times id="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.1"></times><apply id="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.2.2.2">𝑛</ci><ci id="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.2.2.3">𝑙</ci></apply><ci id="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.2.3.cmml" xref="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.2.3">ℎ</ci></apply><apply id="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.3.2.2">𝑛</ci><ci id="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.3.2.3">𝑙</ci></apply><ci id="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.E5.m2.2.2.2.2.2.1.1.1.1.1.1.3.3">𝑤</ci></apply></apply></apply></apply><interval closure="open" id="S3.E5.m2.2.2.2.2.2.1.7.1.1.1.2.cmml" xref="S3.E5.m2.2.2.2.2.2.1.7.1.1.1.1"><apply id="S3.E5.m2.2.2.2.2.2.1.7.1.1.1.1.1.cmml" xref="S3.E5.m2.2.2.2.2.2.1.7.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m2.2.2.2.2.2.1.7.1.1.1.1.1.1.cmml" xref="S3.E5.m2.2.2.2.2.2.1.7.1.1.1.1.1">superscript</csymbol><apply id="S3.E5.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.cmml" xref="S3.E5.m2.2.2.2.2.2.1.7.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.1.cmml" xref="S3.E5.m2.2.2.2.2.2.1.7.1.1.1.1.1">subscript</csymbol><apply id="S3.E5.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.cmml" xref="S3.E5.m2.2.2.2.2.2.1.7.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.1.cmml" xref="S3.E5.m2.2.2.2.2.2.1.7.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.2.cmml" xref="S3.E5.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.2">𝐀</ci><vector id="S3.E5.m2.2.2.2.2.2.1.4.3.4.cmml" xref="S3.E5.m2.2.2.2.2.2.1.4.3.5"><ci id="S3.E5.m2.2.2.2.2.2.1.2.1.1.cmml" xref="S3.E5.m2.2.2.2.2.2.1.2.1.1">:</ci><ci id="S3.E5.m2.2.2.2.2.2.1.3.2.2.cmml" xref="S3.E5.m2.2.2.2.2.2.1.3.2.2">:</ci><ci id="S3.E5.m2.2.2.2.2.2.1.4.3.3.cmml" xref="S3.E5.m2.2.2.2.2.2.1.4.3.3">𝐢</ci></vector></apply><ci id="S3.E5.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.3.cmml" xref="S3.E5.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.E5.m2.2.2.2.2.2.1.5.1.2.cmml" xref="S3.E5.m2.2.2.2.2.2.1.5.1.3"><csymbol cd="latexml" id="S3.E5.m2.2.2.2.2.2.1.5.1.2.1.cmml" xref="S3.E5.m2.2.2.2.2.2.1.5.1.3.1">delimited-[]</csymbol><ci id="S3.E5.m2.2.2.2.2.2.1.5.1.1.cmml" xref="S3.E5.m2.2.2.2.2.2.1.5.1.1">𝑙</ci></apply></apply><ci id="S3.E5.m2.2.2.2.2.2.1.6.cmml" xref="S3.E5.m2.2.2.2.2.2.1.6">𝑘</ci></interval></apply></apply><apply id="S3.E5.m2.3.3.3.3.1.1.1.1.cmml" xref="S3.E5.m2.3.3.3.3.1.1.1"><minus id="S3.E5.m2.3.3.3.3.1.1.1.1.1.cmml" xref="S3.E5.m2.3.3.3.3.1.1.1"></minus><infinity id="S3.E5.m2.3.3.3.3.1.1.1.1.2.cmml" xref="S3.E5.m2.3.3.3.3.1.1.1.1.2"></infinity></apply><ci id="S3.E5.m2.4.4.4.4.2.1a.cmml" xref="S3.E5.m2.4.4.4.4.2.1"><mtext id="S3.E5.m2.4.4.4.4.2.1.cmml" xref="S3.E5.m2.4.4.4.4.2.1">otherwise</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m2.4c">\displaystyle=\begin{cases}x,&amp;\text{if }x\in\textrm{topk}_{i\in(n^{l}_{h}n^{l}%
_{w})}(\mathbf{A_{(:,:,i)}}_{t}^{[l]},k),\\
-\infty,&amp;\text{otherwise}\end{cases}</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m2.4d">= { start_ROW start_CELL italic_x , end_CELL start_CELL if italic_x ∈ topk start_POSTSUBSCRIPT italic_i ∈ ( italic_n start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT italic_n start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT ( bold_A start_POSTSUBSCRIPT ( : , : , bold_i ) end_POSTSUBSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT , italic_k ) , end_CELL end_ROW start_ROW start_CELL - ∞ , end_CELL start_CELL otherwise end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.SSS0.Px1.p5">
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p5.6">where <math alttext="\alpha" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p5.1.m1.1"><semantics id="S3.SS2.SSS0.Px1.p5.1.m1.1a"><mi id="S3.SS2.SSS0.Px1.p5.1.m1.1.1" xref="S3.SS2.SSS0.Px1.p5.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p5.1.m1.1b"><ci id="S3.SS2.SSS0.Px1.p5.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p5.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p5.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p5.1.m1.1d">italic_α</annotation></semantics></math> is a learnable parameter to scale the dot product, and <math alttext="\mathbf{A_{(:,:,i)}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p5.2.m2.3"><semantics id="S3.SS2.SSS0.Px1.p5.2.m2.3a"><msub id="S3.SS2.SSS0.Px1.p5.2.m2.3.4" xref="S3.SS2.SSS0.Px1.p5.2.m2.3.4.cmml"><mi id="S3.SS2.SSS0.Px1.p5.2.m2.3.4.2" xref="S3.SS2.SSS0.Px1.p5.2.m2.3.4.2.cmml">𝐀</mi><mrow id="S3.SS2.SSS0.Px1.p5.2.m2.3.3.3.5" xref="S3.SS2.SSS0.Px1.p5.2.m2.3.3.3.4.cmml"><mo id="S3.SS2.SSS0.Px1.p5.2.m2.3.3.3.5.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p5.2.m2.3.3.3.4.cmml">(</mo><mo id="S3.SS2.SSS0.Px1.p5.2.m2.1.1.1.1" rspace="0em" xref="S3.SS2.SSS0.Px1.p5.2.m2.1.1.1.1.cmml">:</mo><mo id="S3.SS2.SSS0.Px1.p5.2.m2.3.3.3.5.2" xref="S3.SS2.SSS0.Px1.p5.2.m2.3.3.3.4.cmml">,</mo><mo id="S3.SS2.SSS0.Px1.p5.2.m2.2.2.2.2" rspace="0em" xref="S3.SS2.SSS0.Px1.p5.2.m2.2.2.2.2.cmml">:</mo><mo id="S3.SS2.SSS0.Px1.p5.2.m2.3.3.3.5.3" xref="S3.SS2.SSS0.Px1.p5.2.m2.3.3.3.4.cmml">,</mo><mi id="S3.SS2.SSS0.Px1.p5.2.m2.3.3.3.3" xref="S3.SS2.SSS0.Px1.p5.2.m2.3.3.3.3.cmml">𝐢</mi><mo id="S3.SS2.SSS0.Px1.p5.2.m2.3.3.3.5.4" stretchy="false" xref="S3.SS2.SSS0.Px1.p5.2.m2.3.3.3.4.cmml">)</mo></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p5.2.m2.3b"><apply id="S3.SS2.SSS0.Px1.p5.2.m2.3.4.cmml" xref="S3.SS2.SSS0.Px1.p5.2.m2.3.4"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p5.2.m2.3.4.1.cmml" xref="S3.SS2.SSS0.Px1.p5.2.m2.3.4">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p5.2.m2.3.4.2.cmml" xref="S3.SS2.SSS0.Px1.p5.2.m2.3.4.2">𝐀</ci><vector id="S3.SS2.SSS0.Px1.p5.2.m2.3.3.3.4.cmml" xref="S3.SS2.SSS0.Px1.p5.2.m2.3.3.3.5"><ci id="S3.SS2.SSS0.Px1.p5.2.m2.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p5.2.m2.1.1.1.1">:</ci><ci id="S3.SS2.SSS0.Px1.p5.2.m2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p5.2.m2.2.2.2.2">:</ci><ci id="S3.SS2.SSS0.Px1.p5.2.m2.3.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p5.2.m2.3.3.3.3">𝐢</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p5.2.m2.3c">\mathbf{A_{(:,:,i)}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p5.2.m2.3d">bold_A start_POSTSUBSCRIPT ( : , : , bold_i ) end_POSTSUBSCRIPT</annotation></semantics></math> denotes the <math alttext="i^{\text{th}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p5.3.m3.1"><semantics id="S3.SS2.SSS0.Px1.p5.3.m3.1a"><msup id="S3.SS2.SSS0.Px1.p5.3.m3.1.1" xref="S3.SS2.SSS0.Px1.p5.3.m3.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p5.3.m3.1.1.2" xref="S3.SS2.SSS0.Px1.p5.3.m3.1.1.2.cmml">i</mi><mtext id="S3.SS2.SSS0.Px1.p5.3.m3.1.1.3" xref="S3.SS2.SSS0.Px1.p5.3.m3.1.1.3a.cmml">th</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p5.3.m3.1b"><apply id="S3.SS2.SSS0.Px1.p5.3.m3.1.1.cmml" xref="S3.SS2.SSS0.Px1.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p5.3.m3.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p5.3.m3.1.1">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p5.3.m3.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p5.3.m3.1.1.2">𝑖</ci><ci id="S3.SS2.SSS0.Px1.p5.3.m3.1.1.3a.cmml" xref="S3.SS2.SSS0.Px1.p5.3.m3.1.1.3"><mtext id="S3.SS2.SSS0.Px1.p5.3.m3.1.1.3.cmml" mathsize="70%" xref="S3.SS2.SSS0.Px1.p5.3.m3.1.1.3">th</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p5.3.m3.1c">i^{\text{th}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p5.3.m3.1d">italic_i start_POSTSUPERSCRIPT th end_POSTSUPERSCRIPT</annotation></semantics></math> patch along the second dimension. <math alttext="\mathbf{A^{*}}_{t}^{[l]}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p5.4.m4.1"><semantics id="S3.SS2.SSS0.Px1.p5.4.m4.1a"><mmultiscripts id="S3.SS2.SSS0.Px1.p5.4.m4.1.2" xref="S3.SS2.SSS0.Px1.p5.4.m4.1.2.cmml"><mi id="S3.SS2.SSS0.Px1.p5.4.m4.1.2.2.2.2" xref="S3.SS2.SSS0.Px1.p5.4.m4.1.2.2.2.2.cmml">𝐀</mi><mrow id="S3.SS2.SSS0.Px1.p5.4.m4.1.2a" xref="S3.SS2.SSS0.Px1.p5.4.m4.1.2.cmml"></mrow><mo id="S3.SS2.SSS0.Px1.p5.4.m4.1.2.2.2.3" xref="S3.SS2.SSS0.Px1.p5.4.m4.1.2.2.2.3.cmml">∗</mo><mi id="S3.SS2.SSS0.Px1.p5.4.m4.1.2.2.3" xref="S3.SS2.SSS0.Px1.p5.4.m4.1.2.2.3.cmml">t</mi><mrow id="S3.SS2.SSS0.Px1.p5.4.m4.1.1.1.3" xref="S3.SS2.SSS0.Px1.p5.4.m4.1.1.1.2.cmml"><mo id="S3.SS2.SSS0.Px1.p5.4.m4.1.1.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p5.4.m4.1.1.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px1.p5.4.m4.1.1.1.1" xref="S3.SS2.SSS0.Px1.p5.4.m4.1.1.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px1.p5.4.m4.1.1.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p5.4.m4.1.1.1.2.1.cmml">]</mo></mrow></mmultiscripts><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p5.4.m4.1b"><apply id="S3.SS2.SSS0.Px1.p5.4.m4.1.2.cmml" xref="S3.SS2.SSS0.Px1.p5.4.m4.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p5.4.m4.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p5.4.m4.1.2">superscript</csymbol><apply id="S3.SS2.SSS0.Px1.p5.4.m4.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p5.4.m4.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p5.4.m4.1.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p5.4.m4.1.2">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p5.4.m4.1.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p5.4.m4.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p5.4.m4.1.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p5.4.m4.1.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p5.4.m4.1.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p5.4.m4.1.2.2.2.2">𝐀</ci><times id="S3.SS2.SSS0.Px1.p5.4.m4.1.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p5.4.m4.1.2.2.2.3"></times></apply><ci id="S3.SS2.SSS0.Px1.p5.4.m4.1.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p5.4.m4.1.2.2.3">𝑡</ci></apply><apply id="S3.SS2.SSS0.Px1.p5.4.m4.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p5.4.m4.1.1.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px1.p5.4.m4.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p5.4.m4.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px1.p5.4.m4.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p5.4.m4.1.1.1.1">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p5.4.m4.1c">\mathbf{A^{*}}_{t}^{[l]}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p5.4.m4.1d">bold_A start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT</annotation></semantics></math> masks the non <span class="ltx_text ltx_font_italic" id="S3.SS2.SSS0.Px1.p5.6.1">top-k</span> scores, and replaces with <math alttext="-\infty" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p5.5.m5.1"><semantics id="S3.SS2.SSS0.Px1.p5.5.m5.1a"><mrow id="S3.SS2.SSS0.Px1.p5.5.m5.1.1" xref="S3.SS2.SSS0.Px1.p5.5.m5.1.1.cmml"><mo id="S3.SS2.SSS0.Px1.p5.5.m5.1.1a" xref="S3.SS2.SSS0.Px1.p5.5.m5.1.1.cmml">−</mo><mi id="S3.SS2.SSS0.Px1.p5.5.m5.1.1.2" mathvariant="normal" xref="S3.SS2.SSS0.Px1.p5.5.m5.1.1.2.cmml">∞</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p5.5.m5.1b"><apply id="S3.SS2.SSS0.Px1.p5.5.m5.1.1.cmml" xref="S3.SS2.SSS0.Px1.p5.5.m5.1.1"><minus id="S3.SS2.SSS0.Px1.p5.5.m5.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p5.5.m5.1.1"></minus><infinity id="S3.SS2.SSS0.Px1.p5.5.m5.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p5.5.m5.1.1.2"></infinity></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p5.5.m5.1c">-\infty</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p5.5.m5.1d">- ∞</annotation></semantics></math> to allow for softmax computation. In other words, each patch is compensated for with respect to its <span class="ltx_text ltx_font_italic" id="S3.SS2.SSS0.Px1.p5.6.2">top-k</span> similar, and salient patches across the trajectory. Such a procedure allows for soft alignment, and encourages each patch to borrow information from its most similar temporal neighbors, i.e., a one-to-<span class="ltx_text ltx_font_italic" id="S3.SS2.SSS0.Px1.p5.6.3">top-k</span> temporal correspondence is learned. Given the <span class="ltx_text ltx_font_italic" id="S3.SS2.SSS0.Px1.p5.6.4">top-k</span> scores, we compute the motion-compensated history states <math alttext="\mathbf{\hat{H}}_{t}^{[l]}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p5.6.m6.1"><semantics id="S3.SS2.SSS0.Px1.p5.6.m6.1a"><msubsup id="S3.SS2.SSS0.Px1.p5.6.m6.1.2" xref="S3.SS2.SSS0.Px1.p5.6.m6.1.2.cmml"><mover accent="true" id="S3.SS2.SSS0.Px1.p5.6.m6.1.2.2.2" xref="S3.SS2.SSS0.Px1.p5.6.m6.1.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px1.p5.6.m6.1.2.2.2.2" xref="S3.SS2.SSS0.Px1.p5.6.m6.1.2.2.2.2.cmml">𝐇</mi><mo id="S3.SS2.SSS0.Px1.p5.6.m6.1.2.2.2.1" xref="S3.SS2.SSS0.Px1.p5.6.m6.1.2.2.2.1.cmml">^</mo></mover><mi id="S3.SS2.SSS0.Px1.p5.6.m6.1.2.2.3" xref="S3.SS2.SSS0.Px1.p5.6.m6.1.2.2.3.cmml">t</mi><mrow id="S3.SS2.SSS0.Px1.p5.6.m6.1.1.1.3" xref="S3.SS2.SSS0.Px1.p5.6.m6.1.1.1.2.cmml"><mo id="S3.SS2.SSS0.Px1.p5.6.m6.1.1.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p5.6.m6.1.1.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px1.p5.6.m6.1.1.1.1" xref="S3.SS2.SSS0.Px1.p5.6.m6.1.1.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px1.p5.6.m6.1.1.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p5.6.m6.1.1.1.2.1.cmml">]</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p5.6.m6.1b"><apply id="S3.SS2.SSS0.Px1.p5.6.m6.1.2.cmml" xref="S3.SS2.SSS0.Px1.p5.6.m6.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p5.6.m6.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p5.6.m6.1.2">superscript</csymbol><apply id="S3.SS2.SSS0.Px1.p5.6.m6.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p5.6.m6.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p5.6.m6.1.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p5.6.m6.1.2">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p5.6.m6.1.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p5.6.m6.1.2.2.2"><ci id="S3.SS2.SSS0.Px1.p5.6.m6.1.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p5.6.m6.1.2.2.2.1">^</ci><ci id="S3.SS2.SSS0.Px1.p5.6.m6.1.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p5.6.m6.1.2.2.2.2">𝐇</ci></apply><ci id="S3.SS2.SSS0.Px1.p5.6.m6.1.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p5.6.m6.1.2.2.3">𝑡</ci></apply><apply id="S3.SS2.SSS0.Px1.p5.6.m6.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p5.6.m6.1.1.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px1.p5.6.m6.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p5.6.m6.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px1.p5.6.m6.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p5.6.m6.1.1.1.1">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p5.6.m6.1c">\mathbf{\hat{H}}_{t}^{[l]}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p5.6.m6.1d">over^ start_ARG bold_H end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT</annotation></semantics></math> as follows,</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A7.EGx4">
<tbody id="S3.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{\hat{H}}_{t}^{[l]}" class="ltx_Math" display="inline" id="S3.E6.m1.1"><semantics id="S3.E6.m1.1a"><msubsup id="S3.E6.m1.1.2" xref="S3.E6.m1.1.2.cmml"><mover accent="true" id="S3.E6.m1.1.2.2.2" xref="S3.E6.m1.1.2.2.2.cmml"><mi id="S3.E6.m1.1.2.2.2.2" xref="S3.E6.m1.1.2.2.2.2.cmml">𝐇</mi><mo id="S3.E6.m1.1.2.2.2.1" xref="S3.E6.m1.1.2.2.2.1.cmml">^</mo></mover><mi id="S3.E6.m1.1.2.2.3" xref="S3.E6.m1.1.2.2.3.cmml">t</mi><mrow id="S3.E6.m1.1.1.1.3" xref="S3.E6.m1.1.1.1.2.cmml"><mo id="S3.E6.m1.1.1.1.3.1" stretchy="false" xref="S3.E6.m1.1.1.1.2.1.cmml">[</mo><mi id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml">l</mi><mo id="S3.E6.m1.1.1.1.3.2" stretchy="false" xref="S3.E6.m1.1.1.1.2.1.cmml">]</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.2.cmml" xref="S3.E6.m1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.2.1.cmml" xref="S3.E6.m1.1.2">superscript</csymbol><apply id="S3.E6.m1.1.2.2.cmml" xref="S3.E6.m1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.2.2.1.cmml" xref="S3.E6.m1.1.2">subscript</csymbol><apply id="S3.E6.m1.1.2.2.2.cmml" xref="S3.E6.m1.1.2.2.2"><ci id="S3.E6.m1.1.2.2.2.1.cmml" xref="S3.E6.m1.1.2.2.2.1">^</ci><ci id="S3.E6.m1.1.2.2.2.2.cmml" xref="S3.E6.m1.1.2.2.2.2">𝐇</ci></apply><ci id="S3.E6.m1.1.2.2.3.cmml" xref="S3.E6.m1.1.2.2.3">𝑡</ci></apply><apply id="S3.E6.m1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.3"><csymbol cd="latexml" id="S3.E6.m1.1.1.1.2.1.cmml" xref="S3.E6.m1.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">\displaystyle\mathbf{\hat{H}}_{t}^{[l]}</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.1d">over^ start_ARG bold_H end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\left[\sigma(\mathbf{A^{*}}_{t}^{[l]})\mathbf{V}^{[l]}_{\mathbf{%
H}_{t}}\right]W^{\mathbf{\hat{H}}_{t}^{[l]}}\oplus\mathcal{B}_{t}(\mathbf{F}_{%
t}^{[l]})," class="ltx_Math" display="inline" id="S3.E6.m2.5"><semantics id="S3.E6.m2.5a"><mrow id="S3.E6.m2.5.5.1" xref="S3.E6.m2.5.5.1.1.cmml"><mrow id="S3.E6.m2.5.5.1.1" xref="S3.E6.m2.5.5.1.1.cmml"><mi id="S3.E6.m2.5.5.1.1.4" xref="S3.E6.m2.5.5.1.1.4.cmml"></mi><mo id="S3.E6.m2.5.5.1.1.3" xref="S3.E6.m2.5.5.1.1.3.cmml">=</mo><mrow id="S3.E6.m2.5.5.1.1.2" xref="S3.E6.m2.5.5.1.1.2.cmml"><mrow id="S3.E6.m2.5.5.1.1.1.1" xref="S3.E6.m2.5.5.1.1.1.1.cmml"><mrow id="S3.E6.m2.5.5.1.1.1.1.1.1" xref="S3.E6.m2.5.5.1.1.1.1.1.2.cmml"><mo id="S3.E6.m2.5.5.1.1.1.1.1.1.2" xref="S3.E6.m2.5.5.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E6.m2.5.5.1.1.1.1.1.1.1" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.cmml"><mi id="S3.E6.m2.5.5.1.1.1.1.1.1.1.3" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.3.cmml">σ</mi><mo id="S3.E6.m2.5.5.1.1.1.1.1.1.1.2" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E6.m2.5.5.1.1.1.1.1.1.1.1.1" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E6.m2.5.5.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mmultiscripts id="S3.E6.m2.5.5.1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E6.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝐀</mi><mrow id="S3.E6.m2.5.5.1.1.1.1.1.1.1.1.1.1a" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.1.1.1.cmml"></mrow><mo id="S3.E6.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">∗</mo><mi id="S3.E6.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi><mrow id="S3.E6.m2.1.1.1.3" xref="S3.E6.m2.1.1.1.2.cmml"><mo id="S3.E6.m2.1.1.1.3.1" stretchy="false" xref="S3.E6.m2.1.1.1.2.1.cmml">[</mo><mi id="S3.E6.m2.1.1.1.1" xref="S3.E6.m2.1.1.1.1.cmml">l</mi><mo id="S3.E6.m2.1.1.1.3.2" stretchy="false" xref="S3.E6.m2.1.1.1.2.1.cmml">]</mo></mrow></mmultiscripts><mo id="S3.E6.m2.5.5.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E6.m2.5.5.1.1.1.1.1.1.1.2a" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.cmml">⁢</mo><msubsup id="S3.E6.m2.5.5.1.1.1.1.1.1.1.4" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.4.cmml"><mi id="S3.E6.m2.5.5.1.1.1.1.1.1.1.4.2.2" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.4.2.2.cmml">𝐕</mi><msub id="S3.E6.m2.5.5.1.1.1.1.1.1.1.4.3" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.4.3.cmml"><mi id="S3.E6.m2.5.5.1.1.1.1.1.1.1.4.3.2" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.4.3.2.cmml">𝐇</mi><mi id="S3.E6.m2.5.5.1.1.1.1.1.1.1.4.3.3" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.4.3.3.cmml">t</mi></msub><mrow id="S3.E6.m2.2.2.1.3" xref="S3.E6.m2.2.2.1.2.cmml"><mo id="S3.E6.m2.2.2.1.3.1" stretchy="false" xref="S3.E6.m2.2.2.1.2.1.cmml">[</mo><mi id="S3.E6.m2.2.2.1.1" xref="S3.E6.m2.2.2.1.1.cmml">l</mi><mo id="S3.E6.m2.2.2.1.3.2" stretchy="false" xref="S3.E6.m2.2.2.1.2.1.cmml">]</mo></mrow></msubsup></mrow><mo id="S3.E6.m2.5.5.1.1.1.1.1.1.3" xref="S3.E6.m2.5.5.1.1.1.1.1.2.1.cmml">]</mo></mrow><mo id="S3.E6.m2.5.5.1.1.1.1.2" xref="S3.E6.m2.5.5.1.1.1.1.2.cmml">⁢</mo><msup id="S3.E6.m2.5.5.1.1.1.1.3" xref="S3.E6.m2.5.5.1.1.1.1.3.cmml"><mi id="S3.E6.m2.5.5.1.1.1.1.3.2" xref="S3.E6.m2.5.5.1.1.1.1.3.2.cmml">W</mi><msubsup id="S3.E6.m2.3.3.1" xref="S3.E6.m2.3.3.1.cmml"><mover accent="true" id="S3.E6.m2.3.3.1.3.2" xref="S3.E6.m2.3.3.1.3.2.cmml"><mi id="S3.E6.m2.3.3.1.3.2.2" xref="S3.E6.m2.3.3.1.3.2.2.cmml">𝐇</mi><mo id="S3.E6.m2.3.3.1.3.2.1" xref="S3.E6.m2.3.3.1.3.2.1.cmml">^</mo></mover><mi id="S3.E6.m2.3.3.1.3.3" xref="S3.E6.m2.3.3.1.3.3.cmml">t</mi><mrow id="S3.E6.m2.3.3.1.1.1.3" xref="S3.E6.m2.3.3.1.1.1.2.cmml"><mo id="S3.E6.m2.3.3.1.1.1.3.1" stretchy="false" xref="S3.E6.m2.3.3.1.1.1.2.1.cmml">[</mo><mi id="S3.E6.m2.3.3.1.1.1.1" xref="S3.E6.m2.3.3.1.1.1.1.cmml">l</mi><mo id="S3.E6.m2.3.3.1.1.1.3.2" stretchy="false" xref="S3.E6.m2.3.3.1.1.1.2.1.cmml">]</mo></mrow></msubsup></msup></mrow><mo id="S3.E6.m2.5.5.1.1.2.3" xref="S3.E6.m2.5.5.1.1.2.3.cmml">⊕</mo><mrow id="S3.E6.m2.5.5.1.1.2.2" xref="S3.E6.m2.5.5.1.1.2.2.cmml"><msub id="S3.E6.m2.5.5.1.1.2.2.3" xref="S3.E6.m2.5.5.1.1.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m2.5.5.1.1.2.2.3.2" xref="S3.E6.m2.5.5.1.1.2.2.3.2.cmml">ℬ</mi><mi id="S3.E6.m2.5.5.1.1.2.2.3.3" xref="S3.E6.m2.5.5.1.1.2.2.3.3.cmml">t</mi></msub><mo id="S3.E6.m2.5.5.1.1.2.2.2" xref="S3.E6.m2.5.5.1.1.2.2.2.cmml">⁢</mo><mrow id="S3.E6.m2.5.5.1.1.2.2.1.1" xref="S3.E6.m2.5.5.1.1.2.2.1.1.1.cmml"><mo id="S3.E6.m2.5.5.1.1.2.2.1.1.2" stretchy="false" xref="S3.E6.m2.5.5.1.1.2.2.1.1.1.cmml">(</mo><msubsup id="S3.E6.m2.5.5.1.1.2.2.1.1.1" xref="S3.E6.m2.5.5.1.1.2.2.1.1.1.cmml"><mi id="S3.E6.m2.5.5.1.1.2.2.1.1.1.2.2" xref="S3.E6.m2.5.5.1.1.2.2.1.1.1.2.2.cmml">𝐅</mi><mi id="S3.E6.m2.5.5.1.1.2.2.1.1.1.2.3" xref="S3.E6.m2.5.5.1.1.2.2.1.1.1.2.3.cmml">t</mi><mrow id="S3.E6.m2.4.4.1.3" xref="S3.E6.m2.4.4.1.2.cmml"><mo id="S3.E6.m2.4.4.1.3.1" stretchy="false" xref="S3.E6.m2.4.4.1.2.1.cmml">[</mo><mi id="S3.E6.m2.4.4.1.1" xref="S3.E6.m2.4.4.1.1.cmml">l</mi><mo id="S3.E6.m2.4.4.1.3.2" stretchy="false" xref="S3.E6.m2.4.4.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.E6.m2.5.5.1.1.2.2.1.1.3" stretchy="false" xref="S3.E6.m2.5.5.1.1.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E6.m2.5.5.1.2" xref="S3.E6.m2.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m2.5b"><apply id="S3.E6.m2.5.5.1.1.cmml" xref="S3.E6.m2.5.5.1"><eq id="S3.E6.m2.5.5.1.1.3.cmml" xref="S3.E6.m2.5.5.1.1.3"></eq><csymbol cd="latexml" id="S3.E6.m2.5.5.1.1.4.cmml" xref="S3.E6.m2.5.5.1.1.4">absent</csymbol><apply id="S3.E6.m2.5.5.1.1.2.cmml" xref="S3.E6.m2.5.5.1.1.2"><csymbol cd="latexml" id="S3.E6.m2.5.5.1.1.2.3.cmml" xref="S3.E6.m2.5.5.1.1.2.3">direct-sum</csymbol><apply id="S3.E6.m2.5.5.1.1.1.1.cmml" xref="S3.E6.m2.5.5.1.1.1.1"><times id="S3.E6.m2.5.5.1.1.1.1.2.cmml" xref="S3.E6.m2.5.5.1.1.1.1.2"></times><apply id="S3.E6.m2.5.5.1.1.1.1.1.2.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E6.m2.5.5.1.1.1.1.1.2.1.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E6.m2.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1"><times id="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.2"></times><ci id="S3.E6.m2.5.5.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.3">𝜎</ci><apply id="S3.E6.m2.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E6.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E6.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E6.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.2.2">𝐀</ci><times id="S3.E6.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.2.3"></times></apply><ci id="S3.E6.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.E6.m2.1.1.1.2.cmml" xref="S3.E6.m2.1.1.1.3"><csymbol cd="latexml" id="S3.E6.m2.1.1.1.2.1.cmml" xref="S3.E6.m2.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.E6.m2.1.1.1.1.cmml" xref="S3.E6.m2.1.1.1.1">𝑙</ci></apply></apply><apply id="S3.E6.m2.5.5.1.1.1.1.1.1.1.4.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E6.m2.5.5.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.4">subscript</csymbol><apply id="S3.E6.m2.5.5.1.1.1.1.1.1.1.4.2.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E6.m2.5.5.1.1.1.1.1.1.1.4.2.1.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.4">superscript</csymbol><ci id="S3.E6.m2.5.5.1.1.1.1.1.1.1.4.2.2.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.4.2.2">𝐕</ci><apply id="S3.E6.m2.2.2.1.2.cmml" xref="S3.E6.m2.2.2.1.3"><csymbol cd="latexml" id="S3.E6.m2.2.2.1.2.1.cmml" xref="S3.E6.m2.2.2.1.3.1">delimited-[]</csymbol><ci id="S3.E6.m2.2.2.1.1.cmml" xref="S3.E6.m2.2.2.1.1">𝑙</ci></apply></apply><apply id="S3.E6.m2.5.5.1.1.1.1.1.1.1.4.3.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.4.3"><csymbol cd="ambiguous" id="S3.E6.m2.5.5.1.1.1.1.1.1.1.4.3.1.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.4.3">subscript</csymbol><ci id="S3.E6.m2.5.5.1.1.1.1.1.1.1.4.3.2.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.4.3.2">𝐇</ci><ci id="S3.E6.m2.5.5.1.1.1.1.1.1.1.4.3.3.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.4.3.3">𝑡</ci></apply></apply></apply></apply><apply id="S3.E6.m2.5.5.1.1.1.1.3.cmml" xref="S3.E6.m2.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m2.5.5.1.1.1.1.3.1.cmml" xref="S3.E6.m2.5.5.1.1.1.1.3">superscript</csymbol><ci id="S3.E6.m2.5.5.1.1.1.1.3.2.cmml" xref="S3.E6.m2.5.5.1.1.1.1.3.2">𝑊</ci><apply id="S3.E6.m2.3.3.1.cmml" xref="S3.E6.m2.3.3.1"><csymbol cd="ambiguous" id="S3.E6.m2.3.3.1.2.cmml" xref="S3.E6.m2.3.3.1">superscript</csymbol><apply id="S3.E6.m2.3.3.1.3.cmml" xref="S3.E6.m2.3.3.1"><csymbol cd="ambiguous" id="S3.E6.m2.3.3.1.3.1.cmml" xref="S3.E6.m2.3.3.1">subscript</csymbol><apply id="S3.E6.m2.3.3.1.3.2.cmml" xref="S3.E6.m2.3.3.1.3.2"><ci id="S3.E6.m2.3.3.1.3.2.1.cmml" xref="S3.E6.m2.3.3.1.3.2.1">^</ci><ci id="S3.E6.m2.3.3.1.3.2.2.cmml" xref="S3.E6.m2.3.3.1.3.2.2">𝐇</ci></apply><ci id="S3.E6.m2.3.3.1.3.3.cmml" xref="S3.E6.m2.3.3.1.3.3">𝑡</ci></apply><apply id="S3.E6.m2.3.3.1.1.1.2.cmml" xref="S3.E6.m2.3.3.1.1.1.3"><csymbol cd="latexml" id="S3.E6.m2.3.3.1.1.1.2.1.cmml" xref="S3.E6.m2.3.3.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.E6.m2.3.3.1.1.1.1.cmml" xref="S3.E6.m2.3.3.1.1.1.1">𝑙</ci></apply></apply></apply></apply><apply id="S3.E6.m2.5.5.1.1.2.2.cmml" xref="S3.E6.m2.5.5.1.1.2.2"><times id="S3.E6.m2.5.5.1.1.2.2.2.cmml" xref="S3.E6.m2.5.5.1.1.2.2.2"></times><apply id="S3.E6.m2.5.5.1.1.2.2.3.cmml" xref="S3.E6.m2.5.5.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E6.m2.5.5.1.1.2.2.3.1.cmml" xref="S3.E6.m2.5.5.1.1.2.2.3">subscript</csymbol><ci id="S3.E6.m2.5.5.1.1.2.2.3.2.cmml" xref="S3.E6.m2.5.5.1.1.2.2.3.2">ℬ</ci><ci id="S3.E6.m2.5.5.1.1.2.2.3.3.cmml" xref="S3.E6.m2.5.5.1.1.2.2.3.3">𝑡</ci></apply><apply id="S3.E6.m2.5.5.1.1.2.2.1.1.1.cmml" xref="S3.E6.m2.5.5.1.1.2.2.1.1"><csymbol cd="ambiguous" id="S3.E6.m2.5.5.1.1.2.2.1.1.1.1.cmml" xref="S3.E6.m2.5.5.1.1.2.2.1.1">superscript</csymbol><apply id="S3.E6.m2.5.5.1.1.2.2.1.1.1.2.cmml" xref="S3.E6.m2.5.5.1.1.2.2.1.1"><csymbol cd="ambiguous" id="S3.E6.m2.5.5.1.1.2.2.1.1.1.2.1.cmml" xref="S3.E6.m2.5.5.1.1.2.2.1.1">subscript</csymbol><ci id="S3.E6.m2.5.5.1.1.2.2.1.1.1.2.2.cmml" xref="S3.E6.m2.5.5.1.1.2.2.1.1.1.2.2">𝐅</ci><ci id="S3.E6.m2.5.5.1.1.2.2.1.1.1.2.3.cmml" xref="S3.E6.m2.5.5.1.1.2.2.1.1.1.2.3">𝑡</ci></apply><apply id="S3.E6.m2.4.4.1.2.cmml" xref="S3.E6.m2.4.4.1.3"><csymbol cd="latexml" id="S3.E6.m2.4.4.1.2.1.cmml" xref="S3.E6.m2.4.4.1.3.1">delimited-[]</csymbol><ci id="S3.E6.m2.4.4.1.1.cmml" xref="S3.E6.m2.4.4.1.1">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m2.5c">\displaystyle=\left[\sigma(\mathbf{A^{*}}_{t}^{[l]})\mathbf{V}^{[l]}_{\mathbf{%
H}_{t}}\right]W^{\mathbf{\hat{H}}_{t}^{[l]}}\oplus\mathcal{B}_{t}(\mathbf{F}_{%
t}^{[l]}),</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m2.5d">= [ italic_σ ( bold_A start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT ) bold_V start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT bold_H start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT ] italic_W start_POSTSUPERSCRIPT over^ start_ARG bold_H end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT ⊕ caligraphic_B start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_F start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.SSS0.Px1.p6">
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p6.6">where <math alttext="\sigma" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p6.1.m1.1"><semantics id="S3.SS2.SSS0.Px1.p6.1.m1.1a"><mi id="S3.SS2.SSS0.Px1.p6.1.m1.1.1" xref="S3.SS2.SSS0.Px1.p6.1.m1.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p6.1.m1.1b"><ci id="S3.SS2.SSS0.Px1.p6.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p6.1.m1.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p6.1.m1.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p6.1.m1.1d">italic_σ</annotation></semantics></math> is the softmax operator, <math alttext="\oplus" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p6.2.m2.1"><semantics id="S3.SS2.SSS0.Px1.p6.2.m2.1a"><mo id="S3.SS2.SSS0.Px1.p6.2.m2.1.1" xref="S3.SS2.SSS0.Px1.p6.2.m2.1.1.cmml">⊕</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p6.2.m2.1b"><csymbol cd="latexml" id="S3.SS2.SSS0.Px1.p6.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p6.2.m2.1.1">direct-sum</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p6.2.m2.1c">\oplus</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p6.2.m2.1d">⊕</annotation></semantics></math> is the concatenation operator, <math alttext="W^{\mathbf{\hat{H}}_{t}^{[l]}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p6.3.m3.1"><semantics id="S3.SS2.SSS0.Px1.p6.3.m3.1a"><msup id="S3.SS2.SSS0.Px1.p6.3.m3.1.2" xref="S3.SS2.SSS0.Px1.p6.3.m3.1.2.cmml"><mi id="S3.SS2.SSS0.Px1.p6.3.m3.1.2.2" xref="S3.SS2.SSS0.Px1.p6.3.m3.1.2.2.cmml">W</mi><msubsup id="S3.SS2.SSS0.Px1.p6.3.m3.1.1.1" xref="S3.SS2.SSS0.Px1.p6.3.m3.1.1.1.cmml"><mover accent="true" id="S3.SS2.SSS0.Px1.p6.3.m3.1.1.1.3.2" xref="S3.SS2.SSS0.Px1.p6.3.m3.1.1.1.3.2.cmml"><mi id="S3.SS2.SSS0.Px1.p6.3.m3.1.1.1.3.2.2" xref="S3.SS2.SSS0.Px1.p6.3.m3.1.1.1.3.2.2.cmml">𝐇</mi><mo id="S3.SS2.SSS0.Px1.p6.3.m3.1.1.1.3.2.1" xref="S3.SS2.SSS0.Px1.p6.3.m3.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.SS2.SSS0.Px1.p6.3.m3.1.1.1.3.3" xref="S3.SS2.SSS0.Px1.p6.3.m3.1.1.1.3.3.cmml">t</mi><mrow id="S3.SS2.SSS0.Px1.p6.3.m3.1.1.1.1.1.3" xref="S3.SS2.SSS0.Px1.p6.3.m3.1.1.1.1.1.2.cmml"><mo id="S3.SS2.SSS0.Px1.p6.3.m3.1.1.1.1.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p6.3.m3.1.1.1.1.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px1.p6.3.m3.1.1.1.1.1.1" xref="S3.SS2.SSS0.Px1.p6.3.m3.1.1.1.1.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px1.p6.3.m3.1.1.1.1.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p6.3.m3.1.1.1.1.1.2.1.cmml">]</mo></mrow></msubsup></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p6.3.m3.1b"><apply id="S3.SS2.SSS0.Px1.p6.3.m3.1.2.cmml" xref="S3.SS2.SSS0.Px1.p6.3.m3.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p6.3.m3.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p6.3.m3.1.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p6.3.m3.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p6.3.m3.1.2.2">𝑊</ci><apply id="S3.SS2.SSS0.Px1.p6.3.m3.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p6.3.m3.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p6.3.m3.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p6.3.m3.1.1.1">superscript</csymbol><apply id="S3.SS2.SSS0.Px1.p6.3.m3.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p6.3.m3.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p6.3.m3.1.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px1.p6.3.m3.1.1.1">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p6.3.m3.1.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px1.p6.3.m3.1.1.1.3.2"><ci id="S3.SS2.SSS0.Px1.p6.3.m3.1.1.1.3.2.1.cmml" xref="S3.SS2.SSS0.Px1.p6.3.m3.1.1.1.3.2.1">^</ci><ci id="S3.SS2.SSS0.Px1.p6.3.m3.1.1.1.3.2.2.cmml" xref="S3.SS2.SSS0.Px1.p6.3.m3.1.1.1.3.2.2">𝐇</ci></apply><ci id="S3.SS2.SSS0.Px1.p6.3.m3.1.1.1.3.3.cmml" xref="S3.SS2.SSS0.Px1.p6.3.m3.1.1.1.3.3">𝑡</ci></apply><apply id="S3.SS2.SSS0.Px1.p6.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p6.3.m3.1.1.1.1.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px1.p6.3.m3.1.1.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p6.3.m3.1.1.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px1.p6.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p6.3.m3.1.1.1.1.1.1">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p6.3.m3.1c">W^{\mathbf{\hat{H}}_{t}^{[l]}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p6.3.m3.1d">italic_W start_POSTSUPERSCRIPT over^ start_ARG bold_H end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> is the parameter matrix learned with gradient descent, and <math alttext="\mathcal{B}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p6.4.m4.1"><semantics id="S3.SS2.SSS0.Px1.p6.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS0.Px1.p6.4.m4.1.1" xref="S3.SS2.SSS0.Px1.p6.4.m4.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p6.4.m4.1b"><ci id="S3.SS2.SSS0.Px1.p6.4.m4.1.1.cmml" xref="S3.SS2.SSS0.Px1.p6.4.m4.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p6.4.m4.1c">\mathcal{B}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p6.4.m4.1d">caligraphic_B</annotation></semantics></math> is a transformation on the input <math alttext="\mathbf{F}^{[l]}_{t}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p6.5.m5.1"><semantics id="S3.SS2.SSS0.Px1.p6.5.m5.1a"><msubsup id="S3.SS2.SSS0.Px1.p6.5.m5.1.2" xref="S3.SS2.SSS0.Px1.p6.5.m5.1.2.cmml"><mi id="S3.SS2.SSS0.Px1.p6.5.m5.1.2.2.2" xref="S3.SS2.SSS0.Px1.p6.5.m5.1.2.2.2.cmml">𝐅</mi><mi id="S3.SS2.SSS0.Px1.p6.5.m5.1.2.3" xref="S3.SS2.SSS0.Px1.p6.5.m5.1.2.3.cmml">t</mi><mrow id="S3.SS2.SSS0.Px1.p6.5.m5.1.1.1.3" xref="S3.SS2.SSS0.Px1.p6.5.m5.1.1.1.2.cmml"><mo id="S3.SS2.SSS0.Px1.p6.5.m5.1.1.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p6.5.m5.1.1.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px1.p6.5.m5.1.1.1.1" xref="S3.SS2.SSS0.Px1.p6.5.m5.1.1.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px1.p6.5.m5.1.1.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p6.5.m5.1.1.1.2.1.cmml">]</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p6.5.m5.1b"><apply id="S3.SS2.SSS0.Px1.p6.5.m5.1.2.cmml" xref="S3.SS2.SSS0.Px1.p6.5.m5.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p6.5.m5.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p6.5.m5.1.2">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p6.5.m5.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p6.5.m5.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p6.5.m5.1.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p6.5.m5.1.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p6.5.m5.1.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p6.5.m5.1.2.2.2">𝐅</ci><apply id="S3.SS2.SSS0.Px1.p6.5.m5.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p6.5.m5.1.1.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px1.p6.5.m5.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p6.5.m5.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px1.p6.5.m5.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p6.5.m5.1.1.1.1">𝑙</ci></apply></apply><ci id="S3.SS2.SSS0.Px1.p6.5.m5.1.2.3.cmml" xref="S3.SS2.SSS0.Px1.p6.5.m5.1.2.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p6.5.m5.1c">\mathbf{F}^{[l]}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p6.5.m5.1d">bold_F start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> realized through self-attention along the spatial dimensions <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib39" title="">39</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib66" title="">66</a>]</cite>. In <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S3.E6" title="In State Align Block (ϕ). ‣ 3.2 Causal History Model ‣ 3 Methodology ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">eq.</span> <span class="ltx_text ltx_ref_tag">6</span></a>, <math alttext="\phi_{t}(\mathbf{H}_{t}^{[l]},\mathbf{F}_{t}^{[l]})=\left[\sigma(\mathbf{A^{*}%
}_{t}^{[l]})\mathbf{V}^{[l]}_{\mathbf{H}_{t}}\right]W^{\mathbf{\hat{H}}_{t}^{[%
l]}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p6.6.m6.8"><semantics id="S3.SS2.SSS0.Px1.p6.6.m6.8a"><mrow id="S3.SS2.SSS0.Px1.p6.6.m6.8.8" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.cmml"><mrow id="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2" xref="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2.cmml"><msub id="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2.4" xref="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2.4.cmml"><mi id="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2.4.2" xref="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2.4.2.cmml">ϕ</mi><mi id="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2.4.3" xref="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2.4.3.cmml">t</mi></msub><mo id="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2.3" xref="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2.3.cmml">⁢</mo><mrow id="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2.2.2" xref="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2.2.3.cmml"><mo id="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2.2.2.3" stretchy="false" xref="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2.2.3.cmml">(</mo><msubsup id="S3.SS2.SSS0.Px1.p6.6.m6.6.6.1.1.1.1" xref="S3.SS2.SSS0.Px1.p6.6.m6.6.6.1.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p6.6.m6.6.6.1.1.1.1.2.2" xref="S3.SS2.SSS0.Px1.p6.6.m6.6.6.1.1.1.1.2.2.cmml">𝐇</mi><mi id="S3.SS2.SSS0.Px1.p6.6.m6.6.6.1.1.1.1.2.3" xref="S3.SS2.SSS0.Px1.p6.6.m6.6.6.1.1.1.1.2.3.cmml">t</mi><mrow id="S3.SS2.SSS0.Px1.p6.6.m6.1.1.1.3" xref="S3.SS2.SSS0.Px1.p6.6.m6.1.1.1.2.cmml"><mo id="S3.SS2.SSS0.Px1.p6.6.m6.1.1.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p6.6.m6.1.1.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px1.p6.6.m6.1.1.1.1" xref="S3.SS2.SSS0.Px1.p6.6.m6.1.1.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px1.p6.6.m6.1.1.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p6.6.m6.1.1.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2.2.2.4" xref="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2.2.3.cmml">,</mo><msubsup id="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2.2.2.2" xref="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2.2.2.2.2.2" xref="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2.2.2.2.2.2.cmml">𝐅</mi><mi id="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2.2.2.2.2.3" xref="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2.2.2.2.2.3.cmml">t</mi><mrow id="S3.SS2.SSS0.Px1.p6.6.m6.2.2.1.3" xref="S3.SS2.SSS0.Px1.p6.6.m6.2.2.1.2.cmml"><mo id="S3.SS2.SSS0.Px1.p6.6.m6.2.2.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p6.6.m6.2.2.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px1.p6.6.m6.2.2.1.1" xref="S3.SS2.SSS0.Px1.p6.6.m6.2.2.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px1.p6.6.m6.2.2.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p6.6.m6.2.2.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2.2.2.5" stretchy="false" xref="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.4" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.4.cmml">=</mo><mrow id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.cmml"><mrow id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.2.cmml"><mo id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.2" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.2.1.cmml">[</mo><mrow id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.3" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.3.cmml">σ</mi><mo id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.2" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.1.1" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.1.1.1.cmml">(</mo><mmultiscripts id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.1.1.1" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.1.1.1.2.2.2" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.1.1.1.2.2.2.cmml">𝐀</mi><mrow id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.1.1.1a" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.1.1.1.cmml"></mrow><mo id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.1.1.1.2.2.3" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.1.1.1.2.2.3.cmml">∗</mo><mi id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.1.1.1.2.3" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.1.1.1.2.3.cmml">t</mi><mrow id="S3.SS2.SSS0.Px1.p6.6.m6.3.3.1.3" xref="S3.SS2.SSS0.Px1.p6.6.m6.3.3.1.2.cmml"><mo id="S3.SS2.SSS0.Px1.p6.6.m6.3.3.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p6.6.m6.3.3.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px1.p6.6.m6.3.3.1.1" xref="S3.SS2.SSS0.Px1.p6.6.m6.3.3.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px1.p6.6.m6.3.3.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p6.6.m6.3.3.1.2.1.cmml">]</mo></mrow></mmultiscripts><mo id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.2a" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.2.cmml">⁢</mo><msubsup id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.4" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.4.cmml"><mi id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.4.2.2" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.4.2.2.cmml">𝐕</mi><msub id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.4.3" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.4.3.cmml"><mi id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.4.3.2" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.4.3.2.cmml">𝐇</mi><mi id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.4.3.3" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.4.3.3.cmml">t</mi></msub><mrow id="S3.SS2.SSS0.Px1.p6.6.m6.4.4.1.3" xref="S3.SS2.SSS0.Px1.p6.6.m6.4.4.1.2.cmml"><mo id="S3.SS2.SSS0.Px1.p6.6.m6.4.4.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p6.6.m6.4.4.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px1.p6.6.m6.4.4.1.1" xref="S3.SS2.SSS0.Px1.p6.6.m6.4.4.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px1.p6.6.m6.4.4.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p6.6.m6.4.4.1.2.1.cmml">]</mo></mrow></msubsup></mrow><mo id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.3" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.2.1.cmml">]</mo></mrow><mo id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.2" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.2.cmml">⁢</mo><msup id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.3" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.3.cmml"><mi id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.3.2" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.3.2.cmml">W</mi><msubsup id="S3.SS2.SSS0.Px1.p6.6.m6.5.5.1" xref="S3.SS2.SSS0.Px1.p6.6.m6.5.5.1.cmml"><mover accent="true" id="S3.SS2.SSS0.Px1.p6.6.m6.5.5.1.3.2" xref="S3.SS2.SSS0.Px1.p6.6.m6.5.5.1.3.2.cmml"><mi id="S3.SS2.SSS0.Px1.p6.6.m6.5.5.1.3.2.2" xref="S3.SS2.SSS0.Px1.p6.6.m6.5.5.1.3.2.2.cmml">𝐇</mi><mo id="S3.SS2.SSS0.Px1.p6.6.m6.5.5.1.3.2.1" xref="S3.SS2.SSS0.Px1.p6.6.m6.5.5.1.3.2.1.cmml">^</mo></mover><mi id="S3.SS2.SSS0.Px1.p6.6.m6.5.5.1.3.3" xref="S3.SS2.SSS0.Px1.p6.6.m6.5.5.1.3.3.cmml">t</mi><mrow id="S3.SS2.SSS0.Px1.p6.6.m6.5.5.1.1.1.3" xref="S3.SS2.SSS0.Px1.p6.6.m6.5.5.1.1.1.2.cmml"><mo id="S3.SS2.SSS0.Px1.p6.6.m6.5.5.1.1.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p6.6.m6.5.5.1.1.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px1.p6.6.m6.5.5.1.1.1.1" xref="S3.SS2.SSS0.Px1.p6.6.m6.5.5.1.1.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px1.p6.6.m6.5.5.1.1.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p6.6.m6.5.5.1.1.1.2.1.cmml">]</mo></mrow></msubsup></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p6.6.m6.8b"><apply id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8"><eq id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.4.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.4"></eq><apply id="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2"><times id="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2.3.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2.3"></times><apply id="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2.4.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2.4"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2.4.1.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2.4">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2.4.2.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2.4.2">italic-ϕ</ci><ci id="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2.4.3.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2.4.3">𝑡</ci></apply><interval closure="open" id="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2.2.2"><apply id="S3.SS2.SSS0.Px1.p6.6.m6.6.6.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.6.6.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p6.6.m6.6.6.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.6.6.1.1.1.1">superscript</csymbol><apply id="S3.SS2.SSS0.Px1.p6.6.m6.6.6.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.6.6.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p6.6.m6.6.6.1.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.6.6.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p6.6.m6.6.6.1.1.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.6.6.1.1.1.1.2.2">𝐇</ci><ci id="S3.SS2.SSS0.Px1.p6.6.m6.6.6.1.1.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.6.6.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.SS2.SSS0.Px1.p6.6.m6.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.1.1.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px1.p6.6.m6.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px1.p6.6.m6.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.1.1.1.1">𝑙</ci></apply></apply><apply id="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2.2.2.2">superscript</csymbol><apply id="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2.2.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2.2.2.2.2.2">𝐅</ci><ci id="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2.2.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.7.7.2.2.2.2.2.3">𝑡</ci></apply><apply id="S3.SS2.SSS0.Px1.p6.6.m6.2.2.1.2.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.2.2.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px1.p6.6.m6.2.2.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.2.2.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px1.p6.6.m6.2.2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.2.2.1.1">𝑙</ci></apply></apply></interval></apply><apply id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3"><times id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.2.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.2"></times><apply id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.2.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1"><csymbol cd="latexml" id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.2">delimited-[]</csymbol><apply id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1"><times id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.2"></times><ci id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.3">𝜎</ci><apply id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.1.1">superscript</csymbol><apply id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.1.1">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.1.1.1.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.1.1">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.1.1.1.2.2.2">𝐀</ci><times id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.1.1.1.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.1.1.1.2.2.3"></times></apply><ci id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.1.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.SS2.SSS0.Px1.p6.6.m6.3.3.1.2.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.3.3.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px1.p6.6.m6.3.3.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.3.3.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px1.p6.6.m6.3.3.1.1.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.3.3.1.1">𝑙</ci></apply></apply><apply id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.4.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.4.1.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.4">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.4.2.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.4.2.1.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.4">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.4.2.2.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.4.2.2">𝐕</ci><apply id="S3.SS2.SSS0.Px1.p6.6.m6.4.4.1.2.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.4.4.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px1.p6.6.m6.4.4.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.4.4.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px1.p6.6.m6.4.4.1.1.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.4.4.1.1">𝑙</ci></apply></apply><apply id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.4.3.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.4.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.4.3.1.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.4.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.4.3.2.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.4.3.2">𝐇</ci><ci id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.4.3.3.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.1.1.1.4.3.3">𝑡</ci></apply></apply></apply></apply><apply id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.3.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.8.8.3.3.2">𝑊</ci><apply id="S3.SS2.SSS0.Px1.p6.6.m6.5.5.1.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.5.5.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p6.6.m6.5.5.1.2.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.5.5.1">superscript</csymbol><apply id="S3.SS2.SSS0.Px1.p6.6.m6.5.5.1.3.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.5.5.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p6.6.m6.5.5.1.3.1.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.5.5.1">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p6.6.m6.5.5.1.3.2.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.5.5.1.3.2"><ci id="S3.SS2.SSS0.Px1.p6.6.m6.5.5.1.3.2.1.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.5.5.1.3.2.1">^</ci><ci id="S3.SS2.SSS0.Px1.p6.6.m6.5.5.1.3.2.2.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.5.5.1.3.2.2">𝐇</ci></apply><ci id="S3.SS2.SSS0.Px1.p6.6.m6.5.5.1.3.3.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.5.5.1.3.3">𝑡</ci></apply><apply id="S3.SS2.SSS0.Px1.p6.6.m6.5.5.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.5.5.1.1.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px1.p6.6.m6.5.5.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.5.5.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px1.p6.6.m6.5.5.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p6.6.m6.5.5.1.1.1.1">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p6.6.m6.8c">\phi_{t}(\mathbf{H}_{t}^{[l]},\mathbf{F}_{t}^{[l]})=\left[\sigma(\mathbf{A^{*}%
}_{t}^{[l]})\mathbf{V}^{[l]}_{\mathbf{H}_{t}}\right]W^{\mathbf{\hat{H}}_{t}^{[%
l]}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p6.6.m6.8d">italic_ϕ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_H start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT , bold_F start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT ) = [ italic_σ ( bold_A start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT ) bold_V start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT bold_H start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT ] italic_W start_POSTSUPERSCRIPT over^ start_ARG bold_H end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> which follows from <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S3.E1" title="In 3.2 Causal History Model ‣ 3 Methodology ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">eq.</span> <span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS2.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Frame History Router (<math alttext="\psi" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.1.m1.1"><semantics id="S3.SS2.SSS0.Px2.1.m1.1b"><mi id="S3.SS2.SSS0.Px2.1.m1.1.1" xref="S3.SS2.SSS0.Px2.1.m1.1.1.cmml">ψ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.1.m1.1c"><ci id="S3.SS2.SSS0.Px2.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px2.1.m1.1.1">𝜓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.1.m1.1d">\psi</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.1.m1.1e">italic_ψ</annotation></semantics></math>).</h4>
<div class="ltx_para" id="S3.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="S3.SS2.SSS0.Px2.p1.9">Given the motion-compensated history states <math alttext="\mathbf{\hat{H}}^{[l]}_{t}\in\mathbb{R}^{(\tau+1)\times h^{l}\times w^{l}%
\times c^{l}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.1.m1.2"><semantics id="S3.SS2.SSS0.Px2.p1.1.m1.2a"><mrow id="S3.SS2.SSS0.Px2.p1.1.m1.2.3" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.3.cmml"><msubsup id="S3.SS2.SSS0.Px2.p1.1.m1.2.3.2" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.3.2.cmml"><mover accent="true" id="S3.SS2.SSS0.Px2.p1.1.m1.2.3.2.2.2" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.3.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px2.p1.1.m1.2.3.2.2.2.2" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.3.2.2.2.2.cmml">𝐇</mi><mo id="S3.SS2.SSS0.Px2.p1.1.m1.2.3.2.2.2.1" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.3.2.2.2.1.cmml">^</mo></mover><mi id="S3.SS2.SSS0.Px2.p1.1.m1.2.3.2.3" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.3.2.3.cmml">t</mi><mrow id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.1.3" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.1.2.cmml"><mo id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.1.1" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.SS2.SSS0.Px2.p1.1.m1.2.3.1" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.3.1.cmml">∈</mo><msup id="S3.SS2.SSS0.Px2.p1.1.m1.2.3.3" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.3.3.cmml"><mi id="S3.SS2.SSS0.Px2.p1.1.m1.2.3.3.2" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.3.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.cmml"><mrow id="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.1.1" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.1.1.1.cmml"><mo id="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.1.1.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.1.1.1" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.1.1.1.2" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.1.1.1.2.cmml">τ</mi><mo id="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.1.1.1.1" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.1.1.1.1.cmml">+</mo><mn id="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.1.1.1.3" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.2" rspace="0.222em" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.2.cmml">×</mo><msup id="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.3" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.3.cmml"><mi id="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.3.2" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.3.2.cmml">h</mi><mi id="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.3.3" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.3.3.cmml">l</mi></msup><mo id="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.2a" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.2.cmml">×</mo><msup id="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.4" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.4.cmml"><mi id="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.4.2" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.4.2.cmml">w</mi><mi id="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.4.3" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.4.3.cmml">l</mi></msup><mo id="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.2b" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.2.cmml">×</mo><msup id="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.5" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.5.cmml"><mi id="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.5.2" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.5.2.cmml">c</mi><mi id="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.5.3" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.5.3.cmml">l</mi></msup></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.1.m1.2b"><apply id="S3.SS2.SSS0.Px2.p1.1.m1.2.3.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.3"><in id="S3.SS2.SSS0.Px2.p1.1.m1.2.3.1.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.3.1"></in><apply id="S3.SS2.SSS0.Px2.p1.1.m1.2.3.2.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.1.m1.2.3.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.3.2">subscript</csymbol><apply id="S3.SS2.SSS0.Px2.p1.1.m1.2.3.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.1.m1.2.3.2.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.3.2">superscript</csymbol><apply id="S3.SS2.SSS0.Px2.p1.1.m1.2.3.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.3.2.2.2"><ci id="S3.SS2.SSS0.Px2.p1.1.m1.2.3.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.3.2.2.2.1">^</ci><ci id="S3.SS2.SSS0.Px2.p1.1.m1.2.3.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.3.2.2.2.2">𝐇</ci></apply><apply id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.1.1">𝑙</ci></apply></apply><ci id="S3.SS2.SSS0.Px2.p1.1.m1.2.3.2.3.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.3.2.3">𝑡</ci></apply><apply id="S3.SS2.SSS0.Px2.p1.1.m1.2.3.3.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.1.m1.2.3.3.1.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.3.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.1.m1.2.3.3.2.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.3.3.2">ℝ</ci><apply id="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1"><times id="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.2"></times><apply id="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.1.1"><plus id="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.1.1.1.1"></plus><ci id="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.1.1.1.2">𝜏</ci><cn id="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.1.1.1.3.cmml" type="integer" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.1.1.1.3">1</cn></apply><apply id="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.3.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.3.1.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.3.2.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.3.2">ℎ</ci><ci id="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.3.3.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.3.3">𝑙</ci></apply><apply id="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.4.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.4"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.4.1.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.4">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.4.2.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.4.2">𝑤</ci><ci id="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.4.3.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.4.3">𝑙</ci></apply><apply id="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.5.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.5"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.5.1.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.5">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.5.2.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.5.2">𝑐</ci><ci id="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.5.3.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.5.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.1.m1.2c">\mathbf{\hat{H}}^{[l]}_{t}\in\mathbb{R}^{(\tau+1)\times h^{l}\times w^{l}%
\times c^{l}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.1.m1.2d">over^ start_ARG bold_H end_ARG start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT ( italic_τ + 1 ) × italic_h start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT × italic_w start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT × italic_c start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> and the input features <math alttext="\mathbf{F}^{[l]}_{t}\in\mathbb{R}^{h^{l}\times w^{l}\times c^{l}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.2.m2.1"><semantics id="S3.SS2.SSS0.Px2.p1.2.m2.1a"><mrow id="S3.SS2.SSS0.Px2.p1.2.m2.1.2" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.2.cmml"><msubsup id="S3.SS2.SSS0.Px2.p1.2.m2.1.2.2" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.2.2.cmml"><mi id="S3.SS2.SSS0.Px2.p1.2.m2.1.2.2.2.2" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.2.2.2.2.cmml">𝐅</mi><mi id="S3.SS2.SSS0.Px2.p1.2.m2.1.2.2.3" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.2.2.3.cmml">t</mi><mrow id="S3.SS2.SSS0.Px2.p1.2.m2.1.1.1.3" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1.1.2.cmml"><mo id="S3.SS2.SSS0.Px2.p1.2.m2.1.1.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px2.p1.2.m2.1.1.1.1" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px2.p1.2.m2.1.1.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.SS2.SSS0.Px2.p1.2.m2.1.2.1" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.2.1.cmml">∈</mo><msup id="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.cmml"><mi id="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.2" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.cmml"><msup id="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.2" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.2.cmml"><mi id="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.2.2" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.2.2.cmml">h</mi><mi id="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.2.3" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.2.3.cmml">l</mi></msup><mo id="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.1.cmml">×</mo><msup id="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.3" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.3.cmml"><mi id="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.3.2" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.3.2.cmml">w</mi><mi id="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.3.3" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.3.3.cmml">l</mi></msup><mo id="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.1.cmml">×</mo><msup id="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.4" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.4.cmml"><mi id="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.4.2" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.4.2.cmml">c</mi><mi id="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.4.3" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.4.3.cmml">l</mi></msup></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.2.m2.1b"><apply id="S3.SS2.SSS0.Px2.p1.2.m2.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.2"><in id="S3.SS2.SSS0.Px2.p1.2.m2.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.2.1"></in><apply id="S3.SS2.SSS0.Px2.p1.2.m2.1.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.2.m2.1.2.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.2.2">subscript</csymbol><apply id="S3.SS2.SSS0.Px2.p1.2.m2.1.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.2.m2.1.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.2.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.2.m2.1.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.2.2.2.2">𝐅</ci><apply id="S3.SS2.SSS0.Px2.p1.2.m2.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px2.p1.2.m2.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px2.p1.2.m2.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1.1.1">𝑙</ci></apply></apply><ci id="S3.SS2.SSS0.Px2.p1.2.m2.1.2.2.3.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.2.2.3">𝑡</ci></apply><apply id="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.1.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.2.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.2">ℝ</ci><apply id="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3"><times id="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.1.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.1"></times><apply id="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.2.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.2.2">ℎ</ci><ci id="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.2.3.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.2.3">𝑙</ci></apply><apply id="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.3.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.3.1.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.3.2.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.3.2">𝑤</ci><ci id="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.3.3.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.3.3">𝑙</ci></apply><apply id="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.4.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.4"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.4.1.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.4">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.4.2.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.4.2">𝑐</ci><ci id="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.4.3.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.2.3.3.4.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.2.m2.1c">\mathbf{F}^{[l]}_{t}\in\mathbb{R}^{h^{l}\times w^{l}\times c^{l}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.2.m2.1d">bold_F start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_h start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT × italic_w start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT × italic_c start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, Frame History Router (<math alttext="\psi" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.3.m3.1"><semantics id="S3.SS2.SSS0.Px2.p1.3.m3.1a"><mi id="S3.SS2.SSS0.Px2.p1.3.m3.1.1" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1.cmml">ψ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.3.m3.1b"><ci id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1">𝜓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.3.m3.1c">\psi</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.3.m3.1d">italic_ψ</annotation></semantics></math>) learns to route and aggregate critical features for the restoration of the input frame. To this end, we compute the query vector from <math alttext="\mathbf{F}^{[l]}_{t}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.4.m4.1"><semantics id="S3.SS2.SSS0.Px2.p1.4.m4.1a"><msubsup id="S3.SS2.SSS0.Px2.p1.4.m4.1.2" xref="S3.SS2.SSS0.Px2.p1.4.m4.1.2.cmml"><mi id="S3.SS2.SSS0.Px2.p1.4.m4.1.2.2.2" xref="S3.SS2.SSS0.Px2.p1.4.m4.1.2.2.2.cmml">𝐅</mi><mi id="S3.SS2.SSS0.Px2.p1.4.m4.1.2.3" xref="S3.SS2.SSS0.Px2.p1.4.m4.1.2.3.cmml">t</mi><mrow id="S3.SS2.SSS0.Px2.p1.4.m4.1.1.1.3" xref="S3.SS2.SSS0.Px2.p1.4.m4.1.1.1.2.cmml"><mo id="S3.SS2.SSS0.Px2.p1.4.m4.1.1.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.4.m4.1.1.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px2.p1.4.m4.1.1.1.1" xref="S3.SS2.SSS0.Px2.p1.4.m4.1.1.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px2.p1.4.m4.1.1.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.4.m4.1.1.1.2.1.cmml">]</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.4.m4.1b"><apply id="S3.SS2.SSS0.Px2.p1.4.m4.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m4.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.4.m4.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m4.1.2">subscript</csymbol><apply id="S3.SS2.SSS0.Px2.p1.4.m4.1.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m4.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.4.m4.1.2.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m4.1.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.4.m4.1.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m4.1.2.2.2">𝐅</ci><apply id="S3.SS2.SSS0.Px2.p1.4.m4.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m4.1.1.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px2.p1.4.m4.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m4.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px2.p1.4.m4.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m4.1.1.1.1">𝑙</ci></apply></apply><ci id="S3.SS2.SSS0.Px2.p1.4.m4.1.2.3.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m4.1.2.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.4.m4.1c">\mathbf{F}^{[l]}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.4.m4.1d">bold_F start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> through the transformation matrix <math alttext="W^{\mathbf{Q}^{[l]}_{t}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.5.m5.1"><semantics id="S3.SS2.SSS0.Px2.p1.5.m5.1a"><msup id="S3.SS2.SSS0.Px2.p1.5.m5.1.2" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.2.cmml"><mi id="S3.SS2.SSS0.Px2.p1.5.m5.1.2.2" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.2.2.cmml">W</mi><msubsup id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.3.2" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.3.2.cmml">𝐐</mi><mi id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.4" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.4.cmml">t</mi><mrow id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.1.3" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.1.2.cmml"><mo id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.1.1" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.1.2.1.cmml">]</mo></mrow></msubsup></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.5.m5.1b"><apply id="S3.SS2.SSS0.Px2.p1.5.m5.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.5.m5.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.5.m5.1.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.2.2">𝑊</ci><apply id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1">subscript</csymbol><apply id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.3.2">𝐐</ci><apply id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.1.1">𝑙</ci></apply></apply><ci id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.4.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.5.m5.1c">W^{\mathbf{Q}^{[l]}_{t}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.5.m5.1d">italic_W start_POSTSUPERSCRIPT bold_Q start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, resulting in <math alttext="\mathbf{Q}^{[l]}_{t}\leftarrow\mathbf{F}^{[l]}_{t}W^{\mathbf{Q}^{[l]}_{t}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.6.m6.3"><semantics id="S3.SS2.SSS0.Px2.p1.6.m6.3a"><mrow id="S3.SS2.SSS0.Px2.p1.6.m6.3.4" xref="S3.SS2.SSS0.Px2.p1.6.m6.3.4.cmml"><msubsup id="S3.SS2.SSS0.Px2.p1.6.m6.3.4.2" xref="S3.SS2.SSS0.Px2.p1.6.m6.3.4.2.cmml"><mi id="S3.SS2.SSS0.Px2.p1.6.m6.3.4.2.2.2" xref="S3.SS2.SSS0.Px2.p1.6.m6.3.4.2.2.2.cmml">𝐐</mi><mi id="S3.SS2.SSS0.Px2.p1.6.m6.3.4.2.3" xref="S3.SS2.SSS0.Px2.p1.6.m6.3.4.2.3.cmml">t</mi><mrow id="S3.SS2.SSS0.Px2.p1.6.m6.1.1.1.3" xref="S3.SS2.SSS0.Px2.p1.6.m6.1.1.1.2.cmml"><mo id="S3.SS2.SSS0.Px2.p1.6.m6.1.1.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.6.m6.1.1.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px2.p1.6.m6.1.1.1.1" xref="S3.SS2.SSS0.Px2.p1.6.m6.1.1.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px2.p1.6.m6.1.1.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.6.m6.1.1.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.SS2.SSS0.Px2.p1.6.m6.3.4.1" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.6.m6.3.4.1.cmml">←</mo><mrow id="S3.SS2.SSS0.Px2.p1.6.m6.3.4.3" xref="S3.SS2.SSS0.Px2.p1.6.m6.3.4.3.cmml"><msubsup id="S3.SS2.SSS0.Px2.p1.6.m6.3.4.3.2" xref="S3.SS2.SSS0.Px2.p1.6.m6.3.4.3.2.cmml"><mi id="S3.SS2.SSS0.Px2.p1.6.m6.3.4.3.2.2.2" xref="S3.SS2.SSS0.Px2.p1.6.m6.3.4.3.2.2.2.cmml">𝐅</mi><mi id="S3.SS2.SSS0.Px2.p1.6.m6.3.4.3.2.3" xref="S3.SS2.SSS0.Px2.p1.6.m6.3.4.3.2.3.cmml">t</mi><mrow id="S3.SS2.SSS0.Px2.p1.6.m6.2.2.1.3" xref="S3.SS2.SSS0.Px2.p1.6.m6.2.2.1.2.cmml"><mo id="S3.SS2.SSS0.Px2.p1.6.m6.2.2.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.6.m6.2.2.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px2.p1.6.m6.2.2.1.1" xref="S3.SS2.SSS0.Px2.p1.6.m6.2.2.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px2.p1.6.m6.2.2.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.6.m6.2.2.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.SS2.SSS0.Px2.p1.6.m6.3.4.3.1" xref="S3.SS2.SSS0.Px2.p1.6.m6.3.4.3.1.cmml">⁢</mo><msup id="S3.SS2.SSS0.Px2.p1.6.m6.3.4.3.3" xref="S3.SS2.SSS0.Px2.p1.6.m6.3.4.3.3.cmml"><mi id="S3.SS2.SSS0.Px2.p1.6.m6.3.4.3.3.2" xref="S3.SS2.SSS0.Px2.p1.6.m6.3.4.3.3.2.cmml">W</mi><msubsup id="S3.SS2.SSS0.Px2.p1.6.m6.3.3.1" xref="S3.SS2.SSS0.Px2.p1.6.m6.3.3.1.cmml"><mi id="S3.SS2.SSS0.Px2.p1.6.m6.3.3.1.3.2" xref="S3.SS2.SSS0.Px2.p1.6.m6.3.3.1.3.2.cmml">𝐐</mi><mi id="S3.SS2.SSS0.Px2.p1.6.m6.3.3.1.4" xref="S3.SS2.SSS0.Px2.p1.6.m6.3.3.1.4.cmml">t</mi><mrow id="S3.SS2.SSS0.Px2.p1.6.m6.3.3.1.1.1.3" xref="S3.SS2.SSS0.Px2.p1.6.m6.3.3.1.1.1.2.cmml"><mo id="S3.SS2.SSS0.Px2.p1.6.m6.3.3.1.1.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.6.m6.3.3.1.1.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px2.p1.6.m6.3.3.1.1.1.1" xref="S3.SS2.SSS0.Px2.p1.6.m6.3.3.1.1.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px2.p1.6.m6.3.3.1.1.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.6.m6.3.3.1.1.1.2.1.cmml">]</mo></mrow></msubsup></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.6.m6.3b"><apply id="S3.SS2.SSS0.Px2.p1.6.m6.3.4.cmml" xref="S3.SS2.SSS0.Px2.p1.6.m6.3.4"><ci id="S3.SS2.SSS0.Px2.p1.6.m6.3.4.1.cmml" xref="S3.SS2.SSS0.Px2.p1.6.m6.3.4.1">←</ci><apply id="S3.SS2.SSS0.Px2.p1.6.m6.3.4.2.cmml" xref="S3.SS2.SSS0.Px2.p1.6.m6.3.4.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.6.m6.3.4.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.6.m6.3.4.2">subscript</csymbol><apply id="S3.SS2.SSS0.Px2.p1.6.m6.3.4.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.6.m6.3.4.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.6.m6.3.4.2.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.6.m6.3.4.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.6.m6.3.4.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.6.m6.3.4.2.2.2">𝐐</ci><apply id="S3.SS2.SSS0.Px2.p1.6.m6.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.6.m6.1.1.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px2.p1.6.m6.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.6.m6.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px2.p1.6.m6.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.6.m6.1.1.1.1">𝑙</ci></apply></apply><ci id="S3.SS2.SSS0.Px2.p1.6.m6.3.4.2.3.cmml" xref="S3.SS2.SSS0.Px2.p1.6.m6.3.4.2.3">𝑡</ci></apply><apply id="S3.SS2.SSS0.Px2.p1.6.m6.3.4.3.cmml" xref="S3.SS2.SSS0.Px2.p1.6.m6.3.4.3"><times id="S3.SS2.SSS0.Px2.p1.6.m6.3.4.3.1.cmml" xref="S3.SS2.SSS0.Px2.p1.6.m6.3.4.3.1"></times><apply id="S3.SS2.SSS0.Px2.p1.6.m6.3.4.3.2.cmml" xref="S3.SS2.SSS0.Px2.p1.6.m6.3.4.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.6.m6.3.4.3.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.6.m6.3.4.3.2">subscript</csymbol><apply id="S3.SS2.SSS0.Px2.p1.6.m6.3.4.3.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.6.m6.3.4.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.6.m6.3.4.3.2.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.6.m6.3.4.3.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.6.m6.3.4.3.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.6.m6.3.4.3.2.2.2">𝐅</ci><apply id="S3.SS2.SSS0.Px2.p1.6.m6.2.2.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.6.m6.2.2.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px2.p1.6.m6.2.2.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.6.m6.2.2.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px2.p1.6.m6.2.2.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.6.m6.2.2.1.1">𝑙</ci></apply></apply><ci id="S3.SS2.SSS0.Px2.p1.6.m6.3.4.3.2.3.cmml" xref="S3.SS2.SSS0.Px2.p1.6.m6.3.4.3.2.3">𝑡</ci></apply><apply id="S3.SS2.SSS0.Px2.p1.6.m6.3.4.3.3.cmml" xref="S3.SS2.SSS0.Px2.p1.6.m6.3.4.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.6.m6.3.4.3.3.1.cmml" xref="S3.SS2.SSS0.Px2.p1.6.m6.3.4.3.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.6.m6.3.4.3.3.2.cmml" xref="S3.SS2.SSS0.Px2.p1.6.m6.3.4.3.3.2">𝑊</ci><apply id="S3.SS2.SSS0.Px2.p1.6.m6.3.3.1.cmml" xref="S3.SS2.SSS0.Px2.p1.6.m6.3.3.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.6.m6.3.3.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.6.m6.3.3.1">subscript</csymbol><apply id="S3.SS2.SSS0.Px2.p1.6.m6.3.3.1.3.cmml" xref="S3.SS2.SSS0.Px2.p1.6.m6.3.3.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.6.m6.3.3.1.3.1.cmml" xref="S3.SS2.SSS0.Px2.p1.6.m6.3.3.1">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.6.m6.3.3.1.3.2.cmml" xref="S3.SS2.SSS0.Px2.p1.6.m6.3.3.1.3.2">𝐐</ci><apply id="S3.SS2.SSS0.Px2.p1.6.m6.3.3.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.6.m6.3.3.1.1.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px2.p1.6.m6.3.3.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.6.m6.3.3.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px2.p1.6.m6.3.3.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.6.m6.3.3.1.1.1.1">𝑙</ci></apply></apply><ci id="S3.SS2.SSS0.Px2.p1.6.m6.3.3.1.4.cmml" xref="S3.SS2.SSS0.Px2.p1.6.m6.3.3.1.4">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.6.m6.3c">\mathbf{Q}^{[l]}_{t}\leftarrow\mathbf{F}^{[l]}_{t}W^{\mathbf{Q}^{[l]}_{t}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.6.m6.3d">bold_Q start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ← bold_F start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_W start_POSTSUPERSCRIPT bold_Q start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>. Similarly, the key and value vectors are derived from <math alttext="\mathbf{\hat{H}}^{[l]}_{t}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.7.m7.1"><semantics id="S3.SS2.SSS0.Px2.p1.7.m7.1a"><msubsup id="S3.SS2.SSS0.Px2.p1.7.m7.1.2" xref="S3.SS2.SSS0.Px2.p1.7.m7.1.2.cmml"><mover accent="true" id="S3.SS2.SSS0.Px2.p1.7.m7.1.2.2.2" xref="S3.SS2.SSS0.Px2.p1.7.m7.1.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px2.p1.7.m7.1.2.2.2.2" xref="S3.SS2.SSS0.Px2.p1.7.m7.1.2.2.2.2.cmml">𝐇</mi><mo id="S3.SS2.SSS0.Px2.p1.7.m7.1.2.2.2.1" xref="S3.SS2.SSS0.Px2.p1.7.m7.1.2.2.2.1.cmml">^</mo></mover><mi id="S3.SS2.SSS0.Px2.p1.7.m7.1.2.3" xref="S3.SS2.SSS0.Px2.p1.7.m7.1.2.3.cmml">t</mi><mrow id="S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.3" xref="S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.2.cmml"><mo id="S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1" xref="S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.2.1.cmml">]</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.7.m7.1b"><apply id="S3.SS2.SSS0.Px2.p1.7.m7.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.7.m7.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.7.m7.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.7.m7.1.2">subscript</csymbol><apply id="S3.SS2.SSS0.Px2.p1.7.m7.1.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.7.m7.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.7.m7.1.2.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.7.m7.1.2">superscript</csymbol><apply id="S3.SS2.SSS0.Px2.p1.7.m7.1.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.7.m7.1.2.2.2"><ci id="S3.SS2.SSS0.Px2.p1.7.m7.1.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.7.m7.1.2.2.2.1">^</ci><ci id="S3.SS2.SSS0.Px2.p1.7.m7.1.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.7.m7.1.2.2.2.2">𝐇</ci></apply><apply id="S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1">𝑙</ci></apply></apply><ci id="S3.SS2.SSS0.Px2.p1.7.m7.1.2.3.cmml" xref="S3.SS2.SSS0.Px2.p1.7.m7.1.2.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.7.m7.1c">\mathbf{\hat{H}}^{[l]}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.7.m7.1d">over^ start_ARG bold_H end_ARG start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, and are parameterized <math alttext="W^{\mathbf{\hat{H}}^{[l]}_{t}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.8.m8.1"><semantics id="S3.SS2.SSS0.Px2.p1.8.m8.1a"><msup id="S3.SS2.SSS0.Px2.p1.8.m8.1.2" xref="S3.SS2.SSS0.Px2.p1.8.m8.1.2.cmml"><mi id="S3.SS2.SSS0.Px2.p1.8.m8.1.2.2" xref="S3.SS2.SSS0.Px2.p1.8.m8.1.2.2.cmml">W</mi><msubsup id="S3.SS2.SSS0.Px2.p1.8.m8.1.1.1" xref="S3.SS2.SSS0.Px2.p1.8.m8.1.1.1.cmml"><mover accent="true" id="S3.SS2.SSS0.Px2.p1.8.m8.1.1.1.3.2" xref="S3.SS2.SSS0.Px2.p1.8.m8.1.1.1.3.2.cmml"><mi id="S3.SS2.SSS0.Px2.p1.8.m8.1.1.1.3.2.2" xref="S3.SS2.SSS0.Px2.p1.8.m8.1.1.1.3.2.2.cmml">𝐇</mi><mo id="S3.SS2.SSS0.Px2.p1.8.m8.1.1.1.3.2.1" xref="S3.SS2.SSS0.Px2.p1.8.m8.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.SS2.SSS0.Px2.p1.8.m8.1.1.1.4" xref="S3.SS2.SSS0.Px2.p1.8.m8.1.1.1.4.cmml">t</mi><mrow id="S3.SS2.SSS0.Px2.p1.8.m8.1.1.1.1.1.3" xref="S3.SS2.SSS0.Px2.p1.8.m8.1.1.1.1.1.2.cmml"><mo id="S3.SS2.SSS0.Px2.p1.8.m8.1.1.1.1.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.8.m8.1.1.1.1.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px2.p1.8.m8.1.1.1.1.1.1" xref="S3.SS2.SSS0.Px2.p1.8.m8.1.1.1.1.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px2.p1.8.m8.1.1.1.1.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.8.m8.1.1.1.1.1.2.1.cmml">]</mo></mrow></msubsup></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.8.m8.1b"><apply id="S3.SS2.SSS0.Px2.p1.8.m8.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.8.m8.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.8.m8.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.8.m8.1.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.8.m8.1.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.8.m8.1.2.2">𝑊</ci><apply id="S3.SS2.SSS0.Px2.p1.8.m8.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.8.m8.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.8.m8.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.8.m8.1.1.1">subscript</csymbol><apply id="S3.SS2.SSS0.Px2.p1.8.m8.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p1.8.m8.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.8.m8.1.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px2.p1.8.m8.1.1.1">superscript</csymbol><apply id="S3.SS2.SSS0.Px2.p1.8.m8.1.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px2.p1.8.m8.1.1.1.3.2"><ci id="S3.SS2.SSS0.Px2.p1.8.m8.1.1.1.3.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.8.m8.1.1.1.3.2.1">^</ci><ci id="S3.SS2.SSS0.Px2.p1.8.m8.1.1.1.3.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.8.m8.1.1.1.3.2.2">𝐇</ci></apply><apply id="S3.SS2.SSS0.Px2.p1.8.m8.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.8.m8.1.1.1.1.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px2.p1.8.m8.1.1.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.8.m8.1.1.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px2.p1.8.m8.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.8.m8.1.1.1.1.1.1">𝑙</ci></apply></apply><ci id="S3.SS2.SSS0.Px2.p1.8.m8.1.1.1.4.cmml" xref="S3.SS2.SSS0.Px2.p1.8.m8.1.1.1.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.8.m8.1c">W^{\mathbf{\hat{H}}^{[l]}_{t}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.8.m8.1d">italic_W start_POSTSUPERSCRIPT over^ start_ARG bold_H end_ARG start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, i.e., <math alttext="\mathbf{K}^{[l]}_{t},\mathbf{V}^{[l]}_{t}\leftarrow\mathbf{\hat{H}}^{[l]}_{t}W%
^{\mathbf{\hat{H}}^{[l]}_{t}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.9.m9.6"><semantics id="S3.SS2.SSS0.Px2.p1.9.m9.6a"><mrow id="S3.SS2.SSS0.Px2.p1.9.m9.6.6" xref="S3.SS2.SSS0.Px2.p1.9.m9.6.6.cmml"><mrow id="S3.SS2.SSS0.Px2.p1.9.m9.6.6.2.2" xref="S3.SS2.SSS0.Px2.p1.9.m9.6.6.2.3.cmml"><msubsup id="S3.SS2.SSS0.Px2.p1.9.m9.5.5.1.1.1" xref="S3.SS2.SSS0.Px2.p1.9.m9.5.5.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p1.9.m9.5.5.1.1.1.2.2" xref="S3.SS2.SSS0.Px2.p1.9.m9.5.5.1.1.1.2.2.cmml">𝐊</mi><mi id="S3.SS2.SSS0.Px2.p1.9.m9.5.5.1.1.1.3" xref="S3.SS2.SSS0.Px2.p1.9.m9.5.5.1.1.1.3.cmml">t</mi><mrow id="S3.SS2.SSS0.Px2.p1.9.m9.1.1.1.3" xref="S3.SS2.SSS0.Px2.p1.9.m9.1.1.1.2.cmml"><mo id="S3.SS2.SSS0.Px2.p1.9.m9.1.1.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.9.m9.1.1.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px2.p1.9.m9.1.1.1.1" xref="S3.SS2.SSS0.Px2.p1.9.m9.1.1.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px2.p1.9.m9.1.1.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.9.m9.1.1.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.SS2.SSS0.Px2.p1.9.m9.6.6.2.2.3" xref="S3.SS2.SSS0.Px2.p1.9.m9.6.6.2.3.cmml">,</mo><msubsup id="S3.SS2.SSS0.Px2.p1.9.m9.6.6.2.2.2" xref="S3.SS2.SSS0.Px2.p1.9.m9.6.6.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px2.p1.9.m9.6.6.2.2.2.2.2" xref="S3.SS2.SSS0.Px2.p1.9.m9.6.6.2.2.2.2.2.cmml">𝐕</mi><mi id="S3.SS2.SSS0.Px2.p1.9.m9.6.6.2.2.2.3" xref="S3.SS2.SSS0.Px2.p1.9.m9.6.6.2.2.2.3.cmml">t</mi><mrow id="S3.SS2.SSS0.Px2.p1.9.m9.2.2.1.3" xref="S3.SS2.SSS0.Px2.p1.9.m9.2.2.1.2.cmml"><mo id="S3.SS2.SSS0.Px2.p1.9.m9.2.2.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.9.m9.2.2.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px2.p1.9.m9.2.2.1.1" xref="S3.SS2.SSS0.Px2.p1.9.m9.2.2.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px2.p1.9.m9.2.2.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.9.m9.2.2.1.2.1.cmml">]</mo></mrow></msubsup></mrow><mo id="S3.SS2.SSS0.Px2.p1.9.m9.6.6.3" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.9.m9.6.6.3.cmml">←</mo><mrow id="S3.SS2.SSS0.Px2.p1.9.m9.6.6.4" xref="S3.SS2.SSS0.Px2.p1.9.m9.6.6.4.cmml"><msubsup id="S3.SS2.SSS0.Px2.p1.9.m9.6.6.4.2" xref="S3.SS2.SSS0.Px2.p1.9.m9.6.6.4.2.cmml"><mover accent="true" id="S3.SS2.SSS0.Px2.p1.9.m9.6.6.4.2.2.2" xref="S3.SS2.SSS0.Px2.p1.9.m9.6.6.4.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px2.p1.9.m9.6.6.4.2.2.2.2" xref="S3.SS2.SSS0.Px2.p1.9.m9.6.6.4.2.2.2.2.cmml">𝐇</mi><mo id="S3.SS2.SSS0.Px2.p1.9.m9.6.6.4.2.2.2.1" xref="S3.SS2.SSS0.Px2.p1.9.m9.6.6.4.2.2.2.1.cmml">^</mo></mover><mi id="S3.SS2.SSS0.Px2.p1.9.m9.6.6.4.2.3" xref="S3.SS2.SSS0.Px2.p1.9.m9.6.6.4.2.3.cmml">t</mi><mrow id="S3.SS2.SSS0.Px2.p1.9.m9.3.3.1.3" xref="S3.SS2.SSS0.Px2.p1.9.m9.3.3.1.2.cmml"><mo id="S3.SS2.SSS0.Px2.p1.9.m9.3.3.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.9.m9.3.3.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px2.p1.9.m9.3.3.1.1" xref="S3.SS2.SSS0.Px2.p1.9.m9.3.3.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px2.p1.9.m9.3.3.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.9.m9.3.3.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.SS2.SSS0.Px2.p1.9.m9.6.6.4.1" xref="S3.SS2.SSS0.Px2.p1.9.m9.6.6.4.1.cmml">⁢</mo><msup id="S3.SS2.SSS0.Px2.p1.9.m9.6.6.4.3" xref="S3.SS2.SSS0.Px2.p1.9.m9.6.6.4.3.cmml"><mi id="S3.SS2.SSS0.Px2.p1.9.m9.6.6.4.3.2" xref="S3.SS2.SSS0.Px2.p1.9.m9.6.6.4.3.2.cmml">W</mi><msubsup id="S3.SS2.SSS0.Px2.p1.9.m9.4.4.1" xref="S3.SS2.SSS0.Px2.p1.9.m9.4.4.1.cmml"><mover accent="true" id="S3.SS2.SSS0.Px2.p1.9.m9.4.4.1.3.2" xref="S3.SS2.SSS0.Px2.p1.9.m9.4.4.1.3.2.cmml"><mi id="S3.SS2.SSS0.Px2.p1.9.m9.4.4.1.3.2.2" xref="S3.SS2.SSS0.Px2.p1.9.m9.4.4.1.3.2.2.cmml">𝐇</mi><mo id="S3.SS2.SSS0.Px2.p1.9.m9.4.4.1.3.2.1" xref="S3.SS2.SSS0.Px2.p1.9.m9.4.4.1.3.2.1.cmml">^</mo></mover><mi id="S3.SS2.SSS0.Px2.p1.9.m9.4.4.1.4" xref="S3.SS2.SSS0.Px2.p1.9.m9.4.4.1.4.cmml">t</mi><mrow id="S3.SS2.SSS0.Px2.p1.9.m9.4.4.1.1.1.3" xref="S3.SS2.SSS0.Px2.p1.9.m9.4.4.1.1.1.2.cmml"><mo id="S3.SS2.SSS0.Px2.p1.9.m9.4.4.1.1.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.9.m9.4.4.1.1.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px2.p1.9.m9.4.4.1.1.1.1" xref="S3.SS2.SSS0.Px2.p1.9.m9.4.4.1.1.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px2.p1.9.m9.4.4.1.1.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.9.m9.4.4.1.1.1.2.1.cmml">]</mo></mrow></msubsup></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.9.m9.6b"><apply id="S3.SS2.SSS0.Px2.p1.9.m9.6.6.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.6.6"><ci id="S3.SS2.SSS0.Px2.p1.9.m9.6.6.3.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.6.6.3">←</ci><list id="S3.SS2.SSS0.Px2.p1.9.m9.6.6.2.3.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.6.6.2.2"><apply id="S3.SS2.SSS0.Px2.p1.9.m9.5.5.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.5.5.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.9.m9.5.5.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.5.5.1.1.1">subscript</csymbol><apply id="S3.SS2.SSS0.Px2.p1.9.m9.5.5.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.5.5.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.9.m9.5.5.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.5.5.1.1.1">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.9.m9.5.5.1.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.5.5.1.1.1.2.2">𝐊</ci><apply id="S3.SS2.SSS0.Px2.p1.9.m9.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.1.1.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px2.p1.9.m9.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px2.p1.9.m9.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.1.1.1.1">𝑙</ci></apply></apply><ci id="S3.SS2.SSS0.Px2.p1.9.m9.5.5.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.5.5.1.1.1.3">𝑡</ci></apply><apply id="S3.SS2.SSS0.Px2.p1.9.m9.6.6.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.6.6.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.9.m9.6.6.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.6.6.2.2.2">subscript</csymbol><apply id="S3.SS2.SSS0.Px2.p1.9.m9.6.6.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.6.6.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.9.m9.6.6.2.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.6.6.2.2.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.9.m9.6.6.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.6.6.2.2.2.2.2">𝐕</ci><apply id="S3.SS2.SSS0.Px2.p1.9.m9.2.2.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.2.2.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px2.p1.9.m9.2.2.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.2.2.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px2.p1.9.m9.2.2.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.2.2.1.1">𝑙</ci></apply></apply><ci id="S3.SS2.SSS0.Px2.p1.9.m9.6.6.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.6.6.2.2.2.3">𝑡</ci></apply></list><apply id="S3.SS2.SSS0.Px2.p1.9.m9.6.6.4.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.6.6.4"><times id="S3.SS2.SSS0.Px2.p1.9.m9.6.6.4.1.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.6.6.4.1"></times><apply id="S3.SS2.SSS0.Px2.p1.9.m9.6.6.4.2.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.6.6.4.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.9.m9.6.6.4.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.6.6.4.2">subscript</csymbol><apply id="S3.SS2.SSS0.Px2.p1.9.m9.6.6.4.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.6.6.4.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.9.m9.6.6.4.2.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.6.6.4.2">superscript</csymbol><apply id="S3.SS2.SSS0.Px2.p1.9.m9.6.6.4.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.6.6.4.2.2.2"><ci id="S3.SS2.SSS0.Px2.p1.9.m9.6.6.4.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.6.6.4.2.2.2.1">^</ci><ci id="S3.SS2.SSS0.Px2.p1.9.m9.6.6.4.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.6.6.4.2.2.2.2">𝐇</ci></apply><apply id="S3.SS2.SSS0.Px2.p1.9.m9.3.3.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.3.3.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px2.p1.9.m9.3.3.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.3.3.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px2.p1.9.m9.3.3.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.3.3.1.1">𝑙</ci></apply></apply><ci id="S3.SS2.SSS0.Px2.p1.9.m9.6.6.4.2.3.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.6.6.4.2.3">𝑡</ci></apply><apply id="S3.SS2.SSS0.Px2.p1.9.m9.6.6.4.3.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.6.6.4.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.9.m9.6.6.4.3.1.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.6.6.4.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.9.m9.6.6.4.3.2.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.6.6.4.3.2">𝑊</ci><apply id="S3.SS2.SSS0.Px2.p1.9.m9.4.4.1.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.4.4.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.9.m9.4.4.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.4.4.1">subscript</csymbol><apply id="S3.SS2.SSS0.Px2.p1.9.m9.4.4.1.3.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.4.4.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.9.m9.4.4.1.3.1.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.4.4.1">superscript</csymbol><apply id="S3.SS2.SSS0.Px2.p1.9.m9.4.4.1.3.2.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.4.4.1.3.2"><ci id="S3.SS2.SSS0.Px2.p1.9.m9.4.4.1.3.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.4.4.1.3.2.1">^</ci><ci id="S3.SS2.SSS0.Px2.p1.9.m9.4.4.1.3.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.4.4.1.3.2.2">𝐇</ci></apply><apply id="S3.SS2.SSS0.Px2.p1.9.m9.4.4.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.4.4.1.1.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px2.p1.9.m9.4.4.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.4.4.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px2.p1.9.m9.4.4.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.4.4.1.1.1.1">𝑙</ci></apply></apply><ci id="S3.SS2.SSS0.Px2.p1.9.m9.4.4.1.4.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.4.4.1.4">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.9.m9.6c">\mathbf{K}^{[l]}_{t},\mathbf{V}^{[l]}_{t}\leftarrow\mathbf{\hat{H}}^{[l]}_{t}W%
^{\mathbf{\hat{H}}^{[l]}_{t}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.9.m9.6d">bold_K start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , bold_V start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ← over^ start_ARG bold_H end_ARG start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_W start_POSTSUPERSCRIPT over^ start_ARG bold_H end_ARG start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS0.Px2.p2">
<p class="ltx_p" id="S3.SS2.SSS0.Px2.p2.15">This configuration enables cross-frame channel attention, where the query from <math alttext="\mathbf{F}^{[l]}_{t}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.1.m1.1"><semantics id="S3.SS2.SSS0.Px2.p2.1.m1.1a"><msubsup id="S3.SS2.SSS0.Px2.p2.1.m1.1.2" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.2.cmml"><mi id="S3.SS2.SSS0.Px2.p2.1.m1.1.2.2.2" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.2.2.2.cmml">𝐅</mi><mi id="S3.SS2.SSS0.Px2.p2.1.m1.1.2.3" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.2.3.cmml">t</mi><mrow id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.3" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.2.cmml"><mo id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.2.1.cmml">]</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.1.m1.1b"><apply id="S3.SS2.SSS0.Px2.p2.1.m1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.1.m1.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.2">subscript</csymbol><apply id="S3.SS2.SSS0.Px2.p2.1.m1.1.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.1.m1.1.2.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.1.m1.1.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.2.2.2">𝐅</ci><apply id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1">𝑙</ci></apply></apply><ci id="S3.SS2.SSS0.Px2.p2.1.m1.1.2.3.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.2.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.1.m1.1c">\mathbf{F}^{[l]}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.1.m1.1d">bold_F start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> attends to channels from both <math alttext="\mathbf{\hat{H}}^{[l]}_{t}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.2.m2.1"><semantics id="S3.SS2.SSS0.Px2.p2.2.m2.1a"><msubsup id="S3.SS2.SSS0.Px2.p2.2.m2.1.2" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.2.cmml"><mover accent="true" id="S3.SS2.SSS0.Px2.p2.2.m2.1.2.2.2" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px2.p2.2.m2.1.2.2.2.2" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.2.2.2.2.cmml">𝐇</mi><mo id="S3.SS2.SSS0.Px2.p2.2.m2.1.2.2.2.1" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.2.2.2.1.cmml">^</mo></mover><mi id="S3.SS2.SSS0.Px2.p2.2.m2.1.2.3" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.2.3.cmml">t</mi><mrow id="S3.SS2.SSS0.Px2.p2.2.m2.1.1.1.3" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.1.1.2.cmml"><mo id="S3.SS2.SSS0.Px2.p2.2.m2.1.1.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.1.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px2.p2.2.m2.1.1.1.1" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px2.p2.2.m2.1.1.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.1.1.2.1.cmml">]</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.2.m2.1b"><apply id="S3.SS2.SSS0.Px2.p2.2.m2.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.2.m2.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.2">subscript</csymbol><apply id="S3.SS2.SSS0.Px2.p2.2.m2.1.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.2.m2.1.2.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.2">superscript</csymbol><apply id="S3.SS2.SSS0.Px2.p2.2.m2.1.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.2.2.2"><ci id="S3.SS2.SSS0.Px2.p2.2.m2.1.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.2.2.2.1">^</ci><ci id="S3.SS2.SSS0.Px2.p2.2.m2.1.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.2.2.2.2">𝐇</ci></apply><apply id="S3.SS2.SSS0.Px2.p2.2.m2.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.1.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px2.p2.2.m2.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.1.1.1">𝑙</ci></apply></apply><ci id="S3.SS2.SSS0.Px2.p2.2.m2.1.2.3.cmml" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.2.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.2.m2.1c">\mathbf{\hat{H}}^{[l]}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.2.m2.1d">over^ start_ARG bold_H end_ARG start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{F}^{[l]}_{t}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.3.m3.1"><semantics id="S3.SS2.SSS0.Px2.p2.3.m3.1a"><msubsup id="S3.SS2.SSS0.Px2.p2.3.m3.1.2" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.2.cmml"><mi id="S3.SS2.SSS0.Px2.p2.3.m3.1.2.2.2" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.2.2.2.cmml">𝐅</mi><mi id="S3.SS2.SSS0.Px2.p2.3.m3.1.2.3" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.2.3.cmml">t</mi><mrow id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.3" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.2.cmml"><mo id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.2.1.cmml">]</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.3.m3.1b"><apply id="S3.SS2.SSS0.Px2.p2.3.m3.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.3.m3.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.2">subscript</csymbol><apply id="S3.SS2.SSS0.Px2.p2.3.m3.1.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.3.m3.1.2.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.3.m3.1.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.2.2.2">𝐅</ci><apply id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1">𝑙</ci></apply></apply><ci id="S3.SS2.SSS0.Px2.p2.3.m3.1.2.3.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.2.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.3.m3.1c">\mathbf{F}^{[l]}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.3.m3.1d">bold_F start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, and accentuates temporal history states as necessary in order to restore the given frame.
The cross-channel attention map <math alttext="\mathbf{A}\in\mathbb{R}^{(\tau+1)c^{l}\times c^{l}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.4.m4.1"><semantics id="S3.SS2.SSS0.Px2.p2.4.m4.1a"><mrow id="S3.SS2.SSS0.Px2.p2.4.m4.1.2" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.2.cmml"><mi id="S3.SS2.SSS0.Px2.p2.4.m4.1.2.2" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.2.2.cmml">𝐀</mi><mo id="S3.SS2.SSS0.Px2.p2.4.m4.1.2.1" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.2.1.cmml">∈</mo><msup id="S3.SS2.SSS0.Px2.p2.4.m4.1.2.3" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.2.3.cmml"><mi id="S3.SS2.SSS0.Px2.p2.4.m4.1.2.3.2" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.2.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.cmml"><mrow id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.cmml"><mrow id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.1.1" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.1.1.1" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.1.1.1.2" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.1.1.1.2.cmml">τ</mi><mo id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.1.1.1.1" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.1.1.1.1.cmml">+</mo><mn id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.1.1.1.3" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.2" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.2.cmml">⁢</mo><msup id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.3" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.3.2" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.3.2.cmml">c</mi><mi id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.3.3" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.3.3.cmml">l</mi></msup></mrow><mo id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.2.cmml">×</mo><msup id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.3" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.3.cmml"><mi id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.3.2" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.3.2.cmml">c</mi><mi id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.3.3" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.3.3.cmml">l</mi></msup></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.4.m4.1b"><apply id="S3.SS2.SSS0.Px2.p2.4.m4.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.2"><in id="S3.SS2.SSS0.Px2.p2.4.m4.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.2.1"></in><ci id="S3.SS2.SSS0.Px2.p2.4.m4.1.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.2.2">𝐀</ci><apply id="S3.SS2.SSS0.Px2.p2.4.m4.1.2.3.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.4.m4.1.2.3.1.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.2.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.4.m4.1.2.3.2.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.2.3.2">ℝ</ci><apply id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1"><times id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.2"></times><apply id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1"><times id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.2"></times><apply id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.1.1"><plus id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.1.1.1.1"></plus><ci id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.1.1.1.2">𝜏</ci><cn id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.1.1.1.3">1</cn></apply><apply id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.3.2">𝑐</ci><ci id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.3.3">𝑙</ci></apply></apply><apply id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.3.2">𝑐</ci><ci id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.3.3.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.3.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.4.m4.1c">\mathbf{A}\in\mathbb{R}^{(\tau+1)c^{l}\times c^{l}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.4.m4.1d">bold_A ∈ blackboard_R start_POSTSUPERSCRIPT ( italic_τ + 1 ) italic_c start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT × italic_c start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> is then computed through the dot product, i.e., <math alttext="\mathbf{A}^{[l]}_{t}=(\mathbf{Q}^{[l]}_{t}\cdot\mathbf{K}^{[l]}_{t})/\alpha\in%
\mathbb{R}^{(\tau+1)c^{l}\times c^{l}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.5.m5.5"><semantics id="S3.SS2.SSS0.Px2.p2.5.m5.5a"><mrow id="S3.SS2.SSS0.Px2.p2.5.m5.5.5" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.cmml"><msubsup id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.3" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.3.cmml"><mi id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.3.2.2" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.3.2.2.cmml">𝐀</mi><mi id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.3.3" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.3.3.cmml">t</mi><mrow id="S3.SS2.SSS0.Px2.p2.5.m5.1.1.1.3" xref="S3.SS2.SSS0.Px2.p2.5.m5.1.1.1.2.cmml"><mo id="S3.SS2.SSS0.Px2.p2.5.m5.1.1.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.5.m5.1.1.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px2.p2.5.m5.1.1.1.1" xref="S3.SS2.SSS0.Px2.p2.5.m5.1.1.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px2.p2.5.m5.1.1.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.5.m5.1.1.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.4" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.4.cmml">=</mo><mrow id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.cmml"><mrow id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1.1.cmml"><mo id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1.1" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1.1.cmml"><msubsup id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1.1.2" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1.1.2.cmml"><mi id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1.1.2.2.2" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1.1.2.2.2.cmml">𝐐</mi><mi id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1.1.2.3" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1.1.2.3.cmml">t</mi><mrow id="S3.SS2.SSS0.Px2.p2.5.m5.2.2.1.3" xref="S3.SS2.SSS0.Px2.p2.5.m5.2.2.1.2.cmml"><mo id="S3.SS2.SSS0.Px2.p2.5.m5.2.2.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.5.m5.2.2.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px2.p2.5.m5.2.2.1.1" xref="S3.SS2.SSS0.Px2.p2.5.m5.2.2.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px2.p2.5.m5.2.2.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.5.m5.2.2.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1.1.1.cmml">⋅</mo><msubsup id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1.1.3" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1.1.3.2.2" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1.1.3.2.2.cmml">𝐊</mi><mi id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1.1.3.3" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1.1.3.3.cmml">t</mi><mrow id="S3.SS2.SSS0.Px2.p2.5.m5.3.3.1.3" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.3.1.2.cmml"><mo id="S3.SS2.SSS0.Px2.p2.5.m5.3.3.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.3.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px2.p2.5.m5.3.3.1.1" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.3.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px2.p2.5.m5.3.3.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.3.1.2.1.cmml">]</mo></mrow></msubsup></mrow><mo id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1.3" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.2" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.2.cmml">/</mo><mi id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.3" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.3.cmml">α</mi></mrow><mo id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.5" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.5.cmml">∈</mo><msup id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.6" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.6.cmml"><mi id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.6.2" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.6.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1" xref="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.cmml"><mrow id="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.1" xref="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.1.cmml"><mrow id="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.1.1.1" xref="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.1.1.1.1" xref="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.1.1.1.1.2" xref="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.1.1.1.1.2.cmml">τ</mi><mo id="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.1.1.1.1.1" xref="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.1.1.1.1.1.cmml">+</mo><mn id="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.1.1.1.1.3" xref="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.1.2" xref="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.1.2.cmml">⁢</mo><msup id="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.1.3" xref="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.1.3.cmml"><mi id="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.1.3.2" xref="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.1.3.2.cmml">c</mi><mi id="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.1.3.3" xref="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.1.3.3.cmml">l</mi></msup></mrow><mo id="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.2" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.2.cmml">×</mo><msup id="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.3" xref="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.3.cmml"><mi id="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.3.2" xref="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.3.2.cmml">c</mi><mi id="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.3.3" xref="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.3.3.cmml">l</mi></msup></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.5.m5.5b"><apply id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5"><and id="S3.SS2.SSS0.Px2.p2.5.m5.5.5a.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5"></and><apply id="S3.SS2.SSS0.Px2.p2.5.m5.5.5b.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5"><eq id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.4.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.4"></eq><apply id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.3.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.3.1.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.3">subscript</csymbol><apply id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.3.2.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.3.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.3.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.3.2.2">𝐀</ci><apply id="S3.SS2.SSS0.Px2.p2.5.m5.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.1.1.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px2.p2.5.m5.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px2.p2.5.m5.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.1.1.1.1">𝑙</ci></apply></apply><ci id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.3.3.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.3.3">𝑡</ci></apply><apply id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1"><divide id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.2"></divide><apply id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1"><ci id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1.1.1">⋅</ci><apply id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1.1.2">subscript</csymbol><apply id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1.1.2.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1.1.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1.1.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1.1.2.2.2">𝐐</ci><apply id="S3.SS2.SSS0.Px2.p2.5.m5.2.2.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.2.2.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px2.p2.5.m5.2.2.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.2.2.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px2.p2.5.m5.2.2.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.2.2.1.1">𝑙</ci></apply></apply><ci id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1.1.3">subscript</csymbol><apply id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1.1.3.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1.1.3.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1.1.3.2.2">𝐊</ci><apply id="S3.SS2.SSS0.Px2.p2.5.m5.3.3.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.3.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px2.p2.5.m5.3.3.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.3.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px2.p2.5.m5.3.3.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.3.3.1.1">𝑙</ci></apply></apply><ci id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.1.1.1.3.3">𝑡</ci></apply></apply><ci id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.3.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.3">𝛼</ci></apply></apply><apply id="S3.SS2.SSS0.Px2.p2.5.m5.5.5c.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5"><in id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.5.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.5"></in><share href="https://arxiv.org/html/2410.03936v1#S3.SS2.SSS0.Px2.p2.5.m5.5.5.1.cmml" id="S3.SS2.SSS0.Px2.p2.5.m5.5.5d.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5"></share><apply id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.6.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.6"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.6.1.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.6">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.5.m5.5.5.6.2.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.5.5.6.2">ℝ</ci><apply id="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1"><times id="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.2"></times><apply id="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.1"><times id="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.1.2"></times><apply id="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.1.1.1"><plus id="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.1.1.1.1.1"></plus><ci id="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.1.1.1.1.2">𝜏</ci><cn id="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.1.1.1.1.3">1</cn></apply><apply id="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.1.3.2">𝑐</ci><ci id="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.1.3.3.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.1.3.3">𝑙</ci></apply></apply><apply id="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.3.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.3.1.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.3.2.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.3.2">𝑐</ci><ci id="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.3.3.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.4.4.1.3.3">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.5.m5.5c">\mathbf{A}^{[l]}_{t}=(\mathbf{Q}^{[l]}_{t}\cdot\mathbf{K}^{[l]}_{t})/\alpha\in%
\mathbb{R}^{(\tau+1)c^{l}\times c^{l}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.5.m5.5d">bold_A start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = ( bold_Q start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ⋅ bold_K start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) / italic_α ∈ blackboard_R start_POSTSUPERSCRIPT ( italic_τ + 1 ) italic_c start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT × italic_c start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="\alpha" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.6.m6.1"><semantics id="S3.SS2.SSS0.Px2.p2.6.m6.1a"><mi id="S3.SS2.SSS0.Px2.p2.6.m6.1.1" xref="S3.SS2.SSS0.Px2.p2.6.m6.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.6.m6.1b"><ci id="S3.SS2.SSS0.Px2.p2.6.m6.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.6.m6.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.6.m6.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.6.m6.1d">italic_α</annotation></semantics></math> is the scale factor to control the dot product magnitude. Note that, we overload the notation <math alttext="\mathbf{A}^{[l]}_{t}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.7.m7.1"><semantics id="S3.SS2.SSS0.Px2.p2.7.m7.1a"><msubsup id="S3.SS2.SSS0.Px2.p2.7.m7.1.2" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.2.cmml"><mi id="S3.SS2.SSS0.Px2.p2.7.m7.1.2.2.2" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.2.2.2.cmml">𝐀</mi><mi id="S3.SS2.SSS0.Px2.p2.7.m7.1.2.3" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.2.3.cmml">t</mi><mrow id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.1.3" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1.1.2.cmml"><mo id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.1.1" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1.1.2.1.cmml">]</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.7.m7.1b"><apply id="S3.SS2.SSS0.Px2.p2.7.m7.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.7.m7.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.2">subscript</csymbol><apply id="S3.SS2.SSS0.Px2.p2.7.m7.1.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.7.m7.1.2.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.7.m7.1.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.2.2.2">𝐀</ci><apply id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1.1.1">𝑙</ci></apply></apply><ci id="S3.SS2.SSS0.Px2.p2.7.m7.1.2.3.cmml" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.2.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.7.m7.1c">\mathbf{A}^{[l]}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.7.m7.1d">bold_A start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> for exposition. The output feature map, <math alttext="\mathbf{y}^{[l]}_{t}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.8.m8.1"><semantics id="S3.SS2.SSS0.Px2.p2.8.m8.1a"><msubsup id="S3.SS2.SSS0.Px2.p2.8.m8.1.2" xref="S3.SS2.SSS0.Px2.p2.8.m8.1.2.cmml"><mi id="S3.SS2.SSS0.Px2.p2.8.m8.1.2.2.2" xref="S3.SS2.SSS0.Px2.p2.8.m8.1.2.2.2.cmml">𝐲</mi><mi id="S3.SS2.SSS0.Px2.p2.8.m8.1.2.3" xref="S3.SS2.SSS0.Px2.p2.8.m8.1.2.3.cmml">t</mi><mrow id="S3.SS2.SSS0.Px2.p2.8.m8.1.1.1.3" xref="S3.SS2.SSS0.Px2.p2.8.m8.1.1.1.2.cmml"><mo id="S3.SS2.SSS0.Px2.p2.8.m8.1.1.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.8.m8.1.1.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px2.p2.8.m8.1.1.1.1" xref="S3.SS2.SSS0.Px2.p2.8.m8.1.1.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px2.p2.8.m8.1.1.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.8.m8.1.1.1.2.1.cmml">]</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.8.m8.1b"><apply id="S3.SS2.SSS0.Px2.p2.8.m8.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.8.m8.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.8.m8.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.8.m8.1.2">subscript</csymbol><apply id="S3.SS2.SSS0.Px2.p2.8.m8.1.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.8.m8.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.8.m8.1.2.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.8.m8.1.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.8.m8.1.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.8.m8.1.2.2.2">𝐲</ci><apply id="S3.SS2.SSS0.Px2.p2.8.m8.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.8.m8.1.1.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px2.p2.8.m8.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.8.m8.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px2.p2.8.m8.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.8.m8.1.1.1.1">𝑙</ci></apply></apply><ci id="S3.SS2.SSS0.Px2.p2.8.m8.1.2.3.cmml" xref="S3.SS2.SSS0.Px2.p2.8.m8.1.2.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.8.m8.1c">\mathbf{y}^{[l]}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.8.m8.1d">bold_y start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> takes the shape <math alttext="\mathbb{R}^{h^{l}\times w^{l}\times c^{l}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.9.m9.1"><semantics id="S3.SS2.SSS0.Px2.p2.9.m9.1a"><msup id="S3.SS2.SSS0.Px2.p2.9.m9.1.1" xref="S3.SS2.SSS0.Px2.p2.9.m9.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p2.9.m9.1.1.2" xref="S3.SS2.SSS0.Px2.p2.9.m9.1.1.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3" xref="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.cmml"><msup id="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.2" xref="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.2.cmml"><mi id="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.2.2" xref="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.2.2.cmml">h</mi><mi id="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.2.3" xref="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.2.3.cmml">l</mi></msup><mo id="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.1.cmml">×</mo><msup id="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.3" xref="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.3.cmml"><mi id="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.3.2" xref="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.3.2.cmml">w</mi><mi id="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.3.3" xref="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.3.3.cmml">l</mi></msup><mo id="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.1.cmml">×</mo><msup id="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.4" xref="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.4.cmml"><mi id="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.4.2" xref="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.4.2.cmml">c</mi><mi id="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.4.3" xref="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.4.3.cmml">l</mi></msup></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.9.m9.1b"><apply id="S3.SS2.SSS0.Px2.p2.9.m9.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.9.m9.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.9.m9.1.1">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.9.m9.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.9.m9.1.1.2">ℝ</ci><apply id="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3"><times id="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.1"></times><apply id="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.2.2">ℎ</ci><ci id="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.2.3.cmml" xref="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.2.3">𝑙</ci></apply><apply id="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.3.cmml" xref="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.3.1.cmml" xref="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.3.2.cmml" xref="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.3.2">𝑤</ci><ci id="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.3.3.cmml" xref="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.3.3">𝑙</ci></apply><apply id="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.4.cmml" xref="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.4"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.4.1.cmml" xref="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.4">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.4.2.cmml" xref="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.4.2">𝑐</ci><ci id="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.4.3.cmml" xref="S3.SS2.SSS0.Px2.p2.9.m9.1.1.3.4.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.9.m9.1c">\mathbb{R}^{h^{l}\times w^{l}\times c^{l}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.9.m9.1d">blackboard_R start_POSTSUPERSCRIPT italic_h start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT × italic_w start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT × italic_c start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> since the attention matrix takes the shape <math alttext="\in\mathbb{R}^{(\tau+1)c^{l}\times c^{l}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.10.m10.1"><semantics id="S3.SS2.SSS0.Px2.p2.10.m10.1a"><mrow id="S3.SS2.SSS0.Px2.p2.10.m10.1.2" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.2.cmml"><mi id="S3.SS2.SSS0.Px2.p2.10.m10.1.2.2" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.2.2.cmml"></mi><mo id="S3.SS2.SSS0.Px2.p2.10.m10.1.2.1" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.2.1.cmml">∈</mo><msup id="S3.SS2.SSS0.Px2.p2.10.m10.1.2.3" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.2.3.cmml"><mi id="S3.SS2.SSS0.Px2.p2.10.m10.1.2.3.2" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.2.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.cmml"><mrow id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.1" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.1.cmml"><mrow id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.1.1.1" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.1.1.1.1" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.1.1.1.1.2" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.1.1.1.1.2.cmml">τ</mi><mo id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.1.1.1.1.1" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.1.1.1.1.1.cmml">+</mo><mn id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.1.1.1.1.3" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.1.2" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.1.2.cmml">⁢</mo><msup id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.1.3" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.1.3.2" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.1.3.2.cmml">c</mi><mi id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.1.3.3" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.1.3.3.cmml">l</mi></msup></mrow><mo id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.2.cmml">×</mo><msup id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.3" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.3.cmml"><mi id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.3.2" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.3.2.cmml">c</mi><mi id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.3.3" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.3.3.cmml">l</mi></msup></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.10.m10.1b"><apply id="S3.SS2.SSS0.Px2.p2.10.m10.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.2"><in id="S3.SS2.SSS0.Px2.p2.10.m10.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.2.1"></in><csymbol cd="latexml" id="S3.SS2.SSS0.Px2.p2.10.m10.1.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.2.2">absent</csymbol><apply id="S3.SS2.SSS0.Px2.p2.10.m10.1.2.3.cmml" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.10.m10.1.2.3.1.cmml" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.2.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.10.m10.1.2.3.2.cmml" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.2.3.2">ℝ</ci><apply id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1"><times id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.2"></times><apply id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.1"><times id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.1.2"></times><apply id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.1.1.1"><plus id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.1.1.1.1.1"></plus><ci id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.1.1.1.1.2">𝜏</ci><cn id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.1.1.1.1.3">1</cn></apply><apply id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.1.3.2">𝑐</ci><ci id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.1.3.3">𝑙</ci></apply></apply><apply id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.3.2">𝑐</ci><ci id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.3.3.cmml" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.3.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.10.m10.1c">\in\mathbb{R}^{(\tau+1)c^{l}\times c^{l}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.10.m10.1d">∈ blackboard_R start_POSTSUPERSCRIPT ( italic_τ + 1 ) italic_c start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT × italic_c start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, while <math alttext="\mathbf{V}^{[l]}_{t}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.11.m11.1"><semantics id="S3.SS2.SSS0.Px2.p2.11.m11.1a"><msubsup id="S3.SS2.SSS0.Px2.p2.11.m11.1.2" xref="S3.SS2.SSS0.Px2.p2.11.m11.1.2.cmml"><mi id="S3.SS2.SSS0.Px2.p2.11.m11.1.2.2.2" xref="S3.SS2.SSS0.Px2.p2.11.m11.1.2.2.2.cmml">𝐕</mi><mi id="S3.SS2.SSS0.Px2.p2.11.m11.1.2.3" xref="S3.SS2.SSS0.Px2.p2.11.m11.1.2.3.cmml">t</mi><mrow id="S3.SS2.SSS0.Px2.p2.11.m11.1.1.1.3" xref="S3.SS2.SSS0.Px2.p2.11.m11.1.1.1.2.cmml"><mo id="S3.SS2.SSS0.Px2.p2.11.m11.1.1.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.11.m11.1.1.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px2.p2.11.m11.1.1.1.1" xref="S3.SS2.SSS0.Px2.p2.11.m11.1.1.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px2.p2.11.m11.1.1.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.11.m11.1.1.1.2.1.cmml">]</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.11.m11.1b"><apply id="S3.SS2.SSS0.Px2.p2.11.m11.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.11.m11.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.11.m11.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.11.m11.1.2">subscript</csymbol><apply id="S3.SS2.SSS0.Px2.p2.11.m11.1.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.11.m11.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.11.m11.1.2.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.11.m11.1.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.11.m11.1.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.11.m11.1.2.2.2">𝐕</ci><apply id="S3.SS2.SSS0.Px2.p2.11.m11.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.11.m11.1.1.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px2.p2.11.m11.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.11.m11.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px2.p2.11.m11.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.11.m11.1.1.1.1">𝑙</ci></apply></apply><ci id="S3.SS2.SSS0.Px2.p2.11.m11.1.2.3.cmml" xref="S3.SS2.SSS0.Px2.p2.11.m11.1.2.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.11.m11.1c">\mathbf{V}^{[l]}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.11.m11.1d">bold_V start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is <math alttext="\in\mathbb{R}^{(\tau+1)c^{l}\times h^{l}\times w^{l}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.12.m12.1"><semantics id="S3.SS2.SSS0.Px2.p2.12.m12.1a"><mrow id="S3.SS2.SSS0.Px2.p2.12.m12.1.2" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.2.cmml"><mi id="S3.SS2.SSS0.Px2.p2.12.m12.1.2.2" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.2.2.cmml"></mi><mo id="S3.SS2.SSS0.Px2.p2.12.m12.1.2.1" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.2.1.cmml">∈</mo><msup id="S3.SS2.SSS0.Px2.p2.12.m12.1.2.3" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.2.3.cmml"><mi id="S3.SS2.SSS0.Px2.p2.12.m12.1.2.3.2" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.2.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.cmml"><mrow id="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.1" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.1.cmml"><mrow id="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.1.1.1" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.1.1.1.1" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.1.1.1.1.2" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.1.1.1.1.2.cmml">τ</mi><mo id="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.1.1.1.1.1" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.1.1.1.1.1.cmml">+</mo><mn id="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.1.1.1.1.3" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.1.2" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.1.2.cmml">⁢</mo><msup id="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.1.3" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.1.3.2" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.1.3.2.cmml">c</mi><mi id="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.1.3.3" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.1.3.3.cmml">l</mi></msup></mrow><mo id="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.2.cmml">×</mo><msup id="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.3" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.3.cmml"><mi id="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.3.2" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.3.2.cmml">h</mi><mi id="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.3.3" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.3.3.cmml">l</mi></msup><mo id="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.2a" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.2.cmml">×</mo><msup id="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.4" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.4.cmml"><mi id="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.4.2" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.4.2.cmml">w</mi><mi id="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.4.3" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.4.3.cmml">l</mi></msup></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.12.m12.1b"><apply id="S3.SS2.SSS0.Px2.p2.12.m12.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.2"><in id="S3.SS2.SSS0.Px2.p2.12.m12.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.2.1"></in><csymbol cd="latexml" id="S3.SS2.SSS0.Px2.p2.12.m12.1.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.2.2">absent</csymbol><apply id="S3.SS2.SSS0.Px2.p2.12.m12.1.2.3.cmml" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.12.m12.1.2.3.1.cmml" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.2.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.12.m12.1.2.3.2.cmml" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.2.3.2">ℝ</ci><apply id="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1"><times id="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.2"></times><apply id="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.1"><times id="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.1.2"></times><apply id="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.1.1.1"><plus id="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.1.1.1.1.1"></plus><ci id="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.1.1.1.1.2">𝜏</ci><cn id="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.1.1.1.1.3">1</cn></apply><apply id="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.1.3.2">𝑐</ci><ci id="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.1.3.3">𝑙</ci></apply></apply><apply id="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.3.2">ℎ</ci><ci id="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.3.3.cmml" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.3.3">𝑙</ci></apply><apply id="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.4.cmml" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.4.1.cmml" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.4">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.4.2.cmml" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.4.2">𝑤</ci><ci id="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.4.3.cmml" xref="S3.SS2.SSS0.Px2.p2.12.m12.1.1.1.4.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.12.m12.1c">\in\mathbb{R}^{(\tau+1)c^{l}\times h^{l}\times w^{l}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.12.m12.1d">∈ blackboard_R start_POSTSUPERSCRIPT ( italic_τ + 1 ) italic_c start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT × italic_h start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT × italic_w start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>.<span class="ltx_note ltx_role_footnote" id="footnote4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span>This is because in practice, channels are collapsed in the temporal dimension.</span></span></span> If <math alttext="\sigma" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.13.m13.1"><semantics id="S3.SS2.SSS0.Px2.p2.13.m13.1a"><mi id="S3.SS2.SSS0.Px2.p2.13.m13.1.1" xref="S3.SS2.SSS0.Px2.p2.13.m13.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.13.m13.1b"><ci id="S3.SS2.SSS0.Px2.p2.13.m13.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.13.m13.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.13.m13.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.13.m13.1d">italic_σ</annotation></semantics></math> denotes the softmax operator, and <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.14.m14.1"><semantics id="S3.SS2.SSS0.Px2.p2.14.m14.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS0.Px2.p2.14.m14.1.1" xref="S3.SS2.SSS0.Px2.p2.14.m14.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.14.m14.1b"><ci id="S3.SS2.SSS0.Px2.p2.14.m14.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.14.m14.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.14.m14.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.14.m14.1d">caligraphic_D</annotation></semantics></math> is the skip connection, we then compute the output, <math alttext="\mathbf{y}^{[l]}_{t}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.15.m15.1"><semantics id="S3.SS2.SSS0.Px2.p2.15.m15.1a"><msubsup id="S3.SS2.SSS0.Px2.p2.15.m15.1.2" xref="S3.SS2.SSS0.Px2.p2.15.m15.1.2.cmml"><mi id="S3.SS2.SSS0.Px2.p2.15.m15.1.2.2.2" xref="S3.SS2.SSS0.Px2.p2.15.m15.1.2.2.2.cmml">𝐲</mi><mi id="S3.SS2.SSS0.Px2.p2.15.m15.1.2.3" xref="S3.SS2.SSS0.Px2.p2.15.m15.1.2.3.cmml">t</mi><mrow id="S3.SS2.SSS0.Px2.p2.15.m15.1.1.1.3" xref="S3.SS2.SSS0.Px2.p2.15.m15.1.1.1.2.cmml"><mo id="S3.SS2.SSS0.Px2.p2.15.m15.1.1.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.15.m15.1.1.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px2.p2.15.m15.1.1.1.1" xref="S3.SS2.SSS0.Px2.p2.15.m15.1.1.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px2.p2.15.m15.1.1.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.15.m15.1.1.1.2.1.cmml">]</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.15.m15.1b"><apply id="S3.SS2.SSS0.Px2.p2.15.m15.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.15.m15.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.15.m15.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.15.m15.1.2">subscript</csymbol><apply id="S3.SS2.SSS0.Px2.p2.15.m15.1.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.15.m15.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.15.m15.1.2.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.15.m15.1.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.15.m15.1.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.15.m15.1.2.2.2">𝐲</ci><apply id="S3.SS2.SSS0.Px2.p2.15.m15.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.15.m15.1.1.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px2.p2.15.m15.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.15.m15.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px2.p2.15.m15.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.15.m15.1.1.1.1">𝑙</ci></apply></apply><ci id="S3.SS2.SSS0.Px2.p2.15.m15.1.2.3.cmml" xref="S3.SS2.SSS0.Px2.p2.15.m15.1.2.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.15.m15.1c">\mathbf{y}^{[l]}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.15.m15.1d">bold_y start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, as,</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A7.EGx5">
<tbody id="S3.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{y}^{[l]}_{t}" class="ltx_Math" display="inline" id="S3.E7.m1.1"><semantics id="S3.E7.m1.1a"><msubsup id="S3.E7.m1.1.2" xref="S3.E7.m1.1.2.cmml"><mi id="S3.E7.m1.1.2.2.2" xref="S3.E7.m1.1.2.2.2.cmml">𝐲</mi><mi id="S3.E7.m1.1.2.3" xref="S3.E7.m1.1.2.3.cmml">t</mi><mrow id="S3.E7.m1.1.1.1.3" xref="S3.E7.m1.1.1.1.2.cmml"><mo id="S3.E7.m1.1.1.1.3.1" stretchy="false" xref="S3.E7.m1.1.1.1.2.1.cmml">[</mo><mi id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml">l</mi><mo id="S3.E7.m1.1.1.1.3.2" stretchy="false" xref="S3.E7.m1.1.1.1.2.1.cmml">]</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.E7.m1.1b"><apply id="S3.E7.m1.1.2.cmml" xref="S3.E7.m1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.2.1.cmml" xref="S3.E7.m1.1.2">subscript</csymbol><apply id="S3.E7.m1.1.2.2.cmml" xref="S3.E7.m1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.2.2.1.cmml" xref="S3.E7.m1.1.2">superscript</csymbol><ci id="S3.E7.m1.1.2.2.2.cmml" xref="S3.E7.m1.1.2.2.2">𝐲</ci><apply id="S3.E7.m1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.3"><csymbol cd="latexml" id="S3.E7.m1.1.1.1.2.1.cmml" xref="S3.E7.m1.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1">𝑙</ci></apply></apply><ci id="S3.E7.m1.1.2.3.cmml" xref="S3.E7.m1.1.2.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.1c">\displaystyle\mathbf{y}^{[l]}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.1d">bold_y start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\left[\sigma(\mathbf{A}^{[l]}_{t})\mathbf{V}^{[l]}_{t}\right]W^{%
\mathbf{\hat{H}}_{t}^{[l]}}+\mathcal{D}_{t}(\mathbf{F}_{t}^{[l]})\in\mathbb{R}%
^{h^{l}\times w^{l}\times c^{l}}." class="ltx_Math" display="inline" id="S3.E7.m2.5"><semantics id="S3.E7.m2.5a"><mrow id="S3.E7.m2.5.5.1" xref="S3.E7.m2.5.5.1.1.cmml"><mrow id="S3.E7.m2.5.5.1.1" xref="S3.E7.m2.5.5.1.1.cmml"><mi id="S3.E7.m2.5.5.1.1.4" xref="S3.E7.m2.5.5.1.1.4.cmml"></mi><mo id="S3.E7.m2.5.5.1.1.5" xref="S3.E7.m2.5.5.1.1.5.cmml">=</mo><mrow id="S3.E7.m2.5.5.1.1.2" xref="S3.E7.m2.5.5.1.1.2.cmml"><mrow id="S3.E7.m2.5.5.1.1.1.1" xref="S3.E7.m2.5.5.1.1.1.1.cmml"><mrow id="S3.E7.m2.5.5.1.1.1.1.1.1" xref="S3.E7.m2.5.5.1.1.1.1.1.2.cmml"><mo id="S3.E7.m2.5.5.1.1.1.1.1.1.2" xref="S3.E7.m2.5.5.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E7.m2.5.5.1.1.1.1.1.1.1" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.cmml"><mi id="S3.E7.m2.5.5.1.1.1.1.1.1.1.3" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.3.cmml">σ</mi><mo id="S3.E7.m2.5.5.1.1.1.1.1.1.1.2" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐀</mi><mi id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi><mrow id="S3.E7.m2.1.1.1.3" xref="S3.E7.m2.1.1.1.2.cmml"><mo id="S3.E7.m2.1.1.1.3.1" stretchy="false" xref="S3.E7.m2.1.1.1.2.1.cmml">[</mo><mi id="S3.E7.m2.1.1.1.1" xref="S3.E7.m2.1.1.1.1.cmml">l</mi><mo id="S3.E7.m2.1.1.1.3.2" stretchy="false" xref="S3.E7.m2.1.1.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E7.m2.5.5.1.1.1.1.1.1.1.2a" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.2.cmml">⁢</mo><msubsup id="S3.E7.m2.5.5.1.1.1.1.1.1.1.4" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.4.cmml"><mi id="S3.E7.m2.5.5.1.1.1.1.1.1.1.4.2.2" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.4.2.2.cmml">𝐕</mi><mi id="S3.E7.m2.5.5.1.1.1.1.1.1.1.4.3" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.4.3.cmml">t</mi><mrow id="S3.E7.m2.2.2.1.3" xref="S3.E7.m2.2.2.1.2.cmml"><mo id="S3.E7.m2.2.2.1.3.1" stretchy="false" xref="S3.E7.m2.2.2.1.2.1.cmml">[</mo><mi id="S3.E7.m2.2.2.1.1" xref="S3.E7.m2.2.2.1.1.cmml">l</mi><mo id="S3.E7.m2.2.2.1.3.2" stretchy="false" xref="S3.E7.m2.2.2.1.2.1.cmml">]</mo></mrow></msubsup></mrow><mo id="S3.E7.m2.5.5.1.1.1.1.1.1.3" xref="S3.E7.m2.5.5.1.1.1.1.1.2.1.cmml">]</mo></mrow><mo id="S3.E7.m2.5.5.1.1.1.1.2" xref="S3.E7.m2.5.5.1.1.1.1.2.cmml">⁢</mo><msup id="S3.E7.m2.5.5.1.1.1.1.3" xref="S3.E7.m2.5.5.1.1.1.1.3.cmml"><mi id="S3.E7.m2.5.5.1.1.1.1.3.2" xref="S3.E7.m2.5.5.1.1.1.1.3.2.cmml">W</mi><msubsup id="S3.E7.m2.3.3.1" xref="S3.E7.m2.3.3.1.cmml"><mover accent="true" id="S3.E7.m2.3.3.1.3.2" xref="S3.E7.m2.3.3.1.3.2.cmml"><mi id="S3.E7.m2.3.3.1.3.2.2" xref="S3.E7.m2.3.3.1.3.2.2.cmml">𝐇</mi><mo id="S3.E7.m2.3.3.1.3.2.1" xref="S3.E7.m2.3.3.1.3.2.1.cmml">^</mo></mover><mi id="S3.E7.m2.3.3.1.3.3" xref="S3.E7.m2.3.3.1.3.3.cmml">t</mi><mrow id="S3.E7.m2.3.3.1.1.1.3" xref="S3.E7.m2.3.3.1.1.1.2.cmml"><mo id="S3.E7.m2.3.3.1.1.1.3.1" stretchy="false" xref="S3.E7.m2.3.3.1.1.1.2.1.cmml">[</mo><mi id="S3.E7.m2.3.3.1.1.1.1" xref="S3.E7.m2.3.3.1.1.1.1.cmml">l</mi><mo id="S3.E7.m2.3.3.1.1.1.3.2" stretchy="false" xref="S3.E7.m2.3.3.1.1.1.2.1.cmml">]</mo></mrow></msubsup></msup></mrow><mo id="S3.E7.m2.5.5.1.1.2.3" xref="S3.E7.m2.5.5.1.1.2.3.cmml">+</mo><mrow id="S3.E7.m2.5.5.1.1.2.2" xref="S3.E7.m2.5.5.1.1.2.2.cmml"><msub id="S3.E7.m2.5.5.1.1.2.2.3" xref="S3.E7.m2.5.5.1.1.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m2.5.5.1.1.2.2.3.2" xref="S3.E7.m2.5.5.1.1.2.2.3.2.cmml">𝒟</mi><mi id="S3.E7.m2.5.5.1.1.2.2.3.3" xref="S3.E7.m2.5.5.1.1.2.2.3.3.cmml">t</mi></msub><mo id="S3.E7.m2.5.5.1.1.2.2.2" xref="S3.E7.m2.5.5.1.1.2.2.2.cmml">⁢</mo><mrow id="S3.E7.m2.5.5.1.1.2.2.1.1" xref="S3.E7.m2.5.5.1.1.2.2.1.1.1.cmml"><mo id="S3.E7.m2.5.5.1.1.2.2.1.1.2" stretchy="false" xref="S3.E7.m2.5.5.1.1.2.2.1.1.1.cmml">(</mo><msubsup id="S3.E7.m2.5.5.1.1.2.2.1.1.1" xref="S3.E7.m2.5.5.1.1.2.2.1.1.1.cmml"><mi id="S3.E7.m2.5.5.1.1.2.2.1.1.1.2.2" xref="S3.E7.m2.5.5.1.1.2.2.1.1.1.2.2.cmml">𝐅</mi><mi id="S3.E7.m2.5.5.1.1.2.2.1.1.1.2.3" xref="S3.E7.m2.5.5.1.1.2.2.1.1.1.2.3.cmml">t</mi><mrow id="S3.E7.m2.4.4.1.3" xref="S3.E7.m2.4.4.1.2.cmml"><mo id="S3.E7.m2.4.4.1.3.1" stretchy="false" xref="S3.E7.m2.4.4.1.2.1.cmml">[</mo><mi id="S3.E7.m2.4.4.1.1" xref="S3.E7.m2.4.4.1.1.cmml">l</mi><mo id="S3.E7.m2.4.4.1.3.2" stretchy="false" xref="S3.E7.m2.4.4.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.E7.m2.5.5.1.1.2.2.1.1.3" stretchy="false" xref="S3.E7.m2.5.5.1.1.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E7.m2.5.5.1.1.6" xref="S3.E7.m2.5.5.1.1.6.cmml">∈</mo><msup id="S3.E7.m2.5.5.1.1.7" xref="S3.E7.m2.5.5.1.1.7.cmml"><mi id="S3.E7.m2.5.5.1.1.7.2" xref="S3.E7.m2.5.5.1.1.7.2.cmml">ℝ</mi><mrow id="S3.E7.m2.5.5.1.1.7.3" xref="S3.E7.m2.5.5.1.1.7.3.cmml"><msup id="S3.E7.m2.5.5.1.1.7.3.2" xref="S3.E7.m2.5.5.1.1.7.3.2.cmml"><mi id="S3.E7.m2.5.5.1.1.7.3.2.2" xref="S3.E7.m2.5.5.1.1.7.3.2.2.cmml">h</mi><mi id="S3.E7.m2.5.5.1.1.7.3.2.3" xref="S3.E7.m2.5.5.1.1.7.3.2.3.cmml">l</mi></msup><mo id="S3.E7.m2.5.5.1.1.7.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E7.m2.5.5.1.1.7.3.1.cmml">×</mo><msup id="S3.E7.m2.5.5.1.1.7.3.3" xref="S3.E7.m2.5.5.1.1.7.3.3.cmml"><mi id="S3.E7.m2.5.5.1.1.7.3.3.2" xref="S3.E7.m2.5.5.1.1.7.3.3.2.cmml">w</mi><mi id="S3.E7.m2.5.5.1.1.7.3.3.3" xref="S3.E7.m2.5.5.1.1.7.3.3.3.cmml">l</mi></msup><mo id="S3.E7.m2.5.5.1.1.7.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.E7.m2.5.5.1.1.7.3.1.cmml">×</mo><msup id="S3.E7.m2.5.5.1.1.7.3.4" xref="S3.E7.m2.5.5.1.1.7.3.4.cmml"><mi id="S3.E7.m2.5.5.1.1.7.3.4.2" xref="S3.E7.m2.5.5.1.1.7.3.4.2.cmml">c</mi><mi id="S3.E7.m2.5.5.1.1.7.3.4.3" xref="S3.E7.m2.5.5.1.1.7.3.4.3.cmml">l</mi></msup></mrow></msup></mrow><mo id="S3.E7.m2.5.5.1.2" lspace="0em" xref="S3.E7.m2.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m2.5b"><apply id="S3.E7.m2.5.5.1.1.cmml" xref="S3.E7.m2.5.5.1"><and id="S3.E7.m2.5.5.1.1a.cmml" xref="S3.E7.m2.5.5.1"></and><apply id="S3.E7.m2.5.5.1.1b.cmml" xref="S3.E7.m2.5.5.1"><eq id="S3.E7.m2.5.5.1.1.5.cmml" xref="S3.E7.m2.5.5.1.1.5"></eq><csymbol cd="latexml" id="S3.E7.m2.5.5.1.1.4.cmml" xref="S3.E7.m2.5.5.1.1.4">absent</csymbol><apply id="S3.E7.m2.5.5.1.1.2.cmml" xref="S3.E7.m2.5.5.1.1.2"><plus id="S3.E7.m2.5.5.1.1.2.3.cmml" xref="S3.E7.m2.5.5.1.1.2.3"></plus><apply id="S3.E7.m2.5.5.1.1.1.1.cmml" xref="S3.E7.m2.5.5.1.1.1.1"><times id="S3.E7.m2.5.5.1.1.1.1.2.cmml" xref="S3.E7.m2.5.5.1.1.1.1.2"></times><apply id="S3.E7.m2.5.5.1.1.1.1.1.2.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E7.m2.5.5.1.1.1.1.1.2.1.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E7.m2.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1"><times id="S3.E7.m2.5.5.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.2"></times><ci id="S3.E7.m2.5.5.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.3">𝜎</ci><apply id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.2">𝐀</ci><apply id="S3.E7.m2.1.1.1.2.cmml" xref="S3.E7.m2.1.1.1.3"><csymbol cd="latexml" id="S3.E7.m2.1.1.1.2.1.cmml" xref="S3.E7.m2.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.E7.m2.1.1.1.1.cmml" xref="S3.E7.m2.1.1.1.1">𝑙</ci></apply></apply><ci id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.E7.m2.5.5.1.1.1.1.1.1.1.4.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E7.m2.5.5.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.4">subscript</csymbol><apply id="S3.E7.m2.5.5.1.1.1.1.1.1.1.4.2.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E7.m2.5.5.1.1.1.1.1.1.1.4.2.1.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.4">superscript</csymbol><ci id="S3.E7.m2.5.5.1.1.1.1.1.1.1.4.2.2.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.4.2.2">𝐕</ci><apply id="S3.E7.m2.2.2.1.2.cmml" xref="S3.E7.m2.2.2.1.3"><csymbol cd="latexml" id="S3.E7.m2.2.2.1.2.1.cmml" xref="S3.E7.m2.2.2.1.3.1">delimited-[]</csymbol><ci id="S3.E7.m2.2.2.1.1.cmml" xref="S3.E7.m2.2.2.1.1">𝑙</ci></apply></apply><ci id="S3.E7.m2.5.5.1.1.1.1.1.1.1.4.3.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.4.3">𝑡</ci></apply></apply></apply><apply id="S3.E7.m2.5.5.1.1.1.1.3.cmml" xref="S3.E7.m2.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m2.5.5.1.1.1.1.3.1.cmml" xref="S3.E7.m2.5.5.1.1.1.1.3">superscript</csymbol><ci id="S3.E7.m2.5.5.1.1.1.1.3.2.cmml" xref="S3.E7.m2.5.5.1.1.1.1.3.2">𝑊</ci><apply id="S3.E7.m2.3.3.1.cmml" xref="S3.E7.m2.3.3.1"><csymbol cd="ambiguous" id="S3.E7.m2.3.3.1.2.cmml" xref="S3.E7.m2.3.3.1">superscript</csymbol><apply id="S3.E7.m2.3.3.1.3.cmml" xref="S3.E7.m2.3.3.1"><csymbol cd="ambiguous" id="S3.E7.m2.3.3.1.3.1.cmml" xref="S3.E7.m2.3.3.1">subscript</csymbol><apply id="S3.E7.m2.3.3.1.3.2.cmml" xref="S3.E7.m2.3.3.1.3.2"><ci id="S3.E7.m2.3.3.1.3.2.1.cmml" xref="S3.E7.m2.3.3.1.3.2.1">^</ci><ci id="S3.E7.m2.3.3.1.3.2.2.cmml" xref="S3.E7.m2.3.3.1.3.2.2">𝐇</ci></apply><ci id="S3.E7.m2.3.3.1.3.3.cmml" xref="S3.E7.m2.3.3.1.3.3">𝑡</ci></apply><apply id="S3.E7.m2.3.3.1.1.1.2.cmml" xref="S3.E7.m2.3.3.1.1.1.3"><csymbol cd="latexml" id="S3.E7.m2.3.3.1.1.1.2.1.cmml" xref="S3.E7.m2.3.3.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.E7.m2.3.3.1.1.1.1.cmml" xref="S3.E7.m2.3.3.1.1.1.1">𝑙</ci></apply></apply></apply></apply><apply id="S3.E7.m2.5.5.1.1.2.2.cmml" xref="S3.E7.m2.5.5.1.1.2.2"><times id="S3.E7.m2.5.5.1.1.2.2.2.cmml" xref="S3.E7.m2.5.5.1.1.2.2.2"></times><apply id="S3.E7.m2.5.5.1.1.2.2.3.cmml" xref="S3.E7.m2.5.5.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E7.m2.5.5.1.1.2.2.3.1.cmml" xref="S3.E7.m2.5.5.1.1.2.2.3">subscript</csymbol><ci id="S3.E7.m2.5.5.1.1.2.2.3.2.cmml" xref="S3.E7.m2.5.5.1.1.2.2.3.2">𝒟</ci><ci id="S3.E7.m2.5.5.1.1.2.2.3.3.cmml" xref="S3.E7.m2.5.5.1.1.2.2.3.3">𝑡</ci></apply><apply id="S3.E7.m2.5.5.1.1.2.2.1.1.1.cmml" xref="S3.E7.m2.5.5.1.1.2.2.1.1"><csymbol cd="ambiguous" id="S3.E7.m2.5.5.1.1.2.2.1.1.1.1.cmml" xref="S3.E7.m2.5.5.1.1.2.2.1.1">superscript</csymbol><apply id="S3.E7.m2.5.5.1.1.2.2.1.1.1.2.cmml" xref="S3.E7.m2.5.5.1.1.2.2.1.1"><csymbol cd="ambiguous" id="S3.E7.m2.5.5.1.1.2.2.1.1.1.2.1.cmml" xref="S3.E7.m2.5.5.1.1.2.2.1.1">subscript</csymbol><ci id="S3.E7.m2.5.5.1.1.2.2.1.1.1.2.2.cmml" xref="S3.E7.m2.5.5.1.1.2.2.1.1.1.2.2">𝐅</ci><ci id="S3.E7.m2.5.5.1.1.2.2.1.1.1.2.3.cmml" xref="S3.E7.m2.5.5.1.1.2.2.1.1.1.2.3">𝑡</ci></apply><apply id="S3.E7.m2.4.4.1.2.cmml" xref="S3.E7.m2.4.4.1.3"><csymbol cd="latexml" id="S3.E7.m2.4.4.1.2.1.cmml" xref="S3.E7.m2.4.4.1.3.1">delimited-[]</csymbol><ci id="S3.E7.m2.4.4.1.1.cmml" xref="S3.E7.m2.4.4.1.1">𝑙</ci></apply></apply></apply></apply></apply><apply id="S3.E7.m2.5.5.1.1c.cmml" xref="S3.E7.m2.5.5.1"><in id="S3.E7.m2.5.5.1.1.6.cmml" xref="S3.E7.m2.5.5.1.1.6"></in><share href="https://arxiv.org/html/2410.03936v1#S3.E7.m2.5.5.1.1.2.cmml" id="S3.E7.m2.5.5.1.1d.cmml" xref="S3.E7.m2.5.5.1"></share><apply id="S3.E7.m2.5.5.1.1.7.cmml" xref="S3.E7.m2.5.5.1.1.7"><csymbol cd="ambiguous" id="S3.E7.m2.5.5.1.1.7.1.cmml" xref="S3.E7.m2.5.5.1.1.7">superscript</csymbol><ci id="S3.E7.m2.5.5.1.1.7.2.cmml" xref="S3.E7.m2.5.5.1.1.7.2">ℝ</ci><apply id="S3.E7.m2.5.5.1.1.7.3.cmml" xref="S3.E7.m2.5.5.1.1.7.3"><times id="S3.E7.m2.5.5.1.1.7.3.1.cmml" xref="S3.E7.m2.5.5.1.1.7.3.1"></times><apply id="S3.E7.m2.5.5.1.1.7.3.2.cmml" xref="S3.E7.m2.5.5.1.1.7.3.2"><csymbol cd="ambiguous" id="S3.E7.m2.5.5.1.1.7.3.2.1.cmml" xref="S3.E7.m2.5.5.1.1.7.3.2">superscript</csymbol><ci id="S3.E7.m2.5.5.1.1.7.3.2.2.cmml" xref="S3.E7.m2.5.5.1.1.7.3.2.2">ℎ</ci><ci id="S3.E7.m2.5.5.1.1.7.3.2.3.cmml" xref="S3.E7.m2.5.5.1.1.7.3.2.3">𝑙</ci></apply><apply id="S3.E7.m2.5.5.1.1.7.3.3.cmml" xref="S3.E7.m2.5.5.1.1.7.3.3"><csymbol cd="ambiguous" id="S3.E7.m2.5.5.1.1.7.3.3.1.cmml" xref="S3.E7.m2.5.5.1.1.7.3.3">superscript</csymbol><ci id="S3.E7.m2.5.5.1.1.7.3.3.2.cmml" xref="S3.E7.m2.5.5.1.1.7.3.3.2">𝑤</ci><ci id="S3.E7.m2.5.5.1.1.7.3.3.3.cmml" xref="S3.E7.m2.5.5.1.1.7.3.3.3">𝑙</ci></apply><apply id="S3.E7.m2.5.5.1.1.7.3.4.cmml" xref="S3.E7.m2.5.5.1.1.7.3.4"><csymbol cd="ambiguous" id="S3.E7.m2.5.5.1.1.7.3.4.1.cmml" xref="S3.E7.m2.5.5.1.1.7.3.4">superscript</csymbol><ci id="S3.E7.m2.5.5.1.1.7.3.4.2.cmml" xref="S3.E7.m2.5.5.1.1.7.3.4.2">𝑐</ci><ci id="S3.E7.m2.5.5.1.1.7.3.4.3.cmml" xref="S3.E7.m2.5.5.1.1.7.3.4.3">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m2.5c">\displaystyle=\left[\sigma(\mathbf{A}^{[l]}_{t})\mathbf{V}^{[l]}_{t}\right]W^{%
\mathbf{\hat{H}}_{t}^{[l]}}+\mathcal{D}_{t}(\mathbf{F}_{t}^{[l]})\in\mathbb{R}%
^{h^{l}\times w^{l}\times c^{l}}.</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m2.5d">= [ italic_σ ( bold_A start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) bold_V start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ] italic_W start_POSTSUPERSCRIPT over^ start_ARG bold_H end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT + caligraphic_D start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_F start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT ) ∈ blackboard_R start_POSTSUPERSCRIPT italic_h start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT × italic_w start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT × italic_c start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS0.Px2.p2.16">In <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S3.E7" title="In Frame History Router (𝜓). ‣ 3.2 Causal History Model ‣ 3 Methodology ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">eq.</span> <span class="ltx_text ltx_ref_tag">7</span></a>, <math alttext="\psi_{t}(\mathbf{\hat{H}}_{t}^{[l]},\mathbf{F}_{t}^{[l]})=\left[\sigma(\mathbf%
{A}^{[l]}_{t})\mathbf{V}^{[l]}_{t}\right]W^{\mathbf{\hat{H}}_{t}^{[l]}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.16.m1.8"><semantics id="S3.SS2.SSS0.Px2.p2.16.m1.8a"><mrow id="S3.SS2.SSS0.Px2.p2.16.m1.8.8" xref="S3.SS2.SSS0.Px2.p2.16.m1.8.8.cmml"><mrow id="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2" xref="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2.cmml"><msub id="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2.4" xref="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2.4.cmml"><mi id="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2.4.2" xref="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2.4.2.cmml">ψ</mi><mi id="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2.4.3" xref="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2.4.3.cmml">t</mi></msub><mo id="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2.3" xref="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2.3.cmml">⁢</mo><mrow id="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2.2.2" xref="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2.2.3.cmml"><mo id="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2.2.2.3" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2.2.3.cmml">(</mo><msubsup id="S3.SS2.SSS0.Px2.p2.16.m1.6.6.1.1.1.1" xref="S3.SS2.SSS0.Px2.p2.16.m1.6.6.1.1.1.1.cmml"><mover accent="true" id="S3.SS2.SSS0.Px2.p2.16.m1.6.6.1.1.1.1.2.2" xref="S3.SS2.SSS0.Px2.p2.16.m1.6.6.1.1.1.1.2.2.cmml"><mi id="S3.SS2.SSS0.Px2.p2.16.m1.6.6.1.1.1.1.2.2.2" xref="S3.SS2.SSS0.Px2.p2.16.m1.6.6.1.1.1.1.2.2.2.cmml">𝐇</mi><mo id="S3.SS2.SSS0.Px2.p2.16.m1.6.6.1.1.1.1.2.2.1" xref="S3.SS2.SSS0.Px2.p2.16.m1.6.6.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.SS2.SSS0.Px2.p2.16.m1.6.6.1.1.1.1.2.3" xref="S3.SS2.SSS0.Px2.p2.16.m1.6.6.1.1.1.1.2.3.cmml">t</mi><mrow id="S3.SS2.SSS0.Px2.p2.16.m1.1.1.1.3" xref="S3.SS2.SSS0.Px2.p2.16.m1.1.1.1.2.cmml"><mo id="S3.SS2.SSS0.Px2.p2.16.m1.1.1.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.16.m1.1.1.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px2.p2.16.m1.1.1.1.1" xref="S3.SS2.SSS0.Px2.p2.16.m1.1.1.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px2.p2.16.m1.1.1.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.16.m1.1.1.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2.2.2.4" xref="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2.2.3.cmml">,</mo><msubsup id="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2.2.2.2" xref="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2.2.2.2.2.2" xref="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2.2.2.2.2.2.cmml">𝐅</mi><mi id="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2.2.2.2.2.3" xref="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2.2.2.2.2.3.cmml">t</mi><mrow id="S3.SS2.SSS0.Px2.p2.16.m1.2.2.1.3" xref="S3.SS2.SSS0.Px2.p2.16.m1.2.2.1.2.cmml"><mo id="S3.SS2.SSS0.Px2.p2.16.m1.2.2.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.16.m1.2.2.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px2.p2.16.m1.2.2.1.1" xref="S3.SS2.SSS0.Px2.p2.16.m1.2.2.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px2.p2.16.m1.2.2.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.16.m1.2.2.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2.2.2.5" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.SS2.SSS0.Px2.p2.16.m1.8.8.4" xref="S3.SS2.SSS0.Px2.p2.16.m1.8.8.4.cmml">=</mo><mrow id="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3" xref="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.cmml"><mrow id="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1" xref="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.2.cmml"><mo id="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.2" xref="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.2.1.cmml">[</mo><mrow id="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1" xref="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.3" xref="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.3.cmml">σ</mi><mo id="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.2" xref="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.1.1" xref="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.1.1.1" xref="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.1.1.1.2.2" xref="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.1.1.1.2.2.cmml">𝐀</mi><mi id="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.1.1.1.3" xref="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.1.1.1.3.cmml">t</mi><mrow id="S3.SS2.SSS0.Px2.p2.16.m1.3.3.1.3" xref="S3.SS2.SSS0.Px2.p2.16.m1.3.3.1.2.cmml"><mo id="S3.SS2.SSS0.Px2.p2.16.m1.3.3.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.16.m1.3.3.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px2.p2.16.m1.3.3.1.1" xref="S3.SS2.SSS0.Px2.p2.16.m1.3.3.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px2.p2.16.m1.3.3.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.16.m1.3.3.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.2a" xref="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.2.cmml">⁢</mo><msubsup id="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.4" xref="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.4.cmml"><mi id="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.4.2.2" xref="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.4.2.2.cmml">𝐕</mi><mi id="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.4.3" xref="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.4.3.cmml">t</mi><mrow id="S3.SS2.SSS0.Px2.p2.16.m1.4.4.1.3" xref="S3.SS2.SSS0.Px2.p2.16.m1.4.4.1.2.cmml"><mo id="S3.SS2.SSS0.Px2.p2.16.m1.4.4.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.16.m1.4.4.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px2.p2.16.m1.4.4.1.1" xref="S3.SS2.SSS0.Px2.p2.16.m1.4.4.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px2.p2.16.m1.4.4.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.16.m1.4.4.1.2.1.cmml">]</mo></mrow></msubsup></mrow><mo id="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.3" xref="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.2.1.cmml">]</mo></mrow><mo id="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.2" xref="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.2.cmml">⁢</mo><msup id="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.3" xref="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.3.cmml"><mi id="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.3.2" xref="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.3.2.cmml">W</mi><msubsup id="S3.SS2.SSS0.Px2.p2.16.m1.5.5.1" xref="S3.SS2.SSS0.Px2.p2.16.m1.5.5.1.cmml"><mover accent="true" id="S3.SS2.SSS0.Px2.p2.16.m1.5.5.1.3.2" xref="S3.SS2.SSS0.Px2.p2.16.m1.5.5.1.3.2.cmml"><mi id="S3.SS2.SSS0.Px2.p2.16.m1.5.5.1.3.2.2" xref="S3.SS2.SSS0.Px2.p2.16.m1.5.5.1.3.2.2.cmml">𝐇</mi><mo id="S3.SS2.SSS0.Px2.p2.16.m1.5.5.1.3.2.1" xref="S3.SS2.SSS0.Px2.p2.16.m1.5.5.1.3.2.1.cmml">^</mo></mover><mi id="S3.SS2.SSS0.Px2.p2.16.m1.5.5.1.3.3" xref="S3.SS2.SSS0.Px2.p2.16.m1.5.5.1.3.3.cmml">t</mi><mrow id="S3.SS2.SSS0.Px2.p2.16.m1.5.5.1.1.1.3" xref="S3.SS2.SSS0.Px2.p2.16.m1.5.5.1.1.1.2.cmml"><mo id="S3.SS2.SSS0.Px2.p2.16.m1.5.5.1.1.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.16.m1.5.5.1.1.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px2.p2.16.m1.5.5.1.1.1.1" xref="S3.SS2.SSS0.Px2.p2.16.m1.5.5.1.1.1.1.cmml">l</mi><mo id="S3.SS2.SSS0.Px2.p2.16.m1.5.5.1.1.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.16.m1.5.5.1.1.1.2.1.cmml">]</mo></mrow></msubsup></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.16.m1.8b"><apply id="S3.SS2.SSS0.Px2.p2.16.m1.8.8.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.8.8"><eq id="S3.SS2.SSS0.Px2.p2.16.m1.8.8.4.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.8.8.4"></eq><apply id="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2"><times id="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2.3.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2.3"></times><apply id="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2.4.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2.4"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2.4.1.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2.4">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2.4.2.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2.4.2">𝜓</ci><ci id="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2.4.3.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2.4.3">𝑡</ci></apply><interval closure="open" id="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2.2.3.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2.2.2"><apply id="S3.SS2.SSS0.Px2.p2.16.m1.6.6.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.6.6.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.16.m1.6.6.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.6.6.1.1.1.1">superscript</csymbol><apply id="S3.SS2.SSS0.Px2.p2.16.m1.6.6.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.6.6.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.16.m1.6.6.1.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.6.6.1.1.1.1">subscript</csymbol><apply id="S3.SS2.SSS0.Px2.p2.16.m1.6.6.1.1.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.6.6.1.1.1.1.2.2"><ci id="S3.SS2.SSS0.Px2.p2.16.m1.6.6.1.1.1.1.2.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.6.6.1.1.1.1.2.2.1">^</ci><ci id="S3.SS2.SSS0.Px2.p2.16.m1.6.6.1.1.1.1.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.6.6.1.1.1.1.2.2.2">𝐇</ci></apply><ci id="S3.SS2.SSS0.Px2.p2.16.m1.6.6.1.1.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.6.6.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.SS2.SSS0.Px2.p2.16.m1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.1.1.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px2.p2.16.m1.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px2.p2.16.m1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.1.1.1.1">𝑙</ci></apply></apply><apply id="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2.2.2.2">superscript</csymbol><apply id="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2.2.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2.2.2.2.2.2">𝐅</ci><ci id="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2.2.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.7.7.2.2.2.2.2.3">𝑡</ci></apply><apply id="S3.SS2.SSS0.Px2.p2.16.m1.2.2.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.2.2.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px2.p2.16.m1.2.2.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.2.2.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px2.p2.16.m1.2.2.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.2.2.1.1">𝑙</ci></apply></apply></interval></apply><apply id="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3"><times id="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.2.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.2"></times><apply id="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1"><csymbol cd="latexml" id="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.2">delimited-[]</csymbol><apply id="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1"><times id="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.2"></times><ci id="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.3">𝜎</ci><apply id="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.1.1">subscript</csymbol><apply id="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.1.1">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.1.1.1.2.2">𝐀</ci><apply id="S3.SS2.SSS0.Px2.p2.16.m1.3.3.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.3.3.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px2.p2.16.m1.3.3.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.3.3.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px2.p2.16.m1.3.3.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.3.3.1.1">𝑙</ci></apply></apply><ci id="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.4.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.4.1.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.4">subscript</csymbol><apply id="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.4.2.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.4.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.4">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.4.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.4.2.2">𝐕</ci><apply id="S3.SS2.SSS0.Px2.p2.16.m1.4.4.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.4.4.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px2.p2.16.m1.4.4.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.4.4.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px2.p2.16.m1.4.4.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.4.4.1.1">𝑙</ci></apply></apply><ci id="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.4.3.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.1.1.1.4.3">𝑡</ci></apply></apply></apply><apply id="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.3.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.3.1.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.3.2.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.8.8.3.3.2">𝑊</ci><apply id="S3.SS2.SSS0.Px2.p2.16.m1.5.5.1.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.5.5.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.16.m1.5.5.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.5.5.1">superscript</csymbol><apply id="S3.SS2.SSS0.Px2.p2.16.m1.5.5.1.3.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.5.5.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.16.m1.5.5.1.3.1.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.5.5.1">subscript</csymbol><apply id="S3.SS2.SSS0.Px2.p2.16.m1.5.5.1.3.2.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.5.5.1.3.2"><ci id="S3.SS2.SSS0.Px2.p2.16.m1.5.5.1.3.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.5.5.1.3.2.1">^</ci><ci id="S3.SS2.SSS0.Px2.p2.16.m1.5.5.1.3.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.5.5.1.3.2.2">𝐇</ci></apply><ci id="S3.SS2.SSS0.Px2.p2.16.m1.5.5.1.3.3.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.5.5.1.3.3">𝑡</ci></apply><apply id="S3.SS2.SSS0.Px2.p2.16.m1.5.5.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.5.5.1.1.1.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px2.p2.16.m1.5.5.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.5.5.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px2.p2.16.m1.5.5.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.16.m1.5.5.1.1.1.1">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.16.m1.8c">\psi_{t}(\mathbf{\hat{H}}_{t}^{[l]},\mathbf{F}_{t}^{[l]})=\left[\sigma(\mathbf%
{A}^{[l]}_{t})\mathbf{V}^{[l]}_{t}\right]W^{\mathbf{\hat{H}}_{t}^{[l]}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.16.m1.8d">italic_ψ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( over^ start_ARG bold_H end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT , bold_F start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT ) = [ italic_σ ( bold_A start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) bold_V start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ] italic_W start_POSTSUPERSCRIPT over^ start_ARG bold_H end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> which follows from <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S3.E2" title="In 3.2 Causal History Model ‣ 3 Methodology ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">eq.</span> <span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<figure class="ltx_table" id="S3.T2">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T2.46" style="width:399.3pt;height:204.2pt;vertical-align:-99.4pt;"><span class="ltx_transformed_inner" style="transform:translate(-22.2pt,5.8pt) scale(0.9,0.9) ;">
<figure class="ltx_figure ltx_minipage ltx_align_middle" id="S3.T2.22.22" style="width:216.8pt;">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Table 1: </span><span class="ltx_text ltx_font_bold" id="S3.T2.22.22.24.1">Night Video Deraining Results.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T2.22.22.22">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T2.2.2.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S3.T2.2.2.2.2.3"><span class="ltx_text ltx_font_bold" id="S3.T2.2.2.2.2.3.1">Method</span></th>
<td class="ltx_td ltx_align_left ltx_border_tt" id="S3.T2.1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.1.1.1.1">PSNR<math alttext="\uparrow" class="ltx_Math" display="inline" id="S3.T2.1.1.1.1.1.1.m1.1"><semantics id="S3.T2.1.1.1.1.1.1.m1.1a"><mo id="S3.T2.1.1.1.1.1.1.m1.1.1" stretchy="false" xref="S3.T2.1.1.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T2.1.1.1.1.1.1.m1.1b"><ci id="S3.T2.1.1.1.1.1.1.m1.1.1.cmml" xref="S3.T2.1.1.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.1.1.1.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T2.1.1.1.1.1.1.m1.1d">↑</annotation></semantics></math></span></td>
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_tt" id="S3.T2.2.2.2.2.2"><span class="ltx_text ltx_font_bold" id="S3.T2.2.2.2.2.2.1">SSIM<math alttext="\uparrow" class="ltx_Math" display="inline" id="S3.T2.2.2.2.2.2.1.m1.1"><semantics id="S3.T2.2.2.2.2.2.1.m1.1a"><mo id="S3.T2.2.2.2.2.2.1.m1.1.1" stretchy="false" xref="S3.T2.2.2.2.2.2.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T2.2.2.2.2.2.1.m1.1b"><ci id="S3.T2.2.2.2.2.2.1.m1.1.1.cmml" xref="S3.T2.2.2.2.2.2.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.2.2.2.2.2.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T2.2.2.2.2.2.1.m1.1d">↑</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="S3.T2.4.4.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T2.4.4.4.4.3">FDM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib22" title="">22</a>]</cite>
</th>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.3.3.3.3.1"><math alttext="23.49" class="ltx_Math" display="inline" id="S3.T2.3.3.3.3.1.m1.1"><semantics id="S3.T2.3.3.3.3.1.m1.1a"><mn id="S3.T2.3.3.3.3.1.m1.1.1" xref="S3.T2.3.3.3.3.1.m1.1.1.cmml">23.49</mn><annotation-xml encoding="MathML-Content" id="S3.T2.3.3.3.3.1.m1.1b"><cn id="S3.T2.3.3.3.3.1.m1.1.1.cmml" type="float" xref="S3.T2.3.3.3.3.1.m1.1.1">23.49</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.3.3.3.3.1.m1.1c">23.49</annotation><annotation encoding="application/x-llamapun" id="S3.T2.3.3.3.3.1.m1.1d">23.49</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t" id="S3.T2.4.4.4.4.2"><math alttext="0.7657" class="ltx_Math" display="inline" id="S3.T2.4.4.4.4.2.m1.1"><semantics id="S3.T2.4.4.4.4.2.m1.1a"><mn id="S3.T2.4.4.4.4.2.m1.1.1" xref="S3.T2.4.4.4.4.2.m1.1.1.cmml">0.7657</mn><annotation-xml encoding="MathML-Content" id="S3.T2.4.4.4.4.2.m1.1b"><cn id="S3.T2.4.4.4.4.2.m1.1.1.cmml" type="float" xref="S3.T2.4.4.4.4.2.m1.1.1">0.7657</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.4.4.4.4.2.m1.1c">0.7657</annotation><annotation encoding="application/x-llamapun" id="S3.T2.4.4.4.4.2.m1.1d">0.7657</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S3.T2.6.6.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T2.6.6.6.6.3">DSTFM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib46" title="">46</a>]</cite>
</th>
<td class="ltx_td ltx_align_left" id="S3.T2.5.5.5.5.1"><math alttext="17.82" class="ltx_Math" display="inline" id="S3.T2.5.5.5.5.1.m1.1"><semantics id="S3.T2.5.5.5.5.1.m1.1a"><mn id="S3.T2.5.5.5.5.1.m1.1.1" xref="S3.T2.5.5.5.5.1.m1.1.1.cmml">17.82</mn><annotation-xml encoding="MathML-Content" id="S3.T2.5.5.5.5.1.m1.1b"><cn id="S3.T2.5.5.5.5.1.m1.1.1.cmml" type="float" xref="S3.T2.5.5.5.5.1.m1.1.1">17.82</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.5.5.5.5.1.m1.1c">17.82</annotation><annotation encoding="application/x-llamapun" id="S3.T2.5.5.5.5.1.m1.1d">17.82</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S3.T2.6.6.6.6.2"><math alttext="0.6486" class="ltx_Math" display="inline" id="S3.T2.6.6.6.6.2.m1.1"><semantics id="S3.T2.6.6.6.6.2.m1.1a"><mn id="S3.T2.6.6.6.6.2.m1.1.1" xref="S3.T2.6.6.6.6.2.m1.1.1.cmml">0.6486</mn><annotation-xml encoding="MathML-Content" id="S3.T2.6.6.6.6.2.m1.1b"><cn id="S3.T2.6.6.6.6.2.m1.1.1.cmml" type="float" xref="S3.T2.6.6.6.6.2.m1.1.1">0.6486</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.6.6.6.6.2.m1.1c">0.6486</annotation><annotation encoding="application/x-llamapun" id="S3.T2.6.6.6.6.2.m1.1d">0.6486</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S3.T2.8.8.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T2.8.8.8.8.3">WeatherDiff <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib43" title="">43</a>]</cite>
</th>
<td class="ltx_td ltx_align_left" id="S3.T2.7.7.7.7.1"><math alttext="20.98" class="ltx_Math" display="inline" id="S3.T2.7.7.7.7.1.m1.1"><semantics id="S3.T2.7.7.7.7.1.m1.1a"><mn id="S3.T2.7.7.7.7.1.m1.1.1" xref="S3.T2.7.7.7.7.1.m1.1.1.cmml">20.98</mn><annotation-xml encoding="MathML-Content" id="S3.T2.7.7.7.7.1.m1.1b"><cn id="S3.T2.7.7.7.7.1.m1.1.1.cmml" type="float" xref="S3.T2.7.7.7.7.1.m1.1.1">20.98</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.7.7.7.7.1.m1.1c">20.98</annotation><annotation encoding="application/x-llamapun" id="S3.T2.7.7.7.7.1.m1.1d">20.98</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S3.T2.8.8.8.8.2"><math alttext="0.6697" class="ltx_Math" display="inline" id="S3.T2.8.8.8.8.2.m1.1"><semantics id="S3.T2.8.8.8.8.2.m1.1a"><mn id="S3.T2.8.8.8.8.2.m1.1.1" xref="S3.T2.8.8.8.8.2.m1.1.1.cmml">0.6697</mn><annotation-xml encoding="MathML-Content" id="S3.T2.8.8.8.8.2.m1.1b"><cn id="S3.T2.8.8.8.8.2.m1.1.1.cmml" type="float" xref="S3.T2.8.8.8.8.2.m1.1.1">0.6697</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.8.8.8.8.2.m1.1c">0.6697</annotation><annotation encoding="application/x-llamapun" id="S3.T2.8.8.8.8.2.m1.1d">0.6697</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S3.T2.10.10.10.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T2.10.10.10.10.3">RMFD <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib75" title="">75</a>]</cite>
</th>
<td class="ltx_td ltx_align_left" id="S3.T2.9.9.9.9.1"><math alttext="16.18" class="ltx_Math" display="inline" id="S3.T2.9.9.9.9.1.m1.1"><semantics id="S3.T2.9.9.9.9.1.m1.1a"><mn id="S3.T2.9.9.9.9.1.m1.1.1" xref="S3.T2.9.9.9.9.1.m1.1.1.cmml">16.18</mn><annotation-xml encoding="MathML-Content" id="S3.T2.9.9.9.9.1.m1.1b"><cn id="S3.T2.9.9.9.9.1.m1.1.1.cmml" type="float" xref="S3.T2.9.9.9.9.1.m1.1.1">16.18</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.9.9.9.9.1.m1.1c">16.18</annotation><annotation encoding="application/x-llamapun" id="S3.T2.9.9.9.9.1.m1.1d">16.18</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S3.T2.10.10.10.10.2"><math alttext="0.6402" class="ltx_Math" display="inline" id="S3.T2.10.10.10.10.2.m1.1"><semantics id="S3.T2.10.10.10.10.2.m1.1a"><mn id="S3.T2.10.10.10.10.2.m1.1.1" xref="S3.T2.10.10.10.10.2.m1.1.1.cmml">0.6402</mn><annotation-xml encoding="MathML-Content" id="S3.T2.10.10.10.10.2.m1.1b"><cn id="S3.T2.10.10.10.10.2.m1.1.1.cmml" type="float" xref="S3.T2.10.10.10.10.2.m1.1.1">0.6402</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.10.10.10.10.2.m1.1c">0.6402</annotation><annotation encoding="application/x-llamapun" id="S3.T2.10.10.10.10.2.m1.1d">0.6402</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S3.T2.12.12.12.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T2.12.12.12.12.3">DLF <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib74" title="">74</a>]</cite>
</th>
<td class="ltx_td ltx_align_left" id="S3.T2.11.11.11.11.1"><math alttext="15.17" class="ltx_Math" display="inline" id="S3.T2.11.11.11.11.1.m1.1"><semantics id="S3.T2.11.11.11.11.1.m1.1a"><mn id="S3.T2.11.11.11.11.1.m1.1.1" xref="S3.T2.11.11.11.11.1.m1.1.1.cmml">15.17</mn><annotation-xml encoding="MathML-Content" id="S3.T2.11.11.11.11.1.m1.1b"><cn id="S3.T2.11.11.11.11.1.m1.1.1.cmml" type="float" xref="S3.T2.11.11.11.11.1.m1.1.1">15.17</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.11.11.11.11.1.m1.1c">15.17</annotation><annotation encoding="application/x-llamapun" id="S3.T2.11.11.11.11.1.m1.1d">15.17</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S3.T2.12.12.12.12.2"><math alttext="0.6307" class="ltx_Math" display="inline" id="S3.T2.12.12.12.12.2.m1.1"><semantics id="S3.T2.12.12.12.12.2.m1.1a"><mn id="S3.T2.12.12.12.12.2.m1.1.1" xref="S3.T2.12.12.12.12.2.m1.1.1.cmml">0.6307</mn><annotation-xml encoding="MathML-Content" id="S3.T2.12.12.12.12.2.m1.1b"><cn id="S3.T2.12.12.12.12.2.m1.1.1.cmml" type="float" xref="S3.T2.12.12.12.12.2.m1.1.1">0.6307</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.12.12.12.12.2.m1.1c">0.6307</annotation><annotation encoding="application/x-llamapun" id="S3.T2.12.12.12.12.2.m1.1d">0.6307</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S3.T2.14.14.14.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T2.14.14.14.14.3">HRIR <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib31" title="">31</a>]</cite>
</th>
<td class="ltx_td ltx_align_left" id="S3.T2.13.13.13.13.1"><math alttext="16.83" class="ltx_Math" display="inline" id="S3.T2.13.13.13.13.1.m1.1"><semantics id="S3.T2.13.13.13.13.1.m1.1a"><mn id="S3.T2.13.13.13.13.1.m1.1.1" xref="S3.T2.13.13.13.13.1.m1.1.1.cmml">16.83</mn><annotation-xml encoding="MathML-Content" id="S3.T2.13.13.13.13.1.m1.1b"><cn id="S3.T2.13.13.13.13.1.m1.1.1.cmml" type="float" xref="S3.T2.13.13.13.13.1.m1.1.1">16.83</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.13.13.13.13.1.m1.1c">16.83</annotation><annotation encoding="application/x-llamapun" id="S3.T2.13.13.13.13.1.m1.1d">16.83</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S3.T2.14.14.14.14.2"><math alttext="0.6481" class="ltx_Math" display="inline" id="S3.T2.14.14.14.14.2.m1.1"><semantics id="S3.T2.14.14.14.14.2.m1.1a"><mn id="S3.T2.14.14.14.14.2.m1.1.1" xref="S3.T2.14.14.14.14.2.m1.1.1.cmml">0.6481</mn><annotation-xml encoding="MathML-Content" id="S3.T2.14.14.14.14.2.m1.1b"><cn id="S3.T2.14.14.14.14.2.m1.1.1.cmml" type="float" xref="S3.T2.14.14.14.14.2.m1.1.1">0.6481</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.14.14.14.14.2.m1.1c">0.6481</annotation><annotation encoding="application/x-llamapun" id="S3.T2.14.14.14.14.2.m1.1d">0.6481</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S3.T2.16.16.16.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T2.16.16.16.16.3">MetaRain (Meta) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib47" title="">47</a>]</cite>
</th>
<td class="ltx_td ltx_align_left" id="S3.T2.15.15.15.15.1"><math alttext="23.49" class="ltx_Math" display="inline" id="S3.T2.15.15.15.15.1.m1.1"><semantics id="S3.T2.15.15.15.15.1.m1.1a"><mn id="S3.T2.15.15.15.15.1.m1.1.1" xref="S3.T2.15.15.15.15.1.m1.1.1.cmml">23.49</mn><annotation-xml encoding="MathML-Content" id="S3.T2.15.15.15.15.1.m1.1b"><cn id="S3.T2.15.15.15.15.1.m1.1.1.cmml" type="float" xref="S3.T2.15.15.15.15.1.m1.1.1">23.49</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.15.15.15.15.1.m1.1c">23.49</annotation><annotation encoding="application/x-llamapun" id="S3.T2.15.15.15.15.1.m1.1d">23.49</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S3.T2.16.16.16.16.2"><math alttext="0.7171" class="ltx_Math" display="inline" id="S3.T2.16.16.16.16.2.m1.1"><semantics id="S3.T2.16.16.16.16.2.m1.1a"><mn id="S3.T2.16.16.16.16.2.m1.1.1" xref="S3.T2.16.16.16.16.2.m1.1.1.cmml">0.7171</mn><annotation-xml encoding="MathML-Content" id="S3.T2.16.16.16.16.2.m1.1b"><cn id="S3.T2.16.16.16.16.2.m1.1.1.cmml" type="float" xref="S3.T2.16.16.16.16.2.m1.1.1">0.7171</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.16.16.16.16.2.m1.1c">0.7171</annotation><annotation encoding="application/x-llamapun" id="S3.T2.16.16.16.16.2.m1.1d">0.7171</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S3.T2.18.18.18.18">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T2.18.18.18.18.3">MetaRain (Scrt) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib47" title="">47</a>]</cite>
</th>
<td class="ltx_td ltx_align_left" id="S3.T2.17.17.17.17.1"><math alttext="22.21" class="ltx_Math" display="inline" id="S3.T2.17.17.17.17.1.m1.1"><semantics id="S3.T2.17.17.17.17.1.m1.1a"><mn id="S3.T2.17.17.17.17.1.m1.1.1" xref="S3.T2.17.17.17.17.1.m1.1.1.cmml">22.21</mn><annotation-xml encoding="MathML-Content" id="S3.T2.17.17.17.17.1.m1.1b"><cn id="S3.T2.17.17.17.17.1.m1.1.1.cmml" type="float" xref="S3.T2.17.17.17.17.1.m1.1.1">22.21</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.17.17.17.17.1.m1.1c">22.21</annotation><annotation encoding="application/x-llamapun" id="S3.T2.17.17.17.17.1.m1.1d">22.21</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S3.T2.18.18.18.18.2"><math alttext="0.6723" class="ltx_Math" display="inline" id="S3.T2.18.18.18.18.2.m1.1"><semantics id="S3.T2.18.18.18.18.2.m1.1a"><mn id="S3.T2.18.18.18.18.2.m1.1.1" xref="S3.T2.18.18.18.18.2.m1.1.1.cmml">0.6723</mn><annotation-xml encoding="MathML-Content" id="S3.T2.18.18.18.18.2.m1.1b"><cn id="S3.T2.18.18.18.18.2.m1.1.1.cmml" type="float" xref="S3.T2.18.18.18.18.2.m1.1.1">0.6723</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.18.18.18.18.2.m1.1c">0.6723</annotation><annotation encoding="application/x-llamapun" id="S3.T2.18.18.18.18.2.m1.1d">0.6723</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S3.T2.20.20.20.20">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T2.20.20.20.20.3">NightRain <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib35" title="">35</a>]</cite>
</th>
<td class="ltx_td ltx_align_left" id="S3.T2.19.19.19.19.1"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.19.19.19.19.1.1"><math alttext="26.73" class="ltx_Math" display="inline" id="S3.T2.19.19.19.19.1.1.m1.1"><semantics id="S3.T2.19.19.19.19.1.1.m1.1a"><mn id="S3.T2.19.19.19.19.1.1.m1.1.1" xref="S3.T2.19.19.19.19.1.1.m1.1.1.cmml">26.73</mn><annotation-xml encoding="MathML-Content" id="S3.T2.19.19.19.19.1.1.m1.1b"><cn id="S3.T2.19.19.19.19.1.1.m1.1.1.cmml" type="float" xref="S3.T2.19.19.19.19.1.1.m1.1.1">26.73</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.19.19.19.19.1.1.m1.1c">26.73</annotation><annotation encoding="application/x-llamapun" id="S3.T2.19.19.19.19.1.1.m1.1d">26.73</annotation></semantics></math></span></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S3.T2.20.20.20.20.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.20.20.20.20.2.1"><math alttext="0.8647" class="ltx_Math" display="inline" id="S3.T2.20.20.20.20.2.1.m1.1"><semantics id="S3.T2.20.20.20.20.2.1.m1.1a"><mn id="S3.T2.20.20.20.20.2.1.m1.1.1" xref="S3.T2.20.20.20.20.2.1.m1.1.1.cmml">0.8647</mn><annotation-xml encoding="MathML-Content" id="S3.T2.20.20.20.20.2.1.m1.1b"><cn id="S3.T2.20.20.20.20.2.1.m1.1.1.cmml" type="float" xref="S3.T2.20.20.20.20.2.1.m1.1.1">0.8647</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.20.20.20.20.2.1.m1.1c">0.8647</annotation><annotation encoding="application/x-llamapun" id="S3.T2.20.20.20.20.2.1.m1.1d">0.8647</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="S3.T2.22.22.22.22" style="background-color:#D1E9F6;">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_tt" id="S3.T2.22.22.22.22.3"><span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="S3.T2.22.22.22.22.3.1" style="background-color:#D1E9F6;">Turtle</span></th>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_tt" id="S3.T2.21.21.21.21.1"><span class="ltx_text ltx_markedasmath ltx_font_bold" id="S3.T2.21.21.21.21.1.1" style="background-color:#D1E9F6;">29.26</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb ltx_border_tt" id="S3.T2.22.22.22.22.2"><span class="ltx_text ltx_markedasmath ltx_font_bold" id="S3.T2.22.22.22.22.2.1" style="background-color:#D1E9F6;">0.9250</span></td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_figure ltx_minipage ltx_align_middle" id="S3.T2.46.46" style="width:216.8pt;">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Table 2: </span><span class="ltx_text ltx_font_bold" id="S3.T2.46.46.26.1">Video Desnowing Results.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T2.46.46.24">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T2.24.24.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S3.T2.24.24.2.2.3"><span class="ltx_text ltx_font_bold" id="S3.T2.24.24.2.2.3.1">Method</span></th>
<td class="ltx_td ltx_align_left ltx_border_tt" id="S3.T2.23.23.1.1.1"><span class="ltx_text ltx_font_bold" id="S3.T2.23.23.1.1.1.1">PSNR<math alttext="\uparrow" class="ltx_Math" display="inline" id="S3.T2.23.23.1.1.1.1.m1.1"><semantics id="S3.T2.23.23.1.1.1.1.m1.1a"><mo id="S3.T2.23.23.1.1.1.1.m1.1.1" stretchy="false" xref="S3.T2.23.23.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T2.23.23.1.1.1.1.m1.1b"><ci id="S3.T2.23.23.1.1.1.1.m1.1.1.cmml" xref="S3.T2.23.23.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.23.23.1.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T2.23.23.1.1.1.1.m1.1d">↑</annotation></semantics></math></span></td>
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_tt" id="S3.T2.24.24.2.2.2"><span class="ltx_text ltx_font_bold" id="S3.T2.24.24.2.2.2.1">SSIM<math alttext="\uparrow" class="ltx_Math" display="inline" id="S3.T2.24.24.2.2.2.1.m1.1"><semantics id="S3.T2.24.24.2.2.2.1.m1.1a"><mo id="S3.T2.24.24.2.2.2.1.m1.1.1" stretchy="false" xref="S3.T2.24.24.2.2.2.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T2.24.24.2.2.2.1.m1.1b"><ci id="S3.T2.24.24.2.2.2.1.m1.1.1.cmml" xref="S3.T2.24.24.2.2.2.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.24.24.2.2.2.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T2.24.24.2.2.2.1.m1.1d">↑</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="S3.T2.26.26.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T2.26.26.4.4.3">TransWeather <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib65" title="">65</a>]</cite>
</th>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.25.25.3.3.1"><math alttext="23.11" class="ltx_Math" display="inline" id="S3.T2.25.25.3.3.1.m1.1"><semantics id="S3.T2.25.25.3.3.1.m1.1a"><mn id="S3.T2.25.25.3.3.1.m1.1.1" xref="S3.T2.25.25.3.3.1.m1.1.1.cmml">23.11</mn><annotation-xml encoding="MathML-Content" id="S3.T2.25.25.3.3.1.m1.1b"><cn id="S3.T2.25.25.3.3.1.m1.1.1.cmml" type="float" xref="S3.T2.25.25.3.3.1.m1.1.1">23.11</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.25.25.3.3.1.m1.1c">23.11</annotation><annotation encoding="application/x-llamapun" id="S3.T2.25.25.3.3.1.m1.1d">23.11</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t" id="S3.T2.26.26.4.4.2"><math alttext="0.8543" class="ltx_Math" display="inline" id="S3.T2.26.26.4.4.2.m1.1"><semantics id="S3.T2.26.26.4.4.2.m1.1a"><mn id="S3.T2.26.26.4.4.2.m1.1.1" xref="S3.T2.26.26.4.4.2.m1.1.1.cmml">0.8543</mn><annotation-xml encoding="MathML-Content" id="S3.T2.26.26.4.4.2.m1.1b"><cn id="S3.T2.26.26.4.4.2.m1.1.1.cmml" type="float" xref="S3.T2.26.26.4.4.2.m1.1.1">0.8543</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.26.26.4.4.2.m1.1c">0.8543</annotation><annotation encoding="application/x-llamapun" id="S3.T2.26.26.4.4.2.m1.1d">0.8543</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S3.T2.28.28.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T2.28.28.6.6.3">SnowFormer <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib12" title="">12</a>]</cite>
</th>
<td class="ltx_td ltx_align_left" id="S3.T2.27.27.5.5.1"><math alttext="24.01" class="ltx_Math" display="inline" id="S3.T2.27.27.5.5.1.m1.1"><semantics id="S3.T2.27.27.5.5.1.m1.1a"><mn id="S3.T2.27.27.5.5.1.m1.1.1" xref="S3.T2.27.27.5.5.1.m1.1.1.cmml">24.01</mn><annotation-xml encoding="MathML-Content" id="S3.T2.27.27.5.5.1.m1.1b"><cn id="S3.T2.27.27.5.5.1.m1.1.1.cmml" type="float" xref="S3.T2.27.27.5.5.1.m1.1.1">24.01</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.27.27.5.5.1.m1.1c">24.01</annotation><annotation encoding="application/x-llamapun" id="S3.T2.27.27.5.5.1.m1.1d">24.01</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S3.T2.28.28.6.6.2"><math alttext="0.8939" class="ltx_Math" display="inline" id="S3.T2.28.28.6.6.2.m1.1"><semantics id="S3.T2.28.28.6.6.2.m1.1a"><mn id="S3.T2.28.28.6.6.2.m1.1.1" xref="S3.T2.28.28.6.6.2.m1.1.1.cmml">0.8939</mn><annotation-xml encoding="MathML-Content" id="S3.T2.28.28.6.6.2.m1.1b"><cn id="S3.T2.28.28.6.6.2.m1.1.1.cmml" type="float" xref="S3.T2.28.28.6.6.2.m1.1.1">0.8939</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.28.28.6.6.2.m1.1c">0.8939</annotation><annotation encoding="application/x-llamapun" id="S3.T2.28.28.6.6.2.m1.1d">0.8939</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S3.T2.30.30.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T2.30.30.8.8.3">S2VD <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib78" title="">78</a>]</cite>
</th>
<td class="ltx_td ltx_align_left" id="S3.T2.29.29.7.7.1"><math alttext="22.95" class="ltx_Math" display="inline" id="S3.T2.29.29.7.7.1.m1.1"><semantics id="S3.T2.29.29.7.7.1.m1.1a"><mn id="S3.T2.29.29.7.7.1.m1.1.1" xref="S3.T2.29.29.7.7.1.m1.1.1.cmml">22.95</mn><annotation-xml encoding="MathML-Content" id="S3.T2.29.29.7.7.1.m1.1b"><cn id="S3.T2.29.29.7.7.1.m1.1.1.cmml" type="float" xref="S3.T2.29.29.7.7.1.m1.1.1">22.95</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.29.29.7.7.1.m1.1c">22.95</annotation><annotation encoding="application/x-llamapun" id="S3.T2.29.29.7.7.1.m1.1d">22.95</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S3.T2.30.30.8.8.2"><math alttext="0.8590" class="ltx_Math" display="inline" id="S3.T2.30.30.8.8.2.m1.1"><semantics id="S3.T2.30.30.8.8.2.m1.1a"><mn id="S3.T2.30.30.8.8.2.m1.1.1" xref="S3.T2.30.30.8.8.2.m1.1.1.cmml">0.8590</mn><annotation-xml encoding="MathML-Content" id="S3.T2.30.30.8.8.2.m1.1b"><cn id="S3.T2.30.30.8.8.2.m1.1.1.cmml" type="float" xref="S3.T2.30.30.8.8.2.m1.1.1">0.8590</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.30.30.8.8.2.m1.1c">0.8590</annotation><annotation encoding="application/x-llamapun" id="S3.T2.30.30.8.8.2.m1.1d">0.8590</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S3.T2.32.32.10.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T2.32.32.10.10.3">RDDNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib68" title="">68</a>]</cite>
</th>
<td class="ltx_td ltx_align_left" id="S3.T2.31.31.9.9.1"><math alttext="22.97" class="ltx_Math" display="inline" id="S3.T2.31.31.9.9.1.m1.1"><semantics id="S3.T2.31.31.9.9.1.m1.1a"><mn id="S3.T2.31.31.9.9.1.m1.1.1" xref="S3.T2.31.31.9.9.1.m1.1.1.cmml">22.97</mn><annotation-xml encoding="MathML-Content" id="S3.T2.31.31.9.9.1.m1.1b"><cn id="S3.T2.31.31.9.9.1.m1.1.1.cmml" type="float" xref="S3.T2.31.31.9.9.1.m1.1.1">22.97</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.31.31.9.9.1.m1.1c">22.97</annotation><annotation encoding="application/x-llamapun" id="S3.T2.31.31.9.9.1.m1.1d">22.97</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S3.T2.32.32.10.10.2"><math alttext="0.8742" class="ltx_Math" display="inline" id="S3.T2.32.32.10.10.2.m1.1"><semantics id="S3.T2.32.32.10.10.2.m1.1a"><mn id="S3.T2.32.32.10.10.2.m1.1.1" xref="S3.T2.32.32.10.10.2.m1.1.1.cmml">0.8742</mn><annotation-xml encoding="MathML-Content" id="S3.T2.32.32.10.10.2.m1.1b"><cn id="S3.T2.32.32.10.10.2.m1.1.1.cmml" type="float" xref="S3.T2.32.32.10.10.2.m1.1.1">0.8742</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.32.32.10.10.2.m1.1c">0.8742</annotation><annotation encoding="application/x-llamapun" id="S3.T2.32.32.10.10.2.m1.1d">0.8742</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S3.T2.34.34.12.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T2.34.34.12.12.3">EDVR <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib69" title="">69</a>]</cite>
</th>
<td class="ltx_td ltx_align_left" id="S3.T2.33.33.11.11.1"><math alttext="17.93" class="ltx_Math" display="inline" id="S3.T2.33.33.11.11.1.m1.1"><semantics id="S3.T2.33.33.11.11.1.m1.1a"><mn id="S3.T2.33.33.11.11.1.m1.1.1" xref="S3.T2.33.33.11.11.1.m1.1.1.cmml">17.93</mn><annotation-xml encoding="MathML-Content" id="S3.T2.33.33.11.11.1.m1.1b"><cn id="S3.T2.33.33.11.11.1.m1.1.1.cmml" type="float" xref="S3.T2.33.33.11.11.1.m1.1.1">17.93</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.33.33.11.11.1.m1.1c">17.93</annotation><annotation encoding="application/x-llamapun" id="S3.T2.33.33.11.11.1.m1.1d">17.93</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S3.T2.34.34.12.12.2"><math alttext="0.5790" class="ltx_Math" display="inline" id="S3.T2.34.34.12.12.2.m1.1"><semantics id="S3.T2.34.34.12.12.2.m1.1a"><mn id="S3.T2.34.34.12.12.2.m1.1.1" xref="S3.T2.34.34.12.12.2.m1.1.1.cmml">0.5790</mn><annotation-xml encoding="MathML-Content" id="S3.T2.34.34.12.12.2.m1.1b"><cn id="S3.T2.34.34.12.12.2.m1.1.1.cmml" type="float" xref="S3.T2.34.34.12.12.2.m1.1.1">0.5790</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.34.34.12.12.2.m1.1c">0.5790</annotation><annotation encoding="application/x-llamapun" id="S3.T2.34.34.12.12.2.m1.1d">0.5790</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S3.T2.36.36.14.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T2.36.36.14.14.3">BasicVSR <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib6" title="">6</a>]</cite>
</th>
<td class="ltx_td ltx_align_left" id="S3.T2.35.35.13.13.1"><math alttext="22.46" class="ltx_Math" display="inline" id="S3.T2.35.35.13.13.1.m1.1"><semantics id="S3.T2.35.35.13.13.1.m1.1a"><mn id="S3.T2.35.35.13.13.1.m1.1.1" xref="S3.T2.35.35.13.13.1.m1.1.1.cmml">22.46</mn><annotation-xml encoding="MathML-Content" id="S3.T2.35.35.13.13.1.m1.1b"><cn id="S3.T2.35.35.13.13.1.m1.1.1.cmml" type="float" xref="S3.T2.35.35.13.13.1.m1.1.1">22.46</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.35.35.13.13.1.m1.1c">22.46</annotation><annotation encoding="application/x-llamapun" id="S3.T2.35.35.13.13.1.m1.1d">22.46</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S3.T2.36.36.14.14.2"><math alttext="0.8473" class="ltx_Math" display="inline" id="S3.T2.36.36.14.14.2.m1.1"><semantics id="S3.T2.36.36.14.14.2.m1.1a"><mn id="S3.T2.36.36.14.14.2.m1.1.1" xref="S3.T2.36.36.14.14.2.m1.1.1.cmml">0.8473</mn><annotation-xml encoding="MathML-Content" id="S3.T2.36.36.14.14.2.m1.1b"><cn id="S3.T2.36.36.14.14.2.m1.1.1.cmml" type="float" xref="S3.T2.36.36.14.14.2.m1.1.1">0.8473</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.36.36.14.14.2.m1.1c">0.8473</annotation><annotation encoding="application/x-llamapun" id="S3.T2.36.36.14.14.2.m1.1d">0.8473</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S3.T2.38.38.16.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T2.38.38.16.16.3">IconVSR <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib6" title="">6</a>]</cite>
</th>
<td class="ltx_td ltx_align_left" id="S3.T2.37.37.15.15.1"><math alttext="22.35" class="ltx_Math" display="inline" id="S3.T2.37.37.15.15.1.m1.1"><semantics id="S3.T2.37.37.15.15.1.m1.1a"><mn id="S3.T2.37.37.15.15.1.m1.1.1" xref="S3.T2.37.37.15.15.1.m1.1.1.cmml">22.35</mn><annotation-xml encoding="MathML-Content" id="S3.T2.37.37.15.15.1.m1.1b"><cn id="S3.T2.37.37.15.15.1.m1.1.1.cmml" type="float" xref="S3.T2.37.37.15.15.1.m1.1.1">22.35</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.37.37.15.15.1.m1.1c">22.35</annotation><annotation encoding="application/x-llamapun" id="S3.T2.37.37.15.15.1.m1.1d">22.35</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S3.T2.38.38.16.16.2"><math alttext="0.8482" class="ltx_Math" display="inline" id="S3.T2.38.38.16.16.2.m1.1"><semantics id="S3.T2.38.38.16.16.2.m1.1a"><mn id="S3.T2.38.38.16.16.2.m1.1.1" xref="S3.T2.38.38.16.16.2.m1.1.1.cmml">0.8482</mn><annotation-xml encoding="MathML-Content" id="S3.T2.38.38.16.16.2.m1.1b"><cn id="S3.T2.38.38.16.16.2.m1.1.1.cmml" type="float" xref="S3.T2.38.38.16.16.2.m1.1.1">0.8482</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.38.38.16.16.2.m1.1c">0.8482</annotation><annotation encoding="application/x-llamapun" id="S3.T2.38.38.16.16.2.m1.1d">0.8482</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S3.T2.40.40.18.18">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T2.40.40.18.18.3">BasicVSR++ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib7" title="">7</a>]</cite>
</th>
<td class="ltx_td ltx_align_left" id="S3.T2.39.39.17.17.1"><math alttext="22.64" class="ltx_Math" display="inline" id="S3.T2.39.39.17.17.1.m1.1"><semantics id="S3.T2.39.39.17.17.1.m1.1a"><mn id="S3.T2.39.39.17.17.1.m1.1.1" xref="S3.T2.39.39.17.17.1.m1.1.1.cmml">22.64</mn><annotation-xml encoding="MathML-Content" id="S3.T2.39.39.17.17.1.m1.1b"><cn id="S3.T2.39.39.17.17.1.m1.1.1.cmml" type="float" xref="S3.T2.39.39.17.17.1.m1.1.1">22.64</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.39.39.17.17.1.m1.1c">22.64</annotation><annotation encoding="application/x-llamapun" id="S3.T2.39.39.17.17.1.m1.1d">22.64</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S3.T2.40.40.18.18.2"><math alttext="0.8618" class="ltx_Math" display="inline" id="S3.T2.40.40.18.18.2.m1.1"><semantics id="S3.T2.40.40.18.18.2.m1.1a"><mn id="S3.T2.40.40.18.18.2.m1.1.1" xref="S3.T2.40.40.18.18.2.m1.1.1.cmml">0.8618</mn><annotation-xml encoding="MathML-Content" id="S3.T2.40.40.18.18.2.m1.1b"><cn id="S3.T2.40.40.18.18.2.m1.1.1.cmml" type="float" xref="S3.T2.40.40.18.18.2.m1.1.1">0.8618</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.40.40.18.18.2.m1.1c">0.8618</annotation><annotation encoding="application/x-llamapun" id="S3.T2.40.40.18.18.2.m1.1d">0.8618</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S3.T2.42.42.20.20">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T2.42.42.20.20.3">RVRT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib33" title="">33</a>]</cite>
</th>
<td class="ltx_td ltx_align_left" id="S3.T2.41.41.19.19.1"><math alttext="20.90" class="ltx_Math" display="inline" id="S3.T2.41.41.19.19.1.m1.1"><semantics id="S3.T2.41.41.19.19.1.m1.1a"><mn id="S3.T2.41.41.19.19.1.m1.1.1" xref="S3.T2.41.41.19.19.1.m1.1.1.cmml">20.90</mn><annotation-xml encoding="MathML-Content" id="S3.T2.41.41.19.19.1.m1.1b"><cn id="S3.T2.41.41.19.19.1.m1.1.1.cmml" type="float" xref="S3.T2.41.41.19.19.1.m1.1.1">20.90</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.41.41.19.19.1.m1.1c">20.90</annotation><annotation encoding="application/x-llamapun" id="S3.T2.41.41.19.19.1.m1.1d">20.90</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S3.T2.42.42.20.20.2"><math alttext="0.7974" class="ltx_Math" display="inline" id="S3.T2.42.42.20.20.2.m1.1"><semantics id="S3.T2.42.42.20.20.2.m1.1a"><mn id="S3.T2.42.42.20.20.2.m1.1.1" xref="S3.T2.42.42.20.20.2.m1.1.1.cmml">0.7974</mn><annotation-xml encoding="MathML-Content" id="S3.T2.42.42.20.20.2.m1.1b"><cn id="S3.T2.42.42.20.20.2.m1.1.1.cmml" type="float" xref="S3.T2.42.42.20.20.2.m1.1.1">0.7974</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.42.42.20.20.2.m1.1c">0.7974</annotation><annotation encoding="application/x-llamapun" id="S3.T2.42.42.20.20.2.m1.1d">0.7974</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S3.T2.44.44.22.22">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T2.44.44.22.22.3">SVDNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib10" title="">10</a>]</cite>
</th>
<td class="ltx_td ltx_align_left" id="S3.T2.43.43.21.21.1"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.43.43.21.21.1.1"><math alttext="25.06" class="ltx_Math" display="inline" id="S3.T2.43.43.21.21.1.1.m1.1"><semantics id="S3.T2.43.43.21.21.1.1.m1.1a"><mn id="S3.T2.43.43.21.21.1.1.m1.1.1" xref="S3.T2.43.43.21.21.1.1.m1.1.1.cmml">25.06</mn><annotation-xml encoding="MathML-Content" id="S3.T2.43.43.21.21.1.1.m1.1b"><cn id="S3.T2.43.43.21.21.1.1.m1.1.1.cmml" type="float" xref="S3.T2.43.43.21.21.1.1.m1.1.1">25.06</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.43.43.21.21.1.1.m1.1c">25.06</annotation><annotation encoding="application/x-llamapun" id="S3.T2.43.43.21.21.1.1.m1.1d">25.06</annotation></semantics></math></span></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S3.T2.44.44.22.22.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.44.44.22.22.2.1"><math alttext="0.9210" class="ltx_Math" display="inline" id="S3.T2.44.44.22.22.2.1.m1.1"><semantics id="S3.T2.44.44.22.22.2.1.m1.1a"><mn id="S3.T2.44.44.22.22.2.1.m1.1.1" xref="S3.T2.44.44.22.22.2.1.m1.1.1.cmml">0.9210</mn><annotation-xml encoding="MathML-Content" id="S3.T2.44.44.22.22.2.1.m1.1b"><cn id="S3.T2.44.44.22.22.2.1.m1.1.1.cmml" type="float" xref="S3.T2.44.44.22.22.2.1.m1.1.1">0.9210</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.44.44.22.22.2.1.m1.1c">0.9210</annotation><annotation encoding="application/x-llamapun" id="S3.T2.44.44.22.22.2.1.m1.1d">0.9210</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="S3.T2.46.46.24.24" style="background-color:#D1E9F6;">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_tt" id="S3.T2.46.46.24.24.3"><span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="S3.T2.46.46.24.24.3.1" style="background-color:#D1E9F6;">Turtle</span></th>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_tt" id="S3.T2.45.45.23.23.1"><span class="ltx_text ltx_markedasmath ltx_font_bold" id="S3.T2.45.45.23.23.1.1" style="background-color:#D1E9F6;">26.02</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb ltx_border_tt" id="S3.T2.46.46.24.24.2"><span class="ltx_text ltx_markedasmath ltx_font_bold" id="S3.T2.46.46.24.24.2.1" style="background-color:#D1E9F6;">0.9230</span></td>
</tr>
</tbody>
</table>
</figure>
</span></div>
</figure>
<figure class="ltx_figure" id="S3.F3">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.F3.1" style="width:392.0pt;height:215.5pt;vertical-align:-0.9pt;"><span class="ltx_transformed_inner" style="transform:translate(-21.8pt,11.9pt) scale(0.9,0.9) ;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="457" id="S3.F3.1.g1" src="x3.png" width="830"/>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span><span class="ltx_text ltx_font_bold" id="S3.F3.6.1">Visual Results on Video Desnowing and Nighttime Video Deraining.</span> We compare video desnowing results with the best published method in literature, SVDNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib10" title="">10</a>]</cite>. The video frame has both snow, and haze. While SVDNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib10" title="">10</a>]</cite> removes snow flakes, <span class="ltx_text ltx_font_smallcaps" id="S3.F3.7.2">turtle</span> can remove haze, and snow flakes, and hence is more faithful to the ground truth. In nighttime deraining, we compare <span class="ltx_text ltx_font_smallcaps" id="S3.F3.8.3">turtle</span> to MetaRain <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib47" title="">47</a>]</cite>. <span class="ltx_text ltx_font_smallcaps" id="S3.F3.9.4">turtle</span> maintains color consistency in the restored result.</figcaption>
</figure>
</section>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.8">We follow the standard training setting of architectures in the restoration literature <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib29" title="">29</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib79" title="">79</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib15" title="">15</a>]</cite> with Adam optimizer <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib27" title="">27</a>]</cite> (<math alttext="\beta_{1}=0.9,\beta_{2}=0.999" class="ltx_Math" display="inline" id="S4.p1.1.m1.2"><semantics id="S4.p1.1.m1.2a"><mrow id="S4.p1.1.m1.2.2.2" xref="S4.p1.1.m1.2.2.3.cmml"><mrow id="S4.p1.1.m1.1.1.1.1" xref="S4.p1.1.m1.1.1.1.1.cmml"><msub id="S4.p1.1.m1.1.1.1.1.2" xref="S4.p1.1.m1.1.1.1.1.2.cmml"><mi id="S4.p1.1.m1.1.1.1.1.2.2" xref="S4.p1.1.m1.1.1.1.1.2.2.cmml">β</mi><mn id="S4.p1.1.m1.1.1.1.1.2.3" xref="S4.p1.1.m1.1.1.1.1.2.3.cmml">1</mn></msub><mo id="S4.p1.1.m1.1.1.1.1.1" xref="S4.p1.1.m1.1.1.1.1.1.cmml">=</mo><mn id="S4.p1.1.m1.1.1.1.1.3" xref="S4.p1.1.m1.1.1.1.1.3.cmml">0.9</mn></mrow><mo id="S4.p1.1.m1.2.2.2.3" xref="S4.p1.1.m1.2.2.3a.cmml">,</mo><mrow id="S4.p1.1.m1.2.2.2.2" xref="S4.p1.1.m1.2.2.2.2.cmml"><msub id="S4.p1.1.m1.2.2.2.2.2" xref="S4.p1.1.m1.2.2.2.2.2.cmml"><mi id="S4.p1.1.m1.2.2.2.2.2.2" xref="S4.p1.1.m1.2.2.2.2.2.2.cmml">β</mi><mn id="S4.p1.1.m1.2.2.2.2.2.3" xref="S4.p1.1.m1.2.2.2.2.2.3.cmml">2</mn></msub><mo id="S4.p1.1.m1.2.2.2.2.1" xref="S4.p1.1.m1.2.2.2.2.1.cmml">=</mo><mn id="S4.p1.1.m1.2.2.2.2.3" xref="S4.p1.1.m1.2.2.2.2.3.cmml">0.999</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.1.m1.2b"><apply id="S4.p1.1.m1.2.2.3.cmml" xref="S4.p1.1.m1.2.2.2"><csymbol cd="ambiguous" id="S4.p1.1.m1.2.2.3a.cmml" xref="S4.p1.1.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S4.p1.1.m1.1.1.1.1.cmml" xref="S4.p1.1.m1.1.1.1.1"><eq id="S4.p1.1.m1.1.1.1.1.1.cmml" xref="S4.p1.1.m1.1.1.1.1.1"></eq><apply id="S4.p1.1.m1.1.1.1.1.2.cmml" xref="S4.p1.1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.p1.1.m1.1.1.1.1.2.1.cmml" xref="S4.p1.1.m1.1.1.1.1.2">subscript</csymbol><ci id="S4.p1.1.m1.1.1.1.1.2.2.cmml" xref="S4.p1.1.m1.1.1.1.1.2.2">𝛽</ci><cn id="S4.p1.1.m1.1.1.1.1.2.3.cmml" type="integer" xref="S4.p1.1.m1.1.1.1.1.2.3">1</cn></apply><cn id="S4.p1.1.m1.1.1.1.1.3.cmml" type="float" xref="S4.p1.1.m1.1.1.1.1.3">0.9</cn></apply><apply id="S4.p1.1.m1.2.2.2.2.cmml" xref="S4.p1.1.m1.2.2.2.2"><eq id="S4.p1.1.m1.2.2.2.2.1.cmml" xref="S4.p1.1.m1.2.2.2.2.1"></eq><apply id="S4.p1.1.m1.2.2.2.2.2.cmml" xref="S4.p1.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.p1.1.m1.2.2.2.2.2.1.cmml" xref="S4.p1.1.m1.2.2.2.2.2">subscript</csymbol><ci id="S4.p1.1.m1.2.2.2.2.2.2.cmml" xref="S4.p1.1.m1.2.2.2.2.2.2">𝛽</ci><cn id="S4.p1.1.m1.2.2.2.2.2.3.cmml" type="integer" xref="S4.p1.1.m1.2.2.2.2.2.3">2</cn></apply><cn id="S4.p1.1.m1.2.2.2.2.3.cmml" type="float" xref="S4.p1.1.m1.2.2.2.2.3">0.999</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.1.m1.2c">\beta_{1}=0.9,\beta_{2}=0.999</annotation><annotation encoding="application/x-llamapun" id="S4.p1.1.m1.2d">italic_β start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = 0.9 , italic_β start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = 0.999</annotation></semantics></math>). The initial learning rate is set to <math alttext="4e^{-4}" class="ltx_Math" display="inline" id="S4.p1.2.m2.1"><semantics id="S4.p1.2.m2.1a"><mrow id="S4.p1.2.m2.1.1" xref="S4.p1.2.m2.1.1.cmml"><mn id="S4.p1.2.m2.1.1.2" xref="S4.p1.2.m2.1.1.2.cmml">4</mn><mo id="S4.p1.2.m2.1.1.1" xref="S4.p1.2.m2.1.1.1.cmml">⁢</mo><msup id="S4.p1.2.m2.1.1.3" xref="S4.p1.2.m2.1.1.3.cmml"><mi id="S4.p1.2.m2.1.1.3.2" xref="S4.p1.2.m2.1.1.3.2.cmml">e</mi><mrow id="S4.p1.2.m2.1.1.3.3" xref="S4.p1.2.m2.1.1.3.3.cmml"><mo id="S4.p1.2.m2.1.1.3.3a" xref="S4.p1.2.m2.1.1.3.3.cmml">−</mo><mn id="S4.p1.2.m2.1.1.3.3.2" xref="S4.p1.2.m2.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.2.m2.1b"><apply id="S4.p1.2.m2.1.1.cmml" xref="S4.p1.2.m2.1.1"><times id="S4.p1.2.m2.1.1.1.cmml" xref="S4.p1.2.m2.1.1.1"></times><cn id="S4.p1.2.m2.1.1.2.cmml" type="integer" xref="S4.p1.2.m2.1.1.2">4</cn><apply id="S4.p1.2.m2.1.1.3.cmml" xref="S4.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.p1.2.m2.1.1.3.1.cmml" xref="S4.p1.2.m2.1.1.3">superscript</csymbol><ci id="S4.p1.2.m2.1.1.3.2.cmml" xref="S4.p1.2.m2.1.1.3.2">𝑒</ci><apply id="S4.p1.2.m2.1.1.3.3.cmml" xref="S4.p1.2.m2.1.1.3.3"><minus id="S4.p1.2.m2.1.1.3.3.1.cmml" xref="S4.p1.2.m2.1.1.3.3"></minus><cn id="S4.p1.2.m2.1.1.3.3.2.cmml" type="integer" xref="S4.p1.2.m2.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.2.m2.1c">4e^{-4}</annotation><annotation encoding="application/x-llamapun" id="S4.p1.2.m2.1d">4 italic_e start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math>, and is decayed to <math alttext="1e^{-7}" class="ltx_Math" display="inline" id="S4.p1.3.m3.1"><semantics id="S4.p1.3.m3.1a"><mrow id="S4.p1.3.m3.1.1" xref="S4.p1.3.m3.1.1.cmml"><mn id="S4.p1.3.m3.1.1.2" xref="S4.p1.3.m3.1.1.2.cmml">1</mn><mo id="S4.p1.3.m3.1.1.1" xref="S4.p1.3.m3.1.1.1.cmml">⁢</mo><msup id="S4.p1.3.m3.1.1.3" xref="S4.p1.3.m3.1.1.3.cmml"><mi id="S4.p1.3.m3.1.1.3.2" xref="S4.p1.3.m3.1.1.3.2.cmml">e</mi><mrow id="S4.p1.3.m3.1.1.3.3" xref="S4.p1.3.m3.1.1.3.3.cmml"><mo id="S4.p1.3.m3.1.1.3.3a" xref="S4.p1.3.m3.1.1.3.3.cmml">−</mo><mn id="S4.p1.3.m3.1.1.3.3.2" xref="S4.p1.3.m3.1.1.3.3.2.cmml">7</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.3.m3.1b"><apply id="S4.p1.3.m3.1.1.cmml" xref="S4.p1.3.m3.1.1"><times id="S4.p1.3.m3.1.1.1.cmml" xref="S4.p1.3.m3.1.1.1"></times><cn id="S4.p1.3.m3.1.1.2.cmml" type="integer" xref="S4.p1.3.m3.1.1.2">1</cn><apply id="S4.p1.3.m3.1.1.3.cmml" xref="S4.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.p1.3.m3.1.1.3.1.cmml" xref="S4.p1.3.m3.1.1.3">superscript</csymbol><ci id="S4.p1.3.m3.1.1.3.2.cmml" xref="S4.p1.3.m3.1.1.3.2">𝑒</ci><apply id="S4.p1.3.m3.1.1.3.3.cmml" xref="S4.p1.3.m3.1.1.3.3"><minus id="S4.p1.3.m3.1.1.3.3.1.cmml" xref="S4.p1.3.m3.1.1.3.3"></minus><cn id="S4.p1.3.m3.1.1.3.3.2.cmml" type="integer" xref="S4.p1.3.m3.1.1.3.3.2">7</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.3.m3.1c">1e^{-7}</annotation><annotation encoding="application/x-llamapun" id="S4.p1.3.m3.1d">1 italic_e start_POSTSUPERSCRIPT - 7 end_POSTSUPERSCRIPT</annotation></semantics></math> throughout training following the cosine annealing strategy <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib40" title="">40</a>]</cite>. All of our models are implemented in the PyTorch library, and are trained on <math alttext="8" class="ltx_Math" display="inline" id="S4.p1.4.m4.1"><semantics id="S4.p1.4.m4.1a"><mn id="S4.p1.4.m4.1.1" xref="S4.p1.4.m4.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="S4.p1.4.m4.1b"><cn id="S4.p1.4.m4.1.1.cmml" type="integer" xref="S4.p1.4.m4.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.4.m4.1c">8</annotation><annotation encoding="application/x-llamapun" id="S4.p1.4.m4.1d">8</annotation></semantics></math> NVIDIA Tesla v100 PCIe 32
GB GPUs for <math alttext="250" class="ltx_Math" display="inline" id="S4.p1.5.m5.1"><semantics id="S4.p1.5.m5.1a"><mn id="S4.p1.5.m5.1.1" xref="S4.p1.5.m5.1.1.cmml">250</mn><annotation-xml encoding="MathML-Content" id="S4.p1.5.m5.1b"><cn id="S4.p1.5.m5.1.1.cmml" type="integer" xref="S4.p1.5.m5.1.1">250</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.5.m5.1c">250</annotation><annotation encoding="application/x-llamapun" id="S4.p1.5.m5.1d">250</annotation></semantics></math>k iterations. Each training video is sampled into clips of <math alttext="\gamma=5" class="ltx_Math" display="inline" id="S4.p1.6.m6.1"><semantics id="S4.p1.6.m6.1a"><mrow id="S4.p1.6.m6.1.1" xref="S4.p1.6.m6.1.1.cmml"><mi id="S4.p1.6.m6.1.1.2" xref="S4.p1.6.m6.1.1.2.cmml">γ</mi><mo id="S4.p1.6.m6.1.1.1" xref="S4.p1.6.m6.1.1.1.cmml">=</mo><mn id="S4.p1.6.m6.1.1.3" xref="S4.p1.6.m6.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.6.m6.1b"><apply id="S4.p1.6.m6.1.1.cmml" xref="S4.p1.6.m6.1.1"><eq id="S4.p1.6.m6.1.1.1.cmml" xref="S4.p1.6.m6.1.1.1"></eq><ci id="S4.p1.6.m6.1.1.2.cmml" xref="S4.p1.6.m6.1.1.2">𝛾</ci><cn id="S4.p1.6.m6.1.1.3.cmml" type="integer" xref="S4.p1.6.m6.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.6.m6.1c">\gamma=5</annotation><annotation encoding="application/x-llamapun" id="S4.p1.6.m6.1d">italic_γ = 5</annotation></semantics></math> frames, and <span class="ltx_text ltx_font_smallcaps" id="S4.p1.8.1">turtle</span> restores frames of each clip with recurrence. The training videos are cropped to <math alttext="192\times 192" class="ltx_Math" display="inline" id="S4.p1.7.m7.1"><semantics id="S4.p1.7.m7.1a"><mrow id="S4.p1.7.m7.1.1" xref="S4.p1.7.m7.1.1.cmml"><mn id="S4.p1.7.m7.1.1.2" xref="S4.p1.7.m7.1.1.2.cmml">192</mn><mo id="S4.p1.7.m7.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.p1.7.m7.1.1.1.cmml">×</mo><mn id="S4.p1.7.m7.1.1.3" xref="S4.p1.7.m7.1.1.3.cmml">192</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.7.m7.1b"><apply id="S4.p1.7.m7.1.1.cmml" xref="S4.p1.7.m7.1.1"><times id="S4.p1.7.m7.1.1.1.cmml" xref="S4.p1.7.m7.1.1.1"></times><cn id="S4.p1.7.m7.1.1.2.cmml" type="integer" xref="S4.p1.7.m7.1.1.2">192</cn><cn id="S4.p1.7.m7.1.1.3.cmml" type="integer" xref="S4.p1.7.m7.1.1.3">192</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.7.m7.1c">192\times 192</annotation><annotation encoding="application/x-llamapun" id="S4.p1.7.m7.1d">192 × 192</annotation></semantics></math> sized patches at random locations, maintaining temporal consistency, while the evaluation is done on the full frames during inference. We assume no prior knowledge of the degradation process for all the tasks. Further, we apply basic data augmentation techniques, including horizontal-vertical flips and <math alttext="90" class="ltx_Math" display="inline" id="S4.p1.8.m8.1"><semantics id="S4.p1.8.m8.1a"><mn id="S4.p1.8.m8.1.1" xref="S4.p1.8.m8.1.1.cmml">90</mn><annotation-xml encoding="MathML-Content" id="S4.p1.8.m8.1b"><cn id="S4.p1.8.m8.1.1.cmml" type="integer" xref="S4.p1.8.m8.1.1">90</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.8.m8.1c">90</annotation><annotation encoding="application/x-llamapun" id="S4.p1.8.m8.1d">90</annotation></semantics></math>-degree rotations. Following the video restoration literature, we use Peak Signal-to-Noise Ratio (PSNR) and Structural Similarity Index (SSIM) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib70" title="">70</a>]</cite> distortion metrics to report quantitative performance. For qualitative evaluation, we present visual outputs for each task and compare them with the results obtained from previous best methods in the literature.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Night Video Deraining</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.4">SynNightRain <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib47" title="">47</a>]</cite> is a synthetic video deraining dataset focusing on nighttime videos wherein rain streaks get mixed in with significant noise in low-light regions. Therefore, nighttime deraining with heavy rain is generally a harder restoration task than other daytime video deraining. We follow the train/test protocol outlined in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib47" title="">47</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib35" title="">35</a>]</cite>, and train <span class="ltx_text ltx_font_smallcaps" id="S4.SS1.p1.4.2">turtle</span> on <math alttext="10" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><mn id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><cn id="S4.SS1.p1.1.m1.1.1.cmml" type="integer" xref="S4.SS1.p1.1.m1.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">10</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">10</annotation></semantics></math> videos from scratch, and evaluate on a held-out test set of <math alttext="20" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.1"><semantics id="S4.SS1.p1.2.m2.1a"><mn id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><cn id="S4.SS1.p1.2.m2.1.1.cmml" type="integer" xref="S4.SS1.p1.2.m2.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">20</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m2.1d">20</annotation></semantics></math> videos. We report distortion metrics, PSNR and SSIM, in <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S3.T2" title="In Frame History Router (𝜓). ‣ 3.2 Causal History Model ‣ 3 Methodology ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">table</span> <span class="ltx_text ltx_ref_tag">2</span></a>, and compare them with previous restoration methods. <span class="ltx_text ltx_font_smallcaps" id="S4.SS1.p1.4.3">turtle</span> achieves a PSNR of <span class="ltx_text" id="S4.SS1.p1.3.1"><math alttext="29.26" class="ltx_Math" display="inline" id="S4.SS1.p1.3.1.m1.1" style="background-color:#D1E9F6;"><semantics id="S4.SS1.p1.3.1.m1.1a"><mn id="S4.SS1.p1.3.1.m1.1.1" mathbackground="#D1E9F6" xref="S4.SS1.p1.3.1.m1.1.1.cmml">29.26</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.1.m1.1b"><cn id="S4.SS1.p1.3.1.m1.1.1.cmml" type="float" xref="S4.SS1.p1.3.1.m1.1.1">29.26</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.1.m1.1c">29.26</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.3.1.m1.1d">29.26</annotation></semantics></math></span> dB, which is a notable improvement of <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.SS1.p1.4.4" style="color:#007F73;">+2.53</span> dB over the next best result, NightRain <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib35" title="">35</a>]</cite>. Further, we present visual results in <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S3.F3" title="In Frame History Router (𝜓). ‣ 3.2 Causal History Model ‣ 3 Methodology ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">3</span></a>, and in <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A3.F12" title="In Appendix C Relationship to State Space Models ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">12</span></a>. Our method, <span class="ltx_text ltx_font_smallcaps" id="S4.SS1.p1.4.5">turtle</span>, maintains color consistency in the restored results.</p>
</div>
<figure class="ltx_table" id="S4.T5">
<div class="ltx_flex_figure ltx_flex_table">
<div class="ltx_flex_cell ltx_flex_size_3">
<div class="ltx_inline-block ltx_figure_panel ltx_transformed_outer" id="S4.T5.24" style="width:109.4pt;height:152pt;vertical-align:-73.2pt;"><span class="ltx_transformed_inner" style="transform:translate(-13.7pt,9.8pt) scale(0.8,0.8) ;">
<figure class="ltx_figure ltx_minipage ltx_align_middle" id="S4.T5.24.24" style="width:130.1pt;">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Table 3: </span><span class="ltx_text ltx_font_bold" id="S4.T5.24.24.26.1">Real-World Video Deblurring.</span> Quantitative results (PSNR, and SSIM) on the <math alttext="3" class="ltx_Math" display="inline" id="S4.T5.3.3.3.m1.1"><semantics id="S4.T5.3.3.3.m1.1b"><mn id="S4.T5.3.3.3.m1.1.1" xref="S4.T5.3.3.3.m1.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S4.T5.3.3.3.m1.1c"><cn id="S4.T5.3.3.3.m1.1.1.cmml" type="integer" xref="S4.T5.3.3.3.m1.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.3.3.3.m1.1d">3</annotation><annotation encoding="application/x-llamapun" id="S4.T5.3.3.3.m1.1e">3</annotation></semantics></math>ms-<math alttext="24" class="ltx_Math" display="inline" id="S4.T5.4.4.4.m2.1"><semantics id="S4.T5.4.4.4.m2.1b"><mn id="S4.T5.4.4.4.m2.1.1" xref="S4.T5.4.4.4.m2.1.1.cmml">24</mn><annotation-xml encoding="MathML-Content" id="S4.T5.4.4.4.m2.1c"><cn id="S4.T5.4.4.4.m2.1.1.cmml" type="integer" xref="S4.T5.4.4.4.m2.1.1">24</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.4.4.4.m2.1d">24</annotation><annotation encoding="application/x-llamapun" id="S4.T5.4.4.4.m2.1e">24</annotation></semantics></math>ms BSD dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib83" title="">83</a>]</cite> comparing state-of-the-art methods.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T5.24.24.24">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T5.6.6.6.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S4.T5.6.6.6.2.3"><span class="ltx_text ltx_font_bold" id="S4.T5.6.6.6.2.3.1">Method</span></th>
<td class="ltx_td ltx_align_left ltx_border_tt" id="S4.T5.5.5.5.1.1"><span class="ltx_text ltx_font_bold" id="S4.T5.5.5.5.1.1.1">PSNR<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T5.5.5.5.1.1.1.m1.1"><semantics id="S4.T5.5.5.5.1.1.1.m1.1a"><mo id="S4.T5.5.5.5.1.1.1.m1.1.1" stretchy="false" xref="S4.T5.5.5.5.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T5.5.5.5.1.1.1.m1.1b"><ci id="S4.T5.5.5.5.1.1.1.m1.1.1.cmml" xref="S4.T5.5.5.5.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.5.5.5.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T5.5.5.5.1.1.1.m1.1d">↑</annotation></semantics></math></span></td>
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_tt" id="S4.T5.6.6.6.2.2"><span class="ltx_text ltx_font_bold" id="S4.T5.6.6.6.2.2.1">SSIM<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T5.6.6.6.2.2.1.m1.1"><semantics id="S4.T5.6.6.6.2.2.1.m1.1a"><mo id="S4.T5.6.6.6.2.2.1.m1.1.1" stretchy="false" xref="S4.T5.6.6.6.2.2.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T5.6.6.6.2.2.1.m1.1b"><ci id="S4.T5.6.6.6.2.2.1.m1.1.1.cmml" xref="S4.T5.6.6.6.2.2.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.6.6.6.2.2.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T5.6.6.6.2.2.1.m1.1d">↑</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="S4.T5.8.8.8.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T5.8.8.8.4.3">STRCNN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib24" title="">24</a>]</cite>
</th>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T5.7.7.7.3.1"><math alttext="29.42" class="ltx_Math" display="inline" id="S4.T5.7.7.7.3.1.m1.1"><semantics id="S4.T5.7.7.7.3.1.m1.1a"><mn id="S4.T5.7.7.7.3.1.m1.1.1" xref="S4.T5.7.7.7.3.1.m1.1.1.cmml">29.42</mn><annotation-xml encoding="MathML-Content" id="S4.T5.7.7.7.3.1.m1.1b"><cn id="S4.T5.7.7.7.3.1.m1.1.1.cmml" type="float" xref="S4.T5.7.7.7.3.1.m1.1.1">29.42</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.7.7.7.3.1.m1.1c">29.42</annotation><annotation encoding="application/x-llamapun" id="S4.T5.7.7.7.3.1.m1.1d">29.42</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t" id="S4.T5.8.8.8.4.2"><math alttext="0.893" class="ltx_Math" display="inline" id="S4.T5.8.8.8.4.2.m1.1"><semantics id="S4.T5.8.8.8.4.2.m1.1a"><mn id="S4.T5.8.8.8.4.2.m1.1.1" xref="S4.T5.8.8.8.4.2.m1.1.1.cmml">0.893</mn><annotation-xml encoding="MathML-Content" id="S4.T5.8.8.8.4.2.m1.1b"><cn id="S4.T5.8.8.8.4.2.m1.1.1.cmml" type="float" xref="S4.T5.8.8.8.4.2.m1.1.1">0.893</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.8.8.8.4.2.m1.1c">0.893</annotation><annotation encoding="application/x-llamapun" id="S4.T5.8.8.8.4.2.m1.1d">0.893</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T5.10.10.10.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T5.10.10.10.6.3">DBN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib58" title="">58</a>]</cite>
</th>
<td class="ltx_td ltx_align_left" id="S4.T5.9.9.9.5.1"><math alttext="31.21" class="ltx_Math" display="inline" id="S4.T5.9.9.9.5.1.m1.1"><semantics id="S4.T5.9.9.9.5.1.m1.1a"><mn id="S4.T5.9.9.9.5.1.m1.1.1" xref="S4.T5.9.9.9.5.1.m1.1.1.cmml">31.21</mn><annotation-xml encoding="MathML-Content" id="S4.T5.9.9.9.5.1.m1.1b"><cn id="S4.T5.9.9.9.5.1.m1.1.1.cmml" type="float" xref="S4.T5.9.9.9.5.1.m1.1.1">31.21</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.9.9.9.5.1.m1.1c">31.21</annotation><annotation encoding="application/x-llamapun" id="S4.T5.9.9.9.5.1.m1.1d">31.21</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T5.10.10.10.6.2"><math alttext="0.922" class="ltx_Math" display="inline" id="S4.T5.10.10.10.6.2.m1.1"><semantics id="S4.T5.10.10.10.6.2.m1.1a"><mn id="S4.T5.10.10.10.6.2.m1.1.1" xref="S4.T5.10.10.10.6.2.m1.1.1.cmml">0.922</mn><annotation-xml encoding="MathML-Content" id="S4.T5.10.10.10.6.2.m1.1b"><cn id="S4.T5.10.10.10.6.2.m1.1.1.cmml" type="float" xref="S4.T5.10.10.10.6.2.m1.1.1">0.922</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.10.10.10.6.2.m1.1c">0.922</annotation><annotation encoding="application/x-llamapun" id="S4.T5.10.10.10.6.2.m1.1d">0.922</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T5.12.12.12.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T5.12.12.12.8.3">SRN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib60" title="">60</a>]</cite>
</th>
<td class="ltx_td ltx_align_left" id="S4.T5.11.11.11.7.1"><math alttext="28.92" class="ltx_Math" display="inline" id="S4.T5.11.11.11.7.1.m1.1"><semantics id="S4.T5.11.11.11.7.1.m1.1a"><mn id="S4.T5.11.11.11.7.1.m1.1.1" xref="S4.T5.11.11.11.7.1.m1.1.1.cmml">28.92</mn><annotation-xml encoding="MathML-Content" id="S4.T5.11.11.11.7.1.m1.1b"><cn id="S4.T5.11.11.11.7.1.m1.1.1.cmml" type="float" xref="S4.T5.11.11.11.7.1.m1.1.1">28.92</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.11.11.11.7.1.m1.1c">28.92</annotation><annotation encoding="application/x-llamapun" id="S4.T5.11.11.11.7.1.m1.1d">28.92</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T5.12.12.12.8.2"><math alttext="0.882" class="ltx_Math" display="inline" id="S4.T5.12.12.12.8.2.m1.1"><semantics id="S4.T5.12.12.12.8.2.m1.1a"><mn id="S4.T5.12.12.12.8.2.m1.1.1" xref="S4.T5.12.12.12.8.2.m1.1.1.cmml">0.882</mn><annotation-xml encoding="MathML-Content" id="S4.T5.12.12.12.8.2.m1.1b"><cn id="S4.T5.12.12.12.8.2.m1.1.1.cmml" type="float" xref="S4.T5.12.12.12.8.2.m1.1.1">0.882</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.12.12.12.8.2.m1.1c">0.882</annotation><annotation encoding="application/x-llamapun" id="S4.T5.12.12.12.8.2.m1.1d">0.882</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T5.14.14.14.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T5.14.14.14.10.3">IFI-RNN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib42" title="">42</a>]</cite>
</th>
<td class="ltx_td ltx_align_left" id="S4.T5.13.13.13.9.1"><math alttext="30.89" class="ltx_Math" display="inline" id="S4.T5.13.13.13.9.1.m1.1"><semantics id="S4.T5.13.13.13.9.1.m1.1a"><mn id="S4.T5.13.13.13.9.1.m1.1.1" xref="S4.T5.13.13.13.9.1.m1.1.1.cmml">30.89</mn><annotation-xml encoding="MathML-Content" id="S4.T5.13.13.13.9.1.m1.1b"><cn id="S4.T5.13.13.13.9.1.m1.1.1.cmml" type="float" xref="S4.T5.13.13.13.9.1.m1.1.1">30.89</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.13.13.13.9.1.m1.1c">30.89</annotation><annotation encoding="application/x-llamapun" id="S4.T5.13.13.13.9.1.m1.1d">30.89</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T5.14.14.14.10.2"><math alttext="0.917" class="ltx_Math" display="inline" id="S4.T5.14.14.14.10.2.m1.1"><semantics id="S4.T5.14.14.14.10.2.m1.1a"><mn id="S4.T5.14.14.14.10.2.m1.1.1" xref="S4.T5.14.14.14.10.2.m1.1.1.cmml">0.917</mn><annotation-xml encoding="MathML-Content" id="S4.T5.14.14.14.10.2.m1.1b"><cn id="S4.T5.14.14.14.10.2.m1.1.1.cmml" type="float" xref="S4.T5.14.14.14.10.2.m1.1.1">0.917</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.14.14.14.10.2.m1.1c">0.917</annotation><annotation encoding="application/x-llamapun" id="S4.T5.14.14.14.10.2.m1.1d">0.917</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T5.16.16.16.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T5.16.16.16.12.3">STFAN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib86" title="">86</a>]</cite>
</th>
<td class="ltx_td ltx_align_left" id="S4.T5.15.15.15.11.1"><math alttext="29.47" class="ltx_Math" display="inline" id="S4.T5.15.15.15.11.1.m1.1"><semantics id="S4.T5.15.15.15.11.1.m1.1a"><mn id="S4.T5.15.15.15.11.1.m1.1.1" xref="S4.T5.15.15.15.11.1.m1.1.1.cmml">29.47</mn><annotation-xml encoding="MathML-Content" id="S4.T5.15.15.15.11.1.m1.1b"><cn id="S4.T5.15.15.15.11.1.m1.1.1.cmml" type="float" xref="S4.T5.15.15.15.11.1.m1.1.1">29.47</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.15.15.15.11.1.m1.1c">29.47</annotation><annotation encoding="application/x-llamapun" id="S4.T5.15.15.15.11.1.m1.1d">29.47</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T5.16.16.16.12.2"><math alttext="0.872" class="ltx_Math" display="inline" id="S4.T5.16.16.16.12.2.m1.1"><semantics id="S4.T5.16.16.16.12.2.m1.1a"><mn id="S4.T5.16.16.16.12.2.m1.1.1" xref="S4.T5.16.16.16.12.2.m1.1.1.cmml">0.872</mn><annotation-xml encoding="MathML-Content" id="S4.T5.16.16.16.12.2.m1.1b"><cn id="S4.T5.16.16.16.12.2.m1.1.1.cmml" type="float" xref="S4.T5.16.16.16.12.2.m1.1.1">0.872</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.16.16.16.12.2.m1.1c">0.872</annotation><annotation encoding="application/x-llamapun" id="S4.T5.16.16.16.12.2.m1.1d">0.872</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T5.18.18.18.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T5.18.18.18.14.3">CDVD-TSP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib44" title="">44</a>]</cite>
</th>
<td class="ltx_td ltx_align_left" id="S4.T5.17.17.17.13.1"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T5.17.17.17.13.1.1"><math alttext="31.58" class="ltx_Math" display="inline" id="S4.T5.17.17.17.13.1.1.m1.1"><semantics id="S4.T5.17.17.17.13.1.1.m1.1a"><mn id="S4.T5.17.17.17.13.1.1.m1.1.1" xref="S4.T5.17.17.17.13.1.1.m1.1.1.cmml">31.58</mn><annotation-xml encoding="MathML-Content" id="S4.T5.17.17.17.13.1.1.m1.1b"><cn id="S4.T5.17.17.17.13.1.1.m1.1.1.cmml" type="float" xref="S4.T5.17.17.17.13.1.1.m1.1.1">31.58</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.17.17.17.13.1.1.m1.1c">31.58</annotation><annotation encoding="application/x-llamapun" id="S4.T5.17.17.17.13.1.1.m1.1d">31.58</annotation></semantics></math></span></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T5.18.18.18.14.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T5.18.18.18.14.2.1"><math alttext="0.926" class="ltx_Math" display="inline" id="S4.T5.18.18.18.14.2.1.m1.1"><semantics id="S4.T5.18.18.18.14.2.1.m1.1a"><mn id="S4.T5.18.18.18.14.2.1.m1.1.1" xref="S4.T5.18.18.18.14.2.1.m1.1.1.cmml">0.926</mn><annotation-xml encoding="MathML-Content" id="S4.T5.18.18.18.14.2.1.m1.1b"><cn id="S4.T5.18.18.18.14.2.1.m1.1.1.cmml" type="float" xref="S4.T5.18.18.18.14.2.1.m1.1.1">0.926</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.18.18.18.14.2.1.m1.1c">0.926</annotation><annotation encoding="application/x-llamapun" id="S4.T5.18.18.18.14.2.1.m1.1d">0.926</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="S4.T5.20.20.20.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T5.20.20.20.16.3">PVDNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib57" title="">57</a>]</cite>
</th>
<td class="ltx_td ltx_align_left" id="S4.T5.19.19.19.15.1"><math alttext="31.35" class="ltx_Math" display="inline" id="S4.T5.19.19.19.15.1.m1.1"><semantics id="S4.T5.19.19.19.15.1.m1.1a"><mn id="S4.T5.19.19.19.15.1.m1.1.1" xref="S4.T5.19.19.19.15.1.m1.1.1.cmml">31.35</mn><annotation-xml encoding="MathML-Content" id="S4.T5.19.19.19.15.1.m1.1b"><cn id="S4.T5.19.19.19.15.1.m1.1.1.cmml" type="float" xref="S4.T5.19.19.19.15.1.m1.1.1">31.35</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.19.19.19.15.1.m1.1c">31.35</annotation><annotation encoding="application/x-llamapun" id="S4.T5.19.19.19.15.1.m1.1d">31.35</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T5.20.20.20.16.2"><math alttext="0.923" class="ltx_Math" display="inline" id="S4.T5.20.20.20.16.2.m1.1"><semantics id="S4.T5.20.20.20.16.2.m1.1a"><mn id="S4.T5.20.20.20.16.2.m1.1.1" xref="S4.T5.20.20.20.16.2.m1.1.1.cmml">0.923</mn><annotation-xml encoding="MathML-Content" id="S4.T5.20.20.20.16.2.m1.1b"><cn id="S4.T5.20.20.20.16.2.m1.1.1.cmml" type="float" xref="S4.T5.20.20.20.16.2.m1.1.1">0.923</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.20.20.20.16.2.m1.1c">0.923</annotation><annotation encoding="application/x-llamapun" id="S4.T5.20.20.20.16.2.m1.1d">0.923</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T5.22.22.22.18">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T5.22.22.22.18.3">ESTRNN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib83" title="">83</a>]</cite>
</th>
<td class="ltx_td ltx_align_left" id="S4.T5.21.21.21.17.1"><math alttext="31.39" class="ltx_Math" display="inline" id="S4.T5.21.21.21.17.1.m1.1"><semantics id="S4.T5.21.21.21.17.1.m1.1a"><mn id="S4.T5.21.21.21.17.1.m1.1.1" xref="S4.T5.21.21.21.17.1.m1.1.1.cmml">31.39</mn><annotation-xml encoding="MathML-Content" id="S4.T5.21.21.21.17.1.m1.1b"><cn id="S4.T5.21.21.21.17.1.m1.1.1.cmml" type="float" xref="S4.T5.21.21.21.17.1.m1.1.1">31.39</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.21.21.21.17.1.m1.1c">31.39</annotation><annotation encoding="application/x-llamapun" id="S4.T5.21.21.21.17.1.m1.1d">31.39</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T5.22.22.22.18.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T5.22.22.22.18.2.1"><math alttext="0.926" class="ltx_Math" display="inline" id="S4.T5.22.22.22.18.2.1.m1.1"><semantics id="S4.T5.22.22.22.18.2.1.m1.1a"><mn id="S4.T5.22.22.22.18.2.1.m1.1.1" xref="S4.T5.22.22.22.18.2.1.m1.1.1.cmml">0.926</mn><annotation-xml encoding="MathML-Content" id="S4.T5.22.22.22.18.2.1.m1.1b"><cn id="S4.T5.22.22.22.18.2.1.m1.1.1.cmml" type="float" xref="S4.T5.22.22.22.18.2.1.m1.1.1">0.926</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.22.22.22.18.2.1.m1.1c">0.926</annotation><annotation encoding="application/x-llamapun" id="S4.T5.22.22.22.18.2.1.m1.1d">0.926</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="S4.T5.24.24.24.20" style="background-color:#D1E9F6;">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_tt" id="S4.T5.24.24.24.20.3"><span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="S4.T5.24.24.24.20.3.1" style="background-color:#D1E9F6;">turtle</span></th>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_tt" id="S4.T5.23.23.23.19.1"><span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.T5.23.23.23.19.1.1" style="background-color:#D1E9F6;">33.58</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb ltx_border_tt" id="S4.T5.24.24.24.20.2"><span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.T5.24.24.24.20.2.1" style="background-color:#D1E9F6;">0.954</span></td>
</tr>
</tbody>
</table>
</figure>
</span></div>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div class="ltx_inline-block ltx_figure_panel ltx_transformed_outer" id="S4.T5.44" style="width:109.4pt;height:154.4pt;vertical-align:-74.4pt;"><span class="ltx_transformed_inner" style="transform:translate(-13.7pt,10.0pt) scale(0.8,0.8) ;">
<figure class="ltx_figure ltx_minipage ltx_align_middle" id="S4.T5.44.20" style="width:130.1pt;">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Table 4: </span><span class="ltx_text ltx_font_bold" id="S4.T5.44.20.22.1">Synthetic Video Deblurring Results.</span> Quantitative results (PSNR, and SSIM) on the GoPro dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib41" title="">41</a>]</cite> comparing state-of-the-art methods.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T5.44.20.20">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T5.26.2.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S4.T5.26.2.2.2.3"><span class="ltx_text ltx_font_bold" id="S4.T5.26.2.2.2.3.1">Method</span></th>
<td class="ltx_td ltx_align_left ltx_border_tt" id="S4.T5.25.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T5.25.1.1.1.1.1">PSNR<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T5.25.1.1.1.1.1.m1.1"><semantics id="S4.T5.25.1.1.1.1.1.m1.1a"><mo id="S4.T5.25.1.1.1.1.1.m1.1.1" stretchy="false" xref="S4.T5.25.1.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T5.25.1.1.1.1.1.m1.1b"><ci id="S4.T5.25.1.1.1.1.1.m1.1.1.cmml" xref="S4.T5.25.1.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.25.1.1.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T5.25.1.1.1.1.1.m1.1d">↑</annotation></semantics></math></span></td>
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_tt" id="S4.T5.26.2.2.2.2"><span class="ltx_text ltx_font_bold" id="S4.T5.26.2.2.2.2.1">SSIM<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T5.26.2.2.2.2.1.m1.1"><semantics id="S4.T5.26.2.2.2.2.1.m1.1a"><mo id="S4.T5.26.2.2.2.2.1.m1.1.1" stretchy="false" xref="S4.T5.26.2.2.2.2.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T5.26.2.2.2.2.1.m1.1b"><ci id="S4.T5.26.2.2.2.2.1.m1.1.1.cmml" xref="S4.T5.26.2.2.2.2.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.26.2.2.2.2.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T5.26.2.2.2.2.1.m1.1d">↑</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="S4.T5.28.4.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T5.28.4.4.4.3">IFI-RNN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib42" title="">42</a>]</cite>
</th>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T5.27.3.3.3.1"><math alttext="31.05" class="ltx_Math" display="inline" id="S4.T5.27.3.3.3.1.m1.1"><semantics id="S4.T5.27.3.3.3.1.m1.1a"><mn id="S4.T5.27.3.3.3.1.m1.1.1" xref="S4.T5.27.3.3.3.1.m1.1.1.cmml">31.05</mn><annotation-xml encoding="MathML-Content" id="S4.T5.27.3.3.3.1.m1.1b"><cn id="S4.T5.27.3.3.3.1.m1.1.1.cmml" type="float" xref="S4.T5.27.3.3.3.1.m1.1.1">31.05</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.27.3.3.3.1.m1.1c">31.05</annotation><annotation encoding="application/x-llamapun" id="S4.T5.27.3.3.3.1.m1.1d">31.05</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t" id="S4.T5.28.4.4.4.2"><math alttext="0.9110" class="ltx_Math" display="inline" id="S4.T5.28.4.4.4.2.m1.1"><semantics id="S4.T5.28.4.4.4.2.m1.1a"><mn id="S4.T5.28.4.4.4.2.m1.1.1" xref="S4.T5.28.4.4.4.2.m1.1.1.cmml">0.9110</mn><annotation-xml encoding="MathML-Content" id="S4.T5.28.4.4.4.2.m1.1b"><cn id="S4.T5.28.4.4.4.2.m1.1.1.cmml" type="float" xref="S4.T5.28.4.4.4.2.m1.1.1">0.9110</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.28.4.4.4.2.m1.1c">0.9110</annotation><annotation encoding="application/x-llamapun" id="S4.T5.28.4.4.4.2.m1.1d">0.9110</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T5.30.6.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T5.30.6.6.6.3">ESTRNN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib82" title="">82</a>]</cite>
</th>
<td class="ltx_td ltx_align_left" id="S4.T5.29.5.5.5.1"><math alttext="31.07" class="ltx_Math" display="inline" id="S4.T5.29.5.5.5.1.m1.1"><semantics id="S4.T5.29.5.5.5.1.m1.1a"><mn id="S4.T5.29.5.5.5.1.m1.1.1" xref="S4.T5.29.5.5.5.1.m1.1.1.cmml">31.07</mn><annotation-xml encoding="MathML-Content" id="S4.T5.29.5.5.5.1.m1.1b"><cn id="S4.T5.29.5.5.5.1.m1.1.1.cmml" type="float" xref="S4.T5.29.5.5.5.1.m1.1.1">31.07</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.29.5.5.5.1.m1.1c">31.07</annotation><annotation encoding="application/x-llamapun" id="S4.T5.29.5.5.5.1.m1.1d">31.07</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T5.30.6.6.6.2"><math alttext="0.9023" class="ltx_Math" display="inline" id="S4.T5.30.6.6.6.2.m1.1"><semantics id="S4.T5.30.6.6.6.2.m1.1a"><mn id="S4.T5.30.6.6.6.2.m1.1.1" xref="S4.T5.30.6.6.6.2.m1.1.1.cmml">0.9023</mn><annotation-xml encoding="MathML-Content" id="S4.T5.30.6.6.6.2.m1.1b"><cn id="S4.T5.30.6.6.6.2.m1.1.1.cmml" type="float" xref="S4.T5.30.6.6.6.2.m1.1.1">0.9023</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.30.6.6.6.2.m1.1c">0.9023</annotation><annotation encoding="application/x-llamapun" id="S4.T5.30.6.6.6.2.m1.1d">0.9023</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T5.32.8.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T5.32.8.8.8.3">EDVR <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib69" title="">69</a>]</cite>
</th>
<td class="ltx_td ltx_align_left" id="S4.T5.31.7.7.7.1"><math alttext="31.54" class="ltx_Math" display="inline" id="S4.T5.31.7.7.7.1.m1.1"><semantics id="S4.T5.31.7.7.7.1.m1.1a"><mn id="S4.T5.31.7.7.7.1.m1.1.1" xref="S4.T5.31.7.7.7.1.m1.1.1.cmml">31.54</mn><annotation-xml encoding="MathML-Content" id="S4.T5.31.7.7.7.1.m1.1b"><cn id="S4.T5.31.7.7.7.1.m1.1.1.cmml" type="float" xref="S4.T5.31.7.7.7.1.m1.1.1">31.54</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.31.7.7.7.1.m1.1c">31.54</annotation><annotation encoding="application/x-llamapun" id="S4.T5.31.7.7.7.1.m1.1d">31.54</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T5.32.8.8.8.2"><math alttext="0.9260" class="ltx_Math" display="inline" id="S4.T5.32.8.8.8.2.m1.1"><semantics id="S4.T5.32.8.8.8.2.m1.1a"><mn id="S4.T5.32.8.8.8.2.m1.1.1" xref="S4.T5.32.8.8.8.2.m1.1.1.cmml">0.9260</mn><annotation-xml encoding="MathML-Content" id="S4.T5.32.8.8.8.2.m1.1b"><cn id="S4.T5.32.8.8.8.2.m1.1.1.cmml" type="float" xref="S4.T5.32.8.8.8.2.m1.1.1">0.9260</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.32.8.8.8.2.m1.1c">0.9260</annotation><annotation encoding="application/x-llamapun" id="S4.T5.32.8.8.8.2.m1.1d">0.9260</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T5.34.10.10.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T5.34.10.10.10.3">TSP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib44" title="">44</a>]</cite>
</th>
<td class="ltx_td ltx_align_left" id="S4.T5.33.9.9.9.1"><math alttext="31.67" class="ltx_Math" display="inline" id="S4.T5.33.9.9.9.1.m1.1"><semantics id="S4.T5.33.9.9.9.1.m1.1a"><mn id="S4.T5.33.9.9.9.1.m1.1.1" xref="S4.T5.33.9.9.9.1.m1.1.1.cmml">31.67</mn><annotation-xml encoding="MathML-Content" id="S4.T5.33.9.9.9.1.m1.1b"><cn id="S4.T5.33.9.9.9.1.m1.1.1.cmml" type="float" xref="S4.T5.33.9.9.9.1.m1.1.1">31.67</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.33.9.9.9.1.m1.1c">31.67</annotation><annotation encoding="application/x-llamapun" id="S4.T5.33.9.9.9.1.m1.1d">31.67</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T5.34.10.10.10.2"><math alttext="0.9280" class="ltx_Math" display="inline" id="S4.T5.34.10.10.10.2.m1.1"><semantics id="S4.T5.34.10.10.10.2.m1.1a"><mn id="S4.T5.34.10.10.10.2.m1.1.1" xref="S4.T5.34.10.10.10.2.m1.1.1.cmml">0.9280</mn><annotation-xml encoding="MathML-Content" id="S4.T5.34.10.10.10.2.m1.1b"><cn id="S4.T5.34.10.10.10.2.m1.1.1.cmml" type="float" xref="S4.T5.34.10.10.10.2.m1.1.1">0.9280</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.34.10.10.10.2.m1.1c">0.9280</annotation><annotation encoding="application/x-llamapun" id="S4.T5.34.10.10.10.2.m1.1d">0.9280</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T5.36.12.12.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T5.36.12.12.12.3">GSTA <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib59" title="">59</a>]</cite>
</th>
<td class="ltx_td ltx_align_left" id="S4.T5.35.11.11.11.1"><math alttext="32.10" class="ltx_Math" display="inline" id="S4.T5.35.11.11.11.1.m1.1"><semantics id="S4.T5.35.11.11.11.1.m1.1a"><mn id="S4.T5.35.11.11.11.1.m1.1.1" xref="S4.T5.35.11.11.11.1.m1.1.1.cmml">32.10</mn><annotation-xml encoding="MathML-Content" id="S4.T5.35.11.11.11.1.m1.1b"><cn id="S4.T5.35.11.11.11.1.m1.1.1.cmml" type="float" xref="S4.T5.35.11.11.11.1.m1.1.1">32.10</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.35.11.11.11.1.m1.1c">32.10</annotation><annotation encoding="application/x-llamapun" id="S4.T5.35.11.11.11.1.m1.1d">32.10</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T5.36.12.12.12.2"><math alttext="0.9600" class="ltx_Math" display="inline" id="S4.T5.36.12.12.12.2.m1.1"><semantics id="S4.T5.36.12.12.12.2.m1.1a"><mn id="S4.T5.36.12.12.12.2.m1.1.1" xref="S4.T5.36.12.12.12.2.m1.1.1.cmml">0.9600</mn><annotation-xml encoding="MathML-Content" id="S4.T5.36.12.12.12.2.m1.1b"><cn id="S4.T5.36.12.12.12.2.m1.1.1.cmml" type="float" xref="S4.T5.36.12.12.12.2.m1.1.1">0.9600</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.36.12.12.12.2.m1.1c">0.9600</annotation><annotation encoding="application/x-llamapun" id="S4.T5.36.12.12.12.2.m1.1d">0.9600</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T5.38.14.14.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T5.38.14.14.14.3">FGST <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib36" title="">36</a>]</cite>
</th>
<td class="ltx_td ltx_align_left" id="S4.T5.37.13.13.13.1"><math alttext="32.90" class="ltx_Math" display="inline" id="S4.T5.37.13.13.13.1.m1.1"><semantics id="S4.T5.37.13.13.13.1.m1.1a"><mn id="S4.T5.37.13.13.13.1.m1.1.1" xref="S4.T5.37.13.13.13.1.m1.1.1.cmml">32.90</mn><annotation-xml encoding="MathML-Content" id="S4.T5.37.13.13.13.1.m1.1b"><cn id="S4.T5.37.13.13.13.1.m1.1.1.cmml" type="float" xref="S4.T5.37.13.13.13.1.m1.1.1">32.90</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.37.13.13.13.1.m1.1c">32.90</annotation><annotation encoding="application/x-llamapun" id="S4.T5.37.13.13.13.1.m1.1d">32.90</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T5.38.14.14.14.2"><math alttext="0.9610" class="ltx_Math" display="inline" id="S4.T5.38.14.14.14.2.m1.1"><semantics id="S4.T5.38.14.14.14.2.m1.1a"><mn id="S4.T5.38.14.14.14.2.m1.1.1" xref="S4.T5.38.14.14.14.2.m1.1.1.cmml">0.9610</mn><annotation-xml encoding="MathML-Content" id="S4.T5.38.14.14.14.2.m1.1b"><cn id="S4.T5.38.14.14.14.2.m1.1.1.cmml" type="float" xref="S4.T5.38.14.14.14.2.m1.1.1">0.9610</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.38.14.14.14.2.m1.1c">0.9610</annotation><annotation encoding="application/x-llamapun" id="S4.T5.38.14.14.14.2.m1.1d">0.9610</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T5.40.16.16.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T5.40.16.16.16.3">BasicVSR++ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib7" title="">7</a>]</cite>
</th>
<td class="ltx_td ltx_align_left" id="S4.T5.39.15.15.15.1"><math alttext="34.01" class="ltx_Math" display="inline" id="S4.T5.39.15.15.15.1.m1.1"><semantics id="S4.T5.39.15.15.15.1.m1.1a"><mn id="S4.T5.39.15.15.15.1.m1.1.1" xref="S4.T5.39.15.15.15.1.m1.1.1.cmml">34.01</mn><annotation-xml encoding="MathML-Content" id="S4.T5.39.15.15.15.1.m1.1b"><cn id="S4.T5.39.15.15.15.1.m1.1.1.cmml" type="float" xref="S4.T5.39.15.15.15.1.m1.1.1">34.01</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.39.15.15.15.1.m1.1c">34.01</annotation><annotation encoding="application/x-llamapun" id="S4.T5.39.15.15.15.1.m1.1d">34.01</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T5.40.16.16.16.2"><math alttext="0.9520" class="ltx_Math" display="inline" id="S4.T5.40.16.16.16.2.m1.1"><semantics id="S4.T5.40.16.16.16.2.m1.1a"><mn id="S4.T5.40.16.16.16.2.m1.1.1" xref="S4.T5.40.16.16.16.2.m1.1.1.cmml">0.9520</mn><annotation-xml encoding="MathML-Content" id="S4.T5.40.16.16.16.2.m1.1b"><cn id="S4.T5.40.16.16.16.2.m1.1.1.cmml" type="float" xref="S4.T5.40.16.16.16.2.m1.1.1">0.9520</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.40.16.16.16.2.m1.1c">0.9520</annotation><annotation encoding="application/x-llamapun" id="S4.T5.40.16.16.16.2.m1.1d">0.9520</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T5.42.18.18.18">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T5.42.18.18.18.3">DSTNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib45" title="">45</a>]</cite>
</th>
<td class="ltx_td ltx_align_left" id="S4.T5.41.17.17.17.1"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T5.41.17.17.17.1.1"><math alttext="34.16" class="ltx_Math" display="inline" id="S4.T5.41.17.17.17.1.1.m1.1"><semantics id="S4.T5.41.17.17.17.1.1.m1.1a"><mn id="S4.T5.41.17.17.17.1.1.m1.1.1" xref="S4.T5.41.17.17.17.1.1.m1.1.1.cmml">34.16</mn><annotation-xml encoding="MathML-Content" id="S4.T5.41.17.17.17.1.1.m1.1b"><cn id="S4.T5.41.17.17.17.1.1.m1.1.1.cmml" type="float" xref="S4.T5.41.17.17.17.1.1.m1.1.1">34.16</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.41.17.17.17.1.1.m1.1c">34.16</annotation><annotation encoding="application/x-llamapun" id="S4.T5.41.17.17.17.1.1.m1.1d">34.16</annotation></semantics></math></span></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T5.42.18.18.18.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T5.42.18.18.18.2.1"><math alttext="0.9679" class="ltx_Math" display="inline" id="S4.T5.42.18.18.18.2.1.m1.1"><semantics id="S4.T5.42.18.18.18.2.1.m1.1a"><mn id="S4.T5.42.18.18.18.2.1.m1.1.1" xref="S4.T5.42.18.18.18.2.1.m1.1.1.cmml">0.9679</mn><annotation-xml encoding="MathML-Content" id="S4.T5.42.18.18.18.2.1.m1.1b"><cn id="S4.T5.42.18.18.18.2.1.m1.1.1.cmml" type="float" xref="S4.T5.42.18.18.18.2.1.m1.1.1">0.9679</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.42.18.18.18.2.1.m1.1c">0.9679</annotation><annotation encoding="application/x-llamapun" id="S4.T5.42.18.18.18.2.1.m1.1d">0.9679</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="S4.T5.44.20.20.20" style="background-color:#D1E9F6;">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_tt" id="S4.T5.44.20.20.20.3"><span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="S4.T5.44.20.20.20.3.1" style="background-color:#D1E9F6;">turtle</span></th>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_tt" id="S4.T5.43.19.19.19.1"><span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.T5.43.19.19.19.1.1" style="background-color:#D1E9F6;">34.50</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb ltx_border_tt" id="S4.T5.44.20.20.20.2"><span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.T5.44.20.20.20.2.1" style="background-color:#D1E9F6;">0.9720</span></td>
</tr>
</tbody>
</table>
</figure>
</span></div>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div class="ltx_inline-block ltx_figure_panel ltx_transformed_outer" id="S4.T5.66" style="width:144.1pt;height:164.8pt;vertical-align:-79.6pt;"><span class="ltx_transformed_inner" style="transform:translate(-18.0pt,10.6pt) scale(0.8,0.8) ;">
<figure class="ltx_figure ltx_minipage ltx_align_middle" id="S4.T5.66.22" style="width:173.4pt;">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Table 5: </span><span class="ltx_text ltx_font_bold" id="S4.T5.66.22.24.1">Video Raindrop and Rain Streak Removal.</span> Quantitative results (PSNR, and SSIM) on the VRDS dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib71" title="">71</a>]</cite> comparing state-of-the-art methods.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T5.66.22.22">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T5.46.2.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S4.T5.46.2.2.2.3"><span class="ltx_text ltx_font_bold" id="S4.T5.46.2.2.2.3.1">Method</span></th>
<td class="ltx_td ltx_align_left ltx_border_tt" id="S4.T5.45.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T5.45.1.1.1.1.1">PSNR<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T5.45.1.1.1.1.1.m1.1"><semantics id="S4.T5.45.1.1.1.1.1.m1.1a"><mo id="S4.T5.45.1.1.1.1.1.m1.1.1" stretchy="false" xref="S4.T5.45.1.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T5.45.1.1.1.1.1.m1.1b"><ci id="S4.T5.45.1.1.1.1.1.m1.1.1.cmml" xref="S4.T5.45.1.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.45.1.1.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T5.45.1.1.1.1.1.m1.1d">↑</annotation></semantics></math></span></td>
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_tt" id="S4.T5.46.2.2.2.2"><span class="ltx_text ltx_font_bold" id="S4.T5.46.2.2.2.2.1">SSIM<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T5.46.2.2.2.2.1.m1.1"><semantics id="S4.T5.46.2.2.2.2.1.m1.1a"><mo id="S4.T5.46.2.2.2.2.1.m1.1.1" stretchy="false" xref="S4.T5.46.2.2.2.2.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T5.46.2.2.2.2.1.m1.1b"><ci id="S4.T5.46.2.2.2.2.1.m1.1.1.cmml" xref="S4.T5.46.2.2.2.2.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.46.2.2.2.2.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T5.46.2.2.2.2.1.m1.1d">↑</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="S4.T5.48.4.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T5.48.4.4.4.3">S2VD <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib78" title="">78</a>]</cite>
</th>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T5.47.3.3.3.1"><math alttext="18.95" class="ltx_Math" display="inline" id="S4.T5.47.3.3.3.1.m1.1"><semantics id="S4.T5.47.3.3.3.1.m1.1a"><mn id="S4.T5.47.3.3.3.1.m1.1.1" xref="S4.T5.47.3.3.3.1.m1.1.1.cmml">18.95</mn><annotation-xml encoding="MathML-Content" id="S4.T5.47.3.3.3.1.m1.1b"><cn id="S4.T5.47.3.3.3.1.m1.1.1.cmml" type="float" xref="S4.T5.47.3.3.3.1.m1.1.1">18.95</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.47.3.3.3.1.m1.1c">18.95</annotation><annotation encoding="application/x-llamapun" id="S4.T5.47.3.3.3.1.m1.1d">18.95</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t" id="S4.T5.48.4.4.4.2"><math alttext="0.6630" class="ltx_Math" display="inline" id="S4.T5.48.4.4.4.2.m1.1"><semantics id="S4.T5.48.4.4.4.2.m1.1a"><mn id="S4.T5.48.4.4.4.2.m1.1.1" xref="S4.T5.48.4.4.4.2.m1.1.1.cmml">0.6630</mn><annotation-xml encoding="MathML-Content" id="S4.T5.48.4.4.4.2.m1.1b"><cn id="S4.T5.48.4.4.4.2.m1.1.1.cmml" type="float" xref="S4.T5.48.4.4.4.2.m1.1.1">0.6630</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.48.4.4.4.2.m1.1c">0.6630</annotation><annotation encoding="application/x-llamapun" id="S4.T5.48.4.4.4.2.m1.1d">0.6630</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T5.50.6.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T5.50.6.6.6.3">EDVR <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib69" title="">69</a>]</cite>
</th>
<td class="ltx_td ltx_align_left" id="S4.T5.49.5.5.5.1"><math alttext="19.19" class="ltx_Math" display="inline" id="S4.T5.49.5.5.5.1.m1.1"><semantics id="S4.T5.49.5.5.5.1.m1.1a"><mn id="S4.T5.49.5.5.5.1.m1.1.1" xref="S4.T5.49.5.5.5.1.m1.1.1.cmml">19.19</mn><annotation-xml encoding="MathML-Content" id="S4.T5.49.5.5.5.1.m1.1b"><cn id="S4.T5.49.5.5.5.1.m1.1.1.cmml" type="float" xref="S4.T5.49.5.5.5.1.m1.1.1">19.19</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.49.5.5.5.1.m1.1c">19.19</annotation><annotation encoding="application/x-llamapun" id="S4.T5.49.5.5.5.1.m1.1d">19.19</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T5.50.6.6.6.2"><math alttext="0.6363" class="ltx_Math" display="inline" id="S4.T5.50.6.6.6.2.m1.1"><semantics id="S4.T5.50.6.6.6.2.m1.1a"><mn id="S4.T5.50.6.6.6.2.m1.1.1" xref="S4.T5.50.6.6.6.2.m1.1.1.cmml">0.6363</mn><annotation-xml encoding="MathML-Content" id="S4.T5.50.6.6.6.2.m1.1b"><cn id="S4.T5.50.6.6.6.2.m1.1.1.cmml" type="float" xref="S4.T5.50.6.6.6.2.m1.1.1">0.6363</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.50.6.6.6.2.m1.1c">0.6363</annotation><annotation encoding="application/x-llamapun" id="S4.T5.50.6.6.6.2.m1.1d">0.6363</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T5.52.8.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T5.52.8.8.8.3">BasicVSR <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib6" title="">6</a>]</cite>
</th>
<td class="ltx_td ltx_align_left" id="S4.T5.51.7.7.7.1"><math alttext="28.35" class="ltx_Math" display="inline" id="S4.T5.51.7.7.7.1.m1.1"><semantics id="S4.T5.51.7.7.7.1.m1.1a"><mn id="S4.T5.51.7.7.7.1.m1.1.1" xref="S4.T5.51.7.7.7.1.m1.1.1.cmml">28.35</mn><annotation-xml encoding="MathML-Content" id="S4.T5.51.7.7.7.1.m1.1b"><cn id="S4.T5.51.7.7.7.1.m1.1.1.cmml" type="float" xref="S4.T5.51.7.7.7.1.m1.1.1">28.35</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.51.7.7.7.1.m1.1c">28.35</annotation><annotation encoding="application/x-llamapun" id="S4.T5.51.7.7.7.1.m1.1d">28.35</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T5.52.8.8.8.2"><math alttext="0.8990" class="ltx_Math" display="inline" id="S4.T5.52.8.8.8.2.m1.1"><semantics id="S4.T5.52.8.8.8.2.m1.1a"><mn id="S4.T5.52.8.8.8.2.m1.1.1" xref="S4.T5.52.8.8.8.2.m1.1.1.cmml">0.8990</mn><annotation-xml encoding="MathML-Content" id="S4.T5.52.8.8.8.2.m1.1b"><cn id="S4.T5.52.8.8.8.2.m1.1.1.cmml" type="float" xref="S4.T5.52.8.8.8.2.m1.1.1">0.8990</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.52.8.8.8.2.m1.1c">0.8990</annotation><annotation encoding="application/x-llamapun" id="S4.T5.52.8.8.8.2.m1.1d">0.8990</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T5.54.10.10.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T5.54.10.10.10.3">VRT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib34" title="">34</a>]</cite>
</th>
<td class="ltx_td ltx_align_left" id="S4.T5.53.9.9.9.1"><math alttext="27.77" class="ltx_Math" display="inline" id="S4.T5.53.9.9.9.1.m1.1"><semantics id="S4.T5.53.9.9.9.1.m1.1a"><mn id="S4.T5.53.9.9.9.1.m1.1.1" xref="S4.T5.53.9.9.9.1.m1.1.1.cmml">27.77</mn><annotation-xml encoding="MathML-Content" id="S4.T5.53.9.9.9.1.m1.1b"><cn id="S4.T5.53.9.9.9.1.m1.1.1.cmml" type="float" xref="S4.T5.53.9.9.9.1.m1.1.1">27.77</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.53.9.9.9.1.m1.1c">27.77</annotation><annotation encoding="application/x-llamapun" id="S4.T5.53.9.9.9.1.m1.1d">27.77</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T5.54.10.10.10.2"><math alttext="0.8856" class="ltx_Math" display="inline" id="S4.T5.54.10.10.10.2.m1.1"><semantics id="S4.T5.54.10.10.10.2.m1.1a"><mn id="S4.T5.54.10.10.10.2.m1.1.1" xref="S4.T5.54.10.10.10.2.m1.1.1.cmml">0.8856</mn><annotation-xml encoding="MathML-Content" id="S4.T5.54.10.10.10.2.m1.1b"><cn id="S4.T5.54.10.10.10.2.m1.1.1.cmml" type="float" xref="S4.T5.54.10.10.10.2.m1.1.1">0.8856</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.54.10.10.10.2.m1.1c">0.8856</annotation><annotation encoding="application/x-llamapun" id="S4.T5.54.10.10.10.2.m1.1d">0.8856</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T5.56.12.12.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T5.56.12.12.12.3">TTVSR <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib37" title="">37</a>]</cite>
</th>
<td class="ltx_td ltx_align_left" id="S4.T5.55.11.11.11.1"><math alttext="28.05" class="ltx_Math" display="inline" id="S4.T5.55.11.11.11.1.m1.1"><semantics id="S4.T5.55.11.11.11.1.m1.1a"><mn id="S4.T5.55.11.11.11.1.m1.1.1" xref="S4.T5.55.11.11.11.1.m1.1.1.cmml">28.05</mn><annotation-xml encoding="MathML-Content" id="S4.T5.55.11.11.11.1.m1.1b"><cn id="S4.T5.55.11.11.11.1.m1.1.1.cmml" type="float" xref="S4.T5.55.11.11.11.1.m1.1.1">28.05</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.55.11.11.11.1.m1.1c">28.05</annotation><annotation encoding="application/x-llamapun" id="S4.T5.55.11.11.11.1.m1.1d">28.05</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T5.56.12.12.12.2"><math alttext="0.8998" class="ltx_Math" display="inline" id="S4.T5.56.12.12.12.2.m1.1"><semantics id="S4.T5.56.12.12.12.2.m1.1a"><mn id="S4.T5.56.12.12.12.2.m1.1.1" xref="S4.T5.56.12.12.12.2.m1.1.1.cmml">0.8998</mn><annotation-xml encoding="MathML-Content" id="S4.T5.56.12.12.12.2.m1.1b"><cn id="S4.T5.56.12.12.12.2.m1.1.1.cmml" type="float" xref="S4.T5.56.12.12.12.2.m1.1.1">0.8998</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.56.12.12.12.2.m1.1c">0.8998</annotation><annotation encoding="application/x-llamapun" id="S4.T5.56.12.12.12.2.m1.1d">0.8998</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T5.58.14.14.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T5.58.14.14.14.3">RVRT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib33" title="">33</a>]</cite>
</th>
<td class="ltx_td ltx_align_left" id="S4.T5.57.13.13.13.1"><math alttext="28.24" class="ltx_Math" display="inline" id="S4.T5.57.13.13.13.1.m1.1"><semantics id="S4.T5.57.13.13.13.1.m1.1a"><mn id="S4.T5.57.13.13.13.1.m1.1.1" xref="S4.T5.57.13.13.13.1.m1.1.1.cmml">28.24</mn><annotation-xml encoding="MathML-Content" id="S4.T5.57.13.13.13.1.m1.1b"><cn id="S4.T5.57.13.13.13.1.m1.1.1.cmml" type="float" xref="S4.T5.57.13.13.13.1.m1.1.1">28.24</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.57.13.13.13.1.m1.1c">28.24</annotation><annotation encoding="application/x-llamapun" id="S4.T5.57.13.13.13.1.m1.1d">28.24</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T5.58.14.14.14.2"><math alttext="0.8857" class="ltx_Math" display="inline" id="S4.T5.58.14.14.14.2.m1.1"><semantics id="S4.T5.58.14.14.14.2.m1.1a"><mn id="S4.T5.58.14.14.14.2.m1.1.1" xref="S4.T5.58.14.14.14.2.m1.1.1.cmml">0.8857</mn><annotation-xml encoding="MathML-Content" id="S4.T5.58.14.14.14.2.m1.1b"><cn id="S4.T5.58.14.14.14.2.m1.1.1.cmml" type="float" xref="S4.T5.58.14.14.14.2.m1.1.1">0.8857</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.58.14.14.14.2.m1.1c">0.8857</annotation><annotation encoding="application/x-llamapun" id="S4.T5.58.14.14.14.2.m1.1d">0.8857</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T5.60.16.16.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T5.60.16.16.16.3">RDDNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib68" title="">68</a>]</cite>
</th>
<td class="ltx_td ltx_align_left" id="S4.T5.59.15.15.15.1"><math alttext="28.38" class="ltx_Math" display="inline" id="S4.T5.59.15.15.15.1.m1.1"><semantics id="S4.T5.59.15.15.15.1.m1.1a"><mn id="S4.T5.59.15.15.15.1.m1.1.1" xref="S4.T5.59.15.15.15.1.m1.1.1.cmml">28.38</mn><annotation-xml encoding="MathML-Content" id="S4.T5.59.15.15.15.1.m1.1b"><cn id="S4.T5.59.15.15.15.1.m1.1.1.cmml" type="float" xref="S4.T5.59.15.15.15.1.m1.1.1">28.38</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.59.15.15.15.1.m1.1c">28.38</annotation><annotation encoding="application/x-llamapun" id="S4.T5.59.15.15.15.1.m1.1d">28.38</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T5.60.16.16.16.2"><math alttext="0.9096" class="ltx_Math" display="inline" id="S4.T5.60.16.16.16.2.m1.1"><semantics id="S4.T5.60.16.16.16.2.m1.1a"><mn id="S4.T5.60.16.16.16.2.m1.1.1" xref="S4.T5.60.16.16.16.2.m1.1.1.cmml">0.9096</mn><annotation-xml encoding="MathML-Content" id="S4.T5.60.16.16.16.2.m1.1b"><cn id="S4.T5.60.16.16.16.2.m1.1.1.cmml" type="float" xref="S4.T5.60.16.16.16.2.m1.1.1">0.9096</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.60.16.16.16.2.m1.1c">0.9096</annotation><annotation encoding="application/x-llamapun" id="S4.T5.60.16.16.16.2.m1.1d">0.9096</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T5.62.18.18.18">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T5.62.18.18.18.3">BasicVSR++ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib7" title="">7</a>]</cite>
</th>
<td class="ltx_td ltx_align_left" id="S4.T5.61.17.17.17.1"><math alttext="29.75" class="ltx_Math" display="inline" id="S4.T5.61.17.17.17.1.m1.1"><semantics id="S4.T5.61.17.17.17.1.m1.1a"><mn id="S4.T5.61.17.17.17.1.m1.1.1" xref="S4.T5.61.17.17.17.1.m1.1.1.cmml">29.75</mn><annotation-xml encoding="MathML-Content" id="S4.T5.61.17.17.17.1.m1.1b"><cn id="S4.T5.61.17.17.17.1.m1.1.1.cmml" type="float" xref="S4.T5.61.17.17.17.1.m1.1.1">29.75</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.61.17.17.17.1.m1.1c">29.75</annotation><annotation encoding="application/x-llamapun" id="S4.T5.61.17.17.17.1.m1.1d">29.75</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T5.62.18.18.18.2"><math alttext="0.9171" class="ltx_Math" display="inline" id="S4.T5.62.18.18.18.2.m1.1"><semantics id="S4.T5.62.18.18.18.2.m1.1a"><mn id="S4.T5.62.18.18.18.2.m1.1.1" xref="S4.T5.62.18.18.18.2.m1.1.1.cmml">0.9171</mn><annotation-xml encoding="MathML-Content" id="S4.T5.62.18.18.18.2.m1.1b"><cn id="S4.T5.62.18.18.18.2.m1.1.1.cmml" type="float" xref="S4.T5.62.18.18.18.2.m1.1.1">0.9171</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.62.18.18.18.2.m1.1c">0.9171</annotation><annotation encoding="application/x-llamapun" id="S4.T5.62.18.18.18.2.m1.1d">0.9171</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T5.64.20.20.20">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T5.64.20.20.20.3">ViMPNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib71" title="">71</a>]</cite>
</th>
<td class="ltx_td ltx_align_left" id="S4.T5.63.19.19.19.1"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T5.63.19.19.19.1.1"><math alttext="31.02" class="ltx_Math" display="inline" id="S4.T5.63.19.19.19.1.1.m1.1"><semantics id="S4.T5.63.19.19.19.1.1.m1.1a"><mn id="S4.T5.63.19.19.19.1.1.m1.1.1" xref="S4.T5.63.19.19.19.1.1.m1.1.1.cmml">31.02</mn><annotation-xml encoding="MathML-Content" id="S4.T5.63.19.19.19.1.1.m1.1b"><cn id="S4.T5.63.19.19.19.1.1.m1.1.1.cmml" type="float" xref="S4.T5.63.19.19.19.1.1.m1.1.1">31.02</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.63.19.19.19.1.1.m1.1c">31.02</annotation><annotation encoding="application/x-llamapun" id="S4.T5.63.19.19.19.1.1.m1.1d">31.02</annotation></semantics></math></span></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T5.64.20.20.20.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T5.64.20.20.20.2.1"><math alttext="0.9283" class="ltx_Math" display="inline" id="S4.T5.64.20.20.20.2.1.m1.1"><semantics id="S4.T5.64.20.20.20.2.1.m1.1a"><mn id="S4.T5.64.20.20.20.2.1.m1.1.1" xref="S4.T5.64.20.20.20.2.1.m1.1.1.cmml">0.9283</mn><annotation-xml encoding="MathML-Content" id="S4.T5.64.20.20.20.2.1.m1.1b"><cn id="S4.T5.64.20.20.20.2.1.m1.1.1.cmml" type="float" xref="S4.T5.64.20.20.20.2.1.m1.1.1">0.9283</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.64.20.20.20.2.1.m1.1c">0.9283</annotation><annotation encoding="application/x-llamapun" id="S4.T5.64.20.20.20.2.1.m1.1d">0.9283</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="S4.T5.66.22.22.22" style="background-color:#D1E9F6;">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_tt" id="S4.T5.66.22.22.22.3"><span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="S4.T5.66.22.22.22.3.1" style="background-color:#D1E9F6;">turtle</span></th>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_tt" id="S4.T5.65.21.21.21.1"><span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.T5.65.21.21.21.1.1" style="background-color:#D1E9F6;">32.01</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb ltx_border_tt" id="S4.T5.66.22.22.22.2"><span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.T5.66.22.22.22.2.1" style="background-color:#D1E9F6;">0.9590</span></td>
</tr>
</tbody>
</table>
</figure>
</span></div>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Video Desnowing</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.5">Realistic Video Desnowing Dataset (RVSD) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib10" title="">10</a>]</cite> is a video-first desnowing dataset simulating realistic physical characteristics of snow and haze. The dataset comprises a variety of scenes, and the videos are captured from various angles to capture realistic scenes with different intensities. In total, the dataset includes <math alttext="110" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.1"><semantics id="S4.SS2.p1.1.m1.1a"><mn id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">110</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><cn id="S4.SS2.p1.1.m1.1.1.cmml" type="integer" xref="S4.SS2.p1.1.m1.1.1">110</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">110</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.m1.1d">110</annotation></semantics></math> videos, of which <math alttext="80" class="ltx_Math" display="inline" id="S4.SS2.p1.2.m2.1"><semantics id="S4.SS2.p1.2.m2.1a"><mn id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">80</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><cn id="S4.SS2.p1.2.m2.1.1.cmml" type="integer" xref="S4.SS2.p1.2.m2.1.1">80</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">80</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.2.m2.1d">80</annotation></semantics></math> are used for training, while <math alttext="30" class="ltx_Math" display="inline" id="S4.SS2.p1.3.m3.1"><semantics id="S4.SS2.p1.3.m3.1a"><mn id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml">30</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><cn id="S4.SS2.p1.3.m3.1.1.cmml" type="integer" xref="S4.SS2.p1.3.m3.1.1">30</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">30</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.3.m3.1d">30</annotation></semantics></math> are held-out test set to measure desnowing performance. We follow the proposed train/test split in the original work <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib10" title="">10</a>]</cite> and train <span class="ltx_text ltx_font_smallcaps" id="S4.SS2.p1.5.2">turtle</span> on the video desnowing dataset. Our scores, <span class="ltx_text" id="S4.SS2.p1.4.1"><math alttext="26.02" class="ltx_Math" display="inline" id="S4.SS2.p1.4.1.m1.1" style="background-color:#D1E9F6;"><semantics id="S4.SS2.p1.4.1.m1.1a"><mn id="S4.SS2.p1.4.1.m1.1.1" mathbackground="#D1E9F6" xref="S4.SS2.p1.4.1.m1.1.1.cmml">26.02</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.1.m1.1b"><cn id="S4.SS2.p1.4.1.m1.1.1.cmml" type="float" xref="S4.SS2.p1.4.1.m1.1.1">26.02</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.1.m1.1c">26.02</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.4.1.m1.1d">26.02</annotation></semantics></math></span> dB in PSNR, are reported in <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S3.T2" title="In Frame History Router (𝜓). ‣ 3.2 Causal History Model ‣ 3 Methodology ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">table</span> <span class="ltx_text ltx_ref_tag">2</span></a>, and compared to previous methods, <span class="ltx_text ltx_font_smallcaps" id="S4.SS2.p1.5.3">turtle</span> significantly improves the performance by <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.SS2.p1.5.4" style="color:#007F73;">+0.96</span> dB in PSNR. Notably, <span class="ltx_text ltx_font_smallcaps" id="S4.SS2.p1.5.5">turtle</span> is prior-free, unlike the previous best result SVDNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib10" title="">10</a>]</cite>, which exploits snow-type priors. We present visual results in <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S3.F3" title="In Frame History Router (𝜓). ‣ 3.2 Causal History Model ‣ 3 Methodology ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">3</span></a>, and in <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A3.F11" title="In Appendix C Relationship to State Space Models ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">11</span></a> comparing <span class="ltx_text ltx_font_smallcaps" id="S4.SS2.p1.5.6">turtle</span> to SVDNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib10" title="">10</a>]</cite>. Our method not only removes snowflakes but also removes haze, and the restored frame is visually pleasing.</p>
</div>
<figure class="ltx_figure" id="S4.F4">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.F4.1" style="width:422.4pt;height:134.2pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-6.5pt,2.1pt) scale(0.97,0.97) ;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="263" id="S4.F4.1.g1" src="x4.png" width="830"/>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span><span class="ltx_text ltx_font_bold" id="S4.F4.8.1">Visual Results on Video Deblurring and Raindrops and Rain Streaks Removal.</span> Qualitative results on video deblurring on the GoPro dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib41" title="">41</a>]</cite> are in the top row. Our method, <span class="ltx_text ltx_font_smallcaps" id="S4.F4.9.2">turtle</span>, restores the frames without any artifacts (see the <span class="ltx_text" id="S4.F4.10.3" style="color:#FF0000;">number plate</span>) unlike DSTNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib45" title="">45</a>]</cite>. On video raindrops and rain streaks removal task, we compare our method with the best method in literature ViMPNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib71" title="">71</a>]</cite>. Notice how the frame restored by ViMPNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib71" title="">71</a>]</cite> has artifacts (see <span class="ltx_text" id="S4.F4.11.4" style="color:#FF0000;">tree region</span>, and <span class="ltx_text" id="S4.F4.12.5" style="color:#FF0000;">the railing gate</span>), while <span class="ltx_text ltx_font_smallcaps" id="S4.F4.13.6">turtle</span>’s output is free of unwanted artifacts.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Real Video Deblurring</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.10">The work done in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib83" title="">83</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib82" title="">82</a>]</cite> introduced a real-world deblurring dataset (BSD) using the Beam-Splitter apparatus. The dataset introduced contains three different variants depending on the blur intensity settings. Each of the three variants has a total of <math alttext="11,000" class="ltx_Math" display="inline" id="S4.SS3.p1.1.m1.2"><semantics id="S4.SS3.p1.1.m1.2a"><mrow id="S4.SS3.p1.1.m1.2.3.2" xref="S4.SS3.p1.1.m1.2.3.1.cmml"><mn id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml">11</mn><mo id="S4.SS3.p1.1.m1.2.3.2.1" xref="S4.SS3.p1.1.m1.2.3.1.cmml">,</mo><mn id="S4.SS3.p1.1.m1.2.2" xref="S4.SS3.p1.1.m1.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.2b"><list id="S4.SS3.p1.1.m1.2.3.1.cmml" xref="S4.SS3.p1.1.m1.2.3.2"><cn id="S4.SS3.p1.1.m1.1.1.cmml" type="integer" xref="S4.SS3.p1.1.m1.1.1">11</cn><cn id="S4.SS3.p1.1.m1.2.2.cmml" type="integer" xref="S4.SS3.p1.1.m1.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.2c">11,000</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.1.m1.2d">11 , 000</annotation></semantics></math> blurry/sharp pairs with a resolution of <math alttext="640\times 480" class="ltx_Math" display="inline" id="S4.SS3.p1.2.m2.1"><semantics id="S4.SS3.p1.2.m2.1a"><mrow id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml"><mn id="S4.SS3.p1.2.m2.1.1.2" xref="S4.SS3.p1.2.m2.1.1.2.cmml">640</mn><mo id="S4.SS3.p1.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p1.2.m2.1.1.1.cmml">×</mo><mn id="S4.SS3.p1.2.m2.1.1.3" xref="S4.SS3.p1.2.m2.1.1.3.cmml">480</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><apply id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1"><times id="S4.SS3.p1.2.m2.1.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1.1"></times><cn id="S4.SS3.p1.2.m2.1.1.2.cmml" type="integer" xref="S4.SS3.p1.2.m2.1.1.2">640</cn><cn id="S4.SS3.p1.2.m2.1.1.3.cmml" type="integer" xref="S4.SS3.p1.2.m2.1.1.3">480</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">640\times 480</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.2.m2.1d">640 × 480</annotation></semantics></math>. We employ the variant of BSD with the most blur exposure time, i.e., <math alttext="3" class="ltx_Math" display="inline" id="S4.SS3.p1.3.m3.1"><semantics id="S4.SS3.p1.3.m3.1a"><mn id="S4.SS3.p1.3.m3.1.1" xref="S4.SS3.p1.3.m3.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.1b"><cn id="S4.SS3.p1.3.m3.1.1.cmml" type="integer" xref="S4.SS3.p1.3.m3.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.1c">3</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.3.m3.1d">3</annotation></semantics></math>ms-<math alttext="24" class="ltx_Math" display="inline" id="S4.SS3.p1.4.m4.1"><semantics id="S4.SS3.p1.4.m4.1a"><mn id="S4.SS3.p1.4.m4.1.1" xref="S4.SS3.p1.4.m4.1.1.cmml">24</mn><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.m4.1b"><cn id="S4.SS3.p1.4.m4.1.1.cmml" type="integer" xref="S4.SS3.p1.4.m4.1.1">24</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.4.m4.1c">24</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.4.m4.1d">24</annotation></semantics></math>ms.<span class="ltx_note ltx_role_footnote" id="footnote5"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span><math alttext="24" class="ltx_Math" display="inline" id="footnote5.m1.1"><semantics id="footnote5.m1.1b"><mn id="footnote5.m1.1.1" xref="footnote5.m1.1.1.cmml">24</mn><annotation-xml encoding="MathML-Content" id="footnote5.m1.1c"><cn id="footnote5.m1.1.1.cmml" type="integer" xref="footnote5.m1.1.1">24</cn></annotation-xml><annotation encoding="application/x-tex" id="footnote5.m1.1d">24</annotation><annotation encoding="application/x-llamapun" id="footnote5.m1.1e">24</annotation></semantics></math>ms is the blur exposure time, and <math alttext="3" class="ltx_Math" display="inline" id="footnote5.m2.1"><semantics id="footnote5.m2.1b"><mn id="footnote5.m2.1.1" xref="footnote5.m2.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="footnote5.m2.1c"><cn id="footnote5.m2.1.1.cmml" type="integer" xref="footnote5.m2.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="footnote5.m2.1d">3</annotation><annotation encoding="application/x-llamapun" id="footnote5.m2.1e">3</annotation></semantics></math>ms is the sharp exposure time.</span></span></span> We follow the standard train/test split introduced in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib83" title="">83</a>]</cite> with <math alttext="60" class="ltx_Math" display="inline" id="S4.SS3.p1.5.m5.1"><semantics id="S4.SS3.p1.5.m5.1a"><mn id="S4.SS3.p1.5.m5.1.1" xref="S4.SS3.p1.5.m5.1.1.cmml">60</mn><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.5.m5.1b"><cn id="S4.SS3.p1.5.m5.1.1.cmml" type="integer" xref="S4.SS3.p1.5.m5.1.1">60</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.5.m5.1c">60</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.5.m5.1d">60</annotation></semantics></math> training videos, and <math alttext="20" class="ltx_Math" display="inline" id="S4.SS3.p1.6.m6.1"><semantics id="S4.SS3.p1.6.m6.1a"><mn id="S4.SS3.p1.6.m6.1.1" xref="S4.SS3.p1.6.m6.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.6.m6.1b"><cn id="S4.SS3.p1.6.m6.1.1.cmml" type="integer" xref="S4.SS3.p1.6.m6.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.6.m6.1c">20</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.6.m6.1d">20</annotation></semantics></math> test videos. We report the scores in <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S4.T5" title="In 4.1 Night Video Deraining ‣ 4 Experiments ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">table</span> <span class="ltx_text ltx_ref_tag">5</span></a> on the <math alttext="3" class="ltx_Math" display="inline" id="S4.SS3.p1.7.m7.1"><semantics id="S4.SS3.p1.7.m7.1a"><mn id="S4.SS3.p1.7.m7.1.1" xref="S4.SS3.p1.7.m7.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.7.m7.1b"><cn id="S4.SS3.p1.7.m7.1.1.cmml" type="integer" xref="S4.SS3.p1.7.m7.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.7.m7.1c">3</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.7.m7.1d">3</annotation></semantics></math>ms-<math alttext="24" class="ltx_Math" display="inline" id="S4.SS3.p1.8.m8.1"><semantics id="S4.SS3.p1.8.m8.1a"><mn id="S4.SS3.p1.8.m8.1.1" xref="S4.SS3.p1.8.m8.1.1.cmml">24</mn><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.8.m8.1b"><cn id="S4.SS3.p1.8.m8.1.1.cmml" type="integer" xref="S4.SS3.p1.8.m8.1.1">24</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.8.m8.1c">24</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.8.m8.1d">24</annotation></semantics></math>ms variant of BSD and compare with previously published methods. <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p1.10.2">turtle</span> scores <span class="ltx_text" id="S4.SS3.p1.9.1"><math alttext="33.58" class="ltx_Math" display="inline" id="S4.SS3.p1.9.1.m1.1" style="background-color:#D1E9F6;"><semantics id="S4.SS3.p1.9.1.m1.1a"><mn id="S4.SS3.p1.9.1.m1.1.1" mathbackground="#D1E9F6" xref="S4.SS3.p1.9.1.m1.1.1.cmml">33.58</mn><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.9.1.m1.1b"><cn id="S4.SS3.p1.9.1.m1.1.1.cmml" type="float" xref="S4.SS3.p1.9.1.m1.1.1">33.58</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.9.1.m1.1c">33.58</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.9.1.m1.1d">33.58</annotation></semantics></math></span> dB in PSNR on the task, observing an increase of <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.SS3.p1.10.3" style="color:#007F73;">+2.0</span> dB compared to the previous best methods, CDVD-TSP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib44" title="">44</a>]</cite>, and ESTRNN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib83" title="">83</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib82" title="">82</a>]</cite>. We present visual results in <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A4.F13" title="In D.4 Nighttime Video Deraining ‣ Appendix D Further Visual Comparisons ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">13</span></a>.</p>
</div>
<figure class="ltx_table" id="S4.T7">
<div class="ltx_flex_figure ltx_flex_table">
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_inline-block ltx_figure_panel ltx_transformed_outer" id="S4.T7.36" style="width:190.0pt;height:161.4pt;vertical-align:-77.7pt;"><span class="ltx_transformed_inner" style="transform:translate(-16.8pt,7.4pt) scale(0.85,0.85) ;">
<figure class="ltx_figure ltx_minipage ltx_align_middle" id="S4.T7.36.36" style="width:216.8pt;">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Table 6: </span><span class="ltx_text ltx_font_bold" id="S4.T7.36.36.38.1">Blind Video Denoising Results.</span> Quantitative results on blind video denoising task in terms of distortion metrics, PSNR and SSIM, on two datasets DAVIS <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib48" title="">48</a>]</cite>, and Set8 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib61" title="">61</a>]</cite>.</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T7.36.36.36">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T7.36.36.36.37.1">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T7.36.36.36.37.1.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="S4.T7.36.36.36.37.1.1.1">Methods</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T7.36.36.36.37.1.2"><span class="ltx_text ltx_font_bold" id="S4.T7.36.36.36.37.1.2.1">DAVIS</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T7.36.36.36.37.1.3"><span class="ltx_text ltx_font_bold" id="S4.T7.36.36.36.37.1.3.1">Set8</span></td>
</tr>
<tr class="ltx_tr" id="S4.T7.4.4.4.4">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T7.1.1.1.1.1"><math alttext="\sigma=30" class="ltx_Math" display="inline" id="S4.T7.1.1.1.1.1.m1.1"><semantics id="S4.T7.1.1.1.1.1.m1.1a"><mrow id="S4.T7.1.1.1.1.1.m1.1.1" xref="S4.T7.1.1.1.1.1.m1.1.1.cmml"><mi id="S4.T7.1.1.1.1.1.m1.1.1.2" xref="S4.T7.1.1.1.1.1.m1.1.1.2.cmml">σ</mi><mo id="S4.T7.1.1.1.1.1.m1.1.1.1" xref="S4.T7.1.1.1.1.1.m1.1.1.1.cmml">=</mo><mn id="S4.T7.1.1.1.1.1.m1.1.1.3" xref="S4.T7.1.1.1.1.1.m1.1.1.3.cmml">30</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T7.1.1.1.1.1.m1.1b"><apply id="S4.T7.1.1.1.1.1.m1.1.1.cmml" xref="S4.T7.1.1.1.1.1.m1.1.1"><eq id="S4.T7.1.1.1.1.1.m1.1.1.1.cmml" xref="S4.T7.1.1.1.1.1.m1.1.1.1"></eq><ci id="S4.T7.1.1.1.1.1.m1.1.1.2.cmml" xref="S4.T7.1.1.1.1.1.m1.1.1.2">𝜎</ci><cn id="S4.T7.1.1.1.1.1.m1.1.1.3.cmml" type="integer" xref="S4.T7.1.1.1.1.1.m1.1.1.3">30</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.1.1.1.1.1.m1.1c">\sigma=30</annotation><annotation encoding="application/x-llamapun" id="S4.T7.1.1.1.1.1.m1.1d">italic_σ = 30</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T7.2.2.2.2.2"><math alttext="\sigma=50" class="ltx_Math" display="inline" id="S4.T7.2.2.2.2.2.m1.1"><semantics id="S4.T7.2.2.2.2.2.m1.1a"><mrow id="S4.T7.2.2.2.2.2.m1.1.1" xref="S4.T7.2.2.2.2.2.m1.1.1.cmml"><mi id="S4.T7.2.2.2.2.2.m1.1.1.2" xref="S4.T7.2.2.2.2.2.m1.1.1.2.cmml">σ</mi><mo id="S4.T7.2.2.2.2.2.m1.1.1.1" xref="S4.T7.2.2.2.2.2.m1.1.1.1.cmml">=</mo><mn id="S4.T7.2.2.2.2.2.m1.1.1.3" xref="S4.T7.2.2.2.2.2.m1.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T7.2.2.2.2.2.m1.1b"><apply id="S4.T7.2.2.2.2.2.m1.1.1.cmml" xref="S4.T7.2.2.2.2.2.m1.1.1"><eq id="S4.T7.2.2.2.2.2.m1.1.1.1.cmml" xref="S4.T7.2.2.2.2.2.m1.1.1.1"></eq><ci id="S4.T7.2.2.2.2.2.m1.1.1.2.cmml" xref="S4.T7.2.2.2.2.2.m1.1.1.2">𝜎</ci><cn id="S4.T7.2.2.2.2.2.m1.1.1.3.cmml" type="integer" xref="S4.T7.2.2.2.2.2.m1.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.2.2.2.2.2.m1.1c">\sigma=50</annotation><annotation encoding="application/x-llamapun" id="S4.T7.2.2.2.2.2.m1.1d">italic_σ = 50</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T7.3.3.3.3.3"><math alttext="\sigma=30" class="ltx_Math" display="inline" id="S4.T7.3.3.3.3.3.m1.1"><semantics id="S4.T7.3.3.3.3.3.m1.1a"><mrow id="S4.T7.3.3.3.3.3.m1.1.1" xref="S4.T7.3.3.3.3.3.m1.1.1.cmml"><mi id="S4.T7.3.3.3.3.3.m1.1.1.2" xref="S4.T7.3.3.3.3.3.m1.1.1.2.cmml">σ</mi><mo id="S4.T7.3.3.3.3.3.m1.1.1.1" xref="S4.T7.3.3.3.3.3.m1.1.1.1.cmml">=</mo><mn id="S4.T7.3.3.3.3.3.m1.1.1.3" xref="S4.T7.3.3.3.3.3.m1.1.1.3.cmml">30</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T7.3.3.3.3.3.m1.1b"><apply id="S4.T7.3.3.3.3.3.m1.1.1.cmml" xref="S4.T7.3.3.3.3.3.m1.1.1"><eq id="S4.T7.3.3.3.3.3.m1.1.1.1.cmml" xref="S4.T7.3.3.3.3.3.m1.1.1.1"></eq><ci id="S4.T7.3.3.3.3.3.m1.1.1.2.cmml" xref="S4.T7.3.3.3.3.3.m1.1.1.2">𝜎</ci><cn id="S4.T7.3.3.3.3.3.m1.1.1.3.cmml" type="integer" xref="S4.T7.3.3.3.3.3.m1.1.1.3">30</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.3.3.3.3.3.m1.1c">\sigma=30</annotation><annotation encoding="application/x-llamapun" id="S4.T7.3.3.3.3.3.m1.1d">italic_σ = 30</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t" id="S4.T7.4.4.4.4.4"><math alttext="\sigma=50" class="ltx_Math" display="inline" id="S4.T7.4.4.4.4.4.m1.1"><semantics id="S4.T7.4.4.4.4.4.m1.1a"><mrow id="S4.T7.4.4.4.4.4.m1.1.1" xref="S4.T7.4.4.4.4.4.m1.1.1.cmml"><mi id="S4.T7.4.4.4.4.4.m1.1.1.2" xref="S4.T7.4.4.4.4.4.m1.1.1.2.cmml">σ</mi><mo id="S4.T7.4.4.4.4.4.m1.1.1.1" xref="S4.T7.4.4.4.4.4.m1.1.1.1.cmml">=</mo><mn id="S4.T7.4.4.4.4.4.m1.1.1.3" xref="S4.T7.4.4.4.4.4.m1.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T7.4.4.4.4.4.m1.1b"><apply id="S4.T7.4.4.4.4.4.m1.1.1.cmml" xref="S4.T7.4.4.4.4.4.m1.1.1"><eq id="S4.T7.4.4.4.4.4.m1.1.1.1.cmml" xref="S4.T7.4.4.4.4.4.m1.1.1.1"></eq><ci id="S4.T7.4.4.4.4.4.m1.1.1.2.cmml" xref="S4.T7.4.4.4.4.4.m1.1.1.2">𝜎</ci><cn id="S4.T7.4.4.4.4.4.m1.1.1.3.cmml" type="integer" xref="S4.T7.4.4.4.4.4.m1.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.4.4.4.4.4.m1.1c">\sigma=50</annotation><annotation encoding="application/x-llamapun" id="S4.T7.4.4.4.4.4.m1.1d">italic_σ = 50</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T7.8.8.8.8">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T7.8.8.8.8.5">VLNB <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib1" title="">1</a>]</cite>
</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T7.5.5.5.5.1"><math alttext="33.73" class="ltx_Math" display="inline" id="S4.T7.5.5.5.5.1.m1.1"><semantics id="S4.T7.5.5.5.5.1.m1.1a"><mn id="S4.T7.5.5.5.5.1.m1.1.1" xref="S4.T7.5.5.5.5.1.m1.1.1.cmml">33.73</mn><annotation-xml encoding="MathML-Content" id="S4.T7.5.5.5.5.1.m1.1b"><cn id="S4.T7.5.5.5.5.1.m1.1.1.cmml" type="float" xref="S4.T7.5.5.5.5.1.m1.1.1">33.73</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.5.5.5.5.1.m1.1c">33.73</annotation><annotation encoding="application/x-llamapun" id="S4.T7.5.5.5.5.1.m1.1d">33.73</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T7.6.6.6.6.2"><math alttext="31.13" class="ltx_Math" display="inline" id="S4.T7.6.6.6.6.2.m1.1"><semantics id="S4.T7.6.6.6.6.2.m1.1a"><mn id="S4.T7.6.6.6.6.2.m1.1.1" xref="S4.T7.6.6.6.6.2.m1.1.1.cmml">31.13</mn><annotation-xml encoding="MathML-Content" id="S4.T7.6.6.6.6.2.m1.1b"><cn id="S4.T7.6.6.6.6.2.m1.1.1.cmml" type="float" xref="S4.T7.6.6.6.6.2.m1.1.1">31.13</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.6.6.6.6.2.m1.1c">31.13</annotation><annotation encoding="application/x-llamapun" id="S4.T7.6.6.6.6.2.m1.1d">31.13</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T7.7.7.7.7.3"><math alttext="31.74" class="ltx_Math" display="inline" id="S4.T7.7.7.7.7.3.m1.1"><semantics id="S4.T7.7.7.7.7.3.m1.1a"><mn id="S4.T7.7.7.7.7.3.m1.1.1" xref="S4.T7.7.7.7.7.3.m1.1.1.cmml">31.74</mn><annotation-xml encoding="MathML-Content" id="S4.T7.7.7.7.7.3.m1.1b"><cn id="S4.T7.7.7.7.7.3.m1.1.1.cmml" type="float" xref="S4.T7.7.7.7.7.3.m1.1.1">31.74</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.7.7.7.7.3.m1.1c">31.74</annotation><annotation encoding="application/x-llamapun" id="S4.T7.7.7.7.7.3.m1.1d">31.74</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t" id="S4.T7.8.8.8.8.4"><math alttext="29.24" class="ltx_Math" display="inline" id="S4.T7.8.8.8.8.4.m1.1"><semantics id="S4.T7.8.8.8.8.4.m1.1a"><mn id="S4.T7.8.8.8.8.4.m1.1.1" xref="S4.T7.8.8.8.8.4.m1.1.1.cmml">29.24</mn><annotation-xml encoding="MathML-Content" id="S4.T7.8.8.8.8.4.m1.1b"><cn id="S4.T7.8.8.8.8.4.m1.1.1.cmml" type="float" xref="S4.T7.8.8.8.8.4.m1.1.1">29.24</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.8.8.8.8.4.m1.1c">29.24</annotation><annotation encoding="application/x-llamapun" id="S4.T7.8.8.8.8.4.m1.1d">29.24</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T7.12.12.12.12">
<td class="ltx_td ltx_align_left" id="S4.T7.12.12.12.12.5">FastDVDNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib62" title="">62</a>]</cite>
</td>
<td class="ltx_td ltx_align_left" id="S4.T7.9.9.9.9.1"><math alttext="34.04" class="ltx_Math" display="inline" id="S4.T7.9.9.9.9.1.m1.1"><semantics id="S4.T7.9.9.9.9.1.m1.1a"><mn id="S4.T7.9.9.9.9.1.m1.1.1" xref="S4.T7.9.9.9.9.1.m1.1.1.cmml">34.04</mn><annotation-xml encoding="MathML-Content" id="S4.T7.9.9.9.9.1.m1.1b"><cn id="S4.T7.9.9.9.9.1.m1.1.1.cmml" type="float" xref="S4.T7.9.9.9.9.1.m1.1.1">34.04</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.9.9.9.9.1.m1.1c">34.04</annotation><annotation encoding="application/x-llamapun" id="S4.T7.9.9.9.9.1.m1.1d">34.04</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S4.T7.10.10.10.10.2"><math alttext="31.86" class="ltx_Math" display="inline" id="S4.T7.10.10.10.10.2.m1.1"><semantics id="S4.T7.10.10.10.10.2.m1.1a"><mn id="S4.T7.10.10.10.10.2.m1.1.1" xref="S4.T7.10.10.10.10.2.m1.1.1.cmml">31.86</mn><annotation-xml encoding="MathML-Content" id="S4.T7.10.10.10.10.2.m1.1b"><cn id="S4.T7.10.10.10.10.2.m1.1.1.cmml" type="float" xref="S4.T7.10.10.10.10.2.m1.1.1">31.86</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.10.10.10.10.2.m1.1c">31.86</annotation><annotation encoding="application/x-llamapun" id="S4.T7.10.10.10.10.2.m1.1d">31.86</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S4.T7.11.11.11.11.3"><math alttext="31.60" class="ltx_Math" display="inline" id="S4.T7.11.11.11.11.3.m1.1"><semantics id="S4.T7.11.11.11.11.3.m1.1a"><mn id="S4.T7.11.11.11.11.3.m1.1.1" xref="S4.T7.11.11.11.11.3.m1.1.1.cmml">31.60</mn><annotation-xml encoding="MathML-Content" id="S4.T7.11.11.11.11.3.m1.1b"><cn id="S4.T7.11.11.11.11.3.m1.1.1.cmml" type="float" xref="S4.T7.11.11.11.11.3.m1.1.1">31.60</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.11.11.11.11.3.m1.1c">31.60</annotation><annotation encoding="application/x-llamapun" id="S4.T7.11.11.11.11.3.m1.1d">31.60</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T7.12.12.12.12.4"><math alttext="29.42" class="ltx_Math" display="inline" id="S4.T7.12.12.12.12.4.m1.1"><semantics id="S4.T7.12.12.12.12.4.m1.1a"><mn id="S4.T7.12.12.12.12.4.m1.1.1" xref="S4.T7.12.12.12.12.4.m1.1.1.cmml">29.42</mn><annotation-xml encoding="MathML-Content" id="S4.T7.12.12.12.12.4.m1.1b"><cn id="S4.T7.12.12.12.12.4.m1.1.1.cmml" type="float" xref="S4.T7.12.12.12.12.4.m1.1.1">29.42</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.12.12.12.12.4.m1.1c">29.42</annotation><annotation encoding="application/x-llamapun" id="S4.T7.12.12.12.12.4.m1.1d">29.42</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T7.16.16.16.16">
<td class="ltx_td ltx_align_left" id="S4.T7.16.16.16.16.5">DVDNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib61" title="">61</a>]</cite>
</td>
<td class="ltx_td ltx_align_left" id="S4.T7.13.13.13.13.1"><math alttext="34.08" class="ltx_Math" display="inline" id="S4.T7.13.13.13.13.1.m1.1"><semantics id="S4.T7.13.13.13.13.1.m1.1a"><mn id="S4.T7.13.13.13.13.1.m1.1.1" xref="S4.T7.13.13.13.13.1.m1.1.1.cmml">34.08</mn><annotation-xml encoding="MathML-Content" id="S4.T7.13.13.13.13.1.m1.1b"><cn id="S4.T7.13.13.13.13.1.m1.1.1.cmml" type="float" xref="S4.T7.13.13.13.13.1.m1.1.1">34.08</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.13.13.13.13.1.m1.1c">34.08</annotation><annotation encoding="application/x-llamapun" id="S4.T7.13.13.13.13.1.m1.1d">34.08</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S4.T7.14.14.14.14.2"><math alttext="31.85" class="ltx_Math" display="inline" id="S4.T7.14.14.14.14.2.m1.1"><semantics id="S4.T7.14.14.14.14.2.m1.1a"><mn id="S4.T7.14.14.14.14.2.m1.1.1" xref="S4.T7.14.14.14.14.2.m1.1.1.cmml">31.85</mn><annotation-xml encoding="MathML-Content" id="S4.T7.14.14.14.14.2.m1.1b"><cn id="S4.T7.14.14.14.14.2.m1.1.1.cmml" type="float" xref="S4.T7.14.14.14.14.2.m1.1.1">31.85</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.14.14.14.14.2.m1.1c">31.85</annotation><annotation encoding="application/x-llamapun" id="S4.T7.14.14.14.14.2.m1.1d">31.85</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S4.T7.15.15.15.15.3"><math alttext="31.79" class="ltx_Math" display="inline" id="S4.T7.15.15.15.15.3.m1.1"><semantics id="S4.T7.15.15.15.15.3.m1.1a"><mn id="S4.T7.15.15.15.15.3.m1.1.1" xref="S4.T7.15.15.15.15.3.m1.1.1.cmml">31.79</mn><annotation-xml encoding="MathML-Content" id="S4.T7.15.15.15.15.3.m1.1b"><cn id="S4.T7.15.15.15.15.3.m1.1.1.cmml" type="float" xref="S4.T7.15.15.15.15.3.m1.1.1">31.79</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.15.15.15.15.3.m1.1c">31.79</annotation><annotation encoding="application/x-llamapun" id="S4.T7.15.15.15.15.3.m1.1d">31.79</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T7.16.16.16.16.4"><math alttext="29.56" class="ltx_Math" display="inline" id="S4.T7.16.16.16.16.4.m1.1"><semantics id="S4.T7.16.16.16.16.4.m1.1a"><mn id="S4.T7.16.16.16.16.4.m1.1.1" xref="S4.T7.16.16.16.16.4.m1.1.1.cmml">29.56</mn><annotation-xml encoding="MathML-Content" id="S4.T7.16.16.16.16.4.m1.1b"><cn id="S4.T7.16.16.16.16.4.m1.1.1.cmml" type="float" xref="S4.T7.16.16.16.16.4.m1.1.1">29.56</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.16.16.16.16.4.m1.1c">29.56</annotation><annotation encoding="application/x-llamapun" id="S4.T7.16.16.16.16.4.m1.1d">29.56</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T7.20.20.20.20">
<td class="ltx_td ltx_align_left" id="S4.T7.20.20.20.20.5">UDVD <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib55" title="">55</a>]</cite>
</td>
<td class="ltx_td ltx_align_left" id="S4.T7.17.17.17.17.1"><math alttext="33.92" class="ltx_Math" display="inline" id="S4.T7.17.17.17.17.1.m1.1"><semantics id="S4.T7.17.17.17.17.1.m1.1a"><mn id="S4.T7.17.17.17.17.1.m1.1.1" xref="S4.T7.17.17.17.17.1.m1.1.1.cmml">33.92</mn><annotation-xml encoding="MathML-Content" id="S4.T7.17.17.17.17.1.m1.1b"><cn id="S4.T7.17.17.17.17.1.m1.1.1.cmml" type="float" xref="S4.T7.17.17.17.17.1.m1.1.1">33.92</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.17.17.17.17.1.m1.1c">33.92</annotation><annotation encoding="application/x-llamapun" id="S4.T7.17.17.17.17.1.m1.1d">33.92</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S4.T7.18.18.18.18.2"><math alttext="31.70" class="ltx_Math" display="inline" id="S4.T7.18.18.18.18.2.m1.1"><semantics id="S4.T7.18.18.18.18.2.m1.1a"><mn id="S4.T7.18.18.18.18.2.m1.1.1" xref="S4.T7.18.18.18.18.2.m1.1.1.cmml">31.70</mn><annotation-xml encoding="MathML-Content" id="S4.T7.18.18.18.18.2.m1.1b"><cn id="S4.T7.18.18.18.18.2.m1.1.1.cmml" type="float" xref="S4.T7.18.18.18.18.2.m1.1.1">31.70</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.18.18.18.18.2.m1.1c">31.70</annotation><annotation encoding="application/x-llamapun" id="S4.T7.18.18.18.18.2.m1.1d">31.70</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S4.T7.19.19.19.19.3"><math alttext="32.01" class="ltx_Math" display="inline" id="S4.T7.19.19.19.19.3.m1.1"><semantics id="S4.T7.19.19.19.19.3.m1.1a"><mn id="S4.T7.19.19.19.19.3.m1.1.1" xref="S4.T7.19.19.19.19.3.m1.1.1.cmml">32.01</mn><annotation-xml encoding="MathML-Content" id="S4.T7.19.19.19.19.3.m1.1b"><cn id="S4.T7.19.19.19.19.3.m1.1.1.cmml" type="float" xref="S4.T7.19.19.19.19.3.m1.1.1">32.01</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.19.19.19.19.3.m1.1c">32.01</annotation><annotation encoding="application/x-llamapun" id="S4.T7.19.19.19.19.3.m1.1d">32.01</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T7.20.20.20.20.4"><math alttext="29.89" class="ltx_Math" display="inline" id="S4.T7.20.20.20.20.4.m1.1"><semantics id="S4.T7.20.20.20.20.4.m1.1a"><mn id="S4.T7.20.20.20.20.4.m1.1.1" xref="S4.T7.20.20.20.20.4.m1.1.1.cmml">29.89</mn><annotation-xml encoding="MathML-Content" id="S4.T7.20.20.20.20.4.m1.1b"><cn id="S4.T7.20.20.20.20.4.m1.1.1.cmml" type="float" xref="S4.T7.20.20.20.20.4.m1.1.1">29.89</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.20.20.20.20.4.m1.1c">29.89</annotation><annotation encoding="application/x-llamapun" id="S4.T7.20.20.20.20.4.m1.1d">29.89</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T7.24.24.24.24">
<td class="ltx_td ltx_align_left" id="S4.T7.24.24.24.24.5">ReMoNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib72" title="">72</a>]</cite>
</td>
<td class="ltx_td ltx_align_left" id="S4.T7.21.21.21.21.1"><math alttext="33.93" class="ltx_Math" display="inline" id="S4.T7.21.21.21.21.1.m1.1"><semantics id="S4.T7.21.21.21.21.1.m1.1a"><mn id="S4.T7.21.21.21.21.1.m1.1.1" xref="S4.T7.21.21.21.21.1.m1.1.1.cmml">33.93</mn><annotation-xml encoding="MathML-Content" id="S4.T7.21.21.21.21.1.m1.1b"><cn id="S4.T7.21.21.21.21.1.m1.1.1.cmml" type="float" xref="S4.T7.21.21.21.21.1.m1.1.1">33.93</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.21.21.21.21.1.m1.1c">33.93</annotation><annotation encoding="application/x-llamapun" id="S4.T7.21.21.21.21.1.m1.1d">33.93</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S4.T7.22.22.22.22.2"><math alttext="31.65" class="ltx_Math" display="inline" id="S4.T7.22.22.22.22.2.m1.1"><semantics id="S4.T7.22.22.22.22.2.m1.1a"><mn id="S4.T7.22.22.22.22.2.m1.1.1" xref="S4.T7.22.22.22.22.2.m1.1.1.cmml">31.65</mn><annotation-xml encoding="MathML-Content" id="S4.T7.22.22.22.22.2.m1.1b"><cn id="S4.T7.22.22.22.22.2.m1.1.1.cmml" type="float" xref="S4.T7.22.22.22.22.2.m1.1.1">31.65</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.22.22.22.22.2.m1.1c">31.65</annotation><annotation encoding="application/x-llamapun" id="S4.T7.22.22.22.22.2.m1.1d">31.65</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S4.T7.23.23.23.23.3"><math alttext="31.59" class="ltx_Math" display="inline" id="S4.T7.23.23.23.23.3.m1.1"><semantics id="S4.T7.23.23.23.23.3.m1.1a"><mn id="S4.T7.23.23.23.23.3.m1.1.1" xref="S4.T7.23.23.23.23.3.m1.1.1.cmml">31.59</mn><annotation-xml encoding="MathML-Content" id="S4.T7.23.23.23.23.3.m1.1b"><cn id="S4.T7.23.23.23.23.3.m1.1.1.cmml" type="float" xref="S4.T7.23.23.23.23.3.m1.1.1">31.59</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.23.23.23.23.3.m1.1c">31.59</annotation><annotation encoding="application/x-llamapun" id="S4.T7.23.23.23.23.3.m1.1d">31.59</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T7.24.24.24.24.4"><math alttext="29.44" class="ltx_Math" display="inline" id="S4.T7.24.24.24.24.4.m1.1"><semantics id="S4.T7.24.24.24.24.4.m1.1a"><mn id="S4.T7.24.24.24.24.4.m1.1.1" xref="S4.T7.24.24.24.24.4.m1.1.1.cmml">29.44</mn><annotation-xml encoding="MathML-Content" id="S4.T7.24.24.24.24.4.m1.1b"><cn id="S4.T7.24.24.24.24.4.m1.1.1.cmml" type="float" xref="S4.T7.24.24.24.24.4.m1.1.1">29.44</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.24.24.24.24.4.m1.1c">29.44</annotation><annotation encoding="application/x-llamapun" id="S4.T7.24.24.24.24.4.m1.1d">29.44</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T7.28.28.28.28">
<td class="ltx_td ltx_align_left" id="S4.T7.28.28.28.28.5">BSVD-32 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib49" title="">49</a>]</cite>
</td>
<td class="ltx_td ltx_align_left" id="S4.T7.25.25.25.25.1"><math alttext="34.46" class="ltx_Math" display="inline" id="S4.T7.25.25.25.25.1.m1.1"><semantics id="S4.T7.25.25.25.25.1.m1.1a"><mn id="S4.T7.25.25.25.25.1.m1.1.1" xref="S4.T7.25.25.25.25.1.m1.1.1.cmml">34.46</mn><annotation-xml encoding="MathML-Content" id="S4.T7.25.25.25.25.1.m1.1b"><cn id="S4.T7.25.25.25.25.1.m1.1.1.cmml" type="float" xref="S4.T7.25.25.25.25.1.m1.1.1">34.46</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.25.25.25.25.1.m1.1c">34.46</annotation><annotation encoding="application/x-llamapun" id="S4.T7.25.25.25.25.1.m1.1d">34.46</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S4.T7.26.26.26.26.2"><math alttext="32.25" class="ltx_Math" display="inline" id="S4.T7.26.26.26.26.2.m1.1"><semantics id="S4.T7.26.26.26.26.2.m1.1a"><mn id="S4.T7.26.26.26.26.2.m1.1.1" xref="S4.T7.26.26.26.26.2.m1.1.1.cmml">32.25</mn><annotation-xml encoding="MathML-Content" id="S4.T7.26.26.26.26.2.m1.1b"><cn id="S4.T7.26.26.26.26.2.m1.1.1.cmml" type="float" xref="S4.T7.26.26.26.26.2.m1.1.1">32.25</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.26.26.26.26.2.m1.1c">32.25</annotation><annotation encoding="application/x-llamapun" id="S4.T7.26.26.26.26.2.m1.1d">32.25</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S4.T7.27.27.27.27.3"><math alttext="31.71" class="ltx_Math" display="inline" id="S4.T7.27.27.27.27.3.m1.1"><semantics id="S4.T7.27.27.27.27.3.m1.1a"><mn id="S4.T7.27.27.27.27.3.m1.1.1" xref="S4.T7.27.27.27.27.3.m1.1.1.cmml">31.71</mn><annotation-xml encoding="MathML-Content" id="S4.T7.27.27.27.27.3.m1.1b"><cn id="S4.T7.27.27.27.27.3.m1.1.1.cmml" type="float" xref="S4.T7.27.27.27.27.3.m1.1.1">31.71</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.27.27.27.27.3.m1.1c">31.71</annotation><annotation encoding="application/x-llamapun" id="S4.T7.27.27.27.27.3.m1.1d">31.71</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T7.28.28.28.28.4"><math alttext="29.62" class="ltx_Math" display="inline" id="S4.T7.28.28.28.28.4.m1.1"><semantics id="S4.T7.28.28.28.28.4.m1.1a"><mn id="S4.T7.28.28.28.28.4.m1.1.1" xref="S4.T7.28.28.28.28.4.m1.1.1.cmml">29.62</mn><annotation-xml encoding="MathML-Content" id="S4.T7.28.28.28.28.4.m1.1b"><cn id="S4.T7.28.28.28.28.4.m1.1.1.cmml" type="float" xref="S4.T7.28.28.28.28.4.m1.1.1">29.62</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.28.28.28.28.4.m1.1c">29.62</annotation><annotation encoding="application/x-llamapun" id="S4.T7.28.28.28.28.4.m1.1d">29.62</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T7.32.32.32.32">
<td class="ltx_td ltx_align_left" id="S4.T7.32.32.32.32.5">BSVD-64 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib49" title="">49</a>]</cite>
</td>
<td class="ltx_td ltx_align_left" id="S4.T7.29.29.29.29.1"><span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.T7.29.29.29.29.1.1">34.91</span></td>
<td class="ltx_td ltx_align_left" id="S4.T7.30.30.30.30.2"><span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.T7.30.30.30.30.2.1">32.72</span></td>
<td class="ltx_td ltx_align_left" id="S4.T7.31.31.31.31.3"><math alttext="32.02" class="ltx_Math" display="inline" id="S4.T7.31.31.31.31.3.m1.1"><semantics id="S4.T7.31.31.31.31.3.m1.1a"><mn id="S4.T7.31.31.31.31.3.m1.1.1" xref="S4.T7.31.31.31.31.3.m1.1.1.cmml">32.02</mn><annotation-xml encoding="MathML-Content" id="S4.T7.31.31.31.31.3.m1.1b"><cn id="S4.T7.31.31.31.31.3.m1.1.1.cmml" type="float" xref="S4.T7.31.31.31.31.3.m1.1.1">32.02</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.31.31.31.31.3.m1.1c">32.02</annotation><annotation encoding="application/x-llamapun" id="S4.T7.31.31.31.31.3.m1.1d">32.02</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T7.32.32.32.32.4"><math alttext="29.95" class="ltx_Math" display="inline" id="S4.T7.32.32.32.32.4.m1.1"><semantics id="S4.T7.32.32.32.32.4.m1.1a"><mn id="S4.T7.32.32.32.32.4.m1.1.1" xref="S4.T7.32.32.32.32.4.m1.1.1.cmml">29.95</mn><annotation-xml encoding="MathML-Content" id="S4.T7.32.32.32.32.4.m1.1b"><cn id="S4.T7.32.32.32.32.4.m1.1.1.cmml" type="float" xref="S4.T7.32.32.32.32.4.m1.1.1">29.95</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.32.32.32.32.4.m1.1c">29.95</annotation><annotation encoding="application/x-llamapun" id="S4.T7.32.32.32.32.4.m1.1d">29.95</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T7.36.36.36.36" style="background-color:#D1E9F6;">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_tt" id="S4.T7.36.36.36.36.5"><span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="S4.T7.36.36.36.36.5.1" style="background-color:#D1E9F6;">turtle</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_tt" id="S4.T7.33.33.33.33.1"><math alttext="34.48" class="ltx_Math" display="inline" id="S4.T7.33.33.33.33.1.m1.1" style="background-color:#D1E9F6;"><semantics id="S4.T7.33.33.33.33.1.m1.1a"><mn id="S4.T7.33.33.33.33.1.m1.1.1" mathbackground="#D1E9F6" xref="S4.T7.33.33.33.33.1.m1.1.1.cmml">34.48</mn><annotation-xml encoding="MathML-Content" id="S4.T7.33.33.33.33.1.m1.1b"><cn id="S4.T7.33.33.33.33.1.m1.1.1.cmml" type="float" xref="S4.T7.33.33.33.33.1.m1.1.1">34.48</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.33.33.33.33.1.m1.1c">34.48</annotation><annotation encoding="application/x-llamapun" id="S4.T7.33.33.33.33.1.m1.1d">34.48</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_tt" id="S4.T7.34.34.34.34.2"><math alttext="32.38" class="ltx_Math" display="inline" id="S4.T7.34.34.34.34.2.m1.1" style="background-color:#D1E9F6;"><semantics id="S4.T7.34.34.34.34.2.m1.1a"><mn id="S4.T7.34.34.34.34.2.m1.1.1" mathbackground="#D1E9F6" xref="S4.T7.34.34.34.34.2.m1.1.1.cmml">32.38</mn><annotation-xml encoding="MathML-Content" id="S4.T7.34.34.34.34.2.m1.1b"><cn id="S4.T7.34.34.34.34.2.m1.1.1.cmml" type="float" xref="S4.T7.34.34.34.34.2.m1.1.1">32.38</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.34.34.34.34.2.m1.1c">32.38</annotation><annotation encoding="application/x-llamapun" id="S4.T7.34.34.34.34.2.m1.1d">32.38</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_tt" id="S4.T7.35.35.35.35.3"><span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.T7.35.35.35.35.3.1" style="background-color:#D1E9F6;">32.22</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb ltx_border_tt" id="S4.T7.36.36.36.36.4"><span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.T7.36.36.36.36.4.1" style="background-color:#D1E9F6;">30.29</span></td>
</tr>
</tbody>
</table>
</figure>
</span></div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_inline-block ltx_figure_panel ltx_transformed_outer" id="S4.T7.58" style="width:190.0pt;height:161.4pt;vertical-align:-77.7pt;"><span class="ltx_transformed_inner" style="transform:translate(-16.8pt,7.4pt) scale(0.85,0.85) ;">
<figure class="ltx_figure ltx_minipage ltx_align_middle" id="S4.T7.58.22" style="width:216.8pt;">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Table 7: </span><math alttext="4\times" class="ltx_math_unparsed" display="inline" id="S4.T7.38.2.2.m1.1"><semantics id="S4.T7.38.2.2.m1.1b"><mrow id="S4.T7.38.2.2.m1.1c"><mn id="S4.T7.38.2.2.m1.1.1">4</mn><mo id="S4.T7.38.2.2.m1.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S4.T7.38.2.2.m1.1d">4\times</annotation><annotation encoding="application/x-llamapun" id="S4.T7.38.2.2.m1.1e">4 ×</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="S4.T7.58.22.24.1">Video Super Resolution.</span> Quantitative results on video super resolution task in terms of distortion metrics, PSNR and SSIM.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T7.58.22.22">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T7.40.4.4.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S4.T7.40.4.4.2.3"><span class="ltx_text ltx_font_bold" id="S4.T7.40.4.4.2.3.1">Method</span></th>
<td class="ltx_td ltx_align_left ltx_border_tt" id="S4.T7.39.3.3.1.1"><span class="ltx_text ltx_font_bold" id="S4.T7.39.3.3.1.1.1">PSNR<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T7.39.3.3.1.1.1.m1.1"><semantics id="S4.T7.39.3.3.1.1.1.m1.1a"><mo id="S4.T7.39.3.3.1.1.1.m1.1.1" stretchy="false" xref="S4.T7.39.3.3.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T7.39.3.3.1.1.1.m1.1b"><ci id="S4.T7.39.3.3.1.1.1.m1.1.1.cmml" xref="S4.T7.39.3.3.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.39.3.3.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T7.39.3.3.1.1.1.m1.1d">↑</annotation></semantics></math></span></td>
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_tt" id="S4.T7.40.4.4.2.2"><span class="ltx_text ltx_font_bold" id="S4.T7.40.4.4.2.2.1">SSIM<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T7.40.4.4.2.2.1.m1.1"><semantics id="S4.T7.40.4.4.2.2.1.m1.1a"><mo id="S4.T7.40.4.4.2.2.1.m1.1.1" stretchy="false" xref="S4.T7.40.4.4.2.2.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T7.40.4.4.2.2.1.m1.1b"><ci id="S4.T7.40.4.4.2.2.1.m1.1.1.cmml" xref="S4.T7.40.4.4.2.2.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.40.4.4.2.2.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T7.40.4.4.2.2.1.m1.1d">↑</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="S4.T7.42.6.6.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T7.42.6.6.4.3">TDAN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib63" title="">63</a>]</cite>
</th>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T7.41.5.5.3.1"><math alttext="23.07" class="ltx_Math" display="inline" id="S4.T7.41.5.5.3.1.m1.1"><semantics id="S4.T7.41.5.5.3.1.m1.1a"><mn id="S4.T7.41.5.5.3.1.m1.1.1" xref="S4.T7.41.5.5.3.1.m1.1.1.cmml">23.07</mn><annotation-xml encoding="MathML-Content" id="S4.T7.41.5.5.3.1.m1.1b"><cn id="S4.T7.41.5.5.3.1.m1.1.1.cmml" type="float" xref="S4.T7.41.5.5.3.1.m1.1.1">23.07</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.41.5.5.3.1.m1.1c">23.07</annotation><annotation encoding="application/x-llamapun" id="S4.T7.41.5.5.3.1.m1.1d">23.07</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t" id="S4.T7.42.6.6.4.2"><math alttext="0.7492" class="ltx_Math" display="inline" id="S4.T7.42.6.6.4.2.m1.1"><semantics id="S4.T7.42.6.6.4.2.m1.1a"><mn id="S4.T7.42.6.6.4.2.m1.1.1" xref="S4.T7.42.6.6.4.2.m1.1.1.cmml">0.7492</mn><annotation-xml encoding="MathML-Content" id="S4.T7.42.6.6.4.2.m1.1b"><cn id="S4.T7.42.6.6.4.2.m1.1.1.cmml" type="float" xref="S4.T7.42.6.6.4.2.m1.1.1">0.7492</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.42.6.6.4.2.m1.1c">0.7492</annotation><annotation encoding="application/x-llamapun" id="S4.T7.42.6.6.4.2.m1.1d">0.7492</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T7.44.8.8.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T7.44.8.8.6.3">EDVR <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib69" title="">69</a>]</cite>
</th>
<td class="ltx_td ltx_align_left" id="S4.T7.43.7.7.5.1"><math alttext="23.51" class="ltx_Math" display="inline" id="S4.T7.43.7.7.5.1.m1.1"><semantics id="S4.T7.43.7.7.5.1.m1.1a"><mn id="S4.T7.43.7.7.5.1.m1.1.1" xref="S4.T7.43.7.7.5.1.m1.1.1.cmml">23.51</mn><annotation-xml encoding="MathML-Content" id="S4.T7.43.7.7.5.1.m1.1b"><cn id="S4.T7.43.7.7.5.1.m1.1.1.cmml" type="float" xref="S4.T7.43.7.7.5.1.m1.1.1">23.51</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.43.7.7.5.1.m1.1c">23.51</annotation><annotation encoding="application/x-llamapun" id="S4.T7.43.7.7.5.1.m1.1d">23.51</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T7.44.8.8.6.2"><math alttext="0.7611" class="ltx_Math" display="inline" id="S4.T7.44.8.8.6.2.m1.1"><semantics id="S4.T7.44.8.8.6.2.m1.1a"><mn id="S4.T7.44.8.8.6.2.m1.1.1" xref="S4.T7.44.8.8.6.2.m1.1.1.cmml">0.7611</mn><annotation-xml encoding="MathML-Content" id="S4.T7.44.8.8.6.2.m1.1b"><cn id="S4.T7.44.8.8.6.2.m1.1.1.cmml" type="float" xref="S4.T7.44.8.8.6.2.m1.1.1">0.7611</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.44.8.8.6.2.m1.1c">0.7611</annotation><annotation encoding="application/x-llamapun" id="S4.T7.44.8.8.6.2.m1.1d">0.7611</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T7.46.10.10.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T7.46.10.10.8.3">BasicVSR <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib6" title="">6</a>]</cite>
</th>
<td class="ltx_td ltx_align_left" id="S4.T7.45.9.9.7.1"><math alttext="23.38" class="ltx_Math" display="inline" id="S4.T7.45.9.9.7.1.m1.1"><semantics id="S4.T7.45.9.9.7.1.m1.1a"><mn id="S4.T7.45.9.9.7.1.m1.1.1" xref="S4.T7.45.9.9.7.1.m1.1.1.cmml">23.38</mn><annotation-xml encoding="MathML-Content" id="S4.T7.45.9.9.7.1.m1.1b"><cn id="S4.T7.45.9.9.7.1.m1.1.1.cmml" type="float" xref="S4.T7.45.9.9.7.1.m1.1.1">23.38</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.45.9.9.7.1.m1.1c">23.38</annotation><annotation encoding="application/x-llamapun" id="S4.T7.45.9.9.7.1.m1.1d">23.38</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T7.46.10.10.8.2"><math alttext="0.7594" class="ltx_Math" display="inline" id="S4.T7.46.10.10.8.2.m1.1"><semantics id="S4.T7.46.10.10.8.2.m1.1a"><mn id="S4.T7.46.10.10.8.2.m1.1.1" xref="S4.T7.46.10.10.8.2.m1.1.1.cmml">0.7594</mn><annotation-xml encoding="MathML-Content" id="S4.T7.46.10.10.8.2.m1.1b"><cn id="S4.T7.46.10.10.8.2.m1.1.1.cmml" type="float" xref="S4.T7.46.10.10.8.2.m1.1.1">0.7594</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.46.10.10.8.2.m1.1c">0.7594</annotation><annotation encoding="application/x-llamapun" id="S4.T7.46.10.10.8.2.m1.1d">0.7594</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T7.48.12.12.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T7.48.12.12.10.3">MANA <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib76" title="">76</a>]</cite>
</th>
<td class="ltx_td ltx_align_left" id="S4.T7.47.11.11.9.1"><math alttext="23.15" class="ltx_Math" display="inline" id="S4.T7.47.11.11.9.1.m1.1"><semantics id="S4.T7.47.11.11.9.1.m1.1a"><mn id="S4.T7.47.11.11.9.1.m1.1.1" xref="S4.T7.47.11.11.9.1.m1.1.1.cmml">23.15</mn><annotation-xml encoding="MathML-Content" id="S4.T7.47.11.11.9.1.m1.1b"><cn id="S4.T7.47.11.11.9.1.m1.1.1.cmml" type="float" xref="S4.T7.47.11.11.9.1.m1.1.1">23.15</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.47.11.11.9.1.m1.1c">23.15</annotation><annotation encoding="application/x-llamapun" id="S4.T7.47.11.11.9.1.m1.1d">23.15</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T7.48.12.12.10.2"><math alttext="0.7513" class="ltx_Math" display="inline" id="S4.T7.48.12.12.10.2.m1.1"><semantics id="S4.T7.48.12.12.10.2.m1.1a"><mn id="S4.T7.48.12.12.10.2.m1.1.1" xref="S4.T7.48.12.12.10.2.m1.1.1.cmml">0.7513</mn><annotation-xml encoding="MathML-Content" id="S4.T7.48.12.12.10.2.m1.1b"><cn id="S4.T7.48.12.12.10.2.m1.1.1.cmml" type="float" xref="S4.T7.48.12.12.10.2.m1.1.1">0.7513</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.48.12.12.10.2.m1.1c">0.7513</annotation><annotation encoding="application/x-llamapun" id="S4.T7.48.12.12.10.2.m1.1d">0.7513</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T7.50.14.14.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T7.50.14.14.12.3">TTVSR <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib37" title="">37</a>]</cite>
</th>
<td class="ltx_td ltx_align_left" id="S4.T7.49.13.13.11.1"><math alttext="23.60" class="ltx_Math" display="inline" id="S4.T7.49.13.13.11.1.m1.1"><semantics id="S4.T7.49.13.13.11.1.m1.1a"><mn id="S4.T7.49.13.13.11.1.m1.1.1" xref="S4.T7.49.13.13.11.1.m1.1.1.cmml">23.60</mn><annotation-xml encoding="MathML-Content" id="S4.T7.49.13.13.11.1.m1.1b"><cn id="S4.T7.49.13.13.11.1.m1.1.1.cmml" type="float" xref="S4.T7.49.13.13.11.1.m1.1.1">23.60</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.49.13.13.11.1.m1.1c">23.60</annotation><annotation encoding="application/x-llamapun" id="S4.T7.49.13.13.11.1.m1.1d">23.60</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T7.50.14.14.12.2"><math alttext="0.7686" class="ltx_Math" display="inline" id="S4.T7.50.14.14.12.2.m1.1"><semantics id="S4.T7.50.14.14.12.2.m1.1a"><mn id="S4.T7.50.14.14.12.2.m1.1.1" xref="S4.T7.50.14.14.12.2.m1.1.1.cmml">0.7686</mn><annotation-xml encoding="MathML-Content" id="S4.T7.50.14.14.12.2.m1.1b"><cn id="S4.T7.50.14.14.12.2.m1.1.1.cmml" type="float" xref="S4.T7.50.14.14.12.2.m1.1.1">0.7686</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.50.14.14.12.2.m1.1c">0.7686</annotation><annotation encoding="application/x-llamapun" id="S4.T7.50.14.14.12.2.m1.1d">0.7686</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T7.52.16.16.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T7.52.16.16.14.3">BasicVSR++ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib7" title="">7</a>]</cite>
</th>
<td class="ltx_td ltx_align_left" id="S4.T7.51.15.15.13.1"><math alttext="23.70" class="ltx_Math" display="inline" id="S4.T7.51.15.15.13.1.m1.1"><semantics id="S4.T7.51.15.15.13.1.m1.1a"><mn id="S4.T7.51.15.15.13.1.m1.1.1" xref="S4.T7.51.15.15.13.1.m1.1.1.cmml">23.70</mn><annotation-xml encoding="MathML-Content" id="S4.T7.51.15.15.13.1.m1.1b"><cn id="S4.T7.51.15.15.13.1.m1.1.1.cmml" type="float" xref="S4.T7.51.15.15.13.1.m1.1.1">23.70</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.51.15.15.13.1.m1.1c">23.70</annotation><annotation encoding="application/x-llamapun" id="S4.T7.51.15.15.13.1.m1.1d">23.70</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T7.52.16.16.14.2"><math alttext="0.7713" class="ltx_Math" display="inline" id="S4.T7.52.16.16.14.2.m1.1"><semantics id="S4.T7.52.16.16.14.2.m1.1a"><mn id="S4.T7.52.16.16.14.2.m1.1.1" xref="S4.T7.52.16.16.14.2.m1.1.1.cmml">0.7713</mn><annotation-xml encoding="MathML-Content" id="S4.T7.52.16.16.14.2.m1.1b"><cn id="S4.T7.52.16.16.14.2.m1.1.1.cmml" type="float" xref="S4.T7.52.16.16.14.2.m1.1.1">0.7713</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.52.16.16.14.2.m1.1c">0.7713</annotation><annotation encoding="application/x-llamapun" id="S4.T7.52.16.16.14.2.m1.1d">0.7713</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T7.54.18.18.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T7.54.18.18.16.3">EAVSR <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib67" title="">67</a>]</cite>
</th>
<td class="ltx_td ltx_align_left" id="S4.T7.53.17.17.15.1"><math alttext="23.61" class="ltx_Math" display="inline" id="S4.T7.53.17.17.15.1.m1.1"><semantics id="S4.T7.53.17.17.15.1.m1.1a"><mn id="S4.T7.53.17.17.15.1.m1.1.1" xref="S4.T7.53.17.17.15.1.m1.1.1.cmml">23.61</mn><annotation-xml encoding="MathML-Content" id="S4.T7.53.17.17.15.1.m1.1b"><cn id="S4.T7.53.17.17.15.1.m1.1.1.cmml" type="float" xref="S4.T7.53.17.17.15.1.m1.1.1">23.61</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.53.17.17.15.1.m1.1c">23.61</annotation><annotation encoding="application/x-llamapun" id="S4.T7.53.17.17.15.1.m1.1d">23.61</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T7.54.18.18.16.2"><math alttext="0.7618" class="ltx_Math" display="inline" id="S4.T7.54.18.18.16.2.m1.1"><semantics id="S4.T7.54.18.18.16.2.m1.1a"><mn id="S4.T7.54.18.18.16.2.m1.1.1" xref="S4.T7.54.18.18.16.2.m1.1.1.cmml">0.7618</mn><annotation-xml encoding="MathML-Content" id="S4.T7.54.18.18.16.2.m1.1b"><cn id="S4.T7.54.18.18.16.2.m1.1.1.cmml" type="float" xref="S4.T7.54.18.18.16.2.m1.1.1">0.7618</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.54.18.18.16.2.m1.1c">0.7618</annotation><annotation encoding="application/x-llamapun" id="S4.T7.54.18.18.16.2.m1.1d">0.7618</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T7.56.20.20.18">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T7.56.20.20.18.3">EAVSR+ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib67" title="">67</a>]</cite>
</th>
<td class="ltx_td ltx_align_left" id="S4.T7.55.19.19.17.1"><math alttext="23.94" class="ltx_Math" display="inline" id="S4.T7.55.19.19.17.1.m1.1"><semantics id="S4.T7.55.19.19.17.1.m1.1a"><mn id="S4.T7.55.19.19.17.1.m1.1.1" xref="S4.T7.55.19.19.17.1.m1.1.1.cmml">23.94</mn><annotation-xml encoding="MathML-Content" id="S4.T7.55.19.19.17.1.m1.1b"><cn id="S4.T7.55.19.19.17.1.m1.1.1.cmml" type="float" xref="S4.T7.55.19.19.17.1.m1.1.1">23.94</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.55.19.19.17.1.m1.1c">23.94</annotation><annotation encoding="application/x-llamapun" id="S4.T7.55.19.19.17.1.m1.1d">23.94</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T7.56.20.20.18.2"><math alttext="0.7726" class="ltx_Math" display="inline" id="S4.T7.56.20.20.18.2.m1.1"><semantics id="S4.T7.56.20.20.18.2.m1.1a"><mn id="S4.T7.56.20.20.18.2.m1.1.1" xref="S4.T7.56.20.20.18.2.m1.1.1.cmml">0.7726</mn><annotation-xml encoding="MathML-Content" id="S4.T7.56.20.20.18.2.m1.1b"><cn id="S4.T7.56.20.20.18.2.m1.1.1.cmml" type="float" xref="S4.T7.56.20.20.18.2.m1.1.1">0.7726</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.56.20.20.18.2.m1.1c">0.7726</annotation><annotation encoding="application/x-llamapun" id="S4.T7.56.20.20.18.2.m1.1d">0.7726</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T7.58.22.22.20" style="background-color:#D1E9F6;">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_tt" id="S4.T7.58.22.22.20.3"><span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="S4.T7.58.22.22.20.3.1" style="background-color:#D1E9F6;">turtle</span></th>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_tt" id="S4.T7.57.21.21.19.1"><span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.T7.57.21.21.19.1.1" style="background-color:#D1E9F6;">25.30</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb ltx_border_tt" id="S4.T7.58.22.22.20.2"><span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.T7.58.22.22.20.2.1" style="background-color:#D1E9F6;">0.8272</span></td>
</tr>
</tbody>
</table>
</figure>
</span></div>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Synthetic Video Deblurring</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.3">GoPro dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib41" title="">41</a>]</cite> is an established video deblurring benchmark dataset in the literature. The dataset is prepared with videos taken from a GOPRO4 Hero consumer camera, and the videos are captured at <math alttext="240" class="ltx_Math" display="inline" id="S4.SS4.p1.1.m1.1"><semantics id="S4.SS4.p1.1.m1.1a"><mn id="S4.SS4.p1.1.m1.1.1" xref="S4.SS4.p1.1.m1.1.1.cmml">240</mn><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.m1.1b"><cn id="S4.SS4.p1.1.m1.1.1.cmml" type="integer" xref="S4.SS4.p1.1.m1.1.1">240</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.m1.1c">240</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.1.m1.1d">240</annotation></semantics></math>fps. Blurs of varying strength are introduced in the dataset by averaging several successive frames; hence, the dataset is a synthetic blur dataset. We follow the standard train/test split of the dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib41" title="">41</a>]</cite>, and train our proposed method. <span class="ltx_text ltx_font_smallcaps" id="S4.SS4.p1.3.2">turtle</span> scores <span class="ltx_text" id="S4.SS4.p1.2.1"><math alttext="34.50" class="ltx_Math" display="inline" id="S4.SS4.p1.2.1.m1.1" style="background-color:#D1E9F6;"><semantics id="S4.SS4.p1.2.1.m1.1a"><mn id="S4.SS4.p1.2.1.m1.1.1" mathbackground="#D1E9F6" xref="S4.SS4.p1.2.1.m1.1.1.cmml">34.50</mn><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.2.1.m1.1b"><cn id="S4.SS4.p1.2.1.m1.1.1.cmml" type="float" xref="S4.SS4.p1.2.1.m1.1.1">34.50</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.2.1.m1.1c">34.50</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.2.1.m1.1d">34.50</annotation></semantics></math></span> dB in PSNR on the task, with an increase of <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.SS4.p1.3.3" style="color:#007F73;">+0.34</span> dB compared to the previous best method in a comparable computational budget, DSTNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib45" title="">45</a>]</cite> (see <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S4.T5" title="In 4.1 Night Video Deraining ‣ 4 Experiments ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">table</span> <span class="ltx_text ltx_ref_tag">5</span></a>). We also present visual results on the GoPro dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib41" title="">41</a>]</cite> comparing <span class="ltx_text ltx_font_smallcaps" id="S4.SS4.p1.3.4">turtle</span> to DSTNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib45" title="">45</a>]</cite> in <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S4.F4" title="In 4.2 Video Desnowing ‣ 4 Experiments ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">4</span></a>, and <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A1.F9" title="In A.2 Historyless FFN. ‣ Appendix A Turtle’s Specifications &amp; Details ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">9</span></a>. Our method restores frames free of artifacts (see the number plate on the car) in <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S4.F4" title="In 4.2 Video Desnowing ‣ 4 Experiments ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Video Raindrops and Rain Streak Removal</h3>
<div class="ltx_para" id="S4.SS5.p1">
<p class="ltx_p" id="S4.SS5.p1.3">The work done in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib71" title="">71</a>]</cite> introduced a synthesized video dataset of <math alttext="102" class="ltx_Math" display="inline" id="S4.SS5.p1.1.m1.1"><semantics id="S4.SS5.p1.1.m1.1a"><mn id="S4.SS5.p1.1.m1.1.1" xref="S4.SS5.p1.1.m1.1.1.cmml">102</mn><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.1.m1.1b"><cn id="S4.SS5.p1.1.m1.1.1.cmml" type="integer" xref="S4.SS5.p1.1.m1.1.1">102</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.1.m1.1c">102</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.1.m1.1d">102</annotation></semantics></math> videos, VRDS, wherein the videos contain both raindrops and rain streaks degradations since both rain streaks and raindrops corrupt the videos captured in rainy weather.<span class="ltx_note ltx_role_footnote" id="footnote6"><sup class="ltx_note_mark">6</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">6</sup><span class="ltx_tag ltx_tag_note">6</span>The dataset comprises videos captured in diverse scenarios in both daytime and nighttime settings.</span></span></span> We split the dataset in train and held-out test sets as outlined in the original work <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib71" title="">71</a>]</cite>. We present <span class="ltx_text ltx_font_smallcaps" id="S4.SS5.p1.3.2">turtle</span>’s scores in <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S4.T5" title="In 4.1 Night Video Deraining ‣ 4 Experiments ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">table</span> <span class="ltx_text ltx_ref_tag">5</span></a>, and compare it with several methods in the literature. <span class="ltx_text ltx_font_smallcaps" id="S4.SS5.p1.3.3">turtle</span> scores <span class="ltx_text" id="S4.SS5.p1.2.1"><math alttext="32.01" class="ltx_Math" display="inline" id="S4.SS5.p1.2.1.m1.1" style="background-color:#D1E9F6;"><semantics id="S4.SS5.p1.2.1.m1.1a"><mn id="S4.SS5.p1.2.1.m1.1.1" mathbackground="#D1E9F6" xref="S4.SS5.p1.2.1.m1.1.1.cmml">32.01</mn><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.2.1.m1.1b"><cn id="S4.SS5.p1.2.1.m1.1.1.cmml" type="float" xref="S4.SS5.p1.2.1.m1.1.1">32.01</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.2.1.m1.1c">32.01</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.2.1.m1.1d">32.01</annotation></semantics></math></span> dB in PSNR on the task, with an increase of <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.SS5.p1.3.4" style="color:#007F73;">+0.99</span> dB compared to the previous best method, ViMPNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib71" title="">71</a>]</cite>. We present visual results on the task in <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S4.F4" title="In 4.2 Video Desnowing ‣ 4 Experiments ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">4</span></a>, and <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A3.F10" title="In Appendix C Relationship to State Space Models ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">10</span></a>, and compare our method with ViMPNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib71" title="">71</a>]</cite>. <span class="ltx_text ltx_font_smallcaps" id="S4.SS5.p1.3.5">turtle</span> restores the frames that are pleasing to the human eye and are faithful to the ground truth.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.6 </span>Video Super-Resolution</h3>
<div class="ltx_para" id="S4.SS6.p1">
<p class="ltx_p" id="S4.SS6.p1.3">MVSR<math alttext="4\times" class="ltx_math_unparsed" display="inline" id="S4.SS6.p1.1.m1.1"><semantics id="S4.SS6.p1.1.m1.1a"><mrow id="S4.SS6.p1.1.m1.1b"><mn id="S4.SS6.p1.1.m1.1.1">4</mn><mo id="S4.SS6.p1.1.m1.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S4.SS6.p1.1.m1.1c">4\times</annotation><annotation encoding="application/x-llamapun" id="S4.SS6.p1.1.m1.1d">4 ×</annotation></semantics></math> is a real-world paired video super-resolution dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib67" title="">67</a>]</cite> collected by mobile phone’s dual cameras. We train <span class="ltx_text ltx_font_smallcaps" id="S4.SS6.p1.3.2">turtle</span> following the dataset split in the official work <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib67" title="">67</a>]</cite> and test on the provided held-out test set. We report distortion metrics in <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S4.T7" title="In 4.3 Real Video Deblurring ‣ 4 Experiments ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">table</span> <span class="ltx_text ltx_ref_tag">7</span></a> and compare it with several methods in the literature. <span class="ltx_text ltx_font_smallcaps" id="S4.SS6.p1.3.3">turtle</span> scores <span class="ltx_text" id="S4.SS6.p1.2.1"><math alttext="25.30" class="ltx_Math" display="inline" id="S4.SS6.p1.2.1.m1.1" style="background-color:#D1E9F6;"><semantics id="S4.SS6.p1.2.1.m1.1a"><mn id="S4.SS6.p1.2.1.m1.1.1" mathbackground="#D1E9F6" xref="S4.SS6.p1.2.1.m1.1.1.cmml">25.30</mn><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.2.1.m1.1b"><cn id="S4.SS6.p1.2.1.m1.1.1.cmml" type="float" xref="S4.SS6.p1.2.1.m1.1.1">25.30</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.2.1.m1.1c">25.30</annotation><annotation encoding="application/x-llamapun" id="S4.SS6.p1.2.1.m1.1d">25.30</annotation></semantics></math></span> dB in PSNR on the task, with a significant increase of <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.SS6.p1.3.4" style="color:#007F73;">+1.36</span> dB compared to the previous best method, EAVSR+ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib71" title="">71</a>]</cite>. We present visual results on the task in <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S4.F5" title="In 4.7 Blind Video Denoising ‣ 4 Experiments ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">5</span></a>. Other methods such as TTVSR <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib37" title="">37</a>]</cite>, BasicVSR <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib7" title="">7</a>]</cite>, or EAVSR <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib71" title="">71</a>]</cite> tend to introduce blur in up-scaled results, while <span class="ltx_text ltx_font_smallcaps" id="S4.SS6.p1.3.5">turtle</span>’s restored results are sharper.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS7">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.7 </span>Blind Video Denoising</h3>
<div class="ltx_para" id="S4.SS7.p1">
<p class="ltx_p" id="S4.SS7.p1.10">We assume no degradation prior, and consider blind video denoising task <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib49" title="">49</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib55" title="">55</a>]</cite>. We train our model on DAVIS <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib48" title="">48</a>]</cite> dataset, and test on DAVIS held-out testset, and a generalization set Set8 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib61" title="">61</a>]</cite>. We add white Gaussian noise to the dataset with noise level <math alttext="\sigma\in\mathcal{U}[30,50]" class="ltx_Math" display="inline" id="S4.SS7.p1.1.m1.2"><semantics id="S4.SS7.p1.1.m1.2a"><mrow id="S4.SS7.p1.1.m1.2.3" xref="S4.SS7.p1.1.m1.2.3.cmml"><mi id="S4.SS7.p1.1.m1.2.3.2" xref="S4.SS7.p1.1.m1.2.3.2.cmml">σ</mi><mo id="S4.SS7.p1.1.m1.2.3.1" xref="S4.SS7.p1.1.m1.2.3.1.cmml">∈</mo><mrow id="S4.SS7.p1.1.m1.2.3.3" xref="S4.SS7.p1.1.m1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS7.p1.1.m1.2.3.3.2" xref="S4.SS7.p1.1.m1.2.3.3.2.cmml">𝒰</mi><mo id="S4.SS7.p1.1.m1.2.3.3.1" xref="S4.SS7.p1.1.m1.2.3.3.1.cmml">⁢</mo><mrow id="S4.SS7.p1.1.m1.2.3.3.3.2" xref="S4.SS7.p1.1.m1.2.3.3.3.1.cmml"><mo id="S4.SS7.p1.1.m1.2.3.3.3.2.1" stretchy="false" xref="S4.SS7.p1.1.m1.2.3.3.3.1.cmml">[</mo><mn id="S4.SS7.p1.1.m1.1.1" xref="S4.SS7.p1.1.m1.1.1.cmml">30</mn><mo id="S4.SS7.p1.1.m1.2.3.3.3.2.2" xref="S4.SS7.p1.1.m1.2.3.3.3.1.cmml">,</mo><mn id="S4.SS7.p1.1.m1.2.2" xref="S4.SS7.p1.1.m1.2.2.cmml">50</mn><mo id="S4.SS7.p1.1.m1.2.3.3.3.2.3" stretchy="false" xref="S4.SS7.p1.1.m1.2.3.3.3.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS7.p1.1.m1.2b"><apply id="S4.SS7.p1.1.m1.2.3.cmml" xref="S4.SS7.p1.1.m1.2.3"><in id="S4.SS7.p1.1.m1.2.3.1.cmml" xref="S4.SS7.p1.1.m1.2.3.1"></in><ci id="S4.SS7.p1.1.m1.2.3.2.cmml" xref="S4.SS7.p1.1.m1.2.3.2">𝜎</ci><apply id="S4.SS7.p1.1.m1.2.3.3.cmml" xref="S4.SS7.p1.1.m1.2.3.3"><times id="S4.SS7.p1.1.m1.2.3.3.1.cmml" xref="S4.SS7.p1.1.m1.2.3.3.1"></times><ci id="S4.SS7.p1.1.m1.2.3.3.2.cmml" xref="S4.SS7.p1.1.m1.2.3.3.2">𝒰</ci><interval closure="closed" id="S4.SS7.p1.1.m1.2.3.3.3.1.cmml" xref="S4.SS7.p1.1.m1.2.3.3.3.2"><cn id="S4.SS7.p1.1.m1.1.1.cmml" type="integer" xref="S4.SS7.p1.1.m1.1.1">30</cn><cn id="S4.SS7.p1.1.m1.2.2.cmml" type="integer" xref="S4.SS7.p1.1.m1.2.2">50</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS7.p1.1.m1.2c">\sigma\in\mathcal{U}[30,50]</annotation><annotation encoding="application/x-llamapun" id="S4.SS7.p1.1.m1.2d">italic_σ ∈ caligraphic_U [ 30 , 50 ]</annotation></semantics></math> to train <span class="ltx_text ltx_font_smallcaps" id="S4.SS7.p1.10.3">turtle</span>, and test on two noise levels <math alttext="\sigma=30" class="ltx_Math" display="inline" id="S4.SS7.p1.2.m2.1"><semantics id="S4.SS7.p1.2.m2.1a"><mrow id="S4.SS7.p1.2.m2.1.1" xref="S4.SS7.p1.2.m2.1.1.cmml"><mi id="S4.SS7.p1.2.m2.1.1.2" xref="S4.SS7.p1.2.m2.1.1.2.cmml">σ</mi><mo id="S4.SS7.p1.2.m2.1.1.1" xref="S4.SS7.p1.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS7.p1.2.m2.1.1.3" xref="S4.SS7.p1.2.m2.1.1.3.cmml">30</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS7.p1.2.m2.1b"><apply id="S4.SS7.p1.2.m2.1.1.cmml" xref="S4.SS7.p1.2.m2.1.1"><eq id="S4.SS7.p1.2.m2.1.1.1.cmml" xref="S4.SS7.p1.2.m2.1.1.1"></eq><ci id="S4.SS7.p1.2.m2.1.1.2.cmml" xref="S4.SS7.p1.2.m2.1.1.2">𝜎</ci><cn id="S4.SS7.p1.2.m2.1.1.3.cmml" type="integer" xref="S4.SS7.p1.2.m2.1.1.3">30</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS7.p1.2.m2.1c">\sigma=30</annotation><annotation encoding="application/x-llamapun" id="S4.SS7.p1.2.m2.1d">italic_σ = 30</annotation></semantics></math>, and <math alttext="\sigma=50" class="ltx_Math" display="inline" id="S4.SS7.p1.3.m3.1"><semantics id="S4.SS7.p1.3.m3.1a"><mrow id="S4.SS7.p1.3.m3.1.1" xref="S4.SS7.p1.3.m3.1.1.cmml"><mi id="S4.SS7.p1.3.m3.1.1.2" xref="S4.SS7.p1.3.m3.1.1.2.cmml">σ</mi><mo id="S4.SS7.p1.3.m3.1.1.1" xref="S4.SS7.p1.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS7.p1.3.m3.1.1.3" xref="S4.SS7.p1.3.m3.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS7.p1.3.m3.1b"><apply id="S4.SS7.p1.3.m3.1.1.cmml" xref="S4.SS7.p1.3.m3.1.1"><eq id="S4.SS7.p1.3.m3.1.1.1.cmml" xref="S4.SS7.p1.3.m3.1.1.1"></eq><ci id="S4.SS7.p1.3.m3.1.1.2.cmml" xref="S4.SS7.p1.3.m3.1.1.2">𝜎</ci><cn id="S4.SS7.p1.3.m3.1.1.3.cmml" type="integer" xref="S4.SS7.p1.3.m3.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS7.p1.3.m3.1c">\sigma=50</annotation><annotation encoding="application/x-llamapun" id="S4.SS7.p1.3.m3.1d">italic_σ = 50</annotation></semantics></math>; scores are reported in <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S4.T7" title="In 4.3 Real Video Deblurring ‣ 4 Experiments ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">table</span> <span class="ltx_text ltx_ref_tag">7</span></a>. <span class="ltx_text ltx_font_smallcaps" id="S4.SS7.p1.10.4">turtle</span> observes a gain of <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.SS7.p1.10.5" style="color:#007F73;">+0.31</span> dB on <math alttext="\sigma=30" class="ltx_Math" display="inline" id="S4.SS7.p1.5.m5.1"><semantics id="S4.SS7.p1.5.m5.1a"><mrow id="S4.SS7.p1.5.m5.1.1" xref="S4.SS7.p1.5.m5.1.1.cmml"><mi id="S4.SS7.p1.5.m5.1.1.2" xref="S4.SS7.p1.5.m5.1.1.2.cmml">σ</mi><mo id="S4.SS7.p1.5.m5.1.1.1" xref="S4.SS7.p1.5.m5.1.1.1.cmml">=</mo><mn id="S4.SS7.p1.5.m5.1.1.3" xref="S4.SS7.p1.5.m5.1.1.3.cmml">30</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS7.p1.5.m5.1b"><apply id="S4.SS7.p1.5.m5.1.1.cmml" xref="S4.SS7.p1.5.m5.1.1"><eq id="S4.SS7.p1.5.m5.1.1.1.cmml" xref="S4.SS7.p1.5.m5.1.1.1"></eq><ci id="S4.SS7.p1.5.m5.1.1.2.cmml" xref="S4.SS7.p1.5.m5.1.1.2">𝜎</ci><cn id="S4.SS7.p1.5.m5.1.1.3.cmml" type="integer" xref="S4.SS7.p1.5.m5.1.1.3">30</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS7.p1.5.m5.1c">\sigma=30</annotation><annotation encoding="application/x-llamapun" id="S4.SS7.p1.5.m5.1d">italic_σ = 30</annotation></semantics></math>, and <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.SS7.p1.10.6" style="color:#007F73;">+0.34</span> dB on <math alttext="\sigma=50" class="ltx_Math" display="inline" id="S4.SS7.p1.7.m7.1"><semantics id="S4.SS7.p1.7.m7.1a"><mrow id="S4.SS7.p1.7.m7.1.1" xref="S4.SS7.p1.7.m7.1.1.cmml"><mi id="S4.SS7.p1.7.m7.1.1.2" xref="S4.SS7.p1.7.m7.1.1.2.cmml">σ</mi><mo id="S4.SS7.p1.7.m7.1.1.1" xref="S4.SS7.p1.7.m7.1.1.1.cmml">=</mo><mn id="S4.SS7.p1.7.m7.1.1.3" xref="S4.SS7.p1.7.m7.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS7.p1.7.m7.1b"><apply id="S4.SS7.p1.7.m7.1.1.cmml" xref="S4.SS7.p1.7.m7.1.1"><eq id="S4.SS7.p1.7.m7.1.1.1.cmml" xref="S4.SS7.p1.7.m7.1.1.1"></eq><ci id="S4.SS7.p1.7.m7.1.1.2.cmml" xref="S4.SS7.p1.7.m7.1.1.2">𝜎</ci><cn id="S4.SS7.p1.7.m7.1.1.3.cmml" type="integer" xref="S4.SS7.p1.7.m7.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS7.p1.7.m7.1c">\sigma=50</annotation><annotation encoding="application/x-llamapun" id="S4.SS7.p1.7.m7.1d">italic_σ = 50</annotation></semantics></math> on Set8 testset, scoring <span class="ltx_text" id="S4.SS7.p1.8.1"><math alttext="32.22" class="ltx_Math" display="inline" id="S4.SS7.p1.8.1.m1.1" style="background-color:#D1E9F6;"><semantics id="S4.SS7.p1.8.1.m1.1a"><mn id="S4.SS7.p1.8.1.m1.1.1" mathbackground="#D1E9F6" xref="S4.SS7.p1.8.1.m1.1.1.cmml">32.22</mn><annotation-xml encoding="MathML-Content" id="S4.SS7.p1.8.1.m1.1b"><cn id="S4.SS7.p1.8.1.m1.1.1.cmml" type="float" xref="S4.SS7.p1.8.1.m1.1.1">32.22</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS7.p1.8.1.m1.1c">32.22</annotation><annotation encoding="application/x-llamapun" id="S4.SS7.p1.8.1.m1.1d">32.22</annotation></semantics></math></span> dB, and <span class="ltx_text" id="S4.SS7.p1.9.2"><math alttext="30.29" class="ltx_Math" display="inline" id="S4.SS7.p1.9.2.m1.1" style="background-color:#D1E9F6;"><semantics id="S4.SS7.p1.9.2.m1.1a"><mn id="S4.SS7.p1.9.2.m1.1.1" mathbackground="#D1E9F6" xref="S4.SS7.p1.9.2.m1.1.1.cmml">30.29</mn><annotation-xml encoding="MathML-Content" id="S4.SS7.p1.9.2.m1.1b"><cn id="S4.SS7.p1.9.2.m1.1.1.cmml" type="float" xref="S4.SS7.p1.9.2.m1.1.1">30.29</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS7.p1.9.2.m1.1c">30.29</annotation><annotation encoding="application/x-llamapun" id="S4.SS7.p1.9.2.m1.1d">30.29</annotation></semantics></math></span> dB, respectively, while it observes an average drop of <math alttext="-0.3" class="ltx_Math" display="inline" id="S4.SS7.p1.10.m8.1"><semantics id="S4.SS7.p1.10.m8.1a"><mrow id="S4.SS7.p1.10.m8.1.1" xref="S4.SS7.p1.10.m8.1.1.cmml"><mo id="S4.SS7.p1.10.m8.1.1a" xref="S4.SS7.p1.10.m8.1.1.cmml">−</mo><mn id="S4.SS7.p1.10.m8.1.1.2" xref="S4.SS7.p1.10.m8.1.1.2.cmml">0.3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS7.p1.10.m8.1b"><apply id="S4.SS7.p1.10.m8.1.1.cmml" xref="S4.SS7.p1.10.m8.1.1"><minus id="S4.SS7.p1.10.m8.1.1.1.cmml" xref="S4.SS7.p1.10.m8.1.1"></minus><cn id="S4.SS7.p1.10.m8.1.1.2.cmml" type="float" xref="S4.SS7.p1.10.m8.1.1.2">0.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS7.p1.10.m8.1c">-0.3</annotation><annotation encoding="application/x-llamapun" id="S4.SS7.p1.10.m8.1d">- 0.3</annotation></semantics></math> dB to BSVD-64 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib49" title="">49</a>]</cite> on the DAVIS testset. Further, we present qualitative results in <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S4.F5" title="In 4.7 Blind Video Denoising ‣ 4 Experiments ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">5</span></a> comparing <span class="ltx_text ltx_font_smallcaps" id="S4.SS7.p1.10.7">turtle</span>, and previous best method BSVD <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib49" title="">49</a>]</cite>.</p>
</div>
<figure class="ltx_figure" id="S4.F5">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.F5.1" style="width:413.7pt;height:131.3pt;vertical-align:-0.9pt;"><span class="ltx_transformed_inner" style="transform:translate(-10.9pt,3.4pt) scale(0.95,0.95) ;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="263" id="S4.F5.1.g1" src="x5.png" width="830"/>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span><span class="ltx_text ltx_font_bold" id="S4.F5.11.1">Blind Video Denoising and Video Super-Resolution Visual Results.</span> Qualitative comparison of previous methods with <span class="ltx_text ltx_font_smallcaps" id="S4.F5.12.2">turtle</span> on a test frame from Set8 dataset for blind video denoising (<math alttext="\sigma=50" class="ltx_Math" display="inline" id="S4.F5.4.m1.1"><semantics id="S4.F5.4.m1.1b"><mrow id="S4.F5.4.m1.1.1" xref="S4.F5.4.m1.1.1.cmml"><mi id="S4.F5.4.m1.1.1.2" xref="S4.F5.4.m1.1.1.2.cmml">σ</mi><mo id="S4.F5.4.m1.1.1.1" xref="S4.F5.4.m1.1.1.1.cmml">=</mo><mn id="S4.F5.4.m1.1.1.3" xref="S4.F5.4.m1.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F5.4.m1.1c"><apply id="S4.F5.4.m1.1.1.cmml" xref="S4.F5.4.m1.1.1"><eq id="S4.F5.4.m1.1.1.1.cmml" xref="S4.F5.4.m1.1.1.1"></eq><ci id="S4.F5.4.m1.1.1.2.cmml" xref="S4.F5.4.m1.1.1.2">𝜎</ci><cn id="S4.F5.4.m1.1.1.3.cmml" type="integer" xref="S4.F5.4.m1.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.4.m1.1d">\sigma=50</annotation><annotation encoding="application/x-llamapun" id="S4.F5.4.m1.1e">italic_σ = 50</annotation></semantics></math>), and MVSR<math alttext="4\times" class="ltx_math_unparsed" display="inline" id="S4.F5.5.m2.1"><semantics id="S4.F5.5.m2.1b"><mrow id="S4.F5.5.m2.1c"><mn id="S4.F5.5.m2.1.1">4</mn><mo id="S4.F5.5.m2.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S4.F5.5.m2.1d">4\times</annotation><annotation encoding="application/x-llamapun" id="S4.F5.5.m2.1e">4 ×</annotation></semantics></math> dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib71" title="">71</a>]</cite> for video super resolution. In video denoising, <span class="ltx_text ltx_font_smallcaps" id="S4.F5.13.3">turtle</span> restores details, while BSVD-64 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib49" title="">49</a>]</cite> smudges textures (<span class="ltx_text" id="S4.F5.14.4" style="color:#FF0000;">text and the dinosaur on the biker’s jacket</span>). In VSR, previous methods such as TTVSR <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib37" title="">37</a>]</cite>, BasicVSR++ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib7" title="">7</a>]</cite>, or EAVSR <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib71" title="">71</a>]</cite> tend to introduce blur in results, while <span class="ltx_text ltx_font_smallcaps" id="S4.F5.15.5">turtle</span>’s restored results are sharper, and crisper.</figcaption>
</figure>
<figure class="ltx_table" id="S4.T8">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 8: </span><span class="ltx_text ltx_font_bold" id="S4.T8.11.1">MACs (G) Comparison.</span> We report MACs (G) of <span class="ltx_text ltx_font_smallcaps" id="S4.T8.12.2">turtle</span>, and compare with previous methods in literature. We also extensively profile <span class="ltx_text ltx_font_smallcaps" id="S4.T8.13.3">turtle</span> with varying input resolutions on a single GPU, and compare it with previous restoration methods in <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A5" title="Appendix E Computational Profile of Turtle ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">appendix</span> <span class="ltx_text ltx_ref_tag">E</span></a>.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T8.7" style="width:423.0pt;height:123.2pt;vertical-align:-0.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-37.3pt,10.8pt) scale(0.85,0.85) ;">
<table class="ltx_tabular ltx_align_middle" id="S4.T8.7.7">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T8.1.1.1">
<td class="ltx_td ltx_align_left ltx_border_tt" id="S4.T8.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S4.T8.1.1.1.2.1">Method</span></td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="S4.T8.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S4.T8.1.1.1.3.1">Venue</span></td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="S4.T8.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S4.T8.1.1.1.4.1">Task</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_tt" id="S4.T8.1.1.1.1">
<span class="ltx_text ltx_font_bold" id="S4.T8.1.1.1.1.1">MACs (G)</span> <math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T8.1.1.1.1.m1.1"><semantics id="S4.T8.1.1.1.1.m1.1a"><mo id="S4.T8.1.1.1.1.m1.1.1" stretchy="false" xref="S4.T8.1.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T8.1.1.1.1.m1.1b"><ci id="S4.T8.1.1.1.1.m1.1.1.cmml" xref="S4.T8.1.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T8.1.1.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T8.1.1.1.1.m1.1d">↓</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T8.2.2.2">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T8.2.2.2.2">RVRT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib33" title="">33</a>]</cite>
</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T8.2.2.2.3">NeurIPS’22</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T8.2.2.2.4">Restoration</td>
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t" id="S4.T8.2.2.2.1"><math alttext="1182.16" class="ltx_Math" display="inline" id="S4.T8.2.2.2.1.m1.1"><semantics id="S4.T8.2.2.2.1.m1.1a"><mn id="S4.T8.2.2.2.1.m1.1.1" xref="S4.T8.2.2.2.1.m1.1.1.cmml">1182.16</mn><annotation-xml encoding="MathML-Content" id="S4.T8.2.2.2.1.m1.1b"><cn id="S4.T8.2.2.2.1.m1.1.1.cmml" type="float" xref="S4.T8.2.2.2.1.m1.1.1">1182.16</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T8.2.2.2.1.m1.1c">1182.16</annotation><annotation encoding="application/x-llamapun" id="S4.T8.2.2.2.1.m1.1d">1182.16</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T8.3.3.3">
<td class="ltx_td ltx_align_left" id="S4.T8.3.3.3.2">VRT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib34" title="">34</a>]</cite>
</td>
<td class="ltx_td ltx_align_left" id="S4.T8.3.3.3.3">TIP’24</td>
<td class="ltx_td ltx_align_left" id="S4.T8.3.3.3.4">Restoration</td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T8.3.3.3.1"><math alttext="1631.67" class="ltx_Math" display="inline" id="S4.T8.3.3.3.1.m1.1"><semantics id="S4.T8.3.3.3.1.m1.1a"><mn id="S4.T8.3.3.3.1.m1.1.1" xref="S4.T8.3.3.3.1.m1.1.1.cmml">1631.67</mn><annotation-xml encoding="MathML-Content" id="S4.T8.3.3.3.1.m1.1b"><cn id="S4.T8.3.3.3.1.m1.1.1.cmml" type="float" xref="S4.T8.3.3.3.1.m1.1.1">1631.67</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T8.3.3.3.1.m1.1c">1631.67</annotation><annotation encoding="application/x-llamapun" id="S4.T8.3.3.3.1.m1.1d">1631.67</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T8.4.4.4">
<td class="ltx_td ltx_align_left" id="S4.T8.4.4.4.2">RDDNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib68" title="">68</a>]</cite>
</td>
<td class="ltx_td ltx_align_left" id="S4.T8.4.4.4.3">ECCV’22</td>
<td class="ltx_td ltx_align_left" id="S4.T8.4.4.4.4">Deraining</td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T8.4.4.4.1"><math alttext="362.36" class="ltx_Math" display="inline" id="S4.T8.4.4.4.1.m1.1"><semantics id="S4.T8.4.4.4.1.m1.1a"><mn id="S4.T8.4.4.4.1.m1.1.1" xref="S4.T8.4.4.4.1.m1.1.1.cmml">362.36</mn><annotation-xml encoding="MathML-Content" id="S4.T8.4.4.4.1.m1.1b"><cn id="S4.T8.4.4.4.1.m1.1.1.cmml" type="float" xref="S4.T8.4.4.4.1.m1.1.1">362.36</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T8.4.4.4.1.m1.1c">362.36</annotation><annotation encoding="application/x-llamapun" id="S4.T8.4.4.4.1.m1.1d">362.36</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T8.5.5.5">
<td class="ltx_td ltx_align_left" id="S4.T8.5.5.5.2">DSTNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib45" title="">45</a>]</cite>
</td>
<td class="ltx_td ltx_align_left" id="S4.T8.5.5.5.3">CVPR’23</td>
<td class="ltx_td ltx_align_left" id="S4.T8.5.5.5.4">Deblurring</td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T8.5.5.5.1"><math alttext="720.28" class="ltx_Math" display="inline" id="S4.T8.5.5.5.1.m1.1"><semantics id="S4.T8.5.5.5.1.m1.1a"><mn id="S4.T8.5.5.5.1.m1.1.1" xref="S4.T8.5.5.5.1.m1.1.1.cmml">720.28</mn><annotation-xml encoding="MathML-Content" id="S4.T8.5.5.5.1.m1.1b"><cn id="S4.T8.5.5.5.1.m1.1.1.cmml" type="float" xref="S4.T8.5.5.5.1.m1.1.1">720.28</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T8.5.5.5.1.m1.1c">720.28</annotation><annotation encoding="application/x-llamapun" id="S4.T8.5.5.5.1.m1.1d">720.28</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T8.6.6.6">
<td class="ltx_td ltx_align_left" id="S4.T8.6.6.6.2">EDVR <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib69" title="">69</a>]</cite>
</td>
<td class="ltx_td ltx_align_left" id="S4.T8.6.6.6.3">CVPR’19</td>
<td class="ltx_td ltx_align_left" id="S4.T8.6.6.6.4">Deraining</td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T8.6.6.6.1"><math alttext="527.5" class="ltx_Math" display="inline" id="S4.T8.6.6.6.1.m1.1"><semantics id="S4.T8.6.6.6.1.m1.1a"><mn id="S4.T8.6.6.6.1.m1.1.1" xref="S4.T8.6.6.6.1.m1.1.1.cmml">527.5</mn><annotation-xml encoding="MathML-Content" id="S4.T8.6.6.6.1.m1.1b"><cn id="S4.T8.6.6.6.1.m1.1.1.cmml" type="float" xref="S4.T8.6.6.6.1.m1.1.1">527.5</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T8.6.6.6.1.m1.1c">527.5</annotation><annotation encoding="application/x-llamapun" id="S4.T8.6.6.6.1.m1.1d">527.5</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T8.7.7.7">
<td class="ltx_td ltx_align_left" id="S4.T8.7.7.7.2">BasicVSR <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib6" title="">6</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib7" title="">7</a>]</cite>
</td>
<td class="ltx_td ltx_align_left" id="S4.T8.7.7.7.3">CVPR’21</td>
<td class="ltx_td ltx_align_left" id="S4.T8.7.7.7.4">Super Resolution</td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T8.7.7.7.1"><math alttext="240.17" class="ltx_Math" display="inline" id="S4.T8.7.7.7.1.m1.1"><semantics id="S4.T8.7.7.7.1.m1.1a"><mn id="S4.T8.7.7.7.1.m1.1.1" xref="S4.T8.7.7.7.1.m1.1.1.cmml">240.17</mn><annotation-xml encoding="MathML-Content" id="S4.T8.7.7.7.1.m1.1b"><cn id="S4.T8.7.7.7.1.m1.1.1.cmml" type="float" xref="S4.T8.7.7.7.1.m1.1.1">240.17</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T8.7.7.7.1.m1.1c">240.17</annotation><annotation encoding="application/x-llamapun" id="S4.T8.7.7.7.1.m1.1d">240.17</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T8.7.7.8.1" style="background-color:#D1E9F6;">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_tt" id="S4.T8.7.7.8.1.1"><span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="S4.T8.7.7.8.1.1.1" style="background-color:#D1E9F6;">turtle</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_tt" id="S4.T8.7.7.8.1.2"><span class="ltx_text" id="S4.T8.7.7.8.1.2.1" style="background-color:#D1E9F6;">NeurIPS’24</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_tt" id="S4.T8.7.7.8.1.3"><span class="ltx_text" id="S4.T8.7.7.8.1.3.1" style="background-color:#D1E9F6;">Restoration</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb ltx_border_tt" id="S4.T8.7.7.8.1.4"><span class="ltx_text ltx_font_bold" id="S4.T8.7.7.8.1.4.1" style="background-color:#D1E9F6;">181.06</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS8">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.8 </span>Computational Cost Comparison</h3>
<div class="ltx_para" id="S4.SS8.p1">
<p class="ltx_p" id="S4.SS8.p1.1">In <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S4.T8" title="In 4.7 Blind Video Denoising ‣ 4 Experiments ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">table</span> <span class="ltx_text ltx_ref_tag">8</span></a>, we compare <span class="ltx_text ltx_font_smallcaps" id="S4.SS8.p1.1.1">turtle</span> with previous methods in the literature in terms of multiply-accumulate operations (MACs). The results are computed for the input size <math alttext="256\times 256" class="ltx_Math" display="inline" id="S4.SS8.p1.1.m1.1"><semantics id="S4.SS8.p1.1.m1.1a"><mrow id="S4.SS8.p1.1.m1.1.1" xref="S4.SS8.p1.1.m1.1.1.cmml"><mn id="S4.SS8.p1.1.m1.1.1.2" xref="S4.SS8.p1.1.m1.1.1.2.cmml">256</mn><mo id="S4.SS8.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS8.p1.1.m1.1.1.1.cmml">×</mo><mn id="S4.SS8.p1.1.m1.1.1.3" xref="S4.SS8.p1.1.m1.1.1.3.cmml">256</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS8.p1.1.m1.1b"><apply id="S4.SS8.p1.1.m1.1.1.cmml" xref="S4.SS8.p1.1.m1.1.1"><times id="S4.SS8.p1.1.m1.1.1.1.cmml" xref="S4.SS8.p1.1.m1.1.1.1"></times><cn id="S4.SS8.p1.1.m1.1.1.2.cmml" type="integer" xref="S4.SS8.p1.1.m1.1.1.2">256</cn><cn id="S4.SS8.p1.1.m1.1.1.3.cmml" type="integer" xref="S4.SS8.p1.1.m1.1.1.3">256</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS8.p1.1.m1.1c">256\times 256</annotation><annotation encoding="application/x-llamapun" id="S4.SS8.p1.1.m1.1d">256 × 256</annotation></semantics></math>. We measure the performance on the number of frames the original works utilized<span class="ltx_note ltx_role_footnote" id="footnote7"><sup class="ltx_note_mark">7</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">7</sup><span class="ltx_tag ltx_tag_note">7</span>or <math alttext="2" class="ltx_Math" display="inline" id="footnote7.m1.1"><semantics id="footnote7.m1.1b"><mn id="footnote7.m1.1.1" xref="footnote7.m1.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="footnote7.m1.1c"><cn id="footnote7.m1.1.1.cmml" type="integer" xref="footnote7.m1.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="footnote7.m1.1d">2</annotation><annotation encoding="application/x-llamapun" id="footnote7.m1.1e">2</annotation></semantics></math> frames if the actual number of frames did not fit into a single 32GB GPU</span></span></span> to report their performance, as reported in their manuscript or code bases. In <span class="ltx_text ltx_font_smallcaps" id="S4.SS8.p1.1.2">turtle</span>’s case, we report MACs (G) on a single frame since <span class="ltx_text ltx_font_smallcaps" id="S4.SS8.p1.1.3">turtle</span> only considers a single frame at a time but adjust for history features utilized in <span class="ltx_text ltx_font_sansserif" id="S4.SS8.p1.1.4">CHM</span> as part of <span class="ltx_text ltx_font_smallcaps" id="S4.SS8.p1.1.5">turtle</span>’s decoder. In comparison to parallel methods, EDVR <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib69" title="">69</a>]</cite>, VRT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib34" title="">34</a>]</cite>, <span class="ltx_text ltx_font_smallcaps" id="S4.SS8.p1.1.6">turtle</span> is computationally efficient, as it is lower in MACs (G). Although the MACs are approximately similar to recurrent methods, BasicVSR <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib6" title="">6</a>]</cite>, <span class="ltx_text ltx_font_smallcaps" id="S4.SS8.p1.1.7">turtle</span> scores significantly higher in PSNR/SSIM metrics (see <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S4.T7" title="In 4.3 Real Video Deblurring ‣ 4 Experiments ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">table</span> <span class="ltx_text ltx_ref_tag">7</span></a>, and <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S4.T5" title="In 4.1 Night Video Deraining ‣ 4 Experiments ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">table</span> <span class="ltx_text ltx_ref_tag">5</span></a>). In comparison to contemporary methods such as RVRT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib33" title="">33</a>]</cite>, which combines recurrence and parallelism in design, <span class="ltx_text ltx_font_smallcaps" id="S4.SS8.p1.1.8">turtle</span> is significantly lower on MACs (G) and performs better (see <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S4.T5" title="In 4.1 Night Video Deraining ‣ 4 Experiments ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">table</span> <span class="ltx_text ltx_ref_tag">5</span></a>, and <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S3.T2" title="In Frame History Router (𝜓). ‣ 3.2 Causal History Model ‣ 3 Methodology ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">table</span> <span class="ltx_text ltx_ref_tag">2</span></a>) thanks to its ability to memorize previous frames.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Ablation Study</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">We ablate <span class="ltx_text ltx_font_smallcaps" id="S5.p1.1.1">turtle</span> to understand what components necessitate efficiency and performance gains. All experiments are conducted on synthetic video deblurring task, GoPro dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib41" title="">41</a>]</cite>, using a smaller variant of our model. Our smaller models operate within a computational budget of approximately <math alttext="5" class="ltx_Math" display="inline" id="S5.p1.1.m1.1"><semantics id="S5.p1.1.m1.1a"><mn id="S5.p1.1.m1.1.1" xref="S5.p1.1.m1.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S5.p1.1.m1.1b"><cn id="S5.p1.1.m1.1.1.cmml" type="integer" xref="S5.p1.1.m1.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.1.m1.1c">5</annotation><annotation encoding="application/x-llamapun" id="S5.p1.1.m1.1d">5</annotation></semantics></math> MACs (G), while the remaining settings are the same as those of the main model. In all the cases, the combinations we adopt for <span class="ltx_text ltx_font_smallcaps" id="S5.p1.1.2">turtle</span> are <span class="ltx_text" id="S5.p1.1.3" style="background-color:#D1E9F6;">highlighted</span>. Additionally, we discuss the limitations of the proposed method in <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A2" title="Appendix B Limitations &amp; Discussion ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">appendix</span> <span class="ltx_text ltx_ref_tag">B</span></a>.</p>
</div>
<section class="ltx_paragraph" id="S5.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Block Configuration.</h4>
<div class="ltx_para" id="S5.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S5.SS0.SSS0.Px1.p1.2">We ablate the Causal History Model (<span class="ltx_text ltx_font_sansserif" id="S5.SS0.SSS0.Px1.p1.2.1">CHM</span>) to understand if learning from history benefits the restoration performance. We compare <span class="ltx_text ltx_font_smallcaps" id="S5.SS0.SSS0.Px1.p1.2.2">turtle</span> with two settings: baseline (no <span class="ltx_text ltx_font_sansserif" id="S5.SS0.SSS0.Px1.p1.2.3">CHM</span> block) and <span class="ltx_text ltx_font_smallcaps" id="S5.SS0.SSS0.Px1.p1.2.4">turtle</span> without State Align Block (<math alttext="\phi" class="ltx_Math" display="inline" id="S5.SS0.SSS0.Px1.p1.1.m1.1"><semantics id="S5.SS0.SSS0.Px1.p1.1.m1.1a"><mi id="S5.SS0.SSS0.Px1.p1.1.m1.1.1" xref="S5.SS0.SSS0.Px1.p1.1.m1.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px1.p1.1.m1.1b"><ci id="S5.SS0.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S5.SS0.SSS0.Px1.p1.1.m1.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px1.p1.1.m1.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="S5.SS0.SSS0.Px1.p1.1.m1.1d">italic_ϕ</annotation></semantics></math>). In baseline (no <span class="ltx_text ltx_font_sansserif" id="S5.SS0.SSS0.Px1.p1.2.5">CHM</span>), no history states are considered, and two frames are concatenated and fed to the network directly. Further, in No <math alttext="\phi" class="ltx_Math" display="inline" id="S5.SS0.SSS0.Px1.p1.2.m2.1"><semantics id="S5.SS0.SSS0.Px1.p1.2.m2.1a"><mi id="S5.SS0.SSS0.Px1.p1.2.m2.1.1" xref="S5.SS0.SSS0.Px1.p1.2.m2.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px1.p1.2.m2.1b"><ci id="S5.SS0.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S5.SS0.SSS0.Px1.p1.2.m2.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px1.p1.2.m2.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="S5.SS0.SSS0.Px1.p1.2.m2.1d">italic_ϕ</annotation></semantics></math>, the state align block is removed from <span class="ltx_text ltx_font_sansserif" id="S5.SS0.SSS0.Px1.p1.2.6">CHM</span>. We detail the results in <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S5.T11" title="In Value of 𝑘 in topk. ‣ 5 Ablation Study ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">table</span> <span class="ltx_text ltx_ref_tag">11</span></a>, and find that both State Align Block, and <span class="ltx_text ltx_font_sansserif" id="S5.SS0.SSS0.Px1.p1.2.7">CHM</span> are important to the observed performance gains.</p>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS0.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Truncation Factor <math alttext="\tau" class="ltx_Math" display="inline" id="S5.SS0.SSS0.Px2.1.m1.1"><semantics id="S5.SS0.SSS0.Px2.1.m1.1b"><mi id="S5.SS0.SSS0.Px2.1.m1.1.1" xref="S5.SS0.SSS0.Px2.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px2.1.m1.1c"><ci id="S5.SS0.SSS0.Px2.1.m1.1.1.cmml" xref="S5.SS0.SSS0.Px2.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px2.1.m1.1d">\tau</annotation><annotation encoding="application/x-llamapun" id="S5.SS0.SSS0.Px2.1.m1.1e">italic_τ</annotation></semantics></math>.</h4>
<div class="ltx_para" id="S5.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="S5.SS0.SSS0.Px2.p1.4">We evaluate context lengths of <math alttext="\tau=" class="ltx_Math" display="inline" id="S5.SS0.SSS0.Px2.p1.1.m1.1"><semantics id="S5.SS0.SSS0.Px2.p1.1.m1.1a"><mrow id="S5.SS0.SSS0.Px2.p1.1.m1.1.1" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="S5.SS0.SSS0.Px2.p1.1.m1.1.1.2" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.1.2.cmml">τ</mi><mo id="S5.SS0.SSS0.Px2.p1.1.m1.1.1.1" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.1.1.cmml">=</mo><mi id="S5.SS0.SSS0.Px2.p1.1.m1.1.1.3" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px2.p1.1.m1.1b"><apply id="S5.SS0.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.1"><eq id="S5.SS0.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.1.1"></eq><ci id="S5.SS0.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.1.2">𝜏</ci><csymbol cd="latexml" id="S5.SS0.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px2.p1.1.m1.1c">\tau=</annotation><annotation encoding="application/x-llamapun" id="S5.SS0.SSS0.Px2.p1.1.m1.1d">italic_τ =</annotation></semantics></math> <math alttext="1" class="ltx_Math" display="inline" id="S5.SS0.SSS0.Px2.p1.2.m2.1"><semantics id="S5.SS0.SSS0.Px2.p1.2.m2.1a"><mn id="S5.SS0.SSS0.Px2.p1.2.m2.1.1" xref="S5.SS0.SSS0.Px2.p1.2.m2.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px2.p1.2.m2.1b"><cn id="S5.SS0.SSS0.Px2.p1.2.m2.1.1.cmml" type="integer" xref="S5.SS0.SSS0.Px2.p1.2.m2.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px2.p1.2.m2.1c">1</annotation><annotation encoding="application/x-llamapun" id="S5.SS0.SSS0.Px2.p1.2.m2.1d">1</annotation></semantics></math>, <math alttext="3" class="ltx_Math" display="inline" id="S5.SS0.SSS0.Px2.p1.3.m3.1"><semantics id="S5.SS0.SSS0.Px2.p1.3.m3.1a"><mn id="S5.SS0.SSS0.Px2.p1.3.m3.1.1" xref="S5.SS0.SSS0.Px2.p1.3.m3.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px2.p1.3.m3.1b"><cn id="S5.SS0.SSS0.Px2.p1.3.m3.1.1.cmml" type="integer" xref="S5.SS0.SSS0.Px2.p1.3.m3.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px2.p1.3.m3.1c">3</annotation><annotation encoding="application/x-llamapun" id="S5.SS0.SSS0.Px2.p1.3.m3.1d">3</annotation></semantics></math>, and <math alttext="5" class="ltx_Math" display="inline" id="S5.SS0.SSS0.Px2.p1.4.m4.1"><semantics id="S5.SS0.SSS0.Px2.p1.4.m4.1a"><mn id="S5.SS0.SSS0.Px2.p1.4.m4.1.1" xref="S5.SS0.SSS0.Px2.p1.4.m4.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px2.p1.4.m4.1b"><cn id="S5.SS0.SSS0.Px2.p1.4.m4.1.1.cmml" type="integer" xref="S5.SS0.SSS0.Px2.p1.4.m4.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px2.p1.4.m4.1c">5</annotation><annotation encoding="application/x-llamapun" id="S5.SS0.SSS0.Px2.p1.4.m4.1d">5</annotation></semantics></math> past frames and found no PSNR improvement when increasing the context length beyond three frames. Results in <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S5.T11" title="In Value of 𝑘 in topk. ‣ 5 Ablation Study ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">table</span> <span class="ltx_text ltx_ref_tag">11</span></a> confirm that extending beyond three frames does not benefit performance. This is because, as in most cases, the missing information in the current frame is typically covered within the three-frame span, and additional explicit frame information fails to provide additional relevant details.</p>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS0.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">Value of <math alttext="k" class="ltx_Math" display="inline" id="S5.SS0.SSS0.Px3.1.m1.1"><semantics id="S5.SS0.SSS0.Px3.1.m1.1b"><mi id="S5.SS0.SSS0.Px3.1.m1.1.1" xref="S5.SS0.SSS0.Px3.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px3.1.m1.1c"><ci id="S5.SS0.SSS0.Px3.1.m1.1.1.cmml" xref="S5.SS0.SSS0.Px3.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px3.1.m1.1d">k</annotation><annotation encoding="application/x-llamapun" id="S5.SS0.SSS0.Px3.1.m1.1e">italic_k</annotation></semantics></math> in <span class="ltx_text ltx_font_italic" id="S5.SS0.SSS0.Px3.2.1">topk</span>.</h4>
<div class="ltx_para" id="S5.SS0.SSS0.Px3.p1">
<p class="ltx_p" id="S5.SS0.SSS0.Px3.p1.5">We investigate the effects of different <math alttext="k" class="ltx_Math" display="inline" id="S5.SS0.SSS0.Px3.p1.1.m1.1"><semantics id="S5.SS0.SSS0.Px3.p1.1.m1.1a"><mi id="S5.SS0.SSS0.Px3.p1.1.m1.1.1" xref="S5.SS0.SSS0.Px3.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px3.p1.1.m1.1b"><ci id="S5.SS0.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S5.SS0.SSS0.Px3.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px3.p1.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S5.SS0.SSS0.Px3.p1.1.m1.1d">italic_k</annotation></semantics></math> values in <span class="ltx_text ltx_font_italic" id="S5.SS0.SSS0.Px3.p1.5.1">topk</span> attention. Our experiments, detailed in <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S5.T11" title="In Value of 𝑘 in topk. ‣ 5 Ablation Study ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">table</span> <span class="ltx_text ltx_ref_tag">11</span></a>, show that <math alttext="k" class="ltx_Math" display="inline" id="S5.SS0.SSS0.Px3.p1.2.m2.1"><semantics id="S5.SS0.SSS0.Px3.p1.2.m2.1a"><mi id="S5.SS0.SSS0.Px3.p1.2.m2.1.1" xref="S5.SS0.SSS0.Px3.p1.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px3.p1.2.m2.1b"><ci id="S5.SS0.SSS0.Px3.p1.2.m2.1.1.cmml" xref="S5.SS0.SSS0.Px3.p1.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px3.p1.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S5.SS0.SSS0.Px3.p1.2.m2.1d">italic_k</annotation></semantics></math> crucially affects restoration quality. Utilizing a larger number of patches, <math alttext="k=20" class="ltx_Math" display="inline" id="S5.SS0.SSS0.Px3.p1.3.m3.1"><semantics id="S5.SS0.SSS0.Px3.p1.3.m3.1a"><mrow id="S5.SS0.SSS0.Px3.p1.3.m3.1.1" xref="S5.SS0.SSS0.Px3.p1.3.m3.1.1.cmml"><mi id="S5.SS0.SSS0.Px3.p1.3.m3.1.1.2" xref="S5.SS0.SSS0.Px3.p1.3.m3.1.1.2.cmml">k</mi><mo id="S5.SS0.SSS0.Px3.p1.3.m3.1.1.1" xref="S5.SS0.SSS0.Px3.p1.3.m3.1.1.1.cmml">=</mo><mn id="S5.SS0.SSS0.Px3.p1.3.m3.1.1.3" xref="S5.SS0.SSS0.Px3.p1.3.m3.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px3.p1.3.m3.1b"><apply id="S5.SS0.SSS0.Px3.p1.3.m3.1.1.cmml" xref="S5.SS0.SSS0.Px3.p1.3.m3.1.1"><eq id="S5.SS0.SSS0.Px3.p1.3.m3.1.1.1.cmml" xref="S5.SS0.SSS0.Px3.p1.3.m3.1.1.1"></eq><ci id="S5.SS0.SSS0.Px3.p1.3.m3.1.1.2.cmml" xref="S5.SS0.SSS0.Px3.p1.3.m3.1.1.2">𝑘</ci><cn id="S5.SS0.SSS0.Px3.p1.3.m3.1.1.3.cmml" type="integer" xref="S5.SS0.SSS0.Px3.p1.3.m3.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px3.p1.3.m3.1c">k=20</annotation><annotation encoding="application/x-llamapun" id="S5.SS0.SSS0.Px3.p1.3.m3.1d">italic_k = 20</annotation></semantics></math>, leads to an accumulation of irrelevant information, negatively impacting performance by adding unnecessary noise. Further, selecting only <math alttext="1" class="ltx_Math" display="inline" id="S5.SS0.SSS0.Px3.p1.4.m4.1"><semantics id="S5.SS0.SSS0.Px3.p1.4.m4.1a"><mn id="S5.SS0.SSS0.Px3.p1.4.m4.1.1" xref="S5.SS0.SSS0.Px3.p1.4.m4.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px3.p1.4.m4.1b"><cn id="S5.SS0.SSS0.Px3.p1.4.m4.1.1.cmml" type="integer" xref="S5.SS0.SSS0.Px3.p1.4.m4.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px3.p1.4.m4.1c">1</annotation><annotation encoding="application/x-llamapun" id="S5.SS0.SSS0.Px3.p1.4.m4.1d">1</annotation></semantics></math> patch is also sub-optimal as the degraded nature of inputs can lead to inaccuracies in identifying the most similar patch, missing vital contextual information. The optimal balance was found empirically with <math alttext="k=5" class="ltx_Math" display="inline" id="S5.SS0.SSS0.Px3.p1.5.m5.1"><semantics id="S5.SS0.SSS0.Px3.p1.5.m5.1a"><mrow id="S5.SS0.SSS0.Px3.p1.5.m5.1.1" xref="S5.SS0.SSS0.Px3.p1.5.m5.1.1.cmml"><mi id="S5.SS0.SSS0.Px3.p1.5.m5.1.1.2" xref="S5.SS0.SSS0.Px3.p1.5.m5.1.1.2.cmml">k</mi><mo id="S5.SS0.SSS0.Px3.p1.5.m5.1.1.1" xref="S5.SS0.SSS0.Px3.p1.5.m5.1.1.1.cmml">=</mo><mn id="S5.SS0.SSS0.Px3.p1.5.m5.1.1.3" xref="S5.SS0.SSS0.Px3.p1.5.m5.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px3.p1.5.m5.1b"><apply id="S5.SS0.SSS0.Px3.p1.5.m5.1.1.cmml" xref="S5.SS0.SSS0.Px3.p1.5.m5.1.1"><eq id="S5.SS0.SSS0.Px3.p1.5.m5.1.1.1.cmml" xref="S5.SS0.SSS0.Px3.p1.5.m5.1.1.1"></eq><ci id="S5.SS0.SSS0.Px3.p1.5.m5.1.1.2.cmml" xref="S5.SS0.SSS0.Px3.p1.5.m5.1.1.2">𝑘</ci><cn id="S5.SS0.SSS0.Px3.p1.5.m5.1.1.3.cmml" type="integer" xref="S5.SS0.SSS0.Px3.p1.5.m5.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px3.p1.5.m5.1c">k=5</annotation><annotation encoding="application/x-llamapun" id="S5.SS0.SSS0.Px3.p1.5.m5.1d">italic_k = 5</annotation></semantics></math>, which effectively minimizes noise while ensuring the inclusion of key information.</p>
</div>
<figure class="ltx_table" id="S5.T11">
<div class="ltx_flex_figure ltx_flex_table">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_middle" id="S5.T11.2" style="width:130.1pt;">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Table 9: </span><span class="ltx_text ltx_font_bold" id="S5.T11.2.4.1">State Align Block.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T11.2.2">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T11.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S5.T11.1.1.1.2">
<table class="ltx_tabular ltx_align_middle" id="S5.T11.1.1.1.2.1">
<tr class="ltx_tr" id="S5.T11.1.1.1.2.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S5.T11.1.1.1.2.1.1.1"><span class="ltx_text ltx_font_bold" id="S5.T11.1.1.1.2.1.1.1.1">Block</span></td>
</tr>
<tr class="ltx_tr" id="S5.T11.1.1.1.2.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S5.T11.1.1.1.2.1.2.1"><span class="ltx_text ltx_font_bold" id="S5.T11.1.1.1.2.1.2.1.1">Configuration</span></td>
</tr>
</table>
</th>
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_tt" id="S5.T11.1.1.1.1">
<span class="ltx_text ltx_font_bold" id="S5.T11.1.1.1.1.1">PSNR</span> <math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T11.1.1.1.1.m1.1"><semantics id="S5.T11.1.1.1.1.m1.1a"><mo id="S5.T11.1.1.1.1.m1.1.1" stretchy="false" xref="S5.T11.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T11.1.1.1.1.m1.1b"><ci id="S5.T11.1.1.1.1.m1.1.1.cmml" xref="S5.T11.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T11.1.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T11.1.1.1.1.m1.1d">↑</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S5.T11.2.2.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T11.2.2.3.1.1">
<table class="ltx_tabular ltx_align_middle" id="S5.T11.2.2.3.1.1.1">
<tr class="ltx_tr" id="S5.T11.2.2.3.1.1.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S5.T11.2.2.3.1.1.1.1.1">No <span class="ltx_text ltx_font_sansserif" id="S5.T11.2.2.3.1.1.1.1.1.1">CHM</span>
</td>
</tr>
</table>
</th>
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t" id="S5.T11.2.2.3.1.2">31.84</td>
</tr>
<tr class="ltx_tr" id="S5.T11.2.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T11.2.2.2.1">
<table class="ltx_tabular ltx_align_middle" id="S5.T11.2.2.2.1.1">
<tr class="ltx_tr" id="S5.T11.2.2.2.1.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S5.T11.2.2.2.1.1.1.1">No <math alttext="\phi" class="ltx_Math" display="inline" id="S5.T11.2.2.2.1.1.1.1.m1.1"><semantics id="S5.T11.2.2.2.1.1.1.1.m1.1a"><mi id="S5.T11.2.2.2.1.1.1.1.m1.1.1" xref="S5.T11.2.2.2.1.1.1.1.m1.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S5.T11.2.2.2.1.1.1.1.m1.1b"><ci id="S5.T11.2.2.2.1.1.1.1.m1.1.1.cmml" xref="S5.T11.2.2.2.1.1.1.1.m1.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T11.2.2.2.1.1.1.1.m1.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="S5.T11.2.2.2.1.1.1.1.m1.1d">italic_ϕ</annotation></semantics></math>
</td>
</tr>
</table>
</th>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S5.T11.2.2.2.2">32.07</td>
</tr>
<tr class="ltx_tr" id="S5.T11.2.2.4.2" style="background-color:#D1E9F6;">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_tt" id="S5.T11.2.2.4.2.1"><span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="S5.T11.2.2.4.2.1.1" style="background-color:#D1E9F6;">turtle</span></th>
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb ltx_border_tt" id="S5.T11.2.2.4.2.2"><span class="ltx_text ltx_font_bold" id="S5.T11.2.2.4.2.2.1" style="background-color:#D1E9F6;">32.26</span></td>
</tr>
</tbody>
</table>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_middle" id="S5.T11.7" style="width:130.1pt;">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Table 10: </span><span class="ltx_text ltx_font_bold" id="S5.T11.7.7.1">Truncation Factor.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T11.7.5">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T11.4.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S5.T11.3.1.1.1">
<table class="ltx_tabular ltx_align_middle" id="S5.T11.3.1.1.1.1">
<tr class="ltx_tr" id="S5.T11.3.1.1.1.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S5.T11.3.1.1.1.1.2.1"><span class="ltx_text ltx_font_bold" id="S5.T11.3.1.1.1.1.2.1.1">Truncation</span></td>
</tr>
<tr class="ltx_tr" id="S5.T11.3.1.1.1.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S5.T11.3.1.1.1.1.1.1">
<span class="ltx_text ltx_font_bold" id="S5.T11.3.1.1.1.1.1.1.1">Factor</span> <math alttext="\tau" class="ltx_Math" display="inline" id="S5.T11.3.1.1.1.1.1.1.m1.1"><semantics id="S5.T11.3.1.1.1.1.1.1.m1.1a"><mi id="S5.T11.3.1.1.1.1.1.1.m1.1.1" xref="S5.T11.3.1.1.1.1.1.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S5.T11.3.1.1.1.1.1.1.m1.1b"><ci id="S5.T11.3.1.1.1.1.1.1.m1.1.1.cmml" xref="S5.T11.3.1.1.1.1.1.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T11.3.1.1.1.1.1.1.m1.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S5.T11.3.1.1.1.1.1.1.m1.1d">italic_τ</annotation></semantics></math>
</td>
</tr>
</table>
</th>
<th class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S5.T11.4.2.2.2">
<span class="ltx_text ltx_font_bold" id="S5.T11.4.2.2.2.1">PSNR</span> <math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T11.4.2.2.2.m1.1"><semantics id="S5.T11.4.2.2.2.m1.1a"><mo id="S5.T11.4.2.2.2.m1.1.1" stretchy="false" xref="S5.T11.4.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T11.4.2.2.2.m1.1b"><ci id="S5.T11.4.2.2.2.m1.1.1.cmml" xref="S5.T11.4.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T11.4.2.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T11.4.2.2.2.m1.1d">↑</annotation></semantics></math>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T11.5.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T11.5.3.3.1">
<table class="ltx_tabular ltx_align_middle" id="S5.T11.5.3.3.1.1">
<tr class="ltx_tr" id="S5.T11.5.3.3.1.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S5.T11.5.3.3.1.1.1.1"><math alttext="1" class="ltx_Math" display="inline" id="S5.T11.5.3.3.1.1.1.1.m1.1"><semantics id="S5.T11.5.3.3.1.1.1.1.m1.1a"><mn id="S5.T11.5.3.3.1.1.1.1.m1.1.1" xref="S5.T11.5.3.3.1.1.1.1.m1.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S5.T11.5.3.3.1.1.1.1.m1.1b"><cn id="S5.T11.5.3.3.1.1.1.1.m1.1.1.cmml" type="integer" xref="S5.T11.5.3.3.1.1.1.1.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T11.5.3.3.1.1.1.1.m1.1c">1</annotation><annotation encoding="application/x-llamapun" id="S5.T11.5.3.3.1.1.1.1.m1.1d">1</annotation></semantics></math></td>
</tr>
</table>
</th>
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t" id="S5.T11.5.3.3.2">32.15</td>
</tr>
<tr class="ltx_tr" id="S5.T11.6.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T11.6.4.4.1"><math alttext="5" class="ltx_Math" display="inline" id="S5.T11.6.4.4.1.m1.1"><semantics id="S5.T11.6.4.4.1.m1.1a"><mn id="S5.T11.6.4.4.1.m1.1.1" xref="S5.T11.6.4.4.1.m1.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S5.T11.6.4.4.1.m1.1b"><cn id="S5.T11.6.4.4.1.m1.1.1.cmml" type="integer" xref="S5.T11.6.4.4.1.m1.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T11.6.4.4.1.m1.1c">5</annotation><annotation encoding="application/x-llamapun" id="S5.T11.6.4.4.1.m1.1d">5</annotation></semantics></math></th>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S5.T11.6.4.4.2">32.26</td>
</tr>
<tr class="ltx_tr" id="S5.T11.7.5.5" style="background-color:#D1E9F6;">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_tt" id="S5.T11.7.5.5.1">
<span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="S5.T11.7.5.5.1.2" style="background-color:#D1E9F6;">turtle</span><span class="ltx_text" id="S5.T11.7.5.5.1.1" style="background-color:#D1E9F6;"> (<math alttext="\tau=3" class="ltx_Math" display="inline" id="S5.T11.7.5.5.1.1.m1.1"><semantics id="S5.T11.7.5.5.1.1.m1.1a"><mrow id="S5.T11.7.5.5.1.1.m1.1.1" xref="S5.T11.7.5.5.1.1.m1.1.1.cmml"><mi id="S5.T11.7.5.5.1.1.m1.1.1.2" mathbackground="#D1E9F6" xref="S5.T11.7.5.5.1.1.m1.1.1.2.cmml">τ</mi><mo id="S5.T11.7.5.5.1.1.m1.1.1.1" mathbackground="#D1E9F6" xref="S5.T11.7.5.5.1.1.m1.1.1.1.cmml">=</mo><mn id="S5.T11.7.5.5.1.1.m1.1.1.3" mathbackground="#D1E9F6" xref="S5.T11.7.5.5.1.1.m1.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T11.7.5.5.1.1.m1.1b"><apply id="S5.T11.7.5.5.1.1.m1.1.1.cmml" xref="S5.T11.7.5.5.1.1.m1.1.1"><eq id="S5.T11.7.5.5.1.1.m1.1.1.1.cmml" xref="S5.T11.7.5.5.1.1.m1.1.1.1"></eq><ci id="S5.T11.7.5.5.1.1.m1.1.1.2.cmml" xref="S5.T11.7.5.5.1.1.m1.1.1.2">𝜏</ci><cn id="S5.T11.7.5.5.1.1.m1.1.1.3.cmml" type="integer" xref="S5.T11.7.5.5.1.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T11.7.5.5.1.1.m1.1c">\tau=3</annotation><annotation encoding="application/x-llamapun" id="S5.T11.7.5.5.1.1.m1.1d">italic_τ = 3</annotation></semantics></math>)</span>
</th>
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb ltx_border_tt" id="S5.T11.7.5.5.2"><span class="ltx_text ltx_font_bold" id="S5.T11.7.5.5.2.1" style="background-color:#D1E9F6;">32.26</span></td>
</tr>
</tbody>
</table>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_middle" id="S5.T11.12" style="width:143.1pt;">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Table 11: </span><span class="ltx_text ltx_font_bold" id="S5.T11.12.8.1">Value of</span> <span class="ltx_text ltx_font_italic" id="S5.T11.12.9.2">topk</span>.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T11.12.5">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T11.9.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S5.T11.8.1.1.1">
<table class="ltx_tabular ltx_align_middle" id="S5.T11.8.1.1.1.1">
<tr class="ltx_tr" id="S5.T11.8.1.1.1.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S5.T11.8.1.1.1.1.1.1">
<span class="ltx_text ltx_font_bold" id="S5.T11.8.1.1.1.1.1.1.1">Value of</span> <math alttext="k" class="ltx_Math" display="inline" id="S5.T11.8.1.1.1.1.1.1.m1.1"><semantics id="S5.T11.8.1.1.1.1.1.1.m1.1a"><mi id="S5.T11.8.1.1.1.1.1.1.m1.1.1" xref="S5.T11.8.1.1.1.1.1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.T11.8.1.1.1.1.1.1.m1.1b"><ci id="S5.T11.8.1.1.1.1.1.1.m1.1.1.cmml" xref="S5.T11.8.1.1.1.1.1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T11.8.1.1.1.1.1.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S5.T11.8.1.1.1.1.1.1.m1.1d">italic_k</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S5.T11.8.1.1.1.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S5.T11.8.1.1.1.1.2.1">
<span class="ltx_text ltx_font_bold" id="S5.T11.8.1.1.1.1.2.1.1">in</span> <span class="ltx_text ltx_font_italic" id="S5.T11.8.1.1.1.1.2.1.2">topk</span>
</td>
</tr>
</table>
</th>
<th class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S5.T11.9.2.2.2">
<span class="ltx_text ltx_font_bold" id="S5.T11.9.2.2.2.1">PSNR</span> <math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T11.9.2.2.2.m1.1"><semantics id="S5.T11.9.2.2.2.m1.1a"><mo id="S5.T11.9.2.2.2.m1.1.1" stretchy="false" xref="S5.T11.9.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T11.9.2.2.2.m1.1b"><ci id="S5.T11.9.2.2.2.m1.1.1.cmml" xref="S5.T11.9.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T11.9.2.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T11.9.2.2.2.m1.1d">↑</annotation></semantics></math>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T11.10.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T11.10.3.3.1"><math alttext="1" class="ltx_Math" display="inline" id="S5.T11.10.3.3.1.m1.1"><semantics id="S5.T11.10.3.3.1.m1.1a"><mn id="S5.T11.10.3.3.1.m1.1.1" xref="S5.T11.10.3.3.1.m1.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S5.T11.10.3.3.1.m1.1b"><cn id="S5.T11.10.3.3.1.m1.1.1.cmml" type="integer" xref="S5.T11.10.3.3.1.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T11.10.3.3.1.m1.1c">1</annotation><annotation encoding="application/x-llamapun" id="S5.T11.10.3.3.1.m1.1d">1</annotation></semantics></math></th>
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t" id="S5.T11.10.3.3.2">32.18</td>
</tr>
<tr class="ltx_tr" id="S5.T11.11.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T11.11.4.4.1"><math alttext="20" class="ltx_Math" display="inline" id="S5.T11.11.4.4.1.m1.1"><semantics id="S5.T11.11.4.4.1.m1.1a"><mn id="S5.T11.11.4.4.1.m1.1.1" xref="S5.T11.11.4.4.1.m1.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="S5.T11.11.4.4.1.m1.1b"><cn id="S5.T11.11.4.4.1.m1.1.1.cmml" type="integer" xref="S5.T11.11.4.4.1.m1.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T11.11.4.4.1.m1.1c">20</annotation><annotation encoding="application/x-llamapun" id="S5.T11.11.4.4.1.m1.1d">20</annotation></semantics></math></th>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S5.T11.11.4.4.2">32.10</td>
</tr>
<tr class="ltx_tr" id="S5.T11.12.5.5" style="background-color:#D1E9F6;">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_tt" id="S5.T11.12.5.5.1">
<span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="S5.T11.12.5.5.1.2" style="background-color:#D1E9F6;">turtle</span><span class="ltx_text" id="S5.T11.12.5.5.1.1" style="background-color:#D1E9F6;"> (<math alttext="k=5" class="ltx_Math" display="inline" id="S5.T11.12.5.5.1.1.m1.1"><semantics id="S5.T11.12.5.5.1.1.m1.1a"><mrow id="S5.T11.12.5.5.1.1.m1.1.1" xref="S5.T11.12.5.5.1.1.m1.1.1.cmml"><mi id="S5.T11.12.5.5.1.1.m1.1.1.2" mathbackground="#D1E9F6" xref="S5.T11.12.5.5.1.1.m1.1.1.2.cmml">k</mi><mo id="S5.T11.12.5.5.1.1.m1.1.1.1" mathbackground="#D1E9F6" xref="S5.T11.12.5.5.1.1.m1.1.1.1.cmml">=</mo><mn id="S5.T11.12.5.5.1.1.m1.1.1.3" mathbackground="#D1E9F6" xref="S5.T11.12.5.5.1.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T11.12.5.5.1.1.m1.1b"><apply id="S5.T11.12.5.5.1.1.m1.1.1.cmml" xref="S5.T11.12.5.5.1.1.m1.1.1"><eq id="S5.T11.12.5.5.1.1.m1.1.1.1.cmml" xref="S5.T11.12.5.5.1.1.m1.1.1.1"></eq><ci id="S5.T11.12.5.5.1.1.m1.1.1.2.cmml" xref="S5.T11.12.5.5.1.1.m1.1.1.2">𝑘</ci><cn id="S5.T11.12.5.5.1.1.m1.1.1.3.cmml" type="integer" xref="S5.T11.12.5.5.1.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T11.12.5.5.1.1.m1.1c">k=5</annotation><annotation encoding="application/x-llamapun" id="S5.T11.12.5.5.1.1.m1.1d">italic_k = 5</annotation></semantics></math>)</span>
</th>
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb ltx_border_tt" id="S5.T11.12.5.5.2"><span class="ltx_text ltx_font_bold" id="S5.T11.12.5.5.2.1" style="background-color:#D1E9F6;">32.26</span></td>
</tr>
</tbody>
</table>
</figure>
</div>
</div>
</figure>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">In this work, we introduced a novel framework, <span class="ltx_text ltx_font_smallcaps" id="S6.p1.1.1">turtle</span>, for video restoration. <span class="ltx_text ltx_font_smallcaps" id="S6.p1.1.2">turtle</span> learns to restore any given frame by conditioning the restoration procedure on the frame history. Further, it compensates the history for motion with respect to the input and accentuates key information to benefit from temporal redundancies in the sequence. <span class="ltx_text ltx_font_smallcaps" id="S6.p1.1.3">turtle</span> enjoys training parallelism and maintains the entire frame history implicitly during inference. We evaluated the effectiveness of the proposed method and reported state-of-the-art results on seven video restoration tasks.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Arias and Morel [2018]</span>
<span class="ltx_bibblock">
P. Arias and J.-M. Morel.

</span>
<span class="ltx_bibblock">Video denoising via empirical bayesian estimation of space-time patches.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">Journal of Mathematical Imaging and Vision</em>, 60:70–93, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bardes et al. [2024]</span>
<span class="ltx_bibblock">
A. Bardes, Q. Garrido, J. Ponce, X. Chen, M. Rabbat, Y. LeCun, M. Assran, and N. Ballas.

</span>
<span class="ltx_bibblock">Revisiting feature prediction for learning visual representations from video.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">arXiv preprint arXiv:2404.08471</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Barron et al. [1994]</span>
<span class="ltx_bibblock">
J. L. Barron, D. J. Fleet, and S. S. Beauchemin.

</span>
<span class="ltx_bibblock">Performance of optical flow techniques.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">International journal of computer vision</em>, 12:43–77, 1994.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Caballero et al. [2017]</span>
<span class="ltx_bibblock">
J. Caballero, C. Ledig, A. Aitken, A. Acosta, J. Totz, Z. Wang, and W. Shi.

</span>
<span class="ltx_bibblock">Real-time video super-resolution with spatio-temporal networks and motion compensation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">Proceedings of the IEEE conference on computer vision and pattern recognition</em>, pages 4778–4787, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cao et al. [2021]</span>
<span class="ltx_bibblock">
J. Cao, Y. Li, K. Zhang, and L. Van Gool.

</span>
<span class="ltx_bibblock">Video super-resolution transformer.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">arXiv preprint arXiv:2106.06847</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chan et al. [2021]</span>
<span class="ltx_bibblock">
K. C. Chan, X. Wang, K. Yu, C. Dong, and C. C. Loy.

</span>
<span class="ltx_bibblock">Basicvsr: The search for essential components in video super-resolution and beyond.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, pages 4947–4956, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chan et al. [2022a]</span>
<span class="ltx_bibblock">
K. C. Chan, S. Zhou, X. Xu, and C. C. Loy.

</span>
<span class="ltx_bibblock">Basicvsr++: Improving video super-resolution with enhanced propagation and alignment.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, pages 5972–5981, 2022a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chan et al. [2022b]</span>
<span class="ltx_bibblock">
K. C. Chan, S. Zhou, X. Xu, and C. C. Loy.

</span>
<span class="ltx_bibblock">Investigating tradeoffs in real-world video super-resolution.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pages 5962–5971, 2022b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. [2021]</span>
<span class="ltx_bibblock">
H. Chen, Y. Jin, K. Xu, Y. Chen, and C. Zhu.

</span>
<span class="ltx_bibblock">Multiframe-to-multiframe network for video denoising.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">IEEE Transactions on Multimedia</em>, 24:2164–2178, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. [2023]</span>
<span class="ltx_bibblock">
H. Chen, J. Ren, J. Gu, H. Wu, X. Lu, H. Cai, and L. Zhu.

</span>
<span class="ltx_bibblock">Snow removal in video: A new dataset and a novel method.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">2023 IEEE/CVF International Conference on Computer Vision (ICCV)</em>, pages 13165–13176. IEEE, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. [2022a]</span>
<span class="ltx_bibblock">
L. Chen, X. Chu, X. Zhang, and J. Sun.

</span>
<span class="ltx_bibblock">Simple baselines for image restoration.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">European conference on computer vision</em>, pages 17–33. Springer, 2022a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. [2022b]</span>
<span class="ltx_bibblock">
S. Chen, T. Ye, Y. Liu, E. Chen, J. Shi, and J. Zhou.

</span>
<span class="ltx_bibblock">Snowformer: Scale-aware transformer via context interaction for single image desnowing.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">arXiv preprint arXiv:2208.09703</em>, 2, 2022b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Deng et al. [2020]</span>
<span class="ltx_bibblock">
J. Deng, L. Wang, S. Pu, and C. Zhuo.

</span>
<span class="ltx_bibblock">Spatio-temporal deformable convolution for compressed video quality enhancement.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">Proceedings of the AAAI conference on artificial intelligence</em>, volume 34, pages 10696–10703, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fuoli et al. [2019]</span>
<span class="ltx_bibblock">
D. Fuoli, S. Gu, and R. Timofte.

</span>
<span class="ltx_bibblock">Efficient video super-resolution through recurrent latent space propagation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">2019 IEEE/CVF International Conference on Computer Vision Workshop (ICCVW)</em>, pages 3476–3485. IEEE, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ghasemabadi et al. [2024]</span>
<span class="ltx_bibblock">
A. Ghasemabadi, M. K. Janjua, M. Salameh, C. ZHOU, F. Sun, and D. Niu.

</span>
<span class="ltx_bibblock">Cascadedgaze: Efficiency in global context extraction for image restoration.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Transactions on Machine Learning Research</em>, 2024.

</span>
<span class="ltx_bibblock">ISSN 2835-8856.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=C3FXHxMVuq" title="">https://openreview.net/forum?id=C3FXHxMVuq</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gu [2023]</span>
<span class="ltx_bibblock">
A. Gu.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">Modeling Sequences with Structured State Spaces</em>.

</span>
<span class="ltx_bibblock">Stanford University, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gu and Dao [2023]</span>
<span class="ltx_bibblock">
A. Gu and T. Dao.

</span>
<span class="ltx_bibblock">Mamba: Linear-time sequence modeling with selective state spaces.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">arXiv preprint arXiv:2312.00752</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gu et al. [2020]</span>
<span class="ltx_bibblock">
A. Gu, T. Dao, S. Ermon, A. Rudra, and C. Ré.

</span>
<span class="ltx_bibblock">Hippo: Recurrent memory with optimal polynomial projections.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Advances in neural information processing systems</em>, 33:1474–1487, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al. [2024]</span>
<span class="ltx_bibblock">
H. Guo, J. Li, T. Dai, Z. Ouyang, X. Ren, and S.-T. Xia.

</span>
<span class="ltx_bibblock">Mambair: A simple baseline for image restoration with state-space model.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">arXiv preprint arXiv:2402.15648</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Harguess et al. [2017]</span>
<span class="ltx_bibblock">
J. Harguess, C. Barngrover, and A. Rahimi.

</span>
<span class="ltx_bibblock">An analysis of optical flow on real and simulated data with degradations.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">Geospatial Informatics, Fusion, and Motion Video Analytics VII</em>, volume 10199, pages 23–39. SPIE, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Haris et al. [2019]</span>
<span class="ltx_bibblock">
M. Haris, G. Shakhnarovich, and N. Ukita.

</span>
<span class="ltx_bibblock">Recurrent back-projection network for video super-resolution.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, pages 3897–3906, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Harvey et al. [2022]</span>
<span class="ltx_bibblock">
W. Harvey, S. Naderiparizi, V. Masrani, C. Weilbach, and F. Wood.

</span>
<span class="ltx_bibblock">Flexible diffusion modeling of long videos.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">Advances in Neural Information Processing Systems</em>, 35:27953–27965, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et al. [2022]</span>
<span class="ltx_bibblock">
C. Huang, J. Li, B. Li, D. Liu, and Y. Lu.

</span>
<span class="ltx_bibblock">Neural compression-based feature learning for video restoration.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, pages 5872–5881, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hyun Kim et al. [2017]</span>
<span class="ltx_bibblock">
T. Hyun Kim, K. Mu Lee, B. Scholkopf, and M. Hirsch.

</span>
<span class="ltx_bibblock">Online video deblurring via dynamic temporal blending network.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">Proceedings of the IEEE international conference on computer vision</em>, pages 4038–4047, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Isobe et al. [2020a]</span>
<span class="ltx_bibblock">
T. Isobe, X. Jia, S. Gu, S. Li, S. Wang, and Q. Tian.

</span>
<span class="ltx_bibblock">Video super-resolution with recurrent structure-detail network.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">Computer Vision–ECCV 2020: 16th European Conference, Glasgow, UK, August 23–28, 2020, Proceedings, Part XII 16</em>, pages 645–660. Springer, 2020a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Isobe et al. [2020b]</span>
<span class="ltx_bibblock">
T. Isobe, S. Li, X. Jia, S. Yuan, G. Slabaugh, C. Xu, Y.-L. Li, S. Wang, and Q. Tian.

</span>
<span class="ltx_bibblock">Video super-resolution with temporal group attention.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, pages 8008–8017, 2020b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma and Ba [2014]</span>
<span class="ltx_bibblock">
D. P. Kingma and J. Ba.

</span>
<span class="ltx_bibblock">Adam: A method for stochastic optimization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">arXiv preprint arXiv:1412.6980</em>, 2014.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. [2021]</span>
<span class="ltx_bibblock">
D. Li, C. Xu, K. Zhang, X. Yu, Y. Zhong, W. Ren, H. Suominen, and H. Li.

</span>
<span class="ltx_bibblock">Arvo: Learning all-range volumetric correspondence for video deblurring.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pages 7721–7731, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. [2023]</span>
<span class="ltx_bibblock">
D. Li, X. Shi, Y. Zhang, K. C. Cheung, S. See, X. Wang, H. Qin, and H. Li.

</span>
<span class="ltx_bibblock">A simple baseline for video restoration with grouped spatial-temporal shift.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pages 9822–9832, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. [2024]</span>
<span class="ltx_bibblock">
K. Li, X. Li, Y. Wang, Y. He, Y. Wang, L. Wang, and Y. Qiao.

</span>
<span class="ltx_bibblock">Videomamba: State space model for efficient video understanding.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">arXiv preprint arXiv:2403.06977</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. [2019]</span>
<span class="ltx_bibblock">
R. Li, L.-F. Cheong, and R. T. Tan.

</span>
<span class="ltx_bibblock">Heavy rain image restoration: Integrating physics model and conditional adversarial learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, pages 1633–1642, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. [2020]</span>
<span class="ltx_bibblock">
W. Li, X. Tao, T. Guo, L. Qi, J. Lu, and J. Jia.

</span>
<span class="ltx_bibblock">Mucan: Multi-correspondence aggregation network for video super-resolution.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">Computer Vision–ECCV 2020: 16th European Conference, Glasgow, UK, August 23–28, 2020, Proceedings, Part X 16</em>, pages 335–351. Springer, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liang et al. [2022]</span>
<span class="ltx_bibblock">
J. Liang, Y. Fan, X. Xiang, R. Ranjan, E. Ilg, S. Green, J. Cao, K. Zhang, R. Timofte, and L. V. Gool.

</span>
<span class="ltx_bibblock">Recurrent video restoration transformer with guided deformable attention.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">Advances in Neural Information Processing Systems</em>, 35:378–393, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liang et al. [2024]</span>
<span class="ltx_bibblock">
J. Liang, J. Cao, Y. Fan, K. Zhang, R. Ranjan, Y. Li, R. Timofte, and L. Van Gool.

</span>
<span class="ltx_bibblock">Vrt: A video restoration transformer.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">IEEE Transactions on Image Processing</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al. [2024]</span>
<span class="ltx_bibblock">
B. Lin, Y. Jin, W. Yan, W. Ye, Y. Yuan, S. Zhang, and R. T. Tan.

</span>
<span class="ltx_bibblock">Nightrain: Nighttime video deraining via adaptive-rain-removal and adaptive-correction.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">Proceedings of the AAAI Conference on Artificial Intelligence</em>, volume 38, pages 3378–3385, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al. [2022]</span>
<span class="ltx_bibblock">
J. Lin, Y. Cai, X. Hu, H. Wang, Y. Yan, X. Zou, H. Ding, Y. Zhang, R. Timofte, and L. Van Gool.

</span>
<span class="ltx_bibblock">Flow-guided sparse transformer for video deblurring.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">ICML</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. [2022a]</span>
<span class="ltx_bibblock">
C. Liu, H. Yang, J. Fu, and X. Qian.

</span>
<span class="ltx_bibblock">Learning trajectory-aware transformer for video super-resolution.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, pages 5687–5696, 2022a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. [2022b]</span>
<span class="ltx_bibblock">
H. Liu, Z. Ruan, P. Zhao, C. Dong, F. Shang, Y. Liu, L. Yang, and R. Timofte.

</span>
<span class="ltx_bibblock">Video super-resolution based on deep learning: a comprehensive survey.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">Artificial Intelligence Review</em>, 55(8):5981–6035, 2022b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. [2021]</span>
<span class="ltx_bibblock">
Z. Liu, Y. Lin, Y. Cao, H. Hu, Y. Wei, Z. Zhang, S. Lin, and B. Guo.

</span>
<span class="ltx_bibblock">Swin transformer: Hierarchical vision transformer using shifted windows.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">Proceedings of the IEEE/CVF international conference on computer vision</em>, pages 10012–10022, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Loshchilov and Hutter [2016]</span>
<span class="ltx_bibblock">
I. Loshchilov and F. Hutter.

</span>
<span class="ltx_bibblock">Sgdr: Stochastic gradient descent with warm restarts.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">arXiv preprint arXiv:1608.03983</em>, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nah et al. [2017]</span>
<span class="ltx_bibblock">
S. Nah, T. Hyun Kim, and K. Mu Lee.

</span>
<span class="ltx_bibblock">Deep multi-scale convolutional neural network for dynamic scene deblurring.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">Proceedings of the IEEE conference on computer vision and pattern recognition</em>, pages 3883–3891, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nah et al. [2019]</span>
<span class="ltx_bibblock">
S. Nah, S. Son, and K. M. Lee.

</span>
<span class="ltx_bibblock">Recurrent neural networks with intra-frame iterations for video deblurring.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, pages 8102–8111, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Özdenizci and Legenstein [2023]</span>
<span class="ltx_bibblock">
O. Özdenizci and R. Legenstein.

</span>
<span class="ltx_bibblock">Restoring vision in adverse weather conditions with patch-based denoising diffusion models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">IEEE Transactions on Pattern Analysis and Machine Intelligence</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pan et al. [2020]</span>
<span class="ltx_bibblock">
J. Pan, H. Bai, and J. Tang.

</span>
<span class="ltx_bibblock">Cascaded deep video deblurring using temporal sharpness prior.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, pages 3043–3051, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pan et al. [2023]</span>
<span class="ltx_bibblock">
J. Pan, B. Xu, J. Dong, J. Ge, and J. Tang.

</span>
<span class="ltx_bibblock">Deep discriminative spatial and temporal network for efficient video deblurring.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pages 22191–22200, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Patil et al. [2022a]</span>
<span class="ltx_bibblock">
P. W. Patil, S. Gupta, S. Rana, and S. Venkatesh.

</span>
<span class="ltx_bibblock">Dual-frame spatio-temporal feature modulation for video enhancement.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">Pattern Recognition</em>, 130:108822, 2022a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Patil et al. [2022b]</span>
<span class="ltx_bibblock">
P. W. Patil, S. Gupta, S. Rana, and S. Venkatesh.

</span>
<span class="ltx_bibblock">Video restoration framework and its meta-adaptations to data-poor conditions.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">European Conference on Computer Vision</em>, pages 143–160. Springer, 2022b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pont-Tuset et al. [2017]</span>
<span class="ltx_bibblock">
J. Pont-Tuset, F. Perazzi, S. Caelles, P. Arbeláez, A. Sorkine-Hornung, and L. Van Gool.

</span>
<span class="ltx_bibblock">The 2017 davis challenge on video object segmentation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">arXiv preprint arXiv:1704.00675</em>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qi et al. [2022]</span>
<span class="ltx_bibblock">
C. Qi, J. Chen, X. Yang, and Q. Chen.

</span>
<span class="ltx_bibblock">Real-time streaming video denoising with bidirectional buffers.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib49.1.1">Proceedings of the 30th ACM International Conference on Multimedia</em>, pages 2758–2766, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qian et al. [2024]</span>
<span class="ltx_bibblock">
R. Qian, X. Dong, P. Zhang, Y. Zang, S. Ding, D. Lin, and J. Wang.

</span>
<span class="ltx_bibblock">Streaming long video understanding with large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib50.1.1">arXiv preprint arXiv:2405.16009</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rajagopalan and Chellappa [2014]</span>
<span class="ltx_bibblock">
A. Rajagopalan and R. Chellappa.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib51.1.1">Motion deblurring: Algorithms and systems</em>.

</span>
<span class="ltx_bibblock">Cambridge University Press, 2014.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ronneberger et al. [2015]</span>
<span class="ltx_bibblock">
O. Ronneberger, P. Fischer, and T. Brox.

</span>
<span class="ltx_bibblock">U-net: Convolutional networks for biomedical image segmentation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib52.1.1">Medical image computing and computer-assisted intervention–MICCAI 2015: 18th international conference, Munich, Germany, October 5-9, 2015, proceedings, part III 18</em>, pages 234–241. Springer, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rota et al. [2023]</span>
<span class="ltx_bibblock">
C. Rota, M. Buzzelli, S. Bianco, and R. Schettini.

</span>
<span class="ltx_bibblock">Video restoration based on deep learning: a comprehensive survey.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib53.1.1">Artificial Intelligence Review</em>, 56(6):5317–5364, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sajjadi et al. [2018]</span>
<span class="ltx_bibblock">
M. S. Sajjadi, R. Vemulapalli, and M. Brown.

</span>
<span class="ltx_bibblock">Frame-recurrent video super-resolution.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib54.1.1">Proceedings of the IEEE conference on computer vision and pattern recognition</em>, pages 6626–6634, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sheth et al. [2021]</span>
<span class="ltx_bibblock">
D. Y. Sheth, S. Mohan, J. Vincent, R. Manzorro, P. A. Crozier, M. M. Khapra, E. P. Simoncelli, and C. Fernandez-Granda.

</span>
<span class="ltx_bibblock">Unsupervised deep video denoising.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib55.1.1">Proceedings of the IEEE/CVF International Conference on Computer Vision (ICCV)</em>, October 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shi et al. [2024]</span>
<span class="ltx_bibblock">
Y. Shi, B. Xia, X. Jin, X. Wang, T. Zhao, X. Xia, X. Xiao, and W. Yang.

</span>
<span class="ltx_bibblock">Vmambair: Visual state space model for image restoration.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib56.1.1">arXiv preprint arXiv:2403.11423</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Son et al. [2021]</span>
<span class="ltx_bibblock">
H. Son, J. Lee, J. Lee, S. Cho, and S. Lee.

</span>
<span class="ltx_bibblock">Recurrent video deblurring with blur-invariant motion estimation and pixel volumes.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib57.1.1">ACM Transactions on Graphics (TOG)</em>, 40(5):1–18, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib58">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Su et al. [2017]</span>
<span class="ltx_bibblock">
S. Su, M. Delbracio, J. Wang, G. Sapiro, W. Heidrich, and O. Wang.

</span>
<span class="ltx_bibblock">Deep video deblurring for hand-held cameras.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib58.1.1">Proceedings of the IEEE conference on computer vision and pattern recognition</em>, pages 1279–1288, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib59">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Suin and Rajagopalan [2021]</span>
<span class="ltx_bibblock">
M. Suin and A. Rajagopalan.

</span>
<span class="ltx_bibblock">Gated spatio-temporal attention-guided video deblurring.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib59.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pages 7802–7811, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib60">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tao et al. [2018]</span>
<span class="ltx_bibblock">
X. Tao, H. Gao, X. Shen, J. Wang, and J. Jia.

</span>
<span class="ltx_bibblock">Scale-recurrent network for deep image deblurring.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib60.1.1">Proceedings of the IEEE conference on computer vision and pattern recognition</em>, pages 8174–8182, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib61">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tassano et al. [2019]</span>
<span class="ltx_bibblock">
M. Tassano, J. Delon, and T. Veit.

</span>
<span class="ltx_bibblock">Dvdnet: A fast network for deep video denoising.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib61.1.1">2019 IEEE International Conference on Image Processing (ICIP)</em>, pages 1805–1809. IEEE, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib62">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tassano et al. [2020]</span>
<span class="ltx_bibblock">
M. Tassano, J. Delon, and T. Veit.

</span>
<span class="ltx_bibblock">Fastdvdnet: Towards real-time deep video denoising without flow estimation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib62.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, pages 1354–1363, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib63">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tian et al. [2020]</span>
<span class="ltx_bibblock">
Y. Tian, Y. Zhang, Y. Fu, and C. Xu.

</span>
<span class="ltx_bibblock">Tdan: Temporally-deformable alignment network for video super-resolution.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib63.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, pages 3360–3369, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib64">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaksman et al. [2021]</span>
<span class="ltx_bibblock">
G. Vaksman, M. Elad, and P. Milanfar.

</span>
<span class="ltx_bibblock">Patch craft: Video denoising by deep modeling and patch matching.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib64.1.1">Proceedings of the IEEE/CVF International Conference on Computer Vision</em>, pages 2157–2166, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib65">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Valanarasu et al. [2022]</span>
<span class="ltx_bibblock">
J. M. J. Valanarasu, R. Yasarla, and V. M. Patel.

</span>
<span class="ltx_bibblock">Transweather: Transformer-based restoration of images degraded by adverse weather conditions.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib65.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pages 2353–2363, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib66">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al. [2017]</span>
<span class="ltx_bibblock">
A. Vaswani, N. Shazeer, N. Parmar, J. Uszkoreit, L. Jones, A. N. Gomez, Ł. Kaiser, and I. Polosukhin.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib66.1.1">Advances in neural information processing systems</em>, 30, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib67">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. [2023]</span>
<span class="ltx_bibblock">
R. Wang, X. Liu, Z. Zhang, X. Wu, C.-M. Feng, L. Zhang, and W. Zuo.

</span>
<span class="ltx_bibblock">Benchmark dataset and effective inter-frame alignment for real-world video super-resolution.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib67.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, pages 1168–1177, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib68">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. [2022]</span>
<span class="ltx_bibblock">
S. Wang, L. Zhu, H. Fu, J. Qin, C.-B. Schönlieb, W. Feng, and S. Wang.

</span>
<span class="ltx_bibblock">Rethinking video rain streak removal: A new synthesis model and a deraining network with video rain prior.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib68.1.1">European Conference on Computer Vision</em>, pages 565–582. Springer, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib69">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. [2019]</span>
<span class="ltx_bibblock">
X. Wang, K. C. Chan, K. Yu, C. Dong, and C. Change Loy.

</span>
<span class="ltx_bibblock">Edvr: Video restoration with enhanced deformable convolutional networks.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib69.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition workshops</em>, pages 0–0, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib70">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. [2004]</span>
<span class="ltx_bibblock">
Z. Wang, A. C. Bovik, H. R. Sheikh, and E. P. Simoncelli.

</span>
<span class="ltx_bibblock">Image quality assessment: from error visibility to structural similarity.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib70.1.1">IEEE transactions on image processing</em>, 13(4):600–612, 2004.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib71">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. [2023]</span>
<span class="ltx_bibblock">
H. Wu, Y. Yang, H. Chen, J. Ren, and L. Zhu.

</span>
<span class="ltx_bibblock">Mask-guided progressive network for joint raindrop and rain streak removal in videos.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib71.1.1">Proceedings of the 31st ACM International Conference on Multimedia</em>, pages 7216–7225, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib72">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiang et al. [2022]</span>
<span class="ltx_bibblock">
L. Xiang, J. Zhou, J. Liu, Z. Wang, H. Huang, J. Hu, J. Han, Y. Guo, and G. Ding.

</span>
<span class="ltx_bibblock">Remonet: Recurrent multi-output network for efficient video denoising.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib72.1.1">Proceedings of the AAAI Conference on Artificial Intelligence</em>, volume 36, pages 2786–2794, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib73">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. [2024]</span>
<span class="ltx_bibblock">
S. Yang, J. Walker, J. Parker-Holder, Y. Du, J. Bruce, A. Barreto, P. Abbeel, and D. Schuurmans.

</span>
<span class="ltx_bibblock">Video as the new language for real-world decision making.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib73.1.1">arXiv preprint arXiv:2402.17139</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib74">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. [2019]</span>
<span class="ltx_bibblock">
W. Yang, J. Liu, and J. Feng.

</span>
<span class="ltx_bibblock">Frame-consistent recurrent video deraining with dual-level flow.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib74.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, pages 1661–1670, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib75">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. [2021]</span>
<span class="ltx_bibblock">
W. Yang, R. T. Tan, J. Feng, S. Wang, B. Cheng, and J. Liu.

</span>
<span class="ltx_bibblock">Recurrent multi-frame deraining: Combining physics guidance and adversarial learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib75.1.1">IEEE Transactions on Pattern Analysis and Machine Intelligence</em>, 44(11):8569–8586, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib76">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. [2022]</span>
<span class="ltx_bibblock">
J. Yu, J. Liu, L. Bo, and T. Mei.

</span>
<span class="ltx_bibblock">Memory-augmented non-local attention for video super-resolution.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib76.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, pages 17834–17843, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib77">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu and Wang [2024]</span>
<span class="ltx_bibblock">
W. Yu and X. Wang.

</span>
<span class="ltx_bibblock">Mambaout: Do we really need mamba for vision?, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib78">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yue et al. [2021]</span>
<span class="ltx_bibblock">
Z. Yue, J. Xie, Q. Zhao, and D. Meng.

</span>
<span class="ltx_bibblock">Semi-supervised video deraining with dynamical rain generator.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib78.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pages 642–652, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib79">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zamir et al. [2022]</span>
<span class="ltx_bibblock">
S. W. Zamir, A. Arora, S. Khan, M. Hayat, F. S. Khan, and M.-H. Yang.

</span>
<span class="ltx_bibblock">Restormer: Efficient transformer for high-resolution image restoration.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib79.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, pages 5728–5739, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib80">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. [2022]</span>
<span class="ltx_bibblock">
H. Zhang, H. Xie, and H. Yao.

</span>
<span class="ltx_bibblock">Spatio-temporal deformable attention network for video deblurring.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib80.1.1">European Conference on Computer Vision</em>, pages 581–596. Springer, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib81">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. [2021]</span>
<span class="ltx_bibblock">
M. Zhao, Y. Xu, and S. Zhou.

</span>
<span class="ltx_bibblock">Recursive fusion and deformable spatiotemporal attention for video compression artifact reduction.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib81.1.1">Proceedings of the 29th ACM international conference on multimedia</em>, pages 5646–5654, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib82">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhong et al. [2020]</span>
<span class="ltx_bibblock">
Z. Zhong, Y. Gao, Y. Zheng, and B. Zheng.

</span>
<span class="ltx_bibblock">Efficient spatio-temporal recurrent neural network for video deblurring.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib82.1.1">Computer Vision–ECCV 2020: 16th European Conference, Glasgow, UK, August 23–28, 2020, Proceedings, Part VI 16</em>, pages 191–207. Springer, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib83">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhong et al. [2023]</span>
<span class="ltx_bibblock">
Z. Zhong, Y. Gao, Y. Zheng, B. Zheng, and I. Sato.

</span>
<span class="ltx_bibblock">Real-world video deblurring: A benchmark dataset and an efficient recurrent neural network.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib83.1.1">International Journal of Computer Vision</em>, 131(1):284–301, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib84">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al. [2023a]</span>
<span class="ltx_bibblock">
H. Zhou, Y. Chang, G. Chen, and L. Yan.

</span>
<span class="ltx_bibblock">Unsupervised hierarchical domain adaptation for adverse weather optical flow.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib84.1.1">Proceedings of the AAAI Conference on Artificial Intelligence</em>, volume 37, pages 3778–3786, 2023a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib85">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al. [2023b]</span>
<span class="ltx_bibblock">
K. Zhou, W. Li, X. Han, and J. Lu.

</span>
<span class="ltx_bibblock">Exploring motion ambiguity and alignment for high-quality video frame interpolation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib85.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pages 22169–22179, 2023b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib86">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al. [2019]</span>
<span class="ltx_bibblock">
S. Zhou, J. Zhang, J. Pan, H. Xie, W. Zuo, and J. Ren.

</span>
<span class="ltx_bibblock">Spatio-temporal filter adaptive network for video deblurring.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib86.1.1">Proceedings of the IEEE/CVF international conference on computer vision</em>, pages 2482–2491, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib87">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al. [2022]</span>
<span class="ltx_bibblock">
C. Zhu, H. Dong, J. Pan, B. Liang, Y. Huang, L. Fu, and F. Wang.

</span>
<span class="ltx_bibblock">Deep recurrent neural network with multi-scale bi-directional propagation for video deblurring.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib87.1.1">Proceedings of the AAAI conference on artificial intelligence</em>, volume 36, pages 3598–3607, 2022.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="Ax1">
<h2 class="ltx_title ltx_title_appendix">Technical Appendices</h2>
<div class="ltx_para" id="Ax1.p1">
<span class="ltx_ERROR undefined" id="Ax1.p1.1">\startcontents</span><span class="ltx_ERROR undefined" id="Ax1.p1.2">\printcontents</span>
<p class="ltx_p" id="Ax1.p1.3">1<span class="ltx_text ltx_font_bold" id="Ax1.p1.3.1">Contents<span class="ltx_rule" style="width:100%;height:1px;background:black;display:inline-block;"> </span></span>
<span class="ltx_rule" style="width:100%;height:1px;background:black;display:inline-block;"> </span></p>
</div>
<div class="ltx_para" id="Ax1.p2">
<p class="ltx_p" id="Ax1.p2.1">In appendices, we discuss additional details about the proposed method <span class="ltx_text ltx_font_smallcaps" id="Ax1.p2.1.1">turtle</span>, motivate the need for learning to model the history of input for video restoration in <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A1" title="Appendix A Turtle’s Specifications &amp; Details ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">appendix</span> <span class="ltx_text ltx_ref_tag">A</span></a>, discuss limitations of the proposed approach <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A2" title="Appendix B Limitations &amp; Discussion ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">appendix</span> <span class="ltx_text ltx_ref_tag">B</span></a>, discuss theoretical relationship to state-space models in <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A3" title="Appendix C Relationship to State Space Models ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">appendix</span> <span class="ltx_text ltx_ref_tag">C</span></a>, present more visual results in <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A4" title="Appendix D Further Visual Comparisons ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">appendix</span> <span class="ltx_text ltx_ref_tag">D</span></a>, discuss related work in <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A6" title="Appendix F Additional Literature Review ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">appendix</span> <span class="ltx_text ltx_ref_tag">F</span></a>, and computationally profile the proposed method <span class="ltx_text ltx_font_smallcaps" id="Ax1.p2.1.2">turtle</span> in <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A5" title="Appendix E Computational Profile of Turtle ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">appendix</span> <span class="ltx_text ltx_ref_tag">E</span></a>.</p>
</div>
<figure class="ltx_figure" id="Ax1.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="393" id="Ax1.F6.g1" src="x6.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span><span class="ltx_text ltx_font_bold" id="Ax1.F6.7.1">Do we need history?</span> We present visual results of <span class="ltx_text ltx_font_smallcaps" id="Ax1.F6.8.2">turtle</span> and <span class="ltx_text ltx_font_smallcaps" id="Ax1.F6.9.3">turtle</span> without <span class="ltx_text ltx_font_sansserif" id="Ax1.F6.10.4">CHM</span> to motivate the need for summarizing the history and conditioning the restoration on the history of the input. Other than efficiency, it also brings perceptual benefits. Notice how <span class="ltx_text ltx_inline-quote ltx_outerquote" id="Ax1.F6.11.5">“no <span class="ltx_text ltx_font_sansserif" id="Ax1.F6.11.5.1">CHM</span>”</span> introduces smudges and blemishes in place of the <span class="ltx_text" id="Ax1.F6.12.6" style="color:#FF0000;">guard railing in the balcony of the building</span> since the region is obscured in the degraded input.</figcaption>
</figure>
<figure class="ltx_figure" id="Ax1.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="405" id="Ax1.F7.g1" src="x7.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span><span class="ltx_text ltx_font_sansserif ltx_font_bold" id="Ax1.F7.5.1">CHM<span class="ltx_text ltx_font_serif" id="Ax1.F7.5.1.1"> Tracking.</span></span> Visual illustration of <span class="ltx_text ltx_font_sansserif" id="Ax1.F7.6.2">CHM</span> tracking <span class="ltx_text" id="Ax1.F7.7.3" style="color:#FF0000;">query points</span> in the frame history (frames previous to the input frame). In the top row, we plot the correctly <span class="ltx_text" id="Ax1.F7.8.4" style="color:#FF8000;">tracked points</span>, while the bottom row visualizes the limitations in the case of redundant patterns. We plot the query and most similar points on input frames for ease of exposition, but in practice, they function on feature maps.</figcaption>
</figure>
</section>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span><span class="ltx_text ltx_font_smallcaps" id="A1.1.1">Turtle</span>’s Specifications &amp; Details</h2>
<div class="ltx_para" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">We motivate <span class="ltx_text ltx_font_smallcaps" id="A1.p1.1.1">turtle</span>’s design and present empirical results to pinpoint the benefits of modeling the history in the case of video restoration. Further, we present additional details of the proposed method, <span class="ltx_text ltx_font_smallcaps" id="A1.p1.1.2">turtle</span>, and expand on the construction of the architecture.</p>
</div>
<figure class="ltx_figure" id="A1.F8"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="143" id="A1.F8.g1" src="x8.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span><span class="ltx_text ltx_font_bold" id="A1.F8.2.1">Illustration of Historyless FFN.</span> Transformer block is similar in spirit to the block introduced in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib79" title="">79</a>]</cite>, while the Historyless FFN’s design takes inspiration from the blocks in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib15" title="">15</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib11" title="">11</a>]</cite>.</figcaption>
</figure>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Motivation: Causal History Model</h3>
<div class="ltx_para" id="A1.SS1.p1">
<p class="ltx_p" id="A1.SS1.p1.1">Recall that the Causal History Model (CHM) is designed to model the state and compensate for motion across the entire history relative to the input. It then learns to control the effect of history frames by scoring and aggregating motion-compensated features based on their relevance to the restoration of the current frame. Such a procedure allows for borrowing information from the preceding temporal neighbors of the input frame. In <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S5.T11" title="In Value of 𝑘 in topk. ‣ 5 Ablation Study ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">table</span> <span class="ltx_text ltx_ref_tag">11</span></a>, we ablate if <span class="ltx_text ltx_font_sansserif" id="A1.SS1.p1.1.1">CHM</span> indeed provides the performance boost. Moreover, in <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#Ax1.F6" title="In Technical Appendices ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">6</span></a>, we present visual results on the video raindrops and rain streaks removal task to motivate the need for summarizing the frame history as part of the restoration method. We train <span class="ltx_text ltx_font_smallcaps" id="A1.SS1.p1.1.2">turtle</span> without the <span class="ltx_text ltx_font_sansserif" id="A1.SS1.p1.1.3">CHM</span> block, referred to as <span class="ltx_text ltx_inline-quote ltx_outerquote" id="A1.SS1.p1.1.4">“no <span class="ltx_text ltx_font_sansserif" id="A1.SS1.p1.1.4.1">CHM</span>”</span>, following <span class="ltx_text ltx_font_smallcaps" id="A1.SS1.p1.1.5">turtle</span>’s experimental setup, and for fair comparison, we keep the model size consistent. <span class="ltx_text ltx_font_smallcaps" id="A1.SS1.p1.1.6">turtle</span>, equipped with <span class="ltx_text ltx_font_sansserif" id="A1.SS1.p1.1.7">CHM</span>, maintains the spatial integrity of the input without introducing faux textures or blur even though the region (see <span class="ltx_text" id="A1.SS1.p1.1.8" style="color:#FF0000;">guard railing in the balcony of the building</span>) is entirely obscured by raindrops and streaks in the degraded input. However, without <span class="ltx_text ltx_font_sansserif" id="A1.SS1.p1.1.9">CHM</span> block, unwanted artifacts (such as holes and blemishes in place of the guard railing in the balcony) are introduced to fill in the missing information since no information is borrowed from preceding frames. Note that in the case of no <span class="ltx_text ltx_font_sansserif" id="A1.SS1.p1.1.10">CHM</span> experiment, we feed two concatenated frames (one frame previous to the input and the input frame) to the architecture.</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Historyless FFN.</h3>
<div class="ltx_para" id="A1.SS2.p1">
<p class="ltx_p" id="A1.SS2.p1.1">Recall that <span class="ltx_text ltx_font_smallcaps" id="A1.SS2.p1.1.1">turtle</span>’s encoder is historyless, i.e., it employs no information about the history of the input. Further, we opt for a feedforward style design in the encoder with convolutional layers. This is because shallow representations at this stage are not sufficiently compressed and are riddled with degradation. Thus, expensive attention-based operators provide no significant performance benefit but add to the computational complexity. The diagrammatic illustration of Historyless FFN and the Transformer block <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib79" title="">79</a>]</cite> used in <span class="ltx_text ltx_font_sansserif" id="A1.SS2.p1.1.2">CHM</span> is presented in <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A1.F8" title="In Appendix A Turtle’s Specifications &amp; Details ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">8</span></a>.</p>
</div>
<figure class="ltx_figure" id="A1.F9"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="251" id="A1.F9.g1" src="x9.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span><span class="ltx_text ltx_font_bold" id="A1.F9.3.1">Visual Results on Synthetic Video Deblurring.</span> We present additional qualitative analysis on synthetic video deblurring on the GoPro dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib41" title="">41</a>]</cite>. We compare <span class="ltx_text ltx_font_smallcaps" id="A1.F9.4.2">turtle</span> with DSTNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib45" title="">45</a>]</cite> on two frames taken from two different videos of the testset.</figcaption>
</figure>
</section>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Limitations &amp; Discussion</h2>
<div class="ltx_para" id="A2.p1">
<p class="ltx_p" id="A2.p1.1">This section discusses the limitations of our proposed <span class="ltx_text ltx_font_sansserif" id="A2.p1.1.1">CHM</span>. While <span class="ltx_text ltx_font_sansserif" id="A2.p1.1.2">CHM</span> is adept at tracking similar patches across the history of frames, it encounters challenges in certain scenarios. For instance, as demonstrated in the zebra example in <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#Ax1.F7" title="In Technical Appendices ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">7</span></a>, <span class="ltx_text ltx_font_sansserif" id="A2.p1.1.3">CHM</span> identifies similar patches on different parts of the zebra’s body due to their redundant patterns, even though these patches are not located in the same area. Moreover, in case of severe input degradation, <span class="ltx_text ltx_font_sansserif" id="A2.p1.1.4">CHM</span>’s capacity to accurately identify and utilize similar patches may diminish due to spurious correlations, which could affect its ability to use history effectively for restoring the current frame.</p>
</div>
<section class="ltx_subsection" id="A2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span>Societal Impact</h3>
<div class="ltx_para" id="A2.SS1.p1">
<p class="ltx_p" id="A2.SS1.p1.1">This work presents an efficient method to advance the study of machine learning research for video restoration. While the proposed method effectively restores the degraded videos, we recommend expert supervision in medical, forensic, or other similar sensitive applications.</p>
</div>
</section>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Relationship to State Space Models</h2>
<div class="ltx_para" id="A3.p1">
<p class="ltx_p" id="A3.p1.1">We present a special case of the proposed Causal History Model, <span class="ltx_text ltx_font_sansserif" id="A3.p1.1.1">CHM</span>, wherein the videos are not degraded, and each frame is optimally compensated for motion with respect to the input.</p>
</div>
<div class="ltx_theorem ltx_theorem_lemma" id="A3.Thmtheorem1">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="A3.Thmtheorem1.1.1.1">Lemma C.1</span></span><span class="ltx_text ltx_font_bold" id="A3.Thmtheorem1.2.2">.</span>
</h6>
<div class="ltx_para" id="A3.Thmtheorem1.p1">
<p class="ltx_p" id="A3.Thmtheorem1.p1.3"><span class="ltx_text ltx_font_italic" id="A3.Thmtheorem1.p1.3.3">(Special Case of Causal History Model)
In the absence of degradation and optimally compensated motion through optical flow, the state history <math alttext="\mathbf{\hat{H}}_{t}^{[l]}" class="ltx_Math" display="inline" id="A3.Thmtheorem1.p1.1.1.m1.1"><semantics id="A3.Thmtheorem1.p1.1.1.m1.1a"><msubsup id="A3.Thmtheorem1.p1.1.1.m1.1.2" xref="A3.Thmtheorem1.p1.1.1.m1.1.2.cmml"><mover accent="true" id="A3.Thmtheorem1.p1.1.1.m1.1.2.2.2" xref="A3.Thmtheorem1.p1.1.1.m1.1.2.2.2.cmml"><mi id="A3.Thmtheorem1.p1.1.1.m1.1.2.2.2.2" xref="A3.Thmtheorem1.p1.1.1.m1.1.2.2.2.2.cmml">𝐇</mi><mo id="A3.Thmtheorem1.p1.1.1.m1.1.2.2.2.1" xref="A3.Thmtheorem1.p1.1.1.m1.1.2.2.2.1.cmml">^</mo></mover><mi id="A3.Thmtheorem1.p1.1.1.m1.1.2.2.3" xref="A3.Thmtheorem1.p1.1.1.m1.1.2.2.3.cmml">t</mi><mrow id="A3.Thmtheorem1.p1.1.1.m1.1.1.1.3" xref="A3.Thmtheorem1.p1.1.1.m1.1.1.1.2.cmml"><mo id="A3.Thmtheorem1.p1.1.1.m1.1.1.1.3.1" stretchy="false" xref="A3.Thmtheorem1.p1.1.1.m1.1.1.1.2.1.cmml">[</mo><mi id="A3.Thmtheorem1.p1.1.1.m1.1.1.1.1" xref="A3.Thmtheorem1.p1.1.1.m1.1.1.1.1.cmml">l</mi><mo id="A3.Thmtheorem1.p1.1.1.m1.1.1.1.3.2" stretchy="false" xref="A3.Thmtheorem1.p1.1.1.m1.1.1.1.2.1.cmml">]</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A3.Thmtheorem1.p1.1.1.m1.1b"><apply id="A3.Thmtheorem1.p1.1.1.m1.1.2.cmml" xref="A3.Thmtheorem1.p1.1.1.m1.1.2"><csymbol cd="ambiguous" id="A3.Thmtheorem1.p1.1.1.m1.1.2.1.cmml" xref="A3.Thmtheorem1.p1.1.1.m1.1.2">superscript</csymbol><apply id="A3.Thmtheorem1.p1.1.1.m1.1.2.2.cmml" xref="A3.Thmtheorem1.p1.1.1.m1.1.2"><csymbol cd="ambiguous" id="A3.Thmtheorem1.p1.1.1.m1.1.2.2.1.cmml" xref="A3.Thmtheorem1.p1.1.1.m1.1.2">subscript</csymbol><apply id="A3.Thmtheorem1.p1.1.1.m1.1.2.2.2.cmml" xref="A3.Thmtheorem1.p1.1.1.m1.1.2.2.2"><ci id="A3.Thmtheorem1.p1.1.1.m1.1.2.2.2.1.cmml" xref="A3.Thmtheorem1.p1.1.1.m1.1.2.2.2.1">^</ci><ci id="A3.Thmtheorem1.p1.1.1.m1.1.2.2.2.2.cmml" xref="A3.Thmtheorem1.p1.1.1.m1.1.2.2.2.2">𝐇</ci></apply><ci id="A3.Thmtheorem1.p1.1.1.m1.1.2.2.3.cmml" xref="A3.Thmtheorem1.p1.1.1.m1.1.2.2.3">𝑡</ci></apply><apply id="A3.Thmtheorem1.p1.1.1.m1.1.1.1.2.cmml" xref="A3.Thmtheorem1.p1.1.1.m1.1.1.1.3"><csymbol cd="latexml" id="A3.Thmtheorem1.p1.1.1.m1.1.1.1.2.1.cmml" xref="A3.Thmtheorem1.p1.1.1.m1.1.1.1.3.1">delimited-[]</csymbol><ci id="A3.Thmtheorem1.p1.1.1.m1.1.1.1.1.cmml" xref="A3.Thmtheorem1.p1.1.1.m1.1.1.1.1">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Thmtheorem1.p1.1.1.m1.1c">\mathbf{\hat{H}}_{t}^{[l]}</annotation><annotation encoding="application/x-llamapun" id="A3.Thmtheorem1.p1.1.1.m1.1d">over^ start_ARG bold_H end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT</annotation></semantics></math>, then, only depends on the input <math alttext="\mathbf{F}_{t}^{[l]}" class="ltx_Math" display="inline" id="A3.Thmtheorem1.p1.2.2.m2.1"><semantics id="A3.Thmtheorem1.p1.2.2.m2.1a"><msubsup id="A3.Thmtheorem1.p1.2.2.m2.1.2" xref="A3.Thmtheorem1.p1.2.2.m2.1.2.cmml"><mi id="A3.Thmtheorem1.p1.2.2.m2.1.2.2.2" xref="A3.Thmtheorem1.p1.2.2.m2.1.2.2.2.cmml">𝐅</mi><mi id="A3.Thmtheorem1.p1.2.2.m2.1.2.2.3" xref="A3.Thmtheorem1.p1.2.2.m2.1.2.2.3.cmml">t</mi><mrow id="A3.Thmtheorem1.p1.2.2.m2.1.1.1.3" xref="A3.Thmtheorem1.p1.2.2.m2.1.1.1.2.cmml"><mo id="A3.Thmtheorem1.p1.2.2.m2.1.1.1.3.1" stretchy="false" xref="A3.Thmtheorem1.p1.2.2.m2.1.1.1.2.1.cmml">[</mo><mi id="A3.Thmtheorem1.p1.2.2.m2.1.1.1.1" xref="A3.Thmtheorem1.p1.2.2.m2.1.1.1.1.cmml">l</mi><mo id="A3.Thmtheorem1.p1.2.2.m2.1.1.1.3.2" stretchy="false" xref="A3.Thmtheorem1.p1.2.2.m2.1.1.1.2.1.cmml">]</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A3.Thmtheorem1.p1.2.2.m2.1b"><apply id="A3.Thmtheorem1.p1.2.2.m2.1.2.cmml" xref="A3.Thmtheorem1.p1.2.2.m2.1.2"><csymbol cd="ambiguous" id="A3.Thmtheorem1.p1.2.2.m2.1.2.1.cmml" xref="A3.Thmtheorem1.p1.2.2.m2.1.2">superscript</csymbol><apply id="A3.Thmtheorem1.p1.2.2.m2.1.2.2.cmml" xref="A3.Thmtheorem1.p1.2.2.m2.1.2"><csymbol cd="ambiguous" id="A3.Thmtheorem1.p1.2.2.m2.1.2.2.1.cmml" xref="A3.Thmtheorem1.p1.2.2.m2.1.2">subscript</csymbol><ci id="A3.Thmtheorem1.p1.2.2.m2.1.2.2.2.cmml" xref="A3.Thmtheorem1.p1.2.2.m2.1.2.2.2">𝐅</ci><ci id="A3.Thmtheorem1.p1.2.2.m2.1.2.2.3.cmml" xref="A3.Thmtheorem1.p1.2.2.m2.1.2.2.3">𝑡</ci></apply><apply id="A3.Thmtheorem1.p1.2.2.m2.1.1.1.2.cmml" xref="A3.Thmtheorem1.p1.2.2.m2.1.1.1.3"><csymbol cd="latexml" id="A3.Thmtheorem1.p1.2.2.m2.1.1.1.2.1.cmml" xref="A3.Thmtheorem1.p1.2.2.m2.1.1.1.3.1">delimited-[]</csymbol><ci id="A3.Thmtheorem1.p1.2.2.m2.1.1.1.1.cmml" xref="A3.Thmtheorem1.p1.2.2.m2.1.1.1.1">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Thmtheorem1.p1.2.2.m2.1c">\mathbf{F}_{t}^{[l]}</annotation><annotation encoding="application/x-llamapun" id="A3.Thmtheorem1.p1.2.2.m2.1d">bold_F start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT</annotation></semantics></math>, and the previous state <math alttext="\mathbf{\hat{H}}_{t-1}^{[l]}" class="ltx_Math" display="inline" id="A3.Thmtheorem1.p1.3.3.m3.1"><semantics id="A3.Thmtheorem1.p1.3.3.m3.1a"><msubsup id="A3.Thmtheorem1.p1.3.3.m3.1.2" xref="A3.Thmtheorem1.p1.3.3.m3.1.2.cmml"><mover accent="true" id="A3.Thmtheorem1.p1.3.3.m3.1.2.2.2" xref="A3.Thmtheorem1.p1.3.3.m3.1.2.2.2.cmml"><mi id="A3.Thmtheorem1.p1.3.3.m3.1.2.2.2.2" xref="A3.Thmtheorem1.p1.3.3.m3.1.2.2.2.2.cmml">𝐇</mi><mo id="A3.Thmtheorem1.p1.3.3.m3.1.2.2.2.1" xref="A3.Thmtheorem1.p1.3.3.m3.1.2.2.2.1.cmml">^</mo></mover><mrow id="A3.Thmtheorem1.p1.3.3.m3.1.2.2.3" xref="A3.Thmtheorem1.p1.3.3.m3.1.2.2.3.cmml"><mi id="A3.Thmtheorem1.p1.3.3.m3.1.2.2.3.2" xref="A3.Thmtheorem1.p1.3.3.m3.1.2.2.3.2.cmml">t</mi><mo id="A3.Thmtheorem1.p1.3.3.m3.1.2.2.3.1" xref="A3.Thmtheorem1.p1.3.3.m3.1.2.2.3.1.cmml">−</mo><mn id="A3.Thmtheorem1.p1.3.3.m3.1.2.2.3.3" xref="A3.Thmtheorem1.p1.3.3.m3.1.2.2.3.3.cmml">1</mn></mrow><mrow id="A3.Thmtheorem1.p1.3.3.m3.1.1.1.3" xref="A3.Thmtheorem1.p1.3.3.m3.1.1.1.2.cmml"><mo id="A3.Thmtheorem1.p1.3.3.m3.1.1.1.3.1" stretchy="false" xref="A3.Thmtheorem1.p1.3.3.m3.1.1.1.2.1.cmml">[</mo><mi id="A3.Thmtheorem1.p1.3.3.m3.1.1.1.1" xref="A3.Thmtheorem1.p1.3.3.m3.1.1.1.1.cmml">l</mi><mo id="A3.Thmtheorem1.p1.3.3.m3.1.1.1.3.2" stretchy="false" xref="A3.Thmtheorem1.p1.3.3.m3.1.1.1.2.1.cmml">]</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A3.Thmtheorem1.p1.3.3.m3.1b"><apply id="A3.Thmtheorem1.p1.3.3.m3.1.2.cmml" xref="A3.Thmtheorem1.p1.3.3.m3.1.2"><csymbol cd="ambiguous" id="A3.Thmtheorem1.p1.3.3.m3.1.2.1.cmml" xref="A3.Thmtheorem1.p1.3.3.m3.1.2">superscript</csymbol><apply id="A3.Thmtheorem1.p1.3.3.m3.1.2.2.cmml" xref="A3.Thmtheorem1.p1.3.3.m3.1.2"><csymbol cd="ambiguous" id="A3.Thmtheorem1.p1.3.3.m3.1.2.2.1.cmml" xref="A3.Thmtheorem1.p1.3.3.m3.1.2">subscript</csymbol><apply id="A3.Thmtheorem1.p1.3.3.m3.1.2.2.2.cmml" xref="A3.Thmtheorem1.p1.3.3.m3.1.2.2.2"><ci id="A3.Thmtheorem1.p1.3.3.m3.1.2.2.2.1.cmml" xref="A3.Thmtheorem1.p1.3.3.m3.1.2.2.2.1">^</ci><ci id="A3.Thmtheorem1.p1.3.3.m3.1.2.2.2.2.cmml" xref="A3.Thmtheorem1.p1.3.3.m3.1.2.2.2.2">𝐇</ci></apply><apply id="A3.Thmtheorem1.p1.3.3.m3.1.2.2.3.cmml" xref="A3.Thmtheorem1.p1.3.3.m3.1.2.2.3"><minus id="A3.Thmtheorem1.p1.3.3.m3.1.2.2.3.1.cmml" xref="A3.Thmtheorem1.p1.3.3.m3.1.2.2.3.1"></minus><ci id="A3.Thmtheorem1.p1.3.3.m3.1.2.2.3.2.cmml" xref="A3.Thmtheorem1.p1.3.3.m3.1.2.2.3.2">𝑡</ci><cn id="A3.Thmtheorem1.p1.3.3.m3.1.2.2.3.3.cmml" type="integer" xref="A3.Thmtheorem1.p1.3.3.m3.1.2.2.3.3">1</cn></apply></apply><apply id="A3.Thmtheorem1.p1.3.3.m3.1.1.1.2.cmml" xref="A3.Thmtheorem1.p1.3.3.m3.1.1.1.3"><csymbol cd="latexml" id="A3.Thmtheorem1.p1.3.3.m3.1.1.1.2.1.cmml" xref="A3.Thmtheorem1.p1.3.3.m3.1.1.1.3.1">delimited-[]</csymbol><ci id="A3.Thmtheorem1.p1.3.3.m3.1.1.1.1.cmml" xref="A3.Thmtheorem1.p1.3.3.m3.1.1.1.1">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Thmtheorem1.p1.3.3.m3.1c">\mathbf{\hat{H}}_{t-1}^{[l]}</annotation><annotation encoding="application/x-llamapun" id="A3.Thmtheorem1.p1.3.3.m3.1d">over^ start_ARG bold_H end_ARG start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT</annotation></semantics></math>. Under this assumption, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S3.E1" title="In 3.2 Causal History Model ‣ 3 Methodology ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">eq.</span> <span class="ltx_text ltx_ref_tag">1</span></a>, and <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S3.E2" title="In 3.2 Causal History Model ‣ 3 Methodology ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">eq.</span> <span class="ltx_text ltx_ref_tag">2</span></a> can be rewritten as,</span></p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A7.EGx6">
<tbody id="A3.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{\hat{H}}_{t}^{[l]}" class="ltx_Math" display="inline" id="A3.E8.m1.1"><semantics id="A3.E8.m1.1a"><msubsup id="A3.E8.m1.1.2" xref="A3.E8.m1.1.2.cmml"><mover accent="true" id="A3.E8.m1.1.2.2.2" xref="A3.E8.m1.1.2.2.2.cmml"><mi id="A3.E8.m1.1.2.2.2.2" xref="A3.E8.m1.1.2.2.2.2.cmml">𝐇</mi><mo id="A3.E8.m1.1.2.2.2.1" xref="A3.E8.m1.1.2.2.2.1.cmml">^</mo></mover><mi id="A3.E8.m1.1.2.2.3" xref="A3.E8.m1.1.2.2.3.cmml">t</mi><mrow id="A3.E8.m1.1.1.1.3" xref="A3.E8.m1.1.1.1.2.cmml"><mo id="A3.E8.m1.1.1.1.3.1" stretchy="false" xref="A3.E8.m1.1.1.1.2.1.cmml">[</mo><mi id="A3.E8.m1.1.1.1.1" xref="A3.E8.m1.1.1.1.1.cmml">l</mi><mo id="A3.E8.m1.1.1.1.3.2" stretchy="false" xref="A3.E8.m1.1.1.1.2.1.cmml">]</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A3.E8.m1.1b"><apply id="A3.E8.m1.1.2.cmml" xref="A3.E8.m1.1.2"><csymbol cd="ambiguous" id="A3.E8.m1.1.2.1.cmml" xref="A3.E8.m1.1.2">superscript</csymbol><apply id="A3.E8.m1.1.2.2.cmml" xref="A3.E8.m1.1.2"><csymbol cd="ambiguous" id="A3.E8.m1.1.2.2.1.cmml" xref="A3.E8.m1.1.2">subscript</csymbol><apply id="A3.E8.m1.1.2.2.2.cmml" xref="A3.E8.m1.1.2.2.2"><ci id="A3.E8.m1.1.2.2.2.1.cmml" xref="A3.E8.m1.1.2.2.2.1">^</ci><ci id="A3.E8.m1.1.2.2.2.2.cmml" xref="A3.E8.m1.1.2.2.2.2">𝐇</ci></apply><ci id="A3.E8.m1.1.2.2.3.cmml" xref="A3.E8.m1.1.2.2.3">𝑡</ci></apply><apply id="A3.E8.m1.1.1.1.2.cmml" xref="A3.E8.m1.1.1.1.3"><csymbol cd="latexml" id="A3.E8.m1.1.1.1.2.1.cmml" xref="A3.E8.m1.1.1.1.3.1">delimited-[]</csymbol><ci id="A3.E8.m1.1.1.1.1.cmml" xref="A3.E8.m1.1.1.1.1">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E8.m1.1c">\displaystyle\mathbf{\hat{H}}_{t}^{[l]}</annotation><annotation encoding="application/x-llamapun" id="A3.E8.m1.1d">over^ start_ARG bold_H end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbf{A}_{t}(\mathbf{\hat{H}}_{t-1}^{[l]})+\mathbf{B}_{t}(%
\mathbf{F}_{t}^{[l]})," class="ltx_Math" display="inline" id="A3.E8.m2.3"><semantics id="A3.E8.m2.3a"><mrow id="A3.E8.m2.3.3.1" xref="A3.E8.m2.3.3.1.1.cmml"><mrow id="A3.E8.m2.3.3.1.1" xref="A3.E8.m2.3.3.1.1.cmml"><mi id="A3.E8.m2.3.3.1.1.4" xref="A3.E8.m2.3.3.1.1.4.cmml"></mi><mo id="A3.E8.m2.3.3.1.1.3" xref="A3.E8.m2.3.3.1.1.3.cmml">=</mo><mrow id="A3.E8.m2.3.3.1.1.2" xref="A3.E8.m2.3.3.1.1.2.cmml"><mrow id="A3.E8.m2.3.3.1.1.1.1" xref="A3.E8.m2.3.3.1.1.1.1.cmml"><msub id="A3.E8.m2.3.3.1.1.1.1.3" xref="A3.E8.m2.3.3.1.1.1.1.3.cmml"><mi id="A3.E8.m2.3.3.1.1.1.1.3.2" xref="A3.E8.m2.3.3.1.1.1.1.3.2.cmml">𝐀</mi><mi id="A3.E8.m2.3.3.1.1.1.1.3.3" xref="A3.E8.m2.3.3.1.1.1.1.3.3.cmml">t</mi></msub><mo id="A3.E8.m2.3.3.1.1.1.1.2" xref="A3.E8.m2.3.3.1.1.1.1.2.cmml">⁢</mo><mrow id="A3.E8.m2.3.3.1.1.1.1.1.1" xref="A3.E8.m2.3.3.1.1.1.1.1.1.1.cmml"><mo id="A3.E8.m2.3.3.1.1.1.1.1.1.2" stretchy="false" xref="A3.E8.m2.3.3.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="A3.E8.m2.3.3.1.1.1.1.1.1.1" xref="A3.E8.m2.3.3.1.1.1.1.1.1.1.cmml"><mover accent="true" id="A3.E8.m2.3.3.1.1.1.1.1.1.1.2.2" xref="A3.E8.m2.3.3.1.1.1.1.1.1.1.2.2.cmml"><mi id="A3.E8.m2.3.3.1.1.1.1.1.1.1.2.2.2" xref="A3.E8.m2.3.3.1.1.1.1.1.1.1.2.2.2.cmml">𝐇</mi><mo id="A3.E8.m2.3.3.1.1.1.1.1.1.1.2.2.1" xref="A3.E8.m2.3.3.1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mrow id="A3.E8.m2.3.3.1.1.1.1.1.1.1.2.3" xref="A3.E8.m2.3.3.1.1.1.1.1.1.1.2.3.cmml"><mi id="A3.E8.m2.3.3.1.1.1.1.1.1.1.2.3.2" xref="A3.E8.m2.3.3.1.1.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="A3.E8.m2.3.3.1.1.1.1.1.1.1.2.3.1" xref="A3.E8.m2.3.3.1.1.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="A3.E8.m2.3.3.1.1.1.1.1.1.1.2.3.3" xref="A3.E8.m2.3.3.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mrow id="A3.E8.m2.1.1.1.3" xref="A3.E8.m2.1.1.1.2.cmml"><mo id="A3.E8.m2.1.1.1.3.1" stretchy="false" xref="A3.E8.m2.1.1.1.2.1.cmml">[</mo><mi id="A3.E8.m2.1.1.1.1" xref="A3.E8.m2.1.1.1.1.cmml">l</mi><mo id="A3.E8.m2.1.1.1.3.2" stretchy="false" xref="A3.E8.m2.1.1.1.2.1.cmml">]</mo></mrow></msubsup><mo id="A3.E8.m2.3.3.1.1.1.1.1.1.3" stretchy="false" xref="A3.E8.m2.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A3.E8.m2.3.3.1.1.2.3" xref="A3.E8.m2.3.3.1.1.2.3.cmml">+</mo><mrow id="A3.E8.m2.3.3.1.1.2.2" xref="A3.E8.m2.3.3.1.1.2.2.cmml"><msub id="A3.E8.m2.3.3.1.1.2.2.3" xref="A3.E8.m2.3.3.1.1.2.2.3.cmml"><mi id="A3.E8.m2.3.3.1.1.2.2.3.2" xref="A3.E8.m2.3.3.1.1.2.2.3.2.cmml">𝐁</mi><mi id="A3.E8.m2.3.3.1.1.2.2.3.3" xref="A3.E8.m2.3.3.1.1.2.2.3.3.cmml">t</mi></msub><mo id="A3.E8.m2.3.3.1.1.2.2.2" xref="A3.E8.m2.3.3.1.1.2.2.2.cmml">⁢</mo><mrow id="A3.E8.m2.3.3.1.1.2.2.1.1" xref="A3.E8.m2.3.3.1.1.2.2.1.1.1.cmml"><mo id="A3.E8.m2.3.3.1.1.2.2.1.1.2" stretchy="false" xref="A3.E8.m2.3.3.1.1.2.2.1.1.1.cmml">(</mo><msubsup id="A3.E8.m2.3.3.1.1.2.2.1.1.1" xref="A3.E8.m2.3.3.1.1.2.2.1.1.1.cmml"><mi id="A3.E8.m2.3.3.1.1.2.2.1.1.1.2.2" xref="A3.E8.m2.3.3.1.1.2.2.1.1.1.2.2.cmml">𝐅</mi><mi id="A3.E8.m2.3.3.1.1.2.2.1.1.1.2.3" xref="A3.E8.m2.3.3.1.1.2.2.1.1.1.2.3.cmml">t</mi><mrow id="A3.E8.m2.2.2.1.3" xref="A3.E8.m2.2.2.1.2.cmml"><mo id="A3.E8.m2.2.2.1.3.1" stretchy="false" xref="A3.E8.m2.2.2.1.2.1.cmml">[</mo><mi id="A3.E8.m2.2.2.1.1" xref="A3.E8.m2.2.2.1.1.cmml">l</mi><mo id="A3.E8.m2.2.2.1.3.2" stretchy="false" xref="A3.E8.m2.2.2.1.2.1.cmml">]</mo></mrow></msubsup><mo id="A3.E8.m2.3.3.1.1.2.2.1.1.3" stretchy="false" xref="A3.E8.m2.3.3.1.1.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A3.E8.m2.3.3.1.2" xref="A3.E8.m2.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E8.m2.3b"><apply id="A3.E8.m2.3.3.1.1.cmml" xref="A3.E8.m2.3.3.1"><eq id="A3.E8.m2.3.3.1.1.3.cmml" xref="A3.E8.m2.3.3.1.1.3"></eq><csymbol cd="latexml" id="A3.E8.m2.3.3.1.1.4.cmml" xref="A3.E8.m2.3.3.1.1.4">absent</csymbol><apply id="A3.E8.m2.3.3.1.1.2.cmml" xref="A3.E8.m2.3.3.1.1.2"><plus id="A3.E8.m2.3.3.1.1.2.3.cmml" xref="A3.E8.m2.3.3.1.1.2.3"></plus><apply id="A3.E8.m2.3.3.1.1.1.1.cmml" xref="A3.E8.m2.3.3.1.1.1.1"><times id="A3.E8.m2.3.3.1.1.1.1.2.cmml" xref="A3.E8.m2.3.3.1.1.1.1.2"></times><apply id="A3.E8.m2.3.3.1.1.1.1.3.cmml" xref="A3.E8.m2.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E8.m2.3.3.1.1.1.1.3.1.cmml" xref="A3.E8.m2.3.3.1.1.1.1.3">subscript</csymbol><ci id="A3.E8.m2.3.3.1.1.1.1.3.2.cmml" xref="A3.E8.m2.3.3.1.1.1.1.3.2">𝐀</ci><ci id="A3.E8.m2.3.3.1.1.1.1.3.3.cmml" xref="A3.E8.m2.3.3.1.1.1.1.3.3">𝑡</ci></apply><apply id="A3.E8.m2.3.3.1.1.1.1.1.1.1.cmml" xref="A3.E8.m2.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E8.m2.3.3.1.1.1.1.1.1.1.1.cmml" xref="A3.E8.m2.3.3.1.1.1.1.1.1">superscript</csymbol><apply id="A3.E8.m2.3.3.1.1.1.1.1.1.1.2.cmml" xref="A3.E8.m2.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E8.m2.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="A3.E8.m2.3.3.1.1.1.1.1.1">subscript</csymbol><apply id="A3.E8.m2.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="A3.E8.m2.3.3.1.1.1.1.1.1.1.2.2"><ci id="A3.E8.m2.3.3.1.1.1.1.1.1.1.2.2.1.cmml" xref="A3.E8.m2.3.3.1.1.1.1.1.1.1.2.2.1">^</ci><ci id="A3.E8.m2.3.3.1.1.1.1.1.1.1.2.2.2.cmml" xref="A3.E8.m2.3.3.1.1.1.1.1.1.1.2.2.2">𝐇</ci></apply><apply id="A3.E8.m2.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="A3.E8.m2.3.3.1.1.1.1.1.1.1.2.3"><minus id="A3.E8.m2.3.3.1.1.1.1.1.1.1.2.3.1.cmml" xref="A3.E8.m2.3.3.1.1.1.1.1.1.1.2.3.1"></minus><ci id="A3.E8.m2.3.3.1.1.1.1.1.1.1.2.3.2.cmml" xref="A3.E8.m2.3.3.1.1.1.1.1.1.1.2.3.2">𝑡</ci><cn id="A3.E8.m2.3.3.1.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="A3.E8.m2.3.3.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="A3.E8.m2.1.1.1.2.cmml" xref="A3.E8.m2.1.1.1.3"><csymbol cd="latexml" id="A3.E8.m2.1.1.1.2.1.cmml" xref="A3.E8.m2.1.1.1.3.1">delimited-[]</csymbol><ci id="A3.E8.m2.1.1.1.1.cmml" xref="A3.E8.m2.1.1.1.1">𝑙</ci></apply></apply></apply><apply id="A3.E8.m2.3.3.1.1.2.2.cmml" xref="A3.E8.m2.3.3.1.1.2.2"><times id="A3.E8.m2.3.3.1.1.2.2.2.cmml" xref="A3.E8.m2.3.3.1.1.2.2.2"></times><apply id="A3.E8.m2.3.3.1.1.2.2.3.cmml" xref="A3.E8.m2.3.3.1.1.2.2.3"><csymbol cd="ambiguous" id="A3.E8.m2.3.3.1.1.2.2.3.1.cmml" xref="A3.E8.m2.3.3.1.1.2.2.3">subscript</csymbol><ci id="A3.E8.m2.3.3.1.1.2.2.3.2.cmml" xref="A3.E8.m2.3.3.1.1.2.2.3.2">𝐁</ci><ci id="A3.E8.m2.3.3.1.1.2.2.3.3.cmml" xref="A3.E8.m2.3.3.1.1.2.2.3.3">𝑡</ci></apply><apply id="A3.E8.m2.3.3.1.1.2.2.1.1.1.cmml" xref="A3.E8.m2.3.3.1.1.2.2.1.1"><csymbol cd="ambiguous" id="A3.E8.m2.3.3.1.1.2.2.1.1.1.1.cmml" xref="A3.E8.m2.3.3.1.1.2.2.1.1">superscript</csymbol><apply id="A3.E8.m2.3.3.1.1.2.2.1.1.1.2.cmml" xref="A3.E8.m2.3.3.1.1.2.2.1.1"><csymbol cd="ambiguous" id="A3.E8.m2.3.3.1.1.2.2.1.1.1.2.1.cmml" xref="A3.E8.m2.3.3.1.1.2.2.1.1">subscript</csymbol><ci id="A3.E8.m2.3.3.1.1.2.2.1.1.1.2.2.cmml" xref="A3.E8.m2.3.3.1.1.2.2.1.1.1.2.2">𝐅</ci><ci id="A3.E8.m2.3.3.1.1.2.2.1.1.1.2.3.cmml" xref="A3.E8.m2.3.3.1.1.2.2.1.1.1.2.3">𝑡</ci></apply><apply id="A3.E8.m2.2.2.1.2.cmml" xref="A3.E8.m2.2.2.1.3"><csymbol cd="latexml" id="A3.E8.m2.2.2.1.2.1.cmml" xref="A3.E8.m2.2.2.1.3.1">delimited-[]</csymbol><ci id="A3.E8.m2.2.2.1.1.cmml" xref="A3.E8.m2.2.2.1.1">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E8.m2.3c">\displaystyle=\mathbf{A}_{t}(\mathbf{\hat{H}}_{t-1}^{[l]})+\mathbf{B}_{t}(%
\mathbf{F}_{t}^{[l]}),</annotation><annotation encoding="application/x-llamapun" id="A3.E8.m2.3d">= bold_A start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( over^ start_ARG bold_H end_ARG start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT ) + bold_B start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_F start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
<tbody id="A3.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{y}_{t}^{[l]}" class="ltx_Math" display="inline" id="A3.E9.m1.1"><semantics id="A3.E9.m1.1a"><msubsup id="A3.E9.m1.1.2" xref="A3.E9.m1.1.2.cmml"><mi id="A3.E9.m1.1.2.2.2" xref="A3.E9.m1.1.2.2.2.cmml">𝐲</mi><mi id="A3.E9.m1.1.2.2.3" xref="A3.E9.m1.1.2.2.3.cmml">t</mi><mrow id="A3.E9.m1.1.1.1.3" xref="A3.E9.m1.1.1.1.2.cmml"><mo id="A3.E9.m1.1.1.1.3.1" stretchy="false" xref="A3.E9.m1.1.1.1.2.1.cmml">[</mo><mi id="A3.E9.m1.1.1.1.1" xref="A3.E9.m1.1.1.1.1.cmml">l</mi><mo id="A3.E9.m1.1.1.1.3.2" stretchy="false" xref="A3.E9.m1.1.1.1.2.1.cmml">]</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A3.E9.m1.1b"><apply id="A3.E9.m1.1.2.cmml" xref="A3.E9.m1.1.2"><csymbol cd="ambiguous" id="A3.E9.m1.1.2.1.cmml" xref="A3.E9.m1.1.2">superscript</csymbol><apply id="A3.E9.m1.1.2.2.cmml" xref="A3.E9.m1.1.2"><csymbol cd="ambiguous" id="A3.E9.m1.1.2.2.1.cmml" xref="A3.E9.m1.1.2">subscript</csymbol><ci id="A3.E9.m1.1.2.2.2.cmml" xref="A3.E9.m1.1.2.2.2">𝐲</ci><ci id="A3.E9.m1.1.2.2.3.cmml" xref="A3.E9.m1.1.2.2.3">𝑡</ci></apply><apply id="A3.E9.m1.1.1.1.2.cmml" xref="A3.E9.m1.1.1.1.3"><csymbol cd="latexml" id="A3.E9.m1.1.1.1.2.1.cmml" xref="A3.E9.m1.1.1.1.3.1">delimited-[]</csymbol><ci id="A3.E9.m1.1.1.1.1.cmml" xref="A3.E9.m1.1.1.1.1">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E9.m1.1c">\displaystyle\mathbf{y}_{t}^{[l]}</annotation><annotation encoding="application/x-llamapun" id="A3.E9.m1.1d">bold_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbf{C}_{t}(\mathbf{\hat{H}}_{t}^{[l]})," class="ltx_Math" display="inline" id="A3.E9.m2.2"><semantics id="A3.E9.m2.2a"><mrow id="A3.E9.m2.2.2.1" xref="A3.E9.m2.2.2.1.1.cmml"><mrow id="A3.E9.m2.2.2.1.1" xref="A3.E9.m2.2.2.1.1.cmml"><mi id="A3.E9.m2.2.2.1.1.3" xref="A3.E9.m2.2.2.1.1.3.cmml"></mi><mo id="A3.E9.m2.2.2.1.1.2" xref="A3.E9.m2.2.2.1.1.2.cmml">=</mo><mrow id="A3.E9.m2.2.2.1.1.1" xref="A3.E9.m2.2.2.1.1.1.cmml"><msub id="A3.E9.m2.2.2.1.1.1.3" xref="A3.E9.m2.2.2.1.1.1.3.cmml"><mi id="A3.E9.m2.2.2.1.1.1.3.2" xref="A3.E9.m2.2.2.1.1.1.3.2.cmml">𝐂</mi><mi id="A3.E9.m2.2.2.1.1.1.3.3" xref="A3.E9.m2.2.2.1.1.1.3.3.cmml">t</mi></msub><mo id="A3.E9.m2.2.2.1.1.1.2" xref="A3.E9.m2.2.2.1.1.1.2.cmml">⁢</mo><mrow id="A3.E9.m2.2.2.1.1.1.1.1" xref="A3.E9.m2.2.2.1.1.1.1.1.1.cmml"><mo id="A3.E9.m2.2.2.1.1.1.1.1.2" stretchy="false" xref="A3.E9.m2.2.2.1.1.1.1.1.1.cmml">(</mo><msubsup id="A3.E9.m2.2.2.1.1.1.1.1.1" xref="A3.E9.m2.2.2.1.1.1.1.1.1.cmml"><mover accent="true" id="A3.E9.m2.2.2.1.1.1.1.1.1.2.2" xref="A3.E9.m2.2.2.1.1.1.1.1.1.2.2.cmml"><mi id="A3.E9.m2.2.2.1.1.1.1.1.1.2.2.2" xref="A3.E9.m2.2.2.1.1.1.1.1.1.2.2.2.cmml">𝐇</mi><mo id="A3.E9.m2.2.2.1.1.1.1.1.1.2.2.1" xref="A3.E9.m2.2.2.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="A3.E9.m2.2.2.1.1.1.1.1.1.2.3" xref="A3.E9.m2.2.2.1.1.1.1.1.1.2.3.cmml">t</mi><mrow id="A3.E9.m2.1.1.1.3" xref="A3.E9.m2.1.1.1.2.cmml"><mo id="A3.E9.m2.1.1.1.3.1" stretchy="false" xref="A3.E9.m2.1.1.1.2.1.cmml">[</mo><mi id="A3.E9.m2.1.1.1.1" xref="A3.E9.m2.1.1.1.1.cmml">l</mi><mo id="A3.E9.m2.1.1.1.3.2" stretchy="false" xref="A3.E9.m2.1.1.1.2.1.cmml">]</mo></mrow></msubsup><mo id="A3.E9.m2.2.2.1.1.1.1.1.3" stretchy="false" xref="A3.E9.m2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A3.E9.m2.2.2.1.2" xref="A3.E9.m2.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E9.m2.2b"><apply id="A3.E9.m2.2.2.1.1.cmml" xref="A3.E9.m2.2.2.1"><eq id="A3.E9.m2.2.2.1.1.2.cmml" xref="A3.E9.m2.2.2.1.1.2"></eq><csymbol cd="latexml" id="A3.E9.m2.2.2.1.1.3.cmml" xref="A3.E9.m2.2.2.1.1.3">absent</csymbol><apply id="A3.E9.m2.2.2.1.1.1.cmml" xref="A3.E9.m2.2.2.1.1.1"><times id="A3.E9.m2.2.2.1.1.1.2.cmml" xref="A3.E9.m2.2.2.1.1.1.2"></times><apply id="A3.E9.m2.2.2.1.1.1.3.cmml" xref="A3.E9.m2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="A3.E9.m2.2.2.1.1.1.3.1.cmml" xref="A3.E9.m2.2.2.1.1.1.3">subscript</csymbol><ci id="A3.E9.m2.2.2.1.1.1.3.2.cmml" xref="A3.E9.m2.2.2.1.1.1.3.2">𝐂</ci><ci id="A3.E9.m2.2.2.1.1.1.3.3.cmml" xref="A3.E9.m2.2.2.1.1.1.3.3">𝑡</ci></apply><apply id="A3.E9.m2.2.2.1.1.1.1.1.1.cmml" xref="A3.E9.m2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E9.m2.2.2.1.1.1.1.1.1.1.cmml" xref="A3.E9.m2.2.2.1.1.1.1.1">superscript</csymbol><apply id="A3.E9.m2.2.2.1.1.1.1.1.1.2.cmml" xref="A3.E9.m2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E9.m2.2.2.1.1.1.1.1.1.2.1.cmml" xref="A3.E9.m2.2.2.1.1.1.1.1">subscript</csymbol><apply id="A3.E9.m2.2.2.1.1.1.1.1.1.2.2.cmml" xref="A3.E9.m2.2.2.1.1.1.1.1.1.2.2"><ci id="A3.E9.m2.2.2.1.1.1.1.1.1.2.2.1.cmml" xref="A3.E9.m2.2.2.1.1.1.1.1.1.2.2.1">^</ci><ci id="A3.E9.m2.2.2.1.1.1.1.1.1.2.2.2.cmml" xref="A3.E9.m2.2.2.1.1.1.1.1.1.2.2.2">𝐇</ci></apply><ci id="A3.E9.m2.2.2.1.1.1.1.1.1.2.3.cmml" xref="A3.E9.m2.2.2.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="A3.E9.m2.1.1.1.2.cmml" xref="A3.E9.m2.1.1.1.3"><csymbol cd="latexml" id="A3.E9.m2.1.1.1.2.1.cmml" xref="A3.E9.m2.1.1.1.3.1">delimited-[]</csymbol><ci id="A3.E9.m2.1.1.1.1.cmml" xref="A3.E9.m2.1.1.1.1">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E9.m2.2c">\displaystyle=\mathbf{C}_{t}(\mathbf{\hat{H}}_{t}^{[l]}),</annotation><annotation encoding="application/x-llamapun" id="A3.E9.m2.2d">= bold_C start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( over^ start_ARG bold_H end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
</div>
</div>
<div class="ltx_para" id="A3.p2">
<p class="ltx_p" id="A3.p2.5">where <math alttext="\mathbf{A}_{t}" class="ltx_Math" display="inline" id="A3.p2.1.m1.1"><semantics id="A3.p2.1.m1.1a"><msub id="A3.p2.1.m1.1.1" xref="A3.p2.1.m1.1.1.cmml"><mi id="A3.p2.1.m1.1.1.2" xref="A3.p2.1.m1.1.1.2.cmml">𝐀</mi><mi id="A3.p2.1.m1.1.1.3" xref="A3.p2.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p2.1.m1.1b"><apply id="A3.p2.1.m1.1.1.cmml" xref="A3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="A3.p2.1.m1.1.1.1.cmml" xref="A3.p2.1.m1.1.1">subscript</csymbol><ci id="A3.p2.1.m1.1.1.2.cmml" xref="A3.p2.1.m1.1.1.2">𝐀</ci><ci id="A3.p2.1.m1.1.1.3.cmml" xref="A3.p2.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.1.m1.1c">\mathbf{A}_{t}</annotation><annotation encoding="application/x-llamapun" id="A3.p2.1.m1.1d">bold_A start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{B}_{t}" class="ltx_Math" display="inline" id="A3.p2.2.m2.1"><semantics id="A3.p2.2.m2.1a"><msub id="A3.p2.2.m2.1.1" xref="A3.p2.2.m2.1.1.cmml"><mi id="A3.p2.2.m2.1.1.2" xref="A3.p2.2.m2.1.1.2.cmml">𝐁</mi><mi id="A3.p2.2.m2.1.1.3" xref="A3.p2.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p2.2.m2.1b"><apply id="A3.p2.2.m2.1.1.cmml" xref="A3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="A3.p2.2.m2.1.1.1.cmml" xref="A3.p2.2.m2.1.1">subscript</csymbol><ci id="A3.p2.2.m2.1.1.2.cmml" xref="A3.p2.2.m2.1.1.2">𝐁</ci><ci id="A3.p2.2.m2.1.1.3.cmml" xref="A3.p2.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.2.m2.1c">\mathbf{B}_{t}</annotation><annotation encoding="application/x-llamapun" id="A3.p2.2.m2.1d">bold_B start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{C}_{t}" class="ltx_Math" display="inline" id="A3.p2.3.m3.1"><semantics id="A3.p2.3.m3.1a"><msub id="A3.p2.3.m3.1.1" xref="A3.p2.3.m3.1.1.cmml"><mi id="A3.p2.3.m3.1.1.2" xref="A3.p2.3.m3.1.1.2.cmml">𝐂</mi><mi id="A3.p2.3.m3.1.1.3" xref="A3.p2.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p2.3.m3.1b"><apply id="A3.p2.3.m3.1.1.cmml" xref="A3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="A3.p2.3.m3.1.1.1.cmml" xref="A3.p2.3.m3.1.1">subscript</csymbol><ci id="A3.p2.3.m3.1.1.2.cmml" xref="A3.p2.3.m3.1.1.2">𝐂</ci><ci id="A3.p2.3.m3.1.1.3.cmml" xref="A3.p2.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.3.m3.1c">\mathbf{C}_{t}</annotation><annotation encoding="application/x-llamapun" id="A3.p2.3.m3.1d">bold_C start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> are parameters learned through gradient descent, and <math alttext="\mathbf{F}_{t}^{[l]}" class="ltx_Math" display="inline" id="A3.p2.4.m4.1"><semantics id="A3.p2.4.m4.1a"><msubsup id="A3.p2.4.m4.1.2" xref="A3.p2.4.m4.1.2.cmml"><mi id="A3.p2.4.m4.1.2.2.2" xref="A3.p2.4.m4.1.2.2.2.cmml">𝐅</mi><mi id="A3.p2.4.m4.1.2.2.3" xref="A3.p2.4.m4.1.2.2.3.cmml">t</mi><mrow id="A3.p2.4.m4.1.1.1.3" xref="A3.p2.4.m4.1.1.1.2.cmml"><mo id="A3.p2.4.m4.1.1.1.3.1" stretchy="false" xref="A3.p2.4.m4.1.1.1.2.1.cmml">[</mo><mi id="A3.p2.4.m4.1.1.1.1" xref="A3.p2.4.m4.1.1.1.1.cmml">l</mi><mo id="A3.p2.4.m4.1.1.1.3.2" stretchy="false" xref="A3.p2.4.m4.1.1.1.2.1.cmml">]</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A3.p2.4.m4.1b"><apply id="A3.p2.4.m4.1.2.cmml" xref="A3.p2.4.m4.1.2"><csymbol cd="ambiguous" id="A3.p2.4.m4.1.2.1.cmml" xref="A3.p2.4.m4.1.2">superscript</csymbol><apply id="A3.p2.4.m4.1.2.2.cmml" xref="A3.p2.4.m4.1.2"><csymbol cd="ambiguous" id="A3.p2.4.m4.1.2.2.1.cmml" xref="A3.p2.4.m4.1.2">subscript</csymbol><ci id="A3.p2.4.m4.1.2.2.2.cmml" xref="A3.p2.4.m4.1.2.2.2">𝐅</ci><ci id="A3.p2.4.m4.1.2.2.3.cmml" xref="A3.p2.4.m4.1.2.2.3">𝑡</ci></apply><apply id="A3.p2.4.m4.1.1.1.2.cmml" xref="A3.p2.4.m4.1.1.1.3"><csymbol cd="latexml" id="A3.p2.4.m4.1.1.1.2.1.cmml" xref="A3.p2.4.m4.1.1.1.3.1">delimited-[]</csymbol><ci id="A3.p2.4.m4.1.1.1.1.cmml" xref="A3.p2.4.m4.1.1.1.1">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.4.m4.1c">\mathbf{F}_{t}^{[l]}</annotation><annotation encoding="application/x-llamapun" id="A3.p2.4.m4.1d">bold_F start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT [ italic_l ] end_POSTSUPERSCRIPT</annotation></semantics></math> is the input feature map at timestep <math alttext="t" class="ltx_Math" display="inline" id="A3.p2.5.m5.1"><semantics id="A3.p2.5.m5.1a"><mi id="A3.p2.5.m5.1.1" xref="A3.p2.5.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A3.p2.5.m5.1b"><ci id="A3.p2.5.m5.1.1.cmml" xref="A3.p2.5.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.5.m5.1c">t</annotation><annotation encoding="application/x-llamapun" id="A3.p2.5.m5.1d">italic_t</annotation></semantics></math>. In this case, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A3.E8" title="In Lemma C.1. ‣ Appendix C Relationship to State Space Models ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">eq.</span> <span class="ltx_text ltx_ref_tag">8</span></a> is realizable and not flawed, given the motion-compensated input. This assumption allows the model to be learned in a similar fashion to HiPPO <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib18" title="">18</a>]</cite> or Mamba <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib17" title="">17</a>]</cite>. More specifically, the Causal History Model (<span class="ltx_text ltx_font_sansserif" id="A3.p2.5.1">CHM</span>) reduces to an equivalent time-variant and input-dependent flavor of the State Space Model (<span class="ltx_text ltx_font_sansserif" id="A3.p2.5.2">SSM</span>).</p>
</div>
<div class="ltx_proof" id="A3.3">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof 1.</h6>
<div class="ltx_para" id="A3.1.p1">
<p class="ltx_p" id="A3.1.p1.3">Consider a state space model (SSM) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib16" title="">16</a>]</cite> that maps the input signal <math alttext="\mathbf{F}_{t}" class="ltx_Math" display="inline" id="A3.1.p1.1.m1.1"><semantics id="A3.1.p1.1.m1.1a"><msub id="A3.1.p1.1.m1.1.1" xref="A3.1.p1.1.m1.1.1.cmml"><mi id="A3.1.p1.1.m1.1.1.2" xref="A3.1.p1.1.m1.1.1.2.cmml">𝐅</mi><mi id="A3.1.p1.1.m1.1.1.3" xref="A3.1.p1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A3.1.p1.1.m1.1b"><apply id="A3.1.p1.1.m1.1.1.cmml" xref="A3.1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A3.1.p1.1.m1.1.1.1.cmml" xref="A3.1.p1.1.m1.1.1">subscript</csymbol><ci id="A3.1.p1.1.m1.1.1.2.cmml" xref="A3.1.p1.1.m1.1.1.2">𝐅</ci><ci id="A3.1.p1.1.m1.1.1.3.cmml" xref="A3.1.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.1.p1.1.m1.1c">\mathbf{F}_{t}</annotation><annotation encoding="application/x-llamapun" id="A3.1.p1.1.m1.1d">bold_F start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> to the output signal <math alttext="\mathbf{y}_{t}" class="ltx_Math" display="inline" id="A3.1.p1.2.m2.1"><semantics id="A3.1.p1.2.m2.1a"><msub id="A3.1.p1.2.m2.1.1" xref="A3.1.p1.2.m2.1.1.cmml"><mi id="A3.1.p1.2.m2.1.1.2" xref="A3.1.p1.2.m2.1.1.2.cmml">𝐲</mi><mi id="A3.1.p1.2.m2.1.1.3" xref="A3.1.p1.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A3.1.p1.2.m2.1b"><apply id="A3.1.p1.2.m2.1.1.cmml" xref="A3.1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A3.1.p1.2.m2.1.1.1.cmml" xref="A3.1.p1.2.m2.1.1">subscript</csymbol><ci id="A3.1.p1.2.m2.1.1.2.cmml" xref="A3.1.p1.2.m2.1.1.2">𝐲</ci><ci id="A3.1.p1.2.m2.1.1.3.cmml" xref="A3.1.p1.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.1.p1.2.m2.1c">\mathbf{y}_{t}</annotation><annotation encoding="application/x-llamapun" id="A3.1.p1.2.m2.1d">bold_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> through an implicit state <math alttext="\mathbf{H}_{t}" class="ltx_Math" display="inline" id="A3.1.p1.3.m3.1"><semantics id="A3.1.p1.3.m3.1a"><msub id="A3.1.p1.3.m3.1.1" xref="A3.1.p1.3.m3.1.1.cmml"><mi id="A3.1.p1.3.m3.1.1.2" xref="A3.1.p1.3.m3.1.1.2.cmml">𝐇</mi><mi id="A3.1.p1.3.m3.1.1.3" xref="A3.1.p1.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A3.1.p1.3.m3.1b"><apply id="A3.1.p1.3.m3.1.1.cmml" xref="A3.1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A3.1.p1.3.m3.1.1.1.cmml" xref="A3.1.p1.3.m3.1.1">subscript</csymbol><ci id="A3.1.p1.3.m3.1.1.2.cmml" xref="A3.1.p1.3.m3.1.1.2">𝐇</ci><ci id="A3.1.p1.3.m3.1.1.3.cmml" xref="A3.1.p1.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.1.p1.3.m3.1c">\mathbf{H}_{t}</annotation><annotation encoding="application/x-llamapun" id="A3.1.p1.3.m3.1d">bold_H start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, i.e.,</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A7.EGx7">
<tbody id="A3.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{H}_{t}" class="ltx_Math" display="inline" id="A3.E10.m1.1"><semantics id="A3.E10.m1.1a"><msub id="A3.E10.m1.1.1" xref="A3.E10.m1.1.1.cmml"><mi id="A3.E10.m1.1.1.2" xref="A3.E10.m1.1.1.2.cmml">𝐇</mi><mi id="A3.E10.m1.1.1.3" xref="A3.E10.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A3.E10.m1.1b"><apply id="A3.E10.m1.1.1.cmml" xref="A3.E10.m1.1.1"><csymbol cd="ambiguous" id="A3.E10.m1.1.1.1.cmml" xref="A3.E10.m1.1.1">subscript</csymbol><ci id="A3.E10.m1.1.1.2.cmml" xref="A3.E10.m1.1.1.2">𝐇</ci><ci id="A3.E10.m1.1.1.3.cmml" xref="A3.E10.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E10.m1.1c">\displaystyle\mathbf{H}_{t}</annotation><annotation encoding="application/x-llamapun" id="A3.E10.m1.1d">bold_H start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbf{A}(\mathbf{H}_{t-1})+\mathbf{B}(\mathbf{F}_{t})," class="ltx_Math" display="inline" id="A3.E10.m2.1"><semantics id="A3.E10.m2.1a"><mrow id="A3.E10.m2.1.1.1" xref="A3.E10.m2.1.1.1.1.cmml"><mrow id="A3.E10.m2.1.1.1.1" xref="A3.E10.m2.1.1.1.1.cmml"><mi id="A3.E10.m2.1.1.1.1.4" xref="A3.E10.m2.1.1.1.1.4.cmml"></mi><mo id="A3.E10.m2.1.1.1.1.3" xref="A3.E10.m2.1.1.1.1.3.cmml">=</mo><mrow id="A3.E10.m2.1.1.1.1.2" xref="A3.E10.m2.1.1.1.1.2.cmml"><mrow id="A3.E10.m2.1.1.1.1.1.1" xref="A3.E10.m2.1.1.1.1.1.1.cmml"><mi id="A3.E10.m2.1.1.1.1.1.1.3" xref="A3.E10.m2.1.1.1.1.1.1.3.cmml">𝐀</mi><mo id="A3.E10.m2.1.1.1.1.1.1.2" xref="A3.E10.m2.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A3.E10.m2.1.1.1.1.1.1.1.1" xref="A3.E10.m2.1.1.1.1.1.1.1.1.1.cmml"><mo id="A3.E10.m2.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A3.E10.m2.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A3.E10.m2.1.1.1.1.1.1.1.1.1" xref="A3.E10.m2.1.1.1.1.1.1.1.1.1.cmml"><mi id="A3.E10.m2.1.1.1.1.1.1.1.1.1.2" xref="A3.E10.m2.1.1.1.1.1.1.1.1.1.2.cmml">𝐇</mi><mrow id="A3.E10.m2.1.1.1.1.1.1.1.1.1.3" xref="A3.E10.m2.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A3.E10.m2.1.1.1.1.1.1.1.1.1.3.2" xref="A3.E10.m2.1.1.1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="A3.E10.m2.1.1.1.1.1.1.1.1.1.3.1" xref="A3.E10.m2.1.1.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="A3.E10.m2.1.1.1.1.1.1.1.1.1.3.3" xref="A3.E10.m2.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="A3.E10.m2.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A3.E10.m2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A3.E10.m2.1.1.1.1.2.3" xref="A3.E10.m2.1.1.1.1.2.3.cmml">+</mo><mrow id="A3.E10.m2.1.1.1.1.2.2" xref="A3.E10.m2.1.1.1.1.2.2.cmml"><mi id="A3.E10.m2.1.1.1.1.2.2.3" xref="A3.E10.m2.1.1.1.1.2.2.3.cmml">𝐁</mi><mo id="A3.E10.m2.1.1.1.1.2.2.2" xref="A3.E10.m2.1.1.1.1.2.2.2.cmml">⁢</mo><mrow id="A3.E10.m2.1.1.1.1.2.2.1.1" xref="A3.E10.m2.1.1.1.1.2.2.1.1.1.cmml"><mo id="A3.E10.m2.1.1.1.1.2.2.1.1.2" stretchy="false" xref="A3.E10.m2.1.1.1.1.2.2.1.1.1.cmml">(</mo><msub id="A3.E10.m2.1.1.1.1.2.2.1.1.1" xref="A3.E10.m2.1.1.1.1.2.2.1.1.1.cmml"><mi id="A3.E10.m2.1.1.1.1.2.2.1.1.1.2" xref="A3.E10.m2.1.1.1.1.2.2.1.1.1.2.cmml">𝐅</mi><mi id="A3.E10.m2.1.1.1.1.2.2.1.1.1.3" xref="A3.E10.m2.1.1.1.1.2.2.1.1.1.3.cmml">t</mi></msub><mo id="A3.E10.m2.1.1.1.1.2.2.1.1.3" stretchy="false" xref="A3.E10.m2.1.1.1.1.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A3.E10.m2.1.1.1.2" xref="A3.E10.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E10.m2.1b"><apply id="A3.E10.m2.1.1.1.1.cmml" xref="A3.E10.m2.1.1.1"><eq id="A3.E10.m2.1.1.1.1.3.cmml" xref="A3.E10.m2.1.1.1.1.3"></eq><csymbol cd="latexml" id="A3.E10.m2.1.1.1.1.4.cmml" xref="A3.E10.m2.1.1.1.1.4">absent</csymbol><apply id="A3.E10.m2.1.1.1.1.2.cmml" xref="A3.E10.m2.1.1.1.1.2"><plus id="A3.E10.m2.1.1.1.1.2.3.cmml" xref="A3.E10.m2.1.1.1.1.2.3"></plus><apply id="A3.E10.m2.1.1.1.1.1.1.cmml" xref="A3.E10.m2.1.1.1.1.1.1"><times id="A3.E10.m2.1.1.1.1.1.1.2.cmml" xref="A3.E10.m2.1.1.1.1.1.1.2"></times><ci id="A3.E10.m2.1.1.1.1.1.1.3.cmml" xref="A3.E10.m2.1.1.1.1.1.1.3">𝐀</ci><apply id="A3.E10.m2.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E10.m2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E10.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E10.m2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A3.E10.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E10.m2.1.1.1.1.1.1.1.1.1.2">𝐇</ci><apply id="A3.E10.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="A3.E10.m2.1.1.1.1.1.1.1.1.1.3"><minus id="A3.E10.m2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A3.E10.m2.1.1.1.1.1.1.1.1.1.3.1"></minus><ci id="A3.E10.m2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A3.E10.m2.1.1.1.1.1.1.1.1.1.3.2">𝑡</ci><cn id="A3.E10.m2.1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="A3.E10.m2.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply><apply id="A3.E10.m2.1.1.1.1.2.2.cmml" xref="A3.E10.m2.1.1.1.1.2.2"><times id="A3.E10.m2.1.1.1.1.2.2.2.cmml" xref="A3.E10.m2.1.1.1.1.2.2.2"></times><ci id="A3.E10.m2.1.1.1.1.2.2.3.cmml" xref="A3.E10.m2.1.1.1.1.2.2.3">𝐁</ci><apply id="A3.E10.m2.1.1.1.1.2.2.1.1.1.cmml" xref="A3.E10.m2.1.1.1.1.2.2.1.1"><csymbol cd="ambiguous" id="A3.E10.m2.1.1.1.1.2.2.1.1.1.1.cmml" xref="A3.E10.m2.1.1.1.1.2.2.1.1">subscript</csymbol><ci id="A3.E10.m2.1.1.1.1.2.2.1.1.1.2.cmml" xref="A3.E10.m2.1.1.1.1.2.2.1.1.1.2">𝐅</ci><ci id="A3.E10.m2.1.1.1.1.2.2.1.1.1.3.cmml" xref="A3.E10.m2.1.1.1.1.2.2.1.1.1.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E10.m2.1c">\displaystyle=\mathbf{A}(\mathbf{H}_{t-1})+\mathbf{B}(\mathbf{F}_{t}),</annotation><annotation encoding="application/x-llamapun" id="A3.E10.m2.1d">= bold_A ( bold_H start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT ) + bold_B ( bold_F start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
<tbody id="A3.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{y}_{t}" class="ltx_Math" display="inline" id="A3.E11.m1.1"><semantics id="A3.E11.m1.1a"><msub id="A3.E11.m1.1.1" xref="A3.E11.m1.1.1.cmml"><mi id="A3.E11.m1.1.1.2" xref="A3.E11.m1.1.1.2.cmml">𝐲</mi><mi id="A3.E11.m1.1.1.3" xref="A3.E11.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A3.E11.m1.1b"><apply id="A3.E11.m1.1.1.cmml" xref="A3.E11.m1.1.1"><csymbol cd="ambiguous" id="A3.E11.m1.1.1.1.cmml" xref="A3.E11.m1.1.1">subscript</csymbol><ci id="A3.E11.m1.1.1.2.cmml" xref="A3.E11.m1.1.1.2">𝐲</ci><ci id="A3.E11.m1.1.1.3.cmml" xref="A3.E11.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E11.m1.1c">\displaystyle\mathbf{y}_{t}</annotation><annotation encoding="application/x-llamapun" id="A3.E11.m1.1d">bold_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbf{C}(\mathbf{H}_{t})." class="ltx_Math" display="inline" id="A3.E11.m2.1"><semantics id="A3.E11.m2.1a"><mrow id="A3.E11.m2.1.1.1" xref="A3.E11.m2.1.1.1.1.cmml"><mrow id="A3.E11.m2.1.1.1.1" xref="A3.E11.m2.1.1.1.1.cmml"><mi id="A3.E11.m2.1.1.1.1.3" xref="A3.E11.m2.1.1.1.1.3.cmml"></mi><mo id="A3.E11.m2.1.1.1.1.2" xref="A3.E11.m2.1.1.1.1.2.cmml">=</mo><mrow id="A3.E11.m2.1.1.1.1.1" xref="A3.E11.m2.1.1.1.1.1.cmml"><mi id="A3.E11.m2.1.1.1.1.1.3" xref="A3.E11.m2.1.1.1.1.1.3.cmml">𝐂</mi><mo id="A3.E11.m2.1.1.1.1.1.2" xref="A3.E11.m2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A3.E11.m2.1.1.1.1.1.1.1" xref="A3.E11.m2.1.1.1.1.1.1.1.1.cmml"><mo id="A3.E11.m2.1.1.1.1.1.1.1.2" stretchy="false" xref="A3.E11.m2.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A3.E11.m2.1.1.1.1.1.1.1.1" xref="A3.E11.m2.1.1.1.1.1.1.1.1.cmml"><mi id="A3.E11.m2.1.1.1.1.1.1.1.1.2" xref="A3.E11.m2.1.1.1.1.1.1.1.1.2.cmml">𝐇</mi><mi id="A3.E11.m2.1.1.1.1.1.1.1.1.3" xref="A3.E11.m2.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="A3.E11.m2.1.1.1.1.1.1.1.3" stretchy="false" xref="A3.E11.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A3.E11.m2.1.1.1.2" lspace="0em" xref="A3.E11.m2.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E11.m2.1b"><apply id="A3.E11.m2.1.1.1.1.cmml" xref="A3.E11.m2.1.1.1"><eq id="A3.E11.m2.1.1.1.1.2.cmml" xref="A3.E11.m2.1.1.1.1.2"></eq><csymbol cd="latexml" id="A3.E11.m2.1.1.1.1.3.cmml" xref="A3.E11.m2.1.1.1.1.3">absent</csymbol><apply id="A3.E11.m2.1.1.1.1.1.cmml" xref="A3.E11.m2.1.1.1.1.1"><times id="A3.E11.m2.1.1.1.1.1.2.cmml" xref="A3.E11.m2.1.1.1.1.1.2"></times><ci id="A3.E11.m2.1.1.1.1.1.3.cmml" xref="A3.E11.m2.1.1.1.1.1.3">𝐂</ci><apply id="A3.E11.m2.1.1.1.1.1.1.1.1.cmml" xref="A3.E11.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E11.m2.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E11.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="A3.E11.m2.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E11.m2.1.1.1.1.1.1.1.1.2">𝐇</ci><ci id="A3.E11.m2.1.1.1.1.1.1.1.1.3.cmml" xref="A3.E11.m2.1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E11.m2.1c">\displaystyle=\mathbf{C}(\mathbf{H}_{t}).</annotation><annotation encoding="application/x-llamapun" id="A3.E11.m2.1d">= bold_C ( bold_H start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A3.1.p1.6">In the above equations, we abuse the SSM notation of exposition. Recall that we consider the special case wherein the motion is compensated for, and there is no degradation in the input video. In this case, we can say that history and motion-compensated history are equal i.e., <math alttext="\mathbf{\hat{H}}_{t}=\mathbf{H}_{t}" class="ltx_Math" display="inline" id="A3.1.p1.4.m1.1"><semantics id="A3.1.p1.4.m1.1a"><mrow id="A3.1.p1.4.m1.1.1" xref="A3.1.p1.4.m1.1.1.cmml"><msub id="A3.1.p1.4.m1.1.1.2" xref="A3.1.p1.4.m1.1.1.2.cmml"><mover accent="true" id="A3.1.p1.4.m1.1.1.2.2" xref="A3.1.p1.4.m1.1.1.2.2.cmml"><mi id="A3.1.p1.4.m1.1.1.2.2.2" xref="A3.1.p1.4.m1.1.1.2.2.2.cmml">𝐇</mi><mo id="A3.1.p1.4.m1.1.1.2.2.1" xref="A3.1.p1.4.m1.1.1.2.2.1.cmml">^</mo></mover><mi id="A3.1.p1.4.m1.1.1.2.3" xref="A3.1.p1.4.m1.1.1.2.3.cmml">t</mi></msub><mo id="A3.1.p1.4.m1.1.1.1" xref="A3.1.p1.4.m1.1.1.1.cmml">=</mo><msub id="A3.1.p1.4.m1.1.1.3" xref="A3.1.p1.4.m1.1.1.3.cmml"><mi id="A3.1.p1.4.m1.1.1.3.2" xref="A3.1.p1.4.m1.1.1.3.2.cmml">𝐇</mi><mi id="A3.1.p1.4.m1.1.1.3.3" xref="A3.1.p1.4.m1.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A3.1.p1.4.m1.1b"><apply id="A3.1.p1.4.m1.1.1.cmml" xref="A3.1.p1.4.m1.1.1"><eq id="A3.1.p1.4.m1.1.1.1.cmml" xref="A3.1.p1.4.m1.1.1.1"></eq><apply id="A3.1.p1.4.m1.1.1.2.cmml" xref="A3.1.p1.4.m1.1.1.2"><csymbol cd="ambiguous" id="A3.1.p1.4.m1.1.1.2.1.cmml" xref="A3.1.p1.4.m1.1.1.2">subscript</csymbol><apply id="A3.1.p1.4.m1.1.1.2.2.cmml" xref="A3.1.p1.4.m1.1.1.2.2"><ci id="A3.1.p1.4.m1.1.1.2.2.1.cmml" xref="A3.1.p1.4.m1.1.1.2.2.1">^</ci><ci id="A3.1.p1.4.m1.1.1.2.2.2.cmml" xref="A3.1.p1.4.m1.1.1.2.2.2">𝐇</ci></apply><ci id="A3.1.p1.4.m1.1.1.2.3.cmml" xref="A3.1.p1.4.m1.1.1.2.3">𝑡</ci></apply><apply id="A3.1.p1.4.m1.1.1.3.cmml" xref="A3.1.p1.4.m1.1.1.3"><csymbol cd="ambiguous" id="A3.1.p1.4.m1.1.1.3.1.cmml" xref="A3.1.p1.4.m1.1.1.3">subscript</csymbol><ci id="A3.1.p1.4.m1.1.1.3.2.cmml" xref="A3.1.p1.4.m1.1.1.3.2">𝐇</ci><ci id="A3.1.p1.4.m1.1.1.3.3.cmml" xref="A3.1.p1.4.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.1.p1.4.m1.1c">\mathbf{\hat{H}}_{t}=\mathbf{H}_{t}</annotation><annotation encoding="application/x-llamapun" id="A3.1.p1.4.m1.1d">over^ start_ARG bold_H end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = bold_H start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. Now, consider the first frame of the video at timestep <math alttext="t=0" class="ltx_Math" display="inline" id="A3.1.p1.5.m2.1"><semantics id="A3.1.p1.5.m2.1a"><mrow id="A3.1.p1.5.m2.1.1" xref="A3.1.p1.5.m2.1.1.cmml"><mi id="A3.1.p1.5.m2.1.1.2" xref="A3.1.p1.5.m2.1.1.2.cmml">t</mi><mo id="A3.1.p1.5.m2.1.1.1" xref="A3.1.p1.5.m2.1.1.1.cmml">=</mo><mn id="A3.1.p1.5.m2.1.1.3" xref="A3.1.p1.5.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.1.p1.5.m2.1b"><apply id="A3.1.p1.5.m2.1.1.cmml" xref="A3.1.p1.5.m2.1.1"><eq id="A3.1.p1.5.m2.1.1.1.cmml" xref="A3.1.p1.5.m2.1.1.1"></eq><ci id="A3.1.p1.5.m2.1.1.2.cmml" xref="A3.1.p1.5.m2.1.1.2">𝑡</ci><cn id="A3.1.p1.5.m2.1.1.3.cmml" type="integer" xref="A3.1.p1.5.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.1.p1.5.m2.1c">t=0</annotation><annotation encoding="application/x-llamapun" id="A3.1.p1.5.m2.1d">italic_t = 0</annotation></semantics></math>. Let the initial condition be denoted by <math alttext="\mathbf{F}_{0}" class="ltx_Math" display="inline" id="A3.1.p1.6.m3.1"><semantics id="A3.1.p1.6.m3.1a"><msub id="A3.1.p1.6.m3.1.1" xref="A3.1.p1.6.m3.1.1.cmml"><mi id="A3.1.p1.6.m3.1.1.2" xref="A3.1.p1.6.m3.1.1.2.cmml">𝐅</mi><mn id="A3.1.p1.6.m3.1.1.3" xref="A3.1.p1.6.m3.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="A3.1.p1.6.m3.1b"><apply id="A3.1.p1.6.m3.1.1.cmml" xref="A3.1.p1.6.m3.1.1"><csymbol cd="ambiguous" id="A3.1.p1.6.m3.1.1.1.cmml" xref="A3.1.p1.6.m3.1.1">subscript</csymbol><ci id="A3.1.p1.6.m3.1.1.2.cmml" xref="A3.1.p1.6.m3.1.1.2">𝐅</ci><cn id="A3.1.p1.6.m3.1.1.3.cmml" type="integer" xref="A3.1.p1.6.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.1.p1.6.m3.1c">\mathbf{F}_{0}</annotation><annotation encoding="application/x-llamapun" id="A3.1.p1.6.m3.1d">bold_F start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>, then we can write the <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A3.E10" title="In Proof 1. ‣ Appendix C Relationship to State Space Models ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">eq.</span> <span class="ltx_text ltx_ref_tag">10</span></a>, and <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A3.E11" title="In Proof 1. ‣ Appendix C Relationship to State Space Models ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">eq.</span> <span class="ltx_text ltx_ref_tag">11</span></a> as,</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A7.EGx8">
<tbody id="A3.E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{\hat{H}}_{0}" class="ltx_Math" display="inline" id="A3.E12.m1.1"><semantics id="A3.E12.m1.1a"><msub id="A3.E12.m1.1.1" xref="A3.E12.m1.1.1.cmml"><mover accent="true" id="A3.E12.m1.1.1.2" xref="A3.E12.m1.1.1.2.cmml"><mi id="A3.E12.m1.1.1.2.2" xref="A3.E12.m1.1.1.2.2.cmml">𝐇</mi><mo id="A3.E12.m1.1.1.2.1" xref="A3.E12.m1.1.1.2.1.cmml">^</mo></mover><mn id="A3.E12.m1.1.1.3" xref="A3.E12.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="A3.E12.m1.1b"><apply id="A3.E12.m1.1.1.cmml" xref="A3.E12.m1.1.1"><csymbol cd="ambiguous" id="A3.E12.m1.1.1.1.cmml" xref="A3.E12.m1.1.1">subscript</csymbol><apply id="A3.E12.m1.1.1.2.cmml" xref="A3.E12.m1.1.1.2"><ci id="A3.E12.m1.1.1.2.1.cmml" xref="A3.E12.m1.1.1.2.1">^</ci><ci id="A3.E12.m1.1.1.2.2.cmml" xref="A3.E12.m1.1.1.2.2">𝐇</ci></apply><cn id="A3.E12.m1.1.1.3.cmml" type="integer" xref="A3.E12.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E12.m1.1c">\displaystyle\mathbf{\hat{H}}_{0}</annotation><annotation encoding="application/x-llamapun" id="A3.E12.m1.1d">over^ start_ARG bold_H end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbf{B}_{0}(\mathbf{F}_{0}),~{}~{}\text{because}~{}~{}\mathbf%
{H}_{t-1}=\mathbf{0}" class="ltx_Math" display="inline" id="A3.E12.m2.2"><semantics id="A3.E12.m2.2a"><mrow id="A3.E12.m2.2.2.2" xref="A3.E12.m2.2.2.3.cmml"><mrow id="A3.E12.m2.1.1.1.1" xref="A3.E12.m2.1.1.1.1.cmml"><mi id="A3.E12.m2.1.1.1.1.3" xref="A3.E12.m2.1.1.1.1.3.cmml"></mi><mo id="A3.E12.m2.1.1.1.1.2" xref="A3.E12.m2.1.1.1.1.2.cmml">=</mo><mrow id="A3.E12.m2.1.1.1.1.1" xref="A3.E12.m2.1.1.1.1.1.cmml"><msub id="A3.E12.m2.1.1.1.1.1.3" xref="A3.E12.m2.1.1.1.1.1.3.cmml"><mi id="A3.E12.m2.1.1.1.1.1.3.2" xref="A3.E12.m2.1.1.1.1.1.3.2.cmml">𝐁</mi><mn id="A3.E12.m2.1.1.1.1.1.3.3" xref="A3.E12.m2.1.1.1.1.1.3.3.cmml">0</mn></msub><mo id="A3.E12.m2.1.1.1.1.1.2" xref="A3.E12.m2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A3.E12.m2.1.1.1.1.1.1.1" xref="A3.E12.m2.1.1.1.1.1.1.1.1.cmml"><mo id="A3.E12.m2.1.1.1.1.1.1.1.2" stretchy="false" xref="A3.E12.m2.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A3.E12.m2.1.1.1.1.1.1.1.1" xref="A3.E12.m2.1.1.1.1.1.1.1.1.cmml"><mi id="A3.E12.m2.1.1.1.1.1.1.1.1.2" xref="A3.E12.m2.1.1.1.1.1.1.1.1.2.cmml">𝐅</mi><mn id="A3.E12.m2.1.1.1.1.1.1.1.1.3" xref="A3.E12.m2.1.1.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="A3.E12.m2.1.1.1.1.1.1.1.3" stretchy="false" xref="A3.E12.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A3.E12.m2.2.2.2.3" rspace="0.827em" xref="A3.E12.m2.2.2.3a.cmml">,</mo><mrow id="A3.E12.m2.2.2.2.2" xref="A3.E12.m2.2.2.2.2.cmml"><mrow id="A3.E12.m2.2.2.2.2.2" xref="A3.E12.m2.2.2.2.2.2.cmml"><mtext id="A3.E12.m2.2.2.2.2.2.2" xref="A3.E12.m2.2.2.2.2.2.2a.cmml">because</mtext><mo id="A3.E12.m2.2.2.2.2.2.1" lspace="0.660em" xref="A3.E12.m2.2.2.2.2.2.1.cmml">⁢</mo><msub id="A3.E12.m2.2.2.2.2.2.3" xref="A3.E12.m2.2.2.2.2.2.3.cmml"><mi id="A3.E12.m2.2.2.2.2.2.3.2" xref="A3.E12.m2.2.2.2.2.2.3.2.cmml">𝐇</mi><mrow id="A3.E12.m2.2.2.2.2.2.3.3" xref="A3.E12.m2.2.2.2.2.2.3.3.cmml"><mi id="A3.E12.m2.2.2.2.2.2.3.3.2" xref="A3.E12.m2.2.2.2.2.2.3.3.2.cmml">t</mi><mo id="A3.E12.m2.2.2.2.2.2.3.3.1" xref="A3.E12.m2.2.2.2.2.2.3.3.1.cmml">−</mo><mn id="A3.E12.m2.2.2.2.2.2.3.3.3" xref="A3.E12.m2.2.2.2.2.2.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="A3.E12.m2.2.2.2.2.1" xref="A3.E12.m2.2.2.2.2.1.cmml">=</mo><mn id="A3.E12.m2.2.2.2.2.3" xref="A3.E12.m2.2.2.2.2.3.cmml">𝟎</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.E12.m2.2b"><apply id="A3.E12.m2.2.2.3.cmml" xref="A3.E12.m2.2.2.2"><csymbol cd="ambiguous" id="A3.E12.m2.2.2.3a.cmml" xref="A3.E12.m2.2.2.2.3">formulae-sequence</csymbol><apply id="A3.E12.m2.1.1.1.1.cmml" xref="A3.E12.m2.1.1.1.1"><eq id="A3.E12.m2.1.1.1.1.2.cmml" xref="A3.E12.m2.1.1.1.1.2"></eq><csymbol cd="latexml" id="A3.E12.m2.1.1.1.1.3.cmml" xref="A3.E12.m2.1.1.1.1.3">absent</csymbol><apply id="A3.E12.m2.1.1.1.1.1.cmml" xref="A3.E12.m2.1.1.1.1.1"><times id="A3.E12.m2.1.1.1.1.1.2.cmml" xref="A3.E12.m2.1.1.1.1.1.2"></times><apply id="A3.E12.m2.1.1.1.1.1.3.cmml" xref="A3.E12.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E12.m2.1.1.1.1.1.3.1.cmml" xref="A3.E12.m2.1.1.1.1.1.3">subscript</csymbol><ci id="A3.E12.m2.1.1.1.1.1.3.2.cmml" xref="A3.E12.m2.1.1.1.1.1.3.2">𝐁</ci><cn id="A3.E12.m2.1.1.1.1.1.3.3.cmml" type="integer" xref="A3.E12.m2.1.1.1.1.1.3.3">0</cn></apply><apply id="A3.E12.m2.1.1.1.1.1.1.1.1.cmml" xref="A3.E12.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E12.m2.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E12.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="A3.E12.m2.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E12.m2.1.1.1.1.1.1.1.1.2">𝐅</ci><cn id="A3.E12.m2.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="A3.E12.m2.1.1.1.1.1.1.1.1.3">0</cn></apply></apply></apply><apply id="A3.E12.m2.2.2.2.2.cmml" xref="A3.E12.m2.2.2.2.2"><eq id="A3.E12.m2.2.2.2.2.1.cmml" xref="A3.E12.m2.2.2.2.2.1"></eq><apply id="A3.E12.m2.2.2.2.2.2.cmml" xref="A3.E12.m2.2.2.2.2.2"><times id="A3.E12.m2.2.2.2.2.2.1.cmml" xref="A3.E12.m2.2.2.2.2.2.1"></times><ci id="A3.E12.m2.2.2.2.2.2.2a.cmml" xref="A3.E12.m2.2.2.2.2.2.2"><mtext id="A3.E12.m2.2.2.2.2.2.2.cmml" xref="A3.E12.m2.2.2.2.2.2.2">because</mtext></ci><apply id="A3.E12.m2.2.2.2.2.2.3.cmml" xref="A3.E12.m2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="A3.E12.m2.2.2.2.2.2.3.1.cmml" xref="A3.E12.m2.2.2.2.2.2.3">subscript</csymbol><ci id="A3.E12.m2.2.2.2.2.2.3.2.cmml" xref="A3.E12.m2.2.2.2.2.2.3.2">𝐇</ci><apply id="A3.E12.m2.2.2.2.2.2.3.3.cmml" xref="A3.E12.m2.2.2.2.2.2.3.3"><minus id="A3.E12.m2.2.2.2.2.2.3.3.1.cmml" xref="A3.E12.m2.2.2.2.2.2.3.3.1"></minus><ci id="A3.E12.m2.2.2.2.2.2.3.3.2.cmml" xref="A3.E12.m2.2.2.2.2.2.3.3.2">𝑡</ci><cn id="A3.E12.m2.2.2.2.2.2.3.3.3.cmml" type="integer" xref="A3.E12.m2.2.2.2.2.2.3.3.3">1</cn></apply></apply></apply><cn id="A3.E12.m2.2.2.2.2.3.cmml" type="integer" xref="A3.E12.m2.2.2.2.2.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E12.m2.2c">\displaystyle=\mathbf{B}_{0}(\mathbf{F}_{0}),~{}~{}\text{because}~{}~{}\mathbf%
{H}_{t-1}=\mathbf{0}</annotation><annotation encoding="application/x-llamapun" id="A3.E12.m2.2d">= bold_B start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( bold_F start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) , because bold_H start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT = bold_0</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
<tbody id="A3.E13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{y}_{0}" class="ltx_Math" display="inline" id="A3.E13.m1.1"><semantics id="A3.E13.m1.1a"><msub id="A3.E13.m1.1.1" xref="A3.E13.m1.1.1.cmml"><mi id="A3.E13.m1.1.1.2" xref="A3.E13.m1.1.1.2.cmml">𝐲</mi><mn id="A3.E13.m1.1.1.3" xref="A3.E13.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="A3.E13.m1.1b"><apply id="A3.E13.m1.1.1.cmml" xref="A3.E13.m1.1.1"><csymbol cd="ambiguous" id="A3.E13.m1.1.1.1.cmml" xref="A3.E13.m1.1.1">subscript</csymbol><ci id="A3.E13.m1.1.1.2.cmml" xref="A3.E13.m1.1.1.2">𝐲</ci><cn id="A3.E13.m1.1.1.3.cmml" type="integer" xref="A3.E13.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E13.m1.1c">\displaystyle\mathbf{y}_{0}</annotation><annotation encoding="application/x-llamapun" id="A3.E13.m1.1d">bold_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbf{C}_{0}(\mathbf{\hat{H}}_{0})," class="ltx_Math" display="inline" id="A3.E13.m2.1"><semantics id="A3.E13.m2.1a"><mrow id="A3.E13.m2.1.1.1" xref="A3.E13.m2.1.1.1.1.cmml"><mrow id="A3.E13.m2.1.1.1.1" xref="A3.E13.m2.1.1.1.1.cmml"><mi id="A3.E13.m2.1.1.1.1.3" xref="A3.E13.m2.1.1.1.1.3.cmml"></mi><mo id="A3.E13.m2.1.1.1.1.2" xref="A3.E13.m2.1.1.1.1.2.cmml">=</mo><mrow id="A3.E13.m2.1.1.1.1.1" xref="A3.E13.m2.1.1.1.1.1.cmml"><msub id="A3.E13.m2.1.1.1.1.1.3" xref="A3.E13.m2.1.1.1.1.1.3.cmml"><mi id="A3.E13.m2.1.1.1.1.1.3.2" xref="A3.E13.m2.1.1.1.1.1.3.2.cmml">𝐂</mi><mn id="A3.E13.m2.1.1.1.1.1.3.3" xref="A3.E13.m2.1.1.1.1.1.3.3.cmml">0</mn></msub><mo id="A3.E13.m2.1.1.1.1.1.2" xref="A3.E13.m2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A3.E13.m2.1.1.1.1.1.1.1" xref="A3.E13.m2.1.1.1.1.1.1.1.1.cmml"><mo id="A3.E13.m2.1.1.1.1.1.1.1.2" stretchy="false" xref="A3.E13.m2.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A3.E13.m2.1.1.1.1.1.1.1.1" xref="A3.E13.m2.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="A3.E13.m2.1.1.1.1.1.1.1.1.2" xref="A3.E13.m2.1.1.1.1.1.1.1.1.2.cmml"><mi id="A3.E13.m2.1.1.1.1.1.1.1.1.2.2" xref="A3.E13.m2.1.1.1.1.1.1.1.1.2.2.cmml">𝐇</mi><mo id="A3.E13.m2.1.1.1.1.1.1.1.1.2.1" xref="A3.E13.m2.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mn id="A3.E13.m2.1.1.1.1.1.1.1.1.3" xref="A3.E13.m2.1.1.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="A3.E13.m2.1.1.1.1.1.1.1.3" stretchy="false" xref="A3.E13.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A3.E13.m2.1.1.1.2" xref="A3.E13.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E13.m2.1b"><apply id="A3.E13.m2.1.1.1.1.cmml" xref="A3.E13.m2.1.1.1"><eq id="A3.E13.m2.1.1.1.1.2.cmml" xref="A3.E13.m2.1.1.1.1.2"></eq><csymbol cd="latexml" id="A3.E13.m2.1.1.1.1.3.cmml" xref="A3.E13.m2.1.1.1.1.3">absent</csymbol><apply id="A3.E13.m2.1.1.1.1.1.cmml" xref="A3.E13.m2.1.1.1.1.1"><times id="A3.E13.m2.1.1.1.1.1.2.cmml" xref="A3.E13.m2.1.1.1.1.1.2"></times><apply id="A3.E13.m2.1.1.1.1.1.3.cmml" xref="A3.E13.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E13.m2.1.1.1.1.1.3.1.cmml" xref="A3.E13.m2.1.1.1.1.1.3">subscript</csymbol><ci id="A3.E13.m2.1.1.1.1.1.3.2.cmml" xref="A3.E13.m2.1.1.1.1.1.3.2">𝐂</ci><cn id="A3.E13.m2.1.1.1.1.1.3.3.cmml" type="integer" xref="A3.E13.m2.1.1.1.1.1.3.3">0</cn></apply><apply id="A3.E13.m2.1.1.1.1.1.1.1.1.cmml" xref="A3.E13.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E13.m2.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E13.m2.1.1.1.1.1.1.1">subscript</csymbol><apply id="A3.E13.m2.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E13.m2.1.1.1.1.1.1.1.1.2"><ci id="A3.E13.m2.1.1.1.1.1.1.1.1.2.1.cmml" xref="A3.E13.m2.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="A3.E13.m2.1.1.1.1.1.1.1.1.2.2.cmml" xref="A3.E13.m2.1.1.1.1.1.1.1.1.2.2">𝐇</ci></apply><cn id="A3.E13.m2.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="A3.E13.m2.1.1.1.1.1.1.1.1.3">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E13.m2.1c">\displaystyle=\mathbf{C}_{0}(\mathbf{\hat{H}}_{0}),</annotation><annotation encoding="application/x-llamapun" id="A3.E13.m2.1d">= bold_C start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( over^ start_ARG bold_H end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A3.1.p1.10">where <math alttext="\mathbf{A}_{0}" class="ltx_Math" display="inline" id="A3.1.p1.7.m1.1"><semantics id="A3.1.p1.7.m1.1a"><msub id="A3.1.p1.7.m1.1.1" xref="A3.1.p1.7.m1.1.1.cmml"><mi id="A3.1.p1.7.m1.1.1.2" xref="A3.1.p1.7.m1.1.1.2.cmml">𝐀</mi><mn id="A3.1.p1.7.m1.1.1.3" xref="A3.1.p1.7.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="A3.1.p1.7.m1.1b"><apply id="A3.1.p1.7.m1.1.1.cmml" xref="A3.1.p1.7.m1.1.1"><csymbol cd="ambiguous" id="A3.1.p1.7.m1.1.1.1.cmml" xref="A3.1.p1.7.m1.1.1">subscript</csymbol><ci id="A3.1.p1.7.m1.1.1.2.cmml" xref="A3.1.p1.7.m1.1.1.2">𝐀</ci><cn id="A3.1.p1.7.m1.1.1.3.cmml" type="integer" xref="A3.1.p1.7.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.1.p1.7.m1.1c">\mathbf{A}_{0}</annotation><annotation encoding="application/x-llamapun" id="A3.1.p1.7.m1.1d">bold_A start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{B}_{0}" class="ltx_Math" display="inline" id="A3.1.p1.8.m2.1"><semantics id="A3.1.p1.8.m2.1a"><msub id="A3.1.p1.8.m2.1.1" xref="A3.1.p1.8.m2.1.1.cmml"><mi id="A3.1.p1.8.m2.1.1.2" xref="A3.1.p1.8.m2.1.1.2.cmml">𝐁</mi><mn id="A3.1.p1.8.m2.1.1.3" xref="A3.1.p1.8.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="A3.1.p1.8.m2.1b"><apply id="A3.1.p1.8.m2.1.1.cmml" xref="A3.1.p1.8.m2.1.1"><csymbol cd="ambiguous" id="A3.1.p1.8.m2.1.1.1.cmml" xref="A3.1.p1.8.m2.1.1">subscript</csymbol><ci id="A3.1.p1.8.m2.1.1.2.cmml" xref="A3.1.p1.8.m2.1.1.2">𝐁</ci><cn id="A3.1.p1.8.m2.1.1.3.cmml" type="integer" xref="A3.1.p1.8.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.1.p1.8.m2.1c">\mathbf{B}_{0}</annotation><annotation encoding="application/x-llamapun" id="A3.1.p1.8.m2.1d">bold_B start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{C}_{0}" class="ltx_Math" display="inline" id="A3.1.p1.9.m3.1"><semantics id="A3.1.p1.9.m3.1a"><msub id="A3.1.p1.9.m3.1.1" xref="A3.1.p1.9.m3.1.1.cmml"><mi id="A3.1.p1.9.m3.1.1.2" xref="A3.1.p1.9.m3.1.1.2.cmml">𝐂</mi><mn id="A3.1.p1.9.m3.1.1.3" xref="A3.1.p1.9.m3.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="A3.1.p1.9.m3.1b"><apply id="A3.1.p1.9.m3.1.1.cmml" xref="A3.1.p1.9.m3.1.1"><csymbol cd="ambiguous" id="A3.1.p1.9.m3.1.1.1.cmml" xref="A3.1.p1.9.m3.1.1">subscript</csymbol><ci id="A3.1.p1.9.m3.1.1.2.cmml" xref="A3.1.p1.9.m3.1.1.2">𝐂</ci><cn id="A3.1.p1.9.m3.1.1.3.cmml" type="integer" xref="A3.1.p1.9.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.1.p1.9.m3.1c">\mathbf{C}_{0}</annotation><annotation encoding="application/x-llamapun" id="A3.1.p1.9.m3.1d">bold_C start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> are learnable parameters. Then for the next timestep <math alttext="t=1" class="ltx_Math" display="inline" id="A3.1.p1.10.m4.1"><semantics id="A3.1.p1.10.m4.1a"><mrow id="A3.1.p1.10.m4.1.1" xref="A3.1.p1.10.m4.1.1.cmml"><mi id="A3.1.p1.10.m4.1.1.2" xref="A3.1.p1.10.m4.1.1.2.cmml">t</mi><mo id="A3.1.p1.10.m4.1.1.1" xref="A3.1.p1.10.m4.1.1.1.cmml">=</mo><mn id="A3.1.p1.10.m4.1.1.3" xref="A3.1.p1.10.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.1.p1.10.m4.1b"><apply id="A3.1.p1.10.m4.1.1.cmml" xref="A3.1.p1.10.m4.1.1"><eq id="A3.1.p1.10.m4.1.1.1.cmml" xref="A3.1.p1.10.m4.1.1.1"></eq><ci id="A3.1.p1.10.m4.1.1.2.cmml" xref="A3.1.p1.10.m4.1.1.2">𝑡</ci><cn id="A3.1.p1.10.m4.1.1.3.cmml" type="integer" xref="A3.1.p1.10.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.1.p1.10.m4.1c">t=1</annotation><annotation encoding="application/x-llamapun" id="A3.1.p1.10.m4.1d">italic_t = 1</annotation></semantics></math>, we can write that</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A7.EGx9">
<tbody id="A3.E14"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{\hat{H}}_{1}" class="ltx_Math" display="inline" id="A3.E14.m1.1"><semantics id="A3.E14.m1.1a"><msub id="A3.E14.m1.1.1" xref="A3.E14.m1.1.1.cmml"><mover accent="true" id="A3.E14.m1.1.1.2" xref="A3.E14.m1.1.1.2.cmml"><mi id="A3.E14.m1.1.1.2.2" xref="A3.E14.m1.1.1.2.2.cmml">𝐇</mi><mo id="A3.E14.m1.1.1.2.1" xref="A3.E14.m1.1.1.2.1.cmml">^</mo></mover><mn id="A3.E14.m1.1.1.3" xref="A3.E14.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A3.E14.m1.1b"><apply id="A3.E14.m1.1.1.cmml" xref="A3.E14.m1.1.1"><csymbol cd="ambiguous" id="A3.E14.m1.1.1.1.cmml" xref="A3.E14.m1.1.1">subscript</csymbol><apply id="A3.E14.m1.1.1.2.cmml" xref="A3.E14.m1.1.1.2"><ci id="A3.E14.m1.1.1.2.1.cmml" xref="A3.E14.m1.1.1.2.1">^</ci><ci id="A3.E14.m1.1.1.2.2.cmml" xref="A3.E14.m1.1.1.2.2">𝐇</ci></apply><cn id="A3.E14.m1.1.1.3.cmml" type="integer" xref="A3.E14.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E14.m1.1c">\displaystyle\mathbf{\hat{H}}_{1}</annotation><annotation encoding="application/x-llamapun" id="A3.E14.m1.1d">over^ start_ARG bold_H end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbf{A}_{1}(\mathbf{\hat{H}}_{0})+\mathbf{B}_{1}(\mathbf{F}_{%
1})," class="ltx_Math" display="inline" id="A3.E14.m2.1"><semantics id="A3.E14.m2.1a"><mrow id="A3.E14.m2.1.1.1" xref="A3.E14.m2.1.1.1.1.cmml"><mrow id="A3.E14.m2.1.1.1.1" xref="A3.E14.m2.1.1.1.1.cmml"><mi id="A3.E14.m2.1.1.1.1.4" xref="A3.E14.m2.1.1.1.1.4.cmml"></mi><mo id="A3.E14.m2.1.1.1.1.3" xref="A3.E14.m2.1.1.1.1.3.cmml">=</mo><mrow id="A3.E14.m2.1.1.1.1.2" xref="A3.E14.m2.1.1.1.1.2.cmml"><mrow id="A3.E14.m2.1.1.1.1.1.1" xref="A3.E14.m2.1.1.1.1.1.1.cmml"><msub id="A3.E14.m2.1.1.1.1.1.1.3" xref="A3.E14.m2.1.1.1.1.1.1.3.cmml"><mi id="A3.E14.m2.1.1.1.1.1.1.3.2" xref="A3.E14.m2.1.1.1.1.1.1.3.2.cmml">𝐀</mi><mn id="A3.E14.m2.1.1.1.1.1.1.3.3" xref="A3.E14.m2.1.1.1.1.1.1.3.3.cmml">1</mn></msub><mo id="A3.E14.m2.1.1.1.1.1.1.2" xref="A3.E14.m2.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A3.E14.m2.1.1.1.1.1.1.1.1" xref="A3.E14.m2.1.1.1.1.1.1.1.1.1.cmml"><mo id="A3.E14.m2.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A3.E14.m2.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A3.E14.m2.1.1.1.1.1.1.1.1.1" xref="A3.E14.m2.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="A3.E14.m2.1.1.1.1.1.1.1.1.1.2" xref="A3.E14.m2.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A3.E14.m2.1.1.1.1.1.1.1.1.1.2.2" xref="A3.E14.m2.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐇</mi><mo id="A3.E14.m2.1.1.1.1.1.1.1.1.1.2.1" xref="A3.E14.m2.1.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mn id="A3.E14.m2.1.1.1.1.1.1.1.1.1.3" xref="A3.E14.m2.1.1.1.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="A3.E14.m2.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A3.E14.m2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A3.E14.m2.1.1.1.1.2.3" xref="A3.E14.m2.1.1.1.1.2.3.cmml">+</mo><mrow id="A3.E14.m2.1.1.1.1.2.2" xref="A3.E14.m2.1.1.1.1.2.2.cmml"><msub id="A3.E14.m2.1.1.1.1.2.2.3" xref="A3.E14.m2.1.1.1.1.2.2.3.cmml"><mi id="A3.E14.m2.1.1.1.1.2.2.3.2" xref="A3.E14.m2.1.1.1.1.2.2.3.2.cmml">𝐁</mi><mn id="A3.E14.m2.1.1.1.1.2.2.3.3" xref="A3.E14.m2.1.1.1.1.2.2.3.3.cmml">1</mn></msub><mo id="A3.E14.m2.1.1.1.1.2.2.2" xref="A3.E14.m2.1.1.1.1.2.2.2.cmml">⁢</mo><mrow id="A3.E14.m2.1.1.1.1.2.2.1.1" xref="A3.E14.m2.1.1.1.1.2.2.1.1.1.cmml"><mo id="A3.E14.m2.1.1.1.1.2.2.1.1.2" stretchy="false" xref="A3.E14.m2.1.1.1.1.2.2.1.1.1.cmml">(</mo><msub id="A3.E14.m2.1.1.1.1.2.2.1.1.1" xref="A3.E14.m2.1.1.1.1.2.2.1.1.1.cmml"><mi id="A3.E14.m2.1.1.1.1.2.2.1.1.1.2" xref="A3.E14.m2.1.1.1.1.2.2.1.1.1.2.cmml">𝐅</mi><mn id="A3.E14.m2.1.1.1.1.2.2.1.1.1.3" xref="A3.E14.m2.1.1.1.1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="A3.E14.m2.1.1.1.1.2.2.1.1.3" stretchy="false" xref="A3.E14.m2.1.1.1.1.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A3.E14.m2.1.1.1.2" xref="A3.E14.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E14.m2.1b"><apply id="A3.E14.m2.1.1.1.1.cmml" xref="A3.E14.m2.1.1.1"><eq id="A3.E14.m2.1.1.1.1.3.cmml" xref="A3.E14.m2.1.1.1.1.3"></eq><csymbol cd="latexml" id="A3.E14.m2.1.1.1.1.4.cmml" xref="A3.E14.m2.1.1.1.1.4">absent</csymbol><apply id="A3.E14.m2.1.1.1.1.2.cmml" xref="A3.E14.m2.1.1.1.1.2"><plus id="A3.E14.m2.1.1.1.1.2.3.cmml" xref="A3.E14.m2.1.1.1.1.2.3"></plus><apply id="A3.E14.m2.1.1.1.1.1.1.cmml" xref="A3.E14.m2.1.1.1.1.1.1"><times id="A3.E14.m2.1.1.1.1.1.1.2.cmml" xref="A3.E14.m2.1.1.1.1.1.1.2"></times><apply id="A3.E14.m2.1.1.1.1.1.1.3.cmml" xref="A3.E14.m2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E14.m2.1.1.1.1.1.1.3.1.cmml" xref="A3.E14.m2.1.1.1.1.1.1.3">subscript</csymbol><ci id="A3.E14.m2.1.1.1.1.1.1.3.2.cmml" xref="A3.E14.m2.1.1.1.1.1.1.3.2">𝐀</ci><cn id="A3.E14.m2.1.1.1.1.1.1.3.3.cmml" type="integer" xref="A3.E14.m2.1.1.1.1.1.1.3.3">1</cn></apply><apply id="A3.E14.m2.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E14.m2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E14.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E14.m2.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="A3.E14.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E14.m2.1.1.1.1.1.1.1.1.1.2"><ci id="A3.E14.m2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A3.E14.m2.1.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="A3.E14.m2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A3.E14.m2.1.1.1.1.1.1.1.1.1.2.2">𝐇</ci></apply><cn id="A3.E14.m2.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="A3.E14.m2.1.1.1.1.1.1.1.1.1.3">0</cn></apply></apply><apply id="A3.E14.m2.1.1.1.1.2.2.cmml" xref="A3.E14.m2.1.1.1.1.2.2"><times id="A3.E14.m2.1.1.1.1.2.2.2.cmml" xref="A3.E14.m2.1.1.1.1.2.2.2"></times><apply id="A3.E14.m2.1.1.1.1.2.2.3.cmml" xref="A3.E14.m2.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="A3.E14.m2.1.1.1.1.2.2.3.1.cmml" xref="A3.E14.m2.1.1.1.1.2.2.3">subscript</csymbol><ci id="A3.E14.m2.1.1.1.1.2.2.3.2.cmml" xref="A3.E14.m2.1.1.1.1.2.2.3.2">𝐁</ci><cn id="A3.E14.m2.1.1.1.1.2.2.3.3.cmml" type="integer" xref="A3.E14.m2.1.1.1.1.2.2.3.3">1</cn></apply><apply id="A3.E14.m2.1.1.1.1.2.2.1.1.1.cmml" xref="A3.E14.m2.1.1.1.1.2.2.1.1"><csymbol cd="ambiguous" id="A3.E14.m2.1.1.1.1.2.2.1.1.1.1.cmml" xref="A3.E14.m2.1.1.1.1.2.2.1.1">subscript</csymbol><ci id="A3.E14.m2.1.1.1.1.2.2.1.1.1.2.cmml" xref="A3.E14.m2.1.1.1.1.2.2.1.1.1.2">𝐅</ci><cn id="A3.E14.m2.1.1.1.1.2.2.1.1.1.3.cmml" type="integer" xref="A3.E14.m2.1.1.1.1.2.2.1.1.1.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E14.m2.1c">\displaystyle=\mathbf{A}_{1}(\mathbf{\hat{H}}_{0})+\mathbf{B}_{1}(\mathbf{F}_{%
1}),</annotation><annotation encoding="application/x-llamapun" id="A3.E14.m2.1d">= bold_A start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( over^ start_ARG bold_H end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) + bold_B start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( bold_F start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
<tbody id="A3.E15"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{y}_{1}" class="ltx_Math" display="inline" id="A3.E15.m1.1"><semantics id="A3.E15.m1.1a"><msub id="A3.E15.m1.1.1" xref="A3.E15.m1.1.1.cmml"><mi id="A3.E15.m1.1.1.2" xref="A3.E15.m1.1.1.2.cmml">𝐲</mi><mn id="A3.E15.m1.1.1.3" xref="A3.E15.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A3.E15.m1.1b"><apply id="A3.E15.m1.1.1.cmml" xref="A3.E15.m1.1.1"><csymbol cd="ambiguous" id="A3.E15.m1.1.1.1.cmml" xref="A3.E15.m1.1.1">subscript</csymbol><ci id="A3.E15.m1.1.1.2.cmml" xref="A3.E15.m1.1.1.2">𝐲</ci><cn id="A3.E15.m1.1.1.3.cmml" type="integer" xref="A3.E15.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E15.m1.1c">\displaystyle\mathbf{y}_{1}</annotation><annotation encoding="application/x-llamapun" id="A3.E15.m1.1d">bold_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbf{C}_{1}(\mathbf{\hat{H}}_{1})." class="ltx_Math" display="inline" id="A3.E15.m2.1"><semantics id="A3.E15.m2.1a"><mrow id="A3.E15.m2.1.1.1" xref="A3.E15.m2.1.1.1.1.cmml"><mrow id="A3.E15.m2.1.1.1.1" xref="A3.E15.m2.1.1.1.1.cmml"><mi id="A3.E15.m2.1.1.1.1.3" xref="A3.E15.m2.1.1.1.1.3.cmml"></mi><mo id="A3.E15.m2.1.1.1.1.2" xref="A3.E15.m2.1.1.1.1.2.cmml">=</mo><mrow id="A3.E15.m2.1.1.1.1.1" xref="A3.E15.m2.1.1.1.1.1.cmml"><msub id="A3.E15.m2.1.1.1.1.1.3" xref="A3.E15.m2.1.1.1.1.1.3.cmml"><mi id="A3.E15.m2.1.1.1.1.1.3.2" xref="A3.E15.m2.1.1.1.1.1.3.2.cmml">𝐂</mi><mn id="A3.E15.m2.1.1.1.1.1.3.3" xref="A3.E15.m2.1.1.1.1.1.3.3.cmml">1</mn></msub><mo id="A3.E15.m2.1.1.1.1.1.2" xref="A3.E15.m2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A3.E15.m2.1.1.1.1.1.1.1" xref="A3.E15.m2.1.1.1.1.1.1.1.1.cmml"><mo id="A3.E15.m2.1.1.1.1.1.1.1.2" stretchy="false" xref="A3.E15.m2.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A3.E15.m2.1.1.1.1.1.1.1.1" xref="A3.E15.m2.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="A3.E15.m2.1.1.1.1.1.1.1.1.2" xref="A3.E15.m2.1.1.1.1.1.1.1.1.2.cmml"><mi id="A3.E15.m2.1.1.1.1.1.1.1.1.2.2" xref="A3.E15.m2.1.1.1.1.1.1.1.1.2.2.cmml">𝐇</mi><mo id="A3.E15.m2.1.1.1.1.1.1.1.1.2.1" xref="A3.E15.m2.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mn id="A3.E15.m2.1.1.1.1.1.1.1.1.3" xref="A3.E15.m2.1.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="A3.E15.m2.1.1.1.1.1.1.1.3" stretchy="false" xref="A3.E15.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A3.E15.m2.1.1.1.2" lspace="0em" xref="A3.E15.m2.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E15.m2.1b"><apply id="A3.E15.m2.1.1.1.1.cmml" xref="A3.E15.m2.1.1.1"><eq id="A3.E15.m2.1.1.1.1.2.cmml" xref="A3.E15.m2.1.1.1.1.2"></eq><csymbol cd="latexml" id="A3.E15.m2.1.1.1.1.3.cmml" xref="A3.E15.m2.1.1.1.1.3">absent</csymbol><apply id="A3.E15.m2.1.1.1.1.1.cmml" xref="A3.E15.m2.1.1.1.1.1"><times id="A3.E15.m2.1.1.1.1.1.2.cmml" xref="A3.E15.m2.1.1.1.1.1.2"></times><apply id="A3.E15.m2.1.1.1.1.1.3.cmml" xref="A3.E15.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E15.m2.1.1.1.1.1.3.1.cmml" xref="A3.E15.m2.1.1.1.1.1.3">subscript</csymbol><ci id="A3.E15.m2.1.1.1.1.1.3.2.cmml" xref="A3.E15.m2.1.1.1.1.1.3.2">𝐂</ci><cn id="A3.E15.m2.1.1.1.1.1.3.3.cmml" type="integer" xref="A3.E15.m2.1.1.1.1.1.3.3">1</cn></apply><apply id="A3.E15.m2.1.1.1.1.1.1.1.1.cmml" xref="A3.E15.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E15.m2.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E15.m2.1.1.1.1.1.1.1">subscript</csymbol><apply id="A3.E15.m2.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E15.m2.1.1.1.1.1.1.1.1.2"><ci id="A3.E15.m2.1.1.1.1.1.1.1.1.2.1.cmml" xref="A3.E15.m2.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="A3.E15.m2.1.1.1.1.1.1.1.1.2.2.cmml" xref="A3.E15.m2.1.1.1.1.1.1.1.1.2.2">𝐇</ci></apply><cn id="A3.E15.m2.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="A3.E15.m2.1.1.1.1.1.1.1.1.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E15.m2.1c">\displaystyle=\mathbf{C}_{1}(\mathbf{\hat{H}}_{1}).</annotation><annotation encoding="application/x-llamapun" id="A3.E15.m2.1d">= bold_C start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( over^ start_ARG bold_H end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A3.1.p1.11">From <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A3.E12" title="In Proof 1. ‣ Appendix C Relationship to State Space Models ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">eq.</span> <span class="ltx_text ltx_ref_tag">12</span></a>, we know that <math alttext="\mathbf{\hat{H}}_{0}=\mathbf{B}_{0}(\mathbf{F}_{0})" class="ltx_Math" display="inline" id="A3.1.p1.11.m1.1"><semantics id="A3.1.p1.11.m1.1a"><mrow id="A3.1.p1.11.m1.1.1" xref="A3.1.p1.11.m1.1.1.cmml"><msub id="A3.1.p1.11.m1.1.1.3" xref="A3.1.p1.11.m1.1.1.3.cmml"><mover accent="true" id="A3.1.p1.11.m1.1.1.3.2" xref="A3.1.p1.11.m1.1.1.3.2.cmml"><mi id="A3.1.p1.11.m1.1.1.3.2.2" xref="A3.1.p1.11.m1.1.1.3.2.2.cmml">𝐇</mi><mo id="A3.1.p1.11.m1.1.1.3.2.1" xref="A3.1.p1.11.m1.1.1.3.2.1.cmml">^</mo></mover><mn id="A3.1.p1.11.m1.1.1.3.3" xref="A3.1.p1.11.m1.1.1.3.3.cmml">0</mn></msub><mo id="A3.1.p1.11.m1.1.1.2" xref="A3.1.p1.11.m1.1.1.2.cmml">=</mo><mrow id="A3.1.p1.11.m1.1.1.1" xref="A3.1.p1.11.m1.1.1.1.cmml"><msub id="A3.1.p1.11.m1.1.1.1.3" xref="A3.1.p1.11.m1.1.1.1.3.cmml"><mi id="A3.1.p1.11.m1.1.1.1.3.2" xref="A3.1.p1.11.m1.1.1.1.3.2.cmml">𝐁</mi><mn id="A3.1.p1.11.m1.1.1.1.3.3" xref="A3.1.p1.11.m1.1.1.1.3.3.cmml">0</mn></msub><mo id="A3.1.p1.11.m1.1.1.1.2" xref="A3.1.p1.11.m1.1.1.1.2.cmml">⁢</mo><mrow id="A3.1.p1.11.m1.1.1.1.1.1" xref="A3.1.p1.11.m1.1.1.1.1.1.1.cmml"><mo id="A3.1.p1.11.m1.1.1.1.1.1.2" stretchy="false" xref="A3.1.p1.11.m1.1.1.1.1.1.1.cmml">(</mo><msub id="A3.1.p1.11.m1.1.1.1.1.1.1" xref="A3.1.p1.11.m1.1.1.1.1.1.1.cmml"><mi id="A3.1.p1.11.m1.1.1.1.1.1.1.2" xref="A3.1.p1.11.m1.1.1.1.1.1.1.2.cmml">𝐅</mi><mn id="A3.1.p1.11.m1.1.1.1.1.1.1.3" xref="A3.1.p1.11.m1.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="A3.1.p1.11.m1.1.1.1.1.1.3" stretchy="false" xref="A3.1.p1.11.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.1.p1.11.m1.1b"><apply id="A3.1.p1.11.m1.1.1.cmml" xref="A3.1.p1.11.m1.1.1"><eq id="A3.1.p1.11.m1.1.1.2.cmml" xref="A3.1.p1.11.m1.1.1.2"></eq><apply id="A3.1.p1.11.m1.1.1.3.cmml" xref="A3.1.p1.11.m1.1.1.3"><csymbol cd="ambiguous" id="A3.1.p1.11.m1.1.1.3.1.cmml" xref="A3.1.p1.11.m1.1.1.3">subscript</csymbol><apply id="A3.1.p1.11.m1.1.1.3.2.cmml" xref="A3.1.p1.11.m1.1.1.3.2"><ci id="A3.1.p1.11.m1.1.1.3.2.1.cmml" xref="A3.1.p1.11.m1.1.1.3.2.1">^</ci><ci id="A3.1.p1.11.m1.1.1.3.2.2.cmml" xref="A3.1.p1.11.m1.1.1.3.2.2">𝐇</ci></apply><cn id="A3.1.p1.11.m1.1.1.3.3.cmml" type="integer" xref="A3.1.p1.11.m1.1.1.3.3">0</cn></apply><apply id="A3.1.p1.11.m1.1.1.1.cmml" xref="A3.1.p1.11.m1.1.1.1"><times id="A3.1.p1.11.m1.1.1.1.2.cmml" xref="A3.1.p1.11.m1.1.1.1.2"></times><apply id="A3.1.p1.11.m1.1.1.1.3.cmml" xref="A3.1.p1.11.m1.1.1.1.3"><csymbol cd="ambiguous" id="A3.1.p1.11.m1.1.1.1.3.1.cmml" xref="A3.1.p1.11.m1.1.1.1.3">subscript</csymbol><ci id="A3.1.p1.11.m1.1.1.1.3.2.cmml" xref="A3.1.p1.11.m1.1.1.1.3.2">𝐁</ci><cn id="A3.1.p1.11.m1.1.1.1.3.3.cmml" type="integer" xref="A3.1.p1.11.m1.1.1.1.3.3">0</cn></apply><apply id="A3.1.p1.11.m1.1.1.1.1.1.1.cmml" xref="A3.1.p1.11.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.1.p1.11.m1.1.1.1.1.1.1.1.cmml" xref="A3.1.p1.11.m1.1.1.1.1.1">subscript</csymbol><ci id="A3.1.p1.11.m1.1.1.1.1.1.1.2.cmml" xref="A3.1.p1.11.m1.1.1.1.1.1.1.2">𝐅</ci><cn id="A3.1.p1.11.m1.1.1.1.1.1.1.3.cmml" type="integer" xref="A3.1.p1.11.m1.1.1.1.1.1.1.3">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.1.p1.11.m1.1c">\mathbf{\hat{H}}_{0}=\mathbf{B}_{0}(\mathbf{F}_{0})</annotation><annotation encoding="application/x-llamapun" id="A3.1.p1.11.m1.1d">over^ start_ARG bold_H end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = bold_B start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( bold_F start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT )</annotation></semantics></math>, then we can re-write <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A3.E14" title="In Proof 1. ‣ Appendix C Relationship to State Space Models ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">eq.</span> <span class="ltx_text ltx_ref_tag">14</span></a> as</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A7.EGx10">
<tbody id="A3.E16"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{\hat{H}}_{1}" class="ltx_Math" display="inline" id="A3.E16.m1.1"><semantics id="A3.E16.m1.1a"><msub id="A3.E16.m1.1.1" xref="A3.E16.m1.1.1.cmml"><mover accent="true" id="A3.E16.m1.1.1.2" xref="A3.E16.m1.1.1.2.cmml"><mi id="A3.E16.m1.1.1.2.2" xref="A3.E16.m1.1.1.2.2.cmml">𝐇</mi><mo id="A3.E16.m1.1.1.2.1" xref="A3.E16.m1.1.1.2.1.cmml">^</mo></mover><mn id="A3.E16.m1.1.1.3" xref="A3.E16.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A3.E16.m1.1b"><apply id="A3.E16.m1.1.1.cmml" xref="A3.E16.m1.1.1"><csymbol cd="ambiguous" id="A3.E16.m1.1.1.1.cmml" xref="A3.E16.m1.1.1">subscript</csymbol><apply id="A3.E16.m1.1.1.2.cmml" xref="A3.E16.m1.1.1.2"><ci id="A3.E16.m1.1.1.2.1.cmml" xref="A3.E16.m1.1.1.2.1">^</ci><ci id="A3.E16.m1.1.1.2.2.cmml" xref="A3.E16.m1.1.1.2.2">𝐇</ci></apply><cn id="A3.E16.m1.1.1.3.cmml" type="integer" xref="A3.E16.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E16.m1.1c">\displaystyle\mathbf{\hat{H}}_{1}</annotation><annotation encoding="application/x-llamapun" id="A3.E16.m1.1d">over^ start_ARG bold_H end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbf{A}_{1}(\mathbf{B}_{0}(\mathbf{F}_{0}))+\mathbf{B}_{1}(%
\mathbf{F}_{1})" class="ltx_Math" display="inline" id="A3.E16.m2.2"><semantics id="A3.E16.m2.2a"><mrow id="A3.E16.m2.2.2" xref="A3.E16.m2.2.2.cmml"><mi id="A3.E16.m2.2.2.4" xref="A3.E16.m2.2.2.4.cmml"></mi><mo id="A3.E16.m2.2.2.3" xref="A3.E16.m2.2.2.3.cmml">=</mo><mrow id="A3.E16.m2.2.2.2" xref="A3.E16.m2.2.2.2.cmml"><mrow id="A3.E16.m2.1.1.1.1" xref="A3.E16.m2.1.1.1.1.cmml"><msub id="A3.E16.m2.1.1.1.1.3" xref="A3.E16.m2.1.1.1.1.3.cmml"><mi id="A3.E16.m2.1.1.1.1.3.2" xref="A3.E16.m2.1.1.1.1.3.2.cmml">𝐀</mi><mn id="A3.E16.m2.1.1.1.1.3.3" xref="A3.E16.m2.1.1.1.1.3.3.cmml">1</mn></msub><mo id="A3.E16.m2.1.1.1.1.2" xref="A3.E16.m2.1.1.1.1.2.cmml">⁢</mo><mrow id="A3.E16.m2.1.1.1.1.1.1" xref="A3.E16.m2.1.1.1.1.1.1.1.cmml"><mo id="A3.E16.m2.1.1.1.1.1.1.2" stretchy="false" xref="A3.E16.m2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A3.E16.m2.1.1.1.1.1.1.1" xref="A3.E16.m2.1.1.1.1.1.1.1.cmml"><msub id="A3.E16.m2.1.1.1.1.1.1.1.3" xref="A3.E16.m2.1.1.1.1.1.1.1.3.cmml"><mi id="A3.E16.m2.1.1.1.1.1.1.1.3.2" xref="A3.E16.m2.1.1.1.1.1.1.1.3.2.cmml">𝐁</mi><mn id="A3.E16.m2.1.1.1.1.1.1.1.3.3" xref="A3.E16.m2.1.1.1.1.1.1.1.3.3.cmml">0</mn></msub><mo id="A3.E16.m2.1.1.1.1.1.1.1.2" xref="A3.E16.m2.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A3.E16.m2.1.1.1.1.1.1.1.1.1" xref="A3.E16.m2.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A3.E16.m2.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A3.E16.m2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A3.E16.m2.1.1.1.1.1.1.1.1.1.1" xref="A3.E16.m2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A3.E16.m2.1.1.1.1.1.1.1.1.1.1.2" xref="A3.E16.m2.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐅</mi><mn id="A3.E16.m2.1.1.1.1.1.1.1.1.1.1.3" xref="A3.E16.m2.1.1.1.1.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="A3.E16.m2.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A3.E16.m2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A3.E16.m2.1.1.1.1.1.1.3" stretchy="false" xref="A3.E16.m2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A3.E16.m2.2.2.2.3" xref="A3.E16.m2.2.2.2.3.cmml">+</mo><mrow id="A3.E16.m2.2.2.2.2" xref="A3.E16.m2.2.2.2.2.cmml"><msub id="A3.E16.m2.2.2.2.2.3" xref="A3.E16.m2.2.2.2.2.3.cmml"><mi id="A3.E16.m2.2.2.2.2.3.2" xref="A3.E16.m2.2.2.2.2.3.2.cmml">𝐁</mi><mn id="A3.E16.m2.2.2.2.2.3.3" xref="A3.E16.m2.2.2.2.2.3.3.cmml">1</mn></msub><mo id="A3.E16.m2.2.2.2.2.2" xref="A3.E16.m2.2.2.2.2.2.cmml">⁢</mo><mrow id="A3.E16.m2.2.2.2.2.1.1" xref="A3.E16.m2.2.2.2.2.1.1.1.cmml"><mo id="A3.E16.m2.2.2.2.2.1.1.2" stretchy="false" xref="A3.E16.m2.2.2.2.2.1.1.1.cmml">(</mo><msub id="A3.E16.m2.2.2.2.2.1.1.1" xref="A3.E16.m2.2.2.2.2.1.1.1.cmml"><mi id="A3.E16.m2.2.2.2.2.1.1.1.2" xref="A3.E16.m2.2.2.2.2.1.1.1.2.cmml">𝐅</mi><mn id="A3.E16.m2.2.2.2.2.1.1.1.3" xref="A3.E16.m2.2.2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="A3.E16.m2.2.2.2.2.1.1.3" stretchy="false" xref="A3.E16.m2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.E16.m2.2b"><apply id="A3.E16.m2.2.2.cmml" xref="A3.E16.m2.2.2"><eq id="A3.E16.m2.2.2.3.cmml" xref="A3.E16.m2.2.2.3"></eq><csymbol cd="latexml" id="A3.E16.m2.2.2.4.cmml" xref="A3.E16.m2.2.2.4">absent</csymbol><apply id="A3.E16.m2.2.2.2.cmml" xref="A3.E16.m2.2.2.2"><plus id="A3.E16.m2.2.2.2.3.cmml" xref="A3.E16.m2.2.2.2.3"></plus><apply id="A3.E16.m2.1.1.1.1.cmml" xref="A3.E16.m2.1.1.1.1"><times id="A3.E16.m2.1.1.1.1.2.cmml" xref="A3.E16.m2.1.1.1.1.2"></times><apply id="A3.E16.m2.1.1.1.1.3.cmml" xref="A3.E16.m2.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E16.m2.1.1.1.1.3.1.cmml" xref="A3.E16.m2.1.1.1.1.3">subscript</csymbol><ci id="A3.E16.m2.1.1.1.1.3.2.cmml" xref="A3.E16.m2.1.1.1.1.3.2">𝐀</ci><cn id="A3.E16.m2.1.1.1.1.3.3.cmml" type="integer" xref="A3.E16.m2.1.1.1.1.3.3">1</cn></apply><apply id="A3.E16.m2.1.1.1.1.1.1.1.cmml" xref="A3.E16.m2.1.1.1.1.1.1"><times id="A3.E16.m2.1.1.1.1.1.1.1.2.cmml" xref="A3.E16.m2.1.1.1.1.1.1.1.2"></times><apply id="A3.E16.m2.1.1.1.1.1.1.1.3.cmml" xref="A3.E16.m2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E16.m2.1.1.1.1.1.1.1.3.1.cmml" xref="A3.E16.m2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A3.E16.m2.1.1.1.1.1.1.1.3.2.cmml" xref="A3.E16.m2.1.1.1.1.1.1.1.3.2">𝐁</ci><cn id="A3.E16.m2.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="A3.E16.m2.1.1.1.1.1.1.1.3.3">0</cn></apply><apply id="A3.E16.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E16.m2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E16.m2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E16.m2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A3.E16.m2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E16.m2.1.1.1.1.1.1.1.1.1.1.2">𝐅</ci><cn id="A3.E16.m2.1.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="A3.E16.m2.1.1.1.1.1.1.1.1.1.1.3">0</cn></apply></apply></apply><apply id="A3.E16.m2.2.2.2.2.cmml" xref="A3.E16.m2.2.2.2.2"><times id="A3.E16.m2.2.2.2.2.2.cmml" xref="A3.E16.m2.2.2.2.2.2"></times><apply id="A3.E16.m2.2.2.2.2.3.cmml" xref="A3.E16.m2.2.2.2.2.3"><csymbol cd="ambiguous" id="A3.E16.m2.2.2.2.2.3.1.cmml" xref="A3.E16.m2.2.2.2.2.3">subscript</csymbol><ci id="A3.E16.m2.2.2.2.2.3.2.cmml" xref="A3.E16.m2.2.2.2.2.3.2">𝐁</ci><cn id="A3.E16.m2.2.2.2.2.3.3.cmml" type="integer" xref="A3.E16.m2.2.2.2.2.3.3">1</cn></apply><apply id="A3.E16.m2.2.2.2.2.1.1.1.cmml" xref="A3.E16.m2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="A3.E16.m2.2.2.2.2.1.1.1.1.cmml" xref="A3.E16.m2.2.2.2.2.1.1">subscript</csymbol><ci id="A3.E16.m2.2.2.2.2.1.1.1.2.cmml" xref="A3.E16.m2.2.2.2.2.1.1.1.2">𝐅</ci><cn id="A3.E16.m2.2.2.2.2.1.1.1.3.cmml" type="integer" xref="A3.E16.m2.2.2.2.2.1.1.1.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E16.m2.2c">\displaystyle=\mathbf{A}_{1}(\mathbf{B}_{0}(\mathbf{F}_{0}))+\mathbf{B}_{1}(%
\mathbf{F}_{1})</annotation><annotation encoding="application/x-llamapun" id="A3.E16.m2.2d">= bold_A start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( bold_B start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( bold_F start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) ) + bold_B start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( bold_F start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
<tbody id="A3.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\Rightarrow\mathbf{A}_{1}\mathbf{B}_{0}(\mathbf{F}_{0})+\mathbf{B%
}_{1}(\mathbf{F}_{1})." class="ltx_Math" display="inline" id="A3.Ex1.m1.1"><semantics id="A3.Ex1.m1.1a"><mrow id="A3.Ex1.m1.1.1.1" xref="A3.Ex1.m1.1.1.1.1.cmml"><mrow id="A3.Ex1.m1.1.1.1.1" xref="A3.Ex1.m1.1.1.1.1.cmml"><mi id="A3.Ex1.m1.1.1.1.1.4" xref="A3.Ex1.m1.1.1.1.1.4.cmml"></mi><mo id="A3.Ex1.m1.1.1.1.1.3" stretchy="false" xref="A3.Ex1.m1.1.1.1.1.3.cmml">⇒</mo><mrow id="A3.Ex1.m1.1.1.1.1.2" xref="A3.Ex1.m1.1.1.1.1.2.cmml"><mrow id="A3.Ex1.m1.1.1.1.1.1.1" xref="A3.Ex1.m1.1.1.1.1.1.1.cmml"><msub id="A3.Ex1.m1.1.1.1.1.1.1.3" xref="A3.Ex1.m1.1.1.1.1.1.1.3.cmml"><mi id="A3.Ex1.m1.1.1.1.1.1.1.3.2" xref="A3.Ex1.m1.1.1.1.1.1.1.3.2.cmml">𝐀</mi><mn id="A3.Ex1.m1.1.1.1.1.1.1.3.3" xref="A3.Ex1.m1.1.1.1.1.1.1.3.3.cmml">1</mn></msub><mo id="A3.Ex1.m1.1.1.1.1.1.1.2" xref="A3.Ex1.m1.1.1.1.1.1.1.2.cmml">⁢</mo><msub id="A3.Ex1.m1.1.1.1.1.1.1.4" xref="A3.Ex1.m1.1.1.1.1.1.1.4.cmml"><mi id="A3.Ex1.m1.1.1.1.1.1.1.4.2" xref="A3.Ex1.m1.1.1.1.1.1.1.4.2.cmml">𝐁</mi><mn id="A3.Ex1.m1.1.1.1.1.1.1.4.3" xref="A3.Ex1.m1.1.1.1.1.1.1.4.3.cmml">0</mn></msub><mo id="A3.Ex1.m1.1.1.1.1.1.1.2a" xref="A3.Ex1.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A3.Ex1.m1.1.1.1.1.1.1.1.1" xref="A3.Ex1.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A3.Ex1.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A3.Ex1.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A3.Ex1.m1.1.1.1.1.1.1.1.1.1" xref="A3.Ex1.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A3.Ex1.m1.1.1.1.1.1.1.1.1.1.2" xref="A3.Ex1.m1.1.1.1.1.1.1.1.1.1.2.cmml">𝐅</mi><mn id="A3.Ex1.m1.1.1.1.1.1.1.1.1.1.3" xref="A3.Ex1.m1.1.1.1.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="A3.Ex1.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A3.Ex1.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A3.Ex1.m1.1.1.1.1.2.3" xref="A3.Ex1.m1.1.1.1.1.2.3.cmml">+</mo><mrow id="A3.Ex1.m1.1.1.1.1.2.2" xref="A3.Ex1.m1.1.1.1.1.2.2.cmml"><msub id="A3.Ex1.m1.1.1.1.1.2.2.3" xref="A3.Ex1.m1.1.1.1.1.2.2.3.cmml"><mi id="A3.Ex1.m1.1.1.1.1.2.2.3.2" xref="A3.Ex1.m1.1.1.1.1.2.2.3.2.cmml">𝐁</mi><mn id="A3.Ex1.m1.1.1.1.1.2.2.3.3" xref="A3.Ex1.m1.1.1.1.1.2.2.3.3.cmml">1</mn></msub><mo id="A3.Ex1.m1.1.1.1.1.2.2.2" xref="A3.Ex1.m1.1.1.1.1.2.2.2.cmml">⁢</mo><mrow id="A3.Ex1.m1.1.1.1.1.2.2.1.1" xref="A3.Ex1.m1.1.1.1.1.2.2.1.1.1.cmml"><mo id="A3.Ex1.m1.1.1.1.1.2.2.1.1.2" stretchy="false" xref="A3.Ex1.m1.1.1.1.1.2.2.1.1.1.cmml">(</mo><msub id="A3.Ex1.m1.1.1.1.1.2.2.1.1.1" xref="A3.Ex1.m1.1.1.1.1.2.2.1.1.1.cmml"><mi id="A3.Ex1.m1.1.1.1.1.2.2.1.1.1.2" xref="A3.Ex1.m1.1.1.1.1.2.2.1.1.1.2.cmml">𝐅</mi><mn id="A3.Ex1.m1.1.1.1.1.2.2.1.1.1.3" xref="A3.Ex1.m1.1.1.1.1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="A3.Ex1.m1.1.1.1.1.2.2.1.1.3" stretchy="false" xref="A3.Ex1.m1.1.1.1.1.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A3.Ex1.m1.1.1.1.2" lspace="0em" xref="A3.Ex1.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.Ex1.m1.1b"><apply id="A3.Ex1.m1.1.1.1.1.cmml" xref="A3.Ex1.m1.1.1.1"><ci id="A3.Ex1.m1.1.1.1.1.3.cmml" xref="A3.Ex1.m1.1.1.1.1.3">⇒</ci><csymbol cd="latexml" id="A3.Ex1.m1.1.1.1.1.4.cmml" xref="A3.Ex1.m1.1.1.1.1.4">absent</csymbol><apply id="A3.Ex1.m1.1.1.1.1.2.cmml" xref="A3.Ex1.m1.1.1.1.1.2"><plus id="A3.Ex1.m1.1.1.1.1.2.3.cmml" xref="A3.Ex1.m1.1.1.1.1.2.3"></plus><apply id="A3.Ex1.m1.1.1.1.1.1.1.cmml" xref="A3.Ex1.m1.1.1.1.1.1.1"><times id="A3.Ex1.m1.1.1.1.1.1.1.2.cmml" xref="A3.Ex1.m1.1.1.1.1.1.1.2"></times><apply id="A3.Ex1.m1.1.1.1.1.1.1.3.cmml" xref="A3.Ex1.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.Ex1.m1.1.1.1.1.1.1.3.1.cmml" xref="A3.Ex1.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A3.Ex1.m1.1.1.1.1.1.1.3.2.cmml" xref="A3.Ex1.m1.1.1.1.1.1.1.3.2">𝐀</ci><cn id="A3.Ex1.m1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="A3.Ex1.m1.1.1.1.1.1.1.3.3">1</cn></apply><apply id="A3.Ex1.m1.1.1.1.1.1.1.4.cmml" xref="A3.Ex1.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A3.Ex1.m1.1.1.1.1.1.1.4.1.cmml" xref="A3.Ex1.m1.1.1.1.1.1.1.4">subscript</csymbol><ci id="A3.Ex1.m1.1.1.1.1.1.1.4.2.cmml" xref="A3.Ex1.m1.1.1.1.1.1.1.4.2">𝐁</ci><cn id="A3.Ex1.m1.1.1.1.1.1.1.4.3.cmml" type="integer" xref="A3.Ex1.m1.1.1.1.1.1.1.4.3">0</cn></apply><apply id="A3.Ex1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.Ex1.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.Ex1.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A3.Ex1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.Ex1.m1.1.1.1.1.1.1.1.1.1.2">𝐅</ci><cn id="A3.Ex1.m1.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="A3.Ex1.m1.1.1.1.1.1.1.1.1.1.3">0</cn></apply></apply><apply id="A3.Ex1.m1.1.1.1.1.2.2.cmml" xref="A3.Ex1.m1.1.1.1.1.2.2"><times id="A3.Ex1.m1.1.1.1.1.2.2.2.cmml" xref="A3.Ex1.m1.1.1.1.1.2.2.2"></times><apply id="A3.Ex1.m1.1.1.1.1.2.2.3.cmml" xref="A3.Ex1.m1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="A3.Ex1.m1.1.1.1.1.2.2.3.1.cmml" xref="A3.Ex1.m1.1.1.1.1.2.2.3">subscript</csymbol><ci id="A3.Ex1.m1.1.1.1.1.2.2.3.2.cmml" xref="A3.Ex1.m1.1.1.1.1.2.2.3.2">𝐁</ci><cn id="A3.Ex1.m1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="A3.Ex1.m1.1.1.1.1.2.2.3.3">1</cn></apply><apply id="A3.Ex1.m1.1.1.1.1.2.2.1.1.1.cmml" xref="A3.Ex1.m1.1.1.1.1.2.2.1.1"><csymbol cd="ambiguous" id="A3.Ex1.m1.1.1.1.1.2.2.1.1.1.1.cmml" xref="A3.Ex1.m1.1.1.1.1.2.2.1.1">subscript</csymbol><ci id="A3.Ex1.m1.1.1.1.1.2.2.1.1.1.2.cmml" xref="A3.Ex1.m1.1.1.1.1.2.2.1.1.1.2">𝐅</ci><cn id="A3.Ex1.m1.1.1.1.1.2.2.1.1.1.3.cmml" type="integer" xref="A3.Ex1.m1.1.1.1.1.2.2.1.1.1.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex1.m1.1c">\displaystyle\Rightarrow\mathbf{A}_{1}\mathbf{B}_{0}(\mathbf{F}_{0})+\mathbf{B%
}_{1}(\mathbf{F}_{1}).</annotation><annotation encoding="application/x-llamapun" id="A3.Ex1.m1.1d">⇒ bold_A start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT bold_B start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( bold_F start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) + bold_B start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( bold_F start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A3.1.p1.12">The output <math alttext="\mathbf{y}_{1}" class="ltx_Math" display="inline" id="A3.1.p1.12.m1.1"><semantics id="A3.1.p1.12.m1.1a"><msub id="A3.1.p1.12.m1.1.1" xref="A3.1.p1.12.m1.1.1.cmml"><mi id="A3.1.p1.12.m1.1.1.2" xref="A3.1.p1.12.m1.1.1.2.cmml">𝐲</mi><mn id="A3.1.p1.12.m1.1.1.3" xref="A3.1.p1.12.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A3.1.p1.12.m1.1b"><apply id="A3.1.p1.12.m1.1.1.cmml" xref="A3.1.p1.12.m1.1.1"><csymbol cd="ambiguous" id="A3.1.p1.12.m1.1.1.1.cmml" xref="A3.1.p1.12.m1.1.1">subscript</csymbol><ci id="A3.1.p1.12.m1.1.1.2.cmml" xref="A3.1.p1.12.m1.1.1.2">𝐲</ci><cn id="A3.1.p1.12.m1.1.1.3.cmml" type="integer" xref="A3.1.p1.12.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.1.p1.12.m1.1c">\mathbf{y}_{1}</annotation><annotation encoding="application/x-llamapun" id="A3.1.p1.12.m1.1d">bold_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> can then be written as,</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A7.EGx11">
<tbody id="A3.E17"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{y}_{1}" class="ltx_Math" display="inline" id="A3.E17.m1.1"><semantics id="A3.E17.m1.1a"><msub id="A3.E17.m1.1.1" xref="A3.E17.m1.1.1.cmml"><mi id="A3.E17.m1.1.1.2" xref="A3.E17.m1.1.1.2.cmml">𝐲</mi><mn id="A3.E17.m1.1.1.3" xref="A3.E17.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A3.E17.m1.1b"><apply id="A3.E17.m1.1.1.cmml" xref="A3.E17.m1.1.1"><csymbol cd="ambiguous" id="A3.E17.m1.1.1.1.cmml" xref="A3.E17.m1.1.1">subscript</csymbol><ci id="A3.E17.m1.1.1.2.cmml" xref="A3.E17.m1.1.1.2">𝐲</ci><cn id="A3.E17.m1.1.1.3.cmml" type="integer" xref="A3.E17.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E17.m1.1c">\displaystyle\mathbf{y}_{1}</annotation><annotation encoding="application/x-llamapun" id="A3.E17.m1.1d">bold_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbf{C}_{1}(\mathbf{\hat{H}}_{1})." class="ltx_Math" display="inline" id="A3.E17.m2.1"><semantics id="A3.E17.m2.1a"><mrow id="A3.E17.m2.1.1.1" xref="A3.E17.m2.1.1.1.1.cmml"><mrow id="A3.E17.m2.1.1.1.1" xref="A3.E17.m2.1.1.1.1.cmml"><mi id="A3.E17.m2.1.1.1.1.3" xref="A3.E17.m2.1.1.1.1.3.cmml"></mi><mo id="A3.E17.m2.1.1.1.1.2" xref="A3.E17.m2.1.1.1.1.2.cmml">=</mo><mrow id="A3.E17.m2.1.1.1.1.1" xref="A3.E17.m2.1.1.1.1.1.cmml"><msub id="A3.E17.m2.1.1.1.1.1.3" xref="A3.E17.m2.1.1.1.1.1.3.cmml"><mi id="A3.E17.m2.1.1.1.1.1.3.2" xref="A3.E17.m2.1.1.1.1.1.3.2.cmml">𝐂</mi><mn id="A3.E17.m2.1.1.1.1.1.3.3" xref="A3.E17.m2.1.1.1.1.1.3.3.cmml">1</mn></msub><mo id="A3.E17.m2.1.1.1.1.1.2" xref="A3.E17.m2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A3.E17.m2.1.1.1.1.1.1.1" xref="A3.E17.m2.1.1.1.1.1.1.1.1.cmml"><mo id="A3.E17.m2.1.1.1.1.1.1.1.2" stretchy="false" xref="A3.E17.m2.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A3.E17.m2.1.1.1.1.1.1.1.1" xref="A3.E17.m2.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="A3.E17.m2.1.1.1.1.1.1.1.1.2" xref="A3.E17.m2.1.1.1.1.1.1.1.1.2.cmml"><mi id="A3.E17.m2.1.1.1.1.1.1.1.1.2.2" xref="A3.E17.m2.1.1.1.1.1.1.1.1.2.2.cmml">𝐇</mi><mo id="A3.E17.m2.1.1.1.1.1.1.1.1.2.1" xref="A3.E17.m2.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mn id="A3.E17.m2.1.1.1.1.1.1.1.1.3" xref="A3.E17.m2.1.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="A3.E17.m2.1.1.1.1.1.1.1.3" stretchy="false" xref="A3.E17.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A3.E17.m2.1.1.1.2" lspace="0em" xref="A3.E17.m2.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E17.m2.1b"><apply id="A3.E17.m2.1.1.1.1.cmml" xref="A3.E17.m2.1.1.1"><eq id="A3.E17.m2.1.1.1.1.2.cmml" xref="A3.E17.m2.1.1.1.1.2"></eq><csymbol cd="latexml" id="A3.E17.m2.1.1.1.1.3.cmml" xref="A3.E17.m2.1.1.1.1.3">absent</csymbol><apply id="A3.E17.m2.1.1.1.1.1.cmml" xref="A3.E17.m2.1.1.1.1.1"><times id="A3.E17.m2.1.1.1.1.1.2.cmml" xref="A3.E17.m2.1.1.1.1.1.2"></times><apply id="A3.E17.m2.1.1.1.1.1.3.cmml" xref="A3.E17.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E17.m2.1.1.1.1.1.3.1.cmml" xref="A3.E17.m2.1.1.1.1.1.3">subscript</csymbol><ci id="A3.E17.m2.1.1.1.1.1.3.2.cmml" xref="A3.E17.m2.1.1.1.1.1.3.2">𝐂</ci><cn id="A3.E17.m2.1.1.1.1.1.3.3.cmml" type="integer" xref="A3.E17.m2.1.1.1.1.1.3.3">1</cn></apply><apply id="A3.E17.m2.1.1.1.1.1.1.1.1.cmml" xref="A3.E17.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E17.m2.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E17.m2.1.1.1.1.1.1.1">subscript</csymbol><apply id="A3.E17.m2.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E17.m2.1.1.1.1.1.1.1.1.2"><ci id="A3.E17.m2.1.1.1.1.1.1.1.1.2.1.cmml" xref="A3.E17.m2.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="A3.E17.m2.1.1.1.1.1.1.1.1.2.2.cmml" xref="A3.E17.m2.1.1.1.1.1.1.1.1.2.2">𝐇</ci></apply><cn id="A3.E17.m2.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="A3.E17.m2.1.1.1.1.1.1.1.1.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E17.m2.1c">\displaystyle=\mathbf{C}_{1}(\mathbf{\hat{H}}_{1}).</annotation><annotation encoding="application/x-llamapun" id="A3.E17.m2.1d">= bold_C start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( over^ start_ARG bold_H end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A3.1.p1.15">At every timestep <math alttext="t" class="ltx_Math" display="inline" id="A3.1.p1.13.m1.1"><semantics id="A3.1.p1.13.m1.1a"><mi id="A3.1.p1.13.m1.1.1" xref="A3.1.p1.13.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A3.1.p1.13.m1.1b"><ci id="A3.1.p1.13.m1.1.1.cmml" xref="A3.1.p1.13.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.1.p1.13.m1.1c">t</annotation><annotation encoding="application/x-llamapun" id="A3.1.p1.13.m1.1d">italic_t</annotation></semantics></math>, the output can be written in terms of the history (previous timestep) and the input (at current timestep). Now, consider the case <math alttext="t=2" class="ltx_Math" display="inline" id="A3.1.p1.14.m2.1"><semantics id="A3.1.p1.14.m2.1a"><mrow id="A3.1.p1.14.m2.1.1" xref="A3.1.p1.14.m2.1.1.cmml"><mi id="A3.1.p1.14.m2.1.1.2" xref="A3.1.p1.14.m2.1.1.2.cmml">t</mi><mo id="A3.1.p1.14.m2.1.1.1" xref="A3.1.p1.14.m2.1.1.1.cmml">=</mo><mn id="A3.1.p1.14.m2.1.1.3" xref="A3.1.p1.14.m2.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.1.p1.14.m2.1b"><apply id="A3.1.p1.14.m2.1.1.cmml" xref="A3.1.p1.14.m2.1.1"><eq id="A3.1.p1.14.m2.1.1.1.cmml" xref="A3.1.p1.14.m2.1.1.1"></eq><ci id="A3.1.p1.14.m2.1.1.2.cmml" xref="A3.1.p1.14.m2.1.1.2">𝑡</ci><cn id="A3.1.p1.14.m2.1.1.3.cmml" type="integer" xref="A3.1.p1.14.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.1.p1.14.m2.1c">t=2</annotation><annotation encoding="application/x-llamapun" id="A3.1.p1.14.m2.1d">italic_t = 2</annotation></semantics></math>, and let the frame features be denoted by <math alttext="\mathbf{F}_{2}" class="ltx_Math" display="inline" id="A3.1.p1.15.m3.1"><semantics id="A3.1.p1.15.m3.1a"><msub id="A3.1.p1.15.m3.1.1" xref="A3.1.p1.15.m3.1.1.cmml"><mi id="A3.1.p1.15.m3.1.1.2" xref="A3.1.p1.15.m3.1.1.2.cmml">𝐅</mi><mn id="A3.1.p1.15.m3.1.1.3" xref="A3.1.p1.15.m3.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A3.1.p1.15.m3.1b"><apply id="A3.1.p1.15.m3.1.1.cmml" xref="A3.1.p1.15.m3.1.1"><csymbol cd="ambiguous" id="A3.1.p1.15.m3.1.1.1.cmml" xref="A3.1.p1.15.m3.1.1">subscript</csymbol><ci id="A3.1.p1.15.m3.1.1.2.cmml" xref="A3.1.p1.15.m3.1.1.2">𝐅</ci><cn id="A3.1.p1.15.m3.1.1.3.cmml" type="integer" xref="A3.1.p1.15.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.1.p1.15.m3.1c">\mathbf{F}_{2}</annotation><annotation encoding="application/x-llamapun" id="A3.1.p1.15.m3.1d">bold_F start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, then we can write,</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A7.EGx12">
<tbody id="A3.E18"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{\hat{H}}_{2}" class="ltx_Math" display="inline" id="A3.E18.m1.1"><semantics id="A3.E18.m1.1a"><msub id="A3.E18.m1.1.1" xref="A3.E18.m1.1.1.cmml"><mover accent="true" id="A3.E18.m1.1.1.2" xref="A3.E18.m1.1.1.2.cmml"><mi id="A3.E18.m1.1.1.2.2" xref="A3.E18.m1.1.1.2.2.cmml">𝐇</mi><mo id="A3.E18.m1.1.1.2.1" xref="A3.E18.m1.1.1.2.1.cmml">^</mo></mover><mn id="A3.E18.m1.1.1.3" xref="A3.E18.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A3.E18.m1.1b"><apply id="A3.E18.m1.1.1.cmml" xref="A3.E18.m1.1.1"><csymbol cd="ambiguous" id="A3.E18.m1.1.1.1.cmml" xref="A3.E18.m1.1.1">subscript</csymbol><apply id="A3.E18.m1.1.1.2.cmml" xref="A3.E18.m1.1.1.2"><ci id="A3.E18.m1.1.1.2.1.cmml" xref="A3.E18.m1.1.1.2.1">^</ci><ci id="A3.E18.m1.1.1.2.2.cmml" xref="A3.E18.m1.1.1.2.2">𝐇</ci></apply><cn id="A3.E18.m1.1.1.3.cmml" type="integer" xref="A3.E18.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E18.m1.1c">\displaystyle\mathbf{\hat{H}}_{2}</annotation><annotation encoding="application/x-llamapun" id="A3.E18.m1.1d">over^ start_ARG bold_H end_ARG start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbf{A}_{2}(\mathbf{\hat{H}}_{1})+\mathbf{B}_{2}(\mathbf{%
\mathbf{F}}_{2})," class="ltx_Math" display="inline" id="A3.E18.m2.1"><semantics id="A3.E18.m2.1a"><mrow id="A3.E18.m2.1.1.1" xref="A3.E18.m2.1.1.1.1.cmml"><mrow id="A3.E18.m2.1.1.1.1" xref="A3.E18.m2.1.1.1.1.cmml"><mi id="A3.E18.m2.1.1.1.1.4" xref="A3.E18.m2.1.1.1.1.4.cmml"></mi><mo id="A3.E18.m2.1.1.1.1.3" xref="A3.E18.m2.1.1.1.1.3.cmml">=</mo><mrow id="A3.E18.m2.1.1.1.1.2" xref="A3.E18.m2.1.1.1.1.2.cmml"><mrow id="A3.E18.m2.1.1.1.1.1.1" xref="A3.E18.m2.1.1.1.1.1.1.cmml"><msub id="A3.E18.m2.1.1.1.1.1.1.3" xref="A3.E18.m2.1.1.1.1.1.1.3.cmml"><mi id="A3.E18.m2.1.1.1.1.1.1.3.2" xref="A3.E18.m2.1.1.1.1.1.1.3.2.cmml">𝐀</mi><mn id="A3.E18.m2.1.1.1.1.1.1.3.3" xref="A3.E18.m2.1.1.1.1.1.1.3.3.cmml">2</mn></msub><mo id="A3.E18.m2.1.1.1.1.1.1.2" xref="A3.E18.m2.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A3.E18.m2.1.1.1.1.1.1.1.1" xref="A3.E18.m2.1.1.1.1.1.1.1.1.1.cmml"><mo id="A3.E18.m2.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A3.E18.m2.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A3.E18.m2.1.1.1.1.1.1.1.1.1" xref="A3.E18.m2.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="A3.E18.m2.1.1.1.1.1.1.1.1.1.2" xref="A3.E18.m2.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A3.E18.m2.1.1.1.1.1.1.1.1.1.2.2" xref="A3.E18.m2.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐇</mi><mo id="A3.E18.m2.1.1.1.1.1.1.1.1.1.2.1" xref="A3.E18.m2.1.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mn id="A3.E18.m2.1.1.1.1.1.1.1.1.1.3" xref="A3.E18.m2.1.1.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="A3.E18.m2.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A3.E18.m2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A3.E18.m2.1.1.1.1.2.3" xref="A3.E18.m2.1.1.1.1.2.3.cmml">+</mo><mrow id="A3.E18.m2.1.1.1.1.2.2" xref="A3.E18.m2.1.1.1.1.2.2.cmml"><msub id="A3.E18.m2.1.1.1.1.2.2.3" xref="A3.E18.m2.1.1.1.1.2.2.3.cmml"><mi id="A3.E18.m2.1.1.1.1.2.2.3.2" xref="A3.E18.m2.1.1.1.1.2.2.3.2.cmml">𝐁</mi><mn id="A3.E18.m2.1.1.1.1.2.2.3.3" xref="A3.E18.m2.1.1.1.1.2.2.3.3.cmml">2</mn></msub><mo id="A3.E18.m2.1.1.1.1.2.2.2" xref="A3.E18.m2.1.1.1.1.2.2.2.cmml">⁢</mo><mrow id="A3.E18.m2.1.1.1.1.2.2.1.1" xref="A3.E18.m2.1.1.1.1.2.2.1.1.1.cmml"><mo id="A3.E18.m2.1.1.1.1.2.2.1.1.2" stretchy="false" xref="A3.E18.m2.1.1.1.1.2.2.1.1.1.cmml">(</mo><msub id="A3.E18.m2.1.1.1.1.2.2.1.1.1" xref="A3.E18.m2.1.1.1.1.2.2.1.1.1.cmml"><mi id="A3.E18.m2.1.1.1.1.2.2.1.1.1.2" xref="A3.E18.m2.1.1.1.1.2.2.1.1.1.2.cmml">𝐅</mi><mn id="A3.E18.m2.1.1.1.1.2.2.1.1.1.3" xref="A3.E18.m2.1.1.1.1.2.2.1.1.1.3.cmml">2</mn></msub><mo id="A3.E18.m2.1.1.1.1.2.2.1.1.3" stretchy="false" xref="A3.E18.m2.1.1.1.1.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A3.E18.m2.1.1.1.2" xref="A3.E18.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E18.m2.1b"><apply id="A3.E18.m2.1.1.1.1.cmml" xref="A3.E18.m2.1.1.1"><eq id="A3.E18.m2.1.1.1.1.3.cmml" xref="A3.E18.m2.1.1.1.1.3"></eq><csymbol cd="latexml" id="A3.E18.m2.1.1.1.1.4.cmml" xref="A3.E18.m2.1.1.1.1.4">absent</csymbol><apply id="A3.E18.m2.1.1.1.1.2.cmml" xref="A3.E18.m2.1.1.1.1.2"><plus id="A3.E18.m2.1.1.1.1.2.3.cmml" xref="A3.E18.m2.1.1.1.1.2.3"></plus><apply id="A3.E18.m2.1.1.1.1.1.1.cmml" xref="A3.E18.m2.1.1.1.1.1.1"><times id="A3.E18.m2.1.1.1.1.1.1.2.cmml" xref="A3.E18.m2.1.1.1.1.1.1.2"></times><apply id="A3.E18.m2.1.1.1.1.1.1.3.cmml" xref="A3.E18.m2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E18.m2.1.1.1.1.1.1.3.1.cmml" xref="A3.E18.m2.1.1.1.1.1.1.3">subscript</csymbol><ci id="A3.E18.m2.1.1.1.1.1.1.3.2.cmml" xref="A3.E18.m2.1.1.1.1.1.1.3.2">𝐀</ci><cn id="A3.E18.m2.1.1.1.1.1.1.3.3.cmml" type="integer" xref="A3.E18.m2.1.1.1.1.1.1.3.3">2</cn></apply><apply id="A3.E18.m2.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E18.m2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E18.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E18.m2.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="A3.E18.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E18.m2.1.1.1.1.1.1.1.1.1.2"><ci id="A3.E18.m2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A3.E18.m2.1.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="A3.E18.m2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A3.E18.m2.1.1.1.1.1.1.1.1.1.2.2">𝐇</ci></apply><cn id="A3.E18.m2.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="A3.E18.m2.1.1.1.1.1.1.1.1.1.3">1</cn></apply></apply><apply id="A3.E18.m2.1.1.1.1.2.2.cmml" xref="A3.E18.m2.1.1.1.1.2.2"><times id="A3.E18.m2.1.1.1.1.2.2.2.cmml" xref="A3.E18.m2.1.1.1.1.2.2.2"></times><apply id="A3.E18.m2.1.1.1.1.2.2.3.cmml" xref="A3.E18.m2.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="A3.E18.m2.1.1.1.1.2.2.3.1.cmml" xref="A3.E18.m2.1.1.1.1.2.2.3">subscript</csymbol><ci id="A3.E18.m2.1.1.1.1.2.2.3.2.cmml" xref="A3.E18.m2.1.1.1.1.2.2.3.2">𝐁</ci><cn id="A3.E18.m2.1.1.1.1.2.2.3.3.cmml" type="integer" xref="A3.E18.m2.1.1.1.1.2.2.3.3">2</cn></apply><apply id="A3.E18.m2.1.1.1.1.2.2.1.1.1.cmml" xref="A3.E18.m2.1.1.1.1.2.2.1.1"><csymbol cd="ambiguous" id="A3.E18.m2.1.1.1.1.2.2.1.1.1.1.cmml" xref="A3.E18.m2.1.1.1.1.2.2.1.1">subscript</csymbol><ci id="A3.E18.m2.1.1.1.1.2.2.1.1.1.2.cmml" xref="A3.E18.m2.1.1.1.1.2.2.1.1.1.2">𝐅</ci><cn id="A3.E18.m2.1.1.1.1.2.2.1.1.1.3.cmml" type="integer" xref="A3.E18.m2.1.1.1.1.2.2.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E18.m2.1c">\displaystyle=\mathbf{A}_{2}(\mathbf{\hat{H}}_{1})+\mathbf{B}_{2}(\mathbf{%
\mathbf{F}}_{2}),</annotation><annotation encoding="application/x-llamapun" id="A3.E18.m2.1d">= bold_A start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( over^ start_ARG bold_H end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) + bold_B start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( bold_F start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(18)</span></td>
</tr></tbody>
<tbody id="A3.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\Rightarrow\mathbf{A}_{2}(\mathbf{A}_{1}(\mathbf{B}_{0}(\mathbf{F%
}_{0})))+\mathbf{B}_{1}(\mathbf{F}_{1})+\mathbf{B}_{2}(\mathbf{F}_{2}),~{}~{}%
\text{because}~{}\lx@cref{creftype~refnum}{eq:combining01ssm}" class="ltx_Math" display="inline" id="A3.Ex2.m1.2"><semantics id="A3.Ex2.m1.2a"><mrow id="A3.Ex2.m1.2.2" xref="A3.Ex2.m1.2.2.cmml"><mi id="A3.Ex2.m1.2.2.4" xref="A3.Ex2.m1.2.2.4.cmml"></mi><mo id="A3.Ex2.m1.2.2.3" stretchy="false" xref="A3.Ex2.m1.2.2.3.cmml">⇒</mo><mrow id="A3.Ex2.m1.2.2.2.2" xref="A3.Ex2.m1.2.2.2.3.cmml"><mrow id="A3.Ex2.m1.1.1.1.1.1" xref="A3.Ex2.m1.1.1.1.1.1.cmml"><mrow id="A3.Ex2.m1.1.1.1.1.1.1" xref="A3.Ex2.m1.1.1.1.1.1.1.cmml"><msub id="A3.Ex2.m1.1.1.1.1.1.1.3" xref="A3.Ex2.m1.1.1.1.1.1.1.3.cmml"><mi id="A3.Ex2.m1.1.1.1.1.1.1.3.2" xref="A3.Ex2.m1.1.1.1.1.1.1.3.2.cmml">𝐀</mi><mn id="A3.Ex2.m1.1.1.1.1.1.1.3.3" xref="A3.Ex2.m1.1.1.1.1.1.1.3.3.cmml">2</mn></msub><mo id="A3.Ex2.m1.1.1.1.1.1.1.2" xref="A3.Ex2.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A3.Ex2.m1.1.1.1.1.1.1.1.1" xref="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A3.Ex2.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A3.Ex2.m1.1.1.1.1.1.1.1.1.1" xref="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.cmml"><msub id="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.3" xref="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.3.2" xref="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">𝐀</mi><mn id="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.3.3" xref="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></msub><mo id="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.2" xref="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1" xref="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">𝐁</mi><mn id="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">0</mn></msub><mo id="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐅</mi><mn id="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A3.Ex2.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A3.Ex2.m1.1.1.1.1.1.4" xref="A3.Ex2.m1.1.1.1.1.1.4.cmml">+</mo><mrow id="A3.Ex2.m1.1.1.1.1.1.2" xref="A3.Ex2.m1.1.1.1.1.1.2.cmml"><msub id="A3.Ex2.m1.1.1.1.1.1.2.3" xref="A3.Ex2.m1.1.1.1.1.1.2.3.cmml"><mi id="A3.Ex2.m1.1.1.1.1.1.2.3.2" xref="A3.Ex2.m1.1.1.1.1.1.2.3.2.cmml">𝐁</mi><mn id="A3.Ex2.m1.1.1.1.1.1.2.3.3" xref="A3.Ex2.m1.1.1.1.1.1.2.3.3.cmml">1</mn></msub><mo id="A3.Ex2.m1.1.1.1.1.1.2.2" xref="A3.Ex2.m1.1.1.1.1.1.2.2.cmml">⁢</mo><mrow id="A3.Ex2.m1.1.1.1.1.1.2.1.1" xref="A3.Ex2.m1.1.1.1.1.1.2.1.1.1.cmml"><mo id="A3.Ex2.m1.1.1.1.1.1.2.1.1.2" stretchy="false" xref="A3.Ex2.m1.1.1.1.1.1.2.1.1.1.cmml">(</mo><msub id="A3.Ex2.m1.1.1.1.1.1.2.1.1.1" xref="A3.Ex2.m1.1.1.1.1.1.2.1.1.1.cmml"><mi id="A3.Ex2.m1.1.1.1.1.1.2.1.1.1.2" xref="A3.Ex2.m1.1.1.1.1.1.2.1.1.1.2.cmml">𝐅</mi><mn id="A3.Ex2.m1.1.1.1.1.1.2.1.1.1.3" xref="A3.Ex2.m1.1.1.1.1.1.2.1.1.1.3.cmml">1</mn></msub><mo id="A3.Ex2.m1.1.1.1.1.1.2.1.1.3" stretchy="false" xref="A3.Ex2.m1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="A3.Ex2.m1.1.1.1.1.1.4a" xref="A3.Ex2.m1.1.1.1.1.1.4.cmml">+</mo><mrow id="A3.Ex2.m1.1.1.1.1.1.3" xref="A3.Ex2.m1.1.1.1.1.1.3.cmml"><msub id="A3.Ex2.m1.1.1.1.1.1.3.3" xref="A3.Ex2.m1.1.1.1.1.1.3.3.cmml"><mi id="A3.Ex2.m1.1.1.1.1.1.3.3.2" xref="A3.Ex2.m1.1.1.1.1.1.3.3.2.cmml">𝐁</mi><mn id="A3.Ex2.m1.1.1.1.1.1.3.3.3" xref="A3.Ex2.m1.1.1.1.1.1.3.3.3.cmml">2</mn></msub><mo id="A3.Ex2.m1.1.1.1.1.1.3.2" xref="A3.Ex2.m1.1.1.1.1.1.3.2.cmml">⁢</mo><mrow id="A3.Ex2.m1.1.1.1.1.1.3.1.1" xref="A3.Ex2.m1.1.1.1.1.1.3.1.1.1.cmml"><mo id="A3.Ex2.m1.1.1.1.1.1.3.1.1.2" stretchy="false" xref="A3.Ex2.m1.1.1.1.1.1.3.1.1.1.cmml">(</mo><msub id="A3.Ex2.m1.1.1.1.1.1.3.1.1.1" xref="A3.Ex2.m1.1.1.1.1.1.3.1.1.1.cmml"><mi id="A3.Ex2.m1.1.1.1.1.1.3.1.1.1.2" xref="A3.Ex2.m1.1.1.1.1.1.3.1.1.1.2.cmml">𝐅</mi><mn id="A3.Ex2.m1.1.1.1.1.1.3.1.1.1.3" xref="A3.Ex2.m1.1.1.1.1.1.3.1.1.1.3.cmml">2</mn></msub><mo id="A3.Ex2.m1.1.1.1.1.1.3.1.1.3" stretchy="false" xref="A3.Ex2.m1.1.1.1.1.1.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A3.Ex2.m1.2.2.2.2.3" rspace="0.827em" xref="A3.Ex2.m1.2.2.2.3.cmml">,</mo><mrow id="A3.Ex2.m1.2.2.2.2.2" xref="A3.Ex2.m1.2.2.2.2.2.cmml"><mtext id="A3.Ex2.m1.2.2.2.2.2.2" xref="A3.Ex2.m1.2.2.2.2.2.2a.cmml">because</mtext><mo id="A3.Ex2.m1.2.2.2.2.2.1" lspace="0.330em" xref="A3.Ex2.m1.2.2.2.2.2.1.cmml">⁢</mo><mtext class="ltx_mathvariant_italic" id="A3.Ex2.m1.2.2.2.2.2.3" xref="A3.Ex2.m1.2.2.2.2.2.3d.cmml"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2410.03936v1#A3.E16" title="In Proof 1. ‣ Appendix C Relationship to State Space Models ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">eq.</span> <span class="ltx_text ltx_ref_tag">16</span></a></mtext></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.Ex2.m1.2b"><apply id="A3.Ex2.m1.2.2.cmml" xref="A3.Ex2.m1.2.2"><ci id="A3.Ex2.m1.2.2.3.cmml" xref="A3.Ex2.m1.2.2.3">⇒</ci><csymbol cd="latexml" id="A3.Ex2.m1.2.2.4.cmml" xref="A3.Ex2.m1.2.2.4">absent</csymbol><list id="A3.Ex2.m1.2.2.2.3.cmml" xref="A3.Ex2.m1.2.2.2.2"><apply id="A3.Ex2.m1.1.1.1.1.1.cmml" xref="A3.Ex2.m1.1.1.1.1.1"><plus id="A3.Ex2.m1.1.1.1.1.1.4.cmml" xref="A3.Ex2.m1.1.1.1.1.1.4"></plus><apply id="A3.Ex2.m1.1.1.1.1.1.1.cmml" xref="A3.Ex2.m1.1.1.1.1.1.1"><times id="A3.Ex2.m1.1.1.1.1.1.1.2.cmml" xref="A3.Ex2.m1.1.1.1.1.1.1.2"></times><apply id="A3.Ex2.m1.1.1.1.1.1.1.3.cmml" xref="A3.Ex2.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.Ex2.m1.1.1.1.1.1.1.3.1.cmml" xref="A3.Ex2.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A3.Ex2.m1.1.1.1.1.1.1.3.2.cmml" xref="A3.Ex2.m1.1.1.1.1.1.1.3.2">𝐀</ci><cn id="A3.Ex2.m1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="A3.Ex2.m1.1.1.1.1.1.1.3.3">2</cn></apply><apply id="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.Ex2.m1.1.1.1.1.1.1.1.1"><times id="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.2"></times><apply id="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.3.2">𝐀</ci><cn id="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply><apply id="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1"><times id="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝐁</ci><cn id="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">0</cn></apply><apply id="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐅</ci><cn id="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="A3.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">0</cn></apply></apply></apply></apply><apply id="A3.Ex2.m1.1.1.1.1.1.2.cmml" xref="A3.Ex2.m1.1.1.1.1.1.2"><times id="A3.Ex2.m1.1.1.1.1.1.2.2.cmml" xref="A3.Ex2.m1.1.1.1.1.1.2.2"></times><apply id="A3.Ex2.m1.1.1.1.1.1.2.3.cmml" xref="A3.Ex2.m1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A3.Ex2.m1.1.1.1.1.1.2.3.1.cmml" xref="A3.Ex2.m1.1.1.1.1.1.2.3">subscript</csymbol><ci id="A3.Ex2.m1.1.1.1.1.1.2.3.2.cmml" xref="A3.Ex2.m1.1.1.1.1.1.2.3.2">𝐁</ci><cn id="A3.Ex2.m1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="A3.Ex2.m1.1.1.1.1.1.2.3.3">1</cn></apply><apply id="A3.Ex2.m1.1.1.1.1.1.2.1.1.1.cmml" xref="A3.Ex2.m1.1.1.1.1.1.2.1.1"><csymbol cd="ambiguous" id="A3.Ex2.m1.1.1.1.1.1.2.1.1.1.1.cmml" xref="A3.Ex2.m1.1.1.1.1.1.2.1.1">subscript</csymbol><ci id="A3.Ex2.m1.1.1.1.1.1.2.1.1.1.2.cmml" xref="A3.Ex2.m1.1.1.1.1.1.2.1.1.1.2">𝐅</ci><cn id="A3.Ex2.m1.1.1.1.1.1.2.1.1.1.3.cmml" type="integer" xref="A3.Ex2.m1.1.1.1.1.1.2.1.1.1.3">1</cn></apply></apply><apply id="A3.Ex2.m1.1.1.1.1.1.3.cmml" xref="A3.Ex2.m1.1.1.1.1.1.3"><times id="A3.Ex2.m1.1.1.1.1.1.3.2.cmml" xref="A3.Ex2.m1.1.1.1.1.1.3.2"></times><apply id="A3.Ex2.m1.1.1.1.1.1.3.3.cmml" xref="A3.Ex2.m1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A3.Ex2.m1.1.1.1.1.1.3.3.1.cmml" xref="A3.Ex2.m1.1.1.1.1.1.3.3">subscript</csymbol><ci id="A3.Ex2.m1.1.1.1.1.1.3.3.2.cmml" xref="A3.Ex2.m1.1.1.1.1.1.3.3.2">𝐁</ci><cn id="A3.Ex2.m1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="A3.Ex2.m1.1.1.1.1.1.3.3.3">2</cn></apply><apply id="A3.Ex2.m1.1.1.1.1.1.3.1.1.1.cmml" xref="A3.Ex2.m1.1.1.1.1.1.3.1.1"><csymbol cd="ambiguous" id="A3.Ex2.m1.1.1.1.1.1.3.1.1.1.1.cmml" xref="A3.Ex2.m1.1.1.1.1.1.3.1.1">subscript</csymbol><ci id="A3.Ex2.m1.1.1.1.1.1.3.1.1.1.2.cmml" xref="A3.Ex2.m1.1.1.1.1.1.3.1.1.1.2">𝐅</ci><cn id="A3.Ex2.m1.1.1.1.1.1.3.1.1.1.3.cmml" type="integer" xref="A3.Ex2.m1.1.1.1.1.1.3.1.1.1.3">2</cn></apply></apply></apply><apply id="A3.Ex2.m1.2.2.2.2.2.cmml" xref="A3.Ex2.m1.2.2.2.2.2"><times id="A3.Ex2.m1.2.2.2.2.2.1.cmml" xref="A3.Ex2.m1.2.2.2.2.2.1"></times><ci id="A3.Ex2.m1.2.2.2.2.2.2a.cmml" xref="A3.Ex2.m1.2.2.2.2.2.2"><mtext id="A3.Ex2.m1.2.2.2.2.2.2.cmml" xref="A3.Ex2.m1.2.2.2.2.2.2">because</mtext></ci><ci id="A3.Ex2.m1.2.2.2.2.2.3d.cmml" xref="A3.Ex2.m1.2.2.2.2.2.3"><mtext class="ltx_mathvariant_italic" id="A3.Ex2.m1.2.2.2.2.2.3.cmml" xref="A3.Ex2.m1.2.2.2.2.2.3"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2410.03936v1#A3.E16" title="In Proof 1. ‣ Appendix C Relationship to State Space Models ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">eq.</span> <span class="ltx_text ltx_ref_tag">16</span></a></mtext></ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex2.m1.2c">\displaystyle\Rightarrow\mathbf{A}_{2}(\mathbf{A}_{1}(\mathbf{B}_{0}(\mathbf{F%
}_{0})))+\mathbf{B}_{1}(\mathbf{F}_{1})+\mathbf{B}_{2}(\mathbf{F}_{2}),~{}~{}%
\text{because}~{}\lx@cref{creftype~refnum}{eq:combining01ssm}</annotation><annotation encoding="application/x-llamapun" id="A3.Ex2.m1.2d">⇒ bold_A start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( bold_A start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( bold_B start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( bold_F start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) ) ) + bold_B start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( bold_F start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) + bold_B start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( bold_F start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) , because</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A3.E19"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\text{therefore},~{}~{}\mathbf{\hat{H}}_{2}" class="ltx_Math" display="inline" id="A3.E19.m1.2"><semantics id="A3.E19.m1.2a"><mrow id="A3.E19.m1.2.2.1" xref="A3.E19.m1.2.2.2.cmml"><mtext id="A3.E19.m1.1.1" xref="A3.E19.m1.1.1a.cmml">therefore</mtext><mo id="A3.E19.m1.2.2.1.2" rspace="0.827em" xref="A3.E19.m1.2.2.2.cmml">,</mo><msub id="A3.E19.m1.2.2.1.1" xref="A3.E19.m1.2.2.1.1.cmml"><mover accent="true" id="A3.E19.m1.2.2.1.1.2" xref="A3.E19.m1.2.2.1.1.2.cmml"><mi id="A3.E19.m1.2.2.1.1.2.2" xref="A3.E19.m1.2.2.1.1.2.2.cmml">𝐇</mi><mo id="A3.E19.m1.2.2.1.1.2.1" xref="A3.E19.m1.2.2.1.1.2.1.cmml">^</mo></mover><mn id="A3.E19.m1.2.2.1.1.3" xref="A3.E19.m1.2.2.1.1.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="A3.E19.m1.2b"><list id="A3.E19.m1.2.2.2.cmml" xref="A3.E19.m1.2.2.1"><ci id="A3.E19.m1.1.1a.cmml" xref="A3.E19.m1.1.1"><mtext id="A3.E19.m1.1.1.cmml" xref="A3.E19.m1.1.1">therefore</mtext></ci><apply id="A3.E19.m1.2.2.1.1.cmml" xref="A3.E19.m1.2.2.1.1"><csymbol cd="ambiguous" id="A3.E19.m1.2.2.1.1.1.cmml" xref="A3.E19.m1.2.2.1.1">subscript</csymbol><apply id="A3.E19.m1.2.2.1.1.2.cmml" xref="A3.E19.m1.2.2.1.1.2"><ci id="A3.E19.m1.2.2.1.1.2.1.cmml" xref="A3.E19.m1.2.2.1.1.2.1">^</ci><ci id="A3.E19.m1.2.2.1.1.2.2.cmml" xref="A3.E19.m1.2.2.1.1.2.2">𝐇</ci></apply><cn id="A3.E19.m1.2.2.1.1.3.cmml" type="integer" xref="A3.E19.m1.2.2.1.1.3">2</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="A3.E19.m1.2c">\displaystyle\text{therefore},~{}~{}\mathbf{\hat{H}}_{2}</annotation><annotation encoding="application/x-llamapun" id="A3.E19.m1.2d">therefore , over^ start_ARG bold_H end_ARG start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\underbrace{\mathbf{A}_{2}\mathbf{A}_{1}\mathbf{B}_{0}(\mathbf{F%
}_{0})+\mathbf{B}_{1}(\mathbf{F}_{1})}_{\text{History}}+\underbrace{\mathbf{B}%
_{2}(\mathbf{F}_{2})}_{\text{Input}}." class="ltx_Math" display="inline" id="A3.E19.m2.4"><semantics id="A3.E19.m2.4a"><mrow id="A3.E19.m2.4.4.1" xref="A3.E19.m2.4.4.1.1.cmml"><mrow id="A3.E19.m2.4.4.1.1" xref="A3.E19.m2.4.4.1.1.cmml"><mi id="A3.E19.m2.4.4.1.1.2" xref="A3.E19.m2.4.4.1.1.2.cmml"></mi><mo id="A3.E19.m2.4.4.1.1.1" xref="A3.E19.m2.4.4.1.1.1.cmml">=</mo><mrow id="A3.E19.m2.4.4.1.1.3" xref="A3.E19.m2.4.4.1.1.3.cmml"><munder id="A3.E19.m2.4.4.1.1.3.2" xref="A3.E19.m2.4.4.1.1.3.2.cmml"><munder accentunder="true" id="A3.E19.m2.2.2" xref="A3.E19.m2.2.2.cmml"><mrow id="A3.E19.m2.2.2.2" xref="A3.E19.m2.2.2.2.cmml"><mrow id="A3.E19.m2.1.1.1.1" xref="A3.E19.m2.1.1.1.1.cmml"><msub id="A3.E19.m2.1.1.1.1.3" xref="A3.E19.m2.1.1.1.1.3.cmml"><mi id="A3.E19.m2.1.1.1.1.3.2" xref="A3.E19.m2.1.1.1.1.3.2.cmml">𝐀</mi><mn id="A3.E19.m2.1.1.1.1.3.3" xref="A3.E19.m2.1.1.1.1.3.3.cmml">2</mn></msub><mo id="A3.E19.m2.1.1.1.1.2" xref="A3.E19.m2.1.1.1.1.2.cmml">⁢</mo><msub id="A3.E19.m2.1.1.1.1.4" xref="A3.E19.m2.1.1.1.1.4.cmml"><mi id="A3.E19.m2.1.1.1.1.4.2" xref="A3.E19.m2.1.1.1.1.4.2.cmml">𝐀</mi><mn id="A3.E19.m2.1.1.1.1.4.3" xref="A3.E19.m2.1.1.1.1.4.3.cmml">1</mn></msub><mo id="A3.E19.m2.1.1.1.1.2a" xref="A3.E19.m2.1.1.1.1.2.cmml">⁢</mo><msub id="A3.E19.m2.1.1.1.1.5" xref="A3.E19.m2.1.1.1.1.5.cmml"><mi id="A3.E19.m2.1.1.1.1.5.2" xref="A3.E19.m2.1.1.1.1.5.2.cmml">𝐁</mi><mn id="A3.E19.m2.1.1.1.1.5.3" xref="A3.E19.m2.1.1.1.1.5.3.cmml">0</mn></msub><mo id="A3.E19.m2.1.1.1.1.2b" xref="A3.E19.m2.1.1.1.1.2.cmml">⁢</mo><mrow id="A3.E19.m2.1.1.1.1.1.1" xref="A3.E19.m2.1.1.1.1.1.1.1.cmml"><mo id="A3.E19.m2.1.1.1.1.1.1.2" stretchy="false" xref="A3.E19.m2.1.1.1.1.1.1.1.cmml">(</mo><msub id="A3.E19.m2.1.1.1.1.1.1.1" xref="A3.E19.m2.1.1.1.1.1.1.1.cmml"><mi id="A3.E19.m2.1.1.1.1.1.1.1.2" xref="A3.E19.m2.1.1.1.1.1.1.1.2.cmml">𝐅</mi><mn id="A3.E19.m2.1.1.1.1.1.1.1.3" xref="A3.E19.m2.1.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="A3.E19.m2.1.1.1.1.1.1.3" stretchy="false" xref="A3.E19.m2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A3.E19.m2.2.2.2.3" xref="A3.E19.m2.2.2.2.3.cmml">+</mo><mrow id="A3.E19.m2.2.2.2.2" xref="A3.E19.m2.2.2.2.2.cmml"><msub id="A3.E19.m2.2.2.2.2.3" xref="A3.E19.m2.2.2.2.2.3.cmml"><mi id="A3.E19.m2.2.2.2.2.3.2" xref="A3.E19.m2.2.2.2.2.3.2.cmml">𝐁</mi><mn id="A3.E19.m2.2.2.2.2.3.3" xref="A3.E19.m2.2.2.2.2.3.3.cmml">1</mn></msub><mo id="A3.E19.m2.2.2.2.2.2" xref="A3.E19.m2.2.2.2.2.2.cmml">⁢</mo><mrow id="A3.E19.m2.2.2.2.2.1.1" xref="A3.E19.m2.2.2.2.2.1.1.1.cmml"><mo id="A3.E19.m2.2.2.2.2.1.1.2" stretchy="false" xref="A3.E19.m2.2.2.2.2.1.1.1.cmml">(</mo><msub id="A3.E19.m2.2.2.2.2.1.1.1" xref="A3.E19.m2.2.2.2.2.1.1.1.cmml"><mi id="A3.E19.m2.2.2.2.2.1.1.1.2" xref="A3.E19.m2.2.2.2.2.1.1.1.2.cmml">𝐅</mi><mn id="A3.E19.m2.2.2.2.2.1.1.1.3" xref="A3.E19.m2.2.2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="A3.E19.m2.2.2.2.2.1.1.3" stretchy="false" xref="A3.E19.m2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A3.E19.m2.2.2.3" xref="A3.E19.m2.2.2.3.cmml">⏟</mo></munder><mtext id="A3.E19.m2.4.4.1.1.3.2.2" xref="A3.E19.m2.4.4.1.1.3.2.2a.cmml">History</mtext></munder><mo id="A3.E19.m2.4.4.1.1.3.1" xref="A3.E19.m2.4.4.1.1.3.1.cmml">+</mo><munder id="A3.E19.m2.4.4.1.1.3.3" xref="A3.E19.m2.4.4.1.1.3.3.cmml"><munder accentunder="true" id="A3.E19.m2.3.3" xref="A3.E19.m2.3.3.cmml"><mrow id="A3.E19.m2.3.3.1" xref="A3.E19.m2.3.3.1.cmml"><msub id="A3.E19.m2.3.3.1.3" xref="A3.E19.m2.3.3.1.3.cmml"><mi id="A3.E19.m2.3.3.1.3.2" xref="A3.E19.m2.3.3.1.3.2.cmml">𝐁</mi><mn id="A3.E19.m2.3.3.1.3.3" xref="A3.E19.m2.3.3.1.3.3.cmml">2</mn></msub><mo id="A3.E19.m2.3.3.1.2" xref="A3.E19.m2.3.3.1.2.cmml">⁢</mo><mrow id="A3.E19.m2.3.3.1.1.1" xref="A3.E19.m2.3.3.1.1.1.1.cmml"><mo id="A3.E19.m2.3.3.1.1.1.2" stretchy="false" xref="A3.E19.m2.3.3.1.1.1.1.cmml">(</mo><msub id="A3.E19.m2.3.3.1.1.1.1" xref="A3.E19.m2.3.3.1.1.1.1.cmml"><mi id="A3.E19.m2.3.3.1.1.1.1.2" xref="A3.E19.m2.3.3.1.1.1.1.2.cmml">𝐅</mi><mn id="A3.E19.m2.3.3.1.1.1.1.3" xref="A3.E19.m2.3.3.1.1.1.1.3.cmml">2</mn></msub><mo id="A3.E19.m2.3.3.1.1.1.3" stretchy="false" xref="A3.E19.m2.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A3.E19.m2.3.3.2" xref="A3.E19.m2.3.3.2.cmml">⏟</mo></munder><mtext id="A3.E19.m2.4.4.1.1.3.3.2" xref="A3.E19.m2.4.4.1.1.3.3.2a.cmml">Input</mtext></munder></mrow></mrow><mo id="A3.E19.m2.4.4.1.2" lspace="0em" xref="A3.E19.m2.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E19.m2.4b"><apply id="A3.E19.m2.4.4.1.1.cmml" xref="A3.E19.m2.4.4.1"><eq id="A3.E19.m2.4.4.1.1.1.cmml" xref="A3.E19.m2.4.4.1.1.1"></eq><csymbol cd="latexml" id="A3.E19.m2.4.4.1.1.2.cmml" xref="A3.E19.m2.4.4.1.1.2">absent</csymbol><apply id="A3.E19.m2.4.4.1.1.3.cmml" xref="A3.E19.m2.4.4.1.1.3"><plus id="A3.E19.m2.4.4.1.1.3.1.cmml" xref="A3.E19.m2.4.4.1.1.3.1"></plus><apply id="A3.E19.m2.4.4.1.1.3.2.cmml" xref="A3.E19.m2.4.4.1.1.3.2"><csymbol cd="ambiguous" id="A3.E19.m2.4.4.1.1.3.2.1.cmml" xref="A3.E19.m2.4.4.1.1.3.2">subscript</csymbol><apply id="A3.E19.m2.2.2.cmml" xref="A3.E19.m2.2.2"><ci id="A3.E19.m2.2.2.3.cmml" xref="A3.E19.m2.2.2.3">⏟</ci><apply id="A3.E19.m2.2.2.2.cmml" xref="A3.E19.m2.2.2.2"><plus id="A3.E19.m2.2.2.2.3.cmml" xref="A3.E19.m2.2.2.2.3"></plus><apply id="A3.E19.m2.1.1.1.1.cmml" xref="A3.E19.m2.1.1.1.1"><times id="A3.E19.m2.1.1.1.1.2.cmml" xref="A3.E19.m2.1.1.1.1.2"></times><apply id="A3.E19.m2.1.1.1.1.3.cmml" xref="A3.E19.m2.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E19.m2.1.1.1.1.3.1.cmml" xref="A3.E19.m2.1.1.1.1.3">subscript</csymbol><ci id="A3.E19.m2.1.1.1.1.3.2.cmml" xref="A3.E19.m2.1.1.1.1.3.2">𝐀</ci><cn id="A3.E19.m2.1.1.1.1.3.3.cmml" type="integer" xref="A3.E19.m2.1.1.1.1.3.3">2</cn></apply><apply id="A3.E19.m2.1.1.1.1.4.cmml" xref="A3.E19.m2.1.1.1.1.4"><csymbol cd="ambiguous" id="A3.E19.m2.1.1.1.1.4.1.cmml" xref="A3.E19.m2.1.1.1.1.4">subscript</csymbol><ci id="A3.E19.m2.1.1.1.1.4.2.cmml" xref="A3.E19.m2.1.1.1.1.4.2">𝐀</ci><cn id="A3.E19.m2.1.1.1.1.4.3.cmml" type="integer" xref="A3.E19.m2.1.1.1.1.4.3">1</cn></apply><apply id="A3.E19.m2.1.1.1.1.5.cmml" xref="A3.E19.m2.1.1.1.1.5"><csymbol cd="ambiguous" id="A3.E19.m2.1.1.1.1.5.1.cmml" xref="A3.E19.m2.1.1.1.1.5">subscript</csymbol><ci id="A3.E19.m2.1.1.1.1.5.2.cmml" xref="A3.E19.m2.1.1.1.1.5.2">𝐁</ci><cn id="A3.E19.m2.1.1.1.1.5.3.cmml" type="integer" xref="A3.E19.m2.1.1.1.1.5.3">0</cn></apply><apply id="A3.E19.m2.1.1.1.1.1.1.1.cmml" xref="A3.E19.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E19.m2.1.1.1.1.1.1.1.1.cmml" xref="A3.E19.m2.1.1.1.1.1.1">subscript</csymbol><ci id="A3.E19.m2.1.1.1.1.1.1.1.2.cmml" xref="A3.E19.m2.1.1.1.1.1.1.1.2">𝐅</ci><cn id="A3.E19.m2.1.1.1.1.1.1.1.3.cmml" type="integer" xref="A3.E19.m2.1.1.1.1.1.1.1.3">0</cn></apply></apply><apply id="A3.E19.m2.2.2.2.2.cmml" xref="A3.E19.m2.2.2.2.2"><times id="A3.E19.m2.2.2.2.2.2.cmml" xref="A3.E19.m2.2.2.2.2.2"></times><apply id="A3.E19.m2.2.2.2.2.3.cmml" xref="A3.E19.m2.2.2.2.2.3"><csymbol cd="ambiguous" id="A3.E19.m2.2.2.2.2.3.1.cmml" xref="A3.E19.m2.2.2.2.2.3">subscript</csymbol><ci id="A3.E19.m2.2.2.2.2.3.2.cmml" xref="A3.E19.m2.2.2.2.2.3.2">𝐁</ci><cn id="A3.E19.m2.2.2.2.2.3.3.cmml" type="integer" xref="A3.E19.m2.2.2.2.2.3.3">1</cn></apply><apply id="A3.E19.m2.2.2.2.2.1.1.1.cmml" xref="A3.E19.m2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="A3.E19.m2.2.2.2.2.1.1.1.1.cmml" xref="A3.E19.m2.2.2.2.2.1.1">subscript</csymbol><ci id="A3.E19.m2.2.2.2.2.1.1.1.2.cmml" xref="A3.E19.m2.2.2.2.2.1.1.1.2">𝐅</ci><cn id="A3.E19.m2.2.2.2.2.1.1.1.3.cmml" type="integer" xref="A3.E19.m2.2.2.2.2.1.1.1.3">1</cn></apply></apply></apply></apply><ci id="A3.E19.m2.4.4.1.1.3.2.2a.cmml" xref="A3.E19.m2.4.4.1.1.3.2.2"><mtext id="A3.E19.m2.4.4.1.1.3.2.2.cmml" mathsize="70%" xref="A3.E19.m2.4.4.1.1.3.2.2">History</mtext></ci></apply><apply id="A3.E19.m2.4.4.1.1.3.3.cmml" xref="A3.E19.m2.4.4.1.1.3.3"><csymbol cd="ambiguous" id="A3.E19.m2.4.4.1.1.3.3.1.cmml" xref="A3.E19.m2.4.4.1.1.3.3">subscript</csymbol><apply id="A3.E19.m2.3.3.cmml" xref="A3.E19.m2.3.3"><ci id="A3.E19.m2.3.3.2.cmml" xref="A3.E19.m2.3.3.2">⏟</ci><apply id="A3.E19.m2.3.3.1.cmml" xref="A3.E19.m2.3.3.1"><times id="A3.E19.m2.3.3.1.2.cmml" xref="A3.E19.m2.3.3.1.2"></times><apply id="A3.E19.m2.3.3.1.3.cmml" xref="A3.E19.m2.3.3.1.3"><csymbol cd="ambiguous" id="A3.E19.m2.3.3.1.3.1.cmml" xref="A3.E19.m2.3.3.1.3">subscript</csymbol><ci id="A3.E19.m2.3.3.1.3.2.cmml" xref="A3.E19.m2.3.3.1.3.2">𝐁</ci><cn id="A3.E19.m2.3.3.1.3.3.cmml" type="integer" xref="A3.E19.m2.3.3.1.3.3">2</cn></apply><apply id="A3.E19.m2.3.3.1.1.1.1.cmml" xref="A3.E19.m2.3.3.1.1.1"><csymbol cd="ambiguous" id="A3.E19.m2.3.3.1.1.1.1.1.cmml" xref="A3.E19.m2.3.3.1.1.1">subscript</csymbol><ci id="A3.E19.m2.3.3.1.1.1.1.2.cmml" xref="A3.E19.m2.3.3.1.1.1.1.2">𝐅</ci><cn id="A3.E19.m2.3.3.1.1.1.1.3.cmml" type="integer" xref="A3.E19.m2.3.3.1.1.1.1.3">2</cn></apply></apply></apply><ci id="A3.E19.m2.4.4.1.1.3.3.2a.cmml" xref="A3.E19.m2.4.4.1.1.3.3.2"><mtext id="A3.E19.m2.4.4.1.1.3.3.2.cmml" mathsize="70%" xref="A3.E19.m2.4.4.1.1.3.3.2">Input</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E19.m2.4c">\displaystyle=\underbrace{\mathbf{A}_{2}\mathbf{A}_{1}\mathbf{B}_{0}(\mathbf{F%
}_{0})+\mathbf{B}_{1}(\mathbf{F}_{1})}_{\text{History}}+\underbrace{\mathbf{B}%
_{2}(\mathbf{F}_{2})}_{\text{Input}}.</annotation><annotation encoding="application/x-llamapun" id="A3.E19.m2.4d">= under⏟ start_ARG bold_A start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT bold_A start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT bold_B start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( bold_F start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) + bold_B start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( bold_F start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) end_ARG start_POSTSUBSCRIPT History end_POSTSUBSCRIPT + under⏟ start_ARG bold_B start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( bold_F start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) end_ARG start_POSTSUBSCRIPT Input end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(19)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A3.1.p1.20">Notice, how in <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A3.E19" title="In Proof 1. ‣ Appendix C Relationship to State Space Models ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">eq.</span> <span class="ltx_text ltx_ref_tag">19</span></a> <math alttext="\mathbf{\hat{H}}_{2}" class="ltx_Math" display="inline" id="A3.1.p1.16.m1.1"><semantics id="A3.1.p1.16.m1.1a"><msub id="A3.1.p1.16.m1.1.1" xref="A3.1.p1.16.m1.1.1.cmml"><mover accent="true" id="A3.1.p1.16.m1.1.1.2" xref="A3.1.p1.16.m1.1.1.2.cmml"><mi id="A3.1.p1.16.m1.1.1.2.2" xref="A3.1.p1.16.m1.1.1.2.2.cmml">𝐇</mi><mo id="A3.1.p1.16.m1.1.1.2.1" xref="A3.1.p1.16.m1.1.1.2.1.cmml">^</mo></mover><mn id="A3.1.p1.16.m1.1.1.3" xref="A3.1.p1.16.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A3.1.p1.16.m1.1b"><apply id="A3.1.p1.16.m1.1.1.cmml" xref="A3.1.p1.16.m1.1.1"><csymbol cd="ambiguous" id="A3.1.p1.16.m1.1.1.1.cmml" xref="A3.1.p1.16.m1.1.1">subscript</csymbol><apply id="A3.1.p1.16.m1.1.1.2.cmml" xref="A3.1.p1.16.m1.1.1.2"><ci id="A3.1.p1.16.m1.1.1.2.1.cmml" xref="A3.1.p1.16.m1.1.1.2.1">^</ci><ci id="A3.1.p1.16.m1.1.1.2.2.cmml" xref="A3.1.p1.16.m1.1.1.2.2">𝐇</ci></apply><cn id="A3.1.p1.16.m1.1.1.3.cmml" type="integer" xref="A3.1.p1.16.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.1.p1.16.m1.1c">\mathbf{\hat{H}}_{2}</annotation><annotation encoding="application/x-llamapun" id="A3.1.p1.16.m1.1d">over^ start_ARG bold_H end_ARG start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> is written in terms of the input frame <math alttext="\mathbf{F}_{2}" class="ltx_Math" display="inline" id="A3.1.p1.17.m2.1"><semantics id="A3.1.p1.17.m2.1a"><msub id="A3.1.p1.17.m2.1.1" xref="A3.1.p1.17.m2.1.1.cmml"><mi id="A3.1.p1.17.m2.1.1.2" xref="A3.1.p1.17.m2.1.1.2.cmml">𝐅</mi><mn id="A3.1.p1.17.m2.1.1.3" xref="A3.1.p1.17.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A3.1.p1.17.m2.1b"><apply id="A3.1.p1.17.m2.1.1.cmml" xref="A3.1.p1.17.m2.1.1"><csymbol cd="ambiguous" id="A3.1.p1.17.m2.1.1.1.cmml" xref="A3.1.p1.17.m2.1.1">subscript</csymbol><ci id="A3.1.p1.17.m2.1.1.2.cmml" xref="A3.1.p1.17.m2.1.1.2">𝐅</ci><cn id="A3.1.p1.17.m2.1.1.3.cmml" type="integer" xref="A3.1.p1.17.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.1.p1.17.m2.1c">\mathbf{F}_{2}</annotation><annotation encoding="application/x-llamapun" id="A3.1.p1.17.m2.1d">bold_F start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, and the previous frames <math alttext="\mathbf{F}_{0}" class="ltx_Math" display="inline" id="A3.1.p1.18.m3.1"><semantics id="A3.1.p1.18.m3.1a"><msub id="A3.1.p1.18.m3.1.1" xref="A3.1.p1.18.m3.1.1.cmml"><mi id="A3.1.p1.18.m3.1.1.2" xref="A3.1.p1.18.m3.1.1.2.cmml">𝐅</mi><mn id="A3.1.p1.18.m3.1.1.3" xref="A3.1.p1.18.m3.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="A3.1.p1.18.m3.1b"><apply id="A3.1.p1.18.m3.1.1.cmml" xref="A3.1.p1.18.m3.1.1"><csymbol cd="ambiguous" id="A3.1.p1.18.m3.1.1.1.cmml" xref="A3.1.p1.18.m3.1.1">subscript</csymbol><ci id="A3.1.p1.18.m3.1.1.2.cmml" xref="A3.1.p1.18.m3.1.1.2">𝐅</ci><cn id="A3.1.p1.18.m3.1.1.3.cmml" type="integer" xref="A3.1.p1.18.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.1.p1.18.m3.1c">\mathbf{F}_{0}</annotation><annotation encoding="application/x-llamapun" id="A3.1.p1.18.m3.1d">bold_F start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\mathbf{F}_{1}" class="ltx_Math" display="inline" id="A3.1.p1.19.m4.1"><semantics id="A3.1.p1.19.m4.1a"><msub id="A3.1.p1.19.m4.1.1" xref="A3.1.p1.19.m4.1.1.cmml"><mi id="A3.1.p1.19.m4.1.1.2" xref="A3.1.p1.19.m4.1.1.2.cmml">𝐅</mi><mn id="A3.1.p1.19.m4.1.1.3" xref="A3.1.p1.19.m4.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A3.1.p1.19.m4.1b"><apply id="A3.1.p1.19.m4.1.1.cmml" xref="A3.1.p1.19.m4.1.1"><csymbol cd="ambiguous" id="A3.1.p1.19.m4.1.1.1.cmml" xref="A3.1.p1.19.m4.1.1">subscript</csymbol><ci id="A3.1.p1.19.m4.1.1.2.cmml" xref="A3.1.p1.19.m4.1.1.2">𝐅</ci><cn id="A3.1.p1.19.m4.1.1.3.cmml" type="integer" xref="A3.1.p1.19.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.1.p1.19.m4.1c">\mathbf{F}_{1}</annotation><annotation encoding="application/x-llamapun" id="A3.1.p1.19.m4.1d">bold_F start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>. The output <math alttext="\mathbf{y}_{2}" class="ltx_Math" display="inline" id="A3.1.p1.20.m5.1"><semantics id="A3.1.p1.20.m5.1a"><msub id="A3.1.p1.20.m5.1.1" xref="A3.1.p1.20.m5.1.1.cmml"><mi id="A3.1.p1.20.m5.1.1.2" xref="A3.1.p1.20.m5.1.1.2.cmml">𝐲</mi><mn id="A3.1.p1.20.m5.1.1.3" xref="A3.1.p1.20.m5.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A3.1.p1.20.m5.1b"><apply id="A3.1.p1.20.m5.1.1.cmml" xref="A3.1.p1.20.m5.1.1"><csymbol cd="ambiguous" id="A3.1.p1.20.m5.1.1.1.cmml" xref="A3.1.p1.20.m5.1.1">subscript</csymbol><ci id="A3.1.p1.20.m5.1.1.2.cmml" xref="A3.1.p1.20.m5.1.1.2">𝐲</ci><cn id="A3.1.p1.20.m5.1.1.3.cmml" type="integer" xref="A3.1.p1.20.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.1.p1.20.m5.1c">\mathbf{y}_{2}</annotation><annotation encoding="application/x-llamapun" id="A3.1.p1.20.m5.1d">bold_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> is then computed as,</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A7.EGx13">
<tbody id="A3.E20"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{y}_{2}" class="ltx_Math" display="inline" id="A3.E20.m1.1"><semantics id="A3.E20.m1.1a"><msub id="A3.E20.m1.1.1" xref="A3.E20.m1.1.1.cmml"><mi id="A3.E20.m1.1.1.2" xref="A3.E20.m1.1.1.2.cmml">𝐲</mi><mn id="A3.E20.m1.1.1.3" xref="A3.E20.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A3.E20.m1.1b"><apply id="A3.E20.m1.1.1.cmml" xref="A3.E20.m1.1.1"><csymbol cd="ambiguous" id="A3.E20.m1.1.1.1.cmml" xref="A3.E20.m1.1.1">subscript</csymbol><ci id="A3.E20.m1.1.1.2.cmml" xref="A3.E20.m1.1.1.2">𝐲</ci><cn id="A3.E20.m1.1.1.3.cmml" type="integer" xref="A3.E20.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E20.m1.1c">\displaystyle\mathbf{y}_{2}</annotation><annotation encoding="application/x-llamapun" id="A3.E20.m1.1d">bold_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbf{C}_{2}(\mathbf{\hat{H}}_{2})." class="ltx_Math" display="inline" id="A3.E20.m2.1"><semantics id="A3.E20.m2.1a"><mrow id="A3.E20.m2.1.1.1" xref="A3.E20.m2.1.1.1.1.cmml"><mrow id="A3.E20.m2.1.1.1.1" xref="A3.E20.m2.1.1.1.1.cmml"><mi id="A3.E20.m2.1.1.1.1.3" xref="A3.E20.m2.1.1.1.1.3.cmml"></mi><mo id="A3.E20.m2.1.1.1.1.2" xref="A3.E20.m2.1.1.1.1.2.cmml">=</mo><mrow id="A3.E20.m2.1.1.1.1.1" xref="A3.E20.m2.1.1.1.1.1.cmml"><msub id="A3.E20.m2.1.1.1.1.1.3" xref="A3.E20.m2.1.1.1.1.1.3.cmml"><mi id="A3.E20.m2.1.1.1.1.1.3.2" xref="A3.E20.m2.1.1.1.1.1.3.2.cmml">𝐂</mi><mn id="A3.E20.m2.1.1.1.1.1.3.3" xref="A3.E20.m2.1.1.1.1.1.3.3.cmml">2</mn></msub><mo id="A3.E20.m2.1.1.1.1.1.2" xref="A3.E20.m2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A3.E20.m2.1.1.1.1.1.1.1" xref="A3.E20.m2.1.1.1.1.1.1.1.1.cmml"><mo id="A3.E20.m2.1.1.1.1.1.1.1.2" stretchy="false" xref="A3.E20.m2.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A3.E20.m2.1.1.1.1.1.1.1.1" xref="A3.E20.m2.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="A3.E20.m2.1.1.1.1.1.1.1.1.2" xref="A3.E20.m2.1.1.1.1.1.1.1.1.2.cmml"><mi id="A3.E20.m2.1.1.1.1.1.1.1.1.2.2" xref="A3.E20.m2.1.1.1.1.1.1.1.1.2.2.cmml">𝐇</mi><mo id="A3.E20.m2.1.1.1.1.1.1.1.1.2.1" xref="A3.E20.m2.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mn id="A3.E20.m2.1.1.1.1.1.1.1.1.3" xref="A3.E20.m2.1.1.1.1.1.1.1.1.3.cmml">2</mn></msub><mo id="A3.E20.m2.1.1.1.1.1.1.1.3" stretchy="false" xref="A3.E20.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A3.E20.m2.1.1.1.2" lspace="0em" xref="A3.E20.m2.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E20.m2.1b"><apply id="A3.E20.m2.1.1.1.1.cmml" xref="A3.E20.m2.1.1.1"><eq id="A3.E20.m2.1.1.1.1.2.cmml" xref="A3.E20.m2.1.1.1.1.2"></eq><csymbol cd="latexml" id="A3.E20.m2.1.1.1.1.3.cmml" xref="A3.E20.m2.1.1.1.1.3">absent</csymbol><apply id="A3.E20.m2.1.1.1.1.1.cmml" xref="A3.E20.m2.1.1.1.1.1"><times id="A3.E20.m2.1.1.1.1.1.2.cmml" xref="A3.E20.m2.1.1.1.1.1.2"></times><apply id="A3.E20.m2.1.1.1.1.1.3.cmml" xref="A3.E20.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E20.m2.1.1.1.1.1.3.1.cmml" xref="A3.E20.m2.1.1.1.1.1.3">subscript</csymbol><ci id="A3.E20.m2.1.1.1.1.1.3.2.cmml" xref="A3.E20.m2.1.1.1.1.1.3.2">𝐂</ci><cn id="A3.E20.m2.1.1.1.1.1.3.3.cmml" type="integer" xref="A3.E20.m2.1.1.1.1.1.3.3">2</cn></apply><apply id="A3.E20.m2.1.1.1.1.1.1.1.1.cmml" xref="A3.E20.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E20.m2.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E20.m2.1.1.1.1.1.1.1">subscript</csymbol><apply id="A3.E20.m2.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E20.m2.1.1.1.1.1.1.1.1.2"><ci id="A3.E20.m2.1.1.1.1.1.1.1.1.2.1.cmml" xref="A3.E20.m2.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="A3.E20.m2.1.1.1.1.1.1.1.1.2.2.cmml" xref="A3.E20.m2.1.1.1.1.1.1.1.1.2.2">𝐇</ci></apply><cn id="A3.E20.m2.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="A3.E20.m2.1.1.1.1.1.1.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E20.m2.1c">\displaystyle=\mathbf{C}_{2}(\mathbf{\hat{H}}_{2}).</annotation><annotation encoding="application/x-llamapun" id="A3.E20.m2.1d">= bold_C start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( over^ start_ARG bold_H end_ARG start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(20)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A3.2.p2">
<p class="ltx_p" id="A3.2.p2.1">We can then generalize <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A3.E18" title="In Proof 1. ‣ Appendix C Relationship to State Space Models ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">eq.</span> <span class="ltx_text ltx_ref_tag">18</span></a>, and <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A3.E20" title="In Proof 1. ‣ Appendix C Relationship to State Space Models ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">eq.</span> <span class="ltx_text ltx_ref_tag">20</span></a> to any timestep <math alttext="t" class="ltx_Math" display="inline" id="A3.2.p2.1.m1.1"><semantics id="A3.2.p2.1.m1.1a"><mi id="A3.2.p2.1.m1.1.1" xref="A3.2.p2.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A3.2.p2.1.m1.1b"><ci id="A3.2.p2.1.m1.1.1.cmml" xref="A3.2.p2.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.2.p2.1.m1.1c">t</annotation><annotation encoding="application/x-llamapun" id="A3.2.p2.1.m1.1d">italic_t</annotation></semantics></math>, and we arrive at <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A3.E8" title="In Lemma C.1. ‣ Appendix C Relationship to State Space Models ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">eq.</span> <span class="ltx_text ltx_ref_tag">8</span></a>, and <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A3.E9" title="In Lemma C.1. ‣ Appendix C Relationship to State Space Models ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">eq.</span> <span class="ltx_text ltx_ref_tag">9</span></a>, i.e.,</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A7.EGx14">
<tbody id="A3.E21"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{\hat{H}}_{t}" class="ltx_Math" display="inline" id="A3.E21.m1.1"><semantics id="A3.E21.m1.1a"><msub id="A3.E21.m1.1.1" xref="A3.E21.m1.1.1.cmml"><mover accent="true" id="A3.E21.m1.1.1.2" xref="A3.E21.m1.1.1.2.cmml"><mi id="A3.E21.m1.1.1.2.2" xref="A3.E21.m1.1.1.2.2.cmml">𝐇</mi><mo id="A3.E21.m1.1.1.2.1" xref="A3.E21.m1.1.1.2.1.cmml">^</mo></mover><mi id="A3.E21.m1.1.1.3" xref="A3.E21.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A3.E21.m1.1b"><apply id="A3.E21.m1.1.1.cmml" xref="A3.E21.m1.1.1"><csymbol cd="ambiguous" id="A3.E21.m1.1.1.1.cmml" xref="A3.E21.m1.1.1">subscript</csymbol><apply id="A3.E21.m1.1.1.2.cmml" xref="A3.E21.m1.1.1.2"><ci id="A3.E21.m1.1.1.2.1.cmml" xref="A3.E21.m1.1.1.2.1">^</ci><ci id="A3.E21.m1.1.1.2.2.cmml" xref="A3.E21.m1.1.1.2.2">𝐇</ci></apply><ci id="A3.E21.m1.1.1.3.cmml" xref="A3.E21.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E21.m1.1c">\displaystyle\mathbf{\hat{H}}_{t}</annotation><annotation encoding="application/x-llamapun" id="A3.E21.m1.1d">over^ start_ARG bold_H end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbf{A}_{t}(\mathbf{\hat{H}}_{t-1})+\mathbf{B}_{t}(\mathbf{F}%
_{t})," class="ltx_Math" display="inline" id="A3.E21.m2.1"><semantics id="A3.E21.m2.1a"><mrow id="A3.E21.m2.1.1.1" xref="A3.E21.m2.1.1.1.1.cmml"><mrow id="A3.E21.m2.1.1.1.1" xref="A3.E21.m2.1.1.1.1.cmml"><mi id="A3.E21.m2.1.1.1.1.4" xref="A3.E21.m2.1.1.1.1.4.cmml"></mi><mo id="A3.E21.m2.1.1.1.1.3" xref="A3.E21.m2.1.1.1.1.3.cmml">=</mo><mrow id="A3.E21.m2.1.1.1.1.2" xref="A3.E21.m2.1.1.1.1.2.cmml"><mrow id="A3.E21.m2.1.1.1.1.1.1" xref="A3.E21.m2.1.1.1.1.1.1.cmml"><msub id="A3.E21.m2.1.1.1.1.1.1.3" xref="A3.E21.m2.1.1.1.1.1.1.3.cmml"><mi id="A3.E21.m2.1.1.1.1.1.1.3.2" xref="A3.E21.m2.1.1.1.1.1.1.3.2.cmml">𝐀</mi><mi id="A3.E21.m2.1.1.1.1.1.1.3.3" xref="A3.E21.m2.1.1.1.1.1.1.3.3.cmml">t</mi></msub><mo id="A3.E21.m2.1.1.1.1.1.1.2" xref="A3.E21.m2.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A3.E21.m2.1.1.1.1.1.1.1.1" xref="A3.E21.m2.1.1.1.1.1.1.1.1.1.cmml"><mo id="A3.E21.m2.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A3.E21.m2.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A3.E21.m2.1.1.1.1.1.1.1.1.1" xref="A3.E21.m2.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="A3.E21.m2.1.1.1.1.1.1.1.1.1.2" xref="A3.E21.m2.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A3.E21.m2.1.1.1.1.1.1.1.1.1.2.2" xref="A3.E21.m2.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐇</mi><mo id="A3.E21.m2.1.1.1.1.1.1.1.1.1.2.1" xref="A3.E21.m2.1.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mrow id="A3.E21.m2.1.1.1.1.1.1.1.1.1.3" xref="A3.E21.m2.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A3.E21.m2.1.1.1.1.1.1.1.1.1.3.2" xref="A3.E21.m2.1.1.1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="A3.E21.m2.1.1.1.1.1.1.1.1.1.3.1" xref="A3.E21.m2.1.1.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="A3.E21.m2.1.1.1.1.1.1.1.1.1.3.3" xref="A3.E21.m2.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="A3.E21.m2.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A3.E21.m2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A3.E21.m2.1.1.1.1.2.3" xref="A3.E21.m2.1.1.1.1.2.3.cmml">+</mo><mrow id="A3.E21.m2.1.1.1.1.2.2" xref="A3.E21.m2.1.1.1.1.2.2.cmml"><msub id="A3.E21.m2.1.1.1.1.2.2.3" xref="A3.E21.m2.1.1.1.1.2.2.3.cmml"><mi id="A3.E21.m2.1.1.1.1.2.2.3.2" xref="A3.E21.m2.1.1.1.1.2.2.3.2.cmml">𝐁</mi><mi id="A3.E21.m2.1.1.1.1.2.2.3.3" xref="A3.E21.m2.1.1.1.1.2.2.3.3.cmml">t</mi></msub><mo id="A3.E21.m2.1.1.1.1.2.2.2" xref="A3.E21.m2.1.1.1.1.2.2.2.cmml">⁢</mo><mrow id="A3.E21.m2.1.1.1.1.2.2.1.1" xref="A3.E21.m2.1.1.1.1.2.2.1.1.1.cmml"><mo id="A3.E21.m2.1.1.1.1.2.2.1.1.2" stretchy="false" xref="A3.E21.m2.1.1.1.1.2.2.1.1.1.cmml">(</mo><msub id="A3.E21.m2.1.1.1.1.2.2.1.1.1" xref="A3.E21.m2.1.1.1.1.2.2.1.1.1.cmml"><mi id="A3.E21.m2.1.1.1.1.2.2.1.1.1.2" xref="A3.E21.m2.1.1.1.1.2.2.1.1.1.2.cmml">𝐅</mi><mi id="A3.E21.m2.1.1.1.1.2.2.1.1.1.3" xref="A3.E21.m2.1.1.1.1.2.2.1.1.1.3.cmml">t</mi></msub><mo id="A3.E21.m2.1.1.1.1.2.2.1.1.3" stretchy="false" xref="A3.E21.m2.1.1.1.1.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A3.E21.m2.1.1.1.2" xref="A3.E21.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E21.m2.1b"><apply id="A3.E21.m2.1.1.1.1.cmml" xref="A3.E21.m2.1.1.1"><eq id="A3.E21.m2.1.1.1.1.3.cmml" xref="A3.E21.m2.1.1.1.1.3"></eq><csymbol cd="latexml" id="A3.E21.m2.1.1.1.1.4.cmml" xref="A3.E21.m2.1.1.1.1.4">absent</csymbol><apply id="A3.E21.m2.1.1.1.1.2.cmml" xref="A3.E21.m2.1.1.1.1.2"><plus id="A3.E21.m2.1.1.1.1.2.3.cmml" xref="A3.E21.m2.1.1.1.1.2.3"></plus><apply id="A3.E21.m2.1.1.1.1.1.1.cmml" xref="A3.E21.m2.1.1.1.1.1.1"><times id="A3.E21.m2.1.1.1.1.1.1.2.cmml" xref="A3.E21.m2.1.1.1.1.1.1.2"></times><apply id="A3.E21.m2.1.1.1.1.1.1.3.cmml" xref="A3.E21.m2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E21.m2.1.1.1.1.1.1.3.1.cmml" xref="A3.E21.m2.1.1.1.1.1.1.3">subscript</csymbol><ci id="A3.E21.m2.1.1.1.1.1.1.3.2.cmml" xref="A3.E21.m2.1.1.1.1.1.1.3.2">𝐀</ci><ci id="A3.E21.m2.1.1.1.1.1.1.3.3.cmml" xref="A3.E21.m2.1.1.1.1.1.1.3.3">𝑡</ci></apply><apply id="A3.E21.m2.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E21.m2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E21.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E21.m2.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="A3.E21.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E21.m2.1.1.1.1.1.1.1.1.1.2"><ci id="A3.E21.m2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A3.E21.m2.1.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="A3.E21.m2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A3.E21.m2.1.1.1.1.1.1.1.1.1.2.2">𝐇</ci></apply><apply id="A3.E21.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="A3.E21.m2.1.1.1.1.1.1.1.1.1.3"><minus id="A3.E21.m2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A3.E21.m2.1.1.1.1.1.1.1.1.1.3.1"></minus><ci id="A3.E21.m2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A3.E21.m2.1.1.1.1.1.1.1.1.1.3.2">𝑡</ci><cn id="A3.E21.m2.1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="A3.E21.m2.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply><apply id="A3.E21.m2.1.1.1.1.2.2.cmml" xref="A3.E21.m2.1.1.1.1.2.2"><times id="A3.E21.m2.1.1.1.1.2.2.2.cmml" xref="A3.E21.m2.1.1.1.1.2.2.2"></times><apply id="A3.E21.m2.1.1.1.1.2.2.3.cmml" xref="A3.E21.m2.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="A3.E21.m2.1.1.1.1.2.2.3.1.cmml" xref="A3.E21.m2.1.1.1.1.2.2.3">subscript</csymbol><ci id="A3.E21.m2.1.1.1.1.2.2.3.2.cmml" xref="A3.E21.m2.1.1.1.1.2.2.3.2">𝐁</ci><ci id="A3.E21.m2.1.1.1.1.2.2.3.3.cmml" xref="A3.E21.m2.1.1.1.1.2.2.3.3">𝑡</ci></apply><apply id="A3.E21.m2.1.1.1.1.2.2.1.1.1.cmml" xref="A3.E21.m2.1.1.1.1.2.2.1.1"><csymbol cd="ambiguous" id="A3.E21.m2.1.1.1.1.2.2.1.1.1.1.cmml" xref="A3.E21.m2.1.1.1.1.2.2.1.1">subscript</csymbol><ci id="A3.E21.m2.1.1.1.1.2.2.1.1.1.2.cmml" xref="A3.E21.m2.1.1.1.1.2.2.1.1.1.2">𝐅</ci><ci id="A3.E21.m2.1.1.1.1.2.2.1.1.1.3.cmml" xref="A3.E21.m2.1.1.1.1.2.2.1.1.1.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E21.m2.1c">\displaystyle=\mathbf{A}_{t}(\mathbf{\hat{H}}_{t-1})+\mathbf{B}_{t}(\mathbf{F}%
_{t}),</annotation><annotation encoding="application/x-llamapun" id="A3.E21.m2.1d">= bold_A start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( over^ start_ARG bold_H end_ARG start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT ) + bold_B start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_F start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(21)</span></td>
</tr></tbody>
<tbody id="A3.E22"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{y}_{t}" class="ltx_Math" display="inline" id="A3.E22.m1.1"><semantics id="A3.E22.m1.1a"><msub id="A3.E22.m1.1.1" xref="A3.E22.m1.1.1.cmml"><mi id="A3.E22.m1.1.1.2" xref="A3.E22.m1.1.1.2.cmml">𝐲</mi><mi id="A3.E22.m1.1.1.3" xref="A3.E22.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A3.E22.m1.1b"><apply id="A3.E22.m1.1.1.cmml" xref="A3.E22.m1.1.1"><csymbol cd="ambiguous" id="A3.E22.m1.1.1.1.cmml" xref="A3.E22.m1.1.1">subscript</csymbol><ci id="A3.E22.m1.1.1.2.cmml" xref="A3.E22.m1.1.1.2">𝐲</ci><ci id="A3.E22.m1.1.1.3.cmml" xref="A3.E22.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E22.m1.1c">\displaystyle\mathbf{y}_{t}</annotation><annotation encoding="application/x-llamapun" id="A3.E22.m1.1d">bold_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbf{C}_{t}(\mathbf{\hat{H}}_{t})." class="ltx_Math" display="inline" id="A3.E22.m2.1"><semantics id="A3.E22.m2.1a"><mrow id="A3.E22.m2.1.1.1" xref="A3.E22.m2.1.1.1.1.cmml"><mrow id="A3.E22.m2.1.1.1.1" xref="A3.E22.m2.1.1.1.1.cmml"><mi id="A3.E22.m2.1.1.1.1.3" xref="A3.E22.m2.1.1.1.1.3.cmml"></mi><mo id="A3.E22.m2.1.1.1.1.2" xref="A3.E22.m2.1.1.1.1.2.cmml">=</mo><mrow id="A3.E22.m2.1.1.1.1.1" xref="A3.E22.m2.1.1.1.1.1.cmml"><msub id="A3.E22.m2.1.1.1.1.1.3" xref="A3.E22.m2.1.1.1.1.1.3.cmml"><mi id="A3.E22.m2.1.1.1.1.1.3.2" xref="A3.E22.m2.1.1.1.1.1.3.2.cmml">𝐂</mi><mi id="A3.E22.m2.1.1.1.1.1.3.3" xref="A3.E22.m2.1.1.1.1.1.3.3.cmml">t</mi></msub><mo id="A3.E22.m2.1.1.1.1.1.2" xref="A3.E22.m2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A3.E22.m2.1.1.1.1.1.1.1" xref="A3.E22.m2.1.1.1.1.1.1.1.1.cmml"><mo id="A3.E22.m2.1.1.1.1.1.1.1.2" stretchy="false" xref="A3.E22.m2.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A3.E22.m2.1.1.1.1.1.1.1.1" xref="A3.E22.m2.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="A3.E22.m2.1.1.1.1.1.1.1.1.2" xref="A3.E22.m2.1.1.1.1.1.1.1.1.2.cmml"><mi id="A3.E22.m2.1.1.1.1.1.1.1.1.2.2" xref="A3.E22.m2.1.1.1.1.1.1.1.1.2.2.cmml">𝐇</mi><mo id="A3.E22.m2.1.1.1.1.1.1.1.1.2.1" xref="A3.E22.m2.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="A3.E22.m2.1.1.1.1.1.1.1.1.3" xref="A3.E22.m2.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="A3.E22.m2.1.1.1.1.1.1.1.3" stretchy="false" xref="A3.E22.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A3.E22.m2.1.1.1.2" lspace="0em" xref="A3.E22.m2.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E22.m2.1b"><apply id="A3.E22.m2.1.1.1.1.cmml" xref="A3.E22.m2.1.1.1"><eq id="A3.E22.m2.1.1.1.1.2.cmml" xref="A3.E22.m2.1.1.1.1.2"></eq><csymbol cd="latexml" id="A3.E22.m2.1.1.1.1.3.cmml" xref="A3.E22.m2.1.1.1.1.3">absent</csymbol><apply id="A3.E22.m2.1.1.1.1.1.cmml" xref="A3.E22.m2.1.1.1.1.1"><times id="A3.E22.m2.1.1.1.1.1.2.cmml" xref="A3.E22.m2.1.1.1.1.1.2"></times><apply id="A3.E22.m2.1.1.1.1.1.3.cmml" xref="A3.E22.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E22.m2.1.1.1.1.1.3.1.cmml" xref="A3.E22.m2.1.1.1.1.1.3">subscript</csymbol><ci id="A3.E22.m2.1.1.1.1.1.3.2.cmml" xref="A3.E22.m2.1.1.1.1.1.3.2">𝐂</ci><ci id="A3.E22.m2.1.1.1.1.1.3.3.cmml" xref="A3.E22.m2.1.1.1.1.1.3.3">𝑡</ci></apply><apply id="A3.E22.m2.1.1.1.1.1.1.1.1.cmml" xref="A3.E22.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E22.m2.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E22.m2.1.1.1.1.1.1.1">subscript</csymbol><apply id="A3.E22.m2.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E22.m2.1.1.1.1.1.1.1.1.2"><ci id="A3.E22.m2.1.1.1.1.1.1.1.1.2.1.cmml" xref="A3.E22.m2.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="A3.E22.m2.1.1.1.1.1.1.1.1.2.2.cmml" xref="A3.E22.m2.1.1.1.1.1.1.1.1.2.2">𝐇</ci></apply><ci id="A3.E22.m2.1.1.1.1.1.1.1.1.3.cmml" xref="A3.E22.m2.1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E22.m2.1c">\displaystyle=\mathbf{C}_{t}(\mathbf{\hat{H}}_{t}).</annotation><annotation encoding="application/x-llamapun" id="A3.E22.m2.1d">= bold_C start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( over^ start_ARG bold_H end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(22)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A3.3.p3">
<p class="ltx_p" id="A3.3.p3.3">Therefore, the model can be learned in Mamba <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib17" title="">17</a>]</cite>, or HiPPO <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib18" title="">18</a>]</cite> style, and the parameters <math alttext="\mathbf{A}" class="ltx_Math" display="inline" id="A3.3.p3.1.m1.1"><semantics id="A3.3.p3.1.m1.1a"><mi id="A3.3.p3.1.m1.1.1" xref="A3.3.p3.1.m1.1.1.cmml">𝐀</mi><annotation-xml encoding="MathML-Content" id="A3.3.p3.1.m1.1b"><ci id="A3.3.p3.1.m1.1.1.cmml" xref="A3.3.p3.1.m1.1.1">𝐀</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.3.p3.1.m1.1c">\mathbf{A}</annotation><annotation encoding="application/x-llamapun" id="A3.3.p3.1.m1.1d">bold_A</annotation></semantics></math>, <math alttext="\mathbf{B}" class="ltx_Math" display="inline" id="A3.3.p3.2.m2.1"><semantics id="A3.3.p3.2.m2.1a"><mi id="A3.3.p3.2.m2.1.1" xref="A3.3.p3.2.m2.1.1.cmml">𝐁</mi><annotation-xml encoding="MathML-Content" id="A3.3.p3.2.m2.1b"><ci id="A3.3.p3.2.m2.1.1.cmml" xref="A3.3.p3.2.m2.1.1">𝐁</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.3.p3.2.m2.1c">\mathbf{B}</annotation><annotation encoding="application/x-llamapun" id="A3.3.p3.2.m2.1d">bold_B</annotation></semantics></math>, <math alttext="\mathbf{C}" class="ltx_Math" display="inline" id="A3.3.p3.3.m3.1"><semantics id="A3.3.p3.3.m3.1a"><mi id="A3.3.p3.3.m3.1.1" xref="A3.3.p3.3.m3.1.1.cmml">𝐂</mi><annotation-xml encoding="MathML-Content" id="A3.3.p3.3.m3.1b"><ci id="A3.3.p3.3.m3.1.1.cmml" xref="A3.3.p3.3.m3.1.1">𝐂</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.3.p3.3.m3.1c">\mathbf{C}</annotation><annotation encoding="application/x-llamapun" id="A3.3.p3.3.m3.1d">bold_C</annotation></semantics></math> can be learned with gradient descent since the linear relationship between the input and the output is tractable in this case.
∎</p>
</div>
</div>
<div class="ltx_para" id="A3.p3">
<p class="ltx_p" id="A3.p3.1">In practice, however, the no degradation assumption does not hold. Therefore, a naive state update, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A3.E8" title="In Lemma C.1. ‣ Appendix C Relationship to State Space Models ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">eq.</span> <span class="ltx_text ltx_ref_tag">8</span></a>, renders sub-optimal results. This is because, in video processing tasks, motion governs the transition dynamics, i.e., the state evolves over time due to motion, and therefore, any linear relationship between the output and the input is intractable unless the motion is compensated for.</p>
</div>
<figure class="ltx_figure" id="A3.F10"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="373" id="A3.F10.g1" src="x10.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span><span class="ltx_text ltx_font_bold" id="A3.F10.6.1">Additional Visual Results on VRDS.</span> We present additional qualitative analysis on video raindrops and rain streaks removal (VRDS) tasks. We compare <span class="ltx_text ltx_font_smallcaps" id="A3.F10.7.2">turtle</span> with ViMPNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib71" title="">71</a>]</cite>, the best method in literature, on three frames taken from the testset. <span class="ltx_text ltx_font_smallcaps" id="A3.F10.8.3">turtle</span>’s results are artifacts-free as it can effectively remove both the streaks and drops. However, ViMPNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib71" title="">71</a>]</cite> tends to mix in the raindrops with the background, introducing smudge (see <span class="ltx_text" id="A3.F10.9.4" style="color:#FF0000;">the building</span>) and blur (see <span class="ltx_text" id="A3.F10.10.5" style="color:#FF0000;">number plate on the car</span>).</figcaption>
</figure>
<figure class="ltx_figure" id="A3.F11"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="246" id="A3.F11.g1" src="x11.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11: </span><span class="ltx_text ltx_font_bold" id="A3.F11.6.1">Additional Visual Results on RSVD.</span> We present additional qualitative analysis on the desnowing task. We compare <span class="ltx_text ltx_font_smallcaps" id="A3.F11.7.2">turtle</span> with SVDNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib10" title="">10</a>]</cite>, the best method in literature, on two frames taken from the testset. <span class="ltx_text ltx_font_smallcaps" id="A3.F11.8.3">turtle</span> removes even smaller snowflakes (<span class="ltx_text" id="A3.F11.9.4" style="color:#FF0000;">flecks of snow on the underside of orange roof</span>) and differentiates between textures and snow (see <span class="ltx_text" id="A3.F11.10.5" style="color:#FF0000;">white spots on sheep</span>).</figcaption>
</figure>
<figure class="ltx_figure" id="A3.F12"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="342" id="A3.F12.g1" src="x12.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 12: </span><span class="ltx_text ltx_font_bold" id="A3.F12.3.1">Additional Visual Results on Nighttime Deraining.</span> We present additional visual results on the nighttime deraining dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib47" title="">47</a>]</cite>. <span class="ltx_text ltx_font_smallcaps" id="A3.F12.4.2">turtle</span> maintains color consistency, is artifact-free, and is more faithful to the ground truth.</figcaption>
</figure>
</section>
<section class="ltx_appendix" id="A4">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Further Visual Comparisons</h2>
<div class="ltx_para" id="A4.p1">
<p class="ltx_p" id="A4.p1.1">We present additional visual results, comparing our method with previously available methods in the video restoration literature.</p>
</div>
<section class="ltx_subsection" id="A4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.1 </span>Synthetic Video Deblurring</h3>
<div class="ltx_para" id="A4.SS1.p1">
<p class="ltx_p" id="A4.SS1.p1.1">We present further results on synthetic video deblurring task on the GoPro dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib41" title="">41</a>]</cite> in <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A1.F9" title="In A.2 Historyless FFN. ‣ Appendix A Turtle’s Specifications &amp; Details ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">9</span></a>. We compare <span class="ltx_text ltx_font_smallcaps" id="A4.SS1.p1.1.1">turtle</span> with the previous method in the literature that is computationally similar to <span class="ltx_text ltx_font_smallcaps" id="A4.SS1.p1.1.2">turtle</span>, DSTNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib45" title="">45</a>]</cite>.
Turtle avoids unnecessary artifacts in the restored results (see <span class="ltx_text" id="A4.SS1.p1.1.3" style="color:#FF0000;">the tire undergoing rotation</span> in the frame in the top row in <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A1.F9" title="In A.2 Historyless FFN. ‣ Appendix A Turtle’s Specifications &amp; Details ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">9</span></a>). Further, the restored results are not smudged, and textures are restored faithfully to the ground truth (see <span class="ltx_text" id="A4.SS1.p1.1.4" style="color:#FF0000;">feet of the person</span> in the frame in the bottom row).</p>
</div>
</section>
<section class="ltx_subsection" id="A4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.2 </span>Video Raindrops and Rain Streaks Removal</h3>
<div class="ltx_para" id="A4.SS2.p1">
<p class="ltx_p" id="A4.SS2.p1.1">Unlike just rain streaks, raindrops often pose a more complex challenge for restoration algorithms. This is because several video/image restoration methods often induce blurriness in the results. Raindrops get mixed in with the background textures; therefore, minute details such as numbers or text are blurred in restored results. However, since <span class="ltx_text ltx_font_smallcaps" id="A4.SS2.p1.1.1">turtle</span> utilizes the neighboring information, it learns to restore these details better. We observe this in <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A3.F10" title="In Appendix C Relationship to State Space Models ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">10</span></a>, where the previous best method ViMPNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib71" title="">71</a>]</cite> blurs the <span class="ltx_text" id="A4.SS2.p1.1.2" style="color:#FF0000;">number plate</span> on the car (in last row), or introduces faux texture <span class="ltx_text" id="A4.SS2.p1.1.3" style="color:#FF0000;">on the building</span> (in second row). On the contrary, <span class="ltx_text ltx_font_smallcaps" id="A4.SS2.p1.1.4">turtle</span> better restores the results and avoids undesired artifacts or blur.</p>
</div>
</section>
<section class="ltx_subsection" id="A4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.3 </span>Video Desnowing</h3>
<div class="ltx_para" id="A4.SS3.p1">
<p class="ltx_p" id="A4.SS3.p1.1">We present additional visual results on the video desnowing task in <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A3.F11" title="In Appendix C Relationship to State Space Models ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">11</span></a>. We compare <span class="ltx_text ltx_font_smallcaps" id="A4.SS3.p1.1.1">turtle</span> with SVDNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib10" title="">10</a>]</cite>, the previous best method in the literature on the task. Our method removes snowflakes effectively and differentiates between them and similar-sized texture regions in the background (see <span class="ltx_text" id="A4.SS3.p1.1.2" style="color:#FF0000;">white spots on the sheep wool</span> in the top row) without requiring any snow prior like SVDNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib10" title="">10</a>]</cite>. Although SVDNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib10" title="">10</a>]</cite> removes snowflakes to a considerable extent, it fails to remove smaller flecks of snow comprehensively. However, <span class="ltx_text ltx_font_smallcaps" id="A4.SS3.p1.1.3">turtle</span>’s restored results are visually pleasing and faithful to the ground truth.</p>
</div>
</section>
<section class="ltx_subsection" id="A4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.4 </span>Nighttime Video Deraining</h3>
<div class="ltx_para" id="A4.SS4.p1">
<p class="ltx_p" id="A4.SS4.p1.1">In <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S3.F3" title="In Frame History Router (𝜓). ‣ 3.2 Causal History Model ‣ 3 Methodology ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">3</span></a>, we presented the visual results in comparison to MetaRain <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib47" title="">47</a>]</cite>. For a fair comparison, we resized the outputs to <math alttext="256\times 256" class="ltx_Math" display="inline" id="A4.SS4.p1.1.m1.1"><semantics id="A4.SS4.p1.1.m1.1a"><mrow id="A4.SS4.p1.1.m1.1.1" xref="A4.SS4.p1.1.m1.1.1.cmml"><mn id="A4.SS4.p1.1.m1.1.1.2" xref="A4.SS4.p1.1.m1.1.1.2.cmml">256</mn><mo id="A4.SS4.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A4.SS4.p1.1.m1.1.1.1.cmml">×</mo><mn id="A4.SS4.p1.1.m1.1.1.3" xref="A4.SS4.p1.1.m1.1.1.3.cmml">256</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.SS4.p1.1.m1.1b"><apply id="A4.SS4.p1.1.m1.1.1.cmml" xref="A4.SS4.p1.1.m1.1.1"><times id="A4.SS4.p1.1.m1.1.1.1.cmml" xref="A4.SS4.p1.1.m1.1.1.1"></times><cn id="A4.SS4.p1.1.m1.1.1.2.cmml" type="integer" xref="A4.SS4.p1.1.m1.1.1.2">256</cn><cn id="A4.SS4.p1.1.m1.1.1.3.cmml" type="integer" xref="A4.SS4.p1.1.m1.1.1.3">256</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS4.p1.1.m1.1c">256\times 256</annotation><annotation encoding="application/x-llamapun" id="A4.SS4.p1.1.m1.1d">256 × 256</annotation></semantics></math> following the work in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib47" title="">47</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib35" title="">35</a>]</cite>. However, in <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A3.F12" title="In Appendix C Relationship to State Space Models ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">12</span></a>, we present <span class="ltx_text ltx_font_smallcaps" id="A4.SS4.p1.1.1">turtle</span>’s results on full-sized frames taken from two different testset videos. Our method preserves the true colors of the frames and removes rain streaks from the input without introducing unwanted textures or discoloration. Note that in <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S3.T2" title="In Frame History Router (𝜓). ‣ 3.2 Causal History Model ‣ 3 Methodology ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">table</span> <span class="ltx_text ltx_ref_tag">2</span></a>, we compute PSNR in Y-Channel following MetaRain <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib47" title="">47</a>]</cite> since NightRain <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib35" title="">35</a>]</cite> did not release their code, and their manuscript does not clarify if the scores are computed in RGB color space or in Y-Channel. Nonetheless, we report PSNR score in RGB color space to allow comparison with NightRain <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib35" title="">35</a>]</cite> regardless: <span class="ltx_text ltx_font_smallcaps" id="A4.SS4.p1.1.2">turtle</span> scores 27.68 dB in RGB color space.</p>
</div>
<figure class="ltx_figure" id="A4.F13"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="635" id="A4.F13.g1" src="x13.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 13: </span><span class="ltx_text ltx_font_bold" id="A4.F13.7.1">Visual Results on Real-World Video Deblurring.</span> We present visual results of <span class="ltx_text ltx_font_smallcaps" id="A4.F13.8.2">Turtle</span> on the real-world video deblurring task on BSD <math alttext="3" class="ltx_Math" display="inline" id="A4.F13.3.m1.1"><semantics id="A4.F13.3.m1.1b"><mn id="A4.F13.3.m1.1.1" xref="A4.F13.3.m1.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="A4.F13.3.m1.1c"><cn id="A4.F13.3.m1.1.1.cmml" type="integer" xref="A4.F13.3.m1.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.F13.3.m1.1d">3</annotation><annotation encoding="application/x-llamapun" id="A4.F13.3.m1.1e">3</annotation></semantics></math>ms-<math alttext="24" class="ltx_Math" display="inline" id="A4.F13.4.m2.1"><semantics id="A4.F13.4.m2.1b"><mn id="A4.F13.4.m2.1.1" xref="A4.F13.4.m2.1.1.cmml">24</mn><annotation-xml encoding="MathML-Content" id="A4.F13.4.m2.1c"><cn id="A4.F13.4.m2.1.1.cmml" type="integer" xref="A4.F13.4.m2.1.1">24</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.F13.4.m2.1d">24</annotation><annotation encoding="application/x-llamapun" id="A4.F13.4.m2.1e">24</annotation></semantics></math>ms dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib83" title="">83</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib82" title="">82</a>]</cite> on three frames taken from three different videos in the testset. Our method restores the frame with high perceptual quality.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="A4.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.5 </span>Real-World Video Deblurring</h3>
<div class="ltx_para" id="A4.SS5.p1">
<p class="ltx_p" id="A4.SS5.p1.2">Different from synthetic video deblurring (see <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A1.F9" title="In A.2 Historyless FFN. ‣ Appendix A Turtle’s Specifications &amp; Details ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">9</span></a>), in real-world deblurring, the blur is induced through real motion, both of camera, and object. In <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A4.F13" title="In D.4 Nighttime Video Deraining ‣ Appendix D Further Visual Comparisons ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">13</span></a>, we present visual results on three frames taken from three videos from the testset of the BSD dataset (<math alttext="3" class="ltx_Math" display="inline" id="A4.SS5.p1.1.m1.1"><semantics id="A4.SS5.p1.1.m1.1a"><mn id="A4.SS5.p1.1.m1.1.1" xref="A4.SS5.p1.1.m1.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="A4.SS5.p1.1.m1.1b"><cn id="A4.SS5.p1.1.m1.1.1.cmml" type="integer" xref="A4.SS5.p1.1.m1.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.SS5.p1.1.m1.1c">3</annotation><annotation encoding="application/x-llamapun" id="A4.SS5.p1.1.m1.1d">3</annotation></semantics></math>ms-<math alttext="24" class="ltx_Math" display="inline" id="A4.SS5.p1.2.m2.1"><semantics id="A4.SS5.p1.2.m2.1a"><mn id="A4.SS5.p1.2.m2.1.1" xref="A4.SS5.p1.2.m2.1.1.cmml">24</mn><annotation-xml encoding="MathML-Content" id="A4.SS5.p1.2.m2.1b"><cn id="A4.SS5.p1.2.m2.1.1.cmml" type="integer" xref="A4.SS5.p1.2.m2.1.1">24</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.SS5.p1.2.m2.1c">24</annotation><annotation encoding="application/x-llamapun" id="A4.SS5.p1.2.m2.1d">24</annotation></semantics></math>ms configuration) to complement the quantitative performance of <span class="ltx_text ltx_font_smallcaps" id="A4.SS5.p1.2.1">turtle</span> in  <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#S4.T5" title="In 4.1 Night Video Deraining ‣ 4 Experiments ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">table</span> <span class="ltx_text ltx_ref_tag">5</span></a>. <span class="ltx_text ltx_font_smallcaps" id="A4.SS5.p1.2.2">Turtle</span> restores the video frames with high perceptual quality, and the resultant frames are faithful to the ground-truth, and are visually pleasing.</p>
</div>
<figure class="ltx_table" id="A4.T12">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 12: </span><span class="ltx_text ltx_font_bold" id="A4.T12.50.1">Profiling <span class="ltx_text ltx_font_smallcaps" id="A4.T12.50.1.1">Turtle</span>.</span> We profile the proposed method, <span class="ltx_text ltx_font_smallcaps" id="A4.T12.51.2">turtle</span>, on a single 32 GB V100 GPU, and compare with 3 recent video restoration methods, namely ShiftNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib29" title="">29</a>]</cite>, VRT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib34" title="">34</a>]</cite>, and RVRT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib33" title="">33</a>]</cite>. We consider different input resolutions and compute the per-frame inference time (ms), total MACs (G), FLOPs (G), and the GPU memory usage of the model. <span class="ltx_text ltx_font_typewriter" id="A4.T12.52.3" style="color:#FF0000;">OOM</span> denotes Out-Of-Memory error i.e., the memory requirement exceeded the total available memory of 32GB.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A4.T12.46">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A4.T12.46.47.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" id="A4.T12.46.47.1.1"><span class="ltx_text ltx_font_bold" id="A4.T12.46.47.1.1.1">Methods</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" id="A4.T12.46.47.1.2">
<table class="ltx_tabular ltx_align_middle" id="A4.T12.46.47.1.2.1">
<tr class="ltx_tr" id="A4.T12.46.47.1.2.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T12.46.47.1.2.1.1.1"><span class="ltx_text ltx_font_bold" id="A4.T12.46.47.1.2.1.1.1.1">Frame</span></td>
</tr>
<tr class="ltx_tr" id="A4.T12.46.47.1.2.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T12.46.47.1.2.1.2.1"><span class="ltx_text ltx_font_bold" id="A4.T12.46.47.1.2.1.2.1.1">Resolution</span></td>
</tr>
</table>
</th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A4.T12.46.47.1.3">
<table class="ltx_tabular ltx_align_middle" id="A4.T12.46.47.1.3.1">
<tr class="ltx_tr" id="A4.T12.46.47.1.3.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T12.46.47.1.3.1.1.1"><span class="ltx_text ltx_font_bold" id="A4.T12.46.47.1.3.1.1.1.1">Per Frame</span></td>
</tr>
<tr class="ltx_tr" id="A4.T12.46.47.1.3.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T12.46.47.1.3.1.2.1"><span class="ltx_text ltx_font_bold" id="A4.T12.46.47.1.3.1.2.1.1">Inference Time (ms)</span></td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A4.T12.46.47.1.4"><span class="ltx_text ltx_font_bold" id="A4.T12.46.47.1.4.1">MACs (G)</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_tt" id="A4.T12.46.47.1.5">
<table class="ltx_tabular ltx_align_middle" id="A4.T12.46.47.1.5.1">
<tr class="ltx_tr" id="A4.T12.46.47.1.5.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T12.46.47.1.5.1.1.1"><span class="ltx_text ltx_font_bold" id="A4.T12.46.47.1.5.1.1.1.1">GPU</span></td>
</tr>
<tr class="ltx_tr" id="A4.T12.46.47.1.5.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T12.46.47.1.5.1.2.1"><span class="ltx_text ltx_font_bold" id="A4.T12.46.47.1.5.1.2.1.1">Memory Usage (MBs)</span></td>
</tr>
</table>
</td>
</tr>
<tr class="ltx_tr" id="A4.T12.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="A4.T12.4.4.5" rowspan="4"><span class="ltx_text" id="A4.T12.4.4.5.1">
<span class="ltx_tabular ltx_align_middle" id="A4.T12.4.4.5.1.1">
<span class="ltx_tr" id="A4.T12.4.4.5.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T12.4.4.5.1.1.1.1">ShiftNet</span></span>
<span class="ltx_tr" id="A4.T12.4.4.5.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T12.4.4.5.1.1.2.1"><cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib29" title="">29</a>]</cite></span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="A4.T12.1.1.1"><math alttext="256\times 256\times 3" class="ltx_Math" display="inline" id="A4.T12.1.1.1.m1.1"><semantics id="A4.T12.1.1.1.m1.1a"><mrow id="A4.T12.1.1.1.m1.1.1" xref="A4.T12.1.1.1.m1.1.1.cmml"><mn id="A4.T12.1.1.1.m1.1.1.2" xref="A4.T12.1.1.1.m1.1.1.2.cmml">256</mn><mo id="A4.T12.1.1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A4.T12.1.1.1.m1.1.1.1.cmml">×</mo><mn id="A4.T12.1.1.1.m1.1.1.3" xref="A4.T12.1.1.1.m1.1.1.3.cmml">256</mn><mo id="A4.T12.1.1.1.m1.1.1.1a" lspace="0.222em" rspace="0.222em" xref="A4.T12.1.1.1.m1.1.1.1.cmml">×</mo><mn id="A4.T12.1.1.1.m1.1.1.4" xref="A4.T12.1.1.1.m1.1.1.4.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T12.1.1.1.m1.1b"><apply id="A4.T12.1.1.1.m1.1.1.cmml" xref="A4.T12.1.1.1.m1.1.1"><times id="A4.T12.1.1.1.m1.1.1.1.cmml" xref="A4.T12.1.1.1.m1.1.1.1"></times><cn id="A4.T12.1.1.1.m1.1.1.2.cmml" type="integer" xref="A4.T12.1.1.1.m1.1.1.2">256</cn><cn id="A4.T12.1.1.1.m1.1.1.3.cmml" type="integer" xref="A4.T12.1.1.1.m1.1.1.3">256</cn><cn id="A4.T12.1.1.1.m1.1.1.4.cmml" type="integer" xref="A4.T12.1.1.1.m1.1.1.4">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T12.1.1.1.m1.1c">256\times 256\times 3</annotation><annotation encoding="application/x-llamapun" id="A4.T12.1.1.1.m1.1d">256 × 256 × 3</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T12.2.2.2"><math alttext="190" class="ltx_Math" display="inline" id="A4.T12.2.2.2.m1.1"><semantics id="A4.T12.2.2.2.m1.1a"><mn id="A4.T12.2.2.2.m1.1.1" xref="A4.T12.2.2.2.m1.1.1.cmml">190</mn><annotation-xml encoding="MathML-Content" id="A4.T12.2.2.2.m1.1b"><cn id="A4.T12.2.2.2.m1.1.1.cmml" type="integer" xref="A4.T12.2.2.2.m1.1.1">190</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.T12.2.2.2.m1.1c">190</annotation><annotation encoding="application/x-llamapun" id="A4.T12.2.2.2.m1.1d">190</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T12.3.3.3"><math alttext="989" class="ltx_Math" display="inline" id="A4.T12.3.3.3.m1.1"><semantics id="A4.T12.3.3.3.m1.1a"><mn id="A4.T12.3.3.3.m1.1.1" xref="A4.T12.3.3.3.m1.1.1.cmml">989</mn><annotation-xml encoding="MathML-Content" id="A4.T12.3.3.3.m1.1b"><cn id="A4.T12.3.3.3.m1.1.1.cmml" type="integer" xref="A4.T12.3.3.3.m1.1.1">989</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.T12.3.3.3.m1.1c">989</annotation><annotation encoding="application/x-llamapun" id="A4.T12.3.3.3.m1.1d">989</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="A4.T12.4.4.4"><math alttext="2752" class="ltx_Math" display="inline" id="A4.T12.4.4.4.m1.1"><semantics id="A4.T12.4.4.4.m1.1a"><mn id="A4.T12.4.4.4.m1.1.1" xref="A4.T12.4.4.4.m1.1.1.cmml">2752</mn><annotation-xml encoding="MathML-Content" id="A4.T12.4.4.4.m1.1b"><cn id="A4.T12.4.4.4.m1.1.1.cmml" type="integer" xref="A4.T12.4.4.4.m1.1.1">2752</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.T12.4.4.4.m1.1c">2752</annotation><annotation encoding="application/x-llamapun" id="A4.T12.4.4.4.m1.1d">2752</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A4.T12.8.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A4.T12.5.5.1"><math alttext="640\times 480\times 3" class="ltx_Math" display="inline" id="A4.T12.5.5.1.m1.1"><semantics id="A4.T12.5.5.1.m1.1a"><mrow id="A4.T12.5.5.1.m1.1.1" xref="A4.T12.5.5.1.m1.1.1.cmml"><mn id="A4.T12.5.5.1.m1.1.1.2" xref="A4.T12.5.5.1.m1.1.1.2.cmml">640</mn><mo id="A4.T12.5.5.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A4.T12.5.5.1.m1.1.1.1.cmml">×</mo><mn id="A4.T12.5.5.1.m1.1.1.3" xref="A4.T12.5.5.1.m1.1.1.3.cmml">480</mn><mo id="A4.T12.5.5.1.m1.1.1.1a" lspace="0.222em" rspace="0.222em" xref="A4.T12.5.5.1.m1.1.1.1.cmml">×</mo><mn id="A4.T12.5.5.1.m1.1.1.4" xref="A4.T12.5.5.1.m1.1.1.4.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T12.5.5.1.m1.1b"><apply id="A4.T12.5.5.1.m1.1.1.cmml" xref="A4.T12.5.5.1.m1.1.1"><times id="A4.T12.5.5.1.m1.1.1.1.cmml" xref="A4.T12.5.5.1.m1.1.1.1"></times><cn id="A4.T12.5.5.1.m1.1.1.2.cmml" type="integer" xref="A4.T12.5.5.1.m1.1.1.2">640</cn><cn id="A4.T12.5.5.1.m1.1.1.3.cmml" type="integer" xref="A4.T12.5.5.1.m1.1.1.3">480</cn><cn id="A4.T12.5.5.1.m1.1.1.4.cmml" type="integer" xref="A4.T12.5.5.1.m1.1.1.4">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T12.5.5.1.m1.1c">640\times 480\times 3</annotation><annotation encoding="application/x-llamapun" id="A4.T12.5.5.1.m1.1d">640 × 480 × 3</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="A4.T12.6.6.2"><math alttext="510" class="ltx_Math" display="inline" id="A4.T12.6.6.2.m1.1"><semantics id="A4.T12.6.6.2.m1.1a"><mn id="A4.T12.6.6.2.m1.1.1" xref="A4.T12.6.6.2.m1.1.1.cmml">510</mn><annotation-xml encoding="MathML-Content" id="A4.T12.6.6.2.m1.1b"><cn id="A4.T12.6.6.2.m1.1.1.cmml" type="integer" xref="A4.T12.6.6.2.m1.1.1">510</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.T12.6.6.2.m1.1c">510</annotation><annotation encoding="application/x-llamapun" id="A4.T12.6.6.2.m1.1d">510</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A4.T12.7.7.3"><math alttext="5630" class="ltx_Math" display="inline" id="A4.T12.7.7.3.m1.1"><semantics id="A4.T12.7.7.3.m1.1a"><mn id="A4.T12.7.7.3.m1.1.1" xref="A4.T12.7.7.3.m1.1.1.cmml">5630</mn><annotation-xml encoding="MathML-Content" id="A4.T12.7.7.3.m1.1b"><cn id="A4.T12.7.7.3.m1.1.1.cmml" type="integer" xref="A4.T12.7.7.3.m1.1.1">5630</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.T12.7.7.3.m1.1c">5630</annotation><annotation encoding="application/x-llamapun" id="A4.T12.7.7.3.m1.1d">5630</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T12.8.8.4"><math alttext="7068" class="ltx_Math" display="inline" id="A4.T12.8.8.4.m1.1"><semantics id="A4.T12.8.8.4.m1.1a"><mn id="A4.T12.8.8.4.m1.1.1" xref="A4.T12.8.8.4.m1.1.1.cmml">7068</mn><annotation-xml encoding="MathML-Content" id="A4.T12.8.8.4.m1.1b"><cn id="A4.T12.8.8.4.m1.1.1.cmml" type="integer" xref="A4.T12.8.8.4.m1.1.1">7068</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.T12.8.8.4.m1.1c">7068</annotation><annotation encoding="application/x-llamapun" id="A4.T12.8.8.4.m1.1d">7068</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A4.T12.9.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A4.T12.9.9.1"><math alttext="1280\times 720\times 3" class="ltx_Math" display="inline" id="A4.T12.9.9.1.m1.1"><semantics id="A4.T12.9.9.1.m1.1a"><mrow id="A4.T12.9.9.1.m1.1.1" xref="A4.T12.9.9.1.m1.1.1.cmml"><mn id="A4.T12.9.9.1.m1.1.1.2" xref="A4.T12.9.9.1.m1.1.1.2.cmml">1280</mn><mo id="A4.T12.9.9.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A4.T12.9.9.1.m1.1.1.1.cmml">×</mo><mn id="A4.T12.9.9.1.m1.1.1.3" xref="A4.T12.9.9.1.m1.1.1.3.cmml">720</mn><mo id="A4.T12.9.9.1.m1.1.1.1a" lspace="0.222em" rspace="0.222em" xref="A4.T12.9.9.1.m1.1.1.1.cmml">×</mo><mn id="A4.T12.9.9.1.m1.1.1.4" xref="A4.T12.9.9.1.m1.1.1.4.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T12.9.9.1.m1.1b"><apply id="A4.T12.9.9.1.m1.1.1.cmml" xref="A4.T12.9.9.1.m1.1.1"><times id="A4.T12.9.9.1.m1.1.1.1.cmml" xref="A4.T12.9.9.1.m1.1.1.1"></times><cn id="A4.T12.9.9.1.m1.1.1.2.cmml" type="integer" xref="A4.T12.9.9.1.m1.1.1.2">1280</cn><cn id="A4.T12.9.9.1.m1.1.1.3.cmml" type="integer" xref="A4.T12.9.9.1.m1.1.1.3">720</cn><cn id="A4.T12.9.9.1.m1.1.1.4.cmml" type="integer" xref="A4.T12.9.9.1.m1.1.1.4">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T12.9.9.1.m1.1c">1280\times 720\times 3</annotation><annotation encoding="application/x-llamapun" id="A4.T12.9.9.1.m1.1d">1280 × 720 × 3</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="A4.T12.9.9.2"><span class="ltx_text ltx_font_typewriter" id="A4.T12.9.9.2.1" style="color:#FF0000;">OOM</span></td>
<td class="ltx_td ltx_align_center" id="A4.T12.9.9.3"><span class="ltx_text ltx_font_typewriter" id="A4.T12.9.9.3.1" style="color:#FF0000;">OOM</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T12.9.9.4"><span class="ltx_text ltx_font_typewriter" id="A4.T12.9.9.4.1" style="color:#FF0000;">OOM</span></td>
</tr>
<tr class="ltx_tr" id="A4.T12.10.10">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A4.T12.10.10.1"><math alttext="1920\times 1080\times 3" class="ltx_Math" display="inline" id="A4.T12.10.10.1.m1.1"><semantics id="A4.T12.10.10.1.m1.1a"><mrow id="A4.T12.10.10.1.m1.1.1" xref="A4.T12.10.10.1.m1.1.1.cmml"><mn id="A4.T12.10.10.1.m1.1.1.2" xref="A4.T12.10.10.1.m1.1.1.2.cmml">1920</mn><mo id="A4.T12.10.10.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A4.T12.10.10.1.m1.1.1.1.cmml">×</mo><mn id="A4.T12.10.10.1.m1.1.1.3" xref="A4.T12.10.10.1.m1.1.1.3.cmml">1080</mn><mo id="A4.T12.10.10.1.m1.1.1.1a" lspace="0.222em" rspace="0.222em" xref="A4.T12.10.10.1.m1.1.1.1.cmml">×</mo><mn id="A4.T12.10.10.1.m1.1.1.4" xref="A4.T12.10.10.1.m1.1.1.4.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T12.10.10.1.m1.1b"><apply id="A4.T12.10.10.1.m1.1.1.cmml" xref="A4.T12.10.10.1.m1.1.1"><times id="A4.T12.10.10.1.m1.1.1.1.cmml" xref="A4.T12.10.10.1.m1.1.1.1"></times><cn id="A4.T12.10.10.1.m1.1.1.2.cmml" type="integer" xref="A4.T12.10.10.1.m1.1.1.2">1920</cn><cn id="A4.T12.10.10.1.m1.1.1.3.cmml" type="integer" xref="A4.T12.10.10.1.m1.1.1.3">1080</cn><cn id="A4.T12.10.10.1.m1.1.1.4.cmml" type="integer" xref="A4.T12.10.10.1.m1.1.1.4">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T12.10.10.1.m1.1c">1920\times 1080\times 3</annotation><annotation encoding="application/x-llamapun" id="A4.T12.10.10.1.m1.1d">1920 × 1080 × 3</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="A4.T12.10.10.2"><span class="ltx_text ltx_font_typewriter" id="A4.T12.10.10.2.1" style="color:#FF0000;">OOM</span></td>
<td class="ltx_td ltx_align_center" id="A4.T12.10.10.3"><span class="ltx_text ltx_font_typewriter" id="A4.T12.10.10.3.1" style="color:#FF0000;">OOM</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T12.10.10.4"><span class="ltx_text ltx_font_typewriter" id="A4.T12.10.10.4.1" style="color:#FF0000;">OOM</span></td>
</tr>
<tr class="ltx_tr" id="A4.T12.14.14">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A4.T12.14.14.5" rowspan="4"><span class="ltx_text" id="A4.T12.14.14.5.1">
<span class="ltx_tabular ltx_align_middle" id="A4.T12.14.14.5.1.1">
<span class="ltx_tr" id="A4.T12.14.14.5.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T12.14.14.5.1.1.1.1">VRT</span></span>
<span class="ltx_tr" id="A4.T12.14.14.5.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T12.14.14.5.1.1.2.1"><cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib34" title="">34</a>]</cite></span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A4.T12.11.11.1"><math alttext="256\times 256\times 3" class="ltx_Math" display="inline" id="A4.T12.11.11.1.m1.1"><semantics id="A4.T12.11.11.1.m1.1a"><mrow id="A4.T12.11.11.1.m1.1.1" xref="A4.T12.11.11.1.m1.1.1.cmml"><mn id="A4.T12.11.11.1.m1.1.1.2" xref="A4.T12.11.11.1.m1.1.1.2.cmml">256</mn><mo id="A4.T12.11.11.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A4.T12.11.11.1.m1.1.1.1.cmml">×</mo><mn id="A4.T12.11.11.1.m1.1.1.3" xref="A4.T12.11.11.1.m1.1.1.3.cmml">256</mn><mo id="A4.T12.11.11.1.m1.1.1.1a" lspace="0.222em" rspace="0.222em" xref="A4.T12.11.11.1.m1.1.1.1.cmml">×</mo><mn id="A4.T12.11.11.1.m1.1.1.4" xref="A4.T12.11.11.1.m1.1.1.4.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T12.11.11.1.m1.1b"><apply id="A4.T12.11.11.1.m1.1.1.cmml" xref="A4.T12.11.11.1.m1.1.1"><times id="A4.T12.11.11.1.m1.1.1.1.cmml" xref="A4.T12.11.11.1.m1.1.1.1"></times><cn id="A4.T12.11.11.1.m1.1.1.2.cmml" type="integer" xref="A4.T12.11.11.1.m1.1.1.2">256</cn><cn id="A4.T12.11.11.1.m1.1.1.3.cmml" type="integer" xref="A4.T12.11.11.1.m1.1.1.3">256</cn><cn id="A4.T12.11.11.1.m1.1.1.4.cmml" type="integer" xref="A4.T12.11.11.1.m1.1.1.4">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T12.11.11.1.m1.1c">256\times 256\times 3</annotation><annotation encoding="application/x-llamapun" id="A4.T12.11.11.1.m1.1d">256 × 256 × 3</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="A4.T12.12.12.2"><math alttext="455" class="ltx_Math" display="inline" id="A4.T12.12.12.2.m1.1"><semantics id="A4.T12.12.12.2.m1.1a"><mn id="A4.T12.12.12.2.m1.1.1" xref="A4.T12.12.12.2.m1.1.1.cmml">455</mn><annotation-xml encoding="MathML-Content" id="A4.T12.12.12.2.m1.1b"><cn id="A4.T12.12.12.2.m1.1.1.cmml" type="integer" xref="A4.T12.12.12.2.m1.1.1">455</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.T12.12.12.2.m1.1c">455</annotation><annotation encoding="application/x-llamapun" id="A4.T12.12.12.2.m1.1d">455</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A4.T12.13.13.3"><math alttext="1631" class="ltx_Math" display="inline" id="A4.T12.13.13.3.m1.1"><semantics id="A4.T12.13.13.3.m1.1a"><mn id="A4.T12.13.13.3.m1.1.1" xref="A4.T12.13.13.3.m1.1.1.cmml">1631</mn><annotation-xml encoding="MathML-Content" id="A4.T12.13.13.3.m1.1b"><cn id="A4.T12.13.13.3.m1.1.1.cmml" type="integer" xref="A4.T12.13.13.3.m1.1.1">1631</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.T12.13.13.3.m1.1c">1631</annotation><annotation encoding="application/x-llamapun" id="A4.T12.13.13.3.m1.1d">1631</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T12.14.14.4"><math alttext="3546" class="ltx_Math" display="inline" id="A4.T12.14.14.4.m1.1"><semantics id="A4.T12.14.14.4.m1.1a"><mn id="A4.T12.14.14.4.m1.1.1" xref="A4.T12.14.14.4.m1.1.1.cmml">3546</mn><annotation-xml encoding="MathML-Content" id="A4.T12.14.14.4.m1.1b"><cn id="A4.T12.14.14.4.m1.1.1.cmml" type="integer" xref="A4.T12.14.14.4.m1.1.1">3546</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.T12.14.14.4.m1.1c">3546</annotation><annotation encoding="application/x-llamapun" id="A4.T12.14.14.4.m1.1d">3546</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A4.T12.18.18">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A4.T12.15.15.1"><math alttext="640\times 480\times 3" class="ltx_Math" display="inline" id="A4.T12.15.15.1.m1.1"><semantics id="A4.T12.15.15.1.m1.1a"><mrow id="A4.T12.15.15.1.m1.1.1" xref="A4.T12.15.15.1.m1.1.1.cmml"><mn id="A4.T12.15.15.1.m1.1.1.2" xref="A4.T12.15.15.1.m1.1.1.2.cmml">640</mn><mo id="A4.T12.15.15.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A4.T12.15.15.1.m1.1.1.1.cmml">×</mo><mn id="A4.T12.15.15.1.m1.1.1.3" xref="A4.T12.15.15.1.m1.1.1.3.cmml">480</mn><mo id="A4.T12.15.15.1.m1.1.1.1a" lspace="0.222em" rspace="0.222em" xref="A4.T12.15.15.1.m1.1.1.1.cmml">×</mo><mn id="A4.T12.15.15.1.m1.1.1.4" xref="A4.T12.15.15.1.m1.1.1.4.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T12.15.15.1.m1.1b"><apply id="A4.T12.15.15.1.m1.1.1.cmml" xref="A4.T12.15.15.1.m1.1.1"><times id="A4.T12.15.15.1.m1.1.1.1.cmml" xref="A4.T12.15.15.1.m1.1.1.1"></times><cn id="A4.T12.15.15.1.m1.1.1.2.cmml" type="integer" xref="A4.T12.15.15.1.m1.1.1.2">640</cn><cn id="A4.T12.15.15.1.m1.1.1.3.cmml" type="integer" xref="A4.T12.15.15.1.m1.1.1.3">480</cn><cn id="A4.T12.15.15.1.m1.1.1.4.cmml" type="integer" xref="A4.T12.15.15.1.m1.1.1.4">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T12.15.15.1.m1.1c">640\times 480\times 3</annotation><annotation encoding="application/x-llamapun" id="A4.T12.15.15.1.m1.1d">640 × 480 × 3</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="A4.T12.16.16.2"><math alttext="2090" class="ltx_Math" display="inline" id="A4.T12.16.16.2.m1.1"><semantics id="A4.T12.16.16.2.m1.1a"><mn id="A4.T12.16.16.2.m1.1.1" xref="A4.T12.16.16.2.m1.1.1.cmml">2090</mn><annotation-xml encoding="MathML-Content" id="A4.T12.16.16.2.m1.1b"><cn id="A4.T12.16.16.2.m1.1.1.cmml" type="integer" xref="A4.T12.16.16.2.m1.1.1">2090</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.T12.16.16.2.m1.1c">2090</annotation><annotation encoding="application/x-llamapun" id="A4.T12.16.16.2.m1.1d">2090</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A4.T12.17.17.3"><math alttext="7648" class="ltx_Math" display="inline" id="A4.T12.17.17.3.m1.1"><semantics id="A4.T12.17.17.3.m1.1a"><mn id="A4.T12.17.17.3.m1.1.1" xref="A4.T12.17.17.3.m1.1.1.cmml">7648</mn><annotation-xml encoding="MathML-Content" id="A4.T12.17.17.3.m1.1b"><cn id="A4.T12.17.17.3.m1.1.1.cmml" type="integer" xref="A4.T12.17.17.3.m1.1.1">7648</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.T12.17.17.3.m1.1c">7648</annotation><annotation encoding="application/x-llamapun" id="A4.T12.17.17.3.m1.1d">7648</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T12.18.18.4"><math alttext="11964" class="ltx_Math" display="inline" id="A4.T12.18.18.4.m1.1"><semantics id="A4.T12.18.18.4.m1.1a"><mn id="A4.T12.18.18.4.m1.1.1" xref="A4.T12.18.18.4.m1.1.1.cmml">11964</mn><annotation-xml encoding="MathML-Content" id="A4.T12.18.18.4.m1.1b"><cn id="A4.T12.18.18.4.m1.1.1.cmml" type="integer" xref="A4.T12.18.18.4.m1.1.1">11964</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.T12.18.18.4.m1.1c">11964</annotation><annotation encoding="application/x-llamapun" id="A4.T12.18.18.4.m1.1d">11964</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A4.T12.19.19">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A4.T12.19.19.1"><math alttext="1280\times 720\times 3" class="ltx_Math" display="inline" id="A4.T12.19.19.1.m1.1"><semantics id="A4.T12.19.19.1.m1.1a"><mrow id="A4.T12.19.19.1.m1.1.1" xref="A4.T12.19.19.1.m1.1.1.cmml"><mn id="A4.T12.19.19.1.m1.1.1.2" xref="A4.T12.19.19.1.m1.1.1.2.cmml">1280</mn><mo id="A4.T12.19.19.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A4.T12.19.19.1.m1.1.1.1.cmml">×</mo><mn id="A4.T12.19.19.1.m1.1.1.3" xref="A4.T12.19.19.1.m1.1.1.3.cmml">720</mn><mo id="A4.T12.19.19.1.m1.1.1.1a" lspace="0.222em" rspace="0.222em" xref="A4.T12.19.19.1.m1.1.1.1.cmml">×</mo><mn id="A4.T12.19.19.1.m1.1.1.4" xref="A4.T12.19.19.1.m1.1.1.4.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T12.19.19.1.m1.1b"><apply id="A4.T12.19.19.1.m1.1.1.cmml" xref="A4.T12.19.19.1.m1.1.1"><times id="A4.T12.19.19.1.m1.1.1.1.cmml" xref="A4.T12.19.19.1.m1.1.1.1"></times><cn id="A4.T12.19.19.1.m1.1.1.2.cmml" type="integer" xref="A4.T12.19.19.1.m1.1.1.2">1280</cn><cn id="A4.T12.19.19.1.m1.1.1.3.cmml" type="integer" xref="A4.T12.19.19.1.m1.1.1.3">720</cn><cn id="A4.T12.19.19.1.m1.1.1.4.cmml" type="integer" xref="A4.T12.19.19.1.m1.1.1.4">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T12.19.19.1.m1.1c">1280\times 720\times 3</annotation><annotation encoding="application/x-llamapun" id="A4.T12.19.19.1.m1.1d">1280 × 720 × 3</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="A4.T12.19.19.2"><span class="ltx_text ltx_font_typewriter" id="A4.T12.19.19.2.1" style="color:#FF0000;">OOM</span></td>
<td class="ltx_td ltx_align_center" id="A4.T12.19.19.3"><span class="ltx_text ltx_font_typewriter" id="A4.T12.19.19.3.1" style="color:#FF0000;">OOM</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T12.19.19.4"><span class="ltx_text ltx_font_typewriter" id="A4.T12.19.19.4.1" style="color:#FF0000;">OOM</span></td>
</tr>
<tr class="ltx_tr" id="A4.T12.20.20">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A4.T12.20.20.1"><math alttext="1920\times 1080\times 3" class="ltx_Math" display="inline" id="A4.T12.20.20.1.m1.1"><semantics id="A4.T12.20.20.1.m1.1a"><mrow id="A4.T12.20.20.1.m1.1.1" xref="A4.T12.20.20.1.m1.1.1.cmml"><mn id="A4.T12.20.20.1.m1.1.1.2" xref="A4.T12.20.20.1.m1.1.1.2.cmml">1920</mn><mo id="A4.T12.20.20.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A4.T12.20.20.1.m1.1.1.1.cmml">×</mo><mn id="A4.T12.20.20.1.m1.1.1.3" xref="A4.T12.20.20.1.m1.1.1.3.cmml">1080</mn><mo id="A4.T12.20.20.1.m1.1.1.1a" lspace="0.222em" rspace="0.222em" xref="A4.T12.20.20.1.m1.1.1.1.cmml">×</mo><mn id="A4.T12.20.20.1.m1.1.1.4" xref="A4.T12.20.20.1.m1.1.1.4.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T12.20.20.1.m1.1b"><apply id="A4.T12.20.20.1.m1.1.1.cmml" xref="A4.T12.20.20.1.m1.1.1"><times id="A4.T12.20.20.1.m1.1.1.1.cmml" xref="A4.T12.20.20.1.m1.1.1.1"></times><cn id="A4.T12.20.20.1.m1.1.1.2.cmml" type="integer" xref="A4.T12.20.20.1.m1.1.1.2">1920</cn><cn id="A4.T12.20.20.1.m1.1.1.3.cmml" type="integer" xref="A4.T12.20.20.1.m1.1.1.3">1080</cn><cn id="A4.T12.20.20.1.m1.1.1.4.cmml" type="integer" xref="A4.T12.20.20.1.m1.1.1.4">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T12.20.20.1.m1.1c">1920\times 1080\times 3</annotation><annotation encoding="application/x-llamapun" id="A4.T12.20.20.1.m1.1d">1920 × 1080 × 3</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="A4.T12.20.20.2"><span class="ltx_text ltx_font_typewriter" id="A4.T12.20.20.2.1" style="color:#FF0000;">OOM</span></td>
<td class="ltx_td ltx_align_center" id="A4.T12.20.20.3"><span class="ltx_text ltx_font_typewriter" id="A4.T12.20.20.3.1" style="color:#FF0000;">OOM</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T12.20.20.4"><span class="ltx_text ltx_font_typewriter" id="A4.T12.20.20.4.1" style="color:#FF0000;">OOM</span></td>
</tr>
<tr class="ltx_tr" id="A4.T12.24.24">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A4.T12.24.24.5" rowspan="4"><span class="ltx_text" id="A4.T12.24.24.5.1">
<span class="ltx_tabular ltx_align_middle" id="A4.T12.24.24.5.1.1">
<span class="ltx_tr" id="A4.T12.24.24.5.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T12.24.24.5.1.1.1.1">RVRT</span></span>
<span class="ltx_tr" id="A4.T12.24.24.5.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T12.24.24.5.1.1.2.1"><cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib33" title="">33</a>]</cite></span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A4.T12.21.21.1"><math alttext="256\times 256\times 3" class="ltx_Math" display="inline" id="A4.T12.21.21.1.m1.1"><semantics id="A4.T12.21.21.1.m1.1a"><mrow id="A4.T12.21.21.1.m1.1.1" xref="A4.T12.21.21.1.m1.1.1.cmml"><mn id="A4.T12.21.21.1.m1.1.1.2" xref="A4.T12.21.21.1.m1.1.1.2.cmml">256</mn><mo id="A4.T12.21.21.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A4.T12.21.21.1.m1.1.1.1.cmml">×</mo><mn id="A4.T12.21.21.1.m1.1.1.3" xref="A4.T12.21.21.1.m1.1.1.3.cmml">256</mn><mo id="A4.T12.21.21.1.m1.1.1.1a" lspace="0.222em" rspace="0.222em" xref="A4.T12.21.21.1.m1.1.1.1.cmml">×</mo><mn id="A4.T12.21.21.1.m1.1.1.4" xref="A4.T12.21.21.1.m1.1.1.4.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T12.21.21.1.m1.1b"><apply id="A4.T12.21.21.1.m1.1.1.cmml" xref="A4.T12.21.21.1.m1.1.1"><times id="A4.T12.21.21.1.m1.1.1.1.cmml" xref="A4.T12.21.21.1.m1.1.1.1"></times><cn id="A4.T12.21.21.1.m1.1.1.2.cmml" type="integer" xref="A4.T12.21.21.1.m1.1.1.2">256</cn><cn id="A4.T12.21.21.1.m1.1.1.3.cmml" type="integer" xref="A4.T12.21.21.1.m1.1.1.3">256</cn><cn id="A4.T12.21.21.1.m1.1.1.4.cmml" type="integer" xref="A4.T12.21.21.1.m1.1.1.4">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T12.21.21.1.m1.1c">256\times 256\times 3</annotation><annotation encoding="application/x-llamapun" id="A4.T12.21.21.1.m1.1d">256 × 256 × 3</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="A4.T12.22.22.2"><math alttext="252" class="ltx_Math" display="inline" id="A4.T12.22.22.2.m1.1"><semantics id="A4.T12.22.22.2.m1.1a"><mn id="A4.T12.22.22.2.m1.1.1" xref="A4.T12.22.22.2.m1.1.1.cmml">252</mn><annotation-xml encoding="MathML-Content" id="A4.T12.22.22.2.m1.1b"><cn id="A4.T12.22.22.2.m1.1.1.cmml" type="integer" xref="A4.T12.22.22.2.m1.1.1">252</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.T12.22.22.2.m1.1c">252</annotation><annotation encoding="application/x-llamapun" id="A4.T12.22.22.2.m1.1d">252</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A4.T12.23.23.3"><math alttext="1182" class="ltx_Math" display="inline" id="A4.T12.23.23.3.m1.1"><semantics id="A4.T12.23.23.3.m1.1a"><mn id="A4.T12.23.23.3.m1.1.1" xref="A4.T12.23.23.3.m1.1.1.cmml">1182</mn><annotation-xml encoding="MathML-Content" id="A4.T12.23.23.3.m1.1b"><cn id="A4.T12.23.23.3.m1.1.1.cmml" type="integer" xref="A4.T12.23.23.3.m1.1.1">1182</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.T12.23.23.3.m1.1c">1182</annotation><annotation encoding="application/x-llamapun" id="A4.T12.23.23.3.m1.1d">1182</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T12.24.24.4"><math alttext="5480" class="ltx_Math" display="inline" id="A4.T12.24.24.4.m1.1"><semantics id="A4.T12.24.24.4.m1.1a"><mn id="A4.T12.24.24.4.m1.1.1" xref="A4.T12.24.24.4.m1.1.1.cmml">5480</mn><annotation-xml encoding="MathML-Content" id="A4.T12.24.24.4.m1.1b"><cn id="A4.T12.24.24.4.m1.1.1.cmml" type="integer" xref="A4.T12.24.24.4.m1.1.1">5480</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.T12.24.24.4.m1.1c">5480</annotation><annotation encoding="application/x-llamapun" id="A4.T12.24.24.4.m1.1d">5480</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A4.T12.28.28">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A4.T12.25.25.1"><math alttext="640\times 480\times 3" class="ltx_Math" display="inline" id="A4.T12.25.25.1.m1.1"><semantics id="A4.T12.25.25.1.m1.1a"><mrow id="A4.T12.25.25.1.m1.1.1" xref="A4.T12.25.25.1.m1.1.1.cmml"><mn id="A4.T12.25.25.1.m1.1.1.2" xref="A4.T12.25.25.1.m1.1.1.2.cmml">640</mn><mo id="A4.T12.25.25.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A4.T12.25.25.1.m1.1.1.1.cmml">×</mo><mn id="A4.T12.25.25.1.m1.1.1.3" xref="A4.T12.25.25.1.m1.1.1.3.cmml">480</mn><mo id="A4.T12.25.25.1.m1.1.1.1a" lspace="0.222em" rspace="0.222em" xref="A4.T12.25.25.1.m1.1.1.1.cmml">×</mo><mn id="A4.T12.25.25.1.m1.1.1.4" xref="A4.T12.25.25.1.m1.1.1.4.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T12.25.25.1.m1.1b"><apply id="A4.T12.25.25.1.m1.1.1.cmml" xref="A4.T12.25.25.1.m1.1.1"><times id="A4.T12.25.25.1.m1.1.1.1.cmml" xref="A4.T12.25.25.1.m1.1.1.1"></times><cn id="A4.T12.25.25.1.m1.1.1.2.cmml" type="integer" xref="A4.T12.25.25.1.m1.1.1.2">640</cn><cn id="A4.T12.25.25.1.m1.1.1.3.cmml" type="integer" xref="A4.T12.25.25.1.m1.1.1.3">480</cn><cn id="A4.T12.25.25.1.m1.1.1.4.cmml" type="integer" xref="A4.T12.25.25.1.m1.1.1.4">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T12.25.25.1.m1.1c">640\times 480\times 3</annotation><annotation encoding="application/x-llamapun" id="A4.T12.25.25.1.m1.1d">640 × 480 × 3</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="A4.T12.26.26.2"><math alttext="1240" class="ltx_Math" display="inline" id="A4.T12.26.26.2.m1.1"><semantics id="A4.T12.26.26.2.m1.1a"><mn id="A4.T12.26.26.2.m1.1.1" xref="A4.T12.26.26.2.m1.1.1.cmml">1240</mn><annotation-xml encoding="MathML-Content" id="A4.T12.26.26.2.m1.1b"><cn id="A4.T12.26.26.2.m1.1.1.cmml" type="integer" xref="A4.T12.26.26.2.m1.1.1">1240</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.T12.26.26.2.m1.1c">1240</annotation><annotation encoding="application/x-llamapun" id="A4.T12.26.26.2.m1.1d">1240</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A4.T12.27.27.3"><math alttext="10588" class="ltx_Math" display="inline" id="A4.T12.27.27.3.m1.1"><semantics id="A4.T12.27.27.3.m1.1a"><mn id="A4.T12.27.27.3.m1.1.1" xref="A4.T12.27.27.3.m1.1.1.cmml">10588</mn><annotation-xml encoding="MathML-Content" id="A4.T12.27.27.3.m1.1b"><cn id="A4.T12.27.27.3.m1.1.1.cmml" type="integer" xref="A4.T12.27.27.3.m1.1.1">10588</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.T12.27.27.3.m1.1c">10588</annotation><annotation encoding="application/x-llamapun" id="A4.T12.27.27.3.m1.1d">10588</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T12.28.28.4"><math alttext="21456" class="ltx_Math" display="inline" id="A4.T12.28.28.4.m1.1"><semantics id="A4.T12.28.28.4.m1.1a"><mn id="A4.T12.28.28.4.m1.1.1" xref="A4.T12.28.28.4.m1.1.1.cmml">21456</mn><annotation-xml encoding="MathML-Content" id="A4.T12.28.28.4.m1.1b"><cn id="A4.T12.28.28.4.m1.1.1.cmml" type="integer" xref="A4.T12.28.28.4.m1.1.1">21456</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.T12.28.28.4.m1.1c">21456</annotation><annotation encoding="application/x-llamapun" id="A4.T12.28.28.4.m1.1d">21456</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A4.T12.29.29">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A4.T12.29.29.1"><math alttext="1280\times 720\times 3" class="ltx_Math" display="inline" id="A4.T12.29.29.1.m1.1"><semantics id="A4.T12.29.29.1.m1.1a"><mrow id="A4.T12.29.29.1.m1.1.1" xref="A4.T12.29.29.1.m1.1.1.cmml"><mn id="A4.T12.29.29.1.m1.1.1.2" xref="A4.T12.29.29.1.m1.1.1.2.cmml">1280</mn><mo id="A4.T12.29.29.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A4.T12.29.29.1.m1.1.1.1.cmml">×</mo><mn id="A4.T12.29.29.1.m1.1.1.3" xref="A4.T12.29.29.1.m1.1.1.3.cmml">720</mn><mo id="A4.T12.29.29.1.m1.1.1.1a" lspace="0.222em" rspace="0.222em" xref="A4.T12.29.29.1.m1.1.1.1.cmml">×</mo><mn id="A4.T12.29.29.1.m1.1.1.4" xref="A4.T12.29.29.1.m1.1.1.4.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T12.29.29.1.m1.1b"><apply id="A4.T12.29.29.1.m1.1.1.cmml" xref="A4.T12.29.29.1.m1.1.1"><times id="A4.T12.29.29.1.m1.1.1.1.cmml" xref="A4.T12.29.29.1.m1.1.1.1"></times><cn id="A4.T12.29.29.1.m1.1.1.2.cmml" type="integer" xref="A4.T12.29.29.1.m1.1.1.2">1280</cn><cn id="A4.T12.29.29.1.m1.1.1.3.cmml" type="integer" xref="A4.T12.29.29.1.m1.1.1.3">720</cn><cn id="A4.T12.29.29.1.m1.1.1.4.cmml" type="integer" xref="A4.T12.29.29.1.m1.1.1.4">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T12.29.29.1.m1.1c">1280\times 720\times 3</annotation><annotation encoding="application/x-llamapun" id="A4.T12.29.29.1.m1.1d">1280 × 720 × 3</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="A4.T12.29.29.2"><span class="ltx_text ltx_font_typewriter" id="A4.T12.29.29.2.1" style="color:#FF0000;">OOM</span></td>
<td class="ltx_td ltx_align_center" id="A4.T12.29.29.3"><span class="ltx_text ltx_font_typewriter" id="A4.T12.29.29.3.1" style="color:#FF0000;">OOM</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T12.29.29.4"><span class="ltx_text ltx_font_typewriter" id="A4.T12.29.29.4.1" style="color:#FF0000;">OOM</span></td>
</tr>
<tr class="ltx_tr" id="A4.T12.30.30">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A4.T12.30.30.1"><math alttext="1920\times 1080\times 3" class="ltx_Math" display="inline" id="A4.T12.30.30.1.m1.1"><semantics id="A4.T12.30.30.1.m1.1a"><mrow id="A4.T12.30.30.1.m1.1.1" xref="A4.T12.30.30.1.m1.1.1.cmml"><mn id="A4.T12.30.30.1.m1.1.1.2" xref="A4.T12.30.30.1.m1.1.1.2.cmml">1920</mn><mo id="A4.T12.30.30.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A4.T12.30.30.1.m1.1.1.1.cmml">×</mo><mn id="A4.T12.30.30.1.m1.1.1.3" xref="A4.T12.30.30.1.m1.1.1.3.cmml">1080</mn><mo id="A4.T12.30.30.1.m1.1.1.1a" lspace="0.222em" rspace="0.222em" xref="A4.T12.30.30.1.m1.1.1.1.cmml">×</mo><mn id="A4.T12.30.30.1.m1.1.1.4" xref="A4.T12.30.30.1.m1.1.1.4.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T12.30.30.1.m1.1b"><apply id="A4.T12.30.30.1.m1.1.1.cmml" xref="A4.T12.30.30.1.m1.1.1"><times id="A4.T12.30.30.1.m1.1.1.1.cmml" xref="A4.T12.30.30.1.m1.1.1.1"></times><cn id="A4.T12.30.30.1.m1.1.1.2.cmml" type="integer" xref="A4.T12.30.30.1.m1.1.1.2">1920</cn><cn id="A4.T12.30.30.1.m1.1.1.3.cmml" type="integer" xref="A4.T12.30.30.1.m1.1.1.3">1080</cn><cn id="A4.T12.30.30.1.m1.1.1.4.cmml" type="integer" xref="A4.T12.30.30.1.m1.1.1.4">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T12.30.30.1.m1.1c">1920\times 1080\times 3</annotation><annotation encoding="application/x-llamapun" id="A4.T12.30.30.1.m1.1d">1920 × 1080 × 3</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="A4.T12.30.30.2"><span class="ltx_text ltx_font_typewriter" id="A4.T12.30.30.2.1" style="color:#FF0000;">OOM</span></td>
<td class="ltx_td ltx_align_center" id="A4.T12.30.30.3"><span class="ltx_text ltx_font_typewriter" id="A4.T12.30.30.3.1" style="color:#FF0000;">OOM</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T12.30.30.4"><span class="ltx_text ltx_font_typewriter" id="A4.T12.30.30.4.1" style="color:#FF0000;">OOM</span></td>
</tr>
<tr class="ltx_tr" id="A4.T12.34.34">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_tt" id="A4.T12.34.34.5" rowspan="4"><span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="A4.T12.34.34.5.1">turtle</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" id="A4.T12.31.31.1" style="background-color:#D1E9F6;"><span class="ltx_text" id="A4.T12.31.31.1.1" style="background-color:#D1E9F6;"><math alttext="256\times 256\times 3" class="ltx_Math" display="inline" id="A4.T12.31.31.1.1.m1.1"><semantics id="A4.T12.31.31.1.1.m1.1a"><mrow id="A4.T12.31.31.1.1.m1.1.1" xref="A4.T12.31.31.1.1.m1.1.1.cmml"><mn id="A4.T12.31.31.1.1.m1.1.1.2" mathbackground="#D1E9F6" xref="A4.T12.31.31.1.1.m1.1.1.2.cmml">256</mn><mo id="A4.T12.31.31.1.1.m1.1.1.1" lspace="0.222em" mathbackground="#D1E9F6" rspace="0.222em" xref="A4.T12.31.31.1.1.m1.1.1.1.cmml">×</mo><mn id="A4.T12.31.31.1.1.m1.1.1.3" mathbackground="#D1E9F6" xref="A4.T12.31.31.1.1.m1.1.1.3.cmml">256</mn><mo id="A4.T12.31.31.1.1.m1.1.1.1a" lspace="0.222em" mathbackground="#D1E9F6" rspace="0.222em" xref="A4.T12.31.31.1.1.m1.1.1.1.cmml">×</mo><mn id="A4.T12.31.31.1.1.m1.1.1.4" mathbackground="#D1E9F6" xref="A4.T12.31.31.1.1.m1.1.1.4.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T12.31.31.1.1.m1.1b"><apply id="A4.T12.31.31.1.1.m1.1.1.cmml" xref="A4.T12.31.31.1.1.m1.1.1"><times id="A4.T12.31.31.1.1.m1.1.1.1.cmml" xref="A4.T12.31.31.1.1.m1.1.1.1"></times><cn id="A4.T12.31.31.1.1.m1.1.1.2.cmml" type="integer" xref="A4.T12.31.31.1.1.m1.1.1.2">256</cn><cn id="A4.T12.31.31.1.1.m1.1.1.3.cmml" type="integer" xref="A4.T12.31.31.1.1.m1.1.1.3">256</cn><cn id="A4.T12.31.31.1.1.m1.1.1.4.cmml" type="integer" xref="A4.T12.31.31.1.1.m1.1.1.4">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T12.31.31.1.1.m1.1c">256\times 256\times 3</annotation><annotation encoding="application/x-llamapun" id="A4.T12.31.31.1.1.m1.1d">256 × 256 × 3</annotation></semantics></math></span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A4.T12.32.32.2" style="background-color:#D1E9F6;"><span class="ltx_text" id="A4.T12.32.32.2.1" style="background-color:#D1E9F6;"><math alttext="95" class="ltx_Math" display="inline" id="A4.T12.32.32.2.1.m1.1"><semantics id="A4.T12.32.32.2.1.m1.1a"><mn id="A4.T12.32.32.2.1.m1.1.1" mathbackground="#D1E9F6" xref="A4.T12.32.32.2.1.m1.1.1.cmml">95</mn><annotation-xml encoding="MathML-Content" id="A4.T12.32.32.2.1.m1.1b"><cn id="A4.T12.32.32.2.1.m1.1.1.cmml" type="integer" xref="A4.T12.32.32.2.1.m1.1.1">95</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.T12.32.32.2.1.m1.1c">95</annotation><annotation encoding="application/x-llamapun" id="A4.T12.32.32.2.1.m1.1d">95</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A4.T12.33.33.3" style="background-color:#D1E9F6;"><span class="ltx_text" id="A4.T12.33.33.3.1" style="background-color:#D1E9F6;"><math alttext="181" class="ltx_Math" display="inline" id="A4.T12.33.33.3.1.m1.1"><semantics id="A4.T12.33.33.3.1.m1.1a"><mn id="A4.T12.33.33.3.1.m1.1.1" mathbackground="#D1E9F6" xref="A4.T12.33.33.3.1.m1.1.1.cmml">181</mn><annotation-xml encoding="MathML-Content" id="A4.T12.33.33.3.1.m1.1b"><cn id="A4.T12.33.33.3.1.m1.1.1.cmml" type="integer" xref="A4.T12.33.33.3.1.m1.1.1">181</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.T12.33.33.3.1.m1.1c">181</annotation><annotation encoding="application/x-llamapun" id="A4.T12.33.33.3.1.m1.1d">181</annotation></semantics></math></span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_tt" id="A4.T12.34.34.4" style="background-color:#D1E9F6;"><span class="ltx_text" id="A4.T12.34.34.4.1" style="background-color:#D1E9F6;"><math alttext="2004" class="ltx_Math" display="inline" id="A4.T12.34.34.4.1.m1.1"><semantics id="A4.T12.34.34.4.1.m1.1a"><mn id="A4.T12.34.34.4.1.m1.1.1" mathbackground="#D1E9F6" xref="A4.T12.34.34.4.1.m1.1.1.cmml">2004</mn><annotation-xml encoding="MathML-Content" id="A4.T12.34.34.4.1.m1.1b"><cn id="A4.T12.34.34.4.1.m1.1.1.cmml" type="integer" xref="A4.T12.34.34.4.1.m1.1.1">2004</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.T12.34.34.4.1.m1.1c">2004</annotation><annotation encoding="application/x-llamapun" id="A4.T12.34.34.4.1.m1.1d">2004</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="A4.T12.38.38">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A4.T12.35.35.1" style="background-color:#D1E9F6;"><span class="ltx_text" id="A4.T12.35.35.1.1" style="background-color:#D1E9F6;"><math alttext="640\times 480\times 3" class="ltx_Math" display="inline" id="A4.T12.35.35.1.1.m1.1"><semantics id="A4.T12.35.35.1.1.m1.1a"><mrow id="A4.T12.35.35.1.1.m1.1.1" xref="A4.T12.35.35.1.1.m1.1.1.cmml"><mn id="A4.T12.35.35.1.1.m1.1.1.2" mathbackground="#D1E9F6" xref="A4.T12.35.35.1.1.m1.1.1.2.cmml">640</mn><mo id="A4.T12.35.35.1.1.m1.1.1.1" lspace="0.222em" mathbackground="#D1E9F6" rspace="0.222em" xref="A4.T12.35.35.1.1.m1.1.1.1.cmml">×</mo><mn id="A4.T12.35.35.1.1.m1.1.1.3" mathbackground="#D1E9F6" xref="A4.T12.35.35.1.1.m1.1.1.3.cmml">480</mn><mo id="A4.T12.35.35.1.1.m1.1.1.1a" lspace="0.222em" mathbackground="#D1E9F6" rspace="0.222em" xref="A4.T12.35.35.1.1.m1.1.1.1.cmml">×</mo><mn id="A4.T12.35.35.1.1.m1.1.1.4" mathbackground="#D1E9F6" xref="A4.T12.35.35.1.1.m1.1.1.4.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T12.35.35.1.1.m1.1b"><apply id="A4.T12.35.35.1.1.m1.1.1.cmml" xref="A4.T12.35.35.1.1.m1.1.1"><times id="A4.T12.35.35.1.1.m1.1.1.1.cmml" xref="A4.T12.35.35.1.1.m1.1.1.1"></times><cn id="A4.T12.35.35.1.1.m1.1.1.2.cmml" type="integer" xref="A4.T12.35.35.1.1.m1.1.1.2">640</cn><cn id="A4.T12.35.35.1.1.m1.1.1.3.cmml" type="integer" xref="A4.T12.35.35.1.1.m1.1.1.3">480</cn><cn id="A4.T12.35.35.1.1.m1.1.1.4.cmml" type="integer" xref="A4.T12.35.35.1.1.m1.1.1.4">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T12.35.35.1.1.m1.1c">640\times 480\times 3</annotation><annotation encoding="application/x-llamapun" id="A4.T12.35.35.1.1.m1.1d">640 × 480 × 3</annotation></semantics></math></span></th>
<td class="ltx_td ltx_align_center" id="A4.T12.36.36.2" style="background-color:#D1E9F6;"><span class="ltx_text" id="A4.T12.36.36.2.1" style="background-color:#D1E9F6;"><math alttext="380" class="ltx_Math" display="inline" id="A4.T12.36.36.2.1.m1.1"><semantics id="A4.T12.36.36.2.1.m1.1a"><mn id="A4.T12.36.36.2.1.m1.1.1" mathbackground="#D1E9F6" xref="A4.T12.36.36.2.1.m1.1.1.cmml">380</mn><annotation-xml encoding="MathML-Content" id="A4.T12.36.36.2.1.m1.1b"><cn id="A4.T12.36.36.2.1.m1.1.1.cmml" type="integer" xref="A4.T12.36.36.2.1.m1.1.1">380</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.T12.36.36.2.1.m1.1c">380</annotation><annotation encoding="application/x-llamapun" id="A4.T12.36.36.2.1.m1.1d">380</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center" id="A4.T12.37.37.3" style="background-color:#D1E9F6;"><span class="ltx_text" id="A4.T12.37.37.3.1" style="background-color:#D1E9F6;"><math alttext="812" class="ltx_Math" display="inline" id="A4.T12.37.37.3.1.m1.1"><semantics id="A4.T12.37.37.3.1.m1.1a"><mn id="A4.T12.37.37.3.1.m1.1.1" mathbackground="#D1E9F6" xref="A4.T12.37.37.3.1.m1.1.1.cmml">812</mn><annotation-xml encoding="MathML-Content" id="A4.T12.37.37.3.1.m1.1b"><cn id="A4.T12.37.37.3.1.m1.1.1.cmml" type="integer" xref="A4.T12.37.37.3.1.m1.1.1">812</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.T12.37.37.3.1.m1.1c">812</annotation><annotation encoding="application/x-llamapun" id="A4.T12.37.37.3.1.m1.1d">812</annotation></semantics></math></span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T12.38.38.4" style="background-color:#D1E9F6;"><span class="ltx_text" id="A4.T12.38.38.4.1" style="background-color:#D1E9F6;"><math alttext="4826" class="ltx_Math" display="inline" id="A4.T12.38.38.4.1.m1.1"><semantics id="A4.T12.38.38.4.1.m1.1a"><mn id="A4.T12.38.38.4.1.m1.1.1" mathbackground="#D1E9F6" xref="A4.T12.38.38.4.1.m1.1.1.cmml">4826</mn><annotation-xml encoding="MathML-Content" id="A4.T12.38.38.4.1.m1.1b"><cn id="A4.T12.38.38.4.1.m1.1.1.cmml" type="integer" xref="A4.T12.38.38.4.1.m1.1.1">4826</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.T12.38.38.4.1.m1.1c">4826</annotation><annotation encoding="application/x-llamapun" id="A4.T12.38.38.4.1.m1.1d">4826</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="A4.T12.42.42">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A4.T12.39.39.1" style="background-color:#D1E9F6;"><span class="ltx_text" id="A4.T12.39.39.1.1" style="background-color:#D1E9F6;"><math alttext="1280\times 720\times 3" class="ltx_Math" display="inline" id="A4.T12.39.39.1.1.m1.1"><semantics id="A4.T12.39.39.1.1.m1.1a"><mrow id="A4.T12.39.39.1.1.m1.1.1" xref="A4.T12.39.39.1.1.m1.1.1.cmml"><mn id="A4.T12.39.39.1.1.m1.1.1.2" mathbackground="#D1E9F6" xref="A4.T12.39.39.1.1.m1.1.1.2.cmml">1280</mn><mo id="A4.T12.39.39.1.1.m1.1.1.1" lspace="0.222em" mathbackground="#D1E9F6" rspace="0.222em" xref="A4.T12.39.39.1.1.m1.1.1.1.cmml">×</mo><mn id="A4.T12.39.39.1.1.m1.1.1.3" mathbackground="#D1E9F6" xref="A4.T12.39.39.1.1.m1.1.1.3.cmml">720</mn><mo id="A4.T12.39.39.1.1.m1.1.1.1a" lspace="0.222em" mathbackground="#D1E9F6" rspace="0.222em" xref="A4.T12.39.39.1.1.m1.1.1.1.cmml">×</mo><mn id="A4.T12.39.39.1.1.m1.1.1.4" mathbackground="#D1E9F6" xref="A4.T12.39.39.1.1.m1.1.1.4.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T12.39.39.1.1.m1.1b"><apply id="A4.T12.39.39.1.1.m1.1.1.cmml" xref="A4.T12.39.39.1.1.m1.1.1"><times id="A4.T12.39.39.1.1.m1.1.1.1.cmml" xref="A4.T12.39.39.1.1.m1.1.1.1"></times><cn id="A4.T12.39.39.1.1.m1.1.1.2.cmml" type="integer" xref="A4.T12.39.39.1.1.m1.1.1.2">1280</cn><cn id="A4.T12.39.39.1.1.m1.1.1.3.cmml" type="integer" xref="A4.T12.39.39.1.1.m1.1.1.3">720</cn><cn id="A4.T12.39.39.1.1.m1.1.1.4.cmml" type="integer" xref="A4.T12.39.39.1.1.m1.1.1.4">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T12.39.39.1.1.m1.1c">1280\times 720\times 3</annotation><annotation encoding="application/x-llamapun" id="A4.T12.39.39.1.1.m1.1d">1280 × 720 × 3</annotation></semantics></math></span></th>
<td class="ltx_td ltx_align_center" id="A4.T12.40.40.2" style="background-color:#D1E9F6;"><span class="ltx_text" id="A4.T12.40.40.2.1" style="background-color:#D1E9F6;"><math alttext="1180" class="ltx_Math" display="inline" id="A4.T12.40.40.2.1.m1.1"><semantics id="A4.T12.40.40.2.1.m1.1a"><mn id="A4.T12.40.40.2.1.m1.1.1" mathbackground="#D1E9F6" xref="A4.T12.40.40.2.1.m1.1.1.cmml">1180</mn><annotation-xml encoding="MathML-Content" id="A4.T12.40.40.2.1.m1.1b"><cn id="A4.T12.40.40.2.1.m1.1.1.cmml" type="integer" xref="A4.T12.40.40.2.1.m1.1.1">1180</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.T12.40.40.2.1.m1.1c">1180</annotation><annotation encoding="application/x-llamapun" id="A4.T12.40.40.2.1.m1.1d">1180</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center" id="A4.T12.41.41.3" style="background-color:#D1E9F6;"><span class="ltx_text" id="A4.T12.41.41.3.1" style="background-color:#D1E9F6;"><math alttext="2490" class="ltx_Math" display="inline" id="A4.T12.41.41.3.1.m1.1"><semantics id="A4.T12.41.41.3.1.m1.1a"><mn id="A4.T12.41.41.3.1.m1.1.1" mathbackground="#D1E9F6" xref="A4.T12.41.41.3.1.m1.1.1.cmml">2490</mn><annotation-xml encoding="MathML-Content" id="A4.T12.41.41.3.1.m1.1b"><cn id="A4.T12.41.41.3.1.m1.1.1.cmml" type="integer" xref="A4.T12.41.41.3.1.m1.1.1">2490</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.T12.41.41.3.1.m1.1c">2490</annotation><annotation encoding="application/x-llamapun" id="A4.T12.41.41.3.1.m1.1d">2490</annotation></semantics></math></span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T12.42.42.4" style="background-color:#D1E9F6;"><span class="ltx_text" id="A4.T12.42.42.4.1" style="background-color:#D1E9F6;"><math alttext="11994" class="ltx_Math" display="inline" id="A4.T12.42.42.4.1.m1.1"><semantics id="A4.T12.42.42.4.1.m1.1a"><mn id="A4.T12.42.42.4.1.m1.1.1" mathbackground="#D1E9F6" xref="A4.T12.42.42.4.1.m1.1.1.cmml">11994</mn><annotation-xml encoding="MathML-Content" id="A4.T12.42.42.4.1.m1.1b"><cn id="A4.T12.42.42.4.1.m1.1.1.cmml" type="integer" xref="A4.T12.42.42.4.1.m1.1.1">11994</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.T12.42.42.4.1.m1.1c">11994</annotation><annotation encoding="application/x-llamapun" id="A4.T12.42.42.4.1.m1.1d">11994</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="A4.T12.46.46">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="A4.T12.43.43.1" style="background-color:#D1E9F6;"><span class="ltx_text" id="A4.T12.43.43.1.1" style="background-color:#D1E9F6;"><math alttext="1920\times 1080\times 3" class="ltx_Math" display="inline" id="A4.T12.43.43.1.1.m1.1"><semantics id="A4.T12.43.43.1.1.m1.1a"><mrow id="A4.T12.43.43.1.1.m1.1.1" xref="A4.T12.43.43.1.1.m1.1.1.cmml"><mn id="A4.T12.43.43.1.1.m1.1.1.2" mathbackground="#D1E9F6" xref="A4.T12.43.43.1.1.m1.1.1.2.cmml">1920</mn><mo id="A4.T12.43.43.1.1.m1.1.1.1" lspace="0.222em" mathbackground="#D1E9F6" rspace="0.222em" xref="A4.T12.43.43.1.1.m1.1.1.1.cmml">×</mo><mn id="A4.T12.43.43.1.1.m1.1.1.3" mathbackground="#D1E9F6" xref="A4.T12.43.43.1.1.m1.1.1.3.cmml">1080</mn><mo id="A4.T12.43.43.1.1.m1.1.1.1a" lspace="0.222em" mathbackground="#D1E9F6" rspace="0.222em" xref="A4.T12.43.43.1.1.m1.1.1.1.cmml">×</mo><mn id="A4.T12.43.43.1.1.m1.1.1.4" mathbackground="#D1E9F6" xref="A4.T12.43.43.1.1.m1.1.1.4.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T12.43.43.1.1.m1.1b"><apply id="A4.T12.43.43.1.1.m1.1.1.cmml" xref="A4.T12.43.43.1.1.m1.1.1"><times id="A4.T12.43.43.1.1.m1.1.1.1.cmml" xref="A4.T12.43.43.1.1.m1.1.1.1"></times><cn id="A4.T12.43.43.1.1.m1.1.1.2.cmml" type="integer" xref="A4.T12.43.43.1.1.m1.1.1.2">1920</cn><cn id="A4.T12.43.43.1.1.m1.1.1.3.cmml" type="integer" xref="A4.T12.43.43.1.1.m1.1.1.3">1080</cn><cn id="A4.T12.43.43.1.1.m1.1.1.4.cmml" type="integer" xref="A4.T12.43.43.1.1.m1.1.1.4">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T12.43.43.1.1.m1.1c">1920\times 1080\times 3</annotation><annotation encoding="application/x-llamapun" id="A4.T12.43.43.1.1.m1.1d">1920 × 1080 × 3</annotation></semantics></math></span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T12.44.44.2" style="background-color:#D1E9F6;"><span class="ltx_text" id="A4.T12.44.44.2.1" style="background-color:#D1E9F6;"><math alttext="2690" class="ltx_Math" display="inline" id="A4.T12.44.44.2.1.m1.1"><semantics id="A4.T12.44.44.2.1.m1.1a"><mn id="A4.T12.44.44.2.1.m1.1.1" mathbackground="#D1E9F6" xref="A4.T12.44.44.2.1.m1.1.1.cmml">2690</mn><annotation-xml encoding="MathML-Content" id="A4.T12.44.44.2.1.m1.1b"><cn id="A4.T12.44.44.2.1.m1.1.1.cmml" type="integer" xref="A4.T12.44.44.2.1.m1.1.1">2690</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.T12.44.44.2.1.m1.1c">2690</annotation><annotation encoding="application/x-llamapun" id="A4.T12.44.44.2.1.m1.1d">2690</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T12.45.45.3" style="background-color:#D1E9F6;"><span class="ltx_text" id="A4.T12.45.45.3.1" style="background-color:#D1E9F6;"><math alttext="5527" class="ltx_Math" display="inline" id="A4.T12.45.45.3.1.m1.1"><semantics id="A4.T12.45.45.3.1.m1.1a"><mn id="A4.T12.45.45.3.1.m1.1.1" mathbackground="#D1E9F6" xref="A4.T12.45.45.3.1.m1.1.1.cmml">5527</mn><annotation-xml encoding="MathML-Content" id="A4.T12.45.45.3.1.m1.1b"><cn id="A4.T12.45.45.3.1.m1.1.1.cmml" type="integer" xref="A4.T12.45.45.3.1.m1.1.1">5527</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.T12.45.45.3.1.m1.1c">5527</annotation><annotation encoding="application/x-llamapun" id="A4.T12.45.45.3.1.m1.1d">5527</annotation></semantics></math></span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" id="A4.T12.46.46.4" style="background-color:#D1E9F6;"><span class="ltx_text" id="A4.T12.46.46.4.1" style="background-color:#D1E9F6;"><math alttext="24938" class="ltx_Math" display="inline" id="A4.T12.46.46.4.1.m1.1"><semantics id="A4.T12.46.46.4.1.m1.1a"><mn id="A4.T12.46.46.4.1.m1.1.1" mathbackground="#D1E9F6" xref="A4.T12.46.46.4.1.m1.1.1.cmml">24938</mn><annotation-xml encoding="MathML-Content" id="A4.T12.46.46.4.1.m1.1b"><cn id="A4.T12.46.46.4.1.m1.1.1.cmml" type="integer" xref="A4.T12.46.46.4.1.m1.1.1">24938</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.T12.46.46.4.1.m1.1c">24938</annotation><annotation encoding="application/x-llamapun" id="A4.T12.46.46.4.1.m1.1d">24938</annotation></semantics></math></span></td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section class="ltx_appendix" id="A5">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Computational Profile of <span class="ltx_text ltx_font_smallcaps" id="A5.1.1">Turtle</span>
</h2>
<div class="ltx_para" id="A5.p1">
<p class="ltx_p" id="A5.p1.4">In <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#A4.T12" title="In D.5 Real-World Video Deblurring ‣ Appendix D Further Visual Comparisons ‣ Learning Truncated Causal History Model for Video Restoration"><span class="ltx_text ltx_ref_tag">table</span> <span class="ltx_text ltx_ref_tag">12</span></a>, we report the runtime analysis of the proposed method <span class="ltx_text ltx_font_smallcaps" id="A5.p1.4.1">turtle</span> on a single 32GB V100 GPU, and compare it with three representative general video restoration methods in the literature, namely ShiftNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib29" title="">29</a>]</cite>, VRT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib34" title="">34</a>]</cite>, and RVRT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib33" title="">33</a>]</cite>. We consider four different input resolutions varying from <math alttext="(256\times 256\times 3)" class="ltx_Math" display="inline" id="A5.p1.1.m1.1"><semantics id="A5.p1.1.m1.1a"><mrow id="A5.p1.1.m1.1.1.1" xref="A5.p1.1.m1.1.1.1.1.cmml"><mo id="A5.p1.1.m1.1.1.1.2" stretchy="false" xref="A5.p1.1.m1.1.1.1.1.cmml">(</mo><mrow id="A5.p1.1.m1.1.1.1.1" xref="A5.p1.1.m1.1.1.1.1.cmml"><mn id="A5.p1.1.m1.1.1.1.1.2" xref="A5.p1.1.m1.1.1.1.1.2.cmml">256</mn><mo id="A5.p1.1.m1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A5.p1.1.m1.1.1.1.1.1.cmml">×</mo><mn id="A5.p1.1.m1.1.1.1.1.3" xref="A5.p1.1.m1.1.1.1.1.3.cmml">256</mn><mo id="A5.p1.1.m1.1.1.1.1.1a" lspace="0.222em" rspace="0.222em" xref="A5.p1.1.m1.1.1.1.1.1.cmml">×</mo><mn id="A5.p1.1.m1.1.1.1.1.4" xref="A5.p1.1.m1.1.1.1.1.4.cmml">3</mn></mrow><mo id="A5.p1.1.m1.1.1.1.3" stretchy="false" xref="A5.p1.1.m1.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A5.p1.1.m1.1b"><apply id="A5.p1.1.m1.1.1.1.1.cmml" xref="A5.p1.1.m1.1.1.1"><times id="A5.p1.1.m1.1.1.1.1.1.cmml" xref="A5.p1.1.m1.1.1.1.1.1"></times><cn id="A5.p1.1.m1.1.1.1.1.2.cmml" type="integer" xref="A5.p1.1.m1.1.1.1.1.2">256</cn><cn id="A5.p1.1.m1.1.1.1.1.3.cmml" type="integer" xref="A5.p1.1.m1.1.1.1.1.3">256</cn><cn id="A5.p1.1.m1.1.1.1.1.4.cmml" type="integer" xref="A5.p1.1.m1.1.1.1.1.4">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.1.m1.1c">(256\times 256\times 3)</annotation><annotation encoding="application/x-llamapun" id="A5.p1.1.m1.1d">( 256 × 256 × 3 )</annotation></semantics></math> to <math alttext="1080" class="ltx_Math" display="inline" id="A5.p1.2.m2.1"><semantics id="A5.p1.2.m2.1a"><mn id="A5.p1.2.m2.1.1" xref="A5.p1.2.m2.1.1.cmml">1080</mn><annotation-xml encoding="MathML-Content" id="A5.p1.2.m2.1b"><cn id="A5.p1.2.m2.1.1.cmml" type="integer" xref="A5.p1.2.m2.1.1">1080</cn></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.2.m2.1c">1080</annotation><annotation encoding="application/x-llamapun" id="A5.p1.2.m2.1d">1080</annotation></semantics></math>p. Prior methods exhibit exponential growth in GPU memory requirements as the resolution increases, <span class="ltx_text ltx_font_smallcaps" id="A5.p1.4.2">turtle</span>, however, features linear scaling in GPU memory usage, underscoring its computational efficiency advantage. As the resolution increases beyond <math alttext="480" class="ltx_Math" display="inline" id="A5.p1.3.m3.1"><semantics id="A5.p1.3.m3.1a"><mn id="A5.p1.3.m3.1.1" xref="A5.p1.3.m3.1.1.cmml">480</mn><annotation-xml encoding="MathML-Content" id="A5.p1.3.m3.1b"><cn id="A5.p1.3.m3.1.1.cmml" type="integer" xref="A5.p1.3.m3.1.1">480</cn></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.3.m3.1c">480</annotation><annotation encoding="application/x-llamapun" id="A5.p1.3.m3.1d">480</annotation></semantics></math>p, all of the previous methods throw <span class="ltx_text ltx_font_typewriter" id="A5.p1.4.3" style="color:#FF0000;">OOM</span> (Out-of-Memory) errors indicating that the memory requirement exceeded the total available memory (of 32GB). On the flip side, <span class="ltx_text ltx_font_smallcaps" id="A5.p1.4.4">Turtle</span> can process the videos even at a resolution of <math alttext="1080" class="ltx_Math" display="inline" id="A5.p1.4.m4.1"><semantics id="A5.p1.4.m4.1a"><mn id="A5.p1.4.m4.1.1" xref="A5.p1.4.m4.1.1.cmml">1080</mn><annotation-xml encoding="MathML-Content" id="A5.p1.4.m4.1b"><cn id="A5.p1.4.m4.1.1.cmml" type="integer" xref="A5.p1.4.m4.1.1">1080</cn></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.4.m4.1c">1080</annotation><annotation encoding="application/x-llamapun" id="A5.p1.4.m4.1d">1080</annotation></semantics></math>p on the same GPU.</p>
</div>
</section>
<section class="ltx_appendix" id="A6">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix F </span>Additional Literature Review</h2>
<div class="ltx_para" id="A6.p1">
<p class="ltx_p" id="A6.p1.1">We further the discussion on prior art in the literature in terms of temporal modeling of videos, and causal learning.</p>
</div>
<section class="ltx_paragraph" id="A6.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Temporal Modeling.</h4>
<div class="ltx_para" id="A6.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="A6.SS0.SSS0.Px1.p1.1">In video restoration, temporal modeling mainly focuses on how the neighboring frames (either in history or in the future) can be utilized to restore the current frame better. For such a procedure, the first step usually involves compensating for motion either through explicit methods (such as using optical flow <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib33" title="">33</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib34" title="">34</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib36" title="">36</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib7" title="">7</a>]</cite>), or implicitly (such as deformable convolutions <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib63" title="">63</a>]</cite>, search approaches <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib64" title="">64</a>]</cite>, or temporal shift <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib29" title="">29</a>]</cite>). A few works in the literature focus on reasoning at the trajectory level (i.e., considering the entire frame sequence of a video) [36] through learning to form trajectories of each pixel (or some group of pixels). The motivation is that in this case, each pixel can borrow information from the entire trajectory instead of focusing on a limited context. The second step is then aggregating such information, where in the case of Transformers, attention is employed, while MLPs are also used in other cases.</p>
</div>
</section>
<section class="ltx_paragraph" id="A6.SS0.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Causal Learning in Videos.</h4>
<div class="ltx_para" id="A6.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="A6.SS0.SSS0.Px2.p1.1">In videos, causal learning is generally explored in the context of self-supervised learning to learn representations from long-context videos with downstream applications to various video tasks such as action recognition, activity understanding, etc <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib50" title="">50</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib73" title="">73</a>]</cite>. In <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib2" title="">2</a>]</cite>, causal masking of several frames at various spatio-temporal regions as a strategy to learn the representations is explored. To the best of our knowledge, other than one streaming video denoising method <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib49" title="">49</a>]</cite>, almost all of the state-of-the-art video restoration methods are not causal by design since they rely on forward and backward feature propagation (i.e., they consider both frames in history and in the future) either aligned with the optical flow or otherwise <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib6" title="">6</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib7" title="">7</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib33" title="">33</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib29" title="">29</a>]</cite>. However, there is significant amount of work on causal representation learning where the aim is to recover the process generating the data from the observation to learn the disentangled latent representation. Note that this is out of the scope of this work.</p>
</div>
</section>
</section>
<section class="ltx_appendix" id="A7">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix G </span>Dataset Information &amp; Summary</h2>
<div class="ltx_para" id="A7.p1">
<p class="ltx_p" id="A7.p1.1">All of the experiments presented in this manuscript employ publicly available datasets that are disseminated for the purpose of scientific research on video/image restoration. All of the datasets employed are cited wherever they are referred to in the manuscript, and we summarize the details here.</p>
<ul class="ltx_itemize" id="A7.I1">
<li class="ltx_item" id="A7.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A7.I1.i1.p1">
<p class="ltx_p" id="A7.I1.i1.p1.1">Video Desnowing: We utilize the video desnowing dataset introduced in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib10" title="">10</a>]</cite>. The dataset is made available by the authors at the link: <a class="ltx_ref ltx_href" href="https://haoyuchen.com/VideoDesnowing" title="">Video Desnowing</a></p>
</div>
</li>
<li class="ltx_item" id="A7.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A7.I1.i2.p1">
<p class="ltx_p" id="A7.I1.i2.p1.1">Video Nighttime Deraining: We utilize the nighttime video deraining dataset introduced in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib47" title="">47</a>]</cite>. The dataset is made available by the authors at the link: <a class="ltx_ref ltx_href" href="https://github.com/pwp1208/Meta_Video_Restoration?tab=readme-ov-file" title="">Nighttime Deraining</a></p>
</div>
</li>
<li class="ltx_item" id="A7.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A7.I1.i3.p1">
<p class="ltx_p" id="A7.I1.i3.p1.1">Video Raindrops and Rain Streaks Removal: We utilize the video raindrops and rain streaks removal (VRDS) dataset introduced in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib71" title="">71</a>]</cite>. The dataset is made available by the authors at the link: <a class="ltx_ref ltx_href" href="https://github.com/TonyHongtaoWu/ViMP-Net?tab=readme-ov-file" title="">VRDS</a></p>
</div>
</li>
<li class="ltx_item" id="A7.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A7.I1.i4.p1">
<p class="ltx_p" id="A7.I1.i4.p1.1">Synthetic Video Deblurring: We employ the GOPRO dataset introduced in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib41" title="">41</a>]</cite>. The dataset is made available by the authors at the link: <a class="ltx_ref ltx_href" href="https://seungjunnah.github.io/Datasets/gopro" title="">GOPRO</a></p>
</div>
</li>
<li class="ltx_item" id="A7.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A7.I1.i5.p1">
<p class="ltx_p" id="A7.I1.i5.p1.1">Real Video Deblurring: We employ the BSD dataset introduced in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib82" title="">82</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib83" title="">83</a>]</cite>. The dataset is made available by the authors at the link: <a class="ltx_ref ltx_href" href="https://github.com/zzh-tech/ESTRNN" title="">BSD</a></p>
</div>
</li>
<li class="ltx_item" id="A7.I1.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A7.I1.i6.p1">
<p class="ltx_p" id="A7.I1.i6.p1.1">Real-World Video Super Resolution: We utilize the MVSR dataset introduced in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib67" title="">67</a>]</cite>. The dataset is made available by the authors at the link: <a class="ltx_ref ltx_href" href="https://github.com/HITRainer/EAVSR" title="">MVSR</a></p>
</div>
</li>
<li class="ltx_item" id="A7.I1.i7" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A7.I1.i7.p1">
<p class="ltx_p" id="A7.I1.i7.p1.1">Video Denoising: We employ DAVIS <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib48" title="">48</a>]</cite>, and Set8 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03936v1#bib.bib61" title="">61</a>]</cite> datasets for video denoising. The datasets are available at: <a class="ltx_ref ltx_href" href="https://davischallenge.org/" title="">DAVIS-2017</a>, <a class="ltx_ref ltx_href" href="https://media.xiph.org/video/derf/" title="">Set8</a> [4 sequences], and <a class="ltx_ref ltx_href" href="https://drive.google.com/drive/folders/11chLkbcX-oKGLOLONuDpXZM2-vujn_KD?usp=sharing" title="">Set8</a> [4 sequences]</p>
</div>
</li>
</ul>
</div>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Fri Oct  4 21:26:28 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
