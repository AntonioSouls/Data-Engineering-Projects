<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2212.08296] DQnet: Cross-Model Detail Querying for Camouflaged Object Detection</title><meta property="og:description" content="Camouflaged objects are seamlessly blended in with their surroundings, which brings a challenging detection task in computer vision. Optimizing a convolutional neural network (CNN) for camouflaged object detection (COD…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="DQnet: Cross-Model Detail Querying for Camouflaged Object Detection">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="DQnet: Cross-Model Detail Querying for Camouflaged Object Detection">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2212.08296">

<!--Generated on Fri Mar  1 10:57:28 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">DQnet: Cross-Model Detail Querying for Camouflaged Object Detection</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Wei Sun<sup id="id13.13.id1" class="ltx_sup">1</sup>
 Chengao Liu<sup id="id14.14.id2" class="ltx_sup">1</sup>
 Linyan Zhang<sup id="id15.15.id3" class="ltx_sup">1</sup>
 Yu Li<sup id="id16.16.id4" class="ltx_sup">1</sup>
 Pengxu Wei<sup id="id17.17.id5" class="ltx_sup">3</sup>
 Chang Liu<sup id="id18.18.id6" class="ltx_sup">2</sup>

<br class="ltx_break">Jialing Zou<sup id="id19.19.id7" class="ltx_sup">1</sup>
 Jianbin Jiao<sup id="id20.20.id8" class="ltx_sup">1</sup>
 Qixiang Ye<sup id="id21.21.id9" class="ltx_sup">1</sup>

<br class="ltx_break"><sup id="id22.22.id10" class="ltx_sup">1</sup>University of Chinese Academy of Sciences
 <sup id="id23.23.id11" class="ltx_sup">2</sup>Tsinghua University

<br class="ltx_break"><sup id="id24.24.id12" class="ltx_sup">3</sup>Sun Yat-Sen University

<br class="ltx_break">
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id25.id1" class="ltx_p">Camouflaged objects are seamlessly blended in with their surroundings, which brings a challenging detection task in computer vision. Optimizing a convolutional neural network (CNN) for camouflaged object detection (COD) tends to activate local discriminative regions while ignoring complete object extent, causing the partial activation issue which inevitably leads to missing or redundant regions of objects. In this paper, we argue that partial activation is caused by the intrinsic characteristics of CNN, where the convolution operations produce local receptive fields and experience difficulty to capture long-range feature dependency among image regions. In order to obtain feature maps that could activate full object extent, keeping the segmental results from being overwhelmed by noisy features, a novel framework termed Cross-Model Detail Querying network (DQnet) is proposed. It reasons the relations between long-range-aware representations and multi-scale local details to make the enhanced representation fully highlight the object regions and eliminate noise on non-object regions. Specifically, a vanilla ViT pretrained with self-supervised learning (SSL) is employed to model long-range dependencies among image regions. A ResNet is employed to enable learning fine-grained spatial local details in multiple scales. Then, to effectively retrieve object-related details, a Relation-Based Querying (RBQ) module is proposed to explore window-based interactions between the global representations and the multi-scale local details. Extensive experiments are conducted on the widely used COD datasets and show that our DQnet outperforms the current state-of-the-arts.</p>
</div>
<figure id="S0.F1" class="ltx_figure"><img src="/html/2212.08296/assets/x1.png" id="S0.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="231" height="132" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S0.F1.2.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S0.F1.3.2" class="ltx_text" style="font-size:90%;">Illustration of DQnet. With the contextual representation of ViT as global cues, our model queries crucial local details from the multi-scale CNN features. The enhanced representations have clear boundaries as well as few background noise, corresponding well with underlying camouflaged objects. (Best viewed in color.)</span></figcaption>
</figure>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">In nature, animals try to conceal themselves by adapting the color, shape, texture of their bodies to their surroundings, which helps them avoid being hunted by predators. The same scheme is used in some artificial applications just as the wild animal photographing and mitilitary camouflage. Those camouflage strategies works by deceiving the visual perceptual system<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>. Recent algorithms designed for general object detection or salient object detection do not perform well in this difficult scenario.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Hence, camouflaged object detection (COD) is a challenging yet an important scientific topic. Solving the problem could benefit a lot of applications in computer vision, such as polyp segmentation<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, lung infection segmentation<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>, photo-realistic blending, and recreational art.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">The key issue of COD is that how to eliminate the ambiguities caused by the high intrinsic similarities between the target objects and the backgrounds, which demands learning representations precisely activating full objects extent. Recently, algorithms for COD based on deep CNNs have been explored a lot. However, due to the local receptive fields of CNN, it tends to activate local semantic elements of object or even some non-object regions, obtaining missing and redundant parts in COD results. Recently, much effort has been made to solve this problem for COD by proposing auxiliary tasks to augment the representations, (<span id="S1.p3.1.1" class="ltx_text ltx_font_italic">i.e.</span>, features for classification<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, identification<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, or edge detection<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>. However, none of those work have paid attention to fundamentally solving the inherent defects of CNN’s local representation. Capturing the long-range feature dependency, which can be interpreted as the semantic relations between features in different spatial locations, is critical for the COD.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Recently,vision transformers <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> have shown great potential in many vision tasks. The design of image as patches facilitates the learning of object-centric representations, as evidenced by recent works, <em id="S1.p4.1.1" class="ltx_emph ltx_font_italic">e.g.</em> DINO, EsViT, MAE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>. However, interestingly, we find that directly using ViT in COD yields unsatisfactory results. We argue that vision transformer cannot be directly mitigated to COD for the following two reasons: (1) In Multilayer Perceptron (MLP) layer, consecutive global matrix multiplications gradually wash out the low-level features, which is crucial to dense prediction tasks like COD. (2) Image patches are similar in COD scenario, and exclusively focusing on modeling the relationships among patches as in the ViT aggravates the already tense object-background ambiguity.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">In this study, we present a simple yet effective framework termed Cross-Model Detail Querying network (DQnet), making the first attempt for COD with vanilla ViT. <span id="S1.p5.1.1" class="ltx_text ltx_font_bold">Firstly</span>, a vanilla Vision Transformer(ViT) is introduced in DQnet, which is pretrained in a self-supervised manner<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>, to generate representations with long-range correlations.
<span id="S1.p5.1.2" class="ltx_text ltx_font_bold">Secondly</span>, a plain CNN is adopted in DQnet to extract low-level visual cues within different scales which can well remedy fine-grained spatial details which have been gradually washed out during ViT inferences.
<span id="S1.p5.1.3" class="ltx_text ltx_font_bold">Thirdly</span>, to retain crucial object-related details while discarding the noisy part, the CNN features are tokenized and incorporated with the ViT patches through a novel module named Relation-Based Querying (RBQ). It helps the DQnet progressively reason the relations between global-aware semantics and multi-scale details to distill the object-related visual cues for representation enhancement. It should be noted that the RBQ module is realized by window-based cross attention, which helps the relation reasoning focusing on spatial neighboring elements. It facilitates the feature enhancement with small memory heads, compared to full attention. As can be seen, the representation after enhancement in RBQ yields clusters of high purity within the target object region, and corresponds well with underlying object categories, <a href="#S0.F1" title="In DQnet: Cross-Model Detail Querying for Camouflaged Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">Our main contributions can be summarized as follows:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We propose the first cross-model framework named DQnet for camouflaged object detection which uses cross-model representation to capture both continuous semantics and fine-grained details.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We introduce the novel Relation-Based Querying (RBQ) module to progressively reason the relations between global representations and the local details, which allows CNN to not only inherit global cues but also remedy the limited locality of ViT. Moreover, we design the Significance-Aware-Loss to further promote the multi-scale detail querying.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">Our DQnet achieves SOTA performance on a variety of benchmarks, including CHAMELEON, CAMO, COD10K, and NC4K, outperforms existing COD models by a large margin.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<div id="S2.p1" class="ltx_para ltx_noindent">
<p id="S2.p1.1" class="ltx_p"><span id="S2.p1.1.1" class="ltx_text ltx_font_bold">Camouflaged Object Detection (COD)</span>
Recently, the deep CNN networks with large capacity have been widely used to recognize the complex camouflaged objects.
Le <em id="S2.p1.1.2" class="ltx_emph ltx_font_italic">et al.</em> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> propose an end-to-end network called the ANet, adding a classification stream to a salient object detection model to boost the segmentation accuracy.
Yan <em id="S2.p1.1.3" class="ltx_emph ltx_font_italic">et al.</em><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> find that horizontally flipped images could provide vital cues, and provide a two-stream MirrorNet with the original and flipped images as inputs.
Pei <em id="S2.p1.1.4" class="ltx_emph ltx_font_italic">et al.</em> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> propose OSFormer, the first one-stage transformer framework for COD, and design a reverse edge attention module to focus on the edge features.
Sun <em id="S2.p1.1.5" class="ltx_emph ltx_font_italic">et al.</em> use a multi-scale channel attention module to fuse the cross-level features in C<sup id="S2.p1.1.6" class="ltx_sup">2</sup>FNet<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>, and employ object-related edge semantics to boost the performance of COD in BGNet<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>.
Some bio-inspired frameworks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> are proposed by imitating the hunting process to gradually locate and search for the camouflaged object.
Pang <em id="S2.p1.1.7" class="ltx_emph ltx_font_italic">et al.</em> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> get inspiration from human behavior. They zoom the original images to three scales and extract features separately to obtain more clues about the camouflaged objects.
Zhai <em id="S2.p1.1.8" class="ltx_emph ltx_font_italic">et al.</em> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite> transform the camouflage feature maps and edge feature maps into sample-dependent semantic graphs to capture the high-level dependencies between them.
Some uncertainty-aware methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite> are also used to detect camouflaged objects.</p>
</div>
<div id="S2.p2" class="ltx_para ltx_noindent">
<p id="S2.p2.1" class="ltx_p"><span id="S2.p2.1.1" class="ltx_text ltx_font_bold">Transformers for vision.</span>
More recently, vision transformers (ViTs) have become the new paradigm for visual recognition and have made great progress in a broad range of visual recognition tasks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>. Several properties of ViT make it a compelling model choice for visual representation learning. First, the self-attention mechanism in ViT offers a strong relational inductive bias, explicitly modeling the relations between input entities. Second, the design of image as patches facilitates the learning of object-centric representations, as evidenced by recent works, <em id="S2.p2.1.2" class="ltx_emph ltx_font_italic">e.g.</em> DINO, EsViT, MAE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>, that demonstrate ViTs trained with self-supervised learning (SSL) capture objects in the image without label annotations.</p>
</div>
<div id="S2.p3" class="ltx_para ltx_noindent">
<p id="S2.p3.1" class="ltx_p"><span id="S2.p3.1.1" class="ltx_text ltx_font_bold">CNNs with non-local cues for segmentation.</span>
Various studies have attempted to integrate non-local mechanisms into CNNs by modeling global interactions of all pixels based on the feature maps. For instance, Wang <em id="S2.p3.1.2" class="ltx_emph ltx_font_italic">et al.</em> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> designed a non-local operator, which could be plugged into multiple intermediate convolution. Built upon the encoder-decoder u-shaped architecture, Chen <em id="S2.p3.1.3" class="ltx_emph ltx_font_italic">et al.</em> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> proposed to encode CNN feature maps into tokenized image patches, followed by a transformer to extract global context for promoting medical segmentation. Xi <em id="S2.p3.1.4" class="ltx_emph ltx_font_italic">et al.</em> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> used both Resnet and hierarchical Transformer as feature encoders, to extract features with dual spatial sizes in parallel for high-resolution saliency detection.
Different from these approaches, we employ non-hierarchical vanilla ViT which provides single-stride non-local cues to effectively query details in an iterative way.</p>
</div>
<div id="S2.p4" class="ltx_para ltx_noindent">
<p id="S2.p4.1" class="ltx_p"><span id="S2.p4.1.1" class="ltx_text ltx_font_bold">Local Attention.</span>
Recently, a series of works re-introduce local attention to ViT for reducing computing complexity and facilitating hierarchical design for dense prediction tasks. Swin Transformer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> computes self-attention in shifted windows, which implicitly built connections between non-overlapped windows, and has linear complexity with image size. Cswin<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> designs a cross-shaped window attention, MSG-Transformer<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> uses additional tokens to exchange visual information across regions, and VSA<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite> employs a window regression module to learn a varied-size Window.
Based on local attention, we study the window mechanism and mix it with cross attention to facilitate our RBQ module design. Window attention helps the details querying focus on spatially neighboring patches, reducing the noise caused by object-background similarity.</p>
</div>
<figure id="S2.F2" class="ltx_figure"><img src="/html/2212.08296/assets/x2.png" id="S2.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="196" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S2.F2.2.1.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S2.F2.3.2" class="ltx_text" style="font-size:90%;">An overview of proposed DQnet. Vision transformer is used to provide global cues. ResNet is used to extract local details in different scales. Relation-Based Querying (RBQ) contains a windowed cross attention to query crucial fine-grained details and enhance multi-scale features. Feature alignment is applied before and after RBQ in each scale to eliminate the dimension inconsistency.</span></figcaption>
</figure>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methodology</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Overall Architecture</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">The architecture of proposed network is shown in <a href="#S2.F2" title="In 2 Related Work ‣ DQnet: Cross-Model Detail Querying for Camouflaged Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">2</span></a>. As can be seen, DQnet consists of two branches performing different tasks respectively: 1) CNN branch, which gradually encodes the input images to get a multilevel feature representation while keeping rich local details; 2) Transformer branch, where it extracts high-level semantic information in a cascaded self-attention manner. Moreover, we propose a Relation-Based Querying (RBQ) module to retrieve detailed local cues in multiple scales. Then, the enhanced multi-scale feature maps are combined to generate the segmentation using a light-weight decoder head. Below we provide the details of these proposed schemes.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Feature Extractors</h3>

<div id="S3.SS2.p1" class="ltx_para ltx_noindent">
<p id="S3.SS2.p1.9" class="ltx_p"><span id="S3.SS2.p1.9.1" class="ltx_text ltx_font_bold">ViT Branch</span>
We will first briefly review the vision transformer structure in the original ViT<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. A raw image <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="\mathbf{\hat{x}}\in\mathbb{R}^{H\times W\times C}" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mrow id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mover accent="true" id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml"><mi id="S3.SS2.p1.1.m1.1.1.2.2" xref="S3.SS2.p1.1.m1.1.1.2.2.cmml">𝐱</mi><mo id="S3.SS2.p1.1.m1.1.1.2.1" xref="S3.SS2.p1.1.m1.1.1.2.1.cmml">^</mo></mover><mo id="S3.SS2.p1.1.m1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml"><mi id="S3.SS2.p1.1.m1.1.1.3.2" xref="S3.SS2.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p1.1.m1.1.1.3.3" xref="S3.SS2.p1.1.m1.1.1.3.3.cmml"><mi id="S3.SS2.p1.1.m1.1.1.3.3.2" xref="S3.SS2.p1.1.m1.1.1.3.3.2.cmml">H</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p1.1.m1.1.1.3.3.1" xref="S3.SS2.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p1.1.m1.1.1.3.3.3" xref="S3.SS2.p1.1.m1.1.1.3.3.3.cmml">W</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p1.1.m1.1.1.3.3.1a" xref="S3.SS2.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p1.1.m1.1.1.3.3.4" xref="S3.SS2.p1.1.m1.1.1.3.3.4.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><in id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1"></in><apply id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2"><ci id="S3.SS2.p1.1.m1.1.1.2.1.cmml" xref="S3.SS2.p1.1.m1.1.1.2.1">^</ci><ci id="S3.SS2.p1.1.m1.1.1.2.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2.2">𝐱</ci></apply><apply id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.3.1.cmml" xref="S3.SS2.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.3.2.cmml" xref="S3.SS2.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS2.p1.1.m1.1.1.3.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3"><times id="S3.SS2.p1.1.m1.1.1.3.3.1.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3.1"></times><ci id="S3.SS2.p1.1.m1.1.1.3.3.2.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3.2">𝐻</ci><ci id="S3.SS2.p1.1.m1.1.1.3.3.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3.3">𝑊</ci><ci id="S3.SS2.p1.1.m1.1.1.3.3.4.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3.4">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\mathbf{\hat{x}}\in\mathbb{R}^{H\times W\times C}</annotation></semantics></math> is split into a sequence of patches <math id="S3.SS2.p1.2.m2.3" class="ltx_Math" alttext="\mathbf{x}=[x_{1},...,x_{N}]\in\mathbb{R}^{N\times P^{2}\times C}" display="inline"><semantics id="S3.SS2.p1.2.m2.3a"><mrow id="S3.SS2.p1.2.m2.3.3" xref="S3.SS2.p1.2.m2.3.3.cmml"><mi id="S3.SS2.p1.2.m2.3.3.4" xref="S3.SS2.p1.2.m2.3.3.4.cmml">𝐱</mi><mo id="S3.SS2.p1.2.m2.3.3.5" xref="S3.SS2.p1.2.m2.3.3.5.cmml">=</mo><mrow id="S3.SS2.p1.2.m2.3.3.2.2" xref="S3.SS2.p1.2.m2.3.3.2.3.cmml"><mo stretchy="false" id="S3.SS2.p1.2.m2.3.3.2.2.3" xref="S3.SS2.p1.2.m2.3.3.2.3.cmml">[</mo><msub id="S3.SS2.p1.2.m2.2.2.1.1.1" xref="S3.SS2.p1.2.m2.2.2.1.1.1.cmml"><mi id="S3.SS2.p1.2.m2.2.2.1.1.1.2" xref="S3.SS2.p1.2.m2.2.2.1.1.1.2.cmml">x</mi><mn id="S3.SS2.p1.2.m2.2.2.1.1.1.3" xref="S3.SS2.p1.2.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p1.2.m2.3.3.2.2.4" xref="S3.SS2.p1.2.m2.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">…</mi><mo id="S3.SS2.p1.2.m2.3.3.2.2.5" xref="S3.SS2.p1.2.m2.3.3.2.3.cmml">,</mo><msub id="S3.SS2.p1.2.m2.3.3.2.2.2" xref="S3.SS2.p1.2.m2.3.3.2.2.2.cmml"><mi id="S3.SS2.p1.2.m2.3.3.2.2.2.2" xref="S3.SS2.p1.2.m2.3.3.2.2.2.2.cmml">x</mi><mi id="S3.SS2.p1.2.m2.3.3.2.2.2.3" xref="S3.SS2.p1.2.m2.3.3.2.2.2.3.cmml">N</mi></msub><mo stretchy="false" id="S3.SS2.p1.2.m2.3.3.2.2.6" xref="S3.SS2.p1.2.m2.3.3.2.3.cmml">]</mo></mrow><mo id="S3.SS2.p1.2.m2.3.3.6" xref="S3.SS2.p1.2.m2.3.3.6.cmml">∈</mo><msup id="S3.SS2.p1.2.m2.3.3.7" xref="S3.SS2.p1.2.m2.3.3.7.cmml"><mi id="S3.SS2.p1.2.m2.3.3.7.2" xref="S3.SS2.p1.2.m2.3.3.7.2.cmml">ℝ</mi><mrow id="S3.SS2.p1.2.m2.3.3.7.3" xref="S3.SS2.p1.2.m2.3.3.7.3.cmml"><mi id="S3.SS2.p1.2.m2.3.3.7.3.2" xref="S3.SS2.p1.2.m2.3.3.7.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p1.2.m2.3.3.7.3.1" xref="S3.SS2.p1.2.m2.3.3.7.3.1.cmml">×</mo><msup id="S3.SS2.p1.2.m2.3.3.7.3.3" xref="S3.SS2.p1.2.m2.3.3.7.3.3.cmml"><mi id="S3.SS2.p1.2.m2.3.3.7.3.3.2" xref="S3.SS2.p1.2.m2.3.3.7.3.3.2.cmml">P</mi><mn id="S3.SS2.p1.2.m2.3.3.7.3.3.3" xref="S3.SS2.p1.2.m2.3.3.7.3.3.3.cmml">2</mn></msup><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p1.2.m2.3.3.7.3.1a" xref="S3.SS2.p1.2.m2.3.3.7.3.1.cmml">×</mo><mi id="S3.SS2.p1.2.m2.3.3.7.3.4" xref="S3.SS2.p1.2.m2.3.3.7.3.4.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.3b"><apply id="S3.SS2.p1.2.m2.3.3.cmml" xref="S3.SS2.p1.2.m2.3.3"><and id="S3.SS2.p1.2.m2.3.3a.cmml" xref="S3.SS2.p1.2.m2.3.3"></and><apply id="S3.SS2.p1.2.m2.3.3b.cmml" xref="S3.SS2.p1.2.m2.3.3"><eq id="S3.SS2.p1.2.m2.3.3.5.cmml" xref="S3.SS2.p1.2.m2.3.3.5"></eq><ci id="S3.SS2.p1.2.m2.3.3.4.cmml" xref="S3.SS2.p1.2.m2.3.3.4">𝐱</ci><list id="S3.SS2.p1.2.m2.3.3.2.3.cmml" xref="S3.SS2.p1.2.m2.3.3.2.2"><apply id="S3.SS2.p1.2.m2.2.2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS2.p1.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.2.m2.2.2.1.1.1.2.cmml" xref="S3.SS2.p1.2.m2.2.2.1.1.1.2">𝑥</ci><cn type="integer" id="S3.SS2.p1.2.m2.2.2.1.1.1.3.cmml" xref="S3.SS2.p1.2.m2.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">…</ci><apply id="S3.SS2.p1.2.m2.3.3.2.2.2.cmml" xref="S3.SS2.p1.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.3.3.2.2.2.1.cmml" xref="S3.SS2.p1.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S3.SS2.p1.2.m2.3.3.2.2.2.2.cmml" xref="S3.SS2.p1.2.m2.3.3.2.2.2.2">𝑥</ci><ci id="S3.SS2.p1.2.m2.3.3.2.2.2.3.cmml" xref="S3.SS2.p1.2.m2.3.3.2.2.2.3">𝑁</ci></apply></list></apply><apply id="S3.SS2.p1.2.m2.3.3c.cmml" xref="S3.SS2.p1.2.m2.3.3"><in id="S3.SS2.p1.2.m2.3.3.6.cmml" xref="S3.SS2.p1.2.m2.3.3.6"></in><share href="#S3.SS2.p1.2.m2.3.3.2.cmml" id="S3.SS2.p1.2.m2.3.3d.cmml" xref="S3.SS2.p1.2.m2.3.3"></share><apply id="S3.SS2.p1.2.m2.3.3.7.cmml" xref="S3.SS2.p1.2.m2.3.3.7"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.3.3.7.1.cmml" xref="S3.SS2.p1.2.m2.3.3.7">superscript</csymbol><ci id="S3.SS2.p1.2.m2.3.3.7.2.cmml" xref="S3.SS2.p1.2.m2.3.3.7.2">ℝ</ci><apply id="S3.SS2.p1.2.m2.3.3.7.3.cmml" xref="S3.SS2.p1.2.m2.3.3.7.3"><times id="S3.SS2.p1.2.m2.3.3.7.3.1.cmml" xref="S3.SS2.p1.2.m2.3.3.7.3.1"></times><ci id="S3.SS2.p1.2.m2.3.3.7.3.2.cmml" xref="S3.SS2.p1.2.m2.3.3.7.3.2">𝑁</ci><apply id="S3.SS2.p1.2.m2.3.3.7.3.3.cmml" xref="S3.SS2.p1.2.m2.3.3.7.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.3.3.7.3.3.1.cmml" xref="S3.SS2.p1.2.m2.3.3.7.3.3">superscript</csymbol><ci id="S3.SS2.p1.2.m2.3.3.7.3.3.2.cmml" xref="S3.SS2.p1.2.m2.3.3.7.3.3.2">𝑃</ci><cn type="integer" id="S3.SS2.p1.2.m2.3.3.7.3.3.3.cmml" xref="S3.SS2.p1.2.m2.3.3.7.3.3.3">2</cn></apply><ci id="S3.SS2.p1.2.m2.3.3.7.3.4.cmml" xref="S3.SS2.p1.2.m2.3.3.7.3.4">𝐶</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.3c">\mathbf{x}=[x_{1},...,x_{N}]\in\mathbb{R}^{N\times P^{2}\times C}</annotation></semantics></math> where <math id="S3.SS2.p1.3.m3.2" class="ltx_Math" alttext="(P,P)" display="inline"><semantics id="S3.SS2.p1.3.m3.2a"><mrow id="S3.SS2.p1.3.m3.2.3.2" xref="S3.SS2.p1.3.m3.2.3.1.cmml"><mo stretchy="false" id="S3.SS2.p1.3.m3.2.3.2.1" xref="S3.SS2.p1.3.m3.2.3.1.cmml">(</mo><mi id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">P</mi><mo id="S3.SS2.p1.3.m3.2.3.2.2" xref="S3.SS2.p1.3.m3.2.3.1.cmml">,</mo><mi id="S3.SS2.p1.3.m3.2.2" xref="S3.SS2.p1.3.m3.2.2.cmml">P</mi><mo stretchy="false" id="S3.SS2.p1.3.m3.2.3.2.3" xref="S3.SS2.p1.3.m3.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.2b"><interval closure="open" id="S3.SS2.p1.3.m3.2.3.1.cmml" xref="S3.SS2.p1.3.m3.2.3.2"><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">𝑃</ci><ci id="S3.SS2.p1.3.m3.2.2.cmml" xref="S3.SS2.p1.3.m3.2.2">𝑃</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.2c">(P,P)</annotation></semantics></math> is the patch size, <math id="S3.SS2.p1.4.m4.1" class="ltx_Math" alttext="N=HW/P^{2}" display="inline"><semantics id="S3.SS2.p1.4.m4.1a"><mrow id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><mi id="S3.SS2.p1.4.m4.1.1.2" xref="S3.SS2.p1.4.m4.1.1.2.cmml">N</mi><mo id="S3.SS2.p1.4.m4.1.1.1" xref="S3.SS2.p1.4.m4.1.1.1.cmml">=</mo><mrow id="S3.SS2.p1.4.m4.1.1.3" xref="S3.SS2.p1.4.m4.1.1.3.cmml"><mrow id="S3.SS2.p1.4.m4.1.1.3.2" xref="S3.SS2.p1.4.m4.1.1.3.2.cmml"><mi id="S3.SS2.p1.4.m4.1.1.3.2.2" xref="S3.SS2.p1.4.m4.1.1.3.2.2.cmml">H</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.4.m4.1.1.3.2.1" xref="S3.SS2.p1.4.m4.1.1.3.2.1.cmml">​</mo><mi id="S3.SS2.p1.4.m4.1.1.3.2.3" xref="S3.SS2.p1.4.m4.1.1.3.2.3.cmml">W</mi></mrow><mo id="S3.SS2.p1.4.m4.1.1.3.1" xref="S3.SS2.p1.4.m4.1.1.3.1.cmml">/</mo><msup id="S3.SS2.p1.4.m4.1.1.3.3" xref="S3.SS2.p1.4.m4.1.1.3.3.cmml"><mi id="S3.SS2.p1.4.m4.1.1.3.3.2" xref="S3.SS2.p1.4.m4.1.1.3.3.2.cmml">P</mi><mn id="S3.SS2.p1.4.m4.1.1.3.3.3" xref="S3.SS2.p1.4.m4.1.1.3.3.3.cmml">2</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><eq id="S3.SS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1.1"></eq><ci id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2">𝑁</ci><apply id="S3.SS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3"><divide id="S3.SS2.p1.4.m4.1.1.3.1.cmml" xref="S3.SS2.p1.4.m4.1.1.3.1"></divide><apply id="S3.SS2.p1.4.m4.1.1.3.2.cmml" xref="S3.SS2.p1.4.m4.1.1.3.2"><times id="S3.SS2.p1.4.m4.1.1.3.2.1.cmml" xref="S3.SS2.p1.4.m4.1.1.3.2.1"></times><ci id="S3.SS2.p1.4.m4.1.1.3.2.2.cmml" xref="S3.SS2.p1.4.m4.1.1.3.2.2">𝐻</ci><ci id="S3.SS2.p1.4.m4.1.1.3.2.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3.2.3">𝑊</ci></apply><apply id="S3.SS2.p1.4.m4.1.1.3.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.3.3.1.cmml" xref="S3.SS2.p1.4.m4.1.1.3.3">superscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.3.3.2.cmml" xref="S3.SS2.p1.4.m4.1.1.3.3.2">𝑃</ci><cn type="integer" id="S3.SS2.p1.4.m4.1.1.3.3.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">N=HW/P^{2}</annotation></semantics></math> is the number of patches and <math id="S3.SS2.p1.5.m5.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.SS2.p1.5.m5.1a"><mi id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><ci id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">C</annotation></semantics></math> is the number of channels. Each patch is flattened into a 1D vector and then linearly projected to a patch embedding to produce a sequence of patch embeddings <math id="S3.SS2.p1.6.m6.3" class="ltx_Math" alttext="\mathbf{x_{0}}=[\mathbf{E}x_{1},...,\mathbf{E}x_{N}]\in\mathbb{R}^{N\times D}" display="inline"><semantics id="S3.SS2.p1.6.m6.3a"><mrow id="S3.SS2.p1.6.m6.3.3" xref="S3.SS2.p1.6.m6.3.3.cmml"><msub id="S3.SS2.p1.6.m6.3.3.4" xref="S3.SS2.p1.6.m6.3.3.4.cmml"><mi id="S3.SS2.p1.6.m6.3.3.4.2" xref="S3.SS2.p1.6.m6.3.3.4.2.cmml">𝐱</mi><mn id="S3.SS2.p1.6.m6.3.3.4.3" xref="S3.SS2.p1.6.m6.3.3.4.3.cmml">𝟎</mn></msub><mo id="S3.SS2.p1.6.m6.3.3.5" xref="S3.SS2.p1.6.m6.3.3.5.cmml">=</mo><mrow id="S3.SS2.p1.6.m6.3.3.2.2" xref="S3.SS2.p1.6.m6.3.3.2.3.cmml"><mo stretchy="false" id="S3.SS2.p1.6.m6.3.3.2.2.3" xref="S3.SS2.p1.6.m6.3.3.2.3.cmml">[</mo><mrow id="S3.SS2.p1.6.m6.2.2.1.1.1" xref="S3.SS2.p1.6.m6.2.2.1.1.1.cmml"><mi id="S3.SS2.p1.6.m6.2.2.1.1.1.2" xref="S3.SS2.p1.6.m6.2.2.1.1.1.2.cmml">𝐄</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.6.m6.2.2.1.1.1.1" xref="S3.SS2.p1.6.m6.2.2.1.1.1.1.cmml">​</mo><msub id="S3.SS2.p1.6.m6.2.2.1.1.1.3" xref="S3.SS2.p1.6.m6.2.2.1.1.1.3.cmml"><mi id="S3.SS2.p1.6.m6.2.2.1.1.1.3.2" xref="S3.SS2.p1.6.m6.2.2.1.1.1.3.2.cmml">x</mi><mn id="S3.SS2.p1.6.m6.2.2.1.1.1.3.3" xref="S3.SS2.p1.6.m6.2.2.1.1.1.3.3.cmml">1</mn></msub></mrow><mo id="S3.SS2.p1.6.m6.3.3.2.2.4" xref="S3.SS2.p1.6.m6.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml">…</mi><mo id="S3.SS2.p1.6.m6.3.3.2.2.5" xref="S3.SS2.p1.6.m6.3.3.2.3.cmml">,</mo><mrow id="S3.SS2.p1.6.m6.3.3.2.2.2" xref="S3.SS2.p1.6.m6.3.3.2.2.2.cmml"><mi id="S3.SS2.p1.6.m6.3.3.2.2.2.2" xref="S3.SS2.p1.6.m6.3.3.2.2.2.2.cmml">𝐄</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.6.m6.3.3.2.2.2.1" xref="S3.SS2.p1.6.m6.3.3.2.2.2.1.cmml">​</mo><msub id="S3.SS2.p1.6.m6.3.3.2.2.2.3" xref="S3.SS2.p1.6.m6.3.3.2.2.2.3.cmml"><mi id="S3.SS2.p1.6.m6.3.3.2.2.2.3.2" xref="S3.SS2.p1.6.m6.3.3.2.2.2.3.2.cmml">x</mi><mi id="S3.SS2.p1.6.m6.3.3.2.2.2.3.3" xref="S3.SS2.p1.6.m6.3.3.2.2.2.3.3.cmml">N</mi></msub></mrow><mo stretchy="false" id="S3.SS2.p1.6.m6.3.3.2.2.6" xref="S3.SS2.p1.6.m6.3.3.2.3.cmml">]</mo></mrow><mo id="S3.SS2.p1.6.m6.3.3.6" xref="S3.SS2.p1.6.m6.3.3.6.cmml">∈</mo><msup id="S3.SS2.p1.6.m6.3.3.7" xref="S3.SS2.p1.6.m6.3.3.7.cmml"><mi id="S3.SS2.p1.6.m6.3.3.7.2" xref="S3.SS2.p1.6.m6.3.3.7.2.cmml">ℝ</mi><mrow id="S3.SS2.p1.6.m6.3.3.7.3" xref="S3.SS2.p1.6.m6.3.3.7.3.cmml"><mi id="S3.SS2.p1.6.m6.3.3.7.3.2" xref="S3.SS2.p1.6.m6.3.3.7.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p1.6.m6.3.3.7.3.1" xref="S3.SS2.p1.6.m6.3.3.7.3.1.cmml">×</mo><mi id="S3.SS2.p1.6.m6.3.3.7.3.3" xref="S3.SS2.p1.6.m6.3.3.7.3.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.3b"><apply id="S3.SS2.p1.6.m6.3.3.cmml" xref="S3.SS2.p1.6.m6.3.3"><and id="S3.SS2.p1.6.m6.3.3a.cmml" xref="S3.SS2.p1.6.m6.3.3"></and><apply id="S3.SS2.p1.6.m6.3.3b.cmml" xref="S3.SS2.p1.6.m6.3.3"><eq id="S3.SS2.p1.6.m6.3.3.5.cmml" xref="S3.SS2.p1.6.m6.3.3.5"></eq><apply id="S3.SS2.p1.6.m6.3.3.4.cmml" xref="S3.SS2.p1.6.m6.3.3.4"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.3.3.4.1.cmml" xref="S3.SS2.p1.6.m6.3.3.4">subscript</csymbol><ci id="S3.SS2.p1.6.m6.3.3.4.2.cmml" xref="S3.SS2.p1.6.m6.3.3.4.2">𝐱</ci><cn type="integer" id="S3.SS2.p1.6.m6.3.3.4.3.cmml" xref="S3.SS2.p1.6.m6.3.3.4.3">0</cn></apply><list id="S3.SS2.p1.6.m6.3.3.2.3.cmml" xref="S3.SS2.p1.6.m6.3.3.2.2"><apply id="S3.SS2.p1.6.m6.2.2.1.1.1.cmml" xref="S3.SS2.p1.6.m6.2.2.1.1.1"><times id="S3.SS2.p1.6.m6.2.2.1.1.1.1.cmml" xref="S3.SS2.p1.6.m6.2.2.1.1.1.1"></times><ci id="S3.SS2.p1.6.m6.2.2.1.1.1.2.cmml" xref="S3.SS2.p1.6.m6.2.2.1.1.1.2">𝐄</ci><apply id="S3.SS2.p1.6.m6.2.2.1.1.1.3.cmml" xref="S3.SS2.p1.6.m6.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.2.2.1.1.1.3.1.cmml" xref="S3.SS2.p1.6.m6.2.2.1.1.1.3">subscript</csymbol><ci id="S3.SS2.p1.6.m6.2.2.1.1.1.3.2.cmml" xref="S3.SS2.p1.6.m6.2.2.1.1.1.3.2">𝑥</ci><cn type="integer" id="S3.SS2.p1.6.m6.2.2.1.1.1.3.3.cmml" xref="S3.SS2.p1.6.m6.2.2.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">…</ci><apply id="S3.SS2.p1.6.m6.3.3.2.2.2.cmml" xref="S3.SS2.p1.6.m6.3.3.2.2.2"><times id="S3.SS2.p1.6.m6.3.3.2.2.2.1.cmml" xref="S3.SS2.p1.6.m6.3.3.2.2.2.1"></times><ci id="S3.SS2.p1.6.m6.3.3.2.2.2.2.cmml" xref="S3.SS2.p1.6.m6.3.3.2.2.2.2">𝐄</ci><apply id="S3.SS2.p1.6.m6.3.3.2.2.2.3.cmml" xref="S3.SS2.p1.6.m6.3.3.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.3.3.2.2.2.3.1.cmml" xref="S3.SS2.p1.6.m6.3.3.2.2.2.3">subscript</csymbol><ci id="S3.SS2.p1.6.m6.3.3.2.2.2.3.2.cmml" xref="S3.SS2.p1.6.m6.3.3.2.2.2.3.2">𝑥</ci><ci id="S3.SS2.p1.6.m6.3.3.2.2.2.3.3.cmml" xref="S3.SS2.p1.6.m6.3.3.2.2.2.3.3">𝑁</ci></apply></apply></list></apply><apply id="S3.SS2.p1.6.m6.3.3c.cmml" xref="S3.SS2.p1.6.m6.3.3"><in id="S3.SS2.p1.6.m6.3.3.6.cmml" xref="S3.SS2.p1.6.m6.3.3.6"></in><share href="#S3.SS2.p1.6.m6.3.3.2.cmml" id="S3.SS2.p1.6.m6.3.3d.cmml" xref="S3.SS2.p1.6.m6.3.3"></share><apply id="S3.SS2.p1.6.m6.3.3.7.cmml" xref="S3.SS2.p1.6.m6.3.3.7"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.3.3.7.1.cmml" xref="S3.SS2.p1.6.m6.3.3.7">superscript</csymbol><ci id="S3.SS2.p1.6.m6.3.3.7.2.cmml" xref="S3.SS2.p1.6.m6.3.3.7.2">ℝ</ci><apply id="S3.SS2.p1.6.m6.3.3.7.3.cmml" xref="S3.SS2.p1.6.m6.3.3.7.3"><times id="S3.SS2.p1.6.m6.3.3.7.3.1.cmml" xref="S3.SS2.p1.6.m6.3.3.7.3.1"></times><ci id="S3.SS2.p1.6.m6.3.3.7.3.2.cmml" xref="S3.SS2.p1.6.m6.3.3.7.3.2">𝑁</ci><ci id="S3.SS2.p1.6.m6.3.3.7.3.3.cmml" xref="S3.SS2.p1.6.m6.3.3.7.3.3">𝐷</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.3c">\mathbf{x_{0}}=[\mathbf{E}x_{1},...,\mathbf{E}x_{N}]\in\mathbb{R}^{N\times D}</annotation></semantics></math> where <math id="S3.SS2.p1.7.m7.1" class="ltx_Math" alttext="\mathbf{E}\in\mathbb{R}^{D\times(P^{2}C)}" display="inline"><semantics id="S3.SS2.p1.7.m7.1a"><mrow id="S3.SS2.p1.7.m7.1.2" xref="S3.SS2.p1.7.m7.1.2.cmml"><mi id="S3.SS2.p1.7.m7.1.2.2" xref="S3.SS2.p1.7.m7.1.2.2.cmml">𝐄</mi><mo id="S3.SS2.p1.7.m7.1.2.1" xref="S3.SS2.p1.7.m7.1.2.1.cmml">∈</mo><msup id="S3.SS2.p1.7.m7.1.2.3" xref="S3.SS2.p1.7.m7.1.2.3.cmml"><mi id="S3.SS2.p1.7.m7.1.2.3.2" xref="S3.SS2.p1.7.m7.1.2.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p1.7.m7.1.1.1" xref="S3.SS2.p1.7.m7.1.1.1.cmml"><mi id="S3.SS2.p1.7.m7.1.1.1.3" xref="S3.SS2.p1.7.m7.1.1.1.3.cmml">D</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p1.7.m7.1.1.1.2" xref="S3.SS2.p1.7.m7.1.1.1.2.cmml">×</mo><mrow id="S3.SS2.p1.7.m7.1.1.1.1.1" xref="S3.SS2.p1.7.m7.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p1.7.m7.1.1.1.1.1.2" xref="S3.SS2.p1.7.m7.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p1.7.m7.1.1.1.1.1.1" xref="S3.SS2.p1.7.m7.1.1.1.1.1.1.cmml"><msup id="S3.SS2.p1.7.m7.1.1.1.1.1.1.2" xref="S3.SS2.p1.7.m7.1.1.1.1.1.1.2.cmml"><mi id="S3.SS2.p1.7.m7.1.1.1.1.1.1.2.2" xref="S3.SS2.p1.7.m7.1.1.1.1.1.1.2.2.cmml">P</mi><mn id="S3.SS2.p1.7.m7.1.1.1.1.1.1.2.3" xref="S3.SS2.p1.7.m7.1.1.1.1.1.1.2.3.cmml">2</mn></msup><mo lspace="0em" rspace="0em" id="S3.SS2.p1.7.m7.1.1.1.1.1.1.1" xref="S3.SS2.p1.7.m7.1.1.1.1.1.1.1.cmml">​</mo><mi id="S3.SS2.p1.7.m7.1.1.1.1.1.1.3" xref="S3.SS2.p1.7.m7.1.1.1.1.1.1.3.cmml">C</mi></mrow><mo stretchy="false" id="S3.SS2.p1.7.m7.1.1.1.1.1.3" xref="S3.SS2.p1.7.m7.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><apply id="S3.SS2.p1.7.m7.1.2.cmml" xref="S3.SS2.p1.7.m7.1.2"><in id="S3.SS2.p1.7.m7.1.2.1.cmml" xref="S3.SS2.p1.7.m7.1.2.1"></in><ci id="S3.SS2.p1.7.m7.1.2.2.cmml" xref="S3.SS2.p1.7.m7.1.2.2">𝐄</ci><apply id="S3.SS2.p1.7.m7.1.2.3.cmml" xref="S3.SS2.p1.7.m7.1.2.3"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.1.2.3.1.cmml" xref="S3.SS2.p1.7.m7.1.2.3">superscript</csymbol><ci id="S3.SS2.p1.7.m7.1.2.3.2.cmml" xref="S3.SS2.p1.7.m7.1.2.3.2">ℝ</ci><apply id="S3.SS2.p1.7.m7.1.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1.1"><times id="S3.SS2.p1.7.m7.1.1.1.2.cmml" xref="S3.SS2.p1.7.m7.1.1.1.2"></times><ci id="S3.SS2.p1.7.m7.1.1.1.3.cmml" xref="S3.SS2.p1.7.m7.1.1.1.3">𝐷</ci><apply id="S3.SS2.p1.7.m7.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1.1.1.1"><times id="S3.SS2.p1.7.m7.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1.1.1.1.1.1"></times><apply id="S3.SS2.p1.7.m7.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.7.m7.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.1.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p1.7.m7.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.SS2.p1.7.m7.1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p1.7.m7.1.1.1.1.1.1.2.2">𝑃</ci><cn type="integer" id="S3.SS2.p1.7.m7.1.1.1.1.1.1.2.3.cmml" xref="S3.SS2.p1.7.m7.1.1.1.1.1.1.2.3">2</cn></apply><ci id="S3.SS2.p1.7.m7.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.7.m7.1.1.1.1.1.1.3">𝐶</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">\mathbf{E}\in\mathbb{R}^{D\times(P^{2}C)}</annotation></semantics></math>. To capture positional information, learnable position embeddings <math id="S3.SS2.p1.8.m8.3" class="ltx_Math" alttext="\mathbf{pos}=[\text{pos}_{1},...,\text{pos}_{N}]\in\mathbb{R}^{N\times D}" display="inline"><semantics id="S3.SS2.p1.8.m8.3a"><mrow id="S3.SS2.p1.8.m8.3.3" xref="S3.SS2.p1.8.m8.3.3.cmml"><mi id="S3.SS2.p1.8.m8.3.3.4" xref="S3.SS2.p1.8.m8.3.3.4.cmml">𝐩𝐨𝐬</mi><mo id="S3.SS2.p1.8.m8.3.3.5" xref="S3.SS2.p1.8.m8.3.3.5.cmml">=</mo><mrow id="S3.SS2.p1.8.m8.3.3.2.2" xref="S3.SS2.p1.8.m8.3.3.2.3.cmml"><mo stretchy="false" id="S3.SS2.p1.8.m8.3.3.2.2.3" xref="S3.SS2.p1.8.m8.3.3.2.3.cmml">[</mo><msub id="S3.SS2.p1.8.m8.2.2.1.1.1" xref="S3.SS2.p1.8.m8.2.2.1.1.1.cmml"><mtext id="S3.SS2.p1.8.m8.2.2.1.1.1.2" xref="S3.SS2.p1.8.m8.2.2.1.1.1.2a.cmml">pos</mtext><mn id="S3.SS2.p1.8.m8.2.2.1.1.1.3" xref="S3.SS2.p1.8.m8.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p1.8.m8.3.3.2.2.4" xref="S3.SS2.p1.8.m8.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p1.8.m8.1.1" xref="S3.SS2.p1.8.m8.1.1.cmml">…</mi><mo id="S3.SS2.p1.8.m8.3.3.2.2.5" xref="S3.SS2.p1.8.m8.3.3.2.3.cmml">,</mo><msub id="S3.SS2.p1.8.m8.3.3.2.2.2" xref="S3.SS2.p1.8.m8.3.3.2.2.2.cmml"><mtext id="S3.SS2.p1.8.m8.3.3.2.2.2.2" xref="S3.SS2.p1.8.m8.3.3.2.2.2.2a.cmml">pos</mtext><mi id="S3.SS2.p1.8.m8.3.3.2.2.2.3" xref="S3.SS2.p1.8.m8.3.3.2.2.2.3.cmml">N</mi></msub><mo stretchy="false" id="S3.SS2.p1.8.m8.3.3.2.2.6" xref="S3.SS2.p1.8.m8.3.3.2.3.cmml">]</mo></mrow><mo id="S3.SS2.p1.8.m8.3.3.6" xref="S3.SS2.p1.8.m8.3.3.6.cmml">∈</mo><msup id="S3.SS2.p1.8.m8.3.3.7" xref="S3.SS2.p1.8.m8.3.3.7.cmml"><mi id="S3.SS2.p1.8.m8.3.3.7.2" xref="S3.SS2.p1.8.m8.3.3.7.2.cmml">ℝ</mi><mrow id="S3.SS2.p1.8.m8.3.3.7.3" xref="S3.SS2.p1.8.m8.3.3.7.3.cmml"><mi id="S3.SS2.p1.8.m8.3.3.7.3.2" xref="S3.SS2.p1.8.m8.3.3.7.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p1.8.m8.3.3.7.3.1" xref="S3.SS2.p1.8.m8.3.3.7.3.1.cmml">×</mo><mi id="S3.SS2.p1.8.m8.3.3.7.3.3" xref="S3.SS2.p1.8.m8.3.3.7.3.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m8.3b"><apply id="S3.SS2.p1.8.m8.3.3.cmml" xref="S3.SS2.p1.8.m8.3.3"><and id="S3.SS2.p1.8.m8.3.3a.cmml" xref="S3.SS2.p1.8.m8.3.3"></and><apply id="S3.SS2.p1.8.m8.3.3b.cmml" xref="S3.SS2.p1.8.m8.3.3"><eq id="S3.SS2.p1.8.m8.3.3.5.cmml" xref="S3.SS2.p1.8.m8.3.3.5"></eq><ci id="S3.SS2.p1.8.m8.3.3.4.cmml" xref="S3.SS2.p1.8.m8.3.3.4">𝐩𝐨𝐬</ci><list id="S3.SS2.p1.8.m8.3.3.2.3.cmml" xref="S3.SS2.p1.8.m8.3.3.2.2"><apply id="S3.SS2.p1.8.m8.2.2.1.1.1.cmml" xref="S3.SS2.p1.8.m8.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m8.2.2.1.1.1.1.cmml" xref="S3.SS2.p1.8.m8.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.8.m8.2.2.1.1.1.2a.cmml" xref="S3.SS2.p1.8.m8.2.2.1.1.1.2"><mtext id="S3.SS2.p1.8.m8.2.2.1.1.1.2.cmml" xref="S3.SS2.p1.8.m8.2.2.1.1.1.2">pos</mtext></ci><cn type="integer" id="S3.SS2.p1.8.m8.2.2.1.1.1.3.cmml" xref="S3.SS2.p1.8.m8.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS2.p1.8.m8.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1">…</ci><apply id="S3.SS2.p1.8.m8.3.3.2.2.2.cmml" xref="S3.SS2.p1.8.m8.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m8.3.3.2.2.2.1.cmml" xref="S3.SS2.p1.8.m8.3.3.2.2.2">subscript</csymbol><ci id="S3.SS2.p1.8.m8.3.3.2.2.2.2a.cmml" xref="S3.SS2.p1.8.m8.3.3.2.2.2.2"><mtext id="S3.SS2.p1.8.m8.3.3.2.2.2.2.cmml" xref="S3.SS2.p1.8.m8.3.3.2.2.2.2">pos</mtext></ci><ci id="S3.SS2.p1.8.m8.3.3.2.2.2.3.cmml" xref="S3.SS2.p1.8.m8.3.3.2.2.2.3">𝑁</ci></apply></list></apply><apply id="S3.SS2.p1.8.m8.3.3c.cmml" xref="S3.SS2.p1.8.m8.3.3"><in id="S3.SS2.p1.8.m8.3.3.6.cmml" xref="S3.SS2.p1.8.m8.3.3.6"></in><share href="#S3.SS2.p1.8.m8.3.3.2.cmml" id="S3.SS2.p1.8.m8.3.3d.cmml" xref="S3.SS2.p1.8.m8.3.3"></share><apply id="S3.SS2.p1.8.m8.3.3.7.cmml" xref="S3.SS2.p1.8.m8.3.3.7"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m8.3.3.7.1.cmml" xref="S3.SS2.p1.8.m8.3.3.7">superscript</csymbol><ci id="S3.SS2.p1.8.m8.3.3.7.2.cmml" xref="S3.SS2.p1.8.m8.3.3.7.2">ℝ</ci><apply id="S3.SS2.p1.8.m8.3.3.7.3.cmml" xref="S3.SS2.p1.8.m8.3.3.7.3"><times id="S3.SS2.p1.8.m8.3.3.7.3.1.cmml" xref="S3.SS2.p1.8.m8.3.3.7.3.1"></times><ci id="S3.SS2.p1.8.m8.3.3.7.3.2.cmml" xref="S3.SS2.p1.8.m8.3.3.7.3.2">𝑁</ci><ci id="S3.SS2.p1.8.m8.3.3.7.3.3.cmml" xref="S3.SS2.p1.8.m8.3.3.7.3.3">𝐷</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m8.3c">\mathbf{pos}=[\text{pos}_{1},...,\text{pos}_{N}]\in\mathbb{R}^{N\times D}</annotation></semantics></math> are added to the sequence of patches to get the resulting input sequence of tokens <math id="S3.SS2.p1.9.m9.1" class="ltx_Math" alttext="\mathbf{z_{0}}=\mathbf{x_{0}}+\mathbf{pos}" display="inline"><semantics id="S3.SS2.p1.9.m9.1a"><mrow id="S3.SS2.p1.9.m9.1.1" xref="S3.SS2.p1.9.m9.1.1.cmml"><msub id="S3.SS2.p1.9.m9.1.1.2" xref="S3.SS2.p1.9.m9.1.1.2.cmml"><mi id="S3.SS2.p1.9.m9.1.1.2.2" xref="S3.SS2.p1.9.m9.1.1.2.2.cmml">𝐳</mi><mn id="S3.SS2.p1.9.m9.1.1.2.3" xref="S3.SS2.p1.9.m9.1.1.2.3.cmml">𝟎</mn></msub><mo id="S3.SS2.p1.9.m9.1.1.1" xref="S3.SS2.p1.9.m9.1.1.1.cmml">=</mo><mrow id="S3.SS2.p1.9.m9.1.1.3" xref="S3.SS2.p1.9.m9.1.1.3.cmml"><msub id="S3.SS2.p1.9.m9.1.1.3.2" xref="S3.SS2.p1.9.m9.1.1.3.2.cmml"><mi id="S3.SS2.p1.9.m9.1.1.3.2.2" xref="S3.SS2.p1.9.m9.1.1.3.2.2.cmml">𝐱</mi><mn id="S3.SS2.p1.9.m9.1.1.3.2.3" xref="S3.SS2.p1.9.m9.1.1.3.2.3.cmml">𝟎</mn></msub><mo id="S3.SS2.p1.9.m9.1.1.3.1" xref="S3.SS2.p1.9.m9.1.1.3.1.cmml">+</mo><mi id="S3.SS2.p1.9.m9.1.1.3.3" xref="S3.SS2.p1.9.m9.1.1.3.3.cmml">𝐩𝐨𝐬</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m9.1b"><apply id="S3.SS2.p1.9.m9.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1"><eq id="S3.SS2.p1.9.m9.1.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1.1"></eq><apply id="S3.SS2.p1.9.m9.1.1.2.cmml" xref="S3.SS2.p1.9.m9.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m9.1.1.2.1.cmml" xref="S3.SS2.p1.9.m9.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.9.m9.1.1.2.2.cmml" xref="S3.SS2.p1.9.m9.1.1.2.2">𝐳</ci><cn type="integer" id="S3.SS2.p1.9.m9.1.1.2.3.cmml" xref="S3.SS2.p1.9.m9.1.1.2.3">0</cn></apply><apply id="S3.SS2.p1.9.m9.1.1.3.cmml" xref="S3.SS2.p1.9.m9.1.1.3"><plus id="S3.SS2.p1.9.m9.1.1.3.1.cmml" xref="S3.SS2.p1.9.m9.1.1.3.1"></plus><apply id="S3.SS2.p1.9.m9.1.1.3.2.cmml" xref="S3.SS2.p1.9.m9.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m9.1.1.3.2.1.cmml" xref="S3.SS2.p1.9.m9.1.1.3.2">subscript</csymbol><ci id="S3.SS2.p1.9.m9.1.1.3.2.2.cmml" xref="S3.SS2.p1.9.m9.1.1.3.2.2">𝐱</ci><cn type="integer" id="S3.SS2.p1.9.m9.1.1.3.2.3.cmml" xref="S3.SS2.p1.9.m9.1.1.3.2.3">0</cn></apply><ci id="S3.SS2.p1.9.m9.1.1.3.3.cmml" xref="S3.SS2.p1.9.m9.1.1.3.3">𝐩𝐨𝐬</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m9.1c">\mathbf{z_{0}}=\mathbf{x_{0}}+\mathbf{pos}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.3" class="ltx_p">A transformer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> encoder composed of <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><mi id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><ci id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">L</annotation></semantics></math> layers is applied to the sequence of tokens <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="\mathbf{z}_{0}" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><msub id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><mi id="S3.SS2.p2.2.m2.1.1.2" xref="S3.SS2.p2.2.m2.1.1.2.cmml">𝐳</mi><mn id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2">𝐳</ci><cn type="integer" id="S3.SS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">\mathbf{z}_{0}</annotation></semantics></math> to generate a sequence of contextualized encodings <math id="S3.SS2.p2.3.m3.1" class="ltx_Math" alttext="\mathbf{z}_{L}\in\mathbb{R}^{N\times D}" display="inline"><semantics id="S3.SS2.p2.3.m3.1a"><mrow id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml"><msub id="S3.SS2.p2.3.m3.1.1.2" xref="S3.SS2.p2.3.m3.1.1.2.cmml"><mi id="S3.SS2.p2.3.m3.1.1.2.2" xref="S3.SS2.p2.3.m3.1.1.2.2.cmml">𝐳</mi><mi id="S3.SS2.p2.3.m3.1.1.2.3" xref="S3.SS2.p2.3.m3.1.1.2.3.cmml">L</mi></msub><mo id="S3.SS2.p2.3.m3.1.1.1" xref="S3.SS2.p2.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS2.p2.3.m3.1.1.3" xref="S3.SS2.p2.3.m3.1.1.3.cmml"><mi id="S3.SS2.p2.3.m3.1.1.3.2" xref="S3.SS2.p2.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p2.3.m3.1.1.3.3" xref="S3.SS2.p2.3.m3.1.1.3.3.cmml"><mi id="S3.SS2.p2.3.m3.1.1.3.3.2" xref="S3.SS2.p2.3.m3.1.1.3.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p2.3.m3.1.1.3.3.1" xref="S3.SS2.p2.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p2.3.m3.1.1.3.3.3" xref="S3.SS2.p2.3.m3.1.1.3.3.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><apply id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1"><in id="S3.SS2.p2.3.m3.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1.1"></in><apply id="S3.SS2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.2.1.cmml" xref="S3.SS2.p2.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.2.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2.2">𝐳</ci><ci id="S3.SS2.p2.3.m3.1.1.2.3.cmml" xref="S3.SS2.p2.3.m3.1.1.2.3">𝐿</ci></apply><apply id="S3.SS2.p2.3.m3.1.1.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.3.1.cmml" xref="S3.SS2.p2.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.3.2.cmml" xref="S3.SS2.p2.3.m3.1.1.3.2">ℝ</ci><apply id="S3.SS2.p2.3.m3.1.1.3.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3.3"><times id="S3.SS2.p2.3.m3.1.1.3.3.1.cmml" xref="S3.SS2.p2.3.m3.1.1.3.3.1"></times><ci id="S3.SS2.p2.3.m3.1.1.3.3.2.cmml" xref="S3.SS2.p2.3.m3.1.1.3.3.2">𝑁</ci><ci id="S3.SS2.p2.3.m3.1.1.3.3.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3.3.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">\mathbf{z}_{L}\in\mathbb{R}^{N\times D}</annotation></semantics></math>. A transformer layer consists
of a multi-headed self-attention (MSA) block followed by a point-wise MLP block of two layers with layer norm (LN) applied before every block and residual connections added after every block:</p>
<table id="S6.EGx1" class="ltx_equationgroup ltx_eqn_eqnarray ltx_eqn_table">

<tbody id="S3.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E1.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{a_{i-1}}" display="inline"><semantics id="S3.E1.m1.1a"><msub id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml"><mi id="S3.E1.m1.1.1.2" xref="S3.E1.m1.1.1.2.cmml">𝐚</mi><mrow id="S3.E1.m1.1.1.3" xref="S3.E1.m1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.3.2" xref="S3.E1.m1.1.1.3.2.cmml">𝐢</mi><mo id="S3.E1.m1.1.1.3.1" xref="S3.E1.m1.1.1.3.1.cmml">−</mo><mn id="S3.E1.m1.1.1.3.3" xref="S3.E1.m1.1.1.3.3.cmml">𝟏</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><apply id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.cmml" xref="S3.E1.m1.1.1">subscript</csymbol><ci id="S3.E1.m1.1.1.2.cmml" xref="S3.E1.m1.1.1.2">𝐚</ci><apply id="S3.E1.m1.1.1.3.cmml" xref="S3.E1.m1.1.1.3"><minus id="S3.E1.m1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.3.1"></minus><ci id="S3.E1.m1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.3.2">𝐢</ci><cn type="integer" id="S3.E1.m1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">\displaystyle\mathbf{a_{i-1}}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_eqn_cell"><math id="S3.E1.m2.1" class="ltx_Math" alttext="\displaystyle=" display="inline"><semantics id="S3.E1.m2.1a"><mo id="S3.E1.m2.1.1" xref="S3.E1.m2.1.1.cmml">=</mo><annotation-xml encoding="MathML-Content" id="S3.E1.m2.1b"><eq id="S3.E1.m2.1.1.cmml" xref="S3.E1.m2.1.1"></eq></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m2.1c">\displaystyle=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E1.m3.1" class="ltx_Math" alttext="\displaystyle\text{MSA}(\text{LN}(\mathbf{z_{i-1}}))+\mathbf{z_{i-1}}," display="inline"><semantics id="S3.E1.m3.1a"><mrow id="S3.E1.m3.1.1.1" xref="S3.E1.m3.1.1.1.1.cmml"><mrow id="S3.E1.m3.1.1.1.1" xref="S3.E1.m3.1.1.1.1.cmml"><mrow id="S3.E1.m3.1.1.1.1.1" xref="S3.E1.m3.1.1.1.1.1.cmml"><mtext id="S3.E1.m3.1.1.1.1.1.3" xref="S3.E1.m3.1.1.1.1.1.3a.cmml">MSA</mtext><mo lspace="0em" rspace="0em" id="S3.E1.m3.1.1.1.1.1.2" xref="S3.E1.m3.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E1.m3.1.1.1.1.1.1.1" xref="S3.E1.m3.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m3.1.1.1.1.1.1.1.2" xref="S3.E1.m3.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m3.1.1.1.1.1.1.1.1" xref="S3.E1.m3.1.1.1.1.1.1.1.1.cmml"><mtext id="S3.E1.m3.1.1.1.1.1.1.1.1.3" xref="S3.E1.m3.1.1.1.1.1.1.1.1.3a.cmml">LN</mtext><mo lspace="0em" rspace="0em" id="S3.E1.m3.1.1.1.1.1.1.1.1.2" xref="S3.E1.m3.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E1.m3.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m3.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m3.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E1.m3.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m3.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m3.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐳</mi><mrow id="S3.E1.m3.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m3.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m3.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E1.m3.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">𝐢</mi><mo id="S3.E1.m3.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E1.m3.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S3.E1.m3.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E1.m3.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">𝟏</mn></mrow></msub><mo stretchy="false" id="S3.E1.m3.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m3.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E1.m3.1.1.1.1.1.1.1.3" xref="S3.E1.m3.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m3.1.1.1.1.2" xref="S3.E1.m3.1.1.1.1.2.cmml">+</mo><msub id="S3.E1.m3.1.1.1.1.3" xref="S3.E1.m3.1.1.1.1.3.cmml"><mi id="S3.E1.m3.1.1.1.1.3.2" xref="S3.E1.m3.1.1.1.1.3.2.cmml">𝐳</mi><mrow id="S3.E1.m3.1.1.1.1.3.3" xref="S3.E1.m3.1.1.1.1.3.3.cmml"><mi id="S3.E1.m3.1.1.1.1.3.3.2" xref="S3.E1.m3.1.1.1.1.3.3.2.cmml">𝐢</mi><mo id="S3.E1.m3.1.1.1.1.3.3.1" xref="S3.E1.m3.1.1.1.1.3.3.1.cmml">−</mo><mn id="S3.E1.m3.1.1.1.1.3.3.3" xref="S3.E1.m3.1.1.1.1.3.3.3.cmml">𝟏</mn></mrow></msub></mrow><mo id="S3.E1.m3.1.1.1.2" xref="S3.E1.m3.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m3.1b"><apply id="S3.E1.m3.1.1.1.1.cmml" xref="S3.E1.m3.1.1.1"><plus id="S3.E1.m3.1.1.1.1.2.cmml" xref="S3.E1.m3.1.1.1.1.2"></plus><apply id="S3.E1.m3.1.1.1.1.1.cmml" xref="S3.E1.m3.1.1.1.1.1"><times id="S3.E1.m3.1.1.1.1.1.2.cmml" xref="S3.E1.m3.1.1.1.1.1.2"></times><ci id="S3.E1.m3.1.1.1.1.1.3a.cmml" xref="S3.E1.m3.1.1.1.1.1.3"><mtext id="S3.E1.m3.1.1.1.1.1.3.cmml" xref="S3.E1.m3.1.1.1.1.1.3">MSA</mtext></ci><apply id="S3.E1.m3.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m3.1.1.1.1.1.1.1"><times id="S3.E1.m3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m3.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E1.m3.1.1.1.1.1.1.1.1.3a.cmml" xref="S3.E1.m3.1.1.1.1.1.1.1.1.3"><mtext id="S3.E1.m3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m3.1.1.1.1.1.1.1.1.3">LN</mtext></ci><apply id="S3.E1.m3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m3.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m3.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m3.1.1.1.1.1.1.1.1.1.1.1.2">𝐳</ci><apply id="S3.E1.m3.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m3.1.1.1.1.1.1.1.1.1.1.1.3"><minus id="S3.E1.m3.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m3.1.1.1.1.1.1.1.1.1.1.1.3.1"></minus><ci id="S3.E1.m3.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m3.1.1.1.1.1.1.1.1.1.1.1.3.2">𝐢</ci><cn type="integer" id="S3.E1.m3.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m3.1.1.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply></apply><apply id="S3.E1.m3.1.1.1.1.3.cmml" xref="S3.E1.m3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m3.1.1.1.1.3.1.cmml" xref="S3.E1.m3.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m3.1.1.1.1.3.2.cmml" xref="S3.E1.m3.1.1.1.1.3.2">𝐳</ci><apply id="S3.E1.m3.1.1.1.1.3.3.cmml" xref="S3.E1.m3.1.1.1.1.3.3"><minus id="S3.E1.m3.1.1.1.1.3.3.1.cmml" xref="S3.E1.m3.1.1.1.1.3.3.1"></minus><ci id="S3.E1.m3.1.1.1.1.3.3.2.cmml" xref="S3.E1.m3.1.1.1.1.3.3.2">𝐢</ci><cn type="integer" id="S3.E1.m3.1.1.1.1.3.3.3.cmml" xref="S3.E1.m3.1.1.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m3.1c">\displaystyle\text{MSA}(\text{LN}(\mathbf{z_{i-1}}))+\mathbf{z_{i-1}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
<tbody id="S3.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E2.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{z_{i}}" display="inline"><semantics id="S3.E2.m1.1a"><msub id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml"><mi id="S3.E2.m1.1.1.2" xref="S3.E2.m1.1.1.2.cmml">𝐳</mi><mi id="S3.E2.m1.1.1.3" xref="S3.E2.m1.1.1.3.cmml">𝐢</mi></msub><annotation-xml encoding="MathML-Content" id="S3.E2.m1.1b"><apply id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.cmml" xref="S3.E2.m1.1.1">subscript</csymbol><ci id="S3.E2.m1.1.1.2.cmml" xref="S3.E2.m1.1.1.2">𝐳</ci><ci id="S3.E2.m1.1.1.3.cmml" xref="S3.E2.m1.1.1.3">𝐢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.1c">\displaystyle\mathbf{z_{i}}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_eqn_cell"><math id="S3.E2.m2.1" class="ltx_Math" alttext="\displaystyle=" display="inline"><semantics id="S3.E2.m2.1a"><mo id="S3.E2.m2.1.1" xref="S3.E2.m2.1.1.cmml">=</mo><annotation-xml encoding="MathML-Content" id="S3.E2.m2.1b"><eq id="S3.E2.m2.1.1.cmml" xref="S3.E2.m2.1.1"></eq></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m2.1c">\displaystyle=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E2.m3.1" class="ltx_Math" alttext="\displaystyle\text{MLP}(\text{LN}(\mathbf{a_{i-1}}))+\mathbf{a_{i-1}}," display="inline"><semantics id="S3.E2.m3.1a"><mrow id="S3.E2.m3.1.1.1" xref="S3.E2.m3.1.1.1.1.cmml"><mrow id="S3.E2.m3.1.1.1.1" xref="S3.E2.m3.1.1.1.1.cmml"><mrow id="S3.E2.m3.1.1.1.1.1" xref="S3.E2.m3.1.1.1.1.1.cmml"><mtext id="S3.E2.m3.1.1.1.1.1.3" xref="S3.E2.m3.1.1.1.1.1.3a.cmml">MLP</mtext><mo lspace="0em" rspace="0em" id="S3.E2.m3.1.1.1.1.1.2" xref="S3.E2.m3.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m3.1.1.1.1.1.1.1" xref="S3.E2.m3.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m3.1.1.1.1.1.1.1.2" xref="S3.E2.m3.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m3.1.1.1.1.1.1.1.1" xref="S3.E2.m3.1.1.1.1.1.1.1.1.cmml"><mtext id="S3.E2.m3.1.1.1.1.1.1.1.1.3" xref="S3.E2.m3.1.1.1.1.1.1.1.1.3a.cmml">LN</mtext><mo lspace="0em" rspace="0em" id="S3.E2.m3.1.1.1.1.1.1.1.1.2" xref="S3.E2.m3.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m3.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m3.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m3.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E2.m3.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m3.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m3.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐚</mi><mrow id="S3.E2.m3.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m3.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m3.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E2.m3.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">𝐢</mi><mo id="S3.E2.m3.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E2.m3.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S3.E2.m3.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E2.m3.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">𝟏</mn></mrow></msub><mo stretchy="false" id="S3.E2.m3.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m3.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E2.m3.1.1.1.1.1.1.1.3" xref="S3.E2.m3.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m3.1.1.1.1.2" xref="S3.E2.m3.1.1.1.1.2.cmml">+</mo><msub id="S3.E2.m3.1.1.1.1.3" xref="S3.E2.m3.1.1.1.1.3.cmml"><mi id="S3.E2.m3.1.1.1.1.3.2" xref="S3.E2.m3.1.1.1.1.3.2.cmml">𝐚</mi><mrow id="S3.E2.m3.1.1.1.1.3.3" xref="S3.E2.m3.1.1.1.1.3.3.cmml"><mi id="S3.E2.m3.1.1.1.1.3.3.2" xref="S3.E2.m3.1.1.1.1.3.3.2.cmml">𝐢</mi><mo id="S3.E2.m3.1.1.1.1.3.3.1" xref="S3.E2.m3.1.1.1.1.3.3.1.cmml">−</mo><mn id="S3.E2.m3.1.1.1.1.3.3.3" xref="S3.E2.m3.1.1.1.1.3.3.3.cmml">𝟏</mn></mrow></msub></mrow><mo id="S3.E2.m3.1.1.1.2" xref="S3.E2.m3.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m3.1b"><apply id="S3.E2.m3.1.1.1.1.cmml" xref="S3.E2.m3.1.1.1"><plus id="S3.E2.m3.1.1.1.1.2.cmml" xref="S3.E2.m3.1.1.1.1.2"></plus><apply id="S3.E2.m3.1.1.1.1.1.cmml" xref="S3.E2.m3.1.1.1.1.1"><times id="S3.E2.m3.1.1.1.1.1.2.cmml" xref="S3.E2.m3.1.1.1.1.1.2"></times><ci id="S3.E2.m3.1.1.1.1.1.3a.cmml" xref="S3.E2.m3.1.1.1.1.1.3"><mtext id="S3.E2.m3.1.1.1.1.1.3.cmml" xref="S3.E2.m3.1.1.1.1.1.3">MLP</mtext></ci><apply id="S3.E2.m3.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m3.1.1.1.1.1.1.1"><times id="S3.E2.m3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m3.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E2.m3.1.1.1.1.1.1.1.1.3a.cmml" xref="S3.E2.m3.1.1.1.1.1.1.1.1.3"><mtext id="S3.E2.m3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m3.1.1.1.1.1.1.1.1.3">LN</mtext></ci><apply id="S3.E2.m3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m3.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m3.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m3.1.1.1.1.1.1.1.1.1.1.1.2">𝐚</ci><apply id="S3.E2.m3.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m3.1.1.1.1.1.1.1.1.1.1.1.3"><minus id="S3.E2.m3.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m3.1.1.1.1.1.1.1.1.1.1.1.3.1"></minus><ci id="S3.E2.m3.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m3.1.1.1.1.1.1.1.1.1.1.1.3.2">𝐢</ci><cn type="integer" id="S3.E2.m3.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m3.1.1.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply></apply><apply id="S3.E2.m3.1.1.1.1.3.cmml" xref="S3.E2.m3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m3.1.1.1.1.3.1.cmml" xref="S3.E2.m3.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m3.1.1.1.1.3.2.cmml" xref="S3.E2.m3.1.1.1.1.3.2">𝐚</ci><apply id="S3.E2.m3.1.1.1.1.3.3.cmml" xref="S3.E2.m3.1.1.1.1.3.3"><minus id="S3.E2.m3.1.1.1.1.3.3.1.cmml" xref="S3.E2.m3.1.1.1.1.3.3.1"></minus><ci id="S3.E2.m3.1.1.1.1.3.3.2.cmml" xref="S3.E2.m3.1.1.1.1.3.3.2">𝐢</ci><cn type="integer" id="S3.E2.m3.1.1.1.1.3.3.3.cmml" xref="S3.E2.m3.1.1.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m3.1c">\displaystyle\text{MLP}(\text{LN}(\mathbf{a_{i-1}}))+\mathbf{a_{i-1}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p2.7" class="ltx_p">where <math id="S3.SS2.p2.4.m1.3" class="ltx_Math" alttext="i\in\{1,...,L\}" display="inline"><semantics id="S3.SS2.p2.4.m1.3a"><mrow id="S3.SS2.p2.4.m1.3.4" xref="S3.SS2.p2.4.m1.3.4.cmml"><mi id="S3.SS2.p2.4.m1.3.4.2" xref="S3.SS2.p2.4.m1.3.4.2.cmml">i</mi><mo id="S3.SS2.p2.4.m1.3.4.1" xref="S3.SS2.p2.4.m1.3.4.1.cmml">∈</mo><mrow id="S3.SS2.p2.4.m1.3.4.3.2" xref="S3.SS2.p2.4.m1.3.4.3.1.cmml"><mo stretchy="false" id="S3.SS2.p2.4.m1.3.4.3.2.1" xref="S3.SS2.p2.4.m1.3.4.3.1.cmml">{</mo><mn id="S3.SS2.p2.4.m1.1.1" xref="S3.SS2.p2.4.m1.1.1.cmml">1</mn><mo id="S3.SS2.p2.4.m1.3.4.3.2.2" xref="S3.SS2.p2.4.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p2.4.m1.2.2" xref="S3.SS2.p2.4.m1.2.2.cmml">…</mi><mo id="S3.SS2.p2.4.m1.3.4.3.2.3" xref="S3.SS2.p2.4.m1.3.4.3.1.cmml">,</mo><mi id="S3.SS2.p2.4.m1.3.3" xref="S3.SS2.p2.4.m1.3.3.cmml">L</mi><mo stretchy="false" id="S3.SS2.p2.4.m1.3.4.3.2.4" xref="S3.SS2.p2.4.m1.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m1.3b"><apply id="S3.SS2.p2.4.m1.3.4.cmml" xref="S3.SS2.p2.4.m1.3.4"><in id="S3.SS2.p2.4.m1.3.4.1.cmml" xref="S3.SS2.p2.4.m1.3.4.1"></in><ci id="S3.SS2.p2.4.m1.3.4.2.cmml" xref="S3.SS2.p2.4.m1.3.4.2">𝑖</ci><set id="S3.SS2.p2.4.m1.3.4.3.1.cmml" xref="S3.SS2.p2.4.m1.3.4.3.2"><cn type="integer" id="S3.SS2.p2.4.m1.1.1.cmml" xref="S3.SS2.p2.4.m1.1.1">1</cn><ci id="S3.SS2.p2.4.m1.2.2.cmml" xref="S3.SS2.p2.4.m1.2.2">…</ci><ci id="S3.SS2.p2.4.m1.3.3.cmml" xref="S3.SS2.p2.4.m1.3.3">𝐿</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m1.3c">i\in\{1,...,L\}</annotation></semantics></math>. The self-attention mechanism is composed of three point-wise linear layers mapping tokens to intermediate representations, queries <math id="S3.SS2.p2.5.m2.1" class="ltx_Math" alttext="\mathbf{Q}\in\mathbb{R}^{N\times d}" display="inline"><semantics id="S3.SS2.p2.5.m2.1a"><mrow id="S3.SS2.p2.5.m2.1.1" xref="S3.SS2.p2.5.m2.1.1.cmml"><mi id="S3.SS2.p2.5.m2.1.1.2" xref="S3.SS2.p2.5.m2.1.1.2.cmml">𝐐</mi><mo id="S3.SS2.p2.5.m2.1.1.1" xref="S3.SS2.p2.5.m2.1.1.1.cmml">∈</mo><msup id="S3.SS2.p2.5.m2.1.1.3" xref="S3.SS2.p2.5.m2.1.1.3.cmml"><mi id="S3.SS2.p2.5.m2.1.1.3.2" xref="S3.SS2.p2.5.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p2.5.m2.1.1.3.3" xref="S3.SS2.p2.5.m2.1.1.3.3.cmml"><mi id="S3.SS2.p2.5.m2.1.1.3.3.2" xref="S3.SS2.p2.5.m2.1.1.3.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p2.5.m2.1.1.3.3.1" xref="S3.SS2.p2.5.m2.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p2.5.m2.1.1.3.3.3" xref="S3.SS2.p2.5.m2.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m2.1b"><apply id="S3.SS2.p2.5.m2.1.1.cmml" xref="S3.SS2.p2.5.m2.1.1"><in id="S3.SS2.p2.5.m2.1.1.1.cmml" xref="S3.SS2.p2.5.m2.1.1.1"></in><ci id="S3.SS2.p2.5.m2.1.1.2.cmml" xref="S3.SS2.p2.5.m2.1.1.2">𝐐</ci><apply id="S3.SS2.p2.5.m2.1.1.3.cmml" xref="S3.SS2.p2.5.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.5.m2.1.1.3.1.cmml" xref="S3.SS2.p2.5.m2.1.1.3">superscript</csymbol><ci id="S3.SS2.p2.5.m2.1.1.3.2.cmml" xref="S3.SS2.p2.5.m2.1.1.3.2">ℝ</ci><apply id="S3.SS2.p2.5.m2.1.1.3.3.cmml" xref="S3.SS2.p2.5.m2.1.1.3.3"><times id="S3.SS2.p2.5.m2.1.1.3.3.1.cmml" xref="S3.SS2.p2.5.m2.1.1.3.3.1"></times><ci id="S3.SS2.p2.5.m2.1.1.3.3.2.cmml" xref="S3.SS2.p2.5.m2.1.1.3.3.2">𝑁</ci><ci id="S3.SS2.p2.5.m2.1.1.3.3.3.cmml" xref="S3.SS2.p2.5.m2.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m2.1c">\mathbf{Q}\in\mathbb{R}^{N\times d}</annotation></semantics></math>, keys <math id="S3.SS2.p2.6.m3.1" class="ltx_Math" alttext="\mathbf{K}\in\mathbb{R}^{N\times d}" display="inline"><semantics id="S3.SS2.p2.6.m3.1a"><mrow id="S3.SS2.p2.6.m3.1.1" xref="S3.SS2.p2.6.m3.1.1.cmml"><mi id="S3.SS2.p2.6.m3.1.1.2" xref="S3.SS2.p2.6.m3.1.1.2.cmml">𝐊</mi><mo id="S3.SS2.p2.6.m3.1.1.1" xref="S3.SS2.p2.6.m3.1.1.1.cmml">∈</mo><msup id="S3.SS2.p2.6.m3.1.1.3" xref="S3.SS2.p2.6.m3.1.1.3.cmml"><mi id="S3.SS2.p2.6.m3.1.1.3.2" xref="S3.SS2.p2.6.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p2.6.m3.1.1.3.3" xref="S3.SS2.p2.6.m3.1.1.3.3.cmml"><mi id="S3.SS2.p2.6.m3.1.1.3.3.2" xref="S3.SS2.p2.6.m3.1.1.3.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p2.6.m3.1.1.3.3.1" xref="S3.SS2.p2.6.m3.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p2.6.m3.1.1.3.3.3" xref="S3.SS2.p2.6.m3.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m3.1b"><apply id="S3.SS2.p2.6.m3.1.1.cmml" xref="S3.SS2.p2.6.m3.1.1"><in id="S3.SS2.p2.6.m3.1.1.1.cmml" xref="S3.SS2.p2.6.m3.1.1.1"></in><ci id="S3.SS2.p2.6.m3.1.1.2.cmml" xref="S3.SS2.p2.6.m3.1.1.2">𝐊</ci><apply id="S3.SS2.p2.6.m3.1.1.3.cmml" xref="S3.SS2.p2.6.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m3.1.1.3.1.cmml" xref="S3.SS2.p2.6.m3.1.1.3">superscript</csymbol><ci id="S3.SS2.p2.6.m3.1.1.3.2.cmml" xref="S3.SS2.p2.6.m3.1.1.3.2">ℝ</ci><apply id="S3.SS2.p2.6.m3.1.1.3.3.cmml" xref="S3.SS2.p2.6.m3.1.1.3.3"><times id="S3.SS2.p2.6.m3.1.1.3.3.1.cmml" xref="S3.SS2.p2.6.m3.1.1.3.3.1"></times><ci id="S3.SS2.p2.6.m3.1.1.3.3.2.cmml" xref="S3.SS2.p2.6.m3.1.1.3.3.2">𝑁</ci><ci id="S3.SS2.p2.6.m3.1.1.3.3.3.cmml" xref="S3.SS2.p2.6.m3.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m3.1c">\mathbf{K}\in\mathbb{R}^{N\times d}</annotation></semantics></math> and values <math id="S3.SS2.p2.7.m4.1" class="ltx_Math" alttext="\mathbf{V}\in\mathbb{R}^{N\times d}" display="inline"><semantics id="S3.SS2.p2.7.m4.1a"><mrow id="S3.SS2.p2.7.m4.1.1" xref="S3.SS2.p2.7.m4.1.1.cmml"><mi id="S3.SS2.p2.7.m4.1.1.2" xref="S3.SS2.p2.7.m4.1.1.2.cmml">𝐕</mi><mo id="S3.SS2.p2.7.m4.1.1.1" xref="S3.SS2.p2.7.m4.1.1.1.cmml">∈</mo><msup id="S3.SS2.p2.7.m4.1.1.3" xref="S3.SS2.p2.7.m4.1.1.3.cmml"><mi id="S3.SS2.p2.7.m4.1.1.3.2" xref="S3.SS2.p2.7.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p2.7.m4.1.1.3.3" xref="S3.SS2.p2.7.m4.1.1.3.3.cmml"><mi id="S3.SS2.p2.7.m4.1.1.3.3.2" xref="S3.SS2.p2.7.m4.1.1.3.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p2.7.m4.1.1.3.3.1" xref="S3.SS2.p2.7.m4.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p2.7.m4.1.1.3.3.3" xref="S3.SS2.p2.7.m4.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m4.1b"><apply id="S3.SS2.p2.7.m4.1.1.cmml" xref="S3.SS2.p2.7.m4.1.1"><in id="S3.SS2.p2.7.m4.1.1.1.cmml" xref="S3.SS2.p2.7.m4.1.1.1"></in><ci id="S3.SS2.p2.7.m4.1.1.2.cmml" xref="S3.SS2.p2.7.m4.1.1.2">𝐕</ci><apply id="S3.SS2.p2.7.m4.1.1.3.cmml" xref="S3.SS2.p2.7.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.7.m4.1.1.3.1.cmml" xref="S3.SS2.p2.7.m4.1.1.3">superscript</csymbol><ci id="S3.SS2.p2.7.m4.1.1.3.2.cmml" xref="S3.SS2.p2.7.m4.1.1.3.2">ℝ</ci><apply id="S3.SS2.p2.7.m4.1.1.3.3.cmml" xref="S3.SS2.p2.7.m4.1.1.3.3"><times id="S3.SS2.p2.7.m4.1.1.3.3.1.cmml" xref="S3.SS2.p2.7.m4.1.1.3.3.1"></times><ci id="S3.SS2.p2.7.m4.1.1.3.3.2.cmml" xref="S3.SS2.p2.7.m4.1.1.3.3.2">𝑁</ci><ci id="S3.SS2.p2.7.m4.1.1.3.3.3.cmml" xref="S3.SS2.p2.7.m4.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m4.1c">\mathbf{V}\in\mathbb{R}^{N\times d}</annotation></semantics></math>. Self-attention is then computed as follows</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.5" class="ltx_Math" alttext="\text{MSA}(\mathbf{Q},\mathbf{K},\mathbf{V})=\text{softmax}\left(\frac{\mathbf{QK}^{T}}{\sqrt{d}}\right)\mathbf{V}." display="block"><semantics id="S3.E3.m1.5a"><mrow id="S3.E3.m1.5.5.1" xref="S3.E3.m1.5.5.1.1.cmml"><mrow id="S3.E3.m1.5.5.1.1" xref="S3.E3.m1.5.5.1.1.cmml"><mrow id="S3.E3.m1.5.5.1.1.2" xref="S3.E3.m1.5.5.1.1.2.cmml"><mtext id="S3.E3.m1.5.5.1.1.2.2" xref="S3.E3.m1.5.5.1.1.2.2a.cmml">MSA</mtext><mo lspace="0em" rspace="0em" id="S3.E3.m1.5.5.1.1.2.1" xref="S3.E3.m1.5.5.1.1.2.1.cmml">​</mo><mrow id="S3.E3.m1.5.5.1.1.2.3.2" xref="S3.E3.m1.5.5.1.1.2.3.1.cmml"><mo stretchy="false" id="S3.E3.m1.5.5.1.1.2.3.2.1" xref="S3.E3.m1.5.5.1.1.2.3.1.cmml">(</mo><mi id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">𝐐</mi><mo id="S3.E3.m1.5.5.1.1.2.3.2.2" xref="S3.E3.m1.5.5.1.1.2.3.1.cmml">,</mo><mi id="S3.E3.m1.2.2" xref="S3.E3.m1.2.2.cmml">𝐊</mi><mo id="S3.E3.m1.5.5.1.1.2.3.2.3" xref="S3.E3.m1.5.5.1.1.2.3.1.cmml">,</mo><mi id="S3.E3.m1.3.3" xref="S3.E3.m1.3.3.cmml">𝐕</mi><mo stretchy="false" id="S3.E3.m1.5.5.1.1.2.3.2.4" xref="S3.E3.m1.5.5.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.5.5.1.1.1" xref="S3.E3.m1.5.5.1.1.1.cmml">=</mo><mrow id="S3.E3.m1.5.5.1.1.3" xref="S3.E3.m1.5.5.1.1.3.cmml"><mtext id="S3.E3.m1.5.5.1.1.3.2" xref="S3.E3.m1.5.5.1.1.3.2a.cmml">softmax</mtext><mo lspace="0em" rspace="0em" id="S3.E3.m1.5.5.1.1.3.1" xref="S3.E3.m1.5.5.1.1.3.1.cmml">​</mo><mrow id="S3.E3.m1.5.5.1.1.3.3.2" xref="S3.E3.m1.4.4.cmml"><mo id="S3.E3.m1.5.5.1.1.3.3.2.1" xref="S3.E3.m1.4.4.cmml">(</mo><mfrac id="S3.E3.m1.4.4" xref="S3.E3.m1.4.4.cmml"><msup id="S3.E3.m1.4.4.2" xref="S3.E3.m1.4.4.2.cmml"><mi id="S3.E3.m1.4.4.2.2" xref="S3.E3.m1.4.4.2.2.cmml">𝐐𝐊</mi><mi id="S3.E3.m1.4.4.2.3" xref="S3.E3.m1.4.4.2.3.cmml">T</mi></msup><msqrt id="S3.E3.m1.4.4.3" xref="S3.E3.m1.4.4.3.cmml"><mi id="S3.E3.m1.4.4.3.2" xref="S3.E3.m1.4.4.3.2.cmml">d</mi></msqrt></mfrac><mo id="S3.E3.m1.5.5.1.1.3.3.2.2" xref="S3.E3.m1.4.4.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E3.m1.5.5.1.1.3.1a" xref="S3.E3.m1.5.5.1.1.3.1.cmml">​</mo><mi id="S3.E3.m1.5.5.1.1.3.4" xref="S3.E3.m1.5.5.1.1.3.4.cmml">𝐕</mi></mrow></mrow><mo lspace="0em" id="S3.E3.m1.5.5.1.2" xref="S3.E3.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.5b"><apply id="S3.E3.m1.5.5.1.1.cmml" xref="S3.E3.m1.5.5.1"><eq id="S3.E3.m1.5.5.1.1.1.cmml" xref="S3.E3.m1.5.5.1.1.1"></eq><apply id="S3.E3.m1.5.5.1.1.2.cmml" xref="S3.E3.m1.5.5.1.1.2"><times id="S3.E3.m1.5.5.1.1.2.1.cmml" xref="S3.E3.m1.5.5.1.1.2.1"></times><ci id="S3.E3.m1.5.5.1.1.2.2a.cmml" xref="S3.E3.m1.5.5.1.1.2.2"><mtext id="S3.E3.m1.5.5.1.1.2.2.cmml" xref="S3.E3.m1.5.5.1.1.2.2">MSA</mtext></ci><vector id="S3.E3.m1.5.5.1.1.2.3.1.cmml" xref="S3.E3.m1.5.5.1.1.2.3.2"><ci id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">𝐐</ci><ci id="S3.E3.m1.2.2.cmml" xref="S3.E3.m1.2.2">𝐊</ci><ci id="S3.E3.m1.3.3.cmml" xref="S3.E3.m1.3.3">𝐕</ci></vector></apply><apply id="S3.E3.m1.5.5.1.1.3.cmml" xref="S3.E3.m1.5.5.1.1.3"><times id="S3.E3.m1.5.5.1.1.3.1.cmml" xref="S3.E3.m1.5.5.1.1.3.1"></times><ci id="S3.E3.m1.5.5.1.1.3.2a.cmml" xref="S3.E3.m1.5.5.1.1.3.2"><mtext id="S3.E3.m1.5.5.1.1.3.2.cmml" xref="S3.E3.m1.5.5.1.1.3.2">softmax</mtext></ci><apply id="S3.E3.m1.4.4.cmml" xref="S3.E3.m1.5.5.1.1.3.3.2"><divide id="S3.E3.m1.4.4.1.cmml" xref="S3.E3.m1.5.5.1.1.3.3.2"></divide><apply id="S3.E3.m1.4.4.2.cmml" xref="S3.E3.m1.4.4.2"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.2.1.cmml" xref="S3.E3.m1.4.4.2">superscript</csymbol><ci id="S3.E3.m1.4.4.2.2.cmml" xref="S3.E3.m1.4.4.2.2">𝐐𝐊</ci><ci id="S3.E3.m1.4.4.2.3.cmml" xref="S3.E3.m1.4.4.2.3">𝑇</ci></apply><apply id="S3.E3.m1.4.4.3.cmml" xref="S3.E3.m1.4.4.3"><root id="S3.E3.m1.4.4.3a.cmml" xref="S3.E3.m1.4.4.3"></root><ci id="S3.E3.m1.4.4.3.2.cmml" xref="S3.E3.m1.4.4.3.2">𝑑</ci></apply></apply><ci id="S3.E3.m1.5.5.1.1.3.4.cmml" xref="S3.E3.m1.5.5.1.1.3.4">𝐕</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.5c">\text{MSA}(\mathbf{Q},\mathbf{K},\mathbf{V})=\text{softmax}\left(\frac{\mathbf{QK}^{T}}{\sqrt{d}}\right)\mathbf{V}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.1" class="ltx_p">We employ a vanilla ViT-B<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> as our transformer branch, which obtains a contextualized encoding sequence containing rich global-aware information which is crucial to roughly identifying the potential target objects.</p>
</div>
<div id="S3.SS2.p4" class="ltx_para ltx_noindent">
<p id="S3.SS2.p4.1" class="ltx_p"><span id="S3.SS2.p4.1.1" class="ltx_text ltx_font_bold">CNN Branch</span>
As shown in <a href="#S2.F2" title="In 2 Related Work ‣ DQnet: Cross-Model Detail Querying for Camouflaged Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">2</span></a>, the ResNet-50 is chosen as our CNN branch, which by convention adopts the feature pyramid structure, where the resolution of feature maps decreases with network depth while the channel number increases. Five feature maps are generated in different stages of ResNet-50, denoted as <math id="S3.SS2.p4.1.m1.7" class="ltx_Math" alttext="\left\{\bm{R}_{i}|i=1,2,3,4,5\right\}" display="inline"><semantics id="S3.SS2.p4.1.m1.7a"><mrow id="S3.SS2.p4.1.m1.7.7.2" xref="S3.SS2.p4.1.m1.7.7.3.cmml"><mo id="S3.SS2.p4.1.m1.7.7.2.3" xref="S3.SS2.p4.1.m1.7.7.3.1.cmml">{</mo><msub id="S3.SS2.p4.1.m1.6.6.1.1" xref="S3.SS2.p4.1.m1.6.6.1.1.cmml"><mi id="S3.SS2.p4.1.m1.6.6.1.1.2" xref="S3.SS2.p4.1.m1.6.6.1.1.2.cmml">𝑹</mi><mi id="S3.SS2.p4.1.m1.6.6.1.1.3" xref="S3.SS2.p4.1.m1.6.6.1.1.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p4.1.m1.7.7.2.4" xref="S3.SS2.p4.1.m1.7.7.3.1.cmml">|</mo><mrow id="S3.SS2.p4.1.m1.7.7.2.2" xref="S3.SS2.p4.1.m1.7.7.2.2.cmml"><mi id="S3.SS2.p4.1.m1.7.7.2.2.2" xref="S3.SS2.p4.1.m1.7.7.2.2.2.cmml">i</mi><mo id="S3.SS2.p4.1.m1.7.7.2.2.1" xref="S3.SS2.p4.1.m1.7.7.2.2.1.cmml">=</mo><mrow id="S3.SS2.p4.1.m1.7.7.2.2.3.2" xref="S3.SS2.p4.1.m1.7.7.2.2.3.1.cmml"><mn id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml">1</mn><mo id="S3.SS2.p4.1.m1.7.7.2.2.3.2.1" xref="S3.SS2.p4.1.m1.7.7.2.2.3.1.cmml">,</mo><mn id="S3.SS2.p4.1.m1.2.2" xref="S3.SS2.p4.1.m1.2.2.cmml">2</mn><mo id="S3.SS2.p4.1.m1.7.7.2.2.3.2.2" xref="S3.SS2.p4.1.m1.7.7.2.2.3.1.cmml">,</mo><mn id="S3.SS2.p4.1.m1.3.3" xref="S3.SS2.p4.1.m1.3.3.cmml">3</mn><mo id="S3.SS2.p4.1.m1.7.7.2.2.3.2.3" xref="S3.SS2.p4.1.m1.7.7.2.2.3.1.cmml">,</mo><mn id="S3.SS2.p4.1.m1.4.4" xref="S3.SS2.p4.1.m1.4.4.cmml">4</mn><mo id="S3.SS2.p4.1.m1.7.7.2.2.3.2.4" xref="S3.SS2.p4.1.m1.7.7.2.2.3.1.cmml">,</mo><mn id="S3.SS2.p4.1.m1.5.5" xref="S3.SS2.p4.1.m1.5.5.cmml">5</mn></mrow></mrow><mo id="S3.SS2.p4.1.m1.7.7.2.5" xref="S3.SS2.p4.1.m1.7.7.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.7b"><apply id="S3.SS2.p4.1.m1.7.7.3.cmml" xref="S3.SS2.p4.1.m1.7.7.2"><csymbol cd="latexml" id="S3.SS2.p4.1.m1.7.7.3.1.cmml" xref="S3.SS2.p4.1.m1.7.7.2.3">conditional-set</csymbol><apply id="S3.SS2.p4.1.m1.6.6.1.1.cmml" xref="S3.SS2.p4.1.m1.6.6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.6.6.1.1.1.cmml" xref="S3.SS2.p4.1.m1.6.6.1.1">subscript</csymbol><ci id="S3.SS2.p4.1.m1.6.6.1.1.2.cmml" xref="S3.SS2.p4.1.m1.6.6.1.1.2">𝑹</ci><ci id="S3.SS2.p4.1.m1.6.6.1.1.3.cmml" xref="S3.SS2.p4.1.m1.6.6.1.1.3">𝑖</ci></apply><apply id="S3.SS2.p4.1.m1.7.7.2.2.cmml" xref="S3.SS2.p4.1.m1.7.7.2.2"><eq id="S3.SS2.p4.1.m1.7.7.2.2.1.cmml" xref="S3.SS2.p4.1.m1.7.7.2.2.1"></eq><ci id="S3.SS2.p4.1.m1.7.7.2.2.2.cmml" xref="S3.SS2.p4.1.m1.7.7.2.2.2">𝑖</ci><list id="S3.SS2.p4.1.m1.7.7.2.2.3.1.cmml" xref="S3.SS2.p4.1.m1.7.7.2.2.3.2"><cn type="integer" id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1">1</cn><cn type="integer" id="S3.SS2.p4.1.m1.2.2.cmml" xref="S3.SS2.p4.1.m1.2.2">2</cn><cn type="integer" id="S3.SS2.p4.1.m1.3.3.cmml" xref="S3.SS2.p4.1.m1.3.3">3</cn><cn type="integer" id="S3.SS2.p4.1.m1.4.4.cmml" xref="S3.SS2.p4.1.m1.4.4">4</cn><cn type="integer" id="S3.SS2.p4.1.m1.5.5.cmml" xref="S3.SS2.p4.1.m1.5.5">5</cn></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.7c">\left\{\bm{R}_{i}|i=1,2,3,4,5\right\}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS2.p5" class="ltx_para">
<p id="S3.SS2.p5.1" class="ltx_p">Visual transformers <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> project an image patch into a vector through a single step, causing the lost of local details. In CNN, convolution kernels slide over feature maps with overlap, which preserves fine-grained local details yet lacks the ability to get continuous semantics. The transformer encoder on the other hand, is able to get accurate global-aware information. Combining these two together allows the feature extractor to not only inherit global information but also remedy the defects caused by ViT lacking spatial inductive bias. Consequently, the ViT branch is able to consecutively provide global cues for the ConNets branch.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Cross-Model Querying</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">Given the features from the CNN branch and the ViT branch, our goal is to combine them to get an enhanced representaitions and to enable explorations of effective feature enhancement for addressing the COD issues. To this end, we design a multi-scale detail querying mechanism to eliminate the inconsistency between these two kinds of features in an interactive way.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para ltx_noindent">
<p id="S3.SS3.p2.6" class="ltx_p"><span id="S3.SS3.p2.6.1" class="ltx_text ltx_font_bold">Feature Alignment.</span>
To eliminate the dimension inconsistency, we first perform tokenization to the last four feature maps of ResNet (namely, <math id="S3.SS3.p2.1.m1.6" class="ltx_Math" alttext="\left\{\bm{R}_{i}|i=1,2,3,4\right\}" display="inline"><semantics id="S3.SS3.p2.1.m1.6a"><mrow id="S3.SS3.p2.1.m1.6.6.2" xref="S3.SS3.p2.1.m1.6.6.3.cmml"><mo id="S3.SS3.p2.1.m1.6.6.2.3" xref="S3.SS3.p2.1.m1.6.6.3.1.cmml">{</mo><msub id="S3.SS3.p2.1.m1.5.5.1.1" xref="S3.SS3.p2.1.m1.5.5.1.1.cmml"><mi id="S3.SS3.p2.1.m1.5.5.1.1.2" xref="S3.SS3.p2.1.m1.5.5.1.1.2.cmml">𝑹</mi><mi id="S3.SS3.p2.1.m1.5.5.1.1.3" xref="S3.SS3.p2.1.m1.5.5.1.1.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p2.1.m1.6.6.2.4" xref="S3.SS3.p2.1.m1.6.6.3.1.cmml">|</mo><mrow id="S3.SS3.p2.1.m1.6.6.2.2" xref="S3.SS3.p2.1.m1.6.6.2.2.cmml"><mi id="S3.SS3.p2.1.m1.6.6.2.2.2" xref="S3.SS3.p2.1.m1.6.6.2.2.2.cmml">i</mi><mo id="S3.SS3.p2.1.m1.6.6.2.2.1" xref="S3.SS3.p2.1.m1.6.6.2.2.1.cmml">=</mo><mrow id="S3.SS3.p2.1.m1.6.6.2.2.3.2" xref="S3.SS3.p2.1.m1.6.6.2.2.3.1.cmml"><mn id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">1</mn><mo id="S3.SS3.p2.1.m1.6.6.2.2.3.2.1" xref="S3.SS3.p2.1.m1.6.6.2.2.3.1.cmml">,</mo><mn id="S3.SS3.p2.1.m1.2.2" xref="S3.SS3.p2.1.m1.2.2.cmml">2</mn><mo id="S3.SS3.p2.1.m1.6.6.2.2.3.2.2" xref="S3.SS3.p2.1.m1.6.6.2.2.3.1.cmml">,</mo><mn id="S3.SS3.p2.1.m1.3.3" xref="S3.SS3.p2.1.m1.3.3.cmml">3</mn><mo id="S3.SS3.p2.1.m1.6.6.2.2.3.2.3" xref="S3.SS3.p2.1.m1.6.6.2.2.3.1.cmml">,</mo><mn id="S3.SS3.p2.1.m1.4.4" xref="S3.SS3.p2.1.m1.4.4.cmml">4</mn></mrow></mrow><mo id="S3.SS3.p2.1.m1.6.6.2.5" xref="S3.SS3.p2.1.m1.6.6.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.6b"><apply id="S3.SS3.p2.1.m1.6.6.3.cmml" xref="S3.SS3.p2.1.m1.6.6.2"><csymbol cd="latexml" id="S3.SS3.p2.1.m1.6.6.3.1.cmml" xref="S3.SS3.p2.1.m1.6.6.2.3">conditional-set</csymbol><apply id="S3.SS3.p2.1.m1.5.5.1.1.cmml" xref="S3.SS3.p2.1.m1.5.5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.5.5.1.1.1.cmml" xref="S3.SS3.p2.1.m1.5.5.1.1">subscript</csymbol><ci id="S3.SS3.p2.1.m1.5.5.1.1.2.cmml" xref="S3.SS3.p2.1.m1.5.5.1.1.2">𝑹</ci><ci id="S3.SS3.p2.1.m1.5.5.1.1.3.cmml" xref="S3.SS3.p2.1.m1.5.5.1.1.3">𝑖</ci></apply><apply id="S3.SS3.p2.1.m1.6.6.2.2.cmml" xref="S3.SS3.p2.1.m1.6.6.2.2"><eq id="S3.SS3.p2.1.m1.6.6.2.2.1.cmml" xref="S3.SS3.p2.1.m1.6.6.2.2.1"></eq><ci id="S3.SS3.p2.1.m1.6.6.2.2.2.cmml" xref="S3.SS3.p2.1.m1.6.6.2.2.2">𝑖</ci><list id="S3.SS3.p2.1.m1.6.6.2.2.3.1.cmml" xref="S3.SS3.p2.1.m1.6.6.2.2.3.2"><cn type="integer" id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">1</cn><cn type="integer" id="S3.SS3.p2.1.m1.2.2.cmml" xref="S3.SS3.p2.1.m1.2.2">2</cn><cn type="integer" id="S3.SS3.p2.1.m1.3.3.cmml" xref="S3.SS3.p2.1.m1.3.3">3</cn><cn type="integer" id="S3.SS3.p2.1.m1.4.4.cmml" xref="S3.SS3.p2.1.m1.4.4">4</cn></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.6c">\left\{\bm{R}_{i}|i=1,2,3,4\right\}</annotation></semantics></math>) by reshaping the input <math id="S3.SS3.p2.2.m2.1" class="ltx_Math" alttext="\bm{R}_{i}" display="inline"><semantics id="S3.SS3.p2.2.m2.1a"><msub id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml"><mi id="S3.SS3.p2.2.m2.1.1.2" xref="S3.SS3.p2.2.m2.1.1.2.cmml">𝑹</mi><mi id="S3.SS3.p2.2.m2.1.1.3" xref="S3.SS3.p2.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><apply id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p2.2.m2.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2">𝑹</ci><ci id="S3.SS3.p2.2.m2.1.1.3.cmml" xref="S3.SS3.p2.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">\bm{R}_{i}</annotation></semantics></math> into a sequence of flattened 2D patches {<math id="S3.SS3.p2.3.m3.1" class="ltx_math_unparsed" alttext="\bm{Y}_{i}^{k}\in\mathbb{R}^{P^{2}\cdot C}|k=1,..,N\}" display="inline"><semantics id="S3.SS3.p2.3.m3.1a"><mrow id="S3.SS3.p2.3.m3.1b"><msubsup id="S3.SS3.p2.3.m3.1.1"><mi id="S3.SS3.p2.3.m3.1.1.2.2">𝒀</mi><mi id="S3.SS3.p2.3.m3.1.1.2.3">i</mi><mi id="S3.SS3.p2.3.m3.1.1.3">k</mi></msubsup><mo id="S3.SS3.p2.3.m3.1.2">∈</mo><msup id="S3.SS3.p2.3.m3.1.3"><mi id="S3.SS3.p2.3.m3.1.3.2">ℝ</mi><mrow id="S3.SS3.p2.3.m3.1.3.3"><msup id="S3.SS3.p2.3.m3.1.3.3.2"><mi id="S3.SS3.p2.3.m3.1.3.3.2.2">P</mi><mn id="S3.SS3.p2.3.m3.1.3.3.2.3">2</mn></msup><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p2.3.m3.1.3.3.1">⋅</mo><mi id="S3.SS3.p2.3.m3.1.3.3.3">C</mi></mrow></msup><mo fence="false" rspace="0.167em" stretchy="false" id="S3.SS3.p2.3.m3.1.4">|</mo><mi id="S3.SS3.p2.3.m3.1.5">k</mi><mo id="S3.SS3.p2.3.m3.1.6">=</mo><mn id="S3.SS3.p2.3.m3.1.7">1</mn><mo id="S3.SS3.p2.3.m3.1.8">,</mo><mo lspace="0em" rspace="0.0835em" id="S3.SS3.p2.3.m3.1.9">.</mo><mo lspace="0.0835em" rspace="0.167em" id="S3.SS3.p2.3.m3.1.10">.</mo><mo id="S3.SS3.p2.3.m3.1.11">,</mo><mi id="S3.SS3.p2.3.m3.1.12">N</mi><mo stretchy="false" id="S3.SS3.p2.3.m3.1.13">}</mo></mrow><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">\bm{Y}_{i}^{k}\in\mathbb{R}^{P^{2}\cdot C}|k=1,..,N\}</annotation></semantics></math>, where each patch is of size <math id="S3.SS3.p2.4.m4.1" class="ltx_Math" alttext="P\times P" display="inline"><semantics id="S3.SS3.p2.4.m4.1a"><mrow id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml"><mi id="S3.SS3.p2.4.m4.1.1.2" xref="S3.SS3.p2.4.m4.1.1.2.cmml">P</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p2.4.m4.1.1.1" xref="S3.SS3.p2.4.m4.1.1.1.cmml">×</mo><mi id="S3.SS3.p2.4.m4.1.1.3" xref="S3.SS3.p2.4.m4.1.1.3.cmml">P</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><apply id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1"><times id="S3.SS3.p2.4.m4.1.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1.1"></times><ci id="S3.SS3.p2.4.m4.1.1.2.cmml" xref="S3.SS3.p2.4.m4.1.1.2">𝑃</ci><ci id="S3.SS3.p2.4.m4.1.1.3.cmml" xref="S3.SS3.p2.4.m4.1.1.3">𝑃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">P\times P</annotation></semantics></math> and <math id="S3.SS3.p2.5.m5.1" class="ltx_Math" alttext="N=\frac{HW}{P^{2}}" display="inline"><semantics id="S3.SS3.p2.5.m5.1a"><mrow id="S3.SS3.p2.5.m5.1.1" xref="S3.SS3.p2.5.m5.1.1.cmml"><mi id="S3.SS3.p2.5.m5.1.1.2" xref="S3.SS3.p2.5.m5.1.1.2.cmml">N</mi><mo id="S3.SS3.p2.5.m5.1.1.1" xref="S3.SS3.p2.5.m5.1.1.1.cmml">=</mo><mfrac id="S3.SS3.p2.5.m5.1.1.3" xref="S3.SS3.p2.5.m5.1.1.3.cmml"><mrow id="S3.SS3.p2.5.m5.1.1.3.2" xref="S3.SS3.p2.5.m5.1.1.3.2.cmml"><mi id="S3.SS3.p2.5.m5.1.1.3.2.2" xref="S3.SS3.p2.5.m5.1.1.3.2.2.cmml">H</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.5.m5.1.1.3.2.1" xref="S3.SS3.p2.5.m5.1.1.3.2.1.cmml">​</mo><mi id="S3.SS3.p2.5.m5.1.1.3.2.3" xref="S3.SS3.p2.5.m5.1.1.3.2.3.cmml">W</mi></mrow><msup id="S3.SS3.p2.5.m5.1.1.3.3" xref="S3.SS3.p2.5.m5.1.1.3.3.cmml"><mi id="S3.SS3.p2.5.m5.1.1.3.3.2" xref="S3.SS3.p2.5.m5.1.1.3.3.2.cmml">P</mi><mn id="S3.SS3.p2.5.m5.1.1.3.3.3" xref="S3.SS3.p2.5.m5.1.1.3.3.3.cmml">2</mn></msup></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.1b"><apply id="S3.SS3.p2.5.m5.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1"><eq id="S3.SS3.p2.5.m5.1.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1.1"></eq><ci id="S3.SS3.p2.5.m5.1.1.2.cmml" xref="S3.SS3.p2.5.m5.1.1.2">𝑁</ci><apply id="S3.SS3.p2.5.m5.1.1.3.cmml" xref="S3.SS3.p2.5.m5.1.1.3"><divide id="S3.SS3.p2.5.m5.1.1.3.1.cmml" xref="S3.SS3.p2.5.m5.1.1.3"></divide><apply id="S3.SS3.p2.5.m5.1.1.3.2.cmml" xref="S3.SS3.p2.5.m5.1.1.3.2"><times id="S3.SS3.p2.5.m5.1.1.3.2.1.cmml" xref="S3.SS3.p2.5.m5.1.1.3.2.1"></times><ci id="S3.SS3.p2.5.m5.1.1.3.2.2.cmml" xref="S3.SS3.p2.5.m5.1.1.3.2.2">𝐻</ci><ci id="S3.SS3.p2.5.m5.1.1.3.2.3.cmml" xref="S3.SS3.p2.5.m5.1.1.3.2.3">𝑊</ci></apply><apply id="S3.SS3.p2.5.m5.1.1.3.3.cmml" xref="S3.SS3.p2.5.m5.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.1.1.3.3.1.cmml" xref="S3.SS3.p2.5.m5.1.1.3.3">superscript</csymbol><ci id="S3.SS3.p2.5.m5.1.1.3.3.2.cmml" xref="S3.SS3.p2.5.m5.1.1.3.3.2">𝑃</ci><cn type="integer" id="S3.SS3.p2.5.m5.1.1.3.3.3.cmml" xref="S3.SS3.p2.5.m5.1.1.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.1c">N=\frac{HW}{P^{2}}</annotation></semantics></math> is the number of image patches (<em id="S3.SS3.p2.6.2" class="ltx_emph ltx_font_italic">i.e.</em>, the input sequence length). Concretely, feature maps first require getting through maxpooling downsampling to align the spatial scales with the ViT patch embeddings. An 1<math id="S3.SS3.p2.6.m6.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S3.SS3.p2.6.m6.1a"><mo id="S3.SS3.p2.6.m6.1.1" xref="S3.SS3.p2.6.m6.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m6.1b"><times id="S3.SS3.p2.6.m6.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m6.1c">\times</annotation></semantics></math>1 convolution is then used to complete the channel dimension alignment, followed by a LayerNorm layer to regularize the features. Finally, the aligned features are sent to Relation-Based Querying (RBQ) module to get an enhanced representation for COD, which is illustrated in the next section. When fed back to the ResNet branch, the enhanced patch embeddings first get through deconvolution up-sampling to restore the spatial scale and to align the channel dimensions simultaneously, followed by a BatchNorm layer to recover the CNN-style regularization, as shown in <a href="#S2.F2" title="In 2 Related Work ‣ DQnet: Cross-Model Detail Querying for Camouflaged Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<div id="S3.SS3.p3" class="ltx_para">
<p id="S3.SS3.p3.1" class="ltx_p">It should be noted that the spatial and channel dimensions are constant for each ViT layer, whereas the classic CNN has a pyramid-like feature map structure where the spatial and channel dimensions vary in every stage. Due to this innate difference, determining which position to perform the alignment is an important issue. Here in our scenario, we simply use only the last feature map from the ViT to provide global cues, which should have the strongest features. The proposed alignment mechanism takes place at the beginning of the four ResNet stages, together with the RBQ to help retrieving crucial local details in every scale.</p>
</div>
<div id="S3.SS3.p4" class="ltx_para ltx_noindent">
<p id="S3.SS3.p4.5" class="ltx_p"><span id="S3.SS3.p4.5.1" class="ltx_text ltx_font_bold">Relation-Based Querying.</span>
Conventionally, direct element-wise addition is used to fuse the aligned features. However, in COD scenario, directly fusion of low-level details and high-level semantics may lead to a phenomenon that the fine-graind details are easily overwhelmed by surrounding contextual information. Thus, we propose a Relation-Based Querying (RBQ) module to bridge the cross-model semantic gaps by calculating the pixel-wise relations of two kinds of features and adding the relation-based result to the original fusion. Given the ViT features <math id="S3.SS3.p4.1.m1.1" class="ltx_Math" alttext="Z\in\mathbb{R}^{P^{2}\cdot C}" display="inline"><semantics id="S3.SS3.p4.1.m1.1a"><mrow id="S3.SS3.p4.1.m1.1.1" xref="S3.SS3.p4.1.m1.1.1.cmml"><mi id="S3.SS3.p4.1.m1.1.1.2" xref="S3.SS3.p4.1.m1.1.1.2.cmml">Z</mi><mo id="S3.SS3.p4.1.m1.1.1.1" xref="S3.SS3.p4.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS3.p4.1.m1.1.1.3" xref="S3.SS3.p4.1.m1.1.1.3.cmml"><mi id="S3.SS3.p4.1.m1.1.1.3.2" xref="S3.SS3.p4.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p4.1.m1.1.1.3.3" xref="S3.SS3.p4.1.m1.1.1.3.3.cmml"><msup id="S3.SS3.p4.1.m1.1.1.3.3.2" xref="S3.SS3.p4.1.m1.1.1.3.3.2.cmml"><mi id="S3.SS3.p4.1.m1.1.1.3.3.2.2" xref="S3.SS3.p4.1.m1.1.1.3.3.2.2.cmml">P</mi><mn id="S3.SS3.p4.1.m1.1.1.3.3.2.3" xref="S3.SS3.p4.1.m1.1.1.3.3.2.3.cmml">2</mn></msup><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p4.1.m1.1.1.3.3.1" xref="S3.SS3.p4.1.m1.1.1.3.3.1.cmml">⋅</mo><mi id="S3.SS3.p4.1.m1.1.1.3.3.3" xref="S3.SS3.p4.1.m1.1.1.3.3.3.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.1b"><apply id="S3.SS3.p4.1.m1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1"><in id="S3.SS3.p4.1.m1.1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1.1"></in><ci id="S3.SS3.p4.1.m1.1.1.2.cmml" xref="S3.SS3.p4.1.m1.1.1.2">𝑍</ci><apply id="S3.SS3.p4.1.m1.1.1.3.cmml" xref="S3.SS3.p4.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.1.1.3.1.cmml" xref="S3.SS3.p4.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS3.p4.1.m1.1.1.3.2.cmml" xref="S3.SS3.p4.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS3.p4.1.m1.1.1.3.3.cmml" xref="S3.SS3.p4.1.m1.1.1.3.3"><ci id="S3.SS3.p4.1.m1.1.1.3.3.1.cmml" xref="S3.SS3.p4.1.m1.1.1.3.3.1">⋅</ci><apply id="S3.SS3.p4.1.m1.1.1.3.3.2.cmml" xref="S3.SS3.p4.1.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.1.1.3.3.2.1.cmml" xref="S3.SS3.p4.1.m1.1.1.3.3.2">superscript</csymbol><ci id="S3.SS3.p4.1.m1.1.1.3.3.2.2.cmml" xref="S3.SS3.p4.1.m1.1.1.3.3.2.2">𝑃</ci><cn type="integer" id="S3.SS3.p4.1.m1.1.1.3.3.2.3.cmml" xref="S3.SS3.p4.1.m1.1.1.3.3.2.3">2</cn></apply><ci id="S3.SS3.p4.1.m1.1.1.3.3.3.cmml" xref="S3.SS3.p4.1.m1.1.1.3.3.3">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.1c">Z\in\mathbb{R}^{P^{2}\cdot C}</annotation></semantics></math> and tokenized ResNet features <math id="S3.SS3.p4.2.m2.1" class="ltx_Math" alttext="Y\in\mathbb{R}^{P^{2}\cdot C}" display="inline"><semantics id="S3.SS3.p4.2.m2.1a"><mrow id="S3.SS3.p4.2.m2.1.1" xref="S3.SS3.p4.2.m2.1.1.cmml"><mi id="S3.SS3.p4.2.m2.1.1.2" xref="S3.SS3.p4.2.m2.1.1.2.cmml">Y</mi><mo id="S3.SS3.p4.2.m2.1.1.1" xref="S3.SS3.p4.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS3.p4.2.m2.1.1.3" xref="S3.SS3.p4.2.m2.1.1.3.cmml"><mi id="S3.SS3.p4.2.m2.1.1.3.2" xref="S3.SS3.p4.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p4.2.m2.1.1.3.3" xref="S3.SS3.p4.2.m2.1.1.3.3.cmml"><msup id="S3.SS3.p4.2.m2.1.1.3.3.2" xref="S3.SS3.p4.2.m2.1.1.3.3.2.cmml"><mi id="S3.SS3.p4.2.m2.1.1.3.3.2.2" xref="S3.SS3.p4.2.m2.1.1.3.3.2.2.cmml">P</mi><mn id="S3.SS3.p4.2.m2.1.1.3.3.2.3" xref="S3.SS3.p4.2.m2.1.1.3.3.2.3.cmml">2</mn></msup><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p4.2.m2.1.1.3.3.1" xref="S3.SS3.p4.2.m2.1.1.3.3.1.cmml">⋅</mo><mi id="S3.SS3.p4.2.m2.1.1.3.3.3" xref="S3.SS3.p4.2.m2.1.1.3.3.3.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.2.m2.1b"><apply id="S3.SS3.p4.2.m2.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1"><in id="S3.SS3.p4.2.m2.1.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1.1"></in><ci id="S3.SS3.p4.2.m2.1.1.2.cmml" xref="S3.SS3.p4.2.m2.1.1.2">𝑌</ci><apply id="S3.SS3.p4.2.m2.1.1.3.cmml" xref="S3.SS3.p4.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p4.2.m2.1.1.3.1.cmml" xref="S3.SS3.p4.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS3.p4.2.m2.1.1.3.2.cmml" xref="S3.SS3.p4.2.m2.1.1.3.2">ℝ</ci><apply id="S3.SS3.p4.2.m2.1.1.3.3.cmml" xref="S3.SS3.p4.2.m2.1.1.3.3"><ci id="S3.SS3.p4.2.m2.1.1.3.3.1.cmml" xref="S3.SS3.p4.2.m2.1.1.3.3.1">⋅</ci><apply id="S3.SS3.p4.2.m2.1.1.3.3.2.cmml" xref="S3.SS3.p4.2.m2.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS3.p4.2.m2.1.1.3.3.2.1.cmml" xref="S3.SS3.p4.2.m2.1.1.3.3.2">superscript</csymbol><ci id="S3.SS3.p4.2.m2.1.1.3.3.2.2.cmml" xref="S3.SS3.p4.2.m2.1.1.3.3.2.2">𝑃</ci><cn type="integer" id="S3.SS3.p4.2.m2.1.1.3.3.2.3.cmml" xref="S3.SS3.p4.2.m2.1.1.3.3.2.3">2</cn></apply><ci id="S3.SS3.p4.2.m2.1.1.3.3.3.cmml" xref="S3.SS3.p4.2.m2.1.1.3.3.3">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.2.m2.1c">Y\in\mathbb{R}^{P^{2}\cdot C}</annotation></semantics></math> as input, we employ window-based cross attention to reason the pixel-wise relations among spatial neighboring elements. Firstly, the features are partitioned into several non-overlapping windows, <em id="S3.SS3.p4.5.2" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S3.SS3.p4.5.3" class="ltx_text"></span>, <math id="S3.SS3.p4.3.m3.5" class="ltx_Math" alttext="\{Z_{w}^{i}\in\mathbb{R}^{w\times w\times C}|i\in[1,\dots,\frac{H\times W}{w^{2}}]\}" display="inline"><semantics id="S3.SS3.p4.3.m3.5a"><mrow id="S3.SS3.p4.3.m3.5.5.2" xref="S3.SS3.p4.3.m3.5.5.3.cmml"><mo stretchy="false" id="S3.SS3.p4.3.m3.5.5.2.3" xref="S3.SS3.p4.3.m3.5.5.3.1.cmml">{</mo><mrow id="S3.SS3.p4.3.m3.4.4.1.1" xref="S3.SS3.p4.3.m3.4.4.1.1.cmml"><msubsup id="S3.SS3.p4.3.m3.4.4.1.1.2" xref="S3.SS3.p4.3.m3.4.4.1.1.2.cmml"><mi id="S3.SS3.p4.3.m3.4.4.1.1.2.2.2" xref="S3.SS3.p4.3.m3.4.4.1.1.2.2.2.cmml">Z</mi><mi id="S3.SS3.p4.3.m3.4.4.1.1.2.2.3" xref="S3.SS3.p4.3.m3.4.4.1.1.2.2.3.cmml">w</mi><mi id="S3.SS3.p4.3.m3.4.4.1.1.2.3" xref="S3.SS3.p4.3.m3.4.4.1.1.2.3.cmml">i</mi></msubsup><mo id="S3.SS3.p4.3.m3.4.4.1.1.1" xref="S3.SS3.p4.3.m3.4.4.1.1.1.cmml">∈</mo><msup id="S3.SS3.p4.3.m3.4.4.1.1.3" xref="S3.SS3.p4.3.m3.4.4.1.1.3.cmml"><mi id="S3.SS3.p4.3.m3.4.4.1.1.3.2" xref="S3.SS3.p4.3.m3.4.4.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p4.3.m3.4.4.1.1.3.3" xref="S3.SS3.p4.3.m3.4.4.1.1.3.3.cmml"><mi id="S3.SS3.p4.3.m3.4.4.1.1.3.3.2" xref="S3.SS3.p4.3.m3.4.4.1.1.3.3.2.cmml">w</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p4.3.m3.4.4.1.1.3.3.1" xref="S3.SS3.p4.3.m3.4.4.1.1.3.3.1.cmml">×</mo><mi id="S3.SS3.p4.3.m3.4.4.1.1.3.3.3" xref="S3.SS3.p4.3.m3.4.4.1.1.3.3.3.cmml">w</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p4.3.m3.4.4.1.1.3.3.1a" xref="S3.SS3.p4.3.m3.4.4.1.1.3.3.1.cmml">×</mo><mi id="S3.SS3.p4.3.m3.4.4.1.1.3.3.4" xref="S3.SS3.p4.3.m3.4.4.1.1.3.3.4.cmml">C</mi></mrow></msup></mrow><mo lspace="0em" rspace="0em" id="S3.SS3.p4.3.m3.5.5.2.4" xref="S3.SS3.p4.3.m3.5.5.3.1.cmml">|</mo><mrow id="S3.SS3.p4.3.m3.5.5.2.2" xref="S3.SS3.p4.3.m3.5.5.2.2.cmml"><mi id="S3.SS3.p4.3.m3.5.5.2.2.2" xref="S3.SS3.p4.3.m3.5.5.2.2.2.cmml">i</mi><mo id="S3.SS3.p4.3.m3.5.5.2.2.1" xref="S3.SS3.p4.3.m3.5.5.2.2.1.cmml">∈</mo><mrow id="S3.SS3.p4.3.m3.5.5.2.2.3.2" xref="S3.SS3.p4.3.m3.5.5.2.2.3.1.cmml"><mo stretchy="false" id="S3.SS3.p4.3.m3.5.5.2.2.3.2.1" xref="S3.SS3.p4.3.m3.5.5.2.2.3.1.cmml">[</mo><mn id="S3.SS3.p4.3.m3.1.1" xref="S3.SS3.p4.3.m3.1.1.cmml">1</mn><mo id="S3.SS3.p4.3.m3.5.5.2.2.3.2.2" xref="S3.SS3.p4.3.m3.5.5.2.2.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS3.p4.3.m3.2.2" xref="S3.SS3.p4.3.m3.2.2.cmml">…</mi><mo id="S3.SS3.p4.3.m3.5.5.2.2.3.2.3" xref="S3.SS3.p4.3.m3.5.5.2.2.3.1.cmml">,</mo><mfrac id="S3.SS3.p4.3.m3.3.3" xref="S3.SS3.p4.3.m3.3.3.cmml"><mrow id="S3.SS3.p4.3.m3.3.3.2" xref="S3.SS3.p4.3.m3.3.3.2.cmml"><mi id="S3.SS3.p4.3.m3.3.3.2.2" xref="S3.SS3.p4.3.m3.3.3.2.2.cmml">H</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p4.3.m3.3.3.2.1" xref="S3.SS3.p4.3.m3.3.3.2.1.cmml">×</mo><mi id="S3.SS3.p4.3.m3.3.3.2.3" xref="S3.SS3.p4.3.m3.3.3.2.3.cmml">W</mi></mrow><msup id="S3.SS3.p4.3.m3.3.3.3" xref="S3.SS3.p4.3.m3.3.3.3.cmml"><mi id="S3.SS3.p4.3.m3.3.3.3.2" xref="S3.SS3.p4.3.m3.3.3.3.2.cmml">w</mi><mn id="S3.SS3.p4.3.m3.3.3.3.3" xref="S3.SS3.p4.3.m3.3.3.3.3.cmml">2</mn></msup></mfrac><mo stretchy="false" id="S3.SS3.p4.3.m3.5.5.2.2.3.2.4" xref="S3.SS3.p4.3.m3.5.5.2.2.3.1.cmml">]</mo></mrow></mrow><mo stretchy="false" id="S3.SS3.p4.3.m3.5.5.2.5" xref="S3.SS3.p4.3.m3.5.5.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.3.m3.5b"><apply id="S3.SS3.p4.3.m3.5.5.3.cmml" xref="S3.SS3.p4.3.m3.5.5.2"><csymbol cd="latexml" id="S3.SS3.p4.3.m3.5.5.3.1.cmml" xref="S3.SS3.p4.3.m3.5.5.2.3">conditional-set</csymbol><apply id="S3.SS3.p4.3.m3.4.4.1.1.cmml" xref="S3.SS3.p4.3.m3.4.4.1.1"><in id="S3.SS3.p4.3.m3.4.4.1.1.1.cmml" xref="S3.SS3.p4.3.m3.4.4.1.1.1"></in><apply id="S3.SS3.p4.3.m3.4.4.1.1.2.cmml" xref="S3.SS3.p4.3.m3.4.4.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p4.3.m3.4.4.1.1.2.1.cmml" xref="S3.SS3.p4.3.m3.4.4.1.1.2">superscript</csymbol><apply id="S3.SS3.p4.3.m3.4.4.1.1.2.2.cmml" xref="S3.SS3.p4.3.m3.4.4.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p4.3.m3.4.4.1.1.2.2.1.cmml" xref="S3.SS3.p4.3.m3.4.4.1.1.2">subscript</csymbol><ci id="S3.SS3.p4.3.m3.4.4.1.1.2.2.2.cmml" xref="S3.SS3.p4.3.m3.4.4.1.1.2.2.2">𝑍</ci><ci id="S3.SS3.p4.3.m3.4.4.1.1.2.2.3.cmml" xref="S3.SS3.p4.3.m3.4.4.1.1.2.2.3">𝑤</ci></apply><ci id="S3.SS3.p4.3.m3.4.4.1.1.2.3.cmml" xref="S3.SS3.p4.3.m3.4.4.1.1.2.3">𝑖</ci></apply><apply id="S3.SS3.p4.3.m3.4.4.1.1.3.cmml" xref="S3.SS3.p4.3.m3.4.4.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p4.3.m3.4.4.1.1.3.1.cmml" xref="S3.SS3.p4.3.m3.4.4.1.1.3">superscript</csymbol><ci id="S3.SS3.p4.3.m3.4.4.1.1.3.2.cmml" xref="S3.SS3.p4.3.m3.4.4.1.1.3.2">ℝ</ci><apply id="S3.SS3.p4.3.m3.4.4.1.1.3.3.cmml" xref="S3.SS3.p4.3.m3.4.4.1.1.3.3"><times id="S3.SS3.p4.3.m3.4.4.1.1.3.3.1.cmml" xref="S3.SS3.p4.3.m3.4.4.1.1.3.3.1"></times><ci id="S3.SS3.p4.3.m3.4.4.1.1.3.3.2.cmml" xref="S3.SS3.p4.3.m3.4.4.1.1.3.3.2">𝑤</ci><ci id="S3.SS3.p4.3.m3.4.4.1.1.3.3.3.cmml" xref="S3.SS3.p4.3.m3.4.4.1.1.3.3.3">𝑤</ci><ci id="S3.SS3.p4.3.m3.4.4.1.1.3.3.4.cmml" xref="S3.SS3.p4.3.m3.4.4.1.1.3.3.4">𝐶</ci></apply></apply></apply><apply id="S3.SS3.p4.3.m3.5.5.2.2.cmml" xref="S3.SS3.p4.3.m3.5.5.2.2"><in id="S3.SS3.p4.3.m3.5.5.2.2.1.cmml" xref="S3.SS3.p4.3.m3.5.5.2.2.1"></in><ci id="S3.SS3.p4.3.m3.5.5.2.2.2.cmml" xref="S3.SS3.p4.3.m3.5.5.2.2.2">𝑖</ci><list id="S3.SS3.p4.3.m3.5.5.2.2.3.1.cmml" xref="S3.SS3.p4.3.m3.5.5.2.2.3.2"><cn type="integer" id="S3.SS3.p4.3.m3.1.1.cmml" xref="S3.SS3.p4.3.m3.1.1">1</cn><ci id="S3.SS3.p4.3.m3.2.2.cmml" xref="S3.SS3.p4.3.m3.2.2">…</ci><apply id="S3.SS3.p4.3.m3.3.3.cmml" xref="S3.SS3.p4.3.m3.3.3"><divide id="S3.SS3.p4.3.m3.3.3.1.cmml" xref="S3.SS3.p4.3.m3.3.3"></divide><apply id="S3.SS3.p4.3.m3.3.3.2.cmml" xref="S3.SS3.p4.3.m3.3.3.2"><times id="S3.SS3.p4.3.m3.3.3.2.1.cmml" xref="S3.SS3.p4.3.m3.3.3.2.1"></times><ci id="S3.SS3.p4.3.m3.3.3.2.2.cmml" xref="S3.SS3.p4.3.m3.3.3.2.2">𝐻</ci><ci id="S3.SS3.p4.3.m3.3.3.2.3.cmml" xref="S3.SS3.p4.3.m3.3.3.2.3">𝑊</ci></apply><apply id="S3.SS3.p4.3.m3.3.3.3.cmml" xref="S3.SS3.p4.3.m3.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p4.3.m3.3.3.3.1.cmml" xref="S3.SS3.p4.3.m3.3.3.3">superscript</csymbol><ci id="S3.SS3.p4.3.m3.3.3.3.2.cmml" xref="S3.SS3.p4.3.m3.3.3.3.2">𝑤</ci><cn type="integer" id="S3.SS3.p4.3.m3.3.3.3.3.cmml" xref="S3.SS3.p4.3.m3.3.3.3.3">2</cn></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.3.m3.5c">\{Z_{w}^{i}\in\mathbb{R}^{w\times w\times C}|i\in[1,\dots,\frac{H\times W}{w^{2}}]\}</annotation></semantics></math> and <math id="S3.SS3.p4.4.m4.5" class="ltx_Math" alttext="\{Y_{w}^{i}\in\mathbb{R}^{w\times w\times C}|i\in[1,\dots,\frac{H\times W}{w^{2}}]\}" display="inline"><semantics id="S3.SS3.p4.4.m4.5a"><mrow id="S3.SS3.p4.4.m4.5.5.2" xref="S3.SS3.p4.4.m4.5.5.3.cmml"><mo stretchy="false" id="S3.SS3.p4.4.m4.5.5.2.3" xref="S3.SS3.p4.4.m4.5.5.3.1.cmml">{</mo><mrow id="S3.SS3.p4.4.m4.4.4.1.1" xref="S3.SS3.p4.4.m4.4.4.1.1.cmml"><msubsup id="S3.SS3.p4.4.m4.4.4.1.1.2" xref="S3.SS3.p4.4.m4.4.4.1.1.2.cmml"><mi id="S3.SS3.p4.4.m4.4.4.1.1.2.2.2" xref="S3.SS3.p4.4.m4.4.4.1.1.2.2.2.cmml">Y</mi><mi id="S3.SS3.p4.4.m4.4.4.1.1.2.2.3" xref="S3.SS3.p4.4.m4.4.4.1.1.2.2.3.cmml">w</mi><mi id="S3.SS3.p4.4.m4.4.4.1.1.2.3" xref="S3.SS3.p4.4.m4.4.4.1.1.2.3.cmml">i</mi></msubsup><mo id="S3.SS3.p4.4.m4.4.4.1.1.1" xref="S3.SS3.p4.4.m4.4.4.1.1.1.cmml">∈</mo><msup id="S3.SS3.p4.4.m4.4.4.1.1.3" xref="S3.SS3.p4.4.m4.4.4.1.1.3.cmml"><mi id="S3.SS3.p4.4.m4.4.4.1.1.3.2" xref="S3.SS3.p4.4.m4.4.4.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p4.4.m4.4.4.1.1.3.3" xref="S3.SS3.p4.4.m4.4.4.1.1.3.3.cmml"><mi id="S3.SS3.p4.4.m4.4.4.1.1.3.3.2" xref="S3.SS3.p4.4.m4.4.4.1.1.3.3.2.cmml">w</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p4.4.m4.4.4.1.1.3.3.1" xref="S3.SS3.p4.4.m4.4.4.1.1.3.3.1.cmml">×</mo><mi id="S3.SS3.p4.4.m4.4.4.1.1.3.3.3" xref="S3.SS3.p4.4.m4.4.4.1.1.3.3.3.cmml">w</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p4.4.m4.4.4.1.1.3.3.1a" xref="S3.SS3.p4.4.m4.4.4.1.1.3.3.1.cmml">×</mo><mi id="S3.SS3.p4.4.m4.4.4.1.1.3.3.4" xref="S3.SS3.p4.4.m4.4.4.1.1.3.3.4.cmml">C</mi></mrow></msup></mrow><mo lspace="0em" rspace="0em" id="S3.SS3.p4.4.m4.5.5.2.4" xref="S3.SS3.p4.4.m4.5.5.3.1.cmml">|</mo><mrow id="S3.SS3.p4.4.m4.5.5.2.2" xref="S3.SS3.p4.4.m4.5.5.2.2.cmml"><mi id="S3.SS3.p4.4.m4.5.5.2.2.2" xref="S3.SS3.p4.4.m4.5.5.2.2.2.cmml">i</mi><mo id="S3.SS3.p4.4.m4.5.5.2.2.1" xref="S3.SS3.p4.4.m4.5.5.2.2.1.cmml">∈</mo><mrow id="S3.SS3.p4.4.m4.5.5.2.2.3.2" xref="S3.SS3.p4.4.m4.5.5.2.2.3.1.cmml"><mo stretchy="false" id="S3.SS3.p4.4.m4.5.5.2.2.3.2.1" xref="S3.SS3.p4.4.m4.5.5.2.2.3.1.cmml">[</mo><mn id="S3.SS3.p4.4.m4.1.1" xref="S3.SS3.p4.4.m4.1.1.cmml">1</mn><mo id="S3.SS3.p4.4.m4.5.5.2.2.3.2.2" xref="S3.SS3.p4.4.m4.5.5.2.2.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS3.p4.4.m4.2.2" xref="S3.SS3.p4.4.m4.2.2.cmml">…</mi><mo id="S3.SS3.p4.4.m4.5.5.2.2.3.2.3" xref="S3.SS3.p4.4.m4.5.5.2.2.3.1.cmml">,</mo><mfrac id="S3.SS3.p4.4.m4.3.3" xref="S3.SS3.p4.4.m4.3.3.cmml"><mrow id="S3.SS3.p4.4.m4.3.3.2" xref="S3.SS3.p4.4.m4.3.3.2.cmml"><mi id="S3.SS3.p4.4.m4.3.3.2.2" xref="S3.SS3.p4.4.m4.3.3.2.2.cmml">H</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p4.4.m4.3.3.2.1" xref="S3.SS3.p4.4.m4.3.3.2.1.cmml">×</mo><mi id="S3.SS3.p4.4.m4.3.3.2.3" xref="S3.SS3.p4.4.m4.3.3.2.3.cmml">W</mi></mrow><msup id="S3.SS3.p4.4.m4.3.3.3" xref="S3.SS3.p4.4.m4.3.3.3.cmml"><mi id="S3.SS3.p4.4.m4.3.3.3.2" xref="S3.SS3.p4.4.m4.3.3.3.2.cmml">w</mi><mn id="S3.SS3.p4.4.m4.3.3.3.3" xref="S3.SS3.p4.4.m4.3.3.3.3.cmml">2</mn></msup></mfrac><mo stretchy="false" id="S3.SS3.p4.4.m4.5.5.2.2.3.2.4" xref="S3.SS3.p4.4.m4.5.5.2.2.3.1.cmml">]</mo></mrow></mrow><mo stretchy="false" id="S3.SS3.p4.4.m4.5.5.2.5" xref="S3.SS3.p4.4.m4.5.5.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.4.m4.5b"><apply id="S3.SS3.p4.4.m4.5.5.3.cmml" xref="S3.SS3.p4.4.m4.5.5.2"><csymbol cd="latexml" id="S3.SS3.p4.4.m4.5.5.3.1.cmml" xref="S3.SS3.p4.4.m4.5.5.2.3">conditional-set</csymbol><apply id="S3.SS3.p4.4.m4.4.4.1.1.cmml" xref="S3.SS3.p4.4.m4.4.4.1.1"><in id="S3.SS3.p4.4.m4.4.4.1.1.1.cmml" xref="S3.SS3.p4.4.m4.4.4.1.1.1"></in><apply id="S3.SS3.p4.4.m4.4.4.1.1.2.cmml" xref="S3.SS3.p4.4.m4.4.4.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p4.4.m4.4.4.1.1.2.1.cmml" xref="S3.SS3.p4.4.m4.4.4.1.1.2">superscript</csymbol><apply id="S3.SS3.p4.4.m4.4.4.1.1.2.2.cmml" xref="S3.SS3.p4.4.m4.4.4.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p4.4.m4.4.4.1.1.2.2.1.cmml" xref="S3.SS3.p4.4.m4.4.4.1.1.2">subscript</csymbol><ci id="S3.SS3.p4.4.m4.4.4.1.1.2.2.2.cmml" xref="S3.SS3.p4.4.m4.4.4.1.1.2.2.2">𝑌</ci><ci id="S3.SS3.p4.4.m4.4.4.1.1.2.2.3.cmml" xref="S3.SS3.p4.4.m4.4.4.1.1.2.2.3">𝑤</ci></apply><ci id="S3.SS3.p4.4.m4.4.4.1.1.2.3.cmml" xref="S3.SS3.p4.4.m4.4.4.1.1.2.3">𝑖</ci></apply><apply id="S3.SS3.p4.4.m4.4.4.1.1.3.cmml" xref="S3.SS3.p4.4.m4.4.4.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p4.4.m4.4.4.1.1.3.1.cmml" xref="S3.SS3.p4.4.m4.4.4.1.1.3">superscript</csymbol><ci id="S3.SS3.p4.4.m4.4.4.1.1.3.2.cmml" xref="S3.SS3.p4.4.m4.4.4.1.1.3.2">ℝ</ci><apply id="S3.SS3.p4.4.m4.4.4.1.1.3.3.cmml" xref="S3.SS3.p4.4.m4.4.4.1.1.3.3"><times id="S3.SS3.p4.4.m4.4.4.1.1.3.3.1.cmml" xref="S3.SS3.p4.4.m4.4.4.1.1.3.3.1"></times><ci id="S3.SS3.p4.4.m4.4.4.1.1.3.3.2.cmml" xref="S3.SS3.p4.4.m4.4.4.1.1.3.3.2">𝑤</ci><ci id="S3.SS3.p4.4.m4.4.4.1.1.3.3.3.cmml" xref="S3.SS3.p4.4.m4.4.4.1.1.3.3.3">𝑤</ci><ci id="S3.SS3.p4.4.m4.4.4.1.1.3.3.4.cmml" xref="S3.SS3.p4.4.m4.4.4.1.1.3.3.4">𝐶</ci></apply></apply></apply><apply id="S3.SS3.p4.4.m4.5.5.2.2.cmml" xref="S3.SS3.p4.4.m4.5.5.2.2"><in id="S3.SS3.p4.4.m4.5.5.2.2.1.cmml" xref="S3.SS3.p4.4.m4.5.5.2.2.1"></in><ci id="S3.SS3.p4.4.m4.5.5.2.2.2.cmml" xref="S3.SS3.p4.4.m4.5.5.2.2.2">𝑖</ci><list id="S3.SS3.p4.4.m4.5.5.2.2.3.1.cmml" xref="S3.SS3.p4.4.m4.5.5.2.2.3.2"><cn type="integer" id="S3.SS3.p4.4.m4.1.1.cmml" xref="S3.SS3.p4.4.m4.1.1">1</cn><ci id="S3.SS3.p4.4.m4.2.2.cmml" xref="S3.SS3.p4.4.m4.2.2">…</ci><apply id="S3.SS3.p4.4.m4.3.3.cmml" xref="S3.SS3.p4.4.m4.3.3"><divide id="S3.SS3.p4.4.m4.3.3.1.cmml" xref="S3.SS3.p4.4.m4.3.3"></divide><apply id="S3.SS3.p4.4.m4.3.3.2.cmml" xref="S3.SS3.p4.4.m4.3.3.2"><times id="S3.SS3.p4.4.m4.3.3.2.1.cmml" xref="S3.SS3.p4.4.m4.3.3.2.1"></times><ci id="S3.SS3.p4.4.m4.3.3.2.2.cmml" xref="S3.SS3.p4.4.m4.3.3.2.2">𝐻</ci><ci id="S3.SS3.p4.4.m4.3.3.2.3.cmml" xref="S3.SS3.p4.4.m4.3.3.2.3">𝑊</ci></apply><apply id="S3.SS3.p4.4.m4.3.3.3.cmml" xref="S3.SS3.p4.4.m4.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p4.4.m4.3.3.3.1.cmml" xref="S3.SS3.p4.4.m4.3.3.3">superscript</csymbol><ci id="S3.SS3.p4.4.m4.3.3.3.2.cmml" xref="S3.SS3.p4.4.m4.3.3.3.2">𝑤</ci><cn type="integer" id="S3.SS3.p4.4.m4.3.3.3.3.cmml" xref="S3.SS3.p4.4.m4.3.3.3.3">2</cn></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.4.m4.5c">\{Y_{w}^{i}\in\mathbb{R}^{w\times w\times C}|i\in[1,\dots,\frac{H\times W}{w^{2}}]\}</annotation></semantics></math>, where <math id="S3.SS3.p4.5.m5.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S3.SS3.p4.5.m5.1a"><mi id="S3.SS3.p4.5.m5.1.1" xref="S3.SS3.p4.5.m5.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.5.m5.1b"><ci id="S3.SS3.p4.5.m5.1.1.cmml" xref="S3.SS3.p4.5.m5.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.5.m5.1c">w</annotation></semantics></math> is the predefined window size. After that, the partitioned tokens are flattened along the spatial dimension and projected to query, key, and value tokens, <em id="S3.SS3.p4.5.4" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S3.SS3.p4.5.5" class="ltx_text"></span></p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.35" class="ltx_math_unparsed" alttext="\begin{split}Q_{w,f}^{i}&amp;=Z_{w}^{i}\mathbf{W}_{q}^{i},\\
K_{w,f}^{i}&amp;=Y_{w}^{i}\mathbf{W}_{k}^{i},\ \ \ V_{w,f}^{i}=Y_{w}^{i}\mathbf{W}_{v}^{i},\\
\end{split}" display="block"><semantics id="S3.E4.m1.35a"><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt" id="S3.E4.m1.35.35.2"><mtr id="S3.E4.m1.35.35.2a"><mtd class="ltx_align_right" columnalign="right" id="S3.E4.m1.35.35.2b"><msubsup id="S3.E4.m1.3.3.3.3.3"><mi id="S3.E4.m1.1.1.1.1.1.1">Q</mi><mrow id="S3.E4.m1.2.2.2.2.2.2.1.4"><mi id="S3.E4.m1.2.2.2.2.2.2.1.1">w</mi><mo id="S3.E4.m1.2.2.2.2.2.2.1.4.1">,</mo><mi id="S3.E4.m1.2.2.2.2.2.2.1.2">f</mi></mrow><mi id="S3.E4.m1.3.3.3.3.3.3.1">i</mi></msubsup></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E4.m1.35.35.2c"><mrow id="S3.E4.m1.34.34.1.34.12.9.9"><mrow id="S3.E4.m1.34.34.1.34.12.9.9.1"><mi id="S3.E4.m1.34.34.1.34.12.9.9.1.1"></mi><mo id="S3.E4.m1.4.4.4.4.1.1">=</mo><mrow id="S3.E4.m1.34.34.1.34.12.9.9.1.2"><msubsup id="S3.E4.m1.34.34.1.34.12.9.9.1.2.2"><mi id="S3.E4.m1.5.5.5.5.2.2">Z</mi><mi id="S3.E4.m1.6.6.6.6.3.3.1">w</mi><mi id="S3.E4.m1.7.7.7.7.4.4.1">i</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E4.m1.34.34.1.34.12.9.9.1.2.1">​</mo><msubsup id="S3.E4.m1.34.34.1.34.12.9.9.1.2.3"><mi id="S3.E4.m1.8.8.8.8.5.5">𝐖</mi><mi id="S3.E4.m1.9.9.9.9.6.6.1">q</mi><mi id="S3.E4.m1.10.10.10.10.7.7.1">i</mi></msubsup></mrow></mrow><mo id="S3.E4.m1.11.11.11.11.8.8">,</mo></mrow></mtd></mtr><mtr id="S3.E4.m1.35.35.2d"><mtd class="ltx_align_right" columnalign="right" id="S3.E4.m1.35.35.2e"><msubsup id="S3.E4.m1.14.14.14.3.3"><mi id="S3.E4.m1.12.12.12.1.1.1">K</mi><mrow id="S3.E4.m1.13.13.13.2.2.2.1.4"><mi id="S3.E4.m1.13.13.13.2.2.2.1.1">w</mi><mo id="S3.E4.m1.13.13.13.2.2.2.1.4.1">,</mo><mi id="S3.E4.m1.13.13.13.2.2.2.1.2">f</mi></mrow><mi id="S3.E4.m1.14.14.14.3.3.3.1">i</mi></msubsup></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E4.m1.35.35.2f"><mrow id="S3.E4.m1.35.35.2.35.23.20.20"><mrow id="S3.E4.m1.35.35.2.35.23.20.20.1"><mrow id="S3.E4.m1.35.35.2.35.23.20.20.1.1.1"><mi id="S3.E4.m1.35.35.2.35.23.20.20.1.1.1.1"></mi><mo id="S3.E4.m1.15.15.15.4.1.1">=</mo><mrow id="S3.E4.m1.35.35.2.35.23.20.20.1.1.1.2"><msubsup id="S3.E4.m1.35.35.2.35.23.20.20.1.1.1.2.2"><mi id="S3.E4.m1.16.16.16.5.2.2">Y</mi><mi id="S3.E4.m1.17.17.17.6.3.3.1">w</mi><mi id="S3.E4.m1.18.18.18.7.4.4.1">i</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E4.m1.35.35.2.35.23.20.20.1.1.1.2.1">​</mo><msubsup id="S3.E4.m1.35.35.2.35.23.20.20.1.1.1.2.3"><mi id="S3.E4.m1.19.19.19.8.5.5">𝐖</mi><mi id="S3.E4.m1.20.20.20.9.6.6.1">k</mi><mi id="S3.E4.m1.21.21.21.10.7.7.1">i</mi></msubsup></mrow></mrow><mo rspace="1.667em" id="S3.E4.m1.22.22.22.11.8.8">,</mo><mrow id="S3.E4.m1.35.35.2.35.23.20.20.1.2.2"><msubsup id="S3.E4.m1.35.35.2.35.23.20.20.1.2.2.1"><mi id="S3.E4.m1.23.23.23.12.9.9">V</mi><mrow id="S3.E4.m1.24.24.24.13.10.10.1.4"><mi id="S3.E4.m1.24.24.24.13.10.10.1.1">w</mi><mo id="S3.E4.m1.24.24.24.13.10.10.1.4.1">,</mo><mi id="S3.E4.m1.24.24.24.13.10.10.1.2">f</mi></mrow><mi id="S3.E4.m1.25.25.25.14.11.11.1">i</mi></msubsup><mo id="S3.E4.m1.26.26.26.15.12.12">=</mo><mrow id="S3.E4.m1.35.35.2.35.23.20.20.1.2.2.2"><msubsup id="S3.E4.m1.35.35.2.35.23.20.20.1.2.2.2.2"><mi id="S3.E4.m1.27.27.27.16.13.13">Y</mi><mi id="S3.E4.m1.28.28.28.17.14.14.1">w</mi><mi id="S3.E4.m1.29.29.29.18.15.15.1">i</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E4.m1.35.35.2.35.23.20.20.1.2.2.2.1">​</mo><msubsup id="S3.E4.m1.35.35.2.35.23.20.20.1.2.2.2.3"><mi id="S3.E4.m1.30.30.30.19.16.16">𝐖</mi><mi id="S3.E4.m1.31.31.31.20.17.17.1">v</mi><mi id="S3.E4.m1.32.32.32.21.18.18.1">i</mi></msubsup></mrow></mrow></mrow><mo id="S3.E4.m1.33.33.33.22.19.19">,</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex" id="S3.E4.m1.35b">\begin{split}Q_{w,f}^{i}&amp;=Z_{w}^{i}\mathbf{W}_{q}^{i},\\
K_{w,f}^{i}&amp;=Y_{w}^{i}\mathbf{W}_{k}^{i},\ \ \ V_{w,f}^{i}=Y_{w}^{i}\mathbf{W}_{v}^{i},\\
\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p4.16" class="ltx_p">where <math id="S3.SS3.p4.6.m1.1" class="ltx_Math" alttext="\mathbf{W}_{q}" display="inline"><semantics id="S3.SS3.p4.6.m1.1a"><msub id="S3.SS3.p4.6.m1.1.1" xref="S3.SS3.p4.6.m1.1.1.cmml"><mi id="S3.SS3.p4.6.m1.1.1.2" xref="S3.SS3.p4.6.m1.1.1.2.cmml">𝐖</mi><mi id="S3.SS3.p4.6.m1.1.1.3" xref="S3.SS3.p4.6.m1.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.6.m1.1b"><apply id="S3.SS3.p4.6.m1.1.1.cmml" xref="S3.SS3.p4.6.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.6.m1.1.1.1.cmml" xref="S3.SS3.p4.6.m1.1.1">subscript</csymbol><ci id="S3.SS3.p4.6.m1.1.1.2.cmml" xref="S3.SS3.p4.6.m1.1.1.2">𝐖</ci><ci id="S3.SS3.p4.6.m1.1.1.3.cmml" xref="S3.SS3.p4.6.m1.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.6.m1.1c">\mathbf{W}_{q}</annotation></semantics></math>, <math id="S3.SS3.p4.7.m2.1" class="ltx_Math" alttext="\mathbf{W}_{k}" display="inline"><semantics id="S3.SS3.p4.7.m2.1a"><msub id="S3.SS3.p4.7.m2.1.1" xref="S3.SS3.p4.7.m2.1.1.cmml"><mi id="S3.SS3.p4.7.m2.1.1.2" xref="S3.SS3.p4.7.m2.1.1.2.cmml">𝐖</mi><mi id="S3.SS3.p4.7.m2.1.1.3" xref="S3.SS3.p4.7.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.7.m2.1b"><apply id="S3.SS3.p4.7.m2.1.1.cmml" xref="S3.SS3.p4.7.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.7.m2.1.1.1.cmml" xref="S3.SS3.p4.7.m2.1.1">subscript</csymbol><ci id="S3.SS3.p4.7.m2.1.1.2.cmml" xref="S3.SS3.p4.7.m2.1.1.2">𝐖</ci><ci id="S3.SS3.p4.7.m2.1.1.3.cmml" xref="S3.SS3.p4.7.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.7.m2.1c">\mathbf{W}_{k}</annotation></semantics></math>, <math id="S3.SS3.p4.8.m3.1" class="ltx_Math" alttext="\mathbf{W}_{v}" display="inline"><semantics id="S3.SS3.p4.8.m3.1a"><msub id="S3.SS3.p4.8.m3.1.1" xref="S3.SS3.p4.8.m3.1.1.cmml"><mi id="S3.SS3.p4.8.m3.1.1.2" xref="S3.SS3.p4.8.m3.1.1.2.cmml">𝐖</mi><mi id="S3.SS3.p4.8.m3.1.1.3" xref="S3.SS3.p4.8.m3.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.8.m3.1b"><apply id="S3.SS3.p4.8.m3.1.1.cmml" xref="S3.SS3.p4.8.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.8.m3.1.1.1.cmml" xref="S3.SS3.p4.8.m3.1.1">subscript</csymbol><ci id="S3.SS3.p4.8.m3.1.1.2.cmml" xref="S3.SS3.p4.8.m3.1.1.2">𝐖</ci><ci id="S3.SS3.p4.8.m3.1.1.3.cmml" xref="S3.SS3.p4.8.m3.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.8.m3.1c">\mathbf{W}_{v}</annotation></semantics></math> <math id="S3.SS3.p4.9.m4.1" class="ltx_Math" alttext="\in\mathbb{R}^{C\times C}" display="inline"><semantics id="S3.SS3.p4.9.m4.1a"><mrow id="S3.SS3.p4.9.m4.1.1" xref="S3.SS3.p4.9.m4.1.1.cmml"><mi id="S3.SS3.p4.9.m4.1.1.2" xref="S3.SS3.p4.9.m4.1.1.2.cmml"></mi><mo id="S3.SS3.p4.9.m4.1.1.1" xref="S3.SS3.p4.9.m4.1.1.1.cmml">∈</mo><msup id="S3.SS3.p4.9.m4.1.1.3" xref="S3.SS3.p4.9.m4.1.1.3.cmml"><mi id="S3.SS3.p4.9.m4.1.1.3.2" xref="S3.SS3.p4.9.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p4.9.m4.1.1.3.3" xref="S3.SS3.p4.9.m4.1.1.3.3.cmml"><mi id="S3.SS3.p4.9.m4.1.1.3.3.2" xref="S3.SS3.p4.9.m4.1.1.3.3.2.cmml">C</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p4.9.m4.1.1.3.3.1" xref="S3.SS3.p4.9.m4.1.1.3.3.1.cmml">×</mo><mi id="S3.SS3.p4.9.m4.1.1.3.3.3" xref="S3.SS3.p4.9.m4.1.1.3.3.3.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.9.m4.1b"><apply id="S3.SS3.p4.9.m4.1.1.cmml" xref="S3.SS3.p4.9.m4.1.1"><in id="S3.SS3.p4.9.m4.1.1.1.cmml" xref="S3.SS3.p4.9.m4.1.1.1"></in><csymbol cd="latexml" id="S3.SS3.p4.9.m4.1.1.2.cmml" xref="S3.SS3.p4.9.m4.1.1.2">absent</csymbol><apply id="S3.SS3.p4.9.m4.1.1.3.cmml" xref="S3.SS3.p4.9.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p4.9.m4.1.1.3.1.cmml" xref="S3.SS3.p4.9.m4.1.1.3">superscript</csymbol><ci id="S3.SS3.p4.9.m4.1.1.3.2.cmml" xref="S3.SS3.p4.9.m4.1.1.3.2">ℝ</ci><apply id="S3.SS3.p4.9.m4.1.1.3.3.cmml" xref="S3.SS3.p4.9.m4.1.1.3.3"><times id="S3.SS3.p4.9.m4.1.1.3.3.1.cmml" xref="S3.SS3.p4.9.m4.1.1.3.3.1"></times><ci id="S3.SS3.p4.9.m4.1.1.3.3.2.cmml" xref="S3.SS3.p4.9.m4.1.1.3.3.2">𝐶</ci><ci id="S3.SS3.p4.9.m4.1.1.3.3.3.cmml" xref="S3.SS3.p4.9.m4.1.1.3.3.3">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.9.m4.1c">\in\mathbb{R}^{C\times C}</annotation></semantics></math> are learnable parameters, <math id="S3.SS3.p4.10.m5.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.SS3.p4.10.m5.1a"><mi id="S3.SS3.p4.10.m5.1.1" xref="S3.SS3.p4.10.m5.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.10.m5.1b"><ci id="S3.SS3.p4.10.m5.1.1.cmml" xref="S3.SS3.p4.10.m5.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.10.m5.1c">C</annotation></semantics></math> is the embedding dimension, <math id="S3.SS3.p4.11.m6.11" class="ltx_Math" alttext="\{Q_{w,f}^{i},K_{w,f}^{i},V_{w,f}^{i}\in\mathbb{R}^{w^{2}\times N\times C^{\prime}}|i\in[1,\dots,\frac{H\times W}{w^{2}}]\}" display="inline"><semantics id="S3.SS3.p4.11.m6.11a"><mrow id="S3.SS3.p4.11.m6.11.11.2" xref="S3.SS3.p4.11.m6.11.11.3.cmml"><mo stretchy="false" id="S3.SS3.p4.11.m6.11.11.2.3" xref="S3.SS3.p4.11.m6.11.11.3.1.cmml">{</mo><mrow id="S3.SS3.p4.11.m6.10.10.1.1" xref="S3.SS3.p4.11.m6.10.10.1.1.cmml"><mrow id="S3.SS3.p4.11.m6.10.10.1.1.3.3" xref="S3.SS3.p4.11.m6.10.10.1.1.3.4.cmml"><msubsup id="S3.SS3.p4.11.m6.10.10.1.1.1.1.1" xref="S3.SS3.p4.11.m6.10.10.1.1.1.1.1.cmml"><mi id="S3.SS3.p4.11.m6.10.10.1.1.1.1.1.2.2" xref="S3.SS3.p4.11.m6.10.10.1.1.1.1.1.2.2.cmml">Q</mi><mrow id="S3.SS3.p4.11.m6.2.2.2.4" xref="S3.SS3.p4.11.m6.2.2.2.3.cmml"><mi id="S3.SS3.p4.11.m6.1.1.1.1" xref="S3.SS3.p4.11.m6.1.1.1.1.cmml">w</mi><mo id="S3.SS3.p4.11.m6.2.2.2.4.1" xref="S3.SS3.p4.11.m6.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p4.11.m6.2.2.2.2" xref="S3.SS3.p4.11.m6.2.2.2.2.cmml">f</mi></mrow><mi id="S3.SS3.p4.11.m6.10.10.1.1.1.1.1.3" xref="S3.SS3.p4.11.m6.10.10.1.1.1.1.1.3.cmml">i</mi></msubsup><mo id="S3.SS3.p4.11.m6.10.10.1.1.3.3.4" xref="S3.SS3.p4.11.m6.10.10.1.1.3.4.cmml">,</mo><msubsup id="S3.SS3.p4.11.m6.10.10.1.1.2.2.2" xref="S3.SS3.p4.11.m6.10.10.1.1.2.2.2.cmml"><mi id="S3.SS3.p4.11.m6.10.10.1.1.2.2.2.2.2" xref="S3.SS3.p4.11.m6.10.10.1.1.2.2.2.2.2.cmml">K</mi><mrow id="S3.SS3.p4.11.m6.4.4.2.4" xref="S3.SS3.p4.11.m6.4.4.2.3.cmml"><mi id="S3.SS3.p4.11.m6.3.3.1.1" xref="S3.SS3.p4.11.m6.3.3.1.1.cmml">w</mi><mo id="S3.SS3.p4.11.m6.4.4.2.4.1" xref="S3.SS3.p4.11.m6.4.4.2.3.cmml">,</mo><mi id="S3.SS3.p4.11.m6.4.4.2.2" xref="S3.SS3.p4.11.m6.4.4.2.2.cmml">f</mi></mrow><mi id="S3.SS3.p4.11.m6.10.10.1.1.2.2.2.3" xref="S3.SS3.p4.11.m6.10.10.1.1.2.2.2.3.cmml">i</mi></msubsup><mo id="S3.SS3.p4.11.m6.10.10.1.1.3.3.5" xref="S3.SS3.p4.11.m6.10.10.1.1.3.4.cmml">,</mo><msubsup id="S3.SS3.p4.11.m6.10.10.1.1.3.3.3" xref="S3.SS3.p4.11.m6.10.10.1.1.3.3.3.cmml"><mi id="S3.SS3.p4.11.m6.10.10.1.1.3.3.3.2.2" xref="S3.SS3.p4.11.m6.10.10.1.1.3.3.3.2.2.cmml">V</mi><mrow id="S3.SS3.p4.11.m6.6.6.2.4" xref="S3.SS3.p4.11.m6.6.6.2.3.cmml"><mi id="S3.SS3.p4.11.m6.5.5.1.1" xref="S3.SS3.p4.11.m6.5.5.1.1.cmml">w</mi><mo id="S3.SS3.p4.11.m6.6.6.2.4.1" xref="S3.SS3.p4.11.m6.6.6.2.3.cmml">,</mo><mi id="S3.SS3.p4.11.m6.6.6.2.2" xref="S3.SS3.p4.11.m6.6.6.2.2.cmml">f</mi></mrow><mi id="S3.SS3.p4.11.m6.10.10.1.1.3.3.3.3" xref="S3.SS3.p4.11.m6.10.10.1.1.3.3.3.3.cmml">i</mi></msubsup></mrow><mo id="S3.SS3.p4.11.m6.10.10.1.1.4" xref="S3.SS3.p4.11.m6.10.10.1.1.4.cmml">∈</mo><msup id="S3.SS3.p4.11.m6.10.10.1.1.5" xref="S3.SS3.p4.11.m6.10.10.1.1.5.cmml"><mi id="S3.SS3.p4.11.m6.10.10.1.1.5.2" xref="S3.SS3.p4.11.m6.10.10.1.1.5.2.cmml">ℝ</mi><mrow id="S3.SS3.p4.11.m6.10.10.1.1.5.3" xref="S3.SS3.p4.11.m6.10.10.1.1.5.3.cmml"><msup id="S3.SS3.p4.11.m6.10.10.1.1.5.3.2" xref="S3.SS3.p4.11.m6.10.10.1.1.5.3.2.cmml"><mi id="S3.SS3.p4.11.m6.10.10.1.1.5.3.2.2" xref="S3.SS3.p4.11.m6.10.10.1.1.5.3.2.2.cmml">w</mi><mn id="S3.SS3.p4.11.m6.10.10.1.1.5.3.2.3" xref="S3.SS3.p4.11.m6.10.10.1.1.5.3.2.3.cmml">2</mn></msup><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p4.11.m6.10.10.1.1.5.3.1" xref="S3.SS3.p4.11.m6.10.10.1.1.5.3.1.cmml">×</mo><mi id="S3.SS3.p4.11.m6.10.10.1.1.5.3.3" xref="S3.SS3.p4.11.m6.10.10.1.1.5.3.3.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p4.11.m6.10.10.1.1.5.3.1a" xref="S3.SS3.p4.11.m6.10.10.1.1.5.3.1.cmml">×</mo><msup id="S3.SS3.p4.11.m6.10.10.1.1.5.3.4" xref="S3.SS3.p4.11.m6.10.10.1.1.5.3.4.cmml"><mi id="S3.SS3.p4.11.m6.10.10.1.1.5.3.4.2" xref="S3.SS3.p4.11.m6.10.10.1.1.5.3.4.2.cmml">C</mi><mo id="S3.SS3.p4.11.m6.10.10.1.1.5.3.4.3" xref="S3.SS3.p4.11.m6.10.10.1.1.5.3.4.3.cmml">′</mo></msup></mrow></msup></mrow><mo lspace="0em" rspace="0em" id="S3.SS3.p4.11.m6.11.11.2.4" xref="S3.SS3.p4.11.m6.11.11.3.1.cmml">|</mo><mrow id="S3.SS3.p4.11.m6.11.11.2.2" xref="S3.SS3.p4.11.m6.11.11.2.2.cmml"><mi id="S3.SS3.p4.11.m6.11.11.2.2.2" xref="S3.SS3.p4.11.m6.11.11.2.2.2.cmml">i</mi><mo id="S3.SS3.p4.11.m6.11.11.2.2.1" xref="S3.SS3.p4.11.m6.11.11.2.2.1.cmml">∈</mo><mrow id="S3.SS3.p4.11.m6.11.11.2.2.3.2" xref="S3.SS3.p4.11.m6.11.11.2.2.3.1.cmml"><mo stretchy="false" id="S3.SS3.p4.11.m6.11.11.2.2.3.2.1" xref="S3.SS3.p4.11.m6.11.11.2.2.3.1.cmml">[</mo><mn id="S3.SS3.p4.11.m6.7.7" xref="S3.SS3.p4.11.m6.7.7.cmml">1</mn><mo id="S3.SS3.p4.11.m6.11.11.2.2.3.2.2" xref="S3.SS3.p4.11.m6.11.11.2.2.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS3.p4.11.m6.8.8" xref="S3.SS3.p4.11.m6.8.8.cmml">…</mi><mo id="S3.SS3.p4.11.m6.11.11.2.2.3.2.3" xref="S3.SS3.p4.11.m6.11.11.2.2.3.1.cmml">,</mo><mfrac id="S3.SS3.p4.11.m6.9.9" xref="S3.SS3.p4.11.m6.9.9.cmml"><mrow id="S3.SS3.p4.11.m6.9.9.2" xref="S3.SS3.p4.11.m6.9.9.2.cmml"><mi id="S3.SS3.p4.11.m6.9.9.2.2" xref="S3.SS3.p4.11.m6.9.9.2.2.cmml">H</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p4.11.m6.9.9.2.1" xref="S3.SS3.p4.11.m6.9.9.2.1.cmml">×</mo><mi id="S3.SS3.p4.11.m6.9.9.2.3" xref="S3.SS3.p4.11.m6.9.9.2.3.cmml">W</mi></mrow><msup id="S3.SS3.p4.11.m6.9.9.3" xref="S3.SS3.p4.11.m6.9.9.3.cmml"><mi id="S3.SS3.p4.11.m6.9.9.3.2" xref="S3.SS3.p4.11.m6.9.9.3.2.cmml">w</mi><mn id="S3.SS3.p4.11.m6.9.9.3.3" xref="S3.SS3.p4.11.m6.9.9.3.3.cmml">2</mn></msup></mfrac><mo stretchy="false" id="S3.SS3.p4.11.m6.11.11.2.2.3.2.4" xref="S3.SS3.p4.11.m6.11.11.2.2.3.1.cmml">]</mo></mrow></mrow><mo stretchy="false" id="S3.SS3.p4.11.m6.11.11.2.5" xref="S3.SS3.p4.11.m6.11.11.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.11.m6.11b"><apply id="S3.SS3.p4.11.m6.11.11.3.cmml" xref="S3.SS3.p4.11.m6.11.11.2"><csymbol cd="latexml" id="S3.SS3.p4.11.m6.11.11.3.1.cmml" xref="S3.SS3.p4.11.m6.11.11.2.3">conditional-set</csymbol><apply id="S3.SS3.p4.11.m6.10.10.1.1.cmml" xref="S3.SS3.p4.11.m6.10.10.1.1"><in id="S3.SS3.p4.11.m6.10.10.1.1.4.cmml" xref="S3.SS3.p4.11.m6.10.10.1.1.4"></in><list id="S3.SS3.p4.11.m6.10.10.1.1.3.4.cmml" xref="S3.SS3.p4.11.m6.10.10.1.1.3.3"><apply id="S3.SS3.p4.11.m6.10.10.1.1.1.1.1.cmml" xref="S3.SS3.p4.11.m6.10.10.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.11.m6.10.10.1.1.1.1.1.1.cmml" xref="S3.SS3.p4.11.m6.10.10.1.1.1.1.1">superscript</csymbol><apply id="S3.SS3.p4.11.m6.10.10.1.1.1.1.1.2.cmml" xref="S3.SS3.p4.11.m6.10.10.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.11.m6.10.10.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p4.11.m6.10.10.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p4.11.m6.10.10.1.1.1.1.1.2.2.cmml" xref="S3.SS3.p4.11.m6.10.10.1.1.1.1.1.2.2">𝑄</ci><list id="S3.SS3.p4.11.m6.2.2.2.3.cmml" xref="S3.SS3.p4.11.m6.2.2.2.4"><ci id="S3.SS3.p4.11.m6.1.1.1.1.cmml" xref="S3.SS3.p4.11.m6.1.1.1.1">𝑤</ci><ci id="S3.SS3.p4.11.m6.2.2.2.2.cmml" xref="S3.SS3.p4.11.m6.2.2.2.2">𝑓</ci></list></apply><ci id="S3.SS3.p4.11.m6.10.10.1.1.1.1.1.3.cmml" xref="S3.SS3.p4.11.m6.10.10.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS3.p4.11.m6.10.10.1.1.2.2.2.cmml" xref="S3.SS3.p4.11.m6.10.10.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p4.11.m6.10.10.1.1.2.2.2.1.cmml" xref="S3.SS3.p4.11.m6.10.10.1.1.2.2.2">superscript</csymbol><apply id="S3.SS3.p4.11.m6.10.10.1.1.2.2.2.2.cmml" xref="S3.SS3.p4.11.m6.10.10.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p4.11.m6.10.10.1.1.2.2.2.2.1.cmml" xref="S3.SS3.p4.11.m6.10.10.1.1.2.2.2">subscript</csymbol><ci id="S3.SS3.p4.11.m6.10.10.1.1.2.2.2.2.2.cmml" xref="S3.SS3.p4.11.m6.10.10.1.1.2.2.2.2.2">𝐾</ci><list id="S3.SS3.p4.11.m6.4.4.2.3.cmml" xref="S3.SS3.p4.11.m6.4.4.2.4"><ci id="S3.SS3.p4.11.m6.3.3.1.1.cmml" xref="S3.SS3.p4.11.m6.3.3.1.1">𝑤</ci><ci id="S3.SS3.p4.11.m6.4.4.2.2.cmml" xref="S3.SS3.p4.11.m6.4.4.2.2">𝑓</ci></list></apply><ci id="S3.SS3.p4.11.m6.10.10.1.1.2.2.2.3.cmml" xref="S3.SS3.p4.11.m6.10.10.1.1.2.2.2.3">𝑖</ci></apply><apply id="S3.SS3.p4.11.m6.10.10.1.1.3.3.3.cmml" xref="S3.SS3.p4.11.m6.10.10.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p4.11.m6.10.10.1.1.3.3.3.1.cmml" xref="S3.SS3.p4.11.m6.10.10.1.1.3.3.3">superscript</csymbol><apply id="S3.SS3.p4.11.m6.10.10.1.1.3.3.3.2.cmml" xref="S3.SS3.p4.11.m6.10.10.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p4.11.m6.10.10.1.1.3.3.3.2.1.cmml" xref="S3.SS3.p4.11.m6.10.10.1.1.3.3.3">subscript</csymbol><ci id="S3.SS3.p4.11.m6.10.10.1.1.3.3.3.2.2.cmml" xref="S3.SS3.p4.11.m6.10.10.1.1.3.3.3.2.2">𝑉</ci><list id="S3.SS3.p4.11.m6.6.6.2.3.cmml" xref="S3.SS3.p4.11.m6.6.6.2.4"><ci id="S3.SS3.p4.11.m6.5.5.1.1.cmml" xref="S3.SS3.p4.11.m6.5.5.1.1">𝑤</ci><ci id="S3.SS3.p4.11.m6.6.6.2.2.cmml" xref="S3.SS3.p4.11.m6.6.6.2.2">𝑓</ci></list></apply><ci id="S3.SS3.p4.11.m6.10.10.1.1.3.3.3.3.cmml" xref="S3.SS3.p4.11.m6.10.10.1.1.3.3.3.3">𝑖</ci></apply></list><apply id="S3.SS3.p4.11.m6.10.10.1.1.5.cmml" xref="S3.SS3.p4.11.m6.10.10.1.1.5"><csymbol cd="ambiguous" id="S3.SS3.p4.11.m6.10.10.1.1.5.1.cmml" xref="S3.SS3.p4.11.m6.10.10.1.1.5">superscript</csymbol><ci id="S3.SS3.p4.11.m6.10.10.1.1.5.2.cmml" xref="S3.SS3.p4.11.m6.10.10.1.1.5.2">ℝ</ci><apply id="S3.SS3.p4.11.m6.10.10.1.1.5.3.cmml" xref="S3.SS3.p4.11.m6.10.10.1.1.5.3"><times id="S3.SS3.p4.11.m6.10.10.1.1.5.3.1.cmml" xref="S3.SS3.p4.11.m6.10.10.1.1.5.3.1"></times><apply id="S3.SS3.p4.11.m6.10.10.1.1.5.3.2.cmml" xref="S3.SS3.p4.11.m6.10.10.1.1.5.3.2"><csymbol cd="ambiguous" id="S3.SS3.p4.11.m6.10.10.1.1.5.3.2.1.cmml" xref="S3.SS3.p4.11.m6.10.10.1.1.5.3.2">superscript</csymbol><ci id="S3.SS3.p4.11.m6.10.10.1.1.5.3.2.2.cmml" xref="S3.SS3.p4.11.m6.10.10.1.1.5.3.2.2">𝑤</ci><cn type="integer" id="S3.SS3.p4.11.m6.10.10.1.1.5.3.2.3.cmml" xref="S3.SS3.p4.11.m6.10.10.1.1.5.3.2.3">2</cn></apply><ci id="S3.SS3.p4.11.m6.10.10.1.1.5.3.3.cmml" xref="S3.SS3.p4.11.m6.10.10.1.1.5.3.3">𝑁</ci><apply id="S3.SS3.p4.11.m6.10.10.1.1.5.3.4.cmml" xref="S3.SS3.p4.11.m6.10.10.1.1.5.3.4"><csymbol cd="ambiguous" id="S3.SS3.p4.11.m6.10.10.1.1.5.3.4.1.cmml" xref="S3.SS3.p4.11.m6.10.10.1.1.5.3.4">superscript</csymbol><ci id="S3.SS3.p4.11.m6.10.10.1.1.5.3.4.2.cmml" xref="S3.SS3.p4.11.m6.10.10.1.1.5.3.4.2">𝐶</ci><ci id="S3.SS3.p4.11.m6.10.10.1.1.5.3.4.3.cmml" xref="S3.SS3.p4.11.m6.10.10.1.1.5.3.4.3">′</ci></apply></apply></apply></apply><apply id="S3.SS3.p4.11.m6.11.11.2.2.cmml" xref="S3.SS3.p4.11.m6.11.11.2.2"><in id="S3.SS3.p4.11.m6.11.11.2.2.1.cmml" xref="S3.SS3.p4.11.m6.11.11.2.2.1"></in><ci id="S3.SS3.p4.11.m6.11.11.2.2.2.cmml" xref="S3.SS3.p4.11.m6.11.11.2.2.2">𝑖</ci><list id="S3.SS3.p4.11.m6.11.11.2.2.3.1.cmml" xref="S3.SS3.p4.11.m6.11.11.2.2.3.2"><cn type="integer" id="S3.SS3.p4.11.m6.7.7.cmml" xref="S3.SS3.p4.11.m6.7.7">1</cn><ci id="S3.SS3.p4.11.m6.8.8.cmml" xref="S3.SS3.p4.11.m6.8.8">…</ci><apply id="S3.SS3.p4.11.m6.9.9.cmml" xref="S3.SS3.p4.11.m6.9.9"><divide id="S3.SS3.p4.11.m6.9.9.1.cmml" xref="S3.SS3.p4.11.m6.9.9"></divide><apply id="S3.SS3.p4.11.m6.9.9.2.cmml" xref="S3.SS3.p4.11.m6.9.9.2"><times id="S3.SS3.p4.11.m6.9.9.2.1.cmml" xref="S3.SS3.p4.11.m6.9.9.2.1"></times><ci id="S3.SS3.p4.11.m6.9.9.2.2.cmml" xref="S3.SS3.p4.11.m6.9.9.2.2">𝐻</ci><ci id="S3.SS3.p4.11.m6.9.9.2.3.cmml" xref="S3.SS3.p4.11.m6.9.9.2.3">𝑊</ci></apply><apply id="S3.SS3.p4.11.m6.9.9.3.cmml" xref="S3.SS3.p4.11.m6.9.9.3"><csymbol cd="ambiguous" id="S3.SS3.p4.11.m6.9.9.3.1.cmml" xref="S3.SS3.p4.11.m6.9.9.3">superscript</csymbol><ci id="S3.SS3.p4.11.m6.9.9.3.2.cmml" xref="S3.SS3.p4.11.m6.9.9.3.2">𝑤</ci><cn type="integer" id="S3.SS3.p4.11.m6.9.9.3.3.cmml" xref="S3.SS3.p4.11.m6.9.9.3.3">2</cn></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.11.m6.11c">\{Q_{w,f}^{i},K_{w,f}^{i},V_{w,f}^{i}\in\mathbb{R}^{w^{2}\times N\times C^{\prime}}|i\in[1,\dots,\frac{H\times W}{w^{2}}]\}</annotation></semantics></math>, where <math id="S3.SS3.p4.12.m7.3" class="ltx_Math" alttext="Q,K,V" display="inline"><semantics id="S3.SS3.p4.12.m7.3a"><mrow id="S3.SS3.p4.12.m7.3.4.2" xref="S3.SS3.p4.12.m7.3.4.1.cmml"><mi id="S3.SS3.p4.12.m7.1.1" xref="S3.SS3.p4.12.m7.1.1.cmml">Q</mi><mo id="S3.SS3.p4.12.m7.3.4.2.1" xref="S3.SS3.p4.12.m7.3.4.1.cmml">,</mo><mi id="S3.SS3.p4.12.m7.2.2" xref="S3.SS3.p4.12.m7.2.2.cmml">K</mi><mo id="S3.SS3.p4.12.m7.3.4.2.2" xref="S3.SS3.p4.12.m7.3.4.1.cmml">,</mo><mi id="S3.SS3.p4.12.m7.3.3" xref="S3.SS3.p4.12.m7.3.3.cmml">V</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.12.m7.3b"><list id="S3.SS3.p4.12.m7.3.4.1.cmml" xref="S3.SS3.p4.12.m7.3.4.2"><ci id="S3.SS3.p4.12.m7.1.1.cmml" xref="S3.SS3.p4.12.m7.1.1">𝑄</ci><ci id="S3.SS3.p4.12.m7.2.2.cmml" xref="S3.SS3.p4.12.m7.2.2">𝐾</ci><ci id="S3.SS3.p4.12.m7.3.3.cmml" xref="S3.SS3.p4.12.m7.3.3">𝑉</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.12.m7.3c">Q,K,V</annotation></semantics></math> represent the query, key, and value tokens, respectively, <math id="S3.SS3.p4.13.m8.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS3.p4.13.m8.1a"><mi id="S3.SS3.p4.13.m8.1.1" xref="S3.SS3.p4.13.m8.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.13.m8.1b"><ci id="S3.SS3.p4.13.m8.1.1.cmml" xref="S3.SS3.p4.13.m8.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.13.m8.1c">N</annotation></semantics></math> denotes the head number and <math id="S3.SS3.p4.14.m9.1" class="ltx_Math" alttext="C^{\prime}" display="inline"><semantics id="S3.SS3.p4.14.m9.1a"><msup id="S3.SS3.p4.14.m9.1.1" xref="S3.SS3.p4.14.m9.1.1.cmml"><mi id="S3.SS3.p4.14.m9.1.1.2" xref="S3.SS3.p4.14.m9.1.1.2.cmml">C</mi><mo id="S3.SS3.p4.14.m9.1.1.3" xref="S3.SS3.p4.14.m9.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.14.m9.1b"><apply id="S3.SS3.p4.14.m9.1.1.cmml" xref="S3.SS3.p4.14.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.14.m9.1.1.1.cmml" xref="S3.SS3.p4.14.m9.1.1">superscript</csymbol><ci id="S3.SS3.p4.14.m9.1.1.2.cmml" xref="S3.SS3.p4.14.m9.1.1.2">𝐶</ci><ci id="S3.SS3.p4.14.m9.1.1.3.cmml" xref="S3.SS3.p4.14.m9.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.14.m9.1c">C^{\prime}</annotation></semantics></math> is the channel dimension along each head. Here the ViT feature is the only query as it provides powerful semantic guide for pixel-wise relation calculation. It is noted that <math id="S3.SS3.p4.15.m10.1" class="ltx_Math" alttext="N\times C^{\prime}" display="inline"><semantics id="S3.SS3.p4.15.m10.1a"><mrow id="S3.SS3.p4.15.m10.1.1" xref="S3.SS3.p4.15.m10.1.1.cmml"><mi id="S3.SS3.p4.15.m10.1.1.2" xref="S3.SS3.p4.15.m10.1.1.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p4.15.m10.1.1.1" xref="S3.SS3.p4.15.m10.1.1.1.cmml">×</mo><msup id="S3.SS3.p4.15.m10.1.1.3" xref="S3.SS3.p4.15.m10.1.1.3.cmml"><mi id="S3.SS3.p4.15.m10.1.1.3.2" xref="S3.SS3.p4.15.m10.1.1.3.2.cmml">C</mi><mo id="S3.SS3.p4.15.m10.1.1.3.3" xref="S3.SS3.p4.15.m10.1.1.3.3.cmml">′</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.15.m10.1b"><apply id="S3.SS3.p4.15.m10.1.1.cmml" xref="S3.SS3.p4.15.m10.1.1"><times id="S3.SS3.p4.15.m10.1.1.1.cmml" xref="S3.SS3.p4.15.m10.1.1.1"></times><ci id="S3.SS3.p4.15.m10.1.1.2.cmml" xref="S3.SS3.p4.15.m10.1.1.2">𝑁</ci><apply id="S3.SS3.p4.15.m10.1.1.3.cmml" xref="S3.SS3.p4.15.m10.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p4.15.m10.1.1.3.1.cmml" xref="S3.SS3.p4.15.m10.1.1.3">superscript</csymbol><ci id="S3.SS3.p4.15.m10.1.1.3.2.cmml" xref="S3.SS3.p4.15.m10.1.1.3.2">𝐶</ci><ci id="S3.SS3.p4.15.m10.1.1.3.3.cmml" xref="S3.SS3.p4.15.m10.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.15.m10.1c">N\times C^{\prime}</annotation></semantics></math> equals the channel dimension <math id="S3.SS3.p4.16.m11.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.SS3.p4.16.m11.1a"><mi id="S3.SS3.p4.16.m11.1.1" xref="S3.SS3.p4.16.m11.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.16.m11.1b"><ci id="S3.SS3.p4.16.m11.1.1.cmml" xref="S3.SS3.p4.16.m11.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.16.m11.1c">C</annotation></semantics></math> of the given feature. Given the flattened query, key, and value tokens from the same default window, the window-based attention layers conduct full attention within the window, <em id="S3.SS3.p4.16.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S3.SS3.p4.16.2" class="ltx_text"></span>,</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.9" class="ltx_Math" alttext="B_{w,f}^{i}=MHCA(Q_{w,f}^{i},K_{w,f}^{i},V_{w,f}^{i})." display="block"><semantics id="S3.E5.m1.9a"><mrow id="S3.E5.m1.9.9.1" xref="S3.E5.m1.9.9.1.1.cmml"><mrow id="S3.E5.m1.9.9.1.1" xref="S3.E5.m1.9.9.1.1.cmml"><msubsup id="S3.E5.m1.9.9.1.1.5" xref="S3.E5.m1.9.9.1.1.5.cmml"><mi id="S3.E5.m1.9.9.1.1.5.2.2" xref="S3.E5.m1.9.9.1.1.5.2.2.cmml">B</mi><mrow id="S3.E5.m1.2.2.2.4" xref="S3.E5.m1.2.2.2.3.cmml"><mi id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml">w</mi><mo id="S3.E5.m1.2.2.2.4.1" xref="S3.E5.m1.2.2.2.3.cmml">,</mo><mi id="S3.E5.m1.2.2.2.2" xref="S3.E5.m1.2.2.2.2.cmml">f</mi></mrow><mi id="S3.E5.m1.9.9.1.1.5.3" xref="S3.E5.m1.9.9.1.1.5.3.cmml">i</mi></msubsup><mo id="S3.E5.m1.9.9.1.1.4" xref="S3.E5.m1.9.9.1.1.4.cmml">=</mo><mrow id="S3.E5.m1.9.9.1.1.3" xref="S3.E5.m1.9.9.1.1.3.cmml"><mi id="S3.E5.m1.9.9.1.1.3.5" xref="S3.E5.m1.9.9.1.1.3.5.cmml">M</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.9.9.1.1.3.4" xref="S3.E5.m1.9.9.1.1.3.4.cmml">​</mo><mi id="S3.E5.m1.9.9.1.1.3.6" xref="S3.E5.m1.9.9.1.1.3.6.cmml">H</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.9.9.1.1.3.4a" xref="S3.E5.m1.9.9.1.1.3.4.cmml">​</mo><mi id="S3.E5.m1.9.9.1.1.3.7" xref="S3.E5.m1.9.9.1.1.3.7.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.9.9.1.1.3.4b" xref="S3.E5.m1.9.9.1.1.3.4.cmml">​</mo><mi id="S3.E5.m1.9.9.1.1.3.8" xref="S3.E5.m1.9.9.1.1.3.8.cmml">A</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.9.9.1.1.3.4c" xref="S3.E5.m1.9.9.1.1.3.4.cmml">​</mo><mrow id="S3.E5.m1.9.9.1.1.3.3.3" xref="S3.E5.m1.9.9.1.1.3.3.4.cmml"><mo stretchy="false" id="S3.E5.m1.9.9.1.1.3.3.3.4" xref="S3.E5.m1.9.9.1.1.3.3.4.cmml">(</mo><msubsup id="S3.E5.m1.9.9.1.1.1.1.1.1" xref="S3.E5.m1.9.9.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.9.9.1.1.1.1.1.1.2.2" xref="S3.E5.m1.9.9.1.1.1.1.1.1.2.2.cmml">Q</mi><mrow id="S3.E5.m1.4.4.2.4" xref="S3.E5.m1.4.4.2.3.cmml"><mi id="S3.E5.m1.3.3.1.1" xref="S3.E5.m1.3.3.1.1.cmml">w</mi><mo id="S3.E5.m1.4.4.2.4.1" xref="S3.E5.m1.4.4.2.3.cmml">,</mo><mi id="S3.E5.m1.4.4.2.2" xref="S3.E5.m1.4.4.2.2.cmml">f</mi></mrow><mi id="S3.E5.m1.9.9.1.1.1.1.1.1.3" xref="S3.E5.m1.9.9.1.1.1.1.1.1.3.cmml">i</mi></msubsup><mo id="S3.E5.m1.9.9.1.1.3.3.3.5" xref="S3.E5.m1.9.9.1.1.3.3.4.cmml">,</mo><msubsup id="S3.E5.m1.9.9.1.1.2.2.2.2" xref="S3.E5.m1.9.9.1.1.2.2.2.2.cmml"><mi id="S3.E5.m1.9.9.1.1.2.2.2.2.2.2" xref="S3.E5.m1.9.9.1.1.2.2.2.2.2.2.cmml">K</mi><mrow id="S3.E5.m1.6.6.2.4" xref="S3.E5.m1.6.6.2.3.cmml"><mi id="S3.E5.m1.5.5.1.1" xref="S3.E5.m1.5.5.1.1.cmml">w</mi><mo id="S3.E5.m1.6.6.2.4.1" xref="S3.E5.m1.6.6.2.3.cmml">,</mo><mi id="S3.E5.m1.6.6.2.2" xref="S3.E5.m1.6.6.2.2.cmml">f</mi></mrow><mi id="S3.E5.m1.9.9.1.1.2.2.2.2.3" xref="S3.E5.m1.9.9.1.1.2.2.2.2.3.cmml">i</mi></msubsup><mo id="S3.E5.m1.9.9.1.1.3.3.3.6" xref="S3.E5.m1.9.9.1.1.3.3.4.cmml">,</mo><msubsup id="S3.E5.m1.9.9.1.1.3.3.3.3" xref="S3.E5.m1.9.9.1.1.3.3.3.3.cmml"><mi id="S3.E5.m1.9.9.1.1.3.3.3.3.2.2" xref="S3.E5.m1.9.9.1.1.3.3.3.3.2.2.cmml">V</mi><mrow id="S3.E5.m1.8.8.2.4" xref="S3.E5.m1.8.8.2.3.cmml"><mi id="S3.E5.m1.7.7.1.1" xref="S3.E5.m1.7.7.1.1.cmml">w</mi><mo id="S3.E5.m1.8.8.2.4.1" xref="S3.E5.m1.8.8.2.3.cmml">,</mo><mi id="S3.E5.m1.8.8.2.2" xref="S3.E5.m1.8.8.2.2.cmml">f</mi></mrow><mi id="S3.E5.m1.9.9.1.1.3.3.3.3.3" xref="S3.E5.m1.9.9.1.1.3.3.3.3.3.cmml">i</mi></msubsup><mo stretchy="false" id="S3.E5.m1.9.9.1.1.3.3.3.7" xref="S3.E5.m1.9.9.1.1.3.3.4.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E5.m1.9.9.1.2" xref="S3.E5.m1.9.9.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.9b"><apply id="S3.E5.m1.9.9.1.1.cmml" xref="S3.E5.m1.9.9.1"><eq id="S3.E5.m1.9.9.1.1.4.cmml" xref="S3.E5.m1.9.9.1.1.4"></eq><apply id="S3.E5.m1.9.9.1.1.5.cmml" xref="S3.E5.m1.9.9.1.1.5"><csymbol cd="ambiguous" id="S3.E5.m1.9.9.1.1.5.1.cmml" xref="S3.E5.m1.9.9.1.1.5">superscript</csymbol><apply id="S3.E5.m1.9.9.1.1.5.2.cmml" xref="S3.E5.m1.9.9.1.1.5"><csymbol cd="ambiguous" id="S3.E5.m1.9.9.1.1.5.2.1.cmml" xref="S3.E5.m1.9.9.1.1.5">subscript</csymbol><ci id="S3.E5.m1.9.9.1.1.5.2.2.cmml" xref="S3.E5.m1.9.9.1.1.5.2.2">𝐵</ci><list id="S3.E5.m1.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.4"><ci id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1">𝑤</ci><ci id="S3.E5.m1.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2">𝑓</ci></list></apply><ci id="S3.E5.m1.9.9.1.1.5.3.cmml" xref="S3.E5.m1.9.9.1.1.5.3">𝑖</ci></apply><apply id="S3.E5.m1.9.9.1.1.3.cmml" xref="S3.E5.m1.9.9.1.1.3"><times id="S3.E5.m1.9.9.1.1.3.4.cmml" xref="S3.E5.m1.9.9.1.1.3.4"></times><ci id="S3.E5.m1.9.9.1.1.3.5.cmml" xref="S3.E5.m1.9.9.1.1.3.5">𝑀</ci><ci id="S3.E5.m1.9.9.1.1.3.6.cmml" xref="S3.E5.m1.9.9.1.1.3.6">𝐻</ci><ci id="S3.E5.m1.9.9.1.1.3.7.cmml" xref="S3.E5.m1.9.9.1.1.3.7">𝐶</ci><ci id="S3.E5.m1.9.9.1.1.3.8.cmml" xref="S3.E5.m1.9.9.1.1.3.8">𝐴</ci><vector id="S3.E5.m1.9.9.1.1.3.3.4.cmml" xref="S3.E5.m1.9.9.1.1.3.3.3"><apply id="S3.E5.m1.9.9.1.1.1.1.1.1.cmml" xref="S3.E5.m1.9.9.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.9.9.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.9.9.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E5.m1.9.9.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.9.9.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.9.9.1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.9.9.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.9.9.1.1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.9.9.1.1.1.1.1.1.2.2">𝑄</ci><list id="S3.E5.m1.4.4.2.3.cmml" xref="S3.E5.m1.4.4.2.4"><ci id="S3.E5.m1.3.3.1.1.cmml" xref="S3.E5.m1.3.3.1.1">𝑤</ci><ci id="S3.E5.m1.4.4.2.2.cmml" xref="S3.E5.m1.4.4.2.2">𝑓</ci></list></apply><ci id="S3.E5.m1.9.9.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.9.9.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E5.m1.9.9.1.1.2.2.2.2.cmml" xref="S3.E5.m1.9.9.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.9.9.1.1.2.2.2.2.1.cmml" xref="S3.E5.m1.9.9.1.1.2.2.2.2">superscript</csymbol><apply id="S3.E5.m1.9.9.1.1.2.2.2.2.2.cmml" xref="S3.E5.m1.9.9.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.9.9.1.1.2.2.2.2.2.1.cmml" xref="S3.E5.m1.9.9.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E5.m1.9.9.1.1.2.2.2.2.2.2.cmml" xref="S3.E5.m1.9.9.1.1.2.2.2.2.2.2">𝐾</ci><list id="S3.E5.m1.6.6.2.3.cmml" xref="S3.E5.m1.6.6.2.4"><ci id="S3.E5.m1.5.5.1.1.cmml" xref="S3.E5.m1.5.5.1.1">𝑤</ci><ci id="S3.E5.m1.6.6.2.2.cmml" xref="S3.E5.m1.6.6.2.2">𝑓</ci></list></apply><ci id="S3.E5.m1.9.9.1.1.2.2.2.2.3.cmml" xref="S3.E5.m1.9.9.1.1.2.2.2.2.3">𝑖</ci></apply><apply id="S3.E5.m1.9.9.1.1.3.3.3.3.cmml" xref="S3.E5.m1.9.9.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.9.9.1.1.3.3.3.3.1.cmml" xref="S3.E5.m1.9.9.1.1.3.3.3.3">superscript</csymbol><apply id="S3.E5.m1.9.9.1.1.3.3.3.3.2.cmml" xref="S3.E5.m1.9.9.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.9.9.1.1.3.3.3.3.2.1.cmml" xref="S3.E5.m1.9.9.1.1.3.3.3.3">subscript</csymbol><ci id="S3.E5.m1.9.9.1.1.3.3.3.3.2.2.cmml" xref="S3.E5.m1.9.9.1.1.3.3.3.3.2.2">𝑉</ci><list id="S3.E5.m1.8.8.2.3.cmml" xref="S3.E5.m1.8.8.2.4"><ci id="S3.E5.m1.7.7.1.1.cmml" xref="S3.E5.m1.7.7.1.1">𝑤</ci><ci id="S3.E5.m1.8.8.2.2.cmml" xref="S3.E5.m1.8.8.2.2">𝑓</ci></list></apply><ci id="S3.E5.m1.9.9.1.1.3.3.3.3.3.cmml" xref="S3.E5.m1.9.9.1.1.3.3.3.3.3">𝑖</ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.9c">B_{w,f}^{i}=MHCA(Q_{w,f}^{i},K_{w,f}^{i},V_{w,f}^{i}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p4.23" class="ltx_p">The <math id="S3.SS3.p4.17.m1.2" class="ltx_Math" alttext="B_{w,f}^{i}\in\mathbb{R}^{w^{2}\times N\times C^{\prime}}" display="inline"><semantics id="S3.SS3.p4.17.m1.2a"><mrow id="S3.SS3.p4.17.m1.2.3" xref="S3.SS3.p4.17.m1.2.3.cmml"><msubsup id="S3.SS3.p4.17.m1.2.3.2" xref="S3.SS3.p4.17.m1.2.3.2.cmml"><mi id="S3.SS3.p4.17.m1.2.3.2.2.2" xref="S3.SS3.p4.17.m1.2.3.2.2.2.cmml">B</mi><mrow id="S3.SS3.p4.17.m1.2.2.2.4" xref="S3.SS3.p4.17.m1.2.2.2.3.cmml"><mi id="S3.SS3.p4.17.m1.1.1.1.1" xref="S3.SS3.p4.17.m1.1.1.1.1.cmml">w</mi><mo id="S3.SS3.p4.17.m1.2.2.2.4.1" xref="S3.SS3.p4.17.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p4.17.m1.2.2.2.2" xref="S3.SS3.p4.17.m1.2.2.2.2.cmml">f</mi></mrow><mi id="S3.SS3.p4.17.m1.2.3.2.3" xref="S3.SS3.p4.17.m1.2.3.2.3.cmml">i</mi></msubsup><mo id="S3.SS3.p4.17.m1.2.3.1" xref="S3.SS3.p4.17.m1.2.3.1.cmml">∈</mo><msup id="S3.SS3.p4.17.m1.2.3.3" xref="S3.SS3.p4.17.m1.2.3.3.cmml"><mi id="S3.SS3.p4.17.m1.2.3.3.2" xref="S3.SS3.p4.17.m1.2.3.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p4.17.m1.2.3.3.3" xref="S3.SS3.p4.17.m1.2.3.3.3.cmml"><msup id="S3.SS3.p4.17.m1.2.3.3.3.2" xref="S3.SS3.p4.17.m1.2.3.3.3.2.cmml"><mi id="S3.SS3.p4.17.m1.2.3.3.3.2.2" xref="S3.SS3.p4.17.m1.2.3.3.3.2.2.cmml">w</mi><mn id="S3.SS3.p4.17.m1.2.3.3.3.2.3" xref="S3.SS3.p4.17.m1.2.3.3.3.2.3.cmml">2</mn></msup><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p4.17.m1.2.3.3.3.1" xref="S3.SS3.p4.17.m1.2.3.3.3.1.cmml">×</mo><mi id="S3.SS3.p4.17.m1.2.3.3.3.3" xref="S3.SS3.p4.17.m1.2.3.3.3.3.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p4.17.m1.2.3.3.3.1a" xref="S3.SS3.p4.17.m1.2.3.3.3.1.cmml">×</mo><msup id="S3.SS3.p4.17.m1.2.3.3.3.4" xref="S3.SS3.p4.17.m1.2.3.3.3.4.cmml"><mi id="S3.SS3.p4.17.m1.2.3.3.3.4.2" xref="S3.SS3.p4.17.m1.2.3.3.3.4.2.cmml">C</mi><mo id="S3.SS3.p4.17.m1.2.3.3.3.4.3" xref="S3.SS3.p4.17.m1.2.3.3.3.4.3.cmml">′</mo></msup></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.17.m1.2b"><apply id="S3.SS3.p4.17.m1.2.3.cmml" xref="S3.SS3.p4.17.m1.2.3"><in id="S3.SS3.p4.17.m1.2.3.1.cmml" xref="S3.SS3.p4.17.m1.2.3.1"></in><apply id="S3.SS3.p4.17.m1.2.3.2.cmml" xref="S3.SS3.p4.17.m1.2.3.2"><csymbol cd="ambiguous" id="S3.SS3.p4.17.m1.2.3.2.1.cmml" xref="S3.SS3.p4.17.m1.2.3.2">superscript</csymbol><apply id="S3.SS3.p4.17.m1.2.3.2.2.cmml" xref="S3.SS3.p4.17.m1.2.3.2"><csymbol cd="ambiguous" id="S3.SS3.p4.17.m1.2.3.2.2.1.cmml" xref="S3.SS3.p4.17.m1.2.3.2">subscript</csymbol><ci id="S3.SS3.p4.17.m1.2.3.2.2.2.cmml" xref="S3.SS3.p4.17.m1.2.3.2.2.2">𝐵</ci><list id="S3.SS3.p4.17.m1.2.2.2.3.cmml" xref="S3.SS3.p4.17.m1.2.2.2.4"><ci id="S3.SS3.p4.17.m1.1.1.1.1.cmml" xref="S3.SS3.p4.17.m1.1.1.1.1">𝑤</ci><ci id="S3.SS3.p4.17.m1.2.2.2.2.cmml" xref="S3.SS3.p4.17.m1.2.2.2.2">𝑓</ci></list></apply><ci id="S3.SS3.p4.17.m1.2.3.2.3.cmml" xref="S3.SS3.p4.17.m1.2.3.2.3">𝑖</ci></apply><apply id="S3.SS3.p4.17.m1.2.3.3.cmml" xref="S3.SS3.p4.17.m1.2.3.3"><csymbol cd="ambiguous" id="S3.SS3.p4.17.m1.2.3.3.1.cmml" xref="S3.SS3.p4.17.m1.2.3.3">superscript</csymbol><ci id="S3.SS3.p4.17.m1.2.3.3.2.cmml" xref="S3.SS3.p4.17.m1.2.3.3.2">ℝ</ci><apply id="S3.SS3.p4.17.m1.2.3.3.3.cmml" xref="S3.SS3.p4.17.m1.2.3.3.3"><times id="S3.SS3.p4.17.m1.2.3.3.3.1.cmml" xref="S3.SS3.p4.17.m1.2.3.3.3.1"></times><apply id="S3.SS3.p4.17.m1.2.3.3.3.2.cmml" xref="S3.SS3.p4.17.m1.2.3.3.3.2"><csymbol cd="ambiguous" id="S3.SS3.p4.17.m1.2.3.3.3.2.1.cmml" xref="S3.SS3.p4.17.m1.2.3.3.3.2">superscript</csymbol><ci id="S3.SS3.p4.17.m1.2.3.3.3.2.2.cmml" xref="S3.SS3.p4.17.m1.2.3.3.3.2.2">𝑤</ci><cn type="integer" id="S3.SS3.p4.17.m1.2.3.3.3.2.3.cmml" xref="S3.SS3.p4.17.m1.2.3.3.3.2.3">2</cn></apply><ci id="S3.SS3.p4.17.m1.2.3.3.3.3.cmml" xref="S3.SS3.p4.17.m1.2.3.3.3.3">𝑁</ci><apply id="S3.SS3.p4.17.m1.2.3.3.3.4.cmml" xref="S3.SS3.p4.17.m1.2.3.3.3.4"><csymbol cd="ambiguous" id="S3.SS3.p4.17.m1.2.3.3.3.4.1.cmml" xref="S3.SS3.p4.17.m1.2.3.3.3.4">superscript</csymbol><ci id="S3.SS3.p4.17.m1.2.3.3.3.4.2.cmml" xref="S3.SS3.p4.17.m1.2.3.3.3.4.2">𝐶</ci><ci id="S3.SS3.p4.17.m1.2.3.3.3.4.3.cmml" xref="S3.SS3.p4.17.m1.2.3.3.3.4.3">′</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.17.m1.2c">B_{w,f}^{i}\in\mathbb{R}^{w^{2}\times N\times C^{\prime}}</annotation></semantics></math> is the querying result after attention and <math id="S3.SS3.p4.18.m2.1" class="ltx_Math" alttext="MHCA" display="inline"><semantics id="S3.SS3.p4.18.m2.1a"><mrow id="S3.SS3.p4.18.m2.1.1" xref="S3.SS3.p4.18.m2.1.1.cmml"><mi id="S3.SS3.p4.18.m2.1.1.2" xref="S3.SS3.p4.18.m2.1.1.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.18.m2.1.1.1" xref="S3.SS3.p4.18.m2.1.1.1.cmml">​</mo><mi id="S3.SS3.p4.18.m2.1.1.3" xref="S3.SS3.p4.18.m2.1.1.3.cmml">H</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.18.m2.1.1.1a" xref="S3.SS3.p4.18.m2.1.1.1.cmml">​</mo><mi id="S3.SS3.p4.18.m2.1.1.4" xref="S3.SS3.p4.18.m2.1.1.4.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.18.m2.1.1.1b" xref="S3.SS3.p4.18.m2.1.1.1.cmml">​</mo><mi id="S3.SS3.p4.18.m2.1.1.5" xref="S3.SS3.p4.18.m2.1.1.5.cmml">A</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.18.m2.1b"><apply id="S3.SS3.p4.18.m2.1.1.cmml" xref="S3.SS3.p4.18.m2.1.1"><times id="S3.SS3.p4.18.m2.1.1.1.cmml" xref="S3.SS3.p4.18.m2.1.1.1"></times><ci id="S3.SS3.p4.18.m2.1.1.2.cmml" xref="S3.SS3.p4.18.m2.1.1.2">𝑀</ci><ci id="S3.SS3.p4.18.m2.1.1.3.cmml" xref="S3.SS3.p4.18.m2.1.1.3">𝐻</ci><ci id="S3.SS3.p4.18.m2.1.1.4.cmml" xref="S3.SS3.p4.18.m2.1.1.4">𝐶</ci><ci id="S3.SS3.p4.18.m2.1.1.5.cmml" xref="S3.SS3.p4.18.m2.1.1.5">𝐴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.18.m2.1c">MHCA</annotation></semantics></math> represents the vanilla multi-head cross-attention operation. The relative position embeddings are utilized during the attention calculation to encode spatial information into the features. The querying result <math id="S3.SS3.p4.19.m3.2" class="ltx_Math" alttext="B_{w,f}^{i}" display="inline"><semantics id="S3.SS3.p4.19.m3.2a"><msubsup id="S3.SS3.p4.19.m3.2.3" xref="S3.SS3.p4.19.m3.2.3.cmml"><mi id="S3.SS3.p4.19.m3.2.3.2.2" xref="S3.SS3.p4.19.m3.2.3.2.2.cmml">B</mi><mrow id="S3.SS3.p4.19.m3.2.2.2.4" xref="S3.SS3.p4.19.m3.2.2.2.3.cmml"><mi id="S3.SS3.p4.19.m3.1.1.1.1" xref="S3.SS3.p4.19.m3.1.1.1.1.cmml">w</mi><mo id="S3.SS3.p4.19.m3.2.2.2.4.1" xref="S3.SS3.p4.19.m3.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p4.19.m3.2.2.2.2" xref="S3.SS3.p4.19.m3.2.2.2.2.cmml">f</mi></mrow><mi id="S3.SS3.p4.19.m3.2.3.3" xref="S3.SS3.p4.19.m3.2.3.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.19.m3.2b"><apply id="S3.SS3.p4.19.m3.2.3.cmml" xref="S3.SS3.p4.19.m3.2.3"><csymbol cd="ambiguous" id="S3.SS3.p4.19.m3.2.3.1.cmml" xref="S3.SS3.p4.19.m3.2.3">superscript</csymbol><apply id="S3.SS3.p4.19.m3.2.3.2.cmml" xref="S3.SS3.p4.19.m3.2.3"><csymbol cd="ambiguous" id="S3.SS3.p4.19.m3.2.3.2.1.cmml" xref="S3.SS3.p4.19.m3.2.3">subscript</csymbol><ci id="S3.SS3.p4.19.m3.2.3.2.2.cmml" xref="S3.SS3.p4.19.m3.2.3.2.2">𝐵</ci><list id="S3.SS3.p4.19.m3.2.2.2.3.cmml" xref="S3.SS3.p4.19.m3.2.2.2.4"><ci id="S3.SS3.p4.19.m3.1.1.1.1.cmml" xref="S3.SS3.p4.19.m3.1.1.1.1">𝑤</ci><ci id="S3.SS3.p4.19.m3.2.2.2.2.cmml" xref="S3.SS3.p4.19.m3.2.2.2.2">𝑓</ci></list></apply><ci id="S3.SS3.p4.19.m3.2.3.3.cmml" xref="S3.SS3.p4.19.m3.2.3.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.19.m3.2c">B_{w,f}^{i}</annotation></semantics></math> are reshaped back to the window shape, <em id="S3.SS3.p4.23.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S3.SS3.p4.23.2" class="ltx_text"></span>, <math id="S3.SS3.p4.20.m4.1" class="ltx_Math" alttext="B_{w}^{i}\in\mathcal{R}^{w\times w\times C}" display="inline"><semantics id="S3.SS3.p4.20.m4.1a"><mrow id="S3.SS3.p4.20.m4.1.1" xref="S3.SS3.p4.20.m4.1.1.cmml"><msubsup id="S3.SS3.p4.20.m4.1.1.2" xref="S3.SS3.p4.20.m4.1.1.2.cmml"><mi id="S3.SS3.p4.20.m4.1.1.2.2.2" xref="S3.SS3.p4.20.m4.1.1.2.2.2.cmml">B</mi><mi id="S3.SS3.p4.20.m4.1.1.2.2.3" xref="S3.SS3.p4.20.m4.1.1.2.2.3.cmml">w</mi><mi id="S3.SS3.p4.20.m4.1.1.2.3" xref="S3.SS3.p4.20.m4.1.1.2.3.cmml">i</mi></msubsup><mo id="S3.SS3.p4.20.m4.1.1.1" xref="S3.SS3.p4.20.m4.1.1.1.cmml">∈</mo><msup id="S3.SS3.p4.20.m4.1.1.3" xref="S3.SS3.p4.20.m4.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p4.20.m4.1.1.3.2" xref="S3.SS3.p4.20.m4.1.1.3.2.cmml">ℛ</mi><mrow id="S3.SS3.p4.20.m4.1.1.3.3" xref="S3.SS3.p4.20.m4.1.1.3.3.cmml"><mi id="S3.SS3.p4.20.m4.1.1.3.3.2" xref="S3.SS3.p4.20.m4.1.1.3.3.2.cmml">w</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p4.20.m4.1.1.3.3.1" xref="S3.SS3.p4.20.m4.1.1.3.3.1.cmml">×</mo><mi id="S3.SS3.p4.20.m4.1.1.3.3.3" xref="S3.SS3.p4.20.m4.1.1.3.3.3.cmml">w</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p4.20.m4.1.1.3.3.1a" xref="S3.SS3.p4.20.m4.1.1.3.3.1.cmml">×</mo><mi id="S3.SS3.p4.20.m4.1.1.3.3.4" xref="S3.SS3.p4.20.m4.1.1.3.3.4.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.20.m4.1b"><apply id="S3.SS3.p4.20.m4.1.1.cmml" xref="S3.SS3.p4.20.m4.1.1"><in id="S3.SS3.p4.20.m4.1.1.1.cmml" xref="S3.SS3.p4.20.m4.1.1.1"></in><apply id="S3.SS3.p4.20.m4.1.1.2.cmml" xref="S3.SS3.p4.20.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p4.20.m4.1.1.2.1.cmml" xref="S3.SS3.p4.20.m4.1.1.2">superscript</csymbol><apply id="S3.SS3.p4.20.m4.1.1.2.2.cmml" xref="S3.SS3.p4.20.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p4.20.m4.1.1.2.2.1.cmml" xref="S3.SS3.p4.20.m4.1.1.2">subscript</csymbol><ci id="S3.SS3.p4.20.m4.1.1.2.2.2.cmml" xref="S3.SS3.p4.20.m4.1.1.2.2.2">𝐵</ci><ci id="S3.SS3.p4.20.m4.1.1.2.2.3.cmml" xref="S3.SS3.p4.20.m4.1.1.2.2.3">𝑤</ci></apply><ci id="S3.SS3.p4.20.m4.1.1.2.3.cmml" xref="S3.SS3.p4.20.m4.1.1.2.3">𝑖</ci></apply><apply id="S3.SS3.p4.20.m4.1.1.3.cmml" xref="S3.SS3.p4.20.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p4.20.m4.1.1.3.1.cmml" xref="S3.SS3.p4.20.m4.1.1.3">superscript</csymbol><ci id="S3.SS3.p4.20.m4.1.1.3.2.cmml" xref="S3.SS3.p4.20.m4.1.1.3.2">ℛ</ci><apply id="S3.SS3.p4.20.m4.1.1.3.3.cmml" xref="S3.SS3.p4.20.m4.1.1.3.3"><times id="S3.SS3.p4.20.m4.1.1.3.3.1.cmml" xref="S3.SS3.p4.20.m4.1.1.3.3.1"></times><ci id="S3.SS3.p4.20.m4.1.1.3.3.2.cmml" xref="S3.SS3.p4.20.m4.1.1.3.3.2">𝑤</ci><ci id="S3.SS3.p4.20.m4.1.1.3.3.3.cmml" xref="S3.SS3.p4.20.m4.1.1.3.3.3">𝑤</ci><ci id="S3.SS3.p4.20.m4.1.1.3.3.4.cmml" xref="S3.SS3.p4.20.m4.1.1.3.3.4">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.20.m4.1c">B_{w}^{i}\in\mathcal{R}^{w\times w\times C}</annotation></semantics></math>, and added with <math id="S3.SS3.p4.21.m5.1" class="ltx_Math" alttext="Z_{w}^{i}" display="inline"><semantics id="S3.SS3.p4.21.m5.1a"><msubsup id="S3.SS3.p4.21.m5.1.1" xref="S3.SS3.p4.21.m5.1.1.cmml"><mi id="S3.SS3.p4.21.m5.1.1.2.2" xref="S3.SS3.p4.21.m5.1.1.2.2.cmml">Z</mi><mi id="S3.SS3.p4.21.m5.1.1.2.3" xref="S3.SS3.p4.21.m5.1.1.2.3.cmml">w</mi><mi id="S3.SS3.p4.21.m5.1.1.3" xref="S3.SS3.p4.21.m5.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.21.m5.1b"><apply id="S3.SS3.p4.21.m5.1.1.cmml" xref="S3.SS3.p4.21.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.21.m5.1.1.1.cmml" xref="S3.SS3.p4.21.m5.1.1">superscript</csymbol><apply id="S3.SS3.p4.21.m5.1.1.2.cmml" xref="S3.SS3.p4.21.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.21.m5.1.1.2.1.cmml" xref="S3.SS3.p4.21.m5.1.1">subscript</csymbol><ci id="S3.SS3.p4.21.m5.1.1.2.2.cmml" xref="S3.SS3.p4.21.m5.1.1.2.2">𝑍</ci><ci id="S3.SS3.p4.21.m5.1.1.2.3.cmml" xref="S3.SS3.p4.21.m5.1.1.2.3">𝑤</ci></apply><ci id="S3.SS3.p4.21.m5.1.1.3.cmml" xref="S3.SS3.p4.21.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.21.m5.1c">Z_{w}^{i}</annotation></semantics></math> and <math id="S3.SS3.p4.22.m6.1" class="ltx_Math" alttext="Y_{w}^{i}" display="inline"><semantics id="S3.SS3.p4.22.m6.1a"><msubsup id="S3.SS3.p4.22.m6.1.1" xref="S3.SS3.p4.22.m6.1.1.cmml"><mi id="S3.SS3.p4.22.m6.1.1.2.2" xref="S3.SS3.p4.22.m6.1.1.2.2.cmml">Y</mi><mi id="S3.SS3.p4.22.m6.1.1.2.3" xref="S3.SS3.p4.22.m6.1.1.2.3.cmml">w</mi><mi id="S3.SS3.p4.22.m6.1.1.3" xref="S3.SS3.p4.22.m6.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.22.m6.1b"><apply id="S3.SS3.p4.22.m6.1.1.cmml" xref="S3.SS3.p4.22.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.22.m6.1.1.1.cmml" xref="S3.SS3.p4.22.m6.1.1">superscript</csymbol><apply id="S3.SS3.p4.22.m6.1.1.2.cmml" xref="S3.SS3.p4.22.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.22.m6.1.1.2.1.cmml" xref="S3.SS3.p4.22.m6.1.1">subscript</csymbol><ci id="S3.SS3.p4.22.m6.1.1.2.2.cmml" xref="S3.SS3.p4.22.m6.1.1.2.2">𝑌</ci><ci id="S3.SS3.p4.22.m6.1.1.2.3.cmml" xref="S3.SS3.p4.22.m6.1.1.2.3">𝑤</ci></apply><ci id="S3.SS3.p4.22.m6.1.1.3.cmml" xref="S3.SS3.p4.22.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.22.m6.1c">Y_{w}^{i}</annotation></semantics></math>, <a href="#S3.F3" title="In 3.3 Cross-Model Querying ‣ 3 Methodology ‣ DQnet: Cross-Model Detail Querying for Camouflaged Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">3</span></a>. The same operation is individually repeated for each window and the generated features from all windows are then concatenated to recover the shape of input features, to get the final enhanced representation, <math id="S3.SS3.p4.23.m7.1" class="ltx_Math" alttext="B\in\mathbb{R}^{P^{2}\times C}" display="inline"><semantics id="S3.SS3.p4.23.m7.1a"><mrow id="S3.SS3.p4.23.m7.1.1" xref="S3.SS3.p4.23.m7.1.1.cmml"><mi id="S3.SS3.p4.23.m7.1.1.2" xref="S3.SS3.p4.23.m7.1.1.2.cmml">B</mi><mo id="S3.SS3.p4.23.m7.1.1.1" xref="S3.SS3.p4.23.m7.1.1.1.cmml">∈</mo><msup id="S3.SS3.p4.23.m7.1.1.3" xref="S3.SS3.p4.23.m7.1.1.3.cmml"><mi id="S3.SS3.p4.23.m7.1.1.3.2" xref="S3.SS3.p4.23.m7.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p4.23.m7.1.1.3.3" xref="S3.SS3.p4.23.m7.1.1.3.3.cmml"><msup id="S3.SS3.p4.23.m7.1.1.3.3.2" xref="S3.SS3.p4.23.m7.1.1.3.3.2.cmml"><mi id="S3.SS3.p4.23.m7.1.1.3.3.2.2" xref="S3.SS3.p4.23.m7.1.1.3.3.2.2.cmml">P</mi><mn id="S3.SS3.p4.23.m7.1.1.3.3.2.3" xref="S3.SS3.p4.23.m7.1.1.3.3.2.3.cmml">2</mn></msup><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p4.23.m7.1.1.3.3.1" xref="S3.SS3.p4.23.m7.1.1.3.3.1.cmml">×</mo><mi id="S3.SS3.p4.23.m7.1.1.3.3.3" xref="S3.SS3.p4.23.m7.1.1.3.3.3.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.23.m7.1b"><apply id="S3.SS3.p4.23.m7.1.1.cmml" xref="S3.SS3.p4.23.m7.1.1"><in id="S3.SS3.p4.23.m7.1.1.1.cmml" xref="S3.SS3.p4.23.m7.1.1.1"></in><ci id="S3.SS3.p4.23.m7.1.1.2.cmml" xref="S3.SS3.p4.23.m7.1.1.2">𝐵</ci><apply id="S3.SS3.p4.23.m7.1.1.3.cmml" xref="S3.SS3.p4.23.m7.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p4.23.m7.1.1.3.1.cmml" xref="S3.SS3.p4.23.m7.1.1.3">superscript</csymbol><ci id="S3.SS3.p4.23.m7.1.1.3.2.cmml" xref="S3.SS3.p4.23.m7.1.1.3.2">ℝ</ci><apply id="S3.SS3.p4.23.m7.1.1.3.3.cmml" xref="S3.SS3.p4.23.m7.1.1.3.3"><times id="S3.SS3.p4.23.m7.1.1.3.3.1.cmml" xref="S3.SS3.p4.23.m7.1.1.3.3.1"></times><apply id="S3.SS3.p4.23.m7.1.1.3.3.2.cmml" xref="S3.SS3.p4.23.m7.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS3.p4.23.m7.1.1.3.3.2.1.cmml" xref="S3.SS3.p4.23.m7.1.1.3.3.2">superscript</csymbol><ci id="S3.SS3.p4.23.m7.1.1.3.3.2.2.cmml" xref="S3.SS3.p4.23.m7.1.1.3.3.2.2">𝑃</ci><cn type="integer" id="S3.SS3.p4.23.m7.1.1.3.3.2.3.cmml" xref="S3.SS3.p4.23.m7.1.1.3.3.2.3">2</cn></apply><ci id="S3.SS3.p4.23.m7.1.1.3.3.3.cmml" xref="S3.SS3.p4.23.m7.1.1.3.3.3">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.23.m7.1c">B\in\mathbb{R}^{P^{2}\times C}</annotation></semantics></math>.</p>
</div>
<figure id="S3.F3" class="ltx_figure"><img src="/html/2212.08296/assets/x3.png" id="S3.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="328" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F3.2.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S3.F3.3.2" class="ltx_text" style="font-size:90%;">Illustration of the relation-based querying (RBQ). (Best viewed in color)</span></figcaption>
</figure>
<div id="S3.SS3.p5" class="ltx_para">
<p id="S3.SS3.p5.2" class="ltx_p">With the usage of window-based attention, the computational complexity decreases to linear to the input size, <em id="S3.SS3.p5.2.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S3.SS3.p5.2.2" class="ltx_text"></span>, the computation complexity of RBQ module for each image is <math id="S3.SS3.p5.1.m1.1" class="ltx_Math" alttext="\mathcal{O}(w^{2}HWC)" display="inline"><semantics id="S3.SS3.p5.1.m1.1a"><mrow id="S3.SS3.p5.1.m1.1.1" xref="S3.SS3.p5.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p5.1.m1.1.1.3" xref="S3.SS3.p5.1.m1.1.1.3.cmml">𝒪</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p5.1.m1.1.1.2" xref="S3.SS3.p5.1.m1.1.1.2.cmml">​</mo><mrow id="S3.SS3.p5.1.m1.1.1.1.1" xref="S3.SS3.p5.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p5.1.m1.1.1.1.1.2" xref="S3.SS3.p5.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p5.1.m1.1.1.1.1.1" xref="S3.SS3.p5.1.m1.1.1.1.1.1.cmml"><msup id="S3.SS3.p5.1.m1.1.1.1.1.1.2" xref="S3.SS3.p5.1.m1.1.1.1.1.1.2.cmml"><mi id="S3.SS3.p5.1.m1.1.1.1.1.1.2.2" xref="S3.SS3.p5.1.m1.1.1.1.1.1.2.2.cmml">w</mi><mn id="S3.SS3.p5.1.m1.1.1.1.1.1.2.3" xref="S3.SS3.p5.1.m1.1.1.1.1.1.2.3.cmml">2</mn></msup><mo lspace="0em" rspace="0em" id="S3.SS3.p5.1.m1.1.1.1.1.1.1" xref="S3.SS3.p5.1.m1.1.1.1.1.1.1.cmml">​</mo><mi id="S3.SS3.p5.1.m1.1.1.1.1.1.3" xref="S3.SS3.p5.1.m1.1.1.1.1.1.3.cmml">H</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p5.1.m1.1.1.1.1.1.1a" xref="S3.SS3.p5.1.m1.1.1.1.1.1.1.cmml">​</mo><mi id="S3.SS3.p5.1.m1.1.1.1.1.1.4" xref="S3.SS3.p5.1.m1.1.1.1.1.1.4.cmml">W</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p5.1.m1.1.1.1.1.1.1b" xref="S3.SS3.p5.1.m1.1.1.1.1.1.1.cmml">​</mo><mi id="S3.SS3.p5.1.m1.1.1.1.1.1.5" xref="S3.SS3.p5.1.m1.1.1.1.1.1.5.cmml">C</mi></mrow><mo stretchy="false" id="S3.SS3.p5.1.m1.1.1.1.1.3" xref="S3.SS3.p5.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.1.m1.1b"><apply id="S3.SS3.p5.1.m1.1.1.cmml" xref="S3.SS3.p5.1.m1.1.1"><times id="S3.SS3.p5.1.m1.1.1.2.cmml" xref="S3.SS3.p5.1.m1.1.1.2"></times><ci id="S3.SS3.p5.1.m1.1.1.3.cmml" xref="S3.SS3.p5.1.m1.1.1.3">𝒪</ci><apply id="S3.SS3.p5.1.m1.1.1.1.1.1.cmml" xref="S3.SS3.p5.1.m1.1.1.1.1"><times id="S3.SS3.p5.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS3.p5.1.m1.1.1.1.1.1.1"></times><apply id="S3.SS3.p5.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS3.p5.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p5.1.m1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p5.1.m1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.SS3.p5.1.m1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.p5.1.m1.1.1.1.1.1.2.2">𝑤</ci><cn type="integer" id="S3.SS3.p5.1.m1.1.1.1.1.1.2.3.cmml" xref="S3.SS3.p5.1.m1.1.1.1.1.1.2.3">2</cn></apply><ci id="S3.SS3.p5.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS3.p5.1.m1.1.1.1.1.1.3">𝐻</ci><ci id="S3.SS3.p5.1.m1.1.1.1.1.1.4.cmml" xref="S3.SS3.p5.1.m1.1.1.1.1.1.4">𝑊</ci><ci id="S3.SS3.p5.1.m1.1.1.1.1.1.5.cmml" xref="S3.SS3.p5.1.m1.1.1.1.1.1.5">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.1.m1.1c">\mathcal{O}(w^{2}HWC)</annotation></semantics></math>, compared to <math id="S3.SS3.p5.2.m2.1" class="ltx_Math" alttext="\mathcal{O}((HW)^{2}C)" display="inline"><semantics id="S3.SS3.p5.2.m2.1a"><mrow id="S3.SS3.p5.2.m2.1.1" xref="S3.SS3.p5.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p5.2.m2.1.1.3" xref="S3.SS3.p5.2.m2.1.1.3.cmml">𝒪</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p5.2.m2.1.1.2" xref="S3.SS3.p5.2.m2.1.1.2.cmml">​</mo><mrow id="S3.SS3.p5.2.m2.1.1.1.1" xref="S3.SS3.p5.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p5.2.m2.1.1.1.1.2" xref="S3.SS3.p5.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p5.2.m2.1.1.1.1.1" xref="S3.SS3.p5.2.m2.1.1.1.1.1.cmml"><msup id="S3.SS3.p5.2.m2.1.1.1.1.1.1" xref="S3.SS3.p5.2.m2.1.1.1.1.1.1.cmml"><mrow id="S3.SS3.p5.2.m2.1.1.1.1.1.1.1.1" xref="S3.SS3.p5.2.m2.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p5.2.m2.1.1.1.1.1.1.1.1.2" xref="S3.SS3.p5.2.m2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p5.2.m2.1.1.1.1.1.1.1.1.1" xref="S3.SS3.p5.2.m2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS3.p5.2.m2.1.1.1.1.1.1.1.1.1.2" xref="S3.SS3.p5.2.m2.1.1.1.1.1.1.1.1.1.2.cmml">H</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p5.2.m2.1.1.1.1.1.1.1.1.1.1" xref="S3.SS3.p5.2.m2.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mi id="S3.SS3.p5.2.m2.1.1.1.1.1.1.1.1.1.3" xref="S3.SS3.p5.2.m2.1.1.1.1.1.1.1.1.1.3.cmml">W</mi></mrow><mo stretchy="false" id="S3.SS3.p5.2.m2.1.1.1.1.1.1.1.1.3" xref="S3.SS3.p5.2.m2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S3.SS3.p5.2.m2.1.1.1.1.1.1.3" xref="S3.SS3.p5.2.m2.1.1.1.1.1.1.3.cmml">2</mn></msup><mo lspace="0em" rspace="0em" id="S3.SS3.p5.2.m2.1.1.1.1.1.2" xref="S3.SS3.p5.2.m2.1.1.1.1.1.2.cmml">​</mo><mi id="S3.SS3.p5.2.m2.1.1.1.1.1.3" xref="S3.SS3.p5.2.m2.1.1.1.1.1.3.cmml">C</mi></mrow><mo stretchy="false" id="S3.SS3.p5.2.m2.1.1.1.1.3" xref="S3.SS3.p5.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.2.m2.1b"><apply id="S3.SS3.p5.2.m2.1.1.cmml" xref="S3.SS3.p5.2.m2.1.1"><times id="S3.SS3.p5.2.m2.1.1.2.cmml" xref="S3.SS3.p5.2.m2.1.1.2"></times><ci id="S3.SS3.p5.2.m2.1.1.3.cmml" xref="S3.SS3.p5.2.m2.1.1.3">𝒪</ci><apply id="S3.SS3.p5.2.m2.1.1.1.1.1.cmml" xref="S3.SS3.p5.2.m2.1.1.1.1"><times id="S3.SS3.p5.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS3.p5.2.m2.1.1.1.1.1.2"></times><apply id="S3.SS3.p5.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS3.p5.2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p5.2.m2.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p5.2.m2.1.1.1.1.1.1">superscript</csymbol><apply id="S3.SS3.p5.2.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p5.2.m2.1.1.1.1.1.1.1.1"><times id="S3.SS3.p5.2.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p5.2.m2.1.1.1.1.1.1.1.1.1.1"></times><ci id="S3.SS3.p5.2.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p5.2.m2.1.1.1.1.1.1.1.1.1.2">𝐻</ci><ci id="S3.SS3.p5.2.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p5.2.m2.1.1.1.1.1.1.1.1.1.3">𝑊</ci></apply><cn type="integer" id="S3.SS3.p5.2.m2.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p5.2.m2.1.1.1.1.1.1.3">2</cn></apply><ci id="S3.SS3.p5.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS3.p5.2.m2.1.1.1.1.1.3">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.2.m2.1c">\mathcal{O}((HW)^{2}C)</annotation></semantics></math> of the global attention, which makes the detail querying more efficient.</p>
</div>
<div id="S3.SS3.p6" class="ltx_para">
<p id="S3.SS3.p6.1" class="ltx_p">It should be noted that we design RBQ to query details in different scales of CNN feature maps (<math id="S3.SS3.p6.1.m1.6" class="ltx_Math" alttext="\left\{\bm{s}_{i}|i=1,2,3,4\right\}" display="inline"><semantics id="S3.SS3.p6.1.m1.6a"><mrow id="S3.SS3.p6.1.m1.6.6.2" xref="S3.SS3.p6.1.m1.6.6.3.cmml"><mo id="S3.SS3.p6.1.m1.6.6.2.3" xref="S3.SS3.p6.1.m1.6.6.3.1.cmml">{</mo><msub id="S3.SS3.p6.1.m1.5.5.1.1" xref="S3.SS3.p6.1.m1.5.5.1.1.cmml"><mi id="S3.SS3.p6.1.m1.5.5.1.1.2" xref="S3.SS3.p6.1.m1.5.5.1.1.2.cmml">𝒔</mi><mi id="S3.SS3.p6.1.m1.5.5.1.1.3" xref="S3.SS3.p6.1.m1.5.5.1.1.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p6.1.m1.6.6.2.4" xref="S3.SS3.p6.1.m1.6.6.3.1.cmml">|</mo><mrow id="S3.SS3.p6.1.m1.6.6.2.2" xref="S3.SS3.p6.1.m1.6.6.2.2.cmml"><mi id="S3.SS3.p6.1.m1.6.6.2.2.2" xref="S3.SS3.p6.1.m1.6.6.2.2.2.cmml">i</mi><mo id="S3.SS3.p6.1.m1.6.6.2.2.1" xref="S3.SS3.p6.1.m1.6.6.2.2.1.cmml">=</mo><mrow id="S3.SS3.p6.1.m1.6.6.2.2.3.2" xref="S3.SS3.p6.1.m1.6.6.2.2.3.1.cmml"><mn id="S3.SS3.p6.1.m1.1.1" xref="S3.SS3.p6.1.m1.1.1.cmml">1</mn><mo id="S3.SS3.p6.1.m1.6.6.2.2.3.2.1" xref="S3.SS3.p6.1.m1.6.6.2.2.3.1.cmml">,</mo><mn id="S3.SS3.p6.1.m1.2.2" xref="S3.SS3.p6.1.m1.2.2.cmml">2</mn><mo id="S3.SS3.p6.1.m1.6.6.2.2.3.2.2" xref="S3.SS3.p6.1.m1.6.6.2.2.3.1.cmml">,</mo><mn id="S3.SS3.p6.1.m1.3.3" xref="S3.SS3.p6.1.m1.3.3.cmml">3</mn><mo id="S3.SS3.p6.1.m1.6.6.2.2.3.2.3" xref="S3.SS3.p6.1.m1.6.6.2.2.3.1.cmml">,</mo><mn id="S3.SS3.p6.1.m1.4.4" xref="S3.SS3.p6.1.m1.4.4.cmml">4</mn></mrow></mrow><mo id="S3.SS3.p6.1.m1.6.6.2.5" xref="S3.SS3.p6.1.m1.6.6.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.1.m1.6b"><apply id="S3.SS3.p6.1.m1.6.6.3.cmml" xref="S3.SS3.p6.1.m1.6.6.2"><csymbol cd="latexml" id="S3.SS3.p6.1.m1.6.6.3.1.cmml" xref="S3.SS3.p6.1.m1.6.6.2.3">conditional-set</csymbol><apply id="S3.SS3.p6.1.m1.5.5.1.1.cmml" xref="S3.SS3.p6.1.m1.5.5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p6.1.m1.5.5.1.1.1.cmml" xref="S3.SS3.p6.1.m1.5.5.1.1">subscript</csymbol><ci id="S3.SS3.p6.1.m1.5.5.1.1.2.cmml" xref="S3.SS3.p6.1.m1.5.5.1.1.2">𝒔</ci><ci id="S3.SS3.p6.1.m1.5.5.1.1.3.cmml" xref="S3.SS3.p6.1.m1.5.5.1.1.3">𝑖</ci></apply><apply id="S3.SS3.p6.1.m1.6.6.2.2.cmml" xref="S3.SS3.p6.1.m1.6.6.2.2"><eq id="S3.SS3.p6.1.m1.6.6.2.2.1.cmml" xref="S3.SS3.p6.1.m1.6.6.2.2.1"></eq><ci id="S3.SS3.p6.1.m1.6.6.2.2.2.cmml" xref="S3.SS3.p6.1.m1.6.6.2.2.2">𝑖</ci><list id="S3.SS3.p6.1.m1.6.6.2.2.3.1.cmml" xref="S3.SS3.p6.1.m1.6.6.2.2.3.2"><cn type="integer" id="S3.SS3.p6.1.m1.1.1.cmml" xref="S3.SS3.p6.1.m1.1.1">1</cn><cn type="integer" id="S3.SS3.p6.1.m1.2.2.cmml" xref="S3.SS3.p6.1.m1.2.2">2</cn><cn type="integer" id="S3.SS3.p6.1.m1.3.3.cmml" xref="S3.SS3.p6.1.m1.3.3">3</cn><cn type="integer" id="S3.SS3.p6.1.m1.4.4.cmml" xref="S3.SS3.p6.1.m1.4.4">4</cn></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.1.m1.6c">\left\{\bm{s}_{i}|i=1,2,3,4\right\}</annotation></semantics></math>), which progressively eliminates the imprecise feature entanglement when plainly adding two semantically-gapped features together. It seems that a full attention is also able to get the cross-model relationship. However, it aggravates the already tense object-background ambiguity and comes with large memory overhead when dealing with high resolution input. We claim that windowed attention is more suitable for detail querying purpose because the local windows help the relation reasoning focusing on spatial neighboring elements, which reduces the noise caused by object-background similarity. Our experiment in <a href="#S4.SS3" title="4.3 Model Evaluation and Analyses ‣ 4 Experiments ‣ DQnet: Cross-Model Detail Querying for Camouflaged Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">4.3</span></a> has proved that empirically.</p>
</div>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Loss Functions</h3>

<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.1" class="ltx_p">Following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>, we choose the weighted binary cross-entropy loss (<math id="S3.SS4.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{\text{BCE}}^{w}" display="inline"><semantics id="S3.SS4.p1.1.m1.1a"><msubsup id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.1.m1.1.1.2.2" xref="S3.SS4.p1.1.m1.1.1.2.2.cmml">ℒ</mi><mtext id="S3.SS4.p1.1.m1.1.1.2.3" xref="S3.SS4.p1.1.m1.1.1.2.3a.cmml">BCE</mtext><mi id="S3.SS4.p1.1.m1.1.1.3" xref="S3.SS4.p1.1.m1.1.1.3.cmml">w</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><apply id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.1.m1.1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1">superscript</csymbol><apply id="S3.SS4.p1.1.m1.1.1.2.cmml" xref="S3.SS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.1.m1.1.1.2.1.cmml" xref="S3.SS4.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS4.p1.1.m1.1.1.2.2.cmml" xref="S3.SS4.p1.1.m1.1.1.2.2">ℒ</ci><ci id="S3.SS4.p1.1.m1.1.1.2.3a.cmml" xref="S3.SS4.p1.1.m1.1.1.2.3"><mtext mathsize="70%" id="S3.SS4.p1.1.m1.1.1.2.3.cmml" xref="S3.SS4.p1.1.m1.1.1.2.3">BCE</mtext></ci></apply><ci id="S3.SS4.p1.1.m1.1.1.3.cmml" xref="S3.SS4.p1.1.m1.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">\mathcal{L}_{\text{BCE}}^{w}</annotation></semantics></math>) as our main loss. By calculating the difference between the center pixel and its surrounding environment, each pixel is assigned a different weight, so that the hard pixels can be obtained more attention.</p>
</div>
<div id="S3.SS4.p2" class="ltx_para">
<p id="S3.SS4.p2.1" class="ltx_p">In fact, pixels located on difficult-to-detect regions (e.g., camouflage edge and occluded regions) are prone to activate differently in ViT feature and CNN features due to the much larger uncertainty. These pixels contain significant details which are critical to precise camouflage detection and deserve more attention. We argue that a larger weight value in these pixels could help the network focus on more siginificant features and better preserve the local details. Thus we propose the Significance Aware Loss (SAL) to supervise the detail querying results of RBQ, which can be defined as:</p>
</div>
<div id="S3.SS4.p3" class="ltx_para">
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.5" class="ltx_Math" alttext="\mathcal{L}_{SAL}=-\frac{\sum\limits^{4}_{s=1}\sum\limits^{H}_{i=1}\sum\limits^{W}_{j=1}(1+\beta\omega^{s}_{ij})\cdot\ell_{bce}(G^{a}_{ij},{\mathrm{P^{s}}}_{ij})}{\sum\limits^{4}_{s=1}\sum\limits^{H}_{i=1}\sum\limits^{W}_{j=1}(1+\beta\omega^{s}_{ij})}," display="block"><semantics id="S3.E6.m1.5a"><mrow id="S3.E6.m1.5.5.1" xref="S3.E6.m1.5.5.1.1.cmml"><mrow id="S3.E6.m1.5.5.1.1" xref="S3.E6.m1.5.5.1.1.cmml"><msub id="S3.E6.m1.5.5.1.1.2" xref="S3.E6.m1.5.5.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.5.5.1.1.2.2" xref="S3.E6.m1.5.5.1.1.2.2.cmml">ℒ</mi><mrow id="S3.E6.m1.5.5.1.1.2.3" xref="S3.E6.m1.5.5.1.1.2.3.cmml"><mi id="S3.E6.m1.5.5.1.1.2.3.2" xref="S3.E6.m1.5.5.1.1.2.3.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.1.1.2.3.1" xref="S3.E6.m1.5.5.1.1.2.3.1.cmml">​</mo><mi id="S3.E6.m1.5.5.1.1.2.3.3" xref="S3.E6.m1.5.5.1.1.2.3.3.cmml">A</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.1.1.2.3.1a" xref="S3.E6.m1.5.5.1.1.2.3.1.cmml">​</mo><mi id="S3.E6.m1.5.5.1.1.2.3.4" xref="S3.E6.m1.5.5.1.1.2.3.4.cmml">L</mi></mrow></msub><mo id="S3.E6.m1.5.5.1.1.1" xref="S3.E6.m1.5.5.1.1.1.cmml">=</mo><mrow id="S3.E6.m1.5.5.1.1.3" xref="S3.E6.m1.5.5.1.1.3.cmml"><mo id="S3.E6.m1.5.5.1.1.3a" xref="S3.E6.m1.5.5.1.1.3.cmml">−</mo><mfrac id="S3.E6.m1.4.4" xref="S3.E6.m1.4.4.cmml"><mrow id="S3.E6.m1.3.3.3" xref="S3.E6.m1.3.3.3.cmml"><munderover id="S3.E6.m1.3.3.3.4" xref="S3.E6.m1.3.3.3.4.cmml"><mo movablelimits="false" id="S3.E6.m1.3.3.3.4.2.2" xref="S3.E6.m1.3.3.3.4.2.2.cmml">∑</mo><mrow id="S3.E6.m1.3.3.3.4.3" xref="S3.E6.m1.3.3.3.4.3.cmml"><mi id="S3.E6.m1.3.3.3.4.3.2" xref="S3.E6.m1.3.3.3.4.3.2.cmml">s</mi><mo id="S3.E6.m1.3.3.3.4.3.1" xref="S3.E6.m1.3.3.3.4.3.1.cmml">=</mo><mn id="S3.E6.m1.3.3.3.4.3.3" xref="S3.E6.m1.3.3.3.4.3.3.cmml">1</mn></mrow><mn id="S3.E6.m1.3.3.3.4.2.3" xref="S3.E6.m1.3.3.3.4.2.3.cmml">4</mn></munderover><mrow id="S3.E6.m1.3.3.3.3" xref="S3.E6.m1.3.3.3.3.cmml"><munderover id="S3.E6.m1.3.3.3.3.4" xref="S3.E6.m1.3.3.3.3.4.cmml"><mo lspace="0.167em" movablelimits="false" rspace="0em" id="S3.E6.m1.3.3.3.3.4.2.2" xref="S3.E6.m1.3.3.3.3.4.2.2.cmml">∑</mo><mrow id="S3.E6.m1.3.3.3.3.4.3" xref="S3.E6.m1.3.3.3.3.4.3.cmml"><mi id="S3.E6.m1.3.3.3.3.4.3.2" xref="S3.E6.m1.3.3.3.3.4.3.2.cmml">i</mi><mo id="S3.E6.m1.3.3.3.3.4.3.1" xref="S3.E6.m1.3.3.3.3.4.3.1.cmml">=</mo><mn id="S3.E6.m1.3.3.3.3.4.3.3" xref="S3.E6.m1.3.3.3.3.4.3.3.cmml">1</mn></mrow><mi id="S3.E6.m1.3.3.3.3.4.2.3" xref="S3.E6.m1.3.3.3.3.4.2.3.cmml">H</mi></munderover><mrow id="S3.E6.m1.3.3.3.3.3" xref="S3.E6.m1.3.3.3.3.3.cmml"><munderover id="S3.E6.m1.3.3.3.3.3.4" xref="S3.E6.m1.3.3.3.3.3.4.cmml"><mo movablelimits="false" rspace="0em" id="S3.E6.m1.3.3.3.3.3.4.2.2" xref="S3.E6.m1.3.3.3.3.3.4.2.2.cmml">∑</mo><mrow id="S3.E6.m1.3.3.3.3.3.4.3" xref="S3.E6.m1.3.3.3.3.3.4.3.cmml"><mi id="S3.E6.m1.3.3.3.3.3.4.3.2" xref="S3.E6.m1.3.3.3.3.3.4.3.2.cmml">j</mi><mo id="S3.E6.m1.3.3.3.3.3.4.3.1" xref="S3.E6.m1.3.3.3.3.3.4.3.1.cmml">=</mo><mn id="S3.E6.m1.3.3.3.3.3.4.3.3" xref="S3.E6.m1.3.3.3.3.3.4.3.3.cmml">1</mn></mrow><mi id="S3.E6.m1.3.3.3.3.3.4.2.3" xref="S3.E6.m1.3.3.3.3.3.4.2.3.cmml">W</mi></munderover><mrow id="S3.E6.m1.3.3.3.3.3.3" xref="S3.E6.m1.3.3.3.3.3.3.cmml"><mrow id="S3.E6.m1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mn id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">β</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><msubsup id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.cmml">ω</mi><mrow id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.3.cmml">j</mi></mrow><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.3.cmml">s</mi></msubsup></mrow></mrow><mo rspace="0.055em" stretchy="false" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S3.E6.m1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.1.2.cmml">⋅</mo><msub id="S3.E6.m1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.3.cmml"><mi mathvariant="normal" id="S3.E6.m1.1.1.1.1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.1.1.1.1.3.2.cmml">ℓ</mi><mrow id="S3.E6.m1.1.1.1.1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.3.3.2" xref="S3.E6.m1.1.1.1.1.1.1.1.3.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.1.1.1.3.3.1" xref="S3.E6.m1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E6.m1.1.1.1.1.1.1.1.3.3.3" xref="S3.E6.m1.1.1.1.1.1.1.1.3.3.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.1.1.1.3.3.1a" xref="S3.E6.m1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E6.m1.1.1.1.1.1.1.1.3.3.4" xref="S3.E6.m1.1.1.1.1.1.1.1.3.3.4.cmml">e</mi></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.3.3.3.3.4" xref="S3.E6.m1.3.3.3.3.3.3.4.cmml">​</mo><mrow id="S3.E6.m1.3.3.3.3.3.3.3.2" xref="S3.E6.m1.3.3.3.3.3.3.3.3.cmml"><mo stretchy="false" id="S3.E6.m1.3.3.3.3.3.3.3.2.3" xref="S3.E6.m1.3.3.3.3.3.3.3.3.cmml">(</mo><msubsup id="S3.E6.m1.2.2.2.2.2.2.2.1.1" xref="S3.E6.m1.2.2.2.2.2.2.2.1.1.cmml"><mi id="S3.E6.m1.2.2.2.2.2.2.2.1.1.2.2" xref="S3.E6.m1.2.2.2.2.2.2.2.1.1.2.2.cmml">G</mi><mrow id="S3.E6.m1.2.2.2.2.2.2.2.1.1.3" xref="S3.E6.m1.2.2.2.2.2.2.2.1.1.3.cmml"><mi id="S3.E6.m1.2.2.2.2.2.2.2.1.1.3.2" xref="S3.E6.m1.2.2.2.2.2.2.2.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.2.2.2.2.2.1.1.3.1" xref="S3.E6.m1.2.2.2.2.2.2.2.1.1.3.1.cmml">​</mo><mi id="S3.E6.m1.2.2.2.2.2.2.2.1.1.3.3" xref="S3.E6.m1.2.2.2.2.2.2.2.1.1.3.3.cmml">j</mi></mrow><mi id="S3.E6.m1.2.2.2.2.2.2.2.1.1.2.3" xref="S3.E6.m1.2.2.2.2.2.2.2.1.1.2.3.cmml">a</mi></msubsup><mo id="S3.E6.m1.3.3.3.3.3.3.3.2.4" xref="S3.E6.m1.3.3.3.3.3.3.3.3.cmml">,</mo><mmultiscripts id="S3.E6.m1.3.3.3.3.3.3.3.2.2" xref="S3.E6.m1.3.3.3.3.3.3.3.2.2.cmml"><mi mathvariant="normal" id="S3.E6.m1.3.3.3.3.3.3.3.2.2.2.2" xref="S3.E6.m1.3.3.3.3.3.3.3.2.2.2.2.cmml">P</mi><mrow id="S3.E6.m1.3.3.3.3.3.3.3.2.2a" xref="S3.E6.m1.3.3.3.3.3.3.3.2.2.cmml"></mrow><mi mathvariant="normal" id="S3.E6.m1.3.3.3.3.3.3.3.2.2.2.3" xref="S3.E6.m1.3.3.3.3.3.3.3.2.2.2.3.cmml">s</mi><mrow id="S3.E6.m1.3.3.3.3.3.3.3.2.2.3" xref="S3.E6.m1.3.3.3.3.3.3.3.2.2.3.cmml"><mi id="S3.E6.m1.3.3.3.3.3.3.3.2.2.3.2" xref="S3.E6.m1.3.3.3.3.3.3.3.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.3.3.3.3.3.2.2.3.1" xref="S3.E6.m1.3.3.3.3.3.3.3.2.2.3.1.cmml">​</mo><mi id="S3.E6.m1.3.3.3.3.3.3.3.2.2.3.3" xref="S3.E6.m1.3.3.3.3.3.3.3.2.2.3.3.cmml">j</mi></mrow><mrow id="S3.E6.m1.3.3.3.3.3.3.3.2.2b" xref="S3.E6.m1.3.3.3.3.3.3.3.2.2.cmml"></mrow></mmultiscripts><mo stretchy="false" id="S3.E6.m1.3.3.3.3.3.3.3.2.5" xref="S3.E6.m1.3.3.3.3.3.3.3.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mrow id="S3.E6.m1.4.4.4" xref="S3.E6.m1.4.4.4.cmml"><munderover id="S3.E6.m1.4.4.4.2" xref="S3.E6.m1.4.4.4.2.cmml"><mo movablelimits="false" id="S3.E6.m1.4.4.4.2.2.2" xref="S3.E6.m1.4.4.4.2.2.2.cmml">∑</mo><mrow id="S3.E6.m1.4.4.4.2.3" xref="S3.E6.m1.4.4.4.2.3.cmml"><mi id="S3.E6.m1.4.4.4.2.3.2" xref="S3.E6.m1.4.4.4.2.3.2.cmml">s</mi><mo id="S3.E6.m1.4.4.4.2.3.1" xref="S3.E6.m1.4.4.4.2.3.1.cmml">=</mo><mn id="S3.E6.m1.4.4.4.2.3.3" xref="S3.E6.m1.4.4.4.2.3.3.cmml">1</mn></mrow><mn id="S3.E6.m1.4.4.4.2.2.3" xref="S3.E6.m1.4.4.4.2.2.3.cmml">4</mn></munderover><mrow id="S3.E6.m1.4.4.4.1" xref="S3.E6.m1.4.4.4.1.cmml"><munderover id="S3.E6.m1.4.4.4.1.2" xref="S3.E6.m1.4.4.4.1.2.cmml"><mo lspace="0.167em" movablelimits="false" rspace="0em" id="S3.E6.m1.4.4.4.1.2.2.2" xref="S3.E6.m1.4.4.4.1.2.2.2.cmml">∑</mo><mrow id="S3.E6.m1.4.4.4.1.2.3" xref="S3.E6.m1.4.4.4.1.2.3.cmml"><mi id="S3.E6.m1.4.4.4.1.2.3.2" xref="S3.E6.m1.4.4.4.1.2.3.2.cmml">i</mi><mo id="S3.E6.m1.4.4.4.1.2.3.1" xref="S3.E6.m1.4.4.4.1.2.3.1.cmml">=</mo><mn id="S3.E6.m1.4.4.4.1.2.3.3" xref="S3.E6.m1.4.4.4.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E6.m1.4.4.4.1.2.2.3" xref="S3.E6.m1.4.4.4.1.2.2.3.cmml">H</mi></munderover><mrow id="S3.E6.m1.4.4.4.1.1" xref="S3.E6.m1.4.4.4.1.1.cmml"><munderover id="S3.E6.m1.4.4.4.1.1.2" xref="S3.E6.m1.4.4.4.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S3.E6.m1.4.4.4.1.1.2.2.2" xref="S3.E6.m1.4.4.4.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E6.m1.4.4.4.1.1.2.3" xref="S3.E6.m1.4.4.4.1.1.2.3.cmml"><mi id="S3.E6.m1.4.4.4.1.1.2.3.2" xref="S3.E6.m1.4.4.4.1.1.2.3.2.cmml">j</mi><mo id="S3.E6.m1.4.4.4.1.1.2.3.1" xref="S3.E6.m1.4.4.4.1.1.2.3.1.cmml">=</mo><mn id="S3.E6.m1.4.4.4.1.1.2.3.3" xref="S3.E6.m1.4.4.4.1.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E6.m1.4.4.4.1.1.2.2.3" xref="S3.E6.m1.4.4.4.1.1.2.2.3.cmml">W</mi></munderover><mrow id="S3.E6.m1.4.4.4.1.1.1.1" xref="S3.E6.m1.4.4.4.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.4.4.4.1.1.1.1.2" xref="S3.E6.m1.4.4.4.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.4.4.4.1.1.1.1.1" xref="S3.E6.m1.4.4.4.1.1.1.1.1.cmml"><mn id="S3.E6.m1.4.4.4.1.1.1.1.1.2" xref="S3.E6.m1.4.4.4.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E6.m1.4.4.4.1.1.1.1.1.1" xref="S3.E6.m1.4.4.4.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.E6.m1.4.4.4.1.1.1.1.1.3" xref="S3.E6.m1.4.4.4.1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.4.4.4.1.1.1.1.1.3.2" xref="S3.E6.m1.4.4.4.1.1.1.1.1.3.2.cmml">β</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.4.4.4.1.1.1.1.1.3.1" xref="S3.E6.m1.4.4.4.1.1.1.1.1.3.1.cmml">​</mo><msubsup id="S3.E6.m1.4.4.4.1.1.1.1.1.3.3" xref="S3.E6.m1.4.4.4.1.1.1.1.1.3.3.cmml"><mi id="S3.E6.m1.4.4.4.1.1.1.1.1.3.3.2.2" xref="S3.E6.m1.4.4.4.1.1.1.1.1.3.3.2.2.cmml">ω</mi><mrow id="S3.E6.m1.4.4.4.1.1.1.1.1.3.3.3" xref="S3.E6.m1.4.4.4.1.1.1.1.1.3.3.3.cmml"><mi id="S3.E6.m1.4.4.4.1.1.1.1.1.3.3.3.2" xref="S3.E6.m1.4.4.4.1.1.1.1.1.3.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.4.4.4.1.1.1.1.1.3.3.3.1" xref="S3.E6.m1.4.4.4.1.1.1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E6.m1.4.4.4.1.1.1.1.1.3.3.3.3" xref="S3.E6.m1.4.4.4.1.1.1.1.1.3.3.3.3.cmml">j</mi></mrow><mi id="S3.E6.m1.4.4.4.1.1.1.1.1.3.3.2.3" xref="S3.E6.m1.4.4.4.1.1.1.1.1.3.3.2.3.cmml">s</mi></msubsup></mrow></mrow><mo stretchy="false" id="S3.E6.m1.4.4.4.1.1.1.1.3" xref="S3.E6.m1.4.4.4.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mfrac></mrow></mrow><mo id="S3.E6.m1.5.5.1.2" xref="S3.E6.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.5b"><apply id="S3.E6.m1.5.5.1.1.cmml" xref="S3.E6.m1.5.5.1"><eq id="S3.E6.m1.5.5.1.1.1.cmml" xref="S3.E6.m1.5.5.1.1.1"></eq><apply id="S3.E6.m1.5.5.1.1.2.cmml" xref="S3.E6.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.1.1.2.1.cmml" xref="S3.E6.m1.5.5.1.1.2">subscript</csymbol><ci id="S3.E6.m1.5.5.1.1.2.2.cmml" xref="S3.E6.m1.5.5.1.1.2.2">ℒ</ci><apply id="S3.E6.m1.5.5.1.1.2.3.cmml" xref="S3.E6.m1.5.5.1.1.2.3"><times id="S3.E6.m1.5.5.1.1.2.3.1.cmml" xref="S3.E6.m1.5.5.1.1.2.3.1"></times><ci id="S3.E6.m1.5.5.1.1.2.3.2.cmml" xref="S3.E6.m1.5.5.1.1.2.3.2">𝑆</ci><ci id="S3.E6.m1.5.5.1.1.2.3.3.cmml" xref="S3.E6.m1.5.5.1.1.2.3.3">𝐴</ci><ci id="S3.E6.m1.5.5.1.1.2.3.4.cmml" xref="S3.E6.m1.5.5.1.1.2.3.4">𝐿</ci></apply></apply><apply id="S3.E6.m1.5.5.1.1.3.cmml" xref="S3.E6.m1.5.5.1.1.3"><minus id="S3.E6.m1.5.5.1.1.3.1.cmml" xref="S3.E6.m1.5.5.1.1.3"></minus><apply id="S3.E6.m1.4.4.cmml" xref="S3.E6.m1.4.4"><divide id="S3.E6.m1.4.4.5.cmml" xref="S3.E6.m1.4.4"></divide><apply id="S3.E6.m1.3.3.3.cmml" xref="S3.E6.m1.3.3.3"><apply id="S3.E6.m1.3.3.3.4.cmml" xref="S3.E6.m1.3.3.3.4"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.3.4.1.cmml" xref="S3.E6.m1.3.3.3.4">subscript</csymbol><apply id="S3.E6.m1.3.3.3.4.2.cmml" xref="S3.E6.m1.3.3.3.4"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.3.4.2.1.cmml" xref="S3.E6.m1.3.3.3.4">superscript</csymbol><sum id="S3.E6.m1.3.3.3.4.2.2.cmml" xref="S3.E6.m1.3.3.3.4.2.2"></sum><cn type="integer" id="S3.E6.m1.3.3.3.4.2.3.cmml" xref="S3.E6.m1.3.3.3.4.2.3">4</cn></apply><apply id="S3.E6.m1.3.3.3.4.3.cmml" xref="S3.E6.m1.3.3.3.4.3"><eq id="S3.E6.m1.3.3.3.4.3.1.cmml" xref="S3.E6.m1.3.3.3.4.3.1"></eq><ci id="S3.E6.m1.3.3.3.4.3.2.cmml" xref="S3.E6.m1.3.3.3.4.3.2">𝑠</ci><cn type="integer" id="S3.E6.m1.3.3.3.4.3.3.cmml" xref="S3.E6.m1.3.3.3.4.3.3">1</cn></apply></apply><apply id="S3.E6.m1.3.3.3.3.cmml" xref="S3.E6.m1.3.3.3.3"><apply id="S3.E6.m1.3.3.3.3.4.cmml" xref="S3.E6.m1.3.3.3.3.4"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.3.3.4.1.cmml" xref="S3.E6.m1.3.3.3.3.4">subscript</csymbol><apply id="S3.E6.m1.3.3.3.3.4.2.cmml" xref="S3.E6.m1.3.3.3.3.4"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.3.3.4.2.1.cmml" xref="S3.E6.m1.3.3.3.3.4">superscript</csymbol><sum id="S3.E6.m1.3.3.3.3.4.2.2.cmml" xref="S3.E6.m1.3.3.3.3.4.2.2"></sum><ci id="S3.E6.m1.3.3.3.3.4.2.3.cmml" xref="S3.E6.m1.3.3.3.3.4.2.3">𝐻</ci></apply><apply id="S3.E6.m1.3.3.3.3.4.3.cmml" xref="S3.E6.m1.3.3.3.3.4.3"><eq id="S3.E6.m1.3.3.3.3.4.3.1.cmml" xref="S3.E6.m1.3.3.3.3.4.3.1"></eq><ci id="S3.E6.m1.3.3.3.3.4.3.2.cmml" xref="S3.E6.m1.3.3.3.3.4.3.2">𝑖</ci><cn type="integer" id="S3.E6.m1.3.3.3.3.4.3.3.cmml" xref="S3.E6.m1.3.3.3.3.4.3.3">1</cn></apply></apply><apply id="S3.E6.m1.3.3.3.3.3.cmml" xref="S3.E6.m1.3.3.3.3.3"><apply id="S3.E6.m1.3.3.3.3.3.4.cmml" xref="S3.E6.m1.3.3.3.3.3.4"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.3.3.3.4.1.cmml" xref="S3.E6.m1.3.3.3.3.3.4">subscript</csymbol><apply id="S3.E6.m1.3.3.3.3.3.4.2.cmml" xref="S3.E6.m1.3.3.3.3.3.4"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.3.3.3.4.2.1.cmml" xref="S3.E6.m1.3.3.3.3.3.4">superscript</csymbol><sum id="S3.E6.m1.3.3.3.3.3.4.2.2.cmml" xref="S3.E6.m1.3.3.3.3.3.4.2.2"></sum><ci id="S3.E6.m1.3.3.3.3.3.4.2.3.cmml" xref="S3.E6.m1.3.3.3.3.3.4.2.3">𝑊</ci></apply><apply id="S3.E6.m1.3.3.3.3.3.4.3.cmml" xref="S3.E6.m1.3.3.3.3.3.4.3"><eq id="S3.E6.m1.3.3.3.3.3.4.3.1.cmml" xref="S3.E6.m1.3.3.3.3.3.4.3.1"></eq><ci id="S3.E6.m1.3.3.3.3.3.4.3.2.cmml" xref="S3.E6.m1.3.3.3.3.3.4.3.2">𝑗</ci><cn type="integer" id="S3.E6.m1.3.3.3.3.3.4.3.3.cmml" xref="S3.E6.m1.3.3.3.3.3.4.3.3">1</cn></apply></apply><apply id="S3.E6.m1.3.3.3.3.3.3.cmml" xref="S3.E6.m1.3.3.3.3.3.3"><times id="S3.E6.m1.3.3.3.3.3.3.4.cmml" xref="S3.E6.m1.3.3.3.3.3.3.4"></times><apply id="S3.E6.m1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1"><ci id="S3.E6.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.2">⋅</ci><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1"><plus id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1"></plus><cn type="integer" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.2">1</cn><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3"><times id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.2">𝛽</ci><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.3">superscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.2">𝜔</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.3">𝑠</ci></apply><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.3.3"><times id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.1"></times><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.2">𝑖</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.3">𝑗</ci></apply></apply></apply></apply><apply id="S3.E6.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.3.2">ℓ</ci><apply id="S3.E6.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.3.3"><times id="S3.E6.m1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.3.3.1"></times><ci id="S3.E6.m1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.3.3.2">𝑏</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.3.3.3">𝑐</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.3.3.4.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.3.3.4">𝑒</ci></apply></apply></apply><interval closure="open" id="S3.E6.m1.3.3.3.3.3.3.3.3.cmml" xref="S3.E6.m1.3.3.3.3.3.3.3.2"><apply id="S3.E6.m1.2.2.2.2.2.2.2.1.1.cmml" xref="S3.E6.m1.2.2.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.2.2.2.2.2.1.1.1.cmml" xref="S3.E6.m1.2.2.2.2.2.2.2.1.1">subscript</csymbol><apply id="S3.E6.m1.2.2.2.2.2.2.2.1.1.2.cmml" xref="S3.E6.m1.2.2.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.2.2.2.2.2.1.1.2.1.cmml" xref="S3.E6.m1.2.2.2.2.2.2.2.1.1">superscript</csymbol><ci id="S3.E6.m1.2.2.2.2.2.2.2.1.1.2.2.cmml" xref="S3.E6.m1.2.2.2.2.2.2.2.1.1.2.2">𝐺</ci><ci id="S3.E6.m1.2.2.2.2.2.2.2.1.1.2.3.cmml" xref="S3.E6.m1.2.2.2.2.2.2.2.1.1.2.3">𝑎</ci></apply><apply id="S3.E6.m1.2.2.2.2.2.2.2.1.1.3.cmml" xref="S3.E6.m1.2.2.2.2.2.2.2.1.1.3"><times id="S3.E6.m1.2.2.2.2.2.2.2.1.1.3.1.cmml" xref="S3.E6.m1.2.2.2.2.2.2.2.1.1.3.1"></times><ci id="S3.E6.m1.2.2.2.2.2.2.2.1.1.3.2.cmml" xref="S3.E6.m1.2.2.2.2.2.2.2.1.1.3.2">𝑖</ci><ci id="S3.E6.m1.2.2.2.2.2.2.2.1.1.3.3.cmml" xref="S3.E6.m1.2.2.2.2.2.2.2.1.1.3.3">𝑗</ci></apply></apply><apply id="S3.E6.m1.3.3.3.3.3.3.3.2.2.cmml" xref="S3.E6.m1.3.3.3.3.3.3.3.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.3.3.3.3.3.2.2.1.cmml" xref="S3.E6.m1.3.3.3.3.3.3.3.2.2">subscript</csymbol><apply id="S3.E6.m1.3.3.3.3.3.3.3.2.2.2.cmml" xref="S3.E6.m1.3.3.3.3.3.3.3.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.3.3.3.3.3.2.2.2.1.cmml" xref="S3.E6.m1.3.3.3.3.3.3.3.2.2">superscript</csymbol><ci id="S3.E6.m1.3.3.3.3.3.3.3.2.2.2.2.cmml" xref="S3.E6.m1.3.3.3.3.3.3.3.2.2.2.2">P</ci><ci id="S3.E6.m1.3.3.3.3.3.3.3.2.2.2.3.cmml" xref="S3.E6.m1.3.3.3.3.3.3.3.2.2.2.3">s</ci></apply><apply id="S3.E6.m1.3.3.3.3.3.3.3.2.2.3.cmml" xref="S3.E6.m1.3.3.3.3.3.3.3.2.2.3"><times id="S3.E6.m1.3.3.3.3.3.3.3.2.2.3.1.cmml" xref="S3.E6.m1.3.3.3.3.3.3.3.2.2.3.1"></times><ci id="S3.E6.m1.3.3.3.3.3.3.3.2.2.3.2.cmml" xref="S3.E6.m1.3.3.3.3.3.3.3.2.2.3.2">𝑖</ci><ci id="S3.E6.m1.3.3.3.3.3.3.3.2.2.3.3.cmml" xref="S3.E6.m1.3.3.3.3.3.3.3.2.2.3.3">𝑗</ci></apply></apply></interval></apply></apply></apply></apply><apply id="S3.E6.m1.4.4.4.cmml" xref="S3.E6.m1.4.4.4"><apply id="S3.E6.m1.4.4.4.2.cmml" xref="S3.E6.m1.4.4.4.2"><csymbol cd="ambiguous" id="S3.E6.m1.4.4.4.2.1.cmml" xref="S3.E6.m1.4.4.4.2">subscript</csymbol><apply id="S3.E6.m1.4.4.4.2.2.cmml" xref="S3.E6.m1.4.4.4.2"><csymbol cd="ambiguous" id="S3.E6.m1.4.4.4.2.2.1.cmml" xref="S3.E6.m1.4.4.4.2">superscript</csymbol><sum id="S3.E6.m1.4.4.4.2.2.2.cmml" xref="S3.E6.m1.4.4.4.2.2.2"></sum><cn type="integer" id="S3.E6.m1.4.4.4.2.2.3.cmml" xref="S3.E6.m1.4.4.4.2.2.3">4</cn></apply><apply id="S3.E6.m1.4.4.4.2.3.cmml" xref="S3.E6.m1.4.4.4.2.3"><eq id="S3.E6.m1.4.4.4.2.3.1.cmml" xref="S3.E6.m1.4.4.4.2.3.1"></eq><ci id="S3.E6.m1.4.4.4.2.3.2.cmml" xref="S3.E6.m1.4.4.4.2.3.2">𝑠</ci><cn type="integer" id="S3.E6.m1.4.4.4.2.3.3.cmml" xref="S3.E6.m1.4.4.4.2.3.3">1</cn></apply></apply><apply id="S3.E6.m1.4.4.4.1.cmml" xref="S3.E6.m1.4.4.4.1"><apply id="S3.E6.m1.4.4.4.1.2.cmml" xref="S3.E6.m1.4.4.4.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.4.4.4.1.2.1.cmml" xref="S3.E6.m1.4.4.4.1.2">subscript</csymbol><apply id="S3.E6.m1.4.4.4.1.2.2.cmml" xref="S3.E6.m1.4.4.4.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.4.4.4.1.2.2.1.cmml" xref="S3.E6.m1.4.4.4.1.2">superscript</csymbol><sum id="S3.E6.m1.4.4.4.1.2.2.2.cmml" xref="S3.E6.m1.4.4.4.1.2.2.2"></sum><ci id="S3.E6.m1.4.4.4.1.2.2.3.cmml" xref="S3.E6.m1.4.4.4.1.2.2.3">𝐻</ci></apply><apply id="S3.E6.m1.4.4.4.1.2.3.cmml" xref="S3.E6.m1.4.4.4.1.2.3"><eq id="S3.E6.m1.4.4.4.1.2.3.1.cmml" xref="S3.E6.m1.4.4.4.1.2.3.1"></eq><ci id="S3.E6.m1.4.4.4.1.2.3.2.cmml" xref="S3.E6.m1.4.4.4.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E6.m1.4.4.4.1.2.3.3.cmml" xref="S3.E6.m1.4.4.4.1.2.3.3">1</cn></apply></apply><apply id="S3.E6.m1.4.4.4.1.1.cmml" xref="S3.E6.m1.4.4.4.1.1"><apply id="S3.E6.m1.4.4.4.1.1.2.cmml" xref="S3.E6.m1.4.4.4.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.4.4.4.1.1.2.1.cmml" xref="S3.E6.m1.4.4.4.1.1.2">subscript</csymbol><apply id="S3.E6.m1.4.4.4.1.1.2.2.cmml" xref="S3.E6.m1.4.4.4.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.4.4.4.1.1.2.2.1.cmml" xref="S3.E6.m1.4.4.4.1.1.2">superscript</csymbol><sum id="S3.E6.m1.4.4.4.1.1.2.2.2.cmml" xref="S3.E6.m1.4.4.4.1.1.2.2.2"></sum><ci id="S3.E6.m1.4.4.4.1.1.2.2.3.cmml" xref="S3.E6.m1.4.4.4.1.1.2.2.3">𝑊</ci></apply><apply id="S3.E6.m1.4.4.4.1.1.2.3.cmml" xref="S3.E6.m1.4.4.4.1.1.2.3"><eq id="S3.E6.m1.4.4.4.1.1.2.3.1.cmml" xref="S3.E6.m1.4.4.4.1.1.2.3.1"></eq><ci id="S3.E6.m1.4.4.4.1.1.2.3.2.cmml" xref="S3.E6.m1.4.4.4.1.1.2.3.2">𝑗</ci><cn type="integer" id="S3.E6.m1.4.4.4.1.1.2.3.3.cmml" xref="S3.E6.m1.4.4.4.1.1.2.3.3">1</cn></apply></apply><apply id="S3.E6.m1.4.4.4.1.1.1.1.1.cmml" xref="S3.E6.m1.4.4.4.1.1.1.1"><plus id="S3.E6.m1.4.4.4.1.1.1.1.1.1.cmml" xref="S3.E6.m1.4.4.4.1.1.1.1.1.1"></plus><cn type="integer" id="S3.E6.m1.4.4.4.1.1.1.1.1.2.cmml" xref="S3.E6.m1.4.4.4.1.1.1.1.1.2">1</cn><apply id="S3.E6.m1.4.4.4.1.1.1.1.1.3.cmml" xref="S3.E6.m1.4.4.4.1.1.1.1.1.3"><times id="S3.E6.m1.4.4.4.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.4.4.4.1.1.1.1.1.3.1"></times><ci id="S3.E6.m1.4.4.4.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.4.4.4.1.1.1.1.1.3.2">𝛽</ci><apply id="S3.E6.m1.4.4.4.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.4.4.4.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.4.4.4.1.1.1.1.1.3.3.1.cmml" xref="S3.E6.m1.4.4.4.1.1.1.1.1.3.3">subscript</csymbol><apply id="S3.E6.m1.4.4.4.1.1.1.1.1.3.3.2.cmml" xref="S3.E6.m1.4.4.4.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.4.4.4.1.1.1.1.1.3.3.2.1.cmml" xref="S3.E6.m1.4.4.4.1.1.1.1.1.3.3">superscript</csymbol><ci id="S3.E6.m1.4.4.4.1.1.1.1.1.3.3.2.2.cmml" xref="S3.E6.m1.4.4.4.1.1.1.1.1.3.3.2.2">𝜔</ci><ci id="S3.E6.m1.4.4.4.1.1.1.1.1.3.3.2.3.cmml" xref="S3.E6.m1.4.4.4.1.1.1.1.1.3.3.2.3">𝑠</ci></apply><apply id="S3.E6.m1.4.4.4.1.1.1.1.1.3.3.3.cmml" xref="S3.E6.m1.4.4.4.1.1.1.1.1.3.3.3"><times id="S3.E6.m1.4.4.4.1.1.1.1.1.3.3.3.1.cmml" xref="S3.E6.m1.4.4.4.1.1.1.1.1.3.3.3.1"></times><ci id="S3.E6.m1.4.4.4.1.1.1.1.1.3.3.3.2.cmml" xref="S3.E6.m1.4.4.4.1.1.1.1.1.3.3.3.2">𝑖</ci><ci id="S3.E6.m1.4.4.4.1.1.1.1.1.3.3.3.3.cmml" xref="S3.E6.m1.4.4.4.1.1.1.1.1.3.3.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.5c">\mathcal{L}_{SAL}=-\frac{\sum\limits^{4}_{s=1}\sum\limits^{H}_{i=1}\sum\limits^{W}_{j=1}(1+\beta\omega^{s}_{ij})\cdot\ell_{bce}(G^{a}_{ij},{\mathrm{P^{s}}}_{ij})}{\sum\limits^{4}_{s=1}\sum\limits^{H}_{i=1}\sum\limits^{W}_{j=1}(1+\beta\omega^{s}_{ij})},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p3.7" class="ltx_p">where <math id="S3.SS4.p3.1.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S3.SS4.p3.1.m1.1a"><mi id="S3.SS4.p3.1.m1.1.1" xref="S3.SS4.p3.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.1.m1.1b"><ci id="S3.SS4.p3.1.m1.1.1.cmml" xref="S3.SS4.p3.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.1.m1.1c">\beta</annotation></semantics></math> is a hyperparameter to adjust the impact of the weight <math id="S3.SS4.p3.2.m2.1" class="ltx_Math" alttext="\omega^{s}_{ij}" display="inline"><semantics id="S3.SS4.p3.2.m2.1a"><msubsup id="S3.SS4.p3.2.m2.1.1" xref="S3.SS4.p3.2.m2.1.1.cmml"><mi id="S3.SS4.p3.2.m2.1.1.2.2" xref="S3.SS4.p3.2.m2.1.1.2.2.cmml">ω</mi><mrow id="S3.SS4.p3.2.m2.1.1.3" xref="S3.SS4.p3.2.m2.1.1.3.cmml"><mi id="S3.SS4.p3.2.m2.1.1.3.2" xref="S3.SS4.p3.2.m2.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p3.2.m2.1.1.3.1" xref="S3.SS4.p3.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p3.2.m2.1.1.3.3" xref="S3.SS4.p3.2.m2.1.1.3.3.cmml">j</mi></mrow><mi id="S3.SS4.p3.2.m2.1.1.2.3" xref="S3.SS4.p3.2.m2.1.1.2.3.cmml">s</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.2.m2.1b"><apply id="S3.SS4.p3.2.m2.1.1.cmml" xref="S3.SS4.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.2.m2.1.1.1.cmml" xref="S3.SS4.p3.2.m2.1.1">subscript</csymbol><apply id="S3.SS4.p3.2.m2.1.1.2.cmml" xref="S3.SS4.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.2.m2.1.1.2.1.cmml" xref="S3.SS4.p3.2.m2.1.1">superscript</csymbol><ci id="S3.SS4.p3.2.m2.1.1.2.2.cmml" xref="S3.SS4.p3.2.m2.1.1.2.2">𝜔</ci><ci id="S3.SS4.p3.2.m2.1.1.2.3.cmml" xref="S3.SS4.p3.2.m2.1.1.2.3">𝑠</ci></apply><apply id="S3.SS4.p3.2.m2.1.1.3.cmml" xref="S3.SS4.p3.2.m2.1.1.3"><times id="S3.SS4.p3.2.m2.1.1.3.1.cmml" xref="S3.SS4.p3.2.m2.1.1.3.1"></times><ci id="S3.SS4.p3.2.m2.1.1.3.2.cmml" xref="S3.SS4.p3.2.m2.1.1.3.2">𝑖</ci><ci id="S3.SS4.p3.2.m2.1.1.3.3.cmml" xref="S3.SS4.p3.2.m2.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.2.m2.1c">\omega^{s}_{ij}</annotation></semantics></math> and <math id="S3.SS4.p3.3.m3.1" class="ltx_Math" alttext="\ell_{bce}" display="inline"><semantics id="S3.SS4.p3.3.m3.1a"><msub id="S3.SS4.p3.3.m3.1.1" xref="S3.SS4.p3.3.m3.1.1.cmml"><mi mathvariant="normal" id="S3.SS4.p3.3.m3.1.1.2" xref="S3.SS4.p3.3.m3.1.1.2.cmml">ℓ</mi><mrow id="S3.SS4.p3.3.m3.1.1.3" xref="S3.SS4.p3.3.m3.1.1.3.cmml"><mi id="S3.SS4.p3.3.m3.1.1.3.2" xref="S3.SS4.p3.3.m3.1.1.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p3.3.m3.1.1.3.1" xref="S3.SS4.p3.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p3.3.m3.1.1.3.3" xref="S3.SS4.p3.3.m3.1.1.3.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p3.3.m3.1.1.3.1a" xref="S3.SS4.p3.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p3.3.m3.1.1.3.4" xref="S3.SS4.p3.3.m3.1.1.3.4.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.3.m3.1b"><apply id="S3.SS4.p3.3.m3.1.1.cmml" xref="S3.SS4.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.3.m3.1.1.1.cmml" xref="S3.SS4.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS4.p3.3.m3.1.1.2.cmml" xref="S3.SS4.p3.3.m3.1.1.2">ℓ</ci><apply id="S3.SS4.p3.3.m3.1.1.3.cmml" xref="S3.SS4.p3.3.m3.1.1.3"><times id="S3.SS4.p3.3.m3.1.1.3.1.cmml" xref="S3.SS4.p3.3.m3.1.1.3.1"></times><ci id="S3.SS4.p3.3.m3.1.1.3.2.cmml" xref="S3.SS4.p3.3.m3.1.1.3.2">𝑏</ci><ci id="S3.SS4.p3.3.m3.1.1.3.3.cmml" xref="S3.SS4.p3.3.m3.1.1.3.3">𝑐</ci><ci id="S3.SS4.p3.3.m3.1.1.3.4.cmml" xref="S3.SS4.p3.3.m3.1.1.3.4">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.3.m3.1c">\ell_{bce}</annotation></semantics></math> is the widely-used BCE loss, which is set to 2 in our experiment. <math id="S3.SS4.p3.4.m4.1" class="ltx_Math" alttext="G_{ij}" display="inline"><semantics id="S3.SS4.p3.4.m4.1a"><msub id="S3.SS4.p3.4.m4.1.1" xref="S3.SS4.p3.4.m4.1.1.cmml"><mi id="S3.SS4.p3.4.m4.1.1.2" xref="S3.SS4.p3.4.m4.1.1.2.cmml">G</mi><mrow id="S3.SS4.p3.4.m4.1.1.3" xref="S3.SS4.p3.4.m4.1.1.3.cmml"><mi id="S3.SS4.p3.4.m4.1.1.3.2" xref="S3.SS4.p3.4.m4.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p3.4.m4.1.1.3.1" xref="S3.SS4.p3.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p3.4.m4.1.1.3.3" xref="S3.SS4.p3.4.m4.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.4.m4.1b"><apply id="S3.SS4.p3.4.m4.1.1.cmml" xref="S3.SS4.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.4.m4.1.1.1.cmml" xref="S3.SS4.p3.4.m4.1.1">subscript</csymbol><ci id="S3.SS4.p3.4.m4.1.1.2.cmml" xref="S3.SS4.p3.4.m4.1.1.2">𝐺</ci><apply id="S3.SS4.p3.4.m4.1.1.3.cmml" xref="S3.SS4.p3.4.m4.1.1.3"><times id="S3.SS4.p3.4.m4.1.1.3.1.cmml" xref="S3.SS4.p3.4.m4.1.1.3.1"></times><ci id="S3.SS4.p3.4.m4.1.1.3.2.cmml" xref="S3.SS4.p3.4.m4.1.1.3.2">𝑖</ci><ci id="S3.SS4.p3.4.m4.1.1.3.3.cmml" xref="S3.SS4.p3.4.m4.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.4.m4.1c">G_{ij}</annotation></semantics></math> is the ground truth label of the pixel <math id="S3.SS4.p3.5.m5.2" class="ltx_Math" alttext="(i,j)" display="inline"><semantics id="S3.SS4.p3.5.m5.2a"><mrow id="S3.SS4.p3.5.m5.2.3.2" xref="S3.SS4.p3.5.m5.2.3.1.cmml"><mo stretchy="false" id="S3.SS4.p3.5.m5.2.3.2.1" xref="S3.SS4.p3.5.m5.2.3.1.cmml">(</mo><mi id="S3.SS4.p3.5.m5.1.1" xref="S3.SS4.p3.5.m5.1.1.cmml">i</mi><mo id="S3.SS4.p3.5.m5.2.3.2.2" xref="S3.SS4.p3.5.m5.2.3.1.cmml">,</mo><mi id="S3.SS4.p3.5.m5.2.2" xref="S3.SS4.p3.5.m5.2.2.cmml">j</mi><mo stretchy="false" id="S3.SS4.p3.5.m5.2.3.2.3" xref="S3.SS4.p3.5.m5.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.5.m5.2b"><interval closure="open" id="S3.SS4.p3.5.m5.2.3.1.cmml" xref="S3.SS4.p3.5.m5.2.3.2"><ci id="S3.SS4.p3.5.m5.1.1.cmml" xref="S3.SS4.p3.5.m5.1.1">𝑖</ci><ci id="S3.SS4.p3.5.m5.2.2.cmml" xref="S3.SS4.p3.5.m5.2.2">𝑗</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.5.m5.2c">(i,j)</annotation></semantics></math>, and <math id="S3.SS4.p3.6.m6.1" class="ltx_Math" alttext="P^{s}_{ij}" display="inline"><semantics id="S3.SS4.p3.6.m6.1a"><msubsup id="S3.SS4.p3.6.m6.1.1" xref="S3.SS4.p3.6.m6.1.1.cmml"><mi id="S3.SS4.p3.6.m6.1.1.2.2" xref="S3.SS4.p3.6.m6.1.1.2.2.cmml">P</mi><mrow id="S3.SS4.p3.6.m6.1.1.3" xref="S3.SS4.p3.6.m6.1.1.3.cmml"><mi id="S3.SS4.p3.6.m6.1.1.3.2" xref="S3.SS4.p3.6.m6.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p3.6.m6.1.1.3.1" xref="S3.SS4.p3.6.m6.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p3.6.m6.1.1.3.3" xref="S3.SS4.p3.6.m6.1.1.3.3.cmml">j</mi></mrow><mi id="S3.SS4.p3.6.m6.1.1.2.3" xref="S3.SS4.p3.6.m6.1.1.2.3.cmml">s</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.6.m6.1b"><apply id="S3.SS4.p3.6.m6.1.1.cmml" xref="S3.SS4.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.6.m6.1.1.1.cmml" xref="S3.SS4.p3.6.m6.1.1">subscript</csymbol><apply id="S3.SS4.p3.6.m6.1.1.2.cmml" xref="S3.SS4.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.6.m6.1.1.2.1.cmml" xref="S3.SS4.p3.6.m6.1.1">superscript</csymbol><ci id="S3.SS4.p3.6.m6.1.1.2.2.cmml" xref="S3.SS4.p3.6.m6.1.1.2.2">𝑃</ci><ci id="S3.SS4.p3.6.m6.1.1.2.3.cmml" xref="S3.SS4.p3.6.m6.1.1.2.3">𝑠</ci></apply><apply id="S3.SS4.p3.6.m6.1.1.3.cmml" xref="S3.SS4.p3.6.m6.1.1.3"><times id="S3.SS4.p3.6.m6.1.1.3.1.cmml" xref="S3.SS4.p3.6.m6.1.1.3.1"></times><ci id="S3.SS4.p3.6.m6.1.1.3.2.cmml" xref="S3.SS4.p3.6.m6.1.1.3.2">𝑖</ci><ci id="S3.SS4.p3.6.m6.1.1.3.3.cmml" xref="S3.SS4.p3.6.m6.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.6.m6.1c">P^{s}_{ij}</annotation></semantics></math> is the predicted probability by directly upsampling the enhanced features at the s-th layer of the ResNet. The weight <math id="S3.SS4.p3.7.m7.1" class="ltx_Math" alttext="\omega^{s}_{ij}" display="inline"><semantics id="S3.SS4.p3.7.m7.1a"><msubsup id="S3.SS4.p3.7.m7.1.1" xref="S3.SS4.p3.7.m7.1.1.cmml"><mi id="S3.SS4.p3.7.m7.1.1.2.2" xref="S3.SS4.p3.7.m7.1.1.2.2.cmml">ω</mi><mrow id="S3.SS4.p3.7.m7.1.1.3" xref="S3.SS4.p3.7.m7.1.1.3.cmml"><mi id="S3.SS4.p3.7.m7.1.1.3.2" xref="S3.SS4.p3.7.m7.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p3.7.m7.1.1.3.1" xref="S3.SS4.p3.7.m7.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p3.7.m7.1.1.3.3" xref="S3.SS4.p3.7.m7.1.1.3.3.cmml">j</mi></mrow><mi id="S3.SS4.p3.7.m7.1.1.2.3" xref="S3.SS4.p3.7.m7.1.1.2.3.cmml">s</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.7.m7.1b"><apply id="S3.SS4.p3.7.m7.1.1.cmml" xref="S3.SS4.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.7.m7.1.1.1.cmml" xref="S3.SS4.p3.7.m7.1.1">subscript</csymbol><apply id="S3.SS4.p3.7.m7.1.1.2.cmml" xref="S3.SS4.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.7.m7.1.1.2.1.cmml" xref="S3.SS4.p3.7.m7.1.1">superscript</csymbol><ci id="S3.SS4.p3.7.m7.1.1.2.2.cmml" xref="S3.SS4.p3.7.m7.1.1.2.2">𝜔</ci><ci id="S3.SS4.p3.7.m7.1.1.2.3.cmml" xref="S3.SS4.p3.7.m7.1.1.2.3">𝑠</ci></apply><apply id="S3.SS4.p3.7.m7.1.1.3.cmml" xref="S3.SS4.p3.7.m7.1.1.3"><times id="S3.SS4.p3.7.m7.1.1.3.1.cmml" xref="S3.SS4.p3.7.m7.1.1.3.1"></times><ci id="S3.SS4.p3.7.m7.1.1.3.2.cmml" xref="S3.SS4.p3.7.m7.1.1.3.2">𝑖</ci><ci id="S3.SS4.p3.7.m7.1.1.3.3.cmml" xref="S3.SS4.p3.7.m7.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.7.m7.1c">\omega^{s}_{ij}</annotation></semantics></math> can be calculated by:</p>
</div>
<div id="S3.SS4.p4" class="ltx_para">
<table id="S3.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E7.m1.1" class="ltx_Math" alttext="\small\omega^{s}_{ij}=Sigmoid(Upsampling(\mid B^{s}\mid))," display="block"><semantics id="S3.E7.m1.1a"><mrow id="S3.E7.m1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml"><mrow id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml"><msubsup id="S3.E7.m1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.3.cmml"><mi mathsize="90%" id="S3.E7.m1.1.1.1.1.3.2.2" xref="S3.E7.m1.1.1.1.1.3.2.2.cmml">ω</mi><mrow id="S3.E7.m1.1.1.1.1.3.3" xref="S3.E7.m1.1.1.1.1.3.3.cmml"><mi mathsize="90%" id="S3.E7.m1.1.1.1.1.3.3.2" xref="S3.E7.m1.1.1.1.1.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.3.3.1" xref="S3.E7.m1.1.1.1.1.3.3.1.cmml">​</mo><mi mathsize="90%" id="S3.E7.m1.1.1.1.1.3.3.3" xref="S3.E7.m1.1.1.1.1.3.3.3.cmml">j</mi></mrow><mi mathsize="90%" id="S3.E7.m1.1.1.1.1.3.2.3" xref="S3.E7.m1.1.1.1.1.3.2.3.cmml">s</mi></msubsup><mo mathsize="90%" id="S3.E7.m1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E7.m1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S3.E7.m1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.2.cmml">​</mo><mi mathsize="90%" id="S3.E7.m1.1.1.1.1.1.4" xref="S3.E7.m1.1.1.1.1.1.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.1.2a" xref="S3.E7.m1.1.1.1.1.1.2.cmml">​</mo><mi mathsize="90%" id="S3.E7.m1.1.1.1.1.1.5" xref="S3.E7.m1.1.1.1.1.1.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.1.2b" xref="S3.E7.m1.1.1.1.1.1.2.cmml">​</mo><mi mathsize="90%" id="S3.E7.m1.1.1.1.1.1.6" xref="S3.E7.m1.1.1.1.1.1.6.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.1.2c" xref="S3.E7.m1.1.1.1.1.1.2.cmml">​</mo><mi mathsize="90%" id="S3.E7.m1.1.1.1.1.1.7" xref="S3.E7.m1.1.1.1.1.1.7.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.1.2d" xref="S3.E7.m1.1.1.1.1.1.2.cmml">​</mo><mi mathsize="90%" id="S3.E7.m1.1.1.1.1.1.8" xref="S3.E7.m1.1.1.1.1.1.8.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.1.2e" xref="S3.E7.m1.1.1.1.1.1.2.cmml">​</mo><mi mathsize="90%" id="S3.E7.m1.1.1.1.1.1.9" xref="S3.E7.m1.1.1.1.1.1.9.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.1.2f" xref="S3.E7.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E7.m1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S3.E7.m1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S3.E7.m1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.3.cmml">U</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi mathsize="90%" id="S3.E7.m1.1.1.1.1.1.1.1.1.4" xref="S3.E7.m1.1.1.1.1.1.1.1.1.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.1.1.1.1.2a" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi mathsize="90%" id="S3.E7.m1.1.1.1.1.1.1.1.1.5" xref="S3.E7.m1.1.1.1.1.1.1.1.1.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.1.1.1.1.2b" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi mathsize="90%" id="S3.E7.m1.1.1.1.1.1.1.1.1.6" xref="S3.E7.m1.1.1.1.1.1.1.1.1.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.1.1.1.1.2c" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi mathsize="90%" id="S3.E7.m1.1.1.1.1.1.1.1.1.7" xref="S3.E7.m1.1.1.1.1.1.1.1.1.7.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.1.1.1.1.2d" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi mathsize="90%" id="S3.E7.m1.1.1.1.1.1.1.1.1.8" xref="S3.E7.m1.1.1.1.1.1.1.1.1.8.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.1.1.1.1.2e" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi mathsize="90%" id="S3.E7.m1.1.1.1.1.1.1.1.1.9" xref="S3.E7.m1.1.1.1.1.1.1.1.1.9.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.1.1.1.1.2f" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi mathsize="90%" id="S3.E7.m1.1.1.1.1.1.1.1.1.10" xref="S3.E7.m1.1.1.1.1.1.1.1.1.10.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.1.1.1.1.2g" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi mathsize="90%" id="S3.E7.m1.1.1.1.1.1.1.1.1.11" xref="S3.E7.m1.1.1.1.1.1.1.1.1.11.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.1.1.1.1.2h" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi mathsize="90%" id="S3.E7.m1.1.1.1.1.1.1.1.1.12" xref="S3.E7.m1.1.1.1.1.1.1.1.1.12.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.1.1.1.1.2i" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo fence="true" lspace="0em" mathsize="90%" rspace="0em" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">∣</mo><msup id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">B</mi><mi mathsize="90%" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">s</mi></msup><mo fence="true" lspace="0em" mathsize="90%" rspace="0em" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">∣</mo></mrow><mo maxsize="90%" minsize="90%" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo maxsize="90%" minsize="90%" id="S3.E7.m1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo mathsize="90%" id="S3.E7.m1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.1b"><apply id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1"><eq id="S3.E7.m1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.2"></eq><apply id="S3.E7.m1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.1.1.1.1.3">subscript</csymbol><apply id="S3.E7.m1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.3.2.1.cmml" xref="S3.E7.m1.1.1.1.1.3">superscript</csymbol><ci id="S3.E7.m1.1.1.1.1.3.2.2.cmml" xref="S3.E7.m1.1.1.1.1.3.2.2">𝜔</ci><ci id="S3.E7.m1.1.1.1.1.3.2.3.cmml" xref="S3.E7.m1.1.1.1.1.3.2.3">𝑠</ci></apply><apply id="S3.E7.m1.1.1.1.1.3.3.cmml" xref="S3.E7.m1.1.1.1.1.3.3"><times id="S3.E7.m1.1.1.1.1.3.3.1.cmml" xref="S3.E7.m1.1.1.1.1.3.3.1"></times><ci id="S3.E7.m1.1.1.1.1.3.3.2.cmml" xref="S3.E7.m1.1.1.1.1.3.3.2">𝑖</ci><ci id="S3.E7.m1.1.1.1.1.3.3.3.cmml" xref="S3.E7.m1.1.1.1.1.3.3.3">𝑗</ci></apply></apply><apply id="S3.E7.m1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1"><times id="S3.E7.m1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.2"></times><ci id="S3.E7.m1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.3">𝑆</ci><ci id="S3.E7.m1.1.1.1.1.1.4.cmml" xref="S3.E7.m1.1.1.1.1.1.4">𝑖</ci><ci id="S3.E7.m1.1.1.1.1.1.5.cmml" xref="S3.E7.m1.1.1.1.1.1.5">𝑔</ci><ci id="S3.E7.m1.1.1.1.1.1.6.cmml" xref="S3.E7.m1.1.1.1.1.1.6">𝑚</ci><ci id="S3.E7.m1.1.1.1.1.1.7.cmml" xref="S3.E7.m1.1.1.1.1.1.7">𝑜</ci><ci id="S3.E7.m1.1.1.1.1.1.8.cmml" xref="S3.E7.m1.1.1.1.1.1.8">𝑖</ci><ci id="S3.E7.m1.1.1.1.1.1.9.cmml" xref="S3.E7.m1.1.1.1.1.1.9">𝑑</ci><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1"><times id="S3.E7.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.3">𝑈</ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.4">𝑝</ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.5.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.5">𝑠</ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.6.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.6">𝑎</ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.7.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.7">𝑚</ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.8.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.8">𝑝</ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.9.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.9">𝑙</ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.10.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.10">𝑖</ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.11.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.11">𝑛</ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.12.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.12">𝑔</ci><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">delimited-∣∣</csymbol><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐵</ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑠</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.1c">\small\omega^{s}_{ij}=Sigmoid(Upsampling(\mid B^{s}\mid)),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p4.1" class="ltx_p">where <math id="S3.SS4.p4.1.m1.1" class="ltx_Math" alttext="B^{s}" display="inline"><semantics id="S3.SS4.p4.1.m1.1a"><msup id="S3.SS4.p4.1.m1.1.1" xref="S3.SS4.p4.1.m1.1.1.cmml"><mi id="S3.SS4.p4.1.m1.1.1.2" xref="S3.SS4.p4.1.m1.1.1.2.cmml">B</mi><mi id="S3.SS4.p4.1.m1.1.1.3" xref="S3.SS4.p4.1.m1.1.1.3.cmml">s</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.1.m1.1b"><apply id="S3.SS4.p4.1.m1.1.1.cmml" xref="S3.SS4.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.1.m1.1.1.1.cmml" xref="S3.SS4.p4.1.m1.1.1">superscript</csymbol><ci id="S3.SS4.p4.1.m1.1.1.2.cmml" xref="S3.SS4.p4.1.m1.1.1.2">𝐵</ci><ci id="S3.SS4.p4.1.m1.1.1.3.cmml" xref="S3.SS4.p4.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.1.m1.1c">B^{s}</annotation></semantics></math> is the s-th enhanced representation as described in <a href="#S3.F3" title="In 3.3 Cross-Model Querying ‣ 3 Methodology ‣ DQnet: Cross-Model Detail Querying for Camouflaged Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<div id="S3.SS4.p5" class="ltx_para">
<p id="S3.SS4.p5.1" class="ltx_p">What’s more, we also apply the weighted IoU loss to pay more attention to the global structure of the image as suggested by <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>.
In the end, our total loss can be expressed as follow:</p>
<table id="S3.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E8.m1.1" class="ltx_Math" alttext="\mathcal{L}_{total}=\mathcal{L}_{\text{BCE}}^{w}+\mathcal{L}_{\text{IoU}}^{w}+\mathcal{L}_{SAL}," display="block"><semantics id="S3.E8.m1.1a"><mrow id="S3.E8.m1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml"><mrow id="S3.E8.m1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml"><msub id="S3.E8.m1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.1.1.1.1.2.2" xref="S3.E8.m1.1.1.1.1.2.2.cmml">ℒ</mi><mrow id="S3.E8.m1.1.1.1.1.2.3" xref="S3.E8.m1.1.1.1.1.2.3.cmml"><mi id="S3.E8.m1.1.1.1.1.2.3.2" xref="S3.E8.m1.1.1.1.1.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.1.1.2.3.1" xref="S3.E8.m1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E8.m1.1.1.1.1.2.3.3" xref="S3.E8.m1.1.1.1.1.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.1.1.2.3.1a" xref="S3.E8.m1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E8.m1.1.1.1.1.2.3.4" xref="S3.E8.m1.1.1.1.1.2.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.1.1.2.3.1b" xref="S3.E8.m1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E8.m1.1.1.1.1.2.3.5" xref="S3.E8.m1.1.1.1.1.2.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.1.1.2.3.1c" xref="S3.E8.m1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E8.m1.1.1.1.1.2.3.6" xref="S3.E8.m1.1.1.1.1.2.3.6.cmml">l</mi></mrow></msub><mo id="S3.E8.m1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E8.m1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.3.cmml"><msubsup id="S3.E8.m1.1.1.1.1.3.2" xref="S3.E8.m1.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.1.1.1.1.3.2.2.2" xref="S3.E8.m1.1.1.1.1.3.2.2.2.cmml">ℒ</mi><mtext id="S3.E8.m1.1.1.1.1.3.2.2.3" xref="S3.E8.m1.1.1.1.1.3.2.2.3a.cmml">BCE</mtext><mi id="S3.E8.m1.1.1.1.1.3.2.3" xref="S3.E8.m1.1.1.1.1.3.2.3.cmml">w</mi></msubsup><mo id="S3.E8.m1.1.1.1.1.3.1" xref="S3.E8.m1.1.1.1.1.3.1.cmml">+</mo><msubsup id="S3.E8.m1.1.1.1.1.3.3" xref="S3.E8.m1.1.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.1.1.1.1.3.3.2.2" xref="S3.E8.m1.1.1.1.1.3.3.2.2.cmml">ℒ</mi><mtext id="S3.E8.m1.1.1.1.1.3.3.2.3" xref="S3.E8.m1.1.1.1.1.3.3.2.3a.cmml">IoU</mtext><mi id="S3.E8.m1.1.1.1.1.3.3.3" xref="S3.E8.m1.1.1.1.1.3.3.3.cmml">w</mi></msubsup><mo id="S3.E8.m1.1.1.1.1.3.1a" xref="S3.E8.m1.1.1.1.1.3.1.cmml">+</mo><msub id="S3.E8.m1.1.1.1.1.3.4" xref="S3.E8.m1.1.1.1.1.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.1.1.1.1.3.4.2" xref="S3.E8.m1.1.1.1.1.3.4.2.cmml">ℒ</mi><mrow id="S3.E8.m1.1.1.1.1.3.4.3" xref="S3.E8.m1.1.1.1.1.3.4.3.cmml"><mi id="S3.E8.m1.1.1.1.1.3.4.3.2" xref="S3.E8.m1.1.1.1.1.3.4.3.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.1.1.3.4.3.1" xref="S3.E8.m1.1.1.1.1.3.4.3.1.cmml">​</mo><mi id="S3.E8.m1.1.1.1.1.3.4.3.3" xref="S3.E8.m1.1.1.1.1.3.4.3.3.cmml">A</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.1.1.3.4.3.1a" xref="S3.E8.m1.1.1.1.1.3.4.3.1.cmml">​</mo><mi id="S3.E8.m1.1.1.1.1.3.4.3.4" xref="S3.E8.m1.1.1.1.1.3.4.3.4.cmml">L</mi></mrow></msub></mrow></mrow><mo id="S3.E8.m1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.1b"><apply id="S3.E8.m1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1"><eq id="S3.E8.m1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1"></eq><apply id="S3.E8.m1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2">ℒ</ci><apply id="S3.E8.m1.1.1.1.1.2.3.cmml" xref="S3.E8.m1.1.1.1.1.2.3"><times id="S3.E8.m1.1.1.1.1.2.3.1.cmml" xref="S3.E8.m1.1.1.1.1.2.3.1"></times><ci id="S3.E8.m1.1.1.1.1.2.3.2.cmml" xref="S3.E8.m1.1.1.1.1.2.3.2">𝑡</ci><ci id="S3.E8.m1.1.1.1.1.2.3.3.cmml" xref="S3.E8.m1.1.1.1.1.2.3.3">𝑜</ci><ci id="S3.E8.m1.1.1.1.1.2.3.4.cmml" xref="S3.E8.m1.1.1.1.1.2.3.4">𝑡</ci><ci id="S3.E8.m1.1.1.1.1.2.3.5.cmml" xref="S3.E8.m1.1.1.1.1.2.3.5">𝑎</ci><ci id="S3.E8.m1.1.1.1.1.2.3.6.cmml" xref="S3.E8.m1.1.1.1.1.2.3.6">𝑙</ci></apply></apply><apply id="S3.E8.m1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.3"><plus id="S3.E8.m1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.1.1.1.1.3.1"></plus><apply id="S3.E8.m1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.2.1.cmml" xref="S3.E8.m1.1.1.1.1.3.2">superscript</csymbol><apply id="S3.E8.m1.1.1.1.1.3.2.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.2.2.1.cmml" xref="S3.E8.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.3.2.2.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2.2.2">ℒ</ci><ci id="S3.E8.m1.1.1.1.1.3.2.2.3a.cmml" xref="S3.E8.m1.1.1.1.1.3.2.2.3"><mtext mathsize="70%" id="S3.E8.m1.1.1.1.1.3.2.2.3.cmml" xref="S3.E8.m1.1.1.1.1.3.2.2.3">BCE</mtext></ci></apply><ci id="S3.E8.m1.1.1.1.1.3.2.3.cmml" xref="S3.E8.m1.1.1.1.1.3.2.3">𝑤</ci></apply><apply id="S3.E8.m1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.3.1.cmml" xref="S3.E8.m1.1.1.1.1.3.3">superscript</csymbol><apply id="S3.E8.m1.1.1.1.1.3.3.2.cmml" xref="S3.E8.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.3.2.1.cmml" xref="S3.E8.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.3.3.2.2.cmml" xref="S3.E8.m1.1.1.1.1.3.3.2.2">ℒ</ci><ci id="S3.E8.m1.1.1.1.1.3.3.2.3a.cmml" xref="S3.E8.m1.1.1.1.1.3.3.2.3"><mtext mathsize="70%" id="S3.E8.m1.1.1.1.1.3.3.2.3.cmml" xref="S3.E8.m1.1.1.1.1.3.3.2.3">IoU</mtext></ci></apply><ci id="S3.E8.m1.1.1.1.1.3.3.3.cmml" xref="S3.E8.m1.1.1.1.1.3.3.3">𝑤</ci></apply><apply id="S3.E8.m1.1.1.1.1.3.4.cmml" xref="S3.E8.m1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.4.1.cmml" xref="S3.E8.m1.1.1.1.1.3.4">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.3.4.2.cmml" xref="S3.E8.m1.1.1.1.1.3.4.2">ℒ</ci><apply id="S3.E8.m1.1.1.1.1.3.4.3.cmml" xref="S3.E8.m1.1.1.1.1.3.4.3"><times id="S3.E8.m1.1.1.1.1.3.4.3.1.cmml" xref="S3.E8.m1.1.1.1.1.3.4.3.1"></times><ci id="S3.E8.m1.1.1.1.1.3.4.3.2.cmml" xref="S3.E8.m1.1.1.1.1.3.4.3.2">𝑆</ci><ci id="S3.E8.m1.1.1.1.1.3.4.3.3.cmml" xref="S3.E8.m1.1.1.1.1.3.4.3.3">𝐴</ci><ci id="S3.E8.m1.1.1.1.1.3.4.3.4.cmml" xref="S3.E8.m1.1.1.1.1.3.4.3.4">𝐿</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.1c">\mathcal{L}_{total}=\mathcal{L}_{\text{BCE}}^{w}+\mathcal{L}_{\text{IoU}}^{w}+\mathcal{L}_{SAL},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
<figure id="S3.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S3.T1.37.2.1" class="ltx_text" style="font-size:90%;">Table 1</span>: </span><span id="S3.T1.2.1" class="ltx_text" style="font-size:90%;">
Performance comparisons on common datasets.
The best (second best) results are highlighted in <span id="S3.T1.2.1.1" class="ltx_text" style="color:#D0104C;"> <span id="S3.T1.2.1.1.1" class="ltx_text ltx_font_bold">red</span></span> (<span id="S3.T1.2.1.2" class="ltx_text" style="color:#1E90FF;"> <span id="S3.T1.2.1.2.1" class="ltx_text ltx_font_bold">blue</span></span>).
<sup id="S3.T1.2.1.3" class="ltx_sup"><span id="S3.T1.2.1.3.1" class="ltx_text ltx_font_italic">⋆</span></sup>: Using extra data.
</span></figcaption>
<div id="S3.T1.32" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:136.7pt;vertical-align:-0.5pt;"><span class="ltx_transformed_inner" style="transform:translate(-184.3pt,57.9pt) scale(0.540506253057829,0.540506253057829) ;">
<table id="S3.T1.32.30" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T1.32.30.31.1" class="ltx_tr">
<th id="S3.T1.32.30.31.1.1" class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt"></th>
<th id="S3.T1.32.30.31.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" colspan="4"><span id="S3.T1.32.30.31.1.2.1" class="ltx_text ltx_font_bold" style="background-color:#CCCCCC;">CAMO</span></th>
<th id="S3.T1.32.30.31.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" colspan="4"><span id="S3.T1.32.30.31.1.3.1" class="ltx_text ltx_font_bold" style="background-color:#CCCCCC;">CHAMELEON</span></th>
<th id="S3.T1.32.30.31.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="4"><span id="S3.T1.32.30.31.1.4.1" class="ltx_text ltx_font_bold" style="background-color:#CCCCCC;">COD10K</span></th>
<th id="S3.T1.32.30.31.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="4"><span id="S3.T1.32.30.31.1.5.1" class="ltx_text ltx_font_bold" style="background-color:#CCCCCC;">NC4K</span></th>
</tr>
<tr id="S3.T1.30.28.28" class="ltx_tr" style="background-color:#CCCCCC;">
<th id="S3.T1.30.28.28.29" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r"><span id="S3.T1.30.28.28.29.1" class="ltx_text" style="background-color:#CCCCCC;">Model</span></th>
<th id="S3.T1.4.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S3.T1.4.2.2.2.2" class="ltx_text" style="background-color:#CCCCCC;">S<sub id="S3.T1.4.2.2.2.2.1" class="ltx_sub"><span id="S3.T1.4.2.2.2.2.1.1" class="ltx_text ltx_font_italic">m</span></sub> <math id="S3.T1.4.2.2.2.2.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S3.T1.4.2.2.2.2.m2.1a"><mo mathbackground="#CCCCCC" stretchy="false" id="S3.T1.4.2.2.2.2.m2.1.1" xref="S3.T1.4.2.2.2.2.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T1.4.2.2.2.2.m2.1b"><ci id="S3.T1.4.2.2.2.2.m2.1.1.cmml" xref="S3.T1.4.2.2.2.2.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.4.2.2.2.2.m2.1c">\uparrow</annotation></semantics></math></span></th>
<th id="S3.T1.6.4.4.4" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S3.T1.6.4.4.4.2" class="ltx_text" style="background-color:#CCCCCC;">F<math id="S3.T1.5.3.3.3.1.m1.1" class="ltx_Math" alttext="{}^{\omega}_{\beta}" display="inline"><semantics id="S3.T1.5.3.3.3.1.m1.1a"><mmultiscripts id="S3.T1.5.3.3.3.1.m1.1.1" xref="S3.T1.5.3.3.3.1.m1.1.1.cmml"><mi id="S3.T1.5.3.3.3.1.m1.1.1.2.2" xref="S3.T1.5.3.3.3.1.m1.1.1.2.2.cmml"></mi><mprescripts id="S3.T1.5.3.3.3.1.m1.1.1a" xref="S3.T1.5.3.3.3.1.m1.1.1.cmml"></mprescripts><mi mathbackground="#CCCCCC" id="S3.T1.5.3.3.3.1.m1.1.1.3" xref="S3.T1.5.3.3.3.1.m1.1.1.3.cmml">β</mi><mrow id="S3.T1.5.3.3.3.1.m1.1.1b" xref="S3.T1.5.3.3.3.1.m1.1.1.cmml"></mrow><mrow id="S3.T1.5.3.3.3.1.m1.1.1c" xref="S3.T1.5.3.3.3.1.m1.1.1.cmml"></mrow><mi mathbackground="#CCCCCC" id="S3.T1.5.3.3.3.1.m1.1.1.2.3" xref="S3.T1.5.3.3.3.1.m1.1.1.2.3.cmml">ω</mi></mmultiscripts><annotation-xml encoding="MathML-Content" id="S3.T1.5.3.3.3.1.m1.1b"><apply id="S3.T1.5.3.3.3.1.m1.1.1.cmml" xref="S3.T1.5.3.3.3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.5.3.3.3.1.m1.1.1.1.cmml" xref="S3.T1.5.3.3.3.1.m1.1.1">subscript</csymbol><apply id="S3.T1.5.3.3.3.1.m1.1.1.2.cmml" xref="S3.T1.5.3.3.3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.5.3.3.3.1.m1.1.1.2.1.cmml" xref="S3.T1.5.3.3.3.1.m1.1.1">superscript</csymbol><csymbol cd="latexml" id="S3.T1.5.3.3.3.1.m1.1.1.2.2.cmml" xref="S3.T1.5.3.3.3.1.m1.1.1.2.2">absent</csymbol><ci id="S3.T1.5.3.3.3.1.m1.1.1.2.3.cmml" xref="S3.T1.5.3.3.3.1.m1.1.1.2.3">𝜔</ci></apply><ci id="S3.T1.5.3.3.3.1.m1.1.1.3.cmml" xref="S3.T1.5.3.3.3.1.m1.1.1.3">𝛽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.5.3.3.3.1.m1.1c">{}^{\omega}_{\beta}</annotation></semantics></math> <math id="S3.T1.6.4.4.4.2.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S3.T1.6.4.4.4.2.m2.1a"><mo mathbackground="#CCCCCC" stretchy="false" id="S3.T1.6.4.4.4.2.m2.1.1" xref="S3.T1.6.4.4.4.2.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T1.6.4.4.4.2.m2.1b"><ci id="S3.T1.6.4.4.4.2.m2.1.1.cmml" xref="S3.T1.6.4.4.4.2.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.6.4.4.4.2.m2.1c">\uparrow</annotation></semantics></math></span></th>
<th id="S3.T1.7.5.5.5" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S3.T1.7.5.5.5.1" class="ltx_text" style="background-color:#CCCCCC;">MAE <math id="S3.T1.7.5.5.5.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S3.T1.7.5.5.5.1.m1.1a"><mo mathbackground="#CCCCCC" stretchy="false" id="S3.T1.7.5.5.5.1.m1.1.1" xref="S3.T1.7.5.5.5.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S3.T1.7.5.5.5.1.m1.1b"><ci id="S3.T1.7.5.5.5.1.m1.1.1.cmml" xref="S3.T1.7.5.5.5.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.7.5.5.5.1.m1.1c">\downarrow</annotation></semantics></math></span></th>
<th id="S3.T1.9.7.7.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r"><span id="S3.T1.9.7.7.7.2" class="ltx_text" style="background-color:#CCCCCC;">E<sub id="S3.T1.9.7.7.7.2.1" class="ltx_sub"><span id="S3.T1.9.7.7.7.2.1.1" class="ltx_text ltx_font_italic">m</span></sub> <math id="S3.T1.9.7.7.7.2.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S3.T1.9.7.7.7.2.m2.1a"><mo mathbackground="#CCCCCC" stretchy="false" id="S3.T1.9.7.7.7.2.m2.1.1" xref="S3.T1.9.7.7.7.2.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T1.9.7.7.7.2.m2.1b"><ci id="S3.T1.9.7.7.7.2.m2.1.1.cmml" xref="S3.T1.9.7.7.7.2.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.9.7.7.7.2.m2.1c">\uparrow</annotation></semantics></math></span></th>
<th id="S3.T1.11.9.9.9" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S3.T1.11.9.9.9.2" class="ltx_text" style="background-color:#CCCCCC;">S<sub id="S3.T1.11.9.9.9.2.1" class="ltx_sub"><span id="S3.T1.11.9.9.9.2.1.1" class="ltx_text ltx_font_italic">m</span></sub> <math id="S3.T1.11.9.9.9.2.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S3.T1.11.9.9.9.2.m2.1a"><mo mathbackground="#CCCCCC" stretchy="false" id="S3.T1.11.9.9.9.2.m2.1.1" xref="S3.T1.11.9.9.9.2.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T1.11.9.9.9.2.m2.1b"><ci id="S3.T1.11.9.9.9.2.m2.1.1.cmml" xref="S3.T1.11.9.9.9.2.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.11.9.9.9.2.m2.1c">\uparrow</annotation></semantics></math></span></th>
<th id="S3.T1.13.11.11.11" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S3.T1.13.11.11.11.2" class="ltx_text" style="background-color:#CCCCCC;">F<math id="S3.T1.12.10.10.10.1.m1.1" class="ltx_Math" alttext="{}^{\omega}_{\beta}" display="inline"><semantics id="S3.T1.12.10.10.10.1.m1.1a"><mmultiscripts id="S3.T1.12.10.10.10.1.m1.1.1" xref="S3.T1.12.10.10.10.1.m1.1.1.cmml"><mi id="S3.T1.12.10.10.10.1.m1.1.1.2.2" xref="S3.T1.12.10.10.10.1.m1.1.1.2.2.cmml"></mi><mprescripts id="S3.T1.12.10.10.10.1.m1.1.1a" xref="S3.T1.12.10.10.10.1.m1.1.1.cmml"></mprescripts><mi mathbackground="#CCCCCC" id="S3.T1.12.10.10.10.1.m1.1.1.3" xref="S3.T1.12.10.10.10.1.m1.1.1.3.cmml">β</mi><mrow id="S3.T1.12.10.10.10.1.m1.1.1b" xref="S3.T1.12.10.10.10.1.m1.1.1.cmml"></mrow><mrow id="S3.T1.12.10.10.10.1.m1.1.1c" xref="S3.T1.12.10.10.10.1.m1.1.1.cmml"></mrow><mi mathbackground="#CCCCCC" id="S3.T1.12.10.10.10.1.m1.1.1.2.3" xref="S3.T1.12.10.10.10.1.m1.1.1.2.3.cmml">ω</mi></mmultiscripts><annotation-xml encoding="MathML-Content" id="S3.T1.12.10.10.10.1.m1.1b"><apply id="S3.T1.12.10.10.10.1.m1.1.1.cmml" xref="S3.T1.12.10.10.10.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.12.10.10.10.1.m1.1.1.1.cmml" xref="S3.T1.12.10.10.10.1.m1.1.1">subscript</csymbol><apply id="S3.T1.12.10.10.10.1.m1.1.1.2.cmml" xref="S3.T1.12.10.10.10.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.12.10.10.10.1.m1.1.1.2.1.cmml" xref="S3.T1.12.10.10.10.1.m1.1.1">superscript</csymbol><csymbol cd="latexml" id="S3.T1.12.10.10.10.1.m1.1.1.2.2.cmml" xref="S3.T1.12.10.10.10.1.m1.1.1.2.2">absent</csymbol><ci id="S3.T1.12.10.10.10.1.m1.1.1.2.3.cmml" xref="S3.T1.12.10.10.10.1.m1.1.1.2.3">𝜔</ci></apply><ci id="S3.T1.12.10.10.10.1.m1.1.1.3.cmml" xref="S3.T1.12.10.10.10.1.m1.1.1.3">𝛽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.12.10.10.10.1.m1.1c">{}^{\omega}_{\beta}</annotation></semantics></math> <math id="S3.T1.13.11.11.11.2.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S3.T1.13.11.11.11.2.m2.1a"><mo mathbackground="#CCCCCC" stretchy="false" id="S3.T1.13.11.11.11.2.m2.1.1" xref="S3.T1.13.11.11.11.2.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T1.13.11.11.11.2.m2.1b"><ci id="S3.T1.13.11.11.11.2.m2.1.1.cmml" xref="S3.T1.13.11.11.11.2.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.13.11.11.11.2.m2.1c">\uparrow</annotation></semantics></math></span></th>
<th id="S3.T1.14.12.12.12" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S3.T1.14.12.12.12.1" class="ltx_text" style="background-color:#CCCCCC;">MAE <math id="S3.T1.14.12.12.12.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S3.T1.14.12.12.12.1.m1.1a"><mo mathbackground="#CCCCCC" stretchy="false" id="S3.T1.14.12.12.12.1.m1.1.1" xref="S3.T1.14.12.12.12.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S3.T1.14.12.12.12.1.m1.1b"><ci id="S3.T1.14.12.12.12.1.m1.1.1.cmml" xref="S3.T1.14.12.12.12.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.14.12.12.12.1.m1.1c">\downarrow</annotation></semantics></math></span></th>
<th id="S3.T1.16.14.14.14" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r"><span id="S3.T1.16.14.14.14.2" class="ltx_text" style="background-color:#CCCCCC;">E<sub id="S3.T1.16.14.14.14.2.1" class="ltx_sub"><span id="S3.T1.16.14.14.14.2.1.1" class="ltx_text ltx_font_italic">m</span></sub> <math id="S3.T1.16.14.14.14.2.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S3.T1.16.14.14.14.2.m2.1a"><mo mathbackground="#CCCCCC" stretchy="false" id="S3.T1.16.14.14.14.2.m2.1.1" xref="S3.T1.16.14.14.14.2.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T1.16.14.14.14.2.m2.1b"><ci id="S3.T1.16.14.14.14.2.m2.1.1.cmml" xref="S3.T1.16.14.14.14.2.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.16.14.14.14.2.m2.1c">\uparrow</annotation></semantics></math></span></th>
<th id="S3.T1.18.16.16.16" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S3.T1.18.16.16.16.2" class="ltx_text" style="background-color:#CCCCCC;">S<sub id="S3.T1.18.16.16.16.2.1" class="ltx_sub"><span id="S3.T1.18.16.16.16.2.1.1" class="ltx_text ltx_font_italic">m</span></sub> <math id="S3.T1.18.16.16.16.2.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S3.T1.18.16.16.16.2.m2.1a"><mo mathbackground="#CCCCCC" stretchy="false" id="S3.T1.18.16.16.16.2.m2.1.1" xref="S3.T1.18.16.16.16.2.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T1.18.16.16.16.2.m2.1b"><ci id="S3.T1.18.16.16.16.2.m2.1.1.cmml" xref="S3.T1.18.16.16.16.2.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.18.16.16.16.2.m2.1c">\uparrow</annotation></semantics></math></span></th>
<th id="S3.T1.20.18.18.18" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S3.T1.20.18.18.18.2" class="ltx_text" style="background-color:#CCCCCC;">F<math id="S3.T1.19.17.17.17.1.m1.1" class="ltx_Math" alttext="{}^{\omega}_{\beta}" display="inline"><semantics id="S3.T1.19.17.17.17.1.m1.1a"><mmultiscripts id="S3.T1.19.17.17.17.1.m1.1.1" xref="S3.T1.19.17.17.17.1.m1.1.1.cmml"><mi id="S3.T1.19.17.17.17.1.m1.1.1.2.2" xref="S3.T1.19.17.17.17.1.m1.1.1.2.2.cmml"></mi><mprescripts id="S3.T1.19.17.17.17.1.m1.1.1a" xref="S3.T1.19.17.17.17.1.m1.1.1.cmml"></mprescripts><mi mathbackground="#CCCCCC" id="S3.T1.19.17.17.17.1.m1.1.1.3" xref="S3.T1.19.17.17.17.1.m1.1.1.3.cmml">β</mi><mrow id="S3.T1.19.17.17.17.1.m1.1.1b" xref="S3.T1.19.17.17.17.1.m1.1.1.cmml"></mrow><mrow id="S3.T1.19.17.17.17.1.m1.1.1c" xref="S3.T1.19.17.17.17.1.m1.1.1.cmml"></mrow><mi mathbackground="#CCCCCC" id="S3.T1.19.17.17.17.1.m1.1.1.2.3" xref="S3.T1.19.17.17.17.1.m1.1.1.2.3.cmml">ω</mi></mmultiscripts><annotation-xml encoding="MathML-Content" id="S3.T1.19.17.17.17.1.m1.1b"><apply id="S3.T1.19.17.17.17.1.m1.1.1.cmml" xref="S3.T1.19.17.17.17.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.19.17.17.17.1.m1.1.1.1.cmml" xref="S3.T1.19.17.17.17.1.m1.1.1">subscript</csymbol><apply id="S3.T1.19.17.17.17.1.m1.1.1.2.cmml" xref="S3.T1.19.17.17.17.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.19.17.17.17.1.m1.1.1.2.1.cmml" xref="S3.T1.19.17.17.17.1.m1.1.1">superscript</csymbol><csymbol cd="latexml" id="S3.T1.19.17.17.17.1.m1.1.1.2.2.cmml" xref="S3.T1.19.17.17.17.1.m1.1.1.2.2">absent</csymbol><ci id="S3.T1.19.17.17.17.1.m1.1.1.2.3.cmml" xref="S3.T1.19.17.17.17.1.m1.1.1.2.3">𝜔</ci></apply><ci id="S3.T1.19.17.17.17.1.m1.1.1.3.cmml" xref="S3.T1.19.17.17.17.1.m1.1.1.3">𝛽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.19.17.17.17.1.m1.1c">{}^{\omega}_{\beta}</annotation></semantics></math> <math id="S3.T1.20.18.18.18.2.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S3.T1.20.18.18.18.2.m2.1a"><mo mathbackground="#CCCCCC" stretchy="false" id="S3.T1.20.18.18.18.2.m2.1.1" xref="S3.T1.20.18.18.18.2.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T1.20.18.18.18.2.m2.1b"><ci id="S3.T1.20.18.18.18.2.m2.1.1.cmml" xref="S3.T1.20.18.18.18.2.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.20.18.18.18.2.m2.1c">\uparrow</annotation></semantics></math></span></th>
<th id="S3.T1.21.19.19.19" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S3.T1.21.19.19.19.1" class="ltx_text" style="background-color:#CCCCCC;">MAE <math id="S3.T1.21.19.19.19.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S3.T1.21.19.19.19.1.m1.1a"><mo mathbackground="#CCCCCC" stretchy="false" id="S3.T1.21.19.19.19.1.m1.1.1" xref="S3.T1.21.19.19.19.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S3.T1.21.19.19.19.1.m1.1b"><ci id="S3.T1.21.19.19.19.1.m1.1.1.cmml" xref="S3.T1.21.19.19.19.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.21.19.19.19.1.m1.1c">\downarrow</annotation></semantics></math></span></th>
<th id="S3.T1.23.21.21.21" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r"><span id="S3.T1.23.21.21.21.2" class="ltx_text" style="background-color:#CCCCCC;">E<sub id="S3.T1.23.21.21.21.2.1" class="ltx_sub"><span id="S3.T1.23.21.21.21.2.1.1" class="ltx_text ltx_font_italic">m</span></sub> <math id="S3.T1.23.21.21.21.2.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S3.T1.23.21.21.21.2.m2.1a"><mo mathbackground="#CCCCCC" stretchy="false" id="S3.T1.23.21.21.21.2.m2.1.1" xref="S3.T1.23.21.21.21.2.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T1.23.21.21.21.2.m2.1b"><ci id="S3.T1.23.21.21.21.2.m2.1.1.cmml" xref="S3.T1.23.21.21.21.2.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.23.21.21.21.2.m2.1c">\uparrow</annotation></semantics></math></span></th>
<th id="S3.T1.25.23.23.23" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S3.T1.25.23.23.23.2" class="ltx_text" style="background-color:#CCCCCC;">S<sub id="S3.T1.25.23.23.23.2.1" class="ltx_sub"><span id="S3.T1.25.23.23.23.2.1.1" class="ltx_text ltx_font_italic">m</span></sub> <math id="S3.T1.25.23.23.23.2.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S3.T1.25.23.23.23.2.m2.1a"><mo mathbackground="#CCCCCC" stretchy="false" id="S3.T1.25.23.23.23.2.m2.1.1" xref="S3.T1.25.23.23.23.2.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T1.25.23.23.23.2.m2.1b"><ci id="S3.T1.25.23.23.23.2.m2.1.1.cmml" xref="S3.T1.25.23.23.23.2.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.25.23.23.23.2.m2.1c">\uparrow</annotation></semantics></math></span></th>
<th id="S3.T1.27.25.25.25" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S3.T1.27.25.25.25.2" class="ltx_text" style="background-color:#CCCCCC;">F<math id="S3.T1.26.24.24.24.1.m1.1" class="ltx_Math" alttext="{}^{\omega}_{\beta}" display="inline"><semantics id="S3.T1.26.24.24.24.1.m1.1a"><mmultiscripts id="S3.T1.26.24.24.24.1.m1.1.1" xref="S3.T1.26.24.24.24.1.m1.1.1.cmml"><mi id="S3.T1.26.24.24.24.1.m1.1.1.2.2" xref="S3.T1.26.24.24.24.1.m1.1.1.2.2.cmml"></mi><mprescripts id="S3.T1.26.24.24.24.1.m1.1.1a" xref="S3.T1.26.24.24.24.1.m1.1.1.cmml"></mprescripts><mi mathbackground="#CCCCCC" id="S3.T1.26.24.24.24.1.m1.1.1.3" xref="S3.T1.26.24.24.24.1.m1.1.1.3.cmml">β</mi><mrow id="S3.T1.26.24.24.24.1.m1.1.1b" xref="S3.T1.26.24.24.24.1.m1.1.1.cmml"></mrow><mrow id="S3.T1.26.24.24.24.1.m1.1.1c" xref="S3.T1.26.24.24.24.1.m1.1.1.cmml"></mrow><mi mathbackground="#CCCCCC" id="S3.T1.26.24.24.24.1.m1.1.1.2.3" xref="S3.T1.26.24.24.24.1.m1.1.1.2.3.cmml">ω</mi></mmultiscripts><annotation-xml encoding="MathML-Content" id="S3.T1.26.24.24.24.1.m1.1b"><apply id="S3.T1.26.24.24.24.1.m1.1.1.cmml" xref="S3.T1.26.24.24.24.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.26.24.24.24.1.m1.1.1.1.cmml" xref="S3.T1.26.24.24.24.1.m1.1.1">subscript</csymbol><apply id="S3.T1.26.24.24.24.1.m1.1.1.2.cmml" xref="S3.T1.26.24.24.24.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.26.24.24.24.1.m1.1.1.2.1.cmml" xref="S3.T1.26.24.24.24.1.m1.1.1">superscript</csymbol><csymbol cd="latexml" id="S3.T1.26.24.24.24.1.m1.1.1.2.2.cmml" xref="S3.T1.26.24.24.24.1.m1.1.1.2.2">absent</csymbol><ci id="S3.T1.26.24.24.24.1.m1.1.1.2.3.cmml" xref="S3.T1.26.24.24.24.1.m1.1.1.2.3">𝜔</ci></apply><ci id="S3.T1.26.24.24.24.1.m1.1.1.3.cmml" xref="S3.T1.26.24.24.24.1.m1.1.1.3">𝛽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.26.24.24.24.1.m1.1c">{}^{\omega}_{\beta}</annotation></semantics></math> <math id="S3.T1.27.25.25.25.2.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S3.T1.27.25.25.25.2.m2.1a"><mo mathbackground="#CCCCCC" stretchy="false" id="S3.T1.27.25.25.25.2.m2.1.1" xref="S3.T1.27.25.25.25.2.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T1.27.25.25.25.2.m2.1b"><ci id="S3.T1.27.25.25.25.2.m2.1.1.cmml" xref="S3.T1.27.25.25.25.2.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.27.25.25.25.2.m2.1c">\uparrow</annotation></semantics></math></span></th>
<th id="S3.T1.28.26.26.26" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S3.T1.28.26.26.26.1" class="ltx_text" style="background-color:#CCCCCC;">MAE <math id="S3.T1.28.26.26.26.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S3.T1.28.26.26.26.1.m1.1a"><mo mathbackground="#CCCCCC" stretchy="false" id="S3.T1.28.26.26.26.1.m1.1.1" xref="S3.T1.28.26.26.26.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S3.T1.28.26.26.26.1.m1.1b"><ci id="S3.T1.28.26.26.26.1.m1.1.1.cmml" xref="S3.T1.28.26.26.26.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.28.26.26.26.1.m1.1c">\downarrow</annotation></semantics></math></span></th>
<th id="S3.T1.30.28.28.28" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S3.T1.30.28.28.28.2" class="ltx_text" style="background-color:#CCCCCC;">E<sub id="S3.T1.30.28.28.28.2.1" class="ltx_sub"><span id="S3.T1.30.28.28.28.2.1.1" class="ltx_text ltx_font_italic">m</span></sub> <math id="S3.T1.30.28.28.28.2.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S3.T1.30.28.28.28.2.m2.1a"><mo mathbackground="#CCCCCC" stretchy="false" id="S3.T1.30.28.28.28.2.m2.1.1" xref="S3.T1.30.28.28.28.2.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T1.30.28.28.28.2.m2.1b"><ci id="S3.T1.30.28.28.28.2.m2.1.1.cmml" xref="S3.T1.30.28.28.28.2.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.30.28.28.28.2.m2.1c">\uparrow</annotation></semantics></math></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T1.32.30.32.1" class="ltx_tr">
<th id="S3.T1.32.30.32.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">ANetSRM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>
</th>
<td id="S3.T1.32.30.32.1.2" class="ltx_td ltx_align_center ltx_border_t">0.682</td>
<td id="S3.T1.32.30.32.1.3" class="ltx_td ltx_align_center ltx_border_t">0.484</td>
<td id="S3.T1.32.30.32.1.4" class="ltx_td ltx_align_center ltx_border_t">0.126</td>
<td id="S3.T1.32.30.32.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.722</td>
<td id="S3.T1.32.30.32.1.6" class="ltx_td ltx_align_center ltx_border_t">—</td>
<td id="S3.T1.32.30.32.1.7" class="ltx_td ltx_align_center ltx_border_t">—</td>
<td id="S3.T1.32.30.32.1.8" class="ltx_td ltx_align_center ltx_border_t">—</td>
<td id="S3.T1.32.30.32.1.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">—</td>
<td id="S3.T1.32.30.32.1.10" class="ltx_td ltx_align_center ltx_border_t">—</td>
<td id="S3.T1.32.30.32.1.11" class="ltx_td ltx_align_center ltx_border_t">—</td>
<td id="S3.T1.32.30.32.1.12" class="ltx_td ltx_align_center ltx_border_t">—</td>
<td id="S3.T1.32.30.32.1.13" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">—</td>
<td id="S3.T1.32.30.32.1.14" class="ltx_td ltx_align_center ltx_border_t">—</td>
<td id="S3.T1.32.30.32.1.15" class="ltx_td ltx_align_center ltx_border_t">—</td>
<td id="S3.T1.32.30.32.1.16" class="ltx_td ltx_align_center ltx_border_t">—</td>
<td id="S3.T1.32.30.32.1.17" class="ltx_td ltx_align_center ltx_border_t">—</td>
</tr>
<tr id="S3.T1.32.30.33.2" class="ltx_tr">
<th id="S3.T1.32.30.33.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">SINet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>
</th>
<td id="S3.T1.32.30.33.2.2" class="ltx_td ltx_align_center">0.745</td>
<td id="S3.T1.32.30.33.2.3" class="ltx_td ltx_align_center">0.644</td>
<td id="S3.T1.32.30.33.2.4" class="ltx_td ltx_align_center">0.092</td>
<td id="S3.T1.32.30.33.2.5" class="ltx_td ltx_align_center ltx_border_r">0.829</td>
<td id="S3.T1.32.30.33.2.6" class="ltx_td ltx_align_center">0.872</td>
<td id="S3.T1.32.30.33.2.7" class="ltx_td ltx_align_center">0.806</td>
<td id="S3.T1.32.30.33.2.8" class="ltx_td ltx_align_center">0.034</td>
<td id="S3.T1.32.30.33.2.9" class="ltx_td ltx_align_center ltx_border_r">0.946</td>
<td id="S3.T1.32.30.33.2.10" class="ltx_td ltx_align_center">0.776</td>
<td id="S3.T1.32.30.33.2.11" class="ltx_td ltx_align_center">0.631</td>
<td id="S3.T1.32.30.33.2.12" class="ltx_td ltx_align_center">0.043</td>
<td id="S3.T1.32.30.33.2.13" class="ltx_td ltx_align_center ltx_border_r">0.874</td>
<td id="S3.T1.32.30.33.2.14" class="ltx_td ltx_align_center">0.808</td>
<td id="S3.T1.32.30.33.2.15" class="ltx_td ltx_align_center">0.723</td>
<td id="S3.T1.32.30.33.2.16" class="ltx_td ltx_align_center">0.058</td>
<td id="S3.T1.32.30.33.2.17" class="ltx_td ltx_align_center">0.883</td>
</tr>
<tr id="S3.T1.32.30.34.3" class="ltx_tr">
<th id="S3.T1.32.30.34.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">SLSR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>
</th>
<td id="S3.T1.32.30.34.3.2" class="ltx_td ltx_align_center">0.787</td>
<td id="S3.T1.32.30.34.3.3" class="ltx_td ltx_align_center">0.696</td>
<td id="S3.T1.32.30.34.3.4" class="ltx_td ltx_align_center">0.080</td>
<td id="S3.T1.32.30.34.3.5" class="ltx_td ltx_align_center ltx_border_r">0.854</td>
<td id="S3.T1.32.30.34.3.6" class="ltx_td ltx_align_center">0.890</td>
<td id="S3.T1.32.30.34.3.7" class="ltx_td ltx_align_center">0.822</td>
<td id="S3.T1.32.30.34.3.8" class="ltx_td ltx_align_center">0.030</td>
<td id="S3.T1.32.30.34.3.9" class="ltx_td ltx_align_center ltx_border_r">0.948</td>
<td id="S3.T1.32.30.34.3.10" class="ltx_td ltx_align_center">0.804</td>
<td id="S3.T1.32.30.34.3.11" class="ltx_td ltx_align_center">0.673</td>
<td id="S3.T1.32.30.34.3.12" class="ltx_td ltx_align_center">0.037</td>
<td id="S3.T1.32.30.34.3.13" class="ltx_td ltx_align_center ltx_border_r">0.892</td>
<td id="S3.T1.32.30.34.3.14" class="ltx_td ltx_align_center">0.840</td>
<td id="S3.T1.32.30.34.3.15" class="ltx_td ltx_align_center">0.766</td>
<td id="S3.T1.32.30.34.3.16" class="ltx_td ltx_align_center">0.048</td>
<td id="S3.T1.32.30.34.3.17" class="ltx_td ltx_align_center">0.907</td>
</tr>
<tr id="S3.T1.32.30.35.4" class="ltx_tr">
<th id="S3.T1.32.30.35.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">MGL-R <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>
</th>
<td id="S3.T1.32.30.35.4.2" class="ltx_td ltx_align_center">0.775</td>
<td id="S3.T1.32.30.35.4.3" class="ltx_td ltx_align_center">0.673</td>
<td id="S3.T1.32.30.35.4.4" class="ltx_td ltx_align_center">0.088</td>
<td id="S3.T1.32.30.35.4.5" class="ltx_td ltx_align_center ltx_border_r">0.842</td>
<td id="S3.T1.32.30.35.4.6" class="ltx_td ltx_align_center">0.893</td>
<td id="S3.T1.32.30.35.4.7" class="ltx_td ltx_align_center">0.812</td>
<td id="S3.T1.32.30.35.4.8" class="ltx_td ltx_align_center">0.031</td>
<td id="S3.T1.32.30.35.4.9" class="ltx_td ltx_align_center ltx_border_r">0.941</td>
<td id="S3.T1.32.30.35.4.10" class="ltx_td ltx_align_center">0.814</td>
<td id="S3.T1.32.30.35.4.11" class="ltx_td ltx_align_center">0.666</td>
<td id="S3.T1.32.30.35.4.12" class="ltx_td ltx_align_center">0.035</td>
<td id="S3.T1.32.30.35.4.13" class="ltx_td ltx_align_center ltx_border_r">0.890</td>
<td id="S3.T1.32.30.35.4.14" class="ltx_td ltx_align_center">0.833</td>
<td id="S3.T1.32.30.35.4.15" class="ltx_td ltx_align_center">0.739</td>
<td id="S3.T1.32.30.35.4.16" class="ltx_td ltx_align_center">0.053</td>
<td id="S3.T1.32.30.35.4.17" class="ltx_td ltx_align_center">0.893</td>
</tr>
<tr id="S3.T1.32.30.36.5" class="ltx_tr">
<th id="S3.T1.32.30.36.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">PFNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>
</th>
<td id="S3.T1.32.30.36.5.2" class="ltx_td ltx_align_center">0.782</td>
<td id="S3.T1.32.30.36.5.3" class="ltx_td ltx_align_center">0.695</td>
<td id="S3.T1.32.30.36.5.4" class="ltx_td ltx_align_center">0.085</td>
<td id="S3.T1.32.30.36.5.5" class="ltx_td ltx_align_center ltx_border_r">0.855</td>
<td id="S3.T1.32.30.36.5.6" class="ltx_td ltx_align_center">0.882</td>
<td id="S3.T1.32.30.36.5.7" class="ltx_td ltx_align_center">0.810</td>
<td id="S3.T1.32.30.36.5.8" class="ltx_td ltx_align_center">0.033</td>
<td id="S3.T1.32.30.36.5.9" class="ltx_td ltx_align_center ltx_border_r">0.945</td>
<td id="S3.T1.32.30.36.5.10" class="ltx_td ltx_align_center">0.800</td>
<td id="S3.T1.32.30.36.5.11" class="ltx_td ltx_align_center">0.660</td>
<td id="S3.T1.32.30.36.5.12" class="ltx_td ltx_align_center">0.040</td>
<td id="S3.T1.32.30.36.5.13" class="ltx_td ltx_align_center ltx_border_r">0.890</td>
<td id="S3.T1.32.30.36.5.14" class="ltx_td ltx_align_center">0.829</td>
<td id="S3.T1.32.30.36.5.15" class="ltx_td ltx_align_center">0.745</td>
<td id="S3.T1.32.30.36.5.16" class="ltx_td ltx_align_center">0.053</td>
<td id="S3.T1.32.30.36.5.17" class="ltx_td ltx_align_center">0.898</td>
</tr>
<tr id="S3.T1.31.29.29" class="ltx_tr">
<th id="S3.T1.31.29.29.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">UJSC<sup id="S3.T1.31.29.29.1.1" class="ltx_sup"><span id="S3.T1.31.29.29.1.1.1" class="ltx_text ltx_font_italic">⋆</span></sup> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>
</th>
<td id="S3.T1.31.29.29.2" class="ltx_td ltx_align_center">0.800</td>
<td id="S3.T1.31.29.29.3" class="ltx_td ltx_align_center">0.728</td>
<td id="S3.T1.31.29.29.4" class="ltx_td ltx_align_center">0.073</td>
<td id="S3.T1.31.29.29.5" class="ltx_td ltx_align_center ltx_border_r">0.873</td>
<td id="S3.T1.31.29.29.6" class="ltx_td ltx_align_center">0.891</td>
<td id="S3.T1.31.29.29.7" class="ltx_td ltx_align_center">0.833</td>
<td id="S3.T1.31.29.29.8" class="ltx_td ltx_align_center">0.030</td>
<td id="S3.T1.31.29.29.9" class="ltx_td ltx_align_center ltx_border_r">0.955</td>
<td id="S3.T1.31.29.29.10" class="ltx_td ltx_align_center">0.809</td>
<td id="S3.T1.31.29.29.11" class="ltx_td ltx_align_center">0.684</td>
<td id="S3.T1.31.29.29.12" class="ltx_td ltx_align_center">0.035</td>
<td id="S3.T1.31.29.29.13" class="ltx_td ltx_align_center ltx_border_r">0.891</td>
<td id="S3.T1.31.29.29.14" class="ltx_td ltx_align_center">0.842</td>
<td id="S3.T1.31.29.29.15" class="ltx_td ltx_align_center">0.771</td>
<td id="S3.T1.31.29.29.16" class="ltx_td ltx_align_center">0.047</td>
<td id="S3.T1.31.29.29.17" class="ltx_td ltx_align_center">0.907</td>
</tr>
<tr id="S3.T1.32.30.37.6" class="ltx_tr">
<th id="S3.T1.32.30.37.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">MirrorNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>
</th>
<td id="S3.T1.32.30.37.6.2" class="ltx_td ltx_align_center">0.785</td>
<td id="S3.T1.32.30.37.6.3" class="ltx_td ltx_align_center">0.719</td>
<td id="S3.T1.32.30.37.6.4" class="ltx_td ltx_align_center">0.077</td>
<td id="S3.T1.32.30.37.6.5" class="ltx_td ltx_align_center ltx_border_r">0.850</td>
<td id="S3.T1.32.30.37.6.6" class="ltx_td ltx_align_center">—</td>
<td id="S3.T1.32.30.37.6.7" class="ltx_td ltx_align_center">—</td>
<td id="S3.T1.32.30.37.6.8" class="ltx_td ltx_align_center">—</td>
<td id="S3.T1.32.30.37.6.9" class="ltx_td ltx_align_center ltx_border_r">—</td>
<td id="S3.T1.32.30.37.6.10" class="ltx_td ltx_align_center">—</td>
<td id="S3.T1.32.30.37.6.11" class="ltx_td ltx_align_center">—</td>
<td id="S3.T1.32.30.37.6.12" class="ltx_td ltx_align_center">—</td>
<td id="S3.T1.32.30.37.6.13" class="ltx_td ltx_align_center ltx_border_r">—</td>
<td id="S3.T1.32.30.37.6.14" class="ltx_td ltx_align_center">—</td>
<td id="S3.T1.32.30.37.6.15" class="ltx_td ltx_align_center">—</td>
<td id="S3.T1.32.30.37.6.16" class="ltx_td ltx_align_center">—</td>
<td id="S3.T1.32.30.37.6.17" class="ltx_td ltx_align_center">—</td>
</tr>
<tr id="S3.T1.32.30.30" class="ltx_tr">
<th id="S3.T1.32.30.30.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">C<sup id="S3.T1.32.30.30.1.1" class="ltx_sup">2</sup>FNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>
</th>
<td id="S3.T1.32.30.30.2" class="ltx_td ltx_align_center">0.796</td>
<td id="S3.T1.32.30.30.3" class="ltx_td ltx_align_center">0.719</td>
<td id="S3.T1.32.30.30.4" class="ltx_td ltx_align_center">0.080</td>
<td id="S3.T1.32.30.30.5" class="ltx_td ltx_align_center ltx_border_r">0.864</td>
<td id="S3.T1.32.30.30.6" class="ltx_td ltx_align_center">0.888</td>
<td id="S3.T1.32.30.30.7" class="ltx_td ltx_align_center">0.828</td>
<td id="S3.T1.32.30.30.8" class="ltx_td ltx_align_center">0.032</td>
<td id="S3.T1.32.30.30.9" class="ltx_td ltx_align_center ltx_border_r">0.946</td>
<td id="S3.T1.32.30.30.10" class="ltx_td ltx_align_center">0.813</td>
<td id="S3.T1.32.30.30.11" class="ltx_td ltx_align_center">0.686</td>
<td id="S3.T1.32.30.30.12" class="ltx_td ltx_align_center">0.036</td>
<td id="S3.T1.32.30.30.13" class="ltx_td ltx_align_center ltx_border_r">0.900</td>
<td id="S3.T1.32.30.30.14" class="ltx_td ltx_align_center">0.838</td>
<td id="S3.T1.32.30.30.15" class="ltx_td ltx_align_center">0.762</td>
<td id="S3.T1.32.30.30.16" class="ltx_td ltx_align_center">0.049</td>
<td id="S3.T1.32.30.30.17" class="ltx_td ltx_align_center">0.904</td>
</tr>
<tr id="S3.T1.32.30.38.7" class="ltx_tr">
<th id="S3.T1.32.30.38.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">UGTR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>
</th>
<td id="S3.T1.32.30.38.7.2" class="ltx_td ltx_align_center">0.784</td>
<td id="S3.T1.32.30.38.7.3" class="ltx_td ltx_align_center">0.684</td>
<td id="S3.T1.32.30.38.7.4" class="ltx_td ltx_align_center">0.086</td>
<td id="S3.T1.32.30.38.7.5" class="ltx_td ltx_align_center ltx_border_r">0.851</td>
<td id="S3.T1.32.30.38.7.6" class="ltx_td ltx_align_center">0.888</td>
<td id="S3.T1.32.30.38.7.7" class="ltx_td ltx_align_center">0.794</td>
<td id="S3.T1.32.30.38.7.8" class="ltx_td ltx_align_center">0.031</td>
<td id="S3.T1.32.30.38.7.9" class="ltx_td ltx_align_center ltx_border_r">0.940</td>
<td id="S3.T1.32.30.38.7.10" class="ltx_td ltx_align_center">0.817</td>
<td id="S3.T1.32.30.38.7.11" class="ltx_td ltx_align_center">0.666</td>
<td id="S3.T1.32.30.38.7.12" class="ltx_td ltx_align_center">0.036</td>
<td id="S3.T1.32.30.38.7.13" class="ltx_td ltx_align_center ltx_border_r">0.890</td>
<td id="S3.T1.32.30.38.7.14" class="ltx_td ltx_align_center">0.839</td>
<td id="S3.T1.32.30.38.7.15" class="ltx_td ltx_align_center">0.746</td>
<td id="S3.T1.32.30.38.7.16" class="ltx_td ltx_align_center">0.052</td>
<td id="S3.T1.32.30.38.7.17" class="ltx_td ltx_align_center">0.899</td>
</tr>
<tr id="S3.T1.32.30.39.8" class="ltx_tr">
<th id="S3.T1.32.30.39.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">BGNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>
</th>
<td id="S3.T1.32.30.39.8.2" class="ltx_td ltx_align_center">0.812</td>
<td id="S3.T1.32.30.39.8.3" class="ltx_td ltx_align_center">0.749</td>
<td id="S3.T1.32.30.39.8.4" class="ltx_td ltx_align_center">0.073</td>
<td id="S3.T1.32.30.39.8.5" class="ltx_td ltx_align_center ltx_border_r">0.870</td>
<td id="S3.T1.32.30.39.8.6" class="ltx_td ltx_align_center">0.901</td>
<td id="S3.T1.32.30.39.8.7" class="ltx_td ltx_align_center"><span id="S3.T1.32.30.39.8.7.1" class="ltx_text" style="color:#1E90FF;"><span id="S3.T1.32.30.39.8.7.1.1" class="ltx_text ltx_font_bold">0.850</span></span></td>
<td id="S3.T1.32.30.39.8.8" class="ltx_td ltx_align_center">0.027</td>
<td id="S3.T1.32.30.39.8.9" class="ltx_td ltx_align_center ltx_border_r">0.938</td>
<td id="S3.T1.32.30.39.8.10" class="ltx_td ltx_align_center">0.831</td>
<td id="S3.T1.32.30.39.8.11" class="ltx_td ltx_align_center">0.722</td>
<td id="S3.T1.32.30.39.8.12" class="ltx_td ltx_align_center">0.033</td>
<td id="S3.T1.32.30.39.8.13" class="ltx_td ltx_align_center ltx_border_r">0.901</td>
<td id="S3.T1.32.30.39.8.14" class="ltx_td ltx_align_center">0.851</td>
<td id="S3.T1.32.30.39.8.15" class="ltx_td ltx_align_center"><span id="S3.T1.32.30.39.8.15.1" class="ltx_text" style="color:#1E90FF;"><span id="S3.T1.32.30.39.8.15.1.1" class="ltx_text ltx_font_bold">0.788</span></span></td>
<td id="S3.T1.32.30.39.8.16" class="ltx_td ltx_align_center">0.044</td>
<td id="S3.T1.32.30.39.8.17" class="ltx_td ltx_align_center">0.907</td>
</tr>
<tr id="S3.T1.32.30.40.9" class="ltx_tr">
<th id="S3.T1.32.30.40.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">ZoomNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>
</th>
<td id="S3.T1.32.30.40.9.2" class="ltx_td ltx_align_center"><span id="S3.T1.32.30.40.9.2.1" class="ltx_text" style="color:#1E90FF;"><span id="S3.T1.32.30.40.9.2.1.1" class="ltx_text ltx_font_bold">0.820</span></span></td>
<td id="S3.T1.32.30.40.9.3" class="ltx_td ltx_align_center"><span id="S3.T1.32.30.40.9.3.1" class="ltx_text" style="color:#1E90FF;"><span id="S3.T1.32.30.40.9.3.1.1" class="ltx_text ltx_font_bold">0.752</span></span></td>
<td id="S3.T1.32.30.40.9.4" class="ltx_td ltx_align_center"><span id="S3.T1.32.30.40.9.4.1" class="ltx_text" style="color:#1E90FF;"><span id="S3.T1.32.30.40.9.4.1.1" class="ltx_text ltx_font_bold">0.066</span></span></td>
<td id="S3.T1.32.30.40.9.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T1.32.30.40.9.5.1" class="ltx_text" style="color:#1E90FF;"><span id="S3.T1.32.30.40.9.5.1.1" class="ltx_text ltx_font_bold">0.892</span></span></td>
<td id="S3.T1.32.30.40.9.6" class="ltx_td ltx_align_center"><span id="S3.T1.32.30.40.9.6.1" class="ltx_text" style="color:#1E90FF;"><span id="S3.T1.32.30.40.9.6.1.1" class="ltx_text ltx_font_bold">0.902</span></span></td>
<td id="S3.T1.32.30.40.9.7" class="ltx_td ltx_align_center">0.845</td>
<td id="S3.T1.32.30.40.9.8" class="ltx_td ltx_align_center"><span id="S3.T1.32.30.40.9.8.1" class="ltx_text" style="color:#1E90FF;"><span id="S3.T1.32.30.40.9.8.1.1" class="ltx_text ltx_font_bold">0.023</span></span></td>
<td id="S3.T1.32.30.40.9.9" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T1.32.30.40.9.9.1" class="ltx_text" style="color:#1E90FF;"><span id="S3.T1.32.30.40.9.9.1.1" class="ltx_text ltx_font_bold">0.958</span></span></td>
<td id="S3.T1.32.30.40.9.10" class="ltx_td ltx_align_center"><span id="S3.T1.32.30.40.9.10.1" class="ltx_text" style="color:#1E90FF;"><span id="S3.T1.32.30.40.9.10.1.1" class="ltx_text ltx_font_bold">0.838</span></span></td>
<td id="S3.T1.32.30.40.9.11" class="ltx_td ltx_align_center"><span id="S3.T1.32.30.40.9.11.1" class="ltx_text" style="color:#1E90FF;"><span id="S3.T1.32.30.40.9.11.1.1" class="ltx_text ltx_font_bold">0.729</span></span></td>
<td id="S3.T1.32.30.40.9.12" class="ltx_td ltx_align_center"><span id="S3.T1.32.30.40.9.12.1" class="ltx_text" style="color:#1E90FF;"><span id="S3.T1.32.30.40.9.12.1.1" class="ltx_text ltx_font_bold">0.029</span></span></td>
<td id="S3.T1.32.30.40.9.13" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T1.32.30.40.9.13.1" class="ltx_text" style="color:#1E90FF;"><span id="S3.T1.32.30.40.9.13.1.1" class="ltx_text ltx_font_bold">0.911</span></span></td>
<td id="S3.T1.32.30.40.9.14" class="ltx_td ltx_align_center"><span id="S3.T1.32.30.40.9.14.1" class="ltx_text" style="color:#1E90FF;"><span id="S3.T1.32.30.40.9.14.1.1" class="ltx_text ltx_font_bold">0.853</span></span></td>
<td id="S3.T1.32.30.40.9.15" class="ltx_td ltx_align_center">0.784</td>
<td id="S3.T1.32.30.40.9.16" class="ltx_td ltx_align_center"><span id="S3.T1.32.30.40.9.16.1" class="ltx_text" style="color:#1E90FF;"><span id="S3.T1.32.30.40.9.16.1.1" class="ltx_text ltx_font_bold">0.043</span></span></td>
<td id="S3.T1.32.30.40.9.17" class="ltx_td ltx_align_center"><span id="S3.T1.32.30.40.9.17.1" class="ltx_text" style="color:#1E90FF;"><span id="S3.T1.32.30.40.9.17.1.1" class="ltx_text ltx_font_bold">0.912</span></span></td>
</tr>
<tr id="S3.T1.32.30.41.10" class="ltx_tr" style="background-color:#E0FFFF;">
<th id="S3.T1.32.30.41.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r"><span id="S3.T1.32.30.41.10.1.1" class="ltx_text" style="background-color:#E0FFFF;">DQnet(ours)</span></th>
<td id="S3.T1.32.30.41.10.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.32.30.41.10.2.1" class="ltx_text" style="color:#D0104C;background-color:#E0FFFF;"><span id="S3.T1.32.30.41.10.2.1.1" class="ltx_text ltx_font_bold">0.898</span></span></td>
<td id="S3.T1.32.30.41.10.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.32.30.41.10.3.1" class="ltx_text" style="color:#D0104C;background-color:#E0FFFF;"><span id="S3.T1.32.30.41.10.3.1.1" class="ltx_text ltx_font_bold">0.898</span></span></td>
<td id="S3.T1.32.30.41.10.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.32.30.41.10.4.1" class="ltx_text ltx_font_bold" style="color:#D0104C;background-color:#E0FFFF;">0.034</span></td>
<td id="S3.T1.32.30.41.10.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S3.T1.32.30.41.10.5.1" class="ltx_text ltx_font_bold" style="color:#D0104C;background-color:#E0FFFF;">0.944</span></td>
<td id="S3.T1.32.30.41.10.6" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.32.30.41.10.6.1" class="ltx_text ltx_font_bold" style="color:#D0104C;background-color:#E0FFFF;">0.915</span></td>
<td id="S3.T1.32.30.41.10.7" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.32.30.41.10.7.1" class="ltx_text ltx_font_bold" style="color:#D0104C;background-color:#E0FFFF;">0.866</span></td>
<td id="S3.T1.32.30.41.10.8" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.32.30.41.10.8.1" class="ltx_text ltx_font_bold" style="color:#D0104C;background-color:#E0FFFF;">0.021</span></td>
<td id="S3.T1.32.30.41.10.9" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S3.T1.32.30.41.10.9.1" class="ltx_text ltx_font_bold" style="color:#D0104C;background-color:#E0FFFF;">0.960</span></td>
<td id="S3.T1.32.30.41.10.10" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.32.30.41.10.10.1" class="ltx_text ltx_font_bold" style="color:#D0104C;background-color:#E0FFFF;">0.882</span></td>
<td id="S3.T1.32.30.41.10.11" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.32.30.41.10.11.1" class="ltx_text ltx_font_bold" style="color:#D0104C;background-color:#E0FFFF;">0.801</span></td>
<td id="S3.T1.32.30.41.10.12" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.32.30.41.10.12.1" class="ltx_text ltx_font_bold" style="color:#D0104C;background-color:#E0FFFF;">0.021</span></td>
<td id="S3.T1.32.30.41.10.13" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S3.T1.32.30.41.10.13.1" class="ltx_text ltx_font_bold" style="color:#D0104C;background-color:#E0FFFF;">0.930</span></td>
<td id="S3.T1.32.30.41.10.14" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.32.30.41.10.14.1" class="ltx_text ltx_font_bold" style="color:#D0104C;background-color:#E0FFFF;">0.901</span></td>
<td id="S3.T1.32.30.41.10.15" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.32.30.41.10.15.1" class="ltx_text ltx_font_bold" style="color:#D0104C;background-color:#E0FFFF;">0.859</span></td>
<td id="S3.T1.32.30.41.10.16" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.32.30.41.10.16.1" class="ltx_text ltx_font_bold" style="color:#D0104C;background-color:#E0FFFF;">0.029</span></td>
<td id="S3.T1.32.30.41.10.17" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.32.30.41.10.17.1" class="ltx_text ltx_font_bold" style="color:#D0104C;background-color:#E0FFFF;">0.942</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Experimental Setup</h3>

<div id="S4.SS1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS1.p1.1" class="ltx_p"><span id="S4.SS1.p1.1.1" class="ltx_text ltx_font_bold">Datasets.</span> We evaluate our method on four benchmark datasets: CHAMELEON <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>, CAMO <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, COD10K <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> and NC4K <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>. CHAMELEON <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> has 76 images collected from the Internet via the Google search engine using “camouflaged animal” as a keyword with hand-annotated labels. CAMO <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> contains 1,250 camouflaged images covering 8 categories(1,000 for training, 250 for testing). COD10K <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> is a large-scale dataset including 5,066 camouflaged, 3,000 background and 1,934 non-camouflaged images, which provides high-quality fine annotation, reaching the level of matting. NC4K <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> is currently the largest benchmark testing dataset including 4,121 images from the Internet. We follow previous work  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> to use the training set of CAMO <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> and COD10K <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> as the training sets (4,040 images) and others as testing sets.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para ltx_noindent">
<p id="S4.SS1.p2.6" class="ltx_p"><span id="S4.SS1.p2.6.1" class="ltx_text ltx_font_bold">Evaluation Metrics.</span>
To comprehensively compare our proposed model with other state-of-the-art methods, We use four widely used metrics to evaluate our method: structure-measure (S<sub id="S4.SS1.p2.6.2" class="ltx_sub"><span id="S4.SS1.p2.6.2.1" class="ltx_text ltx_font_italic">m</span></sub>) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>, E-measure (E<sub id="S4.SS1.p2.6.3" class="ltx_sub"><span id="S4.SS1.p2.6.3.1" class="ltx_text ltx_font_italic">m</span></sub>) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>, weighted F-measure (F<math id="S4.SS1.p2.3.m3.1" class="ltx_Math" alttext="{}^{\omega}_{\beta}" display="inline"><semantics id="S4.SS1.p2.3.m3.1a"><mmultiscripts id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml"><mi id="S4.SS1.p2.3.m3.1.1.2.2" xref="S4.SS1.p2.3.m3.1.1.2.2.cmml"></mi><mprescripts id="S4.SS1.p2.3.m3.1.1a" xref="S4.SS1.p2.3.m3.1.1.cmml"></mprescripts><mi id="S4.SS1.p2.3.m3.1.1.3" xref="S4.SS1.p2.3.m3.1.1.3.cmml">β</mi><mrow id="S4.SS1.p2.3.m3.1.1b" xref="S4.SS1.p2.3.m3.1.1.cmml"></mrow><mrow id="S4.SS1.p2.3.m3.1.1c" xref="S4.SS1.p2.3.m3.1.1.cmml"></mrow><mi id="S4.SS1.p2.3.m3.1.1.2.3" xref="S4.SS1.p2.3.m3.1.1.2.3.cmml">ω</mi></mmultiscripts><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b"><apply id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.3.m3.1.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1">subscript</csymbol><apply id="S4.SS1.p2.3.m3.1.1.2.cmml" xref="S4.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.3.m3.1.1.2.1.cmml" xref="S4.SS1.p2.3.m3.1.1">superscript</csymbol><csymbol cd="latexml" id="S4.SS1.p2.3.m3.1.1.2.2.cmml" xref="S4.SS1.p2.3.m3.1.1.2.2">absent</csymbol><ci id="S4.SS1.p2.3.m3.1.1.2.3.cmml" xref="S4.SS1.p2.3.m3.1.1.2.3">𝜔</ci></apply><ci id="S4.SS1.p2.3.m3.1.1.3.cmml" xref="S4.SS1.p2.3.m3.1.1.3">𝛽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">{}^{\omega}_{\beta}</annotation></semantics></math>) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>, and mean absolute error (MAE).
Structure-measure (S<sub id="S4.SS1.p2.6.4" class="ltx_sub"><span id="S4.SS1.p2.6.4.1" class="ltx_text ltx_font_italic">m</span></sub>) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>focuses on evaluating the structural information of the prediction maps, by computing the object-aware and region-aware structure similarities between the prediction and the ground truth. E-measure (E<sub id="S4.SS1.p2.6.5" class="ltx_sub"><span id="S4.SS1.p2.6.5.1" class="ltx_text ltx_font_italic">m</span></sub>) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>is based on the human visual perception mechanism to assess the overall and local accuracy of COD results. F-measure (F<math id="S4.SS1.p2.6.m6.1" class="ltx_Math" alttext="{}^{\omega}_{\beta}" display="inline"><semantics id="S4.SS1.p2.6.m6.1a"><mmultiscripts id="S4.SS1.p2.6.m6.1.1" xref="S4.SS1.p2.6.m6.1.1.cmml"><mi id="S4.SS1.p2.6.m6.1.1.2.2" xref="S4.SS1.p2.6.m6.1.1.2.2.cmml"></mi><mprescripts id="S4.SS1.p2.6.m6.1.1a" xref="S4.SS1.p2.6.m6.1.1.cmml"></mprescripts><mi id="S4.SS1.p2.6.m6.1.1.3" xref="S4.SS1.p2.6.m6.1.1.3.cmml">β</mi><mrow id="S4.SS1.p2.6.m6.1.1b" xref="S4.SS1.p2.6.m6.1.1.cmml"></mrow><mrow id="S4.SS1.p2.6.m6.1.1c" xref="S4.SS1.p2.6.m6.1.1.cmml"></mrow><mi id="S4.SS1.p2.6.m6.1.1.2.3" xref="S4.SS1.p2.6.m6.1.1.2.3.cmml">ω</mi></mmultiscripts><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.6.m6.1b"><apply id="S4.SS1.p2.6.m6.1.1.cmml" xref="S4.SS1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.6.m6.1.1.1.cmml" xref="S4.SS1.p2.6.m6.1.1">subscript</csymbol><apply id="S4.SS1.p2.6.m6.1.1.2.cmml" xref="S4.SS1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.6.m6.1.1.2.1.cmml" xref="S4.SS1.p2.6.m6.1.1">superscript</csymbol><csymbol cd="latexml" id="S4.SS1.p2.6.m6.1.1.2.2.cmml" xref="S4.SS1.p2.6.m6.1.1.2.2">absent</csymbol><ci id="S4.SS1.p2.6.m6.1.1.2.3.cmml" xref="S4.SS1.p2.6.m6.1.1.2.3">𝜔</ci></apply><ci id="S4.SS1.p2.6.m6.1.1.3.cmml" xref="S4.SS1.p2.6.m6.1.1.3">𝛽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.6.m6.1c">{}^{\omega}_{\beta}</annotation></semantics></math>) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>is a comprehensive measure of both the precision and recall of the prediction map. The mean absolute error (MAE) metric is also used in our evaluation to measure the foreground-background segmentation error.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para ltx_noindent">
<p id="S4.SS1.p3.1" class="ltx_p"><span id="S4.SS1.p3.1.1" class="ltx_text ltx_font_bold">Implementation Details.</span> Our method is implemented based on PyTorch. Two NVIDIA GeForce RTX 3090 GPU (with 24GB memory) is used for both training and testing. For data preparation, we perform data augmentation techniques on all training data, including random flipping, random rotating and scaling in the range of [0.75, 1.25]. The parameters of ResNet-50 and ViT-B are both initialized with weights pre-trained on ImageNet while the remaining layers are initialized randomly. For effective finetuning, we set the layer decay to 0.75 for ViT. For optimization, we use the AdamW optimizer for loss optimization. We set the batch size to 12 and adjust the learning rate by the poly strategy <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> with the initial learning rate of 0.001 and the power of 0.9. Both the resizing processes use bicubic interpolation.</p>
</div>
<figure id="S4.F4" class="ltx_figure"><img src="/html/2212.08296/assets/x4.png" id="S4.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="312" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.2.1.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S4.F4.3.2" class="ltx_text" style="font-size:90%;">Visual comparisons of some recent COD methods and ours. (Best viewed in color with zoom in)</span></figcaption>
</figure>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Comparision with State-of-the-art methods</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">We compare our proposed FCNet with 11 SOTA methods, including ANet-SRM<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, SINet<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, SLSR<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>, MGL-R<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>, PFNet<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>, UJSC<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>, MirroNet<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>,
C<sup id="S4.SS2.p1.1.1" class="ltx_sup">2</sup>FNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>,
UGTR<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>,
BGNet<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>,
ZoomNet<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> on four benchmark datasets.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para ltx_noindent">
<p id="S4.SS2.p2.11" class="ltx_p"><span id="S4.SS2.p2.11.1" class="ltx_text ltx_font_bold">Quantitative Comparison.</span>
As can be seen in <a href="#S3.T1" title="In 3.4 Loss Functions ‣ 3 Methodology ‣ DQnet: Cross-Model Detail Querying for Camouflaged Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">1</span></a>, even without using any extra dataset or auxiliary task, our method outperforms all the other methods by a large margin on all four standard metrics. Specifically, compared with the currently second best result, F<math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="{}^{\omega}_{\beta}" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><mmultiscripts id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml"><mi id="S4.SS2.p2.1.m1.1.1.2.2" xref="S4.SS2.p2.1.m1.1.1.2.2.cmml"></mi><mprescripts id="S4.SS2.p2.1.m1.1.1a" xref="S4.SS2.p2.1.m1.1.1.cmml"></mprescripts><mi id="S4.SS2.p2.1.m1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.3.cmml">β</mi><mrow id="S4.SS2.p2.1.m1.1.1b" xref="S4.SS2.p2.1.m1.1.1.cmml"></mrow><mrow id="S4.SS2.p2.1.m1.1.1c" xref="S4.SS2.p2.1.m1.1.1.cmml"></mrow><mi id="S4.SS2.p2.1.m1.1.1.2.3" xref="S4.SS2.p2.1.m1.1.1.2.3.cmml">ω</mi></mmultiscripts><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">subscript</csymbol><apply id="S4.SS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.2.1.cmml" xref="S4.SS2.p2.1.m1.1.1">superscript</csymbol><csymbol cd="latexml" id="S4.SS2.p2.1.m1.1.1.2.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2.2">absent</csymbol><ci id="S4.SS2.p2.1.m1.1.1.2.3.cmml" xref="S4.SS2.p2.1.m1.1.1.2.3">𝜔</ci></apply><ci id="S4.SS2.p2.1.m1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3">𝛽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">{}^{\omega}_{\beta}</annotation></semantics></math> increased by <math id="S4.SS2.p2.2.m2.1" class="ltx_Math" alttext="7.6\%" display="inline"><semantics id="S4.SS2.p2.2.m2.1a"><mrow id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml"><mn id="S4.SS2.p2.2.m2.1.1.2" xref="S4.SS2.p2.2.m2.1.1.2.cmml">7.6</mn><mo id="S4.SS2.p2.2.m2.1.1.1" xref="S4.SS2.p2.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><apply id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1"><csymbol cd="latexml" id="S4.SS2.p2.2.m2.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1">percent</csymbol><cn type="float" id="S4.SS2.p2.2.m2.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1.2">7.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">7.6\%</annotation></semantics></math> on average, S<sub id="S4.SS2.p2.11.2" class="ltx_sub"><span id="S4.SS2.p2.11.2.1" class="ltx_text ltx_font_italic">m</span></sub> increased by <math id="S4.SS2.p2.4.m4.1" class="ltx_Math" alttext="4.6\%" display="inline"><semantics id="S4.SS2.p2.4.m4.1a"><mrow id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml"><mn id="S4.SS2.p2.4.m4.1.1.2" xref="S4.SS2.p2.4.m4.1.1.2.cmml">4.6</mn><mo id="S4.SS2.p2.4.m4.1.1.1" xref="S4.SS2.p2.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><apply id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1"><csymbol cd="latexml" id="S4.SS2.p2.4.m4.1.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1.1">percent</csymbol><cn type="float" id="S4.SS2.p2.4.m4.1.1.2.cmml" xref="S4.SS2.p2.4.m4.1.1.2">4.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.1c">4.6\%</annotation></semantics></math>, E<sub id="S4.SS2.p2.11.3" class="ltx_sub"><span id="S4.SS2.p2.11.3.1" class="ltx_text ltx_font_italic">m</span></sub> increased by <math id="S4.SS2.p2.6.m6.1" class="ltx_Math" alttext="2.6\%" display="inline"><semantics id="S4.SS2.p2.6.m6.1a"><mrow id="S4.SS2.p2.6.m6.1.1" xref="S4.SS2.p2.6.m6.1.1.cmml"><mn id="S4.SS2.p2.6.m6.1.1.2" xref="S4.SS2.p2.6.m6.1.1.2.cmml">2.6</mn><mo id="S4.SS2.p2.6.m6.1.1.1" xref="S4.SS2.p2.6.m6.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.6.m6.1b"><apply id="S4.SS2.p2.6.m6.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1"><csymbol cd="latexml" id="S4.SS2.p2.6.m6.1.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1.1">percent</csymbol><cn type="float" id="S4.SS2.p2.6.m6.1.1.2.cmml" xref="S4.SS2.p2.6.m6.1.1.2">2.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.6.m6.1c">2.6\%</annotation></semantics></math>, and MAE lowered by <math id="S4.SS2.p2.7.m7.1" class="ltx_Math" alttext="1.4\%" display="inline"><semantics id="S4.SS2.p2.7.m7.1a"><mrow id="S4.SS2.p2.7.m7.1.1" xref="S4.SS2.p2.7.m7.1.1.cmml"><mn id="S4.SS2.p2.7.m7.1.1.2" xref="S4.SS2.p2.7.m7.1.1.2.cmml">1.4</mn><mo id="S4.SS2.p2.7.m7.1.1.1" xref="S4.SS2.p2.7.m7.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.7.m7.1b"><apply id="S4.SS2.p2.7.m7.1.1.cmml" xref="S4.SS2.p2.7.m7.1.1"><csymbol cd="latexml" id="S4.SS2.p2.7.m7.1.1.1.cmml" xref="S4.SS2.p2.7.m7.1.1.1">percent</csymbol><cn type="float" id="S4.SS2.p2.7.m7.1.1.2.cmml" xref="S4.SS2.p2.7.m7.1.1.2">1.4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.7.m7.1c">1.4\%</annotation></semantics></math>. Notably, even on the currently most difficult COD dataset NC4K, our DQnet still achieves a <math id="S4.SS2.p2.8.m8.1" class="ltx_Math" alttext="4.8\%" display="inline"><semantics id="S4.SS2.p2.8.m8.1a"><mrow id="S4.SS2.p2.8.m8.1.1" xref="S4.SS2.p2.8.m8.1.1.cmml"><mn id="S4.SS2.p2.8.m8.1.1.2" xref="S4.SS2.p2.8.m8.1.1.2.cmml">4.8</mn><mo id="S4.SS2.p2.8.m8.1.1.1" xref="S4.SS2.p2.8.m8.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.8.m8.1b"><apply id="S4.SS2.p2.8.m8.1.1.cmml" xref="S4.SS2.p2.8.m8.1.1"><csymbol cd="latexml" id="S4.SS2.p2.8.m8.1.1.1.cmml" xref="S4.SS2.p2.8.m8.1.1.1">percent</csymbol><cn type="float" id="S4.SS2.p2.8.m8.1.1.2.cmml" xref="S4.SS2.p2.8.m8.1.1.2">4.8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.8.m8.1c">4.8\%</annotation></semantics></math> gain in terms of S<sub id="S4.SS2.p2.11.4" class="ltx_sub"><span id="S4.SS2.p2.11.4.1" class="ltx_text ltx_font_italic">m</span></sub> and a remarkable <math id="S4.SS2.p2.10.m10.1" class="ltx_Math" alttext="7.5\%" display="inline"><semantics id="S4.SS2.p2.10.m10.1a"><mrow id="S4.SS2.p2.10.m10.1.1" xref="S4.SS2.p2.10.m10.1.1.cmml"><mn id="S4.SS2.p2.10.m10.1.1.2" xref="S4.SS2.p2.10.m10.1.1.2.cmml">7.5</mn><mo id="S4.SS2.p2.10.m10.1.1.1" xref="S4.SS2.p2.10.m10.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.10.m10.1b"><apply id="S4.SS2.p2.10.m10.1.1.cmml" xref="S4.SS2.p2.10.m10.1.1"><csymbol cd="latexml" id="S4.SS2.p2.10.m10.1.1.1.cmml" xref="S4.SS2.p2.10.m10.1.1.1">percent</csymbol><cn type="float" id="S4.SS2.p2.10.m10.1.1.2.cmml" xref="S4.SS2.p2.10.m10.1.1.2">7.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.10.m10.1c">7.5\%</annotation></semantics></math> gain in terms of F<math id="S4.SS2.p2.11.m11.1" class="ltx_Math" alttext="{}^{\omega}_{\beta}" display="inline"><semantics id="S4.SS2.p2.11.m11.1a"><mmultiscripts id="S4.SS2.p2.11.m11.1.1" xref="S4.SS2.p2.11.m11.1.1.cmml"><mi id="S4.SS2.p2.11.m11.1.1.2.2" xref="S4.SS2.p2.11.m11.1.1.2.2.cmml"></mi><mprescripts id="S4.SS2.p2.11.m11.1.1a" xref="S4.SS2.p2.11.m11.1.1.cmml"></mprescripts><mi id="S4.SS2.p2.11.m11.1.1.3" xref="S4.SS2.p2.11.m11.1.1.3.cmml">β</mi><mrow id="S4.SS2.p2.11.m11.1.1b" xref="S4.SS2.p2.11.m11.1.1.cmml"></mrow><mrow id="S4.SS2.p2.11.m11.1.1c" xref="S4.SS2.p2.11.m11.1.1.cmml"></mrow><mi id="S4.SS2.p2.11.m11.1.1.2.3" xref="S4.SS2.p2.11.m11.1.1.2.3.cmml">ω</mi></mmultiscripts><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.11.m11.1b"><apply id="S4.SS2.p2.11.m11.1.1.cmml" xref="S4.SS2.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.11.m11.1.1.1.cmml" xref="S4.SS2.p2.11.m11.1.1">subscript</csymbol><apply id="S4.SS2.p2.11.m11.1.1.2.cmml" xref="S4.SS2.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.11.m11.1.1.2.1.cmml" xref="S4.SS2.p2.11.m11.1.1">superscript</csymbol><csymbol cd="latexml" id="S4.SS2.p2.11.m11.1.1.2.2.cmml" xref="S4.SS2.p2.11.m11.1.1.2.2">absent</csymbol><ci id="S4.SS2.p2.11.m11.1.1.2.3.cmml" xref="S4.SS2.p2.11.m11.1.1.2.3">𝜔</ci></apply><ci id="S4.SS2.p2.11.m11.1.1.3.cmml" xref="S4.SS2.p2.11.m11.1.1.3">𝛽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.11.m11.1c">{}^{\omega}_{\beta}</annotation></semantics></math>. Such a performance gain proves the importance of effective detail querying. Progressively retrieving crucial local details under strong global cues could be vital for full object extent activation and precise boundary delineation in the difficult COD scenario.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para ltx_noindent">
<p id="S4.SS2.p3.1" class="ltx_p"><span id="S4.SS2.p3.1.1" class="ltx_text ltx_font_bold">Visual Comparison.</span>
Visual comparisons of different COD methods on several typical samples are shown in <a href="#S4.F4" title="In 4.1 Experimental Setup ‣ 4 Experiments ‣ DQnet: Cross-Model Detail Querying for Camouflaged Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">4</span></a>. While the SOTAs are typically confused by the background which shares similar context with camouflaged objects (<em id="S4.SS2.p3.1.2" class="ltx_emph ltx_font_italic">e.g.</em>, first four rows) or resembles the target object due to shadow or illumination (<em id="S4.SS2.p3.1.3" class="ltx_emph ltx_font_italic">e.g.</em>, 5-<em id="S4.SS2.p3.1.4" class="ltx_emph ltx_font_italic">th</em> and 6-<em id="S4.SS2.p3.1.5" class="ltx_emph ltx_font_italic">th</em> rows), our method can successfully infer the camouflaged region with complete object extent. This is mainly contributed by the proposed detail querying strategy which could help suppress the background noise and enhance the details within the target object region. Furthermore, benefited by the cross-model interaction in the detail querying process, our method can capture fine-grained object details without losing the general shape of a specific category and thus has the ability to finely segment the camouflaged objects under severe occlusion. (<em id="S4.SS2.p3.1.6" class="ltx_emph ltx_font_italic">e.g.</em>, 7-<em id="S4.SS2.p3.1.7" class="ltx_emph ltx_font_italic">th</em> row)</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Model Evaluation and Analyses</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">In this section, we conduct extensive ablation analyses on different components. Because COD10K<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> is the most widely-used large-scale COD dataset, and contains various objects and scenes, all subsequent ablation experiments are carried out on it.</p>
</div>
<figure id="S4.F5" class="ltx_figure"><img src="/html/2212.08296/assets/x5.png" id="S4.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="119" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F5.2.1.1" class="ltx_text" style="font-size:90%;">Figure 5</span>: </span><span id="S4.F5.3.2" class="ltx_text" style="font-size:90%;">Visualization of mutil-scale detail querying. (a) Input image. (b) ViT attention map. (c) Vanilla ResNet features in the last three stages. (d) Enhanced ResNet features after RBQ. (e) Segmentation result and ground truth. (Best viewed in color)</span></figcaption>
</figure>
<div id="S4.SS3.p2" class="ltx_para ltx_noindent">
<p id="S4.SS3.p2.1" class="ltx_p"><span id="S4.SS3.p2.1.1" class="ltx_text ltx_font_bold">The Effectiveness of feature alignment</span>
To verify the effectiveness of proposed feature alignment, we use plain element-wise addition to perform feature enhancement after the feature alignment. When validating the vanilla ViT-B, we directly upsample the single-stride representation with deconvolution to get the predictions due to the non-hierarchical architecture of the vanilla ViT. For the vanilla ResNet-50 case, we use the latter four stage features to construct the feature pyramid and follow similiar simple decoder design with our method. We also construct the feature pyramid using both ViT-B and ResNet-50 to evaluate the model ensemble performance. The results are shown in <a href="#S4.T2" title="In 4.3 Model Evaluation and Analyses ‣ 4 Experiments ‣ DQnet: Cross-Model Detail Querying for Camouflaged Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">2</span></a>. From ①-④, it can be been that a simple ensemble only gives a minor gain compared with vanilla ViT-B, while feature alignment with a plain addition could make a significant contribution to the performance. This shows that an interactive combining after the feature alignment could inherit the strengths of both models more easily.</p>
</div>
<div id="S4.SS3.p3" class="ltx_para ltx_noindent">
<p id="S4.SS3.p3.1" class="ltx_p"><span id="S4.SS3.p3.1.1" class="ltx_text ltx_font_bold">The Effectiveness of RBQ and SAL</span>
As shown in <a href="#S4.T2" title="In 4.3 Model Evaluation and Analyses ‣ 4 Experiments ‣ DQnet: Cross-Model Detail Querying for Camouflaged Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">2</span></a> ⑤, with RBQ, the value of F<math id="S4.SS3.p3.1.m1.1" class="ltx_Math" alttext="{}^{\omega}_{\beta}" display="inline"><semantics id="S4.SS3.p3.1.m1.1a"><mmultiscripts id="S4.SS3.p3.1.m1.1.1" xref="S4.SS3.p3.1.m1.1.1.cmml"><mi id="S4.SS3.p3.1.m1.1.1.2.2" xref="S4.SS3.p3.1.m1.1.1.2.2.cmml"></mi><mprescripts id="S4.SS3.p3.1.m1.1.1a" xref="S4.SS3.p3.1.m1.1.1.cmml"></mprescripts><mi id="S4.SS3.p3.1.m1.1.1.3" xref="S4.SS3.p3.1.m1.1.1.3.cmml">β</mi><mrow id="S4.SS3.p3.1.m1.1.1b" xref="S4.SS3.p3.1.m1.1.1.cmml"></mrow><mrow id="S4.SS3.p3.1.m1.1.1c" xref="S4.SS3.p3.1.m1.1.1.cmml"></mrow><mi id="S4.SS3.p3.1.m1.1.1.2.3" xref="S4.SS3.p3.1.m1.1.1.2.3.cmml">ω</mi></mmultiscripts><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.1.m1.1b"><apply id="S4.SS3.p3.1.m1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.1.m1.1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1">subscript</csymbol><apply id="S4.SS3.p3.1.m1.1.1.2.cmml" xref="S4.SS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.1.m1.1.1.2.1.cmml" xref="S4.SS3.p3.1.m1.1.1">superscript</csymbol><csymbol cd="latexml" id="S4.SS3.p3.1.m1.1.1.2.2.cmml" xref="S4.SS3.p3.1.m1.1.1.2.2">absent</csymbol><ci id="S4.SS3.p3.1.m1.1.1.2.3.cmml" xref="S4.SS3.p3.1.m1.1.1.2.3">𝜔</ci></apply><ci id="S4.SS3.p3.1.m1.1.1.3.cmml" xref="S4.SS3.p3.1.m1.1.1.3">𝛽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.1.m1.1c">{}^{\omega}_{\beta}</annotation></semantics></math> increaced by 8.9% compared to ViT-B and 17.8% compared to Res-50. It indicates that high-level global semantics and low-level local details in multiple scales are both critical to accurate COD. Compared with vanilla ResNet features, RBQ effectively suppresses the noise caused by object-background similarity, obtaining features fully highlight the object regions, <a href="#S4.F5" title="In 4.3 Model Evaluation and Analyses ‣ 4 Experiments ‣ DQnet: Cross-Model Detail Querying for Camouflaged Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">5</span></a>. Furthermore, as shown in <a href="#S4.T3" title="In 4.3 Model Evaluation and Analyses ‣ 4 Experiments ‣ DQnet: Cross-Model Detail Querying for Camouflaged Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">3</span></a>, RBQ effectively refines the feature enhancement by introducing multi-scale querying to fill the cross-model semantic gap progressively, which further improves the performance compared with element-wise operation and feature concatenation. Moreover, <a href="#S4.T2" title="In 4.3 Model Evaluation and Analyses ‣ 4 Experiments ‣ DQnet: Cross-Model Detail Querying for Camouflaged Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">2</span></a> ⑥ validates the effectiveness of the SAL design.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S4.T2.9.1.1" class="ltx_text" style="font-size:90%;">Table 2</span>: </span><span id="S4.T2.10.2" class="ltx_text" style="font-size:90%;">Comparison of different architectures and compositions</span></figcaption>
<div id="S4.T2.7" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:176.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(40.0pt,-16.3pt) scale(1.22645292276348,1.22645292276348) ;">
<table id="S4.T2.7.7" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T2.7.7.8.1" class="ltx_tr">
<th id="S4.T2.7.7.8.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" rowspan="2"><span id="S4.T2.7.7.8.1.1.1" class="ltx_text">Composition</span></th>
<th id="S4.T2.7.7.8.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="4">COD10K</th>
</tr>
<tr id="S4.T2.7.7.7" class="ltx_tr">
<th id="S4.T2.2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">S<sub id="S4.T2.2.2.2.2.1" class="ltx_sub"><span id="S4.T2.2.2.2.2.1.1" class="ltx_text ltx_font_italic">m</span></sub> <math id="S4.T2.2.2.2.2.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S4.T2.2.2.2.2.m2.1a"><mo stretchy="false" id="S4.T2.2.2.2.2.m2.1.1" xref="S4.T2.2.2.2.2.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.2.2.m2.1b"><ci id="S4.T2.2.2.2.2.m2.1.1.cmml" xref="S4.T2.2.2.2.2.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.2.2.m2.1c">\uparrow</annotation></semantics></math>
</th>
<th id="S4.T2.4.4.4.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">F<math id="S4.T2.3.3.3.3.m1.1" class="ltx_Math" alttext="{}^{\omega}_{\beta}" display="inline"><semantics id="S4.T2.3.3.3.3.m1.1a"><mmultiscripts id="S4.T2.3.3.3.3.m1.1.1" xref="S4.T2.3.3.3.3.m1.1.1.cmml"><mi id="S4.T2.3.3.3.3.m1.1.1.2.2" xref="S4.T2.3.3.3.3.m1.1.1.2.2.cmml"></mi><mprescripts id="S4.T2.3.3.3.3.m1.1.1a" xref="S4.T2.3.3.3.3.m1.1.1.cmml"></mprescripts><mi id="S4.T2.3.3.3.3.m1.1.1.3" xref="S4.T2.3.3.3.3.m1.1.1.3.cmml">β</mi><mrow id="S4.T2.3.3.3.3.m1.1.1b" xref="S4.T2.3.3.3.3.m1.1.1.cmml"></mrow><mrow id="S4.T2.3.3.3.3.m1.1.1c" xref="S4.T2.3.3.3.3.m1.1.1.cmml"></mrow><mi id="S4.T2.3.3.3.3.m1.1.1.2.3" xref="S4.T2.3.3.3.3.m1.1.1.2.3.cmml">ω</mi></mmultiscripts><annotation-xml encoding="MathML-Content" id="S4.T2.3.3.3.3.m1.1b"><apply id="S4.T2.3.3.3.3.m1.1.1.cmml" xref="S4.T2.3.3.3.3.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.3.3.3.3.m1.1.1.1.cmml" xref="S4.T2.3.3.3.3.m1.1.1">subscript</csymbol><apply id="S4.T2.3.3.3.3.m1.1.1.2.cmml" xref="S4.T2.3.3.3.3.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.3.3.3.3.m1.1.1.2.1.cmml" xref="S4.T2.3.3.3.3.m1.1.1">superscript</csymbol><csymbol cd="latexml" id="S4.T2.3.3.3.3.m1.1.1.2.2.cmml" xref="S4.T2.3.3.3.3.m1.1.1.2.2">absent</csymbol><ci id="S4.T2.3.3.3.3.m1.1.1.2.3.cmml" xref="S4.T2.3.3.3.3.m1.1.1.2.3">𝜔</ci></apply><ci id="S4.T2.3.3.3.3.m1.1.1.3.cmml" xref="S4.T2.3.3.3.3.m1.1.1.3">𝛽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.3.3.3.m1.1c">{}^{\omega}_{\beta}</annotation></semantics></math> <math id="S4.T2.4.4.4.4.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S4.T2.4.4.4.4.m2.1a"><mo stretchy="false" id="S4.T2.4.4.4.4.m2.1.1" xref="S4.T2.4.4.4.4.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.4.4.4.4.m2.1b"><ci id="S4.T2.4.4.4.4.m2.1.1.cmml" xref="S4.T2.4.4.4.4.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.4.4.4.m2.1c">\uparrow</annotation></semantics></math>
</th>
<th id="S4.T2.5.5.5.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">MAE <math id="S4.T2.5.5.5.5.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S4.T2.5.5.5.5.m1.1a"><mo stretchy="false" id="S4.T2.5.5.5.5.m1.1.1" xref="S4.T2.5.5.5.5.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T2.5.5.5.5.m1.1b"><ci id="S4.T2.5.5.5.5.m1.1.1.cmml" xref="S4.T2.5.5.5.5.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.5.5.5.5.m1.1c">\downarrow</annotation></semantics></math>
</th>
<th id="S4.T2.7.7.7.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">E<sub id="S4.T2.7.7.7.7.1" class="ltx_sub"><span id="S4.T2.7.7.7.7.1.1" class="ltx_text ltx_font_italic">m</span></sub> <math id="S4.T2.7.7.7.7.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S4.T2.7.7.7.7.m2.1a"><mo stretchy="false" id="S4.T2.7.7.7.7.m2.1.1" xref="S4.T2.7.7.7.7.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.7.7.7.7.m2.1b"><ci id="S4.T2.7.7.7.7.m2.1.1.cmml" xref="S4.T2.7.7.7.7.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.7.7.7.7.m2.1c">\uparrow</annotation></semantics></math>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T2.7.7.9.1" class="ltx_tr">
<th id="S4.T2.7.7.9.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_tt">①vanilla Res-50</th>
<td id="S4.T2.7.7.9.1.2" class="ltx_td ltx_align_center ltx_border_tt">0.756</td>
<td id="S4.T2.7.7.9.1.3" class="ltx_td ltx_align_center ltx_border_tt">0.621</td>
<td id="S4.T2.7.7.9.1.4" class="ltx_td ltx_align_center ltx_border_tt">0.046</td>
<td id="S4.T2.7.7.9.1.5" class="ltx_td ltx_align_center ltx_border_tt">0.856</td>
</tr>
<tr id="S4.T2.7.7.10.2" class="ltx_tr">
<th id="S4.T2.7.7.10.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">②vanilla ViT-B</th>
<td id="S4.T2.7.7.10.2.2" class="ltx_td ltx_align_center">0.833</td>
<td id="S4.T2.7.7.10.2.3" class="ltx_td ltx_align_center">0.710</td>
<td id="S4.T2.7.7.10.2.4" class="ltx_td ltx_align_center">0.033</td>
<td id="S4.T2.7.7.10.2.5" class="ltx_td ltx_align_center">0.876</td>
</tr>
<tr id="S4.T2.7.7.11.3" class="ltx_tr">
<th id="S4.T2.7.7.11.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">③emsemble</th>
<td id="S4.T2.7.7.11.3.2" class="ltx_td ltx_align_center">0.838</td>
<td id="S4.T2.7.7.11.3.3" class="ltx_td ltx_align_center">0.725</td>
<td id="S4.T2.7.7.11.3.4" class="ltx_td ltx_align_center">0.030</td>
<td id="S4.T2.7.7.11.3.5" class="ltx_td ltx_align_center">0.884</td>
</tr>
<tr id="S4.T2.7.7.12.4" class="ltx_tr">
<th id="S4.T2.7.7.12.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">④feature alignment + element-wise addition</th>
<td id="S4.T2.7.7.12.4.2" class="ltx_td ltx_align_center">0.856</td>
<td id="S4.T2.7.7.12.4.3" class="ltx_td ltx_align_center">0.761</td>
<td id="S4.T2.7.7.12.4.4" class="ltx_td ltx_align_center">0.025</td>
<td id="S4.T2.7.7.12.4.5" class="ltx_td ltx_align_center">0.909</td>
</tr>
<tr id="S4.T2.7.7.13.5" class="ltx_tr">
<th id="S4.T2.7.7.13.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">⑤feature alignment + RBQ</th>
<td id="S4.T2.7.7.13.5.2" class="ltx_td ltx_align_center">0.874</td>
<td id="S4.T2.7.7.13.5.3" class="ltx_td ltx_align_center">0.799</td>
<td id="S4.T2.7.7.13.5.4" class="ltx_td ltx_align_center">0.022</td>
<td id="S4.T2.7.7.13.5.5" class="ltx_td ltx_align_center">0.924</td>
</tr>
<tr id="S4.T2.7.7.14.6" class="ltx_tr" style="background-color:#E0FFFF;">
<th id="S4.T2.7.7.14.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r"><span id="S4.T2.7.7.14.6.1.1" class="ltx_text" style="background-color:#E0FFFF;">⑥feature alignment + RBQ + SAL</span></th>
<td id="S4.T2.7.7.14.6.2" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T2.7.7.14.6.2.1" class="ltx_text" style="background-color:#E0FFFF;">0.882</span></td>
<td id="S4.T2.7.7.14.6.3" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T2.7.7.14.6.3.1" class="ltx_text" style="background-color:#E0FFFF;">0.801</span></td>
<td id="S4.T2.7.7.14.6.4" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T2.7.7.14.6.4.1" class="ltx_text" style="background-color:#E0FFFF;">0.021</span></td>
<td id="S4.T2.7.7.14.6.5" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T2.7.7.14.6.5.1" class="ltx_text" style="background-color:#E0FFFF;">0.930</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S4.T3" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S4.T3.9.1.1" class="ltx_text" style="font-size:90%;">Table 3</span>: </span><span id="S4.T3.10.2" class="ltx_text" style="font-size:90%;">Ablation study on RBQ</span></figcaption>
<div id="S4.T3.7" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:157.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(68.1pt,-24.7pt) scale(1.45795194980549,1.45795194980549) ;">
<table id="S4.T3.7.7" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T3.7.7.8.1" class="ltx_tr">
<th id="S4.T3.7.7.8.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" rowspan="2"><span id="S4.T3.7.7.8.1.1.1" class="ltx_text">Window Size</span></th>
<th id="S4.T3.7.7.8.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="4">COD10K</th>
</tr>
<tr id="S4.T3.7.7.7" class="ltx_tr">
<th id="S4.T3.2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">S<sub id="S4.T3.2.2.2.2.1" class="ltx_sub"><span id="S4.T3.2.2.2.2.1.1" class="ltx_text ltx_font_italic">m</span></sub> <math id="S4.T3.2.2.2.2.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S4.T3.2.2.2.2.m2.1a"><mo stretchy="false" id="S4.T3.2.2.2.2.m2.1.1" xref="S4.T3.2.2.2.2.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T3.2.2.2.2.m2.1b"><ci id="S4.T3.2.2.2.2.m2.1.1.cmml" xref="S4.T3.2.2.2.2.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.2.2.2.2.m2.1c">\uparrow</annotation></semantics></math>
</th>
<th id="S4.T3.4.4.4.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">F<math id="S4.T3.3.3.3.3.m1.1" class="ltx_Math" alttext="{}^{\omega}_{\beta}" display="inline"><semantics id="S4.T3.3.3.3.3.m1.1a"><mmultiscripts id="S4.T3.3.3.3.3.m1.1.1" xref="S4.T3.3.3.3.3.m1.1.1.cmml"><mi id="S4.T3.3.3.3.3.m1.1.1.2.2" xref="S4.T3.3.3.3.3.m1.1.1.2.2.cmml"></mi><mprescripts id="S4.T3.3.3.3.3.m1.1.1a" xref="S4.T3.3.3.3.3.m1.1.1.cmml"></mprescripts><mi id="S4.T3.3.3.3.3.m1.1.1.3" xref="S4.T3.3.3.3.3.m1.1.1.3.cmml">β</mi><mrow id="S4.T3.3.3.3.3.m1.1.1b" xref="S4.T3.3.3.3.3.m1.1.1.cmml"></mrow><mrow id="S4.T3.3.3.3.3.m1.1.1c" xref="S4.T3.3.3.3.3.m1.1.1.cmml"></mrow><mi id="S4.T3.3.3.3.3.m1.1.1.2.3" xref="S4.T3.3.3.3.3.m1.1.1.2.3.cmml">ω</mi></mmultiscripts><annotation-xml encoding="MathML-Content" id="S4.T3.3.3.3.3.m1.1b"><apply id="S4.T3.3.3.3.3.m1.1.1.cmml" xref="S4.T3.3.3.3.3.m1.1.1"><csymbol cd="ambiguous" id="S4.T3.3.3.3.3.m1.1.1.1.cmml" xref="S4.T3.3.3.3.3.m1.1.1">subscript</csymbol><apply id="S4.T3.3.3.3.3.m1.1.1.2.cmml" xref="S4.T3.3.3.3.3.m1.1.1"><csymbol cd="ambiguous" id="S4.T3.3.3.3.3.m1.1.1.2.1.cmml" xref="S4.T3.3.3.3.3.m1.1.1">superscript</csymbol><csymbol cd="latexml" id="S4.T3.3.3.3.3.m1.1.1.2.2.cmml" xref="S4.T3.3.3.3.3.m1.1.1.2.2">absent</csymbol><ci id="S4.T3.3.3.3.3.m1.1.1.2.3.cmml" xref="S4.T3.3.3.3.3.m1.1.1.2.3">𝜔</ci></apply><ci id="S4.T3.3.3.3.3.m1.1.1.3.cmml" xref="S4.T3.3.3.3.3.m1.1.1.3">𝛽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.3.3.3.3.m1.1c">{}^{\omega}_{\beta}</annotation></semantics></math> <math id="S4.T3.4.4.4.4.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S4.T3.4.4.4.4.m2.1a"><mo stretchy="false" id="S4.T3.4.4.4.4.m2.1.1" xref="S4.T3.4.4.4.4.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T3.4.4.4.4.m2.1b"><ci id="S4.T3.4.4.4.4.m2.1.1.cmml" xref="S4.T3.4.4.4.4.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.4.4.4.4.m2.1c">\uparrow</annotation></semantics></math>
</th>
<th id="S4.T3.5.5.5.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">MAE <math id="S4.T3.5.5.5.5.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S4.T3.5.5.5.5.m1.1a"><mo stretchy="false" id="S4.T3.5.5.5.5.m1.1.1" xref="S4.T3.5.5.5.5.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T3.5.5.5.5.m1.1b"><ci id="S4.T3.5.5.5.5.m1.1.1.cmml" xref="S4.T3.5.5.5.5.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.5.5.5.5.m1.1c">\downarrow</annotation></semantics></math>
</th>
<th id="S4.T3.7.7.7.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">E<sub id="S4.T3.7.7.7.7.1" class="ltx_sub"><span id="S4.T3.7.7.7.7.1.1" class="ltx_text ltx_font_italic">m</span></sub> <math id="S4.T3.7.7.7.7.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S4.T3.7.7.7.7.m2.1a"><mo stretchy="false" id="S4.T3.7.7.7.7.m2.1.1" xref="S4.T3.7.7.7.7.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T3.7.7.7.7.m2.1b"><ci id="S4.T3.7.7.7.7.m2.1.1.cmml" xref="S4.T3.7.7.7.7.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.7.7.7.7.m2.1c">\uparrow</annotation></semantics></math>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T3.7.7.9.1" class="ltx_tr">
<th id="S4.T3.7.7.9.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt">element-wise addition</th>
<td id="S4.T3.7.7.9.1.2" class="ltx_td ltx_align_center ltx_border_tt">0.856</td>
<td id="S4.T3.7.7.9.1.3" class="ltx_td ltx_align_center ltx_border_tt">0.761</td>
<td id="S4.T3.7.7.9.1.4" class="ltx_td ltx_align_center ltx_border_tt">0.025</td>
<td id="S4.T3.7.7.9.1.5" class="ltx_td ltx_align_center ltx_border_tt">0.909</td>
</tr>
<tr id="S4.T3.7.7.10.2" class="ltx_tr">
<th id="S4.T3.7.7.10.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">element-wise multiply</th>
<td id="S4.T3.7.7.10.2.2" class="ltx_td ltx_align_center">0.858</td>
<td id="S4.T3.7.7.10.2.3" class="ltx_td ltx_align_center">0.758</td>
<td id="S4.T3.7.7.10.2.4" class="ltx_td ltx_align_center">0.025</td>
<td id="S4.T3.7.7.10.2.5" class="ltx_td ltx_align_center">0.913</td>
</tr>
<tr id="S4.T3.7.7.11.3" class="ltx_tr">
<th id="S4.T3.7.7.11.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">feature concatenation</th>
<td id="S4.T3.7.7.11.3.2" class="ltx_td ltx_align_center">0.847</td>
<td id="S4.T3.7.7.11.3.3" class="ltx_td ltx_align_center">0.755</td>
<td id="S4.T3.7.7.11.3.4" class="ltx_td ltx_align_center">0.026</td>
<td id="S4.T3.7.7.11.3.5" class="ltx_td ltx_align_center">0.904</td>
</tr>
<tr id="S4.T3.7.7.12.4" class="ltx_tr" style="background-color:#E0FFFF;">
<th id="S4.T3.7.7.12.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r"><span id="S4.T3.7.7.12.4.1.1" class="ltx_text" style="background-color:#E0FFFF;">window-based attention (RBQ)</span></th>
<td id="S4.T3.7.7.12.4.2" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T3.7.7.12.4.2.1" class="ltx_text" style="background-color:#E0FFFF;">0.882</span></td>
<td id="S4.T3.7.7.12.4.3" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T3.7.7.12.4.3.1" class="ltx_text" style="background-color:#E0FFFF;">0.801</span></td>
<td id="S4.T3.7.7.12.4.4" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T3.7.7.12.4.4.1" class="ltx_text" style="background-color:#E0FFFF;">0.021</span></td>
<td id="S4.T3.7.7.12.4.5" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T3.7.7.12.4.5.1" class="ltx_text" style="background-color:#E0FFFF;">0.930</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="S4.SS3.p4" class="ltx_para ltx_noindent">
<p id="S4.SS3.p4.1" class="ltx_p"><span id="S4.SS3.p4.1.1" class="ltx_text ltx_font_bold">The positioin of RBQ</span>
To investigate the impact of RBQ position on the COD performance, we conduct a series of experiments implementing RBQ in different stages of ResNet. As shown in <a href="#S4.T4" title="In 4.3 Model Evaluation and Analyses ‣ 4 Experiments ‣ DQnet: Cross-Model Detail Querying for Camouflaged Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">4</span></a>, starting with only enhancing the last stage of ResNet, the performance gradually improves as the number of enhanced stage increase until reaching the best, where all ResNet stages are enhanced with RBQ. This demonstrates the excellent scalability of the proposed RBQ module, which is capable of querying useful local details in different scales.</p>
</div>
<div id="S4.SS3.p5" class="ltx_para ltx_noindent">
<p id="S4.SS3.p5.1" class="ltx_p"><span id="S4.SS3.p5.1.1" class="ltx_text ltx_font_bold">Window based attention in RBQ</span>
In <a href="#S4.T5" title="In 4.3 Model Evaluation and Analyses ‣ 4 Experiments ‣ DQnet: Cross-Model Detail Querying for Camouflaged Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">5</span></a>, we show the effects of different window sizes in the proposed RBQ.
It can be seen from the results that the best performance appears when the window size is equal to 4. Also, it achieves a good balance between performance and efficiency. When replacing the window-based attention with full attention, the performance would decline to some extent. This is because that indiscriminately modelling pixel-wise relations aggravates the already tense object-background ambiguity and thus hinders querying fine-grained details. This validates the rationality of our design to perform details querying by focusing on spatially neighboring elements.</p>
</div>
<figure id="S4.T4" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S4.T4.9.1.1" class="ltx_text" style="font-size:90%;">Table 4</span>: </span><span id="S4.T4.10.2" class="ltx_text" style="font-size:90%;">Performance with different position of RBQ. </span></figcaption>
<div id="S4.T4.7" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:150.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(61.0pt,-21.1pt) scale(1.39116759950584,1.39116759950584) ;">
<table id="S4.T4.7.7" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T4.7.7.8.1" class="ltx_tr">
<th id="S4.T4.7.7.8.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" rowspan="2"><span id="S4.T4.7.7.8.1.1.1" class="ltx_text">Stage1</span></th>
<th id="S4.T4.7.7.8.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" rowspan="2"><span id="S4.T4.7.7.8.1.2.1" class="ltx_text">Stage2</span></th>
<th id="S4.T4.7.7.8.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" rowspan="2"><span id="S4.T4.7.7.8.1.3.1" class="ltx_text">Stage3</span></th>
<th id="S4.T4.7.7.8.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" rowspan="2"><span id="S4.T4.7.7.8.1.4.1" class="ltx_text">Stage4</span></th>
<th id="S4.T4.7.7.8.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="4">COD-10K</th>
</tr>
<tr id="S4.T4.7.7.7" class="ltx_tr">
<th id="S4.T4.2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">S<sub id="S4.T4.2.2.2.2.1" class="ltx_sub"><span id="S4.T4.2.2.2.2.1.1" class="ltx_text ltx_font_italic">m</span></sub> <math id="S4.T4.2.2.2.2.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S4.T4.2.2.2.2.m2.1a"><mo stretchy="false" id="S4.T4.2.2.2.2.m2.1.1" xref="S4.T4.2.2.2.2.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T4.2.2.2.2.m2.1b"><ci id="S4.T4.2.2.2.2.m2.1.1.cmml" xref="S4.T4.2.2.2.2.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.2.2.2.2.m2.1c">\uparrow</annotation></semantics></math>
</th>
<th id="S4.T4.4.4.4.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">F<math id="S4.T4.3.3.3.3.m1.1" class="ltx_Math" alttext="{}^{\omega}_{\beta}" display="inline"><semantics id="S4.T4.3.3.3.3.m1.1a"><mmultiscripts id="S4.T4.3.3.3.3.m1.1.1" xref="S4.T4.3.3.3.3.m1.1.1.cmml"><mi id="S4.T4.3.3.3.3.m1.1.1.2.2" xref="S4.T4.3.3.3.3.m1.1.1.2.2.cmml"></mi><mprescripts id="S4.T4.3.3.3.3.m1.1.1a" xref="S4.T4.3.3.3.3.m1.1.1.cmml"></mprescripts><mi id="S4.T4.3.3.3.3.m1.1.1.3" xref="S4.T4.3.3.3.3.m1.1.1.3.cmml">β</mi><mrow id="S4.T4.3.3.3.3.m1.1.1b" xref="S4.T4.3.3.3.3.m1.1.1.cmml"></mrow><mrow id="S4.T4.3.3.3.3.m1.1.1c" xref="S4.T4.3.3.3.3.m1.1.1.cmml"></mrow><mi id="S4.T4.3.3.3.3.m1.1.1.2.3" xref="S4.T4.3.3.3.3.m1.1.1.2.3.cmml">ω</mi></mmultiscripts><annotation-xml encoding="MathML-Content" id="S4.T4.3.3.3.3.m1.1b"><apply id="S4.T4.3.3.3.3.m1.1.1.cmml" xref="S4.T4.3.3.3.3.m1.1.1"><csymbol cd="ambiguous" id="S4.T4.3.3.3.3.m1.1.1.1.cmml" xref="S4.T4.3.3.3.3.m1.1.1">subscript</csymbol><apply id="S4.T4.3.3.3.3.m1.1.1.2.cmml" xref="S4.T4.3.3.3.3.m1.1.1"><csymbol cd="ambiguous" id="S4.T4.3.3.3.3.m1.1.1.2.1.cmml" xref="S4.T4.3.3.3.3.m1.1.1">superscript</csymbol><csymbol cd="latexml" id="S4.T4.3.3.3.3.m1.1.1.2.2.cmml" xref="S4.T4.3.3.3.3.m1.1.1.2.2">absent</csymbol><ci id="S4.T4.3.3.3.3.m1.1.1.2.3.cmml" xref="S4.T4.3.3.3.3.m1.1.1.2.3">𝜔</ci></apply><ci id="S4.T4.3.3.3.3.m1.1.1.3.cmml" xref="S4.T4.3.3.3.3.m1.1.1.3">𝛽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.3.3.3.3.m1.1c">{}^{\omega}_{\beta}</annotation></semantics></math> <math id="S4.T4.4.4.4.4.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S4.T4.4.4.4.4.m2.1a"><mo stretchy="false" id="S4.T4.4.4.4.4.m2.1.1" xref="S4.T4.4.4.4.4.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T4.4.4.4.4.m2.1b"><ci id="S4.T4.4.4.4.4.m2.1.1.cmml" xref="S4.T4.4.4.4.4.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.4.4.4.4.m2.1c">\uparrow</annotation></semantics></math>
</th>
<th id="S4.T4.5.5.5.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">MAE <math id="S4.T4.5.5.5.5.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S4.T4.5.5.5.5.m1.1a"><mo stretchy="false" id="S4.T4.5.5.5.5.m1.1.1" xref="S4.T4.5.5.5.5.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T4.5.5.5.5.m1.1b"><ci id="S4.T4.5.5.5.5.m1.1.1.cmml" xref="S4.T4.5.5.5.5.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.5.5.5.5.m1.1c">\downarrow</annotation></semantics></math>
</th>
<th id="S4.T4.7.7.7.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">E<sub id="S4.T4.7.7.7.7.1" class="ltx_sub"><span id="S4.T4.7.7.7.7.1.1" class="ltx_text ltx_font_italic">m</span></sub> <math id="S4.T4.7.7.7.7.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S4.T4.7.7.7.7.m2.1a"><mo stretchy="false" id="S4.T4.7.7.7.7.m2.1.1" xref="S4.T4.7.7.7.7.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T4.7.7.7.7.m2.1b"><ci id="S4.T4.7.7.7.7.m2.1.1.cmml" xref="S4.T4.7.7.7.7.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.7.7.7.7.m2.1c">\uparrow</annotation></semantics></math>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T4.7.7.9.1" class="ltx_tr">
<th id="S4.T4.7.7.9.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt">—</th>
<th id="S4.T4.7.7.9.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt">—</th>
<th id="S4.T4.7.7.9.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt">—</th>
<th id="S4.T4.7.7.9.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt">✓</th>
<td id="S4.T4.7.7.9.1.5" class="ltx_td ltx_align_center ltx_border_tt">0.868</td>
<td id="S4.T4.7.7.9.1.6" class="ltx_td ltx_align_center ltx_border_tt">0.784</td>
<td id="S4.T4.7.7.9.1.7" class="ltx_td ltx_align_center ltx_border_tt">0.023</td>
<td id="S4.T4.7.7.9.1.8" class="ltx_td ltx_align_center ltx_border_tt">0.920</td>
</tr>
<tr id="S4.T4.7.7.10.2" class="ltx_tr">
<th id="S4.T4.7.7.10.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">—</th>
<th id="S4.T4.7.7.10.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">—</th>
<th id="S4.T4.7.7.10.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">✓</th>
<th id="S4.T4.7.7.10.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">✓</th>
<td id="S4.T4.7.7.10.2.5" class="ltx_td ltx_align_center">0.874</td>
<td id="S4.T4.7.7.10.2.6" class="ltx_td ltx_align_center">0.791</td>
<td id="S4.T4.7.7.10.2.7" class="ltx_td ltx_align_center">0.022</td>
<td id="S4.T4.7.7.10.2.8" class="ltx_td ltx_align_center">0.924</td>
</tr>
<tr id="S4.T4.7.7.11.3" class="ltx_tr">
<th id="S4.T4.7.7.11.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">—</th>
<th id="S4.T4.7.7.11.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">✓</th>
<th id="S4.T4.7.7.11.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">✓</th>
<th id="S4.T4.7.7.11.3.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">✓</th>
<td id="S4.T4.7.7.11.3.5" class="ltx_td ltx_align_center">0.880</td>
<td id="S4.T4.7.7.11.3.6" class="ltx_td ltx_align_center">0.797</td>
<td id="S4.T4.7.7.11.3.7" class="ltx_td ltx_align_center">0.021</td>
<td id="S4.T4.7.7.11.3.8" class="ltx_td ltx_align_center">0.926</td>
</tr>
<tr id="S4.T4.7.7.12.4" class="ltx_tr" style="background-color:#E0FFFF;">
<th id="S4.T4.7.7.12.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r"><span id="S4.T4.7.7.12.4.1.1" class="ltx_text" style="background-color:#E0FFFF;">✓</span></th>
<th id="S4.T4.7.7.12.4.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r"><span id="S4.T4.7.7.12.4.2.1" class="ltx_text" style="background-color:#E0FFFF;">✓</span></th>
<th id="S4.T4.7.7.12.4.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r"><span id="S4.T4.7.7.12.4.3.1" class="ltx_text" style="background-color:#E0FFFF;">✓</span></th>
<th id="S4.T4.7.7.12.4.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r"><span id="S4.T4.7.7.12.4.4.1" class="ltx_text" style="background-color:#E0FFFF;">✓</span></th>
<td id="S4.T4.7.7.12.4.5" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T4.7.7.12.4.5.1" class="ltx_text" style="background-color:#E0FFFF;">0.882</span></td>
<td id="S4.T4.7.7.12.4.6" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T4.7.7.12.4.6.1" class="ltx_text" style="background-color:#E0FFFF;">0.801</span></td>
<td id="S4.T4.7.7.12.4.7" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T4.7.7.12.4.7.1" class="ltx_text" style="background-color:#E0FFFF;">0.021</span></td>
<td id="S4.T4.7.7.12.4.8" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T4.7.7.12.4.8.1" class="ltx_text" style="background-color:#E0FFFF;">0.930</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S4.T5" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S4.T5.9.1.1" class="ltx_text" style="font-size:90%;">Table 5</span>: </span><span id="S4.T5.10.2" class="ltx_text" style="font-size:90%;">Ablation study on window size</span></figcaption>
<div id="S4.T5.7" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:246.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(74.2pt,-42.1pt) scale(1.52028561835651,1.52028561835651) ;">
<table id="S4.T5.7.7" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T5.7.7.8.1" class="ltx_tr">
<th id="S4.T5.7.7.8.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" rowspan="2"><span id="S4.T5.7.7.8.1.1.1" class="ltx_text">Window Size</span></th>
<th id="S4.T5.7.7.8.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" rowspan="2"><span id="S4.T5.7.7.8.1.2.1" class="ltx_text">Memory (M)</span></th>
<th id="S4.T5.7.7.8.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="4">COD10K</th>
</tr>
<tr id="S4.T5.7.7.7" class="ltx_tr">
<th id="S4.T5.2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">S<sub id="S4.T5.2.2.2.2.1" class="ltx_sub"><span id="S4.T5.2.2.2.2.1.1" class="ltx_text ltx_font_italic">m</span></sub> <math id="S4.T5.2.2.2.2.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S4.T5.2.2.2.2.m2.1a"><mo stretchy="false" id="S4.T5.2.2.2.2.m2.1.1" xref="S4.T5.2.2.2.2.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T5.2.2.2.2.m2.1b"><ci id="S4.T5.2.2.2.2.m2.1.1.cmml" xref="S4.T5.2.2.2.2.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.2.2.2.2.m2.1c">\uparrow</annotation></semantics></math>
</th>
<th id="S4.T5.4.4.4.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">F<math id="S4.T5.3.3.3.3.m1.1" class="ltx_Math" alttext="{}^{\omega}_{\beta}" display="inline"><semantics id="S4.T5.3.3.3.3.m1.1a"><mmultiscripts id="S4.T5.3.3.3.3.m1.1.1" xref="S4.T5.3.3.3.3.m1.1.1.cmml"><mi id="S4.T5.3.3.3.3.m1.1.1.2.2" xref="S4.T5.3.3.3.3.m1.1.1.2.2.cmml"></mi><mprescripts id="S4.T5.3.3.3.3.m1.1.1a" xref="S4.T5.3.3.3.3.m1.1.1.cmml"></mprescripts><mi id="S4.T5.3.3.3.3.m1.1.1.3" xref="S4.T5.3.3.3.3.m1.1.1.3.cmml">β</mi><mrow id="S4.T5.3.3.3.3.m1.1.1b" xref="S4.T5.3.3.3.3.m1.1.1.cmml"></mrow><mrow id="S4.T5.3.3.3.3.m1.1.1c" xref="S4.T5.3.3.3.3.m1.1.1.cmml"></mrow><mi id="S4.T5.3.3.3.3.m1.1.1.2.3" xref="S4.T5.3.3.3.3.m1.1.1.2.3.cmml">ω</mi></mmultiscripts><annotation-xml encoding="MathML-Content" id="S4.T5.3.3.3.3.m1.1b"><apply id="S4.T5.3.3.3.3.m1.1.1.cmml" xref="S4.T5.3.3.3.3.m1.1.1"><csymbol cd="ambiguous" id="S4.T5.3.3.3.3.m1.1.1.1.cmml" xref="S4.T5.3.3.3.3.m1.1.1">subscript</csymbol><apply id="S4.T5.3.3.3.3.m1.1.1.2.cmml" xref="S4.T5.3.3.3.3.m1.1.1"><csymbol cd="ambiguous" id="S4.T5.3.3.3.3.m1.1.1.2.1.cmml" xref="S4.T5.3.3.3.3.m1.1.1">superscript</csymbol><csymbol cd="latexml" id="S4.T5.3.3.3.3.m1.1.1.2.2.cmml" xref="S4.T5.3.3.3.3.m1.1.1.2.2">absent</csymbol><ci id="S4.T5.3.3.3.3.m1.1.1.2.3.cmml" xref="S4.T5.3.3.3.3.m1.1.1.2.3">𝜔</ci></apply><ci id="S4.T5.3.3.3.3.m1.1.1.3.cmml" xref="S4.T5.3.3.3.3.m1.1.1.3">𝛽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.3.3.3.3.m1.1c">{}^{\omega}_{\beta}</annotation></semantics></math> <math id="S4.T5.4.4.4.4.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S4.T5.4.4.4.4.m2.1a"><mo stretchy="false" id="S4.T5.4.4.4.4.m2.1.1" xref="S4.T5.4.4.4.4.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T5.4.4.4.4.m2.1b"><ci id="S4.T5.4.4.4.4.m2.1.1.cmml" xref="S4.T5.4.4.4.4.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.4.4.4.4.m2.1c">\uparrow</annotation></semantics></math>
</th>
<th id="S4.T5.5.5.5.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">MAE <math id="S4.T5.5.5.5.5.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S4.T5.5.5.5.5.m1.1a"><mo stretchy="false" id="S4.T5.5.5.5.5.m1.1.1" xref="S4.T5.5.5.5.5.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T5.5.5.5.5.m1.1b"><ci id="S4.T5.5.5.5.5.m1.1.1.cmml" xref="S4.T5.5.5.5.5.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.5.5.5.5.m1.1c">\downarrow</annotation></semantics></math>
</th>
<th id="S4.T5.7.7.7.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">E<sub id="S4.T5.7.7.7.7.1" class="ltx_sub"><span id="S4.T5.7.7.7.7.1.1" class="ltx_text ltx_font_italic">m</span></sub> <math id="S4.T5.7.7.7.7.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S4.T5.7.7.7.7.m2.1a"><mo stretchy="false" id="S4.T5.7.7.7.7.m2.1.1" xref="S4.T5.7.7.7.7.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T5.7.7.7.7.m2.1b"><ci id="S4.T5.7.7.7.7.m2.1.1.cmml" xref="S4.T5.7.7.7.7.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.7.7.7.7.m2.1c">\uparrow</annotation></semantics></math>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T5.7.7.9.1" class="ltx_tr">
<th id="S4.T5.7.7.9.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt">1</th>
<th id="S4.T5.7.7.9.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt">0.48</th>
<td id="S4.T5.7.7.9.1.3" class="ltx_td ltx_align_center ltx_border_tt">0.880</td>
<td id="S4.T5.7.7.9.1.4" class="ltx_td ltx_align_center ltx_border_tt">0.799</td>
<td id="S4.T5.7.7.9.1.5" class="ltx_td ltx_align_center ltx_border_tt">0.022</td>
<td id="S4.T5.7.7.9.1.6" class="ltx_td ltx_align_center ltx_border_tt">0.925</td>
</tr>
<tr id="S4.T5.7.7.10.2" class="ltx_tr">
<th id="S4.T5.7.7.10.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">2</th>
<th id="S4.T5.7.7.10.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">2.00</th>
<td id="S4.T5.7.7.10.2.3" class="ltx_td ltx_align_center">0.880</td>
<td id="S4.T5.7.7.10.2.4" class="ltx_td ltx_align_center">0.799</td>
<td id="S4.T5.7.7.10.2.5" class="ltx_td ltx_align_center">0.022</td>
<td id="S4.T5.7.7.10.2.6" class="ltx_td ltx_align_center">0.925</td>
</tr>
<tr id="S4.T5.7.7.11.3" class="ltx_tr" style="background-color:#E0FFFF;">
<th id="S4.T5.7.7.11.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><span id="S4.T5.7.7.11.3.1.1" class="ltx_text" style="background-color:#E0FFFF;">4</span></th>
<th id="S4.T5.7.7.11.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><span id="S4.T5.7.7.11.3.2.1" class="ltx_text" style="background-color:#E0FFFF;">9.52</span></th>
<td id="S4.T5.7.7.11.3.3" class="ltx_td ltx_align_center"><span id="S4.T5.7.7.11.3.3.1" class="ltx_text" style="background-color:#E0FFFF;">0.882</span></td>
<td id="S4.T5.7.7.11.3.4" class="ltx_td ltx_align_center"><span id="S4.T5.7.7.11.3.4.1" class="ltx_text" style="background-color:#E0FFFF;">0.801</span></td>
<td id="S4.T5.7.7.11.3.5" class="ltx_td ltx_align_center"><span id="S4.T5.7.7.11.3.5.1" class="ltx_text" style="background-color:#E0FFFF;">0.021</span></td>
<td id="S4.T5.7.7.11.3.6" class="ltx_td ltx_align_center"><span id="S4.T5.7.7.11.3.6.1" class="ltx_text" style="background-color:#E0FFFF;">0.930</span></td>
</tr>
<tr id="S4.T5.7.7.12.4" class="ltx_tr">
<th id="S4.T5.7.7.12.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">6</th>
<th id="S4.T5.7.7.12.4.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">27.01</th>
<td id="S4.T5.7.7.12.4.3" class="ltx_td ltx_align_center">0.880</td>
<td id="S4.T5.7.7.12.4.4" class="ltx_td ltx_align_center">0.798</td>
<td id="S4.T5.7.7.12.4.5" class="ltx_td ltx_align_center">0.022</td>
<td id="S4.T5.7.7.12.4.6" class="ltx_td ltx_align_center">0.926</td>
</tr>
<tr id="S4.T5.7.7.13.5" class="ltx_tr">
<th id="S4.T5.7.7.13.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">8</th>
<th id="S4.T5.7.7.13.5.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">62.43</th>
<td id="S4.T5.7.7.13.5.3" class="ltx_td ltx_align_center">0.876</td>
<td id="S4.T5.7.7.13.5.4" class="ltx_td ltx_align_center">0.793</td>
<td id="S4.T5.7.7.13.5.5" class="ltx_td ltx_align_center">0.023</td>
<td id="S4.T5.7.7.13.5.6" class="ltx_td ltx_align_center">0.922</td>
</tr>
<tr id="S4.T5.7.7.14.6" class="ltx_tr">
<th id="S4.T5.7.7.14.6.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">10</th>
<th id="S4.T5.7.7.14.6.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">127.08</th>
<td id="S4.T5.7.7.14.6.3" class="ltx_td ltx_align_center">0.872</td>
<td id="S4.T5.7.7.14.6.4" class="ltx_td ltx_align_center">0.789</td>
<td id="S4.T5.7.7.14.6.5" class="ltx_td ltx_align_center">0.023</td>
<td id="S4.T5.7.7.14.6.6" class="ltx_td ltx_align_center">0.920</td>
</tr>
<tr id="S4.T5.7.7.15.7" class="ltx_tr">
<th id="S4.T5.7.7.15.7.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t">full</th>
<th id="S4.T5.7.7.15.7.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t">195.04</th>
<td id="S4.T5.7.7.15.7.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">0.871</td>
<td id="S4.T5.7.7.15.7.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">0.788</td>
<td id="S4.T5.7.7.15.7.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">0.023</td>
<td id="S4.T5.7.7.15.7.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">0.917</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this paper, we propose the cross-model detail querying network (DQnet) for COD. DQnet takes full advantage of the cascaded self-attention mechanism in the visual transformer for long-range feature dependency extraction and object extent localization, as well as the local convolution mechanism in CNN for fine-grained details extraction.
We propose the relation-based querying (RBQ) module to distill fine-grained details crucial for COD while disgrading the noisy part. Experiments on four widely-used benchmarks show that DQnet significantly improves the COD performance. As the first and solid COD baseline with cross-model framework, DQnet provides a fresh insight to the challenging COD problem by re-focusing on the feature extractor design. This makes our method compatible with COD decoder developments along various directions that are not necessarily limited by effective feature fusion, feature refinement, and auxiliary tasks design.</p>
</div>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Model Details</h2>

<section id="S6.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.1 </span>Decoder Framework</h3>

<div id="S6.SS1.p1" class="ltx_para">
<p id="S6.SS1.p1.1" class="ltx_p">The decoder networks of our models follow the same framework as shown in <a href="#S6.F6" title="In 6.1 Decoder Framework ‣ 6 Model Details ‣ DQnet: Cross-Model Detail Querying for Camouflaged Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">6</span></a>.</p>
</div>
<div id="S6.SS1.p2" class="ltx_para ltx_noindent">
<p id="S6.SS1.p2.4" class="ltx_p"><span id="S6.SS1.p2.4.1" class="ltx_text ltx_font_bold">Main Decoder</span>
For the main experiment, we choose ResNet-50 and ViT-B as feature extractors. For Resnet-50 encoder, the top layer feature is noisy and acounts for large memory overhead, thus we choose four features maps remained after enhancement denoted as <math id="S6.SS1.p2.1.m1.6" class="ltx_Math" alttext="\left\{\bm{B}_{i}|i=2,3,4,5\right\}" display="inline"><semantics id="S6.SS1.p2.1.m1.6a"><mrow id="S6.SS1.p2.1.m1.6.6.2" xref="S6.SS1.p2.1.m1.6.6.3.cmml"><mo id="S6.SS1.p2.1.m1.6.6.2.3" xref="S6.SS1.p2.1.m1.6.6.3.1.cmml">{</mo><msub id="S6.SS1.p2.1.m1.5.5.1.1" xref="S6.SS1.p2.1.m1.5.5.1.1.cmml"><mi id="S6.SS1.p2.1.m1.5.5.1.1.2" xref="S6.SS1.p2.1.m1.5.5.1.1.2.cmml">𝑩</mi><mi id="S6.SS1.p2.1.m1.5.5.1.1.3" xref="S6.SS1.p2.1.m1.5.5.1.1.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S6.SS1.p2.1.m1.6.6.2.4" xref="S6.SS1.p2.1.m1.6.6.3.1.cmml">|</mo><mrow id="S6.SS1.p2.1.m1.6.6.2.2" xref="S6.SS1.p2.1.m1.6.6.2.2.cmml"><mi id="S6.SS1.p2.1.m1.6.6.2.2.2" xref="S6.SS1.p2.1.m1.6.6.2.2.2.cmml">i</mi><mo id="S6.SS1.p2.1.m1.6.6.2.2.1" xref="S6.SS1.p2.1.m1.6.6.2.2.1.cmml">=</mo><mrow id="S6.SS1.p2.1.m1.6.6.2.2.3.2" xref="S6.SS1.p2.1.m1.6.6.2.2.3.1.cmml"><mn id="S6.SS1.p2.1.m1.1.1" xref="S6.SS1.p2.1.m1.1.1.cmml">2</mn><mo id="S6.SS1.p2.1.m1.6.6.2.2.3.2.1" xref="S6.SS1.p2.1.m1.6.6.2.2.3.1.cmml">,</mo><mn id="S6.SS1.p2.1.m1.2.2" xref="S6.SS1.p2.1.m1.2.2.cmml">3</mn><mo id="S6.SS1.p2.1.m1.6.6.2.2.3.2.2" xref="S6.SS1.p2.1.m1.6.6.2.2.3.1.cmml">,</mo><mn id="S6.SS1.p2.1.m1.3.3" xref="S6.SS1.p2.1.m1.3.3.cmml">4</mn><mo id="S6.SS1.p2.1.m1.6.6.2.2.3.2.3" xref="S6.SS1.p2.1.m1.6.6.2.2.3.1.cmml">,</mo><mn id="S6.SS1.p2.1.m1.4.4" xref="S6.SS1.p2.1.m1.4.4.cmml">5</mn></mrow></mrow><mo id="S6.SS1.p2.1.m1.6.6.2.5" xref="S6.SS1.p2.1.m1.6.6.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.1.m1.6b"><apply id="S6.SS1.p2.1.m1.6.6.3.cmml" xref="S6.SS1.p2.1.m1.6.6.2"><csymbol cd="latexml" id="S6.SS1.p2.1.m1.6.6.3.1.cmml" xref="S6.SS1.p2.1.m1.6.6.2.3">conditional-set</csymbol><apply id="S6.SS1.p2.1.m1.5.5.1.1.cmml" xref="S6.SS1.p2.1.m1.5.5.1.1"><csymbol cd="ambiguous" id="S6.SS1.p2.1.m1.5.5.1.1.1.cmml" xref="S6.SS1.p2.1.m1.5.5.1.1">subscript</csymbol><ci id="S6.SS1.p2.1.m1.5.5.1.1.2.cmml" xref="S6.SS1.p2.1.m1.5.5.1.1.2">𝑩</ci><ci id="S6.SS1.p2.1.m1.5.5.1.1.3.cmml" xref="S6.SS1.p2.1.m1.5.5.1.1.3">𝑖</ci></apply><apply id="S6.SS1.p2.1.m1.6.6.2.2.cmml" xref="S6.SS1.p2.1.m1.6.6.2.2"><eq id="S6.SS1.p2.1.m1.6.6.2.2.1.cmml" xref="S6.SS1.p2.1.m1.6.6.2.2.1"></eq><ci id="S6.SS1.p2.1.m1.6.6.2.2.2.cmml" xref="S6.SS1.p2.1.m1.6.6.2.2.2">𝑖</ci><list id="S6.SS1.p2.1.m1.6.6.2.2.3.1.cmml" xref="S6.SS1.p2.1.m1.6.6.2.2.3.2"><cn type="integer" id="S6.SS1.p2.1.m1.1.1.cmml" xref="S6.SS1.p2.1.m1.1.1">2</cn><cn type="integer" id="S6.SS1.p2.1.m1.2.2.cmml" xref="S6.SS1.p2.1.m1.2.2">3</cn><cn type="integer" id="S6.SS1.p2.1.m1.3.3.cmml" xref="S6.SS1.p2.1.m1.3.3">4</cn><cn type="integer" id="S6.SS1.p2.1.m1.4.4.cmml" xref="S6.SS1.p2.1.m1.4.4">5</cn></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.1.m1.6c">\left\{\bm{B}_{i}|i=2,3,4,5\right\}</annotation></semantics></math>, corresponding to scales <math id="S6.SS1.p2.2.m2.4" class="ltx_Math" alttext="\{\frac{1}{4},\frac{1}{8},\frac{1}{16},\frac{1}{32}\}" display="inline"><semantics id="S6.SS1.p2.2.m2.4a"><mrow id="S6.SS1.p2.2.m2.4.5.2" xref="S6.SS1.p2.2.m2.4.5.1.cmml"><mo stretchy="false" id="S6.SS1.p2.2.m2.4.5.2.1" xref="S6.SS1.p2.2.m2.4.5.1.cmml">{</mo><mfrac id="S6.SS1.p2.2.m2.1.1" xref="S6.SS1.p2.2.m2.1.1.cmml"><mn id="S6.SS1.p2.2.m2.1.1.2" xref="S6.SS1.p2.2.m2.1.1.2.cmml">1</mn><mn id="S6.SS1.p2.2.m2.1.1.3" xref="S6.SS1.p2.2.m2.1.1.3.cmml">4</mn></mfrac><mo id="S6.SS1.p2.2.m2.4.5.2.2" xref="S6.SS1.p2.2.m2.4.5.1.cmml">,</mo><mfrac id="S6.SS1.p2.2.m2.2.2" xref="S6.SS1.p2.2.m2.2.2.cmml"><mn id="S6.SS1.p2.2.m2.2.2.2" xref="S6.SS1.p2.2.m2.2.2.2.cmml">1</mn><mn id="S6.SS1.p2.2.m2.2.2.3" xref="S6.SS1.p2.2.m2.2.2.3.cmml">8</mn></mfrac><mo id="S6.SS1.p2.2.m2.4.5.2.3" xref="S6.SS1.p2.2.m2.4.5.1.cmml">,</mo><mfrac id="S6.SS1.p2.2.m2.3.3" xref="S6.SS1.p2.2.m2.3.3.cmml"><mn id="S6.SS1.p2.2.m2.3.3.2" xref="S6.SS1.p2.2.m2.3.3.2.cmml">1</mn><mn id="S6.SS1.p2.2.m2.3.3.3" xref="S6.SS1.p2.2.m2.3.3.3.cmml">16</mn></mfrac><mo id="S6.SS1.p2.2.m2.4.5.2.4" xref="S6.SS1.p2.2.m2.4.5.1.cmml">,</mo><mfrac id="S6.SS1.p2.2.m2.4.4" xref="S6.SS1.p2.2.m2.4.4.cmml"><mn id="S6.SS1.p2.2.m2.4.4.2" xref="S6.SS1.p2.2.m2.4.4.2.cmml">1</mn><mn id="S6.SS1.p2.2.m2.4.4.3" xref="S6.SS1.p2.2.m2.4.4.3.cmml">32</mn></mfrac><mo stretchy="false" id="S6.SS1.p2.2.m2.4.5.2.5" xref="S6.SS1.p2.2.m2.4.5.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.2.m2.4b"><set id="S6.SS1.p2.2.m2.4.5.1.cmml" xref="S6.SS1.p2.2.m2.4.5.2"><apply id="S6.SS1.p2.2.m2.1.1.cmml" xref="S6.SS1.p2.2.m2.1.1"><divide id="S6.SS1.p2.2.m2.1.1.1.cmml" xref="S6.SS1.p2.2.m2.1.1"></divide><cn type="integer" id="S6.SS1.p2.2.m2.1.1.2.cmml" xref="S6.SS1.p2.2.m2.1.1.2">1</cn><cn type="integer" id="S6.SS1.p2.2.m2.1.1.3.cmml" xref="S6.SS1.p2.2.m2.1.1.3">4</cn></apply><apply id="S6.SS1.p2.2.m2.2.2.cmml" xref="S6.SS1.p2.2.m2.2.2"><divide id="S6.SS1.p2.2.m2.2.2.1.cmml" xref="S6.SS1.p2.2.m2.2.2"></divide><cn type="integer" id="S6.SS1.p2.2.m2.2.2.2.cmml" xref="S6.SS1.p2.2.m2.2.2.2">1</cn><cn type="integer" id="S6.SS1.p2.2.m2.2.2.3.cmml" xref="S6.SS1.p2.2.m2.2.2.3">8</cn></apply><apply id="S6.SS1.p2.2.m2.3.3.cmml" xref="S6.SS1.p2.2.m2.3.3"><divide id="S6.SS1.p2.2.m2.3.3.1.cmml" xref="S6.SS1.p2.2.m2.3.3"></divide><cn type="integer" id="S6.SS1.p2.2.m2.3.3.2.cmml" xref="S6.SS1.p2.2.m2.3.3.2">1</cn><cn type="integer" id="S6.SS1.p2.2.m2.3.3.3.cmml" xref="S6.SS1.p2.2.m2.3.3.3">16</cn></apply><apply id="S6.SS1.p2.2.m2.4.4.cmml" xref="S6.SS1.p2.2.m2.4.4"><divide id="S6.SS1.p2.2.m2.4.4.1.cmml" xref="S6.SS1.p2.2.m2.4.4"></divide><cn type="integer" id="S6.SS1.p2.2.m2.4.4.2.cmml" xref="S6.SS1.p2.2.m2.4.4.2">1</cn><cn type="integer" id="S6.SS1.p2.2.m2.4.4.3.cmml" xref="S6.SS1.p2.2.m2.4.4.3">32</cn></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.2.m2.4c">\{\frac{1}{4},\frac{1}{8},\frac{1}{16},\frac{1}{32}\}</annotation></semantics></math>. Due to the non-hierarchical structure of the vanilla vision transformer, we only adopted the feature maps of the final output, denoted as <math id="S6.SS1.p2.3.m3.1" class="ltx_Math" alttext="\bm{V}_{1}" display="inline"><semantics id="S6.SS1.p2.3.m3.1a"><msub id="S6.SS1.p2.3.m3.1.1" xref="S6.SS1.p2.3.m3.1.1.cmml"><mi id="S6.SS1.p2.3.m3.1.1.2" xref="S6.SS1.p2.3.m3.1.1.2.cmml">𝑽</mi><mn id="S6.SS1.p2.3.m3.1.1.3" xref="S6.SS1.p2.3.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.3.m3.1b"><apply id="S6.SS1.p2.3.m3.1.1.cmml" xref="S6.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S6.SS1.p2.3.m3.1.1.1.cmml" xref="S6.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="S6.SS1.p2.3.m3.1.1.2.cmml" xref="S6.SS1.p2.3.m3.1.1.2">𝑽</ci><cn type="integer" id="S6.SS1.p2.3.m3.1.1.3.cmml" xref="S6.SS1.p2.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.3.m3.1c">\bm{V}_{1}</annotation></semantics></math>, which should have the most representative semantics. Setting the default patch size as 16, the output of ViT is of size <math id="S6.SS1.p2.4.m4.1" class="ltx_Math" alttext="\frac{H}{16}\times\frac{W}{16}" display="inline"><semantics id="S6.SS1.p2.4.m4.1a"><mrow id="S6.SS1.p2.4.m4.1.1" xref="S6.SS1.p2.4.m4.1.1.cmml"><mfrac id="S6.SS1.p2.4.m4.1.1.2" xref="S6.SS1.p2.4.m4.1.1.2.cmml"><mi id="S6.SS1.p2.4.m4.1.1.2.2" xref="S6.SS1.p2.4.m4.1.1.2.2.cmml">H</mi><mn id="S6.SS1.p2.4.m4.1.1.2.3" xref="S6.SS1.p2.4.m4.1.1.2.3.cmml">16</mn></mfrac><mo lspace="0.222em" rspace="0.222em" id="S6.SS1.p2.4.m4.1.1.1" xref="S6.SS1.p2.4.m4.1.1.1.cmml">×</mo><mfrac id="S6.SS1.p2.4.m4.1.1.3" xref="S6.SS1.p2.4.m4.1.1.3.cmml"><mi id="S6.SS1.p2.4.m4.1.1.3.2" xref="S6.SS1.p2.4.m4.1.1.3.2.cmml">W</mi><mn id="S6.SS1.p2.4.m4.1.1.3.3" xref="S6.SS1.p2.4.m4.1.1.3.3.cmml">16</mn></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.4.m4.1b"><apply id="S6.SS1.p2.4.m4.1.1.cmml" xref="S6.SS1.p2.4.m4.1.1"><times id="S6.SS1.p2.4.m4.1.1.1.cmml" xref="S6.SS1.p2.4.m4.1.1.1"></times><apply id="S6.SS1.p2.4.m4.1.1.2.cmml" xref="S6.SS1.p2.4.m4.1.1.2"><divide id="S6.SS1.p2.4.m4.1.1.2.1.cmml" xref="S6.SS1.p2.4.m4.1.1.2"></divide><ci id="S6.SS1.p2.4.m4.1.1.2.2.cmml" xref="S6.SS1.p2.4.m4.1.1.2.2">𝐻</ci><cn type="integer" id="S6.SS1.p2.4.m4.1.1.2.3.cmml" xref="S6.SS1.p2.4.m4.1.1.2.3">16</cn></apply><apply id="S6.SS1.p2.4.m4.1.1.3.cmml" xref="S6.SS1.p2.4.m4.1.1.3"><divide id="S6.SS1.p2.4.m4.1.1.3.1.cmml" xref="S6.SS1.p2.4.m4.1.1.3"></divide><ci id="S6.SS1.p2.4.m4.1.1.3.2.cmml" xref="S6.SS1.p2.4.m4.1.1.3.2">𝑊</ci><cn type="integer" id="S6.SS1.p2.4.m4.1.1.3.3.cmml" xref="S6.SS1.p2.4.m4.1.1.3.3">16</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.4.m4.1c">\frac{H}{16}\times\frac{W}{16}</annotation></semantics></math>.</p>
</div>
<div id="S6.SS1.p3" class="ltx_para">
<p id="S6.SS1.p3.5" class="ltx_p">For simlicity, the scale fusion is realized by simple top-down and lateral connections. Concretely, 1<math id="S6.SS1.p3.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S6.SS1.p3.1.m1.1a"><mo id="S6.SS1.p3.1.m1.1.1" xref="S6.SS1.p3.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S6.SS1.p3.1.m1.1b"><times id="S6.SS1.p3.1.m1.1.1.cmml" xref="S6.SS1.p3.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p3.1.m1.1c">\times</annotation></semantics></math>1 convolution is used to align the channel dimension to 256, and features of later CNN stages are then upsampled through deconvolution and added to the features of earlier stages progressively, whereas the ViT feature remains identity. Thus we get a simple feature pyramid of scales <math id="S6.SS1.p3.2.m2.3" class="ltx_Math" alttext="\{\frac{1}{4},\frac{1}{8},\frac{1}{16}\}" display="inline"><semantics id="S6.SS1.p3.2.m2.3a"><mrow id="S6.SS1.p3.2.m2.3.4.2" xref="S6.SS1.p3.2.m2.3.4.1.cmml"><mo stretchy="false" id="S6.SS1.p3.2.m2.3.4.2.1" xref="S6.SS1.p3.2.m2.3.4.1.cmml">{</mo><mfrac id="S6.SS1.p3.2.m2.1.1" xref="S6.SS1.p3.2.m2.1.1.cmml"><mn id="S6.SS1.p3.2.m2.1.1.2" xref="S6.SS1.p3.2.m2.1.1.2.cmml">1</mn><mn id="S6.SS1.p3.2.m2.1.1.3" xref="S6.SS1.p3.2.m2.1.1.3.cmml">4</mn></mfrac><mo id="S6.SS1.p3.2.m2.3.4.2.2" xref="S6.SS1.p3.2.m2.3.4.1.cmml">,</mo><mfrac id="S6.SS1.p3.2.m2.2.2" xref="S6.SS1.p3.2.m2.2.2.cmml"><mn id="S6.SS1.p3.2.m2.2.2.2" xref="S6.SS1.p3.2.m2.2.2.2.cmml">1</mn><mn id="S6.SS1.p3.2.m2.2.2.3" xref="S6.SS1.p3.2.m2.2.2.3.cmml">8</mn></mfrac><mo id="S6.SS1.p3.2.m2.3.4.2.3" xref="S6.SS1.p3.2.m2.3.4.1.cmml">,</mo><mfrac id="S6.SS1.p3.2.m2.3.3" xref="S6.SS1.p3.2.m2.3.3.cmml"><mn id="S6.SS1.p3.2.m2.3.3.2" xref="S6.SS1.p3.2.m2.3.3.2.cmml">1</mn><mn id="S6.SS1.p3.2.m2.3.3.3" xref="S6.SS1.p3.2.m2.3.3.3.cmml">16</mn></mfrac><mo stretchy="false" id="S6.SS1.p3.2.m2.3.4.2.4" xref="S6.SS1.p3.2.m2.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p3.2.m2.3b"><set id="S6.SS1.p3.2.m2.3.4.1.cmml" xref="S6.SS1.p3.2.m2.3.4.2"><apply id="S6.SS1.p3.2.m2.1.1.cmml" xref="S6.SS1.p3.2.m2.1.1"><divide id="S6.SS1.p3.2.m2.1.1.1.cmml" xref="S6.SS1.p3.2.m2.1.1"></divide><cn type="integer" id="S6.SS1.p3.2.m2.1.1.2.cmml" xref="S6.SS1.p3.2.m2.1.1.2">1</cn><cn type="integer" id="S6.SS1.p3.2.m2.1.1.3.cmml" xref="S6.SS1.p3.2.m2.1.1.3">4</cn></apply><apply id="S6.SS1.p3.2.m2.2.2.cmml" xref="S6.SS1.p3.2.m2.2.2"><divide id="S6.SS1.p3.2.m2.2.2.1.cmml" xref="S6.SS1.p3.2.m2.2.2"></divide><cn type="integer" id="S6.SS1.p3.2.m2.2.2.2.cmml" xref="S6.SS1.p3.2.m2.2.2.2">1</cn><cn type="integer" id="S6.SS1.p3.2.m2.2.2.3.cmml" xref="S6.SS1.p3.2.m2.2.2.3">8</cn></apply><apply id="S6.SS1.p3.2.m2.3.3.cmml" xref="S6.SS1.p3.2.m2.3.3"><divide id="S6.SS1.p3.2.m2.3.3.1.cmml" xref="S6.SS1.p3.2.m2.3.3"></divide><cn type="integer" id="S6.SS1.p3.2.m2.3.3.2.cmml" xref="S6.SS1.p3.2.m2.3.3.2">1</cn><cn type="integer" id="S6.SS1.p3.2.m2.3.3.3.cmml" xref="S6.SS1.p3.2.m2.3.3.3">16</cn></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p3.2.m2.3c">\{\frac{1}{4},\frac{1}{8},\frac{1}{16}\}</annotation></semantics></math>, where the <math id="S6.SS1.p3.3.m3.1" class="ltx_Math" alttext="\frac{1}{16}" display="inline"><semantics id="S6.SS1.p3.3.m3.1a"><mfrac id="S6.SS1.p3.3.m3.1.1" xref="S6.SS1.p3.3.m3.1.1.cmml"><mn id="S6.SS1.p3.3.m3.1.1.2" xref="S6.SS1.p3.3.m3.1.1.2.cmml">1</mn><mn id="S6.SS1.p3.3.m3.1.1.3" xref="S6.SS1.p3.3.m3.1.1.3.cmml">16</mn></mfrac><annotation-xml encoding="MathML-Content" id="S6.SS1.p3.3.m3.1b"><apply id="S6.SS1.p3.3.m3.1.1.cmml" xref="S6.SS1.p3.3.m3.1.1"><divide id="S6.SS1.p3.3.m3.1.1.1.cmml" xref="S6.SS1.p3.3.m3.1.1"></divide><cn type="integer" id="S6.SS1.p3.3.m3.1.1.2.cmml" xref="S6.SS1.p3.3.m3.1.1.2">1</cn><cn type="integer" id="S6.SS1.p3.3.m3.1.1.3.cmml" xref="S6.SS1.p3.3.m3.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p3.3.m3.1c">\frac{1}{16}</annotation></semantics></math> scale covers both <math id="S6.SS1.p3.4.m4.1" class="ltx_Math" alttext="R_{4}" display="inline"><semantics id="S6.SS1.p3.4.m4.1a"><msub id="S6.SS1.p3.4.m4.1.1" xref="S6.SS1.p3.4.m4.1.1.cmml"><mi id="S6.SS1.p3.4.m4.1.1.2" xref="S6.SS1.p3.4.m4.1.1.2.cmml">R</mi><mn id="S6.SS1.p3.4.m4.1.1.3" xref="S6.SS1.p3.4.m4.1.1.3.cmml">4</mn></msub><annotation-xml encoding="MathML-Content" id="S6.SS1.p3.4.m4.1b"><apply id="S6.SS1.p3.4.m4.1.1.cmml" xref="S6.SS1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S6.SS1.p3.4.m4.1.1.1.cmml" xref="S6.SS1.p3.4.m4.1.1">subscript</csymbol><ci id="S6.SS1.p3.4.m4.1.1.2.cmml" xref="S6.SS1.p3.4.m4.1.1.2">𝑅</ci><cn type="integer" id="S6.SS1.p3.4.m4.1.1.3.cmml" xref="S6.SS1.p3.4.m4.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p3.4.m4.1c">R_{4}</annotation></semantics></math> and <math id="S6.SS1.p3.5.m5.1" class="ltx_Math" alttext="V_{1}" display="inline"><semantics id="S6.SS1.p3.5.m5.1a"><msub id="S6.SS1.p3.5.m5.1.1" xref="S6.SS1.p3.5.m5.1.1.cmml"><mi id="S6.SS1.p3.5.m5.1.1.2" xref="S6.SS1.p3.5.m5.1.1.2.cmml">V</mi><mn id="S6.SS1.p3.5.m5.1.1.3" xref="S6.SS1.p3.5.m5.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S6.SS1.p3.5.m5.1b"><apply id="S6.SS1.p3.5.m5.1.1.cmml" xref="S6.SS1.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S6.SS1.p3.5.m5.1.1.1.cmml" xref="S6.SS1.p3.5.m5.1.1">subscript</csymbol><ci id="S6.SS1.p3.5.m5.1.1.2.cmml" xref="S6.SS1.p3.5.m5.1.1.2">𝑉</ci><cn type="integer" id="S6.SS1.p3.5.m5.1.1.3.cmml" xref="S6.SS1.p3.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p3.5.m5.1c">V_{1}</annotation></semantics></math>. These features are concatenated together and fed into the segmentation head (Upsampling to groundtruth size followed by a 3x3 conv to project the channel dimension from 256 to 1), the whole procedure can be formulated as</p>
<table id="S6.E9" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S6.E9X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S6.E9X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle{\widetilde{R}}" display="inline"><semantics id="S6.E9X.2.1.1.m1.1a"><mover accent="true" id="S6.E9X.2.1.1.m1.1.1" xref="S6.E9X.2.1.1.m1.1.1.cmml"><mi mathsize="80%" id="S6.E9X.2.1.1.m1.1.1.2" xref="S6.E9X.2.1.1.m1.1.1.2.cmml">R</mi><mo mathsize="80%" id="S6.E9X.2.1.1.m1.1.1.1" xref="S6.E9X.2.1.1.m1.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S6.E9X.2.1.1.m1.1b"><apply id="S6.E9X.2.1.1.m1.1.1.cmml" xref="S6.E9X.2.1.1.m1.1.1"><ci id="S6.E9X.2.1.1.m1.1.1.1.cmml" xref="S6.E9X.2.1.1.m1.1.1.1">~</ci><ci id="S6.E9X.2.1.1.m1.1.1.2.cmml" xref="S6.E9X.2.1.1.m1.1.1.2">𝑅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.E9X.2.1.1.m1.1c">\displaystyle{\widetilde{R}}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S6.E9X.3.2.2.m1.2" class="ltx_Math" alttext="\displaystyle={Conv}_{1\times 1}(R_{i}),\ \ {\widetilde{V_{i}}}={Conv}_{1\times 1}(V_{i})" display="inline"><semantics id="S6.E9X.3.2.2.m1.2a"><mrow id="S6.E9X.3.2.2.m1.2.2.2" xref="S6.E9X.3.2.2.m1.2.2.3.cmml"><mrow id="S6.E9X.3.2.2.m1.1.1.1.1" xref="S6.E9X.3.2.2.m1.1.1.1.1.cmml"><mi id="S6.E9X.3.2.2.m1.1.1.1.1.3" xref="S6.E9X.3.2.2.m1.1.1.1.1.3.cmml"></mi><mo mathsize="80%" id="S6.E9X.3.2.2.m1.1.1.1.1.2" xref="S6.E9X.3.2.2.m1.1.1.1.1.2.cmml">=</mo><mrow id="S6.E9X.3.2.2.m1.1.1.1.1.1" xref="S6.E9X.3.2.2.m1.1.1.1.1.1.cmml"><mi mathsize="80%" id="S6.E9X.3.2.2.m1.1.1.1.1.1.3" xref="S6.E9X.3.2.2.m1.1.1.1.1.1.3.cmml">C</mi><mo lspace="0em" rspace="0em" id="S6.E9X.3.2.2.m1.1.1.1.1.1.2" xref="S6.E9X.3.2.2.m1.1.1.1.1.1.2.cmml">​</mo><mi mathsize="80%" id="S6.E9X.3.2.2.m1.1.1.1.1.1.4" xref="S6.E9X.3.2.2.m1.1.1.1.1.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S6.E9X.3.2.2.m1.1.1.1.1.1.2a" xref="S6.E9X.3.2.2.m1.1.1.1.1.1.2.cmml">​</mo><mi mathsize="80%" id="S6.E9X.3.2.2.m1.1.1.1.1.1.5" xref="S6.E9X.3.2.2.m1.1.1.1.1.1.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S6.E9X.3.2.2.m1.1.1.1.1.1.2b" xref="S6.E9X.3.2.2.m1.1.1.1.1.1.2.cmml">​</mo><msub id="S6.E9X.3.2.2.m1.1.1.1.1.1.6" xref="S6.E9X.3.2.2.m1.1.1.1.1.1.6.cmml"><mi mathsize="80%" id="S6.E9X.3.2.2.m1.1.1.1.1.1.6.2" xref="S6.E9X.3.2.2.m1.1.1.1.1.1.6.2.cmml">v</mi><mrow id="S6.E9X.3.2.2.m1.1.1.1.1.1.6.3" xref="S6.E9X.3.2.2.m1.1.1.1.1.1.6.3.cmml"><mn mathsize="80%" id="S6.E9X.3.2.2.m1.1.1.1.1.1.6.3.2" xref="S6.E9X.3.2.2.m1.1.1.1.1.1.6.3.2.cmml">1</mn><mo lspace="0.222em" mathsize="80%" rspace="0.222em" id="S6.E9X.3.2.2.m1.1.1.1.1.1.6.3.1" xref="S6.E9X.3.2.2.m1.1.1.1.1.1.6.3.1.cmml">×</mo><mn mathsize="80%" id="S6.E9X.3.2.2.m1.1.1.1.1.1.6.3.3" xref="S6.E9X.3.2.2.m1.1.1.1.1.1.6.3.3.cmml">1</mn></mrow></msub><mo lspace="0em" rspace="0em" id="S6.E9X.3.2.2.m1.1.1.1.1.1.2c" xref="S6.E9X.3.2.2.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S6.E9X.3.2.2.m1.1.1.1.1.1.1.1" xref="S6.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml"><mo maxsize="80%" minsize="80%" id="S6.E9X.3.2.2.m1.1.1.1.1.1.1.1.2" xref="S6.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S6.E9X.3.2.2.m1.1.1.1.1.1.1.1.1" xref="S6.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml"><mi mathsize="80%" id="S6.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.2" xref="S6.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.2.cmml">R</mi><mi mathsize="80%" id="S6.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.3" xref="S6.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo maxsize="80%" minsize="80%" id="S6.E9X.3.2.2.m1.1.1.1.1.1.1.1.3" xref="S6.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo mathsize="80%" rspace="0.967em" id="S6.E9X.3.2.2.m1.2.2.2.3" xref="S6.E9X.3.2.2.m1.2.2.3a.cmml">,</mo><mrow id="S6.E9X.3.2.2.m1.2.2.2.2" xref="S6.E9X.3.2.2.m1.2.2.2.2.cmml"><mover accent="true" id="S6.E9X.3.2.2.m1.2.2.2.2.3" xref="S6.E9X.3.2.2.m1.2.2.2.2.3.cmml"><msub id="S6.E9X.3.2.2.m1.2.2.2.2.3.2" xref="S6.E9X.3.2.2.m1.2.2.2.2.3.2.cmml"><mi mathsize="80%" id="S6.E9X.3.2.2.m1.2.2.2.2.3.2.2" xref="S6.E9X.3.2.2.m1.2.2.2.2.3.2.2.cmml">V</mi><mi mathsize="80%" id="S6.E9X.3.2.2.m1.2.2.2.2.3.2.3" xref="S6.E9X.3.2.2.m1.2.2.2.2.3.2.3.cmml">i</mi></msub><mo mathsize="80%" id="S6.E9X.3.2.2.m1.2.2.2.2.3.1" xref="S6.E9X.3.2.2.m1.2.2.2.2.3.1.cmml">~</mo></mover><mo mathsize="80%" id="S6.E9X.3.2.2.m1.2.2.2.2.2" xref="S6.E9X.3.2.2.m1.2.2.2.2.2.cmml">=</mo><mrow id="S6.E9X.3.2.2.m1.2.2.2.2.1" xref="S6.E9X.3.2.2.m1.2.2.2.2.1.cmml"><mi mathsize="80%" id="S6.E9X.3.2.2.m1.2.2.2.2.1.3" xref="S6.E9X.3.2.2.m1.2.2.2.2.1.3.cmml">C</mi><mo lspace="0em" rspace="0em" id="S6.E9X.3.2.2.m1.2.2.2.2.1.2" xref="S6.E9X.3.2.2.m1.2.2.2.2.1.2.cmml">​</mo><mi mathsize="80%" id="S6.E9X.3.2.2.m1.2.2.2.2.1.4" xref="S6.E9X.3.2.2.m1.2.2.2.2.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S6.E9X.3.2.2.m1.2.2.2.2.1.2a" xref="S6.E9X.3.2.2.m1.2.2.2.2.1.2.cmml">​</mo><mi mathsize="80%" id="S6.E9X.3.2.2.m1.2.2.2.2.1.5" xref="S6.E9X.3.2.2.m1.2.2.2.2.1.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S6.E9X.3.2.2.m1.2.2.2.2.1.2b" xref="S6.E9X.3.2.2.m1.2.2.2.2.1.2.cmml">​</mo><msub id="S6.E9X.3.2.2.m1.2.2.2.2.1.6" xref="S6.E9X.3.2.2.m1.2.2.2.2.1.6.cmml"><mi mathsize="80%" id="S6.E9X.3.2.2.m1.2.2.2.2.1.6.2" xref="S6.E9X.3.2.2.m1.2.2.2.2.1.6.2.cmml">v</mi><mrow id="S6.E9X.3.2.2.m1.2.2.2.2.1.6.3" xref="S6.E9X.3.2.2.m1.2.2.2.2.1.6.3.cmml"><mn mathsize="80%" id="S6.E9X.3.2.2.m1.2.2.2.2.1.6.3.2" xref="S6.E9X.3.2.2.m1.2.2.2.2.1.6.3.2.cmml">1</mn><mo lspace="0.222em" mathsize="80%" rspace="0.222em" id="S6.E9X.3.2.2.m1.2.2.2.2.1.6.3.1" xref="S6.E9X.3.2.2.m1.2.2.2.2.1.6.3.1.cmml">×</mo><mn mathsize="80%" id="S6.E9X.3.2.2.m1.2.2.2.2.1.6.3.3" xref="S6.E9X.3.2.2.m1.2.2.2.2.1.6.3.3.cmml">1</mn></mrow></msub><mo lspace="0em" rspace="0em" id="S6.E9X.3.2.2.m1.2.2.2.2.1.2c" xref="S6.E9X.3.2.2.m1.2.2.2.2.1.2.cmml">​</mo><mrow id="S6.E9X.3.2.2.m1.2.2.2.2.1.1.1" xref="S6.E9X.3.2.2.m1.2.2.2.2.1.1.1.1.cmml"><mo maxsize="80%" minsize="80%" id="S6.E9X.3.2.2.m1.2.2.2.2.1.1.1.2" xref="S6.E9X.3.2.2.m1.2.2.2.2.1.1.1.1.cmml">(</mo><msub id="S6.E9X.3.2.2.m1.2.2.2.2.1.1.1.1" xref="S6.E9X.3.2.2.m1.2.2.2.2.1.1.1.1.cmml"><mi mathsize="80%" id="S6.E9X.3.2.2.m1.2.2.2.2.1.1.1.1.2" xref="S6.E9X.3.2.2.m1.2.2.2.2.1.1.1.1.2.cmml">V</mi><mi mathsize="80%" id="S6.E9X.3.2.2.m1.2.2.2.2.1.1.1.1.3" xref="S6.E9X.3.2.2.m1.2.2.2.2.1.1.1.1.3.cmml">i</mi></msub><mo maxsize="80%" minsize="80%" id="S6.E9X.3.2.2.m1.2.2.2.2.1.1.1.3" xref="S6.E9X.3.2.2.m1.2.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.E9X.3.2.2.m1.2b"><apply id="S6.E9X.3.2.2.m1.2.2.3.cmml" xref="S6.E9X.3.2.2.m1.2.2.2"><csymbol cd="ambiguous" id="S6.E9X.3.2.2.m1.2.2.3a.cmml" xref="S6.E9X.3.2.2.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S6.E9X.3.2.2.m1.1.1.1.1.cmml" xref="S6.E9X.3.2.2.m1.1.1.1.1"><eq id="S6.E9X.3.2.2.m1.1.1.1.1.2.cmml" xref="S6.E9X.3.2.2.m1.1.1.1.1.2"></eq><csymbol cd="latexml" id="S6.E9X.3.2.2.m1.1.1.1.1.3.cmml" xref="S6.E9X.3.2.2.m1.1.1.1.1.3">absent</csymbol><apply id="S6.E9X.3.2.2.m1.1.1.1.1.1.cmml" xref="S6.E9X.3.2.2.m1.1.1.1.1.1"><times id="S6.E9X.3.2.2.m1.1.1.1.1.1.2.cmml" xref="S6.E9X.3.2.2.m1.1.1.1.1.1.2"></times><ci id="S6.E9X.3.2.2.m1.1.1.1.1.1.3.cmml" xref="S6.E9X.3.2.2.m1.1.1.1.1.1.3">𝐶</ci><ci id="S6.E9X.3.2.2.m1.1.1.1.1.1.4.cmml" xref="S6.E9X.3.2.2.m1.1.1.1.1.1.4">𝑜</ci><ci id="S6.E9X.3.2.2.m1.1.1.1.1.1.5.cmml" xref="S6.E9X.3.2.2.m1.1.1.1.1.1.5">𝑛</ci><apply id="S6.E9X.3.2.2.m1.1.1.1.1.1.6.cmml" xref="S6.E9X.3.2.2.m1.1.1.1.1.1.6"><csymbol cd="ambiguous" id="S6.E9X.3.2.2.m1.1.1.1.1.1.6.1.cmml" xref="S6.E9X.3.2.2.m1.1.1.1.1.1.6">subscript</csymbol><ci id="S6.E9X.3.2.2.m1.1.1.1.1.1.6.2.cmml" xref="S6.E9X.3.2.2.m1.1.1.1.1.1.6.2">𝑣</ci><apply id="S6.E9X.3.2.2.m1.1.1.1.1.1.6.3.cmml" xref="S6.E9X.3.2.2.m1.1.1.1.1.1.6.3"><times id="S6.E9X.3.2.2.m1.1.1.1.1.1.6.3.1.cmml" xref="S6.E9X.3.2.2.m1.1.1.1.1.1.6.3.1"></times><cn type="integer" id="S6.E9X.3.2.2.m1.1.1.1.1.1.6.3.2.cmml" xref="S6.E9X.3.2.2.m1.1.1.1.1.1.6.3.2">1</cn><cn type="integer" id="S6.E9X.3.2.2.m1.1.1.1.1.1.6.3.3.cmml" xref="S6.E9X.3.2.2.m1.1.1.1.1.1.6.3.3">1</cn></apply></apply><apply id="S6.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml" xref="S6.E9X.3.2.2.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S6.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S6.E9X.3.2.2.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S6.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S6.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.2">𝑅</ci><ci id="S6.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S6.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S6.E9X.3.2.2.m1.2.2.2.2.cmml" xref="S6.E9X.3.2.2.m1.2.2.2.2"><eq id="S6.E9X.3.2.2.m1.2.2.2.2.2.cmml" xref="S6.E9X.3.2.2.m1.2.2.2.2.2"></eq><apply id="S6.E9X.3.2.2.m1.2.2.2.2.3.cmml" xref="S6.E9X.3.2.2.m1.2.2.2.2.3"><ci id="S6.E9X.3.2.2.m1.2.2.2.2.3.1.cmml" xref="S6.E9X.3.2.2.m1.2.2.2.2.3.1">~</ci><apply id="S6.E9X.3.2.2.m1.2.2.2.2.3.2.cmml" xref="S6.E9X.3.2.2.m1.2.2.2.2.3.2"><csymbol cd="ambiguous" id="S6.E9X.3.2.2.m1.2.2.2.2.3.2.1.cmml" xref="S6.E9X.3.2.2.m1.2.2.2.2.3.2">subscript</csymbol><ci id="S6.E9X.3.2.2.m1.2.2.2.2.3.2.2.cmml" xref="S6.E9X.3.2.2.m1.2.2.2.2.3.2.2">𝑉</ci><ci id="S6.E9X.3.2.2.m1.2.2.2.2.3.2.3.cmml" xref="S6.E9X.3.2.2.m1.2.2.2.2.3.2.3">𝑖</ci></apply></apply><apply id="S6.E9X.3.2.2.m1.2.2.2.2.1.cmml" xref="S6.E9X.3.2.2.m1.2.2.2.2.1"><times id="S6.E9X.3.2.2.m1.2.2.2.2.1.2.cmml" xref="S6.E9X.3.2.2.m1.2.2.2.2.1.2"></times><ci id="S6.E9X.3.2.2.m1.2.2.2.2.1.3.cmml" xref="S6.E9X.3.2.2.m1.2.2.2.2.1.3">𝐶</ci><ci id="S6.E9X.3.2.2.m1.2.2.2.2.1.4.cmml" xref="S6.E9X.3.2.2.m1.2.2.2.2.1.4">𝑜</ci><ci id="S6.E9X.3.2.2.m1.2.2.2.2.1.5.cmml" xref="S6.E9X.3.2.2.m1.2.2.2.2.1.5">𝑛</ci><apply id="S6.E9X.3.2.2.m1.2.2.2.2.1.6.cmml" xref="S6.E9X.3.2.2.m1.2.2.2.2.1.6"><csymbol cd="ambiguous" id="S6.E9X.3.2.2.m1.2.2.2.2.1.6.1.cmml" xref="S6.E9X.3.2.2.m1.2.2.2.2.1.6">subscript</csymbol><ci id="S6.E9X.3.2.2.m1.2.2.2.2.1.6.2.cmml" xref="S6.E9X.3.2.2.m1.2.2.2.2.1.6.2">𝑣</ci><apply id="S6.E9X.3.2.2.m1.2.2.2.2.1.6.3.cmml" xref="S6.E9X.3.2.2.m1.2.2.2.2.1.6.3"><times id="S6.E9X.3.2.2.m1.2.2.2.2.1.6.3.1.cmml" xref="S6.E9X.3.2.2.m1.2.2.2.2.1.6.3.1"></times><cn type="integer" id="S6.E9X.3.2.2.m1.2.2.2.2.1.6.3.2.cmml" xref="S6.E9X.3.2.2.m1.2.2.2.2.1.6.3.2">1</cn><cn type="integer" id="S6.E9X.3.2.2.m1.2.2.2.2.1.6.3.3.cmml" xref="S6.E9X.3.2.2.m1.2.2.2.2.1.6.3.3">1</cn></apply></apply><apply id="S6.E9X.3.2.2.m1.2.2.2.2.1.1.1.1.cmml" xref="S6.E9X.3.2.2.m1.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S6.E9X.3.2.2.m1.2.2.2.2.1.1.1.1.1.cmml" xref="S6.E9X.3.2.2.m1.2.2.2.2.1.1.1">subscript</csymbol><ci id="S6.E9X.3.2.2.m1.2.2.2.2.1.1.1.1.2.cmml" xref="S6.E9X.3.2.2.m1.2.2.2.2.1.1.1.1.2">𝑉</ci><ci id="S6.E9X.3.2.2.m1.2.2.2.2.1.1.1.1.3.cmml" xref="S6.E9X.3.2.2.m1.2.2.2.2.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.E9X.3.2.2.m1.2c">\displaystyle={Conv}_{1\times 1}(R_{i}),\ \ {\widetilde{V_{i}}}={Conv}_{1\times 1}(V_{i})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="3" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(9)</span></td>
</tr>
<tr id="S6.E9Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S6.E9Xa.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle H_{i}" display="inline"><semantics id="S6.E9Xa.2.1.1.m1.1a"><msub id="S6.E9Xa.2.1.1.m1.1.1" xref="S6.E9Xa.2.1.1.m1.1.1.cmml"><mi mathsize="80%" id="S6.E9Xa.2.1.1.m1.1.1.2" xref="S6.E9Xa.2.1.1.m1.1.1.2.cmml">H</mi><mi mathsize="80%" id="S6.E9Xa.2.1.1.m1.1.1.3" xref="S6.E9Xa.2.1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S6.E9Xa.2.1.1.m1.1b"><apply id="S6.E9Xa.2.1.1.m1.1.1.cmml" xref="S6.E9Xa.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S6.E9Xa.2.1.1.m1.1.1.1.cmml" xref="S6.E9Xa.2.1.1.m1.1.1">subscript</csymbol><ci id="S6.E9Xa.2.1.1.m1.1.1.2.cmml" xref="S6.E9Xa.2.1.1.m1.1.1.2">𝐻</ci><ci id="S6.E9Xa.2.1.1.m1.1.1.3.cmml" xref="S6.E9Xa.2.1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.E9Xa.2.1.1.m1.1c">\displaystyle H_{i}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S6.E9Xa.3.2.2.m1.7" class="ltx_math_unparsed" alttext="\displaystyle=\left\{\begin{aligned} &{\widetilde{V_{i}}},\ \ i=1,\\
&{\widetilde{R}}_{i}+{Upsample}({\widetilde{R}}_{i+1}),\ \ i=2,3,4,\\
\end{aligned}\right." display="inline"><semantics id="S6.E9Xa.3.2.2.m1.7a"><mrow id="S6.E9Xa.3.2.2.m1.7b"><mo mathsize="80%" id="S6.E9Xa.3.2.2.m1.7.8">=</mo><mrow id="S6.E9Xa.3.2.2.m1.7.9"><mo id="S6.E9Xa.3.2.2.m1.7.9.1">{</mo><mtable columnspacing="0pt" rowspacing="0pt" id="S6.E9Xa.3.2.2.m1.7.7"><mtr id="S6.E9Xa.3.2.2.m1.7.7a"><mtd id="S6.E9Xa.3.2.2.m1.7.7b"></mtd><mtd class="ltx_align_left" columnalign="left" id="S6.E9Xa.3.2.2.m1.7.7c"><mrow id="S6.E9Xa.3.2.2.m1.3.3.3.3.3.3"><mrow id="S6.E9Xa.3.2.2.m1.3.3.3.3.3.3.1"><mrow id="S6.E9Xa.3.2.2.m1.3.3.3.3.3.3.1.2.2"><mover accent="true" id="S6.E9Xa.3.2.2.m1.1.1.1.1.1.1"><msub id="S6.E9Xa.3.2.2.m1.1.1.1.1.1.1.2"><mi mathsize="80%" id="S6.E9Xa.3.2.2.m1.1.1.1.1.1.1.2.2">V</mi><mi mathsize="80%" id="S6.E9Xa.3.2.2.m1.1.1.1.1.1.1.2.3">i</mi></msub><mo mathsize="80%" id="S6.E9Xa.3.2.2.m1.1.1.1.1.1.1.1">~</mo></mover><mo mathsize="80%" rspace="0.967em" id="S6.E9Xa.3.2.2.m1.3.3.3.3.3.3.1.2.2.1">,</mo><mi mathsize="80%" id="S6.E9Xa.3.2.2.m1.2.2.2.2.2.2">i</mi></mrow><mo mathsize="80%" id="S6.E9Xa.3.2.2.m1.3.3.3.3.3.3.1.1">=</mo><mn mathsize="80%" id="S6.E9Xa.3.2.2.m1.3.3.3.3.3.3.1.3">1</mn></mrow><mo mathsize="80%" id="S6.E9Xa.3.2.2.m1.3.3.3.3.3.3.2">,</mo></mrow></mtd></mtr><mtr id="S6.E9Xa.3.2.2.m1.7.7d"><mtd id="S6.E9Xa.3.2.2.m1.7.7e"></mtd><mtd class="ltx_align_left" columnalign="left" id="S6.E9Xa.3.2.2.m1.7.7f"><mrow id="S6.E9Xa.3.2.2.m1.7.7.7.4.4.4"><mrow id="S6.E9Xa.3.2.2.m1.7.7.7.4.4.4.1.2"><mrow id="S6.E9Xa.3.2.2.m1.7.7.7.4.4.4.1.1.1"><mrow id="S6.E9Xa.3.2.2.m1.7.7.7.4.4.4.1.1.1.1.1"><mrow id="S6.E9Xa.3.2.2.m1.7.7.7.4.4.4.1.1.1.1.1.1"><msub id="S6.E9Xa.3.2.2.m1.7.7.7.4.4.4.1.1.1.1.1.1.3"><mover accent="true" id="S6.E9Xa.3.2.2.m1.7.7.7.4.4.4.1.1.1.1.1.1.3.2"><mi mathsize="80%" id="S6.E9Xa.3.2.2.m1.7.7.7.4.4.4.1.1.1.1.1.1.3.2.2">R</mi><mo mathsize="80%" id="S6.E9Xa.3.2.2.m1.7.7.7.4.4.4.1.1.1.1.1.1.3.2.1">~</mo></mover><mi mathsize="80%" id="S6.E9Xa.3.2.2.m1.7.7.7.4.4.4.1.1.1.1.1.1.3.3">i</mi></msub><mo mathsize="80%" id="S6.E9Xa.3.2.2.m1.7.7.7.4.4.4.1.1.1.1.1.1.2">+</mo><mrow id="S6.E9Xa.3.2.2.m1.7.7.7.4.4.4.1.1.1.1.1.1.1"><mi mathsize="80%" id="S6.E9Xa.3.2.2.m1.7.7.7.4.4.4.1.1.1.1.1.1.1.3">U</mi><mo lspace="0em" rspace="0em" id="S6.E9Xa.3.2.2.m1.7.7.7.4.4.4.1.1.1.1.1.1.1.2">​</mo><mi mathsize="80%" id="S6.E9Xa.3.2.2.m1.7.7.7.4.4.4.1.1.1.1.1.1.1.4">p</mi><mo lspace="0em" rspace="0em" id="S6.E9Xa.3.2.2.m1.7.7.7.4.4.4.1.1.1.1.1.1.1.2a">​</mo><mi mathsize="80%" id="S6.E9Xa.3.2.2.m1.7.7.7.4.4.4.1.1.1.1.1.1.1.5">s</mi><mo lspace="0em" rspace="0em" id="S6.E9Xa.3.2.2.m1.7.7.7.4.4.4.1.1.1.1.1.1.1.2b">​</mo><mi mathsize="80%" id="S6.E9Xa.3.2.2.m1.7.7.7.4.4.4.1.1.1.1.1.1.1.6">a</mi><mo lspace="0em" rspace="0em" id="S6.E9Xa.3.2.2.m1.7.7.7.4.4.4.1.1.1.1.1.1.1.2c">​</mo><mi mathsize="80%" id="S6.E9Xa.3.2.2.m1.7.7.7.4.4.4.1.1.1.1.1.1.1.7">m</mi><mo lspace="0em" rspace="0em" id="S6.E9Xa.3.2.2.m1.7.7.7.4.4.4.1.1.1.1.1.1.1.2d">​</mo><mi mathsize="80%" id="S6.E9Xa.3.2.2.m1.7.7.7.4.4.4.1.1.1.1.1.1.1.8">p</mi><mo lspace="0em" rspace="0em" id="S6.E9Xa.3.2.2.m1.7.7.7.4.4.4.1.1.1.1.1.1.1.2e">​</mo><mi mathsize="80%" id="S6.E9Xa.3.2.2.m1.7.7.7.4.4.4.1.1.1.1.1.1.1.9">l</mi><mo lspace="0em" rspace="0em" id="S6.E9Xa.3.2.2.m1.7.7.7.4.4.4.1.1.1.1.1.1.1.2f">​</mo><mi mathsize="80%" id="S6.E9Xa.3.2.2.m1.7.7.7.4.4.4.1.1.1.1.1.1.1.10">e</mi><mo lspace="0em" rspace="0em" id="S6.E9Xa.3.2.2.m1.7.7.7.4.4.4.1.1.1.1.1.1.1.2g">​</mo><mrow id="S6.E9Xa.3.2.2.m1.7.7.7.4.4.4.1.1.1.1.1.1.1.1.1"><mo maxsize="80%" minsize="80%" id="S6.E9Xa.3.2.2.m1.7.7.7.4.4.4.1.1.1.1.1.1.1.1.1.2">(</mo><msub id="S6.E9Xa.3.2.2.m1.7.7.7.4.4.4.1.1.1.1.1.1.1.1.1.1"><mover accent="true" id="S6.E9Xa.3.2.2.m1.7.7.7.4.4.4.1.1.1.1.1.1.1.1.1.1.2"><mi mathsize="80%" id="S6.E9Xa.3.2.2.m1.7.7.7.4.4.4.1.1.1.1.1.1.1.1.1.1.2.2">R</mi><mo mathsize="80%" id="S6.E9Xa.3.2.2.m1.7.7.7.4.4.4.1.1.1.1.1.1.1.1.1.1.2.1">~</mo></mover><mrow id="S6.E9Xa.3.2.2.m1.7.7.7.4.4.4.1.1.1.1.1.1.1.1.1.1.3"><mi mathsize="80%" id="S6.E9Xa.3.2.2.m1.7.7.7.4.4.4.1.1.1.1.1.1.1.1.1.1.3.2">i</mi><mo mathsize="80%" id="S6.E9Xa.3.2.2.m1.7.7.7.4.4.4.1.1.1.1.1.1.1.1.1.1.3.1">+</mo><mn mathsize="80%" id="S6.E9Xa.3.2.2.m1.7.7.7.4.4.4.1.1.1.1.1.1.1.1.1.1.3.3">1</mn></mrow></msub><mo maxsize="80%" minsize="80%" id="S6.E9Xa.3.2.2.m1.7.7.7.4.4.4.1.1.1.1.1.1.1.1.1.3">)</mo></mrow></mrow></mrow><mo mathsize="80%" rspace="0.967em" id="S6.E9Xa.3.2.2.m1.7.7.7.4.4.4.1.1.1.1.1.2">,</mo><mi mathsize="80%" id="S6.E9Xa.3.2.2.m1.4.4.4.1.1.1">i</mi></mrow><mo mathsize="80%" id="S6.E9Xa.3.2.2.m1.7.7.7.4.4.4.1.1.1.2">=</mo><mn mathsize="80%" id="S6.E9Xa.3.2.2.m1.7.7.7.4.4.4.1.1.1.3">2</mn></mrow><mo mathsize="80%" id="S6.E9Xa.3.2.2.m1.7.7.7.4.4.4.1.2.3">,</mo><mrow id="S6.E9Xa.3.2.2.m1.7.7.7.4.4.4.1.2.2.2"><mn mathsize="80%" id="S6.E9Xa.3.2.2.m1.5.5.5.2.2.2">3</mn><mo mathsize="80%" id="S6.E9Xa.3.2.2.m1.7.7.7.4.4.4.1.2.2.2.1">,</mo><mn mathsize="80%" id="S6.E9Xa.3.2.2.m1.6.6.6.3.3.3">4</mn></mrow></mrow><mo mathsize="80%" id="S6.E9Xa.3.2.2.m1.7.7.7.4.4.4.2">,</mo></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex" id="S6.E9Xa.3.2.2.m1.7c">\displaystyle=\left\{\begin{aligned} &amp;{\widetilde{V_{i}}},\ \ i=1,\\
&amp;{\widetilde{R}}_{i}+{Upsample}({\widetilde{R}}_{i+1}),\ \ i=2,3,4,\\
\end{aligned}\right.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S6.E9Xb" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S6.E9Xb.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle F" display="inline"><semantics id="S6.E9Xb.2.1.1.m1.1a"><mi mathsize="80%" id="S6.E9Xb.2.1.1.m1.1.1" xref="S6.E9Xb.2.1.1.m1.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S6.E9Xb.2.1.1.m1.1b"><ci id="S6.E9Xb.2.1.1.m1.1.1.cmml" xref="S6.E9Xb.2.1.1.m1.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.E9Xb.2.1.1.m1.1c">\displaystyle F</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S6.E9Xb.3.2.2.m1.1" class="ltx_math_unparsed" alttext="\displaystyle={Head}\left({Conv}\left(||_{i=1}^{4}H_{i}\right)\right)" display="inline"><semantics id="S6.E9Xb.3.2.2.m1.1a"><mrow id="S6.E9Xb.3.2.2.m1.1b"><mo mathsize="80%" id="S6.E9Xb.3.2.2.m1.1.1">=</mo><mi mathsize="80%" id="S6.E9Xb.3.2.2.m1.1.2">H</mi><mi mathsize="80%" id="S6.E9Xb.3.2.2.m1.1.3">e</mi><mi mathsize="80%" id="S6.E9Xb.3.2.2.m1.1.4">a</mi><mi mathsize="80%" id="S6.E9Xb.3.2.2.m1.1.5">d</mi><mrow id="S6.E9Xb.3.2.2.m1.1.6"><mo id="S6.E9Xb.3.2.2.m1.1.6.1">(</mo><mi mathsize="80%" id="S6.E9Xb.3.2.2.m1.1.6.2">C</mi><mi mathsize="80%" id="S6.E9Xb.3.2.2.m1.1.6.3">o</mi><mi mathsize="80%" id="S6.E9Xb.3.2.2.m1.1.6.4">n</mi><mi mathsize="80%" id="S6.E9Xb.3.2.2.m1.1.6.5">v</mi><mrow id="S6.E9Xb.3.2.2.m1.1.6.6"><mo id="S6.E9Xb.3.2.2.m1.1.6.6.1">(</mo><mo fence="false" maxsize="80%" minsize="80%" rspace="0.167em" id="S6.E9Xb.3.2.2.m1.1.6.6.2">|</mo><msubsup id="S6.E9Xb.3.2.2.m1.1.6.6.3"><mo fence="false" maxsize="80%" minsize="80%" rspace="0.167em" id="S6.E9Xb.3.2.2.m1.1.6.6.3.2.2">|</mo><mrow id="S6.E9Xb.3.2.2.m1.1.6.6.3.2.3"><mi mathsize="80%" id="S6.E9Xb.3.2.2.m1.1.6.6.3.2.3.2">i</mi><mo mathsize="80%" id="S6.E9Xb.3.2.2.m1.1.6.6.3.2.3.1">=</mo><mn mathsize="80%" id="S6.E9Xb.3.2.2.m1.1.6.6.3.2.3.3">1</mn></mrow><mn mathsize="80%" id="S6.E9Xb.3.2.2.m1.1.6.6.3.3">4</mn></msubsup><msub id="S6.E9Xb.3.2.2.m1.1.6.6.4"><mi mathsize="80%" id="S6.E9Xb.3.2.2.m1.1.6.6.4.2">H</mi><mi mathsize="80%" id="S6.E9Xb.3.2.2.m1.1.6.6.4.3">i</mi></msub><mo id="S6.E9Xb.3.2.2.m1.1.6.6.5">)</mo></mrow><mo id="S6.E9Xb.3.2.2.m1.1.6.7">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S6.E9Xb.3.2.2.m1.1c">\displaystyle={Head}\left({Conv}\left(||_{i=1}^{4}H_{i}\right)\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
<figure id="S6.F6" class="ltx_figure"><img src="/html/2212.08296/assets/x6.png" id="S6.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="231" height="95" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S6.F6.2.1.1" class="ltx_text" style="font-size:90%;">Figure 6</span>: </span><span id="S6.F6.3.2" class="ltx_text" style="font-size:90%;">Illustration of decoder in DQnet. The enhanced ResNet features after RBQ are combined with ViT feature to form a simple feature pyramid. (Best viewed in color.)</span></figcaption>
</figure>
<div id="S6.SS1.p4" class="ltx_para ltx_noindent">
<p id="S6.SS1.p4.2" class="ltx_p"><span id="S6.SS1.p4.2.1" class="ltx_text ltx_font_bold">Auxiliary Head</span>
In order to enable the RBQ module to generate more accurate detail querying result <math id="S6.SS1.p4.1.m1.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S6.SS1.p4.1.m1.1a"><mi id="S6.SS1.p4.1.m1.1.1" xref="S6.SS1.p4.1.m1.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S6.SS1.p4.1.m1.1b"><ci id="S6.SS1.p4.1.m1.1.1.cmml" xref="S6.SS1.p4.1.m1.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p4.1.m1.1c">B</annotation></semantics></math> and guide the DQnet to focus on more significant details, an auxiliary head is added to the network for additional output, as shown in <a href="#S6.F6" title="In 6.1 Decoder Framework ‣ 6 Model Details ‣ DQnet: Cross-Model Detail Querying for Camouflaged Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">6</span></a>. To be specific, we let enhanced features <math id="S6.SS1.p4.2.m2.6" class="ltx_Math" alttext="\left\{\bm{B}_{i}|i=1,2,3,4\right\}" display="inline"><semantics id="S6.SS1.p4.2.m2.6a"><mrow id="S6.SS1.p4.2.m2.6.6.2" xref="S6.SS1.p4.2.m2.6.6.3.cmml"><mo id="S6.SS1.p4.2.m2.6.6.2.3" xref="S6.SS1.p4.2.m2.6.6.3.1.cmml">{</mo><msub id="S6.SS1.p4.2.m2.5.5.1.1" xref="S6.SS1.p4.2.m2.5.5.1.1.cmml"><mi id="S6.SS1.p4.2.m2.5.5.1.1.2" xref="S6.SS1.p4.2.m2.5.5.1.1.2.cmml">𝑩</mi><mi id="S6.SS1.p4.2.m2.5.5.1.1.3" xref="S6.SS1.p4.2.m2.5.5.1.1.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S6.SS1.p4.2.m2.6.6.2.4" xref="S6.SS1.p4.2.m2.6.6.3.1.cmml">|</mo><mrow id="S6.SS1.p4.2.m2.6.6.2.2" xref="S6.SS1.p4.2.m2.6.6.2.2.cmml"><mi id="S6.SS1.p4.2.m2.6.6.2.2.2" xref="S6.SS1.p4.2.m2.6.6.2.2.2.cmml">i</mi><mo id="S6.SS1.p4.2.m2.6.6.2.2.1" xref="S6.SS1.p4.2.m2.6.6.2.2.1.cmml">=</mo><mrow id="S6.SS1.p4.2.m2.6.6.2.2.3.2" xref="S6.SS1.p4.2.m2.6.6.2.2.3.1.cmml"><mn id="S6.SS1.p4.2.m2.1.1" xref="S6.SS1.p4.2.m2.1.1.cmml">1</mn><mo id="S6.SS1.p4.2.m2.6.6.2.2.3.2.1" xref="S6.SS1.p4.2.m2.6.6.2.2.3.1.cmml">,</mo><mn id="S6.SS1.p4.2.m2.2.2" xref="S6.SS1.p4.2.m2.2.2.cmml">2</mn><mo id="S6.SS1.p4.2.m2.6.6.2.2.3.2.2" xref="S6.SS1.p4.2.m2.6.6.2.2.3.1.cmml">,</mo><mn id="S6.SS1.p4.2.m2.3.3" xref="S6.SS1.p4.2.m2.3.3.cmml">3</mn><mo id="S6.SS1.p4.2.m2.6.6.2.2.3.2.3" xref="S6.SS1.p4.2.m2.6.6.2.2.3.1.cmml">,</mo><mn id="S6.SS1.p4.2.m2.4.4" xref="S6.SS1.p4.2.m2.4.4.cmml">4</mn></mrow></mrow><mo id="S6.SS1.p4.2.m2.6.6.2.5" xref="S6.SS1.p4.2.m2.6.6.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p4.2.m2.6b"><apply id="S6.SS1.p4.2.m2.6.6.3.cmml" xref="S6.SS1.p4.2.m2.6.6.2"><csymbol cd="latexml" id="S6.SS1.p4.2.m2.6.6.3.1.cmml" xref="S6.SS1.p4.2.m2.6.6.2.3">conditional-set</csymbol><apply id="S6.SS1.p4.2.m2.5.5.1.1.cmml" xref="S6.SS1.p4.2.m2.5.5.1.1"><csymbol cd="ambiguous" id="S6.SS1.p4.2.m2.5.5.1.1.1.cmml" xref="S6.SS1.p4.2.m2.5.5.1.1">subscript</csymbol><ci id="S6.SS1.p4.2.m2.5.5.1.1.2.cmml" xref="S6.SS1.p4.2.m2.5.5.1.1.2">𝑩</ci><ci id="S6.SS1.p4.2.m2.5.5.1.1.3.cmml" xref="S6.SS1.p4.2.m2.5.5.1.1.3">𝑖</ci></apply><apply id="S6.SS1.p4.2.m2.6.6.2.2.cmml" xref="S6.SS1.p4.2.m2.6.6.2.2"><eq id="S6.SS1.p4.2.m2.6.6.2.2.1.cmml" xref="S6.SS1.p4.2.m2.6.6.2.2.1"></eq><ci id="S6.SS1.p4.2.m2.6.6.2.2.2.cmml" xref="S6.SS1.p4.2.m2.6.6.2.2.2">𝑖</ci><list id="S6.SS1.p4.2.m2.6.6.2.2.3.1.cmml" xref="S6.SS1.p4.2.m2.6.6.2.2.3.2"><cn type="integer" id="S6.SS1.p4.2.m2.1.1.cmml" xref="S6.SS1.p4.2.m2.1.1">1</cn><cn type="integer" id="S6.SS1.p4.2.m2.2.2.cmml" xref="S6.SS1.p4.2.m2.2.2">2</cn><cn type="integer" id="S6.SS1.p4.2.m2.3.3.cmml" xref="S6.SS1.p4.2.m2.3.3">3</cn><cn type="integer" id="S6.SS1.p4.2.m2.4.4.cmml" xref="S6.SS1.p4.2.m2.4.4">4</cn></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p4.2.m2.6c">\left\{\bm{B}_{i}|i=1,2,3,4\right\}</annotation></semantics></math> after RBQ getting through a sigmoid layer and a convolution layer, which ends up with four different prediction maps for further supervision with the proposed SAL.</p>
</div>
</section>
<section id="S6.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.2 </span>Multi-scale Cross-Model Querying</h3>

<div id="S6.SS2.p1" class="ltx_para">
<p id="S6.SS2.p1.1" class="ltx_p">The performance of DQnet largely resides in the ability to query details in different scales. The overall algorithm for multi-scale querying is specified in <a href="#alg1" title="In 6.2 Multi-scale Cross-Model Querying ‣ 6 Model Details ‣ DQnet: Cross-Model Detail Querying for Camouflaged Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Algorithm</span> <span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Detail Querying in Multiple Scales</figcaption>
<div id="alg1.3" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span>A training images I, a pretrained CNN <math id="alg1.l1.m1.1" class="ltx_Math" alttext="\mathcal{C}" display="inline"><semantics id="alg1.l1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">\mathcal{C}</annotation></semantics></math> with blocks <math id="alg1.l1.m2.1" class="ltx_Math" alttext="\{\mathcal{C}_{j}\}_{j=1}^{G}" display="inline"><semantics id="alg1.l1.m2.1a"><msubsup id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml"><mrow id="alg1.l1.m2.1.1.1.1.1" xref="alg1.l1.m2.1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l1.m2.1.1.1.1.1.2" xref="alg1.l1.m2.1.1.1.1.2.cmml">{</mo><msub id="alg1.l1.m2.1.1.1.1.1.1" xref="alg1.l1.m2.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l1.m2.1.1.1.1.1.1.2" xref="alg1.l1.m2.1.1.1.1.1.1.2.cmml">𝒞</mi><mi id="alg1.l1.m2.1.1.1.1.1.1.3" xref="alg1.l1.m2.1.1.1.1.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="alg1.l1.m2.1.1.1.1.1.3" xref="alg1.l1.m2.1.1.1.1.2.cmml">}</mo></mrow><mrow id="alg1.l1.m2.1.1.1.3" xref="alg1.l1.m2.1.1.1.3.cmml"><mi id="alg1.l1.m2.1.1.1.3.2" xref="alg1.l1.m2.1.1.1.3.2.cmml">j</mi><mo id="alg1.l1.m2.1.1.1.3.1" xref="alg1.l1.m2.1.1.1.3.1.cmml">=</mo><mn id="alg1.l1.m2.1.1.1.3.3" xref="alg1.l1.m2.1.1.1.3.3.cmml">1</mn></mrow><mi id="alg1.l1.m2.1.1.3" xref="alg1.l1.m2.1.1.3.cmml">G</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><apply id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1"><csymbol cd="ambiguous" id="alg1.l1.m2.1.1.2.cmml" xref="alg1.l1.m2.1.1">superscript</csymbol><apply id="alg1.l1.m2.1.1.1.cmml" xref="alg1.l1.m2.1.1"><csymbol cd="ambiguous" id="alg1.l1.m2.1.1.1.2.cmml" xref="alg1.l1.m2.1.1">subscript</csymbol><set id="alg1.l1.m2.1.1.1.1.2.cmml" xref="alg1.l1.m2.1.1.1.1.1"><apply id="alg1.l1.m2.1.1.1.1.1.1.cmml" xref="alg1.l1.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m2.1.1.1.1.1.1.1.cmml" xref="alg1.l1.m2.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l1.m2.1.1.1.1.1.1.2.cmml" xref="alg1.l1.m2.1.1.1.1.1.1.2">𝒞</ci><ci id="alg1.l1.m2.1.1.1.1.1.1.3.cmml" xref="alg1.l1.m2.1.1.1.1.1.1.3">𝑗</ci></apply></set><apply id="alg1.l1.m2.1.1.1.3.cmml" xref="alg1.l1.m2.1.1.1.3"><eq id="alg1.l1.m2.1.1.1.3.1.cmml" xref="alg1.l1.m2.1.1.1.3.1"></eq><ci id="alg1.l1.m2.1.1.1.3.2.cmml" xref="alg1.l1.m2.1.1.1.3.2">𝑗</ci><cn type="integer" id="alg1.l1.m2.1.1.1.3.3.cmml" xref="alg1.l1.m2.1.1.1.3.3">1</cn></apply></apply><ci id="alg1.l1.m2.1.1.3.cmml" xref="alg1.l1.m2.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">\{\mathcal{C}_{j}\}_{j=1}^{G}</annotation></semantics></math>, a pretrained ViT <math id="alg1.l1.m3.1" class="ltx_Math" alttext="\mathcal{T}" display="inline"><semantics id="alg1.l1.m3.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><ci id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">\mathcal{T}</annotation></semantics></math> and RBQ module <math id="alg1.l1.m4.1" class="ltx_Math" alttext="\mathcal{Q}" display="inline"><semantics id="alg1.l1.m4.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l1.m4.1.1" xref="alg1.l1.m4.1.1.cmml">𝒬</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m4.1b"><ci id="alg1.l1.m4.1.1.cmml" xref="alg1.l1.m4.1.1">𝒬</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m4.1c">\mathcal{Q}</annotation></semantics></math>;

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span><math id="alg1.l2.m1.1" class="ltx_Math" alttext="\{B_{j}\}_{j=1}^{G}" display="inline"><semantics id="alg1.l2.m1.1a"><msubsup id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mrow id="alg1.l2.m1.1.1.1.1.1" xref="alg1.l2.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l2.m1.1.1.1.1.1.2" xref="alg1.l2.m1.1.1.1.1.2.cmml">{</mo><msub id="alg1.l2.m1.1.1.1.1.1.1" xref="alg1.l2.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l2.m1.1.1.1.1.1.1.2" xref="alg1.l2.m1.1.1.1.1.1.1.2.cmml">B</mi><mi id="alg1.l2.m1.1.1.1.1.1.1.3" xref="alg1.l2.m1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="alg1.l2.m1.1.1.1.1.1.3" xref="alg1.l2.m1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="alg1.l2.m1.1.1.1.3" xref="alg1.l2.m1.1.1.1.3.cmml"><mi id="alg1.l2.m1.1.1.1.3.2" xref="alg1.l2.m1.1.1.1.3.2.cmml">j</mi><mo id="alg1.l2.m1.1.1.1.3.1" xref="alg1.l2.m1.1.1.1.3.1.cmml">=</mo><mn id="alg1.l2.m1.1.1.1.3.3" xref="alg1.l2.m1.1.1.1.3.3.cmml">1</mn></mrow><mi id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml">G</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1">superscript</csymbol><apply id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.1.2.cmml" xref="alg1.l2.m1.1.1">subscript</csymbol><set id="alg1.l2.m1.1.1.1.1.2.cmml" xref="alg1.l2.m1.1.1.1.1.1"><apply id="alg1.l2.m1.1.1.1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l2.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l2.m1.1.1.1.1.1.1.2">𝐵</ci><ci id="alg1.l2.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l2.m1.1.1.1.1.1.1.3">𝑗</ci></apply></set><apply id="alg1.l2.m1.1.1.1.3.cmml" xref="alg1.l2.m1.1.1.1.3"><eq id="alg1.l2.m1.1.1.1.3.1.cmml" xref="alg1.l2.m1.1.1.1.3.1"></eq><ci id="alg1.l2.m1.1.1.1.3.2.cmml" xref="alg1.l2.m1.1.1.1.3.2">𝑗</ci><cn type="integer" id="alg1.l2.m1.1.1.1.3.3.cmml" xref="alg1.l2.m1.1.1.1.3.3">1</cn></apply></apply><ci id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">\{B_{j}\}_{j=1}^{G}</annotation></semantics></math>: multi-scale CNN features after enhancement of RBQ;
<math id="alg1.l2.m2.1" class="ltx_Math" alttext="V_{1}" display="inline"><semantics id="alg1.l2.m2.1a"><msub id="alg1.l2.m2.1.1" xref="alg1.l2.m2.1.1.cmml"><mi id="alg1.l2.m2.1.1.2" xref="alg1.l2.m2.1.1.2.cmml">V</mi><mn id="alg1.l2.m2.1.1.3" xref="alg1.l2.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.1b"><apply id="alg1.l2.m2.1.1.cmml" xref="alg1.l2.m2.1.1"><csymbol cd="ambiguous" id="alg1.l2.m2.1.1.1.cmml" xref="alg1.l2.m2.1.1">subscript</csymbol><ci id="alg1.l2.m2.1.1.2.cmml" xref="alg1.l2.m2.1.1.2">𝑉</ci><cn type="integer" id="alg1.l2.m2.1.1.3.cmml" xref="alg1.l2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.1c">V_{1}</annotation></semantics></math>: ViT final feature;

</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span><math id="alg1.l3.m1.1" class="ltx_Math" alttext="V_{1}\leftarrow\mathcal{T}(I)" display="inline"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.2" xref="alg1.l3.m1.1.2.cmml"><msub id="alg1.l3.m1.1.2.2" xref="alg1.l3.m1.1.2.2.cmml"><mi id="alg1.l3.m1.1.2.2.2" xref="alg1.l3.m1.1.2.2.2.cmml">V</mi><mn id="alg1.l3.m1.1.2.2.3" xref="alg1.l3.m1.1.2.2.3.cmml">1</mn></msub><mo stretchy="false" id="alg1.l3.m1.1.2.1" xref="alg1.l3.m1.1.2.1.cmml">←</mo><mrow id="alg1.l3.m1.1.2.3" xref="alg1.l3.m1.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l3.m1.1.2.3.2" xref="alg1.l3.m1.1.2.3.2.cmml">𝒯</mi><mo lspace="0em" rspace="0em" id="alg1.l3.m1.1.2.3.1" xref="alg1.l3.m1.1.2.3.1.cmml">​</mo><mrow id="alg1.l3.m1.1.2.3.3.2" xref="alg1.l3.m1.1.2.3.cmml"><mo stretchy="false" id="alg1.l3.m1.1.2.3.3.2.1" xref="alg1.l3.m1.1.2.3.cmml">(</mo><mi id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">I</mi><mo stretchy="false" id="alg1.l3.m1.1.2.3.3.2.2" xref="alg1.l3.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.2.cmml" xref="alg1.l3.m1.1.2"><ci id="alg1.l3.m1.1.2.1.cmml" xref="alg1.l3.m1.1.2.1">←</ci><apply id="alg1.l3.m1.1.2.2.cmml" xref="alg1.l3.m1.1.2.2"><csymbol cd="ambiguous" id="alg1.l3.m1.1.2.2.1.cmml" xref="alg1.l3.m1.1.2.2">subscript</csymbol><ci id="alg1.l3.m1.1.2.2.2.cmml" xref="alg1.l3.m1.1.2.2.2">𝑉</ci><cn type="integer" id="alg1.l3.m1.1.2.2.3.cmml" xref="alg1.l3.m1.1.2.2.3">1</cn></apply><apply id="alg1.l3.m1.1.2.3.cmml" xref="alg1.l3.m1.1.2.3"><times id="alg1.l3.m1.1.2.3.1.cmml" xref="alg1.l3.m1.1.2.3.1"></times><ci id="alg1.l3.m1.1.2.3.2.cmml" xref="alg1.l3.m1.1.2.3.2">𝒯</ci><ci id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">𝐼</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">V_{1}\leftarrow\mathcal{T}(I)</annotation></semantics></math>;

</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span><span id="alg1.l4.2" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l4.m1.2" class="ltx_Math" alttext="i\in[1,G]" display="inline"><semantics id="alg1.l4.m1.2a"><mrow id="alg1.l4.m1.2.3" xref="alg1.l4.m1.2.3.cmml"><mi id="alg1.l4.m1.2.3.2" xref="alg1.l4.m1.2.3.2.cmml">i</mi><mo id="alg1.l4.m1.2.3.1" xref="alg1.l4.m1.2.3.1.cmml">∈</mo><mrow id="alg1.l4.m1.2.3.3.2" xref="alg1.l4.m1.2.3.3.1.cmml"><mo stretchy="false" id="alg1.l4.m1.2.3.3.2.1" xref="alg1.l4.m1.2.3.3.1.cmml">[</mo><mn id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">1</mn><mo id="alg1.l4.m1.2.3.3.2.2" xref="alg1.l4.m1.2.3.3.1.cmml">,</mo><mi id="alg1.l4.m1.2.2" xref="alg1.l4.m1.2.2.cmml">G</mi><mo stretchy="false" id="alg1.l4.m1.2.3.3.2.3" xref="alg1.l4.m1.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.2b"><apply id="alg1.l4.m1.2.3.cmml" xref="alg1.l4.m1.2.3"><in id="alg1.l4.m1.2.3.1.cmml" xref="alg1.l4.m1.2.3.1"></in><ci id="alg1.l4.m1.2.3.2.cmml" xref="alg1.l4.m1.2.3.2">𝑖</ci><interval closure="closed" id="alg1.l4.m1.2.3.3.1.cmml" xref="alg1.l4.m1.2.3.3.2"><cn type="integer" id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">1</cn><ci id="alg1.l4.m1.2.2.cmml" xref="alg1.l4.m1.2.2">𝐺</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.2c">i\in[1,G]</annotation></semantics></math> <span id="alg1.l4.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.2.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>     <span id="alg1.l5.3" class="ltx_text ltx_font_bold">if</span> <math id="alg1.l5.m1.1" class="ltx_Math" alttext="i=1" display="inline"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mi id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml">i</mi><mo id="alg1.l5.m1.1.1.1" xref="alg1.l5.m1.1.1.1.cmml">=</mo><mn id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><eq id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1"></eq><ci id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2">𝑖</ci><cn type="integer" id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">i=1</annotation></semantics></math> <span id="alg1.l5.4" class="ltx_text ltx_font_bold">then</span> <span id="alg1.l5.1" class="ltx_text" style="float:right;"><math id="alg1.l5.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l5.1.m1.1a"><mo id="alg1.l5.1.m1.1.1" xref="alg1.l5.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l5.1.m1.1b"><ci id="alg1.l5.1.m1.1.1.cmml" xref="alg1.l5.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.1.m1.1c">\triangleright</annotation></semantics></math> Block 1
</span>
</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>         <math id="alg1.l6.m1.1" class="ltx_Math" alttext="R_{1}\leftarrow\mathcal{C}_{1}(I)" display="inline"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.2" xref="alg1.l6.m1.1.2.cmml"><msub id="alg1.l6.m1.1.2.2" xref="alg1.l6.m1.1.2.2.cmml"><mi id="alg1.l6.m1.1.2.2.2" xref="alg1.l6.m1.1.2.2.2.cmml">R</mi><mn id="alg1.l6.m1.1.2.2.3" xref="alg1.l6.m1.1.2.2.3.cmml">1</mn></msub><mo stretchy="false" id="alg1.l6.m1.1.2.1" xref="alg1.l6.m1.1.2.1.cmml">←</mo><mrow id="alg1.l6.m1.1.2.3" xref="alg1.l6.m1.1.2.3.cmml"><msub id="alg1.l6.m1.1.2.3.2" xref="alg1.l6.m1.1.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l6.m1.1.2.3.2.2" xref="alg1.l6.m1.1.2.3.2.2.cmml">𝒞</mi><mn id="alg1.l6.m1.1.2.3.2.3" xref="alg1.l6.m1.1.2.3.2.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="alg1.l6.m1.1.2.3.1" xref="alg1.l6.m1.1.2.3.1.cmml">​</mo><mrow id="alg1.l6.m1.1.2.3.3.2" xref="alg1.l6.m1.1.2.3.cmml"><mo stretchy="false" id="alg1.l6.m1.1.2.3.3.2.1" xref="alg1.l6.m1.1.2.3.cmml">(</mo><mi id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml">I</mi><mo stretchy="false" id="alg1.l6.m1.1.2.3.3.2.2" xref="alg1.l6.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.2.cmml" xref="alg1.l6.m1.1.2"><ci id="alg1.l6.m1.1.2.1.cmml" xref="alg1.l6.m1.1.2.1">←</ci><apply id="alg1.l6.m1.1.2.2.cmml" xref="alg1.l6.m1.1.2.2"><csymbol cd="ambiguous" id="alg1.l6.m1.1.2.2.1.cmml" xref="alg1.l6.m1.1.2.2">subscript</csymbol><ci id="alg1.l6.m1.1.2.2.2.cmml" xref="alg1.l6.m1.1.2.2.2">𝑅</ci><cn type="integer" id="alg1.l6.m1.1.2.2.3.cmml" xref="alg1.l6.m1.1.2.2.3">1</cn></apply><apply id="alg1.l6.m1.1.2.3.cmml" xref="alg1.l6.m1.1.2.3"><times id="alg1.l6.m1.1.2.3.1.cmml" xref="alg1.l6.m1.1.2.3.1"></times><apply id="alg1.l6.m1.1.2.3.2.cmml" xref="alg1.l6.m1.1.2.3.2"><csymbol cd="ambiguous" id="alg1.l6.m1.1.2.3.2.1.cmml" xref="alg1.l6.m1.1.2.3.2">subscript</csymbol><ci id="alg1.l6.m1.1.2.3.2.2.cmml" xref="alg1.l6.m1.1.2.3.2.2">𝒞</ci><cn type="integer" id="alg1.l6.m1.1.2.3.2.3.cmml" xref="alg1.l6.m1.1.2.3.2.3">1</cn></apply><ci id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1">𝐼</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">R_{1}\leftarrow\mathcal{C}_{1}(I)</annotation></semantics></math>;

</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>         <math id="alg1.l7.m1.2" class="ltx_Math" alttext="B_{1}\leftarrow\mathcal{Q}(V_{1},R_{1})" display="inline"><semantics id="alg1.l7.m1.2a"><mrow id="alg1.l7.m1.2.2" xref="alg1.l7.m1.2.2.cmml"><msub id="alg1.l7.m1.2.2.4" xref="alg1.l7.m1.2.2.4.cmml"><mi id="alg1.l7.m1.2.2.4.2" xref="alg1.l7.m1.2.2.4.2.cmml">B</mi><mn id="alg1.l7.m1.2.2.4.3" xref="alg1.l7.m1.2.2.4.3.cmml">1</mn></msub><mo stretchy="false" id="alg1.l7.m1.2.2.3" xref="alg1.l7.m1.2.2.3.cmml">←</mo><mrow id="alg1.l7.m1.2.2.2" xref="alg1.l7.m1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l7.m1.2.2.2.4" xref="alg1.l7.m1.2.2.2.4.cmml">𝒬</mi><mo lspace="0em" rspace="0em" id="alg1.l7.m1.2.2.2.3" xref="alg1.l7.m1.2.2.2.3.cmml">​</mo><mrow id="alg1.l7.m1.2.2.2.2.2" xref="alg1.l7.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="alg1.l7.m1.2.2.2.2.2.3" xref="alg1.l7.m1.2.2.2.2.3.cmml">(</mo><msub id="alg1.l7.m1.1.1.1.1.1.1" xref="alg1.l7.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l7.m1.1.1.1.1.1.1.2" xref="alg1.l7.m1.1.1.1.1.1.1.2.cmml">V</mi><mn id="alg1.l7.m1.1.1.1.1.1.1.3" xref="alg1.l7.m1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="alg1.l7.m1.2.2.2.2.2.4" xref="alg1.l7.m1.2.2.2.2.3.cmml">,</mo><msub id="alg1.l7.m1.2.2.2.2.2.2" xref="alg1.l7.m1.2.2.2.2.2.2.cmml"><mi id="alg1.l7.m1.2.2.2.2.2.2.2" xref="alg1.l7.m1.2.2.2.2.2.2.2.cmml">R</mi><mn id="alg1.l7.m1.2.2.2.2.2.2.3" xref="alg1.l7.m1.2.2.2.2.2.2.3.cmml">1</mn></msub><mo stretchy="false" id="alg1.l7.m1.2.2.2.2.2.5" xref="alg1.l7.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.2b"><apply id="alg1.l7.m1.2.2.cmml" xref="alg1.l7.m1.2.2"><ci id="alg1.l7.m1.2.2.3.cmml" xref="alg1.l7.m1.2.2.3">←</ci><apply id="alg1.l7.m1.2.2.4.cmml" xref="alg1.l7.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l7.m1.2.2.4.1.cmml" xref="alg1.l7.m1.2.2.4">subscript</csymbol><ci id="alg1.l7.m1.2.2.4.2.cmml" xref="alg1.l7.m1.2.2.4.2">𝐵</ci><cn type="integer" id="alg1.l7.m1.2.2.4.3.cmml" xref="alg1.l7.m1.2.2.4.3">1</cn></apply><apply id="alg1.l7.m1.2.2.2.cmml" xref="alg1.l7.m1.2.2.2"><times id="alg1.l7.m1.2.2.2.3.cmml" xref="alg1.l7.m1.2.2.2.3"></times><ci id="alg1.l7.m1.2.2.2.4.cmml" xref="alg1.l7.m1.2.2.2.4">𝒬</ci><interval closure="open" id="alg1.l7.m1.2.2.2.2.3.cmml" xref="alg1.l7.m1.2.2.2.2.2"><apply id="alg1.l7.m1.1.1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l7.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.2">𝑉</ci><cn type="integer" id="alg1.l7.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.3">1</cn></apply><apply id="alg1.l7.m1.2.2.2.2.2.2.cmml" xref="alg1.l7.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l7.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l7.m1.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l7.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l7.m1.2.2.2.2.2.2.2">𝑅</ci><cn type="integer" id="alg1.l7.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l7.m1.2.2.2.2.2.2.3">1</cn></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.2c">B_{1}\leftarrow\mathcal{Q}(V_{1},R_{1})</annotation></semantics></math>;

</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.3.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>     <span id="alg1.l8.2" class="ltx_text ltx_font_bold">else<span id="alg1.l8.2.2" class="ltx_text ltx_font_medium" style="float:right;"><math id="alg1.l8.1.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l8.1.1.m1.1a"><mo id="alg1.l8.1.1.m1.1.1" xref="alg1.l8.1.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l8.1.1.m1.1b"><ci id="alg1.l8.1.1.m1.1.1.cmml" xref="alg1.l8.1.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.1.1.m1.1c">\triangleright</annotation></semantics></math> Block i, <math id="alg1.l8.2.2.m2.1" class="ltx_Math" alttext="1&lt;i\leq G" display="inline"><semantics id="alg1.l8.2.2.m2.1a"><mrow id="alg1.l8.2.2.m2.1.1" xref="alg1.l8.2.2.m2.1.1.cmml"><mn id="alg1.l8.2.2.m2.1.1.2" xref="alg1.l8.2.2.m2.1.1.2.cmml">1</mn><mo id="alg1.l8.2.2.m2.1.1.3" xref="alg1.l8.2.2.m2.1.1.3.cmml">&lt;</mo><mi id="alg1.l8.2.2.m2.1.1.4" xref="alg1.l8.2.2.m2.1.1.4.cmml">i</mi><mo id="alg1.l8.2.2.m2.1.1.5" xref="alg1.l8.2.2.m2.1.1.5.cmml">≤</mo><mi id="alg1.l8.2.2.m2.1.1.6" xref="alg1.l8.2.2.m2.1.1.6.cmml">G</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.2.2.m2.1b"><apply id="alg1.l8.2.2.m2.1.1.cmml" xref="alg1.l8.2.2.m2.1.1"><and id="alg1.l8.2.2.m2.1.1a.cmml" xref="alg1.l8.2.2.m2.1.1"></and><apply id="alg1.l8.2.2.m2.1.1b.cmml" xref="alg1.l8.2.2.m2.1.1"><lt id="alg1.l8.2.2.m2.1.1.3.cmml" xref="alg1.l8.2.2.m2.1.1.3"></lt><cn type="integer" id="alg1.l8.2.2.m2.1.1.2.cmml" xref="alg1.l8.2.2.m2.1.1.2">1</cn><ci id="alg1.l8.2.2.m2.1.1.4.cmml" xref="alg1.l8.2.2.m2.1.1.4">𝑖</ci></apply><apply id="alg1.l8.2.2.m2.1.1c.cmml" xref="alg1.l8.2.2.m2.1.1"><leq id="alg1.l8.2.2.m2.1.1.5.cmml" xref="alg1.l8.2.2.m2.1.1.5"></leq><share href="#alg1.l8.2.2.m2.1.1.4.cmml" id="alg1.l8.2.2.m2.1.1d.cmml" xref="alg1.l8.2.2.m2.1.1"></share><ci id="alg1.l8.2.2.m2.1.1.6.cmml" xref="alg1.l8.2.2.m2.1.1.6">𝐺</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.2.2.m2.1c">1&lt;i\leq G</annotation></semantics></math>
</span></span>
</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>         <math id="alg1.l9.m1.1" class="ltx_Math" alttext="R_{i}\leftarrow\mathcal{C}_{i}(B_{i-1})" display="inline"><semantics id="alg1.l9.m1.1a"><mrow id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><msub id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml"><mi id="alg1.l9.m1.1.1.3.2" xref="alg1.l9.m1.1.1.3.2.cmml">R</mi><mi id="alg1.l9.m1.1.1.3.3" xref="alg1.l9.m1.1.1.3.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml">←</mo><mrow id="alg1.l9.m1.1.1.1" xref="alg1.l9.m1.1.1.1.cmml"><msub id="alg1.l9.m1.1.1.1.3" xref="alg1.l9.m1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l9.m1.1.1.1.3.2" xref="alg1.l9.m1.1.1.1.3.2.cmml">𝒞</mi><mi id="alg1.l9.m1.1.1.1.3.3" xref="alg1.l9.m1.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l9.m1.1.1.1.2" xref="alg1.l9.m1.1.1.1.2.cmml">​</mo><mrow id="alg1.l9.m1.1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l9.m1.1.1.1.1.1.2" xref="alg1.l9.m1.1.1.1.1.1.1.cmml">(</mo><msub id="alg1.l9.m1.1.1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l9.m1.1.1.1.1.1.1.2" xref="alg1.l9.m1.1.1.1.1.1.1.2.cmml">B</mi><mrow id="alg1.l9.m1.1.1.1.1.1.1.3" xref="alg1.l9.m1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l9.m1.1.1.1.1.1.1.3.2" xref="alg1.l9.m1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="alg1.l9.m1.1.1.1.1.1.1.3.1" xref="alg1.l9.m1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="alg1.l9.m1.1.1.1.1.1.1.3.3" xref="alg1.l9.m1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="alg1.l9.m1.1.1.1.1.1.3" xref="alg1.l9.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><ci id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2">←</ci><apply id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.3.1.cmml" xref="alg1.l9.m1.1.1.3">subscript</csymbol><ci id="alg1.l9.m1.1.1.3.2.cmml" xref="alg1.l9.m1.1.1.3.2">𝑅</ci><ci id="alg1.l9.m1.1.1.3.3.cmml" xref="alg1.l9.m1.1.1.3.3">𝑖</ci></apply><apply id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1"><times id="alg1.l9.m1.1.1.1.2.cmml" xref="alg1.l9.m1.1.1.1.2"></times><apply id="alg1.l9.m1.1.1.1.3.cmml" xref="alg1.l9.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.3.1.cmml" xref="alg1.l9.m1.1.1.1.3">subscript</csymbol><ci id="alg1.l9.m1.1.1.1.3.2.cmml" xref="alg1.l9.m1.1.1.1.3.2">𝒞</ci><ci id="alg1.l9.m1.1.1.1.3.3.cmml" xref="alg1.l9.m1.1.1.1.3.3">𝑖</ci></apply><apply id="alg1.l9.m1.1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l9.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.2">𝐵</ci><apply id="alg1.l9.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.3"><minus id="alg1.l9.m1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.3.1"></minus><ci id="alg1.l9.m1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="alg1.l9.m1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">R_{i}\leftarrow\mathcal{C}_{i}(B_{i-1})</annotation></semantics></math>;

</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>         <math id="alg1.l10.m1.2" class="ltx_Math" alttext="B_{i}\leftarrow\mathcal{Q}(V_{1},R_{i})" display="inline"><semantics id="alg1.l10.m1.2a"><mrow id="alg1.l10.m1.2.2" xref="alg1.l10.m1.2.2.cmml"><msub id="alg1.l10.m1.2.2.4" xref="alg1.l10.m1.2.2.4.cmml"><mi id="alg1.l10.m1.2.2.4.2" xref="alg1.l10.m1.2.2.4.2.cmml">B</mi><mi id="alg1.l10.m1.2.2.4.3" xref="alg1.l10.m1.2.2.4.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l10.m1.2.2.3" xref="alg1.l10.m1.2.2.3.cmml">←</mo><mrow id="alg1.l10.m1.2.2.2" xref="alg1.l10.m1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l10.m1.2.2.2.4" xref="alg1.l10.m1.2.2.2.4.cmml">𝒬</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.2.2.2.3" xref="alg1.l10.m1.2.2.2.3.cmml">​</mo><mrow id="alg1.l10.m1.2.2.2.2.2" xref="alg1.l10.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="alg1.l10.m1.2.2.2.2.2.3" xref="alg1.l10.m1.2.2.2.2.3.cmml">(</mo><msub id="alg1.l10.m1.1.1.1.1.1.1" xref="alg1.l10.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l10.m1.1.1.1.1.1.1.2" xref="alg1.l10.m1.1.1.1.1.1.1.2.cmml">V</mi><mn id="alg1.l10.m1.1.1.1.1.1.1.3" xref="alg1.l10.m1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="alg1.l10.m1.2.2.2.2.2.4" xref="alg1.l10.m1.2.2.2.2.3.cmml">,</mo><msub id="alg1.l10.m1.2.2.2.2.2.2" xref="alg1.l10.m1.2.2.2.2.2.2.cmml"><mi id="alg1.l10.m1.2.2.2.2.2.2.2" xref="alg1.l10.m1.2.2.2.2.2.2.2.cmml">R</mi><mi id="alg1.l10.m1.2.2.2.2.2.2.3" xref="alg1.l10.m1.2.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l10.m1.2.2.2.2.2.5" xref="alg1.l10.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.2b"><apply id="alg1.l10.m1.2.2.cmml" xref="alg1.l10.m1.2.2"><ci id="alg1.l10.m1.2.2.3.cmml" xref="alg1.l10.m1.2.2.3">←</ci><apply id="alg1.l10.m1.2.2.4.cmml" xref="alg1.l10.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l10.m1.2.2.4.1.cmml" xref="alg1.l10.m1.2.2.4">subscript</csymbol><ci id="alg1.l10.m1.2.2.4.2.cmml" xref="alg1.l10.m1.2.2.4.2">𝐵</ci><ci id="alg1.l10.m1.2.2.4.3.cmml" xref="alg1.l10.m1.2.2.4.3">𝑖</ci></apply><apply id="alg1.l10.m1.2.2.2.cmml" xref="alg1.l10.m1.2.2.2"><times id="alg1.l10.m1.2.2.2.3.cmml" xref="alg1.l10.m1.2.2.2.3"></times><ci id="alg1.l10.m1.2.2.2.4.cmml" xref="alg1.l10.m1.2.2.2.4">𝒬</ci><interval closure="open" id="alg1.l10.m1.2.2.2.2.3.cmml" xref="alg1.l10.m1.2.2.2.2.2"><apply id="alg1.l10.m1.1.1.1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l10.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.2">𝑉</ci><cn type="integer" id="alg1.l10.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.3">1</cn></apply><apply id="alg1.l10.m1.2.2.2.2.2.2.cmml" xref="alg1.l10.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l10.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l10.m1.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l10.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l10.m1.2.2.2.2.2.2.2">𝑅</ci><ci id="alg1.l10.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l10.m1.2.2.2.2.2.2.3">𝑖</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.2c">B_{i}\leftarrow\mathcal{Q}(V_{1},R_{i})</annotation></semantics></math>;

</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span>     <span id="alg1.l11.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l11.3" class="ltx_text ltx_font_bold">if</span>
</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span><span id="alg1.l12.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l12.3" class="ltx_text ltx_font_bold">for</span>
</div>
</div>
</figure>
</section>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text" style="font-size:90%;">
Nicolas Carion, Francisco Massa, Gabriel Synnaeve, Nicolas Usunier, Alexander
Kirillov, and Sergey Zagoruyko.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.2.1" class="ltx_text" style="font-size:90%;">End-to-end object detection with transformers.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib1.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ECCV</span><span id="bib.bib1.5.3" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text" style="font-size:90%;">
Mathilde Caron, Hugo Touvron, Ishan Misra, Hervé Jégou, Julien Mairal,
Piotr Bojanowski, and Armand Joulin.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.2.1" class="ltx_text" style="font-size:90%;">Emerging properties in self-supervised vision transformers.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib2.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICCV</span><span id="bib.bib2.5.3" class="ltx_text" style="font-size:90%;">, pages 9650–9660, 2021.
</span>
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text" style="font-size:90%;">
Jieneng Chen, Yongyi Lu, Qihang Yu, Xiangde Luo, Ehsan Adeli, Yan Wang, Le Lu,
Alan L Yuille, and Yuyin Zhou.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.2.1" class="ltx_text" style="font-size:90%;">Transunet: Transformers make strong encoders for medical image
segmentation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2102.04306</span><span id="bib.bib3.4.2" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text" style="font-size:90%;">
Xiaoyi Dong, Jianmin Bao, Dongdong Chen, Weiming Zhang, Nenghai Yu, Lu Yuan,
Dong Chen, and Baining Guo.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.2.1" class="ltx_text" style="font-size:90%;">Cswin transformer: A general vision transformer backbone with
cross-shaped windows.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib4.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib4.5.3" class="ltx_text" style="font-size:90%;">, pages 12124–12134, 2022.
</span>
</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text" style="font-size:90%;">
Alexey Dosovitskiy, Lucas Beyer, Alexander Kolesnikov, Dirk Weissenborn,
Xiaohua Zhai, Thomas Unterthiner, Mostafa Dehghani, Matthias Minderer, Georg
Heigold, Sylvain Gelly, Jakob Uszkoreit, and Neil Houlsby.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.2.1" class="ltx_text" style="font-size:90%;">An image is worth 16x16 words: Transformers for image recognition at
scale.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib5.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICLR</span><span id="bib.bib5.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text" style="font-size:90%;">
Deng-Ping Fan, Ming-Ming Cheng, Yun Liu, Tao Li, and Ali Borji.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.2.1" class="ltx_text" style="font-size:90%;">Structure-measure: A new way to evaluate foreground maps.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib6.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICCV</span><span id="bib.bib6.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text" style="font-size:90%;">
Deng-Ping Fan, Ge-Peng Ji, Xuebin Qin, and Ming-Ming Cheng.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.2.1" class="ltx_text" style="font-size:90%;">Cognitive vision inspired object segmentation metric and loss
function.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">SSI</span><span id="bib.bib7.4.2" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text" style="font-size:90%;">
Deng-Ping Fan, Ge-Peng Ji, Guolei Sun, Ming-Ming Cheng, Jianbing Shen, and Ling
Shao.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.2.1" class="ltx_text" style="font-size:90%;">Camouflaged object detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib8.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib8.5.3" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text" style="font-size:90%;">
Deng-Ping Fan, Ge-Peng Ji, Tao Zhou, Geng Chen, Huazhu Fu, Jianbing Shen, and
Ling Shao.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.2.1" class="ltx_text" style="font-size:90%;">Pranet: Parallel reverse attention network for polyp segmentation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib9.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">MICCAI</span><span id="bib.bib9.5.3" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text" style="font-size:90%;">
Deng-Ping Fan, Tao Zhou, Ge-Peng Ji, Yi Zhou, Geng Chen, Huazhu Fu, Jianbing
Shen, and Ling Shao.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.2.1" class="ltx_text" style="font-size:90%;">Inf-net: Automatic covid-19 lung infection segmentation from ct
images.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE TMI</span><span id="bib.bib10.4.2" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text" style="font-size:90%;">
Jiemin Fang, Lingxi Xie, Xinggang Wang, Xiaopeng Zhang, Wenyu Liu, and Qi Tian.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.2.1" class="ltx_text" style="font-size:90%;">Msg-transformer: Exchanging local spatial information by manipulating
messenger tokens.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib11.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib11.5.3" class="ltx_text" style="font-size:90%;">, pages 12063–12072, 2022.
</span>
</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text" style="font-size:90%;">
Kaiming He, Xinlei Chen, Saining Xie, Yanghao Li, Piotr Dollár, and Ross
Girshick.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.2.1" class="ltx_text" style="font-size:90%;">Masked autoencoders are scalable vision learners.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib12.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib12.5.3" class="ltx_text" style="font-size:90%;">, pages 16000–16009, 2022.
</span>
</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text" style="font-size:90%;">
Trung-Nghia Le, Tam V Nguyen, Zhongliang Nie, Minh-Triet Tran, and Akihiro
Sugimoto.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.2.1" class="ltx_text" style="font-size:90%;">Anabranch network for camouflaged object segmentation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Computer Vision and Image Understanding</span><span id="bib.bib13.4.2" class="ltx_text" style="font-size:90%;">, 184:45–56, 2019.
</span>
</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text" style="font-size:90%;">
Aixuan Li, Jing Zhang, Yunqiu Lv, Bowen Liu, Tong Zhang, and Yuchao Dai.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.2.1" class="ltx_text" style="font-size:90%;">Uncertainty-aware joint salient object and camouflaged object
detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib14.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib14.5.3" class="ltx_text" style="font-size:90%;">, pages 10071–10081, 2021.
</span>
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text" style="font-size:90%;">
Chunyuan Li, Jianwei Yang, Pengchuan Zhang, Mei Gao, Bin Xiao, Xiyang Dai, Lu
Yuan, and Jianfeng Gao.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.2.1" class="ltx_text" style="font-size:90%;">Efficient self-supervised vision transformers for representation
learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2106.09785</span><span id="bib.bib15.4.2" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text" style="font-size:90%;">
Wei Liu, Andrew Rabinovich, and Alexander C Berg.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.2.1" class="ltx_text" style="font-size:90%;">Parsenet: Looking wider to see better.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1506.04579</span><span id="bib.bib16.4.2" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text" style="font-size:90%;">
Ze Liu, Yutong Lin, Yue Cao, Han Hu, Yixuan Wei, Zheng Zhang, Stephen Lin, and
Baining Guo.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.2.1" class="ltx_text" style="font-size:90%;">Swin transformer: Hierarchical vision transformer using shifted
windows.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib17.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICCV</span><span id="bib.bib17.5.3" class="ltx_text" style="font-size:90%;">, pages 10012–10022, 2021.
</span>
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text" style="font-size:90%;">
Yunqiu Lv, Jing Zhang, Yuchao Dai, Aixuan Li, Bowen Liu, Nick Barnes, and
Deng-Ping Fan.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.2.1" class="ltx_text" style="font-size:90%;">Simultaneously localize, segment and rank the camouflaged objects.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib18.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib18.5.3" class="ltx_text" style="font-size:90%;">, pages 11591–11601, 2021.
</span>
</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text" style="font-size:90%;">
Ran Margolin, Lihi Zelnik-Manor, and Ayellet Tal.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.2.1" class="ltx_text" style="font-size:90%;">How to evaluate foreground maps?
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib19.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib19.5.3" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text" style="font-size:90%;">
Haiyang Mei, Ge-Peng Ji, Ziqi Wei, Xin Yang, Xiaopeng Wei, and Deng-Ping Fan.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.2.1" class="ltx_text" style="font-size:90%;">Camouflaged object segmentation with distraction mining.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib20.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib20.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock"><span id="bib.bib21.1.1" class="ltx_text" style="font-size:90%;">
Youwei Pang, Xiaoqi Zhao, Tian-Zhu Xiang, Lihe Zhang, and Huchuan Lu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.2.1" class="ltx_text" style="font-size:90%;">Zoom in and out: A mixed-scale triplet network for camouflaged object
detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib21.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib21.5.3" class="ltx_text" style="font-size:90%;">, pages 2160–2170, 2022.
</span>
</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text" style="font-size:90%;">
Jialun Pei, Tianyang Cheng, Deng-Ping Fan, He Tang, Chuanbo Chen, and Luc
Van Gool.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.2.1" class="ltx_text" style="font-size:90%;">Osformer: One-stage camouflaged instance segmentation with
transformers.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib22.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ECCV</span><span id="bib.bib22.5.3" class="ltx_text" style="font-size:90%;">, pages 19–37. Springer, 2022.
</span>
</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text" style="font-size:90%;">
P Skurowski, H Abdulameer, J Błaszczyk, T Depta, A Kornacki, and P
Kozieł.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.2.1" class="ltx_text" style="font-size:90%;">Animal camouflage analysis: Chameleon database.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Unpublished Manuscript</span><span id="bib.bib23.4.2" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock"><span id="bib.bib24.1.1" class="ltx_text" style="font-size:90%;">
Martin Stevens and Sami Merilaita.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.2.1" class="ltx_text" style="font-size:90%;">Animal camouflage: current issues and new perspectives.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Philosophical Transactions of the Royal Society B</span><span id="bib.bib24.4.2" class="ltx_text" style="font-size:90%;">, 2009.
</span>
</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock"><span id="bib.bib25.1.1" class="ltx_text" style="font-size:90%;">
Robin Strudel, Ricardo Garcia, Ivan Laptev, and Cordelia Schmid.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.2.1" class="ltx_text" style="font-size:90%;">Segmenter: Transformer for semantic segmentation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib25.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICCV</span><span id="bib.bib25.5.3" class="ltx_text" style="font-size:90%;">, pages 7262–7272, 2021.
</span>
</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock"><span id="bib.bib26.1.1" class="ltx_text" style="font-size:90%;">
Yujia Sun, Geng Chen, Tao Zhou, Yi Zhang, and Nian Liu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.2.1" class="ltx_text" style="font-size:90%;">Context-aware cross-level fusion network for camouflaged object
detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2105.12555</span><span id="bib.bib26.4.2" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock"><span id="bib.bib27.1.1" class="ltx_text" style="font-size:90%;">
Yujia Sun, Shuo Wang, Chenglizhao Chen, and Tian-Zhu Xiang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.2.1" class="ltx_text" style="font-size:90%;">Boundary-guided camouflaged object detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2207.00794</span><span id="bib.bib27.4.2" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock"><span id="bib.bib28.1.1" class="ltx_text" style="font-size:90%;">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones,
Aidan N Gomez, ukasz Kaiser, and Illia Polosukhin.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.2.1" class="ltx_text" style="font-size:90%;">Attention is All you Need.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.3.1" class="ltx_text" style="font-size:90%;">In I Guyon, U V Luxburg, S Bengio, H Wallach, R Fergus, S
Vishwanathan, and R Garnett, editors, </span><span id="bib.bib28.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NeurIPS</span><span id="bib.bib28.5.3" class="ltx_text" style="font-size:90%;">. Curran Associates, Inc.,
2017.
</span>
</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock"><span id="bib.bib29.1.1" class="ltx_text" style="font-size:90%;">
Wenhai Wang, Enze Xie, Xiang Li, Deng-Ping Fan, Kaitao Song, Ding Liang, Tong
Lu, Ping Luo, and Ling Shao.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.2.1" class="ltx_text" style="font-size:90%;">Pyramid vision transformer: A versatile backbone for dense prediction
without convolutions.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib29.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICCV</span><span id="bib.bib29.5.3" class="ltx_text" style="font-size:90%;">, pages 568–578, 2021.
</span>
</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock"><span id="bib.bib30.1.1" class="ltx_text" style="font-size:90%;">
Xiaolong Wang, Ross B. Girshick, Abhinav Gupta, and Kaiming He.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.2.1" class="ltx_text" style="font-size:90%;">Non-local neural networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib30.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib30.5.3" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock"><span id="bib.bib31.2.1" class="ltx_text" style="font-size:90%;">
J. Wei, S.H. Wang, and Q.M. Huang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.3.1" class="ltx_text" style="font-size:90%;">F</span><sup id="bib.bib31.4.2" class="ltx_sup"><span id="bib.bib31.4.2.1" class="ltx_text" style="font-size:90%;">3</span></sup><span id="bib.bib31.5.3" class="ltx_text" style="font-size:90%;">net: Fusion, feedback and focus for salient object detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.6.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib31.7.2" class="ltx_text ltx_font_italic" style="font-size:90%;">AAAI</span><span id="bib.bib31.8.3" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock"><span id="bib.bib32.1.1" class="ltx_text" style="font-size:90%;">
Chenxi Xie, Changqun Xia, Mingcan Ma, Zhirui Zhao, Xiaowu Chen, and Jia Li.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.2.1" class="ltx_text" style="font-size:90%;">Pyramid grafting network for one-stage high resolution saliency
detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib32.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ECCV</span><span id="bib.bib32.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock"><span id="bib.bib33.1.1" class="ltx_text" style="font-size:90%;">
Jinnan Yan, Trung-Nghia Le, Khanh-Duy Nguyen, Minh-Triet Tran, Thanh-Toan Do,
and Tam V Nguyen.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib33.2.1" class="ltx_text" style="font-size:90%;">Mirrornet: Bio-inspired camouflaged object segmentation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib33.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Access</span><span id="bib.bib33.4.2" class="ltx_text" style="font-size:90%;">, 9:43290–43300, 2021.
</span>
</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock"><span id="bib.bib34.1.1" class="ltx_text" style="font-size:90%;">
Fan Yang, Qiang Zhai, Xin Li, Rui Huang, Ao Luo, Hong Cheng, and Deng-Ping Fan.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib34.2.1" class="ltx_text" style="font-size:90%;">Uncertainty-guided transformer reasoning for camouflaged object
detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib34.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib34.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib34.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock"><span id="bib.bib35.1.1" class="ltx_text" style="font-size:90%;">
Qiang Zhai, Xin Li, Fan Yang, Chenglizhao Chen, Hong Cheng, and Deng-Ping Fan.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib35.2.1" class="ltx_text" style="font-size:90%;">Mutual graph learning for camouflaged object detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib35.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib35.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib35.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock"><span id="bib.bib36.1.1" class="ltx_text" style="font-size:90%;">
Qiming Zhang, Yufei Xu, Jing Zhang, and Dacheng Tao.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib36.2.1" class="ltx_text" style="font-size:90%;">Vsa: Learning varied-size window attention in vision transformers.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib36.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2204.08446</span><span id="bib.bib36.4.2" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2212.08295" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2212.08296" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2212.08296">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2212.08296" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2212.08297" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Mar  1 10:57:28 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
