<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control</title>
<!--Generated on Mon Oct  7 11:15:22 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.04929v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S1" title="In Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S2" title="In Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related works</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S2.SS1" title="In 2 Related works ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Real-time Robot Control Using Model Predictive Control (MPC)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S2.SS2" title="In 2 Related works ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Goal-Conditioned Reinforcement Learning for Robot Control</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S3" title="In Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Preliminaries</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S3.SS1" title="In 3 Preliminaries ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Reinforcement Learning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S3.SS2" title="In 3 Preliminaries ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Value Function Approximation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S3.SS3" title="In 3 Preliminaries ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Model Predictive Control (MPC)</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S4" title="In Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Method</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S4.SS1" title="In 4 Method ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Lower Layer</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S4.SS2" title="In 4 Method ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Upper Layer</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S4.SS3" title="In 4 Method ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Domain Randomization for Robust Value Function Estimation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S4.SS4" title="In 4 Method ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Faster MPC Calculation with a Surrogate Robot Model</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S5" title="In Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S5.SS1" title="In 5 Experiments ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>The Bipedal Inverted Pendulum Robot</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S5.SS2" title="In 5 Experiments ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Path Tracking Tasks</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S5.SS2.SSS0.Px1" title="In 5.2 Path Tracking Tasks ‣ 5 Experiments ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_title">Domain Randomization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S5.SS2.SSS0.Px2" title="In 5.2 Path Tracking Tasks ‣ 5 Experiments ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_title">Surrogate Robot Model Approach</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S5.SS3" title="In 5 Experiments ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Computational Setups</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S6" title="In Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Results</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S6.SS1" title="In 6 Results ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.1 </span>Path Tracking Tasks</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S6.SS2" title="In 6 Results ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.2 </span>Evaluation of Real-Timeness and Control Performance</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S6.SS3" title="In 6 Results ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.3 </span>Evaluation of Robustness</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S7" title="In Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#A1" title="In Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Hyperparameter</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_fleqn">
<h1 class="ltx_title ltx_title_document">Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Mitsuki Morita
</span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Satoshi Yamamori
</span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Satoshi Yagi
</span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Norikazu Sugimoto
</span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jun Morimoto
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id1.id1">While MPC enables nonlinear feedback control by solving an optimal control problem at each timestep, the computational burden tends to be significantly large, making it difficult to optimize a policy within the control period. To address this issue, one possible approach is to utilize terminal value learning to reduce computational costs. However, the learned value cannot be used for other tasks in situations where the task dynamically changes in the original MPC setup. In this study, we develop an MPC framework with goal-conditioned terminal value learning to achieve multi-task policy optimization while reducing computational time. Furthermore, by using a hierarchical control structure that allows the upper-level trajectory planner to output appropriate goal-conditioned trajectories, we demonstrate that a robot model is able to generate diverse motions. We evaluate the proposed method on a bipedal inverted pendulum robot model and confirm that combining goal-conditioned terminal value learning with an upper-level trajectory planner enables real-time control; thus, the robot successfully tracks a target trajectory on sloped terrain.</p>
</div>
<div class="ltx_classification">
<h6 class="ltx_title ltx_title_classification">keywords: </h6>
Model Predictive Control , Goal-Conditioned Reinforcement Learning , Realtime Control

</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_journal" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journal: </span>Neural Networks</span></span></span>
<div class="ltx_para" id="p1">
<span class="ltx_ERROR undefined" id="p1.1">\affiliation</span>
<p class="ltx_p" id="p1.2">[KU]organization=Graduate School of Informatics, Kyoto University,
addressline=Yoshida-honmachi 36-1,
city=Sakyo-ku, Kyoto,
postcode=606-8501,
country=Japan</p>
</div>
<div class="ltx_para" id="p2">
<span class="ltx_ERROR undefined" id="p2.1">\affiliation</span>
<p class="ltx_p" id="p2.2">[ATR]organization=Computational Neuroscience Labs, Advanced Telecomunication Research International (ATR),
addressline=2-2-2 Hikaridai, Seika-cho,
city=Soraku-gun, Kyoto,
postcode=619-0288,
country=Japan</p>
</div>
<div class="ltx_para" id="p3">
<span class="ltx_ERROR undefined" id="p3.1">{graphicalabstract}</span>
</div>
<div class="ltx_para" id="p4">
<span class="ltx_ERROR undefined" id="p4.1">{highlights}</span>
</div>
<div class="ltx_para" id="p5">
<p class="ltx_p" id="p5.1">We propose a method to tackle the trade-off between flexibility and computational efficiency in model predictive control and value function learning for real-time and multi-task control problems.</p>
</div>
<div class="ltx_para" id="p6">
<p class="ltx_p" id="p6.1">The proposed two-stage learning framework with domain randomization for training the hierarchical control strategy achieves a more flexible but faster derivation of the optimal policy than the standard MPC implementation.</p>
</div>
<div class="ltx_para" id="p7">
<p class="ltx_p" id="p7.1">We demonstrate that our proposed method, incorporating the novel idea of using a surrogate robot model, successfully controls a bipedal inverted pendulum system in real time.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="671" id="S1.F1.g1" src="x1.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.16.8.1" style="font-size:90%;">Figure 1</span>: </span><span class="ltx_text" id="S1.F1.14.7" style="font-size:90%;">
Schematic diagram of the proposed method. In the training phase, target goals <math alttext="\boldsymbol{g}_{\mathrm{target}}" class="ltx_Math" display="inline" id="S1.F1.8.1.m1.1"><semantics id="S1.F1.8.1.m1.1b"><msub id="S1.F1.8.1.m1.1.1" xref="S1.F1.8.1.m1.1.1.cmml"><mi id="S1.F1.8.1.m1.1.1.2" xref="S1.F1.8.1.m1.1.1.2.cmml">𝒈</mi><mi id="S1.F1.8.1.m1.1.1.3" xref="S1.F1.8.1.m1.1.1.3.cmml">target</mi></msub><annotation-xml encoding="MathML-Content" id="S1.F1.8.1.m1.1c"><apply id="S1.F1.8.1.m1.1.1.cmml" xref="S1.F1.8.1.m1.1.1"><csymbol cd="ambiguous" id="S1.F1.8.1.m1.1.1.1.cmml" xref="S1.F1.8.1.m1.1.1">subscript</csymbol><ci id="S1.F1.8.1.m1.1.1.2.cmml" xref="S1.F1.8.1.m1.1.1.2">𝒈</ci><ci id="S1.F1.8.1.m1.1.1.3.cmml" xref="S1.F1.8.1.m1.1.1.3">target</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.8.1.m1.1d">\boldsymbol{g}_{\mathrm{target}}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.8.1.m1.1e">bold_italic_g start_POSTSUBSCRIPT roman_target end_POSTSUBSCRIPT</annotation></semantics></math> are sampled from a predefined distribution, and a goal-conditioned value function <math alttext="\hat{V}_{\theta}(\boldsymbol{x}_{t},\boldsymbol{g}_{\mathrm{target}})" class="ltx_Math" display="inline" id="S1.F1.9.2.m2.2"><semantics id="S1.F1.9.2.m2.2b"><mrow id="S1.F1.9.2.m2.2.2" xref="S1.F1.9.2.m2.2.2.cmml"><msub id="S1.F1.9.2.m2.2.2.4" xref="S1.F1.9.2.m2.2.2.4.cmml"><mover accent="true" id="S1.F1.9.2.m2.2.2.4.2" xref="S1.F1.9.2.m2.2.2.4.2.cmml"><mi id="S1.F1.9.2.m2.2.2.4.2.2" xref="S1.F1.9.2.m2.2.2.4.2.2.cmml">V</mi><mo id="S1.F1.9.2.m2.2.2.4.2.1" xref="S1.F1.9.2.m2.2.2.4.2.1.cmml">^</mo></mover><mi id="S1.F1.9.2.m2.2.2.4.3" xref="S1.F1.9.2.m2.2.2.4.3.cmml">θ</mi></msub><mo id="S1.F1.9.2.m2.2.2.3" xref="S1.F1.9.2.m2.2.2.3.cmml">⁢</mo><mrow id="S1.F1.9.2.m2.2.2.2.2" xref="S1.F1.9.2.m2.2.2.2.3.cmml"><mo id="S1.F1.9.2.m2.2.2.2.2.3" stretchy="false" xref="S1.F1.9.2.m2.2.2.2.3.cmml">(</mo><msub id="S1.F1.9.2.m2.1.1.1.1.1" xref="S1.F1.9.2.m2.1.1.1.1.1.cmml"><mi id="S1.F1.9.2.m2.1.1.1.1.1.2" xref="S1.F1.9.2.m2.1.1.1.1.1.2.cmml">𝒙</mi><mi id="S1.F1.9.2.m2.1.1.1.1.1.3" xref="S1.F1.9.2.m2.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S1.F1.9.2.m2.2.2.2.2.4" xref="S1.F1.9.2.m2.2.2.2.3.cmml">,</mo><msub id="S1.F1.9.2.m2.2.2.2.2.2" xref="S1.F1.9.2.m2.2.2.2.2.2.cmml"><mi id="S1.F1.9.2.m2.2.2.2.2.2.2" xref="S1.F1.9.2.m2.2.2.2.2.2.2.cmml">𝒈</mi><mi id="S1.F1.9.2.m2.2.2.2.2.2.3" xref="S1.F1.9.2.m2.2.2.2.2.2.3.cmml">target</mi></msub><mo id="S1.F1.9.2.m2.2.2.2.2.5" stretchy="false" xref="S1.F1.9.2.m2.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.F1.9.2.m2.2c"><apply id="S1.F1.9.2.m2.2.2.cmml" xref="S1.F1.9.2.m2.2.2"><times id="S1.F1.9.2.m2.2.2.3.cmml" xref="S1.F1.9.2.m2.2.2.3"></times><apply id="S1.F1.9.2.m2.2.2.4.cmml" xref="S1.F1.9.2.m2.2.2.4"><csymbol cd="ambiguous" id="S1.F1.9.2.m2.2.2.4.1.cmml" xref="S1.F1.9.2.m2.2.2.4">subscript</csymbol><apply id="S1.F1.9.2.m2.2.2.4.2.cmml" xref="S1.F1.9.2.m2.2.2.4.2"><ci id="S1.F1.9.2.m2.2.2.4.2.1.cmml" xref="S1.F1.9.2.m2.2.2.4.2.1">^</ci><ci id="S1.F1.9.2.m2.2.2.4.2.2.cmml" xref="S1.F1.9.2.m2.2.2.4.2.2">𝑉</ci></apply><ci id="S1.F1.9.2.m2.2.2.4.3.cmml" xref="S1.F1.9.2.m2.2.2.4.3">𝜃</ci></apply><interval closure="open" id="S1.F1.9.2.m2.2.2.2.3.cmml" xref="S1.F1.9.2.m2.2.2.2.2"><apply id="S1.F1.9.2.m2.1.1.1.1.1.cmml" xref="S1.F1.9.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S1.F1.9.2.m2.1.1.1.1.1.1.cmml" xref="S1.F1.9.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S1.F1.9.2.m2.1.1.1.1.1.2.cmml" xref="S1.F1.9.2.m2.1.1.1.1.1.2">𝒙</ci><ci id="S1.F1.9.2.m2.1.1.1.1.1.3.cmml" xref="S1.F1.9.2.m2.1.1.1.1.1.3">𝑡</ci></apply><apply id="S1.F1.9.2.m2.2.2.2.2.2.cmml" xref="S1.F1.9.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S1.F1.9.2.m2.2.2.2.2.2.1.cmml" xref="S1.F1.9.2.m2.2.2.2.2.2">subscript</csymbol><ci id="S1.F1.9.2.m2.2.2.2.2.2.2.cmml" xref="S1.F1.9.2.m2.2.2.2.2.2.2">𝒈</ci><ci id="S1.F1.9.2.m2.2.2.2.2.2.3.cmml" xref="S1.F1.9.2.m2.2.2.2.2.2.3">target</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.9.2.m2.2d">\hat{V}_{\theta}(\boldsymbol{x}_{t},\boldsymbol{g}_{\mathrm{target}})</annotation><annotation encoding="application/x-llamapun" id="S1.F1.9.2.m2.2e">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , bold_italic_g start_POSTSUBSCRIPT roman_target end_POSTSUBSCRIPT )</annotation></semantics></math> is learned using MPC solutions. In the inference phase, the goal trajectory <math alttext="\boldsymbol{g}^{\mathrm{plan}}_{t+H}" class="ltx_Math" display="inline" id="S1.F1.10.3.m3.1"><semantics id="S1.F1.10.3.m3.1b"><msubsup id="S1.F1.10.3.m3.1.1" xref="S1.F1.10.3.m3.1.1.cmml"><mi id="S1.F1.10.3.m3.1.1.2.2" xref="S1.F1.10.3.m3.1.1.2.2.cmml">𝒈</mi><mrow id="S1.F1.10.3.m3.1.1.3" xref="S1.F1.10.3.m3.1.1.3.cmml"><mi id="S1.F1.10.3.m3.1.1.3.2" xref="S1.F1.10.3.m3.1.1.3.2.cmml">t</mi><mo id="S1.F1.10.3.m3.1.1.3.1" xref="S1.F1.10.3.m3.1.1.3.1.cmml">+</mo><mi id="S1.F1.10.3.m3.1.1.3.3" xref="S1.F1.10.3.m3.1.1.3.3.cmml">H</mi></mrow><mi id="S1.F1.10.3.m3.1.1.2.3" xref="S1.F1.10.3.m3.1.1.2.3.cmml">plan</mi></msubsup><annotation-xml encoding="MathML-Content" id="S1.F1.10.3.m3.1c"><apply id="S1.F1.10.3.m3.1.1.cmml" xref="S1.F1.10.3.m3.1.1"><csymbol cd="ambiguous" id="S1.F1.10.3.m3.1.1.1.cmml" xref="S1.F1.10.3.m3.1.1">subscript</csymbol><apply id="S1.F1.10.3.m3.1.1.2.cmml" xref="S1.F1.10.3.m3.1.1"><csymbol cd="ambiguous" id="S1.F1.10.3.m3.1.1.2.1.cmml" xref="S1.F1.10.3.m3.1.1">superscript</csymbol><ci id="S1.F1.10.3.m3.1.1.2.2.cmml" xref="S1.F1.10.3.m3.1.1.2.2">𝒈</ci><ci id="S1.F1.10.3.m3.1.1.2.3.cmml" xref="S1.F1.10.3.m3.1.1.2.3">plan</ci></apply><apply id="S1.F1.10.3.m3.1.1.3.cmml" xref="S1.F1.10.3.m3.1.1.3"><plus id="S1.F1.10.3.m3.1.1.3.1.cmml" xref="S1.F1.10.3.m3.1.1.3.1"></plus><ci id="S1.F1.10.3.m3.1.1.3.2.cmml" xref="S1.F1.10.3.m3.1.1.3.2">𝑡</ci><ci id="S1.F1.10.3.m3.1.1.3.3.cmml" xref="S1.F1.10.3.m3.1.1.3.3">𝐻</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.10.3.m3.1d">\boldsymbol{g}^{\mathrm{plan}}_{t+H}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.10.3.m3.1e">bold_italic_g start_POSTSUPERSCRIPT roman_plan end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t + italic_H end_POSTSUBSCRIPT</annotation></semantics></math> is generated through planning for the MPC horizon. By inputting this trajectory into the MPC, the system can adapt to environmental changes and smoothly adjust its behavior. Here, <math alttext="\boldsymbol{x}_{t}" class="ltx_Math" display="inline" id="S1.F1.11.4.m4.1"><semantics id="S1.F1.11.4.m4.1b"><msub id="S1.F1.11.4.m4.1.1" xref="S1.F1.11.4.m4.1.1.cmml"><mi id="S1.F1.11.4.m4.1.1.2" xref="S1.F1.11.4.m4.1.1.2.cmml">𝒙</mi><mi id="S1.F1.11.4.m4.1.1.3" xref="S1.F1.11.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S1.F1.11.4.m4.1c"><apply id="S1.F1.11.4.m4.1.1.cmml" xref="S1.F1.11.4.m4.1.1"><csymbol cd="ambiguous" id="S1.F1.11.4.m4.1.1.1.cmml" xref="S1.F1.11.4.m4.1.1">subscript</csymbol><ci id="S1.F1.11.4.m4.1.1.2.cmml" xref="S1.F1.11.4.m4.1.1.2">𝒙</ci><ci id="S1.F1.11.4.m4.1.1.3.cmml" xref="S1.F1.11.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.11.4.m4.1d">\boldsymbol{x}_{t}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.11.4.m4.1e">bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\boldsymbol{u}_{t}" class="ltx_Math" display="inline" id="S1.F1.12.5.m5.1"><semantics id="S1.F1.12.5.m5.1b"><msub id="S1.F1.12.5.m5.1.1" xref="S1.F1.12.5.m5.1.1.cmml"><mi id="S1.F1.12.5.m5.1.1.2" xref="S1.F1.12.5.m5.1.1.2.cmml">𝒖</mi><mi id="S1.F1.12.5.m5.1.1.3" xref="S1.F1.12.5.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S1.F1.12.5.m5.1c"><apply id="S1.F1.12.5.m5.1.1.cmml" xref="S1.F1.12.5.m5.1.1"><csymbol cd="ambiguous" id="S1.F1.12.5.m5.1.1.1.cmml" xref="S1.F1.12.5.m5.1.1">subscript</csymbol><ci id="S1.F1.12.5.m5.1.1.2.cmml" xref="S1.F1.12.5.m5.1.1.2">𝒖</ci><ci id="S1.F1.12.5.m5.1.1.3.cmml" xref="S1.F1.12.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.12.5.m5.1d">\boldsymbol{u}_{t}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.12.5.m5.1e">bold_italic_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\boldsymbol{c}_{t}" class="ltx_Math" display="inline" id="S1.F1.13.6.m6.1"><semantics id="S1.F1.13.6.m6.1b"><msub id="S1.F1.13.6.m6.1.1" xref="S1.F1.13.6.m6.1.1.cmml"><mi id="S1.F1.13.6.m6.1.1.2" xref="S1.F1.13.6.m6.1.1.2.cmml">𝒄</mi><mi id="S1.F1.13.6.m6.1.1.3" xref="S1.F1.13.6.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S1.F1.13.6.m6.1c"><apply id="S1.F1.13.6.m6.1.1.cmml" xref="S1.F1.13.6.m6.1.1"><csymbol cd="ambiguous" id="S1.F1.13.6.m6.1.1.1.cmml" xref="S1.F1.13.6.m6.1.1">subscript</csymbol><ci id="S1.F1.13.6.m6.1.1.2.cmml" xref="S1.F1.13.6.m6.1.1.2">𝒄</ci><ci id="S1.F1.13.6.m6.1.1.3.cmml" xref="S1.F1.13.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.13.6.m6.1d">\boldsymbol{c}_{t}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.13.6.m6.1e">bold_italic_c start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\boldsymbol{f}" class="ltx_Math" display="inline" id="S1.F1.14.7.m7.1"><semantics id="S1.F1.14.7.m7.1b"><mi id="S1.F1.14.7.m7.1.1" xref="S1.F1.14.7.m7.1.1.cmml">𝒇</mi><annotation-xml encoding="MathML-Content" id="S1.F1.14.7.m7.1c"><ci id="S1.F1.14.7.m7.1.1.cmml" xref="S1.F1.14.7.m7.1.1">𝒇</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.14.7.m7.1d">\boldsymbol{f}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.14.7.m7.1e">bold_italic_f</annotation></semantics></math> represent the state, control input, cost function, and system dynamics, respectively.</span></figcaption>
</figure>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">In recent years, robot control and autonomous driving have been receiving a lot of attention. For such control targets, Model Predictive Control (MPC) <cite class="ltx_cite ltx_citemacro_citep">(Ohtsuka, <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib30" title="">2017</a>; Tassa et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib39" title="">2014</a>)</cite> is considered a promising approach. MPC provides a nonlinear feedback controller that computes the optimal control commands by solving an optimal control problem at each timestep, predicting the finite future states of the robot.
Solving the optimal control problem is computationally demanding when the control system involves high-dimensional, multi-degree-of-freedom systems or operates in complex environments. This may hinder the completion of computations within the control cycle and prevent the achievement of control objectives.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Therefore, efforts have been made to approximate such complex robot systems with simpler models to solve the optimal control problem within a limited time and achieve control objectives <cite class="ltx_cite ltx_citemacro_citep">(Orin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib31" title="">2013</a>; Sleiman et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib35" title="">2021</a>; Farshidian et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib12" title="">2017</a>; Bledt and Kim, <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib8" title="">2019</a>; Romualdi et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib34" title="">2022</a>)</cite>. However, assumptions such as the limbs being significantly lighter than the torso <cite class="ltx_cite ltx_citemacro_citep">(Orin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib31" title="">2013</a>; Bledt and Kim, <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib8" title="">2019</a>; Romualdi et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib34" title="">2022</a>)</cite>, or the instantaneous controllability of joint angular velocities <cite class="ltx_cite ltx_citemacro_citep">(Sleiman et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib35" title="">2021</a>; Farshidian et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib12" title="">2017</a>)</cite>, are often made. Consequently, large modeling errors can lead to degraded performance or generate infeasible solutions.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Another approach to reducing MPC’s computational costs involves shortening the prediction horizon, which refers to the length of future robot state predictions, by using terminal value learning <cite class="ltx_cite ltx_citemacro_citep">(Lowrey et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib25" title="">2019</a>; Bhardwaj et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib7" title="">2019</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib6" title="">2021</a>)</cite>. While a longer prediction horizon improves control performance, it also increases computational costs. Terminal value learning allows for a shorter prediction horizon without significant performance loss. However, since the learned terminal values are task-specific, this approach limits the flexibility to dynamically change control targets, thus restricting the diversity of motions generated by MPC.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">This study proposes a flexible control method that can change the control target without greatly simplifying the robot model while keeping the computational cost of MPC low. By adopting the idea of goal-conditioned reinforcement learning, our proposed method learns the terminal value with goal-related variables as inputs. Furthermore, we propose a hierarchical control architecture in which the MPC using the learned terminal values serves as the lower-layer controller and the trajectory generator that produces the target condition sequences acts as the upper-layer controller (see also Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">1</span></a>). The proposed hierarchical approach allows for dynamic switching of objectives in response to the surrounding context, thus generating flexible and diverse robot behaviors. To evaluate our proposed method on real-time dynamic control tasks, we applied the method to a simulated model of a bipedal inverted pendulum robot. We successfully achieved real-time control for tasks such as following a lemniscate trajectory on sloped terrain.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">This study includes the following contributions:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We propose a method to tackle the trade-off between flexibility and computational efficiency in model predictive control and value function learning for real-time and multi-task control problems.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">The proposed two-stage learning framework with domain randomization for training the hierarchical control strategy achieves a more flexible but faster derivation of the optimal policy than the standard MPC implementation.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">We demonstrate that our proposed method, incorporating the novel idea of using a surrogate robot model, successfully controls a bipedal inverted pendulum system in real time.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">The rest of the paper is organized as follows. Section <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S2" title="2 Related works ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">2</span></a> describes related work. Section <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S3" title="3 Preliminaries ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">3</span></a> provides preliminaries on reinforcement learning and model predictive control methods. Section <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S4" title="4 Method ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">4</span></a> describes our proposed two-stage learning framework for training a hierarchical control strategy. Section <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S5" title="5 Experiments ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">5</span></a> provides the experimental settings, and Section <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S6" title="6 Results ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">6</span></a> presents the experimental results. Section <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S7" title="7 Conclusion ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">7</span></a> concludes this paper.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related works</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Real-time Robot Control Using Model Predictive Control (MPC)</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">Model Predictive Control (MPC) has been widely applied to numerous robotic control problems. However, utilizing a full-body dynamics model in MPC presents challenges for high-dimensional, multi-degree-of-freedom systems or control tasks in complex environments due to significant computational demands. Most real-world applications of MPC employing a complete system dynamics model have been limited to low-dimensional systems, such as remote-controlled cars or hexacopters, in control tasks <cite class="ltx_cite ltx_citemacro_citep">(Williams et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib43" title="">2016</a>; Neunert et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib29" title="">2016</a>)</cite>. Consequently, applications of full-body MPC to high-dimensional, multi-degree-of-freedom robotic systems, such as humanoid robots, are predominantly confined to simulations <cite class="ltx_cite ltx_citemacro_citep">(Erez et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib11" title="">2013</a>; Tassa et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib38" title="">2012</a>)</cite>, with many practical implementations simplifying the system model <cite class="ltx_cite ltx_citemacro_citep">(Sleiman et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib35" title="">2021</a>; Farshidian et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib12" title="">2017</a>; Bledt and Kim, <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib8" title="">2019</a>; Romualdi et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib34" title="">2022</a>)</cite>. Such approximation methods have proven effective, especially when the limbs’ weight is sufficiently small compared to the total body weight, enabling the generation of dynamic motions. Alternatively, some studies have applied full-body MPC to humanoid robots by separating the robot’s dynamics into fast and slow dynamics, optimizing the fast dynamics at a finer resolution <cite class="ltx_cite ltx_citemacro_citep">(Ishihara et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib17" title="">2019</a>)</cite>. By focusing on the structure of the optimal control problem, a quadruped robot successfully achieved jumping motions using MPC that includes optimization of switch times with a full-body dynamics model <cite class="ltx_cite ltx_citemacro_citep">(Katayama and Ohtsuka, <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib19" title="">2022</a>)</cite>. However, the MPC used in these studies requires a differentiable dynamics model, necessitating careful design at discontinuities in dynamics or rewards compared to probabilistic sampling-based methods <cite class="ltx_cite ltx_citemacro_citep">(Botev et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib9" title="">2013</a>; Goschin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib14" title="">2013</a>; Hansen et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib16" title="">2003</a>)</cite>. Additionally, there is research on solving optimal control problems in advance and utilizing the precomputed solutions in real time, known as Explicit MPC <cite class="ltx_cite ltx_citemacro_citep">(Bemporad et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib4" title="">2002</a>; Zeilinger et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib45" title="">2011</a>; Kvasnica, <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib21" title="">2016</a>)</cite>, which reduces computation costs to a level feasible for embedded controllers due to its minimal online computational demands, though its application is mainly limited to linear systems. Efforts to integrate machine learning frameworks to reduce MPC’s computational cost have been increasingly pursued. In particular, learning the terminal value of MPC from data helps shorten the required prediction horizon and reduce computation time <cite class="ltx_cite ltx_citemacro_citep">(Lowrey et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib25" title="">2019</a>; Bhardwaj et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib7" title="">2019</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib6" title="">2021</a>)</cite>. However, this terminal value depends on the learned task, which does not allow for changes in control objectives during task execution.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Goal-Conditioned Reinforcement Learning for Robot Control</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">Reinforcement learning methods typically train an agent to achieve a single goal, whereas Goal-Conditioned Reinforcement Learning (GCRL) <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib24" title="">2022</a>)</cite> enables an agent to learn to accomplish multiple objectives. GCRL has been widely adopted in robot control studies. For example, a robot’s target speed or position can be specified as goal variables, and the learning process is designed to fulfill these objectives <cite class="ltx_cite ltx_citemacro_citep">(Zhu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib46" title="">2021</a>; Florensa et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib13" title="">2018</a>; Tang and Kucukelbir, <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib37" title="">2020</a>)</cite>. Using images as goal variables offers a more direct form of representation, which is frequently employed in complex tasks. Algorithms that utilize images as goal variables have demonstrated effectiveness in several simulations <cite class="ltx_cite ltx_citemacro_citep">(Warde-Farley et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib42" title="">2019</a>; Lee et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib22" title="">2020</a>; Chane-Sane et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib10" title="">2021</a>)</cite>, and their application to 7-degree-of-freedom real robotic arms has also been reported <cite class="ltx_cite ltx_citemacro_citep">(Nair et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib28" title="">2018</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib27" title="">2019</a>)</cite>. In these cases, the goal variable images represent target locations and other objectives.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Preliminaries</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Reinforcement Learning</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.15">In reinforcement learning, an agent learns policies through interactions with the environment represented as a Markov Decision Process (MDP). An MDP is defined by a tuple <math alttext="\mathcal{M}=(\mathcal{X},\mathcal{U},\mathcal{F},\mathcal{C},\gamma)" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.5"><semantics id="S3.SS1.p1.1.m1.5a"><mrow id="S3.SS1.p1.1.m1.5.6" xref="S3.SS1.p1.1.m1.5.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.5.6.2" xref="S3.SS1.p1.1.m1.5.6.2.cmml">ℳ</mi><mo id="S3.SS1.p1.1.m1.5.6.1" xref="S3.SS1.p1.1.m1.5.6.1.cmml">=</mo><mrow id="S3.SS1.p1.1.m1.5.6.3.2" xref="S3.SS1.p1.1.m1.5.6.3.1.cmml"><mo id="S3.SS1.p1.1.m1.5.6.3.2.1" stretchy="false" xref="S3.SS1.p1.1.m1.5.6.3.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">𝒳</mi><mo id="S3.SS1.p1.1.m1.5.6.3.2.2" xref="S3.SS1.p1.1.m1.5.6.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.2.2" xref="S3.SS1.p1.1.m1.2.2.cmml">𝒰</mi><mo id="S3.SS1.p1.1.m1.5.6.3.2.3" xref="S3.SS1.p1.1.m1.5.6.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.3.3" xref="S3.SS1.p1.1.m1.3.3.cmml">ℱ</mi><mo id="S3.SS1.p1.1.m1.5.6.3.2.4" xref="S3.SS1.p1.1.m1.5.6.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.4.4" xref="S3.SS1.p1.1.m1.4.4.cmml">𝒞</mi><mo id="S3.SS1.p1.1.m1.5.6.3.2.5" xref="S3.SS1.p1.1.m1.5.6.3.1.cmml">,</mo><mi id="S3.SS1.p1.1.m1.5.5" xref="S3.SS1.p1.1.m1.5.5.cmml">γ</mi><mo id="S3.SS1.p1.1.m1.5.6.3.2.6" stretchy="false" xref="S3.SS1.p1.1.m1.5.6.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.5b"><apply id="S3.SS1.p1.1.m1.5.6.cmml" xref="S3.SS1.p1.1.m1.5.6"><eq id="S3.SS1.p1.1.m1.5.6.1.cmml" xref="S3.SS1.p1.1.m1.5.6.1"></eq><ci id="S3.SS1.p1.1.m1.5.6.2.cmml" xref="S3.SS1.p1.1.m1.5.6.2">ℳ</ci><vector id="S3.SS1.p1.1.m1.5.6.3.1.cmml" xref="S3.SS1.p1.1.m1.5.6.3.2"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝒳</ci><ci id="S3.SS1.p1.1.m1.2.2.cmml" xref="S3.SS1.p1.1.m1.2.2">𝒰</ci><ci id="S3.SS1.p1.1.m1.3.3.cmml" xref="S3.SS1.p1.1.m1.3.3">ℱ</ci><ci id="S3.SS1.p1.1.m1.4.4.cmml" xref="S3.SS1.p1.1.m1.4.4">𝒞</ci><ci id="S3.SS1.p1.1.m1.5.5.cmml" xref="S3.SS1.p1.1.m1.5.5">𝛾</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.5c">\mathcal{M}=(\mathcal{X},\mathcal{U},\mathcal{F},\mathcal{C},\gamma)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.5d">caligraphic_M = ( caligraphic_X , caligraphic_U , caligraphic_F , caligraphic_C , italic_γ )</annotation></semantics></math>, where <math alttext="\mathcal{X}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">\mathcal{X}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">caligraphic_X</annotation></semantics></math> and <math alttext="\mathcal{U}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">𝒰</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">𝒰</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">\mathcal{U}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">caligraphic_U</annotation></semantics></math> represent the continuous state and action spaces, respectively. <math alttext="\mathcal{F}" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.1"><semantics id="S3.SS1.p1.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">ℱ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">ℱ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">\mathcal{F}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.1d">caligraphic_F</annotation></semantics></math> represents the state transition probability function, and <math alttext="\mathcal{C}" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.1"><semantics id="S3.SS1.p1.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">\mathcal{C}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.1d">caligraphic_C</annotation></semantics></math> represents the cost function at each step, while <math alttext="\gamma" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m6.1"><semantics id="S3.SS1.p1.6.m6.1a"><mi id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><ci id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m6.1d">italic_γ</annotation></semantics></math> denotes the discount factor. At time <math alttext="t" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m7.1"><semantics id="S3.SS1.p1.7.m7.1a"><mi id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><ci id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m7.1d">italic_t</annotation></semantics></math>, the agent’s state is denoted as <math alttext="\boldsymbol{x}_{t}\in\mathcal{X}" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m8.1"><semantics id="S3.SS1.p1.8.m8.1a"><mrow id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml"><msub id="S3.SS1.p1.8.m8.1.1.2" xref="S3.SS1.p1.8.m8.1.1.2.cmml"><mi id="S3.SS1.p1.8.m8.1.1.2.2" xref="S3.SS1.p1.8.m8.1.1.2.2.cmml">𝒙</mi><mi id="S3.SS1.p1.8.m8.1.1.2.3" xref="S3.SS1.p1.8.m8.1.1.2.3.cmml">t</mi></msub><mo id="S3.SS1.p1.8.m8.1.1.1" xref="S3.SS1.p1.8.m8.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.8.m8.1.1.3" xref="S3.SS1.p1.8.m8.1.1.3.cmml">𝒳</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><apply id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1"><in id="S3.SS1.p1.8.m8.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1.1"></in><apply id="S3.SS1.p1.8.m8.1.1.2.cmml" xref="S3.SS1.p1.8.m8.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.1.1.2.1.cmml" xref="S3.SS1.p1.8.m8.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.8.m8.1.1.2.2.cmml" xref="S3.SS1.p1.8.m8.1.1.2.2">𝒙</ci><ci id="S3.SS1.p1.8.m8.1.1.2.3.cmml" xref="S3.SS1.p1.8.m8.1.1.2.3">𝑡</ci></apply><ci id="S3.SS1.p1.8.m8.1.1.3.cmml" xref="S3.SS1.p1.8.m8.1.1.3">𝒳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">\boldsymbol{x}_{t}\in\mathcal{X}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.8.m8.1d">bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ caligraphic_X</annotation></semantics></math>, and the action is denoted as <math alttext="\boldsymbol{u}_{t}\in\mathcal{U}" class="ltx_Math" display="inline" id="S3.SS1.p1.9.m9.1"><semantics id="S3.SS1.p1.9.m9.1a"><mrow id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml"><msub id="S3.SS1.p1.9.m9.1.1.2" xref="S3.SS1.p1.9.m9.1.1.2.cmml"><mi id="S3.SS1.p1.9.m9.1.1.2.2" xref="S3.SS1.p1.9.m9.1.1.2.2.cmml">𝒖</mi><mi id="S3.SS1.p1.9.m9.1.1.2.3" xref="S3.SS1.p1.9.m9.1.1.2.3.cmml">t</mi></msub><mo id="S3.SS1.p1.9.m9.1.1.1" xref="S3.SS1.p1.9.m9.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.9.m9.1.1.3" xref="S3.SS1.p1.9.m9.1.1.3.cmml">𝒰</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b"><apply id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1"><in id="S3.SS1.p1.9.m9.1.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1.1"></in><apply id="S3.SS1.p1.9.m9.1.1.2.cmml" xref="S3.SS1.p1.9.m9.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.1.1.2.1.cmml" xref="S3.SS1.p1.9.m9.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.9.m9.1.1.2.2.cmml" xref="S3.SS1.p1.9.m9.1.1.2.2">𝒖</ci><ci id="S3.SS1.p1.9.m9.1.1.2.3.cmml" xref="S3.SS1.p1.9.m9.1.1.2.3">𝑡</ci></apply><ci id="S3.SS1.p1.9.m9.1.1.3.cmml" xref="S3.SS1.p1.9.m9.1.1.3">𝒰</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">\boldsymbol{u}_{t}\in\mathcal{U}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.9.m9.1d">bold_italic_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ caligraphic_U</annotation></semantics></math>. The action is often defined by control inputs to the robot, such as joint angle commands, in the context of robot control. The transition probability to the next state <math alttext="\boldsymbol{x}_{t+1}" class="ltx_Math" display="inline" id="S3.SS1.p1.10.m10.1"><semantics id="S3.SS1.p1.10.m10.1a"><msub id="S3.SS1.p1.10.m10.1.1" xref="S3.SS1.p1.10.m10.1.1.cmml"><mi id="S3.SS1.p1.10.m10.1.1.2" xref="S3.SS1.p1.10.m10.1.1.2.cmml">𝒙</mi><mrow id="S3.SS1.p1.10.m10.1.1.3" xref="S3.SS1.p1.10.m10.1.1.3.cmml"><mi id="S3.SS1.p1.10.m10.1.1.3.2" xref="S3.SS1.p1.10.m10.1.1.3.2.cmml">t</mi><mo id="S3.SS1.p1.10.m10.1.1.3.1" xref="S3.SS1.p1.10.m10.1.1.3.1.cmml">+</mo><mn id="S3.SS1.p1.10.m10.1.1.3.3" xref="S3.SS1.p1.10.m10.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m10.1b"><apply id="S3.SS1.p1.10.m10.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m10.1.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1">subscript</csymbol><ci id="S3.SS1.p1.10.m10.1.1.2.cmml" xref="S3.SS1.p1.10.m10.1.1.2">𝒙</ci><apply id="S3.SS1.p1.10.m10.1.1.3.cmml" xref="S3.SS1.p1.10.m10.1.1.3"><plus id="S3.SS1.p1.10.m10.1.1.3.1.cmml" xref="S3.SS1.p1.10.m10.1.1.3.1"></plus><ci id="S3.SS1.p1.10.m10.1.1.3.2.cmml" xref="S3.SS1.p1.10.m10.1.1.3.2">𝑡</ci><cn id="S3.SS1.p1.10.m10.1.1.3.3.cmml" type="integer" xref="S3.SS1.p1.10.m10.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m10.1c">\boldsymbol{x}_{t+1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.10.m10.1d">bold_italic_x start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT</annotation></semantics></math> after taking action <math alttext="\boldsymbol{u}_{t}" class="ltx_Math" display="inline" id="S3.SS1.p1.11.m11.1"><semantics id="S3.SS1.p1.11.m11.1a"><msub id="S3.SS1.p1.11.m11.1.1" xref="S3.SS1.p1.11.m11.1.1.cmml"><mi id="S3.SS1.p1.11.m11.1.1.2" xref="S3.SS1.p1.11.m11.1.1.2.cmml">𝒖</mi><mi id="S3.SS1.p1.11.m11.1.1.3" xref="S3.SS1.p1.11.m11.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m11.1b"><apply id="S3.SS1.p1.11.m11.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.1.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1">subscript</csymbol><ci id="S3.SS1.p1.11.m11.1.1.2.cmml" xref="S3.SS1.p1.11.m11.1.1.2">𝒖</ci><ci id="S3.SS1.p1.11.m11.1.1.3.cmml" xref="S3.SS1.p1.11.m11.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m11.1c">\boldsymbol{u}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.11.m11.1d">bold_italic_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> in state <math alttext="\boldsymbol{x}_{t}" class="ltx_Math" display="inline" id="S3.SS1.p1.12.m12.1"><semantics id="S3.SS1.p1.12.m12.1a"><msub id="S3.SS1.p1.12.m12.1.1" xref="S3.SS1.p1.12.m12.1.1.cmml"><mi id="S3.SS1.p1.12.m12.1.1.2" xref="S3.SS1.p1.12.m12.1.1.2.cmml">𝒙</mi><mi id="S3.SS1.p1.12.m12.1.1.3" xref="S3.SS1.p1.12.m12.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m12.1b"><apply id="S3.SS1.p1.12.m12.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m12.1.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1">subscript</csymbol><ci id="S3.SS1.p1.12.m12.1.1.2.cmml" xref="S3.SS1.p1.12.m12.1.1.2">𝒙</ci><ci id="S3.SS1.p1.12.m12.1.1.3.cmml" xref="S3.SS1.p1.12.m12.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m12.1c">\boldsymbol{x}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.12.m12.1d">bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is defined as <math alttext="\boldsymbol{f}(\boldsymbol{x}_{t+1}|\boldsymbol{x}_{t},\boldsymbol{u}_{t})" class="ltx_Math" display="inline" id="S3.SS1.p1.13.m13.1"><semantics id="S3.SS1.p1.13.m13.1a"><mrow id="S3.SS1.p1.13.m13.1.1" xref="S3.SS1.p1.13.m13.1.1.cmml"><mi id="S3.SS1.p1.13.m13.1.1.3" xref="S3.SS1.p1.13.m13.1.1.3.cmml">𝒇</mi><mo id="S3.SS1.p1.13.m13.1.1.2" xref="S3.SS1.p1.13.m13.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p1.13.m13.1.1.1.1" xref="S3.SS1.p1.13.m13.1.1.1.1.1.cmml"><mo id="S3.SS1.p1.13.m13.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.13.m13.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p1.13.m13.1.1.1.1.1" xref="S3.SS1.p1.13.m13.1.1.1.1.1.cmml"><msub id="S3.SS1.p1.13.m13.1.1.1.1.1.4" xref="S3.SS1.p1.13.m13.1.1.1.1.1.4.cmml"><mi id="S3.SS1.p1.13.m13.1.1.1.1.1.4.2" xref="S3.SS1.p1.13.m13.1.1.1.1.1.4.2.cmml">𝒙</mi><mrow id="S3.SS1.p1.13.m13.1.1.1.1.1.4.3" xref="S3.SS1.p1.13.m13.1.1.1.1.1.4.3.cmml"><mi id="S3.SS1.p1.13.m13.1.1.1.1.1.4.3.2" xref="S3.SS1.p1.13.m13.1.1.1.1.1.4.3.2.cmml">t</mi><mo id="S3.SS1.p1.13.m13.1.1.1.1.1.4.3.1" xref="S3.SS1.p1.13.m13.1.1.1.1.1.4.3.1.cmml">+</mo><mn id="S3.SS1.p1.13.m13.1.1.1.1.1.4.3.3" xref="S3.SS1.p1.13.m13.1.1.1.1.1.4.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="S3.SS1.p1.13.m13.1.1.1.1.1.3" xref="S3.SS1.p1.13.m13.1.1.1.1.1.3.cmml">|</mo><mrow id="S3.SS1.p1.13.m13.1.1.1.1.1.2.2" xref="S3.SS1.p1.13.m13.1.1.1.1.1.2.3.cmml"><msub id="S3.SS1.p1.13.m13.1.1.1.1.1.1.1.1" xref="S3.SS1.p1.13.m13.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.13.m13.1.1.1.1.1.1.1.1.2" xref="S3.SS1.p1.13.m13.1.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mi id="S3.SS1.p1.13.m13.1.1.1.1.1.1.1.1.3" xref="S3.SS1.p1.13.m13.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS1.p1.13.m13.1.1.1.1.1.2.2.3" xref="S3.SS1.p1.13.m13.1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.SS1.p1.13.m13.1.1.1.1.1.2.2.2" xref="S3.SS1.p1.13.m13.1.1.1.1.1.2.2.2.cmml"><mi id="S3.SS1.p1.13.m13.1.1.1.1.1.2.2.2.2" xref="S3.SS1.p1.13.m13.1.1.1.1.1.2.2.2.2.cmml">𝒖</mi><mi id="S3.SS1.p1.13.m13.1.1.1.1.1.2.2.2.3" xref="S3.SS1.p1.13.m13.1.1.1.1.1.2.2.2.3.cmml">t</mi></msub></mrow></mrow><mo id="S3.SS1.p1.13.m13.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.13.m13.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m13.1b"><apply id="S3.SS1.p1.13.m13.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1"><times id="S3.SS1.p1.13.m13.1.1.2.cmml" xref="S3.SS1.p1.13.m13.1.1.2"></times><ci id="S3.SS1.p1.13.m13.1.1.3.cmml" xref="S3.SS1.p1.13.m13.1.1.3">𝒇</ci><apply id="S3.SS1.p1.13.m13.1.1.1.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p1.13.m13.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.13.m13.1.1.1.1.1.3">conditional</csymbol><apply id="S3.SS1.p1.13.m13.1.1.1.1.1.4.cmml" xref="S3.SS1.p1.13.m13.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS1.p1.13.m13.1.1.1.1.1.4.1.cmml" xref="S3.SS1.p1.13.m13.1.1.1.1.1.4">subscript</csymbol><ci id="S3.SS1.p1.13.m13.1.1.1.1.1.4.2.cmml" xref="S3.SS1.p1.13.m13.1.1.1.1.1.4.2">𝒙</ci><apply id="S3.SS1.p1.13.m13.1.1.1.1.1.4.3.cmml" xref="S3.SS1.p1.13.m13.1.1.1.1.1.4.3"><plus id="S3.SS1.p1.13.m13.1.1.1.1.1.4.3.1.cmml" xref="S3.SS1.p1.13.m13.1.1.1.1.1.4.3.1"></plus><ci id="S3.SS1.p1.13.m13.1.1.1.1.1.4.3.2.cmml" xref="S3.SS1.p1.13.m13.1.1.1.1.1.4.3.2">𝑡</ci><cn id="S3.SS1.p1.13.m13.1.1.1.1.1.4.3.3.cmml" type="integer" xref="S3.SS1.p1.13.m13.1.1.1.1.1.4.3.3">1</cn></apply></apply><list id="S3.SS1.p1.13.m13.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p1.13.m13.1.1.1.1.1.2.2"><apply id="S3.SS1.p1.13.m13.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.13.m13.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.13.m13.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.13.m13.1.1.1.1.1.1.1.1.2">𝒙</ci><ci id="S3.SS1.p1.13.m13.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.13.m13.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.SS1.p1.13.m13.1.1.1.1.1.2.2.2.cmml" xref="S3.SS1.p1.13.m13.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.13.m13.1.1.1.1.1.2.2.2.1.cmml" xref="S3.SS1.p1.13.m13.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.13.m13.1.1.1.1.1.2.2.2.2.cmml" xref="S3.SS1.p1.13.m13.1.1.1.1.1.2.2.2.2">𝒖</ci><ci id="S3.SS1.p1.13.m13.1.1.1.1.1.2.2.2.3.cmml" xref="S3.SS1.p1.13.m13.1.1.1.1.1.2.2.2.3">𝑡</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.13.m13.1c">\boldsymbol{f}(\boldsymbol{x}_{t+1}|\boldsymbol{x}_{t},\boldsymbol{u}_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.13.m13.1d">bold_italic_f ( bold_italic_x start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT | bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , bold_italic_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>. Furthermore, the cost function <math alttext="c(\boldsymbol{x}_{t},\boldsymbol{u}_{t})" class="ltx_Math" display="inline" id="S3.SS1.p1.14.m14.2"><semantics id="S3.SS1.p1.14.m14.2a"><mrow id="S3.SS1.p1.14.m14.2.2" xref="S3.SS1.p1.14.m14.2.2.cmml"><mi id="S3.SS1.p1.14.m14.2.2.4" xref="S3.SS1.p1.14.m14.2.2.4.cmml">c</mi><mo id="S3.SS1.p1.14.m14.2.2.3" xref="S3.SS1.p1.14.m14.2.2.3.cmml">⁢</mo><mrow id="S3.SS1.p1.14.m14.2.2.2.2" xref="S3.SS1.p1.14.m14.2.2.2.3.cmml"><mo id="S3.SS1.p1.14.m14.2.2.2.2.3" stretchy="false" xref="S3.SS1.p1.14.m14.2.2.2.3.cmml">(</mo><msub id="S3.SS1.p1.14.m14.1.1.1.1.1" xref="S3.SS1.p1.14.m14.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.14.m14.1.1.1.1.1.2" xref="S3.SS1.p1.14.m14.1.1.1.1.1.2.cmml">𝒙</mi><mi id="S3.SS1.p1.14.m14.1.1.1.1.1.3" xref="S3.SS1.p1.14.m14.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS1.p1.14.m14.2.2.2.2.4" xref="S3.SS1.p1.14.m14.2.2.2.3.cmml">,</mo><msub id="S3.SS1.p1.14.m14.2.2.2.2.2" xref="S3.SS1.p1.14.m14.2.2.2.2.2.cmml"><mi id="S3.SS1.p1.14.m14.2.2.2.2.2.2" xref="S3.SS1.p1.14.m14.2.2.2.2.2.2.cmml">𝒖</mi><mi id="S3.SS1.p1.14.m14.2.2.2.2.2.3" xref="S3.SS1.p1.14.m14.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S3.SS1.p1.14.m14.2.2.2.2.5" stretchy="false" xref="S3.SS1.p1.14.m14.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.14.m14.2b"><apply id="S3.SS1.p1.14.m14.2.2.cmml" xref="S3.SS1.p1.14.m14.2.2"><times id="S3.SS1.p1.14.m14.2.2.3.cmml" xref="S3.SS1.p1.14.m14.2.2.3"></times><ci id="S3.SS1.p1.14.m14.2.2.4.cmml" xref="S3.SS1.p1.14.m14.2.2.4">𝑐</ci><interval closure="open" id="S3.SS1.p1.14.m14.2.2.2.3.cmml" xref="S3.SS1.p1.14.m14.2.2.2.2"><apply id="S3.SS1.p1.14.m14.1.1.1.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m14.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.14.m14.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.14.m14.1.1.1.1.1.2">𝒙</ci><ci id="S3.SS1.p1.14.m14.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.14.m14.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.SS1.p1.14.m14.2.2.2.2.2.cmml" xref="S3.SS1.p1.14.m14.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m14.2.2.2.2.2.1.cmml" xref="S3.SS1.p1.14.m14.2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.14.m14.2.2.2.2.2.2.cmml" xref="S3.SS1.p1.14.m14.2.2.2.2.2.2">𝒖</ci><ci id="S3.SS1.p1.14.m14.2.2.2.2.2.3.cmml" xref="S3.SS1.p1.14.m14.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.14.m14.2c">c(\boldsymbol{x}_{t},\boldsymbol{u}_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.14.m14.2d">italic_c ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , bold_italic_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> is defined as an indicator of the quality of the agent’s state and action at time <math alttext="t" class="ltx_Math" display="inline" id="S3.SS1.p1.15.m15.1"><semantics id="S3.SS1.p1.15.m15.1a"><mi id="S3.SS1.p1.15.m15.1.1" xref="S3.SS1.p1.15.m15.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.15.m15.1b"><ci id="S3.SS1.p1.15.m15.1.1.cmml" xref="S3.SS1.p1.15.m15.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.15.m15.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.15.m15.1d">italic_t</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.5">The probabilistic decision-making process of the agent based on its state is referred to as a policy, denoted as <math alttext="\pi(\boldsymbol{u}_{t}|\boldsymbol{x}_{t})" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><mrow id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml"><mi id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3.cmml">π</mi><mo id="S3.SS1.p2.1.m1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p2.1.m1.1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.1.1.cmml"><mo id="S3.SS1.p2.1.m1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p2.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p2.1.m1.1.1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.1.1.cmml"><msub id="S3.SS1.p2.1.m1.1.1.1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.1.1.1.2.cmml"><mi id="S3.SS1.p2.1.m1.1.1.1.1.1.2.2" xref="S3.SS1.p2.1.m1.1.1.1.1.1.2.2.cmml">𝒖</mi><mi id="S3.SS1.p2.1.m1.1.1.1.1.1.2.3" xref="S3.SS1.p2.1.m1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S3.SS1.p2.1.m1.1.1.1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.cmml">|</mo><msub id="S3.SS1.p2.1.m1.1.1.1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.1.1.1.3.cmml"><mi id="S3.SS1.p2.1.m1.1.1.1.1.1.3.2" xref="S3.SS1.p2.1.m1.1.1.1.1.1.3.2.cmml">𝒙</mi><mi id="S3.SS1.p2.1.m1.1.1.1.1.1.3.3" xref="S3.SS1.p2.1.m1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S3.SS1.p2.1.m1.1.1.1.1.3" stretchy="false" xref="S3.SS1.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1"><times id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2"></times><ci id="S3.SS1.p2.1.m1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3">𝜋</ci><apply id="S3.SS1.p2.1.m1.1.1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p2.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.SS1.p2.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.2.2">𝒖</ci><ci id="S3.SS1.p2.1.m1.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.SS1.p2.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.1.1.3.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.1.1.1.3.2.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.3.2">𝒙</ci><ci id="S3.SS1.p2.1.m1.1.1.1.1.1.3.3.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\pi(\boldsymbol{u}_{t}|\boldsymbol{x}_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">italic_π ( bold_italic_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>. The policy indicates the probability of taking action <math alttext="\boldsymbol{u}_{t}" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><msub id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml"><mi id="S3.SS1.p2.2.m2.1.1.2" xref="S3.SS1.p2.2.m2.1.1.2.cmml">𝒖</mi><mi id="S3.SS1.p2.2.m2.1.1.3" xref="S3.SS1.p2.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.2">𝒖</ci><ci id="S3.SS1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">\boldsymbol{u}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">bold_italic_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> in state <math alttext="\boldsymbol{x}_{t}" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.1"><semantics id="S3.SS1.p2.3.m3.1a"><msub id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml"><mi id="S3.SS1.p2.3.m3.1.1.2" xref="S3.SS1.p2.3.m3.1.1.2.cmml">𝒙</mi><mi id="S3.SS1.p2.3.m3.1.1.3" xref="S3.SS1.p2.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><apply id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p2.3.m3.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2">𝒙</ci><ci id="S3.SS1.p2.3.m3.1.1.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">\boldsymbol{x}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.1d">bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>.
The goal of reinforcement learning is to find the optimal policy <math alttext="\pi^{*}" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m4.1"><semantics id="S3.SS1.p2.4.m4.1a"><msup id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml"><mi id="S3.SS1.p2.4.m4.1.1.2" xref="S3.SS1.p2.4.m4.1.1.2.cmml">π</mi><mo id="S3.SS1.p2.4.m4.1.1.3" xref="S3.SS1.p2.4.m4.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><apply id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">superscript</csymbol><ci id="S3.SS1.p2.4.m4.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.2">𝜋</ci><times id="S3.SS1.p2.4.m4.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">\pi^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m4.1d">italic_π start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> that minimizes the expected value of cumulative cost, which can be formulated using a finite number of steps <math alttext="T" class="ltx_Math" display="inline" id="S3.SS1.p2.5.m5.1"><semantics id="S3.SS1.p2.5.m5.1a"><mi id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><ci id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.5.m5.1d">italic_T</annotation></semantics></math> as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\pi^{*}=\mathop{\rm argmin}\limits_{\pi}\mathbb{E}_{\pi}\left[\sum_{t=0}^{T}c(%
\boldsymbol{x}_{t},\boldsymbol{u}_{t})|\boldsymbol{x}_{0}=\boldsymbol{x}\right]." class="ltx_Math" display="block" id="S3.E1.m1.1"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><msup id="S3.E1.m1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.3.2.cmml">π</mi><mo id="S3.E1.m1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.3.3.cmml">∗</mo></msup><mo id="S3.E1.m1.1.1.1.1.2" rspace="0.1389em" xref="S3.E1.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E1.m1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.cmml"><munder id="S3.E1.m1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.2.cmml"><mo id="S3.E1.m1.1.1.1.1.1.2.2" lspace="0.1389em" movablelimits="false" rspace="0.167em" xref="S3.E1.m1.1.1.1.1.1.2.2.cmml">argmin</mo><mi id="S3.E1.m1.1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.1.2.3.cmml">π</mi></munder><mrow id="S3.E1.m1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.cmml"><msub id="S3.E1.m1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.1.1.3.2.cmml">𝔼</mi><mi id="S3.E1.m1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.1.1.3.3.cmml">π</mi></msub><mo id="S3.E1.m1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml"><munderover id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml"><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.2" lspace="0em" movablelimits="false" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.2.cmml">∑</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.3.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.3.2.cmml">t</mi><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.3.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.3.1.cmml">=</mo><mn id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.3.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.3.3.cmml">0</mn></mrow><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml">T</mi></munderover><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.2.4" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.2.4.cmml">c</mi><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">⁢</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml"><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.3" stretchy="false" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml">(</mo><msub id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.4" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml">,</mo><msub id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.2.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.2.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.2.2.cmml">𝒖</mi><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.2.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.5" stretchy="false" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo fence="false" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">|</mo><msub id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.4" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.4.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.4.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.4.2.cmml">𝒙</mi><mn id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.4.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.4.3.cmml">0</mn></msub></mrow><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.cmml">=</mo><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.4" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.4.cmml">𝒙</mi></mrow><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo id="S3.E1.m1.1.1.1.2" lspace="0em" xref="S3.E1.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><apply id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1"><eq id="S3.E1.m1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.2"></eq><apply id="S3.E1.m1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.3">superscript</csymbol><ci id="S3.E1.m1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.3.2">𝜋</ci><times id="S3.E1.m1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.3.3"></times></apply><apply id="S3.E1.m1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1"><apply id="S3.E1.m1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.2.2">argmin</ci><ci id="S3.E1.m1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.2.3">𝜋</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><times id="S3.E1.m1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2"></times><apply id="S3.E1.m1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.2">𝔼</ci><ci id="S3.E1.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.3">𝜋</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1"><eq id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3"></eq><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="latexml" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.3">conditional</csymbol><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2"><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3">subscript</csymbol><sum id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.2"></sum><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.3"><eq id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.3.1"></eq><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.3.2">𝑡</ci><cn id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.3.3.cmml" type="integer" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.3.3">0</cn></apply></apply><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3.3">𝑇</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.2"><times id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.2.3"></times><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.2.4.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.2.4">𝑐</ci><interval closure="open" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2"><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝒙</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.2.2">𝒖</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></apply><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.4.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.4.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.4">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.4.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.4.2">𝒙</ci><cn id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.4.3.cmml" type="integer" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.4.3">0</cn></apply></apply><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.4">𝒙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">\pi^{*}=\mathop{\rm argmin}\limits_{\pi}\mathbb{E}_{\pi}\left[\sum_{t=0}^{T}c(%
\boldsymbol{x}_{t},\boldsymbol{u}_{t})|\boldsymbol{x}_{0}=\boldsymbol{x}\right].</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.1d">italic_π start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = roman_argmin start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT blackboard_E start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT [ ∑ start_POSTSUBSCRIPT italic_t = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_c ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , bold_italic_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) | bold_italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = bold_italic_x ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p2.6">When the steps continue indefinitely, to prevent the divergence of cumulative cost, a discount rate <math alttext="\gamma\in[0,1)" class="ltx_Math" display="inline" id="S3.SS1.p2.6.m1.2"><semantics id="S3.SS1.p2.6.m1.2a"><mrow id="S3.SS1.p2.6.m1.2.3" xref="S3.SS1.p2.6.m1.2.3.cmml"><mi id="S3.SS1.p2.6.m1.2.3.2" xref="S3.SS1.p2.6.m1.2.3.2.cmml">γ</mi><mo id="S3.SS1.p2.6.m1.2.3.1" xref="S3.SS1.p2.6.m1.2.3.1.cmml">∈</mo><mrow id="S3.SS1.p2.6.m1.2.3.3.2" xref="S3.SS1.p2.6.m1.2.3.3.1.cmml"><mo id="S3.SS1.p2.6.m1.2.3.3.2.1" stretchy="false" xref="S3.SS1.p2.6.m1.2.3.3.1.cmml">[</mo><mn id="S3.SS1.p2.6.m1.1.1" xref="S3.SS1.p2.6.m1.1.1.cmml">0</mn><mo id="S3.SS1.p2.6.m1.2.3.3.2.2" xref="S3.SS1.p2.6.m1.2.3.3.1.cmml">,</mo><mn id="S3.SS1.p2.6.m1.2.2" xref="S3.SS1.p2.6.m1.2.2.cmml">1</mn><mo id="S3.SS1.p2.6.m1.2.3.3.2.3" stretchy="false" xref="S3.SS1.p2.6.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m1.2b"><apply id="S3.SS1.p2.6.m1.2.3.cmml" xref="S3.SS1.p2.6.m1.2.3"><in id="S3.SS1.p2.6.m1.2.3.1.cmml" xref="S3.SS1.p2.6.m1.2.3.1"></in><ci id="S3.SS1.p2.6.m1.2.3.2.cmml" xref="S3.SS1.p2.6.m1.2.3.2">𝛾</ci><interval closure="closed-open" id="S3.SS1.p2.6.m1.2.3.3.1.cmml" xref="S3.SS1.p2.6.m1.2.3.3.2"><cn id="S3.SS1.p2.6.m1.1.1.cmml" type="integer" xref="S3.SS1.p2.6.m1.1.1">0</cn><cn id="S3.SS1.p2.6.m1.2.2.cmml" type="integer" xref="S3.SS1.p2.6.m1.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m1.2c">\gamma\in[0,1)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.6.m1.2d">italic_γ ∈ [ 0 , 1 )</annotation></semantics></math> is introduced, expressed as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\pi^{*}=\mathop{\rm argmin}\limits_{\pi}\mathbb{E}_{\pi}\left[\sum_{t=0}^{%
\infty}\gamma^{t}c(\boldsymbol{x}_{t},\boldsymbol{u}_{t})|\boldsymbol{x}_{0}=%
\boldsymbol{x}\right]." class="ltx_Math" display="block" id="S3.E2.m1.1"><semantics id="S3.E2.m1.1a"><mrow id="S3.E2.m1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml"><mrow id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml"><msup id="S3.E2.m1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.1.3.2.cmml">π</mi><mo id="S3.E2.m1.1.1.1.1.3.3" xref="S3.E2.m1.1.1.1.1.3.3.cmml">∗</mo></msup><mo id="S3.E2.m1.1.1.1.1.2" rspace="0.1389em" xref="S3.E2.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E2.m1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.cmml"><munder id="S3.E2.m1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.2.cmml"><mo id="S3.E2.m1.1.1.1.1.1.2.2" lspace="0.1389em" movablelimits="false" rspace="0.167em" xref="S3.E2.m1.1.1.1.1.1.2.2.cmml">argmin</mo><mi id="S3.E2.m1.1.1.1.1.1.2.3" xref="S3.E2.m1.1.1.1.1.1.2.3.cmml">π</mi></munder><mrow id="S3.E2.m1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.cmml"><msub id="S3.E2.m1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.1.1.1.3.2.cmml">𝔼</mi><mi id="S3.E2.m1.1.1.1.1.1.1.3.3" xref="S3.E2.m1.1.1.1.1.1.1.3.3.cmml">π</mi></msub><mo id="S3.E2.m1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.cmml"><munderover id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml"><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.2" lspace="0em" movablelimits="false" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.2.cmml">∑</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.3.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.3.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.3.2.cmml">t</mi><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.3.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.3.1.cmml">=</mo><mn id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.3.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.3.3.cmml">0</mn></mrow><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.3.3" mathvariant="normal" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml">∞</mi></munderover><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><msup id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.4" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.4.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.4.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.4.2.cmml">γ</mi><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.4.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.4.3.cmml">t</mi></msup><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">⁢</mo><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.5" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.5.cmml">c</mi><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.3a" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">⁢</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml"><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.3" stretchy="false" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml">(</mo><msub id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.4" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml">,</mo><msub id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.2.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.2.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.2.2.cmml">𝒖</mi><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.2.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.5" stretchy="false" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo fence="false" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">|</mo><msub id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.4" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.4.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.4.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.4.2.cmml">𝒙</mi><mn id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.4.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.4.3.cmml">0</mn></msub></mrow><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.cmml">=</mo><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.4" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.4.cmml">𝒙</mi></mrow><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo id="S3.E2.m1.1.1.1.2" lspace="0em" xref="S3.E2.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.1b"><apply id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1"><eq id="S3.E2.m1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.2"></eq><apply id="S3.E2.m1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1.1.3">superscript</csymbol><ci id="S3.E2.m1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.1.3.2">𝜋</ci><times id="S3.E2.m1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.1.1.1.1.3.3"></times></apply><apply id="S3.E2.m1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1"><apply id="S3.E2.m1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.2.2">argmin</ci><ci id="S3.E2.m1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.2.3">𝜋</ci></apply><apply id="S3.E2.m1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1"><times id="S3.E2.m1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.2"></times><apply id="S3.E2.m1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3.2">𝔼</ci><ci id="S3.E2.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3.3">𝜋</ci></apply><apply id="S3.E2.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1"><eq id="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.3"></eq><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="latexml" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.3">conditional</csymbol><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2"><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.3">superscript</csymbol><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.3">subscript</csymbol><sum id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.2"></sum><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.3"><eq id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.3.1"></eq><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.3.2">𝑡</ci><cn id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.3.3.cmml" type="integer" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.3.3">0</cn></apply></apply><infinity id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.3.3"></infinity></apply><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2"><times id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.3"></times><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.4.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.4"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.4.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.4">superscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.4.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.4.2">𝛾</ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.4.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.4.3">𝑡</ci></apply><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.5.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.5">𝑐</ci><interval closure="open" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2"><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝒙</ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.2.2">𝒖</ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></apply><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.4.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.4.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.4">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.4.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.4.2">𝒙</ci><cn id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.4.3.cmml" type="integer" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.4.3">0</cn></apply></apply><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.4">𝒙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.1c">\pi^{*}=\mathop{\rm argmin}\limits_{\pi}\mathbb{E}_{\pi}\left[\sum_{t=0}^{%
\infty}\gamma^{t}c(\boldsymbol{x}_{t},\boldsymbol{u}_{t})|\boldsymbol{x}_{0}=%
\boldsymbol{x}\right].</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.1d">italic_π start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = roman_argmin start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT blackboard_E start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT [ ∑ start_POSTSUBSCRIPT italic_t = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT italic_γ start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT italic_c ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , bold_italic_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) | bold_italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = bold_italic_x ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p2.11">A small discount rate <math alttext="\gamma" class="ltx_Math" display="inline" id="S3.SS1.p2.7.m1.1"><semantics id="S3.SS1.p2.7.m1.1a"><mi id="S3.SS1.p2.7.m1.1.1" xref="S3.SS1.p2.7.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m1.1b"><ci id="S3.SS1.p2.7.m1.1.1.cmml" xref="S3.SS1.p2.7.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m1.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.7.m1.1d">italic_γ</annotation></semantics></math> near <math alttext="0" class="ltx_Math" display="inline" id="S3.SS1.p2.8.m2.1"><semantics id="S3.SS1.p2.8.m2.1a"><mn id="S3.SS1.p2.8.m2.1.1" xref="S3.SS1.p2.8.m2.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m2.1b"><cn id="S3.SS1.p2.8.m2.1.1.cmml" type="integer" xref="S3.SS1.p2.8.m2.1.1">0</cn></annotation-xml></semantics></math> encourages short-sighted actions, while a value closer to 1 seeks to minimize the total cost over the long term. Under policy <math alttext="\pi" class="ltx_Math" display="inline" id="S3.SS1.p2.9.m3.1"><semantics id="S3.SS1.p2.9.m3.1a"><mi id="S3.SS1.p2.9.m3.1.1" xref="S3.SS1.p2.9.m3.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.9.m3.1b"><ci id="S3.SS1.p2.9.m3.1.1.cmml" xref="S3.SS1.p2.9.m3.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.9.m3.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.9.m3.1d">italic_π</annotation></semantics></math>, the sum of the discounted cumulative cost expected to be incurred when the agent’s state is <math alttext="\boldsymbol{x}" class="ltx_Math" display="inline" id="S3.SS1.p2.10.m4.1"><semantics id="S3.SS1.p2.10.m4.1a"><mi id="S3.SS1.p2.10.m4.1.1" xref="S3.SS1.p2.10.m4.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.10.m4.1b"><ci id="S3.SS1.p2.10.m4.1.1.cmml" xref="S3.SS1.p2.10.m4.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.10.m4.1c">\boldsymbol{x}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.10.m4.1d">bold_italic_x</annotation></semantics></math> is called the state value <math alttext="V^{\pi}(\boldsymbol{x})" class="ltx_Math" display="inline" id="S3.SS1.p2.11.m5.1"><semantics id="S3.SS1.p2.11.m5.1a"><mrow id="S3.SS1.p2.11.m5.1.2" xref="S3.SS1.p2.11.m5.1.2.cmml"><msup id="S3.SS1.p2.11.m5.1.2.2" xref="S3.SS1.p2.11.m5.1.2.2.cmml"><mi id="S3.SS1.p2.11.m5.1.2.2.2" xref="S3.SS1.p2.11.m5.1.2.2.2.cmml">V</mi><mi id="S3.SS1.p2.11.m5.1.2.2.3" xref="S3.SS1.p2.11.m5.1.2.2.3.cmml">π</mi></msup><mo id="S3.SS1.p2.11.m5.1.2.1" xref="S3.SS1.p2.11.m5.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.p2.11.m5.1.2.3.2" xref="S3.SS1.p2.11.m5.1.2.cmml"><mo id="S3.SS1.p2.11.m5.1.2.3.2.1" stretchy="false" xref="S3.SS1.p2.11.m5.1.2.cmml">(</mo><mi id="S3.SS1.p2.11.m5.1.1" xref="S3.SS1.p2.11.m5.1.1.cmml">𝒙</mi><mo id="S3.SS1.p2.11.m5.1.2.3.2.2" stretchy="false" xref="S3.SS1.p2.11.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.11.m5.1b"><apply id="S3.SS1.p2.11.m5.1.2.cmml" xref="S3.SS1.p2.11.m5.1.2"><times id="S3.SS1.p2.11.m5.1.2.1.cmml" xref="S3.SS1.p2.11.m5.1.2.1"></times><apply id="S3.SS1.p2.11.m5.1.2.2.cmml" xref="S3.SS1.p2.11.m5.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.11.m5.1.2.2.1.cmml" xref="S3.SS1.p2.11.m5.1.2.2">superscript</csymbol><ci id="S3.SS1.p2.11.m5.1.2.2.2.cmml" xref="S3.SS1.p2.11.m5.1.2.2.2">𝑉</ci><ci id="S3.SS1.p2.11.m5.1.2.2.3.cmml" xref="S3.SS1.p2.11.m5.1.2.2.3">𝜋</ci></apply><ci id="S3.SS1.p2.11.m5.1.1.cmml" xref="S3.SS1.p2.11.m5.1.1">𝒙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.11.m5.1c">V^{\pi}(\boldsymbol{x})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.11.m5.1d">italic_V start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT ( bold_italic_x )</annotation></semantics></math>, defined as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="V^{\pi}(\boldsymbol{x}):=\mathbb{E}_{\pi}\left[\sum_{t=0}^{\infty}\gamma^{t}c(%
\boldsymbol{x}_{t},\boldsymbol{u}_{t})|\boldsymbol{x}_{0}=\boldsymbol{x}\right]." class="ltx_Math" display="block" id="S3.E3.m1.2"><semantics id="S3.E3.m1.2a"><mrow id="S3.E3.m1.2.2.1" xref="S3.E3.m1.2.2.1.1.cmml"><mrow id="S3.E3.m1.2.2.1.1" xref="S3.E3.m1.2.2.1.1.cmml"><mrow id="S3.E3.m1.2.2.1.1.3" xref="S3.E3.m1.2.2.1.1.3.cmml"><msup id="S3.E3.m1.2.2.1.1.3.2" xref="S3.E3.m1.2.2.1.1.3.2.cmml"><mi id="S3.E3.m1.2.2.1.1.3.2.2" xref="S3.E3.m1.2.2.1.1.3.2.2.cmml">V</mi><mi id="S3.E3.m1.2.2.1.1.3.2.3" xref="S3.E3.m1.2.2.1.1.3.2.3.cmml">π</mi></msup><mo id="S3.E3.m1.2.2.1.1.3.1" xref="S3.E3.m1.2.2.1.1.3.1.cmml">⁢</mo><mrow id="S3.E3.m1.2.2.1.1.3.3.2" xref="S3.E3.m1.2.2.1.1.3.cmml"><mo id="S3.E3.m1.2.2.1.1.3.3.2.1" stretchy="false" xref="S3.E3.m1.2.2.1.1.3.cmml">(</mo><mi id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">𝒙</mi><mo id="S3.E3.m1.2.2.1.1.3.3.2.2" rspace="0.278em" stretchy="false" xref="S3.E3.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.2.2.1.1.2" rspace="0.278em" xref="S3.E3.m1.2.2.1.1.2.cmml">:=</mo><mrow id="S3.E3.m1.2.2.1.1.1" xref="S3.E3.m1.2.2.1.1.1.cmml"><msub id="S3.E3.m1.2.2.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.3.cmml"><mi id="S3.E3.m1.2.2.1.1.1.3.2" xref="S3.E3.m1.2.2.1.1.1.3.2.cmml">𝔼</mi><mi id="S3.E3.m1.2.2.1.1.1.3.3" xref="S3.E3.m1.2.2.1.1.1.3.3.cmml">π</mi></msub><mo id="S3.E3.m1.2.2.1.1.1.2" xref="S3.E3.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.2.2.1.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.2.cmml"><mo id="S3.E3.m1.2.2.1.1.1.1.1.2" xref="S3.E3.m1.2.2.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E3.m1.2.2.1.1.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.1.cmml"><mrow id="S3.E3.m1.2.2.1.1.1.1.1.1.2" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.cmml"><mrow id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.cmml"><munderover id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.3" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.3.cmml"><mo id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.3.2.2" lspace="0em" movablelimits="false" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.3.2.2.cmml">∑</mo><mrow id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.3.2.3" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.3.2.3.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.3.2.3.2" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.3.2.3.2.cmml">t</mi><mo id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.3.2.3.1" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.3.2.3.1.cmml">=</mo><mn id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.3.2.3.3" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.3.2.3.3.cmml">0</mn></mrow><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.3.3" mathvariant="normal" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.3.3.cmml">∞</mi></munderover><mrow id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.cmml"><msup id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.4" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.4.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.4.2" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.4.2.cmml">γ</mi><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.4.3" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.4.3.cmml">t</mi></msup><mo id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.3" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.3.cmml">⁢</mo><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.5" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.5.cmml">c</mi><mo id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.3a" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.3.cmml">⁢</mo><mrow id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.2.2" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.2.3.cmml"><mo id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.2.2.3" stretchy="false" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.2.3.cmml">(</mo><msub id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.2.2.4" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.2.3.cmml">,</mo><msub id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.2.2.2" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.2.2.2.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.2.2.2.2" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.2.2.2.2.cmml">𝒖</mi><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.2.2.2.3" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.2.2.5" stretchy="false" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo fence="false" id="S3.E3.m1.2.2.1.1.1.1.1.1.2.3" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.3.cmml">|</mo><msub id="S3.E3.m1.2.2.1.1.1.1.1.1.2.4" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.4.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.2.4.2" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.4.2.cmml">𝒙</mi><mn id="S3.E3.m1.2.2.1.1.1.1.1.1.2.4.3" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.4.3.cmml">0</mn></msub></mrow><mo id="S3.E3.m1.2.2.1.1.1.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.1.1.1.3.cmml">=</mo><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.4" xref="S3.E3.m1.2.2.1.1.1.1.1.1.4.cmml">𝒙</mi></mrow><mo id="S3.E3.m1.2.2.1.1.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S3.E3.m1.2.2.1.2" lspace="0em" xref="S3.E3.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.2b"><apply id="S3.E3.m1.2.2.1.1.cmml" xref="S3.E3.m1.2.2.1"><csymbol cd="latexml" id="S3.E3.m1.2.2.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.2">assign</csymbol><apply id="S3.E3.m1.2.2.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.3"><times id="S3.E3.m1.2.2.1.1.3.1.cmml" xref="S3.E3.m1.2.2.1.1.3.1"></times><apply id="S3.E3.m1.2.2.1.1.3.2.cmml" xref="S3.E3.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.3.2.1.cmml" xref="S3.E3.m1.2.2.1.1.3.2">superscript</csymbol><ci id="S3.E3.m1.2.2.1.1.3.2.2.cmml" xref="S3.E3.m1.2.2.1.1.3.2.2">𝑉</ci><ci id="S3.E3.m1.2.2.1.1.3.2.3.cmml" xref="S3.E3.m1.2.2.1.1.3.2.3">𝜋</ci></apply><ci id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">𝒙</ci></apply><apply id="S3.E3.m1.2.2.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1"><times id="S3.E3.m1.2.2.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.2"></times><apply id="S3.E3.m1.2.2.1.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.3.1.cmml" xref="S3.E3.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.1.3.2.cmml" xref="S3.E3.m1.2.2.1.1.1.3.2">𝔼</ci><ci id="S3.E3.m1.2.2.1.1.1.3.3.cmml" xref="S3.E3.m1.2.2.1.1.1.3.3">𝜋</ci></apply><apply id="S3.E3.m1.2.2.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.2.2.1.1.1.1.2.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E3.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1"><eq id="S3.E3.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.3"></eq><apply id="S3.E3.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2"><csymbol cd="latexml" id="S3.E3.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.3">conditional</csymbol><apply id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2"><apply id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.3">superscript</csymbol><apply id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.3.2.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.3">subscript</csymbol><sum id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.3.2.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.3.2.2"></sum><apply id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.3.2.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.3.2.3"><eq id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.3.2.3.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.3.2.3.1"></eq><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.3.2.3.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.3.2.3.2">𝑡</ci><cn id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.3.2.3.3.cmml" type="integer" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.3.2.3.3">0</cn></apply></apply><infinity id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.3.3"></infinity></apply><apply id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2"><times id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.3"></times><apply id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.4.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.4"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.4.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.4">superscript</csymbol><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.4.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.4.2">𝛾</ci><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.4.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.4.3">𝑡</ci></apply><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.5.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.5">𝑐</ci><interval closure="open" id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.2.2"><apply id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2">𝒙</ci><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.2.2.2.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.2.2.2.2">𝒖</ci><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.2.2.2.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></apply><apply id="S3.E3.m1.2.2.1.1.1.1.1.1.2.4.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.1.1.2.4.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.4">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.2.4.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.4.2">𝒙</ci><cn id="S3.E3.m1.2.2.1.1.1.1.1.1.2.4.3.cmml" type="integer" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.4.3">0</cn></apply></apply><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.4.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.4">𝒙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.2c">V^{\pi}(\boldsymbol{x}):=\mathbb{E}_{\pi}\left[\sum_{t=0}^{\infty}\gamma^{t}c(%
\boldsymbol{x}_{t},\boldsymbol{u}_{t})|\boldsymbol{x}_{0}=\boldsymbol{x}\right].</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.2d">italic_V start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT ( bold_italic_x ) := blackboard_E start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT [ ∑ start_POSTSUBSCRIPT italic_t = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT italic_γ start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT italic_c ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , bold_italic_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) | bold_italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = bold_italic_x ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Value Function Approximation</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.5">The optimal value function is defined as the expected discounted cumulative cost that an agent receives under the optimal policy. The Bellman operator <math alttext="\mathcal{B}" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\mathcal{B}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">caligraphic_B</annotation></semantics></math> is defined in Eq.(<a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S3.E4" title="In 3.2 Value Function Approximation ‣ 3 Preliminaries ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">4</span></a>), and by applying it iteratively to any bounded function, the optimal value function can be determined <cite class="ltx_cite ltx_citemacro_citep">(Sutton and Barto, <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib36" title="">2018</a>)</cite>. The optimal value function <math alttext="V^{*}" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><msup id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">V</mi><mo id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">superscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">𝑉</ci><times id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">V^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">italic_V start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> is the fixed point of the Bellman operator <math alttext="\mathcal{B}" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">\mathcal{B}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">caligraphic_B</annotation></semantics></math>, as shown in Eq.(<a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S3.E5" title="In 3.2 Value Function Approximation ‣ 3 Preliminaries ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">5</span></a>), where <math alttext="\boldsymbol{x^{\prime}}" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m4.1"><semantics id="S3.SS2.p1.4.m4.1a"><msup id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><mi id="S3.SS2.p1.4.m4.1.1.2" xref="S3.SS2.p1.4.m4.1.1.2.cmml">𝒙</mi><mo class="ltx_mathvariant_bold" id="S3.SS2.p1.4.m4.1.1.3" mathvariant="bold" xref="S3.SS2.p1.4.m4.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">superscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2">𝒙</ci><ci id="S3.SS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3">bold-′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">\boldsymbol{x^{\prime}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m4.1d">bold_italic_x start_POSTSUPERSCRIPT bold_′ end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the next state of <math alttext="\boldsymbol{x}" class="ltx_Math" display="inline" id="S3.SS2.p1.5.m5.1"><semantics id="S3.SS2.p1.5.m5.1a"><mi id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><ci id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">\boldsymbol{x}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.5.m5.1d">bold_italic_x</annotation></semantics></math>.</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\mathcal{B}V(\boldsymbol{x}):=\min_{\boldsymbol{u}}\mathbb{E}\left[c(%
\boldsymbol{x},\boldsymbol{u})+\gamma V(\boldsymbol{x}^{\prime})\right]." class="ltx_Math" display="block" id="S3.E4.m1.4"><semantics id="S3.E4.m1.4a"><mrow id="S3.E4.m1.4.4.1" xref="S3.E4.m1.4.4.1.1.cmml"><mrow id="S3.E4.m1.4.4.1.1" xref="S3.E4.m1.4.4.1.1.cmml"><mrow id="S3.E4.m1.4.4.1.1.3" xref="S3.E4.m1.4.4.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.4.4.1.1.3.2" xref="S3.E4.m1.4.4.1.1.3.2.cmml">ℬ</mi><mo id="S3.E4.m1.4.4.1.1.3.1" xref="S3.E4.m1.4.4.1.1.3.1.cmml">⁢</mo><mi id="S3.E4.m1.4.4.1.1.3.3" xref="S3.E4.m1.4.4.1.1.3.3.cmml">V</mi><mo id="S3.E4.m1.4.4.1.1.3.1a" xref="S3.E4.m1.4.4.1.1.3.1.cmml">⁢</mo><mrow id="S3.E4.m1.4.4.1.1.3.4.2" xref="S3.E4.m1.4.4.1.1.3.cmml"><mo id="S3.E4.m1.4.4.1.1.3.4.2.1" stretchy="false" xref="S3.E4.m1.4.4.1.1.3.cmml">(</mo><mi id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml">𝒙</mi><mo id="S3.E4.m1.4.4.1.1.3.4.2.2" rspace="0.278em" stretchy="false" xref="S3.E4.m1.4.4.1.1.3.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.4.4.1.1.2" rspace="0.278em" xref="S3.E4.m1.4.4.1.1.2.cmml">:=</mo><mrow id="S3.E4.m1.4.4.1.1.1" xref="S3.E4.m1.4.4.1.1.1.cmml"><mrow id="S3.E4.m1.4.4.1.1.1.3" xref="S3.E4.m1.4.4.1.1.1.3.cmml"><munder id="S3.E4.m1.4.4.1.1.1.3.1" xref="S3.E4.m1.4.4.1.1.1.3.1.cmml"><mi id="S3.E4.m1.4.4.1.1.1.3.1.2" xref="S3.E4.m1.4.4.1.1.1.3.1.2.cmml">min</mi><mi id="S3.E4.m1.4.4.1.1.1.3.1.3" xref="S3.E4.m1.4.4.1.1.1.3.1.3.cmml">𝒖</mi></munder><mo id="S3.E4.m1.4.4.1.1.1.3a" lspace="0.167em" xref="S3.E4.m1.4.4.1.1.1.3.cmml">⁡</mo><mi id="S3.E4.m1.4.4.1.1.1.3.2" xref="S3.E4.m1.4.4.1.1.1.3.2.cmml">𝔼</mi></mrow><mo id="S3.E4.m1.4.4.1.1.1.2" xref="S3.E4.m1.4.4.1.1.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.4.4.1.1.1.1.1" xref="S3.E4.m1.4.4.1.1.1.1.2.cmml"><mo id="S3.E4.m1.4.4.1.1.1.1.1.2" xref="S3.E4.m1.4.4.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E4.m1.4.4.1.1.1.1.1.1" xref="S3.E4.m1.4.4.1.1.1.1.1.1.cmml"><mrow id="S3.E4.m1.4.4.1.1.1.1.1.1.3" xref="S3.E4.m1.4.4.1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.4.4.1.1.1.1.1.1.3.2" xref="S3.E4.m1.4.4.1.1.1.1.1.1.3.2.cmml">c</mi><mo id="S3.E4.m1.4.4.1.1.1.1.1.1.3.1" xref="S3.E4.m1.4.4.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.E4.m1.4.4.1.1.1.1.1.1.3.3.2" xref="S3.E4.m1.4.4.1.1.1.1.1.1.3.3.1.cmml"><mo id="S3.E4.m1.4.4.1.1.1.1.1.1.3.3.2.1" stretchy="false" xref="S3.E4.m1.4.4.1.1.1.1.1.1.3.3.1.cmml">(</mo><mi id="S3.E4.m1.2.2" xref="S3.E4.m1.2.2.cmml">𝒙</mi><mo id="S3.E4.m1.4.4.1.1.1.1.1.1.3.3.2.2" xref="S3.E4.m1.4.4.1.1.1.1.1.1.3.3.1.cmml">,</mo><mi id="S3.E4.m1.3.3" xref="S3.E4.m1.3.3.cmml">𝒖</mi><mo id="S3.E4.m1.4.4.1.1.1.1.1.1.3.3.2.3" stretchy="false" xref="S3.E4.m1.4.4.1.1.1.1.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.4.4.1.1.1.1.1.1.2" xref="S3.E4.m1.4.4.1.1.1.1.1.1.2.cmml">+</mo><mrow id="S3.E4.m1.4.4.1.1.1.1.1.1.1" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.4.4.1.1.1.1.1.1.1.3" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.3.cmml">γ</mi><mo id="S3.E4.m1.4.4.1.1.1.1.1.1.1.2" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E4.m1.4.4.1.1.1.1.1.1.1.4" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.4.cmml">V</mi><mo id="S3.E4.m1.4.4.1.1.1.1.1.1.1.2a" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mo id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E4.m1.4.4.1.1.1.1.1.3" xref="S3.E4.m1.4.4.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S3.E4.m1.4.4.1.2" lspace="0em" xref="S3.E4.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.4b"><apply id="S3.E4.m1.4.4.1.1.cmml" xref="S3.E4.m1.4.4.1"><csymbol cd="latexml" id="S3.E4.m1.4.4.1.1.2.cmml" xref="S3.E4.m1.4.4.1.1.2">assign</csymbol><apply id="S3.E4.m1.4.4.1.1.3.cmml" xref="S3.E4.m1.4.4.1.1.3"><times id="S3.E4.m1.4.4.1.1.3.1.cmml" xref="S3.E4.m1.4.4.1.1.3.1"></times><ci id="S3.E4.m1.4.4.1.1.3.2.cmml" xref="S3.E4.m1.4.4.1.1.3.2">ℬ</ci><ci id="S3.E4.m1.4.4.1.1.3.3.cmml" xref="S3.E4.m1.4.4.1.1.3.3">𝑉</ci><ci id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1">𝒙</ci></apply><apply id="S3.E4.m1.4.4.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.1"><times id="S3.E4.m1.4.4.1.1.1.2.cmml" xref="S3.E4.m1.4.4.1.1.1.2"></times><apply id="S3.E4.m1.4.4.1.1.1.3.cmml" xref="S3.E4.m1.4.4.1.1.1.3"><apply id="S3.E4.m1.4.4.1.1.1.3.1.cmml" xref="S3.E4.m1.4.4.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.1.1.1.3.1.1.cmml" xref="S3.E4.m1.4.4.1.1.1.3.1">subscript</csymbol><min id="S3.E4.m1.4.4.1.1.1.3.1.2.cmml" xref="S3.E4.m1.4.4.1.1.1.3.1.2"></min><ci id="S3.E4.m1.4.4.1.1.1.3.1.3.cmml" xref="S3.E4.m1.4.4.1.1.1.3.1.3">𝒖</ci></apply><ci id="S3.E4.m1.4.4.1.1.1.3.2.cmml" xref="S3.E4.m1.4.4.1.1.1.3.2">𝔼</ci></apply><apply id="S3.E4.m1.4.4.1.1.1.1.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1"><csymbol cd="latexml" id="S3.E4.m1.4.4.1.1.1.1.2.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E4.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1"><plus id="S3.E4.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.2"></plus><apply id="S3.E4.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.3"><times id="S3.E4.m1.4.4.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.3.1"></times><ci id="S3.E4.m1.4.4.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.3.2">𝑐</ci><interval closure="open" id="S3.E4.m1.4.4.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.3.3.2"><ci id="S3.E4.m1.2.2.cmml" xref="S3.E4.m1.2.2">𝒙</ci><ci id="S3.E4.m1.3.3.cmml" xref="S3.E4.m1.3.3">𝒖</ci></interval></apply><apply id="S3.E4.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1"><times id="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.2"></times><ci id="S3.E4.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.3">𝛾</ci><ci id="S3.E4.m1.4.4.1.1.1.1.1.1.1.4.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.4">𝑉</ci><apply id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.2">𝒙</ci><ci id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.3">′</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.4c">\mathcal{B}V(\boldsymbol{x}):=\min_{\boldsymbol{u}}\mathbb{E}\left[c(%
\boldsymbol{x},\boldsymbol{u})+\gamma V(\boldsymbol{x}^{\prime})\right].</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.4d">caligraphic_B italic_V ( bold_italic_x ) := roman_min start_POSTSUBSCRIPT bold_italic_u end_POSTSUBSCRIPT blackboard_E [ italic_c ( bold_italic_x , bold_italic_u ) + italic_γ italic_V ( bold_italic_x start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="V^{*}(\boldsymbol{x})=\mathcal{B}V^{*}(\boldsymbol{x})\hskip 5.0pt\forall%
\boldsymbol{x}\in\mathcal{X}." class="ltx_Math" display="block" id="S3.E5.m1.3"><semantics id="S3.E5.m1.3a"><mrow id="S3.E5.m1.3.3.1" xref="S3.E5.m1.3.3.1.1.cmml"><mrow id="S3.E5.m1.3.3.1.1" xref="S3.E5.m1.3.3.1.1.cmml"><mrow id="S3.E5.m1.3.3.1.1.2" xref="S3.E5.m1.3.3.1.1.2.cmml"><msup id="S3.E5.m1.3.3.1.1.2.2" xref="S3.E5.m1.3.3.1.1.2.2.cmml"><mi id="S3.E5.m1.3.3.1.1.2.2.2" xref="S3.E5.m1.3.3.1.1.2.2.2.cmml">V</mi><mo id="S3.E5.m1.3.3.1.1.2.2.3" xref="S3.E5.m1.3.3.1.1.2.2.3.cmml">∗</mo></msup><mo id="S3.E5.m1.3.3.1.1.2.1" xref="S3.E5.m1.3.3.1.1.2.1.cmml">⁢</mo><mrow id="S3.E5.m1.3.3.1.1.2.3.2" xref="S3.E5.m1.3.3.1.1.2.cmml"><mo id="S3.E5.m1.3.3.1.1.2.3.2.1" stretchy="false" xref="S3.E5.m1.3.3.1.1.2.cmml">(</mo><mi id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml">𝒙</mi><mo id="S3.E5.m1.3.3.1.1.2.3.2.2" stretchy="false" xref="S3.E5.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.3.3.1.1.3" xref="S3.E5.m1.3.3.1.1.3.cmml">=</mo><mrow id="S3.E5.m1.3.3.1.1.4" xref="S3.E5.m1.3.3.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.3.3.1.1.4.2" xref="S3.E5.m1.3.3.1.1.4.2.cmml">ℬ</mi><mo id="S3.E5.m1.3.3.1.1.4.1" xref="S3.E5.m1.3.3.1.1.4.1.cmml">⁢</mo><msup id="S3.E5.m1.3.3.1.1.4.3" xref="S3.E5.m1.3.3.1.1.4.3.cmml"><mi id="S3.E5.m1.3.3.1.1.4.3.2" xref="S3.E5.m1.3.3.1.1.4.3.2.cmml">V</mi><mo id="S3.E5.m1.3.3.1.1.4.3.3" xref="S3.E5.m1.3.3.1.1.4.3.3.cmml">∗</mo></msup><mo id="S3.E5.m1.3.3.1.1.4.1a" xref="S3.E5.m1.3.3.1.1.4.1.cmml">⁢</mo><mrow id="S3.E5.m1.3.3.1.1.4.4.2" xref="S3.E5.m1.3.3.1.1.4.cmml"><mo id="S3.E5.m1.3.3.1.1.4.4.2.1" stretchy="false" xref="S3.E5.m1.3.3.1.1.4.cmml">(</mo><mi id="S3.E5.m1.2.2" xref="S3.E5.m1.2.2.cmml">𝒙</mi><mo id="S3.E5.m1.3.3.1.1.4.4.2.2" stretchy="false" xref="S3.E5.m1.3.3.1.1.4.cmml">)</mo></mrow><mo id="S3.E5.m1.3.3.1.1.4.1b" lspace="0.667em" xref="S3.E5.m1.3.3.1.1.4.1.cmml">⁢</mo><mrow id="S3.E5.m1.3.3.1.1.4.5" xref="S3.E5.m1.3.3.1.1.4.5.cmml"><mo id="S3.E5.m1.3.3.1.1.4.5.1" rspace="0.167em" xref="S3.E5.m1.3.3.1.1.4.5.1.cmml">∀</mo><mi id="S3.E5.m1.3.3.1.1.4.5.2" xref="S3.E5.m1.3.3.1.1.4.5.2.cmml">𝒙</mi></mrow></mrow><mo id="S3.E5.m1.3.3.1.1.5" xref="S3.E5.m1.3.3.1.1.5.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.3.3.1.1.6" xref="S3.E5.m1.3.3.1.1.6.cmml">𝒳</mi></mrow><mo id="S3.E5.m1.3.3.1.2" lspace="0em" xref="S3.E5.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.3b"><apply id="S3.E5.m1.3.3.1.1.cmml" xref="S3.E5.m1.3.3.1"><and id="S3.E5.m1.3.3.1.1a.cmml" xref="S3.E5.m1.3.3.1"></and><apply id="S3.E5.m1.3.3.1.1b.cmml" xref="S3.E5.m1.3.3.1"><eq id="S3.E5.m1.3.3.1.1.3.cmml" xref="S3.E5.m1.3.3.1.1.3"></eq><apply id="S3.E5.m1.3.3.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.2"><times id="S3.E5.m1.3.3.1.1.2.1.cmml" xref="S3.E5.m1.3.3.1.1.2.1"></times><apply id="S3.E5.m1.3.3.1.1.2.2.cmml" xref="S3.E5.m1.3.3.1.1.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.2.2.1.cmml" xref="S3.E5.m1.3.3.1.1.2.2">superscript</csymbol><ci id="S3.E5.m1.3.3.1.1.2.2.2.cmml" xref="S3.E5.m1.3.3.1.1.2.2.2">𝑉</ci><times id="S3.E5.m1.3.3.1.1.2.2.3.cmml" xref="S3.E5.m1.3.3.1.1.2.2.3"></times></apply><ci id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1">𝒙</ci></apply><apply id="S3.E5.m1.3.3.1.1.4.cmml" xref="S3.E5.m1.3.3.1.1.4"><times id="S3.E5.m1.3.3.1.1.4.1.cmml" xref="S3.E5.m1.3.3.1.1.4.1"></times><ci id="S3.E5.m1.3.3.1.1.4.2.cmml" xref="S3.E5.m1.3.3.1.1.4.2">ℬ</ci><apply id="S3.E5.m1.3.3.1.1.4.3.cmml" xref="S3.E5.m1.3.3.1.1.4.3"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.4.3.1.cmml" xref="S3.E5.m1.3.3.1.1.4.3">superscript</csymbol><ci id="S3.E5.m1.3.3.1.1.4.3.2.cmml" xref="S3.E5.m1.3.3.1.1.4.3.2">𝑉</ci><times id="S3.E5.m1.3.3.1.1.4.3.3.cmml" xref="S3.E5.m1.3.3.1.1.4.3.3"></times></apply><ci id="S3.E5.m1.2.2.cmml" xref="S3.E5.m1.2.2">𝒙</ci><apply id="S3.E5.m1.3.3.1.1.4.5.cmml" xref="S3.E5.m1.3.3.1.1.4.5"><csymbol cd="latexml" id="S3.E5.m1.3.3.1.1.4.5.1.cmml" xref="S3.E5.m1.3.3.1.1.4.5.1">for-all</csymbol><ci id="S3.E5.m1.3.3.1.1.4.5.2.cmml" xref="S3.E5.m1.3.3.1.1.4.5.2">𝒙</ci></apply></apply></apply><apply id="S3.E5.m1.3.3.1.1c.cmml" xref="S3.E5.m1.3.3.1"><in id="S3.E5.m1.3.3.1.1.5.cmml" xref="S3.E5.m1.3.3.1.1.5"></in><share href="https://arxiv.org/html/2410.04929v1#S3.E5.m1.3.3.1.1.4.cmml" id="S3.E5.m1.3.3.1.1d.cmml" xref="S3.E5.m1.3.3.1"></share><ci id="S3.E5.m1.3.3.1.1.6.cmml" xref="S3.E5.m1.3.3.1.1.6">𝒳</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.3c">V^{*}(\boldsymbol{x})=\mathcal{B}V^{*}(\boldsymbol{x})\hskip 5.0pt\forall%
\boldsymbol{x}\in\mathcal{X}.</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.3d">italic_V start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( bold_italic_x ) = caligraphic_B italic_V start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( bold_italic_x ) ∀ bold_italic_x ∈ caligraphic_X .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p1.12">Dynamic programming methods, such as value iteration <cite class="ltx_cite ltx_citemacro_citep">(Bellman, <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib3" title="">1966</a>)</cite>, can be used to find the optimal value function, and the optimal policy can be described as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\pi(\boldsymbol{x})=\mathop{\rm argmin}\limits_{\boldsymbol{u}}\mathbb{E}\left%
[c(\boldsymbol{x},\boldsymbol{u})+\gamma V(\boldsymbol{x}^{\prime})\right]." class="ltx_Math" display="block" id="S3.E6.m1.4"><semantics id="S3.E6.m1.4a"><mrow id="S3.E6.m1.4.4.1" xref="S3.E6.m1.4.4.1.1.cmml"><mrow id="S3.E6.m1.4.4.1.1" xref="S3.E6.m1.4.4.1.1.cmml"><mrow id="S3.E6.m1.4.4.1.1.3" xref="S3.E6.m1.4.4.1.1.3.cmml"><mi id="S3.E6.m1.4.4.1.1.3.2" xref="S3.E6.m1.4.4.1.1.3.2.cmml">π</mi><mo id="S3.E6.m1.4.4.1.1.3.1" xref="S3.E6.m1.4.4.1.1.3.1.cmml">⁢</mo><mrow id="S3.E6.m1.4.4.1.1.3.3.2" xref="S3.E6.m1.4.4.1.1.3.cmml"><mo id="S3.E6.m1.4.4.1.1.3.3.2.1" stretchy="false" xref="S3.E6.m1.4.4.1.1.3.cmml">(</mo><mi id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml">𝒙</mi><mo id="S3.E6.m1.4.4.1.1.3.3.2.2" stretchy="false" xref="S3.E6.m1.4.4.1.1.3.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.4.4.1.1.2" rspace="0.1389em" xref="S3.E6.m1.4.4.1.1.2.cmml">=</mo><mrow id="S3.E6.m1.4.4.1.1.1" xref="S3.E6.m1.4.4.1.1.1.cmml"><munder id="S3.E6.m1.4.4.1.1.1.2" xref="S3.E6.m1.4.4.1.1.1.2.cmml"><mo id="S3.E6.m1.4.4.1.1.1.2.2" lspace="0.1389em" movablelimits="false" rspace="0.167em" xref="S3.E6.m1.4.4.1.1.1.2.2.cmml">argmin</mo><mi id="S3.E6.m1.4.4.1.1.1.2.3" xref="S3.E6.m1.4.4.1.1.1.2.3.cmml">𝒖</mi></munder><mrow id="S3.E6.m1.4.4.1.1.1.1" xref="S3.E6.m1.4.4.1.1.1.1.cmml"><mi id="S3.E6.m1.4.4.1.1.1.1.3" xref="S3.E6.m1.4.4.1.1.1.1.3.cmml">𝔼</mi><mo id="S3.E6.m1.4.4.1.1.1.1.2" xref="S3.E6.m1.4.4.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E6.m1.4.4.1.1.1.1.1.1" xref="S3.E6.m1.4.4.1.1.1.1.1.2.cmml"><mo id="S3.E6.m1.4.4.1.1.1.1.1.1.2" xref="S3.E6.m1.4.4.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E6.m1.4.4.1.1.1.1.1.1.1" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.cmml"><mrow id="S3.E6.m1.4.4.1.1.1.1.1.1.1.3" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.4.4.1.1.1.1.1.1.1.3.2" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.3.2.cmml">c</mi><mo id="S3.E6.m1.4.4.1.1.1.1.1.1.1.3.1" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.E6.m1.4.4.1.1.1.1.1.1.1.3.3.2" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.3.3.1.cmml"><mo id="S3.E6.m1.4.4.1.1.1.1.1.1.1.3.3.2.1" stretchy="false" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.3.3.1.cmml">(</mo><mi id="S3.E6.m1.2.2" xref="S3.E6.m1.2.2.cmml">𝒙</mi><mo id="S3.E6.m1.4.4.1.1.1.1.1.1.1.3.3.2.2" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.3.3.1.cmml">,</mo><mi id="S3.E6.m1.3.3" xref="S3.E6.m1.3.3.cmml">𝒖</mi><mo id="S3.E6.m1.4.4.1.1.1.1.1.1.1.3.3.2.3" stretchy="false" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.4.4.1.1.1.1.1.1.1.2" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.2.cmml">+</mo><mrow id="S3.E6.m1.4.4.1.1.1.1.1.1.1.1" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.4.4.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.1.3.cmml">γ</mi><mo id="S3.E6.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E6.m1.4.4.1.1.1.1.1.1.1.1.4" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.1.4.cmml">V</mi><mo id="S3.E6.m1.4.4.1.1.1.1.1.1.1.1.2a" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E6.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E6.m1.4.4.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.E6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mo id="S3.E6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="S3.E6.m1.4.4.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E6.m1.4.4.1.1.1.1.1.1.3" xref="S3.E6.m1.4.4.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo id="S3.E6.m1.4.4.1.2" lspace="0em" xref="S3.E6.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.4b"><apply id="S3.E6.m1.4.4.1.1.cmml" xref="S3.E6.m1.4.4.1"><eq id="S3.E6.m1.4.4.1.1.2.cmml" xref="S3.E6.m1.4.4.1.1.2"></eq><apply id="S3.E6.m1.4.4.1.1.3.cmml" xref="S3.E6.m1.4.4.1.1.3"><times id="S3.E6.m1.4.4.1.1.3.1.cmml" xref="S3.E6.m1.4.4.1.1.3.1"></times><ci id="S3.E6.m1.4.4.1.1.3.2.cmml" xref="S3.E6.m1.4.4.1.1.3.2">𝜋</ci><ci id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1">𝒙</ci></apply><apply id="S3.E6.m1.4.4.1.1.1.cmml" xref="S3.E6.m1.4.4.1.1.1"><apply id="S3.E6.m1.4.4.1.1.1.2.cmml" xref="S3.E6.m1.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.4.4.1.1.1.2.1.cmml" xref="S3.E6.m1.4.4.1.1.1.2">subscript</csymbol><ci id="S3.E6.m1.4.4.1.1.1.2.2.cmml" xref="S3.E6.m1.4.4.1.1.1.2.2">argmin</ci><ci id="S3.E6.m1.4.4.1.1.1.2.3.cmml" xref="S3.E6.m1.4.4.1.1.1.2.3">𝒖</ci></apply><apply id="S3.E6.m1.4.4.1.1.1.1.cmml" xref="S3.E6.m1.4.4.1.1.1.1"><times id="S3.E6.m1.4.4.1.1.1.1.2.cmml" xref="S3.E6.m1.4.4.1.1.1.1.2"></times><ci id="S3.E6.m1.4.4.1.1.1.1.3.cmml" xref="S3.E6.m1.4.4.1.1.1.1.3">𝔼</ci><apply id="S3.E6.m1.4.4.1.1.1.1.1.2.cmml" xref="S3.E6.m1.4.4.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E6.m1.4.4.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.4.4.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E6.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1"><plus id="S3.E6.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.2"></plus><apply id="S3.E6.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.3"><times id="S3.E6.m1.4.4.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E6.m1.4.4.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.3.2">𝑐</ci><interval closure="open" id="S3.E6.m1.4.4.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.3.3.2"><ci id="S3.E6.m1.2.2.cmml" xref="S3.E6.m1.2.2">𝒙</ci><ci id="S3.E6.m1.3.3.cmml" xref="S3.E6.m1.3.3">𝒖</ci></interval></apply><apply id="S3.E6.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.1"><times id="S3.E6.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E6.m1.4.4.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.1.3">𝛾</ci><ci id="S3.E6.m1.4.4.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.1.4">𝑉</ci><apply id="S3.E6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2">𝒙</ci><ci id="S3.E6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3">′</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.4c">\pi(\boldsymbol{x})=\mathop{\rm argmin}\limits_{\boldsymbol{u}}\mathbb{E}\left%
[c(\boldsymbol{x},\boldsymbol{u})+\gamma V(\boldsymbol{x}^{\prime})\right].</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.4d">italic_π ( bold_italic_x ) = roman_argmin start_POSTSUBSCRIPT bold_italic_u end_POSTSUBSCRIPT blackboard_E [ italic_c ( bold_italic_x , bold_italic_u ) + italic_γ italic_V ( bold_italic_x start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p1.8">However, accurately computing the optimal value function in continuous MDPs is generally challenging, except in specific cases such as Linear Quadratic Regulators (LQR) <cite class="ltx_cite ltx_citemacro_citep">(Åström and Murray, <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib2" title="">2021</a>)</cite>. Consequently, various methods for approximating the value function have been proposed, with fitted value iteration being one of the standard approaches <cite class="ltx_cite ltx_citemacro_citep">(Bertsekas and Tsitsiklis, <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib5" title="">1996</a>; Munos and Szepesvári, <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib26" title="">2008</a>)</cite>. In this approach, function approximators such as neural networks are used to approximate the optimal value function. The approximated value function is parameterized by <math alttext="\boldsymbol{\theta}" class="ltx_Math" display="inline" id="S3.SS2.p1.6.m1.1"><semantics id="S3.SS2.p1.6.m1.1a"><mi id="S3.SS2.p1.6.m1.1.1" xref="S3.SS2.p1.6.m1.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m1.1b"><ci id="S3.SS2.p1.6.m1.1.1.cmml" xref="S3.SS2.p1.6.m1.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m1.1c">\boldsymbol{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.6.m1.1d">bold_italic_θ</annotation></semantics></math> as <math alttext="\hat{V}_{\boldsymbol{\theta}}(\boldsymbol{x})" class="ltx_Math" display="inline" id="S3.SS2.p1.7.m2.1"><semantics id="S3.SS2.p1.7.m2.1a"><mrow id="S3.SS2.p1.7.m2.1.2" xref="S3.SS2.p1.7.m2.1.2.cmml"><msub id="S3.SS2.p1.7.m2.1.2.2" xref="S3.SS2.p1.7.m2.1.2.2.cmml"><mover accent="true" id="S3.SS2.p1.7.m2.1.2.2.2" xref="S3.SS2.p1.7.m2.1.2.2.2.cmml"><mi id="S3.SS2.p1.7.m2.1.2.2.2.2" xref="S3.SS2.p1.7.m2.1.2.2.2.2.cmml">V</mi><mo id="S3.SS2.p1.7.m2.1.2.2.2.1" xref="S3.SS2.p1.7.m2.1.2.2.2.1.cmml">^</mo></mover><mi id="S3.SS2.p1.7.m2.1.2.2.3" xref="S3.SS2.p1.7.m2.1.2.2.3.cmml">𝜽</mi></msub><mo id="S3.SS2.p1.7.m2.1.2.1" xref="S3.SS2.p1.7.m2.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.p1.7.m2.1.2.3.2" xref="S3.SS2.p1.7.m2.1.2.cmml"><mo id="S3.SS2.p1.7.m2.1.2.3.2.1" stretchy="false" xref="S3.SS2.p1.7.m2.1.2.cmml">(</mo><mi id="S3.SS2.p1.7.m2.1.1" xref="S3.SS2.p1.7.m2.1.1.cmml">𝒙</mi><mo id="S3.SS2.p1.7.m2.1.2.3.2.2" stretchy="false" xref="S3.SS2.p1.7.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m2.1b"><apply id="S3.SS2.p1.7.m2.1.2.cmml" xref="S3.SS2.p1.7.m2.1.2"><times id="S3.SS2.p1.7.m2.1.2.1.cmml" xref="S3.SS2.p1.7.m2.1.2.1"></times><apply id="S3.SS2.p1.7.m2.1.2.2.cmml" xref="S3.SS2.p1.7.m2.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m2.1.2.2.1.cmml" xref="S3.SS2.p1.7.m2.1.2.2">subscript</csymbol><apply id="S3.SS2.p1.7.m2.1.2.2.2.cmml" xref="S3.SS2.p1.7.m2.1.2.2.2"><ci id="S3.SS2.p1.7.m2.1.2.2.2.1.cmml" xref="S3.SS2.p1.7.m2.1.2.2.2.1">^</ci><ci id="S3.SS2.p1.7.m2.1.2.2.2.2.cmml" xref="S3.SS2.p1.7.m2.1.2.2.2.2">𝑉</ci></apply><ci id="S3.SS2.p1.7.m2.1.2.2.3.cmml" xref="S3.SS2.p1.7.m2.1.2.2.3">𝜽</ci></apply><ci id="S3.SS2.p1.7.m2.1.1.cmml" xref="S3.SS2.p1.7.m2.1.1">𝒙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m2.1c">\hat{V}_{\boldsymbol{\theta}}(\boldsymbol{x})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.7.m2.1d">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( bold_italic_x )</annotation></semantics></math>, and <math alttext="\boldsymbol{\theta}" class="ltx_Math" display="inline" id="S3.SS2.p1.8.m3.1"><semantics id="S3.SS2.p1.8.m3.1a"><mi id="S3.SS2.p1.8.m3.1.1" xref="S3.SS2.p1.8.m3.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m3.1b"><ci id="S3.SS2.p1.8.m3.1.1.cmml" xref="S3.SS2.p1.8.m3.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m3.1c">\boldsymbol{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.8.m3.1d">bold_italic_θ</annotation></semantics></math> is updated as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\boldsymbol{\theta}\leftarrow\mathop{\rm argmin}\limits_{\boldsymbol{\theta}}%
\mathbb{E}_{\boldsymbol{x}\sim\nu}\left[\left(\hat{V}_{\boldsymbol{\theta}}(%
\boldsymbol{x})-y(\boldsymbol{x})\right)^{2}\right]." class="ltx_Math" display="block" id="S3.E7.m1.3"><semantics id="S3.E7.m1.3a"><mrow id="S3.E7.m1.3.3.1" xref="S3.E7.m1.3.3.1.1.cmml"><mrow id="S3.E7.m1.3.3.1.1" xref="S3.E7.m1.3.3.1.1.cmml"><mi id="S3.E7.m1.3.3.1.1.3" xref="S3.E7.m1.3.3.1.1.3.cmml">𝜽</mi><mo id="S3.E7.m1.3.3.1.1.2" rspace="0.1389em" stretchy="false" xref="S3.E7.m1.3.3.1.1.2.cmml">←</mo><mrow id="S3.E7.m1.3.3.1.1.1" xref="S3.E7.m1.3.3.1.1.1.cmml"><munder id="S3.E7.m1.3.3.1.1.1.2" xref="S3.E7.m1.3.3.1.1.1.2.cmml"><mo id="S3.E7.m1.3.3.1.1.1.2.2" lspace="0.1389em" movablelimits="false" rspace="0.167em" xref="S3.E7.m1.3.3.1.1.1.2.2.cmml">argmin</mo><mi id="S3.E7.m1.3.3.1.1.1.2.3" xref="S3.E7.m1.3.3.1.1.1.2.3.cmml">𝜽</mi></munder><mrow id="S3.E7.m1.3.3.1.1.1.1" xref="S3.E7.m1.3.3.1.1.1.1.cmml"><msub id="S3.E7.m1.3.3.1.1.1.1.3" xref="S3.E7.m1.3.3.1.1.1.1.3.cmml"><mi id="S3.E7.m1.3.3.1.1.1.1.3.2" xref="S3.E7.m1.3.3.1.1.1.1.3.2.cmml">𝔼</mi><mrow id="S3.E7.m1.3.3.1.1.1.1.3.3" xref="S3.E7.m1.3.3.1.1.1.1.3.3.cmml"><mi id="S3.E7.m1.3.3.1.1.1.1.3.3.2" xref="S3.E7.m1.3.3.1.1.1.1.3.3.2.cmml">𝒙</mi><mo id="S3.E7.m1.3.3.1.1.1.1.3.3.1" xref="S3.E7.m1.3.3.1.1.1.1.3.3.1.cmml">∼</mo><mi id="S3.E7.m1.3.3.1.1.1.1.3.3.3" xref="S3.E7.m1.3.3.1.1.1.1.3.3.3.cmml">ν</mi></mrow></msub><mo id="S3.E7.m1.3.3.1.1.1.1.2" xref="S3.E7.m1.3.3.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E7.m1.3.3.1.1.1.1.1.1" xref="S3.E7.m1.3.3.1.1.1.1.1.2.cmml"><mo id="S3.E7.m1.3.3.1.1.1.1.1.1.2" xref="S3.E7.m1.3.3.1.1.1.1.1.2.1.cmml">[</mo><msup id="S3.E7.m1.3.3.1.1.1.1.1.1.1" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.cmml"><mrow id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml"><msub id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mover accent="true" id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">V</mi><mo id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.2.1" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml">^</mo></mover><mi id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">𝜽</mi></msub><mo id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2.1" stretchy="false" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E7.m1.1.1" xref="S3.E7.m1.1.1.cmml">𝒙</mi><mo id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2.2" stretchy="false" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.cmml">y</mi><mo id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml"><mo id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.2.1" stretchy="false" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml">(</mo><mi id="S3.E7.m1.2.2" xref="S3.E7.m1.2.2.cmml">𝒙</mi><mo id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.2.2" stretchy="false" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S3.E7.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S3.E7.m1.3.3.1.1.1.1.1.1.3" xref="S3.E7.m1.3.3.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo id="S3.E7.m1.3.3.1.2" lspace="0em" xref="S3.E7.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.3b"><apply id="S3.E7.m1.3.3.1.1.cmml" xref="S3.E7.m1.3.3.1"><ci id="S3.E7.m1.3.3.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.2">←</ci><ci id="S3.E7.m1.3.3.1.1.3.cmml" xref="S3.E7.m1.3.3.1.1.3">𝜽</ci><apply id="S3.E7.m1.3.3.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.1"><apply id="S3.E7.m1.3.3.1.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.1.2.1.cmml" xref="S3.E7.m1.3.3.1.1.1.2">subscript</csymbol><ci id="S3.E7.m1.3.3.1.1.1.2.2.cmml" xref="S3.E7.m1.3.3.1.1.1.2.2">argmin</ci><ci id="S3.E7.m1.3.3.1.1.1.2.3.cmml" xref="S3.E7.m1.3.3.1.1.1.2.3">𝜽</ci></apply><apply id="S3.E7.m1.3.3.1.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1"><times id="S3.E7.m1.3.3.1.1.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.2"></times><apply id="S3.E7.m1.3.3.1.1.1.1.3.cmml" xref="S3.E7.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.1.1.3.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.3">subscript</csymbol><ci id="S3.E7.m1.3.3.1.1.1.1.3.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.3.2">𝔼</ci><apply id="S3.E7.m1.3.3.1.1.1.1.3.3.cmml" xref="S3.E7.m1.3.3.1.1.1.1.3.3"><csymbol cd="latexml" id="S3.E7.m1.3.3.1.1.1.1.3.3.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.3.3.1">similar-to</csymbol><ci id="S3.E7.m1.3.3.1.1.1.1.3.3.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.3.3.2">𝒙</ci><ci id="S3.E7.m1.3.3.1.1.1.1.3.3.3.cmml" xref="S3.E7.m1.3.3.1.1.1.1.3.3.3">𝜈</ci></apply></apply><apply id="S3.E7.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E7.m1.3.3.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E7.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1"><minus id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.2"><times id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1"></times><apply id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><apply id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.2"><ci id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.2.1">^</ci><ci id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.2.2">𝑉</ci></apply><ci id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.3">𝜽</ci></apply><ci id="S3.E7.m1.1.1.cmml" xref="S3.E7.m1.1.1">𝒙</ci></apply><apply id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.3"><times id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2">𝑦</ci><ci id="S3.E7.m1.2.2.cmml" xref="S3.E7.m1.2.2">𝒙</ci></apply></apply><cn id="S3.E7.m1.3.3.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.3c">\boldsymbol{\theta}\leftarrow\mathop{\rm argmin}\limits_{\boldsymbol{\theta}}%
\mathbb{E}_{\boldsymbol{x}\sim\nu}\left[\left(\hat{V}_{\boldsymbol{\theta}}(%
\boldsymbol{x})-y(\boldsymbol{x})\right)^{2}\right].</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.3d">bold_italic_θ ← roman_argmin start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT blackboard_E start_POSTSUBSCRIPT bold_italic_x ∼ italic_ν end_POSTSUBSCRIPT [ ( over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( bold_italic_x ) - italic_y ( bold_italic_x ) ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p1.11">Here, <math alttext="\nu" class="ltx_Math" display="inline" id="S3.SS2.p1.9.m1.1"><semantics id="S3.SS2.p1.9.m1.1a"><mi id="S3.SS2.p1.9.m1.1.1" xref="S3.SS2.p1.9.m1.1.1.cmml">ν</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m1.1b"><ci id="S3.SS2.p1.9.m1.1.1.cmml" xref="S3.SS2.p1.9.m1.1.1">𝜈</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m1.1c">\nu</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.9.m1.1d">italic_ν</annotation></semantics></math> represents the sampling distribution of the state set, and the target <math alttext="y" class="ltx_Math" display="inline" id="S3.SS2.p1.10.m2.1"><semantics id="S3.SS2.p1.10.m2.1a"><mi id="S3.SS2.p1.10.m2.1.1" xref="S3.SS2.p1.10.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.m2.1b"><ci id="S3.SS2.p1.10.m2.1.1.cmml" xref="S3.SS2.p1.10.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.10.m2.1c">y</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.10.m2.1d">italic_y</annotation></semantics></math> is computed as <math alttext="y(\boldsymbol{x})=\min_{\boldsymbol{u}}\mathbb{E}\left[c(\boldsymbol{x},%
\boldsymbol{u})+\gamma\hat{V}_{\boldsymbol{\theta}}(\boldsymbol{x}^{\prime})\right]" class="ltx_Math" display="inline" id="S3.SS2.p1.11.m3.4"><semantics id="S3.SS2.p1.11.m3.4a"><mrow id="S3.SS2.p1.11.m3.4.4" xref="S3.SS2.p1.11.m3.4.4.cmml"><mrow id="S3.SS2.p1.11.m3.4.4.3" xref="S3.SS2.p1.11.m3.4.4.3.cmml"><mi id="S3.SS2.p1.11.m3.4.4.3.2" xref="S3.SS2.p1.11.m3.4.4.3.2.cmml">y</mi><mo id="S3.SS2.p1.11.m3.4.4.3.1" xref="S3.SS2.p1.11.m3.4.4.3.1.cmml">⁢</mo><mrow id="S3.SS2.p1.11.m3.4.4.3.3.2" xref="S3.SS2.p1.11.m3.4.4.3.cmml"><mo id="S3.SS2.p1.11.m3.4.4.3.3.2.1" stretchy="false" xref="S3.SS2.p1.11.m3.4.4.3.cmml">(</mo><mi id="S3.SS2.p1.11.m3.1.1" xref="S3.SS2.p1.11.m3.1.1.cmml">𝒙</mi><mo id="S3.SS2.p1.11.m3.4.4.3.3.2.2" stretchy="false" xref="S3.SS2.p1.11.m3.4.4.3.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p1.11.m3.4.4.2" xref="S3.SS2.p1.11.m3.4.4.2.cmml">=</mo><mrow id="S3.SS2.p1.11.m3.4.4.1" xref="S3.SS2.p1.11.m3.4.4.1.cmml"><mrow id="S3.SS2.p1.11.m3.4.4.1.3" xref="S3.SS2.p1.11.m3.4.4.1.3.cmml"><msub id="S3.SS2.p1.11.m3.4.4.1.3.1" xref="S3.SS2.p1.11.m3.4.4.1.3.1.cmml"><mi id="S3.SS2.p1.11.m3.4.4.1.3.1.2" xref="S3.SS2.p1.11.m3.4.4.1.3.1.2.cmml">min</mi><mi id="S3.SS2.p1.11.m3.4.4.1.3.1.3" xref="S3.SS2.p1.11.m3.4.4.1.3.1.3.cmml">𝒖</mi></msub><mo id="S3.SS2.p1.11.m3.4.4.1.3a" lspace="0.167em" xref="S3.SS2.p1.11.m3.4.4.1.3.cmml">⁡</mo><mi id="S3.SS2.p1.11.m3.4.4.1.3.2" xref="S3.SS2.p1.11.m3.4.4.1.3.2.cmml">𝔼</mi></mrow><mo id="S3.SS2.p1.11.m3.4.4.1.2" xref="S3.SS2.p1.11.m3.4.4.1.2.cmml">⁢</mo><mrow id="S3.SS2.p1.11.m3.4.4.1.1.1" xref="S3.SS2.p1.11.m3.4.4.1.1.2.cmml"><mo id="S3.SS2.p1.11.m3.4.4.1.1.1.2" xref="S3.SS2.p1.11.m3.4.4.1.1.2.1.cmml">[</mo><mrow id="S3.SS2.p1.11.m3.4.4.1.1.1.1" xref="S3.SS2.p1.11.m3.4.4.1.1.1.1.cmml"><mrow id="S3.SS2.p1.11.m3.4.4.1.1.1.1.3" xref="S3.SS2.p1.11.m3.4.4.1.1.1.1.3.cmml"><mi id="S3.SS2.p1.11.m3.4.4.1.1.1.1.3.2" xref="S3.SS2.p1.11.m3.4.4.1.1.1.1.3.2.cmml">c</mi><mo id="S3.SS2.p1.11.m3.4.4.1.1.1.1.3.1" xref="S3.SS2.p1.11.m3.4.4.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.SS2.p1.11.m3.4.4.1.1.1.1.3.3.2" xref="S3.SS2.p1.11.m3.4.4.1.1.1.1.3.3.1.cmml"><mo id="S3.SS2.p1.11.m3.4.4.1.1.1.1.3.3.2.1" stretchy="false" xref="S3.SS2.p1.11.m3.4.4.1.1.1.1.3.3.1.cmml">(</mo><mi id="S3.SS2.p1.11.m3.2.2" xref="S3.SS2.p1.11.m3.2.2.cmml">𝒙</mi><mo id="S3.SS2.p1.11.m3.4.4.1.1.1.1.3.3.2.2" xref="S3.SS2.p1.11.m3.4.4.1.1.1.1.3.3.1.cmml">,</mo><mi id="S3.SS2.p1.11.m3.3.3" xref="S3.SS2.p1.11.m3.3.3.cmml">𝒖</mi><mo id="S3.SS2.p1.11.m3.4.4.1.1.1.1.3.3.2.3" stretchy="false" xref="S3.SS2.p1.11.m3.4.4.1.1.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p1.11.m3.4.4.1.1.1.1.2" xref="S3.SS2.p1.11.m3.4.4.1.1.1.1.2.cmml">+</mo><mrow id="S3.SS2.p1.11.m3.4.4.1.1.1.1.1" xref="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.3" xref="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.3.cmml">γ</mi><mo id="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.2" xref="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.2.cmml">⁢</mo><msub id="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.4" xref="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.4.cmml"><mover accent="true" id="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.4.2" xref="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.4.2.cmml"><mi id="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.4.2.2" xref="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.4.2.2.cmml">V</mi><mo id="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.4.2.1" xref="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.4.2.1.cmml">^</mo></mover><mi id="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.4.3" xref="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.4.3.cmml">𝜽</mi></msub><mo id="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.2a" xref="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.1.1" xref="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.1.1.1.cmml"><mo id="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.1.1.1" xref="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.1.1.1.2" xref="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mo id="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.1.1.1.3" xref="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.SS2.p1.11.m3.4.4.1.1.1.3" xref="S3.SS2.p1.11.m3.4.4.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.11.m3.4b"><apply id="S3.SS2.p1.11.m3.4.4.cmml" xref="S3.SS2.p1.11.m3.4.4"><eq id="S3.SS2.p1.11.m3.4.4.2.cmml" xref="S3.SS2.p1.11.m3.4.4.2"></eq><apply id="S3.SS2.p1.11.m3.4.4.3.cmml" xref="S3.SS2.p1.11.m3.4.4.3"><times id="S3.SS2.p1.11.m3.4.4.3.1.cmml" xref="S3.SS2.p1.11.m3.4.4.3.1"></times><ci id="S3.SS2.p1.11.m3.4.4.3.2.cmml" xref="S3.SS2.p1.11.m3.4.4.3.2">𝑦</ci><ci id="S3.SS2.p1.11.m3.1.1.cmml" xref="S3.SS2.p1.11.m3.1.1">𝒙</ci></apply><apply id="S3.SS2.p1.11.m3.4.4.1.cmml" xref="S3.SS2.p1.11.m3.4.4.1"><times id="S3.SS2.p1.11.m3.4.4.1.2.cmml" xref="S3.SS2.p1.11.m3.4.4.1.2"></times><apply id="S3.SS2.p1.11.m3.4.4.1.3.cmml" xref="S3.SS2.p1.11.m3.4.4.1.3"><apply id="S3.SS2.p1.11.m3.4.4.1.3.1.cmml" xref="S3.SS2.p1.11.m3.4.4.1.3.1"><csymbol cd="ambiguous" id="S3.SS2.p1.11.m3.4.4.1.3.1.1.cmml" xref="S3.SS2.p1.11.m3.4.4.1.3.1">subscript</csymbol><min id="S3.SS2.p1.11.m3.4.4.1.3.1.2.cmml" xref="S3.SS2.p1.11.m3.4.4.1.3.1.2"></min><ci id="S3.SS2.p1.11.m3.4.4.1.3.1.3.cmml" xref="S3.SS2.p1.11.m3.4.4.1.3.1.3">𝒖</ci></apply><ci id="S3.SS2.p1.11.m3.4.4.1.3.2.cmml" xref="S3.SS2.p1.11.m3.4.4.1.3.2">𝔼</ci></apply><apply id="S3.SS2.p1.11.m3.4.4.1.1.2.cmml" xref="S3.SS2.p1.11.m3.4.4.1.1.1"><csymbol cd="latexml" id="S3.SS2.p1.11.m3.4.4.1.1.2.1.cmml" xref="S3.SS2.p1.11.m3.4.4.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS2.p1.11.m3.4.4.1.1.1.1.cmml" xref="S3.SS2.p1.11.m3.4.4.1.1.1.1"><plus id="S3.SS2.p1.11.m3.4.4.1.1.1.1.2.cmml" xref="S3.SS2.p1.11.m3.4.4.1.1.1.1.2"></plus><apply id="S3.SS2.p1.11.m3.4.4.1.1.1.1.3.cmml" xref="S3.SS2.p1.11.m3.4.4.1.1.1.1.3"><times id="S3.SS2.p1.11.m3.4.4.1.1.1.1.3.1.cmml" xref="S3.SS2.p1.11.m3.4.4.1.1.1.1.3.1"></times><ci id="S3.SS2.p1.11.m3.4.4.1.1.1.1.3.2.cmml" xref="S3.SS2.p1.11.m3.4.4.1.1.1.1.3.2">𝑐</ci><interval closure="open" id="S3.SS2.p1.11.m3.4.4.1.1.1.1.3.3.1.cmml" xref="S3.SS2.p1.11.m3.4.4.1.1.1.1.3.3.2"><ci id="S3.SS2.p1.11.m3.2.2.cmml" xref="S3.SS2.p1.11.m3.2.2">𝒙</ci><ci id="S3.SS2.p1.11.m3.3.3.cmml" xref="S3.SS2.p1.11.m3.3.3">𝒖</ci></interval></apply><apply id="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.cmml" xref="S3.SS2.p1.11.m3.4.4.1.1.1.1.1"><times id="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.2"></times><ci id="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.3">𝛾</ci><apply id="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.4.cmml" xref="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.4.1.cmml" xref="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.4">subscript</csymbol><apply id="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.4.2.cmml" xref="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.4.2"><ci id="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.4.2.1.cmml" xref="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.4.2.1">^</ci><ci id="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.4.2.2.cmml" xref="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.4.2.2">𝑉</ci></apply><ci id="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.4.3.cmml" xref="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.4.3">𝜽</ci></apply><apply id="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.1.1.1.2">𝒙</ci><ci id="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.11.m3.4.4.1.1.1.1.1.1.1.1.3">′</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.11.m3.4c">y(\boldsymbol{x})=\min_{\boldsymbol{u}}\mathbb{E}\left[c(\boldsymbol{x},%
\boldsymbol{u})+\gamma\hat{V}_{\boldsymbol{\theta}}(\boldsymbol{x}^{\prime})\right]</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.11.m3.4d">italic_y ( bold_italic_x ) = roman_min start_POSTSUBSCRIPT bold_italic_u end_POSTSUBSCRIPT blackboard_E [ italic_c ( bold_italic_x , bold_italic_u ) + italic_γ over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) ]</annotation></semantics></math>. The policy is then obtained as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\pi(\boldsymbol{x})=\mathop{\rm argmin}\limits_{\boldsymbol{u}}\mathbb{E}\left%
[c(\boldsymbol{x},\boldsymbol{u})+\gamma\hat{V}_{\boldsymbol{\theta}}(%
\boldsymbol{x}^{\prime})\right]." class="ltx_Math" display="block" id="S3.E8.m1.4"><semantics id="S3.E8.m1.4a"><mrow id="S3.E8.m1.4.4.1" xref="S3.E8.m1.4.4.1.1.cmml"><mrow id="S3.E8.m1.4.4.1.1" xref="S3.E8.m1.4.4.1.1.cmml"><mrow id="S3.E8.m1.4.4.1.1.3" xref="S3.E8.m1.4.4.1.1.3.cmml"><mi id="S3.E8.m1.4.4.1.1.3.2" xref="S3.E8.m1.4.4.1.1.3.2.cmml">π</mi><mo id="S3.E8.m1.4.4.1.1.3.1" xref="S3.E8.m1.4.4.1.1.3.1.cmml">⁢</mo><mrow id="S3.E8.m1.4.4.1.1.3.3.2" xref="S3.E8.m1.4.4.1.1.3.cmml"><mo id="S3.E8.m1.4.4.1.1.3.3.2.1" stretchy="false" xref="S3.E8.m1.4.4.1.1.3.cmml">(</mo><mi id="S3.E8.m1.1.1" xref="S3.E8.m1.1.1.cmml">𝒙</mi><mo id="S3.E8.m1.4.4.1.1.3.3.2.2" stretchy="false" xref="S3.E8.m1.4.4.1.1.3.cmml">)</mo></mrow></mrow><mo id="S3.E8.m1.4.4.1.1.2" rspace="0.1389em" xref="S3.E8.m1.4.4.1.1.2.cmml">=</mo><mrow id="S3.E8.m1.4.4.1.1.1" xref="S3.E8.m1.4.4.1.1.1.cmml"><munder id="S3.E8.m1.4.4.1.1.1.2" xref="S3.E8.m1.4.4.1.1.1.2.cmml"><mo id="S3.E8.m1.4.4.1.1.1.2.2" lspace="0.1389em" movablelimits="false" rspace="0.167em" xref="S3.E8.m1.4.4.1.1.1.2.2.cmml">argmin</mo><mi id="S3.E8.m1.4.4.1.1.1.2.3" xref="S3.E8.m1.4.4.1.1.1.2.3.cmml">𝒖</mi></munder><mrow id="S3.E8.m1.4.4.1.1.1.1" xref="S3.E8.m1.4.4.1.1.1.1.cmml"><mi id="S3.E8.m1.4.4.1.1.1.1.3" xref="S3.E8.m1.4.4.1.1.1.1.3.cmml">𝔼</mi><mo id="S3.E8.m1.4.4.1.1.1.1.2" xref="S3.E8.m1.4.4.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E8.m1.4.4.1.1.1.1.1.1" xref="S3.E8.m1.4.4.1.1.1.1.1.2.cmml"><mo id="S3.E8.m1.4.4.1.1.1.1.1.1.2" xref="S3.E8.m1.4.4.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E8.m1.4.4.1.1.1.1.1.1.1" xref="S3.E8.m1.4.4.1.1.1.1.1.1.1.cmml"><mrow id="S3.E8.m1.4.4.1.1.1.1.1.1.1.3" xref="S3.E8.m1.4.4.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E8.m1.4.4.1.1.1.1.1.1.1.3.2" xref="S3.E8.m1.4.4.1.1.1.1.1.1.1.3.2.cmml">c</mi><mo id="S3.E8.m1.4.4.1.1.1.1.1.1.1.3.1" xref="S3.E8.m1.4.4.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.E8.m1.4.4.1.1.1.1.1.1.1.3.3.2" xref="S3.E8.m1.4.4.1.1.1.1.1.1.1.3.3.1.cmml"><mo id="S3.E8.m1.4.4.1.1.1.1.1.1.1.3.3.2.1" stretchy="false" xref="S3.E8.m1.4.4.1.1.1.1.1.1.1.3.3.1.cmml">(</mo><mi id="S3.E8.m1.2.2" xref="S3.E8.m1.2.2.cmml">𝒙</mi><mo id="S3.E8.m1.4.4.1.1.1.1.1.1.1.3.3.2.2" xref="S3.E8.m1.4.4.1.1.1.1.1.1.1.3.3.1.cmml">,</mo><mi id="S3.E8.m1.3.3" xref="S3.E8.m1.3.3.cmml">𝒖</mi><mo id="S3.E8.m1.4.4.1.1.1.1.1.1.1.3.3.2.3" stretchy="false" xref="S3.E8.m1.4.4.1.1.1.1.1.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E8.m1.4.4.1.1.1.1.1.1.1.2" xref="S3.E8.m1.4.4.1.1.1.1.1.1.1.2.cmml">+</mo><mrow id="S3.E8.m1.4.4.1.1.1.1.1.1.1.1" xref="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.3.cmml">γ</mi><mo id="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><msub id="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.4" xref="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.4.cmml"><mover accent="true" id="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.4.2" xref="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.4.2.cmml"><mi id="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.4.2.2" xref="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.4.2.2.cmml">V</mi><mo id="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.4.2.1" xref="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.4.2.1.cmml">^</mo></mover><mi id="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.4.3" xref="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.4.3.cmml">𝜽</mi></msub><mo id="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.2a" xref="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mo id="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E8.m1.4.4.1.1.1.1.1.1.3" xref="S3.E8.m1.4.4.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo id="S3.E8.m1.4.4.1.2" lspace="0em" xref="S3.E8.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.4b"><apply id="S3.E8.m1.4.4.1.1.cmml" xref="S3.E8.m1.4.4.1"><eq id="S3.E8.m1.4.4.1.1.2.cmml" xref="S3.E8.m1.4.4.1.1.2"></eq><apply id="S3.E8.m1.4.4.1.1.3.cmml" xref="S3.E8.m1.4.4.1.1.3"><times id="S3.E8.m1.4.4.1.1.3.1.cmml" xref="S3.E8.m1.4.4.1.1.3.1"></times><ci id="S3.E8.m1.4.4.1.1.3.2.cmml" xref="S3.E8.m1.4.4.1.1.3.2">𝜋</ci><ci id="S3.E8.m1.1.1.cmml" xref="S3.E8.m1.1.1">𝒙</ci></apply><apply id="S3.E8.m1.4.4.1.1.1.cmml" xref="S3.E8.m1.4.4.1.1.1"><apply id="S3.E8.m1.4.4.1.1.1.2.cmml" xref="S3.E8.m1.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.4.4.1.1.1.2.1.cmml" xref="S3.E8.m1.4.4.1.1.1.2">subscript</csymbol><ci id="S3.E8.m1.4.4.1.1.1.2.2.cmml" xref="S3.E8.m1.4.4.1.1.1.2.2">argmin</ci><ci id="S3.E8.m1.4.4.1.1.1.2.3.cmml" xref="S3.E8.m1.4.4.1.1.1.2.3">𝒖</ci></apply><apply id="S3.E8.m1.4.4.1.1.1.1.cmml" xref="S3.E8.m1.4.4.1.1.1.1"><times id="S3.E8.m1.4.4.1.1.1.1.2.cmml" xref="S3.E8.m1.4.4.1.1.1.1.2"></times><ci id="S3.E8.m1.4.4.1.1.1.1.3.cmml" xref="S3.E8.m1.4.4.1.1.1.1.3">𝔼</ci><apply id="S3.E8.m1.4.4.1.1.1.1.1.2.cmml" xref="S3.E8.m1.4.4.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E8.m1.4.4.1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.4.4.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E8.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.4.4.1.1.1.1.1.1.1"><plus id="S3.E8.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.4.4.1.1.1.1.1.1.1.2"></plus><apply id="S3.E8.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.4.4.1.1.1.1.1.1.1.3"><times id="S3.E8.m1.4.4.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.4.4.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E8.m1.4.4.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.4.4.1.1.1.1.1.1.1.3.2">𝑐</ci><interval closure="open" id="S3.E8.m1.4.4.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E8.m1.4.4.1.1.1.1.1.1.1.3.3.2"><ci id="S3.E8.m1.2.2.cmml" xref="S3.E8.m1.2.2">𝒙</ci><ci id="S3.E8.m1.3.3.cmml" xref="S3.E8.m1.3.3">𝒖</ci></interval></apply><apply id="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.4.4.1.1.1.1.1.1.1.1"><times id="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.3">𝛾</ci><apply id="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.4">subscript</csymbol><apply id="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.4.2.cmml" xref="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.4.2"><ci id="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.4.2.1.cmml" xref="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.4.2.1">^</ci><ci id="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.4.2.2.cmml" xref="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.4.2.2">𝑉</ci></apply><ci id="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.4.3.cmml" xref="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.4.3">𝜽</ci></apply><apply id="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2">𝒙</ci><ci id="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3">′</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.4c">\pi(\boldsymbol{x})=\mathop{\rm argmin}\limits_{\boldsymbol{u}}\mathbb{E}\left%
[c(\boldsymbol{x},\boldsymbol{u})+\gamma\hat{V}_{\boldsymbol{\theta}}(%
\boldsymbol{x}^{\prime})\right].</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.4d">italic_π ( bold_italic_x ) = roman_argmin start_POSTSUBSCRIPT bold_italic_u end_POSTSUBSCRIPT blackboard_E [ italic_c ( bold_italic_x , bold_italic_u ) + italic_γ over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Model Predictive Control (MPC)</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.3">In Model Predictive Control (MPC), at each time step, a locally optimal control sequence for a finite future horizon <math alttext="H" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.1"><semantics id="S3.SS3.p1.1.m1.1a"><mi id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">H</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.1d">italic_H</annotation></semantics></math> is computed based on predictions from the nonlinear dynamics model <math alttext="\boldsymbol{f}" class="ltx_Math" display="inline" id="S3.SS3.p1.2.m2.1"><semantics id="S3.SS3.p1.2.m2.1a"><mi id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml">𝒇</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><ci id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">𝒇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">\boldsymbol{f}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.2.m2.1d">bold_italic_f</annotation></semantics></math>. The problem solved at time step <math alttext="k" class="ltx_Math" display="inline" id="S3.SS3.p1.3.m3.1"><semantics id="S3.SS3.p1.3.m3.1a"><mi id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><ci id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.3.m3.1d">italic_k</annotation></semantics></math> is formulated as follows, known as the optimal control problem:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E9">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E9X">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\boldsymbol{U}_{k}^{*}=\mathop{\rm argmin}\limits_{\boldsymbol{U}%
_{k}}\sum_{t=k}^{k+H-1}c(\boldsymbol{x}_{t},\boldsymbol{u}_{t})+\phi(%
\boldsymbol{x}_{k+H})," class="ltx_Math" display="inline" id="S3.E9X.2.1.1.m1.1"><semantics id="S3.E9X.2.1.1.m1.1a"><mrow id="S3.E9X.2.1.1.m1.1.1.1" xref="S3.E9X.2.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E9X.2.1.1.m1.1.1.1.1" xref="S3.E9X.2.1.1.m1.1.1.1.1.cmml"><msubsup id="S3.E9X.2.1.1.m1.1.1.1.1.5" xref="S3.E9X.2.1.1.m1.1.1.1.1.5.cmml"><mi id="S3.E9X.2.1.1.m1.1.1.1.1.5.2.2" xref="S3.E9X.2.1.1.m1.1.1.1.1.5.2.2.cmml">𝑼</mi><mi id="S3.E9X.2.1.1.m1.1.1.1.1.5.2.3" xref="S3.E9X.2.1.1.m1.1.1.1.1.5.2.3.cmml">k</mi><mo id="S3.E9X.2.1.1.m1.1.1.1.1.5.3" xref="S3.E9X.2.1.1.m1.1.1.1.1.5.3.cmml">∗</mo></msubsup><mo id="S3.E9X.2.1.1.m1.1.1.1.1.4" rspace="0.1389em" xref="S3.E9X.2.1.1.m1.1.1.1.1.4.cmml">=</mo><mrow id="S3.E9X.2.1.1.m1.1.1.1.1.3" xref="S3.E9X.2.1.1.m1.1.1.1.1.3.cmml"><mrow id="S3.E9X.2.1.1.m1.1.1.1.1.2.2" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.cmml"><munder id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.3" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.3.cmml"><mo id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.3.2" lspace="0.1389em" movablelimits="false" rspace="0.167em" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.3.2.cmml">argmin</mo><msub id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.3.3" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.3.3.cmml"><mi id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.3.3.2" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.3.3.2.cmml">𝑼</mi><mi id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.3.3.3" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.3.3.3.cmml">k</mi></msub></munder><mrow id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.cmml"><mstyle displaystyle="true" id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.cmml"><munderover id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3a" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.cmml"><mo id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.2.2" movablelimits="false" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.2.2.cmml">∑</mo><mrow id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.2.3" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.2.3.cmml"><mi id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.2.3.2" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.2.3.2.cmml">t</mi><mo id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.2.3.1" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.2.3.1.cmml">=</mo><mi id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.2.3.3" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.2.3.3.cmml">k</mi></mrow><mrow id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.3" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.3.cmml"><mrow id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.3.2" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.3.2.cmml"><mi id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.3.2.2" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.3.2.2.cmml">k</mi><mo id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.3.2.1" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.3.2.1.cmml">+</mo><mi id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.3.2.3" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.3.2.3.cmml">H</mi></mrow><mo id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.3.1" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.3.1.cmml">−</mo><mn id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.3.3" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.3.3.cmml">1</mn></mrow></munderover></mstyle><mrow id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.2" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.2.cmml"><mi id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.2.4" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.2.4.cmml">c</mi><mo id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.2.3" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.2.3.cmml">⁢</mo><mrow id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.2.2.3.cmml"><mo id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.3" stretchy="false" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.2.2.3.cmml">(</mo><msub id="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mi id="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.4" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.2.2.3.cmml">,</mo><msub id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.cmml"><mi id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.2" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.2.cmml">𝒖</mi><mi id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.3" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.5" stretchy="false" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E9X.2.1.1.m1.1.1.1.1.3.4" xref="S3.E9X.2.1.1.m1.1.1.1.1.3.4.cmml">+</mo><mrow id="S3.E9X.2.1.1.m1.1.1.1.1.3.3" xref="S3.E9X.2.1.1.m1.1.1.1.1.3.3.cmml"><mi id="S3.E9X.2.1.1.m1.1.1.1.1.3.3.3" xref="S3.E9X.2.1.1.m1.1.1.1.1.3.3.3.cmml">ϕ</mi><mo id="S3.E9X.2.1.1.m1.1.1.1.1.3.3.2" xref="S3.E9X.2.1.1.m1.1.1.1.1.3.3.2.cmml">⁢</mo><mrow id="S3.E9X.2.1.1.m1.1.1.1.1.3.3.1.1" xref="S3.E9X.2.1.1.m1.1.1.1.1.3.3.1.1.1.cmml"><mo id="S3.E9X.2.1.1.m1.1.1.1.1.3.3.1.1.2" stretchy="false" xref="S3.E9X.2.1.1.m1.1.1.1.1.3.3.1.1.1.cmml">(</mo><msub id="S3.E9X.2.1.1.m1.1.1.1.1.3.3.1.1.1" xref="S3.E9X.2.1.1.m1.1.1.1.1.3.3.1.1.1.cmml"><mi id="S3.E9X.2.1.1.m1.1.1.1.1.3.3.1.1.1.2" xref="S3.E9X.2.1.1.m1.1.1.1.1.3.3.1.1.1.2.cmml">𝒙</mi><mrow id="S3.E9X.2.1.1.m1.1.1.1.1.3.3.1.1.1.3" xref="S3.E9X.2.1.1.m1.1.1.1.1.3.3.1.1.1.3.cmml"><mi id="S3.E9X.2.1.1.m1.1.1.1.1.3.3.1.1.1.3.2" xref="S3.E9X.2.1.1.m1.1.1.1.1.3.3.1.1.1.3.2.cmml">k</mi><mo id="S3.E9X.2.1.1.m1.1.1.1.1.3.3.1.1.1.3.1" xref="S3.E9X.2.1.1.m1.1.1.1.1.3.3.1.1.1.3.1.cmml">+</mo><mi id="S3.E9X.2.1.1.m1.1.1.1.1.3.3.1.1.1.3.3" xref="S3.E9X.2.1.1.m1.1.1.1.1.3.3.1.1.1.3.3.cmml">H</mi></mrow></msub><mo id="S3.E9X.2.1.1.m1.1.1.1.1.3.3.1.1.3" stretchy="false" xref="S3.E9X.2.1.1.m1.1.1.1.1.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E9X.2.1.1.m1.1.1.1.2" xref="S3.E9X.2.1.1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E9X.2.1.1.m1.1b"><apply id="S3.E9X.2.1.1.m1.1.1.1.1.cmml" xref="S3.E9X.2.1.1.m1.1.1.1"><eq id="S3.E9X.2.1.1.m1.1.1.1.1.4.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.4"></eq><apply id="S3.E9X.2.1.1.m1.1.1.1.1.5.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.E9X.2.1.1.m1.1.1.1.1.5.1.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.5">superscript</csymbol><apply id="S3.E9X.2.1.1.m1.1.1.1.1.5.2.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.E9X.2.1.1.m1.1.1.1.1.5.2.1.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.5">subscript</csymbol><ci id="S3.E9X.2.1.1.m1.1.1.1.1.5.2.2.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.5.2.2">𝑼</ci><ci id="S3.E9X.2.1.1.m1.1.1.1.1.5.2.3.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.5.2.3">𝑘</ci></apply><times id="S3.E9X.2.1.1.m1.1.1.1.1.5.3.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.5.3"></times></apply><apply id="S3.E9X.2.1.1.m1.1.1.1.1.3.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.3"><plus id="S3.E9X.2.1.1.m1.1.1.1.1.3.4.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.3.4"></plus><apply id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2"><apply id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.3.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.3.1.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.3">subscript</csymbol><ci id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.3.2.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.3.2">argmin</ci><apply id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.3.3.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.3.3"><csymbol cd="ambiguous" id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.3.3.1.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.3.3">subscript</csymbol><ci id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.3.3.2.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.3.3.2">𝑼</ci><ci id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.3.3.3.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.3.3.3">𝑘</ci></apply></apply><apply id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2"><apply id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.1.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3">superscript</csymbol><apply id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.2.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.2.1.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3">subscript</csymbol><sum id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.2.2.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.2.2"></sum><apply id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.2.3.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.2.3"><eq id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.2.3.1.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.2.3.1"></eq><ci id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.2.3.2.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.2.3.2">𝑡</ci><ci id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.2.3.3.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.2.3.3">𝑘</ci></apply></apply><apply id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.3.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.3"><minus id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.3.1.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.3.1"></minus><apply id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.3.2.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.3.2"><plus id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.3.2.1.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.3.2.1"></plus><ci id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.3.2.2.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.3.2.2">𝑘</ci><ci id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.3.2.3.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.3.2.3">𝐻</ci></apply><cn id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.3.3.cmml" type="integer" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.3.3.3">1</cn></apply></apply><apply id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.2"><times id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.2.3"></times><ci id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.2.4.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.2.4">𝑐</ci><interval closure="open" id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2"><apply id="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2">𝒙</ci><ci id="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.1.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.2.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.2">𝒖</ci><ci id="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.3.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></apply></apply><apply id="S3.E9X.2.1.1.m1.1.1.1.1.3.3.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.3.3"><times id="S3.E9X.2.1.1.m1.1.1.1.1.3.3.2.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.3.3.2"></times><ci id="S3.E9X.2.1.1.m1.1.1.1.1.3.3.3.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.3.3.3">italic-ϕ</ci><apply id="S3.E9X.2.1.1.m1.1.1.1.1.3.3.1.1.1.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.3.3.1.1"><csymbol cd="ambiguous" id="S3.E9X.2.1.1.m1.1.1.1.1.3.3.1.1.1.1.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.3.3.1.1">subscript</csymbol><ci id="S3.E9X.2.1.1.m1.1.1.1.1.3.3.1.1.1.2.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.3.3.1.1.1.2">𝒙</ci><apply id="S3.E9X.2.1.1.m1.1.1.1.1.3.3.1.1.1.3.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.3.3.1.1.1.3"><plus id="S3.E9X.2.1.1.m1.1.1.1.1.3.3.1.1.1.3.1.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.3.3.1.1.1.3.1"></plus><ci id="S3.E9X.2.1.1.m1.1.1.1.1.3.3.1.1.1.3.2.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.3.3.1.1.1.3.2">𝑘</ci><ci id="S3.E9X.2.1.1.m1.1.1.1.1.3.3.1.1.1.3.3.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.3.3.1.1.1.3.3">𝐻</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9X.2.1.1.m1.1c">\displaystyle\boldsymbol{U}_{k}^{*}=\mathop{\rm argmin}\limits_{\boldsymbol{U}%
_{k}}\sum_{t=k}^{k+H-1}c(\boldsymbol{x}_{t},\boldsymbol{u}_{t})+\phi(%
\boldsymbol{x}_{k+H}),</annotation><annotation encoding="application/x-llamapun" id="S3.E9X.2.1.1.m1.1d">bold_italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = roman_argmin start_POSTSUBSCRIPT bold_italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_t = italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k + italic_H - 1 end_POSTSUPERSCRIPT italic_c ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , bold_italic_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) + italic_ϕ ( bold_italic_x start_POSTSUBSCRIPT italic_k + italic_H end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(9)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E9Xa">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\text{s.t.}\quad\boldsymbol{x}_{t+1}=\boldsymbol{f}(\boldsymbol{x%
}_{t},\boldsymbol{u}_{t})." class="ltx_Math" display="inline" id="S3.E9Xa.2.1.1.m1.2"><semantics id="S3.E9Xa.2.1.1.m1.2a"><mrow id="S3.E9Xa.2.1.1.m1.2.2.1" xref="S3.E9Xa.2.1.1.m1.2.2.1.1.cmml"><mrow id="S3.E9Xa.2.1.1.m1.2.2.1.1" xref="S3.E9Xa.2.1.1.m1.2.2.1.1.cmml"><mrow id="S3.E9Xa.2.1.1.m1.2.2.1.1.1.1" xref="S3.E9Xa.2.1.1.m1.2.2.1.1.1.2.cmml"><mtext id="S3.E9Xa.2.1.1.m1.1.1" xref="S3.E9Xa.2.1.1.m1.1.1a.cmml">s.t.</mtext><mspace id="S3.E9Xa.2.1.1.m1.2.2.1.1.1.1.2" width="1em" xref="S3.E9Xa.2.1.1.m1.2.2.1.1.1.2.cmml"></mspace><msub id="S3.E9Xa.2.1.1.m1.2.2.1.1.1.1.1" xref="S3.E9Xa.2.1.1.m1.2.2.1.1.1.1.1.cmml"><mi id="S3.E9Xa.2.1.1.m1.2.2.1.1.1.1.1.2" xref="S3.E9Xa.2.1.1.m1.2.2.1.1.1.1.1.2.cmml">𝒙</mi><mrow id="S3.E9Xa.2.1.1.m1.2.2.1.1.1.1.1.3" xref="S3.E9Xa.2.1.1.m1.2.2.1.1.1.1.1.3.cmml"><mi id="S3.E9Xa.2.1.1.m1.2.2.1.1.1.1.1.3.2" xref="S3.E9Xa.2.1.1.m1.2.2.1.1.1.1.1.3.2.cmml">t</mi><mo id="S3.E9Xa.2.1.1.m1.2.2.1.1.1.1.1.3.1" xref="S3.E9Xa.2.1.1.m1.2.2.1.1.1.1.1.3.1.cmml">+</mo><mn id="S3.E9Xa.2.1.1.m1.2.2.1.1.1.1.1.3.3" xref="S3.E9Xa.2.1.1.m1.2.2.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.E9Xa.2.1.1.m1.2.2.1.1.4" xref="S3.E9Xa.2.1.1.m1.2.2.1.1.4.cmml">=</mo><mrow id="S3.E9Xa.2.1.1.m1.2.2.1.1.3" xref="S3.E9Xa.2.1.1.m1.2.2.1.1.3.cmml"><mi id="S3.E9Xa.2.1.1.m1.2.2.1.1.3.4" xref="S3.E9Xa.2.1.1.m1.2.2.1.1.3.4.cmml">𝒇</mi><mo id="S3.E9Xa.2.1.1.m1.2.2.1.1.3.3" xref="S3.E9Xa.2.1.1.m1.2.2.1.1.3.3.cmml">⁢</mo><mrow id="S3.E9Xa.2.1.1.m1.2.2.1.1.3.2.2" xref="S3.E9Xa.2.1.1.m1.2.2.1.1.3.2.3.cmml"><mo id="S3.E9Xa.2.1.1.m1.2.2.1.1.3.2.2.3" stretchy="false" xref="S3.E9Xa.2.1.1.m1.2.2.1.1.3.2.3.cmml">(</mo><msub id="S3.E9Xa.2.1.1.m1.2.2.1.1.2.1.1.1" xref="S3.E9Xa.2.1.1.m1.2.2.1.1.2.1.1.1.cmml"><mi id="S3.E9Xa.2.1.1.m1.2.2.1.1.2.1.1.1.2" xref="S3.E9Xa.2.1.1.m1.2.2.1.1.2.1.1.1.2.cmml">𝒙</mi><mi id="S3.E9Xa.2.1.1.m1.2.2.1.1.2.1.1.1.3" xref="S3.E9Xa.2.1.1.m1.2.2.1.1.2.1.1.1.3.cmml">t</mi></msub><mo id="S3.E9Xa.2.1.1.m1.2.2.1.1.3.2.2.4" xref="S3.E9Xa.2.1.1.m1.2.2.1.1.3.2.3.cmml">,</mo><msub id="S3.E9Xa.2.1.1.m1.2.2.1.1.3.2.2.2" xref="S3.E9Xa.2.1.1.m1.2.2.1.1.3.2.2.2.cmml"><mi id="S3.E9Xa.2.1.1.m1.2.2.1.1.3.2.2.2.2" xref="S3.E9Xa.2.1.1.m1.2.2.1.1.3.2.2.2.2.cmml">𝒖</mi><mi id="S3.E9Xa.2.1.1.m1.2.2.1.1.3.2.2.2.3" xref="S3.E9Xa.2.1.1.m1.2.2.1.1.3.2.2.2.3.cmml">t</mi></msub><mo id="S3.E9Xa.2.1.1.m1.2.2.1.1.3.2.2.5" stretchy="false" xref="S3.E9Xa.2.1.1.m1.2.2.1.1.3.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E9Xa.2.1.1.m1.2.2.1.2" lspace="0em" xref="S3.E9Xa.2.1.1.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E9Xa.2.1.1.m1.2b"><apply id="S3.E9Xa.2.1.1.m1.2.2.1.1.cmml" xref="S3.E9Xa.2.1.1.m1.2.2.1"><eq id="S3.E9Xa.2.1.1.m1.2.2.1.1.4.cmml" xref="S3.E9Xa.2.1.1.m1.2.2.1.1.4"></eq><list id="S3.E9Xa.2.1.1.m1.2.2.1.1.1.2.cmml" xref="S3.E9Xa.2.1.1.m1.2.2.1.1.1.1"><ci id="S3.E9Xa.2.1.1.m1.1.1a.cmml" xref="S3.E9Xa.2.1.1.m1.1.1"><mtext id="S3.E9Xa.2.1.1.m1.1.1.cmml" xref="S3.E9Xa.2.1.1.m1.1.1">s.t.</mtext></ci><apply id="S3.E9Xa.2.1.1.m1.2.2.1.1.1.1.1.cmml" xref="S3.E9Xa.2.1.1.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9Xa.2.1.1.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E9Xa.2.1.1.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E9Xa.2.1.1.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E9Xa.2.1.1.m1.2.2.1.1.1.1.1.2">𝒙</ci><apply id="S3.E9Xa.2.1.1.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E9Xa.2.1.1.m1.2.2.1.1.1.1.1.3"><plus id="S3.E9Xa.2.1.1.m1.2.2.1.1.1.1.1.3.1.cmml" xref="S3.E9Xa.2.1.1.m1.2.2.1.1.1.1.1.3.1"></plus><ci id="S3.E9Xa.2.1.1.m1.2.2.1.1.1.1.1.3.2.cmml" xref="S3.E9Xa.2.1.1.m1.2.2.1.1.1.1.1.3.2">𝑡</ci><cn id="S3.E9Xa.2.1.1.m1.2.2.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E9Xa.2.1.1.m1.2.2.1.1.1.1.1.3.3">1</cn></apply></apply></list><apply id="S3.E9Xa.2.1.1.m1.2.2.1.1.3.cmml" xref="S3.E9Xa.2.1.1.m1.2.2.1.1.3"><times id="S3.E9Xa.2.1.1.m1.2.2.1.1.3.3.cmml" xref="S3.E9Xa.2.1.1.m1.2.2.1.1.3.3"></times><ci id="S3.E9Xa.2.1.1.m1.2.2.1.1.3.4.cmml" xref="S3.E9Xa.2.1.1.m1.2.2.1.1.3.4">𝒇</ci><interval closure="open" id="S3.E9Xa.2.1.1.m1.2.2.1.1.3.2.3.cmml" xref="S3.E9Xa.2.1.1.m1.2.2.1.1.3.2.2"><apply id="S3.E9Xa.2.1.1.m1.2.2.1.1.2.1.1.1.cmml" xref="S3.E9Xa.2.1.1.m1.2.2.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S3.E9Xa.2.1.1.m1.2.2.1.1.2.1.1.1.1.cmml" xref="S3.E9Xa.2.1.1.m1.2.2.1.1.2.1.1.1">subscript</csymbol><ci id="S3.E9Xa.2.1.1.m1.2.2.1.1.2.1.1.1.2.cmml" xref="S3.E9Xa.2.1.1.m1.2.2.1.1.2.1.1.1.2">𝒙</ci><ci id="S3.E9Xa.2.1.1.m1.2.2.1.1.2.1.1.1.3.cmml" xref="S3.E9Xa.2.1.1.m1.2.2.1.1.2.1.1.1.3">𝑡</ci></apply><apply id="S3.E9Xa.2.1.1.m1.2.2.1.1.3.2.2.2.cmml" xref="S3.E9Xa.2.1.1.m1.2.2.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S3.E9Xa.2.1.1.m1.2.2.1.1.3.2.2.2.1.cmml" xref="S3.E9Xa.2.1.1.m1.2.2.1.1.3.2.2.2">subscript</csymbol><ci id="S3.E9Xa.2.1.1.m1.2.2.1.1.3.2.2.2.2.cmml" xref="S3.E9Xa.2.1.1.m1.2.2.1.1.3.2.2.2.2">𝒖</ci><ci id="S3.E9Xa.2.1.1.m1.2.2.1.1.3.2.2.2.3.cmml" xref="S3.E9Xa.2.1.1.m1.2.2.1.1.3.2.2.2.3">𝑡</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9Xa.2.1.1.m1.2c">\displaystyle\text{s.t.}\quad\boldsymbol{x}_{t+1}=\boldsymbol{f}(\boldsymbol{x%
}_{t},\boldsymbol{u}_{t}).</annotation><annotation encoding="application/x-llamapun" id="S3.E9Xa.2.1.1.m1.2d">s.t. bold_italic_x start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT = bold_italic_f ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , bold_italic_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S3.SS3.p1.16">where <math alttext="\boldsymbol{U}_{k}^{*}\equiv(\boldsymbol{u}_{k}^{*},\boldsymbol{u}_{k+1}^{*},%
\ldots,\boldsymbol{u}_{k+H-1}^{*})" class="ltx_Math" display="inline" id="S3.SS3.p1.4.m1.4"><semantics id="S3.SS3.p1.4.m1.4a"><mrow id="S3.SS3.p1.4.m1.4.4" xref="S3.SS3.p1.4.m1.4.4.cmml"><msubsup id="S3.SS3.p1.4.m1.4.4.5" xref="S3.SS3.p1.4.m1.4.4.5.cmml"><mi id="S3.SS3.p1.4.m1.4.4.5.2.2" xref="S3.SS3.p1.4.m1.4.4.5.2.2.cmml">𝑼</mi><mi id="S3.SS3.p1.4.m1.4.4.5.2.3" xref="S3.SS3.p1.4.m1.4.4.5.2.3.cmml">k</mi><mo id="S3.SS3.p1.4.m1.4.4.5.3" xref="S3.SS3.p1.4.m1.4.4.5.3.cmml">∗</mo></msubsup><mo id="S3.SS3.p1.4.m1.4.4.4" xref="S3.SS3.p1.4.m1.4.4.4.cmml">≡</mo><mrow id="S3.SS3.p1.4.m1.4.4.3.3" xref="S3.SS3.p1.4.m1.4.4.3.4.cmml"><mo id="S3.SS3.p1.4.m1.4.4.3.3.4" stretchy="false" xref="S3.SS3.p1.4.m1.4.4.3.4.cmml">(</mo><msubsup id="S3.SS3.p1.4.m1.2.2.1.1.1" xref="S3.SS3.p1.4.m1.2.2.1.1.1.cmml"><mi id="S3.SS3.p1.4.m1.2.2.1.1.1.2.2" xref="S3.SS3.p1.4.m1.2.2.1.1.1.2.2.cmml">𝒖</mi><mi id="S3.SS3.p1.4.m1.2.2.1.1.1.2.3" xref="S3.SS3.p1.4.m1.2.2.1.1.1.2.3.cmml">k</mi><mo id="S3.SS3.p1.4.m1.2.2.1.1.1.3" xref="S3.SS3.p1.4.m1.2.2.1.1.1.3.cmml">∗</mo></msubsup><mo id="S3.SS3.p1.4.m1.4.4.3.3.5" xref="S3.SS3.p1.4.m1.4.4.3.4.cmml">,</mo><msubsup id="S3.SS3.p1.4.m1.3.3.2.2.2" xref="S3.SS3.p1.4.m1.3.3.2.2.2.cmml"><mi id="S3.SS3.p1.4.m1.3.3.2.2.2.2.2" xref="S3.SS3.p1.4.m1.3.3.2.2.2.2.2.cmml">𝒖</mi><mrow id="S3.SS3.p1.4.m1.3.3.2.2.2.2.3" xref="S3.SS3.p1.4.m1.3.3.2.2.2.2.3.cmml"><mi id="S3.SS3.p1.4.m1.3.3.2.2.2.2.3.2" xref="S3.SS3.p1.4.m1.3.3.2.2.2.2.3.2.cmml">k</mi><mo id="S3.SS3.p1.4.m1.3.3.2.2.2.2.3.1" xref="S3.SS3.p1.4.m1.3.3.2.2.2.2.3.1.cmml">+</mo><mn id="S3.SS3.p1.4.m1.3.3.2.2.2.2.3.3" xref="S3.SS3.p1.4.m1.3.3.2.2.2.2.3.3.cmml">1</mn></mrow><mo id="S3.SS3.p1.4.m1.3.3.2.2.2.3" xref="S3.SS3.p1.4.m1.3.3.2.2.2.3.cmml">∗</mo></msubsup><mo id="S3.SS3.p1.4.m1.4.4.3.3.6" xref="S3.SS3.p1.4.m1.4.4.3.4.cmml">,</mo><mi id="S3.SS3.p1.4.m1.1.1" mathvariant="normal" xref="S3.SS3.p1.4.m1.1.1.cmml">…</mi><mo id="S3.SS3.p1.4.m1.4.4.3.3.7" xref="S3.SS3.p1.4.m1.4.4.3.4.cmml">,</mo><msubsup id="S3.SS3.p1.4.m1.4.4.3.3.3" xref="S3.SS3.p1.4.m1.4.4.3.3.3.cmml"><mi id="S3.SS3.p1.4.m1.4.4.3.3.3.2.2" xref="S3.SS3.p1.4.m1.4.4.3.3.3.2.2.cmml">𝒖</mi><mrow id="S3.SS3.p1.4.m1.4.4.3.3.3.2.3" xref="S3.SS3.p1.4.m1.4.4.3.3.3.2.3.cmml"><mrow id="S3.SS3.p1.4.m1.4.4.3.3.3.2.3.2" xref="S3.SS3.p1.4.m1.4.4.3.3.3.2.3.2.cmml"><mi id="S3.SS3.p1.4.m1.4.4.3.3.3.2.3.2.2" xref="S3.SS3.p1.4.m1.4.4.3.3.3.2.3.2.2.cmml">k</mi><mo id="S3.SS3.p1.4.m1.4.4.3.3.3.2.3.2.1" xref="S3.SS3.p1.4.m1.4.4.3.3.3.2.3.2.1.cmml">+</mo><mi id="S3.SS3.p1.4.m1.4.4.3.3.3.2.3.2.3" xref="S3.SS3.p1.4.m1.4.4.3.3.3.2.3.2.3.cmml">H</mi></mrow><mo id="S3.SS3.p1.4.m1.4.4.3.3.3.2.3.1" xref="S3.SS3.p1.4.m1.4.4.3.3.3.2.3.1.cmml">−</mo><mn id="S3.SS3.p1.4.m1.4.4.3.3.3.2.3.3" xref="S3.SS3.p1.4.m1.4.4.3.3.3.2.3.3.cmml">1</mn></mrow><mo id="S3.SS3.p1.4.m1.4.4.3.3.3.3" xref="S3.SS3.p1.4.m1.4.4.3.3.3.3.cmml">∗</mo></msubsup><mo id="S3.SS3.p1.4.m1.4.4.3.3.8" stretchy="false" xref="S3.SS3.p1.4.m1.4.4.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m1.4b"><apply id="S3.SS3.p1.4.m1.4.4.cmml" xref="S3.SS3.p1.4.m1.4.4"><equivalent id="S3.SS3.p1.4.m1.4.4.4.cmml" xref="S3.SS3.p1.4.m1.4.4.4"></equivalent><apply id="S3.SS3.p1.4.m1.4.4.5.cmml" xref="S3.SS3.p1.4.m1.4.4.5"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m1.4.4.5.1.cmml" xref="S3.SS3.p1.4.m1.4.4.5">superscript</csymbol><apply id="S3.SS3.p1.4.m1.4.4.5.2.cmml" xref="S3.SS3.p1.4.m1.4.4.5"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m1.4.4.5.2.1.cmml" xref="S3.SS3.p1.4.m1.4.4.5">subscript</csymbol><ci id="S3.SS3.p1.4.m1.4.4.5.2.2.cmml" xref="S3.SS3.p1.4.m1.4.4.5.2.2">𝑼</ci><ci id="S3.SS3.p1.4.m1.4.4.5.2.3.cmml" xref="S3.SS3.p1.4.m1.4.4.5.2.3">𝑘</ci></apply><times id="S3.SS3.p1.4.m1.4.4.5.3.cmml" xref="S3.SS3.p1.4.m1.4.4.5.3"></times></apply><vector id="S3.SS3.p1.4.m1.4.4.3.4.cmml" xref="S3.SS3.p1.4.m1.4.4.3.3"><apply id="S3.SS3.p1.4.m1.2.2.1.1.1.cmml" xref="S3.SS3.p1.4.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m1.2.2.1.1.1.1.cmml" xref="S3.SS3.p1.4.m1.2.2.1.1.1">superscript</csymbol><apply id="S3.SS3.p1.4.m1.2.2.1.1.1.2.cmml" xref="S3.SS3.p1.4.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m1.2.2.1.1.1.2.1.cmml" xref="S3.SS3.p1.4.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS3.p1.4.m1.2.2.1.1.1.2.2.cmml" xref="S3.SS3.p1.4.m1.2.2.1.1.1.2.2">𝒖</ci><ci id="S3.SS3.p1.4.m1.2.2.1.1.1.2.3.cmml" xref="S3.SS3.p1.4.m1.2.2.1.1.1.2.3">𝑘</ci></apply><times id="S3.SS3.p1.4.m1.2.2.1.1.1.3.cmml" xref="S3.SS3.p1.4.m1.2.2.1.1.1.3"></times></apply><apply id="S3.SS3.p1.4.m1.3.3.2.2.2.cmml" xref="S3.SS3.p1.4.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m1.3.3.2.2.2.1.cmml" xref="S3.SS3.p1.4.m1.3.3.2.2.2">superscript</csymbol><apply id="S3.SS3.p1.4.m1.3.3.2.2.2.2.cmml" xref="S3.SS3.p1.4.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m1.3.3.2.2.2.2.1.cmml" xref="S3.SS3.p1.4.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS3.p1.4.m1.3.3.2.2.2.2.2.cmml" xref="S3.SS3.p1.4.m1.3.3.2.2.2.2.2">𝒖</ci><apply id="S3.SS3.p1.4.m1.3.3.2.2.2.2.3.cmml" xref="S3.SS3.p1.4.m1.3.3.2.2.2.2.3"><plus id="S3.SS3.p1.4.m1.3.3.2.2.2.2.3.1.cmml" xref="S3.SS3.p1.4.m1.3.3.2.2.2.2.3.1"></plus><ci id="S3.SS3.p1.4.m1.3.3.2.2.2.2.3.2.cmml" xref="S3.SS3.p1.4.m1.3.3.2.2.2.2.3.2">𝑘</ci><cn id="S3.SS3.p1.4.m1.3.3.2.2.2.2.3.3.cmml" type="integer" xref="S3.SS3.p1.4.m1.3.3.2.2.2.2.3.3">1</cn></apply></apply><times id="S3.SS3.p1.4.m1.3.3.2.2.2.3.cmml" xref="S3.SS3.p1.4.m1.3.3.2.2.2.3"></times></apply><ci id="S3.SS3.p1.4.m1.1.1.cmml" xref="S3.SS3.p1.4.m1.1.1">…</ci><apply id="S3.SS3.p1.4.m1.4.4.3.3.3.cmml" xref="S3.SS3.p1.4.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m1.4.4.3.3.3.1.cmml" xref="S3.SS3.p1.4.m1.4.4.3.3.3">superscript</csymbol><apply id="S3.SS3.p1.4.m1.4.4.3.3.3.2.cmml" xref="S3.SS3.p1.4.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m1.4.4.3.3.3.2.1.cmml" xref="S3.SS3.p1.4.m1.4.4.3.3.3">subscript</csymbol><ci id="S3.SS3.p1.4.m1.4.4.3.3.3.2.2.cmml" xref="S3.SS3.p1.4.m1.4.4.3.3.3.2.2">𝒖</ci><apply id="S3.SS3.p1.4.m1.4.4.3.3.3.2.3.cmml" xref="S3.SS3.p1.4.m1.4.4.3.3.3.2.3"><minus id="S3.SS3.p1.4.m1.4.4.3.3.3.2.3.1.cmml" xref="S3.SS3.p1.4.m1.4.4.3.3.3.2.3.1"></minus><apply id="S3.SS3.p1.4.m1.4.4.3.3.3.2.3.2.cmml" xref="S3.SS3.p1.4.m1.4.4.3.3.3.2.3.2"><plus id="S3.SS3.p1.4.m1.4.4.3.3.3.2.3.2.1.cmml" xref="S3.SS3.p1.4.m1.4.4.3.3.3.2.3.2.1"></plus><ci id="S3.SS3.p1.4.m1.4.4.3.3.3.2.3.2.2.cmml" xref="S3.SS3.p1.4.m1.4.4.3.3.3.2.3.2.2">𝑘</ci><ci id="S3.SS3.p1.4.m1.4.4.3.3.3.2.3.2.3.cmml" xref="S3.SS3.p1.4.m1.4.4.3.3.3.2.3.2.3">𝐻</ci></apply><cn id="S3.SS3.p1.4.m1.4.4.3.3.3.2.3.3.cmml" type="integer" xref="S3.SS3.p1.4.m1.4.4.3.3.3.2.3.3">1</cn></apply></apply><times id="S3.SS3.p1.4.m1.4.4.3.3.3.3.cmml" xref="S3.SS3.p1.4.m1.4.4.3.3.3.3"></times></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m1.4c">\boldsymbol{U}_{k}^{*}\equiv(\boldsymbol{u}_{k}^{*},\boldsymbol{u}_{k+1}^{*},%
\ldots,\boldsymbol{u}_{k+H-1}^{*})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.4.m1.4d">bold_italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ≡ ( bold_italic_u start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT , bold_italic_u start_POSTSUBSCRIPT italic_k + 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT , … , bold_italic_u start_POSTSUBSCRIPT italic_k + italic_H - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT )</annotation></semantics></math> represents the computed optimal control sequence. The term <math alttext="\phi(\boldsymbol{x}_{k+H})" class="ltx_Math" display="inline" id="S3.SS3.p1.5.m2.1"><semantics id="S3.SS3.p1.5.m2.1a"><mrow id="S3.SS3.p1.5.m2.1.1" xref="S3.SS3.p1.5.m2.1.1.cmml"><mi id="S3.SS3.p1.5.m2.1.1.3" xref="S3.SS3.p1.5.m2.1.1.3.cmml">ϕ</mi><mo id="S3.SS3.p1.5.m2.1.1.2" xref="S3.SS3.p1.5.m2.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.p1.5.m2.1.1.1.1" xref="S3.SS3.p1.5.m2.1.1.1.1.1.cmml"><mo id="S3.SS3.p1.5.m2.1.1.1.1.2" stretchy="false" xref="S3.SS3.p1.5.m2.1.1.1.1.1.cmml">(</mo><msub id="S3.SS3.p1.5.m2.1.1.1.1.1" xref="S3.SS3.p1.5.m2.1.1.1.1.1.cmml"><mi id="S3.SS3.p1.5.m2.1.1.1.1.1.2" xref="S3.SS3.p1.5.m2.1.1.1.1.1.2.cmml">𝒙</mi><mrow id="S3.SS3.p1.5.m2.1.1.1.1.1.3" xref="S3.SS3.p1.5.m2.1.1.1.1.1.3.cmml"><mi id="S3.SS3.p1.5.m2.1.1.1.1.1.3.2" xref="S3.SS3.p1.5.m2.1.1.1.1.1.3.2.cmml">k</mi><mo id="S3.SS3.p1.5.m2.1.1.1.1.1.3.1" xref="S3.SS3.p1.5.m2.1.1.1.1.1.3.1.cmml">+</mo><mi id="S3.SS3.p1.5.m2.1.1.1.1.1.3.3" xref="S3.SS3.p1.5.m2.1.1.1.1.1.3.3.cmml">H</mi></mrow></msub><mo id="S3.SS3.p1.5.m2.1.1.1.1.3" stretchy="false" xref="S3.SS3.p1.5.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m2.1b"><apply id="S3.SS3.p1.5.m2.1.1.cmml" xref="S3.SS3.p1.5.m2.1.1"><times id="S3.SS3.p1.5.m2.1.1.2.cmml" xref="S3.SS3.p1.5.m2.1.1.2"></times><ci id="S3.SS3.p1.5.m2.1.1.3.cmml" xref="S3.SS3.p1.5.m2.1.1.3">italic-ϕ</ci><apply id="S3.SS3.p1.5.m2.1.1.1.1.1.cmml" xref="S3.SS3.p1.5.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m2.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.5.m2.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p1.5.m2.1.1.1.1.1.2.cmml" xref="S3.SS3.p1.5.m2.1.1.1.1.1.2">𝒙</ci><apply id="S3.SS3.p1.5.m2.1.1.1.1.1.3.cmml" xref="S3.SS3.p1.5.m2.1.1.1.1.1.3"><plus id="S3.SS3.p1.5.m2.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p1.5.m2.1.1.1.1.1.3.1"></plus><ci id="S3.SS3.p1.5.m2.1.1.1.1.1.3.2.cmml" xref="S3.SS3.p1.5.m2.1.1.1.1.1.3.2">𝑘</ci><ci id="S3.SS3.p1.5.m2.1.1.1.1.1.3.3.cmml" xref="S3.SS3.p1.5.m2.1.1.1.1.1.3.3">𝐻</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m2.1c">\phi(\boldsymbol{x}_{k+H})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.5.m2.1d">italic_ϕ ( bold_italic_x start_POSTSUBSCRIPT italic_k + italic_H end_POSTSUBSCRIPT )</annotation></semantics></math> is referred to as the terminal cost or terminal value, representing the cost at the terminal state <math alttext="\boldsymbol{x}_{k+H}" class="ltx_Math" display="inline" id="S3.SS3.p1.6.m3.1"><semantics id="S3.SS3.p1.6.m3.1a"><msub id="S3.SS3.p1.6.m3.1.1" xref="S3.SS3.p1.6.m3.1.1.cmml"><mi id="S3.SS3.p1.6.m3.1.1.2" xref="S3.SS3.p1.6.m3.1.1.2.cmml">𝒙</mi><mrow id="S3.SS3.p1.6.m3.1.1.3" xref="S3.SS3.p1.6.m3.1.1.3.cmml"><mi id="S3.SS3.p1.6.m3.1.1.3.2" xref="S3.SS3.p1.6.m3.1.1.3.2.cmml">k</mi><mo id="S3.SS3.p1.6.m3.1.1.3.1" xref="S3.SS3.p1.6.m3.1.1.3.1.cmml">+</mo><mi id="S3.SS3.p1.6.m3.1.1.3.3" xref="S3.SS3.p1.6.m3.1.1.3.3.cmml">H</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m3.1b"><apply id="S3.SS3.p1.6.m3.1.1.cmml" xref="S3.SS3.p1.6.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.6.m3.1.1.1.cmml" xref="S3.SS3.p1.6.m3.1.1">subscript</csymbol><ci id="S3.SS3.p1.6.m3.1.1.2.cmml" xref="S3.SS3.p1.6.m3.1.1.2">𝒙</ci><apply id="S3.SS3.p1.6.m3.1.1.3.cmml" xref="S3.SS3.p1.6.m3.1.1.3"><plus id="S3.SS3.p1.6.m3.1.1.3.1.cmml" xref="S3.SS3.p1.6.m3.1.1.3.1"></plus><ci id="S3.SS3.p1.6.m3.1.1.3.2.cmml" xref="S3.SS3.p1.6.m3.1.1.3.2">𝑘</ci><ci id="S3.SS3.p1.6.m3.1.1.3.3.cmml" xref="S3.SS3.p1.6.m3.1.1.3.3">𝐻</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m3.1c">\boldsymbol{x}_{k+H}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.6.m3.1d">bold_italic_x start_POSTSUBSCRIPT italic_k + italic_H end_POSTSUBSCRIPT</annotation></semantics></math>. Upon obtaining the optimal control sequence <math alttext="\boldsymbol{U}_{k}^{*}" class="ltx_Math" display="inline" id="S3.SS3.p1.7.m4.1"><semantics id="S3.SS3.p1.7.m4.1a"><msubsup id="S3.SS3.p1.7.m4.1.1" xref="S3.SS3.p1.7.m4.1.1.cmml"><mi id="S3.SS3.p1.7.m4.1.1.2.2" xref="S3.SS3.p1.7.m4.1.1.2.2.cmml">𝑼</mi><mi id="S3.SS3.p1.7.m4.1.1.2.3" xref="S3.SS3.p1.7.m4.1.1.2.3.cmml">k</mi><mo id="S3.SS3.p1.7.m4.1.1.3" xref="S3.SS3.p1.7.m4.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m4.1b"><apply id="S3.SS3.p1.7.m4.1.1.cmml" xref="S3.SS3.p1.7.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.7.m4.1.1.1.cmml" xref="S3.SS3.p1.7.m4.1.1">superscript</csymbol><apply id="S3.SS3.p1.7.m4.1.1.2.cmml" xref="S3.SS3.p1.7.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.7.m4.1.1.2.1.cmml" xref="S3.SS3.p1.7.m4.1.1">subscript</csymbol><ci id="S3.SS3.p1.7.m4.1.1.2.2.cmml" xref="S3.SS3.p1.7.m4.1.1.2.2">𝑼</ci><ci id="S3.SS3.p1.7.m4.1.1.2.3.cmml" xref="S3.SS3.p1.7.m4.1.1.2.3">𝑘</ci></apply><times id="S3.SS3.p1.7.m4.1.1.3.cmml" xref="S3.SS3.p1.7.m4.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.7.m4.1c">\boldsymbol{U}_{k}^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.7.m4.1d">bold_italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> at step <math alttext="k" class="ltx_Math" display="inline" id="S3.SS3.p1.8.m5.1"><semantics id="S3.SS3.p1.8.m5.1a"><mi id="S3.SS3.p1.8.m5.1.1" xref="S3.SS3.p1.8.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.8.m5.1b"><ci id="S3.SS3.p1.8.m5.1.1.cmml" xref="S3.SS3.p1.8.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.8.m5.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.8.m5.1d">italic_k</annotation></semantics></math>, the initial value <math alttext="\boldsymbol{u}_{k}^{*}" class="ltx_Math" display="inline" id="S3.SS3.p1.9.m6.1"><semantics id="S3.SS3.p1.9.m6.1a"><msubsup id="S3.SS3.p1.9.m6.1.1" xref="S3.SS3.p1.9.m6.1.1.cmml"><mi id="S3.SS3.p1.9.m6.1.1.2.2" xref="S3.SS3.p1.9.m6.1.1.2.2.cmml">𝒖</mi><mi id="S3.SS3.p1.9.m6.1.1.2.3" xref="S3.SS3.p1.9.m6.1.1.2.3.cmml">k</mi><mo id="S3.SS3.p1.9.m6.1.1.3" xref="S3.SS3.p1.9.m6.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.9.m6.1b"><apply id="S3.SS3.p1.9.m6.1.1.cmml" xref="S3.SS3.p1.9.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.9.m6.1.1.1.cmml" xref="S3.SS3.p1.9.m6.1.1">superscript</csymbol><apply id="S3.SS3.p1.9.m6.1.1.2.cmml" xref="S3.SS3.p1.9.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.9.m6.1.1.2.1.cmml" xref="S3.SS3.p1.9.m6.1.1">subscript</csymbol><ci id="S3.SS3.p1.9.m6.1.1.2.2.cmml" xref="S3.SS3.p1.9.m6.1.1.2.2">𝒖</ci><ci id="S3.SS3.p1.9.m6.1.1.2.3.cmml" xref="S3.SS3.p1.9.m6.1.1.2.3">𝑘</ci></apply><times id="S3.SS3.p1.9.m6.1.1.3.cmml" xref="S3.SS3.p1.9.m6.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.9.m6.1c">\boldsymbol{u}_{k}^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.9.m6.1d">bold_italic_u start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> is applied to the actual system. Following the observation of the new state at step <math alttext="k+1" class="ltx_Math" display="inline" id="S3.SS3.p1.10.m7.1"><semantics id="S3.SS3.p1.10.m7.1a"><mrow id="S3.SS3.p1.10.m7.1.1" xref="S3.SS3.p1.10.m7.1.1.cmml"><mi id="S3.SS3.p1.10.m7.1.1.2" xref="S3.SS3.p1.10.m7.1.1.2.cmml">k</mi><mo id="S3.SS3.p1.10.m7.1.1.1" xref="S3.SS3.p1.10.m7.1.1.1.cmml">+</mo><mn id="S3.SS3.p1.10.m7.1.1.3" xref="S3.SS3.p1.10.m7.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.10.m7.1b"><apply id="S3.SS3.p1.10.m7.1.1.cmml" xref="S3.SS3.p1.10.m7.1.1"><plus id="S3.SS3.p1.10.m7.1.1.1.cmml" xref="S3.SS3.p1.10.m7.1.1.1"></plus><ci id="S3.SS3.p1.10.m7.1.1.2.cmml" xref="S3.SS3.p1.10.m7.1.1.2">𝑘</ci><cn id="S3.SS3.p1.10.m7.1.1.3.cmml" type="integer" xref="S3.SS3.p1.10.m7.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.10.m7.1c">k+1</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.10.m7.1d">italic_k + 1</annotation></semantics></math>, a new optimal control sequence <math alttext="\boldsymbol{U}_{k+1}^{*}" class="ltx_Math" display="inline" id="S3.SS3.p1.11.m8.1"><semantics id="S3.SS3.p1.11.m8.1a"><msubsup id="S3.SS3.p1.11.m8.1.1" xref="S3.SS3.p1.11.m8.1.1.cmml"><mi id="S3.SS3.p1.11.m8.1.1.2.2" xref="S3.SS3.p1.11.m8.1.1.2.2.cmml">𝑼</mi><mrow id="S3.SS3.p1.11.m8.1.1.2.3" xref="S3.SS3.p1.11.m8.1.1.2.3.cmml"><mi id="S3.SS3.p1.11.m8.1.1.2.3.2" xref="S3.SS3.p1.11.m8.1.1.2.3.2.cmml">k</mi><mo id="S3.SS3.p1.11.m8.1.1.2.3.1" xref="S3.SS3.p1.11.m8.1.1.2.3.1.cmml">+</mo><mn id="S3.SS3.p1.11.m8.1.1.2.3.3" xref="S3.SS3.p1.11.m8.1.1.2.3.3.cmml">1</mn></mrow><mo id="S3.SS3.p1.11.m8.1.1.3" xref="S3.SS3.p1.11.m8.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.11.m8.1b"><apply id="S3.SS3.p1.11.m8.1.1.cmml" xref="S3.SS3.p1.11.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.11.m8.1.1.1.cmml" xref="S3.SS3.p1.11.m8.1.1">superscript</csymbol><apply id="S3.SS3.p1.11.m8.1.1.2.cmml" xref="S3.SS3.p1.11.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.11.m8.1.1.2.1.cmml" xref="S3.SS3.p1.11.m8.1.1">subscript</csymbol><ci id="S3.SS3.p1.11.m8.1.1.2.2.cmml" xref="S3.SS3.p1.11.m8.1.1.2.2">𝑼</ci><apply id="S3.SS3.p1.11.m8.1.1.2.3.cmml" xref="S3.SS3.p1.11.m8.1.1.2.3"><plus id="S3.SS3.p1.11.m8.1.1.2.3.1.cmml" xref="S3.SS3.p1.11.m8.1.1.2.3.1"></plus><ci id="S3.SS3.p1.11.m8.1.1.2.3.2.cmml" xref="S3.SS3.p1.11.m8.1.1.2.3.2">𝑘</ci><cn id="S3.SS3.p1.11.m8.1.1.2.3.3.cmml" type="integer" xref="S3.SS3.p1.11.m8.1.1.2.3.3">1</cn></apply></apply><times id="S3.SS3.p1.11.m8.1.1.3.cmml" xref="S3.SS3.p1.11.m8.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.11.m8.1c">\boldsymbol{U}_{k+1}^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.11.m8.1d">bold_italic_U start_POSTSUBSCRIPT italic_k + 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> is computed. This process is repeated at each step, thereby implementing a state feedback control method that depends on the current state. When applying MPC to real systems like robots, the optimal control sequence must be computed in real-time, meaning that Eq.(<a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S3.E9" title="In 3.3 Model Predictive Control (MPC) ‣ 3 Preliminaries ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">9</span></a>) needs to be solved within each control period.
The prediction horizon <math alttext="H" class="ltx_Math" display="inline" id="S3.SS3.p1.12.m9.1"><semantics id="S3.SS3.p1.12.m9.1a"><mi id="S3.SS3.p1.12.m9.1.1" xref="S3.SS3.p1.12.m9.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.12.m9.1b"><ci id="S3.SS3.p1.12.m9.1.1.cmml" xref="S3.SS3.p1.12.m9.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.12.m9.1c">H</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.12.m9.1d">italic_H</annotation></semantics></math> of MPC is a crucial parameter for real-time control. Under the assumption of an accurate system model, a larger <math alttext="H" class="ltx_Math" display="inline" id="S3.SS3.p1.13.m10.1"><semantics id="S3.SS3.p1.13.m10.1a"><mi id="S3.SS3.p1.13.m10.1.1" xref="S3.SS3.p1.13.m10.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.13.m10.1b"><ci id="S3.SS3.p1.13.m10.1.1.cmml" xref="S3.SS3.p1.13.m10.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.13.m10.1c">H</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.13.m10.1d">italic_H</annotation></semantics></math> leads to better solutions but also increases the computational cost. Furthermore, the terminal value <math alttext="\phi(\boldsymbol{x}_{k+H})" class="ltx_Math" display="inline" id="S3.SS3.p1.14.m11.1"><semantics id="S3.SS3.p1.14.m11.1a"><mrow id="S3.SS3.p1.14.m11.1.1" xref="S3.SS3.p1.14.m11.1.1.cmml"><mi id="S3.SS3.p1.14.m11.1.1.3" xref="S3.SS3.p1.14.m11.1.1.3.cmml">ϕ</mi><mo id="S3.SS3.p1.14.m11.1.1.2" xref="S3.SS3.p1.14.m11.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.p1.14.m11.1.1.1.1" xref="S3.SS3.p1.14.m11.1.1.1.1.1.cmml"><mo id="S3.SS3.p1.14.m11.1.1.1.1.2" stretchy="false" xref="S3.SS3.p1.14.m11.1.1.1.1.1.cmml">(</mo><msub id="S3.SS3.p1.14.m11.1.1.1.1.1" xref="S3.SS3.p1.14.m11.1.1.1.1.1.cmml"><mi id="S3.SS3.p1.14.m11.1.1.1.1.1.2" xref="S3.SS3.p1.14.m11.1.1.1.1.1.2.cmml">𝒙</mi><mrow id="S3.SS3.p1.14.m11.1.1.1.1.1.3" xref="S3.SS3.p1.14.m11.1.1.1.1.1.3.cmml"><mi id="S3.SS3.p1.14.m11.1.1.1.1.1.3.2" xref="S3.SS3.p1.14.m11.1.1.1.1.1.3.2.cmml">k</mi><mo id="S3.SS3.p1.14.m11.1.1.1.1.1.3.1" xref="S3.SS3.p1.14.m11.1.1.1.1.1.3.1.cmml">+</mo><mi id="S3.SS3.p1.14.m11.1.1.1.1.1.3.3" xref="S3.SS3.p1.14.m11.1.1.1.1.1.3.3.cmml">H</mi></mrow></msub><mo id="S3.SS3.p1.14.m11.1.1.1.1.3" stretchy="false" xref="S3.SS3.p1.14.m11.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.14.m11.1b"><apply id="S3.SS3.p1.14.m11.1.1.cmml" xref="S3.SS3.p1.14.m11.1.1"><times id="S3.SS3.p1.14.m11.1.1.2.cmml" xref="S3.SS3.p1.14.m11.1.1.2"></times><ci id="S3.SS3.p1.14.m11.1.1.3.cmml" xref="S3.SS3.p1.14.m11.1.1.3">italic-ϕ</ci><apply id="S3.SS3.p1.14.m11.1.1.1.1.1.cmml" xref="S3.SS3.p1.14.m11.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.14.m11.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.14.m11.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p1.14.m11.1.1.1.1.1.2.cmml" xref="S3.SS3.p1.14.m11.1.1.1.1.1.2">𝒙</ci><apply id="S3.SS3.p1.14.m11.1.1.1.1.1.3.cmml" xref="S3.SS3.p1.14.m11.1.1.1.1.1.3"><plus id="S3.SS3.p1.14.m11.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p1.14.m11.1.1.1.1.1.3.1"></plus><ci id="S3.SS3.p1.14.m11.1.1.1.1.1.3.2.cmml" xref="S3.SS3.p1.14.m11.1.1.1.1.1.3.2">𝑘</ci><ci id="S3.SS3.p1.14.m11.1.1.1.1.1.3.3.cmml" xref="S3.SS3.p1.14.m11.1.1.1.1.1.3.3">𝐻</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.14.m11.1c">\phi(\boldsymbol{x}_{k+H})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.14.m11.1d">italic_ϕ ( bold_italic_x start_POSTSUBSCRIPT italic_k + italic_H end_POSTSUBSCRIPT )</annotation></semantics></math> is an important factor contributing to the performance of MPC. Since MPC only takes a finite future into account to obtain the optimal control sequence, treating the terminal cost as the value at the terminal state allows for the substitution of predictions beyond <math alttext="\boldsymbol{x}_{k+H}" class="ltx_Math" display="inline" id="S3.SS3.p1.15.m12.1"><semantics id="S3.SS3.p1.15.m12.1a"><msub id="S3.SS3.p1.15.m12.1.1" xref="S3.SS3.p1.15.m12.1.1.cmml"><mi id="S3.SS3.p1.15.m12.1.1.2" xref="S3.SS3.p1.15.m12.1.1.2.cmml">𝒙</mi><mrow id="S3.SS3.p1.15.m12.1.1.3" xref="S3.SS3.p1.15.m12.1.1.3.cmml"><mi id="S3.SS3.p1.15.m12.1.1.3.2" xref="S3.SS3.p1.15.m12.1.1.3.2.cmml">k</mi><mo id="S3.SS3.p1.15.m12.1.1.3.1" xref="S3.SS3.p1.15.m12.1.1.3.1.cmml">+</mo><mi id="S3.SS3.p1.15.m12.1.1.3.3" xref="S3.SS3.p1.15.m12.1.1.3.3.cmml">H</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.15.m12.1b"><apply id="S3.SS3.p1.15.m12.1.1.cmml" xref="S3.SS3.p1.15.m12.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.15.m12.1.1.1.cmml" xref="S3.SS3.p1.15.m12.1.1">subscript</csymbol><ci id="S3.SS3.p1.15.m12.1.1.2.cmml" xref="S3.SS3.p1.15.m12.1.1.2">𝒙</ci><apply id="S3.SS3.p1.15.m12.1.1.3.cmml" xref="S3.SS3.p1.15.m12.1.1.3"><plus id="S3.SS3.p1.15.m12.1.1.3.1.cmml" xref="S3.SS3.p1.15.m12.1.1.3.1"></plus><ci id="S3.SS3.p1.15.m12.1.1.3.2.cmml" xref="S3.SS3.p1.15.m12.1.1.3.2">𝑘</ci><ci id="S3.SS3.p1.15.m12.1.1.3.3.cmml" xref="S3.SS3.p1.15.m12.1.1.3.3">𝐻</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.15.m12.1c">\boldsymbol{x}_{k+H}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.15.m12.1d">bold_italic_x start_POSTSUBSCRIPT italic_k + italic_H end_POSTSUBSCRIPT</annotation></semantics></math>. By introducing a discount rate <math alttext="\gamma" class="ltx_Math" display="inline" id="S3.SS3.p1.16.m13.1"><semantics id="S3.SS3.p1.16.m13.1a"><mi id="S3.SS3.p1.16.m13.1.1" xref="S3.SS3.p1.16.m13.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.16.m13.1b"><ci id="S3.SS3.p1.16.m13.1.1.cmml" xref="S3.SS3.p1.16.m13.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.16.m13.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.16.m13.1d">italic_γ</annotation></semantics></math> into Eq.(<a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S3.E9" title="In 3.3 Model Predictive Control (MPC) ‣ 3 Preliminaries ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">9</span></a>), the optimized control sequence can be expressed as follows:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E10">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E10X">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\boldsymbol{U}_{k}^{*}=\mathop{\rm argmin}\limits_{\boldsymbol{U}%
_{k}}\sum_{t=k}^{k+H-1}\gamma^{t}c(\boldsymbol{x}_{t},\boldsymbol{u}_{t})+%
\gamma^{H}\phi(\boldsymbol{x}_{k+H})," class="ltx_Math" display="inline" id="S3.E10X.2.1.1.m1.1"><semantics id="S3.E10X.2.1.1.m1.1a"><mrow id="S3.E10X.2.1.1.m1.1.1.1" xref="S3.E10X.2.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E10X.2.1.1.m1.1.1.1.1" xref="S3.E10X.2.1.1.m1.1.1.1.1.cmml"><msubsup id="S3.E10X.2.1.1.m1.1.1.1.1.5" xref="S3.E10X.2.1.1.m1.1.1.1.1.5.cmml"><mi id="S3.E10X.2.1.1.m1.1.1.1.1.5.2.2" xref="S3.E10X.2.1.1.m1.1.1.1.1.5.2.2.cmml">𝑼</mi><mi id="S3.E10X.2.1.1.m1.1.1.1.1.5.2.3" xref="S3.E10X.2.1.1.m1.1.1.1.1.5.2.3.cmml">k</mi><mo id="S3.E10X.2.1.1.m1.1.1.1.1.5.3" xref="S3.E10X.2.1.1.m1.1.1.1.1.5.3.cmml">∗</mo></msubsup><mo id="S3.E10X.2.1.1.m1.1.1.1.1.4" rspace="0.1389em" xref="S3.E10X.2.1.1.m1.1.1.1.1.4.cmml">=</mo><mrow id="S3.E10X.2.1.1.m1.1.1.1.1.3" xref="S3.E10X.2.1.1.m1.1.1.1.1.3.cmml"><mrow id="S3.E10X.2.1.1.m1.1.1.1.1.2.2" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.cmml"><munder id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.cmml"><mo id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2" lspace="0.1389em" movablelimits="false" rspace="0.167em" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.cmml">argmin</mo><msub id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.3" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.3.cmml"><mi id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.3.2" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.3.2.cmml">𝑼</mi><mi id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.3.3" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.3.3.cmml">k</mi></msub></munder><mrow id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.cmml"><mstyle displaystyle="true" id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.cmml"><munderover id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3a" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.cmml"><mo id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.2.2" movablelimits="false" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.2.2.cmml">∑</mo><mrow id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.2.3" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.2.3.cmml"><mi id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.2.3.2" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.2.3.2.cmml">t</mi><mo id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.2.3.1" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.2.3.1.cmml">=</mo><mi id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.2.3.3" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.2.3.3.cmml">k</mi></mrow><mrow id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.3" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.3.cmml"><mrow id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.3.2" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.3.2.cmml"><mi id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.3.2.2" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.3.2.2.cmml">k</mi><mo id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.3.2.1" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.3.2.1.cmml">+</mo><mi id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.3.2.3" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.3.2.3.cmml">H</mi></mrow><mo id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.3.1" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.3.1.cmml">−</mo><mn id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.3.3" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.3.3.cmml">1</mn></mrow></munderover></mstyle><mrow id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.cmml"><msup id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.4" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.4.cmml"><mi id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.4.2" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.4.2.cmml">γ</mi><mi id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.4.3" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.4.3.cmml">t</mi></msup><mo id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.3" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.3.cmml">⁢</mo><mi id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.5" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.5.cmml">c</mi><mo id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.3a" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.3.cmml">⁢</mo><mrow id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.2.3.cmml"><mo id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.3" stretchy="false" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.2.3.cmml">(</mo><msub id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mi id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.4" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.2.3.cmml">,</mo><msub id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.cmml"><mi id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.2" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.2.cmml">𝒖</mi><mi id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.3" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.5" stretchy="false" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E10X.2.1.1.m1.1.1.1.1.3.4" xref="S3.E10X.2.1.1.m1.1.1.1.1.3.4.cmml">+</mo><mrow id="S3.E10X.2.1.1.m1.1.1.1.1.3.3" xref="S3.E10X.2.1.1.m1.1.1.1.1.3.3.cmml"><msup id="S3.E10X.2.1.1.m1.1.1.1.1.3.3.3" xref="S3.E10X.2.1.1.m1.1.1.1.1.3.3.3.cmml"><mi id="S3.E10X.2.1.1.m1.1.1.1.1.3.3.3.2" xref="S3.E10X.2.1.1.m1.1.1.1.1.3.3.3.2.cmml">γ</mi><mi id="S3.E10X.2.1.1.m1.1.1.1.1.3.3.3.3" xref="S3.E10X.2.1.1.m1.1.1.1.1.3.3.3.3.cmml">H</mi></msup><mo id="S3.E10X.2.1.1.m1.1.1.1.1.3.3.2" xref="S3.E10X.2.1.1.m1.1.1.1.1.3.3.2.cmml">⁢</mo><mi id="S3.E10X.2.1.1.m1.1.1.1.1.3.3.4" xref="S3.E10X.2.1.1.m1.1.1.1.1.3.3.4.cmml">ϕ</mi><mo id="S3.E10X.2.1.1.m1.1.1.1.1.3.3.2a" xref="S3.E10X.2.1.1.m1.1.1.1.1.3.3.2.cmml">⁢</mo><mrow id="S3.E10X.2.1.1.m1.1.1.1.1.3.3.1.1" xref="S3.E10X.2.1.1.m1.1.1.1.1.3.3.1.1.1.cmml"><mo id="S3.E10X.2.1.1.m1.1.1.1.1.3.3.1.1.2" stretchy="false" xref="S3.E10X.2.1.1.m1.1.1.1.1.3.3.1.1.1.cmml">(</mo><msub id="S3.E10X.2.1.1.m1.1.1.1.1.3.3.1.1.1" xref="S3.E10X.2.1.1.m1.1.1.1.1.3.3.1.1.1.cmml"><mi id="S3.E10X.2.1.1.m1.1.1.1.1.3.3.1.1.1.2" xref="S3.E10X.2.1.1.m1.1.1.1.1.3.3.1.1.1.2.cmml">𝒙</mi><mrow id="S3.E10X.2.1.1.m1.1.1.1.1.3.3.1.1.1.3" xref="S3.E10X.2.1.1.m1.1.1.1.1.3.3.1.1.1.3.cmml"><mi id="S3.E10X.2.1.1.m1.1.1.1.1.3.3.1.1.1.3.2" xref="S3.E10X.2.1.1.m1.1.1.1.1.3.3.1.1.1.3.2.cmml">k</mi><mo id="S3.E10X.2.1.1.m1.1.1.1.1.3.3.1.1.1.3.1" xref="S3.E10X.2.1.1.m1.1.1.1.1.3.3.1.1.1.3.1.cmml">+</mo><mi id="S3.E10X.2.1.1.m1.1.1.1.1.3.3.1.1.1.3.3" xref="S3.E10X.2.1.1.m1.1.1.1.1.3.3.1.1.1.3.3.cmml">H</mi></mrow></msub><mo id="S3.E10X.2.1.1.m1.1.1.1.1.3.3.1.1.3" stretchy="false" xref="S3.E10X.2.1.1.m1.1.1.1.1.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E10X.2.1.1.m1.1.1.1.2" xref="S3.E10X.2.1.1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E10X.2.1.1.m1.1b"><apply id="S3.E10X.2.1.1.m1.1.1.1.1.cmml" xref="S3.E10X.2.1.1.m1.1.1.1"><eq id="S3.E10X.2.1.1.m1.1.1.1.1.4.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.4"></eq><apply id="S3.E10X.2.1.1.m1.1.1.1.1.5.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.E10X.2.1.1.m1.1.1.1.1.5.1.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.5">superscript</csymbol><apply id="S3.E10X.2.1.1.m1.1.1.1.1.5.2.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.E10X.2.1.1.m1.1.1.1.1.5.2.1.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.5">subscript</csymbol><ci id="S3.E10X.2.1.1.m1.1.1.1.1.5.2.2.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.5.2.2">𝑼</ci><ci id="S3.E10X.2.1.1.m1.1.1.1.1.5.2.3.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.5.2.3">𝑘</ci></apply><times id="S3.E10X.2.1.1.m1.1.1.1.1.5.3.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.5.3"></times></apply><apply id="S3.E10X.2.1.1.m1.1.1.1.1.3.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.3"><plus id="S3.E10X.2.1.1.m1.1.1.1.1.3.4.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.3.4"></plus><apply id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2"><apply id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.1.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3">subscript</csymbol><ci id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2">argmin</ci><apply id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.3.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.3"><csymbol cd="ambiguous" id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.3.1.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.3">subscript</csymbol><ci id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.3.2.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.3.2">𝑼</ci><ci id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.3.3.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.3.3">𝑘</ci></apply></apply><apply id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2"><apply id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.1.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3">superscript</csymbol><apply id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.2.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.2.1.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3">subscript</csymbol><sum id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.2.2.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.2.2"></sum><apply id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.2.3.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.2.3"><eq id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.2.3.1.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.2.3.1"></eq><ci id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.2.3.2.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.2.3.2">𝑡</ci><ci id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.2.3.3.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.2.3.3">𝑘</ci></apply></apply><apply id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.3.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.3"><minus id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.3.1.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.3.1"></minus><apply id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.3.2.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.3.2"><plus id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.3.2.1.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.3.2.1"></plus><ci id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.3.2.2.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.3.2.2">𝑘</ci><ci id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.3.2.3.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.3.2.3">𝐻</ci></apply><cn id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.3.3.cmml" type="integer" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.3.3.3">1</cn></apply></apply><apply id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2"><times id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.3"></times><apply id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.4.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.4"><csymbol cd="ambiguous" id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.4.1.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.4">superscript</csymbol><ci id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.4.2.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.4.2">𝛾</ci><ci id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.4.3.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.4.3">𝑡</ci></apply><ci id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.5.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.5">𝑐</ci><interval closure="open" id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2"><apply id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2">𝒙</ci><ci id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.1.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.2.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.2">𝒖</ci><ci id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.3.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></apply></apply><apply id="S3.E10X.2.1.1.m1.1.1.1.1.3.3.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.3.3"><times id="S3.E10X.2.1.1.m1.1.1.1.1.3.3.2.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.3.3.2"></times><apply id="S3.E10X.2.1.1.m1.1.1.1.1.3.3.3.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E10X.2.1.1.m1.1.1.1.1.3.3.3.1.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.3.3.3">superscript</csymbol><ci id="S3.E10X.2.1.1.m1.1.1.1.1.3.3.3.2.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.3.3.3.2">𝛾</ci><ci id="S3.E10X.2.1.1.m1.1.1.1.1.3.3.3.3.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.3.3.3.3">𝐻</ci></apply><ci id="S3.E10X.2.1.1.m1.1.1.1.1.3.3.4.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.3.3.4">italic-ϕ</ci><apply id="S3.E10X.2.1.1.m1.1.1.1.1.3.3.1.1.1.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.3.3.1.1"><csymbol cd="ambiguous" id="S3.E10X.2.1.1.m1.1.1.1.1.3.3.1.1.1.1.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.3.3.1.1">subscript</csymbol><ci id="S3.E10X.2.1.1.m1.1.1.1.1.3.3.1.1.1.2.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.3.3.1.1.1.2">𝒙</ci><apply id="S3.E10X.2.1.1.m1.1.1.1.1.3.3.1.1.1.3.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.3.3.1.1.1.3"><plus id="S3.E10X.2.1.1.m1.1.1.1.1.3.3.1.1.1.3.1.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.3.3.1.1.1.3.1"></plus><ci id="S3.E10X.2.1.1.m1.1.1.1.1.3.3.1.1.1.3.2.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.3.3.1.1.1.3.2">𝑘</ci><ci id="S3.E10X.2.1.1.m1.1.1.1.1.3.3.1.1.1.3.3.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.3.3.1.1.1.3.3">𝐻</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10X.2.1.1.m1.1c">\displaystyle\boldsymbol{U}_{k}^{*}=\mathop{\rm argmin}\limits_{\boldsymbol{U}%
_{k}}\sum_{t=k}^{k+H-1}\gamma^{t}c(\boldsymbol{x}_{t},\boldsymbol{u}_{t})+%
\gamma^{H}\phi(\boldsymbol{x}_{k+H}),</annotation><annotation encoding="application/x-llamapun" id="S3.E10X.2.1.1.m1.1d">bold_italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = roman_argmin start_POSTSUBSCRIPT bold_italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_t = italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k + italic_H - 1 end_POSTSUPERSCRIPT italic_γ start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT italic_c ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , bold_italic_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) + italic_γ start_POSTSUPERSCRIPT italic_H end_POSTSUPERSCRIPT italic_ϕ ( bold_italic_x start_POSTSUBSCRIPT italic_k + italic_H end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(10)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E10Xa">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\text{s.t.}\quad\boldsymbol{x}_{t+1}=\boldsymbol{f}(\boldsymbol{x%
}_{t},\boldsymbol{u}_{t})." class="ltx_Math" display="inline" id="S3.E10Xa.2.1.1.m1.2"><semantics id="S3.E10Xa.2.1.1.m1.2a"><mrow id="S3.E10Xa.2.1.1.m1.2.2.1" xref="S3.E10Xa.2.1.1.m1.2.2.1.1.cmml"><mrow id="S3.E10Xa.2.1.1.m1.2.2.1.1" xref="S3.E10Xa.2.1.1.m1.2.2.1.1.cmml"><mrow id="S3.E10Xa.2.1.1.m1.2.2.1.1.1.1" xref="S3.E10Xa.2.1.1.m1.2.2.1.1.1.2.cmml"><mtext id="S3.E10Xa.2.1.1.m1.1.1" xref="S3.E10Xa.2.1.1.m1.1.1a.cmml">s.t.</mtext><mspace id="S3.E10Xa.2.1.1.m1.2.2.1.1.1.1.2" width="1em" xref="S3.E10Xa.2.1.1.m1.2.2.1.1.1.2.cmml"></mspace><msub id="S3.E10Xa.2.1.1.m1.2.2.1.1.1.1.1" xref="S3.E10Xa.2.1.1.m1.2.2.1.1.1.1.1.cmml"><mi id="S3.E10Xa.2.1.1.m1.2.2.1.1.1.1.1.2" xref="S3.E10Xa.2.1.1.m1.2.2.1.1.1.1.1.2.cmml">𝒙</mi><mrow id="S3.E10Xa.2.1.1.m1.2.2.1.1.1.1.1.3" xref="S3.E10Xa.2.1.1.m1.2.2.1.1.1.1.1.3.cmml"><mi id="S3.E10Xa.2.1.1.m1.2.2.1.1.1.1.1.3.2" xref="S3.E10Xa.2.1.1.m1.2.2.1.1.1.1.1.3.2.cmml">t</mi><mo id="S3.E10Xa.2.1.1.m1.2.2.1.1.1.1.1.3.1" xref="S3.E10Xa.2.1.1.m1.2.2.1.1.1.1.1.3.1.cmml">+</mo><mn id="S3.E10Xa.2.1.1.m1.2.2.1.1.1.1.1.3.3" xref="S3.E10Xa.2.1.1.m1.2.2.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.E10Xa.2.1.1.m1.2.2.1.1.4" xref="S3.E10Xa.2.1.1.m1.2.2.1.1.4.cmml">=</mo><mrow id="S3.E10Xa.2.1.1.m1.2.2.1.1.3" xref="S3.E10Xa.2.1.1.m1.2.2.1.1.3.cmml"><mi id="S3.E10Xa.2.1.1.m1.2.2.1.1.3.4" xref="S3.E10Xa.2.1.1.m1.2.2.1.1.3.4.cmml">𝒇</mi><mo id="S3.E10Xa.2.1.1.m1.2.2.1.1.3.3" xref="S3.E10Xa.2.1.1.m1.2.2.1.1.3.3.cmml">⁢</mo><mrow id="S3.E10Xa.2.1.1.m1.2.2.1.1.3.2.2" xref="S3.E10Xa.2.1.1.m1.2.2.1.1.3.2.3.cmml"><mo id="S3.E10Xa.2.1.1.m1.2.2.1.1.3.2.2.3" stretchy="false" xref="S3.E10Xa.2.1.1.m1.2.2.1.1.3.2.3.cmml">(</mo><msub id="S3.E10Xa.2.1.1.m1.2.2.1.1.2.1.1.1" xref="S3.E10Xa.2.1.1.m1.2.2.1.1.2.1.1.1.cmml"><mi id="S3.E10Xa.2.1.1.m1.2.2.1.1.2.1.1.1.2" xref="S3.E10Xa.2.1.1.m1.2.2.1.1.2.1.1.1.2.cmml">𝒙</mi><mi id="S3.E10Xa.2.1.1.m1.2.2.1.1.2.1.1.1.3" xref="S3.E10Xa.2.1.1.m1.2.2.1.1.2.1.1.1.3.cmml">t</mi></msub><mo id="S3.E10Xa.2.1.1.m1.2.2.1.1.3.2.2.4" xref="S3.E10Xa.2.1.1.m1.2.2.1.1.3.2.3.cmml">,</mo><msub id="S3.E10Xa.2.1.1.m1.2.2.1.1.3.2.2.2" xref="S3.E10Xa.2.1.1.m1.2.2.1.1.3.2.2.2.cmml"><mi id="S3.E10Xa.2.1.1.m1.2.2.1.1.3.2.2.2.2" xref="S3.E10Xa.2.1.1.m1.2.2.1.1.3.2.2.2.2.cmml">𝒖</mi><mi id="S3.E10Xa.2.1.1.m1.2.2.1.1.3.2.2.2.3" xref="S3.E10Xa.2.1.1.m1.2.2.1.1.3.2.2.2.3.cmml">t</mi></msub><mo id="S3.E10Xa.2.1.1.m1.2.2.1.1.3.2.2.5" stretchy="false" xref="S3.E10Xa.2.1.1.m1.2.2.1.1.3.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E10Xa.2.1.1.m1.2.2.1.2" lspace="0em" xref="S3.E10Xa.2.1.1.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E10Xa.2.1.1.m1.2b"><apply id="S3.E10Xa.2.1.1.m1.2.2.1.1.cmml" xref="S3.E10Xa.2.1.1.m1.2.2.1"><eq id="S3.E10Xa.2.1.1.m1.2.2.1.1.4.cmml" xref="S3.E10Xa.2.1.1.m1.2.2.1.1.4"></eq><list id="S3.E10Xa.2.1.1.m1.2.2.1.1.1.2.cmml" xref="S3.E10Xa.2.1.1.m1.2.2.1.1.1.1"><ci id="S3.E10Xa.2.1.1.m1.1.1a.cmml" xref="S3.E10Xa.2.1.1.m1.1.1"><mtext id="S3.E10Xa.2.1.1.m1.1.1.cmml" xref="S3.E10Xa.2.1.1.m1.1.1">s.t.</mtext></ci><apply id="S3.E10Xa.2.1.1.m1.2.2.1.1.1.1.1.cmml" xref="S3.E10Xa.2.1.1.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10Xa.2.1.1.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E10Xa.2.1.1.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E10Xa.2.1.1.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E10Xa.2.1.1.m1.2.2.1.1.1.1.1.2">𝒙</ci><apply id="S3.E10Xa.2.1.1.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E10Xa.2.1.1.m1.2.2.1.1.1.1.1.3"><plus id="S3.E10Xa.2.1.1.m1.2.2.1.1.1.1.1.3.1.cmml" xref="S3.E10Xa.2.1.1.m1.2.2.1.1.1.1.1.3.1"></plus><ci id="S3.E10Xa.2.1.1.m1.2.2.1.1.1.1.1.3.2.cmml" xref="S3.E10Xa.2.1.1.m1.2.2.1.1.1.1.1.3.2">𝑡</ci><cn id="S3.E10Xa.2.1.1.m1.2.2.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E10Xa.2.1.1.m1.2.2.1.1.1.1.1.3.3">1</cn></apply></apply></list><apply id="S3.E10Xa.2.1.1.m1.2.2.1.1.3.cmml" xref="S3.E10Xa.2.1.1.m1.2.2.1.1.3"><times id="S3.E10Xa.2.1.1.m1.2.2.1.1.3.3.cmml" xref="S3.E10Xa.2.1.1.m1.2.2.1.1.3.3"></times><ci id="S3.E10Xa.2.1.1.m1.2.2.1.1.3.4.cmml" xref="S3.E10Xa.2.1.1.m1.2.2.1.1.3.4">𝒇</ci><interval closure="open" id="S3.E10Xa.2.1.1.m1.2.2.1.1.3.2.3.cmml" xref="S3.E10Xa.2.1.1.m1.2.2.1.1.3.2.2"><apply id="S3.E10Xa.2.1.1.m1.2.2.1.1.2.1.1.1.cmml" xref="S3.E10Xa.2.1.1.m1.2.2.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S3.E10Xa.2.1.1.m1.2.2.1.1.2.1.1.1.1.cmml" xref="S3.E10Xa.2.1.1.m1.2.2.1.1.2.1.1.1">subscript</csymbol><ci id="S3.E10Xa.2.1.1.m1.2.2.1.1.2.1.1.1.2.cmml" xref="S3.E10Xa.2.1.1.m1.2.2.1.1.2.1.1.1.2">𝒙</ci><ci id="S3.E10Xa.2.1.1.m1.2.2.1.1.2.1.1.1.3.cmml" xref="S3.E10Xa.2.1.1.m1.2.2.1.1.2.1.1.1.3">𝑡</ci></apply><apply id="S3.E10Xa.2.1.1.m1.2.2.1.1.3.2.2.2.cmml" xref="S3.E10Xa.2.1.1.m1.2.2.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S3.E10Xa.2.1.1.m1.2.2.1.1.3.2.2.2.1.cmml" xref="S3.E10Xa.2.1.1.m1.2.2.1.1.3.2.2.2">subscript</csymbol><ci id="S3.E10Xa.2.1.1.m1.2.2.1.1.3.2.2.2.2.cmml" xref="S3.E10Xa.2.1.1.m1.2.2.1.1.3.2.2.2.2">𝒖</ci><ci id="S3.E10Xa.2.1.1.m1.2.2.1.1.3.2.2.2.3.cmml" xref="S3.E10Xa.2.1.1.m1.2.2.1.1.3.2.2.2.3">𝑡</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10Xa.2.1.1.m1.2c">\displaystyle\text{s.t.}\quad\boldsymbol{x}_{t+1}=\boldsymbol{f}(\boldsymbol{x%
}_{t},\boldsymbol{u}_{t}).</annotation><annotation encoding="application/x-llamapun" id="S3.E10Xa.2.1.1.m1.2d">s.t. bold_italic_x start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT = bold_italic_f ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , bold_italic_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S3.SS3.p1.17">This representation, incorporating a discount rate, considers future uncertainties and has been verified as an effective formulation <cite class="ltx_cite ltx_citemacro_citep">(Granzotto et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib15" title="">2020</a>)</cite>. Eq.(<a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S3.E10" title="In 3.3 Model Predictive Control (MPC) ‣ 3 Preliminaries ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">10</span></a>) modifies the optimal policy from an infinite to a finite future horizon as presented in Eq.(<a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S3.E2" title="In 3.1 Reinforcement Learning ‣ 3 Preliminaries ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">2</span></a>), with its terminal value analogous to the value function in reinforcement learning. Hence, a better approximation of the terminal value enables MPC to achieve better control outputs <cite class="ltx_cite ltx_citemacro_citep">(Lowrey et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib25" title="">2019</a>; Bhardwaj et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib7" title="">2019</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib6" title="">2021</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.1">To solve Eq.(<a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S3.E9" title="In 3.3 Model Predictive Control (MPC) ‣ 3 Preliminaries ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">9</span></a>), we need to rely on numerical methods. In this study, we use MPPI <cite class="ltx_cite ltx_citemacro_citep">(Williams et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib44" title="">2018</a>)</cite> as the MPC algorithm.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Method</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">Here, we present a hierarchical control approach, structured as shown in Fig.<a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S4.F2" title="Figure 2 ‣ 4 Method ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">2</span></a>. The framework of the proposed method consists of lower and upper layers.</p>
</div>
<figure class="ltx_figure" id="S4.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="496" id="S4.F2.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F2.14.7.1" style="font-size:90%;">Figure 2</span>: </span><span class="ltx_text" id="S4.F2.12.6" style="font-size:90%;">Concrete implementation to control the bipedal inverted pendulum system. Upper layer: During training, it outputs random goal variables. During inference, it generates a sequence of goal variables, <math alttext="\boldsymbol{g}_{0}" class="ltx_Math" display="inline" id="S4.F2.7.1.m1.1"><semantics id="S4.F2.7.1.m1.1b"><msub id="S4.F2.7.1.m1.1.1" xref="S4.F2.7.1.m1.1.1.cmml"><mi id="S4.F2.7.1.m1.1.1.2" xref="S4.F2.7.1.m1.1.1.2.cmml">𝒈</mi><mn id="S4.F2.7.1.m1.1.1.3" xref="S4.F2.7.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S4.F2.7.1.m1.1c"><apply id="S4.F2.7.1.m1.1.1.cmml" xref="S4.F2.7.1.m1.1.1"><csymbol cd="ambiguous" id="S4.F2.7.1.m1.1.1.1.cmml" xref="S4.F2.7.1.m1.1.1">subscript</csymbol><ci id="S4.F2.7.1.m1.1.1.2.cmml" xref="S4.F2.7.1.m1.1.1.2">𝒈</ci><cn id="S4.F2.7.1.m1.1.1.3.cmml" type="integer" xref="S4.F2.7.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.7.1.m1.1d">\boldsymbol{g}_{0}</annotation><annotation encoding="application/x-llamapun" id="S4.F2.7.1.m1.1e">bold_italic_g start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>, of the same length as the prediction horizon, tailored to the robot’s state and reference trajectory (e.g., desired robot position and velocity). Lower layer: learns terminal values corresponding to the goal variables. During inference, it optimizes the predicted trajectory and generates actions in accordance with the commands received from the upper layer, using the learned terminal values. <math alttext="\boldsymbol{x_{t}}" class="ltx_Math" display="inline" id="S4.F2.8.2.m2.1"><semantics id="S4.F2.8.2.m2.1b"><msub id="S4.F2.8.2.m2.1.1" xref="S4.F2.8.2.m2.1.1.cmml"><mi id="S4.F2.8.2.m2.1.1.2" xref="S4.F2.8.2.m2.1.1.2.cmml">𝒙</mi><mi id="S4.F2.8.2.m2.1.1.3" xref="S4.F2.8.2.m2.1.1.3.cmml">𝒕</mi></msub><annotation-xml encoding="MathML-Content" id="S4.F2.8.2.m2.1c"><apply id="S4.F2.8.2.m2.1.1.cmml" xref="S4.F2.8.2.m2.1.1"><csymbol cd="ambiguous" id="S4.F2.8.2.m2.1.1.1.cmml" xref="S4.F2.8.2.m2.1.1">subscript</csymbol><ci id="S4.F2.8.2.m2.1.1.2.cmml" xref="S4.F2.8.2.m2.1.1.2">𝒙</ci><ci id="S4.F2.8.2.m2.1.1.3.cmml" xref="S4.F2.8.2.m2.1.1.3">𝒕</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.8.2.m2.1d">\boldsymbol{x_{t}}</annotation><annotation encoding="application/x-llamapun" id="S4.F2.8.2.m2.1e">bold_italic_x start_POSTSUBSCRIPT bold_italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\boldsymbol{u_{t}}" class="ltx_Math" display="inline" id="S4.F2.9.3.m3.1"><semantics id="S4.F2.9.3.m3.1b"><msub id="S4.F2.9.3.m3.1.1" xref="S4.F2.9.3.m3.1.1.cmml"><mi id="S4.F2.9.3.m3.1.1.2" xref="S4.F2.9.3.m3.1.1.2.cmml">𝒖</mi><mi id="S4.F2.9.3.m3.1.1.3" xref="S4.F2.9.3.m3.1.1.3.cmml">𝒕</mi></msub><annotation-xml encoding="MathML-Content" id="S4.F2.9.3.m3.1c"><apply id="S4.F2.9.3.m3.1.1.cmml" xref="S4.F2.9.3.m3.1.1"><csymbol cd="ambiguous" id="S4.F2.9.3.m3.1.1.1.cmml" xref="S4.F2.9.3.m3.1.1">subscript</csymbol><ci id="S4.F2.9.3.m3.1.1.2.cmml" xref="S4.F2.9.3.m3.1.1.2">𝒖</ci><ci id="S4.F2.9.3.m3.1.1.3.cmml" xref="S4.F2.9.3.m3.1.1.3">𝒕</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.9.3.m3.1d">\boldsymbol{u_{t}}</annotation><annotation encoding="application/x-llamapun" id="S4.F2.9.3.m3.1e">bold_italic_u start_POSTSUBSCRIPT bold_italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="v" class="ltx_Math" display="inline" id="S4.F2.10.4.m4.1"><semantics id="S4.F2.10.4.m4.1b"><mi id="S4.F2.10.4.m4.1.1" xref="S4.F2.10.4.m4.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S4.F2.10.4.m4.1c"><ci id="S4.F2.10.4.m4.1.1.cmml" xref="S4.F2.10.4.m4.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.10.4.m4.1d">v</annotation><annotation encoding="application/x-llamapun" id="S4.F2.10.4.m4.1e">italic_v</annotation></semantics></math>, <math alttext="\omega" class="ltx_Math" display="inline" id="S4.F2.11.5.m5.1"><semantics id="S4.F2.11.5.m5.1b"><mi id="S4.F2.11.5.m5.1.1" xref="S4.F2.11.5.m5.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="S4.F2.11.5.m5.1c"><ci id="S4.F2.11.5.m5.1.1.cmml" xref="S4.F2.11.5.m5.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.11.5.m5.1d">\omega</annotation><annotation encoding="application/x-llamapun" id="S4.F2.11.5.m5.1e">italic_ω</annotation></semantics></math>, and <math alttext="\alpha" class="ltx_Math" display="inline" id="S4.F2.12.6.m6.1"><semantics id="S4.F2.12.6.m6.1b"><mi id="S4.F2.12.6.m6.1.1" xref="S4.F2.12.6.m6.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.F2.12.6.m6.1c"><ci id="S4.F2.12.6.m6.1.1.cmml" xref="S4.F2.12.6.m6.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.12.6.m6.1d">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.F2.12.6.m6.1e">italic_α</annotation></semantics></math> represent the state, control input, robot’s linear velocity, angular velocity, and slope angle, respectively.</span></figcaption>
</figure>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Lower Layer</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.2">The lower layer focuses on learning goal-conditioned terminal values, which are then utilized by MPC to generate control sequences according to given objectives. Recent studies have introduced methods for approximating terminal values from data <cite class="ltx_cite ltx_citemacro_citep">(Lowrey et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib25" title="">2019</a>; Bhardwaj et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib7" title="">2019</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib6" title="">2021</a>)</cite>. However, learning terminal values in MPC tends to specialize in a single task. Therefore, we propose learning goal-conditioned terminal values, <math alttext="\hat{V}_{\theta}(\boldsymbol{x},\boldsymbol{g})" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.2"><semantics id="S4.SS1.p1.1.m1.2a"><mrow id="S4.SS1.p1.1.m1.2.3" xref="S4.SS1.p1.1.m1.2.3.cmml"><msub id="S4.SS1.p1.1.m1.2.3.2" xref="S4.SS1.p1.1.m1.2.3.2.cmml"><mover accent="true" id="S4.SS1.p1.1.m1.2.3.2.2" xref="S4.SS1.p1.1.m1.2.3.2.2.cmml"><mi id="S4.SS1.p1.1.m1.2.3.2.2.2" xref="S4.SS1.p1.1.m1.2.3.2.2.2.cmml">V</mi><mo id="S4.SS1.p1.1.m1.2.3.2.2.1" xref="S4.SS1.p1.1.m1.2.3.2.2.1.cmml">^</mo></mover><mi id="S4.SS1.p1.1.m1.2.3.2.3" xref="S4.SS1.p1.1.m1.2.3.2.3.cmml">θ</mi></msub><mo id="S4.SS1.p1.1.m1.2.3.1" xref="S4.SS1.p1.1.m1.2.3.1.cmml">⁢</mo><mrow id="S4.SS1.p1.1.m1.2.3.3.2" xref="S4.SS1.p1.1.m1.2.3.3.1.cmml"><mo id="S4.SS1.p1.1.m1.2.3.3.2.1" stretchy="false" xref="S4.SS1.p1.1.m1.2.3.3.1.cmml">(</mo><mi id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">𝒙</mi><mo id="S4.SS1.p1.1.m1.2.3.3.2.2" xref="S4.SS1.p1.1.m1.2.3.3.1.cmml">,</mo><mi id="S4.SS1.p1.1.m1.2.2" xref="S4.SS1.p1.1.m1.2.2.cmml">𝒈</mi><mo id="S4.SS1.p1.1.m1.2.3.3.2.3" stretchy="false" xref="S4.SS1.p1.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.2b"><apply id="S4.SS1.p1.1.m1.2.3.cmml" xref="S4.SS1.p1.1.m1.2.3"><times id="S4.SS1.p1.1.m1.2.3.1.cmml" xref="S4.SS1.p1.1.m1.2.3.1"></times><apply id="S4.SS1.p1.1.m1.2.3.2.cmml" xref="S4.SS1.p1.1.m1.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.2.3.2.1.cmml" xref="S4.SS1.p1.1.m1.2.3.2">subscript</csymbol><apply id="S4.SS1.p1.1.m1.2.3.2.2.cmml" xref="S4.SS1.p1.1.m1.2.3.2.2"><ci id="S4.SS1.p1.1.m1.2.3.2.2.1.cmml" xref="S4.SS1.p1.1.m1.2.3.2.2.1">^</ci><ci id="S4.SS1.p1.1.m1.2.3.2.2.2.cmml" xref="S4.SS1.p1.1.m1.2.3.2.2.2">𝑉</ci></apply><ci id="S4.SS1.p1.1.m1.2.3.2.3.cmml" xref="S4.SS1.p1.1.m1.2.3.2.3">𝜃</ci></apply><interval closure="open" id="S4.SS1.p1.1.m1.2.3.3.1.cmml" xref="S4.SS1.p1.1.m1.2.3.3.2"><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">𝒙</ci><ci id="S4.SS1.p1.1.m1.2.2.cmml" xref="S4.SS1.p1.1.m1.2.2">𝒈</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.2c">\hat{V}_{\theta}(\boldsymbol{x},\boldsymbol{g})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.2d">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_italic_x , bold_italic_g )</annotation></semantics></math>, where <math alttext="\boldsymbol{g}" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.1"><semantics id="S4.SS1.p1.2.m2.1a"><mi id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">𝒈</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><ci id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">𝒈</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">\boldsymbol{g}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m2.1d">bold_italic_g</annotation></semantics></math> represents the goal variables.</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S4.E11">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E11X">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle y(\boldsymbol{x},\boldsymbol{g})=" class="ltx_Math" display="inline" id="S4.E11X.2.1.1.m1.2"><semantics id="S4.E11X.2.1.1.m1.2a"><mrow id="S4.E11X.2.1.1.m1.2.3" xref="S4.E11X.2.1.1.m1.2.3.cmml"><mrow id="S4.E11X.2.1.1.m1.2.3.2" xref="S4.E11X.2.1.1.m1.2.3.2.cmml"><mi id="S4.E11X.2.1.1.m1.2.3.2.2" xref="S4.E11X.2.1.1.m1.2.3.2.2.cmml">y</mi><mo id="S4.E11X.2.1.1.m1.2.3.2.1" xref="S4.E11X.2.1.1.m1.2.3.2.1.cmml">⁢</mo><mrow id="S4.E11X.2.1.1.m1.2.3.2.3.2" xref="S4.E11X.2.1.1.m1.2.3.2.3.1.cmml"><mo id="S4.E11X.2.1.1.m1.2.3.2.3.2.1" stretchy="false" xref="S4.E11X.2.1.1.m1.2.3.2.3.1.cmml">(</mo><mi id="S4.E11X.2.1.1.m1.1.1" xref="S4.E11X.2.1.1.m1.1.1.cmml">𝒙</mi><mo id="S4.E11X.2.1.1.m1.2.3.2.3.2.2" xref="S4.E11X.2.1.1.m1.2.3.2.3.1.cmml">,</mo><mi id="S4.E11X.2.1.1.m1.2.2" xref="S4.E11X.2.1.1.m1.2.2.cmml">𝒈</mi><mo id="S4.E11X.2.1.1.m1.2.3.2.3.2.3" stretchy="false" xref="S4.E11X.2.1.1.m1.2.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E11X.2.1.1.m1.2.3.1" xref="S4.E11X.2.1.1.m1.2.3.1.cmml">=</mo><mi id="S4.E11X.2.1.1.m1.2.3.3" xref="S4.E11X.2.1.1.m1.2.3.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.E11X.2.1.1.m1.2b"><apply id="S4.E11X.2.1.1.m1.2.3.cmml" xref="S4.E11X.2.1.1.m1.2.3"><eq id="S4.E11X.2.1.1.m1.2.3.1.cmml" xref="S4.E11X.2.1.1.m1.2.3.1"></eq><apply id="S4.E11X.2.1.1.m1.2.3.2.cmml" xref="S4.E11X.2.1.1.m1.2.3.2"><times id="S4.E11X.2.1.1.m1.2.3.2.1.cmml" xref="S4.E11X.2.1.1.m1.2.3.2.1"></times><ci id="S4.E11X.2.1.1.m1.2.3.2.2.cmml" xref="S4.E11X.2.1.1.m1.2.3.2.2">𝑦</ci><interval closure="open" id="S4.E11X.2.1.1.m1.2.3.2.3.1.cmml" xref="S4.E11X.2.1.1.m1.2.3.2.3.2"><ci id="S4.E11X.2.1.1.m1.1.1.cmml" xref="S4.E11X.2.1.1.m1.1.1">𝒙</ci><ci id="S4.E11X.2.1.1.m1.2.2.cmml" xref="S4.E11X.2.1.1.m1.2.2">𝒈</ci></interval></apply><csymbol cd="latexml" id="S4.E11X.2.1.1.m1.2.3.3.cmml" xref="S4.E11X.2.1.1.m1.2.3.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E11X.2.1.1.m1.2c">\displaystyle y(\boldsymbol{x},\boldsymbol{g})=</annotation><annotation encoding="application/x-llamapun" id="S4.E11X.2.1.1.m1.2d">italic_y ( bold_italic_x , bold_italic_g ) =</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(11)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E11Xa">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\min_{\boldsymbol{u}_{0:H-1}}\mathbb{E}\left[\sum_{t=0}^{H-1}%
\gamma^{t}c(\boldsymbol{x}_{t},\boldsymbol{u}_{t},\boldsymbol{g}_{t})+\gamma^{%
H}\hat{V}_{\boldsymbol{\theta}}(\boldsymbol{x}_{H},\boldsymbol{g}_{H})|%
\boldsymbol{x}_{0}=\boldsymbol{x}\right]." class="ltx_Math" display="inline" id="S4.E11Xa.2.1.1.m1.1"><semantics id="S4.E11Xa.2.1.1.m1.1a"><mrow id="S4.E11Xa.2.1.1.m1.1.1.1" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.cmml"><mrow id="S4.E11Xa.2.1.1.m1.1.1.1.1" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.cmml"><mrow id="S4.E11Xa.2.1.1.m1.1.1.1.1.3" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.3.cmml"><munder id="S4.E11Xa.2.1.1.m1.1.1.1.1.3.1" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.3.1.cmml"><mi id="S4.E11Xa.2.1.1.m1.1.1.1.1.3.1.2" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.3.1.2.cmml">min</mi><msub id="S4.E11Xa.2.1.1.m1.1.1.1.1.3.1.3" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.3.1.3.cmml"><mi id="S4.E11Xa.2.1.1.m1.1.1.1.1.3.1.3.2" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.3.1.3.2.cmml">𝒖</mi><mrow id="S4.E11Xa.2.1.1.m1.1.1.1.1.3.1.3.3" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.3.1.3.3.cmml"><mn id="S4.E11Xa.2.1.1.m1.1.1.1.1.3.1.3.3.2" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.3.1.3.3.2.cmml">0</mn><mo id="S4.E11Xa.2.1.1.m1.1.1.1.1.3.1.3.3.1" lspace="0.278em" rspace="0.278em" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.3.1.3.3.1.cmml">:</mo><mrow id="S4.E11Xa.2.1.1.m1.1.1.1.1.3.1.3.3.3" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.3.1.3.3.3.cmml"><mi id="S4.E11Xa.2.1.1.m1.1.1.1.1.3.1.3.3.3.2" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.3.1.3.3.3.2.cmml">H</mi><mo id="S4.E11Xa.2.1.1.m1.1.1.1.1.3.1.3.3.3.1" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.3.1.3.3.3.1.cmml">−</mo><mn id="S4.E11Xa.2.1.1.m1.1.1.1.1.3.1.3.3.3.3" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.3.1.3.3.3.3.cmml">1</mn></mrow></mrow></msub></munder><mo id="S4.E11Xa.2.1.1.m1.1.1.1.1.3a" lspace="0.167em" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.3.cmml">⁡</mo><mi id="S4.E11Xa.2.1.1.m1.1.1.1.1.3.2" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.3.2.cmml">𝔼</mi></mrow><mo id="S4.E11Xa.2.1.1.m1.1.1.1.1.2" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.2.cmml"><mo id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.2" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.cmml"><mrow id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.cmml"><mstyle displaystyle="true" id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.4" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.4.cmml"><munderover id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.4a" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.4.cmml"><mo id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.4.2.2" movablelimits="false" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.4.2.2.cmml">∑</mo><mrow id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.4.2.3" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.4.2.3.cmml"><mi id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.4.2.3.2" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.4.2.3.2.cmml">t</mi><mo id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.4.2.3.1" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.4.2.3.1.cmml">=</mo><mn id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.4.2.3.3" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.4.2.3.3.cmml">0</mn></mrow><mrow id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.4.3" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.4.3.cmml"><mi id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.4.3.2" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.4.3.2.cmml">H</mi><mo id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.4.3.1" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.4.3.1.cmml">−</mo><mn id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.4.3.3" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.4.3.3.cmml">1</mn></mrow></munderover></mstyle><mrow id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.cmml"><msup id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.5" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.5.cmml"><mi id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.5.2" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.5.2.cmml">γ</mi><mi id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.5.3" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.5.3.cmml">t</mi></msup><mo id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.4" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.4.cmml">⁢</mo><mi id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.6" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.6.cmml">c</mi><mo id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.4a" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.4.cmml">⁢</mo><mrow id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.4.cmml"><mo id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.4" stretchy="false" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.4.cmml">(</mo><msub id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mi id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.5" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.4.cmml">,</mo><msub id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.2.2.2.2" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.2.2.2.2.cmml"><mi id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.2.2.2.2.2" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.2.2.2.2.2.cmml">𝒖</mi><mi id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.2.2.2.2.3" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.6" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.4.cmml">,</mo><msub id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.3" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.3.cmml"><mi id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.3.2" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.3.2.cmml">𝒈</mi><mi id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.3.3" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.3.3.cmml">t</mi></msub><mo id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.7" stretchy="false" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.4.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.6" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.6.cmml">+</mo><mrow id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.cmml"><mrow id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.cmml"><msup id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.4" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.4.cmml"><mi id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.4.2" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.4.2.cmml">γ</mi><mi id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.4.3" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.4.3.cmml">H</mi></msup><mo id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.3" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.3.cmml">⁢</mo><msub id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.5" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.5.cmml"><mover accent="true" id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.5.2" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.5.2.cmml"><mi id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.5.2.2" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.5.2.2.cmml">V</mi><mo id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.5.2.1" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.5.2.1.cmml">^</mo></mover><mi id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.5.3" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.5.3.cmml">𝜽</mi></msub><mo id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.3a" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.3.cmml">⁢</mo><mrow id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.2.2" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.2.3.cmml"><mo id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.2.2.3" stretchy="false" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.2.3.cmml">(</mo><msub id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.4.4.1.1.1.1" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.4.4.1.1.1.1.cmml"><mi id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.4.4.1.1.1.1.2" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.4.4.1.1.1.1.2.cmml">𝒙</mi><mi id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.4.4.1.1.1.1.3" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.4.4.1.1.1.1.3.cmml">H</mi></msub><mo id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.2.2.4" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.2.3.cmml">,</mo><msub id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.2.2.2" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.2.2.2.cmml"><mi id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.2.2.2.2" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.2.2.2.2.cmml">𝒈</mi><mi id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.2.2.2.3" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.2.2.2.3.cmml">H</mi></msub><mo id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.2.2.5" stretchy="false" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.2.3.cmml">)</mo></mrow></mrow><mo fence="false" id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.3" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.3.cmml">|</mo><msub id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.4" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.4.cmml"><mi id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.4.2" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.4.2.cmml">𝒙</mi><mn id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.4.3" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.4.3.cmml">0</mn></msub></mrow></mrow><mo id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.6" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.6.cmml">=</mo><mi id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.7" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.7.cmml">𝒙</mi></mrow><mo id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.3" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S4.E11Xa.2.1.1.m1.1.1.1.2" lspace="0em" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E11Xa.2.1.1.m1.1b"><apply id="S4.E11Xa.2.1.1.m1.1.1.1.1.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1"><times id="S4.E11Xa.2.1.1.m1.1.1.1.1.2.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.2"></times><apply id="S4.E11Xa.2.1.1.m1.1.1.1.1.3.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.3"><apply id="S4.E11Xa.2.1.1.m1.1.1.1.1.3.1.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S4.E11Xa.2.1.1.m1.1.1.1.1.3.1.1.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.3.1">subscript</csymbol><min id="S4.E11Xa.2.1.1.m1.1.1.1.1.3.1.2.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.3.1.2"></min><apply id="S4.E11Xa.2.1.1.m1.1.1.1.1.3.1.3.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.3.1.3"><csymbol cd="ambiguous" id="S4.E11Xa.2.1.1.m1.1.1.1.1.3.1.3.1.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.3.1.3">subscript</csymbol><ci id="S4.E11Xa.2.1.1.m1.1.1.1.1.3.1.3.2.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.3.1.3.2">𝒖</ci><apply id="S4.E11Xa.2.1.1.m1.1.1.1.1.3.1.3.3.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.3.1.3.3"><ci id="S4.E11Xa.2.1.1.m1.1.1.1.1.3.1.3.3.1.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.3.1.3.3.1">:</ci><cn id="S4.E11Xa.2.1.1.m1.1.1.1.1.3.1.3.3.2.cmml" type="integer" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.3.1.3.3.2">0</cn><apply id="S4.E11Xa.2.1.1.m1.1.1.1.1.3.1.3.3.3.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.3.1.3.3.3"><minus id="S4.E11Xa.2.1.1.m1.1.1.1.1.3.1.3.3.3.1.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.3.1.3.3.3.1"></minus><ci id="S4.E11Xa.2.1.1.m1.1.1.1.1.3.1.3.3.3.2.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.3.1.3.3.3.2">𝐻</ci><cn id="S4.E11Xa.2.1.1.m1.1.1.1.1.3.1.3.3.3.3.cmml" type="integer" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.3.1.3.3.3.3">1</cn></apply></apply></apply></apply><ci id="S4.E11Xa.2.1.1.m1.1.1.1.1.3.2.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.3.2">𝔼</ci></apply><apply id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.2.1.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1"><eq id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.6.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.6"></eq><apply id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5"><plus id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.6.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.6"></plus><apply id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3"><apply id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.4.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.4"><csymbol cd="ambiguous" id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.4.1.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.4">superscript</csymbol><apply id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.4.2.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.4"><csymbol cd="ambiguous" id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.4.2.1.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.4">subscript</csymbol><sum id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.4.2.2.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.4.2.2"></sum><apply id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.4.2.3.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.4.2.3"><eq id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.4.2.3.1.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.4.2.3.1"></eq><ci id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.4.2.3.2.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.4.2.3.2">𝑡</ci><cn id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.4.2.3.3.cmml" type="integer" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.4.2.3.3">0</cn></apply></apply><apply id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.4.3.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.4.3"><minus id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.4.3.1.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.4.3.1"></minus><ci id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.4.3.2.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.4.3.2">𝐻</ci><cn id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.4.3.3.cmml" type="integer" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.4.3.3">1</cn></apply></apply><apply id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3"><times id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.4.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.4"></times><apply id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.5.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.5"><csymbol cd="ambiguous" id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.5.1.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.5">superscript</csymbol><ci id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.5.2.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.5.2">𝛾</ci><ci id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.5.3.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.5.3">𝑡</ci></apply><ci id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.6.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.6">𝑐</ci><vector id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.4.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3"><apply id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝒙</ci><ci id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.2.2.2.2.1.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.2.2.2.2.2">𝒖</ci><ci id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.2.2.2.2.3.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.2.2.2.2.3">𝑡</ci></apply><apply id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.3.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.3.1.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.3">subscript</csymbol><ci id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.3.2.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.3.2">𝒈</ci><ci id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.3.3.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.3.3">𝑡</ci></apply></vector></apply></apply><apply id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5"><csymbol cd="latexml" id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.3.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.3">conditional</csymbol><apply id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2"><times id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.3.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.3"></times><apply id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.4.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.4"><csymbol cd="ambiguous" id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.4.1.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.4">superscript</csymbol><ci id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.4.2.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.4.2">𝛾</ci><ci id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.4.3.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.4.3">𝐻</ci></apply><apply id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.5.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.5"><csymbol cd="ambiguous" id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.5.1.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.5">subscript</csymbol><apply id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.5.2.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.5.2"><ci id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.5.2.1.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.5.2.1">^</ci><ci id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.5.2.2.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.5.2.2">𝑉</ci></apply><ci id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.5.3.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.5.3">𝜽</ci></apply><interval closure="open" id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.2.3.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.2.2"><apply id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.4.4.1.1.1.1.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.4.4.1.1.1.1.1.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.4.4.1.1.1.1">subscript</csymbol><ci id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.4.4.1.1.1.1.2.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.4.4.1.1.1.1.2">𝒙</ci><ci id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.4.4.1.1.1.1.3.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.4.4.1.1.1.1.3">𝐻</ci></apply><apply id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.2.2.2.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.2.2.2"><csymbol cd="ambiguous" id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.2.2.2.1.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.2.2.2">subscript</csymbol><ci id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.2.2.2.2.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.2.2.2.2">𝒈</ci><ci id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.2.2.2.3.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.2.2.2.2.3">𝐻</ci></apply></interval></apply><apply id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.4.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.4"><csymbol cd="ambiguous" id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.4.1.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.4">subscript</csymbol><ci id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.4.2.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.4.2">𝒙</ci><cn id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.4.3.cmml" type="integer" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.5.5.4.3">0</cn></apply></apply></apply><ci id="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.7.cmml" xref="S4.E11Xa.2.1.1.m1.1.1.1.1.1.1.1.7">𝒙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E11Xa.2.1.1.m1.1c">\displaystyle\min_{\boldsymbol{u}_{0:H-1}}\mathbb{E}\left[\sum_{t=0}^{H-1}%
\gamma^{t}c(\boldsymbol{x}_{t},\boldsymbol{u}_{t},\boldsymbol{g}_{t})+\gamma^{%
H}\hat{V}_{\boldsymbol{\theta}}(\boldsymbol{x}_{H},\boldsymbol{g}_{H})|%
\boldsymbol{x}_{0}=\boldsymbol{x}\right].</annotation><annotation encoding="application/x-llamapun" id="S4.E11Xa.2.1.1.m1.1d">roman_min start_POSTSUBSCRIPT bold_italic_u start_POSTSUBSCRIPT 0 : italic_H - 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT blackboard_E [ ∑ start_POSTSUBSCRIPT italic_t = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_H - 1 end_POSTSUPERSCRIPT italic_γ start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT italic_c ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , bold_italic_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) + italic_γ start_POSTSUPERSCRIPT italic_H end_POSTSUPERSCRIPT over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUBSCRIPT italic_H end_POSTSUBSCRIPT , bold_italic_g start_POSTSUBSCRIPT italic_H end_POSTSUBSCRIPT ) | bold_italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = bold_italic_x ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
</tr>
</tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S4.E12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\boldsymbol{\theta}\leftarrow\mathop{\rm argmin}\limits_{\boldsymbol{\theta}}%
\mathbb{E}_{\boldsymbol{x},\boldsymbol{g}\sim\nu}\left[\left(\hat{V}_{%
\boldsymbol{\theta}}(\boldsymbol{x},\boldsymbol{g})-y(\boldsymbol{x},%
\boldsymbol{g})\right)^{2}\right]." class="ltx_Math" display="block" id="S4.E12.m1.7"><semantics id="S4.E12.m1.7a"><mrow id="S4.E12.m1.7.7.1" xref="S4.E12.m1.7.7.1.1.cmml"><mrow id="S4.E12.m1.7.7.1.1" xref="S4.E12.m1.7.7.1.1.cmml"><mi id="S4.E12.m1.7.7.1.1.3" xref="S4.E12.m1.7.7.1.1.3.cmml">𝜽</mi><mo id="S4.E12.m1.7.7.1.1.2" rspace="0.1389em" stretchy="false" xref="S4.E12.m1.7.7.1.1.2.cmml">←</mo><mrow id="S4.E12.m1.7.7.1.1.1" xref="S4.E12.m1.7.7.1.1.1.cmml"><munder id="S4.E12.m1.7.7.1.1.1.2" xref="S4.E12.m1.7.7.1.1.1.2.cmml"><mo id="S4.E12.m1.7.7.1.1.1.2.2" lspace="0.1389em" movablelimits="false" rspace="0.167em" xref="S4.E12.m1.7.7.1.1.1.2.2.cmml">argmin</mo><mi id="S4.E12.m1.7.7.1.1.1.2.3" xref="S4.E12.m1.7.7.1.1.1.2.3.cmml">𝜽</mi></munder><mrow id="S4.E12.m1.7.7.1.1.1.1" xref="S4.E12.m1.7.7.1.1.1.1.cmml"><msub id="S4.E12.m1.7.7.1.1.1.1.3" xref="S4.E12.m1.7.7.1.1.1.1.3.cmml"><mi id="S4.E12.m1.7.7.1.1.1.1.3.2" xref="S4.E12.m1.7.7.1.1.1.1.3.2.cmml">𝔼</mi><mrow id="S4.E12.m1.2.2.2" xref="S4.E12.m1.2.2.2.cmml"><mrow id="S4.E12.m1.2.2.2.4.2" xref="S4.E12.m1.2.2.2.4.1.cmml"><mi id="S4.E12.m1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.cmml">𝒙</mi><mo id="S4.E12.m1.2.2.2.4.2.1" xref="S4.E12.m1.2.2.2.4.1.cmml">,</mo><mi id="S4.E12.m1.2.2.2.2" xref="S4.E12.m1.2.2.2.2.cmml">𝒈</mi></mrow><mo id="S4.E12.m1.2.2.2.3" xref="S4.E12.m1.2.2.2.3.cmml">∼</mo><mi id="S4.E12.m1.2.2.2.5" xref="S4.E12.m1.2.2.2.5.cmml">ν</mi></mrow></msub><mo id="S4.E12.m1.7.7.1.1.1.1.2" xref="S4.E12.m1.7.7.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E12.m1.7.7.1.1.1.1.1.1" xref="S4.E12.m1.7.7.1.1.1.1.1.2.cmml"><mo id="S4.E12.m1.7.7.1.1.1.1.1.1.2" xref="S4.E12.m1.7.7.1.1.1.1.1.2.1.cmml">[</mo><msup id="S4.E12.m1.7.7.1.1.1.1.1.1.1" xref="S4.E12.m1.7.7.1.1.1.1.1.1.1.cmml"><mrow id="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1" xref="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.2" xref="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1" xref="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.cmml"><msub id="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mover accent="true" id="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">V</mi><mo id="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.2.1" xref="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml">^</mo></mover><mi id="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">𝜽</mi></msub><mo id="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.1" xref="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml"><mo id="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.3.2.1" stretchy="false" xref="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">(</mo><mi id="S4.E12.m1.3.3" xref="S4.E12.m1.3.3.cmml">𝒙</mi><mo id="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.3.2.2" xref="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">,</mo><mi id="S4.E12.m1.4.4" xref="S4.E12.m1.4.4.cmml">𝒈</mi><mo id="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.3.2.3" stretchy="false" xref="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.cmml">y</mi><mo id="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.1" xref="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml"><mo id="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.3.2.1" stretchy="false" xref="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">(</mo><mi id="S4.E12.m1.5.5" xref="S4.E12.m1.5.5.cmml">𝒙</mi><mo id="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.3.2.2" xref="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">,</mo><mi id="S4.E12.m1.6.6" xref="S4.E12.m1.6.6.cmml">𝒈</mi><mo id="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.3.2.3" stretchy="false" xref="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.3" xref="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S4.E12.m1.7.7.1.1.1.1.1.1.1.3" xref="S4.E12.m1.7.7.1.1.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S4.E12.m1.7.7.1.1.1.1.1.1.3" xref="S4.E12.m1.7.7.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo id="S4.E12.m1.7.7.1.2" lspace="0em" xref="S4.E12.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E12.m1.7b"><apply id="S4.E12.m1.7.7.1.1.cmml" xref="S4.E12.m1.7.7.1"><ci id="S4.E12.m1.7.7.1.1.2.cmml" xref="S4.E12.m1.7.7.1.1.2">←</ci><ci id="S4.E12.m1.7.7.1.1.3.cmml" xref="S4.E12.m1.7.7.1.1.3">𝜽</ci><apply id="S4.E12.m1.7.7.1.1.1.cmml" xref="S4.E12.m1.7.7.1.1.1"><apply id="S4.E12.m1.7.7.1.1.1.2.cmml" xref="S4.E12.m1.7.7.1.1.1.2"><csymbol cd="ambiguous" id="S4.E12.m1.7.7.1.1.1.2.1.cmml" xref="S4.E12.m1.7.7.1.1.1.2">subscript</csymbol><ci id="S4.E12.m1.7.7.1.1.1.2.2.cmml" xref="S4.E12.m1.7.7.1.1.1.2.2">argmin</ci><ci id="S4.E12.m1.7.7.1.1.1.2.3.cmml" xref="S4.E12.m1.7.7.1.1.1.2.3">𝜽</ci></apply><apply id="S4.E12.m1.7.7.1.1.1.1.cmml" xref="S4.E12.m1.7.7.1.1.1.1"><times id="S4.E12.m1.7.7.1.1.1.1.2.cmml" xref="S4.E12.m1.7.7.1.1.1.1.2"></times><apply id="S4.E12.m1.7.7.1.1.1.1.3.cmml" xref="S4.E12.m1.7.7.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E12.m1.7.7.1.1.1.1.3.1.cmml" xref="S4.E12.m1.7.7.1.1.1.1.3">subscript</csymbol><ci id="S4.E12.m1.7.7.1.1.1.1.3.2.cmml" xref="S4.E12.m1.7.7.1.1.1.1.3.2">𝔼</ci><apply id="S4.E12.m1.2.2.2.cmml" xref="S4.E12.m1.2.2.2"><csymbol cd="latexml" id="S4.E12.m1.2.2.2.3.cmml" xref="S4.E12.m1.2.2.2.3">similar-to</csymbol><list id="S4.E12.m1.2.2.2.4.1.cmml" xref="S4.E12.m1.2.2.2.4.2"><ci id="S4.E12.m1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1.1">𝒙</ci><ci id="S4.E12.m1.2.2.2.2.cmml" xref="S4.E12.m1.2.2.2.2">𝒈</ci></list><ci id="S4.E12.m1.2.2.2.5.cmml" xref="S4.E12.m1.2.2.2.5">𝜈</ci></apply></apply><apply id="S4.E12.m1.7.7.1.1.1.1.1.2.cmml" xref="S4.E12.m1.7.7.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E12.m1.7.7.1.1.1.1.1.2.1.cmml" xref="S4.E12.m1.7.7.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.E12.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.7.7.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E12.m1.7.7.1.1.1.1.1.1.1.2.cmml" xref="S4.E12.m1.7.7.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1"><minus id="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.2"><times id="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.1"></times><apply id="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><apply id="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.2"><ci id="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.2.1">^</ci><ci id="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.2.2">𝑉</ci></apply><ci id="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.3">𝜽</ci></apply><interval closure="open" id="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.3.2"><ci id="S4.E12.m1.3.3.cmml" xref="S4.E12.m1.3.3">𝒙</ci><ci id="S4.E12.m1.4.4.cmml" xref="S4.E12.m1.4.4">𝒈</ci></interval></apply><apply id="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.3"><times id="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2">𝑦</ci><interval closure="open" id="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E12.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.3.2"><ci id="S4.E12.m1.5.5.cmml" xref="S4.E12.m1.5.5">𝒙</ci><ci id="S4.E12.m1.6.6.cmml" xref="S4.E12.m1.6.6">𝒈</ci></interval></apply></apply><cn id="S4.E12.m1.7.7.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.E12.m1.7.7.1.1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E12.m1.7c">\boldsymbol{\theta}\leftarrow\mathop{\rm argmin}\limits_{\boldsymbol{\theta}}%
\mathbb{E}_{\boldsymbol{x},\boldsymbol{g}\sim\nu}\left[\left(\hat{V}_{%
\boldsymbol{\theta}}(\boldsymbol{x},\boldsymbol{g})-y(\boldsymbol{x},%
\boldsymbol{g})\right)^{2}\right].</annotation><annotation encoding="application/x-llamapun" id="S4.E12.m1.7d">bold_italic_θ ← roman_argmin start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT blackboard_E start_POSTSUBSCRIPT bold_italic_x , bold_italic_g ∼ italic_ν end_POSTSUBSCRIPT [ ( over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( bold_italic_x , bold_italic_g ) - italic_y ( bold_italic_x , bold_italic_g ) ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p1.5">Here, <math alttext="y(\boldsymbol{x},\boldsymbol{g})" class="ltx_Math" display="inline" id="S4.SS1.p1.3.m1.2"><semantics id="S4.SS1.p1.3.m1.2a"><mrow id="S4.SS1.p1.3.m1.2.3" xref="S4.SS1.p1.3.m1.2.3.cmml"><mi id="S4.SS1.p1.3.m1.2.3.2" xref="S4.SS1.p1.3.m1.2.3.2.cmml">y</mi><mo id="S4.SS1.p1.3.m1.2.3.1" xref="S4.SS1.p1.3.m1.2.3.1.cmml">⁢</mo><mrow id="S4.SS1.p1.3.m1.2.3.3.2" xref="S4.SS1.p1.3.m1.2.3.3.1.cmml"><mo id="S4.SS1.p1.3.m1.2.3.3.2.1" stretchy="false" xref="S4.SS1.p1.3.m1.2.3.3.1.cmml">(</mo><mi id="S4.SS1.p1.3.m1.1.1" xref="S4.SS1.p1.3.m1.1.1.cmml">𝒙</mi><mo id="S4.SS1.p1.3.m1.2.3.3.2.2" xref="S4.SS1.p1.3.m1.2.3.3.1.cmml">,</mo><mi id="S4.SS1.p1.3.m1.2.2" xref="S4.SS1.p1.3.m1.2.2.cmml">𝒈</mi><mo id="S4.SS1.p1.3.m1.2.3.3.2.3" stretchy="false" xref="S4.SS1.p1.3.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m1.2b"><apply id="S4.SS1.p1.3.m1.2.3.cmml" xref="S4.SS1.p1.3.m1.2.3"><times id="S4.SS1.p1.3.m1.2.3.1.cmml" xref="S4.SS1.p1.3.m1.2.3.1"></times><ci id="S4.SS1.p1.3.m1.2.3.2.cmml" xref="S4.SS1.p1.3.m1.2.3.2">𝑦</ci><interval closure="open" id="S4.SS1.p1.3.m1.2.3.3.1.cmml" xref="S4.SS1.p1.3.m1.2.3.3.2"><ci id="S4.SS1.p1.3.m1.1.1.cmml" xref="S4.SS1.p1.3.m1.1.1">𝒙</ci><ci id="S4.SS1.p1.3.m1.2.2.cmml" xref="S4.SS1.p1.3.m1.2.2">𝒈</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m1.2c">y(\boldsymbol{x},\boldsymbol{g})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.3.m1.2d">italic_y ( bold_italic_x , bold_italic_g )</annotation></semantics></math> represents the target value for the terminal values at state <math alttext="\boldsymbol{x}" class="ltx_Math" display="inline" id="S4.SS1.p1.4.m2.1"><semantics id="S4.SS1.p1.4.m2.1a"><mi id="S4.SS1.p1.4.m2.1.1" xref="S4.SS1.p1.4.m2.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m2.1b"><ci id="S4.SS1.p1.4.m2.1.1.cmml" xref="S4.SS1.p1.4.m2.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m2.1c">\boldsymbol{x}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.4.m2.1d">bold_italic_x</annotation></semantics></math> and the goal variable <math alttext="\boldsymbol{g}" class="ltx_Math" display="inline" id="S4.SS1.p1.5.m3.1"><semantics id="S4.SS1.p1.5.m3.1a"><mi id="S4.SS1.p1.5.m3.1.1" xref="S4.SS1.p1.5.m3.1.1.cmml">𝒈</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m3.1b"><ci id="S4.SS1.p1.5.m3.1.1.cmml" xref="S4.SS1.p1.5.m3.1.1">𝒈</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m3.1c">\boldsymbol{g}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.5.m3.1d">bold_italic_g</annotation></semantics></math>. This process utilizes the concept of Goal-Conditioned Reinforcement Learning (GCRL) <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib24" title="">2022</a>)</cite>, where a single cost or reward function is typically defined for each task, leading to learned values that are specialized for the specific goal. Therefore, by setting goal variables separately from the state, as shown in Eq.(<a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S4.E13" title="In 4.1 Lower Layer ‣ 4 Method ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">13</span></a>), it is possible to train agents capable of achieving a variety of tasks, a process referred to as GCRL.</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\pi^{*}=\mathop{\rm argmin}\limits_{\pi}\mathbb{E}_{\pi}\left[\sum_{t=0}^{%
\infty}\gamma^{t}c(\boldsymbol{x}_{t},\boldsymbol{u}_{t},\boldsymbol{g})|%
\boldsymbol{x}_{0}=\boldsymbol{x}\right]." class="ltx_Math" display="block" id="S4.E13.m1.2"><semantics id="S4.E13.m1.2a"><mrow id="S4.E13.m1.2.2.1" xref="S4.E13.m1.2.2.1.1.cmml"><mrow id="S4.E13.m1.2.2.1.1" xref="S4.E13.m1.2.2.1.1.cmml"><msup id="S4.E13.m1.2.2.1.1.3" xref="S4.E13.m1.2.2.1.1.3.cmml"><mi id="S4.E13.m1.2.2.1.1.3.2" xref="S4.E13.m1.2.2.1.1.3.2.cmml">π</mi><mo id="S4.E13.m1.2.2.1.1.3.3" xref="S4.E13.m1.2.2.1.1.3.3.cmml">∗</mo></msup><mo id="S4.E13.m1.2.2.1.1.2" rspace="0.1389em" xref="S4.E13.m1.2.2.1.1.2.cmml">=</mo><mrow id="S4.E13.m1.2.2.1.1.1" xref="S4.E13.m1.2.2.1.1.1.cmml"><munder id="S4.E13.m1.2.2.1.1.1.2" xref="S4.E13.m1.2.2.1.1.1.2.cmml"><mo id="S4.E13.m1.2.2.1.1.1.2.2" lspace="0.1389em" movablelimits="false" rspace="0.167em" xref="S4.E13.m1.2.2.1.1.1.2.2.cmml">argmin</mo><mi id="S4.E13.m1.2.2.1.1.1.2.3" xref="S4.E13.m1.2.2.1.1.1.2.3.cmml">π</mi></munder><mrow id="S4.E13.m1.2.2.1.1.1.1" xref="S4.E13.m1.2.2.1.1.1.1.cmml"><msub id="S4.E13.m1.2.2.1.1.1.1.3" xref="S4.E13.m1.2.2.1.1.1.1.3.cmml"><mi id="S4.E13.m1.2.2.1.1.1.1.3.2" xref="S4.E13.m1.2.2.1.1.1.1.3.2.cmml">𝔼</mi><mi id="S4.E13.m1.2.2.1.1.1.1.3.3" xref="S4.E13.m1.2.2.1.1.1.1.3.3.cmml">π</mi></msub><mo id="S4.E13.m1.2.2.1.1.1.1.2" xref="S4.E13.m1.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E13.m1.2.2.1.1.1.1.1.1" xref="S4.E13.m1.2.2.1.1.1.1.1.2.cmml"><mo id="S4.E13.m1.2.2.1.1.1.1.1.1.2" xref="S4.E13.m1.2.2.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S4.E13.m1.2.2.1.1.1.1.1.1.1" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.cmml"><mrow id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.cmml"><mrow id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.cmml"><munderover id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.3" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.3.cmml"><mo id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.3.2.2" lspace="0em" movablelimits="false" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.3.2.2.cmml">∑</mo><mrow id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.3.2.3" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.3.2.3.cmml"><mi id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.3.2.3.2" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.3.2.3.2.cmml">t</mi><mo id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.3.2.3.1" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.3.2.3.1.cmml">=</mo><mn id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.3.2.3.3" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.3.2.3.3.cmml">0</mn></mrow><mi id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.3.3" mathvariant="normal" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.3.3.cmml">∞</mi></munderover><mrow id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml"><msup id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.4" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.4.cmml"><mi id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.4.2" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.4.2.cmml">γ</mi><mi id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.4.3" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.4.3.cmml">t</mi></msup><mo id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.3" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.cmml">⁢</mo><mi id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.5" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.5.cmml">c</mi><mo id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.3a" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.cmml">⁢</mo><mrow id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.2.2" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.2.3.cmml"><mo id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.2.2.3" stretchy="false" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.2.3.cmml">(</mo><msub id="S4.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mi id="S4.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.2.2.4" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.2.3.cmml">,</mo><msub id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.2.2.2" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.2.2.2.cmml"><mi id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.2.2.2.2" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.2.2.2.2.cmml">𝒖</mi><mi id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.2.2.2.3" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.2.2.5" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.2.3.cmml">,</mo><mi id="S4.E13.m1.1.1" xref="S4.E13.m1.1.1.cmml">𝒈</mi><mo id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.2.2.6" stretchy="false" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo fence="false" id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.3" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.3.cmml">|</mo><msub id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.4" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.4.cmml"><mi id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.4.2" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.4.2.cmml">𝒙</mi><mn id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.4.3" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.4.3.cmml">0</mn></msub></mrow><mo id="S4.E13.m1.2.2.1.1.1.1.1.1.1.3" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.3.cmml">=</mo><mi id="S4.E13.m1.2.2.1.1.1.1.1.1.1.4" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.4.cmml">𝒙</mi></mrow><mo id="S4.E13.m1.2.2.1.1.1.1.1.1.3" xref="S4.E13.m1.2.2.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo id="S4.E13.m1.2.2.1.2" lspace="0em" xref="S4.E13.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E13.m1.2b"><apply id="S4.E13.m1.2.2.1.1.cmml" xref="S4.E13.m1.2.2.1"><eq id="S4.E13.m1.2.2.1.1.2.cmml" xref="S4.E13.m1.2.2.1.1.2"></eq><apply id="S4.E13.m1.2.2.1.1.3.cmml" xref="S4.E13.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.E13.m1.2.2.1.1.3.1.cmml" xref="S4.E13.m1.2.2.1.1.3">superscript</csymbol><ci id="S4.E13.m1.2.2.1.1.3.2.cmml" xref="S4.E13.m1.2.2.1.1.3.2">𝜋</ci><times id="S4.E13.m1.2.2.1.1.3.3.cmml" xref="S4.E13.m1.2.2.1.1.3.3"></times></apply><apply id="S4.E13.m1.2.2.1.1.1.cmml" xref="S4.E13.m1.2.2.1.1.1"><apply id="S4.E13.m1.2.2.1.1.1.2.cmml" xref="S4.E13.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.E13.m1.2.2.1.1.1.2.1.cmml" xref="S4.E13.m1.2.2.1.1.1.2">subscript</csymbol><ci id="S4.E13.m1.2.2.1.1.1.2.2.cmml" xref="S4.E13.m1.2.2.1.1.1.2.2">argmin</ci><ci id="S4.E13.m1.2.2.1.1.1.2.3.cmml" xref="S4.E13.m1.2.2.1.1.1.2.3">𝜋</ci></apply><apply id="S4.E13.m1.2.2.1.1.1.1.cmml" xref="S4.E13.m1.2.2.1.1.1.1"><times id="S4.E13.m1.2.2.1.1.1.1.2.cmml" xref="S4.E13.m1.2.2.1.1.1.1.2"></times><apply id="S4.E13.m1.2.2.1.1.1.1.3.cmml" xref="S4.E13.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E13.m1.2.2.1.1.1.1.3.1.cmml" xref="S4.E13.m1.2.2.1.1.1.1.3">subscript</csymbol><ci id="S4.E13.m1.2.2.1.1.1.1.3.2.cmml" xref="S4.E13.m1.2.2.1.1.1.1.3.2">𝔼</ci><ci id="S4.E13.m1.2.2.1.1.1.1.3.3.cmml" xref="S4.E13.m1.2.2.1.1.1.1.3.3">𝜋</ci></apply><apply id="S4.E13.m1.2.2.1.1.1.1.1.2.cmml" xref="S4.E13.m1.2.2.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E13.m1.2.2.1.1.1.1.1.2.1.cmml" xref="S4.E13.m1.2.2.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.E13.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1"><eq id="S4.E13.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.3"></eq><apply id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2"><csymbol cd="latexml" id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.3">conditional</csymbol><apply id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2"><apply id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.3">superscript</csymbol><apply id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.3.2.1.cmml" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.3">subscript</csymbol><sum id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.3.2.2.cmml" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.3.2.2"></sum><apply id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.3.2.3.cmml" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.3.2.3"><eq id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.3.2.3.1.cmml" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.3.2.3.1"></eq><ci id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.3.2.3.2.cmml" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.3.2.3.2">𝑡</ci><cn id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.3.2.3.3.cmml" type="integer" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.3.2.3.3">0</cn></apply></apply><infinity id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.3.3"></infinity></apply><apply id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2"><times id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.3"></times><apply id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.4.cmml" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.4"><csymbol cd="ambiguous" id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.4.1.cmml" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.4">superscript</csymbol><ci id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.4.2.cmml" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.4.2">𝛾</ci><ci id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.4.3.cmml" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.4.3">𝑡</ci></apply><ci id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.5.cmml" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.5">𝑐</ci><vector id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.2.2"><apply id="S4.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝒙</ci><ci id="S4.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.2.2.2.1.cmml" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.2.2.2.2">𝒖</ci><ci id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.2.2.2.3.cmml" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.2.2.2.2.2.3">𝑡</ci></apply><ci id="S4.E13.m1.1.1.cmml" xref="S4.E13.m1.1.1">𝒈</ci></vector></apply></apply><apply id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.4.cmml" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.4.1.cmml" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.4">subscript</csymbol><ci id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.4.2.cmml" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.4.2">𝒙</ci><cn id="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.4.3.cmml" type="integer" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.2.4.3">0</cn></apply></apply><ci id="S4.E13.m1.2.2.1.1.1.1.1.1.1.4.cmml" xref="S4.E13.m1.2.2.1.1.1.1.1.1.1.4">𝒙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E13.m1.2c">\pi^{*}=\mathop{\rm argmin}\limits_{\pi}\mathbb{E}_{\pi}\left[\sum_{t=0}^{%
\infty}\gamma^{t}c(\boldsymbol{x}_{t},\boldsymbol{u}_{t},\boldsymbol{g})|%
\boldsymbol{x}_{0}=\boldsymbol{x}\right].</annotation><annotation encoding="application/x-llamapun" id="S4.E13.m1.2d">italic_π start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = roman_argmin start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT blackboard_E start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT [ ∑ start_POSTSUBSCRIPT italic_t = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT italic_γ start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT italic_c ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , bold_italic_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , bold_italic_g ) | bold_italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = bold_italic_x ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p1.6">The configuration of the goal variables <math alttext="\boldsymbol{g}" class="ltx_Math" display="inline" id="S4.SS1.p1.6.m1.1"><semantics id="S4.SS1.p1.6.m1.1a"><mi id="S4.SS1.p1.6.m1.1.1" xref="S4.SS1.p1.6.m1.1.1.cmml">𝒈</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m1.1b"><ci id="S4.SS1.p1.6.m1.1.1.cmml" xref="S4.SS1.p1.6.m1.1.1">𝒈</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m1.1c">\boldsymbol{g}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.6.m1.1d">bold_italic_g</annotation></semantics></math> varies depending on the task.</p>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1">In Eq.(<a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S4.E11" title="In 4.1 Lower Layer ‣ 4 Method ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">11</span></a>), the target values for the value function were calculated using the solution of the optimal control problem. Using the terminal values obtained from Eq.(<a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S4.E11" title="In 4.1 Lower Layer ‣ 4 Method ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">11</span></a>) and Eq.(<a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S4.E12" title="In 4.1 Lower Layer ‣ 4 Method ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">12</span></a>), the MPC can effectively operate as a longer-horizon controller, with the flexibility to modify control objectives by varying the goal variables. During training, the goal variable <math alttext="\boldsymbol{g}" class="ltx_Math" display="inline" id="S4.SS1.p2.1.m1.1"><semantics id="S4.SS1.p2.1.m1.1a"><mi id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml">𝒈</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><ci id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">𝒈</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">\boldsymbol{g}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.1.m1.1d">bold_italic_g</annotation></semantics></math> remains constant throughout the horizon and is randomly sampled in each episode. During the inference phase, however, the goal variable is instead represented as a time-varying sequence. The key distinction from the standard GCRL framework is that the goal variable forms a trajectory over the horizon during inference, which helps smooth the agent’s motions.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Upper Layer</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">The upper layer generates goal variables that serve as inputs to the terminal value function for the lower-layer MPC. By varying objectives according to the robot’s state, the controller in the lower layer can achieve flexible and diverse motion generation suited to the given environment. The role of the trajectory generator in the upper layer differs between the training and inference phases. In the training phase, the upper layer generates random goal variables within a certain range to ensure the lower layer’s terminal value can accommodate a wide range of objective variables. In the inference phase, to enable the robot to generate diverse motions suited to the given environment, a feedback goal variable generator is required, which takes the observed robot’s state as input and outputs goal variables. Specifically, a sequence of goal variables corresponding to the number of steps in MPC’s prediction horizon is generated each control cycle. The key aspect of the method is using a time-varying sequence of goal variables rather than a time-invariant one, which leads to smoother motion generation for the robot. The way of generating goal variable sequences is task-dependent and can be implemented using either model-based or data-driven approaches. The proposed algorithm is summarized in Algorithms <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#alg1" title="Algorithm 1 ‣ 4.2 Upper Layer ‣ 4 Method ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">1</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#alg2" title="Algorithm 2 ‣ 4.2 Upper Layer ‣ 4 Method ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span> </span> Proposed Method (Training)</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.3">
<div class="ltx_listingline" id="alg1.l0">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l0.1.1.1" style="font-size:80%;">0:</span></span>  <math alttext="H" class="ltx_Math" display="inline" id="alg1.l0.m1.1"><semantics id="alg1.l0.m1.1a"><mi id="alg1.l0.m1.1.1" xref="alg1.l0.m1.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m1.1b"><ci id="alg1.l0.m1.1.1.cmml" xref="alg1.l0.m1.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m1.1c">H</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m1.1d">italic_H</annotation></semantics></math>: Planning Horizon, <math alttext="\boldsymbol{\theta}" class="ltx_Math" display="inline" id="alg1.l0.m2.1"><semantics id="alg1.l0.m2.1a"><mi id="alg1.l0.m2.1.1" xref="alg1.l0.m2.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m2.1b"><ci id="alg1.l0.m2.1.1.cmml" xref="alg1.l0.m2.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m2.1c">\boldsymbol{\theta}</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m2.1d">bold_italic_θ</annotation></semantics></math>: Value function parameters, <math alttext="n" class="ltx_Math" display="inline" id="alg1.l0.m3.1"><semantics id="alg1.l0.m3.1a"><mi id="alg1.l0.m3.1.1" xref="alg1.l0.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m3.1b"><ci id="alg1.l0.m3.1.1.cmml" xref="alg1.l0.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m3.1c">n</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m3.1d">italic_n</annotation></semantics></math>: mini-batch size, <math alttext="G" class="ltx_Math" display="inline" id="alg1.l0.m4.1"><semantics id="alg1.l0.m4.1a"><mi id="alg1.l0.m4.1.1" xref="alg1.l0.m4.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m4.1b"><ci id="alg1.l0.m4.1.1.cmml" xref="alg1.l0.m4.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m4.1c">G</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m4.1d">italic_G</annotation></semantics></math>: number of gradient steps, <math alttext="Z" class="ltx_Math" display="inline" id="alg1.l0.m5.1"><semantics id="alg1.l0.m5.1a"><mi id="alg1.l0.m5.1.1" xref="alg1.l0.m5.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m5.1b"><ci id="alg1.l0.m5.1.1.cmml" xref="alg1.l0.m5.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m5.1c">Z</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m5.1d">italic_Z</annotation></semantics></math>: update frequency, <math alttext="\boldsymbol{g_{\text{min}}},\boldsymbol{g_{\text{max}}}" class="ltx_Math" display="inline" id="alg1.l0.m6.2"><semantics id="alg1.l0.m6.2a"><mrow id="alg1.l0.m6.2.2.2" xref="alg1.l0.m6.2.2.3.cmml"><msub id="alg1.l0.m6.1.1.1.1" xref="alg1.l0.m6.1.1.1.1.cmml"><mi id="alg1.l0.m6.1.1.1.1.2" xref="alg1.l0.m6.1.1.1.1.2.cmml">𝒈</mi><mtext id="alg1.l0.m6.1.1.1.1.3" xref="alg1.l0.m6.1.1.1.1.3a.cmml">min</mtext></msub><mo id="alg1.l0.m6.2.2.2.3" xref="alg1.l0.m6.2.2.3.cmml">,</mo><msub id="alg1.l0.m6.2.2.2.2" xref="alg1.l0.m6.2.2.2.2.cmml"><mi id="alg1.l0.m6.2.2.2.2.2" xref="alg1.l0.m6.2.2.2.2.2.cmml">𝒈</mi><mtext id="alg1.l0.m6.2.2.2.2.3" xref="alg1.l0.m6.2.2.2.2.3a.cmml">max</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0.m6.2b"><list id="alg1.l0.m6.2.2.3.cmml" xref="alg1.l0.m6.2.2.2"><apply id="alg1.l0.m6.1.1.1.1.cmml" xref="alg1.l0.m6.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l0.m6.1.1.1.1.1.cmml" xref="alg1.l0.m6.1.1.1.1">subscript</csymbol><ci id="alg1.l0.m6.1.1.1.1.2.cmml" xref="alg1.l0.m6.1.1.1.1.2">𝒈</ci><ci id="alg1.l0.m6.1.1.1.1.3a.cmml" xref="alg1.l0.m6.1.1.1.1.3"><mtext id="alg1.l0.m6.1.1.1.1.3.cmml" mathsize="70%" xref="alg1.l0.m6.1.1.1.1.3">min</mtext></ci></apply><apply id="alg1.l0.m6.2.2.2.2.cmml" xref="alg1.l0.m6.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l0.m6.2.2.2.2.1.cmml" xref="alg1.l0.m6.2.2.2.2">subscript</csymbol><ci id="alg1.l0.m6.2.2.2.2.2.cmml" xref="alg1.l0.m6.2.2.2.2.2">𝒈</ci><ci id="alg1.l0.m6.2.2.2.2.3a.cmml" xref="alg1.l0.m6.2.2.2.2.3"><mtext id="alg1.l0.m6.2.2.2.2.3.cmml" mathsize="70%" xref="alg1.l0.m6.2.2.2.2.3">max</mtext></ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m6.2c">\boldsymbol{g_{\text{min}}},\boldsymbol{g_{\text{max}}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m6.2d">bold_italic_g start_POSTSUBSCRIPT min end_POSTSUBSCRIPT , bold_italic_g start_POSTSUBSCRIPT max end_POSTSUBSCRIPT</annotation></semantics></math>: minimum and maximum of goal variables;

</div>
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l1.1.1.1" style="font-size:80%;">1:</span></span>  <span class="ltx_text ltx_font_bold" id="alg1.l1.2">for</span> <math alttext="t\leftarrow 0\,\,\textbf{to}\,\,\infty" class="ltx_Math" display="inline" id="alg1.l1.m1.1"><semantics id="alg1.l1.m1.1a"><mrow id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml"><mi id="alg1.l1.m1.1.1.2" xref="alg1.l1.m1.1.1.2.cmml">t</mi><mo id="alg1.l1.m1.1.1.1" stretchy="false" xref="alg1.l1.m1.1.1.1.cmml">←</mo><mrow id="alg1.l1.m1.1.1.3" xref="alg1.l1.m1.1.1.3.cmml"><mn id="alg1.l1.m1.1.1.3.2" xref="alg1.l1.m1.1.1.3.2.cmml">0</mn><mo id="alg1.l1.m1.1.1.3.1" lspace="0.330em" xref="alg1.l1.m1.1.1.3.1.cmml">⁢</mo><mtext class="ltx_mathvariant_bold" id="alg1.l1.m1.1.1.3.3" xref="alg1.l1.m1.1.1.3.3a.cmml">to</mtext><mo id="alg1.l1.m1.1.1.3.1a" lspace="0.330em" xref="alg1.l1.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l1.m1.1.1.3.4" mathvariant="normal" xref="alg1.l1.m1.1.1.3.4.cmml">∞</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1"><ci id="alg1.l1.m1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1">←</ci><ci id="alg1.l1.m1.1.1.2.cmml" xref="alg1.l1.m1.1.1.2">𝑡</ci><apply id="alg1.l1.m1.1.1.3.cmml" xref="alg1.l1.m1.1.1.3"><times id="alg1.l1.m1.1.1.3.1.cmml" xref="alg1.l1.m1.1.1.3.1"></times><cn id="alg1.l1.m1.1.1.3.2.cmml" type="integer" xref="alg1.l1.m1.1.1.3.2">0</cn><ci id="alg1.l1.m1.1.1.3.3a.cmml" xref="alg1.l1.m1.1.1.3.3"><mtext class="ltx_mathvariant_bold" id="alg1.l1.m1.1.1.3.3.cmml" xref="alg1.l1.m1.1.1.3.3">to</mtext></ci><infinity id="alg1.l1.m1.1.1.3.4.cmml" xref="alg1.l1.m1.1.1.3.4"></infinity></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">t\leftarrow 0\,\,\textbf{to}\,\,\infty</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.1d">italic_t ← 0 to ∞</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l1.3">do</span>
</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l2.1.1.1" style="font-size:80%;">2:</span></span>     Sample <math alttext="\boldsymbol{g}_{\text{target}}" class="ltx_Math" display="inline" id="alg1.l2.m1.1"><semantics id="alg1.l2.m1.1a"><msub id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">𝒈</mi><mtext id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3a.cmml">target</mtext></msub><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1">subscript</csymbol><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝒈</ci><ci id="alg1.l2.m1.1.1.3a.cmml" xref="alg1.l2.m1.1.1.3"><mtext id="alg1.l2.m1.1.1.3.cmml" mathsize="70%" xref="alg1.l2.m1.1.1.3">target</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">\boldsymbol{g}_{\text{target}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.1d">bold_italic_g start_POSTSUBSCRIPT target end_POSTSUBSCRIPT</annotation></semantics></math> from a continuous uniform distribution <math alttext="U(\boldsymbol{g_{\text{min}}},\boldsymbol{g_{\text{max}}})" class="ltx_Math" display="inline" id="alg1.l2.m2.2"><semantics id="alg1.l2.m2.2a"><mrow id="alg1.l2.m2.2.2" xref="alg1.l2.m2.2.2.cmml"><mi id="alg1.l2.m2.2.2.4" xref="alg1.l2.m2.2.2.4.cmml">U</mi><mo id="alg1.l2.m2.2.2.3" xref="alg1.l2.m2.2.2.3.cmml">⁢</mo><mrow id="alg1.l2.m2.2.2.2.2" xref="alg1.l2.m2.2.2.2.3.cmml"><mo id="alg1.l2.m2.2.2.2.2.3" stretchy="false" xref="alg1.l2.m2.2.2.2.3.cmml">(</mo><msub id="alg1.l2.m2.1.1.1.1.1" xref="alg1.l2.m2.1.1.1.1.1.cmml"><mi id="alg1.l2.m2.1.1.1.1.1.2" xref="alg1.l2.m2.1.1.1.1.1.2.cmml">𝒈</mi><mtext id="alg1.l2.m2.1.1.1.1.1.3" xref="alg1.l2.m2.1.1.1.1.1.3a.cmml">min</mtext></msub><mo id="alg1.l2.m2.2.2.2.2.4" xref="alg1.l2.m2.2.2.2.3.cmml">,</mo><msub id="alg1.l2.m2.2.2.2.2.2" xref="alg1.l2.m2.2.2.2.2.2.cmml"><mi id="alg1.l2.m2.2.2.2.2.2.2" xref="alg1.l2.m2.2.2.2.2.2.2.cmml">𝒈</mi><mtext id="alg1.l2.m2.2.2.2.2.2.3" xref="alg1.l2.m2.2.2.2.2.2.3a.cmml">max</mtext></msub><mo id="alg1.l2.m2.2.2.2.2.5" stretchy="false" xref="alg1.l2.m2.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.2b"><apply id="alg1.l2.m2.2.2.cmml" xref="alg1.l2.m2.2.2"><times id="alg1.l2.m2.2.2.3.cmml" xref="alg1.l2.m2.2.2.3"></times><ci id="alg1.l2.m2.2.2.4.cmml" xref="alg1.l2.m2.2.2.4">𝑈</ci><interval closure="open" id="alg1.l2.m2.2.2.2.3.cmml" xref="alg1.l2.m2.2.2.2.2"><apply id="alg1.l2.m2.1.1.1.1.1.cmml" xref="alg1.l2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m2.1.1.1.1.1.1.cmml" xref="alg1.l2.m2.1.1.1.1.1">subscript</csymbol><ci id="alg1.l2.m2.1.1.1.1.1.2.cmml" xref="alg1.l2.m2.1.1.1.1.1.2">𝒈</ci><ci id="alg1.l2.m2.1.1.1.1.1.3a.cmml" xref="alg1.l2.m2.1.1.1.1.1.3"><mtext id="alg1.l2.m2.1.1.1.1.1.3.cmml" mathsize="70%" xref="alg1.l2.m2.1.1.1.1.1.3">min</mtext></ci></apply><apply id="alg1.l2.m2.2.2.2.2.2.cmml" xref="alg1.l2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l2.m2.2.2.2.2.2.1.cmml" xref="alg1.l2.m2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l2.m2.2.2.2.2.2.2.cmml" xref="alg1.l2.m2.2.2.2.2.2.2">𝒈</ci><ci id="alg1.l2.m2.2.2.2.2.2.3a.cmml" xref="alg1.l2.m2.2.2.2.2.2.3"><mtext id="alg1.l2.m2.2.2.2.2.2.3.cmml" mathsize="70%" xref="alg1.l2.m2.2.2.2.2.2.3">max</mtext></ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.2c">U(\boldsymbol{g_{\text{min}}},\boldsymbol{g_{\text{max}}})</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m2.2d">italic_U ( bold_italic_g start_POSTSUBSCRIPT min end_POSTSUBSCRIPT , bold_italic_g start_POSTSUBSCRIPT max end_POSTSUBSCRIPT )</annotation></semantics></math>;

</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l3.1.1.1" style="font-size:80%;">3:</span></span>     Determine control input <math alttext="\boldsymbol{u}_{t}" class="ltx_Math" display="inline" id="alg1.l3.m1.1"><semantics id="alg1.l3.m1.1a"><msub id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml">𝒖</mi><mi id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1">subscript</csymbol><ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">𝒖</ci><ci id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">\boldsymbol{u}_{t}</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.1d">bold_italic_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> according to MPC Eq.(<a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S3.E10" title="In 3.3 Model Predictive Control (MPC) ‣ 3 Preliminaries ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">10</span></a>) with estimated terminal value <math alttext="\hat{V}_{\boldsymbol{\theta}}(\boldsymbol{x}_{t+H},\boldsymbol{g}_{\text{%
target}})" class="ltx_Math" display="inline" id="alg1.l3.m2.2"><semantics id="alg1.l3.m2.2a"><mrow id="alg1.l3.m2.2.2" xref="alg1.l3.m2.2.2.cmml"><msub id="alg1.l3.m2.2.2.4" xref="alg1.l3.m2.2.2.4.cmml"><mover accent="true" id="alg1.l3.m2.2.2.4.2" xref="alg1.l3.m2.2.2.4.2.cmml"><mi id="alg1.l3.m2.2.2.4.2.2" xref="alg1.l3.m2.2.2.4.2.2.cmml">V</mi><mo id="alg1.l3.m2.2.2.4.2.1" xref="alg1.l3.m2.2.2.4.2.1.cmml">^</mo></mover><mi id="alg1.l3.m2.2.2.4.3" xref="alg1.l3.m2.2.2.4.3.cmml">𝜽</mi></msub><mo id="alg1.l3.m2.2.2.3" xref="alg1.l3.m2.2.2.3.cmml">⁢</mo><mrow id="alg1.l3.m2.2.2.2.2" xref="alg1.l3.m2.2.2.2.3.cmml"><mo id="alg1.l3.m2.2.2.2.2.3" stretchy="false" xref="alg1.l3.m2.2.2.2.3.cmml">(</mo><msub id="alg1.l3.m2.1.1.1.1.1" xref="alg1.l3.m2.1.1.1.1.1.cmml"><mi id="alg1.l3.m2.1.1.1.1.1.2" xref="alg1.l3.m2.1.1.1.1.1.2.cmml">𝒙</mi><mrow id="alg1.l3.m2.1.1.1.1.1.3" xref="alg1.l3.m2.1.1.1.1.1.3.cmml"><mi id="alg1.l3.m2.1.1.1.1.1.3.2" xref="alg1.l3.m2.1.1.1.1.1.3.2.cmml">t</mi><mo id="alg1.l3.m2.1.1.1.1.1.3.1" xref="alg1.l3.m2.1.1.1.1.1.3.1.cmml">+</mo><mi id="alg1.l3.m2.1.1.1.1.1.3.3" xref="alg1.l3.m2.1.1.1.1.1.3.3.cmml">H</mi></mrow></msub><mo id="alg1.l3.m2.2.2.2.2.4" xref="alg1.l3.m2.2.2.2.3.cmml">,</mo><msub id="alg1.l3.m2.2.2.2.2.2" xref="alg1.l3.m2.2.2.2.2.2.cmml"><mi id="alg1.l3.m2.2.2.2.2.2.2" xref="alg1.l3.m2.2.2.2.2.2.2.cmml">𝒈</mi><mtext id="alg1.l3.m2.2.2.2.2.2.3" xref="alg1.l3.m2.2.2.2.2.2.3a.cmml">target</mtext></msub><mo id="alg1.l3.m2.2.2.2.2.5" stretchy="false" xref="alg1.l3.m2.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m2.2b"><apply id="alg1.l3.m2.2.2.cmml" xref="alg1.l3.m2.2.2"><times id="alg1.l3.m2.2.2.3.cmml" xref="alg1.l3.m2.2.2.3"></times><apply id="alg1.l3.m2.2.2.4.cmml" xref="alg1.l3.m2.2.2.4"><csymbol cd="ambiguous" id="alg1.l3.m2.2.2.4.1.cmml" xref="alg1.l3.m2.2.2.4">subscript</csymbol><apply id="alg1.l3.m2.2.2.4.2.cmml" xref="alg1.l3.m2.2.2.4.2"><ci id="alg1.l3.m2.2.2.4.2.1.cmml" xref="alg1.l3.m2.2.2.4.2.1">^</ci><ci id="alg1.l3.m2.2.2.4.2.2.cmml" xref="alg1.l3.m2.2.2.4.2.2">𝑉</ci></apply><ci id="alg1.l3.m2.2.2.4.3.cmml" xref="alg1.l3.m2.2.2.4.3">𝜽</ci></apply><interval closure="open" id="alg1.l3.m2.2.2.2.3.cmml" xref="alg1.l3.m2.2.2.2.2"><apply id="alg1.l3.m2.1.1.1.1.1.cmml" xref="alg1.l3.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m2.1.1.1.1.1.1.cmml" xref="alg1.l3.m2.1.1.1.1.1">subscript</csymbol><ci id="alg1.l3.m2.1.1.1.1.1.2.cmml" xref="alg1.l3.m2.1.1.1.1.1.2">𝒙</ci><apply id="alg1.l3.m2.1.1.1.1.1.3.cmml" xref="alg1.l3.m2.1.1.1.1.1.3"><plus id="alg1.l3.m2.1.1.1.1.1.3.1.cmml" xref="alg1.l3.m2.1.1.1.1.1.3.1"></plus><ci id="alg1.l3.m2.1.1.1.1.1.3.2.cmml" xref="alg1.l3.m2.1.1.1.1.1.3.2">𝑡</ci><ci id="alg1.l3.m2.1.1.1.1.1.3.3.cmml" xref="alg1.l3.m2.1.1.1.1.1.3.3">𝐻</ci></apply></apply><apply id="alg1.l3.m2.2.2.2.2.2.cmml" xref="alg1.l3.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l3.m2.2.2.2.2.2.1.cmml" xref="alg1.l3.m2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l3.m2.2.2.2.2.2.2.cmml" xref="alg1.l3.m2.2.2.2.2.2.2">𝒈</ci><ci id="alg1.l3.m2.2.2.2.2.2.3a.cmml" xref="alg1.l3.m2.2.2.2.2.2.3"><mtext id="alg1.l3.m2.2.2.2.2.2.3.cmml" mathsize="70%" xref="alg1.l3.m2.2.2.2.2.2.3">target</mtext></ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m2.2c">\hat{V}_{\boldsymbol{\theta}}(\boldsymbol{x}_{t+H},\boldsymbol{g}_{\text{%
target}})</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m2.2d">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUBSCRIPT italic_t + italic_H end_POSTSUBSCRIPT , bold_italic_g start_POSTSUBSCRIPT target end_POSTSUBSCRIPT )</annotation></semantics></math>;

</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l4.1.1.1" style="font-size:80%;">4:</span></span>     Execute <math alttext="\boldsymbol{u}_{t}" class="ltx_Math" display="inline" id="alg1.l4.m1.1"><semantics id="alg1.l4.m1.1a"><msub id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mi id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">𝒖</mi><mi id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1">subscript</csymbol><ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">𝒖</ci><ci id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">\boldsymbol{u}_{t}</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.1d">bold_italic_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> on the system and add state experience <math alttext="\boldsymbol{x}_{t}" class="ltx_Math" display="inline" id="alg1.l4.m2.1"><semantics id="alg1.l4.m2.1a"><msub id="alg1.l4.m2.1.1" xref="alg1.l4.m2.1.1.cmml"><mi id="alg1.l4.m2.1.1.2" xref="alg1.l4.m2.1.1.2.cmml">𝒙</mi><mi id="alg1.l4.m2.1.1.3" xref="alg1.l4.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l4.m2.1b"><apply id="alg1.l4.m2.1.1.cmml" xref="alg1.l4.m2.1.1"><csymbol cd="ambiguous" id="alg1.l4.m2.1.1.1.cmml" xref="alg1.l4.m2.1.1">subscript</csymbol><ci id="alg1.l4.m2.1.1.2.cmml" xref="alg1.l4.m2.1.1.2">𝒙</ci><ci id="alg1.l4.m2.1.1.3.cmml" xref="alg1.l4.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m2.1c">\boldsymbol{x}_{t}</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m2.1d">bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> to the replay buffer <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="alg1.l4.m3.1"><semantics id="alg1.l4.m3.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l4.m3.1.1" xref="alg1.l4.m3.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="alg1.l4.m3.1b"><ci id="alg1.l4.m3.1.1.cmml" xref="alg1.l4.m3.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m3.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m3.1d">caligraphic_D</annotation></semantics></math>;

</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l5.1.1.1" style="font-size:80%;">5:</span></span>     <span class="ltx_text ltx_font_bold" id="alg1.l5.2">if</span> <math alttext="t\%Z==0" class="ltx_math_unparsed" display="inline" id="alg1.l5.m1.1"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1b"><mi id="alg1.l5.m1.1.1">t</mi><mo id="alg1.l5.m1.1.2">%</mo><mi id="alg1.l5.m1.1.3">Z</mi><mo id="alg1.l5.m1.1.4" rspace="0em">=</mo><mo id="alg1.l5.m1.1.5" lspace="0em">=</mo><mn id="alg1.l5.m1.1.6">0</mn></mrow><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">t\%Z==0</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.1d">italic_t % italic_Z = = 0</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l5.3">then</span>
</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l6.1.1.1" style="font-size:80%;">6:</span></span>        <span class="ltx_text ltx_font_bold" id="alg1.l6.2">for</span> <math alttext="G" class="ltx_Math" display="inline" id="alg1.l6.m1.1"><semantics id="alg1.l6.m1.1a"><mi id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><ci id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">G</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.1d">italic_G</annotation></semantics></math> times <span class="ltx_text ltx_font_bold" id="alg1.l6.3">do</span>
</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l7.1.1.1" style="font-size:80%;">7:</span></span>           Sample <math alttext="n" class="ltx_Math" display="inline" id="alg1.l7.m1.1"><semantics id="alg1.l7.m1.1a"><mi id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><ci id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m1.1d">italic_n</annotation></semantics></math> states from the replay buffer and compute targets using Eq.(<a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S4.E11" title="In 4.1 Lower Layer ‣ 4 Method ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">11</span></a>);

</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l8.1.1.1" style="font-size:80%;">8:</span></span>           Update the terminal value parameters using Eq.(<a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S4.E12" title="In 4.1 Lower Layer ‣ 4 Method ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">12</span></a>);

</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l9.1.1.1" style="font-size:80%;">9:</span></span>        <span class="ltx_text ltx_font_bold" id="alg1.l9.2">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l9.3">for</span>
</div>
<div class="ltx_listingline" id="alg1.l10">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l10.1.1.1" style="font-size:80%;">10:</span></span>     <span class="ltx_text ltx_font_bold" id="alg1.l10.2">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l10.3">if</span>
</div>
<div class="ltx_listingline" id="alg1.l11">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l11.1.1.1" style="font-size:80%;">11:</span></span>  <span class="ltx_text ltx_font_bold" id="alg1.l11.2">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l11.3">for</span>
</div>
</div>
</figure>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg2.2.1.1">Algorithm 2</span> </span> Proposed Method (Inference)</figcaption>
<div class="ltx_listing ltx_listing" id="alg2.3">
<div class="ltx_listingline" id="alg2.l0">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l0.1.1.1" style="font-size:80%;">0:</span></span>  <math alttext="H" class="ltx_Math" display="inline" id="alg2.l0.m1.1"><semantics id="alg2.l0.m1.1a"><mi id="alg2.l0.m1.1.1" xref="alg2.l0.m1.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="alg2.l0.m1.1b"><ci id="alg2.l0.m1.1.1.cmml" xref="alg2.l0.m1.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m1.1c">H</annotation><annotation encoding="application/x-llamapun" id="alg2.l0.m1.1d">italic_H</annotation></semantics></math>: Planning Horizon, <math alttext="G_{\mathrm{plan}}" class="ltx_Math" display="inline" id="alg2.l0.m2.1"><semantics id="alg2.l0.m2.1a"><msub id="alg2.l0.m2.1.1" xref="alg2.l0.m2.1.1.cmml"><mi id="alg2.l0.m2.1.1.2" xref="alg2.l0.m2.1.1.2.cmml">G</mi><mi id="alg2.l0.m2.1.1.3" xref="alg2.l0.m2.1.1.3.cmml">plan</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l0.m2.1b"><apply id="alg2.l0.m2.1.1.cmml" xref="alg2.l0.m2.1.1"><csymbol cd="ambiguous" id="alg2.l0.m2.1.1.1.cmml" xref="alg2.l0.m2.1.1">subscript</csymbol><ci id="alg2.l0.m2.1.1.2.cmml" xref="alg2.l0.m2.1.1.2">𝐺</ci><ci id="alg2.l0.m2.1.1.3.cmml" xref="alg2.l0.m2.1.1.3">plan</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m2.1c">G_{\mathrm{plan}}</annotation><annotation encoding="application/x-llamapun" id="alg2.l0.m2.1d">italic_G start_POSTSUBSCRIPT roman_plan end_POSTSUBSCRIPT</annotation></semantics></math>: Sub-Goal Planner, <math alttext="\boldsymbol{\theta}" class="ltx_Math" display="inline" id="alg2.l0.m3.1"><semantics id="alg2.l0.m3.1a"><mi id="alg2.l0.m3.1.1" xref="alg2.l0.m3.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="alg2.l0.m3.1b"><ci id="alg2.l0.m3.1.1.cmml" xref="alg2.l0.m3.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m3.1c">\boldsymbol{\theta}</annotation><annotation encoding="application/x-llamapun" id="alg2.l0.m3.1d">bold_italic_θ</annotation></semantics></math>: Value function parameters;

</div>
<div class="ltx_listingline" id="alg2.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l1.1.1.1" style="font-size:80%;">1:</span></span>  <span class="ltx_text ltx_font_bold" id="alg2.l1.2">while</span> <span class="ltx_text ltx_font_italic" id="alg2.l1.3">task not completed</span> <span class="ltx_text ltx_font_bold" id="alg2.l1.4">do</span>
</div>
<div class="ltx_listingline" id="alg2.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l2.1.1.1" style="font-size:80%;">2:</span></span>     Observe current state <math alttext="\boldsymbol{x}_{t}" class="ltx_Math" display="inline" id="alg2.l2.m1.1"><semantics id="alg2.l2.m1.1a"><msub id="alg2.l2.m1.1.1" xref="alg2.l2.m1.1.1.cmml"><mi id="alg2.l2.m1.1.1.2" xref="alg2.l2.m1.1.1.2.cmml">𝒙</mi><mi id="alg2.l2.m1.1.1.3" xref="alg2.l2.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.1b"><apply id="alg2.l2.m1.1.1.cmml" xref="alg2.l2.m1.1.1"><csymbol cd="ambiguous" id="alg2.l2.m1.1.1.1.cmml" xref="alg2.l2.m1.1.1">subscript</csymbol><ci id="alg2.l2.m1.1.1.2.cmml" xref="alg2.l2.m1.1.1.2">𝒙</ci><ci id="alg2.l2.m1.1.1.3.cmml" xref="alg2.l2.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.1c">\boldsymbol{x}_{t}</annotation><annotation encoding="application/x-llamapun" id="alg2.l2.m1.1d">bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and update MPC’s internal state;

</div>
<div class="ltx_listingline" id="alg2.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l3.1.1.1" style="font-size:80%;">3:</span></span>     Sample planned goal variable trajectory <math alttext="\boldsymbol{g}^{\text{plan}}_{t:t+H}\sim G_{\mathrm{plan}}(\boldsymbol{x}_{t})" class="ltx_Math" display="inline" id="alg2.l3.m1.1"><semantics id="alg2.l3.m1.1a"><mrow id="alg2.l3.m1.1.1" xref="alg2.l3.m1.1.1.cmml"><msubsup id="alg2.l3.m1.1.1.3" xref="alg2.l3.m1.1.1.3.cmml"><mi id="alg2.l3.m1.1.1.3.2.2" xref="alg2.l3.m1.1.1.3.2.2.cmml">𝒈</mi><mrow id="alg2.l3.m1.1.1.3.3" xref="alg2.l3.m1.1.1.3.3.cmml"><mi id="alg2.l3.m1.1.1.3.3.2" xref="alg2.l3.m1.1.1.3.3.2.cmml">t</mi><mo id="alg2.l3.m1.1.1.3.3.1" lspace="0.278em" rspace="0.278em" xref="alg2.l3.m1.1.1.3.3.1.cmml">:</mo><mrow id="alg2.l3.m1.1.1.3.3.3" xref="alg2.l3.m1.1.1.3.3.3.cmml"><mi id="alg2.l3.m1.1.1.3.3.3.2" xref="alg2.l3.m1.1.1.3.3.3.2.cmml">t</mi><mo id="alg2.l3.m1.1.1.3.3.3.1" xref="alg2.l3.m1.1.1.3.3.3.1.cmml">+</mo><mi id="alg2.l3.m1.1.1.3.3.3.3" xref="alg2.l3.m1.1.1.3.3.3.3.cmml">H</mi></mrow></mrow><mtext id="alg2.l3.m1.1.1.3.2.3" xref="alg2.l3.m1.1.1.3.2.3a.cmml">plan</mtext></msubsup><mo id="alg2.l3.m1.1.1.2" xref="alg2.l3.m1.1.1.2.cmml">∼</mo><mrow id="alg2.l3.m1.1.1.1" xref="alg2.l3.m1.1.1.1.cmml"><msub id="alg2.l3.m1.1.1.1.3" xref="alg2.l3.m1.1.1.1.3.cmml"><mi id="alg2.l3.m1.1.1.1.3.2" xref="alg2.l3.m1.1.1.1.3.2.cmml">G</mi><mi id="alg2.l3.m1.1.1.1.3.3" xref="alg2.l3.m1.1.1.1.3.3.cmml">plan</mi></msub><mo id="alg2.l3.m1.1.1.1.2" xref="alg2.l3.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg2.l3.m1.1.1.1.1.1" xref="alg2.l3.m1.1.1.1.1.1.1.cmml"><mo id="alg2.l3.m1.1.1.1.1.1.2" stretchy="false" xref="alg2.l3.m1.1.1.1.1.1.1.cmml">(</mo><msub id="alg2.l3.m1.1.1.1.1.1.1" xref="alg2.l3.m1.1.1.1.1.1.1.cmml"><mi id="alg2.l3.m1.1.1.1.1.1.1.2" xref="alg2.l3.m1.1.1.1.1.1.1.2.cmml">𝒙</mi><mi id="alg2.l3.m1.1.1.1.1.1.1.3" xref="alg2.l3.m1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="alg2.l3.m1.1.1.1.1.1.3" stretchy="false" xref="alg2.l3.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l3.m1.1b"><apply id="alg2.l3.m1.1.1.cmml" xref="alg2.l3.m1.1.1"><csymbol cd="latexml" id="alg2.l3.m1.1.1.2.cmml" xref="alg2.l3.m1.1.1.2">similar-to</csymbol><apply id="alg2.l3.m1.1.1.3.cmml" xref="alg2.l3.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l3.m1.1.1.3.1.cmml" xref="alg2.l3.m1.1.1.3">subscript</csymbol><apply id="alg2.l3.m1.1.1.3.2.cmml" xref="alg2.l3.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l3.m1.1.1.3.2.1.cmml" xref="alg2.l3.m1.1.1.3">superscript</csymbol><ci id="alg2.l3.m1.1.1.3.2.2.cmml" xref="alg2.l3.m1.1.1.3.2.2">𝒈</ci><ci id="alg2.l3.m1.1.1.3.2.3a.cmml" xref="alg2.l3.m1.1.1.3.2.3"><mtext id="alg2.l3.m1.1.1.3.2.3.cmml" mathsize="70%" xref="alg2.l3.m1.1.1.3.2.3">plan</mtext></ci></apply><apply id="alg2.l3.m1.1.1.3.3.cmml" xref="alg2.l3.m1.1.1.3.3"><ci id="alg2.l3.m1.1.1.3.3.1.cmml" xref="alg2.l3.m1.1.1.3.3.1">:</ci><ci id="alg2.l3.m1.1.1.3.3.2.cmml" xref="alg2.l3.m1.1.1.3.3.2">𝑡</ci><apply id="alg2.l3.m1.1.1.3.3.3.cmml" xref="alg2.l3.m1.1.1.3.3.3"><plus id="alg2.l3.m1.1.1.3.3.3.1.cmml" xref="alg2.l3.m1.1.1.3.3.3.1"></plus><ci id="alg2.l3.m1.1.1.3.3.3.2.cmml" xref="alg2.l3.m1.1.1.3.3.3.2">𝑡</ci><ci id="alg2.l3.m1.1.1.3.3.3.3.cmml" xref="alg2.l3.m1.1.1.3.3.3.3">𝐻</ci></apply></apply></apply><apply id="alg2.l3.m1.1.1.1.cmml" xref="alg2.l3.m1.1.1.1"><times id="alg2.l3.m1.1.1.1.2.cmml" xref="alg2.l3.m1.1.1.1.2"></times><apply id="alg2.l3.m1.1.1.1.3.cmml" xref="alg2.l3.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l3.m1.1.1.1.3.1.cmml" xref="alg2.l3.m1.1.1.1.3">subscript</csymbol><ci id="alg2.l3.m1.1.1.1.3.2.cmml" xref="alg2.l3.m1.1.1.1.3.2">𝐺</ci><ci id="alg2.l3.m1.1.1.1.3.3.cmml" xref="alg2.l3.m1.1.1.1.3.3">plan</ci></apply><apply id="alg2.l3.m1.1.1.1.1.1.1.cmml" xref="alg2.l3.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l3.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l3.m1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l3.m1.1.1.1.1.1.1.2.cmml" xref="alg2.l3.m1.1.1.1.1.1.1.2">𝒙</ci><ci id="alg2.l3.m1.1.1.1.1.1.1.3.cmml" xref="alg2.l3.m1.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m1.1c">\boldsymbol{g}^{\text{plan}}_{t:t+H}\sim G_{\mathrm{plan}}(\boldsymbol{x}_{t})</annotation><annotation encoding="application/x-llamapun" id="alg2.l3.m1.1d">bold_italic_g start_POSTSUPERSCRIPT plan end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t : italic_t + italic_H end_POSTSUBSCRIPT ∼ italic_G start_POSTSUBSCRIPT roman_plan end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>;

</div>
<div class="ltx_listingline" id="alg2.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l4.1.1.1" style="font-size:80%;">4:</span></span>     Determine control input <math alttext="\boldsymbol{u}_{t}" class="ltx_Math" display="inline" id="alg2.l4.m1.1"><semantics id="alg2.l4.m1.1a"><msub id="alg2.l4.m1.1.1" xref="alg2.l4.m1.1.1.cmml"><mi id="alg2.l4.m1.1.1.2" xref="alg2.l4.m1.1.1.2.cmml">𝒖</mi><mi id="alg2.l4.m1.1.1.3" xref="alg2.l4.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.1b"><apply id="alg2.l4.m1.1.1.cmml" xref="alg2.l4.m1.1.1"><csymbol cd="ambiguous" id="alg2.l4.m1.1.1.1.cmml" xref="alg2.l4.m1.1.1">subscript</csymbol><ci id="alg2.l4.m1.1.1.2.cmml" xref="alg2.l4.m1.1.1.2">𝒖</ci><ci id="alg2.l4.m1.1.1.3.cmml" xref="alg2.l4.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.1c">\boldsymbol{u}_{t}</annotation><annotation encoding="application/x-llamapun" id="alg2.l4.m1.1d">bold_italic_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> according to MPC Eq.(<a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S3.E10" title="In 3.3 Model Predictive Control (MPC) ‣ 3 Preliminaries ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">10</span></a>) with estimated terminal value <math alttext="\hat{V}_{\theta}(\boldsymbol{x}_{t+H},\boldsymbol{g}^{\text{plan}}_{t+H})" class="ltx_Math" display="inline" id="alg2.l4.m2.2"><semantics id="alg2.l4.m2.2a"><mrow id="alg2.l4.m2.2.2" xref="alg2.l4.m2.2.2.cmml"><msub id="alg2.l4.m2.2.2.4" xref="alg2.l4.m2.2.2.4.cmml"><mover accent="true" id="alg2.l4.m2.2.2.4.2" xref="alg2.l4.m2.2.2.4.2.cmml"><mi id="alg2.l4.m2.2.2.4.2.2" xref="alg2.l4.m2.2.2.4.2.2.cmml">V</mi><mo id="alg2.l4.m2.2.2.4.2.1" xref="alg2.l4.m2.2.2.4.2.1.cmml">^</mo></mover><mi id="alg2.l4.m2.2.2.4.3" xref="alg2.l4.m2.2.2.4.3.cmml">θ</mi></msub><mo id="alg2.l4.m2.2.2.3" xref="alg2.l4.m2.2.2.3.cmml">⁢</mo><mrow id="alg2.l4.m2.2.2.2.2" xref="alg2.l4.m2.2.2.2.3.cmml"><mo id="alg2.l4.m2.2.2.2.2.3" stretchy="false" xref="alg2.l4.m2.2.2.2.3.cmml">(</mo><msub id="alg2.l4.m2.1.1.1.1.1" xref="alg2.l4.m2.1.1.1.1.1.cmml"><mi id="alg2.l4.m2.1.1.1.1.1.2" xref="alg2.l4.m2.1.1.1.1.1.2.cmml">𝒙</mi><mrow id="alg2.l4.m2.1.1.1.1.1.3" xref="alg2.l4.m2.1.1.1.1.1.3.cmml"><mi id="alg2.l4.m2.1.1.1.1.1.3.2" xref="alg2.l4.m2.1.1.1.1.1.3.2.cmml">t</mi><mo id="alg2.l4.m2.1.1.1.1.1.3.1" xref="alg2.l4.m2.1.1.1.1.1.3.1.cmml">+</mo><mi id="alg2.l4.m2.1.1.1.1.1.3.3" xref="alg2.l4.m2.1.1.1.1.1.3.3.cmml">H</mi></mrow></msub><mo id="alg2.l4.m2.2.2.2.2.4" xref="alg2.l4.m2.2.2.2.3.cmml">,</mo><msubsup id="alg2.l4.m2.2.2.2.2.2" xref="alg2.l4.m2.2.2.2.2.2.cmml"><mi id="alg2.l4.m2.2.2.2.2.2.2.2" xref="alg2.l4.m2.2.2.2.2.2.2.2.cmml">𝒈</mi><mrow id="alg2.l4.m2.2.2.2.2.2.3" xref="alg2.l4.m2.2.2.2.2.2.3.cmml"><mi id="alg2.l4.m2.2.2.2.2.2.3.2" xref="alg2.l4.m2.2.2.2.2.2.3.2.cmml">t</mi><mo id="alg2.l4.m2.2.2.2.2.2.3.1" xref="alg2.l4.m2.2.2.2.2.2.3.1.cmml">+</mo><mi id="alg2.l4.m2.2.2.2.2.2.3.3" xref="alg2.l4.m2.2.2.2.2.2.3.3.cmml">H</mi></mrow><mtext id="alg2.l4.m2.2.2.2.2.2.2.3" xref="alg2.l4.m2.2.2.2.2.2.2.3a.cmml">plan</mtext></msubsup><mo id="alg2.l4.m2.2.2.2.2.5" stretchy="false" xref="alg2.l4.m2.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l4.m2.2b"><apply id="alg2.l4.m2.2.2.cmml" xref="alg2.l4.m2.2.2"><times id="alg2.l4.m2.2.2.3.cmml" xref="alg2.l4.m2.2.2.3"></times><apply id="alg2.l4.m2.2.2.4.cmml" xref="alg2.l4.m2.2.2.4"><csymbol cd="ambiguous" id="alg2.l4.m2.2.2.4.1.cmml" xref="alg2.l4.m2.2.2.4">subscript</csymbol><apply id="alg2.l4.m2.2.2.4.2.cmml" xref="alg2.l4.m2.2.2.4.2"><ci id="alg2.l4.m2.2.2.4.2.1.cmml" xref="alg2.l4.m2.2.2.4.2.1">^</ci><ci id="alg2.l4.m2.2.2.4.2.2.cmml" xref="alg2.l4.m2.2.2.4.2.2">𝑉</ci></apply><ci id="alg2.l4.m2.2.2.4.3.cmml" xref="alg2.l4.m2.2.2.4.3">𝜃</ci></apply><interval closure="open" id="alg2.l4.m2.2.2.2.3.cmml" xref="alg2.l4.m2.2.2.2.2"><apply id="alg2.l4.m2.1.1.1.1.1.cmml" xref="alg2.l4.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l4.m2.1.1.1.1.1.1.cmml" xref="alg2.l4.m2.1.1.1.1.1">subscript</csymbol><ci id="alg2.l4.m2.1.1.1.1.1.2.cmml" xref="alg2.l4.m2.1.1.1.1.1.2">𝒙</ci><apply id="alg2.l4.m2.1.1.1.1.1.3.cmml" xref="alg2.l4.m2.1.1.1.1.1.3"><plus id="alg2.l4.m2.1.1.1.1.1.3.1.cmml" xref="alg2.l4.m2.1.1.1.1.1.3.1"></plus><ci id="alg2.l4.m2.1.1.1.1.1.3.2.cmml" xref="alg2.l4.m2.1.1.1.1.1.3.2">𝑡</ci><ci id="alg2.l4.m2.1.1.1.1.1.3.3.cmml" xref="alg2.l4.m2.1.1.1.1.1.3.3">𝐻</ci></apply></apply><apply id="alg2.l4.m2.2.2.2.2.2.cmml" xref="alg2.l4.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l4.m2.2.2.2.2.2.1.cmml" xref="alg2.l4.m2.2.2.2.2.2">subscript</csymbol><apply id="alg2.l4.m2.2.2.2.2.2.2.cmml" xref="alg2.l4.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l4.m2.2.2.2.2.2.2.1.cmml" xref="alg2.l4.m2.2.2.2.2.2">superscript</csymbol><ci id="alg2.l4.m2.2.2.2.2.2.2.2.cmml" xref="alg2.l4.m2.2.2.2.2.2.2.2">𝒈</ci><ci id="alg2.l4.m2.2.2.2.2.2.2.3a.cmml" xref="alg2.l4.m2.2.2.2.2.2.2.3"><mtext id="alg2.l4.m2.2.2.2.2.2.2.3.cmml" mathsize="70%" xref="alg2.l4.m2.2.2.2.2.2.2.3">plan</mtext></ci></apply><apply id="alg2.l4.m2.2.2.2.2.2.3.cmml" xref="alg2.l4.m2.2.2.2.2.2.3"><plus id="alg2.l4.m2.2.2.2.2.2.3.1.cmml" xref="alg2.l4.m2.2.2.2.2.2.3.1"></plus><ci id="alg2.l4.m2.2.2.2.2.2.3.2.cmml" xref="alg2.l4.m2.2.2.2.2.2.3.2">𝑡</ci><ci id="alg2.l4.m2.2.2.2.2.2.3.3.cmml" xref="alg2.l4.m2.2.2.2.2.2.3.3">𝐻</ci></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m2.2c">\hat{V}_{\theta}(\boldsymbol{x}_{t+H},\boldsymbol{g}^{\text{plan}}_{t+H})</annotation><annotation encoding="application/x-llamapun" id="alg2.l4.m2.2d">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUBSCRIPT italic_t + italic_H end_POSTSUBSCRIPT , bold_italic_g start_POSTSUPERSCRIPT plan end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t + italic_H end_POSTSUBSCRIPT )</annotation></semantics></math>;

</div>
<div class="ltx_listingline" id="alg2.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l5.1.1.1" style="font-size:80%;">5:</span></span>     Send <math alttext="\boldsymbol{u}_{t}" class="ltx_Math" display="inline" id="alg2.l5.m1.1"><semantics id="alg2.l5.m1.1a"><msub id="alg2.l5.m1.1.1" xref="alg2.l5.m1.1.1.cmml"><mi id="alg2.l5.m1.1.1.2" xref="alg2.l5.m1.1.1.2.cmml">𝒖</mi><mi id="alg2.l5.m1.1.1.3" xref="alg2.l5.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l5.m1.1b"><apply id="alg2.l5.m1.1.1.cmml" xref="alg2.l5.m1.1.1"><csymbol cd="ambiguous" id="alg2.l5.m1.1.1.1.cmml" xref="alg2.l5.m1.1.1">subscript</csymbol><ci id="alg2.l5.m1.1.1.2.cmml" xref="alg2.l5.m1.1.1.2">𝒖</ci><ci id="alg2.l5.m1.1.1.3.cmml" xref="alg2.l5.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m1.1c">\boldsymbol{u}_{t}</annotation><annotation encoding="application/x-llamapun" id="alg2.l5.m1.1d">bold_italic_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> to the actuators;

</div>
<div class="ltx_listingline" id="alg2.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l6.1.1.1" style="font-size:80%;">6:</span></span>     Check for task completion;

</div>
<div class="ltx_listingline" id="alg2.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l7.1.1.1" style="font-size:80%;">7:</span></span>  <span class="ltx_text ltx_font_bold" id="alg2.l7.2">end</span> <span class="ltx_text ltx_font_bold" id="alg2.l7.3">while</span>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Domain Randomization for Robust Value Function Estimation</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">To achieve robust terminal value estimation, we adopt the Domain Randomization (DR) approach. Commonly used in reinforcement learning, this method involves randomizing the simulation environment to train policies under various conditions. This helps in acquiring robust policies that can adapt to real-world scenarios during testing. The DR approach is widely applied, with randomization targets varying depending on the task. For instance, in manipulation tasks, modifying object coordinates, shapes, colors, and lighting conditions has resulted in robust policies that successfully transfer to real-world scenarios <cite class="ltx_cite ltx_citemacro_citep">(Tobin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib40" title="">2017</a>)</cite>. Additionally, randomizing the robot’s dynamics model—such as varying mass or motor control gains—has proven successful in real-world experiments <cite class="ltx_cite ltx_citemacro_citep">(Peng et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib33" title="">2018</a>)</cite>. Skills for cube manipulation have been developed using a robotic hand by randomizing both visual information and physical dynamics <cite class="ltx_cite ltx_citemacro_citep">(Andrychowicz et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib1" title="">2020</a>)</cite>. In this study, we randomize the terrain to ensure that the optimized policy becomes robust.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Faster MPC Calculation with a Surrogate Robot Model</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">Predicting the future state sequence of the robot is necessary for deriving the optimal controller in MPC, and faster numerical integration in the physical robot simulation is desirable to achieve this. We propose using a surrogate robot model instead of the actual robot model to accomplish this. The surrogate robot model has the same degrees of freedom as the actual robot system. This approach is advantageous because some mechanical structures, such as parallel link mechanisms, slow down numerical integration due to the need to satisfy closed-loop mechanical constraints. Specifically, in this study, we use a prismatic joint system as the surrogate model for a parallel-link legged mechanism to enable faster MPC calculations.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>The Bipedal Inverted Pendulum Robot</h3>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.5">In this study, we used a simulated model of the bipedal inverted pendulum robot Diablo developed by Direct Drive Technology <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib23" title="">2024</a>)</cite>. This robot model is implemented in the MuJoCo simulation environment <cite class="ltx_cite ltx_citemacro_citep">(Todorov et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib41" title="">2012</a>)</cite> (see also Fig.<a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S5.F3" title="Figure 3 ‣ 5.1 The Bipedal Inverted Pendulum Robot ‣ 5 Experiments ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">3</span></a>). The robot model has a state dimension of <math alttext="33" class="ltx_Math" display="inline" id="S5.SS1.p1.1.m1.1"><semantics id="S5.SS1.p1.1.m1.1a"><mn id="S5.SS1.p1.1.m1.1.1" xref="S5.SS1.p1.1.m1.1.1.cmml">33</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.m1.1b"><cn id="S5.SS1.p1.1.m1.1.1.cmml" type="integer" xref="S5.SS1.p1.1.m1.1.1">33</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.1.m1.1c">33</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.1.m1.1d">33</annotation></semantics></math>, and its control variables include joint angle commands to each motor and angular velocity commands for the wheels, which make up <math alttext="6" class="ltx_Math" display="inline" id="S5.SS1.p1.2.m2.1"><semantics id="S5.SS1.p1.2.m2.1a"><mn id="S5.SS1.p1.2.m2.1.1" xref="S5.SS1.p1.2.m2.1.1.cmml">6</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.2.m2.1b"><cn id="S5.SS1.p1.2.m2.1.1.cmml" type="integer" xref="S5.SS1.p1.2.m2.1.1">6</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.2.m2.1c">6</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.2.m2.1d">6</annotation></semantics></math> dimensions. In Fig.<a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S5.F3" title="Figure 3 ‣ 5.1 The Bipedal Inverted Pendulum Robot ‣ 5 Experiments ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">3</span></a>, <math alttext="q_{1}" class="ltx_Math" display="inline" id="S5.SS1.p1.3.m3.1"><semantics id="S5.SS1.p1.3.m3.1a"><msub id="S5.SS1.p1.3.m3.1.1" xref="S5.SS1.p1.3.m3.1.1.cmml"><mi id="S5.SS1.p1.3.m3.1.1.2" xref="S5.SS1.p1.3.m3.1.1.2.cmml">q</mi><mn id="S5.SS1.p1.3.m3.1.1.3" xref="S5.SS1.p1.3.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.3.m3.1b"><apply id="S5.SS1.p1.3.m3.1.1.cmml" xref="S5.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS1.p1.3.m3.1.1.1.cmml" xref="S5.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S5.SS1.p1.3.m3.1.1.2.cmml" xref="S5.SS1.p1.3.m3.1.1.2">𝑞</ci><cn id="S5.SS1.p1.3.m3.1.1.3.cmml" type="integer" xref="S5.SS1.p1.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.3.m3.1c">q_{1}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.3.m3.1d">italic_q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="q_{2}" class="ltx_Math" display="inline" id="S5.SS1.p1.4.m4.1"><semantics id="S5.SS1.p1.4.m4.1a"><msub id="S5.SS1.p1.4.m4.1.1" xref="S5.SS1.p1.4.m4.1.1.cmml"><mi id="S5.SS1.p1.4.m4.1.1.2" xref="S5.SS1.p1.4.m4.1.1.2.cmml">q</mi><mn id="S5.SS1.p1.4.m4.1.1.3" xref="S5.SS1.p1.4.m4.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.4.m4.1b"><apply id="S5.SS1.p1.4.m4.1.1.cmml" xref="S5.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS1.p1.4.m4.1.1.1.cmml" xref="S5.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S5.SS1.p1.4.m4.1.1.2.cmml" xref="S5.SS1.p1.4.m4.1.1.2">𝑞</ci><cn id="S5.SS1.p1.4.m4.1.1.3.cmml" type="integer" xref="S5.SS1.p1.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.4.m4.1c">q_{2}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.4.m4.1d">italic_q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> represent joint angles, and <math alttext="\omega_{\mathrm{wheel}}" class="ltx_Math" display="inline" id="S5.SS1.p1.5.m5.1"><semantics id="S5.SS1.p1.5.m5.1a"><msub id="S5.SS1.p1.5.m5.1.1" xref="S5.SS1.p1.5.m5.1.1.cmml"><mi id="S5.SS1.p1.5.m5.1.1.2" xref="S5.SS1.p1.5.m5.1.1.2.cmml">ω</mi><mi id="S5.SS1.p1.5.m5.1.1.3" xref="S5.SS1.p1.5.m5.1.1.3.cmml">wheel</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.5.m5.1b"><apply id="S5.SS1.p1.5.m5.1.1.cmml" xref="S5.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S5.SS1.p1.5.m5.1.1.1.cmml" xref="S5.SS1.p1.5.m5.1.1">subscript</csymbol><ci id="S5.SS1.p1.5.m5.1.1.2.cmml" xref="S5.SS1.p1.5.m5.1.1.2">𝜔</ci><ci id="S5.SS1.p1.5.m5.1.1.3.cmml" xref="S5.SS1.p1.5.m5.1.1.3">wheel</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.5.m5.1c">\omega_{\mathrm{wheel}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.5.m5.1d">italic_ω start_POSTSUBSCRIPT roman_wheel end_POSTSUBSCRIPT</annotation></semantics></math> denotes the angular velocities of the wheels.</p>
</div>
<figure class="ltx_figure" id="S5.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" id="S5.F3.sf1" style="width:216.8pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="633" id="S5.F3.sf1.g1" src="x3.png" width="581"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F3.sf1.2.1.1" style="font-size:90%;">(a)</span> </span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" id="S5.F3.sf2" style="width:173.4pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="889" id="S5.F3.sf2.g1" src="x4.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F3.sf2.2.1.1" style="font-size:90%;">(b)</span> </span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F3.8.4.1" style="font-size:90%;">Figure 3</span>: </span><span class="ltx_text" id="S5.F3.6.3" style="font-size:90%;">Simulated robot model. <math alttext="q_{1}" class="ltx_Math" display="inline" id="S5.F3.4.1.m1.1"><semantics id="S5.F3.4.1.m1.1b"><msub id="S5.F3.4.1.m1.1.1" xref="S5.F3.4.1.m1.1.1.cmml"><mi id="S5.F3.4.1.m1.1.1.2" xref="S5.F3.4.1.m1.1.1.2.cmml">q</mi><mn id="S5.F3.4.1.m1.1.1.3" xref="S5.F3.4.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S5.F3.4.1.m1.1c"><apply id="S5.F3.4.1.m1.1.1.cmml" xref="S5.F3.4.1.m1.1.1"><csymbol cd="ambiguous" id="S5.F3.4.1.m1.1.1.1.cmml" xref="S5.F3.4.1.m1.1.1">subscript</csymbol><ci id="S5.F3.4.1.m1.1.1.2.cmml" xref="S5.F3.4.1.m1.1.1.2">𝑞</ci><cn id="S5.F3.4.1.m1.1.1.3.cmml" type="integer" xref="S5.F3.4.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F3.4.1.m1.1d">q_{1}</annotation><annotation encoding="application/x-llamapun" id="S5.F3.4.1.m1.1e">italic_q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="q_{2}" class="ltx_Math" display="inline" id="S5.F3.5.2.m2.1"><semantics id="S5.F3.5.2.m2.1b"><msub id="S5.F3.5.2.m2.1.1" xref="S5.F3.5.2.m2.1.1.cmml"><mi id="S5.F3.5.2.m2.1.1.2" xref="S5.F3.5.2.m2.1.1.2.cmml">q</mi><mn id="S5.F3.5.2.m2.1.1.3" xref="S5.F3.5.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S5.F3.5.2.m2.1c"><apply id="S5.F3.5.2.m2.1.1.cmml" xref="S5.F3.5.2.m2.1.1"><csymbol cd="ambiguous" id="S5.F3.5.2.m2.1.1.1.cmml" xref="S5.F3.5.2.m2.1.1">subscript</csymbol><ci id="S5.F3.5.2.m2.1.1.2.cmml" xref="S5.F3.5.2.m2.1.1.2">𝑞</ci><cn id="S5.F3.5.2.m2.1.1.3.cmml" type="integer" xref="S5.F3.5.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F3.5.2.m2.1d">q_{2}</annotation><annotation encoding="application/x-llamapun" id="S5.F3.5.2.m2.1e">italic_q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> represent joint angles, and <math alttext="\omega_{\mathrm{wheel}}" class="ltx_Math" display="inline" id="S5.F3.6.3.m3.1"><semantics id="S5.F3.6.3.m3.1b"><msub id="S5.F3.6.3.m3.1.1" xref="S5.F3.6.3.m3.1.1.cmml"><mi id="S5.F3.6.3.m3.1.1.2" xref="S5.F3.6.3.m3.1.1.2.cmml">ω</mi><mi id="S5.F3.6.3.m3.1.1.3" xref="S5.F3.6.3.m3.1.1.3.cmml">wheel</mi></msub><annotation-xml encoding="MathML-Content" id="S5.F3.6.3.m3.1c"><apply id="S5.F3.6.3.m3.1.1.cmml" xref="S5.F3.6.3.m3.1.1"><csymbol cd="ambiguous" id="S5.F3.6.3.m3.1.1.1.cmml" xref="S5.F3.6.3.m3.1.1">subscript</csymbol><ci id="S5.F3.6.3.m3.1.1.2.cmml" xref="S5.F3.6.3.m3.1.1.2">𝜔</ci><ci id="S5.F3.6.3.m3.1.1.3.cmml" xref="S5.F3.6.3.m3.1.1.3">wheel</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F3.6.3.m3.1d">\omega_{\mathrm{wheel}}</annotation><annotation encoding="application/x-llamapun" id="S5.F3.6.3.m3.1e">italic_ω start_POSTSUBSCRIPT roman_wheel end_POSTSUBSCRIPT</annotation></semantics></math> denotes the angular velocities of the wheels.</span></figcaption>
</figure>
<div class="ltx_para" id="S5.SS1.p2">
<p class="ltx_p" id="S5.SS1.p2.8">We test the proposed method with locomotion tasks on flat and sloped terrains depicted in Fig.<a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S5.F4" title="Figure 4 ‣ 5.2 Path Tracking Tasks ‣ 5 Experiments ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">4</span></a>.
The goal variables are set as <math alttext="\boldsymbol{g}_{t}=[v_{t},\omega_{t}]" class="ltx_Math" display="inline" id="S5.SS1.p2.1.m1.2"><semantics id="S5.SS1.p2.1.m1.2a"><mrow id="S5.SS1.p2.1.m1.2.2" xref="S5.SS1.p2.1.m1.2.2.cmml"><msub id="S5.SS1.p2.1.m1.2.2.4" xref="S5.SS1.p2.1.m1.2.2.4.cmml"><mi id="S5.SS1.p2.1.m1.2.2.4.2" xref="S5.SS1.p2.1.m1.2.2.4.2.cmml">𝒈</mi><mi id="S5.SS1.p2.1.m1.2.2.4.3" xref="S5.SS1.p2.1.m1.2.2.4.3.cmml">t</mi></msub><mo id="S5.SS1.p2.1.m1.2.2.3" xref="S5.SS1.p2.1.m1.2.2.3.cmml">=</mo><mrow id="S5.SS1.p2.1.m1.2.2.2.2" xref="S5.SS1.p2.1.m1.2.2.2.3.cmml"><mo id="S5.SS1.p2.1.m1.2.2.2.2.3" stretchy="false" xref="S5.SS1.p2.1.m1.2.2.2.3.cmml">[</mo><msub id="S5.SS1.p2.1.m1.1.1.1.1.1" xref="S5.SS1.p2.1.m1.1.1.1.1.1.cmml"><mi id="S5.SS1.p2.1.m1.1.1.1.1.1.2" xref="S5.SS1.p2.1.m1.1.1.1.1.1.2.cmml">v</mi><mi id="S5.SS1.p2.1.m1.1.1.1.1.1.3" xref="S5.SS1.p2.1.m1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S5.SS1.p2.1.m1.2.2.2.2.4" xref="S5.SS1.p2.1.m1.2.2.2.3.cmml">,</mo><msub id="S5.SS1.p2.1.m1.2.2.2.2.2" xref="S5.SS1.p2.1.m1.2.2.2.2.2.cmml"><mi id="S5.SS1.p2.1.m1.2.2.2.2.2.2" xref="S5.SS1.p2.1.m1.2.2.2.2.2.2.cmml">ω</mi><mi id="S5.SS1.p2.1.m1.2.2.2.2.2.3" xref="S5.SS1.p2.1.m1.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S5.SS1.p2.1.m1.2.2.2.2.5" stretchy="false" xref="S5.SS1.p2.1.m1.2.2.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.1.m1.2b"><apply id="S5.SS1.p2.1.m1.2.2.cmml" xref="S5.SS1.p2.1.m1.2.2"><eq id="S5.SS1.p2.1.m1.2.2.3.cmml" xref="S5.SS1.p2.1.m1.2.2.3"></eq><apply id="S5.SS1.p2.1.m1.2.2.4.cmml" xref="S5.SS1.p2.1.m1.2.2.4"><csymbol cd="ambiguous" id="S5.SS1.p2.1.m1.2.2.4.1.cmml" xref="S5.SS1.p2.1.m1.2.2.4">subscript</csymbol><ci id="S5.SS1.p2.1.m1.2.2.4.2.cmml" xref="S5.SS1.p2.1.m1.2.2.4.2">𝒈</ci><ci id="S5.SS1.p2.1.m1.2.2.4.3.cmml" xref="S5.SS1.p2.1.m1.2.2.4.3">𝑡</ci></apply><interval closure="closed" id="S5.SS1.p2.1.m1.2.2.2.3.cmml" xref="S5.SS1.p2.1.m1.2.2.2.2"><apply id="S5.SS1.p2.1.m1.1.1.1.1.1.cmml" xref="S5.SS1.p2.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.1.m1.1.1.1.1.1.1.cmml" xref="S5.SS1.p2.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S5.SS1.p2.1.m1.1.1.1.1.1.2.cmml" xref="S5.SS1.p2.1.m1.1.1.1.1.1.2">𝑣</ci><ci id="S5.SS1.p2.1.m1.1.1.1.1.1.3.cmml" xref="S5.SS1.p2.1.m1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S5.SS1.p2.1.m1.2.2.2.2.2.cmml" xref="S5.SS1.p2.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S5.SS1.p2.1.m1.2.2.2.2.2.1.cmml" xref="S5.SS1.p2.1.m1.2.2.2.2.2">subscript</csymbol><ci id="S5.SS1.p2.1.m1.2.2.2.2.2.2.cmml" xref="S5.SS1.p2.1.m1.2.2.2.2.2.2">𝜔</ci><ci id="S5.SS1.p2.1.m1.2.2.2.2.2.3.cmml" xref="S5.SS1.p2.1.m1.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.1.m1.2c">\boldsymbol{g}_{t}=[v_{t},\omega_{t}]</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p2.1.m1.2d">bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = [ italic_v start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_ω start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ]</annotation></semantics></math> for the flat surface and <math alttext="\boldsymbol{g}_{t}=[v_{t},\omega_{t},\alpha_{t}]" class="ltx_Math" display="inline" id="S5.SS1.p2.2.m2.3"><semantics id="S5.SS1.p2.2.m2.3a"><mrow id="S5.SS1.p2.2.m2.3.3" xref="S5.SS1.p2.2.m2.3.3.cmml"><msub id="S5.SS1.p2.2.m2.3.3.5" xref="S5.SS1.p2.2.m2.3.3.5.cmml"><mi id="S5.SS1.p2.2.m2.3.3.5.2" xref="S5.SS1.p2.2.m2.3.3.5.2.cmml">𝒈</mi><mi id="S5.SS1.p2.2.m2.3.3.5.3" xref="S5.SS1.p2.2.m2.3.3.5.3.cmml">t</mi></msub><mo id="S5.SS1.p2.2.m2.3.3.4" xref="S5.SS1.p2.2.m2.3.3.4.cmml">=</mo><mrow id="S5.SS1.p2.2.m2.3.3.3.3" xref="S5.SS1.p2.2.m2.3.3.3.4.cmml"><mo id="S5.SS1.p2.2.m2.3.3.3.3.4" stretchy="false" xref="S5.SS1.p2.2.m2.3.3.3.4.cmml">[</mo><msub id="S5.SS1.p2.2.m2.1.1.1.1.1" xref="S5.SS1.p2.2.m2.1.1.1.1.1.cmml"><mi id="S5.SS1.p2.2.m2.1.1.1.1.1.2" xref="S5.SS1.p2.2.m2.1.1.1.1.1.2.cmml">v</mi><mi id="S5.SS1.p2.2.m2.1.1.1.1.1.3" xref="S5.SS1.p2.2.m2.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S5.SS1.p2.2.m2.3.3.3.3.5" xref="S5.SS1.p2.2.m2.3.3.3.4.cmml">,</mo><msub id="S5.SS1.p2.2.m2.2.2.2.2.2" xref="S5.SS1.p2.2.m2.2.2.2.2.2.cmml"><mi id="S5.SS1.p2.2.m2.2.2.2.2.2.2" xref="S5.SS1.p2.2.m2.2.2.2.2.2.2.cmml">ω</mi><mi id="S5.SS1.p2.2.m2.2.2.2.2.2.3" xref="S5.SS1.p2.2.m2.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S5.SS1.p2.2.m2.3.3.3.3.6" xref="S5.SS1.p2.2.m2.3.3.3.4.cmml">,</mo><msub id="S5.SS1.p2.2.m2.3.3.3.3.3" xref="S5.SS1.p2.2.m2.3.3.3.3.3.cmml"><mi id="S5.SS1.p2.2.m2.3.3.3.3.3.2" xref="S5.SS1.p2.2.m2.3.3.3.3.3.2.cmml">α</mi><mi id="S5.SS1.p2.2.m2.3.3.3.3.3.3" xref="S5.SS1.p2.2.m2.3.3.3.3.3.3.cmml">t</mi></msub><mo id="S5.SS1.p2.2.m2.3.3.3.3.7" stretchy="false" xref="S5.SS1.p2.2.m2.3.3.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.2.m2.3b"><apply id="S5.SS1.p2.2.m2.3.3.cmml" xref="S5.SS1.p2.2.m2.3.3"><eq id="S5.SS1.p2.2.m2.3.3.4.cmml" xref="S5.SS1.p2.2.m2.3.3.4"></eq><apply id="S5.SS1.p2.2.m2.3.3.5.cmml" xref="S5.SS1.p2.2.m2.3.3.5"><csymbol cd="ambiguous" id="S5.SS1.p2.2.m2.3.3.5.1.cmml" xref="S5.SS1.p2.2.m2.3.3.5">subscript</csymbol><ci id="S5.SS1.p2.2.m2.3.3.5.2.cmml" xref="S5.SS1.p2.2.m2.3.3.5.2">𝒈</ci><ci id="S5.SS1.p2.2.m2.3.3.5.3.cmml" xref="S5.SS1.p2.2.m2.3.3.5.3">𝑡</ci></apply><list id="S5.SS1.p2.2.m2.3.3.3.4.cmml" xref="S5.SS1.p2.2.m2.3.3.3.3"><apply id="S5.SS1.p2.2.m2.1.1.1.1.1.cmml" xref="S5.SS1.p2.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.2.m2.1.1.1.1.1.1.cmml" xref="S5.SS1.p2.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S5.SS1.p2.2.m2.1.1.1.1.1.2.cmml" xref="S5.SS1.p2.2.m2.1.1.1.1.1.2">𝑣</ci><ci id="S5.SS1.p2.2.m2.1.1.1.1.1.3.cmml" xref="S5.SS1.p2.2.m2.1.1.1.1.1.3">𝑡</ci></apply><apply id="S5.SS1.p2.2.m2.2.2.2.2.2.cmml" xref="S5.SS1.p2.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S5.SS1.p2.2.m2.2.2.2.2.2.1.cmml" xref="S5.SS1.p2.2.m2.2.2.2.2.2">subscript</csymbol><ci id="S5.SS1.p2.2.m2.2.2.2.2.2.2.cmml" xref="S5.SS1.p2.2.m2.2.2.2.2.2.2">𝜔</ci><ci id="S5.SS1.p2.2.m2.2.2.2.2.2.3.cmml" xref="S5.SS1.p2.2.m2.2.2.2.2.2.3">𝑡</ci></apply><apply id="S5.SS1.p2.2.m2.3.3.3.3.3.cmml" xref="S5.SS1.p2.2.m2.3.3.3.3.3"><csymbol cd="ambiguous" id="S5.SS1.p2.2.m2.3.3.3.3.3.1.cmml" xref="S5.SS1.p2.2.m2.3.3.3.3.3">subscript</csymbol><ci id="S5.SS1.p2.2.m2.3.3.3.3.3.2.cmml" xref="S5.SS1.p2.2.m2.3.3.3.3.3.2">𝛼</ci><ci id="S5.SS1.p2.2.m2.3.3.3.3.3.3.cmml" xref="S5.SS1.p2.2.m2.3.3.3.3.3.3">𝑡</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.2.m2.3c">\boldsymbol{g}_{t}=[v_{t},\omega_{t},\alpha_{t}]</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p2.2.m2.3d">bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = [ italic_v start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_ω start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ]</annotation></semantics></math> for the sloped surface, and the network model in the lower layer learns the terminal values based on Eqs. (<a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S4.E11" title="In 4.1 Lower Layer ‣ 4 Method ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">11</span></a>) and (<a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S4.E12" title="In 4.1 Lower Layer ‣ 4 Method ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">12</span></a>). Here, <math alttext="v_{t}" class="ltx_Math" display="inline" id="S5.SS1.p2.3.m3.1"><semantics id="S5.SS1.p2.3.m3.1a"><msub id="S5.SS1.p2.3.m3.1.1" xref="S5.SS1.p2.3.m3.1.1.cmml"><mi id="S5.SS1.p2.3.m3.1.1.2" xref="S5.SS1.p2.3.m3.1.1.2.cmml">v</mi><mi id="S5.SS1.p2.3.m3.1.1.3" xref="S5.SS1.p2.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.3.m3.1b"><apply id="S5.SS1.p2.3.m3.1.1.cmml" xref="S5.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.3.m3.1.1.1.cmml" xref="S5.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="S5.SS1.p2.3.m3.1.1.2.cmml" xref="S5.SS1.p2.3.m3.1.1.2">𝑣</ci><ci id="S5.SS1.p2.3.m3.1.1.3.cmml" xref="S5.SS1.p2.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.3.m3.1c">v_{t}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p2.3.m3.1d">italic_v start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\omega_{t}" class="ltx_Math" display="inline" id="S5.SS1.p2.4.m4.1"><semantics id="S5.SS1.p2.4.m4.1a"><msub id="S5.SS1.p2.4.m4.1.1" xref="S5.SS1.p2.4.m4.1.1.cmml"><mi id="S5.SS1.p2.4.m4.1.1.2" xref="S5.SS1.p2.4.m4.1.1.2.cmml">ω</mi><mi id="S5.SS1.p2.4.m4.1.1.3" xref="S5.SS1.p2.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.4.m4.1b"><apply id="S5.SS1.p2.4.m4.1.1.cmml" xref="S5.SS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.4.m4.1.1.1.cmml" xref="S5.SS1.p2.4.m4.1.1">subscript</csymbol><ci id="S5.SS1.p2.4.m4.1.1.2.cmml" xref="S5.SS1.p2.4.m4.1.1.2">𝜔</ci><ci id="S5.SS1.p2.4.m4.1.1.3.cmml" xref="S5.SS1.p2.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.4.m4.1c">\omega_{t}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p2.4.m4.1d">italic_ω start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\alpha_{t}" class="ltx_Math" display="inline" id="S5.SS1.p2.5.m5.1"><semantics id="S5.SS1.p2.5.m5.1a"><msub id="S5.SS1.p2.5.m5.1.1" xref="S5.SS1.p2.5.m5.1.1.cmml"><mi id="S5.SS1.p2.5.m5.1.1.2" xref="S5.SS1.p2.5.m5.1.1.2.cmml">α</mi><mi id="S5.SS1.p2.5.m5.1.1.3" xref="S5.SS1.p2.5.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.5.m5.1b"><apply id="S5.SS1.p2.5.m5.1.1.cmml" xref="S5.SS1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.5.m5.1.1.1.cmml" xref="S5.SS1.p2.5.m5.1.1">subscript</csymbol><ci id="S5.SS1.p2.5.m5.1.1.2.cmml" xref="S5.SS1.p2.5.m5.1.1.2">𝛼</ci><ci id="S5.SS1.p2.5.m5.1.1.3.cmml" xref="S5.SS1.p2.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.5.m5.1c">\alpha_{t}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p2.5.m5.1d">italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> represent the robot’s velocity, angular velocity, and the angle of the slope the robot is facing at time <math alttext="t" class="ltx_Math" display="inline" id="S5.SS1.p2.6.m6.1"><semantics id="S5.SS1.p2.6.m6.1a"><mi id="S5.SS1.p2.6.m6.1.1" xref="S5.SS1.p2.6.m6.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.6.m6.1b"><ci id="S5.SS1.p2.6.m6.1.1.cmml" xref="S5.SS1.p2.6.m6.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.6.m6.1c">t</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p2.6.m6.1d">italic_t</annotation></semantics></math>, respectively.
During inference, a reference trajectory is provided, and the trajectory generator in the upper layer produces goal variable sequences according to the current robot state. We use the Kanayama Control algorithm <cite class="ltx_cite ltx_citemacro_citep">(Kanayama et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib18" title="">1990</a>)</cite>, which is widely used for controlling mobile robots, as the trajectory generator. By using the Kanayama control, a series of goal variable sequences over the horizon <math alttext="\boldsymbol{g}^{\mathrm{plan}}_{t:t+H}=[v_{t:t+H},\omega_{t:t+H}]" class="ltx_Math" display="inline" id="S5.SS1.p2.7.m7.2"><semantics id="S5.SS1.p2.7.m7.2a"><mrow id="S5.SS1.p2.7.m7.2.2" xref="S5.SS1.p2.7.m7.2.2.cmml"><msubsup id="S5.SS1.p2.7.m7.2.2.4" xref="S5.SS1.p2.7.m7.2.2.4.cmml"><mi id="S5.SS1.p2.7.m7.2.2.4.2.2" xref="S5.SS1.p2.7.m7.2.2.4.2.2.cmml">𝒈</mi><mrow id="S5.SS1.p2.7.m7.2.2.4.3" xref="S5.SS1.p2.7.m7.2.2.4.3.cmml"><mi id="S5.SS1.p2.7.m7.2.2.4.3.2" xref="S5.SS1.p2.7.m7.2.2.4.3.2.cmml">t</mi><mo id="S5.SS1.p2.7.m7.2.2.4.3.1" lspace="0.278em" rspace="0.278em" xref="S5.SS1.p2.7.m7.2.2.4.3.1.cmml">:</mo><mrow id="S5.SS1.p2.7.m7.2.2.4.3.3" xref="S5.SS1.p2.7.m7.2.2.4.3.3.cmml"><mi id="S5.SS1.p2.7.m7.2.2.4.3.3.2" xref="S5.SS1.p2.7.m7.2.2.4.3.3.2.cmml">t</mi><mo id="S5.SS1.p2.7.m7.2.2.4.3.3.1" xref="S5.SS1.p2.7.m7.2.2.4.3.3.1.cmml">+</mo><mi id="S5.SS1.p2.7.m7.2.2.4.3.3.3" xref="S5.SS1.p2.7.m7.2.2.4.3.3.3.cmml">H</mi></mrow></mrow><mi id="S5.SS1.p2.7.m7.2.2.4.2.3" xref="S5.SS1.p2.7.m7.2.2.4.2.3.cmml">plan</mi></msubsup><mo id="S5.SS1.p2.7.m7.2.2.3" xref="S5.SS1.p2.7.m7.2.2.3.cmml">=</mo><mrow id="S5.SS1.p2.7.m7.2.2.2.2" xref="S5.SS1.p2.7.m7.2.2.2.3.cmml"><mo id="S5.SS1.p2.7.m7.2.2.2.2.3" stretchy="false" xref="S5.SS1.p2.7.m7.2.2.2.3.cmml">[</mo><msub id="S5.SS1.p2.7.m7.1.1.1.1.1" xref="S5.SS1.p2.7.m7.1.1.1.1.1.cmml"><mi id="S5.SS1.p2.7.m7.1.1.1.1.1.2" xref="S5.SS1.p2.7.m7.1.1.1.1.1.2.cmml">v</mi><mrow id="S5.SS1.p2.7.m7.1.1.1.1.1.3" xref="S5.SS1.p2.7.m7.1.1.1.1.1.3.cmml"><mi id="S5.SS1.p2.7.m7.1.1.1.1.1.3.2" xref="S5.SS1.p2.7.m7.1.1.1.1.1.3.2.cmml">t</mi><mo id="S5.SS1.p2.7.m7.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S5.SS1.p2.7.m7.1.1.1.1.1.3.1.cmml">:</mo><mrow id="S5.SS1.p2.7.m7.1.1.1.1.1.3.3" xref="S5.SS1.p2.7.m7.1.1.1.1.1.3.3.cmml"><mi id="S5.SS1.p2.7.m7.1.1.1.1.1.3.3.2" xref="S5.SS1.p2.7.m7.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="S5.SS1.p2.7.m7.1.1.1.1.1.3.3.1" xref="S5.SS1.p2.7.m7.1.1.1.1.1.3.3.1.cmml">+</mo><mi id="S5.SS1.p2.7.m7.1.1.1.1.1.3.3.3" xref="S5.SS1.p2.7.m7.1.1.1.1.1.3.3.3.cmml">H</mi></mrow></mrow></msub><mo id="S5.SS1.p2.7.m7.2.2.2.2.4" xref="S5.SS1.p2.7.m7.2.2.2.3.cmml">,</mo><msub id="S5.SS1.p2.7.m7.2.2.2.2.2" xref="S5.SS1.p2.7.m7.2.2.2.2.2.cmml"><mi id="S5.SS1.p2.7.m7.2.2.2.2.2.2" xref="S5.SS1.p2.7.m7.2.2.2.2.2.2.cmml">ω</mi><mrow id="S5.SS1.p2.7.m7.2.2.2.2.2.3" xref="S5.SS1.p2.7.m7.2.2.2.2.2.3.cmml"><mi id="S5.SS1.p2.7.m7.2.2.2.2.2.3.2" xref="S5.SS1.p2.7.m7.2.2.2.2.2.3.2.cmml">t</mi><mo id="S5.SS1.p2.7.m7.2.2.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S5.SS1.p2.7.m7.2.2.2.2.2.3.1.cmml">:</mo><mrow id="S5.SS1.p2.7.m7.2.2.2.2.2.3.3" xref="S5.SS1.p2.7.m7.2.2.2.2.2.3.3.cmml"><mi id="S5.SS1.p2.7.m7.2.2.2.2.2.3.3.2" xref="S5.SS1.p2.7.m7.2.2.2.2.2.3.3.2.cmml">t</mi><mo id="S5.SS1.p2.7.m7.2.2.2.2.2.3.3.1" xref="S5.SS1.p2.7.m7.2.2.2.2.2.3.3.1.cmml">+</mo><mi id="S5.SS1.p2.7.m7.2.2.2.2.2.3.3.3" xref="S5.SS1.p2.7.m7.2.2.2.2.2.3.3.3.cmml">H</mi></mrow></mrow></msub><mo id="S5.SS1.p2.7.m7.2.2.2.2.5" stretchy="false" xref="S5.SS1.p2.7.m7.2.2.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.7.m7.2b"><apply id="S5.SS1.p2.7.m7.2.2.cmml" xref="S5.SS1.p2.7.m7.2.2"><eq id="S5.SS1.p2.7.m7.2.2.3.cmml" xref="S5.SS1.p2.7.m7.2.2.3"></eq><apply id="S5.SS1.p2.7.m7.2.2.4.cmml" xref="S5.SS1.p2.7.m7.2.2.4"><csymbol cd="ambiguous" id="S5.SS1.p2.7.m7.2.2.4.1.cmml" xref="S5.SS1.p2.7.m7.2.2.4">subscript</csymbol><apply id="S5.SS1.p2.7.m7.2.2.4.2.cmml" xref="S5.SS1.p2.7.m7.2.2.4"><csymbol cd="ambiguous" id="S5.SS1.p2.7.m7.2.2.4.2.1.cmml" xref="S5.SS1.p2.7.m7.2.2.4">superscript</csymbol><ci id="S5.SS1.p2.7.m7.2.2.4.2.2.cmml" xref="S5.SS1.p2.7.m7.2.2.4.2.2">𝒈</ci><ci id="S5.SS1.p2.7.m7.2.2.4.2.3.cmml" xref="S5.SS1.p2.7.m7.2.2.4.2.3">plan</ci></apply><apply id="S5.SS1.p2.7.m7.2.2.4.3.cmml" xref="S5.SS1.p2.7.m7.2.2.4.3"><ci id="S5.SS1.p2.7.m7.2.2.4.3.1.cmml" xref="S5.SS1.p2.7.m7.2.2.4.3.1">:</ci><ci id="S5.SS1.p2.7.m7.2.2.4.3.2.cmml" xref="S5.SS1.p2.7.m7.2.2.4.3.2">𝑡</ci><apply id="S5.SS1.p2.7.m7.2.2.4.3.3.cmml" xref="S5.SS1.p2.7.m7.2.2.4.3.3"><plus id="S5.SS1.p2.7.m7.2.2.4.3.3.1.cmml" xref="S5.SS1.p2.7.m7.2.2.4.3.3.1"></plus><ci id="S5.SS1.p2.7.m7.2.2.4.3.3.2.cmml" xref="S5.SS1.p2.7.m7.2.2.4.3.3.2">𝑡</ci><ci id="S5.SS1.p2.7.m7.2.2.4.3.3.3.cmml" xref="S5.SS1.p2.7.m7.2.2.4.3.3.3">𝐻</ci></apply></apply></apply><interval closure="closed" id="S5.SS1.p2.7.m7.2.2.2.3.cmml" xref="S5.SS1.p2.7.m7.2.2.2.2"><apply id="S5.SS1.p2.7.m7.1.1.1.1.1.cmml" xref="S5.SS1.p2.7.m7.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.7.m7.1.1.1.1.1.1.cmml" xref="S5.SS1.p2.7.m7.1.1.1.1.1">subscript</csymbol><ci id="S5.SS1.p2.7.m7.1.1.1.1.1.2.cmml" xref="S5.SS1.p2.7.m7.1.1.1.1.1.2">𝑣</ci><apply id="S5.SS1.p2.7.m7.1.1.1.1.1.3.cmml" xref="S5.SS1.p2.7.m7.1.1.1.1.1.3"><ci id="S5.SS1.p2.7.m7.1.1.1.1.1.3.1.cmml" xref="S5.SS1.p2.7.m7.1.1.1.1.1.3.1">:</ci><ci id="S5.SS1.p2.7.m7.1.1.1.1.1.3.2.cmml" xref="S5.SS1.p2.7.m7.1.1.1.1.1.3.2">𝑡</ci><apply id="S5.SS1.p2.7.m7.1.1.1.1.1.3.3.cmml" xref="S5.SS1.p2.7.m7.1.1.1.1.1.3.3"><plus id="S5.SS1.p2.7.m7.1.1.1.1.1.3.3.1.cmml" xref="S5.SS1.p2.7.m7.1.1.1.1.1.3.3.1"></plus><ci id="S5.SS1.p2.7.m7.1.1.1.1.1.3.3.2.cmml" xref="S5.SS1.p2.7.m7.1.1.1.1.1.3.3.2">𝑡</ci><ci id="S5.SS1.p2.7.m7.1.1.1.1.1.3.3.3.cmml" xref="S5.SS1.p2.7.m7.1.1.1.1.1.3.3.3">𝐻</ci></apply></apply></apply><apply id="S5.SS1.p2.7.m7.2.2.2.2.2.cmml" xref="S5.SS1.p2.7.m7.2.2.2.2.2"><csymbol cd="ambiguous" id="S5.SS1.p2.7.m7.2.2.2.2.2.1.cmml" xref="S5.SS1.p2.7.m7.2.2.2.2.2">subscript</csymbol><ci id="S5.SS1.p2.7.m7.2.2.2.2.2.2.cmml" xref="S5.SS1.p2.7.m7.2.2.2.2.2.2">𝜔</ci><apply id="S5.SS1.p2.7.m7.2.2.2.2.2.3.cmml" xref="S5.SS1.p2.7.m7.2.2.2.2.2.3"><ci id="S5.SS1.p2.7.m7.2.2.2.2.2.3.1.cmml" xref="S5.SS1.p2.7.m7.2.2.2.2.2.3.1">:</ci><ci id="S5.SS1.p2.7.m7.2.2.2.2.2.3.2.cmml" xref="S5.SS1.p2.7.m7.2.2.2.2.2.3.2">𝑡</ci><apply id="S5.SS1.p2.7.m7.2.2.2.2.2.3.3.cmml" xref="S5.SS1.p2.7.m7.2.2.2.2.2.3.3"><plus id="S5.SS1.p2.7.m7.2.2.2.2.2.3.3.1.cmml" xref="S5.SS1.p2.7.m7.2.2.2.2.2.3.3.1"></plus><ci id="S5.SS1.p2.7.m7.2.2.2.2.2.3.3.2.cmml" xref="S5.SS1.p2.7.m7.2.2.2.2.2.3.3.2">𝑡</ci><ci id="S5.SS1.p2.7.m7.2.2.2.2.2.3.3.3.cmml" xref="S5.SS1.p2.7.m7.2.2.2.2.2.3.3.3">𝐻</ci></apply></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.7.m7.2c">\boldsymbol{g}^{\mathrm{plan}}_{t:t+H}=[v_{t:t+H},\omega_{t:t+H}]</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p2.7.m7.2d">bold_italic_g start_POSTSUPERSCRIPT roman_plan end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t : italic_t + italic_H end_POSTSUBSCRIPT = [ italic_v start_POSTSUBSCRIPT italic_t : italic_t + italic_H end_POSTSUBSCRIPT , italic_ω start_POSTSUBSCRIPT italic_t : italic_t + italic_H end_POSTSUBSCRIPT ]</annotation></semantics></math> for the flat surface and <math alttext="\boldsymbol{g}^{\mathrm{plan}}_{t:t+H}=[v_{t:t+H},\omega_{t:t+H},\alpha_{t:t+H}]" class="ltx_Math" display="inline" id="S5.SS1.p2.8.m8.3"><semantics id="S5.SS1.p2.8.m8.3a"><mrow id="S5.SS1.p2.8.m8.3.3" xref="S5.SS1.p2.8.m8.3.3.cmml"><msubsup id="S5.SS1.p2.8.m8.3.3.5" xref="S5.SS1.p2.8.m8.3.3.5.cmml"><mi id="S5.SS1.p2.8.m8.3.3.5.2.2" xref="S5.SS1.p2.8.m8.3.3.5.2.2.cmml">𝒈</mi><mrow id="S5.SS1.p2.8.m8.3.3.5.3" xref="S5.SS1.p2.8.m8.3.3.5.3.cmml"><mi id="S5.SS1.p2.8.m8.3.3.5.3.2" xref="S5.SS1.p2.8.m8.3.3.5.3.2.cmml">t</mi><mo id="S5.SS1.p2.8.m8.3.3.5.3.1" lspace="0.278em" rspace="0.278em" xref="S5.SS1.p2.8.m8.3.3.5.3.1.cmml">:</mo><mrow id="S5.SS1.p2.8.m8.3.3.5.3.3" xref="S5.SS1.p2.8.m8.3.3.5.3.3.cmml"><mi id="S5.SS1.p2.8.m8.3.3.5.3.3.2" xref="S5.SS1.p2.8.m8.3.3.5.3.3.2.cmml">t</mi><mo id="S5.SS1.p2.8.m8.3.3.5.3.3.1" xref="S5.SS1.p2.8.m8.3.3.5.3.3.1.cmml">+</mo><mi id="S5.SS1.p2.8.m8.3.3.5.3.3.3" xref="S5.SS1.p2.8.m8.3.3.5.3.3.3.cmml">H</mi></mrow></mrow><mi id="S5.SS1.p2.8.m8.3.3.5.2.3" xref="S5.SS1.p2.8.m8.3.3.5.2.3.cmml">plan</mi></msubsup><mo id="S5.SS1.p2.8.m8.3.3.4" xref="S5.SS1.p2.8.m8.3.3.4.cmml">=</mo><mrow id="S5.SS1.p2.8.m8.3.3.3.3" xref="S5.SS1.p2.8.m8.3.3.3.4.cmml"><mo id="S5.SS1.p2.8.m8.3.3.3.3.4" stretchy="false" xref="S5.SS1.p2.8.m8.3.3.3.4.cmml">[</mo><msub id="S5.SS1.p2.8.m8.1.1.1.1.1" xref="S5.SS1.p2.8.m8.1.1.1.1.1.cmml"><mi id="S5.SS1.p2.8.m8.1.1.1.1.1.2" xref="S5.SS1.p2.8.m8.1.1.1.1.1.2.cmml">v</mi><mrow id="S5.SS1.p2.8.m8.1.1.1.1.1.3" xref="S5.SS1.p2.8.m8.1.1.1.1.1.3.cmml"><mi id="S5.SS1.p2.8.m8.1.1.1.1.1.3.2" xref="S5.SS1.p2.8.m8.1.1.1.1.1.3.2.cmml">t</mi><mo id="S5.SS1.p2.8.m8.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S5.SS1.p2.8.m8.1.1.1.1.1.3.1.cmml">:</mo><mrow id="S5.SS1.p2.8.m8.1.1.1.1.1.3.3" xref="S5.SS1.p2.8.m8.1.1.1.1.1.3.3.cmml"><mi id="S5.SS1.p2.8.m8.1.1.1.1.1.3.3.2" xref="S5.SS1.p2.8.m8.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="S5.SS1.p2.8.m8.1.1.1.1.1.3.3.1" xref="S5.SS1.p2.8.m8.1.1.1.1.1.3.3.1.cmml">+</mo><mi id="S5.SS1.p2.8.m8.1.1.1.1.1.3.3.3" xref="S5.SS1.p2.8.m8.1.1.1.1.1.3.3.3.cmml">H</mi></mrow></mrow></msub><mo id="S5.SS1.p2.8.m8.3.3.3.3.5" xref="S5.SS1.p2.8.m8.3.3.3.4.cmml">,</mo><msub id="S5.SS1.p2.8.m8.2.2.2.2.2" xref="S5.SS1.p2.8.m8.2.2.2.2.2.cmml"><mi id="S5.SS1.p2.8.m8.2.2.2.2.2.2" xref="S5.SS1.p2.8.m8.2.2.2.2.2.2.cmml">ω</mi><mrow id="S5.SS1.p2.8.m8.2.2.2.2.2.3" xref="S5.SS1.p2.8.m8.2.2.2.2.2.3.cmml"><mi id="S5.SS1.p2.8.m8.2.2.2.2.2.3.2" xref="S5.SS1.p2.8.m8.2.2.2.2.2.3.2.cmml">t</mi><mo id="S5.SS1.p2.8.m8.2.2.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S5.SS1.p2.8.m8.2.2.2.2.2.3.1.cmml">:</mo><mrow id="S5.SS1.p2.8.m8.2.2.2.2.2.3.3" xref="S5.SS1.p2.8.m8.2.2.2.2.2.3.3.cmml"><mi id="S5.SS1.p2.8.m8.2.2.2.2.2.3.3.2" xref="S5.SS1.p2.8.m8.2.2.2.2.2.3.3.2.cmml">t</mi><mo id="S5.SS1.p2.8.m8.2.2.2.2.2.3.3.1" xref="S5.SS1.p2.8.m8.2.2.2.2.2.3.3.1.cmml">+</mo><mi id="S5.SS1.p2.8.m8.2.2.2.2.2.3.3.3" xref="S5.SS1.p2.8.m8.2.2.2.2.2.3.3.3.cmml">H</mi></mrow></mrow></msub><mo id="S5.SS1.p2.8.m8.3.3.3.3.6" xref="S5.SS1.p2.8.m8.3.3.3.4.cmml">,</mo><msub id="S5.SS1.p2.8.m8.3.3.3.3.3" xref="S5.SS1.p2.8.m8.3.3.3.3.3.cmml"><mi id="S5.SS1.p2.8.m8.3.3.3.3.3.2" xref="S5.SS1.p2.8.m8.3.3.3.3.3.2.cmml">α</mi><mrow id="S5.SS1.p2.8.m8.3.3.3.3.3.3" xref="S5.SS1.p2.8.m8.3.3.3.3.3.3.cmml"><mi id="S5.SS1.p2.8.m8.3.3.3.3.3.3.2" xref="S5.SS1.p2.8.m8.3.3.3.3.3.3.2.cmml">t</mi><mo id="S5.SS1.p2.8.m8.3.3.3.3.3.3.1" lspace="0.278em" rspace="0.278em" xref="S5.SS1.p2.8.m8.3.3.3.3.3.3.1.cmml">:</mo><mrow id="S5.SS1.p2.8.m8.3.3.3.3.3.3.3" xref="S5.SS1.p2.8.m8.3.3.3.3.3.3.3.cmml"><mi id="S5.SS1.p2.8.m8.3.3.3.3.3.3.3.2" xref="S5.SS1.p2.8.m8.3.3.3.3.3.3.3.2.cmml">t</mi><mo id="S5.SS1.p2.8.m8.3.3.3.3.3.3.3.1" xref="S5.SS1.p2.8.m8.3.3.3.3.3.3.3.1.cmml">+</mo><mi id="S5.SS1.p2.8.m8.3.3.3.3.3.3.3.3" xref="S5.SS1.p2.8.m8.3.3.3.3.3.3.3.3.cmml">H</mi></mrow></mrow></msub><mo id="S5.SS1.p2.8.m8.3.3.3.3.7" stretchy="false" xref="S5.SS1.p2.8.m8.3.3.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.8.m8.3b"><apply id="S5.SS1.p2.8.m8.3.3.cmml" xref="S5.SS1.p2.8.m8.3.3"><eq id="S5.SS1.p2.8.m8.3.3.4.cmml" xref="S5.SS1.p2.8.m8.3.3.4"></eq><apply id="S5.SS1.p2.8.m8.3.3.5.cmml" xref="S5.SS1.p2.8.m8.3.3.5"><csymbol cd="ambiguous" id="S5.SS1.p2.8.m8.3.3.5.1.cmml" xref="S5.SS1.p2.8.m8.3.3.5">subscript</csymbol><apply id="S5.SS1.p2.8.m8.3.3.5.2.cmml" xref="S5.SS1.p2.8.m8.3.3.5"><csymbol cd="ambiguous" id="S5.SS1.p2.8.m8.3.3.5.2.1.cmml" xref="S5.SS1.p2.8.m8.3.3.5">superscript</csymbol><ci id="S5.SS1.p2.8.m8.3.3.5.2.2.cmml" xref="S5.SS1.p2.8.m8.3.3.5.2.2">𝒈</ci><ci id="S5.SS1.p2.8.m8.3.3.5.2.3.cmml" xref="S5.SS1.p2.8.m8.3.3.5.2.3">plan</ci></apply><apply id="S5.SS1.p2.8.m8.3.3.5.3.cmml" xref="S5.SS1.p2.8.m8.3.3.5.3"><ci id="S5.SS1.p2.8.m8.3.3.5.3.1.cmml" xref="S5.SS1.p2.8.m8.3.3.5.3.1">:</ci><ci id="S5.SS1.p2.8.m8.3.3.5.3.2.cmml" xref="S5.SS1.p2.8.m8.3.3.5.3.2">𝑡</ci><apply id="S5.SS1.p2.8.m8.3.3.5.3.3.cmml" xref="S5.SS1.p2.8.m8.3.3.5.3.3"><plus id="S5.SS1.p2.8.m8.3.3.5.3.3.1.cmml" xref="S5.SS1.p2.8.m8.3.3.5.3.3.1"></plus><ci id="S5.SS1.p2.8.m8.3.3.5.3.3.2.cmml" xref="S5.SS1.p2.8.m8.3.3.5.3.3.2">𝑡</ci><ci id="S5.SS1.p2.8.m8.3.3.5.3.3.3.cmml" xref="S5.SS1.p2.8.m8.3.3.5.3.3.3">𝐻</ci></apply></apply></apply><list id="S5.SS1.p2.8.m8.3.3.3.4.cmml" xref="S5.SS1.p2.8.m8.3.3.3.3"><apply id="S5.SS1.p2.8.m8.1.1.1.1.1.cmml" xref="S5.SS1.p2.8.m8.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.8.m8.1.1.1.1.1.1.cmml" xref="S5.SS1.p2.8.m8.1.1.1.1.1">subscript</csymbol><ci id="S5.SS1.p2.8.m8.1.1.1.1.1.2.cmml" xref="S5.SS1.p2.8.m8.1.1.1.1.1.2">𝑣</ci><apply id="S5.SS1.p2.8.m8.1.1.1.1.1.3.cmml" xref="S5.SS1.p2.8.m8.1.1.1.1.1.3"><ci id="S5.SS1.p2.8.m8.1.1.1.1.1.3.1.cmml" xref="S5.SS1.p2.8.m8.1.1.1.1.1.3.1">:</ci><ci id="S5.SS1.p2.8.m8.1.1.1.1.1.3.2.cmml" xref="S5.SS1.p2.8.m8.1.1.1.1.1.3.2">𝑡</ci><apply id="S5.SS1.p2.8.m8.1.1.1.1.1.3.3.cmml" xref="S5.SS1.p2.8.m8.1.1.1.1.1.3.3"><plus id="S5.SS1.p2.8.m8.1.1.1.1.1.3.3.1.cmml" xref="S5.SS1.p2.8.m8.1.1.1.1.1.3.3.1"></plus><ci id="S5.SS1.p2.8.m8.1.1.1.1.1.3.3.2.cmml" xref="S5.SS1.p2.8.m8.1.1.1.1.1.3.3.2">𝑡</ci><ci id="S5.SS1.p2.8.m8.1.1.1.1.1.3.3.3.cmml" xref="S5.SS1.p2.8.m8.1.1.1.1.1.3.3.3">𝐻</ci></apply></apply></apply><apply id="S5.SS1.p2.8.m8.2.2.2.2.2.cmml" xref="S5.SS1.p2.8.m8.2.2.2.2.2"><csymbol cd="ambiguous" id="S5.SS1.p2.8.m8.2.2.2.2.2.1.cmml" xref="S5.SS1.p2.8.m8.2.2.2.2.2">subscript</csymbol><ci id="S5.SS1.p2.8.m8.2.2.2.2.2.2.cmml" xref="S5.SS1.p2.8.m8.2.2.2.2.2.2">𝜔</ci><apply id="S5.SS1.p2.8.m8.2.2.2.2.2.3.cmml" xref="S5.SS1.p2.8.m8.2.2.2.2.2.3"><ci id="S5.SS1.p2.8.m8.2.2.2.2.2.3.1.cmml" xref="S5.SS1.p2.8.m8.2.2.2.2.2.3.1">:</ci><ci id="S5.SS1.p2.8.m8.2.2.2.2.2.3.2.cmml" xref="S5.SS1.p2.8.m8.2.2.2.2.2.3.2">𝑡</ci><apply id="S5.SS1.p2.8.m8.2.2.2.2.2.3.3.cmml" xref="S5.SS1.p2.8.m8.2.2.2.2.2.3.3"><plus id="S5.SS1.p2.8.m8.2.2.2.2.2.3.3.1.cmml" xref="S5.SS1.p2.8.m8.2.2.2.2.2.3.3.1"></plus><ci id="S5.SS1.p2.8.m8.2.2.2.2.2.3.3.2.cmml" xref="S5.SS1.p2.8.m8.2.2.2.2.2.3.3.2">𝑡</ci><ci id="S5.SS1.p2.8.m8.2.2.2.2.2.3.3.3.cmml" xref="S5.SS1.p2.8.m8.2.2.2.2.2.3.3.3">𝐻</ci></apply></apply></apply><apply id="S5.SS1.p2.8.m8.3.3.3.3.3.cmml" xref="S5.SS1.p2.8.m8.3.3.3.3.3"><csymbol cd="ambiguous" id="S5.SS1.p2.8.m8.3.3.3.3.3.1.cmml" xref="S5.SS1.p2.8.m8.3.3.3.3.3">subscript</csymbol><ci id="S5.SS1.p2.8.m8.3.3.3.3.3.2.cmml" xref="S5.SS1.p2.8.m8.3.3.3.3.3.2">𝛼</ci><apply id="S5.SS1.p2.8.m8.3.3.3.3.3.3.cmml" xref="S5.SS1.p2.8.m8.3.3.3.3.3.3"><ci id="S5.SS1.p2.8.m8.3.3.3.3.3.3.1.cmml" xref="S5.SS1.p2.8.m8.3.3.3.3.3.3.1">:</ci><ci id="S5.SS1.p2.8.m8.3.3.3.3.3.3.2.cmml" xref="S5.SS1.p2.8.m8.3.3.3.3.3.3.2">𝑡</ci><apply id="S5.SS1.p2.8.m8.3.3.3.3.3.3.3.cmml" xref="S5.SS1.p2.8.m8.3.3.3.3.3.3.3"><plus id="S5.SS1.p2.8.m8.3.3.3.3.3.3.3.1.cmml" xref="S5.SS1.p2.8.m8.3.3.3.3.3.3.3.1"></plus><ci id="S5.SS1.p2.8.m8.3.3.3.3.3.3.3.2.cmml" xref="S5.SS1.p2.8.m8.3.3.3.3.3.3.3.2">𝑡</ci><ci id="S5.SS1.p2.8.m8.3.3.3.3.3.3.3.3.cmml" xref="S5.SS1.p2.8.m8.3.3.3.3.3.3.3.3">𝐻</ci></apply></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.8.m8.3c">\boldsymbol{g}^{\mathrm{plan}}_{t:t+H}=[v_{t:t+H},\omega_{t:t+H},\alpha_{t:t+H}]</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p2.8.m8.3d">bold_italic_g start_POSTSUPERSCRIPT roman_plan end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t : italic_t + italic_H end_POSTSUBSCRIPT = [ italic_v start_POSTSUBSCRIPT italic_t : italic_t + italic_H end_POSTSUBSCRIPT , italic_ω start_POSTSUBSCRIPT italic_t : italic_t + italic_H end_POSTSUBSCRIPT , italic_α start_POSTSUBSCRIPT italic_t : italic_t + italic_H end_POSTSUBSCRIPT ]</annotation></semantics></math> for the sloped surface are derived according to the reference and actual positions and orientations.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Path Tracking Tasks</h3>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">We evaluate the task of following a lemniscate trajectory on flat and sloped surfaces, as illustrated in Fig.<a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S5.F4" title="Figure 4 ‣ 5.2 Path Tracking Tasks ‣ 5 Experiments ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<figure class="ltx_figure" id="S5.F4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F4.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="373" id="S5.F4.sf1.g1" src="x5.png" width="373"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F4.sf1.2.1.1" style="font-size:90%;">(a)</span> </span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F4.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="373" id="S5.F4.sf2.g1" src="x6.png" width="373"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F4.sf2.2.1.1" style="font-size:90%;">(b)</span> </span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F4.2.1.1" style="font-size:90%;">Figure 4</span>: </span><span class="ltx_text" id="S5.F4.3.2" style="font-size:90%;">Terrain and lemniscate trajectory for the tracking task.</span></figcaption>
</figure>
<div class="ltx_para" id="S5.SS2.p2">
<p class="ltx_p" id="S5.SS2.p2.17">The lemniscate trajectory is defined by the following equations:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S5.E14">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S5.E14X">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle x_{\mathrm{ref},t}" class="ltx_Math" display="inline" id="S5.E14X.2.1.1.m1.2"><semantics id="S5.E14X.2.1.1.m1.2a"><msub id="S5.E14X.2.1.1.m1.2.3" xref="S5.E14X.2.1.1.m1.2.3.cmml"><mi id="S5.E14X.2.1.1.m1.2.3.2" xref="S5.E14X.2.1.1.m1.2.3.2.cmml">x</mi><mrow id="S5.E14X.2.1.1.m1.2.2.2.4" xref="S5.E14X.2.1.1.m1.2.2.2.3.cmml"><mi id="S5.E14X.2.1.1.m1.1.1.1.1" xref="S5.E14X.2.1.1.m1.1.1.1.1.cmml">ref</mi><mo id="S5.E14X.2.1.1.m1.2.2.2.4.1" xref="S5.E14X.2.1.1.m1.2.2.2.3.cmml">,</mo><mi id="S5.E14X.2.1.1.m1.2.2.2.2" xref="S5.E14X.2.1.1.m1.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.E14X.2.1.1.m1.2b"><apply id="S5.E14X.2.1.1.m1.2.3.cmml" xref="S5.E14X.2.1.1.m1.2.3"><csymbol cd="ambiguous" id="S5.E14X.2.1.1.m1.2.3.1.cmml" xref="S5.E14X.2.1.1.m1.2.3">subscript</csymbol><ci id="S5.E14X.2.1.1.m1.2.3.2.cmml" xref="S5.E14X.2.1.1.m1.2.3.2">𝑥</ci><list id="S5.E14X.2.1.1.m1.2.2.2.3.cmml" xref="S5.E14X.2.1.1.m1.2.2.2.4"><ci id="S5.E14X.2.1.1.m1.1.1.1.1.cmml" xref="S5.E14X.2.1.1.m1.1.1.1.1">ref</ci><ci id="S5.E14X.2.1.1.m1.2.2.2.2.cmml" xref="S5.E14X.2.1.1.m1.2.2.2.2">𝑡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E14X.2.1.1.m1.2c">\displaystyle x_{\mathrm{ref},t}</annotation><annotation encoding="application/x-llamapun" id="S5.E14X.2.1.1.m1.2d">italic_x start_POSTSUBSCRIPT roman_ref , italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=r\sin\left(\dfrac{4\pi t}{T}\right)" class="ltx_Math" display="inline" id="S5.E14X.3.2.2.m1.2"><semantics id="S5.E14X.3.2.2.m1.2a"><mrow id="S5.E14X.3.2.2.m1.2.3" xref="S5.E14X.3.2.2.m1.2.3.cmml"><mi id="S5.E14X.3.2.2.m1.2.3.2" xref="S5.E14X.3.2.2.m1.2.3.2.cmml"></mi><mo id="S5.E14X.3.2.2.m1.2.3.1" xref="S5.E14X.3.2.2.m1.2.3.1.cmml">=</mo><mrow id="S5.E14X.3.2.2.m1.2.3.3" xref="S5.E14X.3.2.2.m1.2.3.3.cmml"><mi id="S5.E14X.3.2.2.m1.2.3.3.2" xref="S5.E14X.3.2.2.m1.2.3.3.2.cmml">r</mi><mo id="S5.E14X.3.2.2.m1.2.3.3.1" lspace="0.167em" xref="S5.E14X.3.2.2.m1.2.3.3.1.cmml">⁢</mo><mrow id="S5.E14X.3.2.2.m1.2.3.3.3.2" xref="S5.E14X.3.2.2.m1.2.3.3.3.1.cmml"><mi id="S5.E14X.3.2.2.m1.1.1" xref="S5.E14X.3.2.2.m1.1.1.cmml">sin</mi><mo id="S5.E14X.3.2.2.m1.2.3.3.3.2a" xref="S5.E14X.3.2.2.m1.2.3.3.3.1.cmml">⁡</mo><mrow id="S5.E14X.3.2.2.m1.2.3.3.3.2.1" xref="S5.E14X.3.2.2.m1.2.3.3.3.1.cmml"><mo id="S5.E14X.3.2.2.m1.2.3.3.3.2.1.1" xref="S5.E14X.3.2.2.m1.2.3.3.3.1.cmml">(</mo><mstyle displaystyle="true" id="S5.E14X.3.2.2.m1.2.2" xref="S5.E14X.3.2.2.m1.2.2.cmml"><mfrac id="S5.E14X.3.2.2.m1.2.2a" xref="S5.E14X.3.2.2.m1.2.2.cmml"><mrow id="S5.E14X.3.2.2.m1.2.2.2" xref="S5.E14X.3.2.2.m1.2.2.2.cmml"><mn id="S5.E14X.3.2.2.m1.2.2.2.2" xref="S5.E14X.3.2.2.m1.2.2.2.2.cmml">4</mn><mo id="S5.E14X.3.2.2.m1.2.2.2.1" xref="S5.E14X.3.2.2.m1.2.2.2.1.cmml">⁢</mo><mi id="S5.E14X.3.2.2.m1.2.2.2.3" xref="S5.E14X.3.2.2.m1.2.2.2.3.cmml">π</mi><mo id="S5.E14X.3.2.2.m1.2.2.2.1a" xref="S5.E14X.3.2.2.m1.2.2.2.1.cmml">⁢</mo><mi id="S5.E14X.3.2.2.m1.2.2.2.4" xref="S5.E14X.3.2.2.m1.2.2.2.4.cmml">t</mi></mrow><mi id="S5.E14X.3.2.2.m1.2.2.3" xref="S5.E14X.3.2.2.m1.2.2.3.cmml">T</mi></mfrac></mstyle><mo id="S5.E14X.3.2.2.m1.2.3.3.3.2.1.2" xref="S5.E14X.3.2.2.m1.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.E14X.3.2.2.m1.2b"><apply id="S5.E14X.3.2.2.m1.2.3.cmml" xref="S5.E14X.3.2.2.m1.2.3"><eq id="S5.E14X.3.2.2.m1.2.3.1.cmml" xref="S5.E14X.3.2.2.m1.2.3.1"></eq><csymbol cd="latexml" id="S5.E14X.3.2.2.m1.2.3.2.cmml" xref="S5.E14X.3.2.2.m1.2.3.2">absent</csymbol><apply id="S5.E14X.3.2.2.m1.2.3.3.cmml" xref="S5.E14X.3.2.2.m1.2.3.3"><times id="S5.E14X.3.2.2.m1.2.3.3.1.cmml" xref="S5.E14X.3.2.2.m1.2.3.3.1"></times><ci id="S5.E14X.3.2.2.m1.2.3.3.2.cmml" xref="S5.E14X.3.2.2.m1.2.3.3.2">𝑟</ci><apply id="S5.E14X.3.2.2.m1.2.3.3.3.1.cmml" xref="S5.E14X.3.2.2.m1.2.3.3.3.2"><sin id="S5.E14X.3.2.2.m1.1.1.cmml" xref="S5.E14X.3.2.2.m1.1.1"></sin><apply id="S5.E14X.3.2.2.m1.2.2.cmml" xref="S5.E14X.3.2.2.m1.2.2"><divide id="S5.E14X.3.2.2.m1.2.2.1.cmml" xref="S5.E14X.3.2.2.m1.2.2"></divide><apply id="S5.E14X.3.2.2.m1.2.2.2.cmml" xref="S5.E14X.3.2.2.m1.2.2.2"><times id="S5.E14X.3.2.2.m1.2.2.2.1.cmml" xref="S5.E14X.3.2.2.m1.2.2.2.1"></times><cn id="S5.E14X.3.2.2.m1.2.2.2.2.cmml" type="integer" xref="S5.E14X.3.2.2.m1.2.2.2.2">4</cn><ci id="S5.E14X.3.2.2.m1.2.2.2.3.cmml" xref="S5.E14X.3.2.2.m1.2.2.2.3">𝜋</ci><ci id="S5.E14X.3.2.2.m1.2.2.2.4.cmml" xref="S5.E14X.3.2.2.m1.2.2.2.4">𝑡</ci></apply><ci id="S5.E14X.3.2.2.m1.2.2.3.cmml" xref="S5.E14X.3.2.2.m1.2.2.3">𝑇</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E14X.3.2.2.m1.2c">\displaystyle=r\sin\left(\dfrac{4\pi t}{T}\right)</annotation><annotation encoding="application/x-llamapun" id="S5.E14X.3.2.2.m1.2d">= italic_r roman_sin ( divide start_ARG 4 italic_π italic_t end_ARG start_ARG italic_T end_ARG )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="3"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(14)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S5.E14Xa">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle y_{\mathrm{ref},t}" class="ltx_Math" display="inline" id="S5.E14Xa.2.1.1.m1.2"><semantics id="S5.E14Xa.2.1.1.m1.2a"><msub id="S5.E14Xa.2.1.1.m1.2.3" xref="S5.E14Xa.2.1.1.m1.2.3.cmml"><mi id="S5.E14Xa.2.1.1.m1.2.3.2" xref="S5.E14Xa.2.1.1.m1.2.3.2.cmml">y</mi><mrow id="S5.E14Xa.2.1.1.m1.2.2.2.4" xref="S5.E14Xa.2.1.1.m1.2.2.2.3.cmml"><mi id="S5.E14Xa.2.1.1.m1.1.1.1.1" xref="S5.E14Xa.2.1.1.m1.1.1.1.1.cmml">ref</mi><mo id="S5.E14Xa.2.1.1.m1.2.2.2.4.1" xref="S5.E14Xa.2.1.1.m1.2.2.2.3.cmml">,</mo><mi id="S5.E14Xa.2.1.1.m1.2.2.2.2" xref="S5.E14Xa.2.1.1.m1.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.E14Xa.2.1.1.m1.2b"><apply id="S5.E14Xa.2.1.1.m1.2.3.cmml" xref="S5.E14Xa.2.1.1.m1.2.3"><csymbol cd="ambiguous" id="S5.E14Xa.2.1.1.m1.2.3.1.cmml" xref="S5.E14Xa.2.1.1.m1.2.3">subscript</csymbol><ci id="S5.E14Xa.2.1.1.m1.2.3.2.cmml" xref="S5.E14Xa.2.1.1.m1.2.3.2">𝑦</ci><list id="S5.E14Xa.2.1.1.m1.2.2.2.3.cmml" xref="S5.E14Xa.2.1.1.m1.2.2.2.4"><ci id="S5.E14Xa.2.1.1.m1.1.1.1.1.cmml" xref="S5.E14Xa.2.1.1.m1.1.1.1.1">ref</ci><ci id="S5.E14Xa.2.1.1.m1.2.2.2.2.cmml" xref="S5.E14Xa.2.1.1.m1.2.2.2.2">𝑡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E14Xa.2.1.1.m1.2c">\displaystyle y_{\mathrm{ref},t}</annotation><annotation encoding="application/x-llamapun" id="S5.E14Xa.2.1.1.m1.2d">italic_y start_POSTSUBSCRIPT roman_ref , italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=r\cos\left(\dfrac{2\pi t}{T}\right)-r" class="ltx_Math" display="inline" id="S5.E14Xa.3.2.2.m1.2"><semantics id="S5.E14Xa.3.2.2.m1.2a"><mrow id="S5.E14Xa.3.2.2.m1.2.3" xref="S5.E14Xa.3.2.2.m1.2.3.cmml"><mi id="S5.E14Xa.3.2.2.m1.2.3.2" xref="S5.E14Xa.3.2.2.m1.2.3.2.cmml"></mi><mo id="S5.E14Xa.3.2.2.m1.2.3.1" xref="S5.E14Xa.3.2.2.m1.2.3.1.cmml">=</mo><mrow id="S5.E14Xa.3.2.2.m1.2.3.3" xref="S5.E14Xa.3.2.2.m1.2.3.3.cmml"><mrow id="S5.E14Xa.3.2.2.m1.2.3.3.2" xref="S5.E14Xa.3.2.2.m1.2.3.3.2.cmml"><mi id="S5.E14Xa.3.2.2.m1.2.3.3.2.2" xref="S5.E14Xa.3.2.2.m1.2.3.3.2.2.cmml">r</mi><mo id="S5.E14Xa.3.2.2.m1.2.3.3.2.1" lspace="0.167em" xref="S5.E14Xa.3.2.2.m1.2.3.3.2.1.cmml">⁢</mo><mrow id="S5.E14Xa.3.2.2.m1.2.3.3.2.3.2" xref="S5.E14Xa.3.2.2.m1.2.3.3.2.3.1.cmml"><mi id="S5.E14Xa.3.2.2.m1.1.1" xref="S5.E14Xa.3.2.2.m1.1.1.cmml">cos</mi><mo id="S5.E14Xa.3.2.2.m1.2.3.3.2.3.2a" xref="S5.E14Xa.3.2.2.m1.2.3.3.2.3.1.cmml">⁡</mo><mrow id="S5.E14Xa.3.2.2.m1.2.3.3.2.3.2.1" xref="S5.E14Xa.3.2.2.m1.2.3.3.2.3.1.cmml"><mo id="S5.E14Xa.3.2.2.m1.2.3.3.2.3.2.1.1" xref="S5.E14Xa.3.2.2.m1.2.3.3.2.3.1.cmml">(</mo><mstyle displaystyle="true" id="S5.E14Xa.3.2.2.m1.2.2" xref="S5.E14Xa.3.2.2.m1.2.2.cmml"><mfrac id="S5.E14Xa.3.2.2.m1.2.2a" xref="S5.E14Xa.3.2.2.m1.2.2.cmml"><mrow id="S5.E14Xa.3.2.2.m1.2.2.2" xref="S5.E14Xa.3.2.2.m1.2.2.2.cmml"><mn id="S5.E14Xa.3.2.2.m1.2.2.2.2" xref="S5.E14Xa.3.2.2.m1.2.2.2.2.cmml">2</mn><mo id="S5.E14Xa.3.2.2.m1.2.2.2.1" xref="S5.E14Xa.3.2.2.m1.2.2.2.1.cmml">⁢</mo><mi id="S5.E14Xa.3.2.2.m1.2.2.2.3" xref="S5.E14Xa.3.2.2.m1.2.2.2.3.cmml">π</mi><mo id="S5.E14Xa.3.2.2.m1.2.2.2.1a" xref="S5.E14Xa.3.2.2.m1.2.2.2.1.cmml">⁢</mo><mi id="S5.E14Xa.3.2.2.m1.2.2.2.4" xref="S5.E14Xa.3.2.2.m1.2.2.2.4.cmml">t</mi></mrow><mi id="S5.E14Xa.3.2.2.m1.2.2.3" xref="S5.E14Xa.3.2.2.m1.2.2.3.cmml">T</mi></mfrac></mstyle><mo id="S5.E14Xa.3.2.2.m1.2.3.3.2.3.2.1.2" xref="S5.E14Xa.3.2.2.m1.2.3.3.2.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S5.E14Xa.3.2.2.m1.2.3.3.1" xref="S5.E14Xa.3.2.2.m1.2.3.3.1.cmml">−</mo><mi id="S5.E14Xa.3.2.2.m1.2.3.3.3" xref="S5.E14Xa.3.2.2.m1.2.3.3.3.cmml">r</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.E14Xa.3.2.2.m1.2b"><apply id="S5.E14Xa.3.2.2.m1.2.3.cmml" xref="S5.E14Xa.3.2.2.m1.2.3"><eq id="S5.E14Xa.3.2.2.m1.2.3.1.cmml" xref="S5.E14Xa.3.2.2.m1.2.3.1"></eq><csymbol cd="latexml" id="S5.E14Xa.3.2.2.m1.2.3.2.cmml" xref="S5.E14Xa.3.2.2.m1.2.3.2">absent</csymbol><apply id="S5.E14Xa.3.2.2.m1.2.3.3.cmml" xref="S5.E14Xa.3.2.2.m1.2.3.3"><minus id="S5.E14Xa.3.2.2.m1.2.3.3.1.cmml" xref="S5.E14Xa.3.2.2.m1.2.3.3.1"></minus><apply id="S5.E14Xa.3.2.2.m1.2.3.3.2.cmml" xref="S5.E14Xa.3.2.2.m1.2.3.3.2"><times id="S5.E14Xa.3.2.2.m1.2.3.3.2.1.cmml" xref="S5.E14Xa.3.2.2.m1.2.3.3.2.1"></times><ci id="S5.E14Xa.3.2.2.m1.2.3.3.2.2.cmml" xref="S5.E14Xa.3.2.2.m1.2.3.3.2.2">𝑟</ci><apply id="S5.E14Xa.3.2.2.m1.2.3.3.2.3.1.cmml" xref="S5.E14Xa.3.2.2.m1.2.3.3.2.3.2"><cos id="S5.E14Xa.3.2.2.m1.1.1.cmml" xref="S5.E14Xa.3.2.2.m1.1.1"></cos><apply id="S5.E14Xa.3.2.2.m1.2.2.cmml" xref="S5.E14Xa.3.2.2.m1.2.2"><divide id="S5.E14Xa.3.2.2.m1.2.2.1.cmml" xref="S5.E14Xa.3.2.2.m1.2.2"></divide><apply id="S5.E14Xa.3.2.2.m1.2.2.2.cmml" xref="S5.E14Xa.3.2.2.m1.2.2.2"><times id="S5.E14Xa.3.2.2.m1.2.2.2.1.cmml" xref="S5.E14Xa.3.2.2.m1.2.2.2.1"></times><cn id="S5.E14Xa.3.2.2.m1.2.2.2.2.cmml" type="integer" xref="S5.E14Xa.3.2.2.m1.2.2.2.2">2</cn><ci id="S5.E14Xa.3.2.2.m1.2.2.2.3.cmml" xref="S5.E14Xa.3.2.2.m1.2.2.2.3">𝜋</ci><ci id="S5.E14Xa.3.2.2.m1.2.2.2.4.cmml" xref="S5.E14Xa.3.2.2.m1.2.2.2.4">𝑡</ci></apply><ci id="S5.E14Xa.3.2.2.m1.2.2.3.cmml" xref="S5.E14Xa.3.2.2.m1.2.2.3">𝑇</ci></apply></apply></apply><ci id="S5.E14Xa.3.2.2.m1.2.3.3.3.cmml" xref="S5.E14Xa.3.2.2.m1.2.3.3.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E14Xa.3.2.2.m1.2c">\displaystyle=r\cos\left(\dfrac{2\pi t}{T}\right)-r</annotation><annotation encoding="application/x-llamapun" id="S5.E14Xa.3.2.2.m1.2d">= italic_r roman_cos ( divide start_ARG 2 italic_π italic_t end_ARG start_ARG italic_T end_ARG ) - italic_r</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S5.E14Xb">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\psi_{\mathrm{ref},t}" class="ltx_Math" display="inline" id="S5.E14Xb.2.1.1.m1.2"><semantics id="S5.E14Xb.2.1.1.m1.2a"><msub id="S5.E14Xb.2.1.1.m1.2.3" xref="S5.E14Xb.2.1.1.m1.2.3.cmml"><mi id="S5.E14Xb.2.1.1.m1.2.3.2" xref="S5.E14Xb.2.1.1.m1.2.3.2.cmml">ψ</mi><mrow id="S5.E14Xb.2.1.1.m1.2.2.2.4" xref="S5.E14Xb.2.1.1.m1.2.2.2.3.cmml"><mi id="S5.E14Xb.2.1.1.m1.1.1.1.1" xref="S5.E14Xb.2.1.1.m1.1.1.1.1.cmml">ref</mi><mo id="S5.E14Xb.2.1.1.m1.2.2.2.4.1" xref="S5.E14Xb.2.1.1.m1.2.2.2.3.cmml">,</mo><mi id="S5.E14Xb.2.1.1.m1.2.2.2.2" xref="S5.E14Xb.2.1.1.m1.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.E14Xb.2.1.1.m1.2b"><apply id="S5.E14Xb.2.1.1.m1.2.3.cmml" xref="S5.E14Xb.2.1.1.m1.2.3"><csymbol cd="ambiguous" id="S5.E14Xb.2.1.1.m1.2.3.1.cmml" xref="S5.E14Xb.2.1.1.m1.2.3">subscript</csymbol><ci id="S5.E14Xb.2.1.1.m1.2.3.2.cmml" xref="S5.E14Xb.2.1.1.m1.2.3.2">𝜓</ci><list id="S5.E14Xb.2.1.1.m1.2.2.2.3.cmml" xref="S5.E14Xb.2.1.1.m1.2.2.2.4"><ci id="S5.E14Xb.2.1.1.m1.1.1.1.1.cmml" xref="S5.E14Xb.2.1.1.m1.1.1.1.1">ref</ci><ci id="S5.E14Xb.2.1.1.m1.2.2.2.2.cmml" xref="S5.E14Xb.2.1.1.m1.2.2.2.2">𝑡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E14Xb.2.1.1.m1.2c">\displaystyle\psi_{\mathrm{ref},t}</annotation><annotation encoding="application/x-llamapun" id="S5.E14Xb.2.1.1.m1.2d">italic_ψ start_POSTSUBSCRIPT roman_ref , italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\left.\dfrac{dy(t)}{dx(t)}\right|_{t=t}" class="ltx_Math" display="inline" id="S5.E14Xb.3.2.2.m1.3"><semantics id="S5.E14Xb.3.2.2.m1.3a"><mrow id="S5.E14Xb.3.2.2.m1.3.4" xref="S5.E14Xb.3.2.2.m1.3.4.cmml"><mi id="S5.E14Xb.3.2.2.m1.3.4.2" xref="S5.E14Xb.3.2.2.m1.3.4.2.cmml"></mi><mo id="S5.E14Xb.3.2.2.m1.3.4.1" xref="S5.E14Xb.3.2.2.m1.3.4.1.cmml">=</mo><msub id="S5.E14Xb.3.2.2.m1.3.4.3.2" xref="S5.E14Xb.3.2.2.m1.3.4.3.1.cmml"><mrow id="S5.E14Xb.3.2.2.m1.3.4.3.2.2" xref="S5.E14Xb.3.2.2.m1.3.4.3.1.cmml"><mstyle displaystyle="true" id="S5.E14Xb.3.2.2.m1.2.2" xref="S5.E14Xb.3.2.2.m1.2.2.cmml"><mfrac id="S5.E14Xb.3.2.2.m1.2.2a" xref="S5.E14Xb.3.2.2.m1.2.2.cmml"><mrow id="S5.E14Xb.3.2.2.m1.1.1.1" xref="S5.E14Xb.3.2.2.m1.1.1.1.cmml"><mi id="S5.E14Xb.3.2.2.m1.1.1.1.3" xref="S5.E14Xb.3.2.2.m1.1.1.1.3.cmml">d</mi><mo id="S5.E14Xb.3.2.2.m1.1.1.1.2" xref="S5.E14Xb.3.2.2.m1.1.1.1.2.cmml">⁢</mo><mi id="S5.E14Xb.3.2.2.m1.1.1.1.4" xref="S5.E14Xb.3.2.2.m1.1.1.1.4.cmml">y</mi><mo id="S5.E14Xb.3.2.2.m1.1.1.1.2a" xref="S5.E14Xb.3.2.2.m1.1.1.1.2.cmml">⁢</mo><mrow id="S5.E14Xb.3.2.2.m1.1.1.1.5.2" xref="S5.E14Xb.3.2.2.m1.1.1.1.cmml"><mo id="S5.E14Xb.3.2.2.m1.1.1.1.5.2.1" stretchy="false" xref="S5.E14Xb.3.2.2.m1.1.1.1.cmml">(</mo><mi id="S5.E14Xb.3.2.2.m1.1.1.1.1" xref="S5.E14Xb.3.2.2.m1.1.1.1.1.cmml">t</mi><mo id="S5.E14Xb.3.2.2.m1.1.1.1.5.2.2" stretchy="false" xref="S5.E14Xb.3.2.2.m1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S5.E14Xb.3.2.2.m1.2.2.2" xref="S5.E14Xb.3.2.2.m1.2.2.2.cmml"><mi id="S5.E14Xb.3.2.2.m1.2.2.2.3" xref="S5.E14Xb.3.2.2.m1.2.2.2.3.cmml">d</mi><mo id="S5.E14Xb.3.2.2.m1.2.2.2.2" xref="S5.E14Xb.3.2.2.m1.2.2.2.2.cmml">⁢</mo><mi id="S5.E14Xb.3.2.2.m1.2.2.2.4" xref="S5.E14Xb.3.2.2.m1.2.2.2.4.cmml">x</mi><mo id="S5.E14Xb.3.2.2.m1.2.2.2.2a" xref="S5.E14Xb.3.2.2.m1.2.2.2.2.cmml">⁢</mo><mrow id="S5.E14Xb.3.2.2.m1.2.2.2.5.2" xref="S5.E14Xb.3.2.2.m1.2.2.2.cmml"><mo id="S5.E14Xb.3.2.2.m1.2.2.2.5.2.1" stretchy="false" xref="S5.E14Xb.3.2.2.m1.2.2.2.cmml">(</mo><mi id="S5.E14Xb.3.2.2.m1.2.2.2.1" xref="S5.E14Xb.3.2.2.m1.2.2.2.1.cmml">t</mi><mo id="S5.E14Xb.3.2.2.m1.2.2.2.5.2.2" stretchy="false" xref="S5.E14Xb.3.2.2.m1.2.2.2.cmml">)</mo></mrow></mrow></mfrac></mstyle><mo id="S5.E14Xb.3.2.2.m1.3.4.3.2.2.1" xref="S5.E14Xb.3.2.2.m1.3.4.3.1.1.cmml">|</mo></mrow><mrow id="S5.E14Xb.3.2.2.m1.3.3.1" xref="S5.E14Xb.3.2.2.m1.3.3.1.cmml"><mi id="S5.E14Xb.3.2.2.m1.3.3.1.2" xref="S5.E14Xb.3.2.2.m1.3.3.1.2.cmml">t</mi><mo id="S5.E14Xb.3.2.2.m1.3.3.1.1" xref="S5.E14Xb.3.2.2.m1.3.3.1.1.cmml">=</mo><mi id="S5.E14Xb.3.2.2.m1.3.3.1.3" xref="S5.E14Xb.3.2.2.m1.3.3.1.3.cmml">t</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S5.E14Xb.3.2.2.m1.3b"><apply id="S5.E14Xb.3.2.2.m1.3.4.cmml" xref="S5.E14Xb.3.2.2.m1.3.4"><eq id="S5.E14Xb.3.2.2.m1.3.4.1.cmml" xref="S5.E14Xb.3.2.2.m1.3.4.1"></eq><csymbol cd="latexml" id="S5.E14Xb.3.2.2.m1.3.4.2.cmml" xref="S5.E14Xb.3.2.2.m1.3.4.2">absent</csymbol><apply id="S5.E14Xb.3.2.2.m1.3.4.3.1.cmml" xref="S5.E14Xb.3.2.2.m1.3.4.3.2"><csymbol cd="latexml" id="S5.E14Xb.3.2.2.m1.3.4.3.1.1.cmml" xref="S5.E14Xb.3.2.2.m1.3.4.3.2.2.1">evaluated-at</csymbol><apply id="S5.E14Xb.3.2.2.m1.2.2.cmml" xref="S5.E14Xb.3.2.2.m1.2.2"><divide id="S5.E14Xb.3.2.2.m1.2.2.3.cmml" xref="S5.E14Xb.3.2.2.m1.2.2"></divide><apply id="S5.E14Xb.3.2.2.m1.1.1.1.cmml" xref="S5.E14Xb.3.2.2.m1.1.1.1"><times id="S5.E14Xb.3.2.2.m1.1.1.1.2.cmml" xref="S5.E14Xb.3.2.2.m1.1.1.1.2"></times><ci id="S5.E14Xb.3.2.2.m1.1.1.1.3.cmml" xref="S5.E14Xb.3.2.2.m1.1.1.1.3">𝑑</ci><ci id="S5.E14Xb.3.2.2.m1.1.1.1.4.cmml" xref="S5.E14Xb.3.2.2.m1.1.1.1.4">𝑦</ci><ci id="S5.E14Xb.3.2.2.m1.1.1.1.1.cmml" xref="S5.E14Xb.3.2.2.m1.1.1.1.1">𝑡</ci></apply><apply id="S5.E14Xb.3.2.2.m1.2.2.2.cmml" xref="S5.E14Xb.3.2.2.m1.2.2.2"><times id="S5.E14Xb.3.2.2.m1.2.2.2.2.cmml" xref="S5.E14Xb.3.2.2.m1.2.2.2.2"></times><ci id="S5.E14Xb.3.2.2.m1.2.2.2.3.cmml" xref="S5.E14Xb.3.2.2.m1.2.2.2.3">𝑑</ci><ci id="S5.E14Xb.3.2.2.m1.2.2.2.4.cmml" xref="S5.E14Xb.3.2.2.m1.2.2.2.4">𝑥</ci><ci id="S5.E14Xb.3.2.2.m1.2.2.2.1.cmml" xref="S5.E14Xb.3.2.2.m1.2.2.2.1">𝑡</ci></apply></apply><apply id="S5.E14Xb.3.2.2.m1.3.3.1.cmml" xref="S5.E14Xb.3.2.2.m1.3.3.1"><eq id="S5.E14Xb.3.2.2.m1.3.3.1.1.cmml" xref="S5.E14Xb.3.2.2.m1.3.3.1.1"></eq><ci id="S5.E14Xb.3.2.2.m1.3.3.1.2.cmml" xref="S5.E14Xb.3.2.2.m1.3.3.1.2">𝑡</ci><ci id="S5.E14Xb.3.2.2.m1.3.3.1.3.cmml" xref="S5.E14Xb.3.2.2.m1.3.3.1.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E14Xb.3.2.2.m1.3c">\displaystyle=\left.\dfrac{dy(t)}{dx(t)}\right|_{t=t}</annotation><annotation encoding="application/x-llamapun" id="S5.E14Xb.3.2.2.m1.3d">= divide start_ARG italic_d italic_y ( italic_t ) end_ARG start_ARG italic_d italic_x ( italic_t ) end_ARG | start_POSTSUBSCRIPT italic_t = italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S5.SS2.p2.3">Here, <math alttext="r&gt;0" class="ltx_Math" display="inline" id="S5.SS2.p2.1.m1.1"><semantics id="S5.SS2.p2.1.m1.1a"><mrow id="S5.SS2.p2.1.m1.1.1" xref="S5.SS2.p2.1.m1.1.1.cmml"><mi id="S5.SS2.p2.1.m1.1.1.2" xref="S5.SS2.p2.1.m1.1.1.2.cmml">r</mi><mo id="S5.SS2.p2.1.m1.1.1.1" xref="S5.SS2.p2.1.m1.1.1.1.cmml">&gt;</mo><mn id="S5.SS2.p2.1.m1.1.1.3" xref="S5.SS2.p2.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.1.m1.1b"><apply id="S5.SS2.p2.1.m1.1.1.cmml" xref="S5.SS2.p2.1.m1.1.1"><gt id="S5.SS2.p2.1.m1.1.1.1.cmml" xref="S5.SS2.p2.1.m1.1.1.1"></gt><ci id="S5.SS2.p2.1.m1.1.1.2.cmml" xref="S5.SS2.p2.1.m1.1.1.2">𝑟</ci><cn id="S5.SS2.p2.1.m1.1.1.3.cmml" type="integer" xref="S5.SS2.p2.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.1.m1.1c">r&gt;0</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.1.m1.1d">italic_r &gt; 0</annotation></semantics></math> determines the size of the figure-eight trajectory, <math alttext="t" class="ltx_Math" display="inline" id="S5.SS2.p2.2.m2.1"><semantics id="S5.SS2.p2.2.m2.1a"><mi id="S5.SS2.p2.2.m2.1.1" xref="S5.SS2.p2.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.2.m2.1b"><ci id="S5.SS2.p2.2.m2.1.1.cmml" xref="S5.SS2.p2.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.2.m2.1c">t</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.2.m2.1d">italic_t</annotation></semantics></math> is the timestep, and <math alttext="T" class="ltx_Math" display="inline" id="S5.SS2.p2.3.m3.1"><semantics id="S5.SS2.p2.3.m3.1a"><mi id="S5.SS2.p2.3.m3.1.1" xref="S5.SS2.p2.3.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.3.m3.1b"><ci id="S5.SS2.p2.3.m3.1.1.cmml" xref="S5.SS2.p2.3.m3.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.3.m3.1c">T</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.3.m3.1d">italic_T</annotation></semantics></math> is the total duration of the episode.
The reference velocity and angular velocity trajectories are obtained as follows:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S5.E15">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S5.E15X">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle v_{\mathrm{ref},t}" class="ltx_Math" display="inline" id="S5.E15X.2.1.1.m1.2"><semantics id="S5.E15X.2.1.1.m1.2a"><msub id="S5.E15X.2.1.1.m1.2.3" xref="S5.E15X.2.1.1.m1.2.3.cmml"><mi id="S5.E15X.2.1.1.m1.2.3.2" xref="S5.E15X.2.1.1.m1.2.3.2.cmml">v</mi><mrow id="S5.E15X.2.1.1.m1.2.2.2.4" xref="S5.E15X.2.1.1.m1.2.2.2.3.cmml"><mi id="S5.E15X.2.1.1.m1.1.1.1.1" xref="S5.E15X.2.1.1.m1.1.1.1.1.cmml">ref</mi><mo id="S5.E15X.2.1.1.m1.2.2.2.4.1" xref="S5.E15X.2.1.1.m1.2.2.2.3.cmml">,</mo><mi id="S5.E15X.2.1.1.m1.2.2.2.2" xref="S5.E15X.2.1.1.m1.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.E15X.2.1.1.m1.2b"><apply id="S5.E15X.2.1.1.m1.2.3.cmml" xref="S5.E15X.2.1.1.m1.2.3"><csymbol cd="ambiguous" id="S5.E15X.2.1.1.m1.2.3.1.cmml" xref="S5.E15X.2.1.1.m1.2.3">subscript</csymbol><ci id="S5.E15X.2.1.1.m1.2.3.2.cmml" xref="S5.E15X.2.1.1.m1.2.3.2">𝑣</ci><list id="S5.E15X.2.1.1.m1.2.2.2.3.cmml" xref="S5.E15X.2.1.1.m1.2.2.2.4"><ci id="S5.E15X.2.1.1.m1.1.1.1.1.cmml" xref="S5.E15X.2.1.1.m1.1.1.1.1">ref</ci><ci id="S5.E15X.2.1.1.m1.2.2.2.2.cmml" xref="S5.E15X.2.1.1.m1.2.2.2.2">𝑡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E15X.2.1.1.m1.2c">\displaystyle v_{\mathrm{ref},t}</annotation><annotation encoding="application/x-llamapun" id="S5.E15X.2.1.1.m1.2d">italic_v start_POSTSUBSCRIPT roman_ref , italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\dfrac{\sqrt{(x_{\mathrm{ref},t+1}-x_{\mathrm{ref},t})^{2}+(y_{%
\mathrm{ref},t+1}-y_{\mathrm{ref},t})^{2}}}{dt}" class="ltx_Math" display="inline" id="S5.E15X.3.2.2.m1.10"><semantics id="S5.E15X.3.2.2.m1.10a"><mrow id="S5.E15X.3.2.2.m1.10.11" xref="S5.E15X.3.2.2.m1.10.11.cmml"><mi id="S5.E15X.3.2.2.m1.10.11.2" xref="S5.E15X.3.2.2.m1.10.11.2.cmml"></mi><mo id="S5.E15X.3.2.2.m1.10.11.1" xref="S5.E15X.3.2.2.m1.10.11.1.cmml">=</mo><mstyle displaystyle="true" id="S5.E15X.3.2.2.m1.10.10" xref="S5.E15X.3.2.2.m1.10.10.cmml"><mfrac id="S5.E15X.3.2.2.m1.10.10a" xref="S5.E15X.3.2.2.m1.10.10.cmml"><msqrt id="S5.E15X.3.2.2.m1.10.10.10" xref="S5.E15X.3.2.2.m1.10.10.10.cmml"><mrow id="S5.E15X.3.2.2.m1.10.10.10.10.10" xref="S5.E15X.3.2.2.m1.10.10.10.10.10.cmml"><msup id="S5.E15X.3.2.2.m1.9.9.9.9.9.9" xref="S5.E15X.3.2.2.m1.9.9.9.9.9.9.cmml"><mrow id="S5.E15X.3.2.2.m1.9.9.9.9.9.9.1.1" xref="S5.E15X.3.2.2.m1.9.9.9.9.9.9.1.1.1.cmml"><mo id="S5.E15X.3.2.2.m1.9.9.9.9.9.9.1.1.2" stretchy="false" xref="S5.E15X.3.2.2.m1.9.9.9.9.9.9.1.1.1.cmml">(</mo><mrow id="S5.E15X.3.2.2.m1.9.9.9.9.9.9.1.1.1" xref="S5.E15X.3.2.2.m1.9.9.9.9.9.9.1.1.1.cmml"><msub id="S5.E15X.3.2.2.m1.9.9.9.9.9.9.1.1.1.2" xref="S5.E15X.3.2.2.m1.9.9.9.9.9.9.1.1.1.2.cmml"><mi id="S5.E15X.3.2.2.m1.9.9.9.9.9.9.1.1.1.2.2" xref="S5.E15X.3.2.2.m1.9.9.9.9.9.9.1.1.1.2.2.cmml">x</mi><mrow id="S5.E15X.3.2.2.m1.2.2.2.2.2.2.2.2" xref="S5.E15X.3.2.2.m1.2.2.2.2.2.2.2.3.cmml"><mi id="S5.E15X.3.2.2.m1.1.1.1.1.1.1.1.1" xref="S5.E15X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml">ref</mi><mo id="S5.E15X.3.2.2.m1.2.2.2.2.2.2.2.2.2" xref="S5.E15X.3.2.2.m1.2.2.2.2.2.2.2.3.cmml">,</mo><mrow id="S5.E15X.3.2.2.m1.2.2.2.2.2.2.2.2.1" xref="S5.E15X.3.2.2.m1.2.2.2.2.2.2.2.2.1.cmml"><mi id="S5.E15X.3.2.2.m1.2.2.2.2.2.2.2.2.1.2" xref="S5.E15X.3.2.2.m1.2.2.2.2.2.2.2.2.1.2.cmml">t</mi><mo id="S5.E15X.3.2.2.m1.2.2.2.2.2.2.2.2.1.1" xref="S5.E15X.3.2.2.m1.2.2.2.2.2.2.2.2.1.1.cmml">+</mo><mn id="S5.E15X.3.2.2.m1.2.2.2.2.2.2.2.2.1.3" xref="S5.E15X.3.2.2.m1.2.2.2.2.2.2.2.2.1.3.cmml">1</mn></mrow></mrow></msub><mo id="S5.E15X.3.2.2.m1.9.9.9.9.9.9.1.1.1.1" xref="S5.E15X.3.2.2.m1.9.9.9.9.9.9.1.1.1.1.cmml">−</mo><msub id="S5.E15X.3.2.2.m1.9.9.9.9.9.9.1.1.1.3" xref="S5.E15X.3.2.2.m1.9.9.9.9.9.9.1.1.1.3.cmml"><mi id="S5.E15X.3.2.2.m1.9.9.9.9.9.9.1.1.1.3.2" xref="S5.E15X.3.2.2.m1.9.9.9.9.9.9.1.1.1.3.2.cmml">x</mi><mrow id="S5.E15X.3.2.2.m1.4.4.4.4.4.4.2.4" xref="S5.E15X.3.2.2.m1.4.4.4.4.4.4.2.3.cmml"><mi id="S5.E15X.3.2.2.m1.3.3.3.3.3.3.1.1" xref="S5.E15X.3.2.2.m1.3.3.3.3.3.3.1.1.cmml">ref</mi><mo id="S5.E15X.3.2.2.m1.4.4.4.4.4.4.2.4.1" xref="S5.E15X.3.2.2.m1.4.4.4.4.4.4.2.3.cmml">,</mo><mi id="S5.E15X.3.2.2.m1.4.4.4.4.4.4.2.2" xref="S5.E15X.3.2.2.m1.4.4.4.4.4.4.2.2.cmml">t</mi></mrow></msub></mrow><mo id="S5.E15X.3.2.2.m1.9.9.9.9.9.9.1.1.3" stretchy="false" xref="S5.E15X.3.2.2.m1.9.9.9.9.9.9.1.1.1.cmml">)</mo></mrow><mn id="S5.E15X.3.2.2.m1.9.9.9.9.9.9.3" xref="S5.E15X.3.2.2.m1.9.9.9.9.9.9.3.cmml">2</mn></msup><mo id="S5.E15X.3.2.2.m1.10.10.10.10.10.11" xref="S5.E15X.3.2.2.m1.10.10.10.10.10.11.cmml">+</mo><msup id="S5.E15X.3.2.2.m1.10.10.10.10.10.10" xref="S5.E15X.3.2.2.m1.10.10.10.10.10.10.cmml"><mrow id="S5.E15X.3.2.2.m1.10.10.10.10.10.10.1.1" xref="S5.E15X.3.2.2.m1.10.10.10.10.10.10.1.1.1.cmml"><mo id="S5.E15X.3.2.2.m1.10.10.10.10.10.10.1.1.2" stretchy="false" xref="S5.E15X.3.2.2.m1.10.10.10.10.10.10.1.1.1.cmml">(</mo><mrow id="S5.E15X.3.2.2.m1.10.10.10.10.10.10.1.1.1" xref="S5.E15X.3.2.2.m1.10.10.10.10.10.10.1.1.1.cmml"><msub id="S5.E15X.3.2.2.m1.10.10.10.10.10.10.1.1.1.2" xref="S5.E15X.3.2.2.m1.10.10.10.10.10.10.1.1.1.2.cmml"><mi id="S5.E15X.3.2.2.m1.10.10.10.10.10.10.1.1.1.2.2" xref="S5.E15X.3.2.2.m1.10.10.10.10.10.10.1.1.1.2.2.cmml">y</mi><mrow id="S5.E15X.3.2.2.m1.6.6.6.6.6.6.2.2" xref="S5.E15X.3.2.2.m1.6.6.6.6.6.6.2.3.cmml"><mi id="S5.E15X.3.2.2.m1.5.5.5.5.5.5.1.1" xref="S5.E15X.3.2.2.m1.5.5.5.5.5.5.1.1.cmml">ref</mi><mo id="S5.E15X.3.2.2.m1.6.6.6.6.6.6.2.2.2" xref="S5.E15X.3.2.2.m1.6.6.6.6.6.6.2.3.cmml">,</mo><mrow id="S5.E15X.3.2.2.m1.6.6.6.6.6.6.2.2.1" xref="S5.E15X.3.2.2.m1.6.6.6.6.6.6.2.2.1.cmml"><mi id="S5.E15X.3.2.2.m1.6.6.6.6.6.6.2.2.1.2" xref="S5.E15X.3.2.2.m1.6.6.6.6.6.6.2.2.1.2.cmml">t</mi><mo id="S5.E15X.3.2.2.m1.6.6.6.6.6.6.2.2.1.1" xref="S5.E15X.3.2.2.m1.6.6.6.6.6.6.2.2.1.1.cmml">+</mo><mn id="S5.E15X.3.2.2.m1.6.6.6.6.6.6.2.2.1.3" xref="S5.E15X.3.2.2.m1.6.6.6.6.6.6.2.2.1.3.cmml">1</mn></mrow></mrow></msub><mo id="S5.E15X.3.2.2.m1.10.10.10.10.10.10.1.1.1.1" xref="S5.E15X.3.2.2.m1.10.10.10.10.10.10.1.1.1.1.cmml">−</mo><msub id="S5.E15X.3.2.2.m1.10.10.10.10.10.10.1.1.1.3" xref="S5.E15X.3.2.2.m1.10.10.10.10.10.10.1.1.1.3.cmml"><mi id="S5.E15X.3.2.2.m1.10.10.10.10.10.10.1.1.1.3.2" xref="S5.E15X.3.2.2.m1.10.10.10.10.10.10.1.1.1.3.2.cmml">y</mi><mrow id="S5.E15X.3.2.2.m1.8.8.8.8.8.8.2.4" xref="S5.E15X.3.2.2.m1.8.8.8.8.8.8.2.3.cmml"><mi id="S5.E15X.3.2.2.m1.7.7.7.7.7.7.1.1" xref="S5.E15X.3.2.2.m1.7.7.7.7.7.7.1.1.cmml">ref</mi><mo id="S5.E15X.3.2.2.m1.8.8.8.8.8.8.2.4.1" xref="S5.E15X.3.2.2.m1.8.8.8.8.8.8.2.3.cmml">,</mo><mi id="S5.E15X.3.2.2.m1.8.8.8.8.8.8.2.2" xref="S5.E15X.3.2.2.m1.8.8.8.8.8.8.2.2.cmml">t</mi></mrow></msub></mrow><mo id="S5.E15X.3.2.2.m1.10.10.10.10.10.10.1.1.3" stretchy="false" xref="S5.E15X.3.2.2.m1.10.10.10.10.10.10.1.1.1.cmml">)</mo></mrow><mn id="S5.E15X.3.2.2.m1.10.10.10.10.10.10.3" xref="S5.E15X.3.2.2.m1.10.10.10.10.10.10.3.cmml">2</mn></msup></mrow></msqrt><mrow id="S5.E15X.3.2.2.m1.10.10.12" xref="S5.E15X.3.2.2.m1.10.10.12.cmml"><mi id="S5.E15X.3.2.2.m1.10.10.12.2" xref="S5.E15X.3.2.2.m1.10.10.12.2.cmml">d</mi><mo id="S5.E15X.3.2.2.m1.10.10.12.1" xref="S5.E15X.3.2.2.m1.10.10.12.1.cmml">⁢</mo><mi id="S5.E15X.3.2.2.m1.10.10.12.3" xref="S5.E15X.3.2.2.m1.10.10.12.3.cmml">t</mi></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S5.E15X.3.2.2.m1.10b"><apply id="S5.E15X.3.2.2.m1.10.11.cmml" xref="S5.E15X.3.2.2.m1.10.11"><eq id="S5.E15X.3.2.2.m1.10.11.1.cmml" xref="S5.E15X.3.2.2.m1.10.11.1"></eq><csymbol cd="latexml" id="S5.E15X.3.2.2.m1.10.11.2.cmml" xref="S5.E15X.3.2.2.m1.10.11.2">absent</csymbol><apply id="S5.E15X.3.2.2.m1.10.10.cmml" xref="S5.E15X.3.2.2.m1.10.10"><divide id="S5.E15X.3.2.2.m1.10.10.11.cmml" xref="S5.E15X.3.2.2.m1.10.10"></divide><apply id="S5.E15X.3.2.2.m1.10.10.10.cmml" xref="S5.E15X.3.2.2.m1.10.10.10"><root id="S5.E15X.3.2.2.m1.10.10.10a.cmml" xref="S5.E15X.3.2.2.m1.10.10.10"></root><apply id="S5.E15X.3.2.2.m1.10.10.10.10.10.cmml" xref="S5.E15X.3.2.2.m1.10.10.10.10.10"><plus id="S5.E15X.3.2.2.m1.10.10.10.10.10.11.cmml" xref="S5.E15X.3.2.2.m1.10.10.10.10.10.11"></plus><apply id="S5.E15X.3.2.2.m1.9.9.9.9.9.9.cmml" xref="S5.E15X.3.2.2.m1.9.9.9.9.9.9"><csymbol cd="ambiguous" id="S5.E15X.3.2.2.m1.9.9.9.9.9.9.2.cmml" xref="S5.E15X.3.2.2.m1.9.9.9.9.9.9">superscript</csymbol><apply id="S5.E15X.3.2.2.m1.9.9.9.9.9.9.1.1.1.cmml" xref="S5.E15X.3.2.2.m1.9.9.9.9.9.9.1.1"><minus id="S5.E15X.3.2.2.m1.9.9.9.9.9.9.1.1.1.1.cmml" xref="S5.E15X.3.2.2.m1.9.9.9.9.9.9.1.1.1.1"></minus><apply id="S5.E15X.3.2.2.m1.9.9.9.9.9.9.1.1.1.2.cmml" xref="S5.E15X.3.2.2.m1.9.9.9.9.9.9.1.1.1.2"><csymbol cd="ambiguous" id="S5.E15X.3.2.2.m1.9.9.9.9.9.9.1.1.1.2.1.cmml" xref="S5.E15X.3.2.2.m1.9.9.9.9.9.9.1.1.1.2">subscript</csymbol><ci id="S5.E15X.3.2.2.m1.9.9.9.9.9.9.1.1.1.2.2.cmml" xref="S5.E15X.3.2.2.m1.9.9.9.9.9.9.1.1.1.2.2">𝑥</ci><list id="S5.E15X.3.2.2.m1.2.2.2.2.2.2.2.3.cmml" xref="S5.E15X.3.2.2.m1.2.2.2.2.2.2.2.2"><ci id="S5.E15X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml" xref="S5.E15X.3.2.2.m1.1.1.1.1.1.1.1.1">ref</ci><apply id="S5.E15X.3.2.2.m1.2.2.2.2.2.2.2.2.1.cmml" xref="S5.E15X.3.2.2.m1.2.2.2.2.2.2.2.2.1"><plus id="S5.E15X.3.2.2.m1.2.2.2.2.2.2.2.2.1.1.cmml" xref="S5.E15X.3.2.2.m1.2.2.2.2.2.2.2.2.1.1"></plus><ci id="S5.E15X.3.2.2.m1.2.2.2.2.2.2.2.2.1.2.cmml" xref="S5.E15X.3.2.2.m1.2.2.2.2.2.2.2.2.1.2">𝑡</ci><cn id="S5.E15X.3.2.2.m1.2.2.2.2.2.2.2.2.1.3.cmml" type="integer" xref="S5.E15X.3.2.2.m1.2.2.2.2.2.2.2.2.1.3">1</cn></apply></list></apply><apply id="S5.E15X.3.2.2.m1.9.9.9.9.9.9.1.1.1.3.cmml" xref="S5.E15X.3.2.2.m1.9.9.9.9.9.9.1.1.1.3"><csymbol cd="ambiguous" id="S5.E15X.3.2.2.m1.9.9.9.9.9.9.1.1.1.3.1.cmml" xref="S5.E15X.3.2.2.m1.9.9.9.9.9.9.1.1.1.3">subscript</csymbol><ci id="S5.E15X.3.2.2.m1.9.9.9.9.9.9.1.1.1.3.2.cmml" xref="S5.E15X.3.2.2.m1.9.9.9.9.9.9.1.1.1.3.2">𝑥</ci><list id="S5.E15X.3.2.2.m1.4.4.4.4.4.4.2.3.cmml" xref="S5.E15X.3.2.2.m1.4.4.4.4.4.4.2.4"><ci id="S5.E15X.3.2.2.m1.3.3.3.3.3.3.1.1.cmml" xref="S5.E15X.3.2.2.m1.3.3.3.3.3.3.1.1">ref</ci><ci id="S5.E15X.3.2.2.m1.4.4.4.4.4.4.2.2.cmml" xref="S5.E15X.3.2.2.m1.4.4.4.4.4.4.2.2">𝑡</ci></list></apply></apply><cn id="S5.E15X.3.2.2.m1.9.9.9.9.9.9.3.cmml" type="integer" xref="S5.E15X.3.2.2.m1.9.9.9.9.9.9.3">2</cn></apply><apply id="S5.E15X.3.2.2.m1.10.10.10.10.10.10.cmml" xref="S5.E15X.3.2.2.m1.10.10.10.10.10.10"><csymbol cd="ambiguous" id="S5.E15X.3.2.2.m1.10.10.10.10.10.10.2.cmml" xref="S5.E15X.3.2.2.m1.10.10.10.10.10.10">superscript</csymbol><apply id="S5.E15X.3.2.2.m1.10.10.10.10.10.10.1.1.1.cmml" xref="S5.E15X.3.2.2.m1.10.10.10.10.10.10.1.1"><minus id="S5.E15X.3.2.2.m1.10.10.10.10.10.10.1.1.1.1.cmml" xref="S5.E15X.3.2.2.m1.10.10.10.10.10.10.1.1.1.1"></minus><apply id="S5.E15X.3.2.2.m1.10.10.10.10.10.10.1.1.1.2.cmml" xref="S5.E15X.3.2.2.m1.10.10.10.10.10.10.1.1.1.2"><csymbol cd="ambiguous" id="S5.E15X.3.2.2.m1.10.10.10.10.10.10.1.1.1.2.1.cmml" xref="S5.E15X.3.2.2.m1.10.10.10.10.10.10.1.1.1.2">subscript</csymbol><ci id="S5.E15X.3.2.2.m1.10.10.10.10.10.10.1.1.1.2.2.cmml" xref="S5.E15X.3.2.2.m1.10.10.10.10.10.10.1.1.1.2.2">𝑦</ci><list id="S5.E15X.3.2.2.m1.6.6.6.6.6.6.2.3.cmml" xref="S5.E15X.3.2.2.m1.6.6.6.6.6.6.2.2"><ci id="S5.E15X.3.2.2.m1.5.5.5.5.5.5.1.1.cmml" xref="S5.E15X.3.2.2.m1.5.5.5.5.5.5.1.1">ref</ci><apply id="S5.E15X.3.2.2.m1.6.6.6.6.6.6.2.2.1.cmml" xref="S5.E15X.3.2.2.m1.6.6.6.6.6.6.2.2.1"><plus id="S5.E15X.3.2.2.m1.6.6.6.6.6.6.2.2.1.1.cmml" xref="S5.E15X.3.2.2.m1.6.6.6.6.6.6.2.2.1.1"></plus><ci id="S5.E15X.3.2.2.m1.6.6.6.6.6.6.2.2.1.2.cmml" xref="S5.E15X.3.2.2.m1.6.6.6.6.6.6.2.2.1.2">𝑡</ci><cn id="S5.E15X.3.2.2.m1.6.6.6.6.6.6.2.2.1.3.cmml" type="integer" xref="S5.E15X.3.2.2.m1.6.6.6.6.6.6.2.2.1.3">1</cn></apply></list></apply><apply id="S5.E15X.3.2.2.m1.10.10.10.10.10.10.1.1.1.3.cmml" xref="S5.E15X.3.2.2.m1.10.10.10.10.10.10.1.1.1.3"><csymbol cd="ambiguous" id="S5.E15X.3.2.2.m1.10.10.10.10.10.10.1.1.1.3.1.cmml" xref="S5.E15X.3.2.2.m1.10.10.10.10.10.10.1.1.1.3">subscript</csymbol><ci id="S5.E15X.3.2.2.m1.10.10.10.10.10.10.1.1.1.3.2.cmml" xref="S5.E15X.3.2.2.m1.10.10.10.10.10.10.1.1.1.3.2">𝑦</ci><list id="S5.E15X.3.2.2.m1.8.8.8.8.8.8.2.3.cmml" xref="S5.E15X.3.2.2.m1.8.8.8.8.8.8.2.4"><ci id="S5.E15X.3.2.2.m1.7.7.7.7.7.7.1.1.cmml" xref="S5.E15X.3.2.2.m1.7.7.7.7.7.7.1.1">ref</ci><ci id="S5.E15X.3.2.2.m1.8.8.8.8.8.8.2.2.cmml" xref="S5.E15X.3.2.2.m1.8.8.8.8.8.8.2.2">𝑡</ci></list></apply></apply><cn id="S5.E15X.3.2.2.m1.10.10.10.10.10.10.3.cmml" type="integer" xref="S5.E15X.3.2.2.m1.10.10.10.10.10.10.3">2</cn></apply></apply></apply><apply id="S5.E15X.3.2.2.m1.10.10.12.cmml" xref="S5.E15X.3.2.2.m1.10.10.12"><times id="S5.E15X.3.2.2.m1.10.10.12.1.cmml" xref="S5.E15X.3.2.2.m1.10.10.12.1"></times><ci id="S5.E15X.3.2.2.m1.10.10.12.2.cmml" xref="S5.E15X.3.2.2.m1.10.10.12.2">𝑑</ci><ci id="S5.E15X.3.2.2.m1.10.10.12.3.cmml" xref="S5.E15X.3.2.2.m1.10.10.12.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E15X.3.2.2.m1.10c">\displaystyle=\dfrac{\sqrt{(x_{\mathrm{ref},t+1}-x_{\mathrm{ref},t})^{2}+(y_{%
\mathrm{ref},t+1}-y_{\mathrm{ref},t})^{2}}}{dt}</annotation><annotation encoding="application/x-llamapun" id="S5.E15X.3.2.2.m1.10d">= divide start_ARG square-root start_ARG ( italic_x start_POSTSUBSCRIPT roman_ref , italic_t + 1 end_POSTSUBSCRIPT - italic_x start_POSTSUBSCRIPT roman_ref , italic_t end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + ( italic_y start_POSTSUBSCRIPT roman_ref , italic_t + 1 end_POSTSUBSCRIPT - italic_y start_POSTSUBSCRIPT roman_ref , italic_t end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG end_ARG start_ARG italic_d italic_t end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(15)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S5.E15Xa">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\omega_{\mathrm{ref},t}" class="ltx_Math" display="inline" id="S5.E15Xa.2.1.1.m1.2"><semantics id="S5.E15Xa.2.1.1.m1.2a"><msub id="S5.E15Xa.2.1.1.m1.2.3" xref="S5.E15Xa.2.1.1.m1.2.3.cmml"><mi id="S5.E15Xa.2.1.1.m1.2.3.2" xref="S5.E15Xa.2.1.1.m1.2.3.2.cmml">ω</mi><mrow id="S5.E15Xa.2.1.1.m1.2.2.2.4" xref="S5.E15Xa.2.1.1.m1.2.2.2.3.cmml"><mi id="S5.E15Xa.2.1.1.m1.1.1.1.1" xref="S5.E15Xa.2.1.1.m1.1.1.1.1.cmml">ref</mi><mo id="S5.E15Xa.2.1.1.m1.2.2.2.4.1" xref="S5.E15Xa.2.1.1.m1.2.2.2.3.cmml">,</mo><mi id="S5.E15Xa.2.1.1.m1.2.2.2.2" xref="S5.E15Xa.2.1.1.m1.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.E15Xa.2.1.1.m1.2b"><apply id="S5.E15Xa.2.1.1.m1.2.3.cmml" xref="S5.E15Xa.2.1.1.m1.2.3"><csymbol cd="ambiguous" id="S5.E15Xa.2.1.1.m1.2.3.1.cmml" xref="S5.E15Xa.2.1.1.m1.2.3">subscript</csymbol><ci id="S5.E15Xa.2.1.1.m1.2.3.2.cmml" xref="S5.E15Xa.2.1.1.m1.2.3.2">𝜔</ci><list id="S5.E15Xa.2.1.1.m1.2.2.2.3.cmml" xref="S5.E15Xa.2.1.1.m1.2.2.2.4"><ci id="S5.E15Xa.2.1.1.m1.1.1.1.1.cmml" xref="S5.E15Xa.2.1.1.m1.1.1.1.1">ref</ci><ci id="S5.E15Xa.2.1.1.m1.2.2.2.2.cmml" xref="S5.E15Xa.2.1.1.m1.2.2.2.2">𝑡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E15Xa.2.1.1.m1.2c">\displaystyle\omega_{\mathrm{ref},t}</annotation><annotation encoding="application/x-llamapun" id="S5.E15Xa.2.1.1.m1.2d">italic_ω start_POSTSUBSCRIPT roman_ref , italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\dfrac{(\psi_{\mathrm{ref},t+1}-\psi_{\mathrm{ref},t})}{dt}" class="ltx_Math" display="inline" id="S5.E15Xa.3.2.2.m1.5"><semantics id="S5.E15Xa.3.2.2.m1.5a"><mrow id="S5.E15Xa.3.2.2.m1.5.6" xref="S5.E15Xa.3.2.2.m1.5.6.cmml"><mi id="S5.E15Xa.3.2.2.m1.5.6.2" xref="S5.E15Xa.3.2.2.m1.5.6.2.cmml"></mi><mo id="S5.E15Xa.3.2.2.m1.5.6.1" xref="S5.E15Xa.3.2.2.m1.5.6.1.cmml">=</mo><mstyle displaystyle="true" id="S5.E15Xa.3.2.2.m1.5.5" xref="S5.E15Xa.3.2.2.m1.5.5.cmml"><mfrac id="S5.E15Xa.3.2.2.m1.5.5a" xref="S5.E15Xa.3.2.2.m1.5.5.cmml"><mrow id="S5.E15Xa.3.2.2.m1.5.5.5.5" xref="S5.E15Xa.3.2.2.m1.5.5.5.5.1.cmml"><mo id="S5.E15Xa.3.2.2.m1.5.5.5.5.2" stretchy="false" xref="S5.E15Xa.3.2.2.m1.5.5.5.5.1.cmml">(</mo><mrow id="S5.E15Xa.3.2.2.m1.5.5.5.5.1" xref="S5.E15Xa.3.2.2.m1.5.5.5.5.1.cmml"><msub id="S5.E15Xa.3.2.2.m1.5.5.5.5.1.2" xref="S5.E15Xa.3.2.2.m1.5.5.5.5.1.2.cmml"><mi id="S5.E15Xa.3.2.2.m1.5.5.5.5.1.2.2" xref="S5.E15Xa.3.2.2.m1.5.5.5.5.1.2.2.cmml">ψ</mi><mrow id="S5.E15Xa.3.2.2.m1.2.2.2.2.2.2" xref="S5.E15Xa.3.2.2.m1.2.2.2.2.2.3.cmml"><mi id="S5.E15Xa.3.2.2.m1.1.1.1.1.1.1" xref="S5.E15Xa.3.2.2.m1.1.1.1.1.1.1.cmml">ref</mi><mo id="S5.E15Xa.3.2.2.m1.2.2.2.2.2.2.2" xref="S5.E15Xa.3.2.2.m1.2.2.2.2.2.3.cmml">,</mo><mrow id="S5.E15Xa.3.2.2.m1.2.2.2.2.2.2.1" xref="S5.E15Xa.3.2.2.m1.2.2.2.2.2.2.1.cmml"><mi id="S5.E15Xa.3.2.2.m1.2.2.2.2.2.2.1.2" xref="S5.E15Xa.3.2.2.m1.2.2.2.2.2.2.1.2.cmml">t</mi><mo id="S5.E15Xa.3.2.2.m1.2.2.2.2.2.2.1.1" xref="S5.E15Xa.3.2.2.m1.2.2.2.2.2.2.1.1.cmml">+</mo><mn id="S5.E15Xa.3.2.2.m1.2.2.2.2.2.2.1.3" xref="S5.E15Xa.3.2.2.m1.2.2.2.2.2.2.1.3.cmml">1</mn></mrow></mrow></msub><mo id="S5.E15Xa.3.2.2.m1.5.5.5.5.1.1" xref="S5.E15Xa.3.2.2.m1.5.5.5.5.1.1.cmml">−</mo><msub id="S5.E15Xa.3.2.2.m1.5.5.5.5.1.3" xref="S5.E15Xa.3.2.2.m1.5.5.5.5.1.3.cmml"><mi id="S5.E15Xa.3.2.2.m1.5.5.5.5.1.3.2" xref="S5.E15Xa.3.2.2.m1.5.5.5.5.1.3.2.cmml">ψ</mi><mrow id="S5.E15Xa.3.2.2.m1.4.4.4.4.2.4" xref="S5.E15Xa.3.2.2.m1.4.4.4.4.2.3.cmml"><mi id="S5.E15Xa.3.2.2.m1.3.3.3.3.1.1" xref="S5.E15Xa.3.2.2.m1.3.3.3.3.1.1.cmml">ref</mi><mo id="S5.E15Xa.3.2.2.m1.4.4.4.4.2.4.1" xref="S5.E15Xa.3.2.2.m1.4.4.4.4.2.3.cmml">,</mo><mi id="S5.E15Xa.3.2.2.m1.4.4.4.4.2.2" xref="S5.E15Xa.3.2.2.m1.4.4.4.4.2.2.cmml">t</mi></mrow></msub></mrow><mo id="S5.E15Xa.3.2.2.m1.5.5.5.5.3" stretchy="false" xref="S5.E15Xa.3.2.2.m1.5.5.5.5.1.cmml">)</mo></mrow><mrow id="S5.E15Xa.3.2.2.m1.5.5.7" xref="S5.E15Xa.3.2.2.m1.5.5.7.cmml"><mi id="S5.E15Xa.3.2.2.m1.5.5.7.2" xref="S5.E15Xa.3.2.2.m1.5.5.7.2.cmml">d</mi><mo id="S5.E15Xa.3.2.2.m1.5.5.7.1" xref="S5.E15Xa.3.2.2.m1.5.5.7.1.cmml">⁢</mo><mi id="S5.E15Xa.3.2.2.m1.5.5.7.3" xref="S5.E15Xa.3.2.2.m1.5.5.7.3.cmml">t</mi></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S5.E15Xa.3.2.2.m1.5b"><apply id="S5.E15Xa.3.2.2.m1.5.6.cmml" xref="S5.E15Xa.3.2.2.m1.5.6"><eq id="S5.E15Xa.3.2.2.m1.5.6.1.cmml" xref="S5.E15Xa.3.2.2.m1.5.6.1"></eq><csymbol cd="latexml" id="S5.E15Xa.3.2.2.m1.5.6.2.cmml" xref="S5.E15Xa.3.2.2.m1.5.6.2">absent</csymbol><apply id="S5.E15Xa.3.2.2.m1.5.5.cmml" xref="S5.E15Xa.3.2.2.m1.5.5"><divide id="S5.E15Xa.3.2.2.m1.5.5.6.cmml" xref="S5.E15Xa.3.2.2.m1.5.5"></divide><apply id="S5.E15Xa.3.2.2.m1.5.5.5.5.1.cmml" xref="S5.E15Xa.3.2.2.m1.5.5.5.5"><minus id="S5.E15Xa.3.2.2.m1.5.5.5.5.1.1.cmml" xref="S5.E15Xa.3.2.2.m1.5.5.5.5.1.1"></minus><apply id="S5.E15Xa.3.2.2.m1.5.5.5.5.1.2.cmml" xref="S5.E15Xa.3.2.2.m1.5.5.5.5.1.2"><csymbol cd="ambiguous" id="S5.E15Xa.3.2.2.m1.5.5.5.5.1.2.1.cmml" xref="S5.E15Xa.3.2.2.m1.5.5.5.5.1.2">subscript</csymbol><ci id="S5.E15Xa.3.2.2.m1.5.5.5.5.1.2.2.cmml" xref="S5.E15Xa.3.2.2.m1.5.5.5.5.1.2.2">𝜓</ci><list id="S5.E15Xa.3.2.2.m1.2.2.2.2.2.3.cmml" xref="S5.E15Xa.3.2.2.m1.2.2.2.2.2.2"><ci id="S5.E15Xa.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S5.E15Xa.3.2.2.m1.1.1.1.1.1.1">ref</ci><apply id="S5.E15Xa.3.2.2.m1.2.2.2.2.2.2.1.cmml" xref="S5.E15Xa.3.2.2.m1.2.2.2.2.2.2.1"><plus id="S5.E15Xa.3.2.2.m1.2.2.2.2.2.2.1.1.cmml" xref="S5.E15Xa.3.2.2.m1.2.2.2.2.2.2.1.1"></plus><ci id="S5.E15Xa.3.2.2.m1.2.2.2.2.2.2.1.2.cmml" xref="S5.E15Xa.3.2.2.m1.2.2.2.2.2.2.1.2">𝑡</ci><cn id="S5.E15Xa.3.2.2.m1.2.2.2.2.2.2.1.3.cmml" type="integer" xref="S5.E15Xa.3.2.2.m1.2.2.2.2.2.2.1.3">1</cn></apply></list></apply><apply id="S5.E15Xa.3.2.2.m1.5.5.5.5.1.3.cmml" xref="S5.E15Xa.3.2.2.m1.5.5.5.5.1.3"><csymbol cd="ambiguous" id="S5.E15Xa.3.2.2.m1.5.5.5.5.1.3.1.cmml" xref="S5.E15Xa.3.2.2.m1.5.5.5.5.1.3">subscript</csymbol><ci id="S5.E15Xa.3.2.2.m1.5.5.5.5.1.3.2.cmml" xref="S5.E15Xa.3.2.2.m1.5.5.5.5.1.3.2">𝜓</ci><list id="S5.E15Xa.3.2.2.m1.4.4.4.4.2.3.cmml" xref="S5.E15Xa.3.2.2.m1.4.4.4.4.2.4"><ci id="S5.E15Xa.3.2.2.m1.3.3.3.3.1.1.cmml" xref="S5.E15Xa.3.2.2.m1.3.3.3.3.1.1">ref</ci><ci id="S5.E15Xa.3.2.2.m1.4.4.4.4.2.2.cmml" xref="S5.E15Xa.3.2.2.m1.4.4.4.4.2.2">𝑡</ci></list></apply></apply><apply id="S5.E15Xa.3.2.2.m1.5.5.7.cmml" xref="S5.E15Xa.3.2.2.m1.5.5.7"><times id="S5.E15Xa.3.2.2.m1.5.5.7.1.cmml" xref="S5.E15Xa.3.2.2.m1.5.5.7.1"></times><ci id="S5.E15Xa.3.2.2.m1.5.5.7.2.cmml" xref="S5.E15Xa.3.2.2.m1.5.5.7.2">𝑑</ci><ci id="S5.E15Xa.3.2.2.m1.5.5.7.3.cmml" xref="S5.E15Xa.3.2.2.m1.5.5.7.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E15Xa.3.2.2.m1.5c">\displaystyle=\dfrac{(\psi_{\mathrm{ref},t+1}-\psi_{\mathrm{ref},t})}{dt}</annotation><annotation encoding="application/x-llamapun" id="S5.E15Xa.3.2.2.m1.5d">= divide start_ARG ( italic_ψ start_POSTSUBSCRIPT roman_ref , italic_t + 1 end_POSTSUBSCRIPT - italic_ψ start_POSTSUBSCRIPT roman_ref , italic_t end_POSTSUBSCRIPT ) end_ARG start_ARG italic_d italic_t end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S5.SS2.p2.18">The reference trajectories prepared by Eqs. (<a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S5.E14" title="In 5.2 Path Tracking Tasks ‣ 5 Experiments ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">14</span></a>) and (<a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S5.E15" title="In 5.2 Path Tracking Tasks ‣ 5 Experiments ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">15</span></a>) are given to Kanayama Control.
Meanwhile, the cost function for the lower-level MPC is set as follows:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S5.E16">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S5.E16X">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle c_{t}" class="ltx_Math" display="inline" id="S5.E16X.2.1.1.m1.1"><semantics id="S5.E16X.2.1.1.m1.1a"><msub id="S5.E16X.2.1.1.m1.1.1" xref="S5.E16X.2.1.1.m1.1.1.cmml"><mi id="S5.E16X.2.1.1.m1.1.1.2" xref="S5.E16X.2.1.1.m1.1.1.2.cmml">c</mi><mi id="S5.E16X.2.1.1.m1.1.1.3" xref="S5.E16X.2.1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S5.E16X.2.1.1.m1.1b"><apply id="S5.E16X.2.1.1.m1.1.1.cmml" xref="S5.E16X.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.E16X.2.1.1.m1.1.1.1.cmml" xref="S5.E16X.2.1.1.m1.1.1">subscript</csymbol><ci id="S5.E16X.2.1.1.m1.1.1.2.cmml" xref="S5.E16X.2.1.1.m1.1.1.2">𝑐</ci><ci id="S5.E16X.2.1.1.m1.1.1.3.cmml" xref="S5.E16X.2.1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E16X.2.1.1.m1.1c">\displaystyle c_{t}</annotation><annotation encoding="application/x-llamapun" id="S5.E16X.2.1.1.m1.1d">italic_c start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=10\,d(5,v_{\mathrm{base},t},v_{\mathrm{goal},t})+5\,d(5,\omega_{%
\mathrm{base},t},\omega_{\mathrm{goal},t})" class="ltx_Math" display="inline" id="S5.E16X.3.2.2.m1.14"><semantics id="S5.E16X.3.2.2.m1.14a"><mrow id="S5.E16X.3.2.2.m1.14.14" xref="S5.E16X.3.2.2.m1.14.14.cmml"><mi id="S5.E16X.3.2.2.m1.14.14.6" xref="S5.E16X.3.2.2.m1.14.14.6.cmml"></mi><mo id="S5.E16X.3.2.2.m1.14.14.5" xref="S5.E16X.3.2.2.m1.14.14.5.cmml">=</mo><mrow id="S5.E16X.3.2.2.m1.14.14.4" xref="S5.E16X.3.2.2.m1.14.14.4.cmml"><mrow id="S5.E16X.3.2.2.m1.12.12.2.2" xref="S5.E16X.3.2.2.m1.12.12.2.2.cmml"><mn id="S5.E16X.3.2.2.m1.12.12.2.2.4" xref="S5.E16X.3.2.2.m1.12.12.2.2.4.cmml">10</mn><mo id="S5.E16X.3.2.2.m1.12.12.2.2.3" lspace="0.170em" xref="S5.E16X.3.2.2.m1.12.12.2.2.3.cmml">⁢</mo><mi id="S5.E16X.3.2.2.m1.12.12.2.2.5" xref="S5.E16X.3.2.2.m1.12.12.2.2.5.cmml">d</mi><mo id="S5.E16X.3.2.2.m1.12.12.2.2.3a" xref="S5.E16X.3.2.2.m1.12.12.2.2.3.cmml">⁢</mo><mrow id="S5.E16X.3.2.2.m1.12.12.2.2.2.2" xref="S5.E16X.3.2.2.m1.12.12.2.2.2.3.cmml"><mo id="S5.E16X.3.2.2.m1.12.12.2.2.2.2.3" stretchy="false" xref="S5.E16X.3.2.2.m1.12.12.2.2.2.3.cmml">(</mo><mn id="S5.E16X.3.2.2.m1.9.9" xref="S5.E16X.3.2.2.m1.9.9.cmml">5</mn><mo id="S5.E16X.3.2.2.m1.12.12.2.2.2.2.4" xref="S5.E16X.3.2.2.m1.12.12.2.2.2.3.cmml">,</mo><msub id="S5.E16X.3.2.2.m1.11.11.1.1.1.1.1" xref="S5.E16X.3.2.2.m1.11.11.1.1.1.1.1.cmml"><mi id="S5.E16X.3.2.2.m1.11.11.1.1.1.1.1.2" xref="S5.E16X.3.2.2.m1.11.11.1.1.1.1.1.2.cmml">v</mi><mrow id="S5.E16X.3.2.2.m1.2.2.2.4" xref="S5.E16X.3.2.2.m1.2.2.2.3.cmml"><mi id="S5.E16X.3.2.2.m1.1.1.1.1" xref="S5.E16X.3.2.2.m1.1.1.1.1.cmml">base</mi><mo id="S5.E16X.3.2.2.m1.2.2.2.4.1" xref="S5.E16X.3.2.2.m1.2.2.2.3.cmml">,</mo><mi id="S5.E16X.3.2.2.m1.2.2.2.2" xref="S5.E16X.3.2.2.m1.2.2.2.2.cmml">t</mi></mrow></msub><mo id="S5.E16X.3.2.2.m1.12.12.2.2.2.2.5" xref="S5.E16X.3.2.2.m1.12.12.2.2.2.3.cmml">,</mo><msub id="S5.E16X.3.2.2.m1.12.12.2.2.2.2.2" xref="S5.E16X.3.2.2.m1.12.12.2.2.2.2.2.cmml"><mi id="S5.E16X.3.2.2.m1.12.12.2.2.2.2.2.2" xref="S5.E16X.3.2.2.m1.12.12.2.2.2.2.2.2.cmml">v</mi><mrow id="S5.E16X.3.2.2.m1.4.4.2.4" xref="S5.E16X.3.2.2.m1.4.4.2.3.cmml"><mi id="S5.E16X.3.2.2.m1.3.3.1.1" xref="S5.E16X.3.2.2.m1.3.3.1.1.cmml">goal</mi><mo id="S5.E16X.3.2.2.m1.4.4.2.4.1" xref="S5.E16X.3.2.2.m1.4.4.2.3.cmml">,</mo><mi id="S5.E16X.3.2.2.m1.4.4.2.2" xref="S5.E16X.3.2.2.m1.4.4.2.2.cmml">t</mi></mrow></msub><mo id="S5.E16X.3.2.2.m1.12.12.2.2.2.2.6" stretchy="false" xref="S5.E16X.3.2.2.m1.12.12.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S5.E16X.3.2.2.m1.14.14.4.5" xref="S5.E16X.3.2.2.m1.14.14.4.5.cmml">+</mo><mrow id="S5.E16X.3.2.2.m1.14.14.4.4" xref="S5.E16X.3.2.2.m1.14.14.4.4.cmml"><mn id="S5.E16X.3.2.2.m1.14.14.4.4.4" xref="S5.E16X.3.2.2.m1.14.14.4.4.4.cmml">5</mn><mo id="S5.E16X.3.2.2.m1.14.14.4.4.3" lspace="0.170em" xref="S5.E16X.3.2.2.m1.14.14.4.4.3.cmml">⁢</mo><mi id="S5.E16X.3.2.2.m1.14.14.4.4.5" xref="S5.E16X.3.2.2.m1.14.14.4.4.5.cmml">d</mi><mo id="S5.E16X.3.2.2.m1.14.14.4.4.3a" xref="S5.E16X.3.2.2.m1.14.14.4.4.3.cmml">⁢</mo><mrow id="S5.E16X.3.2.2.m1.14.14.4.4.2.2" xref="S5.E16X.3.2.2.m1.14.14.4.4.2.3.cmml"><mo id="S5.E16X.3.2.2.m1.14.14.4.4.2.2.3" stretchy="false" xref="S5.E16X.3.2.2.m1.14.14.4.4.2.3.cmml">(</mo><mn id="S5.E16X.3.2.2.m1.10.10" xref="S5.E16X.3.2.2.m1.10.10.cmml">5</mn><mo id="S5.E16X.3.2.2.m1.14.14.4.4.2.2.4" xref="S5.E16X.3.2.2.m1.14.14.4.4.2.3.cmml">,</mo><msub id="S5.E16X.3.2.2.m1.13.13.3.3.1.1.1" xref="S5.E16X.3.2.2.m1.13.13.3.3.1.1.1.cmml"><mi id="S5.E16X.3.2.2.m1.13.13.3.3.1.1.1.2" xref="S5.E16X.3.2.2.m1.13.13.3.3.1.1.1.2.cmml">ω</mi><mrow id="S5.E16X.3.2.2.m1.6.6.2.4" xref="S5.E16X.3.2.2.m1.6.6.2.3.cmml"><mi id="S5.E16X.3.2.2.m1.5.5.1.1" xref="S5.E16X.3.2.2.m1.5.5.1.1.cmml">base</mi><mo id="S5.E16X.3.2.2.m1.6.6.2.4.1" xref="S5.E16X.3.2.2.m1.6.6.2.3.cmml">,</mo><mi id="S5.E16X.3.2.2.m1.6.6.2.2" xref="S5.E16X.3.2.2.m1.6.6.2.2.cmml">t</mi></mrow></msub><mo id="S5.E16X.3.2.2.m1.14.14.4.4.2.2.5" xref="S5.E16X.3.2.2.m1.14.14.4.4.2.3.cmml">,</mo><msub id="S5.E16X.3.2.2.m1.14.14.4.4.2.2.2" xref="S5.E16X.3.2.2.m1.14.14.4.4.2.2.2.cmml"><mi id="S5.E16X.3.2.2.m1.14.14.4.4.2.2.2.2" xref="S5.E16X.3.2.2.m1.14.14.4.4.2.2.2.2.cmml">ω</mi><mrow id="S5.E16X.3.2.2.m1.8.8.2.4" xref="S5.E16X.3.2.2.m1.8.8.2.3.cmml"><mi id="S5.E16X.3.2.2.m1.7.7.1.1" xref="S5.E16X.3.2.2.m1.7.7.1.1.cmml">goal</mi><mo id="S5.E16X.3.2.2.m1.8.8.2.4.1" xref="S5.E16X.3.2.2.m1.8.8.2.3.cmml">,</mo><mi id="S5.E16X.3.2.2.m1.8.8.2.2" xref="S5.E16X.3.2.2.m1.8.8.2.2.cmml">t</mi></mrow></msub><mo id="S5.E16X.3.2.2.m1.14.14.4.4.2.2.6" stretchy="false" xref="S5.E16X.3.2.2.m1.14.14.4.4.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.E16X.3.2.2.m1.14b"><apply id="S5.E16X.3.2.2.m1.14.14.cmml" xref="S5.E16X.3.2.2.m1.14.14"><eq id="S5.E16X.3.2.2.m1.14.14.5.cmml" xref="S5.E16X.3.2.2.m1.14.14.5"></eq><csymbol cd="latexml" id="S5.E16X.3.2.2.m1.14.14.6.cmml" xref="S5.E16X.3.2.2.m1.14.14.6">absent</csymbol><apply id="S5.E16X.3.2.2.m1.14.14.4.cmml" xref="S5.E16X.3.2.2.m1.14.14.4"><plus id="S5.E16X.3.2.2.m1.14.14.4.5.cmml" xref="S5.E16X.3.2.2.m1.14.14.4.5"></plus><apply id="S5.E16X.3.2.2.m1.12.12.2.2.cmml" xref="S5.E16X.3.2.2.m1.12.12.2.2"><times id="S5.E16X.3.2.2.m1.12.12.2.2.3.cmml" xref="S5.E16X.3.2.2.m1.12.12.2.2.3"></times><cn id="S5.E16X.3.2.2.m1.12.12.2.2.4.cmml" type="integer" xref="S5.E16X.3.2.2.m1.12.12.2.2.4">10</cn><ci id="S5.E16X.3.2.2.m1.12.12.2.2.5.cmml" xref="S5.E16X.3.2.2.m1.12.12.2.2.5">𝑑</ci><vector id="S5.E16X.3.2.2.m1.12.12.2.2.2.3.cmml" xref="S5.E16X.3.2.2.m1.12.12.2.2.2.2"><cn id="S5.E16X.3.2.2.m1.9.9.cmml" type="integer" xref="S5.E16X.3.2.2.m1.9.9">5</cn><apply id="S5.E16X.3.2.2.m1.11.11.1.1.1.1.1.cmml" xref="S5.E16X.3.2.2.m1.11.11.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.E16X.3.2.2.m1.11.11.1.1.1.1.1.1.cmml" xref="S5.E16X.3.2.2.m1.11.11.1.1.1.1.1">subscript</csymbol><ci id="S5.E16X.3.2.2.m1.11.11.1.1.1.1.1.2.cmml" xref="S5.E16X.3.2.2.m1.11.11.1.1.1.1.1.2">𝑣</ci><list id="S5.E16X.3.2.2.m1.2.2.2.3.cmml" xref="S5.E16X.3.2.2.m1.2.2.2.4"><ci id="S5.E16X.3.2.2.m1.1.1.1.1.cmml" xref="S5.E16X.3.2.2.m1.1.1.1.1">base</ci><ci id="S5.E16X.3.2.2.m1.2.2.2.2.cmml" xref="S5.E16X.3.2.2.m1.2.2.2.2">𝑡</ci></list></apply><apply id="S5.E16X.3.2.2.m1.12.12.2.2.2.2.2.cmml" xref="S5.E16X.3.2.2.m1.12.12.2.2.2.2.2"><csymbol cd="ambiguous" id="S5.E16X.3.2.2.m1.12.12.2.2.2.2.2.1.cmml" xref="S5.E16X.3.2.2.m1.12.12.2.2.2.2.2">subscript</csymbol><ci id="S5.E16X.3.2.2.m1.12.12.2.2.2.2.2.2.cmml" xref="S5.E16X.3.2.2.m1.12.12.2.2.2.2.2.2">𝑣</ci><list id="S5.E16X.3.2.2.m1.4.4.2.3.cmml" xref="S5.E16X.3.2.2.m1.4.4.2.4"><ci id="S5.E16X.3.2.2.m1.3.3.1.1.cmml" xref="S5.E16X.3.2.2.m1.3.3.1.1">goal</ci><ci id="S5.E16X.3.2.2.m1.4.4.2.2.cmml" xref="S5.E16X.3.2.2.m1.4.4.2.2">𝑡</ci></list></apply></vector></apply><apply id="S5.E16X.3.2.2.m1.14.14.4.4.cmml" xref="S5.E16X.3.2.2.m1.14.14.4.4"><times id="S5.E16X.3.2.2.m1.14.14.4.4.3.cmml" xref="S5.E16X.3.2.2.m1.14.14.4.4.3"></times><cn id="S5.E16X.3.2.2.m1.14.14.4.4.4.cmml" type="integer" xref="S5.E16X.3.2.2.m1.14.14.4.4.4">5</cn><ci id="S5.E16X.3.2.2.m1.14.14.4.4.5.cmml" xref="S5.E16X.3.2.2.m1.14.14.4.4.5">𝑑</ci><vector id="S5.E16X.3.2.2.m1.14.14.4.4.2.3.cmml" xref="S5.E16X.3.2.2.m1.14.14.4.4.2.2"><cn id="S5.E16X.3.2.2.m1.10.10.cmml" type="integer" xref="S5.E16X.3.2.2.m1.10.10">5</cn><apply id="S5.E16X.3.2.2.m1.13.13.3.3.1.1.1.cmml" xref="S5.E16X.3.2.2.m1.13.13.3.3.1.1.1"><csymbol cd="ambiguous" id="S5.E16X.3.2.2.m1.13.13.3.3.1.1.1.1.cmml" xref="S5.E16X.3.2.2.m1.13.13.3.3.1.1.1">subscript</csymbol><ci id="S5.E16X.3.2.2.m1.13.13.3.3.1.1.1.2.cmml" xref="S5.E16X.3.2.2.m1.13.13.3.3.1.1.1.2">𝜔</ci><list id="S5.E16X.3.2.2.m1.6.6.2.3.cmml" xref="S5.E16X.3.2.2.m1.6.6.2.4"><ci id="S5.E16X.3.2.2.m1.5.5.1.1.cmml" xref="S5.E16X.3.2.2.m1.5.5.1.1">base</ci><ci id="S5.E16X.3.2.2.m1.6.6.2.2.cmml" xref="S5.E16X.3.2.2.m1.6.6.2.2">𝑡</ci></list></apply><apply id="S5.E16X.3.2.2.m1.14.14.4.4.2.2.2.cmml" xref="S5.E16X.3.2.2.m1.14.14.4.4.2.2.2"><csymbol cd="ambiguous" id="S5.E16X.3.2.2.m1.14.14.4.4.2.2.2.1.cmml" xref="S5.E16X.3.2.2.m1.14.14.4.4.2.2.2">subscript</csymbol><ci id="S5.E16X.3.2.2.m1.14.14.4.4.2.2.2.2.cmml" xref="S5.E16X.3.2.2.m1.14.14.4.4.2.2.2.2">𝜔</ci><list id="S5.E16X.3.2.2.m1.8.8.2.3.cmml" xref="S5.E16X.3.2.2.m1.8.8.2.4"><ci id="S5.E16X.3.2.2.m1.7.7.1.1.cmml" xref="S5.E16X.3.2.2.m1.7.7.1.1">goal</ci><ci id="S5.E16X.3.2.2.m1.8.8.2.2.cmml" xref="S5.E16X.3.2.2.m1.8.8.2.2">𝑡</ci></list></apply></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E16X.3.2.2.m1.14c">\displaystyle=10\,d(5,v_{\mathrm{base},t},v_{\mathrm{goal},t})+5\,d(5,\omega_{%
\mathrm{base},t},\omega_{\mathrm{goal},t})</annotation><annotation encoding="application/x-llamapun" id="S5.E16X.3.2.2.m1.14d">= 10 italic_d ( 5 , italic_v start_POSTSUBSCRIPT roman_base , italic_t end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT roman_goal , italic_t end_POSTSUBSCRIPT ) + 5 italic_d ( 5 , italic_ω start_POSTSUBSCRIPT roman_base , italic_t end_POSTSUBSCRIPT , italic_ω start_POSTSUBSCRIPT roman_goal , italic_t end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(16)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S5.E16Xa">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle+3\,\mathbbm{1}(p_{z_{\mathrm{{base,wheel}}}}&lt;z_{\mathrm{th}})+%
\boldsymbol{u}_{t}^{\mathrm{T}}\boldsymbol{\Sigma}^{-1}\boldsymbol{u}_{t}." class="ltx_Math" display="inline" id="S5.E16Xa.2.1.1.m1.3"><semantics id="S5.E16Xa.2.1.1.m1.3a"><mrow id="S5.E16Xa.2.1.1.m1.3.3.1" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.cmml"><mrow id="S5.E16Xa.2.1.1.m1.3.3.1.1" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.cmml"><mrow id="S5.E16Xa.2.1.1.m1.3.3.1.1.1" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.1.cmml"><mo id="S5.E16Xa.2.1.1.m1.3.3.1.1.1a" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.1.cmml">+</mo><mrow id="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.cmml"><mn id="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.3" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.3.cmml">3</mn><mo id="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.2" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.2.cmml">⁢</mo><mn class="ltx_mathvariant_double-struck" id="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.4" mathvariant="double-struck" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.4.cmml"> 1</mn><mo id="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.2a" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.2.cmml">⁢</mo><mrow id="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.1.1" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.cmml"><mo id="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2" stretchy="false" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.cmml"><msub id="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mi id="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.2" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.2.cmml">p</mi><msub id="S5.E16Xa.2.1.1.m1.2.2.2" xref="S5.E16Xa.2.1.1.m1.2.2.2.cmml"><mi id="S5.E16Xa.2.1.1.m1.2.2.2.4" xref="S5.E16Xa.2.1.1.m1.2.2.2.4.cmml">z</mi><mrow id="S5.E16Xa.2.1.1.m1.2.2.2.2.2.4" xref="S5.E16Xa.2.1.1.m1.2.2.2.2.2.3.cmml"><mi id="S5.E16Xa.2.1.1.m1.1.1.1.1.1.1" xref="S5.E16Xa.2.1.1.m1.1.1.1.1.1.1.cmml">base</mi><mo id="S5.E16Xa.2.1.1.m1.2.2.2.2.2.4.1" xref="S5.E16Xa.2.1.1.m1.2.2.2.2.2.3.cmml">,</mo><mi id="S5.E16Xa.2.1.1.m1.2.2.2.2.2.2" xref="S5.E16Xa.2.1.1.m1.2.2.2.2.2.2.cmml">wheel</mi></mrow></msub></msub><mo id="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.cmml">&lt;</mo><msub id="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.3" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.3.cmml"><mi id="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.3.2" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.3.2.cmml">z</mi><mi id="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.3.3" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.3.3.cmml">th</mi></msub></mrow><mo id="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.1.1.3" stretchy="false" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S5.E16Xa.2.1.1.m1.3.3.1.1.2" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.2.cmml">+</mo><mrow id="S5.E16Xa.2.1.1.m1.3.3.1.1.3" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.3.cmml"><msubsup id="S5.E16Xa.2.1.1.m1.3.3.1.1.3.2" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.3.2.cmml"><mi id="S5.E16Xa.2.1.1.m1.3.3.1.1.3.2.2.2" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.3.2.2.2.cmml">𝒖</mi><mi id="S5.E16Xa.2.1.1.m1.3.3.1.1.3.2.2.3" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.3.2.2.3.cmml">t</mi><mi id="S5.E16Xa.2.1.1.m1.3.3.1.1.3.2.3" mathvariant="normal" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.3.2.3.cmml">T</mi></msubsup><mo id="S5.E16Xa.2.1.1.m1.3.3.1.1.3.1" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.3.1.cmml">⁢</mo><msup id="S5.E16Xa.2.1.1.m1.3.3.1.1.3.3" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.3.3.cmml"><mi id="S5.E16Xa.2.1.1.m1.3.3.1.1.3.3.2" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.3.3.2.cmml">𝚺</mi><mrow id="S5.E16Xa.2.1.1.m1.3.3.1.1.3.3.3" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.3.3.3.cmml"><mo id="S5.E16Xa.2.1.1.m1.3.3.1.1.3.3.3a" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.3.3.3.cmml">−</mo><mn id="S5.E16Xa.2.1.1.m1.3.3.1.1.3.3.3.2" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.3.3.3.2.cmml">1</mn></mrow></msup><mo id="S5.E16Xa.2.1.1.m1.3.3.1.1.3.1a" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.3.1.cmml">⁢</mo><msub id="S5.E16Xa.2.1.1.m1.3.3.1.1.3.4" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.3.4.cmml"><mi id="S5.E16Xa.2.1.1.m1.3.3.1.1.3.4.2" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.3.4.2.cmml">𝒖</mi><mi id="S5.E16Xa.2.1.1.m1.3.3.1.1.3.4.3" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.3.4.3.cmml">t</mi></msub></mrow></mrow><mo id="S5.E16Xa.2.1.1.m1.3.3.1.2" lspace="0em" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E16Xa.2.1.1.m1.3b"><apply id="S5.E16Xa.2.1.1.m1.3.3.1.1.cmml" xref="S5.E16Xa.2.1.1.m1.3.3.1"><plus id="S5.E16Xa.2.1.1.m1.3.3.1.1.2.cmml" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.2"></plus><apply id="S5.E16Xa.2.1.1.m1.3.3.1.1.1.cmml" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.1"><plus id="S5.E16Xa.2.1.1.m1.3.3.1.1.1.2.cmml" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.1"></plus><apply id="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.cmml" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1"><times id="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.2.cmml" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.2"></times><cn id="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.3.cmml" type="integer" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.3">3</cn><cn id="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.4.cmml" type="integer" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.4">1</cn><apply id="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.1.1"><lt id="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1"></lt><apply id="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.2">𝑝</ci><apply id="S5.E16Xa.2.1.1.m1.2.2.2.cmml" xref="S5.E16Xa.2.1.1.m1.2.2.2"><csymbol cd="ambiguous" id="S5.E16Xa.2.1.1.m1.2.2.2.3.cmml" xref="S5.E16Xa.2.1.1.m1.2.2.2">subscript</csymbol><ci id="S5.E16Xa.2.1.1.m1.2.2.2.4.cmml" xref="S5.E16Xa.2.1.1.m1.2.2.2.4">𝑧</ci><list id="S5.E16Xa.2.1.1.m1.2.2.2.2.2.3.cmml" xref="S5.E16Xa.2.1.1.m1.2.2.2.2.2.4"><ci id="S5.E16Xa.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S5.E16Xa.2.1.1.m1.1.1.1.1.1.1">base</ci><ci id="S5.E16Xa.2.1.1.m1.2.2.2.2.2.2.cmml" xref="S5.E16Xa.2.1.1.m1.2.2.2.2.2.2">wheel</ci></list></apply></apply><apply id="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.3.2">𝑧</ci><ci id="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.3.3.cmml" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.3.3">th</ci></apply></apply></apply></apply><apply id="S5.E16Xa.2.1.1.m1.3.3.1.1.3.cmml" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.3"><times id="S5.E16Xa.2.1.1.m1.3.3.1.1.3.1.cmml" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.3.1"></times><apply id="S5.E16Xa.2.1.1.m1.3.3.1.1.3.2.cmml" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.3.2"><csymbol cd="ambiguous" id="S5.E16Xa.2.1.1.m1.3.3.1.1.3.2.1.cmml" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.3.2">superscript</csymbol><apply id="S5.E16Xa.2.1.1.m1.3.3.1.1.3.2.2.cmml" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.3.2"><csymbol cd="ambiguous" id="S5.E16Xa.2.1.1.m1.3.3.1.1.3.2.2.1.cmml" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.3.2">subscript</csymbol><ci id="S5.E16Xa.2.1.1.m1.3.3.1.1.3.2.2.2.cmml" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.3.2.2.2">𝒖</ci><ci id="S5.E16Xa.2.1.1.m1.3.3.1.1.3.2.2.3.cmml" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.3.2.2.3">𝑡</ci></apply><ci id="S5.E16Xa.2.1.1.m1.3.3.1.1.3.2.3.cmml" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.3.2.3">T</ci></apply><apply id="S5.E16Xa.2.1.1.m1.3.3.1.1.3.3.cmml" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.3.3"><csymbol cd="ambiguous" id="S5.E16Xa.2.1.1.m1.3.3.1.1.3.3.1.cmml" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.3.3">superscript</csymbol><ci id="S5.E16Xa.2.1.1.m1.3.3.1.1.3.3.2.cmml" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.3.3.2">𝚺</ci><apply id="S5.E16Xa.2.1.1.m1.3.3.1.1.3.3.3.cmml" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.3.3.3"><minus id="S5.E16Xa.2.1.1.m1.3.3.1.1.3.3.3.1.cmml" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.3.3.3"></minus><cn id="S5.E16Xa.2.1.1.m1.3.3.1.1.3.3.3.2.cmml" type="integer" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.3.3.3.2">1</cn></apply></apply><apply id="S5.E16Xa.2.1.1.m1.3.3.1.1.3.4.cmml" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.3.4"><csymbol cd="ambiguous" id="S5.E16Xa.2.1.1.m1.3.3.1.1.3.4.1.cmml" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.3.4">subscript</csymbol><ci id="S5.E16Xa.2.1.1.m1.3.3.1.1.3.4.2.cmml" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.3.4.2">𝒖</ci><ci id="S5.E16Xa.2.1.1.m1.3.3.1.1.3.4.3.cmml" xref="S5.E16Xa.2.1.1.m1.3.3.1.1.3.4.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E16Xa.2.1.1.m1.3c">\displaystyle+3\,\mathbbm{1}(p_{z_{\mathrm{{base,wheel}}}}&lt;z_{\mathrm{th}})+%
\boldsymbol{u}_{t}^{\mathrm{T}}\boldsymbol{\Sigma}^{-1}\boldsymbol{u}_{t}.</annotation><annotation encoding="application/x-llamapun" id="S5.E16Xa.2.1.1.m1.3d">+ 3 blackboard_1 ( italic_p start_POSTSUBSCRIPT italic_z start_POSTSUBSCRIPT roman_base , roman_wheel end_POSTSUBSCRIPT end_POSTSUBSCRIPT &lt; italic_z start_POSTSUBSCRIPT roman_th end_POSTSUBSCRIPT ) + bold_italic_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_T end_POSTSUPERSCRIPT bold_Σ start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT bold_italic_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S5.SS2.p2.4">where <math alttext="d" class="ltx_Math" display="inline" id="S5.SS2.p2.4.m1.1"><semantics id="S5.SS2.p2.4.m1.1a"><mi id="S5.SS2.p2.4.m1.1.1" xref="S5.SS2.p2.4.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.4.m1.1b"><ci id="S5.SS2.p2.4.m1.1.1.cmml" xref="S5.SS2.p2.4.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.4.m1.1c">d</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.4.m1.1d">italic_d</annotation></semantics></math> is defined as:</p>
<table class="ltx_equation ltx_eqn_table" id="S5.E17">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="d(a,b,\beta)=\left(1-\exp\left(-\beta\|a-b\|^{2}\right)\right)." class="ltx_Math" display="block" id="S5.E17.m1.5"><semantics id="S5.E17.m1.5a"><mrow id="S5.E17.m1.5.5.1" xref="S5.E17.m1.5.5.1.1.cmml"><mrow id="S5.E17.m1.5.5.1.1" xref="S5.E17.m1.5.5.1.1.cmml"><mrow id="S5.E17.m1.5.5.1.1.3" xref="S5.E17.m1.5.5.1.1.3.cmml"><mi id="S5.E17.m1.5.5.1.1.3.2" xref="S5.E17.m1.5.5.1.1.3.2.cmml">d</mi><mo id="S5.E17.m1.5.5.1.1.3.1" xref="S5.E17.m1.5.5.1.1.3.1.cmml">⁢</mo><mrow id="S5.E17.m1.5.5.1.1.3.3.2" xref="S5.E17.m1.5.5.1.1.3.3.1.cmml"><mo id="S5.E17.m1.5.5.1.1.3.3.2.1" stretchy="false" xref="S5.E17.m1.5.5.1.1.3.3.1.cmml">(</mo><mi id="S5.E17.m1.1.1" xref="S5.E17.m1.1.1.cmml">a</mi><mo id="S5.E17.m1.5.5.1.1.3.3.2.2" xref="S5.E17.m1.5.5.1.1.3.3.1.cmml">,</mo><mi id="S5.E17.m1.2.2" xref="S5.E17.m1.2.2.cmml">b</mi><mo id="S5.E17.m1.5.5.1.1.3.3.2.3" xref="S5.E17.m1.5.5.1.1.3.3.1.cmml">,</mo><mi id="S5.E17.m1.3.3" xref="S5.E17.m1.3.3.cmml">β</mi><mo id="S5.E17.m1.5.5.1.1.3.3.2.4" stretchy="false" xref="S5.E17.m1.5.5.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S5.E17.m1.5.5.1.1.2" xref="S5.E17.m1.5.5.1.1.2.cmml">=</mo><mrow id="S5.E17.m1.5.5.1.1.1.1" xref="S5.E17.m1.5.5.1.1.1.1.1.cmml"><mo id="S5.E17.m1.5.5.1.1.1.1.2" xref="S5.E17.m1.5.5.1.1.1.1.1.cmml">(</mo><mrow id="S5.E17.m1.5.5.1.1.1.1.1" xref="S5.E17.m1.5.5.1.1.1.1.1.cmml"><mn id="S5.E17.m1.5.5.1.1.1.1.1.3" xref="S5.E17.m1.5.5.1.1.1.1.1.3.cmml">1</mn><mo id="S5.E17.m1.5.5.1.1.1.1.1.2" xref="S5.E17.m1.5.5.1.1.1.1.1.2.cmml">−</mo><mrow id="S5.E17.m1.5.5.1.1.1.1.1.1.1" xref="S5.E17.m1.5.5.1.1.1.1.1.1.2.cmml"><mi id="S5.E17.m1.4.4" xref="S5.E17.m1.4.4.cmml">exp</mi><mo id="S5.E17.m1.5.5.1.1.1.1.1.1.1a" xref="S5.E17.m1.5.5.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S5.E17.m1.5.5.1.1.1.1.1.1.1.1" xref="S5.E17.m1.5.5.1.1.1.1.1.1.2.cmml"><mo id="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.2" xref="S5.E17.m1.5.5.1.1.1.1.1.1.2.cmml">(</mo><mrow id="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1" xref="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"><mo id="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1a" xref="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1" xref="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1.3" xref="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.cmml">β</mi><mo id="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1.2" xref="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1.1" xref="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">a</mi><mo id="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">b</mi></mrow><mo id="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3" xref="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow><mo id="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.3" xref="S5.E17.m1.5.5.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S5.E17.m1.5.5.1.1.1.1.3" xref="S5.E17.m1.5.5.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S5.E17.m1.5.5.1.2" lspace="0em" xref="S5.E17.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E17.m1.5b"><apply id="S5.E17.m1.5.5.1.1.cmml" xref="S5.E17.m1.5.5.1"><eq id="S5.E17.m1.5.5.1.1.2.cmml" xref="S5.E17.m1.5.5.1.1.2"></eq><apply id="S5.E17.m1.5.5.1.1.3.cmml" xref="S5.E17.m1.5.5.1.1.3"><times id="S5.E17.m1.5.5.1.1.3.1.cmml" xref="S5.E17.m1.5.5.1.1.3.1"></times><ci id="S5.E17.m1.5.5.1.1.3.2.cmml" xref="S5.E17.m1.5.5.1.1.3.2">𝑑</ci><vector id="S5.E17.m1.5.5.1.1.3.3.1.cmml" xref="S5.E17.m1.5.5.1.1.3.3.2"><ci id="S5.E17.m1.1.1.cmml" xref="S5.E17.m1.1.1">𝑎</ci><ci id="S5.E17.m1.2.2.cmml" xref="S5.E17.m1.2.2">𝑏</ci><ci id="S5.E17.m1.3.3.cmml" xref="S5.E17.m1.3.3">𝛽</ci></vector></apply><apply id="S5.E17.m1.5.5.1.1.1.1.1.cmml" xref="S5.E17.m1.5.5.1.1.1.1"><minus id="S5.E17.m1.5.5.1.1.1.1.1.2.cmml" xref="S5.E17.m1.5.5.1.1.1.1.1.2"></minus><cn id="S5.E17.m1.5.5.1.1.1.1.1.3.cmml" type="integer" xref="S5.E17.m1.5.5.1.1.1.1.1.3">1</cn><apply id="S5.E17.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S5.E17.m1.5.5.1.1.1.1.1.1.1"><exp id="S5.E17.m1.4.4.cmml" xref="S5.E17.m1.4.4"></exp><apply id="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1"><minus id="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1"></minus><apply id="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1"><times id="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1.3">𝛽</ci><apply id="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><minus id="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"></minus><ci id="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑎</ci><ci id="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑏</ci></apply></apply><cn id="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S5.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E17.m1.5c">d(a,b,\beta)=\left(1-\exp\left(-\beta\|a-b\|^{2}\right)\right).</annotation><annotation encoding="application/x-llamapun" id="S5.E17.m1.5d">italic_d ( italic_a , italic_b , italic_β ) = ( 1 - roman_exp ( - italic_β ∥ italic_a - italic_b ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S5.SS2.p2.16">Its value ranges from <math alttext="d(a,b,\beta)\in[0,1)" class="ltx_Math" display="inline" id="S5.SS2.p2.5.m1.5"><semantics id="S5.SS2.p2.5.m1.5a"><mrow id="S5.SS2.p2.5.m1.5.6" xref="S5.SS2.p2.5.m1.5.6.cmml"><mrow id="S5.SS2.p2.5.m1.5.6.2" xref="S5.SS2.p2.5.m1.5.6.2.cmml"><mi id="S5.SS2.p2.5.m1.5.6.2.2" xref="S5.SS2.p2.5.m1.5.6.2.2.cmml">d</mi><mo id="S5.SS2.p2.5.m1.5.6.2.1" xref="S5.SS2.p2.5.m1.5.6.2.1.cmml">⁢</mo><mrow id="S5.SS2.p2.5.m1.5.6.2.3.2" xref="S5.SS2.p2.5.m1.5.6.2.3.1.cmml"><mo id="S5.SS2.p2.5.m1.5.6.2.3.2.1" stretchy="false" xref="S5.SS2.p2.5.m1.5.6.2.3.1.cmml">(</mo><mi id="S5.SS2.p2.5.m1.1.1" xref="S5.SS2.p2.5.m1.1.1.cmml">a</mi><mo id="S5.SS2.p2.5.m1.5.6.2.3.2.2" xref="S5.SS2.p2.5.m1.5.6.2.3.1.cmml">,</mo><mi id="S5.SS2.p2.5.m1.2.2" xref="S5.SS2.p2.5.m1.2.2.cmml">b</mi><mo id="S5.SS2.p2.5.m1.5.6.2.3.2.3" xref="S5.SS2.p2.5.m1.5.6.2.3.1.cmml">,</mo><mi id="S5.SS2.p2.5.m1.3.3" xref="S5.SS2.p2.5.m1.3.3.cmml">β</mi><mo id="S5.SS2.p2.5.m1.5.6.2.3.2.4" stretchy="false" xref="S5.SS2.p2.5.m1.5.6.2.3.1.cmml">)</mo></mrow></mrow><mo id="S5.SS2.p2.5.m1.5.6.1" xref="S5.SS2.p2.5.m1.5.6.1.cmml">∈</mo><mrow id="S5.SS2.p2.5.m1.5.6.3.2" xref="S5.SS2.p2.5.m1.5.6.3.1.cmml"><mo id="S5.SS2.p2.5.m1.5.6.3.2.1" stretchy="false" xref="S5.SS2.p2.5.m1.5.6.3.1.cmml">[</mo><mn id="S5.SS2.p2.5.m1.4.4" xref="S5.SS2.p2.5.m1.4.4.cmml">0</mn><mo id="S5.SS2.p2.5.m1.5.6.3.2.2" xref="S5.SS2.p2.5.m1.5.6.3.1.cmml">,</mo><mn id="S5.SS2.p2.5.m1.5.5" xref="S5.SS2.p2.5.m1.5.5.cmml">1</mn><mo id="S5.SS2.p2.5.m1.5.6.3.2.3" stretchy="false" xref="S5.SS2.p2.5.m1.5.6.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.5.m1.5b"><apply id="S5.SS2.p2.5.m1.5.6.cmml" xref="S5.SS2.p2.5.m1.5.6"><in id="S5.SS2.p2.5.m1.5.6.1.cmml" xref="S5.SS2.p2.5.m1.5.6.1"></in><apply id="S5.SS2.p2.5.m1.5.6.2.cmml" xref="S5.SS2.p2.5.m1.5.6.2"><times id="S5.SS2.p2.5.m1.5.6.2.1.cmml" xref="S5.SS2.p2.5.m1.5.6.2.1"></times><ci id="S5.SS2.p2.5.m1.5.6.2.2.cmml" xref="S5.SS2.p2.5.m1.5.6.2.2">𝑑</ci><vector id="S5.SS2.p2.5.m1.5.6.2.3.1.cmml" xref="S5.SS2.p2.5.m1.5.6.2.3.2"><ci id="S5.SS2.p2.5.m1.1.1.cmml" xref="S5.SS2.p2.5.m1.1.1">𝑎</ci><ci id="S5.SS2.p2.5.m1.2.2.cmml" xref="S5.SS2.p2.5.m1.2.2">𝑏</ci><ci id="S5.SS2.p2.5.m1.3.3.cmml" xref="S5.SS2.p2.5.m1.3.3">𝛽</ci></vector></apply><interval closure="closed-open" id="S5.SS2.p2.5.m1.5.6.3.1.cmml" xref="S5.SS2.p2.5.m1.5.6.3.2"><cn id="S5.SS2.p2.5.m1.4.4.cmml" type="integer" xref="S5.SS2.p2.5.m1.4.4">0</cn><cn id="S5.SS2.p2.5.m1.5.5.cmml" type="integer" xref="S5.SS2.p2.5.m1.5.5">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.5.m1.5c">d(a,b,\beta)\in[0,1)</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.5.m1.5d">italic_d ( italic_a , italic_b , italic_β ) ∈ [ 0 , 1 )</annotation></semantics></math>. The function <math alttext="d" class="ltx_Math" display="inline" id="S5.SS2.p2.6.m2.1"><semantics id="S5.SS2.p2.6.m2.1a"><mi id="S5.SS2.p2.6.m2.1.1" xref="S5.SS2.p2.6.m2.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.6.m2.1b"><ci id="S5.SS2.p2.6.m2.1.1.cmml" xref="S5.SS2.p2.6.m2.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.6.m2.1c">d</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.6.m2.1d">italic_d</annotation></semantics></math> aims to minimize the distance between <math alttext="a" class="ltx_Math" display="inline" id="S5.SS2.p2.7.m3.1"><semantics id="S5.SS2.p2.7.m3.1a"><mi id="S5.SS2.p2.7.m3.1.1" xref="S5.SS2.p2.7.m3.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.7.m3.1b"><ci id="S5.SS2.p2.7.m3.1.1.cmml" xref="S5.SS2.p2.7.m3.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.7.m3.1c">a</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.7.m3.1d">italic_a</annotation></semantics></math> and <math alttext="b" class="ltx_Math" display="inline" id="S5.SS2.p2.8.m4.1"><semantics id="S5.SS2.p2.8.m4.1a"><mi id="S5.SS2.p2.8.m4.1.1" xref="S5.SS2.p2.8.m4.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.8.m4.1b"><ci id="S5.SS2.p2.8.m4.1.1.cmml" xref="S5.SS2.p2.8.m4.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.8.m4.1c">b</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.8.m4.1d">italic_b</annotation></semantics></math>, with <math alttext="d" class="ltx_Math" display="inline" id="S5.SS2.p2.9.m5.1"><semantics id="S5.SS2.p2.9.m5.1a"><mi id="S5.SS2.p2.9.m5.1.1" xref="S5.SS2.p2.9.m5.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.9.m5.1b"><ci id="S5.SS2.p2.9.m5.1.1.cmml" xref="S5.SS2.p2.9.m5.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.9.m5.1c">d</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.9.m5.1d">italic_d</annotation></semantics></math> approaching 0 as the distance decreases, controlled by <math alttext="\beta&gt;0" class="ltx_Math" display="inline" id="S5.SS2.p2.10.m6.1"><semantics id="S5.SS2.p2.10.m6.1a"><mrow id="S5.SS2.p2.10.m6.1.1" xref="S5.SS2.p2.10.m6.1.1.cmml"><mi id="S5.SS2.p2.10.m6.1.1.2" xref="S5.SS2.p2.10.m6.1.1.2.cmml">β</mi><mo id="S5.SS2.p2.10.m6.1.1.1" xref="S5.SS2.p2.10.m6.1.1.1.cmml">&gt;</mo><mn id="S5.SS2.p2.10.m6.1.1.3" xref="S5.SS2.p2.10.m6.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.10.m6.1b"><apply id="S5.SS2.p2.10.m6.1.1.cmml" xref="S5.SS2.p2.10.m6.1.1"><gt id="S5.SS2.p2.10.m6.1.1.1.cmml" xref="S5.SS2.p2.10.m6.1.1.1"></gt><ci id="S5.SS2.p2.10.m6.1.1.2.cmml" xref="S5.SS2.p2.10.m6.1.1.2">𝛽</ci><cn id="S5.SS2.p2.10.m6.1.1.3.cmml" type="integer" xref="S5.SS2.p2.10.m6.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.10.m6.1c">\beta&gt;0</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.10.m6.1d">italic_β &gt; 0</annotation></semantics></math>.
The first and second terms in Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S5.E16" title="In 5.2 Path Tracking Tasks ‣ 5 Experiments ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">16</span></a>) aim to minimize the discrepancy at timestep <math alttext="t" class="ltx_Math" display="inline" id="S5.SS2.p2.11.m7.1"><semantics id="S5.SS2.p2.11.m7.1a"><mi id="S5.SS2.p2.11.m7.1.1" xref="S5.SS2.p2.11.m7.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.11.m7.1b"><ci id="S5.SS2.p2.11.m7.1.1.cmml" xref="S5.SS2.p2.11.m7.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.11.m7.1c">t</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.11.m7.1d">italic_t</annotation></semantics></math> between the robot’s base velocity and angular velocity, <math alttext="v_{\mathrm{base},t},\omega_{\mathrm{base},t}" class="ltx_Math" display="inline" id="S5.SS2.p2.12.m8.6"><semantics id="S5.SS2.p2.12.m8.6a"><mrow id="S5.SS2.p2.12.m8.6.6.2" xref="S5.SS2.p2.12.m8.6.6.3.cmml"><msub id="S5.SS2.p2.12.m8.5.5.1.1" xref="S5.SS2.p2.12.m8.5.5.1.1.cmml"><mi id="S5.SS2.p2.12.m8.5.5.1.1.2" xref="S5.SS2.p2.12.m8.5.5.1.1.2.cmml">v</mi><mrow id="S5.SS2.p2.12.m8.2.2.2.4" xref="S5.SS2.p2.12.m8.2.2.2.3.cmml"><mi id="S5.SS2.p2.12.m8.1.1.1.1" xref="S5.SS2.p2.12.m8.1.1.1.1.cmml">base</mi><mo id="S5.SS2.p2.12.m8.2.2.2.4.1" xref="S5.SS2.p2.12.m8.2.2.2.3.cmml">,</mo><mi id="S5.SS2.p2.12.m8.2.2.2.2" xref="S5.SS2.p2.12.m8.2.2.2.2.cmml">t</mi></mrow></msub><mo id="S5.SS2.p2.12.m8.6.6.2.3" xref="S5.SS2.p2.12.m8.6.6.3.cmml">,</mo><msub id="S5.SS2.p2.12.m8.6.6.2.2" xref="S5.SS2.p2.12.m8.6.6.2.2.cmml"><mi id="S5.SS2.p2.12.m8.6.6.2.2.2" xref="S5.SS2.p2.12.m8.6.6.2.2.2.cmml">ω</mi><mrow id="S5.SS2.p2.12.m8.4.4.2.4" xref="S5.SS2.p2.12.m8.4.4.2.3.cmml"><mi id="S5.SS2.p2.12.m8.3.3.1.1" xref="S5.SS2.p2.12.m8.3.3.1.1.cmml">base</mi><mo id="S5.SS2.p2.12.m8.4.4.2.4.1" xref="S5.SS2.p2.12.m8.4.4.2.3.cmml">,</mo><mi id="S5.SS2.p2.12.m8.4.4.2.2" xref="S5.SS2.p2.12.m8.4.4.2.2.cmml">t</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.12.m8.6b"><list id="S5.SS2.p2.12.m8.6.6.3.cmml" xref="S5.SS2.p2.12.m8.6.6.2"><apply id="S5.SS2.p2.12.m8.5.5.1.1.cmml" xref="S5.SS2.p2.12.m8.5.5.1.1"><csymbol cd="ambiguous" id="S5.SS2.p2.12.m8.5.5.1.1.1.cmml" xref="S5.SS2.p2.12.m8.5.5.1.1">subscript</csymbol><ci id="S5.SS2.p2.12.m8.5.5.1.1.2.cmml" xref="S5.SS2.p2.12.m8.5.5.1.1.2">𝑣</ci><list id="S5.SS2.p2.12.m8.2.2.2.3.cmml" xref="S5.SS2.p2.12.m8.2.2.2.4"><ci id="S5.SS2.p2.12.m8.1.1.1.1.cmml" xref="S5.SS2.p2.12.m8.1.1.1.1">base</ci><ci id="S5.SS2.p2.12.m8.2.2.2.2.cmml" xref="S5.SS2.p2.12.m8.2.2.2.2">𝑡</ci></list></apply><apply id="S5.SS2.p2.12.m8.6.6.2.2.cmml" xref="S5.SS2.p2.12.m8.6.6.2.2"><csymbol cd="ambiguous" id="S5.SS2.p2.12.m8.6.6.2.2.1.cmml" xref="S5.SS2.p2.12.m8.6.6.2.2">subscript</csymbol><ci id="S5.SS2.p2.12.m8.6.6.2.2.2.cmml" xref="S5.SS2.p2.12.m8.6.6.2.2.2">𝜔</ci><list id="S5.SS2.p2.12.m8.4.4.2.3.cmml" xref="S5.SS2.p2.12.m8.4.4.2.4"><ci id="S5.SS2.p2.12.m8.3.3.1.1.cmml" xref="S5.SS2.p2.12.m8.3.3.1.1">base</ci><ci id="S5.SS2.p2.12.m8.4.4.2.2.cmml" xref="S5.SS2.p2.12.m8.4.4.2.2">𝑡</ci></list></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.12.m8.6c">v_{\mathrm{base},t},\omega_{\mathrm{base},t}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.12.m8.6d">italic_v start_POSTSUBSCRIPT roman_base , italic_t end_POSTSUBSCRIPT , italic_ω start_POSTSUBSCRIPT roman_base , italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, and the target velocity and angular velocity output by Kanayama Control, <math alttext="v_{\mathrm{goal},t},\omega_{\mathrm{goal},t}" class="ltx_Math" display="inline" id="S5.SS2.p2.13.m9.6"><semantics id="S5.SS2.p2.13.m9.6a"><mrow id="S5.SS2.p2.13.m9.6.6.2" xref="S5.SS2.p2.13.m9.6.6.3.cmml"><msub id="S5.SS2.p2.13.m9.5.5.1.1" xref="S5.SS2.p2.13.m9.5.5.1.1.cmml"><mi id="S5.SS2.p2.13.m9.5.5.1.1.2" xref="S5.SS2.p2.13.m9.5.5.1.1.2.cmml">v</mi><mrow id="S5.SS2.p2.13.m9.2.2.2.4" xref="S5.SS2.p2.13.m9.2.2.2.3.cmml"><mi id="S5.SS2.p2.13.m9.1.1.1.1" xref="S5.SS2.p2.13.m9.1.1.1.1.cmml">goal</mi><mo id="S5.SS2.p2.13.m9.2.2.2.4.1" xref="S5.SS2.p2.13.m9.2.2.2.3.cmml">,</mo><mi id="S5.SS2.p2.13.m9.2.2.2.2" xref="S5.SS2.p2.13.m9.2.2.2.2.cmml">t</mi></mrow></msub><mo id="S5.SS2.p2.13.m9.6.6.2.3" xref="S5.SS2.p2.13.m9.6.6.3.cmml">,</mo><msub id="S5.SS2.p2.13.m9.6.6.2.2" xref="S5.SS2.p2.13.m9.6.6.2.2.cmml"><mi id="S5.SS2.p2.13.m9.6.6.2.2.2" xref="S5.SS2.p2.13.m9.6.6.2.2.2.cmml">ω</mi><mrow id="S5.SS2.p2.13.m9.4.4.2.4" xref="S5.SS2.p2.13.m9.4.4.2.3.cmml"><mi id="S5.SS2.p2.13.m9.3.3.1.1" xref="S5.SS2.p2.13.m9.3.3.1.1.cmml">goal</mi><mo id="S5.SS2.p2.13.m9.4.4.2.4.1" xref="S5.SS2.p2.13.m9.4.4.2.3.cmml">,</mo><mi id="S5.SS2.p2.13.m9.4.4.2.2" xref="S5.SS2.p2.13.m9.4.4.2.2.cmml">t</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.13.m9.6b"><list id="S5.SS2.p2.13.m9.6.6.3.cmml" xref="S5.SS2.p2.13.m9.6.6.2"><apply id="S5.SS2.p2.13.m9.5.5.1.1.cmml" xref="S5.SS2.p2.13.m9.5.5.1.1"><csymbol cd="ambiguous" id="S5.SS2.p2.13.m9.5.5.1.1.1.cmml" xref="S5.SS2.p2.13.m9.5.5.1.1">subscript</csymbol><ci id="S5.SS2.p2.13.m9.5.5.1.1.2.cmml" xref="S5.SS2.p2.13.m9.5.5.1.1.2">𝑣</ci><list id="S5.SS2.p2.13.m9.2.2.2.3.cmml" xref="S5.SS2.p2.13.m9.2.2.2.4"><ci id="S5.SS2.p2.13.m9.1.1.1.1.cmml" xref="S5.SS2.p2.13.m9.1.1.1.1">goal</ci><ci id="S5.SS2.p2.13.m9.2.2.2.2.cmml" xref="S5.SS2.p2.13.m9.2.2.2.2">𝑡</ci></list></apply><apply id="S5.SS2.p2.13.m9.6.6.2.2.cmml" xref="S5.SS2.p2.13.m9.6.6.2.2"><csymbol cd="ambiguous" id="S5.SS2.p2.13.m9.6.6.2.2.1.cmml" xref="S5.SS2.p2.13.m9.6.6.2.2">subscript</csymbol><ci id="S5.SS2.p2.13.m9.6.6.2.2.2.cmml" xref="S5.SS2.p2.13.m9.6.6.2.2.2">𝜔</ci><list id="S5.SS2.p2.13.m9.4.4.2.3.cmml" xref="S5.SS2.p2.13.m9.4.4.2.4"><ci id="S5.SS2.p2.13.m9.3.3.1.1.cmml" xref="S5.SS2.p2.13.m9.3.3.1.1">goal</ci><ci id="S5.SS2.p2.13.m9.4.4.2.2.cmml" xref="S5.SS2.p2.13.m9.4.4.2.2">𝑡</ci></list></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.13.m9.6c">v_{\mathrm{goal},t},\omega_{\mathrm{goal},t}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.13.m9.6d">italic_v start_POSTSUBSCRIPT roman_goal , italic_t end_POSTSUBSCRIPT , italic_ω start_POSTSUBSCRIPT roman_goal , italic_t end_POSTSUBSCRIPT</annotation></semantics></math>.
The third term incurs a cost when the height of the robot’s base from the wheels, <math alttext="p_{z_{\mathrm{{base,wheel}}}}" class="ltx_Math" display="inline" id="S5.SS2.p2.14.m10.2"><semantics id="S5.SS2.p2.14.m10.2a"><msub id="S5.SS2.p2.14.m10.2.3" xref="S5.SS2.p2.14.m10.2.3.cmml"><mi id="S5.SS2.p2.14.m10.2.3.2" xref="S5.SS2.p2.14.m10.2.3.2.cmml">p</mi><msub id="S5.SS2.p2.14.m10.2.2.2" xref="S5.SS2.p2.14.m10.2.2.2.cmml"><mi id="S5.SS2.p2.14.m10.2.2.2.4" xref="S5.SS2.p2.14.m10.2.2.2.4.cmml">z</mi><mrow id="S5.SS2.p2.14.m10.2.2.2.2.2.4" xref="S5.SS2.p2.14.m10.2.2.2.2.2.3.cmml"><mi id="S5.SS2.p2.14.m10.1.1.1.1.1.1" xref="S5.SS2.p2.14.m10.1.1.1.1.1.1.cmml">base</mi><mo id="S5.SS2.p2.14.m10.2.2.2.2.2.4.1" xref="S5.SS2.p2.14.m10.2.2.2.2.2.3.cmml">,</mo><mi id="S5.SS2.p2.14.m10.2.2.2.2.2.2" xref="S5.SS2.p2.14.m10.2.2.2.2.2.2.cmml">wheel</mi></mrow></msub></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.14.m10.2b"><apply id="S5.SS2.p2.14.m10.2.3.cmml" xref="S5.SS2.p2.14.m10.2.3"><csymbol cd="ambiguous" id="S5.SS2.p2.14.m10.2.3.1.cmml" xref="S5.SS2.p2.14.m10.2.3">subscript</csymbol><ci id="S5.SS2.p2.14.m10.2.3.2.cmml" xref="S5.SS2.p2.14.m10.2.3.2">𝑝</ci><apply id="S5.SS2.p2.14.m10.2.2.2.cmml" xref="S5.SS2.p2.14.m10.2.2.2"><csymbol cd="ambiguous" id="S5.SS2.p2.14.m10.2.2.2.3.cmml" xref="S5.SS2.p2.14.m10.2.2.2">subscript</csymbol><ci id="S5.SS2.p2.14.m10.2.2.2.4.cmml" xref="S5.SS2.p2.14.m10.2.2.2.4">𝑧</ci><list id="S5.SS2.p2.14.m10.2.2.2.2.2.3.cmml" xref="S5.SS2.p2.14.m10.2.2.2.2.2.4"><ci id="S5.SS2.p2.14.m10.1.1.1.1.1.1.cmml" xref="S5.SS2.p2.14.m10.1.1.1.1.1.1">base</ci><ci id="S5.SS2.p2.14.m10.2.2.2.2.2.2.cmml" xref="S5.SS2.p2.14.m10.2.2.2.2.2.2">wheel</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.14.m10.2c">p_{z_{\mathrm{{base,wheel}}}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.14.m10.2d">italic_p start_POSTSUBSCRIPT italic_z start_POSTSUBSCRIPT roman_base , roman_wheel end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>, falls below a threshold <math alttext="z_{\mathrm{th}}" class="ltx_Math" display="inline" id="S5.SS2.p2.15.m11.1"><semantics id="S5.SS2.p2.15.m11.1a"><msub id="S5.SS2.p2.15.m11.1.1" xref="S5.SS2.p2.15.m11.1.1.cmml"><mi id="S5.SS2.p2.15.m11.1.1.2" xref="S5.SS2.p2.15.m11.1.1.2.cmml">z</mi><mi id="S5.SS2.p2.15.m11.1.1.3" xref="S5.SS2.p2.15.m11.1.1.3.cmml">th</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.15.m11.1b"><apply id="S5.SS2.p2.15.m11.1.1.cmml" xref="S5.SS2.p2.15.m11.1.1"><csymbol cd="ambiguous" id="S5.SS2.p2.15.m11.1.1.1.cmml" xref="S5.SS2.p2.15.m11.1.1">subscript</csymbol><ci id="S5.SS2.p2.15.m11.1.1.2.cmml" xref="S5.SS2.p2.15.m11.1.1.2">𝑧</ci><ci id="S5.SS2.p2.15.m11.1.1.3.cmml" xref="S5.SS2.p2.15.m11.1.1.3">th</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.15.m11.1c">z_{\mathrm{th}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.15.m11.1d">italic_z start_POSTSUBSCRIPT roman_th end_POSTSUBSCRIPT</annotation></semantics></math>, which acts to prevent the robot from tipping over.
The fourth term represents the control cost. The matrix <math alttext="\boldsymbol{\Sigma}" class="ltx_Math" display="inline" id="S5.SS2.p2.16.m12.1"><semantics id="S5.SS2.p2.16.m12.1a"><mi id="S5.SS2.p2.16.m12.1.1" xref="S5.SS2.p2.16.m12.1.1.cmml">𝚺</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.16.m12.1b"><ci id="S5.SS2.p2.16.m12.1.1.cmml" xref="S5.SS2.p2.16.m12.1.1">𝚺</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.16.m12.1c">\boldsymbol{\Sigma}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.16.m12.1d">bold_Σ</annotation></semantics></math> is the covariance of the noise in MPPI. Detailed parameters are provided in <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#A1" title="Appendix A Hyperparameter ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">A</span></a>.</p>
</div>
<div class="ltx_para" id="S5.SS2.p3">
<p class="ltx_p" id="S5.SS2.p3.3">During training, the goal variables are sampled at the start of each episode within the range of Table <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S5.T1" title="Table 1 ‣ 5.2 Path Tracking Tasks ‣ 5 Experiments ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">1</span></a>.
For the sloped surface, in each episode, a slope with angle <math alttext="\alpha_{\mathrm{target}}" class="ltx_Math" display="inline" id="S5.SS2.p3.1.m1.1"><semantics id="S5.SS2.p3.1.m1.1a"><msub id="S5.SS2.p3.1.m1.1.1" xref="S5.SS2.p3.1.m1.1.1.cmml"><mi id="S5.SS2.p3.1.m1.1.1.2" xref="S5.SS2.p3.1.m1.1.1.2.cmml">α</mi><mi id="S5.SS2.p3.1.m1.1.1.3" xref="S5.SS2.p3.1.m1.1.1.3.cmml">target</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.1.m1.1b"><apply id="S5.SS2.p3.1.m1.1.1.cmml" xref="S5.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS2.p3.1.m1.1.1.1.cmml" xref="S5.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="S5.SS2.p3.1.m1.1.1.2.cmml" xref="S5.SS2.p3.1.m1.1.1.2">𝛼</ci><ci id="S5.SS2.p3.1.m1.1.1.3.cmml" xref="S5.SS2.p3.1.m1.1.1.3">target</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.1.m1.1c">\alpha_{\mathrm{target}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p3.1.m1.1d">italic_α start_POSTSUBSCRIPT roman_target end_POSTSUBSCRIPT</annotation></semantics></math> is prepared, and by solving the MPC to follow the target values <math alttext="v_{\mathrm{target}},\omega_{\mathrm{target}}" class="ltx_Math" display="inline" id="S5.SS2.p3.2.m2.2"><semantics id="S5.SS2.p3.2.m2.2a"><mrow id="S5.SS2.p3.2.m2.2.2.2" xref="S5.SS2.p3.2.m2.2.2.3.cmml"><msub id="S5.SS2.p3.2.m2.1.1.1.1" xref="S5.SS2.p3.2.m2.1.1.1.1.cmml"><mi id="S5.SS2.p3.2.m2.1.1.1.1.2" xref="S5.SS2.p3.2.m2.1.1.1.1.2.cmml">v</mi><mi id="S5.SS2.p3.2.m2.1.1.1.1.3" xref="S5.SS2.p3.2.m2.1.1.1.1.3.cmml">target</mi></msub><mo id="S5.SS2.p3.2.m2.2.2.2.3" xref="S5.SS2.p3.2.m2.2.2.3.cmml">,</mo><msub id="S5.SS2.p3.2.m2.2.2.2.2" xref="S5.SS2.p3.2.m2.2.2.2.2.cmml"><mi id="S5.SS2.p3.2.m2.2.2.2.2.2" xref="S5.SS2.p3.2.m2.2.2.2.2.2.cmml">ω</mi><mi id="S5.SS2.p3.2.m2.2.2.2.2.3" xref="S5.SS2.p3.2.m2.2.2.2.2.3.cmml">target</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.2.m2.2b"><list id="S5.SS2.p3.2.m2.2.2.3.cmml" xref="S5.SS2.p3.2.m2.2.2.2"><apply id="S5.SS2.p3.2.m2.1.1.1.1.cmml" xref="S5.SS2.p3.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S5.SS2.p3.2.m2.1.1.1.1.1.cmml" xref="S5.SS2.p3.2.m2.1.1.1.1">subscript</csymbol><ci id="S5.SS2.p3.2.m2.1.1.1.1.2.cmml" xref="S5.SS2.p3.2.m2.1.1.1.1.2">𝑣</ci><ci id="S5.SS2.p3.2.m2.1.1.1.1.3.cmml" xref="S5.SS2.p3.2.m2.1.1.1.1.3">target</ci></apply><apply id="S5.SS2.p3.2.m2.2.2.2.2.cmml" xref="S5.SS2.p3.2.m2.2.2.2.2"><csymbol cd="ambiguous" id="S5.SS2.p3.2.m2.2.2.2.2.1.cmml" xref="S5.SS2.p3.2.m2.2.2.2.2">subscript</csymbol><ci id="S5.SS2.p3.2.m2.2.2.2.2.2.cmml" xref="S5.SS2.p3.2.m2.2.2.2.2.2">𝜔</ci><ci id="S5.SS2.p3.2.m2.2.2.2.2.3.cmml" xref="S5.SS2.p3.2.m2.2.2.2.2.3">target</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.2.m2.2c">v_{\mathrm{target}},\omega_{\mathrm{target}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p3.2.m2.2d">italic_v start_POSTSUBSCRIPT roman_target end_POSTSUBSCRIPT , italic_ω start_POSTSUBSCRIPT roman_target end_POSTSUBSCRIPT</annotation></semantics></math>, data is accumulated to learn the terminal values corresponding to each goal variable. Note that <math alttext="\alpha" class="ltx_Math" display="inline" id="S5.SS2.p3.3.m3.1"><semantics id="S5.SS2.p3.3.m3.1a"><mi id="S5.SS2.p3.3.m3.1.1" xref="S5.SS2.p3.3.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.3.m3.1b"><ci id="S5.SS2.p3.3.m3.1.1.cmml" xref="S5.SS2.p3.3.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.3.m3.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p3.3.m3.1d">italic_α</annotation></semantics></math> acts as a parameter to vary the environment and is not explicitly incorporated into the cost function.</p>
</div>
<figure class="ltx_table" id="S5.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T1.8.1.1" style="font-size:90%;">Table 1</span>: </span><span class="ltx_text" id="S5.T1.9.2" style="font-size:90%;">Goal Variables</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T1.6">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T1.6.7.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" id="S5.T1.6.7.1.1">Goal Variables</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S5.T1.6.7.1.2">Value Range</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T1.2.2">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_tt" id="S5.T1.1.1.1">Body linear velocity <math alttext="v" class="ltx_Math" display="inline" id="S5.T1.1.1.1.m1.1"><semantics id="S5.T1.1.1.1.m1.1a"><mi id="S5.T1.1.1.1.m1.1.1" xref="S5.T1.1.1.1.m1.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S5.T1.1.1.1.m1.1b"><ci id="S5.T1.1.1.1.m1.1.1.cmml" xref="S5.T1.1.1.1.m1.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.1.1.1.m1.1c">v</annotation><annotation encoding="application/x-llamapun" id="S5.T1.1.1.1.m1.1d">italic_v</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="S5.T1.2.2.2">(0,1) [<math alttext="\mathrm{m}\mathrm{/}\mathrm{s}" class="ltx_Math" display="inline" id="S5.T1.2.2.2.m1.1"><semantics id="S5.T1.2.2.2.m1.1a"><mrow id="S5.T1.2.2.2.m1.1.1" xref="S5.T1.2.2.2.m1.1.1.cmml"><mi id="S5.T1.2.2.2.m1.1.1.2" mathvariant="normal" xref="S5.T1.2.2.2.m1.1.1.2.cmml">m</mi><mo id="S5.T1.2.2.2.m1.1.1.1" xref="S5.T1.2.2.2.m1.1.1.1.cmml">/</mo><mi id="S5.T1.2.2.2.m1.1.1.3" mathvariant="normal" xref="S5.T1.2.2.2.m1.1.1.3.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.2.2.2.m1.1b"><apply id="S5.T1.2.2.2.m1.1.1.cmml" xref="S5.T1.2.2.2.m1.1.1"><divide id="S5.T1.2.2.2.m1.1.1.1.cmml" xref="S5.T1.2.2.2.m1.1.1.1"></divide><ci id="S5.T1.2.2.2.m1.1.1.2.cmml" xref="S5.T1.2.2.2.m1.1.1.2">m</ci><ci id="S5.T1.2.2.2.m1.1.1.3.cmml" xref="S5.T1.2.2.2.m1.1.1.3">s</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.2.2.2.m1.1c">\mathrm{m}\mathrm{/}\mathrm{s}</annotation><annotation encoding="application/x-llamapun" id="S5.T1.2.2.2.m1.1d">roman_m / roman_s</annotation></semantics></math>]</td>
</tr>
<tr class="ltx_tr" id="S5.T1.4.4">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="S5.T1.3.3.1">Body angular velocity <math alttext="\omega" class="ltx_Math" display="inline" id="S5.T1.3.3.1.m1.1"><semantics id="S5.T1.3.3.1.m1.1a"><mi id="S5.T1.3.3.1.m1.1.1" xref="S5.T1.3.3.1.m1.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="S5.T1.3.3.1.m1.1b"><ci id="S5.T1.3.3.1.m1.1.1.cmml" xref="S5.T1.3.3.1.m1.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.3.3.1.m1.1c">\omega</annotation><annotation encoding="application/x-llamapun" id="S5.T1.3.3.1.m1.1d">italic_ω</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T1.4.4.2">(-1.2, 1.2) [<math alttext="\mathrm{r}\mathrm{a}\mathrm{d}\mathrm{/}\mathrm{s}" class="ltx_Math" display="inline" id="S5.T1.4.4.2.m1.1"><semantics id="S5.T1.4.4.2.m1.1a"><mrow id="S5.T1.4.4.2.m1.1.1" xref="S5.T1.4.4.2.m1.1.1.cmml"><mi id="S5.T1.4.4.2.m1.1.1.2" xref="S5.T1.4.4.2.m1.1.1.2.cmml">rad</mi><mo id="S5.T1.4.4.2.m1.1.1.1" xref="S5.T1.4.4.2.m1.1.1.1.cmml">/</mo><mi id="S5.T1.4.4.2.m1.1.1.3" mathvariant="normal" xref="S5.T1.4.4.2.m1.1.1.3.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.4.4.2.m1.1b"><apply id="S5.T1.4.4.2.m1.1.1.cmml" xref="S5.T1.4.4.2.m1.1.1"><divide id="S5.T1.4.4.2.m1.1.1.1.cmml" xref="S5.T1.4.4.2.m1.1.1.1"></divide><ci id="S5.T1.4.4.2.m1.1.1.2.cmml" xref="S5.T1.4.4.2.m1.1.1.2">rad</ci><ci id="S5.T1.4.4.2.m1.1.1.3.cmml" xref="S5.T1.4.4.2.m1.1.1.3">s</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.4.4.2.m1.1c">\mathrm{r}\mathrm{a}\mathrm{d}\mathrm{/}\mathrm{s}</annotation><annotation encoding="application/x-llamapun" id="S5.T1.4.4.2.m1.1d">roman_rad / roman_s</annotation></semantics></math>]</td>
</tr>
<tr class="ltx_tr" id="S5.T1.6.6">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r" id="S5.T1.5.5.1">Slope angle <math alttext="\alpha" class="ltx_Math" display="inline" id="S5.T1.5.5.1.m1.1"><semantics id="S5.T1.5.5.1.m1.1a"><mi id="S5.T1.5.5.1.m1.1.1" xref="S5.T1.5.5.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.T1.5.5.1.m1.1b"><ci id="S5.T1.5.5.1.m1.1.1.cmml" xref="S5.T1.5.5.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.5.5.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S5.T1.5.5.1.m1.1d">italic_α</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r" id="S5.T1.6.6.2">(-25, 25) [<math alttext="\mathrm{d}\mathrm{e}\mathrm{g}" class="ltx_Math" display="inline" id="S5.T1.6.6.2.m1.1"><semantics id="S5.T1.6.6.2.m1.1a"><mi id="S5.T1.6.6.2.m1.1.1" xref="S5.T1.6.6.2.m1.1.1.cmml">deg</mi><annotation-xml encoding="MathML-Content" id="S5.T1.6.6.2.m1.1b"><ci id="S5.T1.6.6.2.m1.1.1.cmml" xref="S5.T1.6.6.2.m1.1.1">deg</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.6.6.2.m1.1c">\mathrm{d}\mathrm{e}\mathrm{g}</annotation><annotation encoding="application/x-llamapun" id="S5.T1.6.6.2.m1.1d">roman_deg</annotation></semantics></math>]</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S5.SS2.p4">
<p class="ltx_p" id="S5.SS2.p4.7">Corresponding data is retained, and the terminal values conditional on the objectives are learned.
Inputs to the terminal value function are extracted from the robot’s state, setting the observation, <math alttext="\boldsymbol{o}=\phi(\boldsymbol{x})" class="ltx_Math" display="inline" id="S5.SS2.p4.1.m1.1"><semantics id="S5.SS2.p4.1.m1.1a"><mrow id="S5.SS2.p4.1.m1.1.2" xref="S5.SS2.p4.1.m1.1.2.cmml"><mi id="S5.SS2.p4.1.m1.1.2.2" xref="S5.SS2.p4.1.m1.1.2.2.cmml">𝒐</mi><mo id="S5.SS2.p4.1.m1.1.2.1" xref="S5.SS2.p4.1.m1.1.2.1.cmml">=</mo><mrow id="S5.SS2.p4.1.m1.1.2.3" xref="S5.SS2.p4.1.m1.1.2.3.cmml"><mi id="S5.SS2.p4.1.m1.1.2.3.2" xref="S5.SS2.p4.1.m1.1.2.3.2.cmml">ϕ</mi><mo id="S5.SS2.p4.1.m1.1.2.3.1" xref="S5.SS2.p4.1.m1.1.2.3.1.cmml">⁢</mo><mrow id="S5.SS2.p4.1.m1.1.2.3.3.2" xref="S5.SS2.p4.1.m1.1.2.3.cmml"><mo id="S5.SS2.p4.1.m1.1.2.3.3.2.1" stretchy="false" xref="S5.SS2.p4.1.m1.1.2.3.cmml">(</mo><mi id="S5.SS2.p4.1.m1.1.1" xref="S5.SS2.p4.1.m1.1.1.cmml">𝒙</mi><mo id="S5.SS2.p4.1.m1.1.2.3.3.2.2" stretchy="false" xref="S5.SS2.p4.1.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p4.1.m1.1b"><apply id="S5.SS2.p4.1.m1.1.2.cmml" xref="S5.SS2.p4.1.m1.1.2"><eq id="S5.SS2.p4.1.m1.1.2.1.cmml" xref="S5.SS2.p4.1.m1.1.2.1"></eq><ci id="S5.SS2.p4.1.m1.1.2.2.cmml" xref="S5.SS2.p4.1.m1.1.2.2">𝒐</ci><apply id="S5.SS2.p4.1.m1.1.2.3.cmml" xref="S5.SS2.p4.1.m1.1.2.3"><times id="S5.SS2.p4.1.m1.1.2.3.1.cmml" xref="S5.SS2.p4.1.m1.1.2.3.1"></times><ci id="S5.SS2.p4.1.m1.1.2.3.2.cmml" xref="S5.SS2.p4.1.m1.1.2.3.2">italic-ϕ</ci><ci id="S5.SS2.p4.1.m1.1.1.cmml" xref="S5.SS2.p4.1.m1.1.1">𝒙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p4.1.m1.1c">\boldsymbol{o}=\phi(\boldsymbol{x})</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p4.1.m1.1d">bold_italic_o = italic_ϕ ( bold_italic_x )</annotation></semantics></math>, where <math alttext="\phi" class="ltx_Math" display="inline" id="S5.SS2.p4.2.m2.1"><semantics id="S5.SS2.p4.2.m2.1a"><mi id="S5.SS2.p4.2.m2.1.1" xref="S5.SS2.p4.2.m2.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p4.2.m2.1b"><ci id="S5.SS2.p4.2.m2.1.1.cmml" xref="S5.SS2.p4.2.m2.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p4.2.m2.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p4.2.m2.1d">italic_ϕ</annotation></semantics></math> is the function for extracting information.
The robot’s observation, <math alttext="\boldsymbol{o}" class="ltx_Math" display="inline" id="S5.SS2.p4.3.m3.1"><semantics id="S5.SS2.p4.3.m3.1a"><mi id="S5.SS2.p4.3.m3.1.1" xref="S5.SS2.p4.3.m3.1.1.cmml">𝒐</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p4.3.m3.1b"><ci id="S5.SS2.p4.3.m3.1.1.cmml" xref="S5.SS2.p4.3.m3.1.1">𝒐</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p4.3.m3.1c">\boldsymbol{o}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p4.3.m3.1d">bold_italic_o</annotation></semantics></math>, is given by
<math alttext="\boldsymbol{o}=[p_{z_{\mathrm{{base,wheel}}}},\dot{\boldsymbol{p}}_{\mathrm{%
base,wheel}},\boldsymbol{p}_{\mathrm{base}_{\phi,\theta,\psi}},\dot{%
\boldsymbol{p}}_{\mathrm{base}_{\phi,\theta,\psi}},\boldsymbol{q},\dot{%
\boldsymbol{q}},\boldsymbol{\omega}_{\mathrm{wheel}}]\in\mathbb{R}^{20}" class="ltx_Math" display="inline" id="S5.SS2.p4.4.m4.17"><semantics id="S5.SS2.p4.4.m4.17a"><mrow id="S5.SS2.p4.4.m4.17.17" xref="S5.SS2.p4.4.m4.17.17.cmml"><mi id="S5.SS2.p4.4.m4.17.17.7" xref="S5.SS2.p4.4.m4.17.17.7.cmml">𝒐</mi><mo id="S5.SS2.p4.4.m4.17.17.8" xref="S5.SS2.p4.4.m4.17.17.8.cmml">=</mo><mrow id="S5.SS2.p4.4.m4.17.17.5.5" xref="S5.SS2.p4.4.m4.17.17.5.6.cmml"><mo id="S5.SS2.p4.4.m4.17.17.5.5.6" stretchy="false" xref="S5.SS2.p4.4.m4.17.17.5.6.cmml">[</mo><msub id="S5.SS2.p4.4.m4.13.13.1.1.1" xref="S5.SS2.p4.4.m4.13.13.1.1.1.cmml"><mi id="S5.SS2.p4.4.m4.13.13.1.1.1.2" xref="S5.SS2.p4.4.m4.13.13.1.1.1.2.cmml">p</mi><msub id="S5.SS2.p4.4.m4.2.2.2" xref="S5.SS2.p4.4.m4.2.2.2.cmml"><mi id="S5.SS2.p4.4.m4.2.2.2.4" xref="S5.SS2.p4.4.m4.2.2.2.4.cmml">z</mi><mrow id="S5.SS2.p4.4.m4.2.2.2.2.2.4" xref="S5.SS2.p4.4.m4.2.2.2.2.2.3.cmml"><mi id="S5.SS2.p4.4.m4.1.1.1.1.1.1" xref="S5.SS2.p4.4.m4.1.1.1.1.1.1.cmml">base</mi><mo id="S5.SS2.p4.4.m4.2.2.2.2.2.4.1" xref="S5.SS2.p4.4.m4.2.2.2.2.2.3.cmml">,</mo><mi id="S5.SS2.p4.4.m4.2.2.2.2.2.2" xref="S5.SS2.p4.4.m4.2.2.2.2.2.2.cmml">wheel</mi></mrow></msub></msub><mo id="S5.SS2.p4.4.m4.17.17.5.5.7" xref="S5.SS2.p4.4.m4.17.17.5.6.cmml">,</mo><msub id="S5.SS2.p4.4.m4.14.14.2.2.2" xref="S5.SS2.p4.4.m4.14.14.2.2.2.cmml"><mover accent="true" id="S5.SS2.p4.4.m4.14.14.2.2.2.2" xref="S5.SS2.p4.4.m4.14.14.2.2.2.2.cmml"><mi id="S5.SS2.p4.4.m4.14.14.2.2.2.2.2" xref="S5.SS2.p4.4.m4.14.14.2.2.2.2.2.cmml">𝒑</mi><mo id="S5.SS2.p4.4.m4.14.14.2.2.2.2.1" xref="S5.SS2.p4.4.m4.14.14.2.2.2.2.1.cmml">˙</mo></mover><mrow id="S5.SS2.p4.4.m4.4.4.2.4" xref="S5.SS2.p4.4.m4.4.4.2.3.cmml"><mi id="S5.SS2.p4.4.m4.3.3.1.1" xref="S5.SS2.p4.4.m4.3.3.1.1.cmml">base</mi><mo id="S5.SS2.p4.4.m4.4.4.2.4.1" xref="S5.SS2.p4.4.m4.4.4.2.3.cmml">,</mo><mi id="S5.SS2.p4.4.m4.4.4.2.2" xref="S5.SS2.p4.4.m4.4.4.2.2.cmml">wheel</mi></mrow></msub><mo id="S5.SS2.p4.4.m4.17.17.5.5.8" xref="S5.SS2.p4.4.m4.17.17.5.6.cmml">,</mo><msub id="S5.SS2.p4.4.m4.15.15.3.3.3" xref="S5.SS2.p4.4.m4.15.15.3.3.3.cmml"><mi id="S5.SS2.p4.4.m4.15.15.3.3.3.2" xref="S5.SS2.p4.4.m4.15.15.3.3.3.2.cmml">𝒑</mi><msub id="S5.SS2.p4.4.m4.7.7.3" xref="S5.SS2.p4.4.m4.7.7.3.cmml"><mi id="S5.SS2.p4.4.m4.7.7.3.5" xref="S5.SS2.p4.4.m4.7.7.3.5.cmml">base</mi><mrow id="S5.SS2.p4.4.m4.7.7.3.3.3.5" xref="S5.SS2.p4.4.m4.7.7.3.3.3.4.cmml"><mi id="S5.SS2.p4.4.m4.5.5.1.1.1.1" xref="S5.SS2.p4.4.m4.5.5.1.1.1.1.cmml">ϕ</mi><mo id="S5.SS2.p4.4.m4.7.7.3.3.3.5.1" xref="S5.SS2.p4.4.m4.7.7.3.3.3.4.cmml">,</mo><mi id="S5.SS2.p4.4.m4.6.6.2.2.2.2" xref="S5.SS2.p4.4.m4.6.6.2.2.2.2.cmml">θ</mi><mo id="S5.SS2.p4.4.m4.7.7.3.3.3.5.2" xref="S5.SS2.p4.4.m4.7.7.3.3.3.4.cmml">,</mo><mi id="S5.SS2.p4.4.m4.7.7.3.3.3.3" xref="S5.SS2.p4.4.m4.7.7.3.3.3.3.cmml">ψ</mi></mrow></msub></msub><mo id="S5.SS2.p4.4.m4.17.17.5.5.9" xref="S5.SS2.p4.4.m4.17.17.5.6.cmml">,</mo><msub id="S5.SS2.p4.4.m4.16.16.4.4.4" xref="S5.SS2.p4.4.m4.16.16.4.4.4.cmml"><mover accent="true" id="S5.SS2.p4.4.m4.16.16.4.4.4.2" xref="S5.SS2.p4.4.m4.16.16.4.4.4.2.cmml"><mi id="S5.SS2.p4.4.m4.16.16.4.4.4.2.2" xref="S5.SS2.p4.4.m4.16.16.4.4.4.2.2.cmml">𝒑</mi><mo id="S5.SS2.p4.4.m4.16.16.4.4.4.2.1" xref="S5.SS2.p4.4.m4.16.16.4.4.4.2.1.cmml">˙</mo></mover><msub id="S5.SS2.p4.4.m4.10.10.3" xref="S5.SS2.p4.4.m4.10.10.3.cmml"><mi id="S5.SS2.p4.4.m4.10.10.3.5" xref="S5.SS2.p4.4.m4.10.10.3.5.cmml">base</mi><mrow id="S5.SS2.p4.4.m4.10.10.3.3.3.5" xref="S5.SS2.p4.4.m4.10.10.3.3.3.4.cmml"><mi id="S5.SS2.p4.4.m4.8.8.1.1.1.1" xref="S5.SS2.p4.4.m4.8.8.1.1.1.1.cmml">ϕ</mi><mo id="S5.SS2.p4.4.m4.10.10.3.3.3.5.1" xref="S5.SS2.p4.4.m4.10.10.3.3.3.4.cmml">,</mo><mi id="S5.SS2.p4.4.m4.9.9.2.2.2.2" xref="S5.SS2.p4.4.m4.9.9.2.2.2.2.cmml">θ</mi><mo id="S5.SS2.p4.4.m4.10.10.3.3.3.5.2" xref="S5.SS2.p4.4.m4.10.10.3.3.3.4.cmml">,</mo><mi id="S5.SS2.p4.4.m4.10.10.3.3.3.3" xref="S5.SS2.p4.4.m4.10.10.3.3.3.3.cmml">ψ</mi></mrow></msub></msub><mo id="S5.SS2.p4.4.m4.17.17.5.5.10" xref="S5.SS2.p4.4.m4.17.17.5.6.cmml">,</mo><mi id="S5.SS2.p4.4.m4.11.11" xref="S5.SS2.p4.4.m4.11.11.cmml">𝒒</mi><mo id="S5.SS2.p4.4.m4.17.17.5.5.11" xref="S5.SS2.p4.4.m4.17.17.5.6.cmml">,</mo><mover accent="true" id="S5.SS2.p4.4.m4.12.12" xref="S5.SS2.p4.4.m4.12.12.cmml"><mi id="S5.SS2.p4.4.m4.12.12.2" xref="S5.SS2.p4.4.m4.12.12.2.cmml">𝒒</mi><mo id="S5.SS2.p4.4.m4.12.12.1" xref="S5.SS2.p4.4.m4.12.12.1.cmml">˙</mo></mover><mo id="S5.SS2.p4.4.m4.17.17.5.5.12" xref="S5.SS2.p4.4.m4.17.17.5.6.cmml">,</mo><msub id="S5.SS2.p4.4.m4.17.17.5.5.5" xref="S5.SS2.p4.4.m4.17.17.5.5.5.cmml"><mi id="S5.SS2.p4.4.m4.17.17.5.5.5.2" xref="S5.SS2.p4.4.m4.17.17.5.5.5.2.cmml">𝝎</mi><mi id="S5.SS2.p4.4.m4.17.17.5.5.5.3" xref="S5.SS2.p4.4.m4.17.17.5.5.5.3.cmml">wheel</mi></msub><mo id="S5.SS2.p4.4.m4.17.17.5.5.13" stretchy="false" xref="S5.SS2.p4.4.m4.17.17.5.6.cmml">]</mo></mrow><mo id="S5.SS2.p4.4.m4.17.17.9" xref="S5.SS2.p4.4.m4.17.17.9.cmml">∈</mo><msup id="S5.SS2.p4.4.m4.17.17.10" xref="S5.SS2.p4.4.m4.17.17.10.cmml"><mi id="S5.SS2.p4.4.m4.17.17.10.2" xref="S5.SS2.p4.4.m4.17.17.10.2.cmml">ℝ</mi><mn id="S5.SS2.p4.4.m4.17.17.10.3" xref="S5.SS2.p4.4.m4.17.17.10.3.cmml">20</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p4.4.m4.17b"><apply id="S5.SS2.p4.4.m4.17.17.cmml" xref="S5.SS2.p4.4.m4.17.17"><and id="S5.SS2.p4.4.m4.17.17a.cmml" xref="S5.SS2.p4.4.m4.17.17"></and><apply id="S5.SS2.p4.4.m4.17.17b.cmml" xref="S5.SS2.p4.4.m4.17.17"><eq id="S5.SS2.p4.4.m4.17.17.8.cmml" xref="S5.SS2.p4.4.m4.17.17.8"></eq><ci id="S5.SS2.p4.4.m4.17.17.7.cmml" xref="S5.SS2.p4.4.m4.17.17.7">𝒐</ci><list id="S5.SS2.p4.4.m4.17.17.5.6.cmml" xref="S5.SS2.p4.4.m4.17.17.5.5"><apply id="S5.SS2.p4.4.m4.13.13.1.1.1.cmml" xref="S5.SS2.p4.4.m4.13.13.1.1.1"><csymbol cd="ambiguous" id="S5.SS2.p4.4.m4.13.13.1.1.1.1.cmml" xref="S5.SS2.p4.4.m4.13.13.1.1.1">subscript</csymbol><ci id="S5.SS2.p4.4.m4.13.13.1.1.1.2.cmml" xref="S5.SS2.p4.4.m4.13.13.1.1.1.2">𝑝</ci><apply id="S5.SS2.p4.4.m4.2.2.2.cmml" xref="S5.SS2.p4.4.m4.2.2.2"><csymbol cd="ambiguous" id="S5.SS2.p4.4.m4.2.2.2.3.cmml" xref="S5.SS2.p4.4.m4.2.2.2">subscript</csymbol><ci id="S5.SS2.p4.4.m4.2.2.2.4.cmml" xref="S5.SS2.p4.4.m4.2.2.2.4">𝑧</ci><list id="S5.SS2.p4.4.m4.2.2.2.2.2.3.cmml" xref="S5.SS2.p4.4.m4.2.2.2.2.2.4"><ci id="S5.SS2.p4.4.m4.1.1.1.1.1.1.cmml" xref="S5.SS2.p4.4.m4.1.1.1.1.1.1">base</ci><ci id="S5.SS2.p4.4.m4.2.2.2.2.2.2.cmml" xref="S5.SS2.p4.4.m4.2.2.2.2.2.2">wheel</ci></list></apply></apply><apply id="S5.SS2.p4.4.m4.14.14.2.2.2.cmml" xref="S5.SS2.p4.4.m4.14.14.2.2.2"><csymbol cd="ambiguous" id="S5.SS2.p4.4.m4.14.14.2.2.2.1.cmml" xref="S5.SS2.p4.4.m4.14.14.2.2.2">subscript</csymbol><apply id="S5.SS2.p4.4.m4.14.14.2.2.2.2.cmml" xref="S5.SS2.p4.4.m4.14.14.2.2.2.2"><ci id="S5.SS2.p4.4.m4.14.14.2.2.2.2.1.cmml" xref="S5.SS2.p4.4.m4.14.14.2.2.2.2.1">˙</ci><ci id="S5.SS2.p4.4.m4.14.14.2.2.2.2.2.cmml" xref="S5.SS2.p4.4.m4.14.14.2.2.2.2.2">𝒑</ci></apply><list id="S5.SS2.p4.4.m4.4.4.2.3.cmml" xref="S5.SS2.p4.4.m4.4.4.2.4"><ci id="S5.SS2.p4.4.m4.3.3.1.1.cmml" xref="S5.SS2.p4.4.m4.3.3.1.1">base</ci><ci id="S5.SS2.p4.4.m4.4.4.2.2.cmml" xref="S5.SS2.p4.4.m4.4.4.2.2">wheel</ci></list></apply><apply id="S5.SS2.p4.4.m4.15.15.3.3.3.cmml" xref="S5.SS2.p4.4.m4.15.15.3.3.3"><csymbol cd="ambiguous" id="S5.SS2.p4.4.m4.15.15.3.3.3.1.cmml" xref="S5.SS2.p4.4.m4.15.15.3.3.3">subscript</csymbol><ci id="S5.SS2.p4.4.m4.15.15.3.3.3.2.cmml" xref="S5.SS2.p4.4.m4.15.15.3.3.3.2">𝒑</ci><apply id="S5.SS2.p4.4.m4.7.7.3.cmml" xref="S5.SS2.p4.4.m4.7.7.3"><csymbol cd="ambiguous" id="S5.SS2.p4.4.m4.7.7.3.4.cmml" xref="S5.SS2.p4.4.m4.7.7.3">subscript</csymbol><ci id="S5.SS2.p4.4.m4.7.7.3.5.cmml" xref="S5.SS2.p4.4.m4.7.7.3.5">base</ci><list id="S5.SS2.p4.4.m4.7.7.3.3.3.4.cmml" xref="S5.SS2.p4.4.m4.7.7.3.3.3.5"><ci id="S5.SS2.p4.4.m4.5.5.1.1.1.1.cmml" xref="S5.SS2.p4.4.m4.5.5.1.1.1.1">italic-ϕ</ci><ci id="S5.SS2.p4.4.m4.6.6.2.2.2.2.cmml" xref="S5.SS2.p4.4.m4.6.6.2.2.2.2">𝜃</ci><ci id="S5.SS2.p4.4.m4.7.7.3.3.3.3.cmml" xref="S5.SS2.p4.4.m4.7.7.3.3.3.3">𝜓</ci></list></apply></apply><apply id="S5.SS2.p4.4.m4.16.16.4.4.4.cmml" xref="S5.SS2.p4.4.m4.16.16.4.4.4"><csymbol cd="ambiguous" id="S5.SS2.p4.4.m4.16.16.4.4.4.1.cmml" xref="S5.SS2.p4.4.m4.16.16.4.4.4">subscript</csymbol><apply id="S5.SS2.p4.4.m4.16.16.4.4.4.2.cmml" xref="S5.SS2.p4.4.m4.16.16.4.4.4.2"><ci id="S5.SS2.p4.4.m4.16.16.4.4.4.2.1.cmml" xref="S5.SS2.p4.4.m4.16.16.4.4.4.2.1">˙</ci><ci id="S5.SS2.p4.4.m4.16.16.4.4.4.2.2.cmml" xref="S5.SS2.p4.4.m4.16.16.4.4.4.2.2">𝒑</ci></apply><apply id="S5.SS2.p4.4.m4.10.10.3.cmml" xref="S5.SS2.p4.4.m4.10.10.3"><csymbol cd="ambiguous" id="S5.SS2.p4.4.m4.10.10.3.4.cmml" xref="S5.SS2.p4.4.m4.10.10.3">subscript</csymbol><ci id="S5.SS2.p4.4.m4.10.10.3.5.cmml" xref="S5.SS2.p4.4.m4.10.10.3.5">base</ci><list id="S5.SS2.p4.4.m4.10.10.3.3.3.4.cmml" xref="S5.SS2.p4.4.m4.10.10.3.3.3.5"><ci id="S5.SS2.p4.4.m4.8.8.1.1.1.1.cmml" xref="S5.SS2.p4.4.m4.8.8.1.1.1.1">italic-ϕ</ci><ci id="S5.SS2.p4.4.m4.9.9.2.2.2.2.cmml" xref="S5.SS2.p4.4.m4.9.9.2.2.2.2">𝜃</ci><ci id="S5.SS2.p4.4.m4.10.10.3.3.3.3.cmml" xref="S5.SS2.p4.4.m4.10.10.3.3.3.3">𝜓</ci></list></apply></apply><ci id="S5.SS2.p4.4.m4.11.11.cmml" xref="S5.SS2.p4.4.m4.11.11">𝒒</ci><apply id="S5.SS2.p4.4.m4.12.12.cmml" xref="S5.SS2.p4.4.m4.12.12"><ci id="S5.SS2.p4.4.m4.12.12.1.cmml" xref="S5.SS2.p4.4.m4.12.12.1">˙</ci><ci id="S5.SS2.p4.4.m4.12.12.2.cmml" xref="S5.SS2.p4.4.m4.12.12.2">𝒒</ci></apply><apply id="S5.SS2.p4.4.m4.17.17.5.5.5.cmml" xref="S5.SS2.p4.4.m4.17.17.5.5.5"><csymbol cd="ambiguous" id="S5.SS2.p4.4.m4.17.17.5.5.5.1.cmml" xref="S5.SS2.p4.4.m4.17.17.5.5.5">subscript</csymbol><ci id="S5.SS2.p4.4.m4.17.17.5.5.5.2.cmml" xref="S5.SS2.p4.4.m4.17.17.5.5.5.2">𝝎</ci><ci id="S5.SS2.p4.4.m4.17.17.5.5.5.3.cmml" xref="S5.SS2.p4.4.m4.17.17.5.5.5.3">wheel</ci></apply></list></apply><apply id="S5.SS2.p4.4.m4.17.17c.cmml" xref="S5.SS2.p4.4.m4.17.17"><in id="S5.SS2.p4.4.m4.17.17.9.cmml" xref="S5.SS2.p4.4.m4.17.17.9"></in><share href="https://arxiv.org/html/2410.04929v1#S5.SS2.p4.4.m4.17.17.5.cmml" id="S5.SS2.p4.4.m4.17.17d.cmml" xref="S5.SS2.p4.4.m4.17.17"></share><apply id="S5.SS2.p4.4.m4.17.17.10.cmml" xref="S5.SS2.p4.4.m4.17.17.10"><csymbol cd="ambiguous" id="S5.SS2.p4.4.m4.17.17.10.1.cmml" xref="S5.SS2.p4.4.m4.17.17.10">superscript</csymbol><ci id="S5.SS2.p4.4.m4.17.17.10.2.cmml" xref="S5.SS2.p4.4.m4.17.17.10.2">ℝ</ci><cn id="S5.SS2.p4.4.m4.17.17.10.3.cmml" type="integer" xref="S5.SS2.p4.4.m4.17.17.10.3">20</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p4.4.m4.17c">\boldsymbol{o}=[p_{z_{\mathrm{{base,wheel}}}},\dot{\boldsymbol{p}}_{\mathrm{%
base,wheel}},\boldsymbol{p}_{\mathrm{base}_{\phi,\theta,\psi}},\dot{%
\boldsymbol{p}}_{\mathrm{base}_{\phi,\theta,\psi}},\boldsymbol{q},\dot{%
\boldsymbol{q}},\boldsymbol{\omega}_{\mathrm{wheel}}]\in\mathbb{R}^{20}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p4.4.m4.17d">bold_italic_o = [ italic_p start_POSTSUBSCRIPT italic_z start_POSTSUBSCRIPT roman_base , roman_wheel end_POSTSUBSCRIPT end_POSTSUBSCRIPT , over˙ start_ARG bold_italic_p end_ARG start_POSTSUBSCRIPT roman_base , roman_wheel end_POSTSUBSCRIPT , bold_italic_p start_POSTSUBSCRIPT roman_base start_POSTSUBSCRIPT italic_ϕ , italic_θ , italic_ψ end_POSTSUBSCRIPT end_POSTSUBSCRIPT , over˙ start_ARG bold_italic_p end_ARG start_POSTSUBSCRIPT roman_base start_POSTSUBSCRIPT italic_ϕ , italic_θ , italic_ψ end_POSTSUBSCRIPT end_POSTSUBSCRIPT , bold_italic_q , over˙ start_ARG bold_italic_q end_ARG , bold_italic_ω start_POSTSUBSCRIPT roman_wheel end_POSTSUBSCRIPT ] ∈ blackboard_R start_POSTSUPERSCRIPT 20 end_POSTSUPERSCRIPT</annotation></semantics></math>.
Here, <math alttext="\boldsymbol{p}" class="ltx_Math" display="inline" id="S5.SS2.p4.5.m5.1"><semantics id="S5.SS2.p4.5.m5.1a"><mi id="S5.SS2.p4.5.m5.1.1" xref="S5.SS2.p4.5.m5.1.1.cmml">𝒑</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p4.5.m5.1b"><ci id="S5.SS2.p4.5.m5.1.1.cmml" xref="S5.SS2.p4.5.m5.1.1">𝒑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p4.5.m5.1c">\boldsymbol{p}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p4.5.m5.1d">bold_italic_p</annotation></semantics></math> represents the robot’s position and orientation, <math alttext="\boldsymbol{q}" class="ltx_Math" display="inline" id="S5.SS2.p4.6.m6.1"><semantics id="S5.SS2.p4.6.m6.1a"><mi id="S5.SS2.p4.6.m6.1.1" xref="S5.SS2.p4.6.m6.1.1.cmml">𝒒</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p4.6.m6.1b"><ci id="S5.SS2.p4.6.m6.1.1.cmml" xref="S5.SS2.p4.6.m6.1.1">𝒒</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p4.6.m6.1c">\boldsymbol{q}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p4.6.m6.1d">bold_italic_q</annotation></semantics></math> represents the robot’s joint angles, and <math alttext="\boldsymbol{\omega}" class="ltx_Math" display="inline" id="S5.SS2.p4.7.m7.1"><semantics id="S5.SS2.p4.7.m7.1a"><mi id="S5.SS2.p4.7.m7.1.1" xref="S5.SS2.p4.7.m7.1.1.cmml">𝝎</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p4.7.m7.1b"><ci id="S5.SS2.p4.7.m7.1.1.cmml" xref="S5.SS2.p4.7.m7.1.1">𝝎</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p4.7.m7.1c">\boldsymbol{\omega}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p4.7.m7.1d">bold_italic_ω</annotation></semantics></math> represents the angular velocity.
An episode ends when the robot model tips over or after 10 seconds have elapsed, and the training is conducted over 150 episodes.</p>
</div>
<div class="ltx_para" id="S5.SS2.p5">
<p class="ltx_p" id="S5.SS2.p5.1">Next, hierarchical control is applied using the learned values. The upper-level Kanayama Control generates a sequence of goal variables based on the robot’s state over the prediction horizon. It incurs costs to ensure that the robot follows this goal variable trajectory. The final goal variable in the sequence is used as input for the terminal value, replacing the need to predict the future beyond this point.</p>
</div>
<section class="ltx_paragraph" id="S5.SS2.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Domain Randomization</h4>
<div class="ltx_para" id="S5.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S5.SS2.SSS0.Px1.p1.2">To improve the robustness of individual terminal values, especially during slope transitions where Diablo’s performance deteriorates or tipping occurs, we adapt the approach of environment randomization <cite class="ltx_cite ltx_citemacro_citep">(Tobin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib40" title="">2017</a>; Peng et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib33" title="">2018</a>)</cite>, commonly used in reinforcement learning, to aid in learning terminal values. By randomizing the sloped terrain in each episode and making it bumpy with random heights and placements of the floor, it is expected to achieve more robust terminal values, as shown in Fig.<a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S5.F5" title="Figure 5 ‣ Domain Randomization ‣ 5.2 Path Tracking Tasks ‣ 5 Experiments ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">5</span></a>. In this study, each placement height <math alttext="z_{\text{terrain}}" class="ltx_Math" display="inline" id="S5.SS2.SSS0.Px1.p1.1.m1.1"><semantics id="S5.SS2.SSS0.Px1.p1.1.m1.1a"><msub id="S5.SS2.SSS0.Px1.p1.1.m1.1.1" xref="S5.SS2.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S5.SS2.SSS0.Px1.p1.1.m1.1.1.2" xref="S5.SS2.SSS0.Px1.p1.1.m1.1.1.2.cmml">z</mi><mtext id="S5.SS2.SSS0.Px1.p1.1.m1.1.1.3" xref="S5.SS2.SSS0.Px1.p1.1.m1.1.1.3a.cmml">terrain</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px1.p1.1.m1.1b"><apply id="S5.SS2.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S5.SS2.SSS0.Px1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S5.SS2.SSS0.Px1.p1.1.m1.1.1">subscript</csymbol><ci id="S5.SS2.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S5.SS2.SSS0.Px1.p1.1.m1.1.1.2">𝑧</ci><ci id="S5.SS2.SSS0.Px1.p1.1.m1.1.1.3a.cmml" xref="S5.SS2.SSS0.Px1.p1.1.m1.1.1.3"><mtext id="S5.SS2.SSS0.Px1.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="S5.SS2.SSS0.Px1.p1.1.m1.1.1.3">terrain</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px1.p1.1.m1.1c">z_{\text{terrain}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.SSS0.Px1.p1.1.m1.1d">italic_z start_POSTSUBSCRIPT terrain end_POSTSUBSCRIPT</annotation></semantics></math> is sampled from <math alttext="z_{\text{terrain}}\sim U(0,0.05)\ [$\mathrm{m}$]" class="ltx_Math" display="inline" id="S5.SS2.SSS0.Px1.p1.2.m2.4"><semantics id="S5.SS2.SSS0.Px1.p1.2.m2.4a"><mrow id="S5.SS2.SSS0.Px1.p1.2.m2.4.5" xref="S5.SS2.SSS0.Px1.p1.2.m2.4.5.cmml"><msub id="S5.SS2.SSS0.Px1.p1.2.m2.4.5.2" xref="S5.SS2.SSS0.Px1.p1.2.m2.4.5.2.cmml"><mi id="S5.SS2.SSS0.Px1.p1.2.m2.4.5.2.2" xref="S5.SS2.SSS0.Px1.p1.2.m2.4.5.2.2.cmml">z</mi><mtext id="S5.SS2.SSS0.Px1.p1.2.m2.4.5.2.3" xref="S5.SS2.SSS0.Px1.p1.2.m2.4.5.2.3a.cmml">terrain</mtext></msub><mo id="S5.SS2.SSS0.Px1.p1.2.m2.4.5.1" xref="S5.SS2.SSS0.Px1.p1.2.m2.4.5.1.cmml">∼</mo><mrow id="S5.SS2.SSS0.Px1.p1.2.m2.4.5.3" xref="S5.SS2.SSS0.Px1.p1.2.m2.4.5.3.cmml"><mi id="S5.SS2.SSS0.Px1.p1.2.m2.4.5.3.2" xref="S5.SS2.SSS0.Px1.p1.2.m2.4.5.3.2.cmml">U</mi><mo id="S5.SS2.SSS0.Px1.p1.2.m2.4.5.3.1" xref="S5.SS2.SSS0.Px1.p1.2.m2.4.5.3.1.cmml">⁢</mo><mrow id="S5.SS2.SSS0.Px1.p1.2.m2.4.5.3.3.2" xref="S5.SS2.SSS0.Px1.p1.2.m2.4.5.3.3.1.cmml"><mo id="S5.SS2.SSS0.Px1.p1.2.m2.4.5.3.3.2.1" stretchy="false" xref="S5.SS2.SSS0.Px1.p1.2.m2.4.5.3.3.1.cmml">(</mo><mn id="S5.SS2.SSS0.Px1.p1.2.m2.2.2" xref="S5.SS2.SSS0.Px1.p1.2.m2.2.2.cmml">0</mn><mo id="S5.SS2.SSS0.Px1.p1.2.m2.4.5.3.3.2.2" xref="S5.SS2.SSS0.Px1.p1.2.m2.4.5.3.3.1.cmml">,</mo><mn id="S5.SS2.SSS0.Px1.p1.2.m2.3.3" xref="S5.SS2.SSS0.Px1.p1.2.m2.3.3.cmml">0.05</mn><mo id="S5.SS2.SSS0.Px1.p1.2.m2.4.5.3.3.2.3" stretchy="false" xref="S5.SS2.SSS0.Px1.p1.2.m2.4.5.3.3.1.cmml">)</mo></mrow><mo id="S5.SS2.SSS0.Px1.p1.2.m2.4.5.3.1a" lspace="0.500em" xref="S5.SS2.SSS0.Px1.p1.2.m2.4.5.3.1.cmml">⁢</mo><mrow id="S5.SS2.SSS0.Px1.p1.2.m2.4.5.3.4.2" xref="S5.SS2.SSS0.Px1.p1.2.m2.4.5.3.4.1.cmml"><mo id="S5.SS2.SSS0.Px1.p1.2.m2.4.5.3.4.2.1" stretchy="false" xref="S5.SS2.SSS0.Px1.p1.2.m2.4.5.3.4.1.1.cmml">[</mo><mi id="S5.SS2.SSS0.Px1.p1.2.m2.4.4" mathvariant="normal" xref="S5.SS2.SSS0.Px1.p1.2.m2.4.4.cmml">m</mi><mo id="S5.SS2.SSS0.Px1.p1.2.m2.4.5.3.4.2.2" stretchy="false" xref="S5.SS2.SSS0.Px1.p1.2.m2.4.5.3.4.1.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px1.p1.2.m2.4b"><apply id="S5.SS2.SSS0.Px1.p1.2.m2.4.5.cmml" xref="S5.SS2.SSS0.Px1.p1.2.m2.4.5"><csymbol cd="latexml" id="S5.SS2.SSS0.Px1.p1.2.m2.4.5.1.cmml" xref="S5.SS2.SSS0.Px1.p1.2.m2.4.5.1">similar-to</csymbol><apply id="S5.SS2.SSS0.Px1.p1.2.m2.4.5.2.cmml" xref="S5.SS2.SSS0.Px1.p1.2.m2.4.5.2"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px1.p1.2.m2.4.5.2.1.cmml" xref="S5.SS2.SSS0.Px1.p1.2.m2.4.5.2">subscript</csymbol><ci id="S5.SS2.SSS0.Px1.p1.2.m2.4.5.2.2.cmml" xref="S5.SS2.SSS0.Px1.p1.2.m2.4.5.2.2">𝑧</ci><ci id="S5.SS2.SSS0.Px1.p1.2.m2.4.5.2.3a.cmml" xref="S5.SS2.SSS0.Px1.p1.2.m2.4.5.2.3"><mtext id="S5.SS2.SSS0.Px1.p1.2.m2.4.5.2.3.cmml" mathsize="70%" xref="S5.SS2.SSS0.Px1.p1.2.m2.4.5.2.3">terrain</mtext></ci></apply><apply id="S5.SS2.SSS0.Px1.p1.2.m2.4.5.3.cmml" xref="S5.SS2.SSS0.Px1.p1.2.m2.4.5.3"><times id="S5.SS2.SSS0.Px1.p1.2.m2.4.5.3.1.cmml" xref="S5.SS2.SSS0.Px1.p1.2.m2.4.5.3.1"></times><ci id="S5.SS2.SSS0.Px1.p1.2.m2.4.5.3.2.cmml" xref="S5.SS2.SSS0.Px1.p1.2.m2.4.5.3.2">𝑈</ci><interval closure="open" id="S5.SS2.SSS0.Px1.p1.2.m2.4.5.3.3.1.cmml" xref="S5.SS2.SSS0.Px1.p1.2.m2.4.5.3.3.2"><cn id="S5.SS2.SSS0.Px1.p1.2.m2.2.2.cmml" type="integer" xref="S5.SS2.SSS0.Px1.p1.2.m2.2.2">0</cn><cn id="S5.SS2.SSS0.Px1.p1.2.m2.3.3.cmml" type="float" xref="S5.SS2.SSS0.Px1.p1.2.m2.3.3">0.05</cn></interval><apply id="S5.SS2.SSS0.Px1.p1.2.m2.4.5.3.4.1.cmml" xref="S5.SS2.SSS0.Px1.p1.2.m2.4.5.3.4.2"><csymbol cd="latexml" id="S5.SS2.SSS0.Px1.p1.2.m2.4.5.3.4.1.1.cmml" xref="S5.SS2.SSS0.Px1.p1.2.m2.4.5.3.4.2.1">delimited-[]</csymbol><ci id="S5.SS2.SSS0.Px1.p1.2.m2.4.4.cmml" xref="S5.SS2.SSS0.Px1.p1.2.m2.4.4">m</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px1.p1.2.m2.4c">z_{\text{terrain}}\sim U(0,0.05)\ [$\mathrm{m}$]</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.SSS0.Px1.p1.2.m2.4d">italic_z start_POSTSUBSCRIPT terrain end_POSTSUBSCRIPT ∼ italic_U ( 0 , 0.05 ) [ roman_m ]</annotation></semantics></math>. Therefore, during inference, the first term on the right-hand side of Eq.(<a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S3.E9" title="In 3.3 Model Predictive Control (MPC) ‣ 3 Preliminaries ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">9</span></a>) is computed based on a single model’s prediction, while the second term represents the terminal value obtained through domain randomization, with each term calculated using different models.</p>
</div>
<figure class="ltx_figure" id="S5.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="395" id="S5.F5.g1" src="x7.png" width="581"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F5.2.1.1" style="font-size:90%;">Figure 5</span>: </span><span class="ltx_text" id="S5.F5.3.2" style="font-size:90%;">The robot learns to traverse uneven terrain, making the driving module more robust.</span></figcaption>
</figure>
</section>
<section class="ltx_paragraph" id="S5.SS2.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Surrogate Robot Model Approach</h4>
<div class="ltx_para" id="S5.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="S5.SS2.SSS0.Px2.p1.1">The dynamic simulation of Diablo’s closed-loop link mechanism often encounters instabilities. These instabilities significantly slow down the convergence of solutions. To address this issue, we model the parallel links in the MPC’s internal model as linear joints to improve the stability of computations. The transformation between linear joints and parallel links is derived using Forward Kinematics (FK), differential Forward Kinematics, and Inverse Kinematics (IK) <cite class="ltx_cite ltx_citemacro_citep">(Kucuk and Bingul, <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib20" title="">2006</a>)</cite>. This process constructs a loop system for the Diablo robot, as depicted in Fig.<a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S5.F6" title="Figure 6 ‣ Surrogate Robot Model Approach ‣ 5.2 Path Tracking Tasks ‣ 5 Experiments ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">6</span></a>.</p>
</div>
<figure class="ltx_figure" id="S5.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="354" id="S5.F6.g1" src="x8.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F6.24.12.1" style="font-size:90%;">Figure 6</span>: </span><span class="ltx_text" id="S5.F6.22.11" style="font-size:90%;">Surrogate Robot Model calculation: In the MPC internal model, a prismatic joint model is used, and it outputs control commands for the length <math alttext="r_{\mathrm{cmd}}" class="ltx_Math" display="inline" id="S5.F6.12.1.m1.1"><semantics id="S5.F6.12.1.m1.1b"><msub id="S5.F6.12.1.m1.1.1" xref="S5.F6.12.1.m1.1.1.cmml"><mi id="S5.F6.12.1.m1.1.1.2" xref="S5.F6.12.1.m1.1.1.2.cmml">r</mi><mi id="S5.F6.12.1.m1.1.1.3" xref="S5.F6.12.1.m1.1.1.3.cmml">cmd</mi></msub><annotation-xml encoding="MathML-Content" id="S5.F6.12.1.m1.1c"><apply id="S5.F6.12.1.m1.1.1.cmml" xref="S5.F6.12.1.m1.1.1"><csymbol cd="ambiguous" id="S5.F6.12.1.m1.1.1.1.cmml" xref="S5.F6.12.1.m1.1.1">subscript</csymbol><ci id="S5.F6.12.1.m1.1.1.2.cmml" xref="S5.F6.12.1.m1.1.1.2">𝑟</ci><ci id="S5.F6.12.1.m1.1.1.3.cmml" xref="S5.F6.12.1.m1.1.1.3">cmd</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F6.12.1.m1.1d">r_{\mathrm{cmd}}</annotation><annotation encoding="application/x-llamapun" id="S5.F6.12.1.m1.1e">italic_r start_POSTSUBSCRIPT roman_cmd end_POSTSUBSCRIPT</annotation></semantics></math>, angle <math alttext="\theta_{\mathrm{cmd}}" class="ltx_Math" display="inline" id="S5.F6.13.2.m2.1"><semantics id="S5.F6.13.2.m2.1b"><msub id="S5.F6.13.2.m2.1.1" xref="S5.F6.13.2.m2.1.1.cmml"><mi id="S5.F6.13.2.m2.1.1.2" xref="S5.F6.13.2.m2.1.1.2.cmml">θ</mi><mi id="S5.F6.13.2.m2.1.1.3" xref="S5.F6.13.2.m2.1.1.3.cmml">cmd</mi></msub><annotation-xml encoding="MathML-Content" id="S5.F6.13.2.m2.1c"><apply id="S5.F6.13.2.m2.1.1.cmml" xref="S5.F6.13.2.m2.1.1"><csymbol cd="ambiguous" id="S5.F6.13.2.m2.1.1.1.cmml" xref="S5.F6.13.2.m2.1.1">subscript</csymbol><ci id="S5.F6.13.2.m2.1.1.2.cmml" xref="S5.F6.13.2.m2.1.1.2">𝜃</ci><ci id="S5.F6.13.2.m2.1.1.3.cmml" xref="S5.F6.13.2.m2.1.1.3">cmd</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F6.13.2.m2.1d">\theta_{\mathrm{cmd}}</annotation><annotation encoding="application/x-llamapun" id="S5.F6.13.2.m2.1e">italic_θ start_POSTSUBSCRIPT roman_cmd end_POSTSUBSCRIPT</annotation></semantics></math>, and the wheel’s angular velocity <math alttext="\omega^{\prime}_{\mathrm{wheel,cmd}}" class="ltx_Math" display="inline" id="S5.F6.14.3.m3.2"><semantics id="S5.F6.14.3.m3.2b"><msubsup id="S5.F6.14.3.m3.2.3" xref="S5.F6.14.3.m3.2.3.cmml"><mi id="S5.F6.14.3.m3.2.3.2.2" xref="S5.F6.14.3.m3.2.3.2.2.cmml">ω</mi><mrow id="S5.F6.14.3.m3.2.2.2.4" xref="S5.F6.14.3.m3.2.2.2.3.cmml"><mi id="S5.F6.14.3.m3.1.1.1.1" xref="S5.F6.14.3.m3.1.1.1.1.cmml">wheel</mi><mo id="S5.F6.14.3.m3.2.2.2.4.1" xref="S5.F6.14.3.m3.2.2.2.3.cmml">,</mo><mi id="S5.F6.14.3.m3.2.2.2.2" xref="S5.F6.14.3.m3.2.2.2.2.cmml">cmd</mi></mrow><mo id="S5.F6.14.3.m3.2.3.2.3" xref="S5.F6.14.3.m3.2.3.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S5.F6.14.3.m3.2c"><apply id="S5.F6.14.3.m3.2.3.cmml" xref="S5.F6.14.3.m3.2.3"><csymbol cd="ambiguous" id="S5.F6.14.3.m3.2.3.1.cmml" xref="S5.F6.14.3.m3.2.3">subscript</csymbol><apply id="S5.F6.14.3.m3.2.3.2.cmml" xref="S5.F6.14.3.m3.2.3"><csymbol cd="ambiguous" id="S5.F6.14.3.m3.2.3.2.1.cmml" xref="S5.F6.14.3.m3.2.3">superscript</csymbol><ci id="S5.F6.14.3.m3.2.3.2.2.cmml" xref="S5.F6.14.3.m3.2.3.2.2">𝜔</ci><ci id="S5.F6.14.3.m3.2.3.2.3.cmml" xref="S5.F6.14.3.m3.2.3.2.3">′</ci></apply><list id="S5.F6.14.3.m3.2.2.2.3.cmml" xref="S5.F6.14.3.m3.2.2.2.4"><ci id="S5.F6.14.3.m3.1.1.1.1.cmml" xref="S5.F6.14.3.m3.1.1.1.1">wheel</ci><ci id="S5.F6.14.3.m3.2.2.2.2.cmml" xref="S5.F6.14.3.m3.2.2.2.2">cmd</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F6.14.3.m3.2d">\omega^{\prime}_{\mathrm{wheel,cmd}}</annotation><annotation encoding="application/x-llamapun" id="S5.F6.14.3.m3.2e">italic_ω start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT roman_wheel , roman_cmd end_POSTSUBSCRIPT</annotation></semantics></math>. These commands are then converted into the corresponding joint angles <math alttext="q_{\mathrm{cmd}}" class="ltx_Math" display="inline" id="S5.F6.15.4.m4.1"><semantics id="S5.F6.15.4.m4.1b"><msub id="S5.F6.15.4.m4.1.1" xref="S5.F6.15.4.m4.1.1.cmml"><mi id="S5.F6.15.4.m4.1.1.2" xref="S5.F6.15.4.m4.1.1.2.cmml">q</mi><mi id="S5.F6.15.4.m4.1.1.3" xref="S5.F6.15.4.m4.1.1.3.cmml">cmd</mi></msub><annotation-xml encoding="MathML-Content" id="S5.F6.15.4.m4.1c"><apply id="S5.F6.15.4.m4.1.1.cmml" xref="S5.F6.15.4.m4.1.1"><csymbol cd="ambiguous" id="S5.F6.15.4.m4.1.1.1.cmml" xref="S5.F6.15.4.m4.1.1">subscript</csymbol><ci id="S5.F6.15.4.m4.1.1.2.cmml" xref="S5.F6.15.4.m4.1.1.2">𝑞</ci><ci id="S5.F6.15.4.m4.1.1.3.cmml" xref="S5.F6.15.4.m4.1.1.3">cmd</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F6.15.4.m4.1d">q_{\mathrm{cmd}}</annotation><annotation encoding="application/x-llamapun" id="S5.F6.15.4.m4.1e">italic_q start_POSTSUBSCRIPT roman_cmd end_POSTSUBSCRIPT</annotation></semantics></math> and the wheel’s angular velocity <math alttext="\omega_{\mathrm{wheel,cmd}}" class="ltx_Math" display="inline" id="S5.F6.16.5.m5.2"><semantics id="S5.F6.16.5.m5.2b"><msub id="S5.F6.16.5.m5.2.3" xref="S5.F6.16.5.m5.2.3.cmml"><mi id="S5.F6.16.5.m5.2.3.2" xref="S5.F6.16.5.m5.2.3.2.cmml">ω</mi><mrow id="S5.F6.16.5.m5.2.2.2.4" xref="S5.F6.16.5.m5.2.2.2.3.cmml"><mi id="S5.F6.16.5.m5.1.1.1.1" xref="S5.F6.16.5.m5.1.1.1.1.cmml">wheel</mi><mo id="S5.F6.16.5.m5.2.2.2.4.1" xref="S5.F6.16.5.m5.2.2.2.3.cmml">,</mo><mi id="S5.F6.16.5.m5.2.2.2.2" xref="S5.F6.16.5.m5.2.2.2.2.cmml">cmd</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.F6.16.5.m5.2c"><apply id="S5.F6.16.5.m5.2.3.cmml" xref="S5.F6.16.5.m5.2.3"><csymbol cd="ambiguous" id="S5.F6.16.5.m5.2.3.1.cmml" xref="S5.F6.16.5.m5.2.3">subscript</csymbol><ci id="S5.F6.16.5.m5.2.3.2.cmml" xref="S5.F6.16.5.m5.2.3.2">𝜔</ci><list id="S5.F6.16.5.m5.2.2.2.3.cmml" xref="S5.F6.16.5.m5.2.2.2.4"><ci id="S5.F6.16.5.m5.1.1.1.1.cmml" xref="S5.F6.16.5.m5.1.1.1.1">wheel</ci><ci id="S5.F6.16.5.m5.2.2.2.2.cmml" xref="S5.F6.16.5.m5.2.2.2.2">cmd</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F6.16.5.m5.2d">\omega_{\mathrm{wheel,cmd}}</annotation><annotation encoding="application/x-llamapun" id="S5.F6.16.5.m5.2e">italic_ω start_POSTSUBSCRIPT roman_wheel , roman_cmd end_POSTSUBSCRIPT</annotation></semantics></math> for the Diablo robot through inverse kinematics and input into the Diablo model. The joint angles <math alttext="q_{1},q_{2}" class="ltx_Math" display="inline" id="S5.F6.17.6.m6.2"><semantics id="S5.F6.17.6.m6.2b"><mrow id="S5.F6.17.6.m6.2.2.2" xref="S5.F6.17.6.m6.2.2.3.cmml"><msub id="S5.F6.17.6.m6.1.1.1.1" xref="S5.F6.17.6.m6.1.1.1.1.cmml"><mi id="S5.F6.17.6.m6.1.1.1.1.2" xref="S5.F6.17.6.m6.1.1.1.1.2.cmml">q</mi><mn id="S5.F6.17.6.m6.1.1.1.1.3" xref="S5.F6.17.6.m6.1.1.1.1.3.cmml">1</mn></msub><mo id="S5.F6.17.6.m6.2.2.2.3" xref="S5.F6.17.6.m6.2.2.3.cmml">,</mo><msub id="S5.F6.17.6.m6.2.2.2.2" xref="S5.F6.17.6.m6.2.2.2.2.cmml"><mi id="S5.F6.17.6.m6.2.2.2.2.2" xref="S5.F6.17.6.m6.2.2.2.2.2.cmml">q</mi><mn id="S5.F6.17.6.m6.2.2.2.2.3" xref="S5.F6.17.6.m6.2.2.2.2.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S5.F6.17.6.m6.2c"><list id="S5.F6.17.6.m6.2.2.3.cmml" xref="S5.F6.17.6.m6.2.2.2"><apply id="S5.F6.17.6.m6.1.1.1.1.cmml" xref="S5.F6.17.6.m6.1.1.1.1"><csymbol cd="ambiguous" id="S5.F6.17.6.m6.1.1.1.1.1.cmml" xref="S5.F6.17.6.m6.1.1.1.1">subscript</csymbol><ci id="S5.F6.17.6.m6.1.1.1.1.2.cmml" xref="S5.F6.17.6.m6.1.1.1.1.2">𝑞</ci><cn id="S5.F6.17.6.m6.1.1.1.1.3.cmml" type="integer" xref="S5.F6.17.6.m6.1.1.1.1.3">1</cn></apply><apply id="S5.F6.17.6.m6.2.2.2.2.cmml" xref="S5.F6.17.6.m6.2.2.2.2"><csymbol cd="ambiguous" id="S5.F6.17.6.m6.2.2.2.2.1.cmml" xref="S5.F6.17.6.m6.2.2.2.2">subscript</csymbol><ci id="S5.F6.17.6.m6.2.2.2.2.2.cmml" xref="S5.F6.17.6.m6.2.2.2.2.2">𝑞</ci><cn id="S5.F6.17.6.m6.2.2.2.2.3.cmml" type="integer" xref="S5.F6.17.6.m6.2.2.2.2.3">2</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S5.F6.17.6.m6.2d">q_{1},q_{2}</annotation><annotation encoding="application/x-llamapun" id="S5.F6.17.6.m6.2e">italic_q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, angular velocities <math alttext="\dot{q}_{1},\dot{q}_{2}" class="ltx_Math" display="inline" id="S5.F6.18.7.m7.2"><semantics id="S5.F6.18.7.m7.2b"><mrow id="S5.F6.18.7.m7.2.2.2" xref="S5.F6.18.7.m7.2.2.3.cmml"><msub id="S5.F6.18.7.m7.1.1.1.1" xref="S5.F6.18.7.m7.1.1.1.1.cmml"><mover accent="true" id="S5.F6.18.7.m7.1.1.1.1.2" xref="S5.F6.18.7.m7.1.1.1.1.2.cmml"><mi id="S5.F6.18.7.m7.1.1.1.1.2.2" xref="S5.F6.18.7.m7.1.1.1.1.2.2.cmml">q</mi><mo id="S5.F6.18.7.m7.1.1.1.1.2.1" xref="S5.F6.18.7.m7.1.1.1.1.2.1.cmml">˙</mo></mover><mn id="S5.F6.18.7.m7.1.1.1.1.3" xref="S5.F6.18.7.m7.1.1.1.1.3.cmml">1</mn></msub><mo id="S5.F6.18.7.m7.2.2.2.3" xref="S5.F6.18.7.m7.2.2.3.cmml">,</mo><msub id="S5.F6.18.7.m7.2.2.2.2" xref="S5.F6.18.7.m7.2.2.2.2.cmml"><mover accent="true" id="S5.F6.18.7.m7.2.2.2.2.2" xref="S5.F6.18.7.m7.2.2.2.2.2.cmml"><mi id="S5.F6.18.7.m7.2.2.2.2.2.2" xref="S5.F6.18.7.m7.2.2.2.2.2.2.cmml">q</mi><mo id="S5.F6.18.7.m7.2.2.2.2.2.1" xref="S5.F6.18.7.m7.2.2.2.2.2.1.cmml">˙</mo></mover><mn id="S5.F6.18.7.m7.2.2.2.2.3" xref="S5.F6.18.7.m7.2.2.2.2.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S5.F6.18.7.m7.2c"><list id="S5.F6.18.7.m7.2.2.3.cmml" xref="S5.F6.18.7.m7.2.2.2"><apply id="S5.F6.18.7.m7.1.1.1.1.cmml" xref="S5.F6.18.7.m7.1.1.1.1"><csymbol cd="ambiguous" id="S5.F6.18.7.m7.1.1.1.1.1.cmml" xref="S5.F6.18.7.m7.1.1.1.1">subscript</csymbol><apply id="S5.F6.18.7.m7.1.1.1.1.2.cmml" xref="S5.F6.18.7.m7.1.1.1.1.2"><ci id="S5.F6.18.7.m7.1.1.1.1.2.1.cmml" xref="S5.F6.18.7.m7.1.1.1.1.2.1">˙</ci><ci id="S5.F6.18.7.m7.1.1.1.1.2.2.cmml" xref="S5.F6.18.7.m7.1.1.1.1.2.2">𝑞</ci></apply><cn id="S5.F6.18.7.m7.1.1.1.1.3.cmml" type="integer" xref="S5.F6.18.7.m7.1.1.1.1.3">1</cn></apply><apply id="S5.F6.18.7.m7.2.2.2.2.cmml" xref="S5.F6.18.7.m7.2.2.2.2"><csymbol cd="ambiguous" id="S5.F6.18.7.m7.2.2.2.2.1.cmml" xref="S5.F6.18.7.m7.2.2.2.2">subscript</csymbol><apply id="S5.F6.18.7.m7.2.2.2.2.2.cmml" xref="S5.F6.18.7.m7.2.2.2.2.2"><ci id="S5.F6.18.7.m7.2.2.2.2.2.1.cmml" xref="S5.F6.18.7.m7.2.2.2.2.2.1">˙</ci><ci id="S5.F6.18.7.m7.2.2.2.2.2.2.cmml" xref="S5.F6.18.7.m7.2.2.2.2.2.2">𝑞</ci></apply><cn id="S5.F6.18.7.m7.2.2.2.2.3.cmml" type="integer" xref="S5.F6.18.7.m7.2.2.2.2.3">2</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S5.F6.18.7.m7.2d">\dot{q}_{1},\dot{q}_{2}</annotation><annotation encoding="application/x-llamapun" id="S5.F6.18.7.m7.2e">over˙ start_ARG italic_q end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , over˙ start_ARG italic_q end_ARG start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, and the wheel’s angular velocity <math alttext="\omega_{\mathrm{wheel}}" class="ltx_Math" display="inline" id="S5.F6.19.8.m8.1"><semantics id="S5.F6.19.8.m8.1b"><msub id="S5.F6.19.8.m8.1.1" xref="S5.F6.19.8.m8.1.1.cmml"><mi id="S5.F6.19.8.m8.1.1.2" xref="S5.F6.19.8.m8.1.1.2.cmml">ω</mi><mi id="S5.F6.19.8.m8.1.1.3" xref="S5.F6.19.8.m8.1.1.3.cmml">wheel</mi></msub><annotation-xml encoding="MathML-Content" id="S5.F6.19.8.m8.1c"><apply id="S5.F6.19.8.m8.1.1.cmml" xref="S5.F6.19.8.m8.1.1"><csymbol cd="ambiguous" id="S5.F6.19.8.m8.1.1.1.cmml" xref="S5.F6.19.8.m8.1.1">subscript</csymbol><ci id="S5.F6.19.8.m8.1.1.2.cmml" xref="S5.F6.19.8.m8.1.1.2">𝜔</ci><ci id="S5.F6.19.8.m8.1.1.3.cmml" xref="S5.F6.19.8.m8.1.1.3">wheel</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F6.19.8.m8.1d">\omega_{\mathrm{wheel}}</annotation><annotation encoding="application/x-llamapun" id="S5.F6.19.8.m8.1e">italic_ω start_POSTSUBSCRIPT roman_wheel end_POSTSUBSCRIPT</annotation></semantics></math>, as observed from Diablo’s closed-loop model, are converted into the prismatic joint model’s length <math alttext="r" class="ltx_Math" display="inline" id="S5.F6.20.9.m9.1"><semantics id="S5.F6.20.9.m9.1b"><mi id="S5.F6.20.9.m9.1.1" xref="S5.F6.20.9.m9.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S5.F6.20.9.m9.1c"><ci id="S5.F6.20.9.m9.1.1.cmml" xref="S5.F6.20.9.m9.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F6.20.9.m9.1d">r</annotation><annotation encoding="application/x-llamapun" id="S5.F6.20.9.m9.1e">italic_r</annotation></semantics></math>, angle <math alttext="\theta" class="ltx_Math" display="inline" id="S5.F6.21.10.m10.1"><semantics id="S5.F6.21.10.m10.1b"><mi id="S5.F6.21.10.m10.1.1" xref="S5.F6.21.10.m10.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S5.F6.21.10.m10.1c"><ci id="S5.F6.21.10.m10.1.1.cmml" xref="S5.F6.21.10.m10.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F6.21.10.m10.1d">\theta</annotation><annotation encoding="application/x-llamapun" id="S5.F6.21.10.m10.1e">italic_θ</annotation></semantics></math>, and their derivatives <math alttext="\dot{r},\dot{\theta}" class="ltx_Math" display="inline" id="S5.F6.22.11.m11.2"><semantics id="S5.F6.22.11.m11.2b"><mrow id="S5.F6.22.11.m11.2.3.2" xref="S5.F6.22.11.m11.2.3.1.cmml"><mover accent="true" id="S5.F6.22.11.m11.1.1" xref="S5.F6.22.11.m11.1.1.cmml"><mi id="S5.F6.22.11.m11.1.1.2" xref="S5.F6.22.11.m11.1.1.2.cmml">r</mi><mo id="S5.F6.22.11.m11.1.1.1" xref="S5.F6.22.11.m11.1.1.1.cmml">˙</mo></mover><mo id="S5.F6.22.11.m11.2.3.2.1" xref="S5.F6.22.11.m11.2.3.1.cmml">,</mo><mover accent="true" id="S5.F6.22.11.m11.2.2" xref="S5.F6.22.11.m11.2.2.cmml"><mi id="S5.F6.22.11.m11.2.2.2" xref="S5.F6.22.11.m11.2.2.2.cmml">θ</mi><mo id="S5.F6.22.11.m11.2.2.1" xref="S5.F6.22.11.m11.2.2.1.cmml">˙</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="S5.F6.22.11.m11.2c"><list id="S5.F6.22.11.m11.2.3.1.cmml" xref="S5.F6.22.11.m11.2.3.2"><apply id="S5.F6.22.11.m11.1.1.cmml" xref="S5.F6.22.11.m11.1.1"><ci id="S5.F6.22.11.m11.1.1.1.cmml" xref="S5.F6.22.11.m11.1.1.1">˙</ci><ci id="S5.F6.22.11.m11.1.1.2.cmml" xref="S5.F6.22.11.m11.1.1.2">𝑟</ci></apply><apply id="S5.F6.22.11.m11.2.2.cmml" xref="S5.F6.22.11.m11.2.2"><ci id="S5.F6.22.11.m11.2.2.1.cmml" xref="S5.F6.22.11.m11.2.2.1">˙</ci><ci id="S5.F6.22.11.m11.2.2.2.cmml" xref="S5.F6.22.11.m11.2.2.2">𝜃</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S5.F6.22.11.m11.2d">\dot{r},\dot{\theta}</annotation><annotation encoding="application/x-llamapun" id="S5.F6.22.11.m11.2e">over˙ start_ARG italic_r end_ARG , over˙ start_ARG italic_θ end_ARG</annotation></semantics></math> through forward kinematics and differential forward kinematics. These are then updated as the state in the MPC’s internal model.</span></figcaption>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Computational Setups</h3>
<div class="ltx_para" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.3">All experiments in this study were conducted on a PC with the following specifications: Intel(R) Core(TM) i9-11900K <math alttext="3.50" class="ltx_Math" display="inline" id="S5.SS3.p1.1.m1.1"><semantics id="S5.SS3.p1.1.m1.1a"><mn id="S5.SS3.p1.1.m1.1.1" xref="S5.SS3.p1.1.m1.1.1.cmml">3.50</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.1.m1.1b"><cn id="S5.SS3.p1.1.m1.1.1.cmml" type="float" xref="S5.SS3.p1.1.m1.1.1">3.50</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.1.m1.1c">3.50</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.1.m1.1d">3.50</annotation></semantics></math> GHz and <math alttext="32" class="ltx_Math" display="inline" id="S5.SS3.p1.2.m2.1"><semantics id="S5.SS3.p1.2.m2.1a"><mn id="S5.SS3.p1.2.m2.1.1" xref="S5.SS3.p1.2.m2.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.2.m2.1b"><cn id="S5.SS3.p1.2.m2.1.1.cmml" type="integer" xref="S5.SS3.p1.2.m2.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.2.m2.1c">32</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.2.m2.1d">32</annotation></semantics></math> GB RAM. Furthermore, all computations, from the calculation of MPPI to the learning of the terminal value, were performed using C++. In the computation of MPPI, trajectory generation was accelerated through the use of 12-thread multiprocessing. For the training and inference of the neural network, the PyTorch C++ API <cite class="ltx_cite ltx_citemacro_citep">(Paszke et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#bib.bib32" title="">2019</a>)</cite> was utilized. In all experiments, the control cycle was set at <math alttext="10" class="ltx_Math" display="inline" id="S5.SS3.p1.3.m3.1"><semantics id="S5.SS3.p1.3.m3.1a"><mn id="S5.SS3.p1.3.m3.1.1" xref="S5.SS3.p1.3.m3.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.3.m3.1b"><cn id="S5.SS3.p1.3.m3.1.1.cmml" type="integer" xref="S5.SS3.p1.3.m3.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.3.m3.1c">10</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.3.m3.1d">10</annotation></semantics></math> ms, and the prediction horizon could be represented either in terms of step numbers or time intervals, with the former multiplied by the control cycle to obtain the corresponding time intervals. Details on the hyperparameters of MPPI and the neural network for each task are described in <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#A1" title="Appendix A Hyperparameter ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">A</span></a>.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Results</h2>
<section class="ltx_subsection" id="S6.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.1 </span>Path Tracking Tasks</h3>
<div class="ltx_para" id="S6.SS1.p1">
<p class="ltx_p" id="S6.SS1.p1.1">The learning curves obtained under these conditions are shown in the left image of Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S6.F7" title="Figure 7 ‣ 6.1 Path Tracking Tasks ‣ 6 Results ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">7</span></a>. This image displays the cumulative reward, defined as the negative cumulative cost per episode.</p>
</div>
<figure class="ltx_figure" id="S6.F7">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" id="S6.F7.1" style="width:216.8pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="245" id="S6.F7.1.g1" src="x9.png" width="327"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F7.1.1.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S6.F7.1.2.2" style="font-size:90%;">Flat surface</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" id="S6.F7.2" style="width:173.4pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="228" id="S6.F7.2.g1" src="x10.png" width="354"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F7.2.1.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S6.F7.2.2.2" style="font-size:90%;">Flat surface</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" id="S6.F7.3" style="width:216.8pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="245" id="S6.F7.3.g1" src="x11.png" width="327"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F7.3.1.1.1" style="font-size:90%;">(c)</span> </span><span class="ltx_text" id="S6.F7.3.2.2" style="font-size:90%;">Sloped surface</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" id="S6.F7.4" style="width:173.4pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="246" id="S6.F7.4.g1" src="x12.png" width="354"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F7.4.1.1.1" style="font-size:90%;">(d)</span> </span><span class="ltx_text" id="S6.F7.4.2.2" style="font-size:90%;">Sloped surface</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F7.26.11.1" style="font-size:90%;">Figure 7</span>: </span><span class="ltx_text" id="S6.F7.24.10" style="font-size:90%;">Left Figures: The learning curves show cumulative rewards for each episode. (a) depicts the cumulative rewards based on Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S5.E16" title="In 5.2 Path Tracking Tasks ‣ 5 Experiments ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">16</span></a>) when learning terminal value function conditioned on target velocity and angular velocity on flat terrain, while (c) shows rewards for sloped terrain, where the value is also conditioned on the slope angle (higher is better). The dotted lines represent cumulative rewards from MPC without terminal value learning. On flat terrain, horizon lengths <math alttext="H=40,50" class="ltx_Math" display="inline" id="S6.F7.15.1.m1.2"><semantics id="S6.F7.15.1.m1.2b"><mrow id="S6.F7.15.1.m1.2.3" xref="S6.F7.15.1.m1.2.3.cmml"><mi id="S6.F7.15.1.m1.2.3.2" xref="S6.F7.15.1.m1.2.3.2.cmml">H</mi><mo id="S6.F7.15.1.m1.2.3.1" xref="S6.F7.15.1.m1.2.3.1.cmml">=</mo><mrow id="S6.F7.15.1.m1.2.3.3.2" xref="S6.F7.15.1.m1.2.3.3.1.cmml"><mn id="S6.F7.15.1.m1.1.1" xref="S6.F7.15.1.m1.1.1.cmml">40</mn><mo id="S6.F7.15.1.m1.2.3.3.2.1" xref="S6.F7.15.1.m1.2.3.3.1.cmml">,</mo><mn id="S6.F7.15.1.m1.2.2" xref="S6.F7.15.1.m1.2.2.cmml">50</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.F7.15.1.m1.2c"><apply id="S6.F7.15.1.m1.2.3.cmml" xref="S6.F7.15.1.m1.2.3"><eq id="S6.F7.15.1.m1.2.3.1.cmml" xref="S6.F7.15.1.m1.2.3.1"></eq><ci id="S6.F7.15.1.m1.2.3.2.cmml" xref="S6.F7.15.1.m1.2.3.2">𝐻</ci><list id="S6.F7.15.1.m1.2.3.3.1.cmml" xref="S6.F7.15.1.m1.2.3.3.2"><cn id="S6.F7.15.1.m1.1.1.cmml" type="integer" xref="S6.F7.15.1.m1.1.1">40</cn><cn id="S6.F7.15.1.m1.2.2.cmml" type="integer" xref="S6.F7.15.1.m1.2.2">50</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F7.15.1.m1.2d">H=40,50</annotation><annotation encoding="application/x-llamapun" id="S6.F7.15.1.m1.2e">italic_H = 40 , 50</annotation></semantics></math> result in the robot falling early in the episode, reducing rewards, while horizons <math alttext="H=60,70" class="ltx_Math" display="inline" id="S6.F7.16.2.m2.2"><semantics id="S6.F7.16.2.m2.2b"><mrow id="S6.F7.16.2.m2.2.3" xref="S6.F7.16.2.m2.2.3.cmml"><mi id="S6.F7.16.2.m2.2.3.2" xref="S6.F7.16.2.m2.2.3.2.cmml">H</mi><mo id="S6.F7.16.2.m2.2.3.1" xref="S6.F7.16.2.m2.2.3.1.cmml">=</mo><mrow id="S6.F7.16.2.m2.2.3.3.2" xref="S6.F7.16.2.m2.2.3.3.1.cmml"><mn id="S6.F7.16.2.m2.1.1" xref="S6.F7.16.2.m2.1.1.cmml">60</mn><mo id="S6.F7.16.2.m2.2.3.3.2.1" xref="S6.F7.16.2.m2.2.3.3.1.cmml">,</mo><mn id="S6.F7.16.2.m2.2.2" xref="S6.F7.16.2.m2.2.2.cmml">70</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.F7.16.2.m2.2c"><apply id="S6.F7.16.2.m2.2.3.cmml" xref="S6.F7.16.2.m2.2.3"><eq id="S6.F7.16.2.m2.2.3.1.cmml" xref="S6.F7.16.2.m2.2.3.1"></eq><ci id="S6.F7.16.2.m2.2.3.2.cmml" xref="S6.F7.16.2.m2.2.3.2">𝐻</ci><list id="S6.F7.16.2.m2.2.3.3.1.cmml" xref="S6.F7.16.2.m2.2.3.3.2"><cn id="S6.F7.16.2.m2.1.1.cmml" type="integer" xref="S6.F7.16.2.m2.1.1">60</cn><cn id="S6.F7.16.2.m2.2.2.cmml" type="integer" xref="S6.F7.16.2.m2.2.2">70</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F7.16.2.m2.2d">H=60,70</annotation><annotation encoding="application/x-llamapun" id="S6.F7.16.2.m2.2e">italic_H = 60 , 70</annotation></semantics></math> enable successful locomotion. For sloped terrain, horizons <math alttext="H=50,60" class="ltx_Math" display="inline" id="S6.F7.17.3.m3.2"><semantics id="S6.F7.17.3.m3.2b"><mrow id="S6.F7.17.3.m3.2.3" xref="S6.F7.17.3.m3.2.3.cmml"><mi id="S6.F7.17.3.m3.2.3.2" xref="S6.F7.17.3.m3.2.3.2.cmml">H</mi><mo id="S6.F7.17.3.m3.2.3.1" xref="S6.F7.17.3.m3.2.3.1.cmml">=</mo><mrow id="S6.F7.17.3.m3.2.3.3.2" xref="S6.F7.17.3.m3.2.3.3.1.cmml"><mn id="S6.F7.17.3.m3.1.1" xref="S6.F7.17.3.m3.1.1.cmml">50</mn><mo id="S6.F7.17.3.m3.2.3.3.2.1" xref="S6.F7.17.3.m3.2.3.3.1.cmml">,</mo><mn id="S6.F7.17.3.m3.2.2" xref="S6.F7.17.3.m3.2.2.cmml">60</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.F7.17.3.m3.2c"><apply id="S6.F7.17.3.m3.2.3.cmml" xref="S6.F7.17.3.m3.2.3"><eq id="S6.F7.17.3.m3.2.3.1.cmml" xref="S6.F7.17.3.m3.2.3.1"></eq><ci id="S6.F7.17.3.m3.2.3.2.cmml" xref="S6.F7.17.3.m3.2.3.2">𝐻</ci><list id="S6.F7.17.3.m3.2.3.3.1.cmml" xref="S6.F7.17.3.m3.2.3.3.2"><cn id="S6.F7.17.3.m3.1.1.cmml" type="integer" xref="S6.F7.17.3.m3.1.1">50</cn><cn id="S6.F7.17.3.m3.2.2.cmml" type="integer" xref="S6.F7.17.3.m3.2.2">60</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F7.17.3.m3.2d">H=50,60</annotation><annotation encoding="application/x-llamapun" id="S6.F7.17.3.m3.2e">italic_H = 50 , 60</annotation></semantics></math> lead to falls, but horizons <math alttext="H=70,80" class="ltx_Math" display="inline" id="S6.F7.18.4.m4.2"><semantics id="S6.F7.18.4.m4.2b"><mrow id="S6.F7.18.4.m4.2.3" xref="S6.F7.18.4.m4.2.3.cmml"><mi id="S6.F7.18.4.m4.2.3.2" xref="S6.F7.18.4.m4.2.3.2.cmml">H</mi><mo id="S6.F7.18.4.m4.2.3.1" xref="S6.F7.18.4.m4.2.3.1.cmml">=</mo><mrow id="S6.F7.18.4.m4.2.3.3.2" xref="S6.F7.18.4.m4.2.3.3.1.cmml"><mn id="S6.F7.18.4.m4.1.1" xref="S6.F7.18.4.m4.1.1.cmml">70</mn><mo id="S6.F7.18.4.m4.2.3.3.2.1" xref="S6.F7.18.4.m4.2.3.3.1.cmml">,</mo><mn id="S6.F7.18.4.m4.2.2" xref="S6.F7.18.4.m4.2.2.cmml">80</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.F7.18.4.m4.2c"><apply id="S6.F7.18.4.m4.2.3.cmml" xref="S6.F7.18.4.m4.2.3"><eq id="S6.F7.18.4.m4.2.3.1.cmml" xref="S6.F7.18.4.m4.2.3.1"></eq><ci id="S6.F7.18.4.m4.2.3.2.cmml" xref="S6.F7.18.4.m4.2.3.2">𝐻</ci><list id="S6.F7.18.4.m4.2.3.3.1.cmml" xref="S6.F7.18.4.m4.2.3.3.2"><cn id="S6.F7.18.4.m4.1.1.cmml" type="integer" xref="S6.F7.18.4.m4.1.1">70</cn><cn id="S6.F7.18.4.m4.2.2.cmml" type="integer" xref="S6.F7.18.4.m4.2.2">80</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F7.18.4.m4.2d">H=70,80</annotation><annotation encoding="application/x-llamapun" id="S6.F7.18.4.m4.2e">italic_H = 70 , 80</annotation></semantics></math> result in successful performance. The solid blue lines show cumulative rewards using the proposed method, where terminal value functions are learned to improve performance. The robot achieves comparable performance to standard MPC with longer horizons <math alttext="H=70" class="ltx_Math" display="inline" id="S6.F7.19.5.m5.1"><semantics id="S6.F7.19.5.m5.1b"><mrow id="S6.F7.19.5.m5.1.1" xref="S6.F7.19.5.m5.1.1.cmml"><mi id="S6.F7.19.5.m5.1.1.2" xref="S6.F7.19.5.m5.1.1.2.cmml">H</mi><mo id="S6.F7.19.5.m5.1.1.1" xref="S6.F7.19.5.m5.1.1.1.cmml">=</mo><mn id="S6.F7.19.5.m5.1.1.3" xref="S6.F7.19.5.m5.1.1.3.cmml">70</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.F7.19.5.m5.1c"><apply id="S6.F7.19.5.m5.1.1.cmml" xref="S6.F7.19.5.m5.1.1"><eq id="S6.F7.19.5.m5.1.1.1.cmml" xref="S6.F7.19.5.m5.1.1.1"></eq><ci id="S6.F7.19.5.m5.1.1.2.cmml" xref="S6.F7.19.5.m5.1.1.2">𝐻</ci><cn id="S6.F7.19.5.m5.1.1.3.cmml" type="integer" xref="S6.F7.19.5.m5.1.1.3">70</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F7.19.5.m5.1d">H=70</annotation><annotation encoding="application/x-llamapun" id="S6.F7.19.5.m5.1e">italic_H = 70</annotation></semantics></math> (flat) and <math alttext="H=80" class="ltx_Math" display="inline" id="S6.F7.20.6.m6.1"><semantics id="S6.F7.20.6.m6.1b"><mrow id="S6.F7.20.6.m6.1.1" xref="S6.F7.20.6.m6.1.1.cmml"><mi id="S6.F7.20.6.m6.1.1.2" xref="S6.F7.20.6.m6.1.1.2.cmml">H</mi><mo id="S6.F7.20.6.m6.1.1.1" xref="S6.F7.20.6.m6.1.1.1.cmml">=</mo><mn id="S6.F7.20.6.m6.1.1.3" xref="S6.F7.20.6.m6.1.1.3.cmml">80</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.F7.20.6.m6.1c"><apply id="S6.F7.20.6.m6.1.1.cmml" xref="S6.F7.20.6.m6.1.1"><eq id="S6.F7.20.6.m6.1.1.1.cmml" xref="S6.F7.20.6.m6.1.1.1"></eq><ci id="S6.F7.20.6.m6.1.1.2.cmml" xref="S6.F7.20.6.m6.1.1.2">𝐻</ci><cn id="S6.F7.20.6.m6.1.1.3.cmml" type="integer" xref="S6.F7.20.6.m6.1.1.3">80</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F7.20.6.m6.1d">H=80</annotation><annotation encoding="application/x-llamapun" id="S6.F7.20.6.m6.1e">italic_H = 80</annotation></semantics></math> (sloped), even with shorter horizons <math alttext="H=40" class="ltx_Math" display="inline" id="S6.F7.21.7.m7.1"><semantics id="S6.F7.21.7.m7.1b"><mrow id="S6.F7.21.7.m7.1.1" xref="S6.F7.21.7.m7.1.1.cmml"><mi id="S6.F7.21.7.m7.1.1.2" xref="S6.F7.21.7.m7.1.1.2.cmml">H</mi><mo id="S6.F7.21.7.m7.1.1.1" xref="S6.F7.21.7.m7.1.1.1.cmml">=</mo><mn id="S6.F7.21.7.m7.1.1.3" xref="S6.F7.21.7.m7.1.1.3.cmml">40</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.F7.21.7.m7.1c"><apply id="S6.F7.21.7.m7.1.1.cmml" xref="S6.F7.21.7.m7.1.1"><eq id="S6.F7.21.7.m7.1.1.1.cmml" xref="S6.F7.21.7.m7.1.1.1"></eq><ci id="S6.F7.21.7.m7.1.1.2.cmml" xref="S6.F7.21.7.m7.1.1.2">𝐻</ci><cn id="S6.F7.21.7.m7.1.1.3.cmml" type="integer" xref="S6.F7.21.7.m7.1.1.3">40</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F7.21.7.m7.1d">H=40</annotation><annotation encoding="application/x-llamapun" id="S6.F7.21.7.m7.1e">italic_H = 40</annotation></semantics></math> (flat) and <math alttext="H=46" class="ltx_Math" display="inline" id="S6.F7.22.8.m8.1"><semantics id="S6.F7.22.8.m8.1b"><mrow id="S6.F7.22.8.m8.1.1" xref="S6.F7.22.8.m8.1.1.cmml"><mi id="S6.F7.22.8.m8.1.1.2" xref="S6.F7.22.8.m8.1.1.2.cmml">H</mi><mo id="S6.F7.22.8.m8.1.1.1" xref="S6.F7.22.8.m8.1.1.1.cmml">=</mo><mn id="S6.F7.22.8.m8.1.1.3" xref="S6.F7.22.8.m8.1.1.3.cmml">46</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.F7.22.8.m8.1c"><apply id="S6.F7.22.8.m8.1.1.cmml" xref="S6.F7.22.8.m8.1.1"><eq id="S6.F7.22.8.m8.1.1.1.cmml" xref="S6.F7.22.8.m8.1.1.1"></eq><ci id="S6.F7.22.8.m8.1.1.2.cmml" xref="S6.F7.22.8.m8.1.1.2">𝐻</ci><cn id="S6.F7.22.8.m8.1.1.3.cmml" type="integer" xref="S6.F7.22.8.m8.1.1.3">46</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F7.22.8.m8.1d">H=46</annotation><annotation encoding="application/x-llamapun" id="S6.F7.22.8.m8.1e">italic_H = 46</annotation></semantics></math> (sloped).
<br class="ltx_break"/>Right Figures: These figures illustrate the results of using the learned terminal value functions with horizon lengths <math alttext="H=40" class="ltx_Math" display="inline" id="S6.F7.23.9.m9.1"><semantics id="S6.F7.23.9.m9.1b"><mrow id="S6.F7.23.9.m9.1.1" xref="S6.F7.23.9.m9.1.1.cmml"><mi id="S6.F7.23.9.m9.1.1.2" xref="S6.F7.23.9.m9.1.1.2.cmml">H</mi><mo id="S6.F7.23.9.m9.1.1.1" xref="S6.F7.23.9.m9.1.1.1.cmml">=</mo><mn id="S6.F7.23.9.m9.1.1.3" xref="S6.F7.23.9.m9.1.1.3.cmml">40</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.F7.23.9.m9.1c"><apply id="S6.F7.23.9.m9.1.1.cmml" xref="S6.F7.23.9.m9.1.1"><eq id="S6.F7.23.9.m9.1.1.1.cmml" xref="S6.F7.23.9.m9.1.1.1"></eq><ci id="S6.F7.23.9.m9.1.1.2.cmml" xref="S6.F7.23.9.m9.1.1.2">𝐻</ci><cn id="S6.F7.23.9.m9.1.1.3.cmml" type="integer" xref="S6.F7.23.9.m9.1.1.3">40</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F7.23.9.m9.1d">H=40</annotation><annotation encoding="application/x-llamapun" id="S6.F7.23.9.m9.1e">italic_H = 40</annotation></semantics></math> (flat) and <math alttext="H=46" class="ltx_Math" display="inline" id="S6.F7.24.10.m10.1"><semantics id="S6.F7.24.10.m10.1b"><mrow id="S6.F7.24.10.m10.1.1" xref="S6.F7.24.10.m10.1.1.cmml"><mi id="S6.F7.24.10.m10.1.1.2" xref="S6.F7.24.10.m10.1.1.2.cmml">H</mi><mo id="S6.F7.24.10.m10.1.1.1" xref="S6.F7.24.10.m10.1.1.1.cmml">=</mo><mn id="S6.F7.24.10.m10.1.1.3" xref="S6.F7.24.10.m10.1.1.3.cmml">46</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.F7.24.10.m10.1c"><apply id="S6.F7.24.10.m10.1.1.cmml" xref="S6.F7.24.10.m10.1.1"><eq id="S6.F7.24.10.m10.1.1.1.cmml" xref="S6.F7.24.10.m10.1.1.1"></eq><ci id="S6.F7.24.10.m10.1.1.2.cmml" xref="S6.F7.24.10.m10.1.1.2">𝐻</ci><cn id="S6.F7.24.10.m10.1.1.3.cmml" type="integer" xref="S6.F7.24.10.m10.1.1.3">46</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F7.24.10.m10.1d">H=46</annotation><annotation encoding="application/x-llamapun" id="S6.F7.24.10.m10.1e">italic_H = 46</annotation></semantics></math> (sloped) to perform lemniscate trajectory tracking. The robot successfully follows the trajectory and adapts to terrain changes. Without terminal value learning, the robot would fall at the beginning of each run with the same horizon lengths.</span></figcaption>
</figure>
<div class="ltx_para" id="S6.SS1.p2">
<p class="ltx_p" id="S6.SS1.p2.5">For the evaluation, we set the goal variables as <math alttext="v_{\mathrm{goal}}=[0.2,0.4,0.6,0.8]" class="ltx_Math" display="inline" id="S6.SS1.p2.1.m1.4"><semantics id="S6.SS1.p2.1.m1.4a"><mrow id="S6.SS1.p2.1.m1.4.5" xref="S6.SS1.p2.1.m1.4.5.cmml"><msub id="S6.SS1.p2.1.m1.4.5.2" xref="S6.SS1.p2.1.m1.4.5.2.cmml"><mi id="S6.SS1.p2.1.m1.4.5.2.2" xref="S6.SS1.p2.1.m1.4.5.2.2.cmml">v</mi><mi id="S6.SS1.p2.1.m1.4.5.2.3" xref="S6.SS1.p2.1.m1.4.5.2.3.cmml">goal</mi></msub><mo id="S6.SS1.p2.1.m1.4.5.1" xref="S6.SS1.p2.1.m1.4.5.1.cmml">=</mo><mrow id="S6.SS1.p2.1.m1.4.5.3.2" xref="S6.SS1.p2.1.m1.4.5.3.1.cmml"><mo id="S6.SS1.p2.1.m1.4.5.3.2.1" stretchy="false" xref="S6.SS1.p2.1.m1.4.5.3.1.cmml">[</mo><mn id="S6.SS1.p2.1.m1.1.1" xref="S6.SS1.p2.1.m1.1.1.cmml">0.2</mn><mo id="S6.SS1.p2.1.m1.4.5.3.2.2" xref="S6.SS1.p2.1.m1.4.5.3.1.cmml">,</mo><mn id="S6.SS1.p2.1.m1.2.2" xref="S6.SS1.p2.1.m1.2.2.cmml">0.4</mn><mo id="S6.SS1.p2.1.m1.4.5.3.2.3" xref="S6.SS1.p2.1.m1.4.5.3.1.cmml">,</mo><mn id="S6.SS1.p2.1.m1.3.3" xref="S6.SS1.p2.1.m1.3.3.cmml">0.6</mn><mo id="S6.SS1.p2.1.m1.4.5.3.2.4" xref="S6.SS1.p2.1.m1.4.5.3.1.cmml">,</mo><mn id="S6.SS1.p2.1.m1.4.4" xref="S6.SS1.p2.1.m1.4.4.cmml">0.8</mn><mo id="S6.SS1.p2.1.m1.4.5.3.2.5" stretchy="false" xref="S6.SS1.p2.1.m1.4.5.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.1.m1.4b"><apply id="S6.SS1.p2.1.m1.4.5.cmml" xref="S6.SS1.p2.1.m1.4.5"><eq id="S6.SS1.p2.1.m1.4.5.1.cmml" xref="S6.SS1.p2.1.m1.4.5.1"></eq><apply id="S6.SS1.p2.1.m1.4.5.2.cmml" xref="S6.SS1.p2.1.m1.4.5.2"><csymbol cd="ambiguous" id="S6.SS1.p2.1.m1.4.5.2.1.cmml" xref="S6.SS1.p2.1.m1.4.5.2">subscript</csymbol><ci id="S6.SS1.p2.1.m1.4.5.2.2.cmml" xref="S6.SS1.p2.1.m1.4.5.2.2">𝑣</ci><ci id="S6.SS1.p2.1.m1.4.5.2.3.cmml" xref="S6.SS1.p2.1.m1.4.5.2.3">goal</ci></apply><list id="S6.SS1.p2.1.m1.4.5.3.1.cmml" xref="S6.SS1.p2.1.m1.4.5.3.2"><cn id="S6.SS1.p2.1.m1.1.1.cmml" type="float" xref="S6.SS1.p2.1.m1.1.1">0.2</cn><cn id="S6.SS1.p2.1.m1.2.2.cmml" type="float" xref="S6.SS1.p2.1.m1.2.2">0.4</cn><cn id="S6.SS1.p2.1.m1.3.3.cmml" type="float" xref="S6.SS1.p2.1.m1.3.3">0.6</cn><cn id="S6.SS1.p2.1.m1.4.4.cmml" type="float" xref="S6.SS1.p2.1.m1.4.4">0.8</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.1.m1.4c">v_{\mathrm{goal}}=[0.2,0.4,0.6,0.8]</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p2.1.m1.4d">italic_v start_POSTSUBSCRIPT roman_goal end_POSTSUBSCRIPT = [ 0.2 , 0.4 , 0.6 , 0.8 ]</annotation></semantics></math> and <math alttext="\omega_{\mathrm{goal}}=[-1.0,-0.5,0,0.5,1.0]." class="ltx_Math" display="inline" id="S6.SS1.p2.2.m2.4"><semantics id="S6.SS1.p2.2.m2.4a"><mrow id="S6.SS1.p2.2.m2.4.4.1" xref="S6.SS1.p2.2.m2.4.4.1.1.cmml"><mrow id="S6.SS1.p2.2.m2.4.4.1.1" xref="S6.SS1.p2.2.m2.4.4.1.1.cmml"><msub id="S6.SS1.p2.2.m2.4.4.1.1.4" xref="S6.SS1.p2.2.m2.4.4.1.1.4.cmml"><mi id="S6.SS1.p2.2.m2.4.4.1.1.4.2" xref="S6.SS1.p2.2.m2.4.4.1.1.4.2.cmml">ω</mi><mi id="S6.SS1.p2.2.m2.4.4.1.1.4.3" xref="S6.SS1.p2.2.m2.4.4.1.1.4.3.cmml">goal</mi></msub><mo id="S6.SS1.p2.2.m2.4.4.1.1.3" xref="S6.SS1.p2.2.m2.4.4.1.1.3.cmml">=</mo><mrow id="S6.SS1.p2.2.m2.4.4.1.1.2.2" xref="S6.SS1.p2.2.m2.4.4.1.1.2.3.cmml"><mo id="S6.SS1.p2.2.m2.4.4.1.1.2.2.3" stretchy="false" xref="S6.SS1.p2.2.m2.4.4.1.1.2.3.cmml">[</mo><mrow id="S6.SS1.p2.2.m2.4.4.1.1.1.1.1" xref="S6.SS1.p2.2.m2.4.4.1.1.1.1.1.cmml"><mo id="S6.SS1.p2.2.m2.4.4.1.1.1.1.1a" xref="S6.SS1.p2.2.m2.4.4.1.1.1.1.1.cmml">−</mo><mn id="S6.SS1.p2.2.m2.4.4.1.1.1.1.1.2" xref="S6.SS1.p2.2.m2.4.4.1.1.1.1.1.2.cmml">1.0</mn></mrow><mo id="S6.SS1.p2.2.m2.4.4.1.1.2.2.4" xref="S6.SS1.p2.2.m2.4.4.1.1.2.3.cmml">,</mo><mrow id="S6.SS1.p2.2.m2.4.4.1.1.2.2.2" xref="S6.SS1.p2.2.m2.4.4.1.1.2.2.2.cmml"><mo id="S6.SS1.p2.2.m2.4.4.1.1.2.2.2a" xref="S6.SS1.p2.2.m2.4.4.1.1.2.2.2.cmml">−</mo><mn id="S6.SS1.p2.2.m2.4.4.1.1.2.2.2.2" xref="S6.SS1.p2.2.m2.4.4.1.1.2.2.2.2.cmml">0.5</mn></mrow><mo id="S6.SS1.p2.2.m2.4.4.1.1.2.2.5" xref="S6.SS1.p2.2.m2.4.4.1.1.2.3.cmml">,</mo><mn id="S6.SS1.p2.2.m2.1.1" xref="S6.SS1.p2.2.m2.1.1.cmml">0</mn><mo id="S6.SS1.p2.2.m2.4.4.1.1.2.2.6" xref="S6.SS1.p2.2.m2.4.4.1.1.2.3.cmml">,</mo><mn id="S6.SS1.p2.2.m2.2.2" xref="S6.SS1.p2.2.m2.2.2.cmml">0.5</mn><mo id="S6.SS1.p2.2.m2.4.4.1.1.2.2.7" xref="S6.SS1.p2.2.m2.4.4.1.1.2.3.cmml">,</mo><mn id="S6.SS1.p2.2.m2.3.3" xref="S6.SS1.p2.2.m2.3.3.cmml">1.0</mn><mo id="S6.SS1.p2.2.m2.4.4.1.1.2.2.8" stretchy="false" xref="S6.SS1.p2.2.m2.4.4.1.1.2.3.cmml">]</mo></mrow></mrow><mo id="S6.SS1.p2.2.m2.4.4.1.2" lspace="0em" xref="S6.SS1.p2.2.m2.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.2.m2.4b"><apply id="S6.SS1.p2.2.m2.4.4.1.1.cmml" xref="S6.SS1.p2.2.m2.4.4.1"><eq id="S6.SS1.p2.2.m2.4.4.1.1.3.cmml" xref="S6.SS1.p2.2.m2.4.4.1.1.3"></eq><apply id="S6.SS1.p2.2.m2.4.4.1.1.4.cmml" xref="S6.SS1.p2.2.m2.4.4.1.1.4"><csymbol cd="ambiguous" id="S6.SS1.p2.2.m2.4.4.1.1.4.1.cmml" xref="S6.SS1.p2.2.m2.4.4.1.1.4">subscript</csymbol><ci id="S6.SS1.p2.2.m2.4.4.1.1.4.2.cmml" xref="S6.SS1.p2.2.m2.4.4.1.1.4.2">𝜔</ci><ci id="S6.SS1.p2.2.m2.4.4.1.1.4.3.cmml" xref="S6.SS1.p2.2.m2.4.4.1.1.4.3">goal</ci></apply><list id="S6.SS1.p2.2.m2.4.4.1.1.2.3.cmml" xref="S6.SS1.p2.2.m2.4.4.1.1.2.2"><apply id="S6.SS1.p2.2.m2.4.4.1.1.1.1.1.cmml" xref="S6.SS1.p2.2.m2.4.4.1.1.1.1.1"><minus id="S6.SS1.p2.2.m2.4.4.1.1.1.1.1.1.cmml" xref="S6.SS1.p2.2.m2.4.4.1.1.1.1.1"></minus><cn id="S6.SS1.p2.2.m2.4.4.1.1.1.1.1.2.cmml" type="float" xref="S6.SS1.p2.2.m2.4.4.1.1.1.1.1.2">1.0</cn></apply><apply id="S6.SS1.p2.2.m2.4.4.1.1.2.2.2.cmml" xref="S6.SS1.p2.2.m2.4.4.1.1.2.2.2"><minus id="S6.SS1.p2.2.m2.4.4.1.1.2.2.2.1.cmml" xref="S6.SS1.p2.2.m2.4.4.1.1.2.2.2"></minus><cn id="S6.SS1.p2.2.m2.4.4.1.1.2.2.2.2.cmml" type="float" xref="S6.SS1.p2.2.m2.4.4.1.1.2.2.2.2">0.5</cn></apply><cn id="S6.SS1.p2.2.m2.1.1.cmml" type="integer" xref="S6.SS1.p2.2.m2.1.1">0</cn><cn id="S6.SS1.p2.2.m2.2.2.cmml" type="float" xref="S6.SS1.p2.2.m2.2.2">0.5</cn><cn id="S6.SS1.p2.2.m2.3.3.cmml" type="float" xref="S6.SS1.p2.2.m2.3.3">1.0</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.2.m2.4c">\omega_{\mathrm{goal}}=[-1.0,-0.5,0,0.5,1.0].</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p2.2.m2.4d">italic_ω start_POSTSUBSCRIPT roman_goal end_POSTSUBSCRIPT = [ - 1.0 , - 0.5 , 0 , 0.5 , 1.0 ] .</annotation></semantics></math> The average cumulative reward for each episode under these settings is illustrated, indicating that the proposed method at <math alttext="H=40" class="ltx_Math" display="inline" id="S6.SS1.p2.3.m3.1"><semantics id="S6.SS1.p2.3.m3.1a"><mrow id="S6.SS1.p2.3.m3.1.1" xref="S6.SS1.p2.3.m3.1.1.cmml"><mi id="S6.SS1.p2.3.m3.1.1.2" xref="S6.SS1.p2.3.m3.1.1.2.cmml">H</mi><mo id="S6.SS1.p2.3.m3.1.1.1" xref="S6.SS1.p2.3.m3.1.1.1.cmml">=</mo><mn id="S6.SS1.p2.3.m3.1.1.3" xref="S6.SS1.p2.3.m3.1.1.3.cmml">40</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.3.m3.1b"><apply id="S6.SS1.p2.3.m3.1.1.cmml" xref="S6.SS1.p2.3.m3.1.1"><eq id="S6.SS1.p2.3.m3.1.1.1.cmml" xref="S6.SS1.p2.3.m3.1.1.1"></eq><ci id="S6.SS1.p2.3.m3.1.1.2.cmml" xref="S6.SS1.p2.3.m3.1.1.2">𝐻</ci><cn id="S6.SS1.p2.3.m3.1.1.3.cmml" type="integer" xref="S6.SS1.p2.3.m3.1.1.3">40</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.3.m3.1c">H=40</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p2.3.m3.1d">italic_H = 40</annotation></semantics></math> significantly outperforms the MPC at <math alttext="H=40" class="ltx_Math" display="inline" id="S6.SS1.p2.4.m4.1"><semantics id="S6.SS1.p2.4.m4.1a"><mrow id="S6.SS1.p2.4.m4.1.1" xref="S6.SS1.p2.4.m4.1.1.cmml"><mi id="S6.SS1.p2.4.m4.1.1.2" xref="S6.SS1.p2.4.m4.1.1.2.cmml">H</mi><mo id="S6.SS1.p2.4.m4.1.1.1" xref="S6.SS1.p2.4.m4.1.1.1.cmml">=</mo><mn id="S6.SS1.p2.4.m4.1.1.3" xref="S6.SS1.p2.4.m4.1.1.3.cmml">40</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.4.m4.1b"><apply id="S6.SS1.p2.4.m4.1.1.cmml" xref="S6.SS1.p2.4.m4.1.1"><eq id="S6.SS1.p2.4.m4.1.1.1.cmml" xref="S6.SS1.p2.4.m4.1.1.1"></eq><ci id="S6.SS1.p2.4.m4.1.1.2.cmml" xref="S6.SS1.p2.4.m4.1.1.2">𝐻</ci><cn id="S6.SS1.p2.4.m4.1.1.3.cmml" type="integer" xref="S6.SS1.p2.4.m4.1.1.3">40</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.4.m4.1c">H=40</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p2.4.m4.1d">italic_H = 40</annotation></semantics></math> and exhibits comparable performance to the MPC at <math alttext="H=70" class="ltx_Math" display="inline" id="S6.SS1.p2.5.m5.1"><semantics id="S6.SS1.p2.5.m5.1a"><mrow id="S6.SS1.p2.5.m5.1.1" xref="S6.SS1.p2.5.m5.1.1.cmml"><mi id="S6.SS1.p2.5.m5.1.1.2" xref="S6.SS1.p2.5.m5.1.1.2.cmml">H</mi><mo id="S6.SS1.p2.5.m5.1.1.1" xref="S6.SS1.p2.5.m5.1.1.1.cmml">=</mo><mn id="S6.SS1.p2.5.m5.1.1.3" xref="S6.SS1.p2.5.m5.1.1.3.cmml">70</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.5.m5.1b"><apply id="S6.SS1.p2.5.m5.1.1.cmml" xref="S6.SS1.p2.5.m5.1.1"><eq id="S6.SS1.p2.5.m5.1.1.1.cmml" xref="S6.SS1.p2.5.m5.1.1.1"></eq><ci id="S6.SS1.p2.5.m5.1.1.2.cmml" xref="S6.SS1.p2.5.m5.1.1.2">𝐻</ci><cn id="S6.SS1.p2.5.m5.1.1.3.cmml" type="integer" xref="S6.SS1.p2.5.m5.1.1.3">70</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.5.m5.1c">H=70</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p2.5.m5.1d">italic_H = 70</annotation></semantics></math>, thus successfully learning the terminal values for the specified range of goal variables.</p>
</div>
<div class="ltx_para" id="S6.SS1.p3">
<p class="ltx_p" id="S6.SS1.p3.3">From the figure, it is evident that the motions generated follow the specified figure-eight trajectory. Additionally, after setting the internal model’s timestep for the MPC calculations to <math alttext="5\,[$\mathrm{m}\mathrm{s}$]" class="ltx_Math" display="inline" id="S6.SS1.p3.1.m1.2"><semantics id="S6.SS1.p3.1.m1.2a"><mrow id="S6.SS1.p3.1.m1.2.3" xref="S6.SS1.p3.1.m1.2.3.cmml"><mn id="S6.SS1.p3.1.m1.2.3.2" xref="S6.SS1.p3.1.m1.2.3.2.cmml">5</mn><mo id="S6.SS1.p3.1.m1.2.3.1" lspace="0.170em" xref="S6.SS1.p3.1.m1.2.3.1.cmml">⁢</mo><mrow id="S6.SS1.p3.1.m1.2.3.3.2" xref="S6.SS1.p3.1.m1.2.3.3.1.cmml"><mo id="S6.SS1.p3.1.m1.2.3.3.2.1" stretchy="false" xref="S6.SS1.p3.1.m1.2.3.3.1.1.cmml">[</mo><mi id="S6.SS1.p3.1.m1.2.2" xref="S6.SS1.p3.1.m1.2.2.cmml">ms</mi><mo id="S6.SS1.p3.1.m1.2.3.3.2.2" stretchy="false" xref="S6.SS1.p3.1.m1.2.3.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p3.1.m1.2b"><apply id="S6.SS1.p3.1.m1.2.3.cmml" xref="S6.SS1.p3.1.m1.2.3"><times id="S6.SS1.p3.1.m1.2.3.1.cmml" xref="S6.SS1.p3.1.m1.2.3.1"></times><cn id="S6.SS1.p3.1.m1.2.3.2.cmml" type="integer" xref="S6.SS1.p3.1.m1.2.3.2">5</cn><apply id="S6.SS1.p3.1.m1.2.3.3.1.cmml" xref="S6.SS1.p3.1.m1.2.3.3.2"><csymbol cd="latexml" id="S6.SS1.p3.1.m1.2.3.3.1.1.cmml" xref="S6.SS1.p3.1.m1.2.3.3.2.1">delimited-[]</csymbol><ci id="S6.SS1.p3.1.m1.2.2.cmml" xref="S6.SS1.p3.1.m1.2.2">ms</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p3.1.m1.2c">5\,[$\mathrm{m}\mathrm{s}$]</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p3.1.m1.2d">5 [ roman_ms ]</annotation></semantics></math>, the maximum computation time for the entire control framework across all timesteps was measured. In 10 trials, the maximum computation time was <math alttext="7.7\,[$\mathrm{m}\mathrm{s}$]" class="ltx_Math" display="inline" id="S6.SS1.p3.2.m2.2"><semantics id="S6.SS1.p3.2.m2.2a"><mrow id="S6.SS1.p3.2.m2.2.3" xref="S6.SS1.p3.2.m2.2.3.cmml"><mn id="S6.SS1.p3.2.m2.2.3.2" xref="S6.SS1.p3.2.m2.2.3.2.cmml">7.7</mn><mo id="S6.SS1.p3.2.m2.2.3.1" lspace="0.170em" xref="S6.SS1.p3.2.m2.2.3.1.cmml">⁢</mo><mrow id="S6.SS1.p3.2.m2.2.3.3.2" xref="S6.SS1.p3.2.m2.2.3.3.1.cmml"><mo id="S6.SS1.p3.2.m2.2.3.3.2.1" stretchy="false" xref="S6.SS1.p3.2.m2.2.3.3.1.1.cmml">[</mo><mi id="S6.SS1.p3.2.m2.2.2" xref="S6.SS1.p3.2.m2.2.2.cmml">ms</mi><mo id="S6.SS1.p3.2.m2.2.3.3.2.2" stretchy="false" xref="S6.SS1.p3.2.m2.2.3.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p3.2.m2.2b"><apply id="S6.SS1.p3.2.m2.2.3.cmml" xref="S6.SS1.p3.2.m2.2.3"><times id="S6.SS1.p3.2.m2.2.3.1.cmml" xref="S6.SS1.p3.2.m2.2.3.1"></times><cn id="S6.SS1.p3.2.m2.2.3.2.cmml" type="float" xref="S6.SS1.p3.2.m2.2.3.2">7.7</cn><apply id="S6.SS1.p3.2.m2.2.3.3.1.cmml" xref="S6.SS1.p3.2.m2.2.3.3.2"><csymbol cd="latexml" id="S6.SS1.p3.2.m2.2.3.3.1.1.cmml" xref="S6.SS1.p3.2.m2.2.3.3.2.1">delimited-[]</csymbol><ci id="S6.SS1.p3.2.m2.2.2.cmml" xref="S6.SS1.p3.2.m2.2.2">ms</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p3.2.m2.2c">7.7\,[$\mathrm{m}\mathrm{s}$]</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p3.2.m2.2d">7.7 [ roman_ms ]</annotation></semantics></math>, ensuring real-time control within the <math alttext="10\,[$\mathrm{m}\mathrm{s}$]" class="ltx_Math" display="inline" id="S6.SS1.p3.3.m3.2"><semantics id="S6.SS1.p3.3.m3.2a"><mrow id="S6.SS1.p3.3.m3.2.3" xref="S6.SS1.p3.3.m3.2.3.cmml"><mn id="S6.SS1.p3.3.m3.2.3.2" xref="S6.SS1.p3.3.m3.2.3.2.cmml">10</mn><mo id="S6.SS1.p3.3.m3.2.3.1" lspace="0.170em" xref="S6.SS1.p3.3.m3.2.3.1.cmml">⁢</mo><mrow id="S6.SS1.p3.3.m3.2.3.3.2" xref="S6.SS1.p3.3.m3.2.3.3.1.cmml"><mo id="S6.SS1.p3.3.m3.2.3.3.2.1" stretchy="false" xref="S6.SS1.p3.3.m3.2.3.3.1.1.cmml">[</mo><mi id="S6.SS1.p3.3.m3.2.2" xref="S6.SS1.p3.3.m3.2.2.cmml">ms</mi><mo id="S6.SS1.p3.3.m3.2.3.3.2.2" stretchy="false" xref="S6.SS1.p3.3.m3.2.3.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p3.3.m3.2b"><apply id="S6.SS1.p3.3.m3.2.3.cmml" xref="S6.SS1.p3.3.m3.2.3"><times id="S6.SS1.p3.3.m3.2.3.1.cmml" xref="S6.SS1.p3.3.m3.2.3.1"></times><cn id="S6.SS1.p3.3.m3.2.3.2.cmml" type="integer" xref="S6.SS1.p3.3.m3.2.3.2">10</cn><apply id="S6.SS1.p3.3.m3.2.3.3.1.cmml" xref="S6.SS1.p3.3.m3.2.3.3.2"><csymbol cd="latexml" id="S6.SS1.p3.3.m3.2.3.3.1.1.cmml" xref="S6.SS1.p3.3.m3.2.3.3.2.1">delimited-[]</csymbol><ci id="S6.SS1.p3.3.m3.2.2.cmml" xref="S6.SS1.p3.3.m3.2.2">ms</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p3.3.m3.2c">10\,[$\mathrm{m}\mathrm{s}$]</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p3.3.m3.2d">10 [ roman_ms ]</annotation></semantics></math> control cycle.</p>
</div>
<div class="ltx_para" id="S6.SS1.p4">
<p class="ltx_p" id="S6.SS1.p4.8">The learning curves are shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S6.F7" title="Figure 7 ‣ 6.1 Path Tracking Tasks ‣ 6 Results ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">7</span></a>. For the evaluation, we set the following: <math alttext="v_{\mathrm{goal}}=[0.2,0.4,0.6,0.8]" class="ltx_Math" display="inline" id="S6.SS1.p4.1.m1.4"><semantics id="S6.SS1.p4.1.m1.4a"><mrow id="S6.SS1.p4.1.m1.4.5" xref="S6.SS1.p4.1.m1.4.5.cmml"><msub id="S6.SS1.p4.1.m1.4.5.2" xref="S6.SS1.p4.1.m1.4.5.2.cmml"><mi id="S6.SS1.p4.1.m1.4.5.2.2" xref="S6.SS1.p4.1.m1.4.5.2.2.cmml">v</mi><mi id="S6.SS1.p4.1.m1.4.5.2.3" xref="S6.SS1.p4.1.m1.4.5.2.3.cmml">goal</mi></msub><mo id="S6.SS1.p4.1.m1.4.5.1" xref="S6.SS1.p4.1.m1.4.5.1.cmml">=</mo><mrow id="S6.SS1.p4.1.m1.4.5.3.2" xref="S6.SS1.p4.1.m1.4.5.3.1.cmml"><mo id="S6.SS1.p4.1.m1.4.5.3.2.1" stretchy="false" xref="S6.SS1.p4.1.m1.4.5.3.1.cmml">[</mo><mn id="S6.SS1.p4.1.m1.1.1" xref="S6.SS1.p4.1.m1.1.1.cmml">0.2</mn><mo id="S6.SS1.p4.1.m1.4.5.3.2.2" xref="S6.SS1.p4.1.m1.4.5.3.1.cmml">,</mo><mn id="S6.SS1.p4.1.m1.2.2" xref="S6.SS1.p4.1.m1.2.2.cmml">0.4</mn><mo id="S6.SS1.p4.1.m1.4.5.3.2.3" xref="S6.SS1.p4.1.m1.4.5.3.1.cmml">,</mo><mn id="S6.SS1.p4.1.m1.3.3" xref="S6.SS1.p4.1.m1.3.3.cmml">0.6</mn><mo id="S6.SS1.p4.1.m1.4.5.3.2.4" xref="S6.SS1.p4.1.m1.4.5.3.1.cmml">,</mo><mn id="S6.SS1.p4.1.m1.4.4" xref="S6.SS1.p4.1.m1.4.4.cmml">0.8</mn><mo id="S6.SS1.p4.1.m1.4.5.3.2.5" stretchy="false" xref="S6.SS1.p4.1.m1.4.5.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p4.1.m1.4b"><apply id="S6.SS1.p4.1.m1.4.5.cmml" xref="S6.SS1.p4.1.m1.4.5"><eq id="S6.SS1.p4.1.m1.4.5.1.cmml" xref="S6.SS1.p4.1.m1.4.5.1"></eq><apply id="S6.SS1.p4.1.m1.4.5.2.cmml" xref="S6.SS1.p4.1.m1.4.5.2"><csymbol cd="ambiguous" id="S6.SS1.p4.1.m1.4.5.2.1.cmml" xref="S6.SS1.p4.1.m1.4.5.2">subscript</csymbol><ci id="S6.SS1.p4.1.m1.4.5.2.2.cmml" xref="S6.SS1.p4.1.m1.4.5.2.2">𝑣</ci><ci id="S6.SS1.p4.1.m1.4.5.2.3.cmml" xref="S6.SS1.p4.1.m1.4.5.2.3">goal</ci></apply><list id="S6.SS1.p4.1.m1.4.5.3.1.cmml" xref="S6.SS1.p4.1.m1.4.5.3.2"><cn id="S6.SS1.p4.1.m1.1.1.cmml" type="float" xref="S6.SS1.p4.1.m1.1.1">0.2</cn><cn id="S6.SS1.p4.1.m1.2.2.cmml" type="float" xref="S6.SS1.p4.1.m1.2.2">0.4</cn><cn id="S6.SS1.p4.1.m1.3.3.cmml" type="float" xref="S6.SS1.p4.1.m1.3.3">0.6</cn><cn id="S6.SS1.p4.1.m1.4.4.cmml" type="float" xref="S6.SS1.p4.1.m1.4.4">0.8</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p4.1.m1.4c">v_{\mathrm{goal}}=[0.2,0.4,0.6,0.8]</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p4.1.m1.4d">italic_v start_POSTSUBSCRIPT roman_goal end_POSTSUBSCRIPT = [ 0.2 , 0.4 , 0.6 , 0.8 ]</annotation></semantics></math>, <math alttext="\omega_{\mathrm{goal}}=[-1.0,-0.5,0,0.5,1.0]" class="ltx_Math" display="inline" id="S6.SS1.p4.2.m2.5"><semantics id="S6.SS1.p4.2.m2.5a"><mrow id="S6.SS1.p4.2.m2.5.5" xref="S6.SS1.p4.2.m2.5.5.cmml"><msub id="S6.SS1.p4.2.m2.5.5.4" xref="S6.SS1.p4.2.m2.5.5.4.cmml"><mi id="S6.SS1.p4.2.m2.5.5.4.2" xref="S6.SS1.p4.2.m2.5.5.4.2.cmml">ω</mi><mi id="S6.SS1.p4.2.m2.5.5.4.3" xref="S6.SS1.p4.2.m2.5.5.4.3.cmml">goal</mi></msub><mo id="S6.SS1.p4.2.m2.5.5.3" xref="S6.SS1.p4.2.m2.5.5.3.cmml">=</mo><mrow id="S6.SS1.p4.2.m2.5.5.2.2" xref="S6.SS1.p4.2.m2.5.5.2.3.cmml"><mo id="S6.SS1.p4.2.m2.5.5.2.2.3" stretchy="false" xref="S6.SS1.p4.2.m2.5.5.2.3.cmml">[</mo><mrow id="S6.SS1.p4.2.m2.4.4.1.1.1" xref="S6.SS1.p4.2.m2.4.4.1.1.1.cmml"><mo id="S6.SS1.p4.2.m2.4.4.1.1.1a" xref="S6.SS1.p4.2.m2.4.4.1.1.1.cmml">−</mo><mn id="S6.SS1.p4.2.m2.4.4.1.1.1.2" xref="S6.SS1.p4.2.m2.4.4.1.1.1.2.cmml">1.0</mn></mrow><mo id="S6.SS1.p4.2.m2.5.5.2.2.4" xref="S6.SS1.p4.2.m2.5.5.2.3.cmml">,</mo><mrow id="S6.SS1.p4.2.m2.5.5.2.2.2" xref="S6.SS1.p4.2.m2.5.5.2.2.2.cmml"><mo id="S6.SS1.p4.2.m2.5.5.2.2.2a" xref="S6.SS1.p4.2.m2.5.5.2.2.2.cmml">−</mo><mn id="S6.SS1.p4.2.m2.5.5.2.2.2.2" xref="S6.SS1.p4.2.m2.5.5.2.2.2.2.cmml">0.5</mn></mrow><mo id="S6.SS1.p4.2.m2.5.5.2.2.5" xref="S6.SS1.p4.2.m2.5.5.2.3.cmml">,</mo><mn id="S6.SS1.p4.2.m2.1.1" xref="S6.SS1.p4.2.m2.1.1.cmml">0</mn><mo id="S6.SS1.p4.2.m2.5.5.2.2.6" xref="S6.SS1.p4.2.m2.5.5.2.3.cmml">,</mo><mn id="S6.SS1.p4.2.m2.2.2" xref="S6.SS1.p4.2.m2.2.2.cmml">0.5</mn><mo id="S6.SS1.p4.2.m2.5.5.2.2.7" xref="S6.SS1.p4.2.m2.5.5.2.3.cmml">,</mo><mn id="S6.SS1.p4.2.m2.3.3" xref="S6.SS1.p4.2.m2.3.3.cmml">1.0</mn><mo id="S6.SS1.p4.2.m2.5.5.2.2.8" stretchy="false" xref="S6.SS1.p4.2.m2.5.5.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p4.2.m2.5b"><apply id="S6.SS1.p4.2.m2.5.5.cmml" xref="S6.SS1.p4.2.m2.5.5"><eq id="S6.SS1.p4.2.m2.5.5.3.cmml" xref="S6.SS1.p4.2.m2.5.5.3"></eq><apply id="S6.SS1.p4.2.m2.5.5.4.cmml" xref="S6.SS1.p4.2.m2.5.5.4"><csymbol cd="ambiguous" id="S6.SS1.p4.2.m2.5.5.4.1.cmml" xref="S6.SS1.p4.2.m2.5.5.4">subscript</csymbol><ci id="S6.SS1.p4.2.m2.5.5.4.2.cmml" xref="S6.SS1.p4.2.m2.5.5.4.2">𝜔</ci><ci id="S6.SS1.p4.2.m2.5.5.4.3.cmml" xref="S6.SS1.p4.2.m2.5.5.4.3">goal</ci></apply><list id="S6.SS1.p4.2.m2.5.5.2.3.cmml" xref="S6.SS1.p4.2.m2.5.5.2.2"><apply id="S6.SS1.p4.2.m2.4.4.1.1.1.cmml" xref="S6.SS1.p4.2.m2.4.4.1.1.1"><minus id="S6.SS1.p4.2.m2.4.4.1.1.1.1.cmml" xref="S6.SS1.p4.2.m2.4.4.1.1.1"></minus><cn id="S6.SS1.p4.2.m2.4.4.1.1.1.2.cmml" type="float" xref="S6.SS1.p4.2.m2.4.4.1.1.1.2">1.0</cn></apply><apply id="S6.SS1.p4.2.m2.5.5.2.2.2.cmml" xref="S6.SS1.p4.2.m2.5.5.2.2.2"><minus id="S6.SS1.p4.2.m2.5.5.2.2.2.1.cmml" xref="S6.SS1.p4.2.m2.5.5.2.2.2"></minus><cn id="S6.SS1.p4.2.m2.5.5.2.2.2.2.cmml" type="float" xref="S6.SS1.p4.2.m2.5.5.2.2.2.2">0.5</cn></apply><cn id="S6.SS1.p4.2.m2.1.1.cmml" type="integer" xref="S6.SS1.p4.2.m2.1.1">0</cn><cn id="S6.SS1.p4.2.m2.2.2.cmml" type="float" xref="S6.SS1.p4.2.m2.2.2">0.5</cn><cn id="S6.SS1.p4.2.m2.3.3.cmml" type="float" xref="S6.SS1.p4.2.m2.3.3">1.0</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p4.2.m2.5c">\omega_{\mathrm{goal}}=[-1.0,-0.5,0,0.5,1.0]</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p4.2.m2.5d">italic_ω start_POSTSUBSCRIPT roman_goal end_POSTSUBSCRIPT = [ - 1.0 , - 0.5 , 0 , 0.5 , 1.0 ]</annotation></semantics></math>, and <math alttext="\alpha_{\mathrm{goal}}=[-20,-10,0,10,20]." class="ltx_Math" display="inline" id="S6.SS1.p4.3.m3.4"><semantics id="S6.SS1.p4.3.m3.4a"><mrow id="S6.SS1.p4.3.m3.4.4.1" xref="S6.SS1.p4.3.m3.4.4.1.1.cmml"><mrow id="S6.SS1.p4.3.m3.4.4.1.1" xref="S6.SS1.p4.3.m3.4.4.1.1.cmml"><msub id="S6.SS1.p4.3.m3.4.4.1.1.4" xref="S6.SS1.p4.3.m3.4.4.1.1.4.cmml"><mi id="S6.SS1.p4.3.m3.4.4.1.1.4.2" xref="S6.SS1.p4.3.m3.4.4.1.1.4.2.cmml">α</mi><mi id="S6.SS1.p4.3.m3.4.4.1.1.4.3" xref="S6.SS1.p4.3.m3.4.4.1.1.4.3.cmml">goal</mi></msub><mo id="S6.SS1.p4.3.m3.4.4.1.1.3" xref="S6.SS1.p4.3.m3.4.4.1.1.3.cmml">=</mo><mrow id="S6.SS1.p4.3.m3.4.4.1.1.2.2" xref="S6.SS1.p4.3.m3.4.4.1.1.2.3.cmml"><mo id="S6.SS1.p4.3.m3.4.4.1.1.2.2.3" stretchy="false" xref="S6.SS1.p4.3.m3.4.4.1.1.2.3.cmml">[</mo><mrow id="S6.SS1.p4.3.m3.4.4.1.1.1.1.1" xref="S6.SS1.p4.3.m3.4.4.1.1.1.1.1.cmml"><mo id="S6.SS1.p4.3.m3.4.4.1.1.1.1.1a" xref="S6.SS1.p4.3.m3.4.4.1.1.1.1.1.cmml">−</mo><mn id="S6.SS1.p4.3.m3.4.4.1.1.1.1.1.2" xref="S6.SS1.p4.3.m3.4.4.1.1.1.1.1.2.cmml">20</mn></mrow><mo id="S6.SS1.p4.3.m3.4.4.1.1.2.2.4" xref="S6.SS1.p4.3.m3.4.4.1.1.2.3.cmml">,</mo><mrow id="S6.SS1.p4.3.m3.4.4.1.1.2.2.2" xref="S6.SS1.p4.3.m3.4.4.1.1.2.2.2.cmml"><mo id="S6.SS1.p4.3.m3.4.4.1.1.2.2.2a" xref="S6.SS1.p4.3.m3.4.4.1.1.2.2.2.cmml">−</mo><mn id="S6.SS1.p4.3.m3.4.4.1.1.2.2.2.2" xref="S6.SS1.p4.3.m3.4.4.1.1.2.2.2.2.cmml">10</mn></mrow><mo id="S6.SS1.p4.3.m3.4.4.1.1.2.2.5" xref="S6.SS1.p4.3.m3.4.4.1.1.2.3.cmml">,</mo><mn id="S6.SS1.p4.3.m3.1.1" xref="S6.SS1.p4.3.m3.1.1.cmml">0</mn><mo id="S6.SS1.p4.3.m3.4.4.1.1.2.2.6" xref="S6.SS1.p4.3.m3.4.4.1.1.2.3.cmml">,</mo><mn id="S6.SS1.p4.3.m3.2.2" xref="S6.SS1.p4.3.m3.2.2.cmml">10</mn><mo id="S6.SS1.p4.3.m3.4.4.1.1.2.2.7" xref="S6.SS1.p4.3.m3.4.4.1.1.2.3.cmml">,</mo><mn id="S6.SS1.p4.3.m3.3.3" xref="S6.SS1.p4.3.m3.3.3.cmml">20</mn><mo id="S6.SS1.p4.3.m3.4.4.1.1.2.2.8" stretchy="false" xref="S6.SS1.p4.3.m3.4.4.1.1.2.3.cmml">]</mo></mrow></mrow><mo id="S6.SS1.p4.3.m3.4.4.1.2" lspace="0em" xref="S6.SS1.p4.3.m3.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p4.3.m3.4b"><apply id="S6.SS1.p4.3.m3.4.4.1.1.cmml" xref="S6.SS1.p4.3.m3.4.4.1"><eq id="S6.SS1.p4.3.m3.4.4.1.1.3.cmml" xref="S6.SS1.p4.3.m3.4.4.1.1.3"></eq><apply id="S6.SS1.p4.3.m3.4.4.1.1.4.cmml" xref="S6.SS1.p4.3.m3.4.4.1.1.4"><csymbol cd="ambiguous" id="S6.SS1.p4.3.m3.4.4.1.1.4.1.cmml" xref="S6.SS1.p4.3.m3.4.4.1.1.4">subscript</csymbol><ci id="S6.SS1.p4.3.m3.4.4.1.1.4.2.cmml" xref="S6.SS1.p4.3.m3.4.4.1.1.4.2">𝛼</ci><ci id="S6.SS1.p4.3.m3.4.4.1.1.4.3.cmml" xref="S6.SS1.p4.3.m3.4.4.1.1.4.3">goal</ci></apply><list id="S6.SS1.p4.3.m3.4.4.1.1.2.3.cmml" xref="S6.SS1.p4.3.m3.4.4.1.1.2.2"><apply id="S6.SS1.p4.3.m3.4.4.1.1.1.1.1.cmml" xref="S6.SS1.p4.3.m3.4.4.1.1.1.1.1"><minus id="S6.SS1.p4.3.m3.4.4.1.1.1.1.1.1.cmml" xref="S6.SS1.p4.3.m3.4.4.1.1.1.1.1"></minus><cn id="S6.SS1.p4.3.m3.4.4.1.1.1.1.1.2.cmml" type="integer" xref="S6.SS1.p4.3.m3.4.4.1.1.1.1.1.2">20</cn></apply><apply id="S6.SS1.p4.3.m3.4.4.1.1.2.2.2.cmml" xref="S6.SS1.p4.3.m3.4.4.1.1.2.2.2"><minus id="S6.SS1.p4.3.m3.4.4.1.1.2.2.2.1.cmml" xref="S6.SS1.p4.3.m3.4.4.1.1.2.2.2"></minus><cn id="S6.SS1.p4.3.m3.4.4.1.1.2.2.2.2.cmml" type="integer" xref="S6.SS1.p4.3.m3.4.4.1.1.2.2.2.2">10</cn></apply><cn id="S6.SS1.p4.3.m3.1.1.cmml" type="integer" xref="S6.SS1.p4.3.m3.1.1">0</cn><cn id="S6.SS1.p4.3.m3.2.2.cmml" type="integer" xref="S6.SS1.p4.3.m3.2.2">10</cn><cn id="S6.SS1.p4.3.m3.3.3.cmml" type="integer" xref="S6.SS1.p4.3.m3.3.3">20</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p4.3.m3.4c">\alpha_{\mathrm{goal}}=[-20,-10,0,10,20].</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p4.3.m3.4d">italic_α start_POSTSUBSCRIPT roman_goal end_POSTSUBSCRIPT = [ - 20 , - 10 , 0 , 10 , 20 ] .</annotation></semantics></math> Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S6.F7" title="Figure 7 ‣ 6.1 Path Tracking Tasks ‣ 6 Results ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">7</span></a> represents the average cumulative reward for each episode under these settings, indicating that, through the learning process, the proposed method at <math alttext="H=46" class="ltx_Math" display="inline" id="S6.SS1.p4.4.m4.1"><semantics id="S6.SS1.p4.4.m4.1a"><mrow id="S6.SS1.p4.4.m4.1.1" xref="S6.SS1.p4.4.m4.1.1.cmml"><mi id="S6.SS1.p4.4.m4.1.1.2" xref="S6.SS1.p4.4.m4.1.1.2.cmml">H</mi><mo id="S6.SS1.p4.4.m4.1.1.1" xref="S6.SS1.p4.4.m4.1.1.1.cmml">=</mo><mn id="S6.SS1.p4.4.m4.1.1.3" xref="S6.SS1.p4.4.m4.1.1.3.cmml">46</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p4.4.m4.1b"><apply id="S6.SS1.p4.4.m4.1.1.cmml" xref="S6.SS1.p4.4.m4.1.1"><eq id="S6.SS1.p4.4.m4.1.1.1.cmml" xref="S6.SS1.p4.4.m4.1.1.1"></eq><ci id="S6.SS1.p4.4.m4.1.1.2.cmml" xref="S6.SS1.p4.4.m4.1.1.2">𝐻</ci><cn id="S6.SS1.p4.4.m4.1.1.3.cmml" type="integer" xref="S6.SS1.p4.4.m4.1.1.3">46</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p4.4.m4.1c">H=46</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p4.4.m4.1d">italic_H = 46</annotation></semantics></math> exhibits performance comparable to the MPC at <math alttext="H=80" class="ltx_Math" display="inline" id="S6.SS1.p4.5.m5.1"><semantics id="S6.SS1.p4.5.m5.1a"><mrow id="S6.SS1.p4.5.m5.1.1" xref="S6.SS1.p4.5.m5.1.1.cmml"><mi id="S6.SS1.p4.5.m5.1.1.2" xref="S6.SS1.p4.5.m5.1.1.2.cmml">H</mi><mo id="S6.SS1.p4.5.m5.1.1.1" xref="S6.SS1.p4.5.m5.1.1.1.cmml">=</mo><mn id="S6.SS1.p4.5.m5.1.1.3" xref="S6.SS1.p4.5.m5.1.1.3.cmml">80</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p4.5.m5.1b"><apply id="S6.SS1.p4.5.m5.1.1.cmml" xref="S6.SS1.p4.5.m5.1.1"><eq id="S6.SS1.p4.5.m5.1.1.1.cmml" xref="S6.SS1.p4.5.m5.1.1.1"></eq><ci id="S6.SS1.p4.5.m5.1.1.2.cmml" xref="S6.SS1.p4.5.m5.1.1.2">𝐻</ci><cn id="S6.SS1.p4.5.m5.1.1.3.cmml" type="integer" xref="S6.SS1.p4.5.m5.1.1.3">80</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p4.5.m5.1c">H=80</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p4.5.m5.1d">italic_H = 80</annotation></semantics></math>, thus successfully learning the terminal values for a diverse range of goal variables.
The motions obtained through this process are shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S6.F7" title="Figure 7 ‣ 6.1 Path Tracking Tasks ‣ 6 Results ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">7</span></a>. The figure displays Diablo at intervals of <math alttext="2\ [$\mathrm{s}$]" class="ltx_Math" display="inline" id="S6.SS1.p4.6.m6.2"><semantics id="S6.SS1.p4.6.m6.2a"><mrow id="S6.SS1.p4.6.m6.2.3" xref="S6.SS1.p4.6.m6.2.3.cmml"><mn id="S6.SS1.p4.6.m6.2.3.2" xref="S6.SS1.p4.6.m6.2.3.2.cmml">2</mn><mo id="S6.SS1.p4.6.m6.2.3.1" lspace="0.500em" xref="S6.SS1.p4.6.m6.2.3.1.cmml">⁢</mo><mrow id="S6.SS1.p4.6.m6.2.3.3.2" xref="S6.SS1.p4.6.m6.2.3.3.1.cmml"><mo id="S6.SS1.p4.6.m6.2.3.3.2.1" stretchy="false" xref="S6.SS1.p4.6.m6.2.3.3.1.1.cmml">[</mo><mi id="S6.SS1.p4.6.m6.2.2" mathvariant="normal" xref="S6.SS1.p4.6.m6.2.2.cmml">s</mi><mo id="S6.SS1.p4.6.m6.2.3.3.2.2" stretchy="false" xref="S6.SS1.p4.6.m6.2.3.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p4.6.m6.2b"><apply id="S6.SS1.p4.6.m6.2.3.cmml" xref="S6.SS1.p4.6.m6.2.3"><times id="S6.SS1.p4.6.m6.2.3.1.cmml" xref="S6.SS1.p4.6.m6.2.3.1"></times><cn id="S6.SS1.p4.6.m6.2.3.2.cmml" type="integer" xref="S6.SS1.p4.6.m6.2.3.2">2</cn><apply id="S6.SS1.p4.6.m6.2.3.3.1.cmml" xref="S6.SS1.p4.6.m6.2.3.3.2"><csymbol cd="latexml" id="S6.SS1.p4.6.m6.2.3.3.1.1.cmml" xref="S6.SS1.p4.6.m6.2.3.3.2.1">delimited-[]</csymbol><ci id="S6.SS1.p4.6.m6.2.2.cmml" xref="S6.SS1.p4.6.m6.2.2">s</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p4.6.m6.2c">2\ [$\mathrm{s}$]</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p4.6.m6.2d">2 [ roman_s ]</annotation></semantics></math>.
Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S6.F7" title="Figure 7 ‣ 6.1 Path Tracking Tasks ‣ 6 Results ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">7</span></a> shows that the motions generated follow the figure-eight trajectory while adjusting for the slope. Similar to the previous section, the maximum computation time for the control framework was measured over 10 episodes, with a maximum computation time of <math alttext="8.7\,[$\mathrm{m}\mathrm{s}$]" class="ltx_Math" display="inline" id="S6.SS1.p4.7.m7.2"><semantics id="S6.SS1.p4.7.m7.2a"><mrow id="S6.SS1.p4.7.m7.2.3" xref="S6.SS1.p4.7.m7.2.3.cmml"><mn id="S6.SS1.p4.7.m7.2.3.2" xref="S6.SS1.p4.7.m7.2.3.2.cmml">8.7</mn><mo id="S6.SS1.p4.7.m7.2.3.1" lspace="0.170em" xref="S6.SS1.p4.7.m7.2.3.1.cmml">⁢</mo><mrow id="S6.SS1.p4.7.m7.2.3.3.2" xref="S6.SS1.p4.7.m7.2.3.3.1.cmml"><mo id="S6.SS1.p4.7.m7.2.3.3.2.1" stretchy="false" xref="S6.SS1.p4.7.m7.2.3.3.1.1.cmml">[</mo><mi id="S6.SS1.p4.7.m7.2.2" xref="S6.SS1.p4.7.m7.2.2.cmml">ms</mi><mo id="S6.SS1.p4.7.m7.2.3.3.2.2" stretchy="false" xref="S6.SS1.p4.7.m7.2.3.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p4.7.m7.2b"><apply id="S6.SS1.p4.7.m7.2.3.cmml" xref="S6.SS1.p4.7.m7.2.3"><times id="S6.SS1.p4.7.m7.2.3.1.cmml" xref="S6.SS1.p4.7.m7.2.3.1"></times><cn id="S6.SS1.p4.7.m7.2.3.2.cmml" type="float" xref="S6.SS1.p4.7.m7.2.3.2">8.7</cn><apply id="S6.SS1.p4.7.m7.2.3.3.1.cmml" xref="S6.SS1.p4.7.m7.2.3.3.2"><csymbol cd="latexml" id="S6.SS1.p4.7.m7.2.3.3.1.1.cmml" xref="S6.SS1.p4.7.m7.2.3.3.2.1">delimited-[]</csymbol><ci id="S6.SS1.p4.7.m7.2.2.cmml" xref="S6.SS1.p4.7.m7.2.2">ms</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p4.7.m7.2c">8.7\,[$\mathrm{m}\mathrm{s}$]</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p4.7.m7.2d">8.7 [ roman_ms ]</annotation></semantics></math>, ensuring real-time control within the <math alttext="10\,[$\mathrm{m}\mathrm{s}$]" class="ltx_Math" display="inline" id="S6.SS1.p4.8.m8.2"><semantics id="S6.SS1.p4.8.m8.2a"><mrow id="S6.SS1.p4.8.m8.2.3" xref="S6.SS1.p4.8.m8.2.3.cmml"><mn id="S6.SS1.p4.8.m8.2.3.2" xref="S6.SS1.p4.8.m8.2.3.2.cmml">10</mn><mo id="S6.SS1.p4.8.m8.2.3.1" lspace="0.170em" xref="S6.SS1.p4.8.m8.2.3.1.cmml">⁢</mo><mrow id="S6.SS1.p4.8.m8.2.3.3.2" xref="S6.SS1.p4.8.m8.2.3.3.1.cmml"><mo id="S6.SS1.p4.8.m8.2.3.3.2.1" stretchy="false" xref="S6.SS1.p4.8.m8.2.3.3.1.1.cmml">[</mo><mi id="S6.SS1.p4.8.m8.2.2" xref="S6.SS1.p4.8.m8.2.2.cmml">ms</mi><mo id="S6.SS1.p4.8.m8.2.3.3.2.2" stretchy="false" xref="S6.SS1.p4.8.m8.2.3.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p4.8.m8.2b"><apply id="S6.SS1.p4.8.m8.2.3.cmml" xref="S6.SS1.p4.8.m8.2.3"><times id="S6.SS1.p4.8.m8.2.3.1.cmml" xref="S6.SS1.p4.8.m8.2.3.1"></times><cn id="S6.SS1.p4.8.m8.2.3.2.cmml" type="integer" xref="S6.SS1.p4.8.m8.2.3.2">10</cn><apply id="S6.SS1.p4.8.m8.2.3.3.1.cmml" xref="S6.SS1.p4.8.m8.2.3.3.2"><csymbol cd="latexml" id="S6.SS1.p4.8.m8.2.3.3.1.1.cmml" xref="S6.SS1.p4.8.m8.2.3.3.2.1">delimited-[]</csymbol><ci id="S6.SS1.p4.8.m8.2.2.cmml" xref="S6.SS1.p4.8.m8.2.2">ms</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p4.8.m8.2c">10\,[$\mathrm{m}\mathrm{s}$]</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p4.8.m8.2d">10 [ roman_ms ]</annotation></semantics></math> control cycle.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.2 </span>Evaluation of Real-Timeness and Control Performance</h3>
<div class="ltx_para" id="S6.SS2.p1">
<p class="ltx_p" id="S6.SS2.p1.1">Section <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S6.SS1" title="6.1 Path Tracking Tasks ‣ 6 Results ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">6.1</span></a> demonstrates that the proposed method can generate a variety of motions. In this section, we compare the real-timeness and control performance of the proposed method against several alternative methods. The task involves evaluating the motion of ascending and descending a slope while maintaining constant translational and angular velocities on terrain, as shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S5.F4" title="Figure 4 ‣ 5.2 Path Tracking Tasks ‣ 5 Experiments ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">4</span></a>b.</p>
</div>
<div class="ltx_para" id="S6.SS2.p2">
<p class="ltx_p" id="S6.SS2.p2.5">The goal linear velocity <math alttext="v_{\text{goal}}" class="ltx_Math" display="inline" id="S6.SS2.p2.1.m1.1"><semantics id="S6.SS2.p2.1.m1.1a"><msub id="S6.SS2.p2.1.m1.1.1" xref="S6.SS2.p2.1.m1.1.1.cmml"><mi id="S6.SS2.p2.1.m1.1.1.2" xref="S6.SS2.p2.1.m1.1.1.2.cmml">v</mi><mtext id="S6.SS2.p2.1.m1.1.1.3" xref="S6.SS2.p2.1.m1.1.1.3a.cmml">goal</mtext></msub><annotation-xml encoding="MathML-Content" id="S6.SS2.p2.1.m1.1b"><apply id="S6.SS2.p2.1.m1.1.1.cmml" xref="S6.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S6.SS2.p2.1.m1.1.1.1.cmml" xref="S6.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S6.SS2.p2.1.m1.1.1.2.cmml" xref="S6.SS2.p2.1.m1.1.1.2">𝑣</ci><ci id="S6.SS2.p2.1.m1.1.1.3a.cmml" xref="S6.SS2.p2.1.m1.1.1.3"><mtext id="S6.SS2.p2.1.m1.1.1.3.cmml" mathsize="70%" xref="S6.SS2.p2.1.m1.1.1.3">goal</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p2.1.m1.1c">v_{\text{goal}}</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p2.1.m1.1d">italic_v start_POSTSUBSCRIPT goal end_POSTSUBSCRIPT</annotation></semantics></math> is set at <math alttext="1\ [$\mathrm{m}\mathrm{/}\mathrm{s}$]" class="ltx_Math" display="inline" id="S6.SS2.p2.2.m2.1"><semantics id="S6.SS2.p2.2.m2.1a"><mrow id="S6.SS2.p2.2.m2.1.2" xref="S6.SS2.p2.2.m2.1.2.cmml"><mn id="S6.SS2.p2.2.m2.1.2.2" xref="S6.SS2.p2.2.m2.1.2.2.cmml">1</mn><mo id="S6.SS2.p2.2.m2.1.2.1" lspace="0.500em" xref="S6.SS2.p2.2.m2.1.2.1.cmml">⁢</mo><mrow id="S6.SS2.p2.2.m2.1.2.3.2" xref="S6.SS2.p2.2.m2.1.2.3.1.cmml"><mo id="S6.SS2.p2.2.m2.1.2.3.2.1" stretchy="false" xref="S6.SS2.p2.2.m2.1.2.3.1.1.cmml">[</mo><mrow id="S6.SS2.p2.2.m2.1.1" xref="S6.SS2.p2.2.m2.1.1.cmml"><mi id="S6.SS2.p2.2.m2.1.1.2" mathvariant="normal" xref="S6.SS2.p2.2.m2.1.1.2.cmml">m</mi><mo id="S6.SS2.p2.2.m2.1.1.1" xref="S6.SS2.p2.2.m2.1.1.1.cmml">/</mo><mi id="S6.SS2.p2.2.m2.1.1.3" mathvariant="normal" xref="S6.SS2.p2.2.m2.1.1.3.cmml">s</mi></mrow><mo id="S6.SS2.p2.2.m2.1.2.3.2.2" stretchy="false" xref="S6.SS2.p2.2.m2.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p2.2.m2.1b"><apply id="S6.SS2.p2.2.m2.1.2.cmml" xref="S6.SS2.p2.2.m2.1.2"><times id="S6.SS2.p2.2.m2.1.2.1.cmml" xref="S6.SS2.p2.2.m2.1.2.1"></times><cn id="S6.SS2.p2.2.m2.1.2.2.cmml" type="integer" xref="S6.SS2.p2.2.m2.1.2.2">1</cn><apply id="S6.SS2.p2.2.m2.1.2.3.1.cmml" xref="S6.SS2.p2.2.m2.1.2.3.2"><csymbol cd="latexml" id="S6.SS2.p2.2.m2.1.2.3.1.1.cmml" xref="S6.SS2.p2.2.m2.1.2.3.2.1">delimited-[]</csymbol><apply id="S6.SS2.p2.2.m2.1.1.cmml" xref="S6.SS2.p2.2.m2.1.1"><divide id="S6.SS2.p2.2.m2.1.1.1.cmml" xref="S6.SS2.p2.2.m2.1.1.1"></divide><ci id="S6.SS2.p2.2.m2.1.1.2.cmml" xref="S6.SS2.p2.2.m2.1.1.2">m</ci><ci id="S6.SS2.p2.2.m2.1.1.3.cmml" xref="S6.SS2.p2.2.m2.1.1.3">s</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p2.2.m2.1c">1\ [$\mathrm{m}\mathrm{/}\mathrm{s}$]</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p2.2.m2.1d">1 [ roman_m / roman_s ]</annotation></semantics></math>, the angular velocity <math alttext="\omega_{\text{goal}}" class="ltx_Math" display="inline" id="S6.SS2.p2.3.m3.1"><semantics id="S6.SS2.p2.3.m3.1a"><msub id="S6.SS2.p2.3.m3.1.1" xref="S6.SS2.p2.3.m3.1.1.cmml"><mi id="S6.SS2.p2.3.m3.1.1.2" xref="S6.SS2.p2.3.m3.1.1.2.cmml">ω</mi><mtext id="S6.SS2.p2.3.m3.1.1.3" xref="S6.SS2.p2.3.m3.1.1.3a.cmml">goal</mtext></msub><annotation-xml encoding="MathML-Content" id="S6.SS2.p2.3.m3.1b"><apply id="S6.SS2.p2.3.m3.1.1.cmml" xref="S6.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S6.SS2.p2.3.m3.1.1.1.cmml" xref="S6.SS2.p2.3.m3.1.1">subscript</csymbol><ci id="S6.SS2.p2.3.m3.1.1.2.cmml" xref="S6.SS2.p2.3.m3.1.1.2">𝜔</ci><ci id="S6.SS2.p2.3.m3.1.1.3a.cmml" xref="S6.SS2.p2.3.m3.1.1.3"><mtext id="S6.SS2.p2.3.m3.1.1.3.cmml" mathsize="70%" xref="S6.SS2.p2.3.m3.1.1.3">goal</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p2.3.m3.1c">\omega_{\text{goal}}</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p2.3.m3.1d">italic_ω start_POSTSUBSCRIPT goal end_POSTSUBSCRIPT</annotation></semantics></math> at <math alttext="0\ [$\mathrm{r}\mathrm{a}\mathrm{d}\mathrm{/}\mathrm{s}$]" class="ltx_Math" display="inline" id="S6.SS2.p2.4.m4.1"><semantics id="S6.SS2.p2.4.m4.1a"><mrow id="S6.SS2.p2.4.m4.1.2" xref="S6.SS2.p2.4.m4.1.2.cmml"><mn id="S6.SS2.p2.4.m4.1.2.2" xref="S6.SS2.p2.4.m4.1.2.2.cmml">0</mn><mo id="S6.SS2.p2.4.m4.1.2.1" lspace="0.500em" xref="S6.SS2.p2.4.m4.1.2.1.cmml">⁢</mo><mrow id="S6.SS2.p2.4.m4.1.2.3.2" xref="S6.SS2.p2.4.m4.1.2.3.1.cmml"><mo id="S6.SS2.p2.4.m4.1.2.3.2.1" stretchy="false" xref="S6.SS2.p2.4.m4.1.2.3.1.1.cmml">[</mo><mrow id="S6.SS2.p2.4.m4.1.1" xref="S6.SS2.p2.4.m4.1.1.cmml"><mi id="S6.SS2.p2.4.m4.1.1.2" xref="S6.SS2.p2.4.m4.1.1.2.cmml">rad</mi><mo id="S6.SS2.p2.4.m4.1.1.1" xref="S6.SS2.p2.4.m4.1.1.1.cmml">/</mo><mi id="S6.SS2.p2.4.m4.1.1.3" mathvariant="normal" xref="S6.SS2.p2.4.m4.1.1.3.cmml">s</mi></mrow><mo id="S6.SS2.p2.4.m4.1.2.3.2.2" stretchy="false" xref="S6.SS2.p2.4.m4.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p2.4.m4.1b"><apply id="S6.SS2.p2.4.m4.1.2.cmml" xref="S6.SS2.p2.4.m4.1.2"><times id="S6.SS2.p2.4.m4.1.2.1.cmml" xref="S6.SS2.p2.4.m4.1.2.1"></times><cn id="S6.SS2.p2.4.m4.1.2.2.cmml" type="integer" xref="S6.SS2.p2.4.m4.1.2.2">0</cn><apply id="S6.SS2.p2.4.m4.1.2.3.1.cmml" xref="S6.SS2.p2.4.m4.1.2.3.2"><csymbol cd="latexml" id="S6.SS2.p2.4.m4.1.2.3.1.1.cmml" xref="S6.SS2.p2.4.m4.1.2.3.2.1">delimited-[]</csymbol><apply id="S6.SS2.p2.4.m4.1.1.cmml" xref="S6.SS2.p2.4.m4.1.1"><divide id="S6.SS2.p2.4.m4.1.1.1.cmml" xref="S6.SS2.p2.4.m4.1.1.1"></divide><ci id="S6.SS2.p2.4.m4.1.1.2.cmml" xref="S6.SS2.p2.4.m4.1.1.2">rad</ci><ci id="S6.SS2.p2.4.m4.1.1.3.cmml" xref="S6.SS2.p2.4.m4.1.1.3">s</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p2.4.m4.1c">0\ [$\mathrm{r}\mathrm{a}\mathrm{d}\mathrm{/}\mathrm{s}$]</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p2.4.m4.1d">0 [ roman_rad / roman_s ]</annotation></semantics></math>, and the angles of both the uphill and downhill slopes are set to <math alttext="15^{\circ}" class="ltx_Math" display="inline" id="S6.SS2.p2.5.m5.1"><semantics id="S6.SS2.p2.5.m5.1a"><msup id="S6.SS2.p2.5.m5.1.1" xref="S6.SS2.p2.5.m5.1.1.cmml"><mn id="S6.SS2.p2.5.m5.1.1.2" xref="S6.SS2.p2.5.m5.1.1.2.cmml">15</mn><mo id="S6.SS2.p2.5.m5.1.1.3" xref="S6.SS2.p2.5.m5.1.1.3.cmml">∘</mo></msup><annotation-xml encoding="MathML-Content" id="S6.SS2.p2.5.m5.1b"><apply id="S6.SS2.p2.5.m5.1.1.cmml" xref="S6.SS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S6.SS2.p2.5.m5.1.1.1.cmml" xref="S6.SS2.p2.5.m5.1.1">superscript</csymbol><cn id="S6.SS2.p2.5.m5.1.1.2.cmml" type="integer" xref="S6.SS2.p2.5.m5.1.1.2">15</cn><compose id="S6.SS2.p2.5.m5.1.1.3.cmml" xref="S6.SS2.p2.5.m5.1.1.3"></compose></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p2.5.m5.1c">15^{\circ}</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p2.5.m5.1d">15 start_POSTSUPERSCRIPT ∘ end_POSTSUPERSCRIPT</annotation></semantics></math>. The comparison involves the following four methods:</p>
<ul class="ltx_itemize" id="S6.I1">
<li class="ltx_item" id="S6.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S6.I1.i1.p1">
<p class="ltx_p" id="S6.I1.i1.p1.1">Proposed method - Proposed (SHDR)</p>
</div>
</li>
<li class="ltx_item" id="S6.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S6.I1.i2.p1">
<p class="ltx_p" id="S6.I1.i2.p1.1">Proposed method (without slope environment randomization) - Proposed (SH)</p>
</div>
</li>
<li class="ltx_item" id="S6.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="S6.I1.i3.p1">
<p class="ltx_p" id="S6.I1.i3.p1.1">MPC with a short horizon - MPC (SH)</p>
</div>
</li>
<li class="ltx_item" id="S6.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">4.</span>
<div class="ltx_para" id="S6.I1.i4.p1">
<p class="ltx_p" id="S6.I1.i4.p1.1">MPC with a long horizon - MPC (LH)</p>
</div>
</li>
</ul>
<p class="ltx_p" id="S6.SS2.p2.6">Here, SH represents Short Horizon, LH represents Long Horizon, and DR represents Domain Randomization. The conditions of MPPI for each method are shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S6.T2" title="Table 2 ‣ 6.2 Evaluation of Real-Timeness and Control Performance ‣ 6 Results ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">2</span></a>, where the internal model timestep for MPC calculations is set to <math alttext="2.5\,[$\mathrm{m}\mathrm{s}$]" class="ltx_Math" display="inline" id="S6.SS2.p2.6.m1.2"><semantics id="S6.SS2.p2.6.m1.2a"><mrow id="S6.SS2.p2.6.m1.2.3" xref="S6.SS2.p2.6.m1.2.3.cmml"><mn id="S6.SS2.p2.6.m1.2.3.2" xref="S6.SS2.p2.6.m1.2.3.2.cmml">2.5</mn><mo id="S6.SS2.p2.6.m1.2.3.1" lspace="0.170em" xref="S6.SS2.p2.6.m1.2.3.1.cmml">⁢</mo><mrow id="S6.SS2.p2.6.m1.2.3.3.2" xref="S6.SS2.p2.6.m1.2.3.3.1.cmml"><mo id="S6.SS2.p2.6.m1.2.3.3.2.1" stretchy="false" xref="S6.SS2.p2.6.m1.2.3.3.1.1.cmml">[</mo><mi id="S6.SS2.p2.6.m1.2.2" xref="S6.SS2.p2.6.m1.2.2.cmml">ms</mi><mo id="S6.SS2.p2.6.m1.2.3.3.2.2" stretchy="false" xref="S6.SS2.p2.6.m1.2.3.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p2.6.m1.2b"><apply id="S6.SS2.p2.6.m1.2.3.cmml" xref="S6.SS2.p2.6.m1.2.3"><times id="S6.SS2.p2.6.m1.2.3.1.cmml" xref="S6.SS2.p2.6.m1.2.3.1"></times><cn id="S6.SS2.p2.6.m1.2.3.2.cmml" type="float" xref="S6.SS2.p2.6.m1.2.3.2">2.5</cn><apply id="S6.SS2.p2.6.m1.2.3.3.1.cmml" xref="S6.SS2.p2.6.m1.2.3.3.2"><csymbol cd="latexml" id="S6.SS2.p2.6.m1.2.3.3.1.1.cmml" xref="S6.SS2.p2.6.m1.2.3.3.2.1">delimited-[]</csymbol><ci id="S6.SS2.p2.6.m1.2.2.cmml" xref="S6.SS2.p2.6.m1.2.2">ms</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p2.6.m1.2c">2.5\,[$\mathrm{m}\mathrm{s}$]</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p2.6.m1.2d">2.5 [ roman_ms ]</annotation></semantics></math>.
The results comparing real-time performance and control performance are shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S6.F8" title="Figure 8 ‣ 6.2 Evaluation of Real-Timeness and Control Performance ‣ 6 Results ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">8</span></a>.</p>
</div>
<figure class="ltx_table" id="S6.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S6.T2.3.1.1" style="font-size:90%;">Table 2</span>: </span><span class="ltx_text" id="S6.T2.4.2" style="font-size:90%;">MPPI parameters for each method</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S6.T2.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S6.T2.1.1">
<th class="ltx_td ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" id="S6.T2.1.1.2"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S6.T2.1.1.1">Horizon <math alttext="H\,[$\mathrm{s}$]" class="ltx_Math" display="inline" id="S6.T2.1.1.1.m1.2"><semantics id="S6.T2.1.1.1.m1.2a"><mrow id="S6.T2.1.1.1.m1.2.3" xref="S6.T2.1.1.1.m1.2.3.cmml"><mi id="S6.T2.1.1.1.m1.2.3.2" xref="S6.T2.1.1.1.m1.2.3.2.cmml">H</mi><mo id="S6.T2.1.1.1.m1.2.3.1" lspace="0.170em" xref="S6.T2.1.1.1.m1.2.3.1.cmml">⁢</mo><mrow id="S6.T2.1.1.1.m1.2.3.3.2" xref="S6.T2.1.1.1.m1.2.3.3.1.cmml"><mo id="S6.T2.1.1.1.m1.2.3.3.2.1" stretchy="false" xref="S6.T2.1.1.1.m1.2.3.3.1.1.cmml">[</mo><mi id="S6.T2.1.1.1.m1.2.2" mathvariant="normal" xref="S6.T2.1.1.1.m1.2.2.cmml">s</mi><mo id="S6.T2.1.1.1.m1.2.3.3.2.2" stretchy="false" xref="S6.T2.1.1.1.m1.2.3.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.T2.1.1.1.m1.2b"><apply id="S6.T2.1.1.1.m1.2.3.cmml" xref="S6.T2.1.1.1.m1.2.3"><times id="S6.T2.1.1.1.m1.2.3.1.cmml" xref="S6.T2.1.1.1.m1.2.3.1"></times><ci id="S6.T2.1.1.1.m1.2.3.2.cmml" xref="S6.T2.1.1.1.m1.2.3.2">𝐻</ci><apply id="S6.T2.1.1.1.m1.2.3.3.1.cmml" xref="S6.T2.1.1.1.m1.2.3.3.2"><csymbol cd="latexml" id="S6.T2.1.1.1.m1.2.3.3.1.1.cmml" xref="S6.T2.1.1.1.m1.2.3.3.2.1">delimited-[]</csymbol><ci id="S6.T2.1.1.1.m1.2.2.cmml" xref="S6.T2.1.1.1.m1.2.2">s</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.1.1.1.m1.2c">H\,[$\mathrm{s}$]</annotation><annotation encoding="application/x-llamapun" id="S6.T2.1.1.1.m1.2d">italic_H [ roman_s ]</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S6.T2.1.1.3">Rollouts</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T2.1.2.1">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S6.T2.1.2.1.1">Proposed (DR)</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T2.1.2.1.2">0.4</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T2.1.2.1.3">30</td>
</tr>
<tr class="ltx_tr" id="S6.T2.1.3.2">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S6.T2.1.3.2.1">Proposed (without DR)</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T2.1.3.2.2">0.4</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T2.1.3.2.3">30</td>
</tr>
<tr class="ltx_tr" id="S6.T2.1.4.3">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S6.T2.1.4.3.1">MPC (SH)</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T2.1.4.3.2">0.4</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T2.1.4.3.3">30</td>
</tr>
<tr class="ltx_tr" id="S6.T2.1.5.4">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S6.T2.1.5.4.1">MPC (LH)</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S6.T2.1.5.4.2">0.6</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S6.T2.1.5.4.3">35</td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_figure" id="S6.F8"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="415" id="S6.F8.g1" src="x13.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F8.8.4.1" style="font-size:90%;">Figure 8</span>: </span><span class="ltx_text" id="S6.F8.6.3" style="font-size:90%;">The left figure shows the MPC computation time relative to the control cycle. The right figure shows the normalized cumulative cost (lower is better), representing control performance.
MPC(SH) and MPC(LH) represent standard MPC without terminal value learning, with horizons <math alttext="H=0.4\,[$\mathrm{s}$]" class="ltx_Math" display="inline" id="S6.F8.4.1.m1.2"><semantics id="S6.F8.4.1.m1.2b"><mrow id="S6.F8.4.1.m1.2.3" xref="S6.F8.4.1.m1.2.3.cmml"><mi id="S6.F8.4.1.m1.2.3.2" xref="S6.F8.4.1.m1.2.3.2.cmml">H</mi><mo id="S6.F8.4.1.m1.2.3.1" xref="S6.F8.4.1.m1.2.3.1.cmml">=</mo><mrow id="S6.F8.4.1.m1.2.3.3" xref="S6.F8.4.1.m1.2.3.3.cmml"><mn id="S6.F8.4.1.m1.2.3.3.2" xref="S6.F8.4.1.m1.2.3.3.2.cmml">0.4</mn><mo id="S6.F8.4.1.m1.2.3.3.1" lspace="0.170em" xref="S6.F8.4.1.m1.2.3.3.1.cmml">⁢</mo><mrow id="S6.F8.4.1.m1.2.3.3.3.2" xref="S6.F8.4.1.m1.2.3.3.3.1.cmml"><mo id="S6.F8.4.1.m1.2.3.3.3.2.1" stretchy="false" xref="S6.F8.4.1.m1.2.3.3.3.1.1.cmml">[</mo><mi id="S6.F8.4.1.m1.2.2" mathvariant="normal" xref="S6.F8.4.1.m1.2.2.cmml">s</mi><mo id="S6.F8.4.1.m1.2.3.3.3.2.2" stretchy="false" xref="S6.F8.4.1.m1.2.3.3.3.1.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.F8.4.1.m1.2c"><apply id="S6.F8.4.1.m1.2.3.cmml" xref="S6.F8.4.1.m1.2.3"><eq id="S6.F8.4.1.m1.2.3.1.cmml" xref="S6.F8.4.1.m1.2.3.1"></eq><ci id="S6.F8.4.1.m1.2.3.2.cmml" xref="S6.F8.4.1.m1.2.3.2">𝐻</ci><apply id="S6.F8.4.1.m1.2.3.3.cmml" xref="S6.F8.4.1.m1.2.3.3"><times id="S6.F8.4.1.m1.2.3.3.1.cmml" xref="S6.F8.4.1.m1.2.3.3.1"></times><cn id="S6.F8.4.1.m1.2.3.3.2.cmml" type="float" xref="S6.F8.4.1.m1.2.3.3.2">0.4</cn><apply id="S6.F8.4.1.m1.2.3.3.3.1.cmml" xref="S6.F8.4.1.m1.2.3.3.3.2"><csymbol cd="latexml" id="S6.F8.4.1.m1.2.3.3.3.1.1.cmml" xref="S6.F8.4.1.m1.2.3.3.3.2.1">delimited-[]</csymbol><ci id="S6.F8.4.1.m1.2.2.cmml" xref="S6.F8.4.1.m1.2.2">s</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F8.4.1.m1.2d">H=0.4\,[$\mathrm{s}$]</annotation><annotation encoding="application/x-llamapun" id="S6.F8.4.1.m1.2e">italic_H = 0.4 [ roman_s ]</annotation></semantics></math> and <math alttext="H=0.6\,[$\mathrm{s}$]" class="ltx_Math" display="inline" id="S6.F8.5.2.m2.2"><semantics id="S6.F8.5.2.m2.2b"><mrow id="S6.F8.5.2.m2.2.3" xref="S6.F8.5.2.m2.2.3.cmml"><mi id="S6.F8.5.2.m2.2.3.2" xref="S6.F8.5.2.m2.2.3.2.cmml">H</mi><mo id="S6.F8.5.2.m2.2.3.1" xref="S6.F8.5.2.m2.2.3.1.cmml">=</mo><mrow id="S6.F8.5.2.m2.2.3.3" xref="S6.F8.5.2.m2.2.3.3.cmml"><mn id="S6.F8.5.2.m2.2.3.3.2" xref="S6.F8.5.2.m2.2.3.3.2.cmml">0.6</mn><mo id="S6.F8.5.2.m2.2.3.3.1" lspace="0.170em" xref="S6.F8.5.2.m2.2.3.3.1.cmml">⁢</mo><mrow id="S6.F8.5.2.m2.2.3.3.3.2" xref="S6.F8.5.2.m2.2.3.3.3.1.cmml"><mo id="S6.F8.5.2.m2.2.3.3.3.2.1" stretchy="false" xref="S6.F8.5.2.m2.2.3.3.3.1.1.cmml">[</mo><mi id="S6.F8.5.2.m2.2.2" mathvariant="normal" xref="S6.F8.5.2.m2.2.2.cmml">s</mi><mo id="S6.F8.5.2.m2.2.3.3.3.2.2" stretchy="false" xref="S6.F8.5.2.m2.2.3.3.3.1.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.F8.5.2.m2.2c"><apply id="S6.F8.5.2.m2.2.3.cmml" xref="S6.F8.5.2.m2.2.3"><eq id="S6.F8.5.2.m2.2.3.1.cmml" xref="S6.F8.5.2.m2.2.3.1"></eq><ci id="S6.F8.5.2.m2.2.3.2.cmml" xref="S6.F8.5.2.m2.2.3.2">𝐻</ci><apply id="S6.F8.5.2.m2.2.3.3.cmml" xref="S6.F8.5.2.m2.2.3.3"><times id="S6.F8.5.2.m2.2.3.3.1.cmml" xref="S6.F8.5.2.m2.2.3.3.1"></times><cn id="S6.F8.5.2.m2.2.3.3.2.cmml" type="float" xref="S6.F8.5.2.m2.2.3.3.2">0.6</cn><apply id="S6.F8.5.2.m2.2.3.3.3.1.cmml" xref="S6.F8.5.2.m2.2.3.3.3.2"><csymbol cd="latexml" id="S6.F8.5.2.m2.2.3.3.3.1.1.cmml" xref="S6.F8.5.2.m2.2.3.3.3.2.1">delimited-[]</csymbol><ci id="S6.F8.5.2.m2.2.2.cmml" xref="S6.F8.5.2.m2.2.2">s</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F8.5.2.m2.2d">H=0.6\,[$\mathrm{s}$]</annotation><annotation encoding="application/x-llamapun" id="S6.F8.5.2.m2.2e">italic_H = 0.6 [ roman_s ]</annotation></semantics></math>, respectively. MPC(SH) completes computation within the control cycle but results in robot falls and high cumulative costs. MPC(LH) achieves stable performance with low cumulative costs but fails to complete within the control cycle, making it impractical.
MPC(SH) and MPC(SHDR) both use goal-conditioned terminal value learning, with MPC(SHDR) applying domain randomization for uneven terrain. Both have a horizon of <math alttext="H=0.4\,[$\mathrm{s}$]" class="ltx_Math" display="inline" id="S6.F8.6.3.m3.2"><semantics id="S6.F8.6.3.m3.2b"><mrow id="S6.F8.6.3.m3.2.3" xref="S6.F8.6.3.m3.2.3.cmml"><mi id="S6.F8.6.3.m3.2.3.2" xref="S6.F8.6.3.m3.2.3.2.cmml">H</mi><mo id="S6.F8.6.3.m3.2.3.1" xref="S6.F8.6.3.m3.2.3.1.cmml">=</mo><mrow id="S6.F8.6.3.m3.2.3.3" xref="S6.F8.6.3.m3.2.3.3.cmml"><mn id="S6.F8.6.3.m3.2.3.3.2" xref="S6.F8.6.3.m3.2.3.3.2.cmml">0.4</mn><mo id="S6.F8.6.3.m3.2.3.3.1" lspace="0.170em" xref="S6.F8.6.3.m3.2.3.3.1.cmml">⁢</mo><mrow id="S6.F8.6.3.m3.2.3.3.3.2" xref="S6.F8.6.3.m3.2.3.3.3.1.cmml"><mo id="S6.F8.6.3.m3.2.3.3.3.2.1" stretchy="false" xref="S6.F8.6.3.m3.2.3.3.3.1.1.cmml">[</mo><mi id="S6.F8.6.3.m3.2.2" mathvariant="normal" xref="S6.F8.6.3.m3.2.2.cmml">s</mi><mo id="S6.F8.6.3.m3.2.3.3.3.2.2" stretchy="false" xref="S6.F8.6.3.m3.2.3.3.3.1.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.F8.6.3.m3.2c"><apply id="S6.F8.6.3.m3.2.3.cmml" xref="S6.F8.6.3.m3.2.3"><eq id="S6.F8.6.3.m3.2.3.1.cmml" xref="S6.F8.6.3.m3.2.3.1"></eq><ci id="S6.F8.6.3.m3.2.3.2.cmml" xref="S6.F8.6.3.m3.2.3.2">𝐻</ci><apply id="S6.F8.6.3.m3.2.3.3.cmml" xref="S6.F8.6.3.m3.2.3.3"><times id="S6.F8.6.3.m3.2.3.3.1.cmml" xref="S6.F8.6.3.m3.2.3.3.1"></times><cn id="S6.F8.6.3.m3.2.3.3.2.cmml" type="float" xref="S6.F8.6.3.m3.2.3.3.2">0.4</cn><apply id="S6.F8.6.3.m3.2.3.3.3.1.cmml" xref="S6.F8.6.3.m3.2.3.3.3.2"><csymbol cd="latexml" id="S6.F8.6.3.m3.2.3.3.3.1.1.cmml" xref="S6.F8.6.3.m3.2.3.3.3.2.1">delimited-[]</csymbol><ci id="S6.F8.6.3.m3.2.2.cmml" xref="S6.F8.6.3.m3.2.2">s</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F8.6.3.m3.2d">H=0.4\,[$\mathrm{s}$]</annotation><annotation encoding="application/x-llamapun" id="S6.F8.6.3.m3.2e">italic_H = 0.4 [ roman_s ]</annotation></semantics></math>. From the figures, MPC(SH) reduces cumulative costs through terminal value learning, which were previously high due to falls when not using terminal value. In MPC(SHDR), the robust terminal value learned via domain randomization prevents falls during terrain transitions, which occurred several times in MPC(SH). MPC(SHDR) achieves performance close to MPC(LH) without any falls and completes computations within the control cycle, confirming the effectiveness of the proposed method.</span></figcaption>
</figure>
<div class="ltx_para" id="S6.SS2.p3">
<p class="ltx_p" id="S6.SS2.p3.2">The left figure relates to real-time performance, showing the maximum control computation time relative to the <math alttext="10\,[$\mathrm{m}\mathrm{s}$]" class="ltx_Math" display="inline" id="S6.SS2.p3.1.m1.2"><semantics id="S6.SS2.p3.1.m1.2a"><mrow id="S6.SS2.p3.1.m1.2.3" xref="S6.SS2.p3.1.m1.2.3.cmml"><mn id="S6.SS2.p3.1.m1.2.3.2" xref="S6.SS2.p3.1.m1.2.3.2.cmml">10</mn><mo id="S6.SS2.p3.1.m1.2.3.1" lspace="0.170em" xref="S6.SS2.p3.1.m1.2.3.1.cmml">⁢</mo><mrow id="S6.SS2.p3.1.m1.2.3.3.2" xref="S6.SS2.p3.1.m1.2.3.3.1.cmml"><mo id="S6.SS2.p3.1.m1.2.3.3.2.1" stretchy="false" xref="S6.SS2.p3.1.m1.2.3.3.1.1.cmml">[</mo><mi id="S6.SS2.p3.1.m1.2.2" xref="S6.SS2.p3.1.m1.2.2.cmml">ms</mi><mo id="S6.SS2.p3.1.m1.2.3.3.2.2" stretchy="false" xref="S6.SS2.p3.1.m1.2.3.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p3.1.m1.2b"><apply id="S6.SS2.p3.1.m1.2.3.cmml" xref="S6.SS2.p3.1.m1.2.3"><times id="S6.SS2.p3.1.m1.2.3.1.cmml" xref="S6.SS2.p3.1.m1.2.3.1"></times><cn id="S6.SS2.p3.1.m1.2.3.2.cmml" type="integer" xref="S6.SS2.p3.1.m1.2.3.2">10</cn><apply id="S6.SS2.p3.1.m1.2.3.3.1.cmml" xref="S6.SS2.p3.1.m1.2.3.3.2"><csymbol cd="latexml" id="S6.SS2.p3.1.m1.2.3.3.1.1.cmml" xref="S6.SS2.p3.1.m1.2.3.3.2.1">delimited-[]</csymbol><ci id="S6.SS2.p3.1.m1.2.2.cmml" xref="S6.SS2.p3.1.m1.2.2">ms</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p3.1.m1.2c">10\,[$\mathrm{m}\mathrm{s}$]</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p3.1.m1.2d">10 [ roman_ms ]</annotation></semantics></math> control cycle. The right figure represents the normalized cumulative cost of the task. These results are based on 10 trials each.
From the figure, it’s evident that while the MPC with a short horizon can compute in real-time, it incurs a significantly higher cumulative cost, failing to achieve the control objective of traversing the terrain due to falling while ascending the slope. The MPC with a long horizon reduces the cumulative cost but breaks real-time constraints, making it unsuitable for practical applications.
By setting the control cycle to <math alttext="13\,[$\mathrm{m}\mathrm{s}$]" class="ltx_Math" display="inline" id="S6.SS2.p3.2.m2.2"><semantics id="S6.SS2.p3.2.m2.2a"><mrow id="S6.SS2.p3.2.m2.2.3" xref="S6.SS2.p3.2.m2.2.3.cmml"><mn id="S6.SS2.p3.2.m2.2.3.2" xref="S6.SS2.p3.2.m2.2.3.2.cmml">13</mn><mo id="S6.SS2.p3.2.m2.2.3.1" lspace="0.170em" xref="S6.SS2.p3.2.m2.2.3.1.cmml">⁢</mo><mrow id="S6.SS2.p3.2.m2.2.3.3.2" xref="S6.SS2.p3.2.m2.2.3.3.1.cmml"><mo id="S6.SS2.p3.2.m2.2.3.3.2.1" stretchy="false" xref="S6.SS2.p3.2.m2.2.3.3.1.1.cmml">[</mo><mi id="S6.SS2.p3.2.m2.2.2" xref="S6.SS2.p3.2.m2.2.2.cmml">ms</mi><mo id="S6.SS2.p3.2.m2.2.3.3.2.2" stretchy="false" xref="S6.SS2.p3.2.m2.2.3.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p3.2.m2.2b"><apply id="S6.SS2.p3.2.m2.2.3.cmml" xref="S6.SS2.p3.2.m2.2.3"><times id="S6.SS2.p3.2.m2.2.3.1.cmml" xref="S6.SS2.p3.2.m2.2.3.1"></times><cn id="S6.SS2.p3.2.m2.2.3.2.cmml" type="integer" xref="S6.SS2.p3.2.m2.2.3.2">13</cn><apply id="S6.SS2.p3.2.m2.2.3.3.1.cmml" xref="S6.SS2.p3.2.m2.2.3.3.2"><csymbol cd="latexml" id="S6.SS2.p3.2.m2.2.3.3.1.1.cmml" xref="S6.SS2.p3.2.m2.2.3.3.2.1">delimited-[]</csymbol><ci id="S6.SS2.p3.2.m2.2.2.cmml" xref="S6.SS2.p3.2.m2.2.2">ms</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p3.2.m2.2c">13\,[$\mathrm{m}\mathrm{s}$]</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p3.2.m2.2d">13 [ roman_ms ]</annotation></semantics></math>, computations can be completed within the time limit. However, this slows down the feedback control cycle, increasing the likelihood of the robot falling and the task failure rate. For robots with low balance stability, keeping the control cycle as short as possible is especially important.
On the other hand, the proposed method manages to keep the cumulative cost low while maintaining real-time performance, successfully traversing the prepared terrain by dynamically adjusting goal variables based on the slope angle, thus achieving the control objective. Without environment randomization, the robot falls at the transitions of slopes, resulting in higher costs. In fact, falls were observed in 6 out of 10 trials.
However, when domain randomization was applied, the robot did not fall even once in 10 trials. These results highlight the importance of learning terminal values through environment randomization. Hence, it is confirmed that the proposed method can generate a variety of motions while maintaining real-time performance.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.3 </span>Evaluation of Robustness</h3>
<div class="ltx_para" id="S6.SS3.p1">
<p class="ltx_p" id="S6.SS3.p1.2">In this section, we verify the robustness of the controller developed through the proposed method by considering scenarios where disturbances are applied during descent on a slope, using the same terrain and conditions described in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S6.SS2" title="6.2 Evaluation of Real-Timeness and Control Performance ‣ 6 Results ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">6.2</span></a>. The value function learned in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S6.SS2" title="6.2 Evaluation of Real-Timeness and Control Performance ‣ 6 Results ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">6.2</span></a> is utilized with the proposed method. The behavior of the robot when a force of <math alttext="20\,[$\mathrm{N}$]" class="ltx_Math" display="inline" id="S6.SS3.p1.1.m1.2"><semantics id="S6.SS3.p1.1.m1.2a"><mrow id="S6.SS3.p1.1.m1.2.3" xref="S6.SS3.p1.1.m1.2.3.cmml"><mn id="S6.SS3.p1.1.m1.2.3.2" xref="S6.SS3.p1.1.m1.2.3.2.cmml">20</mn><mo id="S6.SS3.p1.1.m1.2.3.1" lspace="0.170em" xref="S6.SS3.p1.1.m1.2.3.1.cmml">⁢</mo><mrow id="S6.SS3.p1.1.m1.2.3.3.2" xref="S6.SS3.p1.1.m1.2.3.3.1.cmml"><mo id="S6.SS3.p1.1.m1.2.3.3.2.1" stretchy="false" xref="S6.SS3.p1.1.m1.2.3.3.1.1.cmml">[</mo><mi id="S6.SS3.p1.1.m1.2.2" mathvariant="normal" xref="S6.SS3.p1.1.m1.2.2.cmml">N</mi><mo id="S6.SS3.p1.1.m1.2.3.3.2.2" stretchy="false" xref="S6.SS3.p1.1.m1.2.3.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.p1.1.m1.2b"><apply id="S6.SS3.p1.1.m1.2.3.cmml" xref="S6.SS3.p1.1.m1.2.3"><times id="S6.SS3.p1.1.m1.2.3.1.cmml" xref="S6.SS3.p1.1.m1.2.3.1"></times><cn id="S6.SS3.p1.1.m1.2.3.2.cmml" type="integer" xref="S6.SS3.p1.1.m1.2.3.2">20</cn><apply id="S6.SS3.p1.1.m1.2.3.3.1.cmml" xref="S6.SS3.p1.1.m1.2.3.3.2"><csymbol cd="latexml" id="S6.SS3.p1.1.m1.2.3.3.1.1.cmml" xref="S6.SS3.p1.1.m1.2.3.3.2.1">delimited-[]</csymbol><ci id="S6.SS3.p1.1.m1.2.2.cmml" xref="S6.SS3.p1.1.m1.2.2">N</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p1.1.m1.2c">20\,[$\mathrm{N}$]</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.p1.1.m1.2d">20 [ roman_N ]</annotation></semantics></math> and <math alttext="40\,[$\mathrm{N}$]" class="ltx_Math" display="inline" id="S6.SS3.p1.2.m2.2"><semantics id="S6.SS3.p1.2.m2.2a"><mrow id="S6.SS3.p1.2.m2.2.3" xref="S6.SS3.p1.2.m2.2.3.cmml"><mn id="S6.SS3.p1.2.m2.2.3.2" xref="S6.SS3.p1.2.m2.2.3.2.cmml">40</mn><mo id="S6.SS3.p1.2.m2.2.3.1" lspace="0.170em" xref="S6.SS3.p1.2.m2.2.3.1.cmml">⁢</mo><mrow id="S6.SS3.p1.2.m2.2.3.3.2" xref="S6.SS3.p1.2.m2.2.3.3.1.cmml"><mo id="S6.SS3.p1.2.m2.2.3.3.2.1" stretchy="false" xref="S6.SS3.p1.2.m2.2.3.3.1.1.cmml">[</mo><mi id="S6.SS3.p1.2.m2.2.2" mathvariant="normal" xref="S6.SS3.p1.2.m2.2.2.cmml">N</mi><mo id="S6.SS3.p1.2.m2.2.3.3.2.2" stretchy="false" xref="S6.SS3.p1.2.m2.2.3.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.p1.2.m2.2b"><apply id="S6.SS3.p1.2.m2.2.3.cmml" xref="S6.SS3.p1.2.m2.2.3"><times id="S6.SS3.p1.2.m2.2.3.1.cmml" xref="S6.SS3.p1.2.m2.2.3.1"></times><cn id="S6.SS3.p1.2.m2.2.3.2.cmml" type="integer" xref="S6.SS3.p1.2.m2.2.3.2">40</cn><apply id="S6.SS3.p1.2.m2.2.3.3.1.cmml" xref="S6.SS3.p1.2.m2.2.3.3.2"><csymbol cd="latexml" id="S6.SS3.p1.2.m2.2.3.3.1.1.cmml" xref="S6.SS3.p1.2.m2.2.3.3.2.1">delimited-[]</csymbol><ci id="S6.SS3.p1.2.m2.2.2.cmml" xref="S6.SS3.p1.2.m2.2.2">N</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p1.2.m2.2c">40\,[$\mathrm{N}$]</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.p1.2.m2.2d">40 [ roman_N ]</annotation></semantics></math> is applied to the base link for 2 seconds during descent is illustrated in Figs. <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S6.F9" title="Figure 9 ‣ 6.3 Evaluation of Robustness ‣ 6 Results ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">9</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S6.F9" title="Figure 9 ‣ 6.3 Evaluation of Robustness ‣ 6 Results ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">9</span></a>, respectively.</p>
</div>
<div class="ltx_para" id="S6.SS3.p2">
<p class="ltx_p" id="S6.SS3.p2.5">When a force of <math alttext="20\,[$\mathrm{N}$]" class="ltx_Math" display="inline" id="S6.SS3.p2.1.m1.2"><semantics id="S6.SS3.p2.1.m1.2a"><mrow id="S6.SS3.p2.1.m1.2.3" xref="S6.SS3.p2.1.m1.2.3.cmml"><mn id="S6.SS3.p2.1.m1.2.3.2" xref="S6.SS3.p2.1.m1.2.3.2.cmml">20</mn><mo id="S6.SS3.p2.1.m1.2.3.1" lspace="0.170em" xref="S6.SS3.p2.1.m1.2.3.1.cmml">⁢</mo><mrow id="S6.SS3.p2.1.m1.2.3.3.2" xref="S6.SS3.p2.1.m1.2.3.3.1.cmml"><mo id="S6.SS3.p2.1.m1.2.3.3.2.1" stretchy="false" xref="S6.SS3.p2.1.m1.2.3.3.1.1.cmml">[</mo><mi id="S6.SS3.p2.1.m1.2.2" mathvariant="normal" xref="S6.SS3.p2.1.m1.2.2.cmml">N</mi><mo id="S6.SS3.p2.1.m1.2.3.3.2.2" stretchy="false" xref="S6.SS3.p2.1.m1.2.3.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.p2.1.m1.2b"><apply id="S6.SS3.p2.1.m1.2.3.cmml" xref="S6.SS3.p2.1.m1.2.3"><times id="S6.SS3.p2.1.m1.2.3.1.cmml" xref="S6.SS3.p2.1.m1.2.3.1"></times><cn id="S6.SS3.p2.1.m1.2.3.2.cmml" type="integer" xref="S6.SS3.p2.1.m1.2.3.2">20</cn><apply id="S6.SS3.p2.1.m1.2.3.3.1.cmml" xref="S6.SS3.p2.1.m1.2.3.3.2"><csymbol cd="latexml" id="S6.SS3.p2.1.m1.2.3.3.1.1.cmml" xref="S6.SS3.p2.1.m1.2.3.3.2.1">delimited-[]</csymbol><ci id="S6.SS3.p2.1.m1.2.2.cmml" xref="S6.SS3.p2.1.m1.2.2">N</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p2.1.m1.2c">20\,[$\mathrm{N}$]</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.p2.1.m1.2d">20 [ roman_N ]</annotation></semantics></math> is applied, the robot descends while maintaining its base link posture despite being pushed. With a force of <math alttext="40\,[$\mathrm{N}$]" class="ltx_Math" display="inline" id="S6.SS3.p2.2.m2.2"><semantics id="S6.SS3.p2.2.m2.2a"><mrow id="S6.SS3.p2.2.m2.2.3" xref="S6.SS3.p2.2.m2.2.3.cmml"><mn id="S6.SS3.p2.2.m2.2.3.2" xref="S6.SS3.p2.2.m2.2.3.2.cmml">40</mn><mo id="S6.SS3.p2.2.m2.2.3.1" lspace="0.170em" xref="S6.SS3.p2.2.m2.2.3.1.cmml">⁢</mo><mrow id="S6.SS3.p2.2.m2.2.3.3.2" xref="S6.SS3.p2.2.m2.2.3.3.1.cmml"><mo id="S6.SS3.p2.2.m2.2.3.3.2.1" stretchy="false" xref="S6.SS3.p2.2.m2.2.3.3.1.1.cmml">[</mo><mi id="S6.SS3.p2.2.m2.2.2" mathvariant="normal" xref="S6.SS3.p2.2.m2.2.2.cmml">N</mi><mo id="S6.SS3.p2.2.m2.2.3.3.2.2" stretchy="false" xref="S6.SS3.p2.2.m2.2.3.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.p2.2.m2.2b"><apply id="S6.SS3.p2.2.m2.2.3.cmml" xref="S6.SS3.p2.2.m2.2.3"><times id="S6.SS3.p2.2.m2.2.3.1.cmml" xref="S6.SS3.p2.2.m2.2.3.1"></times><cn id="S6.SS3.p2.2.m2.2.3.2.cmml" type="integer" xref="S6.SS3.p2.2.m2.2.3.2">40</cn><apply id="S6.SS3.p2.2.m2.2.3.3.1.cmml" xref="S6.SS3.p2.2.m2.2.3.3.2"><csymbol cd="latexml" id="S6.SS3.p2.2.m2.2.3.3.1.1.cmml" xref="S6.SS3.p2.2.m2.2.3.3.2.1">delimited-[]</csymbol><ci id="S6.SS3.p2.2.m2.2.2.cmml" xref="S6.SS3.p2.2.m2.2.2">N</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p2.2.m2.2c">40\,[$\mathrm{N}$]</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.p2.2.m2.2d">40 [ roman_N ]</annotation></semantics></math>, although the robot is pushed and rotates, it regains its posture and continues its motion. By applying the terminal value learned for a horizon of <math alttext="H=0.4\,[$\mathrm{s}$]" class="ltx_Math" display="inline" id="S6.SS3.p2.3.m3.2"><semantics id="S6.SS3.p2.3.m3.2a"><mrow id="S6.SS3.p2.3.m3.2.3" xref="S6.SS3.p2.3.m3.2.3.cmml"><mi id="S6.SS3.p2.3.m3.2.3.2" xref="S6.SS3.p2.3.m3.2.3.2.cmml">H</mi><mo id="S6.SS3.p2.3.m3.2.3.1" xref="S6.SS3.p2.3.m3.2.3.1.cmml">=</mo><mrow id="S6.SS3.p2.3.m3.2.3.3" xref="S6.SS3.p2.3.m3.2.3.3.cmml"><mn id="S6.SS3.p2.3.m3.2.3.3.2" xref="S6.SS3.p2.3.m3.2.3.3.2.cmml">0.4</mn><mo id="S6.SS3.p2.3.m3.2.3.3.1" lspace="0.170em" xref="S6.SS3.p2.3.m3.2.3.3.1.cmml">⁢</mo><mrow id="S6.SS3.p2.3.m3.2.3.3.3.2" xref="S6.SS3.p2.3.m3.2.3.3.3.1.cmml"><mo id="S6.SS3.p2.3.m3.2.3.3.3.2.1" stretchy="false" xref="S6.SS3.p2.3.m3.2.3.3.3.1.1.cmml">[</mo><mi id="S6.SS3.p2.3.m3.2.2" mathvariant="normal" xref="S6.SS3.p2.3.m3.2.2.cmml">s</mi><mo id="S6.SS3.p2.3.m3.2.3.3.3.2.2" stretchy="false" xref="S6.SS3.p2.3.m3.2.3.3.3.1.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.p2.3.m3.2b"><apply id="S6.SS3.p2.3.m3.2.3.cmml" xref="S6.SS3.p2.3.m3.2.3"><eq id="S6.SS3.p2.3.m3.2.3.1.cmml" xref="S6.SS3.p2.3.m3.2.3.1"></eq><ci id="S6.SS3.p2.3.m3.2.3.2.cmml" xref="S6.SS3.p2.3.m3.2.3.2">𝐻</ci><apply id="S6.SS3.p2.3.m3.2.3.3.cmml" xref="S6.SS3.p2.3.m3.2.3.3"><times id="S6.SS3.p2.3.m3.2.3.3.1.cmml" xref="S6.SS3.p2.3.m3.2.3.3.1"></times><cn id="S6.SS3.p2.3.m3.2.3.3.2.cmml" type="float" xref="S6.SS3.p2.3.m3.2.3.3.2">0.4</cn><apply id="S6.SS3.p2.3.m3.2.3.3.3.1.cmml" xref="S6.SS3.p2.3.m3.2.3.3.3.2"><csymbol cd="latexml" id="S6.SS3.p2.3.m3.2.3.3.3.1.1.cmml" xref="S6.SS3.p2.3.m3.2.3.3.3.2.1">delimited-[]</csymbol><ci id="S6.SS3.p2.3.m3.2.2.cmml" xref="S6.SS3.p2.3.m3.2.2">s</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p2.3.m3.2c">H=0.4\,[$\mathrm{s}$]</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.p2.3.m3.2d">italic_H = 0.4 [ roman_s ]</annotation></semantics></math> to an MPC with a horizon of <math alttext="H=0.24\,[$\mathrm{s}$]" class="ltx_Math" display="inline" id="S6.SS3.p2.4.m4.2"><semantics id="S6.SS3.p2.4.m4.2a"><mrow id="S6.SS3.p2.4.m4.2.3" xref="S6.SS3.p2.4.m4.2.3.cmml"><mi id="S6.SS3.p2.4.m4.2.3.2" xref="S6.SS3.p2.4.m4.2.3.2.cmml">H</mi><mo id="S6.SS3.p2.4.m4.2.3.1" xref="S6.SS3.p2.4.m4.2.3.1.cmml">=</mo><mrow id="S6.SS3.p2.4.m4.2.3.3" xref="S6.SS3.p2.4.m4.2.3.3.cmml"><mn id="S6.SS3.p2.4.m4.2.3.3.2" xref="S6.SS3.p2.4.m4.2.3.3.2.cmml">0.24</mn><mo id="S6.SS3.p2.4.m4.2.3.3.1" lspace="0.170em" xref="S6.SS3.p2.4.m4.2.3.3.1.cmml">⁢</mo><mrow id="S6.SS3.p2.4.m4.2.3.3.3.2" xref="S6.SS3.p2.4.m4.2.3.3.3.1.cmml"><mo id="S6.SS3.p2.4.m4.2.3.3.3.2.1" stretchy="false" xref="S6.SS3.p2.4.m4.2.3.3.3.1.1.cmml">[</mo><mi id="S6.SS3.p2.4.m4.2.2" mathvariant="normal" xref="S6.SS3.p2.4.m4.2.2.cmml">s</mi><mo id="S6.SS3.p2.4.m4.2.3.3.3.2.2" stretchy="false" xref="S6.SS3.p2.4.m4.2.3.3.3.1.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.p2.4.m4.2b"><apply id="S6.SS3.p2.4.m4.2.3.cmml" xref="S6.SS3.p2.4.m4.2.3"><eq id="S6.SS3.p2.4.m4.2.3.1.cmml" xref="S6.SS3.p2.4.m4.2.3.1"></eq><ci id="S6.SS3.p2.4.m4.2.3.2.cmml" xref="S6.SS3.p2.4.m4.2.3.2">𝐻</ci><apply id="S6.SS3.p2.4.m4.2.3.3.cmml" xref="S6.SS3.p2.4.m4.2.3.3"><times id="S6.SS3.p2.4.m4.2.3.3.1.cmml" xref="S6.SS3.p2.4.m4.2.3.3.1"></times><cn id="S6.SS3.p2.4.m4.2.3.3.2.cmml" type="float" xref="S6.SS3.p2.4.m4.2.3.3.2">0.24</cn><apply id="S6.SS3.p2.4.m4.2.3.3.3.1.cmml" xref="S6.SS3.p2.4.m4.2.3.3.3.2"><csymbol cd="latexml" id="S6.SS3.p2.4.m4.2.3.3.3.1.1.cmml" xref="S6.SS3.p2.4.m4.2.3.3.3.2.1">delimited-[]</csymbol><ci id="S6.SS3.p2.4.m4.2.2.cmml" xref="S6.SS3.p2.4.m4.2.2">s</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p2.4.m4.2c">H=0.24\,[$\mathrm{s}$]</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.p2.4.m4.2d">italic_H = 0.24 [ roman_s ]</annotation></semantics></math>, we employ a method more reliant on the terminal value, similar to reinforcement learning. The result of applying a force of <math alttext="40\,[$\mathrm{N}$]" class="ltx_Math" display="inline" id="S6.SS3.p2.5.m5.2"><semantics id="S6.SS3.p2.5.m5.2a"><mrow id="S6.SS3.p2.5.m5.2.3" xref="S6.SS3.p2.5.m5.2.3.cmml"><mn id="S6.SS3.p2.5.m5.2.3.2" xref="S6.SS3.p2.5.m5.2.3.2.cmml">40</mn><mo id="S6.SS3.p2.5.m5.2.3.1" lspace="0.170em" xref="S6.SS3.p2.5.m5.2.3.1.cmml">⁢</mo><mrow id="S6.SS3.p2.5.m5.2.3.3.2" xref="S6.SS3.p2.5.m5.2.3.3.1.cmml"><mo id="S6.SS3.p2.5.m5.2.3.3.2.1" stretchy="false" xref="S6.SS3.p2.5.m5.2.3.3.1.1.cmml">[</mo><mi id="S6.SS3.p2.5.m5.2.2" mathvariant="normal" xref="S6.SS3.p2.5.m5.2.2.cmml">N</mi><mo id="S6.SS3.p2.5.m5.2.3.3.2.2" stretchy="false" xref="S6.SS3.p2.5.m5.2.3.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.p2.5.m5.2b"><apply id="S6.SS3.p2.5.m5.2.3.cmml" xref="S6.SS3.p2.5.m5.2.3"><times id="S6.SS3.p2.5.m5.2.3.1.cmml" xref="S6.SS3.p2.5.m5.2.3.1"></times><cn id="S6.SS3.p2.5.m5.2.3.2.cmml" type="integer" xref="S6.SS3.p2.5.m5.2.3.2">40</cn><apply id="S6.SS3.p2.5.m5.2.3.3.1.cmml" xref="S6.SS3.p2.5.m5.2.3.3.2"><csymbol cd="latexml" id="S6.SS3.p2.5.m5.2.3.3.1.1.cmml" xref="S6.SS3.p2.5.m5.2.3.3.2.1">delimited-[]</csymbol><ci id="S6.SS3.p2.5.m5.2.2.cmml" xref="S6.SS3.p2.5.m5.2.2">N</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p2.5.m5.2c">40\,[$\mathrm{N}$]</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.p2.5.m5.2d">40 [ roman_N ]</annotation></semantics></math> in this scenario is shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S6.F9" title="Figure 9 ‣ 6.3 Evaluation of Robustness ‣ 6 Results ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">9</span></a>. From the figure, it is observed that the robot falls and is unable to return to constant velocity movement after rotation.</p>
</div>
<figure class="ltx_figure" id="S6.F9">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" id="S6.F9.5" style="width:429.3pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="282" id="S6.F9.1.g1" src="x14.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F9.5.5.3.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S6.F9.5.4.2" style="font-size:90%;">Behavior when a force of <math alttext="20\,$\mathrm{N}$" class="ltx_Math" display="inline" id="S6.F9.4.3.1.m1.1"><semantics id="S6.F9.4.3.1.m1.1b"><mrow id="S6.F9.4.3.1.m1.1.2" xref="S6.F9.4.3.1.m1.1.2.cmml"><mn id="S6.F9.4.3.1.m1.1.2.2" xref="S6.F9.4.3.1.m1.1.2.2.cmml">20</mn><mo id="S6.F9.4.3.1.m1.1.2.1" lspace="0.170em" xref="S6.F9.4.3.1.m1.1.2.1.cmml">⁢</mo><mi id="S6.F9.4.3.1.m1.1.2.3" mathvariant="normal" xref="S6.F9.4.3.1.m1.1.2.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="S6.F9.4.3.1.m1.1c"><apply id="S6.F9.4.3.1.m1.1.2.cmml" xref="S6.F9.4.3.1.m1.1.2"><times id="S6.F9.4.3.1.m1.1.2.1.cmml" xref="S6.F9.4.3.1.m1.1.2.1"></times><cn id="S6.F9.4.3.1.m1.1.2.2.cmml" type="integer" xref="S6.F9.4.3.1.m1.1.2.2">20</cn><ci id="S6.F9.4.3.1.m1.1.2.3.cmml" xref="S6.F9.4.3.1.m1.1.2.3">N</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F9.4.3.1.m1.1d">20\,$\mathrm{N}$</annotation><annotation encoding="application/x-llamapun" id="S6.F9.4.3.1.m1.1e">20 roman_N</annotation></semantics></math> is applied (<math alttext="H=0.4\,$\mathrm{s}$" class="ltx_Math" display="inline" id="S6.F9.5.4.2.m2.1"><semantics id="S6.F9.5.4.2.m2.1b"><mrow id="S6.F9.5.4.2.m2.1.2" xref="S6.F9.5.4.2.m2.1.2.cmml"><mi id="S6.F9.5.4.2.m2.1.2.2" xref="S6.F9.5.4.2.m2.1.2.2.cmml">H</mi><mo id="S6.F9.5.4.2.m2.1.2.1" xref="S6.F9.5.4.2.m2.1.2.1.cmml">=</mo><mrow id="S6.F9.5.4.2.m2.1.2.3" xref="S6.F9.5.4.2.m2.1.2.3.cmml"><mn id="S6.F9.5.4.2.m2.1.2.3.2" xref="S6.F9.5.4.2.m2.1.2.3.2.cmml">0.4</mn><mo id="S6.F9.5.4.2.m2.1.2.3.1" lspace="0.170em" xref="S6.F9.5.4.2.m2.1.2.3.1.cmml">⁢</mo><mi id="S6.F9.5.4.2.m2.1.2.3.3" mathvariant="normal" xref="S6.F9.5.4.2.m2.1.2.3.3.cmml">s</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.F9.5.4.2.m2.1c"><apply id="S6.F9.5.4.2.m2.1.2.cmml" xref="S6.F9.5.4.2.m2.1.2"><eq id="S6.F9.5.4.2.m2.1.2.1.cmml" xref="S6.F9.5.4.2.m2.1.2.1"></eq><ci id="S6.F9.5.4.2.m2.1.2.2.cmml" xref="S6.F9.5.4.2.m2.1.2.2">𝐻</ci><apply id="S6.F9.5.4.2.m2.1.2.3.cmml" xref="S6.F9.5.4.2.m2.1.2.3"><times id="S6.F9.5.4.2.m2.1.2.3.1.cmml" xref="S6.F9.5.4.2.m2.1.2.3.1"></times><cn id="S6.F9.5.4.2.m2.1.2.3.2.cmml" type="float" xref="S6.F9.5.4.2.m2.1.2.3.2">0.4</cn><ci id="S6.F9.5.4.2.m2.1.2.3.3.cmml" xref="S6.F9.5.4.2.m2.1.2.3.3">s</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F9.5.4.2.m2.1d">H=0.4\,$\mathrm{s}$</annotation><annotation encoding="application/x-llamapun" id="S6.F9.5.4.2.m2.1e">italic_H = 0.4 roman_s</annotation></semantics></math>) - Despite being pushed by force, the robot maintains its posture and achieves constant velocity movement.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" id="S6.F9.10" style="width:429.3pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="274" id="S6.F9.6.g1" src="x15.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F9.10.5.3.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S6.F9.10.4.2" style="font-size:90%;">Behavior when a force of <math alttext="40\,$\mathrm{N}$" class="ltx_Math" display="inline" id="S6.F9.9.3.1.m1.1"><semantics id="S6.F9.9.3.1.m1.1b"><mrow id="S6.F9.9.3.1.m1.1.2" xref="S6.F9.9.3.1.m1.1.2.cmml"><mn id="S6.F9.9.3.1.m1.1.2.2" xref="S6.F9.9.3.1.m1.1.2.2.cmml">40</mn><mo id="S6.F9.9.3.1.m1.1.2.1" lspace="0.170em" xref="S6.F9.9.3.1.m1.1.2.1.cmml">⁢</mo><mi id="S6.F9.9.3.1.m1.1.2.3" mathvariant="normal" xref="S6.F9.9.3.1.m1.1.2.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="S6.F9.9.3.1.m1.1c"><apply id="S6.F9.9.3.1.m1.1.2.cmml" xref="S6.F9.9.3.1.m1.1.2"><times id="S6.F9.9.3.1.m1.1.2.1.cmml" xref="S6.F9.9.3.1.m1.1.2.1"></times><cn id="S6.F9.9.3.1.m1.1.2.2.cmml" type="integer" xref="S6.F9.9.3.1.m1.1.2.2">40</cn><ci id="S6.F9.9.3.1.m1.1.2.3.cmml" xref="S6.F9.9.3.1.m1.1.2.3">N</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F9.9.3.1.m1.1d">40\,$\mathrm{N}$</annotation><annotation encoding="application/x-llamapun" id="S6.F9.9.3.1.m1.1e">40 roman_N</annotation></semantics></math> is applied (<math alttext="H=0.4\,$\mathrm{s}$" class="ltx_Math" display="inline" id="S6.F9.10.4.2.m2.1"><semantics id="S6.F9.10.4.2.m2.1b"><mrow id="S6.F9.10.4.2.m2.1.2" xref="S6.F9.10.4.2.m2.1.2.cmml"><mi id="S6.F9.10.4.2.m2.1.2.2" xref="S6.F9.10.4.2.m2.1.2.2.cmml">H</mi><mo id="S6.F9.10.4.2.m2.1.2.1" xref="S6.F9.10.4.2.m2.1.2.1.cmml">=</mo><mrow id="S6.F9.10.4.2.m2.1.2.3" xref="S6.F9.10.4.2.m2.1.2.3.cmml"><mn id="S6.F9.10.4.2.m2.1.2.3.2" xref="S6.F9.10.4.2.m2.1.2.3.2.cmml">0.4</mn><mo id="S6.F9.10.4.2.m2.1.2.3.1" lspace="0.170em" xref="S6.F9.10.4.2.m2.1.2.3.1.cmml">⁢</mo><mi id="S6.F9.10.4.2.m2.1.2.3.3" mathvariant="normal" xref="S6.F9.10.4.2.m2.1.2.3.3.cmml">s</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.F9.10.4.2.m2.1c"><apply id="S6.F9.10.4.2.m2.1.2.cmml" xref="S6.F9.10.4.2.m2.1.2"><eq id="S6.F9.10.4.2.m2.1.2.1.cmml" xref="S6.F9.10.4.2.m2.1.2.1"></eq><ci id="S6.F9.10.4.2.m2.1.2.2.cmml" xref="S6.F9.10.4.2.m2.1.2.2">𝐻</ci><apply id="S6.F9.10.4.2.m2.1.2.3.cmml" xref="S6.F9.10.4.2.m2.1.2.3"><times id="S6.F9.10.4.2.m2.1.2.3.1.cmml" xref="S6.F9.10.4.2.m2.1.2.3.1"></times><cn id="S6.F9.10.4.2.m2.1.2.3.2.cmml" type="float" xref="S6.F9.10.4.2.m2.1.2.3.2">0.4</cn><ci id="S6.F9.10.4.2.m2.1.2.3.3.cmml" xref="S6.F9.10.4.2.m2.1.2.3.3">s</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F9.10.4.2.m2.1d">H=0.4\,$\mathrm{s}$</annotation><annotation encoding="application/x-llamapun" id="S6.F9.10.4.2.m2.1e">italic_H = 0.4 roman_s</annotation></semantics></math>) - Although pushed and rotated by force, the robot subsequently returns to its posture and resumes constant velocity movement.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" id="S6.F9.15" style="width:429.3pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="293" id="S6.F9.11.g1" src="x16.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F9.15.5.3.1" style="font-size:90%;">(c)</span> </span><span class="ltx_text" id="S6.F9.15.4.2" style="font-size:90%;">Behavior when a force of <math alttext="40\,$\mathrm{N}$" class="ltx_Math" display="inline" id="S6.F9.14.3.1.m1.1"><semantics id="S6.F9.14.3.1.m1.1b"><mrow id="S6.F9.14.3.1.m1.1.2" xref="S6.F9.14.3.1.m1.1.2.cmml"><mn id="S6.F9.14.3.1.m1.1.2.2" xref="S6.F9.14.3.1.m1.1.2.2.cmml">40</mn><mo id="S6.F9.14.3.1.m1.1.2.1" lspace="0.170em" xref="S6.F9.14.3.1.m1.1.2.1.cmml">⁢</mo><mi id="S6.F9.14.3.1.m1.1.2.3" mathvariant="normal" xref="S6.F9.14.3.1.m1.1.2.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="S6.F9.14.3.1.m1.1c"><apply id="S6.F9.14.3.1.m1.1.2.cmml" xref="S6.F9.14.3.1.m1.1.2"><times id="S6.F9.14.3.1.m1.1.2.1.cmml" xref="S6.F9.14.3.1.m1.1.2.1"></times><cn id="S6.F9.14.3.1.m1.1.2.2.cmml" type="integer" xref="S6.F9.14.3.1.m1.1.2.2">40</cn><ci id="S6.F9.14.3.1.m1.1.2.3.cmml" xref="S6.F9.14.3.1.m1.1.2.3">N</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F9.14.3.1.m1.1d">40\,$\mathrm{N}$</annotation><annotation encoding="application/x-llamapun" id="S6.F9.14.3.1.m1.1e">40 roman_N</annotation></semantics></math> is applied (<math alttext="H=0.24\,$\mathrm{s}$" class="ltx_Math" display="inline" id="S6.F9.15.4.2.m2.1"><semantics id="S6.F9.15.4.2.m2.1b"><mrow id="S6.F9.15.4.2.m2.1.2" xref="S6.F9.15.4.2.m2.1.2.cmml"><mi id="S6.F9.15.4.2.m2.1.2.2" xref="S6.F9.15.4.2.m2.1.2.2.cmml">H</mi><mo id="S6.F9.15.4.2.m2.1.2.1" xref="S6.F9.15.4.2.m2.1.2.1.cmml">=</mo><mrow id="S6.F9.15.4.2.m2.1.2.3" xref="S6.F9.15.4.2.m2.1.2.3.cmml"><mn id="S6.F9.15.4.2.m2.1.2.3.2" xref="S6.F9.15.4.2.m2.1.2.3.2.cmml">0.24</mn><mo id="S6.F9.15.4.2.m2.1.2.3.1" lspace="0.170em" xref="S6.F9.15.4.2.m2.1.2.3.1.cmml">⁢</mo><mi id="S6.F9.15.4.2.m2.1.2.3.3" mathvariant="normal" xref="S6.F9.15.4.2.m2.1.2.3.3.cmml">s</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.F9.15.4.2.m2.1c"><apply id="S6.F9.15.4.2.m2.1.2.cmml" xref="S6.F9.15.4.2.m2.1.2"><eq id="S6.F9.15.4.2.m2.1.2.1.cmml" xref="S6.F9.15.4.2.m2.1.2.1"></eq><ci id="S6.F9.15.4.2.m2.1.2.2.cmml" xref="S6.F9.15.4.2.m2.1.2.2">𝐻</ci><apply id="S6.F9.15.4.2.m2.1.2.3.cmml" xref="S6.F9.15.4.2.m2.1.2.3"><times id="S6.F9.15.4.2.m2.1.2.3.1.cmml" xref="S6.F9.15.4.2.m2.1.2.3.1"></times><cn id="S6.F9.15.4.2.m2.1.2.3.2.cmml" type="float" xref="S6.F9.15.4.2.m2.1.2.3.2">0.24</cn><ci id="S6.F9.15.4.2.m2.1.2.3.3.cmml" xref="S6.F9.15.4.2.m2.1.2.3.3">s</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F9.15.4.2.m2.1d">H=0.24\,$\mathrm{s}$</annotation><annotation encoding="application/x-llamapun" id="S6.F9.15.4.2.m2.1e">italic_H = 0.24 roman_s</annotation></semantics></math>) - With a shorter predictive horizon, the robot fails to recover its posture after rotation and falls.</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F9.17.1.1" style="font-size:90%;">Figure 9</span>: </span><span class="ltx_text" id="S6.F9.18.2" style="font-size:90%;">Robot behavior under different forces and predictive horizons.</span></figcaption>
</figure>
<div class="ltx_para" id="S6.SS3.p3">
<p class="ltx_p" id="S6.SS3.p3.1">The recovery motion after rotation observed in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#S6.F9" title="Figure 9 ‣ 6.3 Evaluation of Robustness ‣ 6 Results ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">9</span></a> was not included during training; it may seem challenging to perform during inference. Unlike reinforcement learning, this behavior is possible because MPC solves an optimization problem at each timestep for a fixed horizon. These results suggest that the proposed method provides a certain level of robustness.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Conclusion</h2>
<div class="ltx_para" id="S7.p1">
<p class="ltx_p" id="S7.p1.1">In this study, we addressed the challenge of real-time control for Model Predictive Control (MPC) in high-dimensional, multi-degree-of-freedom systems and complex environments by considering the estimation of terminal values to reduce computational costs. Furthermore, to enable flexible motion generation specific to the task at hand, we proposed a hierarchical MPC framework that learns the terminal values conditioned on the objective, in combination with an upper-level trajectory generator. The proposed method successfully achieved trajectory-following tasks on flat and sloped terrains using a bipedal inverted pendulum robot by shortening the prediction horizon of the MPC and accomplishing tasks in real time. It was also confirmed that terminal values obtained through environmental randomization enhance the robustness of the MPC.</p>
</div>
<div class="ltx_para" id="S7.p2">
<p class="ltx_p" id="S7.p2.1">Future challenges include real-world experimentation. Reducing computational costs to enable real-time control can be further validated through experiments with actual robotic systems. We will evaluate how the proposed method, utilizing domain randomization, allows our learning system to achieve successful control of the real robot system.</p>
</div>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">Acknowledgement</h2>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">This work was supported by JST-Mirai Program, Grant Number: JPMJMI21B1, JST Moonshot R&amp;D, Grant Number: JPMJMS223B-3, JSPS KAKENHI Grant Number: 22H04998 and 22H03669, and the project JPNP20006, commissioned by NEDO, JAPAN.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Andrychowicz et al. (2020)</span>
<span class="ltx_bibblock">
Andrychowicz, O.M., Baker, B., Chociej, M., Jozefowicz, R., McGrew, B., Pachocki, J., Petron, A., Plappert, M., Powell, G., Ray, A., et al., 2020.

</span>
<span class="ltx_bibblock">Learning dexterous in-hand manipulation.

</span>
<span class="ltx_bibblock">The International Journal of Robotics Research 39, 3–20.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Åström and Murray (2021)</span>
<span class="ltx_bibblock">
Åström, K.J., Murray, R.M., 2021.

</span>
<span class="ltx_bibblock">Feedback systems: an introduction for scientists and engineers.

</span>
<span class="ltx_bibblock">Princeton university press.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bellman (1966)</span>
<span class="ltx_bibblock">
Bellman, R., 1966.

</span>
<span class="ltx_bibblock">Dynamic programming.

</span>
<span class="ltx_bibblock">Science 153, 34–37.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bemporad et al. (2002)</span>
<span class="ltx_bibblock">
Bemporad, A., Morari, M., Dua, V., Pistikopoulos, E.N., 2002.

</span>
<span class="ltx_bibblock">The explicit linear quadratic regulator for constrained systems.

</span>
<span class="ltx_bibblock">Automatica 38, 3–20.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bertsekas and Tsitsiklis (1996)</span>
<span class="ltx_bibblock">
Bertsekas, D., Tsitsiklis, J.N., 1996.

</span>
<span class="ltx_bibblock">Neuro-dynamic programming.

</span>
<span class="ltx_bibblock">Athena Scientific.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bhardwaj et al. (2021)</span>
<span class="ltx_bibblock">
Bhardwaj, M., Choudhury, S., Boots, B., 2021.

</span>
<span class="ltx_bibblock">Blending MPC &amp; Value Function Approximation for Efficient Reinforcement Learning, in: International Conference on Learning Representations (ICLR).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bhardwaj et al. (2019)</span>
<span class="ltx_bibblock">
Bhardwaj, M., Handa, A., Fox, D., Boots, B., 2019.

</span>
<span class="ltx_bibblock">Information Theoretic Model Predictive Q-Learning, in: Conference on Learning for Dynamics &amp; Control.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bledt and Kim (2019)</span>
<span class="ltx_bibblock">
Bledt, G., Kim, S., 2019.

</span>
<span class="ltx_bibblock">Implementing Regularized Predictive Control for Simultaneous Real-Time Footstep and Ground Reaction Force Optimization, in: 2019 IEEE/RSJ International Conference on Intelligent Robots and Systems (IROS), pp. 6316–6323.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Botev et al. (2013)</span>
<span class="ltx_bibblock">
Botev, Z.I., Kroese, D.P., Rubinstein, R.Y., L’Ecuyer, P., 2013.

</span>
<span class="ltx_bibblock">The cross-entropy method for optimization, in: Handbook of statistics. Elsevier. volume 31, pp. 35–59.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chane-Sane et al. (2021)</span>
<span class="ltx_bibblock">
Chane-Sane, E., Schmid, C., Laptev, I., 2021.

</span>
<span class="ltx_bibblock">Goal-Conditioned Reinforcement Learning with Imagined Subgoals, in: International Conference on Machine Learning, PMLR. pp. 1430–1440.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Erez et al. (2013)</span>
<span class="ltx_bibblock">
Erez, T., Lowrey, K., Tassa, Y., Kumar, V., Kolev, S., Todorov, E., 2013.

</span>
<span class="ltx_bibblock">An integrated system for real-time model predictive control of humanoid robots, in: 2013 13th IEEE-RAS International conference on humanoid robots (Humanoids), IEEE. pp. 292–299.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Farshidian et al. (2017)</span>
<span class="ltx_bibblock">
Farshidian, F., Neunert, M., Winkler, A.W., Rey, G., Buchli, J., 2017.

</span>
<span class="ltx_bibblock">An Efficient optimal Planning and Control Framework For Quadrupedal Locomotion, in: 2017 IEEE International Conference on Robotics and Automation (ICRA), IEEE. pp. 93–100.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Florensa et al. (2018)</span>
<span class="ltx_bibblock">
Florensa, C., Held, D., Geng, X., Abbeel, P., 2018.

</span>
<span class="ltx_bibblock">Automatic Goal Generation for Reinforcement Learning Agents, in: Dy, J., Krause, A. (Eds.), Proceedings of the 35th International Conference on Machine Learning, PMLR. pp. 1515–1528.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Goschin et al. (2013)</span>
<span class="ltx_bibblock">
Goschin, S., Weinstein, A., Littman, M., 2013.

</span>
<span class="ltx_bibblock">The cross-entropy method optimizes for quantiles, in: International Conference on Machine Learning, PMLR. pp. 1193–1201.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Granzotto et al. (2020)</span>
<span class="ltx_bibblock">
Granzotto, M., Postoyan, R., Buşoniu, L., Nešić, D., Daafouz, J., 2020.

</span>
<span class="ltx_bibblock">Finite-horizon discounted optimal control: stability and performance.

</span>
<span class="ltx_bibblock">IEEE Transactions on Automatic Control 66, 550–565.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hansen et al. (2003)</span>
<span class="ltx_bibblock">
Hansen, N., Müller, S.D., Koumoutsakos, P., 2003.

</span>
<span class="ltx_bibblock">Reducing the time complexity of the derandomized evolution strategy with covariance matrix adaptation (CMA-ES).

</span>
<span class="ltx_bibblock">Evolutionary computation 11, 1–18.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ishihara et al. (2019)</span>
<span class="ltx_bibblock">
Ishihara, K., Itoh, T.D., Morimoto, J., 2019.

</span>
<span class="ltx_bibblock">Full-body optimal control toward versatile and agile behaviors in a humanoid robot.

</span>
<span class="ltx_bibblock">IEEE Robotics and Automation Letters 5, 119–126.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kanayama et al. (1990)</span>
<span class="ltx_bibblock">
Kanayama, Y., Kimura, Y., Miyazaki, F., Noguchi, T., 1990.

</span>
<span class="ltx_bibblock">A stable tracking control method for an autonomous mobile robot, in: Proceedings., IEEE International Conference on Robotics and Automation (ICRA), IEEE. pp. 384–389.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Katayama and Ohtsuka (2022)</span>
<span class="ltx_bibblock">
Katayama, S., Ohtsuka, T., 2022.

</span>
<span class="ltx_bibblock">Whole-body model predictive control with rigid contacts via online switching time optimization, in: 2022 IEEE/RSJ International Conference on Intelligent Robots and Systems (IROS), IEEE. pp. 8858–8865.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kucuk and Bingul (2006)</span>
<span class="ltx_bibblock">
Kucuk, S., Bingul, Z., 2006.

</span>
<span class="ltx_bibblock">Robot kinematics: Forward and inverse kinematics.

</span>
<span class="ltx_bibblock">INTECH Open Access Publisher London, UK.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kvasnica (2016)</span>
<span class="ltx_bibblock">
Kvasnica, M., 2016.

</span>
<span class="ltx_bibblock">Implicit vs explicit MPC — Similarities, differences, and a path owards a unified method, in: 2016 European Control Conference (ECC), pp. 603–603.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lee et al. (2020)</span>
<span class="ltx_bibblock">
Lee, L., Eysenbach, B., Salakhutdinov, R., Gu, S.S., Finn, C., 2020.

</span>
<span class="ltx_bibblock">Weakly-Supervised Reinforcement Learning for Controllable Behavior, in: Advances in Neural Information Processing Systems.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2024)</span>
<span class="ltx_bibblock">
Liu, D., Yang, F., Liao, X., Lyu, X., 2024.

</span>
<span class="ltx_bibblock">Diablo: A 6-dof wheeled bipedal robot composed entirely of direct-drive joints.

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:2407.21500 .

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2022)</span>
<span class="ltx_bibblock">
Liu, M., Zhu, M., Zhang, W., 2022.

</span>
<span class="ltx_bibblock">Goal-conditioned reinforcement learning: Problems and solutions, in: Proceedings of the Thirty-First International Joint Conference on Artificial Intelligence, IJCAI-22.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lowrey et al. (2019)</span>
<span class="ltx_bibblock">
Lowrey, K., Rajeswaran, A., Kakade, S., Todorov, E., Mordatch, I., 2019.

</span>
<span class="ltx_bibblock">Plan Online, Learn Offline: Efficient Learning and Exploration via Model-Based Control, in: International Conference on Learning Representations (ICLR).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Munos and Szepesvári (2008)</span>
<span class="ltx_bibblock">
Munos, R., Szepesvári, C., 2008.

</span>
<span class="ltx_bibblock">Finite-Time Bounds for Fitted Value Iteration.

</span>
<span class="ltx_bibblock">Journal of Machine Learning Research 9.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nair et al. (2019)</span>
<span class="ltx_bibblock">
Nair, A., Bahl, S., Khazatsky, A., Pong, V., Berseth, G., Levine, S., 2019.

</span>
<span class="ltx_bibblock">Contextual Imagined Goals for Self-Supervised Robotic Learning, in: Conference on Robot Learning (CoRL).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nair et al. (2018)</span>
<span class="ltx_bibblock">
Nair, A.V., Pong, V., Dalal, M., Bahl, S., Lin, S., Levine, S., 2018.

</span>
<span class="ltx_bibblock">Visual Reinforcement Learning with Imagined Goals, in: Advances in Neural Information Processing Systems, Curran Associates, Inc.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Neunert et al. (2016)</span>
<span class="ltx_bibblock">
Neunert, M., De Crousaz, C., Furrer, F., Kamel, M., Farshidian, F., Siegwart, R., Buchli, J., 2016.

</span>
<span class="ltx_bibblock">Fast nonlinear model predictive control for unified trajectory optimization and tracking, in: 2016 IEEE international conference on robotics and automation (ICRA), IEEE. pp. 1398–1404.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ohtsuka (2017)</span>
<span class="ltx_bibblock">
Ohtsuka, T., 2017.

</span>
<span class="ltx_bibblock">Research Trend of Nonlinear Model Predictive Control.

</span>
<span class="ltx_bibblock">Systems, Control And Information 61, 42–50.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Orin et al. (2013)</span>
<span class="ltx_bibblock">
Orin, D.E., Goswami, A., Lee, S.H., 2013.

</span>
<span class="ltx_bibblock">Centroidal dynamics of a humanoid robot.

</span>
<span class="ltx_bibblock">Autonomous robots 35, 161–176.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Paszke et al. (2019)</span>
<span class="ltx_bibblock">
Paszke, A., Gross, S., Massa, F., Lerer, A., Bradbury, J., Chanan, G., Killeen, T., Lin, Z., Gimelshein, N., Antiga, L., Desmaison, A., Kopf, A., Yang, E., DeVito, Z., Raison, M., Tejani, A., Chilamkurthy, S., Steiner, B., Fang, L., Bai, J., Chintala, S., 2019.

</span>
<span class="ltx_bibblock">PyTorch: An Imperative Style, High-Performance Deep Learning Library, in: Advances in Neural Information Processing Systems 32, Curran Associates, Inc.. pp. 8024–8035.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Peng et al. (2018)</span>
<span class="ltx_bibblock">
Peng, X.B., Andrychowicz, M., Zaremba, W., Abbeel, P., 2018.

</span>
<span class="ltx_bibblock">Sim-to-real transfer of robotic control with dynamics randomization, in: 2018 IEEE international conference on robotics and automation (ICRA), IEEE. pp. 3803–3810.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Romualdi et al. (2022)</span>
<span class="ltx_bibblock">
Romualdi, G., Dafarra, S., L’Erario, G., Sorrentino, I., Traversaro, S., Pucci, D., 2022.

</span>
<span class="ltx_bibblock">Online Non-linear Centroidal MPC for Humanoid Robot Locomotion with Step Adjustment, in: 2022 International Conference on Robotics and Automation (ICRA), pp. 10412–10419.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sleiman et al. (2021)</span>
<span class="ltx_bibblock">
Sleiman, J.P., Farshidian, F., Minniti, M.V., Hutter, M., 2021.

</span>
<span class="ltx_bibblock">A Unified MPC Framework for Whole-Body Dynamic Locomotion and Manipulation.

</span>
<span class="ltx_bibblock">IEEE Robotics and Automation Letters 6, 4688–4695.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sutton and Barto (2018)</span>
<span class="ltx_bibblock">
Sutton, R.S., Barto, A.G., 2018.

</span>
<span class="ltx_bibblock">Reinforcement learning: An introduction.

</span>
<span class="ltx_bibblock">MIT press.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tang and Kucukelbir (2020)</span>
<span class="ltx_bibblock">
Tang, Y., Kucukelbir, A., 2020.

</span>
<span class="ltx_bibblock">Hindsight Expectation Maximization for Goal-conditioned Reinforcement Learning, in: International Conference on Artificial Intelligence and Statistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tassa et al. (2012)</span>
<span class="ltx_bibblock">
Tassa, Y., Erez, T., Todorov, E., 2012.

</span>
<span class="ltx_bibblock">Synthesis and stabilization of complex behaviors through online trajectory optimization, in: 2012 IEEE/RSJ International Conference on Intelligent Robots and Systems, IEEE. pp. 4906–4913.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tassa et al. (2014)</span>
<span class="ltx_bibblock">
Tassa, Y., Mansard, N., Todorov, E., 2014.

</span>
<span class="ltx_bibblock">Control-limited differential dynamic programming, in: 2014 IEEE International Conference on Robotics and Automation (ICRA), IEEE. pp. 1168–1175.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tobin et al. (2017)</span>
<span class="ltx_bibblock">
Tobin, J., Fong, R., Ray, A., Schneider, J., Zaremba, W., Abbeel, P., 2017.

</span>
<span class="ltx_bibblock">Domain randomization for transferring deep neural networks from simulation to the real world, in: 2017 IEEE/RSJ international conference on intelligent robots and systems (IROS), IEEE. pp. 23–30.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Todorov et al. (2012)</span>
<span class="ltx_bibblock">
Todorov, E., Erez, T., Tassa, Y., 2012.

</span>
<span class="ltx_bibblock">Mujoco: A physics engine for model-based control, in: 2012 IEEE/RSJ international conference on intelligent robots and systems, IEEE. pp. 5026–5033.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Warde-Farley et al. (2019)</span>
<span class="ltx_bibblock">
Warde-Farley, D., de Wiele, T.V., Kulkarni, T., Ionescu, C., Hansen, S., Mnih, V., 2019.

</span>
<span class="ltx_bibblock">Unsupervised Control Through Non-Parametric Discriminative Rewards, in: International Conference on Learning Representations.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Williams et al. (2016)</span>
<span class="ltx_bibblock">
Williams, G., Drews, P., Goldfain, B., Rehg, J.M., Theodorou, E.A., 2016.

</span>
<span class="ltx_bibblock">Aggressive driving with model predictive path integral control, in: 2016 IEEE International Conference on Robotics and Automation (ICRA), IEEE. pp. 1433–1440.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Williams et al. (2018)</span>
<span class="ltx_bibblock">
Williams, G., Drews, P., Goldfain, B., Rehg, J.M., Theodorou, E.A., 2018.

</span>
<span class="ltx_bibblock">Information-theoretic model predictive control: Theory and applications to autonomous driving.

</span>
<span class="ltx_bibblock">IEEE Transactions on Robotics 34, 1603–1622.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zeilinger et al. (2011)</span>
<span class="ltx_bibblock">
Zeilinger, M.N., Jones, C.N., Morari, M., 2011.

</span>
<span class="ltx_bibblock">Real-Time Suboptimal Model Predictive Control Using a Combination of Explicit MPC and Online Optimization.

</span>
<span class="ltx_bibblock">IEEE Transactions on Automatic Control 56, 1524–1534.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al. (2021)</span>
<span class="ltx_bibblock">
Zhu, M., Liu, M., Shen, J., Zhang, Z., Chen, S., Zhang, W., Ye, D., Yu, Y., Fu, Q., Yang, W., 2021.

</span>
<span class="ltx_bibblock">MapGo: Model-Assisted Policy Optimization for Goal-Oriented Tasks, in: Proceedings of the Thirtieth International Joint Conference on Artificial Intelligence, IJCAI-21.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Hyperparameter</h2>
<div class="ltx_para" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">In this appendix, we describe the various hyperparameters used in the experiments.</p>
</div>
<div class="ltx_para" id="A1.p2">
<p class="ltx_p" id="A1.p2.1">We show the hyperparameters of the neural network used for learning the value function in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#A1.T3" title="Table 3 ‣ Appendix A Hyperparameter ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">3</span></a>. For all tasks in this study, the parameters in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#A1.T3" title="Table 3 ‣ Appendix A Hyperparameter ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">3</span></a> were used.</p>
</div>
<figure class="ltx_table" id="A1.T3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="A1.T3.4.1.1" style="font-size:90%;">Table 3</span>: </span><span class="ltx_text" id="A1.T3.5.2" style="font-size:90%;">Neural Network Parameters</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A1.T3.2">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A1.T3.2.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" id="A1.T3.2.3.1.1">Parameter Name</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t" id="A1.T3.2.3.1.2">Value</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T3.2.4.1">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_tt" id="A1.T3.2.4.1.1">Number of hidden layers</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="A1.T3.2.4.1.2">2</td>
</tr>
<tr class="ltx_tr" id="A1.T3.2.5.2">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A1.T3.2.5.2.1">Units per layer</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T3.2.5.2.2">100</td>
</tr>
<tr class="ltx_tr" id="A1.T3.2.6.3">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A1.T3.2.6.3.1">Learning rate</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T3.2.6.3.2">0.001</td>
</tr>
<tr class="ltx_tr" id="A1.T3.2.7.4">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A1.T3.2.7.4.1">Replay buffer size</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T3.2.7.4.2">3000</td>
</tr>
<tr class="ltx_tr" id="A1.T3.2.8.5">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A1.T3.2.8.5.1">Minibatch size</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T3.2.8.5.2">32</td>
</tr>
<tr class="ltx_tr" id="A1.T3.2.9.6">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A1.T3.2.9.6.1">Minibatch sampling times</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T3.2.9.6.2">64</td>
</tr>
<tr class="ltx_tr" id="A1.T3.2.10.7">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A1.T3.2.10.7.1">Activation function</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T3.2.10.7.2">ReLU</td>
</tr>
<tr class="ltx_tr" id="A1.T3.2.11.8">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A1.T3.2.11.8.1">Optimizer</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T3.2.11.8.2">Adam</td>
</tr>
<tr class="ltx_tr" id="A1.T3.2.2">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r" id="A1.T3.1.1.1">Training frequency <math alttext="Z" class="ltx_Math" display="inline" id="A1.T3.1.1.1.m1.1"><semantics id="A1.T3.1.1.1.m1.1a"><mi id="A1.T3.1.1.1.m1.1.1" xref="A1.T3.1.1.1.m1.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="A1.T3.1.1.1.m1.1b"><ci id="A1.T3.1.1.1.m1.1.1.cmml" xref="A1.T3.1.1.1.m1.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.1.1.1.m1.1c">Z</annotation><annotation encoding="application/x-llamapun" id="A1.T3.1.1.1.m1.1d">italic_Z</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r" id="A1.T3.2.2.2"><math alttext="16\ [$\mathrm{s}\mathrm{t}\mathrm{e}\mathrm{p}$]" class="ltx_Math" display="inline" id="A1.T3.2.2.2.m1.2"><semantics id="A1.T3.2.2.2.m1.2a"><mrow id="A1.T3.2.2.2.m1.2.3" xref="A1.T3.2.2.2.m1.2.3.cmml"><mn id="A1.T3.2.2.2.m1.2.3.2" xref="A1.T3.2.2.2.m1.2.3.2.cmml">16</mn><mo id="A1.T3.2.2.2.m1.2.3.1" lspace="0.500em" xref="A1.T3.2.2.2.m1.2.3.1.cmml">⁢</mo><mrow id="A1.T3.2.2.2.m1.2.3.3.2" xref="A1.T3.2.2.2.m1.2.3.3.1.cmml"><mo id="A1.T3.2.2.2.m1.2.3.3.2.1" stretchy="false" xref="A1.T3.2.2.2.m1.2.3.3.1.1.cmml">[</mo><mi id="A1.T3.2.2.2.m1.2.2" xref="A1.T3.2.2.2.m1.2.2.cmml">step</mi><mo id="A1.T3.2.2.2.m1.2.3.3.2.2" stretchy="false" xref="A1.T3.2.2.2.m1.2.3.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.T3.2.2.2.m1.2b"><apply id="A1.T3.2.2.2.m1.2.3.cmml" xref="A1.T3.2.2.2.m1.2.3"><times id="A1.T3.2.2.2.m1.2.3.1.cmml" xref="A1.T3.2.2.2.m1.2.3.1"></times><cn id="A1.T3.2.2.2.m1.2.3.2.cmml" type="integer" xref="A1.T3.2.2.2.m1.2.3.2">16</cn><apply id="A1.T3.2.2.2.m1.2.3.3.1.cmml" xref="A1.T3.2.2.2.m1.2.3.3.2"><csymbol cd="latexml" id="A1.T3.2.2.2.m1.2.3.3.1.1.cmml" xref="A1.T3.2.2.2.m1.2.3.3.2.1">delimited-[]</csymbol><ci id="A1.T3.2.2.2.m1.2.2.cmml" xref="A1.T3.2.2.2.m1.2.2">step</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.2.2.2.m1.2c">16\ [$\mathrm{s}\mathrm{t}\mathrm{e}\mathrm{p}$]</annotation><annotation encoding="application/x-llamapun" id="A1.T3.2.2.2.m1.2d">16 [ roman_step ]</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="A1.p3">
<p class="ltx_p" id="A1.p3.1">Next, we describe the parameters for MPPI. The parameters for each task are listed in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#A1.T4" title="Table 4 ‣ Appendix A Hyperparameter ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">4</span></a>. Most parameters are consistent across all tasks, with only the horizon and rollout varying between them.</p>
</div>
<figure class="ltx_table" id="A1.T4">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="A1.T4.6.1.1" style="font-size:90%;">Table 4</span>: </span><span class="ltx_text" id="A1.T4.7.2" style="font-size:90%;">MPPI Parameters</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A1.T4.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A1.T4.4.5.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="A1.T4.4.5.1.1">Parameter Name</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t" id="A1.T4.4.5.1.2">Value</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T4.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_tt" id="A1.T4.1.1.1">Noise <math alttext="\Sigma" class="ltx_Math" display="inline" id="A1.T4.1.1.1.m1.1"><semantics id="A1.T4.1.1.1.m1.1a"><mi id="A1.T4.1.1.1.m1.1.1" mathvariant="normal" xref="A1.T4.1.1.1.m1.1.1.cmml">Σ</mi><annotation-xml encoding="MathML-Content" id="A1.T4.1.1.1.m1.1b"><ci id="A1.T4.1.1.1.m1.1.1.cmml" xref="A1.T4.1.1.1.m1.1.1">Σ</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.1.1.1.m1.1c">\Sigma</annotation><annotation encoding="application/x-llamapun" id="A1.T4.1.1.1.m1.1d">roman_Σ</annotation></semantics></math>
</th>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="A1.T4.2.2.2"><math alttext="\mathrm{diag}(16,16,1e-5,1e-5,1e-5,1e-5)" class="ltx_Math" display="inline" id="A1.T4.2.2.2.m1.6"><semantics id="A1.T4.2.2.2.m1.6a"><mrow id="A1.T4.2.2.2.m1.6.6" xref="A1.T4.2.2.2.m1.6.6.cmml"><mi id="A1.T4.2.2.2.m1.6.6.6" xref="A1.T4.2.2.2.m1.6.6.6.cmml">diag</mi><mo id="A1.T4.2.2.2.m1.6.6.5" xref="A1.T4.2.2.2.m1.6.6.5.cmml">⁢</mo><mrow id="A1.T4.2.2.2.m1.6.6.4.4" xref="A1.T4.2.2.2.m1.6.6.4.5.cmml"><mo id="A1.T4.2.2.2.m1.6.6.4.4.5" stretchy="false" xref="A1.T4.2.2.2.m1.6.6.4.5.cmml">(</mo><mn id="A1.T4.2.2.2.m1.1.1" xref="A1.T4.2.2.2.m1.1.1.cmml">16</mn><mo id="A1.T4.2.2.2.m1.6.6.4.4.6" xref="A1.T4.2.2.2.m1.6.6.4.5.cmml">,</mo><mn id="A1.T4.2.2.2.m1.2.2" xref="A1.T4.2.2.2.m1.2.2.cmml">16</mn><mo id="A1.T4.2.2.2.m1.6.6.4.4.7" xref="A1.T4.2.2.2.m1.6.6.4.5.cmml">,</mo><mrow id="A1.T4.2.2.2.m1.3.3.1.1.1" xref="A1.T4.2.2.2.m1.3.3.1.1.1.cmml"><mrow id="A1.T4.2.2.2.m1.3.3.1.1.1.2" xref="A1.T4.2.2.2.m1.3.3.1.1.1.2.cmml"><mn id="A1.T4.2.2.2.m1.3.3.1.1.1.2.2" xref="A1.T4.2.2.2.m1.3.3.1.1.1.2.2.cmml">1</mn><mo id="A1.T4.2.2.2.m1.3.3.1.1.1.2.1" xref="A1.T4.2.2.2.m1.3.3.1.1.1.2.1.cmml">⁢</mo><mi id="A1.T4.2.2.2.m1.3.3.1.1.1.2.3" xref="A1.T4.2.2.2.m1.3.3.1.1.1.2.3.cmml">e</mi></mrow><mo id="A1.T4.2.2.2.m1.3.3.1.1.1.1" xref="A1.T4.2.2.2.m1.3.3.1.1.1.1.cmml">−</mo><mn id="A1.T4.2.2.2.m1.3.3.1.1.1.3" xref="A1.T4.2.2.2.m1.3.3.1.1.1.3.cmml">5</mn></mrow><mo id="A1.T4.2.2.2.m1.6.6.4.4.8" xref="A1.T4.2.2.2.m1.6.6.4.5.cmml">,</mo><mrow id="A1.T4.2.2.2.m1.4.4.2.2.2" xref="A1.T4.2.2.2.m1.4.4.2.2.2.cmml"><mrow id="A1.T4.2.2.2.m1.4.4.2.2.2.2" xref="A1.T4.2.2.2.m1.4.4.2.2.2.2.cmml"><mn id="A1.T4.2.2.2.m1.4.4.2.2.2.2.2" xref="A1.T4.2.2.2.m1.4.4.2.2.2.2.2.cmml">1</mn><mo id="A1.T4.2.2.2.m1.4.4.2.2.2.2.1" xref="A1.T4.2.2.2.m1.4.4.2.2.2.2.1.cmml">⁢</mo><mi id="A1.T4.2.2.2.m1.4.4.2.2.2.2.3" xref="A1.T4.2.2.2.m1.4.4.2.2.2.2.3.cmml">e</mi></mrow><mo id="A1.T4.2.2.2.m1.4.4.2.2.2.1" xref="A1.T4.2.2.2.m1.4.4.2.2.2.1.cmml">−</mo><mn id="A1.T4.2.2.2.m1.4.4.2.2.2.3" xref="A1.T4.2.2.2.m1.4.4.2.2.2.3.cmml">5</mn></mrow><mo id="A1.T4.2.2.2.m1.6.6.4.4.9" xref="A1.T4.2.2.2.m1.6.6.4.5.cmml">,</mo><mrow id="A1.T4.2.2.2.m1.5.5.3.3.3" xref="A1.T4.2.2.2.m1.5.5.3.3.3.cmml"><mrow id="A1.T4.2.2.2.m1.5.5.3.3.3.2" xref="A1.T4.2.2.2.m1.5.5.3.3.3.2.cmml"><mn id="A1.T4.2.2.2.m1.5.5.3.3.3.2.2" xref="A1.T4.2.2.2.m1.5.5.3.3.3.2.2.cmml">1</mn><mo id="A1.T4.2.2.2.m1.5.5.3.3.3.2.1" xref="A1.T4.2.2.2.m1.5.5.3.3.3.2.1.cmml">⁢</mo><mi id="A1.T4.2.2.2.m1.5.5.3.3.3.2.3" xref="A1.T4.2.2.2.m1.5.5.3.3.3.2.3.cmml">e</mi></mrow><mo id="A1.T4.2.2.2.m1.5.5.3.3.3.1" xref="A1.T4.2.2.2.m1.5.5.3.3.3.1.cmml">−</mo><mn id="A1.T4.2.2.2.m1.5.5.3.3.3.3" xref="A1.T4.2.2.2.m1.5.5.3.3.3.3.cmml">5</mn></mrow><mo id="A1.T4.2.2.2.m1.6.6.4.4.10" xref="A1.T4.2.2.2.m1.6.6.4.5.cmml">,</mo><mrow id="A1.T4.2.2.2.m1.6.6.4.4.4" xref="A1.T4.2.2.2.m1.6.6.4.4.4.cmml"><mrow id="A1.T4.2.2.2.m1.6.6.4.4.4.2" xref="A1.T4.2.2.2.m1.6.6.4.4.4.2.cmml"><mn id="A1.T4.2.2.2.m1.6.6.4.4.4.2.2" xref="A1.T4.2.2.2.m1.6.6.4.4.4.2.2.cmml">1</mn><mo id="A1.T4.2.2.2.m1.6.6.4.4.4.2.1" xref="A1.T4.2.2.2.m1.6.6.4.4.4.2.1.cmml">⁢</mo><mi id="A1.T4.2.2.2.m1.6.6.4.4.4.2.3" xref="A1.T4.2.2.2.m1.6.6.4.4.4.2.3.cmml">e</mi></mrow><mo id="A1.T4.2.2.2.m1.6.6.4.4.4.1" xref="A1.T4.2.2.2.m1.6.6.4.4.4.1.cmml">−</mo><mn id="A1.T4.2.2.2.m1.6.6.4.4.4.3" xref="A1.T4.2.2.2.m1.6.6.4.4.4.3.cmml">5</mn></mrow><mo id="A1.T4.2.2.2.m1.6.6.4.4.11" stretchy="false" xref="A1.T4.2.2.2.m1.6.6.4.5.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.T4.2.2.2.m1.6b"><apply id="A1.T4.2.2.2.m1.6.6.cmml" xref="A1.T4.2.2.2.m1.6.6"><times id="A1.T4.2.2.2.m1.6.6.5.cmml" xref="A1.T4.2.2.2.m1.6.6.5"></times><ci id="A1.T4.2.2.2.m1.6.6.6.cmml" xref="A1.T4.2.2.2.m1.6.6.6">diag</ci><vector id="A1.T4.2.2.2.m1.6.6.4.5.cmml" xref="A1.T4.2.2.2.m1.6.6.4.4"><cn id="A1.T4.2.2.2.m1.1.1.cmml" type="integer" xref="A1.T4.2.2.2.m1.1.1">16</cn><cn id="A1.T4.2.2.2.m1.2.2.cmml" type="integer" xref="A1.T4.2.2.2.m1.2.2">16</cn><apply id="A1.T4.2.2.2.m1.3.3.1.1.1.cmml" xref="A1.T4.2.2.2.m1.3.3.1.1.1"><minus id="A1.T4.2.2.2.m1.3.3.1.1.1.1.cmml" xref="A1.T4.2.2.2.m1.3.3.1.1.1.1"></minus><apply id="A1.T4.2.2.2.m1.3.3.1.1.1.2.cmml" xref="A1.T4.2.2.2.m1.3.3.1.1.1.2"><times id="A1.T4.2.2.2.m1.3.3.1.1.1.2.1.cmml" xref="A1.T4.2.2.2.m1.3.3.1.1.1.2.1"></times><cn id="A1.T4.2.2.2.m1.3.3.1.1.1.2.2.cmml" type="integer" xref="A1.T4.2.2.2.m1.3.3.1.1.1.2.2">1</cn><ci id="A1.T4.2.2.2.m1.3.3.1.1.1.2.3.cmml" xref="A1.T4.2.2.2.m1.3.3.1.1.1.2.3">𝑒</ci></apply><cn id="A1.T4.2.2.2.m1.3.3.1.1.1.3.cmml" type="integer" xref="A1.T4.2.2.2.m1.3.3.1.1.1.3">5</cn></apply><apply id="A1.T4.2.2.2.m1.4.4.2.2.2.cmml" xref="A1.T4.2.2.2.m1.4.4.2.2.2"><minus id="A1.T4.2.2.2.m1.4.4.2.2.2.1.cmml" xref="A1.T4.2.2.2.m1.4.4.2.2.2.1"></minus><apply id="A1.T4.2.2.2.m1.4.4.2.2.2.2.cmml" xref="A1.T4.2.2.2.m1.4.4.2.2.2.2"><times id="A1.T4.2.2.2.m1.4.4.2.2.2.2.1.cmml" xref="A1.T4.2.2.2.m1.4.4.2.2.2.2.1"></times><cn id="A1.T4.2.2.2.m1.4.4.2.2.2.2.2.cmml" type="integer" xref="A1.T4.2.2.2.m1.4.4.2.2.2.2.2">1</cn><ci id="A1.T4.2.2.2.m1.4.4.2.2.2.2.3.cmml" xref="A1.T4.2.2.2.m1.4.4.2.2.2.2.3">𝑒</ci></apply><cn id="A1.T4.2.2.2.m1.4.4.2.2.2.3.cmml" type="integer" xref="A1.T4.2.2.2.m1.4.4.2.2.2.3">5</cn></apply><apply id="A1.T4.2.2.2.m1.5.5.3.3.3.cmml" xref="A1.T4.2.2.2.m1.5.5.3.3.3"><minus id="A1.T4.2.2.2.m1.5.5.3.3.3.1.cmml" xref="A1.T4.2.2.2.m1.5.5.3.3.3.1"></minus><apply id="A1.T4.2.2.2.m1.5.5.3.3.3.2.cmml" xref="A1.T4.2.2.2.m1.5.5.3.3.3.2"><times id="A1.T4.2.2.2.m1.5.5.3.3.3.2.1.cmml" xref="A1.T4.2.2.2.m1.5.5.3.3.3.2.1"></times><cn id="A1.T4.2.2.2.m1.5.5.3.3.3.2.2.cmml" type="integer" xref="A1.T4.2.2.2.m1.5.5.3.3.3.2.2">1</cn><ci id="A1.T4.2.2.2.m1.5.5.3.3.3.2.3.cmml" xref="A1.T4.2.2.2.m1.5.5.3.3.3.2.3">𝑒</ci></apply><cn id="A1.T4.2.2.2.m1.5.5.3.3.3.3.cmml" type="integer" xref="A1.T4.2.2.2.m1.5.5.3.3.3.3">5</cn></apply><apply id="A1.T4.2.2.2.m1.6.6.4.4.4.cmml" xref="A1.T4.2.2.2.m1.6.6.4.4.4"><minus id="A1.T4.2.2.2.m1.6.6.4.4.4.1.cmml" xref="A1.T4.2.2.2.m1.6.6.4.4.4.1"></minus><apply id="A1.T4.2.2.2.m1.6.6.4.4.4.2.cmml" xref="A1.T4.2.2.2.m1.6.6.4.4.4.2"><times id="A1.T4.2.2.2.m1.6.6.4.4.4.2.1.cmml" xref="A1.T4.2.2.2.m1.6.6.4.4.4.2.1"></times><cn id="A1.T4.2.2.2.m1.6.6.4.4.4.2.2.cmml" type="integer" xref="A1.T4.2.2.2.m1.6.6.4.4.4.2.2">1</cn><ci id="A1.T4.2.2.2.m1.6.6.4.4.4.2.3.cmml" xref="A1.T4.2.2.2.m1.6.6.4.4.4.2.3">𝑒</ci></apply><cn id="A1.T4.2.2.2.m1.6.6.4.4.4.3.cmml" type="integer" xref="A1.T4.2.2.2.m1.6.6.4.4.4.3">5</cn></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.2.2.2.m1.6c">\mathrm{diag}(16,16,1e-5,1e-5,1e-5,1e-5)</annotation><annotation encoding="application/x-llamapun" id="A1.T4.2.2.2.m1.6d">roman_diag ( 16 , 16 , 1 italic_e - 5 , 1 italic_e - 5 , 1 italic_e - 5 , 1 italic_e - 5 )</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A1.T4.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r" id="A1.T4.3.3.1">Temperature <math alttext="\beta" class="ltx_Math" display="inline" id="A1.T4.3.3.1.m1.1"><semantics id="A1.T4.3.3.1.m1.1a"><mi id="A1.T4.3.3.1.m1.1.1" xref="A1.T4.3.3.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A1.T4.3.3.1.m1.1b"><ci id="A1.T4.3.3.1.m1.1.1.cmml" xref="A1.T4.3.3.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.3.3.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="A1.T4.3.3.1.m1.1d">italic_β</annotation></semantics></math>
</th>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T4.3.3.2">0.1</td>
</tr>
<tr class="ltx_tr" id="A1.T4.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r" id="A1.T4.4.4.1">Discount factor <math alttext="\gamma" class="ltx_Math" display="inline" id="A1.T4.4.4.1.m1.1"><semantics id="A1.T4.4.4.1.m1.1a"><mi id="A1.T4.4.4.1.m1.1.1" xref="A1.T4.4.4.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="A1.T4.4.4.1.m1.1b"><ci id="A1.T4.4.4.1.m1.1.1.cmml" xref="A1.T4.4.4.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.4.4.1.m1.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="A1.T4.4.4.1.m1.1d">italic_γ</annotation></semantics></math>
</th>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r" id="A1.T4.4.4.2">0.99</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="A1.p4">
<p class="ltx_p" id="A1.p4.5">Lastly, we present the parameters for Kanayama Control in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.04929v1#A1.T5" title="Table 5 ‣ Appendix A Hyperparameter ‣ Goal-Conditioned Terminal Value Estimation for Real-time and Multi-task Model Predictive Control"><span class="ltx_text ltx_ref_tag">5</span></a>. <math alttext="K_{x}" class="ltx_Math" display="inline" id="A1.p4.1.m1.1"><semantics id="A1.p4.1.m1.1a"><msub id="A1.p4.1.m1.1.1" xref="A1.p4.1.m1.1.1.cmml"><mi id="A1.p4.1.m1.1.1.2" xref="A1.p4.1.m1.1.1.2.cmml">K</mi><mi id="A1.p4.1.m1.1.1.3" xref="A1.p4.1.m1.1.1.3.cmml">x</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p4.1.m1.1b"><apply id="A1.p4.1.m1.1.1.cmml" xref="A1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="A1.p4.1.m1.1.1.1.cmml" xref="A1.p4.1.m1.1.1">subscript</csymbol><ci id="A1.p4.1.m1.1.1.2.cmml" xref="A1.p4.1.m1.1.1.2">𝐾</ci><ci id="A1.p4.1.m1.1.1.3.cmml" xref="A1.p4.1.m1.1.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p4.1.m1.1c">K_{x}</annotation><annotation encoding="application/x-llamapun" id="A1.p4.1.m1.1d">italic_K start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="K_{y}" class="ltx_Math" display="inline" id="A1.p4.2.m2.1"><semantics id="A1.p4.2.m2.1a"><msub id="A1.p4.2.m2.1.1" xref="A1.p4.2.m2.1.1.cmml"><mi id="A1.p4.2.m2.1.1.2" xref="A1.p4.2.m2.1.1.2.cmml">K</mi><mi id="A1.p4.2.m2.1.1.3" xref="A1.p4.2.m2.1.1.3.cmml">y</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p4.2.m2.1b"><apply id="A1.p4.2.m2.1.1.cmml" xref="A1.p4.2.m2.1.1"><csymbol cd="ambiguous" id="A1.p4.2.m2.1.1.1.cmml" xref="A1.p4.2.m2.1.1">subscript</csymbol><ci id="A1.p4.2.m2.1.1.2.cmml" xref="A1.p4.2.m2.1.1.2">𝐾</ci><ci id="A1.p4.2.m2.1.1.3.cmml" xref="A1.p4.2.m2.1.1.3">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p4.2.m2.1c">K_{y}</annotation><annotation encoding="application/x-llamapun" id="A1.p4.2.m2.1d">italic_K start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="K_{\psi}" class="ltx_Math" display="inline" id="A1.p4.3.m3.1"><semantics id="A1.p4.3.m3.1a"><msub id="A1.p4.3.m3.1.1" xref="A1.p4.3.m3.1.1.cmml"><mi id="A1.p4.3.m3.1.1.2" xref="A1.p4.3.m3.1.1.2.cmml">K</mi><mi id="A1.p4.3.m3.1.1.3" xref="A1.p4.3.m3.1.1.3.cmml">ψ</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p4.3.m3.1b"><apply id="A1.p4.3.m3.1.1.cmml" xref="A1.p4.3.m3.1.1"><csymbol cd="ambiguous" id="A1.p4.3.m3.1.1.1.cmml" xref="A1.p4.3.m3.1.1">subscript</csymbol><ci id="A1.p4.3.m3.1.1.2.cmml" xref="A1.p4.3.m3.1.1.2">𝐾</ci><ci id="A1.p4.3.m3.1.1.3.cmml" xref="A1.p4.3.m3.1.1.3">𝜓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p4.3.m3.1c">K_{\psi}</annotation><annotation encoding="application/x-llamapun" id="A1.p4.3.m3.1d">italic_K start_POSTSUBSCRIPT italic_ψ end_POSTSUBSCRIPT</annotation></semantics></math> are the gains for the posture errors in the <math alttext="x" class="ltx_Math" display="inline" id="A1.p4.4.m4.1"><semantics id="A1.p4.4.m4.1a"><mi id="A1.p4.4.m4.1.1" xref="A1.p4.4.m4.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="A1.p4.4.m4.1b"><ci id="A1.p4.4.m4.1.1.cmml" xref="A1.p4.4.m4.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p4.4.m4.1c">x</annotation><annotation encoding="application/x-llamapun" id="A1.p4.4.m4.1d">italic_x</annotation></semantics></math> direction, <math alttext="y" class="ltx_Math" display="inline" id="A1.p4.5.m5.1"><semantics id="A1.p4.5.m5.1a"><mi id="A1.p4.5.m5.1.1" xref="A1.p4.5.m5.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="A1.p4.5.m5.1b"><ci id="A1.p4.5.m5.1.1.cmml" xref="A1.p4.5.m5.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p4.5.m5.1c">y</annotation><annotation encoding="application/x-llamapun" id="A1.p4.5.m5.1d">italic_y</annotation></semantics></math> direction, and yaw direction, respectively.</p>
</div>
<figure class="ltx_table" id="A1.T5">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="A1.T5.5.1.1" style="font-size:90%;">Table 5</span>: </span><span class="ltx_text" id="A1.T5.6.2" style="font-size:90%;">Kanayama Control Parameters</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A1.T5.3">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A1.T5.3.4.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="A1.T5.3.4.1.1">Parameter Name</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t" id="A1.T5.3.4.1.2">Value</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T5.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_tt" id="A1.T5.1.1.1"><math alttext="K_{x}" class="ltx_Math" display="inline" id="A1.T5.1.1.1.m1.1"><semantics id="A1.T5.1.1.1.m1.1a"><msub id="A1.T5.1.1.1.m1.1.1" xref="A1.T5.1.1.1.m1.1.1.cmml"><mi id="A1.T5.1.1.1.m1.1.1.2" xref="A1.T5.1.1.1.m1.1.1.2.cmml">K</mi><mi id="A1.T5.1.1.1.m1.1.1.3" xref="A1.T5.1.1.1.m1.1.1.3.cmml">x</mi></msub><annotation-xml encoding="MathML-Content" id="A1.T5.1.1.1.m1.1b"><apply id="A1.T5.1.1.1.m1.1.1.cmml" xref="A1.T5.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.T5.1.1.1.m1.1.1.1.cmml" xref="A1.T5.1.1.1.m1.1.1">subscript</csymbol><ci id="A1.T5.1.1.1.m1.1.1.2.cmml" xref="A1.T5.1.1.1.m1.1.1.2">𝐾</ci><ci id="A1.T5.1.1.1.m1.1.1.3.cmml" xref="A1.T5.1.1.1.m1.1.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.1.1.1.m1.1c">K_{x}</annotation><annotation encoding="application/x-llamapun" id="A1.T5.1.1.1.m1.1d">italic_K start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="A1.T5.1.1.2">3.0</td>
</tr>
<tr class="ltx_tr" id="A1.T5.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r" id="A1.T5.2.2.1"><math alttext="K_{y}" class="ltx_Math" display="inline" id="A1.T5.2.2.1.m1.1"><semantics id="A1.T5.2.2.1.m1.1a"><msub id="A1.T5.2.2.1.m1.1.1" xref="A1.T5.2.2.1.m1.1.1.cmml"><mi id="A1.T5.2.2.1.m1.1.1.2" xref="A1.T5.2.2.1.m1.1.1.2.cmml">K</mi><mi id="A1.T5.2.2.1.m1.1.1.3" xref="A1.T5.2.2.1.m1.1.1.3.cmml">y</mi></msub><annotation-xml encoding="MathML-Content" id="A1.T5.2.2.1.m1.1b"><apply id="A1.T5.2.2.1.m1.1.1.cmml" xref="A1.T5.2.2.1.m1.1.1"><csymbol cd="ambiguous" id="A1.T5.2.2.1.m1.1.1.1.cmml" xref="A1.T5.2.2.1.m1.1.1">subscript</csymbol><ci id="A1.T5.2.2.1.m1.1.1.2.cmml" xref="A1.T5.2.2.1.m1.1.1.2">𝐾</ci><ci id="A1.T5.2.2.1.m1.1.1.3.cmml" xref="A1.T5.2.2.1.m1.1.1.3">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.2.2.1.m1.1c">K_{y}</annotation><annotation encoding="application/x-llamapun" id="A1.T5.2.2.1.m1.1d">italic_K start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T5.2.2.2">3.0</td>
</tr>
<tr class="ltx_tr" id="A1.T5.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r" id="A1.T5.3.3.1"><math alttext="K_{\psi}" class="ltx_Math" display="inline" id="A1.T5.3.3.1.m1.1"><semantics id="A1.T5.3.3.1.m1.1a"><msub id="A1.T5.3.3.1.m1.1.1" xref="A1.T5.3.3.1.m1.1.1.cmml"><mi id="A1.T5.3.3.1.m1.1.1.2" xref="A1.T5.3.3.1.m1.1.1.2.cmml">K</mi><mi id="A1.T5.3.3.1.m1.1.1.3" xref="A1.T5.3.3.1.m1.1.1.3.cmml">ψ</mi></msub><annotation-xml encoding="MathML-Content" id="A1.T5.3.3.1.m1.1b"><apply id="A1.T5.3.3.1.m1.1.1.cmml" xref="A1.T5.3.3.1.m1.1.1"><csymbol cd="ambiguous" id="A1.T5.3.3.1.m1.1.1.1.cmml" xref="A1.T5.3.3.1.m1.1.1">subscript</csymbol><ci id="A1.T5.3.3.1.m1.1.1.2.cmml" xref="A1.T5.3.3.1.m1.1.1.2">𝐾</ci><ci id="A1.T5.3.3.1.m1.1.1.3.cmml" xref="A1.T5.3.3.1.m1.1.1.3">𝜓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.3.3.1.m1.1c">K_{\psi}</annotation><annotation encoding="application/x-llamapun" id="A1.T5.3.3.1.m1.1d">italic_K start_POSTSUBSCRIPT italic_ψ end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r" id="A1.T5.3.3.2">2.0</td>
</tr>
</tbody>
</table>
</figure>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Mon Oct  7 11:15:22 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
