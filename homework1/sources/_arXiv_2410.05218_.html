<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Density estimation with LLMs: a geometric investigation of in-context learning trajectories</title>
<!--Generated on Thu Oct  3 17:58:10 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.05218v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#S1" title="In Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#S1.SS0.SSS0.Px1" title="In 1 Introduction ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_title">Main contributions.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#S2" title="In Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Background</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#S2.SS0.SSS0.Px1" title="In 2 Background ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_title">In-context learning of stochastic dynamical systems.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#S2.SS0.SSS0.Px2" title="In 2 Background ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_title">Density Estimation.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#S3" title="In Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Methodology</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#S3.SS1" title="In 3 Methodology ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>InPCA visualization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#S3.SS2" title="In 3 Methodology ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Classical DE algorithms</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#S3.SS2.SSS0.Px1" title="In 3.2 Classical DE algorithms ‣ 3 Methodology ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_title">Kernel density estimation.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#S3.SS2.SSS0.Px2" title="In 3.2 Classical DE algorithms ‣ 3 Methodology ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_title">Bayesian histogram.</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#S4" title="In Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments and analysis</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#S4.SS1" title="In 4 Experiments and analysis ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Gaussian target</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#S4.SS2" title="In 4 Experiments and analysis ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Uniform target</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#S4.SS3" title="In 4 Experiments and analysis ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>The Kernel Interpretation of In-Context Density Estimation</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#S4.SS3.SSS1" title="In 4.3 The Kernel Interpretation of In-Context Density Estimation ‣ 4 Experiments and analysis ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.1 </span>Bespoke KDE Model</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#S4.SS3.SSS2" title="In 4.3 The Kernel Interpretation of In-Context Density Estimation ‣ 4 Experiments and analysis ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.2 </span>Bespoke KDE Analysis</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#S5" title="In Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusions</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1" title="In Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Appendix</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.SS1" title="In Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Mechanistic interpretations of in-context learning.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.SS2" title="In Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2 </span>Low-dimensional structures in learning dynamics.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.SS3" title="In Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.3 </span>Bespoke KDE cannot imitate all DE processes</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.SS3.SSS1" title="In A.3 Bespoke KDE cannot imitate all DE processes ‣ Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.3.1 </span>InPCA visualization of original DE trajectories vs. Bespoke KDE imitations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.SS3.SSS2" title="In A.3 Bespoke KDE cannot imitate all DE processes ‣ Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.3.2 </span>Meta-InPCA Embedding of Trajectories</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.SS4" title="In Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.4 </span>Comparison of InPCA and standard PCA</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.SS5" title="In Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.5 </span>Additional notes on Kernel Density Estimation</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.SS5.SSS1" title="In A.5 Additional notes on Kernel Density Estimation ‣ Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.5.1 </span>Optimal Bandwidth</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.SS5.SSS2" title="In A.5 Additional notes on Kernel Density Estimation ‣ Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.5.2 </span>Optimal kernel shape</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.SS5.SSS3" title="In A.5 Additional notes on Kernel Density Estimation ‣ Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.5.3 </span>MISE vs. valid statistical distances</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.SS6" title="In Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.6 </span>Adaptive Kernel Visualization: Comparing LLaMA-2 with KDE</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.SS7" title="In Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.7 </span>Randomly generated PDFs</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.SS7.SSS0.Px1" title="In A.7 Randomly generated PDFs ‣ Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_title">Gaussian Process Generation:</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.SS7.SSS0.Px2" title="In A.7 Randomly generated PDFs ‣ Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_title">Correlation Length (<math alttext="l" class="ltx_Math" display="inline"><semantics><mi>l</mi><annotation-xml encoding="MathML-Content"><ci>𝑙</ci></annotation-xml><annotation encoding="application/x-tex">l</annotation><annotation encoding="application/x-llamapun">italic_l</annotation></semantics></math>):</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.SS7.SSS0.Px3" title="In A.7 Randomly generated PDFs ‣ Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_title">Generation Process:</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.SS8" title="In Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.8 </span>KDE with Silverman bandwidth schedule</span></a></li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Density estimation with LLMs: a geometric investigation of in-context learning trajectories</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
<span class="ltx_text ltx_font_bold" id="id1.1.1">Toni J.B. Liu<sup class="ltx_sup" id="id1.1.1.1"><math alttext="*" class="ltx_Math" display="inline" id="id1.1.1.1.m1.1"><semantics id="id1.1.1.1.m1.1a"><mo id="id1.1.1.1.m1.1.1" xref="id1.1.1.1.m1.1.1.cmml">∗</mo><annotation-xml encoding="MathML-Content" id="id1.1.1.1.m1.1b"><times id="id1.1.1.1.m1.1.1.cmml" xref="id1.1.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="id1.1.1.1.m1.1c">*</annotation><annotation encoding="application/x-llamapun" id="id1.1.1.1.m1.1d">∗</annotation></semantics></math></sup></span>, 
<span class="ltx_text ltx_font_bold" id="id2.2.2">Nicolas Boullé<sup class="ltx_sup" id="id2.2.2.1"><math alttext="\dagger" class="ltx_Math" display="inline" id="id2.2.2.1.m1.1"><semantics id="id2.2.2.1.m1.1a"><mo id="id2.2.2.1.m1.1.1" xref="id2.2.2.1.m1.1.1.cmml">†</mo><annotation-xml encoding="MathML-Content" id="id2.2.2.1.m1.1b"><ci id="id2.2.2.1.m1.1.1.cmml" xref="id2.2.2.1.m1.1.1">†</ci></annotation-xml><annotation encoding="application/x-tex" id="id2.2.2.1.m1.1c">\dagger</annotation><annotation encoding="application/x-llamapun" id="id2.2.2.1.m1.1d">†</annotation></semantics></math></sup></span>, 
<span class="ltx_text ltx_font_bold" id="id3.3.3">Raphaël Sarfati<sup class="ltx_sup" id="id3.3.3.1"><math alttext="*" class="ltx_Math" display="inline" id="id3.3.3.1.m1.1"><semantics id="id3.3.3.1.m1.1a"><mo id="id3.3.3.1.m1.1.1" xref="id3.3.3.1.m1.1.1.cmml">∗</mo><annotation-xml encoding="MathML-Content" id="id3.3.3.1.m1.1b"><times id="id3.3.3.1.m1.1.1.cmml" xref="id3.3.3.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="id3.3.3.1.m1.1c">*</annotation><annotation encoding="application/x-llamapun" id="id3.3.3.1.m1.1d">∗</annotation></semantics></math></sup></span>, 
<span class="ltx_text ltx_font_bold" id="id4.4.4">Christopher J. Earls<sup class="ltx_sup" id="id4.4.4.1"><math alttext="*" class="ltx_Math" display="inline" id="id4.4.4.1.m1.1"><semantics id="id4.4.4.1.m1.1a"><mo id="id4.4.4.1.m1.1.1" xref="id4.4.4.1.m1.1.1.cmml">∗</mo><annotation-xml encoding="MathML-Content" id="id4.4.4.1.m1.1b"><times id="id4.4.4.1.m1.1.1.cmml" xref="id4.4.4.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="id4.4.4.1.m1.1c">*</annotation><annotation encoding="application/x-llamapun" id="id4.4.4.1.m1.1d">∗</annotation></semantics></math></sup></span>
<br class="ltx_break"/>
<br class="ltx_break"/><sup class="ltx_sup" id="id5.5.5"><math alttext="*" class="ltx_Math" display="inline" id="id5.5.5.m1.1"><semantics id="id5.5.5.m1.1a"><mo id="id5.5.5.m1.1.1" xref="id5.5.5.m1.1.1.cmml">∗</mo><annotation-xml encoding="MathML-Content" id="id5.5.5.m1.1b"><times id="id5.5.5.m1.1.1.cmml" xref="id5.5.5.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="id5.5.5.m1.1c">*</annotation><annotation encoding="application/x-llamapun" id="id5.5.5.m1.1d">∗</annotation></semantics></math></sup>Cornell University, USA, 
<sup class="ltx_sup" id="id6.6.6"><math alttext="\dagger" class="ltx_Math" display="inline" id="id6.6.6.m1.1"><semantics id="id6.6.6.m1.1a"><mo id="id6.6.6.m1.1.1" xref="id6.6.6.m1.1.1.cmml">†</mo><annotation-xml encoding="MathML-Content" id="id6.6.6.m1.1b"><ci id="id6.6.6.m1.1.1.cmml" xref="id6.6.6.m1.1.1">†</ci></annotation-xml><annotation encoding="application/x-tex" id="id6.6.6.m1.1c">\dagger</annotation><annotation encoding="application/x-llamapun" id="id6.6.6.m1.1d">†</annotation></semantics></math></sup>Imperial College London, UK

<br class="ltx_break"/>
<span class="ltx_text ltx_font_bold" id="id7.7.id1">Correspondence:</span> <a class="ltx_ref ltx_href" href="mailto:jl3499@cornell.edu" title="">jl3499@cornell.edu</a>
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id8.id1">Large language models (LLMs) demonstrate remarkable emergent abilities to perform in-context learning across various tasks, including time series forecasting.
This work investigates LLMs’ ability to estimate probability density functions (PDFs) from data observed in-context;
such density estimation (DE) is a fundamental task underlying many probabilistic modeling problems.
We leverage the Intensive Principal Component Analysis (InPCA) to visualize and analyze the in-context learning dynamics of LLaMA-2 models.
Our main finding is that these LLMs all follow similar learning trajectories in a low-dimensional InPCA space, which are distinct from those of traditional density estimation methods like histograms and Gaussian kernel density estimation (KDE).
We interpret the LLaMA in-context DE process as a KDE with an adaptive kernel width and shape.
This custom kernel model captures a significant portion of LLaMA’s behavior despite having only two parameters.
We further speculate on why LLaMA’s kernel width and shape differs from classical algorithms, providing insights into the mechanism of in-context probabilistic reasoning in LLMs.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para ltx_noindent" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Modern Large Language Models (LLMs) showcase surprising emergent abilities that they were not explicitly trained for <cite class="ltx_cite ltx_citemacro_citep">(Brown et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib7" title="">2020</a>; Dong et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib11" title="">2024</a>)</cite>,
such as learning from demonstrations <cite class="ltx_cite ltx_citemacro_citep">(Si et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib34" title="">2023</a>)</cite> and analogies in natural language <cite class="ltx_cite ltx_citemacro_citep">(Hu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib16" title="">2023</a>)</cite>.
Such capacity to extract patterns directly from input text strings, without relying on additional training data, is generally referred to as in-context learning (ICL).</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Recently, LLMs have been shown to achieve competitive performance on various mathematical problems, including time-series forecasting <cite class="ltx_cite ltx_citemacro_citep">(Gruver et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib13" title="">2024</a>)</cite>, inferring physical rules from dynamical systems <cite class="ltx_cite ltx_citemacro_citep">(Kantamneni et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib20" title="">2024</a>; Liu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib22" title="">2024</a>)</cite>,
and learning random languages <cite class="ltx_cite ltx_citemacro_citep">(Bigelow et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib6" title="">2024</a>)</cite>.
To solve these tasks, an LLM must possess some capacity for probabilistic modeling — the ability to infer conditional or unconditional
probability distribution structures by collecting relevant statistics from in-context examples <cite class="ltx_cite ltx_citemacro_citep">(Akyürek et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib2" title="">2024</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p3">
<p class="ltx_p" id="S1.p3.4">We investigate LLMs’ ability to perform density estimation (DE), which involves estimating the probability density function (PDF) from data observed in-context.
Our core experiment is remarkably straightforward.
As illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">1</span></a>, we prompt LLaMA-2 models <cite class="ltx_cite ltx_citemacro_citep">(Touvron et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib39" title="">2023</a>)</cite> with a series of data points <math alttext="\{X_{i}\}_{i=1}^{n}" class="ltx_Math" display="inline" id="S1.p3.1.m1.1"><semantics id="S1.p3.1.m1.1a"><msubsup id="S1.p3.1.m1.1.1" xref="S1.p3.1.m1.1.1.cmml"><mrow id="S1.p3.1.m1.1.1.1.1.1" xref="S1.p3.1.m1.1.1.1.1.2.cmml"><mo id="S1.p3.1.m1.1.1.1.1.1.2" stretchy="false" xref="S1.p3.1.m1.1.1.1.1.2.cmml">{</mo><msub id="S1.p3.1.m1.1.1.1.1.1.1" xref="S1.p3.1.m1.1.1.1.1.1.1.cmml"><mi id="S1.p3.1.m1.1.1.1.1.1.1.2" xref="S1.p3.1.m1.1.1.1.1.1.1.2.cmml">X</mi><mi id="S1.p3.1.m1.1.1.1.1.1.1.3" xref="S1.p3.1.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S1.p3.1.m1.1.1.1.1.1.3" stretchy="false" xref="S1.p3.1.m1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S1.p3.1.m1.1.1.1.3" xref="S1.p3.1.m1.1.1.1.3.cmml"><mi id="S1.p3.1.m1.1.1.1.3.2" xref="S1.p3.1.m1.1.1.1.3.2.cmml">i</mi><mo id="S1.p3.1.m1.1.1.1.3.1" xref="S1.p3.1.m1.1.1.1.3.1.cmml">=</mo><mn id="S1.p3.1.m1.1.1.1.3.3" xref="S1.p3.1.m1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S1.p3.1.m1.1.1.3" xref="S1.p3.1.m1.1.1.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="S1.p3.1.m1.1b"><apply id="S1.p3.1.m1.1.1.cmml" xref="S1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S1.p3.1.m1.1.1.2.cmml" xref="S1.p3.1.m1.1.1">superscript</csymbol><apply id="S1.p3.1.m1.1.1.1.cmml" xref="S1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S1.p3.1.m1.1.1.1.2.cmml" xref="S1.p3.1.m1.1.1">subscript</csymbol><set id="S1.p3.1.m1.1.1.1.1.2.cmml" xref="S1.p3.1.m1.1.1.1.1.1"><apply id="S1.p3.1.m1.1.1.1.1.1.1.cmml" xref="S1.p3.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S1.p3.1.m1.1.1.1.1.1.1.1.cmml" xref="S1.p3.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S1.p3.1.m1.1.1.1.1.1.1.2.cmml" xref="S1.p3.1.m1.1.1.1.1.1.1.2">𝑋</ci><ci id="S1.p3.1.m1.1.1.1.1.1.1.3.cmml" xref="S1.p3.1.m1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S1.p3.1.m1.1.1.1.3.cmml" xref="S1.p3.1.m1.1.1.1.3"><eq id="S1.p3.1.m1.1.1.1.3.1.cmml" xref="S1.p3.1.m1.1.1.1.3.1"></eq><ci id="S1.p3.1.m1.1.1.1.3.2.cmml" xref="S1.p3.1.m1.1.1.1.3.2">𝑖</ci><cn id="S1.p3.1.m1.1.1.1.3.3.cmml" type="integer" xref="S1.p3.1.m1.1.1.1.3.3">1</cn></apply></apply><ci id="S1.p3.1.m1.1.1.3.cmml" xref="S1.p3.1.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.1.m1.1c">\{X_{i}\}_{i=1}^{n}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.1.m1.1d">{ italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT</annotation></semantics></math> sampled independently and identically from an underlying distribution <math alttext="p(x)" class="ltx_Math" display="inline" id="S1.p3.2.m2.1"><semantics id="S1.p3.2.m2.1a"><mrow id="S1.p3.2.m2.1.2" xref="S1.p3.2.m2.1.2.cmml"><mi id="S1.p3.2.m2.1.2.2" xref="S1.p3.2.m2.1.2.2.cmml">p</mi><mo id="S1.p3.2.m2.1.2.1" xref="S1.p3.2.m2.1.2.1.cmml">⁢</mo><mrow id="S1.p3.2.m2.1.2.3.2" xref="S1.p3.2.m2.1.2.cmml"><mo id="S1.p3.2.m2.1.2.3.2.1" stretchy="false" xref="S1.p3.2.m2.1.2.cmml">(</mo><mi id="S1.p3.2.m2.1.1" xref="S1.p3.2.m2.1.1.cmml">x</mi><mo id="S1.p3.2.m2.1.2.3.2.2" stretchy="false" xref="S1.p3.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.2.m2.1b"><apply id="S1.p3.2.m2.1.2.cmml" xref="S1.p3.2.m2.1.2"><times id="S1.p3.2.m2.1.2.1.cmml" xref="S1.p3.2.m2.1.2.1"></times><ci id="S1.p3.2.m2.1.2.2.cmml" xref="S1.p3.2.m2.1.2.2">𝑝</ci><ci id="S1.p3.2.m2.1.1.cmml" xref="S1.p3.2.m2.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.2.m2.1c">p(x)</annotation><annotation encoding="application/x-llamapun" id="S1.p3.2.m2.1d">italic_p ( italic_x )</annotation></semantics></math>.
We then observe that the LLaMA’s predicted PDF, <math alttext="\hat{p}_{n}(x)" class="ltx_Math" display="inline" id="S1.p3.3.m3.1"><semantics id="S1.p3.3.m3.1a"><mrow id="S1.p3.3.m3.1.2" xref="S1.p3.3.m3.1.2.cmml"><msub id="S1.p3.3.m3.1.2.2" xref="S1.p3.3.m3.1.2.2.cmml"><mover accent="true" id="S1.p3.3.m3.1.2.2.2" xref="S1.p3.3.m3.1.2.2.2.cmml"><mi id="S1.p3.3.m3.1.2.2.2.2" xref="S1.p3.3.m3.1.2.2.2.2.cmml">p</mi><mo id="S1.p3.3.m3.1.2.2.2.1" xref="S1.p3.3.m3.1.2.2.2.1.cmml">^</mo></mover><mi id="S1.p3.3.m3.1.2.2.3" xref="S1.p3.3.m3.1.2.2.3.cmml">n</mi></msub><mo id="S1.p3.3.m3.1.2.1" xref="S1.p3.3.m3.1.2.1.cmml">⁢</mo><mrow id="S1.p3.3.m3.1.2.3.2" xref="S1.p3.3.m3.1.2.cmml"><mo id="S1.p3.3.m3.1.2.3.2.1" stretchy="false" xref="S1.p3.3.m3.1.2.cmml">(</mo><mi id="S1.p3.3.m3.1.1" xref="S1.p3.3.m3.1.1.cmml">x</mi><mo id="S1.p3.3.m3.1.2.3.2.2" stretchy="false" xref="S1.p3.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.3.m3.1b"><apply id="S1.p3.3.m3.1.2.cmml" xref="S1.p3.3.m3.1.2"><times id="S1.p3.3.m3.1.2.1.cmml" xref="S1.p3.3.m3.1.2.1"></times><apply id="S1.p3.3.m3.1.2.2.cmml" xref="S1.p3.3.m3.1.2.2"><csymbol cd="ambiguous" id="S1.p3.3.m3.1.2.2.1.cmml" xref="S1.p3.3.m3.1.2.2">subscript</csymbol><apply id="S1.p3.3.m3.1.2.2.2.cmml" xref="S1.p3.3.m3.1.2.2.2"><ci id="S1.p3.3.m3.1.2.2.2.1.cmml" xref="S1.p3.3.m3.1.2.2.2.1">^</ci><ci id="S1.p3.3.m3.1.2.2.2.2.cmml" xref="S1.p3.3.m3.1.2.2.2.2">𝑝</ci></apply><ci id="S1.p3.3.m3.1.2.2.3.cmml" xref="S1.p3.3.m3.1.2.2.3">𝑛</ci></apply><ci id="S1.p3.3.m3.1.1.cmml" xref="S1.p3.3.m3.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.3.m3.1c">\hat{p}_{n}(x)</annotation><annotation encoding="application/x-llamapun" id="S1.p3.3.m3.1d">over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ( italic_x )</annotation></semantics></math>, for the next data point
gradually converges to the ground truth as the context length <math alttext="n" class="ltx_Math" display="inline" id="S1.p3.4.m4.1"><semantics id="S1.p3.4.m4.1a"><mi id="S1.p3.4.m4.1.1" xref="S1.p3.4.m4.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S1.p3.4.m4.1b"><ci id="S1.p3.4.m4.1.1.cmml" xref="S1.p3.4.m4.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.4.m4.1c">n</annotation><annotation encoding="application/x-llamapun" id="S1.p3.4.m4.1d">italic_n</annotation></semantics></math> (the number of in-context data points) increases..<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Our prompts consist purely of comma-delimited multi-digit numbers, without any natural language instructions.</span></span></span></p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">To interpret the internal mechanisms <cite class="ltx_cite ltx_citemacro_citep">(Olsson et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib25" title="">2022</a>; Bietti et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib5" title="">2023</a>; Dai et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib9" title="">2023</a>; von Oswald et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib40" title="">2023</a>)</cite> underlying an LLM’s in-context DE process, we leverage Intensive Principal Component Analysis (InPCA) <cite class="ltx_cite ltx_citemacro_citep">(Teoh et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib37" title="">2020</a>; Quinn et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib28" title="">2019</a>; Mao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib24" title="">2024</a>)</cite>
to embed the estimated PDF at each context length <math alttext="\{\hat{P}_{n}\}" class="ltx_Math" display="inline" id="S1.p4.1.m1.1"><semantics id="S1.p4.1.m1.1a"><mrow id="S1.p4.1.m1.1.1.1" xref="S1.p4.1.m1.1.1.2.cmml"><mo id="S1.p4.1.m1.1.1.1.2" stretchy="false" xref="S1.p4.1.m1.1.1.2.cmml">{</mo><msub id="S1.p4.1.m1.1.1.1.1" xref="S1.p4.1.m1.1.1.1.1.cmml"><mover accent="true" id="S1.p4.1.m1.1.1.1.1.2" xref="S1.p4.1.m1.1.1.1.1.2.cmml"><mi id="S1.p4.1.m1.1.1.1.1.2.2" xref="S1.p4.1.m1.1.1.1.1.2.2.cmml">P</mi><mo id="S1.p4.1.m1.1.1.1.1.2.1" xref="S1.p4.1.m1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S1.p4.1.m1.1.1.1.1.3" xref="S1.p4.1.m1.1.1.1.1.3.cmml">n</mi></msub><mo id="S1.p4.1.m1.1.1.1.3" stretchy="false" xref="S1.p4.1.m1.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.p4.1.m1.1b"><set id="S1.p4.1.m1.1.1.2.cmml" xref="S1.p4.1.m1.1.1.1"><apply id="S1.p4.1.m1.1.1.1.1.cmml" xref="S1.p4.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S1.p4.1.m1.1.1.1.1.1.cmml" xref="S1.p4.1.m1.1.1.1.1">subscript</csymbol><apply id="S1.p4.1.m1.1.1.1.1.2.cmml" xref="S1.p4.1.m1.1.1.1.1.2"><ci id="S1.p4.1.m1.1.1.1.1.2.1.cmml" xref="S1.p4.1.m1.1.1.1.1.2.1">^</ci><ci id="S1.p4.1.m1.1.1.1.1.2.2.cmml" xref="S1.p4.1.m1.1.1.1.1.2.2">𝑃</ci></apply><ci id="S1.p4.1.m1.1.1.1.1.3.cmml" xref="S1.p4.1.m1.1.1.1.1.3">𝑛</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.1.m1.1c">\{\hat{P}_{n}\}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.1.m1.1d">{ over^ start_ARG italic_P end_ARG start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT }</annotation></semantics></math> in probability space (Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#S2.F2" title="Figure 2 ‣ Density Estimation. ‣ 2 Background ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">2</span></a>).
These visualizations reveal that the in-context DE process of these models all follow similar low-dimensional paths,
which are distinct from those of traditional density estimation methods like histograms and Gaussian kernel density estimation (KDE).</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">By studying the geometric features of these in-context DE trajectories, we identify a strong bias towards Gaussianity, which we argue is a telltale feature of
kernel-based density estimation<cite class="ltx_cite ltx_citemacro_cite">Rosenblat (<a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib31" title="">1956</a>); Wand &amp; Jones (<a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib41" title="">1994</a>); Silverman (<a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib35" title="">2018</a>)</cite>.
This observation inspires us to model LLaMA in-context DE process as a kernel density estimator with adaptive kernel.
Despite having only two parameters, kernel shape and width, this bespoke KDE model captures LLaMA’s in-context learning trajectories with high precision.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="237" id="S1.F1.g1" src="x1.png" width="664"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>In-context density estimation experiment.
LLaMA-2 is prompted with 200 numbers sampled from <math alttext="p(x)" class="ltx_Math" display="inline" id="S1.F1.3.m1.1"><semantics id="S1.F1.3.m1.1b"><mrow id="S1.F1.3.m1.1.2" xref="S1.F1.3.m1.1.2.cmml"><mi id="S1.F1.3.m1.1.2.2" xref="S1.F1.3.m1.1.2.2.cmml">p</mi><mo id="S1.F1.3.m1.1.2.1" xref="S1.F1.3.m1.1.2.1.cmml">⁢</mo><mrow id="S1.F1.3.m1.1.2.3.2" xref="S1.F1.3.m1.1.2.cmml"><mo id="S1.F1.3.m1.1.2.3.2.1" stretchy="false" xref="S1.F1.3.m1.1.2.cmml">(</mo><mi id="S1.F1.3.m1.1.1" xref="S1.F1.3.m1.1.1.cmml">x</mi><mo id="S1.F1.3.m1.1.2.3.2.2" stretchy="false" xref="S1.F1.3.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.F1.3.m1.1c"><apply id="S1.F1.3.m1.1.2.cmml" xref="S1.F1.3.m1.1.2"><times id="S1.F1.3.m1.1.2.1.cmml" xref="S1.F1.3.m1.1.2.1"></times><ci id="S1.F1.3.m1.1.2.2.cmml" xref="S1.F1.3.m1.1.2.2">𝑝</ci><ci id="S1.F1.3.m1.1.1.cmml" xref="S1.F1.3.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.3.m1.1d">p(x)</annotation><annotation encoding="application/x-llamapun" id="S1.F1.3.m1.1e">italic_p ( italic_x )</annotation></semantics></math> (left in red) (Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.SS7" title="A.7 Randomly generated PDFs ‣ Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">A.7</span></a>),
and predicts the PDF <math alttext="\hat{p}(x)" class="ltx_Math" display="inline" id="S1.F1.4.m2.1"><semantics id="S1.F1.4.m2.1b"><mrow id="S1.F1.4.m2.1.2" xref="S1.F1.4.m2.1.2.cmml"><mover accent="true" id="S1.F1.4.m2.1.2.2" xref="S1.F1.4.m2.1.2.2.cmml"><mi id="S1.F1.4.m2.1.2.2.2" xref="S1.F1.4.m2.1.2.2.2.cmml">p</mi><mo id="S1.F1.4.m2.1.2.2.1" xref="S1.F1.4.m2.1.2.2.1.cmml">^</mo></mover><mo id="S1.F1.4.m2.1.2.1" xref="S1.F1.4.m2.1.2.1.cmml">⁢</mo><mrow id="S1.F1.4.m2.1.2.3.2" xref="S1.F1.4.m2.1.2.cmml"><mo id="S1.F1.4.m2.1.2.3.2.1" stretchy="false" xref="S1.F1.4.m2.1.2.cmml">(</mo><mi id="S1.F1.4.m2.1.1" xref="S1.F1.4.m2.1.1.cmml">x</mi><mo id="S1.F1.4.m2.1.2.3.2.2" stretchy="false" xref="S1.F1.4.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.F1.4.m2.1c"><apply id="S1.F1.4.m2.1.2.cmml" xref="S1.F1.4.m2.1.2"><times id="S1.F1.4.m2.1.2.1.cmml" xref="S1.F1.4.m2.1.2.1"></times><apply id="S1.F1.4.m2.1.2.2.cmml" xref="S1.F1.4.m2.1.2.2"><ci id="S1.F1.4.m2.1.2.2.1.cmml" xref="S1.F1.4.m2.1.2.2.1">^</ci><ci id="S1.F1.4.m2.1.2.2.2.cmml" xref="S1.F1.4.m2.1.2.2.2">𝑝</ci></apply><ci id="S1.F1.4.m2.1.1.cmml" xref="S1.F1.4.m2.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.4.m2.1d">\hat{p}(x)</annotation><annotation encoding="application/x-llamapun" id="S1.F1.4.m2.1e">over^ start_ARG italic_p end_ARG ( italic_x )</annotation></semantics></math> (right in blue) for the next number.</figcaption>
</figure>
<section class="ltx_paragraph" id="S1.SS0.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Main contributions.</h5>
<div class="ltx_para ltx_noindent" id="S1.SS0.SSS0.Px1.p1">
<ol class="ltx_enumerate" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We introduce a framework for probing an LLM’s ability to estimate unconditioned PDFs from in-context data.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We apply InPCA to analyze the low-dimensional geometric features of LLaMA-2’s in-context density estimation trajectories.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para ltx_noindent" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">We interpret LLaMA-2’s in-context DE algorithm as a form of adaptive kernel density estimation,
providing evidence for a dispersive induction head mechanism <cite class="ltx_cite ltx_citemacro_citep">(Olsson et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib25" title="">2022</a>; Akyürek et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib2" title="">2024</a>)</cite>.</p>
</div>
</li>
</ol>
</div>
</section>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Background</h2>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">In-context learning of stochastic dynamical systems.</h5>
<div class="ltx_para ltx_noindent" id="S2.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px1.p1.1"><cite class="ltx_cite ltx_citemacro_cite">Gruver et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib13" title="">2024</a>)</cite> pioneered LLM-based time-series prediction by prompting LLMs with time-series data serialized as comma-delimited, multi-digit numbers. They observed competitive predictions for future states encoded as softmax probabilities.
Their data serialization scheme proved simple yet effective, allowing for easy log-likelihood evaluation of predicted next numbers.
It has since become a common prompting method <cite class="ltx_cite ltx_citemacro_citep">(Jin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib19" title="">2024</a>; Requeima et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib30" title="">2024</a>; Zhang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib44" title="">2024</a>; Liu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib22" title="">2024</a>)</cite> for evaluating LLMs’ numerical abilities.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS0.SSS0.Px1.p2">
<p class="ltx_p" id="S2.SS0.SSS0.Px1.p2.2">Building on this prompting technique, <cite class="ltx_cite ltx_citemacro_cite">Liu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib22" title="">2024</a>)</cite> tested LLMs’ ability to in-context learn the transition rules of various stochastic and chaotic dynamical systems.
They introduced a recursive algorithm, termed Hierarchy-PDF, to extract an LLM’s predicted PDF for the next data point based on histories observed in-context:
<math alttext="\hat{p}(x_{t}|X_{0},\dots,X_{t-1})" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p2.1.m1.2"><semantics id="S2.SS0.SSS0.Px1.p2.1.m1.2a"><mrow id="S2.SS0.SSS0.Px1.p2.1.m1.2.2" xref="S2.SS0.SSS0.Px1.p2.1.m1.2.2.cmml"><mover accent="true" id="S2.SS0.SSS0.Px1.p2.1.m1.2.2.3" xref="S2.SS0.SSS0.Px1.p2.1.m1.2.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.p2.1.m1.2.2.3.2" xref="S2.SS0.SSS0.Px1.p2.1.m1.2.2.3.2.cmml">p</mi><mo id="S2.SS0.SSS0.Px1.p2.1.m1.2.2.3.1" xref="S2.SS0.SSS0.Px1.p2.1.m1.2.2.3.1.cmml">^</mo></mover><mo id="S2.SS0.SSS0.Px1.p2.1.m1.2.2.2" xref="S2.SS0.SSS0.Px1.p2.1.m1.2.2.2.cmml">⁢</mo><mrow id="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1" xref="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.cmml"><mo id="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.2" stretchy="false" xref="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.cmml">(</mo><mrow id="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1" xref="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.cmml"><msub id="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.4" xref="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.4.cmml"><mi id="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.4.2" xref="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.4.2.cmml">x</mi><mi id="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.4.3" xref="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.4.3.cmml">t</mi></msub><mo fence="false" id="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.3" xref="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.3.cmml">|</mo><mrow id="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.2" xref="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.3.cmml"><msub id="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.1.1.1" xref="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.1.1.1.2" xref="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.1.1.1.2.cmml">X</mi><mn id="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.1.1.1.3" xref="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.2.3" xref="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.3.cmml">,</mo><mi id="S2.SS0.SSS0.Px1.p2.1.m1.1.1" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p2.1.m1.1.1.cmml">…</mi><mo id="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.2.4" xref="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.3.cmml">,</mo><msub id="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.2.2" xref="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.2.2.cmml"><mi id="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.2.2.2" xref="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.2.2.2.cmml">X</mi><mrow id="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.2.2.3" xref="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.2.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.2.2.3.2" xref="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.2.2.3.2.cmml">t</mi><mo id="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.2.2.3.1" xref="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.2.2.3.1.cmml">−</mo><mn id="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.2.2.3.3" xref="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.2.2.3.3.cmml">1</mn></mrow></msub></mrow></mrow><mo id="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.3" stretchy="false" xref="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p2.1.m1.2b"><apply id="S2.SS0.SSS0.Px1.p2.1.m1.2.2.cmml" xref="S2.SS0.SSS0.Px1.p2.1.m1.2.2"><times id="S2.SS0.SSS0.Px1.p2.1.m1.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.p2.1.m1.2.2.2"></times><apply id="S2.SS0.SSS0.Px1.p2.1.m1.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.p2.1.m1.2.2.3"><ci id="S2.SS0.SSS0.Px1.p2.1.m1.2.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.p2.1.m1.2.2.3.1">^</ci><ci id="S2.SS0.SSS0.Px1.p2.1.m1.2.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.p2.1.m1.2.2.3.2">𝑝</ci></apply><apply id="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1"><csymbol cd="latexml" id="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.3">conditional</csymbol><apply id="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.4.cmml" xref="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.4"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.4.1.cmml" xref="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.4">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.4.2.cmml" xref="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.4.2">𝑥</ci><ci id="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.4.3.cmml" xref="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.4.3">𝑡</ci></apply><list id="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.3.cmml" xref="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.2"><apply id="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.1.1.1.2">𝑋</ci><cn id="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.1.1.1.3">0</cn></apply><ci id="S2.SS0.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p2.1.m1.1.1">…</ci><apply id="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.2.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.2.2.2">𝑋</ci><apply id="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.2.2.3"><minus id="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.2.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.2.2.3.1"></minus><ci id="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.2.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.2.2.3.2">𝑡</ci><cn id="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.2.2.3.3.cmml" type="integer" xref="S2.SS0.SSS0.Px1.p2.1.m1.2.2.1.1.1.2.2.2.3.3">1</cn></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p2.1.m1.2c">\hat{p}(x_{t}|X_{0},\dots,X_{t-1})</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p2.1.m1.2d">over^ start_ARG italic_p end_ARG ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_X start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , … , italic_X start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT )</annotation></semantics></math>. This allowed them to rigorously compare the predicted PDF against the ground-truth transition probability <math alttext="p(x_{t}|x_{t-1})" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p2.2.m2.1"><semantics id="S2.SS0.SSS0.Px1.p2.2.m2.1a"><mrow id="S2.SS0.SSS0.Px1.p2.2.m2.1.1" xref="S2.SS0.SSS0.Px1.p2.2.m2.1.1.cmml"><mi id="S2.SS0.SSS0.Px1.p2.2.m2.1.1.3" xref="S2.SS0.SSS0.Px1.p2.2.m2.1.1.3.cmml">p</mi><mo id="S2.SS0.SSS0.Px1.p2.2.m2.1.1.2" xref="S2.SS0.SSS0.Px1.p2.2.m2.1.1.2.cmml">⁢</mo><mrow id="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1" xref="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.cmml"><mo id="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.2" stretchy="false" xref="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1" xref="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.cmml"><msub id="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.2" xref="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.2.cmml"><mi id="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.2.2" xref="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.2.2.cmml">x</mi><mi id="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.2.3" xref="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.1" xref="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.1.cmml">|</mo><msub id="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.3" xref="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.3.cmml"><mi id="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.3.2" xref="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.3.3" xref="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.3.3.cmml"><mi id="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.3.3.2" xref="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.3.3.1" xref="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.3.3.3" xref="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.3" stretchy="false" xref="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p2.2.m2.1b"><apply id="S2.SS0.SSS0.Px1.p2.2.m2.1.1.cmml" xref="S2.SS0.SSS0.Px1.p2.2.m2.1.1"><times id="S2.SS0.SSS0.Px1.p2.2.m2.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p2.2.m2.1.1.2"></times><ci id="S2.SS0.SSS0.Px1.p2.2.m2.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p2.2.m2.1.1.3">𝑝</ci><apply id="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1"><csymbol cd="latexml" id="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.1">conditional</csymbol><apply id="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.2.1.cmml" xref="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.2.2.cmml" xref="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.2.2">𝑥</ci><ci id="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.2.3.cmml" xref="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.3">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.3.2">𝑥</ci><apply id="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.3.3.cmml" xref="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.3.3"><minus id="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.3.3.1"></minus><ci id="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.3.3.2.cmml" xref="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.3.3.2">𝑡</ci><cn id="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p2.2.m2.1c">p(x_{t}|x_{t-1})</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p2.2.m2.1d">italic_p ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_x start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT )</annotation></semantics></math>.
Our work leverages the data serialization technique proposed by <cite class="ltx_cite ltx_citemacro_cite">Gruver et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib13" title="">2024</a>)</cite> and extracts LLMs’ probabilistic predictions using the Hierarchy-PDF algorithm introduced by <cite class="ltx_cite ltx_citemacro_cite">Liu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib22" title="">2024</a>)</cite>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Density Estimation.</h5>
<div class="ltx_para ltx_noindent" id="S2.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px2.p1.3">DE <cite class="ltx_cite ltx_citemacro_citep">(Izenman, <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib17" title="">1991</a>)</cite> is a long-standing statistical problem with both classical <cite class="ltx_cite ltx_citemacro_citep">(Silverman, <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib35" title="">2018</a>; Rosenblat, <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib31" title="">1956</a>; Scott, <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib32" title="">1979</a>; Lugosi &amp; Nobel, <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib23" title="">1996</a>; Parzen, <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib27" title="">1962</a>)</cite>
and modern machine-learned based solutions <cite class="ltx_cite ltx_citemacro_cite">Papamakarios et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib26" title="">2021</a>); Sohl-Dickstein et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib36" title="">2015</a>)</cite>.
It underlies the learning of more complex stochastic processes.
For example, in the first-order Markov process studied in <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib22" title="">2024</a>; Bigelow et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib6" title="">2024</a>; Zekri et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib43" title="">2024</a>)</cite>,
the transition probability <math alttext="p(x_{t}|x_{t-1})" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px2.p1.1.m1.1"><semantics id="S2.SS0.SSS0.Px2.p1.1.m1.1a"><mrow id="S2.SS0.SSS0.Px2.p1.1.m1.1.1" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.cmml">p</mi><mo id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.2" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.cmml"><mo id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.cmml"><msub id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.2" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.cmml"><mi id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.2" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.3" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.1" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.cmml">|</mo><msub id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.3" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.3.cmml"><mi id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.3.2" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.3.3" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.3.3.cmml"><mi id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.3.3.2" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.3.3.1" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.3.3.3" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p1.1.m1.1b"><apply id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1"><times id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.2"></times><ci id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3">𝑝</ci><apply id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1"><csymbol cd="latexml" id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.1.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.2.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.2">𝑥</ci><ci id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.3.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.3.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.3.2">𝑥</ci><apply id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.3.3.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.3.3"><minus id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.3.3.1.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.3.3.1"></minus><ci id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.3.3.2.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.3.3.2">𝑡</ci><cn id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p1.1.m1.1c">p(x_{t}|x_{t-1})</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px2.p1.1.m1.1d">italic_p ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_x start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT )</annotation></semantics></math> has to be estimated in-context.
This can be viewed as a conditional density estimation problem, where for each possible value of <math alttext="x_{t-1}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px2.p1.2.m2.1"><semantics id="S2.SS0.SSS0.Px2.p1.2.m2.1a"><msub id="S2.SS0.SSS0.Px2.p1.2.m2.1.1" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.cmml"><mi id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.2" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.2.cmml">x</mi><mrow id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.cmml"><mi id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.2" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.2.cmml">t</mi><mo id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.1" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.1.cmml">−</mo><mn id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.3" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p1.2.m2.1b"><apply id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.2.cmml" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.2">𝑥</ci><apply id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.cmml" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3"><minus id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.1"></minus><ci id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.2">𝑡</ci><cn id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.3.cmml" type="integer" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p1.2.m2.1c">x_{t-1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px2.p1.2.m2.1d">italic_x start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT</annotation></semantics></math>, one needs to estimate the density of <math alttext="x_{t}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px2.p1.3.m3.1"><semantics id="S2.SS0.SSS0.Px2.p1.3.m3.1a"><msub id="S2.SS0.SSS0.Px2.p1.3.m3.1.1" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.cmml"><mi id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.2" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.2.cmml">x</mi><mi id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p1.3.m3.1b"><apply id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.2.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.2">𝑥</ci><ci id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p1.3.m3.1c">x_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px2.p1.3.m3.1d">italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. In other words, learning a Markov process involves performing multiple density estimations;
one for each conditioning state.
Our current focus on unconditional density estimation thus serves as a stepping stone towards understanding these more complex learning tasks.</p>
</div>
<figure class="ltx_figure" id="S2.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="853" id="S2.F2.g1" src="x2.png" width="760"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span><span class="ltx_text ltx_font_bold" id="S2.F2.9.1">Visualization pipeline of LLaMA’s in-context density estimation process.</span> (a) Data points are independently sampled from a ground truth distribution (Gaussian in this example), then serialized as comma-delimited, two-digit numbers to prompt LLaMA-2 models.
(b) <span class="ltx_text ltx_font_italic" id="S2.F2.10.2">Hierarchy-PDF</span> extracts LLaMA’s estimated density function <math alttext="\hat{p}_{n}" class="ltx_Math" display="inline" id="S2.F2.4.m1.1"><semantics id="S2.F2.4.m1.1b"><msub id="S2.F2.4.m1.1.1" xref="S2.F2.4.m1.1.1.cmml"><mover accent="true" id="S2.F2.4.m1.1.1.2" xref="S2.F2.4.m1.1.1.2.cmml"><mi id="S2.F2.4.m1.1.1.2.2" xref="S2.F2.4.m1.1.1.2.2.cmml">p</mi><mo id="S2.F2.4.m1.1.1.2.1" xref="S2.F2.4.m1.1.1.2.1.cmml">^</mo></mover><mi id="S2.F2.4.m1.1.1.3" xref="S2.F2.4.m1.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S2.F2.4.m1.1c"><apply id="S2.F2.4.m1.1.1.cmml" xref="S2.F2.4.m1.1.1"><csymbol cd="ambiguous" id="S2.F2.4.m1.1.1.1.cmml" xref="S2.F2.4.m1.1.1">subscript</csymbol><apply id="S2.F2.4.m1.1.1.2.cmml" xref="S2.F2.4.m1.1.1.2"><ci id="S2.F2.4.m1.1.1.2.1.cmml" xref="S2.F2.4.m1.1.1.2.1">^</ci><ci id="S2.F2.4.m1.1.1.2.2.cmml" xref="S2.F2.4.m1.1.1.2.2">𝑝</ci></apply><ci id="S2.F2.4.m1.1.1.3.cmml" xref="S2.F2.4.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.4.m1.1d">\hat{p}_{n}</annotation><annotation encoding="application/x-llamapun" id="S2.F2.4.m1.1e">over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math> at each context length <math alttext="n" class="ltx_Math" display="inline" id="S2.F2.5.m2.1"><semantics id="S2.F2.5.m2.1b"><mi id="S2.F2.5.m2.1.1" xref="S2.F2.5.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.F2.5.m2.1c"><ci id="S2.F2.5.m2.1.1.cmml" xref="S2.F2.5.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.5.m2.1d">n</annotation><annotation encoding="application/x-llamapun" id="S2.F2.5.m2.1e">italic_n</annotation></semantics></math>. (c) InPCA reveals low-dimensional structures in density estimation trajectories, capturing 91% of pairwise Hellinger distances in 2 dimensions. Visual guides: gray - uniform PDF representing maximal ignorance, deep blue - ground truth PDF, and pink - 1D submanifold of centered Gaussians with variances ranging from <math alttext="\infty" class="ltx_Math" display="inline" id="S2.F2.6.m3.1"><semantics id="S2.F2.6.m3.1b"><mi id="S2.F2.6.m3.1.1" mathvariant="normal" xref="S2.F2.6.m3.1.1.cmml">∞</mi><annotation-xml encoding="MathML-Content" id="S2.F2.6.m3.1c"><infinity id="S2.F2.6.m3.1.1.cmml" xref="S2.F2.6.m3.1.1"></infinity></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.6.m3.1d">\infty</annotation><annotation encoding="application/x-llamapun" id="S2.F2.6.m3.1e">∞</annotation></semantics></math> to 0.
All three LLaMA-2 models exhibit similar DE trajectories, geometrically bounded between the geodesic and the Gaussian sub-manifold.
</figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methodology</h2>
<div class="ltx_para ltx_noindent" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">Here, we explain how we prompt a LLaMA-2 model to perform density estimation over in-context data, and how we extract and analyze its in-context learning trajectories with InPCA.
Our methodology consists of 5 steps, the first 3 of which are illustrated in <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#S2.F2" title="In Density Estimation. ‣ 2 Background ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.p2">
<p class="ltx_p" id="S3.p2.2"><span class="ltx_text ltx_font_bold" id="S3.p2.2.1">1. Sampling and prompt generation.</span>
Starting from a ground-truth probability density function <math alttext="p(x)" class="ltx_Math" display="inline" id="S3.p2.1.m1.1"><semantics id="S3.p2.1.m1.1a"><mrow id="S3.p2.1.m1.1.2" xref="S3.p2.1.m1.1.2.cmml"><mi id="S3.p2.1.m1.1.2.2" xref="S3.p2.1.m1.1.2.2.cmml">p</mi><mo id="S3.p2.1.m1.1.2.1" xref="S3.p2.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.p2.1.m1.1.2.3.2" xref="S3.p2.1.m1.1.2.cmml"><mo id="S3.p2.1.m1.1.2.3.2.1" stretchy="false" xref="S3.p2.1.m1.1.2.cmml">(</mo><mi id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml">x</mi><mo id="S3.p2.1.m1.1.2.3.2.2" stretchy="false" xref="S3.p2.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><apply id="S3.p2.1.m1.1.2.cmml" xref="S3.p2.1.m1.1.2"><times id="S3.p2.1.m1.1.2.1.cmml" xref="S3.p2.1.m1.1.2.1"></times><ci id="S3.p2.1.m1.1.2.2.cmml" xref="S3.p2.1.m1.1.2.2">𝑝</ci><ci id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">p(x)</annotation><annotation encoding="application/x-llamapun" id="S3.p2.1.m1.1d">italic_p ( italic_x )</annotation></semantics></math>, we generate a series of independent samples from it <math alttext="X_{0},\dots,X_{t-1}" class="ltx_Math" display="inline" id="S3.p2.2.m2.3"><semantics id="S3.p2.2.m2.3a"><mrow id="S3.p2.2.m2.3.3.2" xref="S3.p2.2.m2.3.3.3.cmml"><msub id="S3.p2.2.m2.2.2.1.1" xref="S3.p2.2.m2.2.2.1.1.cmml"><mi id="S3.p2.2.m2.2.2.1.1.2" xref="S3.p2.2.m2.2.2.1.1.2.cmml">X</mi><mn id="S3.p2.2.m2.2.2.1.1.3" xref="S3.p2.2.m2.2.2.1.1.3.cmml">0</mn></msub><mo id="S3.p2.2.m2.3.3.2.3" xref="S3.p2.2.m2.3.3.3.cmml">,</mo><mi id="S3.p2.2.m2.1.1" mathvariant="normal" xref="S3.p2.2.m2.1.1.cmml">…</mi><mo id="S3.p2.2.m2.3.3.2.4" xref="S3.p2.2.m2.3.3.3.cmml">,</mo><msub id="S3.p2.2.m2.3.3.2.2" xref="S3.p2.2.m2.3.3.2.2.cmml"><mi id="S3.p2.2.m2.3.3.2.2.2" xref="S3.p2.2.m2.3.3.2.2.2.cmml">X</mi><mrow id="S3.p2.2.m2.3.3.2.2.3" xref="S3.p2.2.m2.3.3.2.2.3.cmml"><mi id="S3.p2.2.m2.3.3.2.2.3.2" xref="S3.p2.2.m2.3.3.2.2.3.2.cmml">t</mi><mo id="S3.p2.2.m2.3.3.2.2.3.1" xref="S3.p2.2.m2.3.3.2.2.3.1.cmml">−</mo><mn id="S3.p2.2.m2.3.3.2.2.3.3" xref="S3.p2.2.m2.3.3.2.2.3.3.cmml">1</mn></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.3b"><list id="S3.p2.2.m2.3.3.3.cmml" xref="S3.p2.2.m2.3.3.2"><apply id="S3.p2.2.m2.2.2.1.1.cmml" xref="S3.p2.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S3.p2.2.m2.2.2.1.1.1.cmml" xref="S3.p2.2.m2.2.2.1.1">subscript</csymbol><ci id="S3.p2.2.m2.2.2.1.1.2.cmml" xref="S3.p2.2.m2.2.2.1.1.2">𝑋</ci><cn id="S3.p2.2.m2.2.2.1.1.3.cmml" type="integer" xref="S3.p2.2.m2.2.2.1.1.3">0</cn></apply><ci id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1">…</ci><apply id="S3.p2.2.m2.3.3.2.2.cmml" xref="S3.p2.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S3.p2.2.m2.3.3.2.2.1.cmml" xref="S3.p2.2.m2.3.3.2.2">subscript</csymbol><ci id="S3.p2.2.m2.3.3.2.2.2.cmml" xref="S3.p2.2.m2.3.3.2.2.2">𝑋</ci><apply id="S3.p2.2.m2.3.3.2.2.3.cmml" xref="S3.p2.2.m2.3.3.2.2.3"><minus id="S3.p2.2.m2.3.3.2.2.3.1.cmml" xref="S3.p2.2.m2.3.3.2.2.3.1"></minus><ci id="S3.p2.2.m2.3.3.2.2.3.2.cmml" xref="S3.p2.2.m2.3.3.2.2.3.2">𝑡</ci><cn id="S3.p2.2.m2.3.3.2.2.3.3.cmml" type="integer" xref="S3.p2.2.m2.3.3.2.2.3.3">1</cn></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.3c">X_{0},\dots,X_{t-1}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.2.m2.3d">italic_X start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , … , italic_X start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT</annotation></semantics></math>.
Consistent with <cite class="ltx_cite ltx_citemacro_cite">Gruver et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib13" title="">2024</a>)</cite>, we then serialize and tokenize this series into a text string consisting of a sequence of comma-delimited, 2-digit numbers, forming a prompt that looks like
“6 1 , 4 2 , 5 9 , … , 8 1 , 3 2 , 5 8 , ” (Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#S2.F2" title="Figure 2 ‣ Density Estimation. ‣ 2 Background ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">2</span></a> (a)).</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.p3">
<p class="ltx_p" id="S3.p3.6"><span class="ltx_text ltx_font_bold" id="S3.p3.6.1">2. Extracting estimated densities with <span class="ltx_text ltx_font_italic" id="S3.p3.6.1.1">Hierarchy-PDF</span>.</span>
Upon prompting with such a text string, we read out LLaMA’s softmax prediction over the next token,
yielding probabilities for 10 tokens (0-9)<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>The logits of all other tokens are ignored.</span></span></span>, creating a coarse,
10-bin PDF spanning <math alttext="x\in(0,100)" class="ltx_Math" display="inline" id="S3.p3.1.m1.2"><semantics id="S3.p3.1.m1.2a"><mrow id="S3.p3.1.m1.2.3" xref="S3.p3.1.m1.2.3.cmml"><mi id="S3.p3.1.m1.2.3.2" xref="S3.p3.1.m1.2.3.2.cmml">x</mi><mo id="S3.p3.1.m1.2.3.1" xref="S3.p3.1.m1.2.3.1.cmml">∈</mo><mrow id="S3.p3.1.m1.2.3.3.2" xref="S3.p3.1.m1.2.3.3.1.cmml"><mo id="S3.p3.1.m1.2.3.3.2.1" stretchy="false" xref="S3.p3.1.m1.2.3.3.1.cmml">(</mo><mn id="S3.p3.1.m1.1.1" xref="S3.p3.1.m1.1.1.cmml">0</mn><mo id="S3.p3.1.m1.2.3.3.2.2" xref="S3.p3.1.m1.2.3.3.1.cmml">,</mo><mn id="S3.p3.1.m1.2.2" xref="S3.p3.1.m1.2.2.cmml">100</mn><mo id="S3.p3.1.m1.2.3.3.2.3" stretchy="false" xref="S3.p3.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.2b"><apply id="S3.p3.1.m1.2.3.cmml" xref="S3.p3.1.m1.2.3"><in id="S3.p3.1.m1.2.3.1.cmml" xref="S3.p3.1.m1.2.3.1"></in><ci id="S3.p3.1.m1.2.3.2.cmml" xref="S3.p3.1.m1.2.3.2">𝑥</ci><interval closure="open" id="S3.p3.1.m1.2.3.3.1.cmml" xref="S3.p3.1.m1.2.3.3.2"><cn id="S3.p3.1.m1.1.1.cmml" type="integer" xref="S3.p3.1.m1.1.1">0</cn><cn id="S3.p3.1.m1.2.2.cmml" type="integer" xref="S3.p3.1.m1.2.2">100</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.2c">x\in(0,100)</annotation><annotation encoding="application/x-llamapun" id="S3.p3.1.m1.2d">italic_x ∈ ( 0 , 100 )</annotation></semantics></math>. We then read out the next token, which refines one of the tens bins by further dividing it into 10 ones bins.
This process is repeated recursively 10 times, until all bins are refined, yielding a predicted PDF for the next state <math alttext="p(x_{t})" class="ltx_Math" display="inline" id="S3.p3.2.m2.1"><semantics id="S3.p3.2.m2.1a"><mrow id="S3.p3.2.m2.1.1" xref="S3.p3.2.m2.1.1.cmml"><mi id="S3.p3.2.m2.1.1.3" xref="S3.p3.2.m2.1.1.3.cmml">p</mi><mo id="S3.p3.2.m2.1.1.2" xref="S3.p3.2.m2.1.1.2.cmml">⁢</mo><mrow id="S3.p3.2.m2.1.1.1.1" xref="S3.p3.2.m2.1.1.1.1.1.cmml"><mo id="S3.p3.2.m2.1.1.1.1.2" stretchy="false" xref="S3.p3.2.m2.1.1.1.1.1.cmml">(</mo><msub id="S3.p3.2.m2.1.1.1.1.1" xref="S3.p3.2.m2.1.1.1.1.1.cmml"><mi id="S3.p3.2.m2.1.1.1.1.1.2" xref="S3.p3.2.m2.1.1.1.1.1.2.cmml">x</mi><mi id="S3.p3.2.m2.1.1.1.1.1.3" xref="S3.p3.2.m2.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.p3.2.m2.1.1.1.1.3" stretchy="false" xref="S3.p3.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.2.m2.1b"><apply id="S3.p3.2.m2.1.1.cmml" xref="S3.p3.2.m2.1.1"><times id="S3.p3.2.m2.1.1.2.cmml" xref="S3.p3.2.m2.1.1.2"></times><ci id="S3.p3.2.m2.1.1.3.cmml" xref="S3.p3.2.m2.1.1.3">𝑝</ci><apply id="S3.p3.2.m2.1.1.1.1.1.cmml" xref="S3.p3.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.p3.2.m2.1.1.1.1.1.1.cmml" xref="S3.p3.2.m2.1.1.1.1">subscript</csymbol><ci id="S3.p3.2.m2.1.1.1.1.1.2.cmml" xref="S3.p3.2.m2.1.1.1.1.1.2">𝑥</ci><ci id="S3.p3.2.m2.1.1.1.1.1.3.cmml" xref="S3.p3.2.m2.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.2.m2.1c">p(x_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.p3.2.m2.1d">italic_p ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>, which
is a discrete PDF object consisting of <math alttext="10^{N}" class="ltx_Math" display="inline" id="S3.p3.3.m3.1"><semantics id="S3.p3.3.m3.1a"><msup id="S3.p3.3.m3.1.1" xref="S3.p3.3.m3.1.1.cmml"><mn id="S3.p3.3.m3.1.1.2" xref="S3.p3.3.m3.1.1.2.cmml">10</mn><mi id="S3.p3.3.m3.1.1.3" xref="S3.p3.3.m3.1.1.3.cmml">N</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p3.3.m3.1b"><apply id="S3.p3.3.m3.1.1.cmml" xref="S3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p3.3.m3.1.1.1.cmml" xref="S3.p3.3.m3.1.1">superscript</csymbol><cn id="S3.p3.3.m3.1.1.2.cmml" type="integer" xref="S3.p3.3.m3.1.1.2">10</cn><ci id="S3.p3.3.m3.1.1.3.cmml" xref="S3.p3.3.m3.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.3.m3.1c">10^{N}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.3.m3.1d">10 start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math> bins, where <math alttext="N" class="ltx_Math" display="inline" id="S3.p3.4.m4.1"><semantics id="S3.p3.4.m4.1a"><mi id="S3.p3.4.m4.1.1" xref="S3.p3.4.m4.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.p3.4.m4.1b"><ci id="S3.p3.4.m4.1.1.cmml" xref="S3.p3.4.m4.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.4.m4.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.p3.4.m4.1d">italic_N</annotation></semantics></math> is the number of digits used in representing each number.<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>We use the Hierarchy-PDF algorithm <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib22" title="">2024</a>)</cite>, which performs this recursive search efficiently for transformers.</span></span></span>
We interpret the extracted PDF <math alttext="\hat{p}(x_{t})" class="ltx_Math" display="inline" id="S3.p3.5.m5.1"><semantics id="S3.p3.5.m5.1a"><mrow id="S3.p3.5.m5.1.1" xref="S3.p3.5.m5.1.1.cmml"><mover accent="true" id="S3.p3.5.m5.1.1.3" xref="S3.p3.5.m5.1.1.3.cmml"><mi id="S3.p3.5.m5.1.1.3.2" xref="S3.p3.5.m5.1.1.3.2.cmml">p</mi><mo id="S3.p3.5.m5.1.1.3.1" xref="S3.p3.5.m5.1.1.3.1.cmml">^</mo></mover><mo id="S3.p3.5.m5.1.1.2" xref="S3.p3.5.m5.1.1.2.cmml">⁢</mo><mrow id="S3.p3.5.m5.1.1.1.1" xref="S3.p3.5.m5.1.1.1.1.1.cmml"><mo id="S3.p3.5.m5.1.1.1.1.2" stretchy="false" xref="S3.p3.5.m5.1.1.1.1.1.cmml">(</mo><msub id="S3.p3.5.m5.1.1.1.1.1" xref="S3.p3.5.m5.1.1.1.1.1.cmml"><mi id="S3.p3.5.m5.1.1.1.1.1.2" xref="S3.p3.5.m5.1.1.1.1.1.2.cmml">x</mi><mi id="S3.p3.5.m5.1.1.1.1.1.3" xref="S3.p3.5.m5.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.p3.5.m5.1.1.1.1.3" stretchy="false" xref="S3.p3.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.5.m5.1b"><apply id="S3.p3.5.m5.1.1.cmml" xref="S3.p3.5.m5.1.1"><times id="S3.p3.5.m5.1.1.2.cmml" xref="S3.p3.5.m5.1.1.2"></times><apply id="S3.p3.5.m5.1.1.3.cmml" xref="S3.p3.5.m5.1.1.3"><ci id="S3.p3.5.m5.1.1.3.1.cmml" xref="S3.p3.5.m5.1.1.3.1">^</ci><ci id="S3.p3.5.m5.1.1.3.2.cmml" xref="S3.p3.5.m5.1.1.3.2">𝑝</ci></apply><apply id="S3.p3.5.m5.1.1.1.1.1.cmml" xref="S3.p3.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S3.p3.5.m5.1.1.1.1.1.1.cmml" xref="S3.p3.5.m5.1.1.1.1">subscript</csymbol><ci id="S3.p3.5.m5.1.1.1.1.1.2.cmml" xref="S3.p3.5.m5.1.1.1.1.1.2">𝑥</ci><ci id="S3.p3.5.m5.1.1.1.1.1.3.cmml" xref="S3.p3.5.m5.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.5.m5.1c">\hat{p}(x_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.p3.5.m5.1d">over^ start_ARG italic_p end_ARG ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> as the LLM’s estimation of the ground-truth <math alttext="p(x)" class="ltx_Math" display="inline" id="S3.p3.6.m6.1"><semantics id="S3.p3.6.m6.1a"><mrow id="S3.p3.6.m6.1.2" xref="S3.p3.6.m6.1.2.cmml"><mi id="S3.p3.6.m6.1.2.2" xref="S3.p3.6.m6.1.2.2.cmml">p</mi><mo id="S3.p3.6.m6.1.2.1" xref="S3.p3.6.m6.1.2.1.cmml">⁢</mo><mrow id="S3.p3.6.m6.1.2.3.2" xref="S3.p3.6.m6.1.2.cmml"><mo id="S3.p3.6.m6.1.2.3.2.1" stretchy="false" xref="S3.p3.6.m6.1.2.cmml">(</mo><mi id="S3.p3.6.m6.1.1" xref="S3.p3.6.m6.1.1.cmml">x</mi><mo id="S3.p3.6.m6.1.2.3.2.2" stretchy="false" xref="S3.p3.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.6.m6.1b"><apply id="S3.p3.6.m6.1.2.cmml" xref="S3.p3.6.m6.1.2"><times id="S3.p3.6.m6.1.2.1.cmml" xref="S3.p3.6.m6.1.2.1"></times><ci id="S3.p3.6.m6.1.2.2.cmml" xref="S3.p3.6.m6.1.2.2">𝑝</ci><ci id="S3.p3.6.m6.1.1.cmml" xref="S3.p3.6.m6.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.6.m6.1c">p(x)</annotation><annotation encoding="application/x-llamapun" id="S3.p3.6.m6.1d">italic_p ( italic_x )</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.p4">
<p class="ltx_p" id="S3.p4.7"><span class="ltx_text ltx_font_bold" id="S3.p4.7.1">3. Visualizing DE trajectories with InPCA.</span>
When there are very few in-context data, LLaMA’s estimated <math alttext="\hat{p}_{0}(x)" class="ltx_Math" display="inline" id="S3.p4.1.m1.1"><semantics id="S3.p4.1.m1.1a"><mrow id="S3.p4.1.m1.1.2" xref="S3.p4.1.m1.1.2.cmml"><msub id="S3.p4.1.m1.1.2.2" xref="S3.p4.1.m1.1.2.2.cmml"><mover accent="true" id="S3.p4.1.m1.1.2.2.2" xref="S3.p4.1.m1.1.2.2.2.cmml"><mi id="S3.p4.1.m1.1.2.2.2.2" xref="S3.p4.1.m1.1.2.2.2.2.cmml">p</mi><mo id="S3.p4.1.m1.1.2.2.2.1" xref="S3.p4.1.m1.1.2.2.2.1.cmml">^</mo></mover><mn id="S3.p4.1.m1.1.2.2.3" xref="S3.p4.1.m1.1.2.2.3.cmml">0</mn></msub><mo id="S3.p4.1.m1.1.2.1" xref="S3.p4.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.p4.1.m1.1.2.3.2" xref="S3.p4.1.m1.1.2.cmml"><mo id="S3.p4.1.m1.1.2.3.2.1" stretchy="false" xref="S3.p4.1.m1.1.2.cmml">(</mo><mi id="S3.p4.1.m1.1.1" xref="S3.p4.1.m1.1.1.cmml">x</mi><mo id="S3.p4.1.m1.1.2.3.2.2" stretchy="false" xref="S3.p4.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.1.m1.1b"><apply id="S3.p4.1.m1.1.2.cmml" xref="S3.p4.1.m1.1.2"><times id="S3.p4.1.m1.1.2.1.cmml" xref="S3.p4.1.m1.1.2.1"></times><apply id="S3.p4.1.m1.1.2.2.cmml" xref="S3.p4.1.m1.1.2.2"><csymbol cd="ambiguous" id="S3.p4.1.m1.1.2.2.1.cmml" xref="S3.p4.1.m1.1.2.2">subscript</csymbol><apply id="S3.p4.1.m1.1.2.2.2.cmml" xref="S3.p4.1.m1.1.2.2.2"><ci id="S3.p4.1.m1.1.2.2.2.1.cmml" xref="S3.p4.1.m1.1.2.2.2.1">^</ci><ci id="S3.p4.1.m1.1.2.2.2.2.cmml" xref="S3.p4.1.m1.1.2.2.2.2">𝑝</ci></apply><cn id="S3.p4.1.m1.1.2.2.3.cmml" type="integer" xref="S3.p4.1.m1.1.2.2.3">0</cn></apply><ci id="S3.p4.1.m1.1.1.cmml" xref="S3.p4.1.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.1.m1.1c">\hat{p}_{0}(x)</annotation><annotation encoding="application/x-llamapun" id="S3.p4.1.m1.1d">over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_x )</annotation></semantics></math> is close to a uniform distribution over the domain <math alttext="(0,100)" class="ltx_Math" display="inline" id="S3.p4.2.m2.2"><semantics id="S3.p4.2.m2.2a"><mrow id="S3.p4.2.m2.2.3.2" xref="S3.p4.2.m2.2.3.1.cmml"><mo id="S3.p4.2.m2.2.3.2.1" stretchy="false" xref="S3.p4.2.m2.2.3.1.cmml">(</mo><mn id="S3.p4.2.m2.1.1" xref="S3.p4.2.m2.1.1.cmml">0</mn><mo id="S3.p4.2.m2.2.3.2.2" xref="S3.p4.2.m2.2.3.1.cmml">,</mo><mn id="S3.p4.2.m2.2.2" xref="S3.p4.2.m2.2.2.cmml">100</mn><mo id="S3.p4.2.m2.2.3.2.3" stretchy="false" xref="S3.p4.2.m2.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.2.m2.2b"><interval closure="open" id="S3.p4.2.m2.2.3.1.cmml" xref="S3.p4.2.m2.2.3.2"><cn id="S3.p4.2.m2.1.1.cmml" type="integer" xref="S3.p4.2.m2.1.1">0</cn><cn id="S3.p4.2.m2.2.2.cmml" type="integer" xref="S3.p4.2.m2.2.2">100</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.2.m2.2c">(0,100)</annotation><annotation encoding="application/x-llamapun" id="S3.p4.2.m2.2d">( 0 , 100 )</annotation></semantics></math>, showing a state of neutral ignorance, which is a reasonable Bayesian prior <cite class="ltx_cite ltx_citemacro_citep">(Xie et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib42" title="">2022</a>)</cite>.
However, as the number of in-context data (<math alttext="n" class="ltx_Math" display="inline" id="S3.p4.3.m3.1"><semantics id="S3.p4.3.m3.1a"><mi id="S3.p4.3.m3.1.1" xref="S3.p4.3.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.p4.3.m3.1b"><ci id="S3.p4.3.m3.1.1.cmml" xref="S3.p4.3.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.3.m3.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.p4.3.m3.1d">italic_n</annotation></semantics></math>) increases, LLaMA gathers more information about the underlying distribution.
As a result, the estimated <math alttext="\hat{p}_{n}(x)" class="ltx_Math" display="inline" id="S3.p4.4.m4.1"><semantics id="S3.p4.4.m4.1a"><mrow id="S3.p4.4.m4.1.2" xref="S3.p4.4.m4.1.2.cmml"><msub id="S3.p4.4.m4.1.2.2" xref="S3.p4.4.m4.1.2.2.cmml"><mover accent="true" id="S3.p4.4.m4.1.2.2.2" xref="S3.p4.4.m4.1.2.2.2.cmml"><mi id="S3.p4.4.m4.1.2.2.2.2" xref="S3.p4.4.m4.1.2.2.2.2.cmml">p</mi><mo id="S3.p4.4.m4.1.2.2.2.1" xref="S3.p4.4.m4.1.2.2.2.1.cmml">^</mo></mover><mi id="S3.p4.4.m4.1.2.2.3" xref="S3.p4.4.m4.1.2.2.3.cmml">n</mi></msub><mo id="S3.p4.4.m4.1.2.1" xref="S3.p4.4.m4.1.2.1.cmml">⁢</mo><mrow id="S3.p4.4.m4.1.2.3.2" xref="S3.p4.4.m4.1.2.cmml"><mo id="S3.p4.4.m4.1.2.3.2.1" stretchy="false" xref="S3.p4.4.m4.1.2.cmml">(</mo><mi id="S3.p4.4.m4.1.1" xref="S3.p4.4.m4.1.1.cmml">x</mi><mo id="S3.p4.4.m4.1.2.3.2.2" stretchy="false" xref="S3.p4.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.4.m4.1b"><apply id="S3.p4.4.m4.1.2.cmml" xref="S3.p4.4.m4.1.2"><times id="S3.p4.4.m4.1.2.1.cmml" xref="S3.p4.4.m4.1.2.1"></times><apply id="S3.p4.4.m4.1.2.2.cmml" xref="S3.p4.4.m4.1.2.2"><csymbol cd="ambiguous" id="S3.p4.4.m4.1.2.2.1.cmml" xref="S3.p4.4.m4.1.2.2">subscript</csymbol><apply id="S3.p4.4.m4.1.2.2.2.cmml" xref="S3.p4.4.m4.1.2.2.2"><ci id="S3.p4.4.m4.1.2.2.2.1.cmml" xref="S3.p4.4.m4.1.2.2.2.1">^</ci><ci id="S3.p4.4.m4.1.2.2.2.2.cmml" xref="S3.p4.4.m4.1.2.2.2.2">𝑝</ci></apply><ci id="S3.p4.4.m4.1.2.2.3.cmml" xref="S3.p4.4.m4.1.2.2.3">𝑛</ci></apply><ci id="S3.p4.4.m4.1.1.cmml" xref="S3.p4.4.m4.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.4.m4.1c">\hat{p}_{n}(x)</annotation><annotation encoding="application/x-llamapun" id="S3.p4.4.m4.1d">over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ( italic_x )</annotation></semantics></math> gradually converges to the ground truth <math alttext="p(x)" class="ltx_Math" display="inline" id="S3.p4.5.m5.1"><semantics id="S3.p4.5.m5.1a"><mrow id="S3.p4.5.m5.1.2" xref="S3.p4.5.m5.1.2.cmml"><mi id="S3.p4.5.m5.1.2.2" xref="S3.p4.5.m5.1.2.2.cmml">p</mi><mo id="S3.p4.5.m5.1.2.1" xref="S3.p4.5.m5.1.2.1.cmml">⁢</mo><mrow id="S3.p4.5.m5.1.2.3.2" xref="S3.p4.5.m5.1.2.cmml"><mo id="S3.p4.5.m5.1.2.3.2.1" stretchy="false" xref="S3.p4.5.m5.1.2.cmml">(</mo><mi id="S3.p4.5.m5.1.1" xref="S3.p4.5.m5.1.1.cmml">x</mi><mo id="S3.p4.5.m5.1.2.3.2.2" stretchy="false" xref="S3.p4.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.5.m5.1b"><apply id="S3.p4.5.m5.1.2.cmml" xref="S3.p4.5.m5.1.2"><times id="S3.p4.5.m5.1.2.1.cmml" xref="S3.p4.5.m5.1.2.1"></times><ci id="S3.p4.5.m5.1.2.2.cmml" xref="S3.p4.5.m5.1.2.2">𝑝</ci><ci id="S3.p4.5.m5.1.1.cmml" xref="S3.p4.5.m5.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.5.m5.1c">p(x)</annotation><annotation encoding="application/x-llamapun" id="S3.p4.5.m5.1d">italic_p ( italic_x )</annotation></semantics></math> (Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#S2.F2" title="Figure 2 ‣ Density Estimation. ‣ 2 Background ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">2</span></a> (b)).
The series of estimated PDFs <math alttext="\hat{p}_{0}(x),\hat{p}_{1}(x),...,\hat{p}_{n}(x)" class="ltx_Math" display="inline" id="S3.p4.6.m6.7"><semantics id="S3.p4.6.m6.7a"><mrow id="S3.p4.6.m6.7.7.3" xref="S3.p4.6.m6.7.7.4.cmml"><mrow id="S3.p4.6.m6.5.5.1.1" xref="S3.p4.6.m6.5.5.1.1.cmml"><msub id="S3.p4.6.m6.5.5.1.1.2" xref="S3.p4.6.m6.5.5.1.1.2.cmml"><mover accent="true" id="S3.p4.6.m6.5.5.1.1.2.2" xref="S3.p4.6.m6.5.5.1.1.2.2.cmml"><mi id="S3.p4.6.m6.5.5.1.1.2.2.2" xref="S3.p4.6.m6.5.5.1.1.2.2.2.cmml">p</mi><mo id="S3.p4.6.m6.5.5.1.1.2.2.1" xref="S3.p4.6.m6.5.5.1.1.2.2.1.cmml">^</mo></mover><mn id="S3.p4.6.m6.5.5.1.1.2.3" xref="S3.p4.6.m6.5.5.1.1.2.3.cmml">0</mn></msub><mo id="S3.p4.6.m6.5.5.1.1.1" xref="S3.p4.6.m6.5.5.1.1.1.cmml">⁢</mo><mrow id="S3.p4.6.m6.5.5.1.1.3.2" xref="S3.p4.6.m6.5.5.1.1.cmml"><mo id="S3.p4.6.m6.5.5.1.1.3.2.1" stretchy="false" xref="S3.p4.6.m6.5.5.1.1.cmml">(</mo><mi id="S3.p4.6.m6.1.1" xref="S3.p4.6.m6.1.1.cmml">x</mi><mo id="S3.p4.6.m6.5.5.1.1.3.2.2" stretchy="false" xref="S3.p4.6.m6.5.5.1.1.cmml">)</mo></mrow></mrow><mo id="S3.p4.6.m6.7.7.3.4" xref="S3.p4.6.m6.7.7.4.cmml">,</mo><mrow id="S3.p4.6.m6.6.6.2.2" xref="S3.p4.6.m6.6.6.2.2.cmml"><msub id="S3.p4.6.m6.6.6.2.2.2" xref="S3.p4.6.m6.6.6.2.2.2.cmml"><mover accent="true" id="S3.p4.6.m6.6.6.2.2.2.2" xref="S3.p4.6.m6.6.6.2.2.2.2.cmml"><mi id="S3.p4.6.m6.6.6.2.2.2.2.2" xref="S3.p4.6.m6.6.6.2.2.2.2.2.cmml">p</mi><mo id="S3.p4.6.m6.6.6.2.2.2.2.1" xref="S3.p4.6.m6.6.6.2.2.2.2.1.cmml">^</mo></mover><mn id="S3.p4.6.m6.6.6.2.2.2.3" xref="S3.p4.6.m6.6.6.2.2.2.3.cmml">1</mn></msub><mo id="S3.p4.6.m6.6.6.2.2.1" xref="S3.p4.6.m6.6.6.2.2.1.cmml">⁢</mo><mrow id="S3.p4.6.m6.6.6.2.2.3.2" xref="S3.p4.6.m6.6.6.2.2.cmml"><mo id="S3.p4.6.m6.6.6.2.2.3.2.1" stretchy="false" xref="S3.p4.6.m6.6.6.2.2.cmml">(</mo><mi id="S3.p4.6.m6.2.2" xref="S3.p4.6.m6.2.2.cmml">x</mi><mo id="S3.p4.6.m6.6.6.2.2.3.2.2" stretchy="false" xref="S3.p4.6.m6.6.6.2.2.cmml">)</mo></mrow></mrow><mo id="S3.p4.6.m6.7.7.3.5" xref="S3.p4.6.m6.7.7.4.cmml">,</mo><mi id="S3.p4.6.m6.4.4" mathvariant="normal" xref="S3.p4.6.m6.4.4.cmml">…</mi><mo id="S3.p4.6.m6.7.7.3.6" xref="S3.p4.6.m6.7.7.4.cmml">,</mo><mrow id="S3.p4.6.m6.7.7.3.3" xref="S3.p4.6.m6.7.7.3.3.cmml"><msub id="S3.p4.6.m6.7.7.3.3.2" xref="S3.p4.6.m6.7.7.3.3.2.cmml"><mover accent="true" id="S3.p4.6.m6.7.7.3.3.2.2" xref="S3.p4.6.m6.7.7.3.3.2.2.cmml"><mi id="S3.p4.6.m6.7.7.3.3.2.2.2" xref="S3.p4.6.m6.7.7.3.3.2.2.2.cmml">p</mi><mo id="S3.p4.6.m6.7.7.3.3.2.2.1" xref="S3.p4.6.m6.7.7.3.3.2.2.1.cmml">^</mo></mover><mi id="S3.p4.6.m6.7.7.3.3.2.3" xref="S3.p4.6.m6.7.7.3.3.2.3.cmml">n</mi></msub><mo id="S3.p4.6.m6.7.7.3.3.1" xref="S3.p4.6.m6.7.7.3.3.1.cmml">⁢</mo><mrow id="S3.p4.6.m6.7.7.3.3.3.2" xref="S3.p4.6.m6.7.7.3.3.cmml"><mo id="S3.p4.6.m6.7.7.3.3.3.2.1" stretchy="false" xref="S3.p4.6.m6.7.7.3.3.cmml">(</mo><mi id="S3.p4.6.m6.3.3" xref="S3.p4.6.m6.3.3.cmml">x</mi><mo id="S3.p4.6.m6.7.7.3.3.3.2.2" stretchy="false" xref="S3.p4.6.m6.7.7.3.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.6.m6.7b"><list id="S3.p4.6.m6.7.7.4.cmml" xref="S3.p4.6.m6.7.7.3"><apply id="S3.p4.6.m6.5.5.1.1.cmml" xref="S3.p4.6.m6.5.5.1.1"><times id="S3.p4.6.m6.5.5.1.1.1.cmml" xref="S3.p4.6.m6.5.5.1.1.1"></times><apply id="S3.p4.6.m6.5.5.1.1.2.cmml" xref="S3.p4.6.m6.5.5.1.1.2"><csymbol cd="ambiguous" id="S3.p4.6.m6.5.5.1.1.2.1.cmml" xref="S3.p4.6.m6.5.5.1.1.2">subscript</csymbol><apply id="S3.p4.6.m6.5.5.1.1.2.2.cmml" xref="S3.p4.6.m6.5.5.1.1.2.2"><ci id="S3.p4.6.m6.5.5.1.1.2.2.1.cmml" xref="S3.p4.6.m6.5.5.1.1.2.2.1">^</ci><ci id="S3.p4.6.m6.5.5.1.1.2.2.2.cmml" xref="S3.p4.6.m6.5.5.1.1.2.2.2">𝑝</ci></apply><cn id="S3.p4.6.m6.5.5.1.1.2.3.cmml" type="integer" xref="S3.p4.6.m6.5.5.1.1.2.3">0</cn></apply><ci id="S3.p4.6.m6.1.1.cmml" xref="S3.p4.6.m6.1.1">𝑥</ci></apply><apply id="S3.p4.6.m6.6.6.2.2.cmml" xref="S3.p4.6.m6.6.6.2.2"><times id="S3.p4.6.m6.6.6.2.2.1.cmml" xref="S3.p4.6.m6.6.6.2.2.1"></times><apply id="S3.p4.6.m6.6.6.2.2.2.cmml" xref="S3.p4.6.m6.6.6.2.2.2"><csymbol cd="ambiguous" id="S3.p4.6.m6.6.6.2.2.2.1.cmml" xref="S3.p4.6.m6.6.6.2.2.2">subscript</csymbol><apply id="S3.p4.6.m6.6.6.2.2.2.2.cmml" xref="S3.p4.6.m6.6.6.2.2.2.2"><ci id="S3.p4.6.m6.6.6.2.2.2.2.1.cmml" xref="S3.p4.6.m6.6.6.2.2.2.2.1">^</ci><ci id="S3.p4.6.m6.6.6.2.2.2.2.2.cmml" xref="S3.p4.6.m6.6.6.2.2.2.2.2">𝑝</ci></apply><cn id="S3.p4.6.m6.6.6.2.2.2.3.cmml" type="integer" xref="S3.p4.6.m6.6.6.2.2.2.3">1</cn></apply><ci id="S3.p4.6.m6.2.2.cmml" xref="S3.p4.6.m6.2.2">𝑥</ci></apply><ci id="S3.p4.6.m6.4.4.cmml" xref="S3.p4.6.m6.4.4">…</ci><apply id="S3.p4.6.m6.7.7.3.3.cmml" xref="S3.p4.6.m6.7.7.3.3"><times id="S3.p4.6.m6.7.7.3.3.1.cmml" xref="S3.p4.6.m6.7.7.3.3.1"></times><apply id="S3.p4.6.m6.7.7.3.3.2.cmml" xref="S3.p4.6.m6.7.7.3.3.2"><csymbol cd="ambiguous" id="S3.p4.6.m6.7.7.3.3.2.1.cmml" xref="S3.p4.6.m6.7.7.3.3.2">subscript</csymbol><apply id="S3.p4.6.m6.7.7.3.3.2.2.cmml" xref="S3.p4.6.m6.7.7.3.3.2.2"><ci id="S3.p4.6.m6.7.7.3.3.2.2.1.cmml" xref="S3.p4.6.m6.7.7.3.3.2.2.1">^</ci><ci id="S3.p4.6.m6.7.7.3.3.2.2.2.cmml" xref="S3.p4.6.m6.7.7.3.3.2.2.2">𝑝</ci></apply><ci id="S3.p4.6.m6.7.7.3.3.2.3.cmml" xref="S3.p4.6.m6.7.7.3.3.2.3">𝑛</ci></apply><ci id="S3.p4.6.m6.3.3.cmml" xref="S3.p4.6.m6.3.3">𝑥</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.6.m6.7c">\hat{p}_{0}(x),\hat{p}_{1}(x),...,\hat{p}_{n}(x)</annotation><annotation encoding="application/x-llamapun" id="S3.p4.6.m6.7d">over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_x ) , over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_x ) , … , over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ( italic_x )</annotation></semantics></math> over context length <math alttext="n" class="ltx_Math" display="inline" id="S3.p4.7.m7.1"><semantics id="S3.p4.7.m7.1a"><mi id="S3.p4.7.m7.1.1" xref="S3.p4.7.m7.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.p4.7.m7.1b"><ci id="S3.p4.7.m7.1.1.cmml" xref="S3.p4.7.m7.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.7.m7.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.p4.7.m7.1d">italic_n</annotation></semantics></math> forms what we term the "in-context DE trajectory".
These trajectories, we argue, offer important clues about how LLaMA-2 performs in-context learning.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.p5">
<p class="ltx_p" id="S3.p5.1">However, with our 2-digit representation, each <math alttext="\hat{p}(x)" class="ltx_Math" display="inline" id="S3.p5.1.m1.1"><semantics id="S3.p5.1.m1.1a"><mrow id="S3.p5.1.m1.1.2" xref="S3.p5.1.m1.1.2.cmml"><mover accent="true" id="S3.p5.1.m1.1.2.2" xref="S3.p5.1.m1.1.2.2.cmml"><mi id="S3.p5.1.m1.1.2.2.2" xref="S3.p5.1.m1.1.2.2.2.cmml">p</mi><mo id="S3.p5.1.m1.1.2.2.1" xref="S3.p5.1.m1.1.2.2.1.cmml">^</mo></mover><mo id="S3.p5.1.m1.1.2.1" xref="S3.p5.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.p5.1.m1.1.2.3.2" xref="S3.p5.1.m1.1.2.cmml"><mo id="S3.p5.1.m1.1.2.3.2.1" stretchy="false" xref="S3.p5.1.m1.1.2.cmml">(</mo><mi id="S3.p5.1.m1.1.1" xref="S3.p5.1.m1.1.1.cmml">x</mi><mo id="S3.p5.1.m1.1.2.3.2.2" stretchy="false" xref="S3.p5.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p5.1.m1.1b"><apply id="S3.p5.1.m1.1.2.cmml" xref="S3.p5.1.m1.1.2"><times id="S3.p5.1.m1.1.2.1.cmml" xref="S3.p5.1.m1.1.2.1"></times><apply id="S3.p5.1.m1.1.2.2.cmml" xref="S3.p5.1.m1.1.2.2"><ci id="S3.p5.1.m1.1.2.2.1.cmml" xref="S3.p5.1.m1.1.2.2.1">^</ci><ci id="S3.p5.1.m1.1.2.2.2.cmml" xref="S3.p5.1.m1.1.2.2.2">𝑝</ci></apply><ci id="S3.p5.1.m1.1.1.cmml" xref="S3.p5.1.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.1.m1.1c">\hat{p}(x)</annotation><annotation encoding="application/x-llamapun" id="S3.p5.1.m1.1d">over^ start_ARG italic_p end_ARG ( italic_x )</annotation></semantics></math> is a vector living in a 99-dimensional space<span class="ltx_note ltx_role_footnote" id="footnote4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span><math alttext="10^{2}-1" class="ltx_Math" display="inline" id="footnote4.m1.1"><semantics id="footnote4.m1.1b"><mrow id="footnote4.m1.1.1" xref="footnote4.m1.1.1.cmml"><msup id="footnote4.m1.1.1.2" xref="footnote4.m1.1.1.2.cmml"><mn id="footnote4.m1.1.1.2.2" xref="footnote4.m1.1.1.2.2.cmml">10</mn><mn id="footnote4.m1.1.1.2.3" xref="footnote4.m1.1.1.2.3.cmml">2</mn></msup><mo id="footnote4.m1.1.1.1" xref="footnote4.m1.1.1.1.cmml">−</mo><mn id="footnote4.m1.1.1.3" xref="footnote4.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="footnote4.m1.1c"><apply id="footnote4.m1.1.1.cmml" xref="footnote4.m1.1.1"><minus id="footnote4.m1.1.1.1.cmml" xref="footnote4.m1.1.1.1"></minus><apply id="footnote4.m1.1.1.2.cmml" xref="footnote4.m1.1.1.2"><csymbol cd="ambiguous" id="footnote4.m1.1.1.2.1.cmml" xref="footnote4.m1.1.1.2">superscript</csymbol><cn id="footnote4.m1.1.1.2.2.cmml" type="integer" xref="footnote4.m1.1.1.2.2">10</cn><cn id="footnote4.m1.1.1.2.3.cmml" type="integer" xref="footnote4.m1.1.1.2.3">2</cn></apply><cn id="footnote4.m1.1.1.3.cmml" type="integer" xref="footnote4.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote4.m1.1d">10^{2}-1</annotation><annotation encoding="application/x-llamapun" id="footnote4.m1.1e">10 start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT - 1</annotation></semantics></math>, where the <math alttext="-1" class="ltx_Math" display="inline" id="footnote4.m2.1"><semantics id="footnote4.m2.1b"><mrow id="footnote4.m2.1.1" xref="footnote4.m2.1.1.cmml"><mo id="footnote4.m2.1.1b" xref="footnote4.m2.1.1.cmml">−</mo><mn id="footnote4.m2.1.1.2" xref="footnote4.m2.1.1.2.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="footnote4.m2.1c"><apply id="footnote4.m2.1.1.cmml" xref="footnote4.m2.1.1"><minus id="footnote4.m2.1.1.1.cmml" xref="footnote4.m2.1.1"></minus><cn id="footnote4.m2.1.1.2.cmml" type="integer" xref="footnote4.m2.1.1.2">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote4.m2.1d">-1</annotation><annotation encoding="application/x-llamapun" id="footnote4.m2.1e">- 1</annotation></semantics></math> dimension is from the normalization constraint that <math alttext="\int p(x)dx=1" class="ltx_Math" display="inline" id="footnote4.m3.1"><semantics id="footnote4.m3.1b"><mrow id="footnote4.m3.1.2" xref="footnote4.m3.1.2.cmml"><mrow id="footnote4.m3.1.2.2" xref="footnote4.m3.1.2.2.cmml"><mo id="footnote4.m3.1.2.2.1" xref="footnote4.m3.1.2.2.1.cmml">∫</mo><mrow id="footnote4.m3.1.2.2.2" xref="footnote4.m3.1.2.2.2.cmml"><mi id="footnote4.m3.1.2.2.2.2" xref="footnote4.m3.1.2.2.2.2.cmml">p</mi><mo id="footnote4.m3.1.2.2.2.1" xref="footnote4.m3.1.2.2.2.1.cmml">⁢</mo><mrow id="footnote4.m3.1.2.2.2.3.2" xref="footnote4.m3.1.2.2.2.cmml"><mo id="footnote4.m3.1.2.2.2.3.2.1" stretchy="false" xref="footnote4.m3.1.2.2.2.cmml">(</mo><mi id="footnote4.m3.1.1" xref="footnote4.m3.1.1.cmml">x</mi><mo id="footnote4.m3.1.2.2.2.3.2.2" stretchy="false" xref="footnote4.m3.1.2.2.2.cmml">)</mo></mrow><mo id="footnote4.m3.1.2.2.2.1b" lspace="0em" xref="footnote4.m3.1.2.2.2.1.cmml">⁢</mo><mrow id="footnote4.m3.1.2.2.2.4" xref="footnote4.m3.1.2.2.2.4.cmml"><mo id="footnote4.m3.1.2.2.2.4.1" rspace="0em" xref="footnote4.m3.1.2.2.2.4.1.cmml">𝑑</mo><mi id="footnote4.m3.1.2.2.2.4.2" xref="footnote4.m3.1.2.2.2.4.2.cmml">x</mi></mrow></mrow></mrow><mo id="footnote4.m3.1.2.1" xref="footnote4.m3.1.2.1.cmml">=</mo><mn id="footnote4.m3.1.2.3" xref="footnote4.m3.1.2.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="footnote4.m3.1c"><apply id="footnote4.m3.1.2.cmml" xref="footnote4.m3.1.2"><eq id="footnote4.m3.1.2.1.cmml" xref="footnote4.m3.1.2.1"></eq><apply id="footnote4.m3.1.2.2.cmml" xref="footnote4.m3.1.2.2"><int id="footnote4.m3.1.2.2.1.cmml" xref="footnote4.m3.1.2.2.1"></int><apply id="footnote4.m3.1.2.2.2.cmml" xref="footnote4.m3.1.2.2.2"><times id="footnote4.m3.1.2.2.2.1.cmml" xref="footnote4.m3.1.2.2.2.1"></times><ci id="footnote4.m3.1.2.2.2.2.cmml" xref="footnote4.m3.1.2.2.2.2">𝑝</ci><ci id="footnote4.m3.1.1.cmml" xref="footnote4.m3.1.1">𝑥</ci><apply id="footnote4.m3.1.2.2.2.4.cmml" xref="footnote4.m3.1.2.2.2.4"><csymbol cd="latexml" id="footnote4.m3.1.2.2.2.4.1.cmml" xref="footnote4.m3.1.2.2.2.4.1">differential-d</csymbol><ci id="footnote4.m3.1.2.2.2.4.2.cmml" xref="footnote4.m3.1.2.2.2.4.2">𝑥</ci></apply></apply></apply><cn id="footnote4.m3.1.2.3.cmml" type="integer" xref="footnote4.m3.1.2.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote4.m3.1d">\int p(x)dx=1</annotation><annotation encoding="application/x-llamapun" id="footnote4.m3.1e">∫ italic_p ( italic_x ) italic_d italic_x = 1</annotation></semantics></math>.</span></span></span>,
making direct analysis of the trajectory challenging.
We therefore use InPCA to embed these PDF objects into a low-dimensional Euclidean space (Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#S2.F2" title="Figure 2 ‣ Density Estimation. ‣ 2 Background ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">2</span></a> (c)), and then analyze their geometric features.<span class="ltx_note ltx_role_footnote" id="footnote5"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span>The idea of using InPCA to visualize the training dynamics of machine learning systems has been explored in <cite class="ltx_cite ltx_citemacro_cite">Quinn et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib28" title="">2019</a>); Mao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib24" title="">2024</a>)</cite>, which is further discussed in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.SS2" title="A.2 Low-dimensional structures in learning dynamics. ‣ Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">A.2</span></a></span></span></span></p>
</div>
<div class="ltx_para ltx_noindent" id="S3.p6">
<p class="ltx_p" id="S3.p6.1"><span class="ltx_text ltx_font_bold" id="S3.p6.1.1">4. Comparing with classical DE algorithms.</span>
To interpret the low-dimensional geometric features revealed by InPCA, we embed the DE trajectories of well-known algorithms — specifically, kernel density estimator (KDE) and Bayesian histograms — in the same two-dimensional (2D) space.
Surprisingly, we find that the DE trajectories of LLaMA-2, KDE, and Bayesian histograms are simultaneously embeddable in this same low-dimensional subspace.
Moreover, the DE trajectories of LLaMA-2 are geometrically bounded between those of KDE and Bayesian histograms.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.p7">
<p class="ltx_p" id="S3.p7.1"><span class="ltx_text ltx_font_bold" id="S3.p7.1.1">5. Explaining LLaMA-2 with bespoke KDE.</span>
We observe that LLaMA’s in-context DE trajectories consistently remain close to those of KDE, suggesting that LLaMA might be employing a kernel-like algorithm, internally.
To investigate this hypothesis, we optimize a KDE algorithm with fitted kernel parameters (using only two parameters).</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.p8">
<p class="ltx_p" id="S3.p8.1">We now provide a detailed explanation of how to apply InPCA to analyze in-context DE trajectories.
We will also introduce two classical DE algorithms that serve as insightful comparisons.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>InPCA visualization</h3>
<div class="ltx_para ltx_noindent" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.4">To visualize the density estimation (DE) trajectories of various algorithms in a lower-dimensional space,
we employ Intensive Principal Component Analysis (InPCA) <cite class="ltx_cite ltx_citemacro_citep">(Quinn et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib28" title="">2019</a>; Mao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib24" title="">2024</a>; Teoh et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib37" title="">2020</a>)</cite>.
Given a set of PDFs <math alttext="\{p_{i}\}_{i=1}^{m}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><msubsup id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mrow id="S3.SS1.p1.1.m1.1.1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.1.2.cmml"><mo id="S3.SS1.p1.1.m1.1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.1.m1.1.1.1.1.2.cmml">{</mo><msub id="S3.SS1.p1.1.m1.1.1.1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.1.1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.2.cmml">p</mi><mi id="S3.SS1.p1.1.m1.1.1.1.1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS1.p1.1.m1.1.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.1.m1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS1.p1.1.m1.1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.1.3.cmml"><mi id="S3.SS1.p1.1.m1.1.1.1.3.2" xref="S3.SS1.p1.1.m1.1.1.1.3.2.cmml">i</mi><mo id="S3.SS1.p1.1.m1.1.1.1.3.1" xref="S3.SS1.p1.1.m1.1.1.1.3.1.cmml">=</mo><mn id="S3.SS1.p1.1.m1.1.1.1.3.3" xref="S3.SS1.p1.1.m1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml">m</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1">superscript</csymbol><apply id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1">subscript</csymbol><set id="S3.SS1.p1.1.m1.1.1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1"><apply id="S3.SS1.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.2">𝑝</ci><ci id="S3.SS1.p1.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S3.SS1.p1.1.m1.1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.1.3"><eq id="S3.SS1.p1.1.m1.1.1.1.3.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.3.1"></eq><ci id="S3.SS1.p1.1.m1.1.1.1.3.2.cmml" xref="S3.SS1.p1.1.m1.1.1.1.3.2">𝑖</ci><cn id="S3.SS1.p1.1.m1.1.1.1.3.3.cmml" type="integer" xref="S3.SS1.p1.1.m1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\{p_{i}\}_{i=1}^{m}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">{ italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT</annotation></semantics></math>, InPCA aims to embed them as points <math alttext="\{P_{i}\}_{i=1}^{m}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><msubsup id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><mrow id="S3.SS1.p1.2.m2.1.1.1.1.1" xref="S3.SS1.p1.2.m2.1.1.1.1.2.cmml"><mo id="S3.SS1.p1.2.m2.1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.2.m2.1.1.1.1.2.cmml">{</mo><msub id="S3.SS1.p1.2.m2.1.1.1.1.1.1" xref="S3.SS1.p1.2.m2.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.2.m2.1.1.1.1.1.1.2" xref="S3.SS1.p1.2.m2.1.1.1.1.1.1.2.cmml">P</mi><mi id="S3.SS1.p1.2.m2.1.1.1.1.1.1.3" xref="S3.SS1.p1.2.m2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS1.p1.2.m2.1.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.2.m2.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS1.p1.2.m2.1.1.1.3" xref="S3.SS1.p1.2.m2.1.1.1.3.cmml"><mi id="S3.SS1.p1.2.m2.1.1.1.3.2" xref="S3.SS1.p1.2.m2.1.1.1.3.2.cmml">i</mi><mo id="S3.SS1.p1.2.m2.1.1.1.3.1" xref="S3.SS1.p1.2.m2.1.1.1.3.1.cmml">=</mo><mn id="S3.SS1.p1.2.m2.1.1.1.3.3" xref="S3.SS1.p1.2.m2.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml">m</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1">superscript</csymbol><apply id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1">subscript</csymbol><set id="S3.SS1.p1.2.m2.1.1.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1.1"><apply id="S3.SS1.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1.1.1.2">𝑃</ci><ci id="S3.SS1.p1.2.m2.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S3.SS1.p1.2.m2.1.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.1.3"><eq id="S3.SS1.p1.2.m2.1.1.1.3.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1.3.1"></eq><ci id="S3.SS1.p1.2.m2.1.1.1.3.2.cmml" xref="S3.SS1.p1.2.m2.1.1.1.3.2">𝑖</ci><cn id="S3.SS1.p1.2.m2.1.1.1.3.3.cmml" type="integer" xref="S3.SS1.p1.2.m2.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">\{P_{i}\}_{i=1}^{m}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">{ italic_P start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT</annotation></semantics></math> in a lower-dimensional space <math alttext="\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><msup id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><mi id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">ℝ</mi><mi id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml">d</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">superscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2">ℝ</ci><ci id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> (<math alttext="d\ll m" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.1"><semantics id="S3.SS1.p1.4.m4.1a"><mrow id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><mi id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml">d</mi><mo id="S3.SS1.p1.4.m4.1.1.1" xref="S3.SS1.p1.4.m4.1.1.1.cmml">≪</mo><mi id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><csymbol cd="latexml" id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1">much-less-than</csymbol><ci id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2">𝑑</ci><ci id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">d\ll m</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.1d">italic_d ≪ italic_m</annotation></semantics></math>), such that the Euclidean distances between embedded points
closely approximate the statistical distances between the corresponding PDFs:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\|P_{i}-P_{j}\|_{2}\approx D(p_{i},p_{j}),\quad\forall i,j\in\{1,\ldots,m\}," class="ltx_Math" display="block" id="S3.E1.m1.4"><semantics id="S3.E1.m1.4a"><mrow id="S3.E1.m1.4.4.1"><mrow id="S3.E1.m1.4.4.1.1.2" xref="S3.E1.m1.4.4.1.1.3.cmml"><mrow id="S3.E1.m1.4.4.1.1.1.1" xref="S3.E1.m1.4.4.1.1.1.1.cmml"><msub id="S3.E1.m1.4.4.1.1.1.1.1" xref="S3.E1.m1.4.4.1.1.1.1.1.cmml"><mrow id="S3.E1.m1.4.4.1.1.1.1.1.1.1" xref="S3.E1.m1.4.4.1.1.1.1.1.1.2.cmml"><mo id="S3.E1.m1.4.4.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.4.4.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.2.2" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.2.2.cmml">P</mi><mi id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.2.3" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.3.2.cmml">P</mi><mi id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo id="S3.E1.m1.4.4.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E1.m1.4.4.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E1.m1.4.4.1.1.1.1.1.3" xref="S3.E1.m1.4.4.1.1.1.1.1.3.cmml">2</mn></msub><mo id="S3.E1.m1.4.4.1.1.1.1.4" xref="S3.E1.m1.4.4.1.1.1.1.4.cmml">≈</mo><mrow id="S3.E1.m1.4.4.1.1.1.1.3.2" xref="S3.E1.m1.4.4.1.1.1.1.3.3.cmml"><mrow id="S3.E1.m1.4.4.1.1.1.1.2.1.1" xref="S3.E1.m1.4.4.1.1.1.1.2.1.1.cmml"><mi id="S3.E1.m1.4.4.1.1.1.1.2.1.1.4" xref="S3.E1.m1.4.4.1.1.1.1.2.1.1.4.cmml">D</mi><mo id="S3.E1.m1.4.4.1.1.1.1.2.1.1.3" xref="S3.E1.m1.4.4.1.1.1.1.2.1.1.3.cmml">⁢</mo><mrow id="S3.E1.m1.4.4.1.1.1.1.2.1.1.2.2" xref="S3.E1.m1.4.4.1.1.1.1.2.1.1.2.3.cmml"><mo id="S3.E1.m1.4.4.1.1.1.1.2.1.1.2.2.3" stretchy="false" xref="S3.E1.m1.4.4.1.1.1.1.2.1.1.2.3.cmml">(</mo><msub id="S3.E1.m1.4.4.1.1.1.1.2.1.1.1.1.1" xref="S3.E1.m1.4.4.1.1.1.1.2.1.1.1.1.1.cmml"><mi id="S3.E1.m1.4.4.1.1.1.1.2.1.1.1.1.1.2" xref="S3.E1.m1.4.4.1.1.1.1.2.1.1.1.1.1.2.cmml">p</mi><mi id="S3.E1.m1.4.4.1.1.1.1.2.1.1.1.1.1.3" xref="S3.E1.m1.4.4.1.1.1.1.2.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E1.m1.4.4.1.1.1.1.2.1.1.2.2.4" xref="S3.E1.m1.4.4.1.1.1.1.2.1.1.2.3.cmml">,</mo><msub id="S3.E1.m1.4.4.1.1.1.1.2.1.1.2.2.2" xref="S3.E1.m1.4.4.1.1.1.1.2.1.1.2.2.2.cmml"><mi id="S3.E1.m1.4.4.1.1.1.1.2.1.1.2.2.2.2" xref="S3.E1.m1.4.4.1.1.1.1.2.1.1.2.2.2.2.cmml">p</mi><mi id="S3.E1.m1.4.4.1.1.1.1.2.1.1.2.2.2.3" xref="S3.E1.m1.4.4.1.1.1.1.2.1.1.2.2.2.3.cmml">j</mi></msub><mo id="S3.E1.m1.4.4.1.1.1.1.2.1.1.2.2.5" stretchy="false" xref="S3.E1.m1.4.4.1.1.1.1.2.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.4.4.1.1.1.1.3.2.3" rspace="1.167em" xref="S3.E1.m1.4.4.1.1.1.1.3.3.cmml">,</mo><mrow id="S3.E1.m1.4.4.1.1.1.1.3.2.2" xref="S3.E1.m1.4.4.1.1.1.1.3.2.2.cmml"><mo id="S3.E1.m1.4.4.1.1.1.1.3.2.2.1" rspace="0.167em" xref="S3.E1.m1.4.4.1.1.1.1.3.2.2.1.cmml">∀</mo><mi id="S3.E1.m1.4.4.1.1.1.1.3.2.2.2" xref="S3.E1.m1.4.4.1.1.1.1.3.2.2.2.cmml">i</mi></mrow></mrow></mrow><mo id="S3.E1.m1.4.4.1.1.2.3" xref="S3.E1.m1.4.4.1.1.3a.cmml">,</mo><mrow id="S3.E1.m1.4.4.1.1.2.2" xref="S3.E1.m1.4.4.1.1.2.2.cmml"><mi id="S3.E1.m1.4.4.1.1.2.2.2" xref="S3.E1.m1.4.4.1.1.2.2.2.cmml">j</mi><mo id="S3.E1.m1.4.4.1.1.2.2.1" xref="S3.E1.m1.4.4.1.1.2.2.1.cmml">∈</mo><mrow id="S3.E1.m1.4.4.1.1.2.2.3.2" xref="S3.E1.m1.4.4.1.1.2.2.3.1.cmml"><mo id="S3.E1.m1.4.4.1.1.2.2.3.2.1" stretchy="false" xref="S3.E1.m1.4.4.1.1.2.2.3.1.cmml">{</mo><mn id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">1</mn><mo id="S3.E1.m1.4.4.1.1.2.2.3.2.2" xref="S3.E1.m1.4.4.1.1.2.2.3.1.cmml">,</mo><mi id="S3.E1.m1.2.2" mathvariant="normal" xref="S3.E1.m1.2.2.cmml">…</mi><mo id="S3.E1.m1.4.4.1.1.2.2.3.2.3" xref="S3.E1.m1.4.4.1.1.2.2.3.1.cmml">,</mo><mi id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml">m</mi><mo id="S3.E1.m1.4.4.1.1.2.2.3.2.4" stretchy="false" xref="S3.E1.m1.4.4.1.1.2.2.3.1.cmml">}</mo></mrow></mrow></mrow><mo id="S3.E1.m1.4.4.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.4b"><apply id="S3.E1.m1.4.4.1.1.3.cmml" xref="S3.E1.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.3a.cmml" xref="S3.E1.m1.4.4.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E1.m1.4.4.1.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1"><approx id="S3.E1.m1.4.4.1.1.1.1.4.cmml" xref="S3.E1.m1.4.4.1.1.1.1.4"></approx><apply id="S3.E1.m1.4.4.1.1.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.1.1.1.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1">subscript</csymbol><apply id="S3.E1.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.4.4.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1"><minus id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.2.2">𝑃</ci><ci id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.3.2">𝑃</ci><ci id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply></apply><cn id="S3.E1.m1.4.4.1.1.1.1.1.3.cmml" type="integer" xref="S3.E1.m1.4.4.1.1.1.1.1.3">2</cn></apply><list id="S3.E1.m1.4.4.1.1.1.1.3.3.cmml" xref="S3.E1.m1.4.4.1.1.1.1.3.2"><apply id="S3.E1.m1.4.4.1.1.1.1.2.1.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.1.1"><times id="S3.E1.m1.4.4.1.1.1.1.2.1.1.3.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.1.1.3"></times><ci id="S3.E1.m1.4.4.1.1.1.1.2.1.1.4.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.1.1.4">𝐷</ci><interval closure="open" id="S3.E1.m1.4.4.1.1.1.1.2.1.1.2.3.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.1.1.2.2"><apply id="S3.E1.m1.4.4.1.1.1.1.2.1.1.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.4.4.1.1.1.1.2.1.1.1.1.1.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.1.1.1.1.1.2">𝑝</ci><ci id="S3.E1.m1.4.4.1.1.1.1.2.1.1.1.1.1.3.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E1.m1.4.4.1.1.1.1.2.1.1.2.2.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.1.1.2.1.1.2.2.2.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.1.1.2.2.2">subscript</csymbol><ci id="S3.E1.m1.4.4.1.1.1.1.2.1.1.2.2.2.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.1.1.2.2.2.2">𝑝</ci><ci id="S3.E1.m1.4.4.1.1.1.1.2.1.1.2.2.2.3.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.1.1.2.2.2.3">𝑗</ci></apply></interval></apply><apply id="S3.E1.m1.4.4.1.1.1.1.3.2.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.3.2.2"><csymbol cd="latexml" id="S3.E1.m1.4.4.1.1.1.1.3.2.2.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.3.2.2.1">for-all</csymbol><ci id="S3.E1.m1.4.4.1.1.1.1.3.2.2.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.3.2.2.2">𝑖</ci></apply></list></apply><apply id="S3.E1.m1.4.4.1.1.2.2.cmml" xref="S3.E1.m1.4.4.1.1.2.2"><in id="S3.E1.m1.4.4.1.1.2.2.1.cmml" xref="S3.E1.m1.4.4.1.1.2.2.1"></in><ci id="S3.E1.m1.4.4.1.1.2.2.2.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2">𝑗</ci><set id="S3.E1.m1.4.4.1.1.2.2.3.1.cmml" xref="S3.E1.m1.4.4.1.1.2.2.3.2"><cn id="S3.E1.m1.1.1.cmml" type="integer" xref="S3.E1.m1.1.1">1</cn><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">…</ci><ci id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3">𝑚</ci></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.4c">\|P_{i}-P_{j}\|_{2}\approx D(p_{i},p_{j}),\quad\forall i,j\in\{1,\ldots,m\},</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.4d">∥ italic_P start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - italic_P start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ≈ italic_D ( italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_p start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) , ∀ italic_i , italic_j ∈ { 1 , … , italic_m } ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p1.6">where <math alttext="D(\cdot,\cdot)" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m1.2"><semantics id="S3.SS1.p1.5.m1.2a"><mrow id="S3.SS1.p1.5.m1.2.3" xref="S3.SS1.p1.5.m1.2.3.cmml"><mi id="S3.SS1.p1.5.m1.2.3.2" xref="S3.SS1.p1.5.m1.2.3.2.cmml">D</mi><mo id="S3.SS1.p1.5.m1.2.3.1" xref="S3.SS1.p1.5.m1.2.3.1.cmml">⁢</mo><mrow id="S3.SS1.p1.5.m1.2.3.3.2" xref="S3.SS1.p1.5.m1.2.3.3.1.cmml"><mo id="S3.SS1.p1.5.m1.2.3.3.2.1" stretchy="false" xref="S3.SS1.p1.5.m1.2.3.3.1.cmml">(</mo><mo id="S3.SS1.p1.5.m1.1.1" lspace="0em" rspace="0em" xref="S3.SS1.p1.5.m1.1.1.cmml">⋅</mo><mo id="S3.SS1.p1.5.m1.2.3.3.2.2" rspace="0em" xref="S3.SS1.p1.5.m1.2.3.3.1.cmml">,</mo><mo id="S3.SS1.p1.5.m1.2.2" lspace="0em" rspace="0em" xref="S3.SS1.p1.5.m1.2.2.cmml">⋅</mo><mo id="S3.SS1.p1.5.m1.2.3.3.2.3" stretchy="false" xref="S3.SS1.p1.5.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m1.2b"><apply id="S3.SS1.p1.5.m1.2.3.cmml" xref="S3.SS1.p1.5.m1.2.3"><times id="S3.SS1.p1.5.m1.2.3.1.cmml" xref="S3.SS1.p1.5.m1.2.3.1"></times><ci id="S3.SS1.p1.5.m1.2.3.2.cmml" xref="S3.SS1.p1.5.m1.2.3.2">𝐷</ci><interval closure="open" id="S3.SS1.p1.5.m1.2.3.3.1.cmml" xref="S3.SS1.p1.5.m1.2.3.3.2"><ci id="S3.SS1.p1.5.m1.1.1.cmml" xref="S3.SS1.p1.5.m1.1.1">⋅</ci><ci id="S3.SS1.p1.5.m1.2.2.cmml" xref="S3.SS1.p1.5.m1.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m1.2c">D(\cdot,\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m1.2d">italic_D ( ⋅ , ⋅ )</annotation></semantics></math> is a chosen statistical distance measure between PDFs.
In this work, we choose <math alttext="D(\cdot,\cdot)" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m2.2"><semantics id="S3.SS1.p1.6.m2.2a"><mrow id="S3.SS1.p1.6.m2.2.3" xref="S3.SS1.p1.6.m2.2.3.cmml"><mi id="S3.SS1.p1.6.m2.2.3.2" xref="S3.SS1.p1.6.m2.2.3.2.cmml">D</mi><mo id="S3.SS1.p1.6.m2.2.3.1" xref="S3.SS1.p1.6.m2.2.3.1.cmml">⁢</mo><mrow id="S3.SS1.p1.6.m2.2.3.3.2" xref="S3.SS1.p1.6.m2.2.3.3.1.cmml"><mo id="S3.SS1.p1.6.m2.2.3.3.2.1" stretchy="false" xref="S3.SS1.p1.6.m2.2.3.3.1.cmml">(</mo><mo id="S3.SS1.p1.6.m2.1.1" lspace="0em" rspace="0em" xref="S3.SS1.p1.6.m2.1.1.cmml">⋅</mo><mo id="S3.SS1.p1.6.m2.2.3.3.2.2" rspace="0em" xref="S3.SS1.p1.6.m2.2.3.3.1.cmml">,</mo><mo id="S3.SS1.p1.6.m2.2.2" lspace="0em" rspace="0em" xref="S3.SS1.p1.6.m2.2.2.cmml">⋅</mo><mo id="S3.SS1.p1.6.m2.2.3.3.2.3" stretchy="false" xref="S3.SS1.p1.6.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m2.2b"><apply id="S3.SS1.p1.6.m2.2.3.cmml" xref="S3.SS1.p1.6.m2.2.3"><times id="S3.SS1.p1.6.m2.2.3.1.cmml" xref="S3.SS1.p1.6.m2.2.3.1"></times><ci id="S3.SS1.p1.6.m2.2.3.2.cmml" xref="S3.SS1.p1.6.m2.2.3.2">𝐷</ci><interval closure="open" id="S3.SS1.p1.6.m2.2.3.3.1.cmml" xref="S3.SS1.p1.6.m2.2.3.3.2"><ci id="S3.SS1.p1.6.m2.1.1.cmml" xref="S3.SS1.p1.6.m2.1.1">⋅</ci><ci id="S3.SS1.p1.6.m2.2.2.cmml" xref="S3.SS1.p1.6.m2.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m2.2c">D(\cdot,\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m2.2d">italic_D ( ⋅ , ⋅ )</annotation></semantics></math> to be the <em class="ltx_emph ltx_font_italic" id="S3.SS1.p1.6.1">Hellinger distance</em> <cite class="ltx_cite ltx_citemacro_citep">(Hellinger, <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib14" title="">1909</a>)</cite>, defined as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="D^{2}_{\text{Hel}}(p_{i},p_{j})=\frac{1}{2}\int\left|p_{i}(x)^{1/2}-p_{j}(x)^{%
1/2}\right|^{2}\,\textup{d}x." class="ltx_Math" display="block" id="S3.E2.m1.3"><semantics id="S3.E2.m1.3a"><mrow id="S3.E2.m1.3.3.1" xref="S3.E2.m1.3.3.1.1.cmml"><mrow id="S3.E2.m1.3.3.1.1" xref="S3.E2.m1.3.3.1.1.cmml"><mrow id="S3.E2.m1.3.3.1.1.2" xref="S3.E2.m1.3.3.1.1.2.cmml"><msubsup id="S3.E2.m1.3.3.1.1.2.4" xref="S3.E2.m1.3.3.1.1.2.4.cmml"><mi id="S3.E2.m1.3.3.1.1.2.4.2.2" xref="S3.E2.m1.3.3.1.1.2.4.2.2.cmml">D</mi><mtext id="S3.E2.m1.3.3.1.1.2.4.3" xref="S3.E2.m1.3.3.1.1.2.4.3a.cmml">Hel</mtext><mn id="S3.E2.m1.3.3.1.1.2.4.2.3" xref="S3.E2.m1.3.3.1.1.2.4.2.3.cmml">2</mn></msubsup><mo id="S3.E2.m1.3.3.1.1.2.3" xref="S3.E2.m1.3.3.1.1.2.3.cmml">⁢</mo><mrow id="S3.E2.m1.3.3.1.1.2.2.2" xref="S3.E2.m1.3.3.1.1.2.2.3.cmml"><mo id="S3.E2.m1.3.3.1.1.2.2.2.3" stretchy="false" xref="S3.E2.m1.3.3.1.1.2.2.3.cmml">(</mo><msub id="S3.E2.m1.3.3.1.1.1.1.1.1" xref="S3.E2.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.3.3.1.1.1.1.1.1.2" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.cmml">p</mi><mi id="S3.E2.m1.3.3.1.1.1.1.1.1.3" xref="S3.E2.m1.3.3.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E2.m1.3.3.1.1.2.2.2.4" xref="S3.E2.m1.3.3.1.1.2.2.3.cmml">,</mo><msub id="S3.E2.m1.3.3.1.1.2.2.2.2" xref="S3.E2.m1.3.3.1.1.2.2.2.2.cmml"><mi id="S3.E2.m1.3.3.1.1.2.2.2.2.2" xref="S3.E2.m1.3.3.1.1.2.2.2.2.2.cmml">p</mi><mi id="S3.E2.m1.3.3.1.1.2.2.2.2.3" xref="S3.E2.m1.3.3.1.1.2.2.2.2.3.cmml">j</mi></msub><mo id="S3.E2.m1.3.3.1.1.2.2.2.5" stretchy="false" xref="S3.E2.m1.3.3.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.3.3.1.1.4" xref="S3.E2.m1.3.3.1.1.4.cmml">=</mo><mrow id="S3.E2.m1.3.3.1.1.3" xref="S3.E2.m1.3.3.1.1.3.cmml"><mfrac id="S3.E2.m1.3.3.1.1.3.3" xref="S3.E2.m1.3.3.1.1.3.3.cmml"><mn id="S3.E2.m1.3.3.1.1.3.3.2" xref="S3.E2.m1.3.3.1.1.3.3.2.cmml">1</mn><mn id="S3.E2.m1.3.3.1.1.3.3.3" xref="S3.E2.m1.3.3.1.1.3.3.3.cmml">2</mn></mfrac><mo id="S3.E2.m1.3.3.1.1.3.2" xref="S3.E2.m1.3.3.1.1.3.2.cmml">⁢</mo><mrow id="S3.E2.m1.3.3.1.1.3.1" xref="S3.E2.m1.3.3.1.1.3.1.cmml"><mo id="S3.E2.m1.3.3.1.1.3.1.2" rspace="0em" xref="S3.E2.m1.3.3.1.1.3.1.2.cmml">∫</mo><mrow id="S3.E2.m1.3.3.1.1.3.1.1" xref="S3.E2.m1.3.3.1.1.3.1.1.cmml"><msup id="S3.E2.m1.3.3.1.1.3.1.1.1" xref="S3.E2.m1.3.3.1.1.3.1.1.1.cmml"><mrow id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.2.cmml"><mo id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.2" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.2.1.cmml">|</mo><mrow id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.cmml"><mrow id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2.cmml"><msub id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2.2" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2.2.2" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2.2.2.cmml">p</mi><mi id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2.2.3" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2.1" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2.1.cmml">⁢</mo><msup id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2.3" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2.3.cmml"><mrow id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2.3.2.2" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2.3.cmml"><mo id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2.3.2.2.1" stretchy="false" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2.3.cmml">(</mo><mi id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">x</mi><mo id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2.3.2.2.2" stretchy="false" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2.3.cmml">)</mo></mrow><mrow id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2.3.3" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2.3.3.cmml"><mn id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2.3.3.2" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2.3.3.2.cmml">1</mn><mo id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2.3.3.1" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2.3.3.1.cmml">/</mo><mn id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2.3.3.3" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2.3.3.3.cmml">2</mn></mrow></msup></mrow><mo id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.1" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3.cmml"><msub id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3.2" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3.2.2" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3.2.2.cmml">p</mi><mi id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3.2.3" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3.2.3.cmml">j</mi></msub><mo id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3.1" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3.1.cmml">⁢</mo><msup id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3.3" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3.3.cmml"><mrow id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3.3.2.2" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3.3.cmml"><mo id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3.3.2.2.1" stretchy="false" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3.3.cmml">(</mo><mi id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml">x</mi><mo id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3.3.2.2.2" stretchy="false" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3.3.cmml">)</mo></mrow><mrow id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3.3.3" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3.3.3.cmml"><mn id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3.3.3.2" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3.3.3.2.cmml">1</mn><mo id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3.3.3.1" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3.3.3.1.cmml">/</mo><mn id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3.3.3.3" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3.3.3.3.cmml">2</mn></mrow></msup></mrow></mrow><mo id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.3" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.2.1.cmml">|</mo></mrow><mn id="S3.E2.m1.3.3.1.1.3.1.1.1.3" xref="S3.E2.m1.3.3.1.1.3.1.1.1.3.cmml">2</mn></msup><mo id="S3.E2.m1.3.3.1.1.3.1.1.2" xref="S3.E2.m1.3.3.1.1.3.1.1.2.cmml">⁢</mo><mtext id="S3.E2.m1.3.3.1.1.3.1.1.3" xref="S3.E2.m1.3.3.1.1.3.1.1.3a.cmml">d</mtext><mo id="S3.E2.m1.3.3.1.1.3.1.1.2a" xref="S3.E2.m1.3.3.1.1.3.1.1.2.cmml">⁢</mo><mi id="S3.E2.m1.3.3.1.1.3.1.1.4" xref="S3.E2.m1.3.3.1.1.3.1.1.4.cmml">x</mi></mrow></mrow></mrow></mrow><mo id="S3.E2.m1.3.3.1.2" lspace="0em" xref="S3.E2.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.3b"><apply id="S3.E2.m1.3.3.1.1.cmml" xref="S3.E2.m1.3.3.1"><eq id="S3.E2.m1.3.3.1.1.4.cmml" xref="S3.E2.m1.3.3.1.1.4"></eq><apply id="S3.E2.m1.3.3.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.2"><times id="S3.E2.m1.3.3.1.1.2.3.cmml" xref="S3.E2.m1.3.3.1.1.2.3"></times><apply id="S3.E2.m1.3.3.1.1.2.4.cmml" xref="S3.E2.m1.3.3.1.1.2.4"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.2.4.1.cmml" xref="S3.E2.m1.3.3.1.1.2.4">subscript</csymbol><apply id="S3.E2.m1.3.3.1.1.2.4.2.cmml" xref="S3.E2.m1.3.3.1.1.2.4"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.2.4.2.1.cmml" xref="S3.E2.m1.3.3.1.1.2.4">superscript</csymbol><ci id="S3.E2.m1.3.3.1.1.2.4.2.2.cmml" xref="S3.E2.m1.3.3.1.1.2.4.2.2">𝐷</ci><cn id="S3.E2.m1.3.3.1.1.2.4.2.3.cmml" type="integer" xref="S3.E2.m1.3.3.1.1.2.4.2.3">2</cn></apply><ci id="S3.E2.m1.3.3.1.1.2.4.3a.cmml" xref="S3.E2.m1.3.3.1.1.2.4.3"><mtext id="S3.E2.m1.3.3.1.1.2.4.3.cmml" mathsize="70%" xref="S3.E2.m1.3.3.1.1.2.4.3">Hel</mtext></ci></apply><interval closure="open" id="S3.E2.m1.3.3.1.1.2.2.3.cmml" xref="S3.E2.m1.3.3.1.1.2.2.2"><apply id="S3.E2.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2">𝑝</ci><ci id="S3.E2.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E2.m1.3.3.1.1.2.2.2.2.cmml" xref="S3.E2.m1.3.3.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.2.2.2.2.1.cmml" xref="S3.E2.m1.3.3.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S3.E2.m1.3.3.1.1.2.2.2.2.2">𝑝</ci><ci id="S3.E2.m1.3.3.1.1.2.2.2.2.3.cmml" xref="S3.E2.m1.3.3.1.1.2.2.2.2.3">𝑗</ci></apply></interval></apply><apply id="S3.E2.m1.3.3.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.3"><times id="S3.E2.m1.3.3.1.1.3.2.cmml" xref="S3.E2.m1.3.3.1.1.3.2"></times><apply id="S3.E2.m1.3.3.1.1.3.3.cmml" xref="S3.E2.m1.3.3.1.1.3.3"><divide id="S3.E2.m1.3.3.1.1.3.3.1.cmml" xref="S3.E2.m1.3.3.1.1.3.3"></divide><cn id="S3.E2.m1.3.3.1.1.3.3.2.cmml" type="integer" xref="S3.E2.m1.3.3.1.1.3.3.2">1</cn><cn id="S3.E2.m1.3.3.1.1.3.3.3.cmml" type="integer" xref="S3.E2.m1.3.3.1.1.3.3.3">2</cn></apply><apply id="S3.E2.m1.3.3.1.1.3.1.cmml" xref="S3.E2.m1.3.3.1.1.3.1"><int id="S3.E2.m1.3.3.1.1.3.1.2.cmml" xref="S3.E2.m1.3.3.1.1.3.1.2"></int><apply id="S3.E2.m1.3.3.1.1.3.1.1.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1"><times id="S3.E2.m1.3.3.1.1.3.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.2"></times><apply id="S3.E2.m1.3.3.1.1.3.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.3.1.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.1">superscript</csymbol><apply id="S3.E2.m1.3.3.1.1.3.1.1.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1"><abs id="S3.E2.m1.3.3.1.1.3.1.1.1.1.2.1.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.2"></abs><apply id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1"><minus id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.1"></minus><apply id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2"><times id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2.1"></times><apply id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2.2.2">𝑝</ci><ci id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2.2.3">𝑖</ci></apply><apply id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2.3">superscript</csymbol><ci id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">𝑥</ci><apply id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2.3.3"><divide id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2.3.3.1.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2.3.3.1"></divide><cn id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2.3.3.2.cmml" type="integer" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2.3.3.2">1</cn><cn id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2.3.3.3.cmml" type="integer" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.2.3.3.3">2</cn></apply></apply></apply><apply id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3"><times id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3.1"></times><apply id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3.2.2">𝑝</ci><ci id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3.2.3">𝑗</ci></apply><apply id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3.3">superscript</csymbol><ci id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2">𝑥</ci><apply id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3.3.3"><divide id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3.3.3.1"></divide><cn id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3.3.3.2.cmml" type="integer" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3.3.3.2">1</cn><cn id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3.3.3.3.cmml" type="integer" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.3.3.3.3">2</cn></apply></apply></apply></apply></apply><cn id="S3.E2.m1.3.3.1.1.3.1.1.1.3.cmml" type="integer" xref="S3.E2.m1.3.3.1.1.3.1.1.1.3">2</cn></apply><ci id="S3.E2.m1.3.3.1.1.3.1.1.3a.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.3"><mtext id="S3.E2.m1.3.3.1.1.3.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.3">d</mtext></ci><ci id="S3.E2.m1.3.3.1.1.3.1.1.4.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.4">𝑥</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.3c">D^{2}_{\text{Hel}}(p_{i},p_{j})=\frac{1}{2}\int\left|p_{i}(x)^{1/2}-p_{j}(x)^{%
1/2}\right|^{2}\,\textup{d}x.</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.3d">italic_D start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT Hel end_POSTSUBSCRIPT ( italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_p start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) = divide start_ARG 1 end_ARG start_ARG 2 end_ARG ∫ | italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_x ) start_POSTSUPERSCRIPT 1 / 2 end_POSTSUPERSCRIPT - italic_p start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( italic_x ) start_POSTSUPERSCRIPT 1 / 2 end_POSTSUPERSCRIPT | start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT d italic_x .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p1.7">The Hellinger distance is ideal for visualizing our PDF trajectories for the following reasons<span class="ltx_note ltx_role_footnote" id="footnote6"><sup class="ltx_note_mark">6</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">6</sup><span class="ltx_tag ltx_tag_note">6</span>See <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.SS5.SSS3" title="A.5.3 MISE vs. valid statistical distances ‣ A.5 Additional notes on Kernel Density Estimation ‣ Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">A.5.3</span></a> for an in-depth comparison of the Hellinger distance against other divergence measures.</span></span></span>:
1) it locally agrees with the KL-divergence <cite class="ltx_cite ltx_citemacro_citep">(Liese &amp; Vajda, <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib21" title="">2006</a>)</cite>, a non-negative measure commonly used in training modern machine learning systems, including LLMs <cite class="ltx_cite ltx_citemacro_citep">(Touvron et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib39" title="">2023</a>)</cite>, and 2) it is symmetric and satisfies the triangle inequality, making it a proper distance metric suitable for geometric analysis <cite class="ltx_cite ltx_citemacro_citep">(Quinn et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib28" title="">2019</a>; Teoh et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib37" title="">2020</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.2">Having chosen an appropriate distance measure, we proceed with InPCA involving three steps:</p>
<ol class="ltx_enumerate" id="S3.I1">
<li class="ltx_item" id="S3.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S3.I1.i1.p1">
<p class="ltx_p" id="S3.I1.i1.p1.4">Calculate the Hellinger distance between each pair of PDFs, <math alttext="D^{2}_{\text{Hel}}(p_{i},p_{j})" class="ltx_Math" display="inline" id="S3.I1.i1.p1.1.m1.2"><semantics id="S3.I1.i1.p1.1.m1.2a"><mrow id="S3.I1.i1.p1.1.m1.2.2" xref="S3.I1.i1.p1.1.m1.2.2.cmml"><msubsup id="S3.I1.i1.p1.1.m1.2.2.4" xref="S3.I1.i1.p1.1.m1.2.2.4.cmml"><mi id="S3.I1.i1.p1.1.m1.2.2.4.2.2" xref="S3.I1.i1.p1.1.m1.2.2.4.2.2.cmml">D</mi><mtext id="S3.I1.i1.p1.1.m1.2.2.4.3" xref="S3.I1.i1.p1.1.m1.2.2.4.3a.cmml">Hel</mtext><mn id="S3.I1.i1.p1.1.m1.2.2.4.2.3" xref="S3.I1.i1.p1.1.m1.2.2.4.2.3.cmml">2</mn></msubsup><mo id="S3.I1.i1.p1.1.m1.2.2.3" xref="S3.I1.i1.p1.1.m1.2.2.3.cmml">⁢</mo><mrow id="S3.I1.i1.p1.1.m1.2.2.2.2" xref="S3.I1.i1.p1.1.m1.2.2.2.3.cmml"><mo id="S3.I1.i1.p1.1.m1.2.2.2.2.3" stretchy="false" xref="S3.I1.i1.p1.1.m1.2.2.2.3.cmml">(</mo><msub id="S3.I1.i1.p1.1.m1.1.1.1.1.1" xref="S3.I1.i1.p1.1.m1.1.1.1.1.1.cmml"><mi id="S3.I1.i1.p1.1.m1.1.1.1.1.1.2" xref="S3.I1.i1.p1.1.m1.1.1.1.1.1.2.cmml">p</mi><mi id="S3.I1.i1.p1.1.m1.1.1.1.1.1.3" xref="S3.I1.i1.p1.1.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.I1.i1.p1.1.m1.2.2.2.2.4" xref="S3.I1.i1.p1.1.m1.2.2.2.3.cmml">,</mo><msub id="S3.I1.i1.p1.1.m1.2.2.2.2.2" xref="S3.I1.i1.p1.1.m1.2.2.2.2.2.cmml"><mi id="S3.I1.i1.p1.1.m1.2.2.2.2.2.2" xref="S3.I1.i1.p1.1.m1.2.2.2.2.2.2.cmml">p</mi><mi id="S3.I1.i1.p1.1.m1.2.2.2.2.2.3" xref="S3.I1.i1.p1.1.m1.2.2.2.2.2.3.cmml">j</mi></msub><mo id="S3.I1.i1.p1.1.m1.2.2.2.2.5" stretchy="false" xref="S3.I1.i1.p1.1.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.1.m1.2b"><apply id="S3.I1.i1.p1.1.m1.2.2.cmml" xref="S3.I1.i1.p1.1.m1.2.2"><times id="S3.I1.i1.p1.1.m1.2.2.3.cmml" xref="S3.I1.i1.p1.1.m1.2.2.3"></times><apply id="S3.I1.i1.p1.1.m1.2.2.4.cmml" xref="S3.I1.i1.p1.1.m1.2.2.4"><csymbol cd="ambiguous" id="S3.I1.i1.p1.1.m1.2.2.4.1.cmml" xref="S3.I1.i1.p1.1.m1.2.2.4">subscript</csymbol><apply id="S3.I1.i1.p1.1.m1.2.2.4.2.cmml" xref="S3.I1.i1.p1.1.m1.2.2.4"><csymbol cd="ambiguous" id="S3.I1.i1.p1.1.m1.2.2.4.2.1.cmml" xref="S3.I1.i1.p1.1.m1.2.2.4">superscript</csymbol><ci id="S3.I1.i1.p1.1.m1.2.2.4.2.2.cmml" xref="S3.I1.i1.p1.1.m1.2.2.4.2.2">𝐷</ci><cn id="S3.I1.i1.p1.1.m1.2.2.4.2.3.cmml" type="integer" xref="S3.I1.i1.p1.1.m1.2.2.4.2.3">2</cn></apply><ci id="S3.I1.i1.p1.1.m1.2.2.4.3a.cmml" xref="S3.I1.i1.p1.1.m1.2.2.4.3"><mtext id="S3.I1.i1.p1.1.m1.2.2.4.3.cmml" mathsize="70%" xref="S3.I1.i1.p1.1.m1.2.2.4.3">Hel</mtext></ci></apply><interval closure="open" id="S3.I1.i1.p1.1.m1.2.2.2.3.cmml" xref="S3.I1.i1.p1.1.m1.2.2.2.2"><apply id="S3.I1.i1.p1.1.m1.1.1.1.1.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.I1.i1.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.I1.i1.p1.1.m1.1.1.1.1.1.2.cmml" xref="S3.I1.i1.p1.1.m1.1.1.1.1.1.2">𝑝</ci><ci id="S3.I1.i1.p1.1.m1.1.1.1.1.1.3.cmml" xref="S3.I1.i1.p1.1.m1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.I1.i1.p1.1.m1.2.2.2.2.2.cmml" xref="S3.I1.i1.p1.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.I1.i1.p1.1.m1.2.2.2.2.2.1.cmml" xref="S3.I1.i1.p1.1.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.I1.i1.p1.1.m1.2.2.2.2.2.2.cmml" xref="S3.I1.i1.p1.1.m1.2.2.2.2.2.2">𝑝</ci><ci id="S3.I1.i1.p1.1.m1.2.2.2.2.2.3.cmml" xref="S3.I1.i1.p1.1.m1.2.2.2.2.2.3">𝑗</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.1.m1.2c">D^{2}_{\text{Hel}}(p_{i},p_{j})</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i1.p1.1.m1.2d">italic_D start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT Hel end_POSTSUBSCRIPT ( italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_p start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT )</annotation></semantics></math>. This results in a pairwise distance matrix <math alttext="\boldsymbol{D}\in\mathbb{R}^{m\times m}" class="ltx_Math" display="inline" id="S3.I1.i1.p1.2.m2.1"><semantics id="S3.I1.i1.p1.2.m2.1a"><mrow id="S3.I1.i1.p1.2.m2.1.1" xref="S3.I1.i1.p1.2.m2.1.1.cmml"><mi id="S3.I1.i1.p1.2.m2.1.1.2" xref="S3.I1.i1.p1.2.m2.1.1.2.cmml">𝑫</mi><mo id="S3.I1.i1.p1.2.m2.1.1.1" xref="S3.I1.i1.p1.2.m2.1.1.1.cmml">∈</mo><msup id="S3.I1.i1.p1.2.m2.1.1.3" xref="S3.I1.i1.p1.2.m2.1.1.3.cmml"><mi id="S3.I1.i1.p1.2.m2.1.1.3.2" xref="S3.I1.i1.p1.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.I1.i1.p1.2.m2.1.1.3.3" xref="S3.I1.i1.p1.2.m2.1.1.3.3.cmml"><mi id="S3.I1.i1.p1.2.m2.1.1.3.3.2" xref="S3.I1.i1.p1.2.m2.1.1.3.3.2.cmml">m</mi><mo id="S3.I1.i1.p1.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.I1.i1.p1.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S3.I1.i1.p1.2.m2.1.1.3.3.3" xref="S3.I1.i1.p1.2.m2.1.1.3.3.3.cmml">m</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.2.m2.1b"><apply id="S3.I1.i1.p1.2.m2.1.1.cmml" xref="S3.I1.i1.p1.2.m2.1.1"><in id="S3.I1.i1.p1.2.m2.1.1.1.cmml" xref="S3.I1.i1.p1.2.m2.1.1.1"></in><ci id="S3.I1.i1.p1.2.m2.1.1.2.cmml" xref="S3.I1.i1.p1.2.m2.1.1.2">𝑫</ci><apply id="S3.I1.i1.p1.2.m2.1.1.3.cmml" xref="S3.I1.i1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.I1.i1.p1.2.m2.1.1.3.1.cmml" xref="S3.I1.i1.p1.2.m2.1.1.3">superscript</csymbol><ci id="S3.I1.i1.p1.2.m2.1.1.3.2.cmml" xref="S3.I1.i1.p1.2.m2.1.1.3.2">ℝ</ci><apply id="S3.I1.i1.p1.2.m2.1.1.3.3.cmml" xref="S3.I1.i1.p1.2.m2.1.1.3.3"><times id="S3.I1.i1.p1.2.m2.1.1.3.3.1.cmml" xref="S3.I1.i1.p1.2.m2.1.1.3.3.1"></times><ci id="S3.I1.i1.p1.2.m2.1.1.3.3.2.cmml" xref="S3.I1.i1.p1.2.m2.1.1.3.3.2">𝑚</ci><ci id="S3.I1.i1.p1.2.m2.1.1.3.3.3.cmml" xref="S3.I1.i1.p1.2.m2.1.1.3.3.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.2.m2.1c">\boldsymbol{D}\in\mathbb{R}^{m\times m}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i1.p1.2.m2.1d">bold_italic_D ∈ blackboard_R start_POSTSUPERSCRIPT italic_m × italic_m end_POSTSUPERSCRIPT</annotation></semantics></math>, whose <math alttext="\boldsymbol{D}_{ij}" class="ltx_Math" display="inline" id="S3.I1.i1.p1.3.m3.1"><semantics id="S3.I1.i1.p1.3.m3.1a"><msub id="S3.I1.i1.p1.3.m3.1.1" xref="S3.I1.i1.p1.3.m3.1.1.cmml"><mi id="S3.I1.i1.p1.3.m3.1.1.2" xref="S3.I1.i1.p1.3.m3.1.1.2.cmml">𝑫</mi><mrow id="S3.I1.i1.p1.3.m3.1.1.3" xref="S3.I1.i1.p1.3.m3.1.1.3.cmml"><mi id="S3.I1.i1.p1.3.m3.1.1.3.2" xref="S3.I1.i1.p1.3.m3.1.1.3.2.cmml">i</mi><mo id="S3.I1.i1.p1.3.m3.1.1.3.1" xref="S3.I1.i1.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.I1.i1.p1.3.m3.1.1.3.3" xref="S3.I1.i1.p1.3.m3.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.3.m3.1b"><apply id="S3.I1.i1.p1.3.m3.1.1.cmml" xref="S3.I1.i1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.I1.i1.p1.3.m3.1.1.1.cmml" xref="S3.I1.i1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.I1.i1.p1.3.m3.1.1.2.cmml" xref="S3.I1.i1.p1.3.m3.1.1.2">𝑫</ci><apply id="S3.I1.i1.p1.3.m3.1.1.3.cmml" xref="S3.I1.i1.p1.3.m3.1.1.3"><times id="S3.I1.i1.p1.3.m3.1.1.3.1.cmml" xref="S3.I1.i1.p1.3.m3.1.1.3.1"></times><ci id="S3.I1.i1.p1.3.m3.1.1.3.2.cmml" xref="S3.I1.i1.p1.3.m3.1.1.3.2">𝑖</ci><ci id="S3.I1.i1.p1.3.m3.1.1.3.3.cmml" xref="S3.I1.i1.p1.3.m3.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.3.m3.1c">\boldsymbol{D}_{ij}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i1.p1.3.m3.1d">bold_italic_D start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math> entry equals <math alttext="D^{2}_{\text{Hel}}(p_{i},p_{j})" class="ltx_Math" display="inline" id="S3.I1.i1.p1.4.m4.2"><semantics id="S3.I1.i1.p1.4.m4.2a"><mrow id="S3.I1.i1.p1.4.m4.2.2" xref="S3.I1.i1.p1.4.m4.2.2.cmml"><msubsup id="S3.I1.i1.p1.4.m4.2.2.4" xref="S3.I1.i1.p1.4.m4.2.2.4.cmml"><mi id="S3.I1.i1.p1.4.m4.2.2.4.2.2" xref="S3.I1.i1.p1.4.m4.2.2.4.2.2.cmml">D</mi><mtext id="S3.I1.i1.p1.4.m4.2.2.4.3" xref="S3.I1.i1.p1.4.m4.2.2.4.3a.cmml">Hel</mtext><mn id="S3.I1.i1.p1.4.m4.2.2.4.2.3" xref="S3.I1.i1.p1.4.m4.2.2.4.2.3.cmml">2</mn></msubsup><mo id="S3.I1.i1.p1.4.m4.2.2.3" xref="S3.I1.i1.p1.4.m4.2.2.3.cmml">⁢</mo><mrow id="S3.I1.i1.p1.4.m4.2.2.2.2" xref="S3.I1.i1.p1.4.m4.2.2.2.3.cmml"><mo id="S3.I1.i1.p1.4.m4.2.2.2.2.3" stretchy="false" xref="S3.I1.i1.p1.4.m4.2.2.2.3.cmml">(</mo><msub id="S3.I1.i1.p1.4.m4.1.1.1.1.1" xref="S3.I1.i1.p1.4.m4.1.1.1.1.1.cmml"><mi id="S3.I1.i1.p1.4.m4.1.1.1.1.1.2" xref="S3.I1.i1.p1.4.m4.1.1.1.1.1.2.cmml">p</mi><mi id="S3.I1.i1.p1.4.m4.1.1.1.1.1.3" xref="S3.I1.i1.p1.4.m4.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.I1.i1.p1.4.m4.2.2.2.2.4" xref="S3.I1.i1.p1.4.m4.2.2.2.3.cmml">,</mo><msub id="S3.I1.i1.p1.4.m4.2.2.2.2.2" xref="S3.I1.i1.p1.4.m4.2.2.2.2.2.cmml"><mi id="S3.I1.i1.p1.4.m4.2.2.2.2.2.2" xref="S3.I1.i1.p1.4.m4.2.2.2.2.2.2.cmml">p</mi><mi id="S3.I1.i1.p1.4.m4.2.2.2.2.2.3" xref="S3.I1.i1.p1.4.m4.2.2.2.2.2.3.cmml">j</mi></msub><mo id="S3.I1.i1.p1.4.m4.2.2.2.2.5" stretchy="false" xref="S3.I1.i1.p1.4.m4.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.4.m4.2b"><apply id="S3.I1.i1.p1.4.m4.2.2.cmml" xref="S3.I1.i1.p1.4.m4.2.2"><times id="S3.I1.i1.p1.4.m4.2.2.3.cmml" xref="S3.I1.i1.p1.4.m4.2.2.3"></times><apply id="S3.I1.i1.p1.4.m4.2.2.4.cmml" xref="S3.I1.i1.p1.4.m4.2.2.4"><csymbol cd="ambiguous" id="S3.I1.i1.p1.4.m4.2.2.4.1.cmml" xref="S3.I1.i1.p1.4.m4.2.2.4">subscript</csymbol><apply id="S3.I1.i1.p1.4.m4.2.2.4.2.cmml" xref="S3.I1.i1.p1.4.m4.2.2.4"><csymbol cd="ambiguous" id="S3.I1.i1.p1.4.m4.2.2.4.2.1.cmml" xref="S3.I1.i1.p1.4.m4.2.2.4">superscript</csymbol><ci id="S3.I1.i1.p1.4.m4.2.2.4.2.2.cmml" xref="S3.I1.i1.p1.4.m4.2.2.4.2.2">𝐷</ci><cn id="S3.I1.i1.p1.4.m4.2.2.4.2.3.cmml" type="integer" xref="S3.I1.i1.p1.4.m4.2.2.4.2.3">2</cn></apply><ci id="S3.I1.i1.p1.4.m4.2.2.4.3a.cmml" xref="S3.I1.i1.p1.4.m4.2.2.4.3"><mtext id="S3.I1.i1.p1.4.m4.2.2.4.3.cmml" mathsize="70%" xref="S3.I1.i1.p1.4.m4.2.2.4.3">Hel</mtext></ci></apply><interval closure="open" id="S3.I1.i1.p1.4.m4.2.2.2.3.cmml" xref="S3.I1.i1.p1.4.m4.2.2.2.2"><apply id="S3.I1.i1.p1.4.m4.1.1.1.1.1.cmml" xref="S3.I1.i1.p1.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.I1.i1.p1.4.m4.1.1.1.1.1.1.cmml" xref="S3.I1.i1.p1.4.m4.1.1.1.1.1">subscript</csymbol><ci id="S3.I1.i1.p1.4.m4.1.1.1.1.1.2.cmml" xref="S3.I1.i1.p1.4.m4.1.1.1.1.1.2">𝑝</ci><ci id="S3.I1.i1.p1.4.m4.1.1.1.1.1.3.cmml" xref="S3.I1.i1.p1.4.m4.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.I1.i1.p1.4.m4.2.2.2.2.2.cmml" xref="S3.I1.i1.p1.4.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.I1.i1.p1.4.m4.2.2.2.2.2.1.cmml" xref="S3.I1.i1.p1.4.m4.2.2.2.2.2">subscript</csymbol><ci id="S3.I1.i1.p1.4.m4.2.2.2.2.2.2.cmml" xref="S3.I1.i1.p1.4.m4.2.2.2.2.2.2">𝑝</ci><ci id="S3.I1.i1.p1.4.m4.2.2.2.2.2.3.cmml" xref="S3.I1.i1.p1.4.m4.2.2.2.2.2.3">𝑗</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.4.m4.2c">D^{2}_{\text{Hel}}(p_{i},p_{j})</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i1.p1.4.m4.2d">italic_D start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT Hel end_POSTSUBSCRIPT ( italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_p start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT )</annotation></semantics></math>.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S3.I1.i2.p1">
<p class="ltx_p" id="S3.I1.i2.p1.2">Obtain a “centered” matrix <math alttext="W=-\frac{1}{2}L\boldsymbol{D}L" class="ltx_Math" display="inline" id="S3.I1.i2.p1.1.m1.1"><semantics id="S3.I1.i2.p1.1.m1.1a"><mrow id="S3.I1.i2.p1.1.m1.1.1" xref="S3.I1.i2.p1.1.m1.1.1.cmml"><mi id="S3.I1.i2.p1.1.m1.1.1.2" xref="S3.I1.i2.p1.1.m1.1.1.2.cmml">W</mi><mo id="S3.I1.i2.p1.1.m1.1.1.1" xref="S3.I1.i2.p1.1.m1.1.1.1.cmml">=</mo><mrow id="S3.I1.i2.p1.1.m1.1.1.3" xref="S3.I1.i2.p1.1.m1.1.1.3.cmml"><mo id="S3.I1.i2.p1.1.m1.1.1.3a" xref="S3.I1.i2.p1.1.m1.1.1.3.cmml">−</mo><mrow id="S3.I1.i2.p1.1.m1.1.1.3.2" xref="S3.I1.i2.p1.1.m1.1.1.3.2.cmml"><mfrac id="S3.I1.i2.p1.1.m1.1.1.3.2.2" xref="S3.I1.i2.p1.1.m1.1.1.3.2.2.cmml"><mn id="S3.I1.i2.p1.1.m1.1.1.3.2.2.2" xref="S3.I1.i2.p1.1.m1.1.1.3.2.2.2.cmml">1</mn><mn id="S3.I1.i2.p1.1.m1.1.1.3.2.2.3" xref="S3.I1.i2.p1.1.m1.1.1.3.2.2.3.cmml">2</mn></mfrac><mo id="S3.I1.i2.p1.1.m1.1.1.3.2.1" xref="S3.I1.i2.p1.1.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S3.I1.i2.p1.1.m1.1.1.3.2.3" xref="S3.I1.i2.p1.1.m1.1.1.3.2.3.cmml">L</mi><mo id="S3.I1.i2.p1.1.m1.1.1.3.2.1a" xref="S3.I1.i2.p1.1.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S3.I1.i2.p1.1.m1.1.1.3.2.4" xref="S3.I1.i2.p1.1.m1.1.1.3.2.4.cmml">𝑫</mi><mo id="S3.I1.i2.p1.1.m1.1.1.3.2.1b" xref="S3.I1.i2.p1.1.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S3.I1.i2.p1.1.m1.1.1.3.2.5" xref="S3.I1.i2.p1.1.m1.1.1.3.2.5.cmml">L</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.1.m1.1b"><apply id="S3.I1.i2.p1.1.m1.1.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1"><eq id="S3.I1.i2.p1.1.m1.1.1.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1.1"></eq><ci id="S3.I1.i2.p1.1.m1.1.1.2.cmml" xref="S3.I1.i2.p1.1.m1.1.1.2">𝑊</ci><apply id="S3.I1.i2.p1.1.m1.1.1.3.cmml" xref="S3.I1.i2.p1.1.m1.1.1.3"><minus id="S3.I1.i2.p1.1.m1.1.1.3.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1.3"></minus><apply id="S3.I1.i2.p1.1.m1.1.1.3.2.cmml" xref="S3.I1.i2.p1.1.m1.1.1.3.2"><times id="S3.I1.i2.p1.1.m1.1.1.3.2.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1.3.2.1"></times><apply id="S3.I1.i2.p1.1.m1.1.1.3.2.2.cmml" xref="S3.I1.i2.p1.1.m1.1.1.3.2.2"><divide id="S3.I1.i2.p1.1.m1.1.1.3.2.2.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1.3.2.2"></divide><cn id="S3.I1.i2.p1.1.m1.1.1.3.2.2.2.cmml" type="integer" xref="S3.I1.i2.p1.1.m1.1.1.3.2.2.2">1</cn><cn id="S3.I1.i2.p1.1.m1.1.1.3.2.2.3.cmml" type="integer" xref="S3.I1.i2.p1.1.m1.1.1.3.2.2.3">2</cn></apply><ci id="S3.I1.i2.p1.1.m1.1.1.3.2.3.cmml" xref="S3.I1.i2.p1.1.m1.1.1.3.2.3">𝐿</ci><ci id="S3.I1.i2.p1.1.m1.1.1.3.2.4.cmml" xref="S3.I1.i2.p1.1.m1.1.1.3.2.4">𝑫</ci><ci id="S3.I1.i2.p1.1.m1.1.1.3.2.5.cmml" xref="S3.I1.i2.p1.1.m1.1.1.3.2.5">𝐿</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.1.m1.1c">W=-\frac{1}{2}L\boldsymbol{D}L</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i2.p1.1.m1.1d">italic_W = - divide start_ARG 1 end_ARG start_ARG 2 end_ARG italic_L bold_italic_D italic_L</annotation></semantics></math>, where <math alttext="L_{ij}=\delta_{ij}-1/m" class="ltx_Math" display="inline" id="S3.I1.i2.p1.2.m2.1"><semantics id="S3.I1.i2.p1.2.m2.1a"><mrow id="S3.I1.i2.p1.2.m2.1.1" xref="S3.I1.i2.p1.2.m2.1.1.cmml"><msub id="S3.I1.i2.p1.2.m2.1.1.2" xref="S3.I1.i2.p1.2.m2.1.1.2.cmml"><mi id="S3.I1.i2.p1.2.m2.1.1.2.2" xref="S3.I1.i2.p1.2.m2.1.1.2.2.cmml">L</mi><mrow id="S3.I1.i2.p1.2.m2.1.1.2.3" xref="S3.I1.i2.p1.2.m2.1.1.2.3.cmml"><mi id="S3.I1.i2.p1.2.m2.1.1.2.3.2" xref="S3.I1.i2.p1.2.m2.1.1.2.3.2.cmml">i</mi><mo id="S3.I1.i2.p1.2.m2.1.1.2.3.1" xref="S3.I1.i2.p1.2.m2.1.1.2.3.1.cmml">⁢</mo><mi id="S3.I1.i2.p1.2.m2.1.1.2.3.3" xref="S3.I1.i2.p1.2.m2.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="S3.I1.i2.p1.2.m2.1.1.1" xref="S3.I1.i2.p1.2.m2.1.1.1.cmml">=</mo><mrow id="S3.I1.i2.p1.2.m2.1.1.3" xref="S3.I1.i2.p1.2.m2.1.1.3.cmml"><msub id="S3.I1.i2.p1.2.m2.1.1.3.2" xref="S3.I1.i2.p1.2.m2.1.1.3.2.cmml"><mi id="S3.I1.i2.p1.2.m2.1.1.3.2.2" xref="S3.I1.i2.p1.2.m2.1.1.3.2.2.cmml">δ</mi><mrow id="S3.I1.i2.p1.2.m2.1.1.3.2.3" xref="S3.I1.i2.p1.2.m2.1.1.3.2.3.cmml"><mi id="S3.I1.i2.p1.2.m2.1.1.3.2.3.2" xref="S3.I1.i2.p1.2.m2.1.1.3.2.3.2.cmml">i</mi><mo id="S3.I1.i2.p1.2.m2.1.1.3.2.3.1" xref="S3.I1.i2.p1.2.m2.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.I1.i2.p1.2.m2.1.1.3.2.3.3" xref="S3.I1.i2.p1.2.m2.1.1.3.2.3.3.cmml">j</mi></mrow></msub><mo id="S3.I1.i2.p1.2.m2.1.1.3.1" xref="S3.I1.i2.p1.2.m2.1.1.3.1.cmml">−</mo><mrow id="S3.I1.i2.p1.2.m2.1.1.3.3" xref="S3.I1.i2.p1.2.m2.1.1.3.3.cmml"><mn id="S3.I1.i2.p1.2.m2.1.1.3.3.2" xref="S3.I1.i2.p1.2.m2.1.1.3.3.2.cmml">1</mn><mo id="S3.I1.i2.p1.2.m2.1.1.3.3.1" xref="S3.I1.i2.p1.2.m2.1.1.3.3.1.cmml">/</mo><mi id="S3.I1.i2.p1.2.m2.1.1.3.3.3" xref="S3.I1.i2.p1.2.m2.1.1.3.3.3.cmml">m</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.2.m2.1b"><apply id="S3.I1.i2.p1.2.m2.1.1.cmml" xref="S3.I1.i2.p1.2.m2.1.1"><eq id="S3.I1.i2.p1.2.m2.1.1.1.cmml" xref="S3.I1.i2.p1.2.m2.1.1.1"></eq><apply id="S3.I1.i2.p1.2.m2.1.1.2.cmml" xref="S3.I1.i2.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.I1.i2.p1.2.m2.1.1.2.1.cmml" xref="S3.I1.i2.p1.2.m2.1.1.2">subscript</csymbol><ci id="S3.I1.i2.p1.2.m2.1.1.2.2.cmml" xref="S3.I1.i2.p1.2.m2.1.1.2.2">𝐿</ci><apply id="S3.I1.i2.p1.2.m2.1.1.2.3.cmml" xref="S3.I1.i2.p1.2.m2.1.1.2.3"><times id="S3.I1.i2.p1.2.m2.1.1.2.3.1.cmml" xref="S3.I1.i2.p1.2.m2.1.1.2.3.1"></times><ci id="S3.I1.i2.p1.2.m2.1.1.2.3.2.cmml" xref="S3.I1.i2.p1.2.m2.1.1.2.3.2">𝑖</ci><ci id="S3.I1.i2.p1.2.m2.1.1.2.3.3.cmml" xref="S3.I1.i2.p1.2.m2.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S3.I1.i2.p1.2.m2.1.1.3.cmml" xref="S3.I1.i2.p1.2.m2.1.1.3"><minus id="S3.I1.i2.p1.2.m2.1.1.3.1.cmml" xref="S3.I1.i2.p1.2.m2.1.1.3.1"></minus><apply id="S3.I1.i2.p1.2.m2.1.1.3.2.cmml" xref="S3.I1.i2.p1.2.m2.1.1.3.2"><csymbol cd="ambiguous" id="S3.I1.i2.p1.2.m2.1.1.3.2.1.cmml" xref="S3.I1.i2.p1.2.m2.1.1.3.2">subscript</csymbol><ci id="S3.I1.i2.p1.2.m2.1.1.3.2.2.cmml" xref="S3.I1.i2.p1.2.m2.1.1.3.2.2">𝛿</ci><apply id="S3.I1.i2.p1.2.m2.1.1.3.2.3.cmml" xref="S3.I1.i2.p1.2.m2.1.1.3.2.3"><times id="S3.I1.i2.p1.2.m2.1.1.3.2.3.1.cmml" xref="S3.I1.i2.p1.2.m2.1.1.3.2.3.1"></times><ci id="S3.I1.i2.p1.2.m2.1.1.3.2.3.2.cmml" xref="S3.I1.i2.p1.2.m2.1.1.3.2.3.2">𝑖</ci><ci id="S3.I1.i2.p1.2.m2.1.1.3.2.3.3.cmml" xref="S3.I1.i2.p1.2.m2.1.1.3.2.3.3">𝑗</ci></apply></apply><apply id="S3.I1.i2.p1.2.m2.1.1.3.3.cmml" xref="S3.I1.i2.p1.2.m2.1.1.3.3"><divide id="S3.I1.i2.p1.2.m2.1.1.3.3.1.cmml" xref="S3.I1.i2.p1.2.m2.1.1.3.3.1"></divide><cn id="S3.I1.i2.p1.2.m2.1.1.3.3.2.cmml" type="integer" xref="S3.I1.i2.p1.2.m2.1.1.3.3.2">1</cn><ci id="S3.I1.i2.p1.2.m2.1.1.3.3.3.cmml" xref="S3.I1.i2.p1.2.m2.1.1.3.3.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.2.m2.1c">L_{ij}=\delta_{ij}-1/m</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i2.p1.2.m2.1d">italic_L start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = italic_δ start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT - 1 / italic_m</annotation></semantics></math>. This step is closely related to multi-dimensional scaling (MDS) <cite class="ltx_cite ltx_citemacro_citep">(Chen et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib8" title="">2007</a>)</cite>.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para ltx_noindent" id="S3.I1.i3.p1">
<p class="ltx_p" id="S3.I1.i3.p1.5">Perform the eigenvalue decomposition <math alttext="W=U\Sigma U^{T}" class="ltx_Math" display="inline" id="S3.I1.i3.p1.1.m1.1"><semantics id="S3.I1.i3.p1.1.m1.1a"><mrow id="S3.I1.i3.p1.1.m1.1.1" xref="S3.I1.i3.p1.1.m1.1.1.cmml"><mi id="S3.I1.i3.p1.1.m1.1.1.2" xref="S3.I1.i3.p1.1.m1.1.1.2.cmml">W</mi><mo id="S3.I1.i3.p1.1.m1.1.1.1" xref="S3.I1.i3.p1.1.m1.1.1.1.cmml">=</mo><mrow id="S3.I1.i3.p1.1.m1.1.1.3" xref="S3.I1.i3.p1.1.m1.1.1.3.cmml"><mi id="S3.I1.i3.p1.1.m1.1.1.3.2" xref="S3.I1.i3.p1.1.m1.1.1.3.2.cmml">U</mi><mo id="S3.I1.i3.p1.1.m1.1.1.3.1" xref="S3.I1.i3.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.I1.i3.p1.1.m1.1.1.3.3" mathvariant="normal" xref="S3.I1.i3.p1.1.m1.1.1.3.3.cmml">Σ</mi><mo id="S3.I1.i3.p1.1.m1.1.1.3.1a" xref="S3.I1.i3.p1.1.m1.1.1.3.1.cmml">⁢</mo><msup id="S3.I1.i3.p1.1.m1.1.1.3.4" xref="S3.I1.i3.p1.1.m1.1.1.3.4.cmml"><mi id="S3.I1.i3.p1.1.m1.1.1.3.4.2" xref="S3.I1.i3.p1.1.m1.1.1.3.4.2.cmml">U</mi><mi id="S3.I1.i3.p1.1.m1.1.1.3.4.3" xref="S3.I1.i3.p1.1.m1.1.1.3.4.3.cmml">T</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i3.p1.1.m1.1b"><apply id="S3.I1.i3.p1.1.m1.1.1.cmml" xref="S3.I1.i3.p1.1.m1.1.1"><eq id="S3.I1.i3.p1.1.m1.1.1.1.cmml" xref="S3.I1.i3.p1.1.m1.1.1.1"></eq><ci id="S3.I1.i3.p1.1.m1.1.1.2.cmml" xref="S3.I1.i3.p1.1.m1.1.1.2">𝑊</ci><apply id="S3.I1.i3.p1.1.m1.1.1.3.cmml" xref="S3.I1.i3.p1.1.m1.1.1.3"><times id="S3.I1.i3.p1.1.m1.1.1.3.1.cmml" xref="S3.I1.i3.p1.1.m1.1.1.3.1"></times><ci id="S3.I1.i3.p1.1.m1.1.1.3.2.cmml" xref="S3.I1.i3.p1.1.m1.1.1.3.2">𝑈</ci><ci id="S3.I1.i3.p1.1.m1.1.1.3.3.cmml" xref="S3.I1.i3.p1.1.m1.1.1.3.3">Σ</ci><apply id="S3.I1.i3.p1.1.m1.1.1.3.4.cmml" xref="S3.I1.i3.p1.1.m1.1.1.3.4"><csymbol cd="ambiguous" id="S3.I1.i3.p1.1.m1.1.1.3.4.1.cmml" xref="S3.I1.i3.p1.1.m1.1.1.3.4">superscript</csymbol><ci id="S3.I1.i3.p1.1.m1.1.1.3.4.2.cmml" xref="S3.I1.i3.p1.1.m1.1.1.3.4.2">𝑈</ci><ci id="S3.I1.i3.p1.1.m1.1.1.3.4.3.cmml" xref="S3.I1.i3.p1.1.m1.1.1.3.4.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i3.p1.1.m1.1c">W=U\Sigma U^{T}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i3.p1.1.m1.1d">italic_W = italic_U roman_Σ italic_U start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math>.
The diagonal entries in <math alttext="\Sigma" class="ltx_Math" display="inline" id="S3.I1.i3.p1.2.m2.1"><semantics id="S3.I1.i3.p1.2.m2.1a"><mi id="S3.I1.i3.p1.2.m2.1.1" mathvariant="normal" xref="S3.I1.i3.p1.2.m2.1.1.cmml">Σ</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i3.p1.2.m2.1b"><ci id="S3.I1.i3.p1.2.m2.1.1.cmml" xref="S3.I1.i3.p1.2.m2.1.1">Σ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i3.p1.2.m2.1c">\Sigma</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i3.p1.2.m2.1d">roman_Σ</annotation></semantics></math>, sorted in descending order, represent the eigenvalues of <math alttext="W" class="ltx_Math" display="inline" id="S3.I1.i3.p1.3.m3.1"><semantics id="S3.I1.i3.p1.3.m3.1a"><mi id="S3.I1.i3.p1.3.m3.1.1" xref="S3.I1.i3.p1.3.m3.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i3.p1.3.m3.1b"><ci id="S3.I1.i3.p1.3.m3.1.1.cmml" xref="S3.I1.i3.p1.3.m3.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i3.p1.3.m3.1c">W</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i3.p1.3.m3.1d">italic_W</annotation></semantics></math>.
The embedding coordinates for the PDFs are given by <math alttext="U\Sigma^{1/2}" class="ltx_Math" display="inline" id="S3.I1.i3.p1.4.m4.1"><semantics id="S3.I1.i3.p1.4.m4.1a"><mrow id="S3.I1.i3.p1.4.m4.1.1" xref="S3.I1.i3.p1.4.m4.1.1.cmml"><mi id="S3.I1.i3.p1.4.m4.1.1.2" xref="S3.I1.i3.p1.4.m4.1.1.2.cmml">U</mi><mo id="S3.I1.i3.p1.4.m4.1.1.1" xref="S3.I1.i3.p1.4.m4.1.1.1.cmml">⁢</mo><msup id="S3.I1.i3.p1.4.m4.1.1.3" xref="S3.I1.i3.p1.4.m4.1.1.3.cmml"><mi id="S3.I1.i3.p1.4.m4.1.1.3.2" mathvariant="normal" xref="S3.I1.i3.p1.4.m4.1.1.3.2.cmml">Σ</mi><mrow id="S3.I1.i3.p1.4.m4.1.1.3.3" xref="S3.I1.i3.p1.4.m4.1.1.3.3.cmml"><mn id="S3.I1.i3.p1.4.m4.1.1.3.3.2" xref="S3.I1.i3.p1.4.m4.1.1.3.3.2.cmml">1</mn><mo id="S3.I1.i3.p1.4.m4.1.1.3.3.1" xref="S3.I1.i3.p1.4.m4.1.1.3.3.1.cmml">/</mo><mn id="S3.I1.i3.p1.4.m4.1.1.3.3.3" xref="S3.I1.i3.p1.4.m4.1.1.3.3.3.cmml">2</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i3.p1.4.m4.1b"><apply id="S3.I1.i3.p1.4.m4.1.1.cmml" xref="S3.I1.i3.p1.4.m4.1.1"><times id="S3.I1.i3.p1.4.m4.1.1.1.cmml" xref="S3.I1.i3.p1.4.m4.1.1.1"></times><ci id="S3.I1.i3.p1.4.m4.1.1.2.cmml" xref="S3.I1.i3.p1.4.m4.1.1.2">𝑈</ci><apply id="S3.I1.i3.p1.4.m4.1.1.3.cmml" xref="S3.I1.i3.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.I1.i3.p1.4.m4.1.1.3.1.cmml" xref="S3.I1.i3.p1.4.m4.1.1.3">superscript</csymbol><ci id="S3.I1.i3.p1.4.m4.1.1.3.2.cmml" xref="S3.I1.i3.p1.4.m4.1.1.3.2">Σ</ci><apply id="S3.I1.i3.p1.4.m4.1.1.3.3.cmml" xref="S3.I1.i3.p1.4.m4.1.1.3.3"><divide id="S3.I1.i3.p1.4.m4.1.1.3.3.1.cmml" xref="S3.I1.i3.p1.4.m4.1.1.3.3.1"></divide><cn id="S3.I1.i3.p1.4.m4.1.1.3.3.2.cmml" type="integer" xref="S3.I1.i3.p1.4.m4.1.1.3.3.2">1</cn><cn id="S3.I1.i3.p1.4.m4.1.1.3.3.3.cmml" type="integer" xref="S3.I1.i3.p1.4.m4.1.1.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i3.p1.4.m4.1c">U\Sigma^{1/2}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i3.p1.4.m4.1d">italic_U roman_Σ start_POSTSUPERSCRIPT 1 / 2 end_POSTSUPERSCRIPT</annotation></semantics></math>, where the columns of <math alttext="U" class="ltx_Math" display="inline" id="S3.I1.i3.p1.5.m5.1"><semantics id="S3.I1.i3.p1.5.m5.1a"><mi id="S3.I1.i3.p1.5.m5.1.1" xref="S3.I1.i3.p1.5.m5.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i3.p1.5.m5.1b"><ci id="S3.I1.i3.p1.5.m5.1.1.cmml" xref="S3.I1.i3.p1.5.m5.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i3.p1.5.m5.1c">U</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i3.p1.5.m5.1d">italic_U</annotation></semantics></math> are the corresponding eigenvectors.</p>
</div>
</li>
</ol>
<p class="ltx_p" id="S3.SS1.p2.1">The eigenvalues in <math alttext="\Sigma" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><mi id="S3.SS1.p2.1.m1.1.1" mathvariant="normal" xref="S3.SS1.p2.1.m1.1.1.cmml">Σ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">Σ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\Sigma</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">roman_Σ</annotation></semantics></math> represent the amount of variance explained by each dimension in the embedded probability space.
The cumulative fraction of total variance captured with an increasing number of dimensions is shown in <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#S2.F2" title="In Density Estimation. ‣ 2 Background ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">2</span></a> (c).
In our main experiments, approximately 90% of the Hellinger distance variance can be captured in just two dimensions, enabling faithful 2D visualization of the DE trajectories.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Classical DE algorithms</h3>
<section class="ltx_paragraph" id="S3.SS2.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Kernel density estimation.</h5>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p1.5">Kernel Density Estimation (KDE) is a non-parametric method for estimating the probability density function of a random variable based on a finite data sample.
Given <math alttext="n" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.1.m1.1"><semantics id="S3.SS2.SSS0.Px1.p1.1.m1.1a"><mi id="S3.SS2.SSS0.Px1.p1.1.m1.1.1" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.1.m1.1b"><ci id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.1.m1.1d">italic_n</annotation></semantics></math> samples <math alttext="X_{1},X_{2},\ldots,X_{n}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.2.m2.4"><semantics id="S3.SS2.SSS0.Px1.p1.2.m2.4a"><mrow id="S3.SS2.SSS0.Px1.p1.2.m2.4.4.3" xref="S3.SS2.SSS0.Px1.p1.2.m2.4.4.4.cmml"><msub id="S3.SS2.SSS0.Px1.p1.2.m2.2.2.1.1" xref="S3.SS2.SSS0.Px1.p1.2.m2.2.2.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.2.m2.2.2.1.1.2" xref="S3.SS2.SSS0.Px1.p1.2.m2.2.2.1.1.2.cmml">X</mi><mn id="S3.SS2.SSS0.Px1.p1.2.m2.2.2.1.1.3" xref="S3.SS2.SSS0.Px1.p1.2.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.SSS0.Px1.p1.2.m2.4.4.3.4" xref="S3.SS2.SSS0.Px1.p1.2.m2.4.4.4.cmml">,</mo><msub id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2.2" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2.2.cmml"><mi id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2.2.2" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2.2.2.cmml">X</mi><mn id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2.2.3" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2.2.3.cmml">2</mn></msub><mo id="S3.SS2.SSS0.Px1.p1.2.m2.4.4.3.5" xref="S3.SS2.SSS0.Px1.p1.2.m2.4.4.4.cmml">,</mo><mi id="S3.SS2.SSS0.Px1.p1.2.m2.1.1" mathvariant="normal" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.cmml">…</mi><mo id="S3.SS2.SSS0.Px1.p1.2.m2.4.4.3.6" xref="S3.SS2.SSS0.Px1.p1.2.m2.4.4.4.cmml">,</mo><msub id="S3.SS2.SSS0.Px1.p1.2.m2.4.4.3.3" xref="S3.SS2.SSS0.Px1.p1.2.m2.4.4.3.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.2.m2.4.4.3.3.2" xref="S3.SS2.SSS0.Px1.p1.2.m2.4.4.3.3.2.cmml">X</mi><mi id="S3.SS2.SSS0.Px1.p1.2.m2.4.4.3.3.3" xref="S3.SS2.SSS0.Px1.p1.2.m2.4.4.3.3.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.2.m2.4b"><list id="S3.SS2.SSS0.Px1.p1.2.m2.4.4.4.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.4.4.3"><apply id="S3.SS2.SSS0.Px1.p1.2.m2.2.2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.2.m2.2.2.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.2.2.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.2.m2.2.2.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.2.2.1.1.2">𝑋</ci><cn id="S3.SS2.SSS0.Px1.p1.2.m2.2.2.1.1.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p1.2.m2.2.2.1.1.3">1</cn></apply><apply id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2.2.2">𝑋</ci><cn id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2.2.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2.2.3">2</cn></apply><ci id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1">…</ci><apply id="S3.SS2.SSS0.Px1.p1.2.m2.4.4.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.2.m2.4.4.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.4.4.3.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.2.m2.4.4.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.4.4.3.3.2">𝑋</ci><ci id="S3.SS2.SSS0.Px1.p1.2.m2.4.4.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.4.4.3.3.3">𝑛</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.2.m2.4c">X_{1},X_{2},\ldots,X_{n}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.2.m2.4d">italic_X start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_X start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_X start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math> drawn from some distribution with an unknown density function <math alttext="f" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.3.m3.1"><semantics id="S3.SS2.SSS0.Px1.p1.3.m3.1a"><mi id="S3.SS2.SSS0.Px1.p1.3.m3.1.1" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.3.m3.1b"><ci id="S3.SS2.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.3.m3.1c">f</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.3.m3.1d">italic_f</annotation></semantics></math>, the kernel density estimator <math alttext="\hat{p}_{h}(x)" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.4.m4.1"><semantics id="S3.SS2.SSS0.Px1.p1.4.m4.1a"><mrow id="S3.SS2.SSS0.Px1.p1.4.m4.1.2" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.2.cmml"><msub id="S3.SS2.SSS0.Px1.p1.4.m4.1.2.2" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.2.2.cmml"><mover accent="true" id="S3.SS2.SSS0.Px1.p1.4.m4.1.2.2.2" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px1.p1.4.m4.1.2.2.2.2" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.2.2.2.2.cmml">p</mi><mo id="S3.SS2.SSS0.Px1.p1.4.m4.1.2.2.2.1" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.2.2.2.1.cmml">^</mo></mover><mi id="S3.SS2.SSS0.Px1.p1.4.m4.1.2.2.3" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.2.2.3.cmml">h</mi></msub><mo id="S3.SS2.SSS0.Px1.p1.4.m4.1.2.1" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.SSS0.Px1.p1.4.m4.1.2.3.2" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.2.cmml"><mo id="S3.SS2.SSS0.Px1.p1.4.m4.1.2.3.2.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.2.cmml">(</mo><mi id="S3.SS2.SSS0.Px1.p1.4.m4.1.1" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.1.cmml">x</mi><mo id="S3.SS2.SSS0.Px1.p1.4.m4.1.2.3.2.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.4.m4.1b"><apply id="S3.SS2.SSS0.Px1.p1.4.m4.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.2"><times id="S3.SS2.SSS0.Px1.p1.4.m4.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.2.1"></times><apply id="S3.SS2.SSS0.Px1.p1.4.m4.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.4.m4.1.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.2.2">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p1.4.m4.1.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.2.2.2"><ci id="S3.SS2.SSS0.Px1.p1.4.m4.1.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.2.2.2.1">^</ci><ci id="S3.SS2.SSS0.Px1.p1.4.m4.1.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.2.2.2.2">𝑝</ci></apply><ci id="S3.SS2.SSS0.Px1.p1.4.m4.1.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.2.2.3">ℎ</ci></apply><ci id="S3.SS2.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.4.m4.1c">\hat{p}_{h}(x)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.4.m4.1d">over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ( italic_x )</annotation></semantics></math> is a function over the support of <math alttext="x" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.5.m5.1"><semantics id="S3.SS2.SSS0.Px1.p1.5.m5.1a"><mi id="S3.SS2.SSS0.Px1.p1.5.m5.1.1" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.5.m5.1b"><ci id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.5.m5.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.5.m5.1d">italic_x</annotation></semantics></math> defined as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{p}_{h}(x)=\frac{1}{nh}\sum_{i=1}^{n}K\left(\frac{x-X_{i}}{h}\right)," class="ltx_Math" display="block" id="S3.E3.m1.3"><semantics id="S3.E3.m1.3a"><mrow id="S3.E3.m1.3.3.1" xref="S3.E3.m1.3.3.1.1.cmml"><mrow id="S3.E3.m1.3.3.1.1" xref="S3.E3.m1.3.3.1.1.cmml"><mrow id="S3.E3.m1.3.3.1.1.2" xref="S3.E3.m1.3.3.1.1.2.cmml"><msub id="S3.E3.m1.3.3.1.1.2.2" xref="S3.E3.m1.3.3.1.1.2.2.cmml"><mover accent="true" id="S3.E3.m1.3.3.1.1.2.2.2" xref="S3.E3.m1.3.3.1.1.2.2.2.cmml"><mi id="S3.E3.m1.3.3.1.1.2.2.2.2" xref="S3.E3.m1.3.3.1.1.2.2.2.2.cmml">p</mi><mo id="S3.E3.m1.3.3.1.1.2.2.2.1" xref="S3.E3.m1.3.3.1.1.2.2.2.1.cmml">^</mo></mover><mi id="S3.E3.m1.3.3.1.1.2.2.3" xref="S3.E3.m1.3.3.1.1.2.2.3.cmml">h</mi></msub><mo id="S3.E3.m1.3.3.1.1.2.1" xref="S3.E3.m1.3.3.1.1.2.1.cmml">⁢</mo><mrow id="S3.E3.m1.3.3.1.1.2.3.2" xref="S3.E3.m1.3.3.1.1.2.cmml"><mo id="S3.E3.m1.3.3.1.1.2.3.2.1" stretchy="false" xref="S3.E3.m1.3.3.1.1.2.cmml">(</mo><mi id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">x</mi><mo id="S3.E3.m1.3.3.1.1.2.3.2.2" stretchy="false" xref="S3.E3.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.3.3.1.1.1" xref="S3.E3.m1.3.3.1.1.1.cmml">=</mo><mrow id="S3.E3.m1.3.3.1.1.3" xref="S3.E3.m1.3.3.1.1.3.cmml"><mfrac id="S3.E3.m1.3.3.1.1.3.2" xref="S3.E3.m1.3.3.1.1.3.2.cmml"><mn id="S3.E3.m1.3.3.1.1.3.2.2" xref="S3.E3.m1.3.3.1.1.3.2.2.cmml">1</mn><mrow id="S3.E3.m1.3.3.1.1.3.2.3" xref="S3.E3.m1.3.3.1.1.3.2.3.cmml"><mi id="S3.E3.m1.3.3.1.1.3.2.3.2" xref="S3.E3.m1.3.3.1.1.3.2.3.2.cmml">n</mi><mo id="S3.E3.m1.3.3.1.1.3.2.3.1" xref="S3.E3.m1.3.3.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E3.m1.3.3.1.1.3.2.3.3" xref="S3.E3.m1.3.3.1.1.3.2.3.3.cmml">h</mi></mrow></mfrac><mo id="S3.E3.m1.3.3.1.1.3.1" xref="S3.E3.m1.3.3.1.1.3.1.cmml">⁢</mo><mrow id="S3.E3.m1.3.3.1.1.3.3" xref="S3.E3.m1.3.3.1.1.3.3.cmml"><munderover id="S3.E3.m1.3.3.1.1.3.3.1" xref="S3.E3.m1.3.3.1.1.3.3.1.cmml"><mo id="S3.E3.m1.3.3.1.1.3.3.1.2.2" movablelimits="false" xref="S3.E3.m1.3.3.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="S3.E3.m1.3.3.1.1.3.3.1.2.3" xref="S3.E3.m1.3.3.1.1.3.3.1.2.3.cmml"><mi id="S3.E3.m1.3.3.1.1.3.3.1.2.3.2" xref="S3.E3.m1.3.3.1.1.3.3.1.2.3.2.cmml">i</mi><mo id="S3.E3.m1.3.3.1.1.3.3.1.2.3.1" xref="S3.E3.m1.3.3.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S3.E3.m1.3.3.1.1.3.3.1.2.3.3" xref="S3.E3.m1.3.3.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E3.m1.3.3.1.1.3.3.1.3" xref="S3.E3.m1.3.3.1.1.3.3.1.3.cmml">n</mi></munderover><mrow id="S3.E3.m1.3.3.1.1.3.3.2" xref="S3.E3.m1.3.3.1.1.3.3.2.cmml"><mi id="S3.E3.m1.3.3.1.1.3.3.2.2" xref="S3.E3.m1.3.3.1.1.3.3.2.2.cmml">K</mi><mo id="S3.E3.m1.3.3.1.1.3.3.2.1" xref="S3.E3.m1.3.3.1.1.3.3.2.1.cmml">⁢</mo><mrow id="S3.E3.m1.3.3.1.1.3.3.2.3.2" xref="S3.E3.m1.2.2.cmml"><mo id="S3.E3.m1.3.3.1.1.3.3.2.3.2.1" xref="S3.E3.m1.2.2.cmml">(</mo><mfrac id="S3.E3.m1.2.2" xref="S3.E3.m1.2.2.cmml"><mrow id="S3.E3.m1.2.2.2" xref="S3.E3.m1.2.2.2.cmml"><mi id="S3.E3.m1.2.2.2.2" xref="S3.E3.m1.2.2.2.2.cmml">x</mi><mo id="S3.E3.m1.2.2.2.1" xref="S3.E3.m1.2.2.2.1.cmml">−</mo><msub id="S3.E3.m1.2.2.2.3" xref="S3.E3.m1.2.2.2.3.cmml"><mi id="S3.E3.m1.2.2.2.3.2" xref="S3.E3.m1.2.2.2.3.2.cmml">X</mi><mi id="S3.E3.m1.2.2.2.3.3" xref="S3.E3.m1.2.2.2.3.3.cmml">i</mi></msub></mrow><mi id="S3.E3.m1.2.2.3" xref="S3.E3.m1.2.2.3.cmml">h</mi></mfrac><mo id="S3.E3.m1.3.3.1.1.3.3.2.3.2.2" xref="S3.E3.m1.2.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E3.m1.3.3.1.2" xref="S3.E3.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.3b"><apply id="S3.E3.m1.3.3.1.1.cmml" xref="S3.E3.m1.3.3.1"><eq id="S3.E3.m1.3.3.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1"></eq><apply id="S3.E3.m1.3.3.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.2"><times id="S3.E3.m1.3.3.1.1.2.1.cmml" xref="S3.E3.m1.3.3.1.1.2.1"></times><apply id="S3.E3.m1.3.3.1.1.2.2.cmml" xref="S3.E3.m1.3.3.1.1.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.2.2.1.cmml" xref="S3.E3.m1.3.3.1.1.2.2">subscript</csymbol><apply id="S3.E3.m1.3.3.1.1.2.2.2.cmml" xref="S3.E3.m1.3.3.1.1.2.2.2"><ci id="S3.E3.m1.3.3.1.1.2.2.2.1.cmml" xref="S3.E3.m1.3.3.1.1.2.2.2.1">^</ci><ci id="S3.E3.m1.3.3.1.1.2.2.2.2.cmml" xref="S3.E3.m1.3.3.1.1.2.2.2.2">𝑝</ci></apply><ci id="S3.E3.m1.3.3.1.1.2.2.3.cmml" xref="S3.E3.m1.3.3.1.1.2.2.3">ℎ</ci></apply><ci id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">𝑥</ci></apply><apply id="S3.E3.m1.3.3.1.1.3.cmml" xref="S3.E3.m1.3.3.1.1.3"><times id="S3.E3.m1.3.3.1.1.3.1.cmml" xref="S3.E3.m1.3.3.1.1.3.1"></times><apply id="S3.E3.m1.3.3.1.1.3.2.cmml" xref="S3.E3.m1.3.3.1.1.3.2"><divide id="S3.E3.m1.3.3.1.1.3.2.1.cmml" xref="S3.E3.m1.3.3.1.1.3.2"></divide><cn id="S3.E3.m1.3.3.1.1.3.2.2.cmml" type="integer" xref="S3.E3.m1.3.3.1.1.3.2.2">1</cn><apply id="S3.E3.m1.3.3.1.1.3.2.3.cmml" xref="S3.E3.m1.3.3.1.1.3.2.3"><times id="S3.E3.m1.3.3.1.1.3.2.3.1.cmml" xref="S3.E3.m1.3.3.1.1.3.2.3.1"></times><ci id="S3.E3.m1.3.3.1.1.3.2.3.2.cmml" xref="S3.E3.m1.3.3.1.1.3.2.3.2">𝑛</ci><ci id="S3.E3.m1.3.3.1.1.3.2.3.3.cmml" xref="S3.E3.m1.3.3.1.1.3.2.3.3">ℎ</ci></apply></apply><apply id="S3.E3.m1.3.3.1.1.3.3.cmml" xref="S3.E3.m1.3.3.1.1.3.3"><apply id="S3.E3.m1.3.3.1.1.3.3.1.cmml" xref="S3.E3.m1.3.3.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.3.3.1.1.cmml" xref="S3.E3.m1.3.3.1.1.3.3.1">superscript</csymbol><apply id="S3.E3.m1.3.3.1.1.3.3.1.2.cmml" xref="S3.E3.m1.3.3.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.3.3.1.2.1.cmml" xref="S3.E3.m1.3.3.1.1.3.3.1">subscript</csymbol><sum id="S3.E3.m1.3.3.1.1.3.3.1.2.2.cmml" xref="S3.E3.m1.3.3.1.1.3.3.1.2.2"></sum><apply id="S3.E3.m1.3.3.1.1.3.3.1.2.3.cmml" xref="S3.E3.m1.3.3.1.1.3.3.1.2.3"><eq id="S3.E3.m1.3.3.1.1.3.3.1.2.3.1.cmml" xref="S3.E3.m1.3.3.1.1.3.3.1.2.3.1"></eq><ci id="S3.E3.m1.3.3.1.1.3.3.1.2.3.2.cmml" xref="S3.E3.m1.3.3.1.1.3.3.1.2.3.2">𝑖</ci><cn id="S3.E3.m1.3.3.1.1.3.3.1.2.3.3.cmml" type="integer" xref="S3.E3.m1.3.3.1.1.3.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E3.m1.3.3.1.1.3.3.1.3.cmml" xref="S3.E3.m1.3.3.1.1.3.3.1.3">𝑛</ci></apply><apply id="S3.E3.m1.3.3.1.1.3.3.2.cmml" xref="S3.E3.m1.3.3.1.1.3.3.2"><times id="S3.E3.m1.3.3.1.1.3.3.2.1.cmml" xref="S3.E3.m1.3.3.1.1.3.3.2.1"></times><ci id="S3.E3.m1.3.3.1.1.3.3.2.2.cmml" xref="S3.E3.m1.3.3.1.1.3.3.2.2">𝐾</ci><apply id="S3.E3.m1.2.2.cmml" xref="S3.E3.m1.3.3.1.1.3.3.2.3.2"><divide id="S3.E3.m1.2.2.1.cmml" xref="S3.E3.m1.3.3.1.1.3.3.2.3.2"></divide><apply id="S3.E3.m1.2.2.2.cmml" xref="S3.E3.m1.2.2.2"><minus id="S3.E3.m1.2.2.2.1.cmml" xref="S3.E3.m1.2.2.2.1"></minus><ci id="S3.E3.m1.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2">𝑥</ci><apply id="S3.E3.m1.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.3.1.cmml" xref="S3.E3.m1.2.2.2.3">subscript</csymbol><ci id="S3.E3.m1.2.2.2.3.2.cmml" xref="S3.E3.m1.2.2.2.3.2">𝑋</ci><ci id="S3.E3.m1.2.2.2.3.3.cmml" xref="S3.E3.m1.2.2.2.3.3">𝑖</ci></apply></apply><ci id="S3.E3.m1.2.2.3.cmml" xref="S3.E3.m1.2.2.3">ℎ</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.3c">\hat{p}_{h}(x)=\frac{1}{nh}\sum_{i=1}^{n}K\left(\frac{x-X_{i}}{h}\right),</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.3d">over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ( italic_x ) = divide start_ARG 1 end_ARG start_ARG italic_n italic_h end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_K ( divide start_ARG italic_x - italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG start_ARG italic_h end_ARG ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p1.9">where <math alttext="K" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.6.m1.1"><semantics id="S3.SS2.SSS0.Px1.p1.6.m1.1a"><mi id="S3.SS2.SSS0.Px1.p1.6.m1.1.1" xref="S3.SS2.SSS0.Px1.p1.6.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.6.m1.1b"><ci id="S3.SS2.SSS0.Px1.p1.6.m1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.6.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.6.m1.1d">italic_K</annotation></semantics></math> is the kernel function and <math alttext="h&gt;0" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.7.m2.1"><semantics id="S3.SS2.SSS0.Px1.p1.7.m2.1a"><mrow id="S3.SS2.SSS0.Px1.p1.7.m2.1.1" xref="S3.SS2.SSS0.Px1.p1.7.m2.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.7.m2.1.1.2" xref="S3.SS2.SSS0.Px1.p1.7.m2.1.1.2.cmml">h</mi><mo id="S3.SS2.SSS0.Px1.p1.7.m2.1.1.1" xref="S3.SS2.SSS0.Px1.p1.7.m2.1.1.1.cmml">&gt;</mo><mn id="S3.SS2.SSS0.Px1.p1.7.m2.1.1.3" xref="S3.SS2.SSS0.Px1.p1.7.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.7.m2.1b"><apply id="S3.SS2.SSS0.Px1.p1.7.m2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m2.1.1"><gt id="S3.SS2.SSS0.Px1.p1.7.m2.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m2.1.1.1"></gt><ci id="S3.SS2.SSS0.Px1.p1.7.m2.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m2.1.1.2">ℎ</ci><cn id="S3.SS2.SSS0.Px1.p1.7.m2.1.1.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p1.7.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.7.m2.1c">h&gt;0</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.7.m2.1d">italic_h &gt; 0</annotation></semantics></math> is the bandwidth (smoothing parameter).
The kernel function <math alttext="K" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.8.m3.1"><semantics id="S3.SS2.SSS0.Px1.p1.8.m3.1a"><mi id="S3.SS2.SSS0.Px1.p1.8.m3.1.1" xref="S3.SS2.SSS0.Px1.p1.8.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.8.m3.1b"><ci id="S3.SS2.SSS0.Px1.p1.8.m3.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.8.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.8.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.8.m3.1d">italic_K</annotation></semantics></math> is typically chosen to be a symmetric probability density function, such as the Gaussian kernel <math alttext="K(u)=\frac{1}{\sqrt{2\pi}}e^{-\frac{1}{2}u^{2}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.9.m4.1"><semantics id="S3.SS2.SSS0.Px1.p1.9.m4.1a"><mrow id="S3.SS2.SSS0.Px1.p1.9.m4.1.2" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.cmml"><mrow id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.2" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.2.cmml"><mi id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.2.2" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.2.2.cmml">K</mi><mo id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.2.1" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.2.1.cmml">⁢</mo><mrow id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.2.3.2" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.2.cmml"><mo id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.2.3.2.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.2.cmml">(</mo><mi id="S3.SS2.SSS0.Px1.p1.9.m4.1.1" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.1.cmml">u</mi><mo id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.2.3.2.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.2.cmml">)</mo></mrow></mrow><mo id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.1" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.1.cmml">=</mo><mrow id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.cmml"><mfrac id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.2" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.2.cmml"><mn id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.2.2" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.2.2.cmml">1</mn><msqrt id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.2.3" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.2.3.cmml"><mrow id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.2.3.2" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.2.3.2.cmml"><mn id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.2.3.2.2" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.2.3.2.2.cmml">2</mn><mo id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.2.3.2.1" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.2.3.2.1.cmml">⁢</mo><mi id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.2.3.2.3" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.2.3.2.3.cmml">π</mi></mrow></msqrt></mfrac><mo id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.1" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.1.cmml">⁢</mo><msup id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.2" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.2.cmml">e</mi><mrow id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.3" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.3.cmml"><mo id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.3a" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.3.cmml">−</mo><mrow id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.3.2" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.3.2.cmml"><mfrac id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.3.2.2" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.3.2.2.cmml"><mn id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.3.2.2.2" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.3.2.2.2.cmml">1</mn><mn id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.3.2.2.3" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.3.2.2.3.cmml">2</mn></mfrac><mo id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.3.2.1" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.3.2.1.cmml">⁢</mo><msup id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.3.2.3" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.3.2.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.3.2.3.2" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.3.2.3.2.cmml">u</mi><mn id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.3.2.3.3" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.3.2.3.3.cmml">2</mn></msup></mrow></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.9.m4.1b"><apply id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2"><eq id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.1"></eq><apply id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.2"><times id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.2.1"></times><ci id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.2.2">𝐾</ci><ci id="S3.SS2.SSS0.Px1.p1.9.m4.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.1">𝑢</ci></apply><apply id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3"><times id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.1"></times><apply id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.2"><divide id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.2"></divide><cn id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.2.2.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.2.2">1</cn><apply id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.2.3"><root id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.2.3a.cmml" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.2.3"></root><apply id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.2.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.2.3.2"><times id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.2.3.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.2.3.2.1"></times><cn id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.2.3.2.2.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.2.3.2.2">2</cn><ci id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.2.3.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.2.3.2.3">𝜋</ci></apply></apply></apply><apply id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.2">𝑒</ci><apply id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.3"><minus id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.3"></minus><apply id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.3.2"><times id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.3.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.3.2.1"></times><apply id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.3.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.3.2.2"><divide id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.3.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.3.2.2"></divide><cn id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.3.2.2.2.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.3.2.2.2">1</cn><cn id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.3.2.2.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.3.2.2.3">2</cn></apply><apply id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.3.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.3.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.3.2.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.3.2.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.3.2.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.3.2.3.2">𝑢</ci><cn id="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.3.2.3.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.2.3.3.3.2.3.3">2</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.9.m4.1c">K(u)=\frac{1}{\sqrt{2\pi}}e^{-\frac{1}{2}u^{2}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.9.m4.1d">italic_K ( italic_u ) = divide start_ARG 1 end_ARG start_ARG square-root start_ARG 2 italic_π end_ARG end_ARG italic_e start_POSTSUPERSCRIPT - divide start_ARG 1 end_ARG start_ARG 2 end_ARG italic_u start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>.
We discuss other kernel shapes in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.SS5.SSS2" title="A.5.2 Optimal kernel shape ‣ A.5 Additional notes on Kernel Density Estimation ‣ Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">A.5.2</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS0.Px1.p2">
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p2.6">The optimal bandwidth schedule is a central object of study in classical KDE literature (Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.SS5" title="A.5 Additional notes on Kernel Density Estimation ‣ Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">A.5</span></a>).
By analyzing the Asymptotic Mean Integrated Squared Error (AMISE) (Equation <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.E12" title="Equation 12 ‣ A.5.1 Optimal Bandwidth ‣ A.5 Additional notes on Kernel Density Estimation ‣ Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">12</span></a>),
researchers have derived a widely accepted scaling for the optimal bandwidth.</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="h(n)=Cn^{-\frac{1}{5}}" class="ltx_Math" display="block" id="S3.E4.m1.1"><semantics id="S3.E4.m1.1a"><mrow id="S3.E4.m1.1.2" xref="S3.E4.m1.1.2.cmml"><mrow id="S3.E4.m1.1.2.2" xref="S3.E4.m1.1.2.2.cmml"><mi id="S3.E4.m1.1.2.2.2" xref="S3.E4.m1.1.2.2.2.cmml">h</mi><mo id="S3.E4.m1.1.2.2.1" xref="S3.E4.m1.1.2.2.1.cmml">⁢</mo><mrow id="S3.E4.m1.1.2.2.3.2" xref="S3.E4.m1.1.2.2.cmml"><mo id="S3.E4.m1.1.2.2.3.2.1" stretchy="false" xref="S3.E4.m1.1.2.2.cmml">(</mo><mi id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml">n</mi><mo id="S3.E4.m1.1.2.2.3.2.2" stretchy="false" xref="S3.E4.m1.1.2.2.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.1.2.1" xref="S3.E4.m1.1.2.1.cmml">=</mo><mrow id="S3.E4.m1.1.2.3" xref="S3.E4.m1.1.2.3.cmml"><mi id="S3.E4.m1.1.2.3.2" xref="S3.E4.m1.1.2.3.2.cmml">C</mi><mo id="S3.E4.m1.1.2.3.1" xref="S3.E4.m1.1.2.3.1.cmml">⁢</mo><msup id="S3.E4.m1.1.2.3.3" xref="S3.E4.m1.1.2.3.3.cmml"><mi id="S3.E4.m1.1.2.3.3.2" xref="S3.E4.m1.1.2.3.3.2.cmml">n</mi><mrow id="S3.E4.m1.1.2.3.3.3" xref="S3.E4.m1.1.2.3.3.3.cmml"><mo id="S3.E4.m1.1.2.3.3.3a" xref="S3.E4.m1.1.2.3.3.3.cmml">−</mo><mfrac id="S3.E4.m1.1.2.3.3.3.2" xref="S3.E4.m1.1.2.3.3.3.2.cmml"><mn id="S3.E4.m1.1.2.3.3.3.2.2" xref="S3.E4.m1.1.2.3.3.3.2.2.cmml">1</mn><mn id="S3.E4.m1.1.2.3.3.3.2.3" xref="S3.E4.m1.1.2.3.3.3.2.3.cmml">5</mn></mfrac></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.1b"><apply id="S3.E4.m1.1.2.cmml" xref="S3.E4.m1.1.2"><eq id="S3.E4.m1.1.2.1.cmml" xref="S3.E4.m1.1.2.1"></eq><apply id="S3.E4.m1.1.2.2.cmml" xref="S3.E4.m1.1.2.2"><times id="S3.E4.m1.1.2.2.1.cmml" xref="S3.E4.m1.1.2.2.1"></times><ci id="S3.E4.m1.1.2.2.2.cmml" xref="S3.E4.m1.1.2.2.2">ℎ</ci><ci id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1">𝑛</ci></apply><apply id="S3.E4.m1.1.2.3.cmml" xref="S3.E4.m1.1.2.3"><times id="S3.E4.m1.1.2.3.1.cmml" xref="S3.E4.m1.1.2.3.1"></times><ci id="S3.E4.m1.1.2.3.2.cmml" xref="S3.E4.m1.1.2.3.2">𝐶</ci><apply id="S3.E4.m1.1.2.3.3.cmml" xref="S3.E4.m1.1.2.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.2.3.3.1.cmml" xref="S3.E4.m1.1.2.3.3">superscript</csymbol><ci id="S3.E4.m1.1.2.3.3.2.cmml" xref="S3.E4.m1.1.2.3.3.2">𝑛</ci><apply id="S3.E4.m1.1.2.3.3.3.cmml" xref="S3.E4.m1.1.2.3.3.3"><minus id="S3.E4.m1.1.2.3.3.3.1.cmml" xref="S3.E4.m1.1.2.3.3.3"></minus><apply id="S3.E4.m1.1.2.3.3.3.2.cmml" xref="S3.E4.m1.1.2.3.3.3.2"><divide id="S3.E4.m1.1.2.3.3.3.2.1.cmml" xref="S3.E4.m1.1.2.3.3.3.2"></divide><cn id="S3.E4.m1.1.2.3.3.3.2.2.cmml" type="integer" xref="S3.E4.m1.1.2.3.3.3.2.2">1</cn><cn id="S3.E4.m1.1.2.3.3.3.2.3.cmml" type="integer" xref="S3.E4.m1.1.2.3.3.3.2.3">5</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.1c">h(n)=Cn^{-\frac{1}{5}}</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.1d">italic_h ( italic_n ) = italic_C italic_n start_POSTSUPERSCRIPT - divide start_ARG 1 end_ARG start_ARG 5 end_ARG end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p2.5">where <math alttext="n" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.1.m1.1"><semantics id="S3.SS2.SSS0.Px1.p2.1.m1.1a"><mi id="S3.SS2.SSS0.Px1.p2.1.m1.1.1" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.1.m1.1b"><ci id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.1.m1.1d">italic_n</annotation></semantics></math> is the sample size and <math alttext="C" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.2.m2.1"><semantics id="S3.SS2.SSS0.Px1.p2.2.m2.1a"><mi id="S3.SS2.SSS0.Px1.p2.2.m2.1.1" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.2.m2.1b"><ci id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.2.m2.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.2.m2.1d">italic_C</annotation></semantics></math> is a pre-coefficient (Equation <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.E13" title="Equation 13 ‣ A.5.1 Optimal Bandwidth ‣ A.5 Additional notes on Kernel Density Estimation ‣ Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">13</span></a>).
In the low-data regime, a larger bandwidth provides more smoothing bias, which compensates for data sparsity.
While the <math alttext="n^{-1/5}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.3.m3.1"><semantics id="S3.SS2.SSS0.Px1.p2.3.m3.1a"><msup id="S3.SS2.SSS0.Px1.p2.3.m3.1.1" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.2" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.2.cmml">n</mi><mrow id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.3" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.3.cmml"><mo id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.3a" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.3.cmml">−</mo><mrow id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.3.2" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.3.2.cmml"><mn id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.3.2.2" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.3.2.2.cmml">1</mn><mo id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.3.2.1" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.3.2.1.cmml">/</mo><mn id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.3.2.3" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.3.2.3.cmml">5</mn></mrow></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.3.m3.1b"><apply id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.2">𝑛</ci><apply id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.3"><minus id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.3"></minus><apply id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.3.2"><divide id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.3.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.3.2.1"></divide><cn id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.3.2.2.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.3.2.2">1</cn><cn id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.3.2.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.3.2.3">5</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.3.m3.1c">n^{-1/5}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.3.m3.1d">italic_n start_POSTSUPERSCRIPT - 1 / 5 end_POSTSUPERSCRIPT</annotation></semantics></math> scaling is widely accepted, determining the pre-coefficient <math alttext="C" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.4.m4.1"><semantics id="S3.SS2.SSS0.Px1.p2.4.m4.1a"><mi id="S3.SS2.SSS0.Px1.p2.4.m4.1.1" xref="S3.SS2.SSS0.Px1.p2.4.m4.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.4.m4.1b"><ci id="S3.SS2.SSS0.Px1.p2.4.m4.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.4.m4.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.4.m4.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.4.m4.1d">italic_C</annotation></semantics></math> is more challenging <cite class="ltx_cite ltx_citemacro_citep">(Wand &amp; Jones, <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib41" title="">1994</a>; Silverman, <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib35" title="">2018</a>)</cite>.
Unless otherwise noted, we use <math alttext="C=1" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.5.m5.1"><semantics id="S3.SS2.SSS0.Px1.p2.5.m5.1a"><mrow id="S3.SS2.SSS0.Px1.p2.5.m5.1.1" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p2.5.m5.1.1.2" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1.2.cmml">C</mi><mo id="S3.SS2.SSS0.Px1.p2.5.m5.1.1.1" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1.1.cmml">=</mo><mn id="S3.SS2.SSS0.Px1.p2.5.m5.1.1.3" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.5.m5.1b"><apply id="S3.SS2.SSS0.Px1.p2.5.m5.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1"><eq id="S3.SS2.SSS0.Px1.p2.5.m5.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1.1"></eq><ci id="S3.SS2.SSS0.Px1.p2.5.m5.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1.2">𝐶</ci><cn id="S3.SS2.SSS0.Px1.p2.5.m5.1.1.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.5.m5.1c">C=1</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.5.m5.1d">italic_C = 1</annotation></semantics></math> for classical KDE in this paper<span class="ltx_note ltx_role_footnote" id="footnote7"><sup class="ltx_note_mark">7</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">7</sup><span class="ltx_tag ltx_tag_note">7</span>In practice, various heuristics have been proposed to determine <math alttext="C" class="ltx_Math" display="inline" id="footnote7.m1.1"><semantics id="footnote7.m1.1b"><mi id="footnote7.m1.1.1" xref="footnote7.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="footnote7.m1.1c"><ci id="footnote7.m1.1.1.cmml" xref="footnote7.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="footnote7.m1.1d">C</annotation><annotation encoding="application/x-llamapun" id="footnote7.m1.1e">italic_C</annotation></semantics></math>, such as Silverman’s rule of thumb <cite class="ltx_cite ltx_citemacro_citep">(Silverman, <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib35" title="">2018</a>)</cite> (see Appendices <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.SS5.SSS1" title="A.5.1 Optimal Bandwidth ‣ A.5 Additional notes on Kernel Density Estimation ‣ Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">A.5.1</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.SS8" title="A.8 KDE with Silverman bandwidth schedule ‣ Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">A.8</span></a>).</span></span></span>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS2.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Bayesian histogram.</h5>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="S3.SS2.SSS0.Px2.p1.10">The Bayesian histogram <cite class="ltx_cite ltx_citemacro_citep">(Lugosi &amp; Nobel, <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib23" title="">1996</a>)</cite> is another non-parametric method for density estimation, and can be formulated as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{p}_{n}(x)=\frac{n_{i}+\alpha}{n+\alpha M}," class="ltx_Math" display="block" id="S3.E5.m1.2"><semantics id="S3.E5.m1.2a"><mrow id="S3.E5.m1.2.2.1" xref="S3.E5.m1.2.2.1.1.cmml"><mrow id="S3.E5.m1.2.2.1.1" xref="S3.E5.m1.2.2.1.1.cmml"><mrow id="S3.E5.m1.2.2.1.1.2" xref="S3.E5.m1.2.2.1.1.2.cmml"><msub id="S3.E5.m1.2.2.1.1.2.2" xref="S3.E5.m1.2.2.1.1.2.2.cmml"><mover accent="true" id="S3.E5.m1.2.2.1.1.2.2.2" xref="S3.E5.m1.2.2.1.1.2.2.2.cmml"><mi id="S3.E5.m1.2.2.1.1.2.2.2.2" xref="S3.E5.m1.2.2.1.1.2.2.2.2.cmml">p</mi><mo id="S3.E5.m1.2.2.1.1.2.2.2.1" xref="S3.E5.m1.2.2.1.1.2.2.2.1.cmml">^</mo></mover><mi id="S3.E5.m1.2.2.1.1.2.2.3" xref="S3.E5.m1.2.2.1.1.2.2.3.cmml">n</mi></msub><mo id="S3.E5.m1.2.2.1.1.2.1" xref="S3.E5.m1.2.2.1.1.2.1.cmml">⁢</mo><mrow id="S3.E5.m1.2.2.1.1.2.3.2" xref="S3.E5.m1.2.2.1.1.2.cmml"><mo id="S3.E5.m1.2.2.1.1.2.3.2.1" stretchy="false" xref="S3.E5.m1.2.2.1.1.2.cmml">(</mo><mi id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml">x</mi><mo id="S3.E5.m1.2.2.1.1.2.3.2.2" stretchy="false" xref="S3.E5.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.2.2.1.1.1" xref="S3.E5.m1.2.2.1.1.1.cmml">=</mo><mfrac id="S3.E5.m1.2.2.1.1.3" xref="S3.E5.m1.2.2.1.1.3.cmml"><mrow id="S3.E5.m1.2.2.1.1.3.2" xref="S3.E5.m1.2.2.1.1.3.2.cmml"><msub id="S3.E5.m1.2.2.1.1.3.2.2" xref="S3.E5.m1.2.2.1.1.3.2.2.cmml"><mi id="S3.E5.m1.2.2.1.1.3.2.2.2" xref="S3.E5.m1.2.2.1.1.3.2.2.2.cmml">n</mi><mi id="S3.E5.m1.2.2.1.1.3.2.2.3" xref="S3.E5.m1.2.2.1.1.3.2.2.3.cmml">i</mi></msub><mo id="S3.E5.m1.2.2.1.1.3.2.1" xref="S3.E5.m1.2.2.1.1.3.2.1.cmml">+</mo><mi id="S3.E5.m1.2.2.1.1.3.2.3" xref="S3.E5.m1.2.2.1.1.3.2.3.cmml">α</mi></mrow><mrow id="S3.E5.m1.2.2.1.1.3.3" xref="S3.E5.m1.2.2.1.1.3.3.cmml"><mi id="S3.E5.m1.2.2.1.1.3.3.2" xref="S3.E5.m1.2.2.1.1.3.3.2.cmml">n</mi><mo id="S3.E5.m1.2.2.1.1.3.3.1" xref="S3.E5.m1.2.2.1.1.3.3.1.cmml">+</mo><mrow id="S3.E5.m1.2.2.1.1.3.3.3" xref="S3.E5.m1.2.2.1.1.3.3.3.cmml"><mi id="S3.E5.m1.2.2.1.1.3.3.3.2" xref="S3.E5.m1.2.2.1.1.3.3.3.2.cmml">α</mi><mo id="S3.E5.m1.2.2.1.1.3.3.3.1" xref="S3.E5.m1.2.2.1.1.3.3.3.1.cmml">⁢</mo><mi id="S3.E5.m1.2.2.1.1.3.3.3.3" xref="S3.E5.m1.2.2.1.1.3.3.3.3.cmml">M</mi></mrow></mrow></mfrac></mrow><mo id="S3.E5.m1.2.2.1.2" xref="S3.E5.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.2b"><apply id="S3.E5.m1.2.2.1.1.cmml" xref="S3.E5.m1.2.2.1"><eq id="S3.E5.m1.2.2.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1"></eq><apply id="S3.E5.m1.2.2.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.2"><times id="S3.E5.m1.2.2.1.1.2.1.cmml" xref="S3.E5.m1.2.2.1.1.2.1"></times><apply id="S3.E5.m1.2.2.1.1.2.2.cmml" xref="S3.E5.m1.2.2.1.1.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.2.2.1.cmml" xref="S3.E5.m1.2.2.1.1.2.2">subscript</csymbol><apply id="S3.E5.m1.2.2.1.1.2.2.2.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2"><ci id="S3.E5.m1.2.2.1.1.2.2.2.1.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2.1">^</ci><ci id="S3.E5.m1.2.2.1.1.2.2.2.2.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2.2">𝑝</ci></apply><ci id="S3.E5.m1.2.2.1.1.2.2.3.cmml" xref="S3.E5.m1.2.2.1.1.2.2.3">𝑛</ci></apply><ci id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1">𝑥</ci></apply><apply id="S3.E5.m1.2.2.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.3"><divide id="S3.E5.m1.2.2.1.1.3.1.cmml" xref="S3.E5.m1.2.2.1.1.3"></divide><apply id="S3.E5.m1.2.2.1.1.3.2.cmml" xref="S3.E5.m1.2.2.1.1.3.2"><plus id="S3.E5.m1.2.2.1.1.3.2.1.cmml" xref="S3.E5.m1.2.2.1.1.3.2.1"></plus><apply id="S3.E5.m1.2.2.1.1.3.2.2.cmml" xref="S3.E5.m1.2.2.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.3.2.2.1.cmml" xref="S3.E5.m1.2.2.1.1.3.2.2">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.3.2.2.2.cmml" xref="S3.E5.m1.2.2.1.1.3.2.2.2">𝑛</ci><ci id="S3.E5.m1.2.2.1.1.3.2.2.3.cmml" xref="S3.E5.m1.2.2.1.1.3.2.2.3">𝑖</ci></apply><ci id="S3.E5.m1.2.2.1.1.3.2.3.cmml" xref="S3.E5.m1.2.2.1.1.3.2.3">𝛼</ci></apply><apply id="S3.E5.m1.2.2.1.1.3.3.cmml" xref="S3.E5.m1.2.2.1.1.3.3"><plus id="S3.E5.m1.2.2.1.1.3.3.1.cmml" xref="S3.E5.m1.2.2.1.1.3.3.1"></plus><ci id="S3.E5.m1.2.2.1.1.3.3.2.cmml" xref="S3.E5.m1.2.2.1.1.3.3.2">𝑛</ci><apply id="S3.E5.m1.2.2.1.1.3.3.3.cmml" xref="S3.E5.m1.2.2.1.1.3.3.3"><times id="S3.E5.m1.2.2.1.1.3.3.3.1.cmml" xref="S3.E5.m1.2.2.1.1.3.3.3.1"></times><ci id="S3.E5.m1.2.2.1.1.3.3.3.2.cmml" xref="S3.E5.m1.2.2.1.1.3.3.3.2">𝛼</ci><ci id="S3.E5.m1.2.2.1.1.3.3.3.3.cmml" xref="S3.E5.m1.2.2.1.1.3.3.3.3">𝑀</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.2c">\hat{p}_{n}(x)=\frac{n_{i}+\alpha}{n+\alpha M},</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.2d">over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ( italic_x ) = divide start_ARG italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + italic_α end_ARG start_ARG italic_n + italic_α italic_M end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS0.Px2.p1.9">where <math alttext="\hat{p}_{n}(x)" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.1.m1.1"><semantics id="S3.SS2.SSS0.Px2.p1.1.m1.1a"><mrow id="S3.SS2.SSS0.Px2.p1.1.m1.1.2" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.2.cmml"><msub id="S3.SS2.SSS0.Px2.p1.1.m1.1.2.2" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.2.2.cmml"><mover accent="true" id="S3.SS2.SSS0.Px2.p1.1.m1.1.2.2.2" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px2.p1.1.m1.1.2.2.2.2" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.2.2.2.2.cmml">p</mi><mo id="S3.SS2.SSS0.Px2.p1.1.m1.1.2.2.2.1" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.2.2.2.1.cmml">^</mo></mover><mi id="S3.SS2.SSS0.Px2.p1.1.m1.1.2.2.3" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.2.2.3.cmml">n</mi></msub><mo id="S3.SS2.SSS0.Px2.p1.1.m1.1.2.1" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.SSS0.Px2.p1.1.m1.1.2.3.2" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.2.cmml"><mo id="S3.SS2.SSS0.Px2.p1.1.m1.1.2.3.2.1" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.2.cmml">(</mo><mi id="S3.SS2.SSS0.Px2.p1.1.m1.1.1" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.cmml">x</mi><mo id="S3.SS2.SSS0.Px2.p1.1.m1.1.2.3.2.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.1.m1.1b"><apply id="S3.SS2.SSS0.Px2.p1.1.m1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.2"><times id="S3.SS2.SSS0.Px2.p1.1.m1.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.2.1"></times><apply id="S3.SS2.SSS0.Px2.p1.1.m1.1.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.1.m1.1.2.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.2.2">subscript</csymbol><apply id="S3.SS2.SSS0.Px2.p1.1.m1.1.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.2.2.2"><ci id="S3.SS2.SSS0.Px2.p1.1.m1.1.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.2.2.2.1">^</ci><ci id="S3.SS2.SSS0.Px2.p1.1.m1.1.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.2.2.2.2">𝑝</ci></apply><ci id="S3.SS2.SSS0.Px2.p1.1.m1.1.2.2.3.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.2.2.3">𝑛</ci></apply><ci id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.1.m1.1c">\hat{p}_{n}(x)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.1.m1.1d">over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ( italic_x )</annotation></semantics></math> is the estimated probability density for bin <math alttext="i" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.2.m2.1"><semantics id="S3.SS2.SSS0.Px2.p1.2.m2.1a"><mi id="S3.SS2.SSS0.Px2.p1.2.m2.1.1" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.2.m2.1b"><ci id="S3.SS2.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.2.m2.1d">italic_i</annotation></semantics></math> containing <math alttext="x" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.3.m3.1"><semantics id="S3.SS2.SSS0.Px2.p1.3.m3.1a"><mi id="S3.SS2.SSS0.Px2.p1.3.m3.1.1" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.3.m3.1b"><ci id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.3.m3.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.3.m3.1d">italic_x</annotation></semantics></math>, <math alttext="n_{i}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.4.m4.1"><semantics id="S3.SS2.SSS0.Px2.p1.4.m4.1a"><msub id="S3.SS2.SSS0.Px2.p1.4.m4.1.1" xref="S3.SS2.SSS0.Px2.p1.4.m4.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p1.4.m4.1.1.2" xref="S3.SS2.SSS0.Px2.p1.4.m4.1.1.2.cmml">n</mi><mi id="S3.SS2.SSS0.Px2.p1.4.m4.1.1.3" xref="S3.SS2.SSS0.Px2.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.4.m4.1b"><apply id="S3.SS2.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m4.1.1.2">𝑛</ci><ci id="S3.SS2.SSS0.Px2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.4.m4.1c">n_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.4.m4.1d">italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the number of observed data points in bin <math alttext="i" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.5.m5.1"><semantics id="S3.SS2.SSS0.Px2.p1.5.m5.1a"><mi id="S3.SS2.SSS0.Px2.p1.5.m5.1.1" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.5.m5.1b"><ci id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.5.m5.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.5.m5.1d">italic_i</annotation></semantics></math>, <math alttext="n" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.6.m6.1"><semantics id="S3.SS2.SSS0.Px2.p1.6.m6.1a"><mi id="S3.SS2.SSS0.Px2.p1.6.m6.1.1" xref="S3.SS2.SSS0.Px2.p1.6.m6.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.6.m6.1b"><ci id="S3.SS2.SSS0.Px2.p1.6.m6.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.6.m6.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.6.m6.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.6.m6.1d">italic_n</annotation></semantics></math> is the total number of observed data points,
<math alttext="M" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.7.m7.1"><semantics id="S3.SS2.SSS0.Px2.p1.7.m7.1a"><mi id="S3.SS2.SSS0.Px2.p1.7.m7.1.1" xref="S3.SS2.SSS0.Px2.p1.7.m7.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.7.m7.1b"><ci id="S3.SS2.SSS0.Px2.p1.7.m7.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.7.m7.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.7.m7.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.7.m7.1d">italic_M</annotation></semantics></math> is the total number of bins.<span class="ltx_note ltx_role_footnote" id="footnote8"><sup class="ltx_note_mark">8</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">8</sup><span class="ltx_tag ltx_tag_note">8</span><math alttext="M=100" class="ltx_Math" display="inline" id="footnote8.m1.1"><semantics id="footnote8.m1.1b"><mrow id="footnote8.m1.1.1" xref="footnote8.m1.1.1.cmml"><mi id="footnote8.m1.1.1.2" xref="footnote8.m1.1.1.2.cmml">M</mi><mo id="footnote8.m1.1.1.1" xref="footnote8.m1.1.1.1.cmml">=</mo><mn id="footnote8.m1.1.1.3" xref="footnote8.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="footnote8.m1.1c"><apply id="footnote8.m1.1.1.cmml" xref="footnote8.m1.1.1"><eq id="footnote8.m1.1.1.1.cmml" xref="footnote8.m1.1.1.1"></eq><ci id="footnote8.m1.1.1.2.cmml" xref="footnote8.m1.1.1.2">𝑀</ci><cn id="footnote8.m1.1.1.3.cmml" type="integer" xref="footnote8.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote8.m1.1d">M=100</annotation><annotation encoding="application/x-llamapun" id="footnote8.m1.1e">italic_M = 100</annotation></semantics></math> since our most refined estimation from Hierarchy-PDF consists of 100 one-digit bins</span></span></span>, and <math alttext="\alpha" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.8.m8.1"><semantics id="S3.SS2.SSS0.Px2.p1.8.m8.1a"><mi id="S3.SS2.SSS0.Px2.p1.8.m8.1.1" xref="S3.SS2.SSS0.Px2.p1.8.m8.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.8.m8.1b"><ci id="S3.SS2.SSS0.Px2.p1.8.m8.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.8.m8.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.8.m8.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.8.m8.1d">italic_α</annotation></semantics></math> is the prior count for each bin.
We set <math alttext="\alpha=1" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.9.m9.1"><semantics id="S3.SS2.SSS0.Px2.p1.9.m9.1a"><mrow id="S3.SS2.SSS0.Px2.p1.9.m9.1.1" xref="S3.SS2.SSS0.Px2.p1.9.m9.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p1.9.m9.1.1.2" xref="S3.SS2.SSS0.Px2.p1.9.m9.1.1.2.cmml">α</mi><mo id="S3.SS2.SSS0.Px2.p1.9.m9.1.1.1" xref="S3.SS2.SSS0.Px2.p1.9.m9.1.1.1.cmml">=</mo><mn id="S3.SS2.SSS0.Px2.p1.9.m9.1.1.3" xref="S3.SS2.SSS0.Px2.p1.9.m9.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.9.m9.1b"><apply id="S3.SS2.SSS0.Px2.p1.9.m9.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.1.1"><eq id="S3.SS2.SSS0.Px2.p1.9.m9.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.1.1.1"></eq><ci id="S3.SS2.SSS0.Px2.p1.9.m9.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m9.1.1.2">𝛼</ci><cn id="S3.SS2.SSS0.Px2.p1.9.m9.1.1.3.cmml" type="integer" xref="S3.SS2.SSS0.Px2.p1.9.m9.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.9.m9.1c">\alpha=1</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.9.m9.1d">italic_α = 1</annotation></semantics></math>, effectively populating each bin with one "hallucinated" data point prior to observing any data <cite class="ltx_cite ltx_citemacro_citep">(Jeffreys, <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib18" title="">1946</a>)</cite>.
This choice ensures that the histogram algorithm starts from a state of maximal ignorance, consistent with LLaMA’s in-context DE in the low data regime<span class="ltx_note ltx_role_footnote" id="footnote9"><sup class="ltx_note_mark">9</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">9</sup><span class="ltx_tag ltx_tag_note">9</span>A curious feature which we foreshadowed in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#S3" title="3 Methodology ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">3</span></a> and further discuss throughout Section <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#S4" title="4 Experiments and analysis ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">4</span></a></span></span></span>.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments and analysis</h2>
<div class="ltx_para ltx_noindent" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">We visualize and analyze the learning trajectories of LLaMA on two types of target (ground truth) distributions: uniform and Gaussian. To provide context and facilitate interpretation of the 2D space, we embed the following additional reference points and trajectories:</p>
<ul class="ltx_itemize" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i1.p1.1.1" style="color:#808080;">Ignorance</span>: A point representing maximum entropy (uniform distribution over the entire support).</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i2.p1">
<p class="ltx_p" id="S4.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i2.p1.1.1" style="color:#0000FF;">Truth</span>: A point representing the ground truth distribution.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i3.p1">
<p class="ltx_p" id="S4.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i3.p1.1.1">Geodesic</span>: The shortest trajectory connecting Ignorance and Truth points <cite class="ltx_cite ltx_citemacro_citep">(Mao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib24" title="">2024</a>)</cite>.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S4.I1.i4.p1">
<p class="ltx_p" id="S4.I1.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i4.p1.1.1" style="color:#D26E93;">Gaussian submanifold</span>: A 1D manifold of centered Gaussians with variances ranging from <math alttext="\infty" class="ltx_Math" display="inline" id="S4.I1.i4.p1.1.m1.1"><semantics id="S4.I1.i4.p1.1.m1.1a"><mi id="S4.I1.i4.p1.1.m1.1.1" mathvariant="normal" xref="S4.I1.i4.p1.1.m1.1.1.cmml">∞</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i4.p1.1.m1.1b"><infinity id="S4.I1.i4.p1.1.m1.1.1.cmml" xref="S4.I1.i4.p1.1.m1.1.1"></infinity></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i4.p1.1.m1.1c">\infty</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i4.p1.1.m1.1d">∞</annotation></semantics></math> to 0.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para ltx_noindent" id="S4.p2">
<p class="ltx_p" id="S4.p2.2">Our experiments focus on LLaMA-2 13b, unless otherwise noted.
While LLaMA-2 has a context window of 4096 tokens (equivalent to <math alttext="\sim" class="ltx_Math" display="inline" id="S4.p2.1.m1.1"><semantics id="S4.p2.1.m1.1a"><mo id="S4.p2.1.m1.1.1" xref="S4.p2.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S4.p2.1.m1.1b"><csymbol cd="latexml" id="S4.p2.1.m1.1.1.cmml" xref="S4.p2.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.1.m1.1c">\sim</annotation><annotation encoding="application/x-llamapun" id="S4.p2.1.m1.1d">∼</annotation></semantics></math>1365 comma-delimited, 2-digit data points),
we limit our analysis to a context length of <math alttext="n=200" class="ltx_Math" display="inline" id="S4.p2.2.m2.1"><semantics id="S4.p2.2.m2.1a"><mrow id="S4.p2.2.m2.1.1" xref="S4.p2.2.m2.1.1.cmml"><mi id="S4.p2.2.m2.1.1.2" xref="S4.p2.2.m2.1.1.2.cmml">n</mi><mo id="S4.p2.2.m2.1.1.1" xref="S4.p2.2.m2.1.1.1.cmml">=</mo><mn id="S4.p2.2.m2.1.1.3" xref="S4.p2.2.m2.1.1.3.cmml">200</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.2.m2.1b"><apply id="S4.p2.2.m2.1.1.cmml" xref="S4.p2.2.m2.1.1"><eq id="S4.p2.2.m2.1.1.1.cmml" xref="S4.p2.2.m2.1.1.1"></eq><ci id="S4.p2.2.m2.1.1.2.cmml" xref="S4.p2.2.m2.1.1.2">𝑛</ci><cn id="S4.p2.2.m2.1.1.3.cmml" type="integer" xref="S4.p2.2.m2.1.1.3">200</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.2.m2.1c">n=200</annotation><annotation encoding="application/x-llamapun" id="S4.p2.2.m2.1d">italic_n = 200</annotation></semantics></math>.
This limitation is based on our observation that LLaMA’s DE accuracy typically plateaus beyond this point.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Gaussian target</h3>
<figure class="ltx_figure" id="S4.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="218" id="S4.F3.g1" src="extracted/5899401/figures/gaussian_0.3_0.1_7b_13b_70b_seed3_Hellinger_2D_grouped.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>In-context density estimation trajectories for Gaussian targets.
Top row: 2D InPCA embeddings of DE trajectories for Gaussian targets of decreasing width (left to right).
Bottom row: Corresponding ground truth distributions.
These 2D embeddings capture 92% of pairwise Hellinger distances between probability distributions.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">We begin our analysis with Gaussian target distributions of varying widths.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p2.1.1">Wide Gaussian target.</span>
A wide Gaussian distribution serves as our simplest target, as it is close in Hellinger distance to the uniform distribution (total ignorance).
In this scenario, both LLaMA and Gaussian KDE successfully approximate the target PDF within 200 data points.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p3.1.1">Narrow Gaussian target.</span>
However, as the Gaussian target narrows, Gaussian KDE lags behind, while LLaMA maintains its ability to closely approximate the target distribution.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p4">
<p class="ltx_p" id="S4.SS1.p4.1">In all three cases, the Bayesian histogram, by design, begins exactly at maximal ignorance, and then follows the geodesic trajectory.
Despite following this geometrically shortest path, the Bayesian histogram is the slowest to converge to the target distribution; likely due to the strong influence of its uniform prior.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p5">
<p class="ltx_p" id="S4.SS1.p5.3">Gaussian KDE, on the other hand, starts closer to the target, thanks to its unfair advantage of having a Gaussian-shape kernel.
Interestingly, Gaussian KDE consistently lingers on the Gaussian sub-manifold throughout the DE process.
This behavior of lingering on the Gaussian sub-manifold is not unique to Gaussian kernels; as demonstrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.F13" title="Figure 13 ‣ A.5.2 Optimal kernel shape ‣ A.5 Additional notes on Kernel Density Estimation ‣ Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">13</span></a>,
KDEs with alternative kernel shapes (e.g., exponential and parabolic) also exhibit a strong propensity for the Gaussian submanifold.
One potential explanation for this phenomenon lies in the nature of KDE itself.
KDE can be expressed as a convolution of two distributions: the empirical data distribution and the kernel shape, as</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{p}_{h}(x)=\frac{1}{nh}\sum_{i=1}^{n}K\left(\frac{x-X_{i}}{h}\right)=(F_{n%
}*K_{h})(x)," class="ltx_Math" display="block" id="S4.E6.m1.4"><semantics id="S4.E6.m1.4a"><mrow id="S4.E6.m1.4.4.1" xref="S4.E6.m1.4.4.1.1.cmml"><mrow id="S4.E6.m1.4.4.1.1" xref="S4.E6.m1.4.4.1.1.cmml"><mrow id="S4.E6.m1.4.4.1.1.3" xref="S4.E6.m1.4.4.1.1.3.cmml"><msub id="S4.E6.m1.4.4.1.1.3.2" xref="S4.E6.m1.4.4.1.1.3.2.cmml"><mover accent="true" id="S4.E6.m1.4.4.1.1.3.2.2" xref="S4.E6.m1.4.4.1.1.3.2.2.cmml"><mi id="S4.E6.m1.4.4.1.1.3.2.2.2" xref="S4.E6.m1.4.4.1.1.3.2.2.2.cmml">p</mi><mo id="S4.E6.m1.4.4.1.1.3.2.2.1" xref="S4.E6.m1.4.4.1.1.3.2.2.1.cmml">^</mo></mover><mi id="S4.E6.m1.4.4.1.1.3.2.3" xref="S4.E6.m1.4.4.1.1.3.2.3.cmml">h</mi></msub><mo id="S4.E6.m1.4.4.1.1.3.1" xref="S4.E6.m1.4.4.1.1.3.1.cmml">⁢</mo><mrow id="S4.E6.m1.4.4.1.1.3.3.2" xref="S4.E6.m1.4.4.1.1.3.cmml"><mo id="S4.E6.m1.4.4.1.1.3.3.2.1" stretchy="false" xref="S4.E6.m1.4.4.1.1.3.cmml">(</mo><mi id="S4.E6.m1.1.1" xref="S4.E6.m1.1.1.cmml">x</mi><mo id="S4.E6.m1.4.4.1.1.3.3.2.2" stretchy="false" xref="S4.E6.m1.4.4.1.1.3.cmml">)</mo></mrow></mrow><mo id="S4.E6.m1.4.4.1.1.4" xref="S4.E6.m1.4.4.1.1.4.cmml">=</mo><mrow id="S4.E6.m1.4.4.1.1.5" xref="S4.E6.m1.4.4.1.1.5.cmml"><mfrac id="S4.E6.m1.4.4.1.1.5.2" xref="S4.E6.m1.4.4.1.1.5.2.cmml"><mn id="S4.E6.m1.4.4.1.1.5.2.2" xref="S4.E6.m1.4.4.1.1.5.2.2.cmml">1</mn><mrow id="S4.E6.m1.4.4.1.1.5.2.3" xref="S4.E6.m1.4.4.1.1.5.2.3.cmml"><mi id="S4.E6.m1.4.4.1.1.5.2.3.2" xref="S4.E6.m1.4.4.1.1.5.2.3.2.cmml">n</mi><mo id="S4.E6.m1.4.4.1.1.5.2.3.1" xref="S4.E6.m1.4.4.1.1.5.2.3.1.cmml">⁢</mo><mi id="S4.E6.m1.4.4.1.1.5.2.3.3" xref="S4.E6.m1.4.4.1.1.5.2.3.3.cmml">h</mi></mrow></mfrac><mo id="S4.E6.m1.4.4.1.1.5.1" xref="S4.E6.m1.4.4.1.1.5.1.cmml">⁢</mo><mrow id="S4.E6.m1.4.4.1.1.5.3" xref="S4.E6.m1.4.4.1.1.5.3.cmml"><munderover id="S4.E6.m1.4.4.1.1.5.3.1" xref="S4.E6.m1.4.4.1.1.5.3.1.cmml"><mo id="S4.E6.m1.4.4.1.1.5.3.1.2.2" movablelimits="false" xref="S4.E6.m1.4.4.1.1.5.3.1.2.2.cmml">∑</mo><mrow id="S4.E6.m1.4.4.1.1.5.3.1.2.3" xref="S4.E6.m1.4.4.1.1.5.3.1.2.3.cmml"><mi id="S4.E6.m1.4.4.1.1.5.3.1.2.3.2" xref="S4.E6.m1.4.4.1.1.5.3.1.2.3.2.cmml">i</mi><mo id="S4.E6.m1.4.4.1.1.5.3.1.2.3.1" xref="S4.E6.m1.4.4.1.1.5.3.1.2.3.1.cmml">=</mo><mn id="S4.E6.m1.4.4.1.1.5.3.1.2.3.3" xref="S4.E6.m1.4.4.1.1.5.3.1.2.3.3.cmml">1</mn></mrow><mi id="S4.E6.m1.4.4.1.1.5.3.1.3" xref="S4.E6.m1.4.4.1.1.5.3.1.3.cmml">n</mi></munderover><mrow id="S4.E6.m1.4.4.1.1.5.3.2" xref="S4.E6.m1.4.4.1.1.5.3.2.cmml"><mi id="S4.E6.m1.4.4.1.1.5.3.2.2" xref="S4.E6.m1.4.4.1.1.5.3.2.2.cmml">K</mi><mo id="S4.E6.m1.4.4.1.1.5.3.2.1" xref="S4.E6.m1.4.4.1.1.5.3.2.1.cmml">⁢</mo><mrow id="S4.E6.m1.4.4.1.1.5.3.2.3.2" xref="S4.E6.m1.2.2.cmml"><mo id="S4.E6.m1.4.4.1.1.5.3.2.3.2.1" xref="S4.E6.m1.2.2.cmml">(</mo><mfrac id="S4.E6.m1.2.2" xref="S4.E6.m1.2.2.cmml"><mrow id="S4.E6.m1.2.2.2" xref="S4.E6.m1.2.2.2.cmml"><mi id="S4.E6.m1.2.2.2.2" xref="S4.E6.m1.2.2.2.2.cmml">x</mi><mo id="S4.E6.m1.2.2.2.1" xref="S4.E6.m1.2.2.2.1.cmml">−</mo><msub id="S4.E6.m1.2.2.2.3" xref="S4.E6.m1.2.2.2.3.cmml"><mi id="S4.E6.m1.2.2.2.3.2" xref="S4.E6.m1.2.2.2.3.2.cmml">X</mi><mi id="S4.E6.m1.2.2.2.3.3" xref="S4.E6.m1.2.2.2.3.3.cmml">i</mi></msub></mrow><mi id="S4.E6.m1.2.2.3" xref="S4.E6.m1.2.2.3.cmml">h</mi></mfrac><mo id="S4.E6.m1.4.4.1.1.5.3.2.3.2.2" xref="S4.E6.m1.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E6.m1.4.4.1.1.6" xref="S4.E6.m1.4.4.1.1.6.cmml">=</mo><mrow id="S4.E6.m1.4.4.1.1.1" xref="S4.E6.m1.4.4.1.1.1.cmml"><mrow id="S4.E6.m1.4.4.1.1.1.1.1" xref="S4.E6.m1.4.4.1.1.1.1.1.1.cmml"><mo id="S4.E6.m1.4.4.1.1.1.1.1.2" stretchy="false" xref="S4.E6.m1.4.4.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E6.m1.4.4.1.1.1.1.1.1" xref="S4.E6.m1.4.4.1.1.1.1.1.1.cmml"><msub id="S4.E6.m1.4.4.1.1.1.1.1.1.2" xref="S4.E6.m1.4.4.1.1.1.1.1.1.2.cmml"><mi id="S4.E6.m1.4.4.1.1.1.1.1.1.2.2" xref="S4.E6.m1.4.4.1.1.1.1.1.1.2.2.cmml">F</mi><mi id="S4.E6.m1.4.4.1.1.1.1.1.1.2.3" xref="S4.E6.m1.4.4.1.1.1.1.1.1.2.3.cmml">n</mi></msub><mo id="S4.E6.m1.4.4.1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.E6.m1.4.4.1.1.1.1.1.1.1.cmml">∗</mo><msub id="S4.E6.m1.4.4.1.1.1.1.1.1.3" xref="S4.E6.m1.4.4.1.1.1.1.1.1.3.cmml"><mi id="S4.E6.m1.4.4.1.1.1.1.1.1.3.2" xref="S4.E6.m1.4.4.1.1.1.1.1.1.3.2.cmml">K</mi><mi id="S4.E6.m1.4.4.1.1.1.1.1.1.3.3" xref="S4.E6.m1.4.4.1.1.1.1.1.1.3.3.cmml">h</mi></msub></mrow><mo id="S4.E6.m1.4.4.1.1.1.1.1.3" stretchy="false" xref="S4.E6.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.E6.m1.4.4.1.1.1.2" xref="S4.E6.m1.4.4.1.1.1.2.cmml">⁢</mo><mrow id="S4.E6.m1.4.4.1.1.1.3.2" xref="S4.E6.m1.4.4.1.1.1.cmml"><mo id="S4.E6.m1.4.4.1.1.1.3.2.1" stretchy="false" xref="S4.E6.m1.4.4.1.1.1.cmml">(</mo><mi id="S4.E6.m1.3.3" xref="S4.E6.m1.3.3.cmml">x</mi><mo id="S4.E6.m1.4.4.1.1.1.3.2.2" stretchy="false" xref="S4.E6.m1.4.4.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E6.m1.4.4.1.2" xref="S4.E6.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.4b"><apply id="S4.E6.m1.4.4.1.1.cmml" xref="S4.E6.m1.4.4.1"><and id="S4.E6.m1.4.4.1.1a.cmml" xref="S4.E6.m1.4.4.1"></and><apply id="S4.E6.m1.4.4.1.1b.cmml" xref="S4.E6.m1.4.4.1"><eq id="S4.E6.m1.4.4.1.1.4.cmml" xref="S4.E6.m1.4.4.1.1.4"></eq><apply id="S4.E6.m1.4.4.1.1.3.cmml" xref="S4.E6.m1.4.4.1.1.3"><times id="S4.E6.m1.4.4.1.1.3.1.cmml" xref="S4.E6.m1.4.4.1.1.3.1"></times><apply id="S4.E6.m1.4.4.1.1.3.2.cmml" xref="S4.E6.m1.4.4.1.1.3.2"><csymbol cd="ambiguous" id="S4.E6.m1.4.4.1.1.3.2.1.cmml" xref="S4.E6.m1.4.4.1.1.3.2">subscript</csymbol><apply id="S4.E6.m1.4.4.1.1.3.2.2.cmml" xref="S4.E6.m1.4.4.1.1.3.2.2"><ci id="S4.E6.m1.4.4.1.1.3.2.2.1.cmml" xref="S4.E6.m1.4.4.1.1.3.2.2.1">^</ci><ci id="S4.E6.m1.4.4.1.1.3.2.2.2.cmml" xref="S4.E6.m1.4.4.1.1.3.2.2.2">𝑝</ci></apply><ci id="S4.E6.m1.4.4.1.1.3.2.3.cmml" xref="S4.E6.m1.4.4.1.1.3.2.3">ℎ</ci></apply><ci id="S4.E6.m1.1.1.cmml" xref="S4.E6.m1.1.1">𝑥</ci></apply><apply id="S4.E6.m1.4.4.1.1.5.cmml" xref="S4.E6.m1.4.4.1.1.5"><times id="S4.E6.m1.4.4.1.1.5.1.cmml" xref="S4.E6.m1.4.4.1.1.5.1"></times><apply id="S4.E6.m1.4.4.1.1.5.2.cmml" xref="S4.E6.m1.4.4.1.1.5.2"><divide id="S4.E6.m1.4.4.1.1.5.2.1.cmml" xref="S4.E6.m1.4.4.1.1.5.2"></divide><cn id="S4.E6.m1.4.4.1.1.5.2.2.cmml" type="integer" xref="S4.E6.m1.4.4.1.1.5.2.2">1</cn><apply id="S4.E6.m1.4.4.1.1.5.2.3.cmml" xref="S4.E6.m1.4.4.1.1.5.2.3"><times id="S4.E6.m1.4.4.1.1.5.2.3.1.cmml" xref="S4.E6.m1.4.4.1.1.5.2.3.1"></times><ci id="S4.E6.m1.4.4.1.1.5.2.3.2.cmml" xref="S4.E6.m1.4.4.1.1.5.2.3.2">𝑛</ci><ci id="S4.E6.m1.4.4.1.1.5.2.3.3.cmml" xref="S4.E6.m1.4.4.1.1.5.2.3.3">ℎ</ci></apply></apply><apply id="S4.E6.m1.4.4.1.1.5.3.cmml" xref="S4.E6.m1.4.4.1.1.5.3"><apply id="S4.E6.m1.4.4.1.1.5.3.1.cmml" xref="S4.E6.m1.4.4.1.1.5.3.1"><csymbol cd="ambiguous" id="S4.E6.m1.4.4.1.1.5.3.1.1.cmml" xref="S4.E6.m1.4.4.1.1.5.3.1">superscript</csymbol><apply id="S4.E6.m1.4.4.1.1.5.3.1.2.cmml" xref="S4.E6.m1.4.4.1.1.5.3.1"><csymbol cd="ambiguous" id="S4.E6.m1.4.4.1.1.5.3.1.2.1.cmml" xref="S4.E6.m1.4.4.1.1.5.3.1">subscript</csymbol><sum id="S4.E6.m1.4.4.1.1.5.3.1.2.2.cmml" xref="S4.E6.m1.4.4.1.1.5.3.1.2.2"></sum><apply id="S4.E6.m1.4.4.1.1.5.3.1.2.3.cmml" xref="S4.E6.m1.4.4.1.1.5.3.1.2.3"><eq id="S4.E6.m1.4.4.1.1.5.3.1.2.3.1.cmml" xref="S4.E6.m1.4.4.1.1.5.3.1.2.3.1"></eq><ci id="S4.E6.m1.4.4.1.1.5.3.1.2.3.2.cmml" xref="S4.E6.m1.4.4.1.1.5.3.1.2.3.2">𝑖</ci><cn id="S4.E6.m1.4.4.1.1.5.3.1.2.3.3.cmml" type="integer" xref="S4.E6.m1.4.4.1.1.5.3.1.2.3.3">1</cn></apply></apply><ci id="S4.E6.m1.4.4.1.1.5.3.1.3.cmml" xref="S4.E6.m1.4.4.1.1.5.3.1.3">𝑛</ci></apply><apply id="S4.E6.m1.4.4.1.1.5.3.2.cmml" xref="S4.E6.m1.4.4.1.1.5.3.2"><times id="S4.E6.m1.4.4.1.1.5.3.2.1.cmml" xref="S4.E6.m1.4.4.1.1.5.3.2.1"></times><ci id="S4.E6.m1.4.4.1.1.5.3.2.2.cmml" xref="S4.E6.m1.4.4.1.1.5.3.2.2">𝐾</ci><apply id="S4.E6.m1.2.2.cmml" xref="S4.E6.m1.4.4.1.1.5.3.2.3.2"><divide id="S4.E6.m1.2.2.1.cmml" xref="S4.E6.m1.4.4.1.1.5.3.2.3.2"></divide><apply id="S4.E6.m1.2.2.2.cmml" xref="S4.E6.m1.2.2.2"><minus id="S4.E6.m1.2.2.2.1.cmml" xref="S4.E6.m1.2.2.2.1"></minus><ci id="S4.E6.m1.2.2.2.2.cmml" xref="S4.E6.m1.2.2.2.2">𝑥</ci><apply id="S4.E6.m1.2.2.2.3.cmml" xref="S4.E6.m1.2.2.2.3"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.2.3.1.cmml" xref="S4.E6.m1.2.2.2.3">subscript</csymbol><ci id="S4.E6.m1.2.2.2.3.2.cmml" xref="S4.E6.m1.2.2.2.3.2">𝑋</ci><ci id="S4.E6.m1.2.2.2.3.3.cmml" xref="S4.E6.m1.2.2.2.3.3">𝑖</ci></apply></apply><ci id="S4.E6.m1.2.2.3.cmml" xref="S4.E6.m1.2.2.3">ℎ</ci></apply></apply></apply></apply></apply><apply id="S4.E6.m1.4.4.1.1c.cmml" xref="S4.E6.m1.4.4.1"><eq id="S4.E6.m1.4.4.1.1.6.cmml" xref="S4.E6.m1.4.4.1.1.6"></eq><share href="https://arxiv.org/html/2410.05218v1#S4.E6.m1.4.4.1.1.5.cmml" id="S4.E6.m1.4.4.1.1d.cmml" xref="S4.E6.m1.4.4.1"></share><apply id="S4.E6.m1.4.4.1.1.1.cmml" xref="S4.E6.m1.4.4.1.1.1"><times id="S4.E6.m1.4.4.1.1.1.2.cmml" xref="S4.E6.m1.4.4.1.1.1.2"></times><apply id="S4.E6.m1.4.4.1.1.1.1.1.1.cmml" xref="S4.E6.m1.4.4.1.1.1.1.1"><times id="S4.E6.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.4.4.1.1.1.1.1.1.1"></times><apply id="S4.E6.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.4.4.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.4.4.1.1.1.1.1.1.2.1.cmml" xref="S4.E6.m1.4.4.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E6.m1.4.4.1.1.1.1.1.1.2.2.cmml" xref="S4.E6.m1.4.4.1.1.1.1.1.1.2.2">𝐹</ci><ci id="S4.E6.m1.4.4.1.1.1.1.1.1.2.3.cmml" xref="S4.E6.m1.4.4.1.1.1.1.1.1.2.3">𝑛</ci></apply><apply id="S4.E6.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.4.4.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.4.4.1.1.1.1.1.1.3.1.cmml" xref="S4.E6.m1.4.4.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E6.m1.4.4.1.1.1.1.1.1.3.2.cmml" xref="S4.E6.m1.4.4.1.1.1.1.1.1.3.2">𝐾</ci><ci id="S4.E6.m1.4.4.1.1.1.1.1.1.3.3.cmml" xref="S4.E6.m1.4.4.1.1.1.1.1.1.3.3">ℎ</ci></apply></apply><ci id="S4.E6.m1.3.3.cmml" xref="S4.E6.m1.3.3">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.4c">\hat{p}_{h}(x)=\frac{1}{nh}\sum_{i=1}^{n}K\left(\frac{x-X_{i}}{h}\right)=(F_{n%
}*K_{h})(x),</annotation><annotation encoding="application/x-llamapun" id="S4.E6.m1.4d">over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ( italic_x ) = divide start_ARG 1 end_ARG start_ARG italic_n italic_h end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_K ( divide start_ARG italic_x - italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG start_ARG italic_h end_ARG ) = ( italic_F start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ∗ italic_K start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ) ( italic_x ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p5.2">where <math alttext="F_{n}" class="ltx_Math" display="inline" id="S4.SS1.p5.1.m1.1"><semantics id="S4.SS1.p5.1.m1.1a"><msub id="S4.SS1.p5.1.m1.1.1" xref="S4.SS1.p5.1.m1.1.1.cmml"><mi id="S4.SS1.p5.1.m1.1.1.2" xref="S4.SS1.p5.1.m1.1.1.2.cmml">F</mi><mi id="S4.SS1.p5.1.m1.1.1.3" xref="S4.SS1.p5.1.m1.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.1.m1.1b"><apply id="S4.SS1.p5.1.m1.1.1.cmml" xref="S4.SS1.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.1.m1.1.1.1.cmml" xref="S4.SS1.p5.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p5.1.m1.1.1.2.cmml" xref="S4.SS1.p5.1.m1.1.1.2">𝐹</ci><ci id="S4.SS1.p5.1.m1.1.1.3.cmml" xref="S4.SS1.p5.1.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.1.m1.1c">F_{n}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.1.m1.1d">italic_F start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math> is the empirical distribution and <math alttext="K_{h}" class="ltx_Math" display="inline" id="S4.SS1.p5.2.m2.1"><semantics id="S4.SS1.p5.2.m2.1a"><msub id="S4.SS1.p5.2.m2.1.1" xref="S4.SS1.p5.2.m2.1.1.cmml"><mi id="S4.SS1.p5.2.m2.1.1.2" xref="S4.SS1.p5.2.m2.1.1.2.cmml">K</mi><mi id="S4.SS1.p5.2.m2.1.1.3" xref="S4.SS1.p5.2.m2.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.2.m2.1b"><apply id="S4.SS1.p5.2.m2.1.1.cmml" xref="S4.SS1.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.2.m2.1.1.1.cmml" xref="S4.SS1.p5.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.p5.2.m2.1.1.2.cmml" xref="S4.SS1.p5.2.m2.1.1.2">𝐾</ci><ci id="S4.SS1.p5.2.m2.1.1.3.cmml" xref="S4.SS1.p5.2.m2.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.2.m2.1c">K_{h}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.2.m2.1d">italic_K start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT</annotation></semantics></math> is the scaled kernel.
This convolution operation tends to produce Gaussian-like distributions due to the central limit theorem <cite class="ltx_cite ltx_citemacro_citep">(Fischer, <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib12" title="">2011</a>)</cite>.
Consequently, <span class="ltx_text ltx_font_bold" id="S4.SS1.p5.2.1">a DE trajectory near the Gaussian manifold may indicate a kernel-style density estimation algorithm.</span></p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Uniform target</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">The Gaussian distribution easily arises in data with additive noise <cite class="ltx_cite ltx_citemacro_citep">(Fischer, <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib12" title="">2011</a>)</cite> and therefore likely dominates the training data <cite class="ltx_cite ltx_citemacro_citep">(Touvron et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib39" title="">2023</a>)</cite>.
What’s more, the Gaussian distribution is everywhere smooth, which makes it very easy to estimate from a function approximation point of view <cite class="ltx_cite ltx_citemacro_citep">(DeVore, <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib10" title="">1993</a>)</cite>.
Uniform distributions, on the other hand, feature non-differentiable boundaries; difficult to represent by both parametric <cite class="ltx_cite ltx_citemacro_citep">(DeVore, <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib10" title="">1993</a>)</cite> and kernel-based <cite class="ltx_cite ltx_citemacro_citep">(Wand &amp; Jones, <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib41" title="">1994</a>, Chapter 2.9)</cite> methods.
For these reasons, we now investigate the in-context DE trajectory with uniform targets.</p>
</div>
<figure class="ltx_figure" id="S4.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="186" id="S4.F4.g1" src="extracted/5899401/figures/uniform_0.5_0.3_0.1_7b_13b_KDE_hist_Hellinger_2D_grouped.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>In-context density estimation trajectories for uniform distribution targets.
Top row: 2D InPCA embeddings of DE trajectories for uniform targets of decreasing width (left to right).
Bottom row: Corresponding ground truth distributions.
These 2D embeddings capture 89% of pairwise Hellinger distances between probability distributions.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS2.p2.1.1">Wide uniform target.</span>
For a wide uniform target, both LLaMA and Gaussian KDE initially move rapidly towards the target distribution.
However, they then linger at the point on the Gaussian sub-manifold nearest to the uniform target.
As more data streams in, they slowly depart from the sub-manifold and converge to the target distribution.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.1"><span class="ltx_text ltx_font_bold" id="S4.SS2.p3.1.1">Narrow uniform target.</span>
As the uniform target narrows, Gaussian KDE’s performance deteriorates,
while LLaMA’s in-context DE successfully reaches the target.
Notably, LLaMA exhibits less bias towards the Gaussian sub-manifold, as compared with the narrow Gaussian target case.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p4">
<p class="ltx_p" id="S4.SS2.p4.1">In the low data regime, Gaussian KDE and Bayesian histogram follow the same trajectories that they previously followed for the narrow Gaussian target.
However, LLaMA already appears to differentiate this target by taking a path further from the Gaussian sub-manifold and closer to the geodesic.
This behavior suggests that <span class="ltx_text ltx_font_bold" id="S4.SS2.p4.1.1">LLaMA’s in-context DE algorithm is more flexible and adaptive than classical KDE with pre-determined width schedule and shape.</span></p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>The Kernel Interpretation of In-Context Density Estimation</h3>
<div class="ltx_para ltx_noindent" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">Based on our observations in Sections <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#S4.SS1" title="4.1 Gaussian target ‣ 4 Experiments and analysis ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">4.1</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#S4.SS2" title="4.2 Uniform target ‣ 4 Experiments and analysis ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">4.2</span></a>, we propose a kernel-based interpretation of LLaMA’s in-context density estimation algorithm.
The bias towards Gaussian submanifolds in LLaMA’s trajectories suggests a KDE-like approach.
To test this hypothesis, we develop a bespoke KDE model with adaptive kernel shape and bandwidth, optimized to emulate LLaMA’s learning trajectory.</p>
</div>
<section class="ltx_subsubsection" id="S4.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.1 </span>Bespoke KDE Model</h4>
<div class="ltx_para ltx_noindent" id="S4.SS3.SSS1.p1">
<p class="ltx_p" id="S4.SS3.SSS1.p1.1">We construct our bespoke KDE model in two steps:</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.SSS1.p2">
<p class="ltx_p" id="S4.SS3.SSS1.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS3.SSS1.p2.1.1">Step 1: Parameterize kernel shape</span></p>
</div>
<div class="ltx_para" id="S4.SS3.SSS1.p3">
<p class="ltx_p" id="S4.SS3.SSS1.p3.2">We introduce a flexible kernel function <math alttext="K_{s}(x)" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p3.1.m1.1"><semantics id="S4.SS3.SSS1.p3.1.m1.1a"><mrow id="S4.SS3.SSS1.p3.1.m1.1.2" xref="S4.SS3.SSS1.p3.1.m1.1.2.cmml"><msub id="S4.SS3.SSS1.p3.1.m1.1.2.2" xref="S4.SS3.SSS1.p3.1.m1.1.2.2.cmml"><mi id="S4.SS3.SSS1.p3.1.m1.1.2.2.2" xref="S4.SS3.SSS1.p3.1.m1.1.2.2.2.cmml">K</mi><mi id="S4.SS3.SSS1.p3.1.m1.1.2.2.3" xref="S4.SS3.SSS1.p3.1.m1.1.2.2.3.cmml">s</mi></msub><mo id="S4.SS3.SSS1.p3.1.m1.1.2.1" xref="S4.SS3.SSS1.p3.1.m1.1.2.1.cmml">⁢</mo><mrow id="S4.SS3.SSS1.p3.1.m1.1.2.3.2" xref="S4.SS3.SSS1.p3.1.m1.1.2.cmml"><mo id="S4.SS3.SSS1.p3.1.m1.1.2.3.2.1" stretchy="false" xref="S4.SS3.SSS1.p3.1.m1.1.2.cmml">(</mo><mi id="S4.SS3.SSS1.p3.1.m1.1.1" xref="S4.SS3.SSS1.p3.1.m1.1.1.cmml">x</mi><mo id="S4.SS3.SSS1.p3.1.m1.1.2.3.2.2" stretchy="false" xref="S4.SS3.SSS1.p3.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p3.1.m1.1b"><apply id="S4.SS3.SSS1.p3.1.m1.1.2.cmml" xref="S4.SS3.SSS1.p3.1.m1.1.2"><times id="S4.SS3.SSS1.p3.1.m1.1.2.1.cmml" xref="S4.SS3.SSS1.p3.1.m1.1.2.1"></times><apply id="S4.SS3.SSS1.p3.1.m1.1.2.2.cmml" xref="S4.SS3.SSS1.p3.1.m1.1.2.2"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p3.1.m1.1.2.2.1.cmml" xref="S4.SS3.SSS1.p3.1.m1.1.2.2">subscript</csymbol><ci id="S4.SS3.SSS1.p3.1.m1.1.2.2.2.cmml" xref="S4.SS3.SSS1.p3.1.m1.1.2.2.2">𝐾</ci><ci id="S4.SS3.SSS1.p3.1.m1.1.2.2.3.cmml" xref="S4.SS3.SSS1.p3.1.m1.1.2.2.3">𝑠</ci></apply><ci id="S4.SS3.SSS1.p3.1.m1.1.1.cmml" xref="S4.SS3.SSS1.p3.1.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p3.1.m1.1c">K_{s}(x)</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p3.1.m1.1d">italic_K start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ( italic_x )</annotation></semantics></math> parameterized by a shape parameter <math alttext="s" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p3.2.m2.1"><semantics id="S4.SS3.SSS1.p3.2.m2.1a"><mi id="S4.SS3.SSS1.p3.2.m2.1.1" xref="S4.SS3.SSS1.p3.2.m2.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p3.2.m2.1b"><ci id="S4.SS3.SSS1.p3.2.m2.1.1.cmml" xref="S4.SS3.SSS1.p3.2.m2.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p3.2.m2.1c">s</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p3.2.m2.1d">italic_s</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="K_{s}(x)=\frac{b(s)e^{-|b(s)x|^{s}}}{Z(s)}" class="ltx_Math" display="block" id="S4.E7.m1.5"><semantics id="S4.E7.m1.5a"><mrow id="S4.E7.m1.5.6" xref="S4.E7.m1.5.6.cmml"><mrow id="S4.E7.m1.5.6.2" xref="S4.E7.m1.5.6.2.cmml"><msub id="S4.E7.m1.5.6.2.2" xref="S4.E7.m1.5.6.2.2.cmml"><mi id="S4.E7.m1.5.6.2.2.2" xref="S4.E7.m1.5.6.2.2.2.cmml">K</mi><mi id="S4.E7.m1.5.6.2.2.3" xref="S4.E7.m1.5.6.2.2.3.cmml">s</mi></msub><mo id="S4.E7.m1.5.6.2.1" xref="S4.E7.m1.5.6.2.1.cmml">⁢</mo><mrow id="S4.E7.m1.5.6.2.3.2" xref="S4.E7.m1.5.6.2.cmml"><mo id="S4.E7.m1.5.6.2.3.2.1" stretchy="false" xref="S4.E7.m1.5.6.2.cmml">(</mo><mi id="S4.E7.m1.5.5" xref="S4.E7.m1.5.5.cmml">x</mi><mo id="S4.E7.m1.5.6.2.3.2.2" stretchy="false" xref="S4.E7.m1.5.6.2.cmml">)</mo></mrow></mrow><mo id="S4.E7.m1.5.6.1" xref="S4.E7.m1.5.6.1.cmml">=</mo><mfrac id="S4.E7.m1.4.4" xref="S4.E7.m1.4.4.cmml"><mrow id="S4.E7.m1.3.3.3" xref="S4.E7.m1.3.3.3.cmml"><mi id="S4.E7.m1.3.3.3.5" xref="S4.E7.m1.3.3.3.5.cmml">b</mi><mo id="S4.E7.m1.3.3.3.4" xref="S4.E7.m1.3.3.3.4.cmml">⁢</mo><mrow id="S4.E7.m1.3.3.3.6.2" xref="S4.E7.m1.3.3.3.cmml"><mo id="S4.E7.m1.3.3.3.6.2.1" stretchy="false" xref="S4.E7.m1.3.3.3.cmml">(</mo><mi id="S4.E7.m1.3.3.3.3" xref="S4.E7.m1.3.3.3.3.cmml">s</mi><mo id="S4.E7.m1.3.3.3.6.2.2" stretchy="false" xref="S4.E7.m1.3.3.3.cmml">)</mo></mrow><mo id="S4.E7.m1.3.3.3.4a" xref="S4.E7.m1.3.3.3.4.cmml">⁢</mo><msup id="S4.E7.m1.3.3.3.7" xref="S4.E7.m1.3.3.3.7.cmml"><mi id="S4.E7.m1.3.3.3.7.2" xref="S4.E7.m1.3.3.3.7.2.cmml">e</mi><mrow id="S4.E7.m1.2.2.2.2.2" xref="S4.E7.m1.2.2.2.2.2.cmml"><mo id="S4.E7.m1.2.2.2.2.2a" xref="S4.E7.m1.2.2.2.2.2.cmml">−</mo><msup id="S4.E7.m1.2.2.2.2.2.2" xref="S4.E7.m1.2.2.2.2.2.2.cmml"><mrow id="S4.E7.m1.2.2.2.2.2.2.1.1" xref="S4.E7.m1.2.2.2.2.2.2.1.2.cmml"><mo id="S4.E7.m1.2.2.2.2.2.2.1.1.2" stretchy="false" xref="S4.E7.m1.2.2.2.2.2.2.1.2.1.cmml">|</mo><mrow id="S4.E7.m1.2.2.2.2.2.2.1.1.1" xref="S4.E7.m1.2.2.2.2.2.2.1.1.1.cmml"><mi id="S4.E7.m1.2.2.2.2.2.2.1.1.1.2" xref="S4.E7.m1.2.2.2.2.2.2.1.1.1.2.cmml">b</mi><mo id="S4.E7.m1.2.2.2.2.2.2.1.1.1.1" xref="S4.E7.m1.2.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><mrow id="S4.E7.m1.2.2.2.2.2.2.1.1.1.3.2" xref="S4.E7.m1.2.2.2.2.2.2.1.1.1.cmml"><mo id="S4.E7.m1.2.2.2.2.2.2.1.1.1.3.2.1" stretchy="false" xref="S4.E7.m1.2.2.2.2.2.2.1.1.1.cmml">(</mo><mi id="S4.E7.m1.1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.1.cmml">s</mi><mo id="S4.E7.m1.2.2.2.2.2.2.1.1.1.3.2.2" stretchy="false" xref="S4.E7.m1.2.2.2.2.2.2.1.1.1.cmml">)</mo></mrow><mo id="S4.E7.m1.2.2.2.2.2.2.1.1.1.1a" xref="S4.E7.m1.2.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="S4.E7.m1.2.2.2.2.2.2.1.1.1.4" xref="S4.E7.m1.2.2.2.2.2.2.1.1.1.4.cmml">x</mi></mrow><mo id="S4.E7.m1.2.2.2.2.2.2.1.1.3" stretchy="false" xref="S4.E7.m1.2.2.2.2.2.2.1.2.1.cmml">|</mo></mrow><mi id="S4.E7.m1.2.2.2.2.2.2.3" xref="S4.E7.m1.2.2.2.2.2.2.3.cmml">s</mi></msup></mrow></msup></mrow><mrow id="S4.E7.m1.4.4.4" xref="S4.E7.m1.4.4.4.cmml"><mi id="S4.E7.m1.4.4.4.3" xref="S4.E7.m1.4.4.4.3.cmml">Z</mi><mo id="S4.E7.m1.4.4.4.2" xref="S4.E7.m1.4.4.4.2.cmml">⁢</mo><mrow id="S4.E7.m1.4.4.4.4.2" xref="S4.E7.m1.4.4.4.cmml"><mo id="S4.E7.m1.4.4.4.4.2.1" stretchy="false" xref="S4.E7.m1.4.4.4.cmml">(</mo><mi id="S4.E7.m1.4.4.4.1" xref="S4.E7.m1.4.4.4.1.cmml">s</mi><mo id="S4.E7.m1.4.4.4.4.2.2" stretchy="false" xref="S4.E7.m1.4.4.4.cmml">)</mo></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.5b"><apply id="S4.E7.m1.5.6.cmml" xref="S4.E7.m1.5.6"><eq id="S4.E7.m1.5.6.1.cmml" xref="S4.E7.m1.5.6.1"></eq><apply id="S4.E7.m1.5.6.2.cmml" xref="S4.E7.m1.5.6.2"><times id="S4.E7.m1.5.6.2.1.cmml" xref="S4.E7.m1.5.6.2.1"></times><apply id="S4.E7.m1.5.6.2.2.cmml" xref="S4.E7.m1.5.6.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.5.6.2.2.1.cmml" xref="S4.E7.m1.5.6.2.2">subscript</csymbol><ci id="S4.E7.m1.5.6.2.2.2.cmml" xref="S4.E7.m1.5.6.2.2.2">𝐾</ci><ci id="S4.E7.m1.5.6.2.2.3.cmml" xref="S4.E7.m1.5.6.2.2.3">𝑠</ci></apply><ci id="S4.E7.m1.5.5.cmml" xref="S4.E7.m1.5.5">𝑥</ci></apply><apply id="S4.E7.m1.4.4.cmml" xref="S4.E7.m1.4.4"><divide id="S4.E7.m1.4.4.5.cmml" xref="S4.E7.m1.4.4"></divide><apply id="S4.E7.m1.3.3.3.cmml" xref="S4.E7.m1.3.3.3"><times id="S4.E7.m1.3.3.3.4.cmml" xref="S4.E7.m1.3.3.3.4"></times><ci id="S4.E7.m1.3.3.3.5.cmml" xref="S4.E7.m1.3.3.3.5">𝑏</ci><ci id="S4.E7.m1.3.3.3.3.cmml" xref="S4.E7.m1.3.3.3.3">𝑠</ci><apply id="S4.E7.m1.3.3.3.7.cmml" xref="S4.E7.m1.3.3.3.7"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.3.7.1.cmml" xref="S4.E7.m1.3.3.3.7">superscript</csymbol><ci id="S4.E7.m1.3.3.3.7.2.cmml" xref="S4.E7.m1.3.3.3.7.2">𝑒</ci><apply id="S4.E7.m1.2.2.2.2.2.cmml" xref="S4.E7.m1.2.2.2.2.2"><minus id="S4.E7.m1.2.2.2.2.2.3.cmml" xref="S4.E7.m1.2.2.2.2.2"></minus><apply id="S4.E7.m1.2.2.2.2.2.2.cmml" xref="S4.E7.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.2.2.2.2.2.cmml" xref="S4.E7.m1.2.2.2.2.2.2">superscript</csymbol><apply id="S4.E7.m1.2.2.2.2.2.2.1.2.cmml" xref="S4.E7.m1.2.2.2.2.2.2.1.1"><abs id="S4.E7.m1.2.2.2.2.2.2.1.2.1.cmml" xref="S4.E7.m1.2.2.2.2.2.2.1.1.2"></abs><apply id="S4.E7.m1.2.2.2.2.2.2.1.1.1.cmml" xref="S4.E7.m1.2.2.2.2.2.2.1.1.1"><times id="S4.E7.m1.2.2.2.2.2.2.1.1.1.1.cmml" xref="S4.E7.m1.2.2.2.2.2.2.1.1.1.1"></times><ci id="S4.E7.m1.2.2.2.2.2.2.1.1.1.2.cmml" xref="S4.E7.m1.2.2.2.2.2.2.1.1.1.2">𝑏</ci><ci id="S4.E7.m1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1">𝑠</ci><ci id="S4.E7.m1.2.2.2.2.2.2.1.1.1.4.cmml" xref="S4.E7.m1.2.2.2.2.2.2.1.1.1.4">𝑥</ci></apply></apply><ci id="S4.E7.m1.2.2.2.2.2.2.3.cmml" xref="S4.E7.m1.2.2.2.2.2.2.3">𝑠</ci></apply></apply></apply></apply><apply id="S4.E7.m1.4.4.4.cmml" xref="S4.E7.m1.4.4.4"><times id="S4.E7.m1.4.4.4.2.cmml" xref="S4.E7.m1.4.4.4.2"></times><ci id="S4.E7.m1.4.4.4.3.cmml" xref="S4.E7.m1.4.4.4.3">𝑍</ci><ci id="S4.E7.m1.4.4.4.1.cmml" xref="S4.E7.m1.4.4.4.1">𝑠</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.5c">K_{s}(x)=\frac{b(s)e^{-|b(s)x|^{s}}}{Z(s)}</annotation><annotation encoding="application/x-llamapun" id="S4.E7.m1.5d">italic_K start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ( italic_x ) = divide start_ARG italic_b ( italic_s ) italic_e start_POSTSUPERSCRIPT - | italic_b ( italic_s ) italic_x | start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT end_ARG start_ARG italic_Z ( italic_s ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS3.SSS1.p3.7">where <math alttext="Z(s)=2\Gamma(\frac{1}{s}+1)" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p3.3.m1.2"><semantics id="S4.SS3.SSS1.p3.3.m1.2a"><mrow id="S4.SS3.SSS1.p3.3.m1.2.2" xref="S4.SS3.SSS1.p3.3.m1.2.2.cmml"><mrow id="S4.SS3.SSS1.p3.3.m1.2.2.3" xref="S4.SS3.SSS1.p3.3.m1.2.2.3.cmml"><mi id="S4.SS3.SSS1.p3.3.m1.2.2.3.2" xref="S4.SS3.SSS1.p3.3.m1.2.2.3.2.cmml">Z</mi><mo id="S4.SS3.SSS1.p3.3.m1.2.2.3.1" xref="S4.SS3.SSS1.p3.3.m1.2.2.3.1.cmml">⁢</mo><mrow id="S4.SS3.SSS1.p3.3.m1.2.2.3.3.2" xref="S4.SS3.SSS1.p3.3.m1.2.2.3.cmml"><mo id="S4.SS3.SSS1.p3.3.m1.2.2.3.3.2.1" stretchy="false" xref="S4.SS3.SSS1.p3.3.m1.2.2.3.cmml">(</mo><mi id="S4.SS3.SSS1.p3.3.m1.1.1" xref="S4.SS3.SSS1.p3.3.m1.1.1.cmml">s</mi><mo id="S4.SS3.SSS1.p3.3.m1.2.2.3.3.2.2" stretchy="false" xref="S4.SS3.SSS1.p3.3.m1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.SS3.SSS1.p3.3.m1.2.2.2" xref="S4.SS3.SSS1.p3.3.m1.2.2.2.cmml">=</mo><mrow id="S4.SS3.SSS1.p3.3.m1.2.2.1" xref="S4.SS3.SSS1.p3.3.m1.2.2.1.cmml"><mn id="S4.SS3.SSS1.p3.3.m1.2.2.1.3" xref="S4.SS3.SSS1.p3.3.m1.2.2.1.3.cmml">2</mn><mo id="S4.SS3.SSS1.p3.3.m1.2.2.1.2" xref="S4.SS3.SSS1.p3.3.m1.2.2.1.2.cmml">⁢</mo><mi id="S4.SS3.SSS1.p3.3.m1.2.2.1.4" mathvariant="normal" xref="S4.SS3.SSS1.p3.3.m1.2.2.1.4.cmml">Γ</mi><mo id="S4.SS3.SSS1.p3.3.m1.2.2.1.2a" xref="S4.SS3.SSS1.p3.3.m1.2.2.1.2.cmml">⁢</mo><mrow id="S4.SS3.SSS1.p3.3.m1.2.2.1.1.1" xref="S4.SS3.SSS1.p3.3.m1.2.2.1.1.1.1.cmml"><mo id="S4.SS3.SSS1.p3.3.m1.2.2.1.1.1.2" stretchy="false" xref="S4.SS3.SSS1.p3.3.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S4.SS3.SSS1.p3.3.m1.2.2.1.1.1.1" xref="S4.SS3.SSS1.p3.3.m1.2.2.1.1.1.1.cmml"><mfrac id="S4.SS3.SSS1.p3.3.m1.2.2.1.1.1.1.2" xref="S4.SS3.SSS1.p3.3.m1.2.2.1.1.1.1.2.cmml"><mn id="S4.SS3.SSS1.p3.3.m1.2.2.1.1.1.1.2.2" xref="S4.SS3.SSS1.p3.3.m1.2.2.1.1.1.1.2.2.cmml">1</mn><mi id="S4.SS3.SSS1.p3.3.m1.2.2.1.1.1.1.2.3" xref="S4.SS3.SSS1.p3.3.m1.2.2.1.1.1.1.2.3.cmml">s</mi></mfrac><mo id="S4.SS3.SSS1.p3.3.m1.2.2.1.1.1.1.1" xref="S4.SS3.SSS1.p3.3.m1.2.2.1.1.1.1.1.cmml">+</mo><mn id="S4.SS3.SSS1.p3.3.m1.2.2.1.1.1.1.3" xref="S4.SS3.SSS1.p3.3.m1.2.2.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.SS3.SSS1.p3.3.m1.2.2.1.1.1.3" stretchy="false" xref="S4.SS3.SSS1.p3.3.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p3.3.m1.2b"><apply id="S4.SS3.SSS1.p3.3.m1.2.2.cmml" xref="S4.SS3.SSS1.p3.3.m1.2.2"><eq id="S4.SS3.SSS1.p3.3.m1.2.2.2.cmml" xref="S4.SS3.SSS1.p3.3.m1.2.2.2"></eq><apply id="S4.SS3.SSS1.p3.3.m1.2.2.3.cmml" xref="S4.SS3.SSS1.p3.3.m1.2.2.3"><times id="S4.SS3.SSS1.p3.3.m1.2.2.3.1.cmml" xref="S4.SS3.SSS1.p3.3.m1.2.2.3.1"></times><ci id="S4.SS3.SSS1.p3.3.m1.2.2.3.2.cmml" xref="S4.SS3.SSS1.p3.3.m1.2.2.3.2">𝑍</ci><ci id="S4.SS3.SSS1.p3.3.m1.1.1.cmml" xref="S4.SS3.SSS1.p3.3.m1.1.1">𝑠</ci></apply><apply id="S4.SS3.SSS1.p3.3.m1.2.2.1.cmml" xref="S4.SS3.SSS1.p3.3.m1.2.2.1"><times id="S4.SS3.SSS1.p3.3.m1.2.2.1.2.cmml" xref="S4.SS3.SSS1.p3.3.m1.2.2.1.2"></times><cn id="S4.SS3.SSS1.p3.3.m1.2.2.1.3.cmml" type="integer" xref="S4.SS3.SSS1.p3.3.m1.2.2.1.3">2</cn><ci id="S4.SS3.SSS1.p3.3.m1.2.2.1.4.cmml" xref="S4.SS3.SSS1.p3.3.m1.2.2.1.4">Γ</ci><apply id="S4.SS3.SSS1.p3.3.m1.2.2.1.1.1.1.cmml" xref="S4.SS3.SSS1.p3.3.m1.2.2.1.1.1"><plus id="S4.SS3.SSS1.p3.3.m1.2.2.1.1.1.1.1.cmml" xref="S4.SS3.SSS1.p3.3.m1.2.2.1.1.1.1.1"></plus><apply id="S4.SS3.SSS1.p3.3.m1.2.2.1.1.1.1.2.cmml" xref="S4.SS3.SSS1.p3.3.m1.2.2.1.1.1.1.2"><divide id="S4.SS3.SSS1.p3.3.m1.2.2.1.1.1.1.2.1.cmml" xref="S4.SS3.SSS1.p3.3.m1.2.2.1.1.1.1.2"></divide><cn id="S4.SS3.SSS1.p3.3.m1.2.2.1.1.1.1.2.2.cmml" type="integer" xref="S4.SS3.SSS1.p3.3.m1.2.2.1.1.1.1.2.2">1</cn><ci id="S4.SS3.SSS1.p3.3.m1.2.2.1.1.1.1.2.3.cmml" xref="S4.SS3.SSS1.p3.3.m1.2.2.1.1.1.1.2.3">𝑠</ci></apply><cn id="S4.SS3.SSS1.p3.3.m1.2.2.1.1.1.1.3.cmml" type="integer" xref="S4.SS3.SSS1.p3.3.m1.2.2.1.1.1.1.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p3.3.m1.2c">Z(s)=2\Gamma(\frac{1}{s}+1)</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p3.3.m1.2d">italic_Z ( italic_s ) = 2 roman_Γ ( divide start_ARG 1 end_ARG start_ARG italic_s end_ARG + 1 )</annotation></semantics></math> normalizes the kernel to integrate to 1, and <math alttext="b(s)=\sqrt{\frac{\Gamma(\frac{3}{s}+1)}{3\Gamma(\frac{1}{s}+1)}}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p3.4.m2.3"><semantics id="S4.SS3.SSS1.p3.4.m2.3a"><mrow id="S4.SS3.SSS1.p3.4.m2.3.4" xref="S4.SS3.SSS1.p3.4.m2.3.4.cmml"><mrow id="S4.SS3.SSS1.p3.4.m2.3.4.2" xref="S4.SS3.SSS1.p3.4.m2.3.4.2.cmml"><mi id="S4.SS3.SSS1.p3.4.m2.3.4.2.2" xref="S4.SS3.SSS1.p3.4.m2.3.4.2.2.cmml">b</mi><mo id="S4.SS3.SSS1.p3.4.m2.3.4.2.1" xref="S4.SS3.SSS1.p3.4.m2.3.4.2.1.cmml">⁢</mo><mrow id="S4.SS3.SSS1.p3.4.m2.3.4.2.3.2" xref="S4.SS3.SSS1.p3.4.m2.3.4.2.cmml"><mo id="S4.SS3.SSS1.p3.4.m2.3.4.2.3.2.1" stretchy="false" xref="S4.SS3.SSS1.p3.4.m2.3.4.2.cmml">(</mo><mi id="S4.SS3.SSS1.p3.4.m2.3.3" xref="S4.SS3.SSS1.p3.4.m2.3.3.cmml">s</mi><mo id="S4.SS3.SSS1.p3.4.m2.3.4.2.3.2.2" stretchy="false" xref="S4.SS3.SSS1.p3.4.m2.3.4.2.cmml">)</mo></mrow></mrow><mo id="S4.SS3.SSS1.p3.4.m2.3.4.1" xref="S4.SS3.SSS1.p3.4.m2.3.4.1.cmml">=</mo><msqrt id="S4.SS3.SSS1.p3.4.m2.2.2" xref="S4.SS3.SSS1.p3.4.m2.2.2.cmml"><mfrac id="S4.SS3.SSS1.p3.4.m2.2.2.2" xref="S4.SS3.SSS1.p3.4.m2.2.2.2.cmml"><mrow id="S4.SS3.SSS1.p3.4.m2.1.1.1.1.1" xref="S4.SS3.SSS1.p3.4.m2.1.1.1.1.1.cmml"><mi id="S4.SS3.SSS1.p3.4.m2.1.1.1.1.1.3" mathvariant="normal" xref="S4.SS3.SSS1.p3.4.m2.1.1.1.1.1.3.cmml">Γ</mi><mo id="S4.SS3.SSS1.p3.4.m2.1.1.1.1.1.2" xref="S4.SS3.SSS1.p3.4.m2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.SS3.SSS1.p3.4.m2.1.1.1.1.1.1.1" xref="S4.SS3.SSS1.p3.4.m2.1.1.1.1.1.1.1.1.cmml"><mo id="S4.SS3.SSS1.p3.4.m2.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.SS3.SSS1.p3.4.m2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS3.SSS1.p3.4.m2.1.1.1.1.1.1.1.1" xref="S4.SS3.SSS1.p3.4.m2.1.1.1.1.1.1.1.1.cmml"><mfrac id="S4.SS3.SSS1.p3.4.m2.1.1.1.1.1.1.1.1.2" xref="S4.SS3.SSS1.p3.4.m2.1.1.1.1.1.1.1.1.2.cmml"><mn id="S4.SS3.SSS1.p3.4.m2.1.1.1.1.1.1.1.1.2.2" xref="S4.SS3.SSS1.p3.4.m2.1.1.1.1.1.1.1.1.2.2.cmml">3</mn><mi id="S4.SS3.SSS1.p3.4.m2.1.1.1.1.1.1.1.1.2.3" xref="S4.SS3.SSS1.p3.4.m2.1.1.1.1.1.1.1.1.2.3.cmml">s</mi></mfrac><mo id="S4.SS3.SSS1.p3.4.m2.1.1.1.1.1.1.1.1.1" xref="S4.SS3.SSS1.p3.4.m2.1.1.1.1.1.1.1.1.1.cmml">+</mo><mn id="S4.SS3.SSS1.p3.4.m2.1.1.1.1.1.1.1.1.3" xref="S4.SS3.SSS1.p3.4.m2.1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.SS3.SSS1.p3.4.m2.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.SS3.SSS1.p3.4.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2" xref="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2.cmml"><mn id="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2.3" xref="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2.3.cmml">3</mn><mo id="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2.2" xref="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2.2.cmml">⁢</mo><mi id="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2.4" mathvariant="normal" xref="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2.4.cmml">Γ</mi><mo id="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2.2a" xref="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2.2.cmml">⁢</mo><mrow id="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2.1.1" xref="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2.1.1.1.cmml"><mo id="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2.1.1.2" stretchy="false" xref="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2.1.1.1" xref="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2.1.1.1.cmml"><mfrac id="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2.1.1.1.2" xref="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2.1.1.1.2.cmml"><mn id="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2.1.1.1.2.2" xref="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2.1.1.1.2.2.cmml">1</mn><mi id="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2.1.1.1.2.3" xref="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2.1.1.1.2.3.cmml">s</mi></mfrac><mo id="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2.1.1.1.1" xref="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2.1.1.1.1.cmml">+</mo><mn id="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2.1.1.1.3" xref="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2.1.1.1.3.cmml">1</mn></mrow><mo id="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2.1.1.3" stretchy="false" xref="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></msqrt></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p3.4.m2.3b"><apply id="S4.SS3.SSS1.p3.4.m2.3.4.cmml" xref="S4.SS3.SSS1.p3.4.m2.3.4"><eq id="S4.SS3.SSS1.p3.4.m2.3.4.1.cmml" xref="S4.SS3.SSS1.p3.4.m2.3.4.1"></eq><apply id="S4.SS3.SSS1.p3.4.m2.3.4.2.cmml" xref="S4.SS3.SSS1.p3.4.m2.3.4.2"><times id="S4.SS3.SSS1.p3.4.m2.3.4.2.1.cmml" xref="S4.SS3.SSS1.p3.4.m2.3.4.2.1"></times><ci id="S4.SS3.SSS1.p3.4.m2.3.4.2.2.cmml" xref="S4.SS3.SSS1.p3.4.m2.3.4.2.2">𝑏</ci><ci id="S4.SS3.SSS1.p3.4.m2.3.3.cmml" xref="S4.SS3.SSS1.p3.4.m2.3.3">𝑠</ci></apply><apply id="S4.SS3.SSS1.p3.4.m2.2.2.cmml" xref="S4.SS3.SSS1.p3.4.m2.2.2"><root id="S4.SS3.SSS1.p3.4.m2.2.2a.cmml" xref="S4.SS3.SSS1.p3.4.m2.2.2"></root><apply id="S4.SS3.SSS1.p3.4.m2.2.2.2.cmml" xref="S4.SS3.SSS1.p3.4.m2.2.2.2"><divide id="S4.SS3.SSS1.p3.4.m2.2.2.2.3.cmml" xref="S4.SS3.SSS1.p3.4.m2.2.2.2"></divide><apply id="S4.SS3.SSS1.p3.4.m2.1.1.1.1.1.cmml" xref="S4.SS3.SSS1.p3.4.m2.1.1.1.1.1"><times id="S4.SS3.SSS1.p3.4.m2.1.1.1.1.1.2.cmml" xref="S4.SS3.SSS1.p3.4.m2.1.1.1.1.1.2"></times><ci id="S4.SS3.SSS1.p3.4.m2.1.1.1.1.1.3.cmml" xref="S4.SS3.SSS1.p3.4.m2.1.1.1.1.1.3">Γ</ci><apply id="S4.SS3.SSS1.p3.4.m2.1.1.1.1.1.1.1.1.cmml" xref="S4.SS3.SSS1.p3.4.m2.1.1.1.1.1.1.1"><plus id="S4.SS3.SSS1.p3.4.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS3.SSS1.p3.4.m2.1.1.1.1.1.1.1.1.1"></plus><apply id="S4.SS3.SSS1.p3.4.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS3.SSS1.p3.4.m2.1.1.1.1.1.1.1.1.2"><divide id="S4.SS3.SSS1.p3.4.m2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.SS3.SSS1.p3.4.m2.1.1.1.1.1.1.1.1.2"></divide><cn id="S4.SS3.SSS1.p3.4.m2.1.1.1.1.1.1.1.1.2.2.cmml" type="integer" xref="S4.SS3.SSS1.p3.4.m2.1.1.1.1.1.1.1.1.2.2">3</cn><ci id="S4.SS3.SSS1.p3.4.m2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.SS3.SSS1.p3.4.m2.1.1.1.1.1.1.1.1.2.3">𝑠</ci></apply><cn id="S4.SS3.SSS1.p3.4.m2.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.SS3.SSS1.p3.4.m2.1.1.1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2.cmml" xref="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2"><times id="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2.2.cmml" xref="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2.2"></times><cn id="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2.3.cmml" type="integer" xref="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2.3">3</cn><ci id="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2.4.cmml" xref="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2.4">Γ</ci><apply id="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2.1.1.1.cmml" xref="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2.1.1"><plus id="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2.1.1.1.1.cmml" xref="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2.1.1.1.1"></plus><apply id="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2.1.1.1.2.cmml" xref="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2.1.1.1.2"><divide id="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2.1.1.1.2.1.cmml" xref="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2.1.1.1.2"></divide><cn id="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2.1.1.1.2.2.cmml" type="integer" xref="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2.1.1.1.2.2">1</cn><ci id="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2.1.1.1.2.3.cmml" xref="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2.1.1.1.2.3">𝑠</ci></apply><cn id="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2.1.1.1.3.cmml" type="integer" xref="S4.SS3.SSS1.p3.4.m2.2.2.2.2.2.1.1.1.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p3.4.m2.3c">b(s)=\sqrt{\frac{\Gamma(\frac{3}{s}+1)}{3\Gamma(\frac{1}{s}+1)}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p3.4.m2.3d">italic_b ( italic_s ) = square-root start_ARG divide start_ARG roman_Γ ( divide start_ARG 3 end_ARG start_ARG italic_s end_ARG + 1 ) end_ARG start_ARG 3 roman_Γ ( divide start_ARG 1 end_ARG start_ARG italic_s end_ARG + 1 ) end_ARG end_ARG</annotation></semantics></math> scales it to maintain unit variance.
This parameterization allows us to interpolate between common kernel shapes such as exponential (<math alttext="s=1" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p3.5.m3.1"><semantics id="S4.SS3.SSS1.p3.5.m3.1a"><mrow id="S4.SS3.SSS1.p3.5.m3.1.1" xref="S4.SS3.SSS1.p3.5.m3.1.1.cmml"><mi id="S4.SS3.SSS1.p3.5.m3.1.1.2" xref="S4.SS3.SSS1.p3.5.m3.1.1.2.cmml">s</mi><mo id="S4.SS3.SSS1.p3.5.m3.1.1.1" xref="S4.SS3.SSS1.p3.5.m3.1.1.1.cmml">=</mo><mn id="S4.SS3.SSS1.p3.5.m3.1.1.3" xref="S4.SS3.SSS1.p3.5.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p3.5.m3.1b"><apply id="S4.SS3.SSS1.p3.5.m3.1.1.cmml" xref="S4.SS3.SSS1.p3.5.m3.1.1"><eq id="S4.SS3.SSS1.p3.5.m3.1.1.1.cmml" xref="S4.SS3.SSS1.p3.5.m3.1.1.1"></eq><ci id="S4.SS3.SSS1.p3.5.m3.1.1.2.cmml" xref="S4.SS3.SSS1.p3.5.m3.1.1.2">𝑠</ci><cn id="S4.SS3.SSS1.p3.5.m3.1.1.3.cmml" type="integer" xref="S4.SS3.SSS1.p3.5.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p3.5.m3.1c">s=1</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p3.5.m3.1d">italic_s = 1</annotation></semantics></math>), Gaussian (<math alttext="s=2" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p3.6.m4.1"><semantics id="S4.SS3.SSS1.p3.6.m4.1a"><mrow id="S4.SS3.SSS1.p3.6.m4.1.1" xref="S4.SS3.SSS1.p3.6.m4.1.1.cmml"><mi id="S4.SS3.SSS1.p3.6.m4.1.1.2" xref="S4.SS3.SSS1.p3.6.m4.1.1.2.cmml">s</mi><mo id="S4.SS3.SSS1.p3.6.m4.1.1.1" xref="S4.SS3.SSS1.p3.6.m4.1.1.1.cmml">=</mo><mn id="S4.SS3.SSS1.p3.6.m4.1.1.3" xref="S4.SS3.SSS1.p3.6.m4.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p3.6.m4.1b"><apply id="S4.SS3.SSS1.p3.6.m4.1.1.cmml" xref="S4.SS3.SSS1.p3.6.m4.1.1"><eq id="S4.SS3.SSS1.p3.6.m4.1.1.1.cmml" xref="S4.SS3.SSS1.p3.6.m4.1.1.1"></eq><ci id="S4.SS3.SSS1.p3.6.m4.1.1.2.cmml" xref="S4.SS3.SSS1.p3.6.m4.1.1.2">𝑠</ci><cn id="S4.SS3.SSS1.p3.6.m4.1.1.3.cmml" type="integer" xref="S4.SS3.SSS1.p3.6.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p3.6.m4.1c">s=2</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p3.6.m4.1d">italic_s = 2</annotation></semantics></math>), and tophat (<math alttext="s\to\infty" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p3.7.m5.1"><semantics id="S4.SS3.SSS1.p3.7.m5.1a"><mrow id="S4.SS3.SSS1.p3.7.m5.1.1" xref="S4.SS3.SSS1.p3.7.m5.1.1.cmml"><mi id="S4.SS3.SSS1.p3.7.m5.1.1.2" xref="S4.SS3.SSS1.p3.7.m5.1.1.2.cmml">s</mi><mo id="S4.SS3.SSS1.p3.7.m5.1.1.1" stretchy="false" xref="S4.SS3.SSS1.p3.7.m5.1.1.1.cmml">→</mo><mi id="S4.SS3.SSS1.p3.7.m5.1.1.3" mathvariant="normal" xref="S4.SS3.SSS1.p3.7.m5.1.1.3.cmml">∞</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p3.7.m5.1b"><apply id="S4.SS3.SSS1.p3.7.m5.1.1.cmml" xref="S4.SS3.SSS1.p3.7.m5.1.1"><ci id="S4.SS3.SSS1.p3.7.m5.1.1.1.cmml" xref="S4.SS3.SSS1.p3.7.m5.1.1.1">→</ci><ci id="S4.SS3.SSS1.p3.7.m5.1.1.2.cmml" xref="S4.SS3.SSS1.p3.7.m5.1.1.2">𝑠</ci><infinity id="S4.SS3.SSS1.p3.7.m5.1.1.3.cmml" xref="S4.SS3.SSS1.p3.7.m5.1.1.3"></infinity></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p3.7.m5.1c">s\to\infty</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p3.7.m5.1d">italic_s → ∞</annotation></semantics></math>), as visualized in
Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#S4.F5" title="Figure 5 ‣ 4.3.1 Bespoke KDE Model ‣ 4.3 The Kernel Interpretation of In-Context Density Estimation ‣ 4 Experiments and analysis ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
<figure class="ltx_figure" id="S4.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="76" id="S4.F5.g1" src="extracted/5899401/figures/bespoke_kernel_interpolation.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Bespoke kernel interpolates various common kernel shapes.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS3.SSS1.p4">
<p class="ltx_p" id="S4.SS3.SSS1.p4.4">We visualize the DE trajectories with these three common kernels (<math alttext="s=1,2" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p4.1.m1.2"><semantics id="S4.SS3.SSS1.p4.1.m1.2a"><mrow id="S4.SS3.SSS1.p4.1.m1.2.3" xref="S4.SS3.SSS1.p4.1.m1.2.3.cmml"><mi id="S4.SS3.SSS1.p4.1.m1.2.3.2" xref="S4.SS3.SSS1.p4.1.m1.2.3.2.cmml">s</mi><mo id="S4.SS3.SSS1.p4.1.m1.2.3.1" xref="S4.SS3.SSS1.p4.1.m1.2.3.1.cmml">=</mo><mrow id="S4.SS3.SSS1.p4.1.m1.2.3.3.2" xref="S4.SS3.SSS1.p4.1.m1.2.3.3.1.cmml"><mn id="S4.SS3.SSS1.p4.1.m1.1.1" xref="S4.SS3.SSS1.p4.1.m1.1.1.cmml">1</mn><mo id="S4.SS3.SSS1.p4.1.m1.2.3.3.2.1" xref="S4.SS3.SSS1.p4.1.m1.2.3.3.1.cmml">,</mo><mn id="S4.SS3.SSS1.p4.1.m1.2.2" xref="S4.SS3.SSS1.p4.1.m1.2.2.cmml">2</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p4.1.m1.2b"><apply id="S4.SS3.SSS1.p4.1.m1.2.3.cmml" xref="S4.SS3.SSS1.p4.1.m1.2.3"><eq id="S4.SS3.SSS1.p4.1.m1.2.3.1.cmml" xref="S4.SS3.SSS1.p4.1.m1.2.3.1"></eq><ci id="S4.SS3.SSS1.p4.1.m1.2.3.2.cmml" xref="S4.SS3.SSS1.p4.1.m1.2.3.2">𝑠</ci><list id="S4.SS3.SSS1.p4.1.m1.2.3.3.1.cmml" xref="S4.SS3.SSS1.p4.1.m1.2.3.3.2"><cn id="S4.SS3.SSS1.p4.1.m1.1.1.cmml" type="integer" xref="S4.SS3.SSS1.p4.1.m1.1.1">1</cn><cn id="S4.SS3.SSS1.p4.1.m1.2.2.cmml" type="integer" xref="S4.SS3.SSS1.p4.1.m1.2.2">2</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p4.1.m1.2c">s=1,2</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p4.1.m1.2d">italic_s = 1 , 2</annotation></semantics></math>, and <math alttext="\infty" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p4.2.m2.1"><semantics id="S4.SS3.SSS1.p4.2.m2.1a"><mi id="S4.SS3.SSS1.p4.2.m2.1.1" mathvariant="normal" xref="S4.SS3.SSS1.p4.2.m2.1.1.cmml">∞</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p4.2.m2.1b"><infinity id="S4.SS3.SSS1.p4.2.m2.1.1.cmml" xref="S4.SS3.SSS1.p4.2.m2.1.1"></infinity></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p4.2.m2.1c">\infty</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p4.2.m2.1d">∞</annotation></semantics></math>) in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.F13" title="Figure 13 ‣ A.5.2 Optimal kernel shape ‣ A.5 Additional notes on Kernel Density Estimation ‣ Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">13</span></a> of Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.SS5.SSS2" title="A.5.2 Optimal kernel shape ‣ A.5 Additional notes on Kernel Density Estimation ‣ Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">A.5.2</span></a>.
As the shape parameter (<math alttext="s" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p4.3.m3.1"><semantics id="S4.SS3.SSS1.p4.3.m3.1a"><mi id="S4.SS3.SSS1.p4.3.m3.1.1" xref="S4.SS3.SSS1.p4.3.m3.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p4.3.m3.1b"><ci id="S4.SS3.SSS1.p4.3.m3.1.1.cmml" xref="S4.SS3.SSS1.p4.3.m3.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p4.3.m3.1c">s</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p4.3.m3.1d">italic_s</annotation></semantics></math>) decreases, the DE trajectories gradually shift from outside the Gaussian submanifold to inside, moving closer to LLaMA’s trajectory.
This trend suggests that our parameterization (Equation <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#S4.E7" title="Equation 7 ‣ 4.3.1 Bespoke KDE Model ‣ 4.3 The Kernel Interpretation of In-Context Density Estimation ‣ 4 Experiments and analysis ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">7</span></a>) may be able to capture LLaMA’s behavior by allowing <math alttext="s" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p4.4.m4.1"><semantics id="S4.SS3.SSS1.p4.4.m4.1a"><mi id="S4.SS3.SSS1.p4.4.m4.1.1" xref="S4.SS3.SSS1.p4.4.m4.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p4.4.m4.1b"><ci id="S4.SS3.SSS1.p4.4.m4.1.1.cmml" xref="S4.SS3.SSS1.p4.4.m4.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p4.4.m4.1c">s</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p4.4.m4.1d">italic_s</annotation></semantics></math> to take values below 1, extending beyond the range of common kernel shapes.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.SSS1.p5">
<p class="ltx_p" id="S4.SS3.SSS1.p5.2">We augment the standard KDE formula with kernel shape, resulting in two hyperparameters: <math alttext="h" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p5.1.m1.1"><semantics id="S4.SS3.SSS1.p5.1.m1.1a"><mi id="S4.SS3.SSS1.p5.1.m1.1.1" xref="S4.SS3.SSS1.p5.1.m1.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p5.1.m1.1b"><ci id="S4.SS3.SSS1.p5.1.m1.1.1.cmml" xref="S4.SS3.SSS1.p5.1.m1.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p5.1.m1.1c">h</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p5.1.m1.1d">italic_h</annotation></semantics></math> and <math alttext="s" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p5.2.m2.1"><semantics id="S4.SS3.SSS1.p5.2.m2.1a"><mi id="S4.SS3.SSS1.p5.2.m2.1.1" xref="S4.SS3.SSS1.p5.2.m2.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p5.2.m2.1b"><ci id="S4.SS3.SSS1.p5.2.m2.1.1.cmml" xref="S4.SS3.SSS1.p5.2.m2.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p5.2.m2.1c">s</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p5.2.m2.1d">italic_s</annotation></semantics></math>.</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{p}_{h,s}(x)=\frac{1}{nh}\sum_{i=1}^{n}K_{s}\left(\frac{x-X_{i}}{h}\right)" class="ltx_Math" display="block" id="S4.E8.m1.4"><semantics id="S4.E8.m1.4a"><mrow id="S4.E8.m1.4.5" xref="S4.E8.m1.4.5.cmml"><mrow id="S4.E8.m1.4.5.2" xref="S4.E8.m1.4.5.2.cmml"><msub id="S4.E8.m1.4.5.2.2" xref="S4.E8.m1.4.5.2.2.cmml"><mover accent="true" id="S4.E8.m1.4.5.2.2.2" xref="S4.E8.m1.4.5.2.2.2.cmml"><mi id="S4.E8.m1.4.5.2.2.2.2" xref="S4.E8.m1.4.5.2.2.2.2.cmml">p</mi><mo id="S4.E8.m1.4.5.2.2.2.1" xref="S4.E8.m1.4.5.2.2.2.1.cmml">^</mo></mover><mrow id="S4.E8.m1.2.2.2.4" xref="S4.E8.m1.2.2.2.3.cmml"><mi id="S4.E8.m1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.cmml">h</mi><mo id="S4.E8.m1.2.2.2.4.1" xref="S4.E8.m1.2.2.2.3.cmml">,</mo><mi id="S4.E8.m1.2.2.2.2" xref="S4.E8.m1.2.2.2.2.cmml">s</mi></mrow></msub><mo id="S4.E8.m1.4.5.2.1" xref="S4.E8.m1.4.5.2.1.cmml">⁢</mo><mrow id="S4.E8.m1.4.5.2.3.2" xref="S4.E8.m1.4.5.2.cmml"><mo id="S4.E8.m1.4.5.2.3.2.1" stretchy="false" xref="S4.E8.m1.4.5.2.cmml">(</mo><mi id="S4.E8.m1.3.3" xref="S4.E8.m1.3.3.cmml">x</mi><mo id="S4.E8.m1.4.5.2.3.2.2" stretchy="false" xref="S4.E8.m1.4.5.2.cmml">)</mo></mrow></mrow><mo id="S4.E8.m1.4.5.1" xref="S4.E8.m1.4.5.1.cmml">=</mo><mrow id="S4.E8.m1.4.5.3" xref="S4.E8.m1.4.5.3.cmml"><mfrac id="S4.E8.m1.4.5.3.2" xref="S4.E8.m1.4.5.3.2.cmml"><mn id="S4.E8.m1.4.5.3.2.2" xref="S4.E8.m1.4.5.3.2.2.cmml">1</mn><mrow id="S4.E8.m1.4.5.3.2.3" xref="S4.E8.m1.4.5.3.2.3.cmml"><mi id="S4.E8.m1.4.5.3.2.3.2" xref="S4.E8.m1.4.5.3.2.3.2.cmml">n</mi><mo id="S4.E8.m1.4.5.3.2.3.1" xref="S4.E8.m1.4.5.3.2.3.1.cmml">⁢</mo><mi id="S4.E8.m1.4.5.3.2.3.3" xref="S4.E8.m1.4.5.3.2.3.3.cmml">h</mi></mrow></mfrac><mo id="S4.E8.m1.4.5.3.1" xref="S4.E8.m1.4.5.3.1.cmml">⁢</mo><mrow id="S4.E8.m1.4.5.3.3" xref="S4.E8.m1.4.5.3.3.cmml"><munderover id="S4.E8.m1.4.5.3.3.1" xref="S4.E8.m1.4.5.3.3.1.cmml"><mo id="S4.E8.m1.4.5.3.3.1.2.2" movablelimits="false" xref="S4.E8.m1.4.5.3.3.1.2.2.cmml">∑</mo><mrow id="S4.E8.m1.4.5.3.3.1.2.3" xref="S4.E8.m1.4.5.3.3.1.2.3.cmml"><mi id="S4.E8.m1.4.5.3.3.1.2.3.2" xref="S4.E8.m1.4.5.3.3.1.2.3.2.cmml">i</mi><mo id="S4.E8.m1.4.5.3.3.1.2.3.1" xref="S4.E8.m1.4.5.3.3.1.2.3.1.cmml">=</mo><mn id="S4.E8.m1.4.5.3.3.1.2.3.3" xref="S4.E8.m1.4.5.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S4.E8.m1.4.5.3.3.1.3" xref="S4.E8.m1.4.5.3.3.1.3.cmml">n</mi></munderover><mrow id="S4.E8.m1.4.5.3.3.2" xref="S4.E8.m1.4.5.3.3.2.cmml"><msub id="S4.E8.m1.4.5.3.3.2.2" xref="S4.E8.m1.4.5.3.3.2.2.cmml"><mi id="S4.E8.m1.4.5.3.3.2.2.2" xref="S4.E8.m1.4.5.3.3.2.2.2.cmml">K</mi><mi id="S4.E8.m1.4.5.3.3.2.2.3" xref="S4.E8.m1.4.5.3.3.2.2.3.cmml">s</mi></msub><mo id="S4.E8.m1.4.5.3.3.2.1" xref="S4.E8.m1.4.5.3.3.2.1.cmml">⁢</mo><mrow id="S4.E8.m1.4.5.3.3.2.3.2" xref="S4.E8.m1.4.4.cmml"><mo id="S4.E8.m1.4.5.3.3.2.3.2.1" xref="S4.E8.m1.4.4.cmml">(</mo><mfrac id="S4.E8.m1.4.4" xref="S4.E8.m1.4.4.cmml"><mrow id="S4.E8.m1.4.4.2" xref="S4.E8.m1.4.4.2.cmml"><mi id="S4.E8.m1.4.4.2.2" xref="S4.E8.m1.4.4.2.2.cmml">x</mi><mo id="S4.E8.m1.4.4.2.1" xref="S4.E8.m1.4.4.2.1.cmml">−</mo><msub id="S4.E8.m1.4.4.2.3" xref="S4.E8.m1.4.4.2.3.cmml"><mi id="S4.E8.m1.4.4.2.3.2" xref="S4.E8.m1.4.4.2.3.2.cmml">X</mi><mi id="S4.E8.m1.4.4.2.3.3" xref="S4.E8.m1.4.4.2.3.3.cmml">i</mi></msub></mrow><mi id="S4.E8.m1.4.4.3" xref="S4.E8.m1.4.4.3.cmml">h</mi></mfrac><mo id="S4.E8.m1.4.5.3.3.2.3.2.2" xref="S4.E8.m1.4.4.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.4b"><apply id="S4.E8.m1.4.5.cmml" xref="S4.E8.m1.4.5"><eq id="S4.E8.m1.4.5.1.cmml" xref="S4.E8.m1.4.5.1"></eq><apply id="S4.E8.m1.4.5.2.cmml" xref="S4.E8.m1.4.5.2"><times id="S4.E8.m1.4.5.2.1.cmml" xref="S4.E8.m1.4.5.2.1"></times><apply id="S4.E8.m1.4.5.2.2.cmml" xref="S4.E8.m1.4.5.2.2"><csymbol cd="ambiguous" id="S4.E8.m1.4.5.2.2.1.cmml" xref="S4.E8.m1.4.5.2.2">subscript</csymbol><apply id="S4.E8.m1.4.5.2.2.2.cmml" xref="S4.E8.m1.4.5.2.2.2"><ci id="S4.E8.m1.4.5.2.2.2.1.cmml" xref="S4.E8.m1.4.5.2.2.2.1">^</ci><ci id="S4.E8.m1.4.5.2.2.2.2.cmml" xref="S4.E8.m1.4.5.2.2.2.2">𝑝</ci></apply><list id="S4.E8.m1.2.2.2.3.cmml" xref="S4.E8.m1.2.2.2.4"><ci id="S4.E8.m1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1">ℎ</ci><ci id="S4.E8.m1.2.2.2.2.cmml" xref="S4.E8.m1.2.2.2.2">𝑠</ci></list></apply><ci id="S4.E8.m1.3.3.cmml" xref="S4.E8.m1.3.3">𝑥</ci></apply><apply id="S4.E8.m1.4.5.3.cmml" xref="S4.E8.m1.4.5.3"><times id="S4.E8.m1.4.5.3.1.cmml" xref="S4.E8.m1.4.5.3.1"></times><apply id="S4.E8.m1.4.5.3.2.cmml" xref="S4.E8.m1.4.5.3.2"><divide id="S4.E8.m1.4.5.3.2.1.cmml" xref="S4.E8.m1.4.5.3.2"></divide><cn id="S4.E8.m1.4.5.3.2.2.cmml" type="integer" xref="S4.E8.m1.4.5.3.2.2">1</cn><apply id="S4.E8.m1.4.5.3.2.3.cmml" xref="S4.E8.m1.4.5.3.2.3"><times id="S4.E8.m1.4.5.3.2.3.1.cmml" xref="S4.E8.m1.4.5.3.2.3.1"></times><ci id="S4.E8.m1.4.5.3.2.3.2.cmml" xref="S4.E8.m1.4.5.3.2.3.2">𝑛</ci><ci id="S4.E8.m1.4.5.3.2.3.3.cmml" xref="S4.E8.m1.4.5.3.2.3.3">ℎ</ci></apply></apply><apply id="S4.E8.m1.4.5.3.3.cmml" xref="S4.E8.m1.4.5.3.3"><apply id="S4.E8.m1.4.5.3.3.1.cmml" xref="S4.E8.m1.4.5.3.3.1"><csymbol cd="ambiguous" id="S4.E8.m1.4.5.3.3.1.1.cmml" xref="S4.E8.m1.4.5.3.3.1">superscript</csymbol><apply id="S4.E8.m1.4.5.3.3.1.2.cmml" xref="S4.E8.m1.4.5.3.3.1"><csymbol cd="ambiguous" id="S4.E8.m1.4.5.3.3.1.2.1.cmml" xref="S4.E8.m1.4.5.3.3.1">subscript</csymbol><sum id="S4.E8.m1.4.5.3.3.1.2.2.cmml" xref="S4.E8.m1.4.5.3.3.1.2.2"></sum><apply id="S4.E8.m1.4.5.3.3.1.2.3.cmml" xref="S4.E8.m1.4.5.3.3.1.2.3"><eq id="S4.E8.m1.4.5.3.3.1.2.3.1.cmml" xref="S4.E8.m1.4.5.3.3.1.2.3.1"></eq><ci id="S4.E8.m1.4.5.3.3.1.2.3.2.cmml" xref="S4.E8.m1.4.5.3.3.1.2.3.2">𝑖</ci><cn id="S4.E8.m1.4.5.3.3.1.2.3.3.cmml" type="integer" xref="S4.E8.m1.4.5.3.3.1.2.3.3">1</cn></apply></apply><ci id="S4.E8.m1.4.5.3.3.1.3.cmml" xref="S4.E8.m1.4.5.3.3.1.3">𝑛</ci></apply><apply id="S4.E8.m1.4.5.3.3.2.cmml" xref="S4.E8.m1.4.5.3.3.2"><times id="S4.E8.m1.4.5.3.3.2.1.cmml" xref="S4.E8.m1.4.5.3.3.2.1"></times><apply id="S4.E8.m1.4.5.3.3.2.2.cmml" xref="S4.E8.m1.4.5.3.3.2.2"><csymbol cd="ambiguous" id="S4.E8.m1.4.5.3.3.2.2.1.cmml" xref="S4.E8.m1.4.5.3.3.2.2">subscript</csymbol><ci id="S4.E8.m1.4.5.3.3.2.2.2.cmml" xref="S4.E8.m1.4.5.3.3.2.2.2">𝐾</ci><ci id="S4.E8.m1.4.5.3.3.2.2.3.cmml" xref="S4.E8.m1.4.5.3.3.2.2.3">𝑠</ci></apply><apply id="S4.E8.m1.4.4.cmml" xref="S4.E8.m1.4.5.3.3.2.3.2"><divide id="S4.E8.m1.4.4.1.cmml" xref="S4.E8.m1.4.5.3.3.2.3.2"></divide><apply id="S4.E8.m1.4.4.2.cmml" xref="S4.E8.m1.4.4.2"><minus id="S4.E8.m1.4.4.2.1.cmml" xref="S4.E8.m1.4.4.2.1"></minus><ci id="S4.E8.m1.4.4.2.2.cmml" xref="S4.E8.m1.4.4.2.2">𝑥</ci><apply id="S4.E8.m1.4.4.2.3.cmml" xref="S4.E8.m1.4.4.2.3"><csymbol cd="ambiguous" id="S4.E8.m1.4.4.2.3.1.cmml" xref="S4.E8.m1.4.4.2.3">subscript</csymbol><ci id="S4.E8.m1.4.4.2.3.2.cmml" xref="S4.E8.m1.4.4.2.3.2">𝑋</ci><ci id="S4.E8.m1.4.4.2.3.3.cmml" xref="S4.E8.m1.4.4.2.3.3">𝑖</ci></apply></apply><ci id="S4.E8.m1.4.4.3.cmml" xref="S4.E8.m1.4.4.3">ℎ</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.4c">\hat{p}_{h,s}(x)=\frac{1}{nh}\sum_{i=1}^{n}K_{s}\left(\frac{x-X_{i}}{h}\right)</annotation><annotation encoding="application/x-llamapun" id="S4.E8.m1.4d">over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT italic_h , italic_s end_POSTSUBSCRIPT ( italic_x ) = divide start_ARG 1 end_ARG start_ARG italic_n italic_h end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_K start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ( divide start_ARG italic_x - italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG start_ARG italic_h end_ARG )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.SSS1.p6">
<p class="ltx_p" id="S4.SS3.SSS1.p6.1"><span class="ltx_text ltx_font_bold" id="S4.SS3.SSS1.p6.1.1">Step 2: Optimize kernel bandwidth (h) and shape (s)</span></p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.SSS1.p7">
<p class="ltx_p" id="S4.SS3.SSS1.p7.2">For a given DE trajectory <math alttext="\hat{p}_{1}(x),\ldots,\hat{p}_{n}(x)" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p7.1.m1.5"><semantics id="S4.SS3.SSS1.p7.1.m1.5a"><mrow id="S4.SS3.SSS1.p7.1.m1.5.5.2" xref="S4.SS3.SSS1.p7.1.m1.5.5.3.cmml"><mrow id="S4.SS3.SSS1.p7.1.m1.4.4.1.1" xref="S4.SS3.SSS1.p7.1.m1.4.4.1.1.cmml"><msub id="S4.SS3.SSS1.p7.1.m1.4.4.1.1.2" xref="S4.SS3.SSS1.p7.1.m1.4.4.1.1.2.cmml"><mover accent="true" id="S4.SS3.SSS1.p7.1.m1.4.4.1.1.2.2" xref="S4.SS3.SSS1.p7.1.m1.4.4.1.1.2.2.cmml"><mi id="S4.SS3.SSS1.p7.1.m1.4.4.1.1.2.2.2" xref="S4.SS3.SSS1.p7.1.m1.4.4.1.1.2.2.2.cmml">p</mi><mo id="S4.SS3.SSS1.p7.1.m1.4.4.1.1.2.2.1" xref="S4.SS3.SSS1.p7.1.m1.4.4.1.1.2.2.1.cmml">^</mo></mover><mn id="S4.SS3.SSS1.p7.1.m1.4.4.1.1.2.3" xref="S4.SS3.SSS1.p7.1.m1.4.4.1.1.2.3.cmml">1</mn></msub><mo id="S4.SS3.SSS1.p7.1.m1.4.4.1.1.1" xref="S4.SS3.SSS1.p7.1.m1.4.4.1.1.1.cmml">⁢</mo><mrow id="S4.SS3.SSS1.p7.1.m1.4.4.1.1.3.2" xref="S4.SS3.SSS1.p7.1.m1.4.4.1.1.cmml"><mo id="S4.SS3.SSS1.p7.1.m1.4.4.1.1.3.2.1" stretchy="false" xref="S4.SS3.SSS1.p7.1.m1.4.4.1.1.cmml">(</mo><mi id="S4.SS3.SSS1.p7.1.m1.1.1" xref="S4.SS3.SSS1.p7.1.m1.1.1.cmml">x</mi><mo id="S4.SS3.SSS1.p7.1.m1.4.4.1.1.3.2.2" stretchy="false" xref="S4.SS3.SSS1.p7.1.m1.4.4.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS3.SSS1.p7.1.m1.5.5.2.3" xref="S4.SS3.SSS1.p7.1.m1.5.5.3.cmml">,</mo><mi id="S4.SS3.SSS1.p7.1.m1.3.3" mathvariant="normal" xref="S4.SS3.SSS1.p7.1.m1.3.3.cmml">…</mi><mo id="S4.SS3.SSS1.p7.1.m1.5.5.2.4" xref="S4.SS3.SSS1.p7.1.m1.5.5.3.cmml">,</mo><mrow id="S4.SS3.SSS1.p7.1.m1.5.5.2.2" xref="S4.SS3.SSS1.p7.1.m1.5.5.2.2.cmml"><msub id="S4.SS3.SSS1.p7.1.m1.5.5.2.2.2" xref="S4.SS3.SSS1.p7.1.m1.5.5.2.2.2.cmml"><mover accent="true" id="S4.SS3.SSS1.p7.1.m1.5.5.2.2.2.2" xref="S4.SS3.SSS1.p7.1.m1.5.5.2.2.2.2.cmml"><mi id="S4.SS3.SSS1.p7.1.m1.5.5.2.2.2.2.2" xref="S4.SS3.SSS1.p7.1.m1.5.5.2.2.2.2.2.cmml">p</mi><mo id="S4.SS3.SSS1.p7.1.m1.5.5.2.2.2.2.1" xref="S4.SS3.SSS1.p7.1.m1.5.5.2.2.2.2.1.cmml">^</mo></mover><mi id="S4.SS3.SSS1.p7.1.m1.5.5.2.2.2.3" xref="S4.SS3.SSS1.p7.1.m1.5.5.2.2.2.3.cmml">n</mi></msub><mo id="S4.SS3.SSS1.p7.1.m1.5.5.2.2.1" xref="S4.SS3.SSS1.p7.1.m1.5.5.2.2.1.cmml">⁢</mo><mrow id="S4.SS3.SSS1.p7.1.m1.5.5.2.2.3.2" xref="S4.SS3.SSS1.p7.1.m1.5.5.2.2.cmml"><mo id="S4.SS3.SSS1.p7.1.m1.5.5.2.2.3.2.1" stretchy="false" xref="S4.SS3.SSS1.p7.1.m1.5.5.2.2.cmml">(</mo><mi id="S4.SS3.SSS1.p7.1.m1.2.2" xref="S4.SS3.SSS1.p7.1.m1.2.2.cmml">x</mi><mo id="S4.SS3.SSS1.p7.1.m1.5.5.2.2.3.2.2" stretchy="false" xref="S4.SS3.SSS1.p7.1.m1.5.5.2.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p7.1.m1.5b"><list id="S4.SS3.SSS1.p7.1.m1.5.5.3.cmml" xref="S4.SS3.SSS1.p7.1.m1.5.5.2"><apply id="S4.SS3.SSS1.p7.1.m1.4.4.1.1.cmml" xref="S4.SS3.SSS1.p7.1.m1.4.4.1.1"><times id="S4.SS3.SSS1.p7.1.m1.4.4.1.1.1.cmml" xref="S4.SS3.SSS1.p7.1.m1.4.4.1.1.1"></times><apply id="S4.SS3.SSS1.p7.1.m1.4.4.1.1.2.cmml" xref="S4.SS3.SSS1.p7.1.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p7.1.m1.4.4.1.1.2.1.cmml" xref="S4.SS3.SSS1.p7.1.m1.4.4.1.1.2">subscript</csymbol><apply id="S4.SS3.SSS1.p7.1.m1.4.4.1.1.2.2.cmml" xref="S4.SS3.SSS1.p7.1.m1.4.4.1.1.2.2"><ci id="S4.SS3.SSS1.p7.1.m1.4.4.1.1.2.2.1.cmml" xref="S4.SS3.SSS1.p7.1.m1.4.4.1.1.2.2.1">^</ci><ci id="S4.SS3.SSS1.p7.1.m1.4.4.1.1.2.2.2.cmml" xref="S4.SS3.SSS1.p7.1.m1.4.4.1.1.2.2.2">𝑝</ci></apply><cn id="S4.SS3.SSS1.p7.1.m1.4.4.1.1.2.3.cmml" type="integer" xref="S4.SS3.SSS1.p7.1.m1.4.4.1.1.2.3">1</cn></apply><ci id="S4.SS3.SSS1.p7.1.m1.1.1.cmml" xref="S4.SS3.SSS1.p7.1.m1.1.1">𝑥</ci></apply><ci id="S4.SS3.SSS1.p7.1.m1.3.3.cmml" xref="S4.SS3.SSS1.p7.1.m1.3.3">…</ci><apply id="S4.SS3.SSS1.p7.1.m1.5.5.2.2.cmml" xref="S4.SS3.SSS1.p7.1.m1.5.5.2.2"><times id="S4.SS3.SSS1.p7.1.m1.5.5.2.2.1.cmml" xref="S4.SS3.SSS1.p7.1.m1.5.5.2.2.1"></times><apply id="S4.SS3.SSS1.p7.1.m1.5.5.2.2.2.cmml" xref="S4.SS3.SSS1.p7.1.m1.5.5.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p7.1.m1.5.5.2.2.2.1.cmml" xref="S4.SS3.SSS1.p7.1.m1.5.5.2.2.2">subscript</csymbol><apply id="S4.SS3.SSS1.p7.1.m1.5.5.2.2.2.2.cmml" xref="S4.SS3.SSS1.p7.1.m1.5.5.2.2.2.2"><ci id="S4.SS3.SSS1.p7.1.m1.5.5.2.2.2.2.1.cmml" xref="S4.SS3.SSS1.p7.1.m1.5.5.2.2.2.2.1">^</ci><ci id="S4.SS3.SSS1.p7.1.m1.5.5.2.2.2.2.2.cmml" xref="S4.SS3.SSS1.p7.1.m1.5.5.2.2.2.2.2">𝑝</ci></apply><ci id="S4.SS3.SSS1.p7.1.m1.5.5.2.2.2.3.cmml" xref="S4.SS3.SSS1.p7.1.m1.5.5.2.2.2.3">𝑛</ci></apply><ci id="S4.SS3.SSS1.p7.1.m1.2.2.cmml" xref="S4.SS3.SSS1.p7.1.m1.2.2">𝑥</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p7.1.m1.5c">\hat{p}_{1}(x),\ldots,\hat{p}_{n}(x)</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p7.1.m1.5d">over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_x ) , … , over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ( italic_x )</annotation></semantics></math>, we optimize our bespoke KDE to minimize the Hellinger distance at each context length <math alttext="i" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p7.2.m2.1"><semantics id="S4.SS3.SSS1.p7.2.m2.1a"><mi id="S4.SS3.SSS1.p7.2.m2.1.1" xref="S4.SS3.SSS1.p7.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p7.2.m2.1b"><ci id="S4.SS3.SSS1.p7.2.m2.1.1.cmml" xref="S4.SS3.SSS1.p7.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p7.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p7.2.m2.1d">italic_i</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\min_{s_{i}\in(0,\infty),h_{i}\in(0,\infty)}D_{\text{Hel}}(\hat{p}_{i}(x)\|%
\hat{p}_{h_{i},s_{i}}(x))" class="ltx_Math" display="block" id="S4.E9.m1.11"><semantics id="S4.E9.m1.11a"><mrow id="S4.E9.m1.11.11" xref="S4.E9.m1.11.11.cmml"><mrow id="S4.E9.m1.11.11.3" xref="S4.E9.m1.11.11.3.cmml"><munder id="S4.E9.m1.11.11.3.1" xref="S4.E9.m1.11.11.3.1.cmml"><mi id="S4.E9.m1.11.11.3.1.2" xref="S4.E9.m1.11.11.3.1.2.cmml">min</mi><mrow id="S4.E9.m1.6.6.6.6" xref="S4.E9.m1.6.6.6.7.cmml"><mrow id="S4.E9.m1.5.5.5.5.1" xref="S4.E9.m1.5.5.5.5.1.cmml"><msub id="S4.E9.m1.5.5.5.5.1.2" xref="S4.E9.m1.5.5.5.5.1.2.cmml"><mi id="S4.E9.m1.5.5.5.5.1.2.2" xref="S4.E9.m1.5.5.5.5.1.2.2.cmml">s</mi><mi id="S4.E9.m1.5.5.5.5.1.2.3" xref="S4.E9.m1.5.5.5.5.1.2.3.cmml">i</mi></msub><mo id="S4.E9.m1.5.5.5.5.1.1" xref="S4.E9.m1.5.5.5.5.1.1.cmml">∈</mo><mrow id="S4.E9.m1.5.5.5.5.1.3.2" xref="S4.E9.m1.5.5.5.5.1.3.1.cmml"><mo id="S4.E9.m1.5.5.5.5.1.3.2.1" stretchy="false" xref="S4.E9.m1.5.5.5.5.1.3.1.cmml">(</mo><mn id="S4.E9.m1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.cmml">0</mn><mo id="S4.E9.m1.5.5.5.5.1.3.2.2" xref="S4.E9.m1.5.5.5.5.1.3.1.cmml">,</mo><mi id="S4.E9.m1.2.2.2.2" mathvariant="normal" xref="S4.E9.m1.2.2.2.2.cmml">∞</mi><mo id="S4.E9.m1.5.5.5.5.1.3.2.3" stretchy="false" xref="S4.E9.m1.5.5.5.5.1.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E9.m1.6.6.6.6.3" xref="S4.E9.m1.6.6.6.7a.cmml">,</mo><mrow id="S4.E9.m1.6.6.6.6.2" xref="S4.E9.m1.6.6.6.6.2.cmml"><msub id="S4.E9.m1.6.6.6.6.2.2" xref="S4.E9.m1.6.6.6.6.2.2.cmml"><mi id="S4.E9.m1.6.6.6.6.2.2.2" xref="S4.E9.m1.6.6.6.6.2.2.2.cmml">h</mi><mi id="S4.E9.m1.6.6.6.6.2.2.3" xref="S4.E9.m1.6.6.6.6.2.2.3.cmml">i</mi></msub><mo id="S4.E9.m1.6.6.6.6.2.1" xref="S4.E9.m1.6.6.6.6.2.1.cmml">∈</mo><mrow id="S4.E9.m1.6.6.6.6.2.3.2" xref="S4.E9.m1.6.6.6.6.2.3.1.cmml"><mo id="S4.E9.m1.6.6.6.6.2.3.2.1" stretchy="false" xref="S4.E9.m1.6.6.6.6.2.3.1.cmml">(</mo><mn id="S4.E9.m1.3.3.3.3" xref="S4.E9.m1.3.3.3.3.cmml">0</mn><mo id="S4.E9.m1.6.6.6.6.2.3.2.2" xref="S4.E9.m1.6.6.6.6.2.3.1.cmml">,</mo><mi id="S4.E9.m1.4.4.4.4" mathvariant="normal" xref="S4.E9.m1.4.4.4.4.cmml">∞</mi><mo id="S4.E9.m1.6.6.6.6.2.3.2.3" stretchy="false" xref="S4.E9.m1.6.6.6.6.2.3.1.cmml">)</mo></mrow></mrow></mrow></munder><mo id="S4.E9.m1.11.11.3a" lspace="0.167em" xref="S4.E9.m1.11.11.3.cmml">⁡</mo><msub id="S4.E9.m1.11.11.3.2" xref="S4.E9.m1.11.11.3.2.cmml"><mi id="S4.E9.m1.11.11.3.2.2" xref="S4.E9.m1.11.11.3.2.2.cmml">D</mi><mtext id="S4.E9.m1.11.11.3.2.3" xref="S4.E9.m1.11.11.3.2.3a.cmml">Hel</mtext></msub></mrow><mo id="S4.E9.m1.11.11.2" xref="S4.E9.m1.11.11.2.cmml">⁢</mo><mrow id="S4.E9.m1.11.11.1.1" xref="S4.E9.m1.11.11.1.1.1.cmml"><mo id="S4.E9.m1.11.11.1.1.2" stretchy="false" xref="S4.E9.m1.11.11.1.1.1.cmml">(</mo><mrow id="S4.E9.m1.11.11.1.1.1" xref="S4.E9.m1.11.11.1.1.1.cmml"><mrow id="S4.E9.m1.11.11.1.1.1.2" xref="S4.E9.m1.11.11.1.1.1.2.cmml"><msub id="S4.E9.m1.11.11.1.1.1.2.2" xref="S4.E9.m1.11.11.1.1.1.2.2.cmml"><mover accent="true" id="S4.E9.m1.11.11.1.1.1.2.2.2" xref="S4.E9.m1.11.11.1.1.1.2.2.2.cmml"><mi id="S4.E9.m1.11.11.1.1.1.2.2.2.2" xref="S4.E9.m1.11.11.1.1.1.2.2.2.2.cmml">p</mi><mo id="S4.E9.m1.11.11.1.1.1.2.2.2.1" xref="S4.E9.m1.11.11.1.1.1.2.2.2.1.cmml">^</mo></mover><mi id="S4.E9.m1.11.11.1.1.1.2.2.3" xref="S4.E9.m1.11.11.1.1.1.2.2.3.cmml">i</mi></msub><mo id="S4.E9.m1.11.11.1.1.1.2.1" xref="S4.E9.m1.11.11.1.1.1.2.1.cmml">⁢</mo><mrow id="S4.E9.m1.11.11.1.1.1.2.3.2" xref="S4.E9.m1.11.11.1.1.1.2.cmml"><mo id="S4.E9.m1.11.11.1.1.1.2.3.2.1" stretchy="false" xref="S4.E9.m1.11.11.1.1.1.2.cmml">(</mo><mi id="S4.E9.m1.9.9" xref="S4.E9.m1.9.9.cmml">x</mi><mo id="S4.E9.m1.11.11.1.1.1.2.3.2.2" stretchy="false" xref="S4.E9.m1.11.11.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E9.m1.11.11.1.1.1.1" xref="S4.E9.m1.11.11.1.1.1.1.cmml">∥</mo><mrow id="S4.E9.m1.11.11.1.1.1.3" xref="S4.E9.m1.11.11.1.1.1.3.cmml"><msub id="S4.E9.m1.11.11.1.1.1.3.2" xref="S4.E9.m1.11.11.1.1.1.3.2.cmml"><mover accent="true" id="S4.E9.m1.11.11.1.1.1.3.2.2" xref="S4.E9.m1.11.11.1.1.1.3.2.2.cmml"><mi id="S4.E9.m1.11.11.1.1.1.3.2.2.2" xref="S4.E9.m1.11.11.1.1.1.3.2.2.2.cmml">p</mi><mo id="S4.E9.m1.11.11.1.1.1.3.2.2.1" xref="S4.E9.m1.11.11.1.1.1.3.2.2.1.cmml">^</mo></mover><mrow id="S4.E9.m1.8.8.2.2" xref="S4.E9.m1.8.8.2.3.cmml"><msub id="S4.E9.m1.7.7.1.1.1" xref="S4.E9.m1.7.7.1.1.1.cmml"><mi id="S4.E9.m1.7.7.1.1.1.2" xref="S4.E9.m1.7.7.1.1.1.2.cmml">h</mi><mi id="S4.E9.m1.7.7.1.1.1.3" xref="S4.E9.m1.7.7.1.1.1.3.cmml">i</mi></msub><mo id="S4.E9.m1.8.8.2.2.3" xref="S4.E9.m1.8.8.2.3.cmml">,</mo><msub id="S4.E9.m1.8.8.2.2.2" xref="S4.E9.m1.8.8.2.2.2.cmml"><mi id="S4.E9.m1.8.8.2.2.2.2" xref="S4.E9.m1.8.8.2.2.2.2.cmml">s</mi><mi id="S4.E9.m1.8.8.2.2.2.3" xref="S4.E9.m1.8.8.2.2.2.3.cmml">i</mi></msub></mrow></msub><mo id="S4.E9.m1.11.11.1.1.1.3.1" xref="S4.E9.m1.11.11.1.1.1.3.1.cmml">⁢</mo><mrow id="S4.E9.m1.11.11.1.1.1.3.3.2" xref="S4.E9.m1.11.11.1.1.1.3.cmml"><mo id="S4.E9.m1.11.11.1.1.1.3.3.2.1" stretchy="false" xref="S4.E9.m1.11.11.1.1.1.3.cmml">(</mo><mi id="S4.E9.m1.10.10" xref="S4.E9.m1.10.10.cmml">x</mi><mo id="S4.E9.m1.11.11.1.1.1.3.3.2.2" stretchy="false" xref="S4.E9.m1.11.11.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E9.m1.11.11.1.1.3" stretchy="false" xref="S4.E9.m1.11.11.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E9.m1.11b"><apply id="S4.E9.m1.11.11.cmml" xref="S4.E9.m1.11.11"><times id="S4.E9.m1.11.11.2.cmml" xref="S4.E9.m1.11.11.2"></times><apply id="S4.E9.m1.11.11.3.cmml" xref="S4.E9.m1.11.11.3"><apply id="S4.E9.m1.11.11.3.1.cmml" xref="S4.E9.m1.11.11.3.1"><csymbol cd="ambiguous" id="S4.E9.m1.11.11.3.1.1.cmml" xref="S4.E9.m1.11.11.3.1">subscript</csymbol><min id="S4.E9.m1.11.11.3.1.2.cmml" xref="S4.E9.m1.11.11.3.1.2"></min><apply id="S4.E9.m1.6.6.6.7.cmml" xref="S4.E9.m1.6.6.6.6"><csymbol cd="ambiguous" id="S4.E9.m1.6.6.6.7a.cmml" xref="S4.E9.m1.6.6.6.6.3">formulae-sequence</csymbol><apply id="S4.E9.m1.5.5.5.5.1.cmml" xref="S4.E9.m1.5.5.5.5.1"><in id="S4.E9.m1.5.5.5.5.1.1.cmml" xref="S4.E9.m1.5.5.5.5.1.1"></in><apply id="S4.E9.m1.5.5.5.5.1.2.cmml" xref="S4.E9.m1.5.5.5.5.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.5.5.5.5.1.2.1.cmml" xref="S4.E9.m1.5.5.5.5.1.2">subscript</csymbol><ci id="S4.E9.m1.5.5.5.5.1.2.2.cmml" xref="S4.E9.m1.5.5.5.5.1.2.2">𝑠</ci><ci id="S4.E9.m1.5.5.5.5.1.2.3.cmml" xref="S4.E9.m1.5.5.5.5.1.2.3">𝑖</ci></apply><interval closure="open" id="S4.E9.m1.5.5.5.5.1.3.1.cmml" xref="S4.E9.m1.5.5.5.5.1.3.2"><cn id="S4.E9.m1.1.1.1.1.cmml" type="integer" xref="S4.E9.m1.1.1.1.1">0</cn><infinity id="S4.E9.m1.2.2.2.2.cmml" xref="S4.E9.m1.2.2.2.2"></infinity></interval></apply><apply id="S4.E9.m1.6.6.6.6.2.cmml" xref="S4.E9.m1.6.6.6.6.2"><in id="S4.E9.m1.6.6.6.6.2.1.cmml" xref="S4.E9.m1.6.6.6.6.2.1"></in><apply id="S4.E9.m1.6.6.6.6.2.2.cmml" xref="S4.E9.m1.6.6.6.6.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.6.6.6.6.2.2.1.cmml" xref="S4.E9.m1.6.6.6.6.2.2">subscript</csymbol><ci id="S4.E9.m1.6.6.6.6.2.2.2.cmml" xref="S4.E9.m1.6.6.6.6.2.2.2">ℎ</ci><ci id="S4.E9.m1.6.6.6.6.2.2.3.cmml" xref="S4.E9.m1.6.6.6.6.2.2.3">𝑖</ci></apply><interval closure="open" id="S4.E9.m1.6.6.6.6.2.3.1.cmml" xref="S4.E9.m1.6.6.6.6.2.3.2"><cn id="S4.E9.m1.3.3.3.3.cmml" type="integer" xref="S4.E9.m1.3.3.3.3">0</cn><infinity id="S4.E9.m1.4.4.4.4.cmml" xref="S4.E9.m1.4.4.4.4"></infinity></interval></apply></apply></apply><apply id="S4.E9.m1.11.11.3.2.cmml" xref="S4.E9.m1.11.11.3.2"><csymbol cd="ambiguous" id="S4.E9.m1.11.11.3.2.1.cmml" xref="S4.E9.m1.11.11.3.2">subscript</csymbol><ci id="S4.E9.m1.11.11.3.2.2.cmml" xref="S4.E9.m1.11.11.3.2.2">𝐷</ci><ci id="S4.E9.m1.11.11.3.2.3a.cmml" xref="S4.E9.m1.11.11.3.2.3"><mtext id="S4.E9.m1.11.11.3.2.3.cmml" mathsize="70%" xref="S4.E9.m1.11.11.3.2.3">Hel</mtext></ci></apply></apply><apply id="S4.E9.m1.11.11.1.1.1.cmml" xref="S4.E9.m1.11.11.1.1"><csymbol cd="latexml" id="S4.E9.m1.11.11.1.1.1.1.cmml" xref="S4.E9.m1.11.11.1.1.1.1">conditional</csymbol><apply id="S4.E9.m1.11.11.1.1.1.2.cmml" xref="S4.E9.m1.11.11.1.1.1.2"><times id="S4.E9.m1.11.11.1.1.1.2.1.cmml" xref="S4.E9.m1.11.11.1.1.1.2.1"></times><apply id="S4.E9.m1.11.11.1.1.1.2.2.cmml" xref="S4.E9.m1.11.11.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.11.11.1.1.1.2.2.1.cmml" xref="S4.E9.m1.11.11.1.1.1.2.2">subscript</csymbol><apply id="S4.E9.m1.11.11.1.1.1.2.2.2.cmml" xref="S4.E9.m1.11.11.1.1.1.2.2.2"><ci id="S4.E9.m1.11.11.1.1.1.2.2.2.1.cmml" xref="S4.E9.m1.11.11.1.1.1.2.2.2.1">^</ci><ci id="S4.E9.m1.11.11.1.1.1.2.2.2.2.cmml" xref="S4.E9.m1.11.11.1.1.1.2.2.2.2">𝑝</ci></apply><ci id="S4.E9.m1.11.11.1.1.1.2.2.3.cmml" xref="S4.E9.m1.11.11.1.1.1.2.2.3">𝑖</ci></apply><ci id="S4.E9.m1.9.9.cmml" xref="S4.E9.m1.9.9">𝑥</ci></apply><apply id="S4.E9.m1.11.11.1.1.1.3.cmml" xref="S4.E9.m1.11.11.1.1.1.3"><times id="S4.E9.m1.11.11.1.1.1.3.1.cmml" xref="S4.E9.m1.11.11.1.1.1.3.1"></times><apply id="S4.E9.m1.11.11.1.1.1.3.2.cmml" xref="S4.E9.m1.11.11.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E9.m1.11.11.1.1.1.3.2.1.cmml" xref="S4.E9.m1.11.11.1.1.1.3.2">subscript</csymbol><apply id="S4.E9.m1.11.11.1.1.1.3.2.2.cmml" xref="S4.E9.m1.11.11.1.1.1.3.2.2"><ci id="S4.E9.m1.11.11.1.1.1.3.2.2.1.cmml" xref="S4.E9.m1.11.11.1.1.1.3.2.2.1">^</ci><ci id="S4.E9.m1.11.11.1.1.1.3.2.2.2.cmml" xref="S4.E9.m1.11.11.1.1.1.3.2.2.2">𝑝</ci></apply><list id="S4.E9.m1.8.8.2.3.cmml" xref="S4.E9.m1.8.8.2.2"><apply id="S4.E9.m1.7.7.1.1.1.cmml" xref="S4.E9.m1.7.7.1.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.7.7.1.1.1.1.cmml" xref="S4.E9.m1.7.7.1.1.1">subscript</csymbol><ci id="S4.E9.m1.7.7.1.1.1.2.cmml" xref="S4.E9.m1.7.7.1.1.1.2">ℎ</ci><ci id="S4.E9.m1.7.7.1.1.1.3.cmml" xref="S4.E9.m1.7.7.1.1.1.3">𝑖</ci></apply><apply id="S4.E9.m1.8.8.2.2.2.cmml" xref="S4.E9.m1.8.8.2.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.8.8.2.2.2.1.cmml" xref="S4.E9.m1.8.8.2.2.2">subscript</csymbol><ci id="S4.E9.m1.8.8.2.2.2.2.cmml" xref="S4.E9.m1.8.8.2.2.2.2">𝑠</ci><ci id="S4.E9.m1.8.8.2.2.2.3.cmml" xref="S4.E9.m1.8.8.2.2.2.3">𝑖</ci></apply></list></apply><ci id="S4.E9.m1.10.10.cmml" xref="S4.E9.m1.10.10">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m1.11c">\min_{s_{i}\in(0,\infty),h_{i}\in(0,\infty)}D_{\text{Hel}}(\hat{p}_{i}(x)\|%
\hat{p}_{h_{i},s_{i}}(x))</annotation><annotation encoding="application/x-llamapun" id="S4.E9.m1.11d">roman_min start_POSTSUBSCRIPT italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ ( 0 , ∞ ) , italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ ( 0 , ∞ ) end_POSTSUBSCRIPT italic_D start_POSTSUBSCRIPT Hel end_POSTSUBSCRIPT ( over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_x ) ∥ over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_x ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS3.SSS1.p7.5">yielding the "bespoke KDE" bandwidth schedule <math alttext="\{h_{i}\}_{i=1}^{n}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p7.3.m1.1"><semantics id="S4.SS3.SSS1.p7.3.m1.1a"><msubsup id="S4.SS3.SSS1.p7.3.m1.1.1" xref="S4.SS3.SSS1.p7.3.m1.1.1.cmml"><mrow id="S4.SS3.SSS1.p7.3.m1.1.1.1.1.1" xref="S4.SS3.SSS1.p7.3.m1.1.1.1.1.2.cmml"><mo id="S4.SS3.SSS1.p7.3.m1.1.1.1.1.1.2" stretchy="false" xref="S4.SS3.SSS1.p7.3.m1.1.1.1.1.2.cmml">{</mo><msub id="S4.SS3.SSS1.p7.3.m1.1.1.1.1.1.1" xref="S4.SS3.SSS1.p7.3.m1.1.1.1.1.1.1.cmml"><mi id="S4.SS3.SSS1.p7.3.m1.1.1.1.1.1.1.2" xref="S4.SS3.SSS1.p7.3.m1.1.1.1.1.1.1.2.cmml">h</mi><mi id="S4.SS3.SSS1.p7.3.m1.1.1.1.1.1.1.3" xref="S4.SS3.SSS1.p7.3.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS3.SSS1.p7.3.m1.1.1.1.1.1.3" stretchy="false" xref="S4.SS3.SSS1.p7.3.m1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS3.SSS1.p7.3.m1.1.1.1.3" xref="S4.SS3.SSS1.p7.3.m1.1.1.1.3.cmml"><mi id="S4.SS3.SSS1.p7.3.m1.1.1.1.3.2" xref="S4.SS3.SSS1.p7.3.m1.1.1.1.3.2.cmml">i</mi><mo id="S4.SS3.SSS1.p7.3.m1.1.1.1.3.1" xref="S4.SS3.SSS1.p7.3.m1.1.1.1.3.1.cmml">=</mo><mn id="S4.SS3.SSS1.p7.3.m1.1.1.1.3.3" xref="S4.SS3.SSS1.p7.3.m1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S4.SS3.SSS1.p7.3.m1.1.1.3" xref="S4.SS3.SSS1.p7.3.m1.1.1.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p7.3.m1.1b"><apply id="S4.SS3.SSS1.p7.3.m1.1.1.cmml" xref="S4.SS3.SSS1.p7.3.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p7.3.m1.1.1.2.cmml" xref="S4.SS3.SSS1.p7.3.m1.1.1">superscript</csymbol><apply id="S4.SS3.SSS1.p7.3.m1.1.1.1.cmml" xref="S4.SS3.SSS1.p7.3.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p7.3.m1.1.1.1.2.cmml" xref="S4.SS3.SSS1.p7.3.m1.1.1">subscript</csymbol><set id="S4.SS3.SSS1.p7.3.m1.1.1.1.1.2.cmml" xref="S4.SS3.SSS1.p7.3.m1.1.1.1.1.1"><apply id="S4.SS3.SSS1.p7.3.m1.1.1.1.1.1.1.cmml" xref="S4.SS3.SSS1.p7.3.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p7.3.m1.1.1.1.1.1.1.1.cmml" xref="S4.SS3.SSS1.p7.3.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS3.SSS1.p7.3.m1.1.1.1.1.1.1.2.cmml" xref="S4.SS3.SSS1.p7.3.m1.1.1.1.1.1.1.2">ℎ</ci><ci id="S4.SS3.SSS1.p7.3.m1.1.1.1.1.1.1.3.cmml" xref="S4.SS3.SSS1.p7.3.m1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S4.SS3.SSS1.p7.3.m1.1.1.1.3.cmml" xref="S4.SS3.SSS1.p7.3.m1.1.1.1.3"><eq id="S4.SS3.SSS1.p7.3.m1.1.1.1.3.1.cmml" xref="S4.SS3.SSS1.p7.3.m1.1.1.1.3.1"></eq><ci id="S4.SS3.SSS1.p7.3.m1.1.1.1.3.2.cmml" xref="S4.SS3.SSS1.p7.3.m1.1.1.1.3.2">𝑖</ci><cn id="S4.SS3.SSS1.p7.3.m1.1.1.1.3.3.cmml" type="integer" xref="S4.SS3.SSS1.p7.3.m1.1.1.1.3.3">1</cn></apply></apply><ci id="S4.SS3.SSS1.p7.3.m1.1.1.3.cmml" xref="S4.SS3.SSS1.p7.3.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p7.3.m1.1c">\{h_{i}\}_{i=1}^{n}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p7.3.m1.1d">{ italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT</annotation></semantics></math> and shape schedule <math alttext="\{s_{i}\}_{i=1}^{n}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p7.4.m2.1"><semantics id="S4.SS3.SSS1.p7.4.m2.1a"><msubsup id="S4.SS3.SSS1.p7.4.m2.1.1" xref="S4.SS3.SSS1.p7.4.m2.1.1.cmml"><mrow id="S4.SS3.SSS1.p7.4.m2.1.1.1.1.1" xref="S4.SS3.SSS1.p7.4.m2.1.1.1.1.2.cmml"><mo id="S4.SS3.SSS1.p7.4.m2.1.1.1.1.1.2" stretchy="false" xref="S4.SS3.SSS1.p7.4.m2.1.1.1.1.2.cmml">{</mo><msub id="S4.SS3.SSS1.p7.4.m2.1.1.1.1.1.1" xref="S4.SS3.SSS1.p7.4.m2.1.1.1.1.1.1.cmml"><mi id="S4.SS3.SSS1.p7.4.m2.1.1.1.1.1.1.2" xref="S4.SS3.SSS1.p7.4.m2.1.1.1.1.1.1.2.cmml">s</mi><mi id="S4.SS3.SSS1.p7.4.m2.1.1.1.1.1.1.3" xref="S4.SS3.SSS1.p7.4.m2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS3.SSS1.p7.4.m2.1.1.1.1.1.3" stretchy="false" xref="S4.SS3.SSS1.p7.4.m2.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS3.SSS1.p7.4.m2.1.1.1.3" xref="S4.SS3.SSS1.p7.4.m2.1.1.1.3.cmml"><mi id="S4.SS3.SSS1.p7.4.m2.1.1.1.3.2" xref="S4.SS3.SSS1.p7.4.m2.1.1.1.3.2.cmml">i</mi><mo id="S4.SS3.SSS1.p7.4.m2.1.1.1.3.1" xref="S4.SS3.SSS1.p7.4.m2.1.1.1.3.1.cmml">=</mo><mn id="S4.SS3.SSS1.p7.4.m2.1.1.1.3.3" xref="S4.SS3.SSS1.p7.4.m2.1.1.1.3.3.cmml">1</mn></mrow><mi id="S4.SS3.SSS1.p7.4.m2.1.1.3" xref="S4.SS3.SSS1.p7.4.m2.1.1.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p7.4.m2.1b"><apply id="S4.SS3.SSS1.p7.4.m2.1.1.cmml" xref="S4.SS3.SSS1.p7.4.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p7.4.m2.1.1.2.cmml" xref="S4.SS3.SSS1.p7.4.m2.1.1">superscript</csymbol><apply id="S4.SS3.SSS1.p7.4.m2.1.1.1.cmml" xref="S4.SS3.SSS1.p7.4.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p7.4.m2.1.1.1.2.cmml" xref="S4.SS3.SSS1.p7.4.m2.1.1">subscript</csymbol><set id="S4.SS3.SSS1.p7.4.m2.1.1.1.1.2.cmml" xref="S4.SS3.SSS1.p7.4.m2.1.1.1.1.1"><apply id="S4.SS3.SSS1.p7.4.m2.1.1.1.1.1.1.cmml" xref="S4.SS3.SSS1.p7.4.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p7.4.m2.1.1.1.1.1.1.1.cmml" xref="S4.SS3.SSS1.p7.4.m2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS3.SSS1.p7.4.m2.1.1.1.1.1.1.2.cmml" xref="S4.SS3.SSS1.p7.4.m2.1.1.1.1.1.1.2">𝑠</ci><ci id="S4.SS3.SSS1.p7.4.m2.1.1.1.1.1.1.3.cmml" xref="S4.SS3.SSS1.p7.4.m2.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S4.SS3.SSS1.p7.4.m2.1.1.1.3.cmml" xref="S4.SS3.SSS1.p7.4.m2.1.1.1.3"><eq id="S4.SS3.SSS1.p7.4.m2.1.1.1.3.1.cmml" xref="S4.SS3.SSS1.p7.4.m2.1.1.1.3.1"></eq><ci id="S4.SS3.SSS1.p7.4.m2.1.1.1.3.2.cmml" xref="S4.SS3.SSS1.p7.4.m2.1.1.1.3.2">𝑖</ci><cn id="S4.SS3.SSS1.p7.4.m2.1.1.1.3.3.cmml" type="integer" xref="S4.SS3.SSS1.p7.4.m2.1.1.1.3.3">1</cn></apply></apply><ci id="S4.SS3.SSS1.p7.4.m2.1.1.3.cmml" xref="S4.SS3.SSS1.p7.4.m2.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p7.4.m2.1c">\{s_{i}\}_{i=1}^{n}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p7.4.m2.1d">{ italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT</annotation></semantics></math>, which together prescribe a sequence of fitted kernels of changing widths and shapes.
We visualize such sequences of fitted kernels, and compare them against the Gaussian kernel with standard <math alttext="n^{-1/5}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p7.5.m3.1"><semantics id="S4.SS3.SSS1.p7.5.m3.1a"><msup id="S4.SS3.SSS1.p7.5.m3.1.1" xref="S4.SS3.SSS1.p7.5.m3.1.1.cmml"><mi id="S4.SS3.SSS1.p7.5.m3.1.1.2" xref="S4.SS3.SSS1.p7.5.m3.1.1.2.cmml">n</mi><mrow id="S4.SS3.SSS1.p7.5.m3.1.1.3" xref="S4.SS3.SSS1.p7.5.m3.1.1.3.cmml"><mo id="S4.SS3.SSS1.p7.5.m3.1.1.3a" xref="S4.SS3.SSS1.p7.5.m3.1.1.3.cmml">−</mo><mrow id="S4.SS3.SSS1.p7.5.m3.1.1.3.2" xref="S4.SS3.SSS1.p7.5.m3.1.1.3.2.cmml"><mn id="S4.SS3.SSS1.p7.5.m3.1.1.3.2.2" xref="S4.SS3.SSS1.p7.5.m3.1.1.3.2.2.cmml">1</mn><mo id="S4.SS3.SSS1.p7.5.m3.1.1.3.2.1" xref="S4.SS3.SSS1.p7.5.m3.1.1.3.2.1.cmml">/</mo><mn id="S4.SS3.SSS1.p7.5.m3.1.1.3.2.3" xref="S4.SS3.SSS1.p7.5.m3.1.1.3.2.3.cmml">5</mn></mrow></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p7.5.m3.1b"><apply id="S4.SS3.SSS1.p7.5.m3.1.1.cmml" xref="S4.SS3.SSS1.p7.5.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p7.5.m3.1.1.1.cmml" xref="S4.SS3.SSS1.p7.5.m3.1.1">superscript</csymbol><ci id="S4.SS3.SSS1.p7.5.m3.1.1.2.cmml" xref="S4.SS3.SSS1.p7.5.m3.1.1.2">𝑛</ci><apply id="S4.SS3.SSS1.p7.5.m3.1.1.3.cmml" xref="S4.SS3.SSS1.p7.5.m3.1.1.3"><minus id="S4.SS3.SSS1.p7.5.m3.1.1.3.1.cmml" xref="S4.SS3.SSS1.p7.5.m3.1.1.3"></minus><apply id="S4.SS3.SSS1.p7.5.m3.1.1.3.2.cmml" xref="S4.SS3.SSS1.p7.5.m3.1.1.3.2"><divide id="S4.SS3.SSS1.p7.5.m3.1.1.3.2.1.cmml" xref="S4.SS3.SSS1.p7.5.m3.1.1.3.2.1"></divide><cn id="S4.SS3.SSS1.p7.5.m3.1.1.3.2.2.cmml" type="integer" xref="S4.SS3.SSS1.p7.5.m3.1.1.3.2.2">1</cn><cn id="S4.SS3.SSS1.p7.5.m3.1.1.3.2.3.cmml" type="integer" xref="S4.SS3.SSS1.p7.5.m3.1.1.3.2.3">5</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p7.5.m3.1c">n^{-1/5}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p7.5.m3.1d">italic_n start_POSTSUPERSCRIPT - 1 / 5 end_POSTSUPERSCRIPT</annotation></semantics></math> width schedule in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.SS6" title="A.6 Adaptive Kernel Visualization: Comparing LLaMA-2 with KDE ‣ Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">A.6</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.SS7" title="A.7 Randomly generated PDFs ‣ Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">A.7</span></a>.
We implement this optimization numerically using SciPy, and estimate parameter uncertainties from the inverse Hessian of the loss function (Hellinger distance) at the optimum.
This provides error bars for our fitted kernel shape and bandwidth parameters (Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#S4.F7" title="Figure 7 ‣ 4.3.2 Bespoke KDE Analysis ‣ 4.3 The Kernel Interpretation of In-Context Density Estimation ‣ 4 Experiments and analysis ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">7</span></a>).</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.2 </span>Bespoke KDE Analysis</h4>
<figure class="ltx_figure" id="S4.F7">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F7.5" style="width:260.2pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="302" id="S4.F7.1.g1" src="extracted/5899401/figures/fitted_kernel_13b_gaussian_0.1_hel_dist_False.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Optimized kernel shape (<math alttext="s" class="ltx_Math" display="inline" id="S4.F7.4.3.m1.1"><semantics id="S4.F7.4.3.m1.1b"><mi id="S4.F7.4.3.m1.1.1" xref="S4.F7.4.3.m1.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S4.F7.4.3.m1.1c"><ci id="S4.F7.4.3.m1.1.1.cmml" xref="S4.F7.4.3.m1.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F7.4.3.m1.1d">s</annotation><annotation encoding="application/x-llamapun" id="S4.F7.4.3.m1.1e">italic_s</annotation></semantics></math>) and bandwidth (<math alttext="h" class="ltx_Math" display="inline" id="S4.F7.5.4.m2.1"><semantics id="S4.F7.5.4.m2.1b"><mi id="S4.F7.5.4.m2.1.1" xref="S4.F7.5.4.m2.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S4.F7.5.4.m2.1c"><ci id="S4.F7.5.4.m2.1.1.cmml" xref="S4.F7.5.4.m2.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F7.5.4.m2.1d">h</annotation><annotation encoding="application/x-llamapun" id="S4.F7.5.4.m2.1e">italic_h</annotation></semantics></math>) schedules for the bespoke KDE model, fitted to LLaMA-2 13b’s DE trajectory on a narrow Gaussian target.</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F7.10" style="width:160.4pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="430" id="S4.F7.6.g1" src="extracted/5899401/figures/fitted_kernel_13b_gaussian_0.1_Hellinger_2D_94.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Bespoke KDE trajectories (<math alttext="\circ" class="ltx_Math" display="inline" id="S4.F7.9.3.m1.1"><semantics id="S4.F7.9.3.m1.1b"><mo id="S4.F7.9.3.m1.1.1" xref="S4.F7.9.3.m1.1.1.cmml">∘</mo><annotation-xml encoding="MathML-Content" id="S4.F7.9.3.m1.1c"><compose id="S4.F7.9.3.m1.1.1.cmml" xref="S4.F7.9.3.m1.1.1"></compose></annotation-xml><annotation encoding="application/x-tex" id="S4.F7.9.3.m1.1d">\circ</annotation><annotation encoding="application/x-llamapun" id="S4.F7.9.3.m1.1e">∘</annotation></semantics></math>) fitted to LLaMA-2 13b’s DE trajectory (<math alttext="\triangle" class="ltx_Math" display="inline" id="S4.F7.10.4.m2.1"><semantics id="S4.F7.10.4.m2.1b"><mi id="S4.F7.10.4.m2.1.1" mathvariant="normal" xref="S4.F7.10.4.m2.1.1.cmml">△</mi><annotation-xml encoding="MathML-Content" id="S4.F7.10.4.m2.1c"><ci id="S4.F7.10.4.m2.1.1.cmml" xref="S4.F7.10.4.m2.1.1">△</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F7.10.4.m2.1d">\triangle</annotation><annotation encoding="application/x-llamapun" id="S4.F7.10.4.m2.1e">△</annotation></semantics></math>) on a narrow Gaussian target.</figcaption>
</figure>
</div>
</div>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS3.SSS2.p1">
<p class="ltx_p" id="S4.SS3.SSS2.p1.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#S4.F7" title="Figure 7 ‣ 4.3.2 Bespoke KDE Analysis ‣ 4.3 The Kernel Interpretation of In-Context Density Estimation ‣ 4 Experiments and analysis ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">7</span></a> presents the optimized kernel shape and bandwidth schedules for our bespoke KDE model, fitted to LLaMA-2 13b’s in-context DE trajectory for the narrow Gaussian target (Section <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#S4.SS1" title="4.1 Gaussian target ‣ 4 Experiments and analysis ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">4.1</span></a>).
Two key observations emerge:</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.SSS2.p2">
<p class="ltx_p" id="S4.SS3.SSS2.p2.1">1. The fitted kernel width decays significantly faster than the standard KDE bandwidth schedule (<math alttext="n^{-\frac{1}{5}}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p2.1.m1.1"><semantics id="S4.SS3.SSS2.p2.1.m1.1a"><msup id="S4.SS3.SSS2.p2.1.m1.1.1" xref="S4.SS3.SSS2.p2.1.m1.1.1.cmml"><mi id="S4.SS3.SSS2.p2.1.m1.1.1.2" xref="S4.SS3.SSS2.p2.1.m1.1.1.2.cmml">n</mi><mrow id="S4.SS3.SSS2.p2.1.m1.1.1.3" xref="S4.SS3.SSS2.p2.1.m1.1.1.3.cmml"><mo id="S4.SS3.SSS2.p2.1.m1.1.1.3a" xref="S4.SS3.SSS2.p2.1.m1.1.1.3.cmml">−</mo><mfrac id="S4.SS3.SSS2.p2.1.m1.1.1.3.2" xref="S4.SS3.SSS2.p2.1.m1.1.1.3.2.cmml"><mn id="S4.SS3.SSS2.p2.1.m1.1.1.3.2.2" xref="S4.SS3.SSS2.p2.1.m1.1.1.3.2.2.cmml">1</mn><mn id="S4.SS3.SSS2.p2.1.m1.1.1.3.2.3" xref="S4.SS3.SSS2.p2.1.m1.1.1.3.2.3.cmml">5</mn></mfrac></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p2.1.m1.1b"><apply id="S4.SS3.SSS2.p2.1.m1.1.1.cmml" xref="S4.SS3.SSS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p2.1.m1.1.1.1.cmml" xref="S4.SS3.SSS2.p2.1.m1.1.1">superscript</csymbol><ci id="S4.SS3.SSS2.p2.1.m1.1.1.2.cmml" xref="S4.SS3.SSS2.p2.1.m1.1.1.2">𝑛</ci><apply id="S4.SS3.SSS2.p2.1.m1.1.1.3.cmml" xref="S4.SS3.SSS2.p2.1.m1.1.1.3"><minus id="S4.SS3.SSS2.p2.1.m1.1.1.3.1.cmml" xref="S4.SS3.SSS2.p2.1.m1.1.1.3"></minus><apply id="S4.SS3.SSS2.p2.1.m1.1.1.3.2.cmml" xref="S4.SS3.SSS2.p2.1.m1.1.1.3.2"><divide id="S4.SS3.SSS2.p2.1.m1.1.1.3.2.1.cmml" xref="S4.SS3.SSS2.p2.1.m1.1.1.3.2"></divide><cn id="S4.SS3.SSS2.p2.1.m1.1.1.3.2.2.cmml" type="integer" xref="S4.SS3.SSS2.p2.1.m1.1.1.3.2.2">1</cn><cn id="S4.SS3.SSS2.p2.1.m1.1.1.3.2.3.cmml" type="integer" xref="S4.SS3.SSS2.p2.1.m1.1.1.3.2.3">5</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p2.1.m1.1c">n^{-\frac{1}{5}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p2.1.m1.1d">italic_n start_POSTSUPERSCRIPT - divide start_ARG 1 end_ARG start_ARG 5 end_ARG end_POSTSUPERSCRIPT</annotation></semantics></math>).
This rapid decay explains the much longer trajectory of LLaMA’s in-context DE within the inPCA embedding, as compared to standard Gaussian KDE (Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#S4.F3" title="Figure 3 ‣ 4.1 Gaussian target ‣ 4 Experiments and analysis ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">3</span></a>).</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.SSS2.p3">
<p class="ltx_p" id="S4.SS3.SSS2.p3.5">2. Unlike fixed-shape KDE methods (e.g., Gaussian KDE with <math alttext="s=2" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p3.1.m1.1"><semantics id="S4.SS3.SSS2.p3.1.m1.1a"><mrow id="S4.SS3.SSS2.p3.1.m1.1.1" xref="S4.SS3.SSS2.p3.1.m1.1.1.cmml"><mi id="S4.SS3.SSS2.p3.1.m1.1.1.2" xref="S4.SS3.SSS2.p3.1.m1.1.1.2.cmml">s</mi><mo id="S4.SS3.SSS2.p3.1.m1.1.1.1" xref="S4.SS3.SSS2.p3.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS3.SSS2.p3.1.m1.1.1.3" xref="S4.SS3.SSS2.p3.1.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p3.1.m1.1b"><apply id="S4.SS3.SSS2.p3.1.m1.1.1.cmml" xref="S4.SS3.SSS2.p3.1.m1.1.1"><eq id="S4.SS3.SSS2.p3.1.m1.1.1.1.cmml" xref="S4.SS3.SSS2.p3.1.m1.1.1.1"></eq><ci id="S4.SS3.SSS2.p3.1.m1.1.1.2.cmml" xref="S4.SS3.SSS2.p3.1.m1.1.1.2">𝑠</ci><cn id="S4.SS3.SSS2.p3.1.m1.1.1.3.cmml" type="integer" xref="S4.SS3.SSS2.p3.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p3.1.m1.1c">s=2</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p3.1.m1.1d">italic_s = 2</annotation></semantics></math>), LLaMA seems to implicitly employ an adaptive kernel.
The shape parameter <math alttext="s" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p3.2.m2.1"><semantics id="S4.SS3.SSS2.p3.2.m2.1a"><mi id="S4.SS3.SSS2.p3.2.m2.1.1" xref="S4.SS3.SSS2.p3.2.m2.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p3.2.m2.1b"><ci id="S4.SS3.SSS2.p3.2.m2.1.1.cmml" xref="S4.SS3.SSS2.p3.2.m2.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p3.2.m2.1c">s</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p3.2.m2.1d">italic_s</annotation></semantics></math> evolves from <math alttext="\sim 0.1" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p3.3.m3.1"><semantics id="S4.SS3.SSS2.p3.3.m3.1a"><mrow id="S4.SS3.SSS2.p3.3.m3.1.1" xref="S4.SS3.SSS2.p3.3.m3.1.1.cmml"><mi id="S4.SS3.SSS2.p3.3.m3.1.1.2" xref="S4.SS3.SSS2.p3.3.m3.1.1.2.cmml"></mi><mo id="S4.SS3.SSS2.p3.3.m3.1.1.1" xref="S4.SS3.SSS2.p3.3.m3.1.1.1.cmml">∼</mo><mn id="S4.SS3.SSS2.p3.3.m3.1.1.3" xref="S4.SS3.SSS2.p3.3.m3.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p3.3.m3.1b"><apply id="S4.SS3.SSS2.p3.3.m3.1.1.cmml" xref="S4.SS3.SSS2.p3.3.m3.1.1"><csymbol cd="latexml" id="S4.SS3.SSS2.p3.3.m3.1.1.1.cmml" xref="S4.SS3.SSS2.p3.3.m3.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="S4.SS3.SSS2.p3.3.m3.1.1.2.cmml" xref="S4.SS3.SSS2.p3.3.m3.1.1.2">absent</csymbol><cn id="S4.SS3.SSS2.p3.3.m3.1.1.3.cmml" type="float" xref="S4.SS3.SSS2.p3.3.m3.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p3.3.m3.1c">\sim 0.1</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p3.3.m3.1d">∼ 0.1</annotation></semantics></math> to <math alttext="\sim 1" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p3.4.m4.1"><semantics id="S4.SS3.SSS2.p3.4.m4.1a"><mrow id="S4.SS3.SSS2.p3.4.m4.1.1" xref="S4.SS3.SSS2.p3.4.m4.1.1.cmml"><mi id="S4.SS3.SSS2.p3.4.m4.1.1.2" xref="S4.SS3.SSS2.p3.4.m4.1.1.2.cmml"></mi><mo id="S4.SS3.SSS2.p3.4.m4.1.1.1" xref="S4.SS3.SSS2.p3.4.m4.1.1.1.cmml">∼</mo><mn id="S4.SS3.SSS2.p3.4.m4.1.1.3" xref="S4.SS3.SSS2.p3.4.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p3.4.m4.1b"><apply id="S4.SS3.SSS2.p3.4.m4.1.1.cmml" xref="S4.SS3.SSS2.p3.4.m4.1.1"><csymbol cd="latexml" id="S4.SS3.SSS2.p3.4.m4.1.1.1.cmml" xref="S4.SS3.SSS2.p3.4.m4.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="S4.SS3.SSS2.p3.4.m4.1.1.2.cmml" xref="S4.SS3.SSS2.p3.4.m4.1.1.2">absent</csymbol><cn id="S4.SS3.SSS2.p3.4.m4.1.1.3.cmml" type="integer" xref="S4.SS3.SSS2.p3.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p3.4.m4.1c">\sim 1</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p3.4.m4.1d">∼ 1</annotation></semantics></math>, with increasing uncertainty for <math alttext="n\gtrsim 20" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p3.5.m5.1"><semantics id="S4.SS3.SSS2.p3.5.m5.1a"><mrow id="S4.SS3.SSS2.p3.5.m5.1.1" xref="S4.SS3.SSS2.p3.5.m5.1.1.cmml"><mi id="S4.SS3.SSS2.p3.5.m5.1.1.2" xref="S4.SS3.SSS2.p3.5.m5.1.1.2.cmml">n</mi><mo id="S4.SS3.SSS2.p3.5.m5.1.1.1" xref="S4.SS3.SSS2.p3.5.m5.1.1.1.cmml">≳</mo><mn id="S4.SS3.SSS2.p3.5.m5.1.1.3" xref="S4.SS3.SSS2.p3.5.m5.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p3.5.m5.1b"><apply id="S4.SS3.SSS2.p3.5.m5.1.1.cmml" xref="S4.SS3.SSS2.p3.5.m5.1.1"><csymbol cd="latexml" id="S4.SS3.SSS2.p3.5.m5.1.1.1.cmml" xref="S4.SS3.SSS2.p3.5.m5.1.1.1">greater-than-or-equivalent-to</csymbol><ci id="S4.SS3.SSS2.p3.5.m5.1.1.2.cmml" xref="S4.SS3.SSS2.p3.5.m5.1.1.2">𝑛</ci><cn id="S4.SS3.SSS2.p3.5.m5.1.1.3.cmml" type="integer" xref="S4.SS3.SSS2.p3.5.m5.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p3.5.m5.1c">n\gtrsim 20</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p3.5.m5.1d">italic_n ≳ 20</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.SSS2.p4">
<p class="ltx_p" id="S4.SS3.SSS2.p4.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#S4.F7" title="Figure 7 ‣ 4.3.2 Bespoke KDE Analysis ‣ 4.3 The Kernel Interpretation of In-Context Density Estimation ‣ 4 Experiments and analysis ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">7</span></a> compares LLaMA-2 13b’s in-context DE trajectory with its bespoke KDE counterpart,
demonstrating the close fit achieved by our model.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.SSS2.p5">
<p class="ltx_p" id="S4.SS3.SSS2.p5.1"><span class="ltx_text ltx_font_bold" id="S4.SS3.SSS2.p5.1.1">Significance of Bespoke KDE</span>
The existence of a bespoke KDE that closely imitates LLaMA’s in-context DE processs is significant and non-trivial.
Not all DE processes can be faithfully represented by KDE methods;
for instance, the Bayesian histogram, despite its superficial similarity to a fixed-width tophat kernel KDE,
resists accurate modeling as a bespoke KDE process (Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.SS3" title="A.3 Bespoke KDE cannot imitate all DE processes ‣ Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">A.3</span></a>).</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.SSS2.p6">
<p class="ltx_p" id="S4.SS3.SSS2.p6.1">While our initial experiments focused on regular distributions like Gaussian and uniform, for better generality we extended our experiments to randomly generated PDFs (Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.SS7" title="A.7 Randomly generated PDFs ‣ Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">A.7</span></a>).
Notably, LLaMA-13b’s DE performance on these irregular distributions can still be effectively described using our bespoke KDE process (Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.SS6" title="A.6 Adaptive Kernel Visualization: Comparing LLaMA-2 with KDE ‣ Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">A.6</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.SS7" title="A.7 Randomly generated PDFs ‣ Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">A.7</span></a>).
Although the DE trajectories of these random PDFs lack low-dimensional embeddings, and thus provide less geometric insight, they nonetheless corroborate our findings from the cases with more regular distributions.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.SSS2.p7">
<p class="ltx_p" id="S4.SS3.SSS2.p7.1">This consistency across diverse target PDF types strengthens our core hypothesis about LLaMA’s underlying DE mechanism.
Specifically, we posit that LLaMA’s in-context DE algorithm shares fundamental characteristics with kernel density estimation,
albeit with adaptive kernel shape and bandwidth schedules that distinguish it from classical KDE approaches.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusions</h2>
<div class="ltx_para ltx_noindent" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">Inspired by emergent, in-context abilities of LLMs to continue stochastic time series, the current work explores the efficacy of foundation models operating as kernel density estimators; a crucial element within such time series forecasting. Through an application of InPCA, we determine that such in-context kernel density estimation proceeds within a common, low dimensional probability space; along meaningful trajectories that allow for a comparison between histogram, Gaussian kernel density estimation, and LLM in-context kernel density estimation. Through the lens of InPCA, it becomes clear that a profitable characterization of this in-context learning can be made in terms of a two-parameter, adaptive kernel density estimation framework; hinting at mechanistic basis (Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.SS1" title="A.1 Mechanistic interpretations of in-context learning. ‣ Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">A.1</span></a>) that points in the direction of future research.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.p2">
<p class="ltx_p" id="S5.p2.1"><span class="ltx_text ltx_font_bold" id="S5.p2.1.1">Future direction: towards dispersive induction heads</span>.
Recent research has identified induction heads as fundamental circuits underlying many in-context learning behaviors in stochastic systems with discrete states <cite class="ltx_cite ltx_citemacro_citep">(Olsson et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib25" title="">2022</a>; Bigelow et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib6" title="">2024</a>)</cite>.
These emergent circuits increase the predicted probability of token combinations that are observed in-context.
However, such discrete mechanisms are insufficient to explain the in-context learning of continuous stochastic systems,
such as the density estimation task we’ve studied.
To address this gap, our Bespoke KDE analysis in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#S4.SS3.SSS2" title="4.3.2 Bespoke KDE Analysis ‣ 4.3 The Kernel Interpretation of In-Context Density Estimation ‣ 4 Experiments and analysis ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">4.3.2</span></a> reveals that LLaMA might possess a kernel-like induction mechanism, which we term <span class="ltx_text ltx_font_bold" id="S5.p2.1.2">dispersive induction head</span>.
This is an extension to the induction head concept, and operates as follows:</p>
<ul class="ltx_itemize" id="S5.I1">
<li class="ltx_item" id="S5.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i1.p1">
<p class="ltx_p" id="S5.I1.i1.p1.1">Unlike standard induction heads <cite class="ltx_cite ltx_citemacro_citep">(Akyürek et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib2" title="">2024</a>)</cite>, a dispersive induction head increases the predicted probability of not just exact matches, but also of similar tokens or words.</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i2.p1">
<p class="ltx_p" id="S5.I1.i2.p1.1">The "similarity" is determined by an adaptive kernel, analogous to our bespoke KDE model.</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S5.I1.i3.p1">
<p class="ltx_p" id="S5.I1.i3.p1.1">The influence of each observation on dissimilar tokens decays over context length, mirroring the decreasing bandwidth in our KDE model.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para ltx_noindent" id="S5.p3">
<p class="ltx_p" id="S5.p3.1">This concept of dispersive induction heads could potentially bridge the gap between discrete <cite class="ltx_cite ltx_citemacro_citep">(Akyürek et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib2" title="">2024</a>)</cite> and continuous <cite class="ltx_cite ltx_citemacro_citep">(Gruver et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib13" title="">2024</a>; Liu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib22" title="">2024</a>)</cite> in-context learning mechanisms in transformers <cite class="ltx_cite ltx_citemacro_citep">(Dong et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib11" title="">2024</a>)</cite>.</p>
</div>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">Acknowledgements</h2>
<div class="ltx_para ltx_noindent" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">This work was supported by the SciAI Center, and funded by the Office of Naval Research (ONR), under Grant Numbers N00014-23-1-2729 and N00014-23-1-2716.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Akyürek et al. (2023)</span>
<span class="ltx_bibblock">
Ekin Akyürek, Dale Schuurmans, Jacob Andreas, Tengyu Ma, and Denny Zhou.

</span>
<span class="ltx_bibblock">What learning algorithm is in-context learning? investigations with
linear models, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2211.15661" title="">https://arxiv.org/abs/2211.15661</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Akyürek et al. (2024)</span>
<span class="ltx_bibblock">
Ekin Akyürek, Bailin Wang, Yoon Kim, and Jacob Andreas.

</span>
<span class="ltx_bibblock">In-context language learning: Architectures and algorithms, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2401.12973" title="">https://arxiv.org/abs/2401.12973</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Amari (2016)</span>
<span class="ltx_bibblock">
Shun-ichi Amari.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">Information geometry and its applications</em>.

</span>
<span class="ltx_bibblock">Springer, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bhattacharyya (1943)</span>
<span class="ltx_bibblock">
Anil Bhattacharyya.

</span>
<span class="ltx_bibblock">On a measure of divergence between two statistical populations
defined by their probability distribution.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">Bulletin of the Calcutta Mathematical Society</em>, 35:99–110, 1943.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bietti et al. (2023)</span>
<span class="ltx_bibblock">
Alberto Bietti, Vivien Cabannes, Diane Bouchacourt, Herve Jegou, and Leon
Bottou.

</span>
<span class="ltx_bibblock">Birth of a transformer: A memory viewpoint, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2306.00802" title="">https://arxiv.org/abs/2306.00802</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bigelow et al. (2024)</span>
<span class="ltx_bibblock">
Eric J. Bigelow, Ekdeep Singh Lubana, Robert P. Dick, Hidenori Tanaka, and
Tomer D. Ullman.

</span>
<span class="ltx_bibblock">In-context learning dynamics with random binary sequences, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2310.17639" title="">https://arxiv.org/abs/2310.17639</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brown et al. (2020)</span>
<span class="ltx_bibblock">
Tom B. Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared Kaplan,
Prafulla Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda
Askell, Sandhini Agarwal, Ariel Herbert-Voss, Gretchen Krueger, Tom Henighan,
Rewon Child, Aditya Ramesh, Daniel M. Ziegler, Jeffrey Wu, Clemens Winter,
Christopher Hesse, Mark Chen, Eric Sigler, Mateusz Litwin, Scott Gray,
Benjamin Chess, Jack Clark, Christopher Berner, Sam McCandlish, Alec Radford,
Ilya Sutskever, and Dario Amodei.

</span>
<span class="ltx_bibblock">Language models are few-shot learners, 2020.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2005.14165" title="">https://arxiv.org/abs/2005.14165</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2007)</span>
<span class="ltx_bibblock">
Chun-houh Chen, Wolfgang Karl Härdle, and Antony Unwin.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">Handbook of data visualization</em>.

</span>
<span class="ltx_bibblock">Springer Science &amp; Business Media, 2007.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dai et al. (2023)</span>
<span class="ltx_bibblock">
Damai Dai, Yutao Sun, Li Dong, Yaru Hao, Shuming Ma, Zhifang Sui, and Furu Wei.

</span>
<span class="ltx_bibblock">Why can gpt learn in-context? language models implicitly perform
gradient descent as meta-optimizers, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2212.10559" title="">https://arxiv.org/abs/2212.10559</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">DeVore (1993)</span>
<span class="ltx_bibblock">
RA DeVore.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">Constructive Approximation</em>.

</span>
<span class="ltx_bibblock">Springer-Verlag, 1993.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dong et al. (2024)</span>
<span class="ltx_bibblock">
Qingxiu Dong, Lei Li, Damai Dai, Ce Zheng, Jingyuan Ma, Rui Li, Heming Xia,
Jingjing Xu, Zhiyong Wu, Tianyu Liu, Baobao Chang, Xu Sun, Lei Li, and
Zhifang Sui.

</span>
<span class="ltx_bibblock">A survey on in-context learning, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2301.00234" title="">https://arxiv.org/abs/2301.00234</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fischer (2011)</span>
<span class="ltx_bibblock">
Hans Fischer.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">A history of the central limit theorem: from classical to
modern probability theory</em>, volume 4.

</span>
<span class="ltx_bibblock">Springer, 2011.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gruver et al. (2024)</span>
<span class="ltx_bibblock">
Nate Gruver, Marc Finzi, Shikai Qiu, and Andrew Gordon Wilson.

</span>
<span class="ltx_bibblock">Large language models are zero-shot time series forecasters, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2310.07820" title="">https://arxiv.org/abs/2310.07820</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hellinger (1909)</span>
<span class="ltx_bibblock">
Ernst Hellinger.

</span>
<span class="ltx_bibblock">Neue begründung der theorie quadratischer formen von
unendlichvielen veränderlichen.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">Journal für die reine und angewandte Mathematik</em>,
1909(136):210–271, 1909.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al. (2021)</span>
<span class="ltx_bibblock">
Edward J. Hu, Yelong Shen, Phillip Wallis, Zeyuan Allen-Zhu, Yuanzhi Li, Shean
Wang, Lu Wang, and Weizhu Chen.

</span>
<span class="ltx_bibblock">Lora: Low-rank adaptation of large language models, 2021.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2106.09685" title="">https://arxiv.org/abs/2106.09685</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al. (2023)</span>
<span class="ltx_bibblock">
Xiaoyang Hu, Shane Storks, Richard L. Lewis, and Joyce Chai.

</span>
<span class="ltx_bibblock">In-context analogical reasoning with pre-trained language models,
2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2305.17626" title="">https://arxiv.org/abs/2305.17626</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Izenman (1991)</span>
<span class="ltx_bibblock">
Alan Julian Izenman.

</span>
<span class="ltx_bibblock">Review papers: Recent developments in nonparametric density
estimation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">Journal of the american statistical association</em>, 86(413):205–224, 1991.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jeffreys (1946)</span>
<span class="ltx_bibblock">
Harold Jeffreys.

</span>
<span class="ltx_bibblock">An invariant form for the prior probability in estimation problems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Proceedings of the Royal Society of London. Series A.
Mathematical and Physical Sciences</em>, 186(1007):453–461,
1946.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jin et al. (2024)</span>
<span class="ltx_bibblock">
Ming Jin, Shiyu Wang, Lintao Ma, Zhixuan Chu, James Y. Zhang, Xiaoming Shi,
Pin-Yu Chen, Yuxuan Liang, Yuan-Fang Li, Shirui Pan, and Qingsong Wen.

</span>
<span class="ltx_bibblock">Time-llm: Time series forecasting by reprogramming large language
models, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2310.01728" title="">https://arxiv.org/abs/2310.01728</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kantamneni et al. (2024)</span>
<span class="ltx_bibblock">
Subhash Kantamneni, Ziming Liu, and Max Tegmark.

</span>
<span class="ltx_bibblock">How do transformers "do" physics? investigating the simple harmonic
oscillator, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2405.17209" title="">https://arxiv.org/abs/2405.17209</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liese &amp; Vajda (2006)</span>
<span class="ltx_bibblock">
Friedrich Liese and Igor Vajda.

</span>
<span class="ltx_bibblock">On divergences and informations in statistics and information theory.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">IEEE Transactions on Information Theory</em>, 52(10):4394–4412, 2006.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2024)</span>
<span class="ltx_bibblock">
Toni J. B. Liu, Nicolas Boullé, Raphaël Sarfati, and Christopher J. Earls.

</span>
<span class="ltx_bibblock">Llms learn governing principles of dynamical systems, revealing an
in-context neural scaling law, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2402.00795" title="">https://arxiv.org/abs/2402.00795</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lugosi &amp; Nobel (1996)</span>
<span class="ltx_bibblock">
Gábor Lugosi and Andrew Nobel.

</span>
<span class="ltx_bibblock">Consistency of data-driven histogram methods for density estimation
and classification.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">The Annals of Statistics</em>, 24(2):687–706,
1996.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mao et al. (2024)</span>
<span class="ltx_bibblock">
Jialin Mao, Itay Griniasty, Han Kheng Teoh, Rahul Ramesh, Rubing Yang, Mark K.
Transtrum, James P. Sethna, and Pratik Chaudhari.

</span>
<span class="ltx_bibblock">The training process of many deep networks explores the same
low-dimensional manifold.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">Proceedings of the National Academy of Sciences</em>, 121(12), March 2024.

</span>
<span class="ltx_bibblock">ISSN 1091-6490.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1073/pnas.2310002121</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://dx.doi.org/10.1073/pnas.2310002121" title="">http://dx.doi.org/10.1073/pnas.2310002121</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Olsson et al. (2022)</span>
<span class="ltx_bibblock">
Catherine Olsson, Nelson Elhage, Neel Nanda, Nicholas Joseph, Nova DasSarma,
Tom Henighan, Ben Mann, Amanda Askell, Yuntao Bai, Anna Chen, Tom Conerly,
Dawn Drain, Deep Ganguli, Zac Hatfield-Dodds, Danny Hernandez, Scott
Johnston, Andy Jones, Jackson Kernion, Liane Lovitt, Kamal Ndousse, Dario
Amodei, Tom Brown, Jack Clark, Jared Kaplan, Sam McCandlish, and Chris Olah.

</span>
<span class="ltx_bibblock">In-context learning and induction heads, 2022.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2209.11895" title="">https://arxiv.org/abs/2209.11895</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Papamakarios et al. (2021)</span>
<span class="ltx_bibblock">
George Papamakarios, Eric Nalisnick, Danilo Jimenez Rezende, Shakir Mohamed,
and Balaji Lakshminarayanan.

</span>
<span class="ltx_bibblock">Normalizing flows for probabilistic modeling and inference, 2021.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/1912.02762" title="">https://arxiv.org/abs/1912.02762</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Parzen (1962)</span>
<span class="ltx_bibblock">
Emanuel Parzen.

</span>
<span class="ltx_bibblock">On estimation of a probability density function and mode.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">The annals of mathematical statistics</em>, 33(3):1065–1076, 1962.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Quinn et al. (2019)</span>
<span class="ltx_bibblock">
Katherine N Quinn, Colin B Clement, Francesco De Bernardis, Michael D Niemack,
and James P Sethna.

</span>
<span class="ltx_bibblock">Visualizing probabilistic models and data with intensive principal
component analysis.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">Proceedings of the National Academy of Sciences</em>, 116(28):13762–13767, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rényi (1961)</span>
<span class="ltx_bibblock">
Alfréd Rényi.

</span>
<span class="ltx_bibblock">On measures of entropy and information.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">Proceedings of the fourth Berkeley symposium on mathematical
statistics and probability, volume 1: contributions to the theory of
statistics</em>, volume 4, pp.  547–562. University of California Press, 1961.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Requeima et al. (2024)</span>
<span class="ltx_bibblock">
James Requeima, John Bronskill, Dami Choi, Richard E Turner, and David
Duvenaud.

</span>
<span class="ltx_bibblock">Llm processes: Numerical predictive distributions conditioned on
natural language.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">arXiv preprint arXiv:2405.12856</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rosenblat (1956)</span>
<span class="ltx_bibblock">
M Rosenblat.

</span>
<span class="ltx_bibblock">Remarks on some nonparametric estimates of a density function.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">Ann. Math. Stat</em>, 27:832–837, 1956.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Scott (1979)</span>
<span class="ltx_bibblock">
David W Scott.

</span>
<span class="ltx_bibblock">On optimal and data-based histograms.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">Biometrika</em>, 66(3):605–610, 1979.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Seeger (2004)</span>
<span class="ltx_bibblock">
Matthias Seeger.

</span>
<span class="ltx_bibblock">Gaussian processes for machine learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">International journal of neural systems</em>, 14(02):69–106, 2004.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Si et al. (2023)</span>
<span class="ltx_bibblock">
Chenglei Si, Dan Friedman, Nitish Joshi, Shi Feng, Danqi Chen, and He He.

</span>
<span class="ltx_bibblock">Measuring inductive biases of in-context learning with underspecified
demonstrations, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2305.13299" title="">https://arxiv.org/abs/2305.13299</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Silverman (2018)</span>
<span class="ltx_bibblock">
Bernard W Silverman.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">Density estimation for statistics and data analysis</em>.

</span>
<span class="ltx_bibblock">Routledge, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sohl-Dickstein et al. (2015)</span>
<span class="ltx_bibblock">
Jascha Sohl-Dickstein, Eric A. Weiss, Niru Maheswaranathan, and Surya Ganguli.

</span>
<span class="ltx_bibblock">Deep unsupervised learning using nonequilibrium thermodynamics, 2015.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/1503.03585" title="">https://arxiv.org/abs/1503.03585</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Teoh et al. (2020)</span>
<span class="ltx_bibblock">
Han Kheng Teoh, Katherine N. Quinn, Jaron Kent-Dobias, Colin B. Clement,
Qingyang Xu, and James P. Sethna.

</span>
<span class="ltx_bibblock">Visualizing probabilistic models in minkowski space with intensive
symmetrized kullback-leibler embedding.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">Physical Review Research</em>, 2(3), August 2020.

</span>
<span class="ltx_bibblock">ISSN 2643-1564.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1103/physrevresearch.2.033221</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://dx.doi.org/10.1103/PhysRevResearch.2.033221" title="">http://dx.doi.org/10.1103/PhysRevResearch.2.033221</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Thomas &amp; Joy (2006)</span>
<span class="ltx_bibblock">
MTCAJ Thomas and A Thomas Joy.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">Elements of information theory</em>.

</span>
<span class="ltx_bibblock">Wiley-Interscience, 2006.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et al. (2023)</span>
<span class="ltx_bibblock">
Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine
Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale,
Dan Bikel, Lukas Blecher, Cristian Canton Ferrer, Moya Chen, Guillem
Cucurull, David Esiobu, Jude Fernandes, Jeremy Fu, Wenyin Fu, Brian Fuller,
Cynthia Gao, Vedanuj Goswami, Naman Goyal, Anthony Hartshorn, Saghar
Hosseini, Rui Hou, Hakan Inan, Marcin Kardas, Viktor Kerkez, Madian Khabsa,
Isabel Kloumann, Artem Korenev, Punit Singh Koura, Marie-Anne Lachaux,
Thibaut Lavril, Jenya Lee, Diana Liskovich, Yinghai Lu, Yuning Mao, Xavier
Martinet, Todor Mihaylov, Pushkar Mishra, Igor Molybog, Yixin Nie, Andrew
Poulton, Jeremy Reizenstein, Rashi Rungta, Kalyan Saladi, Alan Schelten, Ruan
Silva, Eric Michael Smith, Ranjan Subramanian, Xiaoqing Ellen Tan, Binh Tang,
Ross Taylor, Adina Williams, Jian Xiang Kuan, Puxin Xu, Zheng Yan, Iliyan
Zarov, Yuchen Zhang, Angela Fan, Melanie Kambadur, Sharan Narang, Aurelien
Rodriguez, Robert Stojnic, Sergey Edunov, and Thomas Scialom.

</span>
<span class="ltx_bibblock">Llama 2: Open foundation and fine-tuned chat models, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2307.09288" title="">https://arxiv.org/abs/2307.09288</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">von Oswald et al. (2023)</span>
<span class="ltx_bibblock">
Johannes von Oswald, Eyvind Niklasson, Ettore Randazzo, João Sacramento,
Alexander Mordvintsev, Andrey Zhmoginov, and Max Vladymyrov.

</span>
<span class="ltx_bibblock">Transformers learn in-context by gradient descent, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2212.07677" title="">https://arxiv.org/abs/2212.07677</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wand &amp; Jones (1994)</span>
<span class="ltx_bibblock">
Matt P Wand and M Chris Jones.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">Kernel smoothing</em>.

</span>
<span class="ltx_bibblock">CRC press, 1994.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xie et al. (2022)</span>
<span class="ltx_bibblock">
Sang Michael Xie, Aditi Raghunathan, Percy Liang, and Tengyu Ma.

</span>
<span class="ltx_bibblock">An explanation of in-context learning as implicit bayesian inference,
2022.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2111.02080" title="">https://arxiv.org/abs/2111.02080</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zekri et al. (2024)</span>
<span class="ltx_bibblock">
Oussama Zekri, Abdelhakim Benechehab, and Ievgen Redko.

</span>
<span class="ltx_bibblock">Can llms predict the convergence of stochastic gradient descent?,
2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2408.01736" title="">https://arxiv.org/abs/2408.01736</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2024)</span>
<span class="ltx_bibblock">
Xiyuan Zhang, Ranak Roy Chowdhury, Rajesh K. Gupta, and Jingbo Shang.

</span>
<span class="ltx_bibblock">Large language models for time series: A survey, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2402.01801" title="">https://arxiv.org/abs/2402.01801</a>.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Appendix</h2>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Mechanistic interpretations of in-context learning.</h3>
<div class="ltx_para ltx_noindent" id="A1.SS1.p1">
<p class="ltx_p" id="A1.SS1.p1.1">In recent years a paradigm has emerged for LLMs’ in-context learning abilities: the simulation and application of smaller, classical models, with well-understood algorithmic features, in response to prompt information. As an example, <cite class="ltx_cite ltx_citemacro_cite">Olsson et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib25" title="">2022</a>)</cite> identified “induction heads" in pre-trained LLMs, which simulate 1-gram models for language learning. Then, <cite class="ltx_cite ltx_citemacro_cite">Akyürek et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib2" title="">2024</a>)</cite> extended this analysis to “n-gram heads" for computing distributions of next tokens conditioned on n previous tokens. It has also been observed in the literature that transformers can perform in-context regression via gradient descent <cite class="ltx_cite ltx_citemacro_citep">(von Oswald et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib40" title="">2023</a>; Dai et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib9" title="">2023</a>)</cite>. These works proposed to understand induction heads as a specific case of in-context gradient descent. <cite class="ltx_cite ltx_citemacro_cite">Akyürek et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib1" title="">2023</a>)</cite> showed that trained in-context learners closely match predictions of gradient-based optimization algorithms. More recently, <cite class="ltx_cite ltx_citemacro_cite">Kantamneni et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib20" title="">2024</a>)</cite> identified mechanisms in transformers that implicitly implement matrix exponential methods for solving linear ordinary differential equations (ODEs).</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS1.p2">
<p class="ltx_p" id="A1.SS1.p2.1">Our approach differs from these aforementioned studies for the following reason:
we do not train LLMs on synthetic data designed to induce specific in-context learning abilities. Instead, we investigate the emergent density estimation capabilities of pre-trained foundation models (the LLaMA-2 suite) without any fine-tuning. This approach aligns more closely with recent works <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib22" title="">2024</a>; Gruver et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib13" title="">2024</a>)</cite> that focus on the inherent mathematical abilities of foundations models, rather than LLMs that are trained to induce certain behaviors.</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Low-dimensional structures in learning dynamics.</h3>
<div class="ltx_para ltx_noindent" id="A1.SS2.p1">
<p class="ltx_p" id="A1.SS2.p1.3">Despite the success of modern neural networks at learning patterns in high-dimensional data, the learning dynamics of these complex neural networks are often shown to be constrained to low-dimensional, potentially non-linear subspaces. <cite class="ltx_cite ltx_citemacro_cite">Hu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib15" title="">2021</a>)</cite> demonstrated that the fine-tuning dynamics of LLMs such as GPT and RoBERTa can be well-captured within extremely low-rank, weighted spaces. More recently, <cite class="ltx_cite ltx_citemacro_cite">Mao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib24" title="">2024</a>)</cite> showed that, during training, neural networks spanning a wide range of architectures and sizes trace out
similar low-dimensional trajectories in the space of probability distributions.
Their work focuses on learning trajectories <math alttext="p_{k=0},...,p_{k=t}" class="ltx_Math" display="inline" id="A1.SS2.p1.1.m1.3"><semantics id="A1.SS2.p1.1.m1.3a"><mrow id="A1.SS2.p1.1.m1.3.3.2" xref="A1.SS2.p1.1.m1.3.3.3.cmml"><msub id="A1.SS2.p1.1.m1.2.2.1.1" xref="A1.SS2.p1.1.m1.2.2.1.1.cmml"><mi id="A1.SS2.p1.1.m1.2.2.1.1.2" xref="A1.SS2.p1.1.m1.2.2.1.1.2.cmml">p</mi><mrow id="A1.SS2.p1.1.m1.2.2.1.1.3" xref="A1.SS2.p1.1.m1.2.2.1.1.3.cmml"><mi id="A1.SS2.p1.1.m1.2.2.1.1.3.2" xref="A1.SS2.p1.1.m1.2.2.1.1.3.2.cmml">k</mi><mo id="A1.SS2.p1.1.m1.2.2.1.1.3.1" xref="A1.SS2.p1.1.m1.2.2.1.1.3.1.cmml">=</mo><mn id="A1.SS2.p1.1.m1.2.2.1.1.3.3" xref="A1.SS2.p1.1.m1.2.2.1.1.3.3.cmml">0</mn></mrow></msub><mo id="A1.SS2.p1.1.m1.3.3.2.3" xref="A1.SS2.p1.1.m1.3.3.3.cmml">,</mo><mi id="A1.SS2.p1.1.m1.1.1" mathvariant="normal" xref="A1.SS2.p1.1.m1.1.1.cmml">…</mi><mo id="A1.SS2.p1.1.m1.3.3.2.4" xref="A1.SS2.p1.1.m1.3.3.3.cmml">,</mo><msub id="A1.SS2.p1.1.m1.3.3.2.2" xref="A1.SS2.p1.1.m1.3.3.2.2.cmml"><mi id="A1.SS2.p1.1.m1.3.3.2.2.2" xref="A1.SS2.p1.1.m1.3.3.2.2.2.cmml">p</mi><mrow id="A1.SS2.p1.1.m1.3.3.2.2.3" xref="A1.SS2.p1.1.m1.3.3.2.2.3.cmml"><mi id="A1.SS2.p1.1.m1.3.3.2.2.3.2" xref="A1.SS2.p1.1.m1.3.3.2.2.3.2.cmml">k</mi><mo id="A1.SS2.p1.1.m1.3.3.2.2.3.1" xref="A1.SS2.p1.1.m1.3.3.2.2.3.1.cmml">=</mo><mi id="A1.SS2.p1.1.m1.3.3.2.2.3.3" xref="A1.SS2.p1.1.m1.3.3.2.2.3.3.cmml">t</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.1.m1.3b"><list id="A1.SS2.p1.1.m1.3.3.3.cmml" xref="A1.SS2.p1.1.m1.3.3.2"><apply id="A1.SS2.p1.1.m1.2.2.1.1.cmml" xref="A1.SS2.p1.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="A1.SS2.p1.1.m1.2.2.1.1.1.cmml" xref="A1.SS2.p1.1.m1.2.2.1.1">subscript</csymbol><ci id="A1.SS2.p1.1.m1.2.2.1.1.2.cmml" xref="A1.SS2.p1.1.m1.2.2.1.1.2">𝑝</ci><apply id="A1.SS2.p1.1.m1.2.2.1.1.3.cmml" xref="A1.SS2.p1.1.m1.2.2.1.1.3"><eq id="A1.SS2.p1.1.m1.2.2.1.1.3.1.cmml" xref="A1.SS2.p1.1.m1.2.2.1.1.3.1"></eq><ci id="A1.SS2.p1.1.m1.2.2.1.1.3.2.cmml" xref="A1.SS2.p1.1.m1.2.2.1.1.3.2">𝑘</ci><cn id="A1.SS2.p1.1.m1.2.2.1.1.3.3.cmml" type="integer" xref="A1.SS2.p1.1.m1.2.2.1.1.3.3">0</cn></apply></apply><ci id="A1.SS2.p1.1.m1.1.1.cmml" xref="A1.SS2.p1.1.m1.1.1">…</ci><apply id="A1.SS2.p1.1.m1.3.3.2.2.cmml" xref="A1.SS2.p1.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="A1.SS2.p1.1.m1.3.3.2.2.1.cmml" xref="A1.SS2.p1.1.m1.3.3.2.2">subscript</csymbol><ci id="A1.SS2.p1.1.m1.3.3.2.2.2.cmml" xref="A1.SS2.p1.1.m1.3.3.2.2.2">𝑝</ci><apply id="A1.SS2.p1.1.m1.3.3.2.2.3.cmml" xref="A1.SS2.p1.1.m1.3.3.2.2.3"><eq id="A1.SS2.p1.1.m1.3.3.2.2.3.1.cmml" xref="A1.SS2.p1.1.m1.3.3.2.2.3.1"></eq><ci id="A1.SS2.p1.1.m1.3.3.2.2.3.2.cmml" xref="A1.SS2.p1.1.m1.3.3.2.2.3.2">𝑘</ci><ci id="A1.SS2.p1.1.m1.3.3.2.2.3.3.cmml" xref="A1.SS2.p1.1.m1.3.3.2.2.3.3">𝑡</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.1.m1.3c">p_{k=0},...,p_{k=t}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.1.m1.3d">italic_p start_POSTSUBSCRIPT italic_k = 0 end_POSTSUBSCRIPT , … , italic_p start_POSTSUBSCRIPT italic_k = italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, where <math alttext="k" class="ltx_Math" display="inline" id="A1.SS2.p1.2.m2.1"><semantics id="A1.SS2.p1.2.m2.1a"><mi id="A1.SS2.p1.2.m2.1.1" xref="A1.SS2.p1.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.2.m2.1b"><ci id="A1.SS2.p1.2.m2.1.1.cmml" xref="A1.SS2.p1.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.2.m2.1d">italic_k</annotation></semantics></math> indexes the training epoch, and <math alttext="p_{k}" class="ltx_Math" display="inline" id="A1.SS2.p1.3.m3.1"><semantics id="A1.SS2.p1.3.m3.1a"><msub id="A1.SS2.p1.3.m3.1.1" xref="A1.SS2.p1.3.m3.1.1.cmml"><mi id="A1.SS2.p1.3.m3.1.1.2" xref="A1.SS2.p1.3.m3.1.1.2.cmml">p</mi><mi id="A1.SS2.p1.3.m3.1.1.3" xref="A1.SS2.p1.3.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.3.m3.1b"><apply id="A1.SS2.p1.3.m3.1.1.cmml" xref="A1.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A1.SS2.p1.3.m3.1.1.1.cmml" xref="A1.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="A1.SS2.p1.3.m3.1.1.2.cmml" xref="A1.SS2.p1.3.m3.1.1.2">𝑝</ci><ci id="A1.SS2.p1.3.m3.1.1.3.cmml" xref="A1.SS2.p1.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.3.m3.1c">p_{k}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.3.m3.1d">italic_p start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is a high-dimensional PDF describing the model’s probabilistic classification of input data.
Key to their observations is a technique termed <em class="ltx_emph ltx_font_italic" id="A1.SS2.p1.3.1">Intensive Principal Component Analysis (InPCA)</em>,
a visualization tool <cite class="ltx_cite ltx_citemacro_citep">(Quinn et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib28" title="">2019</a>)</cite> that embeds PDFs as points in low dimensional spaces, such that the geometric (Euclidean or Minkowski)
distances between embedded points reflect the statistical distances - e.g. the Hellinger or Bhattacharyya distance - between the corresponding PDFs.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS2.p2">
<p class="ltx_p" id="A1.SS2.p2.3">Inspired by <cite class="ltx_cite ltx_citemacro_cite">Mao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib24" title="">2024</a>)</cite> and <cite class="ltx_cite ltx_citemacro_cite">Quinn et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib28" title="">2019</a>)</cite>, we extend this line of inquiry to investigate whether the <span class="ltx_text ltx_font_italic" id="A1.SS2.p2.3.1">in-context</span> learning dynamics of
LLMs also follow low-dimensional trajectories in probability space.
and <math alttext="\hat{p}_{k}" class="ltx_Math" display="inline" id="A1.SS2.p2.1.m1.1"><semantics id="A1.SS2.p2.1.m1.1a"><msub id="A1.SS2.p2.1.m1.1.1" xref="A1.SS2.p2.1.m1.1.1.cmml"><mover accent="true" id="A1.SS2.p2.1.m1.1.1.2" xref="A1.SS2.p2.1.m1.1.1.2.cmml"><mi id="A1.SS2.p2.1.m1.1.1.2.2" xref="A1.SS2.p2.1.m1.1.1.2.2.cmml">p</mi><mo id="A1.SS2.p2.1.m1.1.1.2.1" xref="A1.SS2.p2.1.m1.1.1.2.1.cmml">^</mo></mover><mi id="A1.SS2.p2.1.m1.1.1.3" xref="A1.SS2.p2.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.1.m1.1b"><apply id="A1.SS2.p2.1.m1.1.1.cmml" xref="A1.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p2.1.m1.1.1.1.cmml" xref="A1.SS2.p2.1.m1.1.1">subscript</csymbol><apply id="A1.SS2.p2.1.m1.1.1.2.cmml" xref="A1.SS2.p2.1.m1.1.1.2"><ci id="A1.SS2.p2.1.m1.1.1.2.1.cmml" xref="A1.SS2.p2.1.m1.1.1.2.1">^</ci><ci id="A1.SS2.p2.1.m1.1.1.2.2.cmml" xref="A1.SS2.p2.1.m1.1.1.2.2">𝑝</ci></apply><ci id="A1.SS2.p2.1.m1.1.1.3.cmml" xref="A1.SS2.p2.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.1.m1.1c">\hat{p}_{k}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p2.1.m1.1d">over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is a PDF of dimension <math alttext="10^{N}" class="ltx_Math" display="inline" id="A1.SS2.p2.2.m2.1"><semantics id="A1.SS2.p2.2.m2.1a"><msup id="A1.SS2.p2.2.m2.1.1" xref="A1.SS2.p2.2.m2.1.1.cmml"><mn id="A1.SS2.p2.2.m2.1.1.2" xref="A1.SS2.p2.2.m2.1.1.2.cmml">10</mn><mi id="A1.SS2.p2.2.m2.1.1.3" xref="A1.SS2.p2.2.m2.1.1.3.cmml">N</mi></msup><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.2.m2.1b"><apply id="A1.SS2.p2.2.m2.1.1.cmml" xref="A1.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS2.p2.2.m2.1.1.1.cmml" xref="A1.SS2.p2.2.m2.1.1">superscript</csymbol><cn id="A1.SS2.p2.2.m2.1.1.2.cmml" type="integer" xref="A1.SS2.p2.2.m2.1.1.2">10</cn><ci id="A1.SS2.p2.2.m2.1.1.3.cmml" xref="A1.SS2.p2.2.m2.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.2.m2.1c">10^{N}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p2.2.m2.1d">10 start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math>, where N is the number of digits used in the multi-digit representation (see <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#S3" title="3 Methodology ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">3</span></a>).
Each <math alttext="\hat{p}_{k}" class="ltx_Math" display="inline" id="A1.SS2.p2.3.m3.1"><semantics id="A1.SS2.p2.3.m3.1a"><msub id="A1.SS2.p2.3.m3.1.1" xref="A1.SS2.p2.3.m3.1.1.cmml"><mover accent="true" id="A1.SS2.p2.3.m3.1.1.2" xref="A1.SS2.p2.3.m3.1.1.2.cmml"><mi id="A1.SS2.p2.3.m3.1.1.2.2" xref="A1.SS2.p2.3.m3.1.1.2.2.cmml">p</mi><mo id="A1.SS2.p2.3.m3.1.1.2.1" xref="A1.SS2.p2.3.m3.1.1.2.1.cmml">^</mo></mover><mi id="A1.SS2.p2.3.m3.1.1.3" xref="A1.SS2.p2.3.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.3.m3.1b"><apply id="A1.SS2.p2.3.m3.1.1.cmml" xref="A1.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="A1.SS2.p2.3.m3.1.1.1.cmml" xref="A1.SS2.p2.3.m3.1.1">subscript</csymbol><apply id="A1.SS2.p2.3.m3.1.1.2.cmml" xref="A1.SS2.p2.3.m3.1.1.2"><ci id="A1.SS2.p2.3.m3.1.1.2.1.cmml" xref="A1.SS2.p2.3.m3.1.1.2.1">^</ci><ci id="A1.SS2.p2.3.m3.1.1.2.2.cmml" xref="A1.SS2.p2.3.m3.1.1.2.2">𝑝</ci></apply><ci id="A1.SS2.p2.3.m3.1.1.3.cmml" xref="A1.SS2.p2.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.3.m3.1c">\hat{p}_{k}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p2.3.m3.1d">over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> describes the model’s estimation of the underlying data distribution at a certain context length.
Our findings show that in-context density estimation traces low-dimensional paths.</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.3 </span>Bespoke KDE cannot imitate all DE processes</h3>
<div class="ltx_para ltx_noindent" id="A1.SS3.p1">
<p class="ltx_p" id="A1.SS3.p1.1">This section examines the ability of Bespoke KDE to imitate various density estimation (DE) processes, including LLaMA-2 models (7b, 13b, 70b),
Bayesian histogram, and standard Gaussian KDE.</p>
</div>
<section class="ltx_subsubsection" id="A1.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.3.1 </span>InPCA visualization of original DE trajectories vs. Bespoke KDE imitations</h4>
<figure class="ltx_figure" id="A1.F8"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="303" id="A1.F8.g1" src="extracted/5899401/figures/gaussian_0.1_7_13_70_KDE_hist_traj_embed_Hellinger_2D_97.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>
Comparison of original DE trajectories (<math alttext="\triangle" class="ltx_Math" display="inline" id="A1.F8.3.m1.1"><semantics id="A1.F8.3.m1.1b"><mi id="A1.F8.3.m1.1.1" mathvariant="normal" xref="A1.F8.3.m1.1.1.cmml">△</mi><annotation-xml encoding="MathML-Content" id="A1.F8.3.m1.1c"><ci id="A1.F8.3.m1.1.1.cmml" xref="A1.F8.3.m1.1.1">△</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.F8.3.m1.1d">\triangle</annotation><annotation encoding="application/x-llamapun" id="A1.F8.3.m1.1e">△</annotation></semantics></math>) and their bespoke KDE imitations (<math alttext="\circ" class="ltx_Math" display="inline" id="A1.F8.4.m2.1"><semantics id="A1.F8.4.m2.1b"><mo id="A1.F8.4.m2.1.1" xref="A1.F8.4.m2.1.1.cmml">∘</mo><annotation-xml encoding="MathML-Content" id="A1.F8.4.m2.1c"><compose id="A1.F8.4.m2.1.1.cmml" xref="A1.F8.4.m2.1.1"></compose></annotation-xml><annotation encoding="application/x-tex" id="A1.F8.4.m2.1d">\circ</annotation><annotation encoding="application/x-llamapun" id="A1.F8.4.m2.1e">∘</annotation></semantics></math>) for LLaMA-2 models (7b, 13b, 70b), Gaussian KDE, and Bayesian histogram.
The 2D embeddings capture 97% of pairwise Hellinger distances between probability distributions.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="A1.SS3.SSS1.p1">
<p class="ltx_p" id="A1.SS3.SSS1.p1.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.F8" title="Figure 8 ‣ A.3.1 InPCA visualization of original DE trajectories vs. Bespoke KDE imitations ‣ A.3 Bespoke KDE cannot imitate all DE processes ‣ Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">8</span></a> illustrates the DE trajectories of various models alongside their bespoke KDE counterparts. We observe that:
1. Bespoke KDE successfully imitates the LLaMA suite with high precision.
2. It trivially replicates the Gaussian KDE trajectory, as expected.
3. However, it struggles to accurately capture the Bayesian histogram’s trajectory.
To further investigate these observations, we analyze the fitted kernel parameters for Gaussian KDE and Bayesian histogram:</p>
</div>
<figure class="ltx_figure" id="A1.F10">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A1.F10.5" style="width:190.8pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="306" id="A1.F10.1.g1" src="extracted/5899401/figures/uniform_0.1_7_13_70_KDE_hist_traj_embed_fitted_to_gaussian_KDE_hel_dist_False.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Bespoke KDE parameters fitted to standard Gaussian-kernel KDE.
The model accurately recovers the Gaussian kernel shape (<math alttext="s=2" class="ltx_Math" display="inline" id="A1.F10.4.3.m1.1"><semantics id="A1.F10.4.3.m1.1b"><mrow id="A1.F10.4.3.m1.1.1" xref="A1.F10.4.3.m1.1.1.cmml"><mi id="A1.F10.4.3.m1.1.1.2" xref="A1.F10.4.3.m1.1.1.2.cmml">s</mi><mo id="A1.F10.4.3.m1.1.1.1" xref="A1.F10.4.3.m1.1.1.1.cmml">=</mo><mn id="A1.F10.4.3.m1.1.1.3" xref="A1.F10.4.3.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F10.4.3.m1.1c"><apply id="A1.F10.4.3.m1.1.1.cmml" xref="A1.F10.4.3.m1.1.1"><eq id="A1.F10.4.3.m1.1.1.1.cmml" xref="A1.F10.4.3.m1.1.1.1"></eq><ci id="A1.F10.4.3.m1.1.1.2.cmml" xref="A1.F10.4.3.m1.1.1.2">𝑠</ci><cn id="A1.F10.4.3.m1.1.1.3.cmml" type="integer" xref="A1.F10.4.3.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F10.4.3.m1.1d">s=2</annotation><annotation encoding="application/x-llamapun" id="A1.F10.4.3.m1.1e">italic_s = 2</annotation></semantics></math>) and bandwidth schedule (<math alttext="h=n^{-\frac{1}{5}}" class="ltx_Math" display="inline" id="A1.F10.5.4.m2.1"><semantics id="A1.F10.5.4.m2.1b"><mrow id="A1.F10.5.4.m2.1.1" xref="A1.F10.5.4.m2.1.1.cmml"><mi id="A1.F10.5.4.m2.1.1.2" xref="A1.F10.5.4.m2.1.1.2.cmml">h</mi><mo id="A1.F10.5.4.m2.1.1.1" xref="A1.F10.5.4.m2.1.1.1.cmml">=</mo><msup id="A1.F10.5.4.m2.1.1.3" xref="A1.F10.5.4.m2.1.1.3.cmml"><mi id="A1.F10.5.4.m2.1.1.3.2" xref="A1.F10.5.4.m2.1.1.3.2.cmml">n</mi><mrow id="A1.F10.5.4.m2.1.1.3.3" xref="A1.F10.5.4.m2.1.1.3.3.cmml"><mo id="A1.F10.5.4.m2.1.1.3.3b" xref="A1.F10.5.4.m2.1.1.3.3.cmml">−</mo><mfrac id="A1.F10.5.4.m2.1.1.3.3.2" xref="A1.F10.5.4.m2.1.1.3.3.2.cmml"><mn id="A1.F10.5.4.m2.1.1.3.3.2.2" xref="A1.F10.5.4.m2.1.1.3.3.2.2.cmml">1</mn><mn id="A1.F10.5.4.m2.1.1.3.3.2.3" xref="A1.F10.5.4.m2.1.1.3.3.2.3.cmml">5</mn></mfrac></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.F10.5.4.m2.1c"><apply id="A1.F10.5.4.m2.1.1.cmml" xref="A1.F10.5.4.m2.1.1"><eq id="A1.F10.5.4.m2.1.1.1.cmml" xref="A1.F10.5.4.m2.1.1.1"></eq><ci id="A1.F10.5.4.m2.1.1.2.cmml" xref="A1.F10.5.4.m2.1.1.2">ℎ</ci><apply id="A1.F10.5.4.m2.1.1.3.cmml" xref="A1.F10.5.4.m2.1.1.3"><csymbol cd="ambiguous" id="A1.F10.5.4.m2.1.1.3.1.cmml" xref="A1.F10.5.4.m2.1.1.3">superscript</csymbol><ci id="A1.F10.5.4.m2.1.1.3.2.cmml" xref="A1.F10.5.4.m2.1.1.3.2">𝑛</ci><apply id="A1.F10.5.4.m2.1.1.3.3.cmml" xref="A1.F10.5.4.m2.1.1.3.3"><minus id="A1.F10.5.4.m2.1.1.3.3.1.cmml" xref="A1.F10.5.4.m2.1.1.3.3"></minus><apply id="A1.F10.5.4.m2.1.1.3.3.2.cmml" xref="A1.F10.5.4.m2.1.1.3.3.2"><divide id="A1.F10.5.4.m2.1.1.3.3.2.1.cmml" xref="A1.F10.5.4.m2.1.1.3.3.2"></divide><cn id="A1.F10.5.4.m2.1.1.3.3.2.2.cmml" type="integer" xref="A1.F10.5.4.m2.1.1.3.3.2.2">1</cn><cn id="A1.F10.5.4.m2.1.1.3.3.2.3.cmml" type="integer" xref="A1.F10.5.4.m2.1.1.3.3.2.3">5</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F10.5.4.m2.1d">h=n^{-\frac{1}{5}}</annotation><annotation encoding="application/x-llamapun" id="A1.F10.5.4.m2.1e">italic_h = italic_n start_POSTSUPERSCRIPT - divide start_ARG 1 end_ARG start_ARG 5 end_ARG end_POSTSUPERSCRIPT</annotation></semantics></math>).
</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A1.F10.6" style="width:190.8pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="317" id="A1.F10.6.g1" src="extracted/5899401/figures/uniform_0.1_7_13_70_KDE_hist_traj_embed_fitted_to_histogram_hel_dist_False.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>Bespoke KDE parameters fitted to Bayesian histogram. The constant fitted kernel width likely reflects the fixed bin width, while the near-zero shape parameter indicates a highly peaked distribution. High uncertainties suggest a fundamental mismatch between the models.
</figcaption>
</figure>
</div>
</div>
</figure>
<div class="ltx_para ltx_noindent" id="A1.SS3.SSS1.p2">
<p class="ltx_p" id="A1.SS3.SSS1.p2.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.F10" title="Figure 10 ‣ A.3.1 InPCA visualization of original DE trajectories vs. Bespoke KDE imitations ‣ A.3 Bespoke KDE cannot imitate all DE processes ‣ Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">10</span></a> demonstrates that bespoke KDE accurately recovers the parameters of standard Gaussian KDE. In contrast, Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.F10" title="Figure 10 ‣ A.3.1 InPCA visualization of original DE trajectories vs. Bespoke KDE imitations ‣ A.3 Bespoke KDE cannot imitate all DE processes ‣ Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">10</span></a> reveals significant challenges in fitting Bespoke KDE to the Bayesian histogram:
1. The fitted kernel width remains constant, likely reflecting the fixed bin width of the histogram.
2. The near-zero shape parameter suggests a highly peaked distribution.
3. High uncertainties in both parameters indicate a fundamental mismatch between Histogram and KDE.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS3.SSS1.p3">
<p class="ltx_p" id="A1.SS3.SSS1.p3.1">These results highlight that while Bespoke KDE can effectively model certain DE processes (e.g., LLaMA models and Gaussian KDE), it cannot capture fundamentally different approaches like the Bayesian histogram.</p>
</div>
</section>
<section class="ltx_subsubsection" id="A1.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.3.2 </span>Meta-InPCA Embedding of Trajectories</h4>
<figure class="ltx_figure" id="A1.F11"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="177" id="A1.F11.g1" src="extracted/5899401/figures/uniform_0.1_7_13_70_KDE_hist_traj_embed_real_silverman_trajectory_embedding_dim1_2.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11: </span>
Meta-InPCA embedding of DE trajectories (<math alttext="\triangle" class="ltx_Math" display="inline" id="A1.F11.3.m1.1"><semantics id="A1.F11.3.m1.1b"><mi id="A1.F11.3.m1.1.1" mathvariant="normal" xref="A1.F11.3.m1.1.1.cmml">△</mi><annotation-xml encoding="MathML-Content" id="A1.F11.3.m1.1c"><ci id="A1.F11.3.m1.1.1.cmml" xref="A1.F11.3.m1.1.1">△</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.F11.3.m1.1d">\triangle</annotation><annotation encoding="application/x-llamapun" id="A1.F11.3.m1.1e">△</annotation></semantics></math>) and their bespoke KDE imitations (<math alttext="\circ" class="ltx_Math" display="inline" id="A1.F11.4.m2.1"><semantics id="A1.F11.4.m2.1b"><mo id="A1.F11.4.m2.1.1" xref="A1.F11.4.m2.1.1.cmml">∘</mo><annotation-xml encoding="MathML-Content" id="A1.F11.4.m2.1c"><compose id="A1.F11.4.m2.1.1.cmml" xref="A1.F11.4.m2.1.1"></compose></annotation-xml><annotation encoding="application/x-tex" id="A1.F11.4.m2.1d">\circ</annotation><annotation encoding="application/x-llamapun" id="A1.F11.4.m2.1e">∘</annotation></semantics></math>).
This 2D embedding captures 94% of pairwise meta-distances between trajectories.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="A1.SS3.SSS2.p1">
<p class="ltx_p" id="A1.SS3.SSS2.p1.1">To quantify the similarity between the bespoke KDE model and various DE processes, we introduce a meta-distance measure for trajectories and apply InPCA at a higher level of abstraction.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS3.SSS2.p2">
<p class="ltx_p" id="A1.SS3.SSS2.p2.2"><span class="ltx_text ltx_font_bold" id="A1.SS3.SSS2.p2.2.1">Trajectory distance metric.</span>
We define a meta-distance between two trajectories <math alttext="\{p_{i}\}_{i=1}^{n}" class="ltx_Math" display="inline" id="A1.SS3.SSS2.p2.1.m1.1"><semantics id="A1.SS3.SSS2.p2.1.m1.1a"><msubsup id="A1.SS3.SSS2.p2.1.m1.1.1" xref="A1.SS3.SSS2.p2.1.m1.1.1.cmml"><mrow id="A1.SS3.SSS2.p2.1.m1.1.1.1.1.1" xref="A1.SS3.SSS2.p2.1.m1.1.1.1.1.2.cmml"><mo id="A1.SS3.SSS2.p2.1.m1.1.1.1.1.1.2" stretchy="false" xref="A1.SS3.SSS2.p2.1.m1.1.1.1.1.2.cmml">{</mo><msub id="A1.SS3.SSS2.p2.1.m1.1.1.1.1.1.1" xref="A1.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.cmml"><mi id="A1.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.2" xref="A1.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.2.cmml">p</mi><mi id="A1.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.3" xref="A1.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.SS3.SSS2.p2.1.m1.1.1.1.1.1.3" stretchy="false" xref="A1.SS3.SSS2.p2.1.m1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="A1.SS3.SSS2.p2.1.m1.1.1.1.3" xref="A1.SS3.SSS2.p2.1.m1.1.1.1.3.cmml"><mi id="A1.SS3.SSS2.p2.1.m1.1.1.1.3.2" xref="A1.SS3.SSS2.p2.1.m1.1.1.1.3.2.cmml">i</mi><mo id="A1.SS3.SSS2.p2.1.m1.1.1.1.3.1" xref="A1.SS3.SSS2.p2.1.m1.1.1.1.3.1.cmml">=</mo><mn id="A1.SS3.SSS2.p2.1.m1.1.1.1.3.3" xref="A1.SS3.SSS2.p2.1.m1.1.1.1.3.3.cmml">1</mn></mrow><mi id="A1.SS3.SSS2.p2.1.m1.1.1.3" xref="A1.SS3.SSS2.p2.1.m1.1.1.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS2.p2.1.m1.1b"><apply id="A1.SS3.SSS2.p2.1.m1.1.1.cmml" xref="A1.SS3.SSS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS3.SSS2.p2.1.m1.1.1.2.cmml" xref="A1.SS3.SSS2.p2.1.m1.1.1">superscript</csymbol><apply id="A1.SS3.SSS2.p2.1.m1.1.1.1.cmml" xref="A1.SS3.SSS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS3.SSS2.p2.1.m1.1.1.1.2.cmml" xref="A1.SS3.SSS2.p2.1.m1.1.1">subscript</csymbol><set id="A1.SS3.SSS2.p2.1.m1.1.1.1.1.2.cmml" xref="A1.SS3.SSS2.p2.1.m1.1.1.1.1.1"><apply id="A1.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.cmml" xref="A1.SS3.SSS2.p2.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.1.cmml" xref="A1.SS3.SSS2.p2.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.2.cmml" xref="A1.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.2">𝑝</ci><ci id="A1.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.3.cmml" xref="A1.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="A1.SS3.SSS2.p2.1.m1.1.1.1.3.cmml" xref="A1.SS3.SSS2.p2.1.m1.1.1.1.3"><eq id="A1.SS3.SSS2.p2.1.m1.1.1.1.3.1.cmml" xref="A1.SS3.SSS2.p2.1.m1.1.1.1.3.1"></eq><ci id="A1.SS3.SSS2.p2.1.m1.1.1.1.3.2.cmml" xref="A1.SS3.SSS2.p2.1.m1.1.1.1.3.2">𝑖</ci><cn id="A1.SS3.SSS2.p2.1.m1.1.1.1.3.3.cmml" type="integer" xref="A1.SS3.SSS2.p2.1.m1.1.1.1.3.3">1</cn></apply></apply><ci id="A1.SS3.SSS2.p2.1.m1.1.1.3.cmml" xref="A1.SS3.SSS2.p2.1.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS2.p2.1.m1.1c">\{p_{i}\}_{i=1}^{n}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS2.p2.1.m1.1d">{ italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\{q_{i}\}_{i=1}^{n}" class="ltx_Math" display="inline" id="A1.SS3.SSS2.p2.2.m2.1"><semantics id="A1.SS3.SSS2.p2.2.m2.1a"><msubsup id="A1.SS3.SSS2.p2.2.m2.1.1" xref="A1.SS3.SSS2.p2.2.m2.1.1.cmml"><mrow id="A1.SS3.SSS2.p2.2.m2.1.1.1.1.1" xref="A1.SS3.SSS2.p2.2.m2.1.1.1.1.2.cmml"><mo id="A1.SS3.SSS2.p2.2.m2.1.1.1.1.1.2" stretchy="false" xref="A1.SS3.SSS2.p2.2.m2.1.1.1.1.2.cmml">{</mo><msub id="A1.SS3.SSS2.p2.2.m2.1.1.1.1.1.1" xref="A1.SS3.SSS2.p2.2.m2.1.1.1.1.1.1.cmml"><mi id="A1.SS3.SSS2.p2.2.m2.1.1.1.1.1.1.2" xref="A1.SS3.SSS2.p2.2.m2.1.1.1.1.1.1.2.cmml">q</mi><mi id="A1.SS3.SSS2.p2.2.m2.1.1.1.1.1.1.3" xref="A1.SS3.SSS2.p2.2.m2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.SS3.SSS2.p2.2.m2.1.1.1.1.1.3" stretchy="false" xref="A1.SS3.SSS2.p2.2.m2.1.1.1.1.2.cmml">}</mo></mrow><mrow id="A1.SS3.SSS2.p2.2.m2.1.1.1.3" xref="A1.SS3.SSS2.p2.2.m2.1.1.1.3.cmml"><mi id="A1.SS3.SSS2.p2.2.m2.1.1.1.3.2" xref="A1.SS3.SSS2.p2.2.m2.1.1.1.3.2.cmml">i</mi><mo id="A1.SS3.SSS2.p2.2.m2.1.1.1.3.1" xref="A1.SS3.SSS2.p2.2.m2.1.1.1.3.1.cmml">=</mo><mn id="A1.SS3.SSS2.p2.2.m2.1.1.1.3.3" xref="A1.SS3.SSS2.p2.2.m2.1.1.1.3.3.cmml">1</mn></mrow><mi id="A1.SS3.SSS2.p2.2.m2.1.1.3" xref="A1.SS3.SSS2.p2.2.m2.1.1.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS2.p2.2.m2.1b"><apply id="A1.SS3.SSS2.p2.2.m2.1.1.cmml" xref="A1.SS3.SSS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS3.SSS2.p2.2.m2.1.1.2.cmml" xref="A1.SS3.SSS2.p2.2.m2.1.1">superscript</csymbol><apply id="A1.SS3.SSS2.p2.2.m2.1.1.1.cmml" xref="A1.SS3.SSS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS3.SSS2.p2.2.m2.1.1.1.2.cmml" xref="A1.SS3.SSS2.p2.2.m2.1.1">subscript</csymbol><set id="A1.SS3.SSS2.p2.2.m2.1.1.1.1.2.cmml" xref="A1.SS3.SSS2.p2.2.m2.1.1.1.1.1"><apply id="A1.SS3.SSS2.p2.2.m2.1.1.1.1.1.1.cmml" xref="A1.SS3.SSS2.p2.2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS3.SSS2.p2.2.m2.1.1.1.1.1.1.1.cmml" xref="A1.SS3.SSS2.p2.2.m2.1.1.1.1.1.1">subscript</csymbol><ci id="A1.SS3.SSS2.p2.2.m2.1.1.1.1.1.1.2.cmml" xref="A1.SS3.SSS2.p2.2.m2.1.1.1.1.1.1.2">𝑞</ci><ci id="A1.SS3.SSS2.p2.2.m2.1.1.1.1.1.1.3.cmml" xref="A1.SS3.SSS2.p2.2.m2.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="A1.SS3.SSS2.p2.2.m2.1.1.1.3.cmml" xref="A1.SS3.SSS2.p2.2.m2.1.1.1.3"><eq id="A1.SS3.SSS2.p2.2.m2.1.1.1.3.1.cmml" xref="A1.SS3.SSS2.p2.2.m2.1.1.1.3.1"></eq><ci id="A1.SS3.SSS2.p2.2.m2.1.1.1.3.2.cmml" xref="A1.SS3.SSS2.p2.2.m2.1.1.1.3.2">𝑖</ci><cn id="A1.SS3.SSS2.p2.2.m2.1.1.1.3.3.cmml" type="integer" xref="A1.SS3.SSS2.p2.2.m2.1.1.1.3.3">1</cn></apply></apply><ci id="A1.SS3.SSS2.p2.2.m2.1.1.3.cmml" xref="A1.SS3.SSS2.p2.2.m2.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS2.p2.2.m2.1c">\{q_{i}\}_{i=1}^{n}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS2.p2.2.m2.1d">{ italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT</annotation></semantics></math> as the sum of Hellinger distances between corresponding points at each context length:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="D_{traj}(\{p_{i}\},\{q_{i}\})=\sum_{i=1}^{n}D_{\text{Hel}}(p_{i},q_{i})" class="ltx_Math" display="block" id="A1.E10.m1.4"><semantics id="A1.E10.m1.4a"><mrow id="A1.E10.m1.4.4" xref="A1.E10.m1.4.4.cmml"><mrow id="A1.E10.m1.2.2.2" xref="A1.E10.m1.2.2.2.cmml"><msub id="A1.E10.m1.2.2.2.4" xref="A1.E10.m1.2.2.2.4.cmml"><mi id="A1.E10.m1.2.2.2.4.2" xref="A1.E10.m1.2.2.2.4.2.cmml">D</mi><mrow id="A1.E10.m1.2.2.2.4.3" xref="A1.E10.m1.2.2.2.4.3.cmml"><mi id="A1.E10.m1.2.2.2.4.3.2" xref="A1.E10.m1.2.2.2.4.3.2.cmml">t</mi><mo id="A1.E10.m1.2.2.2.4.3.1" xref="A1.E10.m1.2.2.2.4.3.1.cmml">⁢</mo><mi id="A1.E10.m1.2.2.2.4.3.3" xref="A1.E10.m1.2.2.2.4.3.3.cmml">r</mi><mo id="A1.E10.m1.2.2.2.4.3.1a" xref="A1.E10.m1.2.2.2.4.3.1.cmml">⁢</mo><mi id="A1.E10.m1.2.2.2.4.3.4" xref="A1.E10.m1.2.2.2.4.3.4.cmml">a</mi><mo id="A1.E10.m1.2.2.2.4.3.1b" xref="A1.E10.m1.2.2.2.4.3.1.cmml">⁢</mo><mi id="A1.E10.m1.2.2.2.4.3.5" xref="A1.E10.m1.2.2.2.4.3.5.cmml">j</mi></mrow></msub><mo id="A1.E10.m1.2.2.2.3" xref="A1.E10.m1.2.2.2.3.cmml">⁢</mo><mrow id="A1.E10.m1.2.2.2.2.2" xref="A1.E10.m1.2.2.2.2.3.cmml"><mo id="A1.E10.m1.2.2.2.2.2.3" stretchy="false" xref="A1.E10.m1.2.2.2.2.3.cmml">(</mo><mrow id="A1.E10.m1.1.1.1.1.1.1.1" xref="A1.E10.m1.1.1.1.1.1.1.2.cmml"><mo id="A1.E10.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E10.m1.1.1.1.1.1.1.2.cmml">{</mo><msub id="A1.E10.m1.1.1.1.1.1.1.1.1" xref="A1.E10.m1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E10.m1.1.1.1.1.1.1.1.1.2" xref="A1.E10.m1.1.1.1.1.1.1.1.1.2.cmml">p</mi><mi id="A1.E10.m1.1.1.1.1.1.1.1.1.3" xref="A1.E10.m1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.E10.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E10.m1.1.1.1.1.1.1.2.cmml">}</mo></mrow><mo id="A1.E10.m1.2.2.2.2.2.4" xref="A1.E10.m1.2.2.2.2.3.cmml">,</mo><mrow id="A1.E10.m1.2.2.2.2.2.2.1" xref="A1.E10.m1.2.2.2.2.2.2.2.cmml"><mo id="A1.E10.m1.2.2.2.2.2.2.1.2" stretchy="false" xref="A1.E10.m1.2.2.2.2.2.2.2.cmml">{</mo><msub id="A1.E10.m1.2.2.2.2.2.2.1.1" xref="A1.E10.m1.2.2.2.2.2.2.1.1.cmml"><mi id="A1.E10.m1.2.2.2.2.2.2.1.1.2" xref="A1.E10.m1.2.2.2.2.2.2.1.1.2.cmml">q</mi><mi id="A1.E10.m1.2.2.2.2.2.2.1.1.3" xref="A1.E10.m1.2.2.2.2.2.2.1.1.3.cmml">i</mi></msub><mo id="A1.E10.m1.2.2.2.2.2.2.1.3" stretchy="false" xref="A1.E10.m1.2.2.2.2.2.2.2.cmml">}</mo></mrow><mo id="A1.E10.m1.2.2.2.2.2.5" stretchy="false" xref="A1.E10.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="A1.E10.m1.4.4.5" rspace="0.111em" xref="A1.E10.m1.4.4.5.cmml">=</mo><mrow id="A1.E10.m1.4.4.4" xref="A1.E10.m1.4.4.4.cmml"><munderover id="A1.E10.m1.4.4.4.3" xref="A1.E10.m1.4.4.4.3.cmml"><mo id="A1.E10.m1.4.4.4.3.2.2" movablelimits="false" xref="A1.E10.m1.4.4.4.3.2.2.cmml">∑</mo><mrow id="A1.E10.m1.4.4.4.3.2.3" xref="A1.E10.m1.4.4.4.3.2.3.cmml"><mi id="A1.E10.m1.4.4.4.3.2.3.2" xref="A1.E10.m1.4.4.4.3.2.3.2.cmml">i</mi><mo id="A1.E10.m1.4.4.4.3.2.3.1" xref="A1.E10.m1.4.4.4.3.2.3.1.cmml">=</mo><mn id="A1.E10.m1.4.4.4.3.2.3.3" xref="A1.E10.m1.4.4.4.3.2.3.3.cmml">1</mn></mrow><mi id="A1.E10.m1.4.4.4.3.3" xref="A1.E10.m1.4.4.4.3.3.cmml">n</mi></munderover><mrow id="A1.E10.m1.4.4.4.2" xref="A1.E10.m1.4.4.4.2.cmml"><msub id="A1.E10.m1.4.4.4.2.4" xref="A1.E10.m1.4.4.4.2.4.cmml"><mi id="A1.E10.m1.4.4.4.2.4.2" xref="A1.E10.m1.4.4.4.2.4.2.cmml">D</mi><mtext id="A1.E10.m1.4.4.4.2.4.3" xref="A1.E10.m1.4.4.4.2.4.3a.cmml">Hel</mtext></msub><mo id="A1.E10.m1.4.4.4.2.3" xref="A1.E10.m1.4.4.4.2.3.cmml">⁢</mo><mrow id="A1.E10.m1.4.4.4.2.2.2" xref="A1.E10.m1.4.4.4.2.2.3.cmml"><mo id="A1.E10.m1.4.4.4.2.2.2.3" stretchy="false" xref="A1.E10.m1.4.4.4.2.2.3.cmml">(</mo><msub id="A1.E10.m1.3.3.3.1.1.1.1" xref="A1.E10.m1.3.3.3.1.1.1.1.cmml"><mi id="A1.E10.m1.3.3.3.1.1.1.1.2" xref="A1.E10.m1.3.3.3.1.1.1.1.2.cmml">p</mi><mi id="A1.E10.m1.3.3.3.1.1.1.1.3" xref="A1.E10.m1.3.3.3.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.E10.m1.4.4.4.2.2.2.4" xref="A1.E10.m1.4.4.4.2.2.3.cmml">,</mo><msub id="A1.E10.m1.4.4.4.2.2.2.2" xref="A1.E10.m1.4.4.4.2.2.2.2.cmml"><mi id="A1.E10.m1.4.4.4.2.2.2.2.2" xref="A1.E10.m1.4.4.4.2.2.2.2.2.cmml">q</mi><mi id="A1.E10.m1.4.4.4.2.2.2.2.3" xref="A1.E10.m1.4.4.4.2.2.2.2.3.cmml">i</mi></msub><mo id="A1.E10.m1.4.4.4.2.2.2.5" stretchy="false" xref="A1.E10.m1.4.4.4.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E10.m1.4b"><apply id="A1.E10.m1.4.4.cmml" xref="A1.E10.m1.4.4"><eq id="A1.E10.m1.4.4.5.cmml" xref="A1.E10.m1.4.4.5"></eq><apply id="A1.E10.m1.2.2.2.cmml" xref="A1.E10.m1.2.2.2"><times id="A1.E10.m1.2.2.2.3.cmml" xref="A1.E10.m1.2.2.2.3"></times><apply id="A1.E10.m1.2.2.2.4.cmml" xref="A1.E10.m1.2.2.2.4"><csymbol cd="ambiguous" id="A1.E10.m1.2.2.2.4.1.cmml" xref="A1.E10.m1.2.2.2.4">subscript</csymbol><ci id="A1.E10.m1.2.2.2.4.2.cmml" xref="A1.E10.m1.2.2.2.4.2">𝐷</ci><apply id="A1.E10.m1.2.2.2.4.3.cmml" xref="A1.E10.m1.2.2.2.4.3"><times id="A1.E10.m1.2.2.2.4.3.1.cmml" xref="A1.E10.m1.2.2.2.4.3.1"></times><ci id="A1.E10.m1.2.2.2.4.3.2.cmml" xref="A1.E10.m1.2.2.2.4.3.2">𝑡</ci><ci id="A1.E10.m1.2.2.2.4.3.3.cmml" xref="A1.E10.m1.2.2.2.4.3.3">𝑟</ci><ci id="A1.E10.m1.2.2.2.4.3.4.cmml" xref="A1.E10.m1.2.2.2.4.3.4">𝑎</ci><ci id="A1.E10.m1.2.2.2.4.3.5.cmml" xref="A1.E10.m1.2.2.2.4.3.5">𝑗</ci></apply></apply><interval closure="open" id="A1.E10.m1.2.2.2.2.3.cmml" xref="A1.E10.m1.2.2.2.2.2"><set id="A1.E10.m1.1.1.1.1.1.1.2.cmml" xref="A1.E10.m1.1.1.1.1.1.1.1"><apply id="A1.E10.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.E10.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E10.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E10.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E10.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E10.m1.1.1.1.1.1.1.1.1.2">𝑝</ci><ci id="A1.E10.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E10.m1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><set id="A1.E10.m1.2.2.2.2.2.2.2.cmml" xref="A1.E10.m1.2.2.2.2.2.2.1"><apply id="A1.E10.m1.2.2.2.2.2.2.1.1.cmml" xref="A1.E10.m1.2.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="A1.E10.m1.2.2.2.2.2.2.1.1.1.cmml" xref="A1.E10.m1.2.2.2.2.2.2.1.1">subscript</csymbol><ci id="A1.E10.m1.2.2.2.2.2.2.1.1.2.cmml" xref="A1.E10.m1.2.2.2.2.2.2.1.1.2">𝑞</ci><ci id="A1.E10.m1.2.2.2.2.2.2.1.1.3.cmml" xref="A1.E10.m1.2.2.2.2.2.2.1.1.3">𝑖</ci></apply></set></interval></apply><apply id="A1.E10.m1.4.4.4.cmml" xref="A1.E10.m1.4.4.4"><apply id="A1.E10.m1.4.4.4.3.cmml" xref="A1.E10.m1.4.4.4.3"><csymbol cd="ambiguous" id="A1.E10.m1.4.4.4.3.1.cmml" xref="A1.E10.m1.4.4.4.3">superscript</csymbol><apply id="A1.E10.m1.4.4.4.3.2.cmml" xref="A1.E10.m1.4.4.4.3"><csymbol cd="ambiguous" id="A1.E10.m1.4.4.4.3.2.1.cmml" xref="A1.E10.m1.4.4.4.3">subscript</csymbol><sum id="A1.E10.m1.4.4.4.3.2.2.cmml" xref="A1.E10.m1.4.4.4.3.2.2"></sum><apply id="A1.E10.m1.4.4.4.3.2.3.cmml" xref="A1.E10.m1.4.4.4.3.2.3"><eq id="A1.E10.m1.4.4.4.3.2.3.1.cmml" xref="A1.E10.m1.4.4.4.3.2.3.1"></eq><ci id="A1.E10.m1.4.4.4.3.2.3.2.cmml" xref="A1.E10.m1.4.4.4.3.2.3.2">𝑖</ci><cn id="A1.E10.m1.4.4.4.3.2.3.3.cmml" type="integer" xref="A1.E10.m1.4.4.4.3.2.3.3">1</cn></apply></apply><ci id="A1.E10.m1.4.4.4.3.3.cmml" xref="A1.E10.m1.4.4.4.3.3">𝑛</ci></apply><apply id="A1.E10.m1.4.4.4.2.cmml" xref="A1.E10.m1.4.4.4.2"><times id="A1.E10.m1.4.4.4.2.3.cmml" xref="A1.E10.m1.4.4.4.2.3"></times><apply id="A1.E10.m1.4.4.4.2.4.cmml" xref="A1.E10.m1.4.4.4.2.4"><csymbol cd="ambiguous" id="A1.E10.m1.4.4.4.2.4.1.cmml" xref="A1.E10.m1.4.4.4.2.4">subscript</csymbol><ci id="A1.E10.m1.4.4.4.2.4.2.cmml" xref="A1.E10.m1.4.4.4.2.4.2">𝐷</ci><ci id="A1.E10.m1.4.4.4.2.4.3a.cmml" xref="A1.E10.m1.4.4.4.2.4.3"><mtext id="A1.E10.m1.4.4.4.2.4.3.cmml" mathsize="70%" xref="A1.E10.m1.4.4.4.2.4.3">Hel</mtext></ci></apply><interval closure="open" id="A1.E10.m1.4.4.4.2.2.3.cmml" xref="A1.E10.m1.4.4.4.2.2.2"><apply id="A1.E10.m1.3.3.3.1.1.1.1.cmml" xref="A1.E10.m1.3.3.3.1.1.1.1"><csymbol cd="ambiguous" id="A1.E10.m1.3.3.3.1.1.1.1.1.cmml" xref="A1.E10.m1.3.3.3.1.1.1.1">subscript</csymbol><ci id="A1.E10.m1.3.3.3.1.1.1.1.2.cmml" xref="A1.E10.m1.3.3.3.1.1.1.1.2">𝑝</ci><ci id="A1.E10.m1.3.3.3.1.1.1.1.3.cmml" xref="A1.E10.m1.3.3.3.1.1.1.1.3">𝑖</ci></apply><apply id="A1.E10.m1.4.4.4.2.2.2.2.cmml" xref="A1.E10.m1.4.4.4.2.2.2.2"><csymbol cd="ambiguous" id="A1.E10.m1.4.4.4.2.2.2.2.1.cmml" xref="A1.E10.m1.4.4.4.2.2.2.2">subscript</csymbol><ci id="A1.E10.m1.4.4.4.2.2.2.2.2.cmml" xref="A1.E10.m1.4.4.4.2.2.2.2.2">𝑞</ci><ci id="A1.E10.m1.4.4.4.2.2.2.2.3.cmml" xref="A1.E10.m1.4.4.4.2.2.2.2.3">𝑖</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E10.m1.4c">D_{traj}(\{p_{i}\},\{q_{i}\})=\sum_{i=1}^{n}D_{\text{Hel}}(p_{i},q_{i})</annotation><annotation encoding="application/x-llamapun" id="A1.E10.m1.4d">italic_D start_POSTSUBSCRIPT italic_t italic_r italic_a italic_j end_POSTSUBSCRIPT ( { italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } , { italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } ) = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_D start_POSTSUBSCRIPT Hel end_POSTSUBSCRIPT ( italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS3.SSS2.p2.3">where <math alttext="D_{\text{Hel}}" class="ltx_Math" display="inline" id="A1.SS3.SSS2.p2.3.m1.1"><semantics id="A1.SS3.SSS2.p2.3.m1.1a"><msub id="A1.SS3.SSS2.p2.3.m1.1.1" xref="A1.SS3.SSS2.p2.3.m1.1.1.cmml"><mi id="A1.SS3.SSS2.p2.3.m1.1.1.2" xref="A1.SS3.SSS2.p2.3.m1.1.1.2.cmml">D</mi><mtext id="A1.SS3.SSS2.p2.3.m1.1.1.3" xref="A1.SS3.SSS2.p2.3.m1.1.1.3a.cmml">Hel</mtext></msub><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS2.p2.3.m1.1b"><apply id="A1.SS3.SSS2.p2.3.m1.1.1.cmml" xref="A1.SS3.SSS2.p2.3.m1.1.1"><csymbol cd="ambiguous" id="A1.SS3.SSS2.p2.3.m1.1.1.1.cmml" xref="A1.SS3.SSS2.p2.3.m1.1.1">subscript</csymbol><ci id="A1.SS3.SSS2.p2.3.m1.1.1.2.cmml" xref="A1.SS3.SSS2.p2.3.m1.1.1.2">𝐷</ci><ci id="A1.SS3.SSS2.p2.3.m1.1.1.3a.cmml" xref="A1.SS3.SSS2.p2.3.m1.1.1.3"><mtext id="A1.SS3.SSS2.p2.3.m1.1.1.3.cmml" mathsize="70%" xref="A1.SS3.SSS2.p2.3.m1.1.1.3">Hel</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS2.p2.3.m1.1c">D_{\text{Hel}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS2.p2.3.m1.1d">italic_D start_POSTSUBSCRIPT Hel end_POSTSUBSCRIPT</annotation></semantics></math> is the Hellinger distance defined in Equation <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#S3.E2" title="Equation 2 ‣ 3.1 InPCA visualization ‣ 3 Methodology ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS3.SSS2.p3">
<p class="ltx_p" id="A1.SS3.SSS2.p3.2"><span class="ltx_text ltx_font_bold" id="A1.SS3.SSS2.p3.2.1">Meta-InPCA procedure.</span>
Given a set of trajectories <math alttext="\text{traj}_{1},...,\text{traj}_{l}" class="ltx_Math" display="inline" id="A1.SS3.SSS2.p3.1.m1.3"><semantics id="A1.SS3.SSS2.p3.1.m1.3a"><mrow id="A1.SS3.SSS2.p3.1.m1.3.3.2" xref="A1.SS3.SSS2.p3.1.m1.3.3.3.cmml"><msub id="A1.SS3.SSS2.p3.1.m1.2.2.1.1" xref="A1.SS3.SSS2.p3.1.m1.2.2.1.1.cmml"><mtext id="A1.SS3.SSS2.p3.1.m1.2.2.1.1.2" xref="A1.SS3.SSS2.p3.1.m1.2.2.1.1.2a.cmml">traj</mtext><mn id="A1.SS3.SSS2.p3.1.m1.2.2.1.1.3" xref="A1.SS3.SSS2.p3.1.m1.2.2.1.1.3.cmml">1</mn></msub><mo id="A1.SS3.SSS2.p3.1.m1.3.3.2.3" xref="A1.SS3.SSS2.p3.1.m1.3.3.3.cmml">,</mo><mi id="A1.SS3.SSS2.p3.1.m1.1.1" mathvariant="normal" xref="A1.SS3.SSS2.p3.1.m1.1.1.cmml">…</mi><mo id="A1.SS3.SSS2.p3.1.m1.3.3.2.4" xref="A1.SS3.SSS2.p3.1.m1.3.3.3.cmml">,</mo><msub id="A1.SS3.SSS2.p3.1.m1.3.3.2.2" xref="A1.SS3.SSS2.p3.1.m1.3.3.2.2.cmml"><mtext id="A1.SS3.SSS2.p3.1.m1.3.3.2.2.2" xref="A1.SS3.SSS2.p3.1.m1.3.3.2.2.2a.cmml">traj</mtext><mi id="A1.SS3.SSS2.p3.1.m1.3.3.2.2.3" xref="A1.SS3.SSS2.p3.1.m1.3.3.2.2.3.cmml">l</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS2.p3.1.m1.3b"><list id="A1.SS3.SSS2.p3.1.m1.3.3.3.cmml" xref="A1.SS3.SSS2.p3.1.m1.3.3.2"><apply id="A1.SS3.SSS2.p3.1.m1.2.2.1.1.cmml" xref="A1.SS3.SSS2.p3.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="A1.SS3.SSS2.p3.1.m1.2.2.1.1.1.cmml" xref="A1.SS3.SSS2.p3.1.m1.2.2.1.1">subscript</csymbol><ci id="A1.SS3.SSS2.p3.1.m1.2.2.1.1.2a.cmml" xref="A1.SS3.SSS2.p3.1.m1.2.2.1.1.2"><mtext id="A1.SS3.SSS2.p3.1.m1.2.2.1.1.2.cmml" xref="A1.SS3.SSS2.p3.1.m1.2.2.1.1.2">traj</mtext></ci><cn id="A1.SS3.SSS2.p3.1.m1.2.2.1.1.3.cmml" type="integer" xref="A1.SS3.SSS2.p3.1.m1.2.2.1.1.3">1</cn></apply><ci id="A1.SS3.SSS2.p3.1.m1.1.1.cmml" xref="A1.SS3.SSS2.p3.1.m1.1.1">…</ci><apply id="A1.SS3.SSS2.p3.1.m1.3.3.2.2.cmml" xref="A1.SS3.SSS2.p3.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="A1.SS3.SSS2.p3.1.m1.3.3.2.2.1.cmml" xref="A1.SS3.SSS2.p3.1.m1.3.3.2.2">subscript</csymbol><ci id="A1.SS3.SSS2.p3.1.m1.3.3.2.2.2a.cmml" xref="A1.SS3.SSS2.p3.1.m1.3.3.2.2.2"><mtext id="A1.SS3.SSS2.p3.1.m1.3.3.2.2.2.cmml" xref="A1.SS3.SSS2.p3.1.m1.3.3.2.2.2">traj</mtext></ci><ci id="A1.SS3.SSS2.p3.1.m1.3.3.2.2.3.cmml" xref="A1.SS3.SSS2.p3.1.m1.3.3.2.2.3">𝑙</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS2.p3.1.m1.3c">\text{traj}_{1},...,\text{traj}_{l}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS2.p3.1.m1.3d">traj start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , traj start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math>, we:
1. Compute the pairwise trajectory distance matrix <math alttext="D\in\mathbb{R}^{l\times l}" class="ltx_Math" display="inline" id="A1.SS3.SSS2.p3.2.m2.1"><semantics id="A1.SS3.SSS2.p3.2.m2.1a"><mrow id="A1.SS3.SSS2.p3.2.m2.1.1" xref="A1.SS3.SSS2.p3.2.m2.1.1.cmml"><mi id="A1.SS3.SSS2.p3.2.m2.1.1.2" xref="A1.SS3.SSS2.p3.2.m2.1.1.2.cmml">D</mi><mo id="A1.SS3.SSS2.p3.2.m2.1.1.1" xref="A1.SS3.SSS2.p3.2.m2.1.1.1.cmml">∈</mo><msup id="A1.SS3.SSS2.p3.2.m2.1.1.3" xref="A1.SS3.SSS2.p3.2.m2.1.1.3.cmml"><mi id="A1.SS3.SSS2.p3.2.m2.1.1.3.2" xref="A1.SS3.SSS2.p3.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="A1.SS3.SSS2.p3.2.m2.1.1.3.3" xref="A1.SS3.SSS2.p3.2.m2.1.1.3.3.cmml"><mi id="A1.SS3.SSS2.p3.2.m2.1.1.3.3.2" xref="A1.SS3.SSS2.p3.2.m2.1.1.3.3.2.cmml">l</mi><mo id="A1.SS3.SSS2.p3.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="A1.SS3.SSS2.p3.2.m2.1.1.3.3.1.cmml">×</mo><mi id="A1.SS3.SSS2.p3.2.m2.1.1.3.3.3" xref="A1.SS3.SSS2.p3.2.m2.1.1.3.3.3.cmml">l</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS2.p3.2.m2.1b"><apply id="A1.SS3.SSS2.p3.2.m2.1.1.cmml" xref="A1.SS3.SSS2.p3.2.m2.1.1"><in id="A1.SS3.SSS2.p3.2.m2.1.1.1.cmml" xref="A1.SS3.SSS2.p3.2.m2.1.1.1"></in><ci id="A1.SS3.SSS2.p3.2.m2.1.1.2.cmml" xref="A1.SS3.SSS2.p3.2.m2.1.1.2">𝐷</ci><apply id="A1.SS3.SSS2.p3.2.m2.1.1.3.cmml" xref="A1.SS3.SSS2.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="A1.SS3.SSS2.p3.2.m2.1.1.3.1.cmml" xref="A1.SS3.SSS2.p3.2.m2.1.1.3">superscript</csymbol><ci id="A1.SS3.SSS2.p3.2.m2.1.1.3.2.cmml" xref="A1.SS3.SSS2.p3.2.m2.1.1.3.2">ℝ</ci><apply id="A1.SS3.SSS2.p3.2.m2.1.1.3.3.cmml" xref="A1.SS3.SSS2.p3.2.m2.1.1.3.3"><times id="A1.SS3.SSS2.p3.2.m2.1.1.3.3.1.cmml" xref="A1.SS3.SSS2.p3.2.m2.1.1.3.3.1"></times><ci id="A1.SS3.SSS2.p3.2.m2.1.1.3.3.2.cmml" xref="A1.SS3.SSS2.p3.2.m2.1.1.3.3.2">𝑙</ci><ci id="A1.SS3.SSS2.p3.2.m2.1.1.3.3.3.cmml" xref="A1.SS3.SSS2.p3.2.m2.1.1.3.3.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS2.p3.2.m2.1c">D\in\mathbb{R}^{l\times l}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS2.p3.2.m2.1d">italic_D ∈ blackboard_R start_POSTSUPERSCRIPT italic_l × italic_l end_POSTSUPERSCRIPT</annotation></semantics></math> using Equation <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.E10" title="Equation 10 ‣ A.3.2 Meta-InPCA Embedding of Trajectories ‣ A.3 Bespoke KDE cannot imitate all DE processes ‣ Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">10</span></a>.
2. Apply the InPCA procedure described in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#S3.SS1" title="3.1 InPCA visualization ‣ 3 Methodology ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">3.1</span></a> to embed these trajectories in a lower-dimensional space.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS3.SSS2.p4">
<p class="ltx_p" id="A1.SS3.SSS2.p4.1">Unlike previous InPCA visualizations where each point represented a single PDF, in this meta-embedding, each point represents an entire DE trajectory.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS3.SSS2.p5">
<p class="ltx_p" id="A1.SS3.SSS2.p5.1"><span class="ltx_text ltx_font_bold" id="A1.SS3.SSS2.p5.1.1">Observations.</span>
Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.F11" title="Figure 11 ‣ A.3.2 Meta-InPCA Embedding of Trajectories ‣ A.3 Bespoke KDE cannot imitate all DE processes ‣ Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">11</span></a> reveals several key insights:
1. The Bayesian histogram and its bespoke KDE imitation are far apart, confirming the model’s inability to capture this approach.
2. Gaussian KDE almost exactly overlaps with its bespoke KDE imitation, as expected.
3. LLaMA-2 models (7b, 13b, 70b) are relatively close to their bespoke KDE counterparts but do not overlap exactly.
These observations suggest that while the 2-parameter bespoke KDE model captures much of LLaMA-2’s in-context DE behavior,
there are still certain nuances in LLaMA-2’s algorithm that it doesn’t fully encapsulate.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
<section class="ltx_subsection" id="A1.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.4 </span>Comparison of InPCA and standard PCA</h3>
<figure class="ltx_figure" id="A1.F12"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="816" id="A1.F12.g1" src="x3.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 12: </span>Comparison of InPCA and PCA visualizations for density estimation trajectories of LLaMA-2 models.
(a) 2D InPCA embedding preserves 91% of pairwise Hellinger distances, revealing LLaMA’s DE trajectories
geometrically bounded between the geodesic and Gaussian submanifold.
(b) In contrast, 2D PCA preserves only 83% of pairwise L2 distances, displaying erratic oscillations
in LLaMA’s DE trajectories without clear geometric relationships.</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_subsection" id="A1.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.5 </span>Additional notes on Kernel Density Estimation</h3>
<div class="ltx_para ltx_noindent" id="A1.SS5.p1">
<p class="ltx_p" id="A1.SS5.p1.1">This section provides more background on classical results regarding optimal bandwidth schedules <math alttext="\{h_{i}\}_{i=1}^{n}" class="ltx_Math" display="inline" id="A1.SS5.p1.1.m1.1"><semantics id="A1.SS5.p1.1.m1.1a"><msubsup id="A1.SS5.p1.1.m1.1.1" xref="A1.SS5.p1.1.m1.1.1.cmml"><mrow id="A1.SS5.p1.1.m1.1.1.1.1.1" xref="A1.SS5.p1.1.m1.1.1.1.1.2.cmml"><mo id="A1.SS5.p1.1.m1.1.1.1.1.1.2" stretchy="false" xref="A1.SS5.p1.1.m1.1.1.1.1.2.cmml">{</mo><msub id="A1.SS5.p1.1.m1.1.1.1.1.1.1" xref="A1.SS5.p1.1.m1.1.1.1.1.1.1.cmml"><mi id="A1.SS5.p1.1.m1.1.1.1.1.1.1.2" xref="A1.SS5.p1.1.m1.1.1.1.1.1.1.2.cmml">h</mi><mi id="A1.SS5.p1.1.m1.1.1.1.1.1.1.3" xref="A1.SS5.p1.1.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.SS5.p1.1.m1.1.1.1.1.1.3" stretchy="false" xref="A1.SS5.p1.1.m1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="A1.SS5.p1.1.m1.1.1.1.3" xref="A1.SS5.p1.1.m1.1.1.1.3.cmml"><mi id="A1.SS5.p1.1.m1.1.1.1.3.2" xref="A1.SS5.p1.1.m1.1.1.1.3.2.cmml">i</mi><mo id="A1.SS5.p1.1.m1.1.1.1.3.1" xref="A1.SS5.p1.1.m1.1.1.1.3.1.cmml">=</mo><mn id="A1.SS5.p1.1.m1.1.1.1.3.3" xref="A1.SS5.p1.1.m1.1.1.1.3.3.cmml">1</mn></mrow><mi id="A1.SS5.p1.1.m1.1.1.3" xref="A1.SS5.p1.1.m1.1.1.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS5.p1.1.m1.1b"><apply id="A1.SS5.p1.1.m1.1.1.cmml" xref="A1.SS5.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS5.p1.1.m1.1.1.2.cmml" xref="A1.SS5.p1.1.m1.1.1">superscript</csymbol><apply id="A1.SS5.p1.1.m1.1.1.1.cmml" xref="A1.SS5.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS5.p1.1.m1.1.1.1.2.cmml" xref="A1.SS5.p1.1.m1.1.1">subscript</csymbol><set id="A1.SS5.p1.1.m1.1.1.1.1.2.cmml" xref="A1.SS5.p1.1.m1.1.1.1.1.1"><apply id="A1.SS5.p1.1.m1.1.1.1.1.1.1.cmml" xref="A1.SS5.p1.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS5.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="A1.SS5.p1.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.SS5.p1.1.m1.1.1.1.1.1.1.2.cmml" xref="A1.SS5.p1.1.m1.1.1.1.1.1.1.2">ℎ</ci><ci id="A1.SS5.p1.1.m1.1.1.1.1.1.1.3.cmml" xref="A1.SS5.p1.1.m1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="A1.SS5.p1.1.m1.1.1.1.3.cmml" xref="A1.SS5.p1.1.m1.1.1.1.3"><eq id="A1.SS5.p1.1.m1.1.1.1.3.1.cmml" xref="A1.SS5.p1.1.m1.1.1.1.3.1"></eq><ci id="A1.SS5.p1.1.m1.1.1.1.3.2.cmml" xref="A1.SS5.p1.1.m1.1.1.1.3.2">𝑖</ci><cn id="A1.SS5.p1.1.m1.1.1.1.3.3.cmml" type="integer" xref="A1.SS5.p1.1.m1.1.1.1.3.3">1</cn></apply></apply><ci id="A1.SS5.p1.1.m1.1.1.3.cmml" xref="A1.SS5.p1.1.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.p1.1.m1.1c">\{h_{i}\}_{i=1}^{n}</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.p1.1.m1.1d">{ italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT</annotation></semantics></math> and kernel shapes.
These results are derived by minimizing the Mean Integrated Squared Error (MISE) <cite class="ltx_cite ltx_citemacro_citep">(Wand &amp; Jones, <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib41" title="">1994</a>, Chapter 2.3)</cite>:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{MISE}(p|\hat{p}_{h})=\mathbb{E}_{x\sim p}\left[\int(\hat{p}_{h}(x)-p(x))%
^{2}\,\textup{d}x\right]," class="ltx_Math" display="block" id="A1.E11.m1.3"><semantics id="A1.E11.m1.3a"><mrow id="A1.E11.m1.3.3.1" xref="A1.E11.m1.3.3.1.1.cmml"><mrow id="A1.E11.m1.3.3.1.1" xref="A1.E11.m1.3.3.1.1.cmml"><mrow id="A1.E11.m1.3.3.1.1.1" xref="A1.E11.m1.3.3.1.1.1.cmml"><mtext id="A1.E11.m1.3.3.1.1.1.3" xref="A1.E11.m1.3.3.1.1.1.3a.cmml">MISE</mtext><mo id="A1.E11.m1.3.3.1.1.1.2" xref="A1.E11.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="A1.E11.m1.3.3.1.1.1.1.1" xref="A1.E11.m1.3.3.1.1.1.1.1.1.cmml"><mo id="A1.E11.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="A1.E11.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E11.m1.3.3.1.1.1.1.1.1" xref="A1.E11.m1.3.3.1.1.1.1.1.1.cmml"><mi id="A1.E11.m1.3.3.1.1.1.1.1.1.2" xref="A1.E11.m1.3.3.1.1.1.1.1.1.2.cmml">p</mi><mo fence="false" id="A1.E11.m1.3.3.1.1.1.1.1.1.1" xref="A1.E11.m1.3.3.1.1.1.1.1.1.1.cmml">|</mo><msub id="A1.E11.m1.3.3.1.1.1.1.1.1.3" xref="A1.E11.m1.3.3.1.1.1.1.1.1.3.cmml"><mover accent="true" id="A1.E11.m1.3.3.1.1.1.1.1.1.3.2" xref="A1.E11.m1.3.3.1.1.1.1.1.1.3.2.cmml"><mi id="A1.E11.m1.3.3.1.1.1.1.1.1.3.2.2" xref="A1.E11.m1.3.3.1.1.1.1.1.1.3.2.2.cmml">p</mi><mo id="A1.E11.m1.3.3.1.1.1.1.1.1.3.2.1" xref="A1.E11.m1.3.3.1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="A1.E11.m1.3.3.1.1.1.1.1.1.3.3" xref="A1.E11.m1.3.3.1.1.1.1.1.1.3.3.cmml">h</mi></msub></mrow><mo id="A1.E11.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="A1.E11.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E11.m1.3.3.1.1.3" xref="A1.E11.m1.3.3.1.1.3.cmml">=</mo><mrow id="A1.E11.m1.3.3.1.1.2" xref="A1.E11.m1.3.3.1.1.2.cmml"><msub id="A1.E11.m1.3.3.1.1.2.3" xref="A1.E11.m1.3.3.1.1.2.3.cmml"><mi id="A1.E11.m1.3.3.1.1.2.3.2" xref="A1.E11.m1.3.3.1.1.2.3.2.cmml">𝔼</mi><mrow id="A1.E11.m1.3.3.1.1.2.3.3" xref="A1.E11.m1.3.3.1.1.2.3.3.cmml"><mi id="A1.E11.m1.3.3.1.1.2.3.3.2" xref="A1.E11.m1.3.3.1.1.2.3.3.2.cmml">x</mi><mo id="A1.E11.m1.3.3.1.1.2.3.3.1" xref="A1.E11.m1.3.3.1.1.2.3.3.1.cmml">∼</mo><mi id="A1.E11.m1.3.3.1.1.2.3.3.3" xref="A1.E11.m1.3.3.1.1.2.3.3.3.cmml">p</mi></mrow></msub><mo id="A1.E11.m1.3.3.1.1.2.2" xref="A1.E11.m1.3.3.1.1.2.2.cmml">⁢</mo><mrow id="A1.E11.m1.3.3.1.1.2.1.1" xref="A1.E11.m1.3.3.1.1.2.1.2.cmml"><mo id="A1.E11.m1.3.3.1.1.2.1.1.2" xref="A1.E11.m1.3.3.1.1.2.1.2.1.cmml">[</mo><mrow id="A1.E11.m1.3.3.1.1.2.1.1.1" xref="A1.E11.m1.3.3.1.1.2.1.1.1.cmml"><mo id="A1.E11.m1.3.3.1.1.2.1.1.1.2" lspace="0em" rspace="0em" xref="A1.E11.m1.3.3.1.1.2.1.1.1.2.cmml">∫</mo><mrow id="A1.E11.m1.3.3.1.1.2.1.1.1.1" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1.cmml"><msup id="A1.E11.m1.3.3.1.1.2.1.1.1.1.1" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.cmml"><mrow id="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.cmml"><mrow id="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2.cmml"><msub id="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2.2" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2.2.cmml"><mover accent="true" id="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2.2.2" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2.cmml">p</mi><mo id="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2.2.2.1" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2.2.2.1.cmml">^</mo></mover><mi id="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2.2.3" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2.2.3.cmml">h</mi></msub><mo id="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2.1" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2.3.2" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2.cmml"><mo id="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2.3.2.1" stretchy="false" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="A1.E11.m1.1.1" xref="A1.E11.m1.1.1.cmml">x</mi><mo id="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2.3.2.2" stretchy="false" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.3" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.3.2" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.3.2.cmml">p</mi><mo id="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.3.1" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.3.3.2" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.3.cmml"><mo id="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.3.3.2.1" stretchy="false" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.3.cmml">(</mo><mi id="A1.E11.m1.2.2" xref="A1.E11.m1.2.2.cmml">x</mi><mo id="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.3.3.2.2" stretchy="false" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.3" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.3.cmml">2</mn></msup><mo id="A1.E11.m1.3.3.1.1.2.1.1.1.1.2" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1.2.cmml">⁢</mo><mtext id="A1.E11.m1.3.3.1.1.2.1.1.1.1.3" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1.3a.cmml">d</mtext><mo id="A1.E11.m1.3.3.1.1.2.1.1.1.1.2a" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1.2.cmml">⁢</mo><mi id="A1.E11.m1.3.3.1.1.2.1.1.1.1.4" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1.4.cmml">x</mi></mrow></mrow><mo id="A1.E11.m1.3.3.1.1.2.1.1.3" xref="A1.E11.m1.3.3.1.1.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="A1.E11.m1.3.3.1.2" xref="A1.E11.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E11.m1.3b"><apply id="A1.E11.m1.3.3.1.1.cmml" xref="A1.E11.m1.3.3.1"><eq id="A1.E11.m1.3.3.1.1.3.cmml" xref="A1.E11.m1.3.3.1.1.3"></eq><apply id="A1.E11.m1.3.3.1.1.1.cmml" xref="A1.E11.m1.3.3.1.1.1"><times id="A1.E11.m1.3.3.1.1.1.2.cmml" xref="A1.E11.m1.3.3.1.1.1.2"></times><ci id="A1.E11.m1.3.3.1.1.1.3a.cmml" xref="A1.E11.m1.3.3.1.1.1.3"><mtext id="A1.E11.m1.3.3.1.1.1.3.cmml" xref="A1.E11.m1.3.3.1.1.1.3">MISE</mtext></ci><apply id="A1.E11.m1.3.3.1.1.1.1.1.1.cmml" xref="A1.E11.m1.3.3.1.1.1.1.1"><csymbol cd="latexml" id="A1.E11.m1.3.3.1.1.1.1.1.1.1.cmml" xref="A1.E11.m1.3.3.1.1.1.1.1.1.1">conditional</csymbol><ci id="A1.E11.m1.3.3.1.1.1.1.1.1.2.cmml" xref="A1.E11.m1.3.3.1.1.1.1.1.1.2">𝑝</ci><apply id="A1.E11.m1.3.3.1.1.1.1.1.1.3.cmml" xref="A1.E11.m1.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E11.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="A1.E11.m1.3.3.1.1.1.1.1.1.3">subscript</csymbol><apply id="A1.E11.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="A1.E11.m1.3.3.1.1.1.1.1.1.3.2"><ci id="A1.E11.m1.3.3.1.1.1.1.1.1.3.2.1.cmml" xref="A1.E11.m1.3.3.1.1.1.1.1.1.3.2.1">^</ci><ci id="A1.E11.m1.3.3.1.1.1.1.1.1.3.2.2.cmml" xref="A1.E11.m1.3.3.1.1.1.1.1.1.3.2.2">𝑝</ci></apply><ci id="A1.E11.m1.3.3.1.1.1.1.1.1.3.3.cmml" xref="A1.E11.m1.3.3.1.1.1.1.1.1.3.3">ℎ</ci></apply></apply></apply><apply id="A1.E11.m1.3.3.1.1.2.cmml" xref="A1.E11.m1.3.3.1.1.2"><times id="A1.E11.m1.3.3.1.1.2.2.cmml" xref="A1.E11.m1.3.3.1.1.2.2"></times><apply id="A1.E11.m1.3.3.1.1.2.3.cmml" xref="A1.E11.m1.3.3.1.1.2.3"><csymbol cd="ambiguous" id="A1.E11.m1.3.3.1.1.2.3.1.cmml" xref="A1.E11.m1.3.3.1.1.2.3">subscript</csymbol><ci id="A1.E11.m1.3.3.1.1.2.3.2.cmml" xref="A1.E11.m1.3.3.1.1.2.3.2">𝔼</ci><apply id="A1.E11.m1.3.3.1.1.2.3.3.cmml" xref="A1.E11.m1.3.3.1.1.2.3.3"><csymbol cd="latexml" id="A1.E11.m1.3.3.1.1.2.3.3.1.cmml" xref="A1.E11.m1.3.3.1.1.2.3.3.1">similar-to</csymbol><ci id="A1.E11.m1.3.3.1.1.2.3.3.2.cmml" xref="A1.E11.m1.3.3.1.1.2.3.3.2">𝑥</ci><ci id="A1.E11.m1.3.3.1.1.2.3.3.3.cmml" xref="A1.E11.m1.3.3.1.1.2.3.3.3">𝑝</ci></apply></apply><apply id="A1.E11.m1.3.3.1.1.2.1.2.cmml" xref="A1.E11.m1.3.3.1.1.2.1.1"><csymbol cd="latexml" id="A1.E11.m1.3.3.1.1.2.1.2.1.cmml" xref="A1.E11.m1.3.3.1.1.2.1.1.2">delimited-[]</csymbol><apply id="A1.E11.m1.3.3.1.1.2.1.1.1.cmml" xref="A1.E11.m1.3.3.1.1.2.1.1.1"><int id="A1.E11.m1.3.3.1.1.2.1.1.1.2.cmml" xref="A1.E11.m1.3.3.1.1.2.1.1.1.2"></int><apply id="A1.E11.m1.3.3.1.1.2.1.1.1.1.cmml" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1"><times id="A1.E11.m1.3.3.1.1.2.1.1.1.1.2.cmml" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1.2"></times><apply id="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.cmml" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.2.cmml" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1.1">superscript</csymbol><apply id="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1"><minus id="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1"></minus><apply id="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2"><times id="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2.1"></times><apply id="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><apply id="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2.2.2"><ci id="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2.2.2.1">^</ci><ci id="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2">𝑝</ci></apply><ci id="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2.2.3">ℎ</ci></apply><ci id="A1.E11.m1.1.1.cmml" xref="A1.E11.m1.1.1">𝑥</ci></apply><apply id="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.3"><times id="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.3.1"></times><ci id="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.3.2">𝑝</ci><ci id="A1.E11.m1.2.2.cmml" xref="A1.E11.m1.2.2">𝑥</ci></apply></apply><cn id="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.3.cmml" type="integer" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1.1.3">2</cn></apply><ci id="A1.E11.m1.3.3.1.1.2.1.1.1.1.3a.cmml" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1.3"><mtext id="A1.E11.m1.3.3.1.1.2.1.1.1.1.3.cmml" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1.3">d</mtext></ci><ci id="A1.E11.m1.3.3.1.1.2.1.1.1.1.4.cmml" xref="A1.E11.m1.3.3.1.1.2.1.1.1.1.4">𝑥</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E11.m1.3c">\text{MISE}(p|\hat{p}_{h})=\mathbb{E}_{x\sim p}\left[\int(\hat{p}_{h}(x)-p(x))%
^{2}\,\textup{d}x\right],</annotation><annotation encoding="application/x-llamapun" id="A1.E11.m1.3d">MISE ( italic_p | over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ) = blackboard_E start_POSTSUBSCRIPT italic_x ∼ italic_p end_POSTSUBSCRIPT [ ∫ ( over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ( italic_x ) - italic_p ( italic_x ) ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT d italic_x ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS5.p1.4">where <math alttext="\hat{p}_{h}" class="ltx_Math" display="inline" id="A1.SS5.p1.2.m1.1"><semantics id="A1.SS5.p1.2.m1.1a"><msub id="A1.SS5.p1.2.m1.1.1" xref="A1.SS5.p1.2.m1.1.1.cmml"><mover accent="true" id="A1.SS5.p1.2.m1.1.1.2" xref="A1.SS5.p1.2.m1.1.1.2.cmml"><mi id="A1.SS5.p1.2.m1.1.1.2.2" xref="A1.SS5.p1.2.m1.1.1.2.2.cmml">p</mi><mo id="A1.SS5.p1.2.m1.1.1.2.1" xref="A1.SS5.p1.2.m1.1.1.2.1.cmml">^</mo></mover><mi id="A1.SS5.p1.2.m1.1.1.3" xref="A1.SS5.p1.2.m1.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS5.p1.2.m1.1b"><apply id="A1.SS5.p1.2.m1.1.1.cmml" xref="A1.SS5.p1.2.m1.1.1"><csymbol cd="ambiguous" id="A1.SS5.p1.2.m1.1.1.1.cmml" xref="A1.SS5.p1.2.m1.1.1">subscript</csymbol><apply id="A1.SS5.p1.2.m1.1.1.2.cmml" xref="A1.SS5.p1.2.m1.1.1.2"><ci id="A1.SS5.p1.2.m1.1.1.2.1.cmml" xref="A1.SS5.p1.2.m1.1.1.2.1">^</ci><ci id="A1.SS5.p1.2.m1.1.1.2.2.cmml" xref="A1.SS5.p1.2.m1.1.1.2.2">𝑝</ci></apply><ci id="A1.SS5.p1.2.m1.1.1.3.cmml" xref="A1.SS5.p1.2.m1.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.p1.2.m1.1c">\hat{p}_{h}</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.p1.2.m1.1d">over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT</annotation></semantics></math> is the kernel density estimate with bandwidth <math alttext="h" class="ltx_Math" display="inline" id="A1.SS5.p1.3.m2.1"><semantics id="A1.SS5.p1.3.m2.1a"><mi id="A1.SS5.p1.3.m2.1.1" xref="A1.SS5.p1.3.m2.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="A1.SS5.p1.3.m2.1b"><ci id="A1.SS5.p1.3.m2.1.1.cmml" xref="A1.SS5.p1.3.m2.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.p1.3.m2.1c">h</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.p1.3.m2.1d">italic_h</annotation></semantics></math>, and <math alttext="p" class="ltx_Math" display="inline" id="A1.SS5.p1.4.m3.1"><semantics id="A1.SS5.p1.4.m3.1a"><mi id="A1.SS5.p1.4.m3.1.1" xref="A1.SS5.p1.4.m3.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="A1.SS5.p1.4.m3.1b"><ci id="A1.SS5.p1.4.m3.1.1.cmml" xref="A1.SS5.p1.4.m3.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.p1.4.m3.1c">p</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.p1.4.m3.1d">italic_p</annotation></semantics></math> is the true density.</p>
</div>
<section class="ltx_subsubsection" id="A1.SS5.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.5.1 </span>Optimal Bandwidth</h4>
<div class="ltx_para ltx_noindent" id="A1.SS5.SSS1.p1">
<p class="ltx_p" id="A1.SS5.SSS1.p1.4">While MISE (Equation <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.E11" title="Equation 11 ‣ A.5 Additional notes on Kernel Density Estimation ‣ Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">11</span></a>) provides a reasonable measure of estimation error, it is often analytically intractable.
To overcome this limitation, researchers developed the Asymptotic Mean Integrated Squared Error (AMISE) <cite class="ltx_cite ltx_citemacro_citep">(Wand &amp; Jones, <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib41" title="">1994</a>, Chapter 2.4)</cite>, an approximation of MISE that becomes increasingly accurate as the sample size grows large:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{AMISE}(h)=\frac{1}{nh}R(K)+\frac{1}{4}h^{4}\mu_{2}(K)^{2}R(p^{\prime%
\prime})," class="ltx_Math" display="block" id="A1.E12.m1.4"><semantics id="A1.E12.m1.4a"><mrow id="A1.E12.m1.4.4.1" xref="A1.E12.m1.4.4.1.1.cmml"><mrow id="A1.E12.m1.4.4.1.1" xref="A1.E12.m1.4.4.1.1.cmml"><mrow id="A1.E12.m1.4.4.1.1.3" xref="A1.E12.m1.4.4.1.1.3.cmml"><mtext id="A1.E12.m1.4.4.1.1.3.2" xref="A1.E12.m1.4.4.1.1.3.2a.cmml">AMISE</mtext><mo id="A1.E12.m1.4.4.1.1.3.1" xref="A1.E12.m1.4.4.1.1.3.1.cmml">⁢</mo><mrow id="A1.E12.m1.4.4.1.1.3.3.2" xref="A1.E12.m1.4.4.1.1.3.cmml"><mo id="A1.E12.m1.4.4.1.1.3.3.2.1" stretchy="false" xref="A1.E12.m1.4.4.1.1.3.cmml">(</mo><mi id="A1.E12.m1.1.1" xref="A1.E12.m1.1.1.cmml">h</mi><mo id="A1.E12.m1.4.4.1.1.3.3.2.2" stretchy="false" xref="A1.E12.m1.4.4.1.1.3.cmml">)</mo></mrow></mrow><mo id="A1.E12.m1.4.4.1.1.2" xref="A1.E12.m1.4.4.1.1.2.cmml">=</mo><mrow id="A1.E12.m1.4.4.1.1.1" xref="A1.E12.m1.4.4.1.1.1.cmml"><mrow id="A1.E12.m1.4.4.1.1.1.3" xref="A1.E12.m1.4.4.1.1.1.3.cmml"><mfrac id="A1.E12.m1.4.4.1.1.1.3.2" xref="A1.E12.m1.4.4.1.1.1.3.2.cmml"><mn id="A1.E12.m1.4.4.1.1.1.3.2.2" xref="A1.E12.m1.4.4.1.1.1.3.2.2.cmml">1</mn><mrow id="A1.E12.m1.4.4.1.1.1.3.2.3" xref="A1.E12.m1.4.4.1.1.1.3.2.3.cmml"><mi id="A1.E12.m1.4.4.1.1.1.3.2.3.2" xref="A1.E12.m1.4.4.1.1.1.3.2.3.2.cmml">n</mi><mo id="A1.E12.m1.4.4.1.1.1.3.2.3.1" xref="A1.E12.m1.4.4.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="A1.E12.m1.4.4.1.1.1.3.2.3.3" xref="A1.E12.m1.4.4.1.1.1.3.2.3.3.cmml">h</mi></mrow></mfrac><mo id="A1.E12.m1.4.4.1.1.1.3.1" xref="A1.E12.m1.4.4.1.1.1.3.1.cmml">⁢</mo><mi id="A1.E12.m1.4.4.1.1.1.3.3" xref="A1.E12.m1.4.4.1.1.1.3.3.cmml">R</mi><mo id="A1.E12.m1.4.4.1.1.1.3.1a" xref="A1.E12.m1.4.4.1.1.1.3.1.cmml">⁢</mo><mrow id="A1.E12.m1.4.4.1.1.1.3.4.2" xref="A1.E12.m1.4.4.1.1.1.3.cmml"><mo id="A1.E12.m1.4.4.1.1.1.3.4.2.1" stretchy="false" xref="A1.E12.m1.4.4.1.1.1.3.cmml">(</mo><mi id="A1.E12.m1.2.2" xref="A1.E12.m1.2.2.cmml">K</mi><mo id="A1.E12.m1.4.4.1.1.1.3.4.2.2" stretchy="false" xref="A1.E12.m1.4.4.1.1.1.3.cmml">)</mo></mrow></mrow><mo id="A1.E12.m1.4.4.1.1.1.2" xref="A1.E12.m1.4.4.1.1.1.2.cmml">+</mo><mrow id="A1.E12.m1.4.4.1.1.1.1" xref="A1.E12.m1.4.4.1.1.1.1.cmml"><mfrac id="A1.E12.m1.4.4.1.1.1.1.3" xref="A1.E12.m1.4.4.1.1.1.1.3.cmml"><mn id="A1.E12.m1.4.4.1.1.1.1.3.2" xref="A1.E12.m1.4.4.1.1.1.1.3.2.cmml">1</mn><mn id="A1.E12.m1.4.4.1.1.1.1.3.3" xref="A1.E12.m1.4.4.1.1.1.1.3.3.cmml">4</mn></mfrac><mo id="A1.E12.m1.4.4.1.1.1.1.2" xref="A1.E12.m1.4.4.1.1.1.1.2.cmml">⁢</mo><msup id="A1.E12.m1.4.4.1.1.1.1.4" xref="A1.E12.m1.4.4.1.1.1.1.4.cmml"><mi id="A1.E12.m1.4.4.1.1.1.1.4.2" xref="A1.E12.m1.4.4.1.1.1.1.4.2.cmml">h</mi><mn id="A1.E12.m1.4.4.1.1.1.1.4.3" xref="A1.E12.m1.4.4.1.1.1.1.4.3.cmml">4</mn></msup><mo id="A1.E12.m1.4.4.1.1.1.1.2a" xref="A1.E12.m1.4.4.1.1.1.1.2.cmml">⁢</mo><msub id="A1.E12.m1.4.4.1.1.1.1.5" xref="A1.E12.m1.4.4.1.1.1.1.5.cmml"><mi id="A1.E12.m1.4.4.1.1.1.1.5.2" xref="A1.E12.m1.4.4.1.1.1.1.5.2.cmml">μ</mi><mn id="A1.E12.m1.4.4.1.1.1.1.5.3" xref="A1.E12.m1.4.4.1.1.1.1.5.3.cmml">2</mn></msub><mo id="A1.E12.m1.4.4.1.1.1.1.2b" xref="A1.E12.m1.4.4.1.1.1.1.2.cmml">⁢</mo><msup id="A1.E12.m1.4.4.1.1.1.1.6" xref="A1.E12.m1.4.4.1.1.1.1.6.cmml"><mrow id="A1.E12.m1.4.4.1.1.1.1.6.2.2" xref="A1.E12.m1.4.4.1.1.1.1.6.cmml"><mo id="A1.E12.m1.4.4.1.1.1.1.6.2.2.1" stretchy="false" xref="A1.E12.m1.4.4.1.1.1.1.6.cmml">(</mo><mi id="A1.E12.m1.3.3" xref="A1.E12.m1.3.3.cmml">K</mi><mo id="A1.E12.m1.4.4.1.1.1.1.6.2.2.2" stretchy="false" xref="A1.E12.m1.4.4.1.1.1.1.6.cmml">)</mo></mrow><mn id="A1.E12.m1.4.4.1.1.1.1.6.3" xref="A1.E12.m1.4.4.1.1.1.1.6.3.cmml">2</mn></msup><mo id="A1.E12.m1.4.4.1.1.1.1.2c" xref="A1.E12.m1.4.4.1.1.1.1.2.cmml">⁢</mo><mi id="A1.E12.m1.4.4.1.1.1.1.7" xref="A1.E12.m1.4.4.1.1.1.1.7.cmml">R</mi><mo id="A1.E12.m1.4.4.1.1.1.1.2d" xref="A1.E12.m1.4.4.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E12.m1.4.4.1.1.1.1.1.1" xref="A1.E12.m1.4.4.1.1.1.1.1.1.1.cmml"><mo id="A1.E12.m1.4.4.1.1.1.1.1.1.2" stretchy="false" xref="A1.E12.m1.4.4.1.1.1.1.1.1.1.cmml">(</mo><msup id="A1.E12.m1.4.4.1.1.1.1.1.1.1" xref="A1.E12.m1.4.4.1.1.1.1.1.1.1.cmml"><mi id="A1.E12.m1.4.4.1.1.1.1.1.1.1.2" xref="A1.E12.m1.4.4.1.1.1.1.1.1.1.2.cmml">p</mi><mo id="A1.E12.m1.4.4.1.1.1.1.1.1.1.3" xref="A1.E12.m1.4.4.1.1.1.1.1.1.1.3.cmml">′′</mo></msup><mo id="A1.E12.m1.4.4.1.1.1.1.1.1.3" stretchy="false" xref="A1.E12.m1.4.4.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A1.E12.m1.4.4.1.2" xref="A1.E12.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E12.m1.4b"><apply id="A1.E12.m1.4.4.1.1.cmml" xref="A1.E12.m1.4.4.1"><eq id="A1.E12.m1.4.4.1.1.2.cmml" xref="A1.E12.m1.4.4.1.1.2"></eq><apply id="A1.E12.m1.4.4.1.1.3.cmml" xref="A1.E12.m1.4.4.1.1.3"><times id="A1.E12.m1.4.4.1.1.3.1.cmml" xref="A1.E12.m1.4.4.1.1.3.1"></times><ci id="A1.E12.m1.4.4.1.1.3.2a.cmml" xref="A1.E12.m1.4.4.1.1.3.2"><mtext id="A1.E12.m1.4.4.1.1.3.2.cmml" xref="A1.E12.m1.4.4.1.1.3.2">AMISE</mtext></ci><ci id="A1.E12.m1.1.1.cmml" xref="A1.E12.m1.1.1">ℎ</ci></apply><apply id="A1.E12.m1.4.4.1.1.1.cmml" xref="A1.E12.m1.4.4.1.1.1"><plus id="A1.E12.m1.4.4.1.1.1.2.cmml" xref="A1.E12.m1.4.4.1.1.1.2"></plus><apply id="A1.E12.m1.4.4.1.1.1.3.cmml" xref="A1.E12.m1.4.4.1.1.1.3"><times id="A1.E12.m1.4.4.1.1.1.3.1.cmml" xref="A1.E12.m1.4.4.1.1.1.3.1"></times><apply id="A1.E12.m1.4.4.1.1.1.3.2.cmml" xref="A1.E12.m1.4.4.1.1.1.3.2"><divide id="A1.E12.m1.4.4.1.1.1.3.2.1.cmml" xref="A1.E12.m1.4.4.1.1.1.3.2"></divide><cn id="A1.E12.m1.4.4.1.1.1.3.2.2.cmml" type="integer" xref="A1.E12.m1.4.4.1.1.1.3.2.2">1</cn><apply id="A1.E12.m1.4.4.1.1.1.3.2.3.cmml" xref="A1.E12.m1.4.4.1.1.1.3.2.3"><times id="A1.E12.m1.4.4.1.1.1.3.2.3.1.cmml" xref="A1.E12.m1.4.4.1.1.1.3.2.3.1"></times><ci id="A1.E12.m1.4.4.1.1.1.3.2.3.2.cmml" xref="A1.E12.m1.4.4.1.1.1.3.2.3.2">𝑛</ci><ci id="A1.E12.m1.4.4.1.1.1.3.2.3.3.cmml" xref="A1.E12.m1.4.4.1.1.1.3.2.3.3">ℎ</ci></apply></apply><ci id="A1.E12.m1.4.4.1.1.1.3.3.cmml" xref="A1.E12.m1.4.4.1.1.1.3.3">𝑅</ci><ci id="A1.E12.m1.2.2.cmml" xref="A1.E12.m1.2.2">𝐾</ci></apply><apply id="A1.E12.m1.4.4.1.1.1.1.cmml" xref="A1.E12.m1.4.4.1.1.1.1"><times id="A1.E12.m1.4.4.1.1.1.1.2.cmml" xref="A1.E12.m1.4.4.1.1.1.1.2"></times><apply id="A1.E12.m1.4.4.1.1.1.1.3.cmml" xref="A1.E12.m1.4.4.1.1.1.1.3"><divide id="A1.E12.m1.4.4.1.1.1.1.3.1.cmml" xref="A1.E12.m1.4.4.1.1.1.1.3"></divide><cn id="A1.E12.m1.4.4.1.1.1.1.3.2.cmml" type="integer" xref="A1.E12.m1.4.4.1.1.1.1.3.2">1</cn><cn id="A1.E12.m1.4.4.1.1.1.1.3.3.cmml" type="integer" xref="A1.E12.m1.4.4.1.1.1.1.3.3">4</cn></apply><apply id="A1.E12.m1.4.4.1.1.1.1.4.cmml" xref="A1.E12.m1.4.4.1.1.1.1.4"><csymbol cd="ambiguous" id="A1.E12.m1.4.4.1.1.1.1.4.1.cmml" xref="A1.E12.m1.4.4.1.1.1.1.4">superscript</csymbol><ci id="A1.E12.m1.4.4.1.1.1.1.4.2.cmml" xref="A1.E12.m1.4.4.1.1.1.1.4.2">ℎ</ci><cn id="A1.E12.m1.4.4.1.1.1.1.4.3.cmml" type="integer" xref="A1.E12.m1.4.4.1.1.1.1.4.3">4</cn></apply><apply id="A1.E12.m1.4.4.1.1.1.1.5.cmml" xref="A1.E12.m1.4.4.1.1.1.1.5"><csymbol cd="ambiguous" id="A1.E12.m1.4.4.1.1.1.1.5.1.cmml" xref="A1.E12.m1.4.4.1.1.1.1.5">subscript</csymbol><ci id="A1.E12.m1.4.4.1.1.1.1.5.2.cmml" xref="A1.E12.m1.4.4.1.1.1.1.5.2">𝜇</ci><cn id="A1.E12.m1.4.4.1.1.1.1.5.3.cmml" type="integer" xref="A1.E12.m1.4.4.1.1.1.1.5.3">2</cn></apply><apply id="A1.E12.m1.4.4.1.1.1.1.6.cmml" xref="A1.E12.m1.4.4.1.1.1.1.6"><csymbol cd="ambiguous" id="A1.E12.m1.4.4.1.1.1.1.6.1.cmml" xref="A1.E12.m1.4.4.1.1.1.1.6">superscript</csymbol><ci id="A1.E12.m1.3.3.cmml" xref="A1.E12.m1.3.3">𝐾</ci><cn id="A1.E12.m1.4.4.1.1.1.1.6.3.cmml" type="integer" xref="A1.E12.m1.4.4.1.1.1.1.6.3">2</cn></apply><ci id="A1.E12.m1.4.4.1.1.1.1.7.cmml" xref="A1.E12.m1.4.4.1.1.1.1.7">𝑅</ci><apply id="A1.E12.m1.4.4.1.1.1.1.1.1.1.cmml" xref="A1.E12.m1.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="A1.E12.m1.4.4.1.1.1.1.1.1">superscript</csymbol><ci id="A1.E12.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="A1.E12.m1.4.4.1.1.1.1.1.1.1.2">𝑝</ci><ci id="A1.E12.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="A1.E12.m1.4.4.1.1.1.1.1.1.1.3">′′</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E12.m1.4c">\text{AMISE}(h)=\frac{1}{nh}R(K)+\frac{1}{4}h^{4}\mu_{2}(K)^{2}R(p^{\prime%
\prime}),</annotation><annotation encoding="application/x-llamapun" id="A1.E12.m1.4d">AMISE ( italic_h ) = divide start_ARG 1 end_ARG start_ARG italic_n italic_h end_ARG italic_R ( italic_K ) + divide start_ARG 1 end_ARG start_ARG 4 end_ARG italic_h start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT italic_μ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( italic_K ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_R ( italic_p start_POSTSUPERSCRIPT ′ ′ end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS5.SSS1.p1.3">where <math alttext="R(f)=\int f(x)^{2}\,\textup{d}x" class="ltx_Math" display="inline" id="A1.SS5.SSS1.p1.1.m1.2"><semantics id="A1.SS5.SSS1.p1.1.m1.2a"><mrow id="A1.SS5.SSS1.p1.1.m1.2.3" xref="A1.SS5.SSS1.p1.1.m1.2.3.cmml"><mrow id="A1.SS5.SSS1.p1.1.m1.2.3.2" xref="A1.SS5.SSS1.p1.1.m1.2.3.2.cmml"><mi id="A1.SS5.SSS1.p1.1.m1.2.3.2.2" xref="A1.SS5.SSS1.p1.1.m1.2.3.2.2.cmml">R</mi><mo id="A1.SS5.SSS1.p1.1.m1.2.3.2.1" xref="A1.SS5.SSS1.p1.1.m1.2.3.2.1.cmml">⁢</mo><mrow id="A1.SS5.SSS1.p1.1.m1.2.3.2.3.2" xref="A1.SS5.SSS1.p1.1.m1.2.3.2.cmml"><mo id="A1.SS5.SSS1.p1.1.m1.2.3.2.3.2.1" stretchy="false" xref="A1.SS5.SSS1.p1.1.m1.2.3.2.cmml">(</mo><mi id="A1.SS5.SSS1.p1.1.m1.1.1" xref="A1.SS5.SSS1.p1.1.m1.1.1.cmml">f</mi><mo id="A1.SS5.SSS1.p1.1.m1.2.3.2.3.2.2" stretchy="false" xref="A1.SS5.SSS1.p1.1.m1.2.3.2.cmml">)</mo></mrow></mrow><mo id="A1.SS5.SSS1.p1.1.m1.2.3.1" rspace="0.111em" xref="A1.SS5.SSS1.p1.1.m1.2.3.1.cmml">=</mo><mrow id="A1.SS5.SSS1.p1.1.m1.2.3.3" xref="A1.SS5.SSS1.p1.1.m1.2.3.3.cmml"><mo id="A1.SS5.SSS1.p1.1.m1.2.3.3.1" xref="A1.SS5.SSS1.p1.1.m1.2.3.3.1.cmml">∫</mo><mrow id="A1.SS5.SSS1.p1.1.m1.2.3.3.2" xref="A1.SS5.SSS1.p1.1.m1.2.3.3.2.cmml"><mi id="A1.SS5.SSS1.p1.1.m1.2.3.3.2.2" xref="A1.SS5.SSS1.p1.1.m1.2.3.3.2.2.cmml">f</mi><mo id="A1.SS5.SSS1.p1.1.m1.2.3.3.2.1" xref="A1.SS5.SSS1.p1.1.m1.2.3.3.2.1.cmml">⁢</mo><msup id="A1.SS5.SSS1.p1.1.m1.2.3.3.2.3" xref="A1.SS5.SSS1.p1.1.m1.2.3.3.2.3.cmml"><mrow id="A1.SS5.SSS1.p1.1.m1.2.3.3.2.3.2.2" xref="A1.SS5.SSS1.p1.1.m1.2.3.3.2.3.cmml"><mo id="A1.SS5.SSS1.p1.1.m1.2.3.3.2.3.2.2.1" stretchy="false" xref="A1.SS5.SSS1.p1.1.m1.2.3.3.2.3.cmml">(</mo><mi id="A1.SS5.SSS1.p1.1.m1.2.2" xref="A1.SS5.SSS1.p1.1.m1.2.2.cmml">x</mi><mo id="A1.SS5.SSS1.p1.1.m1.2.3.3.2.3.2.2.2" stretchy="false" xref="A1.SS5.SSS1.p1.1.m1.2.3.3.2.3.cmml">)</mo></mrow><mn id="A1.SS5.SSS1.p1.1.m1.2.3.3.2.3.3" xref="A1.SS5.SSS1.p1.1.m1.2.3.3.2.3.3.cmml">2</mn></msup><mo id="A1.SS5.SSS1.p1.1.m1.2.3.3.2.1a" xref="A1.SS5.SSS1.p1.1.m1.2.3.3.2.1.cmml">⁢</mo><mtext id="A1.SS5.SSS1.p1.1.m1.2.3.3.2.4" xref="A1.SS5.SSS1.p1.1.m1.2.3.3.2.4a.cmml">d</mtext><mo id="A1.SS5.SSS1.p1.1.m1.2.3.3.2.1b" xref="A1.SS5.SSS1.p1.1.m1.2.3.3.2.1.cmml">⁢</mo><mi id="A1.SS5.SSS1.p1.1.m1.2.3.3.2.5" xref="A1.SS5.SSS1.p1.1.m1.2.3.3.2.5.cmml">x</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS5.SSS1.p1.1.m1.2b"><apply id="A1.SS5.SSS1.p1.1.m1.2.3.cmml" xref="A1.SS5.SSS1.p1.1.m1.2.3"><eq id="A1.SS5.SSS1.p1.1.m1.2.3.1.cmml" xref="A1.SS5.SSS1.p1.1.m1.2.3.1"></eq><apply id="A1.SS5.SSS1.p1.1.m1.2.3.2.cmml" xref="A1.SS5.SSS1.p1.1.m1.2.3.2"><times id="A1.SS5.SSS1.p1.1.m1.2.3.2.1.cmml" xref="A1.SS5.SSS1.p1.1.m1.2.3.2.1"></times><ci id="A1.SS5.SSS1.p1.1.m1.2.3.2.2.cmml" xref="A1.SS5.SSS1.p1.1.m1.2.3.2.2">𝑅</ci><ci id="A1.SS5.SSS1.p1.1.m1.1.1.cmml" xref="A1.SS5.SSS1.p1.1.m1.1.1">𝑓</ci></apply><apply id="A1.SS5.SSS1.p1.1.m1.2.3.3.cmml" xref="A1.SS5.SSS1.p1.1.m1.2.3.3"><int id="A1.SS5.SSS1.p1.1.m1.2.3.3.1.cmml" xref="A1.SS5.SSS1.p1.1.m1.2.3.3.1"></int><apply id="A1.SS5.SSS1.p1.1.m1.2.3.3.2.cmml" xref="A1.SS5.SSS1.p1.1.m1.2.3.3.2"><times id="A1.SS5.SSS1.p1.1.m1.2.3.3.2.1.cmml" xref="A1.SS5.SSS1.p1.1.m1.2.3.3.2.1"></times><ci id="A1.SS5.SSS1.p1.1.m1.2.3.3.2.2.cmml" xref="A1.SS5.SSS1.p1.1.m1.2.3.3.2.2">𝑓</ci><apply id="A1.SS5.SSS1.p1.1.m1.2.3.3.2.3.cmml" xref="A1.SS5.SSS1.p1.1.m1.2.3.3.2.3"><csymbol cd="ambiguous" id="A1.SS5.SSS1.p1.1.m1.2.3.3.2.3.1.cmml" xref="A1.SS5.SSS1.p1.1.m1.2.3.3.2.3">superscript</csymbol><ci id="A1.SS5.SSS1.p1.1.m1.2.2.cmml" xref="A1.SS5.SSS1.p1.1.m1.2.2">𝑥</ci><cn id="A1.SS5.SSS1.p1.1.m1.2.3.3.2.3.3.cmml" type="integer" xref="A1.SS5.SSS1.p1.1.m1.2.3.3.2.3.3">2</cn></apply><ci id="A1.SS5.SSS1.p1.1.m1.2.3.3.2.4a.cmml" xref="A1.SS5.SSS1.p1.1.m1.2.3.3.2.4"><mtext id="A1.SS5.SSS1.p1.1.m1.2.3.3.2.4.cmml" xref="A1.SS5.SSS1.p1.1.m1.2.3.3.2.4">d</mtext></ci><ci id="A1.SS5.SSS1.p1.1.m1.2.3.3.2.5.cmml" xref="A1.SS5.SSS1.p1.1.m1.2.3.3.2.5">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.SSS1.p1.1.m1.2c">R(f)=\int f(x)^{2}\,\textup{d}x</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.SSS1.p1.1.m1.2d">italic_R ( italic_f ) = ∫ italic_f ( italic_x ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT d italic_x</annotation></semantics></math>, <math alttext="\mu_{2}(K)=\int x^{2}K(x)\,\textup{d}x" class="ltx_Math" display="inline" id="A1.SS5.SSS1.p1.2.m2.2"><semantics id="A1.SS5.SSS1.p1.2.m2.2a"><mrow id="A1.SS5.SSS1.p1.2.m2.2.3" xref="A1.SS5.SSS1.p1.2.m2.2.3.cmml"><mrow id="A1.SS5.SSS1.p1.2.m2.2.3.2" xref="A1.SS5.SSS1.p1.2.m2.2.3.2.cmml"><msub id="A1.SS5.SSS1.p1.2.m2.2.3.2.2" xref="A1.SS5.SSS1.p1.2.m2.2.3.2.2.cmml"><mi id="A1.SS5.SSS1.p1.2.m2.2.3.2.2.2" xref="A1.SS5.SSS1.p1.2.m2.2.3.2.2.2.cmml">μ</mi><mn id="A1.SS5.SSS1.p1.2.m2.2.3.2.2.3" xref="A1.SS5.SSS1.p1.2.m2.2.3.2.2.3.cmml">2</mn></msub><mo id="A1.SS5.SSS1.p1.2.m2.2.3.2.1" xref="A1.SS5.SSS1.p1.2.m2.2.3.2.1.cmml">⁢</mo><mrow id="A1.SS5.SSS1.p1.2.m2.2.3.2.3.2" xref="A1.SS5.SSS1.p1.2.m2.2.3.2.cmml"><mo id="A1.SS5.SSS1.p1.2.m2.2.3.2.3.2.1" stretchy="false" xref="A1.SS5.SSS1.p1.2.m2.2.3.2.cmml">(</mo><mi id="A1.SS5.SSS1.p1.2.m2.1.1" xref="A1.SS5.SSS1.p1.2.m2.1.1.cmml">K</mi><mo id="A1.SS5.SSS1.p1.2.m2.2.3.2.3.2.2" stretchy="false" xref="A1.SS5.SSS1.p1.2.m2.2.3.2.cmml">)</mo></mrow></mrow><mo id="A1.SS5.SSS1.p1.2.m2.2.3.1" rspace="0.111em" xref="A1.SS5.SSS1.p1.2.m2.2.3.1.cmml">=</mo><mrow id="A1.SS5.SSS1.p1.2.m2.2.3.3" xref="A1.SS5.SSS1.p1.2.m2.2.3.3.cmml"><mo id="A1.SS5.SSS1.p1.2.m2.2.3.3.1" xref="A1.SS5.SSS1.p1.2.m2.2.3.3.1.cmml">∫</mo><mrow id="A1.SS5.SSS1.p1.2.m2.2.3.3.2" xref="A1.SS5.SSS1.p1.2.m2.2.3.3.2.cmml"><msup id="A1.SS5.SSS1.p1.2.m2.2.3.3.2.2" xref="A1.SS5.SSS1.p1.2.m2.2.3.3.2.2.cmml"><mi id="A1.SS5.SSS1.p1.2.m2.2.3.3.2.2.2" xref="A1.SS5.SSS1.p1.2.m2.2.3.3.2.2.2.cmml">x</mi><mn id="A1.SS5.SSS1.p1.2.m2.2.3.3.2.2.3" xref="A1.SS5.SSS1.p1.2.m2.2.3.3.2.2.3.cmml">2</mn></msup><mo id="A1.SS5.SSS1.p1.2.m2.2.3.3.2.1" xref="A1.SS5.SSS1.p1.2.m2.2.3.3.2.1.cmml">⁢</mo><mi id="A1.SS5.SSS1.p1.2.m2.2.3.3.2.3" xref="A1.SS5.SSS1.p1.2.m2.2.3.3.2.3.cmml">K</mi><mo id="A1.SS5.SSS1.p1.2.m2.2.3.3.2.1a" xref="A1.SS5.SSS1.p1.2.m2.2.3.3.2.1.cmml">⁢</mo><mrow id="A1.SS5.SSS1.p1.2.m2.2.3.3.2.4.2" xref="A1.SS5.SSS1.p1.2.m2.2.3.3.2.cmml"><mo id="A1.SS5.SSS1.p1.2.m2.2.3.3.2.4.2.1" stretchy="false" xref="A1.SS5.SSS1.p1.2.m2.2.3.3.2.cmml">(</mo><mi id="A1.SS5.SSS1.p1.2.m2.2.2" xref="A1.SS5.SSS1.p1.2.m2.2.2.cmml">x</mi><mo id="A1.SS5.SSS1.p1.2.m2.2.3.3.2.4.2.2" stretchy="false" xref="A1.SS5.SSS1.p1.2.m2.2.3.3.2.cmml">)</mo></mrow><mo id="A1.SS5.SSS1.p1.2.m2.2.3.3.2.1b" lspace="0.170em" xref="A1.SS5.SSS1.p1.2.m2.2.3.3.2.1.cmml">⁢</mo><mtext id="A1.SS5.SSS1.p1.2.m2.2.3.3.2.5" xref="A1.SS5.SSS1.p1.2.m2.2.3.3.2.5a.cmml">d</mtext><mo id="A1.SS5.SSS1.p1.2.m2.2.3.3.2.1c" xref="A1.SS5.SSS1.p1.2.m2.2.3.3.2.1.cmml">⁢</mo><mi id="A1.SS5.SSS1.p1.2.m2.2.3.3.2.6" xref="A1.SS5.SSS1.p1.2.m2.2.3.3.2.6.cmml">x</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS5.SSS1.p1.2.m2.2b"><apply id="A1.SS5.SSS1.p1.2.m2.2.3.cmml" xref="A1.SS5.SSS1.p1.2.m2.2.3"><eq id="A1.SS5.SSS1.p1.2.m2.2.3.1.cmml" xref="A1.SS5.SSS1.p1.2.m2.2.3.1"></eq><apply id="A1.SS5.SSS1.p1.2.m2.2.3.2.cmml" xref="A1.SS5.SSS1.p1.2.m2.2.3.2"><times id="A1.SS5.SSS1.p1.2.m2.2.3.2.1.cmml" xref="A1.SS5.SSS1.p1.2.m2.2.3.2.1"></times><apply id="A1.SS5.SSS1.p1.2.m2.2.3.2.2.cmml" xref="A1.SS5.SSS1.p1.2.m2.2.3.2.2"><csymbol cd="ambiguous" id="A1.SS5.SSS1.p1.2.m2.2.3.2.2.1.cmml" xref="A1.SS5.SSS1.p1.2.m2.2.3.2.2">subscript</csymbol><ci id="A1.SS5.SSS1.p1.2.m2.2.3.2.2.2.cmml" xref="A1.SS5.SSS1.p1.2.m2.2.3.2.2.2">𝜇</ci><cn id="A1.SS5.SSS1.p1.2.m2.2.3.2.2.3.cmml" type="integer" xref="A1.SS5.SSS1.p1.2.m2.2.3.2.2.3">2</cn></apply><ci id="A1.SS5.SSS1.p1.2.m2.1.1.cmml" xref="A1.SS5.SSS1.p1.2.m2.1.1">𝐾</ci></apply><apply id="A1.SS5.SSS1.p1.2.m2.2.3.3.cmml" xref="A1.SS5.SSS1.p1.2.m2.2.3.3"><int id="A1.SS5.SSS1.p1.2.m2.2.3.3.1.cmml" xref="A1.SS5.SSS1.p1.2.m2.2.3.3.1"></int><apply id="A1.SS5.SSS1.p1.2.m2.2.3.3.2.cmml" xref="A1.SS5.SSS1.p1.2.m2.2.3.3.2"><times id="A1.SS5.SSS1.p1.2.m2.2.3.3.2.1.cmml" xref="A1.SS5.SSS1.p1.2.m2.2.3.3.2.1"></times><apply id="A1.SS5.SSS1.p1.2.m2.2.3.3.2.2.cmml" xref="A1.SS5.SSS1.p1.2.m2.2.3.3.2.2"><csymbol cd="ambiguous" id="A1.SS5.SSS1.p1.2.m2.2.3.3.2.2.1.cmml" xref="A1.SS5.SSS1.p1.2.m2.2.3.3.2.2">superscript</csymbol><ci id="A1.SS5.SSS1.p1.2.m2.2.3.3.2.2.2.cmml" xref="A1.SS5.SSS1.p1.2.m2.2.3.3.2.2.2">𝑥</ci><cn id="A1.SS5.SSS1.p1.2.m2.2.3.3.2.2.3.cmml" type="integer" xref="A1.SS5.SSS1.p1.2.m2.2.3.3.2.2.3">2</cn></apply><ci id="A1.SS5.SSS1.p1.2.m2.2.3.3.2.3.cmml" xref="A1.SS5.SSS1.p1.2.m2.2.3.3.2.3">𝐾</ci><ci id="A1.SS5.SSS1.p1.2.m2.2.2.cmml" xref="A1.SS5.SSS1.p1.2.m2.2.2">𝑥</ci><ci id="A1.SS5.SSS1.p1.2.m2.2.3.3.2.5a.cmml" xref="A1.SS5.SSS1.p1.2.m2.2.3.3.2.5"><mtext id="A1.SS5.SSS1.p1.2.m2.2.3.3.2.5.cmml" xref="A1.SS5.SSS1.p1.2.m2.2.3.3.2.5">d</mtext></ci><ci id="A1.SS5.SSS1.p1.2.m2.2.3.3.2.6.cmml" xref="A1.SS5.SSS1.p1.2.m2.2.3.3.2.6">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.SSS1.p1.2.m2.2c">\mu_{2}(K)=\int x^{2}K(x)\,\textup{d}x</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.SSS1.p1.2.m2.2d">italic_μ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( italic_K ) = ∫ italic_x start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_K ( italic_x ) d italic_x</annotation></semantics></math>, and <math alttext="p^{\prime\prime}" class="ltx_Math" display="inline" id="A1.SS5.SSS1.p1.3.m3.1"><semantics id="A1.SS5.SSS1.p1.3.m3.1a"><msup id="A1.SS5.SSS1.p1.3.m3.1.1" xref="A1.SS5.SSS1.p1.3.m3.1.1.cmml"><mi id="A1.SS5.SSS1.p1.3.m3.1.1.2" xref="A1.SS5.SSS1.p1.3.m3.1.1.2.cmml">p</mi><mo id="A1.SS5.SSS1.p1.3.m3.1.1.3" xref="A1.SS5.SSS1.p1.3.m3.1.1.3.cmml">′′</mo></msup><annotation-xml encoding="MathML-Content" id="A1.SS5.SSS1.p1.3.m3.1b"><apply id="A1.SS5.SSS1.p1.3.m3.1.1.cmml" xref="A1.SS5.SSS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A1.SS5.SSS1.p1.3.m3.1.1.1.cmml" xref="A1.SS5.SSS1.p1.3.m3.1.1">superscript</csymbol><ci id="A1.SS5.SSS1.p1.3.m3.1.1.2.cmml" xref="A1.SS5.SSS1.p1.3.m3.1.1.2">𝑝</ci><ci id="A1.SS5.SSS1.p1.3.m3.1.1.3.cmml" xref="A1.SS5.SSS1.p1.3.m3.1.1.3">′′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.SSS1.p1.3.m3.1c">p^{\prime\prime}</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.SSS1.p1.3.m3.1d">italic_p start_POSTSUPERSCRIPT ′ ′ end_POSTSUPERSCRIPT</annotation></semantics></math> is the second derivative of the true density.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS5.SSS1.p2">
<p class="ltx_p" id="A1.SS5.SSS1.p2.1">AMISE provides a more manageable form for mathematical analysis.
By minimizing AMISE with respect to <math alttext="h" class="ltx_Math" display="inline" id="A1.SS5.SSS1.p2.1.m1.1"><semantics id="A1.SS5.SSS1.p2.1.m1.1a"><mi id="A1.SS5.SSS1.p2.1.m1.1.1" xref="A1.SS5.SSS1.p2.1.m1.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="A1.SS5.SSS1.p2.1.m1.1b"><ci id="A1.SS5.SSS1.p2.1.m1.1.1.cmml" xref="A1.SS5.SSS1.p2.1.m1.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.SSS1.p2.1.m1.1c">h</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.SSS1.p2.1.m1.1d">italic_h</annotation></semantics></math>, we can derive the optimal bandwidth:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="h_{opt}=\left(\frac{R(K)}{n\mu_{2}(K)^{2}R(p^{\prime\prime})}\right)^{1/5}=Cn^%
{-\frac{1}{5}}." class="ltx_Math" display="block" id="A1.E13.m1.4"><semantics id="A1.E13.m1.4a"><mrow id="A1.E13.m1.4.4.1" xref="A1.E13.m1.4.4.1.1.cmml"><mrow id="A1.E13.m1.4.4.1.1" xref="A1.E13.m1.4.4.1.1.cmml"><msub id="A1.E13.m1.4.4.1.1.2" xref="A1.E13.m1.4.4.1.1.2.cmml"><mi id="A1.E13.m1.4.4.1.1.2.2" xref="A1.E13.m1.4.4.1.1.2.2.cmml">h</mi><mrow id="A1.E13.m1.4.4.1.1.2.3" xref="A1.E13.m1.4.4.1.1.2.3.cmml"><mi id="A1.E13.m1.4.4.1.1.2.3.2" xref="A1.E13.m1.4.4.1.1.2.3.2.cmml">o</mi><mo id="A1.E13.m1.4.4.1.1.2.3.1" xref="A1.E13.m1.4.4.1.1.2.3.1.cmml">⁢</mo><mi id="A1.E13.m1.4.4.1.1.2.3.3" xref="A1.E13.m1.4.4.1.1.2.3.3.cmml">p</mi><mo id="A1.E13.m1.4.4.1.1.2.3.1a" xref="A1.E13.m1.4.4.1.1.2.3.1.cmml">⁢</mo><mi id="A1.E13.m1.4.4.1.1.2.3.4" xref="A1.E13.m1.4.4.1.1.2.3.4.cmml">t</mi></mrow></msub><mo id="A1.E13.m1.4.4.1.1.3" xref="A1.E13.m1.4.4.1.1.3.cmml">=</mo><msup id="A1.E13.m1.4.4.1.1.4" xref="A1.E13.m1.4.4.1.1.4.cmml"><mrow id="A1.E13.m1.4.4.1.1.4.2.2" xref="A1.E13.m1.3.3.cmml"><mo id="A1.E13.m1.4.4.1.1.4.2.2.1" xref="A1.E13.m1.3.3.cmml">(</mo><mfrac id="A1.E13.m1.3.3" xref="A1.E13.m1.3.3.cmml"><mrow id="A1.E13.m1.1.1.1" xref="A1.E13.m1.1.1.1.cmml"><mi id="A1.E13.m1.1.1.1.3" xref="A1.E13.m1.1.1.1.3.cmml">R</mi><mo id="A1.E13.m1.1.1.1.2" xref="A1.E13.m1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E13.m1.1.1.1.4.2" xref="A1.E13.m1.1.1.1.cmml"><mo id="A1.E13.m1.1.1.1.4.2.1" stretchy="false" xref="A1.E13.m1.1.1.1.cmml">(</mo><mi id="A1.E13.m1.1.1.1.1" xref="A1.E13.m1.1.1.1.1.cmml">K</mi><mo id="A1.E13.m1.1.1.1.4.2.2" stretchy="false" xref="A1.E13.m1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.E13.m1.3.3.3" xref="A1.E13.m1.3.3.3.cmml"><mi id="A1.E13.m1.3.3.3.4" xref="A1.E13.m1.3.3.3.4.cmml">n</mi><mo id="A1.E13.m1.3.3.3.3" xref="A1.E13.m1.3.3.3.3.cmml">⁢</mo><msub id="A1.E13.m1.3.3.3.5" xref="A1.E13.m1.3.3.3.5.cmml"><mi id="A1.E13.m1.3.3.3.5.2" xref="A1.E13.m1.3.3.3.5.2.cmml">μ</mi><mn id="A1.E13.m1.3.3.3.5.3" xref="A1.E13.m1.3.3.3.5.3.cmml">2</mn></msub><mo id="A1.E13.m1.3.3.3.3a" xref="A1.E13.m1.3.3.3.3.cmml">⁢</mo><msup id="A1.E13.m1.3.3.3.6" xref="A1.E13.m1.3.3.3.6.cmml"><mrow id="A1.E13.m1.3.3.3.6.2.2" xref="A1.E13.m1.3.3.3.6.cmml"><mo id="A1.E13.m1.3.3.3.6.2.2.1" stretchy="false" xref="A1.E13.m1.3.3.3.6.cmml">(</mo><mi id="A1.E13.m1.2.2.2.1" xref="A1.E13.m1.2.2.2.1.cmml">K</mi><mo id="A1.E13.m1.3.3.3.6.2.2.2" stretchy="false" xref="A1.E13.m1.3.3.3.6.cmml">)</mo></mrow><mn id="A1.E13.m1.3.3.3.6.3" xref="A1.E13.m1.3.3.3.6.3.cmml">2</mn></msup><mo id="A1.E13.m1.3.3.3.3b" xref="A1.E13.m1.3.3.3.3.cmml">⁢</mo><mi id="A1.E13.m1.3.3.3.7" xref="A1.E13.m1.3.3.3.7.cmml">R</mi><mo id="A1.E13.m1.3.3.3.3c" xref="A1.E13.m1.3.3.3.3.cmml">⁢</mo><mrow id="A1.E13.m1.3.3.3.2.1" xref="A1.E13.m1.3.3.3.2.1.1.cmml"><mo id="A1.E13.m1.3.3.3.2.1.2" stretchy="false" xref="A1.E13.m1.3.3.3.2.1.1.cmml">(</mo><msup id="A1.E13.m1.3.3.3.2.1.1" xref="A1.E13.m1.3.3.3.2.1.1.cmml"><mi id="A1.E13.m1.3.3.3.2.1.1.2" xref="A1.E13.m1.3.3.3.2.1.1.2.cmml">p</mi><mo id="A1.E13.m1.3.3.3.2.1.1.3" xref="A1.E13.m1.3.3.3.2.1.1.3.cmml">′′</mo></msup><mo id="A1.E13.m1.3.3.3.2.1.3" stretchy="false" xref="A1.E13.m1.3.3.3.2.1.1.cmml">)</mo></mrow></mrow></mfrac><mo id="A1.E13.m1.4.4.1.1.4.2.2.2" xref="A1.E13.m1.3.3.cmml">)</mo></mrow><mrow id="A1.E13.m1.4.4.1.1.4.3" xref="A1.E13.m1.4.4.1.1.4.3.cmml"><mn id="A1.E13.m1.4.4.1.1.4.3.2" xref="A1.E13.m1.4.4.1.1.4.3.2.cmml">1</mn><mo id="A1.E13.m1.4.4.1.1.4.3.1" xref="A1.E13.m1.4.4.1.1.4.3.1.cmml">/</mo><mn id="A1.E13.m1.4.4.1.1.4.3.3" xref="A1.E13.m1.4.4.1.1.4.3.3.cmml">5</mn></mrow></msup><mo id="A1.E13.m1.4.4.1.1.5" xref="A1.E13.m1.4.4.1.1.5.cmml">=</mo><mrow id="A1.E13.m1.4.4.1.1.6" xref="A1.E13.m1.4.4.1.1.6.cmml"><mi id="A1.E13.m1.4.4.1.1.6.2" xref="A1.E13.m1.4.4.1.1.6.2.cmml">C</mi><mo id="A1.E13.m1.4.4.1.1.6.1" xref="A1.E13.m1.4.4.1.1.6.1.cmml">⁢</mo><msup id="A1.E13.m1.4.4.1.1.6.3" xref="A1.E13.m1.4.4.1.1.6.3.cmml"><mi id="A1.E13.m1.4.4.1.1.6.3.2" xref="A1.E13.m1.4.4.1.1.6.3.2.cmml">n</mi><mrow id="A1.E13.m1.4.4.1.1.6.3.3" xref="A1.E13.m1.4.4.1.1.6.3.3.cmml"><mo id="A1.E13.m1.4.4.1.1.6.3.3a" xref="A1.E13.m1.4.4.1.1.6.3.3.cmml">−</mo><mfrac id="A1.E13.m1.4.4.1.1.6.3.3.2" xref="A1.E13.m1.4.4.1.1.6.3.3.2.cmml"><mn id="A1.E13.m1.4.4.1.1.6.3.3.2.2" xref="A1.E13.m1.4.4.1.1.6.3.3.2.2.cmml">1</mn><mn id="A1.E13.m1.4.4.1.1.6.3.3.2.3" xref="A1.E13.m1.4.4.1.1.6.3.3.2.3.cmml">5</mn></mfrac></mrow></msup></mrow></mrow><mo id="A1.E13.m1.4.4.1.2" lspace="0em" xref="A1.E13.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E13.m1.4b"><apply id="A1.E13.m1.4.4.1.1.cmml" xref="A1.E13.m1.4.4.1"><and id="A1.E13.m1.4.4.1.1a.cmml" xref="A1.E13.m1.4.4.1"></and><apply id="A1.E13.m1.4.4.1.1b.cmml" xref="A1.E13.m1.4.4.1"><eq id="A1.E13.m1.4.4.1.1.3.cmml" xref="A1.E13.m1.4.4.1.1.3"></eq><apply id="A1.E13.m1.4.4.1.1.2.cmml" xref="A1.E13.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="A1.E13.m1.4.4.1.1.2.1.cmml" xref="A1.E13.m1.4.4.1.1.2">subscript</csymbol><ci id="A1.E13.m1.4.4.1.1.2.2.cmml" xref="A1.E13.m1.4.4.1.1.2.2">ℎ</ci><apply id="A1.E13.m1.4.4.1.1.2.3.cmml" xref="A1.E13.m1.4.4.1.1.2.3"><times id="A1.E13.m1.4.4.1.1.2.3.1.cmml" xref="A1.E13.m1.4.4.1.1.2.3.1"></times><ci id="A1.E13.m1.4.4.1.1.2.3.2.cmml" xref="A1.E13.m1.4.4.1.1.2.3.2">𝑜</ci><ci id="A1.E13.m1.4.4.1.1.2.3.3.cmml" xref="A1.E13.m1.4.4.1.1.2.3.3">𝑝</ci><ci id="A1.E13.m1.4.4.1.1.2.3.4.cmml" xref="A1.E13.m1.4.4.1.1.2.3.4">𝑡</ci></apply></apply><apply id="A1.E13.m1.4.4.1.1.4.cmml" xref="A1.E13.m1.4.4.1.1.4"><csymbol cd="ambiguous" id="A1.E13.m1.4.4.1.1.4.1.cmml" xref="A1.E13.m1.4.4.1.1.4">superscript</csymbol><apply id="A1.E13.m1.3.3.cmml" xref="A1.E13.m1.4.4.1.1.4.2.2"><divide id="A1.E13.m1.3.3.4.cmml" xref="A1.E13.m1.4.4.1.1.4.2.2"></divide><apply id="A1.E13.m1.1.1.1.cmml" xref="A1.E13.m1.1.1.1"><times id="A1.E13.m1.1.1.1.2.cmml" xref="A1.E13.m1.1.1.1.2"></times><ci id="A1.E13.m1.1.1.1.3.cmml" xref="A1.E13.m1.1.1.1.3">𝑅</ci><ci id="A1.E13.m1.1.1.1.1.cmml" xref="A1.E13.m1.1.1.1.1">𝐾</ci></apply><apply id="A1.E13.m1.3.3.3.cmml" xref="A1.E13.m1.3.3.3"><times id="A1.E13.m1.3.3.3.3.cmml" xref="A1.E13.m1.3.3.3.3"></times><ci id="A1.E13.m1.3.3.3.4.cmml" xref="A1.E13.m1.3.3.3.4">𝑛</ci><apply id="A1.E13.m1.3.3.3.5.cmml" xref="A1.E13.m1.3.3.3.5"><csymbol cd="ambiguous" id="A1.E13.m1.3.3.3.5.1.cmml" xref="A1.E13.m1.3.3.3.5">subscript</csymbol><ci id="A1.E13.m1.3.3.3.5.2.cmml" xref="A1.E13.m1.3.3.3.5.2">𝜇</ci><cn id="A1.E13.m1.3.3.3.5.3.cmml" type="integer" xref="A1.E13.m1.3.3.3.5.3">2</cn></apply><apply id="A1.E13.m1.3.3.3.6.cmml" xref="A1.E13.m1.3.3.3.6"><csymbol cd="ambiguous" id="A1.E13.m1.3.3.3.6.1.cmml" xref="A1.E13.m1.3.3.3.6">superscript</csymbol><ci id="A1.E13.m1.2.2.2.1.cmml" xref="A1.E13.m1.2.2.2.1">𝐾</ci><cn id="A1.E13.m1.3.3.3.6.3.cmml" type="integer" xref="A1.E13.m1.3.3.3.6.3">2</cn></apply><ci id="A1.E13.m1.3.3.3.7.cmml" xref="A1.E13.m1.3.3.3.7">𝑅</ci><apply id="A1.E13.m1.3.3.3.2.1.1.cmml" xref="A1.E13.m1.3.3.3.2.1"><csymbol cd="ambiguous" id="A1.E13.m1.3.3.3.2.1.1.1.cmml" xref="A1.E13.m1.3.3.3.2.1">superscript</csymbol><ci id="A1.E13.m1.3.3.3.2.1.1.2.cmml" xref="A1.E13.m1.3.3.3.2.1.1.2">𝑝</ci><ci id="A1.E13.m1.3.3.3.2.1.1.3.cmml" xref="A1.E13.m1.3.3.3.2.1.1.3">′′</ci></apply></apply></apply><apply id="A1.E13.m1.4.4.1.1.4.3.cmml" xref="A1.E13.m1.4.4.1.1.4.3"><divide id="A1.E13.m1.4.4.1.1.4.3.1.cmml" xref="A1.E13.m1.4.4.1.1.4.3.1"></divide><cn id="A1.E13.m1.4.4.1.1.4.3.2.cmml" type="integer" xref="A1.E13.m1.4.4.1.1.4.3.2">1</cn><cn id="A1.E13.m1.4.4.1.1.4.3.3.cmml" type="integer" xref="A1.E13.m1.4.4.1.1.4.3.3">5</cn></apply></apply></apply><apply id="A1.E13.m1.4.4.1.1c.cmml" xref="A1.E13.m1.4.4.1"><eq id="A1.E13.m1.4.4.1.1.5.cmml" xref="A1.E13.m1.4.4.1.1.5"></eq><share href="https://arxiv.org/html/2410.05218v1#A1.E13.m1.4.4.1.1.4.cmml" id="A1.E13.m1.4.4.1.1d.cmml" xref="A1.E13.m1.4.4.1"></share><apply id="A1.E13.m1.4.4.1.1.6.cmml" xref="A1.E13.m1.4.4.1.1.6"><times id="A1.E13.m1.4.4.1.1.6.1.cmml" xref="A1.E13.m1.4.4.1.1.6.1"></times><ci id="A1.E13.m1.4.4.1.1.6.2.cmml" xref="A1.E13.m1.4.4.1.1.6.2">𝐶</ci><apply id="A1.E13.m1.4.4.1.1.6.3.cmml" xref="A1.E13.m1.4.4.1.1.6.3"><csymbol cd="ambiguous" id="A1.E13.m1.4.4.1.1.6.3.1.cmml" xref="A1.E13.m1.4.4.1.1.6.3">superscript</csymbol><ci id="A1.E13.m1.4.4.1.1.6.3.2.cmml" xref="A1.E13.m1.4.4.1.1.6.3.2">𝑛</ci><apply id="A1.E13.m1.4.4.1.1.6.3.3.cmml" xref="A1.E13.m1.4.4.1.1.6.3.3"><minus id="A1.E13.m1.4.4.1.1.6.3.3.1.cmml" xref="A1.E13.m1.4.4.1.1.6.3.3"></minus><apply id="A1.E13.m1.4.4.1.1.6.3.3.2.cmml" xref="A1.E13.m1.4.4.1.1.6.3.3.2"><divide id="A1.E13.m1.4.4.1.1.6.3.3.2.1.cmml" xref="A1.E13.m1.4.4.1.1.6.3.3.2"></divide><cn id="A1.E13.m1.4.4.1.1.6.3.3.2.2.cmml" type="integer" xref="A1.E13.m1.4.4.1.1.6.3.3.2.2">1</cn><cn id="A1.E13.m1.4.4.1.1.6.3.3.2.3.cmml" type="integer" xref="A1.E13.m1.4.4.1.1.6.3.3.2.3">5</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E13.m1.4c">h_{opt}=\left(\frac{R(K)}{n\mu_{2}(K)^{2}R(p^{\prime\prime})}\right)^{1/5}=Cn^%
{-\frac{1}{5}}.</annotation><annotation encoding="application/x-llamapun" id="A1.E13.m1.4d">italic_h start_POSTSUBSCRIPT italic_o italic_p italic_t end_POSTSUBSCRIPT = ( divide start_ARG italic_R ( italic_K ) end_ARG start_ARG italic_n italic_μ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( italic_K ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_R ( italic_p start_POSTSUPERSCRIPT ′ ′ end_POSTSUPERSCRIPT ) end_ARG ) start_POSTSUPERSCRIPT 1 / 5 end_POSTSUPERSCRIPT = italic_C italic_n start_POSTSUPERSCRIPT - divide start_ARG 1 end_ARG start_ARG 5 end_ARG end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS5.SSS1.p2.5">It’s important to note that this expression involves many unknown quantities related to the true density <math alttext="p" class="ltx_Math" display="inline" id="A1.SS5.SSS1.p2.2.m1.1"><semantics id="A1.SS5.SSS1.p2.2.m1.1a"><mi id="A1.SS5.SSS1.p2.2.m1.1.1" xref="A1.SS5.SSS1.p2.2.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="A1.SS5.SSS1.p2.2.m1.1b"><ci id="A1.SS5.SSS1.p2.2.m1.1.1.cmml" xref="A1.SS5.SSS1.p2.2.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.SSS1.p2.2.m1.1c">p</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.SSS1.p2.2.m1.1d">italic_p</annotation></semantics></math>, such as the average curvature <math alttext="R(p^{\prime\prime})" class="ltx_Math" display="inline" id="A1.SS5.SSS1.p2.3.m2.1"><semantics id="A1.SS5.SSS1.p2.3.m2.1a"><mrow id="A1.SS5.SSS1.p2.3.m2.1.1" xref="A1.SS5.SSS1.p2.3.m2.1.1.cmml"><mi id="A1.SS5.SSS1.p2.3.m2.1.1.3" xref="A1.SS5.SSS1.p2.3.m2.1.1.3.cmml">R</mi><mo id="A1.SS5.SSS1.p2.3.m2.1.1.2" xref="A1.SS5.SSS1.p2.3.m2.1.1.2.cmml">⁢</mo><mrow id="A1.SS5.SSS1.p2.3.m2.1.1.1.1" xref="A1.SS5.SSS1.p2.3.m2.1.1.1.1.1.cmml"><mo id="A1.SS5.SSS1.p2.3.m2.1.1.1.1.2" stretchy="false" xref="A1.SS5.SSS1.p2.3.m2.1.1.1.1.1.cmml">(</mo><msup id="A1.SS5.SSS1.p2.3.m2.1.1.1.1.1" xref="A1.SS5.SSS1.p2.3.m2.1.1.1.1.1.cmml"><mi id="A1.SS5.SSS1.p2.3.m2.1.1.1.1.1.2" xref="A1.SS5.SSS1.p2.3.m2.1.1.1.1.1.2.cmml">p</mi><mo id="A1.SS5.SSS1.p2.3.m2.1.1.1.1.1.3" xref="A1.SS5.SSS1.p2.3.m2.1.1.1.1.1.3.cmml">′′</mo></msup><mo id="A1.SS5.SSS1.p2.3.m2.1.1.1.1.3" stretchy="false" xref="A1.SS5.SSS1.p2.3.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS5.SSS1.p2.3.m2.1b"><apply id="A1.SS5.SSS1.p2.3.m2.1.1.cmml" xref="A1.SS5.SSS1.p2.3.m2.1.1"><times id="A1.SS5.SSS1.p2.3.m2.1.1.2.cmml" xref="A1.SS5.SSS1.p2.3.m2.1.1.2"></times><ci id="A1.SS5.SSS1.p2.3.m2.1.1.3.cmml" xref="A1.SS5.SSS1.p2.3.m2.1.1.3">𝑅</ci><apply id="A1.SS5.SSS1.p2.3.m2.1.1.1.1.1.cmml" xref="A1.SS5.SSS1.p2.3.m2.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS5.SSS1.p2.3.m2.1.1.1.1.1.1.cmml" xref="A1.SS5.SSS1.p2.3.m2.1.1.1.1">superscript</csymbol><ci id="A1.SS5.SSS1.p2.3.m2.1.1.1.1.1.2.cmml" xref="A1.SS5.SSS1.p2.3.m2.1.1.1.1.1.2">𝑝</ci><ci id="A1.SS5.SSS1.p2.3.m2.1.1.1.1.1.3.cmml" xref="A1.SS5.SSS1.p2.3.m2.1.1.1.1.1.3">′′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.SSS1.p2.3.m2.1c">R(p^{\prime\prime})</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.SSS1.p2.3.m2.1d">italic_R ( italic_p start_POSTSUPERSCRIPT ′ ′ end_POSTSUPERSCRIPT )</annotation></semantics></math>,
which is not known a priori. The key insight from this derivation is therefore the <math alttext="n^{-1/5}" class="ltx_Math" display="inline" id="A1.SS5.SSS1.p2.4.m3.1"><semantics id="A1.SS5.SSS1.p2.4.m3.1a"><msup id="A1.SS5.SSS1.p2.4.m3.1.1" xref="A1.SS5.SSS1.p2.4.m3.1.1.cmml"><mi id="A1.SS5.SSS1.p2.4.m3.1.1.2" xref="A1.SS5.SSS1.p2.4.m3.1.1.2.cmml">n</mi><mrow id="A1.SS5.SSS1.p2.4.m3.1.1.3" xref="A1.SS5.SSS1.p2.4.m3.1.1.3.cmml"><mo id="A1.SS5.SSS1.p2.4.m3.1.1.3a" xref="A1.SS5.SSS1.p2.4.m3.1.1.3.cmml">−</mo><mrow id="A1.SS5.SSS1.p2.4.m3.1.1.3.2" xref="A1.SS5.SSS1.p2.4.m3.1.1.3.2.cmml"><mn id="A1.SS5.SSS1.p2.4.m3.1.1.3.2.2" xref="A1.SS5.SSS1.p2.4.m3.1.1.3.2.2.cmml">1</mn><mo id="A1.SS5.SSS1.p2.4.m3.1.1.3.2.1" xref="A1.SS5.SSS1.p2.4.m3.1.1.3.2.1.cmml">/</mo><mn id="A1.SS5.SSS1.p2.4.m3.1.1.3.2.3" xref="A1.SS5.SSS1.p2.4.m3.1.1.3.2.3.cmml">5</mn></mrow></mrow></msup><annotation-xml encoding="MathML-Content" id="A1.SS5.SSS1.p2.4.m3.1b"><apply id="A1.SS5.SSS1.p2.4.m3.1.1.cmml" xref="A1.SS5.SSS1.p2.4.m3.1.1"><csymbol cd="ambiguous" id="A1.SS5.SSS1.p2.4.m3.1.1.1.cmml" xref="A1.SS5.SSS1.p2.4.m3.1.1">superscript</csymbol><ci id="A1.SS5.SSS1.p2.4.m3.1.1.2.cmml" xref="A1.SS5.SSS1.p2.4.m3.1.1.2">𝑛</ci><apply id="A1.SS5.SSS1.p2.4.m3.1.1.3.cmml" xref="A1.SS5.SSS1.p2.4.m3.1.1.3"><minus id="A1.SS5.SSS1.p2.4.m3.1.1.3.1.cmml" xref="A1.SS5.SSS1.p2.4.m3.1.1.3"></minus><apply id="A1.SS5.SSS1.p2.4.m3.1.1.3.2.cmml" xref="A1.SS5.SSS1.p2.4.m3.1.1.3.2"><divide id="A1.SS5.SSS1.p2.4.m3.1.1.3.2.1.cmml" xref="A1.SS5.SSS1.p2.4.m3.1.1.3.2.1"></divide><cn id="A1.SS5.SSS1.p2.4.m3.1.1.3.2.2.cmml" type="integer" xref="A1.SS5.SSS1.p2.4.m3.1.1.3.2.2">1</cn><cn id="A1.SS5.SSS1.p2.4.m3.1.1.3.2.3.cmml" type="integer" xref="A1.SS5.SSS1.p2.4.m3.1.1.3.2.3">5</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.SSS1.p2.4.m3.1c">n^{-1/5}</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.SSS1.p2.4.m3.1d">italic_n start_POSTSUPERSCRIPT - 1 / 5 end_POSTSUPERSCRIPT</annotation></semantics></math> scaling of the optimal bandwidth.
In practice, there are many methods for estimating the pre-coefficient <math alttext="C" class="ltx_Math" display="inline" id="A1.SS5.SSS1.p2.5.m4.1"><semantics id="A1.SS5.SSS1.p2.5.m4.1a"><mi id="A1.SS5.SSS1.p2.5.m4.1.1" xref="A1.SS5.SSS1.p2.5.m4.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="A1.SS5.SSS1.p2.5.m4.1b"><ci id="A1.SS5.SSS1.p2.5.m4.1.1.cmml" xref="A1.SS5.SSS1.p2.5.m4.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.SSS1.p2.5.m4.1c">C</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.SSS1.p2.5.m4.1d">italic_C</annotation></semantics></math> from data, such as Silverman’s rule of thumb <cite class="ltx_cite ltx_citemacro_citep">(Silverman, <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib35" title="">2018</a>)</cite>:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="h=0.9\min(\hat{\sigma},\frac{\text{IQR}}{1.34})n^{-\frac{1}{5}}," class="ltx_Math" display="block" id="A1.E14.m1.4"><semantics id="A1.E14.m1.4a"><mrow id="A1.E14.m1.4.4.1" xref="A1.E14.m1.4.4.1.1.cmml"><mrow id="A1.E14.m1.4.4.1.1" xref="A1.E14.m1.4.4.1.1.cmml"><mi id="A1.E14.m1.4.4.1.1.2" xref="A1.E14.m1.4.4.1.1.2.cmml">h</mi><mo id="A1.E14.m1.4.4.1.1.1" xref="A1.E14.m1.4.4.1.1.1.cmml">=</mo><mrow id="A1.E14.m1.4.4.1.1.3" xref="A1.E14.m1.4.4.1.1.3.cmml"><mn id="A1.E14.m1.4.4.1.1.3.2" xref="A1.E14.m1.4.4.1.1.3.2.cmml">0.9</mn><mo id="A1.E14.m1.4.4.1.1.3.1" lspace="0.167em" xref="A1.E14.m1.4.4.1.1.3.1.cmml">⁢</mo><mrow id="A1.E14.m1.4.4.1.1.3.3.2" xref="A1.E14.m1.4.4.1.1.3.3.1.cmml"><mi id="A1.E14.m1.1.1" xref="A1.E14.m1.1.1.cmml">min</mi><mo id="A1.E14.m1.4.4.1.1.3.3.2a" xref="A1.E14.m1.4.4.1.1.3.3.1.cmml">⁡</mo><mrow id="A1.E14.m1.4.4.1.1.3.3.2.1" xref="A1.E14.m1.4.4.1.1.3.3.1.cmml"><mo id="A1.E14.m1.4.4.1.1.3.3.2.1.1" stretchy="false" xref="A1.E14.m1.4.4.1.1.3.3.1.cmml">(</mo><mover accent="true" id="A1.E14.m1.2.2" xref="A1.E14.m1.2.2.cmml"><mi id="A1.E14.m1.2.2.2" xref="A1.E14.m1.2.2.2.cmml">σ</mi><mo id="A1.E14.m1.2.2.1" xref="A1.E14.m1.2.2.1.cmml">^</mo></mover><mo id="A1.E14.m1.4.4.1.1.3.3.2.1.2" xref="A1.E14.m1.4.4.1.1.3.3.1.cmml">,</mo><mfrac id="A1.E14.m1.3.3" xref="A1.E14.m1.3.3.cmml"><mtext id="A1.E14.m1.3.3.2" xref="A1.E14.m1.3.3.2a.cmml">IQR</mtext><mn id="A1.E14.m1.3.3.3" xref="A1.E14.m1.3.3.3.cmml">1.34</mn></mfrac><mo id="A1.E14.m1.4.4.1.1.3.3.2.1.3" stretchy="false" xref="A1.E14.m1.4.4.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="A1.E14.m1.4.4.1.1.3.1a" xref="A1.E14.m1.4.4.1.1.3.1.cmml">⁢</mo><msup id="A1.E14.m1.4.4.1.1.3.4" xref="A1.E14.m1.4.4.1.1.3.4.cmml"><mi id="A1.E14.m1.4.4.1.1.3.4.2" xref="A1.E14.m1.4.4.1.1.3.4.2.cmml">n</mi><mrow id="A1.E14.m1.4.4.1.1.3.4.3" xref="A1.E14.m1.4.4.1.1.3.4.3.cmml"><mo id="A1.E14.m1.4.4.1.1.3.4.3a" xref="A1.E14.m1.4.4.1.1.3.4.3.cmml">−</mo><mfrac id="A1.E14.m1.4.4.1.1.3.4.3.2" xref="A1.E14.m1.4.4.1.1.3.4.3.2.cmml"><mn id="A1.E14.m1.4.4.1.1.3.4.3.2.2" xref="A1.E14.m1.4.4.1.1.3.4.3.2.2.cmml">1</mn><mn id="A1.E14.m1.4.4.1.1.3.4.3.2.3" xref="A1.E14.m1.4.4.1.1.3.4.3.2.3.cmml">5</mn></mfrac></mrow></msup></mrow></mrow><mo id="A1.E14.m1.4.4.1.2" xref="A1.E14.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E14.m1.4b"><apply id="A1.E14.m1.4.4.1.1.cmml" xref="A1.E14.m1.4.4.1"><eq id="A1.E14.m1.4.4.1.1.1.cmml" xref="A1.E14.m1.4.4.1.1.1"></eq><ci id="A1.E14.m1.4.4.1.1.2.cmml" xref="A1.E14.m1.4.4.1.1.2">ℎ</ci><apply id="A1.E14.m1.4.4.1.1.3.cmml" xref="A1.E14.m1.4.4.1.1.3"><times id="A1.E14.m1.4.4.1.1.3.1.cmml" xref="A1.E14.m1.4.4.1.1.3.1"></times><cn id="A1.E14.m1.4.4.1.1.3.2.cmml" type="float" xref="A1.E14.m1.4.4.1.1.3.2">0.9</cn><apply id="A1.E14.m1.4.4.1.1.3.3.1.cmml" xref="A1.E14.m1.4.4.1.1.3.3.2"><min id="A1.E14.m1.1.1.cmml" xref="A1.E14.m1.1.1"></min><apply id="A1.E14.m1.2.2.cmml" xref="A1.E14.m1.2.2"><ci id="A1.E14.m1.2.2.1.cmml" xref="A1.E14.m1.2.2.1">^</ci><ci id="A1.E14.m1.2.2.2.cmml" xref="A1.E14.m1.2.2.2">𝜎</ci></apply><apply id="A1.E14.m1.3.3.cmml" xref="A1.E14.m1.3.3"><divide id="A1.E14.m1.3.3.1.cmml" xref="A1.E14.m1.3.3"></divide><ci id="A1.E14.m1.3.3.2a.cmml" xref="A1.E14.m1.3.3.2"><mtext id="A1.E14.m1.3.3.2.cmml" xref="A1.E14.m1.3.3.2">IQR</mtext></ci><cn id="A1.E14.m1.3.3.3.cmml" type="float" xref="A1.E14.m1.3.3.3">1.34</cn></apply></apply><apply id="A1.E14.m1.4.4.1.1.3.4.cmml" xref="A1.E14.m1.4.4.1.1.3.4"><csymbol cd="ambiguous" id="A1.E14.m1.4.4.1.1.3.4.1.cmml" xref="A1.E14.m1.4.4.1.1.3.4">superscript</csymbol><ci id="A1.E14.m1.4.4.1.1.3.4.2.cmml" xref="A1.E14.m1.4.4.1.1.3.4.2">𝑛</ci><apply id="A1.E14.m1.4.4.1.1.3.4.3.cmml" xref="A1.E14.m1.4.4.1.1.3.4.3"><minus id="A1.E14.m1.4.4.1.1.3.4.3.1.cmml" xref="A1.E14.m1.4.4.1.1.3.4.3"></minus><apply id="A1.E14.m1.4.4.1.1.3.4.3.2.cmml" xref="A1.E14.m1.4.4.1.1.3.4.3.2"><divide id="A1.E14.m1.4.4.1.1.3.4.3.2.1.cmml" xref="A1.E14.m1.4.4.1.1.3.4.3.2"></divide><cn id="A1.E14.m1.4.4.1.1.3.4.3.2.2.cmml" type="integer" xref="A1.E14.m1.4.4.1.1.3.4.3.2.2">1</cn><cn id="A1.E14.m1.4.4.1.1.3.4.3.2.3.cmml" type="integer" xref="A1.E14.m1.4.4.1.1.3.4.3.2.3">5</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E14.m1.4c">h=0.9\min(\hat{\sigma},\frac{\text{IQR}}{1.34})n^{-\frac{1}{5}},</annotation><annotation encoding="application/x-llamapun" id="A1.E14.m1.4d">italic_h = 0.9 roman_min ( over^ start_ARG italic_σ end_ARG , divide start_ARG IQR end_ARG start_ARG 1.34 end_ARG ) italic_n start_POSTSUPERSCRIPT - divide start_ARG 1 end_ARG start_ARG 5 end_ARG end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS5.SSS1.p2.8">where <math alttext="\hat{\sigma}" class="ltx_Math" display="inline" id="A1.SS5.SSS1.p2.6.m1.1"><semantics id="A1.SS5.SSS1.p2.6.m1.1a"><mover accent="true" id="A1.SS5.SSS1.p2.6.m1.1.1" xref="A1.SS5.SSS1.p2.6.m1.1.1.cmml"><mi id="A1.SS5.SSS1.p2.6.m1.1.1.2" xref="A1.SS5.SSS1.p2.6.m1.1.1.2.cmml">σ</mi><mo id="A1.SS5.SSS1.p2.6.m1.1.1.1" xref="A1.SS5.SSS1.p2.6.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="A1.SS5.SSS1.p2.6.m1.1b"><apply id="A1.SS5.SSS1.p2.6.m1.1.1.cmml" xref="A1.SS5.SSS1.p2.6.m1.1.1"><ci id="A1.SS5.SSS1.p2.6.m1.1.1.1.cmml" xref="A1.SS5.SSS1.p2.6.m1.1.1.1">^</ci><ci id="A1.SS5.SSS1.p2.6.m1.1.1.2.cmml" xref="A1.SS5.SSS1.p2.6.m1.1.1.2">𝜎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.SSS1.p2.6.m1.1c">\hat{\sigma}</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.SSS1.p2.6.m1.1d">over^ start_ARG italic_σ end_ARG</annotation></semantics></math> is the sample standard deviation, IQR is the interquartile range, and <math alttext="n" class="ltx_Math" display="inline" id="A1.SS5.SSS1.p2.7.m2.1"><semantics id="A1.SS5.SSS1.p2.7.m2.1a"><mi id="A1.SS5.SSS1.p2.7.m2.1.1" xref="A1.SS5.SSS1.p2.7.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="A1.SS5.SSS1.p2.7.m2.1b"><ci id="A1.SS5.SSS1.p2.7.m2.1.1.cmml" xref="A1.SS5.SSS1.p2.7.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.SSS1.p2.7.m2.1c">n</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.SSS1.p2.7.m2.1d">italic_n</annotation></semantics></math> is the sample size.
This rule is derived heuristically based on minimizing the AMISE (Equation <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.E12" title="Equation 12 ‣ A.5.1 Optimal Bandwidth ‣ A.5 Additional notes on Kernel Density Estimation ‣ Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">12</span></a>).
The <math alttext="n^{-1/5}" class="ltx_Math" display="inline" id="A1.SS5.SSS1.p2.8.m3.1"><semantics id="A1.SS5.SSS1.p2.8.m3.1a"><msup id="A1.SS5.SSS1.p2.8.m3.1.1" xref="A1.SS5.SSS1.p2.8.m3.1.1.cmml"><mi id="A1.SS5.SSS1.p2.8.m3.1.1.2" xref="A1.SS5.SSS1.p2.8.m3.1.1.2.cmml">n</mi><mrow id="A1.SS5.SSS1.p2.8.m3.1.1.3" xref="A1.SS5.SSS1.p2.8.m3.1.1.3.cmml"><mo id="A1.SS5.SSS1.p2.8.m3.1.1.3a" xref="A1.SS5.SSS1.p2.8.m3.1.1.3.cmml">−</mo><mrow id="A1.SS5.SSS1.p2.8.m3.1.1.3.2" xref="A1.SS5.SSS1.p2.8.m3.1.1.3.2.cmml"><mn id="A1.SS5.SSS1.p2.8.m3.1.1.3.2.2" xref="A1.SS5.SSS1.p2.8.m3.1.1.3.2.2.cmml">1</mn><mo id="A1.SS5.SSS1.p2.8.m3.1.1.3.2.1" xref="A1.SS5.SSS1.p2.8.m3.1.1.3.2.1.cmml">/</mo><mn id="A1.SS5.SSS1.p2.8.m3.1.1.3.2.3" xref="A1.SS5.SSS1.p2.8.m3.1.1.3.2.3.cmml">5</mn></mrow></mrow></msup><annotation-xml encoding="MathML-Content" id="A1.SS5.SSS1.p2.8.m3.1b"><apply id="A1.SS5.SSS1.p2.8.m3.1.1.cmml" xref="A1.SS5.SSS1.p2.8.m3.1.1"><csymbol cd="ambiguous" id="A1.SS5.SSS1.p2.8.m3.1.1.1.cmml" xref="A1.SS5.SSS1.p2.8.m3.1.1">superscript</csymbol><ci id="A1.SS5.SSS1.p2.8.m3.1.1.2.cmml" xref="A1.SS5.SSS1.p2.8.m3.1.1.2">𝑛</ci><apply id="A1.SS5.SSS1.p2.8.m3.1.1.3.cmml" xref="A1.SS5.SSS1.p2.8.m3.1.1.3"><minus id="A1.SS5.SSS1.p2.8.m3.1.1.3.1.cmml" xref="A1.SS5.SSS1.p2.8.m3.1.1.3"></minus><apply id="A1.SS5.SSS1.p2.8.m3.1.1.3.2.cmml" xref="A1.SS5.SSS1.p2.8.m3.1.1.3.2"><divide id="A1.SS5.SSS1.p2.8.m3.1.1.3.2.1.cmml" xref="A1.SS5.SSS1.p2.8.m3.1.1.3.2.1"></divide><cn id="A1.SS5.SSS1.p2.8.m3.1.1.3.2.2.cmml" type="integer" xref="A1.SS5.SSS1.p2.8.m3.1.1.3.2.2">1</cn><cn id="A1.SS5.SSS1.p2.8.m3.1.1.3.2.3.cmml" type="integer" xref="A1.SS5.SSS1.p2.8.m3.1.1.3.2.3">5</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.SSS1.p2.8.m3.1c">n^{-1/5}</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.SSS1.p2.8.m3.1d">italic_n start_POSTSUPERSCRIPT - 1 / 5 end_POSTSUPERSCRIPT</annotation></semantics></math> scaling reveals a fundamental trade-off in kernel density estimation: as more data becomes available, we can afford to use a narrower kernel, but the rate at which we can narrow the kernel is relatively slow.</p>
</div>
</section>
<section class="ltx_subsubsection" id="A1.SS5.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.5.2 </span>Optimal kernel shape</h4>
<div class="ltx_para ltx_noindent" id="A1.SS5.SSS2.p1">
<p class="ltx_p" id="A1.SS5.SSS2.p1.1">The kernel function <math alttext="K" class="ltx_Math" display="inline" id="A1.SS5.SSS2.p1.1.m1.1"><semantics id="A1.SS5.SSS2.p1.1.m1.1a"><mi id="A1.SS5.SSS2.p1.1.m1.1.1" xref="A1.SS5.SSS2.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A1.SS5.SSS2.p1.1.m1.1b"><ci id="A1.SS5.SSS2.p1.1.m1.1.1.cmml" xref="A1.SS5.SSS2.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.SSS2.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.SSS2.p1.1.m1.1d">italic_K</annotation></semantics></math> can take various forms. Common choices include:</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS5.SSS2.p2">
<ul class="ltx_itemize" id="A1.I1">
<li class="ltx_item" id="A1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I1.i1.p1">
<p class="ltx_p" id="A1.I1.i1.p1.1">Gaussian kernel: <math alttext="K(u)=\frac{1}{\sqrt{2\pi}}e^{-\frac{1}{2}u^{2}}" class="ltx_Math" display="inline" id="A1.I1.i1.p1.1.m1.1"><semantics id="A1.I1.i1.p1.1.m1.1a"><mrow id="A1.I1.i1.p1.1.m1.1.2" xref="A1.I1.i1.p1.1.m1.1.2.cmml"><mrow id="A1.I1.i1.p1.1.m1.1.2.2" xref="A1.I1.i1.p1.1.m1.1.2.2.cmml"><mi id="A1.I1.i1.p1.1.m1.1.2.2.2" xref="A1.I1.i1.p1.1.m1.1.2.2.2.cmml">K</mi><mo id="A1.I1.i1.p1.1.m1.1.2.2.1" xref="A1.I1.i1.p1.1.m1.1.2.2.1.cmml">⁢</mo><mrow id="A1.I1.i1.p1.1.m1.1.2.2.3.2" xref="A1.I1.i1.p1.1.m1.1.2.2.cmml"><mo id="A1.I1.i1.p1.1.m1.1.2.2.3.2.1" stretchy="false" xref="A1.I1.i1.p1.1.m1.1.2.2.cmml">(</mo><mi id="A1.I1.i1.p1.1.m1.1.1" xref="A1.I1.i1.p1.1.m1.1.1.cmml">u</mi><mo id="A1.I1.i1.p1.1.m1.1.2.2.3.2.2" stretchy="false" xref="A1.I1.i1.p1.1.m1.1.2.2.cmml">)</mo></mrow></mrow><mo id="A1.I1.i1.p1.1.m1.1.2.1" xref="A1.I1.i1.p1.1.m1.1.2.1.cmml">=</mo><mrow id="A1.I1.i1.p1.1.m1.1.2.3" xref="A1.I1.i1.p1.1.m1.1.2.3.cmml"><mfrac id="A1.I1.i1.p1.1.m1.1.2.3.2" xref="A1.I1.i1.p1.1.m1.1.2.3.2.cmml"><mn id="A1.I1.i1.p1.1.m1.1.2.3.2.2" xref="A1.I1.i1.p1.1.m1.1.2.3.2.2.cmml">1</mn><msqrt id="A1.I1.i1.p1.1.m1.1.2.3.2.3" xref="A1.I1.i1.p1.1.m1.1.2.3.2.3.cmml"><mrow id="A1.I1.i1.p1.1.m1.1.2.3.2.3.2" xref="A1.I1.i1.p1.1.m1.1.2.3.2.3.2.cmml"><mn id="A1.I1.i1.p1.1.m1.1.2.3.2.3.2.2" xref="A1.I1.i1.p1.1.m1.1.2.3.2.3.2.2.cmml">2</mn><mo id="A1.I1.i1.p1.1.m1.1.2.3.2.3.2.1" xref="A1.I1.i1.p1.1.m1.1.2.3.2.3.2.1.cmml">⁢</mo><mi id="A1.I1.i1.p1.1.m1.1.2.3.2.3.2.3" xref="A1.I1.i1.p1.1.m1.1.2.3.2.3.2.3.cmml">π</mi></mrow></msqrt></mfrac><mo id="A1.I1.i1.p1.1.m1.1.2.3.1" xref="A1.I1.i1.p1.1.m1.1.2.3.1.cmml">⁢</mo><msup id="A1.I1.i1.p1.1.m1.1.2.3.3" xref="A1.I1.i1.p1.1.m1.1.2.3.3.cmml"><mi id="A1.I1.i1.p1.1.m1.1.2.3.3.2" xref="A1.I1.i1.p1.1.m1.1.2.3.3.2.cmml">e</mi><mrow id="A1.I1.i1.p1.1.m1.1.2.3.3.3" xref="A1.I1.i1.p1.1.m1.1.2.3.3.3.cmml"><mo id="A1.I1.i1.p1.1.m1.1.2.3.3.3a" xref="A1.I1.i1.p1.1.m1.1.2.3.3.3.cmml">−</mo><mrow id="A1.I1.i1.p1.1.m1.1.2.3.3.3.2" xref="A1.I1.i1.p1.1.m1.1.2.3.3.3.2.cmml"><mfrac id="A1.I1.i1.p1.1.m1.1.2.3.3.3.2.2" xref="A1.I1.i1.p1.1.m1.1.2.3.3.3.2.2.cmml"><mn id="A1.I1.i1.p1.1.m1.1.2.3.3.3.2.2.2" xref="A1.I1.i1.p1.1.m1.1.2.3.3.3.2.2.2.cmml">1</mn><mn id="A1.I1.i1.p1.1.m1.1.2.3.3.3.2.2.3" xref="A1.I1.i1.p1.1.m1.1.2.3.3.3.2.2.3.cmml">2</mn></mfrac><mo id="A1.I1.i1.p1.1.m1.1.2.3.3.3.2.1" xref="A1.I1.i1.p1.1.m1.1.2.3.3.3.2.1.cmml">⁢</mo><msup id="A1.I1.i1.p1.1.m1.1.2.3.3.3.2.3" xref="A1.I1.i1.p1.1.m1.1.2.3.3.3.2.3.cmml"><mi id="A1.I1.i1.p1.1.m1.1.2.3.3.3.2.3.2" xref="A1.I1.i1.p1.1.m1.1.2.3.3.3.2.3.2.cmml">u</mi><mn id="A1.I1.i1.p1.1.m1.1.2.3.3.3.2.3.3" xref="A1.I1.i1.p1.1.m1.1.2.3.3.3.2.3.3.cmml">2</mn></msup></mrow></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.I1.i1.p1.1.m1.1b"><apply id="A1.I1.i1.p1.1.m1.1.2.cmml" xref="A1.I1.i1.p1.1.m1.1.2"><eq id="A1.I1.i1.p1.1.m1.1.2.1.cmml" xref="A1.I1.i1.p1.1.m1.1.2.1"></eq><apply id="A1.I1.i1.p1.1.m1.1.2.2.cmml" xref="A1.I1.i1.p1.1.m1.1.2.2"><times id="A1.I1.i1.p1.1.m1.1.2.2.1.cmml" xref="A1.I1.i1.p1.1.m1.1.2.2.1"></times><ci id="A1.I1.i1.p1.1.m1.1.2.2.2.cmml" xref="A1.I1.i1.p1.1.m1.1.2.2.2">𝐾</ci><ci id="A1.I1.i1.p1.1.m1.1.1.cmml" xref="A1.I1.i1.p1.1.m1.1.1">𝑢</ci></apply><apply id="A1.I1.i1.p1.1.m1.1.2.3.cmml" xref="A1.I1.i1.p1.1.m1.1.2.3"><times id="A1.I1.i1.p1.1.m1.1.2.3.1.cmml" xref="A1.I1.i1.p1.1.m1.1.2.3.1"></times><apply id="A1.I1.i1.p1.1.m1.1.2.3.2.cmml" xref="A1.I1.i1.p1.1.m1.1.2.3.2"><divide id="A1.I1.i1.p1.1.m1.1.2.3.2.1.cmml" xref="A1.I1.i1.p1.1.m1.1.2.3.2"></divide><cn id="A1.I1.i1.p1.1.m1.1.2.3.2.2.cmml" type="integer" xref="A1.I1.i1.p1.1.m1.1.2.3.2.2">1</cn><apply id="A1.I1.i1.p1.1.m1.1.2.3.2.3.cmml" xref="A1.I1.i1.p1.1.m1.1.2.3.2.3"><root id="A1.I1.i1.p1.1.m1.1.2.3.2.3a.cmml" xref="A1.I1.i1.p1.1.m1.1.2.3.2.3"></root><apply id="A1.I1.i1.p1.1.m1.1.2.3.2.3.2.cmml" xref="A1.I1.i1.p1.1.m1.1.2.3.2.3.2"><times id="A1.I1.i1.p1.1.m1.1.2.3.2.3.2.1.cmml" xref="A1.I1.i1.p1.1.m1.1.2.3.2.3.2.1"></times><cn id="A1.I1.i1.p1.1.m1.1.2.3.2.3.2.2.cmml" type="integer" xref="A1.I1.i1.p1.1.m1.1.2.3.2.3.2.2">2</cn><ci id="A1.I1.i1.p1.1.m1.1.2.3.2.3.2.3.cmml" xref="A1.I1.i1.p1.1.m1.1.2.3.2.3.2.3">𝜋</ci></apply></apply></apply><apply id="A1.I1.i1.p1.1.m1.1.2.3.3.cmml" xref="A1.I1.i1.p1.1.m1.1.2.3.3"><csymbol cd="ambiguous" id="A1.I1.i1.p1.1.m1.1.2.3.3.1.cmml" xref="A1.I1.i1.p1.1.m1.1.2.3.3">superscript</csymbol><ci id="A1.I1.i1.p1.1.m1.1.2.3.3.2.cmml" xref="A1.I1.i1.p1.1.m1.1.2.3.3.2">𝑒</ci><apply id="A1.I1.i1.p1.1.m1.1.2.3.3.3.cmml" xref="A1.I1.i1.p1.1.m1.1.2.3.3.3"><minus id="A1.I1.i1.p1.1.m1.1.2.3.3.3.1.cmml" xref="A1.I1.i1.p1.1.m1.1.2.3.3.3"></minus><apply id="A1.I1.i1.p1.1.m1.1.2.3.3.3.2.cmml" xref="A1.I1.i1.p1.1.m1.1.2.3.3.3.2"><times id="A1.I1.i1.p1.1.m1.1.2.3.3.3.2.1.cmml" xref="A1.I1.i1.p1.1.m1.1.2.3.3.3.2.1"></times><apply id="A1.I1.i1.p1.1.m1.1.2.3.3.3.2.2.cmml" xref="A1.I1.i1.p1.1.m1.1.2.3.3.3.2.2"><divide id="A1.I1.i1.p1.1.m1.1.2.3.3.3.2.2.1.cmml" xref="A1.I1.i1.p1.1.m1.1.2.3.3.3.2.2"></divide><cn id="A1.I1.i1.p1.1.m1.1.2.3.3.3.2.2.2.cmml" type="integer" xref="A1.I1.i1.p1.1.m1.1.2.3.3.3.2.2.2">1</cn><cn id="A1.I1.i1.p1.1.m1.1.2.3.3.3.2.2.3.cmml" type="integer" xref="A1.I1.i1.p1.1.m1.1.2.3.3.3.2.2.3">2</cn></apply><apply id="A1.I1.i1.p1.1.m1.1.2.3.3.3.2.3.cmml" xref="A1.I1.i1.p1.1.m1.1.2.3.3.3.2.3"><csymbol cd="ambiguous" id="A1.I1.i1.p1.1.m1.1.2.3.3.3.2.3.1.cmml" xref="A1.I1.i1.p1.1.m1.1.2.3.3.3.2.3">superscript</csymbol><ci id="A1.I1.i1.p1.1.m1.1.2.3.3.3.2.3.2.cmml" xref="A1.I1.i1.p1.1.m1.1.2.3.3.3.2.3.2">𝑢</ci><cn id="A1.I1.i1.p1.1.m1.1.2.3.3.3.2.3.3.cmml" type="integer" xref="A1.I1.i1.p1.1.m1.1.2.3.3.3.2.3.3">2</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i1.p1.1.m1.1c">K(u)=\frac{1}{\sqrt{2\pi}}e^{-\frac{1}{2}u^{2}}</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i1.p1.1.m1.1d">italic_K ( italic_u ) = divide start_ARG 1 end_ARG start_ARG square-root start_ARG 2 italic_π end_ARG end_ARG italic_e start_POSTSUPERSCRIPT - divide start_ARG 1 end_ARG start_ARG 2 end_ARG italic_u start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math></p>
</div>
</li>
<li class="ltx_item" id="A1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I1.i2.p1">
<p class="ltx_p" id="A1.I1.i2.p1.1">Exponential kernel: <math alttext="K(u)=\frac{1}{2}e^{-|u|}" class="ltx_Math" display="inline" id="A1.I1.i2.p1.1.m1.2"><semantics id="A1.I1.i2.p1.1.m1.2a"><mrow id="A1.I1.i2.p1.1.m1.2.3" xref="A1.I1.i2.p1.1.m1.2.3.cmml"><mrow id="A1.I1.i2.p1.1.m1.2.3.2" xref="A1.I1.i2.p1.1.m1.2.3.2.cmml"><mi id="A1.I1.i2.p1.1.m1.2.3.2.2" xref="A1.I1.i2.p1.1.m1.2.3.2.2.cmml">K</mi><mo id="A1.I1.i2.p1.1.m1.2.3.2.1" xref="A1.I1.i2.p1.1.m1.2.3.2.1.cmml">⁢</mo><mrow id="A1.I1.i2.p1.1.m1.2.3.2.3.2" xref="A1.I1.i2.p1.1.m1.2.3.2.cmml"><mo id="A1.I1.i2.p1.1.m1.2.3.2.3.2.1" stretchy="false" xref="A1.I1.i2.p1.1.m1.2.3.2.cmml">(</mo><mi id="A1.I1.i2.p1.1.m1.2.2" xref="A1.I1.i2.p1.1.m1.2.2.cmml">u</mi><mo id="A1.I1.i2.p1.1.m1.2.3.2.3.2.2" stretchy="false" xref="A1.I1.i2.p1.1.m1.2.3.2.cmml">)</mo></mrow></mrow><mo id="A1.I1.i2.p1.1.m1.2.3.1" xref="A1.I1.i2.p1.1.m1.2.3.1.cmml">=</mo><mrow id="A1.I1.i2.p1.1.m1.2.3.3" xref="A1.I1.i2.p1.1.m1.2.3.3.cmml"><mfrac id="A1.I1.i2.p1.1.m1.2.3.3.2" xref="A1.I1.i2.p1.1.m1.2.3.3.2.cmml"><mn id="A1.I1.i2.p1.1.m1.2.3.3.2.2" xref="A1.I1.i2.p1.1.m1.2.3.3.2.2.cmml">1</mn><mn id="A1.I1.i2.p1.1.m1.2.3.3.2.3" xref="A1.I1.i2.p1.1.m1.2.3.3.2.3.cmml">2</mn></mfrac><mo id="A1.I1.i2.p1.1.m1.2.3.3.1" xref="A1.I1.i2.p1.1.m1.2.3.3.1.cmml">⁢</mo><msup id="A1.I1.i2.p1.1.m1.2.3.3.3" xref="A1.I1.i2.p1.1.m1.2.3.3.3.cmml"><mi id="A1.I1.i2.p1.1.m1.2.3.3.3.2" xref="A1.I1.i2.p1.1.m1.2.3.3.3.2.cmml">e</mi><mrow id="A1.I1.i2.p1.1.m1.1.1.1" xref="A1.I1.i2.p1.1.m1.1.1.1.cmml"><mo id="A1.I1.i2.p1.1.m1.1.1.1a" xref="A1.I1.i2.p1.1.m1.1.1.1.cmml">−</mo><mrow id="A1.I1.i2.p1.1.m1.1.1.1.3.2" xref="A1.I1.i2.p1.1.m1.1.1.1.3.1.cmml"><mo id="A1.I1.i2.p1.1.m1.1.1.1.3.2.1" stretchy="false" xref="A1.I1.i2.p1.1.m1.1.1.1.3.1.1.cmml">|</mo><mi id="A1.I1.i2.p1.1.m1.1.1.1.1" xref="A1.I1.i2.p1.1.m1.1.1.1.1.cmml">u</mi><mo id="A1.I1.i2.p1.1.m1.1.1.1.3.2.2" stretchy="false" xref="A1.I1.i2.p1.1.m1.1.1.1.3.1.1.cmml">|</mo></mrow></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.I1.i2.p1.1.m1.2b"><apply id="A1.I1.i2.p1.1.m1.2.3.cmml" xref="A1.I1.i2.p1.1.m1.2.3"><eq id="A1.I1.i2.p1.1.m1.2.3.1.cmml" xref="A1.I1.i2.p1.1.m1.2.3.1"></eq><apply id="A1.I1.i2.p1.1.m1.2.3.2.cmml" xref="A1.I1.i2.p1.1.m1.2.3.2"><times id="A1.I1.i2.p1.1.m1.2.3.2.1.cmml" xref="A1.I1.i2.p1.1.m1.2.3.2.1"></times><ci id="A1.I1.i2.p1.1.m1.2.3.2.2.cmml" xref="A1.I1.i2.p1.1.m1.2.3.2.2">𝐾</ci><ci id="A1.I1.i2.p1.1.m1.2.2.cmml" xref="A1.I1.i2.p1.1.m1.2.2">𝑢</ci></apply><apply id="A1.I1.i2.p1.1.m1.2.3.3.cmml" xref="A1.I1.i2.p1.1.m1.2.3.3"><times id="A1.I1.i2.p1.1.m1.2.3.3.1.cmml" xref="A1.I1.i2.p1.1.m1.2.3.3.1"></times><apply id="A1.I1.i2.p1.1.m1.2.3.3.2.cmml" xref="A1.I1.i2.p1.1.m1.2.3.3.2"><divide id="A1.I1.i2.p1.1.m1.2.3.3.2.1.cmml" xref="A1.I1.i2.p1.1.m1.2.3.3.2"></divide><cn id="A1.I1.i2.p1.1.m1.2.3.3.2.2.cmml" type="integer" xref="A1.I1.i2.p1.1.m1.2.3.3.2.2">1</cn><cn id="A1.I1.i2.p1.1.m1.2.3.3.2.3.cmml" type="integer" xref="A1.I1.i2.p1.1.m1.2.3.3.2.3">2</cn></apply><apply id="A1.I1.i2.p1.1.m1.2.3.3.3.cmml" xref="A1.I1.i2.p1.1.m1.2.3.3.3"><csymbol cd="ambiguous" id="A1.I1.i2.p1.1.m1.2.3.3.3.1.cmml" xref="A1.I1.i2.p1.1.m1.2.3.3.3">superscript</csymbol><ci id="A1.I1.i2.p1.1.m1.2.3.3.3.2.cmml" xref="A1.I1.i2.p1.1.m1.2.3.3.3.2">𝑒</ci><apply id="A1.I1.i2.p1.1.m1.1.1.1.cmml" xref="A1.I1.i2.p1.1.m1.1.1.1"><minus id="A1.I1.i2.p1.1.m1.1.1.1.2.cmml" xref="A1.I1.i2.p1.1.m1.1.1.1"></minus><apply id="A1.I1.i2.p1.1.m1.1.1.1.3.1.cmml" xref="A1.I1.i2.p1.1.m1.1.1.1.3.2"><abs id="A1.I1.i2.p1.1.m1.1.1.1.3.1.1.cmml" xref="A1.I1.i2.p1.1.m1.1.1.1.3.2.1"></abs><ci id="A1.I1.i2.p1.1.m1.1.1.1.1.cmml" xref="A1.I1.i2.p1.1.m1.1.1.1.1">𝑢</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i2.p1.1.m1.2c">K(u)=\frac{1}{2}e^{-|u|}</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i2.p1.1.m1.2d">italic_K ( italic_u ) = divide start_ARG 1 end_ARG start_ARG 2 end_ARG italic_e start_POSTSUPERSCRIPT - | italic_u | end_POSTSUPERSCRIPT</annotation></semantics></math></p>
</div>
</li>
<li class="ltx_item" id="A1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I1.i3.p1">
<p class="ltx_p" id="A1.I1.i3.p1.2">Epanechnikov kernel: <math alttext="K(u)=\frac{3}{4}(1-u^{2})" class="ltx_Math" display="inline" id="A1.I1.i3.p1.1.m1.2"><semantics id="A1.I1.i3.p1.1.m1.2a"><mrow id="A1.I1.i3.p1.1.m1.2.2" xref="A1.I1.i3.p1.1.m1.2.2.cmml"><mrow id="A1.I1.i3.p1.1.m1.2.2.3" xref="A1.I1.i3.p1.1.m1.2.2.3.cmml"><mi id="A1.I1.i3.p1.1.m1.2.2.3.2" xref="A1.I1.i3.p1.1.m1.2.2.3.2.cmml">K</mi><mo id="A1.I1.i3.p1.1.m1.2.2.3.1" xref="A1.I1.i3.p1.1.m1.2.2.3.1.cmml">⁢</mo><mrow id="A1.I1.i3.p1.1.m1.2.2.3.3.2" xref="A1.I1.i3.p1.1.m1.2.2.3.cmml"><mo id="A1.I1.i3.p1.1.m1.2.2.3.3.2.1" stretchy="false" xref="A1.I1.i3.p1.1.m1.2.2.3.cmml">(</mo><mi id="A1.I1.i3.p1.1.m1.1.1" xref="A1.I1.i3.p1.1.m1.1.1.cmml">u</mi><mo id="A1.I1.i3.p1.1.m1.2.2.3.3.2.2" stretchy="false" xref="A1.I1.i3.p1.1.m1.2.2.3.cmml">)</mo></mrow></mrow><mo id="A1.I1.i3.p1.1.m1.2.2.2" xref="A1.I1.i3.p1.1.m1.2.2.2.cmml">=</mo><mrow id="A1.I1.i3.p1.1.m1.2.2.1" xref="A1.I1.i3.p1.1.m1.2.2.1.cmml"><mfrac id="A1.I1.i3.p1.1.m1.2.2.1.3" xref="A1.I1.i3.p1.1.m1.2.2.1.3.cmml"><mn id="A1.I1.i3.p1.1.m1.2.2.1.3.2" xref="A1.I1.i3.p1.1.m1.2.2.1.3.2.cmml">3</mn><mn id="A1.I1.i3.p1.1.m1.2.2.1.3.3" xref="A1.I1.i3.p1.1.m1.2.2.1.3.3.cmml">4</mn></mfrac><mo id="A1.I1.i3.p1.1.m1.2.2.1.2" xref="A1.I1.i3.p1.1.m1.2.2.1.2.cmml">⁢</mo><mrow id="A1.I1.i3.p1.1.m1.2.2.1.1.1" xref="A1.I1.i3.p1.1.m1.2.2.1.1.1.1.cmml"><mo id="A1.I1.i3.p1.1.m1.2.2.1.1.1.2" stretchy="false" xref="A1.I1.i3.p1.1.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="A1.I1.i3.p1.1.m1.2.2.1.1.1.1" xref="A1.I1.i3.p1.1.m1.2.2.1.1.1.1.cmml"><mn id="A1.I1.i3.p1.1.m1.2.2.1.1.1.1.2" xref="A1.I1.i3.p1.1.m1.2.2.1.1.1.1.2.cmml">1</mn><mo id="A1.I1.i3.p1.1.m1.2.2.1.1.1.1.1" xref="A1.I1.i3.p1.1.m1.2.2.1.1.1.1.1.cmml">−</mo><msup id="A1.I1.i3.p1.1.m1.2.2.1.1.1.1.3" xref="A1.I1.i3.p1.1.m1.2.2.1.1.1.1.3.cmml"><mi id="A1.I1.i3.p1.1.m1.2.2.1.1.1.1.3.2" xref="A1.I1.i3.p1.1.m1.2.2.1.1.1.1.3.2.cmml">u</mi><mn id="A1.I1.i3.p1.1.m1.2.2.1.1.1.1.3.3" xref="A1.I1.i3.p1.1.m1.2.2.1.1.1.1.3.3.cmml">2</mn></msup></mrow><mo id="A1.I1.i3.p1.1.m1.2.2.1.1.1.3" stretchy="false" xref="A1.I1.i3.p1.1.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.I1.i3.p1.1.m1.2b"><apply id="A1.I1.i3.p1.1.m1.2.2.cmml" xref="A1.I1.i3.p1.1.m1.2.2"><eq id="A1.I1.i3.p1.1.m1.2.2.2.cmml" xref="A1.I1.i3.p1.1.m1.2.2.2"></eq><apply id="A1.I1.i3.p1.1.m1.2.2.3.cmml" xref="A1.I1.i3.p1.1.m1.2.2.3"><times id="A1.I1.i3.p1.1.m1.2.2.3.1.cmml" xref="A1.I1.i3.p1.1.m1.2.2.3.1"></times><ci id="A1.I1.i3.p1.1.m1.2.2.3.2.cmml" xref="A1.I1.i3.p1.1.m1.2.2.3.2">𝐾</ci><ci id="A1.I1.i3.p1.1.m1.1.1.cmml" xref="A1.I1.i3.p1.1.m1.1.1">𝑢</ci></apply><apply id="A1.I1.i3.p1.1.m1.2.2.1.cmml" xref="A1.I1.i3.p1.1.m1.2.2.1"><times id="A1.I1.i3.p1.1.m1.2.2.1.2.cmml" xref="A1.I1.i3.p1.1.m1.2.2.1.2"></times><apply id="A1.I1.i3.p1.1.m1.2.2.1.3.cmml" xref="A1.I1.i3.p1.1.m1.2.2.1.3"><divide id="A1.I1.i3.p1.1.m1.2.2.1.3.1.cmml" xref="A1.I1.i3.p1.1.m1.2.2.1.3"></divide><cn id="A1.I1.i3.p1.1.m1.2.2.1.3.2.cmml" type="integer" xref="A1.I1.i3.p1.1.m1.2.2.1.3.2">3</cn><cn id="A1.I1.i3.p1.1.m1.2.2.1.3.3.cmml" type="integer" xref="A1.I1.i3.p1.1.m1.2.2.1.3.3">4</cn></apply><apply id="A1.I1.i3.p1.1.m1.2.2.1.1.1.1.cmml" xref="A1.I1.i3.p1.1.m1.2.2.1.1.1"><minus id="A1.I1.i3.p1.1.m1.2.2.1.1.1.1.1.cmml" xref="A1.I1.i3.p1.1.m1.2.2.1.1.1.1.1"></minus><cn id="A1.I1.i3.p1.1.m1.2.2.1.1.1.1.2.cmml" type="integer" xref="A1.I1.i3.p1.1.m1.2.2.1.1.1.1.2">1</cn><apply id="A1.I1.i3.p1.1.m1.2.2.1.1.1.1.3.cmml" xref="A1.I1.i3.p1.1.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.I1.i3.p1.1.m1.2.2.1.1.1.1.3.1.cmml" xref="A1.I1.i3.p1.1.m1.2.2.1.1.1.1.3">superscript</csymbol><ci id="A1.I1.i3.p1.1.m1.2.2.1.1.1.1.3.2.cmml" xref="A1.I1.i3.p1.1.m1.2.2.1.1.1.1.3.2">𝑢</ci><cn id="A1.I1.i3.p1.1.m1.2.2.1.1.1.1.3.3.cmml" type="integer" xref="A1.I1.i3.p1.1.m1.2.2.1.1.1.1.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i3.p1.1.m1.2c">K(u)=\frac{3}{4}(1-u^{2})</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i3.p1.1.m1.2d">italic_K ( italic_u ) = divide start_ARG 3 end_ARG start_ARG 4 end_ARG ( 1 - italic_u start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math> for <math alttext="|u|\leq 1" class="ltx_Math" display="inline" id="A1.I1.i3.p1.2.m2.1"><semantics id="A1.I1.i3.p1.2.m2.1a"><mrow id="A1.I1.i3.p1.2.m2.1.2" xref="A1.I1.i3.p1.2.m2.1.2.cmml"><mrow id="A1.I1.i3.p1.2.m2.1.2.2.2" xref="A1.I1.i3.p1.2.m2.1.2.2.1.cmml"><mo id="A1.I1.i3.p1.2.m2.1.2.2.2.1" stretchy="false" xref="A1.I1.i3.p1.2.m2.1.2.2.1.1.cmml">|</mo><mi id="A1.I1.i3.p1.2.m2.1.1" xref="A1.I1.i3.p1.2.m2.1.1.cmml">u</mi><mo id="A1.I1.i3.p1.2.m2.1.2.2.2.2" stretchy="false" xref="A1.I1.i3.p1.2.m2.1.2.2.1.1.cmml">|</mo></mrow><mo id="A1.I1.i3.p1.2.m2.1.2.1" xref="A1.I1.i3.p1.2.m2.1.2.1.cmml">≤</mo><mn id="A1.I1.i3.p1.2.m2.1.2.3" xref="A1.I1.i3.p1.2.m2.1.2.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.I1.i3.p1.2.m2.1b"><apply id="A1.I1.i3.p1.2.m2.1.2.cmml" xref="A1.I1.i3.p1.2.m2.1.2"><leq id="A1.I1.i3.p1.2.m2.1.2.1.cmml" xref="A1.I1.i3.p1.2.m2.1.2.1"></leq><apply id="A1.I1.i3.p1.2.m2.1.2.2.1.cmml" xref="A1.I1.i3.p1.2.m2.1.2.2.2"><abs id="A1.I1.i3.p1.2.m2.1.2.2.1.1.cmml" xref="A1.I1.i3.p1.2.m2.1.2.2.2.1"></abs><ci id="A1.I1.i3.p1.2.m2.1.1.cmml" xref="A1.I1.i3.p1.2.m2.1.1">𝑢</ci></apply><cn id="A1.I1.i3.p1.2.m2.1.2.3.cmml" type="integer" xref="A1.I1.i3.p1.2.m2.1.2.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i3.p1.2.m2.1c">|u|\leq 1</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i3.p1.2.m2.1d">| italic_u | ≤ 1</annotation></semantics></math>, 0 otherwise</p>
</div>
</li>
<li class="ltx_item" id="A1.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="A1.I1.i4.p1">
<p class="ltx_p" id="A1.I1.i4.p1.1">Tophat kernel: <math alttext="K(u)=\begin{cases}\frac{1}{2}&amp;\text{for }|u|\leq 1\\
0&amp;\text{otherwise}\end{cases}" class="ltx_Math" display="inline" id="A1.I1.i4.p1.1.m1.5"><semantics id="A1.I1.i4.p1.1.m1.5a"><mrow id="A1.I1.i4.p1.1.m1.5.6" xref="A1.I1.i4.p1.1.m1.5.6.cmml"><mrow id="A1.I1.i4.p1.1.m1.5.6.2" xref="A1.I1.i4.p1.1.m1.5.6.2.cmml"><mi id="A1.I1.i4.p1.1.m1.5.6.2.2" xref="A1.I1.i4.p1.1.m1.5.6.2.2.cmml">K</mi><mo id="A1.I1.i4.p1.1.m1.5.6.2.1" xref="A1.I1.i4.p1.1.m1.5.6.2.1.cmml">⁢</mo><mrow id="A1.I1.i4.p1.1.m1.5.6.2.3.2" xref="A1.I1.i4.p1.1.m1.5.6.2.cmml"><mo id="A1.I1.i4.p1.1.m1.5.6.2.3.2.1" stretchy="false" xref="A1.I1.i4.p1.1.m1.5.6.2.cmml">(</mo><mi id="A1.I1.i4.p1.1.m1.5.5" xref="A1.I1.i4.p1.1.m1.5.5.cmml">u</mi><mo id="A1.I1.i4.p1.1.m1.5.6.2.3.2.2" stretchy="false" xref="A1.I1.i4.p1.1.m1.5.6.2.cmml">)</mo></mrow></mrow><mo id="A1.I1.i4.p1.1.m1.5.6.1" xref="A1.I1.i4.p1.1.m1.5.6.1.cmml">=</mo><mrow id="A1.I1.i4.p1.1.m1.4.4" xref="A1.I1.i4.p1.1.m1.5.6.3.1.cmml"><mo id="A1.I1.i4.p1.1.m1.4.4.5" xref="A1.I1.i4.p1.1.m1.5.6.3.1.1.cmml">{</mo><mtable columnspacing="5pt" id="A1.I1.i4.p1.1.m1.4.4.4" rowspacing="0pt" xref="A1.I1.i4.p1.1.m1.5.6.3.1.cmml"><mtr id="A1.I1.i4.p1.1.m1.4.4.4a" xref="A1.I1.i4.p1.1.m1.5.6.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="A1.I1.i4.p1.1.m1.4.4.4b" xref="A1.I1.i4.p1.1.m1.5.6.3.1.cmml"><mfrac id="A1.I1.i4.p1.1.m1.1.1.1.1.1.1" xref="A1.I1.i4.p1.1.m1.1.1.1.1.1.1.cmml"><mn id="A1.I1.i4.p1.1.m1.1.1.1.1.1.1.2" xref="A1.I1.i4.p1.1.m1.1.1.1.1.1.1.2.cmml">1</mn><mn id="A1.I1.i4.p1.1.m1.1.1.1.1.1.1.3" xref="A1.I1.i4.p1.1.m1.1.1.1.1.1.1.3.cmml">2</mn></mfrac></mtd><mtd class="ltx_align_left" columnalign="left" id="A1.I1.i4.p1.1.m1.4.4.4c" xref="A1.I1.i4.p1.1.m1.5.6.3.1.cmml"><mrow id="A1.I1.i4.p1.1.m1.2.2.2.2.2.1" xref="A1.I1.i4.p1.1.m1.2.2.2.2.2.1.cmml"><mrow id="A1.I1.i4.p1.1.m1.2.2.2.2.2.1.3" xref="A1.I1.i4.p1.1.m1.2.2.2.2.2.1.3.cmml"><mtext id="A1.I1.i4.p1.1.m1.2.2.2.2.2.1.3.2" xref="A1.I1.i4.p1.1.m1.2.2.2.2.2.1.3.2a.cmml">for </mtext><mo id="A1.I1.i4.p1.1.m1.2.2.2.2.2.1.3.1" xref="A1.I1.i4.p1.1.m1.2.2.2.2.2.1.3.1.cmml">⁢</mo><mrow id="A1.I1.i4.p1.1.m1.2.2.2.2.2.1.3.3.2" xref="A1.I1.i4.p1.1.m1.2.2.2.2.2.1.3.3.1.cmml"><mo id="A1.I1.i4.p1.1.m1.2.2.2.2.2.1.3.3.2.1" stretchy="false" xref="A1.I1.i4.p1.1.m1.2.2.2.2.2.1.3.3.1.1.cmml">|</mo><mi id="A1.I1.i4.p1.1.m1.2.2.2.2.2.1.1" xref="A1.I1.i4.p1.1.m1.2.2.2.2.2.1.1.cmml">u</mi><mo id="A1.I1.i4.p1.1.m1.2.2.2.2.2.1.3.3.2.2" stretchy="false" xref="A1.I1.i4.p1.1.m1.2.2.2.2.2.1.3.3.1.1.cmml">|</mo></mrow></mrow><mo id="A1.I1.i4.p1.1.m1.2.2.2.2.2.1.2" xref="A1.I1.i4.p1.1.m1.2.2.2.2.2.1.2.cmml">≤</mo><mn id="A1.I1.i4.p1.1.m1.2.2.2.2.2.1.4" xref="A1.I1.i4.p1.1.m1.2.2.2.2.2.1.4.cmml">1</mn></mrow></mtd></mtr><mtr id="A1.I1.i4.p1.1.m1.4.4.4d" xref="A1.I1.i4.p1.1.m1.5.6.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="A1.I1.i4.p1.1.m1.4.4.4e" xref="A1.I1.i4.p1.1.m1.5.6.3.1.cmml"><mn id="A1.I1.i4.p1.1.m1.3.3.3.3.1.1" xref="A1.I1.i4.p1.1.m1.3.3.3.3.1.1.cmml">0</mn></mtd><mtd class="ltx_align_left" columnalign="left" id="A1.I1.i4.p1.1.m1.4.4.4f" xref="A1.I1.i4.p1.1.m1.5.6.3.1.cmml"><mtext id="A1.I1.i4.p1.1.m1.4.4.4.4.2.1" xref="A1.I1.i4.p1.1.m1.4.4.4.4.2.1a.cmml">otherwise</mtext></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.I1.i4.p1.1.m1.5b"><apply id="A1.I1.i4.p1.1.m1.5.6.cmml" xref="A1.I1.i4.p1.1.m1.5.6"><eq id="A1.I1.i4.p1.1.m1.5.6.1.cmml" xref="A1.I1.i4.p1.1.m1.5.6.1"></eq><apply id="A1.I1.i4.p1.1.m1.5.6.2.cmml" xref="A1.I1.i4.p1.1.m1.5.6.2"><times id="A1.I1.i4.p1.1.m1.5.6.2.1.cmml" xref="A1.I1.i4.p1.1.m1.5.6.2.1"></times><ci id="A1.I1.i4.p1.1.m1.5.6.2.2.cmml" xref="A1.I1.i4.p1.1.m1.5.6.2.2">𝐾</ci><ci id="A1.I1.i4.p1.1.m1.5.5.cmml" xref="A1.I1.i4.p1.1.m1.5.5">𝑢</ci></apply><apply id="A1.I1.i4.p1.1.m1.5.6.3.1.cmml" xref="A1.I1.i4.p1.1.m1.4.4"><csymbol cd="latexml" id="A1.I1.i4.p1.1.m1.5.6.3.1.1.cmml" xref="A1.I1.i4.p1.1.m1.4.4.5">cases</csymbol><apply id="A1.I1.i4.p1.1.m1.1.1.1.1.1.1.cmml" xref="A1.I1.i4.p1.1.m1.1.1.1.1.1.1"><divide id="A1.I1.i4.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="A1.I1.i4.p1.1.m1.1.1.1.1.1.1"></divide><cn id="A1.I1.i4.p1.1.m1.1.1.1.1.1.1.2.cmml" type="integer" xref="A1.I1.i4.p1.1.m1.1.1.1.1.1.1.2">1</cn><cn id="A1.I1.i4.p1.1.m1.1.1.1.1.1.1.3.cmml" type="integer" xref="A1.I1.i4.p1.1.m1.1.1.1.1.1.1.3">2</cn></apply><apply id="A1.I1.i4.p1.1.m1.2.2.2.2.2.1.cmml" xref="A1.I1.i4.p1.1.m1.2.2.2.2.2.1"><leq id="A1.I1.i4.p1.1.m1.2.2.2.2.2.1.2.cmml" xref="A1.I1.i4.p1.1.m1.2.2.2.2.2.1.2"></leq><apply id="A1.I1.i4.p1.1.m1.2.2.2.2.2.1.3.cmml" xref="A1.I1.i4.p1.1.m1.2.2.2.2.2.1.3"><times id="A1.I1.i4.p1.1.m1.2.2.2.2.2.1.3.1.cmml" xref="A1.I1.i4.p1.1.m1.2.2.2.2.2.1.3.1"></times><ci id="A1.I1.i4.p1.1.m1.2.2.2.2.2.1.3.2a.cmml" xref="A1.I1.i4.p1.1.m1.2.2.2.2.2.1.3.2"><mtext id="A1.I1.i4.p1.1.m1.2.2.2.2.2.1.3.2.cmml" xref="A1.I1.i4.p1.1.m1.2.2.2.2.2.1.3.2">for </mtext></ci><apply id="A1.I1.i4.p1.1.m1.2.2.2.2.2.1.3.3.1.cmml" xref="A1.I1.i4.p1.1.m1.2.2.2.2.2.1.3.3.2"><abs id="A1.I1.i4.p1.1.m1.2.2.2.2.2.1.3.3.1.1.cmml" xref="A1.I1.i4.p1.1.m1.2.2.2.2.2.1.3.3.2.1"></abs><ci id="A1.I1.i4.p1.1.m1.2.2.2.2.2.1.1.cmml" xref="A1.I1.i4.p1.1.m1.2.2.2.2.2.1.1">𝑢</ci></apply></apply><cn id="A1.I1.i4.p1.1.m1.2.2.2.2.2.1.4.cmml" type="integer" xref="A1.I1.i4.p1.1.m1.2.2.2.2.2.1.4">1</cn></apply><cn id="A1.I1.i4.p1.1.m1.3.3.3.3.1.1.cmml" type="integer" xref="A1.I1.i4.p1.1.m1.3.3.3.3.1.1">0</cn><ci id="A1.I1.i4.p1.1.m1.4.4.4.4.2.1a.cmml" xref="A1.I1.i4.p1.1.m1.4.4.4.4.2.1"><mtext id="A1.I1.i4.p1.1.m1.4.4.4.4.2.1.cmml" xref="A1.I1.i4.p1.1.m1.4.4.4.4.2.1">otherwise</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i4.p1.1.m1.5c">K(u)=\begin{cases}\frac{1}{2}&amp;\text{for }|u|\leq 1\\
0&amp;\text{otherwise}\end{cases}</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i4.p1.1.m1.5d">italic_K ( italic_u ) = { start_ROW start_CELL divide start_ARG 1 end_ARG start_ARG 2 end_ARG end_CELL start_CELL for | italic_u | ≤ 1 end_CELL end_ROW start_ROW start_CELL 0 end_CELL start_CELL otherwise end_CELL end_ROW</annotation></semantics></math></p>
</div>
</li>
</ul>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS5.SSS2.p3">
<p class="ltx_p" id="A1.SS5.SSS2.p3.1">The Epanechnikov kernel is a key result from optimal kernel theory as it minimizes the MISE.</p>
</div>
<div class="ltx_para" id="A1.SS5.SSS2.p4">
<p class="ltx_p" id="A1.SS5.SSS2.p4.1">As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.F13" title="Figure 13 ‣ A.5.2 Optimal kernel shape ‣ A.5 Additional notes on Kernel Density Estimation ‣ Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">13</span></a>, different kernel shapes can lead to varying density estimation trajectories.
This visualization compares the performance of LLaMA-13b with various kernel density estimators in a 2D InPCA embedding, capturing 87% of the pairwise Hellinger distances between probability distributions.</p>
</div>
<figure class="ltx_figure" id="A1.F13"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="258" id="A1.F13.g1" src="extracted/5899401/figures/gaussian_multi_kernels_Hellinger_2D_87.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 13: </span>2D InPCA embedding of density estimation trajectories for LLaMA-13b and KDEs with various kernel shapes:
exponential (<math alttext="s=1" class="ltx_Math" display="inline" id="A1.F13.5.m1.1"><semantics id="A1.F13.5.m1.1b"><mrow id="A1.F13.5.m1.1.1" xref="A1.F13.5.m1.1.1.cmml"><mi id="A1.F13.5.m1.1.1.2" xref="A1.F13.5.m1.1.1.2.cmml">s</mi><mo id="A1.F13.5.m1.1.1.1" xref="A1.F13.5.m1.1.1.1.cmml">=</mo><mn id="A1.F13.5.m1.1.1.3" xref="A1.F13.5.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F13.5.m1.1c"><apply id="A1.F13.5.m1.1.1.cmml" xref="A1.F13.5.m1.1.1"><eq id="A1.F13.5.m1.1.1.1.cmml" xref="A1.F13.5.m1.1.1.1"></eq><ci id="A1.F13.5.m1.1.1.2.cmml" xref="A1.F13.5.m1.1.1.2">𝑠</ci><cn id="A1.F13.5.m1.1.1.3.cmml" type="integer" xref="A1.F13.5.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F13.5.m1.1d">s=1</annotation><annotation encoding="application/x-llamapun" id="A1.F13.5.m1.1e">italic_s = 1</annotation></semantics></math>), Gaussian (<math alttext="s=2" class="ltx_Math" display="inline" id="A1.F13.6.m2.1"><semantics id="A1.F13.6.m2.1b"><mrow id="A1.F13.6.m2.1.1" xref="A1.F13.6.m2.1.1.cmml"><mi id="A1.F13.6.m2.1.1.2" xref="A1.F13.6.m2.1.1.2.cmml">s</mi><mo id="A1.F13.6.m2.1.1.1" xref="A1.F13.6.m2.1.1.1.cmml">=</mo><mn id="A1.F13.6.m2.1.1.3" xref="A1.F13.6.m2.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F13.6.m2.1c"><apply id="A1.F13.6.m2.1.1.cmml" xref="A1.F13.6.m2.1.1"><eq id="A1.F13.6.m2.1.1.1.cmml" xref="A1.F13.6.m2.1.1.1"></eq><ci id="A1.F13.6.m2.1.1.2.cmml" xref="A1.F13.6.m2.1.1.2">𝑠</ci><cn id="A1.F13.6.m2.1.1.3.cmml" type="integer" xref="A1.F13.6.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F13.6.m2.1d">s=2</annotation><annotation encoding="application/x-llamapun" id="A1.F13.6.m2.1e">italic_s = 2</annotation></semantics></math>), and tophat (<math alttext="s=\infty" class="ltx_Math" display="inline" id="A1.F13.7.m3.1"><semantics id="A1.F13.7.m3.1b"><mrow id="A1.F13.7.m3.1.1" xref="A1.F13.7.m3.1.1.cmml"><mi id="A1.F13.7.m3.1.1.2" xref="A1.F13.7.m3.1.1.2.cmml">s</mi><mo id="A1.F13.7.m3.1.1.1" xref="A1.F13.7.m3.1.1.1.cmml">=</mo><mi id="A1.F13.7.m3.1.1.3" mathvariant="normal" xref="A1.F13.7.m3.1.1.3.cmml">∞</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.F13.7.m3.1c"><apply id="A1.F13.7.m3.1.1.cmml" xref="A1.F13.7.m3.1.1"><eq id="A1.F13.7.m3.1.1.1.cmml" xref="A1.F13.7.m3.1.1.1"></eq><ci id="A1.F13.7.m3.1.1.2.cmml" xref="A1.F13.7.m3.1.1.2">𝑠</ci><infinity id="A1.F13.7.m3.1.1.3.cmml" xref="A1.F13.7.m3.1.1.3"></infinity></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F13.7.m3.1d">s=\infty</annotation><annotation encoding="application/x-llamapun" id="A1.F13.7.m3.1e">italic_s = ∞</annotation></semantics></math>).
As <math alttext="s" class="ltx_Math" display="inline" id="A1.F13.8.m4.1"><semantics id="A1.F13.8.m4.1b"><mi id="A1.F13.8.m4.1.1" xref="A1.F13.8.m4.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="A1.F13.8.m4.1c"><ci id="A1.F13.8.m4.1.1.cmml" xref="A1.F13.8.m4.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.F13.8.m4.1d">s</annotation><annotation encoding="application/x-llamapun" id="A1.F13.8.m4.1e">italic_s</annotation></semantics></math> decreases, the DE trajectories gradually shift from outside the Gaussian submanifold to inside, moving closer to LLaMA’s trajectory.
The ground truth is a narrow Gaussian distribution.
This visualization captures 87% of the pairwise Hellinger distances between probability distributions.</figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="A1.SS5.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.5.3 </span>MISE vs. valid statistical distances</h4>
<div class="ltx_para ltx_noindent" id="A1.SS5.SSS3.p1">
<p class="ltx_p" id="A1.SS5.SSS3.p1.5">In our InPCA analysis, we choose the the Hellinger distance because:
<span class="ltx_text ltx_font_bold" id="A1.SS5.SSS3.p1.5.1">1.</span> It locally agrees with the KL-divergence <cite class="ltx_cite ltx_citemacro_citep">(Liese &amp; Vajda, <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib21" title="">2006</a>)</cite>; a measure motivated by information theory and commonly used in training modern machine learning systems, including LLMs <cite class="ltx_cite ltx_citemacro_citep">(Touvron et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib39" title="">2023</a>)</cite>.
Mathematically, this agreement means for distributions <math alttext="p" class="ltx_Math" display="inline" id="A1.SS5.SSS3.p1.1.m1.1"><semantics id="A1.SS5.SSS3.p1.1.m1.1a"><mi id="A1.SS5.SSS3.p1.1.m1.1.1" xref="A1.SS5.SSS3.p1.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="A1.SS5.SSS3.p1.1.m1.1b"><ci id="A1.SS5.SSS3.p1.1.m1.1.1.cmml" xref="A1.SS5.SSS3.p1.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.SSS3.p1.1.m1.1c">p</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.SSS3.p1.1.m1.1d">italic_p</annotation></semantics></math> and <math alttext="q" class="ltx_Math" display="inline" id="A1.SS5.SSS3.p1.2.m2.1"><semantics id="A1.SS5.SSS3.p1.2.m2.1a"><mi id="A1.SS5.SSS3.p1.2.m2.1.1" xref="A1.SS5.SSS3.p1.2.m2.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="A1.SS5.SSS3.p1.2.m2.1b"><ci id="A1.SS5.SSS3.p1.2.m2.1.1.cmml" xref="A1.SS5.SSS3.p1.2.m2.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.SSS3.p1.2.m2.1c">q</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.SSS3.p1.2.m2.1d">italic_q</annotation></semantics></math> that are close: <math alttext="D_{Hel}^{2}(p,q)\approx\frac{1}{2}\mathrm{KL}(p||q)" class="ltx_math_unparsed" display="inline" id="A1.SS5.SSS3.p1.3.m3.2"><semantics id="A1.SS5.SSS3.p1.3.m3.2a"><mrow id="A1.SS5.SSS3.p1.3.m3.2b"><msubsup id="A1.SS5.SSS3.p1.3.m3.2.3"><mi id="A1.SS5.SSS3.p1.3.m3.2.3.2.2">D</mi><mrow id="A1.SS5.SSS3.p1.3.m3.2.3.2.3"><mi id="A1.SS5.SSS3.p1.3.m3.2.3.2.3.2">H</mi><mo id="A1.SS5.SSS3.p1.3.m3.2.3.2.3.1">⁢</mo><mi id="A1.SS5.SSS3.p1.3.m3.2.3.2.3.3">e</mi><mo id="A1.SS5.SSS3.p1.3.m3.2.3.2.3.1a">⁢</mo><mi id="A1.SS5.SSS3.p1.3.m3.2.3.2.3.4">l</mi></mrow><mn id="A1.SS5.SSS3.p1.3.m3.2.3.3">2</mn></msubsup><mrow id="A1.SS5.SSS3.p1.3.m3.2.4"><mo id="A1.SS5.SSS3.p1.3.m3.2.4.1" stretchy="false">(</mo><mi id="A1.SS5.SSS3.p1.3.m3.1.1">p</mi><mo id="A1.SS5.SSS3.p1.3.m3.2.4.2">,</mo><mi id="A1.SS5.SSS3.p1.3.m3.2.2">q</mi><mo id="A1.SS5.SSS3.p1.3.m3.2.4.3" stretchy="false">)</mo></mrow><mo id="A1.SS5.SSS3.p1.3.m3.2.5">≈</mo><mfrac id="A1.SS5.SSS3.p1.3.m3.2.6"><mn id="A1.SS5.SSS3.p1.3.m3.2.6.2">1</mn><mn id="A1.SS5.SSS3.p1.3.m3.2.6.3">2</mn></mfrac><mi id="A1.SS5.SSS3.p1.3.m3.2.7">KL</mi><mrow id="A1.SS5.SSS3.p1.3.m3.2.8"><mo id="A1.SS5.SSS3.p1.3.m3.2.8.1" stretchy="false">(</mo><mi id="A1.SS5.SSS3.p1.3.m3.2.8.2">p</mi><mo fence="false" id="A1.SS5.SSS3.p1.3.m3.2.8.3" rspace="0.167em" stretchy="false">|</mo><mo fence="false" id="A1.SS5.SSS3.p1.3.m3.2.8.4" rspace="0.167em" stretchy="false">|</mo><mi id="A1.SS5.SSS3.p1.3.m3.2.8.5">q</mi><mo id="A1.SS5.SSS3.p1.3.m3.2.8.6" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="A1.SS5.SSS3.p1.3.m3.2c">D_{Hel}^{2}(p,q)\approx\frac{1}{2}\mathrm{KL}(p||q)</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.SSS3.p1.3.m3.2d">italic_D start_POSTSUBSCRIPT italic_H italic_e italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ( italic_p , italic_q ) ≈ divide start_ARG 1 end_ARG start_ARG 2 end_ARG roman_KL ( italic_p | | italic_q )</annotation></semantics></math>
<span class="ltx_text ltx_font_bold" id="A1.SS5.SSS3.p1.5.2">2.</span> Unlike the closely-related Bhattacharyya distance <cite class="ltx_cite ltx_citemacro_citep">(Bhattacharyya, <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib4" title="">1943</a>)</cite>, KL-divergence, or cross-entropy <cite class="ltx_cite ltx_citemacro_citep">(Thomas &amp; Joy, <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib38" title="">2006</a>)</cite>, Hellinger distance is both symmetric and satisfies the triangle inequality, making it a proper metric.
This property makes it more suitable for visualization purposes.<span class="ltx_note ltx_role_footnote" id="footnote10"><sup class="ltx_note_mark">10</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">10</sup><span class="ltx_tag ltx_tag_note">10</span>InPCA embedding with Bhattacharyya distance or symmetrized KL-divergence typically results in negative distances in Minkowski space, which are harder to interpret <cite class="ltx_cite ltx_citemacro_citep">(Teoh et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib37" title="">2020</a>)</cite></span></span></span>
<span class="ltx_text ltx_font_bold" id="A1.SS5.SSS3.p1.5.3">3.</span> Although the <math alttext="L_{2}" class="ltx_Math" display="inline" id="A1.SS5.SSS3.p1.4.m4.1"><semantics id="A1.SS5.SSS3.p1.4.m4.1a"><msub id="A1.SS5.SSS3.p1.4.m4.1.1" xref="A1.SS5.SSS3.p1.4.m4.1.1.cmml"><mi id="A1.SS5.SSS3.p1.4.m4.1.1.2" xref="A1.SS5.SSS3.p1.4.m4.1.1.2.cmml">L</mi><mn id="A1.SS5.SSS3.p1.4.m4.1.1.3" xref="A1.SS5.SSS3.p1.4.m4.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A1.SS5.SSS3.p1.4.m4.1b"><apply id="A1.SS5.SSS3.p1.4.m4.1.1.cmml" xref="A1.SS5.SSS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="A1.SS5.SSS3.p1.4.m4.1.1.1.cmml" xref="A1.SS5.SSS3.p1.4.m4.1.1">subscript</csymbol><ci id="A1.SS5.SSS3.p1.4.m4.1.1.2.cmml" xref="A1.SS5.SSS3.p1.4.m4.1.1.2">𝐿</ci><cn id="A1.SS5.SSS3.p1.4.m4.1.1.3.cmml" type="integer" xref="A1.SS5.SSS3.p1.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.SSS3.p1.4.m4.1c">L_{2}</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.SSS3.p1.4.m4.1d">italic_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> distance <math alttext="||p-q||_{2}^{2}=\int|p(x)-q(x)|^{2}\textup{d}x" class="ltx_Math" display="inline" id="A1.SS5.SSS3.p1.5.m5.4"><semantics id="A1.SS5.SSS3.p1.5.m5.4a"><mrow id="A1.SS5.SSS3.p1.5.m5.4.4" xref="A1.SS5.SSS3.p1.5.m5.4.4.cmml"><msubsup id="A1.SS5.SSS3.p1.5.m5.3.3.1" xref="A1.SS5.SSS3.p1.5.m5.3.3.1.cmml"><mrow id="A1.SS5.SSS3.p1.5.m5.3.3.1.1.1.1" xref="A1.SS5.SSS3.p1.5.m5.3.3.1.1.1.2.cmml"><mo id="A1.SS5.SSS3.p1.5.m5.3.3.1.1.1.1.2" stretchy="false" xref="A1.SS5.SSS3.p1.5.m5.3.3.1.1.1.2.1.cmml">‖</mo><mrow id="A1.SS5.SSS3.p1.5.m5.3.3.1.1.1.1.1" xref="A1.SS5.SSS3.p1.5.m5.3.3.1.1.1.1.1.cmml"><mi id="A1.SS5.SSS3.p1.5.m5.3.3.1.1.1.1.1.2" xref="A1.SS5.SSS3.p1.5.m5.3.3.1.1.1.1.1.2.cmml">p</mi><mo id="A1.SS5.SSS3.p1.5.m5.3.3.1.1.1.1.1.1" xref="A1.SS5.SSS3.p1.5.m5.3.3.1.1.1.1.1.1.cmml">−</mo><mi id="A1.SS5.SSS3.p1.5.m5.3.3.1.1.1.1.1.3" xref="A1.SS5.SSS3.p1.5.m5.3.3.1.1.1.1.1.3.cmml">q</mi></mrow><mo id="A1.SS5.SSS3.p1.5.m5.3.3.1.1.1.1.3" stretchy="false" xref="A1.SS5.SSS3.p1.5.m5.3.3.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A1.SS5.SSS3.p1.5.m5.3.3.1.1.3" xref="A1.SS5.SSS3.p1.5.m5.3.3.1.1.3.cmml">2</mn><mn id="A1.SS5.SSS3.p1.5.m5.3.3.1.3" xref="A1.SS5.SSS3.p1.5.m5.3.3.1.3.cmml">2</mn></msubsup><mo id="A1.SS5.SSS3.p1.5.m5.4.4.3" rspace="0.111em" xref="A1.SS5.SSS3.p1.5.m5.4.4.3.cmml">=</mo><mrow id="A1.SS5.SSS3.p1.5.m5.4.4.2" xref="A1.SS5.SSS3.p1.5.m5.4.4.2.cmml"><mo id="A1.SS5.SSS3.p1.5.m5.4.4.2.2" rspace="0em" xref="A1.SS5.SSS3.p1.5.m5.4.4.2.2.cmml">∫</mo><mrow id="A1.SS5.SSS3.p1.5.m5.4.4.2.1" xref="A1.SS5.SSS3.p1.5.m5.4.4.2.1.cmml"><msup id="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1" xref="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.cmml"><mrow id="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1" xref="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.2.cmml"><mo id="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1.2" stretchy="false" xref="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.2.1.cmml">|</mo><mrow id="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1.1" xref="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1.1.cmml"><mrow id="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1.1.2" xref="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1.1.2.cmml"><mi id="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1.1.2.2" xref="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1.1.2.2.cmml">p</mi><mo id="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1.1.2.1" xref="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1.1.2.3.2" xref="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1.1.2.cmml"><mo id="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1.1.2.3.2.1" stretchy="false" xref="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1.1.2.cmml">(</mo><mi id="A1.SS5.SSS3.p1.5.m5.1.1" xref="A1.SS5.SSS3.p1.5.m5.1.1.cmml">x</mi><mo id="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1.1.2.3.2.2" stretchy="false" xref="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1.1.1" xref="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1.1.1.cmml">−</mo><mrow id="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1.1.3" xref="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1.1.3.cmml"><mi id="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1.1.3.2" xref="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1.1.3.2.cmml">q</mi><mo id="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1.1.3.1" xref="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1.1.3.3.2" xref="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1.1.3.cmml"><mo id="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1.1.3.3.2.1" stretchy="false" xref="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1.1.3.cmml">(</mo><mi id="A1.SS5.SSS3.p1.5.m5.2.2" xref="A1.SS5.SSS3.p1.5.m5.2.2.cmml">x</mi><mo id="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1.1.3.3.2.2" stretchy="false" xref="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1.3" stretchy="false" xref="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.2.1.cmml">|</mo></mrow><mn id="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.3" xref="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.3.cmml">2</mn></msup><mo id="A1.SS5.SSS3.p1.5.m5.4.4.2.1.2" xref="A1.SS5.SSS3.p1.5.m5.4.4.2.1.2.cmml">⁢</mo><mtext id="A1.SS5.SSS3.p1.5.m5.4.4.2.1.3" xref="A1.SS5.SSS3.p1.5.m5.4.4.2.1.3a.cmml">d</mtext><mo id="A1.SS5.SSS3.p1.5.m5.4.4.2.1.2a" xref="A1.SS5.SSS3.p1.5.m5.4.4.2.1.2.cmml">⁢</mo><mi id="A1.SS5.SSS3.p1.5.m5.4.4.2.1.4" xref="A1.SS5.SSS3.p1.5.m5.4.4.2.1.4.cmml">x</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS5.SSS3.p1.5.m5.4b"><apply id="A1.SS5.SSS3.p1.5.m5.4.4.cmml" xref="A1.SS5.SSS3.p1.5.m5.4.4"><eq id="A1.SS5.SSS3.p1.5.m5.4.4.3.cmml" xref="A1.SS5.SSS3.p1.5.m5.4.4.3"></eq><apply id="A1.SS5.SSS3.p1.5.m5.3.3.1.cmml" xref="A1.SS5.SSS3.p1.5.m5.3.3.1"><csymbol cd="ambiguous" id="A1.SS5.SSS3.p1.5.m5.3.3.1.2.cmml" xref="A1.SS5.SSS3.p1.5.m5.3.3.1">superscript</csymbol><apply id="A1.SS5.SSS3.p1.5.m5.3.3.1.1.cmml" xref="A1.SS5.SSS3.p1.5.m5.3.3.1"><csymbol cd="ambiguous" id="A1.SS5.SSS3.p1.5.m5.3.3.1.1.2.cmml" xref="A1.SS5.SSS3.p1.5.m5.3.3.1">subscript</csymbol><apply id="A1.SS5.SSS3.p1.5.m5.3.3.1.1.1.2.cmml" xref="A1.SS5.SSS3.p1.5.m5.3.3.1.1.1.1"><csymbol cd="latexml" id="A1.SS5.SSS3.p1.5.m5.3.3.1.1.1.2.1.cmml" xref="A1.SS5.SSS3.p1.5.m5.3.3.1.1.1.1.2">norm</csymbol><apply id="A1.SS5.SSS3.p1.5.m5.3.3.1.1.1.1.1.cmml" xref="A1.SS5.SSS3.p1.5.m5.3.3.1.1.1.1.1"><minus id="A1.SS5.SSS3.p1.5.m5.3.3.1.1.1.1.1.1.cmml" xref="A1.SS5.SSS3.p1.5.m5.3.3.1.1.1.1.1.1"></minus><ci id="A1.SS5.SSS3.p1.5.m5.3.3.1.1.1.1.1.2.cmml" xref="A1.SS5.SSS3.p1.5.m5.3.3.1.1.1.1.1.2">𝑝</ci><ci id="A1.SS5.SSS3.p1.5.m5.3.3.1.1.1.1.1.3.cmml" xref="A1.SS5.SSS3.p1.5.m5.3.3.1.1.1.1.1.3">𝑞</ci></apply></apply><cn id="A1.SS5.SSS3.p1.5.m5.3.3.1.1.3.cmml" type="integer" xref="A1.SS5.SSS3.p1.5.m5.3.3.1.1.3">2</cn></apply><cn id="A1.SS5.SSS3.p1.5.m5.3.3.1.3.cmml" type="integer" xref="A1.SS5.SSS3.p1.5.m5.3.3.1.3">2</cn></apply><apply id="A1.SS5.SSS3.p1.5.m5.4.4.2.cmml" xref="A1.SS5.SSS3.p1.5.m5.4.4.2"><int id="A1.SS5.SSS3.p1.5.m5.4.4.2.2.cmml" xref="A1.SS5.SSS3.p1.5.m5.4.4.2.2"></int><apply id="A1.SS5.SSS3.p1.5.m5.4.4.2.1.cmml" xref="A1.SS5.SSS3.p1.5.m5.4.4.2.1"><times id="A1.SS5.SSS3.p1.5.m5.4.4.2.1.2.cmml" xref="A1.SS5.SSS3.p1.5.m5.4.4.2.1.2"></times><apply id="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.cmml" xref="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1"><csymbol cd="ambiguous" id="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.2.cmml" xref="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1">superscript</csymbol><apply id="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.2.cmml" xref="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1"><abs id="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.2.1.cmml" xref="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1.2"></abs><apply id="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1.1.cmml" xref="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1.1"><minus id="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1.1.1.cmml" xref="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1.1.1"></minus><apply id="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1.1.2.cmml" xref="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1.1.2"><times id="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1.1.2.1.cmml" xref="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1.1.2.1"></times><ci id="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1.1.2.2.cmml" xref="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1.1.2.2">𝑝</ci><ci id="A1.SS5.SSS3.p1.5.m5.1.1.cmml" xref="A1.SS5.SSS3.p1.5.m5.1.1">𝑥</ci></apply><apply id="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1.1.3.cmml" xref="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1.1.3"><times id="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1.1.3.1.cmml" xref="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1.1.3.1"></times><ci id="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1.1.3.2.cmml" xref="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.1.1.1.3.2">𝑞</ci><ci id="A1.SS5.SSS3.p1.5.m5.2.2.cmml" xref="A1.SS5.SSS3.p1.5.m5.2.2">𝑥</ci></apply></apply></apply><cn id="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.3.cmml" type="integer" xref="A1.SS5.SSS3.p1.5.m5.4.4.2.1.1.3">2</cn></apply><ci id="A1.SS5.SSS3.p1.5.m5.4.4.2.1.3a.cmml" xref="A1.SS5.SSS3.p1.5.m5.4.4.2.1.3"><mtext id="A1.SS5.SSS3.p1.5.m5.4.4.2.1.3.cmml" xref="A1.SS5.SSS3.p1.5.m5.4.4.2.1.3">d</mtext></ci><ci id="A1.SS5.SSS3.p1.5.m5.4.4.2.1.4.cmml" xref="A1.SS5.SSS3.p1.5.m5.4.4.2.1.4">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.SSS3.p1.5.m5.4c">||p-q||_{2}^{2}=\int|p(x)-q(x)|^{2}\textup{d}x</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.SSS3.p1.5.m5.4d">| | italic_p - italic_q | | start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT = ∫ | italic_p ( italic_x ) - italic_q ( italic_x ) | start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT d italic_x</annotation></semantics></math> is also a proper distance metric, it does not locally agree with any information-theoretic divergence measure <cite class="ltx_cite ltx_citemacro_citep">(Amari, <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib3" title="">2016</a>)</cite> and is therefore not suited to measure distance between PDFs.<span class="ltx_note ltx_role_footnote" id="footnote11"><sup class="ltx_note_mark">11</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">11</sup><span class="ltx_tag ltx_tag_note">11</span>Consequently, PCA embedding with such naive distance measure results in erratic trajectories with obscure geometrical features, as explored in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.F12" title="Figure 12 ‣ A.4 Comparison of InPCA and standard PCA ‣ Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">12</span></a></span></span></span>.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS5.SSS3.p2">
<p class="ltx_p" id="A1.SS5.SSS3.p2.1">In contrast, classical KDE theory focuses on minimizing the Mean Integrated Squared Error (MISE), which is fundamentally an <math alttext="L_{2}" class="ltx_Math" display="inline" id="A1.SS5.SSS3.p2.1.m1.1"><semantics id="A1.SS5.SSS3.p2.1.m1.1a"><msub id="A1.SS5.SSS3.p2.1.m1.1.1" xref="A1.SS5.SSS3.p2.1.m1.1.1.cmml"><mi id="A1.SS5.SSS3.p2.1.m1.1.1.2" xref="A1.SS5.SSS3.p2.1.m1.1.1.2.cmml">L</mi><mn id="A1.SS5.SSS3.p2.1.m1.1.1.3" xref="A1.SS5.SSS3.p2.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A1.SS5.SSS3.p2.1.m1.1b"><apply id="A1.SS5.SSS3.p2.1.m1.1.1.cmml" xref="A1.SS5.SSS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS5.SSS3.p2.1.m1.1.1.1.cmml" xref="A1.SS5.SSS3.p2.1.m1.1.1">subscript</csymbol><ci id="A1.SS5.SSS3.p2.1.m1.1.1.2.cmml" xref="A1.SS5.SSS3.p2.1.m1.1.1.2">𝐿</ci><cn id="A1.SS5.SSS3.p2.1.m1.1.1.3.cmml" type="integer" xref="A1.SS5.SSS3.p2.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.SSS3.p2.1.m1.1c">L_{2}</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.SSS3.p2.1.m1.1d">italic_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>-type distance that disagrees (globally and locally) with information-theoretic divergence measure.
Nevertheless MISE is widely used in classical KDE literature for several reasons:</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS5.SSS3.p3">
<p class="ltx_p" id="A1.SS5.SSS3.p3.1">1. It can be easily analyzed mathematically using bias-variance decompositions <cite class="ltx_cite ltx_citemacro_citep">(Wand &amp; Jones, <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib41" title="">1994</a>, Chapter 2.3)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS5.SSS3.p4">
<p class="ltx_p" id="A1.SS5.SSS3.p4.1">2. It leads to closed-form solutions for optimal kernels and bandwidths under certain assumptions.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS5.SSS3.p5">
<p class="ltx_p" id="A1.SS5.SSS3.p5.1">3. It provides a tractable objective function for theoretical analysis and optimization.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS5.SSS3.p6">
<p class="ltx_p" id="A1.SS5.SSS3.p6.1">As a consequence of its popularity and mathematical tractability, MISE has been used to derive heuristic bandwidth schedules, such as Silverman’s rule (Equation <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.E14" title="Equation 14 ‣ A.5.1 Optimal Bandwidth ‣ A.5 Additional notes on Kernel Density Estimation ‣ Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">14</span></a>).</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS5.SSS3.p7">
<p class="ltx_p" id="A1.SS5.SSS3.p7.1">We note that modern machine learning often prefers loss functions from the <math alttext="f" class="ltx_Math" display="inline" id="A1.SS5.SSS3.p7.1.m1.1"><semantics id="A1.SS5.SSS3.p7.1.m1.1a"><mi id="A1.SS5.SSS3.p7.1.m1.1.1" xref="A1.SS5.SSS3.p7.1.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="A1.SS5.SSS3.p7.1.m1.1b"><ci id="A1.SS5.SSS3.p7.1.m1.1.1.cmml" xref="A1.SS5.SSS3.p7.1.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.SSS3.p7.1.m1.1c">f</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.SSS3.p7.1.m1.1d">italic_f</annotation></semantics></math>-divergence family <cite class="ltx_cite ltx_citemacro_citep">(Rényi, <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib29" title="">1961</a>)</cite>,
such as KL-divergence, cross-entropy, and Hellinger distance (Equation <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#S3.E2" title="Equation 2 ‣ 3.1 InPCA visualization ‣ 3 Methodology ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">2</span></a>).
These measures have strong information-theoretic motivations and are often more appropriate for probabilistic models.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS5.SSS3.p8">
<p class="ltx_p" id="A1.SS5.SSS3.p8.1">Despite the prevalence of <math alttext="f" class="ltx_Math" display="inline" id="A1.SS5.SSS3.p8.1.m1.1"><semantics id="A1.SS5.SSS3.p8.1.m1.1a"><mi id="A1.SS5.SSS3.p8.1.m1.1.1" xref="A1.SS5.SSS3.p8.1.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="A1.SS5.SSS3.p8.1.m1.1b"><ci id="A1.SS5.SSS3.p8.1.m1.1.1.cmml" xref="A1.SS5.SSS3.p8.1.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.SSS3.p8.1.m1.1c">f</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.SSS3.p8.1.m1.1d">italic_f</annotation></semantics></math>-divergences in machine learning, to the best of our knowledge, there are no rigorous derivations of optimal kernel shapes or bandwidth schedules based on these measures.
This gap presents an interesting avenue for future research, potentially bridging classical statistical theory with modern machine learning practices.
Bridging this gap is beyond the scope of this paper.
However, we speculate that this gap is the reason why the optimal kernel shape employed by LLMs differs significantly from those in classical optimal kernel theory (namely, Gaussian and Epanechnikov).</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
<section class="ltx_subsection" id="A1.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.6 </span>Adaptive Kernel Visualization: Comparing LLaMA-2 with KDE</h3>
<div class="ltx_para ltx_noindent" id="A1.SS6.p1">
<p class="ltx_p" id="A1.SS6.p1.1">This section provides a comprehensive visual analysis of DE processes across various target distributions,
including Gaussian, uniform, and randomly generated probability density functions.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS6.p2">
<p class="ltx_p" id="A1.SS6.p2.1">We present side-by-side comparisons of the DE trajectories for LLaMA-2, Gaussian KDE, and KDE with fitted kernel designed to emulate LLaMA-2’s behavior.
The fitted KDE process closely mirrors LLaMA-2’s estimation patterns,
while both diverge significantly from traditional Gaussian KDE approaches.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS6.p3">
<p class="ltx_p" id="A1.SS6.p3.1"><span class="ltx_text ltx_font_bold" id="A1.SS6.p3.1.1">Narrow Gaussian distribution target</span></p>
</div>
<figure class="ltx_figure" id="A1.F15">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A1.F15.1" style="width:274.3pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="302" id="A1.F15.1.g1" src="extracted/5899401/figures/fitted_kernel_13b_gaussian_0.1_hel_dist_False.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 14: </span>Fitted kernel width and shape schedule</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A1.F15.2" style="width:111.3pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="473" id="A1.F15.2.g1" src="extracted/5899401/figures/fitted_kernel_13b_gaussian_0.1_Hellinger_2D_94.png" width="658"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 15: </span>2D inPCA capturing 94% of Hellinger variances</figcaption>
</figure>
</div>
</div>
</figure>
<figure class="ltx_figure" id="A1.F16">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="120" id="A1.F16.g1" src="extracted/5899401/figures/fitted_kernel_13b_gaussian_0.1_fitted_kernel_visualization_5_Log_True.png" width="658"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="120" id="A1.F16.g2" src="extracted/5899401/figures/fitted_kernel_13b_gaussian_0.1_fitted_kernel_visualization_20_Log_True.png" width="658"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="120" id="A1.F16.g3" src="extracted/5899401/figures/fitted_kernel_13b_gaussian_0.1_fitted_kernel_visualization_80_Log_True.png" width="658"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="120" id="A1.F16.g4" src="extracted/5899401/figures/fitted_kernel_13b_gaussian_0.1_fitted_kernel_visualization_140_Log_True.png" width="658"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="88" id="A1.F16.g5" src="extracted/5899401/figures/fitted_kernel_13b_gaussian_0.1_true_PDF_Log_True.png" width="180"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 16: </span>Fitted kernel visualization with narrow gaussian target</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
<div class="ltx_para ltx_noindent" id="A1.SS6.p4">
<p class="ltx_p" id="A1.SS6.p4.1"><span class="ltx_text ltx_font_bold" id="A1.SS6.p4.1.1">Wide Gaussian distribution target</span></p>
</div>
<figure class="ltx_figure" id="A1.F18">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A1.F18.1" style="width:274.3pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="305" id="A1.F18.1.g1" src="extracted/5899401/figures/fitted_kernel_13b_gaussian_0.5_hel_dist_False.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 17: </span>Fitted kernel width and shape schedule</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A1.F18.2" style="width:111.3pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="658" id="A1.F18.2.g1" src="extracted/5899401/figures/fitted_kernel_13b_gaussian_0.5_Hellinger_2D_88.png" width="658"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 18: </span>2D inPCA capturing 88% of Hellinger variances</figcaption>
</figure>
</div>
</div>
</figure>
<figure class="ltx_figure" id="A1.F19">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="120" id="A1.F19.g1" src="extracted/5899401/figures/fitted_kernel_13b_gaussian_0.5_fitted_kernel_visualization_5_Log_True.png" width="658"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="120" id="A1.F19.g2" src="extracted/5899401/figures/fitted_kernel_13b_gaussian_0.5_fitted_kernel_visualization_10_Log_True.png" width="658"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="120" id="A1.F19.g3" src="extracted/5899401/figures/fitted_kernel_13b_gaussian_0.5_fitted_kernel_visualization_20_Log_True.png" width="658"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="120" id="A1.F19.g4" src="extracted/5899401/figures/fitted_kernel_13b_gaussian_0.5_fitted_kernel_visualization_140_Log_True.png" width="658"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="88" id="A1.F19.g5" src="extracted/5899401/figures/fitted_kernel_13b_gaussian_0.5_true_PDF_Log_True.png" width="180"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 19: </span>Fitted kernel visualization with wide gaussian target</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
<div class="ltx_para ltx_noindent" id="A1.SS6.p5">
<p class="ltx_p" id="A1.SS6.p5.1"><span class="ltx_text ltx_font_bold" id="A1.SS6.p5.1.1">Narrow uniform distribution target</span></p>
</div>
<figure class="ltx_figure" id="A1.F21">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A1.F21.1" style="width:274.3pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="303" id="A1.F21.1.g1" src="extracted/5899401/figures/fitted_kernel_13_uniform_0.1_hel_dist_False.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 20: </span>Fitted kernel width and shape schedule</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A1.F21.2" style="width:111.3pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="647" id="A1.F21.2.g1" src="extracted/5899401/figures/fitted_kernel_13_uniform_0.1_Hellinger_2D_92.png" width="658"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 21: </span>2D inPCA capturing 92% of Hellinger variances</figcaption>
</figure>
</div>
</div>
</figure>
<figure class="ltx_figure" id="A1.F22">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="120" id="A1.F22.g1" src="extracted/5899401/figures/fitted_kernel_13_uniform_0.1_fitted_kernel_visualization_0_Log_True.png" width="658"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="120" id="A1.F22.g2" src="extracted/5899401/figures/fitted_kernel_13_uniform_0.1_fitted_kernel_visualization_5_Log_True.png" width="658"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="120" id="A1.F22.g3" src="extracted/5899401/figures/fitted_kernel_13_uniform_0.1_fitted_kernel_visualization_10_Log_True.png" width="658"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="120" id="A1.F22.g4" src="extracted/5899401/figures/fitted_kernel_13_uniform_0.1_fitted_kernel_visualization_60_Log_True.png" width="658"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="120" id="A1.F22.g5" src="extracted/5899401/figures/fitted_kernel_13_uniform_0.1_fitted_kernel_visualization_100_Log_True.png" width="658"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="88" id="A1.F22.g6" src="extracted/5899401/figures/fitted_kernel_13_uniform_0.1_true_PDF_Log_True.png" width="180"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 22: </span>Fitted kernel visualization with narrow uniform target</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
<div class="ltx_para ltx_noindent" id="A1.SS6.p6">
<p class="ltx_p" id="A1.SS6.p6.1"><span class="ltx_text ltx_font_bold" id="A1.SS6.p6.1.1">Wide uniform distribution target</span></p>
</div>
<figure class="ltx_figure" id="A1.F24">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A1.F24.1" style="width:274.3pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="302" id="A1.F24.1.g1" src="extracted/5899401/figures/fitted_kernel_13_uniform_0.3_hel_dist_False.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 23: </span>Fitted kernel width and shape schedule</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A1.F24.2" style="width:111.3pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="658" id="A1.F24.2.g1" src="extracted/5899401/figures/fitted_kernel_13_uniform_0.3_Hellinger_2D_83.png" width="658"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 24: </span>2D inPCA capturing 83% of Hellinger variances</figcaption>
</figure>
</div>
</div>
</figure>
<figure class="ltx_figure" id="A1.F25">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="120" id="A1.F25.g1" src="extracted/5899401/figures/fitted_kernel_13_uniform_0.3_fitted_kernel_visualization_5_Log_True.png" width="658"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="120" id="A1.F25.g2" src="extracted/5899401/figures/fitted_kernel_13_uniform_0.3_fitted_kernel_visualization_10_Log_True.png" width="658"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="120" id="A1.F25.g3" src="extracted/5899401/figures/fitted_kernel_13_uniform_0.3_fitted_kernel_visualization_50_Log_True.png" width="658"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="120" id="A1.F25.g4" src="extracted/5899401/figures/fitted_kernel_13_uniform_0.3_fitted_kernel_visualization_80_Log_True.png" width="658"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="120" id="A1.F25.g5" src="extracted/5899401/figures/fitted_kernel_13_uniform_0.3_fitted_kernel_visualization_140_Log_True.png" width="658"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="88" id="A1.F25.g6" src="extracted/5899401/figures/fitted_kernel_13_uniform_0.3_true_PDF_Log_True.png" width="180"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 25: </span>Fitted kernel visualization with wide uniform target</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_subsection" id="A1.SS7">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.7 </span>Randomly generated PDFs</h3>
<div class="ltx_para ltx_noindent" id="A1.SS7.p1">
<p class="ltx_p" id="A1.SS7.p1.2">For completion, we also test LLaMA-2’s in-context DE ability on randomly generated PDFs.
As noted in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.SS5" title="A.5 Additional notes on Kernel Density Estimation ‣ Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">A.5</span></a> and Chapter 2.9 of <cite class="ltx_cite ltx_citemacro_cite">Wand &amp; Jones (<a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib41" title="">1994</a>)</cite>, PDFs with high average curvature (defined as <math alttext="R(p^{\prime\prime})=\int p^{\prime\prime}(x)^{2}dx" class="ltx_Math" display="inline" id="A1.SS7.p1.1.m1.2"><semantics id="A1.SS7.p1.1.m1.2a"><mrow id="A1.SS7.p1.1.m1.2.2" xref="A1.SS7.p1.1.m1.2.2.cmml"><mrow id="A1.SS7.p1.1.m1.2.2.1" xref="A1.SS7.p1.1.m1.2.2.1.cmml"><mi id="A1.SS7.p1.1.m1.2.2.1.3" xref="A1.SS7.p1.1.m1.2.2.1.3.cmml">R</mi><mo id="A1.SS7.p1.1.m1.2.2.1.2" xref="A1.SS7.p1.1.m1.2.2.1.2.cmml">⁢</mo><mrow id="A1.SS7.p1.1.m1.2.2.1.1.1" xref="A1.SS7.p1.1.m1.2.2.1.1.1.1.cmml"><mo id="A1.SS7.p1.1.m1.2.2.1.1.1.2" stretchy="false" xref="A1.SS7.p1.1.m1.2.2.1.1.1.1.cmml">(</mo><msup id="A1.SS7.p1.1.m1.2.2.1.1.1.1" xref="A1.SS7.p1.1.m1.2.2.1.1.1.1.cmml"><mi id="A1.SS7.p1.1.m1.2.2.1.1.1.1.2" xref="A1.SS7.p1.1.m1.2.2.1.1.1.1.2.cmml">p</mi><mo id="A1.SS7.p1.1.m1.2.2.1.1.1.1.3" xref="A1.SS7.p1.1.m1.2.2.1.1.1.1.3.cmml">′′</mo></msup><mo id="A1.SS7.p1.1.m1.2.2.1.1.1.3" stretchy="false" xref="A1.SS7.p1.1.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.SS7.p1.1.m1.2.2.2" rspace="0.111em" xref="A1.SS7.p1.1.m1.2.2.2.cmml">=</mo><mrow id="A1.SS7.p1.1.m1.2.2.3" xref="A1.SS7.p1.1.m1.2.2.3.cmml"><mo id="A1.SS7.p1.1.m1.2.2.3.1" xref="A1.SS7.p1.1.m1.2.2.3.1.cmml">∫</mo><mrow id="A1.SS7.p1.1.m1.2.2.3.2" xref="A1.SS7.p1.1.m1.2.2.3.2.cmml"><msup id="A1.SS7.p1.1.m1.2.2.3.2.2" xref="A1.SS7.p1.1.m1.2.2.3.2.2.cmml"><mi id="A1.SS7.p1.1.m1.2.2.3.2.2.2" xref="A1.SS7.p1.1.m1.2.2.3.2.2.2.cmml">p</mi><mo id="A1.SS7.p1.1.m1.2.2.3.2.2.3" xref="A1.SS7.p1.1.m1.2.2.3.2.2.3.cmml">′′</mo></msup><mo id="A1.SS7.p1.1.m1.2.2.3.2.1" xref="A1.SS7.p1.1.m1.2.2.3.2.1.cmml">⁢</mo><msup id="A1.SS7.p1.1.m1.2.2.3.2.3" xref="A1.SS7.p1.1.m1.2.2.3.2.3.cmml"><mrow id="A1.SS7.p1.1.m1.2.2.3.2.3.2.2" xref="A1.SS7.p1.1.m1.2.2.3.2.3.cmml"><mo id="A1.SS7.p1.1.m1.2.2.3.2.3.2.2.1" stretchy="false" xref="A1.SS7.p1.1.m1.2.2.3.2.3.cmml">(</mo><mi id="A1.SS7.p1.1.m1.1.1" xref="A1.SS7.p1.1.m1.1.1.cmml">x</mi><mo id="A1.SS7.p1.1.m1.2.2.3.2.3.2.2.2" stretchy="false" xref="A1.SS7.p1.1.m1.2.2.3.2.3.cmml">)</mo></mrow><mn id="A1.SS7.p1.1.m1.2.2.3.2.3.3" xref="A1.SS7.p1.1.m1.2.2.3.2.3.3.cmml">2</mn></msup><mo id="A1.SS7.p1.1.m1.2.2.3.2.1a" lspace="0em" xref="A1.SS7.p1.1.m1.2.2.3.2.1.cmml">⁢</mo><mrow id="A1.SS7.p1.1.m1.2.2.3.2.4" xref="A1.SS7.p1.1.m1.2.2.3.2.4.cmml"><mo id="A1.SS7.p1.1.m1.2.2.3.2.4.1" rspace="0em" xref="A1.SS7.p1.1.m1.2.2.3.2.4.1.cmml">𝑑</mo><mi id="A1.SS7.p1.1.m1.2.2.3.2.4.2" xref="A1.SS7.p1.1.m1.2.2.3.2.4.2.cmml">x</mi></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS7.p1.1.m1.2b"><apply id="A1.SS7.p1.1.m1.2.2.cmml" xref="A1.SS7.p1.1.m1.2.2"><eq id="A1.SS7.p1.1.m1.2.2.2.cmml" xref="A1.SS7.p1.1.m1.2.2.2"></eq><apply id="A1.SS7.p1.1.m1.2.2.1.cmml" xref="A1.SS7.p1.1.m1.2.2.1"><times id="A1.SS7.p1.1.m1.2.2.1.2.cmml" xref="A1.SS7.p1.1.m1.2.2.1.2"></times><ci id="A1.SS7.p1.1.m1.2.2.1.3.cmml" xref="A1.SS7.p1.1.m1.2.2.1.3">𝑅</ci><apply id="A1.SS7.p1.1.m1.2.2.1.1.1.1.cmml" xref="A1.SS7.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="A1.SS7.p1.1.m1.2.2.1.1.1.1.1.cmml" xref="A1.SS7.p1.1.m1.2.2.1.1.1">superscript</csymbol><ci id="A1.SS7.p1.1.m1.2.2.1.1.1.1.2.cmml" xref="A1.SS7.p1.1.m1.2.2.1.1.1.1.2">𝑝</ci><ci id="A1.SS7.p1.1.m1.2.2.1.1.1.1.3.cmml" xref="A1.SS7.p1.1.m1.2.2.1.1.1.1.3">′′</ci></apply></apply><apply id="A1.SS7.p1.1.m1.2.2.3.cmml" xref="A1.SS7.p1.1.m1.2.2.3"><int id="A1.SS7.p1.1.m1.2.2.3.1.cmml" xref="A1.SS7.p1.1.m1.2.2.3.1"></int><apply id="A1.SS7.p1.1.m1.2.2.3.2.cmml" xref="A1.SS7.p1.1.m1.2.2.3.2"><times id="A1.SS7.p1.1.m1.2.2.3.2.1.cmml" xref="A1.SS7.p1.1.m1.2.2.3.2.1"></times><apply id="A1.SS7.p1.1.m1.2.2.3.2.2.cmml" xref="A1.SS7.p1.1.m1.2.2.3.2.2"><csymbol cd="ambiguous" id="A1.SS7.p1.1.m1.2.2.3.2.2.1.cmml" xref="A1.SS7.p1.1.m1.2.2.3.2.2">superscript</csymbol><ci id="A1.SS7.p1.1.m1.2.2.3.2.2.2.cmml" xref="A1.SS7.p1.1.m1.2.2.3.2.2.2">𝑝</ci><ci id="A1.SS7.p1.1.m1.2.2.3.2.2.3.cmml" xref="A1.SS7.p1.1.m1.2.2.3.2.2.3">′′</ci></apply><apply id="A1.SS7.p1.1.m1.2.2.3.2.3.cmml" xref="A1.SS7.p1.1.m1.2.2.3.2.3"><csymbol cd="ambiguous" id="A1.SS7.p1.1.m1.2.2.3.2.3.1.cmml" xref="A1.SS7.p1.1.m1.2.2.3.2.3">superscript</csymbol><ci id="A1.SS7.p1.1.m1.1.1.cmml" xref="A1.SS7.p1.1.m1.1.1">𝑥</ci><cn id="A1.SS7.p1.1.m1.2.2.3.2.3.3.cmml" type="integer" xref="A1.SS7.p1.1.m1.2.2.3.2.3.3">2</cn></apply><apply id="A1.SS7.p1.1.m1.2.2.3.2.4.cmml" xref="A1.SS7.p1.1.m1.2.2.3.2.4"><csymbol cd="latexml" id="A1.SS7.p1.1.m1.2.2.3.2.4.1.cmml" xref="A1.SS7.p1.1.m1.2.2.3.2.4.1">differential-d</csymbol><ci id="A1.SS7.p1.1.m1.2.2.3.2.4.2.cmml" xref="A1.SS7.p1.1.m1.2.2.3.2.4.2">𝑥</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS7.p1.1.m1.2c">R(p^{\prime\prime})=\int p^{\prime\prime}(x)^{2}dx</annotation><annotation encoding="application/x-llamapun" id="A1.SS7.p1.1.m1.2d">italic_R ( italic_p start_POSTSUPERSCRIPT ′ ′ end_POSTSUPERSCRIPT ) = ∫ italic_p start_POSTSUPERSCRIPT ′ ′ end_POSTSUPERSCRIPT ( italic_x ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_d italic_x</annotation></semantics></math>) are more difficult
to estimate from data. Therefore, we want to be able to control the average curvature <math alttext="R(p^{\prime\prime})" class="ltx_Math" display="inline" id="A1.SS7.p1.2.m2.1"><semantics id="A1.SS7.p1.2.m2.1a"><mrow id="A1.SS7.p1.2.m2.1.1" xref="A1.SS7.p1.2.m2.1.1.cmml"><mi id="A1.SS7.p1.2.m2.1.1.3" xref="A1.SS7.p1.2.m2.1.1.3.cmml">R</mi><mo id="A1.SS7.p1.2.m2.1.1.2" xref="A1.SS7.p1.2.m2.1.1.2.cmml">⁢</mo><mrow id="A1.SS7.p1.2.m2.1.1.1.1" xref="A1.SS7.p1.2.m2.1.1.1.1.1.cmml"><mo id="A1.SS7.p1.2.m2.1.1.1.1.2" stretchy="false" xref="A1.SS7.p1.2.m2.1.1.1.1.1.cmml">(</mo><msup id="A1.SS7.p1.2.m2.1.1.1.1.1" xref="A1.SS7.p1.2.m2.1.1.1.1.1.cmml"><mi id="A1.SS7.p1.2.m2.1.1.1.1.1.2" xref="A1.SS7.p1.2.m2.1.1.1.1.1.2.cmml">p</mi><mo id="A1.SS7.p1.2.m2.1.1.1.1.1.3" xref="A1.SS7.p1.2.m2.1.1.1.1.1.3.cmml">′′</mo></msup><mo id="A1.SS7.p1.2.m2.1.1.1.1.3" stretchy="false" xref="A1.SS7.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS7.p1.2.m2.1b"><apply id="A1.SS7.p1.2.m2.1.1.cmml" xref="A1.SS7.p1.2.m2.1.1"><times id="A1.SS7.p1.2.m2.1.1.2.cmml" xref="A1.SS7.p1.2.m2.1.1.2"></times><ci id="A1.SS7.p1.2.m2.1.1.3.cmml" xref="A1.SS7.p1.2.m2.1.1.3">𝑅</ci><apply id="A1.SS7.p1.2.m2.1.1.1.1.1.cmml" xref="A1.SS7.p1.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS7.p1.2.m2.1.1.1.1.1.1.cmml" xref="A1.SS7.p1.2.m2.1.1.1.1">superscript</csymbol><ci id="A1.SS7.p1.2.m2.1.1.1.1.1.2.cmml" xref="A1.SS7.p1.2.m2.1.1.1.1.1.2">𝑝</ci><ci id="A1.SS7.p1.2.m2.1.1.1.1.1.3.cmml" xref="A1.SS7.p1.2.m2.1.1.1.1.1.3">′′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS7.p1.2.m2.1c">R(p^{\prime\prime})</annotation><annotation encoding="application/x-llamapun" id="A1.SS7.p1.2.m2.1d">italic_R ( italic_p start_POSTSUPERSCRIPT ′ ′ end_POSTSUPERSCRIPT )</annotation></semantics></math> of the generated random PDFs.
We employ a technique for generating random PDF using Gaussian processes.
This allows us to create a wide variety of smooth, continuous distributions with controllable average curvatures.</p>
</div>
<section class="ltx_paragraph" id="A1.SS7.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Gaussian Process Generation:</h5>
<div class="ltx_para ltx_noindent" id="A1.SS7.SSS0.Px1.p1">
<p class="ltx_p" id="A1.SS7.SSS0.Px1.p1.2">We generate random PDFs using a Gaussian process with a predefined covariance matrix. The process is defined over the interval [0, 1], discretized into <math alttext="N_{x}=10^{p}" class="ltx_Math" display="inline" id="A1.SS7.SSS0.Px1.p1.1.m1.1"><semantics id="A1.SS7.SSS0.Px1.p1.1.m1.1a"><mrow id="A1.SS7.SSS0.Px1.p1.1.m1.1.1" xref="A1.SS7.SSS0.Px1.p1.1.m1.1.1.cmml"><msub id="A1.SS7.SSS0.Px1.p1.1.m1.1.1.2" xref="A1.SS7.SSS0.Px1.p1.1.m1.1.1.2.cmml"><mi id="A1.SS7.SSS0.Px1.p1.1.m1.1.1.2.2" xref="A1.SS7.SSS0.Px1.p1.1.m1.1.1.2.2.cmml">N</mi><mi id="A1.SS7.SSS0.Px1.p1.1.m1.1.1.2.3" xref="A1.SS7.SSS0.Px1.p1.1.m1.1.1.2.3.cmml">x</mi></msub><mo id="A1.SS7.SSS0.Px1.p1.1.m1.1.1.1" xref="A1.SS7.SSS0.Px1.p1.1.m1.1.1.1.cmml">=</mo><msup id="A1.SS7.SSS0.Px1.p1.1.m1.1.1.3" xref="A1.SS7.SSS0.Px1.p1.1.m1.1.1.3.cmml"><mn id="A1.SS7.SSS0.Px1.p1.1.m1.1.1.3.2" xref="A1.SS7.SSS0.Px1.p1.1.m1.1.1.3.2.cmml">10</mn><mi id="A1.SS7.SSS0.Px1.p1.1.m1.1.1.3.3" xref="A1.SS7.SSS0.Px1.p1.1.m1.1.1.3.3.cmml">p</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS7.SSS0.Px1.p1.1.m1.1b"><apply id="A1.SS7.SSS0.Px1.p1.1.m1.1.1.cmml" xref="A1.SS7.SSS0.Px1.p1.1.m1.1.1"><eq id="A1.SS7.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="A1.SS7.SSS0.Px1.p1.1.m1.1.1.1"></eq><apply id="A1.SS7.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="A1.SS7.SSS0.Px1.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="A1.SS7.SSS0.Px1.p1.1.m1.1.1.2.1.cmml" xref="A1.SS7.SSS0.Px1.p1.1.m1.1.1.2">subscript</csymbol><ci id="A1.SS7.SSS0.Px1.p1.1.m1.1.1.2.2.cmml" xref="A1.SS7.SSS0.Px1.p1.1.m1.1.1.2.2">𝑁</ci><ci id="A1.SS7.SSS0.Px1.p1.1.m1.1.1.2.3.cmml" xref="A1.SS7.SSS0.Px1.p1.1.m1.1.1.2.3">𝑥</ci></apply><apply id="A1.SS7.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="A1.SS7.SSS0.Px1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="A1.SS7.SSS0.Px1.p1.1.m1.1.1.3.1.cmml" xref="A1.SS7.SSS0.Px1.p1.1.m1.1.1.3">superscript</csymbol><cn id="A1.SS7.SSS0.Px1.p1.1.m1.1.1.3.2.cmml" type="integer" xref="A1.SS7.SSS0.Px1.p1.1.m1.1.1.3.2">10</cn><ci id="A1.SS7.SSS0.Px1.p1.1.m1.1.1.3.3.cmml" xref="A1.SS7.SSS0.Px1.p1.1.m1.1.1.3.3">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS7.SSS0.Px1.p1.1.m1.1c">N_{x}=10^{p}</annotation><annotation encoding="application/x-llamapun" id="A1.SS7.SSS0.Px1.p1.1.m1.1d">italic_N start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT = 10 start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT</annotation></semantics></math> points, where <math alttext="p" class="ltx_Math" display="inline" id="A1.SS7.SSS0.Px1.p1.2.m2.1"><semantics id="A1.SS7.SSS0.Px1.p1.2.m2.1a"><mi id="A1.SS7.SSS0.Px1.p1.2.m2.1.1" xref="A1.SS7.SSS0.Px1.p1.2.m2.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="A1.SS7.SSS0.Px1.p1.2.m2.1b"><ci id="A1.SS7.SSS0.Px1.p1.2.m2.1.1.cmml" xref="A1.SS7.SSS0.Px1.p1.2.m2.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS7.SSS0.Px1.p1.2.m2.1c">p</annotation><annotation encoding="application/x-llamapun" id="A1.SS7.SSS0.Px1.p1.2.m2.1d">italic_p</annotation></semantics></math> is the precision parameter.
The covariance matrix is constructed using a squared exponential kernel <cite class="ltx_cite ltx_citemacro_citep">(Seeger, <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib33" title="">2004</a>)</cite>:</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS7.SSS0.Px1.p2">
<table class="ltx_equation ltx_eqn_table" id="A1.E15">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="K(x,y)=\exp\left(-\frac{(x-y)^{2}}{2l^{2}}\right)" class="ltx_Math" display="block" id="A1.E15.m1.5"><semantics id="A1.E15.m1.5a"><mrow id="A1.E15.m1.5.5" xref="A1.E15.m1.5.5.cmml"><mrow id="A1.E15.m1.5.5.3" xref="A1.E15.m1.5.5.3.cmml"><mi id="A1.E15.m1.5.5.3.2" xref="A1.E15.m1.5.5.3.2.cmml">K</mi><mo id="A1.E15.m1.5.5.3.1" xref="A1.E15.m1.5.5.3.1.cmml">⁢</mo><mrow id="A1.E15.m1.5.5.3.3.2" xref="A1.E15.m1.5.5.3.3.1.cmml"><mo id="A1.E15.m1.5.5.3.3.2.1" stretchy="false" xref="A1.E15.m1.5.5.3.3.1.cmml">(</mo><mi id="A1.E15.m1.2.2" xref="A1.E15.m1.2.2.cmml">x</mi><mo id="A1.E15.m1.5.5.3.3.2.2" xref="A1.E15.m1.5.5.3.3.1.cmml">,</mo><mi id="A1.E15.m1.3.3" xref="A1.E15.m1.3.3.cmml">y</mi><mo id="A1.E15.m1.5.5.3.3.2.3" stretchy="false" xref="A1.E15.m1.5.5.3.3.1.cmml">)</mo></mrow></mrow><mo id="A1.E15.m1.5.5.2" xref="A1.E15.m1.5.5.2.cmml">=</mo><mrow id="A1.E15.m1.5.5.1.1" xref="A1.E15.m1.5.5.1.2.cmml"><mi id="A1.E15.m1.4.4" xref="A1.E15.m1.4.4.cmml">exp</mi><mo id="A1.E15.m1.5.5.1.1a" xref="A1.E15.m1.5.5.1.2.cmml">⁡</mo><mrow id="A1.E15.m1.5.5.1.1.1" xref="A1.E15.m1.5.5.1.2.cmml"><mo id="A1.E15.m1.5.5.1.1.1.2" xref="A1.E15.m1.5.5.1.2.cmml">(</mo><mrow id="A1.E15.m1.5.5.1.1.1.1" xref="A1.E15.m1.5.5.1.1.1.1.cmml"><mo id="A1.E15.m1.5.5.1.1.1.1a" xref="A1.E15.m1.5.5.1.1.1.1.cmml">−</mo><mfrac id="A1.E15.m1.1.1" xref="A1.E15.m1.1.1.cmml"><msup id="A1.E15.m1.1.1.1" xref="A1.E15.m1.1.1.1.cmml"><mrow id="A1.E15.m1.1.1.1.1.1" xref="A1.E15.m1.1.1.1.1.1.1.cmml"><mo id="A1.E15.m1.1.1.1.1.1.2" stretchy="false" xref="A1.E15.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E15.m1.1.1.1.1.1.1" xref="A1.E15.m1.1.1.1.1.1.1.cmml"><mi id="A1.E15.m1.1.1.1.1.1.1.2" xref="A1.E15.m1.1.1.1.1.1.1.2.cmml">x</mi><mo id="A1.E15.m1.1.1.1.1.1.1.1" xref="A1.E15.m1.1.1.1.1.1.1.1.cmml">−</mo><mi id="A1.E15.m1.1.1.1.1.1.1.3" xref="A1.E15.m1.1.1.1.1.1.1.3.cmml">y</mi></mrow><mo id="A1.E15.m1.1.1.1.1.1.3" stretchy="false" xref="A1.E15.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="A1.E15.m1.1.1.1.3" xref="A1.E15.m1.1.1.1.3.cmml">2</mn></msup><mrow id="A1.E15.m1.1.1.3" xref="A1.E15.m1.1.1.3.cmml"><mn id="A1.E15.m1.1.1.3.2" xref="A1.E15.m1.1.1.3.2.cmml">2</mn><mo id="A1.E15.m1.1.1.3.1" xref="A1.E15.m1.1.1.3.1.cmml">⁢</mo><msup id="A1.E15.m1.1.1.3.3" xref="A1.E15.m1.1.1.3.3.cmml"><mi id="A1.E15.m1.1.1.3.3.2" xref="A1.E15.m1.1.1.3.3.2.cmml">l</mi><mn id="A1.E15.m1.1.1.3.3.3" xref="A1.E15.m1.1.1.3.3.3.cmml">2</mn></msup></mrow></mfrac></mrow><mo id="A1.E15.m1.5.5.1.1.1.3" xref="A1.E15.m1.5.5.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E15.m1.5b"><apply id="A1.E15.m1.5.5.cmml" xref="A1.E15.m1.5.5"><eq id="A1.E15.m1.5.5.2.cmml" xref="A1.E15.m1.5.5.2"></eq><apply id="A1.E15.m1.5.5.3.cmml" xref="A1.E15.m1.5.5.3"><times id="A1.E15.m1.5.5.3.1.cmml" xref="A1.E15.m1.5.5.3.1"></times><ci id="A1.E15.m1.5.5.3.2.cmml" xref="A1.E15.m1.5.5.3.2">𝐾</ci><interval closure="open" id="A1.E15.m1.5.5.3.3.1.cmml" xref="A1.E15.m1.5.5.3.3.2"><ci id="A1.E15.m1.2.2.cmml" xref="A1.E15.m1.2.2">𝑥</ci><ci id="A1.E15.m1.3.3.cmml" xref="A1.E15.m1.3.3">𝑦</ci></interval></apply><apply id="A1.E15.m1.5.5.1.2.cmml" xref="A1.E15.m1.5.5.1.1"><exp id="A1.E15.m1.4.4.cmml" xref="A1.E15.m1.4.4"></exp><apply id="A1.E15.m1.5.5.1.1.1.1.cmml" xref="A1.E15.m1.5.5.1.1.1.1"><minus id="A1.E15.m1.5.5.1.1.1.1.1.cmml" xref="A1.E15.m1.5.5.1.1.1.1"></minus><apply id="A1.E15.m1.1.1.cmml" xref="A1.E15.m1.1.1"><divide id="A1.E15.m1.1.1.2.cmml" xref="A1.E15.m1.1.1"></divide><apply id="A1.E15.m1.1.1.1.cmml" xref="A1.E15.m1.1.1.1"><csymbol cd="ambiguous" id="A1.E15.m1.1.1.1.2.cmml" xref="A1.E15.m1.1.1.1">superscript</csymbol><apply id="A1.E15.m1.1.1.1.1.1.1.cmml" xref="A1.E15.m1.1.1.1.1.1"><minus id="A1.E15.m1.1.1.1.1.1.1.1.cmml" xref="A1.E15.m1.1.1.1.1.1.1.1"></minus><ci id="A1.E15.m1.1.1.1.1.1.1.2.cmml" xref="A1.E15.m1.1.1.1.1.1.1.2">𝑥</ci><ci id="A1.E15.m1.1.1.1.1.1.1.3.cmml" xref="A1.E15.m1.1.1.1.1.1.1.3">𝑦</ci></apply><cn id="A1.E15.m1.1.1.1.3.cmml" type="integer" xref="A1.E15.m1.1.1.1.3">2</cn></apply><apply id="A1.E15.m1.1.1.3.cmml" xref="A1.E15.m1.1.1.3"><times id="A1.E15.m1.1.1.3.1.cmml" xref="A1.E15.m1.1.1.3.1"></times><cn id="A1.E15.m1.1.1.3.2.cmml" type="integer" xref="A1.E15.m1.1.1.3.2">2</cn><apply id="A1.E15.m1.1.1.3.3.cmml" xref="A1.E15.m1.1.1.3.3"><csymbol cd="ambiguous" id="A1.E15.m1.1.1.3.3.1.cmml" xref="A1.E15.m1.1.1.3.3">superscript</csymbol><ci id="A1.E15.m1.1.1.3.3.2.cmml" xref="A1.E15.m1.1.1.3.3.2">𝑙</ci><cn id="A1.E15.m1.1.1.3.3.3.cmml" type="integer" xref="A1.E15.m1.1.1.3.3.3">2</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E15.m1.5c">K(x,y)=\exp\left(-\frac{(x-y)^{2}}{2l^{2}}\right)</annotation><annotation encoding="application/x-llamapun" id="A1.E15.m1.5d">italic_K ( italic_x , italic_y ) = roman_exp ( - divide start_ARG ( italic_x - italic_y ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG 2 italic_l start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS7.SSS0.Px1.p3">
<p class="ltx_p" id="A1.SS7.SSS0.Px1.p3.3">where <math alttext="x" class="ltx_Math" display="inline" id="A1.SS7.SSS0.Px1.p3.1.m1.1"><semantics id="A1.SS7.SSS0.Px1.p3.1.m1.1a"><mi id="A1.SS7.SSS0.Px1.p3.1.m1.1.1" xref="A1.SS7.SSS0.Px1.p3.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="A1.SS7.SSS0.Px1.p3.1.m1.1b"><ci id="A1.SS7.SSS0.Px1.p3.1.m1.1.1.cmml" xref="A1.SS7.SSS0.Px1.p3.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS7.SSS0.Px1.p3.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="A1.SS7.SSS0.Px1.p3.1.m1.1d">italic_x</annotation></semantics></math> and <math alttext="y" class="ltx_Math" display="inline" id="A1.SS7.SSS0.Px1.p3.2.m2.1"><semantics id="A1.SS7.SSS0.Px1.p3.2.m2.1a"><mi id="A1.SS7.SSS0.Px1.p3.2.m2.1.1" xref="A1.SS7.SSS0.Px1.p3.2.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="A1.SS7.SSS0.Px1.p3.2.m2.1b"><ci id="A1.SS7.SSS0.Px1.p3.2.m2.1.1.cmml" xref="A1.SS7.SSS0.Px1.p3.2.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS7.SSS0.Px1.p3.2.m2.1c">y</annotation><annotation encoding="application/x-llamapun" id="A1.SS7.SSS0.Px1.p3.2.m2.1d">italic_y</annotation></semantics></math> are points in the domain, and <math alttext="l" class="ltx_Math" display="inline" id="A1.SS7.SSS0.Px1.p3.3.m3.1"><semantics id="A1.SS7.SSS0.Px1.p3.3.m3.1a"><mi id="A1.SS7.SSS0.Px1.p3.3.m3.1.1" xref="A1.SS7.SSS0.Px1.p3.3.m3.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="A1.SS7.SSS0.Px1.p3.3.m3.1b"><ci id="A1.SS7.SSS0.Px1.p3.3.m3.1.1.cmml" xref="A1.SS7.SSS0.Px1.p3.3.m3.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS7.SSS0.Px1.p3.3.m3.1c">l</annotation><annotation encoding="application/x-llamapun" id="A1.SS7.SSS0.Px1.p3.3.m3.1d">italic_l</annotation></semantics></math> is the correlation length, a crucial hyperparameter in our generation process.</p>
</div>
</section>
<section class="ltx_paragraph" id="A1.SS7.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Correlation Length (<math alttext="l" class="ltx_Math" display="inline" id="A1.SS7.SSS0.Px2.1.m1.1"><semantics id="A1.SS7.SSS0.Px2.1.m1.1b"><mi id="A1.SS7.SSS0.Px2.1.m1.1.1" xref="A1.SS7.SSS0.Px2.1.m1.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="A1.SS7.SSS0.Px2.1.m1.1c"><ci id="A1.SS7.SSS0.Px2.1.m1.1.1.cmml" xref="A1.SS7.SSS0.Px2.1.m1.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS7.SSS0.Px2.1.m1.1d">l</annotation><annotation encoding="application/x-llamapun" id="A1.SS7.SSS0.Px2.1.m1.1e">italic_l</annotation></semantics></math>):</h5>
<div class="ltx_para ltx_noindent" id="A1.SS7.SSS0.Px2.p1">
<p class="ltx_p" id="A1.SS7.SSS0.Px2.p1.1">The parameter <math alttext="l" class="ltx_Math" display="inline" id="A1.SS7.SSS0.Px2.p1.1.m1.1"><semantics id="A1.SS7.SSS0.Px2.p1.1.m1.1a"><mi id="A1.SS7.SSS0.Px2.p1.1.m1.1.1" xref="A1.SS7.SSS0.Px2.p1.1.m1.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="A1.SS7.SSS0.Px2.p1.1.m1.1b"><ci id="A1.SS7.SSS0.Px2.p1.1.m1.1.1.cmml" xref="A1.SS7.SSS0.Px2.p1.1.m1.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS7.SSS0.Px2.p1.1.m1.1c">l</annotation><annotation encoding="application/x-llamapun" id="A1.SS7.SSS0.Px2.p1.1.m1.1d">italic_l</annotation></semantics></math> controls the smoothness and regularity of the generated PDFs. Specifically:</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS7.SSS0.Px2.p2">
<ul class="ltx_itemize" id="A1.I2">
<li class="ltx_item" id="A1.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I2.i1.p1">
<p class="ltx_p" id="A1.I2.i1.p1.1">Large values of <math alttext="l" class="ltx_Math" display="inline" id="A1.I2.i1.p1.1.m1.1"><semantics id="A1.I2.i1.p1.1.m1.1a"><mi id="A1.I2.i1.p1.1.m1.1.1" xref="A1.I2.i1.p1.1.m1.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="A1.I2.i1.p1.1.m1.1b"><ci id="A1.I2.i1.p1.1.m1.1.1.cmml" xref="A1.I2.i1.p1.1.m1.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.I2.i1.p1.1.m1.1c">l</annotation><annotation encoding="application/x-llamapun" id="A1.I2.i1.p1.1.m1.1d">italic_l</annotation></semantics></math> produce more regular distributions with lower average curvature. These PDFs tend to have smoother features with lower curvatures.</p>
</div>
</li>
<li class="ltx_item" id="A1.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="A1.I2.i2.p1">
<p class="ltx_p" id="A1.I2.i2.p1.1">Small values of <math alttext="l" class="ltx_Math" display="inline" id="A1.I2.i2.p1.1.m1.1"><semantics id="A1.I2.i2.p1.1.m1.1a"><mi id="A1.I2.i2.p1.1.m1.1.1" xref="A1.I2.i2.p1.1.m1.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="A1.I2.i2.p1.1.m1.1b"><ci id="A1.I2.i2.p1.1.m1.1.1.cmml" xref="A1.I2.i2.p1.1.m1.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.I2.i2.p1.1.m1.1c">l</annotation><annotation encoding="application/x-llamapun" id="A1.I2.i2.p1.1.m1.1d">italic_l</annotation></semantics></math> result in more irregular distributions with higher average curvature. These PDFs can have sharper features with higher curvatures.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS7.SSS0.Px2.p3">
<p class="ltx_p" id="A1.SS7.SSS0.Px2.p3.1">As <math alttext="l" class="ltx_Math" display="inline" id="A1.SS7.SSS0.Px2.p3.1.m1.1"><semantics id="A1.SS7.SSS0.Px2.p3.1.m1.1a"><mi id="A1.SS7.SSS0.Px2.p3.1.m1.1.1" xref="A1.SS7.SSS0.Px2.p3.1.m1.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="A1.SS7.SSS0.Px2.p3.1.m1.1b"><ci id="A1.SS7.SSS0.Px2.p3.1.m1.1.1.cmml" xref="A1.SS7.SSS0.Px2.p3.1.m1.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS7.SSS0.Px2.p3.1.m1.1c">l</annotation><annotation encoding="application/x-llamapun" id="A1.SS7.SSS0.Px2.p3.1.m1.1d">italic_l</annotation></semantics></math> increases, the average curvature decreases, indicating a smoother, less curved function.</p>
</div>
</section>
<section class="ltx_paragraph" id="A1.SS7.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Generation Process:</h5>
<div class="ltx_para ltx_noindent" id="A1.SS7.SSS0.Px3.p1">
<p class="ltx_p" id="A1.SS7.SSS0.Px3.p1.1">The random PDF generation involves the following steps:</p>
<ol class="ltx_enumerate" id="A1.I3">
<li class="ltx_item" id="A1.I3.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="A1.I3.i1.p1">
<p class="ltx_p" id="A1.I3.i1.p1.1">Generate the covariance matrix using the squared exponential kernel.</p>
</div>
</li>
<li class="ltx_item" id="A1.I3.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="A1.I3.i2.p1">
<p class="ltx_p" id="A1.I3.i2.p1.1">Perform Cholesky decomposition on the covariance matrix.</p>
</div>
</li>
<li class="ltx_item" id="A1.I3.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="A1.I3.i3.p1">
<p class="ltx_p" id="A1.I3.i3.p1.1">Sample from the Gaussian process using the decomposed matrix.</p>
</div>
</li>
<li class="ltx_item" id="A1.I3.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">4.</span>
<div class="ltx_para" id="A1.I3.i4.p1">
<p class="ltx_p" id="A1.I3.i4.p1.1">Apply boundary conditions to ensure the PDF goes to zero at the domain edges.</p>
</div>
</li>
<li class="ltx_item" id="A1.I3.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">5.</span>
<div class="ltx_para ltx_noindent" id="A1.I3.i5.p1">
<p class="ltx_p" id="A1.I3.i5.p1.1">Normalize the function to ensure it integrates to 1, making it a valid PDF.</p>
</div>
</li>
</ol>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS7.SSS0.Px3.p2">
<p class="ltx_p" id="A1.SS7.SSS0.Px3.p2.1">This method allows us to generate a wide range of PDFs with varying degrees of complexity and smoothness, providing a robust test set for our density estimation algorithms. By adjusting the correlation length <math alttext="l" class="ltx_Math" display="inline" id="A1.SS7.SSS0.Px3.p2.1.m1.1"><semantics id="A1.SS7.SSS0.Px3.p2.1.m1.1a"><mi id="A1.SS7.SSS0.Px3.p2.1.m1.1.1" xref="A1.SS7.SSS0.Px3.p2.1.m1.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="A1.SS7.SSS0.Px3.p2.1.m1.1b"><ci id="A1.SS7.SSS0.Px3.p2.1.m1.1.1.cmml" xref="A1.SS7.SSS0.Px3.p2.1.m1.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS7.SSS0.Px3.p2.1.m1.1c">l</annotation><annotation encoding="application/x-llamapun" id="A1.SS7.SSS0.Px3.p2.1.m1.1d">italic_l</annotation></semantics></math>, we can systematically explore how different estimation methods perform on targets of varying regularity and curvature.
Given a randomly generated PDF, we can calculate its average curvature using two methods: numerical differentiation and analytical derivation.
Numerically, we can approximate the second derivative using finite differences and then compute the average curvature as:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E16">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="R_{numeric}(p^{\prime\prime})\approx\frac{1}{N}\sum_{i=1}^{N}\left(\frac{p(x_{%
i+1})-2p(x_{i})+p(x_{i-1})}{(\Delta x)^{2}}\right)^{2}" class="ltx_Math" display="block" id="A1.E16.m1.5"><semantics id="A1.E16.m1.5a"><mrow id="A1.E16.m1.5.5" xref="A1.E16.m1.5.5.cmml"><mrow id="A1.E16.m1.5.5.1" xref="A1.E16.m1.5.5.1.cmml"><msub id="A1.E16.m1.5.5.1.3" xref="A1.E16.m1.5.5.1.3.cmml"><mi id="A1.E16.m1.5.5.1.3.2" xref="A1.E16.m1.5.5.1.3.2.cmml">R</mi><mrow id="A1.E16.m1.5.5.1.3.3" xref="A1.E16.m1.5.5.1.3.3.cmml"><mi id="A1.E16.m1.5.5.1.3.3.2" xref="A1.E16.m1.5.5.1.3.3.2.cmml">n</mi><mo id="A1.E16.m1.5.5.1.3.3.1" xref="A1.E16.m1.5.5.1.3.3.1.cmml">⁢</mo><mi id="A1.E16.m1.5.5.1.3.3.3" xref="A1.E16.m1.5.5.1.3.3.3.cmml">u</mi><mo id="A1.E16.m1.5.5.1.3.3.1a" xref="A1.E16.m1.5.5.1.3.3.1.cmml">⁢</mo><mi id="A1.E16.m1.5.5.1.3.3.4" xref="A1.E16.m1.5.5.1.3.3.4.cmml">m</mi><mo id="A1.E16.m1.5.5.1.3.3.1b" xref="A1.E16.m1.5.5.1.3.3.1.cmml">⁢</mo><mi id="A1.E16.m1.5.5.1.3.3.5" xref="A1.E16.m1.5.5.1.3.3.5.cmml">e</mi><mo id="A1.E16.m1.5.5.1.3.3.1c" xref="A1.E16.m1.5.5.1.3.3.1.cmml">⁢</mo><mi id="A1.E16.m1.5.5.1.3.3.6" xref="A1.E16.m1.5.5.1.3.3.6.cmml">r</mi><mo id="A1.E16.m1.5.5.1.3.3.1d" xref="A1.E16.m1.5.5.1.3.3.1.cmml">⁢</mo><mi id="A1.E16.m1.5.5.1.3.3.7" xref="A1.E16.m1.5.5.1.3.3.7.cmml">i</mi><mo id="A1.E16.m1.5.5.1.3.3.1e" xref="A1.E16.m1.5.5.1.3.3.1.cmml">⁢</mo><mi id="A1.E16.m1.5.5.1.3.3.8" xref="A1.E16.m1.5.5.1.3.3.8.cmml">c</mi></mrow></msub><mo id="A1.E16.m1.5.5.1.2" xref="A1.E16.m1.5.5.1.2.cmml">⁢</mo><mrow id="A1.E16.m1.5.5.1.1.1" xref="A1.E16.m1.5.5.1.1.1.1.cmml"><mo id="A1.E16.m1.5.5.1.1.1.2" stretchy="false" xref="A1.E16.m1.5.5.1.1.1.1.cmml">(</mo><msup id="A1.E16.m1.5.5.1.1.1.1" xref="A1.E16.m1.5.5.1.1.1.1.cmml"><mi id="A1.E16.m1.5.5.1.1.1.1.2" xref="A1.E16.m1.5.5.1.1.1.1.2.cmml">p</mi><mo id="A1.E16.m1.5.5.1.1.1.1.3" xref="A1.E16.m1.5.5.1.1.1.1.3.cmml">′′</mo></msup><mo id="A1.E16.m1.5.5.1.1.1.3" stretchy="false" xref="A1.E16.m1.5.5.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E16.m1.5.5.2" xref="A1.E16.m1.5.5.2.cmml">≈</mo><mrow id="A1.E16.m1.5.5.3" xref="A1.E16.m1.5.5.3.cmml"><mfrac id="A1.E16.m1.5.5.3.2" xref="A1.E16.m1.5.5.3.2.cmml"><mn id="A1.E16.m1.5.5.3.2.2" xref="A1.E16.m1.5.5.3.2.2.cmml">1</mn><mi id="A1.E16.m1.5.5.3.2.3" xref="A1.E16.m1.5.5.3.2.3.cmml">N</mi></mfrac><mo id="A1.E16.m1.5.5.3.1" xref="A1.E16.m1.5.5.3.1.cmml">⁢</mo><mrow id="A1.E16.m1.5.5.3.3" xref="A1.E16.m1.5.5.3.3.cmml"><munderover id="A1.E16.m1.5.5.3.3.1" xref="A1.E16.m1.5.5.3.3.1.cmml"><mo id="A1.E16.m1.5.5.3.3.1.2.2" movablelimits="false" rspace="0em" xref="A1.E16.m1.5.5.3.3.1.2.2.cmml">∑</mo><mrow id="A1.E16.m1.5.5.3.3.1.2.3" xref="A1.E16.m1.5.5.3.3.1.2.3.cmml"><mi id="A1.E16.m1.5.5.3.3.1.2.3.2" xref="A1.E16.m1.5.5.3.3.1.2.3.2.cmml">i</mi><mo id="A1.E16.m1.5.5.3.3.1.2.3.1" xref="A1.E16.m1.5.5.3.3.1.2.3.1.cmml">=</mo><mn id="A1.E16.m1.5.5.3.3.1.2.3.3" xref="A1.E16.m1.5.5.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="A1.E16.m1.5.5.3.3.1.3" xref="A1.E16.m1.5.5.3.3.1.3.cmml">N</mi></munderover><msup id="A1.E16.m1.5.5.3.3.2" xref="A1.E16.m1.5.5.3.3.2.cmml"><mrow id="A1.E16.m1.5.5.3.3.2.2.2" xref="A1.E16.m1.4.4.cmml"><mo id="A1.E16.m1.5.5.3.3.2.2.2.1" xref="A1.E16.m1.4.4.cmml">(</mo><mfrac id="A1.E16.m1.4.4" xref="A1.E16.m1.4.4.cmml"><mrow id="A1.E16.m1.3.3.3" xref="A1.E16.m1.3.3.3.cmml"><mrow id="A1.E16.m1.2.2.2.2" xref="A1.E16.m1.2.2.2.2.cmml"><mrow id="A1.E16.m1.1.1.1.1.1" xref="A1.E16.m1.1.1.1.1.1.cmml"><mi id="A1.E16.m1.1.1.1.1.1.3" xref="A1.E16.m1.1.1.1.1.1.3.cmml">p</mi><mo id="A1.E16.m1.1.1.1.1.1.2" xref="A1.E16.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E16.m1.1.1.1.1.1.1.1" xref="A1.E16.m1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E16.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E16.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A1.E16.m1.1.1.1.1.1.1.1.1" xref="A1.E16.m1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E16.m1.1.1.1.1.1.1.1.1.2" xref="A1.E16.m1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mrow id="A1.E16.m1.1.1.1.1.1.1.1.1.3" xref="A1.E16.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E16.m1.1.1.1.1.1.1.1.1.3.2" xref="A1.E16.m1.1.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="A1.E16.m1.1.1.1.1.1.1.1.1.3.1" xref="A1.E16.m1.1.1.1.1.1.1.1.1.3.1.cmml">+</mo><mn id="A1.E16.m1.1.1.1.1.1.1.1.1.3.3" xref="A1.E16.m1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="A1.E16.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E16.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E16.m1.2.2.2.2.3" xref="A1.E16.m1.2.2.2.2.3.cmml">−</mo><mrow id="A1.E16.m1.2.2.2.2.2" xref="A1.E16.m1.2.2.2.2.2.cmml"><mn id="A1.E16.m1.2.2.2.2.2.3" xref="A1.E16.m1.2.2.2.2.2.3.cmml">2</mn><mo id="A1.E16.m1.2.2.2.2.2.2" xref="A1.E16.m1.2.2.2.2.2.2.cmml">⁢</mo><mi id="A1.E16.m1.2.2.2.2.2.4" xref="A1.E16.m1.2.2.2.2.2.4.cmml">p</mi><mo id="A1.E16.m1.2.2.2.2.2.2a" xref="A1.E16.m1.2.2.2.2.2.2.cmml">⁢</mo><mrow id="A1.E16.m1.2.2.2.2.2.1.1" xref="A1.E16.m1.2.2.2.2.2.1.1.1.cmml"><mo id="A1.E16.m1.2.2.2.2.2.1.1.2" stretchy="false" xref="A1.E16.m1.2.2.2.2.2.1.1.1.cmml">(</mo><msub id="A1.E16.m1.2.2.2.2.2.1.1.1" xref="A1.E16.m1.2.2.2.2.2.1.1.1.cmml"><mi id="A1.E16.m1.2.2.2.2.2.1.1.1.2" xref="A1.E16.m1.2.2.2.2.2.1.1.1.2.cmml">x</mi><mi id="A1.E16.m1.2.2.2.2.2.1.1.1.3" xref="A1.E16.m1.2.2.2.2.2.1.1.1.3.cmml">i</mi></msub><mo id="A1.E16.m1.2.2.2.2.2.1.1.3" stretchy="false" xref="A1.E16.m1.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E16.m1.3.3.3.4" xref="A1.E16.m1.3.3.3.4.cmml">+</mo><mrow id="A1.E16.m1.3.3.3.3" xref="A1.E16.m1.3.3.3.3.cmml"><mi id="A1.E16.m1.3.3.3.3.3" xref="A1.E16.m1.3.3.3.3.3.cmml">p</mi><mo id="A1.E16.m1.3.3.3.3.2" xref="A1.E16.m1.3.3.3.3.2.cmml">⁢</mo><mrow id="A1.E16.m1.3.3.3.3.1.1" xref="A1.E16.m1.3.3.3.3.1.1.1.cmml"><mo id="A1.E16.m1.3.3.3.3.1.1.2" stretchy="false" xref="A1.E16.m1.3.3.3.3.1.1.1.cmml">(</mo><msub id="A1.E16.m1.3.3.3.3.1.1.1" xref="A1.E16.m1.3.3.3.3.1.1.1.cmml"><mi id="A1.E16.m1.3.3.3.3.1.1.1.2" xref="A1.E16.m1.3.3.3.3.1.1.1.2.cmml">x</mi><mrow id="A1.E16.m1.3.3.3.3.1.1.1.3" xref="A1.E16.m1.3.3.3.3.1.1.1.3.cmml"><mi id="A1.E16.m1.3.3.3.3.1.1.1.3.2" xref="A1.E16.m1.3.3.3.3.1.1.1.3.2.cmml">i</mi><mo id="A1.E16.m1.3.3.3.3.1.1.1.3.1" xref="A1.E16.m1.3.3.3.3.1.1.1.3.1.cmml">−</mo><mn id="A1.E16.m1.3.3.3.3.1.1.1.3.3" xref="A1.E16.m1.3.3.3.3.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="A1.E16.m1.3.3.3.3.1.1.3" stretchy="false" xref="A1.E16.m1.3.3.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><msup id="A1.E16.m1.4.4.4" xref="A1.E16.m1.4.4.4.cmml"><mrow id="A1.E16.m1.4.4.4.1.1" xref="A1.E16.m1.4.4.4.1.1.1.cmml"><mo id="A1.E16.m1.4.4.4.1.1.2" stretchy="false" xref="A1.E16.m1.4.4.4.1.1.1.cmml">(</mo><mrow id="A1.E16.m1.4.4.4.1.1.1" xref="A1.E16.m1.4.4.4.1.1.1.cmml"><mi id="A1.E16.m1.4.4.4.1.1.1.2" mathvariant="normal" xref="A1.E16.m1.4.4.4.1.1.1.2.cmml">Δ</mi><mo id="A1.E16.m1.4.4.4.1.1.1.1" xref="A1.E16.m1.4.4.4.1.1.1.1.cmml">⁢</mo><mi id="A1.E16.m1.4.4.4.1.1.1.3" xref="A1.E16.m1.4.4.4.1.1.1.3.cmml">x</mi></mrow><mo id="A1.E16.m1.4.4.4.1.1.3" stretchy="false" xref="A1.E16.m1.4.4.4.1.1.1.cmml">)</mo></mrow><mn id="A1.E16.m1.4.4.4.3" xref="A1.E16.m1.4.4.4.3.cmml">2</mn></msup></mfrac><mo id="A1.E16.m1.5.5.3.3.2.2.2.2" xref="A1.E16.m1.4.4.cmml">)</mo></mrow><mn id="A1.E16.m1.5.5.3.3.2.3" xref="A1.E16.m1.5.5.3.3.2.3.cmml">2</mn></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E16.m1.5b"><apply id="A1.E16.m1.5.5.cmml" xref="A1.E16.m1.5.5"><approx id="A1.E16.m1.5.5.2.cmml" xref="A1.E16.m1.5.5.2"></approx><apply id="A1.E16.m1.5.5.1.cmml" xref="A1.E16.m1.5.5.1"><times id="A1.E16.m1.5.5.1.2.cmml" xref="A1.E16.m1.5.5.1.2"></times><apply id="A1.E16.m1.5.5.1.3.cmml" xref="A1.E16.m1.5.5.1.3"><csymbol cd="ambiguous" id="A1.E16.m1.5.5.1.3.1.cmml" xref="A1.E16.m1.5.5.1.3">subscript</csymbol><ci id="A1.E16.m1.5.5.1.3.2.cmml" xref="A1.E16.m1.5.5.1.3.2">𝑅</ci><apply id="A1.E16.m1.5.5.1.3.3.cmml" xref="A1.E16.m1.5.5.1.3.3"><times id="A1.E16.m1.5.5.1.3.3.1.cmml" xref="A1.E16.m1.5.5.1.3.3.1"></times><ci id="A1.E16.m1.5.5.1.3.3.2.cmml" xref="A1.E16.m1.5.5.1.3.3.2">𝑛</ci><ci id="A1.E16.m1.5.5.1.3.3.3.cmml" xref="A1.E16.m1.5.5.1.3.3.3">𝑢</ci><ci id="A1.E16.m1.5.5.1.3.3.4.cmml" xref="A1.E16.m1.5.5.1.3.3.4">𝑚</ci><ci id="A1.E16.m1.5.5.1.3.3.5.cmml" xref="A1.E16.m1.5.5.1.3.3.5">𝑒</ci><ci id="A1.E16.m1.5.5.1.3.3.6.cmml" xref="A1.E16.m1.5.5.1.3.3.6">𝑟</ci><ci id="A1.E16.m1.5.5.1.3.3.7.cmml" xref="A1.E16.m1.5.5.1.3.3.7">𝑖</ci><ci id="A1.E16.m1.5.5.1.3.3.8.cmml" xref="A1.E16.m1.5.5.1.3.3.8">𝑐</ci></apply></apply><apply id="A1.E16.m1.5.5.1.1.1.1.cmml" xref="A1.E16.m1.5.5.1.1.1"><csymbol cd="ambiguous" id="A1.E16.m1.5.5.1.1.1.1.1.cmml" xref="A1.E16.m1.5.5.1.1.1">superscript</csymbol><ci id="A1.E16.m1.5.5.1.1.1.1.2.cmml" xref="A1.E16.m1.5.5.1.1.1.1.2">𝑝</ci><ci id="A1.E16.m1.5.5.1.1.1.1.3.cmml" xref="A1.E16.m1.5.5.1.1.1.1.3">′′</ci></apply></apply><apply id="A1.E16.m1.5.5.3.cmml" xref="A1.E16.m1.5.5.3"><times id="A1.E16.m1.5.5.3.1.cmml" xref="A1.E16.m1.5.5.3.1"></times><apply id="A1.E16.m1.5.5.3.2.cmml" xref="A1.E16.m1.5.5.3.2"><divide id="A1.E16.m1.5.5.3.2.1.cmml" xref="A1.E16.m1.5.5.3.2"></divide><cn id="A1.E16.m1.5.5.3.2.2.cmml" type="integer" xref="A1.E16.m1.5.5.3.2.2">1</cn><ci id="A1.E16.m1.5.5.3.2.3.cmml" xref="A1.E16.m1.5.5.3.2.3">𝑁</ci></apply><apply id="A1.E16.m1.5.5.3.3.cmml" xref="A1.E16.m1.5.5.3.3"><apply id="A1.E16.m1.5.5.3.3.1.cmml" xref="A1.E16.m1.5.5.3.3.1"><csymbol cd="ambiguous" id="A1.E16.m1.5.5.3.3.1.1.cmml" xref="A1.E16.m1.5.5.3.3.1">superscript</csymbol><apply id="A1.E16.m1.5.5.3.3.1.2.cmml" xref="A1.E16.m1.5.5.3.3.1"><csymbol cd="ambiguous" id="A1.E16.m1.5.5.3.3.1.2.1.cmml" xref="A1.E16.m1.5.5.3.3.1">subscript</csymbol><sum id="A1.E16.m1.5.5.3.3.1.2.2.cmml" xref="A1.E16.m1.5.5.3.3.1.2.2"></sum><apply id="A1.E16.m1.5.5.3.3.1.2.3.cmml" xref="A1.E16.m1.5.5.3.3.1.2.3"><eq id="A1.E16.m1.5.5.3.3.1.2.3.1.cmml" xref="A1.E16.m1.5.5.3.3.1.2.3.1"></eq><ci id="A1.E16.m1.5.5.3.3.1.2.3.2.cmml" xref="A1.E16.m1.5.5.3.3.1.2.3.2">𝑖</ci><cn id="A1.E16.m1.5.5.3.3.1.2.3.3.cmml" type="integer" xref="A1.E16.m1.5.5.3.3.1.2.3.3">1</cn></apply></apply><ci id="A1.E16.m1.5.5.3.3.1.3.cmml" xref="A1.E16.m1.5.5.3.3.1.3">𝑁</ci></apply><apply id="A1.E16.m1.5.5.3.3.2.cmml" xref="A1.E16.m1.5.5.3.3.2"><csymbol cd="ambiguous" id="A1.E16.m1.5.5.3.3.2.1.cmml" xref="A1.E16.m1.5.5.3.3.2">superscript</csymbol><apply id="A1.E16.m1.4.4.cmml" xref="A1.E16.m1.5.5.3.3.2.2.2"><divide id="A1.E16.m1.4.4.5.cmml" xref="A1.E16.m1.5.5.3.3.2.2.2"></divide><apply id="A1.E16.m1.3.3.3.cmml" xref="A1.E16.m1.3.3.3"><plus id="A1.E16.m1.3.3.3.4.cmml" xref="A1.E16.m1.3.3.3.4"></plus><apply id="A1.E16.m1.2.2.2.2.cmml" xref="A1.E16.m1.2.2.2.2"><minus id="A1.E16.m1.2.2.2.2.3.cmml" xref="A1.E16.m1.2.2.2.2.3"></minus><apply id="A1.E16.m1.1.1.1.1.1.cmml" xref="A1.E16.m1.1.1.1.1.1"><times id="A1.E16.m1.1.1.1.1.1.2.cmml" xref="A1.E16.m1.1.1.1.1.1.2"></times><ci id="A1.E16.m1.1.1.1.1.1.3.cmml" xref="A1.E16.m1.1.1.1.1.1.3">𝑝</ci><apply id="A1.E16.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E16.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E16.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1.1.2">𝑥</ci><apply id="A1.E16.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1.1.3"><plus id="A1.E16.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1.1.3.1"></plus><ci id="A1.E16.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1.1.3.2">𝑖</ci><cn id="A1.E16.m1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="A1.E16.m1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply><apply id="A1.E16.m1.2.2.2.2.2.cmml" xref="A1.E16.m1.2.2.2.2.2"><times id="A1.E16.m1.2.2.2.2.2.2.cmml" xref="A1.E16.m1.2.2.2.2.2.2"></times><cn id="A1.E16.m1.2.2.2.2.2.3.cmml" type="integer" xref="A1.E16.m1.2.2.2.2.2.3">2</cn><ci id="A1.E16.m1.2.2.2.2.2.4.cmml" xref="A1.E16.m1.2.2.2.2.2.4">𝑝</ci><apply id="A1.E16.m1.2.2.2.2.2.1.1.1.cmml" xref="A1.E16.m1.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="A1.E16.m1.2.2.2.2.2.1.1.1.1.cmml" xref="A1.E16.m1.2.2.2.2.2.1.1">subscript</csymbol><ci id="A1.E16.m1.2.2.2.2.2.1.1.1.2.cmml" xref="A1.E16.m1.2.2.2.2.2.1.1.1.2">𝑥</ci><ci id="A1.E16.m1.2.2.2.2.2.1.1.1.3.cmml" xref="A1.E16.m1.2.2.2.2.2.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="A1.E16.m1.3.3.3.3.cmml" xref="A1.E16.m1.3.3.3.3"><times id="A1.E16.m1.3.3.3.3.2.cmml" xref="A1.E16.m1.3.3.3.3.2"></times><ci id="A1.E16.m1.3.3.3.3.3.cmml" xref="A1.E16.m1.3.3.3.3.3">𝑝</ci><apply id="A1.E16.m1.3.3.3.3.1.1.1.cmml" xref="A1.E16.m1.3.3.3.3.1.1"><csymbol cd="ambiguous" id="A1.E16.m1.3.3.3.3.1.1.1.1.cmml" xref="A1.E16.m1.3.3.3.3.1.1">subscript</csymbol><ci id="A1.E16.m1.3.3.3.3.1.1.1.2.cmml" xref="A1.E16.m1.3.3.3.3.1.1.1.2">𝑥</ci><apply id="A1.E16.m1.3.3.3.3.1.1.1.3.cmml" xref="A1.E16.m1.3.3.3.3.1.1.1.3"><minus id="A1.E16.m1.3.3.3.3.1.1.1.3.1.cmml" xref="A1.E16.m1.3.3.3.3.1.1.1.3.1"></minus><ci id="A1.E16.m1.3.3.3.3.1.1.1.3.2.cmml" xref="A1.E16.m1.3.3.3.3.1.1.1.3.2">𝑖</ci><cn id="A1.E16.m1.3.3.3.3.1.1.1.3.3.cmml" type="integer" xref="A1.E16.m1.3.3.3.3.1.1.1.3.3">1</cn></apply></apply></apply></apply><apply id="A1.E16.m1.4.4.4.cmml" xref="A1.E16.m1.4.4.4"><csymbol cd="ambiguous" id="A1.E16.m1.4.4.4.2.cmml" xref="A1.E16.m1.4.4.4">superscript</csymbol><apply id="A1.E16.m1.4.4.4.1.1.1.cmml" xref="A1.E16.m1.4.4.4.1.1"><times id="A1.E16.m1.4.4.4.1.1.1.1.cmml" xref="A1.E16.m1.4.4.4.1.1.1.1"></times><ci id="A1.E16.m1.4.4.4.1.1.1.2.cmml" xref="A1.E16.m1.4.4.4.1.1.1.2">Δ</ci><ci id="A1.E16.m1.4.4.4.1.1.1.3.cmml" xref="A1.E16.m1.4.4.4.1.1.1.3">𝑥</ci></apply><cn id="A1.E16.m1.4.4.4.3.cmml" type="integer" xref="A1.E16.m1.4.4.4.3">2</cn></apply></apply><cn id="A1.E16.m1.5.5.3.3.2.3.cmml" type="integer" xref="A1.E16.m1.5.5.3.3.2.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E16.m1.5c">R_{numeric}(p^{\prime\prime})\approx\frac{1}{N}\sum_{i=1}^{N}\left(\frac{p(x_{%
i+1})-2p(x_{i})+p(x_{i-1})}{(\Delta x)^{2}}\right)^{2}</annotation><annotation encoding="application/x-llamapun" id="A1.E16.m1.5d">italic_R start_POSTSUBSCRIPT italic_n italic_u italic_m italic_e italic_r italic_i italic_c end_POSTSUBSCRIPT ( italic_p start_POSTSUPERSCRIPT ′ ′ end_POSTSUPERSCRIPT ) ≈ divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ( divide start_ARG italic_p ( italic_x start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT ) - 2 italic_p ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) + italic_p ( italic_x start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT ) end_ARG start_ARG ( roman_Δ italic_x ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS7.SSS0.Px3.p2.4">where <math alttext="N" class="ltx_Math" display="inline" id="A1.SS7.SSS0.Px3.p2.2.m1.1"><semantics id="A1.SS7.SSS0.Px3.p2.2.m1.1a"><mi id="A1.SS7.SSS0.Px3.p2.2.m1.1.1" xref="A1.SS7.SSS0.Px3.p2.2.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="A1.SS7.SSS0.Px3.p2.2.m1.1b"><ci id="A1.SS7.SSS0.Px3.p2.2.m1.1.1.cmml" xref="A1.SS7.SSS0.Px3.p2.2.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS7.SSS0.Px3.p2.2.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="A1.SS7.SSS0.Px3.p2.2.m1.1d">italic_N</annotation></semantics></math> is the number of discretization points and <math alttext="\Delta x" class="ltx_Math" display="inline" id="A1.SS7.SSS0.Px3.p2.3.m2.1"><semantics id="A1.SS7.SSS0.Px3.p2.3.m2.1a"><mrow id="A1.SS7.SSS0.Px3.p2.3.m2.1.1" xref="A1.SS7.SSS0.Px3.p2.3.m2.1.1.cmml"><mi id="A1.SS7.SSS0.Px3.p2.3.m2.1.1.2" mathvariant="normal" xref="A1.SS7.SSS0.Px3.p2.3.m2.1.1.2.cmml">Δ</mi><mo id="A1.SS7.SSS0.Px3.p2.3.m2.1.1.1" xref="A1.SS7.SSS0.Px3.p2.3.m2.1.1.1.cmml">⁢</mo><mi id="A1.SS7.SSS0.Px3.p2.3.m2.1.1.3" xref="A1.SS7.SSS0.Px3.p2.3.m2.1.1.3.cmml">x</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS7.SSS0.Px3.p2.3.m2.1b"><apply id="A1.SS7.SSS0.Px3.p2.3.m2.1.1.cmml" xref="A1.SS7.SSS0.Px3.p2.3.m2.1.1"><times id="A1.SS7.SSS0.Px3.p2.3.m2.1.1.1.cmml" xref="A1.SS7.SSS0.Px3.p2.3.m2.1.1.1"></times><ci id="A1.SS7.SSS0.Px3.p2.3.m2.1.1.2.cmml" xref="A1.SS7.SSS0.Px3.p2.3.m2.1.1.2">Δ</ci><ci id="A1.SS7.SSS0.Px3.p2.3.m2.1.1.3.cmml" xref="A1.SS7.SSS0.Px3.p2.3.m2.1.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS7.SSS0.Px3.p2.3.m2.1c">\Delta x</annotation><annotation encoding="application/x-llamapun" id="A1.SS7.SSS0.Px3.p2.3.m2.1d">roman_Δ italic_x</annotation></semantics></math> is the spacing between points.
Analytically, we can leverage the fact that the derivative of a Gaussian process is itself a Gaussian process <cite class="ltx_cite ltx_citemacro_cite">Seeger (<a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#bib.bib33" title="">2004</a>)</cite>.
For a Gaussian process with squared exponential kernel <math alttext="k(x,x^{\prime})=\exp(-\frac{(x-x^{\prime})^{2}}{2l^{2}})" class="ltx_Math" display="inline" id="A1.SS7.SSS0.Px3.p2.4.m3.5"><semantics id="A1.SS7.SSS0.Px3.p2.4.m3.5a"><mrow id="A1.SS7.SSS0.Px3.p2.4.m3.5.5" xref="A1.SS7.SSS0.Px3.p2.4.m3.5.5.cmml"><mrow id="A1.SS7.SSS0.Px3.p2.4.m3.4.4.1" xref="A1.SS7.SSS0.Px3.p2.4.m3.4.4.1.cmml"><mi id="A1.SS7.SSS0.Px3.p2.4.m3.4.4.1.3" xref="A1.SS7.SSS0.Px3.p2.4.m3.4.4.1.3.cmml">k</mi><mo id="A1.SS7.SSS0.Px3.p2.4.m3.4.4.1.2" xref="A1.SS7.SSS0.Px3.p2.4.m3.4.4.1.2.cmml">⁢</mo><mrow id="A1.SS7.SSS0.Px3.p2.4.m3.4.4.1.1.1" xref="A1.SS7.SSS0.Px3.p2.4.m3.4.4.1.1.2.cmml"><mo id="A1.SS7.SSS0.Px3.p2.4.m3.4.4.1.1.1.2" stretchy="false" xref="A1.SS7.SSS0.Px3.p2.4.m3.4.4.1.1.2.cmml">(</mo><mi id="A1.SS7.SSS0.Px3.p2.4.m3.2.2" xref="A1.SS7.SSS0.Px3.p2.4.m3.2.2.cmml">x</mi><mo id="A1.SS7.SSS0.Px3.p2.4.m3.4.4.1.1.1.3" xref="A1.SS7.SSS0.Px3.p2.4.m3.4.4.1.1.2.cmml">,</mo><msup id="A1.SS7.SSS0.Px3.p2.4.m3.4.4.1.1.1.1" xref="A1.SS7.SSS0.Px3.p2.4.m3.4.4.1.1.1.1.cmml"><mi id="A1.SS7.SSS0.Px3.p2.4.m3.4.4.1.1.1.1.2" xref="A1.SS7.SSS0.Px3.p2.4.m3.4.4.1.1.1.1.2.cmml">x</mi><mo id="A1.SS7.SSS0.Px3.p2.4.m3.4.4.1.1.1.1.3" xref="A1.SS7.SSS0.Px3.p2.4.m3.4.4.1.1.1.1.3.cmml">′</mo></msup><mo id="A1.SS7.SSS0.Px3.p2.4.m3.4.4.1.1.1.4" stretchy="false" xref="A1.SS7.SSS0.Px3.p2.4.m3.4.4.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.SS7.SSS0.Px3.p2.4.m3.5.5.3" xref="A1.SS7.SSS0.Px3.p2.4.m3.5.5.3.cmml">=</mo><mrow id="A1.SS7.SSS0.Px3.p2.4.m3.5.5.2.1" xref="A1.SS7.SSS0.Px3.p2.4.m3.5.5.2.2.cmml"><mi id="A1.SS7.SSS0.Px3.p2.4.m3.3.3" xref="A1.SS7.SSS0.Px3.p2.4.m3.3.3.cmml">exp</mi><mo id="A1.SS7.SSS0.Px3.p2.4.m3.5.5.2.1a" xref="A1.SS7.SSS0.Px3.p2.4.m3.5.5.2.2.cmml">⁡</mo><mrow id="A1.SS7.SSS0.Px3.p2.4.m3.5.5.2.1.1" xref="A1.SS7.SSS0.Px3.p2.4.m3.5.5.2.2.cmml"><mo id="A1.SS7.SSS0.Px3.p2.4.m3.5.5.2.1.1.2" stretchy="false" xref="A1.SS7.SSS0.Px3.p2.4.m3.5.5.2.2.cmml">(</mo><mrow id="A1.SS7.SSS0.Px3.p2.4.m3.5.5.2.1.1.1" xref="A1.SS7.SSS0.Px3.p2.4.m3.5.5.2.1.1.1.cmml"><mo id="A1.SS7.SSS0.Px3.p2.4.m3.5.5.2.1.1.1a" xref="A1.SS7.SSS0.Px3.p2.4.m3.5.5.2.1.1.1.cmml">−</mo><mfrac id="A1.SS7.SSS0.Px3.p2.4.m3.1.1" xref="A1.SS7.SSS0.Px3.p2.4.m3.1.1.cmml"><msup id="A1.SS7.SSS0.Px3.p2.4.m3.1.1.1" xref="A1.SS7.SSS0.Px3.p2.4.m3.1.1.1.cmml"><mrow id="A1.SS7.SSS0.Px3.p2.4.m3.1.1.1.1.1" xref="A1.SS7.SSS0.Px3.p2.4.m3.1.1.1.1.1.1.cmml"><mo id="A1.SS7.SSS0.Px3.p2.4.m3.1.1.1.1.1.2" stretchy="false" xref="A1.SS7.SSS0.Px3.p2.4.m3.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.SS7.SSS0.Px3.p2.4.m3.1.1.1.1.1.1" xref="A1.SS7.SSS0.Px3.p2.4.m3.1.1.1.1.1.1.cmml"><mi id="A1.SS7.SSS0.Px3.p2.4.m3.1.1.1.1.1.1.2" xref="A1.SS7.SSS0.Px3.p2.4.m3.1.1.1.1.1.1.2.cmml">x</mi><mo id="A1.SS7.SSS0.Px3.p2.4.m3.1.1.1.1.1.1.1" xref="A1.SS7.SSS0.Px3.p2.4.m3.1.1.1.1.1.1.1.cmml">−</mo><msup id="A1.SS7.SSS0.Px3.p2.4.m3.1.1.1.1.1.1.3" xref="A1.SS7.SSS0.Px3.p2.4.m3.1.1.1.1.1.1.3.cmml"><mi id="A1.SS7.SSS0.Px3.p2.4.m3.1.1.1.1.1.1.3.2" xref="A1.SS7.SSS0.Px3.p2.4.m3.1.1.1.1.1.1.3.2.cmml">x</mi><mo id="A1.SS7.SSS0.Px3.p2.4.m3.1.1.1.1.1.1.3.3" xref="A1.SS7.SSS0.Px3.p2.4.m3.1.1.1.1.1.1.3.3.cmml">′</mo></msup></mrow><mo id="A1.SS7.SSS0.Px3.p2.4.m3.1.1.1.1.1.3" stretchy="false" xref="A1.SS7.SSS0.Px3.p2.4.m3.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="A1.SS7.SSS0.Px3.p2.4.m3.1.1.1.3" xref="A1.SS7.SSS0.Px3.p2.4.m3.1.1.1.3.cmml">2</mn></msup><mrow id="A1.SS7.SSS0.Px3.p2.4.m3.1.1.3" xref="A1.SS7.SSS0.Px3.p2.4.m3.1.1.3.cmml"><mn id="A1.SS7.SSS0.Px3.p2.4.m3.1.1.3.2" xref="A1.SS7.SSS0.Px3.p2.4.m3.1.1.3.2.cmml">2</mn><mo id="A1.SS7.SSS0.Px3.p2.4.m3.1.1.3.1" xref="A1.SS7.SSS0.Px3.p2.4.m3.1.1.3.1.cmml">⁢</mo><msup id="A1.SS7.SSS0.Px3.p2.4.m3.1.1.3.3" xref="A1.SS7.SSS0.Px3.p2.4.m3.1.1.3.3.cmml"><mi id="A1.SS7.SSS0.Px3.p2.4.m3.1.1.3.3.2" xref="A1.SS7.SSS0.Px3.p2.4.m3.1.1.3.3.2.cmml">l</mi><mn id="A1.SS7.SSS0.Px3.p2.4.m3.1.1.3.3.3" xref="A1.SS7.SSS0.Px3.p2.4.m3.1.1.3.3.3.cmml">2</mn></msup></mrow></mfrac></mrow><mo id="A1.SS7.SSS0.Px3.p2.4.m3.5.5.2.1.1.3" stretchy="false" xref="A1.SS7.SSS0.Px3.p2.4.m3.5.5.2.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS7.SSS0.Px3.p2.4.m3.5b"><apply id="A1.SS7.SSS0.Px3.p2.4.m3.5.5.cmml" xref="A1.SS7.SSS0.Px3.p2.4.m3.5.5"><eq id="A1.SS7.SSS0.Px3.p2.4.m3.5.5.3.cmml" xref="A1.SS7.SSS0.Px3.p2.4.m3.5.5.3"></eq><apply id="A1.SS7.SSS0.Px3.p2.4.m3.4.4.1.cmml" xref="A1.SS7.SSS0.Px3.p2.4.m3.4.4.1"><times id="A1.SS7.SSS0.Px3.p2.4.m3.4.4.1.2.cmml" xref="A1.SS7.SSS0.Px3.p2.4.m3.4.4.1.2"></times><ci id="A1.SS7.SSS0.Px3.p2.4.m3.4.4.1.3.cmml" xref="A1.SS7.SSS0.Px3.p2.4.m3.4.4.1.3">𝑘</ci><interval closure="open" id="A1.SS7.SSS0.Px3.p2.4.m3.4.4.1.1.2.cmml" xref="A1.SS7.SSS0.Px3.p2.4.m3.4.4.1.1.1"><ci id="A1.SS7.SSS0.Px3.p2.4.m3.2.2.cmml" xref="A1.SS7.SSS0.Px3.p2.4.m3.2.2">𝑥</ci><apply id="A1.SS7.SSS0.Px3.p2.4.m3.4.4.1.1.1.1.cmml" xref="A1.SS7.SSS0.Px3.p2.4.m3.4.4.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS7.SSS0.Px3.p2.4.m3.4.4.1.1.1.1.1.cmml" xref="A1.SS7.SSS0.Px3.p2.4.m3.4.4.1.1.1.1">superscript</csymbol><ci id="A1.SS7.SSS0.Px3.p2.4.m3.4.4.1.1.1.1.2.cmml" xref="A1.SS7.SSS0.Px3.p2.4.m3.4.4.1.1.1.1.2">𝑥</ci><ci id="A1.SS7.SSS0.Px3.p2.4.m3.4.4.1.1.1.1.3.cmml" xref="A1.SS7.SSS0.Px3.p2.4.m3.4.4.1.1.1.1.3">′</ci></apply></interval></apply><apply id="A1.SS7.SSS0.Px3.p2.4.m3.5.5.2.2.cmml" xref="A1.SS7.SSS0.Px3.p2.4.m3.5.5.2.1"><exp id="A1.SS7.SSS0.Px3.p2.4.m3.3.3.cmml" xref="A1.SS7.SSS0.Px3.p2.4.m3.3.3"></exp><apply id="A1.SS7.SSS0.Px3.p2.4.m3.5.5.2.1.1.1.cmml" xref="A1.SS7.SSS0.Px3.p2.4.m3.5.5.2.1.1.1"><minus id="A1.SS7.SSS0.Px3.p2.4.m3.5.5.2.1.1.1.1.cmml" xref="A1.SS7.SSS0.Px3.p2.4.m3.5.5.2.1.1.1"></minus><apply id="A1.SS7.SSS0.Px3.p2.4.m3.1.1.cmml" xref="A1.SS7.SSS0.Px3.p2.4.m3.1.1"><divide id="A1.SS7.SSS0.Px3.p2.4.m3.1.1.2.cmml" xref="A1.SS7.SSS0.Px3.p2.4.m3.1.1"></divide><apply id="A1.SS7.SSS0.Px3.p2.4.m3.1.1.1.cmml" xref="A1.SS7.SSS0.Px3.p2.4.m3.1.1.1"><csymbol cd="ambiguous" id="A1.SS7.SSS0.Px3.p2.4.m3.1.1.1.2.cmml" xref="A1.SS7.SSS0.Px3.p2.4.m3.1.1.1">superscript</csymbol><apply id="A1.SS7.SSS0.Px3.p2.4.m3.1.1.1.1.1.1.cmml" xref="A1.SS7.SSS0.Px3.p2.4.m3.1.1.1.1.1"><minus id="A1.SS7.SSS0.Px3.p2.4.m3.1.1.1.1.1.1.1.cmml" xref="A1.SS7.SSS0.Px3.p2.4.m3.1.1.1.1.1.1.1"></minus><ci id="A1.SS7.SSS0.Px3.p2.4.m3.1.1.1.1.1.1.2.cmml" xref="A1.SS7.SSS0.Px3.p2.4.m3.1.1.1.1.1.1.2">𝑥</ci><apply id="A1.SS7.SSS0.Px3.p2.4.m3.1.1.1.1.1.1.3.cmml" xref="A1.SS7.SSS0.Px3.p2.4.m3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.SS7.SSS0.Px3.p2.4.m3.1.1.1.1.1.1.3.1.cmml" xref="A1.SS7.SSS0.Px3.p2.4.m3.1.1.1.1.1.1.3">superscript</csymbol><ci id="A1.SS7.SSS0.Px3.p2.4.m3.1.1.1.1.1.1.3.2.cmml" xref="A1.SS7.SSS0.Px3.p2.4.m3.1.1.1.1.1.1.3.2">𝑥</ci><ci id="A1.SS7.SSS0.Px3.p2.4.m3.1.1.1.1.1.1.3.3.cmml" xref="A1.SS7.SSS0.Px3.p2.4.m3.1.1.1.1.1.1.3.3">′</ci></apply></apply><cn id="A1.SS7.SSS0.Px3.p2.4.m3.1.1.1.3.cmml" type="integer" xref="A1.SS7.SSS0.Px3.p2.4.m3.1.1.1.3">2</cn></apply><apply id="A1.SS7.SSS0.Px3.p2.4.m3.1.1.3.cmml" xref="A1.SS7.SSS0.Px3.p2.4.m3.1.1.3"><times id="A1.SS7.SSS0.Px3.p2.4.m3.1.1.3.1.cmml" xref="A1.SS7.SSS0.Px3.p2.4.m3.1.1.3.1"></times><cn id="A1.SS7.SSS0.Px3.p2.4.m3.1.1.3.2.cmml" type="integer" xref="A1.SS7.SSS0.Px3.p2.4.m3.1.1.3.2">2</cn><apply id="A1.SS7.SSS0.Px3.p2.4.m3.1.1.3.3.cmml" xref="A1.SS7.SSS0.Px3.p2.4.m3.1.1.3.3"><csymbol cd="ambiguous" id="A1.SS7.SSS0.Px3.p2.4.m3.1.1.3.3.1.cmml" xref="A1.SS7.SSS0.Px3.p2.4.m3.1.1.3.3">superscript</csymbol><ci id="A1.SS7.SSS0.Px3.p2.4.m3.1.1.3.3.2.cmml" xref="A1.SS7.SSS0.Px3.p2.4.m3.1.1.3.3.2">𝑙</ci><cn id="A1.SS7.SSS0.Px3.p2.4.m3.1.1.3.3.3.cmml" type="integer" xref="A1.SS7.SSS0.Px3.p2.4.m3.1.1.3.3.3">2</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS7.SSS0.Px3.p2.4.m3.5c">k(x,x^{\prime})=\exp(-\frac{(x-x^{\prime})^{2}}{2l^{2}})</annotation><annotation encoding="application/x-llamapun" id="A1.SS7.SSS0.Px3.p2.4.m3.5d">italic_k ( italic_x , italic_x start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) = roman_exp ( - divide start_ARG ( italic_x - italic_x start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG 2 italic_l start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG )</annotation></semantics></math>, the expected average curvature can be derived as:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E17">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="R_{analytical}(p^{\prime\prime})=\mathbb{E}[\int(p^{\prime\prime}(x))^{2}dx]=%
\frac{3}{4l^{3}\sqrt{\pi}}" class="ltx_Math" display="block" id="A1.E17.m1.3"><semantics id="A1.E17.m1.3a"><mrow id="A1.E17.m1.3.3" xref="A1.E17.m1.3.3.cmml"><mrow id="A1.E17.m1.2.2.1" xref="A1.E17.m1.2.2.1.cmml"><msub id="A1.E17.m1.2.2.1.3" xref="A1.E17.m1.2.2.1.3.cmml"><mi id="A1.E17.m1.2.2.1.3.2" xref="A1.E17.m1.2.2.1.3.2.cmml">R</mi><mrow id="A1.E17.m1.2.2.1.3.3" xref="A1.E17.m1.2.2.1.3.3.cmml"><mi id="A1.E17.m1.2.2.1.3.3.2" xref="A1.E17.m1.2.2.1.3.3.2.cmml">a</mi><mo id="A1.E17.m1.2.2.1.3.3.1" xref="A1.E17.m1.2.2.1.3.3.1.cmml">⁢</mo><mi id="A1.E17.m1.2.2.1.3.3.3" xref="A1.E17.m1.2.2.1.3.3.3.cmml">n</mi><mo id="A1.E17.m1.2.2.1.3.3.1a" xref="A1.E17.m1.2.2.1.3.3.1.cmml">⁢</mo><mi id="A1.E17.m1.2.2.1.3.3.4" xref="A1.E17.m1.2.2.1.3.3.4.cmml">a</mi><mo id="A1.E17.m1.2.2.1.3.3.1b" xref="A1.E17.m1.2.2.1.3.3.1.cmml">⁢</mo><mi id="A1.E17.m1.2.2.1.3.3.5" xref="A1.E17.m1.2.2.1.3.3.5.cmml">l</mi><mo id="A1.E17.m1.2.2.1.3.3.1c" xref="A1.E17.m1.2.2.1.3.3.1.cmml">⁢</mo><mi id="A1.E17.m1.2.2.1.3.3.6" xref="A1.E17.m1.2.2.1.3.3.6.cmml">y</mi><mo id="A1.E17.m1.2.2.1.3.3.1d" xref="A1.E17.m1.2.2.1.3.3.1.cmml">⁢</mo><mi id="A1.E17.m1.2.2.1.3.3.7" xref="A1.E17.m1.2.2.1.3.3.7.cmml">t</mi><mo id="A1.E17.m1.2.2.1.3.3.1e" xref="A1.E17.m1.2.2.1.3.3.1.cmml">⁢</mo><mi id="A1.E17.m1.2.2.1.3.3.8" xref="A1.E17.m1.2.2.1.3.3.8.cmml">i</mi><mo id="A1.E17.m1.2.2.1.3.3.1f" xref="A1.E17.m1.2.2.1.3.3.1.cmml">⁢</mo><mi id="A1.E17.m1.2.2.1.3.3.9" xref="A1.E17.m1.2.2.1.3.3.9.cmml">c</mi><mo id="A1.E17.m1.2.2.1.3.3.1g" xref="A1.E17.m1.2.2.1.3.3.1.cmml">⁢</mo><mi id="A1.E17.m1.2.2.1.3.3.10" xref="A1.E17.m1.2.2.1.3.3.10.cmml">a</mi><mo id="A1.E17.m1.2.2.1.3.3.1h" xref="A1.E17.m1.2.2.1.3.3.1.cmml">⁢</mo><mi id="A1.E17.m1.2.2.1.3.3.11" xref="A1.E17.m1.2.2.1.3.3.11.cmml">l</mi></mrow></msub><mo id="A1.E17.m1.2.2.1.2" xref="A1.E17.m1.2.2.1.2.cmml">⁢</mo><mrow id="A1.E17.m1.2.2.1.1.1" xref="A1.E17.m1.2.2.1.1.1.1.cmml"><mo id="A1.E17.m1.2.2.1.1.1.2" stretchy="false" xref="A1.E17.m1.2.2.1.1.1.1.cmml">(</mo><msup id="A1.E17.m1.2.2.1.1.1.1" xref="A1.E17.m1.2.2.1.1.1.1.cmml"><mi id="A1.E17.m1.2.2.1.1.1.1.2" xref="A1.E17.m1.2.2.1.1.1.1.2.cmml">p</mi><mo id="A1.E17.m1.2.2.1.1.1.1.3" xref="A1.E17.m1.2.2.1.1.1.1.3.cmml">′′</mo></msup><mo id="A1.E17.m1.2.2.1.1.1.3" stretchy="false" xref="A1.E17.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E17.m1.3.3.4" xref="A1.E17.m1.3.3.4.cmml">=</mo><mrow id="A1.E17.m1.3.3.2" xref="A1.E17.m1.3.3.2.cmml"><mi id="A1.E17.m1.3.3.2.3" xref="A1.E17.m1.3.3.2.3.cmml">𝔼</mi><mo id="A1.E17.m1.3.3.2.2" xref="A1.E17.m1.3.3.2.2.cmml">⁢</mo><mrow id="A1.E17.m1.3.3.2.1.1" xref="A1.E17.m1.3.3.2.1.2.cmml"><mo id="A1.E17.m1.3.3.2.1.1.2" stretchy="false" xref="A1.E17.m1.3.3.2.1.2.1.cmml">[</mo><mrow id="A1.E17.m1.3.3.2.1.1.1" xref="A1.E17.m1.3.3.2.1.1.1.cmml"><mo id="A1.E17.m1.3.3.2.1.1.1.2" lspace="0em" rspace="0em" xref="A1.E17.m1.3.3.2.1.1.1.2.cmml">∫</mo><mrow id="A1.E17.m1.3.3.2.1.1.1.1" xref="A1.E17.m1.3.3.2.1.1.1.1.cmml"><msup id="A1.E17.m1.3.3.2.1.1.1.1.1" xref="A1.E17.m1.3.3.2.1.1.1.1.1.cmml"><mrow id="A1.E17.m1.3.3.2.1.1.1.1.1.1.1" xref="A1.E17.m1.3.3.2.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E17.m1.3.3.2.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E17.m1.3.3.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E17.m1.3.3.2.1.1.1.1.1.1.1.1" xref="A1.E17.m1.3.3.2.1.1.1.1.1.1.1.1.cmml"><msup id="A1.E17.m1.3.3.2.1.1.1.1.1.1.1.1.2" xref="A1.E17.m1.3.3.2.1.1.1.1.1.1.1.1.2.cmml"><mi id="A1.E17.m1.3.3.2.1.1.1.1.1.1.1.1.2.2" xref="A1.E17.m1.3.3.2.1.1.1.1.1.1.1.1.2.2.cmml">p</mi><mo id="A1.E17.m1.3.3.2.1.1.1.1.1.1.1.1.2.3" xref="A1.E17.m1.3.3.2.1.1.1.1.1.1.1.1.2.3.cmml">′′</mo></msup><mo id="A1.E17.m1.3.3.2.1.1.1.1.1.1.1.1.1" xref="A1.E17.m1.3.3.2.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="A1.E17.m1.3.3.2.1.1.1.1.1.1.1.1.3.2" xref="A1.E17.m1.3.3.2.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E17.m1.3.3.2.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="A1.E17.m1.3.3.2.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="A1.E17.m1.1.1" xref="A1.E17.m1.1.1.cmml">x</mi><mo id="A1.E17.m1.3.3.2.1.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="A1.E17.m1.3.3.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E17.m1.3.3.2.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E17.m1.3.3.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="A1.E17.m1.3.3.2.1.1.1.1.1.3" xref="A1.E17.m1.3.3.2.1.1.1.1.1.3.cmml">2</mn></msup><mo id="A1.E17.m1.3.3.2.1.1.1.1.2" lspace="0em" xref="A1.E17.m1.3.3.2.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E17.m1.3.3.2.1.1.1.1.3" xref="A1.E17.m1.3.3.2.1.1.1.1.3.cmml"><mo id="A1.E17.m1.3.3.2.1.1.1.1.3.1" rspace="0em" xref="A1.E17.m1.3.3.2.1.1.1.1.3.1.cmml">𝑑</mo><mi id="A1.E17.m1.3.3.2.1.1.1.1.3.2" xref="A1.E17.m1.3.3.2.1.1.1.1.3.2.cmml">x</mi></mrow></mrow></mrow><mo id="A1.E17.m1.3.3.2.1.1.3" stretchy="false" xref="A1.E17.m1.3.3.2.1.2.1.cmml">]</mo></mrow></mrow><mo id="A1.E17.m1.3.3.5" xref="A1.E17.m1.3.3.5.cmml">=</mo><mfrac id="A1.E17.m1.3.3.6" xref="A1.E17.m1.3.3.6.cmml"><mn id="A1.E17.m1.3.3.6.2" xref="A1.E17.m1.3.3.6.2.cmml">3</mn><mrow id="A1.E17.m1.3.3.6.3" xref="A1.E17.m1.3.3.6.3.cmml"><mn id="A1.E17.m1.3.3.6.3.2" xref="A1.E17.m1.3.3.6.3.2.cmml">4</mn><mo id="A1.E17.m1.3.3.6.3.1" xref="A1.E17.m1.3.3.6.3.1.cmml">⁢</mo><msup id="A1.E17.m1.3.3.6.3.3" xref="A1.E17.m1.3.3.6.3.3.cmml"><mi id="A1.E17.m1.3.3.6.3.3.2" xref="A1.E17.m1.3.3.6.3.3.2.cmml">l</mi><mn id="A1.E17.m1.3.3.6.3.3.3" xref="A1.E17.m1.3.3.6.3.3.3.cmml">3</mn></msup><mo id="A1.E17.m1.3.3.6.3.1a" xref="A1.E17.m1.3.3.6.3.1.cmml">⁢</mo><msqrt id="A1.E17.m1.3.3.6.3.4" xref="A1.E17.m1.3.3.6.3.4.cmml"><mi id="A1.E17.m1.3.3.6.3.4.2" xref="A1.E17.m1.3.3.6.3.4.2.cmml">π</mi></msqrt></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="A1.E17.m1.3b"><apply id="A1.E17.m1.3.3.cmml" xref="A1.E17.m1.3.3"><and id="A1.E17.m1.3.3a.cmml" xref="A1.E17.m1.3.3"></and><apply id="A1.E17.m1.3.3b.cmml" xref="A1.E17.m1.3.3"><eq id="A1.E17.m1.3.3.4.cmml" xref="A1.E17.m1.3.3.4"></eq><apply id="A1.E17.m1.2.2.1.cmml" xref="A1.E17.m1.2.2.1"><times id="A1.E17.m1.2.2.1.2.cmml" xref="A1.E17.m1.2.2.1.2"></times><apply id="A1.E17.m1.2.2.1.3.cmml" xref="A1.E17.m1.2.2.1.3"><csymbol cd="ambiguous" id="A1.E17.m1.2.2.1.3.1.cmml" xref="A1.E17.m1.2.2.1.3">subscript</csymbol><ci id="A1.E17.m1.2.2.1.3.2.cmml" xref="A1.E17.m1.2.2.1.3.2">𝑅</ci><apply id="A1.E17.m1.2.2.1.3.3.cmml" xref="A1.E17.m1.2.2.1.3.3"><times id="A1.E17.m1.2.2.1.3.3.1.cmml" xref="A1.E17.m1.2.2.1.3.3.1"></times><ci id="A1.E17.m1.2.2.1.3.3.2.cmml" xref="A1.E17.m1.2.2.1.3.3.2">𝑎</ci><ci id="A1.E17.m1.2.2.1.3.3.3.cmml" xref="A1.E17.m1.2.2.1.3.3.3">𝑛</ci><ci id="A1.E17.m1.2.2.1.3.3.4.cmml" xref="A1.E17.m1.2.2.1.3.3.4">𝑎</ci><ci id="A1.E17.m1.2.2.1.3.3.5.cmml" xref="A1.E17.m1.2.2.1.3.3.5">𝑙</ci><ci id="A1.E17.m1.2.2.1.3.3.6.cmml" xref="A1.E17.m1.2.2.1.3.3.6">𝑦</ci><ci id="A1.E17.m1.2.2.1.3.3.7.cmml" xref="A1.E17.m1.2.2.1.3.3.7">𝑡</ci><ci id="A1.E17.m1.2.2.1.3.3.8.cmml" xref="A1.E17.m1.2.2.1.3.3.8">𝑖</ci><ci id="A1.E17.m1.2.2.1.3.3.9.cmml" xref="A1.E17.m1.2.2.1.3.3.9">𝑐</ci><ci id="A1.E17.m1.2.2.1.3.3.10.cmml" xref="A1.E17.m1.2.2.1.3.3.10">𝑎</ci><ci id="A1.E17.m1.2.2.1.3.3.11.cmml" xref="A1.E17.m1.2.2.1.3.3.11">𝑙</ci></apply></apply><apply id="A1.E17.m1.2.2.1.1.1.1.cmml" xref="A1.E17.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="A1.E17.m1.2.2.1.1.1.1.1.cmml" xref="A1.E17.m1.2.2.1.1.1">superscript</csymbol><ci id="A1.E17.m1.2.2.1.1.1.1.2.cmml" xref="A1.E17.m1.2.2.1.1.1.1.2">𝑝</ci><ci id="A1.E17.m1.2.2.1.1.1.1.3.cmml" xref="A1.E17.m1.2.2.1.1.1.1.3">′′</ci></apply></apply><apply id="A1.E17.m1.3.3.2.cmml" xref="A1.E17.m1.3.3.2"><times id="A1.E17.m1.3.3.2.2.cmml" xref="A1.E17.m1.3.3.2.2"></times><ci id="A1.E17.m1.3.3.2.3.cmml" xref="A1.E17.m1.3.3.2.3">𝔼</ci><apply id="A1.E17.m1.3.3.2.1.2.cmml" xref="A1.E17.m1.3.3.2.1.1"><csymbol cd="latexml" id="A1.E17.m1.3.3.2.1.2.1.cmml" xref="A1.E17.m1.3.3.2.1.1.2">delimited-[]</csymbol><apply id="A1.E17.m1.3.3.2.1.1.1.cmml" xref="A1.E17.m1.3.3.2.1.1.1"><int id="A1.E17.m1.3.3.2.1.1.1.2.cmml" xref="A1.E17.m1.3.3.2.1.1.1.2"></int><apply id="A1.E17.m1.3.3.2.1.1.1.1.cmml" xref="A1.E17.m1.3.3.2.1.1.1.1"><times id="A1.E17.m1.3.3.2.1.1.1.1.2.cmml" xref="A1.E17.m1.3.3.2.1.1.1.1.2"></times><apply id="A1.E17.m1.3.3.2.1.1.1.1.1.cmml" xref="A1.E17.m1.3.3.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E17.m1.3.3.2.1.1.1.1.1.2.cmml" xref="A1.E17.m1.3.3.2.1.1.1.1.1">superscript</csymbol><apply id="A1.E17.m1.3.3.2.1.1.1.1.1.1.1.1.cmml" xref="A1.E17.m1.3.3.2.1.1.1.1.1.1.1"><times id="A1.E17.m1.3.3.2.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E17.m1.3.3.2.1.1.1.1.1.1.1.1.1"></times><apply id="A1.E17.m1.3.3.2.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E17.m1.3.3.2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E17.m1.3.3.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E17.m1.3.3.2.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="A1.E17.m1.3.3.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E17.m1.3.3.2.1.1.1.1.1.1.1.1.2.2">𝑝</ci><ci id="A1.E17.m1.3.3.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E17.m1.3.3.2.1.1.1.1.1.1.1.1.2.3">′′</ci></apply><ci id="A1.E17.m1.1.1.cmml" xref="A1.E17.m1.1.1">𝑥</ci></apply><cn id="A1.E17.m1.3.3.2.1.1.1.1.1.3.cmml" type="integer" xref="A1.E17.m1.3.3.2.1.1.1.1.1.3">2</cn></apply><apply id="A1.E17.m1.3.3.2.1.1.1.1.3.cmml" xref="A1.E17.m1.3.3.2.1.1.1.1.3"><csymbol cd="latexml" id="A1.E17.m1.3.3.2.1.1.1.1.3.1.cmml" xref="A1.E17.m1.3.3.2.1.1.1.1.3.1">differential-d</csymbol><ci id="A1.E17.m1.3.3.2.1.1.1.1.3.2.cmml" xref="A1.E17.m1.3.3.2.1.1.1.1.3.2">𝑥</ci></apply></apply></apply></apply></apply></apply><apply id="A1.E17.m1.3.3c.cmml" xref="A1.E17.m1.3.3"><eq id="A1.E17.m1.3.3.5.cmml" xref="A1.E17.m1.3.3.5"></eq><share href="https://arxiv.org/html/2410.05218v1#A1.E17.m1.3.3.2.cmml" id="A1.E17.m1.3.3d.cmml" xref="A1.E17.m1.3.3"></share><apply id="A1.E17.m1.3.3.6.cmml" xref="A1.E17.m1.3.3.6"><divide id="A1.E17.m1.3.3.6.1.cmml" xref="A1.E17.m1.3.3.6"></divide><cn id="A1.E17.m1.3.3.6.2.cmml" type="integer" xref="A1.E17.m1.3.3.6.2">3</cn><apply id="A1.E17.m1.3.3.6.3.cmml" xref="A1.E17.m1.3.3.6.3"><times id="A1.E17.m1.3.3.6.3.1.cmml" xref="A1.E17.m1.3.3.6.3.1"></times><cn id="A1.E17.m1.3.3.6.3.2.cmml" type="integer" xref="A1.E17.m1.3.3.6.3.2">4</cn><apply id="A1.E17.m1.3.3.6.3.3.cmml" xref="A1.E17.m1.3.3.6.3.3"><csymbol cd="ambiguous" id="A1.E17.m1.3.3.6.3.3.1.cmml" xref="A1.E17.m1.3.3.6.3.3">superscript</csymbol><ci id="A1.E17.m1.3.3.6.3.3.2.cmml" xref="A1.E17.m1.3.3.6.3.3.2">𝑙</ci><cn id="A1.E17.m1.3.3.6.3.3.3.cmml" type="integer" xref="A1.E17.m1.3.3.6.3.3.3">3</cn></apply><apply id="A1.E17.m1.3.3.6.3.4.cmml" xref="A1.E17.m1.3.3.6.3.4"><root id="A1.E17.m1.3.3.6.3.4a.cmml" xref="A1.E17.m1.3.3.6.3.4"></root><ci id="A1.E17.m1.3.3.6.3.4.2.cmml" xref="A1.E17.m1.3.3.6.3.4.2">𝜋</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E17.m1.3c">R_{analytical}(p^{\prime\prime})=\mathbb{E}[\int(p^{\prime\prime}(x))^{2}dx]=%
\frac{3}{4l^{3}\sqrt{\pi}}</annotation><annotation encoding="application/x-llamapun" id="A1.E17.m1.3d">italic_R start_POSTSUBSCRIPT italic_a italic_n italic_a italic_l italic_y italic_t italic_i italic_c italic_a italic_l end_POSTSUBSCRIPT ( italic_p start_POSTSUPERSCRIPT ′ ′ end_POSTSUPERSCRIPT ) = blackboard_E [ ∫ ( italic_p start_POSTSUPERSCRIPT ′ ′ end_POSTSUPERSCRIPT ( italic_x ) ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_d italic_x ] = divide start_ARG 3 end_ARG start_ARG 4 italic_l start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT square-root start_ARG italic_π end_ARG end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS7.SSS0.Px3.p3">
<p class="ltx_p" id="A1.SS7.SSS0.Px3.p3.1">In our numerical experiments, we find that these two methods agree to high precision, typically within 10% relative error, validating our choice to use Gaussian processes to generate PDFs with controllable curvatures.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
<div class="ltx_para ltx_noindent" id="A1.SS7.SSS0.Px3.p4">
<p class="ltx_p" id="A1.SS7.SSS0.Px3.p4.1"><span class="ltx_text ltx_font_bold" id="A1.SS7.SSS0.Px3.p4.1.1">Randomly generated distribution at low curvature (<math alttext="l=0.5" class="ltx_Math" display="inline" id="A1.SS7.SSS0.Px3.p4.1.1.m1.1"><semantics id="A1.SS7.SSS0.Px3.p4.1.1.m1.1a"><mrow id="A1.SS7.SSS0.Px3.p4.1.1.m1.1.1" xref="A1.SS7.SSS0.Px3.p4.1.1.m1.1.1.cmml"><mi id="A1.SS7.SSS0.Px3.p4.1.1.m1.1.1.2" xref="A1.SS7.SSS0.Px3.p4.1.1.m1.1.1.2.cmml">l</mi><mo id="A1.SS7.SSS0.Px3.p4.1.1.m1.1.1.1" xref="A1.SS7.SSS0.Px3.p4.1.1.m1.1.1.1.cmml">=</mo><mn id="A1.SS7.SSS0.Px3.p4.1.1.m1.1.1.3" xref="A1.SS7.SSS0.Px3.p4.1.1.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS7.SSS0.Px3.p4.1.1.m1.1b"><apply id="A1.SS7.SSS0.Px3.p4.1.1.m1.1.1.cmml" xref="A1.SS7.SSS0.Px3.p4.1.1.m1.1.1"><eq id="A1.SS7.SSS0.Px3.p4.1.1.m1.1.1.1.cmml" xref="A1.SS7.SSS0.Px3.p4.1.1.m1.1.1.1"></eq><ci id="A1.SS7.SSS0.Px3.p4.1.1.m1.1.1.2.cmml" xref="A1.SS7.SSS0.Px3.p4.1.1.m1.1.1.2">𝑙</ci><cn id="A1.SS7.SSS0.Px3.p4.1.1.m1.1.1.3.cmml" type="float" xref="A1.SS7.SSS0.Px3.p4.1.1.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS7.SSS0.Px3.p4.1.1.m1.1c">l=0.5</annotation><annotation encoding="application/x-llamapun" id="A1.SS7.SSS0.Px3.p4.1.1.m1.1d">italic_l = 0.5</annotation></semantics></math>)</span></p>
</div>
<figure class="ltx_figure" id="A1.F27">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A1.F27.1" style="width:274.3pt;"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="302" id="A1.F27.1.g1" src="extracted/5899401/figures/fitted_kernel_13b_random_0.5_seed_15_hel_dist_False.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 26: </span>Fitted kernel width and shape schedule</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A1.F27.2" style="width:111.3pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="667" id="A1.F27.2.g1" src="extracted/5899401/figures/fitted_kernel_13b_random_0.5_seed_15_Hellinger_2D_70.png" width="658"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 27: </span>2D inPCA capturing 70% of Hellinger variances</figcaption>
</figure>
</div>
</div>
</figure>
<figure class="ltx_figure" id="A1.F28">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="121" id="A1.F28.g1" src="extracted/5899401/figures/fitted_kernel_13b_random_0.5_seed_15_fitted_kernel_visualization_10_Log_False.png" width="658"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="121" id="A1.F28.g2" src="extracted/5899401/figures/fitted_kernel_13b_random_0.5_seed_15_fitted_kernel_visualization_20_Log_False.png" width="658"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="121" id="A1.F28.g3" src="extracted/5899401/figures/fitted_kernel_13b_random_0.5_seed_15_fitted_kernel_visualization_50_Log_False.png" width="658"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="121" id="A1.F28.g4" src="extracted/5899401/figures/fitted_kernel_13b_random_0.5_seed_15_fitted_kernel_visualization_90_Log_False.png" width="658"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="121" id="A1.F28.g5" src="extracted/5899401/figures/fitted_kernel_13b_random_0.5_seed_15_fitted_kernel_visualization_140_Log_False.png" width="658"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="90" id="A1.F28.g6" src="extracted/5899401/figures/fitted_kernel_13b_random_0.5_seed_15_true_PDF_Log_False.png" width="180"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 28: </span>Fitted kernel visualization with randomly generated target</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
<div class="ltx_para ltx_noindent" id="A1.SS7.SSS0.Px3.p5">
<p class="ltx_p" id="A1.SS7.SSS0.Px3.p5.1"><span class="ltx_text ltx_font_bold" id="A1.SS7.SSS0.Px3.p5.1.1">Randomly generated distribution at medium curvature (<math alttext="l=0.1" class="ltx_Math" display="inline" id="A1.SS7.SSS0.Px3.p5.1.1.m1.1"><semantics id="A1.SS7.SSS0.Px3.p5.1.1.m1.1a"><mrow id="A1.SS7.SSS0.Px3.p5.1.1.m1.1.1" xref="A1.SS7.SSS0.Px3.p5.1.1.m1.1.1.cmml"><mi id="A1.SS7.SSS0.Px3.p5.1.1.m1.1.1.2" xref="A1.SS7.SSS0.Px3.p5.1.1.m1.1.1.2.cmml">l</mi><mo id="A1.SS7.SSS0.Px3.p5.1.1.m1.1.1.1" xref="A1.SS7.SSS0.Px3.p5.1.1.m1.1.1.1.cmml">=</mo><mn id="A1.SS7.SSS0.Px3.p5.1.1.m1.1.1.3" xref="A1.SS7.SSS0.Px3.p5.1.1.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS7.SSS0.Px3.p5.1.1.m1.1b"><apply id="A1.SS7.SSS0.Px3.p5.1.1.m1.1.1.cmml" xref="A1.SS7.SSS0.Px3.p5.1.1.m1.1.1"><eq id="A1.SS7.SSS0.Px3.p5.1.1.m1.1.1.1.cmml" xref="A1.SS7.SSS0.Px3.p5.1.1.m1.1.1.1"></eq><ci id="A1.SS7.SSS0.Px3.p5.1.1.m1.1.1.2.cmml" xref="A1.SS7.SSS0.Px3.p5.1.1.m1.1.1.2">𝑙</ci><cn id="A1.SS7.SSS0.Px3.p5.1.1.m1.1.1.3.cmml" type="float" xref="A1.SS7.SSS0.Px3.p5.1.1.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS7.SSS0.Px3.p5.1.1.m1.1c">l=0.1</annotation><annotation encoding="application/x-llamapun" id="A1.SS7.SSS0.Px3.p5.1.1.m1.1d">italic_l = 0.1</annotation></semantics></math>)</span></p>
</div>
<figure class="ltx_figure" id="A1.F30">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A1.F30.1" style="width:274.3pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="299" id="A1.F30.1.g1" src="extracted/5899401/figures/fitted_kernel_13b_random_0.1_seed_15_hel_dist_False.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 29: </span>Fitted kernel width and shape schedule</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A1.F30.2" style="width:111.3pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="647" id="A1.F30.2.g1" src="extracted/5899401/figures/fitted_kernel_13b_random_0.1_seed_15_Hellinger_2D_73.png" width="658"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 30: </span>2D inPCA capturing 73% of Hellinger variances</figcaption>
</figure>
</div>
</div>
</figure>
<figure class="ltx_figure" id="A1.F31">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="121" id="A1.F31.g1" src="extracted/5899401/figures/fitted_kernel_13b_random_0.1_seed_15_fitted_kernel_visualization_10_Log_False.png" width="658"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="121" id="A1.F31.g2" src="extracted/5899401/figures/fitted_kernel_13b_random_0.1_seed_15_fitted_kernel_visualization_20_Log_False.png" width="658"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="121" id="A1.F31.g3" src="extracted/5899401/figures/fitted_kernel_13b_random_0.1_seed_15_fitted_kernel_visualization_50_Log_False.png" width="658"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="121" id="A1.F31.g4" src="extracted/5899401/figures/fitted_kernel_13b_random_0.1_seed_15_fitted_kernel_visualization_90_Log_False.png" width="658"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="121" id="A1.F31.g5" src="extracted/5899401/figures/fitted_kernel_13b_random_0.1_seed_15_fitted_kernel_visualization_140_Log_False.png" width="658"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="90" id="A1.F31.g6" src="extracted/5899401/figures/fitted_kernel_13b_random_0.1_seed_15_true_PDF_Log_False.png" width="180"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 31: </span>Fitted kernel visualization with randomly generated target</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
<div class="ltx_para ltx_noindent" id="A1.SS7.SSS0.Px3.p6">
<p class="ltx_p" id="A1.SS7.SSS0.Px3.p6.1"><span class="ltx_text ltx_font_bold" id="A1.SS7.SSS0.Px3.p6.1.1">Randomly generated distribution at high curvature (<math alttext="l=0.02" class="ltx_Math" display="inline" id="A1.SS7.SSS0.Px3.p6.1.1.m1.1"><semantics id="A1.SS7.SSS0.Px3.p6.1.1.m1.1a"><mrow id="A1.SS7.SSS0.Px3.p6.1.1.m1.1.1" xref="A1.SS7.SSS0.Px3.p6.1.1.m1.1.1.cmml"><mi id="A1.SS7.SSS0.Px3.p6.1.1.m1.1.1.2" xref="A1.SS7.SSS0.Px3.p6.1.1.m1.1.1.2.cmml">l</mi><mo id="A1.SS7.SSS0.Px3.p6.1.1.m1.1.1.1" xref="A1.SS7.SSS0.Px3.p6.1.1.m1.1.1.1.cmml">=</mo><mn id="A1.SS7.SSS0.Px3.p6.1.1.m1.1.1.3" xref="A1.SS7.SSS0.Px3.p6.1.1.m1.1.1.3.cmml">0.02</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS7.SSS0.Px3.p6.1.1.m1.1b"><apply id="A1.SS7.SSS0.Px3.p6.1.1.m1.1.1.cmml" xref="A1.SS7.SSS0.Px3.p6.1.1.m1.1.1"><eq id="A1.SS7.SSS0.Px3.p6.1.1.m1.1.1.1.cmml" xref="A1.SS7.SSS0.Px3.p6.1.1.m1.1.1.1"></eq><ci id="A1.SS7.SSS0.Px3.p6.1.1.m1.1.1.2.cmml" xref="A1.SS7.SSS0.Px3.p6.1.1.m1.1.1.2">𝑙</ci><cn id="A1.SS7.SSS0.Px3.p6.1.1.m1.1.1.3.cmml" type="float" xref="A1.SS7.SSS0.Px3.p6.1.1.m1.1.1.3">0.02</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS7.SSS0.Px3.p6.1.1.m1.1c">l=0.02</annotation><annotation encoding="application/x-llamapun" id="A1.SS7.SSS0.Px3.p6.1.1.m1.1d">italic_l = 0.02</annotation></semantics></math>)</span></p>
</div>
<figure class="ltx_figure" id="A1.F33">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A1.F33.1" style="width:238.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="302" id="A1.F33.1.g1" src="extracted/5899401/figures/fitted_kernel_13b_random_0.02_seed_7_hel_dist_False.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 32: </span>Fitted kernel width and shape schedule</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A1.F33.2" style="width:111.3pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="658" id="A1.F33.2.g1" src="extracted/5899401/figures/fitted_kernel_13b_random_0.02_seed_7_Hellinger_2D_55.png" width="658"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 33: </span>2D inPCA capturing 55% of Hellinger variances</figcaption>
</figure>
</div>
</div>
</figure>
<figure class="ltx_figure" id="A1.F34">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="122" id="A1.F34.g1" src="extracted/5899401/figures/fitted_kernel_13b_random_0.02_seed_7_fitted_kernel_visualization_10_Log_False.png" width="658"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="122" id="A1.F34.g2" src="extracted/5899401/figures/fitted_kernel_13b_random_0.02_seed_7_fitted_kernel_visualization_40_Log_False.png" width="658"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="122" id="A1.F34.g3" src="extracted/5899401/figures/fitted_kernel_13b_random_0.02_seed_7_fitted_kernel_visualization_90_Log_False.png" width="658"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="122" id="A1.F34.g4" src="extracted/5899401/figures/fitted_kernel_13b_random_0.02_seed_7_fitted_kernel_visualization_130_Log_False.png" width="658"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="99" id="A1.F34.g5" src="extracted/5899401/figures/fitted_kernel_13b_random_0.02_seed_7_true_PDF_Log_False.png" width="180"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 34: </span>Fitted kernel visualization with randomly generated target</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
<section class="ltx_subsection" id="A1.SS8">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.8 </span>KDE with Silverman bandwidth schedule</h3>
<div class="ltx_para ltx_noindent" id="A1.SS8.p1">
<p class="ltx_p" id="A1.SS8.p1.3">For the majority of our investigations, we have been comparing LLaMA’s in-context DE process with Gaussian KDE with bandwidth schedule</p>
<table class="ltx_equation ltx_eqn_table" id="A1.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="h(n)=Cn^{-\frac{1}{5}}" class="ltx_Math" display="block" id="A1.Ex1.m1.1"><semantics id="A1.Ex1.m1.1a"><mrow id="A1.Ex1.m1.1.2" xref="A1.Ex1.m1.1.2.cmml"><mrow id="A1.Ex1.m1.1.2.2" xref="A1.Ex1.m1.1.2.2.cmml"><mi id="A1.Ex1.m1.1.2.2.2" xref="A1.Ex1.m1.1.2.2.2.cmml">h</mi><mo id="A1.Ex1.m1.1.2.2.1" xref="A1.Ex1.m1.1.2.2.1.cmml">⁢</mo><mrow id="A1.Ex1.m1.1.2.2.3.2" xref="A1.Ex1.m1.1.2.2.cmml"><mo id="A1.Ex1.m1.1.2.2.3.2.1" stretchy="false" xref="A1.Ex1.m1.1.2.2.cmml">(</mo><mi id="A1.Ex1.m1.1.1" xref="A1.Ex1.m1.1.1.cmml">n</mi><mo id="A1.Ex1.m1.1.2.2.3.2.2" stretchy="false" xref="A1.Ex1.m1.1.2.2.cmml">)</mo></mrow></mrow><mo id="A1.Ex1.m1.1.2.1" xref="A1.Ex1.m1.1.2.1.cmml">=</mo><mrow id="A1.Ex1.m1.1.2.3" xref="A1.Ex1.m1.1.2.3.cmml"><mi id="A1.Ex1.m1.1.2.3.2" xref="A1.Ex1.m1.1.2.3.2.cmml">C</mi><mo id="A1.Ex1.m1.1.2.3.1" xref="A1.Ex1.m1.1.2.3.1.cmml">⁢</mo><msup id="A1.Ex1.m1.1.2.3.3" xref="A1.Ex1.m1.1.2.3.3.cmml"><mi id="A1.Ex1.m1.1.2.3.3.2" xref="A1.Ex1.m1.1.2.3.3.2.cmml">n</mi><mrow id="A1.Ex1.m1.1.2.3.3.3" xref="A1.Ex1.m1.1.2.3.3.3.cmml"><mo id="A1.Ex1.m1.1.2.3.3.3a" xref="A1.Ex1.m1.1.2.3.3.3.cmml">−</mo><mfrac id="A1.Ex1.m1.1.2.3.3.3.2" xref="A1.Ex1.m1.1.2.3.3.3.2.cmml"><mn id="A1.Ex1.m1.1.2.3.3.3.2.2" xref="A1.Ex1.m1.1.2.3.3.3.2.2.cmml">1</mn><mn id="A1.Ex1.m1.1.2.3.3.3.2.3" xref="A1.Ex1.m1.1.2.3.3.3.2.3.cmml">5</mn></mfrac></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex1.m1.1b"><apply id="A1.Ex1.m1.1.2.cmml" xref="A1.Ex1.m1.1.2"><eq id="A1.Ex1.m1.1.2.1.cmml" xref="A1.Ex1.m1.1.2.1"></eq><apply id="A1.Ex1.m1.1.2.2.cmml" xref="A1.Ex1.m1.1.2.2"><times id="A1.Ex1.m1.1.2.2.1.cmml" xref="A1.Ex1.m1.1.2.2.1"></times><ci id="A1.Ex1.m1.1.2.2.2.cmml" xref="A1.Ex1.m1.1.2.2.2">ℎ</ci><ci id="A1.Ex1.m1.1.1.cmml" xref="A1.Ex1.m1.1.1">𝑛</ci></apply><apply id="A1.Ex1.m1.1.2.3.cmml" xref="A1.Ex1.m1.1.2.3"><times id="A1.Ex1.m1.1.2.3.1.cmml" xref="A1.Ex1.m1.1.2.3.1"></times><ci id="A1.Ex1.m1.1.2.3.2.cmml" xref="A1.Ex1.m1.1.2.3.2">𝐶</ci><apply id="A1.Ex1.m1.1.2.3.3.cmml" xref="A1.Ex1.m1.1.2.3.3"><csymbol cd="ambiguous" id="A1.Ex1.m1.1.2.3.3.1.cmml" xref="A1.Ex1.m1.1.2.3.3">superscript</csymbol><ci id="A1.Ex1.m1.1.2.3.3.2.cmml" xref="A1.Ex1.m1.1.2.3.3.2">𝑛</ci><apply id="A1.Ex1.m1.1.2.3.3.3.cmml" xref="A1.Ex1.m1.1.2.3.3.3"><minus id="A1.Ex1.m1.1.2.3.3.3.1.cmml" xref="A1.Ex1.m1.1.2.3.3.3"></minus><apply id="A1.Ex1.m1.1.2.3.3.3.2.cmml" xref="A1.Ex1.m1.1.2.3.3.3.2"><divide id="A1.Ex1.m1.1.2.3.3.3.2.1.cmml" xref="A1.Ex1.m1.1.2.3.3.3.2"></divide><cn id="A1.Ex1.m1.1.2.3.3.3.2.2.cmml" type="integer" xref="A1.Ex1.m1.1.2.3.3.3.2.2">1</cn><cn id="A1.Ex1.m1.1.2.3.3.3.2.3.cmml" type="integer" xref="A1.Ex1.m1.1.2.3.3.3.2.3">5</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex1.m1.1c">h(n)=Cn^{-\frac{1}{5}}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex1.m1.1d">italic_h ( italic_n ) = italic_C italic_n start_POSTSUPERSCRIPT - divide start_ARG 1 end_ARG start_ARG 5 end_ARG end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS8.p1.2">with <math alttext="C=1" class="ltx_Math" display="inline" id="A1.SS8.p1.1.m1.1"><semantics id="A1.SS8.p1.1.m1.1a"><mrow id="A1.SS8.p1.1.m1.1.1" xref="A1.SS8.p1.1.m1.1.1.cmml"><mi id="A1.SS8.p1.1.m1.1.1.2" xref="A1.SS8.p1.1.m1.1.1.2.cmml">C</mi><mo id="A1.SS8.p1.1.m1.1.1.1" xref="A1.SS8.p1.1.m1.1.1.1.cmml">=</mo><mn id="A1.SS8.p1.1.m1.1.1.3" xref="A1.SS8.p1.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS8.p1.1.m1.1b"><apply id="A1.SS8.p1.1.m1.1.1.cmml" xref="A1.SS8.p1.1.m1.1.1"><eq id="A1.SS8.p1.1.m1.1.1.1.cmml" xref="A1.SS8.p1.1.m1.1.1.1"></eq><ci id="A1.SS8.p1.1.m1.1.1.2.cmml" xref="A1.SS8.p1.1.m1.1.1.2">𝐶</ci><cn id="A1.SS8.p1.1.m1.1.1.3.cmml" type="integer" xref="A1.SS8.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS8.p1.1.m1.1c">C=1</annotation><annotation encoding="application/x-llamapun" id="A1.SS8.p1.1.m1.1d">italic_C = 1</annotation></semantics></math>.However, as noted in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.SS5.SSS1" title="A.5.1 Optimal Bandwidth ‣ A.5 Additional notes on Kernel Density Estimation ‣ Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">A.5.1</span></a>, in practice one often estimates the pre-coefficient from data, such as Silverman’s rule of thumb (Equation <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.E14" title="Equation 14 ‣ A.5.1 Optimal Bandwidth ‣ A.5 Additional notes on Kernel Density Estimation ‣ Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">14</span></a>).
In this section, we replicate Figures <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#S4.F3" title="Figure 3 ‣ 4.1 Gaussian target ‣ 4 Experiments and analysis ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">3</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#S4.F4" title="Figure 4 ‣ 4.2 Uniform target ‣ 4 Experiments and analysis ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">4</span></a> from Section <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#S4" title="4 Experiments and analysis ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">4</span></a>,
and use Silverman’s rule-of-thumb bandwidth instead of <math alttext="C=1" class="ltx_Math" display="inline" id="A1.SS8.p1.2.m2.1"><semantics id="A1.SS8.p1.2.m2.1a"><mrow id="A1.SS8.p1.2.m2.1.1" xref="A1.SS8.p1.2.m2.1.1.cmml"><mi id="A1.SS8.p1.2.m2.1.1.2" xref="A1.SS8.p1.2.m2.1.1.2.cmml">C</mi><mo id="A1.SS8.p1.2.m2.1.1.1" xref="A1.SS8.p1.2.m2.1.1.1.cmml">=</mo><mn id="A1.SS8.p1.2.m2.1.1.3" xref="A1.SS8.p1.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS8.p1.2.m2.1b"><apply id="A1.SS8.p1.2.m2.1.1.cmml" xref="A1.SS8.p1.2.m2.1.1"><eq id="A1.SS8.p1.2.m2.1.1.1.cmml" xref="A1.SS8.p1.2.m2.1.1.1"></eq><ci id="A1.SS8.p1.2.m2.1.1.2.cmml" xref="A1.SS8.p1.2.m2.1.1.2">𝐶</ci><cn id="A1.SS8.p1.2.m2.1.1.3.cmml" type="integer" xref="A1.SS8.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS8.p1.2.m2.1c">C=1</annotation><annotation encoding="application/x-llamapun" id="A1.SS8.p1.2.m2.1d">italic_C = 1</annotation></semantics></math>.
As shown in Figures <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.F35" title="Figure 35 ‣ A.8 KDE with Silverman bandwidth schedule ‣ Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">35</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.05218v1#A1.F36" title="Figure 36 ‣ A.8 KDE with Silverman bandwidth schedule ‣ Appendix A Appendix ‣ Density estimation with LLMs: a geometric investigation of in-context learning trajectories"><span class="ltx_text ltx_ref_tag">36</span></a>, even with Silverman’s pre-coefficient,
Gaussian KDE still shows a clear bias towards the Gaussian submanifold.</p>
</div>
<div class="ltx_para" id="A1.SS8.p2">
<p class="ltx_p" id="A1.SS8.p2.1"><span class="ltx_text ltx_font_bold" id="A1.SS8.p2.1.1">Gaussian target</span></p>
</div>
<figure class="ltx_figure" id="A1.F35"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="193" id="A1.F35.g1" src="extracted/5899401/figures/gaussian_0.5_0.3_0.1_13b_real_silverman_Hellinger_2D_grouped.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 35: </span>In-context density estimation trajectories for Gaussian targets.
Top row: 2D InPCA embeddings of DE trajectories for Gaussian targets of decreasing width (left to right).
Bottom row: Corresponding ground truth distributions.
These 2D embeddings capture 94% of pairwise Hellinger distances between probability distributions.</figcaption>
</figure>
<div class="ltx_para" id="A1.SS8.p3">
<p class="ltx_p" id="A1.SS8.p3.1"><span class="ltx_text ltx_font_bold" id="A1.SS8.p3.1.1">Uniform target</span></p>
</div>
<figure class="ltx_figure" id="A1.F36"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="211" id="A1.F36.g1" src="extracted/5899401/figures/uniform_0.5_0.3_0.1_7b_13b_KDE_hist_real_silverman_Hellinger_2D_grouped.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 36: </span>In-context density estimation trajectories for Gaussian targets.
Top row: 2D InPCA embeddings of DE trajectories for Gaussian targets of decreasing width (left to right).
Bottom row: Corresponding ground truth distributions.
These 2D embeddings capture 91% of pairwise Hellinger distances between probability distributions.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="A1.SS8.p4">
<p class="ltx_p" id="A1.SS8.p4.1">With Silverman’s heuristic bandwidth, the Gaussian KDE algorithm can now efficiently converge to the ground truth target distribution, performing on par with or even surpassing LLaMA-13b’s in-context DE in terms of speed.
This outcome is not surprising for two reasons:
1. LLaMA is a general-purpose LLM that is not optimized for density estimation tasks.
2. We do not specifically prompt LLaMA to perform DE, so it must infer the task from the raw data sequence.
This comparison is inherently unfair to LLaMA, as Gaussian KDE is specifically designed for DE tasks.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS8.p5">
<p class="ltx_p" id="A1.SS8.p5.1">We would like to reiterate that the purpose of these visualizations is not to benchmark LLaMA against existing algorithms, but to distill geometric insights.
The Gaussian KDE, with Silverman’s bandwidth, features much shorter trajectory lengths, and therefore provides fewer geometric insights compared to our previous visualizations with fixed bandwidth.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Thu Oct  3 17:58:10 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
