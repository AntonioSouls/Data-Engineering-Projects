<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>NRGBoost: Energy-Based Generative Boosted Trees</title>
<!--Generated on Thu Oct  3 22:27:22 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.03535v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S1" title="In NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S2" title="In NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Energy Based Models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S3" title="In NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>NRGBoost</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S3.SS1" title="In 3 NRGBoost ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Weak Learners</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S3.SS2" title="In 3 NRGBoost ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Amortized Sampling</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S3.SS3" title="In 3 NRGBoost ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Regularization</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S4" title="In NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Density Estimation Trees and Density Estimation Forests</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S4.SS0.SSS0.Px1" title="In 4 Density Estimation Trees and Density Estimation Forests ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title">Maximum Likelihood</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S4.SS0.SSS0.Px2" title="In 4 Density Estimation Trees and Density Estimation Forests ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title">Bagging and Feature Subsampling</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S5" title="In NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S5.SS0.SSS0.Px1" title="In 5 Related Work ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title">Generative Boosting</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S5.SS0.SSS0.Px2" title="In 5 Related Work ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title">Greedy Multiplicative Boosting</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S5.SS0.SSS0.Px3" title="In 5 Related Work ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title">Tree-Based Density Modelling</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S5.SS0.SSS0.Px4" title="In 5 Related Work ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title">Other Recent Tree-Based approaches</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S6" title="In NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S6.SS1" title="In 6 Experiments ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.1 </span>Single Variable Inference</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S6.SS2" title="In 6 Experiments ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.2 </span>Sampling</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S6.SS2.SSS0.Px1" title="In 6.2 Sampling ‣ 6 Experiments ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title">Machine Learning Efficiency</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S6.SS2.SSS0.Px2" title="In 6.2 Sampling ‣ 6 Experiments ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title">Discriminator Measure</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S6.SS2.SSS0.Px3" title="In 6.2 Sampling ‣ 6 Experiments ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title">Statistical Distance Measure</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S7" title="In NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Discussion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S8" title="In NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">8 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A1" title="In NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Theory</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A1.SS1" title="In Appendix A Theory ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Application to Piecewise Constant Functions</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A1.SS2" title="In Appendix A Theory ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2 </span>A Simple Lower Bound on the Likelihood Increase</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A2" title="In NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Density Estimation Trees</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A3" title="In NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Greedy Tree-Based Multiplicative Boosting</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A4" title="In NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D </span>Reproducibility</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A4.SS1" title="In Appendix D Reproducibility ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.1 </span>Datasets</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A4.SS2" title="In Appendix D Reproducibility ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.2 </span>DEF and NRGBoost Implementation Details</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A4.SS2.SSS0.Px1" title="In D.2 DEF and NRGBoost Implementation Details ‣ Appendix D Reproducibility ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title">Discretization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A4.SS2.SSS0.Px2" title="In D.2 DEF and NRGBoost Implementation Details ‣ Appendix D Reproducibility ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title">Categorical Splitting</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A4.SS2.SSS0.Px3" title="In D.2 DEF and NRGBoost Implementation Details ‣ Appendix D Reproducibility ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title">Tree Growth Strategy</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A4.SS2.SSS0.Px4" title="In D.2 DEF and NRGBoost Implementation Details ‣ Appendix D Reproducibility ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title">Line Search</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A4.SS2.SSS0.Px5" title="In D.2 DEF and NRGBoost Implementation Details ‣ Appendix D Reproducibility ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title">Code</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A4.SS3" title="In Appendix D Reproducibility ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.3 </span>Hyperparameter Tuning</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A4.SS3.SSS1" title="In D.3 Hyperparameter Tuning ‣ Appendix D Reproducibility ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.3.1 </span>XGBoost</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A4.SS3.SSS2" title="In D.3 Hyperparameter Tuning ‣ Appendix D Reproducibility ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.3.2 </span>RFDE</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A4.SS3.SSS3" title="In D.3 Hyperparameter Tuning ‣ Appendix D Reproducibility ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.3.3 </span>ARF</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A4.SS3.SSS4" title="In D.3 Hyperparameter Tuning ‣ Appendix D Reproducibility ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.3.4 </span>DEF</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A4.SS3.SSS5" title="In D.3 Hyperparameter Tuning ‣ Appendix D Reproducibility ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.3.5 </span>NRGBoost</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A4.SS3.SSS6" title="In D.3 Hyperparameter Tuning ‣ Appendix D Reproducibility ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.3.6 </span>TVAE</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A4.SS3.SSS7" title="In D.3 Hyperparameter Tuning ‣ Appendix D Reproducibility ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.3.7 </span>TabDDPM</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A4.SS3.SSS8" title="In D.3 Hyperparameter Tuning ‣ Appendix D Reproducibility ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.3.8 </span>Forest-Flow</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A4.SS4" title="In Appendix D Reproducibility ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.4 </span>Evaluation Setup</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A4.SS4.SSS0.Px1" title="In D.4 Evaluation Setup ‣ Appendix D Reproducibility ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title">Single variable inference</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A4.SS4.SSS0.Px2" title="In D.4 Evaluation Setup ‣ Appendix D Reproducibility ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title">Sampling</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A4.SS4.SSS0.Px3" title="In D.4 Evaluation Setup ‣ Appendix D Reproducibility ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title">ML Efficiency</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A4.SS4.SSS0.Px4" title="In D.4 Evaluation Setup ‣ Appendix D Reproducibility ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title">Discriminator Measure</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A4.SS4.SSS0.Px5" title="In D.4 Evaluation Setup ‣ Appendix D Reproducibility ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title">Statistical Distance Measure</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A4.SS5" title="In Appendix D Reproducibility ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.5 </span>Computational Resources</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A5" title="In NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E </span>Additional Results</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A5.SS1" title="In Appendix E Additional Results ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E.1 </span>Computational Effort</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A5.SS2" title="In Appendix E Additional Results ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E.2 </span>MCMC Chain Convergence on MNIST</span></a></li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">NRGBoost: Energy-Based Generative Boosted Trees</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">João Bravo 
<br class="ltx_break"/>Feedzai 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id1.1.id1">joao.bravo@feedzai.com</span>
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id2.id1">Despite the rise to dominance of deep learning in unstructured data domains, tree-based methods such as Random Forests (RF) and Gradient Boosted Decision Trees (GBDT) are still the workhorses for handling discriminative tasks on tabular data. We explore generative extensions of these popular algorithms with a focus on explicitly modeling the data density (up to a normalization constant), thus enabling other applications besides sampling.
As our main contribution we propose an energy-based generative boosting algorithm that is analogous to the second order boosting implemented in popular packages like XGBoost.
We show that, despite producing a generative model capable of handling inference tasks over any input variable,
our proposed algorithm can achieve similar discriminative performance to GBDT on a number of real world tabular datasets, outperforming alternative generative approaches.
At the same time, we show that it is also competitive with neural network based models for sampling.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para ltx_noindent" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Generative models have achieved tremendous success in computer vision
and natural language processing,
where the ability to generate synthetic
data guided by user prompts opens up many exciting possibilities.
While generating synthetic table records does not necessarily enjoy the same wide appeal,
this problem has still received considerable attention
as a potential avenue for bypassing privacy concerns when sharing data.
Estimating the data density, <math alttext="p(\mathbf{x})" class="ltx_Math" display="inline" id="S1.p1.1.m1.1"><semantics id="S1.p1.1.m1.1a"><mrow id="S1.p1.1.m1.1.2" xref="S1.p1.1.m1.1.2.cmml"><mi id="S1.p1.1.m1.1.2.2" xref="S1.p1.1.m1.1.2.2.cmml">p</mi><mo id="S1.p1.1.m1.1.2.1" xref="S1.p1.1.m1.1.2.1.cmml">⁢</mo><mrow id="S1.p1.1.m1.1.2.3.2" xref="S1.p1.1.m1.1.2.cmml"><mo id="S1.p1.1.m1.1.2.3.2.1" stretchy="false" xref="S1.p1.1.m1.1.2.cmml">(</mo><mi id="S1.p1.1.m1.1.1" xref="S1.p1.1.m1.1.1.cmml">𝐱</mi><mo id="S1.p1.1.m1.1.2.3.2.2" stretchy="false" xref="S1.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p1.1.m1.1b"><apply id="S1.p1.1.m1.1.2.cmml" xref="S1.p1.1.m1.1.2"><times id="S1.p1.1.m1.1.2.1.cmml" xref="S1.p1.1.m1.1.2.1"></times><ci id="S1.p1.1.m1.1.2.2.cmml" xref="S1.p1.1.m1.1.2.2">𝑝</ci><ci id="S1.p1.1.m1.1.1.cmml" xref="S1.p1.1.m1.1.1">𝐱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.1.m1.1c">p(\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="S1.p1.1.m1.1d">italic_p ( bold_x )</annotation></semantics></math>, is another typical application of generative models which enables a host of different use cases that can be particularly interesting for tabular data.
Unlike discriminative models which are trained to perform inference over a single target variable,
density models can be used more flexibly for inference over different variables or for out of distribution detection.
They can also handle inference with missing data in a principled way by marginalizing over unobserved variables.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">The development of generative models for tabular data has mirrored its progression in computer vision
with many of its Deep Learning (DL) approaches being adapted to the tabular domain
<cite class="ltx_cite ltx_citemacro_citep">(Jordon et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib17" title="">2018</a>; Xu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib32" title="">2019</a>; Fan et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib11" title="">2020</a>; Engelmann &amp; Lessmann, <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib10" title="">2021</a>; Zhao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib33" title="">2021</a>; Kotelnikov et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib19" title="">2023</a>)</cite>.
Unfortunately, these methods are only useful for sampling as they either don’t model the density explicitly or can’t evaluate it due to untractable marginalization over high dimensional latent variable spaces.
Furthermore, despite growing in popularity, DL has still failed to displace tree-based ensemble methods
as the tool of choice for handling tabular discriminative tasks
with gradient boosting still being
found to outperform neural-network-based methods in many real world datasets <cite class="ltx_cite ltx_citemacro_citep">(Grinsztajn et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib13" title="">2022</a>; Borisov et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib2" title="">2022a</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">While there have been recent efforts to extend the success of tree-based models to generative modeling <cite class="ltx_cite ltx_citemacro_citep">(Correia et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib5" title="">2020</a>; Wen &amp; Hang, <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib31" title="">2022</a>; Nock &amp; Guillame-Bert, <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib20" title="">2022</a>; Watson et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib29" title="">2023</a>; Nock &amp; Guillame-Bert, <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib21" title="">2023</a>; Jolicoeur-Martineau et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib16" title="">2024</a>)</cite>,
direct extensions of Random Forests (RF) and Gradient Boosted Decision Trees (GBDT) are still missing.
It is this gap that we try to address, seeking to keep the general algorithmic structure of these popular algorithms but replacing the optimization of their discriminative objective with a generative counterpart.
Our main contributions in this regard are:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We propose NRGBoost, a novel energy-based generative boosting model that is trained to maximize a local second order approximation to the likelihood at each boosting round.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We propose an amortized sampling approach that greatly reduces the training time of NRGBoost, which, like other energy-based models, is often dominated by sampling.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">We explore the use of bagged ensembles of Density Estimation Trees (DET) <cite class="ltx_cite ltx_citemacro_citep">(Ram &amp; Gray, <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib24" title="">2011</a>)</cite> with feature subsampling as a generative counterpart to Random Forests.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para ltx_noindent" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">The longstanding popularity of GBDT models in machine learning practice can, in part, be attributed to the strength of its empirical results and the efficiency of its existing implementations.
We therefore focus on an experimental evaluation in real world datasets spanning a range of use cases, number of samples and features.
On smaller datasets, our implementation of NRGBoost
can be trained in a few minutes on a mid-range consumer CPU and achieves similar discriminative performance to a standard GBDT model, while remaining competitive with the best generative models for sampling.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="340" id="S1.F1.g1" src="x1.png" width="478"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Downsampled MNIST samples generated by the best generative models on this dataset.
Despite this being a simple image dataset, it can be challenging for tabular generative models due to the high dimensionality and complex structure of correlations between features.
We find NRGBoost to be the only model that is able to generate passable samples.</figcaption>
</figure>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Energy Based Models</h2>
<div class="ltx_para ltx_noindent" id="S2.p1">
<p class="ltx_p" id="S2.p1.5">An Energy-Based Model (EBM) parametrizes the logarithm of a probability density function directly (up to an unspecified normalizing constant):</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="q_{f}(\mathbf{x})=\frac{\exp\left(f(\mathbf{x})\right)}{Z[f]}." class="ltx_Math" display="block" id="S2.E1.m1.6"><semantics id="S2.E1.m1.6a"><mrow id="S2.E1.m1.6.6.1" xref="S2.E1.m1.6.6.1.1.cmml"><mrow id="S2.E1.m1.6.6.1.1" xref="S2.E1.m1.6.6.1.1.cmml"><mrow id="S2.E1.m1.6.6.1.1.2" xref="S2.E1.m1.6.6.1.1.2.cmml"><msub id="S2.E1.m1.6.6.1.1.2.2" xref="S2.E1.m1.6.6.1.1.2.2.cmml"><mi id="S2.E1.m1.6.6.1.1.2.2.2" xref="S2.E1.m1.6.6.1.1.2.2.2.cmml">q</mi><mi id="S2.E1.m1.6.6.1.1.2.2.3" xref="S2.E1.m1.6.6.1.1.2.2.3.cmml">f</mi></msub><mo id="S2.E1.m1.6.6.1.1.2.1" xref="S2.E1.m1.6.6.1.1.2.1.cmml">⁢</mo><mrow id="S2.E1.m1.6.6.1.1.2.3.2" xref="S2.E1.m1.6.6.1.1.2.cmml"><mo id="S2.E1.m1.6.6.1.1.2.3.2.1" stretchy="false" xref="S2.E1.m1.6.6.1.1.2.cmml">(</mo><mi id="S2.E1.m1.5.5" xref="S2.E1.m1.5.5.cmml">𝐱</mi><mo id="S2.E1.m1.6.6.1.1.2.3.2.2" stretchy="false" xref="S2.E1.m1.6.6.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.6.6.1.1.1" xref="S2.E1.m1.6.6.1.1.1.cmml">=</mo><mfrac id="S2.E1.m1.4.4" xref="S2.E1.m1.4.4.cmml"><mrow id="S2.E1.m1.3.3.3.3" xref="S2.E1.m1.3.3.3.4.cmml"><mi id="S2.E1.m1.2.2.2.2" xref="S2.E1.m1.2.2.2.2.cmml">exp</mi><mo id="S2.E1.m1.3.3.3.3a" xref="S2.E1.m1.3.3.3.4.cmml">⁡</mo><mrow id="S2.E1.m1.3.3.3.3.1" xref="S2.E1.m1.3.3.3.4.cmml"><mo id="S2.E1.m1.3.3.3.3.1.2" xref="S2.E1.m1.3.3.3.4.cmml">(</mo><mrow id="S2.E1.m1.3.3.3.3.1.1" xref="S2.E1.m1.3.3.3.3.1.1.cmml"><mi id="S2.E1.m1.3.3.3.3.1.1.2" xref="S2.E1.m1.3.3.3.3.1.1.2.cmml">f</mi><mo id="S2.E1.m1.3.3.3.3.1.1.1" xref="S2.E1.m1.3.3.3.3.1.1.1.cmml">⁢</mo><mrow id="S2.E1.m1.3.3.3.3.1.1.3.2" xref="S2.E1.m1.3.3.3.3.1.1.cmml"><mo id="S2.E1.m1.3.3.3.3.1.1.3.2.1" stretchy="false" xref="S2.E1.m1.3.3.3.3.1.1.cmml">(</mo><mi id="S2.E1.m1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml">𝐱</mi><mo id="S2.E1.m1.3.3.3.3.1.1.3.2.2" stretchy="false" xref="S2.E1.m1.3.3.3.3.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.3.3.3.3.1.3" xref="S2.E1.m1.3.3.3.4.cmml">)</mo></mrow></mrow><mrow id="S2.E1.m1.4.4.4" xref="S2.E1.m1.4.4.4.cmml"><mi id="S2.E1.m1.4.4.4.3" xref="S2.E1.m1.4.4.4.3.cmml">Z</mi><mo id="S2.E1.m1.4.4.4.2" xref="S2.E1.m1.4.4.4.2.cmml">⁢</mo><mrow id="S2.E1.m1.4.4.4.4.2" xref="S2.E1.m1.4.4.4.4.1.cmml"><mo id="S2.E1.m1.4.4.4.4.2.1" stretchy="false" xref="S2.E1.m1.4.4.4.4.1.1.cmml">[</mo><mi id="S2.E1.m1.4.4.4.1" xref="S2.E1.m1.4.4.4.1.cmml">f</mi><mo id="S2.E1.m1.4.4.4.4.2.2" stretchy="false" xref="S2.E1.m1.4.4.4.4.1.1.cmml">]</mo></mrow></mrow></mfrac></mrow><mo id="S2.E1.m1.6.6.1.2" lspace="0em" xref="S2.E1.m1.6.6.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.6b"><apply id="S2.E1.m1.6.6.1.1.cmml" xref="S2.E1.m1.6.6.1"><eq id="S2.E1.m1.6.6.1.1.1.cmml" xref="S2.E1.m1.6.6.1.1.1"></eq><apply id="S2.E1.m1.6.6.1.1.2.cmml" xref="S2.E1.m1.6.6.1.1.2"><times id="S2.E1.m1.6.6.1.1.2.1.cmml" xref="S2.E1.m1.6.6.1.1.2.1"></times><apply id="S2.E1.m1.6.6.1.1.2.2.cmml" xref="S2.E1.m1.6.6.1.1.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.6.6.1.1.2.2.1.cmml" xref="S2.E1.m1.6.6.1.1.2.2">subscript</csymbol><ci id="S2.E1.m1.6.6.1.1.2.2.2.cmml" xref="S2.E1.m1.6.6.1.1.2.2.2">𝑞</ci><ci id="S2.E1.m1.6.6.1.1.2.2.3.cmml" xref="S2.E1.m1.6.6.1.1.2.2.3">𝑓</ci></apply><ci id="S2.E1.m1.5.5.cmml" xref="S2.E1.m1.5.5">𝐱</ci></apply><apply id="S2.E1.m1.4.4.cmml" xref="S2.E1.m1.4.4"><divide id="S2.E1.m1.4.4.5.cmml" xref="S2.E1.m1.4.4"></divide><apply id="S2.E1.m1.3.3.3.4.cmml" xref="S2.E1.m1.3.3.3.3"><exp id="S2.E1.m1.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2"></exp><apply id="S2.E1.m1.3.3.3.3.1.1.cmml" xref="S2.E1.m1.3.3.3.3.1.1"><times id="S2.E1.m1.3.3.3.3.1.1.1.cmml" xref="S2.E1.m1.3.3.3.3.1.1.1"></times><ci id="S2.E1.m1.3.3.3.3.1.1.2.cmml" xref="S2.E1.m1.3.3.3.3.1.1.2">𝑓</ci><ci id="S2.E1.m1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1">𝐱</ci></apply></apply><apply id="S2.E1.m1.4.4.4.cmml" xref="S2.E1.m1.4.4.4"><times id="S2.E1.m1.4.4.4.2.cmml" xref="S2.E1.m1.4.4.4.2"></times><ci id="S2.E1.m1.4.4.4.3.cmml" xref="S2.E1.m1.4.4.4.3">𝑍</ci><apply id="S2.E1.m1.4.4.4.4.1.cmml" xref="S2.E1.m1.4.4.4.4.2"><csymbol cd="latexml" id="S2.E1.m1.4.4.4.4.1.1.cmml" xref="S2.E1.m1.4.4.4.4.2.1">delimited-[]</csymbol><ci id="S2.E1.m1.4.4.4.1.cmml" xref="S2.E1.m1.4.4.4.1">𝑓</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.6c">q_{f}(\mathbf{x})=\frac{\exp\left(f(\mathbf{x})\right)}{Z[f]}.</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.6d">italic_q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT ( bold_x ) = divide start_ARG roman_exp ( italic_f ( bold_x ) ) end_ARG start_ARG italic_Z [ italic_f ] end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p1.4">Here <math alttext="f(\mathbf{x}):\mathcal{X}\rightarrow\mathbb{R}" class="ltx_Math" display="inline" id="S2.p1.1.m1.1"><semantics id="S2.p1.1.m1.1a"><mrow id="S2.p1.1.m1.1.2" xref="S2.p1.1.m1.1.2.cmml"><mrow id="S2.p1.1.m1.1.2.2" xref="S2.p1.1.m1.1.2.2.cmml"><mi id="S2.p1.1.m1.1.2.2.2" xref="S2.p1.1.m1.1.2.2.2.cmml">f</mi><mo id="S2.p1.1.m1.1.2.2.1" xref="S2.p1.1.m1.1.2.2.1.cmml">⁢</mo><mrow id="S2.p1.1.m1.1.2.2.3.2" xref="S2.p1.1.m1.1.2.2.cmml"><mo id="S2.p1.1.m1.1.2.2.3.2.1" stretchy="false" xref="S2.p1.1.m1.1.2.2.cmml">(</mo><mi id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml">𝐱</mi><mo id="S2.p1.1.m1.1.2.2.3.2.2" rspace="0.278em" stretchy="false" xref="S2.p1.1.m1.1.2.2.cmml">)</mo></mrow></mrow><mo id="S2.p1.1.m1.1.2.1" rspace="0.278em" xref="S2.p1.1.m1.1.2.1.cmml">:</mo><mrow id="S2.p1.1.m1.1.2.3" xref="S2.p1.1.m1.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.1.m1.1.2.3.2" xref="S2.p1.1.m1.1.2.3.2.cmml">𝒳</mi><mo id="S2.p1.1.m1.1.2.3.1" stretchy="false" xref="S2.p1.1.m1.1.2.3.1.cmml">→</mo><mi id="S2.p1.1.m1.1.2.3.3" xref="S2.p1.1.m1.1.2.3.3.cmml">ℝ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.1b"><apply id="S2.p1.1.m1.1.2.cmml" xref="S2.p1.1.m1.1.2"><ci id="S2.p1.1.m1.1.2.1.cmml" xref="S2.p1.1.m1.1.2.1">:</ci><apply id="S2.p1.1.m1.1.2.2.cmml" xref="S2.p1.1.m1.1.2.2"><times id="S2.p1.1.m1.1.2.2.1.cmml" xref="S2.p1.1.m1.1.2.2.1"></times><ci id="S2.p1.1.m1.1.2.2.2.cmml" xref="S2.p1.1.m1.1.2.2.2">𝑓</ci><ci id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1">𝐱</ci></apply><apply id="S2.p1.1.m1.1.2.3.cmml" xref="S2.p1.1.m1.1.2.3"><ci id="S2.p1.1.m1.1.2.3.1.cmml" xref="S2.p1.1.m1.1.2.3.1">→</ci><ci id="S2.p1.1.m1.1.2.3.2.cmml" xref="S2.p1.1.m1.1.2.3.2">𝒳</ci><ci id="S2.p1.1.m1.1.2.3.3.cmml" xref="S2.p1.1.m1.1.2.3.3">ℝ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.1c">f(\mathbf{x}):\mathcal{X}\rightarrow\mathbb{R}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.1.m1.1d">italic_f ( bold_x ) : caligraphic_X → blackboard_R</annotation></semantics></math> is a real function over the input domain.<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>
We will assume that <math alttext="\mathcal{X}" class="ltx_Math" display="inline" id="footnote1.m1.1"><semantics id="footnote1.m1.1b"><mi class="ltx_font_mathcaligraphic" id="footnote1.m1.1.1" xref="footnote1.m1.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="footnote1.m1.1c"><ci id="footnote1.m1.1.1.cmml" xref="footnote1.m1.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="footnote1.m1.1d">\mathcal{X}</annotation><annotation encoding="application/x-llamapun" id="footnote1.m1.1e">caligraphic_X</annotation></semantics></math> is finite and discrete to simplify the notation and exposition but everything is applicable to bounded continuous input spaces, replacing the sums with integrals as appropriate.
</span></span></span>
We will avoid introducing any parametrization,
instead treating the function <math alttext="f\in\mathcal{F}(\mathcal{X})" class="ltx_Math" display="inline" id="S2.p1.2.m2.1"><semantics id="S2.p1.2.m2.1a"><mrow id="S2.p1.2.m2.1.2" xref="S2.p1.2.m2.1.2.cmml"><mi id="S2.p1.2.m2.1.2.2" xref="S2.p1.2.m2.1.2.2.cmml">f</mi><mo id="S2.p1.2.m2.1.2.1" xref="S2.p1.2.m2.1.2.1.cmml">∈</mo><mrow id="S2.p1.2.m2.1.2.3" xref="S2.p1.2.m2.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.2.m2.1.2.3.2" xref="S2.p1.2.m2.1.2.3.2.cmml">ℱ</mi><mo id="S2.p1.2.m2.1.2.3.1" xref="S2.p1.2.m2.1.2.3.1.cmml">⁢</mo><mrow id="S2.p1.2.m2.1.2.3.3.2" xref="S2.p1.2.m2.1.2.3.cmml"><mo id="S2.p1.2.m2.1.2.3.3.2.1" stretchy="false" xref="S2.p1.2.m2.1.2.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S2.p1.2.m2.1.1" xref="S2.p1.2.m2.1.1.cmml">𝒳</mi><mo id="S2.p1.2.m2.1.2.3.3.2.2" stretchy="false" xref="S2.p1.2.m2.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.2.m2.1b"><apply id="S2.p1.2.m2.1.2.cmml" xref="S2.p1.2.m2.1.2"><in id="S2.p1.2.m2.1.2.1.cmml" xref="S2.p1.2.m2.1.2.1"></in><ci id="S2.p1.2.m2.1.2.2.cmml" xref="S2.p1.2.m2.1.2.2">𝑓</ci><apply id="S2.p1.2.m2.1.2.3.cmml" xref="S2.p1.2.m2.1.2.3"><times id="S2.p1.2.m2.1.2.3.1.cmml" xref="S2.p1.2.m2.1.2.3.1"></times><ci id="S2.p1.2.m2.1.2.3.2.cmml" xref="S2.p1.2.m2.1.2.3.2">ℱ</ci><ci id="S2.p1.2.m2.1.1.cmml" xref="S2.p1.2.m2.1.1">𝒳</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.m2.1c">f\in\mathcal{F}(\mathcal{X})</annotation><annotation encoding="application/x-llamapun" id="S2.p1.2.m2.1d">italic_f ∈ caligraphic_F ( caligraphic_X )</annotation></semantics></math> lying in an appropriate function space over the input space as our model parameter directly.
<math alttext="Z[f]=\sum_{\mathbf{x}\in\mathcal{X}}\exp\left(f(\mathbf{x})\right)" class="ltx_Math" display="inline" id="S2.p1.3.m3.4"><semantics id="S2.p1.3.m3.4a"><mrow id="S2.p1.3.m3.4.4" xref="S2.p1.3.m3.4.4.cmml"><mrow id="S2.p1.3.m3.4.4.3" xref="S2.p1.3.m3.4.4.3.cmml"><mi id="S2.p1.3.m3.4.4.3.2" xref="S2.p1.3.m3.4.4.3.2.cmml">Z</mi><mo id="S2.p1.3.m3.4.4.3.1" xref="S2.p1.3.m3.4.4.3.1.cmml">⁢</mo><mrow id="S2.p1.3.m3.4.4.3.3.2" xref="S2.p1.3.m3.4.4.3.3.1.cmml"><mo id="S2.p1.3.m3.4.4.3.3.2.1" stretchy="false" xref="S2.p1.3.m3.4.4.3.3.1.1.cmml">[</mo><mi id="S2.p1.3.m3.1.1" xref="S2.p1.3.m3.1.1.cmml">f</mi><mo id="S2.p1.3.m3.4.4.3.3.2.2" stretchy="false" xref="S2.p1.3.m3.4.4.3.3.1.1.cmml">]</mo></mrow></mrow><mo id="S2.p1.3.m3.4.4.2" rspace="0.111em" xref="S2.p1.3.m3.4.4.2.cmml">=</mo><mrow id="S2.p1.3.m3.4.4.1" xref="S2.p1.3.m3.4.4.1.cmml"><msub id="S2.p1.3.m3.4.4.1.2" xref="S2.p1.3.m3.4.4.1.2.cmml"><mo id="S2.p1.3.m3.4.4.1.2.2" xref="S2.p1.3.m3.4.4.1.2.2.cmml">∑</mo><mrow id="S2.p1.3.m3.4.4.1.2.3" xref="S2.p1.3.m3.4.4.1.2.3.cmml"><mi id="S2.p1.3.m3.4.4.1.2.3.2" xref="S2.p1.3.m3.4.4.1.2.3.2.cmml">𝐱</mi><mo id="S2.p1.3.m3.4.4.1.2.3.1" xref="S2.p1.3.m3.4.4.1.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.p1.3.m3.4.4.1.2.3.3" xref="S2.p1.3.m3.4.4.1.2.3.3.cmml">𝒳</mi></mrow></msub><mrow id="S2.p1.3.m3.4.4.1.1.1" xref="S2.p1.3.m3.4.4.1.1.2.cmml"><mi id="S2.p1.3.m3.3.3" xref="S2.p1.3.m3.3.3.cmml">exp</mi><mo id="S2.p1.3.m3.4.4.1.1.1a" xref="S2.p1.3.m3.4.4.1.1.2.cmml">⁡</mo><mrow id="S2.p1.3.m3.4.4.1.1.1.1" xref="S2.p1.3.m3.4.4.1.1.2.cmml"><mo id="S2.p1.3.m3.4.4.1.1.1.1.2" xref="S2.p1.3.m3.4.4.1.1.2.cmml">(</mo><mrow id="S2.p1.3.m3.4.4.1.1.1.1.1" xref="S2.p1.3.m3.4.4.1.1.1.1.1.cmml"><mi id="S2.p1.3.m3.4.4.1.1.1.1.1.2" xref="S2.p1.3.m3.4.4.1.1.1.1.1.2.cmml">f</mi><mo id="S2.p1.3.m3.4.4.1.1.1.1.1.1" xref="S2.p1.3.m3.4.4.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S2.p1.3.m3.4.4.1.1.1.1.1.3.2" xref="S2.p1.3.m3.4.4.1.1.1.1.1.cmml"><mo id="S2.p1.3.m3.4.4.1.1.1.1.1.3.2.1" stretchy="false" xref="S2.p1.3.m3.4.4.1.1.1.1.1.cmml">(</mo><mi id="S2.p1.3.m3.2.2" xref="S2.p1.3.m3.2.2.cmml">𝐱</mi><mo id="S2.p1.3.m3.4.4.1.1.1.1.1.3.2.2" stretchy="false" xref="S2.p1.3.m3.4.4.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.p1.3.m3.4.4.1.1.1.1.3" xref="S2.p1.3.m3.4.4.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.3.m3.4b"><apply id="S2.p1.3.m3.4.4.cmml" xref="S2.p1.3.m3.4.4"><eq id="S2.p1.3.m3.4.4.2.cmml" xref="S2.p1.3.m3.4.4.2"></eq><apply id="S2.p1.3.m3.4.4.3.cmml" xref="S2.p1.3.m3.4.4.3"><times id="S2.p1.3.m3.4.4.3.1.cmml" xref="S2.p1.3.m3.4.4.3.1"></times><ci id="S2.p1.3.m3.4.4.3.2.cmml" xref="S2.p1.3.m3.4.4.3.2">𝑍</ci><apply id="S2.p1.3.m3.4.4.3.3.1.cmml" xref="S2.p1.3.m3.4.4.3.3.2"><csymbol cd="latexml" id="S2.p1.3.m3.4.4.3.3.1.1.cmml" xref="S2.p1.3.m3.4.4.3.3.2.1">delimited-[]</csymbol><ci id="S2.p1.3.m3.1.1.cmml" xref="S2.p1.3.m3.1.1">𝑓</ci></apply></apply><apply id="S2.p1.3.m3.4.4.1.cmml" xref="S2.p1.3.m3.4.4.1"><apply id="S2.p1.3.m3.4.4.1.2.cmml" xref="S2.p1.3.m3.4.4.1.2"><csymbol cd="ambiguous" id="S2.p1.3.m3.4.4.1.2.1.cmml" xref="S2.p1.3.m3.4.4.1.2">subscript</csymbol><sum id="S2.p1.3.m3.4.4.1.2.2.cmml" xref="S2.p1.3.m3.4.4.1.2.2"></sum><apply id="S2.p1.3.m3.4.4.1.2.3.cmml" xref="S2.p1.3.m3.4.4.1.2.3"><in id="S2.p1.3.m3.4.4.1.2.3.1.cmml" xref="S2.p1.3.m3.4.4.1.2.3.1"></in><ci id="S2.p1.3.m3.4.4.1.2.3.2.cmml" xref="S2.p1.3.m3.4.4.1.2.3.2">𝐱</ci><ci id="S2.p1.3.m3.4.4.1.2.3.3.cmml" xref="S2.p1.3.m3.4.4.1.2.3.3">𝒳</ci></apply></apply><apply id="S2.p1.3.m3.4.4.1.1.2.cmml" xref="S2.p1.3.m3.4.4.1.1.1"><exp id="S2.p1.3.m3.3.3.cmml" xref="S2.p1.3.m3.3.3"></exp><apply id="S2.p1.3.m3.4.4.1.1.1.1.1.cmml" xref="S2.p1.3.m3.4.4.1.1.1.1.1"><times id="S2.p1.3.m3.4.4.1.1.1.1.1.1.cmml" xref="S2.p1.3.m3.4.4.1.1.1.1.1.1"></times><ci id="S2.p1.3.m3.4.4.1.1.1.1.1.2.cmml" xref="S2.p1.3.m3.4.4.1.1.1.1.1.2">𝑓</ci><ci id="S2.p1.3.m3.2.2.cmml" xref="S2.p1.3.m3.2.2">𝐱</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.3.m3.4c">Z[f]=\sum_{\mathbf{x}\in\mathcal{X}}\exp\left(f(\mathbf{x})\right)</annotation><annotation encoding="application/x-llamapun" id="S2.p1.3.m3.4d">italic_Z [ italic_f ] = ∑ start_POSTSUBSCRIPT bold_x ∈ caligraphic_X end_POSTSUBSCRIPT roman_exp ( italic_f ( bold_x ) )</annotation></semantics></math>, known as the partition function,
is then a functional of <math alttext="f" class="ltx_Math" display="inline" id="S2.p1.4.m4.1"><semantics id="S2.p1.4.m4.1a"><mi id="S2.p1.4.m4.1.1" xref="S2.p1.4.m4.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S2.p1.4.m4.1b"><ci id="S2.p1.4.m4.1.1.cmml" xref="S2.p1.4.m4.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.4.m4.1c">f</annotation><annotation encoding="application/x-llamapun" id="S2.p1.4.m4.1d">italic_f</annotation></semantics></math> giving us the necessary normalizing constant.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p2">
<p class="ltx_p" id="S2.p2.3">This is the most flexible way one could represent a probability density function making essentially no compromises on its structure.
The downside to this is that for most interesting choices of <math alttext="\mathcal{F}" class="ltx_Math" display="inline" id="S2.p2.1.m1.1"><semantics id="S2.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p2.1.m1.1.1" xref="S2.p2.1.m1.1.1.cmml">ℱ</mi><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.1b"><ci id="S2.p2.1.m1.1.1.cmml" xref="S2.p2.1.m1.1.1">ℱ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.1c">\mathcal{F}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.1.m1.1d">caligraphic_F</annotation></semantics></math>, computing or estimating this normalizing constant is untractable which makes training these models difficult.
Their unnormalized nature, however, does not prevent EBMs from being useful in a number of applications besides sampling.
They can be used to perform inference over small enough groups of variables.
Partitioning the input space into a set of observed variables <math alttext="\mathbf{x}_{o}" class="ltx_Math" display="inline" id="S2.p2.2.m2.1"><semantics id="S2.p2.2.m2.1a"><msub id="S2.p2.2.m2.1.1" xref="S2.p2.2.m2.1.1.cmml"><mi id="S2.p2.2.m2.1.1.2" xref="S2.p2.2.m2.1.1.2.cmml">𝐱</mi><mi id="S2.p2.2.m2.1.1.3" xref="S2.p2.2.m2.1.1.3.cmml">o</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.2.m2.1b"><apply id="S2.p2.2.m2.1.1.cmml" xref="S2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.p2.2.m2.1.1.1.cmml" xref="S2.p2.2.m2.1.1">subscript</csymbol><ci id="S2.p2.2.m2.1.1.2.cmml" xref="S2.p2.2.m2.1.1.2">𝐱</ci><ci id="S2.p2.2.m2.1.1.3.cmml" xref="S2.p2.2.m2.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.2.m2.1c">\mathbf{x}_{o}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.2.m2.1d">bold_x start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT</annotation></semantics></math> and unobserved variables <math alttext="\mathbf{x}_{u}" class="ltx_Math" display="inline" id="S2.p2.3.m3.1"><semantics id="S2.p2.3.m3.1a"><msub id="S2.p2.3.m3.1.1" xref="S2.p2.3.m3.1.1.cmml"><mi id="S2.p2.3.m3.1.1.2" xref="S2.p2.3.m3.1.1.2.cmml">𝐱</mi><mi id="S2.p2.3.m3.1.1.3" xref="S2.p2.3.m3.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.3.m3.1b"><apply id="S2.p2.3.m3.1.1.cmml" xref="S2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.p2.3.m3.1.1.1.cmml" xref="S2.p2.3.m3.1.1">subscript</csymbol><ci id="S2.p2.3.m3.1.1.2.cmml" xref="S2.p2.3.m3.1.1.2">𝐱</ci><ci id="S2.p2.3.m3.1.1.3.cmml" xref="S2.p2.3.m3.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.3.m3.1c">\mathbf{x}_{u}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.3.m3.1d">bold_x start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> we have</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="q_{f}(\mathbf{x}_{u}|\mathbf{x}_{o})=\frac{\exp\left(f(\mathbf{x}_{u},\mathbf{%
x}_{o})\right)}{\sum_{\mathbf{x}^{\prime}_{u}}\exp\left(f(\mathbf{x}^{\prime}_%
{u},\mathbf{x}_{o})\right)}\,," class="ltx_Math" display="block" id="S2.E2.m1.5"><semantics id="S2.E2.m1.5a"><mrow id="S2.E2.m1.5.5.1" xref="S2.E2.m1.5.5.1.1.cmml"><mrow id="S2.E2.m1.5.5.1.1" xref="S2.E2.m1.5.5.1.1.cmml"><mrow id="S2.E2.m1.5.5.1.1.1" xref="S2.E2.m1.5.5.1.1.1.cmml"><msub id="S2.E2.m1.5.5.1.1.1.3" xref="S2.E2.m1.5.5.1.1.1.3.cmml"><mi id="S2.E2.m1.5.5.1.1.1.3.2" xref="S2.E2.m1.5.5.1.1.1.3.2.cmml">q</mi><mi id="S2.E2.m1.5.5.1.1.1.3.3" xref="S2.E2.m1.5.5.1.1.1.3.3.cmml">f</mi></msub><mo id="S2.E2.m1.5.5.1.1.1.2" xref="S2.E2.m1.5.5.1.1.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.5.5.1.1.1.1.1" xref="S2.E2.m1.5.5.1.1.1.1.1.1.cmml"><mo id="S2.E2.m1.5.5.1.1.1.1.1.2" stretchy="false" xref="S2.E2.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.5.5.1.1.1.1.1.1" xref="S2.E2.m1.5.5.1.1.1.1.1.1.cmml"><msub id="S2.E2.m1.5.5.1.1.1.1.1.1.2" xref="S2.E2.m1.5.5.1.1.1.1.1.1.2.cmml"><mi id="S2.E2.m1.5.5.1.1.1.1.1.1.2.2" xref="S2.E2.m1.5.5.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S2.E2.m1.5.5.1.1.1.1.1.1.2.3" xref="S2.E2.m1.5.5.1.1.1.1.1.1.2.3.cmml">u</mi></msub><mo fence="false" id="S2.E2.m1.5.5.1.1.1.1.1.1.1" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.cmml">|</mo><msub id="S2.E2.m1.5.5.1.1.1.1.1.1.3" xref="S2.E2.m1.5.5.1.1.1.1.1.1.3.cmml"><mi id="S2.E2.m1.5.5.1.1.1.1.1.1.3.2" xref="S2.E2.m1.5.5.1.1.1.1.1.1.3.2.cmml">𝐱</mi><mi id="S2.E2.m1.5.5.1.1.1.1.1.1.3.3" xref="S2.E2.m1.5.5.1.1.1.1.1.1.3.3.cmml">o</mi></msub></mrow><mo id="S2.E2.m1.5.5.1.1.1.1.1.3" stretchy="false" xref="S2.E2.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.5.5.1.1.2" xref="S2.E2.m1.5.5.1.1.2.cmml">=</mo><mfrac id="S2.E2.m1.4.4" xref="S2.E2.m1.4.4.cmml"><mrow id="S2.E2.m1.2.2.2.2" xref="S2.E2.m1.2.2.2.3.cmml"><mi id="S2.E2.m1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml">exp</mi><mo id="S2.E2.m1.2.2.2.2a" xref="S2.E2.m1.2.2.2.3.cmml">⁡</mo><mrow id="S2.E2.m1.2.2.2.2.1" xref="S2.E2.m1.2.2.2.3.cmml"><mo id="S2.E2.m1.2.2.2.2.1.2" xref="S2.E2.m1.2.2.2.3.cmml">(</mo><mrow id="S2.E2.m1.2.2.2.2.1.1" xref="S2.E2.m1.2.2.2.2.1.1.cmml"><mi id="S2.E2.m1.2.2.2.2.1.1.4" xref="S2.E2.m1.2.2.2.2.1.1.4.cmml">f</mi><mo id="S2.E2.m1.2.2.2.2.1.1.3" xref="S2.E2.m1.2.2.2.2.1.1.3.cmml">⁢</mo><mrow id="S2.E2.m1.2.2.2.2.1.1.2.2" xref="S2.E2.m1.2.2.2.2.1.1.2.3.cmml"><mo id="S2.E2.m1.2.2.2.2.1.1.2.2.3" stretchy="false" xref="S2.E2.m1.2.2.2.2.1.1.2.3.cmml">(</mo><msub id="S2.E2.m1.2.2.2.2.1.1.1.1.1" xref="S2.E2.m1.2.2.2.2.1.1.1.1.1.cmml"><mi id="S2.E2.m1.2.2.2.2.1.1.1.1.1.2" xref="S2.E2.m1.2.2.2.2.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S2.E2.m1.2.2.2.2.1.1.1.1.1.3" xref="S2.E2.m1.2.2.2.2.1.1.1.1.1.3.cmml">u</mi></msub><mo id="S2.E2.m1.2.2.2.2.1.1.2.2.4" xref="S2.E2.m1.2.2.2.2.1.1.2.3.cmml">,</mo><msub id="S2.E2.m1.2.2.2.2.1.1.2.2.2" xref="S2.E2.m1.2.2.2.2.1.1.2.2.2.cmml"><mi id="S2.E2.m1.2.2.2.2.1.1.2.2.2.2" xref="S2.E2.m1.2.2.2.2.1.1.2.2.2.2.cmml">𝐱</mi><mi id="S2.E2.m1.2.2.2.2.1.1.2.2.2.3" xref="S2.E2.m1.2.2.2.2.1.1.2.2.2.3.cmml">o</mi></msub><mo id="S2.E2.m1.2.2.2.2.1.1.2.2.5" stretchy="false" xref="S2.E2.m1.2.2.2.2.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.2.2.2.2.1.3" xref="S2.E2.m1.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="S2.E2.m1.4.4.4" xref="S2.E2.m1.4.4.4.cmml"><msub id="S2.E2.m1.4.4.4.3" xref="S2.E2.m1.4.4.4.3.cmml"><mo id="S2.E2.m1.4.4.4.3.2" xref="S2.E2.m1.4.4.4.3.2.cmml">∑</mo><msubsup id="S2.E2.m1.4.4.4.3.3" xref="S2.E2.m1.4.4.4.3.3.cmml"><mi id="S2.E2.m1.4.4.4.3.3.2.2" xref="S2.E2.m1.4.4.4.3.3.2.2.cmml">𝐱</mi><mi id="S2.E2.m1.4.4.4.3.3.3" xref="S2.E2.m1.4.4.4.3.3.3.cmml">u</mi><mo id="S2.E2.m1.4.4.4.3.3.2.3" xref="S2.E2.m1.4.4.4.3.3.2.3.cmml">′</mo></msubsup></msub><mrow id="S2.E2.m1.4.4.4.2.1" xref="S2.E2.m1.4.4.4.2.2.cmml"><mi id="S2.E2.m1.3.3.3.1" xref="S2.E2.m1.3.3.3.1.cmml">exp</mi><mo id="S2.E2.m1.4.4.4.2.1a" xref="S2.E2.m1.4.4.4.2.2.cmml">⁡</mo><mrow id="S2.E2.m1.4.4.4.2.1.1" xref="S2.E2.m1.4.4.4.2.2.cmml"><mo id="S2.E2.m1.4.4.4.2.1.1.2" xref="S2.E2.m1.4.4.4.2.2.cmml">(</mo><mrow id="S2.E2.m1.4.4.4.2.1.1.1" xref="S2.E2.m1.4.4.4.2.1.1.1.cmml"><mi id="S2.E2.m1.4.4.4.2.1.1.1.4" xref="S2.E2.m1.4.4.4.2.1.1.1.4.cmml">f</mi><mo id="S2.E2.m1.4.4.4.2.1.1.1.3" xref="S2.E2.m1.4.4.4.2.1.1.1.3.cmml">⁢</mo><mrow id="S2.E2.m1.4.4.4.2.1.1.1.2.2" xref="S2.E2.m1.4.4.4.2.1.1.1.2.3.cmml"><mo id="S2.E2.m1.4.4.4.2.1.1.1.2.2.3" stretchy="false" xref="S2.E2.m1.4.4.4.2.1.1.1.2.3.cmml">(</mo><msubsup id="S2.E2.m1.4.4.4.2.1.1.1.1.1.1" xref="S2.E2.m1.4.4.4.2.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.4.4.4.2.1.1.1.1.1.1.2.2" xref="S2.E2.m1.4.4.4.2.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S2.E2.m1.4.4.4.2.1.1.1.1.1.1.3" xref="S2.E2.m1.4.4.4.2.1.1.1.1.1.1.3.cmml">u</mi><mo id="S2.E2.m1.4.4.4.2.1.1.1.1.1.1.2.3" xref="S2.E2.m1.4.4.4.2.1.1.1.1.1.1.2.3.cmml">′</mo></msubsup><mo id="S2.E2.m1.4.4.4.2.1.1.1.2.2.4" xref="S2.E2.m1.4.4.4.2.1.1.1.2.3.cmml">,</mo><msub id="S2.E2.m1.4.4.4.2.1.1.1.2.2.2" xref="S2.E2.m1.4.4.4.2.1.1.1.2.2.2.cmml"><mi id="S2.E2.m1.4.4.4.2.1.1.1.2.2.2.2" xref="S2.E2.m1.4.4.4.2.1.1.1.2.2.2.2.cmml">𝐱</mi><mi id="S2.E2.m1.4.4.4.2.1.1.1.2.2.2.3" xref="S2.E2.m1.4.4.4.2.1.1.1.2.2.2.3.cmml">o</mi></msub><mo id="S2.E2.m1.4.4.4.2.1.1.1.2.2.5" stretchy="false" xref="S2.E2.m1.4.4.4.2.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.4.4.4.2.1.1.3" xref="S2.E2.m1.4.4.4.2.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><mo id="S2.E2.m1.5.5.1.2" lspace="0.170em" xref="S2.E2.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.5b"><apply id="S2.E2.m1.5.5.1.1.cmml" xref="S2.E2.m1.5.5.1"><eq id="S2.E2.m1.5.5.1.1.2.cmml" xref="S2.E2.m1.5.5.1.1.2"></eq><apply id="S2.E2.m1.5.5.1.1.1.cmml" xref="S2.E2.m1.5.5.1.1.1"><times id="S2.E2.m1.5.5.1.1.1.2.cmml" xref="S2.E2.m1.5.5.1.1.1.2"></times><apply id="S2.E2.m1.5.5.1.1.1.3.cmml" xref="S2.E2.m1.5.5.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.1.3.1.cmml" xref="S2.E2.m1.5.5.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.5.5.1.1.1.3.2.cmml" xref="S2.E2.m1.5.5.1.1.1.3.2">𝑞</ci><ci id="S2.E2.m1.5.5.1.1.1.3.3.cmml" xref="S2.E2.m1.5.5.1.1.1.3.3">𝑓</ci></apply><apply id="S2.E2.m1.5.5.1.1.1.1.1.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.E2.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E2.m1.5.5.1.1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.2.2">𝐱</ci><ci id="S2.E2.m1.5.5.1.1.1.1.1.1.2.3.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.2.3">𝑢</ci></apply><apply id="S2.E2.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.5.5.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.3.2">𝐱</ci><ci id="S2.E2.m1.5.5.1.1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.3.3">𝑜</ci></apply></apply></apply><apply id="S2.E2.m1.4.4.cmml" xref="S2.E2.m1.4.4"><divide id="S2.E2.m1.4.4.5.cmml" xref="S2.E2.m1.4.4"></divide><apply id="S2.E2.m1.2.2.2.3.cmml" xref="S2.E2.m1.2.2.2.2"><exp id="S2.E2.m1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1"></exp><apply id="S2.E2.m1.2.2.2.2.1.1.cmml" xref="S2.E2.m1.2.2.2.2.1.1"><times id="S2.E2.m1.2.2.2.2.1.1.3.cmml" xref="S2.E2.m1.2.2.2.2.1.1.3"></times><ci id="S2.E2.m1.2.2.2.2.1.1.4.cmml" xref="S2.E2.m1.2.2.2.2.1.1.4">𝑓</ci><interval closure="open" id="S2.E2.m1.2.2.2.2.1.1.2.3.cmml" xref="S2.E2.m1.2.2.2.2.1.1.2.2"><apply id="S2.E2.m1.2.2.2.2.1.1.1.1.1.cmml" xref="S2.E2.m1.2.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.2.2.1.1.1.1.1.1.cmml" xref="S2.E2.m1.2.2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.2.2.2.2.1.1.1.1.1.2.cmml" xref="S2.E2.m1.2.2.2.2.1.1.1.1.1.2">𝐱</ci><ci id="S2.E2.m1.2.2.2.2.1.1.1.1.1.3.cmml" xref="S2.E2.m1.2.2.2.2.1.1.1.1.1.3">𝑢</ci></apply><apply id="S2.E2.m1.2.2.2.2.1.1.2.2.2.cmml" xref="S2.E2.m1.2.2.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.2.2.1.1.2.2.2.1.cmml" xref="S2.E2.m1.2.2.2.2.1.1.2.2.2">subscript</csymbol><ci id="S2.E2.m1.2.2.2.2.1.1.2.2.2.2.cmml" xref="S2.E2.m1.2.2.2.2.1.1.2.2.2.2">𝐱</ci><ci id="S2.E2.m1.2.2.2.2.1.1.2.2.2.3.cmml" xref="S2.E2.m1.2.2.2.2.1.1.2.2.2.3">𝑜</ci></apply></interval></apply></apply><apply id="S2.E2.m1.4.4.4.cmml" xref="S2.E2.m1.4.4.4"><apply id="S2.E2.m1.4.4.4.3.cmml" xref="S2.E2.m1.4.4.4.3"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.4.3.1.cmml" xref="S2.E2.m1.4.4.4.3">subscript</csymbol><sum id="S2.E2.m1.4.4.4.3.2.cmml" xref="S2.E2.m1.4.4.4.3.2"></sum><apply id="S2.E2.m1.4.4.4.3.3.cmml" xref="S2.E2.m1.4.4.4.3.3"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.4.3.3.1.cmml" xref="S2.E2.m1.4.4.4.3.3">subscript</csymbol><apply id="S2.E2.m1.4.4.4.3.3.2.cmml" xref="S2.E2.m1.4.4.4.3.3"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.4.3.3.2.1.cmml" xref="S2.E2.m1.4.4.4.3.3">superscript</csymbol><ci id="S2.E2.m1.4.4.4.3.3.2.2.cmml" xref="S2.E2.m1.4.4.4.3.3.2.2">𝐱</ci><ci id="S2.E2.m1.4.4.4.3.3.2.3.cmml" xref="S2.E2.m1.4.4.4.3.3.2.3">′</ci></apply><ci id="S2.E2.m1.4.4.4.3.3.3.cmml" xref="S2.E2.m1.4.4.4.3.3.3">𝑢</ci></apply></apply><apply id="S2.E2.m1.4.4.4.2.2.cmml" xref="S2.E2.m1.4.4.4.2.1"><exp id="S2.E2.m1.3.3.3.1.cmml" xref="S2.E2.m1.3.3.3.1"></exp><apply id="S2.E2.m1.4.4.4.2.1.1.1.cmml" xref="S2.E2.m1.4.4.4.2.1.1.1"><times id="S2.E2.m1.4.4.4.2.1.1.1.3.cmml" xref="S2.E2.m1.4.4.4.2.1.1.1.3"></times><ci id="S2.E2.m1.4.4.4.2.1.1.1.4.cmml" xref="S2.E2.m1.4.4.4.2.1.1.1.4">𝑓</ci><interval closure="open" id="S2.E2.m1.4.4.4.2.1.1.1.2.3.cmml" xref="S2.E2.m1.4.4.4.2.1.1.1.2.2"><apply id="S2.E2.m1.4.4.4.2.1.1.1.1.1.1.cmml" xref="S2.E2.m1.4.4.4.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.4.2.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.4.4.4.2.1.1.1.1.1.1">subscript</csymbol><apply id="S2.E2.m1.4.4.4.2.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.4.4.4.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.4.2.1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.4.4.4.2.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E2.m1.4.4.4.2.1.1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.4.4.4.2.1.1.1.1.1.1.2.2">𝐱</ci><ci id="S2.E2.m1.4.4.4.2.1.1.1.1.1.1.2.3.cmml" xref="S2.E2.m1.4.4.4.2.1.1.1.1.1.1.2.3">′</ci></apply><ci id="S2.E2.m1.4.4.4.2.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.4.4.4.2.1.1.1.1.1.1.3">𝑢</ci></apply><apply id="S2.E2.m1.4.4.4.2.1.1.1.2.2.2.cmml" xref="S2.E2.m1.4.4.4.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.4.2.1.1.1.2.2.2.1.cmml" xref="S2.E2.m1.4.4.4.2.1.1.1.2.2.2">subscript</csymbol><ci id="S2.E2.m1.4.4.4.2.1.1.1.2.2.2.2.cmml" xref="S2.E2.m1.4.4.4.2.1.1.1.2.2.2.2">𝐱</ci><ci id="S2.E2.m1.4.4.4.2.1.1.1.2.2.2.3.cmml" xref="S2.E2.m1.4.4.4.2.1.1.1.2.2.2.3">𝑜</ci></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.5c">q_{f}(\mathbf{x}_{u}|\mathbf{x}_{o})=\frac{\exp\left(f(\mathbf{x}_{u},\mathbf{%
x}_{o})\right)}{\sum_{\mathbf{x}^{\prime}_{u}}\exp\left(f(\mathbf{x}^{\prime}_%
{u},\mathbf{x}_{o})\right)}\,,</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.5d">italic_q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT | bold_x start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT ) = divide start_ARG roman_exp ( italic_f ( bold_x start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT , bold_x start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT ) ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT bold_x start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT end_POSTSUBSCRIPT roman_exp ( italic_f ( bold_x start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT , bold_x start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT ) ) end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p2.4">which only involves normalizing (i.e., computing a softmax) over the possible values of the unobserved variables.
Furthermore, for anomaly or out of distribution detection, knowledge of the normalizing constant is not necessary.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p3">
<p class="ltx_p" id="S2.p3.3">One common way to train an energy-based model to approximate a data generating distribution, <math alttext="p(\mathbf{x})" class="ltx_Math" display="inline" id="S2.p3.1.m1.1"><semantics id="S2.p3.1.m1.1a"><mrow id="S2.p3.1.m1.1.2" xref="S2.p3.1.m1.1.2.cmml"><mi id="S2.p3.1.m1.1.2.2" xref="S2.p3.1.m1.1.2.2.cmml">p</mi><mo id="S2.p3.1.m1.1.2.1" xref="S2.p3.1.m1.1.2.1.cmml">⁢</mo><mrow id="S2.p3.1.m1.1.2.3.2" xref="S2.p3.1.m1.1.2.cmml"><mo id="S2.p3.1.m1.1.2.3.2.1" stretchy="false" xref="S2.p3.1.m1.1.2.cmml">(</mo><mi id="S2.p3.1.m1.1.1" xref="S2.p3.1.m1.1.1.cmml">𝐱</mi><mo id="S2.p3.1.m1.1.2.3.2.2" stretchy="false" xref="S2.p3.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.1.m1.1b"><apply id="S2.p3.1.m1.1.2.cmml" xref="S2.p3.1.m1.1.2"><times id="S2.p3.1.m1.1.2.1.cmml" xref="S2.p3.1.m1.1.2.1"></times><ci id="S2.p3.1.m1.1.2.2.cmml" xref="S2.p3.1.m1.1.2.2">𝑝</ci><ci id="S2.p3.1.m1.1.1.cmml" xref="S2.p3.1.m1.1.1">𝐱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.1.m1.1c">p(\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="S2.p3.1.m1.1d">italic_p ( bold_x )</annotation></semantics></math>, is to minimize the Kullback-Leibler divergence between <math alttext="p" class="ltx_Math" display="inline" id="S2.p3.2.m2.1"><semantics id="S2.p3.2.m2.1a"><mi id="S2.p3.2.m2.1.1" xref="S2.p3.2.m2.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S2.p3.2.m2.1b"><ci id="S2.p3.2.m2.1.1.cmml" xref="S2.p3.2.m2.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.2.m2.1c">p</annotation><annotation encoding="application/x-llamapun" id="S2.p3.2.m2.1d">italic_p</annotation></semantics></math> and <math alttext="q_{f}" class="ltx_Math" display="inline" id="S2.p3.3.m3.1"><semantics id="S2.p3.3.m3.1a"><msub id="S2.p3.3.m3.1.1" xref="S2.p3.3.m3.1.1.cmml"><mi id="S2.p3.3.m3.1.1.2" xref="S2.p3.3.m3.1.1.2.cmml">q</mi><mi id="S2.p3.3.m3.1.1.3" xref="S2.p3.3.m3.1.1.3.cmml">f</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p3.3.m3.1b"><apply id="S2.p3.3.m3.1.1.cmml" xref="S2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S2.p3.3.m3.1.1.1.cmml" xref="S2.p3.3.m3.1.1">subscript</csymbol><ci id="S2.p3.3.m3.1.1.2.cmml" xref="S2.p3.3.m3.1.1.2">𝑞</ci><ci id="S2.p3.3.m3.1.1.3.cmml" xref="S2.p3.3.m3.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.3.m3.1c">q_{f}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.3.m3.1d">italic_q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT</annotation></semantics></math>, or equivalently,
maximize the expected log likelihood functional:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="L[f]=\mathbb{E}_{\mathbf{x}\sim p}\log q_{f}(\mathbf{x})=\mathbb{E}_{\mathbf{x%
}\sim p}f(\mathbf{x})-\log Z[f]\,." class="ltx_Math" display="block" id="S2.E3.m1.5"><semantics id="S2.E3.m1.5a"><mrow id="S2.E3.m1.5.5.1" xref="S2.E3.m1.5.5.1.1.cmml"><mrow id="S2.E3.m1.5.5.1.1" xref="S2.E3.m1.5.5.1.1.cmml"><mrow id="S2.E3.m1.5.5.1.1.2" xref="S2.E3.m1.5.5.1.1.2.cmml"><mi id="S2.E3.m1.5.5.1.1.2.2" xref="S2.E3.m1.5.5.1.1.2.2.cmml">L</mi><mo id="S2.E3.m1.5.5.1.1.2.1" xref="S2.E3.m1.5.5.1.1.2.1.cmml">⁢</mo><mrow id="S2.E3.m1.5.5.1.1.2.3.2" xref="S2.E3.m1.5.5.1.1.2.3.1.cmml"><mo id="S2.E3.m1.5.5.1.1.2.3.2.1" stretchy="false" xref="S2.E3.m1.5.5.1.1.2.3.1.1.cmml">[</mo><mi id="S2.E3.m1.1.1" xref="S2.E3.m1.1.1.cmml">f</mi><mo id="S2.E3.m1.5.5.1.1.2.3.2.2" stretchy="false" xref="S2.E3.m1.5.5.1.1.2.3.1.1.cmml">]</mo></mrow></mrow><mo id="S2.E3.m1.5.5.1.1.3" xref="S2.E3.m1.5.5.1.1.3.cmml">=</mo><mrow id="S2.E3.m1.5.5.1.1.4" xref="S2.E3.m1.5.5.1.1.4.cmml"><msub id="S2.E3.m1.5.5.1.1.4.2" xref="S2.E3.m1.5.5.1.1.4.2.cmml"><mi id="S2.E3.m1.5.5.1.1.4.2.2" xref="S2.E3.m1.5.5.1.1.4.2.2.cmml">𝔼</mi><mrow id="S2.E3.m1.5.5.1.1.4.2.3" xref="S2.E3.m1.5.5.1.1.4.2.3.cmml"><mi id="S2.E3.m1.5.5.1.1.4.2.3.2" xref="S2.E3.m1.5.5.1.1.4.2.3.2.cmml">𝐱</mi><mo id="S2.E3.m1.5.5.1.1.4.2.3.1" xref="S2.E3.m1.5.5.1.1.4.2.3.1.cmml">∼</mo><mi id="S2.E3.m1.5.5.1.1.4.2.3.3" xref="S2.E3.m1.5.5.1.1.4.2.3.3.cmml">p</mi></mrow></msub><mo id="S2.E3.m1.5.5.1.1.4.1" lspace="0.167em" xref="S2.E3.m1.5.5.1.1.4.1.cmml">⁢</mo><mrow id="S2.E3.m1.5.5.1.1.4.3" xref="S2.E3.m1.5.5.1.1.4.3.cmml"><mi id="S2.E3.m1.5.5.1.1.4.3.1" xref="S2.E3.m1.5.5.1.1.4.3.1.cmml">log</mi><mo id="S2.E3.m1.5.5.1.1.4.3a" lspace="0.167em" xref="S2.E3.m1.5.5.1.1.4.3.cmml">⁡</mo><msub id="S2.E3.m1.5.5.1.1.4.3.2" xref="S2.E3.m1.5.5.1.1.4.3.2.cmml"><mi id="S2.E3.m1.5.5.1.1.4.3.2.2" xref="S2.E3.m1.5.5.1.1.4.3.2.2.cmml">q</mi><mi id="S2.E3.m1.5.5.1.1.4.3.2.3" xref="S2.E3.m1.5.5.1.1.4.3.2.3.cmml">f</mi></msub></mrow><mo id="S2.E3.m1.5.5.1.1.4.1a" xref="S2.E3.m1.5.5.1.1.4.1.cmml">⁢</mo><mrow id="S2.E3.m1.5.5.1.1.4.4.2" xref="S2.E3.m1.5.5.1.1.4.cmml"><mo id="S2.E3.m1.5.5.1.1.4.4.2.1" stretchy="false" xref="S2.E3.m1.5.5.1.1.4.cmml">(</mo><mi id="S2.E3.m1.2.2" xref="S2.E3.m1.2.2.cmml">𝐱</mi><mo id="S2.E3.m1.5.5.1.1.4.4.2.2" stretchy="false" xref="S2.E3.m1.5.5.1.1.4.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.5.5.1.1.5" xref="S2.E3.m1.5.5.1.1.5.cmml">=</mo><mrow id="S2.E3.m1.5.5.1.1.6" xref="S2.E3.m1.5.5.1.1.6.cmml"><mrow id="S2.E3.m1.5.5.1.1.6.2" xref="S2.E3.m1.5.5.1.1.6.2.cmml"><msub id="S2.E3.m1.5.5.1.1.6.2.2" xref="S2.E3.m1.5.5.1.1.6.2.2.cmml"><mi id="S2.E3.m1.5.5.1.1.6.2.2.2" xref="S2.E3.m1.5.5.1.1.6.2.2.2.cmml">𝔼</mi><mrow id="S2.E3.m1.5.5.1.1.6.2.2.3" xref="S2.E3.m1.5.5.1.1.6.2.2.3.cmml"><mi id="S2.E3.m1.5.5.1.1.6.2.2.3.2" xref="S2.E3.m1.5.5.1.1.6.2.2.3.2.cmml">𝐱</mi><mo id="S2.E3.m1.5.5.1.1.6.2.2.3.1" xref="S2.E3.m1.5.5.1.1.6.2.2.3.1.cmml">∼</mo><mi id="S2.E3.m1.5.5.1.1.6.2.2.3.3" xref="S2.E3.m1.5.5.1.1.6.2.2.3.3.cmml">p</mi></mrow></msub><mo id="S2.E3.m1.5.5.1.1.6.2.1" xref="S2.E3.m1.5.5.1.1.6.2.1.cmml">⁢</mo><mi id="S2.E3.m1.5.5.1.1.6.2.3" xref="S2.E3.m1.5.5.1.1.6.2.3.cmml">f</mi><mo id="S2.E3.m1.5.5.1.1.6.2.1a" xref="S2.E3.m1.5.5.1.1.6.2.1.cmml">⁢</mo><mrow id="S2.E3.m1.5.5.1.1.6.2.4.2" xref="S2.E3.m1.5.5.1.1.6.2.cmml"><mo id="S2.E3.m1.5.5.1.1.6.2.4.2.1" stretchy="false" xref="S2.E3.m1.5.5.1.1.6.2.cmml">(</mo><mi id="S2.E3.m1.3.3" xref="S2.E3.m1.3.3.cmml">𝐱</mi><mo id="S2.E3.m1.5.5.1.1.6.2.4.2.2" stretchy="false" xref="S2.E3.m1.5.5.1.1.6.2.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.5.5.1.1.6.1" xref="S2.E3.m1.5.5.1.1.6.1.cmml">−</mo><mrow id="S2.E3.m1.5.5.1.1.6.3" xref="S2.E3.m1.5.5.1.1.6.3.cmml"><mrow id="S2.E3.m1.5.5.1.1.6.3.2" xref="S2.E3.m1.5.5.1.1.6.3.2.cmml"><mi id="S2.E3.m1.5.5.1.1.6.3.2.1" xref="S2.E3.m1.5.5.1.1.6.3.2.1.cmml">log</mi><mo id="S2.E3.m1.5.5.1.1.6.3.2a" lspace="0.167em" xref="S2.E3.m1.5.5.1.1.6.3.2.cmml">⁡</mo><mi id="S2.E3.m1.5.5.1.1.6.3.2.2" xref="S2.E3.m1.5.5.1.1.6.3.2.2.cmml">Z</mi></mrow><mo id="S2.E3.m1.5.5.1.1.6.3.1" xref="S2.E3.m1.5.5.1.1.6.3.1.cmml">⁢</mo><mrow id="S2.E3.m1.5.5.1.1.6.3.3.2" xref="S2.E3.m1.5.5.1.1.6.3.3.1.cmml"><mo id="S2.E3.m1.5.5.1.1.6.3.3.2.1" stretchy="false" xref="S2.E3.m1.5.5.1.1.6.3.3.1.1.cmml">[</mo><mi id="S2.E3.m1.4.4" xref="S2.E3.m1.4.4.cmml">f</mi><mo id="S2.E3.m1.5.5.1.1.6.3.3.2.2" stretchy="false" xref="S2.E3.m1.5.5.1.1.6.3.3.1.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo id="S2.E3.m1.5.5.1.2" lspace="0.170em" xref="S2.E3.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.5b"><apply id="S2.E3.m1.5.5.1.1.cmml" xref="S2.E3.m1.5.5.1"><and id="S2.E3.m1.5.5.1.1a.cmml" xref="S2.E3.m1.5.5.1"></and><apply id="S2.E3.m1.5.5.1.1b.cmml" xref="S2.E3.m1.5.5.1"><eq id="S2.E3.m1.5.5.1.1.3.cmml" xref="S2.E3.m1.5.5.1.1.3"></eq><apply id="S2.E3.m1.5.5.1.1.2.cmml" xref="S2.E3.m1.5.5.1.1.2"><times id="S2.E3.m1.5.5.1.1.2.1.cmml" xref="S2.E3.m1.5.5.1.1.2.1"></times><ci id="S2.E3.m1.5.5.1.1.2.2.cmml" xref="S2.E3.m1.5.5.1.1.2.2">𝐿</ci><apply id="S2.E3.m1.5.5.1.1.2.3.1.cmml" xref="S2.E3.m1.5.5.1.1.2.3.2"><csymbol cd="latexml" id="S2.E3.m1.5.5.1.1.2.3.1.1.cmml" xref="S2.E3.m1.5.5.1.1.2.3.2.1">delimited-[]</csymbol><ci id="S2.E3.m1.1.1.cmml" xref="S2.E3.m1.1.1">𝑓</ci></apply></apply><apply id="S2.E3.m1.5.5.1.1.4.cmml" xref="S2.E3.m1.5.5.1.1.4"><times id="S2.E3.m1.5.5.1.1.4.1.cmml" xref="S2.E3.m1.5.5.1.1.4.1"></times><apply id="S2.E3.m1.5.5.1.1.4.2.cmml" xref="S2.E3.m1.5.5.1.1.4.2"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.1.1.4.2.1.cmml" xref="S2.E3.m1.5.5.1.1.4.2">subscript</csymbol><ci id="S2.E3.m1.5.5.1.1.4.2.2.cmml" xref="S2.E3.m1.5.5.1.1.4.2.2">𝔼</ci><apply id="S2.E3.m1.5.5.1.1.4.2.3.cmml" xref="S2.E3.m1.5.5.1.1.4.2.3"><csymbol cd="latexml" id="S2.E3.m1.5.5.1.1.4.2.3.1.cmml" xref="S2.E3.m1.5.5.1.1.4.2.3.1">similar-to</csymbol><ci id="S2.E3.m1.5.5.1.1.4.2.3.2.cmml" xref="S2.E3.m1.5.5.1.1.4.2.3.2">𝐱</ci><ci id="S2.E3.m1.5.5.1.1.4.2.3.3.cmml" xref="S2.E3.m1.5.5.1.1.4.2.3.3">𝑝</ci></apply></apply><apply id="S2.E3.m1.5.5.1.1.4.3.cmml" xref="S2.E3.m1.5.5.1.1.4.3"><log id="S2.E3.m1.5.5.1.1.4.3.1.cmml" xref="S2.E3.m1.5.5.1.1.4.3.1"></log><apply id="S2.E3.m1.5.5.1.1.4.3.2.cmml" xref="S2.E3.m1.5.5.1.1.4.3.2"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.1.1.4.3.2.1.cmml" xref="S2.E3.m1.5.5.1.1.4.3.2">subscript</csymbol><ci id="S2.E3.m1.5.5.1.1.4.3.2.2.cmml" xref="S2.E3.m1.5.5.1.1.4.3.2.2">𝑞</ci><ci id="S2.E3.m1.5.5.1.1.4.3.2.3.cmml" xref="S2.E3.m1.5.5.1.1.4.3.2.3">𝑓</ci></apply></apply><ci id="S2.E3.m1.2.2.cmml" xref="S2.E3.m1.2.2">𝐱</ci></apply></apply><apply id="S2.E3.m1.5.5.1.1c.cmml" xref="S2.E3.m1.5.5.1"><eq id="S2.E3.m1.5.5.1.1.5.cmml" xref="S2.E3.m1.5.5.1.1.5"></eq><share href="https://arxiv.org/html/2410.03535v1#S2.E3.m1.5.5.1.1.4.cmml" id="S2.E3.m1.5.5.1.1d.cmml" xref="S2.E3.m1.5.5.1"></share><apply id="S2.E3.m1.5.5.1.1.6.cmml" xref="S2.E3.m1.5.5.1.1.6"><minus id="S2.E3.m1.5.5.1.1.6.1.cmml" xref="S2.E3.m1.5.5.1.1.6.1"></minus><apply id="S2.E3.m1.5.5.1.1.6.2.cmml" xref="S2.E3.m1.5.5.1.1.6.2"><times id="S2.E3.m1.5.5.1.1.6.2.1.cmml" xref="S2.E3.m1.5.5.1.1.6.2.1"></times><apply id="S2.E3.m1.5.5.1.1.6.2.2.cmml" xref="S2.E3.m1.5.5.1.1.6.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.1.1.6.2.2.1.cmml" xref="S2.E3.m1.5.5.1.1.6.2.2">subscript</csymbol><ci id="S2.E3.m1.5.5.1.1.6.2.2.2.cmml" xref="S2.E3.m1.5.5.1.1.6.2.2.2">𝔼</ci><apply id="S2.E3.m1.5.5.1.1.6.2.2.3.cmml" xref="S2.E3.m1.5.5.1.1.6.2.2.3"><csymbol cd="latexml" id="S2.E3.m1.5.5.1.1.6.2.2.3.1.cmml" xref="S2.E3.m1.5.5.1.1.6.2.2.3.1">similar-to</csymbol><ci id="S2.E3.m1.5.5.1.1.6.2.2.3.2.cmml" xref="S2.E3.m1.5.5.1.1.6.2.2.3.2">𝐱</ci><ci id="S2.E3.m1.5.5.1.1.6.2.2.3.3.cmml" xref="S2.E3.m1.5.5.1.1.6.2.2.3.3">𝑝</ci></apply></apply><ci id="S2.E3.m1.5.5.1.1.6.2.3.cmml" xref="S2.E3.m1.5.5.1.1.6.2.3">𝑓</ci><ci id="S2.E3.m1.3.3.cmml" xref="S2.E3.m1.3.3">𝐱</ci></apply><apply id="S2.E3.m1.5.5.1.1.6.3.cmml" xref="S2.E3.m1.5.5.1.1.6.3"><times id="S2.E3.m1.5.5.1.1.6.3.1.cmml" xref="S2.E3.m1.5.5.1.1.6.3.1"></times><apply id="S2.E3.m1.5.5.1.1.6.3.2.cmml" xref="S2.E3.m1.5.5.1.1.6.3.2"><log id="S2.E3.m1.5.5.1.1.6.3.2.1.cmml" xref="S2.E3.m1.5.5.1.1.6.3.2.1"></log><ci id="S2.E3.m1.5.5.1.1.6.3.2.2.cmml" xref="S2.E3.m1.5.5.1.1.6.3.2.2">𝑍</ci></apply><apply id="S2.E3.m1.5.5.1.1.6.3.3.1.cmml" xref="S2.E3.m1.5.5.1.1.6.3.3.2"><csymbol cd="latexml" id="S2.E3.m1.5.5.1.1.6.3.3.1.1.cmml" xref="S2.E3.m1.5.5.1.1.6.3.3.2.1">delimited-[]</csymbol><ci id="S2.E3.m1.4.4.cmml" xref="S2.E3.m1.4.4">𝑓</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.5c">L[f]=\mathbb{E}_{\mathbf{x}\sim p}\log q_{f}(\mathbf{x})=\mathbb{E}_{\mathbf{x%
}\sim p}f(\mathbf{x})-\log Z[f]\,.</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.5d">italic_L [ italic_f ] = blackboard_E start_POSTSUBSCRIPT bold_x ∼ italic_p end_POSTSUBSCRIPT roman_log italic_q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT ( bold_x ) = blackboard_E start_POSTSUBSCRIPT bold_x ∼ italic_p end_POSTSUBSCRIPT italic_f ( bold_x ) - roman_log italic_Z [ italic_f ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p3.4">This optimization is typically carried out by gradient descent over the parameters of <math alttext="f" class="ltx_Math" display="inline" id="S2.p3.4.m1.1"><semantics id="S2.p3.4.m1.1a"><mi id="S2.p3.4.m1.1.1" xref="S2.p3.4.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S2.p3.4.m1.1b"><ci id="S2.p3.4.m1.1.1.cmml" xref="S2.p3.4.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.4.m1.1c">f</annotation><annotation encoding="application/x-llamapun" id="S2.p3.4.m1.1d">italic_f</annotation></semantics></math>,
but due to the intractability of the partition function, one must rely on Markov Chain Monte Carlo (MCMC) sampling to estimate the gradients <cite class="ltx_cite ltx_citemacro_citep">(Song &amp; Kingma, <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib26" title="">2021</a>)</cite>.</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>NRGBoost</h2>
<div class="ltx_para ltx_noindent" id="S3.p1">
<p class="ltx_p" id="S3.p1.2">Expanding the increase in log-likelihood in equation <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S2.E3" title="In 2 Energy Based Models ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">3</span></a> due to a variation <math alttext="\delta f" class="ltx_Math" display="inline" id="S3.p1.1.m1.1"><semantics id="S3.p1.1.m1.1a"><mrow id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml"><mi id="S3.p1.1.m1.1.1.2" xref="S3.p1.1.m1.1.1.2.cmml">δ</mi><mo id="S3.p1.1.m1.1.1.1" xref="S3.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.p1.1.m1.1.1.3" xref="S3.p1.1.m1.1.1.3.cmml">f</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><apply id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1"><times id="S3.p1.1.m1.1.1.1.cmml" xref="S3.p1.1.m1.1.1.1"></times><ci id="S3.p1.1.m1.1.1.2.cmml" xref="S3.p1.1.m1.1.1.2">𝛿</ci><ci id="S3.p1.1.m1.1.1.3.cmml" xref="S3.p1.1.m1.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">\delta f</annotation><annotation encoding="application/x-llamapun" id="S3.p1.1.m1.1d">italic_δ italic_f</annotation></semantics></math> around an energy function <math alttext="f" class="ltx_Math" display="inline" id="S3.p1.2.m2.1"><semantics id="S3.p1.2.m2.1a"><mi id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><ci id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">f</annotation><annotation encoding="application/x-llamapun" id="S3.p1.2.m2.1d">italic_f</annotation></semantics></math> up to second order we have</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="L[f+\delta f]-L[f]\approx\mathbb{E}_{\mathbf{x}\sim p}\delta f(\mathbf{x})-%
\mathbb{E}_{\mathbf{x}\sim q_{f}}\delta f(\mathbf{x})-\frac{1}{2}\textrm{Var}_%
{\mathbf{x}\sim q_{f}}\delta f(\mathbf{x})\eqqcolon\Delta L_{f}[\delta f]\,." class="ltx_Math" display="block" id="S3.E4.m1.5"><semantics id="S3.E4.m1.5a"><mrow id="S3.E4.m1.5.5.1" xref="S3.E4.m1.5.5.1.1.cmml"><mrow id="S3.E4.m1.5.5.1.1" xref="S3.E4.m1.5.5.1.1.cmml"><mrow id="S3.E4.m1.5.5.1.1.1" xref="S3.E4.m1.5.5.1.1.1.cmml"><mrow id="S3.E4.m1.5.5.1.1.1.1" xref="S3.E4.m1.5.5.1.1.1.1.cmml"><mi id="S3.E4.m1.5.5.1.1.1.1.3" xref="S3.E4.m1.5.5.1.1.1.1.3.cmml">L</mi><mo id="S3.E4.m1.5.5.1.1.1.1.2" xref="S3.E4.m1.5.5.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.5.5.1.1.1.1.1.1" xref="S3.E4.m1.5.5.1.1.1.1.1.2.cmml"><mo id="S3.E4.m1.5.5.1.1.1.1.1.1.2" stretchy="false" xref="S3.E4.m1.5.5.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E4.m1.5.5.1.1.1.1.1.1.1" xref="S3.E4.m1.5.5.1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.5.5.1.1.1.1.1.1.1.2" xref="S3.E4.m1.5.5.1.1.1.1.1.1.1.2.cmml">f</mi><mo id="S3.E4.m1.5.5.1.1.1.1.1.1.1.1" xref="S3.E4.m1.5.5.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.E4.m1.5.5.1.1.1.1.1.1.1.3" xref="S3.E4.m1.5.5.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.5.5.1.1.1.1.1.1.1.3.2" xref="S3.E4.m1.5.5.1.1.1.1.1.1.1.3.2.cmml">δ</mi><mo id="S3.E4.m1.5.5.1.1.1.1.1.1.1.3.1" xref="S3.E4.m1.5.5.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E4.m1.5.5.1.1.1.1.1.1.1.3.3" xref="S3.E4.m1.5.5.1.1.1.1.1.1.1.3.3.cmml">f</mi></mrow></mrow><mo id="S3.E4.m1.5.5.1.1.1.1.1.1.3" stretchy="false" xref="S3.E4.m1.5.5.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S3.E4.m1.5.5.1.1.1.2" xref="S3.E4.m1.5.5.1.1.1.2.cmml">−</mo><mrow id="S3.E4.m1.5.5.1.1.1.3" xref="S3.E4.m1.5.5.1.1.1.3.cmml"><mi id="S3.E4.m1.5.5.1.1.1.3.2" xref="S3.E4.m1.5.5.1.1.1.3.2.cmml">L</mi><mo id="S3.E4.m1.5.5.1.1.1.3.1" xref="S3.E4.m1.5.5.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.E4.m1.5.5.1.1.1.3.3.2" xref="S3.E4.m1.5.5.1.1.1.3.3.1.cmml"><mo id="S3.E4.m1.5.5.1.1.1.3.3.2.1" stretchy="false" xref="S3.E4.m1.5.5.1.1.1.3.3.1.1.cmml">[</mo><mi id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml">f</mi><mo id="S3.E4.m1.5.5.1.1.1.3.3.2.2" stretchy="false" xref="S3.E4.m1.5.5.1.1.1.3.3.1.1.cmml">]</mo></mrow></mrow></mrow><mo id="S3.E4.m1.5.5.1.1.4" xref="S3.E4.m1.5.5.1.1.4.cmml">≈</mo><mrow id="S3.E4.m1.5.5.1.1.5" xref="S3.E4.m1.5.5.1.1.5.cmml"><mrow id="S3.E4.m1.5.5.1.1.5.2" xref="S3.E4.m1.5.5.1.1.5.2.cmml"><msub id="S3.E4.m1.5.5.1.1.5.2.2" xref="S3.E4.m1.5.5.1.1.5.2.2.cmml"><mi id="S3.E4.m1.5.5.1.1.5.2.2.2" xref="S3.E4.m1.5.5.1.1.5.2.2.2.cmml">𝔼</mi><mrow id="S3.E4.m1.5.5.1.1.5.2.2.3" xref="S3.E4.m1.5.5.1.1.5.2.2.3.cmml"><mi id="S3.E4.m1.5.5.1.1.5.2.2.3.2" xref="S3.E4.m1.5.5.1.1.5.2.2.3.2.cmml">𝐱</mi><mo id="S3.E4.m1.5.5.1.1.5.2.2.3.1" xref="S3.E4.m1.5.5.1.1.5.2.2.3.1.cmml">∼</mo><mi id="S3.E4.m1.5.5.1.1.5.2.2.3.3" xref="S3.E4.m1.5.5.1.1.5.2.2.3.3.cmml">p</mi></mrow></msub><mo id="S3.E4.m1.5.5.1.1.5.2.1" xref="S3.E4.m1.5.5.1.1.5.2.1.cmml">⁢</mo><mi id="S3.E4.m1.5.5.1.1.5.2.3" xref="S3.E4.m1.5.5.1.1.5.2.3.cmml">δ</mi><mo id="S3.E4.m1.5.5.1.1.5.2.1a" xref="S3.E4.m1.5.5.1.1.5.2.1.cmml">⁢</mo><mi id="S3.E4.m1.5.5.1.1.5.2.4" xref="S3.E4.m1.5.5.1.1.5.2.4.cmml">f</mi><mo id="S3.E4.m1.5.5.1.1.5.2.1b" xref="S3.E4.m1.5.5.1.1.5.2.1.cmml">⁢</mo><mrow id="S3.E4.m1.5.5.1.1.5.2.5.2" xref="S3.E4.m1.5.5.1.1.5.2.cmml"><mo id="S3.E4.m1.5.5.1.1.5.2.5.2.1" stretchy="false" xref="S3.E4.m1.5.5.1.1.5.2.cmml">(</mo><mi id="S3.E4.m1.2.2" xref="S3.E4.m1.2.2.cmml">𝐱</mi><mo id="S3.E4.m1.5.5.1.1.5.2.5.2.2" stretchy="false" xref="S3.E4.m1.5.5.1.1.5.2.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.5.5.1.1.5.1" xref="S3.E4.m1.5.5.1.1.5.1.cmml">−</mo><mrow id="S3.E4.m1.5.5.1.1.5.3" xref="S3.E4.m1.5.5.1.1.5.3.cmml"><msub id="S3.E4.m1.5.5.1.1.5.3.2" xref="S3.E4.m1.5.5.1.1.5.3.2.cmml"><mi id="S3.E4.m1.5.5.1.1.5.3.2.2" xref="S3.E4.m1.5.5.1.1.5.3.2.2.cmml">𝔼</mi><mrow id="S3.E4.m1.5.5.1.1.5.3.2.3" xref="S3.E4.m1.5.5.1.1.5.3.2.3.cmml"><mi id="S3.E4.m1.5.5.1.1.5.3.2.3.2" xref="S3.E4.m1.5.5.1.1.5.3.2.3.2.cmml">𝐱</mi><mo id="S3.E4.m1.5.5.1.1.5.3.2.3.1" xref="S3.E4.m1.5.5.1.1.5.3.2.3.1.cmml">∼</mo><msub id="S3.E4.m1.5.5.1.1.5.3.2.3.3" xref="S3.E4.m1.5.5.1.1.5.3.2.3.3.cmml"><mi id="S3.E4.m1.5.5.1.1.5.3.2.3.3.2" xref="S3.E4.m1.5.5.1.1.5.3.2.3.3.2.cmml">q</mi><mi id="S3.E4.m1.5.5.1.1.5.3.2.3.3.3" xref="S3.E4.m1.5.5.1.1.5.3.2.3.3.3.cmml">f</mi></msub></mrow></msub><mo id="S3.E4.m1.5.5.1.1.5.3.1" xref="S3.E4.m1.5.5.1.1.5.3.1.cmml">⁢</mo><mi id="S3.E4.m1.5.5.1.1.5.3.3" xref="S3.E4.m1.5.5.1.1.5.3.3.cmml">δ</mi><mo id="S3.E4.m1.5.5.1.1.5.3.1a" xref="S3.E4.m1.5.5.1.1.5.3.1.cmml">⁢</mo><mi id="S3.E4.m1.5.5.1.1.5.3.4" xref="S3.E4.m1.5.5.1.1.5.3.4.cmml">f</mi><mo id="S3.E4.m1.5.5.1.1.5.3.1b" xref="S3.E4.m1.5.5.1.1.5.3.1.cmml">⁢</mo><mrow id="S3.E4.m1.5.5.1.1.5.3.5.2" xref="S3.E4.m1.5.5.1.1.5.3.cmml"><mo id="S3.E4.m1.5.5.1.1.5.3.5.2.1" stretchy="false" xref="S3.E4.m1.5.5.1.1.5.3.cmml">(</mo><mi id="S3.E4.m1.3.3" xref="S3.E4.m1.3.3.cmml">𝐱</mi><mo id="S3.E4.m1.5.5.1.1.5.3.5.2.2" stretchy="false" xref="S3.E4.m1.5.5.1.1.5.3.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.5.5.1.1.5.1a" xref="S3.E4.m1.5.5.1.1.5.1.cmml">−</mo><mrow id="S3.E4.m1.5.5.1.1.5.4" xref="S3.E4.m1.5.5.1.1.5.4.cmml"><mfrac id="S3.E4.m1.5.5.1.1.5.4.2" xref="S3.E4.m1.5.5.1.1.5.4.2.cmml"><mn id="S3.E4.m1.5.5.1.1.5.4.2.2" xref="S3.E4.m1.5.5.1.1.5.4.2.2.cmml">1</mn><mn id="S3.E4.m1.5.5.1.1.5.4.2.3" xref="S3.E4.m1.5.5.1.1.5.4.2.3.cmml">2</mn></mfrac><mo id="S3.E4.m1.5.5.1.1.5.4.1" xref="S3.E4.m1.5.5.1.1.5.4.1.cmml">⁢</mo><msub id="S3.E4.m1.5.5.1.1.5.4.3" xref="S3.E4.m1.5.5.1.1.5.4.3.cmml"><mtext id="S3.E4.m1.5.5.1.1.5.4.3.2" xref="S3.E4.m1.5.5.1.1.5.4.3.2a.cmml">Var</mtext><mrow id="S3.E4.m1.5.5.1.1.5.4.3.3" xref="S3.E4.m1.5.5.1.1.5.4.3.3.cmml"><mi id="S3.E4.m1.5.5.1.1.5.4.3.3.2" xref="S3.E4.m1.5.5.1.1.5.4.3.3.2.cmml">𝐱</mi><mo id="S3.E4.m1.5.5.1.1.5.4.3.3.1" xref="S3.E4.m1.5.5.1.1.5.4.3.3.1.cmml">∼</mo><msub id="S3.E4.m1.5.5.1.1.5.4.3.3.3" xref="S3.E4.m1.5.5.1.1.5.4.3.3.3.cmml"><mi id="S3.E4.m1.5.5.1.1.5.4.3.3.3.2" xref="S3.E4.m1.5.5.1.1.5.4.3.3.3.2.cmml">q</mi><mi id="S3.E4.m1.5.5.1.1.5.4.3.3.3.3" xref="S3.E4.m1.5.5.1.1.5.4.3.3.3.3.cmml">f</mi></msub></mrow></msub><mo id="S3.E4.m1.5.5.1.1.5.4.1a" xref="S3.E4.m1.5.5.1.1.5.4.1.cmml">⁢</mo><mi id="S3.E4.m1.5.5.1.1.5.4.4" xref="S3.E4.m1.5.5.1.1.5.4.4.cmml">δ</mi><mo id="S3.E4.m1.5.5.1.1.5.4.1b" xref="S3.E4.m1.5.5.1.1.5.4.1.cmml">⁢</mo><mi id="S3.E4.m1.5.5.1.1.5.4.5" xref="S3.E4.m1.5.5.1.1.5.4.5.cmml">f</mi><mo id="S3.E4.m1.5.5.1.1.5.4.1c" xref="S3.E4.m1.5.5.1.1.5.4.1.cmml">⁢</mo><mrow id="S3.E4.m1.5.5.1.1.5.4.6.2" xref="S3.E4.m1.5.5.1.1.5.4.cmml"><mo id="S3.E4.m1.5.5.1.1.5.4.6.2.1" stretchy="false" xref="S3.E4.m1.5.5.1.1.5.4.cmml">(</mo><mi id="S3.E4.m1.4.4" xref="S3.E4.m1.4.4.cmml">𝐱</mi><mo id="S3.E4.m1.5.5.1.1.5.4.6.2.2" stretchy="false" xref="S3.E4.m1.5.5.1.1.5.4.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E4.m1.5.5.1.1.6" xref="S3.E4.m1.5.5.1.1.6.cmml">≕</mo><mrow id="S3.E4.m1.5.5.1.1.2" xref="S3.E4.m1.5.5.1.1.2.cmml"><mi id="S3.E4.m1.5.5.1.1.2.3" mathvariant="normal" xref="S3.E4.m1.5.5.1.1.2.3.cmml">Δ</mi><mo id="S3.E4.m1.5.5.1.1.2.2" xref="S3.E4.m1.5.5.1.1.2.2.cmml">⁢</mo><msub id="S3.E4.m1.5.5.1.1.2.4" xref="S3.E4.m1.5.5.1.1.2.4.cmml"><mi id="S3.E4.m1.5.5.1.1.2.4.2" xref="S3.E4.m1.5.5.1.1.2.4.2.cmml">L</mi><mi id="S3.E4.m1.5.5.1.1.2.4.3" xref="S3.E4.m1.5.5.1.1.2.4.3.cmml">f</mi></msub><mo id="S3.E4.m1.5.5.1.1.2.2a" xref="S3.E4.m1.5.5.1.1.2.2.cmml">⁢</mo><mrow id="S3.E4.m1.5.5.1.1.2.1.1" xref="S3.E4.m1.5.5.1.1.2.1.2.cmml"><mo id="S3.E4.m1.5.5.1.1.2.1.1.2" stretchy="false" xref="S3.E4.m1.5.5.1.1.2.1.2.1.cmml">[</mo><mrow id="S3.E4.m1.5.5.1.1.2.1.1.1" xref="S3.E4.m1.5.5.1.1.2.1.1.1.cmml"><mi id="S3.E4.m1.5.5.1.1.2.1.1.1.2" xref="S3.E4.m1.5.5.1.1.2.1.1.1.2.cmml">δ</mi><mo id="S3.E4.m1.5.5.1.1.2.1.1.1.1" xref="S3.E4.m1.5.5.1.1.2.1.1.1.1.cmml">⁢</mo><mi id="S3.E4.m1.5.5.1.1.2.1.1.1.3" xref="S3.E4.m1.5.5.1.1.2.1.1.1.3.cmml">f</mi></mrow><mo id="S3.E4.m1.5.5.1.1.2.1.1.3" stretchy="false" xref="S3.E4.m1.5.5.1.1.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S3.E4.m1.5.5.1.2" lspace="0.170em" xref="S3.E4.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.5b"><apply id="S3.E4.m1.5.5.1.1.cmml" xref="S3.E4.m1.5.5.1"><and id="S3.E4.m1.5.5.1.1a.cmml" xref="S3.E4.m1.5.5.1"></and><apply id="S3.E4.m1.5.5.1.1b.cmml" xref="S3.E4.m1.5.5.1"><approx id="S3.E4.m1.5.5.1.1.4.cmml" xref="S3.E4.m1.5.5.1.1.4"></approx><apply id="S3.E4.m1.5.5.1.1.1.cmml" xref="S3.E4.m1.5.5.1.1.1"><minus id="S3.E4.m1.5.5.1.1.1.2.cmml" xref="S3.E4.m1.5.5.1.1.1.2"></minus><apply id="S3.E4.m1.5.5.1.1.1.1.cmml" xref="S3.E4.m1.5.5.1.1.1.1"><times id="S3.E4.m1.5.5.1.1.1.1.2.cmml" xref="S3.E4.m1.5.5.1.1.1.1.2"></times><ci id="S3.E4.m1.5.5.1.1.1.1.3.cmml" xref="S3.E4.m1.5.5.1.1.1.1.3">𝐿</ci><apply id="S3.E4.m1.5.5.1.1.1.1.1.2.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E4.m1.5.5.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E4.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.1.1"><plus id="S3.E4.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.1.1.1"></plus><ci id="S3.E4.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.1.1.2">𝑓</ci><apply id="S3.E4.m1.5.5.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.1.1.3"><times id="S3.E4.m1.5.5.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E4.m1.5.5.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.1.1.3.2">𝛿</ci><ci id="S3.E4.m1.5.5.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.1.1.3.3">𝑓</ci></apply></apply></apply></apply><apply id="S3.E4.m1.5.5.1.1.1.3.cmml" xref="S3.E4.m1.5.5.1.1.1.3"><times id="S3.E4.m1.5.5.1.1.1.3.1.cmml" xref="S3.E4.m1.5.5.1.1.1.3.1"></times><ci id="S3.E4.m1.5.5.1.1.1.3.2.cmml" xref="S3.E4.m1.5.5.1.1.1.3.2">𝐿</ci><apply id="S3.E4.m1.5.5.1.1.1.3.3.1.cmml" xref="S3.E4.m1.5.5.1.1.1.3.3.2"><csymbol cd="latexml" id="S3.E4.m1.5.5.1.1.1.3.3.1.1.cmml" xref="S3.E4.m1.5.5.1.1.1.3.3.2.1">delimited-[]</csymbol><ci id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1">𝑓</ci></apply></apply></apply><apply id="S3.E4.m1.5.5.1.1.5.cmml" xref="S3.E4.m1.5.5.1.1.5"><minus id="S3.E4.m1.5.5.1.1.5.1.cmml" xref="S3.E4.m1.5.5.1.1.5.1"></minus><apply id="S3.E4.m1.5.5.1.1.5.2.cmml" xref="S3.E4.m1.5.5.1.1.5.2"><times id="S3.E4.m1.5.5.1.1.5.2.1.cmml" xref="S3.E4.m1.5.5.1.1.5.2.1"></times><apply id="S3.E4.m1.5.5.1.1.5.2.2.cmml" xref="S3.E4.m1.5.5.1.1.5.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.5.2.2.1.cmml" xref="S3.E4.m1.5.5.1.1.5.2.2">subscript</csymbol><ci id="S3.E4.m1.5.5.1.1.5.2.2.2.cmml" xref="S3.E4.m1.5.5.1.1.5.2.2.2">𝔼</ci><apply id="S3.E4.m1.5.5.1.1.5.2.2.3.cmml" xref="S3.E4.m1.5.5.1.1.5.2.2.3"><csymbol cd="latexml" id="S3.E4.m1.5.5.1.1.5.2.2.3.1.cmml" xref="S3.E4.m1.5.5.1.1.5.2.2.3.1">similar-to</csymbol><ci id="S3.E4.m1.5.5.1.1.5.2.2.3.2.cmml" xref="S3.E4.m1.5.5.1.1.5.2.2.3.2">𝐱</ci><ci id="S3.E4.m1.5.5.1.1.5.2.2.3.3.cmml" xref="S3.E4.m1.5.5.1.1.5.2.2.3.3">𝑝</ci></apply></apply><ci id="S3.E4.m1.5.5.1.1.5.2.3.cmml" xref="S3.E4.m1.5.5.1.1.5.2.3">𝛿</ci><ci id="S3.E4.m1.5.5.1.1.5.2.4.cmml" xref="S3.E4.m1.5.5.1.1.5.2.4">𝑓</ci><ci id="S3.E4.m1.2.2.cmml" xref="S3.E4.m1.2.2">𝐱</ci></apply><apply id="S3.E4.m1.5.5.1.1.5.3.cmml" xref="S3.E4.m1.5.5.1.1.5.3"><times id="S3.E4.m1.5.5.1.1.5.3.1.cmml" xref="S3.E4.m1.5.5.1.1.5.3.1"></times><apply id="S3.E4.m1.5.5.1.1.5.3.2.cmml" xref="S3.E4.m1.5.5.1.1.5.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.5.3.2.1.cmml" xref="S3.E4.m1.5.5.1.1.5.3.2">subscript</csymbol><ci id="S3.E4.m1.5.5.1.1.5.3.2.2.cmml" xref="S3.E4.m1.5.5.1.1.5.3.2.2">𝔼</ci><apply id="S3.E4.m1.5.5.1.1.5.3.2.3.cmml" xref="S3.E4.m1.5.5.1.1.5.3.2.3"><csymbol cd="latexml" id="S3.E4.m1.5.5.1.1.5.3.2.3.1.cmml" xref="S3.E4.m1.5.5.1.1.5.3.2.3.1">similar-to</csymbol><ci id="S3.E4.m1.5.5.1.1.5.3.2.3.2.cmml" xref="S3.E4.m1.5.5.1.1.5.3.2.3.2">𝐱</ci><apply id="S3.E4.m1.5.5.1.1.5.3.2.3.3.cmml" xref="S3.E4.m1.5.5.1.1.5.3.2.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.5.3.2.3.3.1.cmml" xref="S3.E4.m1.5.5.1.1.5.3.2.3.3">subscript</csymbol><ci id="S3.E4.m1.5.5.1.1.5.3.2.3.3.2.cmml" xref="S3.E4.m1.5.5.1.1.5.3.2.3.3.2">𝑞</ci><ci id="S3.E4.m1.5.5.1.1.5.3.2.3.3.3.cmml" xref="S3.E4.m1.5.5.1.1.5.3.2.3.3.3">𝑓</ci></apply></apply></apply><ci id="S3.E4.m1.5.5.1.1.5.3.3.cmml" xref="S3.E4.m1.5.5.1.1.5.3.3">𝛿</ci><ci id="S3.E4.m1.5.5.1.1.5.3.4.cmml" xref="S3.E4.m1.5.5.1.1.5.3.4">𝑓</ci><ci id="S3.E4.m1.3.3.cmml" xref="S3.E4.m1.3.3">𝐱</ci></apply><apply id="S3.E4.m1.5.5.1.1.5.4.cmml" xref="S3.E4.m1.5.5.1.1.5.4"><times id="S3.E4.m1.5.5.1.1.5.4.1.cmml" xref="S3.E4.m1.5.5.1.1.5.4.1"></times><apply id="S3.E4.m1.5.5.1.1.5.4.2.cmml" xref="S3.E4.m1.5.5.1.1.5.4.2"><divide id="S3.E4.m1.5.5.1.1.5.4.2.1.cmml" xref="S3.E4.m1.5.5.1.1.5.4.2"></divide><cn id="S3.E4.m1.5.5.1.1.5.4.2.2.cmml" type="integer" xref="S3.E4.m1.5.5.1.1.5.4.2.2">1</cn><cn id="S3.E4.m1.5.5.1.1.5.4.2.3.cmml" type="integer" xref="S3.E4.m1.5.5.1.1.5.4.2.3">2</cn></apply><apply id="S3.E4.m1.5.5.1.1.5.4.3.cmml" xref="S3.E4.m1.5.5.1.1.5.4.3"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.5.4.3.1.cmml" xref="S3.E4.m1.5.5.1.1.5.4.3">subscript</csymbol><ci id="S3.E4.m1.5.5.1.1.5.4.3.2a.cmml" xref="S3.E4.m1.5.5.1.1.5.4.3.2"><mtext id="S3.E4.m1.5.5.1.1.5.4.3.2.cmml" xref="S3.E4.m1.5.5.1.1.5.4.3.2">Var</mtext></ci><apply id="S3.E4.m1.5.5.1.1.5.4.3.3.cmml" xref="S3.E4.m1.5.5.1.1.5.4.3.3"><csymbol cd="latexml" id="S3.E4.m1.5.5.1.1.5.4.3.3.1.cmml" xref="S3.E4.m1.5.5.1.1.5.4.3.3.1">similar-to</csymbol><ci id="S3.E4.m1.5.5.1.1.5.4.3.3.2.cmml" xref="S3.E4.m1.5.5.1.1.5.4.3.3.2">𝐱</ci><apply id="S3.E4.m1.5.5.1.1.5.4.3.3.3.cmml" xref="S3.E4.m1.5.5.1.1.5.4.3.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.5.4.3.3.3.1.cmml" xref="S3.E4.m1.5.5.1.1.5.4.3.3.3">subscript</csymbol><ci id="S3.E4.m1.5.5.1.1.5.4.3.3.3.2.cmml" xref="S3.E4.m1.5.5.1.1.5.4.3.3.3.2">𝑞</ci><ci id="S3.E4.m1.5.5.1.1.5.4.3.3.3.3.cmml" xref="S3.E4.m1.5.5.1.1.5.4.3.3.3.3">𝑓</ci></apply></apply></apply><ci id="S3.E4.m1.5.5.1.1.5.4.4.cmml" xref="S3.E4.m1.5.5.1.1.5.4.4">𝛿</ci><ci id="S3.E4.m1.5.5.1.1.5.4.5.cmml" xref="S3.E4.m1.5.5.1.1.5.4.5">𝑓</ci><ci id="S3.E4.m1.4.4.cmml" xref="S3.E4.m1.4.4">𝐱</ci></apply></apply></apply><apply id="S3.E4.m1.5.5.1.1c.cmml" xref="S3.E4.m1.5.5.1"><ci id="S3.E4.m1.5.5.1.1.6.cmml" xref="S3.E4.m1.5.5.1.1.6">≕</ci><share href="https://arxiv.org/html/2410.03535v1#S3.E4.m1.5.5.1.1.5.cmml" id="S3.E4.m1.5.5.1.1d.cmml" xref="S3.E4.m1.5.5.1"></share><apply id="S3.E4.m1.5.5.1.1.2.cmml" xref="S3.E4.m1.5.5.1.1.2"><times id="S3.E4.m1.5.5.1.1.2.2.cmml" xref="S3.E4.m1.5.5.1.1.2.2"></times><ci id="S3.E4.m1.5.5.1.1.2.3.cmml" xref="S3.E4.m1.5.5.1.1.2.3">Δ</ci><apply id="S3.E4.m1.5.5.1.1.2.4.cmml" xref="S3.E4.m1.5.5.1.1.2.4"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.2.4.1.cmml" xref="S3.E4.m1.5.5.1.1.2.4">subscript</csymbol><ci id="S3.E4.m1.5.5.1.1.2.4.2.cmml" xref="S3.E4.m1.5.5.1.1.2.4.2">𝐿</ci><ci id="S3.E4.m1.5.5.1.1.2.4.3.cmml" xref="S3.E4.m1.5.5.1.1.2.4.3">𝑓</ci></apply><apply id="S3.E4.m1.5.5.1.1.2.1.2.cmml" xref="S3.E4.m1.5.5.1.1.2.1.1"><csymbol cd="latexml" id="S3.E4.m1.5.5.1.1.2.1.2.1.cmml" xref="S3.E4.m1.5.5.1.1.2.1.1.2">delimited-[]</csymbol><apply id="S3.E4.m1.5.5.1.1.2.1.1.1.cmml" xref="S3.E4.m1.5.5.1.1.2.1.1.1"><times id="S3.E4.m1.5.5.1.1.2.1.1.1.1.cmml" xref="S3.E4.m1.5.5.1.1.2.1.1.1.1"></times><ci id="S3.E4.m1.5.5.1.1.2.1.1.1.2.cmml" xref="S3.E4.m1.5.5.1.1.2.1.1.1.2">𝛿</ci><ci id="S3.E4.m1.5.5.1.1.2.1.1.1.3.cmml" xref="S3.E4.m1.5.5.1.1.2.1.1.1.3">𝑓</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.5c">L[f+\delta f]-L[f]\approx\mathbb{E}_{\mathbf{x}\sim p}\delta f(\mathbf{x})-%
\mathbb{E}_{\mathbf{x}\sim q_{f}}\delta f(\mathbf{x})-\frac{1}{2}\textrm{Var}_%
{\mathbf{x}\sim q_{f}}\delta f(\mathbf{x})\eqqcolon\Delta L_{f}[\delta f]\,.</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.5d">italic_L [ italic_f + italic_δ italic_f ] - italic_L [ italic_f ] ≈ blackboard_E start_POSTSUBSCRIPT bold_x ∼ italic_p end_POSTSUBSCRIPT italic_δ italic_f ( bold_x ) - blackboard_E start_POSTSUBSCRIPT bold_x ∼ italic_q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_δ italic_f ( bold_x ) - divide start_ARG 1 end_ARG start_ARG 2 end_ARG Var start_POSTSUBSCRIPT bold_x ∼ italic_q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_δ italic_f ( bold_x ) ≕ roman_Δ italic_L start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT [ italic_δ italic_f ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.p1.8">The <math alttext="\delta f" class="ltx_Math" display="inline" id="S3.p1.3.m1.1"><semantics id="S3.p1.3.m1.1a"><mrow id="S3.p1.3.m1.1.1" xref="S3.p1.3.m1.1.1.cmml"><mi id="S3.p1.3.m1.1.1.2" xref="S3.p1.3.m1.1.1.2.cmml">δ</mi><mo id="S3.p1.3.m1.1.1.1" xref="S3.p1.3.m1.1.1.1.cmml">⁢</mo><mi id="S3.p1.3.m1.1.1.3" xref="S3.p1.3.m1.1.1.3.cmml">f</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.3.m1.1b"><apply id="S3.p1.3.m1.1.1.cmml" xref="S3.p1.3.m1.1.1"><times id="S3.p1.3.m1.1.1.1.cmml" xref="S3.p1.3.m1.1.1.1"></times><ci id="S3.p1.3.m1.1.1.2.cmml" xref="S3.p1.3.m1.1.1.2">𝛿</ci><ci id="S3.p1.3.m1.1.1.3.cmml" xref="S3.p1.3.m1.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m1.1c">\delta f</annotation><annotation encoding="application/x-llamapun" id="S3.p1.3.m1.1d">italic_δ italic_f</annotation></semantics></math> that maximizes this quadratic approximation should thus have a large positive difference between the expected value under the data
and under <math alttext="q_{f}" class="ltx_Math" display="inline" id="S3.p1.4.m2.1"><semantics id="S3.p1.4.m2.1a"><msub id="S3.p1.4.m2.1.1" xref="S3.p1.4.m2.1.1.cmml"><mi id="S3.p1.4.m2.1.1.2" xref="S3.p1.4.m2.1.1.2.cmml">q</mi><mi id="S3.p1.4.m2.1.1.3" xref="S3.p1.4.m2.1.1.3.cmml">f</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.4.m2.1b"><apply id="S3.p1.4.m2.1.1.cmml" xref="S3.p1.4.m2.1.1"><csymbol cd="ambiguous" id="S3.p1.4.m2.1.1.1.cmml" xref="S3.p1.4.m2.1.1">subscript</csymbol><ci id="S3.p1.4.m2.1.1.2.cmml" xref="S3.p1.4.m2.1.1.2">𝑞</ci><ci id="S3.p1.4.m2.1.1.3.cmml" xref="S3.p1.4.m2.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m2.1c">q_{f}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.4.m2.1d">italic_q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT</annotation></semantics></math> while having low variance under <math alttext="q_{f}" class="ltx_Math" display="inline" id="S3.p1.5.m3.1"><semantics id="S3.p1.5.m3.1a"><msub id="S3.p1.5.m3.1.1" xref="S3.p1.5.m3.1.1.cmml"><mi id="S3.p1.5.m3.1.1.2" xref="S3.p1.5.m3.1.1.2.cmml">q</mi><mi id="S3.p1.5.m3.1.1.3" xref="S3.p1.5.m3.1.1.3.cmml">f</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.5.m3.1b"><apply id="S3.p1.5.m3.1.1.cmml" xref="S3.p1.5.m3.1.1"><csymbol cd="ambiguous" id="S3.p1.5.m3.1.1.1.cmml" xref="S3.p1.5.m3.1.1">subscript</csymbol><ci id="S3.p1.5.m3.1.1.2.cmml" xref="S3.p1.5.m3.1.1.2">𝑞</ci><ci id="S3.p1.5.m3.1.1.3.cmml" xref="S3.p1.5.m3.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m3.1c">q_{f}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.5.m3.1d">italic_q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT</annotation></semantics></math>.
We note that just like the original log-likelihood, this Taylor expansion is invariant to adding an overall constant to <math alttext="\delta f" class="ltx_Math" display="inline" id="S3.p1.6.m4.1"><semantics id="S3.p1.6.m4.1a"><mrow id="S3.p1.6.m4.1.1" xref="S3.p1.6.m4.1.1.cmml"><mi id="S3.p1.6.m4.1.1.2" xref="S3.p1.6.m4.1.1.2.cmml">δ</mi><mo id="S3.p1.6.m4.1.1.1" xref="S3.p1.6.m4.1.1.1.cmml">⁢</mo><mi id="S3.p1.6.m4.1.1.3" xref="S3.p1.6.m4.1.1.3.cmml">f</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.6.m4.1b"><apply id="S3.p1.6.m4.1.1.cmml" xref="S3.p1.6.m4.1.1"><times id="S3.p1.6.m4.1.1.1.cmml" xref="S3.p1.6.m4.1.1.1"></times><ci id="S3.p1.6.m4.1.1.2.cmml" xref="S3.p1.6.m4.1.1.2">𝛿</ci><ci id="S3.p1.6.m4.1.1.3.cmml" xref="S3.p1.6.m4.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.6.m4.1c">\delta f</annotation><annotation encoding="application/x-llamapun" id="S3.p1.6.m4.1d">italic_δ italic_f</annotation></semantics></math>.
This means that, in maximizing equation <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S3.E4" title="In 3 NRGBoost ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">4</span></a> we can consider only functions that have zero expectation under <math alttext="q_{f}" class="ltx_Math" display="inline" id="S3.p1.7.m5.1"><semantics id="S3.p1.7.m5.1a"><msub id="S3.p1.7.m5.1.1" xref="S3.p1.7.m5.1.1.cmml"><mi id="S3.p1.7.m5.1.1.2" xref="S3.p1.7.m5.1.1.2.cmml">q</mi><mi id="S3.p1.7.m5.1.1.3" xref="S3.p1.7.m5.1.1.3.cmml">f</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.7.m5.1b"><apply id="S3.p1.7.m5.1.1.cmml" xref="S3.p1.7.m5.1.1"><csymbol cd="ambiguous" id="S3.p1.7.m5.1.1.1.cmml" xref="S3.p1.7.m5.1.1">subscript</csymbol><ci id="S3.p1.7.m5.1.1.2.cmml" xref="S3.p1.7.m5.1.1.2">𝑞</ci><ci id="S3.p1.7.m5.1.1.3.cmml" xref="S3.p1.7.m5.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.7.m5.1c">q_{f}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.7.m5.1d">italic_q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT</annotation></semantics></math> in which case we can simplify <math alttext="\Delta L_{f}[\delta f]" class="ltx_Math" display="inline" id="S3.p1.8.m6.1"><semantics id="S3.p1.8.m6.1a"><mrow id="S3.p1.8.m6.1.1" xref="S3.p1.8.m6.1.1.cmml"><mi id="S3.p1.8.m6.1.1.3" mathvariant="normal" xref="S3.p1.8.m6.1.1.3.cmml">Δ</mi><mo id="S3.p1.8.m6.1.1.2" xref="S3.p1.8.m6.1.1.2.cmml">⁢</mo><msub id="S3.p1.8.m6.1.1.4" xref="S3.p1.8.m6.1.1.4.cmml"><mi id="S3.p1.8.m6.1.1.4.2" xref="S3.p1.8.m6.1.1.4.2.cmml">L</mi><mi id="S3.p1.8.m6.1.1.4.3" xref="S3.p1.8.m6.1.1.4.3.cmml">f</mi></msub><mo id="S3.p1.8.m6.1.1.2a" xref="S3.p1.8.m6.1.1.2.cmml">⁢</mo><mrow id="S3.p1.8.m6.1.1.1.1" xref="S3.p1.8.m6.1.1.1.2.cmml"><mo id="S3.p1.8.m6.1.1.1.1.2" stretchy="false" xref="S3.p1.8.m6.1.1.1.2.1.cmml">[</mo><mrow id="S3.p1.8.m6.1.1.1.1.1" xref="S3.p1.8.m6.1.1.1.1.1.cmml"><mi id="S3.p1.8.m6.1.1.1.1.1.2" xref="S3.p1.8.m6.1.1.1.1.1.2.cmml">δ</mi><mo id="S3.p1.8.m6.1.1.1.1.1.1" xref="S3.p1.8.m6.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.p1.8.m6.1.1.1.1.1.3" xref="S3.p1.8.m6.1.1.1.1.1.3.cmml">f</mi></mrow><mo id="S3.p1.8.m6.1.1.1.1.3" stretchy="false" xref="S3.p1.8.m6.1.1.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.8.m6.1b"><apply id="S3.p1.8.m6.1.1.cmml" xref="S3.p1.8.m6.1.1"><times id="S3.p1.8.m6.1.1.2.cmml" xref="S3.p1.8.m6.1.1.2"></times><ci id="S3.p1.8.m6.1.1.3.cmml" xref="S3.p1.8.m6.1.1.3">Δ</ci><apply id="S3.p1.8.m6.1.1.4.cmml" xref="S3.p1.8.m6.1.1.4"><csymbol cd="ambiguous" id="S3.p1.8.m6.1.1.4.1.cmml" xref="S3.p1.8.m6.1.1.4">subscript</csymbol><ci id="S3.p1.8.m6.1.1.4.2.cmml" xref="S3.p1.8.m6.1.1.4.2">𝐿</ci><ci id="S3.p1.8.m6.1.1.4.3.cmml" xref="S3.p1.8.m6.1.1.4.3">𝑓</ci></apply><apply id="S3.p1.8.m6.1.1.1.2.cmml" xref="S3.p1.8.m6.1.1.1.1"><csymbol cd="latexml" id="S3.p1.8.m6.1.1.1.2.1.cmml" xref="S3.p1.8.m6.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.p1.8.m6.1.1.1.1.1.cmml" xref="S3.p1.8.m6.1.1.1.1.1"><times id="S3.p1.8.m6.1.1.1.1.1.1.cmml" xref="S3.p1.8.m6.1.1.1.1.1.1"></times><ci id="S3.p1.8.m6.1.1.1.1.1.2.cmml" xref="S3.p1.8.m6.1.1.1.1.1.2">𝛿</ci><ci id="S3.p1.8.m6.1.1.1.1.1.3.cmml" xref="S3.p1.8.m6.1.1.1.1.1.3">𝑓</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.8.m6.1c">\Delta L_{f}[\delta f]</annotation><annotation encoding="application/x-llamapun" id="S3.p1.8.m6.1d">roman_Δ italic_L start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT [ italic_δ italic_f ]</annotation></semantics></math> as</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\Delta L_{f}[\delta f]=\mathbb{E}_{\mathbf{x}\sim p}\delta f(\mathbf{x})-\frac%
{1}{2}\mathbb{E}_{\mathbf{x}\sim q_{f}}\delta f^{2}(\mathbf{x})\,." class="ltx_Math" display="block" id="S3.E5.m1.3"><semantics id="S3.E5.m1.3a"><mrow id="S3.E5.m1.3.3.1" xref="S3.E5.m1.3.3.1.1.cmml"><mrow id="S3.E5.m1.3.3.1.1" xref="S3.E5.m1.3.3.1.1.cmml"><mrow id="S3.E5.m1.3.3.1.1.1" xref="S3.E5.m1.3.3.1.1.1.cmml"><mi id="S3.E5.m1.3.3.1.1.1.3" mathvariant="normal" xref="S3.E5.m1.3.3.1.1.1.3.cmml">Δ</mi><mo id="S3.E5.m1.3.3.1.1.1.2" xref="S3.E5.m1.3.3.1.1.1.2.cmml">⁢</mo><msub id="S3.E5.m1.3.3.1.1.1.4" xref="S3.E5.m1.3.3.1.1.1.4.cmml"><mi id="S3.E5.m1.3.3.1.1.1.4.2" xref="S3.E5.m1.3.3.1.1.1.4.2.cmml">L</mi><mi id="S3.E5.m1.3.3.1.1.1.4.3" xref="S3.E5.m1.3.3.1.1.1.4.3.cmml">f</mi></msub><mo id="S3.E5.m1.3.3.1.1.1.2a" xref="S3.E5.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.3.3.1.1.1.1.1" xref="S3.E5.m1.3.3.1.1.1.1.2.cmml"><mo id="S3.E5.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S3.E5.m1.3.3.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E5.m1.3.3.1.1.1.1.1.1" xref="S3.E5.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.3.3.1.1.1.1.1.1.2" xref="S3.E5.m1.3.3.1.1.1.1.1.1.2.cmml">δ</mi><mo id="S3.E5.m1.3.3.1.1.1.1.1.1.1" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E5.m1.3.3.1.1.1.1.1.1.3" xref="S3.E5.m1.3.3.1.1.1.1.1.1.3.cmml">f</mi></mrow><mo id="S3.E5.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="S3.E5.m1.3.3.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S3.E5.m1.3.3.1.1.2" xref="S3.E5.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.E5.m1.3.3.1.1.3" xref="S3.E5.m1.3.3.1.1.3.cmml"><mrow id="S3.E5.m1.3.3.1.1.3.2" xref="S3.E5.m1.3.3.1.1.3.2.cmml"><msub id="S3.E5.m1.3.3.1.1.3.2.2" xref="S3.E5.m1.3.3.1.1.3.2.2.cmml"><mi id="S3.E5.m1.3.3.1.1.3.2.2.2" xref="S3.E5.m1.3.3.1.1.3.2.2.2.cmml">𝔼</mi><mrow id="S3.E5.m1.3.3.1.1.3.2.2.3" xref="S3.E5.m1.3.3.1.1.3.2.2.3.cmml"><mi id="S3.E5.m1.3.3.1.1.3.2.2.3.2" xref="S3.E5.m1.3.3.1.1.3.2.2.3.2.cmml">𝐱</mi><mo id="S3.E5.m1.3.3.1.1.3.2.2.3.1" xref="S3.E5.m1.3.3.1.1.3.2.2.3.1.cmml">∼</mo><mi id="S3.E5.m1.3.3.1.1.3.2.2.3.3" xref="S3.E5.m1.3.3.1.1.3.2.2.3.3.cmml">p</mi></mrow></msub><mo id="S3.E5.m1.3.3.1.1.3.2.1" xref="S3.E5.m1.3.3.1.1.3.2.1.cmml">⁢</mo><mi id="S3.E5.m1.3.3.1.1.3.2.3" xref="S3.E5.m1.3.3.1.1.3.2.3.cmml">δ</mi><mo id="S3.E5.m1.3.3.1.1.3.2.1a" xref="S3.E5.m1.3.3.1.1.3.2.1.cmml">⁢</mo><mi id="S3.E5.m1.3.3.1.1.3.2.4" xref="S3.E5.m1.3.3.1.1.3.2.4.cmml">f</mi><mo id="S3.E5.m1.3.3.1.1.3.2.1b" xref="S3.E5.m1.3.3.1.1.3.2.1.cmml">⁢</mo><mrow id="S3.E5.m1.3.3.1.1.3.2.5.2" xref="S3.E5.m1.3.3.1.1.3.2.cmml"><mo id="S3.E5.m1.3.3.1.1.3.2.5.2.1" stretchy="false" xref="S3.E5.m1.3.3.1.1.3.2.cmml">(</mo><mi id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml">𝐱</mi><mo id="S3.E5.m1.3.3.1.1.3.2.5.2.2" stretchy="false" xref="S3.E5.m1.3.3.1.1.3.2.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.3.3.1.1.3.1" xref="S3.E5.m1.3.3.1.1.3.1.cmml">−</mo><mrow id="S3.E5.m1.3.3.1.1.3.3" xref="S3.E5.m1.3.3.1.1.3.3.cmml"><mfrac id="S3.E5.m1.3.3.1.1.3.3.2" xref="S3.E5.m1.3.3.1.1.3.3.2.cmml"><mn id="S3.E5.m1.3.3.1.1.3.3.2.2" xref="S3.E5.m1.3.3.1.1.3.3.2.2.cmml">1</mn><mn id="S3.E5.m1.3.3.1.1.3.3.2.3" xref="S3.E5.m1.3.3.1.1.3.3.2.3.cmml">2</mn></mfrac><mo id="S3.E5.m1.3.3.1.1.3.3.1" xref="S3.E5.m1.3.3.1.1.3.3.1.cmml">⁢</mo><msub id="S3.E5.m1.3.3.1.1.3.3.3" xref="S3.E5.m1.3.3.1.1.3.3.3.cmml"><mi id="S3.E5.m1.3.3.1.1.3.3.3.2" xref="S3.E5.m1.3.3.1.1.3.3.3.2.cmml">𝔼</mi><mrow id="S3.E5.m1.3.3.1.1.3.3.3.3" xref="S3.E5.m1.3.3.1.1.3.3.3.3.cmml"><mi id="S3.E5.m1.3.3.1.1.3.3.3.3.2" xref="S3.E5.m1.3.3.1.1.3.3.3.3.2.cmml">𝐱</mi><mo id="S3.E5.m1.3.3.1.1.3.3.3.3.1" xref="S3.E5.m1.3.3.1.1.3.3.3.3.1.cmml">∼</mo><msub id="S3.E5.m1.3.3.1.1.3.3.3.3.3" xref="S3.E5.m1.3.3.1.1.3.3.3.3.3.cmml"><mi id="S3.E5.m1.3.3.1.1.3.3.3.3.3.2" xref="S3.E5.m1.3.3.1.1.3.3.3.3.3.2.cmml">q</mi><mi id="S3.E5.m1.3.3.1.1.3.3.3.3.3.3" xref="S3.E5.m1.3.3.1.1.3.3.3.3.3.3.cmml">f</mi></msub></mrow></msub><mo id="S3.E5.m1.3.3.1.1.3.3.1a" xref="S3.E5.m1.3.3.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E5.m1.3.3.1.1.3.3.4" xref="S3.E5.m1.3.3.1.1.3.3.4.cmml">δ</mi><mo id="S3.E5.m1.3.3.1.1.3.3.1b" xref="S3.E5.m1.3.3.1.1.3.3.1.cmml">⁢</mo><msup id="S3.E5.m1.3.3.1.1.3.3.5" xref="S3.E5.m1.3.3.1.1.3.3.5.cmml"><mi id="S3.E5.m1.3.3.1.1.3.3.5.2" xref="S3.E5.m1.3.3.1.1.3.3.5.2.cmml">f</mi><mn id="S3.E5.m1.3.3.1.1.3.3.5.3" xref="S3.E5.m1.3.3.1.1.3.3.5.3.cmml">2</mn></msup><mo id="S3.E5.m1.3.3.1.1.3.3.1c" xref="S3.E5.m1.3.3.1.1.3.3.1.cmml">⁢</mo><mrow id="S3.E5.m1.3.3.1.1.3.3.6.2" xref="S3.E5.m1.3.3.1.1.3.3.cmml"><mo id="S3.E5.m1.3.3.1.1.3.3.6.2.1" stretchy="false" xref="S3.E5.m1.3.3.1.1.3.3.cmml">(</mo><mi id="S3.E5.m1.2.2" xref="S3.E5.m1.2.2.cmml">𝐱</mi><mo id="S3.E5.m1.3.3.1.1.3.3.6.2.2" stretchy="false" xref="S3.E5.m1.3.3.1.1.3.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E5.m1.3.3.1.2" lspace="0.170em" xref="S3.E5.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.3b"><apply id="S3.E5.m1.3.3.1.1.cmml" xref="S3.E5.m1.3.3.1"><eq id="S3.E5.m1.3.3.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.2"></eq><apply id="S3.E5.m1.3.3.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1"><times id="S3.E5.m1.3.3.1.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.1.2"></times><ci id="S3.E5.m1.3.3.1.1.1.3.cmml" xref="S3.E5.m1.3.3.1.1.1.3">Δ</ci><apply id="S3.E5.m1.3.3.1.1.1.4.cmml" xref="S3.E5.m1.3.3.1.1.1.4"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.1.4.1.cmml" xref="S3.E5.m1.3.3.1.1.1.4">subscript</csymbol><ci id="S3.E5.m1.3.3.1.1.1.4.2.cmml" xref="S3.E5.m1.3.3.1.1.1.4.2">𝐿</ci><ci id="S3.E5.m1.3.3.1.1.1.4.3.cmml" xref="S3.E5.m1.3.3.1.1.1.4.3">𝑓</ci></apply><apply id="S3.E5.m1.3.3.1.1.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1"><csymbol cd="latexml" id="S3.E5.m1.3.3.1.1.1.1.2.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E5.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1"><times id="S3.E5.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1"></times><ci id="S3.E5.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.2">𝛿</ci><ci id="S3.E5.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.3">𝑓</ci></apply></apply></apply><apply id="S3.E5.m1.3.3.1.1.3.cmml" xref="S3.E5.m1.3.3.1.1.3"><minus id="S3.E5.m1.3.3.1.1.3.1.cmml" xref="S3.E5.m1.3.3.1.1.3.1"></minus><apply id="S3.E5.m1.3.3.1.1.3.2.cmml" xref="S3.E5.m1.3.3.1.1.3.2"><times id="S3.E5.m1.3.3.1.1.3.2.1.cmml" xref="S3.E5.m1.3.3.1.1.3.2.1"></times><apply id="S3.E5.m1.3.3.1.1.3.2.2.cmml" xref="S3.E5.m1.3.3.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.3.2.2.1.cmml" xref="S3.E5.m1.3.3.1.1.3.2.2">subscript</csymbol><ci id="S3.E5.m1.3.3.1.1.3.2.2.2.cmml" xref="S3.E5.m1.3.3.1.1.3.2.2.2">𝔼</ci><apply id="S3.E5.m1.3.3.1.1.3.2.2.3.cmml" xref="S3.E5.m1.3.3.1.1.3.2.2.3"><csymbol cd="latexml" id="S3.E5.m1.3.3.1.1.3.2.2.3.1.cmml" xref="S3.E5.m1.3.3.1.1.3.2.2.3.1">similar-to</csymbol><ci id="S3.E5.m1.3.3.1.1.3.2.2.3.2.cmml" xref="S3.E5.m1.3.3.1.1.3.2.2.3.2">𝐱</ci><ci id="S3.E5.m1.3.3.1.1.3.2.2.3.3.cmml" xref="S3.E5.m1.3.3.1.1.3.2.2.3.3">𝑝</ci></apply></apply><ci id="S3.E5.m1.3.3.1.1.3.2.3.cmml" xref="S3.E5.m1.3.3.1.1.3.2.3">𝛿</ci><ci id="S3.E5.m1.3.3.1.1.3.2.4.cmml" xref="S3.E5.m1.3.3.1.1.3.2.4">𝑓</ci><ci id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1">𝐱</ci></apply><apply id="S3.E5.m1.3.3.1.1.3.3.cmml" xref="S3.E5.m1.3.3.1.1.3.3"><times id="S3.E5.m1.3.3.1.1.3.3.1.cmml" xref="S3.E5.m1.3.3.1.1.3.3.1"></times><apply id="S3.E5.m1.3.3.1.1.3.3.2.cmml" xref="S3.E5.m1.3.3.1.1.3.3.2"><divide id="S3.E5.m1.3.3.1.1.3.3.2.1.cmml" xref="S3.E5.m1.3.3.1.1.3.3.2"></divide><cn id="S3.E5.m1.3.3.1.1.3.3.2.2.cmml" type="integer" xref="S3.E5.m1.3.3.1.1.3.3.2.2">1</cn><cn id="S3.E5.m1.3.3.1.1.3.3.2.3.cmml" type="integer" xref="S3.E5.m1.3.3.1.1.3.3.2.3">2</cn></apply><apply id="S3.E5.m1.3.3.1.1.3.3.3.cmml" xref="S3.E5.m1.3.3.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.3.3.3.1.cmml" xref="S3.E5.m1.3.3.1.1.3.3.3">subscript</csymbol><ci id="S3.E5.m1.3.3.1.1.3.3.3.2.cmml" xref="S3.E5.m1.3.3.1.1.3.3.3.2">𝔼</ci><apply id="S3.E5.m1.3.3.1.1.3.3.3.3.cmml" xref="S3.E5.m1.3.3.1.1.3.3.3.3"><csymbol cd="latexml" id="S3.E5.m1.3.3.1.1.3.3.3.3.1.cmml" xref="S3.E5.m1.3.3.1.1.3.3.3.3.1">similar-to</csymbol><ci id="S3.E5.m1.3.3.1.1.3.3.3.3.2.cmml" xref="S3.E5.m1.3.3.1.1.3.3.3.3.2">𝐱</ci><apply id="S3.E5.m1.3.3.1.1.3.3.3.3.3.cmml" xref="S3.E5.m1.3.3.1.1.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.3.3.3.3.3.1.cmml" xref="S3.E5.m1.3.3.1.1.3.3.3.3.3">subscript</csymbol><ci id="S3.E5.m1.3.3.1.1.3.3.3.3.3.2.cmml" xref="S3.E5.m1.3.3.1.1.3.3.3.3.3.2">𝑞</ci><ci id="S3.E5.m1.3.3.1.1.3.3.3.3.3.3.cmml" xref="S3.E5.m1.3.3.1.1.3.3.3.3.3.3">𝑓</ci></apply></apply></apply><ci id="S3.E5.m1.3.3.1.1.3.3.4.cmml" xref="S3.E5.m1.3.3.1.1.3.3.4">𝛿</ci><apply id="S3.E5.m1.3.3.1.1.3.3.5.cmml" xref="S3.E5.m1.3.3.1.1.3.3.5"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.3.3.5.1.cmml" xref="S3.E5.m1.3.3.1.1.3.3.5">superscript</csymbol><ci id="S3.E5.m1.3.3.1.1.3.3.5.2.cmml" xref="S3.E5.m1.3.3.1.1.3.3.5.2">𝑓</ci><cn id="S3.E5.m1.3.3.1.1.3.3.5.3.cmml" type="integer" xref="S3.E5.m1.3.3.1.1.3.3.5.3">2</cn></apply><ci id="S3.E5.m1.2.2.cmml" xref="S3.E5.m1.2.2">𝐱</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.3c">\Delta L_{f}[\delta f]=\mathbb{E}_{\mathbf{x}\sim p}\delta f(\mathbf{x})-\frac%
{1}{2}\mathbb{E}_{\mathbf{x}\sim q_{f}}\delta f^{2}(\mathbf{x})\,.</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.3d">roman_Δ italic_L start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT [ italic_δ italic_f ] = blackboard_E start_POSTSUBSCRIPT bold_x ∼ italic_p end_POSTSUBSCRIPT italic_δ italic_f ( bold_x ) - divide start_ARG 1 end_ARG start_ARG 2 end_ARG blackboard_E start_POSTSUBSCRIPT bold_x ∼ italic_q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_δ italic_f start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ( bold_x ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.p2">
<p class="ltx_p" id="S3.p2.3">We thus formulate our boosting algorithm as modelling the data density with an additive energy function. At each boosting iteration we improve upon the current energy function <math alttext="f_{t}" class="ltx_Math" display="inline" id="S3.p2.1.m1.1"><semantics id="S3.p2.1.m1.1a"><msub id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml"><mi id="S3.p2.1.m1.1.1.2" xref="S3.p2.1.m1.1.1.2.cmml">f</mi><mi id="S3.p2.1.m1.1.1.3" xref="S3.p2.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><apply id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p2.1.m1.1.1.1.cmml" xref="S3.p2.1.m1.1.1">subscript</csymbol><ci id="S3.p2.1.m1.1.1.2.cmml" xref="S3.p2.1.m1.1.1.2">𝑓</ci><ci id="S3.p2.1.m1.1.1.3.cmml" xref="S3.p2.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">f_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.1.m1.1d">italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> by finding an optimal step <math alttext="\delta f^{*}_{t}" class="ltx_Math" display="inline" id="S3.p2.2.m2.1"><semantics id="S3.p2.2.m2.1a"><mrow id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml"><mi id="S3.p2.2.m2.1.1.2" xref="S3.p2.2.m2.1.1.2.cmml">δ</mi><mo id="S3.p2.2.m2.1.1.1" xref="S3.p2.2.m2.1.1.1.cmml">⁢</mo><msubsup id="S3.p2.2.m2.1.1.3" xref="S3.p2.2.m2.1.1.3.cmml"><mi id="S3.p2.2.m2.1.1.3.2.2" xref="S3.p2.2.m2.1.1.3.2.2.cmml">f</mi><mi id="S3.p2.2.m2.1.1.3.3" xref="S3.p2.2.m2.1.1.3.3.cmml">t</mi><mo id="S3.p2.2.m2.1.1.3.2.3" xref="S3.p2.2.m2.1.1.3.2.3.cmml">∗</mo></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><apply id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1"><times id="S3.p2.2.m2.1.1.1.cmml" xref="S3.p2.2.m2.1.1.1"></times><ci id="S3.p2.2.m2.1.1.2.cmml" xref="S3.p2.2.m2.1.1.2">𝛿</ci><apply id="S3.p2.2.m2.1.1.3.cmml" xref="S3.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.p2.2.m2.1.1.3.1.cmml" xref="S3.p2.2.m2.1.1.3">subscript</csymbol><apply id="S3.p2.2.m2.1.1.3.2.cmml" xref="S3.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.p2.2.m2.1.1.3.2.1.cmml" xref="S3.p2.2.m2.1.1.3">superscript</csymbol><ci id="S3.p2.2.m2.1.1.3.2.2.cmml" xref="S3.p2.2.m2.1.1.3.2.2">𝑓</ci><times id="S3.p2.2.m2.1.1.3.2.3.cmml" xref="S3.p2.2.m2.1.1.3.2.3"></times></apply><ci id="S3.p2.2.m2.1.1.3.3.cmml" xref="S3.p2.2.m2.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">\delta f^{*}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.2.m2.1d">italic_δ italic_f start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> that maximizes <math alttext="\Delta L_{f_{t}}[\delta f]" class="ltx_Math" display="inline" id="S3.p2.3.m3.1"><semantics id="S3.p2.3.m3.1a"><mrow id="S3.p2.3.m3.1.1" xref="S3.p2.3.m3.1.1.cmml"><mi id="S3.p2.3.m3.1.1.3" mathvariant="normal" xref="S3.p2.3.m3.1.1.3.cmml">Δ</mi><mo id="S3.p2.3.m3.1.1.2" xref="S3.p2.3.m3.1.1.2.cmml">⁢</mo><msub id="S3.p2.3.m3.1.1.4" xref="S3.p2.3.m3.1.1.4.cmml"><mi id="S3.p2.3.m3.1.1.4.2" xref="S3.p2.3.m3.1.1.4.2.cmml">L</mi><msub id="S3.p2.3.m3.1.1.4.3" xref="S3.p2.3.m3.1.1.4.3.cmml"><mi id="S3.p2.3.m3.1.1.4.3.2" xref="S3.p2.3.m3.1.1.4.3.2.cmml">f</mi><mi id="S3.p2.3.m3.1.1.4.3.3" xref="S3.p2.3.m3.1.1.4.3.3.cmml">t</mi></msub></msub><mo id="S3.p2.3.m3.1.1.2a" xref="S3.p2.3.m3.1.1.2.cmml">⁢</mo><mrow id="S3.p2.3.m3.1.1.1.1" xref="S3.p2.3.m3.1.1.1.2.cmml"><mo id="S3.p2.3.m3.1.1.1.1.2" stretchy="false" xref="S3.p2.3.m3.1.1.1.2.1.cmml">[</mo><mrow id="S3.p2.3.m3.1.1.1.1.1" xref="S3.p2.3.m3.1.1.1.1.1.cmml"><mi id="S3.p2.3.m3.1.1.1.1.1.2" xref="S3.p2.3.m3.1.1.1.1.1.2.cmml">δ</mi><mo id="S3.p2.3.m3.1.1.1.1.1.1" xref="S3.p2.3.m3.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.p2.3.m3.1.1.1.1.1.3" xref="S3.p2.3.m3.1.1.1.1.1.3.cmml">f</mi></mrow><mo id="S3.p2.3.m3.1.1.1.1.3" stretchy="false" xref="S3.p2.3.m3.1.1.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.3.m3.1b"><apply id="S3.p2.3.m3.1.1.cmml" xref="S3.p2.3.m3.1.1"><times id="S3.p2.3.m3.1.1.2.cmml" xref="S3.p2.3.m3.1.1.2"></times><ci id="S3.p2.3.m3.1.1.3.cmml" xref="S3.p2.3.m3.1.1.3">Δ</ci><apply id="S3.p2.3.m3.1.1.4.cmml" xref="S3.p2.3.m3.1.1.4"><csymbol cd="ambiguous" id="S3.p2.3.m3.1.1.4.1.cmml" xref="S3.p2.3.m3.1.1.4">subscript</csymbol><ci id="S3.p2.3.m3.1.1.4.2.cmml" xref="S3.p2.3.m3.1.1.4.2">𝐿</ci><apply id="S3.p2.3.m3.1.1.4.3.cmml" xref="S3.p2.3.m3.1.1.4.3"><csymbol cd="ambiguous" id="S3.p2.3.m3.1.1.4.3.1.cmml" xref="S3.p2.3.m3.1.1.4.3">subscript</csymbol><ci id="S3.p2.3.m3.1.1.4.3.2.cmml" xref="S3.p2.3.m3.1.1.4.3.2">𝑓</ci><ci id="S3.p2.3.m3.1.1.4.3.3.cmml" xref="S3.p2.3.m3.1.1.4.3.3">𝑡</ci></apply></apply><apply id="S3.p2.3.m3.1.1.1.2.cmml" xref="S3.p2.3.m3.1.1.1.1"><csymbol cd="latexml" id="S3.p2.3.m3.1.1.1.2.1.cmml" xref="S3.p2.3.m3.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.p2.3.m3.1.1.1.1.1.cmml" xref="S3.p2.3.m3.1.1.1.1.1"><times id="S3.p2.3.m3.1.1.1.1.1.1.cmml" xref="S3.p2.3.m3.1.1.1.1.1.1"></times><ci id="S3.p2.3.m3.1.1.1.1.1.2.cmml" xref="S3.p2.3.m3.1.1.1.1.1.2">𝛿</ci><ci id="S3.p2.3.m3.1.1.1.1.1.3.cmml" xref="S3.p2.3.m3.1.1.1.1.1.3">𝑓</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m3.1c">\Delta L_{f_{t}}[\delta f]</annotation><annotation encoding="application/x-llamapun" id="S3.p2.3.m3.1d">roman_Δ italic_L start_POSTSUBSCRIPT italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ italic_δ italic_f ]</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\delta f^{*}_{t}=\arg\max_{\delta f\in\mathcal{H}_{t}}\Delta L_{f_{t}}[\delta f%
]\,," class="ltx_Math" display="block" id="S3.E6.m1.1"><semantics id="S3.E6.m1.1a"><mrow id="S3.E6.m1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.1.3.2.cmml">δ</mi><mo id="S3.E6.m1.1.1.1.1.3.1" xref="S3.E6.m1.1.1.1.1.3.1.cmml">⁢</mo><msubsup id="S3.E6.m1.1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.1.3.3.cmml"><mi id="S3.E6.m1.1.1.1.1.3.3.2.2" xref="S3.E6.m1.1.1.1.1.3.3.2.2.cmml">f</mi><mi id="S3.E6.m1.1.1.1.1.3.3.3" xref="S3.E6.m1.1.1.1.1.3.3.3.cmml">t</mi><mo id="S3.E6.m1.1.1.1.1.3.3.2.3" xref="S3.E6.m1.1.1.1.1.3.3.2.3.cmml">∗</mo></msubsup></mrow><mo id="S3.E6.m1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E6.m1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.3.1" xref="S3.E6.m1.1.1.1.1.1.3.1.cmml">arg</mi><mo id="S3.E6.m1.1.1.1.1.1.3a" lspace="0.167em" xref="S3.E6.m1.1.1.1.1.1.3.cmml">⁡</mo><mrow id="S3.E6.m1.1.1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.1.1.3.2.cmml"><munder id="S3.E6.m1.1.1.1.1.1.3.2.1" xref="S3.E6.m1.1.1.1.1.1.3.2.1.cmml"><mi id="S3.E6.m1.1.1.1.1.1.3.2.1.2" xref="S3.E6.m1.1.1.1.1.1.3.2.1.2.cmml">max</mi><mrow id="S3.E6.m1.1.1.1.1.1.3.2.1.3" xref="S3.E6.m1.1.1.1.1.1.3.2.1.3.cmml"><mrow id="S3.E6.m1.1.1.1.1.1.3.2.1.3.2" xref="S3.E6.m1.1.1.1.1.1.3.2.1.3.2.cmml"><mi id="S3.E6.m1.1.1.1.1.1.3.2.1.3.2.2" xref="S3.E6.m1.1.1.1.1.1.3.2.1.3.2.2.cmml">δ</mi><mo id="S3.E6.m1.1.1.1.1.1.3.2.1.3.2.1" xref="S3.E6.m1.1.1.1.1.1.3.2.1.3.2.1.cmml">⁢</mo><mi id="S3.E6.m1.1.1.1.1.1.3.2.1.3.2.3" xref="S3.E6.m1.1.1.1.1.1.3.2.1.3.2.3.cmml">f</mi></mrow><mo id="S3.E6.m1.1.1.1.1.1.3.2.1.3.1" xref="S3.E6.m1.1.1.1.1.1.3.2.1.3.1.cmml">∈</mo><msub id="S3.E6.m1.1.1.1.1.1.3.2.1.3.3" xref="S3.E6.m1.1.1.1.1.1.3.2.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.1.1.1.1.1.3.2.1.3.3.2" xref="S3.E6.m1.1.1.1.1.1.3.2.1.3.3.2.cmml">ℋ</mi><mi id="S3.E6.m1.1.1.1.1.1.3.2.1.3.3.3" xref="S3.E6.m1.1.1.1.1.1.3.2.1.3.3.3.cmml">t</mi></msub></mrow></munder><mo id="S3.E6.m1.1.1.1.1.1.3.2a" lspace="0.167em" xref="S3.E6.m1.1.1.1.1.1.3.2.cmml">⁡</mo><mrow id="S3.E6.m1.1.1.1.1.1.3.2.2" xref="S3.E6.m1.1.1.1.1.1.3.2.2.cmml"><mi id="S3.E6.m1.1.1.1.1.1.3.2.2.2" mathvariant="normal" xref="S3.E6.m1.1.1.1.1.1.3.2.2.2.cmml">Δ</mi><mo id="S3.E6.m1.1.1.1.1.1.3.2.2.1" xref="S3.E6.m1.1.1.1.1.1.3.2.2.1.cmml">⁢</mo><msub id="S3.E6.m1.1.1.1.1.1.3.2.2.3" xref="S3.E6.m1.1.1.1.1.1.3.2.2.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.3.2.2.3.2" xref="S3.E6.m1.1.1.1.1.1.3.2.2.3.2.cmml">L</mi><msub id="S3.E6.m1.1.1.1.1.1.3.2.2.3.3" xref="S3.E6.m1.1.1.1.1.1.3.2.2.3.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.3.2.2.3.3.2" xref="S3.E6.m1.1.1.1.1.1.3.2.2.3.3.2.cmml">f</mi><mi id="S3.E6.m1.1.1.1.1.1.3.2.2.3.3.3" xref="S3.E6.m1.1.1.1.1.1.3.2.2.3.3.3.cmml">t</mi></msub></msub></mrow></mrow></mrow><mo id="S3.E6.m1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E6.m1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.2.cmml"><mo id="S3.E6.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E6.m1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E6.m1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.cmml">δ</mi><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3.cmml">f</mi></mrow><mo id="S3.E6.m1.1.1.1.1.1.1.1.3" rspace="0.170em" stretchy="false" xref="S3.E6.m1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S3.E6.m1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1"><eq id="S3.E6.m1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.2"></eq><apply id="S3.E6.m1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.3"><times id="S3.E6.m1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.3.1"></times><ci id="S3.E6.m1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.3.2">𝛿</ci><apply id="S3.E6.m1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.3.3.1.cmml" xref="S3.E6.m1.1.1.1.1.3.3">subscript</csymbol><apply id="S3.E6.m1.1.1.1.1.3.3.2.cmml" xref="S3.E6.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.3.3.2.1.cmml" xref="S3.E6.m1.1.1.1.1.3.3">superscript</csymbol><ci id="S3.E6.m1.1.1.1.1.3.3.2.2.cmml" xref="S3.E6.m1.1.1.1.1.3.3.2.2">𝑓</ci><times id="S3.E6.m1.1.1.1.1.3.3.2.3.cmml" xref="S3.E6.m1.1.1.1.1.3.3.2.3"></times></apply><ci id="S3.E6.m1.1.1.1.1.3.3.3.cmml" xref="S3.E6.m1.1.1.1.1.3.3.3">𝑡</ci></apply></apply><apply id="S3.E6.m1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1"><times id="S3.E6.m1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.2"></times><apply id="S3.E6.m1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.3"><arg id="S3.E6.m1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.3.1"></arg><apply id="S3.E6.m1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2"><apply id="S3.E6.m1.1.1.1.1.1.3.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.3.2.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.1">subscript</csymbol><max id="S3.E6.m1.1.1.1.1.1.3.2.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.1.2"></max><apply id="S3.E6.m1.1.1.1.1.1.3.2.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.1.3"><in id="S3.E6.m1.1.1.1.1.1.3.2.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.1.3.1"></in><apply id="S3.E6.m1.1.1.1.1.1.3.2.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.1.3.2"><times id="S3.E6.m1.1.1.1.1.1.3.2.1.3.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.1.3.2.1"></times><ci id="S3.E6.m1.1.1.1.1.1.3.2.1.3.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.1.3.2.2">𝛿</ci><ci id="S3.E6.m1.1.1.1.1.1.3.2.1.3.2.3.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.1.3.2.3">𝑓</ci></apply><apply id="S3.E6.m1.1.1.1.1.1.3.2.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.1.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.3.2.1.3.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.1.3.3">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.3.2.1.3.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.1.3.3.2">ℋ</ci><ci id="S3.E6.m1.1.1.1.1.1.3.2.1.3.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="S3.E6.m1.1.1.1.1.1.3.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.2"><times id="S3.E6.m1.1.1.1.1.1.3.2.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.2.1"></times><ci id="S3.E6.m1.1.1.1.1.1.3.2.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.2.2">Δ</ci><apply id="S3.E6.m1.1.1.1.1.1.3.2.2.3.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.3.2.2.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.2.3">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.3.2.2.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.2.3.2">𝐿</ci><apply id="S3.E6.m1.1.1.1.1.1.3.2.2.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.2.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.3.2.2.3.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.2.3.3">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.3.2.2.3.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.2.3.3.2">𝑓</ci><ci id="S3.E6.m1.1.1.1.1.1.3.2.2.3.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.2.3.3.3">𝑡</ci></apply></apply></apply></apply></apply><apply id="S3.E6.m1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E6.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1"><times id="S3.E6.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1"></times><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2">𝛿</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3">𝑓</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">\delta f^{*}_{t}=\arg\max_{\delta f\in\mathcal{H}_{t}}\Delta L_{f_{t}}[\delta f%
]\,,</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.1d">italic_δ italic_f start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = roman_arg roman_max start_POSTSUBSCRIPT italic_δ italic_f ∈ caligraphic_H start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT roman_Δ italic_L start_POSTSUBSCRIPT italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ italic_δ italic_f ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.p2.5">where <math alttext="\mathcal{H}_{t}" class="ltx_Math" display="inline" id="S3.p2.4.m1.1"><semantics id="S3.p2.4.m1.1a"><msub id="S3.p2.4.m1.1.1" xref="S3.p2.4.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.4.m1.1.1.2" xref="S3.p2.4.m1.1.1.2.cmml">ℋ</mi><mi id="S3.p2.4.m1.1.1.3" xref="S3.p2.4.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.4.m1.1b"><apply id="S3.p2.4.m1.1.1.cmml" xref="S3.p2.4.m1.1.1"><csymbol cd="ambiguous" id="S3.p2.4.m1.1.1.1.cmml" xref="S3.p2.4.m1.1.1">subscript</csymbol><ci id="S3.p2.4.m1.1.1.2.cmml" xref="S3.p2.4.m1.1.1.2">ℋ</ci><ci id="S3.p2.4.m1.1.1.3.cmml" xref="S3.p2.4.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.4.m1.1c">\mathcal{H}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.4.m1.1d">caligraphic_H start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is an appropriate space of functions (satisfying <math alttext="\mathbb{E}_{\mathbf{x}\sim q_{f_{t}}}\delta f(\mathbf{x})=0" class="ltx_Math" display="inline" id="S3.p2.5.m2.1"><semantics id="S3.p2.5.m2.1a"><mrow id="S3.p2.5.m2.1.2" xref="S3.p2.5.m2.1.2.cmml"><mrow id="S3.p2.5.m2.1.2.2" xref="S3.p2.5.m2.1.2.2.cmml"><msub id="S3.p2.5.m2.1.2.2.2" xref="S3.p2.5.m2.1.2.2.2.cmml"><mi id="S3.p2.5.m2.1.2.2.2.2" xref="S3.p2.5.m2.1.2.2.2.2.cmml">𝔼</mi><mrow id="S3.p2.5.m2.1.2.2.2.3" xref="S3.p2.5.m2.1.2.2.2.3.cmml"><mi id="S3.p2.5.m2.1.2.2.2.3.2" xref="S3.p2.5.m2.1.2.2.2.3.2.cmml">𝐱</mi><mo id="S3.p2.5.m2.1.2.2.2.3.1" xref="S3.p2.5.m2.1.2.2.2.3.1.cmml">∼</mo><msub id="S3.p2.5.m2.1.2.2.2.3.3" xref="S3.p2.5.m2.1.2.2.2.3.3.cmml"><mi id="S3.p2.5.m2.1.2.2.2.3.3.2" xref="S3.p2.5.m2.1.2.2.2.3.3.2.cmml">q</mi><msub id="S3.p2.5.m2.1.2.2.2.3.3.3" xref="S3.p2.5.m2.1.2.2.2.3.3.3.cmml"><mi id="S3.p2.5.m2.1.2.2.2.3.3.3.2" xref="S3.p2.5.m2.1.2.2.2.3.3.3.2.cmml">f</mi><mi id="S3.p2.5.m2.1.2.2.2.3.3.3.3" xref="S3.p2.5.m2.1.2.2.2.3.3.3.3.cmml">t</mi></msub></msub></mrow></msub><mo id="S3.p2.5.m2.1.2.2.1" xref="S3.p2.5.m2.1.2.2.1.cmml">⁢</mo><mi id="S3.p2.5.m2.1.2.2.3" xref="S3.p2.5.m2.1.2.2.3.cmml">δ</mi><mo id="S3.p2.5.m2.1.2.2.1a" xref="S3.p2.5.m2.1.2.2.1.cmml">⁢</mo><mi id="S3.p2.5.m2.1.2.2.4" xref="S3.p2.5.m2.1.2.2.4.cmml">f</mi><mo id="S3.p2.5.m2.1.2.2.1b" xref="S3.p2.5.m2.1.2.2.1.cmml">⁢</mo><mrow id="S3.p2.5.m2.1.2.2.5.2" xref="S3.p2.5.m2.1.2.2.cmml"><mo id="S3.p2.5.m2.1.2.2.5.2.1" stretchy="false" xref="S3.p2.5.m2.1.2.2.cmml">(</mo><mi id="S3.p2.5.m2.1.1" xref="S3.p2.5.m2.1.1.cmml">𝐱</mi><mo id="S3.p2.5.m2.1.2.2.5.2.2" stretchy="false" xref="S3.p2.5.m2.1.2.2.cmml">)</mo></mrow></mrow><mo id="S3.p2.5.m2.1.2.1" xref="S3.p2.5.m2.1.2.1.cmml">=</mo><mn id="S3.p2.5.m2.1.2.3" xref="S3.p2.5.m2.1.2.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.5.m2.1b"><apply id="S3.p2.5.m2.1.2.cmml" xref="S3.p2.5.m2.1.2"><eq id="S3.p2.5.m2.1.2.1.cmml" xref="S3.p2.5.m2.1.2.1"></eq><apply id="S3.p2.5.m2.1.2.2.cmml" xref="S3.p2.5.m2.1.2.2"><times id="S3.p2.5.m2.1.2.2.1.cmml" xref="S3.p2.5.m2.1.2.2.1"></times><apply id="S3.p2.5.m2.1.2.2.2.cmml" xref="S3.p2.5.m2.1.2.2.2"><csymbol cd="ambiguous" id="S3.p2.5.m2.1.2.2.2.1.cmml" xref="S3.p2.5.m2.1.2.2.2">subscript</csymbol><ci id="S3.p2.5.m2.1.2.2.2.2.cmml" xref="S3.p2.5.m2.1.2.2.2.2">𝔼</ci><apply id="S3.p2.5.m2.1.2.2.2.3.cmml" xref="S3.p2.5.m2.1.2.2.2.3"><csymbol cd="latexml" id="S3.p2.5.m2.1.2.2.2.3.1.cmml" xref="S3.p2.5.m2.1.2.2.2.3.1">similar-to</csymbol><ci id="S3.p2.5.m2.1.2.2.2.3.2.cmml" xref="S3.p2.5.m2.1.2.2.2.3.2">𝐱</ci><apply id="S3.p2.5.m2.1.2.2.2.3.3.cmml" xref="S3.p2.5.m2.1.2.2.2.3.3"><csymbol cd="ambiguous" id="S3.p2.5.m2.1.2.2.2.3.3.1.cmml" xref="S3.p2.5.m2.1.2.2.2.3.3">subscript</csymbol><ci id="S3.p2.5.m2.1.2.2.2.3.3.2.cmml" xref="S3.p2.5.m2.1.2.2.2.3.3.2">𝑞</ci><apply id="S3.p2.5.m2.1.2.2.2.3.3.3.cmml" xref="S3.p2.5.m2.1.2.2.2.3.3.3"><csymbol cd="ambiguous" id="S3.p2.5.m2.1.2.2.2.3.3.3.1.cmml" xref="S3.p2.5.m2.1.2.2.2.3.3.3">subscript</csymbol><ci id="S3.p2.5.m2.1.2.2.2.3.3.3.2.cmml" xref="S3.p2.5.m2.1.2.2.2.3.3.3.2">𝑓</ci><ci id="S3.p2.5.m2.1.2.2.2.3.3.3.3.cmml" xref="S3.p2.5.m2.1.2.2.2.3.3.3.3">𝑡</ci></apply></apply></apply></apply><ci id="S3.p2.5.m2.1.2.2.3.cmml" xref="S3.p2.5.m2.1.2.2.3">𝛿</ci><ci id="S3.p2.5.m2.1.2.2.4.cmml" xref="S3.p2.5.m2.1.2.2.4">𝑓</ci><ci id="S3.p2.5.m2.1.1.cmml" xref="S3.p2.5.m2.1.1">𝐱</ci></apply><cn id="S3.p2.5.m2.1.2.3.cmml" type="integer" xref="S3.p2.5.m2.1.2.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.5.m2.1c">\mathbb{E}_{\mathbf{x}\sim q_{f_{t}}}\delta f(\mathbf{x})=0</annotation><annotation encoding="application/x-llamapun" id="S3.p2.5.m2.1d">blackboard_E start_POSTSUBSCRIPT bold_x ∼ italic_q start_POSTSUBSCRIPT italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_δ italic_f ( bold_x ) = 0</annotation></semantics></math> if equation <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S3.E5" title="In 3 NRGBoost ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">5</span></a> is used).
The solution to this problem can be interpreted as a Newton step in the space of energy functions.
Because for an EBM, the Fisher Information matrix with respect to the energy function and the hessian of the expected log-likelihood are the same (see Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A1" title="Appendix A Theory ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">A</span></a>),
we can also interpret the solution to equation <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S3.E6" title="In 3 NRGBoost ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">6</span></a> as a natural gradient step.
This approach is analogous to the second order step implemented in modern gradient boosting libraries such as XGBoost <cite class="ltx_cite ltx_citemacro_citep">(Chen &amp; Guestrin, <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib4" title="">2016</a>)</cite>
and LightGBM <cite class="ltx_cite ltx_citemacro_citep">(Ke et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib18" title="">2017</a>)</cite> and which can be traced back to <cite class="ltx_cite ltx_citemacro_cite">Friedman et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib12" title="">2000</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.p3">
<p class="ltx_p" id="S3.p3.5">In updating the current iterate, <math alttext="f_{t+1}=f_{t}+\alpha_{t}\cdot\delta f^{*}_{t}" class="ltx_Math" display="inline" id="S3.p3.1.m1.1"><semantics id="S3.p3.1.m1.1a"><mrow id="S3.p3.1.m1.1.1" xref="S3.p3.1.m1.1.1.cmml"><msub id="S3.p3.1.m1.1.1.2" xref="S3.p3.1.m1.1.1.2.cmml"><mi id="S3.p3.1.m1.1.1.2.2" xref="S3.p3.1.m1.1.1.2.2.cmml">f</mi><mrow id="S3.p3.1.m1.1.1.2.3" xref="S3.p3.1.m1.1.1.2.3.cmml"><mi id="S3.p3.1.m1.1.1.2.3.2" xref="S3.p3.1.m1.1.1.2.3.2.cmml">t</mi><mo id="S3.p3.1.m1.1.1.2.3.1" xref="S3.p3.1.m1.1.1.2.3.1.cmml">+</mo><mn id="S3.p3.1.m1.1.1.2.3.3" xref="S3.p3.1.m1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.p3.1.m1.1.1.1" xref="S3.p3.1.m1.1.1.1.cmml">=</mo><mrow id="S3.p3.1.m1.1.1.3" xref="S3.p3.1.m1.1.1.3.cmml"><msub id="S3.p3.1.m1.1.1.3.2" xref="S3.p3.1.m1.1.1.3.2.cmml"><mi id="S3.p3.1.m1.1.1.3.2.2" xref="S3.p3.1.m1.1.1.3.2.2.cmml">f</mi><mi id="S3.p3.1.m1.1.1.3.2.3" xref="S3.p3.1.m1.1.1.3.2.3.cmml">t</mi></msub><mo id="S3.p3.1.m1.1.1.3.1" xref="S3.p3.1.m1.1.1.3.1.cmml">+</mo><mrow id="S3.p3.1.m1.1.1.3.3" xref="S3.p3.1.m1.1.1.3.3.cmml"><mrow id="S3.p3.1.m1.1.1.3.3.2" xref="S3.p3.1.m1.1.1.3.3.2.cmml"><msub id="S3.p3.1.m1.1.1.3.3.2.2" xref="S3.p3.1.m1.1.1.3.3.2.2.cmml"><mi id="S3.p3.1.m1.1.1.3.3.2.2.2" xref="S3.p3.1.m1.1.1.3.3.2.2.2.cmml">α</mi><mi id="S3.p3.1.m1.1.1.3.3.2.2.3" xref="S3.p3.1.m1.1.1.3.3.2.2.3.cmml">t</mi></msub><mo id="S3.p3.1.m1.1.1.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="S3.p3.1.m1.1.1.3.3.2.1.cmml">⋅</mo><mi id="S3.p3.1.m1.1.1.3.3.2.3" xref="S3.p3.1.m1.1.1.3.3.2.3.cmml">δ</mi></mrow><mo id="S3.p3.1.m1.1.1.3.3.1" xref="S3.p3.1.m1.1.1.3.3.1.cmml">⁢</mo><msubsup id="S3.p3.1.m1.1.1.3.3.3" xref="S3.p3.1.m1.1.1.3.3.3.cmml"><mi id="S3.p3.1.m1.1.1.3.3.3.2.2" xref="S3.p3.1.m1.1.1.3.3.3.2.2.cmml">f</mi><mi id="S3.p3.1.m1.1.1.3.3.3.3" xref="S3.p3.1.m1.1.1.3.3.3.3.cmml">t</mi><mo id="S3.p3.1.m1.1.1.3.3.3.2.3" xref="S3.p3.1.m1.1.1.3.3.3.2.3.cmml">∗</mo></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.1b"><apply id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1"><eq id="S3.p3.1.m1.1.1.1.cmml" xref="S3.p3.1.m1.1.1.1"></eq><apply id="S3.p3.1.m1.1.1.2.cmml" xref="S3.p3.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.p3.1.m1.1.1.2.1.cmml" xref="S3.p3.1.m1.1.1.2">subscript</csymbol><ci id="S3.p3.1.m1.1.1.2.2.cmml" xref="S3.p3.1.m1.1.1.2.2">𝑓</ci><apply id="S3.p3.1.m1.1.1.2.3.cmml" xref="S3.p3.1.m1.1.1.2.3"><plus id="S3.p3.1.m1.1.1.2.3.1.cmml" xref="S3.p3.1.m1.1.1.2.3.1"></plus><ci id="S3.p3.1.m1.1.1.2.3.2.cmml" xref="S3.p3.1.m1.1.1.2.3.2">𝑡</ci><cn id="S3.p3.1.m1.1.1.2.3.3.cmml" type="integer" xref="S3.p3.1.m1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.p3.1.m1.1.1.3.cmml" xref="S3.p3.1.m1.1.1.3"><plus id="S3.p3.1.m1.1.1.3.1.cmml" xref="S3.p3.1.m1.1.1.3.1"></plus><apply id="S3.p3.1.m1.1.1.3.2.cmml" xref="S3.p3.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.p3.1.m1.1.1.3.2.1.cmml" xref="S3.p3.1.m1.1.1.3.2">subscript</csymbol><ci id="S3.p3.1.m1.1.1.3.2.2.cmml" xref="S3.p3.1.m1.1.1.3.2.2">𝑓</ci><ci id="S3.p3.1.m1.1.1.3.2.3.cmml" xref="S3.p3.1.m1.1.1.3.2.3">𝑡</ci></apply><apply id="S3.p3.1.m1.1.1.3.3.cmml" xref="S3.p3.1.m1.1.1.3.3"><times id="S3.p3.1.m1.1.1.3.3.1.cmml" xref="S3.p3.1.m1.1.1.3.3.1"></times><apply id="S3.p3.1.m1.1.1.3.3.2.cmml" xref="S3.p3.1.m1.1.1.3.3.2"><ci id="S3.p3.1.m1.1.1.3.3.2.1.cmml" xref="S3.p3.1.m1.1.1.3.3.2.1">⋅</ci><apply id="S3.p3.1.m1.1.1.3.3.2.2.cmml" xref="S3.p3.1.m1.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S3.p3.1.m1.1.1.3.3.2.2.1.cmml" xref="S3.p3.1.m1.1.1.3.3.2.2">subscript</csymbol><ci id="S3.p3.1.m1.1.1.3.3.2.2.2.cmml" xref="S3.p3.1.m1.1.1.3.3.2.2.2">𝛼</ci><ci id="S3.p3.1.m1.1.1.3.3.2.2.3.cmml" xref="S3.p3.1.m1.1.1.3.3.2.2.3">𝑡</ci></apply><ci id="S3.p3.1.m1.1.1.3.3.2.3.cmml" xref="S3.p3.1.m1.1.1.3.3.2.3">𝛿</ci></apply><apply id="S3.p3.1.m1.1.1.3.3.3.cmml" xref="S3.p3.1.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.p3.1.m1.1.1.3.3.3.1.cmml" xref="S3.p3.1.m1.1.1.3.3.3">subscript</csymbol><apply id="S3.p3.1.m1.1.1.3.3.3.2.cmml" xref="S3.p3.1.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.p3.1.m1.1.1.3.3.3.2.1.cmml" xref="S3.p3.1.m1.1.1.3.3.3">superscript</csymbol><ci id="S3.p3.1.m1.1.1.3.3.3.2.2.cmml" xref="S3.p3.1.m1.1.1.3.3.3.2.2">𝑓</ci><times id="S3.p3.1.m1.1.1.3.3.3.2.3.cmml" xref="S3.p3.1.m1.1.1.3.3.3.2.3"></times></apply><ci id="S3.p3.1.m1.1.1.3.3.3.3.cmml" xref="S3.p3.1.m1.1.1.3.3.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.1c">f_{t+1}=f_{t}+\alpha_{t}\cdot\delta f^{*}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.1.m1.1d">italic_f start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT = italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ⋅ italic_δ italic_f start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, we scale <math alttext="\delta f^{*}_{t}" class="ltx_Math" display="inline" id="S3.p3.2.m2.1"><semantics id="S3.p3.2.m2.1a"><mrow id="S3.p3.2.m2.1.1" xref="S3.p3.2.m2.1.1.cmml"><mi id="S3.p3.2.m2.1.1.2" xref="S3.p3.2.m2.1.1.2.cmml">δ</mi><mo id="S3.p3.2.m2.1.1.1" xref="S3.p3.2.m2.1.1.1.cmml">⁢</mo><msubsup id="S3.p3.2.m2.1.1.3" xref="S3.p3.2.m2.1.1.3.cmml"><mi id="S3.p3.2.m2.1.1.3.2.2" xref="S3.p3.2.m2.1.1.3.2.2.cmml">f</mi><mi id="S3.p3.2.m2.1.1.3.3" xref="S3.p3.2.m2.1.1.3.3.cmml">t</mi><mo id="S3.p3.2.m2.1.1.3.2.3" xref="S3.p3.2.m2.1.1.3.2.3.cmml">∗</mo></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.2.m2.1b"><apply id="S3.p3.2.m2.1.1.cmml" xref="S3.p3.2.m2.1.1"><times id="S3.p3.2.m2.1.1.1.cmml" xref="S3.p3.2.m2.1.1.1"></times><ci id="S3.p3.2.m2.1.1.2.cmml" xref="S3.p3.2.m2.1.1.2">𝛿</ci><apply id="S3.p3.2.m2.1.1.3.cmml" xref="S3.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.p3.2.m2.1.1.3.1.cmml" xref="S3.p3.2.m2.1.1.3">subscript</csymbol><apply id="S3.p3.2.m2.1.1.3.2.cmml" xref="S3.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.p3.2.m2.1.1.3.2.1.cmml" xref="S3.p3.2.m2.1.1.3">superscript</csymbol><ci id="S3.p3.2.m2.1.1.3.2.2.cmml" xref="S3.p3.2.m2.1.1.3.2.2">𝑓</ci><times id="S3.p3.2.m2.1.1.3.2.3.cmml" xref="S3.p3.2.m2.1.1.3.2.3"></times></apply><ci id="S3.p3.2.m2.1.1.3.3.cmml" xref="S3.p3.2.m2.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.2.m2.1c">\delta f^{*}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.2.m2.1d">italic_δ italic_f start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> by an additional scalar step-size <math alttext="\alpha_{t}" class="ltx_Math" display="inline" id="S3.p3.3.m3.1"><semantics id="S3.p3.3.m3.1a"><msub id="S3.p3.3.m3.1.1" xref="S3.p3.3.m3.1.1.cmml"><mi id="S3.p3.3.m3.1.1.2" xref="S3.p3.3.m3.1.1.2.cmml">α</mi><mi id="S3.p3.3.m3.1.1.3" xref="S3.p3.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.3.m3.1b"><apply id="S3.p3.3.m3.1.1.cmml" xref="S3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p3.3.m3.1.1.1.cmml" xref="S3.p3.3.m3.1.1">subscript</csymbol><ci id="S3.p3.3.m3.1.1.2.cmml" xref="S3.p3.3.m3.1.1.2">𝛼</ci><ci id="S3.p3.3.m3.1.1.3.cmml" xref="S3.p3.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.3.m3.1c">\alpha_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.3.m3.1d">italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>.
This can be interpreted as a globalization strategy to account for the fact that the quadratic approximation in equation <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S3.E4" title="In 3 NRGBoost ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">4</span></a>
is not necessarily valid over large steps in function space. A common strategy in nonlinear optimization would be to select <math alttext="\alpha_{t}" class="ltx_Math" display="inline" id="S3.p3.4.m4.1"><semantics id="S3.p3.4.m4.1a"><msub id="S3.p3.4.m4.1.1" xref="S3.p3.4.m4.1.1.cmml"><mi id="S3.p3.4.m4.1.1.2" xref="S3.p3.4.m4.1.1.2.cmml">α</mi><mi id="S3.p3.4.m4.1.1.3" xref="S3.p3.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.4.m4.1b"><apply id="S3.p3.4.m4.1.1.cmml" xref="S3.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.p3.4.m4.1.1.1.cmml" xref="S3.p3.4.m4.1.1">subscript</csymbol><ci id="S3.p3.4.m4.1.1.2.cmml" xref="S3.p3.4.m4.1.1.2">𝛼</ci><ci id="S3.p3.4.m4.1.1.3.cmml" xref="S3.p3.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.4.m4.1c">\alpha_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.4.m4.1d">italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> via a line search based on the original log-likelihood.
Common practice in discriminative boosting however is to interpret this step size as a regularization parameter and to select a fixed value in <math alttext="]0,1]" class="ltx_math_unparsed" display="inline" id="S3.p3.5.m5.1"><semantics id="S3.p3.5.m5.1a"><mrow id="S3.p3.5.m5.1b"><mo id="S3.p3.5.m5.1.1" stretchy="false">]</mo><mn id="S3.p3.5.m5.1.2">0</mn><mo id="S3.p3.5.m5.1.3">,</mo><mn id="S3.p3.5.m5.1.4">1</mn><mo id="S3.p3.5.m5.1.5" stretchy="false">]</mo></mrow><annotation encoding="application/x-tex" id="S3.p3.5.m5.1c">]0,1]</annotation><annotation encoding="application/x-llamapun" id="S3.p3.5.m5.1d">] 0 , 1 ]</annotation></semantics></math> with (more) smaller steps typically
outperforming fewer larger ones when it comes to generalization.
We choose to adopt a hybrid strategy, first selecting an optimal step size by line search and then shrinking it by a fixed factor.
We find that this typically accelerates convergence allowing the algorithm to take comparatively larger steps that increase the likelihood in the initial phase of boosting.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.p4">
<p class="ltx_p" id="S3.p4.3">For a starting point, <math alttext="f_{0}" class="ltx_Math" display="inline" id="S3.p4.1.m1.1"><semantics id="S3.p4.1.m1.1a"><msub id="S3.p4.1.m1.1.1" xref="S3.p4.1.m1.1.1.cmml"><mi id="S3.p4.1.m1.1.1.2" xref="S3.p4.1.m1.1.1.2.cmml">f</mi><mn id="S3.p4.1.m1.1.1.3" xref="S3.p4.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.p4.1.m1.1b"><apply id="S3.p4.1.m1.1.1.cmml" xref="S3.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p4.1.m1.1.1.1.cmml" xref="S3.p4.1.m1.1.1">subscript</csymbol><ci id="S3.p4.1.m1.1.1.2.cmml" xref="S3.p4.1.m1.1.1.2">𝑓</ci><cn id="S3.p4.1.m1.1.1.3.cmml" type="integer" xref="S3.p4.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.1.m1.1c">f_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.p4.1.m1.1d">italic_f start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>, we can choose the logarithm of any probability distribution over <math alttext="\mathcal{X}" class="ltx_Math" display="inline" id="S3.p4.2.m2.1"><semantics id="S3.p4.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p4.2.m2.1.1" xref="S3.p4.2.m2.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="S3.p4.2.m2.1b"><ci id="S3.p4.2.m2.1.1.cmml" xref="S3.p4.2.m2.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.2.m2.1c">\mathcal{X}</annotation><annotation encoding="application/x-llamapun" id="S3.p4.2.m2.1d">caligraphic_X</annotation></semantics></math> as long as it is easy to evaluate.
Sensible choices are a uniform distribution (i.e., <math alttext="f\equiv 0" class="ltx_Math" display="inline" id="S3.p4.3.m3.1"><semantics id="S3.p4.3.m3.1a"><mrow id="S3.p4.3.m3.1.1" xref="S3.p4.3.m3.1.1.cmml"><mi id="S3.p4.3.m3.1.1.2" xref="S3.p4.3.m3.1.1.2.cmml">f</mi><mo id="S3.p4.3.m3.1.1.1" xref="S3.p4.3.m3.1.1.1.cmml">≡</mo><mn id="S3.p4.3.m3.1.1.3" xref="S3.p4.3.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.3.m3.1b"><apply id="S3.p4.3.m3.1.1.cmml" xref="S3.p4.3.m3.1.1"><equivalent id="S3.p4.3.m3.1.1.1.cmml" xref="S3.p4.3.m3.1.1.1"></equivalent><ci id="S3.p4.3.m3.1.1.2.cmml" xref="S3.p4.3.m3.1.1.2">𝑓</ci><cn id="S3.p4.3.m3.1.1.3.cmml" type="integer" xref="S3.p4.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.3.m3.1c">f\equiv 0</annotation><annotation encoding="application/x-llamapun" id="S3.p4.3.m3.1d">italic_f ≡ 0</annotation></semantics></math>), the product of marginals for the training set, or any mixture distribution between these two.
In Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S3.F2" title="Figure 2 ‣ 3.1 Weak Learners ‣ 3 NRGBoost ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">2</span></a> we show an example of NRGBoost starting from a uniform distribution and learning a toy 2D data density.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Weak Learners</h3>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="129" id="S3.F2.g1" src="x2.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Density learned by NRGBoost at different boosting iterations (1, 3, 10 and 100), for a toy dataset (shown right), starting from a uniform distribution.
Weak learners are trees with 16 leaves.
</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.2">As a weak learner we will consider piecewise constant functions defined by binary trees over the input space.
Letting <math alttext="\bigcup_{j=1}^{J}X_{j}=\mathcal{X}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mrow id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mrow id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml"><msubsup id="S3.SS1.p1.1.m1.1.1.2.1" xref="S3.SS1.p1.1.m1.1.1.2.1.cmml"><mo id="S3.SS1.p1.1.m1.1.1.2.1.2.2" xref="S3.SS1.p1.1.m1.1.1.2.1.2.2.cmml">⋃</mo><mrow id="S3.SS1.p1.1.m1.1.1.2.1.2.3" xref="S3.SS1.p1.1.m1.1.1.2.1.2.3.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2.1.2.3.2" xref="S3.SS1.p1.1.m1.1.1.2.1.2.3.2.cmml">j</mi><mo id="S3.SS1.p1.1.m1.1.1.2.1.2.3.1" xref="S3.SS1.p1.1.m1.1.1.2.1.2.3.1.cmml">=</mo><mn id="S3.SS1.p1.1.m1.1.1.2.1.2.3.3" xref="S3.SS1.p1.1.m1.1.1.2.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS1.p1.1.m1.1.1.2.1.3" xref="S3.SS1.p1.1.m1.1.1.2.1.3.cmml">J</mi></msubsup><msub id="S3.SS1.p1.1.m1.1.1.2.2" xref="S3.SS1.p1.1.m1.1.1.2.2.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2.2.2" xref="S3.SS1.p1.1.m1.1.1.2.2.2.cmml">X</mi><mi id="S3.SS1.p1.1.m1.1.1.2.2.3" xref="S3.SS1.p1.1.m1.1.1.2.2.3.cmml">j</mi></msub></mrow><mo id="S3.SS1.p1.1.m1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.cmml">=</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml">𝒳</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><eq id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1"></eq><apply id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2"><apply id="S3.SS1.p1.1.m1.1.1.2.1.cmml" xref="S3.SS1.p1.1.m1.1.1.2.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.2.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.2.1">superscript</csymbol><apply id="S3.SS1.p1.1.m1.1.1.2.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.2.1.2.1.cmml" xref="S3.SS1.p1.1.m1.1.1.2.1">subscript</csymbol><union id="S3.SS1.p1.1.m1.1.1.2.1.2.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2.1.2.2"></union><apply id="S3.SS1.p1.1.m1.1.1.2.1.2.3.cmml" xref="S3.SS1.p1.1.m1.1.1.2.1.2.3"><eq id="S3.SS1.p1.1.m1.1.1.2.1.2.3.1.cmml" xref="S3.SS1.p1.1.m1.1.1.2.1.2.3.1"></eq><ci id="S3.SS1.p1.1.m1.1.1.2.1.2.3.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2.1.2.3.2">𝑗</ci><cn id="S3.SS1.p1.1.m1.1.1.2.1.2.3.3.cmml" type="integer" xref="S3.SS1.p1.1.m1.1.1.2.1.2.3.3">1</cn></apply></apply><ci id="S3.SS1.p1.1.m1.1.1.2.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.2.1.3">𝐽</ci></apply><apply id="S3.SS1.p1.1.m1.1.1.2.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.2.2.1.cmml" xref="S3.SS1.p1.1.m1.1.1.2.2">subscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.2.2.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2.2.2">𝑋</ci><ci id="S3.SS1.p1.1.m1.1.1.2.2.3.cmml" xref="S3.SS1.p1.1.m1.1.1.2.2.3">𝑗</ci></apply></apply><ci id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3">𝒳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\bigcup_{j=1}^{J}X_{j}=\mathcal{X}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">⋃ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_J end_POSTSUPERSCRIPT italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = caligraphic_X</annotation></semantics></math> be the partitioning of the input space induced by the leaves of a binary tree whose internal nodes represent a split along one dimension into two disjoint partitions,
we take as <math alttext="\mathcal{H}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">ℋ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">ℋ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">\mathcal{H}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">caligraphic_H</annotation></semantics></math> the set of functions such as</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\delta f(\mathbf{x})=\sum_{j=1}^{J}w_{j}\mathbf{1}_{X_{j}}(\mathbf{x})\,," class="ltx_Math" display="block" id="S3.E7.m1.3"><semantics id="S3.E7.m1.3a"><mrow id="S3.E7.m1.3.3.1" xref="S3.E7.m1.3.3.1.1.cmml"><mrow id="S3.E7.m1.3.3.1.1" xref="S3.E7.m1.3.3.1.1.cmml"><mrow id="S3.E7.m1.3.3.1.1.2" xref="S3.E7.m1.3.3.1.1.2.cmml"><mi id="S3.E7.m1.3.3.1.1.2.2" xref="S3.E7.m1.3.3.1.1.2.2.cmml">δ</mi><mo id="S3.E7.m1.3.3.1.1.2.1" xref="S3.E7.m1.3.3.1.1.2.1.cmml">⁢</mo><mi id="S3.E7.m1.3.3.1.1.2.3" xref="S3.E7.m1.3.3.1.1.2.3.cmml">f</mi><mo id="S3.E7.m1.3.3.1.1.2.1a" xref="S3.E7.m1.3.3.1.1.2.1.cmml">⁢</mo><mrow id="S3.E7.m1.3.3.1.1.2.4.2" xref="S3.E7.m1.3.3.1.1.2.cmml"><mo id="S3.E7.m1.3.3.1.1.2.4.2.1" stretchy="false" xref="S3.E7.m1.3.3.1.1.2.cmml">(</mo><mi id="S3.E7.m1.1.1" xref="S3.E7.m1.1.1.cmml">𝐱</mi><mo id="S3.E7.m1.3.3.1.1.2.4.2.2" stretchy="false" xref="S3.E7.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E7.m1.3.3.1.1.1" rspace="0.111em" xref="S3.E7.m1.3.3.1.1.1.cmml">=</mo><mrow id="S3.E7.m1.3.3.1.1.3" xref="S3.E7.m1.3.3.1.1.3.cmml"><munderover id="S3.E7.m1.3.3.1.1.3.1" xref="S3.E7.m1.3.3.1.1.3.1.cmml"><mo id="S3.E7.m1.3.3.1.1.3.1.2.2" movablelimits="false" xref="S3.E7.m1.3.3.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.E7.m1.3.3.1.1.3.1.2.3" xref="S3.E7.m1.3.3.1.1.3.1.2.3.cmml"><mi id="S3.E7.m1.3.3.1.1.3.1.2.3.2" xref="S3.E7.m1.3.3.1.1.3.1.2.3.2.cmml">j</mi><mo id="S3.E7.m1.3.3.1.1.3.1.2.3.1" xref="S3.E7.m1.3.3.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.E7.m1.3.3.1.1.3.1.2.3.3" xref="S3.E7.m1.3.3.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E7.m1.3.3.1.1.3.1.3" xref="S3.E7.m1.3.3.1.1.3.1.3.cmml">J</mi></munderover><mrow id="S3.E7.m1.3.3.1.1.3.2" xref="S3.E7.m1.3.3.1.1.3.2.cmml"><msub id="S3.E7.m1.3.3.1.1.3.2.2" xref="S3.E7.m1.3.3.1.1.3.2.2.cmml"><mi id="S3.E7.m1.3.3.1.1.3.2.2.2" xref="S3.E7.m1.3.3.1.1.3.2.2.2.cmml">w</mi><mi id="S3.E7.m1.3.3.1.1.3.2.2.3" xref="S3.E7.m1.3.3.1.1.3.2.2.3.cmml">j</mi></msub><mo id="S3.E7.m1.3.3.1.1.3.2.1" xref="S3.E7.m1.3.3.1.1.3.2.1.cmml">⁢</mo><msub id="S3.E7.m1.3.3.1.1.3.2.3" xref="S3.E7.m1.3.3.1.1.3.2.3.cmml"><mn id="S3.E7.m1.3.3.1.1.3.2.3.2" xref="S3.E7.m1.3.3.1.1.3.2.3.2.cmml">𝟏</mn><msub id="S3.E7.m1.3.3.1.1.3.2.3.3" xref="S3.E7.m1.3.3.1.1.3.2.3.3.cmml"><mi id="S3.E7.m1.3.3.1.1.3.2.3.3.2" xref="S3.E7.m1.3.3.1.1.3.2.3.3.2.cmml">X</mi><mi id="S3.E7.m1.3.3.1.1.3.2.3.3.3" xref="S3.E7.m1.3.3.1.1.3.2.3.3.3.cmml">j</mi></msub></msub><mo id="S3.E7.m1.3.3.1.1.3.2.1a" xref="S3.E7.m1.3.3.1.1.3.2.1.cmml">⁢</mo><mrow id="S3.E7.m1.3.3.1.1.3.2.4.2" xref="S3.E7.m1.3.3.1.1.3.2.cmml"><mo id="S3.E7.m1.3.3.1.1.3.2.4.2.1" stretchy="false" xref="S3.E7.m1.3.3.1.1.3.2.cmml">(</mo><mi id="S3.E7.m1.2.2" xref="S3.E7.m1.2.2.cmml">𝐱</mi><mo id="S3.E7.m1.3.3.1.1.3.2.4.2.2" rspace="0.170em" stretchy="false" xref="S3.E7.m1.3.3.1.1.3.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E7.m1.3.3.1.2" xref="S3.E7.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.3b"><apply id="S3.E7.m1.3.3.1.1.cmml" xref="S3.E7.m1.3.3.1"><eq id="S3.E7.m1.3.3.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.1"></eq><apply id="S3.E7.m1.3.3.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.2"><times id="S3.E7.m1.3.3.1.1.2.1.cmml" xref="S3.E7.m1.3.3.1.1.2.1"></times><ci id="S3.E7.m1.3.3.1.1.2.2.cmml" xref="S3.E7.m1.3.3.1.1.2.2">𝛿</ci><ci id="S3.E7.m1.3.3.1.1.2.3.cmml" xref="S3.E7.m1.3.3.1.1.2.3">𝑓</ci><ci id="S3.E7.m1.1.1.cmml" xref="S3.E7.m1.1.1">𝐱</ci></apply><apply id="S3.E7.m1.3.3.1.1.3.cmml" xref="S3.E7.m1.3.3.1.1.3"><apply id="S3.E7.m1.3.3.1.1.3.1.cmml" xref="S3.E7.m1.3.3.1.1.3.1"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.3.1.1.cmml" xref="S3.E7.m1.3.3.1.1.3.1">superscript</csymbol><apply id="S3.E7.m1.3.3.1.1.3.1.2.cmml" xref="S3.E7.m1.3.3.1.1.3.1"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.3.1.2.1.cmml" xref="S3.E7.m1.3.3.1.1.3.1">subscript</csymbol><sum id="S3.E7.m1.3.3.1.1.3.1.2.2.cmml" xref="S3.E7.m1.3.3.1.1.3.1.2.2"></sum><apply id="S3.E7.m1.3.3.1.1.3.1.2.3.cmml" xref="S3.E7.m1.3.3.1.1.3.1.2.3"><eq id="S3.E7.m1.3.3.1.1.3.1.2.3.1.cmml" xref="S3.E7.m1.3.3.1.1.3.1.2.3.1"></eq><ci id="S3.E7.m1.3.3.1.1.3.1.2.3.2.cmml" xref="S3.E7.m1.3.3.1.1.3.1.2.3.2">𝑗</ci><cn id="S3.E7.m1.3.3.1.1.3.1.2.3.3.cmml" type="integer" xref="S3.E7.m1.3.3.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E7.m1.3.3.1.1.3.1.3.cmml" xref="S3.E7.m1.3.3.1.1.3.1.3">𝐽</ci></apply><apply id="S3.E7.m1.3.3.1.1.3.2.cmml" xref="S3.E7.m1.3.3.1.1.3.2"><times id="S3.E7.m1.3.3.1.1.3.2.1.cmml" xref="S3.E7.m1.3.3.1.1.3.2.1"></times><apply id="S3.E7.m1.3.3.1.1.3.2.2.cmml" xref="S3.E7.m1.3.3.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.3.2.2.1.cmml" xref="S3.E7.m1.3.3.1.1.3.2.2">subscript</csymbol><ci id="S3.E7.m1.3.3.1.1.3.2.2.2.cmml" xref="S3.E7.m1.3.3.1.1.3.2.2.2">𝑤</ci><ci id="S3.E7.m1.3.3.1.1.3.2.2.3.cmml" xref="S3.E7.m1.3.3.1.1.3.2.2.3">𝑗</ci></apply><apply id="S3.E7.m1.3.3.1.1.3.2.3.cmml" xref="S3.E7.m1.3.3.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.3.2.3.1.cmml" xref="S3.E7.m1.3.3.1.1.3.2.3">subscript</csymbol><cn id="S3.E7.m1.3.3.1.1.3.2.3.2.cmml" type="integer" xref="S3.E7.m1.3.3.1.1.3.2.3.2">1</cn><apply id="S3.E7.m1.3.3.1.1.3.2.3.3.cmml" xref="S3.E7.m1.3.3.1.1.3.2.3.3"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.3.2.3.3.1.cmml" xref="S3.E7.m1.3.3.1.1.3.2.3.3">subscript</csymbol><ci id="S3.E7.m1.3.3.1.1.3.2.3.3.2.cmml" xref="S3.E7.m1.3.3.1.1.3.2.3.3.2">𝑋</ci><ci id="S3.E7.m1.3.3.1.1.3.2.3.3.3.cmml" xref="S3.E7.m1.3.3.1.1.3.2.3.3.3">𝑗</ci></apply></apply><ci id="S3.E7.m1.2.2.cmml" xref="S3.E7.m1.2.2">𝐱</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.3c">\delta f(\mathbf{x})=\sum_{j=1}^{J}w_{j}\mathbf{1}_{X_{j}}(\mathbf{x})\,,</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.3d">italic_δ italic_f ( bold_x ) = ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_J end_POSTSUPERSCRIPT italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT bold_1 start_POSTSUBSCRIPT italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_x ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p1.11">where <math alttext="\mathbf{1}_{X}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m1.1"><semantics id="S3.SS1.p1.3.m1.1a"><msub id="S3.SS1.p1.3.m1.1.1" xref="S3.SS1.p1.3.m1.1.1.cmml"><mn id="S3.SS1.p1.3.m1.1.1.2" xref="S3.SS1.p1.3.m1.1.1.2.cmml">𝟏</mn><mi id="S3.SS1.p1.3.m1.1.1.3" xref="S3.SS1.p1.3.m1.1.1.3.cmml">X</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m1.1b"><apply id="S3.SS1.p1.3.m1.1.1.cmml" xref="S3.SS1.p1.3.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m1.1.1.1.cmml" xref="S3.SS1.p1.3.m1.1.1">subscript</csymbol><cn id="S3.SS1.p1.3.m1.1.1.2.cmml" type="integer" xref="S3.SS1.p1.3.m1.1.1.2">1</cn><ci id="S3.SS1.p1.3.m1.1.1.3.cmml" xref="S3.SS1.p1.3.m1.1.1.3">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m1.1c">\mathbf{1}_{X}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m1.1d">bold_1 start_POSTSUBSCRIPT italic_X end_POSTSUBSCRIPT</annotation></semantics></math> denotes the indicator function of a subset <math alttext="X" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m2.1"><semantics id="S3.SS1.p1.4.m2.1a"><mi id="S3.SS1.p1.4.m2.1.1" xref="S3.SS1.p1.4.m2.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m2.1b"><ci id="S3.SS1.p1.4.m2.1.1.cmml" xref="S3.SS1.p1.4.m2.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m2.1c">X</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m2.1d">italic_X</annotation></semantics></math> and <math alttext="w_{j}" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m3.1"><semantics id="S3.SS1.p1.5.m3.1a"><msub id="S3.SS1.p1.5.m3.1.1" xref="S3.SS1.p1.5.m3.1.1.cmml"><mi id="S3.SS1.p1.5.m3.1.1.2" xref="S3.SS1.p1.5.m3.1.1.2.cmml">w</mi><mi id="S3.SS1.p1.5.m3.1.1.3" xref="S3.SS1.p1.5.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m3.1b"><apply id="S3.SS1.p1.5.m3.1.1.cmml" xref="S3.SS1.p1.5.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m3.1.1.1.cmml" xref="S3.SS1.p1.5.m3.1.1">subscript</csymbol><ci id="S3.SS1.p1.5.m3.1.1.2.cmml" xref="S3.SS1.p1.5.m3.1.1.2">𝑤</ci><ci id="S3.SS1.p1.5.m3.1.1.3.cmml" xref="S3.SS1.p1.5.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m3.1c">w_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m3.1d">italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> are values associated with each leaf <math alttext="j\in[1..J]" class="ltx_math_unparsed" display="inline" id="S3.SS1.p1.6.m4.1"><semantics id="S3.SS1.p1.6.m4.1a"><mrow id="S3.SS1.p1.6.m4.1b"><mi id="S3.SS1.p1.6.m4.1.1">j</mi><mo id="S3.SS1.p1.6.m4.1.2">∈</mo><mrow id="S3.SS1.p1.6.m4.1.3"><mo id="S3.SS1.p1.6.m4.1.3.1" stretchy="false">[</mo><mn id="S3.SS1.p1.6.m4.1.3.2">1</mn><mo id="S3.SS1.p1.6.m4.1.3.3" lspace="0em" rspace="0.0835em">.</mo><mo id="S3.SS1.p1.6.m4.1.3.4" lspace="0.0835em" rspace="0.167em">.</mo><mi id="S3.SS1.p1.6.m4.1.3.5">J</mi><mo id="S3.SS1.p1.6.m4.1.3.6" stretchy="false">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m4.1c">j\in[1..J]</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m4.1d">italic_j ∈ [ 1 . . italic_J ]</annotation></semantics></math>.
In a standard decision tree these values would typically encode an estimate of <math alttext="p(y|\mathbf{x}\in X_{j})" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m5.1"><semantics id="S3.SS1.p1.7.m5.1a"><mrow id="S3.SS1.p1.7.m5.1.1" xref="S3.SS1.p1.7.m5.1.1.cmml"><mi id="S3.SS1.p1.7.m5.1.1.3" xref="S3.SS1.p1.7.m5.1.1.3.cmml">p</mi><mo id="S3.SS1.p1.7.m5.1.1.2" xref="S3.SS1.p1.7.m5.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p1.7.m5.1.1.1.1" xref="S3.SS1.p1.7.m5.1.1.1.1.1.cmml"><mo id="S3.SS1.p1.7.m5.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.7.m5.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p1.7.m5.1.1.1.1.1" xref="S3.SS1.p1.7.m5.1.1.1.1.1.cmml"><mrow id="S3.SS1.p1.7.m5.1.1.1.1.1.2" xref="S3.SS1.p1.7.m5.1.1.1.1.1.2.cmml"><mi id="S3.SS1.p1.7.m5.1.1.1.1.1.2.2" xref="S3.SS1.p1.7.m5.1.1.1.1.1.2.2.cmml">y</mi><mo fence="false" id="S3.SS1.p1.7.m5.1.1.1.1.1.2.1" xref="S3.SS1.p1.7.m5.1.1.1.1.1.2.1.cmml">|</mo><mi id="S3.SS1.p1.7.m5.1.1.1.1.1.2.3" xref="S3.SS1.p1.7.m5.1.1.1.1.1.2.3.cmml">𝐱</mi></mrow><mo id="S3.SS1.p1.7.m5.1.1.1.1.1.1" xref="S3.SS1.p1.7.m5.1.1.1.1.1.1.cmml">∈</mo><msub id="S3.SS1.p1.7.m5.1.1.1.1.1.3" xref="S3.SS1.p1.7.m5.1.1.1.1.1.3.cmml"><mi id="S3.SS1.p1.7.m5.1.1.1.1.1.3.2" xref="S3.SS1.p1.7.m5.1.1.1.1.1.3.2.cmml">X</mi><mi id="S3.SS1.p1.7.m5.1.1.1.1.1.3.3" xref="S3.SS1.p1.7.m5.1.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo id="S3.SS1.p1.7.m5.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.7.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m5.1b"><apply id="S3.SS1.p1.7.m5.1.1.cmml" xref="S3.SS1.p1.7.m5.1.1"><times id="S3.SS1.p1.7.m5.1.1.2.cmml" xref="S3.SS1.p1.7.m5.1.1.2"></times><ci id="S3.SS1.p1.7.m5.1.1.3.cmml" xref="S3.SS1.p1.7.m5.1.1.3">𝑝</ci><apply id="S3.SS1.p1.7.m5.1.1.1.1.1.cmml" xref="S3.SS1.p1.7.m5.1.1.1.1"><in id="S3.SS1.p1.7.m5.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.7.m5.1.1.1.1.1.1"></in><apply id="S3.SS1.p1.7.m5.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.7.m5.1.1.1.1.1.2"><csymbol cd="latexml" id="S3.SS1.p1.7.m5.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p1.7.m5.1.1.1.1.1.2.1">conditional</csymbol><ci id="S3.SS1.p1.7.m5.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p1.7.m5.1.1.1.1.1.2.2">𝑦</ci><ci id="S3.SS1.p1.7.m5.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p1.7.m5.1.1.1.1.1.2.3">𝐱</ci></apply><apply id="S3.SS1.p1.7.m5.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.7.m5.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m5.1.1.1.1.1.3.1.cmml" xref="S3.SS1.p1.7.m5.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.7.m5.1.1.1.1.1.3.2.cmml" xref="S3.SS1.p1.7.m5.1.1.1.1.1.3.2">𝑋</ci><ci id="S3.SS1.p1.7.m5.1.1.1.1.1.3.3.cmml" xref="S3.SS1.p1.7.m5.1.1.1.1.1.3.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m5.1c">p(y|\mathbf{x}\in X_{j})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m5.1d">italic_p ( italic_y | bold_x ∈ italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT )</annotation></semantics></math>, with <math alttext="y" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m6.1"><semantics id="S3.SS1.p1.8.m6.1a"><mi id="S3.SS1.p1.8.m6.1.1" xref="S3.SS1.p1.8.m6.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m6.1b"><ci id="S3.SS1.p1.8.m6.1.1.cmml" xref="S3.SS1.p1.8.m6.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m6.1c">y</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.8.m6.1d">italic_y</annotation></semantics></math> being a special <em class="ltx_emph ltx_font_italic" id="S3.SS1.p1.11.1">target</em> variable that is never considered for splitting.
In our generative approach they encode unconditional densities (or more precisely energies) over each leaf’s support and every variable can be used for splitting.
Note that our functions <math alttext="\delta f" class="ltx_Math" display="inline" id="S3.SS1.p1.9.m7.1"><semantics id="S3.SS1.p1.9.m7.1a"><mrow id="S3.SS1.p1.9.m7.1.1" xref="S3.SS1.p1.9.m7.1.1.cmml"><mi id="S3.SS1.p1.9.m7.1.1.2" xref="S3.SS1.p1.9.m7.1.1.2.cmml">δ</mi><mo id="S3.SS1.p1.9.m7.1.1.1" xref="S3.SS1.p1.9.m7.1.1.1.cmml">⁢</mo><mi id="S3.SS1.p1.9.m7.1.1.3" xref="S3.SS1.p1.9.m7.1.1.3.cmml">f</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m7.1b"><apply id="S3.SS1.p1.9.m7.1.1.cmml" xref="S3.SS1.p1.9.m7.1.1"><times id="S3.SS1.p1.9.m7.1.1.1.cmml" xref="S3.SS1.p1.9.m7.1.1.1"></times><ci id="S3.SS1.p1.9.m7.1.1.2.cmml" xref="S3.SS1.p1.9.m7.1.1.2">𝛿</ci><ci id="S3.SS1.p1.9.m7.1.1.3.cmml" xref="S3.SS1.p1.9.m7.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m7.1c">\delta f</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.9.m7.1d">italic_δ italic_f</annotation></semantics></math> are thus parametrized by the values <math alttext="w_{j}" class="ltx_Math" display="inline" id="S3.SS1.p1.10.m8.1"><semantics id="S3.SS1.p1.10.m8.1a"><msub id="S3.SS1.p1.10.m8.1.1" xref="S3.SS1.p1.10.m8.1.1.cmml"><mi id="S3.SS1.p1.10.m8.1.1.2" xref="S3.SS1.p1.10.m8.1.1.2.cmml">w</mi><mi id="S3.SS1.p1.10.m8.1.1.3" xref="S3.SS1.p1.10.m8.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m8.1b"><apply id="S3.SS1.p1.10.m8.1.1.cmml" xref="S3.SS1.p1.10.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m8.1.1.1.cmml" xref="S3.SS1.p1.10.m8.1.1">subscript</csymbol><ci id="S3.SS1.p1.10.m8.1.1.2.cmml" xref="S3.SS1.p1.10.m8.1.1.2">𝑤</ci><ci id="S3.SS1.p1.10.m8.1.1.3.cmml" xref="S3.SS1.p1.10.m8.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m8.1c">w_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.10.m8.1d">italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> as well the structure of the tree and the variables and values for the split at each node which ultimately determine the <math alttext="X_{j}" class="ltx_Math" display="inline" id="S3.SS1.p1.11.m9.1"><semantics id="S3.SS1.p1.11.m9.1a"><msub id="S3.SS1.p1.11.m9.1.1" xref="S3.SS1.p1.11.m9.1.1.cmml"><mi id="S3.SS1.p1.11.m9.1.1.2" xref="S3.SS1.p1.11.m9.1.1.2.cmml">X</mi><mi id="S3.SS1.p1.11.m9.1.1.3" xref="S3.SS1.p1.11.m9.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m9.1b"><apply id="S3.SS1.p1.11.m9.1.1.cmml" xref="S3.SS1.p1.11.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m9.1.1.1.cmml" xref="S3.SS1.p1.11.m9.1.1">subscript</csymbol><ci id="S3.SS1.p1.11.m9.1.1.2.cmml" xref="S3.SS1.p1.11.m9.1.1.2">𝑋</ci><ci id="S3.SS1.p1.11.m9.1.1.3.cmml" xref="S3.SS1.p1.11.m9.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m9.1c">X_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.11.m9.1d">italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>.
We omit these dependencies for brevity.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.10">Replacing the definition in equation <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S3.E7" title="In 3.1 Weak Learners ‣ 3 NRGBoost ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">7</span></a> in our objective (equation <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S3.E5" title="In 3 NRGBoost ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">5</span></a>) we get the following
optimization problem to find the optimal decision tree:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E8">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E8X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\max_{w_{1},\ldots,w_{J},X_{1},\ldots,X_{J}}" class="ltx_Math" display="inline" id="S3.E8X.2.1.1.m1.6"><semantics id="S3.E8X.2.1.1.m1.6a"><munder id="S3.E8X.2.1.1.m1.6.7" xref="S3.E8X.2.1.1.m1.6.7.cmml"><mi id="S3.E8X.2.1.1.m1.6.7.2" xref="S3.E8X.2.1.1.m1.6.7.2.cmml">max</mi><mrow id="S3.E8X.2.1.1.m1.6.6.6.6" xref="S3.E8X.2.1.1.m1.6.6.6.7.cmml"><msub id="S3.E8X.2.1.1.m1.3.3.3.3.1" xref="S3.E8X.2.1.1.m1.3.3.3.3.1.cmml"><mi id="S3.E8X.2.1.1.m1.3.3.3.3.1.2" xref="S3.E8X.2.1.1.m1.3.3.3.3.1.2.cmml">w</mi><mn id="S3.E8X.2.1.1.m1.3.3.3.3.1.3" xref="S3.E8X.2.1.1.m1.3.3.3.3.1.3.cmml">1</mn></msub><mo id="S3.E8X.2.1.1.m1.6.6.6.6.5" xref="S3.E8X.2.1.1.m1.6.6.6.7.cmml">,</mo><mi id="S3.E8X.2.1.1.m1.1.1.1.1" mathvariant="normal" xref="S3.E8X.2.1.1.m1.1.1.1.1.cmml">…</mi><mo id="S3.E8X.2.1.1.m1.6.6.6.6.6" xref="S3.E8X.2.1.1.m1.6.6.6.7.cmml">,</mo><msub id="S3.E8X.2.1.1.m1.4.4.4.4.2" xref="S3.E8X.2.1.1.m1.4.4.4.4.2.cmml"><mi id="S3.E8X.2.1.1.m1.4.4.4.4.2.2" xref="S3.E8X.2.1.1.m1.4.4.4.4.2.2.cmml">w</mi><mi id="S3.E8X.2.1.1.m1.4.4.4.4.2.3" xref="S3.E8X.2.1.1.m1.4.4.4.4.2.3.cmml">J</mi></msub><mo id="S3.E8X.2.1.1.m1.6.6.6.6.7" xref="S3.E8X.2.1.1.m1.6.6.6.7.cmml">,</mo><msub id="S3.E8X.2.1.1.m1.5.5.5.5.3" xref="S3.E8X.2.1.1.m1.5.5.5.5.3.cmml"><mi id="S3.E8X.2.1.1.m1.5.5.5.5.3.2" xref="S3.E8X.2.1.1.m1.5.5.5.5.3.2.cmml">X</mi><mn id="S3.E8X.2.1.1.m1.5.5.5.5.3.3" xref="S3.E8X.2.1.1.m1.5.5.5.5.3.3.cmml">1</mn></msub><mo id="S3.E8X.2.1.1.m1.6.6.6.6.8" xref="S3.E8X.2.1.1.m1.6.6.6.7.cmml">,</mo><mi id="S3.E8X.2.1.1.m1.2.2.2.2" mathvariant="normal" xref="S3.E8X.2.1.1.m1.2.2.2.2.cmml">…</mi><mo id="S3.E8X.2.1.1.m1.6.6.6.6.9" xref="S3.E8X.2.1.1.m1.6.6.6.7.cmml">,</mo><msub id="S3.E8X.2.1.1.m1.6.6.6.6.4" xref="S3.E8X.2.1.1.m1.6.6.6.6.4.cmml"><mi id="S3.E8X.2.1.1.m1.6.6.6.6.4.2" xref="S3.E8X.2.1.1.m1.6.6.6.6.4.2.cmml">X</mi><mi id="S3.E8X.2.1.1.m1.6.6.6.6.4.3" xref="S3.E8X.2.1.1.m1.6.6.6.6.4.3.cmml">J</mi></msub></mrow></munder><annotation-xml encoding="MathML-Content" id="S3.E8X.2.1.1.m1.6b"><apply id="S3.E8X.2.1.1.m1.6.7.cmml" xref="S3.E8X.2.1.1.m1.6.7"><csymbol cd="ambiguous" id="S3.E8X.2.1.1.m1.6.7.1.cmml" xref="S3.E8X.2.1.1.m1.6.7">subscript</csymbol><max id="S3.E8X.2.1.1.m1.6.7.2.cmml" xref="S3.E8X.2.1.1.m1.6.7.2"></max><list id="S3.E8X.2.1.1.m1.6.6.6.7.cmml" xref="S3.E8X.2.1.1.m1.6.6.6.6"><apply id="S3.E8X.2.1.1.m1.3.3.3.3.1.cmml" xref="S3.E8X.2.1.1.m1.3.3.3.3.1"><csymbol cd="ambiguous" id="S3.E8X.2.1.1.m1.3.3.3.3.1.1.cmml" xref="S3.E8X.2.1.1.m1.3.3.3.3.1">subscript</csymbol><ci id="S3.E8X.2.1.1.m1.3.3.3.3.1.2.cmml" xref="S3.E8X.2.1.1.m1.3.3.3.3.1.2">𝑤</ci><cn id="S3.E8X.2.1.1.m1.3.3.3.3.1.3.cmml" type="integer" xref="S3.E8X.2.1.1.m1.3.3.3.3.1.3">1</cn></apply><ci id="S3.E8X.2.1.1.m1.1.1.1.1.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1">…</ci><apply id="S3.E8X.2.1.1.m1.4.4.4.4.2.cmml" xref="S3.E8X.2.1.1.m1.4.4.4.4.2"><csymbol cd="ambiguous" id="S3.E8X.2.1.1.m1.4.4.4.4.2.1.cmml" xref="S3.E8X.2.1.1.m1.4.4.4.4.2">subscript</csymbol><ci id="S3.E8X.2.1.1.m1.4.4.4.4.2.2.cmml" xref="S3.E8X.2.1.1.m1.4.4.4.4.2.2">𝑤</ci><ci id="S3.E8X.2.1.1.m1.4.4.4.4.2.3.cmml" xref="S3.E8X.2.1.1.m1.4.4.4.4.2.3">𝐽</ci></apply><apply id="S3.E8X.2.1.1.m1.5.5.5.5.3.cmml" xref="S3.E8X.2.1.1.m1.5.5.5.5.3"><csymbol cd="ambiguous" id="S3.E8X.2.1.1.m1.5.5.5.5.3.1.cmml" xref="S3.E8X.2.1.1.m1.5.5.5.5.3">subscript</csymbol><ci id="S3.E8X.2.1.1.m1.5.5.5.5.3.2.cmml" xref="S3.E8X.2.1.1.m1.5.5.5.5.3.2">𝑋</ci><cn id="S3.E8X.2.1.1.m1.5.5.5.5.3.3.cmml" type="integer" xref="S3.E8X.2.1.1.m1.5.5.5.5.3.3">1</cn></apply><ci id="S3.E8X.2.1.1.m1.2.2.2.2.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.2">…</ci><apply id="S3.E8X.2.1.1.m1.6.6.6.6.4.cmml" xref="S3.E8X.2.1.1.m1.6.6.6.6.4"><csymbol cd="ambiguous" id="S3.E8X.2.1.1.m1.6.6.6.6.4.1.cmml" xref="S3.E8X.2.1.1.m1.6.6.6.6.4">subscript</csymbol><ci id="S3.E8X.2.1.1.m1.6.6.6.6.4.2.cmml" xref="S3.E8X.2.1.1.m1.6.6.6.6.4.2">𝑋</ci><ci id="S3.E8X.2.1.1.m1.6.6.6.6.4.3.cmml" xref="S3.E8X.2.1.1.m1.6.6.6.6.4.3">𝐽</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8X.2.1.1.m1.6c">\displaystyle\max_{w_{1},\ldots,w_{J},X_{1},\ldots,X_{J}}</annotation><annotation encoding="application/x-llamapun" id="S3.E8X.2.1.1.m1.6d">roman_max start_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_w start_POSTSUBSCRIPT italic_J end_POSTSUBSCRIPT , italic_X start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_X start_POSTSUBSCRIPT italic_J end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\sum_{j=1}^{J}\left(w_{j}P(X_{j})-\frac{1}{2}w_{j}^{2}Q_{f}(X_{j}%
)\right)" class="ltx_Math" display="inline" id="S3.E8X.3.2.2.m1.1"><semantics id="S3.E8X.3.2.2.m1.1a"><mrow id="S3.E8X.3.2.2.m1.1.1" xref="S3.E8X.3.2.2.m1.1.1.cmml"><mstyle displaystyle="true" id="S3.E8X.3.2.2.m1.1.1.2" xref="S3.E8X.3.2.2.m1.1.1.2.cmml"><munderover id="S3.E8X.3.2.2.m1.1.1.2a" xref="S3.E8X.3.2.2.m1.1.1.2.cmml"><mo id="S3.E8X.3.2.2.m1.1.1.2.2.2" movablelimits="false" xref="S3.E8X.3.2.2.m1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E8X.3.2.2.m1.1.1.2.2.3" xref="S3.E8X.3.2.2.m1.1.1.2.2.3.cmml"><mi id="S3.E8X.3.2.2.m1.1.1.2.2.3.2" xref="S3.E8X.3.2.2.m1.1.1.2.2.3.2.cmml">j</mi><mo id="S3.E8X.3.2.2.m1.1.1.2.2.3.1" xref="S3.E8X.3.2.2.m1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E8X.3.2.2.m1.1.1.2.2.3.3" xref="S3.E8X.3.2.2.m1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E8X.3.2.2.m1.1.1.2.3" xref="S3.E8X.3.2.2.m1.1.1.2.3.cmml">J</mi></munderover></mstyle><mrow id="S3.E8X.3.2.2.m1.1.1.1.1" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.cmml"><mo id="S3.E8X.3.2.2.m1.1.1.1.1.2" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E8X.3.2.2.m1.1.1.1.1.1" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.cmml"><mrow id="S3.E8X.3.2.2.m1.1.1.1.1.1.1" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.1.cmml"><msub id="S3.E8X.3.2.2.m1.1.1.1.1.1.1.3" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E8X.3.2.2.m1.1.1.1.1.1.1.3.2" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.1.3.2.cmml">w</mi><mi id="S3.E8X.3.2.2.m1.1.1.1.1.1.1.3.3" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.1.3.3.cmml">j</mi></msub><mo id="S3.E8X.3.2.2.m1.1.1.1.1.1.1.2" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E8X.3.2.2.m1.1.1.1.1.1.1.4" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.1.4.cmml">P</mi><mo id="S3.E8X.3.2.2.m1.1.1.1.1.1.1.2a" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E8X.3.2.2.m1.1.1.1.1.1.1.1.1" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E8X.3.2.2.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E8X.3.2.2.m1.1.1.1.1.1.1.1.1.1" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E8X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.cmml">X</mi><mi id="S3.E8X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.E8X.3.2.2.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E8X.3.2.2.m1.1.1.1.1.1.3" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.3.cmml">−</mo><mrow id="S3.E8X.3.2.2.m1.1.1.1.1.1.2" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.2.cmml"><mstyle displaystyle="true" id="S3.E8X.3.2.2.m1.1.1.1.1.1.2.3" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.2.3.cmml"><mfrac id="S3.E8X.3.2.2.m1.1.1.1.1.1.2.3a" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.2.3.cmml"><mn id="S3.E8X.3.2.2.m1.1.1.1.1.1.2.3.2" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.2.3.2.cmml">1</mn><mn id="S3.E8X.3.2.2.m1.1.1.1.1.1.2.3.3" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.2.3.3.cmml">2</mn></mfrac></mstyle><mo id="S3.E8X.3.2.2.m1.1.1.1.1.1.2.2" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.2.2.cmml">⁢</mo><msubsup id="S3.E8X.3.2.2.m1.1.1.1.1.1.2.4" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.2.4.cmml"><mi id="S3.E8X.3.2.2.m1.1.1.1.1.1.2.4.2.2" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.2.4.2.2.cmml">w</mi><mi id="S3.E8X.3.2.2.m1.1.1.1.1.1.2.4.2.3" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.2.4.2.3.cmml">j</mi><mn id="S3.E8X.3.2.2.m1.1.1.1.1.1.2.4.3" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.2.4.3.cmml">2</mn></msubsup><mo id="S3.E8X.3.2.2.m1.1.1.1.1.1.2.2a" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.2.2.cmml">⁢</mo><msub id="S3.E8X.3.2.2.m1.1.1.1.1.1.2.5" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.2.5.cmml"><mi id="S3.E8X.3.2.2.m1.1.1.1.1.1.2.5.2" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.2.5.2.cmml">Q</mi><mi id="S3.E8X.3.2.2.m1.1.1.1.1.1.2.5.3" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.2.5.3.cmml">f</mi></msub><mo id="S3.E8X.3.2.2.m1.1.1.1.1.1.2.2b" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.2.2.cmml">⁢</mo><mrow id="S3.E8X.3.2.2.m1.1.1.1.1.1.2.1.1" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.2.1.1.1.cmml"><mo id="S3.E8X.3.2.2.m1.1.1.1.1.1.2.1.1.2" stretchy="false" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.2.1.1.1.cmml">(</mo><msub id="S3.E8X.3.2.2.m1.1.1.1.1.1.2.1.1.1" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.2.1.1.1.cmml"><mi id="S3.E8X.3.2.2.m1.1.1.1.1.1.2.1.1.1.2" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.2.1.1.1.2.cmml">X</mi><mi id="S3.E8X.3.2.2.m1.1.1.1.1.1.2.1.1.1.3" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.2.1.1.1.3.cmml">j</mi></msub><mo id="S3.E8X.3.2.2.m1.1.1.1.1.1.2.1.1.3" stretchy="false" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E8X.3.2.2.m1.1.1.1.1.3" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E8X.3.2.2.m1.1b"><apply id="S3.E8X.3.2.2.m1.1.1.cmml" xref="S3.E8X.3.2.2.m1.1.1"><apply id="S3.E8X.3.2.2.m1.1.1.2.cmml" xref="S3.E8X.3.2.2.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E8X.3.2.2.m1.1.1.2.1.cmml" xref="S3.E8X.3.2.2.m1.1.1.2">superscript</csymbol><apply id="S3.E8X.3.2.2.m1.1.1.2.2.cmml" xref="S3.E8X.3.2.2.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E8X.3.2.2.m1.1.1.2.2.1.cmml" xref="S3.E8X.3.2.2.m1.1.1.2">subscript</csymbol><sum id="S3.E8X.3.2.2.m1.1.1.2.2.2.cmml" xref="S3.E8X.3.2.2.m1.1.1.2.2.2"></sum><apply id="S3.E8X.3.2.2.m1.1.1.2.2.3.cmml" xref="S3.E8X.3.2.2.m1.1.1.2.2.3"><eq id="S3.E8X.3.2.2.m1.1.1.2.2.3.1.cmml" xref="S3.E8X.3.2.2.m1.1.1.2.2.3.1"></eq><ci id="S3.E8X.3.2.2.m1.1.1.2.2.3.2.cmml" xref="S3.E8X.3.2.2.m1.1.1.2.2.3.2">𝑗</ci><cn id="S3.E8X.3.2.2.m1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E8X.3.2.2.m1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E8X.3.2.2.m1.1.1.2.3.cmml" xref="S3.E8X.3.2.2.m1.1.1.2.3">𝐽</ci></apply><apply id="S3.E8X.3.2.2.m1.1.1.1.1.1.cmml" xref="S3.E8X.3.2.2.m1.1.1.1.1"><minus id="S3.E8X.3.2.2.m1.1.1.1.1.1.3.cmml" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.3"></minus><apply id="S3.E8X.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.1"><times id="S3.E8X.3.2.2.m1.1.1.1.1.1.1.2.cmml" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.1.2"></times><apply id="S3.E8X.3.2.2.m1.1.1.1.1.1.1.3.cmml" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8X.3.2.2.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E8X.3.2.2.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.1.3.2">𝑤</ci><ci id="S3.E8X.3.2.2.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.1.3.3">𝑗</ci></apply><ci id="S3.E8X.3.2.2.m1.1.1.1.1.1.1.4.cmml" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.1.4">𝑃</ci><apply id="S3.E8X.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E8X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2">𝑋</ci><ci id="S3.E8X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3">𝑗</ci></apply></apply><apply id="S3.E8X.3.2.2.m1.1.1.1.1.1.2.cmml" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.2"><times id="S3.E8X.3.2.2.m1.1.1.1.1.1.2.2.cmml" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.2.2"></times><apply id="S3.E8X.3.2.2.m1.1.1.1.1.1.2.3.cmml" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.2.3"><divide id="S3.E8X.3.2.2.m1.1.1.1.1.1.2.3.1.cmml" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.2.3"></divide><cn id="S3.E8X.3.2.2.m1.1.1.1.1.1.2.3.2.cmml" type="integer" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.2.3.2">1</cn><cn id="S3.E8X.3.2.2.m1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.2.3.3">2</cn></apply><apply id="S3.E8X.3.2.2.m1.1.1.1.1.1.2.4.cmml" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S3.E8X.3.2.2.m1.1.1.1.1.1.2.4.1.cmml" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.2.4">superscript</csymbol><apply id="S3.E8X.3.2.2.m1.1.1.1.1.1.2.4.2.cmml" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S3.E8X.3.2.2.m1.1.1.1.1.1.2.4.2.1.cmml" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.2.4">subscript</csymbol><ci id="S3.E8X.3.2.2.m1.1.1.1.1.1.2.4.2.2.cmml" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.2.4.2.2">𝑤</ci><ci id="S3.E8X.3.2.2.m1.1.1.1.1.1.2.4.2.3.cmml" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.2.4.2.3">𝑗</ci></apply><cn id="S3.E8X.3.2.2.m1.1.1.1.1.1.2.4.3.cmml" type="integer" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.2.4.3">2</cn></apply><apply id="S3.E8X.3.2.2.m1.1.1.1.1.1.2.5.cmml" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.2.5"><csymbol cd="ambiguous" id="S3.E8X.3.2.2.m1.1.1.1.1.1.2.5.1.cmml" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.2.5">subscript</csymbol><ci id="S3.E8X.3.2.2.m1.1.1.1.1.1.2.5.2.cmml" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.2.5.2">𝑄</ci><ci id="S3.E8X.3.2.2.m1.1.1.1.1.1.2.5.3.cmml" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.2.5.3">𝑓</ci></apply><apply id="S3.E8X.3.2.2.m1.1.1.1.1.1.2.1.1.1.cmml" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.2.1.1"><csymbol cd="ambiguous" id="S3.E8X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.2.1.1">subscript</csymbol><ci id="S3.E8X.3.2.2.m1.1.1.1.1.1.2.1.1.1.2.cmml" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.2.1.1.1.2">𝑋</ci><ci id="S3.E8X.3.2.2.m1.1.1.1.1.1.2.1.1.1.3.cmml" xref="S3.E8X.3.2.2.m1.1.1.1.1.1.2.1.1.1.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8X.3.2.2.m1.1c">\displaystyle\sum_{j=1}^{J}\left(w_{j}P(X_{j})-\frac{1}{2}w_{j}^{2}Q_{f}(X_{j}%
)\right)</annotation><annotation encoding="application/x-llamapun" id="S3.E8X.3.2.2.m1.1d">∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_J end_POSTSUPERSCRIPT ( italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_P ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) - divide start_ARG 1 end_ARG start_ARG 2 end_ARG italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_Q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(8)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E8Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span class="ltx_text ltx_markedasmath ltx_font_italic" id="S3.E8Xa.2.1.1.1">s.t.</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\sum_{j=1}^{J}w_{j}Q_{f}(X_{j})=0\,," class="ltx_Math" display="inline" id="S3.E8Xa.3.2.2.m1.1"><semantics id="S3.E8Xa.3.2.2.m1.1a"><mrow id="S3.E8Xa.3.2.2.m1.1.1.1" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.cmml"><mrow id="S3.E8Xa.3.2.2.m1.1.1.1.1" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.cmml"><mrow id="S3.E8Xa.3.2.2.m1.1.1.1.1.1" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.2" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.2.cmml"><munderover id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.2a" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.2.cmml"><mo id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.2.2.2" movablelimits="false" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.2.2.3" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.2.2.3.2" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.2.2.3.2.cmml">j</mi><mo id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.2.2.3.1" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.2.2.3.3" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.2.3" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.2.3.cmml">J</mi></munderover></mstyle><mrow id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.cmml"><msub id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.3" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.3.2" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.3.2.cmml">w</mi><mi id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.3.3" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.3.3.cmml">j</mi></msub><mo id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.2" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.2.cmml">⁢</mo><msub id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.4" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.4.cmml"><mi id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.4.2" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.4.2.cmml">Q</mi><mi id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.4.3" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.4.3.cmml">f</mi></msub><mo id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.2a" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.1.1" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.cmml">X</mi><mi id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E8Xa.3.2.2.m1.1.1.1.1.2" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.2.cmml">=</mo><mn id="S3.E8Xa.3.2.2.m1.1.1.1.1.3" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.3.cmml">0</mn></mrow><mo id="S3.E8Xa.3.2.2.m1.1.1.1.2" lspace="0.170em" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8Xa.3.2.2.m1.1b"><apply id="S3.E8Xa.3.2.2.m1.1.1.1.1.cmml" xref="S3.E8Xa.3.2.2.m1.1.1.1"><eq id="S3.E8Xa.3.2.2.m1.1.1.1.1.2.cmml" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.2"></eq><apply id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.cmml" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1"><apply id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.2.cmml" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.2.1.cmml" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.2.2.cmml" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.2.2.1.cmml" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.2.2.2.cmml" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.2.2.2"></sum><apply id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.2.2.3.cmml" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.2.2.3"><eq id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.2.2.3.1"></eq><ci id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.2.2.3.2">𝑗</ci><cn id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.2.3.cmml" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.2.3">𝐽</ci></apply><apply id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1"><times id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.2.cmml" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.2"></times><apply id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.3.cmml" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.3.2">𝑤</ci><ci id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.3.3">𝑗</ci></apply><apply id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.4.cmml" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.4.1.cmml" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.4.2.cmml" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.4.2">𝑄</ci><ci id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.4.3.cmml" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.4.3">𝑓</ci></apply><apply id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2">𝑋</ci><ci id="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3">𝑗</ci></apply></apply></apply><cn id="S3.E8Xa.3.2.2.m1.1.1.1.1.3.cmml" type="integer" xref="S3.E8Xa.3.2.2.m1.1.1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8Xa.3.2.2.m1.1c">\displaystyle\sum_{j=1}^{J}w_{j}Q_{f}(X_{j})=0\,,</annotation><annotation encoding="application/x-llamapun" id="S3.E8Xa.3.2.2.m1.1d">∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_J end_POSTSUPERSCRIPT italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_Q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) = 0 ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S3.SS1.p2.5">where <math alttext="P(X_{j})" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><mrow id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml"><mi id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3.cmml">P</mi><mo id="S3.SS1.p2.1.m1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p2.1.m1.1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.1.1.cmml"><mo id="S3.SS1.p2.1.m1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p2.1.m1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS1.p2.1.m1.1.1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.1.m1.1.1.1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.1.1.1.2.cmml">X</mi><mi id="S3.SS1.p2.1.m1.1.1.1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.SS1.p2.1.m1.1.1.1.1.3" stretchy="false" xref="S3.SS1.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1"><times id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2"></times><ci id="S3.SS1.p2.1.m1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3">𝑃</ci><apply id="S3.SS1.p2.1.m1.1.1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.2">𝑋</ci><ci id="S3.SS1.p2.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">P(X_{j})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">italic_P ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT )</annotation></semantics></math> and <math alttext="Q_{f}(X_{j})" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><mrow id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml"><msub id="S3.SS1.p2.2.m2.1.1.3" xref="S3.SS1.p2.2.m2.1.1.3.cmml"><mi id="S3.SS1.p2.2.m2.1.1.3.2" xref="S3.SS1.p2.2.m2.1.1.3.2.cmml">Q</mi><mi id="S3.SS1.p2.2.m2.1.1.3.3" xref="S3.SS1.p2.2.m2.1.1.3.3.cmml">f</mi></msub><mo id="S3.SS1.p2.2.m2.1.1.2" xref="S3.SS1.p2.2.m2.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p2.2.m2.1.1.1.1" xref="S3.SS1.p2.2.m2.1.1.1.1.1.cmml"><mo id="S3.SS1.p2.2.m2.1.1.1.1.2" stretchy="false" xref="S3.SS1.p2.2.m2.1.1.1.1.1.cmml">(</mo><msub id="S3.SS1.p2.2.m2.1.1.1.1.1" xref="S3.SS1.p2.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.2.m2.1.1.1.1.1.2" xref="S3.SS1.p2.2.m2.1.1.1.1.1.2.cmml">X</mi><mi id="S3.SS1.p2.2.m2.1.1.1.1.1.3" xref="S3.SS1.p2.2.m2.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.SS1.p2.2.m2.1.1.1.1.3" stretchy="false" xref="S3.SS1.p2.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"><times id="S3.SS1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.2"></times><apply id="S3.SS1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.3.1.cmml" xref="S3.SS1.p2.2.m2.1.1.3">subscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.3.2.cmml" xref="S3.SS1.p2.2.m2.1.1.3.2">𝑄</ci><ci id="S3.SS1.p2.2.m2.1.1.3.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3.3">𝑓</ci></apply><apply id="S3.SS1.p2.2.m2.1.1.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1.2">𝑋</ci><ci id="S3.SS1.p2.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">Q_{f}(X_{j})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">italic_Q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT )</annotation></semantics></math> denote the probability of the event <math alttext="\mathbf{x}\in X_{j}" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.1"><semantics id="S3.SS1.p2.3.m3.1a"><mrow id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml"><mi id="S3.SS1.p2.3.m3.1.1.2" xref="S3.SS1.p2.3.m3.1.1.2.cmml">𝐱</mi><mo id="S3.SS1.p2.3.m3.1.1.1" xref="S3.SS1.p2.3.m3.1.1.1.cmml">∈</mo><msub id="S3.SS1.p2.3.m3.1.1.3" xref="S3.SS1.p2.3.m3.1.1.3.cmml"><mi id="S3.SS1.p2.3.m3.1.1.3.2" xref="S3.SS1.p2.3.m3.1.1.3.2.cmml">X</mi><mi id="S3.SS1.p2.3.m3.1.1.3.3" xref="S3.SS1.p2.3.m3.1.1.3.3.cmml">j</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><apply id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1"><in id="S3.SS1.p2.3.m3.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1.1"></in><ci id="S3.SS1.p2.3.m3.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2">𝐱</ci><apply id="S3.SS1.p2.3.m3.1.1.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.3.1.cmml" xref="S3.SS1.p2.3.m3.1.1.3">subscript</csymbol><ci id="S3.SS1.p2.3.m3.1.1.3.2.cmml" xref="S3.SS1.p2.3.m3.1.1.3.2">𝑋</ci><ci id="S3.SS1.p2.3.m3.1.1.3.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">\mathbf{x}\in X_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.1d">bold_x ∈ italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> under the respective distribution and the constraint ensures that <math alttext="\delta f" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m4.1"><semantics id="S3.SS1.p2.4.m4.1a"><mrow id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml"><mi id="S3.SS1.p2.4.m4.1.1.2" xref="S3.SS1.p2.4.m4.1.1.2.cmml">δ</mi><mo id="S3.SS1.p2.4.m4.1.1.1" xref="S3.SS1.p2.4.m4.1.1.1.cmml">⁢</mo><mi id="S3.SS1.p2.4.m4.1.1.3" xref="S3.SS1.p2.4.m4.1.1.3.cmml">f</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><apply id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1"><times id="S3.SS1.p2.4.m4.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1"></times><ci id="S3.SS1.p2.4.m4.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.2">𝛿</ci><ci id="S3.SS1.p2.4.m4.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">\delta f</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m4.1d">italic_δ italic_f</annotation></semantics></math> has zero expectation under <math alttext="q_{f}" class="ltx_Math" display="inline" id="S3.SS1.p2.5.m5.1"><semantics id="S3.SS1.p2.5.m5.1a"><msub id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml"><mi id="S3.SS1.p2.5.m5.1.1.2" xref="S3.SS1.p2.5.m5.1.1.2.cmml">q</mi><mi id="S3.SS1.p2.5.m5.1.1.3" xref="S3.SS1.p2.5.m5.1.1.3.cmml">f</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><apply id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.1.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.p2.5.m5.1.1.2.cmml" xref="S3.SS1.p2.5.m5.1.1.2">𝑞</ci><ci id="S3.SS1.p2.5.m5.1.1.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">q_{f}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.5.m5.1d">italic_q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT</annotation></semantics></math>.
With respect to the leaf weights this is a quadratic program whose optimal solution and objective values are respectively given by</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A5.EGx1">
<tbody id="S3.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle w_{j}^{*}=\frac{P(X_{j})}{Q_{f}(X_{j})}-1\,," class="ltx_Math" display="inline" id="S3.E9.m1.3"><semantics id="S3.E9.m1.3a"><mrow id="S3.E9.m1.3.3.1" xref="S3.E9.m1.3.3.1.1.cmml"><mrow id="S3.E9.m1.3.3.1.1" xref="S3.E9.m1.3.3.1.1.cmml"><msubsup id="S3.E9.m1.3.3.1.1.2" xref="S3.E9.m1.3.3.1.1.2.cmml"><mi id="S3.E9.m1.3.3.1.1.2.2.2" xref="S3.E9.m1.3.3.1.1.2.2.2.cmml">w</mi><mi id="S3.E9.m1.3.3.1.1.2.2.3" xref="S3.E9.m1.3.3.1.1.2.2.3.cmml">j</mi><mo id="S3.E9.m1.3.3.1.1.2.3" xref="S3.E9.m1.3.3.1.1.2.3.cmml">∗</mo></msubsup><mo id="S3.E9.m1.3.3.1.1.1" xref="S3.E9.m1.3.3.1.1.1.cmml">=</mo><mrow id="S3.E9.m1.3.3.1.1.3" xref="S3.E9.m1.3.3.1.1.3.cmml"><mstyle displaystyle="true" id="S3.E9.m1.2.2" xref="S3.E9.m1.2.2.cmml"><mfrac id="S3.E9.m1.2.2a" xref="S3.E9.m1.2.2.cmml"><mrow id="S3.E9.m1.1.1.1" xref="S3.E9.m1.1.1.1.cmml"><mi id="S3.E9.m1.1.1.1.3" xref="S3.E9.m1.1.1.1.3.cmml">P</mi><mo id="S3.E9.m1.1.1.1.2" xref="S3.E9.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E9.m1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.cmml"><mo id="S3.E9.m1.1.1.1.1.1.2" stretchy="false" xref="S3.E9.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E9.m1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.cmml"><mi id="S3.E9.m1.1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.1.2.cmml">X</mi><mi id="S3.E9.m1.1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.E9.m1.1.1.1.1.1.3" stretchy="false" xref="S3.E9.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E9.m1.2.2.2" xref="S3.E9.m1.2.2.2.cmml"><msub id="S3.E9.m1.2.2.2.3" xref="S3.E9.m1.2.2.2.3.cmml"><mi id="S3.E9.m1.2.2.2.3.2" xref="S3.E9.m1.2.2.2.3.2.cmml">Q</mi><mi id="S3.E9.m1.2.2.2.3.3" xref="S3.E9.m1.2.2.2.3.3.cmml">f</mi></msub><mo id="S3.E9.m1.2.2.2.2" xref="S3.E9.m1.2.2.2.2.cmml">⁢</mo><mrow id="S3.E9.m1.2.2.2.1.1" xref="S3.E9.m1.2.2.2.1.1.1.cmml"><mo id="S3.E9.m1.2.2.2.1.1.2" stretchy="false" xref="S3.E9.m1.2.2.2.1.1.1.cmml">(</mo><msub id="S3.E9.m1.2.2.2.1.1.1" xref="S3.E9.m1.2.2.2.1.1.1.cmml"><mi id="S3.E9.m1.2.2.2.1.1.1.2" xref="S3.E9.m1.2.2.2.1.1.1.2.cmml">X</mi><mi id="S3.E9.m1.2.2.2.1.1.1.3" xref="S3.E9.m1.2.2.2.1.1.1.3.cmml">j</mi></msub><mo id="S3.E9.m1.2.2.2.1.1.3" stretchy="false" xref="S3.E9.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mstyle><mo id="S3.E9.m1.3.3.1.1.3.1" xref="S3.E9.m1.3.3.1.1.3.1.cmml">−</mo><mn id="S3.E9.m1.3.3.1.1.3.2" xref="S3.E9.m1.3.3.1.1.3.2.cmml">1</mn></mrow></mrow><mo id="S3.E9.m1.3.3.1.2" lspace="0.170em" xref="S3.E9.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.3b"><apply id="S3.E9.m1.3.3.1.1.cmml" xref="S3.E9.m1.3.3.1"><eq id="S3.E9.m1.3.3.1.1.1.cmml" xref="S3.E9.m1.3.3.1.1.1"></eq><apply id="S3.E9.m1.3.3.1.1.2.cmml" xref="S3.E9.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.1.1.2.1.cmml" xref="S3.E9.m1.3.3.1.1.2">superscript</csymbol><apply id="S3.E9.m1.3.3.1.1.2.2.cmml" xref="S3.E9.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.1.1.2.2.1.cmml" xref="S3.E9.m1.3.3.1.1.2">subscript</csymbol><ci id="S3.E9.m1.3.3.1.1.2.2.2.cmml" xref="S3.E9.m1.3.3.1.1.2.2.2">𝑤</ci><ci id="S3.E9.m1.3.3.1.1.2.2.3.cmml" xref="S3.E9.m1.3.3.1.1.2.2.3">𝑗</ci></apply><times id="S3.E9.m1.3.3.1.1.2.3.cmml" xref="S3.E9.m1.3.3.1.1.2.3"></times></apply><apply id="S3.E9.m1.3.3.1.1.3.cmml" xref="S3.E9.m1.3.3.1.1.3"><minus id="S3.E9.m1.3.3.1.1.3.1.cmml" xref="S3.E9.m1.3.3.1.1.3.1"></minus><apply id="S3.E9.m1.2.2.cmml" xref="S3.E9.m1.2.2"><divide id="S3.E9.m1.2.2.3.cmml" xref="S3.E9.m1.2.2"></divide><apply id="S3.E9.m1.1.1.1.cmml" xref="S3.E9.m1.1.1.1"><times id="S3.E9.m1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.2"></times><ci id="S3.E9.m1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.3">𝑃</ci><apply id="S3.E9.m1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E9.m1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.2">𝑋</ci><ci id="S3.E9.m1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.3">𝑗</ci></apply></apply><apply id="S3.E9.m1.2.2.2.cmml" xref="S3.E9.m1.2.2.2"><times id="S3.E9.m1.2.2.2.2.cmml" xref="S3.E9.m1.2.2.2.2"></times><apply id="S3.E9.m1.2.2.2.3.cmml" xref="S3.E9.m1.2.2.2.3"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.2.3.1.cmml" xref="S3.E9.m1.2.2.2.3">subscript</csymbol><ci id="S3.E9.m1.2.2.2.3.2.cmml" xref="S3.E9.m1.2.2.2.3.2">𝑄</ci><ci id="S3.E9.m1.2.2.2.3.3.cmml" xref="S3.E9.m1.2.2.2.3.3">𝑓</ci></apply><apply id="S3.E9.m1.2.2.2.1.1.1.cmml" xref="S3.E9.m1.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.2.1.1.1.1.cmml" xref="S3.E9.m1.2.2.2.1.1">subscript</csymbol><ci id="S3.E9.m1.2.2.2.1.1.1.2.cmml" xref="S3.E9.m1.2.2.2.1.1.1.2">𝑋</ci><ci id="S3.E9.m1.2.2.2.1.1.1.3.cmml" xref="S3.E9.m1.2.2.2.1.1.1.3">𝑗</ci></apply></apply></apply><cn id="S3.E9.m1.3.3.1.1.3.2.cmml" type="integer" xref="S3.E9.m1.3.3.1.1.3.2">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.3c">\displaystyle w_{j}^{*}=\frac{P(X_{j})}{Q_{f}(X_{j})}-1\,,</annotation><annotation encoding="application/x-llamapun" id="S3.E9.m1.3d">italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = divide start_ARG italic_P ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG start_ARG italic_Q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG - 1 ,</annotation></semantics></math></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\Delta L_{f}^{*}\left(X_{1},\ldots,X_{J}\right)=\frac{1}{2}\left(%
\sum_{j=1}^{J}\frac{P^{2}(X_{j})}{Q_{f}(X_{j})}-1\right)\,." class="ltx_Math" display="inline" id="S3.E9.m2.4"><semantics id="S3.E9.m2.4a"><mrow id="S3.E9.m2.4.4.1" xref="S3.E9.m2.4.4.1.1.cmml"><mrow id="S3.E9.m2.4.4.1.1" xref="S3.E9.m2.4.4.1.1.cmml"><mrow id="S3.E9.m2.4.4.1.1.2" xref="S3.E9.m2.4.4.1.1.2.cmml"><mi id="S3.E9.m2.4.4.1.1.2.4" mathvariant="normal" xref="S3.E9.m2.4.4.1.1.2.4.cmml">Δ</mi><mo id="S3.E9.m2.4.4.1.1.2.3" xref="S3.E9.m2.4.4.1.1.2.3.cmml">⁢</mo><msubsup id="S3.E9.m2.4.4.1.1.2.5" xref="S3.E9.m2.4.4.1.1.2.5.cmml"><mi id="S3.E9.m2.4.4.1.1.2.5.2.2" xref="S3.E9.m2.4.4.1.1.2.5.2.2.cmml">L</mi><mi id="S3.E9.m2.4.4.1.1.2.5.2.3" xref="S3.E9.m2.4.4.1.1.2.5.2.3.cmml">f</mi><mo id="S3.E9.m2.4.4.1.1.2.5.3" xref="S3.E9.m2.4.4.1.1.2.5.3.cmml">∗</mo></msubsup><mo id="S3.E9.m2.4.4.1.1.2.3a" xref="S3.E9.m2.4.4.1.1.2.3.cmml">⁢</mo><mrow id="S3.E9.m2.4.4.1.1.2.2.2" xref="S3.E9.m2.4.4.1.1.2.2.3.cmml"><mo id="S3.E9.m2.4.4.1.1.2.2.2.3" xref="S3.E9.m2.4.4.1.1.2.2.3.cmml">(</mo><msub id="S3.E9.m2.4.4.1.1.1.1.1.1" xref="S3.E9.m2.4.4.1.1.1.1.1.1.cmml"><mi id="S3.E9.m2.4.4.1.1.1.1.1.1.2" xref="S3.E9.m2.4.4.1.1.1.1.1.1.2.cmml">X</mi><mn id="S3.E9.m2.4.4.1.1.1.1.1.1.3" xref="S3.E9.m2.4.4.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.E9.m2.4.4.1.1.2.2.2.4" xref="S3.E9.m2.4.4.1.1.2.2.3.cmml">,</mo><mi id="S3.E9.m2.3.3" mathvariant="normal" xref="S3.E9.m2.3.3.cmml">…</mi><mo id="S3.E9.m2.4.4.1.1.2.2.2.5" xref="S3.E9.m2.4.4.1.1.2.2.3.cmml">,</mo><msub id="S3.E9.m2.4.4.1.1.2.2.2.2" xref="S3.E9.m2.4.4.1.1.2.2.2.2.cmml"><mi id="S3.E9.m2.4.4.1.1.2.2.2.2.2" xref="S3.E9.m2.4.4.1.1.2.2.2.2.2.cmml">X</mi><mi id="S3.E9.m2.4.4.1.1.2.2.2.2.3" xref="S3.E9.m2.4.4.1.1.2.2.2.2.3.cmml">J</mi></msub><mo id="S3.E9.m2.4.4.1.1.2.2.2.6" xref="S3.E9.m2.4.4.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E9.m2.4.4.1.1.4" xref="S3.E9.m2.4.4.1.1.4.cmml">=</mo><mrow id="S3.E9.m2.4.4.1.1.3" xref="S3.E9.m2.4.4.1.1.3.cmml"><mstyle displaystyle="true" id="S3.E9.m2.4.4.1.1.3.3" xref="S3.E9.m2.4.4.1.1.3.3.cmml"><mfrac id="S3.E9.m2.4.4.1.1.3.3a" xref="S3.E9.m2.4.4.1.1.3.3.cmml"><mn id="S3.E9.m2.4.4.1.1.3.3.2" xref="S3.E9.m2.4.4.1.1.3.3.2.cmml">1</mn><mn id="S3.E9.m2.4.4.1.1.3.3.3" xref="S3.E9.m2.4.4.1.1.3.3.3.cmml">2</mn></mfrac></mstyle><mo id="S3.E9.m2.4.4.1.1.3.2" xref="S3.E9.m2.4.4.1.1.3.2.cmml">⁢</mo><mrow id="S3.E9.m2.4.4.1.1.3.1.1" xref="S3.E9.m2.4.4.1.1.3.1.1.1.cmml"><mo id="S3.E9.m2.4.4.1.1.3.1.1.2" xref="S3.E9.m2.4.4.1.1.3.1.1.1.cmml">(</mo><mrow id="S3.E9.m2.4.4.1.1.3.1.1.1" xref="S3.E9.m2.4.4.1.1.3.1.1.1.cmml"><mrow id="S3.E9.m2.4.4.1.1.3.1.1.1.2" xref="S3.E9.m2.4.4.1.1.3.1.1.1.2.cmml"><mstyle displaystyle="true" id="S3.E9.m2.4.4.1.1.3.1.1.1.2.1" xref="S3.E9.m2.4.4.1.1.3.1.1.1.2.1.cmml"><munderover id="S3.E9.m2.4.4.1.1.3.1.1.1.2.1a" xref="S3.E9.m2.4.4.1.1.3.1.1.1.2.1.cmml"><mo id="S3.E9.m2.4.4.1.1.3.1.1.1.2.1.2.2" movablelimits="false" xref="S3.E9.m2.4.4.1.1.3.1.1.1.2.1.2.2.cmml">∑</mo><mrow id="S3.E9.m2.4.4.1.1.3.1.1.1.2.1.2.3" xref="S3.E9.m2.4.4.1.1.3.1.1.1.2.1.2.3.cmml"><mi id="S3.E9.m2.4.4.1.1.3.1.1.1.2.1.2.3.2" xref="S3.E9.m2.4.4.1.1.3.1.1.1.2.1.2.3.2.cmml">j</mi><mo id="S3.E9.m2.4.4.1.1.3.1.1.1.2.1.2.3.1" xref="S3.E9.m2.4.4.1.1.3.1.1.1.2.1.2.3.1.cmml">=</mo><mn id="S3.E9.m2.4.4.1.1.3.1.1.1.2.1.2.3.3" xref="S3.E9.m2.4.4.1.1.3.1.1.1.2.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E9.m2.4.4.1.1.3.1.1.1.2.1.3" xref="S3.E9.m2.4.4.1.1.3.1.1.1.2.1.3.cmml">J</mi></munderover></mstyle><mstyle displaystyle="true" id="S3.E9.m2.2.2" xref="S3.E9.m2.2.2.cmml"><mfrac id="S3.E9.m2.2.2a" xref="S3.E9.m2.2.2.cmml"><mrow id="S3.E9.m2.1.1.1" xref="S3.E9.m2.1.1.1.cmml"><msup id="S3.E9.m2.1.1.1.3" xref="S3.E9.m2.1.1.1.3.cmml"><mi id="S3.E9.m2.1.1.1.3.2" xref="S3.E9.m2.1.1.1.3.2.cmml">P</mi><mn id="S3.E9.m2.1.1.1.3.3" xref="S3.E9.m2.1.1.1.3.3.cmml">2</mn></msup><mo id="S3.E9.m2.1.1.1.2" xref="S3.E9.m2.1.1.1.2.cmml">⁢</mo><mrow id="S3.E9.m2.1.1.1.1.1" xref="S3.E9.m2.1.1.1.1.1.1.cmml"><mo id="S3.E9.m2.1.1.1.1.1.2" stretchy="false" xref="S3.E9.m2.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E9.m2.1.1.1.1.1.1" xref="S3.E9.m2.1.1.1.1.1.1.cmml"><mi id="S3.E9.m2.1.1.1.1.1.1.2" xref="S3.E9.m2.1.1.1.1.1.1.2.cmml">X</mi><mi id="S3.E9.m2.1.1.1.1.1.1.3" xref="S3.E9.m2.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.E9.m2.1.1.1.1.1.3" stretchy="false" xref="S3.E9.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E9.m2.2.2.2" xref="S3.E9.m2.2.2.2.cmml"><msub id="S3.E9.m2.2.2.2.3" xref="S3.E9.m2.2.2.2.3.cmml"><mi id="S3.E9.m2.2.2.2.3.2" xref="S3.E9.m2.2.2.2.3.2.cmml">Q</mi><mi id="S3.E9.m2.2.2.2.3.3" xref="S3.E9.m2.2.2.2.3.3.cmml">f</mi></msub><mo id="S3.E9.m2.2.2.2.2" xref="S3.E9.m2.2.2.2.2.cmml">⁢</mo><mrow id="S3.E9.m2.2.2.2.1.1" xref="S3.E9.m2.2.2.2.1.1.1.cmml"><mo id="S3.E9.m2.2.2.2.1.1.2" stretchy="false" xref="S3.E9.m2.2.2.2.1.1.1.cmml">(</mo><msub id="S3.E9.m2.2.2.2.1.1.1" xref="S3.E9.m2.2.2.2.1.1.1.cmml"><mi id="S3.E9.m2.2.2.2.1.1.1.2" xref="S3.E9.m2.2.2.2.1.1.1.2.cmml">X</mi><mi id="S3.E9.m2.2.2.2.1.1.1.3" xref="S3.E9.m2.2.2.2.1.1.1.3.cmml">j</mi></msub><mo id="S3.E9.m2.2.2.2.1.1.3" stretchy="false" xref="S3.E9.m2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mstyle></mrow><mo id="S3.E9.m2.4.4.1.1.3.1.1.1.1" xref="S3.E9.m2.4.4.1.1.3.1.1.1.1.cmml">−</mo><mn id="S3.E9.m2.4.4.1.1.3.1.1.1.3" xref="S3.E9.m2.4.4.1.1.3.1.1.1.3.cmml">1</mn></mrow><mo id="S3.E9.m2.4.4.1.1.3.1.1.3" xref="S3.E9.m2.4.4.1.1.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E9.m2.4.4.1.2" lspace="0.170em" xref="S3.E9.m2.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m2.4b"><apply id="S3.E9.m2.4.4.1.1.cmml" xref="S3.E9.m2.4.4.1"><eq id="S3.E9.m2.4.4.1.1.4.cmml" xref="S3.E9.m2.4.4.1.1.4"></eq><apply id="S3.E9.m2.4.4.1.1.2.cmml" xref="S3.E9.m2.4.4.1.1.2"><times id="S3.E9.m2.4.4.1.1.2.3.cmml" xref="S3.E9.m2.4.4.1.1.2.3"></times><ci id="S3.E9.m2.4.4.1.1.2.4.cmml" xref="S3.E9.m2.4.4.1.1.2.4">Δ</ci><apply id="S3.E9.m2.4.4.1.1.2.5.cmml" xref="S3.E9.m2.4.4.1.1.2.5"><csymbol cd="ambiguous" id="S3.E9.m2.4.4.1.1.2.5.1.cmml" xref="S3.E9.m2.4.4.1.1.2.5">superscript</csymbol><apply id="S3.E9.m2.4.4.1.1.2.5.2.cmml" xref="S3.E9.m2.4.4.1.1.2.5"><csymbol cd="ambiguous" id="S3.E9.m2.4.4.1.1.2.5.2.1.cmml" xref="S3.E9.m2.4.4.1.1.2.5">subscript</csymbol><ci id="S3.E9.m2.4.4.1.1.2.5.2.2.cmml" xref="S3.E9.m2.4.4.1.1.2.5.2.2">𝐿</ci><ci id="S3.E9.m2.4.4.1.1.2.5.2.3.cmml" xref="S3.E9.m2.4.4.1.1.2.5.2.3">𝑓</ci></apply><times id="S3.E9.m2.4.4.1.1.2.5.3.cmml" xref="S3.E9.m2.4.4.1.1.2.5.3"></times></apply><vector id="S3.E9.m2.4.4.1.1.2.2.3.cmml" xref="S3.E9.m2.4.4.1.1.2.2.2"><apply id="S3.E9.m2.4.4.1.1.1.1.1.1.cmml" xref="S3.E9.m2.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m2.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E9.m2.4.4.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E9.m2.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E9.m2.4.4.1.1.1.1.1.1.2">𝑋</ci><cn id="S3.E9.m2.4.4.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E9.m2.4.4.1.1.1.1.1.1.3">1</cn></apply><ci id="S3.E9.m2.3.3.cmml" xref="S3.E9.m2.3.3">…</ci><apply id="S3.E9.m2.4.4.1.1.2.2.2.2.cmml" xref="S3.E9.m2.4.4.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E9.m2.4.4.1.1.2.2.2.2.1.cmml" xref="S3.E9.m2.4.4.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E9.m2.4.4.1.1.2.2.2.2.2.cmml" xref="S3.E9.m2.4.4.1.1.2.2.2.2.2">𝑋</ci><ci id="S3.E9.m2.4.4.1.1.2.2.2.2.3.cmml" xref="S3.E9.m2.4.4.1.1.2.2.2.2.3">𝐽</ci></apply></vector></apply><apply id="S3.E9.m2.4.4.1.1.3.cmml" xref="S3.E9.m2.4.4.1.1.3"><times id="S3.E9.m2.4.4.1.1.3.2.cmml" xref="S3.E9.m2.4.4.1.1.3.2"></times><apply id="S3.E9.m2.4.4.1.1.3.3.cmml" xref="S3.E9.m2.4.4.1.1.3.3"><divide id="S3.E9.m2.4.4.1.1.3.3.1.cmml" xref="S3.E9.m2.4.4.1.1.3.3"></divide><cn id="S3.E9.m2.4.4.1.1.3.3.2.cmml" type="integer" xref="S3.E9.m2.4.4.1.1.3.3.2">1</cn><cn id="S3.E9.m2.4.4.1.1.3.3.3.cmml" type="integer" xref="S3.E9.m2.4.4.1.1.3.3.3">2</cn></apply><apply id="S3.E9.m2.4.4.1.1.3.1.1.1.cmml" xref="S3.E9.m2.4.4.1.1.3.1.1"><minus id="S3.E9.m2.4.4.1.1.3.1.1.1.1.cmml" xref="S3.E9.m2.4.4.1.1.3.1.1.1.1"></minus><apply id="S3.E9.m2.4.4.1.1.3.1.1.1.2.cmml" xref="S3.E9.m2.4.4.1.1.3.1.1.1.2"><apply id="S3.E9.m2.4.4.1.1.3.1.1.1.2.1.cmml" xref="S3.E9.m2.4.4.1.1.3.1.1.1.2.1"><csymbol cd="ambiguous" id="S3.E9.m2.4.4.1.1.3.1.1.1.2.1.1.cmml" xref="S3.E9.m2.4.4.1.1.3.1.1.1.2.1">superscript</csymbol><apply id="S3.E9.m2.4.4.1.1.3.1.1.1.2.1.2.cmml" xref="S3.E9.m2.4.4.1.1.3.1.1.1.2.1"><csymbol cd="ambiguous" id="S3.E9.m2.4.4.1.1.3.1.1.1.2.1.2.1.cmml" xref="S3.E9.m2.4.4.1.1.3.1.1.1.2.1">subscript</csymbol><sum id="S3.E9.m2.4.4.1.1.3.1.1.1.2.1.2.2.cmml" xref="S3.E9.m2.4.4.1.1.3.1.1.1.2.1.2.2"></sum><apply id="S3.E9.m2.4.4.1.1.3.1.1.1.2.1.2.3.cmml" xref="S3.E9.m2.4.4.1.1.3.1.1.1.2.1.2.3"><eq id="S3.E9.m2.4.4.1.1.3.1.1.1.2.1.2.3.1.cmml" xref="S3.E9.m2.4.4.1.1.3.1.1.1.2.1.2.3.1"></eq><ci id="S3.E9.m2.4.4.1.1.3.1.1.1.2.1.2.3.2.cmml" xref="S3.E9.m2.4.4.1.1.3.1.1.1.2.1.2.3.2">𝑗</ci><cn id="S3.E9.m2.4.4.1.1.3.1.1.1.2.1.2.3.3.cmml" type="integer" xref="S3.E9.m2.4.4.1.1.3.1.1.1.2.1.2.3.3">1</cn></apply></apply><ci id="S3.E9.m2.4.4.1.1.3.1.1.1.2.1.3.cmml" xref="S3.E9.m2.4.4.1.1.3.1.1.1.2.1.3">𝐽</ci></apply><apply id="S3.E9.m2.2.2.cmml" xref="S3.E9.m2.2.2"><divide id="S3.E9.m2.2.2.3.cmml" xref="S3.E9.m2.2.2"></divide><apply id="S3.E9.m2.1.1.1.cmml" xref="S3.E9.m2.1.1.1"><times id="S3.E9.m2.1.1.1.2.cmml" xref="S3.E9.m2.1.1.1.2"></times><apply id="S3.E9.m2.1.1.1.3.cmml" xref="S3.E9.m2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m2.1.1.1.3.1.cmml" xref="S3.E9.m2.1.1.1.3">superscript</csymbol><ci id="S3.E9.m2.1.1.1.3.2.cmml" xref="S3.E9.m2.1.1.1.3.2">𝑃</ci><cn id="S3.E9.m2.1.1.1.3.3.cmml" type="integer" xref="S3.E9.m2.1.1.1.3.3">2</cn></apply><apply id="S3.E9.m2.1.1.1.1.1.1.cmml" xref="S3.E9.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m2.1.1.1.1.1.1.1.cmml" xref="S3.E9.m2.1.1.1.1.1">subscript</csymbol><ci id="S3.E9.m2.1.1.1.1.1.1.2.cmml" xref="S3.E9.m2.1.1.1.1.1.1.2">𝑋</ci><ci id="S3.E9.m2.1.1.1.1.1.1.3.cmml" xref="S3.E9.m2.1.1.1.1.1.1.3">𝑗</ci></apply></apply><apply id="S3.E9.m2.2.2.2.cmml" xref="S3.E9.m2.2.2.2"><times id="S3.E9.m2.2.2.2.2.cmml" xref="S3.E9.m2.2.2.2.2"></times><apply id="S3.E9.m2.2.2.2.3.cmml" xref="S3.E9.m2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E9.m2.2.2.2.3.1.cmml" xref="S3.E9.m2.2.2.2.3">subscript</csymbol><ci id="S3.E9.m2.2.2.2.3.2.cmml" xref="S3.E9.m2.2.2.2.3.2">𝑄</ci><ci id="S3.E9.m2.2.2.2.3.3.cmml" xref="S3.E9.m2.2.2.2.3.3">𝑓</ci></apply><apply id="S3.E9.m2.2.2.2.1.1.1.cmml" xref="S3.E9.m2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E9.m2.2.2.2.1.1.1.1.cmml" xref="S3.E9.m2.2.2.2.1.1">subscript</csymbol><ci id="S3.E9.m2.2.2.2.1.1.1.2.cmml" xref="S3.E9.m2.2.2.2.1.1.1.2">𝑋</ci><ci id="S3.E9.m2.2.2.2.1.1.1.3.cmml" xref="S3.E9.m2.2.2.2.1.1.1.3">𝑗</ci></apply></apply></apply></apply><cn id="S3.E9.m2.4.4.1.1.3.1.1.1.3.cmml" type="integer" xref="S3.E9.m2.4.4.1.1.3.1.1.1.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m2.4c">\displaystyle\Delta L_{f}^{*}\left(X_{1},\ldots,X_{J}\right)=\frac{1}{2}\left(%
\sum_{j=1}^{J}\frac{P^{2}(X_{j})}{Q_{f}(X_{j})}-1\right)\,.</annotation><annotation encoding="application/x-llamapun" id="S3.E9.m2.4d">roman_Δ italic_L start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_X start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_X start_POSTSUBSCRIPT italic_J end_POSTSUBSCRIPT ) = divide start_ARG 1 end_ARG start_ARG 2 end_ARG ( ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_J end_POSTSUPERSCRIPT divide start_ARG italic_P start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG start_ARG italic_Q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG - 1 ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p2.9">Because carrying out the maximization of this optimal value over the tree structure that determines the <math alttext="X_{j}" class="ltx_Math" display="inline" id="S3.SS1.p2.6.m1.1"><semantics id="S3.SS1.p2.6.m1.1a"><msub id="S3.SS1.p2.6.m1.1.1" xref="S3.SS1.p2.6.m1.1.1.cmml"><mi id="S3.SS1.p2.6.m1.1.1.2" xref="S3.SS1.p2.6.m1.1.1.2.cmml">X</mi><mi id="S3.SS1.p2.6.m1.1.1.3" xref="S3.SS1.p2.6.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m1.1b"><apply id="S3.SS1.p2.6.m1.1.1.cmml" xref="S3.SS1.p2.6.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m1.1.1.1.cmml" xref="S3.SS1.p2.6.m1.1.1">subscript</csymbol><ci id="S3.SS1.p2.6.m1.1.1.2.cmml" xref="S3.SS1.p2.6.m1.1.1.2">𝑋</ci><ci id="S3.SS1.p2.6.m1.1.1.3.cmml" xref="S3.SS1.p2.6.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m1.1c">X_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.6.m1.1d">italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> is hard, we approximate its
solution by greedily growing a tree that maximizes it when considering how to split each node individually.
A parent leaf with support <math alttext="X_{P}" class="ltx_Math" display="inline" id="S3.SS1.p2.7.m2.1"><semantics id="S3.SS1.p2.7.m2.1a"><msub id="S3.SS1.p2.7.m2.1.1" xref="S3.SS1.p2.7.m2.1.1.cmml"><mi id="S3.SS1.p2.7.m2.1.1.2" xref="S3.SS1.p2.7.m2.1.1.2.cmml">X</mi><mi id="S3.SS1.p2.7.m2.1.1.3" xref="S3.SS1.p2.7.m2.1.1.3.cmml">P</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m2.1b"><apply id="S3.SS1.p2.7.m2.1.1.cmml" xref="S3.SS1.p2.7.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m2.1.1.1.cmml" xref="S3.SS1.p2.7.m2.1.1">subscript</csymbol><ci id="S3.SS1.p2.7.m2.1.1.2.cmml" xref="S3.SS1.p2.7.m2.1.1.2">𝑋</ci><ci id="S3.SS1.p2.7.m2.1.1.3.cmml" xref="S3.SS1.p2.7.m2.1.1.3">𝑃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m2.1c">X_{P}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.7.m2.1d">italic_X start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT</annotation></semantics></math> is thus split into two child leaves, with disjoint support, <math alttext="X_{L}\cup X_{R}=X_{P}" class="ltx_Math" display="inline" id="S3.SS1.p2.8.m3.1"><semantics id="S3.SS1.p2.8.m3.1a"><mrow id="S3.SS1.p2.8.m3.1.1" xref="S3.SS1.p2.8.m3.1.1.cmml"><mrow id="S3.SS1.p2.8.m3.1.1.2" xref="S3.SS1.p2.8.m3.1.1.2.cmml"><msub id="S3.SS1.p2.8.m3.1.1.2.2" xref="S3.SS1.p2.8.m3.1.1.2.2.cmml"><mi id="S3.SS1.p2.8.m3.1.1.2.2.2" xref="S3.SS1.p2.8.m3.1.1.2.2.2.cmml">X</mi><mi id="S3.SS1.p2.8.m3.1.1.2.2.3" xref="S3.SS1.p2.8.m3.1.1.2.2.3.cmml">L</mi></msub><mo id="S3.SS1.p2.8.m3.1.1.2.1" xref="S3.SS1.p2.8.m3.1.1.2.1.cmml">∪</mo><msub id="S3.SS1.p2.8.m3.1.1.2.3" xref="S3.SS1.p2.8.m3.1.1.2.3.cmml"><mi id="S3.SS1.p2.8.m3.1.1.2.3.2" xref="S3.SS1.p2.8.m3.1.1.2.3.2.cmml">X</mi><mi id="S3.SS1.p2.8.m3.1.1.2.3.3" xref="S3.SS1.p2.8.m3.1.1.2.3.3.cmml">R</mi></msub></mrow><mo id="S3.SS1.p2.8.m3.1.1.1" xref="S3.SS1.p2.8.m3.1.1.1.cmml">=</mo><msub id="S3.SS1.p2.8.m3.1.1.3" xref="S3.SS1.p2.8.m3.1.1.3.cmml"><mi id="S3.SS1.p2.8.m3.1.1.3.2" xref="S3.SS1.p2.8.m3.1.1.3.2.cmml">X</mi><mi id="S3.SS1.p2.8.m3.1.1.3.3" xref="S3.SS1.p2.8.m3.1.1.3.3.cmml">P</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m3.1b"><apply id="S3.SS1.p2.8.m3.1.1.cmml" xref="S3.SS1.p2.8.m3.1.1"><eq id="S3.SS1.p2.8.m3.1.1.1.cmml" xref="S3.SS1.p2.8.m3.1.1.1"></eq><apply id="S3.SS1.p2.8.m3.1.1.2.cmml" xref="S3.SS1.p2.8.m3.1.1.2"><union id="S3.SS1.p2.8.m3.1.1.2.1.cmml" xref="S3.SS1.p2.8.m3.1.1.2.1"></union><apply id="S3.SS1.p2.8.m3.1.1.2.2.cmml" xref="S3.SS1.p2.8.m3.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m3.1.1.2.2.1.cmml" xref="S3.SS1.p2.8.m3.1.1.2.2">subscript</csymbol><ci id="S3.SS1.p2.8.m3.1.1.2.2.2.cmml" xref="S3.SS1.p2.8.m3.1.1.2.2.2">𝑋</ci><ci id="S3.SS1.p2.8.m3.1.1.2.2.3.cmml" xref="S3.SS1.p2.8.m3.1.1.2.2.3">𝐿</ci></apply><apply id="S3.SS1.p2.8.m3.1.1.2.3.cmml" xref="S3.SS1.p2.8.m3.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m3.1.1.2.3.1.cmml" xref="S3.SS1.p2.8.m3.1.1.2.3">subscript</csymbol><ci id="S3.SS1.p2.8.m3.1.1.2.3.2.cmml" xref="S3.SS1.p2.8.m3.1.1.2.3.2">𝑋</ci><ci id="S3.SS1.p2.8.m3.1.1.2.3.3.cmml" xref="S3.SS1.p2.8.m3.1.1.2.3.3">𝑅</ci></apply></apply><apply id="S3.SS1.p2.8.m3.1.1.3.cmml" xref="S3.SS1.p2.8.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m3.1.1.3.1.cmml" xref="S3.SS1.p2.8.m3.1.1.3">subscript</csymbol><ci id="S3.SS1.p2.8.m3.1.1.3.2.cmml" xref="S3.SS1.p2.8.m3.1.1.3.2">𝑋</ci><ci id="S3.SS1.p2.8.m3.1.1.3.3.cmml" xref="S3.SS1.p2.8.m3.1.1.3.3">𝑃</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.8.m3.1c">X_{L}\cup X_{R}=X_{P}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.8.m3.1d">italic_X start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT ∪ italic_X start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT = italic_X start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT</annotation></semantics></math>, so as to maximize over all possible partitionings along a single dimension, <math alttext="\mathcal{P}\left(X_{P}\right)" class="ltx_Math" display="inline" id="S3.SS1.p2.9.m4.1"><semantics id="S3.SS1.p2.9.m4.1a"><mrow id="S3.SS1.p2.9.m4.1.1" xref="S3.SS1.p2.9.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.9.m4.1.1.3" xref="S3.SS1.p2.9.m4.1.1.3.cmml">𝒫</mi><mo id="S3.SS1.p2.9.m4.1.1.2" xref="S3.SS1.p2.9.m4.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p2.9.m4.1.1.1.1" xref="S3.SS1.p2.9.m4.1.1.1.1.1.cmml"><mo id="S3.SS1.p2.9.m4.1.1.1.1.2" xref="S3.SS1.p2.9.m4.1.1.1.1.1.cmml">(</mo><msub id="S3.SS1.p2.9.m4.1.1.1.1.1" xref="S3.SS1.p2.9.m4.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.9.m4.1.1.1.1.1.2" xref="S3.SS1.p2.9.m4.1.1.1.1.1.2.cmml">X</mi><mi id="S3.SS1.p2.9.m4.1.1.1.1.1.3" xref="S3.SS1.p2.9.m4.1.1.1.1.1.3.cmml">P</mi></msub><mo id="S3.SS1.p2.9.m4.1.1.1.1.3" xref="S3.SS1.p2.9.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.9.m4.1b"><apply id="S3.SS1.p2.9.m4.1.1.cmml" xref="S3.SS1.p2.9.m4.1.1"><times id="S3.SS1.p2.9.m4.1.1.2.cmml" xref="S3.SS1.p2.9.m4.1.1.2"></times><ci id="S3.SS1.p2.9.m4.1.1.3.cmml" xref="S3.SS1.p2.9.m4.1.1.3">𝒫</ci><apply id="S3.SS1.p2.9.m4.1.1.1.1.1.cmml" xref="S3.SS1.p2.9.m4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.9.m4.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.9.m4.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.9.m4.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.9.m4.1.1.1.1.1.2">𝑋</ci><ci id="S3.SS1.p2.9.m4.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.9.m4.1.1.1.1.1.3">𝑃</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.9.m4.1c">\mathcal{P}\left(X_{P}\right)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.9.m4.1d">caligraphic_P ( italic_X start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT )</annotation></semantics></math>, the following objective:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\max_{X_{L},X_{R}\in\mathcal{P}\left(X_{P}\right)}\frac{P^{2}(X_{L})}{Q_{f}(X_%
{L})}+\frac{P^{2}(X_{R})}{Q_{f}(X_{R})}-\frac{P^{2}(X_{P})}{Q_{f}(X_{P})}\,." class="ltx_Math" display="block" id="S3.E10.m1.10"><semantics id="S3.E10.m1.10a"><mrow id="S3.E10.m1.10.10.1" xref="S3.E10.m1.10.10.1.1.cmml"><mrow id="S3.E10.m1.10.10.1.1" xref="S3.E10.m1.10.10.1.1.cmml"><mrow id="S3.E10.m1.10.10.1.1.2" xref="S3.E10.m1.10.10.1.1.2.cmml"><mrow id="S3.E10.m1.10.10.1.1.2.2" xref="S3.E10.m1.10.10.1.1.2.2.cmml"><munder id="S3.E10.m1.10.10.1.1.2.2.1" xref="S3.E10.m1.10.10.1.1.2.2.1.cmml"><mi id="S3.E10.m1.10.10.1.1.2.2.1.2" xref="S3.E10.m1.10.10.1.1.2.2.1.2.cmml">max</mi><mrow id="S3.E10.m1.3.3.3" xref="S3.E10.m1.3.3.3.cmml"><mrow id="S3.E10.m1.2.2.2.2.2" xref="S3.E10.m1.2.2.2.2.3.cmml"><msub id="S3.E10.m1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.cmml"><mi id="S3.E10.m1.1.1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.1.1.2.cmml">X</mi><mi id="S3.E10.m1.1.1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.1.1.3.cmml">L</mi></msub><mo id="S3.E10.m1.2.2.2.2.2.3" xref="S3.E10.m1.2.2.2.2.3.cmml">,</mo><msub id="S3.E10.m1.2.2.2.2.2.2" xref="S3.E10.m1.2.2.2.2.2.2.cmml"><mi id="S3.E10.m1.2.2.2.2.2.2.2" xref="S3.E10.m1.2.2.2.2.2.2.2.cmml">X</mi><mi id="S3.E10.m1.2.2.2.2.2.2.3" xref="S3.E10.m1.2.2.2.2.2.2.3.cmml">R</mi></msub></mrow><mo id="S3.E10.m1.3.3.3.4" xref="S3.E10.m1.3.3.3.4.cmml">∈</mo><mrow id="S3.E10.m1.3.3.3.3" xref="S3.E10.m1.3.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E10.m1.3.3.3.3.3" xref="S3.E10.m1.3.3.3.3.3.cmml">𝒫</mi><mo id="S3.E10.m1.3.3.3.3.2" xref="S3.E10.m1.3.3.3.3.2.cmml">⁢</mo><mrow id="S3.E10.m1.3.3.3.3.1.1" xref="S3.E10.m1.3.3.3.3.1.1.1.cmml"><mo id="S3.E10.m1.3.3.3.3.1.1.2" xref="S3.E10.m1.3.3.3.3.1.1.1.cmml">(</mo><msub id="S3.E10.m1.3.3.3.3.1.1.1" xref="S3.E10.m1.3.3.3.3.1.1.1.cmml"><mi id="S3.E10.m1.3.3.3.3.1.1.1.2" xref="S3.E10.m1.3.3.3.3.1.1.1.2.cmml">X</mi><mi id="S3.E10.m1.3.3.3.3.1.1.1.3" xref="S3.E10.m1.3.3.3.3.1.1.1.3.cmml">P</mi></msub><mo id="S3.E10.m1.3.3.3.3.1.1.3" xref="S3.E10.m1.3.3.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow></munder><mo id="S3.E10.m1.10.10.1.1.2.2a" lspace="0.167em" xref="S3.E10.m1.10.10.1.1.2.2.cmml">⁡</mo><mfrac id="S3.E10.m1.5.5" xref="S3.E10.m1.5.5.cmml"><mrow id="S3.E10.m1.4.4.1" xref="S3.E10.m1.4.4.1.cmml"><msup id="S3.E10.m1.4.4.1.3" xref="S3.E10.m1.4.4.1.3.cmml"><mi id="S3.E10.m1.4.4.1.3.2" xref="S3.E10.m1.4.4.1.3.2.cmml">P</mi><mn id="S3.E10.m1.4.4.1.3.3" xref="S3.E10.m1.4.4.1.3.3.cmml">2</mn></msup><mo id="S3.E10.m1.4.4.1.2" xref="S3.E10.m1.4.4.1.2.cmml">⁢</mo><mrow id="S3.E10.m1.4.4.1.1.1" xref="S3.E10.m1.4.4.1.1.1.1.cmml"><mo id="S3.E10.m1.4.4.1.1.1.2" stretchy="false" xref="S3.E10.m1.4.4.1.1.1.1.cmml">(</mo><msub id="S3.E10.m1.4.4.1.1.1.1" xref="S3.E10.m1.4.4.1.1.1.1.cmml"><mi id="S3.E10.m1.4.4.1.1.1.1.2" xref="S3.E10.m1.4.4.1.1.1.1.2.cmml">X</mi><mi id="S3.E10.m1.4.4.1.1.1.1.3" xref="S3.E10.m1.4.4.1.1.1.1.3.cmml">L</mi></msub><mo id="S3.E10.m1.4.4.1.1.1.3" stretchy="false" xref="S3.E10.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E10.m1.5.5.2" xref="S3.E10.m1.5.5.2.cmml"><msub id="S3.E10.m1.5.5.2.3" xref="S3.E10.m1.5.5.2.3.cmml"><mi id="S3.E10.m1.5.5.2.3.2" xref="S3.E10.m1.5.5.2.3.2.cmml">Q</mi><mi id="S3.E10.m1.5.5.2.3.3" xref="S3.E10.m1.5.5.2.3.3.cmml">f</mi></msub><mo id="S3.E10.m1.5.5.2.2" xref="S3.E10.m1.5.5.2.2.cmml">⁢</mo><mrow id="S3.E10.m1.5.5.2.1.1" xref="S3.E10.m1.5.5.2.1.1.1.cmml"><mo id="S3.E10.m1.5.5.2.1.1.2" stretchy="false" xref="S3.E10.m1.5.5.2.1.1.1.cmml">(</mo><msub id="S3.E10.m1.5.5.2.1.1.1" xref="S3.E10.m1.5.5.2.1.1.1.cmml"><mi id="S3.E10.m1.5.5.2.1.1.1.2" xref="S3.E10.m1.5.5.2.1.1.1.2.cmml">X</mi><mi id="S3.E10.m1.5.5.2.1.1.1.3" xref="S3.E10.m1.5.5.2.1.1.1.3.cmml">L</mi></msub><mo id="S3.E10.m1.5.5.2.1.1.3" stretchy="false" xref="S3.E10.m1.5.5.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow><mo id="S3.E10.m1.10.10.1.1.2.1" xref="S3.E10.m1.10.10.1.1.2.1.cmml">+</mo><mfrac id="S3.E10.m1.7.7" xref="S3.E10.m1.7.7.cmml"><mrow id="S3.E10.m1.6.6.1" xref="S3.E10.m1.6.6.1.cmml"><msup id="S3.E10.m1.6.6.1.3" xref="S3.E10.m1.6.6.1.3.cmml"><mi id="S3.E10.m1.6.6.1.3.2" xref="S3.E10.m1.6.6.1.3.2.cmml">P</mi><mn id="S3.E10.m1.6.6.1.3.3" xref="S3.E10.m1.6.6.1.3.3.cmml">2</mn></msup><mo id="S3.E10.m1.6.6.1.2" xref="S3.E10.m1.6.6.1.2.cmml">⁢</mo><mrow id="S3.E10.m1.6.6.1.1.1" xref="S3.E10.m1.6.6.1.1.1.1.cmml"><mo id="S3.E10.m1.6.6.1.1.1.2" stretchy="false" xref="S3.E10.m1.6.6.1.1.1.1.cmml">(</mo><msub id="S3.E10.m1.6.6.1.1.1.1" xref="S3.E10.m1.6.6.1.1.1.1.cmml"><mi id="S3.E10.m1.6.6.1.1.1.1.2" xref="S3.E10.m1.6.6.1.1.1.1.2.cmml">X</mi><mi id="S3.E10.m1.6.6.1.1.1.1.3" xref="S3.E10.m1.6.6.1.1.1.1.3.cmml">R</mi></msub><mo id="S3.E10.m1.6.6.1.1.1.3" stretchy="false" xref="S3.E10.m1.6.6.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E10.m1.7.7.2" xref="S3.E10.m1.7.7.2.cmml"><msub id="S3.E10.m1.7.7.2.3" xref="S3.E10.m1.7.7.2.3.cmml"><mi id="S3.E10.m1.7.7.2.3.2" xref="S3.E10.m1.7.7.2.3.2.cmml">Q</mi><mi id="S3.E10.m1.7.7.2.3.3" xref="S3.E10.m1.7.7.2.3.3.cmml">f</mi></msub><mo id="S3.E10.m1.7.7.2.2" xref="S3.E10.m1.7.7.2.2.cmml">⁢</mo><mrow id="S3.E10.m1.7.7.2.1.1" xref="S3.E10.m1.7.7.2.1.1.1.cmml"><mo id="S3.E10.m1.7.7.2.1.1.2" stretchy="false" xref="S3.E10.m1.7.7.2.1.1.1.cmml">(</mo><msub id="S3.E10.m1.7.7.2.1.1.1" xref="S3.E10.m1.7.7.2.1.1.1.cmml"><mi id="S3.E10.m1.7.7.2.1.1.1.2" xref="S3.E10.m1.7.7.2.1.1.1.2.cmml">X</mi><mi id="S3.E10.m1.7.7.2.1.1.1.3" xref="S3.E10.m1.7.7.2.1.1.1.3.cmml">R</mi></msub><mo id="S3.E10.m1.7.7.2.1.1.3" stretchy="false" xref="S3.E10.m1.7.7.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow><mo id="S3.E10.m1.10.10.1.1.1" xref="S3.E10.m1.10.10.1.1.1.cmml">−</mo><mfrac id="S3.E10.m1.9.9" xref="S3.E10.m1.9.9.cmml"><mrow id="S3.E10.m1.8.8.1" xref="S3.E10.m1.8.8.1.cmml"><msup id="S3.E10.m1.8.8.1.3" xref="S3.E10.m1.8.8.1.3.cmml"><mi id="S3.E10.m1.8.8.1.3.2" xref="S3.E10.m1.8.8.1.3.2.cmml">P</mi><mn id="S3.E10.m1.8.8.1.3.3" xref="S3.E10.m1.8.8.1.3.3.cmml">2</mn></msup><mo id="S3.E10.m1.8.8.1.2" xref="S3.E10.m1.8.8.1.2.cmml">⁢</mo><mrow id="S3.E10.m1.8.8.1.1.1" xref="S3.E10.m1.8.8.1.1.1.1.cmml"><mo id="S3.E10.m1.8.8.1.1.1.2" stretchy="false" xref="S3.E10.m1.8.8.1.1.1.1.cmml">(</mo><msub id="S3.E10.m1.8.8.1.1.1.1" xref="S3.E10.m1.8.8.1.1.1.1.cmml"><mi id="S3.E10.m1.8.8.1.1.1.1.2" xref="S3.E10.m1.8.8.1.1.1.1.2.cmml">X</mi><mi id="S3.E10.m1.8.8.1.1.1.1.3" xref="S3.E10.m1.8.8.1.1.1.1.3.cmml">P</mi></msub><mo id="S3.E10.m1.8.8.1.1.1.3" stretchy="false" xref="S3.E10.m1.8.8.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E10.m1.9.9.2" xref="S3.E10.m1.9.9.2.cmml"><msub id="S3.E10.m1.9.9.2.3" xref="S3.E10.m1.9.9.2.3.cmml"><mi id="S3.E10.m1.9.9.2.3.2" xref="S3.E10.m1.9.9.2.3.2.cmml">Q</mi><mi id="S3.E10.m1.9.9.2.3.3" xref="S3.E10.m1.9.9.2.3.3.cmml">f</mi></msub><mo id="S3.E10.m1.9.9.2.2" xref="S3.E10.m1.9.9.2.2.cmml">⁢</mo><mrow id="S3.E10.m1.9.9.2.1.1" xref="S3.E10.m1.9.9.2.1.1.1.cmml"><mo id="S3.E10.m1.9.9.2.1.1.2" stretchy="false" xref="S3.E10.m1.9.9.2.1.1.1.cmml">(</mo><msub id="S3.E10.m1.9.9.2.1.1.1" xref="S3.E10.m1.9.9.2.1.1.1.cmml"><mi id="S3.E10.m1.9.9.2.1.1.1.2" xref="S3.E10.m1.9.9.2.1.1.1.2.cmml">X</mi><mi id="S3.E10.m1.9.9.2.1.1.1.3" xref="S3.E10.m1.9.9.2.1.1.1.3.cmml">P</mi></msub><mo id="S3.E10.m1.9.9.2.1.1.3" stretchy="false" xref="S3.E10.m1.9.9.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow><mo id="S3.E10.m1.10.10.1.2" lspace="0.170em" xref="S3.E10.m1.10.10.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.10b"><apply id="S3.E10.m1.10.10.1.1.cmml" xref="S3.E10.m1.10.10.1"><minus id="S3.E10.m1.10.10.1.1.1.cmml" xref="S3.E10.m1.10.10.1.1.1"></minus><apply id="S3.E10.m1.10.10.1.1.2.cmml" xref="S3.E10.m1.10.10.1.1.2"><plus id="S3.E10.m1.10.10.1.1.2.1.cmml" xref="S3.E10.m1.10.10.1.1.2.1"></plus><apply id="S3.E10.m1.10.10.1.1.2.2.cmml" xref="S3.E10.m1.10.10.1.1.2.2"><apply id="S3.E10.m1.10.10.1.1.2.2.1.cmml" xref="S3.E10.m1.10.10.1.1.2.2.1"><csymbol cd="ambiguous" id="S3.E10.m1.10.10.1.1.2.2.1.1.cmml" xref="S3.E10.m1.10.10.1.1.2.2.1">subscript</csymbol><max id="S3.E10.m1.10.10.1.1.2.2.1.2.cmml" xref="S3.E10.m1.10.10.1.1.2.2.1.2"></max><apply id="S3.E10.m1.3.3.3.cmml" xref="S3.E10.m1.3.3.3"><in id="S3.E10.m1.3.3.3.4.cmml" xref="S3.E10.m1.3.3.3.4"></in><list id="S3.E10.m1.2.2.2.2.3.cmml" xref="S3.E10.m1.2.2.2.2.2"><apply id="S3.E10.m1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.1.1.2">𝑋</ci><ci id="S3.E10.m1.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.1.1.3">𝐿</ci></apply><apply id="S3.E10.m1.2.2.2.2.2.2.cmml" xref="S3.E10.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.2.2.2.2.1.cmml" xref="S3.E10.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E10.m1.2.2.2.2.2.2.2.cmml" xref="S3.E10.m1.2.2.2.2.2.2.2">𝑋</ci><ci id="S3.E10.m1.2.2.2.2.2.2.3.cmml" xref="S3.E10.m1.2.2.2.2.2.2.3">𝑅</ci></apply></list><apply id="S3.E10.m1.3.3.3.3.cmml" xref="S3.E10.m1.3.3.3.3"><times id="S3.E10.m1.3.3.3.3.2.cmml" xref="S3.E10.m1.3.3.3.3.2"></times><ci id="S3.E10.m1.3.3.3.3.3.cmml" xref="S3.E10.m1.3.3.3.3.3">𝒫</ci><apply id="S3.E10.m1.3.3.3.3.1.1.1.cmml" xref="S3.E10.m1.3.3.3.3.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.3.3.3.3.1.1.1.1.cmml" xref="S3.E10.m1.3.3.3.3.1.1">subscript</csymbol><ci id="S3.E10.m1.3.3.3.3.1.1.1.2.cmml" xref="S3.E10.m1.3.3.3.3.1.1.1.2">𝑋</ci><ci id="S3.E10.m1.3.3.3.3.1.1.1.3.cmml" xref="S3.E10.m1.3.3.3.3.1.1.1.3">𝑃</ci></apply></apply></apply></apply><apply id="S3.E10.m1.5.5.cmml" xref="S3.E10.m1.5.5"><divide id="S3.E10.m1.5.5.3.cmml" xref="S3.E10.m1.5.5"></divide><apply id="S3.E10.m1.4.4.1.cmml" xref="S3.E10.m1.4.4.1"><times id="S3.E10.m1.4.4.1.2.cmml" xref="S3.E10.m1.4.4.1.2"></times><apply id="S3.E10.m1.4.4.1.3.cmml" xref="S3.E10.m1.4.4.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.4.4.1.3.1.cmml" xref="S3.E10.m1.4.4.1.3">superscript</csymbol><ci id="S3.E10.m1.4.4.1.3.2.cmml" xref="S3.E10.m1.4.4.1.3.2">𝑃</ci><cn id="S3.E10.m1.4.4.1.3.3.cmml" type="integer" xref="S3.E10.m1.4.4.1.3.3">2</cn></apply><apply id="S3.E10.m1.4.4.1.1.1.1.cmml" xref="S3.E10.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.4.4.1.1.1.1.1.cmml" xref="S3.E10.m1.4.4.1.1.1">subscript</csymbol><ci id="S3.E10.m1.4.4.1.1.1.1.2.cmml" xref="S3.E10.m1.4.4.1.1.1.1.2">𝑋</ci><ci id="S3.E10.m1.4.4.1.1.1.1.3.cmml" xref="S3.E10.m1.4.4.1.1.1.1.3">𝐿</ci></apply></apply><apply id="S3.E10.m1.5.5.2.cmml" xref="S3.E10.m1.5.5.2"><times id="S3.E10.m1.5.5.2.2.cmml" xref="S3.E10.m1.5.5.2.2"></times><apply id="S3.E10.m1.5.5.2.3.cmml" xref="S3.E10.m1.5.5.2.3"><csymbol cd="ambiguous" id="S3.E10.m1.5.5.2.3.1.cmml" xref="S3.E10.m1.5.5.2.3">subscript</csymbol><ci id="S3.E10.m1.5.5.2.3.2.cmml" xref="S3.E10.m1.5.5.2.3.2">𝑄</ci><ci id="S3.E10.m1.5.5.2.3.3.cmml" xref="S3.E10.m1.5.5.2.3.3">𝑓</ci></apply><apply id="S3.E10.m1.5.5.2.1.1.1.cmml" xref="S3.E10.m1.5.5.2.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.5.5.2.1.1.1.1.cmml" xref="S3.E10.m1.5.5.2.1.1">subscript</csymbol><ci id="S3.E10.m1.5.5.2.1.1.1.2.cmml" xref="S3.E10.m1.5.5.2.1.1.1.2">𝑋</ci><ci id="S3.E10.m1.5.5.2.1.1.1.3.cmml" xref="S3.E10.m1.5.5.2.1.1.1.3">𝐿</ci></apply></apply></apply></apply><apply id="S3.E10.m1.7.7.cmml" xref="S3.E10.m1.7.7"><divide id="S3.E10.m1.7.7.3.cmml" xref="S3.E10.m1.7.7"></divide><apply id="S3.E10.m1.6.6.1.cmml" xref="S3.E10.m1.6.6.1"><times id="S3.E10.m1.6.6.1.2.cmml" xref="S3.E10.m1.6.6.1.2"></times><apply id="S3.E10.m1.6.6.1.3.cmml" xref="S3.E10.m1.6.6.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.6.6.1.3.1.cmml" xref="S3.E10.m1.6.6.1.3">superscript</csymbol><ci id="S3.E10.m1.6.6.1.3.2.cmml" xref="S3.E10.m1.6.6.1.3.2">𝑃</ci><cn id="S3.E10.m1.6.6.1.3.3.cmml" type="integer" xref="S3.E10.m1.6.6.1.3.3">2</cn></apply><apply id="S3.E10.m1.6.6.1.1.1.1.cmml" xref="S3.E10.m1.6.6.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.6.6.1.1.1.1.1.cmml" xref="S3.E10.m1.6.6.1.1.1">subscript</csymbol><ci id="S3.E10.m1.6.6.1.1.1.1.2.cmml" xref="S3.E10.m1.6.6.1.1.1.1.2">𝑋</ci><ci id="S3.E10.m1.6.6.1.1.1.1.3.cmml" xref="S3.E10.m1.6.6.1.1.1.1.3">𝑅</ci></apply></apply><apply id="S3.E10.m1.7.7.2.cmml" xref="S3.E10.m1.7.7.2"><times id="S3.E10.m1.7.7.2.2.cmml" xref="S3.E10.m1.7.7.2.2"></times><apply id="S3.E10.m1.7.7.2.3.cmml" xref="S3.E10.m1.7.7.2.3"><csymbol cd="ambiguous" id="S3.E10.m1.7.7.2.3.1.cmml" xref="S3.E10.m1.7.7.2.3">subscript</csymbol><ci id="S3.E10.m1.7.7.2.3.2.cmml" xref="S3.E10.m1.7.7.2.3.2">𝑄</ci><ci id="S3.E10.m1.7.7.2.3.3.cmml" xref="S3.E10.m1.7.7.2.3.3">𝑓</ci></apply><apply id="S3.E10.m1.7.7.2.1.1.1.cmml" xref="S3.E10.m1.7.7.2.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.7.7.2.1.1.1.1.cmml" xref="S3.E10.m1.7.7.2.1.1">subscript</csymbol><ci id="S3.E10.m1.7.7.2.1.1.1.2.cmml" xref="S3.E10.m1.7.7.2.1.1.1.2">𝑋</ci><ci id="S3.E10.m1.7.7.2.1.1.1.3.cmml" xref="S3.E10.m1.7.7.2.1.1.1.3">𝑅</ci></apply></apply></apply></apply><apply id="S3.E10.m1.9.9.cmml" xref="S3.E10.m1.9.9"><divide id="S3.E10.m1.9.9.3.cmml" xref="S3.E10.m1.9.9"></divide><apply id="S3.E10.m1.8.8.1.cmml" xref="S3.E10.m1.8.8.1"><times id="S3.E10.m1.8.8.1.2.cmml" xref="S3.E10.m1.8.8.1.2"></times><apply id="S3.E10.m1.8.8.1.3.cmml" xref="S3.E10.m1.8.8.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.8.8.1.3.1.cmml" xref="S3.E10.m1.8.8.1.3">superscript</csymbol><ci id="S3.E10.m1.8.8.1.3.2.cmml" xref="S3.E10.m1.8.8.1.3.2">𝑃</ci><cn id="S3.E10.m1.8.8.1.3.3.cmml" type="integer" xref="S3.E10.m1.8.8.1.3.3">2</cn></apply><apply id="S3.E10.m1.8.8.1.1.1.1.cmml" xref="S3.E10.m1.8.8.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.8.8.1.1.1.1.1.cmml" xref="S3.E10.m1.8.8.1.1.1">subscript</csymbol><ci id="S3.E10.m1.8.8.1.1.1.1.2.cmml" xref="S3.E10.m1.8.8.1.1.1.1.2">𝑋</ci><ci id="S3.E10.m1.8.8.1.1.1.1.3.cmml" xref="S3.E10.m1.8.8.1.1.1.1.3">𝑃</ci></apply></apply><apply id="S3.E10.m1.9.9.2.cmml" xref="S3.E10.m1.9.9.2"><times id="S3.E10.m1.9.9.2.2.cmml" xref="S3.E10.m1.9.9.2.2"></times><apply id="S3.E10.m1.9.9.2.3.cmml" xref="S3.E10.m1.9.9.2.3"><csymbol cd="ambiguous" id="S3.E10.m1.9.9.2.3.1.cmml" xref="S3.E10.m1.9.9.2.3">subscript</csymbol><ci id="S3.E10.m1.9.9.2.3.2.cmml" xref="S3.E10.m1.9.9.2.3.2">𝑄</ci><ci id="S3.E10.m1.9.9.2.3.3.cmml" xref="S3.E10.m1.9.9.2.3.3">𝑓</ci></apply><apply id="S3.E10.m1.9.9.2.1.1.1.cmml" xref="S3.E10.m1.9.9.2.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.9.9.2.1.1.1.1.cmml" xref="S3.E10.m1.9.9.2.1.1">subscript</csymbol><ci id="S3.E10.m1.9.9.2.1.1.1.2.cmml" xref="S3.E10.m1.9.9.2.1.1.1.2">𝑋</ci><ci id="S3.E10.m1.9.9.2.1.1.1.3.cmml" xref="S3.E10.m1.9.9.2.1.1.1.3">𝑃</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.10c">\max_{X_{L},X_{R}\in\mathcal{P}\left(X_{P}\right)}\frac{P^{2}(X_{L})}{Q_{f}(X_%
{L})}+\frac{P^{2}(X_{R})}{Q_{f}(X_{R})}-\frac{P^{2}(X_{P})}{Q_{f}(X_{P})}\,.</annotation><annotation encoding="application/x-llamapun" id="S3.E10.m1.10d">roman_max start_POSTSUBSCRIPT italic_X start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT , italic_X start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ∈ caligraphic_P ( italic_X start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT divide start_ARG italic_P start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ( italic_X start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT ) end_ARG start_ARG italic_Q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT ( italic_X start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT ) end_ARG + divide start_ARG italic_P start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ( italic_X start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ) end_ARG start_ARG italic_Q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT ( italic_X start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ) end_ARG - divide start_ARG italic_P start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ( italic_X start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT ) end_ARG start_ARG italic_Q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT ( italic_X start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT ) end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.1">Note that, when using parametric weak learners, computing a second order step would typically involve solving a linear system with a full Hessian.
As we can see, this is not the case when the weak learners are decision trees, where the optimal
value to assign to a leaf <math alttext="j" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.1"><semantics id="S3.SS1.p3.1.m1.1a"><mi id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><ci id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">j</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.1d">italic_j</annotation></semantics></math> does not depend on any information from other leaves and, likewise, the optimal objective value is a sum
of terms, each depending only on information from a single leaf.
This would have not been the case had we tried to optimize the likelihood functional in Equation <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S2.E3" title="In 2 Energy Based Models ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">3</span></a> directly instead of its quadratic approximation.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Amortized Sampling</h3>
<div class="ltx_para ltx_noindent" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.7">To compute the leaf values in equation <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S3.E9" title="In 3.1 Weak Learners ‣ 3 NRGBoost ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">9</span></a> and the splitting criterion in equation <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S3.E10" title="In 3.1 Weak Learners ‣ 3 NRGBoost ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">10</span></a> we would have to know <math alttext="P(X)" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><mrow id="S3.SS2.p1.1.m1.1.2" xref="S3.SS2.p1.1.m1.1.2.cmml"><mi id="S3.SS2.p1.1.m1.1.2.2" xref="S3.SS2.p1.1.m1.1.2.2.cmml">P</mi><mo id="S3.SS2.p1.1.m1.1.2.1" xref="S3.SS2.p1.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.p1.1.m1.1.2.3.2" xref="S3.SS2.p1.1.m1.1.2.cmml"><mo id="S3.SS2.p1.1.m1.1.2.3.2.1" stretchy="false" xref="S3.SS2.p1.1.m1.1.2.cmml">(</mo><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">X</mi><mo id="S3.SS2.p1.1.m1.1.2.3.2.2" stretchy="false" xref="S3.SS2.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.2"><times id="S3.SS2.p1.1.m1.1.2.1.cmml" xref="S3.SS2.p1.1.m1.1.2.1"></times><ci id="S3.SS2.p1.1.m1.1.2.2.cmml" xref="S3.SS2.p1.1.m1.1.2.2">𝑃</ci><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">P(X)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">italic_P ( italic_X )</annotation></semantics></math> and be able
to compute <math alttext="Q_{f}(X)" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><mrow id="S3.SS2.p1.2.m2.1.2" xref="S3.SS2.p1.2.m2.1.2.cmml"><msub id="S3.SS2.p1.2.m2.1.2.2" xref="S3.SS2.p1.2.m2.1.2.2.cmml"><mi id="S3.SS2.p1.2.m2.1.2.2.2" xref="S3.SS2.p1.2.m2.1.2.2.2.cmml">Q</mi><mi id="S3.SS2.p1.2.m2.1.2.2.3" xref="S3.SS2.p1.2.m2.1.2.2.3.cmml">f</mi></msub><mo id="S3.SS2.p1.2.m2.1.2.1" xref="S3.SS2.p1.2.m2.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.p1.2.m2.1.2.3.2" xref="S3.SS2.p1.2.m2.1.2.cmml"><mo id="S3.SS2.p1.2.m2.1.2.3.2.1" stretchy="false" xref="S3.SS2.p1.2.m2.1.2.cmml">(</mo><mi id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">X</mi><mo id="S3.SS2.p1.2.m2.1.2.3.2.2" stretchy="false" xref="S3.SS2.p1.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.2.cmml" xref="S3.SS2.p1.2.m2.1.2"><times id="S3.SS2.p1.2.m2.1.2.1.cmml" xref="S3.SS2.p1.2.m2.1.2.1"></times><apply id="S3.SS2.p1.2.m2.1.2.2.cmml" xref="S3.SS2.p1.2.m2.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.2.2.1.cmml" xref="S3.SS2.p1.2.m2.1.2.2">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.2.2.2.cmml" xref="S3.SS2.p1.2.m2.1.2.2.2">𝑄</ci><ci id="S3.SS2.p1.2.m2.1.2.2.3.cmml" xref="S3.SS2.p1.2.m2.1.2.2.3">𝑓</ci></apply><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">Q_{f}(X)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">italic_Q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT ( italic_X )</annotation></semantics></math> which is infeasible due to the untractable normalization constant.
We therefore estimate these quantities, with recourse to empirical data for <math alttext="P(X)" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><mrow id="S3.SS2.p1.3.m3.1.2" xref="S3.SS2.p1.3.m3.1.2.cmml"><mi id="S3.SS2.p1.3.m3.1.2.2" xref="S3.SS2.p1.3.m3.1.2.2.cmml">P</mi><mo id="S3.SS2.p1.3.m3.1.2.1" xref="S3.SS2.p1.3.m3.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.p1.3.m3.1.2.3.2" xref="S3.SS2.p1.3.m3.1.2.cmml"><mo id="S3.SS2.p1.3.m3.1.2.3.2.1" stretchy="false" xref="S3.SS2.p1.3.m3.1.2.cmml">(</mo><mi id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">X</mi><mo id="S3.SS2.p1.3.m3.1.2.3.2.2" stretchy="false" xref="S3.SS2.p1.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.2.cmml" xref="S3.SS2.p1.3.m3.1.2"><times id="S3.SS2.p1.3.m3.1.2.1.cmml" xref="S3.SS2.p1.3.m3.1.2.1"></times><ci id="S3.SS2.p1.3.m3.1.2.2.cmml" xref="S3.SS2.p1.3.m3.1.2.2">𝑃</ci><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">P(X)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">italic_P ( italic_X )</annotation></semantics></math>, and to samples approximately drawn from the model with MCMC.
Because even if the input space is not partially discrete, <math alttext="f" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m4.1"><semantics id="S3.SS2.p1.4.m4.1a"><mi id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><ci id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">f</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m4.1d">italic_f</annotation></semantics></math> is still discontinuous and constant almost everywhere
we can’t use gradient based samplers and therefore rely on Gibbs sampling instead.
This only requires evaluating each <math alttext="f_{t}" class="ltx_Math" display="inline" id="S3.SS2.p1.5.m5.1"><semantics id="S3.SS2.p1.5.m5.1a"><msub id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml"><mi id="S3.SS2.p1.5.m5.1.1.2" xref="S3.SS2.p1.5.m5.1.1.2.cmml">f</mi><mi id="S3.SS2.p1.5.m5.1.1.3" xref="S3.SS2.p1.5.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><apply id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p1.5.m5.1.1.2.cmml" xref="S3.SS2.p1.5.m5.1.1.2">𝑓</ci><ci id="S3.SS2.p1.5.m5.1.1.3.cmml" xref="S3.SS2.p1.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">f_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.5.m5.1d">italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> along one dimension at a time, while keeping all others fixed which can be computed efficiently for a tree by traversing it only once.
However, since at boosting iteration <math alttext="t" class="ltx_Math" display="inline" id="S3.SS2.p1.6.m6.1"><semantics id="S3.SS2.p1.6.m6.1a"><mi id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><ci id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.6.m6.1d">italic_t</annotation></semantics></math> our energy function is a sum of <math alttext="t" class="ltx_Math" display="inline" id="S3.SS2.p1.7.m7.1"><semantics id="S3.SS2.p1.7.m7.1a"><mi id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><ci id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.7.m7.1d">italic_t</annotation></semantics></math> trees, this computation scales linearly with the iteration number. This makes the overall time spent sampling quadratic in the number of boosting iterations and thus
precluding us from training models with a large number of trees.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.6">In order to reduce the burden associated with this sampling, which dominates the runtime of training the model, we propose a new sampling approach that leverages the cumulative nature of boosting.
The intuition behind this approach is that the set of samples used in the previous boosting round are (approximately) drawn from a distribution that is already close to the new model distribution.
It could therefore be helpful to keep some of those samples, especially those that conform the best to the new model.
Rejection sampling allows us to do just that.
The boosting update in terms of the densities takes the following multiplicative form:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="q_{t}(\mathbf{x})=k_{t}\,q_{t-1}(\mathbf{x})\exp\left(\alpha_{t}\delta f_{t}(%
\mathbf{x})\right)\,." class="ltx_Math" display="block" id="S3.E11.m1.5"><semantics id="S3.E11.m1.5a"><mrow id="S3.E11.m1.5.5.1" xref="S3.E11.m1.5.5.1.1.cmml"><mrow id="S3.E11.m1.5.5.1.1" xref="S3.E11.m1.5.5.1.1.cmml"><mrow id="S3.E11.m1.5.5.1.1.3" xref="S3.E11.m1.5.5.1.1.3.cmml"><msub id="S3.E11.m1.5.5.1.1.3.2" xref="S3.E11.m1.5.5.1.1.3.2.cmml"><mi id="S3.E11.m1.5.5.1.1.3.2.2" xref="S3.E11.m1.5.5.1.1.3.2.2.cmml">q</mi><mi id="S3.E11.m1.5.5.1.1.3.2.3" xref="S3.E11.m1.5.5.1.1.3.2.3.cmml">t</mi></msub><mo id="S3.E11.m1.5.5.1.1.3.1" xref="S3.E11.m1.5.5.1.1.3.1.cmml">⁢</mo><mrow id="S3.E11.m1.5.5.1.1.3.3.2" xref="S3.E11.m1.5.5.1.1.3.cmml"><mo id="S3.E11.m1.5.5.1.1.3.3.2.1" stretchy="false" xref="S3.E11.m1.5.5.1.1.3.cmml">(</mo><mi id="S3.E11.m1.1.1" xref="S3.E11.m1.1.1.cmml">𝐱</mi><mo id="S3.E11.m1.5.5.1.1.3.3.2.2" stretchy="false" xref="S3.E11.m1.5.5.1.1.3.cmml">)</mo></mrow></mrow><mo id="S3.E11.m1.5.5.1.1.2" xref="S3.E11.m1.5.5.1.1.2.cmml">=</mo><mrow id="S3.E11.m1.5.5.1.1.1" xref="S3.E11.m1.5.5.1.1.1.cmml"><msub id="S3.E11.m1.5.5.1.1.1.3" xref="S3.E11.m1.5.5.1.1.1.3.cmml"><mi id="S3.E11.m1.5.5.1.1.1.3.2" xref="S3.E11.m1.5.5.1.1.1.3.2.cmml">k</mi><mi id="S3.E11.m1.5.5.1.1.1.3.3" xref="S3.E11.m1.5.5.1.1.1.3.3.cmml">t</mi></msub><mo id="S3.E11.m1.5.5.1.1.1.2" xref="S3.E11.m1.5.5.1.1.1.2.cmml">⁢</mo><msub id="S3.E11.m1.5.5.1.1.1.4" xref="S3.E11.m1.5.5.1.1.1.4.cmml"><mi id="S3.E11.m1.5.5.1.1.1.4.2" xref="S3.E11.m1.5.5.1.1.1.4.2.cmml">q</mi><mrow id="S3.E11.m1.5.5.1.1.1.4.3" xref="S3.E11.m1.5.5.1.1.1.4.3.cmml"><mi id="S3.E11.m1.5.5.1.1.1.4.3.2" xref="S3.E11.m1.5.5.1.1.1.4.3.2.cmml">t</mi><mo id="S3.E11.m1.5.5.1.1.1.4.3.1" xref="S3.E11.m1.5.5.1.1.1.4.3.1.cmml">−</mo><mn id="S3.E11.m1.5.5.1.1.1.4.3.3" xref="S3.E11.m1.5.5.1.1.1.4.3.3.cmml">1</mn></mrow></msub><mo id="S3.E11.m1.5.5.1.1.1.2a" xref="S3.E11.m1.5.5.1.1.1.2.cmml">⁢</mo><mrow id="S3.E11.m1.5.5.1.1.1.5.2" xref="S3.E11.m1.5.5.1.1.1.cmml"><mo id="S3.E11.m1.5.5.1.1.1.5.2.1" stretchy="false" xref="S3.E11.m1.5.5.1.1.1.cmml">(</mo><mi id="S3.E11.m1.2.2" xref="S3.E11.m1.2.2.cmml">𝐱</mi><mo id="S3.E11.m1.5.5.1.1.1.5.2.2" stretchy="false" xref="S3.E11.m1.5.5.1.1.1.cmml">)</mo></mrow><mo id="S3.E11.m1.5.5.1.1.1.2b" lspace="0.167em" xref="S3.E11.m1.5.5.1.1.1.2.cmml">⁢</mo><mrow id="S3.E11.m1.5.5.1.1.1.1.1" xref="S3.E11.m1.5.5.1.1.1.1.2.cmml"><mi id="S3.E11.m1.4.4" xref="S3.E11.m1.4.4.cmml">exp</mi><mo id="S3.E11.m1.5.5.1.1.1.1.1a" xref="S3.E11.m1.5.5.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.E11.m1.5.5.1.1.1.1.1.1" xref="S3.E11.m1.5.5.1.1.1.1.2.cmml"><mo id="S3.E11.m1.5.5.1.1.1.1.1.1.2" xref="S3.E11.m1.5.5.1.1.1.1.2.cmml">(</mo><mrow id="S3.E11.m1.5.5.1.1.1.1.1.1.1" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.cmml"><msub id="S3.E11.m1.5.5.1.1.1.1.1.1.1.2" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E11.m1.5.5.1.1.1.1.1.1.1.2.2" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.2.2.cmml">α</mi><mi id="S3.E11.m1.5.5.1.1.1.1.1.1.1.2.3" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo id="S3.E11.m1.5.5.1.1.1.1.1.1.1.1" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E11.m1.5.5.1.1.1.1.1.1.1.3" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.3.cmml">δ</mi><mo id="S3.E11.m1.5.5.1.1.1.1.1.1.1.1a" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S3.E11.m1.5.5.1.1.1.1.1.1.1.4" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.4.cmml"><mi id="S3.E11.m1.5.5.1.1.1.1.1.1.1.4.2" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.4.2.cmml">f</mi><mi id="S3.E11.m1.5.5.1.1.1.1.1.1.1.4.3" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.4.3.cmml">t</mi></msub><mo id="S3.E11.m1.5.5.1.1.1.1.1.1.1.1b" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E11.m1.5.5.1.1.1.1.1.1.1.5.2" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.cmml"><mo id="S3.E11.m1.5.5.1.1.1.1.1.1.1.5.2.1" stretchy="false" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E11.m1.3.3" xref="S3.E11.m1.3.3.cmml">𝐱</mi><mo id="S3.E11.m1.5.5.1.1.1.1.1.1.1.5.2.2" stretchy="false" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E11.m1.5.5.1.1.1.1.1.1.3" xref="S3.E11.m1.5.5.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E11.m1.5.5.1.2" lspace="0.170em" xref="S3.E11.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m1.5b"><apply id="S3.E11.m1.5.5.1.1.cmml" xref="S3.E11.m1.5.5.1"><eq id="S3.E11.m1.5.5.1.1.2.cmml" xref="S3.E11.m1.5.5.1.1.2"></eq><apply id="S3.E11.m1.5.5.1.1.3.cmml" xref="S3.E11.m1.5.5.1.1.3"><times id="S3.E11.m1.5.5.1.1.3.1.cmml" xref="S3.E11.m1.5.5.1.1.3.1"></times><apply id="S3.E11.m1.5.5.1.1.3.2.cmml" xref="S3.E11.m1.5.5.1.1.3.2"><csymbol cd="ambiguous" id="S3.E11.m1.5.5.1.1.3.2.1.cmml" xref="S3.E11.m1.5.5.1.1.3.2">subscript</csymbol><ci id="S3.E11.m1.5.5.1.1.3.2.2.cmml" xref="S3.E11.m1.5.5.1.1.3.2.2">𝑞</ci><ci id="S3.E11.m1.5.5.1.1.3.2.3.cmml" xref="S3.E11.m1.5.5.1.1.3.2.3">𝑡</ci></apply><ci id="S3.E11.m1.1.1.cmml" xref="S3.E11.m1.1.1">𝐱</ci></apply><apply id="S3.E11.m1.5.5.1.1.1.cmml" xref="S3.E11.m1.5.5.1.1.1"><times id="S3.E11.m1.5.5.1.1.1.2.cmml" xref="S3.E11.m1.5.5.1.1.1.2"></times><apply id="S3.E11.m1.5.5.1.1.1.3.cmml" xref="S3.E11.m1.5.5.1.1.1.3"><csymbol cd="ambiguous" id="S3.E11.m1.5.5.1.1.1.3.1.cmml" xref="S3.E11.m1.5.5.1.1.1.3">subscript</csymbol><ci id="S3.E11.m1.5.5.1.1.1.3.2.cmml" xref="S3.E11.m1.5.5.1.1.1.3.2">𝑘</ci><ci id="S3.E11.m1.5.5.1.1.1.3.3.cmml" xref="S3.E11.m1.5.5.1.1.1.3.3">𝑡</ci></apply><apply id="S3.E11.m1.5.5.1.1.1.4.cmml" xref="S3.E11.m1.5.5.1.1.1.4"><csymbol cd="ambiguous" id="S3.E11.m1.5.5.1.1.1.4.1.cmml" xref="S3.E11.m1.5.5.1.1.1.4">subscript</csymbol><ci id="S3.E11.m1.5.5.1.1.1.4.2.cmml" xref="S3.E11.m1.5.5.1.1.1.4.2">𝑞</ci><apply id="S3.E11.m1.5.5.1.1.1.4.3.cmml" xref="S3.E11.m1.5.5.1.1.1.4.3"><minus id="S3.E11.m1.5.5.1.1.1.4.3.1.cmml" xref="S3.E11.m1.5.5.1.1.1.4.3.1"></minus><ci id="S3.E11.m1.5.5.1.1.1.4.3.2.cmml" xref="S3.E11.m1.5.5.1.1.1.4.3.2">𝑡</ci><cn id="S3.E11.m1.5.5.1.1.1.4.3.3.cmml" type="integer" xref="S3.E11.m1.5.5.1.1.1.4.3.3">1</cn></apply></apply><ci id="S3.E11.m1.2.2.cmml" xref="S3.E11.m1.2.2">𝐱</ci><apply id="S3.E11.m1.5.5.1.1.1.1.2.cmml" xref="S3.E11.m1.5.5.1.1.1.1.1"><exp id="S3.E11.m1.4.4.cmml" xref="S3.E11.m1.4.4"></exp><apply id="S3.E11.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1"><times id="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.1"></times><apply id="S3.E11.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E11.m1.5.5.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E11.m1.5.5.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.2.2">𝛼</ci><ci id="S3.E11.m1.5.5.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S3.E11.m1.5.5.1.1.1.1.1.1.1.3.cmml" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.3">𝛿</ci><apply id="S3.E11.m1.5.5.1.1.1.1.1.1.1.4.cmml" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E11.m1.5.5.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E11.m1.5.5.1.1.1.1.1.1.1.4.2.cmml" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.4.2">𝑓</ci><ci id="S3.E11.m1.5.5.1.1.1.1.1.1.1.4.3.cmml" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.4.3">𝑡</ci></apply><ci id="S3.E11.m1.3.3.cmml" xref="S3.E11.m1.3.3">𝐱</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m1.5c">q_{t}(\mathbf{x})=k_{t}\,q_{t-1}(\mathbf{x})\exp\left(\alpha_{t}\delta f_{t}(%
\mathbf{x})\right)\,.</annotation><annotation encoding="application/x-llamapun" id="S3.E11.m1.5d">italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_x ) = italic_k start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_q start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT ( bold_x ) roman_exp ( italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_δ italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_x ) ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p2.4">Here, <math alttext="k_{t}" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1"><semantics id="S3.SS2.p2.1.m1.1a"><msub id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">k</mi><mi id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">𝑘</ci><ci id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">k_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.1d">italic_k start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is an unknown multiplicative constant and since <math alttext="\delta f_{t}" class="ltx_Math" display="inline" id="S3.SS2.p2.2.m2.1"><semantics id="S3.SS2.p2.2.m2.1a"><mrow id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><mi id="S3.SS2.p2.2.m2.1.1.2" xref="S3.SS2.p2.2.m2.1.1.2.cmml">δ</mi><mo id="S3.SS2.p2.2.m2.1.1.1" xref="S3.SS2.p2.2.m2.1.1.1.cmml">⁢</mo><msub id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml"><mi id="S3.SS2.p2.2.m2.1.1.3.2" xref="S3.SS2.p2.2.m2.1.1.3.2.cmml">f</mi><mi id="S3.SS2.p2.2.m2.1.1.3.3" xref="S3.SS2.p2.2.m2.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><times id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1.1"></times><ci id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2">𝛿</ci><apply id="S3.SS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.3.1.cmml" xref="S3.SS2.p2.2.m2.1.1.3">subscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.3.2.cmml" xref="S3.SS2.p2.2.m2.1.1.3.2">𝑓</ci><ci id="S3.SS2.p2.2.m2.1.1.3.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">\delta f_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.2.m2.1d">italic_δ italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is given by a tree, we can easily bound the exponential factor by finding the leaf with the largest value.
We can therefore use the previous model, <math alttext="q_{t-1}(\mathbf{x})" class="ltx_Math" display="inline" id="S3.SS2.p2.3.m3.1"><semantics id="S3.SS2.p2.3.m3.1a"><mrow id="S3.SS2.p2.3.m3.1.2" xref="S3.SS2.p2.3.m3.1.2.cmml"><msub id="S3.SS2.p2.3.m3.1.2.2" xref="S3.SS2.p2.3.m3.1.2.2.cmml"><mi id="S3.SS2.p2.3.m3.1.2.2.2" xref="S3.SS2.p2.3.m3.1.2.2.2.cmml">q</mi><mrow id="S3.SS2.p2.3.m3.1.2.2.3" xref="S3.SS2.p2.3.m3.1.2.2.3.cmml"><mi id="S3.SS2.p2.3.m3.1.2.2.3.2" xref="S3.SS2.p2.3.m3.1.2.2.3.2.cmml">t</mi><mo id="S3.SS2.p2.3.m3.1.2.2.3.1" xref="S3.SS2.p2.3.m3.1.2.2.3.1.cmml">−</mo><mn id="S3.SS2.p2.3.m3.1.2.2.3.3" xref="S3.SS2.p2.3.m3.1.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS2.p2.3.m3.1.2.1" xref="S3.SS2.p2.3.m3.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.p2.3.m3.1.2.3.2" xref="S3.SS2.p2.3.m3.1.2.cmml"><mo id="S3.SS2.p2.3.m3.1.2.3.2.1" stretchy="false" xref="S3.SS2.p2.3.m3.1.2.cmml">(</mo><mi id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml">𝐱</mi><mo id="S3.SS2.p2.3.m3.1.2.3.2.2" stretchy="false" xref="S3.SS2.p2.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><apply id="S3.SS2.p2.3.m3.1.2.cmml" xref="S3.SS2.p2.3.m3.1.2"><times id="S3.SS2.p2.3.m3.1.2.1.cmml" xref="S3.SS2.p2.3.m3.1.2.1"></times><apply id="S3.SS2.p2.3.m3.1.2.2.cmml" xref="S3.SS2.p2.3.m3.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.2.2.1.cmml" xref="S3.SS2.p2.3.m3.1.2.2">subscript</csymbol><ci id="S3.SS2.p2.3.m3.1.2.2.2.cmml" xref="S3.SS2.p2.3.m3.1.2.2.2">𝑞</ci><apply id="S3.SS2.p2.3.m3.1.2.2.3.cmml" xref="S3.SS2.p2.3.m3.1.2.2.3"><minus id="S3.SS2.p2.3.m3.1.2.2.3.1.cmml" xref="S3.SS2.p2.3.m3.1.2.2.3.1"></minus><ci id="S3.SS2.p2.3.m3.1.2.2.3.2.cmml" xref="S3.SS2.p2.3.m3.1.2.2.3.2">𝑡</ci><cn id="S3.SS2.p2.3.m3.1.2.2.3.3.cmml" type="integer" xref="S3.SS2.p2.3.m3.1.2.2.3.3">1</cn></apply></apply><ci id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">𝐱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">q_{t-1}(\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.3.m3.1d">italic_q start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT ( bold_x )</annotation></semantics></math>, as a proposal distribution
for which we already have a set of samples and keep each sample, <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S3.SS2.p2.4.m4.1"><semantics id="S3.SS2.p2.4.m4.1a"><mi id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><ci id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.4.m4.1d">bold_x</annotation></semantics></math>, with an acceptance probability of:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="p_{accept}(\mathbf{x})=\exp\left[\alpha_{t}\left(\delta f_{t}(\mathbf{x})-\max%
_{\mathbf{x}}\delta f_{t}(\mathbf{x})\right)\right]\,." class="ltx_Math" display="block" id="S3.E12.m1.5"><semantics id="S3.E12.m1.5a"><mrow id="S3.E12.m1.5.5.1" xref="S3.E12.m1.5.5.1.1.cmml"><mrow id="S3.E12.m1.5.5.1.1" xref="S3.E12.m1.5.5.1.1.cmml"><mrow id="S3.E12.m1.5.5.1.1.3" xref="S3.E12.m1.5.5.1.1.3.cmml"><msub id="S3.E12.m1.5.5.1.1.3.2" xref="S3.E12.m1.5.5.1.1.3.2.cmml"><mi id="S3.E12.m1.5.5.1.1.3.2.2" xref="S3.E12.m1.5.5.1.1.3.2.2.cmml">p</mi><mrow id="S3.E12.m1.5.5.1.1.3.2.3" xref="S3.E12.m1.5.5.1.1.3.2.3.cmml"><mi id="S3.E12.m1.5.5.1.1.3.2.3.2" xref="S3.E12.m1.5.5.1.1.3.2.3.2.cmml">a</mi><mo id="S3.E12.m1.5.5.1.1.3.2.3.1" xref="S3.E12.m1.5.5.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E12.m1.5.5.1.1.3.2.3.3" xref="S3.E12.m1.5.5.1.1.3.2.3.3.cmml">c</mi><mo id="S3.E12.m1.5.5.1.1.3.2.3.1a" xref="S3.E12.m1.5.5.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E12.m1.5.5.1.1.3.2.3.4" xref="S3.E12.m1.5.5.1.1.3.2.3.4.cmml">c</mi><mo id="S3.E12.m1.5.5.1.1.3.2.3.1b" xref="S3.E12.m1.5.5.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E12.m1.5.5.1.1.3.2.3.5" xref="S3.E12.m1.5.5.1.1.3.2.3.5.cmml">e</mi><mo id="S3.E12.m1.5.5.1.1.3.2.3.1c" xref="S3.E12.m1.5.5.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E12.m1.5.5.1.1.3.2.3.6" xref="S3.E12.m1.5.5.1.1.3.2.3.6.cmml">p</mi><mo id="S3.E12.m1.5.5.1.1.3.2.3.1d" xref="S3.E12.m1.5.5.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E12.m1.5.5.1.1.3.2.3.7" xref="S3.E12.m1.5.5.1.1.3.2.3.7.cmml">t</mi></mrow></msub><mo id="S3.E12.m1.5.5.1.1.3.1" xref="S3.E12.m1.5.5.1.1.3.1.cmml">⁢</mo><mrow id="S3.E12.m1.5.5.1.1.3.3.2" xref="S3.E12.m1.5.5.1.1.3.cmml"><mo id="S3.E12.m1.5.5.1.1.3.3.2.1" stretchy="false" xref="S3.E12.m1.5.5.1.1.3.cmml">(</mo><mi id="S3.E12.m1.1.1" xref="S3.E12.m1.1.1.cmml">𝐱</mi><mo id="S3.E12.m1.5.5.1.1.3.3.2.2" stretchy="false" xref="S3.E12.m1.5.5.1.1.3.cmml">)</mo></mrow></mrow><mo id="S3.E12.m1.5.5.1.1.2" xref="S3.E12.m1.5.5.1.1.2.cmml">=</mo><mrow id="S3.E12.m1.5.5.1.1.1.1" xref="S3.E12.m1.5.5.1.1.1.2.cmml"><mi id="S3.E12.m1.4.4" xref="S3.E12.m1.4.4.cmml">exp</mi><mo id="S3.E12.m1.5.5.1.1.1.1a" xref="S3.E12.m1.5.5.1.1.1.2.cmml">⁡</mo><mrow id="S3.E12.m1.5.5.1.1.1.1.1" xref="S3.E12.m1.5.5.1.1.1.2.cmml"><mo id="S3.E12.m1.5.5.1.1.1.1.1.2" xref="S3.E12.m1.5.5.1.1.1.2.cmml">[</mo><mrow id="S3.E12.m1.5.5.1.1.1.1.1.1" xref="S3.E12.m1.5.5.1.1.1.1.1.1.cmml"><msub id="S3.E12.m1.5.5.1.1.1.1.1.1.3" xref="S3.E12.m1.5.5.1.1.1.1.1.1.3.cmml"><mi id="S3.E12.m1.5.5.1.1.1.1.1.1.3.2" xref="S3.E12.m1.5.5.1.1.1.1.1.1.3.2.cmml">α</mi><mi id="S3.E12.m1.5.5.1.1.1.1.1.1.3.3" xref="S3.E12.m1.5.5.1.1.1.1.1.1.3.3.cmml">t</mi></msub><mo id="S3.E12.m1.5.5.1.1.1.1.1.1.2" xref="S3.E12.m1.5.5.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.2" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.cmml">δ</mi><mo id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.1" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.2.cmml">f</mi><mi id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.3.cmml">t</mi></msub><mo id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.1a" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.4.2" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.4.2.1" stretchy="false" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E12.m1.2.2" xref="S3.E12.m1.2.2.cmml">𝐱</mi><mo id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.4.2.2" stretchy="false" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml"><mrow id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.cmml"><munder id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.1" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.1.cmml"><mi id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.1.2" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.1.2.cmml">max</mi><mi id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.1.3" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.1.3.cmml">𝐱</mi></munder><mo id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.2a" lspace="0.167em" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.cmml">⁡</mo><mrow id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.2.cmml"><mi id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.2.2" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.2.2.cmml">δ</mi><mo id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.2.1" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.2.1.cmml">⁢</mo><msub id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.2.3" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.2.3.cmml"><mi id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.2.3.2" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.2.3.2.cmml">f</mi><mi id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.2.3.3" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.2.3.3.cmml">t</mi></msub></mrow></mrow><mo id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml"><mo id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.2.1" stretchy="false" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml">(</mo><mi id="S3.E12.m1.3.3" xref="S3.E12.m1.3.3.cmml">𝐱</mi><mo id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.2.2" stretchy="false" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.3" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E12.m1.5.5.1.1.1.1.1.3" xref="S3.E12.m1.5.5.1.1.1.2.cmml">]</mo></mrow></mrow></mrow><mo id="S3.E12.m1.5.5.1.2" lspace="0.170em" xref="S3.E12.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E12.m1.5b"><apply id="S3.E12.m1.5.5.1.1.cmml" xref="S3.E12.m1.5.5.1"><eq id="S3.E12.m1.5.5.1.1.2.cmml" xref="S3.E12.m1.5.5.1.1.2"></eq><apply id="S3.E12.m1.5.5.1.1.3.cmml" xref="S3.E12.m1.5.5.1.1.3"><times id="S3.E12.m1.5.5.1.1.3.1.cmml" xref="S3.E12.m1.5.5.1.1.3.1"></times><apply id="S3.E12.m1.5.5.1.1.3.2.cmml" xref="S3.E12.m1.5.5.1.1.3.2"><csymbol cd="ambiguous" id="S3.E12.m1.5.5.1.1.3.2.1.cmml" xref="S3.E12.m1.5.5.1.1.3.2">subscript</csymbol><ci id="S3.E12.m1.5.5.1.1.3.2.2.cmml" xref="S3.E12.m1.5.5.1.1.3.2.2">𝑝</ci><apply id="S3.E12.m1.5.5.1.1.3.2.3.cmml" xref="S3.E12.m1.5.5.1.1.3.2.3"><times id="S3.E12.m1.5.5.1.1.3.2.3.1.cmml" xref="S3.E12.m1.5.5.1.1.3.2.3.1"></times><ci id="S3.E12.m1.5.5.1.1.3.2.3.2.cmml" xref="S3.E12.m1.5.5.1.1.3.2.3.2">𝑎</ci><ci id="S3.E12.m1.5.5.1.1.3.2.3.3.cmml" xref="S3.E12.m1.5.5.1.1.3.2.3.3">𝑐</ci><ci id="S3.E12.m1.5.5.1.1.3.2.3.4.cmml" xref="S3.E12.m1.5.5.1.1.3.2.3.4">𝑐</ci><ci id="S3.E12.m1.5.5.1.1.3.2.3.5.cmml" xref="S3.E12.m1.5.5.1.1.3.2.3.5">𝑒</ci><ci id="S3.E12.m1.5.5.1.1.3.2.3.6.cmml" xref="S3.E12.m1.5.5.1.1.3.2.3.6">𝑝</ci><ci id="S3.E12.m1.5.5.1.1.3.2.3.7.cmml" xref="S3.E12.m1.5.5.1.1.3.2.3.7">𝑡</ci></apply></apply><ci id="S3.E12.m1.1.1.cmml" xref="S3.E12.m1.1.1">𝐱</ci></apply><apply id="S3.E12.m1.5.5.1.1.1.2.cmml" xref="S3.E12.m1.5.5.1.1.1.1"><exp id="S3.E12.m1.4.4.cmml" xref="S3.E12.m1.4.4"></exp><apply id="S3.E12.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E12.m1.5.5.1.1.1.1.1.1"><times id="S3.E12.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E12.m1.5.5.1.1.1.1.1.1.2"></times><apply id="S3.E12.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S3.E12.m1.5.5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E12.m1.5.5.1.1.1.1.1.1.3.1.cmml" xref="S3.E12.m1.5.5.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E12.m1.5.5.1.1.1.1.1.1.3.2.cmml" xref="S3.E12.m1.5.5.1.1.1.1.1.1.3.2">𝛼</ci><ci id="S3.E12.m1.5.5.1.1.1.1.1.1.3.3.cmml" xref="S3.E12.m1.5.5.1.1.1.1.1.1.3.3">𝑡</ci></apply><apply id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1"><minus id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2"><times id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.1"></times><ci id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.2">𝛿</ci><apply id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.2">𝑓</ci><ci id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.3">𝑡</ci></apply><ci id="S3.E12.m1.2.2.cmml" xref="S3.E12.m1.2.2">𝐱</ci></apply><apply id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3"><times id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.1"></times><apply id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.2"><apply id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.1.1.cmml" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.1">subscript</csymbol><max id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.1.2.cmml" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.1.2"></max><ci id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.1.3.cmml" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.1.3">𝐱</ci></apply><apply id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.2"><times id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.2.1.cmml" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.2.1"></times><ci id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.2.2.cmml" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.2.2">𝛿</ci><apply id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.2.3.cmml" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.2.3"><csymbol cd="ambiguous" id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.2.3.1.cmml" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.2.3">subscript</csymbol><ci id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.2.3.2.cmml" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.2.3.2">𝑓</ci><ci id="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.2.3.3.cmml" xref="S3.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.2.3.3">𝑡</ci></apply></apply></apply><ci id="S3.E12.m1.3.3.cmml" xref="S3.E12.m1.3.3">𝐱</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.m1.5c">p_{accept}(\mathbf{x})=\exp\left[\alpha_{t}\left(\delta f_{t}(\mathbf{x})-\max%
_{\mathbf{x}}\delta f_{t}(\mathbf{x})\right)\right]\,.</annotation><annotation encoding="application/x-llamapun" id="S3.E12.m1.5d">italic_p start_POSTSUBSCRIPT italic_a italic_c italic_c italic_e italic_p italic_t end_POSTSUBSCRIPT ( bold_x ) = roman_exp [ italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( italic_δ italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_x ) - roman_max start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT italic_δ italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_x ) ) ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p2.5">We note that knowledge of the constant <math alttext="k_{t}" class="ltx_Math" display="inline" id="S3.SS2.p2.5.m1.1"><semantics id="S3.SS2.p2.5.m1.1a"><msub id="S3.SS2.p2.5.m1.1.1" xref="S3.SS2.p2.5.m1.1.1.cmml"><mi id="S3.SS2.p2.5.m1.1.1.2" xref="S3.SS2.p2.5.m1.1.1.2.cmml">k</mi><mi id="S3.SS2.p2.5.m1.1.1.3" xref="S3.SS2.p2.5.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m1.1b"><apply id="S3.SS2.p2.5.m1.1.1.cmml" xref="S3.SS2.p2.5.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.5.m1.1.1.1.cmml" xref="S3.SS2.p2.5.m1.1.1">subscript</csymbol><ci id="S3.SS2.p2.5.m1.1.1.2.cmml" xref="S3.SS2.p2.5.m1.1.1.2">𝑘</ci><ci id="S3.SS2.p2.5.m1.1.1.3.cmml" xref="S3.SS2.p2.5.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m1.1c">k_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.5.m1.1d">italic_k start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is not necessary to compute this probability.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.5">Our proposed sampling strategy is to maintain a fixed size pool of approximate samples from the model. At the end of each boosting round, we use rejection sampling to remove samples from the pool
and draw new samples from the model using Gibbs sampling.
Note that <math alttext="q_{0}" class="ltx_Math" display="inline" id="S3.SS2.p3.1.m1.1"><semantics id="S3.SS2.p3.1.m1.1a"><msub id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml"><mi id="S3.SS2.p3.1.m1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.2.cmml">q</mi><mn id="S3.SS2.p3.1.m1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><apply id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.1.2">𝑞</ci><cn id="S3.SS2.p3.1.m1.1.1.3.cmml" type="integer" xref="S3.SS2.p3.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">q_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.1.m1.1d">italic_q start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> is typically a simple model for which we can both directly evaluate the desired quantities (i.e., <math alttext="Q_{0}(X)" class="ltx_Math" display="inline" id="S3.SS2.p3.2.m2.1"><semantics id="S3.SS2.p3.2.m2.1a"><mrow id="S3.SS2.p3.2.m2.1.2" xref="S3.SS2.p3.2.m2.1.2.cmml"><msub id="S3.SS2.p3.2.m2.1.2.2" xref="S3.SS2.p3.2.m2.1.2.2.cmml"><mi id="S3.SS2.p3.2.m2.1.2.2.2" xref="S3.SS2.p3.2.m2.1.2.2.2.cmml">Q</mi><mn id="S3.SS2.p3.2.m2.1.2.2.3" xref="S3.SS2.p3.2.m2.1.2.2.3.cmml">0</mn></msub><mo id="S3.SS2.p3.2.m2.1.2.1" xref="S3.SS2.p3.2.m2.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.p3.2.m2.1.2.3.2" xref="S3.SS2.p3.2.m2.1.2.cmml"><mo id="S3.SS2.p3.2.m2.1.2.3.2.1" stretchy="false" xref="S3.SS2.p3.2.m2.1.2.cmml">(</mo><mi id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml">X</mi><mo id="S3.SS2.p3.2.m2.1.2.3.2.2" stretchy="false" xref="S3.SS2.p3.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><apply id="S3.SS2.p3.2.m2.1.2.cmml" xref="S3.SS2.p3.2.m2.1.2"><times id="S3.SS2.p3.2.m2.1.2.1.cmml" xref="S3.SS2.p3.2.m2.1.2.1"></times><apply id="S3.SS2.p3.2.m2.1.2.2.cmml" xref="S3.SS2.p3.2.m2.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.1.2.2.1.cmml" xref="S3.SS2.p3.2.m2.1.2.2">subscript</csymbol><ci id="S3.SS2.p3.2.m2.1.2.2.2.cmml" xref="S3.SS2.p3.2.m2.1.2.2.2">𝑄</ci><cn id="S3.SS2.p3.2.m2.1.2.2.3.cmml" type="integer" xref="S3.SS2.p3.2.m2.1.2.2.3">0</cn></apply><ci id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">Q_{0}(X)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.2.m2.1d">italic_Q start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_X )</annotation></semantics></math> for a given partition <math alttext="X" class="ltx_Math" display="inline" id="S3.SS2.p3.3.m3.1"><semantics id="S3.SS2.p3.3.m3.1a"><mi id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b"><ci id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">X</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.3.m3.1d">italic_X</annotation></semantics></math>) and cheaply draw exact samples from.
As such, no samples are required for the first iteration of boosting and for the second we can initialize the sample pool by drawing exact samples from <math alttext="q_{1}" class="ltx_Math" display="inline" id="S3.SS2.p3.4.m4.1"><semantics id="S3.SS2.p3.4.m4.1a"><msub id="S3.SS2.p3.4.m4.1.1" xref="S3.SS2.p3.4.m4.1.1.cmml"><mi id="S3.SS2.p3.4.m4.1.1.2" xref="S3.SS2.p3.4.m4.1.1.2.cmml">q</mi><mn id="S3.SS2.p3.4.m4.1.1.3" xref="S3.SS2.p3.4.m4.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.1b"><apply id="S3.SS2.p3.4.m4.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.1.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p3.4.m4.1.1.2.cmml" xref="S3.SS2.p3.4.m4.1.1.2">𝑞</ci><cn id="S3.SS2.p3.4.m4.1.1.3.cmml" type="integer" xref="S3.SS2.p3.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.1c">q_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.4.m4.1d">italic_q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> with rejection sampling using <math alttext="q_{0}" class="ltx_Math" display="inline" id="S3.SS2.p3.5.m5.1"><semantics id="S3.SS2.p3.5.m5.1a"><msub id="S3.SS2.p3.5.m5.1.1" xref="S3.SS2.p3.5.m5.1.1.cmml"><mi id="S3.SS2.p3.5.m5.1.1.2" xref="S3.SS2.p3.5.m5.1.1.2.cmml">q</mi><mn id="S3.SS2.p3.5.m5.1.1.3" xref="S3.SS2.p3.5.m5.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m5.1b"><apply id="S3.SS2.p3.5.m5.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.5.m5.1.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p3.5.m5.1.1.2.cmml" xref="S3.SS2.p3.5.m5.1.1.2">𝑞</ci><cn id="S3.SS2.p3.5.m5.1.1.3.cmml" type="integer" xref="S3.SS2.p3.5.m5.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m5.1c">q_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.5.m5.1d">italic_q start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> as a proposal distribution.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p4">
<p class="ltx_p" id="S3.SS2.p4.4">This approach works better when the range of <math alttext="\delta f_{t}" class="ltx_Math" display="inline" id="S3.SS2.p4.1.m1.1"><semantics id="S3.SS2.p4.1.m1.1a"><mrow id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml"><mi id="S3.SS2.p4.1.m1.1.1.2" xref="S3.SS2.p4.1.m1.1.1.2.cmml">δ</mi><mo id="S3.SS2.p4.1.m1.1.1.1" xref="S3.SS2.p4.1.m1.1.1.1.cmml">⁢</mo><msub id="S3.SS2.p4.1.m1.1.1.3" xref="S3.SS2.p4.1.m1.1.1.3.cmml"><mi id="S3.SS2.p4.1.m1.1.1.3.2" xref="S3.SS2.p4.1.m1.1.1.3.2.cmml">f</mi><mi id="S3.SS2.p4.1.m1.1.1.3.3" xref="S3.SS2.p4.1.m1.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b"><apply id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1"><times id="S3.SS2.p4.1.m1.1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1.1"></times><ci id="S3.SS2.p4.1.m1.1.1.2.cmml" xref="S3.SS2.p4.1.m1.1.1.2">𝛿</ci><apply id="S3.SS2.p4.1.m1.1.1.3.cmml" xref="S3.SS2.p4.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.1.1.3.1.cmml" xref="S3.SS2.p4.1.m1.1.1.3">subscript</csymbol><ci id="S3.SS2.p4.1.m1.1.1.3.2.cmml" xref="S3.SS2.p4.1.m1.1.1.3.2">𝑓</ci><ci id="S3.SS2.p4.1.m1.1.1.3.3.cmml" xref="S3.SS2.p4.1.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">\delta f_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.1.m1.1d">italic_δ italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and/or the step sizes <math alttext="\alpha_{t}" class="ltx_Math" display="inline" id="S3.SS2.p4.2.m2.1"><semantics id="S3.SS2.p4.2.m2.1a"><msub id="S3.SS2.p4.2.m2.1.1" xref="S3.SS2.p4.2.m2.1.1.cmml"><mi id="S3.SS2.p4.2.m2.1.1.2" xref="S3.SS2.p4.2.m2.1.1.2.cmml">α</mi><mi id="S3.SS2.p4.2.m2.1.1.3" xref="S3.SS2.p4.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.1b"><apply id="S3.SS2.p4.2.m2.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.2.m2.1.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p4.2.m2.1.1.2.cmml" xref="S3.SS2.p4.2.m2.1.1.2">𝛼</ci><ci id="S3.SS2.p4.2.m2.1.1.3.cmml" xref="S3.SS2.p4.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.1c">\alpha_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.2.m2.1d">italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> are small as this leads to larger acceptance probabilities.
Note that in practice it can be helpful to independently refresh a fixed fraction of samples, <math alttext="p_{refresh}" class="ltx_Math" display="inline" id="S3.SS2.p4.3.m3.1"><semantics id="S3.SS2.p4.3.m3.1a"><msub id="S3.SS2.p4.3.m3.1.1" xref="S3.SS2.p4.3.m3.1.1.cmml"><mi id="S3.SS2.p4.3.m3.1.1.2" xref="S3.SS2.p4.3.m3.1.1.2.cmml">p</mi><mrow id="S3.SS2.p4.3.m3.1.1.3" xref="S3.SS2.p4.3.m3.1.1.3.cmml"><mi id="S3.SS2.p4.3.m3.1.1.3.2" xref="S3.SS2.p4.3.m3.1.1.3.2.cmml">r</mi><mo id="S3.SS2.p4.3.m3.1.1.3.1" xref="S3.SS2.p4.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p4.3.m3.1.1.3.3" xref="S3.SS2.p4.3.m3.1.1.3.3.cmml">e</mi><mo id="S3.SS2.p4.3.m3.1.1.3.1a" xref="S3.SS2.p4.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p4.3.m3.1.1.3.4" xref="S3.SS2.p4.3.m3.1.1.3.4.cmml">f</mi><mo id="S3.SS2.p4.3.m3.1.1.3.1b" xref="S3.SS2.p4.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p4.3.m3.1.1.3.5" xref="S3.SS2.p4.3.m3.1.1.3.5.cmml">r</mi><mo id="S3.SS2.p4.3.m3.1.1.3.1c" xref="S3.SS2.p4.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p4.3.m3.1.1.3.6" xref="S3.SS2.p4.3.m3.1.1.3.6.cmml">e</mi><mo id="S3.SS2.p4.3.m3.1.1.3.1d" xref="S3.SS2.p4.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p4.3.m3.1.1.3.7" xref="S3.SS2.p4.3.m3.1.1.3.7.cmml">s</mi><mo id="S3.SS2.p4.3.m3.1.1.3.1e" xref="S3.SS2.p4.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p4.3.m3.1.1.3.8" xref="S3.SS2.p4.3.m3.1.1.3.8.cmml">h</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.3.m3.1b"><apply id="S3.SS2.p4.3.m3.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.3.m3.1.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p4.3.m3.1.1.2.cmml" xref="S3.SS2.p4.3.m3.1.1.2">𝑝</ci><apply id="S3.SS2.p4.3.m3.1.1.3.cmml" xref="S3.SS2.p4.3.m3.1.1.3"><times id="S3.SS2.p4.3.m3.1.1.3.1.cmml" xref="S3.SS2.p4.3.m3.1.1.3.1"></times><ci id="S3.SS2.p4.3.m3.1.1.3.2.cmml" xref="S3.SS2.p4.3.m3.1.1.3.2">𝑟</ci><ci id="S3.SS2.p4.3.m3.1.1.3.3.cmml" xref="S3.SS2.p4.3.m3.1.1.3.3">𝑒</ci><ci id="S3.SS2.p4.3.m3.1.1.3.4.cmml" xref="S3.SS2.p4.3.m3.1.1.3.4">𝑓</ci><ci id="S3.SS2.p4.3.m3.1.1.3.5.cmml" xref="S3.SS2.p4.3.m3.1.1.3.5">𝑟</ci><ci id="S3.SS2.p4.3.m3.1.1.3.6.cmml" xref="S3.SS2.p4.3.m3.1.1.3.6">𝑒</ci><ci id="S3.SS2.p4.3.m3.1.1.3.7.cmml" xref="S3.SS2.p4.3.m3.1.1.3.7">𝑠</ci><ci id="S3.SS2.p4.3.m3.1.1.3.8.cmml" xref="S3.SS2.p4.3.m3.1.1.3.8">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.3.m3.1c">p_{refresh}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.3.m3.1d">italic_p start_POSTSUBSCRIPT italic_r italic_e italic_f italic_r italic_e italic_s italic_h end_POSTSUBSCRIPT</annotation></semantics></math>, at each round of boosting in order to encourage more diverse samples between rounds.
This can be accomplished by keeping each sample with a probability <math alttext="p_{accept}(\mathbf{x})(1-p_{refresh})" class="ltx_Math" display="inline" id="S3.SS2.p4.4.m4.2"><semantics id="S3.SS2.p4.4.m4.2a"><mrow id="S3.SS2.p4.4.m4.2.2" xref="S3.SS2.p4.4.m4.2.2.cmml"><msub id="S3.SS2.p4.4.m4.2.2.3" xref="S3.SS2.p4.4.m4.2.2.3.cmml"><mi id="S3.SS2.p4.4.m4.2.2.3.2" xref="S3.SS2.p4.4.m4.2.2.3.2.cmml">p</mi><mrow id="S3.SS2.p4.4.m4.2.2.3.3" xref="S3.SS2.p4.4.m4.2.2.3.3.cmml"><mi id="S3.SS2.p4.4.m4.2.2.3.3.2" xref="S3.SS2.p4.4.m4.2.2.3.3.2.cmml">a</mi><mo id="S3.SS2.p4.4.m4.2.2.3.3.1" xref="S3.SS2.p4.4.m4.2.2.3.3.1.cmml">⁢</mo><mi id="S3.SS2.p4.4.m4.2.2.3.3.3" xref="S3.SS2.p4.4.m4.2.2.3.3.3.cmml">c</mi><mo id="S3.SS2.p4.4.m4.2.2.3.3.1a" xref="S3.SS2.p4.4.m4.2.2.3.3.1.cmml">⁢</mo><mi id="S3.SS2.p4.4.m4.2.2.3.3.4" xref="S3.SS2.p4.4.m4.2.2.3.3.4.cmml">c</mi><mo id="S3.SS2.p4.4.m4.2.2.3.3.1b" xref="S3.SS2.p4.4.m4.2.2.3.3.1.cmml">⁢</mo><mi id="S3.SS2.p4.4.m4.2.2.3.3.5" xref="S3.SS2.p4.4.m4.2.2.3.3.5.cmml">e</mi><mo id="S3.SS2.p4.4.m4.2.2.3.3.1c" xref="S3.SS2.p4.4.m4.2.2.3.3.1.cmml">⁢</mo><mi id="S3.SS2.p4.4.m4.2.2.3.3.6" xref="S3.SS2.p4.4.m4.2.2.3.3.6.cmml">p</mi><mo id="S3.SS2.p4.4.m4.2.2.3.3.1d" xref="S3.SS2.p4.4.m4.2.2.3.3.1.cmml">⁢</mo><mi id="S3.SS2.p4.4.m4.2.2.3.3.7" xref="S3.SS2.p4.4.m4.2.2.3.3.7.cmml">t</mi></mrow></msub><mo id="S3.SS2.p4.4.m4.2.2.2" xref="S3.SS2.p4.4.m4.2.2.2.cmml">⁢</mo><mrow id="S3.SS2.p4.4.m4.2.2.4.2" xref="S3.SS2.p4.4.m4.2.2.cmml"><mo id="S3.SS2.p4.4.m4.2.2.4.2.1" stretchy="false" xref="S3.SS2.p4.4.m4.2.2.cmml">(</mo><mi id="S3.SS2.p4.4.m4.1.1" xref="S3.SS2.p4.4.m4.1.1.cmml">𝐱</mi><mo id="S3.SS2.p4.4.m4.2.2.4.2.2" stretchy="false" xref="S3.SS2.p4.4.m4.2.2.cmml">)</mo></mrow><mo id="S3.SS2.p4.4.m4.2.2.2a" xref="S3.SS2.p4.4.m4.2.2.2.cmml">⁢</mo><mrow id="S3.SS2.p4.4.m4.2.2.1.1" xref="S3.SS2.p4.4.m4.2.2.1.1.1.cmml"><mo id="S3.SS2.p4.4.m4.2.2.1.1.2" stretchy="false" xref="S3.SS2.p4.4.m4.2.2.1.1.1.cmml">(</mo><mrow id="S3.SS2.p4.4.m4.2.2.1.1.1" xref="S3.SS2.p4.4.m4.2.2.1.1.1.cmml"><mn id="S3.SS2.p4.4.m4.2.2.1.1.1.2" xref="S3.SS2.p4.4.m4.2.2.1.1.1.2.cmml">1</mn><mo id="S3.SS2.p4.4.m4.2.2.1.1.1.1" xref="S3.SS2.p4.4.m4.2.2.1.1.1.1.cmml">−</mo><msub id="S3.SS2.p4.4.m4.2.2.1.1.1.3" xref="S3.SS2.p4.4.m4.2.2.1.1.1.3.cmml"><mi id="S3.SS2.p4.4.m4.2.2.1.1.1.3.2" xref="S3.SS2.p4.4.m4.2.2.1.1.1.3.2.cmml">p</mi><mrow id="S3.SS2.p4.4.m4.2.2.1.1.1.3.3" xref="S3.SS2.p4.4.m4.2.2.1.1.1.3.3.cmml"><mi id="S3.SS2.p4.4.m4.2.2.1.1.1.3.3.2" xref="S3.SS2.p4.4.m4.2.2.1.1.1.3.3.2.cmml">r</mi><mo id="S3.SS2.p4.4.m4.2.2.1.1.1.3.3.1" xref="S3.SS2.p4.4.m4.2.2.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS2.p4.4.m4.2.2.1.1.1.3.3.3" xref="S3.SS2.p4.4.m4.2.2.1.1.1.3.3.3.cmml">e</mi><mo id="S3.SS2.p4.4.m4.2.2.1.1.1.3.3.1a" xref="S3.SS2.p4.4.m4.2.2.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS2.p4.4.m4.2.2.1.1.1.3.3.4" xref="S3.SS2.p4.4.m4.2.2.1.1.1.3.3.4.cmml">f</mi><mo id="S3.SS2.p4.4.m4.2.2.1.1.1.3.3.1b" xref="S3.SS2.p4.4.m4.2.2.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS2.p4.4.m4.2.2.1.1.1.3.3.5" xref="S3.SS2.p4.4.m4.2.2.1.1.1.3.3.5.cmml">r</mi><mo id="S3.SS2.p4.4.m4.2.2.1.1.1.3.3.1c" xref="S3.SS2.p4.4.m4.2.2.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS2.p4.4.m4.2.2.1.1.1.3.3.6" xref="S3.SS2.p4.4.m4.2.2.1.1.1.3.3.6.cmml">e</mi><mo id="S3.SS2.p4.4.m4.2.2.1.1.1.3.3.1d" xref="S3.SS2.p4.4.m4.2.2.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS2.p4.4.m4.2.2.1.1.1.3.3.7" xref="S3.SS2.p4.4.m4.2.2.1.1.1.3.3.7.cmml">s</mi><mo id="S3.SS2.p4.4.m4.2.2.1.1.1.3.3.1e" xref="S3.SS2.p4.4.m4.2.2.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS2.p4.4.m4.2.2.1.1.1.3.3.8" xref="S3.SS2.p4.4.m4.2.2.1.1.1.3.3.8.cmml">h</mi></mrow></msub></mrow><mo id="S3.SS2.p4.4.m4.2.2.1.1.3" stretchy="false" xref="S3.SS2.p4.4.m4.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.4.m4.2b"><apply id="S3.SS2.p4.4.m4.2.2.cmml" xref="S3.SS2.p4.4.m4.2.2"><times id="S3.SS2.p4.4.m4.2.2.2.cmml" xref="S3.SS2.p4.4.m4.2.2.2"></times><apply id="S3.SS2.p4.4.m4.2.2.3.cmml" xref="S3.SS2.p4.4.m4.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.p4.4.m4.2.2.3.1.cmml" xref="S3.SS2.p4.4.m4.2.2.3">subscript</csymbol><ci id="S3.SS2.p4.4.m4.2.2.3.2.cmml" xref="S3.SS2.p4.4.m4.2.2.3.2">𝑝</ci><apply id="S3.SS2.p4.4.m4.2.2.3.3.cmml" xref="S3.SS2.p4.4.m4.2.2.3.3"><times id="S3.SS2.p4.4.m4.2.2.3.3.1.cmml" xref="S3.SS2.p4.4.m4.2.2.3.3.1"></times><ci id="S3.SS2.p4.4.m4.2.2.3.3.2.cmml" xref="S3.SS2.p4.4.m4.2.2.3.3.2">𝑎</ci><ci id="S3.SS2.p4.4.m4.2.2.3.3.3.cmml" xref="S3.SS2.p4.4.m4.2.2.3.3.3">𝑐</ci><ci id="S3.SS2.p4.4.m4.2.2.3.3.4.cmml" xref="S3.SS2.p4.4.m4.2.2.3.3.4">𝑐</ci><ci id="S3.SS2.p4.4.m4.2.2.3.3.5.cmml" xref="S3.SS2.p4.4.m4.2.2.3.3.5">𝑒</ci><ci id="S3.SS2.p4.4.m4.2.2.3.3.6.cmml" xref="S3.SS2.p4.4.m4.2.2.3.3.6">𝑝</ci><ci id="S3.SS2.p4.4.m4.2.2.3.3.7.cmml" xref="S3.SS2.p4.4.m4.2.2.3.3.7">𝑡</ci></apply></apply><ci id="S3.SS2.p4.4.m4.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1">𝐱</ci><apply id="S3.SS2.p4.4.m4.2.2.1.1.1.cmml" xref="S3.SS2.p4.4.m4.2.2.1.1"><minus id="S3.SS2.p4.4.m4.2.2.1.1.1.1.cmml" xref="S3.SS2.p4.4.m4.2.2.1.1.1.1"></minus><cn id="S3.SS2.p4.4.m4.2.2.1.1.1.2.cmml" type="integer" xref="S3.SS2.p4.4.m4.2.2.1.1.1.2">1</cn><apply id="S3.SS2.p4.4.m4.2.2.1.1.1.3.cmml" xref="S3.SS2.p4.4.m4.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p4.4.m4.2.2.1.1.1.3.1.cmml" xref="S3.SS2.p4.4.m4.2.2.1.1.1.3">subscript</csymbol><ci id="S3.SS2.p4.4.m4.2.2.1.1.1.3.2.cmml" xref="S3.SS2.p4.4.m4.2.2.1.1.1.3.2">𝑝</ci><apply id="S3.SS2.p4.4.m4.2.2.1.1.1.3.3.cmml" xref="S3.SS2.p4.4.m4.2.2.1.1.1.3.3"><times id="S3.SS2.p4.4.m4.2.2.1.1.1.3.3.1.cmml" xref="S3.SS2.p4.4.m4.2.2.1.1.1.3.3.1"></times><ci id="S3.SS2.p4.4.m4.2.2.1.1.1.3.3.2.cmml" xref="S3.SS2.p4.4.m4.2.2.1.1.1.3.3.2">𝑟</ci><ci id="S3.SS2.p4.4.m4.2.2.1.1.1.3.3.3.cmml" xref="S3.SS2.p4.4.m4.2.2.1.1.1.3.3.3">𝑒</ci><ci id="S3.SS2.p4.4.m4.2.2.1.1.1.3.3.4.cmml" xref="S3.SS2.p4.4.m4.2.2.1.1.1.3.3.4">𝑓</ci><ci id="S3.SS2.p4.4.m4.2.2.1.1.1.3.3.5.cmml" xref="S3.SS2.p4.4.m4.2.2.1.1.1.3.3.5">𝑟</ci><ci id="S3.SS2.p4.4.m4.2.2.1.1.1.3.3.6.cmml" xref="S3.SS2.p4.4.m4.2.2.1.1.1.3.3.6">𝑒</ci><ci id="S3.SS2.p4.4.m4.2.2.1.1.1.3.3.7.cmml" xref="S3.SS2.p4.4.m4.2.2.1.1.1.3.3.7">𝑠</ci><ci id="S3.SS2.p4.4.m4.2.2.1.1.1.3.3.8.cmml" xref="S3.SS2.p4.4.m4.2.2.1.1.1.3.3.8">ℎ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.4.m4.2c">p_{accept}(\mathbf{x})(1-p_{refresh})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.4.m4.2d">italic_p start_POSTSUBSCRIPT italic_a italic_c italic_c italic_e italic_p italic_t end_POSTSUBSCRIPT ( bold_x ) ( 1 - italic_p start_POSTSUBSCRIPT italic_r italic_e italic_f italic_r italic_e italic_s italic_h end_POSTSUBSCRIPT )</annotation></semantics></math> instead.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Regularization</h3>
<div class="ltx_para ltx_noindent" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.2">The simplest way to regularize a boosting model is to stop training when overfitting is detected by monitoring a suitable performance metric on a validation set.
For NRGBoost this could be the increase in log-likelihood at each boosting round.
However, estimating this quantity would require drawing additional validation samples from the model (see Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A1.SS1" title="A.1 Application to Piecewise Constant Functions ‣ Appendix A Theory ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">A.1</span></a>).
An alternative viable validation strategy which needs no additional samples is to simply monitor a discriminative performance metric.
This amounts to monitoring the quality of <math alttext="q_{f}(x_{i}|\mathbf{x}_{-i})" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.1"><semantics id="S3.SS3.p1.1.m1.1a"><mrow id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml"><msub id="S3.SS3.p1.1.m1.1.1.3" xref="S3.SS3.p1.1.m1.1.1.3.cmml"><mi id="S3.SS3.p1.1.m1.1.1.3.2" xref="S3.SS3.p1.1.m1.1.1.3.2.cmml">q</mi><mi id="S3.SS3.p1.1.m1.1.1.3.3" xref="S3.SS3.p1.1.m1.1.1.3.3.cmml">f</mi></msub><mo id="S3.SS3.p1.1.m1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.p1.1.m1.1.1.1.1" xref="S3.SS3.p1.1.m1.1.1.1.1.1.cmml"><mo id="S3.SS3.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S3.SS3.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p1.1.m1.1.1.1.1.1" xref="S3.SS3.p1.1.m1.1.1.1.1.1.cmml"><msub id="S3.SS3.p1.1.m1.1.1.1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.1.1.1.2.cmml"><mi id="S3.SS3.p1.1.m1.1.1.1.1.1.2.2" xref="S3.SS3.p1.1.m1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S3.SS3.p1.1.m1.1.1.1.1.1.2.3" xref="S3.SS3.p1.1.m1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo fence="false" id="S3.SS3.p1.1.m1.1.1.1.1.1.1" xref="S3.SS3.p1.1.m1.1.1.1.1.1.1.cmml">|</mo><msub id="S3.SS3.p1.1.m1.1.1.1.1.1.3" xref="S3.SS3.p1.1.m1.1.1.1.1.1.3.cmml"><mi id="S3.SS3.p1.1.m1.1.1.1.1.1.3.2" xref="S3.SS3.p1.1.m1.1.1.1.1.1.3.2.cmml">𝐱</mi><mrow id="S3.SS3.p1.1.m1.1.1.1.1.1.3.3" xref="S3.SS3.p1.1.m1.1.1.1.1.1.3.3.cmml"><mo id="S3.SS3.p1.1.m1.1.1.1.1.1.3.3a" xref="S3.SS3.p1.1.m1.1.1.1.1.1.3.3.cmml">−</mo><mi id="S3.SS3.p1.1.m1.1.1.1.1.1.3.3.2" xref="S3.SS3.p1.1.m1.1.1.1.1.1.3.3.2.cmml">i</mi></mrow></msub></mrow><mo id="S3.SS3.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S3.SS3.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><apply id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1"><times id="S3.SS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1.2"></times><apply id="S3.SS3.p1.1.m1.1.1.3.cmml" xref="S3.SS3.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.1.1.3.1.cmml" xref="S3.SS3.p1.1.m1.1.1.3">subscript</csymbol><ci id="S3.SS3.p1.1.m1.1.1.3.2.cmml" xref="S3.SS3.p1.1.m1.1.1.3.2">𝑞</ci><ci id="S3.SS3.p1.1.m1.1.1.3.3.cmml" xref="S3.SS3.p1.1.m1.1.1.3.3">𝑓</ci></apply><apply id="S3.SS3.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1"><csymbol cd="latexml" id="S3.SS3.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.SS3.p1.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS3.p1.1.m1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1.1.2.2">𝑥</ci><ci id="S3.SS3.p1.1.m1.1.1.1.1.1.2.3.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.SS3.p1.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.p1.1.m1.1.1.1.1.1.3.2.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1.1.3.2">𝐱</ci><apply id="S3.SS3.p1.1.m1.1.1.1.1.1.3.3.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1.1.3.3"><minus id="S3.SS3.p1.1.m1.1.1.1.1.1.3.3.1.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1.1.3.3"></minus><ci id="S3.SS3.p1.1.m1.1.1.1.1.1.3.3.2.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1.1.3.3.2">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">q_{f}(x_{i}|\mathbf{x}_{-i})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.1d">italic_q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | bold_x start_POSTSUBSCRIPT - italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> instead of the full <math alttext="q_{f}(\mathbf{x})" class="ltx_Math" display="inline" id="S3.SS3.p1.2.m2.1"><semantics id="S3.SS3.p1.2.m2.1a"><mrow id="S3.SS3.p1.2.m2.1.2" xref="S3.SS3.p1.2.m2.1.2.cmml"><msub id="S3.SS3.p1.2.m2.1.2.2" xref="S3.SS3.p1.2.m2.1.2.2.cmml"><mi id="S3.SS3.p1.2.m2.1.2.2.2" xref="S3.SS3.p1.2.m2.1.2.2.2.cmml">q</mi><mi id="S3.SS3.p1.2.m2.1.2.2.3" xref="S3.SS3.p1.2.m2.1.2.2.3.cmml">f</mi></msub><mo id="S3.SS3.p1.2.m2.1.2.1" xref="S3.SS3.p1.2.m2.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.p1.2.m2.1.2.3.2" xref="S3.SS3.p1.2.m2.1.2.cmml"><mo id="S3.SS3.p1.2.m2.1.2.3.2.1" stretchy="false" xref="S3.SS3.p1.2.m2.1.2.cmml">(</mo><mi id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml">𝐱</mi><mo id="S3.SS3.p1.2.m2.1.2.3.2.2" stretchy="false" xref="S3.SS3.p1.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><apply id="S3.SS3.p1.2.m2.1.2.cmml" xref="S3.SS3.p1.2.m2.1.2"><times id="S3.SS3.p1.2.m2.1.2.1.cmml" xref="S3.SS3.p1.2.m2.1.2.1"></times><apply id="S3.SS3.p1.2.m2.1.2.2.cmml" xref="S3.SS3.p1.2.m2.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.2.2.1.cmml" xref="S3.SS3.p1.2.m2.1.2.2">subscript</csymbol><ci id="S3.SS3.p1.2.m2.1.2.2.2.cmml" xref="S3.SS3.p1.2.m2.1.2.2.2">𝑞</ci><ci id="S3.SS3.p1.2.m2.1.2.2.3.cmml" xref="S3.SS3.p1.2.m2.1.2.2.3">𝑓</ci></apply><ci id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">𝐱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">q_{f}(\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.2.m2.1d">italic_q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT ( bold_x )</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.4">Besides early stopping, the decision trees themselves can be regularized by limiting the depth or total number of leaves in each tree.
Additionally, we can rely on other strategies
such as disregarding splits that would result in a leaf with too little training data, <math alttext="P(X)" class="ltx_Math" display="inline" id="S3.SS3.p2.1.m1.1"><semantics id="S3.SS3.p2.1.m1.1a"><mrow id="S3.SS3.p2.1.m1.1.2" xref="S3.SS3.p2.1.m1.1.2.cmml"><mi id="S3.SS3.p2.1.m1.1.2.2" xref="S3.SS3.p2.1.m1.1.2.2.cmml">P</mi><mo id="S3.SS3.p2.1.m1.1.2.1" xref="S3.SS3.p2.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.p2.1.m1.1.2.3.2" xref="S3.SS3.p2.1.m1.1.2.cmml"><mo id="S3.SS3.p2.1.m1.1.2.3.2.1" stretchy="false" xref="S3.SS3.p2.1.m1.1.2.cmml">(</mo><mi id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">X</mi><mo id="S3.SS3.p2.1.m1.1.2.3.2.2" stretchy="false" xref="S3.SS3.p2.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.2"><times id="S3.SS3.p2.1.m1.1.2.1.cmml" xref="S3.SS3.p2.1.m1.1.2.1"></times><ci id="S3.SS3.p2.1.m1.1.2.2.cmml" xref="S3.SS3.p2.1.m1.1.2.2">𝑃</ci><ci id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">P(X)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.1.m1.1d">italic_P ( italic_X )</annotation></semantics></math>, model data, <math alttext="Q_{f}(X)" class="ltx_Math" display="inline" id="S3.SS3.p2.2.m2.1"><semantics id="S3.SS3.p2.2.m2.1a"><mrow id="S3.SS3.p2.2.m2.1.2" xref="S3.SS3.p2.2.m2.1.2.cmml"><msub id="S3.SS3.p2.2.m2.1.2.2" xref="S3.SS3.p2.2.m2.1.2.2.cmml"><mi id="S3.SS3.p2.2.m2.1.2.2.2" xref="S3.SS3.p2.2.m2.1.2.2.2.cmml">Q</mi><mi id="S3.SS3.p2.2.m2.1.2.2.3" xref="S3.SS3.p2.2.m2.1.2.2.3.cmml">f</mi></msub><mo id="S3.SS3.p2.2.m2.1.2.1" xref="S3.SS3.p2.2.m2.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.p2.2.m2.1.2.3.2" xref="S3.SS3.p2.2.m2.1.2.cmml"><mo id="S3.SS3.p2.2.m2.1.2.3.2.1" stretchy="false" xref="S3.SS3.p2.2.m2.1.2.cmml">(</mo><mi id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml">X</mi><mo id="S3.SS3.p2.2.m2.1.2.3.2.2" stretchy="false" xref="S3.SS3.p2.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><apply id="S3.SS3.p2.2.m2.1.2.cmml" xref="S3.SS3.p2.2.m2.1.2"><times id="S3.SS3.p2.2.m2.1.2.1.cmml" xref="S3.SS3.p2.2.m2.1.2.1"></times><apply id="S3.SS3.p2.2.m2.1.2.2.cmml" xref="S3.SS3.p2.2.m2.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.2.2.1.cmml" xref="S3.SS3.p2.2.m2.1.2.2">subscript</csymbol><ci id="S3.SS3.p2.2.m2.1.2.2.2.cmml" xref="S3.SS3.p2.2.m2.1.2.2.2">𝑄</ci><ci id="S3.SS3.p2.2.m2.1.2.2.3.cmml" xref="S3.SS3.p2.2.m2.1.2.2.3">𝑓</ci></apply><ci id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">Q_{f}(X)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.2.m2.1d">italic_Q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT ( italic_X )</annotation></semantics></math>, volume <math alttext="V(X)" class="ltx_Math" display="inline" id="S3.SS3.p2.3.m3.1"><semantics id="S3.SS3.p2.3.m3.1a"><mrow id="S3.SS3.p2.3.m3.1.2" xref="S3.SS3.p2.3.m3.1.2.cmml"><mi id="S3.SS3.p2.3.m3.1.2.2" xref="S3.SS3.p2.3.m3.1.2.2.cmml">V</mi><mo id="S3.SS3.p2.3.m3.1.2.1" xref="S3.SS3.p2.3.m3.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.p2.3.m3.1.2.3.2" xref="S3.SS3.p2.3.m3.1.2.cmml"><mo id="S3.SS3.p2.3.m3.1.2.3.2.1" stretchy="false" xref="S3.SS3.p2.3.m3.1.2.cmml">(</mo><mi id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml">X</mi><mo id="S3.SS3.p2.3.m3.1.2.3.2.2" stretchy="false" xref="S3.SS3.p2.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><apply id="S3.SS3.p2.3.m3.1.2.cmml" xref="S3.SS3.p2.3.m3.1.2"><times id="S3.SS3.p2.3.m3.1.2.1.cmml" xref="S3.SS3.p2.3.m3.1.2.1"></times><ci id="S3.SS3.p2.3.m3.1.2.2.cmml" xref="S3.SS3.p2.3.m3.1.2.2">𝑉</ci><ci id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">V(X)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.3.m3.1d">italic_V ( italic_X )</annotation></semantics></math> or
too high of a ratio between training and model data <math alttext="\nicefrac{{P(X)}}{{Q_{f}(X)}}" class="ltx_Math" display="inline" id="S3.SS3.p2.4.m4.2"><semantics id="S3.SS3.p2.4.m4.2a"><mrow id="S3.SS3.p2.4.m4.2.2" xref="S3.SS3.p2.4.m4.2.2.cmml"><mpadded id="S3.SS3.p2.4.m4.1.1.1" voffset="0.3em" xref="S3.SS3.p2.4.m4.1.1.1.cmml"><mi id="S3.SS3.p2.4.m4.1.1.1.3" mathsize="70%" xref="S3.SS3.p2.4.m4.1.1.1.3.cmml">P</mi><mo id="S3.SS3.p2.4.m4.1.1.1.2" xref="S3.SS3.p2.4.m4.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.p2.4.m4.1.1.1.4.2" xref="S3.SS3.p2.4.m4.1.1.1.cmml"><mo id="S3.SS3.p2.4.m4.1.1.1.4.2.1" maxsize="70%" minsize="70%" xref="S3.SS3.p2.4.m4.1.1.1.cmml">(</mo><mi id="S3.SS3.p2.4.m4.1.1.1.1" mathsize="70%" xref="S3.SS3.p2.4.m4.1.1.1.1.cmml">X</mi><mo id="S3.SS3.p2.4.m4.1.1.1.4.2.2" maxsize="70%" minsize="70%" xref="S3.SS3.p2.4.m4.1.1.1.cmml">)</mo></mrow></mpadded><mpadded id="S3.SS3.p2.4.m4.2.2.3" lspace="-0.1em" width="-0.15em" xref="S3.SS3.p2.4.m4.2.2.3.cmml"><mo id="S3.SS3.p2.4.m4.2.2.3a" stretchy="true" symmetric="true" xref="S3.SS3.p2.4.m4.2.2.3.cmml">/</mo></mpadded><mrow id="S3.SS3.p2.4.m4.2.2.2" xref="S3.SS3.p2.4.m4.2.2.2.cmml"><msub id="S3.SS3.p2.4.m4.2.2.2.3" xref="S3.SS3.p2.4.m4.2.2.2.3.cmml"><mi id="S3.SS3.p2.4.m4.2.2.2.3.2" mathsize="70%" xref="S3.SS3.p2.4.m4.2.2.2.3.2.cmml">Q</mi><mi id="S3.SS3.p2.4.m4.2.2.2.3.3" mathsize="71%" xref="S3.SS3.p2.4.m4.2.2.2.3.3.cmml">f</mi></msub><mo id="S3.SS3.p2.4.m4.2.2.2.2" xref="S3.SS3.p2.4.m4.2.2.2.2.cmml">⁢</mo><mrow id="S3.SS3.p2.4.m4.2.2.2.4.2" xref="S3.SS3.p2.4.m4.2.2.2.cmml"><mo id="S3.SS3.p2.4.m4.2.2.2.4.2.1" maxsize="70%" minsize="70%" xref="S3.SS3.p2.4.m4.2.2.2.cmml">(</mo><mi id="S3.SS3.p2.4.m4.2.2.2.1" mathsize="70%" xref="S3.SS3.p2.4.m4.2.2.2.1.cmml">X</mi><mo id="S3.SS3.p2.4.m4.2.2.2.4.2.2" maxsize="70%" minsize="70%" xref="S3.SS3.p2.4.m4.2.2.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.2b"><apply id="S3.SS3.p2.4.m4.2.2.cmml" xref="S3.SS3.p2.4.m4.2.2"><divide id="S3.SS3.p2.4.m4.2.2.3.cmml" xref="S3.SS3.p2.4.m4.2.2.3"></divide><apply id="S3.SS3.p2.4.m4.1.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1.1"><times id="S3.SS3.p2.4.m4.1.1.1.2.cmml" xref="S3.SS3.p2.4.m4.1.1.1.2"></times><ci id="S3.SS3.p2.4.m4.1.1.1.3.cmml" xref="S3.SS3.p2.4.m4.1.1.1.3">𝑃</ci><ci id="S3.SS3.p2.4.m4.1.1.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1">𝑋</ci></apply><apply id="S3.SS3.p2.4.m4.2.2.2.cmml" xref="S3.SS3.p2.4.m4.2.2.2"><times id="S3.SS3.p2.4.m4.2.2.2.2.cmml" xref="S3.SS3.p2.4.m4.2.2.2.2"></times><apply id="S3.SS3.p2.4.m4.2.2.2.3.cmml" xref="S3.SS3.p2.4.m4.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.2.2.2.3.1.cmml" xref="S3.SS3.p2.4.m4.2.2.2.3">subscript</csymbol><ci id="S3.SS3.p2.4.m4.2.2.2.3.2.cmml" xref="S3.SS3.p2.4.m4.2.2.2.3.2">𝑄</ci><ci id="S3.SS3.p2.4.m4.2.2.2.3.3.cmml" xref="S3.SS3.p2.4.m4.2.2.2.3.3">𝑓</ci></apply><ci id="S3.SS3.p2.4.m4.2.2.2.1.cmml" xref="S3.SS3.p2.4.m4.2.2.2.1">𝑋</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.2c">\nicefrac{{P(X)}}{{Q_{f}(X)}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.4.m4.2d">/ start_ARG italic_P ( italic_X ) end_ARG start_ARG italic_Q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT ( italic_X ) end_ARG</annotation></semantics></math>.
We found the latter to be the most effective of these, not only yielding better generalization performance than other approaches, but also
having the added benefit of allowing us to lower bound the acceptance probability of our rejection sampling scheme.
Furthermore, as we show in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A1.SS2" title="A.2 A Simple Lower Bound on the Likelihood Increase ‣ Appendix A Theory ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">A.2</span></a>, limiting this ratio guarantees that a small enough step size produces
an increase in likelihood at each round of boosting.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Density Estimation Trees and Density Estimation Forests</h2>
<div class="ltx_para ltx_noindent" id="S4.p1">
<p class="ltx_p" id="S4.p1.8">Density Estimation Trees (DET)
were proposed by <cite class="ltx_cite ltx_citemacro_citet">Ram &amp; Gray (<a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib24" title="">2011</a>)</cite> as an alternative to histograms and kernel density estimation but have received little attention as generative models for sampling or other applications.
They model the density function as a constant value over the support of each leaf in a binary tree,</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="q(\mathbf{x})=\sum_{j=1}^{J}\frac{\hat{P}(X_{j})}{V(X_{j})}\mathbf{1}_{X_{j}}(%
\mathbf{x})\;," class="ltx_Math" display="block" id="S4.E13.m1.5"><semantics id="S4.E13.m1.5a"><mrow id="S4.E13.m1.5.5.1" xref="S4.E13.m1.5.5.1.1.cmml"><mrow id="S4.E13.m1.5.5.1.1" xref="S4.E13.m1.5.5.1.1.cmml"><mrow id="S4.E13.m1.5.5.1.1.2" xref="S4.E13.m1.5.5.1.1.2.cmml"><mi id="S4.E13.m1.5.5.1.1.2.2" xref="S4.E13.m1.5.5.1.1.2.2.cmml">q</mi><mo id="S4.E13.m1.5.5.1.1.2.1" xref="S4.E13.m1.5.5.1.1.2.1.cmml">⁢</mo><mrow id="S4.E13.m1.5.5.1.1.2.3.2" xref="S4.E13.m1.5.5.1.1.2.cmml"><mo id="S4.E13.m1.5.5.1.1.2.3.2.1" stretchy="false" xref="S4.E13.m1.5.5.1.1.2.cmml">(</mo><mi id="S4.E13.m1.3.3" xref="S4.E13.m1.3.3.cmml">𝐱</mi><mo id="S4.E13.m1.5.5.1.1.2.3.2.2" stretchy="false" xref="S4.E13.m1.5.5.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E13.m1.5.5.1.1.1" rspace="0.111em" xref="S4.E13.m1.5.5.1.1.1.cmml">=</mo><mrow id="S4.E13.m1.5.5.1.1.3" xref="S4.E13.m1.5.5.1.1.3.cmml"><munderover id="S4.E13.m1.5.5.1.1.3.1" xref="S4.E13.m1.5.5.1.1.3.1.cmml"><mo id="S4.E13.m1.5.5.1.1.3.1.2.2" movablelimits="false" xref="S4.E13.m1.5.5.1.1.3.1.2.2.cmml">∑</mo><mrow id="S4.E13.m1.5.5.1.1.3.1.2.3" xref="S4.E13.m1.5.5.1.1.3.1.2.3.cmml"><mi id="S4.E13.m1.5.5.1.1.3.1.2.3.2" xref="S4.E13.m1.5.5.1.1.3.1.2.3.2.cmml">j</mi><mo id="S4.E13.m1.5.5.1.1.3.1.2.3.1" xref="S4.E13.m1.5.5.1.1.3.1.2.3.1.cmml">=</mo><mn id="S4.E13.m1.5.5.1.1.3.1.2.3.3" xref="S4.E13.m1.5.5.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S4.E13.m1.5.5.1.1.3.1.3" xref="S4.E13.m1.5.5.1.1.3.1.3.cmml">J</mi></munderover><mrow id="S4.E13.m1.5.5.1.1.3.2" xref="S4.E13.m1.5.5.1.1.3.2.cmml"><mfrac id="S4.E13.m1.2.2" xref="S4.E13.m1.2.2.cmml"><mrow id="S4.E13.m1.1.1.1" xref="S4.E13.m1.1.1.1.cmml"><mover accent="true" id="S4.E13.m1.1.1.1.3" xref="S4.E13.m1.1.1.1.3.cmml"><mi id="S4.E13.m1.1.1.1.3.2" xref="S4.E13.m1.1.1.1.3.2.cmml">P</mi><mo id="S4.E13.m1.1.1.1.3.1" xref="S4.E13.m1.1.1.1.3.1.cmml">^</mo></mover><mo id="S4.E13.m1.1.1.1.2" xref="S4.E13.m1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E13.m1.1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.1.1.cmml"><mo id="S4.E13.m1.1.1.1.1.1.2" stretchy="false" xref="S4.E13.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E13.m1.1.1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.1.1.cmml"><mi id="S4.E13.m1.1.1.1.1.1.1.2" xref="S4.E13.m1.1.1.1.1.1.1.2.cmml">X</mi><mi id="S4.E13.m1.1.1.1.1.1.1.3" xref="S4.E13.m1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S4.E13.m1.1.1.1.1.1.3" stretchy="false" xref="S4.E13.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S4.E13.m1.2.2.2" xref="S4.E13.m1.2.2.2.cmml"><mi id="S4.E13.m1.2.2.2.3" xref="S4.E13.m1.2.2.2.3.cmml">V</mi><mo id="S4.E13.m1.2.2.2.2" xref="S4.E13.m1.2.2.2.2.cmml">⁢</mo><mrow id="S4.E13.m1.2.2.2.1.1" xref="S4.E13.m1.2.2.2.1.1.1.cmml"><mo id="S4.E13.m1.2.2.2.1.1.2" stretchy="false" xref="S4.E13.m1.2.2.2.1.1.1.cmml">(</mo><msub id="S4.E13.m1.2.2.2.1.1.1" xref="S4.E13.m1.2.2.2.1.1.1.cmml"><mi id="S4.E13.m1.2.2.2.1.1.1.2" xref="S4.E13.m1.2.2.2.1.1.1.2.cmml">X</mi><mi id="S4.E13.m1.2.2.2.1.1.1.3" xref="S4.E13.m1.2.2.2.1.1.1.3.cmml">j</mi></msub><mo id="S4.E13.m1.2.2.2.1.1.3" stretchy="false" xref="S4.E13.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac><mo id="S4.E13.m1.5.5.1.1.3.2.1" xref="S4.E13.m1.5.5.1.1.3.2.1.cmml">⁢</mo><msub id="S4.E13.m1.5.5.1.1.3.2.2" xref="S4.E13.m1.5.5.1.1.3.2.2.cmml"><mn id="S4.E13.m1.5.5.1.1.3.2.2.2" xref="S4.E13.m1.5.5.1.1.3.2.2.2.cmml">𝟏</mn><msub id="S4.E13.m1.5.5.1.1.3.2.2.3" xref="S4.E13.m1.5.5.1.1.3.2.2.3.cmml"><mi id="S4.E13.m1.5.5.1.1.3.2.2.3.2" xref="S4.E13.m1.5.5.1.1.3.2.2.3.2.cmml">X</mi><mi id="S4.E13.m1.5.5.1.1.3.2.2.3.3" xref="S4.E13.m1.5.5.1.1.3.2.2.3.3.cmml">j</mi></msub></msub><mo id="S4.E13.m1.5.5.1.1.3.2.1a" xref="S4.E13.m1.5.5.1.1.3.2.1.cmml">⁢</mo><mrow id="S4.E13.m1.5.5.1.1.3.2.3.2" xref="S4.E13.m1.5.5.1.1.3.2.cmml"><mo id="S4.E13.m1.5.5.1.1.3.2.3.2.1" stretchy="false" xref="S4.E13.m1.5.5.1.1.3.2.cmml">(</mo><mi id="S4.E13.m1.4.4" xref="S4.E13.m1.4.4.cmml">𝐱</mi><mo id="S4.E13.m1.5.5.1.1.3.2.3.2.2" rspace="0.280em" stretchy="false" xref="S4.E13.m1.5.5.1.1.3.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E13.m1.5.5.1.2" xref="S4.E13.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E13.m1.5b"><apply id="S4.E13.m1.5.5.1.1.cmml" xref="S4.E13.m1.5.5.1"><eq id="S4.E13.m1.5.5.1.1.1.cmml" xref="S4.E13.m1.5.5.1.1.1"></eq><apply id="S4.E13.m1.5.5.1.1.2.cmml" xref="S4.E13.m1.5.5.1.1.2"><times id="S4.E13.m1.5.5.1.1.2.1.cmml" xref="S4.E13.m1.5.5.1.1.2.1"></times><ci id="S4.E13.m1.5.5.1.1.2.2.cmml" xref="S4.E13.m1.5.5.1.1.2.2">𝑞</ci><ci id="S4.E13.m1.3.3.cmml" xref="S4.E13.m1.3.3">𝐱</ci></apply><apply id="S4.E13.m1.5.5.1.1.3.cmml" xref="S4.E13.m1.5.5.1.1.3"><apply id="S4.E13.m1.5.5.1.1.3.1.cmml" xref="S4.E13.m1.5.5.1.1.3.1"><csymbol cd="ambiguous" id="S4.E13.m1.5.5.1.1.3.1.1.cmml" xref="S4.E13.m1.5.5.1.1.3.1">superscript</csymbol><apply id="S4.E13.m1.5.5.1.1.3.1.2.cmml" xref="S4.E13.m1.5.5.1.1.3.1"><csymbol cd="ambiguous" id="S4.E13.m1.5.5.1.1.3.1.2.1.cmml" xref="S4.E13.m1.5.5.1.1.3.1">subscript</csymbol><sum id="S4.E13.m1.5.5.1.1.3.1.2.2.cmml" xref="S4.E13.m1.5.5.1.1.3.1.2.2"></sum><apply id="S4.E13.m1.5.5.1.1.3.1.2.3.cmml" xref="S4.E13.m1.5.5.1.1.3.1.2.3"><eq id="S4.E13.m1.5.5.1.1.3.1.2.3.1.cmml" xref="S4.E13.m1.5.5.1.1.3.1.2.3.1"></eq><ci id="S4.E13.m1.5.5.1.1.3.1.2.3.2.cmml" xref="S4.E13.m1.5.5.1.1.3.1.2.3.2">𝑗</ci><cn id="S4.E13.m1.5.5.1.1.3.1.2.3.3.cmml" type="integer" xref="S4.E13.m1.5.5.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S4.E13.m1.5.5.1.1.3.1.3.cmml" xref="S4.E13.m1.5.5.1.1.3.1.3">𝐽</ci></apply><apply id="S4.E13.m1.5.5.1.1.3.2.cmml" xref="S4.E13.m1.5.5.1.1.3.2"><times id="S4.E13.m1.5.5.1.1.3.2.1.cmml" xref="S4.E13.m1.5.5.1.1.3.2.1"></times><apply id="S4.E13.m1.2.2.cmml" xref="S4.E13.m1.2.2"><divide id="S4.E13.m1.2.2.3.cmml" xref="S4.E13.m1.2.2"></divide><apply id="S4.E13.m1.1.1.1.cmml" xref="S4.E13.m1.1.1.1"><times id="S4.E13.m1.1.1.1.2.cmml" xref="S4.E13.m1.1.1.1.2"></times><apply id="S4.E13.m1.1.1.1.3.cmml" xref="S4.E13.m1.1.1.1.3"><ci id="S4.E13.m1.1.1.1.3.1.cmml" xref="S4.E13.m1.1.1.1.3.1">^</ci><ci id="S4.E13.m1.1.1.1.3.2.cmml" xref="S4.E13.m1.1.1.1.3.2">𝑃</ci></apply><apply id="S4.E13.m1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.E13.m1.1.1.1.1.1.1.2.cmml" xref="S4.E13.m1.1.1.1.1.1.1.2">𝑋</ci><ci id="S4.E13.m1.1.1.1.1.1.1.3.cmml" xref="S4.E13.m1.1.1.1.1.1.1.3">𝑗</ci></apply></apply><apply id="S4.E13.m1.2.2.2.cmml" xref="S4.E13.m1.2.2.2"><times id="S4.E13.m1.2.2.2.2.cmml" xref="S4.E13.m1.2.2.2.2"></times><ci id="S4.E13.m1.2.2.2.3.cmml" xref="S4.E13.m1.2.2.2.3">𝑉</ci><apply id="S4.E13.m1.2.2.2.1.1.1.cmml" xref="S4.E13.m1.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.E13.m1.2.2.2.1.1.1.1.cmml" xref="S4.E13.m1.2.2.2.1.1">subscript</csymbol><ci id="S4.E13.m1.2.2.2.1.1.1.2.cmml" xref="S4.E13.m1.2.2.2.1.1.1.2">𝑋</ci><ci id="S4.E13.m1.2.2.2.1.1.1.3.cmml" xref="S4.E13.m1.2.2.2.1.1.1.3">𝑗</ci></apply></apply></apply><apply id="S4.E13.m1.5.5.1.1.3.2.2.cmml" xref="S4.E13.m1.5.5.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E13.m1.5.5.1.1.3.2.2.1.cmml" xref="S4.E13.m1.5.5.1.1.3.2.2">subscript</csymbol><cn id="S4.E13.m1.5.5.1.1.3.2.2.2.cmml" type="integer" xref="S4.E13.m1.5.5.1.1.3.2.2.2">1</cn><apply id="S4.E13.m1.5.5.1.1.3.2.2.3.cmml" xref="S4.E13.m1.5.5.1.1.3.2.2.3"><csymbol cd="ambiguous" id="S4.E13.m1.5.5.1.1.3.2.2.3.1.cmml" xref="S4.E13.m1.5.5.1.1.3.2.2.3">subscript</csymbol><ci id="S4.E13.m1.5.5.1.1.3.2.2.3.2.cmml" xref="S4.E13.m1.5.5.1.1.3.2.2.3.2">𝑋</ci><ci id="S4.E13.m1.5.5.1.1.3.2.2.3.3.cmml" xref="S4.E13.m1.5.5.1.1.3.2.2.3.3">𝑗</ci></apply></apply><ci id="S4.E13.m1.4.4.cmml" xref="S4.E13.m1.4.4">𝐱</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E13.m1.5c">q(\mathbf{x})=\sum_{j=1}^{J}\frac{\hat{P}(X_{j})}{V(X_{j})}\mathbf{1}_{X_{j}}(%
\mathbf{x})\;,</annotation><annotation encoding="application/x-llamapun" id="S4.E13.m1.5d">italic_q ( bold_x ) = ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_J end_POSTSUPERSCRIPT divide start_ARG over^ start_ARG italic_P end_ARG ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG start_ARG italic_V ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG bold_1 start_POSTSUBSCRIPT italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_x ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.p1.7">with
<math alttext="\hat{P}(X)" class="ltx_Math" display="inline" id="S4.p1.1.m1.1"><semantics id="S4.p1.1.m1.1a"><mrow id="S4.p1.1.m1.1.2" xref="S4.p1.1.m1.1.2.cmml"><mover accent="true" id="S4.p1.1.m1.1.2.2" xref="S4.p1.1.m1.1.2.2.cmml"><mi id="S4.p1.1.m1.1.2.2.2" xref="S4.p1.1.m1.1.2.2.2.cmml">P</mi><mo id="S4.p1.1.m1.1.2.2.1" xref="S4.p1.1.m1.1.2.2.1.cmml">^</mo></mover><mo id="S4.p1.1.m1.1.2.1" xref="S4.p1.1.m1.1.2.1.cmml">⁢</mo><mrow id="S4.p1.1.m1.1.2.3.2" xref="S4.p1.1.m1.1.2.cmml"><mo id="S4.p1.1.m1.1.2.3.2.1" stretchy="false" xref="S4.p1.1.m1.1.2.cmml">(</mo><mi id="S4.p1.1.m1.1.1" xref="S4.p1.1.m1.1.1.cmml">X</mi><mo id="S4.p1.1.m1.1.2.3.2.2" stretchy="false" xref="S4.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.1.m1.1b"><apply id="S4.p1.1.m1.1.2.cmml" xref="S4.p1.1.m1.1.2"><times id="S4.p1.1.m1.1.2.1.cmml" xref="S4.p1.1.m1.1.2.1"></times><apply id="S4.p1.1.m1.1.2.2.cmml" xref="S4.p1.1.m1.1.2.2"><ci id="S4.p1.1.m1.1.2.2.1.cmml" xref="S4.p1.1.m1.1.2.2.1">^</ci><ci id="S4.p1.1.m1.1.2.2.2.cmml" xref="S4.p1.1.m1.1.2.2.2">𝑃</ci></apply><ci id="S4.p1.1.m1.1.1.cmml" xref="S4.p1.1.m1.1.1">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.1.m1.1c">\hat{P}(X)</annotation><annotation encoding="application/x-llamapun" id="S4.p1.1.m1.1d">over^ start_ARG italic_P end_ARG ( italic_X )</annotation></semantics></math> being an empirical estimate of probability of the event <math alttext="\mathbf{x}\in X" class="ltx_Math" display="inline" id="S4.p1.2.m2.1"><semantics id="S4.p1.2.m2.1a"><mrow id="S4.p1.2.m2.1.1" xref="S4.p1.2.m2.1.1.cmml"><mi id="S4.p1.2.m2.1.1.2" xref="S4.p1.2.m2.1.1.2.cmml">𝐱</mi><mo id="S4.p1.2.m2.1.1.1" xref="S4.p1.2.m2.1.1.1.cmml">∈</mo><mi id="S4.p1.2.m2.1.1.3" xref="S4.p1.2.m2.1.1.3.cmml">X</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.2.m2.1b"><apply id="S4.p1.2.m2.1.1.cmml" xref="S4.p1.2.m2.1.1"><in id="S4.p1.2.m2.1.1.1.cmml" xref="S4.p1.2.m2.1.1.1"></in><ci id="S4.p1.2.m2.1.1.2.cmml" xref="S4.p1.2.m2.1.1.2">𝐱</ci><ci id="S4.p1.2.m2.1.1.3.cmml" xref="S4.p1.2.m2.1.1.3">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.2.m2.1c">\mathbf{x}\in X</annotation><annotation encoding="application/x-llamapun" id="S4.p1.2.m2.1d">bold_x ∈ italic_X</annotation></semantics></math> and <math alttext="V(X)" class="ltx_Math" display="inline" id="S4.p1.3.m3.1"><semantics id="S4.p1.3.m3.1a"><mrow id="S4.p1.3.m3.1.2" xref="S4.p1.3.m3.1.2.cmml"><mi id="S4.p1.3.m3.1.2.2" xref="S4.p1.3.m3.1.2.2.cmml">V</mi><mo id="S4.p1.3.m3.1.2.1" xref="S4.p1.3.m3.1.2.1.cmml">⁢</mo><mrow id="S4.p1.3.m3.1.2.3.2" xref="S4.p1.3.m3.1.2.cmml"><mo id="S4.p1.3.m3.1.2.3.2.1" stretchy="false" xref="S4.p1.3.m3.1.2.cmml">(</mo><mi id="S4.p1.3.m3.1.1" xref="S4.p1.3.m3.1.1.cmml">X</mi><mo id="S4.p1.3.m3.1.2.3.2.2" stretchy="false" xref="S4.p1.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.3.m3.1b"><apply id="S4.p1.3.m3.1.2.cmml" xref="S4.p1.3.m3.1.2"><times id="S4.p1.3.m3.1.2.1.cmml" xref="S4.p1.3.m3.1.2.1"></times><ci id="S4.p1.3.m3.1.2.2.cmml" xref="S4.p1.3.m3.1.2.2">𝑉</ci><ci id="S4.p1.3.m3.1.1.cmml" xref="S4.p1.3.m3.1.1">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.3.m3.1c">V(X)</annotation><annotation encoding="application/x-llamapun" id="S4.p1.3.m3.1d">italic_V ( italic_X )</annotation></semantics></math> denoting the volume of <math alttext="X" class="ltx_Math" display="inline" id="S4.p1.4.m4.1"><semantics id="S4.p1.4.m4.1a"><mi id="S4.p1.4.m4.1.1" xref="S4.p1.4.m4.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S4.p1.4.m4.1b"><ci id="S4.p1.4.m4.1.1.cmml" xref="S4.p1.4.m4.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.4.m4.1c">X</annotation><annotation encoding="application/x-llamapun" id="S4.p1.4.m4.1d">italic_X</annotation></semantics></math>.
Note that it is possible to draw an exact sample from this type of model by randomly selecting a leaf, <math alttext="j\in[1..J]" class="ltx_math_unparsed" display="inline" id="S4.p1.5.m5.1"><semantics id="S4.p1.5.m5.1a"><mrow id="S4.p1.5.m5.1b"><mi id="S4.p1.5.m5.1.1">j</mi><mo id="S4.p1.5.m5.1.2">∈</mo><mrow id="S4.p1.5.m5.1.3"><mo id="S4.p1.5.m5.1.3.1" stretchy="false">[</mo><mn id="S4.p1.5.m5.1.3.2">1</mn><mo id="S4.p1.5.m5.1.3.3" lspace="0em" rspace="0.0835em">.</mo><mo id="S4.p1.5.m5.1.3.4" lspace="0.0835em" rspace="0.167em">.</mo><mi id="S4.p1.5.m5.1.3.5">J</mi><mo id="S4.p1.5.m5.1.3.6" stretchy="false">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.p1.5.m5.1c">j\in[1..J]</annotation><annotation encoding="application/x-llamapun" id="S4.p1.5.m5.1d">italic_j ∈ [ 1 . . italic_J ]</annotation></semantics></math>, given probabilities <math alttext="\hat{P}(X_{j})" class="ltx_Math" display="inline" id="S4.p1.6.m6.1"><semantics id="S4.p1.6.m6.1a"><mrow id="S4.p1.6.m6.1.1" xref="S4.p1.6.m6.1.1.cmml"><mover accent="true" id="S4.p1.6.m6.1.1.3" xref="S4.p1.6.m6.1.1.3.cmml"><mi id="S4.p1.6.m6.1.1.3.2" xref="S4.p1.6.m6.1.1.3.2.cmml">P</mi><mo id="S4.p1.6.m6.1.1.3.1" xref="S4.p1.6.m6.1.1.3.1.cmml">^</mo></mover><mo id="S4.p1.6.m6.1.1.2" xref="S4.p1.6.m6.1.1.2.cmml">⁢</mo><mrow id="S4.p1.6.m6.1.1.1.1" xref="S4.p1.6.m6.1.1.1.1.1.cmml"><mo id="S4.p1.6.m6.1.1.1.1.2" stretchy="false" xref="S4.p1.6.m6.1.1.1.1.1.cmml">(</mo><msub id="S4.p1.6.m6.1.1.1.1.1" xref="S4.p1.6.m6.1.1.1.1.1.cmml"><mi id="S4.p1.6.m6.1.1.1.1.1.2" xref="S4.p1.6.m6.1.1.1.1.1.2.cmml">X</mi><mi id="S4.p1.6.m6.1.1.1.1.1.3" xref="S4.p1.6.m6.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S4.p1.6.m6.1.1.1.1.3" stretchy="false" xref="S4.p1.6.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.6.m6.1b"><apply id="S4.p1.6.m6.1.1.cmml" xref="S4.p1.6.m6.1.1"><times id="S4.p1.6.m6.1.1.2.cmml" xref="S4.p1.6.m6.1.1.2"></times><apply id="S4.p1.6.m6.1.1.3.cmml" xref="S4.p1.6.m6.1.1.3"><ci id="S4.p1.6.m6.1.1.3.1.cmml" xref="S4.p1.6.m6.1.1.3.1">^</ci><ci id="S4.p1.6.m6.1.1.3.2.cmml" xref="S4.p1.6.m6.1.1.3.2">𝑃</ci></apply><apply id="S4.p1.6.m6.1.1.1.1.1.cmml" xref="S4.p1.6.m6.1.1.1.1"><csymbol cd="ambiguous" id="S4.p1.6.m6.1.1.1.1.1.1.cmml" xref="S4.p1.6.m6.1.1.1.1">subscript</csymbol><ci id="S4.p1.6.m6.1.1.1.1.1.2.cmml" xref="S4.p1.6.m6.1.1.1.1.1.2">𝑋</ci><ci id="S4.p1.6.m6.1.1.1.1.1.3.cmml" xref="S4.p1.6.m6.1.1.1.1.1.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.6.m6.1c">\hat{P}(X_{j})</annotation><annotation encoding="application/x-llamapun" id="S4.p1.6.m6.1d">over^ start_ARG italic_P end_ARG ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT )</annotation></semantics></math>, and then drawing a sample from a uniform distribution over <math alttext="X_{j}" class="ltx_Math" display="inline" id="S4.p1.7.m7.1"><semantics id="S4.p1.7.m7.1a"><msub id="S4.p1.7.m7.1.1" xref="S4.p1.7.m7.1.1.cmml"><mi id="S4.p1.7.m7.1.1.2" xref="S4.p1.7.m7.1.1.2.cmml">X</mi><mi id="S4.p1.7.m7.1.1.3" xref="S4.p1.7.m7.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p1.7.m7.1b"><apply id="S4.p1.7.m7.1.1.cmml" xref="S4.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.p1.7.m7.1.1.1.cmml" xref="S4.p1.7.m7.1.1">subscript</csymbol><ci id="S4.p1.7.m7.1.1.2.cmml" xref="S4.p1.7.m7.1.1.2">𝑋</ci><ci id="S4.p1.7.m7.1.1.3.cmml" xref="S4.p1.7.m7.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.7.m7.1c">X_{j}</annotation><annotation encoding="application/x-llamapun" id="S4.p1.7.m7.1d">italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.p2">
<p class="ltx_p" id="S4.p2.5">To fit a DET, <cite class="ltx_cite ltx_citemacro_citet">Ram &amp; Gray (<a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib24" title="">2011</a>)</cite> propose optimizing the Integrated Squared Error (ISE) between the data and model distributions which, following a similar approach to Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S3.SS1" title="3.1 Weak Learners ‣ 3 NRGBoost ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">3.1</span></a>, leads the following optimization problem when considering how to split a leaf node:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\max_{X_{L},X_{R}\in\mathcal{P}\left(X_{P}\right)}D(P(X_{L}),V(X_{L}))+D(P(X_{%
R}),V(X_{R}))-D(P(X_{P}),V(X_{P}))\,." class="ltx_Math" display="block" id="S4.E14.m1.4"><semantics id="S4.E14.m1.4a"><mrow id="S4.E14.m1.4.4.1" xref="S4.E14.m1.4.4.1.1.cmml"><mrow id="S4.E14.m1.4.4.1.1" xref="S4.E14.m1.4.4.1.1.cmml"><mrow id="S4.E14.m1.4.4.1.1.4" xref="S4.E14.m1.4.4.1.1.4.cmml"><mrow id="S4.E14.m1.4.4.1.1.2.2" xref="S4.E14.m1.4.4.1.1.2.2.cmml"><mrow id="S4.E14.m1.4.4.1.1.2.2.4" xref="S4.E14.m1.4.4.1.1.2.2.4.cmml"><munder id="S4.E14.m1.4.4.1.1.2.2.4.1" xref="S4.E14.m1.4.4.1.1.2.2.4.1.cmml"><mi id="S4.E14.m1.4.4.1.1.2.2.4.1.2" xref="S4.E14.m1.4.4.1.1.2.2.4.1.2.cmml">max</mi><mrow id="S4.E14.m1.3.3.3" xref="S4.E14.m1.3.3.3.cmml"><mrow id="S4.E14.m1.2.2.2.2.2" xref="S4.E14.m1.2.2.2.2.3.cmml"><msub id="S4.E14.m1.1.1.1.1.1.1" xref="S4.E14.m1.1.1.1.1.1.1.cmml"><mi id="S4.E14.m1.1.1.1.1.1.1.2" xref="S4.E14.m1.1.1.1.1.1.1.2.cmml">X</mi><mi id="S4.E14.m1.1.1.1.1.1.1.3" xref="S4.E14.m1.1.1.1.1.1.1.3.cmml">L</mi></msub><mo id="S4.E14.m1.2.2.2.2.2.3" xref="S4.E14.m1.2.2.2.2.3.cmml">,</mo><msub id="S4.E14.m1.2.2.2.2.2.2" xref="S4.E14.m1.2.2.2.2.2.2.cmml"><mi id="S4.E14.m1.2.2.2.2.2.2.2" xref="S4.E14.m1.2.2.2.2.2.2.2.cmml">X</mi><mi id="S4.E14.m1.2.2.2.2.2.2.3" xref="S4.E14.m1.2.2.2.2.2.2.3.cmml">R</mi></msub></mrow><mo id="S4.E14.m1.3.3.3.4" xref="S4.E14.m1.3.3.3.4.cmml">∈</mo><mrow id="S4.E14.m1.3.3.3.3" xref="S4.E14.m1.3.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E14.m1.3.3.3.3.3" xref="S4.E14.m1.3.3.3.3.3.cmml">𝒫</mi><mo id="S4.E14.m1.3.3.3.3.2" xref="S4.E14.m1.3.3.3.3.2.cmml">⁢</mo><mrow id="S4.E14.m1.3.3.3.3.1.1" xref="S4.E14.m1.3.3.3.3.1.1.1.cmml"><mo id="S4.E14.m1.3.3.3.3.1.1.2" xref="S4.E14.m1.3.3.3.3.1.1.1.cmml">(</mo><msub id="S4.E14.m1.3.3.3.3.1.1.1" xref="S4.E14.m1.3.3.3.3.1.1.1.cmml"><mi id="S4.E14.m1.3.3.3.3.1.1.1.2" xref="S4.E14.m1.3.3.3.3.1.1.1.2.cmml">X</mi><mi id="S4.E14.m1.3.3.3.3.1.1.1.3" xref="S4.E14.m1.3.3.3.3.1.1.1.3.cmml">P</mi></msub><mo id="S4.E14.m1.3.3.3.3.1.1.3" xref="S4.E14.m1.3.3.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow></munder><mo id="S4.E14.m1.4.4.1.1.2.2.4a" lspace="0.167em" xref="S4.E14.m1.4.4.1.1.2.2.4.cmml">⁡</mo><mi id="S4.E14.m1.4.4.1.1.2.2.4.2" xref="S4.E14.m1.4.4.1.1.2.2.4.2.cmml">D</mi></mrow><mo id="S4.E14.m1.4.4.1.1.2.2.3" xref="S4.E14.m1.4.4.1.1.2.2.3.cmml">⁢</mo><mrow id="S4.E14.m1.4.4.1.1.2.2.2.2" xref="S4.E14.m1.4.4.1.1.2.2.2.3.cmml"><mo id="S4.E14.m1.4.4.1.1.2.2.2.2.3" stretchy="false" xref="S4.E14.m1.4.4.1.1.2.2.2.3.cmml">(</mo><mrow id="S4.E14.m1.4.4.1.1.1.1.1.1.1" xref="S4.E14.m1.4.4.1.1.1.1.1.1.1.cmml"><mi id="S4.E14.m1.4.4.1.1.1.1.1.1.1.3" xref="S4.E14.m1.4.4.1.1.1.1.1.1.1.3.cmml">P</mi><mo id="S4.E14.m1.4.4.1.1.1.1.1.1.1.2" xref="S4.E14.m1.4.4.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E14.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S4.E14.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E14.m1.4.4.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E14.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E14.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S4.E14.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E14.m1.4.4.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E14.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml">X</mi><mi id="S4.E14.m1.4.4.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E14.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml">L</mi></msub><mo id="S4.E14.m1.4.4.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E14.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E14.m1.4.4.1.1.2.2.2.2.4" xref="S4.E14.m1.4.4.1.1.2.2.2.3.cmml">,</mo><mrow id="S4.E14.m1.4.4.1.1.2.2.2.2.2" xref="S4.E14.m1.4.4.1.1.2.2.2.2.2.cmml"><mi id="S4.E14.m1.4.4.1.1.2.2.2.2.2.3" xref="S4.E14.m1.4.4.1.1.2.2.2.2.2.3.cmml">V</mi><mo id="S4.E14.m1.4.4.1.1.2.2.2.2.2.2" xref="S4.E14.m1.4.4.1.1.2.2.2.2.2.2.cmml">⁢</mo><mrow id="S4.E14.m1.4.4.1.1.2.2.2.2.2.1.1" xref="S4.E14.m1.4.4.1.1.2.2.2.2.2.1.1.1.cmml"><mo id="S4.E14.m1.4.4.1.1.2.2.2.2.2.1.1.2" stretchy="false" xref="S4.E14.m1.4.4.1.1.2.2.2.2.2.1.1.1.cmml">(</mo><msub id="S4.E14.m1.4.4.1.1.2.2.2.2.2.1.1.1" xref="S4.E14.m1.4.4.1.1.2.2.2.2.2.1.1.1.cmml"><mi id="S4.E14.m1.4.4.1.1.2.2.2.2.2.1.1.1.2" xref="S4.E14.m1.4.4.1.1.2.2.2.2.2.1.1.1.2.cmml">X</mi><mi id="S4.E14.m1.4.4.1.1.2.2.2.2.2.1.1.1.3" xref="S4.E14.m1.4.4.1.1.2.2.2.2.2.1.1.1.3.cmml">L</mi></msub><mo id="S4.E14.m1.4.4.1.1.2.2.2.2.2.1.1.3" stretchy="false" xref="S4.E14.m1.4.4.1.1.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E14.m1.4.4.1.1.2.2.2.2.5" stretchy="false" xref="S4.E14.m1.4.4.1.1.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E14.m1.4.4.1.1.4.5" xref="S4.E14.m1.4.4.1.1.4.5.cmml">+</mo><mrow id="S4.E14.m1.4.4.1.1.4.4" xref="S4.E14.m1.4.4.1.1.4.4.cmml"><mi id="S4.E14.m1.4.4.1.1.4.4.4" xref="S4.E14.m1.4.4.1.1.4.4.4.cmml">D</mi><mo id="S4.E14.m1.4.4.1.1.4.4.3" xref="S4.E14.m1.4.4.1.1.4.4.3.cmml">⁢</mo><mrow id="S4.E14.m1.4.4.1.1.4.4.2.2" xref="S4.E14.m1.4.4.1.1.4.4.2.3.cmml"><mo id="S4.E14.m1.4.4.1.1.4.4.2.2.3" stretchy="false" xref="S4.E14.m1.4.4.1.1.4.4.2.3.cmml">(</mo><mrow id="S4.E14.m1.4.4.1.1.3.3.1.1.1" xref="S4.E14.m1.4.4.1.1.3.3.1.1.1.cmml"><mi id="S4.E14.m1.4.4.1.1.3.3.1.1.1.3" xref="S4.E14.m1.4.4.1.1.3.3.1.1.1.3.cmml">P</mi><mo id="S4.E14.m1.4.4.1.1.3.3.1.1.1.2" xref="S4.E14.m1.4.4.1.1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S4.E14.m1.4.4.1.1.3.3.1.1.1.1.1" xref="S4.E14.m1.4.4.1.1.3.3.1.1.1.1.1.1.cmml"><mo id="S4.E14.m1.4.4.1.1.3.3.1.1.1.1.1.2" stretchy="false" xref="S4.E14.m1.4.4.1.1.3.3.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E14.m1.4.4.1.1.3.3.1.1.1.1.1.1" xref="S4.E14.m1.4.4.1.1.3.3.1.1.1.1.1.1.cmml"><mi id="S4.E14.m1.4.4.1.1.3.3.1.1.1.1.1.1.2" xref="S4.E14.m1.4.4.1.1.3.3.1.1.1.1.1.1.2.cmml">X</mi><mi id="S4.E14.m1.4.4.1.1.3.3.1.1.1.1.1.1.3" xref="S4.E14.m1.4.4.1.1.3.3.1.1.1.1.1.1.3.cmml">R</mi></msub><mo id="S4.E14.m1.4.4.1.1.3.3.1.1.1.1.1.3" stretchy="false" xref="S4.E14.m1.4.4.1.1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E14.m1.4.4.1.1.4.4.2.2.4" xref="S4.E14.m1.4.4.1.1.4.4.2.3.cmml">,</mo><mrow id="S4.E14.m1.4.4.1.1.4.4.2.2.2" xref="S4.E14.m1.4.4.1.1.4.4.2.2.2.cmml"><mi id="S4.E14.m1.4.4.1.1.4.4.2.2.2.3" xref="S4.E14.m1.4.4.1.1.4.4.2.2.2.3.cmml">V</mi><mo id="S4.E14.m1.4.4.1.1.4.4.2.2.2.2" xref="S4.E14.m1.4.4.1.1.4.4.2.2.2.2.cmml">⁢</mo><mrow id="S4.E14.m1.4.4.1.1.4.4.2.2.2.1.1" xref="S4.E14.m1.4.4.1.1.4.4.2.2.2.1.1.1.cmml"><mo id="S4.E14.m1.4.4.1.1.4.4.2.2.2.1.1.2" stretchy="false" xref="S4.E14.m1.4.4.1.1.4.4.2.2.2.1.1.1.cmml">(</mo><msub id="S4.E14.m1.4.4.1.1.4.4.2.2.2.1.1.1" xref="S4.E14.m1.4.4.1.1.4.4.2.2.2.1.1.1.cmml"><mi id="S4.E14.m1.4.4.1.1.4.4.2.2.2.1.1.1.2" xref="S4.E14.m1.4.4.1.1.4.4.2.2.2.1.1.1.2.cmml">X</mi><mi id="S4.E14.m1.4.4.1.1.4.4.2.2.2.1.1.1.3" xref="S4.E14.m1.4.4.1.1.4.4.2.2.2.1.1.1.3.cmml">R</mi></msub><mo id="S4.E14.m1.4.4.1.1.4.4.2.2.2.1.1.3" stretchy="false" xref="S4.E14.m1.4.4.1.1.4.4.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E14.m1.4.4.1.1.4.4.2.2.5" stretchy="false" xref="S4.E14.m1.4.4.1.1.4.4.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E14.m1.4.4.1.1.7" xref="S4.E14.m1.4.4.1.1.7.cmml">−</mo><mrow id="S4.E14.m1.4.4.1.1.6" xref="S4.E14.m1.4.4.1.1.6.cmml"><mi id="S4.E14.m1.4.4.1.1.6.4" xref="S4.E14.m1.4.4.1.1.6.4.cmml">D</mi><mo id="S4.E14.m1.4.4.1.1.6.3" xref="S4.E14.m1.4.4.1.1.6.3.cmml">⁢</mo><mrow id="S4.E14.m1.4.4.1.1.6.2.2" xref="S4.E14.m1.4.4.1.1.6.2.3.cmml"><mo id="S4.E14.m1.4.4.1.1.6.2.2.3" stretchy="false" xref="S4.E14.m1.4.4.1.1.6.2.3.cmml">(</mo><mrow id="S4.E14.m1.4.4.1.1.5.1.1.1" xref="S4.E14.m1.4.4.1.1.5.1.1.1.cmml"><mi id="S4.E14.m1.4.4.1.1.5.1.1.1.3" xref="S4.E14.m1.4.4.1.1.5.1.1.1.3.cmml">P</mi><mo id="S4.E14.m1.4.4.1.1.5.1.1.1.2" xref="S4.E14.m1.4.4.1.1.5.1.1.1.2.cmml">⁢</mo><mrow id="S4.E14.m1.4.4.1.1.5.1.1.1.1.1" xref="S4.E14.m1.4.4.1.1.5.1.1.1.1.1.1.cmml"><mo id="S4.E14.m1.4.4.1.1.5.1.1.1.1.1.2" stretchy="false" xref="S4.E14.m1.4.4.1.1.5.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E14.m1.4.4.1.1.5.1.1.1.1.1.1" xref="S4.E14.m1.4.4.1.1.5.1.1.1.1.1.1.cmml"><mi id="S4.E14.m1.4.4.1.1.5.1.1.1.1.1.1.2" xref="S4.E14.m1.4.4.1.1.5.1.1.1.1.1.1.2.cmml">X</mi><mi id="S4.E14.m1.4.4.1.1.5.1.1.1.1.1.1.3" xref="S4.E14.m1.4.4.1.1.5.1.1.1.1.1.1.3.cmml">P</mi></msub><mo id="S4.E14.m1.4.4.1.1.5.1.1.1.1.1.3" stretchy="false" xref="S4.E14.m1.4.4.1.1.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E14.m1.4.4.1.1.6.2.2.4" xref="S4.E14.m1.4.4.1.1.6.2.3.cmml">,</mo><mrow id="S4.E14.m1.4.4.1.1.6.2.2.2" xref="S4.E14.m1.4.4.1.1.6.2.2.2.cmml"><mi id="S4.E14.m1.4.4.1.1.6.2.2.2.3" xref="S4.E14.m1.4.4.1.1.6.2.2.2.3.cmml">V</mi><mo id="S4.E14.m1.4.4.1.1.6.2.2.2.2" xref="S4.E14.m1.4.4.1.1.6.2.2.2.2.cmml">⁢</mo><mrow id="S4.E14.m1.4.4.1.1.6.2.2.2.1.1" xref="S4.E14.m1.4.4.1.1.6.2.2.2.1.1.1.cmml"><mo id="S4.E14.m1.4.4.1.1.6.2.2.2.1.1.2" stretchy="false" xref="S4.E14.m1.4.4.1.1.6.2.2.2.1.1.1.cmml">(</mo><msub id="S4.E14.m1.4.4.1.1.6.2.2.2.1.1.1" xref="S4.E14.m1.4.4.1.1.6.2.2.2.1.1.1.cmml"><mi id="S4.E14.m1.4.4.1.1.6.2.2.2.1.1.1.2" xref="S4.E14.m1.4.4.1.1.6.2.2.2.1.1.1.2.cmml">X</mi><mi id="S4.E14.m1.4.4.1.1.6.2.2.2.1.1.1.3" xref="S4.E14.m1.4.4.1.1.6.2.2.2.1.1.1.3.cmml">P</mi></msub><mo id="S4.E14.m1.4.4.1.1.6.2.2.2.1.1.3" stretchy="false" xref="S4.E14.m1.4.4.1.1.6.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E14.m1.4.4.1.1.6.2.2.5" stretchy="false" xref="S4.E14.m1.4.4.1.1.6.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E14.m1.4.4.1.2" lspace="0.170em" xref="S4.E14.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E14.m1.4b"><apply id="S4.E14.m1.4.4.1.1.cmml" xref="S4.E14.m1.4.4.1"><minus id="S4.E14.m1.4.4.1.1.7.cmml" xref="S4.E14.m1.4.4.1.1.7"></minus><apply id="S4.E14.m1.4.4.1.1.4.cmml" xref="S4.E14.m1.4.4.1.1.4"><plus id="S4.E14.m1.4.4.1.1.4.5.cmml" xref="S4.E14.m1.4.4.1.1.4.5"></plus><apply id="S4.E14.m1.4.4.1.1.2.2.cmml" xref="S4.E14.m1.4.4.1.1.2.2"><times id="S4.E14.m1.4.4.1.1.2.2.3.cmml" xref="S4.E14.m1.4.4.1.1.2.2.3"></times><apply id="S4.E14.m1.4.4.1.1.2.2.4.cmml" xref="S4.E14.m1.4.4.1.1.2.2.4"><apply id="S4.E14.m1.4.4.1.1.2.2.4.1.cmml" xref="S4.E14.m1.4.4.1.1.2.2.4.1"><csymbol cd="ambiguous" id="S4.E14.m1.4.4.1.1.2.2.4.1.1.cmml" xref="S4.E14.m1.4.4.1.1.2.2.4.1">subscript</csymbol><max id="S4.E14.m1.4.4.1.1.2.2.4.1.2.cmml" xref="S4.E14.m1.4.4.1.1.2.2.4.1.2"></max><apply id="S4.E14.m1.3.3.3.cmml" xref="S4.E14.m1.3.3.3"><in id="S4.E14.m1.3.3.3.4.cmml" xref="S4.E14.m1.3.3.3.4"></in><list id="S4.E14.m1.2.2.2.2.3.cmml" xref="S4.E14.m1.2.2.2.2.2"><apply id="S4.E14.m1.1.1.1.1.1.1.cmml" xref="S4.E14.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.1.1.1.cmml" xref="S4.E14.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E14.m1.1.1.1.1.1.1.2.cmml" xref="S4.E14.m1.1.1.1.1.1.1.2">𝑋</ci><ci id="S4.E14.m1.1.1.1.1.1.1.3.cmml" xref="S4.E14.m1.1.1.1.1.1.1.3">𝐿</ci></apply><apply id="S4.E14.m1.2.2.2.2.2.2.cmml" xref="S4.E14.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E14.m1.2.2.2.2.2.2.1.cmml" xref="S4.E14.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E14.m1.2.2.2.2.2.2.2.cmml" xref="S4.E14.m1.2.2.2.2.2.2.2">𝑋</ci><ci id="S4.E14.m1.2.2.2.2.2.2.3.cmml" xref="S4.E14.m1.2.2.2.2.2.2.3">𝑅</ci></apply></list><apply id="S4.E14.m1.3.3.3.3.cmml" xref="S4.E14.m1.3.3.3.3"><times id="S4.E14.m1.3.3.3.3.2.cmml" xref="S4.E14.m1.3.3.3.3.2"></times><ci id="S4.E14.m1.3.3.3.3.3.cmml" xref="S4.E14.m1.3.3.3.3.3">𝒫</ci><apply id="S4.E14.m1.3.3.3.3.1.1.1.cmml" xref="S4.E14.m1.3.3.3.3.1.1"><csymbol cd="ambiguous" id="S4.E14.m1.3.3.3.3.1.1.1.1.cmml" xref="S4.E14.m1.3.3.3.3.1.1">subscript</csymbol><ci id="S4.E14.m1.3.3.3.3.1.1.1.2.cmml" xref="S4.E14.m1.3.3.3.3.1.1.1.2">𝑋</ci><ci id="S4.E14.m1.3.3.3.3.1.1.1.3.cmml" xref="S4.E14.m1.3.3.3.3.1.1.1.3">𝑃</ci></apply></apply></apply></apply><ci id="S4.E14.m1.4.4.1.1.2.2.4.2.cmml" xref="S4.E14.m1.4.4.1.1.2.2.4.2">𝐷</ci></apply><interval closure="open" id="S4.E14.m1.4.4.1.1.2.2.2.3.cmml" xref="S4.E14.m1.4.4.1.1.2.2.2.2"><apply id="S4.E14.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S4.E14.m1.4.4.1.1.1.1.1.1.1"><times id="S4.E14.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S4.E14.m1.4.4.1.1.1.1.1.1.1.2"></times><ci id="S4.E14.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="S4.E14.m1.4.4.1.1.1.1.1.1.1.3">𝑃</ci><apply id="S4.E14.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E14.m1.4.4.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E14.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E14.m1.4.4.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E14.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E14.m1.4.4.1.1.1.1.1.1.1.1.1.1.2">𝑋</ci><ci id="S4.E14.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E14.m1.4.4.1.1.1.1.1.1.1.1.1.1.3">𝐿</ci></apply></apply><apply id="S4.E14.m1.4.4.1.1.2.2.2.2.2.cmml" xref="S4.E14.m1.4.4.1.1.2.2.2.2.2"><times id="S4.E14.m1.4.4.1.1.2.2.2.2.2.2.cmml" xref="S4.E14.m1.4.4.1.1.2.2.2.2.2.2"></times><ci id="S4.E14.m1.4.4.1.1.2.2.2.2.2.3.cmml" xref="S4.E14.m1.4.4.1.1.2.2.2.2.2.3">𝑉</ci><apply id="S4.E14.m1.4.4.1.1.2.2.2.2.2.1.1.1.cmml" xref="S4.E14.m1.4.4.1.1.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.E14.m1.4.4.1.1.2.2.2.2.2.1.1.1.1.cmml" xref="S4.E14.m1.4.4.1.1.2.2.2.2.2.1.1">subscript</csymbol><ci id="S4.E14.m1.4.4.1.1.2.2.2.2.2.1.1.1.2.cmml" xref="S4.E14.m1.4.4.1.1.2.2.2.2.2.1.1.1.2">𝑋</ci><ci id="S4.E14.m1.4.4.1.1.2.2.2.2.2.1.1.1.3.cmml" xref="S4.E14.m1.4.4.1.1.2.2.2.2.2.1.1.1.3">𝐿</ci></apply></apply></interval></apply><apply id="S4.E14.m1.4.4.1.1.4.4.cmml" xref="S4.E14.m1.4.4.1.1.4.4"><times id="S4.E14.m1.4.4.1.1.4.4.3.cmml" xref="S4.E14.m1.4.4.1.1.4.4.3"></times><ci id="S4.E14.m1.4.4.1.1.4.4.4.cmml" xref="S4.E14.m1.4.4.1.1.4.4.4">𝐷</ci><interval closure="open" id="S4.E14.m1.4.4.1.1.4.4.2.3.cmml" xref="S4.E14.m1.4.4.1.1.4.4.2.2"><apply id="S4.E14.m1.4.4.1.1.3.3.1.1.1.cmml" xref="S4.E14.m1.4.4.1.1.3.3.1.1.1"><times id="S4.E14.m1.4.4.1.1.3.3.1.1.1.2.cmml" xref="S4.E14.m1.4.4.1.1.3.3.1.1.1.2"></times><ci id="S4.E14.m1.4.4.1.1.3.3.1.1.1.3.cmml" xref="S4.E14.m1.4.4.1.1.3.3.1.1.1.3">𝑃</ci><apply id="S4.E14.m1.4.4.1.1.3.3.1.1.1.1.1.1.cmml" xref="S4.E14.m1.4.4.1.1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E14.m1.4.4.1.1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E14.m1.4.4.1.1.3.3.1.1.1.1.1">subscript</csymbol><ci id="S4.E14.m1.4.4.1.1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E14.m1.4.4.1.1.3.3.1.1.1.1.1.1.2">𝑋</ci><ci id="S4.E14.m1.4.4.1.1.3.3.1.1.1.1.1.1.3.cmml" xref="S4.E14.m1.4.4.1.1.3.3.1.1.1.1.1.1.3">𝑅</ci></apply></apply><apply id="S4.E14.m1.4.4.1.1.4.4.2.2.2.cmml" xref="S4.E14.m1.4.4.1.1.4.4.2.2.2"><times id="S4.E14.m1.4.4.1.1.4.4.2.2.2.2.cmml" xref="S4.E14.m1.4.4.1.1.4.4.2.2.2.2"></times><ci id="S4.E14.m1.4.4.1.1.4.4.2.2.2.3.cmml" xref="S4.E14.m1.4.4.1.1.4.4.2.2.2.3">𝑉</ci><apply id="S4.E14.m1.4.4.1.1.4.4.2.2.2.1.1.1.cmml" xref="S4.E14.m1.4.4.1.1.4.4.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.E14.m1.4.4.1.1.4.4.2.2.2.1.1.1.1.cmml" xref="S4.E14.m1.4.4.1.1.4.4.2.2.2.1.1">subscript</csymbol><ci id="S4.E14.m1.4.4.1.1.4.4.2.2.2.1.1.1.2.cmml" xref="S4.E14.m1.4.4.1.1.4.4.2.2.2.1.1.1.2">𝑋</ci><ci id="S4.E14.m1.4.4.1.1.4.4.2.2.2.1.1.1.3.cmml" xref="S4.E14.m1.4.4.1.1.4.4.2.2.2.1.1.1.3">𝑅</ci></apply></apply></interval></apply></apply><apply id="S4.E14.m1.4.4.1.1.6.cmml" xref="S4.E14.m1.4.4.1.1.6"><times id="S4.E14.m1.4.4.1.1.6.3.cmml" xref="S4.E14.m1.4.4.1.1.6.3"></times><ci id="S4.E14.m1.4.4.1.1.6.4.cmml" xref="S4.E14.m1.4.4.1.1.6.4">𝐷</ci><interval closure="open" id="S4.E14.m1.4.4.1.1.6.2.3.cmml" xref="S4.E14.m1.4.4.1.1.6.2.2"><apply id="S4.E14.m1.4.4.1.1.5.1.1.1.cmml" xref="S4.E14.m1.4.4.1.1.5.1.1.1"><times id="S4.E14.m1.4.4.1.1.5.1.1.1.2.cmml" xref="S4.E14.m1.4.4.1.1.5.1.1.1.2"></times><ci id="S4.E14.m1.4.4.1.1.5.1.1.1.3.cmml" xref="S4.E14.m1.4.4.1.1.5.1.1.1.3">𝑃</ci><apply id="S4.E14.m1.4.4.1.1.5.1.1.1.1.1.1.cmml" xref="S4.E14.m1.4.4.1.1.5.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E14.m1.4.4.1.1.5.1.1.1.1.1.1.1.cmml" xref="S4.E14.m1.4.4.1.1.5.1.1.1.1.1">subscript</csymbol><ci id="S4.E14.m1.4.4.1.1.5.1.1.1.1.1.1.2.cmml" xref="S4.E14.m1.4.4.1.1.5.1.1.1.1.1.1.2">𝑋</ci><ci id="S4.E14.m1.4.4.1.1.5.1.1.1.1.1.1.3.cmml" xref="S4.E14.m1.4.4.1.1.5.1.1.1.1.1.1.3">𝑃</ci></apply></apply><apply id="S4.E14.m1.4.4.1.1.6.2.2.2.cmml" xref="S4.E14.m1.4.4.1.1.6.2.2.2"><times id="S4.E14.m1.4.4.1.1.6.2.2.2.2.cmml" xref="S4.E14.m1.4.4.1.1.6.2.2.2.2"></times><ci id="S4.E14.m1.4.4.1.1.6.2.2.2.3.cmml" xref="S4.E14.m1.4.4.1.1.6.2.2.2.3">𝑉</ci><apply id="S4.E14.m1.4.4.1.1.6.2.2.2.1.1.1.cmml" xref="S4.E14.m1.4.4.1.1.6.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.E14.m1.4.4.1.1.6.2.2.2.1.1.1.1.cmml" xref="S4.E14.m1.4.4.1.1.6.2.2.2.1.1">subscript</csymbol><ci id="S4.E14.m1.4.4.1.1.6.2.2.2.1.1.1.2.cmml" xref="S4.E14.m1.4.4.1.1.6.2.2.2.1.1.1.2">𝑋</ci><ci id="S4.E14.m1.4.4.1.1.6.2.2.2.1.1.1.3.cmml" xref="S4.E14.m1.4.4.1.1.6.2.2.2.1.1.1.3">𝑃</ci></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E14.m1.4c">\max_{X_{L},X_{R}\in\mathcal{P}\left(X_{P}\right)}D(P(X_{L}),V(X_{L}))+D(P(X_{%
R}),V(X_{R}))-D(P(X_{P}),V(X_{P}))\,.</annotation><annotation encoding="application/x-llamapun" id="S4.E14.m1.4d">roman_max start_POSTSUBSCRIPT italic_X start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT , italic_X start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ∈ caligraphic_P ( italic_X start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT italic_D ( italic_P ( italic_X start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT ) , italic_V ( italic_X start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT ) ) + italic_D ( italic_P ( italic_X start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ) , italic_V ( italic_X start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ) ) - italic_D ( italic_P ( italic_X start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT ) , italic_V ( italic_X start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT ) ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.p2.4">For the ISE, <math alttext="D" class="ltx_Math" display="inline" id="S4.p2.1.m1.1"><semantics id="S4.p2.1.m1.1a"><mi id="S4.p2.1.m1.1.1" xref="S4.p2.1.m1.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S4.p2.1.m1.1b"><ci id="S4.p2.1.m1.1.1.cmml" xref="S4.p2.1.m1.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.1.m1.1c">D</annotation><annotation encoding="application/x-llamapun" id="S4.p2.1.m1.1d">italic_D</annotation></semantics></math> should be taken as the function <math alttext="D_{ISE}(P,V)=\nicefrac{{P^{2}}}{{V}}" class="ltx_Math" display="inline" id="S4.p2.2.m2.2"><semantics id="S4.p2.2.m2.2a"><mrow id="S4.p2.2.m2.2.3" xref="S4.p2.2.m2.2.3.cmml"><mrow id="S4.p2.2.m2.2.3.2" xref="S4.p2.2.m2.2.3.2.cmml"><msub id="S4.p2.2.m2.2.3.2.2" xref="S4.p2.2.m2.2.3.2.2.cmml"><mi id="S4.p2.2.m2.2.3.2.2.2" xref="S4.p2.2.m2.2.3.2.2.2.cmml">D</mi><mrow id="S4.p2.2.m2.2.3.2.2.3" xref="S4.p2.2.m2.2.3.2.2.3.cmml"><mi id="S4.p2.2.m2.2.3.2.2.3.2" xref="S4.p2.2.m2.2.3.2.2.3.2.cmml">I</mi><mo id="S4.p2.2.m2.2.3.2.2.3.1" xref="S4.p2.2.m2.2.3.2.2.3.1.cmml">⁢</mo><mi id="S4.p2.2.m2.2.3.2.2.3.3" xref="S4.p2.2.m2.2.3.2.2.3.3.cmml">S</mi><mo id="S4.p2.2.m2.2.3.2.2.3.1a" xref="S4.p2.2.m2.2.3.2.2.3.1.cmml">⁢</mo><mi id="S4.p2.2.m2.2.3.2.2.3.4" xref="S4.p2.2.m2.2.3.2.2.3.4.cmml">E</mi></mrow></msub><mo id="S4.p2.2.m2.2.3.2.1" xref="S4.p2.2.m2.2.3.2.1.cmml">⁢</mo><mrow id="S4.p2.2.m2.2.3.2.3.2" xref="S4.p2.2.m2.2.3.2.3.1.cmml"><mo id="S4.p2.2.m2.2.3.2.3.2.1" stretchy="false" xref="S4.p2.2.m2.2.3.2.3.1.cmml">(</mo><mi id="S4.p2.2.m2.1.1" xref="S4.p2.2.m2.1.1.cmml">P</mi><mo id="S4.p2.2.m2.2.3.2.3.2.2" xref="S4.p2.2.m2.2.3.2.3.1.cmml">,</mo><mi id="S4.p2.2.m2.2.2" xref="S4.p2.2.m2.2.2.cmml">V</mi><mo id="S4.p2.2.m2.2.3.2.3.2.3" stretchy="false" xref="S4.p2.2.m2.2.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="S4.p2.2.m2.2.3.1" xref="S4.p2.2.m2.2.3.1.cmml">=</mo><mrow id="S4.p2.2.m2.2.3.3" xref="S4.p2.2.m2.2.3.3.cmml"><mpadded id="S4.p2.2.m2.2.3.3.2" voffset="0.3em" xref="S4.p2.2.m2.2.3.3.2.cmml"><msup id="S4.p2.2.m2.2.3.3.2a" xref="S4.p2.2.m2.2.3.3.2.cmml"><mi id="S4.p2.2.m2.2.3.3.2.2" mathsize="70%" xref="S4.p2.2.m2.2.3.3.2.2.cmml">P</mi><mn id="S4.p2.2.m2.2.3.3.2.3" mathsize="71%" xref="S4.p2.2.m2.2.3.3.2.3.cmml">2</mn></msup></mpadded><mpadded id="S4.p2.2.m2.2.3.3.1" lspace="-0.1em" width="-0.15em" xref="S4.p2.2.m2.2.3.3.1.cmml"><mo id="S4.p2.2.m2.2.3.3.1a" stretchy="true" symmetric="true" xref="S4.p2.2.m2.2.3.3.1.cmml">/</mo></mpadded><mi id="S4.p2.2.m2.2.3.3.3" mathsize="70%" xref="S4.p2.2.m2.2.3.3.3.cmml">V</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.2.m2.2b"><apply id="S4.p2.2.m2.2.3.cmml" xref="S4.p2.2.m2.2.3"><eq id="S4.p2.2.m2.2.3.1.cmml" xref="S4.p2.2.m2.2.3.1"></eq><apply id="S4.p2.2.m2.2.3.2.cmml" xref="S4.p2.2.m2.2.3.2"><times id="S4.p2.2.m2.2.3.2.1.cmml" xref="S4.p2.2.m2.2.3.2.1"></times><apply id="S4.p2.2.m2.2.3.2.2.cmml" xref="S4.p2.2.m2.2.3.2.2"><csymbol cd="ambiguous" id="S4.p2.2.m2.2.3.2.2.1.cmml" xref="S4.p2.2.m2.2.3.2.2">subscript</csymbol><ci id="S4.p2.2.m2.2.3.2.2.2.cmml" xref="S4.p2.2.m2.2.3.2.2.2">𝐷</ci><apply id="S4.p2.2.m2.2.3.2.2.3.cmml" xref="S4.p2.2.m2.2.3.2.2.3"><times id="S4.p2.2.m2.2.3.2.2.3.1.cmml" xref="S4.p2.2.m2.2.3.2.2.3.1"></times><ci id="S4.p2.2.m2.2.3.2.2.3.2.cmml" xref="S4.p2.2.m2.2.3.2.2.3.2">𝐼</ci><ci id="S4.p2.2.m2.2.3.2.2.3.3.cmml" xref="S4.p2.2.m2.2.3.2.2.3.3">𝑆</ci><ci id="S4.p2.2.m2.2.3.2.2.3.4.cmml" xref="S4.p2.2.m2.2.3.2.2.3.4">𝐸</ci></apply></apply><interval closure="open" id="S4.p2.2.m2.2.3.2.3.1.cmml" xref="S4.p2.2.m2.2.3.2.3.2"><ci id="S4.p2.2.m2.1.1.cmml" xref="S4.p2.2.m2.1.1">𝑃</ci><ci id="S4.p2.2.m2.2.2.cmml" xref="S4.p2.2.m2.2.2">𝑉</ci></interval></apply><apply id="S4.p2.2.m2.2.3.3.cmml" xref="S4.p2.2.m2.2.3.3"><divide id="S4.p2.2.m2.2.3.3.1.cmml" xref="S4.p2.2.m2.2.3.3.1"></divide><apply id="S4.p2.2.m2.2.3.3.2.cmml" xref="S4.p2.2.m2.2.3.3.2"><csymbol cd="ambiguous" id="S4.p2.2.m2.2.3.3.2.1.cmml" xref="S4.p2.2.m2.2.3.3.2">superscript</csymbol><ci id="S4.p2.2.m2.2.3.3.2.2.cmml" xref="S4.p2.2.m2.2.3.3.2.2">𝑃</ci><cn id="S4.p2.2.m2.2.3.3.2.3.cmml" type="integer" xref="S4.p2.2.m2.2.3.3.2.3">2</cn></apply><ci id="S4.p2.2.m2.2.3.3.3.cmml" xref="S4.p2.2.m2.2.3.3.3">𝑉</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.2.m2.2c">D_{ISE}(P,V)=\nicefrac{{P^{2}}}{{V}}</annotation><annotation encoding="application/x-llamapun" id="S4.p2.2.m2.2d">italic_D start_POSTSUBSCRIPT italic_I italic_S italic_E end_POSTSUBSCRIPT ( italic_P , italic_V ) = / start_ARG italic_P start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_V end_ARG</annotation></semantics></math>
which leads to a similar splitting criterion to Equation <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S4.E14" title="In 4 Density Estimation Trees and Density Estimation Forests ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">14</span></a> but replacing the previous model’s distribution with the volume measure <math alttext="V" class="ltx_Math" display="inline" id="S4.p2.3.m3.1"><semantics id="S4.p2.3.m3.1a"><mi id="S4.p2.3.m3.1.1" xref="S4.p2.3.m3.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S4.p2.3.m3.1b"><ci id="S4.p2.3.m3.1.1.cmml" xref="S4.p2.3.m3.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.3.m3.1c">V</annotation><annotation encoding="application/x-llamapun" id="S4.p2.3.m3.1d">italic_V</annotation></semantics></math> which can be interpreted as the uniform distribution on <math alttext="\mathcal{X}" class="ltx_Math" display="inline" id="S4.p2.4.m4.1"><semantics id="S4.p2.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S4.p2.4.m4.1.1" xref="S4.p2.4.m4.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="S4.p2.4.m4.1b"><ci id="S4.p2.4.m4.1.1.cmml" xref="S4.p2.4.m4.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.4.m4.1c">\mathcal{X}</annotation><annotation encoding="application/x-llamapun" id="S4.p2.4.m4.1d">caligraphic_X</annotation></semantics></math> (up to a multiplicative constant).</p>
</div>
<section class="ltx_paragraph" id="S4.SS0.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Maximum Likelihood</h5>
<div class="ltx_para ltx_noindent" id="S4.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS0.SSS0.Px1.p1.2">Often generative models are trained to
maximize the likelihood of the observed data.
This was left for future work in <cite class="ltx_cite ltx_citemacro_citet">Ram &amp; Gray (<a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib24" title="">2011</a>)</cite> but, as we show in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A2" title="Appendix B Density Estimation Trees ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">B</span></a>, can be accomplished by replacing <math alttext="D_{ISE}" class="ltx_Math" display="inline" id="S4.SS0.SSS0.Px1.p1.1.m1.1"><semantics id="S4.SS0.SSS0.Px1.p1.1.m1.1a"><msub id="S4.SS0.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml">D</mi><mrow id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.3" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml"><mi id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.3.2" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.3.2.cmml">I</mi><mo id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.3.1" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.3.3" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.cmml">S</mi><mo id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.3.1a" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.3.4" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.3.4.cmml">E</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px1.p1.1.m1.1b"><apply id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2">𝐷</ci><apply id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.3"><times id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.3.1.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.3.1"></times><ci id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.3.2.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.3.2">𝐼</ci><ci id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.3.3">𝑆</ci><ci id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.3.4.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.3.4">𝐸</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px1.p1.1.m1.1c">D_{ISE}</annotation><annotation encoding="application/x-llamapun" id="S4.SS0.SSS0.Px1.p1.1.m1.1d">italic_D start_POSTSUBSCRIPT italic_I italic_S italic_E end_POSTSUBSCRIPT</annotation></semantics></math> with <math alttext="D_{KL}(P,V)=P\,\log\left(\nicefrac{{P}}{{V}}\right)" class="ltx_Math" display="inline" id="S4.SS0.SSS0.Px1.p1.2.m2.4"><semantics id="S4.SS0.SSS0.Px1.p1.2.m2.4a"><mrow id="S4.SS0.SSS0.Px1.p1.2.m2.4.5" xref="S4.SS0.SSS0.Px1.p1.2.m2.4.5.cmml"><mrow id="S4.SS0.SSS0.Px1.p1.2.m2.4.5.2" xref="S4.SS0.SSS0.Px1.p1.2.m2.4.5.2.cmml"><msub id="S4.SS0.SSS0.Px1.p1.2.m2.4.5.2.2" xref="S4.SS0.SSS0.Px1.p1.2.m2.4.5.2.2.cmml"><mi id="S4.SS0.SSS0.Px1.p1.2.m2.4.5.2.2.2" xref="S4.SS0.SSS0.Px1.p1.2.m2.4.5.2.2.2.cmml">D</mi><mrow id="S4.SS0.SSS0.Px1.p1.2.m2.4.5.2.2.3" xref="S4.SS0.SSS0.Px1.p1.2.m2.4.5.2.2.3.cmml"><mi id="S4.SS0.SSS0.Px1.p1.2.m2.4.5.2.2.3.2" xref="S4.SS0.SSS0.Px1.p1.2.m2.4.5.2.2.3.2.cmml">K</mi><mo id="S4.SS0.SSS0.Px1.p1.2.m2.4.5.2.2.3.1" xref="S4.SS0.SSS0.Px1.p1.2.m2.4.5.2.2.3.1.cmml">⁢</mo><mi id="S4.SS0.SSS0.Px1.p1.2.m2.4.5.2.2.3.3" xref="S4.SS0.SSS0.Px1.p1.2.m2.4.5.2.2.3.3.cmml">L</mi></mrow></msub><mo id="S4.SS0.SSS0.Px1.p1.2.m2.4.5.2.1" xref="S4.SS0.SSS0.Px1.p1.2.m2.4.5.2.1.cmml">⁢</mo><mrow id="S4.SS0.SSS0.Px1.p1.2.m2.4.5.2.3.2" xref="S4.SS0.SSS0.Px1.p1.2.m2.4.5.2.3.1.cmml"><mo id="S4.SS0.SSS0.Px1.p1.2.m2.4.5.2.3.2.1" stretchy="false" xref="S4.SS0.SSS0.Px1.p1.2.m2.4.5.2.3.1.cmml">(</mo><mi id="S4.SS0.SSS0.Px1.p1.2.m2.1.1" xref="S4.SS0.SSS0.Px1.p1.2.m2.1.1.cmml">P</mi><mo id="S4.SS0.SSS0.Px1.p1.2.m2.4.5.2.3.2.2" xref="S4.SS0.SSS0.Px1.p1.2.m2.4.5.2.3.1.cmml">,</mo><mi id="S4.SS0.SSS0.Px1.p1.2.m2.2.2" xref="S4.SS0.SSS0.Px1.p1.2.m2.2.2.cmml">V</mi><mo id="S4.SS0.SSS0.Px1.p1.2.m2.4.5.2.3.2.3" stretchy="false" xref="S4.SS0.SSS0.Px1.p1.2.m2.4.5.2.3.1.cmml">)</mo></mrow></mrow><mo id="S4.SS0.SSS0.Px1.p1.2.m2.4.5.1" xref="S4.SS0.SSS0.Px1.p1.2.m2.4.5.1.cmml">=</mo><mrow id="S4.SS0.SSS0.Px1.p1.2.m2.4.5.3" xref="S4.SS0.SSS0.Px1.p1.2.m2.4.5.3.cmml"><mi id="S4.SS0.SSS0.Px1.p1.2.m2.4.5.3.2" xref="S4.SS0.SSS0.Px1.p1.2.m2.4.5.3.2.cmml">P</mi><mo id="S4.SS0.SSS0.Px1.p1.2.m2.4.5.3.1" lspace="0.337em" xref="S4.SS0.SSS0.Px1.p1.2.m2.4.5.3.1.cmml">⁢</mo><mrow id="S4.SS0.SSS0.Px1.p1.2.m2.4.5.3.3.2" xref="S4.SS0.SSS0.Px1.p1.2.m2.4.5.3.3.1.cmml"><mi id="S4.SS0.SSS0.Px1.p1.2.m2.3.3" xref="S4.SS0.SSS0.Px1.p1.2.m2.3.3.cmml">log</mi><mo id="S4.SS0.SSS0.Px1.p1.2.m2.4.5.3.3.2a" xref="S4.SS0.SSS0.Px1.p1.2.m2.4.5.3.3.1.cmml">⁡</mo><mrow id="S4.SS0.SSS0.Px1.p1.2.m2.4.5.3.3.2.1" xref="S4.SS0.SSS0.Px1.p1.2.m2.4.5.3.3.1.cmml"><mo id="S4.SS0.SSS0.Px1.p1.2.m2.4.5.3.3.2.1.1" xref="S4.SS0.SSS0.Px1.p1.2.m2.4.5.3.3.1.cmml">(</mo><mrow id="S4.SS0.SSS0.Px1.p1.2.m2.4.4" xref="S4.SS0.SSS0.Px1.p1.2.m2.4.4.cmml"><mpadded id="S4.SS0.SSS0.Px1.p1.2.m2.4.4.2" voffset="0.3em" xref="S4.SS0.SSS0.Px1.p1.2.m2.4.4.2.cmml"><mi id="S4.SS0.SSS0.Px1.p1.2.m2.4.4.2a" mathsize="70%" xref="S4.SS0.SSS0.Px1.p1.2.m2.4.4.2.cmml">P</mi></mpadded><mpadded id="S4.SS0.SSS0.Px1.p1.2.m2.4.4.1" lspace="-0.1em" width="-0.15em" xref="S4.SS0.SSS0.Px1.p1.2.m2.4.4.1.cmml"><mo id="S4.SS0.SSS0.Px1.p1.2.m2.4.4.1a" stretchy="true" symmetric="true" xref="S4.SS0.SSS0.Px1.p1.2.m2.4.4.1.cmml">/</mo></mpadded><mi id="S4.SS0.SSS0.Px1.p1.2.m2.4.4.3" mathsize="70%" xref="S4.SS0.SSS0.Px1.p1.2.m2.4.4.3.cmml">V</mi></mrow><mo id="S4.SS0.SSS0.Px1.p1.2.m2.4.5.3.3.2.1.2" xref="S4.SS0.SSS0.Px1.p1.2.m2.4.5.3.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px1.p1.2.m2.4b"><apply id="S4.SS0.SSS0.Px1.p1.2.m2.4.5.cmml" xref="S4.SS0.SSS0.Px1.p1.2.m2.4.5"><eq id="S4.SS0.SSS0.Px1.p1.2.m2.4.5.1.cmml" xref="S4.SS0.SSS0.Px1.p1.2.m2.4.5.1"></eq><apply id="S4.SS0.SSS0.Px1.p1.2.m2.4.5.2.cmml" xref="S4.SS0.SSS0.Px1.p1.2.m2.4.5.2"><times id="S4.SS0.SSS0.Px1.p1.2.m2.4.5.2.1.cmml" xref="S4.SS0.SSS0.Px1.p1.2.m2.4.5.2.1"></times><apply id="S4.SS0.SSS0.Px1.p1.2.m2.4.5.2.2.cmml" xref="S4.SS0.SSS0.Px1.p1.2.m2.4.5.2.2"><csymbol cd="ambiguous" id="S4.SS0.SSS0.Px1.p1.2.m2.4.5.2.2.1.cmml" xref="S4.SS0.SSS0.Px1.p1.2.m2.4.5.2.2">subscript</csymbol><ci id="S4.SS0.SSS0.Px1.p1.2.m2.4.5.2.2.2.cmml" xref="S4.SS0.SSS0.Px1.p1.2.m2.4.5.2.2.2">𝐷</ci><apply id="S4.SS0.SSS0.Px1.p1.2.m2.4.5.2.2.3.cmml" xref="S4.SS0.SSS0.Px1.p1.2.m2.4.5.2.2.3"><times id="S4.SS0.SSS0.Px1.p1.2.m2.4.5.2.2.3.1.cmml" xref="S4.SS0.SSS0.Px1.p1.2.m2.4.5.2.2.3.1"></times><ci id="S4.SS0.SSS0.Px1.p1.2.m2.4.5.2.2.3.2.cmml" xref="S4.SS0.SSS0.Px1.p1.2.m2.4.5.2.2.3.2">𝐾</ci><ci id="S4.SS0.SSS0.Px1.p1.2.m2.4.5.2.2.3.3.cmml" xref="S4.SS0.SSS0.Px1.p1.2.m2.4.5.2.2.3.3">𝐿</ci></apply></apply><interval closure="open" id="S4.SS0.SSS0.Px1.p1.2.m2.4.5.2.3.1.cmml" xref="S4.SS0.SSS0.Px1.p1.2.m2.4.5.2.3.2"><ci id="S4.SS0.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S4.SS0.SSS0.Px1.p1.2.m2.1.1">𝑃</ci><ci id="S4.SS0.SSS0.Px1.p1.2.m2.2.2.cmml" xref="S4.SS0.SSS0.Px1.p1.2.m2.2.2">𝑉</ci></interval></apply><apply id="S4.SS0.SSS0.Px1.p1.2.m2.4.5.3.cmml" xref="S4.SS0.SSS0.Px1.p1.2.m2.4.5.3"><times id="S4.SS0.SSS0.Px1.p1.2.m2.4.5.3.1.cmml" xref="S4.SS0.SSS0.Px1.p1.2.m2.4.5.3.1"></times><ci id="S4.SS0.SSS0.Px1.p1.2.m2.4.5.3.2.cmml" xref="S4.SS0.SSS0.Px1.p1.2.m2.4.5.3.2">𝑃</ci><apply id="S4.SS0.SSS0.Px1.p1.2.m2.4.5.3.3.1.cmml" xref="S4.SS0.SSS0.Px1.p1.2.m2.4.5.3.3.2"><log id="S4.SS0.SSS0.Px1.p1.2.m2.3.3.cmml" xref="S4.SS0.SSS0.Px1.p1.2.m2.3.3"></log><apply id="S4.SS0.SSS0.Px1.p1.2.m2.4.4.cmml" xref="S4.SS0.SSS0.Px1.p1.2.m2.4.4"><divide id="S4.SS0.SSS0.Px1.p1.2.m2.4.4.1.cmml" xref="S4.SS0.SSS0.Px1.p1.2.m2.4.4.1"></divide><ci id="S4.SS0.SSS0.Px1.p1.2.m2.4.4.2.cmml" xref="S4.SS0.SSS0.Px1.p1.2.m2.4.4.2">𝑃</ci><ci id="S4.SS0.SSS0.Px1.p1.2.m2.4.4.3.cmml" xref="S4.SS0.SSS0.Px1.p1.2.m2.4.4.3">𝑉</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px1.p1.2.m2.4c">D_{KL}(P,V)=P\,\log\left(\nicefrac{{P}}{{V}}\right)</annotation><annotation encoding="application/x-llamapun" id="S4.SS0.SSS0.Px1.p1.2.m2.4d">italic_D start_POSTSUBSCRIPT italic_K italic_L end_POSTSUBSCRIPT ( italic_P , italic_V ) = italic_P roman_log ( / start_ARG italic_P end_ARG start_ARG italic_V end_ARG )</annotation></semantics></math>.
This choice of minimization criterion can be seen as analogous to the choice between Gini impurity and Shannon entropy in the computation of the information gain in decision trees.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS0.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Bagging and Feature Subsampling</h5>
<div class="ltx_para ltx_noindent" id="S4.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS0.SSS0.Px2.p1.1">Following the common approach in decision trees, <cite class="ltx_cite ltx_citemacro_citet">Ram &amp; Gray (<a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib24" title="">2011</a>)</cite> suggest the use of pruning for regularization of DET models.
Practice has however evolved to prefer bagging as a form of regularization rather than relying on single decision trees.
We employ same principle to DETs by fitting many trees on bootstrap samples of the data. We also adopt the common practice from Random Forests
of randomly sampling a subset of features to consider when splitting any leaf node in order to encourage independence between the different trees in the ensemble.
The ensemble model, which we call <em class="ltx_emph ltx_font_italic" id="S4.SS0.SSS0.Px2.p1.1.1">Density Estimation Forests</em> (DEF) in the sequel, is thus an additive mixture of DETs with uniform weights, therefore still allowing for normalized density computation and exact sampling.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Related Work</h2>
<section class="ltx_paragraph" id="S5.SS0.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Generative Boosting</h5>
<div class="ltx_para ltx_noindent" id="S5.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S5.SS0.SSS0.Px1.p1.1">Most prior work on generative boosting focuses on unstructured data and the use of parametric weak learners and is split between two approaches:
(i) Additive methods that model the density function as an additive mixture of weak learners such as <cite class="ltx_cite ltx_citemacro_cite">Rosset &amp; Segal (<a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib25" title="">2002</a>); Tolstikhin et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib27" title="">2017</a>)</cite>.
(ii) Those that take a multiplicative approach modeling the density function as an unnormalized product of weak learners.
The latter is equivalent to the energy based approach that writes the energy function (log density) as an additive sum of weak learners.
<cite class="ltx_cite ltx_citemacro_citet">Welling et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib30" title="">2002</a>)</cite> in particular also approach boosting from the point of view of functional optimization of the likelihood or the logistic loss of an energy-based model.
However, they rely on a first order local approximation of the objective since they focus on parametric weak learners such as restricted Boltzmann machines for which a second order step would be impractical.</p>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS0.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Greedy Multiplicative Boosting</h5>
<div class="ltx_para ltx_noindent" id="S5.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="S5.SS0.SSS0.Px2.p1.5">Another more direct multiplicative boosting framework was first proposed by <cite class="ltx_cite ltx_citemacro_citet">Tu (<a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib28" title="">2007</a>)</cite>.
At each boosting round a discriminative classifier is trained to distinguish between empirical data and data generated by the current model by estimating
the likelihood ratio <math alttext="\nicefrac{{p(\mathbf{x})}}{{q_{t}(\mathbf{x})}}" class="ltx_Math" display="inline" id="S5.SS0.SSS0.Px2.p1.1.m1.2"><semantics id="S5.SS0.SSS0.Px2.p1.1.m1.2a"><mrow id="S5.SS0.SSS0.Px2.p1.1.m1.2.2" xref="S5.SS0.SSS0.Px2.p1.1.m1.2.2.cmml"><mpadded id="S5.SS0.SSS0.Px2.p1.1.m1.1.1.1" voffset="0.3em" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.1.1.cmml"><mi id="S5.SS0.SSS0.Px2.p1.1.m1.1.1.1.3" mathsize="70%" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.1.1.3.cmml">p</mi><mo id="S5.SS0.SSS0.Px2.p1.1.m1.1.1.1.2" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S5.SS0.SSS0.Px2.p1.1.m1.1.1.1.4.2" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.1.1.cmml"><mo id="S5.SS0.SSS0.Px2.p1.1.m1.1.1.1.4.2.1" maxsize="70%" minsize="70%" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.1.1.cmml">(</mo><mi id="S5.SS0.SSS0.Px2.p1.1.m1.1.1.1.1" mathsize="70%" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.cmml">𝐱</mi><mo id="S5.SS0.SSS0.Px2.p1.1.m1.1.1.1.4.2.2" maxsize="70%" minsize="70%" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.1.1.cmml">)</mo></mrow></mpadded><mpadded id="S5.SS0.SSS0.Px2.p1.1.m1.2.2.3" lspace="-0.1em" width="-0.15em" xref="S5.SS0.SSS0.Px2.p1.1.m1.2.2.3.cmml"><mo id="S5.SS0.SSS0.Px2.p1.1.m1.2.2.3a" stretchy="true" symmetric="true" xref="S5.SS0.SSS0.Px2.p1.1.m1.2.2.3.cmml">/</mo></mpadded><mrow id="S5.SS0.SSS0.Px2.p1.1.m1.2.2.2" xref="S5.SS0.SSS0.Px2.p1.1.m1.2.2.2.cmml"><msub id="S5.SS0.SSS0.Px2.p1.1.m1.2.2.2.3" xref="S5.SS0.SSS0.Px2.p1.1.m1.2.2.2.3.cmml"><mi id="S5.SS0.SSS0.Px2.p1.1.m1.2.2.2.3.2" mathsize="70%" xref="S5.SS0.SSS0.Px2.p1.1.m1.2.2.2.3.2.cmml">q</mi><mi id="S5.SS0.SSS0.Px2.p1.1.m1.2.2.2.3.3" mathsize="71%" xref="S5.SS0.SSS0.Px2.p1.1.m1.2.2.2.3.3.cmml">t</mi></msub><mo id="S5.SS0.SSS0.Px2.p1.1.m1.2.2.2.2" xref="S5.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.cmml">⁢</mo><mrow id="S5.SS0.SSS0.Px2.p1.1.m1.2.2.2.4.2" xref="S5.SS0.SSS0.Px2.p1.1.m1.2.2.2.cmml"><mo id="S5.SS0.SSS0.Px2.p1.1.m1.2.2.2.4.2.1" maxsize="70%" minsize="70%" xref="S5.SS0.SSS0.Px2.p1.1.m1.2.2.2.cmml">(</mo><mi id="S5.SS0.SSS0.Px2.p1.1.m1.2.2.2.1" mathsize="70%" xref="S5.SS0.SSS0.Px2.p1.1.m1.2.2.2.1.cmml">𝐱</mi><mo id="S5.SS0.SSS0.Px2.p1.1.m1.2.2.2.4.2.2" maxsize="70%" minsize="70%" xref="S5.SS0.SSS0.Px2.p1.1.m1.2.2.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px2.p1.1.m1.2b"><apply id="S5.SS0.SSS0.Px2.p1.1.m1.2.2.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.2.2"><divide id="S5.SS0.SSS0.Px2.p1.1.m1.2.2.3.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.2.2.3"></divide><apply id="S5.SS0.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.1.1"><times id="S5.SS0.SSS0.Px2.p1.1.m1.1.1.1.2.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.1.1.2"></times><ci id="S5.SS0.SSS0.Px2.p1.1.m1.1.1.1.3.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.1.1.3">𝑝</ci><ci id="S5.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.1.1.1">𝐱</ci></apply><apply id="S5.SS0.SSS0.Px2.p1.1.m1.2.2.2.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.2.2.2"><times id="S5.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.2.2.2.2"></times><apply id="S5.SS0.SSS0.Px2.p1.1.m1.2.2.2.3.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.2.2.2.3"><csymbol cd="ambiguous" id="S5.SS0.SSS0.Px2.p1.1.m1.2.2.2.3.1.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.2.2.2.3">subscript</csymbol><ci id="S5.SS0.SSS0.Px2.p1.1.m1.2.2.2.3.2.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.2.2.2.3.2">𝑞</ci><ci id="S5.SS0.SSS0.Px2.p1.1.m1.2.2.2.3.3.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.2.2.2.3.3">𝑡</ci></apply><ci id="S5.SS0.SSS0.Px2.p1.1.m1.2.2.2.1.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.2.2.2.1">𝐱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px2.p1.1.m1.2c">\nicefrac{{p(\mathbf{x})}}{{q_{t}(\mathbf{x})}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS0.SSS0.Px2.p1.1.m1.2d">/ start_ARG italic_p ( bold_x ) end_ARG start_ARG italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_x ) end_ARG</annotation></semantics></math>.
This estimated ratio is used as a direct multiplicative factor to update the current model <math alttext="q_{t}" class="ltx_Math" display="inline" id="S5.SS0.SSS0.Px2.p1.2.m2.1"><semantics id="S5.SS0.SSS0.Px2.p1.2.m2.1a"><msub id="S5.SS0.SSS0.Px2.p1.2.m2.1.1" xref="S5.SS0.SSS0.Px2.p1.2.m2.1.1.cmml"><mi id="S5.SS0.SSS0.Px2.p1.2.m2.1.1.2" xref="S5.SS0.SSS0.Px2.p1.2.m2.1.1.2.cmml">q</mi><mi id="S5.SS0.SSS0.Px2.p1.2.m2.1.1.3" xref="S5.SS0.SSS0.Px2.p1.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px2.p1.2.m2.1b"><apply id="S5.SS0.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S5.SS0.SSS0.Px2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS0.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="S5.SS0.SSS0.Px2.p1.2.m2.1.1">subscript</csymbol><ci id="S5.SS0.SSS0.Px2.p1.2.m2.1.1.2.cmml" xref="S5.SS0.SSS0.Px2.p1.2.m2.1.1.2">𝑞</ci><ci id="S5.SS0.SSS0.Px2.p1.2.m2.1.1.3.cmml" xref="S5.SS0.SSS0.Px2.p1.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px2.p1.2.m2.1c">q_{t}</annotation><annotation encoding="application/x-llamapun" id="S5.SS0.SSS0.Px2.p1.2.m2.1d">italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> (after being raised to an appropriate step size).
In ideal conditions
this greedy procedure would converge in a single iteration if a step size of 1 would be used.
While <cite class="ltx_cite ltx_citemacro_cite">Tu (<a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib28" title="">2007</a>)</cite> does not prescribe a particular choice of classifier,
<cite class="ltx_cite ltx_citemacro_citet">Grover &amp; Ermon (<a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib14" title="">2018</a>)</cite> proposes a similar concept where the ratio is estimated based on an adversarial bound for an <math alttext="f" class="ltx_Math" display="inline" id="S5.SS0.SSS0.Px2.p1.3.m3.1"><semantics id="S5.SS0.SSS0.Px2.p1.3.m3.1a"><mi id="S5.SS0.SSS0.Px2.p1.3.m3.1.1" xref="S5.SS0.SSS0.Px2.p1.3.m3.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px2.p1.3.m3.1b"><ci id="S5.SS0.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S5.SS0.SSS0.Px2.p1.3.m3.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px2.p1.3.m3.1c">f</annotation><annotation encoding="application/x-llamapun" id="S5.SS0.SSS0.Px2.p1.3.m3.1d">italic_f</annotation></semantics></math>-divergence and <cite class="ltx_cite ltx_citemacro_cite">Cranko &amp; Nock (<a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib6" title="">2019</a>)</cite> provides additional analysis on this method.
We note that the main difference between this greedy approach and NRGBoost is that the latter attempts to update the current density proportionally to an exponential of the likelihood ratio, <math alttext="\exp\left(\alpha_{t}\cdot\nicefrac{{p(x)}}{{q_{t}(x)}}\right)" class="ltx_Math" display="inline" id="S5.SS0.SSS0.Px2.p1.4.m4.4"><semantics id="S5.SS0.SSS0.Px2.p1.4.m4.4a"><mrow id="S5.SS0.SSS0.Px2.p1.4.m4.4.4.1" xref="S5.SS0.SSS0.Px2.p1.4.m4.4.4.2.cmml"><mi id="S5.SS0.SSS0.Px2.p1.4.m4.3.3" xref="S5.SS0.SSS0.Px2.p1.4.m4.3.3.cmml">exp</mi><mo id="S5.SS0.SSS0.Px2.p1.4.m4.4.4.1a" xref="S5.SS0.SSS0.Px2.p1.4.m4.4.4.2.cmml">⁡</mo><mrow id="S5.SS0.SSS0.Px2.p1.4.m4.4.4.1.1" xref="S5.SS0.SSS0.Px2.p1.4.m4.4.4.2.cmml"><mo id="S5.SS0.SSS0.Px2.p1.4.m4.4.4.1.1.2" xref="S5.SS0.SSS0.Px2.p1.4.m4.4.4.2.cmml">(</mo><mrow id="S5.SS0.SSS0.Px2.p1.4.m4.4.4.1.1.1" xref="S5.SS0.SSS0.Px2.p1.4.m4.4.4.1.1.1.cmml"><msub id="S5.SS0.SSS0.Px2.p1.4.m4.4.4.1.1.1.2" xref="S5.SS0.SSS0.Px2.p1.4.m4.4.4.1.1.1.2.cmml"><mi id="S5.SS0.SSS0.Px2.p1.4.m4.4.4.1.1.1.2.2" xref="S5.SS0.SSS0.Px2.p1.4.m4.4.4.1.1.1.2.2.cmml">α</mi><mi id="S5.SS0.SSS0.Px2.p1.4.m4.4.4.1.1.1.2.3" xref="S5.SS0.SSS0.Px2.p1.4.m4.4.4.1.1.1.2.3.cmml">t</mi></msub><mo id="S5.SS0.SSS0.Px2.p1.4.m4.4.4.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S5.SS0.SSS0.Px2.p1.4.m4.4.4.1.1.1.1.cmml">⋅</mo><mrow id="S5.SS0.SSS0.Px2.p1.4.m4.2.2" xref="S5.SS0.SSS0.Px2.p1.4.m4.2.2.cmml"><mpadded id="S5.SS0.SSS0.Px2.p1.4.m4.1.1.1" voffset="0.3em" xref="S5.SS0.SSS0.Px2.p1.4.m4.1.1.1.cmml"><mi id="S5.SS0.SSS0.Px2.p1.4.m4.1.1.1.3" mathsize="70%" xref="S5.SS0.SSS0.Px2.p1.4.m4.1.1.1.3.cmml">p</mi><mo id="S5.SS0.SSS0.Px2.p1.4.m4.1.1.1.2" xref="S5.SS0.SSS0.Px2.p1.4.m4.1.1.1.2.cmml">⁢</mo><mrow id="S5.SS0.SSS0.Px2.p1.4.m4.1.1.1.4.2" xref="S5.SS0.SSS0.Px2.p1.4.m4.1.1.1.cmml"><mo id="S5.SS0.SSS0.Px2.p1.4.m4.1.1.1.4.2.1" maxsize="70%" minsize="70%" xref="S5.SS0.SSS0.Px2.p1.4.m4.1.1.1.cmml">(</mo><mi id="S5.SS0.SSS0.Px2.p1.4.m4.1.1.1.1" mathsize="70%" xref="S5.SS0.SSS0.Px2.p1.4.m4.1.1.1.1.cmml">x</mi><mo id="S5.SS0.SSS0.Px2.p1.4.m4.1.1.1.4.2.2" maxsize="70%" minsize="70%" xref="S5.SS0.SSS0.Px2.p1.4.m4.1.1.1.cmml">)</mo></mrow></mpadded><mpadded id="S5.SS0.SSS0.Px2.p1.4.m4.2.2.3" lspace="-0.1em" width="-0.15em" xref="S5.SS0.SSS0.Px2.p1.4.m4.2.2.3.cmml"><mo id="S5.SS0.SSS0.Px2.p1.4.m4.2.2.3a" stretchy="true" symmetric="true" xref="S5.SS0.SSS0.Px2.p1.4.m4.2.2.3.cmml">/</mo></mpadded><mrow id="S5.SS0.SSS0.Px2.p1.4.m4.2.2.2" xref="S5.SS0.SSS0.Px2.p1.4.m4.2.2.2.cmml"><msub id="S5.SS0.SSS0.Px2.p1.4.m4.2.2.2.3" xref="S5.SS0.SSS0.Px2.p1.4.m4.2.2.2.3.cmml"><mi id="S5.SS0.SSS0.Px2.p1.4.m4.2.2.2.3.2" mathsize="70%" xref="S5.SS0.SSS0.Px2.p1.4.m4.2.2.2.3.2.cmml">q</mi><mi id="S5.SS0.SSS0.Px2.p1.4.m4.2.2.2.3.3" mathsize="71%" xref="S5.SS0.SSS0.Px2.p1.4.m4.2.2.2.3.3.cmml">t</mi></msub><mo id="S5.SS0.SSS0.Px2.p1.4.m4.2.2.2.2" xref="S5.SS0.SSS0.Px2.p1.4.m4.2.2.2.2.cmml">⁢</mo><mrow id="S5.SS0.SSS0.Px2.p1.4.m4.2.2.2.4.2" xref="S5.SS0.SSS0.Px2.p1.4.m4.2.2.2.cmml"><mo id="S5.SS0.SSS0.Px2.p1.4.m4.2.2.2.4.2.1" maxsize="70%" minsize="70%" xref="S5.SS0.SSS0.Px2.p1.4.m4.2.2.2.cmml">(</mo><mi id="S5.SS0.SSS0.Px2.p1.4.m4.2.2.2.1" mathsize="70%" xref="S5.SS0.SSS0.Px2.p1.4.m4.2.2.2.1.cmml">x</mi><mo id="S5.SS0.SSS0.Px2.p1.4.m4.2.2.2.4.2.2" maxsize="70%" minsize="70%" xref="S5.SS0.SSS0.Px2.p1.4.m4.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S5.SS0.SSS0.Px2.p1.4.m4.4.4.1.1.3" xref="S5.SS0.SSS0.Px2.p1.4.m4.4.4.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px2.p1.4.m4.4b"><apply id="S5.SS0.SSS0.Px2.p1.4.m4.4.4.2.cmml" xref="S5.SS0.SSS0.Px2.p1.4.m4.4.4.1"><exp id="S5.SS0.SSS0.Px2.p1.4.m4.3.3.cmml" xref="S5.SS0.SSS0.Px2.p1.4.m4.3.3"></exp><apply id="S5.SS0.SSS0.Px2.p1.4.m4.4.4.1.1.1.cmml" xref="S5.SS0.SSS0.Px2.p1.4.m4.4.4.1.1.1"><ci id="S5.SS0.SSS0.Px2.p1.4.m4.4.4.1.1.1.1.cmml" xref="S5.SS0.SSS0.Px2.p1.4.m4.4.4.1.1.1.1">⋅</ci><apply id="S5.SS0.SSS0.Px2.p1.4.m4.4.4.1.1.1.2.cmml" xref="S5.SS0.SSS0.Px2.p1.4.m4.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S5.SS0.SSS0.Px2.p1.4.m4.4.4.1.1.1.2.1.cmml" xref="S5.SS0.SSS0.Px2.p1.4.m4.4.4.1.1.1.2">subscript</csymbol><ci id="S5.SS0.SSS0.Px2.p1.4.m4.4.4.1.1.1.2.2.cmml" xref="S5.SS0.SSS0.Px2.p1.4.m4.4.4.1.1.1.2.2">𝛼</ci><ci id="S5.SS0.SSS0.Px2.p1.4.m4.4.4.1.1.1.2.3.cmml" xref="S5.SS0.SSS0.Px2.p1.4.m4.4.4.1.1.1.2.3">𝑡</ci></apply><apply id="S5.SS0.SSS0.Px2.p1.4.m4.2.2.cmml" xref="S5.SS0.SSS0.Px2.p1.4.m4.2.2"><divide id="S5.SS0.SSS0.Px2.p1.4.m4.2.2.3.cmml" xref="S5.SS0.SSS0.Px2.p1.4.m4.2.2.3"></divide><apply id="S5.SS0.SSS0.Px2.p1.4.m4.1.1.1.cmml" xref="S5.SS0.SSS0.Px2.p1.4.m4.1.1.1"><times id="S5.SS0.SSS0.Px2.p1.4.m4.1.1.1.2.cmml" xref="S5.SS0.SSS0.Px2.p1.4.m4.1.1.1.2"></times><ci id="S5.SS0.SSS0.Px2.p1.4.m4.1.1.1.3.cmml" xref="S5.SS0.SSS0.Px2.p1.4.m4.1.1.1.3">𝑝</ci><ci id="S5.SS0.SSS0.Px2.p1.4.m4.1.1.1.1.cmml" xref="S5.SS0.SSS0.Px2.p1.4.m4.1.1.1.1">𝑥</ci></apply><apply id="S5.SS0.SSS0.Px2.p1.4.m4.2.2.2.cmml" xref="S5.SS0.SSS0.Px2.p1.4.m4.2.2.2"><times id="S5.SS0.SSS0.Px2.p1.4.m4.2.2.2.2.cmml" xref="S5.SS0.SSS0.Px2.p1.4.m4.2.2.2.2"></times><apply id="S5.SS0.SSS0.Px2.p1.4.m4.2.2.2.3.cmml" xref="S5.SS0.SSS0.Px2.p1.4.m4.2.2.2.3"><csymbol cd="ambiguous" id="S5.SS0.SSS0.Px2.p1.4.m4.2.2.2.3.1.cmml" xref="S5.SS0.SSS0.Px2.p1.4.m4.2.2.2.3">subscript</csymbol><ci id="S5.SS0.SSS0.Px2.p1.4.m4.2.2.2.3.2.cmml" xref="S5.SS0.SSS0.Px2.p1.4.m4.2.2.2.3.2">𝑞</ci><ci id="S5.SS0.SSS0.Px2.p1.4.m4.2.2.2.3.3.cmml" xref="S5.SS0.SSS0.Px2.p1.4.m4.2.2.2.3.3">𝑡</ci></apply><ci id="S5.SS0.SSS0.Px2.p1.4.m4.2.2.2.1.cmml" xref="S5.SS0.SSS0.Px2.p1.4.m4.2.2.2.1">𝑥</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px2.p1.4.m4.4c">\exp\left(\alpha_{t}\cdot\nicefrac{{p(x)}}{{q_{t}(x)}}\right)</annotation><annotation encoding="application/x-llamapun" id="S5.SS0.SSS0.Px2.p1.4.m4.4d">roman_exp ( italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ⋅ / start_ARG italic_p ( italic_x ) end_ARG start_ARG italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( italic_x ) end_ARG )</annotation></semantics></math>, instead of <math alttext="\left(\nicefrac{{p(\mathbf{x})}}{{q_{t}(\mathbf{x})}}\right)^{\alpha_{t}}" class="ltx_Math" display="inline" id="S5.SS0.SSS0.Px2.p1.5.m5.2"><semantics id="S5.SS0.SSS0.Px2.p1.5.m5.2a"><msup id="S5.SS0.SSS0.Px2.p1.5.m5.2.3" xref="S5.SS0.SSS0.Px2.p1.5.m5.2.3.cmml"><mrow id="S5.SS0.SSS0.Px2.p1.5.m5.2.3.2.2" xref="S5.SS0.SSS0.Px2.p1.5.m5.2.2.cmml"><mo id="S5.SS0.SSS0.Px2.p1.5.m5.2.3.2.2.1" xref="S5.SS0.SSS0.Px2.p1.5.m5.2.2.cmml">(</mo><mrow id="S5.SS0.SSS0.Px2.p1.5.m5.2.2" xref="S5.SS0.SSS0.Px2.p1.5.m5.2.2.cmml"><mpadded id="S5.SS0.SSS0.Px2.p1.5.m5.1.1.1" voffset="0.3em" xref="S5.SS0.SSS0.Px2.p1.5.m5.1.1.1.cmml"><mi id="S5.SS0.SSS0.Px2.p1.5.m5.1.1.1.3" mathsize="70%" xref="S5.SS0.SSS0.Px2.p1.5.m5.1.1.1.3.cmml">p</mi><mo id="S5.SS0.SSS0.Px2.p1.5.m5.1.1.1.2" xref="S5.SS0.SSS0.Px2.p1.5.m5.1.1.1.2.cmml">⁢</mo><mrow id="S5.SS0.SSS0.Px2.p1.5.m5.1.1.1.4.2" xref="S5.SS0.SSS0.Px2.p1.5.m5.1.1.1.cmml"><mo id="S5.SS0.SSS0.Px2.p1.5.m5.1.1.1.4.2.1" maxsize="70%" minsize="70%" xref="S5.SS0.SSS0.Px2.p1.5.m5.1.1.1.cmml">(</mo><mi id="S5.SS0.SSS0.Px2.p1.5.m5.1.1.1.1" mathsize="70%" xref="S5.SS0.SSS0.Px2.p1.5.m5.1.1.1.1.cmml">𝐱</mi><mo id="S5.SS0.SSS0.Px2.p1.5.m5.1.1.1.4.2.2" maxsize="70%" minsize="70%" xref="S5.SS0.SSS0.Px2.p1.5.m5.1.1.1.cmml">)</mo></mrow></mpadded><mpadded id="S5.SS0.SSS0.Px2.p1.5.m5.2.2.3" lspace="-0.1em" width="-0.15em" xref="S5.SS0.SSS0.Px2.p1.5.m5.2.2.3.cmml"><mo id="S5.SS0.SSS0.Px2.p1.5.m5.2.2.3a" stretchy="true" symmetric="true" xref="S5.SS0.SSS0.Px2.p1.5.m5.2.2.3.cmml">/</mo></mpadded><mrow id="S5.SS0.SSS0.Px2.p1.5.m5.2.2.2" xref="S5.SS0.SSS0.Px2.p1.5.m5.2.2.2.cmml"><msub id="S5.SS0.SSS0.Px2.p1.5.m5.2.2.2.3" xref="S5.SS0.SSS0.Px2.p1.5.m5.2.2.2.3.cmml"><mi id="S5.SS0.SSS0.Px2.p1.5.m5.2.2.2.3.2" mathsize="70%" xref="S5.SS0.SSS0.Px2.p1.5.m5.2.2.2.3.2.cmml">q</mi><mi id="S5.SS0.SSS0.Px2.p1.5.m5.2.2.2.3.3" mathsize="71%" xref="S5.SS0.SSS0.Px2.p1.5.m5.2.2.2.3.3.cmml">t</mi></msub><mo id="S5.SS0.SSS0.Px2.p1.5.m5.2.2.2.2" xref="S5.SS0.SSS0.Px2.p1.5.m5.2.2.2.2.cmml">⁢</mo><mrow id="S5.SS0.SSS0.Px2.p1.5.m5.2.2.2.4.2" xref="S5.SS0.SSS0.Px2.p1.5.m5.2.2.2.cmml"><mo id="S5.SS0.SSS0.Px2.p1.5.m5.2.2.2.4.2.1" maxsize="70%" minsize="70%" xref="S5.SS0.SSS0.Px2.p1.5.m5.2.2.2.cmml">(</mo><mi id="S5.SS0.SSS0.Px2.p1.5.m5.2.2.2.1" mathsize="70%" xref="S5.SS0.SSS0.Px2.p1.5.m5.2.2.2.1.cmml">𝐱</mi><mo id="S5.SS0.SSS0.Px2.p1.5.m5.2.2.2.4.2.2" maxsize="70%" minsize="70%" xref="S5.SS0.SSS0.Px2.p1.5.m5.2.2.2.cmml">)</mo></mrow></mrow></mrow><mo id="S5.SS0.SSS0.Px2.p1.5.m5.2.3.2.2.2" xref="S5.SS0.SSS0.Px2.p1.5.m5.2.2.cmml">)</mo></mrow><msub id="S5.SS0.SSS0.Px2.p1.5.m5.2.3.3" xref="S5.SS0.SSS0.Px2.p1.5.m5.2.3.3.cmml"><mi id="S5.SS0.SSS0.Px2.p1.5.m5.2.3.3.2" xref="S5.SS0.SSS0.Px2.p1.5.m5.2.3.3.2.cmml">α</mi><mi id="S5.SS0.SSS0.Px2.p1.5.m5.2.3.3.3" xref="S5.SS0.SSS0.Px2.p1.5.m5.2.3.3.3.cmml">t</mi></msub></msup><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px2.p1.5.m5.2b"><apply id="S5.SS0.SSS0.Px2.p1.5.m5.2.3.cmml" xref="S5.SS0.SSS0.Px2.p1.5.m5.2.3"><csymbol cd="ambiguous" id="S5.SS0.SSS0.Px2.p1.5.m5.2.3.1.cmml" xref="S5.SS0.SSS0.Px2.p1.5.m5.2.3">superscript</csymbol><apply id="S5.SS0.SSS0.Px2.p1.5.m5.2.2.cmml" xref="S5.SS0.SSS0.Px2.p1.5.m5.2.3.2.2"><divide id="S5.SS0.SSS0.Px2.p1.5.m5.2.2.3.cmml" xref="S5.SS0.SSS0.Px2.p1.5.m5.2.2.3"></divide><apply id="S5.SS0.SSS0.Px2.p1.5.m5.1.1.1.cmml" xref="S5.SS0.SSS0.Px2.p1.5.m5.1.1.1"><times id="S5.SS0.SSS0.Px2.p1.5.m5.1.1.1.2.cmml" xref="S5.SS0.SSS0.Px2.p1.5.m5.1.1.1.2"></times><ci id="S5.SS0.SSS0.Px2.p1.5.m5.1.1.1.3.cmml" xref="S5.SS0.SSS0.Px2.p1.5.m5.1.1.1.3">𝑝</ci><ci id="S5.SS0.SSS0.Px2.p1.5.m5.1.1.1.1.cmml" xref="S5.SS0.SSS0.Px2.p1.5.m5.1.1.1.1">𝐱</ci></apply><apply id="S5.SS0.SSS0.Px2.p1.5.m5.2.2.2.cmml" xref="S5.SS0.SSS0.Px2.p1.5.m5.2.2.2"><times id="S5.SS0.SSS0.Px2.p1.5.m5.2.2.2.2.cmml" xref="S5.SS0.SSS0.Px2.p1.5.m5.2.2.2.2"></times><apply id="S5.SS0.SSS0.Px2.p1.5.m5.2.2.2.3.cmml" xref="S5.SS0.SSS0.Px2.p1.5.m5.2.2.2.3"><csymbol cd="ambiguous" id="S5.SS0.SSS0.Px2.p1.5.m5.2.2.2.3.1.cmml" xref="S5.SS0.SSS0.Px2.p1.5.m5.2.2.2.3">subscript</csymbol><ci id="S5.SS0.SSS0.Px2.p1.5.m5.2.2.2.3.2.cmml" xref="S5.SS0.SSS0.Px2.p1.5.m5.2.2.2.3.2">𝑞</ci><ci id="S5.SS0.SSS0.Px2.p1.5.m5.2.2.2.3.3.cmml" xref="S5.SS0.SSS0.Px2.p1.5.m5.2.2.2.3.3">𝑡</ci></apply><ci id="S5.SS0.SSS0.Px2.p1.5.m5.2.2.2.1.cmml" xref="S5.SS0.SSS0.Px2.p1.5.m5.2.2.2.1">𝐱</ci></apply></apply><apply id="S5.SS0.SSS0.Px2.p1.5.m5.2.3.3.cmml" xref="S5.SS0.SSS0.Px2.p1.5.m5.2.3.3"><csymbol cd="ambiguous" id="S5.SS0.SSS0.Px2.p1.5.m5.2.3.3.1.cmml" xref="S5.SS0.SSS0.Px2.p1.5.m5.2.3.3">subscript</csymbol><ci id="S5.SS0.SSS0.Px2.p1.5.m5.2.3.3.2.cmml" xref="S5.SS0.SSS0.Px2.p1.5.m5.2.3.3.2">𝛼</ci><ci id="S5.SS0.SSS0.Px2.p1.5.m5.2.3.3.3.cmml" xref="S5.SS0.SSS0.Px2.p1.5.m5.2.3.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px2.p1.5.m5.2c">\left(\nicefrac{{p(\mathbf{x})}}{{q_{t}(\mathbf{x})}}\right)^{\alpha_{t}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS0.SSS0.Px2.p1.5.m5.2d">( / start_ARG italic_p ( bold_x ) end_ARG start_ARG italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_x ) end_ARG ) start_POSTSUPERSCRIPT italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> directly.
In Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A3" title="Appendix C Greedy Tree-Based Multiplicative Boosting ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">C</span></a> we explore the differences between NRGBoost and this approach when it is adapted to use trees as weak learners.</p>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS0.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Tree-Based Density Modelling</h5>
<div class="ltx_para ltx_noindent" id="S5.SS0.SSS0.Px3.p1">
<p class="ltx_p" id="S5.SS0.SSS0.Px3.p1.1">Other authors have proposed tree-based density models similar to DET <cite class="ltx_cite ltx_citemacro_citep">(Nock &amp; Guillame-Bert, <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib20" title="">2022</a>)</cite> or additive mixtures of tree-based models <cite class="ltx_cite ltx_citemacro_citep">(Correia et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib5" title="">2020</a>; Wen &amp; Hang, <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib31" title="">2022</a>; Watson et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib29" title="">2023</a>)</cite> but
perhaps surprisingly, the natural idea of creating an ensemble of DET models through bagging has not been explored before as far as we are aware.
Distinguishing features of some of these alternative approaches are:
(i) Not relying on a density estimation goal to drive the partitioning of the input space.
<cite class="ltx_cite ltx_citemacro_citet">Correia et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib5" title="">2020</a>)</cite> leverages a standard discriminative Random Forest, therefore giving special treatment to a particular input variable whose conditional estimation drives the choice of partitions
and <cite class="ltx_cite ltx_citemacro_citet">Wen &amp; Hang (<a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib31" title="">2022</a>)</cite> proposes using a mid-point random tree partitioning.
(ii) Leveraging more complex models for the data in the leaf of a tree instead of a uniform density <cite class="ltx_cite ltx_citemacro_citep">(Correia et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib5" title="">2020</a>; Watson et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib29" title="">2023</a>)</cite>.
This can allow for the use of trees that are more representative with a smaller number of leaves.
(iii) Relying on an adversarial framework where the generator and discriminator are both a tree <cite class="ltx_cite ltx_citemacro_citep">(Nock &amp; Guillame-Bert, <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib20" title="">2022</a>)</cite> or an ensemble of trees <cite class="ltx_cite ltx_citemacro_citep">(Watson et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib29" title="">2023</a>)</cite>.
While this also leads to an iterative approach, unlike with boosting or bagging, the new model trained at each round doesn’t add to the previous one but replaces it instead.</p>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS0.SSS0.Px4">
<h5 class="ltx_title ltx_title_paragraph">Other Recent Tree-Based approaches</h5>
<div class="ltx_para ltx_noindent" id="S5.SS0.SSS0.Px4.p1">
<p class="ltx_p" id="S5.SS0.SSS0.Px4.p1.1"><cite class="ltx_cite ltx_citemacro_citet">Nock &amp; Guillame-Bert (<a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib21" title="">2023</a>)</cite> proposes a different ensemble approach where each tree does not have its own leaf values that get added or multiplied to produce the final density,
but instead serve to collectively define the partitioning of the input space.
To train such models the authors propose a framework where, rather than adding a new tree to the ensemble at every iteration, the model is initialized with a fixed number of tree root nodes and each iteration adds a split to an existing leaf node.
Finally <cite class="ltx_cite ltx_citemacro_citet">Jolicoeur-Martineau et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib16" title="">2024</a>)</cite> propose a diffusion model where a tree-based model (e.g., GBDT) is used to regress the score function. Being a diffusion model, however, means that computing densities is untractable.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Experiments</h2>
<div class="ltx_para ltx_noindent" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">We evaluate the our proposed methods on 5 tabular datasets from the UCI Machine Learning Repository <cite class="ltx_cite ltx_citemacro_citep">(Dheeru &amp; Karra Taniskidou, <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib8" title="">2017</a>)</cite>: Abalone (AB), Physicochemical Properties of Protein Tertiary Structure (PR), Adult (AD), MiniBooNE (MBNE) and Covertype (CT)
as well as the California Housing (CH) dataset available through scikit-learn <cite class="ltx_cite ltx_citemacro_citep">(Pedregosa et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib23" title="">2011</a>)</cite>.
We also include a downsampled version of MNIST (by 2x along each dimension) which allows us to visually assess the quality of individual samples, something that is generally difficult with structured tabular data.
More details about these datasets are given in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A4.SS1" title="D.1 Datasets ‣ Appendix D Reproducibility ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">D.1</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.p2">
<p class="ltx_p" id="S6.p2.1">We split our experiments into two sections, the first to evaluate the quality of density models directly on
a single variable inference task and the second to investigate the performance of our proposed models when used for sampling, comparing them against more specialized models.</p>
</div>
<section class="ltx_subsection" id="S6.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.1 </span>Single Variable Inference</h3>
<div class="ltx_para ltx_noindent" id="S6.SS1.p1">
<p class="ltx_p" id="S6.SS1.p1.4">We test the ability of a generative model, trained to learn the density over all input variables, <math alttext="q(\mathbf{x})" class="ltx_Math" display="inline" id="S6.SS1.p1.1.m1.1"><semantics id="S6.SS1.p1.1.m1.1a"><mrow id="S6.SS1.p1.1.m1.1.2" xref="S6.SS1.p1.1.m1.1.2.cmml"><mi id="S6.SS1.p1.1.m1.1.2.2" xref="S6.SS1.p1.1.m1.1.2.2.cmml">q</mi><mo id="S6.SS1.p1.1.m1.1.2.1" xref="S6.SS1.p1.1.m1.1.2.1.cmml">⁢</mo><mrow id="S6.SS1.p1.1.m1.1.2.3.2" xref="S6.SS1.p1.1.m1.1.2.cmml"><mo id="S6.SS1.p1.1.m1.1.2.3.2.1" stretchy="false" xref="S6.SS1.p1.1.m1.1.2.cmml">(</mo><mi id="S6.SS1.p1.1.m1.1.1" xref="S6.SS1.p1.1.m1.1.1.cmml">𝐱</mi><mo id="S6.SS1.p1.1.m1.1.2.3.2.2" stretchy="false" xref="S6.SS1.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.1.m1.1b"><apply id="S6.SS1.p1.1.m1.1.2.cmml" xref="S6.SS1.p1.1.m1.1.2"><times id="S6.SS1.p1.1.m1.1.2.1.cmml" xref="S6.SS1.p1.1.m1.1.2.1"></times><ci id="S6.SS1.p1.1.m1.1.2.2.cmml" xref="S6.SS1.p1.1.m1.1.2.2">𝑞</ci><ci id="S6.SS1.p1.1.m1.1.1.cmml" xref="S6.SS1.p1.1.m1.1.1">𝐱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.1.m1.1c">q(\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p1.1.m1.1d">italic_q ( bold_x )</annotation></semantics></math>, to infer the value of a single one (i.e., we evaluate the quality of its estimate of <math alttext="q(x_{i}|\mathbf{x}_{-i})" class="ltx_Math" display="inline" id="S6.SS1.p1.2.m2.1"><semantics id="S6.SS1.p1.2.m2.1a"><mrow id="S6.SS1.p1.2.m2.1.1" xref="S6.SS1.p1.2.m2.1.1.cmml"><mi id="S6.SS1.p1.2.m2.1.1.3" xref="S6.SS1.p1.2.m2.1.1.3.cmml">q</mi><mo id="S6.SS1.p1.2.m2.1.1.2" xref="S6.SS1.p1.2.m2.1.1.2.cmml">⁢</mo><mrow id="S6.SS1.p1.2.m2.1.1.1.1" xref="S6.SS1.p1.2.m2.1.1.1.1.1.cmml"><mo id="S6.SS1.p1.2.m2.1.1.1.1.2" stretchy="false" xref="S6.SS1.p1.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S6.SS1.p1.2.m2.1.1.1.1.1" xref="S6.SS1.p1.2.m2.1.1.1.1.1.cmml"><msub id="S6.SS1.p1.2.m2.1.1.1.1.1.2" xref="S6.SS1.p1.2.m2.1.1.1.1.1.2.cmml"><mi id="S6.SS1.p1.2.m2.1.1.1.1.1.2.2" xref="S6.SS1.p1.2.m2.1.1.1.1.1.2.2.cmml">x</mi><mi id="S6.SS1.p1.2.m2.1.1.1.1.1.2.3" xref="S6.SS1.p1.2.m2.1.1.1.1.1.2.3.cmml">i</mi></msub><mo fence="false" id="S6.SS1.p1.2.m2.1.1.1.1.1.1" xref="S6.SS1.p1.2.m2.1.1.1.1.1.1.cmml">|</mo><msub id="S6.SS1.p1.2.m2.1.1.1.1.1.3" xref="S6.SS1.p1.2.m2.1.1.1.1.1.3.cmml"><mi id="S6.SS1.p1.2.m2.1.1.1.1.1.3.2" xref="S6.SS1.p1.2.m2.1.1.1.1.1.3.2.cmml">𝐱</mi><mrow id="S6.SS1.p1.2.m2.1.1.1.1.1.3.3" xref="S6.SS1.p1.2.m2.1.1.1.1.1.3.3.cmml"><mo id="S6.SS1.p1.2.m2.1.1.1.1.1.3.3a" xref="S6.SS1.p1.2.m2.1.1.1.1.1.3.3.cmml">−</mo><mi id="S6.SS1.p1.2.m2.1.1.1.1.1.3.3.2" xref="S6.SS1.p1.2.m2.1.1.1.1.1.3.3.2.cmml">i</mi></mrow></msub></mrow><mo id="S6.SS1.p1.2.m2.1.1.1.1.3" stretchy="false" xref="S6.SS1.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.2.m2.1b"><apply id="S6.SS1.p1.2.m2.1.1.cmml" xref="S6.SS1.p1.2.m2.1.1"><times id="S6.SS1.p1.2.m2.1.1.2.cmml" xref="S6.SS1.p1.2.m2.1.1.2"></times><ci id="S6.SS1.p1.2.m2.1.1.3.cmml" xref="S6.SS1.p1.2.m2.1.1.3">𝑞</ci><apply id="S6.SS1.p1.2.m2.1.1.1.1.1.cmml" xref="S6.SS1.p1.2.m2.1.1.1.1"><csymbol cd="latexml" id="S6.SS1.p1.2.m2.1.1.1.1.1.1.cmml" xref="S6.SS1.p1.2.m2.1.1.1.1.1.1">conditional</csymbol><apply id="S6.SS1.p1.2.m2.1.1.1.1.1.2.cmml" xref="S6.SS1.p1.2.m2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S6.SS1.p1.2.m2.1.1.1.1.1.2.1.cmml" xref="S6.SS1.p1.2.m2.1.1.1.1.1.2">subscript</csymbol><ci id="S6.SS1.p1.2.m2.1.1.1.1.1.2.2.cmml" xref="S6.SS1.p1.2.m2.1.1.1.1.1.2.2">𝑥</ci><ci id="S6.SS1.p1.2.m2.1.1.1.1.1.2.3.cmml" xref="S6.SS1.p1.2.m2.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S6.SS1.p1.2.m2.1.1.1.1.1.3.cmml" xref="S6.SS1.p1.2.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S6.SS1.p1.2.m2.1.1.1.1.1.3.1.cmml" xref="S6.SS1.p1.2.m2.1.1.1.1.1.3">subscript</csymbol><ci id="S6.SS1.p1.2.m2.1.1.1.1.1.3.2.cmml" xref="S6.SS1.p1.2.m2.1.1.1.1.1.3.2">𝐱</ci><apply id="S6.SS1.p1.2.m2.1.1.1.1.1.3.3.cmml" xref="S6.SS1.p1.2.m2.1.1.1.1.1.3.3"><minus id="S6.SS1.p1.2.m2.1.1.1.1.1.3.3.1.cmml" xref="S6.SS1.p1.2.m2.1.1.1.1.1.3.3"></minus><ci id="S6.SS1.p1.2.m2.1.1.1.1.1.3.3.2.cmml" xref="S6.SS1.p1.2.m2.1.1.1.1.1.3.3.2">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.2.m2.1c">q(x_{i}|\mathbf{x}_{-i})</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p1.2.m2.1d">italic_q ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | bold_x start_POSTSUBSCRIPT - italic_i end_POSTSUBSCRIPT )</annotation></semantics></math>).
For this purpose we pick <math alttext="x_{i}=y" class="ltx_Math" display="inline" id="S6.SS1.p1.3.m3.1"><semantics id="S6.SS1.p1.3.m3.1a"><mrow id="S6.SS1.p1.3.m3.1.1" xref="S6.SS1.p1.3.m3.1.1.cmml"><msub id="S6.SS1.p1.3.m3.1.1.2" xref="S6.SS1.p1.3.m3.1.1.2.cmml"><mi id="S6.SS1.p1.3.m3.1.1.2.2" xref="S6.SS1.p1.3.m3.1.1.2.2.cmml">x</mi><mi id="S6.SS1.p1.3.m3.1.1.2.3" xref="S6.SS1.p1.3.m3.1.1.2.3.cmml">i</mi></msub><mo id="S6.SS1.p1.3.m3.1.1.1" xref="S6.SS1.p1.3.m3.1.1.1.cmml">=</mo><mi id="S6.SS1.p1.3.m3.1.1.3" xref="S6.SS1.p1.3.m3.1.1.3.cmml">y</mi></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.3.m3.1b"><apply id="S6.SS1.p1.3.m3.1.1.cmml" xref="S6.SS1.p1.3.m3.1.1"><eq id="S6.SS1.p1.3.m3.1.1.1.cmml" xref="S6.SS1.p1.3.m3.1.1.1"></eq><apply id="S6.SS1.p1.3.m3.1.1.2.cmml" xref="S6.SS1.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S6.SS1.p1.3.m3.1.1.2.1.cmml" xref="S6.SS1.p1.3.m3.1.1.2">subscript</csymbol><ci id="S6.SS1.p1.3.m3.1.1.2.2.cmml" xref="S6.SS1.p1.3.m3.1.1.2.2">𝑥</ci><ci id="S6.SS1.p1.3.m3.1.1.2.3.cmml" xref="S6.SS1.p1.3.m3.1.1.2.3">𝑖</ci></apply><ci id="S6.SS1.p1.3.m3.1.1.3.cmml" xref="S6.SS1.p1.3.m3.1.1.3">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.3.m3.1c">x_{i}=y</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p1.3.m3.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_y</annotation></semantics></math> as the original target of the dataset, noting that the models that we train do not treat this variable in any special way, except for the selection of the best model in validation.
As such, we would expect that the model’s performance in inference over this particular variable is indicative of its strength on any other single variable inference task
and also indicative of the quality of the full <math alttext="q(\mathbf{x})" class="ltx_Math" display="inline" id="S6.SS1.p1.4.m4.1"><semantics id="S6.SS1.p1.4.m4.1a"><mrow id="S6.SS1.p1.4.m4.1.2" xref="S6.SS1.p1.4.m4.1.2.cmml"><mi id="S6.SS1.p1.4.m4.1.2.2" xref="S6.SS1.p1.4.m4.1.2.2.cmml">q</mi><mo id="S6.SS1.p1.4.m4.1.2.1" xref="S6.SS1.p1.4.m4.1.2.1.cmml">⁢</mo><mrow id="S6.SS1.p1.4.m4.1.2.3.2" xref="S6.SS1.p1.4.m4.1.2.cmml"><mo id="S6.SS1.p1.4.m4.1.2.3.2.1" stretchy="false" xref="S6.SS1.p1.4.m4.1.2.cmml">(</mo><mi id="S6.SS1.p1.4.m4.1.1" xref="S6.SS1.p1.4.m4.1.1.cmml">𝐱</mi><mo id="S6.SS1.p1.4.m4.1.2.3.2.2" stretchy="false" xref="S6.SS1.p1.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.4.m4.1b"><apply id="S6.SS1.p1.4.m4.1.2.cmml" xref="S6.SS1.p1.4.m4.1.2"><times id="S6.SS1.p1.4.m4.1.2.1.cmml" xref="S6.SS1.p1.4.m4.1.2.1"></times><ci id="S6.SS1.p1.4.m4.1.2.2.cmml" xref="S6.SS1.p1.4.m4.1.2.2">𝑞</ci><ci id="S6.SS1.p1.4.m4.1.1.cmml" xref="S6.SS1.p1.4.m4.1.1">𝐱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.4.m4.1c">q(\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p1.4.m4.1d">italic_q ( bold_x )</annotation></semantics></math> from which the conditional probability estimate is derived.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS1.p2">
<p class="ltx_p" id="S6.SS1.p2.1">We use XGBoost <cite class="ltx_cite ltx_citemacro_citep">(Chen &amp; Guestrin, <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib4" title="">2016</a>)</cite> as a baseline for what should be achievable by a strong discriminative model,
noting that it is trained to maximize the discriminative likelihood, <math alttext="\mathbb{E}_{\mathbf{x}\sim p}\log q(x_{i}|\mathbf{x}_{-i})" class="ltx_Math" display="inline" id="S6.SS1.p2.1.m1.1"><semantics id="S6.SS1.p2.1.m1.1a"><mrow id="S6.SS1.p2.1.m1.1.1" xref="S6.SS1.p2.1.m1.1.1.cmml"><msub id="S6.SS1.p2.1.m1.1.1.3" xref="S6.SS1.p2.1.m1.1.1.3.cmml"><mi id="S6.SS1.p2.1.m1.1.1.3.2" xref="S6.SS1.p2.1.m1.1.1.3.2.cmml">𝔼</mi><mrow id="S6.SS1.p2.1.m1.1.1.3.3" xref="S6.SS1.p2.1.m1.1.1.3.3.cmml"><mi id="S6.SS1.p2.1.m1.1.1.3.3.2" xref="S6.SS1.p2.1.m1.1.1.3.3.2.cmml">𝐱</mi><mo id="S6.SS1.p2.1.m1.1.1.3.3.1" xref="S6.SS1.p2.1.m1.1.1.3.3.1.cmml">∼</mo><mi id="S6.SS1.p2.1.m1.1.1.3.3.3" xref="S6.SS1.p2.1.m1.1.1.3.3.3.cmml">p</mi></mrow></msub><mo id="S6.SS1.p2.1.m1.1.1.2" lspace="0.167em" xref="S6.SS1.p2.1.m1.1.1.2.cmml">⁢</mo><mrow id="S6.SS1.p2.1.m1.1.1.4" xref="S6.SS1.p2.1.m1.1.1.4.cmml"><mi id="S6.SS1.p2.1.m1.1.1.4.1" xref="S6.SS1.p2.1.m1.1.1.4.1.cmml">log</mi><mo id="S6.SS1.p2.1.m1.1.1.4a" lspace="0.167em" xref="S6.SS1.p2.1.m1.1.1.4.cmml">⁡</mo><mi id="S6.SS1.p2.1.m1.1.1.4.2" xref="S6.SS1.p2.1.m1.1.1.4.2.cmml">q</mi></mrow><mo id="S6.SS1.p2.1.m1.1.1.2a" xref="S6.SS1.p2.1.m1.1.1.2.cmml">⁢</mo><mrow id="S6.SS1.p2.1.m1.1.1.1.1" xref="S6.SS1.p2.1.m1.1.1.1.1.1.cmml"><mo id="S6.SS1.p2.1.m1.1.1.1.1.2" stretchy="false" xref="S6.SS1.p2.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S6.SS1.p2.1.m1.1.1.1.1.1" xref="S6.SS1.p2.1.m1.1.1.1.1.1.cmml"><msub id="S6.SS1.p2.1.m1.1.1.1.1.1.2" xref="S6.SS1.p2.1.m1.1.1.1.1.1.2.cmml"><mi id="S6.SS1.p2.1.m1.1.1.1.1.1.2.2" xref="S6.SS1.p2.1.m1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S6.SS1.p2.1.m1.1.1.1.1.1.2.3" xref="S6.SS1.p2.1.m1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo fence="false" id="S6.SS1.p2.1.m1.1.1.1.1.1.1" xref="S6.SS1.p2.1.m1.1.1.1.1.1.1.cmml">|</mo><msub id="S6.SS1.p2.1.m1.1.1.1.1.1.3" xref="S6.SS1.p2.1.m1.1.1.1.1.1.3.cmml"><mi id="S6.SS1.p2.1.m1.1.1.1.1.1.3.2" xref="S6.SS1.p2.1.m1.1.1.1.1.1.3.2.cmml">𝐱</mi><mrow id="S6.SS1.p2.1.m1.1.1.1.1.1.3.3" xref="S6.SS1.p2.1.m1.1.1.1.1.1.3.3.cmml"><mo id="S6.SS1.p2.1.m1.1.1.1.1.1.3.3a" xref="S6.SS1.p2.1.m1.1.1.1.1.1.3.3.cmml">−</mo><mi id="S6.SS1.p2.1.m1.1.1.1.1.1.3.3.2" xref="S6.SS1.p2.1.m1.1.1.1.1.1.3.3.2.cmml">i</mi></mrow></msub></mrow><mo id="S6.SS1.p2.1.m1.1.1.1.1.3" stretchy="false" xref="S6.SS1.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.1.m1.1b"><apply id="S6.SS1.p2.1.m1.1.1.cmml" xref="S6.SS1.p2.1.m1.1.1"><times id="S6.SS1.p2.1.m1.1.1.2.cmml" xref="S6.SS1.p2.1.m1.1.1.2"></times><apply id="S6.SS1.p2.1.m1.1.1.3.cmml" xref="S6.SS1.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S6.SS1.p2.1.m1.1.1.3.1.cmml" xref="S6.SS1.p2.1.m1.1.1.3">subscript</csymbol><ci id="S6.SS1.p2.1.m1.1.1.3.2.cmml" xref="S6.SS1.p2.1.m1.1.1.3.2">𝔼</ci><apply id="S6.SS1.p2.1.m1.1.1.3.3.cmml" xref="S6.SS1.p2.1.m1.1.1.3.3"><csymbol cd="latexml" id="S6.SS1.p2.1.m1.1.1.3.3.1.cmml" xref="S6.SS1.p2.1.m1.1.1.3.3.1">similar-to</csymbol><ci id="S6.SS1.p2.1.m1.1.1.3.3.2.cmml" xref="S6.SS1.p2.1.m1.1.1.3.3.2">𝐱</ci><ci id="S6.SS1.p2.1.m1.1.1.3.3.3.cmml" xref="S6.SS1.p2.1.m1.1.1.3.3.3">𝑝</ci></apply></apply><apply id="S6.SS1.p2.1.m1.1.1.4.cmml" xref="S6.SS1.p2.1.m1.1.1.4"><log id="S6.SS1.p2.1.m1.1.1.4.1.cmml" xref="S6.SS1.p2.1.m1.1.1.4.1"></log><ci id="S6.SS1.p2.1.m1.1.1.4.2.cmml" xref="S6.SS1.p2.1.m1.1.1.4.2">𝑞</ci></apply><apply id="S6.SS1.p2.1.m1.1.1.1.1.1.cmml" xref="S6.SS1.p2.1.m1.1.1.1.1"><csymbol cd="latexml" id="S6.SS1.p2.1.m1.1.1.1.1.1.1.cmml" xref="S6.SS1.p2.1.m1.1.1.1.1.1.1">conditional</csymbol><apply id="S6.SS1.p2.1.m1.1.1.1.1.1.2.cmml" xref="S6.SS1.p2.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S6.SS1.p2.1.m1.1.1.1.1.1.2.1.cmml" xref="S6.SS1.p2.1.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S6.SS1.p2.1.m1.1.1.1.1.1.2.2.cmml" xref="S6.SS1.p2.1.m1.1.1.1.1.1.2.2">𝑥</ci><ci id="S6.SS1.p2.1.m1.1.1.1.1.1.2.3.cmml" xref="S6.SS1.p2.1.m1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S6.SS1.p2.1.m1.1.1.1.1.1.3.cmml" xref="S6.SS1.p2.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S6.SS1.p2.1.m1.1.1.1.1.1.3.1.cmml" xref="S6.SS1.p2.1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S6.SS1.p2.1.m1.1.1.1.1.1.3.2.cmml" xref="S6.SS1.p2.1.m1.1.1.1.1.1.3.2">𝐱</ci><apply id="S6.SS1.p2.1.m1.1.1.1.1.1.3.3.cmml" xref="S6.SS1.p2.1.m1.1.1.1.1.1.3.3"><minus id="S6.SS1.p2.1.m1.1.1.1.1.1.3.3.1.cmml" xref="S6.SS1.p2.1.m1.1.1.1.1.1.3.3"></minus><ci id="S6.SS1.p2.1.m1.1.1.1.1.1.3.3.2.cmml" xref="S6.SS1.p2.1.m1.1.1.1.1.1.3.3.2">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.1.m1.1c">\mathbb{E}_{\mathbf{x}\sim p}\log q(x_{i}|\mathbf{x}_{-i})</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p2.1.m1.1d">blackboard_E start_POSTSUBSCRIPT bold_x ∼ italic_p end_POSTSUBSCRIPT roman_log italic_q ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | bold_x start_POSTSUBSCRIPT - italic_i end_POSTSUBSCRIPT )</annotation></semantics></math>, directly,
not wasting model capacity in learning other aspects of the full data distribution.
We also compare to two other tree-based generative baselines: RFDE <cite class="ltx_cite ltx_citemacro_citep">(Wen &amp; Hang, <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib31" title="">2022</a>)</cite> and ARF (FORDE) <cite class="ltx_cite ltx_citemacro_citep">(Watson et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib29" title="">2023</a>)</cite>.
The former allows us to gauge the impact of the guided partitioning used in DEF models over a random partitioning of the input space.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS1.p3">
<p class="ltx_p" id="S6.SS1.p3.1">We use random search to tune the hyperparameters of the XGBoost model and a grid search to tune the most important hyperparameters of each generative density model.
We employ 5-fold cross-validation, repeating the hyperparameter tuning on each fold.
For the full details of the experimental protocol please refer to Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A4" title="Appendix D Reproducibility ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">D</span></a>.</p>
</div>
<figure class="ltx_table" id="S6.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Discriminative performance of different methods at inferring the value of a target variable. We use <math alttext="R^{2}" class="ltx_Math" display="inline" id="S6.T1.3.m1.1"><semantics id="S6.T1.3.m1.1b"><msup id="S6.T1.3.m1.1.1" xref="S6.T1.3.m1.1.1.cmml"><mi id="S6.T1.3.m1.1.1.2" xref="S6.T1.3.m1.1.1.2.cmml">R</mi><mn id="S6.T1.3.m1.1.1.3" xref="S6.T1.3.m1.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S6.T1.3.m1.1c"><apply id="S6.T1.3.m1.1.1.cmml" xref="S6.T1.3.m1.1.1"><csymbol cd="ambiguous" id="S6.T1.3.m1.1.1.1.cmml" xref="S6.T1.3.m1.1.1">superscript</csymbol><ci id="S6.T1.3.m1.1.1.2.cmml" xref="S6.T1.3.m1.1.1.2">𝑅</ci><cn id="S6.T1.3.m1.1.1.3.cmml" type="integer" xref="S6.T1.3.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.3.m1.1d">R^{2}</annotation><annotation encoding="application/x-llamapun" id="S6.T1.3.m1.1e">italic_R start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> for regression tasks, AUC for binary classification and accuracy for multiclass classification.
The reported values are means and standard errors over 5 cross-validation folds.
The best <em class="ltx_emph ltx_font_italic" id="S6.T1.13.1">generative method</em> for each dataset is highlighted in <span class="ltx_text ltx_font_bold" id="S6.T1.14.2">bold</span> and other methods that are not significantly worse (as determined by a paired <math alttext="t" class="ltx_Math" display="inline" id="S6.T1.4.m2.1"><semantics id="S6.T1.4.m2.1b"><mi id="S6.T1.4.m2.1.1" xref="S6.T1.4.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S6.T1.4.m2.1c"><ci id="S6.T1.4.m2.1.1.cmml" xref="S6.T1.4.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.4.m2.1d">t</annotation><annotation encoding="application/x-llamapun" id="S6.T1.4.m2.1e">italic_t</annotation></semantics></math>-test at a 95% confidence level) are <span class="ltx_text ltx_framed ltx_framed_underline" id="S6.T1.15.3">underlined</span>.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_centering ltx_figure_panel ltx_align_middle" id="S6.T1.9">
<tr class="ltx_tr" id="S6.T1.8.4">
<td class="ltx_td ltx_border_tt" id="S6.T1.8.4.5"></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="S6.T1.6.2.2">
<math alttext="R^{2}" class="ltx_Math" display="inline" id="S6.T1.5.1.1.m1.1"><semantics id="S6.T1.5.1.1.m1.1a"><msup id="S6.T1.5.1.1.m1.1.1" xref="S6.T1.5.1.1.m1.1.1.cmml"><mi id="S6.T1.5.1.1.m1.1.1.2" xref="S6.T1.5.1.1.m1.1.1.2.cmml">R</mi><mn id="S6.T1.5.1.1.m1.1.1.3" xref="S6.T1.5.1.1.m1.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S6.T1.5.1.1.m1.1b"><apply id="S6.T1.5.1.1.m1.1.1.cmml" xref="S6.T1.5.1.1.m1.1.1"><csymbol cd="ambiguous" id="S6.T1.5.1.1.m1.1.1.1.cmml" xref="S6.T1.5.1.1.m1.1.1">superscript</csymbol><ci id="S6.T1.5.1.1.m1.1.1.2.cmml" xref="S6.T1.5.1.1.m1.1.1.2">𝑅</ci><cn id="S6.T1.5.1.1.m1.1.1.3.cmml" type="integer" xref="S6.T1.5.1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.5.1.1.m1.1c">R^{2}</annotation><annotation encoding="application/x-llamapun" id="S6.T1.5.1.1.m1.1d">italic_R start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> <math alttext="\uparrow" class="ltx_Math" display="inline" id="S6.T1.6.2.2.m2.1"><semantics id="S6.T1.6.2.2.m2.1a"><mo id="S6.T1.6.2.2.m2.1.1" stretchy="false" xref="S6.T1.6.2.2.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S6.T1.6.2.2.m2.1b"><ci id="S6.T1.6.2.2.m2.1.1.cmml" xref="S6.T1.6.2.2.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.6.2.2.m2.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S6.T1.6.2.2.m2.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S6.T1.7.3.3">AUC <math alttext="\uparrow" class="ltx_Math" display="inline" id="S6.T1.7.3.3.m1.1"><semantics id="S6.T1.7.3.3.m1.1a"><mo id="S6.T1.7.3.3.m1.1.1" stretchy="false" xref="S6.T1.7.3.3.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S6.T1.7.3.3.m1.1b"><ci id="S6.T1.7.3.3.m1.1.1.cmml" xref="S6.T1.7.3.3.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.7.3.3.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S6.T1.7.3.3.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S6.T1.8.4.4">Accuracy <math alttext="\uparrow" class="ltx_Math" display="inline" id="S6.T1.8.4.4.m1.1"><semantics id="S6.T1.8.4.4.m1.1a"><mo id="S6.T1.8.4.4.m1.1.1" stretchy="false" xref="S6.T1.8.4.4.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S6.T1.8.4.4.m1.1b"><ci id="S6.T1.8.4.4.m1.1.1.cmml" xref="S6.T1.8.4.4.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.8.4.4.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S6.T1.8.4.4.m1.1d">↑</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S6.T1.9.6">
<td class="ltx_td" id="S6.T1.9.6.1"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T1.9.6.2">AB</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T1.9.6.3">CH</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T1.9.6.4">PR</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T1.9.6.5">AD</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T1.9.6.6">MBNE</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T1.9.6.7">MNIST</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S6.T1.9.6.8">CT</td>
</tr>
<tr class="ltx_tr" id="S6.T1.9.7">
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T1.9.7.1">XGBoost</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T1.9.7.2">0.552 ±0.035</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T1.9.7.3">0.849 ±0.009</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T1.9.7.4">0.678 ±0.004</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T1.9.7.5">0.927 ±0.000</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T1.9.7.6">0.987 ±0.000</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T1.9.7.7">0.976 ±0.002</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S6.T1.9.7.8">0.971 ±0.001</td>
</tr>
<tr class="ltx_tr" id="S6.T1.9.8">
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T1.9.8.1">RFDE</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T1.9.8.2">0.071 ±0.096</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T1.9.8.3">0.340 ±0.004</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T1.9.8.4">0.059 ±0.007</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T1.9.8.5">0.862 ±0.002</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T1.9.8.6">0.668 ±0.008</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T1.9.8.7">0.302 ±0.010</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S6.T1.9.8.8">0.679 ±0.002</td>
</tr>
<tr class="ltx_tr" id="S6.T1.9.5">
<td class="ltx_td ltx_align_left" id="S6.T1.9.5.2">ARF</td>
<td class="ltx_td ltx_align_center" id="S6.T1.9.5.3">0.531 ±0.032</td>
<td class="ltx_td ltx_align_center" id="S6.T1.9.5.4">0.758 ±0.009</td>
<td class="ltx_td ltx_align_center" id="S6.T1.9.5.5">0.591 ±0.007</td>
<td class="ltx_td ltx_align_center" id="S6.T1.9.5.6">0.893 ±0.002</td>
<td class="ltx_td ltx_align_center" id="S6.T1.9.5.7">0.968 ±0.001</td>
<td class="ltx_td ltx_align_center" id="S6.T1.9.5.1">-<sup class="ltx_sup" id="S6.T1.9.5.1.1">∗</sup>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T1.9.5.8">0.938 ±0.005</td>
</tr>
<tr class="ltx_tr" id="S6.T1.9.9">
<td class="ltx_td ltx_align_left" id="S6.T1.9.9.1">DEF (ISE)</td>
<td class="ltx_td ltx_align_center" id="S6.T1.9.9.2">0.467 ±0.037</td>
<td class="ltx_td ltx_align_center" id="S6.T1.9.9.3">0.737 ±0.008</td>
<td class="ltx_td ltx_align_center" id="S6.T1.9.9.4">0.566 ±0.002</td>
<td class="ltx_td ltx_align_center" id="S6.T1.9.9.5">0.854 ±0.003</td>
<td class="ltx_td ltx_align_center" id="S6.T1.9.9.6">0.653 ±0.011</td>
<td class="ltx_td ltx_align_center" id="S6.T1.9.9.7">0.206 ±0.011</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T1.9.9.8">0.790 ±0.003</td>
</tr>
<tr class="ltx_tr" id="S6.T1.9.10">
<td class="ltx_td ltx_align_left" id="S6.T1.9.10.1">DEF (KL)</td>
<td class="ltx_td ltx_align_center" id="S6.T1.9.10.2">0.482 ±0.027</td>
<td class="ltx_td ltx_align_center" id="S6.T1.9.10.3">0.801 ±0.008</td>
<td class="ltx_td ltx_align_center" id="S6.T1.9.10.4">0.639 ±0.004</td>
<td class="ltx_td ltx_align_center" id="S6.T1.9.10.5">0.892 ±0.001</td>
<td class="ltx_td ltx_align_center" id="S6.T1.9.10.6">0.939 ±0.001</td>
<td class="ltx_td ltx_align_center" id="S6.T1.9.10.7">0.487 ±0.007</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T1.9.10.8">0.852 ±0.002</td>
</tr>
<tr class="ltx_tr" id="S6.T1.9.11">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S6.T1.9.11.1">NRGBoost</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T1.9.11.2"><span class="ltx_text ltx_font_bold" id="S6.T1.9.11.2.1">0.547 ±0.036</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T1.9.11.3"><span class="ltx_text ltx_font_bold" id="S6.T1.9.11.3.1">0.850 ±0.011</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T1.9.11.4"><span class="ltx_text ltx_font_bold" id="S6.T1.9.11.4.1">0.676 ±0.009</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T1.9.11.5"><span class="ltx_text ltx_font_bold" id="S6.T1.9.11.5.1">0.920 ±0.001</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T1.9.11.6"><span class="ltx_text ltx_font_bold" id="S6.T1.9.11.6.1">0.974 ±0.001</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T1.9.11.7"><span class="ltx_text ltx_font_bold" id="S6.T1.9.11.7.1">0.966 ±0.001</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" id="S6.T1.9.11.8"><span class="ltx_text ltx_font_bold" id="S6.T1.9.11.8.1">0.948 ±0.001</span></td>
</tr>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<ul class="ltx_itemize ltx_centering ltx_figure_panel" id="S6.I1">
<li class="ltx_item" id="S6.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S6.I1.i1.p1">
<p class="ltx_p" id="S6.I1.i1.p1.1"><sup class="ltx_sup" id="S6.I1.i1.p1.1.1">∗</sup> Due to the discrete nature of the MNIST dataset and the fact that the ARF algorithm tries to fit continuous distributions at the leaves, we could not obtain a reasonable density model for this dataset.</p>
</div>
</li>
</ul>
</div>
</div>
</figure>
<div class="ltx_para ltx_noindent" id="S6.SS1.p4">
<p class="ltx_p" id="S6.SS1.p4.2">We find that NRGBoost outperforms the remaining generative models (see Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S6.T1" title="Table 1 ‣ 6.1 Single Variable Inference ‣ 6 Experiments ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">1</span></a>), even achieving comparable performance to XGBoost on the smaller datasets and with a small gap on the three larger ones (MBNE, MNIST, CT).
We note also that for the regression datasets, the generative models provide an estimate of the full conditional distribution over the target variable rather than a point estimate like XGBoost.
While there are other variants of boosting that can do the same <cite class="ltx_cite ltx_citemacro_citep">(Duan et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib9" title="">2020</a>)</cite>, they rely on a parametric assumption about <math alttext="p(y|\mathbf{x})" class="ltx_Math" display="inline" id="S6.SS1.p4.1.m1.1"><semantics id="S6.SS1.p4.1.m1.1a"><mrow id="S6.SS1.p4.1.m1.1.1" xref="S6.SS1.p4.1.m1.1.1.cmml"><mi id="S6.SS1.p4.1.m1.1.1.3" xref="S6.SS1.p4.1.m1.1.1.3.cmml">p</mi><mo id="S6.SS1.p4.1.m1.1.1.2" xref="S6.SS1.p4.1.m1.1.1.2.cmml">⁢</mo><mrow id="S6.SS1.p4.1.m1.1.1.1.1" xref="S6.SS1.p4.1.m1.1.1.1.1.1.cmml"><mo id="S6.SS1.p4.1.m1.1.1.1.1.2" stretchy="false" xref="S6.SS1.p4.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S6.SS1.p4.1.m1.1.1.1.1.1" xref="S6.SS1.p4.1.m1.1.1.1.1.1.cmml"><mi id="S6.SS1.p4.1.m1.1.1.1.1.1.2" xref="S6.SS1.p4.1.m1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S6.SS1.p4.1.m1.1.1.1.1.1.1" xref="S6.SS1.p4.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S6.SS1.p4.1.m1.1.1.1.1.1.3" xref="S6.SS1.p4.1.m1.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo id="S6.SS1.p4.1.m1.1.1.1.1.3" stretchy="false" xref="S6.SS1.p4.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p4.1.m1.1b"><apply id="S6.SS1.p4.1.m1.1.1.cmml" xref="S6.SS1.p4.1.m1.1.1"><times id="S6.SS1.p4.1.m1.1.1.2.cmml" xref="S6.SS1.p4.1.m1.1.1.2"></times><ci id="S6.SS1.p4.1.m1.1.1.3.cmml" xref="S6.SS1.p4.1.m1.1.1.3">𝑝</ci><apply id="S6.SS1.p4.1.m1.1.1.1.1.1.cmml" xref="S6.SS1.p4.1.m1.1.1.1.1"><csymbol cd="latexml" id="S6.SS1.p4.1.m1.1.1.1.1.1.1.cmml" xref="S6.SS1.p4.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S6.SS1.p4.1.m1.1.1.1.1.1.2.cmml" xref="S6.SS1.p4.1.m1.1.1.1.1.1.2">𝑦</ci><ci id="S6.SS1.p4.1.m1.1.1.1.1.1.3.cmml" xref="S6.SS1.p4.1.m1.1.1.1.1.1.3">𝐱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p4.1.m1.1c">p(y|\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p4.1.m1.1d">italic_p ( italic_y | bold_x )</annotation></semantics></math> that needs to hold for any <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S6.SS1.p4.2.m2.1"><semantics id="S6.SS1.p4.2.m2.1a"><mi id="S6.SS1.p4.2.m2.1.1" xref="S6.SS1.p4.2.m2.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S6.SS1.p4.2.m2.1b"><ci id="S6.SS1.p4.2.m2.1.1.cmml" xref="S6.SS1.p4.2.m2.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p4.2.m2.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p4.2.m2.1d">bold_x</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.2 </span>Sampling</h3>
<div class="ltx_para ltx_noindent" id="S6.SS2.p1">
<p class="ltx_p" id="S6.SS2.p1.1">We evaluate two different aspects of the quality of generated samples: their utility for training a machine learning model and how distinguishable they are from real data.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS2.p2">
<p class="ltx_p" id="S6.SS2.p2.1">Besides ARF, we compare to TVAE <cite class="ltx_cite ltx_citemacro_citep">(Xu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib32" title="">2019</a>)</cite> and TabDDPM <cite class="ltx_cite ltx_citemacro_citep">(Kotelnikov et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib19" title="">2023</a>)</cite>, two neural-network based generative models, as well as Forest-Flow <cite class="ltx_cite ltx_citemacro_citep">(Jolicoeur-Martineau et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib16" title="">2024</a>)</cite>, a tree-based diffusion model.
Note that these three methods are not capable of density estimation.</p>
</div>
<section class="ltx_paragraph" id="S6.SS2.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Machine Learning Efficiency</h5>
<div class="ltx_para ltx_noindent" id="S6.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S6.SS2.SSS0.Px1.p1.1">Machine learning (ML) efficiency has been a popular way to measure the quality of generative models for sampling <cite class="ltx_cite ltx_citemacro_citep">(Xu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib32" title="">2019</a>; Borisov et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib3" title="">2022b</a>; Kotelnikov et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib19" title="">2023</a>)</cite>.
It relies on using samples from a generative model to train a discriminative model which is then evaluated on real data,
and is thus similar to the single variable inference performance that we use to compare density models in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S6.SS1" title="6.1 Single Variable Inference ‣ 6 Experiments ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">6.1</span></a>.
In fact, if the density model’s support covers that of the full data, one would expect the discriminative model to recover the generator’s <math alttext="q(y|\mathbf{x})" class="ltx_Math" display="inline" id="S6.SS2.SSS0.Px1.p1.1.m1.1"><semantics id="S6.SS2.SSS0.Px1.p1.1.m1.1a"><mrow id="S6.SS2.SSS0.Px1.p1.1.m1.1.1" xref="S6.SS2.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S6.SS2.SSS0.Px1.p1.1.m1.1.1.3" xref="S6.SS2.SSS0.Px1.p1.1.m1.1.1.3.cmml">q</mi><mo id="S6.SS2.SSS0.Px1.p1.1.m1.1.1.2" xref="S6.SS2.SSS0.Px1.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S6.SS2.SSS0.Px1.p1.1.m1.1.1.1.1" xref="S6.SS2.SSS0.Px1.p1.1.m1.1.1.1.1.1.cmml"><mo id="S6.SS2.SSS0.Px1.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S6.SS2.SSS0.Px1.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S6.SS2.SSS0.Px1.p1.1.m1.1.1.1.1.1" xref="S6.SS2.SSS0.Px1.p1.1.m1.1.1.1.1.1.cmml"><mi id="S6.SS2.SSS0.Px1.p1.1.m1.1.1.1.1.1.2" xref="S6.SS2.SSS0.Px1.p1.1.m1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S6.SS2.SSS0.Px1.p1.1.m1.1.1.1.1.1.1" xref="S6.SS2.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S6.SS2.SSS0.Px1.p1.1.m1.1.1.1.1.1.3" xref="S6.SS2.SSS0.Px1.p1.1.m1.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo id="S6.SS2.SSS0.Px1.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S6.SS2.SSS0.Px1.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.SSS0.Px1.p1.1.m1.1b"><apply id="S6.SS2.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S6.SS2.SSS0.Px1.p1.1.m1.1.1"><times id="S6.SS2.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S6.SS2.SSS0.Px1.p1.1.m1.1.1.2"></times><ci id="S6.SS2.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S6.SS2.SSS0.Px1.p1.1.m1.1.1.3">𝑞</ci><apply id="S6.SS2.SSS0.Px1.p1.1.m1.1.1.1.1.1.cmml" xref="S6.SS2.SSS0.Px1.p1.1.m1.1.1.1.1"><csymbol cd="latexml" id="S6.SS2.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.cmml" xref="S6.SS2.SSS0.Px1.p1.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S6.SS2.SSS0.Px1.p1.1.m1.1.1.1.1.1.2.cmml" xref="S6.SS2.SSS0.Px1.p1.1.m1.1.1.1.1.1.2">𝑦</ci><ci id="S6.SS2.SSS0.Px1.p1.1.m1.1.1.1.1.1.3.cmml" xref="S6.SS2.SSS0.Px1.p1.1.m1.1.1.1.1.1.3">𝐱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.SSS0.Px1.p1.1.m1.1c">q(y|\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.SSS0.Px1.p1.1.m1.1d">italic_q ( italic_y | bold_x )</annotation></semantics></math>, and therefore its performance, in the limit where infinite generated data is used to train it.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS2.SSS0.Px1.p2">
<p class="ltx_p" id="S6.SS2.SSS0.Px1.p2.1">We use an XGBoost model as the discriminative model and train it on the same number of training samples as the original data.
For the density models, we generate samples from the best model found in the previous section and for TVAE and TabDDM we select their hyperparameters by evaluating the ML Efficiency in the real validation set
(full details of the hyperparameter tuning are provided in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A4.SS2" title="D.2 DEF and NRGBoost Implementation Details ‣ Appendix D Reproducibility ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">D.2</span></a>).
Note that this leaves these models at a potential advantage since the hyperparameter selection is based on the metric that is being evaluated.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS2.SSS0.Px1.p3">
<p class="ltx_p" id="S6.SS2.SSS0.Px1.p3.1">We repeat all experiments 5 times, with different generated datatsets from each model and report the performance of the discriminative model in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S6.T2" title="Table 2 ‣ Machine Learning Efficiency ‣ 6.2 Sampling ‣ 6 Experiments ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">2</span></a>.
We find that NRGBoost and TabDDPM alternate as the best-performing model depending on the dataset (with two inconclusive cases), and NRGBoost is never ranked lower than second on any dataset.
We note also that, despite our best efforts with additional manual tuning, we could not achieve a reasonable model with TabDDM on MNIST.</p>
</div>
<figure class="ltx_table" id="S6.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>Performance of an XGBoost model trained on synthetic data and on real data (for reference).
For consistency, we use the same discriminative metrics as in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S6.T1" title="Table 1 ‣ 6.1 Single Variable Inference ‣ 6 Experiments ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">1</span></a> for evaluating its performance.
Reported values are the averages and standard errors over 5 synthetic datasets generated by the same generative model.
The best generative method for each dataset is highlighted in <span class="ltx_text ltx_font_bold" id="S6.T2.9.1">bold</span> and methods that are not significantly worse (as determined by a <math alttext="t" class="ltx_Math" display="inline" id="S6.T2.2.m1.1"><semantics id="S6.T2.2.m1.1b"><mi id="S6.T2.2.m1.1.1" xref="S6.T2.2.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S6.T2.2.m1.1c"><ci id="S6.T2.2.m1.1.1.cmml" xref="S6.T2.2.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.2.m1.1d">t</annotation><annotation encoding="application/x-llamapun" id="S6.T2.2.m1.1e">italic_t</annotation></semantics></math>-test at a 95% confidence level) are <span class="ltx_text ltx_framed ltx_framed_underline" id="S6.T2.10.2">underlined</span>.
</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S6.T2.6">
<tr class="ltx_tr" id="S6.T2.6.4">
<td class="ltx_td ltx_border_tt" id="S6.T2.6.4.5" style="padding-left:5.9pt;padding-right:5.9pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="S6.T2.4.2.2" style="padding-left:5.9pt;padding-right:5.9pt;">
<math alttext="R^{2}" class="ltx_Math" display="inline" id="S6.T2.3.1.1.m1.1"><semantics id="S6.T2.3.1.1.m1.1a"><msup id="S6.T2.3.1.1.m1.1.1" xref="S6.T2.3.1.1.m1.1.1.cmml"><mi id="S6.T2.3.1.1.m1.1.1.2" xref="S6.T2.3.1.1.m1.1.1.2.cmml">R</mi><mn id="S6.T2.3.1.1.m1.1.1.3" xref="S6.T2.3.1.1.m1.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S6.T2.3.1.1.m1.1b"><apply id="S6.T2.3.1.1.m1.1.1.cmml" xref="S6.T2.3.1.1.m1.1.1"><csymbol cd="ambiguous" id="S6.T2.3.1.1.m1.1.1.1.cmml" xref="S6.T2.3.1.1.m1.1.1">superscript</csymbol><ci id="S6.T2.3.1.1.m1.1.1.2.cmml" xref="S6.T2.3.1.1.m1.1.1.2">𝑅</ci><cn id="S6.T2.3.1.1.m1.1.1.3.cmml" type="integer" xref="S6.T2.3.1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.3.1.1.m1.1c">R^{2}</annotation><annotation encoding="application/x-llamapun" id="S6.T2.3.1.1.m1.1d">italic_R start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> <math alttext="\uparrow" class="ltx_Math" display="inline" id="S6.T2.4.2.2.m2.1"><semantics id="S6.T2.4.2.2.m2.1a"><mo id="S6.T2.4.2.2.m2.1.1" stretchy="false" xref="S6.T2.4.2.2.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S6.T2.4.2.2.m2.1b"><ci id="S6.T2.4.2.2.m2.1.1.cmml" xref="S6.T2.4.2.2.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.4.2.2.m2.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S6.T2.4.2.2.m2.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S6.T2.5.3.3" style="padding-left:5.9pt;padding-right:5.9pt;">AUC <math alttext="\uparrow" class="ltx_Math" display="inline" id="S6.T2.5.3.3.m1.1"><semantics id="S6.T2.5.3.3.m1.1a"><mo id="S6.T2.5.3.3.m1.1.1" stretchy="false" xref="S6.T2.5.3.3.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S6.T2.5.3.3.m1.1b"><ci id="S6.T2.5.3.3.m1.1.1.cmml" xref="S6.T2.5.3.3.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.5.3.3.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S6.T2.5.3.3.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S6.T2.6.4.4" style="padding-left:5.9pt;padding-right:5.9pt;">Accuracy <math alttext="\uparrow" class="ltx_Math" display="inline" id="S6.T2.6.4.4.m1.1"><semantics id="S6.T2.6.4.4.m1.1a"><mo id="S6.T2.6.4.4.m1.1.1" stretchy="false" xref="S6.T2.6.4.4.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S6.T2.6.4.4.m1.1b"><ci id="S6.T2.6.4.4.m1.1.1.cmml" xref="S6.T2.6.4.4.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.6.4.4.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S6.T2.6.4.4.m1.1d">↑</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S6.T2.6.5">
<td class="ltx_td" id="S6.T2.6.5.1" style="padding-left:5.9pt;padding-right:5.9pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.6.5.2" style="padding-left:5.9pt;padding-right:5.9pt;">AB</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.6.5.3" style="padding-left:5.9pt;padding-right:5.9pt;">CH</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.6.5.4" style="padding-left:5.9pt;padding-right:5.9pt;">PR</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.6.5.5" style="padding-left:5.9pt;padding-right:5.9pt;">AD</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.6.5.6" style="padding-left:5.9pt;padding-right:5.9pt;">MBNE</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.6.5.7" style="padding-left:5.9pt;padding-right:5.9pt;">MNIST</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S6.T2.6.5.8" style="padding-left:5.9pt;padding-right:5.9pt;">CT</td>
</tr>
<tr class="ltx_tr" id="S6.T2.6.6">
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.6.6.1" style="padding-left:5.9pt;padding-right:5.9pt;">Real Data</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.6.6.2" style="padding-left:5.9pt;padding-right:5.9pt;">0.554</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.6.6.3" style="padding-left:5.9pt;padding-right:5.9pt;">0.838</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.6.6.4" style="padding-left:5.9pt;padding-right:5.9pt;">0.682</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.6.6.5" style="padding-left:5.9pt;padding-right:5.9pt;">0.927</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.6.6.6" style="padding-left:5.9pt;padding-right:5.9pt;">0.987</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.6.6.7" style="padding-left:5.9pt;padding-right:5.9pt;">0.976</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S6.T2.6.6.8" style="padding-left:5.9pt;padding-right:5.9pt;">0.972</td>
</tr>
<tr class="ltx_tr" id="S6.T2.6.7">
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.6.7.1" style="padding-left:5.9pt;padding-right:5.9pt;">TVAE</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.6.7.2" style="padding-left:5.9pt;padding-right:5.9pt;">0.483 ±0.006</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.6.7.3" style="padding-left:5.9pt;padding-right:5.9pt;">0.758 ±0.005</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.6.7.4" style="padding-left:5.9pt;padding-right:5.9pt;">0.365 ±0.005</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.6.7.5" style="padding-left:5.9pt;padding-right:5.9pt;">0.898 ±0.001</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.6.7.6" style="padding-left:5.9pt;padding-right:5.9pt;">0.975 ±0.000</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.6.7.7" style="padding-left:5.9pt;padding-right:5.9pt;">0.770 ±0.009</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S6.T2.6.7.8" style="padding-left:5.9pt;padding-right:5.9pt;">0.750 ±0.002</td>
</tr>
<tr class="ltx_tr" id="S6.T2.6.8">
<td class="ltx_td ltx_align_left" id="S6.T2.6.8.1" style="padding-left:5.9pt;padding-right:5.9pt;">TabDDPM</td>
<td class="ltx_td ltx_align_center" id="S6.T2.6.8.2" style="padding-left:5.9pt;padding-right:5.9pt;"><span class="ltx_text ltx_font_bold" id="S6.T2.6.8.2.1">0.539 ±0.018</span></td>
<td class="ltx_td ltx_align_center" id="S6.T2.6.8.3" style="padding-left:5.9pt;padding-right:5.9pt;"><span class="ltx_text ltx_font_bold" id="S6.T2.6.8.3.1">0.807 ±0.005</span></td>
<td class="ltx_td ltx_align_center" id="S6.T2.6.8.4" style="padding-left:5.9pt;padding-right:5.9pt;"><span class="ltx_text ltx_font_bold" id="S6.T2.6.8.4.1">0.596 ±0.007</span></td>
<td class="ltx_td ltx_align_center" id="S6.T2.6.8.5" style="padding-left:5.9pt;padding-right:5.9pt;">0.910 ±0.001</td>
<td class="ltx_td ltx_align_center" id="S6.T2.6.8.6" style="padding-left:5.9pt;padding-right:5.9pt;"><span class="ltx_text ltx_font_bold" id="S6.T2.6.8.6.1">0.984 ±0.000</span></td>
<td class="ltx_td ltx_align_center" id="S6.T2.6.8.7" style="padding-left:5.9pt;padding-right:5.9pt;">-</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T2.6.8.8" style="padding-left:5.9pt;padding-right:5.9pt;">0.818 ±0.001</td>
</tr>
<tr class="ltx_tr" id="S6.T2.6.9">
<td class="ltx_td ltx_align_left" id="S6.T2.6.9.1" style="padding-left:5.9pt;padding-right:5.9pt;">Forest-Flow</td>
<td class="ltx_td ltx_align_center" id="S6.T2.6.9.2" style="padding-left:5.9pt;padding-right:5.9pt;">0.418 ±0.019</td>
<td class="ltx_td ltx_align_center" id="S6.T2.6.9.3" style="padding-left:5.9pt;padding-right:5.9pt;">0.716 ±0.003</td>
<td class="ltx_td ltx_align_center" id="S6.T2.6.9.4" style="padding-left:5.9pt;padding-right:5.9pt;">0.412 ±0.009</td>
<td class="ltx_td ltx_align_center" id="S6.T2.6.9.5" style="padding-left:5.9pt;padding-right:5.9pt;">0.879 ±0.003</td>
<td class="ltx_td ltx_align_center" id="S6.T2.6.9.6" style="padding-left:5.9pt;padding-right:5.9pt;">0.964 ±0.001</td>
<td class="ltx_td ltx_align_center" id="S6.T2.6.9.7" style="padding-left:5.9pt;padding-right:5.9pt;">0.224 ±0.010</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T2.6.9.8" style="padding-left:5.9pt;padding-right:5.9pt;">0.705 ±0.002</td>
</tr>
<tr class="ltx_tr" id="S6.T2.6.10">
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.6.10.1" style="padding-left:5.9pt;padding-right:5.9pt;">ARF</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.6.10.2" style="padding-left:5.9pt;padding-right:5.9pt;">0.504 ±0.020</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.6.10.3" style="padding-left:5.9pt;padding-right:5.9pt;">0.739 ±0.003</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.6.10.4" style="padding-left:5.9pt;padding-right:5.9pt;">0.524 ±0.003</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.6.10.5" style="padding-left:5.9pt;padding-right:5.9pt;">0.901 ±0.001</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.6.10.6" style="padding-left:5.9pt;padding-right:5.9pt;">0.971 ±0.001</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.6.10.7" style="padding-left:5.9pt;padding-right:5.9pt;">0.908 ±0.002</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S6.T2.6.10.8" style="padding-left:5.9pt;padding-right:5.9pt;">0.848 ±0.002</td>
</tr>
<tr class="ltx_tr" id="S6.T2.6.11">
<td class="ltx_td ltx_align_left" id="S6.T2.6.11.1" style="padding-left:5.9pt;padding-right:5.9pt;">DEF (KL)</td>
<td class="ltx_td ltx_align_center" id="S6.T2.6.11.2" style="padding-left:5.9pt;padding-right:5.9pt;">0.450 ±0.013</td>
<td class="ltx_td ltx_align_center" id="S6.T2.6.11.3" style="padding-left:5.9pt;padding-right:5.9pt;">0.762 ±0.006</td>
<td class="ltx_td ltx_align_center" id="S6.T2.6.11.4" style="padding-left:5.9pt;padding-right:5.9pt;">0.498 ±0.007</td>
<td class="ltx_td ltx_align_center" id="S6.T2.6.11.5" style="padding-left:5.9pt;padding-right:5.9pt;">0.892 ±0.001</td>
<td class="ltx_td ltx_align_center" id="S6.T2.6.11.6" style="padding-left:5.9pt;padding-right:5.9pt;">0.943 ±0.002</td>
<td class="ltx_td ltx_align_center" id="S6.T2.6.11.7" style="padding-left:5.9pt;padding-right:5.9pt;">0.230 ±0.028</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T2.6.11.8" style="padding-left:5.9pt;padding-right:5.9pt;">0.753 ±0.002</td>
</tr>
<tr class="ltx_tr" id="S6.T2.6.12">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S6.T2.6.12.1" style="padding-left:5.9pt;padding-right:5.9pt;">NRGBoost</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T2.6.12.2" style="padding-left:5.9pt;padding-right:5.9pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S6.T2.6.12.2.1">0.528 ±0.016</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T2.6.12.3" style="padding-left:5.9pt;padding-right:5.9pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S6.T2.6.12.3.1">0.801 ±0.001</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T2.6.12.4" style="padding-left:5.9pt;padding-right:5.9pt;">0.573 ±0.008</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T2.6.12.5" style="padding-left:5.9pt;padding-right:5.9pt;"><span class="ltx_text ltx_font_bold" id="S6.T2.6.12.5.1">0.914 ±0.001</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T2.6.12.6" style="padding-left:5.9pt;padding-right:5.9pt;">0.977 ±0.001</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T2.6.12.7" style="padding-left:5.9pt;padding-right:5.9pt;"><span class="ltx_text ltx_font_bold" id="S6.T2.6.12.7.1">0.959 ±0.001</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" id="S6.T2.6.12.8" style="padding-left:5.9pt;padding-right:5.9pt;"><span class="ltx_text ltx_font_bold" id="S6.T2.6.12.8.1">0.895 ±0.001</span></td>
</tr>
</table>
</figure>
<figure class="ltx_figure" id="S6.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="336" id="S6.F3.g1" src="x3.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Joint histogram for the latitude and longitude for the California Housing dataset.</figcaption>
</figure>
</section>
<section class="ltx_paragraph" id="S6.SS2.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Discriminator Measure</h5>
<div class="ltx_para ltx_noindent" id="S6.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="S6.SS2.SSS0.Px2.p1.1">Similar to <cite class="ltx_cite ltx_citemacro_citet">Borisov et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib3" title="">2022b</a>)</cite> we test the capacity of a discriminative model to distinguish between real and generated data.
We use the original validation set as the real part of the training data for the discriminator in order to avoid benefiting generative methods that overfit their original training set.
A new validation set is carved out of the original test set (20%) and used to tune the hyperparameters of an XGBoost model which we use as our discriminator.
We report the AUC of this model on the remainder of the real test data in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S6.T3" title="Table 3 ‣ Discriminator Measure ‣ 6.2 Sampling ‣ 6 Experiments ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">3</span></a> which shows that NRGBoost outperforms other methods except on the PR (with an inconclusive result) and MBNE datasets.</p>
</div>
<figure class="ltx_table" id="S6.T3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>
AUC of an XGBoost model trained to distinguish real from generated data (lower means better).
Reported values are the averages and standard errors over 5 synthetic datasets generated by the same model.
The best generative method for each dataset is highlighted in <span class="ltx_text ltx_font_bold" id="S6.T3.5.1">bold</span> and methods that are not significantly worse (as determined by a <math alttext="t" class="ltx_Math" display="inline" id="S6.T3.2.m1.1"><semantics id="S6.T3.2.m1.1b"><mi id="S6.T3.2.m1.1.1" xref="S6.T3.2.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S6.T3.2.m1.1c"><ci id="S6.T3.2.m1.1.1.cmml" xref="S6.T3.2.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T3.2.m1.1d">t</annotation><annotation encoding="application/x-llamapun" id="S6.T3.2.m1.1e">italic_t</annotation></semantics></math>-test at a 95% confidence level) are <span class="ltx_text ltx_framed ltx_framed_underline" id="S6.T3.6.2">underlined</span>.
</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S6.T3.7">
<tr class="ltx_tr" id="S6.T3.7.1">
<td class="ltx_td ltx_border_tt" id="S6.T3.7.1.1" style="padding-left:5.9pt;padding-right:5.9pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T3.7.1.2" style="padding-left:5.9pt;padding-right:5.9pt;">AB</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T3.7.1.3" style="padding-left:5.9pt;padding-right:5.9pt;">CH</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T3.7.1.4" style="padding-left:5.9pt;padding-right:5.9pt;">PR</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T3.7.1.5" style="padding-left:5.9pt;padding-right:5.9pt;">AD</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T3.7.1.6" style="padding-left:5.9pt;padding-right:5.9pt;">MBNE</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T3.7.1.7" style="padding-left:5.9pt;padding-right:5.9pt;">MNIST</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_tt" id="S6.T3.7.1.8" style="padding-left:5.9pt;padding-right:5.9pt;">CT</td>
</tr>
<tr class="ltx_tr" id="S6.T3.7.2">
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T3.7.2.1" style="padding-left:5.9pt;padding-right:5.9pt;">TVAE</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.7.2.2" style="padding-left:5.9pt;padding-right:5.9pt;">0.971 ±0.004</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.7.2.3" style="padding-left:5.9pt;padding-right:5.9pt;">0.834 ±0.006</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.7.2.4" style="padding-left:5.9pt;padding-right:5.9pt;">0.940 ±0.002</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.7.2.5" style="padding-left:5.9pt;padding-right:5.9pt;">0.898 ±0.001</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.7.2.6" style="padding-left:5.9pt;padding-right:5.9pt;">1.000 ±0.000</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.7.2.7" style="padding-left:5.9pt;padding-right:5.9pt;">1.000 ±0.000</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S6.T3.7.2.8" style="padding-left:5.9pt;padding-right:5.9pt;">0.999 ±0.000</td>
</tr>
<tr class="ltx_tr" id="S6.T3.7.3">
<td class="ltx_td ltx_align_left" id="S6.T3.7.3.1" style="padding-left:5.9pt;padding-right:5.9pt;">TabDDPM</td>
<td class="ltx_td ltx_align_center" id="S6.T3.7.3.2" style="padding-left:5.9pt;padding-right:5.9pt;">0.818 ±0.015</td>
<td class="ltx_td ltx_align_center" id="S6.T3.7.3.3" style="padding-left:5.9pt;padding-right:5.9pt;">0.667 ±0.005</td>
<td class="ltx_td ltx_align_center" id="S6.T3.7.3.4" style="padding-left:5.9pt;padding-right:5.9pt;"><span class="ltx_text ltx_font_bold" id="S6.T3.7.3.4.1">0.628 ±0.004</span></td>
<td class="ltx_td ltx_align_center" id="S6.T3.7.3.5" style="padding-left:5.9pt;padding-right:5.9pt;">0.604 ±0.002</td>
<td class="ltx_td ltx_align_center" id="S6.T3.7.3.6" style="padding-left:5.9pt;padding-right:5.9pt;"><span class="ltx_text ltx_font_bold" id="S6.T3.7.3.6.1">0.789 ±0.002</span></td>
<td class="ltx_td ltx_align_center" id="S6.T3.7.3.7" style="padding-left:5.9pt;padding-right:5.9pt;">-</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T3.7.3.8" style="padding-left:5.9pt;padding-right:5.9pt;">0.915 ±0.007</td>
</tr>
<tr class="ltx_tr" id="S6.T3.7.4">
<td class="ltx_td ltx_align_left" id="S6.T3.7.4.1" style="padding-left:5.9pt;padding-right:5.9pt;">Forest-Flow</td>
<td class="ltx_td ltx_align_center" id="S6.T3.7.4.2" style="padding-left:5.9pt;padding-right:5.9pt;">0.987 ±0.002</td>
<td class="ltx_td ltx_align_center" id="S6.T3.7.4.3" style="padding-left:5.9pt;padding-right:5.9pt;">0.926 ±0.002</td>
<td class="ltx_td ltx_align_center" id="S6.T3.7.4.4" style="padding-left:5.9pt;padding-right:5.9pt;">0.885 ±0.002</td>
<td class="ltx_td ltx_align_center" id="S6.T3.7.4.5" style="padding-left:5.9pt;padding-right:5.9pt;">0.932 ±0.002</td>
<td class="ltx_td ltx_align_center" id="S6.T3.7.4.6" style="padding-left:5.9pt;padding-right:5.9pt;">1.000 ±0.000</td>
<td class="ltx_td ltx_align_center" id="S6.T3.7.4.7" style="padding-left:5.9pt;padding-right:5.9pt;">1.000 ±0.000</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T3.7.4.8" style="padding-left:5.9pt;padding-right:5.9pt;">0.985 ±0.001</td>
</tr>
<tr class="ltx_tr" id="S6.T3.7.5">
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T3.7.5.1" style="padding-left:5.9pt;padding-right:5.9pt;">ARF</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.7.5.2" style="padding-left:5.9pt;padding-right:5.9pt;">0.975 ±0.005</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.7.5.3" style="padding-left:5.9pt;padding-right:5.9pt;">0.973 ±0.004</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.7.5.4" style="padding-left:5.9pt;padding-right:5.9pt;">0.795 ±0.008</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.7.5.5" style="padding-left:5.9pt;padding-right:5.9pt;">0.992 ±0.000</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.7.5.6" style="padding-left:5.9pt;padding-right:5.9pt;">0.998 ±0.000</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.7.5.7" style="padding-left:5.9pt;padding-right:5.9pt;">1.000 ±0.000</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S6.T3.7.5.8" style="padding-left:5.9pt;padding-right:5.9pt;">0.989 ±0.001</td>
</tr>
<tr class="ltx_tr" id="S6.T3.7.6">
<td class="ltx_td ltx_align_left" id="S6.T3.7.6.1" style="padding-left:5.9pt;padding-right:5.9pt;">DEF (KL)</td>
<td class="ltx_td ltx_align_center" id="S6.T3.7.6.2" style="padding-left:5.9pt;padding-right:5.9pt;">0.823 ±0.013</td>
<td class="ltx_td ltx_align_center" id="S6.T3.7.6.3" style="padding-left:5.9pt;padding-right:5.9pt;">0.751 ±0.008</td>
<td class="ltx_td ltx_align_center" id="S6.T3.7.6.4" style="padding-left:5.9pt;padding-right:5.9pt;">0.877 ±0.002</td>
<td class="ltx_td ltx_align_center" id="S6.T3.7.6.5" style="padding-left:5.9pt;padding-right:5.9pt;">0.956 ±0.002</td>
<td class="ltx_td ltx_align_center" id="S6.T3.7.6.6" style="padding-left:5.9pt;padding-right:5.9pt;">1.000 ±0.000</td>
<td class="ltx_td ltx_align_center" id="S6.T3.7.6.7" style="padding-left:5.9pt;padding-right:5.9pt;">1.000 ±0.000</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T3.7.6.8" style="padding-left:5.9pt;padding-right:5.9pt;">0.999 ±0.000</td>
</tr>
<tr class="ltx_tr" id="S6.T3.7.7">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S6.T3.7.7.1" style="padding-left:5.9pt;padding-right:5.9pt;">NRGBoost</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T3.7.7.2" style="padding-left:5.9pt;padding-right:5.9pt;"><span class="ltx_text ltx_font_bold" id="S6.T3.7.7.2.1">0.625 ±0.017</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T3.7.7.3" style="padding-left:5.9pt;padding-right:5.9pt;"><span class="ltx_text ltx_font_bold" id="S6.T3.7.7.3.1">0.574 ±0.012</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T3.7.7.4" style="padding-left:5.9pt;padding-right:5.9pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S6.T3.7.7.4.1">0.631 ±0.006</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T3.7.7.5" style="padding-left:5.9pt;padding-right:5.9pt;"><span class="ltx_text ltx_font_bold" id="S6.T3.7.7.5.1">0.559 ±0.003</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T3.7.7.6" style="padding-left:5.9pt;padding-right:5.9pt;">0.993 ±0.001</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T3.7.7.7" style="padding-left:5.9pt;padding-right:5.9pt;"><span class="ltx_text ltx_font_bold" id="S6.T3.7.7.7.1">0.943 ±0.003</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" id="S6.T3.7.7.8" style="padding-left:5.9pt;padding-right:5.9pt;"><span class="ltx_text ltx_font_bold" id="S6.T3.7.7.8.1">0.724 ±0.006</span></td>
</tr>
</table>
</figure>
</section>
<section class="ltx_paragraph" id="S6.SS2.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Statistical Distance Measure</h5>
<div class="ltx_para ltx_noindent" id="S6.SS2.SSS0.Px3.p1">
<p class="ltx_p" id="S6.SS2.SSS0.Px3.p1.1">As an additional measure of the statistical dissimilarity between data and model distributions we evaluate a Wasserstein distance using a similar setup to <cite class="ltx_cite ltx_citemacro_citet">Jolicoeur-Martineau et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib16" title="">2024</a>)</cite>.
Namely, we min-max scale the numerical variables, and one-hot encode the categorical variables and scale them by 1/2.
We use a <math alttext="L_{1}" class="ltx_Math" display="inline" id="S6.SS2.SSS0.Px3.p1.1.m1.1"><semantics id="S6.SS2.SSS0.Px3.p1.1.m1.1a"><msub id="S6.SS2.SSS0.Px3.p1.1.m1.1.1" xref="S6.SS2.SSS0.Px3.p1.1.m1.1.1.cmml"><mi id="S6.SS2.SSS0.Px3.p1.1.m1.1.1.2" xref="S6.SS2.SSS0.Px3.p1.1.m1.1.1.2.cmml">L</mi><mn id="S6.SS2.SSS0.Px3.p1.1.m1.1.1.3" xref="S6.SS2.SSS0.Px3.p1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S6.SS2.SSS0.Px3.p1.1.m1.1b"><apply id="S6.SS2.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S6.SS2.SSS0.Px3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S6.SS2.SSS0.Px3.p1.1.m1.1.1.1.cmml" xref="S6.SS2.SSS0.Px3.p1.1.m1.1.1">subscript</csymbol><ci id="S6.SS2.SSS0.Px3.p1.1.m1.1.1.2.cmml" xref="S6.SS2.SSS0.Px3.p1.1.m1.1.1.2">𝐿</ci><cn id="S6.SS2.SSS0.Px3.p1.1.m1.1.1.3.cmml" type="integer" xref="S6.SS2.SSS0.Px3.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.SSS0.Px3.p1.1.m1.1c">L_{1}</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.SSS0.Px3.p1.1.m1.1d">italic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> distance in the formulation of the optimal transport problem. Since finding the optimal solution has a worst case cubic scaling with the sample size,
we sub-sample a maximum of 5000 samples from the original train or test sets and use an equal number of synthetic samples.
We repeat the evaluation for each method and dataset 5 times using different synthetic data and also different subsampling seeds for the real data (where applicable).</p>
</div>
<figure class="ltx_table" id="S6.T4">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4: </span>Wasserstein distance between empirical test distribution and synthetic samples. Reported results are averages and standard errors over 5 repeated experiments. Smaller is better.
</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S6.T4.1">
<tr class="ltx_tr" id="S6.T4.1.1">
<td class="ltx_td ltx_border_tt" id="S6.T4.1.1.1" style="padding-left:5.9pt;padding-right:5.9pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T4.1.1.2" style="padding-left:5.9pt;padding-right:5.9pt;">AB</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T4.1.1.3" style="padding-left:5.9pt;padding-right:5.9pt;">CH</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T4.1.1.4" style="padding-left:5.9pt;padding-right:5.9pt;">PR</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T4.1.1.5" style="padding-left:5.9pt;padding-right:5.9pt;">AD</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T4.1.1.6" style="padding-left:5.9pt;padding-right:5.9pt;">MBNE</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T4.1.1.7" style="padding-left:5.9pt;padding-right:5.9pt;">MNIST</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_tt" id="S6.T4.1.1.8" style="padding-left:5.9pt;padding-right:5.9pt;">CT</td>
</tr>
<tr class="ltx_tr" id="S6.T4.1.2">
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T4.1.2.1" style="padding-left:5.9pt;padding-right:5.9pt;">TVAE</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.1.2.2" style="padding-left:5.9pt;padding-right:5.9pt;">0.302 ±0.005</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.1.2.3" style="padding-left:5.9pt;padding-right:5.9pt;">0.206 ±0.010</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.1.2.4" style="padding-left:5.9pt;padding-right:5.9pt;">0.274 ±0.008</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.1.2.5" style="padding-left:5.9pt;padding-right:5.9pt;">1.086 ±0.023</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.1.2.6" style="padding-left:5.9pt;padding-right:5.9pt;"><span class="ltx_text ltx_font_bold" id="S6.T4.1.2.6.1">0.425 ±0.032</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.1.2.7" style="padding-left:5.9pt;padding-right:5.9pt;">20.61 ±0.042</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S6.T4.1.2.8" style="padding-left:5.9pt;padding-right:5.9pt;">0.807 ±0.023</td>
</tr>
<tr class="ltx_tr" id="S6.T4.1.3">
<td class="ltx_td ltx_align_left" id="S6.T4.1.3.1" style="padding-left:5.9pt;padding-right:5.9pt;">TabDDPM</td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.3.2" style="padding-left:5.9pt;padding-right:5.9pt;">0.500 ±0.023</td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.3.3" style="padding-left:5.9pt;padding-right:5.9pt;"><span class="ltx_text ltx_font_bold" id="S6.T4.1.3.3.1">0.169 ±0.009</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.3.4" style="padding-left:5.9pt;padding-right:5.9pt;"><span class="ltx_text ltx_font_bold" id="S6.T4.1.3.4.1">0.195 ±0.003</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.3.5" style="padding-left:5.9pt;padding-right:5.9pt;"><span class="ltx_text ltx_font_bold" id="S6.T4.1.3.5.1">0.938 ±0.029</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.3.6" style="padding-left:5.9pt;padding-right:5.9pt;">109.5 ±93.13</td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.3.7" style="padding-left:5.9pt;padding-right:5.9pt;">-</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T4.1.3.8" style="padding-left:5.9pt;padding-right:5.9pt;">0.646 ±0.022</td>
</tr>
<tr class="ltx_tr" id="S6.T4.1.4">
<td class="ltx_td ltx_align_left" id="S6.T4.1.4.1" style="padding-left:5.9pt;padding-right:5.9pt;">Forest-Flow</td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.4.2" style="padding-left:5.9pt;padding-right:5.9pt;">0.248 ±0.020</td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.4.3" style="padding-left:5.9pt;padding-right:5.9pt;">0.205 ±0.009</td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.4.4" style="padding-left:5.9pt;padding-right:5.9pt;">0.231 ±0.008</td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.4.5" style="padding-left:5.9pt;padding-right:5.9pt;">1.243 ±0.029</td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.4.6" style="padding-left:5.9pt;padding-right:5.9pt;">4.295 ±3.697</td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.4.7" style="padding-left:5.9pt;padding-right:5.9pt;">20.73 ±0.574</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T4.1.4.8" style="padding-left:5.9pt;padding-right:5.9pt;">0.893 ±0.021</td>
</tr>
<tr class="ltx_tr" id="S6.T4.1.5">
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T4.1.5.1" style="padding-left:5.9pt;padding-right:5.9pt;">ARF</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.1.5.2" style="padding-left:5.9pt;padding-right:5.9pt;"><span class="ltx_text ltx_font_bold" id="S6.T4.1.5.2.1">0.218 ±0.015</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.1.5.3" style="padding-left:5.9pt;padding-right:5.9pt;">0.240 ±0.009</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.1.5.4" style="padding-left:5.9pt;padding-right:5.9pt;">0.238 ±0.006</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.1.5.5" style="padding-left:5.9pt;padding-right:5.9pt;">1.378 ±0.020</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.1.5.6" style="padding-left:5.9pt;padding-right:5.9pt;">0.732 ±0.664</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.1.5.7" style="padding-left:5.9pt;padding-right:5.9pt;">18.14 ±0.060</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S6.T4.1.5.8" style="padding-left:5.9pt;padding-right:5.9pt;">0.709 ±0.018</td>
</tr>
<tr class="ltx_tr" id="S6.T4.1.6">
<td class="ltx_td ltx_align_left" id="S6.T4.1.6.1" style="padding-left:5.9pt;padding-right:5.9pt;">DEF (KL)</td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.6.2" style="padding-left:5.9pt;padding-right:5.9pt;">0.337 ±0.006</td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.6.3" style="padding-left:5.9pt;padding-right:5.9pt;">0.210 ±0.012</td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.6.4" style="padding-left:5.9pt;padding-right:5.9pt;">0.264 ±0.011</td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.6.5" style="padding-left:5.9pt;padding-right:5.9pt;">1.696 ±0.023</td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.6.6" style="padding-left:5.9pt;padding-right:5.9pt;">18.29 ±14.90</td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.6.7" style="padding-left:5.9pt;padding-right:5.9pt;">261.0 ±35.01</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T4.1.6.8" style="padding-left:5.9pt;padding-right:5.9pt;">0.935 ±0.024</td>
</tr>
<tr class="ltx_tr" id="S6.T4.1.7">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S6.T4.1.7.1" style="padding-left:5.9pt;padding-right:5.9pt;">NRGBoost</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T4.1.7.2" style="padding-left:5.9pt;padding-right:5.9pt;">0.502 ±0.045</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T4.1.7.3" style="padding-left:5.9pt;padding-right:5.9pt;">0.178 ±0.011</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T4.1.7.4" style="padding-left:5.9pt;padding-right:5.9pt;">0.225 ±0.010</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T4.1.7.5" style="padding-left:5.9pt;padding-right:5.9pt;">1.051 ±0.013</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T4.1.7.6" style="padding-left:5.9pt;padding-right:5.9pt;">22.33 ±20.11</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T4.1.7.7" style="padding-left:5.9pt;padding-right:5.9pt;"><span class="ltx_text ltx_font_bold" id="S6.T4.1.7.7.1">15.70 ±0.188</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" id="S6.T4.1.7.8" style="padding-left:5.9pt;padding-right:5.9pt;"><span class="ltx_text ltx_font_bold" id="S6.T4.1.7.8.1">0.602 ±0.015</span></td>
</tr>
</table>
</figure>
<figure class="ltx_table" id="S6.T5">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 5: </span>Wasserstein distance between empirical train distribution and synthetic samples. Reported results are averages and standard errors over 5 repeated experiments. Smaller is better.
</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S6.T5.1">
<tr class="ltx_tr" id="S6.T5.1.1">
<td class="ltx_td ltx_border_tt" id="S6.T5.1.1.1" style="padding-left:5.9pt;padding-right:5.9pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T5.1.1.2" style="padding-left:5.9pt;padding-right:5.9pt;">AB</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T5.1.1.3" style="padding-left:5.9pt;padding-right:5.9pt;">CH</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T5.1.1.4" style="padding-left:5.9pt;padding-right:5.9pt;">PR</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T5.1.1.5" style="padding-left:5.9pt;padding-right:5.9pt;">AD</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T5.1.1.6" style="padding-left:5.9pt;padding-right:5.9pt;">MBNE</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T5.1.1.7" style="padding-left:5.9pt;padding-right:5.9pt;">MNIST</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_tt" id="S6.T5.1.1.8" style="padding-left:5.9pt;padding-right:5.9pt;">CT</td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.2">
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T5.1.2.1" style="padding-left:5.9pt;padding-right:5.9pt;">TVAE</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.2.2" style="padding-left:5.9pt;padding-right:5.9pt;">0.299 ±0.005</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.2.3" style="padding-left:5.9pt;padding-right:5.9pt;">0.195 ±0.010</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.2.4" style="padding-left:5.9pt;padding-right:5.9pt;">0.274 ±0.011</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.2.5" style="padding-left:5.9pt;padding-right:5.9pt;">1.075 ±0.024</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.2.6" style="padding-left:5.9pt;padding-right:5.9pt;"><span class="ltx_text ltx_font_bold" id="S6.T5.1.2.6.1">0.366 ±0.055</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.2.7" style="padding-left:5.9pt;padding-right:5.9pt;">20.59 ±0.041</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S6.T5.1.2.8" style="padding-left:5.9pt;padding-right:5.9pt;">0.808 ±0.029</td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.3">
<td class="ltx_td ltx_align_left" id="S6.T5.1.3.1" style="padding-left:5.9pt;padding-right:5.9pt;">TabDDPM</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.3.2" style="padding-left:5.9pt;padding-right:5.9pt;">0.467 ±0.021</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.3.3" style="padding-left:5.9pt;padding-right:5.9pt;"><span class="ltx_text ltx_font_bold" id="S6.T5.1.3.3.1">0.153 ±0.007</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.3.4" style="padding-left:5.9pt;padding-right:5.9pt;"><span class="ltx_text ltx_font_bold" id="S6.T5.1.3.4.1">0.190 ±0.005</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.3.5" style="padding-left:5.9pt;padding-right:5.9pt;"><span class="ltx_text ltx_font_bold" id="S6.T5.1.3.5.1">0.895 ±0.019</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.3.6" style="padding-left:5.9pt;padding-right:5.9pt;">109.6 ±93.14</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.3.7" style="padding-left:5.9pt;padding-right:5.9pt;">-</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T5.1.3.8" style="padding-left:5.9pt;padding-right:5.9pt;">0.640 ±0.016</td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.4">
<td class="ltx_td ltx_align_left" id="S6.T5.1.4.1" style="padding-left:5.9pt;padding-right:5.9pt;">Forest-Flow</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.4.2" style="padding-left:5.9pt;padding-right:5.9pt;">0.234 ±0.020</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.4.3" style="padding-left:5.9pt;padding-right:5.9pt;">0.192 ±0.007</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.4.4" style="padding-left:5.9pt;padding-right:5.9pt;">0.238 ±0.009</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.4.5" style="padding-left:5.9pt;padding-right:5.9pt;">1.239 ±0.024</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.4.6" style="padding-left:5.9pt;padding-right:5.9pt;">4.214 ±3.683</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.4.7" style="padding-left:5.9pt;padding-right:5.9pt;">20.73 ±0.574</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T5.1.4.8" style="padding-left:5.9pt;padding-right:5.9pt;">0.896 ±0.022</td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.5">
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T5.1.5.1" style="padding-left:5.9pt;padding-right:5.9pt;">ARF</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.5.2" style="padding-left:5.9pt;padding-right:5.9pt;"><span class="ltx_text ltx_font_bold" id="S6.T5.1.5.2.1">0.199 ±0.015</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.5.3" style="padding-left:5.9pt;padding-right:5.9pt;">0.233 ±0.009</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.5.4" style="padding-left:5.9pt;padding-right:5.9pt;">0.232 ±0.007</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.5.5" style="padding-left:5.9pt;padding-right:5.9pt;">1.363 ±0.018</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.5.6" style="padding-left:5.9pt;padding-right:5.9pt;">0.698 ±0.684</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.5.7" style="padding-left:5.9pt;padding-right:5.9pt;">18.14 ±0.060</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S6.T5.1.5.8" style="padding-left:5.9pt;padding-right:5.9pt;">0.703 ±0.019</td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.6">
<td class="ltx_td ltx_align_left" id="S6.T5.1.6.1" style="padding-left:5.9pt;padding-right:5.9pt;">DEF (KL)</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.6.2" style="padding-left:5.9pt;padding-right:5.9pt;">0.320 ±0.006</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.6.3" style="padding-left:5.9pt;padding-right:5.9pt;">0.199 ±0.012</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.6.4" style="padding-left:5.9pt;padding-right:5.9pt;">0.260 ±0.010</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.6.5" style="padding-left:5.9pt;padding-right:5.9pt;">1.682 ±0.024</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.6.6" style="padding-left:5.9pt;padding-right:5.9pt;">18.21 ±14.92</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.6.7" style="padding-left:5.9pt;padding-right:5.9pt;">261.0 ±15.60</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T5.1.6.8" style="padding-left:5.9pt;padding-right:5.9pt;">0.933 ±0.025</td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.7">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S6.T5.1.7.1" style="padding-left:5.9pt;padding-right:5.9pt;">NRGBoost</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T5.1.7.2" style="padding-left:5.9pt;padding-right:5.9pt;">0.509 ±0.047</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T5.1.7.3" style="padding-left:5.9pt;padding-right:5.9pt;">0.170 ±0.012</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T5.1.7.4" style="padding-left:5.9pt;padding-right:5.9pt;">0.230 ±0.011</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T5.1.7.5" style="padding-left:5.9pt;padding-right:5.9pt;">1.028 ±0.015</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T5.1.7.6" style="padding-left:5.9pt;padding-right:5.9pt;">22.25 ±20.09</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T5.1.7.7" style="padding-left:5.9pt;padding-right:5.9pt;"><span class="ltx_text ltx_font_bold" id="S6.T5.1.7.7.1">15.60 ±0.212</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" id="S6.T5.1.7.8" style="padding-left:5.9pt;padding-right:5.9pt;"><span class="ltx_text ltx_font_bold" id="S6.T5.1.7.8.1">0.600 ±0.016</span></td>
</tr>
</table>
</figure>
<div class="ltx_para ltx_noindent" id="S6.SS2.SSS0.Px3.p2">
<p class="ltx_p" id="S6.SS2.SSS0.Px3.p2.1">Our results for the distance between empirical training and test distribution and synthetic samples from each model are reported in Tables <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S6.T5" title="Table 5 ‣ Statistical Distance Measure ‣ 6.2 Sampling ‣ 6 Experiments ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">5</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S6.T4" title="Table 4 ‣ Statistical Distance Measure ‣ 6.2 Sampling ‣ 6 Experiments ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">4</span></a> respectively.
We found these results to be somewhat sensitive to the choice of normalization of the numericals and categoricals, as well as to the choice of distance in this normalized space.
Despite NRGBoost not being as dominant as in the discriminator measure, it still fares well, obtaining the best average rank over all datasets and experiments.
Qualitatively speaking, we find that the samples generated by NRGBoost also look visually similar to the real data in both the MNIST and California datasets (see Figures <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">1</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S6.F3" title="Figure 3 ‣ Machine Learning Efficiency ‣ 6.2 Sampling ‣ 6 Experiments ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">3</span></a>), being the only generative model that can claim that for the former.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Discussion</h2>
<div class="ltx_para ltx_noindent" id="S7.p1">
<p class="ltx_p" id="S7.p1.1">The proposed DEF models are easy to sample from and require no sampling during training. However, we find that,
they require deep trees to model the data well which, in turn, also requires a larger number of trees in the ensemble to regularize.
In our experiments we found that the performance of DEF models was often capped by the maximum number of leaves we allowed (<math alttext="2^{14}" class="ltx_Math" display="inline" id="S7.p1.1.m1.1"><semantics id="S7.p1.1.m1.1a"><msup id="S7.p1.1.m1.1.1" xref="S7.p1.1.m1.1.1.cmml"><mn id="S7.p1.1.m1.1.1.2" xref="S7.p1.1.m1.1.1.2.cmml">2</mn><mn id="S7.p1.1.m1.1.1.3" xref="S7.p1.1.m1.1.1.3.cmml">14</mn></msup><annotation-xml encoding="MathML-Content" id="S7.p1.1.m1.1b"><apply id="S7.p1.1.m1.1.1.cmml" xref="S7.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S7.p1.1.m1.1.1.1.cmml" xref="S7.p1.1.m1.1.1">superscript</csymbol><cn id="S7.p1.1.m1.1.1.2.cmml" type="integer" xref="S7.p1.1.m1.1.1.2">2</cn><cn id="S7.p1.1.m1.1.1.3.cmml" type="integer" xref="S7.p1.1.m1.1.1.3">14</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.p1.1.m1.1c">2^{14}</annotation><annotation encoding="application/x-llamapun" id="S7.p1.1.m1.1d">2 start_POSTSUPERSCRIPT 14 end_POSTSUPERSCRIPT</annotation></semantics></math>).</p>
</div>
<div class="ltx_para ltx_noindent" id="S7.p2">
<p class="ltx_p" id="S7.p2.1">In contrast, NRGBoost was able to model the data better while using shallower trees and in fewer number (the models selected on all datasets except for MNIST and CT had <math alttext="\leq 2^{10}" class="ltx_Math" display="inline" id="S7.p2.1.m1.1"><semantics id="S7.p2.1.m1.1a"><mrow id="S7.p2.1.m1.1.1" xref="S7.p2.1.m1.1.1.cmml"><mi id="S7.p2.1.m1.1.1.2" xref="S7.p2.1.m1.1.1.2.cmml"></mi><mo id="S7.p2.1.m1.1.1.1" xref="S7.p2.1.m1.1.1.1.cmml">≤</mo><msup id="S7.p2.1.m1.1.1.3" xref="S7.p2.1.m1.1.1.3.cmml"><mn id="S7.p2.1.m1.1.1.3.2" xref="S7.p2.1.m1.1.1.3.2.cmml">2</mn><mn id="S7.p2.1.m1.1.1.3.3" xref="S7.p2.1.m1.1.1.3.3.cmml">10</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S7.p2.1.m1.1b"><apply id="S7.p2.1.m1.1.1.cmml" xref="S7.p2.1.m1.1.1"><leq id="S7.p2.1.m1.1.1.1.cmml" xref="S7.p2.1.m1.1.1.1"></leq><csymbol cd="latexml" id="S7.p2.1.m1.1.1.2.cmml" xref="S7.p2.1.m1.1.1.2">absent</csymbol><apply id="S7.p2.1.m1.1.1.3.cmml" xref="S7.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S7.p2.1.m1.1.1.3.1.cmml" xref="S7.p2.1.m1.1.1.3">superscript</csymbol><cn id="S7.p2.1.m1.1.1.3.2.cmml" type="integer" xref="S7.p2.1.m1.1.1.3.2">2</cn><cn id="S7.p2.1.m1.1.1.3.3.cmml" type="integer" xref="S7.p2.1.m1.1.1.3.3">10</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.p2.1.m1.1c">\leq 2^{10}</annotation><annotation encoding="application/x-llamapun" id="S7.p2.1.m1.1d">≤ 2 start_POSTSUPERSCRIPT 10 end_POSTSUPERSCRIPT</annotation></semantics></math> leaves).
Its main downside is that it can only be sampled from approximately using more expensive MCMC and also requires sampling during the training process.
While our fast Gibbs sampling implementation and our proposed sampling approach were able to mitigate the slow training, making these models practical,
they can still be cumbersome to use for sampling, particularly if independent samples are required, due to autocorrelation between samples from the same Markov Chain.
We argue however that unlike in image or text generation where fast sampling is necessary for an interactive user experience,
this can be less of a concern for the task of generating synthetic datasets where the one time cost of sampling is not as important as faithfully
capturing the data generating distribution.</p>
</div>
<div class="ltx_para ltx_noindent" id="S7.p3">
<p class="ltx_p" id="S7.p3.1">A limitation of tree-based models when compared to DL approaches is that they require keeping the full training data in memory.
While discretization allows this data to be stored in a compact format, this could still limit the applicability of these methods to very large datasets.</p>
</div>
</section>
<section class="ltx_section" id="S8">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">8 </span>Conclusion</h2>
<div class="ltx_para ltx_noindent" id="S8.p1">
<p class="ltx_p" id="S8.p1.1">We extend the two most popular tree-based discriminative methods for use in generative modeling.
We find that our boosting approach, in particular, offers generally good discriminative performance and competitive sampling performance to more specialized alternatives.
We hope that these results encourage further research into generative boosting approaches for tabular data,
in particular exploring other applications besides sampling that are enabled by (unnormalized) density models.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Blesch &amp; Wright (2023)</span>
<span class="ltx_bibblock">
Kristin Blesch and Marvin N Wright.

</span>
<span class="ltx_bibblock">arfpy: A python package for density estimation and generative
modeling with adversarial random forests.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">arXiv preprint arXiv:2311.07366</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Borisov et al. (2022a)</span>
<span class="ltx_bibblock">
Vadim Borisov, Tobias Leemann, Kathrin Seßler, Johannes Haug, Martin
Pawelczyk, and Gjergji Kasneci.

</span>
<span class="ltx_bibblock">Deep neural networks and tabular data: A survey.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">IEEE transactions on neural networks and learning systems</em>,
2022a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Borisov et al. (2022b)</span>
<span class="ltx_bibblock">
Vadim Borisov, Kathrin Seßler, Tobias Leemann, Martin Pawelczyk, and
Gjergji Kasneci.

</span>
<span class="ltx_bibblock">Language models are realistic tabular data generators.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">arXiv preprint arXiv:2210.06280</em>, 2022b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen &amp; Guestrin (2016)</span>
<span class="ltx_bibblock">
Tianqi Chen and Carlos Guestrin.

</span>
<span class="ltx_bibblock">XGBoost: A Scalable Tree Boosting System.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">Proceedings of the 22nd ACM SIGKDD International
Conference on Knowledge Discovery and Data Mining</em>, pp.  785–794,
August 2016.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1145/2939672.2939785</span>.

</span>
<span class="ltx_bibblock">arXiv:1603.02754 [cs].

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Correia et al. (2020)</span>
<span class="ltx_bibblock">
Alvaro Correia, Robert Peharz, and Cassio P de Campos.

</span>
<span class="ltx_bibblock">Joints in random forests.

</span>
<span class="ltx_bibblock">In H. Larochelle, M. Ranzato, R. Hadsell, M.F. Balcan, and H. Lin
(eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Advances in Neural Information Processing Systems</em>, volume 33,
pp.  11404–11415. Curran Associates, Inc., 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cranko &amp; Nock (2019)</span>
<span class="ltx_bibblock">
Zac Cranko and Richard Nock.

</span>
<span class="ltx_bibblock">Boosted Density Estimation Remastered.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">Proceedings of the 36th International Conference on
Machine Learning</em>, pp.  1416–1425. PMLR, May 2019.

</span>
<span class="ltx_bibblock">ISSN: 2640-3498.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Deng (2012)</span>
<span class="ltx_bibblock">
Li Deng.

</span>
<span class="ltx_bibblock">The mnist database of handwritten digit images for machine learning
research.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">IEEE Signal Processing Magazine</em>, 29(6):141–142, 2012.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dheeru &amp; Karra Taniskidou (2017)</span>
<span class="ltx_bibblock">
Dua Dheeru and Efi Karra Taniskidou.

</span>
<span class="ltx_bibblock">UCI machine learning repository, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Duan et al. (2020)</span>
<span class="ltx_bibblock">
Tony Duan, Avati Anand, Daisy Yi Ding, Khanh K Thai, Sanjay Basu, Andrew Ng,
and Alejandro Schuler.

</span>
<span class="ltx_bibblock">Ngboost: Natural gradient boosting for probabilistic prediction.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">International conference on machine learning</em>, pp. 2690–2700. PMLR, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Engelmann &amp; Lessmann (2021)</span>
<span class="ltx_bibblock">
Justin Engelmann and Stefan Lessmann.

</span>
<span class="ltx_bibblock">Conditional wasserstein gan-based oversampling of tabular data for
imbalanced learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">Expert Systems with Applications</em>, 174:114582, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fan et al. (2020)</span>
<span class="ltx_bibblock">
Ju Fan, Junyou Chen, Tongyu Liu, Yuwei Shen, Guoliang Li, and Xiaoyong Du.

</span>
<span class="ltx_bibblock">Relational data synthesis using generative adversarial networks: a
design space exploration.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">Proceedings of the VLDB Endowment</em>, 13(12):1962–1975, August 2020.

</span>
<span class="ltx_bibblock">ISSN 2150-8097.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.14778/3407790.3407802</span>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Friedman et al. (2000)</span>
<span class="ltx_bibblock">
Jerome Friedman, Trevor Hastie, and Robert Tibshirani.

</span>
<span class="ltx_bibblock">Additive logistic regression: a statistical view of boosting (With
discussion and a rejoinder by the authors).

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">The Annals of Statistics</em>, 28(2):337–407,
April 2000.

</span>
<span class="ltx_bibblock">ISSN 0090-5364, 2168-8966.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1214/aos/1016218223</span>.

</span>
<span class="ltx_bibblock">Publisher: Institute of Mathematical Statistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Grinsztajn et al. (2022)</span>
<span class="ltx_bibblock">
Léo Grinsztajn, Edouard Oyallon, and Gaël Varoquaux.

</span>
<span class="ltx_bibblock">Why do tree-based models still outperform deep learning on typical
tabular data?

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">Advances in neural information processing systems</em>,
35:507–520, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Grover &amp; Ermon (2018)</span>
<span class="ltx_bibblock">
Aditya Grover and Stefano Ermon.

</span>
<span class="ltx_bibblock">Boosted generative models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">Proceedings of the AAAI Conference on Artificial
Intelligence</em>, volume 32, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Harris et al. (2020)</span>
<span class="ltx_bibblock">
Charles R. Harris, K. Jarrod Millman, Stéfan J. van der Walt, Ralf
Gommers, Pauli Virtanen, David Cournapeau, Eric Wieser, Julian Taylor,
Sebastian Berg, Nathaniel J. Smith, Robert Kern, Matti Picus, Stephan Hoyer,
Marten H. van Kerkwijk, Matthew Brett, Allan Haldane, Jaime Fernández
del Río, Mark Wiebe, Pearu Peterson, Pierre Gérard-Marchant,
Kevin Sheppard, Tyler Reddy, Warren Weckesser, Hameer Abbasi, Christoph
Gohlke, and Travis E. Oliphant.

</span>
<span class="ltx_bibblock">Array programming with NumPy.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Nature</em>, 585(7825):357–362, September
2020.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1038/s41586-020-2649-2</span>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jolicoeur-Martineau et al. (2024)</span>
<span class="ltx_bibblock">
Alexia Jolicoeur-Martineau, Kilian Fatras, and Tal Kachman.

</span>
<span class="ltx_bibblock">Generating and imputing tabular data via diffusion and flow-based
gradient-boosted trees.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">International Conference on Artificial Intelligence and
Statistics</em>, pp.  1288–1296. PMLR, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jordon et al. (2018)</span>
<span class="ltx_bibblock">
James Jordon, Jinsung Yoon, and Mihaela Van Der Schaar.

</span>
<span class="ltx_bibblock">Pate-gan: Generating synthetic data with differential privacy
guarantees.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">International conference on learning representations</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ke et al. (2017)</span>
<span class="ltx_bibblock">
Guolin Ke, Qi Meng, Thomas Finley, Taifeng Wang, Wei Chen, Weidong Ma, Qiwei
Ye, and Tie-Yan Liu.

</span>
<span class="ltx_bibblock">LightGBM: A Highly Efficient Gradient Boosting Decision
Tree.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Advances in Neural Information Processing Systems</em>,
volume 30. Curran Associates, Inc., 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kotelnikov et al. (2023)</span>
<span class="ltx_bibblock">
Akim Kotelnikov, Dmitry Baranchuk, Ivan Rubachev, and Artem Babenko.

</span>
<span class="ltx_bibblock">Tabddpm: Modelling tabular data with diffusion models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">International Conference on Machine Learning</em>, pp. 17564–17579. PMLR, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nock &amp; Guillame-Bert (2022)</span>
<span class="ltx_bibblock">
Richard Nock and Mathieu Guillame-Bert.

</span>
<span class="ltx_bibblock">Generative trees: Adversarial and copycat.

</span>
<span class="ltx_bibblock">In Kamalika Chaudhuri, Stefanie Jegelka, Le Song, Csaba Szepesvari,
Gang Niu, and Sivan Sabato (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">Proceedings of the 39th
International Conference on Machine Learning</em>, volume 162 of
<em class="ltx_emph ltx_font_italic" id="bib.bib20.2.2">Proceedings of Machine Learning Research</em>, pp.  16906–16951. PMLR,
17–23 Jul 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nock &amp; Guillame-Bert (2023)</span>
<span class="ltx_bibblock">
Richard Nock and Mathieu Guillame-Bert.

</span>
<span class="ltx_bibblock">Generative forests.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">arXiv preprint arXiv:2308.03648</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">O’Neill (2014)</span>
<span class="ltx_bibblock">
Melissa E. O’Neill.

</span>
<span class="ltx_bibblock">Pcg: A family of simple fast space-efficient statistically good
algorithms for random number generation.

</span>
<span class="ltx_bibblock">Technical Report HMC-CS-2014-0905, Harvey Mudd College, Claremont,
CA, September 2014.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pedregosa et al. (2011)</span>
<span class="ltx_bibblock">
F. Pedregosa, G. Varoquaux, A. Gramfort, V. Michel, B. Thirion, O. Grisel,
M. Blondel, P. Prettenhofer, R. Weiss, V. Dubourg, J. Vanderplas, A. Passos,
D. Cournapeau, M. Brucher, M. Perrot, and E. Duchesnay.

</span>
<span class="ltx_bibblock">Scikit-learn: Machine learning in Python.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">Journal of Machine Learning Research</em>, 12:2825–2830,
2011.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ram &amp; Gray (2011)</span>
<span class="ltx_bibblock">
Parikshit Ram and Alexander G. Gray.

</span>
<span class="ltx_bibblock">Density estimation trees.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">Proceedings of the 17th ACM SIGKDD international
conference on Knowledge discovery and data mining</em>, pp.  627–635, San
Diego California USA, August 2011. ACM.

</span>
<span class="ltx_bibblock">ISBN 978-1-4503-0813-7.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1145/2020408.2020507</span>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rosset &amp; Segal (2002)</span>
<span class="ltx_bibblock">
Saharon Rosset and Eran Segal.

</span>
<span class="ltx_bibblock">Boosting Density Estimation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">Advances in Neural Information Processing Systems</em>,
volume 15. MIT Press, 2002.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Song &amp; Kingma (2021)</span>
<span class="ltx_bibblock">
Yang Song and Diederik P Kingma.

</span>
<span class="ltx_bibblock">How to train your energy-based models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">arXiv preprint arXiv:2101.03288</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tolstikhin et al. (2017)</span>
<span class="ltx_bibblock">
Ilya O Tolstikhin, Sylvain Gelly, Olivier Bousquet, Carl-Johann Simon-Gabriel,
and Bernhard Schölkopf.

</span>
<span class="ltx_bibblock">Adagan: Boosting generative models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">Advances in neural information processing systems</em>, 30, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tu (2007)</span>
<span class="ltx_bibblock">
Zhuowen Tu.

</span>
<span class="ltx_bibblock">Learning Generative Models via Discriminative Approaches.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">2007 IEEE Conference on Computer Vision and
Pattern Recognition</em>, pp.  1–8, June 2007.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1109/CVPR.2007.383035</span>.

</span>
<span class="ltx_bibblock">ISSN: 1063-6919.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Watson et al. (2023)</span>
<span class="ltx_bibblock">
David S. Watson, Kristin Blesch, Jan Kapar, and Marvin N. Wright.

</span>
<span class="ltx_bibblock">Adversarial random forests for density estimation and generative
modeling.

</span>
<span class="ltx_bibblock">In Francisco Ruiz, Jennifer Dy, and Jan-Willem van de Meent (eds.),
<em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">Proceedings of The 26th International Conference on Artificial
Intelligence and Statistics</em>, volume 206 of <em class="ltx_emph ltx_font_italic" id="bib.bib29.2.2">Proceedings of Machine
Learning Research</em>, pp.  5357–5375. PMLR, 25–27 Apr 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Welling et al. (2002)</span>
<span class="ltx_bibblock">
Max Welling, Richard Zemel, and Geoffrey E Hinton.

</span>
<span class="ltx_bibblock">Self Supervised Boosting.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">Advances in Neural Information Processing Systems</em>,
volume 15. MIT Press, 2002.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wen &amp; Hang (2022)</span>
<span class="ltx_bibblock">
Hongwei Wen and Hanyuan Hang.

</span>
<span class="ltx_bibblock">Random forest density estimation.

</span>
<span class="ltx_bibblock">In Kamalika Chaudhuri, Stefanie Jegelka, Le Song, Csaba Szepesvari,
Gang Niu, and Sivan Sabato (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">Proceedings of the 39th
International Conference on Machine Learning</em>, volume 162 of
<em class="ltx_emph ltx_font_italic" id="bib.bib31.2.2">Proceedings of Machine Learning Research</em>, pp.  23701–23722. PMLR,
17–23 Jul 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. (2019)</span>
<span class="ltx_bibblock">
Lei Xu, Maria Skoularidou, Alfredo Cuesta-Infante, and Kalyan Veeramachaneni.

</span>
<span class="ltx_bibblock">Modeling Tabular data using Conditional GAN.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">Advances in Neural Information Processing Systems</em>,
volume 32. Curran Associates, Inc., 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. (2021)</span>
<span class="ltx_bibblock">
Zilong Zhao, Aditya Kunar, Robert Birke, and Lydia Y Chen.

</span>
<span class="ltx_bibblock">Ctab-gan: Effective table data synthesizing.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">Asian Conference on Machine Learning</em>, pp.  97–112. PMLR,
2021.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<div class="ltx_para ltx_noindent" id="p1">
<span class="ltx_ERROR undefined" id="p1.1">\appendixpage</span>
</div>
<div class="ltx_para ltx_noindent" id="p2">
<span class="ltx_ERROR undefined" id="p2.1">\startcontents</span>
<p class="ltx_p" id="p2.2">[sections]
<span class="ltx_ERROR undefined" id="p2.2.1">\printcontents</span>[sections]l1</p>
</div>
<div class="ltx_para ltx_noindent" id="p3">
<p class="ltx_p" id="p3.1"><span class="ltx_rule" style="width:100%;height:1px;background:black;display:inline-block;"> </span></p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Theory</h2>
<div class="ltx_para ltx_noindent" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">The expected log-likelihood for an energy-based model (EBM),</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E15">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="q_{f}(\mathbf{x})=\frac{\exp\left(f(\mathbf{x})\right)}{Z[f]}\,," class="ltx_Math" display="block" id="A1.E15.m1.6"><semantics id="A1.E15.m1.6a"><mrow id="A1.E15.m1.6.6.1" xref="A1.E15.m1.6.6.1.1.cmml"><mrow id="A1.E15.m1.6.6.1.1" xref="A1.E15.m1.6.6.1.1.cmml"><mrow id="A1.E15.m1.6.6.1.1.2" xref="A1.E15.m1.6.6.1.1.2.cmml"><msub id="A1.E15.m1.6.6.1.1.2.2" xref="A1.E15.m1.6.6.1.1.2.2.cmml"><mi id="A1.E15.m1.6.6.1.1.2.2.2" xref="A1.E15.m1.6.6.1.1.2.2.2.cmml">q</mi><mi id="A1.E15.m1.6.6.1.1.2.2.3" xref="A1.E15.m1.6.6.1.1.2.2.3.cmml">f</mi></msub><mo id="A1.E15.m1.6.6.1.1.2.1" xref="A1.E15.m1.6.6.1.1.2.1.cmml">⁢</mo><mrow id="A1.E15.m1.6.6.1.1.2.3.2" xref="A1.E15.m1.6.6.1.1.2.cmml"><mo id="A1.E15.m1.6.6.1.1.2.3.2.1" stretchy="false" xref="A1.E15.m1.6.6.1.1.2.cmml">(</mo><mi id="A1.E15.m1.5.5" xref="A1.E15.m1.5.5.cmml">𝐱</mi><mo id="A1.E15.m1.6.6.1.1.2.3.2.2" stretchy="false" xref="A1.E15.m1.6.6.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.E15.m1.6.6.1.1.1" xref="A1.E15.m1.6.6.1.1.1.cmml">=</mo><mfrac id="A1.E15.m1.4.4" xref="A1.E15.m1.4.4.cmml"><mrow id="A1.E15.m1.3.3.3.3" xref="A1.E15.m1.3.3.3.4.cmml"><mi id="A1.E15.m1.2.2.2.2" xref="A1.E15.m1.2.2.2.2.cmml">exp</mi><mo id="A1.E15.m1.3.3.3.3a" xref="A1.E15.m1.3.3.3.4.cmml">⁡</mo><mrow id="A1.E15.m1.3.3.3.3.1" xref="A1.E15.m1.3.3.3.4.cmml"><mo id="A1.E15.m1.3.3.3.3.1.2" xref="A1.E15.m1.3.3.3.4.cmml">(</mo><mrow id="A1.E15.m1.3.3.3.3.1.1" xref="A1.E15.m1.3.3.3.3.1.1.cmml"><mi id="A1.E15.m1.3.3.3.3.1.1.2" xref="A1.E15.m1.3.3.3.3.1.1.2.cmml">f</mi><mo id="A1.E15.m1.3.3.3.3.1.1.1" xref="A1.E15.m1.3.3.3.3.1.1.1.cmml">⁢</mo><mrow id="A1.E15.m1.3.3.3.3.1.1.3.2" xref="A1.E15.m1.3.3.3.3.1.1.cmml"><mo id="A1.E15.m1.3.3.3.3.1.1.3.2.1" stretchy="false" xref="A1.E15.m1.3.3.3.3.1.1.cmml">(</mo><mi id="A1.E15.m1.1.1.1.1" xref="A1.E15.m1.1.1.1.1.cmml">𝐱</mi><mo id="A1.E15.m1.3.3.3.3.1.1.3.2.2" stretchy="false" xref="A1.E15.m1.3.3.3.3.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E15.m1.3.3.3.3.1.3" xref="A1.E15.m1.3.3.3.4.cmml">)</mo></mrow></mrow><mrow id="A1.E15.m1.4.4.4" xref="A1.E15.m1.4.4.4.cmml"><mi id="A1.E15.m1.4.4.4.3" xref="A1.E15.m1.4.4.4.3.cmml">Z</mi><mo id="A1.E15.m1.4.4.4.2" xref="A1.E15.m1.4.4.4.2.cmml">⁢</mo><mrow id="A1.E15.m1.4.4.4.4.2" xref="A1.E15.m1.4.4.4.4.1.cmml"><mo id="A1.E15.m1.4.4.4.4.2.1" stretchy="false" xref="A1.E15.m1.4.4.4.4.1.1.cmml">[</mo><mi id="A1.E15.m1.4.4.4.1" xref="A1.E15.m1.4.4.4.1.cmml">f</mi><mo id="A1.E15.m1.4.4.4.4.2.2" stretchy="false" xref="A1.E15.m1.4.4.4.4.1.1.cmml">]</mo></mrow></mrow></mfrac></mrow><mo id="A1.E15.m1.6.6.1.2" lspace="0.170em" xref="A1.E15.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E15.m1.6b"><apply id="A1.E15.m1.6.6.1.1.cmml" xref="A1.E15.m1.6.6.1"><eq id="A1.E15.m1.6.6.1.1.1.cmml" xref="A1.E15.m1.6.6.1.1.1"></eq><apply id="A1.E15.m1.6.6.1.1.2.cmml" xref="A1.E15.m1.6.6.1.1.2"><times id="A1.E15.m1.6.6.1.1.2.1.cmml" xref="A1.E15.m1.6.6.1.1.2.1"></times><apply id="A1.E15.m1.6.6.1.1.2.2.cmml" xref="A1.E15.m1.6.6.1.1.2.2"><csymbol cd="ambiguous" id="A1.E15.m1.6.6.1.1.2.2.1.cmml" xref="A1.E15.m1.6.6.1.1.2.2">subscript</csymbol><ci id="A1.E15.m1.6.6.1.1.2.2.2.cmml" xref="A1.E15.m1.6.6.1.1.2.2.2">𝑞</ci><ci id="A1.E15.m1.6.6.1.1.2.2.3.cmml" xref="A1.E15.m1.6.6.1.1.2.2.3">𝑓</ci></apply><ci id="A1.E15.m1.5.5.cmml" xref="A1.E15.m1.5.5">𝐱</ci></apply><apply id="A1.E15.m1.4.4.cmml" xref="A1.E15.m1.4.4"><divide id="A1.E15.m1.4.4.5.cmml" xref="A1.E15.m1.4.4"></divide><apply id="A1.E15.m1.3.3.3.4.cmml" xref="A1.E15.m1.3.3.3.3"><exp id="A1.E15.m1.2.2.2.2.cmml" xref="A1.E15.m1.2.2.2.2"></exp><apply id="A1.E15.m1.3.3.3.3.1.1.cmml" xref="A1.E15.m1.3.3.3.3.1.1"><times id="A1.E15.m1.3.3.3.3.1.1.1.cmml" xref="A1.E15.m1.3.3.3.3.1.1.1"></times><ci id="A1.E15.m1.3.3.3.3.1.1.2.cmml" xref="A1.E15.m1.3.3.3.3.1.1.2">𝑓</ci><ci id="A1.E15.m1.1.1.1.1.cmml" xref="A1.E15.m1.1.1.1.1">𝐱</ci></apply></apply><apply id="A1.E15.m1.4.4.4.cmml" xref="A1.E15.m1.4.4.4"><times id="A1.E15.m1.4.4.4.2.cmml" xref="A1.E15.m1.4.4.4.2"></times><ci id="A1.E15.m1.4.4.4.3.cmml" xref="A1.E15.m1.4.4.4.3">𝑍</ci><apply id="A1.E15.m1.4.4.4.4.1.cmml" xref="A1.E15.m1.4.4.4.4.2"><csymbol cd="latexml" id="A1.E15.m1.4.4.4.4.1.1.cmml" xref="A1.E15.m1.4.4.4.4.2.1">delimited-[]</csymbol><ci id="A1.E15.m1.4.4.4.1.cmml" xref="A1.E15.m1.4.4.4.1">𝑓</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E15.m1.6c">q_{f}(\mathbf{x})=\frac{\exp\left(f(\mathbf{x})\right)}{Z[f]}\,,</annotation><annotation encoding="application/x-llamapun" id="A1.E15.m1.6d">italic_q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT ( bold_x ) = divide start_ARG roman_exp ( italic_f ( bold_x ) ) end_ARG start_ARG italic_Z [ italic_f ] end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.p1.2">is given by</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E16">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="L[f]=\mathbb{E}_{\mathbf{x}\sim p}\log q_{f}(\mathbf{x})=\mathbb{E}_{\mathbf{x%
}\sim p}f(\mathbf{x})-\log Z[f]\,." class="ltx_Math" display="block" id="A1.E16.m1.5"><semantics id="A1.E16.m1.5a"><mrow id="A1.E16.m1.5.5.1" xref="A1.E16.m1.5.5.1.1.cmml"><mrow id="A1.E16.m1.5.5.1.1" xref="A1.E16.m1.5.5.1.1.cmml"><mrow id="A1.E16.m1.5.5.1.1.2" xref="A1.E16.m1.5.5.1.1.2.cmml"><mi id="A1.E16.m1.5.5.1.1.2.2" xref="A1.E16.m1.5.5.1.1.2.2.cmml">L</mi><mo id="A1.E16.m1.5.5.1.1.2.1" xref="A1.E16.m1.5.5.1.1.2.1.cmml">⁢</mo><mrow id="A1.E16.m1.5.5.1.1.2.3.2" xref="A1.E16.m1.5.5.1.1.2.3.1.cmml"><mo id="A1.E16.m1.5.5.1.1.2.3.2.1" stretchy="false" xref="A1.E16.m1.5.5.1.1.2.3.1.1.cmml">[</mo><mi id="A1.E16.m1.1.1" xref="A1.E16.m1.1.1.cmml">f</mi><mo id="A1.E16.m1.5.5.1.1.2.3.2.2" stretchy="false" xref="A1.E16.m1.5.5.1.1.2.3.1.1.cmml">]</mo></mrow></mrow><mo id="A1.E16.m1.5.5.1.1.3" xref="A1.E16.m1.5.5.1.1.3.cmml">=</mo><mrow id="A1.E16.m1.5.5.1.1.4" xref="A1.E16.m1.5.5.1.1.4.cmml"><msub id="A1.E16.m1.5.5.1.1.4.2" xref="A1.E16.m1.5.5.1.1.4.2.cmml"><mi id="A1.E16.m1.5.5.1.1.4.2.2" xref="A1.E16.m1.5.5.1.1.4.2.2.cmml">𝔼</mi><mrow id="A1.E16.m1.5.5.1.1.4.2.3" xref="A1.E16.m1.5.5.1.1.4.2.3.cmml"><mi id="A1.E16.m1.5.5.1.1.4.2.3.2" xref="A1.E16.m1.5.5.1.1.4.2.3.2.cmml">𝐱</mi><mo id="A1.E16.m1.5.5.1.1.4.2.3.1" xref="A1.E16.m1.5.5.1.1.4.2.3.1.cmml">∼</mo><mi id="A1.E16.m1.5.5.1.1.4.2.3.3" xref="A1.E16.m1.5.5.1.1.4.2.3.3.cmml">p</mi></mrow></msub><mo id="A1.E16.m1.5.5.1.1.4.1" lspace="0.167em" xref="A1.E16.m1.5.5.1.1.4.1.cmml">⁢</mo><mrow id="A1.E16.m1.5.5.1.1.4.3" xref="A1.E16.m1.5.5.1.1.4.3.cmml"><mi id="A1.E16.m1.5.5.1.1.4.3.1" xref="A1.E16.m1.5.5.1.1.4.3.1.cmml">log</mi><mo id="A1.E16.m1.5.5.1.1.4.3a" lspace="0.167em" xref="A1.E16.m1.5.5.1.1.4.3.cmml">⁡</mo><msub id="A1.E16.m1.5.5.1.1.4.3.2" xref="A1.E16.m1.5.5.1.1.4.3.2.cmml"><mi id="A1.E16.m1.5.5.1.1.4.3.2.2" xref="A1.E16.m1.5.5.1.1.4.3.2.2.cmml">q</mi><mi id="A1.E16.m1.5.5.1.1.4.3.2.3" xref="A1.E16.m1.5.5.1.1.4.3.2.3.cmml">f</mi></msub></mrow><mo id="A1.E16.m1.5.5.1.1.4.1a" xref="A1.E16.m1.5.5.1.1.4.1.cmml">⁢</mo><mrow id="A1.E16.m1.5.5.1.1.4.4.2" xref="A1.E16.m1.5.5.1.1.4.cmml"><mo id="A1.E16.m1.5.5.1.1.4.4.2.1" stretchy="false" xref="A1.E16.m1.5.5.1.1.4.cmml">(</mo><mi id="A1.E16.m1.2.2" xref="A1.E16.m1.2.2.cmml">𝐱</mi><mo id="A1.E16.m1.5.5.1.1.4.4.2.2" stretchy="false" xref="A1.E16.m1.5.5.1.1.4.cmml">)</mo></mrow></mrow><mo id="A1.E16.m1.5.5.1.1.5" xref="A1.E16.m1.5.5.1.1.5.cmml">=</mo><mrow id="A1.E16.m1.5.5.1.1.6" xref="A1.E16.m1.5.5.1.1.6.cmml"><mrow id="A1.E16.m1.5.5.1.1.6.2" xref="A1.E16.m1.5.5.1.1.6.2.cmml"><msub id="A1.E16.m1.5.5.1.1.6.2.2" xref="A1.E16.m1.5.5.1.1.6.2.2.cmml"><mi id="A1.E16.m1.5.5.1.1.6.2.2.2" xref="A1.E16.m1.5.5.1.1.6.2.2.2.cmml">𝔼</mi><mrow id="A1.E16.m1.5.5.1.1.6.2.2.3" xref="A1.E16.m1.5.5.1.1.6.2.2.3.cmml"><mi id="A1.E16.m1.5.5.1.1.6.2.2.3.2" xref="A1.E16.m1.5.5.1.1.6.2.2.3.2.cmml">𝐱</mi><mo id="A1.E16.m1.5.5.1.1.6.2.2.3.1" xref="A1.E16.m1.5.5.1.1.6.2.2.3.1.cmml">∼</mo><mi id="A1.E16.m1.5.5.1.1.6.2.2.3.3" xref="A1.E16.m1.5.5.1.1.6.2.2.3.3.cmml">p</mi></mrow></msub><mo id="A1.E16.m1.5.5.1.1.6.2.1" xref="A1.E16.m1.5.5.1.1.6.2.1.cmml">⁢</mo><mi id="A1.E16.m1.5.5.1.1.6.2.3" xref="A1.E16.m1.5.5.1.1.6.2.3.cmml">f</mi><mo id="A1.E16.m1.5.5.1.1.6.2.1a" xref="A1.E16.m1.5.5.1.1.6.2.1.cmml">⁢</mo><mrow id="A1.E16.m1.5.5.1.1.6.2.4.2" xref="A1.E16.m1.5.5.1.1.6.2.cmml"><mo id="A1.E16.m1.5.5.1.1.6.2.4.2.1" stretchy="false" xref="A1.E16.m1.5.5.1.1.6.2.cmml">(</mo><mi id="A1.E16.m1.3.3" xref="A1.E16.m1.3.3.cmml">𝐱</mi><mo id="A1.E16.m1.5.5.1.1.6.2.4.2.2" stretchy="false" xref="A1.E16.m1.5.5.1.1.6.2.cmml">)</mo></mrow></mrow><mo id="A1.E16.m1.5.5.1.1.6.1" xref="A1.E16.m1.5.5.1.1.6.1.cmml">−</mo><mrow id="A1.E16.m1.5.5.1.1.6.3" xref="A1.E16.m1.5.5.1.1.6.3.cmml"><mrow id="A1.E16.m1.5.5.1.1.6.3.2" xref="A1.E16.m1.5.5.1.1.6.3.2.cmml"><mi id="A1.E16.m1.5.5.1.1.6.3.2.1" xref="A1.E16.m1.5.5.1.1.6.3.2.1.cmml">log</mi><mo id="A1.E16.m1.5.5.1.1.6.3.2a" lspace="0.167em" xref="A1.E16.m1.5.5.1.1.6.3.2.cmml">⁡</mo><mi id="A1.E16.m1.5.5.1.1.6.3.2.2" xref="A1.E16.m1.5.5.1.1.6.3.2.2.cmml">Z</mi></mrow><mo id="A1.E16.m1.5.5.1.1.6.3.1" xref="A1.E16.m1.5.5.1.1.6.3.1.cmml">⁢</mo><mrow id="A1.E16.m1.5.5.1.1.6.3.3.2" xref="A1.E16.m1.5.5.1.1.6.3.3.1.cmml"><mo id="A1.E16.m1.5.5.1.1.6.3.3.2.1" stretchy="false" xref="A1.E16.m1.5.5.1.1.6.3.3.1.1.cmml">[</mo><mi id="A1.E16.m1.4.4" xref="A1.E16.m1.4.4.cmml">f</mi><mo id="A1.E16.m1.5.5.1.1.6.3.3.2.2" stretchy="false" xref="A1.E16.m1.5.5.1.1.6.3.3.1.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo id="A1.E16.m1.5.5.1.2" lspace="0.170em" xref="A1.E16.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E16.m1.5b"><apply id="A1.E16.m1.5.5.1.1.cmml" xref="A1.E16.m1.5.5.1"><and id="A1.E16.m1.5.5.1.1a.cmml" xref="A1.E16.m1.5.5.1"></and><apply id="A1.E16.m1.5.5.1.1b.cmml" xref="A1.E16.m1.5.5.1"><eq id="A1.E16.m1.5.5.1.1.3.cmml" xref="A1.E16.m1.5.5.1.1.3"></eq><apply id="A1.E16.m1.5.5.1.1.2.cmml" xref="A1.E16.m1.5.5.1.1.2"><times id="A1.E16.m1.5.5.1.1.2.1.cmml" xref="A1.E16.m1.5.5.1.1.2.1"></times><ci id="A1.E16.m1.5.5.1.1.2.2.cmml" xref="A1.E16.m1.5.5.1.1.2.2">𝐿</ci><apply id="A1.E16.m1.5.5.1.1.2.3.1.cmml" xref="A1.E16.m1.5.5.1.1.2.3.2"><csymbol cd="latexml" id="A1.E16.m1.5.5.1.1.2.3.1.1.cmml" xref="A1.E16.m1.5.5.1.1.2.3.2.1">delimited-[]</csymbol><ci id="A1.E16.m1.1.1.cmml" xref="A1.E16.m1.1.1">𝑓</ci></apply></apply><apply id="A1.E16.m1.5.5.1.1.4.cmml" xref="A1.E16.m1.5.5.1.1.4"><times id="A1.E16.m1.5.5.1.1.4.1.cmml" xref="A1.E16.m1.5.5.1.1.4.1"></times><apply id="A1.E16.m1.5.5.1.1.4.2.cmml" xref="A1.E16.m1.5.5.1.1.4.2"><csymbol cd="ambiguous" id="A1.E16.m1.5.5.1.1.4.2.1.cmml" xref="A1.E16.m1.5.5.1.1.4.2">subscript</csymbol><ci id="A1.E16.m1.5.5.1.1.4.2.2.cmml" xref="A1.E16.m1.5.5.1.1.4.2.2">𝔼</ci><apply id="A1.E16.m1.5.5.1.1.4.2.3.cmml" xref="A1.E16.m1.5.5.1.1.4.2.3"><csymbol cd="latexml" id="A1.E16.m1.5.5.1.1.4.2.3.1.cmml" xref="A1.E16.m1.5.5.1.1.4.2.3.1">similar-to</csymbol><ci id="A1.E16.m1.5.5.1.1.4.2.3.2.cmml" xref="A1.E16.m1.5.5.1.1.4.2.3.2">𝐱</ci><ci id="A1.E16.m1.5.5.1.1.4.2.3.3.cmml" xref="A1.E16.m1.5.5.1.1.4.2.3.3">𝑝</ci></apply></apply><apply id="A1.E16.m1.5.5.1.1.4.3.cmml" xref="A1.E16.m1.5.5.1.1.4.3"><log id="A1.E16.m1.5.5.1.1.4.3.1.cmml" xref="A1.E16.m1.5.5.1.1.4.3.1"></log><apply id="A1.E16.m1.5.5.1.1.4.3.2.cmml" xref="A1.E16.m1.5.5.1.1.4.3.2"><csymbol cd="ambiguous" id="A1.E16.m1.5.5.1.1.4.3.2.1.cmml" xref="A1.E16.m1.5.5.1.1.4.3.2">subscript</csymbol><ci id="A1.E16.m1.5.5.1.1.4.3.2.2.cmml" xref="A1.E16.m1.5.5.1.1.4.3.2.2">𝑞</ci><ci id="A1.E16.m1.5.5.1.1.4.3.2.3.cmml" xref="A1.E16.m1.5.5.1.1.4.3.2.3">𝑓</ci></apply></apply><ci id="A1.E16.m1.2.2.cmml" xref="A1.E16.m1.2.2">𝐱</ci></apply></apply><apply id="A1.E16.m1.5.5.1.1c.cmml" xref="A1.E16.m1.5.5.1"><eq id="A1.E16.m1.5.5.1.1.5.cmml" xref="A1.E16.m1.5.5.1.1.5"></eq><share href="https://arxiv.org/html/2410.03535v1#A1.E16.m1.5.5.1.1.4.cmml" id="A1.E16.m1.5.5.1.1d.cmml" xref="A1.E16.m1.5.5.1"></share><apply id="A1.E16.m1.5.5.1.1.6.cmml" xref="A1.E16.m1.5.5.1.1.6"><minus id="A1.E16.m1.5.5.1.1.6.1.cmml" xref="A1.E16.m1.5.5.1.1.6.1"></minus><apply id="A1.E16.m1.5.5.1.1.6.2.cmml" xref="A1.E16.m1.5.5.1.1.6.2"><times id="A1.E16.m1.5.5.1.1.6.2.1.cmml" xref="A1.E16.m1.5.5.1.1.6.2.1"></times><apply id="A1.E16.m1.5.5.1.1.6.2.2.cmml" xref="A1.E16.m1.5.5.1.1.6.2.2"><csymbol cd="ambiguous" id="A1.E16.m1.5.5.1.1.6.2.2.1.cmml" xref="A1.E16.m1.5.5.1.1.6.2.2">subscript</csymbol><ci id="A1.E16.m1.5.5.1.1.6.2.2.2.cmml" xref="A1.E16.m1.5.5.1.1.6.2.2.2">𝔼</ci><apply id="A1.E16.m1.5.5.1.1.6.2.2.3.cmml" xref="A1.E16.m1.5.5.1.1.6.2.2.3"><csymbol cd="latexml" id="A1.E16.m1.5.5.1.1.6.2.2.3.1.cmml" xref="A1.E16.m1.5.5.1.1.6.2.2.3.1">similar-to</csymbol><ci id="A1.E16.m1.5.5.1.1.6.2.2.3.2.cmml" xref="A1.E16.m1.5.5.1.1.6.2.2.3.2">𝐱</ci><ci id="A1.E16.m1.5.5.1.1.6.2.2.3.3.cmml" xref="A1.E16.m1.5.5.1.1.6.2.2.3.3">𝑝</ci></apply></apply><ci id="A1.E16.m1.5.5.1.1.6.2.3.cmml" xref="A1.E16.m1.5.5.1.1.6.2.3">𝑓</ci><ci id="A1.E16.m1.3.3.cmml" xref="A1.E16.m1.3.3">𝐱</ci></apply><apply id="A1.E16.m1.5.5.1.1.6.3.cmml" xref="A1.E16.m1.5.5.1.1.6.3"><times id="A1.E16.m1.5.5.1.1.6.3.1.cmml" xref="A1.E16.m1.5.5.1.1.6.3.1"></times><apply id="A1.E16.m1.5.5.1.1.6.3.2.cmml" xref="A1.E16.m1.5.5.1.1.6.3.2"><log id="A1.E16.m1.5.5.1.1.6.3.2.1.cmml" xref="A1.E16.m1.5.5.1.1.6.3.2.1"></log><ci id="A1.E16.m1.5.5.1.1.6.3.2.2.cmml" xref="A1.E16.m1.5.5.1.1.6.3.2.2">𝑍</ci></apply><apply id="A1.E16.m1.5.5.1.1.6.3.3.1.cmml" xref="A1.E16.m1.5.5.1.1.6.3.3.2"><csymbol cd="latexml" id="A1.E16.m1.5.5.1.1.6.3.3.1.1.cmml" xref="A1.E16.m1.5.5.1.1.6.3.3.2.1">delimited-[]</csymbol><ci id="A1.E16.m1.4.4.cmml" xref="A1.E16.m1.4.4">𝑓</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E16.m1.5c">L[f]=\mathbb{E}_{\mathbf{x}\sim p}\log q_{f}(\mathbf{x})=\mathbb{E}_{\mathbf{x%
}\sim p}f(\mathbf{x})-\log Z[f]\,.</annotation><annotation encoding="application/x-llamapun" id="A1.E16.m1.5d">italic_L [ italic_f ] = blackboard_E start_POSTSUBSCRIPT bold_x ∼ italic_p end_POSTSUBSCRIPT roman_log italic_q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT ( bold_x ) = blackboard_E start_POSTSUBSCRIPT bold_x ∼ italic_p end_POSTSUBSCRIPT italic_f ( bold_x ) - roman_log italic_Z [ italic_f ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A1.p2">
<p class="ltx_p" id="A1.p2.1">The <em class="ltx_emph ltx_font_italic" id="A1.p2.1.1">first variation</em> of <math alttext="L" class="ltx_Math" display="inline" id="A1.p2.1.m1.1"><semantics id="A1.p2.1.m1.1a"><mi id="A1.p2.1.m1.1.1" xref="A1.p2.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="A1.p2.1.m1.1b"><ci id="A1.p2.1.m1.1.1.cmml" xref="A1.p2.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.1.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="A1.p2.1.m1.1d">italic_L</annotation></semantics></math> can be computed as</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E17">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\delta L[f;g]\coloneqq\left.\frac{dL[f+\epsilon g]}{d\epsilon}\right|_{%
\epsilon=0}=\mathbb{E}_{\mathbf{x}\sim p}\,g(\mathbf{x})-\delta\log Z[f;g]=%
\mathbb{E}_{\mathbf{x}\sim p}\,g(\mathbf{x})-\mathbb{E}_{\mathbf{x}\sim q_{f}}%
\,g(\mathbf{x})\,." class="ltx_Math" display="block" id="A1.E17.m1.10"><semantics id="A1.E17.m1.10a"><mrow id="A1.E17.m1.10.10.1" xref="A1.E17.m1.10.10.1.1.cmml"><mrow id="A1.E17.m1.10.10.1.1" xref="A1.E17.m1.10.10.1.1.cmml"><mrow id="A1.E17.m1.10.10.1.1.2" xref="A1.E17.m1.10.10.1.1.2.cmml"><mi id="A1.E17.m1.10.10.1.1.2.2" xref="A1.E17.m1.10.10.1.1.2.2.cmml">δ</mi><mo id="A1.E17.m1.10.10.1.1.2.1" xref="A1.E17.m1.10.10.1.1.2.1.cmml">⁢</mo><mi id="A1.E17.m1.10.10.1.1.2.3" xref="A1.E17.m1.10.10.1.1.2.3.cmml">L</mi><mo id="A1.E17.m1.10.10.1.1.2.1a" xref="A1.E17.m1.10.10.1.1.2.1.cmml">⁢</mo><mrow id="A1.E17.m1.10.10.1.1.2.4.2" xref="A1.E17.m1.10.10.1.1.2.4.1.cmml"><mo id="A1.E17.m1.10.10.1.1.2.4.2.1" stretchy="false" xref="A1.E17.m1.10.10.1.1.2.4.1.cmml">[</mo><mi id="A1.E17.m1.2.2" xref="A1.E17.m1.2.2.cmml">f</mi><mo id="A1.E17.m1.10.10.1.1.2.4.2.2" xref="A1.E17.m1.10.10.1.1.2.4.1.cmml">;</mo><mi id="A1.E17.m1.3.3" xref="A1.E17.m1.3.3.cmml">g</mi><mo id="A1.E17.m1.10.10.1.1.2.4.2.3" stretchy="false" xref="A1.E17.m1.10.10.1.1.2.4.1.cmml">]</mo></mrow></mrow><mo id="A1.E17.m1.10.10.1.1.3" xref="A1.E17.m1.10.10.1.1.3.cmml">≔</mo><msub id="A1.E17.m1.10.10.1.1.4.2" xref="A1.E17.m1.10.10.1.1.4.1.cmml"><mrow id="A1.E17.m1.10.10.1.1.4.2.2" xref="A1.E17.m1.10.10.1.1.4.1.cmml"><mfrac id="A1.E17.m1.1.1" xref="A1.E17.m1.1.1.cmml"><mrow id="A1.E17.m1.1.1.1" xref="A1.E17.m1.1.1.1.cmml"><mi id="A1.E17.m1.1.1.1.3" xref="A1.E17.m1.1.1.1.3.cmml">d</mi><mo id="A1.E17.m1.1.1.1.2" xref="A1.E17.m1.1.1.1.2.cmml">⁢</mo><mi id="A1.E17.m1.1.1.1.4" xref="A1.E17.m1.1.1.1.4.cmml">L</mi><mo id="A1.E17.m1.1.1.1.2a" xref="A1.E17.m1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E17.m1.1.1.1.1.1" xref="A1.E17.m1.1.1.1.1.2.cmml"><mo id="A1.E17.m1.1.1.1.1.1.2" stretchy="false" xref="A1.E17.m1.1.1.1.1.2.1.cmml">[</mo><mrow id="A1.E17.m1.1.1.1.1.1.1" xref="A1.E17.m1.1.1.1.1.1.1.cmml"><mi id="A1.E17.m1.1.1.1.1.1.1.2" xref="A1.E17.m1.1.1.1.1.1.1.2.cmml">f</mi><mo id="A1.E17.m1.1.1.1.1.1.1.1" xref="A1.E17.m1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="A1.E17.m1.1.1.1.1.1.1.3" xref="A1.E17.m1.1.1.1.1.1.1.3.cmml"><mi id="A1.E17.m1.1.1.1.1.1.1.3.2" xref="A1.E17.m1.1.1.1.1.1.1.3.2.cmml">ϵ</mi><mo id="A1.E17.m1.1.1.1.1.1.1.3.1" xref="A1.E17.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="A1.E17.m1.1.1.1.1.1.1.3.3" xref="A1.E17.m1.1.1.1.1.1.1.3.3.cmml">g</mi></mrow></mrow><mo id="A1.E17.m1.1.1.1.1.1.3" stretchy="false" xref="A1.E17.m1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mrow id="A1.E17.m1.1.1.3" xref="A1.E17.m1.1.1.3.cmml"><mi id="A1.E17.m1.1.1.3.2" xref="A1.E17.m1.1.1.3.2.cmml">d</mi><mo id="A1.E17.m1.1.1.3.1" xref="A1.E17.m1.1.1.3.1.cmml">⁢</mo><mi id="A1.E17.m1.1.1.3.3" xref="A1.E17.m1.1.1.3.3.cmml">ϵ</mi></mrow></mfrac><mo id="A1.E17.m1.10.10.1.1.4.2.2.1" xref="A1.E17.m1.10.10.1.1.4.1.1.cmml">|</mo></mrow><mrow id="A1.E17.m1.4.4.1" xref="A1.E17.m1.4.4.1.cmml"><mi id="A1.E17.m1.4.4.1.2" xref="A1.E17.m1.4.4.1.2.cmml">ϵ</mi><mo id="A1.E17.m1.4.4.1.1" xref="A1.E17.m1.4.4.1.1.cmml">=</mo><mn id="A1.E17.m1.4.4.1.3" xref="A1.E17.m1.4.4.1.3.cmml">0</mn></mrow></msub><mo id="A1.E17.m1.10.10.1.1.5" xref="A1.E17.m1.10.10.1.1.5.cmml">=</mo><mrow id="A1.E17.m1.10.10.1.1.6" xref="A1.E17.m1.10.10.1.1.6.cmml"><mrow id="A1.E17.m1.10.10.1.1.6.2" xref="A1.E17.m1.10.10.1.1.6.2.cmml"><msub id="A1.E17.m1.10.10.1.1.6.2.2" xref="A1.E17.m1.10.10.1.1.6.2.2.cmml"><mi id="A1.E17.m1.10.10.1.1.6.2.2.2" xref="A1.E17.m1.10.10.1.1.6.2.2.2.cmml">𝔼</mi><mrow id="A1.E17.m1.10.10.1.1.6.2.2.3" xref="A1.E17.m1.10.10.1.1.6.2.2.3.cmml"><mi id="A1.E17.m1.10.10.1.1.6.2.2.3.2" xref="A1.E17.m1.10.10.1.1.6.2.2.3.2.cmml">𝐱</mi><mo id="A1.E17.m1.10.10.1.1.6.2.2.3.1" xref="A1.E17.m1.10.10.1.1.6.2.2.3.1.cmml">∼</mo><mi id="A1.E17.m1.10.10.1.1.6.2.2.3.3" xref="A1.E17.m1.10.10.1.1.6.2.2.3.3.cmml">p</mi></mrow></msub><mo id="A1.E17.m1.10.10.1.1.6.2.1" xref="A1.E17.m1.10.10.1.1.6.2.1.cmml">⁢</mo><mi id="A1.E17.m1.10.10.1.1.6.2.3" xref="A1.E17.m1.10.10.1.1.6.2.3.cmml">g</mi><mo id="A1.E17.m1.10.10.1.1.6.2.1a" xref="A1.E17.m1.10.10.1.1.6.2.1.cmml">⁢</mo><mrow id="A1.E17.m1.10.10.1.1.6.2.4.2" xref="A1.E17.m1.10.10.1.1.6.2.cmml"><mo id="A1.E17.m1.10.10.1.1.6.2.4.2.1" stretchy="false" xref="A1.E17.m1.10.10.1.1.6.2.cmml">(</mo><mi id="A1.E17.m1.5.5" xref="A1.E17.m1.5.5.cmml">𝐱</mi><mo id="A1.E17.m1.10.10.1.1.6.2.4.2.2" stretchy="false" xref="A1.E17.m1.10.10.1.1.6.2.cmml">)</mo></mrow></mrow><mo id="A1.E17.m1.10.10.1.1.6.1" xref="A1.E17.m1.10.10.1.1.6.1.cmml">−</mo><mrow id="A1.E17.m1.10.10.1.1.6.3" xref="A1.E17.m1.10.10.1.1.6.3.cmml"><mi id="A1.E17.m1.10.10.1.1.6.3.2" xref="A1.E17.m1.10.10.1.1.6.3.2.cmml">δ</mi><mo id="A1.E17.m1.10.10.1.1.6.3.1" lspace="0.167em" xref="A1.E17.m1.10.10.1.1.6.3.1.cmml">⁢</mo><mrow id="A1.E17.m1.10.10.1.1.6.3.3" xref="A1.E17.m1.10.10.1.1.6.3.3.cmml"><mi id="A1.E17.m1.10.10.1.1.6.3.3.1" xref="A1.E17.m1.10.10.1.1.6.3.3.1.cmml">log</mi><mo id="A1.E17.m1.10.10.1.1.6.3.3a" lspace="0.167em" xref="A1.E17.m1.10.10.1.1.6.3.3.cmml">⁡</mo><mi id="A1.E17.m1.10.10.1.1.6.3.3.2" xref="A1.E17.m1.10.10.1.1.6.3.3.2.cmml">Z</mi></mrow><mo id="A1.E17.m1.10.10.1.1.6.3.1a" xref="A1.E17.m1.10.10.1.1.6.3.1.cmml">⁢</mo><mrow id="A1.E17.m1.10.10.1.1.6.3.4.2" xref="A1.E17.m1.10.10.1.1.6.3.4.1.cmml"><mo id="A1.E17.m1.10.10.1.1.6.3.4.2.1" stretchy="false" xref="A1.E17.m1.10.10.1.1.6.3.4.1.cmml">[</mo><mi id="A1.E17.m1.6.6" xref="A1.E17.m1.6.6.cmml">f</mi><mo id="A1.E17.m1.10.10.1.1.6.3.4.2.2" xref="A1.E17.m1.10.10.1.1.6.3.4.1.cmml">;</mo><mi id="A1.E17.m1.7.7" xref="A1.E17.m1.7.7.cmml">g</mi><mo id="A1.E17.m1.10.10.1.1.6.3.4.2.3" stretchy="false" xref="A1.E17.m1.10.10.1.1.6.3.4.1.cmml">]</mo></mrow></mrow></mrow><mo id="A1.E17.m1.10.10.1.1.7" xref="A1.E17.m1.10.10.1.1.7.cmml">=</mo><mrow id="A1.E17.m1.10.10.1.1.8" xref="A1.E17.m1.10.10.1.1.8.cmml"><mrow id="A1.E17.m1.10.10.1.1.8.2" xref="A1.E17.m1.10.10.1.1.8.2.cmml"><msub id="A1.E17.m1.10.10.1.1.8.2.2" xref="A1.E17.m1.10.10.1.1.8.2.2.cmml"><mi id="A1.E17.m1.10.10.1.1.8.2.2.2" xref="A1.E17.m1.10.10.1.1.8.2.2.2.cmml">𝔼</mi><mrow id="A1.E17.m1.10.10.1.1.8.2.2.3" xref="A1.E17.m1.10.10.1.1.8.2.2.3.cmml"><mi id="A1.E17.m1.10.10.1.1.8.2.2.3.2" xref="A1.E17.m1.10.10.1.1.8.2.2.3.2.cmml">𝐱</mi><mo id="A1.E17.m1.10.10.1.1.8.2.2.3.1" xref="A1.E17.m1.10.10.1.1.8.2.2.3.1.cmml">∼</mo><mi id="A1.E17.m1.10.10.1.1.8.2.2.3.3" xref="A1.E17.m1.10.10.1.1.8.2.2.3.3.cmml">p</mi></mrow></msub><mo id="A1.E17.m1.10.10.1.1.8.2.1" xref="A1.E17.m1.10.10.1.1.8.2.1.cmml">⁢</mo><mi id="A1.E17.m1.10.10.1.1.8.2.3" xref="A1.E17.m1.10.10.1.1.8.2.3.cmml">g</mi><mo id="A1.E17.m1.10.10.1.1.8.2.1a" xref="A1.E17.m1.10.10.1.1.8.2.1.cmml">⁢</mo><mrow id="A1.E17.m1.10.10.1.1.8.2.4.2" xref="A1.E17.m1.10.10.1.1.8.2.cmml"><mo id="A1.E17.m1.10.10.1.1.8.2.4.2.1" stretchy="false" xref="A1.E17.m1.10.10.1.1.8.2.cmml">(</mo><mi id="A1.E17.m1.8.8" xref="A1.E17.m1.8.8.cmml">𝐱</mi><mo id="A1.E17.m1.10.10.1.1.8.2.4.2.2" stretchy="false" xref="A1.E17.m1.10.10.1.1.8.2.cmml">)</mo></mrow></mrow><mo id="A1.E17.m1.10.10.1.1.8.1" xref="A1.E17.m1.10.10.1.1.8.1.cmml">−</mo><mrow id="A1.E17.m1.10.10.1.1.8.3" xref="A1.E17.m1.10.10.1.1.8.3.cmml"><msub id="A1.E17.m1.10.10.1.1.8.3.2" xref="A1.E17.m1.10.10.1.1.8.3.2.cmml"><mi id="A1.E17.m1.10.10.1.1.8.3.2.2" xref="A1.E17.m1.10.10.1.1.8.3.2.2.cmml">𝔼</mi><mrow id="A1.E17.m1.10.10.1.1.8.3.2.3" xref="A1.E17.m1.10.10.1.1.8.3.2.3.cmml"><mi id="A1.E17.m1.10.10.1.1.8.3.2.3.2" xref="A1.E17.m1.10.10.1.1.8.3.2.3.2.cmml">𝐱</mi><mo id="A1.E17.m1.10.10.1.1.8.3.2.3.1" xref="A1.E17.m1.10.10.1.1.8.3.2.3.1.cmml">∼</mo><msub id="A1.E17.m1.10.10.1.1.8.3.2.3.3" xref="A1.E17.m1.10.10.1.1.8.3.2.3.3.cmml"><mi id="A1.E17.m1.10.10.1.1.8.3.2.3.3.2" xref="A1.E17.m1.10.10.1.1.8.3.2.3.3.2.cmml">q</mi><mi id="A1.E17.m1.10.10.1.1.8.3.2.3.3.3" xref="A1.E17.m1.10.10.1.1.8.3.2.3.3.3.cmml">f</mi></msub></mrow></msub><mo id="A1.E17.m1.10.10.1.1.8.3.1" xref="A1.E17.m1.10.10.1.1.8.3.1.cmml">⁢</mo><mi id="A1.E17.m1.10.10.1.1.8.3.3" xref="A1.E17.m1.10.10.1.1.8.3.3.cmml">g</mi><mo id="A1.E17.m1.10.10.1.1.8.3.1a" xref="A1.E17.m1.10.10.1.1.8.3.1.cmml">⁢</mo><mrow id="A1.E17.m1.10.10.1.1.8.3.4.2" xref="A1.E17.m1.10.10.1.1.8.3.cmml"><mo id="A1.E17.m1.10.10.1.1.8.3.4.2.1" stretchy="false" xref="A1.E17.m1.10.10.1.1.8.3.cmml">(</mo><mi id="A1.E17.m1.9.9" xref="A1.E17.m1.9.9.cmml">𝐱</mi><mo id="A1.E17.m1.10.10.1.1.8.3.4.2.2" stretchy="false" xref="A1.E17.m1.10.10.1.1.8.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A1.E17.m1.10.10.1.2" lspace="0.170em" xref="A1.E17.m1.10.10.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E17.m1.10b"><apply id="A1.E17.m1.10.10.1.1.cmml" xref="A1.E17.m1.10.10.1"><and id="A1.E17.m1.10.10.1.1a.cmml" xref="A1.E17.m1.10.10.1"></and><apply id="A1.E17.m1.10.10.1.1b.cmml" xref="A1.E17.m1.10.10.1"><ci id="A1.E17.m1.10.10.1.1.3.cmml" xref="A1.E17.m1.10.10.1.1.3">≔</ci><apply id="A1.E17.m1.10.10.1.1.2.cmml" xref="A1.E17.m1.10.10.1.1.2"><times id="A1.E17.m1.10.10.1.1.2.1.cmml" xref="A1.E17.m1.10.10.1.1.2.1"></times><ci id="A1.E17.m1.10.10.1.1.2.2.cmml" xref="A1.E17.m1.10.10.1.1.2.2">𝛿</ci><ci id="A1.E17.m1.10.10.1.1.2.3.cmml" xref="A1.E17.m1.10.10.1.1.2.3">𝐿</ci><list id="A1.E17.m1.10.10.1.1.2.4.1.cmml" xref="A1.E17.m1.10.10.1.1.2.4.2"><ci id="A1.E17.m1.2.2.cmml" xref="A1.E17.m1.2.2">𝑓</ci><ci id="A1.E17.m1.3.3.cmml" xref="A1.E17.m1.3.3">𝑔</ci></list></apply><apply id="A1.E17.m1.10.10.1.1.4.1.cmml" xref="A1.E17.m1.10.10.1.1.4.2"><csymbol cd="latexml" id="A1.E17.m1.10.10.1.1.4.1.1.cmml" xref="A1.E17.m1.10.10.1.1.4.2.2.1">evaluated-at</csymbol><apply id="A1.E17.m1.1.1.cmml" xref="A1.E17.m1.1.1"><divide id="A1.E17.m1.1.1.2.cmml" xref="A1.E17.m1.1.1"></divide><apply id="A1.E17.m1.1.1.1.cmml" xref="A1.E17.m1.1.1.1"><times id="A1.E17.m1.1.1.1.2.cmml" xref="A1.E17.m1.1.1.1.2"></times><ci id="A1.E17.m1.1.1.1.3.cmml" xref="A1.E17.m1.1.1.1.3">𝑑</ci><ci id="A1.E17.m1.1.1.1.4.cmml" xref="A1.E17.m1.1.1.1.4">𝐿</ci><apply id="A1.E17.m1.1.1.1.1.2.cmml" xref="A1.E17.m1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E17.m1.1.1.1.1.2.1.cmml" xref="A1.E17.m1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A1.E17.m1.1.1.1.1.1.1.cmml" xref="A1.E17.m1.1.1.1.1.1.1"><plus id="A1.E17.m1.1.1.1.1.1.1.1.cmml" xref="A1.E17.m1.1.1.1.1.1.1.1"></plus><ci id="A1.E17.m1.1.1.1.1.1.1.2.cmml" xref="A1.E17.m1.1.1.1.1.1.1.2">𝑓</ci><apply id="A1.E17.m1.1.1.1.1.1.1.3.cmml" xref="A1.E17.m1.1.1.1.1.1.1.3"><times id="A1.E17.m1.1.1.1.1.1.1.3.1.cmml" xref="A1.E17.m1.1.1.1.1.1.1.3.1"></times><ci id="A1.E17.m1.1.1.1.1.1.1.3.2.cmml" xref="A1.E17.m1.1.1.1.1.1.1.3.2">italic-ϵ</ci><ci id="A1.E17.m1.1.1.1.1.1.1.3.3.cmml" xref="A1.E17.m1.1.1.1.1.1.1.3.3">𝑔</ci></apply></apply></apply></apply><apply id="A1.E17.m1.1.1.3.cmml" xref="A1.E17.m1.1.1.3"><times id="A1.E17.m1.1.1.3.1.cmml" xref="A1.E17.m1.1.1.3.1"></times><ci id="A1.E17.m1.1.1.3.2.cmml" xref="A1.E17.m1.1.1.3.2">𝑑</ci><ci id="A1.E17.m1.1.1.3.3.cmml" xref="A1.E17.m1.1.1.3.3">italic-ϵ</ci></apply></apply><apply id="A1.E17.m1.4.4.1.cmml" xref="A1.E17.m1.4.4.1"><eq id="A1.E17.m1.4.4.1.1.cmml" xref="A1.E17.m1.4.4.1.1"></eq><ci id="A1.E17.m1.4.4.1.2.cmml" xref="A1.E17.m1.4.4.1.2">italic-ϵ</ci><cn id="A1.E17.m1.4.4.1.3.cmml" type="integer" xref="A1.E17.m1.4.4.1.3">0</cn></apply></apply></apply><apply id="A1.E17.m1.10.10.1.1c.cmml" xref="A1.E17.m1.10.10.1"><eq id="A1.E17.m1.10.10.1.1.5.cmml" xref="A1.E17.m1.10.10.1.1.5"></eq><share href="https://arxiv.org/html/2410.03535v1#A1.E17.m1.10.10.1.1.4.cmml" id="A1.E17.m1.10.10.1.1d.cmml" xref="A1.E17.m1.10.10.1"></share><apply id="A1.E17.m1.10.10.1.1.6.cmml" xref="A1.E17.m1.10.10.1.1.6"><minus id="A1.E17.m1.10.10.1.1.6.1.cmml" xref="A1.E17.m1.10.10.1.1.6.1"></minus><apply id="A1.E17.m1.10.10.1.1.6.2.cmml" xref="A1.E17.m1.10.10.1.1.6.2"><times id="A1.E17.m1.10.10.1.1.6.2.1.cmml" xref="A1.E17.m1.10.10.1.1.6.2.1"></times><apply id="A1.E17.m1.10.10.1.1.6.2.2.cmml" xref="A1.E17.m1.10.10.1.1.6.2.2"><csymbol cd="ambiguous" id="A1.E17.m1.10.10.1.1.6.2.2.1.cmml" xref="A1.E17.m1.10.10.1.1.6.2.2">subscript</csymbol><ci id="A1.E17.m1.10.10.1.1.6.2.2.2.cmml" xref="A1.E17.m1.10.10.1.1.6.2.2.2">𝔼</ci><apply id="A1.E17.m1.10.10.1.1.6.2.2.3.cmml" xref="A1.E17.m1.10.10.1.1.6.2.2.3"><csymbol cd="latexml" id="A1.E17.m1.10.10.1.1.6.2.2.3.1.cmml" xref="A1.E17.m1.10.10.1.1.6.2.2.3.1">similar-to</csymbol><ci id="A1.E17.m1.10.10.1.1.6.2.2.3.2.cmml" xref="A1.E17.m1.10.10.1.1.6.2.2.3.2">𝐱</ci><ci id="A1.E17.m1.10.10.1.1.6.2.2.3.3.cmml" xref="A1.E17.m1.10.10.1.1.6.2.2.3.3">𝑝</ci></apply></apply><ci id="A1.E17.m1.10.10.1.1.6.2.3.cmml" xref="A1.E17.m1.10.10.1.1.6.2.3">𝑔</ci><ci id="A1.E17.m1.5.5.cmml" xref="A1.E17.m1.5.5">𝐱</ci></apply><apply id="A1.E17.m1.10.10.1.1.6.3.cmml" xref="A1.E17.m1.10.10.1.1.6.3"><times id="A1.E17.m1.10.10.1.1.6.3.1.cmml" xref="A1.E17.m1.10.10.1.1.6.3.1"></times><ci id="A1.E17.m1.10.10.1.1.6.3.2.cmml" xref="A1.E17.m1.10.10.1.1.6.3.2">𝛿</ci><apply id="A1.E17.m1.10.10.1.1.6.3.3.cmml" xref="A1.E17.m1.10.10.1.1.6.3.3"><log id="A1.E17.m1.10.10.1.1.6.3.3.1.cmml" xref="A1.E17.m1.10.10.1.1.6.3.3.1"></log><ci id="A1.E17.m1.10.10.1.1.6.3.3.2.cmml" xref="A1.E17.m1.10.10.1.1.6.3.3.2">𝑍</ci></apply><list id="A1.E17.m1.10.10.1.1.6.3.4.1.cmml" xref="A1.E17.m1.10.10.1.1.6.3.4.2"><ci id="A1.E17.m1.6.6.cmml" xref="A1.E17.m1.6.6">𝑓</ci><ci id="A1.E17.m1.7.7.cmml" xref="A1.E17.m1.7.7">𝑔</ci></list></apply></apply></apply><apply id="A1.E17.m1.10.10.1.1e.cmml" xref="A1.E17.m1.10.10.1"><eq id="A1.E17.m1.10.10.1.1.7.cmml" xref="A1.E17.m1.10.10.1.1.7"></eq><share href="https://arxiv.org/html/2410.03535v1#A1.E17.m1.10.10.1.1.6.cmml" id="A1.E17.m1.10.10.1.1f.cmml" xref="A1.E17.m1.10.10.1"></share><apply id="A1.E17.m1.10.10.1.1.8.cmml" xref="A1.E17.m1.10.10.1.1.8"><minus id="A1.E17.m1.10.10.1.1.8.1.cmml" xref="A1.E17.m1.10.10.1.1.8.1"></minus><apply id="A1.E17.m1.10.10.1.1.8.2.cmml" xref="A1.E17.m1.10.10.1.1.8.2"><times id="A1.E17.m1.10.10.1.1.8.2.1.cmml" xref="A1.E17.m1.10.10.1.1.8.2.1"></times><apply id="A1.E17.m1.10.10.1.1.8.2.2.cmml" xref="A1.E17.m1.10.10.1.1.8.2.2"><csymbol cd="ambiguous" id="A1.E17.m1.10.10.1.1.8.2.2.1.cmml" xref="A1.E17.m1.10.10.1.1.8.2.2">subscript</csymbol><ci id="A1.E17.m1.10.10.1.1.8.2.2.2.cmml" xref="A1.E17.m1.10.10.1.1.8.2.2.2">𝔼</ci><apply id="A1.E17.m1.10.10.1.1.8.2.2.3.cmml" xref="A1.E17.m1.10.10.1.1.8.2.2.3"><csymbol cd="latexml" id="A1.E17.m1.10.10.1.1.8.2.2.3.1.cmml" xref="A1.E17.m1.10.10.1.1.8.2.2.3.1">similar-to</csymbol><ci id="A1.E17.m1.10.10.1.1.8.2.2.3.2.cmml" xref="A1.E17.m1.10.10.1.1.8.2.2.3.2">𝐱</ci><ci id="A1.E17.m1.10.10.1.1.8.2.2.3.3.cmml" xref="A1.E17.m1.10.10.1.1.8.2.2.3.3">𝑝</ci></apply></apply><ci id="A1.E17.m1.10.10.1.1.8.2.3.cmml" xref="A1.E17.m1.10.10.1.1.8.2.3">𝑔</ci><ci id="A1.E17.m1.8.8.cmml" xref="A1.E17.m1.8.8">𝐱</ci></apply><apply id="A1.E17.m1.10.10.1.1.8.3.cmml" xref="A1.E17.m1.10.10.1.1.8.3"><times id="A1.E17.m1.10.10.1.1.8.3.1.cmml" xref="A1.E17.m1.10.10.1.1.8.3.1"></times><apply id="A1.E17.m1.10.10.1.1.8.3.2.cmml" xref="A1.E17.m1.10.10.1.1.8.3.2"><csymbol cd="ambiguous" id="A1.E17.m1.10.10.1.1.8.3.2.1.cmml" xref="A1.E17.m1.10.10.1.1.8.3.2">subscript</csymbol><ci id="A1.E17.m1.10.10.1.1.8.3.2.2.cmml" xref="A1.E17.m1.10.10.1.1.8.3.2.2">𝔼</ci><apply id="A1.E17.m1.10.10.1.1.8.3.2.3.cmml" xref="A1.E17.m1.10.10.1.1.8.3.2.3"><csymbol cd="latexml" id="A1.E17.m1.10.10.1.1.8.3.2.3.1.cmml" xref="A1.E17.m1.10.10.1.1.8.3.2.3.1">similar-to</csymbol><ci id="A1.E17.m1.10.10.1.1.8.3.2.3.2.cmml" xref="A1.E17.m1.10.10.1.1.8.3.2.3.2">𝐱</ci><apply id="A1.E17.m1.10.10.1.1.8.3.2.3.3.cmml" xref="A1.E17.m1.10.10.1.1.8.3.2.3.3"><csymbol cd="ambiguous" id="A1.E17.m1.10.10.1.1.8.3.2.3.3.1.cmml" xref="A1.E17.m1.10.10.1.1.8.3.2.3.3">subscript</csymbol><ci id="A1.E17.m1.10.10.1.1.8.3.2.3.3.2.cmml" xref="A1.E17.m1.10.10.1.1.8.3.2.3.3.2">𝑞</ci><ci id="A1.E17.m1.10.10.1.1.8.3.2.3.3.3.cmml" xref="A1.E17.m1.10.10.1.1.8.3.2.3.3.3">𝑓</ci></apply></apply></apply><ci id="A1.E17.m1.10.10.1.1.8.3.3.cmml" xref="A1.E17.m1.10.10.1.1.8.3.3">𝑔</ci><ci id="A1.E17.m1.9.9.cmml" xref="A1.E17.m1.9.9">𝐱</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E17.m1.10c">\delta L[f;g]\coloneqq\left.\frac{dL[f+\epsilon g]}{d\epsilon}\right|_{%
\epsilon=0}=\mathbb{E}_{\mathbf{x}\sim p}\,g(\mathbf{x})-\delta\log Z[f;g]=%
\mathbb{E}_{\mathbf{x}\sim p}\,g(\mathbf{x})-\mathbb{E}_{\mathbf{x}\sim q_{f}}%
\,g(\mathbf{x})\,.</annotation><annotation encoding="application/x-llamapun" id="A1.E17.m1.10d">italic_δ italic_L [ italic_f ; italic_g ] ≔ divide start_ARG italic_d italic_L [ italic_f + italic_ϵ italic_g ] end_ARG start_ARG italic_d italic_ϵ end_ARG | start_POSTSUBSCRIPT italic_ϵ = 0 end_POSTSUBSCRIPT = blackboard_E start_POSTSUBSCRIPT bold_x ∼ italic_p end_POSTSUBSCRIPT italic_g ( bold_x ) - italic_δ roman_log italic_Z [ italic_f ; italic_g ] = blackboard_E start_POSTSUBSCRIPT bold_x ∼ italic_p end_POSTSUBSCRIPT italic_g ( bold_x ) - blackboard_E start_POSTSUBSCRIPT bold_x ∼ italic_q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_g ( bold_x ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.p2.5">This is a linear functional of its second argument, <math alttext="g" class="ltx_Math" display="inline" id="A1.p2.2.m1.1"><semantics id="A1.p2.2.m1.1a"><mi id="A1.p2.2.m1.1.1" xref="A1.p2.2.m1.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="A1.p2.2.m1.1b"><ci id="A1.p2.2.m1.1.1.cmml" xref="A1.p2.2.m1.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.2.m1.1c">g</annotation><annotation encoding="application/x-llamapun" id="A1.p2.2.m1.1d">italic_g</annotation></semantics></math>, and can be regarded as a directional derivative of <math alttext="L" class="ltx_Math" display="inline" id="A1.p2.3.m2.1"><semantics id="A1.p2.3.m2.1a"><mi id="A1.p2.3.m2.1.1" xref="A1.p2.3.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="A1.p2.3.m2.1b"><ci id="A1.p2.3.m2.1.1.cmml" xref="A1.p2.3.m2.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.3.m2.1c">L</annotation><annotation encoding="application/x-llamapun" id="A1.p2.3.m2.1d">italic_L</annotation></semantics></math> at <math alttext="f" class="ltx_Math" display="inline" id="A1.p2.4.m3.1"><semantics id="A1.p2.4.m3.1a"><mi id="A1.p2.4.m3.1.1" xref="A1.p2.4.m3.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="A1.p2.4.m3.1b"><ci id="A1.p2.4.m3.1.1.cmml" xref="A1.p2.4.m3.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.4.m3.1c">f</annotation><annotation encoding="application/x-llamapun" id="A1.p2.4.m3.1d">italic_f</annotation></semantics></math> along a variation <math alttext="g" class="ltx_Math" display="inline" id="A1.p2.5.m4.1"><semantics id="A1.p2.5.m4.1a"><mi id="A1.p2.5.m4.1.1" xref="A1.p2.5.m4.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="A1.p2.5.m4.1b"><ci id="A1.p2.5.m4.1.1.cmml" xref="A1.p2.5.m4.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.5.m4.1c">g</annotation><annotation encoding="application/x-llamapun" id="A1.p2.5.m4.1d">italic_g</annotation></semantics></math>.
The last equality comes from the following computation of the first variation of the log-partition function:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A5.EGx2">
<tbody id="A1.E18"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\delta\log Z[f;g]" class="ltx_Math" display="inline" id="A1.E18.m1.2"><semantics id="A1.E18.m1.2a"><mrow id="A1.E18.m1.2.3" xref="A1.E18.m1.2.3.cmml"><mi id="A1.E18.m1.2.3.2" xref="A1.E18.m1.2.3.2.cmml">δ</mi><mo id="A1.E18.m1.2.3.1" lspace="0.167em" xref="A1.E18.m1.2.3.1.cmml">⁢</mo><mrow id="A1.E18.m1.2.3.3" xref="A1.E18.m1.2.3.3.cmml"><mi id="A1.E18.m1.2.3.3.1" xref="A1.E18.m1.2.3.3.1.cmml">log</mi><mo id="A1.E18.m1.2.3.3a" lspace="0.167em" xref="A1.E18.m1.2.3.3.cmml">⁡</mo><mi id="A1.E18.m1.2.3.3.2" xref="A1.E18.m1.2.3.3.2.cmml">Z</mi></mrow><mo id="A1.E18.m1.2.3.1a" xref="A1.E18.m1.2.3.1.cmml">⁢</mo><mrow id="A1.E18.m1.2.3.4.2" xref="A1.E18.m1.2.3.4.1.cmml"><mo id="A1.E18.m1.2.3.4.2.1" stretchy="false" xref="A1.E18.m1.2.3.4.1.cmml">[</mo><mi id="A1.E18.m1.1.1" xref="A1.E18.m1.1.1.cmml">f</mi><mo id="A1.E18.m1.2.3.4.2.2" xref="A1.E18.m1.2.3.4.1.cmml">;</mo><mi id="A1.E18.m1.2.2" xref="A1.E18.m1.2.2.cmml">g</mi><mo id="A1.E18.m1.2.3.4.2.3" stretchy="false" xref="A1.E18.m1.2.3.4.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E18.m1.2b"><apply id="A1.E18.m1.2.3.cmml" xref="A1.E18.m1.2.3"><times id="A1.E18.m1.2.3.1.cmml" xref="A1.E18.m1.2.3.1"></times><ci id="A1.E18.m1.2.3.2.cmml" xref="A1.E18.m1.2.3.2">𝛿</ci><apply id="A1.E18.m1.2.3.3.cmml" xref="A1.E18.m1.2.3.3"><log id="A1.E18.m1.2.3.3.1.cmml" xref="A1.E18.m1.2.3.3.1"></log><ci id="A1.E18.m1.2.3.3.2.cmml" xref="A1.E18.m1.2.3.3.2">𝑍</ci></apply><list id="A1.E18.m1.2.3.4.1.cmml" xref="A1.E18.m1.2.3.4.2"><ci id="A1.E18.m1.1.1.cmml" xref="A1.E18.m1.1.1">𝑓</ci><ci id="A1.E18.m1.2.2.cmml" xref="A1.E18.m1.2.2">𝑔</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E18.m1.2c">\displaystyle\delta\log Z[f;g]</annotation><annotation encoding="application/x-llamapun" id="A1.E18.m1.2d">italic_δ roman_log italic_Z [ italic_f ; italic_g ]</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{\delta Z[f;g]}{Z[f]}" class="ltx_Math" display="inline" id="A1.E18.m2.3"><semantics id="A1.E18.m2.3a"><mrow id="A1.E18.m2.3.4" xref="A1.E18.m2.3.4.cmml"><mi id="A1.E18.m2.3.4.2" xref="A1.E18.m2.3.4.2.cmml"></mi><mo id="A1.E18.m2.3.4.1" xref="A1.E18.m2.3.4.1.cmml">=</mo><mstyle displaystyle="true" id="A1.E18.m2.3.3" xref="A1.E18.m2.3.3.cmml"><mfrac id="A1.E18.m2.3.3a" xref="A1.E18.m2.3.3.cmml"><mrow id="A1.E18.m2.2.2.2" xref="A1.E18.m2.2.2.2.cmml"><mi id="A1.E18.m2.2.2.2.4" xref="A1.E18.m2.2.2.2.4.cmml">δ</mi><mo id="A1.E18.m2.2.2.2.3" xref="A1.E18.m2.2.2.2.3.cmml">⁢</mo><mi id="A1.E18.m2.2.2.2.5" xref="A1.E18.m2.2.2.2.5.cmml">Z</mi><mo id="A1.E18.m2.2.2.2.3a" xref="A1.E18.m2.2.2.2.3.cmml">⁢</mo><mrow id="A1.E18.m2.2.2.2.6.2" xref="A1.E18.m2.2.2.2.6.1.cmml"><mo id="A1.E18.m2.2.2.2.6.2.1" stretchy="false" xref="A1.E18.m2.2.2.2.6.1.cmml">[</mo><mi id="A1.E18.m2.1.1.1.1" xref="A1.E18.m2.1.1.1.1.cmml">f</mi><mo id="A1.E18.m2.2.2.2.6.2.2" xref="A1.E18.m2.2.2.2.6.1.cmml">;</mo><mi id="A1.E18.m2.2.2.2.2" xref="A1.E18.m2.2.2.2.2.cmml">g</mi><mo id="A1.E18.m2.2.2.2.6.2.3" stretchy="false" xref="A1.E18.m2.2.2.2.6.1.cmml">]</mo></mrow></mrow><mrow id="A1.E18.m2.3.3.3" xref="A1.E18.m2.3.3.3.cmml"><mi id="A1.E18.m2.3.3.3.3" xref="A1.E18.m2.3.3.3.3.cmml">Z</mi><mo id="A1.E18.m2.3.3.3.2" xref="A1.E18.m2.3.3.3.2.cmml">⁢</mo><mrow id="A1.E18.m2.3.3.3.4.2" xref="A1.E18.m2.3.3.3.4.1.cmml"><mo id="A1.E18.m2.3.3.3.4.2.1" stretchy="false" xref="A1.E18.m2.3.3.3.4.1.1.cmml">[</mo><mi id="A1.E18.m2.3.3.3.1" xref="A1.E18.m2.3.3.3.1.cmml">f</mi><mo id="A1.E18.m2.3.3.3.4.2.2" stretchy="false" xref="A1.E18.m2.3.3.3.4.1.1.cmml">]</mo></mrow></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="A1.E18.m2.3b"><apply id="A1.E18.m2.3.4.cmml" xref="A1.E18.m2.3.4"><eq id="A1.E18.m2.3.4.1.cmml" xref="A1.E18.m2.3.4.1"></eq><csymbol cd="latexml" id="A1.E18.m2.3.4.2.cmml" xref="A1.E18.m2.3.4.2">absent</csymbol><apply id="A1.E18.m2.3.3.cmml" xref="A1.E18.m2.3.3"><divide id="A1.E18.m2.3.3.4.cmml" xref="A1.E18.m2.3.3"></divide><apply id="A1.E18.m2.2.2.2.cmml" xref="A1.E18.m2.2.2.2"><times id="A1.E18.m2.2.2.2.3.cmml" xref="A1.E18.m2.2.2.2.3"></times><ci id="A1.E18.m2.2.2.2.4.cmml" xref="A1.E18.m2.2.2.2.4">𝛿</ci><ci id="A1.E18.m2.2.2.2.5.cmml" xref="A1.E18.m2.2.2.2.5">𝑍</ci><list id="A1.E18.m2.2.2.2.6.1.cmml" xref="A1.E18.m2.2.2.2.6.2"><ci id="A1.E18.m2.1.1.1.1.cmml" xref="A1.E18.m2.1.1.1.1">𝑓</ci><ci id="A1.E18.m2.2.2.2.2.cmml" xref="A1.E18.m2.2.2.2.2">𝑔</ci></list></apply><apply id="A1.E18.m2.3.3.3.cmml" xref="A1.E18.m2.3.3.3"><times id="A1.E18.m2.3.3.3.2.cmml" xref="A1.E18.m2.3.3.3.2"></times><ci id="A1.E18.m2.3.3.3.3.cmml" xref="A1.E18.m2.3.3.3.3">𝑍</ci><apply id="A1.E18.m2.3.3.3.4.1.cmml" xref="A1.E18.m2.3.3.3.4.2"><csymbol cd="latexml" id="A1.E18.m2.3.3.3.4.1.1.cmml" xref="A1.E18.m2.3.3.3.4.2.1">delimited-[]</csymbol><ci id="A1.E18.m2.3.3.3.1.cmml" xref="A1.E18.m2.3.3.3.1">𝑓</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E18.m2.3c">\displaystyle=\frac{\delta Z[f;g]}{Z[f]}</annotation><annotation encoding="application/x-llamapun" id="A1.E18.m2.3d">= divide start_ARG italic_δ italic_Z [ italic_f ; italic_g ] end_ARG start_ARG italic_Z [ italic_f ] end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(18)</span></td>
</tr></tbody>
<tbody id="A1.E19"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{1}{Z[f]}\sum_{\mathbf{x}}\exp^{\prime}\left(f(\mathbf{x})%
\right)g(\mathbf{x})" class="ltx_Math" display="inline" id="A1.E19.m1.5"><semantics id="A1.E19.m1.5a"><mrow id="A1.E19.m1.5.5" xref="A1.E19.m1.5.5.cmml"><mi id="A1.E19.m1.5.5.4" xref="A1.E19.m1.5.5.4.cmml"></mi><mo id="A1.E19.m1.5.5.3" xref="A1.E19.m1.5.5.3.cmml">=</mo><mrow id="A1.E19.m1.5.5.2" xref="A1.E19.m1.5.5.2.cmml"><mstyle displaystyle="true" id="A1.E19.m1.1.1" xref="A1.E19.m1.1.1.cmml"><mfrac id="A1.E19.m1.1.1a" xref="A1.E19.m1.1.1.cmml"><mn id="A1.E19.m1.1.1.3" xref="A1.E19.m1.1.1.3.cmml">1</mn><mrow id="A1.E19.m1.1.1.1" xref="A1.E19.m1.1.1.1.cmml"><mi id="A1.E19.m1.1.1.1.3" xref="A1.E19.m1.1.1.1.3.cmml">Z</mi><mo id="A1.E19.m1.1.1.1.2" xref="A1.E19.m1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E19.m1.1.1.1.4.2" xref="A1.E19.m1.1.1.1.4.1.cmml"><mo id="A1.E19.m1.1.1.1.4.2.1" stretchy="false" xref="A1.E19.m1.1.1.1.4.1.1.cmml">[</mo><mi id="A1.E19.m1.1.1.1.1" xref="A1.E19.m1.1.1.1.1.cmml">f</mi><mo id="A1.E19.m1.1.1.1.4.2.2" stretchy="false" xref="A1.E19.m1.1.1.1.4.1.1.cmml">]</mo></mrow></mrow></mfrac></mstyle><mo id="A1.E19.m1.5.5.2.3" xref="A1.E19.m1.5.5.2.3.cmml">⁢</mo><mrow id="A1.E19.m1.5.5.2.2" xref="A1.E19.m1.5.5.2.2.cmml"><mstyle displaystyle="true" id="A1.E19.m1.5.5.2.2.3" xref="A1.E19.m1.5.5.2.2.3.cmml"><munder id="A1.E19.m1.5.5.2.2.3a" xref="A1.E19.m1.5.5.2.2.3.cmml"><mo id="A1.E19.m1.5.5.2.2.3.2" movablelimits="false" xref="A1.E19.m1.5.5.2.2.3.2.cmml">∑</mo><mi id="A1.E19.m1.5.5.2.2.3.3" xref="A1.E19.m1.5.5.2.2.3.3.cmml">𝐱</mi></munder></mstyle><mrow id="A1.E19.m1.5.5.2.2.2" xref="A1.E19.m1.5.5.2.2.2.cmml"><mrow id="A1.E19.m1.5.5.2.2.2.2.2" xref="A1.E19.m1.5.5.2.2.2.2.3.cmml"><msup id="A1.E19.m1.4.4.1.1.1.1.1.1" xref="A1.E19.m1.4.4.1.1.1.1.1.1.cmml"><mi id="A1.E19.m1.4.4.1.1.1.1.1.1.2" xref="A1.E19.m1.4.4.1.1.1.1.1.1.2.cmml">exp</mi><mo id="A1.E19.m1.4.4.1.1.1.1.1.1.3" xref="A1.E19.m1.4.4.1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="A1.E19.m1.5.5.2.2.2.2.2a" xref="A1.E19.m1.5.5.2.2.2.2.3.cmml">⁡</mo><mrow id="A1.E19.m1.5.5.2.2.2.2.2.2" xref="A1.E19.m1.5.5.2.2.2.2.3.cmml"><mo id="A1.E19.m1.5.5.2.2.2.2.2.2.2" xref="A1.E19.m1.5.5.2.2.2.2.3.cmml">(</mo><mrow id="A1.E19.m1.5.5.2.2.2.2.2.2.1" xref="A1.E19.m1.5.5.2.2.2.2.2.2.1.cmml"><mi id="A1.E19.m1.5.5.2.2.2.2.2.2.1.2" xref="A1.E19.m1.5.5.2.2.2.2.2.2.1.2.cmml">f</mi><mo id="A1.E19.m1.5.5.2.2.2.2.2.2.1.1" xref="A1.E19.m1.5.5.2.2.2.2.2.2.1.1.cmml">⁢</mo><mrow id="A1.E19.m1.5.5.2.2.2.2.2.2.1.3.2" xref="A1.E19.m1.5.5.2.2.2.2.2.2.1.cmml"><mo id="A1.E19.m1.5.5.2.2.2.2.2.2.1.3.2.1" stretchy="false" xref="A1.E19.m1.5.5.2.2.2.2.2.2.1.cmml">(</mo><mi id="A1.E19.m1.2.2" xref="A1.E19.m1.2.2.cmml">𝐱</mi><mo id="A1.E19.m1.5.5.2.2.2.2.2.2.1.3.2.2" stretchy="false" xref="A1.E19.m1.5.5.2.2.2.2.2.2.1.cmml">)</mo></mrow></mrow><mo id="A1.E19.m1.5.5.2.2.2.2.2.2.3" xref="A1.E19.m1.5.5.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="A1.E19.m1.5.5.2.2.2.3" xref="A1.E19.m1.5.5.2.2.2.3.cmml">⁢</mo><mi id="A1.E19.m1.5.5.2.2.2.4" xref="A1.E19.m1.5.5.2.2.2.4.cmml">g</mi><mo id="A1.E19.m1.5.5.2.2.2.3a" xref="A1.E19.m1.5.5.2.2.2.3.cmml">⁢</mo><mrow id="A1.E19.m1.5.5.2.2.2.5.2" xref="A1.E19.m1.5.5.2.2.2.cmml"><mo id="A1.E19.m1.5.5.2.2.2.5.2.1" stretchy="false" xref="A1.E19.m1.5.5.2.2.2.cmml">(</mo><mi id="A1.E19.m1.3.3" xref="A1.E19.m1.3.3.cmml">𝐱</mi><mo id="A1.E19.m1.5.5.2.2.2.5.2.2" stretchy="false" xref="A1.E19.m1.5.5.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E19.m1.5b"><apply id="A1.E19.m1.5.5.cmml" xref="A1.E19.m1.5.5"><eq id="A1.E19.m1.5.5.3.cmml" xref="A1.E19.m1.5.5.3"></eq><csymbol cd="latexml" id="A1.E19.m1.5.5.4.cmml" xref="A1.E19.m1.5.5.4">absent</csymbol><apply id="A1.E19.m1.5.5.2.cmml" xref="A1.E19.m1.5.5.2"><times id="A1.E19.m1.5.5.2.3.cmml" xref="A1.E19.m1.5.5.2.3"></times><apply id="A1.E19.m1.1.1.cmml" xref="A1.E19.m1.1.1"><divide id="A1.E19.m1.1.1.2.cmml" xref="A1.E19.m1.1.1"></divide><cn id="A1.E19.m1.1.1.3.cmml" type="integer" xref="A1.E19.m1.1.1.3">1</cn><apply id="A1.E19.m1.1.1.1.cmml" xref="A1.E19.m1.1.1.1"><times id="A1.E19.m1.1.1.1.2.cmml" xref="A1.E19.m1.1.1.1.2"></times><ci id="A1.E19.m1.1.1.1.3.cmml" xref="A1.E19.m1.1.1.1.3">𝑍</ci><apply id="A1.E19.m1.1.1.1.4.1.cmml" xref="A1.E19.m1.1.1.1.4.2"><csymbol cd="latexml" id="A1.E19.m1.1.1.1.4.1.1.cmml" xref="A1.E19.m1.1.1.1.4.2.1">delimited-[]</csymbol><ci id="A1.E19.m1.1.1.1.1.cmml" xref="A1.E19.m1.1.1.1.1">𝑓</ci></apply></apply></apply><apply id="A1.E19.m1.5.5.2.2.cmml" xref="A1.E19.m1.5.5.2.2"><apply id="A1.E19.m1.5.5.2.2.3.cmml" xref="A1.E19.m1.5.5.2.2.3"><csymbol cd="ambiguous" id="A1.E19.m1.5.5.2.2.3.1.cmml" xref="A1.E19.m1.5.5.2.2.3">subscript</csymbol><sum id="A1.E19.m1.5.5.2.2.3.2.cmml" xref="A1.E19.m1.5.5.2.2.3.2"></sum><ci id="A1.E19.m1.5.5.2.2.3.3.cmml" xref="A1.E19.m1.5.5.2.2.3.3">𝐱</ci></apply><apply id="A1.E19.m1.5.5.2.2.2.cmml" xref="A1.E19.m1.5.5.2.2.2"><times id="A1.E19.m1.5.5.2.2.2.3.cmml" xref="A1.E19.m1.5.5.2.2.2.3"></times><apply id="A1.E19.m1.5.5.2.2.2.2.3.cmml" xref="A1.E19.m1.5.5.2.2.2.2.2"><apply id="A1.E19.m1.4.4.1.1.1.1.1.1.cmml" xref="A1.E19.m1.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E19.m1.4.4.1.1.1.1.1.1.1.cmml" xref="A1.E19.m1.4.4.1.1.1.1.1.1">superscript</csymbol><exp id="A1.E19.m1.4.4.1.1.1.1.1.1.2.cmml" xref="A1.E19.m1.4.4.1.1.1.1.1.1.2"></exp><ci id="A1.E19.m1.4.4.1.1.1.1.1.1.3.cmml" xref="A1.E19.m1.4.4.1.1.1.1.1.1.3">′</ci></apply><apply id="A1.E19.m1.5.5.2.2.2.2.2.2.1.cmml" xref="A1.E19.m1.5.5.2.2.2.2.2.2.1"><times id="A1.E19.m1.5.5.2.2.2.2.2.2.1.1.cmml" xref="A1.E19.m1.5.5.2.2.2.2.2.2.1.1"></times><ci id="A1.E19.m1.5.5.2.2.2.2.2.2.1.2.cmml" xref="A1.E19.m1.5.5.2.2.2.2.2.2.1.2">𝑓</ci><ci id="A1.E19.m1.2.2.cmml" xref="A1.E19.m1.2.2">𝐱</ci></apply></apply><ci id="A1.E19.m1.5.5.2.2.2.4.cmml" xref="A1.E19.m1.5.5.2.2.2.4">𝑔</ci><ci id="A1.E19.m1.3.3.cmml" xref="A1.E19.m1.3.3">𝐱</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E19.m1.5c">\displaystyle=\frac{1}{Z[f]}\sum_{\mathbf{x}}\exp^{\prime}\left(f(\mathbf{x})%
\right)g(\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="A1.E19.m1.5d">= divide start_ARG 1 end_ARG start_ARG italic_Z [ italic_f ] end_ARG ∑ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT roman_exp start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_f ( bold_x ) ) italic_g ( bold_x )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(19)</span></td>
</tr></tbody>
<tbody id="A1.E20"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sum_{\mathbf{x}}\frac{\exp\left(f(\mathbf{x})\right)}{Z[f]}g(%
\mathbf{x})" class="ltx_Math" display="inline" id="A1.E20.m1.5"><semantics id="A1.E20.m1.5a"><mrow id="A1.E20.m1.5.6" xref="A1.E20.m1.5.6.cmml"><mi id="A1.E20.m1.5.6.2" xref="A1.E20.m1.5.6.2.cmml"></mi><mo id="A1.E20.m1.5.6.1" xref="A1.E20.m1.5.6.1.cmml">=</mo><mrow id="A1.E20.m1.5.6.3" xref="A1.E20.m1.5.6.3.cmml"><mstyle displaystyle="true" id="A1.E20.m1.5.6.3.1" xref="A1.E20.m1.5.6.3.1.cmml"><munder id="A1.E20.m1.5.6.3.1a" xref="A1.E20.m1.5.6.3.1.cmml"><mo id="A1.E20.m1.5.6.3.1.2" movablelimits="false" xref="A1.E20.m1.5.6.3.1.2.cmml">∑</mo><mi id="A1.E20.m1.5.6.3.1.3" xref="A1.E20.m1.5.6.3.1.3.cmml">𝐱</mi></munder></mstyle><mrow id="A1.E20.m1.5.6.3.2" xref="A1.E20.m1.5.6.3.2.cmml"><mstyle displaystyle="true" id="A1.E20.m1.4.4" xref="A1.E20.m1.4.4.cmml"><mfrac id="A1.E20.m1.4.4a" xref="A1.E20.m1.4.4.cmml"><mrow id="A1.E20.m1.3.3.3.3" xref="A1.E20.m1.3.3.3.4.cmml"><mi id="A1.E20.m1.2.2.2.2" xref="A1.E20.m1.2.2.2.2.cmml">exp</mi><mo id="A1.E20.m1.3.3.3.3a" xref="A1.E20.m1.3.3.3.4.cmml">⁡</mo><mrow id="A1.E20.m1.3.3.3.3.1" xref="A1.E20.m1.3.3.3.4.cmml"><mo id="A1.E20.m1.3.3.3.3.1.2" xref="A1.E20.m1.3.3.3.4.cmml">(</mo><mrow id="A1.E20.m1.3.3.3.3.1.1" xref="A1.E20.m1.3.3.3.3.1.1.cmml"><mi id="A1.E20.m1.3.3.3.3.1.1.2" xref="A1.E20.m1.3.3.3.3.1.1.2.cmml">f</mi><mo id="A1.E20.m1.3.3.3.3.1.1.1" xref="A1.E20.m1.3.3.3.3.1.1.1.cmml">⁢</mo><mrow id="A1.E20.m1.3.3.3.3.1.1.3.2" xref="A1.E20.m1.3.3.3.3.1.1.cmml"><mo id="A1.E20.m1.3.3.3.3.1.1.3.2.1" stretchy="false" xref="A1.E20.m1.3.3.3.3.1.1.cmml">(</mo><mi id="A1.E20.m1.1.1.1.1" xref="A1.E20.m1.1.1.1.1.cmml">𝐱</mi><mo id="A1.E20.m1.3.3.3.3.1.1.3.2.2" stretchy="false" xref="A1.E20.m1.3.3.3.3.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E20.m1.3.3.3.3.1.3" xref="A1.E20.m1.3.3.3.4.cmml">)</mo></mrow></mrow><mrow id="A1.E20.m1.4.4.4" xref="A1.E20.m1.4.4.4.cmml"><mi id="A1.E20.m1.4.4.4.3" xref="A1.E20.m1.4.4.4.3.cmml">Z</mi><mo id="A1.E20.m1.4.4.4.2" xref="A1.E20.m1.4.4.4.2.cmml">⁢</mo><mrow id="A1.E20.m1.4.4.4.4.2" xref="A1.E20.m1.4.4.4.4.1.cmml"><mo id="A1.E20.m1.4.4.4.4.2.1" stretchy="false" xref="A1.E20.m1.4.4.4.4.1.1.cmml">[</mo><mi id="A1.E20.m1.4.4.4.1" xref="A1.E20.m1.4.4.4.1.cmml">f</mi><mo id="A1.E20.m1.4.4.4.4.2.2" stretchy="false" xref="A1.E20.m1.4.4.4.4.1.1.cmml">]</mo></mrow></mrow></mfrac></mstyle><mo id="A1.E20.m1.5.6.3.2.1" xref="A1.E20.m1.5.6.3.2.1.cmml">⁢</mo><mi id="A1.E20.m1.5.6.3.2.2" xref="A1.E20.m1.5.6.3.2.2.cmml">g</mi><mo id="A1.E20.m1.5.6.3.2.1a" xref="A1.E20.m1.5.6.3.2.1.cmml">⁢</mo><mrow id="A1.E20.m1.5.6.3.2.3.2" xref="A1.E20.m1.5.6.3.2.cmml"><mo id="A1.E20.m1.5.6.3.2.3.2.1" stretchy="false" xref="A1.E20.m1.5.6.3.2.cmml">(</mo><mi id="A1.E20.m1.5.5" xref="A1.E20.m1.5.5.cmml">𝐱</mi><mo id="A1.E20.m1.5.6.3.2.3.2.2" stretchy="false" xref="A1.E20.m1.5.6.3.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E20.m1.5b"><apply id="A1.E20.m1.5.6.cmml" xref="A1.E20.m1.5.6"><eq id="A1.E20.m1.5.6.1.cmml" xref="A1.E20.m1.5.6.1"></eq><csymbol cd="latexml" id="A1.E20.m1.5.6.2.cmml" xref="A1.E20.m1.5.6.2">absent</csymbol><apply id="A1.E20.m1.5.6.3.cmml" xref="A1.E20.m1.5.6.3"><apply id="A1.E20.m1.5.6.3.1.cmml" xref="A1.E20.m1.5.6.3.1"><csymbol cd="ambiguous" id="A1.E20.m1.5.6.3.1.1.cmml" xref="A1.E20.m1.5.6.3.1">subscript</csymbol><sum id="A1.E20.m1.5.6.3.1.2.cmml" xref="A1.E20.m1.5.6.3.1.2"></sum><ci id="A1.E20.m1.5.6.3.1.3.cmml" xref="A1.E20.m1.5.6.3.1.3">𝐱</ci></apply><apply id="A1.E20.m1.5.6.3.2.cmml" xref="A1.E20.m1.5.6.3.2"><times id="A1.E20.m1.5.6.3.2.1.cmml" xref="A1.E20.m1.5.6.3.2.1"></times><apply id="A1.E20.m1.4.4.cmml" xref="A1.E20.m1.4.4"><divide id="A1.E20.m1.4.4.5.cmml" xref="A1.E20.m1.4.4"></divide><apply id="A1.E20.m1.3.3.3.4.cmml" xref="A1.E20.m1.3.3.3.3"><exp id="A1.E20.m1.2.2.2.2.cmml" xref="A1.E20.m1.2.2.2.2"></exp><apply id="A1.E20.m1.3.3.3.3.1.1.cmml" xref="A1.E20.m1.3.3.3.3.1.1"><times id="A1.E20.m1.3.3.3.3.1.1.1.cmml" xref="A1.E20.m1.3.3.3.3.1.1.1"></times><ci id="A1.E20.m1.3.3.3.3.1.1.2.cmml" xref="A1.E20.m1.3.3.3.3.1.1.2">𝑓</ci><ci id="A1.E20.m1.1.1.1.1.cmml" xref="A1.E20.m1.1.1.1.1">𝐱</ci></apply></apply><apply id="A1.E20.m1.4.4.4.cmml" xref="A1.E20.m1.4.4.4"><times id="A1.E20.m1.4.4.4.2.cmml" xref="A1.E20.m1.4.4.4.2"></times><ci id="A1.E20.m1.4.4.4.3.cmml" xref="A1.E20.m1.4.4.4.3">𝑍</ci><apply id="A1.E20.m1.4.4.4.4.1.cmml" xref="A1.E20.m1.4.4.4.4.2"><csymbol cd="latexml" id="A1.E20.m1.4.4.4.4.1.1.cmml" xref="A1.E20.m1.4.4.4.4.2.1">delimited-[]</csymbol><ci id="A1.E20.m1.4.4.4.1.cmml" xref="A1.E20.m1.4.4.4.1">𝑓</ci></apply></apply></apply><ci id="A1.E20.m1.5.6.3.2.2.cmml" xref="A1.E20.m1.5.6.3.2.2">𝑔</ci><ci id="A1.E20.m1.5.5.cmml" xref="A1.E20.m1.5.5">𝐱</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E20.m1.5c">\displaystyle=\sum_{\mathbf{x}}\frac{\exp\left(f(\mathbf{x})\right)}{Z[f]}g(%
\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="A1.E20.m1.5d">= ∑ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT divide start_ARG roman_exp ( italic_f ( bold_x ) ) end_ARG start_ARG italic_Z [ italic_f ] end_ARG italic_g ( bold_x )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(20)</span></td>
</tr></tbody>
<tbody id="A1.E21"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbb{E}_{\mathbf{x}\sim q_{f}}\,g(\mathbf{x})\,." class="ltx_Math" display="inline" id="A1.E21.m1.2"><semantics id="A1.E21.m1.2a"><mrow id="A1.E21.m1.2.2.1" xref="A1.E21.m1.2.2.1.1.cmml"><mrow id="A1.E21.m1.2.2.1.1" xref="A1.E21.m1.2.2.1.1.cmml"><mi id="A1.E21.m1.2.2.1.1.2" xref="A1.E21.m1.2.2.1.1.2.cmml"></mi><mo id="A1.E21.m1.2.2.1.1.1" xref="A1.E21.m1.2.2.1.1.1.cmml">=</mo><mrow id="A1.E21.m1.2.2.1.1.3" xref="A1.E21.m1.2.2.1.1.3.cmml"><msub id="A1.E21.m1.2.2.1.1.3.2" xref="A1.E21.m1.2.2.1.1.3.2.cmml"><mi id="A1.E21.m1.2.2.1.1.3.2.2" xref="A1.E21.m1.2.2.1.1.3.2.2.cmml">𝔼</mi><mrow id="A1.E21.m1.2.2.1.1.3.2.3" xref="A1.E21.m1.2.2.1.1.3.2.3.cmml"><mi id="A1.E21.m1.2.2.1.1.3.2.3.2" xref="A1.E21.m1.2.2.1.1.3.2.3.2.cmml">𝐱</mi><mo id="A1.E21.m1.2.2.1.1.3.2.3.1" xref="A1.E21.m1.2.2.1.1.3.2.3.1.cmml">∼</mo><msub id="A1.E21.m1.2.2.1.1.3.2.3.3" xref="A1.E21.m1.2.2.1.1.3.2.3.3.cmml"><mi id="A1.E21.m1.2.2.1.1.3.2.3.3.2" xref="A1.E21.m1.2.2.1.1.3.2.3.3.2.cmml">q</mi><mi id="A1.E21.m1.2.2.1.1.3.2.3.3.3" xref="A1.E21.m1.2.2.1.1.3.2.3.3.3.cmml">f</mi></msub></mrow></msub><mo id="A1.E21.m1.2.2.1.1.3.1" xref="A1.E21.m1.2.2.1.1.3.1.cmml">⁢</mo><mi id="A1.E21.m1.2.2.1.1.3.3" xref="A1.E21.m1.2.2.1.1.3.3.cmml">g</mi><mo id="A1.E21.m1.2.2.1.1.3.1a" xref="A1.E21.m1.2.2.1.1.3.1.cmml">⁢</mo><mrow id="A1.E21.m1.2.2.1.1.3.4.2" xref="A1.E21.m1.2.2.1.1.3.cmml"><mo id="A1.E21.m1.2.2.1.1.3.4.2.1" stretchy="false" xref="A1.E21.m1.2.2.1.1.3.cmml">(</mo><mi id="A1.E21.m1.1.1" xref="A1.E21.m1.1.1.cmml">𝐱</mi><mo id="A1.E21.m1.2.2.1.1.3.4.2.2" stretchy="false" xref="A1.E21.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E21.m1.2.2.1.2" lspace="0.170em" xref="A1.E21.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E21.m1.2b"><apply id="A1.E21.m1.2.2.1.1.cmml" xref="A1.E21.m1.2.2.1"><eq id="A1.E21.m1.2.2.1.1.1.cmml" xref="A1.E21.m1.2.2.1.1.1"></eq><csymbol cd="latexml" id="A1.E21.m1.2.2.1.1.2.cmml" xref="A1.E21.m1.2.2.1.1.2">absent</csymbol><apply id="A1.E21.m1.2.2.1.1.3.cmml" xref="A1.E21.m1.2.2.1.1.3"><times id="A1.E21.m1.2.2.1.1.3.1.cmml" xref="A1.E21.m1.2.2.1.1.3.1"></times><apply id="A1.E21.m1.2.2.1.1.3.2.cmml" xref="A1.E21.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="A1.E21.m1.2.2.1.1.3.2.1.cmml" xref="A1.E21.m1.2.2.1.1.3.2">subscript</csymbol><ci id="A1.E21.m1.2.2.1.1.3.2.2.cmml" xref="A1.E21.m1.2.2.1.1.3.2.2">𝔼</ci><apply id="A1.E21.m1.2.2.1.1.3.2.3.cmml" xref="A1.E21.m1.2.2.1.1.3.2.3"><csymbol cd="latexml" id="A1.E21.m1.2.2.1.1.3.2.3.1.cmml" xref="A1.E21.m1.2.2.1.1.3.2.3.1">similar-to</csymbol><ci id="A1.E21.m1.2.2.1.1.3.2.3.2.cmml" xref="A1.E21.m1.2.2.1.1.3.2.3.2">𝐱</ci><apply id="A1.E21.m1.2.2.1.1.3.2.3.3.cmml" xref="A1.E21.m1.2.2.1.1.3.2.3.3"><csymbol cd="ambiguous" id="A1.E21.m1.2.2.1.1.3.2.3.3.1.cmml" xref="A1.E21.m1.2.2.1.1.3.2.3.3">subscript</csymbol><ci id="A1.E21.m1.2.2.1.1.3.2.3.3.2.cmml" xref="A1.E21.m1.2.2.1.1.3.2.3.3.2">𝑞</ci><ci id="A1.E21.m1.2.2.1.1.3.2.3.3.3.cmml" xref="A1.E21.m1.2.2.1.1.3.2.3.3.3">𝑓</ci></apply></apply></apply><ci id="A1.E21.m1.2.2.1.1.3.3.cmml" xref="A1.E21.m1.2.2.1.1.3.3">𝑔</ci><ci id="A1.E21.m1.1.1.cmml" xref="A1.E21.m1.1.1">𝐱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E21.m1.2c">\displaystyle=\mathbb{E}_{\mathbf{x}\sim q_{f}}\,g(\mathbf{x})\,.</annotation><annotation encoding="application/x-llamapun" id="A1.E21.m1.2d">= blackboard_E start_POSTSUBSCRIPT bold_x ∼ italic_q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_g ( bold_x ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(21)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A1.p3">
<p class="ltx_p" id="A1.p3.4">Analogous to a Hessian, we can differentiate Equation <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A1.E17" title="In Appendix A Theory ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">17</span></a> again along a second independent variation <math alttext="h" class="ltx_Math" display="inline" id="A1.p3.1.m1.1"><semantics id="A1.p3.1.m1.1a"><mi id="A1.p3.1.m1.1.1" xref="A1.p3.1.m1.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="A1.p3.1.m1.1b"><ci id="A1.p3.1.m1.1.1.cmml" xref="A1.p3.1.m1.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.1.m1.1c">h</annotation><annotation encoding="application/x-llamapun" id="A1.p3.1.m1.1d">italic_h</annotation></semantics></math> of <math alttext="f" class="ltx_Math" display="inline" id="A1.p3.2.m2.1"><semantics id="A1.p3.2.m2.1a"><mi id="A1.p3.2.m2.1.1" xref="A1.p3.2.m2.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="A1.p3.2.m2.1b"><ci id="A1.p3.2.m2.1.1.cmml" xref="A1.p3.2.m2.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.2.m2.1c">f</annotation><annotation encoding="application/x-llamapun" id="A1.p3.2.m2.1d">italic_f</annotation></semantics></math> yielding a symmetric bilinear functional which we will write as <math alttext="\delta^{2}L[f;g,h]" class="ltx_Math" display="inline" id="A1.p3.3.m3.3"><semantics id="A1.p3.3.m3.3a"><mrow id="A1.p3.3.m3.3.4" xref="A1.p3.3.m3.3.4.cmml"><msup id="A1.p3.3.m3.3.4.2" xref="A1.p3.3.m3.3.4.2.cmml"><mi id="A1.p3.3.m3.3.4.2.2" xref="A1.p3.3.m3.3.4.2.2.cmml">δ</mi><mn id="A1.p3.3.m3.3.4.2.3" xref="A1.p3.3.m3.3.4.2.3.cmml">2</mn></msup><mo id="A1.p3.3.m3.3.4.1" xref="A1.p3.3.m3.3.4.1.cmml">⁢</mo><mi id="A1.p3.3.m3.3.4.3" xref="A1.p3.3.m3.3.4.3.cmml">L</mi><mo id="A1.p3.3.m3.3.4.1a" xref="A1.p3.3.m3.3.4.1.cmml">⁢</mo><mrow id="A1.p3.3.m3.3.4.4.2" xref="A1.p3.3.m3.3.4.4.1.cmml"><mo id="A1.p3.3.m3.3.4.4.2.1" stretchy="false" xref="A1.p3.3.m3.3.4.4.1.cmml">[</mo><mi id="A1.p3.3.m3.1.1" xref="A1.p3.3.m3.1.1.cmml">f</mi><mo id="A1.p3.3.m3.3.4.4.2.2" xref="A1.p3.3.m3.3.4.4.1.cmml">;</mo><mi id="A1.p3.3.m3.2.2" xref="A1.p3.3.m3.2.2.cmml">g</mi><mo id="A1.p3.3.m3.3.4.4.2.3" xref="A1.p3.3.m3.3.4.4.1.cmml">,</mo><mi id="A1.p3.3.m3.3.3" xref="A1.p3.3.m3.3.3.cmml">h</mi><mo id="A1.p3.3.m3.3.4.4.2.4" stretchy="false" xref="A1.p3.3.m3.3.4.4.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.p3.3.m3.3b"><apply id="A1.p3.3.m3.3.4.cmml" xref="A1.p3.3.m3.3.4"><times id="A1.p3.3.m3.3.4.1.cmml" xref="A1.p3.3.m3.3.4.1"></times><apply id="A1.p3.3.m3.3.4.2.cmml" xref="A1.p3.3.m3.3.4.2"><csymbol cd="ambiguous" id="A1.p3.3.m3.3.4.2.1.cmml" xref="A1.p3.3.m3.3.4.2">superscript</csymbol><ci id="A1.p3.3.m3.3.4.2.2.cmml" xref="A1.p3.3.m3.3.4.2.2">𝛿</ci><cn id="A1.p3.3.m3.3.4.2.3.cmml" type="integer" xref="A1.p3.3.m3.3.4.2.3">2</cn></apply><ci id="A1.p3.3.m3.3.4.3.cmml" xref="A1.p3.3.m3.3.4.3">𝐿</ci><list id="A1.p3.3.m3.3.4.4.1.cmml" xref="A1.p3.3.m3.3.4.4.2"><ci id="A1.p3.3.m3.1.1.cmml" xref="A1.p3.3.m3.1.1">𝑓</ci><ci id="A1.p3.3.m3.2.2.cmml" xref="A1.p3.3.m3.2.2">𝑔</ci><ci id="A1.p3.3.m3.3.3.cmml" xref="A1.p3.3.m3.3.3">ℎ</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.3.m3.3c">\delta^{2}L[f;g,h]</annotation><annotation encoding="application/x-llamapun" id="A1.p3.3.m3.3d">italic_δ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_L [ italic_f ; italic_g , italic_h ]</annotation></semantics></math>.
Note that the first term in equation <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A1.E16" title="In Appendix A Theory ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">16</span></a> is linear in <math alttext="f" class="ltx_Math" display="inline" id="A1.p3.4.m4.1"><semantics id="A1.p3.4.m4.1a"><mi id="A1.p3.4.m4.1.1" xref="A1.p3.4.m4.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="A1.p3.4.m4.1b"><ci id="A1.p3.4.m4.1.1.cmml" xref="A1.p3.4.m4.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.4.m4.1c">f</annotation><annotation encoding="application/x-llamapun" id="A1.p3.4.m4.1d">italic_f</annotation></semantics></math> and thus has no curvature, so we only have to consider the log partition function itself:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A5.EGx3">
<tbody id="A1.E22"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\delta^{2}L[f;g,h]" class="ltx_Math" display="inline" id="A1.E22.m1.3"><semantics id="A1.E22.m1.3a"><mrow id="A1.E22.m1.3.4" xref="A1.E22.m1.3.4.cmml"><msup id="A1.E22.m1.3.4.2" xref="A1.E22.m1.3.4.2.cmml"><mi id="A1.E22.m1.3.4.2.2" xref="A1.E22.m1.3.4.2.2.cmml">δ</mi><mn id="A1.E22.m1.3.4.2.3" xref="A1.E22.m1.3.4.2.3.cmml">2</mn></msup><mo id="A1.E22.m1.3.4.1" xref="A1.E22.m1.3.4.1.cmml">⁢</mo><mi id="A1.E22.m1.3.4.3" xref="A1.E22.m1.3.4.3.cmml">L</mi><mo id="A1.E22.m1.3.4.1a" xref="A1.E22.m1.3.4.1.cmml">⁢</mo><mrow id="A1.E22.m1.3.4.4.2" xref="A1.E22.m1.3.4.4.1.cmml"><mo id="A1.E22.m1.3.4.4.2.1" stretchy="false" xref="A1.E22.m1.3.4.4.1.cmml">[</mo><mi id="A1.E22.m1.1.1" xref="A1.E22.m1.1.1.cmml">f</mi><mo id="A1.E22.m1.3.4.4.2.2" xref="A1.E22.m1.3.4.4.1.cmml">;</mo><mi id="A1.E22.m1.2.2" xref="A1.E22.m1.2.2.cmml">g</mi><mo id="A1.E22.m1.3.4.4.2.3" xref="A1.E22.m1.3.4.4.1.cmml">,</mo><mi id="A1.E22.m1.3.3" xref="A1.E22.m1.3.3.cmml">h</mi><mo id="A1.E22.m1.3.4.4.2.4" stretchy="false" xref="A1.E22.m1.3.4.4.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E22.m1.3b"><apply id="A1.E22.m1.3.4.cmml" xref="A1.E22.m1.3.4"><times id="A1.E22.m1.3.4.1.cmml" xref="A1.E22.m1.3.4.1"></times><apply id="A1.E22.m1.3.4.2.cmml" xref="A1.E22.m1.3.4.2"><csymbol cd="ambiguous" id="A1.E22.m1.3.4.2.1.cmml" xref="A1.E22.m1.3.4.2">superscript</csymbol><ci id="A1.E22.m1.3.4.2.2.cmml" xref="A1.E22.m1.3.4.2.2">𝛿</ci><cn id="A1.E22.m1.3.4.2.3.cmml" type="integer" xref="A1.E22.m1.3.4.2.3">2</cn></apply><ci id="A1.E22.m1.3.4.3.cmml" xref="A1.E22.m1.3.4.3">𝐿</ci><list id="A1.E22.m1.3.4.4.1.cmml" xref="A1.E22.m1.3.4.4.2"><ci id="A1.E22.m1.1.1.cmml" xref="A1.E22.m1.1.1">𝑓</ci><ci id="A1.E22.m1.2.2.cmml" xref="A1.E22.m1.2.2">𝑔</ci><ci id="A1.E22.m1.3.3.cmml" xref="A1.E22.m1.3.3">ℎ</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E22.m1.3c">\displaystyle\delta^{2}L[f;g,h]</annotation><annotation encoding="application/x-llamapun" id="A1.E22.m1.3d">italic_δ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_L [ italic_f ; italic_g , italic_h ]</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\coloneqq\left.\frac{\partial^{2}L[f+\epsilon g+\varepsilon h]}{%
\partial\epsilon\partial\varepsilon}\right|_{(\epsilon,\varepsilon)=0}" class="ltx_Math" display="inline" id="A1.E22.m2.3"><semantics id="A1.E22.m2.3a"><mrow id="A1.E22.m2.3.4" xref="A1.E22.m2.3.4.cmml"><mi id="A1.E22.m2.3.4.2" xref="A1.E22.m2.3.4.2.cmml"></mi><mo id="A1.E22.m2.3.4.1" xref="A1.E22.m2.3.4.1.cmml">≔</mo><msub id="A1.E22.m2.3.4.3.2" xref="A1.E22.m2.3.4.3.1.cmml"><mrow id="A1.E22.m2.3.4.3.2.2" xref="A1.E22.m2.3.4.3.1.cmml"><mstyle displaystyle="true" id="A1.E22.m2.1.1" xref="A1.E22.m2.1.1.cmml"><mfrac id="A1.E22.m2.1.1a" xref="A1.E22.m2.1.1.cmml"><mrow id="A1.E22.m2.1.1.1" xref="A1.E22.m2.1.1.1.cmml"><msup id="A1.E22.m2.1.1.1.2" xref="A1.E22.m2.1.1.1.2.cmml"><mo id="A1.E22.m2.1.1.1.2.2" xref="A1.E22.m2.1.1.1.2.2.cmml">∂</mo><mn id="A1.E22.m2.1.1.1.2.3" xref="A1.E22.m2.1.1.1.2.3.cmml">2</mn></msup><mrow id="A1.E22.m2.1.1.1.1" xref="A1.E22.m2.1.1.1.1.cmml"><mi id="A1.E22.m2.1.1.1.1.3" xref="A1.E22.m2.1.1.1.1.3.cmml">L</mi><mo id="A1.E22.m2.1.1.1.1.2" xref="A1.E22.m2.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E22.m2.1.1.1.1.1.1" xref="A1.E22.m2.1.1.1.1.1.2.cmml"><mo id="A1.E22.m2.1.1.1.1.1.1.2" stretchy="false" xref="A1.E22.m2.1.1.1.1.1.2.1.cmml">[</mo><mrow id="A1.E22.m2.1.1.1.1.1.1.1" xref="A1.E22.m2.1.1.1.1.1.1.1.cmml"><mi id="A1.E22.m2.1.1.1.1.1.1.1.2" xref="A1.E22.m2.1.1.1.1.1.1.1.2.cmml">f</mi><mo id="A1.E22.m2.1.1.1.1.1.1.1.1" xref="A1.E22.m2.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="A1.E22.m2.1.1.1.1.1.1.1.3" xref="A1.E22.m2.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E22.m2.1.1.1.1.1.1.1.3.2" xref="A1.E22.m2.1.1.1.1.1.1.1.3.2.cmml">ϵ</mi><mo id="A1.E22.m2.1.1.1.1.1.1.1.3.1" xref="A1.E22.m2.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="A1.E22.m2.1.1.1.1.1.1.1.3.3" xref="A1.E22.m2.1.1.1.1.1.1.1.3.3.cmml">g</mi></mrow><mo id="A1.E22.m2.1.1.1.1.1.1.1.1a" xref="A1.E22.m2.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="A1.E22.m2.1.1.1.1.1.1.1.4" xref="A1.E22.m2.1.1.1.1.1.1.1.4.cmml"><mi id="A1.E22.m2.1.1.1.1.1.1.1.4.2" xref="A1.E22.m2.1.1.1.1.1.1.1.4.2.cmml">ε</mi><mo id="A1.E22.m2.1.1.1.1.1.1.1.4.1" xref="A1.E22.m2.1.1.1.1.1.1.1.4.1.cmml">⁢</mo><mi id="A1.E22.m2.1.1.1.1.1.1.1.4.3" xref="A1.E22.m2.1.1.1.1.1.1.1.4.3.cmml">h</mi></mrow></mrow><mo id="A1.E22.m2.1.1.1.1.1.1.3" stretchy="false" xref="A1.E22.m2.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mrow id="A1.E22.m2.1.1.3" xref="A1.E22.m2.1.1.3.cmml"><mo id="A1.E22.m2.1.1.3.1" rspace="0em" xref="A1.E22.m2.1.1.3.1.cmml">∂</mo><mrow id="A1.E22.m2.1.1.3.2" xref="A1.E22.m2.1.1.3.2.cmml"><mi id="A1.E22.m2.1.1.3.2.2" xref="A1.E22.m2.1.1.3.2.2.cmml">ϵ</mi><mo id="A1.E22.m2.1.1.3.2.1" lspace="0em" xref="A1.E22.m2.1.1.3.2.1.cmml">⁢</mo><mrow id="A1.E22.m2.1.1.3.2.3" xref="A1.E22.m2.1.1.3.2.3.cmml"><mo id="A1.E22.m2.1.1.3.2.3.1" rspace="0em" xref="A1.E22.m2.1.1.3.2.3.1.cmml">∂</mo><mi id="A1.E22.m2.1.1.3.2.3.2" xref="A1.E22.m2.1.1.3.2.3.2.cmml">ε</mi></mrow></mrow></mrow></mfrac></mstyle><mo id="A1.E22.m2.3.4.3.2.2.1" xref="A1.E22.m2.3.4.3.1.1.cmml">|</mo></mrow><mrow id="A1.E22.m2.3.3.2" xref="A1.E22.m2.3.3.2.cmml"><mrow id="A1.E22.m2.3.3.2.4.2" xref="A1.E22.m2.3.3.2.4.1.cmml"><mo id="A1.E22.m2.3.3.2.4.2.1" stretchy="false" xref="A1.E22.m2.3.3.2.4.1.cmml">(</mo><mi id="A1.E22.m2.2.2.1.1" xref="A1.E22.m2.2.2.1.1.cmml">ϵ</mi><mo id="A1.E22.m2.3.3.2.4.2.2" xref="A1.E22.m2.3.3.2.4.1.cmml">,</mo><mi id="A1.E22.m2.3.3.2.2" xref="A1.E22.m2.3.3.2.2.cmml">ε</mi><mo id="A1.E22.m2.3.3.2.4.2.3" stretchy="false" xref="A1.E22.m2.3.3.2.4.1.cmml">)</mo></mrow><mo id="A1.E22.m2.3.3.2.3" xref="A1.E22.m2.3.3.2.3.cmml">=</mo><mn id="A1.E22.m2.3.3.2.5" xref="A1.E22.m2.3.3.2.5.cmml">0</mn></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.E22.m2.3b"><apply id="A1.E22.m2.3.4.cmml" xref="A1.E22.m2.3.4"><ci id="A1.E22.m2.3.4.1.cmml" xref="A1.E22.m2.3.4.1">≔</ci><csymbol cd="latexml" id="A1.E22.m2.3.4.2.cmml" xref="A1.E22.m2.3.4.2">absent</csymbol><apply id="A1.E22.m2.3.4.3.1.cmml" xref="A1.E22.m2.3.4.3.2"><csymbol cd="latexml" id="A1.E22.m2.3.4.3.1.1.cmml" xref="A1.E22.m2.3.4.3.2.2.1">evaluated-at</csymbol><apply id="A1.E22.m2.1.1.cmml" xref="A1.E22.m2.1.1"><divide id="A1.E22.m2.1.1.2.cmml" xref="A1.E22.m2.1.1"></divide><apply id="A1.E22.m2.1.1.1.cmml" xref="A1.E22.m2.1.1.1"><apply id="A1.E22.m2.1.1.1.2.cmml" xref="A1.E22.m2.1.1.1.2"><csymbol cd="ambiguous" id="A1.E22.m2.1.1.1.2.1.cmml" xref="A1.E22.m2.1.1.1.2">superscript</csymbol><partialdiff id="A1.E22.m2.1.1.1.2.2.cmml" xref="A1.E22.m2.1.1.1.2.2"></partialdiff><cn id="A1.E22.m2.1.1.1.2.3.cmml" type="integer" xref="A1.E22.m2.1.1.1.2.3">2</cn></apply><apply id="A1.E22.m2.1.1.1.1.cmml" xref="A1.E22.m2.1.1.1.1"><times id="A1.E22.m2.1.1.1.1.2.cmml" xref="A1.E22.m2.1.1.1.1.2"></times><ci id="A1.E22.m2.1.1.1.1.3.cmml" xref="A1.E22.m2.1.1.1.1.3">𝐿</ci><apply id="A1.E22.m2.1.1.1.1.1.2.cmml" xref="A1.E22.m2.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E22.m2.1.1.1.1.1.2.1.cmml" xref="A1.E22.m2.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A1.E22.m2.1.1.1.1.1.1.1.cmml" xref="A1.E22.m2.1.1.1.1.1.1.1"><plus id="A1.E22.m2.1.1.1.1.1.1.1.1.cmml" xref="A1.E22.m2.1.1.1.1.1.1.1.1"></plus><ci id="A1.E22.m2.1.1.1.1.1.1.1.2.cmml" xref="A1.E22.m2.1.1.1.1.1.1.1.2">𝑓</ci><apply id="A1.E22.m2.1.1.1.1.1.1.1.3.cmml" xref="A1.E22.m2.1.1.1.1.1.1.1.3"><times id="A1.E22.m2.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E22.m2.1.1.1.1.1.1.1.3.1"></times><ci id="A1.E22.m2.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E22.m2.1.1.1.1.1.1.1.3.2">italic-ϵ</ci><ci id="A1.E22.m2.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E22.m2.1.1.1.1.1.1.1.3.3">𝑔</ci></apply><apply id="A1.E22.m2.1.1.1.1.1.1.1.4.cmml" xref="A1.E22.m2.1.1.1.1.1.1.1.4"><times id="A1.E22.m2.1.1.1.1.1.1.1.4.1.cmml" xref="A1.E22.m2.1.1.1.1.1.1.1.4.1"></times><ci id="A1.E22.m2.1.1.1.1.1.1.1.4.2.cmml" xref="A1.E22.m2.1.1.1.1.1.1.1.4.2">𝜀</ci><ci id="A1.E22.m2.1.1.1.1.1.1.1.4.3.cmml" xref="A1.E22.m2.1.1.1.1.1.1.1.4.3">ℎ</ci></apply></apply></apply></apply></apply><apply id="A1.E22.m2.1.1.3.cmml" xref="A1.E22.m2.1.1.3"><partialdiff id="A1.E22.m2.1.1.3.1.cmml" xref="A1.E22.m2.1.1.3.1"></partialdiff><apply id="A1.E22.m2.1.1.3.2.cmml" xref="A1.E22.m2.1.1.3.2"><times id="A1.E22.m2.1.1.3.2.1.cmml" xref="A1.E22.m2.1.1.3.2.1"></times><ci id="A1.E22.m2.1.1.3.2.2.cmml" xref="A1.E22.m2.1.1.3.2.2">italic-ϵ</ci><apply id="A1.E22.m2.1.1.3.2.3.cmml" xref="A1.E22.m2.1.1.3.2.3"><partialdiff id="A1.E22.m2.1.1.3.2.3.1.cmml" xref="A1.E22.m2.1.1.3.2.3.1"></partialdiff><ci id="A1.E22.m2.1.1.3.2.3.2.cmml" xref="A1.E22.m2.1.1.3.2.3.2">𝜀</ci></apply></apply></apply></apply><apply id="A1.E22.m2.3.3.2.cmml" xref="A1.E22.m2.3.3.2"><eq id="A1.E22.m2.3.3.2.3.cmml" xref="A1.E22.m2.3.3.2.3"></eq><interval closure="open" id="A1.E22.m2.3.3.2.4.1.cmml" xref="A1.E22.m2.3.3.2.4.2"><ci id="A1.E22.m2.2.2.1.1.cmml" xref="A1.E22.m2.2.2.1.1">italic-ϵ</ci><ci id="A1.E22.m2.3.3.2.2.cmml" xref="A1.E22.m2.3.3.2.2">𝜀</ci></interval><cn id="A1.E22.m2.3.3.2.5.cmml" type="integer" xref="A1.E22.m2.3.3.2.5">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E22.m2.3c">\displaystyle\coloneqq\left.\frac{\partial^{2}L[f+\epsilon g+\varepsilon h]}{%
\partial\epsilon\partial\varepsilon}\right|_{(\epsilon,\varepsilon)=0}</annotation><annotation encoding="application/x-llamapun" id="A1.E22.m2.3d">≔ divide start_ARG ∂ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_L [ italic_f + italic_ϵ italic_g + italic_ε italic_h ] end_ARG start_ARG ∂ italic_ϵ ∂ italic_ε end_ARG | start_POSTSUBSCRIPT ( italic_ϵ , italic_ε ) = 0 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(22)</span></td>
</tr></tbody>
<tbody id="A1.E23"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=-\delta^{2}\log Z[f;g,h]=-\delta\left\{\delta\log Z[f;g]\right\}%
[f;h]" class="ltx_Math" display="inline" id="A1.E23.m1.8"><semantics id="A1.E23.m1.8a"><mrow id="A1.E23.m1.8.8" xref="A1.E23.m1.8.8.cmml"><mi id="A1.E23.m1.8.8.3" xref="A1.E23.m1.8.8.3.cmml"></mi><mo id="A1.E23.m1.8.8.4" xref="A1.E23.m1.8.8.4.cmml">=</mo><mrow id="A1.E23.m1.8.8.5" xref="A1.E23.m1.8.8.5.cmml"><mo id="A1.E23.m1.8.8.5a" xref="A1.E23.m1.8.8.5.cmml">−</mo><mrow id="A1.E23.m1.8.8.5.2" xref="A1.E23.m1.8.8.5.2.cmml"><msup id="A1.E23.m1.8.8.5.2.2" xref="A1.E23.m1.8.8.5.2.2.cmml"><mi id="A1.E23.m1.8.8.5.2.2.2" xref="A1.E23.m1.8.8.5.2.2.2.cmml">δ</mi><mn id="A1.E23.m1.8.8.5.2.2.3" xref="A1.E23.m1.8.8.5.2.2.3.cmml">2</mn></msup><mo id="A1.E23.m1.8.8.5.2.1" lspace="0.167em" xref="A1.E23.m1.8.8.5.2.1.cmml">⁢</mo><mrow id="A1.E23.m1.8.8.5.2.3" xref="A1.E23.m1.8.8.5.2.3.cmml"><mi id="A1.E23.m1.8.8.5.2.3.1" xref="A1.E23.m1.8.8.5.2.3.1.cmml">log</mi><mo id="A1.E23.m1.8.8.5.2.3a" lspace="0.167em" xref="A1.E23.m1.8.8.5.2.3.cmml">⁡</mo><mi id="A1.E23.m1.8.8.5.2.3.2" xref="A1.E23.m1.8.8.5.2.3.2.cmml">Z</mi></mrow><mo id="A1.E23.m1.8.8.5.2.1a" xref="A1.E23.m1.8.8.5.2.1.cmml">⁢</mo><mrow id="A1.E23.m1.8.8.5.2.4.2" xref="A1.E23.m1.8.8.5.2.4.1.cmml"><mo id="A1.E23.m1.8.8.5.2.4.2.1" stretchy="false" xref="A1.E23.m1.8.8.5.2.4.1.cmml">[</mo><mi id="A1.E23.m1.1.1" xref="A1.E23.m1.1.1.cmml">f</mi><mo id="A1.E23.m1.8.8.5.2.4.2.2" xref="A1.E23.m1.8.8.5.2.4.1.cmml">;</mo><mi id="A1.E23.m1.2.2" xref="A1.E23.m1.2.2.cmml">g</mi><mo id="A1.E23.m1.8.8.5.2.4.2.3" xref="A1.E23.m1.8.8.5.2.4.1.cmml">,</mo><mi id="A1.E23.m1.3.3" xref="A1.E23.m1.3.3.cmml">h</mi><mo id="A1.E23.m1.8.8.5.2.4.2.4" stretchy="false" xref="A1.E23.m1.8.8.5.2.4.1.cmml">]</mo></mrow></mrow></mrow><mo id="A1.E23.m1.8.8.6" xref="A1.E23.m1.8.8.6.cmml">=</mo><mrow id="A1.E23.m1.8.8.1" xref="A1.E23.m1.8.8.1.cmml"><mo id="A1.E23.m1.8.8.1a" xref="A1.E23.m1.8.8.1.cmml">−</mo><mrow id="A1.E23.m1.8.8.1.1" xref="A1.E23.m1.8.8.1.1.cmml"><mi id="A1.E23.m1.8.8.1.1.3" xref="A1.E23.m1.8.8.1.1.3.cmml">δ</mi><mo id="A1.E23.m1.8.8.1.1.2" xref="A1.E23.m1.8.8.1.1.2.cmml">⁢</mo><mrow id="A1.E23.m1.8.8.1.1.1.1" xref="A1.E23.m1.8.8.1.1.1.2.cmml"><mo id="A1.E23.m1.8.8.1.1.1.1.2" xref="A1.E23.m1.8.8.1.1.1.2.cmml">{</mo><mrow id="A1.E23.m1.8.8.1.1.1.1.1" xref="A1.E23.m1.8.8.1.1.1.1.1.cmml"><mi id="A1.E23.m1.8.8.1.1.1.1.1.2" xref="A1.E23.m1.8.8.1.1.1.1.1.2.cmml">δ</mi><mo id="A1.E23.m1.8.8.1.1.1.1.1.1" lspace="0.167em" xref="A1.E23.m1.8.8.1.1.1.1.1.1.cmml">⁢</mo><mrow id="A1.E23.m1.8.8.1.1.1.1.1.3" xref="A1.E23.m1.8.8.1.1.1.1.1.3.cmml"><mi id="A1.E23.m1.8.8.1.1.1.1.1.3.1" xref="A1.E23.m1.8.8.1.1.1.1.1.3.1.cmml">log</mi><mo id="A1.E23.m1.8.8.1.1.1.1.1.3a" lspace="0.167em" xref="A1.E23.m1.8.8.1.1.1.1.1.3.cmml">⁡</mo><mi id="A1.E23.m1.8.8.1.1.1.1.1.3.2" xref="A1.E23.m1.8.8.1.1.1.1.1.3.2.cmml">Z</mi></mrow><mo id="A1.E23.m1.8.8.1.1.1.1.1.1a" xref="A1.E23.m1.8.8.1.1.1.1.1.1.cmml">⁢</mo><mrow id="A1.E23.m1.8.8.1.1.1.1.1.4.2" xref="A1.E23.m1.8.8.1.1.1.1.1.4.1.cmml"><mo id="A1.E23.m1.8.8.1.1.1.1.1.4.2.1" stretchy="false" xref="A1.E23.m1.8.8.1.1.1.1.1.4.1.cmml">[</mo><mi id="A1.E23.m1.4.4" xref="A1.E23.m1.4.4.cmml">f</mi><mo id="A1.E23.m1.8.8.1.1.1.1.1.4.2.2" xref="A1.E23.m1.8.8.1.1.1.1.1.4.1.cmml">;</mo><mi id="A1.E23.m1.5.5" xref="A1.E23.m1.5.5.cmml">g</mi><mo id="A1.E23.m1.8.8.1.1.1.1.1.4.2.3" stretchy="false" xref="A1.E23.m1.8.8.1.1.1.1.1.4.1.cmml">]</mo></mrow></mrow><mo id="A1.E23.m1.8.8.1.1.1.1.3" xref="A1.E23.m1.8.8.1.1.1.2.cmml">}</mo></mrow><mo id="A1.E23.m1.8.8.1.1.2a" xref="A1.E23.m1.8.8.1.1.2.cmml">⁢</mo><mrow id="A1.E23.m1.8.8.1.1.4.2" xref="A1.E23.m1.8.8.1.1.4.1.cmml"><mo id="A1.E23.m1.8.8.1.1.4.2.1" stretchy="false" xref="A1.E23.m1.8.8.1.1.4.1.cmml">[</mo><mi id="A1.E23.m1.6.6" xref="A1.E23.m1.6.6.cmml">f</mi><mo id="A1.E23.m1.8.8.1.1.4.2.2" xref="A1.E23.m1.8.8.1.1.4.1.cmml">;</mo><mi id="A1.E23.m1.7.7" xref="A1.E23.m1.7.7.cmml">h</mi><mo id="A1.E23.m1.8.8.1.1.4.2.3" stretchy="false" xref="A1.E23.m1.8.8.1.1.4.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E23.m1.8b"><apply id="A1.E23.m1.8.8.cmml" xref="A1.E23.m1.8.8"><and id="A1.E23.m1.8.8a.cmml" xref="A1.E23.m1.8.8"></and><apply id="A1.E23.m1.8.8b.cmml" xref="A1.E23.m1.8.8"><eq id="A1.E23.m1.8.8.4.cmml" xref="A1.E23.m1.8.8.4"></eq><csymbol cd="latexml" id="A1.E23.m1.8.8.3.cmml" xref="A1.E23.m1.8.8.3">absent</csymbol><apply id="A1.E23.m1.8.8.5.cmml" xref="A1.E23.m1.8.8.5"><minus id="A1.E23.m1.8.8.5.1.cmml" xref="A1.E23.m1.8.8.5"></minus><apply id="A1.E23.m1.8.8.5.2.cmml" xref="A1.E23.m1.8.8.5.2"><times id="A1.E23.m1.8.8.5.2.1.cmml" xref="A1.E23.m1.8.8.5.2.1"></times><apply id="A1.E23.m1.8.8.5.2.2.cmml" xref="A1.E23.m1.8.8.5.2.2"><csymbol cd="ambiguous" id="A1.E23.m1.8.8.5.2.2.1.cmml" xref="A1.E23.m1.8.8.5.2.2">superscript</csymbol><ci id="A1.E23.m1.8.8.5.2.2.2.cmml" xref="A1.E23.m1.8.8.5.2.2.2">𝛿</ci><cn id="A1.E23.m1.8.8.5.2.2.3.cmml" type="integer" xref="A1.E23.m1.8.8.5.2.2.3">2</cn></apply><apply id="A1.E23.m1.8.8.5.2.3.cmml" xref="A1.E23.m1.8.8.5.2.3"><log id="A1.E23.m1.8.8.5.2.3.1.cmml" xref="A1.E23.m1.8.8.5.2.3.1"></log><ci id="A1.E23.m1.8.8.5.2.3.2.cmml" xref="A1.E23.m1.8.8.5.2.3.2">𝑍</ci></apply><list id="A1.E23.m1.8.8.5.2.4.1.cmml" xref="A1.E23.m1.8.8.5.2.4.2"><ci id="A1.E23.m1.1.1.cmml" xref="A1.E23.m1.1.1">𝑓</ci><ci id="A1.E23.m1.2.2.cmml" xref="A1.E23.m1.2.2">𝑔</ci><ci id="A1.E23.m1.3.3.cmml" xref="A1.E23.m1.3.3">ℎ</ci></list></apply></apply></apply><apply id="A1.E23.m1.8.8c.cmml" xref="A1.E23.m1.8.8"><eq id="A1.E23.m1.8.8.6.cmml" xref="A1.E23.m1.8.8.6"></eq><share href="https://arxiv.org/html/2410.03535v1#A1.E23.m1.8.8.5.cmml" id="A1.E23.m1.8.8d.cmml" xref="A1.E23.m1.8.8"></share><apply id="A1.E23.m1.8.8.1.cmml" xref="A1.E23.m1.8.8.1"><minus id="A1.E23.m1.8.8.1.2.cmml" xref="A1.E23.m1.8.8.1"></minus><apply id="A1.E23.m1.8.8.1.1.cmml" xref="A1.E23.m1.8.8.1.1"><times id="A1.E23.m1.8.8.1.1.2.cmml" xref="A1.E23.m1.8.8.1.1.2"></times><ci id="A1.E23.m1.8.8.1.1.3.cmml" xref="A1.E23.m1.8.8.1.1.3">𝛿</ci><set id="A1.E23.m1.8.8.1.1.1.2.cmml" xref="A1.E23.m1.8.8.1.1.1.1"><apply id="A1.E23.m1.8.8.1.1.1.1.1.cmml" xref="A1.E23.m1.8.8.1.1.1.1.1"><times id="A1.E23.m1.8.8.1.1.1.1.1.1.cmml" xref="A1.E23.m1.8.8.1.1.1.1.1.1"></times><ci id="A1.E23.m1.8.8.1.1.1.1.1.2.cmml" xref="A1.E23.m1.8.8.1.1.1.1.1.2">𝛿</ci><apply id="A1.E23.m1.8.8.1.1.1.1.1.3.cmml" xref="A1.E23.m1.8.8.1.1.1.1.1.3"><log id="A1.E23.m1.8.8.1.1.1.1.1.3.1.cmml" xref="A1.E23.m1.8.8.1.1.1.1.1.3.1"></log><ci id="A1.E23.m1.8.8.1.1.1.1.1.3.2.cmml" xref="A1.E23.m1.8.8.1.1.1.1.1.3.2">𝑍</ci></apply><list id="A1.E23.m1.8.8.1.1.1.1.1.4.1.cmml" xref="A1.E23.m1.8.8.1.1.1.1.1.4.2"><ci id="A1.E23.m1.4.4.cmml" xref="A1.E23.m1.4.4">𝑓</ci><ci id="A1.E23.m1.5.5.cmml" xref="A1.E23.m1.5.5">𝑔</ci></list></apply></set><list id="A1.E23.m1.8.8.1.1.4.1.cmml" xref="A1.E23.m1.8.8.1.1.4.2"><ci id="A1.E23.m1.6.6.cmml" xref="A1.E23.m1.6.6">𝑓</ci><ci id="A1.E23.m1.7.7.cmml" xref="A1.E23.m1.7.7">ℎ</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E23.m1.8c">\displaystyle=-\delta^{2}\log Z[f;g,h]=-\delta\left\{\delta\log Z[f;g]\right\}%
[f;h]</annotation><annotation encoding="application/x-llamapun" id="A1.E23.m1.8d">= - italic_δ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT roman_log italic_Z [ italic_f ; italic_g , italic_h ] = - italic_δ { italic_δ roman_log italic_Z [ italic_f ; italic_g ] } [ italic_f ; italic_h ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(23)</span></td>
</tr></tbody>
<tbody id="A1.E24"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=-\delta\left\{\frac{1}{Z[f]}\sum_{\mathbf{x}}\exp\left(f(\mathbf%
{x})\right)g(\mathbf{x})\right\}[f;h]" class="ltx_Math" display="inline" id="A1.E24.m1.7"><semantics id="A1.E24.m1.7a"><mrow id="A1.E24.m1.7.7" xref="A1.E24.m1.7.7.cmml"><mi id="A1.E24.m1.7.7.3" xref="A1.E24.m1.7.7.3.cmml"></mi><mo id="A1.E24.m1.7.7.2" xref="A1.E24.m1.7.7.2.cmml">=</mo><mrow id="A1.E24.m1.7.7.1" xref="A1.E24.m1.7.7.1.cmml"><mo id="A1.E24.m1.7.7.1a" xref="A1.E24.m1.7.7.1.cmml">−</mo><mrow id="A1.E24.m1.7.7.1.1" xref="A1.E24.m1.7.7.1.1.cmml"><mi id="A1.E24.m1.7.7.1.1.3" xref="A1.E24.m1.7.7.1.1.3.cmml">δ</mi><mo id="A1.E24.m1.7.7.1.1.2" xref="A1.E24.m1.7.7.1.1.2.cmml">⁢</mo><mrow id="A1.E24.m1.7.7.1.1.1.1" xref="A1.E24.m1.7.7.1.1.1.2.cmml"><mo id="A1.E24.m1.7.7.1.1.1.1.2" xref="A1.E24.m1.7.7.1.1.1.2.cmml">{</mo><mrow id="A1.E24.m1.7.7.1.1.1.1.1" xref="A1.E24.m1.7.7.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A1.E24.m1.1.1" xref="A1.E24.m1.1.1.cmml"><mfrac id="A1.E24.m1.1.1a" xref="A1.E24.m1.1.1.cmml"><mn id="A1.E24.m1.1.1.3" xref="A1.E24.m1.1.1.3.cmml">1</mn><mrow id="A1.E24.m1.1.1.1" xref="A1.E24.m1.1.1.1.cmml"><mi id="A1.E24.m1.1.1.1.3" xref="A1.E24.m1.1.1.1.3.cmml">Z</mi><mo id="A1.E24.m1.1.1.1.2" xref="A1.E24.m1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E24.m1.1.1.1.4.2" xref="A1.E24.m1.1.1.1.4.1.cmml"><mo id="A1.E24.m1.1.1.1.4.2.1" stretchy="false" xref="A1.E24.m1.1.1.1.4.1.1.cmml">[</mo><mi id="A1.E24.m1.1.1.1.1" xref="A1.E24.m1.1.1.1.1.cmml">f</mi><mo id="A1.E24.m1.1.1.1.4.2.2" stretchy="false" xref="A1.E24.m1.1.1.1.4.1.1.cmml">]</mo></mrow></mrow></mfrac></mstyle><mo id="A1.E24.m1.7.7.1.1.1.1.1.2" xref="A1.E24.m1.7.7.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E24.m1.7.7.1.1.1.1.1.1" xref="A1.E24.m1.7.7.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A1.E24.m1.7.7.1.1.1.1.1.1.2" xref="A1.E24.m1.7.7.1.1.1.1.1.1.2.cmml"><munder id="A1.E24.m1.7.7.1.1.1.1.1.1.2a" xref="A1.E24.m1.7.7.1.1.1.1.1.1.2.cmml"><mo id="A1.E24.m1.7.7.1.1.1.1.1.1.2.2" movablelimits="false" xref="A1.E24.m1.7.7.1.1.1.1.1.1.2.2.cmml">∑</mo><mi id="A1.E24.m1.7.7.1.1.1.1.1.1.2.3" xref="A1.E24.m1.7.7.1.1.1.1.1.1.2.3.cmml">𝐱</mi></munder></mstyle><mrow id="A1.E24.m1.7.7.1.1.1.1.1.1.1" xref="A1.E24.m1.7.7.1.1.1.1.1.1.1.cmml"><mrow id="A1.E24.m1.7.7.1.1.1.1.1.1.1.1.1" xref="A1.E24.m1.7.7.1.1.1.1.1.1.1.1.2.cmml"><mi id="A1.E24.m1.3.3" xref="A1.E24.m1.3.3.cmml">exp</mi><mo id="A1.E24.m1.7.7.1.1.1.1.1.1.1.1.1a" xref="A1.E24.m1.7.7.1.1.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="A1.E24.m1.7.7.1.1.1.1.1.1.1.1.1.1" xref="A1.E24.m1.7.7.1.1.1.1.1.1.1.1.2.cmml"><mo id="A1.E24.m1.7.7.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E24.m1.7.7.1.1.1.1.1.1.1.1.2.cmml">(</mo><mrow id="A1.E24.m1.7.7.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E24.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E24.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E24.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2.cmml">f</mi><mo id="A1.E24.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E24.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="A1.E24.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="A1.E24.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E24.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="A1.E24.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="A1.E24.m1.2.2" xref="A1.E24.m1.2.2.cmml">𝐱</mi><mo id="A1.E24.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="A1.E24.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E24.m1.7.7.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E24.m1.7.7.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.E24.m1.7.7.1.1.1.1.1.1.1.2" xref="A1.E24.m1.7.7.1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="A1.E24.m1.7.7.1.1.1.1.1.1.1.3" xref="A1.E24.m1.7.7.1.1.1.1.1.1.1.3.cmml">g</mi><mo id="A1.E24.m1.7.7.1.1.1.1.1.1.1.2a" xref="A1.E24.m1.7.7.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E24.m1.7.7.1.1.1.1.1.1.1.4.2" xref="A1.E24.m1.7.7.1.1.1.1.1.1.1.cmml"><mo id="A1.E24.m1.7.7.1.1.1.1.1.1.1.4.2.1" stretchy="false" xref="A1.E24.m1.7.7.1.1.1.1.1.1.1.cmml">(</mo><mi id="A1.E24.m1.4.4" xref="A1.E24.m1.4.4.cmml">𝐱</mi><mo id="A1.E24.m1.7.7.1.1.1.1.1.1.1.4.2.2" stretchy="false" xref="A1.E24.m1.7.7.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A1.E24.m1.7.7.1.1.1.1.3" xref="A1.E24.m1.7.7.1.1.1.2.cmml">}</mo></mrow><mo id="A1.E24.m1.7.7.1.1.2a" xref="A1.E24.m1.7.7.1.1.2.cmml">⁢</mo><mrow id="A1.E24.m1.7.7.1.1.4.2" xref="A1.E24.m1.7.7.1.1.4.1.cmml"><mo id="A1.E24.m1.7.7.1.1.4.2.1" stretchy="false" xref="A1.E24.m1.7.7.1.1.4.1.cmml">[</mo><mi id="A1.E24.m1.5.5" xref="A1.E24.m1.5.5.cmml">f</mi><mo id="A1.E24.m1.7.7.1.1.4.2.2" xref="A1.E24.m1.7.7.1.1.4.1.cmml">;</mo><mi id="A1.E24.m1.6.6" xref="A1.E24.m1.6.6.cmml">h</mi><mo id="A1.E24.m1.7.7.1.1.4.2.3" stretchy="false" xref="A1.E24.m1.7.7.1.1.4.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E24.m1.7b"><apply id="A1.E24.m1.7.7.cmml" xref="A1.E24.m1.7.7"><eq id="A1.E24.m1.7.7.2.cmml" xref="A1.E24.m1.7.7.2"></eq><csymbol cd="latexml" id="A1.E24.m1.7.7.3.cmml" xref="A1.E24.m1.7.7.3">absent</csymbol><apply id="A1.E24.m1.7.7.1.cmml" xref="A1.E24.m1.7.7.1"><minus id="A1.E24.m1.7.7.1.2.cmml" xref="A1.E24.m1.7.7.1"></minus><apply id="A1.E24.m1.7.7.1.1.cmml" xref="A1.E24.m1.7.7.1.1"><times id="A1.E24.m1.7.7.1.1.2.cmml" xref="A1.E24.m1.7.7.1.1.2"></times><ci id="A1.E24.m1.7.7.1.1.3.cmml" xref="A1.E24.m1.7.7.1.1.3">𝛿</ci><set id="A1.E24.m1.7.7.1.1.1.2.cmml" xref="A1.E24.m1.7.7.1.1.1.1"><apply id="A1.E24.m1.7.7.1.1.1.1.1.cmml" xref="A1.E24.m1.7.7.1.1.1.1.1"><times id="A1.E24.m1.7.7.1.1.1.1.1.2.cmml" xref="A1.E24.m1.7.7.1.1.1.1.1.2"></times><apply id="A1.E24.m1.1.1.cmml" xref="A1.E24.m1.1.1"><divide id="A1.E24.m1.1.1.2.cmml" xref="A1.E24.m1.1.1"></divide><cn id="A1.E24.m1.1.1.3.cmml" type="integer" xref="A1.E24.m1.1.1.3">1</cn><apply id="A1.E24.m1.1.1.1.cmml" xref="A1.E24.m1.1.1.1"><times id="A1.E24.m1.1.1.1.2.cmml" xref="A1.E24.m1.1.1.1.2"></times><ci id="A1.E24.m1.1.1.1.3.cmml" xref="A1.E24.m1.1.1.1.3">𝑍</ci><apply id="A1.E24.m1.1.1.1.4.1.cmml" xref="A1.E24.m1.1.1.1.4.2"><csymbol cd="latexml" id="A1.E24.m1.1.1.1.4.1.1.cmml" xref="A1.E24.m1.1.1.1.4.2.1">delimited-[]</csymbol><ci id="A1.E24.m1.1.1.1.1.cmml" xref="A1.E24.m1.1.1.1.1">𝑓</ci></apply></apply></apply><apply id="A1.E24.m1.7.7.1.1.1.1.1.1.cmml" xref="A1.E24.m1.7.7.1.1.1.1.1.1"><apply id="A1.E24.m1.7.7.1.1.1.1.1.1.2.cmml" xref="A1.E24.m1.7.7.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E24.m1.7.7.1.1.1.1.1.1.2.1.cmml" xref="A1.E24.m1.7.7.1.1.1.1.1.1.2">subscript</csymbol><sum id="A1.E24.m1.7.7.1.1.1.1.1.1.2.2.cmml" xref="A1.E24.m1.7.7.1.1.1.1.1.1.2.2"></sum><ci id="A1.E24.m1.7.7.1.1.1.1.1.1.2.3.cmml" xref="A1.E24.m1.7.7.1.1.1.1.1.1.2.3">𝐱</ci></apply><apply id="A1.E24.m1.7.7.1.1.1.1.1.1.1.cmml" xref="A1.E24.m1.7.7.1.1.1.1.1.1.1"><times id="A1.E24.m1.7.7.1.1.1.1.1.1.1.2.cmml" xref="A1.E24.m1.7.7.1.1.1.1.1.1.1.2"></times><apply id="A1.E24.m1.7.7.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E24.m1.7.7.1.1.1.1.1.1.1.1.1"><exp id="A1.E24.m1.3.3.cmml" xref="A1.E24.m1.3.3"></exp><apply id="A1.E24.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E24.m1.7.7.1.1.1.1.1.1.1.1.1.1.1"><times id="A1.E24.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E24.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1"></times><ci id="A1.E24.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E24.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2">𝑓</ci><ci id="A1.E24.m1.2.2.cmml" xref="A1.E24.m1.2.2">𝐱</ci></apply></apply><ci id="A1.E24.m1.7.7.1.1.1.1.1.1.1.3.cmml" xref="A1.E24.m1.7.7.1.1.1.1.1.1.1.3">𝑔</ci><ci id="A1.E24.m1.4.4.cmml" xref="A1.E24.m1.4.4">𝐱</ci></apply></apply></apply></set><list id="A1.E24.m1.7.7.1.1.4.1.cmml" xref="A1.E24.m1.7.7.1.1.4.2"><ci id="A1.E24.m1.5.5.cmml" xref="A1.E24.m1.5.5">𝑓</ci><ci id="A1.E24.m1.6.6.cmml" xref="A1.E24.m1.6.6">ℎ</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E24.m1.7c">\displaystyle=-\delta\left\{\frac{1}{Z[f]}\sum_{\mathbf{x}}\exp\left(f(\mathbf%
{x})\right)g(\mathbf{x})\right\}[f;h]</annotation><annotation encoding="application/x-llamapun" id="A1.E24.m1.7d">= - italic_δ { divide start_ARG 1 end_ARG start_ARG italic_Z [ italic_f ] end_ARG ∑ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT roman_exp ( italic_f ( bold_x ) ) italic_g ( bold_x ) } [ italic_f ; italic_h ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(24)</span></td>
</tr></tbody>
<tbody id="A1.E25"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{\delta Z[f;h]}{Z^{2}[f]}\sum_{\mathbf{x}}\exp\left(f(%
\mathbf{x})\right)g(\mathbf{x})-\frac{1}{{Z[f]}}\sum_{\mathbf{x}}\exp^{\prime}%
\left(f(\mathbf{x})\right)g(\mathbf{x})h(\mathbf{x})" class="ltx_Math" display="inline" id="A1.E25.m1.13"><semantics id="A1.E25.m1.13a"><mrow id="A1.E25.m1.13.13" xref="A1.E25.m1.13.13.cmml"><mi id="A1.E25.m1.13.13.5" xref="A1.E25.m1.13.13.5.cmml"></mi><mo id="A1.E25.m1.13.13.4" xref="A1.E25.m1.13.13.4.cmml">=</mo><mrow id="A1.E25.m1.13.13.3" xref="A1.E25.m1.13.13.3.cmml"><mrow id="A1.E25.m1.11.11.1.1" xref="A1.E25.m1.11.11.1.1.cmml"><mstyle displaystyle="true" id="A1.E25.m1.3.3" xref="A1.E25.m1.3.3.cmml"><mfrac id="A1.E25.m1.3.3a" xref="A1.E25.m1.3.3.cmml"><mrow id="A1.E25.m1.2.2.2" xref="A1.E25.m1.2.2.2.cmml"><mi id="A1.E25.m1.2.2.2.4" xref="A1.E25.m1.2.2.2.4.cmml">δ</mi><mo id="A1.E25.m1.2.2.2.3" xref="A1.E25.m1.2.2.2.3.cmml">⁢</mo><mi id="A1.E25.m1.2.2.2.5" xref="A1.E25.m1.2.2.2.5.cmml">Z</mi><mo id="A1.E25.m1.2.2.2.3a" xref="A1.E25.m1.2.2.2.3.cmml">⁢</mo><mrow id="A1.E25.m1.2.2.2.6.2" xref="A1.E25.m1.2.2.2.6.1.cmml"><mo id="A1.E25.m1.2.2.2.6.2.1" stretchy="false" xref="A1.E25.m1.2.2.2.6.1.cmml">[</mo><mi id="A1.E25.m1.1.1.1.1" xref="A1.E25.m1.1.1.1.1.cmml">f</mi><mo id="A1.E25.m1.2.2.2.6.2.2" xref="A1.E25.m1.2.2.2.6.1.cmml">;</mo><mi id="A1.E25.m1.2.2.2.2" xref="A1.E25.m1.2.2.2.2.cmml">h</mi><mo id="A1.E25.m1.2.2.2.6.2.3" stretchy="false" xref="A1.E25.m1.2.2.2.6.1.cmml">]</mo></mrow></mrow><mrow id="A1.E25.m1.3.3.3" xref="A1.E25.m1.3.3.3.cmml"><msup id="A1.E25.m1.3.3.3.3" xref="A1.E25.m1.3.3.3.3.cmml"><mi id="A1.E25.m1.3.3.3.3.2" xref="A1.E25.m1.3.3.3.3.2.cmml">Z</mi><mn id="A1.E25.m1.3.3.3.3.3" xref="A1.E25.m1.3.3.3.3.3.cmml">2</mn></msup><mo id="A1.E25.m1.3.3.3.2" xref="A1.E25.m1.3.3.3.2.cmml">⁢</mo><mrow id="A1.E25.m1.3.3.3.4.2" xref="A1.E25.m1.3.3.3.4.1.cmml"><mo id="A1.E25.m1.3.3.3.4.2.1" stretchy="false" xref="A1.E25.m1.3.3.3.4.1.1.cmml">[</mo><mi id="A1.E25.m1.3.3.3.1" xref="A1.E25.m1.3.3.3.1.cmml">f</mi><mo id="A1.E25.m1.3.3.3.4.2.2" stretchy="false" xref="A1.E25.m1.3.3.3.4.1.1.cmml">]</mo></mrow></mrow></mfrac></mstyle><mo id="A1.E25.m1.11.11.1.1.2" xref="A1.E25.m1.11.11.1.1.2.cmml">⁢</mo><mrow id="A1.E25.m1.11.11.1.1.1" xref="A1.E25.m1.11.11.1.1.1.cmml"><mstyle displaystyle="true" id="A1.E25.m1.11.11.1.1.1.2" xref="A1.E25.m1.11.11.1.1.1.2.cmml"><munder id="A1.E25.m1.11.11.1.1.1.2a" xref="A1.E25.m1.11.11.1.1.1.2.cmml"><mo id="A1.E25.m1.11.11.1.1.1.2.2" movablelimits="false" xref="A1.E25.m1.11.11.1.1.1.2.2.cmml">∑</mo><mi id="A1.E25.m1.11.11.1.1.1.2.3" xref="A1.E25.m1.11.11.1.1.1.2.3.cmml">𝐱</mi></munder></mstyle><mrow id="A1.E25.m1.11.11.1.1.1.1" xref="A1.E25.m1.11.11.1.1.1.1.cmml"><mrow id="A1.E25.m1.11.11.1.1.1.1.1.1" xref="A1.E25.m1.11.11.1.1.1.1.1.2.cmml"><mi id="A1.E25.m1.6.6" xref="A1.E25.m1.6.6.cmml">exp</mi><mo id="A1.E25.m1.11.11.1.1.1.1.1.1a" xref="A1.E25.m1.11.11.1.1.1.1.1.2.cmml">⁡</mo><mrow id="A1.E25.m1.11.11.1.1.1.1.1.1.1" xref="A1.E25.m1.11.11.1.1.1.1.1.2.cmml"><mo id="A1.E25.m1.11.11.1.1.1.1.1.1.1.2" xref="A1.E25.m1.11.11.1.1.1.1.1.2.cmml">(</mo><mrow id="A1.E25.m1.11.11.1.1.1.1.1.1.1.1" xref="A1.E25.m1.11.11.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E25.m1.11.11.1.1.1.1.1.1.1.1.2" xref="A1.E25.m1.11.11.1.1.1.1.1.1.1.1.2.cmml">f</mi><mo id="A1.E25.m1.11.11.1.1.1.1.1.1.1.1.1" xref="A1.E25.m1.11.11.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="A1.E25.m1.11.11.1.1.1.1.1.1.1.1.3.2" xref="A1.E25.m1.11.11.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E25.m1.11.11.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="A1.E25.m1.11.11.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="A1.E25.m1.5.5" xref="A1.E25.m1.5.5.cmml">𝐱</mi><mo id="A1.E25.m1.11.11.1.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="A1.E25.m1.11.11.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E25.m1.11.11.1.1.1.1.1.1.1.3" xref="A1.E25.m1.11.11.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.E25.m1.11.11.1.1.1.1.2" xref="A1.E25.m1.11.11.1.1.1.1.2.cmml">⁢</mo><mi id="A1.E25.m1.11.11.1.1.1.1.3" xref="A1.E25.m1.11.11.1.1.1.1.3.cmml">g</mi><mo id="A1.E25.m1.11.11.1.1.1.1.2a" xref="A1.E25.m1.11.11.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E25.m1.11.11.1.1.1.1.4.2" xref="A1.E25.m1.11.11.1.1.1.1.cmml"><mo id="A1.E25.m1.11.11.1.1.1.1.4.2.1" stretchy="false" xref="A1.E25.m1.11.11.1.1.1.1.cmml">(</mo><mi id="A1.E25.m1.7.7" xref="A1.E25.m1.7.7.cmml">𝐱</mi><mo id="A1.E25.m1.11.11.1.1.1.1.4.2.2" stretchy="false" xref="A1.E25.m1.11.11.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A1.E25.m1.13.13.3.4" xref="A1.E25.m1.13.13.3.4.cmml">−</mo><mrow id="A1.E25.m1.13.13.3.3" xref="A1.E25.m1.13.13.3.3.cmml"><mstyle displaystyle="true" id="A1.E25.m1.4.4" xref="A1.E25.m1.4.4.cmml"><mfrac id="A1.E25.m1.4.4a" xref="A1.E25.m1.4.4.cmml"><mn id="A1.E25.m1.4.4.3" xref="A1.E25.m1.4.4.3.cmml">1</mn><mrow id="A1.E25.m1.4.4.1" xref="A1.E25.m1.4.4.1.cmml"><mi id="A1.E25.m1.4.4.1.3" xref="A1.E25.m1.4.4.1.3.cmml">Z</mi><mo id="A1.E25.m1.4.4.1.2" xref="A1.E25.m1.4.4.1.2.cmml">⁢</mo><mrow id="A1.E25.m1.4.4.1.4.2" xref="A1.E25.m1.4.4.1.4.1.cmml"><mo id="A1.E25.m1.4.4.1.4.2.1" stretchy="false" xref="A1.E25.m1.4.4.1.4.1.1.cmml">[</mo><mi id="A1.E25.m1.4.4.1.1" xref="A1.E25.m1.4.4.1.1.cmml">f</mi><mo id="A1.E25.m1.4.4.1.4.2.2" stretchy="false" xref="A1.E25.m1.4.4.1.4.1.1.cmml">]</mo></mrow></mrow></mfrac></mstyle><mo id="A1.E25.m1.13.13.3.3.3" xref="A1.E25.m1.13.13.3.3.3.cmml">⁢</mo><mrow id="A1.E25.m1.13.13.3.3.2" xref="A1.E25.m1.13.13.3.3.2.cmml"><mstyle displaystyle="true" id="A1.E25.m1.13.13.3.3.2.3" xref="A1.E25.m1.13.13.3.3.2.3.cmml"><munder id="A1.E25.m1.13.13.3.3.2.3a" xref="A1.E25.m1.13.13.3.3.2.3.cmml"><mo id="A1.E25.m1.13.13.3.3.2.3.2" movablelimits="false" xref="A1.E25.m1.13.13.3.3.2.3.2.cmml">∑</mo><mi id="A1.E25.m1.13.13.3.3.2.3.3" xref="A1.E25.m1.13.13.3.3.2.3.3.cmml">𝐱</mi></munder></mstyle><mrow id="A1.E25.m1.13.13.3.3.2.2" xref="A1.E25.m1.13.13.3.3.2.2.cmml"><mrow id="A1.E25.m1.13.13.3.3.2.2.2.2" xref="A1.E25.m1.13.13.3.3.2.2.2.3.cmml"><msup id="A1.E25.m1.12.12.2.2.1.1.1.1.1" xref="A1.E25.m1.12.12.2.2.1.1.1.1.1.cmml"><mi id="A1.E25.m1.12.12.2.2.1.1.1.1.1.2" xref="A1.E25.m1.12.12.2.2.1.1.1.1.1.2.cmml">exp</mi><mo id="A1.E25.m1.12.12.2.2.1.1.1.1.1.3" xref="A1.E25.m1.12.12.2.2.1.1.1.1.1.3.cmml">′</mo></msup><mo id="A1.E25.m1.13.13.3.3.2.2.2.2a" xref="A1.E25.m1.13.13.3.3.2.2.2.3.cmml">⁡</mo><mrow id="A1.E25.m1.13.13.3.3.2.2.2.2.2" xref="A1.E25.m1.13.13.3.3.2.2.2.3.cmml"><mo id="A1.E25.m1.13.13.3.3.2.2.2.2.2.2" xref="A1.E25.m1.13.13.3.3.2.2.2.3.cmml">(</mo><mrow id="A1.E25.m1.13.13.3.3.2.2.2.2.2.1" xref="A1.E25.m1.13.13.3.3.2.2.2.2.2.1.cmml"><mi id="A1.E25.m1.13.13.3.3.2.2.2.2.2.1.2" xref="A1.E25.m1.13.13.3.3.2.2.2.2.2.1.2.cmml">f</mi><mo id="A1.E25.m1.13.13.3.3.2.2.2.2.2.1.1" xref="A1.E25.m1.13.13.3.3.2.2.2.2.2.1.1.cmml">⁢</mo><mrow id="A1.E25.m1.13.13.3.3.2.2.2.2.2.1.3.2" xref="A1.E25.m1.13.13.3.3.2.2.2.2.2.1.cmml"><mo id="A1.E25.m1.13.13.3.3.2.2.2.2.2.1.3.2.1" stretchy="false" xref="A1.E25.m1.13.13.3.3.2.2.2.2.2.1.cmml">(</mo><mi id="A1.E25.m1.8.8" xref="A1.E25.m1.8.8.cmml">𝐱</mi><mo id="A1.E25.m1.13.13.3.3.2.2.2.2.2.1.3.2.2" stretchy="false" xref="A1.E25.m1.13.13.3.3.2.2.2.2.2.1.cmml">)</mo></mrow></mrow><mo id="A1.E25.m1.13.13.3.3.2.2.2.2.2.3" xref="A1.E25.m1.13.13.3.3.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="A1.E25.m1.13.13.3.3.2.2.3" xref="A1.E25.m1.13.13.3.3.2.2.3.cmml">⁢</mo><mi id="A1.E25.m1.13.13.3.3.2.2.4" xref="A1.E25.m1.13.13.3.3.2.2.4.cmml">g</mi><mo id="A1.E25.m1.13.13.3.3.2.2.3a" xref="A1.E25.m1.13.13.3.3.2.2.3.cmml">⁢</mo><mrow id="A1.E25.m1.13.13.3.3.2.2.5.2" xref="A1.E25.m1.13.13.3.3.2.2.cmml"><mo id="A1.E25.m1.13.13.3.3.2.2.5.2.1" stretchy="false" xref="A1.E25.m1.13.13.3.3.2.2.cmml">(</mo><mi id="A1.E25.m1.9.9" xref="A1.E25.m1.9.9.cmml">𝐱</mi><mo id="A1.E25.m1.13.13.3.3.2.2.5.2.2" stretchy="false" xref="A1.E25.m1.13.13.3.3.2.2.cmml">)</mo></mrow><mo id="A1.E25.m1.13.13.3.3.2.2.3b" xref="A1.E25.m1.13.13.3.3.2.2.3.cmml">⁢</mo><mi id="A1.E25.m1.13.13.3.3.2.2.6" xref="A1.E25.m1.13.13.3.3.2.2.6.cmml">h</mi><mo id="A1.E25.m1.13.13.3.3.2.2.3c" xref="A1.E25.m1.13.13.3.3.2.2.3.cmml">⁢</mo><mrow id="A1.E25.m1.13.13.3.3.2.2.7.2" xref="A1.E25.m1.13.13.3.3.2.2.cmml"><mo id="A1.E25.m1.13.13.3.3.2.2.7.2.1" stretchy="false" xref="A1.E25.m1.13.13.3.3.2.2.cmml">(</mo><mi id="A1.E25.m1.10.10" xref="A1.E25.m1.10.10.cmml">𝐱</mi><mo id="A1.E25.m1.13.13.3.3.2.2.7.2.2" stretchy="false" xref="A1.E25.m1.13.13.3.3.2.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E25.m1.13b"><apply id="A1.E25.m1.13.13.cmml" xref="A1.E25.m1.13.13"><eq id="A1.E25.m1.13.13.4.cmml" xref="A1.E25.m1.13.13.4"></eq><csymbol cd="latexml" id="A1.E25.m1.13.13.5.cmml" xref="A1.E25.m1.13.13.5">absent</csymbol><apply id="A1.E25.m1.13.13.3.cmml" xref="A1.E25.m1.13.13.3"><minus id="A1.E25.m1.13.13.3.4.cmml" xref="A1.E25.m1.13.13.3.4"></minus><apply id="A1.E25.m1.11.11.1.1.cmml" xref="A1.E25.m1.11.11.1.1"><times id="A1.E25.m1.11.11.1.1.2.cmml" xref="A1.E25.m1.11.11.1.1.2"></times><apply id="A1.E25.m1.3.3.cmml" xref="A1.E25.m1.3.3"><divide id="A1.E25.m1.3.3.4.cmml" xref="A1.E25.m1.3.3"></divide><apply id="A1.E25.m1.2.2.2.cmml" xref="A1.E25.m1.2.2.2"><times id="A1.E25.m1.2.2.2.3.cmml" xref="A1.E25.m1.2.2.2.3"></times><ci id="A1.E25.m1.2.2.2.4.cmml" xref="A1.E25.m1.2.2.2.4">𝛿</ci><ci id="A1.E25.m1.2.2.2.5.cmml" xref="A1.E25.m1.2.2.2.5">𝑍</ci><list id="A1.E25.m1.2.2.2.6.1.cmml" xref="A1.E25.m1.2.2.2.6.2"><ci id="A1.E25.m1.1.1.1.1.cmml" xref="A1.E25.m1.1.1.1.1">𝑓</ci><ci id="A1.E25.m1.2.2.2.2.cmml" xref="A1.E25.m1.2.2.2.2">ℎ</ci></list></apply><apply id="A1.E25.m1.3.3.3.cmml" xref="A1.E25.m1.3.3.3"><times id="A1.E25.m1.3.3.3.2.cmml" xref="A1.E25.m1.3.3.3.2"></times><apply id="A1.E25.m1.3.3.3.3.cmml" xref="A1.E25.m1.3.3.3.3"><csymbol cd="ambiguous" id="A1.E25.m1.3.3.3.3.1.cmml" xref="A1.E25.m1.3.3.3.3">superscript</csymbol><ci id="A1.E25.m1.3.3.3.3.2.cmml" xref="A1.E25.m1.3.3.3.3.2">𝑍</ci><cn id="A1.E25.m1.3.3.3.3.3.cmml" type="integer" xref="A1.E25.m1.3.3.3.3.3">2</cn></apply><apply id="A1.E25.m1.3.3.3.4.1.cmml" xref="A1.E25.m1.3.3.3.4.2"><csymbol cd="latexml" id="A1.E25.m1.3.3.3.4.1.1.cmml" xref="A1.E25.m1.3.3.3.4.2.1">delimited-[]</csymbol><ci id="A1.E25.m1.3.3.3.1.cmml" xref="A1.E25.m1.3.3.3.1">𝑓</ci></apply></apply></apply><apply id="A1.E25.m1.11.11.1.1.1.cmml" xref="A1.E25.m1.11.11.1.1.1"><apply id="A1.E25.m1.11.11.1.1.1.2.cmml" xref="A1.E25.m1.11.11.1.1.1.2"><csymbol cd="ambiguous" id="A1.E25.m1.11.11.1.1.1.2.1.cmml" xref="A1.E25.m1.11.11.1.1.1.2">subscript</csymbol><sum id="A1.E25.m1.11.11.1.1.1.2.2.cmml" xref="A1.E25.m1.11.11.1.1.1.2.2"></sum><ci id="A1.E25.m1.11.11.1.1.1.2.3.cmml" xref="A1.E25.m1.11.11.1.1.1.2.3">𝐱</ci></apply><apply id="A1.E25.m1.11.11.1.1.1.1.cmml" xref="A1.E25.m1.11.11.1.1.1.1"><times id="A1.E25.m1.11.11.1.1.1.1.2.cmml" xref="A1.E25.m1.11.11.1.1.1.1.2"></times><apply id="A1.E25.m1.11.11.1.1.1.1.1.2.cmml" xref="A1.E25.m1.11.11.1.1.1.1.1.1"><exp id="A1.E25.m1.6.6.cmml" xref="A1.E25.m1.6.6"></exp><apply id="A1.E25.m1.11.11.1.1.1.1.1.1.1.1.cmml" xref="A1.E25.m1.11.11.1.1.1.1.1.1.1.1"><times id="A1.E25.m1.11.11.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E25.m1.11.11.1.1.1.1.1.1.1.1.1"></times><ci id="A1.E25.m1.11.11.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E25.m1.11.11.1.1.1.1.1.1.1.1.2">𝑓</ci><ci id="A1.E25.m1.5.5.cmml" xref="A1.E25.m1.5.5">𝐱</ci></apply></apply><ci id="A1.E25.m1.11.11.1.1.1.1.3.cmml" xref="A1.E25.m1.11.11.1.1.1.1.3">𝑔</ci><ci id="A1.E25.m1.7.7.cmml" xref="A1.E25.m1.7.7">𝐱</ci></apply></apply></apply><apply id="A1.E25.m1.13.13.3.3.cmml" xref="A1.E25.m1.13.13.3.3"><times id="A1.E25.m1.13.13.3.3.3.cmml" xref="A1.E25.m1.13.13.3.3.3"></times><apply id="A1.E25.m1.4.4.cmml" xref="A1.E25.m1.4.4"><divide id="A1.E25.m1.4.4.2.cmml" xref="A1.E25.m1.4.4"></divide><cn id="A1.E25.m1.4.4.3.cmml" type="integer" xref="A1.E25.m1.4.4.3">1</cn><apply id="A1.E25.m1.4.4.1.cmml" xref="A1.E25.m1.4.4.1"><times id="A1.E25.m1.4.4.1.2.cmml" xref="A1.E25.m1.4.4.1.2"></times><ci id="A1.E25.m1.4.4.1.3.cmml" xref="A1.E25.m1.4.4.1.3">𝑍</ci><apply id="A1.E25.m1.4.4.1.4.1.cmml" xref="A1.E25.m1.4.4.1.4.2"><csymbol cd="latexml" id="A1.E25.m1.4.4.1.4.1.1.cmml" xref="A1.E25.m1.4.4.1.4.2.1">delimited-[]</csymbol><ci id="A1.E25.m1.4.4.1.1.cmml" xref="A1.E25.m1.4.4.1.1">𝑓</ci></apply></apply></apply><apply id="A1.E25.m1.13.13.3.3.2.cmml" xref="A1.E25.m1.13.13.3.3.2"><apply id="A1.E25.m1.13.13.3.3.2.3.cmml" xref="A1.E25.m1.13.13.3.3.2.3"><csymbol cd="ambiguous" id="A1.E25.m1.13.13.3.3.2.3.1.cmml" xref="A1.E25.m1.13.13.3.3.2.3">subscript</csymbol><sum id="A1.E25.m1.13.13.3.3.2.3.2.cmml" xref="A1.E25.m1.13.13.3.3.2.3.2"></sum><ci id="A1.E25.m1.13.13.3.3.2.3.3.cmml" xref="A1.E25.m1.13.13.3.3.2.3.3">𝐱</ci></apply><apply id="A1.E25.m1.13.13.3.3.2.2.cmml" xref="A1.E25.m1.13.13.3.3.2.2"><times id="A1.E25.m1.13.13.3.3.2.2.3.cmml" xref="A1.E25.m1.13.13.3.3.2.2.3"></times><apply id="A1.E25.m1.13.13.3.3.2.2.2.3.cmml" xref="A1.E25.m1.13.13.3.3.2.2.2.2"><apply id="A1.E25.m1.12.12.2.2.1.1.1.1.1.cmml" xref="A1.E25.m1.12.12.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E25.m1.12.12.2.2.1.1.1.1.1.1.cmml" xref="A1.E25.m1.12.12.2.2.1.1.1.1.1">superscript</csymbol><exp id="A1.E25.m1.12.12.2.2.1.1.1.1.1.2.cmml" xref="A1.E25.m1.12.12.2.2.1.1.1.1.1.2"></exp><ci id="A1.E25.m1.12.12.2.2.1.1.1.1.1.3.cmml" xref="A1.E25.m1.12.12.2.2.1.1.1.1.1.3">′</ci></apply><apply id="A1.E25.m1.13.13.3.3.2.2.2.2.2.1.cmml" xref="A1.E25.m1.13.13.3.3.2.2.2.2.2.1"><times id="A1.E25.m1.13.13.3.3.2.2.2.2.2.1.1.cmml" xref="A1.E25.m1.13.13.3.3.2.2.2.2.2.1.1"></times><ci id="A1.E25.m1.13.13.3.3.2.2.2.2.2.1.2.cmml" xref="A1.E25.m1.13.13.3.3.2.2.2.2.2.1.2">𝑓</ci><ci id="A1.E25.m1.8.8.cmml" xref="A1.E25.m1.8.8">𝐱</ci></apply></apply><ci id="A1.E25.m1.13.13.3.3.2.2.4.cmml" xref="A1.E25.m1.13.13.3.3.2.2.4">𝑔</ci><ci id="A1.E25.m1.9.9.cmml" xref="A1.E25.m1.9.9">𝐱</ci><ci id="A1.E25.m1.13.13.3.3.2.2.6.cmml" xref="A1.E25.m1.13.13.3.3.2.2.6">ℎ</ci><ci id="A1.E25.m1.10.10.cmml" xref="A1.E25.m1.10.10">𝐱</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E25.m1.13c">\displaystyle=\frac{\delta Z[f;h]}{Z^{2}[f]}\sum_{\mathbf{x}}\exp\left(f(%
\mathbf{x})\right)g(\mathbf{x})-\frac{1}{{Z[f]}}\sum_{\mathbf{x}}\exp^{\prime}%
\left(f(\mathbf{x})\right)g(\mathbf{x})h(\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="A1.E25.m1.13d">= divide start_ARG italic_δ italic_Z [ italic_f ; italic_h ] end_ARG start_ARG italic_Z start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT [ italic_f ] end_ARG ∑ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT roman_exp ( italic_f ( bold_x ) ) italic_g ( bold_x ) - divide start_ARG 1 end_ARG start_ARG italic_Z [ italic_f ] end_ARG ∑ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT roman_exp start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_f ( bold_x ) ) italic_g ( bold_x ) italic_h ( bold_x )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(25)</span></td>
</tr></tbody>
<tbody id="A1.E26"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{\delta Z[f;h]}{Z[f]}\cdot\mathbb{E}_{\mathbf{x}\sim q_{f}}%
g(\mathbf{x})-\frac{1}{{Z[f]}}\sum_{\mathbf{x}}\exp\left(f(\mathbf{x})\right)g%
(\mathbf{x})h(\mathbf{x})" class="ltx_Math" display="inline" id="A1.E26.m1.10"><semantics id="A1.E26.m1.10a"><mrow id="A1.E26.m1.10.10" xref="A1.E26.m1.10.10.cmml"><mi id="A1.E26.m1.10.10.3" xref="A1.E26.m1.10.10.3.cmml"></mi><mo id="A1.E26.m1.10.10.2" xref="A1.E26.m1.10.10.2.cmml">=</mo><mrow id="A1.E26.m1.10.10.1" xref="A1.E26.m1.10.10.1.cmml"><mrow id="A1.E26.m1.10.10.1.3" xref="A1.E26.m1.10.10.1.3.cmml"><mrow id="A1.E26.m1.10.10.1.3.2" xref="A1.E26.m1.10.10.1.3.2.cmml"><mstyle displaystyle="true" id="A1.E26.m1.3.3" xref="A1.E26.m1.3.3.cmml"><mfrac id="A1.E26.m1.3.3a" xref="A1.E26.m1.3.3.cmml"><mrow id="A1.E26.m1.2.2.2" xref="A1.E26.m1.2.2.2.cmml"><mi id="A1.E26.m1.2.2.2.4" xref="A1.E26.m1.2.2.2.4.cmml">δ</mi><mo id="A1.E26.m1.2.2.2.3" xref="A1.E26.m1.2.2.2.3.cmml">⁢</mo><mi id="A1.E26.m1.2.2.2.5" xref="A1.E26.m1.2.2.2.5.cmml">Z</mi><mo id="A1.E26.m1.2.2.2.3a" xref="A1.E26.m1.2.2.2.3.cmml">⁢</mo><mrow id="A1.E26.m1.2.2.2.6.2" xref="A1.E26.m1.2.2.2.6.1.cmml"><mo id="A1.E26.m1.2.2.2.6.2.1" stretchy="false" xref="A1.E26.m1.2.2.2.6.1.cmml">[</mo><mi id="A1.E26.m1.1.1.1.1" xref="A1.E26.m1.1.1.1.1.cmml">f</mi><mo id="A1.E26.m1.2.2.2.6.2.2" xref="A1.E26.m1.2.2.2.6.1.cmml">;</mo><mi id="A1.E26.m1.2.2.2.2" xref="A1.E26.m1.2.2.2.2.cmml">h</mi><mo id="A1.E26.m1.2.2.2.6.2.3" stretchy="false" xref="A1.E26.m1.2.2.2.6.1.cmml">]</mo></mrow></mrow><mrow id="A1.E26.m1.3.3.3" xref="A1.E26.m1.3.3.3.cmml"><mi id="A1.E26.m1.3.3.3.3" xref="A1.E26.m1.3.3.3.3.cmml">Z</mi><mo id="A1.E26.m1.3.3.3.2" xref="A1.E26.m1.3.3.3.2.cmml">⁢</mo><mrow id="A1.E26.m1.3.3.3.4.2" xref="A1.E26.m1.3.3.3.4.1.cmml"><mo id="A1.E26.m1.3.3.3.4.2.1" stretchy="false" xref="A1.E26.m1.3.3.3.4.1.1.cmml">[</mo><mi id="A1.E26.m1.3.3.3.1" xref="A1.E26.m1.3.3.3.1.cmml">f</mi><mo id="A1.E26.m1.3.3.3.4.2.2" stretchy="false" xref="A1.E26.m1.3.3.3.4.1.1.cmml">]</mo></mrow></mrow></mfrac></mstyle><mo id="A1.E26.m1.10.10.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="A1.E26.m1.10.10.1.3.2.1.cmml">⋅</mo><msub id="A1.E26.m1.10.10.1.3.2.2" xref="A1.E26.m1.10.10.1.3.2.2.cmml"><mi id="A1.E26.m1.10.10.1.3.2.2.2" xref="A1.E26.m1.10.10.1.3.2.2.2.cmml">𝔼</mi><mrow id="A1.E26.m1.10.10.1.3.2.2.3" xref="A1.E26.m1.10.10.1.3.2.2.3.cmml"><mi id="A1.E26.m1.10.10.1.3.2.2.3.2" xref="A1.E26.m1.10.10.1.3.2.2.3.2.cmml">𝐱</mi><mo id="A1.E26.m1.10.10.1.3.2.2.3.1" xref="A1.E26.m1.10.10.1.3.2.2.3.1.cmml">∼</mo><msub id="A1.E26.m1.10.10.1.3.2.2.3.3" xref="A1.E26.m1.10.10.1.3.2.2.3.3.cmml"><mi id="A1.E26.m1.10.10.1.3.2.2.3.3.2" xref="A1.E26.m1.10.10.1.3.2.2.3.3.2.cmml">q</mi><mi id="A1.E26.m1.10.10.1.3.2.2.3.3.3" xref="A1.E26.m1.10.10.1.3.2.2.3.3.3.cmml">f</mi></msub></mrow></msub></mrow><mo id="A1.E26.m1.10.10.1.3.1" xref="A1.E26.m1.10.10.1.3.1.cmml">⁢</mo><mi id="A1.E26.m1.10.10.1.3.3" xref="A1.E26.m1.10.10.1.3.3.cmml">g</mi><mo id="A1.E26.m1.10.10.1.3.1a" xref="A1.E26.m1.10.10.1.3.1.cmml">⁢</mo><mrow id="A1.E26.m1.10.10.1.3.4.2" xref="A1.E26.m1.10.10.1.3.cmml"><mo id="A1.E26.m1.10.10.1.3.4.2.1" stretchy="false" xref="A1.E26.m1.10.10.1.3.cmml">(</mo><mi id="A1.E26.m1.5.5" xref="A1.E26.m1.5.5.cmml">𝐱</mi><mo id="A1.E26.m1.10.10.1.3.4.2.2" stretchy="false" xref="A1.E26.m1.10.10.1.3.cmml">)</mo></mrow></mrow><mo id="A1.E26.m1.10.10.1.2" xref="A1.E26.m1.10.10.1.2.cmml">−</mo><mrow id="A1.E26.m1.10.10.1.1" xref="A1.E26.m1.10.10.1.1.cmml"><mstyle displaystyle="true" id="A1.E26.m1.4.4" xref="A1.E26.m1.4.4.cmml"><mfrac id="A1.E26.m1.4.4a" xref="A1.E26.m1.4.4.cmml"><mn id="A1.E26.m1.4.4.3" xref="A1.E26.m1.4.4.3.cmml">1</mn><mrow id="A1.E26.m1.4.4.1" xref="A1.E26.m1.4.4.1.cmml"><mi id="A1.E26.m1.4.4.1.3" xref="A1.E26.m1.4.4.1.3.cmml">Z</mi><mo id="A1.E26.m1.4.4.1.2" xref="A1.E26.m1.4.4.1.2.cmml">⁢</mo><mrow id="A1.E26.m1.4.4.1.4.2" xref="A1.E26.m1.4.4.1.4.1.cmml"><mo id="A1.E26.m1.4.4.1.4.2.1" stretchy="false" xref="A1.E26.m1.4.4.1.4.1.1.cmml">[</mo><mi id="A1.E26.m1.4.4.1.1" xref="A1.E26.m1.4.4.1.1.cmml">f</mi><mo id="A1.E26.m1.4.4.1.4.2.2" stretchy="false" xref="A1.E26.m1.4.4.1.4.1.1.cmml">]</mo></mrow></mrow></mfrac></mstyle><mo id="A1.E26.m1.10.10.1.1.2" xref="A1.E26.m1.10.10.1.1.2.cmml">⁢</mo><mrow id="A1.E26.m1.10.10.1.1.1" xref="A1.E26.m1.10.10.1.1.1.cmml"><mstyle displaystyle="true" id="A1.E26.m1.10.10.1.1.1.2" xref="A1.E26.m1.10.10.1.1.1.2.cmml"><munder id="A1.E26.m1.10.10.1.1.1.2a" xref="A1.E26.m1.10.10.1.1.1.2.cmml"><mo id="A1.E26.m1.10.10.1.1.1.2.2" movablelimits="false" xref="A1.E26.m1.10.10.1.1.1.2.2.cmml">∑</mo><mi id="A1.E26.m1.10.10.1.1.1.2.3" xref="A1.E26.m1.10.10.1.1.1.2.3.cmml">𝐱</mi></munder></mstyle><mrow id="A1.E26.m1.10.10.1.1.1.1" xref="A1.E26.m1.10.10.1.1.1.1.cmml"><mrow id="A1.E26.m1.10.10.1.1.1.1.1.1" xref="A1.E26.m1.10.10.1.1.1.1.1.2.cmml"><mi id="A1.E26.m1.7.7" xref="A1.E26.m1.7.7.cmml">exp</mi><mo id="A1.E26.m1.10.10.1.1.1.1.1.1a" xref="A1.E26.m1.10.10.1.1.1.1.1.2.cmml">⁡</mo><mrow id="A1.E26.m1.10.10.1.1.1.1.1.1.1" xref="A1.E26.m1.10.10.1.1.1.1.1.2.cmml"><mo id="A1.E26.m1.10.10.1.1.1.1.1.1.1.2" xref="A1.E26.m1.10.10.1.1.1.1.1.2.cmml">(</mo><mrow id="A1.E26.m1.10.10.1.1.1.1.1.1.1.1" xref="A1.E26.m1.10.10.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E26.m1.10.10.1.1.1.1.1.1.1.1.2" xref="A1.E26.m1.10.10.1.1.1.1.1.1.1.1.2.cmml">f</mi><mo id="A1.E26.m1.10.10.1.1.1.1.1.1.1.1.1" xref="A1.E26.m1.10.10.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="A1.E26.m1.10.10.1.1.1.1.1.1.1.1.3.2" xref="A1.E26.m1.10.10.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E26.m1.10.10.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="A1.E26.m1.10.10.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="A1.E26.m1.6.6" xref="A1.E26.m1.6.6.cmml">𝐱</mi><mo id="A1.E26.m1.10.10.1.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="A1.E26.m1.10.10.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E26.m1.10.10.1.1.1.1.1.1.1.3" xref="A1.E26.m1.10.10.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.E26.m1.10.10.1.1.1.1.2" xref="A1.E26.m1.10.10.1.1.1.1.2.cmml">⁢</mo><mi id="A1.E26.m1.10.10.1.1.1.1.3" xref="A1.E26.m1.10.10.1.1.1.1.3.cmml">g</mi><mo id="A1.E26.m1.10.10.1.1.1.1.2a" xref="A1.E26.m1.10.10.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E26.m1.10.10.1.1.1.1.4.2" xref="A1.E26.m1.10.10.1.1.1.1.cmml"><mo id="A1.E26.m1.10.10.1.1.1.1.4.2.1" stretchy="false" xref="A1.E26.m1.10.10.1.1.1.1.cmml">(</mo><mi id="A1.E26.m1.8.8" xref="A1.E26.m1.8.8.cmml">𝐱</mi><mo id="A1.E26.m1.10.10.1.1.1.1.4.2.2" stretchy="false" xref="A1.E26.m1.10.10.1.1.1.1.cmml">)</mo></mrow><mo id="A1.E26.m1.10.10.1.1.1.1.2b" xref="A1.E26.m1.10.10.1.1.1.1.2.cmml">⁢</mo><mi id="A1.E26.m1.10.10.1.1.1.1.5" xref="A1.E26.m1.10.10.1.1.1.1.5.cmml">h</mi><mo id="A1.E26.m1.10.10.1.1.1.1.2c" xref="A1.E26.m1.10.10.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E26.m1.10.10.1.1.1.1.6.2" xref="A1.E26.m1.10.10.1.1.1.1.cmml"><mo id="A1.E26.m1.10.10.1.1.1.1.6.2.1" stretchy="false" xref="A1.E26.m1.10.10.1.1.1.1.cmml">(</mo><mi id="A1.E26.m1.9.9" xref="A1.E26.m1.9.9.cmml">𝐱</mi><mo id="A1.E26.m1.10.10.1.1.1.1.6.2.2" stretchy="false" xref="A1.E26.m1.10.10.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E26.m1.10b"><apply id="A1.E26.m1.10.10.cmml" xref="A1.E26.m1.10.10"><eq id="A1.E26.m1.10.10.2.cmml" xref="A1.E26.m1.10.10.2"></eq><csymbol cd="latexml" id="A1.E26.m1.10.10.3.cmml" xref="A1.E26.m1.10.10.3">absent</csymbol><apply id="A1.E26.m1.10.10.1.cmml" xref="A1.E26.m1.10.10.1"><minus id="A1.E26.m1.10.10.1.2.cmml" xref="A1.E26.m1.10.10.1.2"></minus><apply id="A1.E26.m1.10.10.1.3.cmml" xref="A1.E26.m1.10.10.1.3"><times id="A1.E26.m1.10.10.1.3.1.cmml" xref="A1.E26.m1.10.10.1.3.1"></times><apply id="A1.E26.m1.10.10.1.3.2.cmml" xref="A1.E26.m1.10.10.1.3.2"><ci id="A1.E26.m1.10.10.1.3.2.1.cmml" xref="A1.E26.m1.10.10.1.3.2.1">⋅</ci><apply id="A1.E26.m1.3.3.cmml" xref="A1.E26.m1.3.3"><divide id="A1.E26.m1.3.3.4.cmml" xref="A1.E26.m1.3.3"></divide><apply id="A1.E26.m1.2.2.2.cmml" xref="A1.E26.m1.2.2.2"><times id="A1.E26.m1.2.2.2.3.cmml" xref="A1.E26.m1.2.2.2.3"></times><ci id="A1.E26.m1.2.2.2.4.cmml" xref="A1.E26.m1.2.2.2.4">𝛿</ci><ci id="A1.E26.m1.2.2.2.5.cmml" xref="A1.E26.m1.2.2.2.5">𝑍</ci><list id="A1.E26.m1.2.2.2.6.1.cmml" xref="A1.E26.m1.2.2.2.6.2"><ci id="A1.E26.m1.1.1.1.1.cmml" xref="A1.E26.m1.1.1.1.1">𝑓</ci><ci id="A1.E26.m1.2.2.2.2.cmml" xref="A1.E26.m1.2.2.2.2">ℎ</ci></list></apply><apply id="A1.E26.m1.3.3.3.cmml" xref="A1.E26.m1.3.3.3"><times id="A1.E26.m1.3.3.3.2.cmml" xref="A1.E26.m1.3.3.3.2"></times><ci id="A1.E26.m1.3.3.3.3.cmml" xref="A1.E26.m1.3.3.3.3">𝑍</ci><apply id="A1.E26.m1.3.3.3.4.1.cmml" xref="A1.E26.m1.3.3.3.4.2"><csymbol cd="latexml" id="A1.E26.m1.3.3.3.4.1.1.cmml" xref="A1.E26.m1.3.3.3.4.2.1">delimited-[]</csymbol><ci id="A1.E26.m1.3.3.3.1.cmml" xref="A1.E26.m1.3.3.3.1">𝑓</ci></apply></apply></apply><apply id="A1.E26.m1.10.10.1.3.2.2.cmml" xref="A1.E26.m1.10.10.1.3.2.2"><csymbol cd="ambiguous" id="A1.E26.m1.10.10.1.3.2.2.1.cmml" xref="A1.E26.m1.10.10.1.3.2.2">subscript</csymbol><ci id="A1.E26.m1.10.10.1.3.2.2.2.cmml" xref="A1.E26.m1.10.10.1.3.2.2.2">𝔼</ci><apply id="A1.E26.m1.10.10.1.3.2.2.3.cmml" xref="A1.E26.m1.10.10.1.3.2.2.3"><csymbol cd="latexml" id="A1.E26.m1.10.10.1.3.2.2.3.1.cmml" xref="A1.E26.m1.10.10.1.3.2.2.3.1">similar-to</csymbol><ci id="A1.E26.m1.10.10.1.3.2.2.3.2.cmml" xref="A1.E26.m1.10.10.1.3.2.2.3.2">𝐱</ci><apply id="A1.E26.m1.10.10.1.3.2.2.3.3.cmml" xref="A1.E26.m1.10.10.1.3.2.2.3.3"><csymbol cd="ambiguous" id="A1.E26.m1.10.10.1.3.2.2.3.3.1.cmml" xref="A1.E26.m1.10.10.1.3.2.2.3.3">subscript</csymbol><ci id="A1.E26.m1.10.10.1.3.2.2.3.3.2.cmml" xref="A1.E26.m1.10.10.1.3.2.2.3.3.2">𝑞</ci><ci id="A1.E26.m1.10.10.1.3.2.2.3.3.3.cmml" xref="A1.E26.m1.10.10.1.3.2.2.3.3.3">𝑓</ci></apply></apply></apply></apply><ci id="A1.E26.m1.10.10.1.3.3.cmml" xref="A1.E26.m1.10.10.1.3.3">𝑔</ci><ci id="A1.E26.m1.5.5.cmml" xref="A1.E26.m1.5.5">𝐱</ci></apply><apply id="A1.E26.m1.10.10.1.1.cmml" xref="A1.E26.m1.10.10.1.1"><times id="A1.E26.m1.10.10.1.1.2.cmml" xref="A1.E26.m1.10.10.1.1.2"></times><apply id="A1.E26.m1.4.4.cmml" xref="A1.E26.m1.4.4"><divide id="A1.E26.m1.4.4.2.cmml" xref="A1.E26.m1.4.4"></divide><cn id="A1.E26.m1.4.4.3.cmml" type="integer" xref="A1.E26.m1.4.4.3">1</cn><apply id="A1.E26.m1.4.4.1.cmml" xref="A1.E26.m1.4.4.1"><times id="A1.E26.m1.4.4.1.2.cmml" xref="A1.E26.m1.4.4.1.2"></times><ci id="A1.E26.m1.4.4.1.3.cmml" xref="A1.E26.m1.4.4.1.3">𝑍</ci><apply id="A1.E26.m1.4.4.1.4.1.cmml" xref="A1.E26.m1.4.4.1.4.2"><csymbol cd="latexml" id="A1.E26.m1.4.4.1.4.1.1.cmml" xref="A1.E26.m1.4.4.1.4.2.1">delimited-[]</csymbol><ci id="A1.E26.m1.4.4.1.1.cmml" xref="A1.E26.m1.4.4.1.1">𝑓</ci></apply></apply></apply><apply id="A1.E26.m1.10.10.1.1.1.cmml" xref="A1.E26.m1.10.10.1.1.1"><apply id="A1.E26.m1.10.10.1.1.1.2.cmml" xref="A1.E26.m1.10.10.1.1.1.2"><csymbol cd="ambiguous" id="A1.E26.m1.10.10.1.1.1.2.1.cmml" xref="A1.E26.m1.10.10.1.1.1.2">subscript</csymbol><sum id="A1.E26.m1.10.10.1.1.1.2.2.cmml" xref="A1.E26.m1.10.10.1.1.1.2.2"></sum><ci id="A1.E26.m1.10.10.1.1.1.2.3.cmml" xref="A1.E26.m1.10.10.1.1.1.2.3">𝐱</ci></apply><apply id="A1.E26.m1.10.10.1.1.1.1.cmml" xref="A1.E26.m1.10.10.1.1.1.1"><times id="A1.E26.m1.10.10.1.1.1.1.2.cmml" xref="A1.E26.m1.10.10.1.1.1.1.2"></times><apply id="A1.E26.m1.10.10.1.1.1.1.1.2.cmml" xref="A1.E26.m1.10.10.1.1.1.1.1.1"><exp id="A1.E26.m1.7.7.cmml" xref="A1.E26.m1.7.7"></exp><apply id="A1.E26.m1.10.10.1.1.1.1.1.1.1.1.cmml" xref="A1.E26.m1.10.10.1.1.1.1.1.1.1.1"><times id="A1.E26.m1.10.10.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E26.m1.10.10.1.1.1.1.1.1.1.1.1"></times><ci id="A1.E26.m1.10.10.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E26.m1.10.10.1.1.1.1.1.1.1.1.2">𝑓</ci><ci id="A1.E26.m1.6.6.cmml" xref="A1.E26.m1.6.6">𝐱</ci></apply></apply><ci id="A1.E26.m1.10.10.1.1.1.1.3.cmml" xref="A1.E26.m1.10.10.1.1.1.1.3">𝑔</ci><ci id="A1.E26.m1.8.8.cmml" xref="A1.E26.m1.8.8">𝐱</ci><ci id="A1.E26.m1.10.10.1.1.1.1.5.cmml" xref="A1.E26.m1.10.10.1.1.1.1.5">ℎ</ci><ci id="A1.E26.m1.9.9.cmml" xref="A1.E26.m1.9.9">𝐱</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E26.m1.10c">\displaystyle=\frac{\delta Z[f;h]}{Z[f]}\cdot\mathbb{E}_{\mathbf{x}\sim q_{f}}%
g(\mathbf{x})-\frac{1}{{Z[f]}}\sum_{\mathbf{x}}\exp\left(f(\mathbf{x})\right)g%
(\mathbf{x})h(\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="A1.E26.m1.10d">= divide start_ARG italic_δ italic_Z [ italic_f ; italic_h ] end_ARG start_ARG italic_Z [ italic_f ] end_ARG ⋅ blackboard_E start_POSTSUBSCRIPT bold_x ∼ italic_q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_g ( bold_x ) - divide start_ARG 1 end_ARG start_ARG italic_Z [ italic_f ] end_ARG ∑ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT roman_exp ( italic_f ( bold_x ) ) italic_g ( bold_x ) italic_h ( bold_x )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(26)</span></td>
</tr></tbody>
<tbody id="A1.E27"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbb{E}_{\mathbf{x}\sim q_{f}}h(\mathbf{x})\cdot\mathbb{E}_{%
\mathbf{x}\sim q_{f}}g(\mathbf{x})-\mathbb{E}_{\mathbf{x}\sim q_{f}}h(\mathbf{%
x})g(\mathbf{x})" class="ltx_Math" display="inline" id="A1.E27.m1.4"><semantics id="A1.E27.m1.4a"><mrow id="A1.E27.m1.4.5" xref="A1.E27.m1.4.5.cmml"><mi id="A1.E27.m1.4.5.2" xref="A1.E27.m1.4.5.2.cmml"></mi><mo id="A1.E27.m1.4.5.1" xref="A1.E27.m1.4.5.1.cmml">=</mo><mrow id="A1.E27.m1.4.5.3" xref="A1.E27.m1.4.5.3.cmml"><mrow id="A1.E27.m1.4.5.3.2" xref="A1.E27.m1.4.5.3.2.cmml"><mrow id="A1.E27.m1.4.5.3.2.2" xref="A1.E27.m1.4.5.3.2.2.cmml"><mrow id="A1.E27.m1.4.5.3.2.2.2" xref="A1.E27.m1.4.5.3.2.2.2.cmml"><msub id="A1.E27.m1.4.5.3.2.2.2.2" xref="A1.E27.m1.4.5.3.2.2.2.2.cmml"><mi id="A1.E27.m1.4.5.3.2.2.2.2.2" xref="A1.E27.m1.4.5.3.2.2.2.2.2.cmml">𝔼</mi><mrow id="A1.E27.m1.4.5.3.2.2.2.2.3" xref="A1.E27.m1.4.5.3.2.2.2.2.3.cmml"><mi id="A1.E27.m1.4.5.3.2.2.2.2.3.2" xref="A1.E27.m1.4.5.3.2.2.2.2.3.2.cmml">𝐱</mi><mo id="A1.E27.m1.4.5.3.2.2.2.2.3.1" xref="A1.E27.m1.4.5.3.2.2.2.2.3.1.cmml">∼</mo><msub id="A1.E27.m1.4.5.3.2.2.2.2.3.3" xref="A1.E27.m1.4.5.3.2.2.2.2.3.3.cmml"><mi id="A1.E27.m1.4.5.3.2.2.2.2.3.3.2" xref="A1.E27.m1.4.5.3.2.2.2.2.3.3.2.cmml">q</mi><mi id="A1.E27.m1.4.5.3.2.2.2.2.3.3.3" xref="A1.E27.m1.4.5.3.2.2.2.2.3.3.3.cmml">f</mi></msub></mrow></msub><mo id="A1.E27.m1.4.5.3.2.2.2.1" xref="A1.E27.m1.4.5.3.2.2.2.1.cmml">⁢</mo><mi id="A1.E27.m1.4.5.3.2.2.2.3" xref="A1.E27.m1.4.5.3.2.2.2.3.cmml">h</mi><mo id="A1.E27.m1.4.5.3.2.2.2.1a" xref="A1.E27.m1.4.5.3.2.2.2.1.cmml">⁢</mo><mrow id="A1.E27.m1.4.5.3.2.2.2.4.2" xref="A1.E27.m1.4.5.3.2.2.2.cmml"><mo id="A1.E27.m1.4.5.3.2.2.2.4.2.1" stretchy="false" xref="A1.E27.m1.4.5.3.2.2.2.cmml">(</mo><mi id="A1.E27.m1.1.1" xref="A1.E27.m1.1.1.cmml">𝐱</mi><mo id="A1.E27.m1.4.5.3.2.2.2.4.2.2" rspace="0.055em" stretchy="false" xref="A1.E27.m1.4.5.3.2.2.2.cmml">)</mo></mrow></mrow><mo id="A1.E27.m1.4.5.3.2.2.1" rspace="0.222em" xref="A1.E27.m1.4.5.3.2.2.1.cmml">⋅</mo><msub id="A1.E27.m1.4.5.3.2.2.3" xref="A1.E27.m1.4.5.3.2.2.3.cmml"><mi id="A1.E27.m1.4.5.3.2.2.3.2" xref="A1.E27.m1.4.5.3.2.2.3.2.cmml">𝔼</mi><mrow id="A1.E27.m1.4.5.3.2.2.3.3" xref="A1.E27.m1.4.5.3.2.2.3.3.cmml"><mi id="A1.E27.m1.4.5.3.2.2.3.3.2" xref="A1.E27.m1.4.5.3.2.2.3.3.2.cmml">𝐱</mi><mo id="A1.E27.m1.4.5.3.2.2.3.3.1" xref="A1.E27.m1.4.5.3.2.2.3.3.1.cmml">∼</mo><msub id="A1.E27.m1.4.5.3.2.2.3.3.3" xref="A1.E27.m1.4.5.3.2.2.3.3.3.cmml"><mi id="A1.E27.m1.4.5.3.2.2.3.3.3.2" xref="A1.E27.m1.4.5.3.2.2.3.3.3.2.cmml">q</mi><mi id="A1.E27.m1.4.5.3.2.2.3.3.3.3" xref="A1.E27.m1.4.5.3.2.2.3.3.3.3.cmml">f</mi></msub></mrow></msub></mrow><mo id="A1.E27.m1.4.5.3.2.1" xref="A1.E27.m1.4.5.3.2.1.cmml">⁢</mo><mi id="A1.E27.m1.4.5.3.2.3" xref="A1.E27.m1.4.5.3.2.3.cmml">g</mi><mo id="A1.E27.m1.4.5.3.2.1a" xref="A1.E27.m1.4.5.3.2.1.cmml">⁢</mo><mrow id="A1.E27.m1.4.5.3.2.4.2" xref="A1.E27.m1.4.5.3.2.cmml"><mo id="A1.E27.m1.4.5.3.2.4.2.1" stretchy="false" xref="A1.E27.m1.4.5.3.2.cmml">(</mo><mi id="A1.E27.m1.2.2" xref="A1.E27.m1.2.2.cmml">𝐱</mi><mo id="A1.E27.m1.4.5.3.2.4.2.2" stretchy="false" xref="A1.E27.m1.4.5.3.2.cmml">)</mo></mrow></mrow><mo id="A1.E27.m1.4.5.3.1" xref="A1.E27.m1.4.5.3.1.cmml">−</mo><mrow id="A1.E27.m1.4.5.3.3" xref="A1.E27.m1.4.5.3.3.cmml"><msub id="A1.E27.m1.4.5.3.3.2" xref="A1.E27.m1.4.5.3.3.2.cmml"><mi id="A1.E27.m1.4.5.3.3.2.2" xref="A1.E27.m1.4.5.3.3.2.2.cmml">𝔼</mi><mrow id="A1.E27.m1.4.5.3.3.2.3" xref="A1.E27.m1.4.5.3.3.2.3.cmml"><mi id="A1.E27.m1.4.5.3.3.2.3.2" xref="A1.E27.m1.4.5.3.3.2.3.2.cmml">𝐱</mi><mo id="A1.E27.m1.4.5.3.3.2.3.1" xref="A1.E27.m1.4.5.3.3.2.3.1.cmml">∼</mo><msub id="A1.E27.m1.4.5.3.3.2.3.3" xref="A1.E27.m1.4.5.3.3.2.3.3.cmml"><mi id="A1.E27.m1.4.5.3.3.2.3.3.2" xref="A1.E27.m1.4.5.3.3.2.3.3.2.cmml">q</mi><mi id="A1.E27.m1.4.5.3.3.2.3.3.3" xref="A1.E27.m1.4.5.3.3.2.3.3.3.cmml">f</mi></msub></mrow></msub><mo id="A1.E27.m1.4.5.3.3.1" xref="A1.E27.m1.4.5.3.3.1.cmml">⁢</mo><mi id="A1.E27.m1.4.5.3.3.3" xref="A1.E27.m1.4.5.3.3.3.cmml">h</mi><mo id="A1.E27.m1.4.5.3.3.1a" xref="A1.E27.m1.4.5.3.3.1.cmml">⁢</mo><mrow id="A1.E27.m1.4.5.3.3.4.2" xref="A1.E27.m1.4.5.3.3.cmml"><mo id="A1.E27.m1.4.5.3.3.4.2.1" stretchy="false" xref="A1.E27.m1.4.5.3.3.cmml">(</mo><mi id="A1.E27.m1.3.3" xref="A1.E27.m1.3.3.cmml">𝐱</mi><mo id="A1.E27.m1.4.5.3.3.4.2.2" stretchy="false" xref="A1.E27.m1.4.5.3.3.cmml">)</mo></mrow><mo id="A1.E27.m1.4.5.3.3.1b" xref="A1.E27.m1.4.5.3.3.1.cmml">⁢</mo><mi id="A1.E27.m1.4.5.3.3.5" xref="A1.E27.m1.4.5.3.3.5.cmml">g</mi><mo id="A1.E27.m1.4.5.3.3.1c" xref="A1.E27.m1.4.5.3.3.1.cmml">⁢</mo><mrow id="A1.E27.m1.4.5.3.3.6.2" xref="A1.E27.m1.4.5.3.3.cmml"><mo id="A1.E27.m1.4.5.3.3.6.2.1" stretchy="false" xref="A1.E27.m1.4.5.3.3.cmml">(</mo><mi id="A1.E27.m1.4.4" xref="A1.E27.m1.4.4.cmml">𝐱</mi><mo id="A1.E27.m1.4.5.3.3.6.2.2" stretchy="false" xref="A1.E27.m1.4.5.3.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E27.m1.4b"><apply id="A1.E27.m1.4.5.cmml" xref="A1.E27.m1.4.5"><eq id="A1.E27.m1.4.5.1.cmml" xref="A1.E27.m1.4.5.1"></eq><csymbol cd="latexml" id="A1.E27.m1.4.5.2.cmml" xref="A1.E27.m1.4.5.2">absent</csymbol><apply id="A1.E27.m1.4.5.3.cmml" xref="A1.E27.m1.4.5.3"><minus id="A1.E27.m1.4.5.3.1.cmml" xref="A1.E27.m1.4.5.3.1"></minus><apply id="A1.E27.m1.4.5.3.2.cmml" xref="A1.E27.m1.4.5.3.2"><times id="A1.E27.m1.4.5.3.2.1.cmml" xref="A1.E27.m1.4.5.3.2.1"></times><apply id="A1.E27.m1.4.5.3.2.2.cmml" xref="A1.E27.m1.4.5.3.2.2"><ci id="A1.E27.m1.4.5.3.2.2.1.cmml" xref="A1.E27.m1.4.5.3.2.2.1">⋅</ci><apply id="A1.E27.m1.4.5.3.2.2.2.cmml" xref="A1.E27.m1.4.5.3.2.2.2"><times id="A1.E27.m1.4.5.3.2.2.2.1.cmml" xref="A1.E27.m1.4.5.3.2.2.2.1"></times><apply id="A1.E27.m1.4.5.3.2.2.2.2.cmml" xref="A1.E27.m1.4.5.3.2.2.2.2"><csymbol cd="ambiguous" id="A1.E27.m1.4.5.3.2.2.2.2.1.cmml" xref="A1.E27.m1.4.5.3.2.2.2.2">subscript</csymbol><ci id="A1.E27.m1.4.5.3.2.2.2.2.2.cmml" xref="A1.E27.m1.4.5.3.2.2.2.2.2">𝔼</ci><apply id="A1.E27.m1.4.5.3.2.2.2.2.3.cmml" xref="A1.E27.m1.4.5.3.2.2.2.2.3"><csymbol cd="latexml" id="A1.E27.m1.4.5.3.2.2.2.2.3.1.cmml" xref="A1.E27.m1.4.5.3.2.2.2.2.3.1">similar-to</csymbol><ci id="A1.E27.m1.4.5.3.2.2.2.2.3.2.cmml" xref="A1.E27.m1.4.5.3.2.2.2.2.3.2">𝐱</ci><apply id="A1.E27.m1.4.5.3.2.2.2.2.3.3.cmml" xref="A1.E27.m1.4.5.3.2.2.2.2.3.3"><csymbol cd="ambiguous" id="A1.E27.m1.4.5.3.2.2.2.2.3.3.1.cmml" xref="A1.E27.m1.4.5.3.2.2.2.2.3.3">subscript</csymbol><ci id="A1.E27.m1.4.5.3.2.2.2.2.3.3.2.cmml" xref="A1.E27.m1.4.5.3.2.2.2.2.3.3.2">𝑞</ci><ci id="A1.E27.m1.4.5.3.2.2.2.2.3.3.3.cmml" xref="A1.E27.m1.4.5.3.2.2.2.2.3.3.3">𝑓</ci></apply></apply></apply><ci id="A1.E27.m1.4.5.3.2.2.2.3.cmml" xref="A1.E27.m1.4.5.3.2.2.2.3">ℎ</ci><ci id="A1.E27.m1.1.1.cmml" xref="A1.E27.m1.1.1">𝐱</ci></apply><apply id="A1.E27.m1.4.5.3.2.2.3.cmml" xref="A1.E27.m1.4.5.3.2.2.3"><csymbol cd="ambiguous" id="A1.E27.m1.4.5.3.2.2.3.1.cmml" xref="A1.E27.m1.4.5.3.2.2.3">subscript</csymbol><ci id="A1.E27.m1.4.5.3.2.2.3.2.cmml" xref="A1.E27.m1.4.5.3.2.2.3.2">𝔼</ci><apply id="A1.E27.m1.4.5.3.2.2.3.3.cmml" xref="A1.E27.m1.4.5.3.2.2.3.3"><csymbol cd="latexml" id="A1.E27.m1.4.5.3.2.2.3.3.1.cmml" xref="A1.E27.m1.4.5.3.2.2.3.3.1">similar-to</csymbol><ci id="A1.E27.m1.4.5.3.2.2.3.3.2.cmml" xref="A1.E27.m1.4.5.3.2.2.3.3.2">𝐱</ci><apply id="A1.E27.m1.4.5.3.2.2.3.3.3.cmml" xref="A1.E27.m1.4.5.3.2.2.3.3.3"><csymbol cd="ambiguous" id="A1.E27.m1.4.5.3.2.2.3.3.3.1.cmml" xref="A1.E27.m1.4.5.3.2.2.3.3.3">subscript</csymbol><ci id="A1.E27.m1.4.5.3.2.2.3.3.3.2.cmml" xref="A1.E27.m1.4.5.3.2.2.3.3.3.2">𝑞</ci><ci id="A1.E27.m1.4.5.3.2.2.3.3.3.3.cmml" xref="A1.E27.m1.4.5.3.2.2.3.3.3.3">𝑓</ci></apply></apply></apply></apply><ci id="A1.E27.m1.4.5.3.2.3.cmml" xref="A1.E27.m1.4.5.3.2.3">𝑔</ci><ci id="A1.E27.m1.2.2.cmml" xref="A1.E27.m1.2.2">𝐱</ci></apply><apply id="A1.E27.m1.4.5.3.3.cmml" xref="A1.E27.m1.4.5.3.3"><times id="A1.E27.m1.4.5.3.3.1.cmml" xref="A1.E27.m1.4.5.3.3.1"></times><apply id="A1.E27.m1.4.5.3.3.2.cmml" xref="A1.E27.m1.4.5.3.3.2"><csymbol cd="ambiguous" id="A1.E27.m1.4.5.3.3.2.1.cmml" xref="A1.E27.m1.4.5.3.3.2">subscript</csymbol><ci id="A1.E27.m1.4.5.3.3.2.2.cmml" xref="A1.E27.m1.4.5.3.3.2.2">𝔼</ci><apply id="A1.E27.m1.4.5.3.3.2.3.cmml" xref="A1.E27.m1.4.5.3.3.2.3"><csymbol cd="latexml" id="A1.E27.m1.4.5.3.3.2.3.1.cmml" xref="A1.E27.m1.4.5.3.3.2.3.1">similar-to</csymbol><ci id="A1.E27.m1.4.5.3.3.2.3.2.cmml" xref="A1.E27.m1.4.5.3.3.2.3.2">𝐱</ci><apply id="A1.E27.m1.4.5.3.3.2.3.3.cmml" xref="A1.E27.m1.4.5.3.3.2.3.3"><csymbol cd="ambiguous" id="A1.E27.m1.4.5.3.3.2.3.3.1.cmml" xref="A1.E27.m1.4.5.3.3.2.3.3">subscript</csymbol><ci id="A1.E27.m1.4.5.3.3.2.3.3.2.cmml" xref="A1.E27.m1.4.5.3.3.2.3.3.2">𝑞</ci><ci id="A1.E27.m1.4.5.3.3.2.3.3.3.cmml" xref="A1.E27.m1.4.5.3.3.2.3.3.3">𝑓</ci></apply></apply></apply><ci id="A1.E27.m1.4.5.3.3.3.cmml" xref="A1.E27.m1.4.5.3.3.3">ℎ</ci><ci id="A1.E27.m1.3.3.cmml" xref="A1.E27.m1.3.3">𝐱</ci><ci id="A1.E27.m1.4.5.3.3.5.cmml" xref="A1.E27.m1.4.5.3.3.5">𝑔</ci><ci id="A1.E27.m1.4.4.cmml" xref="A1.E27.m1.4.4">𝐱</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E27.m1.4c">\displaystyle=\mathbb{E}_{\mathbf{x}\sim q_{f}}h(\mathbf{x})\cdot\mathbb{E}_{%
\mathbf{x}\sim q_{f}}g(\mathbf{x})-\mathbb{E}_{\mathbf{x}\sim q_{f}}h(\mathbf{%
x})g(\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="A1.E27.m1.4d">= blackboard_E start_POSTSUBSCRIPT bold_x ∼ italic_q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_h ( bold_x ) ⋅ blackboard_E start_POSTSUBSCRIPT bold_x ∼ italic_q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_g ( bold_x ) - blackboard_E start_POSTSUBSCRIPT bold_x ∼ italic_q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_h ( bold_x ) italic_g ( bold_x )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(27)</span></td>
</tr></tbody>
<tbody id="A1.E28"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=-\textrm{Cov}_{\mathbf{x}\sim q_{f}}\left(g(\mathbf{x}),h(%
\mathbf{x})\right)\,." class="ltx_Math" display="inline" id="A1.E28.m1.3"><semantics id="A1.E28.m1.3a"><mrow id="A1.E28.m1.3.3.1" xref="A1.E28.m1.3.3.1.1.cmml"><mrow id="A1.E28.m1.3.3.1.1" xref="A1.E28.m1.3.3.1.1.cmml"><mi id="A1.E28.m1.3.3.1.1.4" xref="A1.E28.m1.3.3.1.1.4.cmml"></mi><mo id="A1.E28.m1.3.3.1.1.3" xref="A1.E28.m1.3.3.1.1.3.cmml">=</mo><mrow id="A1.E28.m1.3.3.1.1.2" xref="A1.E28.m1.3.3.1.1.2.cmml"><mo id="A1.E28.m1.3.3.1.1.2a" xref="A1.E28.m1.3.3.1.1.2.cmml">−</mo><mrow id="A1.E28.m1.3.3.1.1.2.2" xref="A1.E28.m1.3.3.1.1.2.2.cmml"><msub id="A1.E28.m1.3.3.1.1.2.2.4" xref="A1.E28.m1.3.3.1.1.2.2.4.cmml"><mtext id="A1.E28.m1.3.3.1.1.2.2.4.2" xref="A1.E28.m1.3.3.1.1.2.2.4.2a.cmml">Cov</mtext><mrow id="A1.E28.m1.3.3.1.1.2.2.4.3" xref="A1.E28.m1.3.3.1.1.2.2.4.3.cmml"><mi id="A1.E28.m1.3.3.1.1.2.2.4.3.2" xref="A1.E28.m1.3.3.1.1.2.2.4.3.2.cmml">𝐱</mi><mo id="A1.E28.m1.3.3.1.1.2.2.4.3.1" xref="A1.E28.m1.3.3.1.1.2.2.4.3.1.cmml">∼</mo><msub id="A1.E28.m1.3.3.1.1.2.2.4.3.3" xref="A1.E28.m1.3.3.1.1.2.2.4.3.3.cmml"><mi id="A1.E28.m1.3.3.1.1.2.2.4.3.3.2" xref="A1.E28.m1.3.3.1.1.2.2.4.3.3.2.cmml">q</mi><mi id="A1.E28.m1.3.3.1.1.2.2.4.3.3.3" xref="A1.E28.m1.3.3.1.1.2.2.4.3.3.3.cmml">f</mi></msub></mrow></msub><mo id="A1.E28.m1.3.3.1.1.2.2.3" xref="A1.E28.m1.3.3.1.1.2.2.3.cmml">⁢</mo><mrow id="A1.E28.m1.3.3.1.1.2.2.2.2" xref="A1.E28.m1.3.3.1.1.2.2.2.3.cmml"><mo id="A1.E28.m1.3.3.1.1.2.2.2.2.3" xref="A1.E28.m1.3.3.1.1.2.2.2.3.cmml">(</mo><mrow id="A1.E28.m1.3.3.1.1.1.1.1.1.1" xref="A1.E28.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="A1.E28.m1.3.3.1.1.1.1.1.1.1.2" xref="A1.E28.m1.3.3.1.1.1.1.1.1.1.2.cmml">g</mi><mo id="A1.E28.m1.3.3.1.1.1.1.1.1.1.1" xref="A1.E28.m1.3.3.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="A1.E28.m1.3.3.1.1.1.1.1.1.1.3.2" xref="A1.E28.m1.3.3.1.1.1.1.1.1.1.cmml"><mo id="A1.E28.m1.3.3.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="A1.E28.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><mi id="A1.E28.m1.1.1" xref="A1.E28.m1.1.1.cmml">𝐱</mi><mo id="A1.E28.m1.3.3.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="A1.E28.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E28.m1.3.3.1.1.2.2.2.2.4" xref="A1.E28.m1.3.3.1.1.2.2.2.3.cmml">,</mo><mrow id="A1.E28.m1.3.3.1.1.2.2.2.2.2" xref="A1.E28.m1.3.3.1.1.2.2.2.2.2.cmml"><mi id="A1.E28.m1.3.3.1.1.2.2.2.2.2.2" xref="A1.E28.m1.3.3.1.1.2.2.2.2.2.2.cmml">h</mi><mo id="A1.E28.m1.3.3.1.1.2.2.2.2.2.1" xref="A1.E28.m1.3.3.1.1.2.2.2.2.2.1.cmml">⁢</mo><mrow id="A1.E28.m1.3.3.1.1.2.2.2.2.2.3.2" xref="A1.E28.m1.3.3.1.1.2.2.2.2.2.cmml"><mo id="A1.E28.m1.3.3.1.1.2.2.2.2.2.3.2.1" stretchy="false" xref="A1.E28.m1.3.3.1.1.2.2.2.2.2.cmml">(</mo><mi id="A1.E28.m1.2.2" xref="A1.E28.m1.2.2.cmml">𝐱</mi><mo id="A1.E28.m1.3.3.1.1.2.2.2.2.2.3.2.2" stretchy="false" xref="A1.E28.m1.3.3.1.1.2.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="A1.E28.m1.3.3.1.1.2.2.2.2.5" xref="A1.E28.m1.3.3.1.1.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A1.E28.m1.3.3.1.2" lspace="0.170em" xref="A1.E28.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E28.m1.3b"><apply id="A1.E28.m1.3.3.1.1.cmml" xref="A1.E28.m1.3.3.1"><eq id="A1.E28.m1.3.3.1.1.3.cmml" xref="A1.E28.m1.3.3.1.1.3"></eq><csymbol cd="latexml" id="A1.E28.m1.3.3.1.1.4.cmml" xref="A1.E28.m1.3.3.1.1.4">absent</csymbol><apply id="A1.E28.m1.3.3.1.1.2.cmml" xref="A1.E28.m1.3.3.1.1.2"><minus id="A1.E28.m1.3.3.1.1.2.3.cmml" xref="A1.E28.m1.3.3.1.1.2"></minus><apply id="A1.E28.m1.3.3.1.1.2.2.cmml" xref="A1.E28.m1.3.3.1.1.2.2"><times id="A1.E28.m1.3.3.1.1.2.2.3.cmml" xref="A1.E28.m1.3.3.1.1.2.2.3"></times><apply id="A1.E28.m1.3.3.1.1.2.2.4.cmml" xref="A1.E28.m1.3.3.1.1.2.2.4"><csymbol cd="ambiguous" id="A1.E28.m1.3.3.1.1.2.2.4.1.cmml" xref="A1.E28.m1.3.3.1.1.2.2.4">subscript</csymbol><ci id="A1.E28.m1.3.3.1.1.2.2.4.2a.cmml" xref="A1.E28.m1.3.3.1.1.2.2.4.2"><mtext id="A1.E28.m1.3.3.1.1.2.2.4.2.cmml" xref="A1.E28.m1.3.3.1.1.2.2.4.2">Cov</mtext></ci><apply id="A1.E28.m1.3.3.1.1.2.2.4.3.cmml" xref="A1.E28.m1.3.3.1.1.2.2.4.3"><csymbol cd="latexml" id="A1.E28.m1.3.3.1.1.2.2.4.3.1.cmml" xref="A1.E28.m1.3.3.1.1.2.2.4.3.1">similar-to</csymbol><ci id="A1.E28.m1.3.3.1.1.2.2.4.3.2.cmml" xref="A1.E28.m1.3.3.1.1.2.2.4.3.2">𝐱</ci><apply id="A1.E28.m1.3.3.1.1.2.2.4.3.3.cmml" xref="A1.E28.m1.3.3.1.1.2.2.4.3.3"><csymbol cd="ambiguous" id="A1.E28.m1.3.3.1.1.2.2.4.3.3.1.cmml" xref="A1.E28.m1.3.3.1.1.2.2.4.3.3">subscript</csymbol><ci id="A1.E28.m1.3.3.1.1.2.2.4.3.3.2.cmml" xref="A1.E28.m1.3.3.1.1.2.2.4.3.3.2">𝑞</ci><ci id="A1.E28.m1.3.3.1.1.2.2.4.3.3.3.cmml" xref="A1.E28.m1.3.3.1.1.2.2.4.3.3.3">𝑓</ci></apply></apply></apply><interval closure="open" id="A1.E28.m1.3.3.1.1.2.2.2.3.cmml" xref="A1.E28.m1.3.3.1.1.2.2.2.2"><apply id="A1.E28.m1.3.3.1.1.1.1.1.1.1.cmml" xref="A1.E28.m1.3.3.1.1.1.1.1.1.1"><times id="A1.E28.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="A1.E28.m1.3.3.1.1.1.1.1.1.1.1"></times><ci id="A1.E28.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="A1.E28.m1.3.3.1.1.1.1.1.1.1.2">𝑔</ci><ci id="A1.E28.m1.1.1.cmml" xref="A1.E28.m1.1.1">𝐱</ci></apply><apply id="A1.E28.m1.3.3.1.1.2.2.2.2.2.cmml" xref="A1.E28.m1.3.3.1.1.2.2.2.2.2"><times id="A1.E28.m1.3.3.1.1.2.2.2.2.2.1.cmml" xref="A1.E28.m1.3.3.1.1.2.2.2.2.2.1"></times><ci id="A1.E28.m1.3.3.1.1.2.2.2.2.2.2.cmml" xref="A1.E28.m1.3.3.1.1.2.2.2.2.2.2">ℎ</ci><ci id="A1.E28.m1.2.2.cmml" xref="A1.E28.m1.2.2">𝐱</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E28.m1.3c">\displaystyle=-\textrm{Cov}_{\mathbf{x}\sim q_{f}}\left(g(\mathbf{x}),h(%
\mathbf{x})\right)\,.</annotation><annotation encoding="application/x-llamapun" id="A1.E28.m1.3d">= - Cov start_POSTSUBSCRIPT bold_x ∼ italic_q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_g ( bold_x ) , italic_h ( bold_x ) ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(28)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A1.p4">
<p class="ltx_p" id="A1.p4.3">Note that this functional is negative semi-definite for all <math alttext="f" class="ltx_Math" display="inline" id="A1.p4.1.m1.1"><semantics id="A1.p4.1.m1.1a"><mi id="A1.p4.1.m1.1.1" xref="A1.p4.1.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="A1.p4.1.m1.1b"><ci id="A1.p4.1.m1.1.1.cmml" xref="A1.p4.1.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p4.1.m1.1c">f</annotation><annotation encoding="application/x-llamapun" id="A1.p4.1.m1.1d">italic_f</annotation></semantics></math>, i.e. <math alttext="\delta^{2}L[f;h,h]\leq 0" class="ltx_Math" display="inline" id="A1.p4.2.m2.3"><semantics id="A1.p4.2.m2.3a"><mrow id="A1.p4.2.m2.3.4" xref="A1.p4.2.m2.3.4.cmml"><mrow id="A1.p4.2.m2.3.4.2" xref="A1.p4.2.m2.3.4.2.cmml"><msup id="A1.p4.2.m2.3.4.2.2" xref="A1.p4.2.m2.3.4.2.2.cmml"><mi id="A1.p4.2.m2.3.4.2.2.2" xref="A1.p4.2.m2.3.4.2.2.2.cmml">δ</mi><mn id="A1.p4.2.m2.3.4.2.2.3" xref="A1.p4.2.m2.3.4.2.2.3.cmml">2</mn></msup><mo id="A1.p4.2.m2.3.4.2.1" xref="A1.p4.2.m2.3.4.2.1.cmml">⁢</mo><mi id="A1.p4.2.m2.3.4.2.3" xref="A1.p4.2.m2.3.4.2.3.cmml">L</mi><mo id="A1.p4.2.m2.3.4.2.1a" xref="A1.p4.2.m2.3.4.2.1.cmml">⁢</mo><mrow id="A1.p4.2.m2.3.4.2.4.2" xref="A1.p4.2.m2.3.4.2.4.1.cmml"><mo id="A1.p4.2.m2.3.4.2.4.2.1" stretchy="false" xref="A1.p4.2.m2.3.4.2.4.1.cmml">[</mo><mi id="A1.p4.2.m2.1.1" xref="A1.p4.2.m2.1.1.cmml">f</mi><mo id="A1.p4.2.m2.3.4.2.4.2.2" xref="A1.p4.2.m2.3.4.2.4.1.cmml">;</mo><mi id="A1.p4.2.m2.2.2" xref="A1.p4.2.m2.2.2.cmml">h</mi><mo id="A1.p4.2.m2.3.4.2.4.2.3" xref="A1.p4.2.m2.3.4.2.4.1.cmml">,</mo><mi id="A1.p4.2.m2.3.3" xref="A1.p4.2.m2.3.3.cmml">h</mi><mo id="A1.p4.2.m2.3.4.2.4.2.4" stretchy="false" xref="A1.p4.2.m2.3.4.2.4.1.cmml">]</mo></mrow></mrow><mo id="A1.p4.2.m2.3.4.1" xref="A1.p4.2.m2.3.4.1.cmml">≤</mo><mn id="A1.p4.2.m2.3.4.3" xref="A1.p4.2.m2.3.4.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p4.2.m2.3b"><apply id="A1.p4.2.m2.3.4.cmml" xref="A1.p4.2.m2.3.4"><leq id="A1.p4.2.m2.3.4.1.cmml" xref="A1.p4.2.m2.3.4.1"></leq><apply id="A1.p4.2.m2.3.4.2.cmml" xref="A1.p4.2.m2.3.4.2"><times id="A1.p4.2.m2.3.4.2.1.cmml" xref="A1.p4.2.m2.3.4.2.1"></times><apply id="A1.p4.2.m2.3.4.2.2.cmml" xref="A1.p4.2.m2.3.4.2.2"><csymbol cd="ambiguous" id="A1.p4.2.m2.3.4.2.2.1.cmml" xref="A1.p4.2.m2.3.4.2.2">superscript</csymbol><ci id="A1.p4.2.m2.3.4.2.2.2.cmml" xref="A1.p4.2.m2.3.4.2.2.2">𝛿</ci><cn id="A1.p4.2.m2.3.4.2.2.3.cmml" type="integer" xref="A1.p4.2.m2.3.4.2.2.3">2</cn></apply><ci id="A1.p4.2.m2.3.4.2.3.cmml" xref="A1.p4.2.m2.3.4.2.3">𝐿</ci><list id="A1.p4.2.m2.3.4.2.4.1.cmml" xref="A1.p4.2.m2.3.4.2.4.2"><ci id="A1.p4.2.m2.1.1.cmml" xref="A1.p4.2.m2.1.1">𝑓</ci><ci id="A1.p4.2.m2.2.2.cmml" xref="A1.p4.2.m2.2.2">ℎ</ci><ci id="A1.p4.2.m2.3.3.cmml" xref="A1.p4.2.m2.3.3">ℎ</ci></list></apply><cn id="A1.p4.2.m2.3.4.3.cmml" type="integer" xref="A1.p4.2.m2.3.4.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p4.2.m2.3c">\delta^{2}L[f;h,h]\leq 0</annotation><annotation encoding="application/x-llamapun" id="A1.p4.2.m2.3d">italic_δ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_L [ italic_f ; italic_h , italic_h ] ≤ 0</annotation></semantics></math>, meaning that the log-likelihood is a concave functional of <math alttext="f" class="ltx_Math" display="inline" id="A1.p4.3.m3.1"><semantics id="A1.p4.3.m3.1a"><mi id="A1.p4.3.m3.1.1" xref="A1.p4.3.m3.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="A1.p4.3.m3.1b"><ci id="A1.p4.3.m3.1.1.cmml" xref="A1.p4.3.m3.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p4.3.m3.1c">f</annotation><annotation encoding="application/x-llamapun" id="A1.p4.3.m3.1d">italic_f</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.p5">
<p class="ltx_p" id="A1.p5.3">Using these results, we can now compute the Taylor expansion of the increment in log-likelihood <math alttext="L" class="ltx_Math" display="inline" id="A1.p5.1.m1.1"><semantics id="A1.p5.1.m1.1a"><mi id="A1.p5.1.m1.1.1" xref="A1.p5.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="A1.p5.1.m1.1b"><ci id="A1.p5.1.m1.1.1.cmml" xref="A1.p5.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p5.1.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="A1.p5.1.m1.1d">italic_L</annotation></semantics></math> from a change <math alttext="f\rightarrow f+\delta f" class="ltx_Math" display="inline" id="A1.p5.2.m2.1"><semantics id="A1.p5.2.m2.1a"><mrow id="A1.p5.2.m2.1.1" xref="A1.p5.2.m2.1.1.cmml"><mi id="A1.p5.2.m2.1.1.2" xref="A1.p5.2.m2.1.1.2.cmml">f</mi><mo id="A1.p5.2.m2.1.1.1" stretchy="false" xref="A1.p5.2.m2.1.1.1.cmml">→</mo><mrow id="A1.p5.2.m2.1.1.3" xref="A1.p5.2.m2.1.1.3.cmml"><mi id="A1.p5.2.m2.1.1.3.2" xref="A1.p5.2.m2.1.1.3.2.cmml">f</mi><mo id="A1.p5.2.m2.1.1.3.1" xref="A1.p5.2.m2.1.1.3.1.cmml">+</mo><mrow id="A1.p5.2.m2.1.1.3.3" xref="A1.p5.2.m2.1.1.3.3.cmml"><mi id="A1.p5.2.m2.1.1.3.3.2" xref="A1.p5.2.m2.1.1.3.3.2.cmml">δ</mi><mo id="A1.p5.2.m2.1.1.3.3.1" xref="A1.p5.2.m2.1.1.3.3.1.cmml">⁢</mo><mi id="A1.p5.2.m2.1.1.3.3.3" xref="A1.p5.2.m2.1.1.3.3.3.cmml">f</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.p5.2.m2.1b"><apply id="A1.p5.2.m2.1.1.cmml" xref="A1.p5.2.m2.1.1"><ci id="A1.p5.2.m2.1.1.1.cmml" xref="A1.p5.2.m2.1.1.1">→</ci><ci id="A1.p5.2.m2.1.1.2.cmml" xref="A1.p5.2.m2.1.1.2">𝑓</ci><apply id="A1.p5.2.m2.1.1.3.cmml" xref="A1.p5.2.m2.1.1.3"><plus id="A1.p5.2.m2.1.1.3.1.cmml" xref="A1.p5.2.m2.1.1.3.1"></plus><ci id="A1.p5.2.m2.1.1.3.2.cmml" xref="A1.p5.2.m2.1.1.3.2">𝑓</ci><apply id="A1.p5.2.m2.1.1.3.3.cmml" xref="A1.p5.2.m2.1.1.3.3"><times id="A1.p5.2.m2.1.1.3.3.1.cmml" xref="A1.p5.2.m2.1.1.3.3.1"></times><ci id="A1.p5.2.m2.1.1.3.3.2.cmml" xref="A1.p5.2.m2.1.1.3.3.2">𝛿</ci><ci id="A1.p5.2.m2.1.1.3.3.3.cmml" xref="A1.p5.2.m2.1.1.3.3.3">𝑓</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p5.2.m2.1c">f\rightarrow f+\delta f</annotation><annotation encoding="application/x-llamapun" id="A1.p5.2.m2.1d">italic_f → italic_f + italic_δ italic_f</annotation></semantics></math> up to second order in <math alttext="\delta f" class="ltx_Math" display="inline" id="A1.p5.3.m3.1"><semantics id="A1.p5.3.m3.1a"><mrow id="A1.p5.3.m3.1.1" xref="A1.p5.3.m3.1.1.cmml"><mi id="A1.p5.3.m3.1.1.2" xref="A1.p5.3.m3.1.1.2.cmml">δ</mi><mo id="A1.p5.3.m3.1.1.1" xref="A1.p5.3.m3.1.1.1.cmml">⁢</mo><mi id="A1.p5.3.m3.1.1.3" xref="A1.p5.3.m3.1.1.3.cmml">f</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.p5.3.m3.1b"><apply id="A1.p5.3.m3.1.1.cmml" xref="A1.p5.3.m3.1.1"><times id="A1.p5.3.m3.1.1.1.cmml" xref="A1.p5.3.m3.1.1.1"></times><ci id="A1.p5.3.m3.1.1.2.cmml" xref="A1.p5.3.m3.1.1.2">𝛿</ci><ci id="A1.p5.3.m3.1.1.3.cmml" xref="A1.p5.3.m3.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p5.3.m3.1c">\delta f</annotation><annotation encoding="application/x-llamapun" id="A1.p5.3.m3.1d">italic_δ italic_f</annotation></semantics></math>:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A5.EGx4">
<tbody id="A1.E29"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\Delta L_{f}[\delta f]" class="ltx_Math" display="inline" id="A1.E29.m1.1"><semantics id="A1.E29.m1.1a"><mrow id="A1.E29.m1.1.1" xref="A1.E29.m1.1.1.cmml"><mi id="A1.E29.m1.1.1.3" mathvariant="normal" xref="A1.E29.m1.1.1.3.cmml">Δ</mi><mo id="A1.E29.m1.1.1.2" xref="A1.E29.m1.1.1.2.cmml">⁢</mo><msub id="A1.E29.m1.1.1.4" xref="A1.E29.m1.1.1.4.cmml"><mi id="A1.E29.m1.1.1.4.2" xref="A1.E29.m1.1.1.4.2.cmml">L</mi><mi id="A1.E29.m1.1.1.4.3" xref="A1.E29.m1.1.1.4.3.cmml">f</mi></msub><mo id="A1.E29.m1.1.1.2a" xref="A1.E29.m1.1.1.2.cmml">⁢</mo><mrow id="A1.E29.m1.1.1.1.1" xref="A1.E29.m1.1.1.1.2.cmml"><mo id="A1.E29.m1.1.1.1.1.2" stretchy="false" xref="A1.E29.m1.1.1.1.2.1.cmml">[</mo><mrow id="A1.E29.m1.1.1.1.1.1" xref="A1.E29.m1.1.1.1.1.1.cmml"><mi id="A1.E29.m1.1.1.1.1.1.2" xref="A1.E29.m1.1.1.1.1.1.2.cmml">δ</mi><mo id="A1.E29.m1.1.1.1.1.1.1" xref="A1.E29.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.E29.m1.1.1.1.1.1.3" xref="A1.E29.m1.1.1.1.1.1.3.cmml">f</mi></mrow><mo id="A1.E29.m1.1.1.1.1.3" stretchy="false" xref="A1.E29.m1.1.1.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E29.m1.1b"><apply id="A1.E29.m1.1.1.cmml" xref="A1.E29.m1.1.1"><times id="A1.E29.m1.1.1.2.cmml" xref="A1.E29.m1.1.1.2"></times><ci id="A1.E29.m1.1.1.3.cmml" xref="A1.E29.m1.1.1.3">Δ</ci><apply id="A1.E29.m1.1.1.4.cmml" xref="A1.E29.m1.1.1.4"><csymbol cd="ambiguous" id="A1.E29.m1.1.1.4.1.cmml" xref="A1.E29.m1.1.1.4">subscript</csymbol><ci id="A1.E29.m1.1.1.4.2.cmml" xref="A1.E29.m1.1.1.4.2">𝐿</ci><ci id="A1.E29.m1.1.1.4.3.cmml" xref="A1.E29.m1.1.1.4.3">𝑓</ci></apply><apply id="A1.E29.m1.1.1.1.2.cmml" xref="A1.E29.m1.1.1.1.1"><csymbol cd="latexml" id="A1.E29.m1.1.1.1.2.1.cmml" xref="A1.E29.m1.1.1.1.1.2">delimited-[]</csymbol><apply id="A1.E29.m1.1.1.1.1.1.cmml" xref="A1.E29.m1.1.1.1.1.1"><times id="A1.E29.m1.1.1.1.1.1.1.cmml" xref="A1.E29.m1.1.1.1.1.1.1"></times><ci id="A1.E29.m1.1.1.1.1.1.2.cmml" xref="A1.E29.m1.1.1.1.1.1.2">𝛿</ci><ci id="A1.E29.m1.1.1.1.1.1.3.cmml" xref="A1.E29.m1.1.1.1.1.1.3">𝑓</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E29.m1.1c">\displaystyle\Delta L_{f}[\delta f]</annotation><annotation encoding="application/x-llamapun" id="A1.E29.m1.1d">roman_Δ italic_L start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT [ italic_δ italic_f ]</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\delta L[f;\delta f]+\frac{1}{2}\delta^{2}L[f;\delta f,\delta f]" class="ltx_Math" display="inline" id="A1.E29.m2.5"><semantics id="A1.E29.m2.5a"><mrow id="A1.E29.m2.5.5" xref="A1.E29.m2.5.5.cmml"><mi id="A1.E29.m2.5.5.5" xref="A1.E29.m2.5.5.5.cmml"></mi><mo id="A1.E29.m2.5.5.4" xref="A1.E29.m2.5.5.4.cmml">=</mo><mrow id="A1.E29.m2.5.5.3" xref="A1.E29.m2.5.5.3.cmml"><mrow id="A1.E29.m2.3.3.1.1" xref="A1.E29.m2.3.3.1.1.cmml"><mi id="A1.E29.m2.3.3.1.1.3" xref="A1.E29.m2.3.3.1.1.3.cmml">δ</mi><mo id="A1.E29.m2.3.3.1.1.2" xref="A1.E29.m2.3.3.1.1.2.cmml">⁢</mo><mi id="A1.E29.m2.3.3.1.1.4" xref="A1.E29.m2.3.3.1.1.4.cmml">L</mi><mo id="A1.E29.m2.3.3.1.1.2a" xref="A1.E29.m2.3.3.1.1.2.cmml">⁢</mo><mrow id="A1.E29.m2.3.3.1.1.1.1" xref="A1.E29.m2.3.3.1.1.1.2.cmml"><mo id="A1.E29.m2.3.3.1.1.1.1.2" stretchy="false" xref="A1.E29.m2.3.3.1.1.1.2.cmml">[</mo><mi id="A1.E29.m2.1.1" xref="A1.E29.m2.1.1.cmml">f</mi><mo id="A1.E29.m2.3.3.1.1.1.1.3" xref="A1.E29.m2.3.3.1.1.1.2.cmml">;</mo><mrow id="A1.E29.m2.3.3.1.1.1.1.1" xref="A1.E29.m2.3.3.1.1.1.1.1.cmml"><mi id="A1.E29.m2.3.3.1.1.1.1.1.2" xref="A1.E29.m2.3.3.1.1.1.1.1.2.cmml">δ</mi><mo id="A1.E29.m2.3.3.1.1.1.1.1.1" xref="A1.E29.m2.3.3.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.E29.m2.3.3.1.1.1.1.1.3" xref="A1.E29.m2.3.3.1.1.1.1.1.3.cmml">f</mi></mrow><mo id="A1.E29.m2.3.3.1.1.1.1.4" stretchy="false" xref="A1.E29.m2.3.3.1.1.1.2.cmml">]</mo></mrow></mrow><mo id="A1.E29.m2.5.5.3.4" xref="A1.E29.m2.5.5.3.4.cmml">+</mo><mrow id="A1.E29.m2.5.5.3.3" xref="A1.E29.m2.5.5.3.3.cmml"><mstyle displaystyle="true" id="A1.E29.m2.5.5.3.3.4" xref="A1.E29.m2.5.5.3.3.4.cmml"><mfrac id="A1.E29.m2.5.5.3.3.4a" xref="A1.E29.m2.5.5.3.3.4.cmml"><mn id="A1.E29.m2.5.5.3.3.4.2" xref="A1.E29.m2.5.5.3.3.4.2.cmml">1</mn><mn id="A1.E29.m2.5.5.3.3.4.3" xref="A1.E29.m2.5.5.3.3.4.3.cmml">2</mn></mfrac></mstyle><mo id="A1.E29.m2.5.5.3.3.3" xref="A1.E29.m2.5.5.3.3.3.cmml">⁢</mo><msup id="A1.E29.m2.5.5.3.3.5" xref="A1.E29.m2.5.5.3.3.5.cmml"><mi id="A1.E29.m2.5.5.3.3.5.2" xref="A1.E29.m2.5.5.3.3.5.2.cmml">δ</mi><mn id="A1.E29.m2.5.5.3.3.5.3" xref="A1.E29.m2.5.5.3.3.5.3.cmml">2</mn></msup><mo id="A1.E29.m2.5.5.3.3.3a" xref="A1.E29.m2.5.5.3.3.3.cmml">⁢</mo><mi id="A1.E29.m2.5.5.3.3.6" xref="A1.E29.m2.5.5.3.3.6.cmml">L</mi><mo id="A1.E29.m2.5.5.3.3.3b" xref="A1.E29.m2.5.5.3.3.3.cmml">⁢</mo><mrow id="A1.E29.m2.5.5.3.3.2.2" xref="A1.E29.m2.5.5.3.3.2.3.cmml"><mo id="A1.E29.m2.5.5.3.3.2.2.3" stretchy="false" xref="A1.E29.m2.5.5.3.3.2.3.cmml">[</mo><mi id="A1.E29.m2.2.2" xref="A1.E29.m2.2.2.cmml">f</mi><mo id="A1.E29.m2.5.5.3.3.2.2.4" xref="A1.E29.m2.5.5.3.3.2.3.cmml">;</mo><mrow id="A1.E29.m2.4.4.2.2.1.1.1" xref="A1.E29.m2.4.4.2.2.1.1.1.cmml"><mi id="A1.E29.m2.4.4.2.2.1.1.1.2" xref="A1.E29.m2.4.4.2.2.1.1.1.2.cmml">δ</mi><mo id="A1.E29.m2.4.4.2.2.1.1.1.1" xref="A1.E29.m2.4.4.2.2.1.1.1.1.cmml">⁢</mo><mi id="A1.E29.m2.4.4.2.2.1.1.1.3" xref="A1.E29.m2.4.4.2.2.1.1.1.3.cmml">f</mi></mrow><mo id="A1.E29.m2.5.5.3.3.2.2.5" xref="A1.E29.m2.5.5.3.3.2.3.cmml">,</mo><mrow id="A1.E29.m2.5.5.3.3.2.2.2" xref="A1.E29.m2.5.5.3.3.2.2.2.cmml"><mi id="A1.E29.m2.5.5.3.3.2.2.2.2" xref="A1.E29.m2.5.5.3.3.2.2.2.2.cmml">δ</mi><mo id="A1.E29.m2.5.5.3.3.2.2.2.1" xref="A1.E29.m2.5.5.3.3.2.2.2.1.cmml">⁢</mo><mi id="A1.E29.m2.5.5.3.3.2.2.2.3" xref="A1.E29.m2.5.5.3.3.2.2.2.3.cmml">f</mi></mrow><mo id="A1.E29.m2.5.5.3.3.2.2.6" stretchy="false" xref="A1.E29.m2.5.5.3.3.2.3.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E29.m2.5b"><apply id="A1.E29.m2.5.5.cmml" xref="A1.E29.m2.5.5"><eq id="A1.E29.m2.5.5.4.cmml" xref="A1.E29.m2.5.5.4"></eq><csymbol cd="latexml" id="A1.E29.m2.5.5.5.cmml" xref="A1.E29.m2.5.5.5">absent</csymbol><apply id="A1.E29.m2.5.5.3.cmml" xref="A1.E29.m2.5.5.3"><plus id="A1.E29.m2.5.5.3.4.cmml" xref="A1.E29.m2.5.5.3.4"></plus><apply id="A1.E29.m2.3.3.1.1.cmml" xref="A1.E29.m2.3.3.1.1"><times id="A1.E29.m2.3.3.1.1.2.cmml" xref="A1.E29.m2.3.3.1.1.2"></times><ci id="A1.E29.m2.3.3.1.1.3.cmml" xref="A1.E29.m2.3.3.1.1.3">𝛿</ci><ci id="A1.E29.m2.3.3.1.1.4.cmml" xref="A1.E29.m2.3.3.1.1.4">𝐿</ci><list id="A1.E29.m2.3.3.1.1.1.2.cmml" xref="A1.E29.m2.3.3.1.1.1.1"><ci id="A1.E29.m2.1.1.cmml" xref="A1.E29.m2.1.1">𝑓</ci><apply id="A1.E29.m2.3.3.1.1.1.1.1.cmml" xref="A1.E29.m2.3.3.1.1.1.1.1"><times id="A1.E29.m2.3.3.1.1.1.1.1.1.cmml" xref="A1.E29.m2.3.3.1.1.1.1.1.1"></times><ci id="A1.E29.m2.3.3.1.1.1.1.1.2.cmml" xref="A1.E29.m2.3.3.1.1.1.1.1.2">𝛿</ci><ci id="A1.E29.m2.3.3.1.1.1.1.1.3.cmml" xref="A1.E29.m2.3.3.1.1.1.1.1.3">𝑓</ci></apply></list></apply><apply id="A1.E29.m2.5.5.3.3.cmml" xref="A1.E29.m2.5.5.3.3"><times id="A1.E29.m2.5.5.3.3.3.cmml" xref="A1.E29.m2.5.5.3.3.3"></times><apply id="A1.E29.m2.5.5.3.3.4.cmml" xref="A1.E29.m2.5.5.3.3.4"><divide id="A1.E29.m2.5.5.3.3.4.1.cmml" xref="A1.E29.m2.5.5.3.3.4"></divide><cn id="A1.E29.m2.5.5.3.3.4.2.cmml" type="integer" xref="A1.E29.m2.5.5.3.3.4.2">1</cn><cn id="A1.E29.m2.5.5.3.3.4.3.cmml" type="integer" xref="A1.E29.m2.5.5.3.3.4.3">2</cn></apply><apply id="A1.E29.m2.5.5.3.3.5.cmml" xref="A1.E29.m2.5.5.3.3.5"><csymbol cd="ambiguous" id="A1.E29.m2.5.5.3.3.5.1.cmml" xref="A1.E29.m2.5.5.3.3.5">superscript</csymbol><ci id="A1.E29.m2.5.5.3.3.5.2.cmml" xref="A1.E29.m2.5.5.3.3.5.2">𝛿</ci><cn id="A1.E29.m2.5.5.3.3.5.3.cmml" type="integer" xref="A1.E29.m2.5.5.3.3.5.3">2</cn></apply><ci id="A1.E29.m2.5.5.3.3.6.cmml" xref="A1.E29.m2.5.5.3.3.6">𝐿</ci><list id="A1.E29.m2.5.5.3.3.2.3.cmml" xref="A1.E29.m2.5.5.3.3.2.2"><ci id="A1.E29.m2.2.2.cmml" xref="A1.E29.m2.2.2">𝑓</ci><apply id="A1.E29.m2.4.4.2.2.1.1.1.cmml" xref="A1.E29.m2.4.4.2.2.1.1.1"><times id="A1.E29.m2.4.4.2.2.1.1.1.1.cmml" xref="A1.E29.m2.4.4.2.2.1.1.1.1"></times><ci id="A1.E29.m2.4.4.2.2.1.1.1.2.cmml" xref="A1.E29.m2.4.4.2.2.1.1.1.2">𝛿</ci><ci id="A1.E29.m2.4.4.2.2.1.1.1.3.cmml" xref="A1.E29.m2.4.4.2.2.1.1.1.3">𝑓</ci></apply><apply id="A1.E29.m2.5.5.3.3.2.2.2.cmml" xref="A1.E29.m2.5.5.3.3.2.2.2"><times id="A1.E29.m2.5.5.3.3.2.2.2.1.cmml" xref="A1.E29.m2.5.5.3.3.2.2.2.1"></times><ci id="A1.E29.m2.5.5.3.3.2.2.2.2.cmml" xref="A1.E29.m2.5.5.3.3.2.2.2.2">𝛿</ci><ci id="A1.E29.m2.5.5.3.3.2.2.2.3.cmml" xref="A1.E29.m2.5.5.3.3.2.2.2.3">𝑓</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E29.m2.5c">\displaystyle=\delta L[f;\delta f]+\frac{1}{2}\delta^{2}L[f;\delta f,\delta f]</annotation><annotation encoding="application/x-llamapun" id="A1.E29.m2.5d">= italic_δ italic_L [ italic_f ; italic_δ italic_f ] + divide start_ARG 1 end_ARG start_ARG 2 end_ARG italic_δ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_L [ italic_f ; italic_δ italic_f , italic_δ italic_f ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(29)</span></td>
</tr></tbody>
<tbody id="A1.E30"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbb{E}_{\mathbf{x}\sim p}\delta f(\mathbf{x})-\mathbb{E}_{%
\mathbf{x}\sim q_{f}}\delta f(\mathbf{x})-\frac{1}{2}\textrm{Var}_{\mathbf{x}%
\sim q_{f}}\delta f(\mathbf{x})\,." class="ltx_Math" display="inline" id="A1.E30.m1.4"><semantics id="A1.E30.m1.4a"><mrow id="A1.E30.m1.4.4.1" xref="A1.E30.m1.4.4.1.1.cmml"><mrow id="A1.E30.m1.4.4.1.1" xref="A1.E30.m1.4.4.1.1.cmml"><mi id="A1.E30.m1.4.4.1.1.2" xref="A1.E30.m1.4.4.1.1.2.cmml"></mi><mo id="A1.E30.m1.4.4.1.1.1" xref="A1.E30.m1.4.4.1.1.1.cmml">=</mo><mrow id="A1.E30.m1.4.4.1.1.3" xref="A1.E30.m1.4.4.1.1.3.cmml"><mrow id="A1.E30.m1.4.4.1.1.3.2" xref="A1.E30.m1.4.4.1.1.3.2.cmml"><msub id="A1.E30.m1.4.4.1.1.3.2.2" xref="A1.E30.m1.4.4.1.1.3.2.2.cmml"><mi id="A1.E30.m1.4.4.1.1.3.2.2.2" xref="A1.E30.m1.4.4.1.1.3.2.2.2.cmml">𝔼</mi><mrow id="A1.E30.m1.4.4.1.1.3.2.2.3" xref="A1.E30.m1.4.4.1.1.3.2.2.3.cmml"><mi id="A1.E30.m1.4.4.1.1.3.2.2.3.2" xref="A1.E30.m1.4.4.1.1.3.2.2.3.2.cmml">𝐱</mi><mo id="A1.E30.m1.4.4.1.1.3.2.2.3.1" xref="A1.E30.m1.4.4.1.1.3.2.2.3.1.cmml">∼</mo><mi id="A1.E30.m1.4.4.1.1.3.2.2.3.3" xref="A1.E30.m1.4.4.1.1.3.2.2.3.3.cmml">p</mi></mrow></msub><mo id="A1.E30.m1.4.4.1.1.3.2.1" xref="A1.E30.m1.4.4.1.1.3.2.1.cmml">⁢</mo><mi id="A1.E30.m1.4.4.1.1.3.2.3" xref="A1.E30.m1.4.4.1.1.3.2.3.cmml">δ</mi><mo id="A1.E30.m1.4.4.1.1.3.2.1a" xref="A1.E30.m1.4.4.1.1.3.2.1.cmml">⁢</mo><mi id="A1.E30.m1.4.4.1.1.3.2.4" xref="A1.E30.m1.4.4.1.1.3.2.4.cmml">f</mi><mo id="A1.E30.m1.4.4.1.1.3.2.1b" xref="A1.E30.m1.4.4.1.1.3.2.1.cmml">⁢</mo><mrow id="A1.E30.m1.4.4.1.1.3.2.5.2" xref="A1.E30.m1.4.4.1.1.3.2.cmml"><mo id="A1.E30.m1.4.4.1.1.3.2.5.2.1" stretchy="false" xref="A1.E30.m1.4.4.1.1.3.2.cmml">(</mo><mi id="A1.E30.m1.1.1" xref="A1.E30.m1.1.1.cmml">𝐱</mi><mo id="A1.E30.m1.4.4.1.1.3.2.5.2.2" stretchy="false" xref="A1.E30.m1.4.4.1.1.3.2.cmml">)</mo></mrow></mrow><mo id="A1.E30.m1.4.4.1.1.3.1" xref="A1.E30.m1.4.4.1.1.3.1.cmml">−</mo><mrow id="A1.E30.m1.4.4.1.1.3.3" xref="A1.E30.m1.4.4.1.1.3.3.cmml"><msub id="A1.E30.m1.4.4.1.1.3.3.2" xref="A1.E30.m1.4.4.1.1.3.3.2.cmml"><mi id="A1.E30.m1.4.4.1.1.3.3.2.2" xref="A1.E30.m1.4.4.1.1.3.3.2.2.cmml">𝔼</mi><mrow id="A1.E30.m1.4.4.1.1.3.3.2.3" xref="A1.E30.m1.4.4.1.1.3.3.2.3.cmml"><mi id="A1.E30.m1.4.4.1.1.3.3.2.3.2" xref="A1.E30.m1.4.4.1.1.3.3.2.3.2.cmml">𝐱</mi><mo id="A1.E30.m1.4.4.1.1.3.3.2.3.1" xref="A1.E30.m1.4.4.1.1.3.3.2.3.1.cmml">∼</mo><msub id="A1.E30.m1.4.4.1.1.3.3.2.3.3" xref="A1.E30.m1.4.4.1.1.3.3.2.3.3.cmml"><mi id="A1.E30.m1.4.4.1.1.3.3.2.3.3.2" xref="A1.E30.m1.4.4.1.1.3.3.2.3.3.2.cmml">q</mi><mi id="A1.E30.m1.4.4.1.1.3.3.2.3.3.3" xref="A1.E30.m1.4.4.1.1.3.3.2.3.3.3.cmml">f</mi></msub></mrow></msub><mo id="A1.E30.m1.4.4.1.1.3.3.1" xref="A1.E30.m1.4.4.1.1.3.3.1.cmml">⁢</mo><mi id="A1.E30.m1.4.4.1.1.3.3.3" xref="A1.E30.m1.4.4.1.1.3.3.3.cmml">δ</mi><mo id="A1.E30.m1.4.4.1.1.3.3.1a" xref="A1.E30.m1.4.4.1.1.3.3.1.cmml">⁢</mo><mi id="A1.E30.m1.4.4.1.1.3.3.4" xref="A1.E30.m1.4.4.1.1.3.3.4.cmml">f</mi><mo id="A1.E30.m1.4.4.1.1.3.3.1b" xref="A1.E30.m1.4.4.1.1.3.3.1.cmml">⁢</mo><mrow id="A1.E30.m1.4.4.1.1.3.3.5.2" xref="A1.E30.m1.4.4.1.1.3.3.cmml"><mo id="A1.E30.m1.4.4.1.1.3.3.5.2.1" stretchy="false" xref="A1.E30.m1.4.4.1.1.3.3.cmml">(</mo><mi id="A1.E30.m1.2.2" xref="A1.E30.m1.2.2.cmml">𝐱</mi><mo id="A1.E30.m1.4.4.1.1.3.3.5.2.2" stretchy="false" xref="A1.E30.m1.4.4.1.1.3.3.cmml">)</mo></mrow></mrow><mo id="A1.E30.m1.4.4.1.1.3.1a" xref="A1.E30.m1.4.4.1.1.3.1.cmml">−</mo><mrow id="A1.E30.m1.4.4.1.1.3.4" xref="A1.E30.m1.4.4.1.1.3.4.cmml"><mstyle displaystyle="true" id="A1.E30.m1.4.4.1.1.3.4.2" xref="A1.E30.m1.4.4.1.1.3.4.2.cmml"><mfrac id="A1.E30.m1.4.4.1.1.3.4.2a" xref="A1.E30.m1.4.4.1.1.3.4.2.cmml"><mn id="A1.E30.m1.4.4.1.1.3.4.2.2" xref="A1.E30.m1.4.4.1.1.3.4.2.2.cmml">1</mn><mn id="A1.E30.m1.4.4.1.1.3.4.2.3" xref="A1.E30.m1.4.4.1.1.3.4.2.3.cmml">2</mn></mfrac></mstyle><mo id="A1.E30.m1.4.4.1.1.3.4.1" xref="A1.E30.m1.4.4.1.1.3.4.1.cmml">⁢</mo><msub id="A1.E30.m1.4.4.1.1.3.4.3" xref="A1.E30.m1.4.4.1.1.3.4.3.cmml"><mtext id="A1.E30.m1.4.4.1.1.3.4.3.2" xref="A1.E30.m1.4.4.1.1.3.4.3.2a.cmml">Var</mtext><mrow id="A1.E30.m1.4.4.1.1.3.4.3.3" xref="A1.E30.m1.4.4.1.1.3.4.3.3.cmml"><mi id="A1.E30.m1.4.4.1.1.3.4.3.3.2" xref="A1.E30.m1.4.4.1.1.3.4.3.3.2.cmml">𝐱</mi><mo id="A1.E30.m1.4.4.1.1.3.4.3.3.1" xref="A1.E30.m1.4.4.1.1.3.4.3.3.1.cmml">∼</mo><msub id="A1.E30.m1.4.4.1.1.3.4.3.3.3" xref="A1.E30.m1.4.4.1.1.3.4.3.3.3.cmml"><mi id="A1.E30.m1.4.4.1.1.3.4.3.3.3.2" xref="A1.E30.m1.4.4.1.1.3.4.3.3.3.2.cmml">q</mi><mi id="A1.E30.m1.4.4.1.1.3.4.3.3.3.3" xref="A1.E30.m1.4.4.1.1.3.4.3.3.3.3.cmml">f</mi></msub></mrow></msub><mo id="A1.E30.m1.4.4.1.1.3.4.1a" xref="A1.E30.m1.4.4.1.1.3.4.1.cmml">⁢</mo><mi id="A1.E30.m1.4.4.1.1.3.4.4" xref="A1.E30.m1.4.4.1.1.3.4.4.cmml">δ</mi><mo id="A1.E30.m1.4.4.1.1.3.4.1b" xref="A1.E30.m1.4.4.1.1.3.4.1.cmml">⁢</mo><mi id="A1.E30.m1.4.4.1.1.3.4.5" xref="A1.E30.m1.4.4.1.1.3.4.5.cmml">f</mi><mo id="A1.E30.m1.4.4.1.1.3.4.1c" xref="A1.E30.m1.4.4.1.1.3.4.1.cmml">⁢</mo><mrow id="A1.E30.m1.4.4.1.1.3.4.6.2" xref="A1.E30.m1.4.4.1.1.3.4.cmml"><mo id="A1.E30.m1.4.4.1.1.3.4.6.2.1" stretchy="false" xref="A1.E30.m1.4.4.1.1.3.4.cmml">(</mo><mi id="A1.E30.m1.3.3" xref="A1.E30.m1.3.3.cmml">𝐱</mi><mo id="A1.E30.m1.4.4.1.1.3.4.6.2.2" stretchy="false" xref="A1.E30.m1.4.4.1.1.3.4.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A1.E30.m1.4.4.1.2" lspace="0.170em" xref="A1.E30.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E30.m1.4b"><apply id="A1.E30.m1.4.4.1.1.cmml" xref="A1.E30.m1.4.4.1"><eq id="A1.E30.m1.4.4.1.1.1.cmml" xref="A1.E30.m1.4.4.1.1.1"></eq><csymbol cd="latexml" id="A1.E30.m1.4.4.1.1.2.cmml" xref="A1.E30.m1.4.4.1.1.2">absent</csymbol><apply id="A1.E30.m1.4.4.1.1.3.cmml" xref="A1.E30.m1.4.4.1.1.3"><minus id="A1.E30.m1.4.4.1.1.3.1.cmml" xref="A1.E30.m1.4.4.1.1.3.1"></minus><apply id="A1.E30.m1.4.4.1.1.3.2.cmml" xref="A1.E30.m1.4.4.1.1.3.2"><times id="A1.E30.m1.4.4.1.1.3.2.1.cmml" xref="A1.E30.m1.4.4.1.1.3.2.1"></times><apply id="A1.E30.m1.4.4.1.1.3.2.2.cmml" xref="A1.E30.m1.4.4.1.1.3.2.2"><csymbol cd="ambiguous" id="A1.E30.m1.4.4.1.1.3.2.2.1.cmml" xref="A1.E30.m1.4.4.1.1.3.2.2">subscript</csymbol><ci id="A1.E30.m1.4.4.1.1.3.2.2.2.cmml" xref="A1.E30.m1.4.4.1.1.3.2.2.2">𝔼</ci><apply id="A1.E30.m1.4.4.1.1.3.2.2.3.cmml" xref="A1.E30.m1.4.4.1.1.3.2.2.3"><csymbol cd="latexml" id="A1.E30.m1.4.4.1.1.3.2.2.3.1.cmml" xref="A1.E30.m1.4.4.1.1.3.2.2.3.1">similar-to</csymbol><ci id="A1.E30.m1.4.4.1.1.3.2.2.3.2.cmml" xref="A1.E30.m1.4.4.1.1.3.2.2.3.2">𝐱</ci><ci id="A1.E30.m1.4.4.1.1.3.2.2.3.3.cmml" xref="A1.E30.m1.4.4.1.1.3.2.2.3.3">𝑝</ci></apply></apply><ci id="A1.E30.m1.4.4.1.1.3.2.3.cmml" xref="A1.E30.m1.4.4.1.1.3.2.3">𝛿</ci><ci id="A1.E30.m1.4.4.1.1.3.2.4.cmml" xref="A1.E30.m1.4.4.1.1.3.2.4">𝑓</ci><ci id="A1.E30.m1.1.1.cmml" xref="A1.E30.m1.1.1">𝐱</ci></apply><apply id="A1.E30.m1.4.4.1.1.3.3.cmml" xref="A1.E30.m1.4.4.1.1.3.3"><times id="A1.E30.m1.4.4.1.1.3.3.1.cmml" xref="A1.E30.m1.4.4.1.1.3.3.1"></times><apply id="A1.E30.m1.4.4.1.1.3.3.2.cmml" xref="A1.E30.m1.4.4.1.1.3.3.2"><csymbol cd="ambiguous" id="A1.E30.m1.4.4.1.1.3.3.2.1.cmml" xref="A1.E30.m1.4.4.1.1.3.3.2">subscript</csymbol><ci id="A1.E30.m1.4.4.1.1.3.3.2.2.cmml" xref="A1.E30.m1.4.4.1.1.3.3.2.2">𝔼</ci><apply id="A1.E30.m1.4.4.1.1.3.3.2.3.cmml" xref="A1.E30.m1.4.4.1.1.3.3.2.3"><csymbol cd="latexml" id="A1.E30.m1.4.4.1.1.3.3.2.3.1.cmml" xref="A1.E30.m1.4.4.1.1.3.3.2.3.1">similar-to</csymbol><ci id="A1.E30.m1.4.4.1.1.3.3.2.3.2.cmml" xref="A1.E30.m1.4.4.1.1.3.3.2.3.2">𝐱</ci><apply id="A1.E30.m1.4.4.1.1.3.3.2.3.3.cmml" xref="A1.E30.m1.4.4.1.1.3.3.2.3.3"><csymbol cd="ambiguous" id="A1.E30.m1.4.4.1.1.3.3.2.3.3.1.cmml" xref="A1.E30.m1.4.4.1.1.3.3.2.3.3">subscript</csymbol><ci id="A1.E30.m1.4.4.1.1.3.3.2.3.3.2.cmml" xref="A1.E30.m1.4.4.1.1.3.3.2.3.3.2">𝑞</ci><ci id="A1.E30.m1.4.4.1.1.3.3.2.3.3.3.cmml" xref="A1.E30.m1.4.4.1.1.3.3.2.3.3.3">𝑓</ci></apply></apply></apply><ci id="A1.E30.m1.4.4.1.1.3.3.3.cmml" xref="A1.E30.m1.4.4.1.1.3.3.3">𝛿</ci><ci id="A1.E30.m1.4.4.1.1.3.3.4.cmml" xref="A1.E30.m1.4.4.1.1.3.3.4">𝑓</ci><ci id="A1.E30.m1.2.2.cmml" xref="A1.E30.m1.2.2">𝐱</ci></apply><apply id="A1.E30.m1.4.4.1.1.3.4.cmml" xref="A1.E30.m1.4.4.1.1.3.4"><times id="A1.E30.m1.4.4.1.1.3.4.1.cmml" xref="A1.E30.m1.4.4.1.1.3.4.1"></times><apply id="A1.E30.m1.4.4.1.1.3.4.2.cmml" xref="A1.E30.m1.4.4.1.1.3.4.2"><divide id="A1.E30.m1.4.4.1.1.3.4.2.1.cmml" xref="A1.E30.m1.4.4.1.1.3.4.2"></divide><cn id="A1.E30.m1.4.4.1.1.3.4.2.2.cmml" type="integer" xref="A1.E30.m1.4.4.1.1.3.4.2.2">1</cn><cn id="A1.E30.m1.4.4.1.1.3.4.2.3.cmml" type="integer" xref="A1.E30.m1.4.4.1.1.3.4.2.3">2</cn></apply><apply id="A1.E30.m1.4.4.1.1.3.4.3.cmml" xref="A1.E30.m1.4.4.1.1.3.4.3"><csymbol cd="ambiguous" id="A1.E30.m1.4.4.1.1.3.4.3.1.cmml" xref="A1.E30.m1.4.4.1.1.3.4.3">subscript</csymbol><ci id="A1.E30.m1.4.4.1.1.3.4.3.2a.cmml" xref="A1.E30.m1.4.4.1.1.3.4.3.2"><mtext id="A1.E30.m1.4.4.1.1.3.4.3.2.cmml" xref="A1.E30.m1.4.4.1.1.3.4.3.2">Var</mtext></ci><apply id="A1.E30.m1.4.4.1.1.3.4.3.3.cmml" xref="A1.E30.m1.4.4.1.1.3.4.3.3"><csymbol cd="latexml" id="A1.E30.m1.4.4.1.1.3.4.3.3.1.cmml" xref="A1.E30.m1.4.4.1.1.3.4.3.3.1">similar-to</csymbol><ci id="A1.E30.m1.4.4.1.1.3.4.3.3.2.cmml" xref="A1.E30.m1.4.4.1.1.3.4.3.3.2">𝐱</ci><apply id="A1.E30.m1.4.4.1.1.3.4.3.3.3.cmml" xref="A1.E30.m1.4.4.1.1.3.4.3.3.3"><csymbol cd="ambiguous" id="A1.E30.m1.4.4.1.1.3.4.3.3.3.1.cmml" xref="A1.E30.m1.4.4.1.1.3.4.3.3.3">subscript</csymbol><ci id="A1.E30.m1.4.4.1.1.3.4.3.3.3.2.cmml" xref="A1.E30.m1.4.4.1.1.3.4.3.3.3.2">𝑞</ci><ci id="A1.E30.m1.4.4.1.1.3.4.3.3.3.3.cmml" xref="A1.E30.m1.4.4.1.1.3.4.3.3.3.3">𝑓</ci></apply></apply></apply><ci id="A1.E30.m1.4.4.1.1.3.4.4.cmml" xref="A1.E30.m1.4.4.1.1.3.4.4">𝛿</ci><ci id="A1.E30.m1.4.4.1.1.3.4.5.cmml" xref="A1.E30.m1.4.4.1.1.3.4.5">𝑓</ci><ci id="A1.E30.m1.3.3.cmml" xref="A1.E30.m1.3.3">𝐱</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E30.m1.4c">\displaystyle=\mathbb{E}_{\mathbf{x}\sim p}\delta f(\mathbf{x})-\mathbb{E}_{%
\mathbf{x}\sim q_{f}}\delta f(\mathbf{x})-\frac{1}{2}\textrm{Var}_{\mathbf{x}%
\sim q_{f}}\delta f(\mathbf{x})\,.</annotation><annotation encoding="application/x-llamapun" id="A1.E30.m1.4d">= blackboard_E start_POSTSUBSCRIPT bold_x ∼ italic_p end_POSTSUBSCRIPT italic_δ italic_f ( bold_x ) - blackboard_E start_POSTSUBSCRIPT bold_x ∼ italic_q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_δ italic_f ( bold_x ) - divide start_ARG 1 end_ARG start_ARG 2 end_ARG Var start_POSTSUBSCRIPT bold_x ∼ italic_q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_δ italic_f ( bold_x ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(30)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A1.p6">
<p class="ltx_p" id="A1.p6.2">As an aside, defining the functional derivative, <math alttext="\frac{\delta J[f]}{\delta f(\mathbf{x})}" class="ltx_Math" display="inline" id="A1.p6.1.m1.2"><semantics id="A1.p6.1.m1.2a"><mfrac id="A1.p6.1.m1.2.2" xref="A1.p6.1.m1.2.2.cmml"><mrow id="A1.p6.1.m1.1.1.1" xref="A1.p6.1.m1.1.1.1.cmml"><mi id="A1.p6.1.m1.1.1.1.3" xref="A1.p6.1.m1.1.1.1.3.cmml">δ</mi><mo id="A1.p6.1.m1.1.1.1.2" xref="A1.p6.1.m1.1.1.1.2.cmml">⁢</mo><mi id="A1.p6.1.m1.1.1.1.4" xref="A1.p6.1.m1.1.1.1.4.cmml">J</mi><mo id="A1.p6.1.m1.1.1.1.2a" xref="A1.p6.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="A1.p6.1.m1.1.1.1.5.2" xref="A1.p6.1.m1.1.1.1.5.1.cmml"><mo id="A1.p6.1.m1.1.1.1.5.2.1" stretchy="false" xref="A1.p6.1.m1.1.1.1.5.1.1.cmml">[</mo><mi id="A1.p6.1.m1.1.1.1.1" xref="A1.p6.1.m1.1.1.1.1.cmml">f</mi><mo id="A1.p6.1.m1.1.1.1.5.2.2" stretchy="false" xref="A1.p6.1.m1.1.1.1.5.1.1.cmml">]</mo></mrow></mrow><mrow id="A1.p6.1.m1.2.2.2" xref="A1.p6.1.m1.2.2.2.cmml"><mi id="A1.p6.1.m1.2.2.2.3" xref="A1.p6.1.m1.2.2.2.3.cmml">δ</mi><mo id="A1.p6.1.m1.2.2.2.2" xref="A1.p6.1.m1.2.2.2.2.cmml">⁢</mo><mi id="A1.p6.1.m1.2.2.2.4" xref="A1.p6.1.m1.2.2.2.4.cmml">f</mi><mo id="A1.p6.1.m1.2.2.2.2a" xref="A1.p6.1.m1.2.2.2.2.cmml">⁢</mo><mrow id="A1.p6.1.m1.2.2.2.5.2" xref="A1.p6.1.m1.2.2.2.cmml"><mo id="A1.p6.1.m1.2.2.2.5.2.1" stretchy="false" xref="A1.p6.1.m1.2.2.2.cmml">(</mo><mi id="A1.p6.1.m1.2.2.2.1" xref="A1.p6.1.m1.2.2.2.1.cmml">𝐱</mi><mo id="A1.p6.1.m1.2.2.2.5.2.2" stretchy="false" xref="A1.p6.1.m1.2.2.2.cmml">)</mo></mrow></mrow></mfrac><annotation-xml encoding="MathML-Content" id="A1.p6.1.m1.2b"><apply id="A1.p6.1.m1.2.2.cmml" xref="A1.p6.1.m1.2.2"><divide id="A1.p6.1.m1.2.2.3.cmml" xref="A1.p6.1.m1.2.2"></divide><apply id="A1.p6.1.m1.1.1.1.cmml" xref="A1.p6.1.m1.1.1.1"><times id="A1.p6.1.m1.1.1.1.2.cmml" xref="A1.p6.1.m1.1.1.1.2"></times><ci id="A1.p6.1.m1.1.1.1.3.cmml" xref="A1.p6.1.m1.1.1.1.3">𝛿</ci><ci id="A1.p6.1.m1.1.1.1.4.cmml" xref="A1.p6.1.m1.1.1.1.4">𝐽</ci><apply id="A1.p6.1.m1.1.1.1.5.1.cmml" xref="A1.p6.1.m1.1.1.1.5.2"><csymbol cd="latexml" id="A1.p6.1.m1.1.1.1.5.1.1.cmml" xref="A1.p6.1.m1.1.1.1.5.2.1">delimited-[]</csymbol><ci id="A1.p6.1.m1.1.1.1.1.cmml" xref="A1.p6.1.m1.1.1.1.1">𝑓</ci></apply></apply><apply id="A1.p6.1.m1.2.2.2.cmml" xref="A1.p6.1.m1.2.2.2"><times id="A1.p6.1.m1.2.2.2.2.cmml" xref="A1.p6.1.m1.2.2.2.2"></times><ci id="A1.p6.1.m1.2.2.2.3.cmml" xref="A1.p6.1.m1.2.2.2.3">𝛿</ci><ci id="A1.p6.1.m1.2.2.2.4.cmml" xref="A1.p6.1.m1.2.2.2.4">𝑓</ci><ci id="A1.p6.1.m1.2.2.2.1.cmml" xref="A1.p6.1.m1.2.2.2.1">𝐱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p6.1.m1.2c">\frac{\delta J[f]}{\delta f(\mathbf{x})}</annotation><annotation encoding="application/x-llamapun" id="A1.p6.1.m1.2d">divide start_ARG italic_δ italic_J [ italic_f ] end_ARG start_ARG italic_δ italic_f ( bold_x ) end_ARG</annotation></semantics></math>, of a functional <math alttext="J" class="ltx_Math" display="inline" id="A1.p6.2.m2.1"><semantics id="A1.p6.2.m2.1a"><mi id="A1.p6.2.m2.1.1" xref="A1.p6.2.m2.1.1.cmml">J</mi><annotation-xml encoding="MathML-Content" id="A1.p6.2.m2.1b"><ci id="A1.p6.2.m2.1.1.cmml" xref="A1.p6.2.m2.1.1">𝐽</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p6.2.m2.1c">J</annotation><annotation encoding="application/x-llamapun" id="A1.p6.2.m2.1d">italic_J</annotation></semantics></math> implicitly by:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E31">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\sum_{\mathbf{x}}\frac{\delta J[f]}{\delta f(\mathbf{x})}g(\mathbf{x})=\delta J%
[f;g]\,," class="ltx_Math" display="block" id="A1.E31.m1.6"><semantics id="A1.E31.m1.6a"><mrow id="A1.E31.m1.6.6.1" xref="A1.E31.m1.6.6.1.1.cmml"><mrow id="A1.E31.m1.6.6.1.1" xref="A1.E31.m1.6.6.1.1.cmml"><mrow id="A1.E31.m1.6.6.1.1.2" xref="A1.E31.m1.6.6.1.1.2.cmml"><munder id="A1.E31.m1.6.6.1.1.2.1" xref="A1.E31.m1.6.6.1.1.2.1.cmml"><mo id="A1.E31.m1.6.6.1.1.2.1.2" movablelimits="false" xref="A1.E31.m1.6.6.1.1.2.1.2.cmml">∑</mo><mi id="A1.E31.m1.6.6.1.1.2.1.3" xref="A1.E31.m1.6.6.1.1.2.1.3.cmml">𝐱</mi></munder><mrow id="A1.E31.m1.6.6.1.1.2.2" xref="A1.E31.m1.6.6.1.1.2.2.cmml"><mfrac id="A1.E31.m1.2.2" xref="A1.E31.m1.2.2.cmml"><mrow id="A1.E31.m1.1.1.1" xref="A1.E31.m1.1.1.1.cmml"><mi id="A1.E31.m1.1.1.1.3" xref="A1.E31.m1.1.1.1.3.cmml">δ</mi><mo id="A1.E31.m1.1.1.1.2" xref="A1.E31.m1.1.1.1.2.cmml">⁢</mo><mi id="A1.E31.m1.1.1.1.4" xref="A1.E31.m1.1.1.1.4.cmml">J</mi><mo id="A1.E31.m1.1.1.1.2a" xref="A1.E31.m1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E31.m1.1.1.1.5.2" xref="A1.E31.m1.1.1.1.5.1.cmml"><mo id="A1.E31.m1.1.1.1.5.2.1" stretchy="false" xref="A1.E31.m1.1.1.1.5.1.1.cmml">[</mo><mi id="A1.E31.m1.1.1.1.1" xref="A1.E31.m1.1.1.1.1.cmml">f</mi><mo id="A1.E31.m1.1.1.1.5.2.2" stretchy="false" xref="A1.E31.m1.1.1.1.5.1.1.cmml">]</mo></mrow></mrow><mrow id="A1.E31.m1.2.2.2" xref="A1.E31.m1.2.2.2.cmml"><mi id="A1.E31.m1.2.2.2.3" xref="A1.E31.m1.2.2.2.3.cmml">δ</mi><mo id="A1.E31.m1.2.2.2.2" xref="A1.E31.m1.2.2.2.2.cmml">⁢</mo><mi id="A1.E31.m1.2.2.2.4" xref="A1.E31.m1.2.2.2.4.cmml">f</mi><mo id="A1.E31.m1.2.2.2.2a" xref="A1.E31.m1.2.2.2.2.cmml">⁢</mo><mrow id="A1.E31.m1.2.2.2.5.2" xref="A1.E31.m1.2.2.2.cmml"><mo id="A1.E31.m1.2.2.2.5.2.1" stretchy="false" xref="A1.E31.m1.2.2.2.cmml">(</mo><mi id="A1.E31.m1.2.2.2.1" xref="A1.E31.m1.2.2.2.1.cmml">𝐱</mi><mo id="A1.E31.m1.2.2.2.5.2.2" stretchy="false" xref="A1.E31.m1.2.2.2.cmml">)</mo></mrow></mrow></mfrac><mo id="A1.E31.m1.6.6.1.1.2.2.1" xref="A1.E31.m1.6.6.1.1.2.2.1.cmml">⁢</mo><mi id="A1.E31.m1.6.6.1.1.2.2.2" xref="A1.E31.m1.6.6.1.1.2.2.2.cmml">g</mi><mo id="A1.E31.m1.6.6.1.1.2.2.1a" xref="A1.E31.m1.6.6.1.1.2.2.1.cmml">⁢</mo><mrow id="A1.E31.m1.6.6.1.1.2.2.3.2" xref="A1.E31.m1.6.6.1.1.2.2.cmml"><mo id="A1.E31.m1.6.6.1.1.2.2.3.2.1" stretchy="false" xref="A1.E31.m1.6.6.1.1.2.2.cmml">(</mo><mi id="A1.E31.m1.3.3" xref="A1.E31.m1.3.3.cmml">𝐱</mi><mo id="A1.E31.m1.6.6.1.1.2.2.3.2.2" stretchy="false" xref="A1.E31.m1.6.6.1.1.2.2.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E31.m1.6.6.1.1.1" xref="A1.E31.m1.6.6.1.1.1.cmml">=</mo><mrow id="A1.E31.m1.6.6.1.1.3" xref="A1.E31.m1.6.6.1.1.3.cmml"><mi id="A1.E31.m1.6.6.1.1.3.2" xref="A1.E31.m1.6.6.1.1.3.2.cmml">δ</mi><mo id="A1.E31.m1.6.6.1.1.3.1" xref="A1.E31.m1.6.6.1.1.3.1.cmml">⁢</mo><mi id="A1.E31.m1.6.6.1.1.3.3" xref="A1.E31.m1.6.6.1.1.3.3.cmml">J</mi><mo id="A1.E31.m1.6.6.1.1.3.1a" xref="A1.E31.m1.6.6.1.1.3.1.cmml">⁢</mo><mrow id="A1.E31.m1.6.6.1.1.3.4.2" xref="A1.E31.m1.6.6.1.1.3.4.1.cmml"><mo id="A1.E31.m1.6.6.1.1.3.4.2.1" stretchy="false" xref="A1.E31.m1.6.6.1.1.3.4.1.cmml">[</mo><mi id="A1.E31.m1.4.4" xref="A1.E31.m1.4.4.cmml">f</mi><mo id="A1.E31.m1.6.6.1.1.3.4.2.2" xref="A1.E31.m1.6.6.1.1.3.4.1.cmml">;</mo><mi id="A1.E31.m1.5.5" xref="A1.E31.m1.5.5.cmml">g</mi><mo id="A1.E31.m1.6.6.1.1.3.4.2.3" rspace="0.170em" stretchy="false" xref="A1.E31.m1.6.6.1.1.3.4.1.cmml">]</mo></mrow></mrow></mrow><mo id="A1.E31.m1.6.6.1.2" xref="A1.E31.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E31.m1.6b"><apply id="A1.E31.m1.6.6.1.1.cmml" xref="A1.E31.m1.6.6.1"><eq id="A1.E31.m1.6.6.1.1.1.cmml" xref="A1.E31.m1.6.6.1.1.1"></eq><apply id="A1.E31.m1.6.6.1.1.2.cmml" xref="A1.E31.m1.6.6.1.1.2"><apply id="A1.E31.m1.6.6.1.1.2.1.cmml" xref="A1.E31.m1.6.6.1.1.2.1"><csymbol cd="ambiguous" id="A1.E31.m1.6.6.1.1.2.1.1.cmml" xref="A1.E31.m1.6.6.1.1.2.1">subscript</csymbol><sum id="A1.E31.m1.6.6.1.1.2.1.2.cmml" xref="A1.E31.m1.6.6.1.1.2.1.2"></sum><ci id="A1.E31.m1.6.6.1.1.2.1.3.cmml" xref="A1.E31.m1.6.6.1.1.2.1.3">𝐱</ci></apply><apply id="A1.E31.m1.6.6.1.1.2.2.cmml" xref="A1.E31.m1.6.6.1.1.2.2"><times id="A1.E31.m1.6.6.1.1.2.2.1.cmml" xref="A1.E31.m1.6.6.1.1.2.2.1"></times><apply id="A1.E31.m1.2.2.cmml" xref="A1.E31.m1.2.2"><divide id="A1.E31.m1.2.2.3.cmml" xref="A1.E31.m1.2.2"></divide><apply id="A1.E31.m1.1.1.1.cmml" xref="A1.E31.m1.1.1.1"><times id="A1.E31.m1.1.1.1.2.cmml" xref="A1.E31.m1.1.1.1.2"></times><ci id="A1.E31.m1.1.1.1.3.cmml" xref="A1.E31.m1.1.1.1.3">𝛿</ci><ci id="A1.E31.m1.1.1.1.4.cmml" xref="A1.E31.m1.1.1.1.4">𝐽</ci><apply id="A1.E31.m1.1.1.1.5.1.cmml" xref="A1.E31.m1.1.1.1.5.2"><csymbol cd="latexml" id="A1.E31.m1.1.1.1.5.1.1.cmml" xref="A1.E31.m1.1.1.1.5.2.1">delimited-[]</csymbol><ci id="A1.E31.m1.1.1.1.1.cmml" xref="A1.E31.m1.1.1.1.1">𝑓</ci></apply></apply><apply id="A1.E31.m1.2.2.2.cmml" xref="A1.E31.m1.2.2.2"><times id="A1.E31.m1.2.2.2.2.cmml" xref="A1.E31.m1.2.2.2.2"></times><ci id="A1.E31.m1.2.2.2.3.cmml" xref="A1.E31.m1.2.2.2.3">𝛿</ci><ci id="A1.E31.m1.2.2.2.4.cmml" xref="A1.E31.m1.2.2.2.4">𝑓</ci><ci id="A1.E31.m1.2.2.2.1.cmml" xref="A1.E31.m1.2.2.2.1">𝐱</ci></apply></apply><ci id="A1.E31.m1.6.6.1.1.2.2.2.cmml" xref="A1.E31.m1.6.6.1.1.2.2.2">𝑔</ci><ci id="A1.E31.m1.3.3.cmml" xref="A1.E31.m1.3.3">𝐱</ci></apply></apply><apply id="A1.E31.m1.6.6.1.1.3.cmml" xref="A1.E31.m1.6.6.1.1.3"><times id="A1.E31.m1.6.6.1.1.3.1.cmml" xref="A1.E31.m1.6.6.1.1.3.1"></times><ci id="A1.E31.m1.6.6.1.1.3.2.cmml" xref="A1.E31.m1.6.6.1.1.3.2">𝛿</ci><ci id="A1.E31.m1.6.6.1.1.3.3.cmml" xref="A1.E31.m1.6.6.1.1.3.3">𝐽</ci><list id="A1.E31.m1.6.6.1.1.3.4.1.cmml" xref="A1.E31.m1.6.6.1.1.3.4.2"><ci id="A1.E31.m1.4.4.cmml" xref="A1.E31.m1.4.4">𝑓</ci><ci id="A1.E31.m1.5.5.cmml" xref="A1.E31.m1.5.5">𝑔</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E31.m1.6c">\sum_{\mathbf{x}}\frac{\delta J[f]}{\delta f(\mathbf{x})}g(\mathbf{x})=\delta J%
[f;g]\,,</annotation><annotation encoding="application/x-llamapun" id="A1.E31.m1.6d">∑ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT divide start_ARG italic_δ italic_J [ italic_f ] end_ARG start_ARG italic_δ italic_f ( bold_x ) end_ARG italic_g ( bold_x ) = italic_δ italic_J [ italic_f ; italic_g ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(31)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.p6.5">we can formally define, by analogy with the parametric case, the Fisher Information "Matrix" (FIM) at <math alttext="f" class="ltx_Math" display="inline" id="A1.p6.3.m1.1"><semantics id="A1.p6.3.m1.1a"><mi id="A1.p6.3.m1.1.1" xref="A1.p6.3.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="A1.p6.3.m1.1b"><ci id="A1.p6.3.m1.1.1.cmml" xref="A1.p6.3.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p6.3.m1.1c">f</annotation><annotation encoding="application/x-llamapun" id="A1.p6.3.m1.1d">italic_f</annotation></semantics></math> as the following bilinear functional of two independent variations <math alttext="g" class="ltx_Math" display="inline" id="A1.p6.4.m2.1"><semantics id="A1.p6.4.m2.1a"><mi id="A1.p6.4.m2.1.1" xref="A1.p6.4.m2.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="A1.p6.4.m2.1b"><ci id="A1.p6.4.m2.1.1.cmml" xref="A1.p6.4.m2.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p6.4.m2.1c">g</annotation><annotation encoding="application/x-llamapun" id="A1.p6.4.m2.1d">italic_g</annotation></semantics></math> and <math alttext="h" class="ltx_Math" display="inline" id="A1.p6.5.m3.1"><semantics id="A1.p6.5.m3.1a"><mi id="A1.p6.5.m3.1.1" xref="A1.p6.5.m3.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="A1.p6.5.m3.1b"><ci id="A1.p6.5.m3.1.1.cmml" xref="A1.p6.5.m3.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p6.5.m3.1c">h</annotation><annotation encoding="application/x-llamapun" id="A1.p6.5.m3.1d">italic_h</annotation></semantics></math>:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A5.EGx5">
<tbody id="A1.E32"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle F[f;g,h]" class="ltx_Math" display="inline" id="A1.E32.m1.3"><semantics id="A1.E32.m1.3a"><mrow id="A1.E32.m1.3.4" xref="A1.E32.m1.3.4.cmml"><mi id="A1.E32.m1.3.4.2" xref="A1.E32.m1.3.4.2.cmml">F</mi><mo id="A1.E32.m1.3.4.1" xref="A1.E32.m1.3.4.1.cmml">⁢</mo><mrow id="A1.E32.m1.3.4.3.2" xref="A1.E32.m1.3.4.3.1.cmml"><mo id="A1.E32.m1.3.4.3.2.1" stretchy="false" xref="A1.E32.m1.3.4.3.1.cmml">[</mo><mi id="A1.E32.m1.1.1" xref="A1.E32.m1.1.1.cmml">f</mi><mo id="A1.E32.m1.3.4.3.2.2" xref="A1.E32.m1.3.4.3.1.cmml">;</mo><mi id="A1.E32.m1.2.2" xref="A1.E32.m1.2.2.cmml">g</mi><mo id="A1.E32.m1.3.4.3.2.3" xref="A1.E32.m1.3.4.3.1.cmml">,</mo><mi id="A1.E32.m1.3.3" xref="A1.E32.m1.3.3.cmml">h</mi><mo id="A1.E32.m1.3.4.3.2.4" stretchy="false" xref="A1.E32.m1.3.4.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E32.m1.3b"><apply id="A1.E32.m1.3.4.cmml" xref="A1.E32.m1.3.4"><times id="A1.E32.m1.3.4.1.cmml" xref="A1.E32.m1.3.4.1"></times><ci id="A1.E32.m1.3.4.2.cmml" xref="A1.E32.m1.3.4.2">𝐹</ci><list id="A1.E32.m1.3.4.3.1.cmml" xref="A1.E32.m1.3.4.3.2"><ci id="A1.E32.m1.1.1.cmml" xref="A1.E32.m1.1.1">𝑓</ci><ci id="A1.E32.m1.2.2.cmml" xref="A1.E32.m1.2.2">𝑔</ci><ci id="A1.E32.m1.3.3.cmml" xref="A1.E32.m1.3.3">ℎ</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E32.m1.3c">\displaystyle F[f;g,h]</annotation><annotation encoding="application/x-llamapun" id="A1.E32.m1.3d">italic_F [ italic_f ; italic_g , italic_h ]</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\coloneqq-\sum_{\mathbf{y},\mathbf{z}}\left[\mathbb{E}_{\mathbf{x%
}\sim q_{f}}\frac{\delta^{2}\log q_{f}(\mathbf{x})}{\delta f(\mathbf{y})\delta
f%
(\mathbf{z})}\right]g(\mathbf{y})h(\mathbf{z})" class="ltx_Math" display="inline" id="A1.E32.m2.8"><semantics id="A1.E32.m2.8a"><mrow id="A1.E32.m2.8.8" xref="A1.E32.m2.8.8.cmml"><mi id="A1.E32.m2.8.8.3" xref="A1.E32.m2.8.8.3.cmml"></mi><mo id="A1.E32.m2.8.8.2" xref="A1.E32.m2.8.8.2.cmml">≔</mo><mrow id="A1.E32.m2.8.8.1" xref="A1.E32.m2.8.8.1.cmml"><mo id="A1.E32.m2.8.8.1a" xref="A1.E32.m2.8.8.1.cmml">−</mo><mrow id="A1.E32.m2.8.8.1.1" xref="A1.E32.m2.8.8.1.1.cmml"><mstyle displaystyle="true" id="A1.E32.m2.8.8.1.1.2" xref="A1.E32.m2.8.8.1.1.2.cmml"><munder id="A1.E32.m2.8.8.1.1.2a" xref="A1.E32.m2.8.8.1.1.2.cmml"><mo id="A1.E32.m2.8.8.1.1.2.2" movablelimits="false" xref="A1.E32.m2.8.8.1.1.2.2.cmml">∑</mo><mrow id="A1.E32.m2.2.2.2.4" xref="A1.E32.m2.2.2.2.3.cmml"><mi id="A1.E32.m2.1.1.1.1" xref="A1.E32.m2.1.1.1.1.cmml">𝐲</mi><mo id="A1.E32.m2.2.2.2.4.1" xref="A1.E32.m2.2.2.2.3.cmml">,</mo><mi id="A1.E32.m2.2.2.2.2" xref="A1.E32.m2.2.2.2.2.cmml">𝐳</mi></mrow></munder></mstyle><mrow id="A1.E32.m2.8.8.1.1.1" xref="A1.E32.m2.8.8.1.1.1.cmml"><mrow id="A1.E32.m2.8.8.1.1.1.1.1" xref="A1.E32.m2.8.8.1.1.1.1.2.cmml"><mo id="A1.E32.m2.8.8.1.1.1.1.1.2" xref="A1.E32.m2.8.8.1.1.1.1.2.1.cmml">[</mo><mrow id="A1.E32.m2.8.8.1.1.1.1.1.1" xref="A1.E32.m2.8.8.1.1.1.1.1.1.cmml"><msub id="A1.E32.m2.8.8.1.1.1.1.1.1.2" xref="A1.E32.m2.8.8.1.1.1.1.1.1.2.cmml"><mi id="A1.E32.m2.8.8.1.1.1.1.1.1.2.2" xref="A1.E32.m2.8.8.1.1.1.1.1.1.2.2.cmml">𝔼</mi><mrow id="A1.E32.m2.8.8.1.1.1.1.1.1.2.3" xref="A1.E32.m2.8.8.1.1.1.1.1.1.2.3.cmml"><mi id="A1.E32.m2.8.8.1.1.1.1.1.1.2.3.2" xref="A1.E32.m2.8.8.1.1.1.1.1.1.2.3.2.cmml">𝐱</mi><mo id="A1.E32.m2.8.8.1.1.1.1.1.1.2.3.1" xref="A1.E32.m2.8.8.1.1.1.1.1.1.2.3.1.cmml">∼</mo><msub id="A1.E32.m2.8.8.1.1.1.1.1.1.2.3.3" xref="A1.E32.m2.8.8.1.1.1.1.1.1.2.3.3.cmml"><mi id="A1.E32.m2.8.8.1.1.1.1.1.1.2.3.3.2" xref="A1.E32.m2.8.8.1.1.1.1.1.1.2.3.3.2.cmml">q</mi><mi id="A1.E32.m2.8.8.1.1.1.1.1.1.2.3.3.3" xref="A1.E32.m2.8.8.1.1.1.1.1.1.2.3.3.3.cmml">f</mi></msub></mrow></msub><mo id="A1.E32.m2.8.8.1.1.1.1.1.1.1" xref="A1.E32.m2.8.8.1.1.1.1.1.1.1.cmml">⁢</mo><mstyle displaystyle="true" id="A1.E32.m2.5.5" xref="A1.E32.m2.5.5.cmml"><mfrac id="A1.E32.m2.5.5a" xref="A1.E32.m2.5.5.cmml"><mrow id="A1.E32.m2.3.3.1" xref="A1.E32.m2.3.3.1.cmml"><msup id="A1.E32.m2.3.3.1.3" xref="A1.E32.m2.3.3.1.3.cmml"><mi id="A1.E32.m2.3.3.1.3.2" xref="A1.E32.m2.3.3.1.3.2.cmml">δ</mi><mn id="A1.E32.m2.3.3.1.3.3" xref="A1.E32.m2.3.3.1.3.3.cmml">2</mn></msup><mo id="A1.E32.m2.3.3.1.2" lspace="0.167em" xref="A1.E32.m2.3.3.1.2.cmml">⁢</mo><mrow id="A1.E32.m2.3.3.1.4" xref="A1.E32.m2.3.3.1.4.cmml"><mi id="A1.E32.m2.3.3.1.4.1" xref="A1.E32.m2.3.3.1.4.1.cmml">log</mi><mo id="A1.E32.m2.3.3.1.4a" lspace="0.167em" xref="A1.E32.m2.3.3.1.4.cmml">⁡</mo><msub id="A1.E32.m2.3.3.1.4.2" xref="A1.E32.m2.3.3.1.4.2.cmml"><mi id="A1.E32.m2.3.3.1.4.2.2" xref="A1.E32.m2.3.3.1.4.2.2.cmml">q</mi><mi id="A1.E32.m2.3.3.1.4.2.3" xref="A1.E32.m2.3.3.1.4.2.3.cmml">f</mi></msub></mrow><mo id="A1.E32.m2.3.3.1.2a" xref="A1.E32.m2.3.3.1.2.cmml">⁢</mo><mrow id="A1.E32.m2.3.3.1.5.2" xref="A1.E32.m2.3.3.1.cmml"><mo id="A1.E32.m2.3.3.1.5.2.1" stretchy="false" xref="A1.E32.m2.3.3.1.cmml">(</mo><mi id="A1.E32.m2.3.3.1.1" xref="A1.E32.m2.3.3.1.1.cmml">𝐱</mi><mo id="A1.E32.m2.3.3.1.5.2.2" stretchy="false" xref="A1.E32.m2.3.3.1.cmml">)</mo></mrow></mrow><mrow id="A1.E32.m2.5.5.3" xref="A1.E32.m2.5.5.3.cmml"><mi id="A1.E32.m2.5.5.3.4" xref="A1.E32.m2.5.5.3.4.cmml">δ</mi><mo id="A1.E32.m2.5.5.3.3" xref="A1.E32.m2.5.5.3.3.cmml">⁢</mo><mi id="A1.E32.m2.5.5.3.5" xref="A1.E32.m2.5.5.3.5.cmml">f</mi><mo id="A1.E32.m2.5.5.3.3a" xref="A1.E32.m2.5.5.3.3.cmml">⁢</mo><mrow id="A1.E32.m2.5.5.3.6.2" xref="A1.E32.m2.5.5.3.cmml"><mo id="A1.E32.m2.5.5.3.6.2.1" stretchy="false" xref="A1.E32.m2.5.5.3.cmml">(</mo><mi id="A1.E32.m2.4.4.2.1" xref="A1.E32.m2.4.4.2.1.cmml">𝐲</mi><mo id="A1.E32.m2.5.5.3.6.2.2" stretchy="false" xref="A1.E32.m2.5.5.3.cmml">)</mo></mrow><mo id="A1.E32.m2.5.5.3.3b" xref="A1.E32.m2.5.5.3.3.cmml">⁢</mo><mi id="A1.E32.m2.5.5.3.7" xref="A1.E32.m2.5.5.3.7.cmml">δ</mi><mo id="A1.E32.m2.5.5.3.3c" xref="A1.E32.m2.5.5.3.3.cmml">⁢</mo><mi id="A1.E32.m2.5.5.3.8" xref="A1.E32.m2.5.5.3.8.cmml">f</mi><mo id="A1.E32.m2.5.5.3.3d" xref="A1.E32.m2.5.5.3.3.cmml">⁢</mo><mrow id="A1.E32.m2.5.5.3.9.2" xref="A1.E32.m2.5.5.3.cmml"><mo id="A1.E32.m2.5.5.3.9.2.1" stretchy="false" xref="A1.E32.m2.5.5.3.cmml">(</mo><mi id="A1.E32.m2.5.5.3.2" xref="A1.E32.m2.5.5.3.2.cmml">𝐳</mi><mo id="A1.E32.m2.5.5.3.9.2.2" stretchy="false" xref="A1.E32.m2.5.5.3.cmml">)</mo></mrow></mrow></mfrac></mstyle></mrow><mo id="A1.E32.m2.8.8.1.1.1.1.1.3" xref="A1.E32.m2.8.8.1.1.1.1.2.1.cmml">]</mo></mrow><mo id="A1.E32.m2.8.8.1.1.1.2" xref="A1.E32.m2.8.8.1.1.1.2.cmml">⁢</mo><mi id="A1.E32.m2.8.8.1.1.1.3" xref="A1.E32.m2.8.8.1.1.1.3.cmml">g</mi><mo id="A1.E32.m2.8.8.1.1.1.2a" xref="A1.E32.m2.8.8.1.1.1.2.cmml">⁢</mo><mrow id="A1.E32.m2.8.8.1.1.1.4.2" xref="A1.E32.m2.8.8.1.1.1.cmml"><mo id="A1.E32.m2.8.8.1.1.1.4.2.1" stretchy="false" xref="A1.E32.m2.8.8.1.1.1.cmml">(</mo><mi id="A1.E32.m2.6.6" xref="A1.E32.m2.6.6.cmml">𝐲</mi><mo id="A1.E32.m2.8.8.1.1.1.4.2.2" stretchy="false" xref="A1.E32.m2.8.8.1.1.1.cmml">)</mo></mrow><mo id="A1.E32.m2.8.8.1.1.1.2b" xref="A1.E32.m2.8.8.1.1.1.2.cmml">⁢</mo><mi id="A1.E32.m2.8.8.1.1.1.5" xref="A1.E32.m2.8.8.1.1.1.5.cmml">h</mi><mo id="A1.E32.m2.8.8.1.1.1.2c" xref="A1.E32.m2.8.8.1.1.1.2.cmml">⁢</mo><mrow id="A1.E32.m2.8.8.1.1.1.6.2" xref="A1.E32.m2.8.8.1.1.1.cmml"><mo id="A1.E32.m2.8.8.1.1.1.6.2.1" stretchy="false" xref="A1.E32.m2.8.8.1.1.1.cmml">(</mo><mi id="A1.E32.m2.7.7" xref="A1.E32.m2.7.7.cmml">𝐳</mi><mo id="A1.E32.m2.8.8.1.1.1.6.2.2" stretchy="false" xref="A1.E32.m2.8.8.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E32.m2.8b"><apply id="A1.E32.m2.8.8.cmml" xref="A1.E32.m2.8.8"><ci id="A1.E32.m2.8.8.2.cmml" xref="A1.E32.m2.8.8.2">≔</ci><csymbol cd="latexml" id="A1.E32.m2.8.8.3.cmml" xref="A1.E32.m2.8.8.3">absent</csymbol><apply id="A1.E32.m2.8.8.1.cmml" xref="A1.E32.m2.8.8.1"><minus id="A1.E32.m2.8.8.1.2.cmml" xref="A1.E32.m2.8.8.1"></minus><apply id="A1.E32.m2.8.8.1.1.cmml" xref="A1.E32.m2.8.8.1.1"><apply id="A1.E32.m2.8.8.1.1.2.cmml" xref="A1.E32.m2.8.8.1.1.2"><csymbol cd="ambiguous" id="A1.E32.m2.8.8.1.1.2.1.cmml" xref="A1.E32.m2.8.8.1.1.2">subscript</csymbol><sum id="A1.E32.m2.8.8.1.1.2.2.cmml" xref="A1.E32.m2.8.8.1.1.2.2"></sum><list id="A1.E32.m2.2.2.2.3.cmml" xref="A1.E32.m2.2.2.2.4"><ci id="A1.E32.m2.1.1.1.1.cmml" xref="A1.E32.m2.1.1.1.1">𝐲</ci><ci id="A1.E32.m2.2.2.2.2.cmml" xref="A1.E32.m2.2.2.2.2">𝐳</ci></list></apply><apply id="A1.E32.m2.8.8.1.1.1.cmml" xref="A1.E32.m2.8.8.1.1.1"><times id="A1.E32.m2.8.8.1.1.1.2.cmml" xref="A1.E32.m2.8.8.1.1.1.2"></times><apply id="A1.E32.m2.8.8.1.1.1.1.2.cmml" xref="A1.E32.m2.8.8.1.1.1.1.1"><csymbol cd="latexml" id="A1.E32.m2.8.8.1.1.1.1.2.1.cmml" xref="A1.E32.m2.8.8.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A1.E32.m2.8.8.1.1.1.1.1.1.cmml" xref="A1.E32.m2.8.8.1.1.1.1.1.1"><times id="A1.E32.m2.8.8.1.1.1.1.1.1.1.cmml" xref="A1.E32.m2.8.8.1.1.1.1.1.1.1"></times><apply id="A1.E32.m2.8.8.1.1.1.1.1.1.2.cmml" xref="A1.E32.m2.8.8.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E32.m2.8.8.1.1.1.1.1.1.2.1.cmml" xref="A1.E32.m2.8.8.1.1.1.1.1.1.2">subscript</csymbol><ci id="A1.E32.m2.8.8.1.1.1.1.1.1.2.2.cmml" xref="A1.E32.m2.8.8.1.1.1.1.1.1.2.2">𝔼</ci><apply id="A1.E32.m2.8.8.1.1.1.1.1.1.2.3.cmml" xref="A1.E32.m2.8.8.1.1.1.1.1.1.2.3"><csymbol cd="latexml" id="A1.E32.m2.8.8.1.1.1.1.1.1.2.3.1.cmml" xref="A1.E32.m2.8.8.1.1.1.1.1.1.2.3.1">similar-to</csymbol><ci id="A1.E32.m2.8.8.1.1.1.1.1.1.2.3.2.cmml" xref="A1.E32.m2.8.8.1.1.1.1.1.1.2.3.2">𝐱</ci><apply id="A1.E32.m2.8.8.1.1.1.1.1.1.2.3.3.cmml" xref="A1.E32.m2.8.8.1.1.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="A1.E32.m2.8.8.1.1.1.1.1.1.2.3.3.1.cmml" xref="A1.E32.m2.8.8.1.1.1.1.1.1.2.3.3">subscript</csymbol><ci id="A1.E32.m2.8.8.1.1.1.1.1.1.2.3.3.2.cmml" xref="A1.E32.m2.8.8.1.1.1.1.1.1.2.3.3.2">𝑞</ci><ci id="A1.E32.m2.8.8.1.1.1.1.1.1.2.3.3.3.cmml" xref="A1.E32.m2.8.8.1.1.1.1.1.1.2.3.3.3">𝑓</ci></apply></apply></apply><apply id="A1.E32.m2.5.5.cmml" xref="A1.E32.m2.5.5"><divide id="A1.E32.m2.5.5.4.cmml" xref="A1.E32.m2.5.5"></divide><apply id="A1.E32.m2.3.3.1.cmml" xref="A1.E32.m2.3.3.1"><times id="A1.E32.m2.3.3.1.2.cmml" xref="A1.E32.m2.3.3.1.2"></times><apply id="A1.E32.m2.3.3.1.3.cmml" xref="A1.E32.m2.3.3.1.3"><csymbol cd="ambiguous" id="A1.E32.m2.3.3.1.3.1.cmml" xref="A1.E32.m2.3.3.1.3">superscript</csymbol><ci id="A1.E32.m2.3.3.1.3.2.cmml" xref="A1.E32.m2.3.3.1.3.2">𝛿</ci><cn id="A1.E32.m2.3.3.1.3.3.cmml" type="integer" xref="A1.E32.m2.3.3.1.3.3">2</cn></apply><apply id="A1.E32.m2.3.3.1.4.cmml" xref="A1.E32.m2.3.3.1.4"><log id="A1.E32.m2.3.3.1.4.1.cmml" xref="A1.E32.m2.3.3.1.4.1"></log><apply id="A1.E32.m2.3.3.1.4.2.cmml" xref="A1.E32.m2.3.3.1.4.2"><csymbol cd="ambiguous" id="A1.E32.m2.3.3.1.4.2.1.cmml" xref="A1.E32.m2.3.3.1.4.2">subscript</csymbol><ci id="A1.E32.m2.3.3.1.4.2.2.cmml" xref="A1.E32.m2.3.3.1.4.2.2">𝑞</ci><ci id="A1.E32.m2.3.3.1.4.2.3.cmml" xref="A1.E32.m2.3.3.1.4.2.3">𝑓</ci></apply></apply><ci id="A1.E32.m2.3.3.1.1.cmml" xref="A1.E32.m2.3.3.1.1">𝐱</ci></apply><apply id="A1.E32.m2.5.5.3.cmml" xref="A1.E32.m2.5.5.3"><times id="A1.E32.m2.5.5.3.3.cmml" xref="A1.E32.m2.5.5.3.3"></times><ci id="A1.E32.m2.5.5.3.4.cmml" xref="A1.E32.m2.5.5.3.4">𝛿</ci><ci id="A1.E32.m2.5.5.3.5.cmml" xref="A1.E32.m2.5.5.3.5">𝑓</ci><ci id="A1.E32.m2.4.4.2.1.cmml" xref="A1.E32.m2.4.4.2.1">𝐲</ci><ci id="A1.E32.m2.5.5.3.7.cmml" xref="A1.E32.m2.5.5.3.7">𝛿</ci><ci id="A1.E32.m2.5.5.3.8.cmml" xref="A1.E32.m2.5.5.3.8">𝑓</ci><ci id="A1.E32.m2.5.5.3.2.cmml" xref="A1.E32.m2.5.5.3.2">𝐳</ci></apply></apply></apply></apply><ci id="A1.E32.m2.8.8.1.1.1.3.cmml" xref="A1.E32.m2.8.8.1.1.1.3">𝑔</ci><ci id="A1.E32.m2.6.6.cmml" xref="A1.E32.m2.6.6">𝐲</ci><ci id="A1.E32.m2.8.8.1.1.1.5.cmml" xref="A1.E32.m2.8.8.1.1.1.5">ℎ</ci><ci id="A1.E32.m2.7.7.cmml" xref="A1.E32.m2.7.7">𝐳</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E32.m2.8c">\displaystyle\coloneqq-\sum_{\mathbf{y},\mathbf{z}}\left[\mathbb{E}_{\mathbf{x%
}\sim q_{f}}\frac{\delta^{2}\log q_{f}(\mathbf{x})}{\delta f(\mathbf{y})\delta
f%
(\mathbf{z})}\right]g(\mathbf{y})h(\mathbf{z})</annotation><annotation encoding="application/x-llamapun" id="A1.E32.m2.8d">≔ - ∑ start_POSTSUBSCRIPT bold_y , bold_z end_POSTSUBSCRIPT [ blackboard_E start_POSTSUBSCRIPT bold_x ∼ italic_q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT end_POSTSUBSCRIPT divide start_ARG italic_δ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT roman_log italic_q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT ( bold_x ) end_ARG start_ARG italic_δ italic_f ( bold_y ) italic_δ italic_f ( bold_z ) end_ARG ] italic_g ( bold_y ) italic_h ( bold_z )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(32)</span></td>
</tr></tbody>
<tbody id="A1.E33"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sum_{\mathbf{y},\mathbf{z}}\frac{\delta^{2}\log Z[f]}{\delta f(%
\mathbf{y})\delta f(\mathbf{z})}g(\mathbf{y})h(\mathbf{z})" class="ltx_Math" display="inline" id="A1.E33.m1.7"><semantics id="A1.E33.m1.7a"><mrow id="A1.E33.m1.7.8" xref="A1.E33.m1.7.8.cmml"><mi id="A1.E33.m1.7.8.2" xref="A1.E33.m1.7.8.2.cmml"></mi><mo id="A1.E33.m1.7.8.1" xref="A1.E33.m1.7.8.1.cmml">=</mo><mrow id="A1.E33.m1.7.8.3" xref="A1.E33.m1.7.8.3.cmml"><mstyle displaystyle="true" id="A1.E33.m1.7.8.3.1" xref="A1.E33.m1.7.8.3.1.cmml"><munder id="A1.E33.m1.7.8.3.1a" xref="A1.E33.m1.7.8.3.1.cmml"><mo id="A1.E33.m1.7.8.3.1.2" movablelimits="false" xref="A1.E33.m1.7.8.3.1.2.cmml">∑</mo><mrow id="A1.E33.m1.2.2.2.4" xref="A1.E33.m1.2.2.2.3.cmml"><mi id="A1.E33.m1.1.1.1.1" xref="A1.E33.m1.1.1.1.1.cmml">𝐲</mi><mo id="A1.E33.m1.2.2.2.4.1" xref="A1.E33.m1.2.2.2.3.cmml">,</mo><mi id="A1.E33.m1.2.2.2.2" xref="A1.E33.m1.2.2.2.2.cmml">𝐳</mi></mrow></munder></mstyle><mrow id="A1.E33.m1.7.8.3.2" xref="A1.E33.m1.7.8.3.2.cmml"><mstyle displaystyle="true" id="A1.E33.m1.5.5" xref="A1.E33.m1.5.5.cmml"><mfrac id="A1.E33.m1.5.5a" xref="A1.E33.m1.5.5.cmml"><mrow id="A1.E33.m1.3.3.1" xref="A1.E33.m1.3.3.1.cmml"><msup id="A1.E33.m1.3.3.1.3" xref="A1.E33.m1.3.3.1.3.cmml"><mi id="A1.E33.m1.3.3.1.3.2" xref="A1.E33.m1.3.3.1.3.2.cmml">δ</mi><mn id="A1.E33.m1.3.3.1.3.3" xref="A1.E33.m1.3.3.1.3.3.cmml">2</mn></msup><mo id="A1.E33.m1.3.3.1.2" lspace="0.167em" xref="A1.E33.m1.3.3.1.2.cmml">⁢</mo><mrow id="A1.E33.m1.3.3.1.4" xref="A1.E33.m1.3.3.1.4.cmml"><mi id="A1.E33.m1.3.3.1.4.1" xref="A1.E33.m1.3.3.1.4.1.cmml">log</mi><mo id="A1.E33.m1.3.3.1.4a" lspace="0.167em" xref="A1.E33.m1.3.3.1.4.cmml">⁡</mo><mi id="A1.E33.m1.3.3.1.4.2" xref="A1.E33.m1.3.3.1.4.2.cmml">Z</mi></mrow><mo id="A1.E33.m1.3.3.1.2a" xref="A1.E33.m1.3.3.1.2.cmml">⁢</mo><mrow id="A1.E33.m1.3.3.1.5.2" xref="A1.E33.m1.3.3.1.5.1.cmml"><mo id="A1.E33.m1.3.3.1.5.2.1" stretchy="false" xref="A1.E33.m1.3.3.1.5.1.1.cmml">[</mo><mi id="A1.E33.m1.3.3.1.1" xref="A1.E33.m1.3.3.1.1.cmml">f</mi><mo id="A1.E33.m1.3.3.1.5.2.2" stretchy="false" xref="A1.E33.m1.3.3.1.5.1.1.cmml">]</mo></mrow></mrow><mrow id="A1.E33.m1.5.5.3" xref="A1.E33.m1.5.5.3.cmml"><mi id="A1.E33.m1.5.5.3.4" xref="A1.E33.m1.5.5.3.4.cmml">δ</mi><mo id="A1.E33.m1.5.5.3.3" xref="A1.E33.m1.5.5.3.3.cmml">⁢</mo><mi id="A1.E33.m1.5.5.3.5" xref="A1.E33.m1.5.5.3.5.cmml">f</mi><mo id="A1.E33.m1.5.5.3.3a" xref="A1.E33.m1.5.5.3.3.cmml">⁢</mo><mrow id="A1.E33.m1.5.5.3.6.2" xref="A1.E33.m1.5.5.3.cmml"><mo id="A1.E33.m1.5.5.3.6.2.1" stretchy="false" xref="A1.E33.m1.5.5.3.cmml">(</mo><mi id="A1.E33.m1.4.4.2.1" xref="A1.E33.m1.4.4.2.1.cmml">𝐲</mi><mo id="A1.E33.m1.5.5.3.6.2.2" stretchy="false" xref="A1.E33.m1.5.5.3.cmml">)</mo></mrow><mo id="A1.E33.m1.5.5.3.3b" xref="A1.E33.m1.5.5.3.3.cmml">⁢</mo><mi id="A1.E33.m1.5.5.3.7" xref="A1.E33.m1.5.5.3.7.cmml">δ</mi><mo id="A1.E33.m1.5.5.3.3c" xref="A1.E33.m1.5.5.3.3.cmml">⁢</mo><mi id="A1.E33.m1.5.5.3.8" xref="A1.E33.m1.5.5.3.8.cmml">f</mi><mo id="A1.E33.m1.5.5.3.3d" xref="A1.E33.m1.5.5.3.3.cmml">⁢</mo><mrow id="A1.E33.m1.5.5.3.9.2" xref="A1.E33.m1.5.5.3.cmml"><mo id="A1.E33.m1.5.5.3.9.2.1" stretchy="false" xref="A1.E33.m1.5.5.3.cmml">(</mo><mi id="A1.E33.m1.5.5.3.2" xref="A1.E33.m1.5.5.3.2.cmml">𝐳</mi><mo id="A1.E33.m1.5.5.3.9.2.2" stretchy="false" xref="A1.E33.m1.5.5.3.cmml">)</mo></mrow></mrow></mfrac></mstyle><mo id="A1.E33.m1.7.8.3.2.1" xref="A1.E33.m1.7.8.3.2.1.cmml">⁢</mo><mi id="A1.E33.m1.7.8.3.2.2" xref="A1.E33.m1.7.8.3.2.2.cmml">g</mi><mo id="A1.E33.m1.7.8.3.2.1a" xref="A1.E33.m1.7.8.3.2.1.cmml">⁢</mo><mrow id="A1.E33.m1.7.8.3.2.3.2" xref="A1.E33.m1.7.8.3.2.cmml"><mo id="A1.E33.m1.7.8.3.2.3.2.1" stretchy="false" xref="A1.E33.m1.7.8.3.2.cmml">(</mo><mi id="A1.E33.m1.6.6" xref="A1.E33.m1.6.6.cmml">𝐲</mi><mo id="A1.E33.m1.7.8.3.2.3.2.2" stretchy="false" xref="A1.E33.m1.7.8.3.2.cmml">)</mo></mrow><mo id="A1.E33.m1.7.8.3.2.1b" xref="A1.E33.m1.7.8.3.2.1.cmml">⁢</mo><mi id="A1.E33.m1.7.8.3.2.4" xref="A1.E33.m1.7.8.3.2.4.cmml">h</mi><mo id="A1.E33.m1.7.8.3.2.1c" xref="A1.E33.m1.7.8.3.2.1.cmml">⁢</mo><mrow id="A1.E33.m1.7.8.3.2.5.2" xref="A1.E33.m1.7.8.3.2.cmml"><mo id="A1.E33.m1.7.8.3.2.5.2.1" stretchy="false" xref="A1.E33.m1.7.8.3.2.cmml">(</mo><mi id="A1.E33.m1.7.7" xref="A1.E33.m1.7.7.cmml">𝐳</mi><mo id="A1.E33.m1.7.8.3.2.5.2.2" stretchy="false" xref="A1.E33.m1.7.8.3.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E33.m1.7b"><apply id="A1.E33.m1.7.8.cmml" xref="A1.E33.m1.7.8"><eq id="A1.E33.m1.7.8.1.cmml" xref="A1.E33.m1.7.8.1"></eq><csymbol cd="latexml" id="A1.E33.m1.7.8.2.cmml" xref="A1.E33.m1.7.8.2">absent</csymbol><apply id="A1.E33.m1.7.8.3.cmml" xref="A1.E33.m1.7.8.3"><apply id="A1.E33.m1.7.8.3.1.cmml" xref="A1.E33.m1.7.8.3.1"><csymbol cd="ambiguous" id="A1.E33.m1.7.8.3.1.1.cmml" xref="A1.E33.m1.7.8.3.1">subscript</csymbol><sum id="A1.E33.m1.7.8.3.1.2.cmml" xref="A1.E33.m1.7.8.3.1.2"></sum><list id="A1.E33.m1.2.2.2.3.cmml" xref="A1.E33.m1.2.2.2.4"><ci id="A1.E33.m1.1.1.1.1.cmml" xref="A1.E33.m1.1.1.1.1">𝐲</ci><ci id="A1.E33.m1.2.2.2.2.cmml" xref="A1.E33.m1.2.2.2.2">𝐳</ci></list></apply><apply id="A1.E33.m1.7.8.3.2.cmml" xref="A1.E33.m1.7.8.3.2"><times id="A1.E33.m1.7.8.3.2.1.cmml" xref="A1.E33.m1.7.8.3.2.1"></times><apply id="A1.E33.m1.5.5.cmml" xref="A1.E33.m1.5.5"><divide id="A1.E33.m1.5.5.4.cmml" xref="A1.E33.m1.5.5"></divide><apply id="A1.E33.m1.3.3.1.cmml" xref="A1.E33.m1.3.3.1"><times id="A1.E33.m1.3.3.1.2.cmml" xref="A1.E33.m1.3.3.1.2"></times><apply id="A1.E33.m1.3.3.1.3.cmml" xref="A1.E33.m1.3.3.1.3"><csymbol cd="ambiguous" id="A1.E33.m1.3.3.1.3.1.cmml" xref="A1.E33.m1.3.3.1.3">superscript</csymbol><ci id="A1.E33.m1.3.3.1.3.2.cmml" xref="A1.E33.m1.3.3.1.3.2">𝛿</ci><cn id="A1.E33.m1.3.3.1.3.3.cmml" type="integer" xref="A1.E33.m1.3.3.1.3.3">2</cn></apply><apply id="A1.E33.m1.3.3.1.4.cmml" xref="A1.E33.m1.3.3.1.4"><log id="A1.E33.m1.3.3.1.4.1.cmml" xref="A1.E33.m1.3.3.1.4.1"></log><ci id="A1.E33.m1.3.3.1.4.2.cmml" xref="A1.E33.m1.3.3.1.4.2">𝑍</ci></apply><apply id="A1.E33.m1.3.3.1.5.1.cmml" xref="A1.E33.m1.3.3.1.5.2"><csymbol cd="latexml" id="A1.E33.m1.3.3.1.5.1.1.cmml" xref="A1.E33.m1.3.3.1.5.2.1">delimited-[]</csymbol><ci id="A1.E33.m1.3.3.1.1.cmml" xref="A1.E33.m1.3.3.1.1">𝑓</ci></apply></apply><apply id="A1.E33.m1.5.5.3.cmml" xref="A1.E33.m1.5.5.3"><times id="A1.E33.m1.5.5.3.3.cmml" xref="A1.E33.m1.5.5.3.3"></times><ci id="A1.E33.m1.5.5.3.4.cmml" xref="A1.E33.m1.5.5.3.4">𝛿</ci><ci id="A1.E33.m1.5.5.3.5.cmml" xref="A1.E33.m1.5.5.3.5">𝑓</ci><ci id="A1.E33.m1.4.4.2.1.cmml" xref="A1.E33.m1.4.4.2.1">𝐲</ci><ci id="A1.E33.m1.5.5.3.7.cmml" xref="A1.E33.m1.5.5.3.7">𝛿</ci><ci id="A1.E33.m1.5.5.3.8.cmml" xref="A1.E33.m1.5.5.3.8">𝑓</ci><ci id="A1.E33.m1.5.5.3.2.cmml" xref="A1.E33.m1.5.5.3.2">𝐳</ci></apply></apply><ci id="A1.E33.m1.7.8.3.2.2.cmml" xref="A1.E33.m1.7.8.3.2.2">𝑔</ci><ci id="A1.E33.m1.6.6.cmml" xref="A1.E33.m1.6.6">𝐲</ci><ci id="A1.E33.m1.7.8.3.2.4.cmml" xref="A1.E33.m1.7.8.3.2.4">ℎ</ci><ci id="A1.E33.m1.7.7.cmml" xref="A1.E33.m1.7.7">𝐳</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E33.m1.7c">\displaystyle=\sum_{\mathbf{y},\mathbf{z}}\frac{\delta^{2}\log Z[f]}{\delta f(%
\mathbf{y})\delta f(\mathbf{z})}g(\mathbf{y})h(\mathbf{z})</annotation><annotation encoding="application/x-llamapun" id="A1.E33.m1.7d">= ∑ start_POSTSUBSCRIPT bold_y , bold_z end_POSTSUBSCRIPT divide start_ARG italic_δ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT roman_log italic_Z [ italic_f ] end_ARG start_ARG italic_δ italic_f ( bold_y ) italic_δ italic_f ( bold_z ) end_ARG italic_g ( bold_y ) italic_h ( bold_z )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(33)</span></td>
</tr></tbody>
<tbody id="A1.E34"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\delta^{2}\log Z[f;g,h]\,." class="ltx_Math" display="inline" id="A1.E34.m1.4"><semantics id="A1.E34.m1.4a"><mrow id="A1.E34.m1.4.4.1" xref="A1.E34.m1.4.4.1.1.cmml"><mrow id="A1.E34.m1.4.4.1.1" xref="A1.E34.m1.4.4.1.1.cmml"><mi id="A1.E34.m1.4.4.1.1.2" xref="A1.E34.m1.4.4.1.1.2.cmml"></mi><mo id="A1.E34.m1.4.4.1.1.1" xref="A1.E34.m1.4.4.1.1.1.cmml">=</mo><mrow id="A1.E34.m1.4.4.1.1.3" xref="A1.E34.m1.4.4.1.1.3.cmml"><msup id="A1.E34.m1.4.4.1.1.3.2" xref="A1.E34.m1.4.4.1.1.3.2.cmml"><mi id="A1.E34.m1.4.4.1.1.3.2.2" xref="A1.E34.m1.4.4.1.1.3.2.2.cmml">δ</mi><mn id="A1.E34.m1.4.4.1.1.3.2.3" xref="A1.E34.m1.4.4.1.1.3.2.3.cmml">2</mn></msup><mo id="A1.E34.m1.4.4.1.1.3.1" lspace="0.167em" xref="A1.E34.m1.4.4.1.1.3.1.cmml">⁢</mo><mrow id="A1.E34.m1.4.4.1.1.3.3" xref="A1.E34.m1.4.4.1.1.3.3.cmml"><mi id="A1.E34.m1.4.4.1.1.3.3.1" xref="A1.E34.m1.4.4.1.1.3.3.1.cmml">log</mi><mo id="A1.E34.m1.4.4.1.1.3.3a" lspace="0.167em" xref="A1.E34.m1.4.4.1.1.3.3.cmml">⁡</mo><mi id="A1.E34.m1.4.4.1.1.3.3.2" xref="A1.E34.m1.4.4.1.1.3.3.2.cmml">Z</mi></mrow><mo id="A1.E34.m1.4.4.1.1.3.1a" xref="A1.E34.m1.4.4.1.1.3.1.cmml">⁢</mo><mrow id="A1.E34.m1.4.4.1.1.3.4.2" xref="A1.E34.m1.4.4.1.1.3.4.1.cmml"><mo id="A1.E34.m1.4.4.1.1.3.4.2.1" stretchy="false" xref="A1.E34.m1.4.4.1.1.3.4.1.cmml">[</mo><mi id="A1.E34.m1.1.1" xref="A1.E34.m1.1.1.cmml">f</mi><mo id="A1.E34.m1.4.4.1.1.3.4.2.2" xref="A1.E34.m1.4.4.1.1.3.4.1.cmml">;</mo><mi id="A1.E34.m1.2.2" xref="A1.E34.m1.2.2.cmml">g</mi><mo id="A1.E34.m1.4.4.1.1.3.4.2.3" xref="A1.E34.m1.4.4.1.1.3.4.1.cmml">,</mo><mi id="A1.E34.m1.3.3" xref="A1.E34.m1.3.3.cmml">h</mi><mo id="A1.E34.m1.4.4.1.1.3.4.2.4" stretchy="false" xref="A1.E34.m1.4.4.1.1.3.4.1.cmml">]</mo></mrow></mrow></mrow><mo id="A1.E34.m1.4.4.1.2" lspace="0.170em" xref="A1.E34.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E34.m1.4b"><apply id="A1.E34.m1.4.4.1.1.cmml" xref="A1.E34.m1.4.4.1"><eq id="A1.E34.m1.4.4.1.1.1.cmml" xref="A1.E34.m1.4.4.1.1.1"></eq><csymbol cd="latexml" id="A1.E34.m1.4.4.1.1.2.cmml" xref="A1.E34.m1.4.4.1.1.2">absent</csymbol><apply id="A1.E34.m1.4.4.1.1.3.cmml" xref="A1.E34.m1.4.4.1.1.3"><times id="A1.E34.m1.4.4.1.1.3.1.cmml" xref="A1.E34.m1.4.4.1.1.3.1"></times><apply id="A1.E34.m1.4.4.1.1.3.2.cmml" xref="A1.E34.m1.4.4.1.1.3.2"><csymbol cd="ambiguous" id="A1.E34.m1.4.4.1.1.3.2.1.cmml" xref="A1.E34.m1.4.4.1.1.3.2">superscript</csymbol><ci id="A1.E34.m1.4.4.1.1.3.2.2.cmml" xref="A1.E34.m1.4.4.1.1.3.2.2">𝛿</ci><cn id="A1.E34.m1.4.4.1.1.3.2.3.cmml" type="integer" xref="A1.E34.m1.4.4.1.1.3.2.3">2</cn></apply><apply id="A1.E34.m1.4.4.1.1.3.3.cmml" xref="A1.E34.m1.4.4.1.1.3.3"><log id="A1.E34.m1.4.4.1.1.3.3.1.cmml" xref="A1.E34.m1.4.4.1.1.3.3.1"></log><ci id="A1.E34.m1.4.4.1.1.3.3.2.cmml" xref="A1.E34.m1.4.4.1.1.3.3.2">𝑍</ci></apply><list id="A1.E34.m1.4.4.1.1.3.4.1.cmml" xref="A1.E34.m1.4.4.1.1.3.4.2"><ci id="A1.E34.m1.1.1.cmml" xref="A1.E34.m1.1.1">𝑓</ci><ci id="A1.E34.m1.2.2.cmml" xref="A1.E34.m1.2.2">𝑔</ci><ci id="A1.E34.m1.3.3.cmml" xref="A1.E34.m1.3.3">ℎ</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E34.m1.4c">\displaystyle=\delta^{2}\log Z[f;g,h]\,.</annotation><annotation encoding="application/x-llamapun" id="A1.E34.m1.4d">= italic_δ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT roman_log italic_Z [ italic_f ; italic_g , italic_h ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(34)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A1.p7">
<p class="ltx_p" id="A1.p7.5">The only difference to the second-order variation of <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A1.E16" title="In Appendix A Theory ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">16</span></a> computed in equation <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A1.E22" title="In Appendix A Theory ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">22</span></a> would be that the expectation is taken under the model distribution, <math alttext="q_{f}" class="ltx_Math" display="inline" id="A1.p7.1.m1.1"><semantics id="A1.p7.1.m1.1a"><msub id="A1.p7.1.m1.1.1" xref="A1.p7.1.m1.1.1.cmml"><mi id="A1.p7.1.m1.1.1.2" xref="A1.p7.1.m1.1.1.2.cmml">q</mi><mi id="A1.p7.1.m1.1.1.3" xref="A1.p7.1.m1.1.1.3.cmml">f</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p7.1.m1.1b"><apply id="A1.p7.1.m1.1.1.cmml" xref="A1.p7.1.m1.1.1"><csymbol cd="ambiguous" id="A1.p7.1.m1.1.1.1.cmml" xref="A1.p7.1.m1.1.1">subscript</csymbol><ci id="A1.p7.1.m1.1.1.2.cmml" xref="A1.p7.1.m1.1.1.2">𝑞</ci><ci id="A1.p7.1.m1.1.1.3.cmml" xref="A1.p7.1.m1.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p7.1.m1.1c">q_{f}</annotation><annotation encoding="application/x-llamapun" id="A1.p7.1.m1.1d">italic_q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT</annotation></semantics></math>, instead of the data distribution <math alttext="p" class="ltx_Math" display="inline" id="A1.p7.2.m2.1"><semantics id="A1.p7.2.m2.1a"><mi id="A1.p7.2.m2.1.1" xref="A1.p7.2.m2.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="A1.p7.2.m2.1b"><ci id="A1.p7.2.m2.1.1.cmml" xref="A1.p7.2.m2.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p7.2.m2.1c">p</annotation><annotation encoding="application/x-llamapun" id="A1.p7.2.m2.1d">italic_p</annotation></semantics></math>.
However, because the only term in <math alttext="\log q_{f}(\mathbf{x})" class="ltx_Math" display="inline" id="A1.p7.3.m3.1"><semantics id="A1.p7.3.m3.1a"><mrow id="A1.p7.3.m3.1.2" xref="A1.p7.3.m3.1.2.cmml"><mrow id="A1.p7.3.m3.1.2.2" xref="A1.p7.3.m3.1.2.2.cmml"><mi id="A1.p7.3.m3.1.2.2.1" xref="A1.p7.3.m3.1.2.2.1.cmml">log</mi><mo id="A1.p7.3.m3.1.2.2a" lspace="0.167em" xref="A1.p7.3.m3.1.2.2.cmml">⁡</mo><msub id="A1.p7.3.m3.1.2.2.2" xref="A1.p7.3.m3.1.2.2.2.cmml"><mi id="A1.p7.3.m3.1.2.2.2.2" xref="A1.p7.3.m3.1.2.2.2.2.cmml">q</mi><mi id="A1.p7.3.m3.1.2.2.2.3" xref="A1.p7.3.m3.1.2.2.2.3.cmml">f</mi></msub></mrow><mo id="A1.p7.3.m3.1.2.1" xref="A1.p7.3.m3.1.2.1.cmml">⁢</mo><mrow id="A1.p7.3.m3.1.2.3.2" xref="A1.p7.3.m3.1.2.cmml"><mo id="A1.p7.3.m3.1.2.3.2.1" stretchy="false" xref="A1.p7.3.m3.1.2.cmml">(</mo><mi id="A1.p7.3.m3.1.1" xref="A1.p7.3.m3.1.1.cmml">𝐱</mi><mo id="A1.p7.3.m3.1.2.3.2.2" stretchy="false" xref="A1.p7.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.p7.3.m3.1b"><apply id="A1.p7.3.m3.1.2.cmml" xref="A1.p7.3.m3.1.2"><times id="A1.p7.3.m3.1.2.1.cmml" xref="A1.p7.3.m3.1.2.1"></times><apply id="A1.p7.3.m3.1.2.2.cmml" xref="A1.p7.3.m3.1.2.2"><log id="A1.p7.3.m3.1.2.2.1.cmml" xref="A1.p7.3.m3.1.2.2.1"></log><apply id="A1.p7.3.m3.1.2.2.2.cmml" xref="A1.p7.3.m3.1.2.2.2"><csymbol cd="ambiguous" id="A1.p7.3.m3.1.2.2.2.1.cmml" xref="A1.p7.3.m3.1.2.2.2">subscript</csymbol><ci id="A1.p7.3.m3.1.2.2.2.2.cmml" xref="A1.p7.3.m3.1.2.2.2.2">𝑞</ci><ci id="A1.p7.3.m3.1.2.2.2.3.cmml" xref="A1.p7.3.m3.1.2.2.2.3">𝑓</ci></apply></apply><ci id="A1.p7.3.m3.1.1.cmml" xref="A1.p7.3.m3.1.1">𝐱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p7.3.m3.1c">\log q_{f}(\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="A1.p7.3.m3.1d">roman_log italic_q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT ( bold_x )</annotation></semantics></math> that is non-linear in <math alttext="f" class="ltx_Math" display="inline" id="A1.p7.4.m4.1"><semantics id="A1.p7.4.m4.1a"><mi id="A1.p7.4.m4.1.1" xref="A1.p7.4.m4.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="A1.p7.4.m4.1b"><ci id="A1.p7.4.m4.1.1.cmml" xref="A1.p7.4.m4.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p7.4.m4.1c">f</annotation><annotation encoding="application/x-llamapun" id="A1.p7.4.m4.1d">italic_f</annotation></semantics></math> is the log-partition functional, which is not a function of <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="A1.p7.5.m5.1"><semantics id="A1.p7.5.m5.1a"><mi id="A1.p7.5.m5.1.1" xref="A1.p7.5.m5.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="A1.p7.5.m5.1b"><ci id="A1.p7.5.m5.1.1.cmml" xref="A1.p7.5.m5.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p7.5.m5.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="A1.p7.5.m5.1d">bold_x</annotation></semantics></math>,
this expectation plays no role in the computation and we get the result that
the Fisher Information is the same as the negative Hessian of the log-likelihood for these models.</p>
</div>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Application to Piecewise Constant Functions</h3>
<div class="ltx_para ltx_noindent" id="A1.SS1.p1">
<p class="ltx_p" id="A1.SS1.p1.6">Considering a weak learner such as</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E35">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\delta f(\mathbf{x})=\sum_{j=1}^{J}w_{j}\mathbf{1}_{X_{j}}(\mathbf{x})\,," class="ltx_Math" display="block" id="A1.E35.m1.3"><semantics id="A1.E35.m1.3a"><mrow id="A1.E35.m1.3.3.1" xref="A1.E35.m1.3.3.1.1.cmml"><mrow id="A1.E35.m1.3.3.1.1" xref="A1.E35.m1.3.3.1.1.cmml"><mrow id="A1.E35.m1.3.3.1.1.2" xref="A1.E35.m1.3.3.1.1.2.cmml"><mi id="A1.E35.m1.3.3.1.1.2.2" xref="A1.E35.m1.3.3.1.1.2.2.cmml">δ</mi><mo id="A1.E35.m1.3.3.1.1.2.1" xref="A1.E35.m1.3.3.1.1.2.1.cmml">⁢</mo><mi id="A1.E35.m1.3.3.1.1.2.3" xref="A1.E35.m1.3.3.1.1.2.3.cmml">f</mi><mo id="A1.E35.m1.3.3.1.1.2.1a" xref="A1.E35.m1.3.3.1.1.2.1.cmml">⁢</mo><mrow id="A1.E35.m1.3.3.1.1.2.4.2" xref="A1.E35.m1.3.3.1.1.2.cmml"><mo id="A1.E35.m1.3.3.1.1.2.4.2.1" stretchy="false" xref="A1.E35.m1.3.3.1.1.2.cmml">(</mo><mi id="A1.E35.m1.1.1" xref="A1.E35.m1.1.1.cmml">𝐱</mi><mo id="A1.E35.m1.3.3.1.1.2.4.2.2" stretchy="false" xref="A1.E35.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.E35.m1.3.3.1.1.1" rspace="0.111em" xref="A1.E35.m1.3.3.1.1.1.cmml">=</mo><mrow id="A1.E35.m1.3.3.1.1.3" xref="A1.E35.m1.3.3.1.1.3.cmml"><munderover id="A1.E35.m1.3.3.1.1.3.1" xref="A1.E35.m1.3.3.1.1.3.1.cmml"><mo id="A1.E35.m1.3.3.1.1.3.1.2.2" movablelimits="false" xref="A1.E35.m1.3.3.1.1.3.1.2.2.cmml">∑</mo><mrow id="A1.E35.m1.3.3.1.1.3.1.2.3" xref="A1.E35.m1.3.3.1.1.3.1.2.3.cmml"><mi id="A1.E35.m1.3.3.1.1.3.1.2.3.2" xref="A1.E35.m1.3.3.1.1.3.1.2.3.2.cmml">j</mi><mo id="A1.E35.m1.3.3.1.1.3.1.2.3.1" xref="A1.E35.m1.3.3.1.1.3.1.2.3.1.cmml">=</mo><mn id="A1.E35.m1.3.3.1.1.3.1.2.3.3" xref="A1.E35.m1.3.3.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="A1.E35.m1.3.3.1.1.3.1.3" xref="A1.E35.m1.3.3.1.1.3.1.3.cmml">J</mi></munderover><mrow id="A1.E35.m1.3.3.1.1.3.2" xref="A1.E35.m1.3.3.1.1.3.2.cmml"><msub id="A1.E35.m1.3.3.1.1.3.2.2" xref="A1.E35.m1.3.3.1.1.3.2.2.cmml"><mi id="A1.E35.m1.3.3.1.1.3.2.2.2" xref="A1.E35.m1.3.3.1.1.3.2.2.2.cmml">w</mi><mi id="A1.E35.m1.3.3.1.1.3.2.2.3" xref="A1.E35.m1.3.3.1.1.3.2.2.3.cmml">j</mi></msub><mo id="A1.E35.m1.3.3.1.1.3.2.1" xref="A1.E35.m1.3.3.1.1.3.2.1.cmml">⁢</mo><msub id="A1.E35.m1.3.3.1.1.3.2.3" xref="A1.E35.m1.3.3.1.1.3.2.3.cmml"><mn id="A1.E35.m1.3.3.1.1.3.2.3.2" xref="A1.E35.m1.3.3.1.1.3.2.3.2.cmml">𝟏</mn><msub id="A1.E35.m1.3.3.1.1.3.2.3.3" xref="A1.E35.m1.3.3.1.1.3.2.3.3.cmml"><mi id="A1.E35.m1.3.3.1.1.3.2.3.3.2" xref="A1.E35.m1.3.3.1.1.3.2.3.3.2.cmml">X</mi><mi id="A1.E35.m1.3.3.1.1.3.2.3.3.3" xref="A1.E35.m1.3.3.1.1.3.2.3.3.3.cmml">j</mi></msub></msub><mo id="A1.E35.m1.3.3.1.1.3.2.1a" xref="A1.E35.m1.3.3.1.1.3.2.1.cmml">⁢</mo><mrow id="A1.E35.m1.3.3.1.1.3.2.4.2" xref="A1.E35.m1.3.3.1.1.3.2.cmml"><mo id="A1.E35.m1.3.3.1.1.3.2.4.2.1" stretchy="false" xref="A1.E35.m1.3.3.1.1.3.2.cmml">(</mo><mi id="A1.E35.m1.2.2" xref="A1.E35.m1.2.2.cmml">𝐱</mi><mo id="A1.E35.m1.3.3.1.1.3.2.4.2.2" rspace="0.170em" stretchy="false" xref="A1.E35.m1.3.3.1.1.3.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A1.E35.m1.3.3.1.2" xref="A1.E35.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E35.m1.3b"><apply id="A1.E35.m1.3.3.1.1.cmml" xref="A1.E35.m1.3.3.1"><eq id="A1.E35.m1.3.3.1.1.1.cmml" xref="A1.E35.m1.3.3.1.1.1"></eq><apply id="A1.E35.m1.3.3.1.1.2.cmml" xref="A1.E35.m1.3.3.1.1.2"><times id="A1.E35.m1.3.3.1.1.2.1.cmml" xref="A1.E35.m1.3.3.1.1.2.1"></times><ci id="A1.E35.m1.3.3.1.1.2.2.cmml" xref="A1.E35.m1.3.3.1.1.2.2">𝛿</ci><ci id="A1.E35.m1.3.3.1.1.2.3.cmml" xref="A1.E35.m1.3.3.1.1.2.3">𝑓</ci><ci id="A1.E35.m1.1.1.cmml" xref="A1.E35.m1.1.1">𝐱</ci></apply><apply id="A1.E35.m1.3.3.1.1.3.cmml" xref="A1.E35.m1.3.3.1.1.3"><apply id="A1.E35.m1.3.3.1.1.3.1.cmml" xref="A1.E35.m1.3.3.1.1.3.1"><csymbol cd="ambiguous" id="A1.E35.m1.3.3.1.1.3.1.1.cmml" xref="A1.E35.m1.3.3.1.1.3.1">superscript</csymbol><apply id="A1.E35.m1.3.3.1.1.3.1.2.cmml" xref="A1.E35.m1.3.3.1.1.3.1"><csymbol cd="ambiguous" id="A1.E35.m1.3.3.1.1.3.1.2.1.cmml" xref="A1.E35.m1.3.3.1.1.3.1">subscript</csymbol><sum id="A1.E35.m1.3.3.1.1.3.1.2.2.cmml" xref="A1.E35.m1.3.3.1.1.3.1.2.2"></sum><apply id="A1.E35.m1.3.3.1.1.3.1.2.3.cmml" xref="A1.E35.m1.3.3.1.1.3.1.2.3"><eq id="A1.E35.m1.3.3.1.1.3.1.2.3.1.cmml" xref="A1.E35.m1.3.3.1.1.3.1.2.3.1"></eq><ci id="A1.E35.m1.3.3.1.1.3.1.2.3.2.cmml" xref="A1.E35.m1.3.3.1.1.3.1.2.3.2">𝑗</ci><cn id="A1.E35.m1.3.3.1.1.3.1.2.3.3.cmml" type="integer" xref="A1.E35.m1.3.3.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="A1.E35.m1.3.3.1.1.3.1.3.cmml" xref="A1.E35.m1.3.3.1.1.3.1.3">𝐽</ci></apply><apply id="A1.E35.m1.3.3.1.1.3.2.cmml" xref="A1.E35.m1.3.3.1.1.3.2"><times id="A1.E35.m1.3.3.1.1.3.2.1.cmml" xref="A1.E35.m1.3.3.1.1.3.2.1"></times><apply id="A1.E35.m1.3.3.1.1.3.2.2.cmml" xref="A1.E35.m1.3.3.1.1.3.2.2"><csymbol cd="ambiguous" id="A1.E35.m1.3.3.1.1.3.2.2.1.cmml" xref="A1.E35.m1.3.3.1.1.3.2.2">subscript</csymbol><ci id="A1.E35.m1.3.3.1.1.3.2.2.2.cmml" xref="A1.E35.m1.3.3.1.1.3.2.2.2">𝑤</ci><ci id="A1.E35.m1.3.3.1.1.3.2.2.3.cmml" xref="A1.E35.m1.3.3.1.1.3.2.2.3">𝑗</ci></apply><apply id="A1.E35.m1.3.3.1.1.3.2.3.cmml" xref="A1.E35.m1.3.3.1.1.3.2.3"><csymbol cd="ambiguous" id="A1.E35.m1.3.3.1.1.3.2.3.1.cmml" xref="A1.E35.m1.3.3.1.1.3.2.3">subscript</csymbol><cn id="A1.E35.m1.3.3.1.1.3.2.3.2.cmml" type="integer" xref="A1.E35.m1.3.3.1.1.3.2.3.2">1</cn><apply id="A1.E35.m1.3.3.1.1.3.2.3.3.cmml" xref="A1.E35.m1.3.3.1.1.3.2.3.3"><csymbol cd="ambiguous" id="A1.E35.m1.3.3.1.1.3.2.3.3.1.cmml" xref="A1.E35.m1.3.3.1.1.3.2.3.3">subscript</csymbol><ci id="A1.E35.m1.3.3.1.1.3.2.3.3.2.cmml" xref="A1.E35.m1.3.3.1.1.3.2.3.3.2">𝑋</ci><ci id="A1.E35.m1.3.3.1.1.3.2.3.3.3.cmml" xref="A1.E35.m1.3.3.1.1.3.2.3.3.3">𝑗</ci></apply></apply><ci id="A1.E35.m1.2.2.cmml" xref="A1.E35.m1.2.2">𝐱</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E35.m1.3c">\delta f(\mathbf{x})=\sum_{j=1}^{J}w_{j}\mathbf{1}_{X_{j}}(\mathbf{x})\,,</annotation><annotation encoding="application/x-llamapun" id="A1.E35.m1.3d">italic_δ italic_f ( bold_x ) = ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_J end_POSTSUPERSCRIPT italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT bold_1 start_POSTSUBSCRIPT italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_x ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(35)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS1.p1.2">where the subsets <math alttext="X_{j}" class="ltx_Math" display="inline" id="A1.SS1.p1.1.m1.1"><semantics id="A1.SS1.p1.1.m1.1a"><msub id="A1.SS1.p1.1.m1.1.1" xref="A1.SS1.p1.1.m1.1.1.cmml"><mi id="A1.SS1.p1.1.m1.1.1.2" xref="A1.SS1.p1.1.m1.1.1.2.cmml">X</mi><mi id="A1.SS1.p1.1.m1.1.1.3" xref="A1.SS1.p1.1.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.1.m1.1b"><apply id="A1.SS1.p1.1.m1.1.1.cmml" xref="A1.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.1.m1.1.1.1.cmml" xref="A1.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="A1.SS1.p1.1.m1.1.1.2.cmml" xref="A1.SS1.p1.1.m1.1.1.2">𝑋</ci><ci id="A1.SS1.p1.1.m1.1.1.3.cmml" xref="A1.SS1.p1.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.1.m1.1c">X_{j}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.1.m1.1d">italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> are disjoint and cover the entire input space, <math alttext="\mathcal{X}" class="ltx_Math" display="inline" id="A1.SS1.p1.2.m2.1"><semantics id="A1.SS1.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="A1.SS1.p1.2.m2.1.1" xref="A1.SS1.p1.2.m2.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.2.m2.1b"><ci id="A1.SS1.p1.2.m2.1.1.cmml" xref="A1.SS1.p1.2.m2.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.2.m2.1c">\mathcal{X}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.2.m2.1d">caligraphic_X</annotation></semantics></math>,
we have that</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A5.EGx6">
<tbody id="A1.E36"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbb{E}_{\mathbf{x}\sim q}\delta f(\mathbf{x})" class="ltx_Math" display="inline" id="A1.E36.m1.1"><semantics id="A1.E36.m1.1a"><mrow id="A1.E36.m1.1.2" xref="A1.E36.m1.1.2.cmml"><msub id="A1.E36.m1.1.2.2" xref="A1.E36.m1.1.2.2.cmml"><mi id="A1.E36.m1.1.2.2.2" xref="A1.E36.m1.1.2.2.2.cmml">𝔼</mi><mrow id="A1.E36.m1.1.2.2.3" xref="A1.E36.m1.1.2.2.3.cmml"><mi id="A1.E36.m1.1.2.2.3.2" xref="A1.E36.m1.1.2.2.3.2.cmml">𝐱</mi><mo id="A1.E36.m1.1.2.2.3.1" xref="A1.E36.m1.1.2.2.3.1.cmml">∼</mo><mi id="A1.E36.m1.1.2.2.3.3" xref="A1.E36.m1.1.2.2.3.3.cmml">q</mi></mrow></msub><mo id="A1.E36.m1.1.2.1" xref="A1.E36.m1.1.2.1.cmml">⁢</mo><mi id="A1.E36.m1.1.2.3" xref="A1.E36.m1.1.2.3.cmml">δ</mi><mo id="A1.E36.m1.1.2.1a" xref="A1.E36.m1.1.2.1.cmml">⁢</mo><mi id="A1.E36.m1.1.2.4" xref="A1.E36.m1.1.2.4.cmml">f</mi><mo id="A1.E36.m1.1.2.1b" xref="A1.E36.m1.1.2.1.cmml">⁢</mo><mrow id="A1.E36.m1.1.2.5.2" xref="A1.E36.m1.1.2.cmml"><mo id="A1.E36.m1.1.2.5.2.1" stretchy="false" xref="A1.E36.m1.1.2.cmml">(</mo><mi id="A1.E36.m1.1.1" xref="A1.E36.m1.1.1.cmml">𝐱</mi><mo id="A1.E36.m1.1.2.5.2.2" stretchy="false" xref="A1.E36.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E36.m1.1b"><apply id="A1.E36.m1.1.2.cmml" xref="A1.E36.m1.1.2"><times id="A1.E36.m1.1.2.1.cmml" xref="A1.E36.m1.1.2.1"></times><apply id="A1.E36.m1.1.2.2.cmml" xref="A1.E36.m1.1.2.2"><csymbol cd="ambiguous" id="A1.E36.m1.1.2.2.1.cmml" xref="A1.E36.m1.1.2.2">subscript</csymbol><ci id="A1.E36.m1.1.2.2.2.cmml" xref="A1.E36.m1.1.2.2.2">𝔼</ci><apply id="A1.E36.m1.1.2.2.3.cmml" xref="A1.E36.m1.1.2.2.3"><csymbol cd="latexml" id="A1.E36.m1.1.2.2.3.1.cmml" xref="A1.E36.m1.1.2.2.3.1">similar-to</csymbol><ci id="A1.E36.m1.1.2.2.3.2.cmml" xref="A1.E36.m1.1.2.2.3.2">𝐱</ci><ci id="A1.E36.m1.1.2.2.3.3.cmml" xref="A1.E36.m1.1.2.2.3.3">𝑞</ci></apply></apply><ci id="A1.E36.m1.1.2.3.cmml" xref="A1.E36.m1.1.2.3">𝛿</ci><ci id="A1.E36.m1.1.2.4.cmml" xref="A1.E36.m1.1.2.4">𝑓</ci><ci id="A1.E36.m1.1.1.cmml" xref="A1.E36.m1.1.1">𝐱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E36.m1.1c">\displaystyle\mathbb{E}_{\mathbf{x}\sim q}\delta f(\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="A1.E36.m1.1d">blackboard_E start_POSTSUBSCRIPT bold_x ∼ italic_q end_POSTSUBSCRIPT italic_δ italic_f ( bold_x )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sum_{\mathbf{x}\in\mathcal{X}}q(\mathbf{x})\sum_{j=1}^{J}w_{j}%
\mathbf{1}_{X_{j}}(\mathbf{x})" class="ltx_Math" display="inline" id="A1.E36.m2.2"><semantics id="A1.E36.m2.2a"><mrow id="A1.E36.m2.2.3" xref="A1.E36.m2.2.3.cmml"><mi id="A1.E36.m2.2.3.2" xref="A1.E36.m2.2.3.2.cmml"></mi><mo id="A1.E36.m2.2.3.1" xref="A1.E36.m2.2.3.1.cmml">=</mo><mrow id="A1.E36.m2.2.3.3" xref="A1.E36.m2.2.3.3.cmml"><mstyle displaystyle="true" id="A1.E36.m2.2.3.3.1" xref="A1.E36.m2.2.3.3.1.cmml"><munder id="A1.E36.m2.2.3.3.1a" xref="A1.E36.m2.2.3.3.1.cmml"><mo id="A1.E36.m2.2.3.3.1.2" movablelimits="false" xref="A1.E36.m2.2.3.3.1.2.cmml">∑</mo><mrow id="A1.E36.m2.2.3.3.1.3" xref="A1.E36.m2.2.3.3.1.3.cmml"><mi id="A1.E36.m2.2.3.3.1.3.2" xref="A1.E36.m2.2.3.3.1.3.2.cmml">𝐱</mi><mo id="A1.E36.m2.2.3.3.1.3.1" xref="A1.E36.m2.2.3.3.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="A1.E36.m2.2.3.3.1.3.3" xref="A1.E36.m2.2.3.3.1.3.3.cmml">𝒳</mi></mrow></munder></mstyle><mrow id="A1.E36.m2.2.3.3.2" xref="A1.E36.m2.2.3.3.2.cmml"><mi id="A1.E36.m2.2.3.3.2.2" xref="A1.E36.m2.2.3.3.2.2.cmml">q</mi><mo id="A1.E36.m2.2.3.3.2.1" xref="A1.E36.m2.2.3.3.2.1.cmml">⁢</mo><mrow id="A1.E36.m2.2.3.3.2.3.2" xref="A1.E36.m2.2.3.3.2.cmml"><mo id="A1.E36.m2.2.3.3.2.3.2.1" stretchy="false" xref="A1.E36.m2.2.3.3.2.cmml">(</mo><mi id="A1.E36.m2.1.1" xref="A1.E36.m2.1.1.cmml">𝐱</mi><mo id="A1.E36.m2.2.3.3.2.3.2.2" stretchy="false" xref="A1.E36.m2.2.3.3.2.cmml">)</mo></mrow><mo id="A1.E36.m2.2.3.3.2.1a" xref="A1.E36.m2.2.3.3.2.1.cmml">⁢</mo><mrow id="A1.E36.m2.2.3.3.2.4" xref="A1.E36.m2.2.3.3.2.4.cmml"><mstyle displaystyle="true" id="A1.E36.m2.2.3.3.2.4.1" xref="A1.E36.m2.2.3.3.2.4.1.cmml"><munderover id="A1.E36.m2.2.3.3.2.4.1a" xref="A1.E36.m2.2.3.3.2.4.1.cmml"><mo id="A1.E36.m2.2.3.3.2.4.1.2.2" movablelimits="false" xref="A1.E36.m2.2.3.3.2.4.1.2.2.cmml">∑</mo><mrow id="A1.E36.m2.2.3.3.2.4.1.2.3" xref="A1.E36.m2.2.3.3.2.4.1.2.3.cmml"><mi id="A1.E36.m2.2.3.3.2.4.1.2.3.2" xref="A1.E36.m2.2.3.3.2.4.1.2.3.2.cmml">j</mi><mo id="A1.E36.m2.2.3.3.2.4.1.2.3.1" xref="A1.E36.m2.2.3.3.2.4.1.2.3.1.cmml">=</mo><mn id="A1.E36.m2.2.3.3.2.4.1.2.3.3" xref="A1.E36.m2.2.3.3.2.4.1.2.3.3.cmml">1</mn></mrow><mi id="A1.E36.m2.2.3.3.2.4.1.3" xref="A1.E36.m2.2.3.3.2.4.1.3.cmml">J</mi></munderover></mstyle><mrow id="A1.E36.m2.2.3.3.2.4.2" xref="A1.E36.m2.2.3.3.2.4.2.cmml"><msub id="A1.E36.m2.2.3.3.2.4.2.2" xref="A1.E36.m2.2.3.3.2.4.2.2.cmml"><mi id="A1.E36.m2.2.3.3.2.4.2.2.2" xref="A1.E36.m2.2.3.3.2.4.2.2.2.cmml">w</mi><mi id="A1.E36.m2.2.3.3.2.4.2.2.3" xref="A1.E36.m2.2.3.3.2.4.2.2.3.cmml">j</mi></msub><mo id="A1.E36.m2.2.3.3.2.4.2.1" xref="A1.E36.m2.2.3.3.2.4.2.1.cmml">⁢</mo><msub id="A1.E36.m2.2.3.3.2.4.2.3" xref="A1.E36.m2.2.3.3.2.4.2.3.cmml"><mn id="A1.E36.m2.2.3.3.2.4.2.3.2" xref="A1.E36.m2.2.3.3.2.4.2.3.2.cmml">𝟏</mn><msub id="A1.E36.m2.2.3.3.2.4.2.3.3" xref="A1.E36.m2.2.3.3.2.4.2.3.3.cmml"><mi id="A1.E36.m2.2.3.3.2.4.2.3.3.2" xref="A1.E36.m2.2.3.3.2.4.2.3.3.2.cmml">X</mi><mi id="A1.E36.m2.2.3.3.2.4.2.3.3.3" xref="A1.E36.m2.2.3.3.2.4.2.3.3.3.cmml">j</mi></msub></msub><mo id="A1.E36.m2.2.3.3.2.4.2.1a" xref="A1.E36.m2.2.3.3.2.4.2.1.cmml">⁢</mo><mrow id="A1.E36.m2.2.3.3.2.4.2.4.2" xref="A1.E36.m2.2.3.3.2.4.2.cmml"><mo id="A1.E36.m2.2.3.3.2.4.2.4.2.1" stretchy="false" xref="A1.E36.m2.2.3.3.2.4.2.cmml">(</mo><mi id="A1.E36.m2.2.2" xref="A1.E36.m2.2.2.cmml">𝐱</mi><mo id="A1.E36.m2.2.3.3.2.4.2.4.2.2" stretchy="false" xref="A1.E36.m2.2.3.3.2.4.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E36.m2.2b"><apply id="A1.E36.m2.2.3.cmml" xref="A1.E36.m2.2.3"><eq id="A1.E36.m2.2.3.1.cmml" xref="A1.E36.m2.2.3.1"></eq><csymbol cd="latexml" id="A1.E36.m2.2.3.2.cmml" xref="A1.E36.m2.2.3.2">absent</csymbol><apply id="A1.E36.m2.2.3.3.cmml" xref="A1.E36.m2.2.3.3"><apply id="A1.E36.m2.2.3.3.1.cmml" xref="A1.E36.m2.2.3.3.1"><csymbol cd="ambiguous" id="A1.E36.m2.2.3.3.1.1.cmml" xref="A1.E36.m2.2.3.3.1">subscript</csymbol><sum id="A1.E36.m2.2.3.3.1.2.cmml" xref="A1.E36.m2.2.3.3.1.2"></sum><apply id="A1.E36.m2.2.3.3.1.3.cmml" xref="A1.E36.m2.2.3.3.1.3"><in id="A1.E36.m2.2.3.3.1.3.1.cmml" xref="A1.E36.m2.2.3.3.1.3.1"></in><ci id="A1.E36.m2.2.3.3.1.3.2.cmml" xref="A1.E36.m2.2.3.3.1.3.2">𝐱</ci><ci id="A1.E36.m2.2.3.3.1.3.3.cmml" xref="A1.E36.m2.2.3.3.1.3.3">𝒳</ci></apply></apply><apply id="A1.E36.m2.2.3.3.2.cmml" xref="A1.E36.m2.2.3.3.2"><times id="A1.E36.m2.2.3.3.2.1.cmml" xref="A1.E36.m2.2.3.3.2.1"></times><ci id="A1.E36.m2.2.3.3.2.2.cmml" xref="A1.E36.m2.2.3.3.2.2">𝑞</ci><ci id="A1.E36.m2.1.1.cmml" xref="A1.E36.m2.1.1">𝐱</ci><apply id="A1.E36.m2.2.3.3.2.4.cmml" xref="A1.E36.m2.2.3.3.2.4"><apply id="A1.E36.m2.2.3.3.2.4.1.cmml" xref="A1.E36.m2.2.3.3.2.4.1"><csymbol cd="ambiguous" id="A1.E36.m2.2.3.3.2.4.1.1.cmml" xref="A1.E36.m2.2.3.3.2.4.1">superscript</csymbol><apply id="A1.E36.m2.2.3.3.2.4.1.2.cmml" xref="A1.E36.m2.2.3.3.2.4.1"><csymbol cd="ambiguous" id="A1.E36.m2.2.3.3.2.4.1.2.1.cmml" xref="A1.E36.m2.2.3.3.2.4.1">subscript</csymbol><sum id="A1.E36.m2.2.3.3.2.4.1.2.2.cmml" xref="A1.E36.m2.2.3.3.2.4.1.2.2"></sum><apply id="A1.E36.m2.2.3.3.2.4.1.2.3.cmml" xref="A1.E36.m2.2.3.3.2.4.1.2.3"><eq id="A1.E36.m2.2.3.3.2.4.1.2.3.1.cmml" xref="A1.E36.m2.2.3.3.2.4.1.2.3.1"></eq><ci id="A1.E36.m2.2.3.3.2.4.1.2.3.2.cmml" xref="A1.E36.m2.2.3.3.2.4.1.2.3.2">𝑗</ci><cn id="A1.E36.m2.2.3.3.2.4.1.2.3.3.cmml" type="integer" xref="A1.E36.m2.2.3.3.2.4.1.2.3.3">1</cn></apply></apply><ci id="A1.E36.m2.2.3.3.2.4.1.3.cmml" xref="A1.E36.m2.2.3.3.2.4.1.3">𝐽</ci></apply><apply id="A1.E36.m2.2.3.3.2.4.2.cmml" xref="A1.E36.m2.2.3.3.2.4.2"><times id="A1.E36.m2.2.3.3.2.4.2.1.cmml" xref="A1.E36.m2.2.3.3.2.4.2.1"></times><apply id="A1.E36.m2.2.3.3.2.4.2.2.cmml" xref="A1.E36.m2.2.3.3.2.4.2.2"><csymbol cd="ambiguous" id="A1.E36.m2.2.3.3.2.4.2.2.1.cmml" xref="A1.E36.m2.2.3.3.2.4.2.2">subscript</csymbol><ci id="A1.E36.m2.2.3.3.2.4.2.2.2.cmml" xref="A1.E36.m2.2.3.3.2.4.2.2.2">𝑤</ci><ci id="A1.E36.m2.2.3.3.2.4.2.2.3.cmml" xref="A1.E36.m2.2.3.3.2.4.2.2.3">𝑗</ci></apply><apply id="A1.E36.m2.2.3.3.2.4.2.3.cmml" xref="A1.E36.m2.2.3.3.2.4.2.3"><csymbol cd="ambiguous" id="A1.E36.m2.2.3.3.2.4.2.3.1.cmml" xref="A1.E36.m2.2.3.3.2.4.2.3">subscript</csymbol><cn id="A1.E36.m2.2.3.3.2.4.2.3.2.cmml" type="integer" xref="A1.E36.m2.2.3.3.2.4.2.3.2">1</cn><apply id="A1.E36.m2.2.3.3.2.4.2.3.3.cmml" xref="A1.E36.m2.2.3.3.2.4.2.3.3"><csymbol cd="ambiguous" id="A1.E36.m2.2.3.3.2.4.2.3.3.1.cmml" xref="A1.E36.m2.2.3.3.2.4.2.3.3">subscript</csymbol><ci id="A1.E36.m2.2.3.3.2.4.2.3.3.2.cmml" xref="A1.E36.m2.2.3.3.2.4.2.3.3.2">𝑋</ci><ci id="A1.E36.m2.2.3.3.2.4.2.3.3.3.cmml" xref="A1.E36.m2.2.3.3.2.4.2.3.3.3">𝑗</ci></apply></apply><ci id="A1.E36.m2.2.2.cmml" xref="A1.E36.m2.2.2">𝐱</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E36.m2.2c">\displaystyle=\sum_{\mathbf{x}\in\mathcal{X}}q(\mathbf{x})\sum_{j=1}^{J}w_{j}%
\mathbf{1}_{X_{j}}(\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="A1.E36.m2.2d">= ∑ start_POSTSUBSCRIPT bold_x ∈ caligraphic_X end_POSTSUBSCRIPT italic_q ( bold_x ) ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_J end_POSTSUPERSCRIPT italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT bold_1 start_POSTSUBSCRIPT italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_x )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(36)</span></td>
</tr></tbody>
<tbody id="A1.E37"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sum_{j=1}^{J}w_{j}\sum_{\mathbf{x}\in X_{j}}q(\mathbf{x})\ =%
\sum_{j=1}^{J}w_{j}Q(X_{j})\,." class="ltx_Math" display="inline" id="A1.E37.m1.2"><semantics id="A1.E37.m1.2a"><mrow id="A1.E37.m1.2.2.1" xref="A1.E37.m1.2.2.1.1.cmml"><mrow id="A1.E37.m1.2.2.1.1" xref="A1.E37.m1.2.2.1.1.cmml"><mi id="A1.E37.m1.2.2.1.1.3" xref="A1.E37.m1.2.2.1.1.3.cmml"></mi><mo id="A1.E37.m1.2.2.1.1.4" xref="A1.E37.m1.2.2.1.1.4.cmml">=</mo><mrow id="A1.E37.m1.2.2.1.1.5" xref="A1.E37.m1.2.2.1.1.5.cmml"><mstyle displaystyle="true" id="A1.E37.m1.2.2.1.1.5.1" xref="A1.E37.m1.2.2.1.1.5.1.cmml"><munderover id="A1.E37.m1.2.2.1.1.5.1a" xref="A1.E37.m1.2.2.1.1.5.1.cmml"><mo id="A1.E37.m1.2.2.1.1.5.1.2.2" movablelimits="false" xref="A1.E37.m1.2.2.1.1.5.1.2.2.cmml">∑</mo><mrow id="A1.E37.m1.2.2.1.1.5.1.2.3" xref="A1.E37.m1.2.2.1.1.5.1.2.3.cmml"><mi id="A1.E37.m1.2.2.1.1.5.1.2.3.2" xref="A1.E37.m1.2.2.1.1.5.1.2.3.2.cmml">j</mi><mo id="A1.E37.m1.2.2.1.1.5.1.2.3.1" xref="A1.E37.m1.2.2.1.1.5.1.2.3.1.cmml">=</mo><mn id="A1.E37.m1.2.2.1.1.5.1.2.3.3" xref="A1.E37.m1.2.2.1.1.5.1.2.3.3.cmml">1</mn></mrow><mi id="A1.E37.m1.2.2.1.1.5.1.3" xref="A1.E37.m1.2.2.1.1.5.1.3.cmml">J</mi></munderover></mstyle><mrow id="A1.E37.m1.2.2.1.1.5.2" xref="A1.E37.m1.2.2.1.1.5.2.cmml"><msub id="A1.E37.m1.2.2.1.1.5.2.2" xref="A1.E37.m1.2.2.1.1.5.2.2.cmml"><mi id="A1.E37.m1.2.2.1.1.5.2.2.2" xref="A1.E37.m1.2.2.1.1.5.2.2.2.cmml">w</mi><mi id="A1.E37.m1.2.2.1.1.5.2.2.3" xref="A1.E37.m1.2.2.1.1.5.2.2.3.cmml">j</mi></msub><mo id="A1.E37.m1.2.2.1.1.5.2.1" xref="A1.E37.m1.2.2.1.1.5.2.1.cmml">⁢</mo><mrow id="A1.E37.m1.2.2.1.1.5.2.3" xref="A1.E37.m1.2.2.1.1.5.2.3.cmml"><mstyle displaystyle="true" id="A1.E37.m1.2.2.1.1.5.2.3.1" xref="A1.E37.m1.2.2.1.1.5.2.3.1.cmml"><munder id="A1.E37.m1.2.2.1.1.5.2.3.1a" xref="A1.E37.m1.2.2.1.1.5.2.3.1.cmml"><mo id="A1.E37.m1.2.2.1.1.5.2.3.1.2" movablelimits="false" xref="A1.E37.m1.2.2.1.1.5.2.3.1.2.cmml">∑</mo><mrow id="A1.E37.m1.2.2.1.1.5.2.3.1.3" xref="A1.E37.m1.2.2.1.1.5.2.3.1.3.cmml"><mi id="A1.E37.m1.2.2.1.1.5.2.3.1.3.2" xref="A1.E37.m1.2.2.1.1.5.2.3.1.3.2.cmml">𝐱</mi><mo id="A1.E37.m1.2.2.1.1.5.2.3.1.3.1" xref="A1.E37.m1.2.2.1.1.5.2.3.1.3.1.cmml">∈</mo><msub id="A1.E37.m1.2.2.1.1.5.2.3.1.3.3" xref="A1.E37.m1.2.2.1.1.5.2.3.1.3.3.cmml"><mi id="A1.E37.m1.2.2.1.1.5.2.3.1.3.3.2" xref="A1.E37.m1.2.2.1.1.5.2.3.1.3.3.2.cmml">X</mi><mi id="A1.E37.m1.2.2.1.1.5.2.3.1.3.3.3" xref="A1.E37.m1.2.2.1.1.5.2.3.1.3.3.3.cmml">j</mi></msub></mrow></munder></mstyle><mrow id="A1.E37.m1.2.2.1.1.5.2.3.2" xref="A1.E37.m1.2.2.1.1.5.2.3.2.cmml"><mi id="A1.E37.m1.2.2.1.1.5.2.3.2.2" xref="A1.E37.m1.2.2.1.1.5.2.3.2.2.cmml">q</mi><mo id="A1.E37.m1.2.2.1.1.5.2.3.2.1" xref="A1.E37.m1.2.2.1.1.5.2.3.2.1.cmml">⁢</mo><mrow id="A1.E37.m1.2.2.1.1.5.2.3.2.3.2" xref="A1.E37.m1.2.2.1.1.5.2.3.2.cmml"><mo id="A1.E37.m1.2.2.1.1.5.2.3.2.3.2.1" stretchy="false" xref="A1.E37.m1.2.2.1.1.5.2.3.2.cmml">(</mo><mi id="A1.E37.m1.1.1" xref="A1.E37.m1.1.1.cmml">𝐱</mi><mo id="A1.E37.m1.2.2.1.1.5.2.3.2.3.2.2" rspace="0.500em" stretchy="false" xref="A1.E37.m1.2.2.1.1.5.2.3.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="A1.E37.m1.2.2.1.1.6" xref="A1.E37.m1.2.2.1.1.6.cmml">=</mo><mrow id="A1.E37.m1.2.2.1.1.1" xref="A1.E37.m1.2.2.1.1.1.cmml"><mstyle displaystyle="true" id="A1.E37.m1.2.2.1.1.1.2" xref="A1.E37.m1.2.2.1.1.1.2.cmml"><munderover id="A1.E37.m1.2.2.1.1.1.2a" xref="A1.E37.m1.2.2.1.1.1.2.cmml"><mo id="A1.E37.m1.2.2.1.1.1.2.2.2" movablelimits="false" xref="A1.E37.m1.2.2.1.1.1.2.2.2.cmml">∑</mo><mrow id="A1.E37.m1.2.2.1.1.1.2.2.3" xref="A1.E37.m1.2.2.1.1.1.2.2.3.cmml"><mi id="A1.E37.m1.2.2.1.1.1.2.2.3.2" xref="A1.E37.m1.2.2.1.1.1.2.2.3.2.cmml">j</mi><mo id="A1.E37.m1.2.2.1.1.1.2.2.3.1" xref="A1.E37.m1.2.2.1.1.1.2.2.3.1.cmml">=</mo><mn id="A1.E37.m1.2.2.1.1.1.2.2.3.3" xref="A1.E37.m1.2.2.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="A1.E37.m1.2.2.1.1.1.2.3" xref="A1.E37.m1.2.2.1.1.1.2.3.cmml">J</mi></munderover></mstyle><mrow id="A1.E37.m1.2.2.1.1.1.1" xref="A1.E37.m1.2.2.1.1.1.1.cmml"><msub id="A1.E37.m1.2.2.1.1.1.1.3" xref="A1.E37.m1.2.2.1.1.1.1.3.cmml"><mi id="A1.E37.m1.2.2.1.1.1.1.3.2" xref="A1.E37.m1.2.2.1.1.1.1.3.2.cmml">w</mi><mi id="A1.E37.m1.2.2.1.1.1.1.3.3" xref="A1.E37.m1.2.2.1.1.1.1.3.3.cmml">j</mi></msub><mo id="A1.E37.m1.2.2.1.1.1.1.2" xref="A1.E37.m1.2.2.1.1.1.1.2.cmml">⁢</mo><mi id="A1.E37.m1.2.2.1.1.1.1.4" xref="A1.E37.m1.2.2.1.1.1.1.4.cmml">Q</mi><mo id="A1.E37.m1.2.2.1.1.1.1.2a" xref="A1.E37.m1.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E37.m1.2.2.1.1.1.1.1.1" xref="A1.E37.m1.2.2.1.1.1.1.1.1.1.cmml"><mo id="A1.E37.m1.2.2.1.1.1.1.1.1.2" stretchy="false" xref="A1.E37.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><msub id="A1.E37.m1.2.2.1.1.1.1.1.1.1" xref="A1.E37.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="A1.E37.m1.2.2.1.1.1.1.1.1.1.2" xref="A1.E37.m1.2.2.1.1.1.1.1.1.1.2.cmml">X</mi><mi id="A1.E37.m1.2.2.1.1.1.1.1.1.1.3" xref="A1.E37.m1.2.2.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="A1.E37.m1.2.2.1.1.1.1.1.1.3" stretchy="false" xref="A1.E37.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A1.E37.m1.2.2.1.2" lspace="0.170em" xref="A1.E37.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E37.m1.2b"><apply id="A1.E37.m1.2.2.1.1.cmml" xref="A1.E37.m1.2.2.1"><and id="A1.E37.m1.2.2.1.1a.cmml" xref="A1.E37.m1.2.2.1"></and><apply id="A1.E37.m1.2.2.1.1b.cmml" xref="A1.E37.m1.2.2.1"><eq id="A1.E37.m1.2.2.1.1.4.cmml" xref="A1.E37.m1.2.2.1.1.4"></eq><csymbol cd="latexml" id="A1.E37.m1.2.2.1.1.3.cmml" xref="A1.E37.m1.2.2.1.1.3">absent</csymbol><apply id="A1.E37.m1.2.2.1.1.5.cmml" xref="A1.E37.m1.2.2.1.1.5"><apply id="A1.E37.m1.2.2.1.1.5.1.cmml" xref="A1.E37.m1.2.2.1.1.5.1"><csymbol cd="ambiguous" id="A1.E37.m1.2.2.1.1.5.1.1.cmml" xref="A1.E37.m1.2.2.1.1.5.1">superscript</csymbol><apply id="A1.E37.m1.2.2.1.1.5.1.2.cmml" xref="A1.E37.m1.2.2.1.1.5.1"><csymbol cd="ambiguous" id="A1.E37.m1.2.2.1.1.5.1.2.1.cmml" xref="A1.E37.m1.2.2.1.1.5.1">subscript</csymbol><sum id="A1.E37.m1.2.2.1.1.5.1.2.2.cmml" xref="A1.E37.m1.2.2.1.1.5.1.2.2"></sum><apply id="A1.E37.m1.2.2.1.1.5.1.2.3.cmml" xref="A1.E37.m1.2.2.1.1.5.1.2.3"><eq id="A1.E37.m1.2.2.1.1.5.1.2.3.1.cmml" xref="A1.E37.m1.2.2.1.1.5.1.2.3.1"></eq><ci id="A1.E37.m1.2.2.1.1.5.1.2.3.2.cmml" xref="A1.E37.m1.2.2.1.1.5.1.2.3.2">𝑗</ci><cn id="A1.E37.m1.2.2.1.1.5.1.2.3.3.cmml" type="integer" xref="A1.E37.m1.2.2.1.1.5.1.2.3.3">1</cn></apply></apply><ci id="A1.E37.m1.2.2.1.1.5.1.3.cmml" xref="A1.E37.m1.2.2.1.1.5.1.3">𝐽</ci></apply><apply id="A1.E37.m1.2.2.1.1.5.2.cmml" xref="A1.E37.m1.2.2.1.1.5.2"><times id="A1.E37.m1.2.2.1.1.5.2.1.cmml" xref="A1.E37.m1.2.2.1.1.5.2.1"></times><apply id="A1.E37.m1.2.2.1.1.5.2.2.cmml" xref="A1.E37.m1.2.2.1.1.5.2.2"><csymbol cd="ambiguous" id="A1.E37.m1.2.2.1.1.5.2.2.1.cmml" xref="A1.E37.m1.2.2.1.1.5.2.2">subscript</csymbol><ci id="A1.E37.m1.2.2.1.1.5.2.2.2.cmml" xref="A1.E37.m1.2.2.1.1.5.2.2.2">𝑤</ci><ci id="A1.E37.m1.2.2.1.1.5.2.2.3.cmml" xref="A1.E37.m1.2.2.1.1.5.2.2.3">𝑗</ci></apply><apply id="A1.E37.m1.2.2.1.1.5.2.3.cmml" xref="A1.E37.m1.2.2.1.1.5.2.3"><apply id="A1.E37.m1.2.2.1.1.5.2.3.1.cmml" xref="A1.E37.m1.2.2.1.1.5.2.3.1"><csymbol cd="ambiguous" id="A1.E37.m1.2.2.1.1.5.2.3.1.1.cmml" xref="A1.E37.m1.2.2.1.1.5.2.3.1">subscript</csymbol><sum id="A1.E37.m1.2.2.1.1.5.2.3.1.2.cmml" xref="A1.E37.m1.2.2.1.1.5.2.3.1.2"></sum><apply id="A1.E37.m1.2.2.1.1.5.2.3.1.3.cmml" xref="A1.E37.m1.2.2.1.1.5.2.3.1.3"><in id="A1.E37.m1.2.2.1.1.5.2.3.1.3.1.cmml" xref="A1.E37.m1.2.2.1.1.5.2.3.1.3.1"></in><ci id="A1.E37.m1.2.2.1.1.5.2.3.1.3.2.cmml" xref="A1.E37.m1.2.2.1.1.5.2.3.1.3.2">𝐱</ci><apply id="A1.E37.m1.2.2.1.1.5.2.3.1.3.3.cmml" xref="A1.E37.m1.2.2.1.1.5.2.3.1.3.3"><csymbol cd="ambiguous" id="A1.E37.m1.2.2.1.1.5.2.3.1.3.3.1.cmml" xref="A1.E37.m1.2.2.1.1.5.2.3.1.3.3">subscript</csymbol><ci id="A1.E37.m1.2.2.1.1.5.2.3.1.3.3.2.cmml" xref="A1.E37.m1.2.2.1.1.5.2.3.1.3.3.2">𝑋</ci><ci id="A1.E37.m1.2.2.1.1.5.2.3.1.3.3.3.cmml" xref="A1.E37.m1.2.2.1.1.5.2.3.1.3.3.3">𝑗</ci></apply></apply></apply><apply id="A1.E37.m1.2.2.1.1.5.2.3.2.cmml" xref="A1.E37.m1.2.2.1.1.5.2.3.2"><times id="A1.E37.m1.2.2.1.1.5.2.3.2.1.cmml" xref="A1.E37.m1.2.2.1.1.5.2.3.2.1"></times><ci id="A1.E37.m1.2.2.1.1.5.2.3.2.2.cmml" xref="A1.E37.m1.2.2.1.1.5.2.3.2.2">𝑞</ci><ci id="A1.E37.m1.1.1.cmml" xref="A1.E37.m1.1.1">𝐱</ci></apply></apply></apply></apply></apply><apply id="A1.E37.m1.2.2.1.1c.cmml" xref="A1.E37.m1.2.2.1"><eq id="A1.E37.m1.2.2.1.1.6.cmml" xref="A1.E37.m1.2.2.1.1.6"></eq><share href="https://arxiv.org/html/2410.03535v1#A1.E37.m1.2.2.1.1.5.cmml" id="A1.E37.m1.2.2.1.1d.cmml" xref="A1.E37.m1.2.2.1"></share><apply id="A1.E37.m1.2.2.1.1.1.cmml" xref="A1.E37.m1.2.2.1.1.1"><apply id="A1.E37.m1.2.2.1.1.1.2.cmml" xref="A1.E37.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="A1.E37.m1.2.2.1.1.1.2.1.cmml" xref="A1.E37.m1.2.2.1.1.1.2">superscript</csymbol><apply id="A1.E37.m1.2.2.1.1.1.2.2.cmml" xref="A1.E37.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="A1.E37.m1.2.2.1.1.1.2.2.1.cmml" xref="A1.E37.m1.2.2.1.1.1.2">subscript</csymbol><sum id="A1.E37.m1.2.2.1.1.1.2.2.2.cmml" xref="A1.E37.m1.2.2.1.1.1.2.2.2"></sum><apply id="A1.E37.m1.2.2.1.1.1.2.2.3.cmml" xref="A1.E37.m1.2.2.1.1.1.2.2.3"><eq id="A1.E37.m1.2.2.1.1.1.2.2.3.1.cmml" xref="A1.E37.m1.2.2.1.1.1.2.2.3.1"></eq><ci id="A1.E37.m1.2.2.1.1.1.2.2.3.2.cmml" xref="A1.E37.m1.2.2.1.1.1.2.2.3.2">𝑗</ci><cn id="A1.E37.m1.2.2.1.1.1.2.2.3.3.cmml" type="integer" xref="A1.E37.m1.2.2.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="A1.E37.m1.2.2.1.1.1.2.3.cmml" xref="A1.E37.m1.2.2.1.1.1.2.3">𝐽</ci></apply><apply id="A1.E37.m1.2.2.1.1.1.1.cmml" xref="A1.E37.m1.2.2.1.1.1.1"><times id="A1.E37.m1.2.2.1.1.1.1.2.cmml" xref="A1.E37.m1.2.2.1.1.1.1.2"></times><apply id="A1.E37.m1.2.2.1.1.1.1.3.cmml" xref="A1.E37.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E37.m1.2.2.1.1.1.1.3.1.cmml" xref="A1.E37.m1.2.2.1.1.1.1.3">subscript</csymbol><ci id="A1.E37.m1.2.2.1.1.1.1.3.2.cmml" xref="A1.E37.m1.2.2.1.1.1.1.3.2">𝑤</ci><ci id="A1.E37.m1.2.2.1.1.1.1.3.3.cmml" xref="A1.E37.m1.2.2.1.1.1.1.3.3">𝑗</ci></apply><ci id="A1.E37.m1.2.2.1.1.1.1.4.cmml" xref="A1.E37.m1.2.2.1.1.1.1.4">𝑄</ci><apply id="A1.E37.m1.2.2.1.1.1.1.1.1.1.cmml" xref="A1.E37.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E37.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="A1.E37.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E37.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="A1.E37.m1.2.2.1.1.1.1.1.1.1.2">𝑋</ci><ci id="A1.E37.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="A1.E37.m1.2.2.1.1.1.1.1.1.1.3">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E37.m1.2c">\displaystyle=\sum_{j=1}^{J}w_{j}\sum_{\mathbf{x}\in X_{j}}q(\mathbf{x})\ =%
\sum_{j=1}^{J}w_{j}Q(X_{j})\,.</annotation><annotation encoding="application/x-llamapun" id="A1.E37.m1.2d">= ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_J end_POSTSUPERSCRIPT italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT bold_x ∈ italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_q ( bold_x ) = ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_J end_POSTSUPERSCRIPT italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_Q ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(37)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS1.p1.3">Similarly, making use of the fact that <math alttext="\mathbf{1}_{X_{i}}(\mathbf{x})\mathbf{1}_{X_{j}}(\mathbf{x})=\delta_{ij}%
\mathbf{1}_{X_{i}}(\mathbf{x})" class="ltx_Math" display="inline" id="A1.SS1.p1.3.m1.3"><semantics id="A1.SS1.p1.3.m1.3a"><mrow id="A1.SS1.p1.3.m1.3.4" xref="A1.SS1.p1.3.m1.3.4.cmml"><mrow id="A1.SS1.p1.3.m1.3.4.2" xref="A1.SS1.p1.3.m1.3.4.2.cmml"><msub id="A1.SS1.p1.3.m1.3.4.2.2" xref="A1.SS1.p1.3.m1.3.4.2.2.cmml"><mn id="A1.SS1.p1.3.m1.3.4.2.2.2" xref="A1.SS1.p1.3.m1.3.4.2.2.2.cmml">𝟏</mn><msub id="A1.SS1.p1.3.m1.3.4.2.2.3" xref="A1.SS1.p1.3.m1.3.4.2.2.3.cmml"><mi id="A1.SS1.p1.3.m1.3.4.2.2.3.2" xref="A1.SS1.p1.3.m1.3.4.2.2.3.2.cmml">X</mi><mi id="A1.SS1.p1.3.m1.3.4.2.2.3.3" xref="A1.SS1.p1.3.m1.3.4.2.2.3.3.cmml">i</mi></msub></msub><mo id="A1.SS1.p1.3.m1.3.4.2.1" xref="A1.SS1.p1.3.m1.3.4.2.1.cmml">⁢</mo><mrow id="A1.SS1.p1.3.m1.3.4.2.3.2" xref="A1.SS1.p1.3.m1.3.4.2.cmml"><mo id="A1.SS1.p1.3.m1.3.4.2.3.2.1" stretchy="false" xref="A1.SS1.p1.3.m1.3.4.2.cmml">(</mo><mi id="A1.SS1.p1.3.m1.1.1" xref="A1.SS1.p1.3.m1.1.1.cmml">𝐱</mi><mo id="A1.SS1.p1.3.m1.3.4.2.3.2.2" stretchy="false" xref="A1.SS1.p1.3.m1.3.4.2.cmml">)</mo></mrow><mo id="A1.SS1.p1.3.m1.3.4.2.1a" xref="A1.SS1.p1.3.m1.3.4.2.1.cmml">⁢</mo><msub id="A1.SS1.p1.3.m1.3.4.2.4" xref="A1.SS1.p1.3.m1.3.4.2.4.cmml"><mn id="A1.SS1.p1.3.m1.3.4.2.4.2" xref="A1.SS1.p1.3.m1.3.4.2.4.2.cmml">𝟏</mn><msub id="A1.SS1.p1.3.m1.3.4.2.4.3" xref="A1.SS1.p1.3.m1.3.4.2.4.3.cmml"><mi id="A1.SS1.p1.3.m1.3.4.2.4.3.2" xref="A1.SS1.p1.3.m1.3.4.2.4.3.2.cmml">X</mi><mi id="A1.SS1.p1.3.m1.3.4.2.4.3.3" xref="A1.SS1.p1.3.m1.3.4.2.4.3.3.cmml">j</mi></msub></msub><mo id="A1.SS1.p1.3.m1.3.4.2.1b" xref="A1.SS1.p1.3.m1.3.4.2.1.cmml">⁢</mo><mrow id="A1.SS1.p1.3.m1.3.4.2.5.2" xref="A1.SS1.p1.3.m1.3.4.2.cmml"><mo id="A1.SS1.p1.3.m1.3.4.2.5.2.1" stretchy="false" xref="A1.SS1.p1.3.m1.3.4.2.cmml">(</mo><mi id="A1.SS1.p1.3.m1.2.2" xref="A1.SS1.p1.3.m1.2.2.cmml">𝐱</mi><mo id="A1.SS1.p1.3.m1.3.4.2.5.2.2" stretchy="false" xref="A1.SS1.p1.3.m1.3.4.2.cmml">)</mo></mrow></mrow><mo id="A1.SS1.p1.3.m1.3.4.1" xref="A1.SS1.p1.3.m1.3.4.1.cmml">=</mo><mrow id="A1.SS1.p1.3.m1.3.4.3" xref="A1.SS1.p1.3.m1.3.4.3.cmml"><msub id="A1.SS1.p1.3.m1.3.4.3.2" xref="A1.SS1.p1.3.m1.3.4.3.2.cmml"><mi id="A1.SS1.p1.3.m1.3.4.3.2.2" xref="A1.SS1.p1.3.m1.3.4.3.2.2.cmml">δ</mi><mrow id="A1.SS1.p1.3.m1.3.4.3.2.3" xref="A1.SS1.p1.3.m1.3.4.3.2.3.cmml"><mi id="A1.SS1.p1.3.m1.3.4.3.2.3.2" xref="A1.SS1.p1.3.m1.3.4.3.2.3.2.cmml">i</mi><mo id="A1.SS1.p1.3.m1.3.4.3.2.3.1" xref="A1.SS1.p1.3.m1.3.4.3.2.3.1.cmml">⁢</mo><mi id="A1.SS1.p1.3.m1.3.4.3.2.3.3" xref="A1.SS1.p1.3.m1.3.4.3.2.3.3.cmml">j</mi></mrow></msub><mo id="A1.SS1.p1.3.m1.3.4.3.1" xref="A1.SS1.p1.3.m1.3.4.3.1.cmml">⁢</mo><msub id="A1.SS1.p1.3.m1.3.4.3.3" xref="A1.SS1.p1.3.m1.3.4.3.3.cmml"><mn id="A1.SS1.p1.3.m1.3.4.3.3.2" xref="A1.SS1.p1.3.m1.3.4.3.3.2.cmml">𝟏</mn><msub id="A1.SS1.p1.3.m1.3.4.3.3.3" xref="A1.SS1.p1.3.m1.3.4.3.3.3.cmml"><mi id="A1.SS1.p1.3.m1.3.4.3.3.3.2" xref="A1.SS1.p1.3.m1.3.4.3.3.3.2.cmml">X</mi><mi id="A1.SS1.p1.3.m1.3.4.3.3.3.3" xref="A1.SS1.p1.3.m1.3.4.3.3.3.3.cmml">i</mi></msub></msub><mo id="A1.SS1.p1.3.m1.3.4.3.1a" xref="A1.SS1.p1.3.m1.3.4.3.1.cmml">⁢</mo><mrow id="A1.SS1.p1.3.m1.3.4.3.4.2" xref="A1.SS1.p1.3.m1.3.4.3.cmml"><mo id="A1.SS1.p1.3.m1.3.4.3.4.2.1" stretchy="false" xref="A1.SS1.p1.3.m1.3.4.3.cmml">(</mo><mi id="A1.SS1.p1.3.m1.3.3" xref="A1.SS1.p1.3.m1.3.3.cmml">𝐱</mi><mo id="A1.SS1.p1.3.m1.3.4.3.4.2.2" stretchy="false" xref="A1.SS1.p1.3.m1.3.4.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.3.m1.3b"><apply id="A1.SS1.p1.3.m1.3.4.cmml" xref="A1.SS1.p1.3.m1.3.4"><eq id="A1.SS1.p1.3.m1.3.4.1.cmml" xref="A1.SS1.p1.3.m1.3.4.1"></eq><apply id="A1.SS1.p1.3.m1.3.4.2.cmml" xref="A1.SS1.p1.3.m1.3.4.2"><times id="A1.SS1.p1.3.m1.3.4.2.1.cmml" xref="A1.SS1.p1.3.m1.3.4.2.1"></times><apply id="A1.SS1.p1.3.m1.3.4.2.2.cmml" xref="A1.SS1.p1.3.m1.3.4.2.2"><csymbol cd="ambiguous" id="A1.SS1.p1.3.m1.3.4.2.2.1.cmml" xref="A1.SS1.p1.3.m1.3.4.2.2">subscript</csymbol><cn id="A1.SS1.p1.3.m1.3.4.2.2.2.cmml" type="integer" xref="A1.SS1.p1.3.m1.3.4.2.2.2">1</cn><apply id="A1.SS1.p1.3.m1.3.4.2.2.3.cmml" xref="A1.SS1.p1.3.m1.3.4.2.2.3"><csymbol cd="ambiguous" id="A1.SS1.p1.3.m1.3.4.2.2.3.1.cmml" xref="A1.SS1.p1.3.m1.3.4.2.2.3">subscript</csymbol><ci id="A1.SS1.p1.3.m1.3.4.2.2.3.2.cmml" xref="A1.SS1.p1.3.m1.3.4.2.2.3.2">𝑋</ci><ci id="A1.SS1.p1.3.m1.3.4.2.2.3.3.cmml" xref="A1.SS1.p1.3.m1.3.4.2.2.3.3">𝑖</ci></apply></apply><ci id="A1.SS1.p1.3.m1.1.1.cmml" xref="A1.SS1.p1.3.m1.1.1">𝐱</ci><apply id="A1.SS1.p1.3.m1.3.4.2.4.cmml" xref="A1.SS1.p1.3.m1.3.4.2.4"><csymbol cd="ambiguous" id="A1.SS1.p1.3.m1.3.4.2.4.1.cmml" xref="A1.SS1.p1.3.m1.3.4.2.4">subscript</csymbol><cn id="A1.SS1.p1.3.m1.3.4.2.4.2.cmml" type="integer" xref="A1.SS1.p1.3.m1.3.4.2.4.2">1</cn><apply id="A1.SS1.p1.3.m1.3.4.2.4.3.cmml" xref="A1.SS1.p1.3.m1.3.4.2.4.3"><csymbol cd="ambiguous" id="A1.SS1.p1.3.m1.3.4.2.4.3.1.cmml" xref="A1.SS1.p1.3.m1.3.4.2.4.3">subscript</csymbol><ci id="A1.SS1.p1.3.m1.3.4.2.4.3.2.cmml" xref="A1.SS1.p1.3.m1.3.4.2.4.3.2">𝑋</ci><ci id="A1.SS1.p1.3.m1.3.4.2.4.3.3.cmml" xref="A1.SS1.p1.3.m1.3.4.2.4.3.3">𝑗</ci></apply></apply><ci id="A1.SS1.p1.3.m1.2.2.cmml" xref="A1.SS1.p1.3.m1.2.2">𝐱</ci></apply><apply id="A1.SS1.p1.3.m1.3.4.3.cmml" xref="A1.SS1.p1.3.m1.3.4.3"><times id="A1.SS1.p1.3.m1.3.4.3.1.cmml" xref="A1.SS1.p1.3.m1.3.4.3.1"></times><apply id="A1.SS1.p1.3.m1.3.4.3.2.cmml" xref="A1.SS1.p1.3.m1.3.4.3.2"><csymbol cd="ambiguous" id="A1.SS1.p1.3.m1.3.4.3.2.1.cmml" xref="A1.SS1.p1.3.m1.3.4.3.2">subscript</csymbol><ci id="A1.SS1.p1.3.m1.3.4.3.2.2.cmml" xref="A1.SS1.p1.3.m1.3.4.3.2.2">𝛿</ci><apply id="A1.SS1.p1.3.m1.3.4.3.2.3.cmml" xref="A1.SS1.p1.3.m1.3.4.3.2.3"><times id="A1.SS1.p1.3.m1.3.4.3.2.3.1.cmml" xref="A1.SS1.p1.3.m1.3.4.3.2.3.1"></times><ci id="A1.SS1.p1.3.m1.3.4.3.2.3.2.cmml" xref="A1.SS1.p1.3.m1.3.4.3.2.3.2">𝑖</ci><ci id="A1.SS1.p1.3.m1.3.4.3.2.3.3.cmml" xref="A1.SS1.p1.3.m1.3.4.3.2.3.3">𝑗</ci></apply></apply><apply id="A1.SS1.p1.3.m1.3.4.3.3.cmml" xref="A1.SS1.p1.3.m1.3.4.3.3"><csymbol cd="ambiguous" id="A1.SS1.p1.3.m1.3.4.3.3.1.cmml" xref="A1.SS1.p1.3.m1.3.4.3.3">subscript</csymbol><cn id="A1.SS1.p1.3.m1.3.4.3.3.2.cmml" type="integer" xref="A1.SS1.p1.3.m1.3.4.3.3.2">1</cn><apply id="A1.SS1.p1.3.m1.3.4.3.3.3.cmml" xref="A1.SS1.p1.3.m1.3.4.3.3.3"><csymbol cd="ambiguous" id="A1.SS1.p1.3.m1.3.4.3.3.3.1.cmml" xref="A1.SS1.p1.3.m1.3.4.3.3.3">subscript</csymbol><ci id="A1.SS1.p1.3.m1.3.4.3.3.3.2.cmml" xref="A1.SS1.p1.3.m1.3.4.3.3.3.2">𝑋</ci><ci id="A1.SS1.p1.3.m1.3.4.3.3.3.3.cmml" xref="A1.SS1.p1.3.m1.3.4.3.3.3.3">𝑖</ci></apply></apply><ci id="A1.SS1.p1.3.m1.3.3.cmml" xref="A1.SS1.p1.3.m1.3.3">𝐱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.3.m1.3c">\mathbf{1}_{X_{i}}(\mathbf{x})\mathbf{1}_{X_{j}}(\mathbf{x})=\delta_{ij}%
\mathbf{1}_{X_{i}}(\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.3.m1.3d">bold_1 start_POSTSUBSCRIPT italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_x ) bold_1 start_POSTSUBSCRIPT italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_x ) = italic_δ start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT bold_1 start_POSTSUBSCRIPT italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_x )</annotation></semantics></math>, we can compute</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A5.EGx7">
<tbody id="A1.E38"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbb{E}_{\mathbf{x}\sim q}\delta f^{2}(\mathbf{x})=\sum_{%
\mathbf{x}\in\mathcal{X}}q(\mathbf{x})\left(\sum_{j=1}^{J}w_{j}\mathbf{1}_{X_{%
j}}(\mathbf{x})\right)^{2}=\sum_{j=1}^{J}w_{j}^{2}Q(X_{j})\,." class="ltx_Math" display="inline" id="A1.E38.m1.4"><semantics id="A1.E38.m1.4a"><mrow id="A1.E38.m1.4.4.1" xref="A1.E38.m1.4.4.1.1.cmml"><mrow id="A1.E38.m1.4.4.1.1" xref="A1.E38.m1.4.4.1.1.cmml"><mrow id="A1.E38.m1.4.4.1.1.4" xref="A1.E38.m1.4.4.1.1.4.cmml"><msub id="A1.E38.m1.4.4.1.1.4.2" xref="A1.E38.m1.4.4.1.1.4.2.cmml"><mi id="A1.E38.m1.4.4.1.1.4.2.2" xref="A1.E38.m1.4.4.1.1.4.2.2.cmml">𝔼</mi><mrow id="A1.E38.m1.4.4.1.1.4.2.3" xref="A1.E38.m1.4.4.1.1.4.2.3.cmml"><mi id="A1.E38.m1.4.4.1.1.4.2.3.2" xref="A1.E38.m1.4.4.1.1.4.2.3.2.cmml">𝐱</mi><mo id="A1.E38.m1.4.4.1.1.4.2.3.1" xref="A1.E38.m1.4.4.1.1.4.2.3.1.cmml">∼</mo><mi id="A1.E38.m1.4.4.1.1.4.2.3.3" xref="A1.E38.m1.4.4.1.1.4.2.3.3.cmml">q</mi></mrow></msub><mo id="A1.E38.m1.4.4.1.1.4.1" xref="A1.E38.m1.4.4.1.1.4.1.cmml">⁢</mo><mi id="A1.E38.m1.4.4.1.1.4.3" xref="A1.E38.m1.4.4.1.1.4.3.cmml">δ</mi><mo id="A1.E38.m1.4.4.1.1.4.1a" xref="A1.E38.m1.4.4.1.1.4.1.cmml">⁢</mo><msup id="A1.E38.m1.4.4.1.1.4.4" xref="A1.E38.m1.4.4.1.1.4.4.cmml"><mi id="A1.E38.m1.4.4.1.1.4.4.2" xref="A1.E38.m1.4.4.1.1.4.4.2.cmml">f</mi><mn id="A1.E38.m1.4.4.1.1.4.4.3" xref="A1.E38.m1.4.4.1.1.4.4.3.cmml">2</mn></msup><mo id="A1.E38.m1.4.4.1.1.4.1b" xref="A1.E38.m1.4.4.1.1.4.1.cmml">⁢</mo><mrow id="A1.E38.m1.4.4.1.1.4.5.2" xref="A1.E38.m1.4.4.1.1.4.cmml"><mo id="A1.E38.m1.4.4.1.1.4.5.2.1" stretchy="false" xref="A1.E38.m1.4.4.1.1.4.cmml">(</mo><mi id="A1.E38.m1.1.1" xref="A1.E38.m1.1.1.cmml">𝐱</mi><mo id="A1.E38.m1.4.4.1.1.4.5.2.2" stretchy="false" xref="A1.E38.m1.4.4.1.1.4.cmml">)</mo></mrow></mrow><mo id="A1.E38.m1.4.4.1.1.5" xref="A1.E38.m1.4.4.1.1.5.cmml">=</mo><mrow id="A1.E38.m1.4.4.1.1.1" xref="A1.E38.m1.4.4.1.1.1.cmml"><mstyle displaystyle="true" id="A1.E38.m1.4.4.1.1.1.2" xref="A1.E38.m1.4.4.1.1.1.2.cmml"><munder id="A1.E38.m1.4.4.1.1.1.2a" xref="A1.E38.m1.4.4.1.1.1.2.cmml"><mo id="A1.E38.m1.4.4.1.1.1.2.2" movablelimits="false" xref="A1.E38.m1.4.4.1.1.1.2.2.cmml">∑</mo><mrow id="A1.E38.m1.4.4.1.1.1.2.3" xref="A1.E38.m1.4.4.1.1.1.2.3.cmml"><mi id="A1.E38.m1.4.4.1.1.1.2.3.2" xref="A1.E38.m1.4.4.1.1.1.2.3.2.cmml">𝐱</mi><mo id="A1.E38.m1.4.4.1.1.1.2.3.1" xref="A1.E38.m1.4.4.1.1.1.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="A1.E38.m1.4.4.1.1.1.2.3.3" xref="A1.E38.m1.4.4.1.1.1.2.3.3.cmml">𝒳</mi></mrow></munder></mstyle><mrow id="A1.E38.m1.4.4.1.1.1.1" xref="A1.E38.m1.4.4.1.1.1.1.cmml"><mi id="A1.E38.m1.4.4.1.1.1.1.3" xref="A1.E38.m1.4.4.1.1.1.1.3.cmml">q</mi><mo id="A1.E38.m1.4.4.1.1.1.1.2" xref="A1.E38.m1.4.4.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E38.m1.4.4.1.1.1.1.4.2" xref="A1.E38.m1.4.4.1.1.1.1.cmml"><mo id="A1.E38.m1.4.4.1.1.1.1.4.2.1" stretchy="false" xref="A1.E38.m1.4.4.1.1.1.1.cmml">(</mo><mi id="A1.E38.m1.2.2" xref="A1.E38.m1.2.2.cmml">𝐱</mi><mo id="A1.E38.m1.4.4.1.1.1.1.4.2.2" stretchy="false" xref="A1.E38.m1.4.4.1.1.1.1.cmml">)</mo></mrow><mo id="A1.E38.m1.4.4.1.1.1.1.2a" xref="A1.E38.m1.4.4.1.1.1.1.2.cmml">⁢</mo><msup id="A1.E38.m1.4.4.1.1.1.1.1" xref="A1.E38.m1.4.4.1.1.1.1.1.cmml"><mrow id="A1.E38.m1.4.4.1.1.1.1.1.1.1" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E38.m1.4.4.1.1.1.1.1.1.1.2" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E38.m1.4.4.1.1.1.1.1.1.1.1" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.1" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"><munderover id="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.1a" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.1.2.2" movablelimits="false" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.1.2.3" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.1.2.3.2" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.1.2.3.2.cmml">j</mi><mo id="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.1.2.3.1" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.1.2.3.3" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.1.3" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.1.3.cmml">J</mi></munderover></mstyle><mrow id="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.cmml"><msub id="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.2" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.2.2" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.2.2.cmml">w</mi><mi id="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.2.3" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.2.3.cmml">j</mi></msub><mo id="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.1" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.3" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.3.cmml"><mn id="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.3.2" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.3.2.cmml">𝟏</mn><msub id="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.3.3" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.3.3.cmml"><mi id="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.3.3.2" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.3.3.2.cmml">X</mi><mi id="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.3.3.3" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.3.3.3.cmml">j</mi></msub></msub><mo id="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.1a" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.4.2" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.cmml"><mo id="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.4.2.1" stretchy="false" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="A1.E38.m1.3.3" xref="A1.E38.m1.3.3.cmml">𝐱</mi><mo id="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.4.2.2" stretchy="false" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E38.m1.4.4.1.1.1.1.1.1.1.3" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="A1.E38.m1.4.4.1.1.1.1.1.3" xref="A1.E38.m1.4.4.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow><mo id="A1.E38.m1.4.4.1.1.6" xref="A1.E38.m1.4.4.1.1.6.cmml">=</mo><mrow id="A1.E38.m1.4.4.1.1.2" xref="A1.E38.m1.4.4.1.1.2.cmml"><mstyle displaystyle="true" id="A1.E38.m1.4.4.1.1.2.2" xref="A1.E38.m1.4.4.1.1.2.2.cmml"><munderover id="A1.E38.m1.4.4.1.1.2.2a" xref="A1.E38.m1.4.4.1.1.2.2.cmml"><mo id="A1.E38.m1.4.4.1.1.2.2.2.2" movablelimits="false" xref="A1.E38.m1.4.4.1.1.2.2.2.2.cmml">∑</mo><mrow id="A1.E38.m1.4.4.1.1.2.2.2.3" xref="A1.E38.m1.4.4.1.1.2.2.2.3.cmml"><mi id="A1.E38.m1.4.4.1.1.2.2.2.3.2" xref="A1.E38.m1.4.4.1.1.2.2.2.3.2.cmml">j</mi><mo id="A1.E38.m1.4.4.1.1.2.2.2.3.1" xref="A1.E38.m1.4.4.1.1.2.2.2.3.1.cmml">=</mo><mn id="A1.E38.m1.4.4.1.1.2.2.2.3.3" xref="A1.E38.m1.4.4.1.1.2.2.2.3.3.cmml">1</mn></mrow><mi id="A1.E38.m1.4.4.1.1.2.2.3" xref="A1.E38.m1.4.4.1.1.2.2.3.cmml">J</mi></munderover></mstyle><mrow id="A1.E38.m1.4.4.1.1.2.1" xref="A1.E38.m1.4.4.1.1.2.1.cmml"><msubsup id="A1.E38.m1.4.4.1.1.2.1.3" xref="A1.E38.m1.4.4.1.1.2.1.3.cmml"><mi id="A1.E38.m1.4.4.1.1.2.1.3.2.2" xref="A1.E38.m1.4.4.1.1.2.1.3.2.2.cmml">w</mi><mi id="A1.E38.m1.4.4.1.1.2.1.3.2.3" xref="A1.E38.m1.4.4.1.1.2.1.3.2.3.cmml">j</mi><mn id="A1.E38.m1.4.4.1.1.2.1.3.3" xref="A1.E38.m1.4.4.1.1.2.1.3.3.cmml">2</mn></msubsup><mo id="A1.E38.m1.4.4.1.1.2.1.2" xref="A1.E38.m1.4.4.1.1.2.1.2.cmml">⁢</mo><mi id="A1.E38.m1.4.4.1.1.2.1.4" xref="A1.E38.m1.4.4.1.1.2.1.4.cmml">Q</mi><mo id="A1.E38.m1.4.4.1.1.2.1.2a" xref="A1.E38.m1.4.4.1.1.2.1.2.cmml">⁢</mo><mrow id="A1.E38.m1.4.4.1.1.2.1.1.1" xref="A1.E38.m1.4.4.1.1.2.1.1.1.1.cmml"><mo id="A1.E38.m1.4.4.1.1.2.1.1.1.2" stretchy="false" xref="A1.E38.m1.4.4.1.1.2.1.1.1.1.cmml">(</mo><msub id="A1.E38.m1.4.4.1.1.2.1.1.1.1" xref="A1.E38.m1.4.4.1.1.2.1.1.1.1.cmml"><mi id="A1.E38.m1.4.4.1.1.2.1.1.1.1.2" xref="A1.E38.m1.4.4.1.1.2.1.1.1.1.2.cmml">X</mi><mi id="A1.E38.m1.4.4.1.1.2.1.1.1.1.3" xref="A1.E38.m1.4.4.1.1.2.1.1.1.1.3.cmml">j</mi></msub><mo id="A1.E38.m1.4.4.1.1.2.1.1.1.3" stretchy="false" xref="A1.E38.m1.4.4.1.1.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A1.E38.m1.4.4.1.2" lspace="0.170em" xref="A1.E38.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E38.m1.4b"><apply id="A1.E38.m1.4.4.1.1.cmml" xref="A1.E38.m1.4.4.1"><and id="A1.E38.m1.4.4.1.1a.cmml" xref="A1.E38.m1.4.4.1"></and><apply id="A1.E38.m1.4.4.1.1b.cmml" xref="A1.E38.m1.4.4.1"><eq id="A1.E38.m1.4.4.1.1.5.cmml" xref="A1.E38.m1.4.4.1.1.5"></eq><apply id="A1.E38.m1.4.4.1.1.4.cmml" xref="A1.E38.m1.4.4.1.1.4"><times id="A1.E38.m1.4.4.1.1.4.1.cmml" xref="A1.E38.m1.4.4.1.1.4.1"></times><apply id="A1.E38.m1.4.4.1.1.4.2.cmml" xref="A1.E38.m1.4.4.1.1.4.2"><csymbol cd="ambiguous" id="A1.E38.m1.4.4.1.1.4.2.1.cmml" xref="A1.E38.m1.4.4.1.1.4.2">subscript</csymbol><ci id="A1.E38.m1.4.4.1.1.4.2.2.cmml" xref="A1.E38.m1.4.4.1.1.4.2.2">𝔼</ci><apply id="A1.E38.m1.4.4.1.1.4.2.3.cmml" xref="A1.E38.m1.4.4.1.1.4.2.3"><csymbol cd="latexml" id="A1.E38.m1.4.4.1.1.4.2.3.1.cmml" xref="A1.E38.m1.4.4.1.1.4.2.3.1">similar-to</csymbol><ci id="A1.E38.m1.4.4.1.1.4.2.3.2.cmml" xref="A1.E38.m1.4.4.1.1.4.2.3.2">𝐱</ci><ci id="A1.E38.m1.4.4.1.1.4.2.3.3.cmml" xref="A1.E38.m1.4.4.1.1.4.2.3.3">𝑞</ci></apply></apply><ci id="A1.E38.m1.4.4.1.1.4.3.cmml" xref="A1.E38.m1.4.4.1.1.4.3">𝛿</ci><apply id="A1.E38.m1.4.4.1.1.4.4.cmml" xref="A1.E38.m1.4.4.1.1.4.4"><csymbol cd="ambiguous" id="A1.E38.m1.4.4.1.1.4.4.1.cmml" xref="A1.E38.m1.4.4.1.1.4.4">superscript</csymbol><ci id="A1.E38.m1.4.4.1.1.4.4.2.cmml" xref="A1.E38.m1.4.4.1.1.4.4.2">𝑓</ci><cn id="A1.E38.m1.4.4.1.1.4.4.3.cmml" type="integer" xref="A1.E38.m1.4.4.1.1.4.4.3">2</cn></apply><ci id="A1.E38.m1.1.1.cmml" xref="A1.E38.m1.1.1">𝐱</ci></apply><apply id="A1.E38.m1.4.4.1.1.1.cmml" xref="A1.E38.m1.4.4.1.1.1"><apply id="A1.E38.m1.4.4.1.1.1.2.cmml" xref="A1.E38.m1.4.4.1.1.1.2"><csymbol cd="ambiguous" id="A1.E38.m1.4.4.1.1.1.2.1.cmml" xref="A1.E38.m1.4.4.1.1.1.2">subscript</csymbol><sum id="A1.E38.m1.4.4.1.1.1.2.2.cmml" xref="A1.E38.m1.4.4.1.1.1.2.2"></sum><apply id="A1.E38.m1.4.4.1.1.1.2.3.cmml" xref="A1.E38.m1.4.4.1.1.1.2.3"><in id="A1.E38.m1.4.4.1.1.1.2.3.1.cmml" xref="A1.E38.m1.4.4.1.1.1.2.3.1"></in><ci id="A1.E38.m1.4.4.1.1.1.2.3.2.cmml" xref="A1.E38.m1.4.4.1.1.1.2.3.2">𝐱</ci><ci id="A1.E38.m1.4.4.1.1.1.2.3.3.cmml" xref="A1.E38.m1.4.4.1.1.1.2.3.3">𝒳</ci></apply></apply><apply id="A1.E38.m1.4.4.1.1.1.1.cmml" xref="A1.E38.m1.4.4.1.1.1.1"><times id="A1.E38.m1.4.4.1.1.1.1.2.cmml" xref="A1.E38.m1.4.4.1.1.1.1.2"></times><ci id="A1.E38.m1.4.4.1.1.1.1.3.cmml" xref="A1.E38.m1.4.4.1.1.1.1.3">𝑞</ci><ci id="A1.E38.m1.2.2.cmml" xref="A1.E38.m1.2.2">𝐱</ci><apply id="A1.E38.m1.4.4.1.1.1.1.1.cmml" xref="A1.E38.m1.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E38.m1.4.4.1.1.1.1.1.2.cmml" xref="A1.E38.m1.4.4.1.1.1.1.1">superscript</csymbol><apply id="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1"><apply id="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.1">subscript</csymbol><sum id="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.1.2.2"></sum><apply id="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.1.2.3"><eq id="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.1.2.3.1"></eq><ci id="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.1.2.3.2">𝑗</ci><cn id="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.1.3">𝐽</ci></apply><apply id="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2"><times id="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.1"></times><apply id="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.2.2">𝑤</ci><ci id="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.2.3">𝑗</ci></apply><apply id="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><cn id="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.3.2.cmml" type="integer" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.3.2">1</cn><apply id="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.3.3.1.cmml" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.3.3">subscript</csymbol><ci id="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.3.3.2.cmml" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.3.3.2">𝑋</ci><ci id="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.3.3.3.cmml" xref="A1.E38.m1.4.4.1.1.1.1.1.1.1.1.2.3.3.3">𝑗</ci></apply></apply><ci id="A1.E38.m1.3.3.cmml" xref="A1.E38.m1.3.3">𝐱</ci></apply></apply><cn id="A1.E38.m1.4.4.1.1.1.1.1.3.cmml" type="integer" xref="A1.E38.m1.4.4.1.1.1.1.1.3">2</cn></apply></apply></apply></apply><apply id="A1.E38.m1.4.4.1.1c.cmml" xref="A1.E38.m1.4.4.1"><eq id="A1.E38.m1.4.4.1.1.6.cmml" xref="A1.E38.m1.4.4.1.1.6"></eq><share href="https://arxiv.org/html/2410.03535v1#A1.E38.m1.4.4.1.1.1.cmml" id="A1.E38.m1.4.4.1.1d.cmml" xref="A1.E38.m1.4.4.1"></share><apply id="A1.E38.m1.4.4.1.1.2.cmml" xref="A1.E38.m1.4.4.1.1.2"><apply id="A1.E38.m1.4.4.1.1.2.2.cmml" xref="A1.E38.m1.4.4.1.1.2.2"><csymbol cd="ambiguous" id="A1.E38.m1.4.4.1.1.2.2.1.cmml" xref="A1.E38.m1.4.4.1.1.2.2">superscript</csymbol><apply id="A1.E38.m1.4.4.1.1.2.2.2.cmml" xref="A1.E38.m1.4.4.1.1.2.2"><csymbol cd="ambiguous" id="A1.E38.m1.4.4.1.1.2.2.2.1.cmml" xref="A1.E38.m1.4.4.1.1.2.2">subscript</csymbol><sum id="A1.E38.m1.4.4.1.1.2.2.2.2.cmml" xref="A1.E38.m1.4.4.1.1.2.2.2.2"></sum><apply id="A1.E38.m1.4.4.1.1.2.2.2.3.cmml" xref="A1.E38.m1.4.4.1.1.2.2.2.3"><eq id="A1.E38.m1.4.4.1.1.2.2.2.3.1.cmml" xref="A1.E38.m1.4.4.1.1.2.2.2.3.1"></eq><ci id="A1.E38.m1.4.4.1.1.2.2.2.3.2.cmml" xref="A1.E38.m1.4.4.1.1.2.2.2.3.2">𝑗</ci><cn id="A1.E38.m1.4.4.1.1.2.2.2.3.3.cmml" type="integer" xref="A1.E38.m1.4.4.1.1.2.2.2.3.3">1</cn></apply></apply><ci id="A1.E38.m1.4.4.1.1.2.2.3.cmml" xref="A1.E38.m1.4.4.1.1.2.2.3">𝐽</ci></apply><apply id="A1.E38.m1.4.4.1.1.2.1.cmml" xref="A1.E38.m1.4.4.1.1.2.1"><times id="A1.E38.m1.4.4.1.1.2.1.2.cmml" xref="A1.E38.m1.4.4.1.1.2.1.2"></times><apply id="A1.E38.m1.4.4.1.1.2.1.3.cmml" xref="A1.E38.m1.4.4.1.1.2.1.3"><csymbol cd="ambiguous" id="A1.E38.m1.4.4.1.1.2.1.3.1.cmml" xref="A1.E38.m1.4.4.1.1.2.1.3">superscript</csymbol><apply id="A1.E38.m1.4.4.1.1.2.1.3.2.cmml" xref="A1.E38.m1.4.4.1.1.2.1.3"><csymbol cd="ambiguous" id="A1.E38.m1.4.4.1.1.2.1.3.2.1.cmml" xref="A1.E38.m1.4.4.1.1.2.1.3">subscript</csymbol><ci id="A1.E38.m1.4.4.1.1.2.1.3.2.2.cmml" xref="A1.E38.m1.4.4.1.1.2.1.3.2.2">𝑤</ci><ci id="A1.E38.m1.4.4.1.1.2.1.3.2.3.cmml" xref="A1.E38.m1.4.4.1.1.2.1.3.2.3">𝑗</ci></apply><cn id="A1.E38.m1.4.4.1.1.2.1.3.3.cmml" type="integer" xref="A1.E38.m1.4.4.1.1.2.1.3.3">2</cn></apply><ci id="A1.E38.m1.4.4.1.1.2.1.4.cmml" xref="A1.E38.m1.4.4.1.1.2.1.4">𝑄</ci><apply id="A1.E38.m1.4.4.1.1.2.1.1.1.1.cmml" xref="A1.E38.m1.4.4.1.1.2.1.1.1"><csymbol cd="ambiguous" id="A1.E38.m1.4.4.1.1.2.1.1.1.1.1.cmml" xref="A1.E38.m1.4.4.1.1.2.1.1.1">subscript</csymbol><ci id="A1.E38.m1.4.4.1.1.2.1.1.1.1.2.cmml" xref="A1.E38.m1.4.4.1.1.2.1.1.1.1.2">𝑋</ci><ci id="A1.E38.m1.4.4.1.1.2.1.1.1.1.3.cmml" xref="A1.E38.m1.4.4.1.1.2.1.1.1.1.3">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E38.m1.4c">\displaystyle\mathbb{E}_{\mathbf{x}\sim q}\delta f^{2}(\mathbf{x})=\sum_{%
\mathbf{x}\in\mathcal{X}}q(\mathbf{x})\left(\sum_{j=1}^{J}w_{j}\mathbf{1}_{X_{%
j}}(\mathbf{x})\right)^{2}=\sum_{j=1}^{J}w_{j}^{2}Q(X_{j})\,.</annotation><annotation encoding="application/x-llamapun" id="A1.E38.m1.4d">blackboard_E start_POSTSUBSCRIPT bold_x ∼ italic_q end_POSTSUBSCRIPT italic_δ italic_f start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ( bold_x ) = ∑ start_POSTSUBSCRIPT bold_x ∈ caligraphic_X end_POSTSUBSCRIPT italic_q ( bold_x ) ( ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_J end_POSTSUPERSCRIPT italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT bold_1 start_POSTSUBSCRIPT italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_x ) ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT = ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_J end_POSTSUPERSCRIPT italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_Q ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(38)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS1.p1.4">In fact, we can extend this to any ordinary function of <math alttext="\delta f" class="ltx_Math" display="inline" id="A1.SS1.p1.4.m1.1"><semantics id="A1.SS1.p1.4.m1.1a"><mrow id="A1.SS1.p1.4.m1.1.1" xref="A1.SS1.p1.4.m1.1.1.cmml"><mi id="A1.SS1.p1.4.m1.1.1.2" xref="A1.SS1.p1.4.m1.1.1.2.cmml">δ</mi><mo id="A1.SS1.p1.4.m1.1.1.1" xref="A1.SS1.p1.4.m1.1.1.1.cmml">⁢</mo><mi id="A1.SS1.p1.4.m1.1.1.3" xref="A1.SS1.p1.4.m1.1.1.3.cmml">f</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.4.m1.1b"><apply id="A1.SS1.p1.4.m1.1.1.cmml" xref="A1.SS1.p1.4.m1.1.1"><times id="A1.SS1.p1.4.m1.1.1.1.cmml" xref="A1.SS1.p1.4.m1.1.1.1"></times><ci id="A1.SS1.p1.4.m1.1.1.2.cmml" xref="A1.SS1.p1.4.m1.1.1.2">𝛿</ci><ci id="A1.SS1.p1.4.m1.1.1.3.cmml" xref="A1.SS1.p1.4.m1.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.4.m1.1c">\delta f</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.4.m1.1d">italic_δ italic_f</annotation></semantics></math>:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A5.EGx8">
<tbody id="A1.E39"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbb{E}_{\mathbf{x}\sim q}\,g\left(\delta f(\mathbf{x})\right)" class="ltx_Math" display="inline" id="A1.E39.m1.2"><semantics id="A1.E39.m1.2a"><mrow id="A1.E39.m1.2.2" xref="A1.E39.m1.2.2.cmml"><msub id="A1.E39.m1.2.2.3" xref="A1.E39.m1.2.2.3.cmml"><mi id="A1.E39.m1.2.2.3.2" xref="A1.E39.m1.2.2.3.2.cmml">𝔼</mi><mrow id="A1.E39.m1.2.2.3.3" xref="A1.E39.m1.2.2.3.3.cmml"><mi id="A1.E39.m1.2.2.3.3.2" xref="A1.E39.m1.2.2.3.3.2.cmml">𝐱</mi><mo id="A1.E39.m1.2.2.3.3.1" xref="A1.E39.m1.2.2.3.3.1.cmml">∼</mo><mi id="A1.E39.m1.2.2.3.3.3" xref="A1.E39.m1.2.2.3.3.3.cmml">q</mi></mrow></msub><mo id="A1.E39.m1.2.2.2" lspace="0.170em" xref="A1.E39.m1.2.2.2.cmml">⁢</mo><mi id="A1.E39.m1.2.2.4" xref="A1.E39.m1.2.2.4.cmml">g</mi><mo id="A1.E39.m1.2.2.2a" xref="A1.E39.m1.2.2.2.cmml">⁢</mo><mrow id="A1.E39.m1.2.2.1.1" xref="A1.E39.m1.2.2.1.1.1.cmml"><mo id="A1.E39.m1.2.2.1.1.2" xref="A1.E39.m1.2.2.1.1.1.cmml">(</mo><mrow id="A1.E39.m1.2.2.1.1.1" xref="A1.E39.m1.2.2.1.1.1.cmml"><mi id="A1.E39.m1.2.2.1.1.1.2" xref="A1.E39.m1.2.2.1.1.1.2.cmml">δ</mi><mo id="A1.E39.m1.2.2.1.1.1.1" xref="A1.E39.m1.2.2.1.1.1.1.cmml">⁢</mo><mi id="A1.E39.m1.2.2.1.1.1.3" xref="A1.E39.m1.2.2.1.1.1.3.cmml">f</mi><mo id="A1.E39.m1.2.2.1.1.1.1a" xref="A1.E39.m1.2.2.1.1.1.1.cmml">⁢</mo><mrow id="A1.E39.m1.2.2.1.1.1.4.2" xref="A1.E39.m1.2.2.1.1.1.cmml"><mo id="A1.E39.m1.2.2.1.1.1.4.2.1" stretchy="false" xref="A1.E39.m1.2.2.1.1.1.cmml">(</mo><mi id="A1.E39.m1.1.1" xref="A1.E39.m1.1.1.cmml">𝐱</mi><mo id="A1.E39.m1.2.2.1.1.1.4.2.2" stretchy="false" xref="A1.E39.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E39.m1.2.2.1.1.3" xref="A1.E39.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E39.m1.2b"><apply id="A1.E39.m1.2.2.cmml" xref="A1.E39.m1.2.2"><times id="A1.E39.m1.2.2.2.cmml" xref="A1.E39.m1.2.2.2"></times><apply id="A1.E39.m1.2.2.3.cmml" xref="A1.E39.m1.2.2.3"><csymbol cd="ambiguous" id="A1.E39.m1.2.2.3.1.cmml" xref="A1.E39.m1.2.2.3">subscript</csymbol><ci id="A1.E39.m1.2.2.3.2.cmml" xref="A1.E39.m1.2.2.3.2">𝔼</ci><apply id="A1.E39.m1.2.2.3.3.cmml" xref="A1.E39.m1.2.2.3.3"><csymbol cd="latexml" id="A1.E39.m1.2.2.3.3.1.cmml" xref="A1.E39.m1.2.2.3.3.1">similar-to</csymbol><ci id="A1.E39.m1.2.2.3.3.2.cmml" xref="A1.E39.m1.2.2.3.3.2">𝐱</ci><ci id="A1.E39.m1.2.2.3.3.3.cmml" xref="A1.E39.m1.2.2.3.3.3">𝑞</ci></apply></apply><ci id="A1.E39.m1.2.2.4.cmml" xref="A1.E39.m1.2.2.4">𝑔</ci><apply id="A1.E39.m1.2.2.1.1.1.cmml" xref="A1.E39.m1.2.2.1.1"><times id="A1.E39.m1.2.2.1.1.1.1.cmml" xref="A1.E39.m1.2.2.1.1.1.1"></times><ci id="A1.E39.m1.2.2.1.1.1.2.cmml" xref="A1.E39.m1.2.2.1.1.1.2">𝛿</ci><ci id="A1.E39.m1.2.2.1.1.1.3.cmml" xref="A1.E39.m1.2.2.1.1.1.3">𝑓</ci><ci id="A1.E39.m1.1.1.cmml" xref="A1.E39.m1.1.1">𝐱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E39.m1.2c">\displaystyle\mathbb{E}_{\mathbf{x}\sim q}\,g\left(\delta f(\mathbf{x})\right)</annotation><annotation encoding="application/x-llamapun" id="A1.E39.m1.2d">blackboard_E start_POSTSUBSCRIPT bold_x ∼ italic_q end_POSTSUBSCRIPT italic_g ( italic_δ italic_f ( bold_x ) )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sum_{\mathbf{x}\in\mathcal{X}}q(\mathbf{x})\sum_{j=1}^{J}%
\mathbf{1}_{X_{j}}(\mathbf{x})g\left(\delta f(\mathbf{x})\right)" class="ltx_Math" display="inline" id="A1.E39.m2.4"><semantics id="A1.E39.m2.4a"><mrow id="A1.E39.m2.4.4" xref="A1.E39.m2.4.4.cmml"><mi id="A1.E39.m2.4.4.3" xref="A1.E39.m2.4.4.3.cmml"></mi><mo id="A1.E39.m2.4.4.2" xref="A1.E39.m2.4.4.2.cmml">=</mo><mrow id="A1.E39.m2.4.4.1" xref="A1.E39.m2.4.4.1.cmml"><mstyle displaystyle="true" id="A1.E39.m2.4.4.1.2" xref="A1.E39.m2.4.4.1.2.cmml"><munder id="A1.E39.m2.4.4.1.2a" xref="A1.E39.m2.4.4.1.2.cmml"><mo id="A1.E39.m2.4.4.1.2.2" movablelimits="false" xref="A1.E39.m2.4.4.1.2.2.cmml">∑</mo><mrow id="A1.E39.m2.4.4.1.2.3" xref="A1.E39.m2.4.4.1.2.3.cmml"><mi id="A1.E39.m2.4.4.1.2.3.2" xref="A1.E39.m2.4.4.1.2.3.2.cmml">𝐱</mi><mo id="A1.E39.m2.4.4.1.2.3.1" xref="A1.E39.m2.4.4.1.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="A1.E39.m2.4.4.1.2.3.3" xref="A1.E39.m2.4.4.1.2.3.3.cmml">𝒳</mi></mrow></munder></mstyle><mrow id="A1.E39.m2.4.4.1.1" xref="A1.E39.m2.4.4.1.1.cmml"><mi id="A1.E39.m2.4.4.1.1.3" xref="A1.E39.m2.4.4.1.1.3.cmml">q</mi><mo id="A1.E39.m2.4.4.1.1.2" xref="A1.E39.m2.4.4.1.1.2.cmml">⁢</mo><mrow id="A1.E39.m2.4.4.1.1.4.2" xref="A1.E39.m2.4.4.1.1.cmml"><mo id="A1.E39.m2.4.4.1.1.4.2.1" stretchy="false" xref="A1.E39.m2.4.4.1.1.cmml">(</mo><mi id="A1.E39.m2.1.1" xref="A1.E39.m2.1.1.cmml">𝐱</mi><mo id="A1.E39.m2.4.4.1.1.4.2.2" stretchy="false" xref="A1.E39.m2.4.4.1.1.cmml">)</mo></mrow><mo id="A1.E39.m2.4.4.1.1.2a" xref="A1.E39.m2.4.4.1.1.2.cmml">⁢</mo><mrow id="A1.E39.m2.4.4.1.1.1" xref="A1.E39.m2.4.4.1.1.1.cmml"><mstyle displaystyle="true" id="A1.E39.m2.4.4.1.1.1.2" xref="A1.E39.m2.4.4.1.1.1.2.cmml"><munderover id="A1.E39.m2.4.4.1.1.1.2a" xref="A1.E39.m2.4.4.1.1.1.2.cmml"><mo id="A1.E39.m2.4.4.1.1.1.2.2.2" movablelimits="false" xref="A1.E39.m2.4.4.1.1.1.2.2.2.cmml">∑</mo><mrow id="A1.E39.m2.4.4.1.1.1.2.2.3" xref="A1.E39.m2.4.4.1.1.1.2.2.3.cmml"><mi id="A1.E39.m2.4.4.1.1.1.2.2.3.2" xref="A1.E39.m2.4.4.1.1.1.2.2.3.2.cmml">j</mi><mo id="A1.E39.m2.4.4.1.1.1.2.2.3.1" xref="A1.E39.m2.4.4.1.1.1.2.2.3.1.cmml">=</mo><mn id="A1.E39.m2.4.4.1.1.1.2.2.3.3" xref="A1.E39.m2.4.4.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="A1.E39.m2.4.4.1.1.1.2.3" xref="A1.E39.m2.4.4.1.1.1.2.3.cmml">J</mi></munderover></mstyle><mrow id="A1.E39.m2.4.4.1.1.1.1" xref="A1.E39.m2.4.4.1.1.1.1.cmml"><msub id="A1.E39.m2.4.4.1.1.1.1.3" xref="A1.E39.m2.4.4.1.1.1.1.3.cmml"><mn id="A1.E39.m2.4.4.1.1.1.1.3.2" xref="A1.E39.m2.4.4.1.1.1.1.3.2.cmml">𝟏</mn><msub id="A1.E39.m2.4.4.1.1.1.1.3.3" xref="A1.E39.m2.4.4.1.1.1.1.3.3.cmml"><mi id="A1.E39.m2.4.4.1.1.1.1.3.3.2" xref="A1.E39.m2.4.4.1.1.1.1.3.3.2.cmml">X</mi><mi id="A1.E39.m2.4.4.1.1.1.1.3.3.3" xref="A1.E39.m2.4.4.1.1.1.1.3.3.3.cmml">j</mi></msub></msub><mo id="A1.E39.m2.4.4.1.1.1.1.2" xref="A1.E39.m2.4.4.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E39.m2.4.4.1.1.1.1.4.2" xref="A1.E39.m2.4.4.1.1.1.1.cmml"><mo id="A1.E39.m2.4.4.1.1.1.1.4.2.1" stretchy="false" xref="A1.E39.m2.4.4.1.1.1.1.cmml">(</mo><mi id="A1.E39.m2.2.2" xref="A1.E39.m2.2.2.cmml">𝐱</mi><mo id="A1.E39.m2.4.4.1.1.1.1.4.2.2" stretchy="false" xref="A1.E39.m2.4.4.1.1.1.1.cmml">)</mo></mrow><mo id="A1.E39.m2.4.4.1.1.1.1.2a" xref="A1.E39.m2.4.4.1.1.1.1.2.cmml">⁢</mo><mi id="A1.E39.m2.4.4.1.1.1.1.5" xref="A1.E39.m2.4.4.1.1.1.1.5.cmml">g</mi><mo id="A1.E39.m2.4.4.1.1.1.1.2b" xref="A1.E39.m2.4.4.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E39.m2.4.4.1.1.1.1.1.1" xref="A1.E39.m2.4.4.1.1.1.1.1.1.1.cmml"><mo id="A1.E39.m2.4.4.1.1.1.1.1.1.2" xref="A1.E39.m2.4.4.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E39.m2.4.4.1.1.1.1.1.1.1" xref="A1.E39.m2.4.4.1.1.1.1.1.1.1.cmml"><mi id="A1.E39.m2.4.4.1.1.1.1.1.1.1.2" xref="A1.E39.m2.4.4.1.1.1.1.1.1.1.2.cmml">δ</mi><mo id="A1.E39.m2.4.4.1.1.1.1.1.1.1.1" xref="A1.E39.m2.4.4.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.E39.m2.4.4.1.1.1.1.1.1.1.3" xref="A1.E39.m2.4.4.1.1.1.1.1.1.1.3.cmml">f</mi><mo id="A1.E39.m2.4.4.1.1.1.1.1.1.1.1a" xref="A1.E39.m2.4.4.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="A1.E39.m2.4.4.1.1.1.1.1.1.1.4.2" xref="A1.E39.m2.4.4.1.1.1.1.1.1.1.cmml"><mo id="A1.E39.m2.4.4.1.1.1.1.1.1.1.4.2.1" stretchy="false" xref="A1.E39.m2.4.4.1.1.1.1.1.1.1.cmml">(</mo><mi id="A1.E39.m2.3.3" xref="A1.E39.m2.3.3.cmml">𝐱</mi><mo id="A1.E39.m2.4.4.1.1.1.1.1.1.1.4.2.2" stretchy="false" xref="A1.E39.m2.4.4.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E39.m2.4.4.1.1.1.1.1.1.3" xref="A1.E39.m2.4.4.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E39.m2.4b"><apply id="A1.E39.m2.4.4.cmml" xref="A1.E39.m2.4.4"><eq id="A1.E39.m2.4.4.2.cmml" xref="A1.E39.m2.4.4.2"></eq><csymbol cd="latexml" id="A1.E39.m2.4.4.3.cmml" xref="A1.E39.m2.4.4.3">absent</csymbol><apply id="A1.E39.m2.4.4.1.cmml" xref="A1.E39.m2.4.4.1"><apply id="A1.E39.m2.4.4.1.2.cmml" xref="A1.E39.m2.4.4.1.2"><csymbol cd="ambiguous" id="A1.E39.m2.4.4.1.2.1.cmml" xref="A1.E39.m2.4.4.1.2">subscript</csymbol><sum id="A1.E39.m2.4.4.1.2.2.cmml" xref="A1.E39.m2.4.4.1.2.2"></sum><apply id="A1.E39.m2.4.4.1.2.3.cmml" xref="A1.E39.m2.4.4.1.2.3"><in id="A1.E39.m2.4.4.1.2.3.1.cmml" xref="A1.E39.m2.4.4.1.2.3.1"></in><ci id="A1.E39.m2.4.4.1.2.3.2.cmml" xref="A1.E39.m2.4.4.1.2.3.2">𝐱</ci><ci id="A1.E39.m2.4.4.1.2.3.3.cmml" xref="A1.E39.m2.4.4.1.2.3.3">𝒳</ci></apply></apply><apply id="A1.E39.m2.4.4.1.1.cmml" xref="A1.E39.m2.4.4.1.1"><times id="A1.E39.m2.4.4.1.1.2.cmml" xref="A1.E39.m2.4.4.1.1.2"></times><ci id="A1.E39.m2.4.4.1.1.3.cmml" xref="A1.E39.m2.4.4.1.1.3">𝑞</ci><ci id="A1.E39.m2.1.1.cmml" xref="A1.E39.m2.1.1">𝐱</ci><apply id="A1.E39.m2.4.4.1.1.1.cmml" xref="A1.E39.m2.4.4.1.1.1"><apply id="A1.E39.m2.4.4.1.1.1.2.cmml" xref="A1.E39.m2.4.4.1.1.1.2"><csymbol cd="ambiguous" id="A1.E39.m2.4.4.1.1.1.2.1.cmml" xref="A1.E39.m2.4.4.1.1.1.2">superscript</csymbol><apply id="A1.E39.m2.4.4.1.1.1.2.2.cmml" xref="A1.E39.m2.4.4.1.1.1.2"><csymbol cd="ambiguous" id="A1.E39.m2.4.4.1.1.1.2.2.1.cmml" xref="A1.E39.m2.4.4.1.1.1.2">subscript</csymbol><sum id="A1.E39.m2.4.4.1.1.1.2.2.2.cmml" xref="A1.E39.m2.4.4.1.1.1.2.2.2"></sum><apply id="A1.E39.m2.4.4.1.1.1.2.2.3.cmml" xref="A1.E39.m2.4.4.1.1.1.2.2.3"><eq id="A1.E39.m2.4.4.1.1.1.2.2.3.1.cmml" xref="A1.E39.m2.4.4.1.1.1.2.2.3.1"></eq><ci id="A1.E39.m2.4.4.1.1.1.2.2.3.2.cmml" xref="A1.E39.m2.4.4.1.1.1.2.2.3.2">𝑗</ci><cn id="A1.E39.m2.4.4.1.1.1.2.2.3.3.cmml" type="integer" xref="A1.E39.m2.4.4.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="A1.E39.m2.4.4.1.1.1.2.3.cmml" xref="A1.E39.m2.4.4.1.1.1.2.3">𝐽</ci></apply><apply id="A1.E39.m2.4.4.1.1.1.1.cmml" xref="A1.E39.m2.4.4.1.1.1.1"><times id="A1.E39.m2.4.4.1.1.1.1.2.cmml" xref="A1.E39.m2.4.4.1.1.1.1.2"></times><apply id="A1.E39.m2.4.4.1.1.1.1.3.cmml" xref="A1.E39.m2.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E39.m2.4.4.1.1.1.1.3.1.cmml" xref="A1.E39.m2.4.4.1.1.1.1.3">subscript</csymbol><cn id="A1.E39.m2.4.4.1.1.1.1.3.2.cmml" type="integer" xref="A1.E39.m2.4.4.1.1.1.1.3.2">1</cn><apply id="A1.E39.m2.4.4.1.1.1.1.3.3.cmml" xref="A1.E39.m2.4.4.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.E39.m2.4.4.1.1.1.1.3.3.1.cmml" xref="A1.E39.m2.4.4.1.1.1.1.3.3">subscript</csymbol><ci id="A1.E39.m2.4.4.1.1.1.1.3.3.2.cmml" xref="A1.E39.m2.4.4.1.1.1.1.3.3.2">𝑋</ci><ci id="A1.E39.m2.4.4.1.1.1.1.3.3.3.cmml" xref="A1.E39.m2.4.4.1.1.1.1.3.3.3">𝑗</ci></apply></apply><ci id="A1.E39.m2.2.2.cmml" xref="A1.E39.m2.2.2">𝐱</ci><ci id="A1.E39.m2.4.4.1.1.1.1.5.cmml" xref="A1.E39.m2.4.4.1.1.1.1.5">𝑔</ci><apply id="A1.E39.m2.4.4.1.1.1.1.1.1.1.cmml" xref="A1.E39.m2.4.4.1.1.1.1.1.1"><times id="A1.E39.m2.4.4.1.1.1.1.1.1.1.1.cmml" xref="A1.E39.m2.4.4.1.1.1.1.1.1.1.1"></times><ci id="A1.E39.m2.4.4.1.1.1.1.1.1.1.2.cmml" xref="A1.E39.m2.4.4.1.1.1.1.1.1.1.2">𝛿</ci><ci id="A1.E39.m2.4.4.1.1.1.1.1.1.1.3.cmml" xref="A1.E39.m2.4.4.1.1.1.1.1.1.1.3">𝑓</ci><ci id="A1.E39.m2.3.3.cmml" xref="A1.E39.m2.3.3">𝐱</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E39.m2.4c">\displaystyle=\sum_{\mathbf{x}\in\mathcal{X}}q(\mathbf{x})\sum_{j=1}^{J}%
\mathbf{1}_{X_{j}}(\mathbf{x})g\left(\delta f(\mathbf{x})\right)</annotation><annotation encoding="application/x-llamapun" id="A1.E39.m2.4d">= ∑ start_POSTSUBSCRIPT bold_x ∈ caligraphic_X end_POSTSUBSCRIPT italic_q ( bold_x ) ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_J end_POSTSUPERSCRIPT bold_1 start_POSTSUBSCRIPT italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_x ) italic_g ( italic_δ italic_f ( bold_x ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(39)</span></td>
</tr></tbody>
<tbody id="A1.E40"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sum_{j=1}^{J}\sum_{\mathbf{x}\in X_{j}}q(\mathbf{x})g(w_{j})" class="ltx_Math" display="inline" id="A1.E40.m1.2"><semantics id="A1.E40.m1.2a"><mrow id="A1.E40.m1.2.2" xref="A1.E40.m1.2.2.cmml"><mi id="A1.E40.m1.2.2.3" xref="A1.E40.m1.2.2.3.cmml"></mi><mo id="A1.E40.m1.2.2.2" xref="A1.E40.m1.2.2.2.cmml">=</mo><mrow id="A1.E40.m1.2.2.1" xref="A1.E40.m1.2.2.1.cmml"><mstyle displaystyle="true" id="A1.E40.m1.2.2.1.2" xref="A1.E40.m1.2.2.1.2.cmml"><munderover id="A1.E40.m1.2.2.1.2a" xref="A1.E40.m1.2.2.1.2.cmml"><mo id="A1.E40.m1.2.2.1.2.2.2" movablelimits="false" xref="A1.E40.m1.2.2.1.2.2.2.cmml">∑</mo><mrow id="A1.E40.m1.2.2.1.2.2.3" xref="A1.E40.m1.2.2.1.2.2.3.cmml"><mi id="A1.E40.m1.2.2.1.2.2.3.2" xref="A1.E40.m1.2.2.1.2.2.3.2.cmml">j</mi><mo id="A1.E40.m1.2.2.1.2.2.3.1" xref="A1.E40.m1.2.2.1.2.2.3.1.cmml">=</mo><mn id="A1.E40.m1.2.2.1.2.2.3.3" xref="A1.E40.m1.2.2.1.2.2.3.3.cmml">1</mn></mrow><mi id="A1.E40.m1.2.2.1.2.3" xref="A1.E40.m1.2.2.1.2.3.cmml">J</mi></munderover></mstyle><mrow id="A1.E40.m1.2.2.1.1" xref="A1.E40.m1.2.2.1.1.cmml"><mstyle displaystyle="true" id="A1.E40.m1.2.2.1.1.2" xref="A1.E40.m1.2.2.1.1.2.cmml"><munder id="A1.E40.m1.2.2.1.1.2a" xref="A1.E40.m1.2.2.1.1.2.cmml"><mo id="A1.E40.m1.2.2.1.1.2.2" movablelimits="false" xref="A1.E40.m1.2.2.1.1.2.2.cmml">∑</mo><mrow id="A1.E40.m1.2.2.1.1.2.3" xref="A1.E40.m1.2.2.1.1.2.3.cmml"><mi id="A1.E40.m1.2.2.1.1.2.3.2" xref="A1.E40.m1.2.2.1.1.2.3.2.cmml">𝐱</mi><mo id="A1.E40.m1.2.2.1.1.2.3.1" xref="A1.E40.m1.2.2.1.1.2.3.1.cmml">∈</mo><msub id="A1.E40.m1.2.2.1.1.2.3.3" xref="A1.E40.m1.2.2.1.1.2.3.3.cmml"><mi id="A1.E40.m1.2.2.1.1.2.3.3.2" xref="A1.E40.m1.2.2.1.1.2.3.3.2.cmml">X</mi><mi id="A1.E40.m1.2.2.1.1.2.3.3.3" xref="A1.E40.m1.2.2.1.1.2.3.3.3.cmml">j</mi></msub></mrow></munder></mstyle><mrow id="A1.E40.m1.2.2.1.1.1" xref="A1.E40.m1.2.2.1.1.1.cmml"><mi id="A1.E40.m1.2.2.1.1.1.3" xref="A1.E40.m1.2.2.1.1.1.3.cmml">q</mi><mo id="A1.E40.m1.2.2.1.1.1.2" xref="A1.E40.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="A1.E40.m1.2.2.1.1.1.4.2" xref="A1.E40.m1.2.2.1.1.1.cmml"><mo id="A1.E40.m1.2.2.1.1.1.4.2.1" stretchy="false" xref="A1.E40.m1.2.2.1.1.1.cmml">(</mo><mi id="A1.E40.m1.1.1" xref="A1.E40.m1.1.1.cmml">𝐱</mi><mo id="A1.E40.m1.2.2.1.1.1.4.2.2" stretchy="false" xref="A1.E40.m1.2.2.1.1.1.cmml">)</mo></mrow><mo id="A1.E40.m1.2.2.1.1.1.2a" xref="A1.E40.m1.2.2.1.1.1.2.cmml">⁢</mo><mi id="A1.E40.m1.2.2.1.1.1.5" xref="A1.E40.m1.2.2.1.1.1.5.cmml">g</mi><mo id="A1.E40.m1.2.2.1.1.1.2b" xref="A1.E40.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="A1.E40.m1.2.2.1.1.1.1.1" xref="A1.E40.m1.2.2.1.1.1.1.1.1.cmml"><mo id="A1.E40.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="A1.E40.m1.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="A1.E40.m1.2.2.1.1.1.1.1.1" xref="A1.E40.m1.2.2.1.1.1.1.1.1.cmml"><mi id="A1.E40.m1.2.2.1.1.1.1.1.1.2" xref="A1.E40.m1.2.2.1.1.1.1.1.1.2.cmml">w</mi><mi id="A1.E40.m1.2.2.1.1.1.1.1.1.3" xref="A1.E40.m1.2.2.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="A1.E40.m1.2.2.1.1.1.1.1.3" stretchy="false" xref="A1.E40.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E40.m1.2b"><apply id="A1.E40.m1.2.2.cmml" xref="A1.E40.m1.2.2"><eq id="A1.E40.m1.2.2.2.cmml" xref="A1.E40.m1.2.2.2"></eq><csymbol cd="latexml" id="A1.E40.m1.2.2.3.cmml" xref="A1.E40.m1.2.2.3">absent</csymbol><apply id="A1.E40.m1.2.2.1.cmml" xref="A1.E40.m1.2.2.1"><apply id="A1.E40.m1.2.2.1.2.cmml" xref="A1.E40.m1.2.2.1.2"><csymbol cd="ambiguous" id="A1.E40.m1.2.2.1.2.1.cmml" xref="A1.E40.m1.2.2.1.2">superscript</csymbol><apply id="A1.E40.m1.2.2.1.2.2.cmml" xref="A1.E40.m1.2.2.1.2"><csymbol cd="ambiguous" id="A1.E40.m1.2.2.1.2.2.1.cmml" xref="A1.E40.m1.2.2.1.2">subscript</csymbol><sum id="A1.E40.m1.2.2.1.2.2.2.cmml" xref="A1.E40.m1.2.2.1.2.2.2"></sum><apply id="A1.E40.m1.2.2.1.2.2.3.cmml" xref="A1.E40.m1.2.2.1.2.2.3"><eq id="A1.E40.m1.2.2.1.2.2.3.1.cmml" xref="A1.E40.m1.2.2.1.2.2.3.1"></eq><ci id="A1.E40.m1.2.2.1.2.2.3.2.cmml" xref="A1.E40.m1.2.2.1.2.2.3.2">𝑗</ci><cn id="A1.E40.m1.2.2.1.2.2.3.3.cmml" type="integer" xref="A1.E40.m1.2.2.1.2.2.3.3">1</cn></apply></apply><ci id="A1.E40.m1.2.2.1.2.3.cmml" xref="A1.E40.m1.2.2.1.2.3">𝐽</ci></apply><apply id="A1.E40.m1.2.2.1.1.cmml" xref="A1.E40.m1.2.2.1.1"><apply id="A1.E40.m1.2.2.1.1.2.cmml" xref="A1.E40.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="A1.E40.m1.2.2.1.1.2.1.cmml" xref="A1.E40.m1.2.2.1.1.2">subscript</csymbol><sum id="A1.E40.m1.2.2.1.1.2.2.cmml" xref="A1.E40.m1.2.2.1.1.2.2"></sum><apply id="A1.E40.m1.2.2.1.1.2.3.cmml" xref="A1.E40.m1.2.2.1.1.2.3"><in id="A1.E40.m1.2.2.1.1.2.3.1.cmml" xref="A1.E40.m1.2.2.1.1.2.3.1"></in><ci id="A1.E40.m1.2.2.1.1.2.3.2.cmml" xref="A1.E40.m1.2.2.1.1.2.3.2">𝐱</ci><apply id="A1.E40.m1.2.2.1.1.2.3.3.cmml" xref="A1.E40.m1.2.2.1.1.2.3.3"><csymbol cd="ambiguous" id="A1.E40.m1.2.2.1.1.2.3.3.1.cmml" xref="A1.E40.m1.2.2.1.1.2.3.3">subscript</csymbol><ci id="A1.E40.m1.2.2.1.1.2.3.3.2.cmml" xref="A1.E40.m1.2.2.1.1.2.3.3.2">𝑋</ci><ci id="A1.E40.m1.2.2.1.1.2.3.3.3.cmml" xref="A1.E40.m1.2.2.1.1.2.3.3.3">𝑗</ci></apply></apply></apply><apply id="A1.E40.m1.2.2.1.1.1.cmml" xref="A1.E40.m1.2.2.1.1.1"><times id="A1.E40.m1.2.2.1.1.1.2.cmml" xref="A1.E40.m1.2.2.1.1.1.2"></times><ci id="A1.E40.m1.2.2.1.1.1.3.cmml" xref="A1.E40.m1.2.2.1.1.1.3">𝑞</ci><ci id="A1.E40.m1.1.1.cmml" xref="A1.E40.m1.1.1">𝐱</ci><ci id="A1.E40.m1.2.2.1.1.1.5.cmml" xref="A1.E40.m1.2.2.1.1.1.5">𝑔</ci><apply id="A1.E40.m1.2.2.1.1.1.1.1.1.cmml" xref="A1.E40.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E40.m1.2.2.1.1.1.1.1.1.1.cmml" xref="A1.E40.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="A1.E40.m1.2.2.1.1.1.1.1.1.2.cmml" xref="A1.E40.m1.2.2.1.1.1.1.1.1.2">𝑤</ci><ci id="A1.E40.m1.2.2.1.1.1.1.1.1.3.cmml" xref="A1.E40.m1.2.2.1.1.1.1.1.1.3">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E40.m1.2c">\displaystyle=\sum_{j=1}^{J}\sum_{\mathbf{x}\in X_{j}}q(\mathbf{x})g(w_{j})</annotation><annotation encoding="application/x-llamapun" id="A1.E40.m1.2d">= ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_J end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT bold_x ∈ italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_q ( bold_x ) italic_g ( italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(40)</span></td>
</tr></tbody>
<tbody id="A1.E41"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sum_{j=1}^{J}g(w_{j})Q(X_{j})\,," class="ltx_Math" display="inline" id="A1.E41.m1.1"><semantics id="A1.E41.m1.1a"><mrow id="A1.E41.m1.1.1.1" xref="A1.E41.m1.1.1.1.1.cmml"><mrow id="A1.E41.m1.1.1.1.1" xref="A1.E41.m1.1.1.1.1.cmml"><mi id="A1.E41.m1.1.1.1.1.4" xref="A1.E41.m1.1.1.1.1.4.cmml"></mi><mo id="A1.E41.m1.1.1.1.1.3" xref="A1.E41.m1.1.1.1.1.3.cmml">=</mo><mrow id="A1.E41.m1.1.1.1.1.2" xref="A1.E41.m1.1.1.1.1.2.cmml"><mstyle displaystyle="true" id="A1.E41.m1.1.1.1.1.2.3" xref="A1.E41.m1.1.1.1.1.2.3.cmml"><munderover id="A1.E41.m1.1.1.1.1.2.3a" xref="A1.E41.m1.1.1.1.1.2.3.cmml"><mo id="A1.E41.m1.1.1.1.1.2.3.2.2" movablelimits="false" xref="A1.E41.m1.1.1.1.1.2.3.2.2.cmml">∑</mo><mrow id="A1.E41.m1.1.1.1.1.2.3.2.3" xref="A1.E41.m1.1.1.1.1.2.3.2.3.cmml"><mi id="A1.E41.m1.1.1.1.1.2.3.2.3.2" xref="A1.E41.m1.1.1.1.1.2.3.2.3.2.cmml">j</mi><mo id="A1.E41.m1.1.1.1.1.2.3.2.3.1" xref="A1.E41.m1.1.1.1.1.2.3.2.3.1.cmml">=</mo><mn id="A1.E41.m1.1.1.1.1.2.3.2.3.3" xref="A1.E41.m1.1.1.1.1.2.3.2.3.3.cmml">1</mn></mrow><mi id="A1.E41.m1.1.1.1.1.2.3.3" xref="A1.E41.m1.1.1.1.1.2.3.3.cmml">J</mi></munderover></mstyle><mrow id="A1.E41.m1.1.1.1.1.2.2" xref="A1.E41.m1.1.1.1.1.2.2.cmml"><mi id="A1.E41.m1.1.1.1.1.2.2.4" xref="A1.E41.m1.1.1.1.1.2.2.4.cmml">g</mi><mo id="A1.E41.m1.1.1.1.1.2.2.3" xref="A1.E41.m1.1.1.1.1.2.2.3.cmml">⁢</mo><mrow id="A1.E41.m1.1.1.1.1.1.1.1.1" xref="A1.E41.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E41.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E41.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A1.E41.m1.1.1.1.1.1.1.1.1.1" xref="A1.E41.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E41.m1.1.1.1.1.1.1.1.1.1.2" xref="A1.E41.m1.1.1.1.1.1.1.1.1.1.2.cmml">w</mi><mi id="A1.E41.m1.1.1.1.1.1.1.1.1.1.3" xref="A1.E41.m1.1.1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="A1.E41.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E41.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A1.E41.m1.1.1.1.1.2.2.3a" xref="A1.E41.m1.1.1.1.1.2.2.3.cmml">⁢</mo><mi id="A1.E41.m1.1.1.1.1.2.2.5" xref="A1.E41.m1.1.1.1.1.2.2.5.cmml">Q</mi><mo id="A1.E41.m1.1.1.1.1.2.2.3b" xref="A1.E41.m1.1.1.1.1.2.2.3.cmml">⁢</mo><mrow id="A1.E41.m1.1.1.1.1.2.2.2.1" xref="A1.E41.m1.1.1.1.1.2.2.2.1.1.cmml"><mo id="A1.E41.m1.1.1.1.1.2.2.2.1.2" stretchy="false" xref="A1.E41.m1.1.1.1.1.2.2.2.1.1.cmml">(</mo><msub id="A1.E41.m1.1.1.1.1.2.2.2.1.1" xref="A1.E41.m1.1.1.1.1.2.2.2.1.1.cmml"><mi id="A1.E41.m1.1.1.1.1.2.2.2.1.1.2" xref="A1.E41.m1.1.1.1.1.2.2.2.1.1.2.cmml">X</mi><mi id="A1.E41.m1.1.1.1.1.2.2.2.1.1.3" xref="A1.E41.m1.1.1.1.1.2.2.2.1.1.3.cmml">j</mi></msub><mo id="A1.E41.m1.1.1.1.1.2.2.2.1.3" rspace="0.170em" stretchy="false" xref="A1.E41.m1.1.1.1.1.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A1.E41.m1.1.1.1.2" xref="A1.E41.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E41.m1.1b"><apply id="A1.E41.m1.1.1.1.1.cmml" xref="A1.E41.m1.1.1.1"><eq id="A1.E41.m1.1.1.1.1.3.cmml" xref="A1.E41.m1.1.1.1.1.3"></eq><csymbol cd="latexml" id="A1.E41.m1.1.1.1.1.4.cmml" xref="A1.E41.m1.1.1.1.1.4">absent</csymbol><apply id="A1.E41.m1.1.1.1.1.2.cmml" xref="A1.E41.m1.1.1.1.1.2"><apply id="A1.E41.m1.1.1.1.1.2.3.cmml" xref="A1.E41.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A1.E41.m1.1.1.1.1.2.3.1.cmml" xref="A1.E41.m1.1.1.1.1.2.3">superscript</csymbol><apply id="A1.E41.m1.1.1.1.1.2.3.2.cmml" xref="A1.E41.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A1.E41.m1.1.1.1.1.2.3.2.1.cmml" xref="A1.E41.m1.1.1.1.1.2.3">subscript</csymbol><sum id="A1.E41.m1.1.1.1.1.2.3.2.2.cmml" xref="A1.E41.m1.1.1.1.1.2.3.2.2"></sum><apply id="A1.E41.m1.1.1.1.1.2.3.2.3.cmml" xref="A1.E41.m1.1.1.1.1.2.3.2.3"><eq id="A1.E41.m1.1.1.1.1.2.3.2.3.1.cmml" xref="A1.E41.m1.1.1.1.1.2.3.2.3.1"></eq><ci id="A1.E41.m1.1.1.1.1.2.3.2.3.2.cmml" xref="A1.E41.m1.1.1.1.1.2.3.2.3.2">𝑗</ci><cn id="A1.E41.m1.1.1.1.1.2.3.2.3.3.cmml" type="integer" xref="A1.E41.m1.1.1.1.1.2.3.2.3.3">1</cn></apply></apply><ci id="A1.E41.m1.1.1.1.1.2.3.3.cmml" xref="A1.E41.m1.1.1.1.1.2.3.3">𝐽</ci></apply><apply id="A1.E41.m1.1.1.1.1.2.2.cmml" xref="A1.E41.m1.1.1.1.1.2.2"><times id="A1.E41.m1.1.1.1.1.2.2.3.cmml" xref="A1.E41.m1.1.1.1.1.2.2.3"></times><ci id="A1.E41.m1.1.1.1.1.2.2.4.cmml" xref="A1.E41.m1.1.1.1.1.2.2.4">𝑔</ci><apply id="A1.E41.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E41.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E41.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E41.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E41.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E41.m1.1.1.1.1.1.1.1.1.1.2">𝑤</ci><ci id="A1.E41.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E41.m1.1.1.1.1.1.1.1.1.1.3">𝑗</ci></apply><ci id="A1.E41.m1.1.1.1.1.2.2.5.cmml" xref="A1.E41.m1.1.1.1.1.2.2.5">𝑄</ci><apply id="A1.E41.m1.1.1.1.1.2.2.2.1.1.cmml" xref="A1.E41.m1.1.1.1.1.2.2.2.1"><csymbol cd="ambiguous" id="A1.E41.m1.1.1.1.1.2.2.2.1.1.1.cmml" xref="A1.E41.m1.1.1.1.1.2.2.2.1">subscript</csymbol><ci id="A1.E41.m1.1.1.1.1.2.2.2.1.1.2.cmml" xref="A1.E41.m1.1.1.1.1.2.2.2.1.1.2">𝑋</ci><ci id="A1.E41.m1.1.1.1.1.2.2.2.1.1.3.cmml" xref="A1.E41.m1.1.1.1.1.2.2.2.1.1.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E41.m1.1c">\displaystyle=\sum_{j=1}^{J}g(w_{j})Q(X_{j})\,,</annotation><annotation encoding="application/x-llamapun" id="A1.E41.m1.1d">= ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_J end_POSTSUPERSCRIPT italic_g ( italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) italic_Q ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(41)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS1.p1.5">where we made use of the fact that the <math alttext="\mathbf{1}_{X_{j}}" class="ltx_Math" display="inline" id="A1.SS1.p1.5.m1.1"><semantics id="A1.SS1.p1.5.m1.1a"><msub id="A1.SS1.p1.5.m1.1.1" xref="A1.SS1.p1.5.m1.1.1.cmml"><mn id="A1.SS1.p1.5.m1.1.1.2" xref="A1.SS1.p1.5.m1.1.1.2.cmml">𝟏</mn><msub id="A1.SS1.p1.5.m1.1.1.3" xref="A1.SS1.p1.5.m1.1.1.3.cmml"><mi id="A1.SS1.p1.5.m1.1.1.3.2" xref="A1.SS1.p1.5.m1.1.1.3.2.cmml">X</mi><mi id="A1.SS1.p1.5.m1.1.1.3.3" xref="A1.SS1.p1.5.m1.1.1.3.3.cmml">j</mi></msub></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.5.m1.1b"><apply id="A1.SS1.p1.5.m1.1.1.cmml" xref="A1.SS1.p1.5.m1.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.5.m1.1.1.1.cmml" xref="A1.SS1.p1.5.m1.1.1">subscript</csymbol><cn id="A1.SS1.p1.5.m1.1.1.2.cmml" type="integer" xref="A1.SS1.p1.5.m1.1.1.2">1</cn><apply id="A1.SS1.p1.5.m1.1.1.3.cmml" xref="A1.SS1.p1.5.m1.1.1.3"><csymbol cd="ambiguous" id="A1.SS1.p1.5.m1.1.1.3.1.cmml" xref="A1.SS1.p1.5.m1.1.1.3">subscript</csymbol><ci id="A1.SS1.p1.5.m1.1.1.3.2.cmml" xref="A1.SS1.p1.5.m1.1.1.3.2">𝑋</ci><ci id="A1.SS1.p1.5.m1.1.1.3.3.cmml" xref="A1.SS1.p1.5.m1.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.5.m1.1c">\mathbf{1}_{X_{j}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.5.m1.1d">bold_1 start_POSTSUBSCRIPT italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> constitute a partition of unity:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A5.EGx9">
<tbody id="A1.E42"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle 1=\sum_{j=1}^{J}\mathbf{1}_{X_{j}}(\mathbf{x})\,." class="ltx_Math" display="inline" id="A1.E42.m1.2"><semantics id="A1.E42.m1.2a"><mrow id="A1.E42.m1.2.2.1" xref="A1.E42.m1.2.2.1.1.cmml"><mrow id="A1.E42.m1.2.2.1.1" xref="A1.E42.m1.2.2.1.1.cmml"><mn id="A1.E42.m1.2.2.1.1.2" xref="A1.E42.m1.2.2.1.1.2.cmml">1</mn><mo id="A1.E42.m1.2.2.1.1.1" xref="A1.E42.m1.2.2.1.1.1.cmml">=</mo><mrow id="A1.E42.m1.2.2.1.1.3" xref="A1.E42.m1.2.2.1.1.3.cmml"><mstyle displaystyle="true" id="A1.E42.m1.2.2.1.1.3.1" xref="A1.E42.m1.2.2.1.1.3.1.cmml"><munderover id="A1.E42.m1.2.2.1.1.3.1a" xref="A1.E42.m1.2.2.1.1.3.1.cmml"><mo id="A1.E42.m1.2.2.1.1.3.1.2.2" movablelimits="false" xref="A1.E42.m1.2.2.1.1.3.1.2.2.cmml">∑</mo><mrow id="A1.E42.m1.2.2.1.1.3.1.2.3" xref="A1.E42.m1.2.2.1.1.3.1.2.3.cmml"><mi id="A1.E42.m1.2.2.1.1.3.1.2.3.2" xref="A1.E42.m1.2.2.1.1.3.1.2.3.2.cmml">j</mi><mo id="A1.E42.m1.2.2.1.1.3.1.2.3.1" xref="A1.E42.m1.2.2.1.1.3.1.2.3.1.cmml">=</mo><mn id="A1.E42.m1.2.2.1.1.3.1.2.3.3" xref="A1.E42.m1.2.2.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="A1.E42.m1.2.2.1.1.3.1.3" xref="A1.E42.m1.2.2.1.1.3.1.3.cmml">J</mi></munderover></mstyle><mrow id="A1.E42.m1.2.2.1.1.3.2" xref="A1.E42.m1.2.2.1.1.3.2.cmml"><msub id="A1.E42.m1.2.2.1.1.3.2.2" xref="A1.E42.m1.2.2.1.1.3.2.2.cmml"><mn id="A1.E42.m1.2.2.1.1.3.2.2.2" xref="A1.E42.m1.2.2.1.1.3.2.2.2.cmml">𝟏</mn><msub id="A1.E42.m1.2.2.1.1.3.2.2.3" xref="A1.E42.m1.2.2.1.1.3.2.2.3.cmml"><mi id="A1.E42.m1.2.2.1.1.3.2.2.3.2" xref="A1.E42.m1.2.2.1.1.3.2.2.3.2.cmml">X</mi><mi id="A1.E42.m1.2.2.1.1.3.2.2.3.3" xref="A1.E42.m1.2.2.1.1.3.2.2.3.3.cmml">j</mi></msub></msub><mo id="A1.E42.m1.2.2.1.1.3.2.1" xref="A1.E42.m1.2.2.1.1.3.2.1.cmml">⁢</mo><mrow id="A1.E42.m1.2.2.1.1.3.2.3.2" xref="A1.E42.m1.2.2.1.1.3.2.cmml"><mo id="A1.E42.m1.2.2.1.1.3.2.3.2.1" stretchy="false" xref="A1.E42.m1.2.2.1.1.3.2.cmml">(</mo><mi id="A1.E42.m1.1.1" xref="A1.E42.m1.1.1.cmml">𝐱</mi><mo id="A1.E42.m1.2.2.1.1.3.2.3.2.2" stretchy="false" xref="A1.E42.m1.2.2.1.1.3.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A1.E42.m1.2.2.1.2" lspace="0.170em" xref="A1.E42.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E42.m1.2b"><apply id="A1.E42.m1.2.2.1.1.cmml" xref="A1.E42.m1.2.2.1"><eq id="A1.E42.m1.2.2.1.1.1.cmml" xref="A1.E42.m1.2.2.1.1.1"></eq><cn id="A1.E42.m1.2.2.1.1.2.cmml" type="integer" xref="A1.E42.m1.2.2.1.1.2">1</cn><apply id="A1.E42.m1.2.2.1.1.3.cmml" xref="A1.E42.m1.2.2.1.1.3"><apply id="A1.E42.m1.2.2.1.1.3.1.cmml" xref="A1.E42.m1.2.2.1.1.3.1"><csymbol cd="ambiguous" id="A1.E42.m1.2.2.1.1.3.1.1.cmml" xref="A1.E42.m1.2.2.1.1.3.1">superscript</csymbol><apply id="A1.E42.m1.2.2.1.1.3.1.2.cmml" xref="A1.E42.m1.2.2.1.1.3.1"><csymbol cd="ambiguous" id="A1.E42.m1.2.2.1.1.3.1.2.1.cmml" xref="A1.E42.m1.2.2.1.1.3.1">subscript</csymbol><sum id="A1.E42.m1.2.2.1.1.3.1.2.2.cmml" xref="A1.E42.m1.2.2.1.1.3.1.2.2"></sum><apply id="A1.E42.m1.2.2.1.1.3.1.2.3.cmml" xref="A1.E42.m1.2.2.1.1.3.1.2.3"><eq id="A1.E42.m1.2.2.1.1.3.1.2.3.1.cmml" xref="A1.E42.m1.2.2.1.1.3.1.2.3.1"></eq><ci id="A1.E42.m1.2.2.1.1.3.1.2.3.2.cmml" xref="A1.E42.m1.2.2.1.1.3.1.2.3.2">𝑗</ci><cn id="A1.E42.m1.2.2.1.1.3.1.2.3.3.cmml" type="integer" xref="A1.E42.m1.2.2.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="A1.E42.m1.2.2.1.1.3.1.3.cmml" xref="A1.E42.m1.2.2.1.1.3.1.3">𝐽</ci></apply><apply id="A1.E42.m1.2.2.1.1.3.2.cmml" xref="A1.E42.m1.2.2.1.1.3.2"><times id="A1.E42.m1.2.2.1.1.3.2.1.cmml" xref="A1.E42.m1.2.2.1.1.3.2.1"></times><apply id="A1.E42.m1.2.2.1.1.3.2.2.cmml" xref="A1.E42.m1.2.2.1.1.3.2.2"><csymbol cd="ambiguous" id="A1.E42.m1.2.2.1.1.3.2.2.1.cmml" xref="A1.E42.m1.2.2.1.1.3.2.2">subscript</csymbol><cn id="A1.E42.m1.2.2.1.1.3.2.2.2.cmml" type="integer" xref="A1.E42.m1.2.2.1.1.3.2.2.2">1</cn><apply id="A1.E42.m1.2.2.1.1.3.2.2.3.cmml" xref="A1.E42.m1.2.2.1.1.3.2.2.3"><csymbol cd="ambiguous" id="A1.E42.m1.2.2.1.1.3.2.2.3.1.cmml" xref="A1.E42.m1.2.2.1.1.3.2.2.3">subscript</csymbol><ci id="A1.E42.m1.2.2.1.1.3.2.2.3.2.cmml" xref="A1.E42.m1.2.2.1.1.3.2.2.3.2">𝑋</ci><ci id="A1.E42.m1.2.2.1.1.3.2.2.3.3.cmml" xref="A1.E42.m1.2.2.1.1.3.2.2.3.3">𝑗</ci></apply></apply><ci id="A1.E42.m1.1.1.cmml" xref="A1.E42.m1.1.1">𝐱</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E42.m1.2c">\displaystyle 1=\sum_{j=1}^{J}\mathbf{1}_{X_{j}}(\mathbf{x})\,.</annotation><annotation encoding="application/x-llamapun" id="A1.E42.m1.2d">1 = ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_J end_POSTSUPERSCRIPT bold_1 start_POSTSUBSCRIPT italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_x ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(42)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS1.p2">
<p class="ltx_p" id="A1.SS1.p2.1">Finally, we can compute the increase in log-likelihood from a step <math alttext="f\rightarrow f+\alpha\cdot\delta f" class="ltx_Math" display="inline" id="A1.SS1.p2.1.m1.1"><semantics id="A1.SS1.p2.1.m1.1a"><mrow id="A1.SS1.p2.1.m1.1.1" xref="A1.SS1.p2.1.m1.1.1.cmml"><mi id="A1.SS1.p2.1.m1.1.1.2" xref="A1.SS1.p2.1.m1.1.1.2.cmml">f</mi><mo id="A1.SS1.p2.1.m1.1.1.1" stretchy="false" xref="A1.SS1.p2.1.m1.1.1.1.cmml">→</mo><mrow id="A1.SS1.p2.1.m1.1.1.3" xref="A1.SS1.p2.1.m1.1.1.3.cmml"><mi id="A1.SS1.p2.1.m1.1.1.3.2" xref="A1.SS1.p2.1.m1.1.1.3.2.cmml">f</mi><mo id="A1.SS1.p2.1.m1.1.1.3.1" xref="A1.SS1.p2.1.m1.1.1.3.1.cmml">+</mo><mrow id="A1.SS1.p2.1.m1.1.1.3.3" xref="A1.SS1.p2.1.m1.1.1.3.3.cmml"><mrow id="A1.SS1.p2.1.m1.1.1.3.3.2" xref="A1.SS1.p2.1.m1.1.1.3.3.2.cmml"><mi id="A1.SS1.p2.1.m1.1.1.3.3.2.2" xref="A1.SS1.p2.1.m1.1.1.3.3.2.2.cmml">α</mi><mo id="A1.SS1.p2.1.m1.1.1.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="A1.SS1.p2.1.m1.1.1.3.3.2.1.cmml">⋅</mo><mi id="A1.SS1.p2.1.m1.1.1.3.3.2.3" xref="A1.SS1.p2.1.m1.1.1.3.3.2.3.cmml">δ</mi></mrow><mo id="A1.SS1.p2.1.m1.1.1.3.3.1" xref="A1.SS1.p2.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="A1.SS1.p2.1.m1.1.1.3.3.3" xref="A1.SS1.p2.1.m1.1.1.3.3.3.cmml">f</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.1.m1.1b"><apply id="A1.SS1.p2.1.m1.1.1.cmml" xref="A1.SS1.p2.1.m1.1.1"><ci id="A1.SS1.p2.1.m1.1.1.1.cmml" xref="A1.SS1.p2.1.m1.1.1.1">→</ci><ci id="A1.SS1.p2.1.m1.1.1.2.cmml" xref="A1.SS1.p2.1.m1.1.1.2">𝑓</ci><apply id="A1.SS1.p2.1.m1.1.1.3.cmml" xref="A1.SS1.p2.1.m1.1.1.3"><plus id="A1.SS1.p2.1.m1.1.1.3.1.cmml" xref="A1.SS1.p2.1.m1.1.1.3.1"></plus><ci id="A1.SS1.p2.1.m1.1.1.3.2.cmml" xref="A1.SS1.p2.1.m1.1.1.3.2">𝑓</ci><apply id="A1.SS1.p2.1.m1.1.1.3.3.cmml" xref="A1.SS1.p2.1.m1.1.1.3.3"><times id="A1.SS1.p2.1.m1.1.1.3.3.1.cmml" xref="A1.SS1.p2.1.m1.1.1.3.3.1"></times><apply id="A1.SS1.p2.1.m1.1.1.3.3.2.cmml" xref="A1.SS1.p2.1.m1.1.1.3.3.2"><ci id="A1.SS1.p2.1.m1.1.1.3.3.2.1.cmml" xref="A1.SS1.p2.1.m1.1.1.3.3.2.1">⋅</ci><ci id="A1.SS1.p2.1.m1.1.1.3.3.2.2.cmml" xref="A1.SS1.p2.1.m1.1.1.3.3.2.2">𝛼</ci><ci id="A1.SS1.p2.1.m1.1.1.3.3.2.3.cmml" xref="A1.SS1.p2.1.m1.1.1.3.3.2.3">𝛿</ci></apply><ci id="A1.SS1.p2.1.m1.1.1.3.3.3.cmml" xref="A1.SS1.p2.1.m1.1.1.3.3.3">𝑓</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.1.m1.1c">f\rightarrow f+\alpha\cdot\delta f</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p2.1.m1.1d">italic_f → italic_f + italic_α ⋅ italic_δ italic_f</annotation></semantics></math> as</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A5.EGx10">
<tbody id="A1.E43"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle L[f+\alpha\cdot\delta f]-L[f]" class="ltx_Math" display="inline" id="A1.E43.m1.2"><semantics id="A1.E43.m1.2a"><mrow id="A1.E43.m1.2.2" xref="A1.E43.m1.2.2.cmml"><mrow id="A1.E43.m1.2.2.1" xref="A1.E43.m1.2.2.1.cmml"><mi id="A1.E43.m1.2.2.1.3" xref="A1.E43.m1.2.2.1.3.cmml">L</mi><mo id="A1.E43.m1.2.2.1.2" xref="A1.E43.m1.2.2.1.2.cmml">⁢</mo><mrow id="A1.E43.m1.2.2.1.1.1" xref="A1.E43.m1.2.2.1.1.2.cmml"><mo id="A1.E43.m1.2.2.1.1.1.2" stretchy="false" xref="A1.E43.m1.2.2.1.1.2.1.cmml">[</mo><mrow id="A1.E43.m1.2.2.1.1.1.1" xref="A1.E43.m1.2.2.1.1.1.1.cmml"><mi id="A1.E43.m1.2.2.1.1.1.1.2" xref="A1.E43.m1.2.2.1.1.1.1.2.cmml">f</mi><mo id="A1.E43.m1.2.2.1.1.1.1.1" xref="A1.E43.m1.2.2.1.1.1.1.1.cmml">+</mo><mrow id="A1.E43.m1.2.2.1.1.1.1.3" xref="A1.E43.m1.2.2.1.1.1.1.3.cmml"><mrow id="A1.E43.m1.2.2.1.1.1.1.3.2" xref="A1.E43.m1.2.2.1.1.1.1.3.2.cmml"><mi id="A1.E43.m1.2.2.1.1.1.1.3.2.2" xref="A1.E43.m1.2.2.1.1.1.1.3.2.2.cmml">α</mi><mo id="A1.E43.m1.2.2.1.1.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="A1.E43.m1.2.2.1.1.1.1.3.2.1.cmml">⋅</mo><mi id="A1.E43.m1.2.2.1.1.1.1.3.2.3" xref="A1.E43.m1.2.2.1.1.1.1.3.2.3.cmml">δ</mi></mrow><mo id="A1.E43.m1.2.2.1.1.1.1.3.1" xref="A1.E43.m1.2.2.1.1.1.1.3.1.cmml">⁢</mo><mi id="A1.E43.m1.2.2.1.1.1.1.3.3" xref="A1.E43.m1.2.2.1.1.1.1.3.3.cmml">f</mi></mrow></mrow><mo id="A1.E43.m1.2.2.1.1.1.3" stretchy="false" xref="A1.E43.m1.2.2.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="A1.E43.m1.2.2.2" xref="A1.E43.m1.2.2.2.cmml">−</mo><mrow id="A1.E43.m1.2.2.3" xref="A1.E43.m1.2.2.3.cmml"><mi id="A1.E43.m1.2.2.3.2" xref="A1.E43.m1.2.2.3.2.cmml">L</mi><mo id="A1.E43.m1.2.2.3.1" xref="A1.E43.m1.2.2.3.1.cmml">⁢</mo><mrow id="A1.E43.m1.2.2.3.3.2" xref="A1.E43.m1.2.2.3.3.1.cmml"><mo id="A1.E43.m1.2.2.3.3.2.1" stretchy="false" xref="A1.E43.m1.2.2.3.3.1.1.cmml">[</mo><mi id="A1.E43.m1.1.1" xref="A1.E43.m1.1.1.cmml">f</mi><mo id="A1.E43.m1.2.2.3.3.2.2" stretchy="false" xref="A1.E43.m1.2.2.3.3.1.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E43.m1.2b"><apply id="A1.E43.m1.2.2.cmml" xref="A1.E43.m1.2.2"><minus id="A1.E43.m1.2.2.2.cmml" xref="A1.E43.m1.2.2.2"></minus><apply id="A1.E43.m1.2.2.1.cmml" xref="A1.E43.m1.2.2.1"><times id="A1.E43.m1.2.2.1.2.cmml" xref="A1.E43.m1.2.2.1.2"></times><ci id="A1.E43.m1.2.2.1.3.cmml" xref="A1.E43.m1.2.2.1.3">𝐿</ci><apply id="A1.E43.m1.2.2.1.1.2.cmml" xref="A1.E43.m1.2.2.1.1.1"><csymbol cd="latexml" id="A1.E43.m1.2.2.1.1.2.1.cmml" xref="A1.E43.m1.2.2.1.1.1.2">delimited-[]</csymbol><apply id="A1.E43.m1.2.2.1.1.1.1.cmml" xref="A1.E43.m1.2.2.1.1.1.1"><plus id="A1.E43.m1.2.2.1.1.1.1.1.cmml" xref="A1.E43.m1.2.2.1.1.1.1.1"></plus><ci id="A1.E43.m1.2.2.1.1.1.1.2.cmml" xref="A1.E43.m1.2.2.1.1.1.1.2">𝑓</ci><apply id="A1.E43.m1.2.2.1.1.1.1.3.cmml" xref="A1.E43.m1.2.2.1.1.1.1.3"><times id="A1.E43.m1.2.2.1.1.1.1.3.1.cmml" xref="A1.E43.m1.2.2.1.1.1.1.3.1"></times><apply id="A1.E43.m1.2.2.1.1.1.1.3.2.cmml" xref="A1.E43.m1.2.2.1.1.1.1.3.2"><ci id="A1.E43.m1.2.2.1.1.1.1.3.2.1.cmml" xref="A1.E43.m1.2.2.1.1.1.1.3.2.1">⋅</ci><ci id="A1.E43.m1.2.2.1.1.1.1.3.2.2.cmml" xref="A1.E43.m1.2.2.1.1.1.1.3.2.2">𝛼</ci><ci id="A1.E43.m1.2.2.1.1.1.1.3.2.3.cmml" xref="A1.E43.m1.2.2.1.1.1.1.3.2.3">𝛿</ci></apply><ci id="A1.E43.m1.2.2.1.1.1.1.3.3.cmml" xref="A1.E43.m1.2.2.1.1.1.1.3.3">𝑓</ci></apply></apply></apply></apply><apply id="A1.E43.m1.2.2.3.cmml" xref="A1.E43.m1.2.2.3"><times id="A1.E43.m1.2.2.3.1.cmml" xref="A1.E43.m1.2.2.3.1"></times><ci id="A1.E43.m1.2.2.3.2.cmml" xref="A1.E43.m1.2.2.3.2">𝐿</ci><apply id="A1.E43.m1.2.2.3.3.1.cmml" xref="A1.E43.m1.2.2.3.3.2"><csymbol cd="latexml" id="A1.E43.m1.2.2.3.3.1.1.cmml" xref="A1.E43.m1.2.2.3.3.2.1">delimited-[]</csymbol><ci id="A1.E43.m1.1.1.cmml" xref="A1.E43.m1.1.1">𝑓</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E43.m1.2c">\displaystyle L[f+\alpha\cdot\delta f]-L[f]</annotation><annotation encoding="application/x-llamapun" id="A1.E43.m1.2d">italic_L [ italic_f + italic_α ⋅ italic_δ italic_f ] - italic_L [ italic_f ]</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbb{E}_{\mathbf{x}\sim p}\left[\alpha\cdot\delta f(\mathbf{x%
})\right]-\log Z[f+\alpha\cdot\delta f]+\log Z[f]" class="ltx_Math" display="inline" id="A1.E43.m2.4"><semantics id="A1.E43.m2.4a"><mrow id="A1.E43.m2.4.4" xref="A1.E43.m2.4.4.cmml"><mi id="A1.E43.m2.4.4.4" xref="A1.E43.m2.4.4.4.cmml"></mi><mo id="A1.E43.m2.4.4.3" xref="A1.E43.m2.4.4.3.cmml">=</mo><mrow id="A1.E43.m2.4.4.2" xref="A1.E43.m2.4.4.2.cmml"><mrow id="A1.E43.m2.4.4.2.2" xref="A1.E43.m2.4.4.2.2.cmml"><mrow id="A1.E43.m2.3.3.1.1.1" xref="A1.E43.m2.3.3.1.1.1.cmml"><msub id="A1.E43.m2.3.3.1.1.1.3" xref="A1.E43.m2.3.3.1.1.1.3.cmml"><mi id="A1.E43.m2.3.3.1.1.1.3.2" xref="A1.E43.m2.3.3.1.1.1.3.2.cmml">𝔼</mi><mrow id="A1.E43.m2.3.3.1.1.1.3.3" xref="A1.E43.m2.3.3.1.1.1.3.3.cmml"><mi id="A1.E43.m2.3.3.1.1.1.3.3.2" xref="A1.E43.m2.3.3.1.1.1.3.3.2.cmml">𝐱</mi><mo id="A1.E43.m2.3.3.1.1.1.3.3.1" xref="A1.E43.m2.3.3.1.1.1.3.3.1.cmml">∼</mo><mi id="A1.E43.m2.3.3.1.1.1.3.3.3" xref="A1.E43.m2.3.3.1.1.1.3.3.3.cmml">p</mi></mrow></msub><mo id="A1.E43.m2.3.3.1.1.1.2" xref="A1.E43.m2.3.3.1.1.1.2.cmml">⁢</mo><mrow id="A1.E43.m2.3.3.1.1.1.1.1" xref="A1.E43.m2.3.3.1.1.1.1.2.cmml"><mo id="A1.E43.m2.3.3.1.1.1.1.1.2" xref="A1.E43.m2.3.3.1.1.1.1.2.1.cmml">[</mo><mrow id="A1.E43.m2.3.3.1.1.1.1.1.1" xref="A1.E43.m2.3.3.1.1.1.1.1.1.cmml"><mrow id="A1.E43.m2.3.3.1.1.1.1.1.1.2" xref="A1.E43.m2.3.3.1.1.1.1.1.1.2.cmml"><mi id="A1.E43.m2.3.3.1.1.1.1.1.1.2.2" xref="A1.E43.m2.3.3.1.1.1.1.1.1.2.2.cmml">α</mi><mo id="A1.E43.m2.3.3.1.1.1.1.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="A1.E43.m2.3.3.1.1.1.1.1.1.2.1.cmml">⋅</mo><mi id="A1.E43.m2.3.3.1.1.1.1.1.1.2.3" xref="A1.E43.m2.3.3.1.1.1.1.1.1.2.3.cmml">δ</mi></mrow><mo id="A1.E43.m2.3.3.1.1.1.1.1.1.1" xref="A1.E43.m2.3.3.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.E43.m2.3.3.1.1.1.1.1.1.3" xref="A1.E43.m2.3.3.1.1.1.1.1.1.3.cmml">f</mi><mo id="A1.E43.m2.3.3.1.1.1.1.1.1.1a" xref="A1.E43.m2.3.3.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="A1.E43.m2.3.3.1.1.1.1.1.1.4.2" xref="A1.E43.m2.3.3.1.1.1.1.1.1.cmml"><mo id="A1.E43.m2.3.3.1.1.1.1.1.1.4.2.1" stretchy="false" xref="A1.E43.m2.3.3.1.1.1.1.1.1.cmml">(</mo><mi id="A1.E43.m2.1.1" xref="A1.E43.m2.1.1.cmml">𝐱</mi><mo id="A1.E43.m2.3.3.1.1.1.1.1.1.4.2.2" stretchy="false" xref="A1.E43.m2.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E43.m2.3.3.1.1.1.1.1.3" xref="A1.E43.m2.3.3.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="A1.E43.m2.4.4.2.2.3" xref="A1.E43.m2.4.4.2.2.3.cmml">−</mo><mrow id="A1.E43.m2.4.4.2.2.2" xref="A1.E43.m2.4.4.2.2.2.cmml"><mrow id="A1.E43.m2.4.4.2.2.2.3" xref="A1.E43.m2.4.4.2.2.2.3.cmml"><mi id="A1.E43.m2.4.4.2.2.2.3.1" xref="A1.E43.m2.4.4.2.2.2.3.1.cmml">log</mi><mo id="A1.E43.m2.4.4.2.2.2.3a" lspace="0.167em" xref="A1.E43.m2.4.4.2.2.2.3.cmml">⁡</mo><mi id="A1.E43.m2.4.4.2.2.2.3.2" xref="A1.E43.m2.4.4.2.2.2.3.2.cmml">Z</mi></mrow><mo id="A1.E43.m2.4.4.2.2.2.2" xref="A1.E43.m2.4.4.2.2.2.2.cmml">⁢</mo><mrow id="A1.E43.m2.4.4.2.2.2.1.1" xref="A1.E43.m2.4.4.2.2.2.1.2.cmml"><mo id="A1.E43.m2.4.4.2.2.2.1.1.2" stretchy="false" xref="A1.E43.m2.4.4.2.2.2.1.2.1.cmml">[</mo><mrow id="A1.E43.m2.4.4.2.2.2.1.1.1" xref="A1.E43.m2.4.4.2.2.2.1.1.1.cmml"><mi id="A1.E43.m2.4.4.2.2.2.1.1.1.2" xref="A1.E43.m2.4.4.2.2.2.1.1.1.2.cmml">f</mi><mo id="A1.E43.m2.4.4.2.2.2.1.1.1.1" xref="A1.E43.m2.4.4.2.2.2.1.1.1.1.cmml">+</mo><mrow id="A1.E43.m2.4.4.2.2.2.1.1.1.3" xref="A1.E43.m2.4.4.2.2.2.1.1.1.3.cmml"><mrow id="A1.E43.m2.4.4.2.2.2.1.1.1.3.2" xref="A1.E43.m2.4.4.2.2.2.1.1.1.3.2.cmml"><mi id="A1.E43.m2.4.4.2.2.2.1.1.1.3.2.2" xref="A1.E43.m2.4.4.2.2.2.1.1.1.3.2.2.cmml">α</mi><mo id="A1.E43.m2.4.4.2.2.2.1.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="A1.E43.m2.4.4.2.2.2.1.1.1.3.2.1.cmml">⋅</mo><mi id="A1.E43.m2.4.4.2.2.2.1.1.1.3.2.3" xref="A1.E43.m2.4.4.2.2.2.1.1.1.3.2.3.cmml">δ</mi></mrow><mo id="A1.E43.m2.4.4.2.2.2.1.1.1.3.1" xref="A1.E43.m2.4.4.2.2.2.1.1.1.3.1.cmml">⁢</mo><mi id="A1.E43.m2.4.4.2.2.2.1.1.1.3.3" xref="A1.E43.m2.4.4.2.2.2.1.1.1.3.3.cmml">f</mi></mrow></mrow><mo id="A1.E43.m2.4.4.2.2.2.1.1.3" stretchy="false" xref="A1.E43.m2.4.4.2.2.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="A1.E43.m2.4.4.2.3" xref="A1.E43.m2.4.4.2.3.cmml">+</mo><mrow id="A1.E43.m2.4.4.2.4" xref="A1.E43.m2.4.4.2.4.cmml"><mrow id="A1.E43.m2.4.4.2.4.2" xref="A1.E43.m2.4.4.2.4.2.cmml"><mi id="A1.E43.m2.4.4.2.4.2.1" xref="A1.E43.m2.4.4.2.4.2.1.cmml">log</mi><mo id="A1.E43.m2.4.4.2.4.2a" lspace="0.167em" xref="A1.E43.m2.4.4.2.4.2.cmml">⁡</mo><mi id="A1.E43.m2.4.4.2.4.2.2" xref="A1.E43.m2.4.4.2.4.2.2.cmml">Z</mi></mrow><mo id="A1.E43.m2.4.4.2.4.1" xref="A1.E43.m2.4.4.2.4.1.cmml">⁢</mo><mrow id="A1.E43.m2.4.4.2.4.3.2" xref="A1.E43.m2.4.4.2.4.3.1.cmml"><mo id="A1.E43.m2.4.4.2.4.3.2.1" stretchy="false" xref="A1.E43.m2.4.4.2.4.3.1.1.cmml">[</mo><mi id="A1.E43.m2.2.2" xref="A1.E43.m2.2.2.cmml">f</mi><mo id="A1.E43.m2.4.4.2.4.3.2.2" stretchy="false" xref="A1.E43.m2.4.4.2.4.3.1.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E43.m2.4b"><apply id="A1.E43.m2.4.4.cmml" xref="A1.E43.m2.4.4"><eq id="A1.E43.m2.4.4.3.cmml" xref="A1.E43.m2.4.4.3"></eq><csymbol cd="latexml" id="A1.E43.m2.4.4.4.cmml" xref="A1.E43.m2.4.4.4">absent</csymbol><apply id="A1.E43.m2.4.4.2.cmml" xref="A1.E43.m2.4.4.2"><plus id="A1.E43.m2.4.4.2.3.cmml" xref="A1.E43.m2.4.4.2.3"></plus><apply id="A1.E43.m2.4.4.2.2.cmml" xref="A1.E43.m2.4.4.2.2"><minus id="A1.E43.m2.4.4.2.2.3.cmml" xref="A1.E43.m2.4.4.2.2.3"></minus><apply id="A1.E43.m2.3.3.1.1.1.cmml" xref="A1.E43.m2.3.3.1.1.1"><times id="A1.E43.m2.3.3.1.1.1.2.cmml" xref="A1.E43.m2.3.3.1.1.1.2"></times><apply id="A1.E43.m2.3.3.1.1.1.3.cmml" xref="A1.E43.m2.3.3.1.1.1.3"><csymbol cd="ambiguous" id="A1.E43.m2.3.3.1.1.1.3.1.cmml" xref="A1.E43.m2.3.3.1.1.1.3">subscript</csymbol><ci id="A1.E43.m2.3.3.1.1.1.3.2.cmml" xref="A1.E43.m2.3.3.1.1.1.3.2">𝔼</ci><apply id="A1.E43.m2.3.3.1.1.1.3.3.cmml" xref="A1.E43.m2.3.3.1.1.1.3.3"><csymbol cd="latexml" id="A1.E43.m2.3.3.1.1.1.3.3.1.cmml" xref="A1.E43.m2.3.3.1.1.1.3.3.1">similar-to</csymbol><ci id="A1.E43.m2.3.3.1.1.1.3.3.2.cmml" xref="A1.E43.m2.3.3.1.1.1.3.3.2">𝐱</ci><ci id="A1.E43.m2.3.3.1.1.1.3.3.3.cmml" xref="A1.E43.m2.3.3.1.1.1.3.3.3">𝑝</ci></apply></apply><apply id="A1.E43.m2.3.3.1.1.1.1.2.cmml" xref="A1.E43.m2.3.3.1.1.1.1.1"><csymbol cd="latexml" id="A1.E43.m2.3.3.1.1.1.1.2.1.cmml" xref="A1.E43.m2.3.3.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A1.E43.m2.3.3.1.1.1.1.1.1.cmml" xref="A1.E43.m2.3.3.1.1.1.1.1.1"><times id="A1.E43.m2.3.3.1.1.1.1.1.1.1.cmml" xref="A1.E43.m2.3.3.1.1.1.1.1.1.1"></times><apply id="A1.E43.m2.3.3.1.1.1.1.1.1.2.cmml" xref="A1.E43.m2.3.3.1.1.1.1.1.1.2"><ci id="A1.E43.m2.3.3.1.1.1.1.1.1.2.1.cmml" xref="A1.E43.m2.3.3.1.1.1.1.1.1.2.1">⋅</ci><ci id="A1.E43.m2.3.3.1.1.1.1.1.1.2.2.cmml" xref="A1.E43.m2.3.3.1.1.1.1.1.1.2.2">𝛼</ci><ci id="A1.E43.m2.3.3.1.1.1.1.1.1.2.3.cmml" xref="A1.E43.m2.3.3.1.1.1.1.1.1.2.3">𝛿</ci></apply><ci id="A1.E43.m2.3.3.1.1.1.1.1.1.3.cmml" xref="A1.E43.m2.3.3.1.1.1.1.1.1.3">𝑓</ci><ci id="A1.E43.m2.1.1.cmml" xref="A1.E43.m2.1.1">𝐱</ci></apply></apply></apply><apply id="A1.E43.m2.4.4.2.2.2.cmml" xref="A1.E43.m2.4.4.2.2.2"><times id="A1.E43.m2.4.4.2.2.2.2.cmml" xref="A1.E43.m2.4.4.2.2.2.2"></times><apply id="A1.E43.m2.4.4.2.2.2.3.cmml" xref="A1.E43.m2.4.4.2.2.2.3"><log id="A1.E43.m2.4.4.2.2.2.3.1.cmml" xref="A1.E43.m2.4.4.2.2.2.3.1"></log><ci id="A1.E43.m2.4.4.2.2.2.3.2.cmml" xref="A1.E43.m2.4.4.2.2.2.3.2">𝑍</ci></apply><apply id="A1.E43.m2.4.4.2.2.2.1.2.cmml" xref="A1.E43.m2.4.4.2.2.2.1.1"><csymbol cd="latexml" id="A1.E43.m2.4.4.2.2.2.1.2.1.cmml" xref="A1.E43.m2.4.4.2.2.2.1.1.2">delimited-[]</csymbol><apply id="A1.E43.m2.4.4.2.2.2.1.1.1.cmml" xref="A1.E43.m2.4.4.2.2.2.1.1.1"><plus id="A1.E43.m2.4.4.2.2.2.1.1.1.1.cmml" xref="A1.E43.m2.4.4.2.2.2.1.1.1.1"></plus><ci id="A1.E43.m2.4.4.2.2.2.1.1.1.2.cmml" xref="A1.E43.m2.4.4.2.2.2.1.1.1.2">𝑓</ci><apply id="A1.E43.m2.4.4.2.2.2.1.1.1.3.cmml" xref="A1.E43.m2.4.4.2.2.2.1.1.1.3"><times id="A1.E43.m2.4.4.2.2.2.1.1.1.3.1.cmml" xref="A1.E43.m2.4.4.2.2.2.1.1.1.3.1"></times><apply id="A1.E43.m2.4.4.2.2.2.1.1.1.3.2.cmml" xref="A1.E43.m2.4.4.2.2.2.1.1.1.3.2"><ci id="A1.E43.m2.4.4.2.2.2.1.1.1.3.2.1.cmml" xref="A1.E43.m2.4.4.2.2.2.1.1.1.3.2.1">⋅</ci><ci id="A1.E43.m2.4.4.2.2.2.1.1.1.3.2.2.cmml" xref="A1.E43.m2.4.4.2.2.2.1.1.1.3.2.2">𝛼</ci><ci id="A1.E43.m2.4.4.2.2.2.1.1.1.3.2.3.cmml" xref="A1.E43.m2.4.4.2.2.2.1.1.1.3.2.3">𝛿</ci></apply><ci id="A1.E43.m2.4.4.2.2.2.1.1.1.3.3.cmml" xref="A1.E43.m2.4.4.2.2.2.1.1.1.3.3">𝑓</ci></apply></apply></apply></apply></apply><apply id="A1.E43.m2.4.4.2.4.cmml" xref="A1.E43.m2.4.4.2.4"><times id="A1.E43.m2.4.4.2.4.1.cmml" xref="A1.E43.m2.4.4.2.4.1"></times><apply id="A1.E43.m2.4.4.2.4.2.cmml" xref="A1.E43.m2.4.4.2.4.2"><log id="A1.E43.m2.4.4.2.4.2.1.cmml" xref="A1.E43.m2.4.4.2.4.2.1"></log><ci id="A1.E43.m2.4.4.2.4.2.2.cmml" xref="A1.E43.m2.4.4.2.4.2.2">𝑍</ci></apply><apply id="A1.E43.m2.4.4.2.4.3.1.cmml" xref="A1.E43.m2.4.4.2.4.3.2"><csymbol cd="latexml" id="A1.E43.m2.4.4.2.4.3.1.1.cmml" xref="A1.E43.m2.4.4.2.4.3.2.1">delimited-[]</csymbol><ci id="A1.E43.m2.2.2.cmml" xref="A1.E43.m2.2.2">𝑓</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E43.m2.4c">\displaystyle=\mathbb{E}_{\mathbf{x}\sim p}\left[\alpha\cdot\delta f(\mathbf{x%
})\right]-\log Z[f+\alpha\cdot\delta f]+\log Z[f]</annotation><annotation encoding="application/x-llamapun" id="A1.E43.m2.4d">= blackboard_E start_POSTSUBSCRIPT bold_x ∼ italic_p end_POSTSUBSCRIPT [ italic_α ⋅ italic_δ italic_f ( bold_x ) ] - roman_log italic_Z [ italic_f + italic_α ⋅ italic_δ italic_f ] + roman_log italic_Z [ italic_f ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(43)</span></td>
</tr></tbody>
<tbody id="A1.E44"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\alpha\mathbb{E}_{\mathbf{x}\sim p}\delta f(\mathbf{x})-\log%
\mathbb{E}_{\mathbf{x}\sim q_{f}}\exp(\alpha\delta f(\mathbf{x}))" class="ltx_Math" display="inline" id="A1.E44.m1.4"><semantics id="A1.E44.m1.4a"><mrow id="A1.E44.m1.4.4" xref="A1.E44.m1.4.4.cmml"><mi id="A1.E44.m1.4.4.3" xref="A1.E44.m1.4.4.3.cmml"></mi><mo id="A1.E44.m1.4.4.2" xref="A1.E44.m1.4.4.2.cmml">=</mo><mrow id="A1.E44.m1.4.4.1" xref="A1.E44.m1.4.4.1.cmml"><mrow id="A1.E44.m1.4.4.1.3" xref="A1.E44.m1.4.4.1.3.cmml"><mi id="A1.E44.m1.4.4.1.3.2" xref="A1.E44.m1.4.4.1.3.2.cmml">α</mi><mo id="A1.E44.m1.4.4.1.3.1" xref="A1.E44.m1.4.4.1.3.1.cmml">⁢</mo><msub id="A1.E44.m1.4.4.1.3.3" xref="A1.E44.m1.4.4.1.3.3.cmml"><mi id="A1.E44.m1.4.4.1.3.3.2" xref="A1.E44.m1.4.4.1.3.3.2.cmml">𝔼</mi><mrow id="A1.E44.m1.4.4.1.3.3.3" xref="A1.E44.m1.4.4.1.3.3.3.cmml"><mi id="A1.E44.m1.4.4.1.3.3.3.2" xref="A1.E44.m1.4.4.1.3.3.3.2.cmml">𝐱</mi><mo id="A1.E44.m1.4.4.1.3.3.3.1" xref="A1.E44.m1.4.4.1.3.3.3.1.cmml">∼</mo><mi id="A1.E44.m1.4.4.1.3.3.3.3" xref="A1.E44.m1.4.4.1.3.3.3.3.cmml">p</mi></mrow></msub><mo id="A1.E44.m1.4.4.1.3.1a" xref="A1.E44.m1.4.4.1.3.1.cmml">⁢</mo><mi id="A1.E44.m1.4.4.1.3.4" xref="A1.E44.m1.4.4.1.3.4.cmml">δ</mi><mo id="A1.E44.m1.4.4.1.3.1b" xref="A1.E44.m1.4.4.1.3.1.cmml">⁢</mo><mi id="A1.E44.m1.4.4.1.3.5" xref="A1.E44.m1.4.4.1.3.5.cmml">f</mi><mo id="A1.E44.m1.4.4.1.3.1c" xref="A1.E44.m1.4.4.1.3.1.cmml">⁢</mo><mrow id="A1.E44.m1.4.4.1.3.6.2" xref="A1.E44.m1.4.4.1.3.cmml"><mo id="A1.E44.m1.4.4.1.3.6.2.1" stretchy="false" xref="A1.E44.m1.4.4.1.3.cmml">(</mo><mi id="A1.E44.m1.1.1" xref="A1.E44.m1.1.1.cmml">𝐱</mi><mo id="A1.E44.m1.4.4.1.3.6.2.2" stretchy="false" xref="A1.E44.m1.4.4.1.3.cmml">)</mo></mrow></mrow><mo id="A1.E44.m1.4.4.1.2" xref="A1.E44.m1.4.4.1.2.cmml">−</mo><mrow id="A1.E44.m1.4.4.1.1" xref="A1.E44.m1.4.4.1.1.cmml"><mi id="A1.E44.m1.4.4.1.1.2" xref="A1.E44.m1.4.4.1.1.2.cmml">log</mi><mo id="A1.E44.m1.4.4.1.1a" lspace="0.167em" xref="A1.E44.m1.4.4.1.1.cmml">⁡</mo><mrow id="A1.E44.m1.4.4.1.1.1" xref="A1.E44.m1.4.4.1.1.1.cmml"><msub id="A1.E44.m1.4.4.1.1.1.3" xref="A1.E44.m1.4.4.1.1.1.3.cmml"><mi id="A1.E44.m1.4.4.1.1.1.3.2" xref="A1.E44.m1.4.4.1.1.1.3.2.cmml">𝔼</mi><mrow id="A1.E44.m1.4.4.1.1.1.3.3" xref="A1.E44.m1.4.4.1.1.1.3.3.cmml"><mi id="A1.E44.m1.4.4.1.1.1.3.3.2" xref="A1.E44.m1.4.4.1.1.1.3.3.2.cmml">𝐱</mi><mo id="A1.E44.m1.4.4.1.1.1.3.3.1" xref="A1.E44.m1.4.4.1.1.1.3.3.1.cmml">∼</mo><msub id="A1.E44.m1.4.4.1.1.1.3.3.3" xref="A1.E44.m1.4.4.1.1.1.3.3.3.cmml"><mi id="A1.E44.m1.4.4.1.1.1.3.3.3.2" xref="A1.E44.m1.4.4.1.1.1.3.3.3.2.cmml">q</mi><mi id="A1.E44.m1.4.4.1.1.1.3.3.3.3" xref="A1.E44.m1.4.4.1.1.1.3.3.3.3.cmml">f</mi></msub></mrow></msub><mo id="A1.E44.m1.4.4.1.1.1.2" lspace="0.167em" xref="A1.E44.m1.4.4.1.1.1.2.cmml">⁢</mo><mrow id="A1.E44.m1.4.4.1.1.1.1.1" xref="A1.E44.m1.4.4.1.1.1.1.2.cmml"><mi id="A1.E44.m1.3.3" xref="A1.E44.m1.3.3.cmml">exp</mi><mo id="A1.E44.m1.4.4.1.1.1.1.1a" xref="A1.E44.m1.4.4.1.1.1.1.2.cmml">⁡</mo><mrow id="A1.E44.m1.4.4.1.1.1.1.1.1" xref="A1.E44.m1.4.4.1.1.1.1.2.cmml"><mo id="A1.E44.m1.4.4.1.1.1.1.1.1.2" stretchy="false" xref="A1.E44.m1.4.4.1.1.1.1.2.cmml">(</mo><mrow id="A1.E44.m1.4.4.1.1.1.1.1.1.1" xref="A1.E44.m1.4.4.1.1.1.1.1.1.1.cmml"><mi id="A1.E44.m1.4.4.1.1.1.1.1.1.1.2" xref="A1.E44.m1.4.4.1.1.1.1.1.1.1.2.cmml">α</mi><mo id="A1.E44.m1.4.4.1.1.1.1.1.1.1.1" xref="A1.E44.m1.4.4.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.E44.m1.4.4.1.1.1.1.1.1.1.3" xref="A1.E44.m1.4.4.1.1.1.1.1.1.1.3.cmml">δ</mi><mo id="A1.E44.m1.4.4.1.1.1.1.1.1.1.1a" xref="A1.E44.m1.4.4.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.E44.m1.4.4.1.1.1.1.1.1.1.4" xref="A1.E44.m1.4.4.1.1.1.1.1.1.1.4.cmml">f</mi><mo id="A1.E44.m1.4.4.1.1.1.1.1.1.1.1b" xref="A1.E44.m1.4.4.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="A1.E44.m1.4.4.1.1.1.1.1.1.1.5.2" xref="A1.E44.m1.4.4.1.1.1.1.1.1.1.cmml"><mo id="A1.E44.m1.4.4.1.1.1.1.1.1.1.5.2.1" stretchy="false" xref="A1.E44.m1.4.4.1.1.1.1.1.1.1.cmml">(</mo><mi id="A1.E44.m1.2.2" xref="A1.E44.m1.2.2.cmml">𝐱</mi><mo id="A1.E44.m1.4.4.1.1.1.1.1.1.1.5.2.2" stretchy="false" xref="A1.E44.m1.4.4.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E44.m1.4.4.1.1.1.1.1.1.3" stretchy="false" xref="A1.E44.m1.4.4.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E44.m1.4b"><apply id="A1.E44.m1.4.4.cmml" xref="A1.E44.m1.4.4"><eq id="A1.E44.m1.4.4.2.cmml" xref="A1.E44.m1.4.4.2"></eq><csymbol cd="latexml" id="A1.E44.m1.4.4.3.cmml" xref="A1.E44.m1.4.4.3">absent</csymbol><apply id="A1.E44.m1.4.4.1.cmml" xref="A1.E44.m1.4.4.1"><minus id="A1.E44.m1.4.4.1.2.cmml" xref="A1.E44.m1.4.4.1.2"></minus><apply id="A1.E44.m1.4.4.1.3.cmml" xref="A1.E44.m1.4.4.1.3"><times id="A1.E44.m1.4.4.1.3.1.cmml" xref="A1.E44.m1.4.4.1.3.1"></times><ci id="A1.E44.m1.4.4.1.3.2.cmml" xref="A1.E44.m1.4.4.1.3.2">𝛼</ci><apply id="A1.E44.m1.4.4.1.3.3.cmml" xref="A1.E44.m1.4.4.1.3.3"><csymbol cd="ambiguous" id="A1.E44.m1.4.4.1.3.3.1.cmml" xref="A1.E44.m1.4.4.1.3.3">subscript</csymbol><ci id="A1.E44.m1.4.4.1.3.3.2.cmml" xref="A1.E44.m1.4.4.1.3.3.2">𝔼</ci><apply id="A1.E44.m1.4.4.1.3.3.3.cmml" xref="A1.E44.m1.4.4.1.3.3.3"><csymbol cd="latexml" id="A1.E44.m1.4.4.1.3.3.3.1.cmml" xref="A1.E44.m1.4.4.1.3.3.3.1">similar-to</csymbol><ci id="A1.E44.m1.4.4.1.3.3.3.2.cmml" xref="A1.E44.m1.4.4.1.3.3.3.2">𝐱</ci><ci id="A1.E44.m1.4.4.1.3.3.3.3.cmml" xref="A1.E44.m1.4.4.1.3.3.3.3">𝑝</ci></apply></apply><ci id="A1.E44.m1.4.4.1.3.4.cmml" xref="A1.E44.m1.4.4.1.3.4">𝛿</ci><ci id="A1.E44.m1.4.4.1.3.5.cmml" xref="A1.E44.m1.4.4.1.3.5">𝑓</ci><ci id="A1.E44.m1.1.1.cmml" xref="A1.E44.m1.1.1">𝐱</ci></apply><apply id="A1.E44.m1.4.4.1.1.cmml" xref="A1.E44.m1.4.4.1.1"><log id="A1.E44.m1.4.4.1.1.2.cmml" xref="A1.E44.m1.4.4.1.1.2"></log><apply id="A1.E44.m1.4.4.1.1.1.cmml" xref="A1.E44.m1.4.4.1.1.1"><times id="A1.E44.m1.4.4.1.1.1.2.cmml" xref="A1.E44.m1.4.4.1.1.1.2"></times><apply id="A1.E44.m1.4.4.1.1.1.3.cmml" xref="A1.E44.m1.4.4.1.1.1.3"><csymbol cd="ambiguous" id="A1.E44.m1.4.4.1.1.1.3.1.cmml" xref="A1.E44.m1.4.4.1.1.1.3">subscript</csymbol><ci id="A1.E44.m1.4.4.1.1.1.3.2.cmml" xref="A1.E44.m1.4.4.1.1.1.3.2">𝔼</ci><apply id="A1.E44.m1.4.4.1.1.1.3.3.cmml" xref="A1.E44.m1.4.4.1.1.1.3.3"><csymbol cd="latexml" id="A1.E44.m1.4.4.1.1.1.3.3.1.cmml" xref="A1.E44.m1.4.4.1.1.1.3.3.1">similar-to</csymbol><ci id="A1.E44.m1.4.4.1.1.1.3.3.2.cmml" xref="A1.E44.m1.4.4.1.1.1.3.3.2">𝐱</ci><apply id="A1.E44.m1.4.4.1.1.1.3.3.3.cmml" xref="A1.E44.m1.4.4.1.1.1.3.3.3"><csymbol cd="ambiguous" id="A1.E44.m1.4.4.1.1.1.3.3.3.1.cmml" xref="A1.E44.m1.4.4.1.1.1.3.3.3">subscript</csymbol><ci id="A1.E44.m1.4.4.1.1.1.3.3.3.2.cmml" xref="A1.E44.m1.4.4.1.1.1.3.3.3.2">𝑞</ci><ci id="A1.E44.m1.4.4.1.1.1.3.3.3.3.cmml" xref="A1.E44.m1.4.4.1.1.1.3.3.3.3">𝑓</ci></apply></apply></apply><apply id="A1.E44.m1.4.4.1.1.1.1.2.cmml" xref="A1.E44.m1.4.4.1.1.1.1.1"><exp id="A1.E44.m1.3.3.cmml" xref="A1.E44.m1.3.3"></exp><apply id="A1.E44.m1.4.4.1.1.1.1.1.1.1.cmml" xref="A1.E44.m1.4.4.1.1.1.1.1.1.1"><times id="A1.E44.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="A1.E44.m1.4.4.1.1.1.1.1.1.1.1"></times><ci id="A1.E44.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="A1.E44.m1.4.4.1.1.1.1.1.1.1.2">𝛼</ci><ci id="A1.E44.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="A1.E44.m1.4.4.1.1.1.1.1.1.1.3">𝛿</ci><ci id="A1.E44.m1.4.4.1.1.1.1.1.1.1.4.cmml" xref="A1.E44.m1.4.4.1.1.1.1.1.1.1.4">𝑓</ci><ci id="A1.E44.m1.2.2.cmml" xref="A1.E44.m1.2.2">𝐱</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E44.m1.4c">\displaystyle=\alpha\mathbb{E}_{\mathbf{x}\sim p}\delta f(\mathbf{x})-\log%
\mathbb{E}_{\mathbf{x}\sim q_{f}}\exp(\alpha\delta f(\mathbf{x}))</annotation><annotation encoding="application/x-llamapun" id="A1.E44.m1.4d">= italic_α blackboard_E start_POSTSUBSCRIPT bold_x ∼ italic_p end_POSTSUBSCRIPT italic_δ italic_f ( bold_x ) - roman_log blackboard_E start_POSTSUBSCRIPT bold_x ∼ italic_q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT end_POSTSUBSCRIPT roman_exp ( italic_α italic_δ italic_f ( bold_x ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(44)</span></td>
</tr></tbody>
<tbody id="A1.E45"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\alpha\sum_{j=1}^{J}w_{j}P\left(X_{j}\right)-\log\sum_{j=1}^{J}Q%
_{f}\left(X_{j}\right)\exp\left(\alpha w_{j}\right)\,," class="ltx_Math" display="inline" id="A1.E45.m1.2"><semantics id="A1.E45.m1.2a"><mrow id="A1.E45.m1.2.2.1" xref="A1.E45.m1.2.2.1.1.cmml"><mrow id="A1.E45.m1.2.2.1.1" xref="A1.E45.m1.2.2.1.1.cmml"><mi id="A1.E45.m1.2.2.1.1.5" xref="A1.E45.m1.2.2.1.1.5.cmml"></mi><mo id="A1.E45.m1.2.2.1.1.4" xref="A1.E45.m1.2.2.1.1.4.cmml">=</mo><mrow id="A1.E45.m1.2.2.1.1.3" xref="A1.E45.m1.2.2.1.1.3.cmml"><mrow id="A1.E45.m1.2.2.1.1.1.1" xref="A1.E45.m1.2.2.1.1.1.1.cmml"><mi id="A1.E45.m1.2.2.1.1.1.1.3" xref="A1.E45.m1.2.2.1.1.1.1.3.cmml">α</mi><mo id="A1.E45.m1.2.2.1.1.1.1.2" xref="A1.E45.m1.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E45.m1.2.2.1.1.1.1.1" xref="A1.E45.m1.2.2.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A1.E45.m1.2.2.1.1.1.1.1.2" xref="A1.E45.m1.2.2.1.1.1.1.1.2.cmml"><munderover id="A1.E45.m1.2.2.1.1.1.1.1.2a" xref="A1.E45.m1.2.2.1.1.1.1.1.2.cmml"><mo id="A1.E45.m1.2.2.1.1.1.1.1.2.2.2" movablelimits="false" xref="A1.E45.m1.2.2.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="A1.E45.m1.2.2.1.1.1.1.1.2.2.3" xref="A1.E45.m1.2.2.1.1.1.1.1.2.2.3.cmml"><mi id="A1.E45.m1.2.2.1.1.1.1.1.2.2.3.2" xref="A1.E45.m1.2.2.1.1.1.1.1.2.2.3.2.cmml">j</mi><mo id="A1.E45.m1.2.2.1.1.1.1.1.2.2.3.1" xref="A1.E45.m1.2.2.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="A1.E45.m1.2.2.1.1.1.1.1.2.2.3.3" xref="A1.E45.m1.2.2.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="A1.E45.m1.2.2.1.1.1.1.1.2.3" xref="A1.E45.m1.2.2.1.1.1.1.1.2.3.cmml">J</mi></munderover></mstyle><mrow id="A1.E45.m1.2.2.1.1.1.1.1.1" xref="A1.E45.m1.2.2.1.1.1.1.1.1.cmml"><msub id="A1.E45.m1.2.2.1.1.1.1.1.1.3" xref="A1.E45.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="A1.E45.m1.2.2.1.1.1.1.1.1.3.2" xref="A1.E45.m1.2.2.1.1.1.1.1.1.3.2.cmml">w</mi><mi id="A1.E45.m1.2.2.1.1.1.1.1.1.3.3" xref="A1.E45.m1.2.2.1.1.1.1.1.1.3.3.cmml">j</mi></msub><mo id="A1.E45.m1.2.2.1.1.1.1.1.1.2" xref="A1.E45.m1.2.2.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="A1.E45.m1.2.2.1.1.1.1.1.1.4" xref="A1.E45.m1.2.2.1.1.1.1.1.1.4.cmml">P</mi><mo id="A1.E45.m1.2.2.1.1.1.1.1.1.2a" xref="A1.E45.m1.2.2.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E45.m1.2.2.1.1.1.1.1.1.1.1" xref="A1.E45.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E45.m1.2.2.1.1.1.1.1.1.1.1.2" xref="A1.E45.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A1.E45.m1.2.2.1.1.1.1.1.1.1.1.1" xref="A1.E45.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E45.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="A1.E45.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">X</mi><mi id="A1.E45.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="A1.E45.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="A1.E45.m1.2.2.1.1.1.1.1.1.1.1.3" xref="A1.E45.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A1.E45.m1.2.2.1.1.3.4" xref="A1.E45.m1.2.2.1.1.3.4.cmml">−</mo><mrow id="A1.E45.m1.2.2.1.1.3.3" xref="A1.E45.m1.2.2.1.1.3.3.cmml"><mi id="A1.E45.m1.2.2.1.1.3.3.4" xref="A1.E45.m1.2.2.1.1.3.3.4.cmml">log</mi><mo id="A1.E45.m1.2.2.1.1.3.3.3" lspace="0.167em" xref="A1.E45.m1.2.2.1.1.3.3.3.cmml">⁢</mo><mrow id="A1.E45.m1.2.2.1.1.3.3.2" xref="A1.E45.m1.2.2.1.1.3.3.2.cmml"><mstyle displaystyle="true" id="A1.E45.m1.2.2.1.1.3.3.2.3" xref="A1.E45.m1.2.2.1.1.3.3.2.3.cmml"><munderover id="A1.E45.m1.2.2.1.1.3.3.2.3a" xref="A1.E45.m1.2.2.1.1.3.3.2.3.cmml"><mo id="A1.E45.m1.2.2.1.1.3.3.2.3.2.2" movablelimits="false" xref="A1.E45.m1.2.2.1.1.3.3.2.3.2.2.cmml">∑</mo><mrow id="A1.E45.m1.2.2.1.1.3.3.2.3.2.3" xref="A1.E45.m1.2.2.1.1.3.3.2.3.2.3.cmml"><mi id="A1.E45.m1.2.2.1.1.3.3.2.3.2.3.2" xref="A1.E45.m1.2.2.1.1.3.3.2.3.2.3.2.cmml">j</mi><mo id="A1.E45.m1.2.2.1.1.3.3.2.3.2.3.1" xref="A1.E45.m1.2.2.1.1.3.3.2.3.2.3.1.cmml">=</mo><mn id="A1.E45.m1.2.2.1.1.3.3.2.3.2.3.3" xref="A1.E45.m1.2.2.1.1.3.3.2.3.2.3.3.cmml">1</mn></mrow><mi id="A1.E45.m1.2.2.1.1.3.3.2.3.3" xref="A1.E45.m1.2.2.1.1.3.3.2.3.3.cmml">J</mi></munderover></mstyle><mrow id="A1.E45.m1.2.2.1.1.3.3.2.2" xref="A1.E45.m1.2.2.1.1.3.3.2.2.cmml"><msub id="A1.E45.m1.2.2.1.1.3.3.2.2.4" xref="A1.E45.m1.2.2.1.1.3.3.2.2.4.cmml"><mi id="A1.E45.m1.2.2.1.1.3.3.2.2.4.2" xref="A1.E45.m1.2.2.1.1.3.3.2.2.4.2.cmml">Q</mi><mi id="A1.E45.m1.2.2.1.1.3.3.2.2.4.3" xref="A1.E45.m1.2.2.1.1.3.3.2.2.4.3.cmml">f</mi></msub><mo id="A1.E45.m1.2.2.1.1.3.3.2.2.3" xref="A1.E45.m1.2.2.1.1.3.3.2.2.3.cmml">⁢</mo><mrow id="A1.E45.m1.2.2.1.1.2.2.1.1.1.1" xref="A1.E45.m1.2.2.1.1.2.2.1.1.1.1.1.cmml"><mo id="A1.E45.m1.2.2.1.1.2.2.1.1.1.1.2" xref="A1.E45.m1.2.2.1.1.2.2.1.1.1.1.1.cmml">(</mo><msub id="A1.E45.m1.2.2.1.1.2.2.1.1.1.1.1" xref="A1.E45.m1.2.2.1.1.2.2.1.1.1.1.1.cmml"><mi id="A1.E45.m1.2.2.1.1.2.2.1.1.1.1.1.2" xref="A1.E45.m1.2.2.1.1.2.2.1.1.1.1.1.2.cmml">X</mi><mi id="A1.E45.m1.2.2.1.1.2.2.1.1.1.1.1.3" xref="A1.E45.m1.2.2.1.1.2.2.1.1.1.1.1.3.cmml">j</mi></msub><mo id="A1.E45.m1.2.2.1.1.2.2.1.1.1.1.3" xref="A1.E45.m1.2.2.1.1.2.2.1.1.1.1.1.cmml">)</mo></mrow><mo id="A1.E45.m1.2.2.1.1.3.3.2.2.3a" lspace="0.167em" xref="A1.E45.m1.2.2.1.1.3.3.2.2.3.cmml">⁢</mo><mrow id="A1.E45.m1.2.2.1.1.3.3.2.2.2.1" xref="A1.E45.m1.2.2.1.1.3.3.2.2.2.2.cmml"><mi id="A1.E45.m1.1.1" xref="A1.E45.m1.1.1.cmml">exp</mi><mo id="A1.E45.m1.2.2.1.1.3.3.2.2.2.1a" xref="A1.E45.m1.2.2.1.1.3.3.2.2.2.2.cmml">⁡</mo><mrow id="A1.E45.m1.2.2.1.1.3.3.2.2.2.1.1" xref="A1.E45.m1.2.2.1.1.3.3.2.2.2.2.cmml"><mo id="A1.E45.m1.2.2.1.1.3.3.2.2.2.1.1.2" xref="A1.E45.m1.2.2.1.1.3.3.2.2.2.2.cmml">(</mo><mrow id="A1.E45.m1.2.2.1.1.3.3.2.2.2.1.1.1" xref="A1.E45.m1.2.2.1.1.3.3.2.2.2.1.1.1.cmml"><mi id="A1.E45.m1.2.2.1.1.3.3.2.2.2.1.1.1.2" xref="A1.E45.m1.2.2.1.1.3.3.2.2.2.1.1.1.2.cmml">α</mi><mo id="A1.E45.m1.2.2.1.1.3.3.2.2.2.1.1.1.1" xref="A1.E45.m1.2.2.1.1.3.3.2.2.2.1.1.1.1.cmml">⁢</mo><msub id="A1.E45.m1.2.2.1.1.3.3.2.2.2.1.1.1.3" xref="A1.E45.m1.2.2.1.1.3.3.2.2.2.1.1.1.3.cmml"><mi id="A1.E45.m1.2.2.1.1.3.3.2.2.2.1.1.1.3.2" xref="A1.E45.m1.2.2.1.1.3.3.2.2.2.1.1.1.3.2.cmml">w</mi><mi id="A1.E45.m1.2.2.1.1.3.3.2.2.2.1.1.1.3.3" xref="A1.E45.m1.2.2.1.1.3.3.2.2.2.1.1.1.3.3.cmml">j</mi></msub></mrow><mo id="A1.E45.m1.2.2.1.1.3.3.2.2.2.1.1.3" rspace="0.170em" xref="A1.E45.m1.2.2.1.1.3.3.2.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow><mo id="A1.E45.m1.2.2.1.2" xref="A1.E45.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E45.m1.2b"><apply id="A1.E45.m1.2.2.1.1.cmml" xref="A1.E45.m1.2.2.1"><eq id="A1.E45.m1.2.2.1.1.4.cmml" xref="A1.E45.m1.2.2.1.1.4"></eq><csymbol cd="latexml" id="A1.E45.m1.2.2.1.1.5.cmml" xref="A1.E45.m1.2.2.1.1.5">absent</csymbol><apply id="A1.E45.m1.2.2.1.1.3.cmml" xref="A1.E45.m1.2.2.1.1.3"><minus id="A1.E45.m1.2.2.1.1.3.4.cmml" xref="A1.E45.m1.2.2.1.1.3.4"></minus><apply id="A1.E45.m1.2.2.1.1.1.1.cmml" xref="A1.E45.m1.2.2.1.1.1.1"><times id="A1.E45.m1.2.2.1.1.1.1.2.cmml" xref="A1.E45.m1.2.2.1.1.1.1.2"></times><ci id="A1.E45.m1.2.2.1.1.1.1.3.cmml" xref="A1.E45.m1.2.2.1.1.1.1.3">𝛼</ci><apply id="A1.E45.m1.2.2.1.1.1.1.1.cmml" xref="A1.E45.m1.2.2.1.1.1.1.1"><apply id="A1.E45.m1.2.2.1.1.1.1.1.2.cmml" xref="A1.E45.m1.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E45.m1.2.2.1.1.1.1.1.2.1.cmml" xref="A1.E45.m1.2.2.1.1.1.1.1.2">superscript</csymbol><apply id="A1.E45.m1.2.2.1.1.1.1.1.2.2.cmml" xref="A1.E45.m1.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E45.m1.2.2.1.1.1.1.1.2.2.1.cmml" xref="A1.E45.m1.2.2.1.1.1.1.1.2">subscript</csymbol><sum id="A1.E45.m1.2.2.1.1.1.1.1.2.2.2.cmml" xref="A1.E45.m1.2.2.1.1.1.1.1.2.2.2"></sum><apply id="A1.E45.m1.2.2.1.1.1.1.1.2.2.3.cmml" xref="A1.E45.m1.2.2.1.1.1.1.1.2.2.3"><eq id="A1.E45.m1.2.2.1.1.1.1.1.2.2.3.1.cmml" xref="A1.E45.m1.2.2.1.1.1.1.1.2.2.3.1"></eq><ci id="A1.E45.m1.2.2.1.1.1.1.1.2.2.3.2.cmml" xref="A1.E45.m1.2.2.1.1.1.1.1.2.2.3.2">𝑗</ci><cn id="A1.E45.m1.2.2.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="A1.E45.m1.2.2.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="A1.E45.m1.2.2.1.1.1.1.1.2.3.cmml" xref="A1.E45.m1.2.2.1.1.1.1.1.2.3">𝐽</ci></apply><apply id="A1.E45.m1.2.2.1.1.1.1.1.1.cmml" xref="A1.E45.m1.2.2.1.1.1.1.1.1"><times id="A1.E45.m1.2.2.1.1.1.1.1.1.2.cmml" xref="A1.E45.m1.2.2.1.1.1.1.1.1.2"></times><apply id="A1.E45.m1.2.2.1.1.1.1.1.1.3.cmml" xref="A1.E45.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E45.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="A1.E45.m1.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E45.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="A1.E45.m1.2.2.1.1.1.1.1.1.3.2">𝑤</ci><ci id="A1.E45.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="A1.E45.m1.2.2.1.1.1.1.1.1.3.3">𝑗</ci></apply><ci id="A1.E45.m1.2.2.1.1.1.1.1.1.4.cmml" xref="A1.E45.m1.2.2.1.1.1.1.1.1.4">𝑃</ci><apply id="A1.E45.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E45.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E45.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E45.m1.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E45.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E45.m1.2.2.1.1.1.1.1.1.1.1.1.2">𝑋</ci><ci id="A1.E45.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E45.m1.2.2.1.1.1.1.1.1.1.1.1.3">𝑗</ci></apply></apply></apply></apply><apply id="A1.E45.m1.2.2.1.1.3.3.cmml" xref="A1.E45.m1.2.2.1.1.3.3"><times id="A1.E45.m1.2.2.1.1.3.3.3.cmml" xref="A1.E45.m1.2.2.1.1.3.3.3"></times><log id="A1.E45.m1.2.2.1.1.3.3.4.cmml" xref="A1.E45.m1.2.2.1.1.3.3.4"></log><apply id="A1.E45.m1.2.2.1.1.3.3.2.cmml" xref="A1.E45.m1.2.2.1.1.3.3.2"><apply id="A1.E45.m1.2.2.1.1.3.3.2.3.cmml" xref="A1.E45.m1.2.2.1.1.3.3.2.3"><csymbol cd="ambiguous" id="A1.E45.m1.2.2.1.1.3.3.2.3.1.cmml" xref="A1.E45.m1.2.2.1.1.3.3.2.3">superscript</csymbol><apply id="A1.E45.m1.2.2.1.1.3.3.2.3.2.cmml" xref="A1.E45.m1.2.2.1.1.3.3.2.3"><csymbol cd="ambiguous" id="A1.E45.m1.2.2.1.1.3.3.2.3.2.1.cmml" xref="A1.E45.m1.2.2.1.1.3.3.2.3">subscript</csymbol><sum id="A1.E45.m1.2.2.1.1.3.3.2.3.2.2.cmml" xref="A1.E45.m1.2.2.1.1.3.3.2.3.2.2"></sum><apply id="A1.E45.m1.2.2.1.1.3.3.2.3.2.3.cmml" xref="A1.E45.m1.2.2.1.1.3.3.2.3.2.3"><eq id="A1.E45.m1.2.2.1.1.3.3.2.3.2.3.1.cmml" xref="A1.E45.m1.2.2.1.1.3.3.2.3.2.3.1"></eq><ci id="A1.E45.m1.2.2.1.1.3.3.2.3.2.3.2.cmml" xref="A1.E45.m1.2.2.1.1.3.3.2.3.2.3.2">𝑗</ci><cn id="A1.E45.m1.2.2.1.1.3.3.2.3.2.3.3.cmml" type="integer" xref="A1.E45.m1.2.2.1.1.3.3.2.3.2.3.3">1</cn></apply></apply><ci id="A1.E45.m1.2.2.1.1.3.3.2.3.3.cmml" xref="A1.E45.m1.2.2.1.1.3.3.2.3.3">𝐽</ci></apply><apply id="A1.E45.m1.2.2.1.1.3.3.2.2.cmml" xref="A1.E45.m1.2.2.1.1.3.3.2.2"><times id="A1.E45.m1.2.2.1.1.3.3.2.2.3.cmml" xref="A1.E45.m1.2.2.1.1.3.3.2.2.3"></times><apply id="A1.E45.m1.2.2.1.1.3.3.2.2.4.cmml" xref="A1.E45.m1.2.2.1.1.3.3.2.2.4"><csymbol cd="ambiguous" id="A1.E45.m1.2.2.1.1.3.3.2.2.4.1.cmml" xref="A1.E45.m1.2.2.1.1.3.3.2.2.4">subscript</csymbol><ci id="A1.E45.m1.2.2.1.1.3.3.2.2.4.2.cmml" xref="A1.E45.m1.2.2.1.1.3.3.2.2.4.2">𝑄</ci><ci id="A1.E45.m1.2.2.1.1.3.3.2.2.4.3.cmml" xref="A1.E45.m1.2.2.1.1.3.3.2.2.4.3">𝑓</ci></apply><apply id="A1.E45.m1.2.2.1.1.2.2.1.1.1.1.1.cmml" xref="A1.E45.m1.2.2.1.1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="A1.E45.m1.2.2.1.1.2.2.1.1.1.1.1.1.cmml" xref="A1.E45.m1.2.2.1.1.2.2.1.1.1.1">subscript</csymbol><ci id="A1.E45.m1.2.2.1.1.2.2.1.1.1.1.1.2.cmml" xref="A1.E45.m1.2.2.1.1.2.2.1.1.1.1.1.2">𝑋</ci><ci id="A1.E45.m1.2.2.1.1.2.2.1.1.1.1.1.3.cmml" xref="A1.E45.m1.2.2.1.1.2.2.1.1.1.1.1.3">𝑗</ci></apply><apply id="A1.E45.m1.2.2.1.1.3.3.2.2.2.2.cmml" xref="A1.E45.m1.2.2.1.1.3.3.2.2.2.1"><exp id="A1.E45.m1.1.1.cmml" xref="A1.E45.m1.1.1"></exp><apply id="A1.E45.m1.2.2.1.1.3.3.2.2.2.1.1.1.cmml" xref="A1.E45.m1.2.2.1.1.3.3.2.2.2.1.1.1"><times id="A1.E45.m1.2.2.1.1.3.3.2.2.2.1.1.1.1.cmml" xref="A1.E45.m1.2.2.1.1.3.3.2.2.2.1.1.1.1"></times><ci id="A1.E45.m1.2.2.1.1.3.3.2.2.2.1.1.1.2.cmml" xref="A1.E45.m1.2.2.1.1.3.3.2.2.2.1.1.1.2">𝛼</ci><apply id="A1.E45.m1.2.2.1.1.3.3.2.2.2.1.1.1.3.cmml" xref="A1.E45.m1.2.2.1.1.3.3.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="A1.E45.m1.2.2.1.1.3.3.2.2.2.1.1.1.3.1.cmml" xref="A1.E45.m1.2.2.1.1.3.3.2.2.2.1.1.1.3">subscript</csymbol><ci id="A1.E45.m1.2.2.1.1.3.3.2.2.2.1.1.1.3.2.cmml" xref="A1.E45.m1.2.2.1.1.3.3.2.2.2.1.1.1.3.2">𝑤</ci><ci id="A1.E45.m1.2.2.1.1.3.3.2.2.2.1.1.1.3.3.cmml" xref="A1.E45.m1.2.2.1.1.3.3.2.2.2.1.1.1.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E45.m1.2c">\displaystyle=\alpha\sum_{j=1}^{J}w_{j}P\left(X_{j}\right)-\log\sum_{j=1}^{J}Q%
_{f}\left(X_{j}\right)\exp\left(\alpha w_{j}\right)\,,</annotation><annotation encoding="application/x-llamapun" id="A1.E45.m1.2d">= italic_α ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_J end_POSTSUPERSCRIPT italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_P ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) - roman_log ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_J end_POSTSUPERSCRIPT italic_Q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) roman_exp ( italic_α italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(45)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS1.p2.2">where in equation <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A1.E44" title="In A.1 Application to Piecewise Constant Functions ‣ Appendix A Theory ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">44</span></a> we made use of the equality:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A5.EGx11">
<tbody id="A1.E46"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\log Z[f+\alpha\cdot\delta f]-\log Z[f]=\log\frac{\sum_{\mathbf{x%
}}\exp(f(\mathbf{x})+\alpha\delta f(\mathbf{x}))}{Z[f]}=\log\sum_{\mathbf{x}}q%
_{f}(\mathbf{x})\exp(\alpha\delta f(\mathbf{x}))\,," class="ltx_Math" display="inline" id="A1.E46.m1.10"><semantics id="A1.E46.m1.10a"><mrow id="A1.E46.m1.10.10.1" xref="A1.E46.m1.10.10.1.1.cmml"><mrow id="A1.E46.m1.10.10.1.1" xref="A1.E46.m1.10.10.1.1.cmml"><mrow id="A1.E46.m1.10.10.1.1.1" xref="A1.E46.m1.10.10.1.1.1.cmml"><mrow id="A1.E46.m1.10.10.1.1.1.1" xref="A1.E46.m1.10.10.1.1.1.1.cmml"><mrow id="A1.E46.m1.10.10.1.1.1.1.3" xref="A1.E46.m1.10.10.1.1.1.1.3.cmml"><mi id="A1.E46.m1.10.10.1.1.1.1.3.1" xref="A1.E46.m1.10.10.1.1.1.1.3.1.cmml">log</mi><mo id="A1.E46.m1.10.10.1.1.1.1.3a" lspace="0.167em" xref="A1.E46.m1.10.10.1.1.1.1.3.cmml">⁡</mo><mi id="A1.E46.m1.10.10.1.1.1.1.3.2" xref="A1.E46.m1.10.10.1.1.1.1.3.2.cmml">Z</mi></mrow><mo id="A1.E46.m1.10.10.1.1.1.1.2" xref="A1.E46.m1.10.10.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E46.m1.10.10.1.1.1.1.1.1" xref="A1.E46.m1.10.10.1.1.1.1.1.2.cmml"><mo id="A1.E46.m1.10.10.1.1.1.1.1.1.2" stretchy="false" xref="A1.E46.m1.10.10.1.1.1.1.1.2.1.cmml">[</mo><mrow id="A1.E46.m1.10.10.1.1.1.1.1.1.1" xref="A1.E46.m1.10.10.1.1.1.1.1.1.1.cmml"><mi id="A1.E46.m1.10.10.1.1.1.1.1.1.1.2" xref="A1.E46.m1.10.10.1.1.1.1.1.1.1.2.cmml">f</mi><mo id="A1.E46.m1.10.10.1.1.1.1.1.1.1.1" xref="A1.E46.m1.10.10.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="A1.E46.m1.10.10.1.1.1.1.1.1.1.3" xref="A1.E46.m1.10.10.1.1.1.1.1.1.1.3.cmml"><mrow id="A1.E46.m1.10.10.1.1.1.1.1.1.1.3.2" xref="A1.E46.m1.10.10.1.1.1.1.1.1.1.3.2.cmml"><mi id="A1.E46.m1.10.10.1.1.1.1.1.1.1.3.2.2" xref="A1.E46.m1.10.10.1.1.1.1.1.1.1.3.2.2.cmml">α</mi><mo id="A1.E46.m1.10.10.1.1.1.1.1.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="A1.E46.m1.10.10.1.1.1.1.1.1.1.3.2.1.cmml">⋅</mo><mi id="A1.E46.m1.10.10.1.1.1.1.1.1.1.3.2.3" xref="A1.E46.m1.10.10.1.1.1.1.1.1.1.3.2.3.cmml">δ</mi></mrow><mo id="A1.E46.m1.10.10.1.1.1.1.1.1.1.3.1" xref="A1.E46.m1.10.10.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="A1.E46.m1.10.10.1.1.1.1.1.1.1.3.3" xref="A1.E46.m1.10.10.1.1.1.1.1.1.1.3.3.cmml">f</mi></mrow></mrow><mo id="A1.E46.m1.10.10.1.1.1.1.1.1.3" stretchy="false" xref="A1.E46.m1.10.10.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="A1.E46.m1.10.10.1.1.1.2" xref="A1.E46.m1.10.10.1.1.1.2.cmml">−</mo><mrow id="A1.E46.m1.10.10.1.1.1.3" xref="A1.E46.m1.10.10.1.1.1.3.cmml"><mrow id="A1.E46.m1.10.10.1.1.1.3.2" xref="A1.E46.m1.10.10.1.1.1.3.2.cmml"><mi id="A1.E46.m1.10.10.1.1.1.3.2.1" xref="A1.E46.m1.10.10.1.1.1.3.2.1.cmml">log</mi><mo id="A1.E46.m1.10.10.1.1.1.3.2a" lspace="0.167em" xref="A1.E46.m1.10.10.1.1.1.3.2.cmml">⁡</mo><mi id="A1.E46.m1.10.10.1.1.1.3.2.2" xref="A1.E46.m1.10.10.1.1.1.3.2.2.cmml">Z</mi></mrow><mo id="A1.E46.m1.10.10.1.1.1.3.1" xref="A1.E46.m1.10.10.1.1.1.3.1.cmml">⁢</mo><mrow id="A1.E46.m1.10.10.1.1.1.3.3.2" xref="A1.E46.m1.10.10.1.1.1.3.3.1.cmml"><mo id="A1.E46.m1.10.10.1.1.1.3.3.2.1" stretchy="false" xref="A1.E46.m1.10.10.1.1.1.3.3.1.1.cmml">[</mo><mi id="A1.E46.m1.6.6" xref="A1.E46.m1.6.6.cmml">f</mi><mo id="A1.E46.m1.10.10.1.1.1.3.3.2.2" stretchy="false" xref="A1.E46.m1.10.10.1.1.1.3.3.1.1.cmml">]</mo></mrow></mrow></mrow><mo id="A1.E46.m1.10.10.1.1.4" xref="A1.E46.m1.10.10.1.1.4.cmml">=</mo><mrow id="A1.E46.m1.10.10.1.1.5" xref="A1.E46.m1.10.10.1.1.5.cmml"><mi id="A1.E46.m1.10.10.1.1.5.1" xref="A1.E46.m1.10.10.1.1.5.1.cmml">log</mi><mo id="A1.E46.m1.10.10.1.1.5a" lspace="0.167em" xref="A1.E46.m1.10.10.1.1.5.cmml">⁡</mo><mstyle displaystyle="true" id="A1.E46.m1.5.5" xref="A1.E46.m1.5.5.cmml"><mfrac id="A1.E46.m1.5.5a" xref="A1.E46.m1.5.5.cmml"><mrow id="A1.E46.m1.4.4.4" xref="A1.E46.m1.4.4.4.cmml"><msub id="A1.E46.m1.4.4.4.5" xref="A1.E46.m1.4.4.4.5.cmml"><mo id="A1.E46.m1.4.4.4.5.2" xref="A1.E46.m1.4.4.4.5.2.cmml">∑</mo><mi id="A1.E46.m1.4.4.4.5.3" xref="A1.E46.m1.4.4.4.5.3.cmml">𝐱</mi></msub><mrow id="A1.E46.m1.4.4.4.4.1" xref="A1.E46.m1.4.4.4.4.2.cmml"><mi id="A1.E46.m1.3.3.3.3" xref="A1.E46.m1.3.3.3.3.cmml">exp</mi><mo id="A1.E46.m1.4.4.4.4.1a" xref="A1.E46.m1.4.4.4.4.2.cmml">⁡</mo><mrow id="A1.E46.m1.4.4.4.4.1.1" xref="A1.E46.m1.4.4.4.4.2.cmml"><mo id="A1.E46.m1.4.4.4.4.1.1.2" stretchy="false" xref="A1.E46.m1.4.4.4.4.2.cmml">(</mo><mrow id="A1.E46.m1.4.4.4.4.1.1.1" xref="A1.E46.m1.4.4.4.4.1.1.1.cmml"><mrow id="A1.E46.m1.4.4.4.4.1.1.1.2" xref="A1.E46.m1.4.4.4.4.1.1.1.2.cmml"><mi id="A1.E46.m1.4.4.4.4.1.1.1.2.2" xref="A1.E46.m1.4.4.4.4.1.1.1.2.2.cmml">f</mi><mo id="A1.E46.m1.4.4.4.4.1.1.1.2.1" xref="A1.E46.m1.4.4.4.4.1.1.1.2.1.cmml">⁢</mo><mrow id="A1.E46.m1.4.4.4.4.1.1.1.2.3.2" xref="A1.E46.m1.4.4.4.4.1.1.1.2.cmml"><mo id="A1.E46.m1.4.4.4.4.1.1.1.2.3.2.1" stretchy="false" xref="A1.E46.m1.4.4.4.4.1.1.1.2.cmml">(</mo><mi id="A1.E46.m1.1.1.1.1" xref="A1.E46.m1.1.1.1.1.cmml">𝐱</mi><mo id="A1.E46.m1.4.4.4.4.1.1.1.2.3.2.2" stretchy="false" xref="A1.E46.m1.4.4.4.4.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.E46.m1.4.4.4.4.1.1.1.1" xref="A1.E46.m1.4.4.4.4.1.1.1.1.cmml">+</mo><mrow id="A1.E46.m1.4.4.4.4.1.1.1.3" xref="A1.E46.m1.4.4.4.4.1.1.1.3.cmml"><mi id="A1.E46.m1.4.4.4.4.1.1.1.3.2" xref="A1.E46.m1.4.4.4.4.1.1.1.3.2.cmml">α</mi><mo id="A1.E46.m1.4.4.4.4.1.1.1.3.1" xref="A1.E46.m1.4.4.4.4.1.1.1.3.1.cmml">⁢</mo><mi id="A1.E46.m1.4.4.4.4.1.1.1.3.3" xref="A1.E46.m1.4.4.4.4.1.1.1.3.3.cmml">δ</mi><mo id="A1.E46.m1.4.4.4.4.1.1.1.3.1a" xref="A1.E46.m1.4.4.4.4.1.1.1.3.1.cmml">⁢</mo><mi id="A1.E46.m1.4.4.4.4.1.1.1.3.4" xref="A1.E46.m1.4.4.4.4.1.1.1.3.4.cmml">f</mi><mo id="A1.E46.m1.4.4.4.4.1.1.1.3.1b" xref="A1.E46.m1.4.4.4.4.1.1.1.3.1.cmml">⁢</mo><mrow id="A1.E46.m1.4.4.4.4.1.1.1.3.5.2" xref="A1.E46.m1.4.4.4.4.1.1.1.3.cmml"><mo id="A1.E46.m1.4.4.4.4.1.1.1.3.5.2.1" stretchy="false" xref="A1.E46.m1.4.4.4.4.1.1.1.3.cmml">(</mo><mi id="A1.E46.m1.2.2.2.2" xref="A1.E46.m1.2.2.2.2.cmml">𝐱</mi><mo id="A1.E46.m1.4.4.4.4.1.1.1.3.5.2.2" stretchy="false" xref="A1.E46.m1.4.4.4.4.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E46.m1.4.4.4.4.1.1.3" stretchy="false" xref="A1.E46.m1.4.4.4.4.2.cmml">)</mo></mrow></mrow></mrow><mrow id="A1.E46.m1.5.5.5" xref="A1.E46.m1.5.5.5.cmml"><mi id="A1.E46.m1.5.5.5.3" xref="A1.E46.m1.5.5.5.3.cmml">Z</mi><mo id="A1.E46.m1.5.5.5.2" xref="A1.E46.m1.5.5.5.2.cmml">⁢</mo><mrow id="A1.E46.m1.5.5.5.4.2" xref="A1.E46.m1.5.5.5.4.1.cmml"><mo id="A1.E46.m1.5.5.5.4.2.1" stretchy="false" xref="A1.E46.m1.5.5.5.4.1.1.cmml">[</mo><mi id="A1.E46.m1.5.5.5.1" xref="A1.E46.m1.5.5.5.1.cmml">f</mi><mo id="A1.E46.m1.5.5.5.4.2.2" stretchy="false" xref="A1.E46.m1.5.5.5.4.1.1.cmml">]</mo></mrow></mrow></mfrac></mstyle></mrow><mo id="A1.E46.m1.10.10.1.1.6" xref="A1.E46.m1.10.10.1.1.6.cmml">=</mo><mrow id="A1.E46.m1.10.10.1.1.2" xref="A1.E46.m1.10.10.1.1.2.cmml"><mi id="A1.E46.m1.10.10.1.1.2.3" xref="A1.E46.m1.10.10.1.1.2.3.cmml">log</mi><mo id="A1.E46.m1.10.10.1.1.2.2" lspace="0.167em" xref="A1.E46.m1.10.10.1.1.2.2.cmml">⁢</mo><mrow id="A1.E46.m1.10.10.1.1.2.1" xref="A1.E46.m1.10.10.1.1.2.1.cmml"><mstyle displaystyle="true" id="A1.E46.m1.10.10.1.1.2.1.2" xref="A1.E46.m1.10.10.1.1.2.1.2.cmml"><munder id="A1.E46.m1.10.10.1.1.2.1.2a" xref="A1.E46.m1.10.10.1.1.2.1.2.cmml"><mo id="A1.E46.m1.10.10.1.1.2.1.2.2" movablelimits="false" xref="A1.E46.m1.10.10.1.1.2.1.2.2.cmml">∑</mo><mi id="A1.E46.m1.10.10.1.1.2.1.2.3" xref="A1.E46.m1.10.10.1.1.2.1.2.3.cmml">𝐱</mi></munder></mstyle><mrow id="A1.E46.m1.10.10.1.1.2.1.1" xref="A1.E46.m1.10.10.1.1.2.1.1.cmml"><msub id="A1.E46.m1.10.10.1.1.2.1.1.3" xref="A1.E46.m1.10.10.1.1.2.1.1.3.cmml"><mi id="A1.E46.m1.10.10.1.1.2.1.1.3.2" xref="A1.E46.m1.10.10.1.1.2.1.1.3.2.cmml">q</mi><mi id="A1.E46.m1.10.10.1.1.2.1.1.3.3" xref="A1.E46.m1.10.10.1.1.2.1.1.3.3.cmml">f</mi></msub><mo id="A1.E46.m1.10.10.1.1.2.1.1.2" xref="A1.E46.m1.10.10.1.1.2.1.1.2.cmml">⁢</mo><mrow id="A1.E46.m1.10.10.1.1.2.1.1.4.2" xref="A1.E46.m1.10.10.1.1.2.1.1.cmml"><mo id="A1.E46.m1.10.10.1.1.2.1.1.4.2.1" stretchy="false" xref="A1.E46.m1.10.10.1.1.2.1.1.cmml">(</mo><mi id="A1.E46.m1.7.7" xref="A1.E46.m1.7.7.cmml">𝐱</mi><mo id="A1.E46.m1.10.10.1.1.2.1.1.4.2.2" stretchy="false" xref="A1.E46.m1.10.10.1.1.2.1.1.cmml">)</mo></mrow><mo id="A1.E46.m1.10.10.1.1.2.1.1.2a" lspace="0.167em" xref="A1.E46.m1.10.10.1.1.2.1.1.2.cmml">⁢</mo><mrow id="A1.E46.m1.10.10.1.1.2.1.1.1.1" xref="A1.E46.m1.10.10.1.1.2.1.1.1.2.cmml"><mi id="A1.E46.m1.9.9" xref="A1.E46.m1.9.9.cmml">exp</mi><mo id="A1.E46.m1.10.10.1.1.2.1.1.1.1a" xref="A1.E46.m1.10.10.1.1.2.1.1.1.2.cmml">⁡</mo><mrow id="A1.E46.m1.10.10.1.1.2.1.1.1.1.1" xref="A1.E46.m1.10.10.1.1.2.1.1.1.2.cmml"><mo id="A1.E46.m1.10.10.1.1.2.1.1.1.1.1.2" stretchy="false" xref="A1.E46.m1.10.10.1.1.2.1.1.1.2.cmml">(</mo><mrow id="A1.E46.m1.10.10.1.1.2.1.1.1.1.1.1" xref="A1.E46.m1.10.10.1.1.2.1.1.1.1.1.1.cmml"><mi id="A1.E46.m1.10.10.1.1.2.1.1.1.1.1.1.2" xref="A1.E46.m1.10.10.1.1.2.1.1.1.1.1.1.2.cmml">α</mi><mo id="A1.E46.m1.10.10.1.1.2.1.1.1.1.1.1.1" xref="A1.E46.m1.10.10.1.1.2.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.E46.m1.10.10.1.1.2.1.1.1.1.1.1.3" xref="A1.E46.m1.10.10.1.1.2.1.1.1.1.1.1.3.cmml">δ</mi><mo id="A1.E46.m1.10.10.1.1.2.1.1.1.1.1.1.1a" xref="A1.E46.m1.10.10.1.1.2.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.E46.m1.10.10.1.1.2.1.1.1.1.1.1.4" xref="A1.E46.m1.10.10.1.1.2.1.1.1.1.1.1.4.cmml">f</mi><mo id="A1.E46.m1.10.10.1.1.2.1.1.1.1.1.1.1b" xref="A1.E46.m1.10.10.1.1.2.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="A1.E46.m1.10.10.1.1.2.1.1.1.1.1.1.5.2" xref="A1.E46.m1.10.10.1.1.2.1.1.1.1.1.1.cmml"><mo id="A1.E46.m1.10.10.1.1.2.1.1.1.1.1.1.5.2.1" stretchy="false" xref="A1.E46.m1.10.10.1.1.2.1.1.1.1.1.1.cmml">(</mo><mi id="A1.E46.m1.8.8" xref="A1.E46.m1.8.8.cmml">𝐱</mi><mo id="A1.E46.m1.10.10.1.1.2.1.1.1.1.1.1.5.2.2" stretchy="false" xref="A1.E46.m1.10.10.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E46.m1.10.10.1.1.2.1.1.1.1.1.3" rspace="0.170em" stretchy="false" xref="A1.E46.m1.10.10.1.1.2.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo id="A1.E46.m1.10.10.1.2" xref="A1.E46.m1.10.10.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E46.m1.10b"><apply id="A1.E46.m1.10.10.1.1.cmml" xref="A1.E46.m1.10.10.1"><and id="A1.E46.m1.10.10.1.1a.cmml" xref="A1.E46.m1.10.10.1"></and><apply id="A1.E46.m1.10.10.1.1b.cmml" xref="A1.E46.m1.10.10.1"><eq id="A1.E46.m1.10.10.1.1.4.cmml" xref="A1.E46.m1.10.10.1.1.4"></eq><apply id="A1.E46.m1.10.10.1.1.1.cmml" xref="A1.E46.m1.10.10.1.1.1"><minus id="A1.E46.m1.10.10.1.1.1.2.cmml" xref="A1.E46.m1.10.10.1.1.1.2"></minus><apply id="A1.E46.m1.10.10.1.1.1.1.cmml" xref="A1.E46.m1.10.10.1.1.1.1"><times id="A1.E46.m1.10.10.1.1.1.1.2.cmml" xref="A1.E46.m1.10.10.1.1.1.1.2"></times><apply id="A1.E46.m1.10.10.1.1.1.1.3.cmml" xref="A1.E46.m1.10.10.1.1.1.1.3"><log id="A1.E46.m1.10.10.1.1.1.1.3.1.cmml" xref="A1.E46.m1.10.10.1.1.1.1.3.1"></log><ci id="A1.E46.m1.10.10.1.1.1.1.3.2.cmml" xref="A1.E46.m1.10.10.1.1.1.1.3.2">𝑍</ci></apply><apply id="A1.E46.m1.10.10.1.1.1.1.1.2.cmml" xref="A1.E46.m1.10.10.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E46.m1.10.10.1.1.1.1.1.2.1.cmml" xref="A1.E46.m1.10.10.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A1.E46.m1.10.10.1.1.1.1.1.1.1.cmml" xref="A1.E46.m1.10.10.1.1.1.1.1.1.1"><plus id="A1.E46.m1.10.10.1.1.1.1.1.1.1.1.cmml" xref="A1.E46.m1.10.10.1.1.1.1.1.1.1.1"></plus><ci id="A1.E46.m1.10.10.1.1.1.1.1.1.1.2.cmml" xref="A1.E46.m1.10.10.1.1.1.1.1.1.1.2">𝑓</ci><apply id="A1.E46.m1.10.10.1.1.1.1.1.1.1.3.cmml" xref="A1.E46.m1.10.10.1.1.1.1.1.1.1.3"><times id="A1.E46.m1.10.10.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E46.m1.10.10.1.1.1.1.1.1.1.3.1"></times><apply id="A1.E46.m1.10.10.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E46.m1.10.10.1.1.1.1.1.1.1.3.2"><ci id="A1.E46.m1.10.10.1.1.1.1.1.1.1.3.2.1.cmml" xref="A1.E46.m1.10.10.1.1.1.1.1.1.1.3.2.1">⋅</ci><ci id="A1.E46.m1.10.10.1.1.1.1.1.1.1.3.2.2.cmml" xref="A1.E46.m1.10.10.1.1.1.1.1.1.1.3.2.2">𝛼</ci><ci id="A1.E46.m1.10.10.1.1.1.1.1.1.1.3.2.3.cmml" xref="A1.E46.m1.10.10.1.1.1.1.1.1.1.3.2.3">𝛿</ci></apply><ci id="A1.E46.m1.10.10.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E46.m1.10.10.1.1.1.1.1.1.1.3.3">𝑓</ci></apply></apply></apply></apply><apply id="A1.E46.m1.10.10.1.1.1.3.cmml" xref="A1.E46.m1.10.10.1.1.1.3"><times id="A1.E46.m1.10.10.1.1.1.3.1.cmml" xref="A1.E46.m1.10.10.1.1.1.3.1"></times><apply id="A1.E46.m1.10.10.1.1.1.3.2.cmml" xref="A1.E46.m1.10.10.1.1.1.3.2"><log id="A1.E46.m1.10.10.1.1.1.3.2.1.cmml" xref="A1.E46.m1.10.10.1.1.1.3.2.1"></log><ci id="A1.E46.m1.10.10.1.1.1.3.2.2.cmml" xref="A1.E46.m1.10.10.1.1.1.3.2.2">𝑍</ci></apply><apply id="A1.E46.m1.10.10.1.1.1.3.3.1.cmml" xref="A1.E46.m1.10.10.1.1.1.3.3.2"><csymbol cd="latexml" id="A1.E46.m1.10.10.1.1.1.3.3.1.1.cmml" xref="A1.E46.m1.10.10.1.1.1.3.3.2.1">delimited-[]</csymbol><ci id="A1.E46.m1.6.6.cmml" xref="A1.E46.m1.6.6">𝑓</ci></apply></apply></apply><apply id="A1.E46.m1.10.10.1.1.5.cmml" xref="A1.E46.m1.10.10.1.1.5"><log id="A1.E46.m1.10.10.1.1.5.1.cmml" xref="A1.E46.m1.10.10.1.1.5.1"></log><apply id="A1.E46.m1.5.5.cmml" xref="A1.E46.m1.5.5"><divide id="A1.E46.m1.5.5.6.cmml" xref="A1.E46.m1.5.5"></divide><apply id="A1.E46.m1.4.4.4.cmml" xref="A1.E46.m1.4.4.4"><apply id="A1.E46.m1.4.4.4.5.cmml" xref="A1.E46.m1.4.4.4.5"><csymbol cd="ambiguous" id="A1.E46.m1.4.4.4.5.1.cmml" xref="A1.E46.m1.4.4.4.5">subscript</csymbol><sum id="A1.E46.m1.4.4.4.5.2.cmml" xref="A1.E46.m1.4.4.4.5.2"></sum><ci id="A1.E46.m1.4.4.4.5.3.cmml" xref="A1.E46.m1.4.4.4.5.3">𝐱</ci></apply><apply id="A1.E46.m1.4.4.4.4.2.cmml" xref="A1.E46.m1.4.4.4.4.1"><exp id="A1.E46.m1.3.3.3.3.cmml" xref="A1.E46.m1.3.3.3.3"></exp><apply id="A1.E46.m1.4.4.4.4.1.1.1.cmml" xref="A1.E46.m1.4.4.4.4.1.1.1"><plus id="A1.E46.m1.4.4.4.4.1.1.1.1.cmml" xref="A1.E46.m1.4.4.4.4.1.1.1.1"></plus><apply id="A1.E46.m1.4.4.4.4.1.1.1.2.cmml" xref="A1.E46.m1.4.4.4.4.1.1.1.2"><times id="A1.E46.m1.4.4.4.4.1.1.1.2.1.cmml" xref="A1.E46.m1.4.4.4.4.1.1.1.2.1"></times><ci id="A1.E46.m1.4.4.4.4.1.1.1.2.2.cmml" xref="A1.E46.m1.4.4.4.4.1.1.1.2.2">𝑓</ci><ci id="A1.E46.m1.1.1.1.1.cmml" xref="A1.E46.m1.1.1.1.1">𝐱</ci></apply><apply id="A1.E46.m1.4.4.4.4.1.1.1.3.cmml" xref="A1.E46.m1.4.4.4.4.1.1.1.3"><times id="A1.E46.m1.4.4.4.4.1.1.1.3.1.cmml" xref="A1.E46.m1.4.4.4.4.1.1.1.3.1"></times><ci id="A1.E46.m1.4.4.4.4.1.1.1.3.2.cmml" xref="A1.E46.m1.4.4.4.4.1.1.1.3.2">𝛼</ci><ci id="A1.E46.m1.4.4.4.4.1.1.1.3.3.cmml" xref="A1.E46.m1.4.4.4.4.1.1.1.3.3">𝛿</ci><ci id="A1.E46.m1.4.4.4.4.1.1.1.3.4.cmml" xref="A1.E46.m1.4.4.4.4.1.1.1.3.4">𝑓</ci><ci id="A1.E46.m1.2.2.2.2.cmml" xref="A1.E46.m1.2.2.2.2">𝐱</ci></apply></apply></apply></apply><apply id="A1.E46.m1.5.5.5.cmml" xref="A1.E46.m1.5.5.5"><times id="A1.E46.m1.5.5.5.2.cmml" xref="A1.E46.m1.5.5.5.2"></times><ci id="A1.E46.m1.5.5.5.3.cmml" xref="A1.E46.m1.5.5.5.3">𝑍</ci><apply id="A1.E46.m1.5.5.5.4.1.cmml" xref="A1.E46.m1.5.5.5.4.2"><csymbol cd="latexml" id="A1.E46.m1.5.5.5.4.1.1.cmml" xref="A1.E46.m1.5.5.5.4.2.1">delimited-[]</csymbol><ci id="A1.E46.m1.5.5.5.1.cmml" xref="A1.E46.m1.5.5.5.1">𝑓</ci></apply></apply></apply></apply></apply><apply id="A1.E46.m1.10.10.1.1c.cmml" xref="A1.E46.m1.10.10.1"><eq id="A1.E46.m1.10.10.1.1.6.cmml" xref="A1.E46.m1.10.10.1.1.6"></eq><share href="https://arxiv.org/html/2410.03535v1#A1.E46.m1.10.10.1.1.5.cmml" id="A1.E46.m1.10.10.1.1d.cmml" xref="A1.E46.m1.10.10.1"></share><apply id="A1.E46.m1.10.10.1.1.2.cmml" xref="A1.E46.m1.10.10.1.1.2"><times id="A1.E46.m1.10.10.1.1.2.2.cmml" xref="A1.E46.m1.10.10.1.1.2.2"></times><log id="A1.E46.m1.10.10.1.1.2.3.cmml" xref="A1.E46.m1.10.10.1.1.2.3"></log><apply id="A1.E46.m1.10.10.1.1.2.1.cmml" xref="A1.E46.m1.10.10.1.1.2.1"><apply id="A1.E46.m1.10.10.1.1.2.1.2.cmml" xref="A1.E46.m1.10.10.1.1.2.1.2"><csymbol cd="ambiguous" id="A1.E46.m1.10.10.1.1.2.1.2.1.cmml" xref="A1.E46.m1.10.10.1.1.2.1.2">subscript</csymbol><sum id="A1.E46.m1.10.10.1.1.2.1.2.2.cmml" xref="A1.E46.m1.10.10.1.1.2.1.2.2"></sum><ci id="A1.E46.m1.10.10.1.1.2.1.2.3.cmml" xref="A1.E46.m1.10.10.1.1.2.1.2.3">𝐱</ci></apply><apply id="A1.E46.m1.10.10.1.1.2.1.1.cmml" xref="A1.E46.m1.10.10.1.1.2.1.1"><times id="A1.E46.m1.10.10.1.1.2.1.1.2.cmml" xref="A1.E46.m1.10.10.1.1.2.1.1.2"></times><apply id="A1.E46.m1.10.10.1.1.2.1.1.3.cmml" xref="A1.E46.m1.10.10.1.1.2.1.1.3"><csymbol cd="ambiguous" id="A1.E46.m1.10.10.1.1.2.1.1.3.1.cmml" xref="A1.E46.m1.10.10.1.1.2.1.1.3">subscript</csymbol><ci id="A1.E46.m1.10.10.1.1.2.1.1.3.2.cmml" xref="A1.E46.m1.10.10.1.1.2.1.1.3.2">𝑞</ci><ci id="A1.E46.m1.10.10.1.1.2.1.1.3.3.cmml" xref="A1.E46.m1.10.10.1.1.2.1.1.3.3">𝑓</ci></apply><ci id="A1.E46.m1.7.7.cmml" xref="A1.E46.m1.7.7">𝐱</ci><apply id="A1.E46.m1.10.10.1.1.2.1.1.1.2.cmml" xref="A1.E46.m1.10.10.1.1.2.1.1.1.1"><exp id="A1.E46.m1.9.9.cmml" xref="A1.E46.m1.9.9"></exp><apply id="A1.E46.m1.10.10.1.1.2.1.1.1.1.1.1.cmml" xref="A1.E46.m1.10.10.1.1.2.1.1.1.1.1.1"><times id="A1.E46.m1.10.10.1.1.2.1.1.1.1.1.1.1.cmml" xref="A1.E46.m1.10.10.1.1.2.1.1.1.1.1.1.1"></times><ci id="A1.E46.m1.10.10.1.1.2.1.1.1.1.1.1.2.cmml" xref="A1.E46.m1.10.10.1.1.2.1.1.1.1.1.1.2">𝛼</ci><ci id="A1.E46.m1.10.10.1.1.2.1.1.1.1.1.1.3.cmml" xref="A1.E46.m1.10.10.1.1.2.1.1.1.1.1.1.3">𝛿</ci><ci id="A1.E46.m1.10.10.1.1.2.1.1.1.1.1.1.4.cmml" xref="A1.E46.m1.10.10.1.1.2.1.1.1.1.1.1.4">𝑓</ci><ci id="A1.E46.m1.8.8.cmml" xref="A1.E46.m1.8.8">𝐱</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E46.m1.10c">\displaystyle\log Z[f+\alpha\cdot\delta f]-\log Z[f]=\log\frac{\sum_{\mathbf{x%
}}\exp(f(\mathbf{x})+\alpha\delta f(\mathbf{x}))}{Z[f]}=\log\sum_{\mathbf{x}}q%
_{f}(\mathbf{x})\exp(\alpha\delta f(\mathbf{x}))\,,</annotation><annotation encoding="application/x-llamapun" id="A1.E46.m1.10d">roman_log italic_Z [ italic_f + italic_α ⋅ italic_δ italic_f ] - roman_log italic_Z [ italic_f ] = roman_log divide start_ARG ∑ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT roman_exp ( italic_f ( bold_x ) + italic_α italic_δ italic_f ( bold_x ) ) end_ARG start_ARG italic_Z [ italic_f ] end_ARG = roman_log ∑ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT italic_q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT ( bold_x ) roman_exp ( italic_α italic_δ italic_f ( bold_x ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(46)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS1.p2.3">and of the result in equation <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A1.E41" title="In A.1 Application to Piecewise Constant Functions ‣ Appendix A Theory ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">41</span></a> in the final step.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS1.p3">
<p class="ltx_p" id="A1.SS1.p3.1">This result can be used to conduct a line search over the step size using training data and to estimate an increase in likelihood at each round of boosting for the purpose of early stopping, using validation data.</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>A Simple Lower Bound on the Likelihood Increase</h3>
<div class="ltx_para ltx_noindent" id="A1.SS2.p1">
<p class="ltx_p" id="A1.SS2.p1.1">We can take the results from the last subsection to show that each boosting round improves the likelihood of the model under ideal conditions.
Substituting the NRGBoost leaf values <math alttext="w_{j}=\nicefrac{{P(X_{j})}}{{Q_{f}(X_{j})}}-1" class="ltx_Math" display="inline" id="A1.SS2.p1.1.m1.2"><semantics id="A1.SS2.p1.1.m1.2a"><mrow id="A1.SS2.p1.1.m1.2.3" xref="A1.SS2.p1.1.m1.2.3.cmml"><msub id="A1.SS2.p1.1.m1.2.3.2" xref="A1.SS2.p1.1.m1.2.3.2.cmml"><mi id="A1.SS2.p1.1.m1.2.3.2.2" xref="A1.SS2.p1.1.m1.2.3.2.2.cmml">w</mi><mi id="A1.SS2.p1.1.m1.2.3.2.3" xref="A1.SS2.p1.1.m1.2.3.2.3.cmml">j</mi></msub><mo id="A1.SS2.p1.1.m1.2.3.1" xref="A1.SS2.p1.1.m1.2.3.1.cmml">=</mo><mrow id="A1.SS2.p1.1.m1.2.3.3" xref="A1.SS2.p1.1.m1.2.3.3.cmml"><mrow id="A1.SS2.p1.1.m1.2.2" xref="A1.SS2.p1.1.m1.2.2.cmml"><mpadded id="A1.SS2.p1.1.m1.1.1.1" voffset="0.3em" xref="A1.SS2.p1.1.m1.1.1.1.cmml"><mi id="A1.SS2.p1.1.m1.1.1.1.3" mathsize="70%" xref="A1.SS2.p1.1.m1.1.1.1.3.cmml">P</mi><mo id="A1.SS2.p1.1.m1.1.1.1.2" xref="A1.SS2.p1.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="A1.SS2.p1.1.m1.1.1.1.1.1" xref="A1.SS2.p1.1.m1.1.1.1.1.1.1.cmml"><mo id="A1.SS2.p1.1.m1.1.1.1.1.1.2" maxsize="70%" minsize="70%" xref="A1.SS2.p1.1.m1.1.1.1.1.1.1.cmml">(</mo><msub id="A1.SS2.p1.1.m1.1.1.1.1.1.1" xref="A1.SS2.p1.1.m1.1.1.1.1.1.1.cmml"><mi id="A1.SS2.p1.1.m1.1.1.1.1.1.1.2" mathsize="70%" xref="A1.SS2.p1.1.m1.1.1.1.1.1.1.2.cmml">X</mi><mi id="A1.SS2.p1.1.m1.1.1.1.1.1.1.3" mathsize="71%" xref="A1.SS2.p1.1.m1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="A1.SS2.p1.1.m1.1.1.1.1.1.3" maxsize="70%" minsize="70%" xref="A1.SS2.p1.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mpadded><mpadded id="A1.SS2.p1.1.m1.2.2.3" lspace="-0.1em" width="-0.15em" xref="A1.SS2.p1.1.m1.2.2.3.cmml"><mo id="A1.SS2.p1.1.m1.2.2.3a" stretchy="true" symmetric="true" xref="A1.SS2.p1.1.m1.2.2.3.cmml">/</mo></mpadded><mrow id="A1.SS2.p1.1.m1.2.2.2" xref="A1.SS2.p1.1.m1.2.2.2.cmml"><msub id="A1.SS2.p1.1.m1.2.2.2.3" xref="A1.SS2.p1.1.m1.2.2.2.3.cmml"><mi id="A1.SS2.p1.1.m1.2.2.2.3.2" mathsize="70%" xref="A1.SS2.p1.1.m1.2.2.2.3.2.cmml">Q</mi><mi id="A1.SS2.p1.1.m1.2.2.2.3.3" mathsize="71%" xref="A1.SS2.p1.1.m1.2.2.2.3.3.cmml">f</mi></msub><mo id="A1.SS2.p1.1.m1.2.2.2.2" xref="A1.SS2.p1.1.m1.2.2.2.2.cmml">⁢</mo><mrow id="A1.SS2.p1.1.m1.2.2.2.1.1" xref="A1.SS2.p1.1.m1.2.2.2.1.1.1.cmml"><mo id="A1.SS2.p1.1.m1.2.2.2.1.1.2" maxsize="70%" minsize="70%" xref="A1.SS2.p1.1.m1.2.2.2.1.1.1.cmml">(</mo><msub id="A1.SS2.p1.1.m1.2.2.2.1.1.1" xref="A1.SS2.p1.1.m1.2.2.2.1.1.1.cmml"><mi id="A1.SS2.p1.1.m1.2.2.2.1.1.1.2" mathsize="70%" xref="A1.SS2.p1.1.m1.2.2.2.1.1.1.2.cmml">X</mi><mi id="A1.SS2.p1.1.m1.2.2.2.1.1.1.3" mathsize="71%" xref="A1.SS2.p1.1.m1.2.2.2.1.1.1.3.cmml">j</mi></msub><mo id="A1.SS2.p1.1.m1.2.2.2.1.1.3" maxsize="70%" minsize="70%" xref="A1.SS2.p1.1.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A1.SS2.p1.1.m1.2.3.3.1" xref="A1.SS2.p1.1.m1.2.3.3.1.cmml">−</mo><mn id="A1.SS2.p1.1.m1.2.3.3.2" xref="A1.SS2.p1.1.m1.2.3.3.2.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.1.m1.2b"><apply id="A1.SS2.p1.1.m1.2.3.cmml" xref="A1.SS2.p1.1.m1.2.3"><eq id="A1.SS2.p1.1.m1.2.3.1.cmml" xref="A1.SS2.p1.1.m1.2.3.1"></eq><apply id="A1.SS2.p1.1.m1.2.3.2.cmml" xref="A1.SS2.p1.1.m1.2.3.2"><csymbol cd="ambiguous" id="A1.SS2.p1.1.m1.2.3.2.1.cmml" xref="A1.SS2.p1.1.m1.2.3.2">subscript</csymbol><ci id="A1.SS2.p1.1.m1.2.3.2.2.cmml" xref="A1.SS2.p1.1.m1.2.3.2.2">𝑤</ci><ci id="A1.SS2.p1.1.m1.2.3.2.3.cmml" xref="A1.SS2.p1.1.m1.2.3.2.3">𝑗</ci></apply><apply id="A1.SS2.p1.1.m1.2.3.3.cmml" xref="A1.SS2.p1.1.m1.2.3.3"><minus id="A1.SS2.p1.1.m1.2.3.3.1.cmml" xref="A1.SS2.p1.1.m1.2.3.3.1"></minus><apply id="A1.SS2.p1.1.m1.2.2.cmml" xref="A1.SS2.p1.1.m1.2.2"><divide id="A1.SS2.p1.1.m1.2.2.3.cmml" xref="A1.SS2.p1.1.m1.2.2.3"></divide><apply id="A1.SS2.p1.1.m1.1.1.1.cmml" xref="A1.SS2.p1.1.m1.1.1.1"><times id="A1.SS2.p1.1.m1.1.1.1.2.cmml" xref="A1.SS2.p1.1.m1.1.1.1.2"></times><ci id="A1.SS2.p1.1.m1.1.1.1.3.cmml" xref="A1.SS2.p1.1.m1.1.1.1.3">𝑃</ci><apply id="A1.SS2.p1.1.m1.1.1.1.1.1.1.cmml" xref="A1.SS2.p1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="A1.SS2.p1.1.m1.1.1.1.1.1">subscript</csymbol><ci id="A1.SS2.p1.1.m1.1.1.1.1.1.1.2.cmml" xref="A1.SS2.p1.1.m1.1.1.1.1.1.1.2">𝑋</ci><ci id="A1.SS2.p1.1.m1.1.1.1.1.1.1.3.cmml" xref="A1.SS2.p1.1.m1.1.1.1.1.1.1.3">𝑗</ci></apply></apply><apply id="A1.SS2.p1.1.m1.2.2.2.cmml" xref="A1.SS2.p1.1.m1.2.2.2"><times id="A1.SS2.p1.1.m1.2.2.2.2.cmml" xref="A1.SS2.p1.1.m1.2.2.2.2"></times><apply id="A1.SS2.p1.1.m1.2.2.2.3.cmml" xref="A1.SS2.p1.1.m1.2.2.2.3"><csymbol cd="ambiguous" id="A1.SS2.p1.1.m1.2.2.2.3.1.cmml" xref="A1.SS2.p1.1.m1.2.2.2.3">subscript</csymbol><ci id="A1.SS2.p1.1.m1.2.2.2.3.2.cmml" xref="A1.SS2.p1.1.m1.2.2.2.3.2">𝑄</ci><ci id="A1.SS2.p1.1.m1.2.2.2.3.3.cmml" xref="A1.SS2.p1.1.m1.2.2.2.3.3">𝑓</ci></apply><apply id="A1.SS2.p1.1.m1.2.2.2.1.1.1.cmml" xref="A1.SS2.p1.1.m1.2.2.2.1.1"><csymbol cd="ambiguous" id="A1.SS2.p1.1.m1.2.2.2.1.1.1.1.cmml" xref="A1.SS2.p1.1.m1.2.2.2.1.1">subscript</csymbol><ci id="A1.SS2.p1.1.m1.2.2.2.1.1.1.2.cmml" xref="A1.SS2.p1.1.m1.2.2.2.1.1.1.2">𝑋</ci><ci id="A1.SS2.p1.1.m1.2.2.2.1.1.1.3.cmml" xref="A1.SS2.p1.1.m1.2.2.2.1.1.1.3">𝑗</ci></apply></apply></apply><cn id="A1.SS2.p1.1.m1.2.3.3.2.cmml" type="integer" xref="A1.SS2.p1.1.m1.2.3.3.2">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.1.m1.2c">w_{j}=\nicefrac{{P(X_{j})}}{{Q_{f}(X_{j})}}-1</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.1.m1.2d">italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = / start_ARG italic_P ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG start_ARG italic_Q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG - 1</annotation></semantics></math> in Equation <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A1.E45" title="In A.1 Application to Piecewise Constant Functions ‣ Appendix A Theory ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">45</span></a> we get:</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS2.p2">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A5.EGx12">
<tbody id="A1.E47"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle L[f+\alpha\cdot\delta f]-L[f]" class="ltx_Math" display="inline" id="A1.E47.m1.2"><semantics id="A1.E47.m1.2a"><mrow id="A1.E47.m1.2.2" xref="A1.E47.m1.2.2.cmml"><mrow id="A1.E47.m1.2.2.1" xref="A1.E47.m1.2.2.1.cmml"><mi id="A1.E47.m1.2.2.1.3" xref="A1.E47.m1.2.2.1.3.cmml">L</mi><mo id="A1.E47.m1.2.2.1.2" xref="A1.E47.m1.2.2.1.2.cmml">⁢</mo><mrow id="A1.E47.m1.2.2.1.1.1" xref="A1.E47.m1.2.2.1.1.2.cmml"><mo id="A1.E47.m1.2.2.1.1.1.2" stretchy="false" xref="A1.E47.m1.2.2.1.1.2.1.cmml">[</mo><mrow id="A1.E47.m1.2.2.1.1.1.1" xref="A1.E47.m1.2.2.1.1.1.1.cmml"><mi id="A1.E47.m1.2.2.1.1.1.1.2" xref="A1.E47.m1.2.2.1.1.1.1.2.cmml">f</mi><mo id="A1.E47.m1.2.2.1.1.1.1.1" xref="A1.E47.m1.2.2.1.1.1.1.1.cmml">+</mo><mrow id="A1.E47.m1.2.2.1.1.1.1.3" xref="A1.E47.m1.2.2.1.1.1.1.3.cmml"><mrow id="A1.E47.m1.2.2.1.1.1.1.3.2" xref="A1.E47.m1.2.2.1.1.1.1.3.2.cmml"><mi id="A1.E47.m1.2.2.1.1.1.1.3.2.2" xref="A1.E47.m1.2.2.1.1.1.1.3.2.2.cmml">α</mi><mo id="A1.E47.m1.2.2.1.1.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="A1.E47.m1.2.2.1.1.1.1.3.2.1.cmml">⋅</mo><mi id="A1.E47.m1.2.2.1.1.1.1.3.2.3" xref="A1.E47.m1.2.2.1.1.1.1.3.2.3.cmml">δ</mi></mrow><mo id="A1.E47.m1.2.2.1.1.1.1.3.1" xref="A1.E47.m1.2.2.1.1.1.1.3.1.cmml">⁢</mo><mi id="A1.E47.m1.2.2.1.1.1.1.3.3" xref="A1.E47.m1.2.2.1.1.1.1.3.3.cmml">f</mi></mrow></mrow><mo id="A1.E47.m1.2.2.1.1.1.3" stretchy="false" xref="A1.E47.m1.2.2.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="A1.E47.m1.2.2.2" xref="A1.E47.m1.2.2.2.cmml">−</mo><mrow id="A1.E47.m1.2.2.3" xref="A1.E47.m1.2.2.3.cmml"><mi id="A1.E47.m1.2.2.3.2" xref="A1.E47.m1.2.2.3.2.cmml">L</mi><mo id="A1.E47.m1.2.2.3.1" xref="A1.E47.m1.2.2.3.1.cmml">⁢</mo><mrow id="A1.E47.m1.2.2.3.3.2" xref="A1.E47.m1.2.2.3.3.1.cmml"><mo id="A1.E47.m1.2.2.3.3.2.1" stretchy="false" xref="A1.E47.m1.2.2.3.3.1.1.cmml">[</mo><mi id="A1.E47.m1.1.1" xref="A1.E47.m1.1.1.cmml">f</mi><mo id="A1.E47.m1.2.2.3.3.2.2" stretchy="false" xref="A1.E47.m1.2.2.3.3.1.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E47.m1.2b"><apply id="A1.E47.m1.2.2.cmml" xref="A1.E47.m1.2.2"><minus id="A1.E47.m1.2.2.2.cmml" xref="A1.E47.m1.2.2.2"></minus><apply id="A1.E47.m1.2.2.1.cmml" xref="A1.E47.m1.2.2.1"><times id="A1.E47.m1.2.2.1.2.cmml" xref="A1.E47.m1.2.2.1.2"></times><ci id="A1.E47.m1.2.2.1.3.cmml" xref="A1.E47.m1.2.2.1.3">𝐿</ci><apply id="A1.E47.m1.2.2.1.1.2.cmml" xref="A1.E47.m1.2.2.1.1.1"><csymbol cd="latexml" id="A1.E47.m1.2.2.1.1.2.1.cmml" xref="A1.E47.m1.2.2.1.1.1.2">delimited-[]</csymbol><apply id="A1.E47.m1.2.2.1.1.1.1.cmml" xref="A1.E47.m1.2.2.1.1.1.1"><plus id="A1.E47.m1.2.2.1.1.1.1.1.cmml" xref="A1.E47.m1.2.2.1.1.1.1.1"></plus><ci id="A1.E47.m1.2.2.1.1.1.1.2.cmml" xref="A1.E47.m1.2.2.1.1.1.1.2">𝑓</ci><apply id="A1.E47.m1.2.2.1.1.1.1.3.cmml" xref="A1.E47.m1.2.2.1.1.1.1.3"><times id="A1.E47.m1.2.2.1.1.1.1.3.1.cmml" xref="A1.E47.m1.2.2.1.1.1.1.3.1"></times><apply id="A1.E47.m1.2.2.1.1.1.1.3.2.cmml" xref="A1.E47.m1.2.2.1.1.1.1.3.2"><ci id="A1.E47.m1.2.2.1.1.1.1.3.2.1.cmml" xref="A1.E47.m1.2.2.1.1.1.1.3.2.1">⋅</ci><ci id="A1.E47.m1.2.2.1.1.1.1.3.2.2.cmml" xref="A1.E47.m1.2.2.1.1.1.1.3.2.2">𝛼</ci><ci id="A1.E47.m1.2.2.1.1.1.1.3.2.3.cmml" xref="A1.E47.m1.2.2.1.1.1.1.3.2.3">𝛿</ci></apply><ci id="A1.E47.m1.2.2.1.1.1.1.3.3.cmml" xref="A1.E47.m1.2.2.1.1.1.1.3.3">𝑓</ci></apply></apply></apply></apply><apply id="A1.E47.m1.2.2.3.cmml" xref="A1.E47.m1.2.2.3"><times id="A1.E47.m1.2.2.3.1.cmml" xref="A1.E47.m1.2.2.3.1"></times><ci id="A1.E47.m1.2.2.3.2.cmml" xref="A1.E47.m1.2.2.3.2">𝐿</ci><apply id="A1.E47.m1.2.2.3.3.1.cmml" xref="A1.E47.m1.2.2.3.3.2"><csymbol cd="latexml" id="A1.E47.m1.2.2.3.3.1.1.cmml" xref="A1.E47.m1.2.2.3.3.2.1">delimited-[]</csymbol><ci id="A1.E47.m1.1.1.cmml" xref="A1.E47.m1.1.1">𝑓</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E47.m1.2c">\displaystyle L[f+\alpha\cdot\delta f]-L[f]</annotation><annotation encoding="application/x-llamapun" id="A1.E47.m1.2d">italic_L [ italic_f + italic_α ⋅ italic_δ italic_f ] - italic_L [ italic_f ]</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\alpha\left[\sum_{j=1}^{J}\frac{P^{2}\left(X_{j}\right)}{Q_{f}(X%
_{j})}-1\right]-\log\sum_{j=1}^{J}Q_{f}\left(X_{j}\right)\exp\left[\alpha\left%
(\frac{P\left(X_{j}\right)}{Q_{f}(X_{j})}-1\right)\right]" class="ltx_Math" display="inline" id="A1.E47.m2.8"><semantics id="A1.E47.m2.8a"><mrow id="A1.E47.m2.8.8" xref="A1.E47.m2.8.8.cmml"><mi id="A1.E47.m2.8.8.5" xref="A1.E47.m2.8.8.5.cmml"></mi><mo id="A1.E47.m2.8.8.4" xref="A1.E47.m2.8.8.4.cmml">=</mo><mrow id="A1.E47.m2.8.8.3" xref="A1.E47.m2.8.8.3.cmml"><mrow id="A1.E47.m2.6.6.1.1" xref="A1.E47.m2.6.6.1.1.cmml"><mi id="A1.E47.m2.6.6.1.1.3" xref="A1.E47.m2.6.6.1.1.3.cmml">α</mi><mo id="A1.E47.m2.6.6.1.1.2" xref="A1.E47.m2.6.6.1.1.2.cmml">⁢</mo><mrow id="A1.E47.m2.6.6.1.1.1.1" xref="A1.E47.m2.6.6.1.1.1.2.cmml"><mo id="A1.E47.m2.6.6.1.1.1.1.2" xref="A1.E47.m2.6.6.1.1.1.2.1.cmml">[</mo><mrow id="A1.E47.m2.6.6.1.1.1.1.1" xref="A1.E47.m2.6.6.1.1.1.1.1.cmml"><mrow id="A1.E47.m2.6.6.1.1.1.1.1.2" xref="A1.E47.m2.6.6.1.1.1.1.1.2.cmml"><mstyle displaystyle="true" id="A1.E47.m2.6.6.1.1.1.1.1.2.1" xref="A1.E47.m2.6.6.1.1.1.1.1.2.1.cmml"><munderover id="A1.E47.m2.6.6.1.1.1.1.1.2.1a" xref="A1.E47.m2.6.6.1.1.1.1.1.2.1.cmml"><mo id="A1.E47.m2.6.6.1.1.1.1.1.2.1.2.2" movablelimits="false" xref="A1.E47.m2.6.6.1.1.1.1.1.2.1.2.2.cmml">∑</mo><mrow id="A1.E47.m2.6.6.1.1.1.1.1.2.1.2.3" xref="A1.E47.m2.6.6.1.1.1.1.1.2.1.2.3.cmml"><mi id="A1.E47.m2.6.6.1.1.1.1.1.2.1.2.3.2" xref="A1.E47.m2.6.6.1.1.1.1.1.2.1.2.3.2.cmml">j</mi><mo id="A1.E47.m2.6.6.1.1.1.1.1.2.1.2.3.1" xref="A1.E47.m2.6.6.1.1.1.1.1.2.1.2.3.1.cmml">=</mo><mn id="A1.E47.m2.6.6.1.1.1.1.1.2.1.2.3.3" xref="A1.E47.m2.6.6.1.1.1.1.1.2.1.2.3.3.cmml">1</mn></mrow><mi id="A1.E47.m2.6.6.1.1.1.1.1.2.1.3" xref="A1.E47.m2.6.6.1.1.1.1.1.2.1.3.cmml">J</mi></munderover></mstyle><mstyle displaystyle="true" id="A1.E47.m2.2.2" xref="A1.E47.m2.2.2.cmml"><mfrac id="A1.E47.m2.2.2a" xref="A1.E47.m2.2.2.cmml"><mrow id="A1.E47.m2.1.1.1" xref="A1.E47.m2.1.1.1.cmml"><msup id="A1.E47.m2.1.1.1.3" xref="A1.E47.m2.1.1.1.3.cmml"><mi id="A1.E47.m2.1.1.1.3.2" xref="A1.E47.m2.1.1.1.3.2.cmml">P</mi><mn id="A1.E47.m2.1.1.1.3.3" xref="A1.E47.m2.1.1.1.3.3.cmml">2</mn></msup><mo id="A1.E47.m2.1.1.1.2" xref="A1.E47.m2.1.1.1.2.cmml">⁢</mo><mrow id="A1.E47.m2.1.1.1.1.1" xref="A1.E47.m2.1.1.1.1.1.1.cmml"><mo id="A1.E47.m2.1.1.1.1.1.2" xref="A1.E47.m2.1.1.1.1.1.1.cmml">(</mo><msub id="A1.E47.m2.1.1.1.1.1.1" xref="A1.E47.m2.1.1.1.1.1.1.cmml"><mi id="A1.E47.m2.1.1.1.1.1.1.2" xref="A1.E47.m2.1.1.1.1.1.1.2.cmml">X</mi><mi id="A1.E47.m2.1.1.1.1.1.1.3" xref="A1.E47.m2.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="A1.E47.m2.1.1.1.1.1.3" xref="A1.E47.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.E47.m2.2.2.2" xref="A1.E47.m2.2.2.2.cmml"><msub id="A1.E47.m2.2.2.2.3" xref="A1.E47.m2.2.2.2.3.cmml"><mi id="A1.E47.m2.2.2.2.3.2" xref="A1.E47.m2.2.2.2.3.2.cmml">Q</mi><mi id="A1.E47.m2.2.2.2.3.3" xref="A1.E47.m2.2.2.2.3.3.cmml">f</mi></msub><mo id="A1.E47.m2.2.2.2.2" xref="A1.E47.m2.2.2.2.2.cmml">⁢</mo><mrow id="A1.E47.m2.2.2.2.1.1" xref="A1.E47.m2.2.2.2.1.1.1.cmml"><mo id="A1.E47.m2.2.2.2.1.1.2" stretchy="false" xref="A1.E47.m2.2.2.2.1.1.1.cmml">(</mo><msub id="A1.E47.m2.2.2.2.1.1.1" xref="A1.E47.m2.2.2.2.1.1.1.cmml"><mi id="A1.E47.m2.2.2.2.1.1.1.2" xref="A1.E47.m2.2.2.2.1.1.1.2.cmml">X</mi><mi id="A1.E47.m2.2.2.2.1.1.1.3" xref="A1.E47.m2.2.2.2.1.1.1.3.cmml">j</mi></msub><mo id="A1.E47.m2.2.2.2.1.1.3" stretchy="false" xref="A1.E47.m2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mstyle></mrow><mo id="A1.E47.m2.6.6.1.1.1.1.1.1" xref="A1.E47.m2.6.6.1.1.1.1.1.1.cmml">−</mo><mn id="A1.E47.m2.6.6.1.1.1.1.1.3" xref="A1.E47.m2.6.6.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="A1.E47.m2.6.6.1.1.1.1.3" xref="A1.E47.m2.6.6.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="A1.E47.m2.8.8.3.4" xref="A1.E47.m2.8.8.3.4.cmml">−</mo><mrow id="A1.E47.m2.8.8.3.3" xref="A1.E47.m2.8.8.3.3.cmml"><mi id="A1.E47.m2.8.8.3.3.4" xref="A1.E47.m2.8.8.3.3.4.cmml">log</mi><mo id="A1.E47.m2.8.8.3.3.3" lspace="0.167em" xref="A1.E47.m2.8.8.3.3.3.cmml">⁢</mo><mrow id="A1.E47.m2.8.8.3.3.2" xref="A1.E47.m2.8.8.3.3.2.cmml"><mstyle displaystyle="true" id="A1.E47.m2.8.8.3.3.2.3" xref="A1.E47.m2.8.8.3.3.2.3.cmml"><munderover id="A1.E47.m2.8.8.3.3.2.3a" xref="A1.E47.m2.8.8.3.3.2.3.cmml"><mo id="A1.E47.m2.8.8.3.3.2.3.2.2" movablelimits="false" xref="A1.E47.m2.8.8.3.3.2.3.2.2.cmml">∑</mo><mrow id="A1.E47.m2.8.8.3.3.2.3.2.3" xref="A1.E47.m2.8.8.3.3.2.3.2.3.cmml"><mi id="A1.E47.m2.8.8.3.3.2.3.2.3.2" xref="A1.E47.m2.8.8.3.3.2.3.2.3.2.cmml">j</mi><mo id="A1.E47.m2.8.8.3.3.2.3.2.3.1" xref="A1.E47.m2.8.8.3.3.2.3.2.3.1.cmml">=</mo><mn id="A1.E47.m2.8.8.3.3.2.3.2.3.3" xref="A1.E47.m2.8.8.3.3.2.3.2.3.3.cmml">1</mn></mrow><mi id="A1.E47.m2.8.8.3.3.2.3.3" xref="A1.E47.m2.8.8.3.3.2.3.3.cmml">J</mi></munderover></mstyle><mrow id="A1.E47.m2.8.8.3.3.2.2" xref="A1.E47.m2.8.8.3.3.2.2.cmml"><msub id="A1.E47.m2.8.8.3.3.2.2.4" xref="A1.E47.m2.8.8.3.3.2.2.4.cmml"><mi id="A1.E47.m2.8.8.3.3.2.2.4.2" xref="A1.E47.m2.8.8.3.3.2.2.4.2.cmml">Q</mi><mi id="A1.E47.m2.8.8.3.3.2.2.4.3" xref="A1.E47.m2.8.8.3.3.2.2.4.3.cmml">f</mi></msub><mo id="A1.E47.m2.8.8.3.3.2.2.3" xref="A1.E47.m2.8.8.3.3.2.2.3.cmml">⁢</mo><mrow id="A1.E47.m2.7.7.2.2.1.1.1.1" xref="A1.E47.m2.7.7.2.2.1.1.1.1.1.cmml"><mo id="A1.E47.m2.7.7.2.2.1.1.1.1.2" xref="A1.E47.m2.7.7.2.2.1.1.1.1.1.cmml">(</mo><msub id="A1.E47.m2.7.7.2.2.1.1.1.1.1" xref="A1.E47.m2.7.7.2.2.1.1.1.1.1.cmml"><mi id="A1.E47.m2.7.7.2.2.1.1.1.1.1.2" xref="A1.E47.m2.7.7.2.2.1.1.1.1.1.2.cmml">X</mi><mi id="A1.E47.m2.7.7.2.2.1.1.1.1.1.3" xref="A1.E47.m2.7.7.2.2.1.1.1.1.1.3.cmml">j</mi></msub><mo id="A1.E47.m2.7.7.2.2.1.1.1.1.3" xref="A1.E47.m2.7.7.2.2.1.1.1.1.1.cmml">)</mo></mrow><mo id="A1.E47.m2.8.8.3.3.2.2.3a" lspace="0.167em" xref="A1.E47.m2.8.8.3.3.2.2.3.cmml">⁢</mo><mrow id="A1.E47.m2.8.8.3.3.2.2.2.1" xref="A1.E47.m2.8.8.3.3.2.2.2.2.cmml"><mi id="A1.E47.m2.5.5" xref="A1.E47.m2.5.5.cmml">exp</mi><mo id="A1.E47.m2.8.8.3.3.2.2.2.1a" xref="A1.E47.m2.8.8.3.3.2.2.2.2.cmml">⁡</mo><mrow id="A1.E47.m2.8.8.3.3.2.2.2.1.1" xref="A1.E47.m2.8.8.3.3.2.2.2.2.cmml"><mo id="A1.E47.m2.8.8.3.3.2.2.2.1.1.2" xref="A1.E47.m2.8.8.3.3.2.2.2.2.cmml">[</mo><mrow id="A1.E47.m2.8.8.3.3.2.2.2.1.1.1" xref="A1.E47.m2.8.8.3.3.2.2.2.1.1.1.cmml"><mi id="A1.E47.m2.8.8.3.3.2.2.2.1.1.1.3" xref="A1.E47.m2.8.8.3.3.2.2.2.1.1.1.3.cmml">α</mi><mo id="A1.E47.m2.8.8.3.3.2.2.2.1.1.1.2" xref="A1.E47.m2.8.8.3.3.2.2.2.1.1.1.2.cmml">⁢</mo><mrow id="A1.E47.m2.8.8.3.3.2.2.2.1.1.1.1.1" xref="A1.E47.m2.8.8.3.3.2.2.2.1.1.1.1.1.1.cmml"><mo id="A1.E47.m2.8.8.3.3.2.2.2.1.1.1.1.1.2" xref="A1.E47.m2.8.8.3.3.2.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E47.m2.8.8.3.3.2.2.2.1.1.1.1.1.1" xref="A1.E47.m2.8.8.3.3.2.2.2.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A1.E47.m2.4.4" xref="A1.E47.m2.4.4.cmml"><mfrac id="A1.E47.m2.4.4a" xref="A1.E47.m2.4.4.cmml"><mrow id="A1.E47.m2.3.3.1" xref="A1.E47.m2.3.3.1.cmml"><mi id="A1.E47.m2.3.3.1.3" xref="A1.E47.m2.3.3.1.3.cmml">P</mi><mo id="A1.E47.m2.3.3.1.2" xref="A1.E47.m2.3.3.1.2.cmml">⁢</mo><mrow id="A1.E47.m2.3.3.1.1.1" xref="A1.E47.m2.3.3.1.1.1.1.cmml"><mo id="A1.E47.m2.3.3.1.1.1.2" xref="A1.E47.m2.3.3.1.1.1.1.cmml">(</mo><msub id="A1.E47.m2.3.3.1.1.1.1" xref="A1.E47.m2.3.3.1.1.1.1.cmml"><mi id="A1.E47.m2.3.3.1.1.1.1.2" xref="A1.E47.m2.3.3.1.1.1.1.2.cmml">X</mi><mi id="A1.E47.m2.3.3.1.1.1.1.3" xref="A1.E47.m2.3.3.1.1.1.1.3.cmml">j</mi></msub><mo id="A1.E47.m2.3.3.1.1.1.3" xref="A1.E47.m2.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.E47.m2.4.4.2" xref="A1.E47.m2.4.4.2.cmml"><msub id="A1.E47.m2.4.4.2.3" xref="A1.E47.m2.4.4.2.3.cmml"><mi id="A1.E47.m2.4.4.2.3.2" xref="A1.E47.m2.4.4.2.3.2.cmml">Q</mi><mi id="A1.E47.m2.4.4.2.3.3" xref="A1.E47.m2.4.4.2.3.3.cmml">f</mi></msub><mo id="A1.E47.m2.4.4.2.2" xref="A1.E47.m2.4.4.2.2.cmml">⁢</mo><mrow id="A1.E47.m2.4.4.2.1.1" xref="A1.E47.m2.4.4.2.1.1.1.cmml"><mo id="A1.E47.m2.4.4.2.1.1.2" stretchy="false" xref="A1.E47.m2.4.4.2.1.1.1.cmml">(</mo><msub id="A1.E47.m2.4.4.2.1.1.1" xref="A1.E47.m2.4.4.2.1.1.1.cmml"><mi id="A1.E47.m2.4.4.2.1.1.1.2" xref="A1.E47.m2.4.4.2.1.1.1.2.cmml">X</mi><mi id="A1.E47.m2.4.4.2.1.1.1.3" xref="A1.E47.m2.4.4.2.1.1.1.3.cmml">j</mi></msub><mo id="A1.E47.m2.4.4.2.1.1.3" stretchy="false" xref="A1.E47.m2.4.4.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mstyle><mo id="A1.E47.m2.8.8.3.3.2.2.2.1.1.1.1.1.1.1" xref="A1.E47.m2.8.8.3.3.2.2.2.1.1.1.1.1.1.1.cmml">−</mo><mn id="A1.E47.m2.8.8.3.3.2.2.2.1.1.1.1.1.1.2" xref="A1.E47.m2.8.8.3.3.2.2.2.1.1.1.1.1.1.2.cmml">1</mn></mrow><mo id="A1.E47.m2.8.8.3.3.2.2.2.1.1.1.1.1.3" xref="A1.E47.m2.8.8.3.3.2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E47.m2.8.8.3.3.2.2.2.1.1.3" xref="A1.E47.m2.8.8.3.3.2.2.2.2.cmml">]</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E47.m2.8b"><apply id="A1.E47.m2.8.8.cmml" xref="A1.E47.m2.8.8"><eq id="A1.E47.m2.8.8.4.cmml" xref="A1.E47.m2.8.8.4"></eq><csymbol cd="latexml" id="A1.E47.m2.8.8.5.cmml" xref="A1.E47.m2.8.8.5">absent</csymbol><apply id="A1.E47.m2.8.8.3.cmml" xref="A1.E47.m2.8.8.3"><minus id="A1.E47.m2.8.8.3.4.cmml" xref="A1.E47.m2.8.8.3.4"></minus><apply id="A1.E47.m2.6.6.1.1.cmml" xref="A1.E47.m2.6.6.1.1"><times id="A1.E47.m2.6.6.1.1.2.cmml" xref="A1.E47.m2.6.6.1.1.2"></times><ci id="A1.E47.m2.6.6.1.1.3.cmml" xref="A1.E47.m2.6.6.1.1.3">𝛼</ci><apply id="A1.E47.m2.6.6.1.1.1.2.cmml" xref="A1.E47.m2.6.6.1.1.1.1"><csymbol cd="latexml" id="A1.E47.m2.6.6.1.1.1.2.1.cmml" xref="A1.E47.m2.6.6.1.1.1.1.2">delimited-[]</csymbol><apply id="A1.E47.m2.6.6.1.1.1.1.1.cmml" xref="A1.E47.m2.6.6.1.1.1.1.1"><minus id="A1.E47.m2.6.6.1.1.1.1.1.1.cmml" xref="A1.E47.m2.6.6.1.1.1.1.1.1"></minus><apply id="A1.E47.m2.6.6.1.1.1.1.1.2.cmml" xref="A1.E47.m2.6.6.1.1.1.1.1.2"><apply id="A1.E47.m2.6.6.1.1.1.1.1.2.1.cmml" xref="A1.E47.m2.6.6.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="A1.E47.m2.6.6.1.1.1.1.1.2.1.1.cmml" xref="A1.E47.m2.6.6.1.1.1.1.1.2.1">superscript</csymbol><apply id="A1.E47.m2.6.6.1.1.1.1.1.2.1.2.cmml" xref="A1.E47.m2.6.6.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="A1.E47.m2.6.6.1.1.1.1.1.2.1.2.1.cmml" xref="A1.E47.m2.6.6.1.1.1.1.1.2.1">subscript</csymbol><sum id="A1.E47.m2.6.6.1.1.1.1.1.2.1.2.2.cmml" xref="A1.E47.m2.6.6.1.1.1.1.1.2.1.2.2"></sum><apply id="A1.E47.m2.6.6.1.1.1.1.1.2.1.2.3.cmml" xref="A1.E47.m2.6.6.1.1.1.1.1.2.1.2.3"><eq id="A1.E47.m2.6.6.1.1.1.1.1.2.1.2.3.1.cmml" xref="A1.E47.m2.6.6.1.1.1.1.1.2.1.2.3.1"></eq><ci id="A1.E47.m2.6.6.1.1.1.1.1.2.1.2.3.2.cmml" xref="A1.E47.m2.6.6.1.1.1.1.1.2.1.2.3.2">𝑗</ci><cn id="A1.E47.m2.6.6.1.1.1.1.1.2.1.2.3.3.cmml" type="integer" xref="A1.E47.m2.6.6.1.1.1.1.1.2.1.2.3.3">1</cn></apply></apply><ci id="A1.E47.m2.6.6.1.1.1.1.1.2.1.3.cmml" xref="A1.E47.m2.6.6.1.1.1.1.1.2.1.3">𝐽</ci></apply><apply id="A1.E47.m2.2.2.cmml" xref="A1.E47.m2.2.2"><divide id="A1.E47.m2.2.2.3.cmml" xref="A1.E47.m2.2.2"></divide><apply id="A1.E47.m2.1.1.1.cmml" xref="A1.E47.m2.1.1.1"><times id="A1.E47.m2.1.1.1.2.cmml" xref="A1.E47.m2.1.1.1.2"></times><apply id="A1.E47.m2.1.1.1.3.cmml" xref="A1.E47.m2.1.1.1.3"><csymbol cd="ambiguous" id="A1.E47.m2.1.1.1.3.1.cmml" xref="A1.E47.m2.1.1.1.3">superscript</csymbol><ci id="A1.E47.m2.1.1.1.3.2.cmml" xref="A1.E47.m2.1.1.1.3.2">𝑃</ci><cn id="A1.E47.m2.1.1.1.3.3.cmml" type="integer" xref="A1.E47.m2.1.1.1.3.3">2</cn></apply><apply id="A1.E47.m2.1.1.1.1.1.1.cmml" xref="A1.E47.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E47.m2.1.1.1.1.1.1.1.cmml" xref="A1.E47.m2.1.1.1.1.1">subscript</csymbol><ci id="A1.E47.m2.1.1.1.1.1.1.2.cmml" xref="A1.E47.m2.1.1.1.1.1.1.2">𝑋</ci><ci id="A1.E47.m2.1.1.1.1.1.1.3.cmml" xref="A1.E47.m2.1.1.1.1.1.1.3">𝑗</ci></apply></apply><apply id="A1.E47.m2.2.2.2.cmml" xref="A1.E47.m2.2.2.2"><times id="A1.E47.m2.2.2.2.2.cmml" xref="A1.E47.m2.2.2.2.2"></times><apply id="A1.E47.m2.2.2.2.3.cmml" xref="A1.E47.m2.2.2.2.3"><csymbol cd="ambiguous" id="A1.E47.m2.2.2.2.3.1.cmml" xref="A1.E47.m2.2.2.2.3">subscript</csymbol><ci id="A1.E47.m2.2.2.2.3.2.cmml" xref="A1.E47.m2.2.2.2.3.2">𝑄</ci><ci id="A1.E47.m2.2.2.2.3.3.cmml" xref="A1.E47.m2.2.2.2.3.3">𝑓</ci></apply><apply id="A1.E47.m2.2.2.2.1.1.1.cmml" xref="A1.E47.m2.2.2.2.1.1"><csymbol cd="ambiguous" id="A1.E47.m2.2.2.2.1.1.1.1.cmml" xref="A1.E47.m2.2.2.2.1.1">subscript</csymbol><ci id="A1.E47.m2.2.2.2.1.1.1.2.cmml" xref="A1.E47.m2.2.2.2.1.1.1.2">𝑋</ci><ci id="A1.E47.m2.2.2.2.1.1.1.3.cmml" xref="A1.E47.m2.2.2.2.1.1.1.3">𝑗</ci></apply></apply></apply></apply><cn id="A1.E47.m2.6.6.1.1.1.1.1.3.cmml" type="integer" xref="A1.E47.m2.6.6.1.1.1.1.1.3">1</cn></apply></apply></apply><apply id="A1.E47.m2.8.8.3.3.cmml" xref="A1.E47.m2.8.8.3.3"><times id="A1.E47.m2.8.8.3.3.3.cmml" xref="A1.E47.m2.8.8.3.3.3"></times><log id="A1.E47.m2.8.8.3.3.4.cmml" xref="A1.E47.m2.8.8.3.3.4"></log><apply id="A1.E47.m2.8.8.3.3.2.cmml" xref="A1.E47.m2.8.8.3.3.2"><apply id="A1.E47.m2.8.8.3.3.2.3.cmml" xref="A1.E47.m2.8.8.3.3.2.3"><csymbol cd="ambiguous" id="A1.E47.m2.8.8.3.3.2.3.1.cmml" xref="A1.E47.m2.8.8.3.3.2.3">superscript</csymbol><apply id="A1.E47.m2.8.8.3.3.2.3.2.cmml" xref="A1.E47.m2.8.8.3.3.2.3"><csymbol cd="ambiguous" id="A1.E47.m2.8.8.3.3.2.3.2.1.cmml" xref="A1.E47.m2.8.8.3.3.2.3">subscript</csymbol><sum id="A1.E47.m2.8.8.3.3.2.3.2.2.cmml" xref="A1.E47.m2.8.8.3.3.2.3.2.2"></sum><apply id="A1.E47.m2.8.8.3.3.2.3.2.3.cmml" xref="A1.E47.m2.8.8.3.3.2.3.2.3"><eq id="A1.E47.m2.8.8.3.3.2.3.2.3.1.cmml" xref="A1.E47.m2.8.8.3.3.2.3.2.3.1"></eq><ci id="A1.E47.m2.8.8.3.3.2.3.2.3.2.cmml" xref="A1.E47.m2.8.8.3.3.2.3.2.3.2">𝑗</ci><cn id="A1.E47.m2.8.8.3.3.2.3.2.3.3.cmml" type="integer" xref="A1.E47.m2.8.8.3.3.2.3.2.3.3">1</cn></apply></apply><ci id="A1.E47.m2.8.8.3.3.2.3.3.cmml" xref="A1.E47.m2.8.8.3.3.2.3.3">𝐽</ci></apply><apply id="A1.E47.m2.8.8.3.3.2.2.cmml" xref="A1.E47.m2.8.8.3.3.2.2"><times id="A1.E47.m2.8.8.3.3.2.2.3.cmml" xref="A1.E47.m2.8.8.3.3.2.2.3"></times><apply id="A1.E47.m2.8.8.3.3.2.2.4.cmml" xref="A1.E47.m2.8.8.3.3.2.2.4"><csymbol cd="ambiguous" id="A1.E47.m2.8.8.3.3.2.2.4.1.cmml" xref="A1.E47.m2.8.8.3.3.2.2.4">subscript</csymbol><ci id="A1.E47.m2.8.8.3.3.2.2.4.2.cmml" xref="A1.E47.m2.8.8.3.3.2.2.4.2">𝑄</ci><ci id="A1.E47.m2.8.8.3.3.2.2.4.3.cmml" xref="A1.E47.m2.8.8.3.3.2.2.4.3">𝑓</ci></apply><apply id="A1.E47.m2.7.7.2.2.1.1.1.1.1.cmml" xref="A1.E47.m2.7.7.2.2.1.1.1.1"><csymbol cd="ambiguous" id="A1.E47.m2.7.7.2.2.1.1.1.1.1.1.cmml" xref="A1.E47.m2.7.7.2.2.1.1.1.1">subscript</csymbol><ci id="A1.E47.m2.7.7.2.2.1.1.1.1.1.2.cmml" xref="A1.E47.m2.7.7.2.2.1.1.1.1.1.2">𝑋</ci><ci id="A1.E47.m2.7.7.2.2.1.1.1.1.1.3.cmml" xref="A1.E47.m2.7.7.2.2.1.1.1.1.1.3">𝑗</ci></apply><apply id="A1.E47.m2.8.8.3.3.2.2.2.2.cmml" xref="A1.E47.m2.8.8.3.3.2.2.2.1"><exp id="A1.E47.m2.5.5.cmml" xref="A1.E47.m2.5.5"></exp><apply id="A1.E47.m2.8.8.3.3.2.2.2.1.1.1.cmml" xref="A1.E47.m2.8.8.3.3.2.2.2.1.1.1"><times id="A1.E47.m2.8.8.3.3.2.2.2.1.1.1.2.cmml" xref="A1.E47.m2.8.8.3.3.2.2.2.1.1.1.2"></times><ci id="A1.E47.m2.8.8.3.3.2.2.2.1.1.1.3.cmml" xref="A1.E47.m2.8.8.3.3.2.2.2.1.1.1.3">𝛼</ci><apply id="A1.E47.m2.8.8.3.3.2.2.2.1.1.1.1.1.1.cmml" xref="A1.E47.m2.8.8.3.3.2.2.2.1.1.1.1.1"><minus id="A1.E47.m2.8.8.3.3.2.2.2.1.1.1.1.1.1.1.cmml" xref="A1.E47.m2.8.8.3.3.2.2.2.1.1.1.1.1.1.1"></minus><apply id="A1.E47.m2.4.4.cmml" xref="A1.E47.m2.4.4"><divide id="A1.E47.m2.4.4.3.cmml" xref="A1.E47.m2.4.4"></divide><apply id="A1.E47.m2.3.3.1.cmml" xref="A1.E47.m2.3.3.1"><times id="A1.E47.m2.3.3.1.2.cmml" xref="A1.E47.m2.3.3.1.2"></times><ci id="A1.E47.m2.3.3.1.3.cmml" xref="A1.E47.m2.3.3.1.3">𝑃</ci><apply id="A1.E47.m2.3.3.1.1.1.1.cmml" xref="A1.E47.m2.3.3.1.1.1"><csymbol cd="ambiguous" id="A1.E47.m2.3.3.1.1.1.1.1.cmml" xref="A1.E47.m2.3.3.1.1.1">subscript</csymbol><ci id="A1.E47.m2.3.3.1.1.1.1.2.cmml" xref="A1.E47.m2.3.3.1.1.1.1.2">𝑋</ci><ci id="A1.E47.m2.3.3.1.1.1.1.3.cmml" xref="A1.E47.m2.3.3.1.1.1.1.3">𝑗</ci></apply></apply><apply id="A1.E47.m2.4.4.2.cmml" xref="A1.E47.m2.4.4.2"><times id="A1.E47.m2.4.4.2.2.cmml" xref="A1.E47.m2.4.4.2.2"></times><apply id="A1.E47.m2.4.4.2.3.cmml" xref="A1.E47.m2.4.4.2.3"><csymbol cd="ambiguous" id="A1.E47.m2.4.4.2.3.1.cmml" xref="A1.E47.m2.4.4.2.3">subscript</csymbol><ci id="A1.E47.m2.4.4.2.3.2.cmml" xref="A1.E47.m2.4.4.2.3.2">𝑄</ci><ci id="A1.E47.m2.4.4.2.3.3.cmml" xref="A1.E47.m2.4.4.2.3.3">𝑓</ci></apply><apply id="A1.E47.m2.4.4.2.1.1.1.cmml" xref="A1.E47.m2.4.4.2.1.1"><csymbol cd="ambiguous" id="A1.E47.m2.4.4.2.1.1.1.1.cmml" xref="A1.E47.m2.4.4.2.1.1">subscript</csymbol><ci id="A1.E47.m2.4.4.2.1.1.1.2.cmml" xref="A1.E47.m2.4.4.2.1.1.1.2">𝑋</ci><ci id="A1.E47.m2.4.4.2.1.1.1.3.cmml" xref="A1.E47.m2.4.4.2.1.1.1.3">𝑗</ci></apply></apply></apply><cn id="A1.E47.m2.8.8.3.3.2.2.2.1.1.1.1.1.1.2.cmml" type="integer" xref="A1.E47.m2.8.8.3.3.2.2.2.1.1.1.1.1.1.2">1</cn></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E47.m2.8c">\displaystyle=\alpha\left[\sum_{j=1}^{J}\frac{P^{2}\left(X_{j}\right)}{Q_{f}(X%
_{j})}-1\right]-\log\sum_{j=1}^{J}Q_{f}\left(X_{j}\right)\exp\left[\alpha\left%
(\frac{P\left(X_{j}\right)}{Q_{f}(X_{j})}-1\right)\right]</annotation><annotation encoding="application/x-llamapun" id="A1.E47.m2.8d">= italic_α [ ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_J end_POSTSUPERSCRIPT divide start_ARG italic_P start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG start_ARG italic_Q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG - 1 ] - roman_log ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_J end_POSTSUPERSCRIPT italic_Q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) roman_exp [ italic_α ( divide start_ARG italic_P ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG start_ARG italic_Q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG - 1 ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(47)</span></td>
</tr></tbody>
<tbody id="A1.E48"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\alpha\chi^{2}(P\|Q_{f})-\log\mathbb{E}\exp\left(\alpha W\right)\,," class="ltx_Math" display="inline" id="A1.E48.m1.2"><semantics id="A1.E48.m1.2a"><mrow id="A1.E48.m1.2.2.1" xref="A1.E48.m1.2.2.1.1.cmml"><mrow id="A1.E48.m1.2.2.1.1" xref="A1.E48.m1.2.2.1.1.cmml"><mi id="A1.E48.m1.2.2.1.1.4" xref="A1.E48.m1.2.2.1.1.4.cmml"></mi><mo id="A1.E48.m1.2.2.1.1.3" xref="A1.E48.m1.2.2.1.1.3.cmml">=</mo><mrow id="A1.E48.m1.2.2.1.1.2" xref="A1.E48.m1.2.2.1.1.2.cmml"><mrow id="A1.E48.m1.2.2.1.1.1.1" xref="A1.E48.m1.2.2.1.1.1.1.cmml"><mi id="A1.E48.m1.2.2.1.1.1.1.3" xref="A1.E48.m1.2.2.1.1.1.1.3.cmml">α</mi><mo id="A1.E48.m1.2.2.1.1.1.1.2" xref="A1.E48.m1.2.2.1.1.1.1.2.cmml">⁢</mo><msup id="A1.E48.m1.2.2.1.1.1.1.4" xref="A1.E48.m1.2.2.1.1.1.1.4.cmml"><mi id="A1.E48.m1.2.2.1.1.1.1.4.2" xref="A1.E48.m1.2.2.1.1.1.1.4.2.cmml">χ</mi><mn id="A1.E48.m1.2.2.1.1.1.1.4.3" xref="A1.E48.m1.2.2.1.1.1.1.4.3.cmml">2</mn></msup><mo id="A1.E48.m1.2.2.1.1.1.1.2a" xref="A1.E48.m1.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E48.m1.2.2.1.1.1.1.1.1" xref="A1.E48.m1.2.2.1.1.1.1.1.1.1.cmml"><mo id="A1.E48.m1.2.2.1.1.1.1.1.1.2" stretchy="false" xref="A1.E48.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E48.m1.2.2.1.1.1.1.1.1.1" xref="A1.E48.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="A1.E48.m1.2.2.1.1.1.1.1.1.1.2" xref="A1.E48.m1.2.2.1.1.1.1.1.1.1.2.cmml">P</mi><mo id="A1.E48.m1.2.2.1.1.1.1.1.1.1.1" xref="A1.E48.m1.2.2.1.1.1.1.1.1.1.1.cmml">∥</mo><msub id="A1.E48.m1.2.2.1.1.1.1.1.1.1.3" xref="A1.E48.m1.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E48.m1.2.2.1.1.1.1.1.1.1.3.2" xref="A1.E48.m1.2.2.1.1.1.1.1.1.1.3.2.cmml">Q</mi><mi id="A1.E48.m1.2.2.1.1.1.1.1.1.1.3.3" xref="A1.E48.m1.2.2.1.1.1.1.1.1.1.3.3.cmml">f</mi></msub></mrow><mo id="A1.E48.m1.2.2.1.1.1.1.1.1.3" stretchy="false" xref="A1.E48.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E48.m1.2.2.1.1.2.3" xref="A1.E48.m1.2.2.1.1.2.3.cmml">−</mo><mrow id="A1.E48.m1.2.2.1.1.2.2" xref="A1.E48.m1.2.2.1.1.2.2.cmml"><mi id="A1.E48.m1.2.2.1.1.2.2.2" xref="A1.E48.m1.2.2.1.1.2.2.2.cmml">log</mi><mo id="A1.E48.m1.2.2.1.1.2.2a" lspace="0.167em" xref="A1.E48.m1.2.2.1.1.2.2.cmml">⁡</mo><mrow id="A1.E48.m1.2.2.1.1.2.2.1" xref="A1.E48.m1.2.2.1.1.2.2.1.cmml"><mi id="A1.E48.m1.2.2.1.1.2.2.1.3" xref="A1.E48.m1.2.2.1.1.2.2.1.3.cmml">𝔼</mi><mo id="A1.E48.m1.2.2.1.1.2.2.1.2" lspace="0.167em" xref="A1.E48.m1.2.2.1.1.2.2.1.2.cmml">⁢</mo><mrow id="A1.E48.m1.2.2.1.1.2.2.1.1.1" xref="A1.E48.m1.2.2.1.1.2.2.1.1.2.cmml"><mi id="A1.E48.m1.1.1" xref="A1.E48.m1.1.1.cmml">exp</mi><mo id="A1.E48.m1.2.2.1.1.2.2.1.1.1a" xref="A1.E48.m1.2.2.1.1.2.2.1.1.2.cmml">⁡</mo><mrow id="A1.E48.m1.2.2.1.1.2.2.1.1.1.1" xref="A1.E48.m1.2.2.1.1.2.2.1.1.2.cmml"><mo id="A1.E48.m1.2.2.1.1.2.2.1.1.1.1.2" xref="A1.E48.m1.2.2.1.1.2.2.1.1.2.cmml">(</mo><mrow id="A1.E48.m1.2.2.1.1.2.2.1.1.1.1.1" xref="A1.E48.m1.2.2.1.1.2.2.1.1.1.1.1.cmml"><mi id="A1.E48.m1.2.2.1.1.2.2.1.1.1.1.1.2" xref="A1.E48.m1.2.2.1.1.2.2.1.1.1.1.1.2.cmml">α</mi><mo id="A1.E48.m1.2.2.1.1.2.2.1.1.1.1.1.1" xref="A1.E48.m1.2.2.1.1.2.2.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.E48.m1.2.2.1.1.2.2.1.1.1.1.1.3" xref="A1.E48.m1.2.2.1.1.2.2.1.1.1.1.1.3.cmml">W</mi></mrow><mo id="A1.E48.m1.2.2.1.1.2.2.1.1.1.1.3" rspace="0.170em" xref="A1.E48.m1.2.2.1.1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo id="A1.E48.m1.2.2.1.2" xref="A1.E48.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E48.m1.2b"><apply id="A1.E48.m1.2.2.1.1.cmml" xref="A1.E48.m1.2.2.1"><eq id="A1.E48.m1.2.2.1.1.3.cmml" xref="A1.E48.m1.2.2.1.1.3"></eq><csymbol cd="latexml" id="A1.E48.m1.2.2.1.1.4.cmml" xref="A1.E48.m1.2.2.1.1.4">absent</csymbol><apply id="A1.E48.m1.2.2.1.1.2.cmml" xref="A1.E48.m1.2.2.1.1.2"><minus id="A1.E48.m1.2.2.1.1.2.3.cmml" xref="A1.E48.m1.2.2.1.1.2.3"></minus><apply id="A1.E48.m1.2.2.1.1.1.1.cmml" xref="A1.E48.m1.2.2.1.1.1.1"><times id="A1.E48.m1.2.2.1.1.1.1.2.cmml" xref="A1.E48.m1.2.2.1.1.1.1.2"></times><ci id="A1.E48.m1.2.2.1.1.1.1.3.cmml" xref="A1.E48.m1.2.2.1.1.1.1.3">𝛼</ci><apply id="A1.E48.m1.2.2.1.1.1.1.4.cmml" xref="A1.E48.m1.2.2.1.1.1.1.4"><csymbol cd="ambiguous" id="A1.E48.m1.2.2.1.1.1.1.4.1.cmml" xref="A1.E48.m1.2.2.1.1.1.1.4">superscript</csymbol><ci id="A1.E48.m1.2.2.1.1.1.1.4.2.cmml" xref="A1.E48.m1.2.2.1.1.1.1.4.2">𝜒</ci><cn id="A1.E48.m1.2.2.1.1.1.1.4.3.cmml" type="integer" xref="A1.E48.m1.2.2.1.1.1.1.4.3">2</cn></apply><apply id="A1.E48.m1.2.2.1.1.1.1.1.1.1.cmml" xref="A1.E48.m1.2.2.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E48.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="A1.E48.m1.2.2.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="A1.E48.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="A1.E48.m1.2.2.1.1.1.1.1.1.1.2">𝑃</ci><apply id="A1.E48.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="A1.E48.m1.2.2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E48.m1.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E48.m1.2.2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E48.m1.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E48.m1.2.2.1.1.1.1.1.1.1.3.2">𝑄</ci><ci id="A1.E48.m1.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E48.m1.2.2.1.1.1.1.1.1.1.3.3">𝑓</ci></apply></apply></apply><apply id="A1.E48.m1.2.2.1.1.2.2.cmml" xref="A1.E48.m1.2.2.1.1.2.2"><log id="A1.E48.m1.2.2.1.1.2.2.2.cmml" xref="A1.E48.m1.2.2.1.1.2.2.2"></log><apply id="A1.E48.m1.2.2.1.1.2.2.1.cmml" xref="A1.E48.m1.2.2.1.1.2.2.1"><times id="A1.E48.m1.2.2.1.1.2.2.1.2.cmml" xref="A1.E48.m1.2.2.1.1.2.2.1.2"></times><ci id="A1.E48.m1.2.2.1.1.2.2.1.3.cmml" xref="A1.E48.m1.2.2.1.1.2.2.1.3">𝔼</ci><apply id="A1.E48.m1.2.2.1.1.2.2.1.1.2.cmml" xref="A1.E48.m1.2.2.1.1.2.2.1.1.1"><exp id="A1.E48.m1.1.1.cmml" xref="A1.E48.m1.1.1"></exp><apply id="A1.E48.m1.2.2.1.1.2.2.1.1.1.1.1.cmml" xref="A1.E48.m1.2.2.1.1.2.2.1.1.1.1.1"><times id="A1.E48.m1.2.2.1.1.2.2.1.1.1.1.1.1.cmml" xref="A1.E48.m1.2.2.1.1.2.2.1.1.1.1.1.1"></times><ci id="A1.E48.m1.2.2.1.1.2.2.1.1.1.1.1.2.cmml" xref="A1.E48.m1.2.2.1.1.2.2.1.1.1.1.1.2">𝛼</ci><ci id="A1.E48.m1.2.2.1.1.2.2.1.1.1.1.1.3.cmml" xref="A1.E48.m1.2.2.1.1.2.2.1.1.1.1.1.3">𝑊</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E48.m1.2c">\displaystyle=\alpha\chi^{2}(P\|Q_{f})-\log\mathbb{E}\exp\left(\alpha W\right)\,,</annotation><annotation encoding="application/x-llamapun" id="A1.E48.m1.2d">= italic_α italic_χ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ( italic_P ∥ italic_Q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT ) - roman_log blackboard_E roman_exp ( italic_α italic_W ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(48)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS2.p2.8">where, with some abuse of notation, we denote by <math alttext="\chi^{2}(P\|Q_{f})" class="ltx_Math" display="inline" id="A1.SS2.p2.1.m1.1"><semantics id="A1.SS2.p2.1.m1.1a"><mrow id="A1.SS2.p2.1.m1.1.1" xref="A1.SS2.p2.1.m1.1.1.cmml"><msup id="A1.SS2.p2.1.m1.1.1.3" xref="A1.SS2.p2.1.m1.1.1.3.cmml"><mi id="A1.SS2.p2.1.m1.1.1.3.2" xref="A1.SS2.p2.1.m1.1.1.3.2.cmml">χ</mi><mn id="A1.SS2.p2.1.m1.1.1.3.3" xref="A1.SS2.p2.1.m1.1.1.3.3.cmml">2</mn></msup><mo id="A1.SS2.p2.1.m1.1.1.2" xref="A1.SS2.p2.1.m1.1.1.2.cmml">⁢</mo><mrow id="A1.SS2.p2.1.m1.1.1.1.1" xref="A1.SS2.p2.1.m1.1.1.1.1.1.cmml"><mo id="A1.SS2.p2.1.m1.1.1.1.1.2" stretchy="false" xref="A1.SS2.p2.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="A1.SS2.p2.1.m1.1.1.1.1.1" xref="A1.SS2.p2.1.m1.1.1.1.1.1.cmml"><mi id="A1.SS2.p2.1.m1.1.1.1.1.1.2" xref="A1.SS2.p2.1.m1.1.1.1.1.1.2.cmml">P</mi><mo id="A1.SS2.p2.1.m1.1.1.1.1.1.1" xref="A1.SS2.p2.1.m1.1.1.1.1.1.1.cmml">∥</mo><msub id="A1.SS2.p2.1.m1.1.1.1.1.1.3" xref="A1.SS2.p2.1.m1.1.1.1.1.1.3.cmml"><mi id="A1.SS2.p2.1.m1.1.1.1.1.1.3.2" xref="A1.SS2.p2.1.m1.1.1.1.1.1.3.2.cmml">Q</mi><mi id="A1.SS2.p2.1.m1.1.1.1.1.1.3.3" xref="A1.SS2.p2.1.m1.1.1.1.1.1.3.3.cmml">f</mi></msub></mrow><mo id="A1.SS2.p2.1.m1.1.1.1.1.3" stretchy="false" xref="A1.SS2.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.1.m1.1b"><apply id="A1.SS2.p2.1.m1.1.1.cmml" xref="A1.SS2.p2.1.m1.1.1"><times id="A1.SS2.p2.1.m1.1.1.2.cmml" xref="A1.SS2.p2.1.m1.1.1.2"></times><apply id="A1.SS2.p2.1.m1.1.1.3.cmml" xref="A1.SS2.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p2.1.m1.1.1.3.1.cmml" xref="A1.SS2.p2.1.m1.1.1.3">superscript</csymbol><ci id="A1.SS2.p2.1.m1.1.1.3.2.cmml" xref="A1.SS2.p2.1.m1.1.1.3.2">𝜒</ci><cn id="A1.SS2.p2.1.m1.1.1.3.3.cmml" type="integer" xref="A1.SS2.p2.1.m1.1.1.3.3">2</cn></apply><apply id="A1.SS2.p2.1.m1.1.1.1.1.1.cmml" xref="A1.SS2.p2.1.m1.1.1.1.1"><csymbol cd="latexml" id="A1.SS2.p2.1.m1.1.1.1.1.1.1.cmml" xref="A1.SS2.p2.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="A1.SS2.p2.1.m1.1.1.1.1.1.2.cmml" xref="A1.SS2.p2.1.m1.1.1.1.1.1.2">𝑃</ci><apply id="A1.SS2.p2.1.m1.1.1.1.1.1.3.cmml" xref="A1.SS2.p2.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p2.1.m1.1.1.1.1.1.3.1.cmml" xref="A1.SS2.p2.1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.SS2.p2.1.m1.1.1.1.1.1.3.2.cmml" xref="A1.SS2.p2.1.m1.1.1.1.1.1.3.2">𝑄</ci><ci id="A1.SS2.p2.1.m1.1.1.1.1.1.3.3.cmml" xref="A1.SS2.p2.1.m1.1.1.1.1.1.3.3">𝑓</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.1.m1.1c">\chi^{2}(P\|Q_{f})</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p2.1.m1.1d">italic_χ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ( italic_P ∥ italic_Q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT )</annotation></semantics></math> the <math alttext="\chi^{2}" class="ltx_Math" display="inline" id="A1.SS2.p2.2.m2.1"><semantics id="A1.SS2.p2.2.m2.1a"><msup id="A1.SS2.p2.2.m2.1.1" xref="A1.SS2.p2.2.m2.1.1.cmml"><mi id="A1.SS2.p2.2.m2.1.1.2" xref="A1.SS2.p2.2.m2.1.1.2.cmml">χ</mi><mn id="A1.SS2.p2.2.m2.1.1.3" xref="A1.SS2.p2.2.m2.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.2.m2.1b"><apply id="A1.SS2.p2.2.m2.1.1.cmml" xref="A1.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS2.p2.2.m2.1.1.1.cmml" xref="A1.SS2.p2.2.m2.1.1">superscript</csymbol><ci id="A1.SS2.p2.2.m2.1.1.2.cmml" xref="A1.SS2.p2.2.m2.1.1.2">𝜒</ci><cn id="A1.SS2.p2.2.m2.1.1.3.cmml" type="integer" xref="A1.SS2.p2.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.2.m2.1c">\chi^{2}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p2.2.m2.1d">italic_χ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>-divergence between
the two discrete distributions over <math alttext="[1..J]" class="ltx_math_unparsed" display="inline" id="A1.SS2.p2.3.m3.1"><semantics id="A1.SS2.p2.3.m3.1a"><mrow id="A1.SS2.p2.3.m3.1b"><mo id="A1.SS2.p2.3.m3.1.1" stretchy="false">[</mo><mn id="A1.SS2.p2.3.m3.1.2">1</mn><mo id="A1.SS2.p2.3.m3.1.3" lspace="0em" rspace="0.0835em">.</mo><mo id="A1.SS2.p2.3.m3.1.4" lspace="0.0835em" rspace="0.167em">.</mo><mi id="A1.SS2.p2.3.m3.1.5">J</mi><mo id="A1.SS2.p2.3.m3.1.6" stretchy="false">]</mo></mrow><annotation encoding="application/x-tex" id="A1.SS2.p2.3.m3.1c">[1..J]</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p2.3.m3.1d">[ 1 . . italic_J ]</annotation></semantics></math> induced by the partitioning obtained in the current boosting round.
This value is always non-negative, and can only be zero if <math alttext="P\left(X_{j}\right)=Q_{f}(X_{j})" class="ltx_Math" display="inline" id="A1.SS2.p2.4.m4.2"><semantics id="A1.SS2.p2.4.m4.2a"><mrow id="A1.SS2.p2.4.m4.2.2" xref="A1.SS2.p2.4.m4.2.2.cmml"><mrow id="A1.SS2.p2.4.m4.1.1.1" xref="A1.SS2.p2.4.m4.1.1.1.cmml"><mi id="A1.SS2.p2.4.m4.1.1.1.3" xref="A1.SS2.p2.4.m4.1.1.1.3.cmml">P</mi><mo id="A1.SS2.p2.4.m4.1.1.1.2" xref="A1.SS2.p2.4.m4.1.1.1.2.cmml">⁢</mo><mrow id="A1.SS2.p2.4.m4.1.1.1.1.1" xref="A1.SS2.p2.4.m4.1.1.1.1.1.1.cmml"><mo id="A1.SS2.p2.4.m4.1.1.1.1.1.2" xref="A1.SS2.p2.4.m4.1.1.1.1.1.1.cmml">(</mo><msub id="A1.SS2.p2.4.m4.1.1.1.1.1.1" xref="A1.SS2.p2.4.m4.1.1.1.1.1.1.cmml"><mi id="A1.SS2.p2.4.m4.1.1.1.1.1.1.2" xref="A1.SS2.p2.4.m4.1.1.1.1.1.1.2.cmml">X</mi><mi id="A1.SS2.p2.4.m4.1.1.1.1.1.1.3" xref="A1.SS2.p2.4.m4.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="A1.SS2.p2.4.m4.1.1.1.1.1.3" xref="A1.SS2.p2.4.m4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.SS2.p2.4.m4.2.2.3" xref="A1.SS2.p2.4.m4.2.2.3.cmml">=</mo><mrow id="A1.SS2.p2.4.m4.2.2.2" xref="A1.SS2.p2.4.m4.2.2.2.cmml"><msub id="A1.SS2.p2.4.m4.2.2.2.3" xref="A1.SS2.p2.4.m4.2.2.2.3.cmml"><mi id="A1.SS2.p2.4.m4.2.2.2.3.2" xref="A1.SS2.p2.4.m4.2.2.2.3.2.cmml">Q</mi><mi id="A1.SS2.p2.4.m4.2.2.2.3.3" xref="A1.SS2.p2.4.m4.2.2.2.3.3.cmml">f</mi></msub><mo id="A1.SS2.p2.4.m4.2.2.2.2" xref="A1.SS2.p2.4.m4.2.2.2.2.cmml">⁢</mo><mrow id="A1.SS2.p2.4.m4.2.2.2.1.1" xref="A1.SS2.p2.4.m4.2.2.2.1.1.1.cmml"><mo id="A1.SS2.p2.4.m4.2.2.2.1.1.2" stretchy="false" xref="A1.SS2.p2.4.m4.2.2.2.1.1.1.cmml">(</mo><msub id="A1.SS2.p2.4.m4.2.2.2.1.1.1" xref="A1.SS2.p2.4.m4.2.2.2.1.1.1.cmml"><mi id="A1.SS2.p2.4.m4.2.2.2.1.1.1.2" xref="A1.SS2.p2.4.m4.2.2.2.1.1.1.2.cmml">X</mi><mi id="A1.SS2.p2.4.m4.2.2.2.1.1.1.3" xref="A1.SS2.p2.4.m4.2.2.2.1.1.1.3.cmml">j</mi></msub><mo id="A1.SS2.p2.4.m4.2.2.2.1.1.3" stretchy="false" xref="A1.SS2.p2.4.m4.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.4.m4.2b"><apply id="A1.SS2.p2.4.m4.2.2.cmml" xref="A1.SS2.p2.4.m4.2.2"><eq id="A1.SS2.p2.4.m4.2.2.3.cmml" xref="A1.SS2.p2.4.m4.2.2.3"></eq><apply id="A1.SS2.p2.4.m4.1.1.1.cmml" xref="A1.SS2.p2.4.m4.1.1.1"><times id="A1.SS2.p2.4.m4.1.1.1.2.cmml" xref="A1.SS2.p2.4.m4.1.1.1.2"></times><ci id="A1.SS2.p2.4.m4.1.1.1.3.cmml" xref="A1.SS2.p2.4.m4.1.1.1.3">𝑃</ci><apply id="A1.SS2.p2.4.m4.1.1.1.1.1.1.cmml" xref="A1.SS2.p2.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p2.4.m4.1.1.1.1.1.1.1.cmml" xref="A1.SS2.p2.4.m4.1.1.1.1.1">subscript</csymbol><ci id="A1.SS2.p2.4.m4.1.1.1.1.1.1.2.cmml" xref="A1.SS2.p2.4.m4.1.1.1.1.1.1.2">𝑋</ci><ci id="A1.SS2.p2.4.m4.1.1.1.1.1.1.3.cmml" xref="A1.SS2.p2.4.m4.1.1.1.1.1.1.3">𝑗</ci></apply></apply><apply id="A1.SS2.p2.4.m4.2.2.2.cmml" xref="A1.SS2.p2.4.m4.2.2.2"><times id="A1.SS2.p2.4.m4.2.2.2.2.cmml" xref="A1.SS2.p2.4.m4.2.2.2.2"></times><apply id="A1.SS2.p2.4.m4.2.2.2.3.cmml" xref="A1.SS2.p2.4.m4.2.2.2.3"><csymbol cd="ambiguous" id="A1.SS2.p2.4.m4.2.2.2.3.1.cmml" xref="A1.SS2.p2.4.m4.2.2.2.3">subscript</csymbol><ci id="A1.SS2.p2.4.m4.2.2.2.3.2.cmml" xref="A1.SS2.p2.4.m4.2.2.2.3.2">𝑄</ci><ci id="A1.SS2.p2.4.m4.2.2.2.3.3.cmml" xref="A1.SS2.p2.4.m4.2.2.2.3.3">𝑓</ci></apply><apply id="A1.SS2.p2.4.m4.2.2.2.1.1.1.cmml" xref="A1.SS2.p2.4.m4.2.2.2.1.1"><csymbol cd="ambiguous" id="A1.SS2.p2.4.m4.2.2.2.1.1.1.1.cmml" xref="A1.SS2.p2.4.m4.2.2.2.1.1">subscript</csymbol><ci id="A1.SS2.p2.4.m4.2.2.2.1.1.1.2.cmml" xref="A1.SS2.p2.4.m4.2.2.2.1.1.1.2">𝑋</ci><ci id="A1.SS2.p2.4.m4.2.2.2.1.1.1.3.cmml" xref="A1.SS2.p2.4.m4.2.2.2.1.1.1.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.4.m4.2c">P\left(X_{j}\right)=Q_{f}(X_{j})</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p2.4.m4.2d">italic_P ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) = italic_Q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT )</annotation></semantics></math> for all leaves.
It therefore corresponds to an increase in likelihood that is as large as one can make the difference between the induced <math alttext="P" class="ltx_Math" display="inline" id="A1.SS2.p2.5.m5.1"><semantics id="A1.SS2.p2.5.m5.1a"><mi id="A1.SS2.p2.5.m5.1.1" xref="A1.SS2.p2.5.m5.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.5.m5.1b"><ci id="A1.SS2.p2.5.m5.1.1.cmml" xref="A1.SS2.p2.5.m5.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.5.m5.1c">P</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p2.5.m5.1d">italic_P</annotation></semantics></math> and <math alttext="Q_{f}" class="ltx_Math" display="inline" id="A1.SS2.p2.6.m6.1"><semantics id="A1.SS2.p2.6.m6.1a"><msub id="A1.SS2.p2.6.m6.1.1" xref="A1.SS2.p2.6.m6.1.1.cmml"><mi id="A1.SS2.p2.6.m6.1.1.2" xref="A1.SS2.p2.6.m6.1.1.2.cmml">Q</mi><mi id="A1.SS2.p2.6.m6.1.1.3" xref="A1.SS2.p2.6.m6.1.1.3.cmml">f</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.6.m6.1b"><apply id="A1.SS2.p2.6.m6.1.1.cmml" xref="A1.SS2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="A1.SS2.p2.6.m6.1.1.1.cmml" xref="A1.SS2.p2.6.m6.1.1">subscript</csymbol><ci id="A1.SS2.p2.6.m6.1.1.2.cmml" xref="A1.SS2.p2.6.m6.1.1.2">𝑄</ci><ci id="A1.SS2.p2.6.m6.1.1.3.cmml" xref="A1.SS2.p2.6.m6.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.6.m6.1c">Q_{f}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p2.6.m6.1d">italic_Q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT</annotation></semantics></math> distributions by a judicious choice of <math alttext="X_{j}" class="ltx_Math" display="inline" id="A1.SS2.p2.7.m7.1"><semantics id="A1.SS2.p2.7.m7.1a"><msub id="A1.SS2.p2.7.m7.1.1" xref="A1.SS2.p2.7.m7.1.1.cmml"><mi id="A1.SS2.p2.7.m7.1.1.2" xref="A1.SS2.p2.7.m7.1.1.2.cmml">X</mi><mi id="A1.SS2.p2.7.m7.1.1.3" xref="A1.SS2.p2.7.m7.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.7.m7.1b"><apply id="A1.SS2.p2.7.m7.1.1.cmml" xref="A1.SS2.p2.7.m7.1.1"><csymbol cd="ambiguous" id="A1.SS2.p2.7.m7.1.1.1.cmml" xref="A1.SS2.p2.7.m7.1.1">subscript</csymbol><ci id="A1.SS2.p2.7.m7.1.1.2.cmml" xref="A1.SS2.p2.7.m7.1.1.2">𝑋</ci><ci id="A1.SS2.p2.7.m7.1.1.3.cmml" xref="A1.SS2.p2.7.m7.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.7.m7.1c">X_{j}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p2.7.m7.1d">italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>.
Note that this quantity is precisely the objective that NRGBoost tries to greedily maximize with its choice of <math alttext="X_{j}" class="ltx_Math" display="inline" id="A1.SS2.p2.8.m8.1"><semantics id="A1.SS2.p2.8.m8.1a"><msub id="A1.SS2.p2.8.m8.1.1" xref="A1.SS2.p2.8.m8.1.1.cmml"><mi id="A1.SS2.p2.8.m8.1.1.2" xref="A1.SS2.p2.8.m8.1.1.2.cmml">X</mi><mi id="A1.SS2.p2.8.m8.1.1.3" xref="A1.SS2.p2.8.m8.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.8.m8.1b"><apply id="A1.SS2.p2.8.m8.1.1.cmml" xref="A1.SS2.p2.8.m8.1.1"><csymbol cd="ambiguous" id="A1.SS2.p2.8.m8.1.1.1.cmml" xref="A1.SS2.p2.8.m8.1.1">subscript</csymbol><ci id="A1.SS2.p2.8.m8.1.1.2.cmml" xref="A1.SS2.p2.8.m8.1.1.2">𝑋</ci><ci id="A1.SS2.p2.8.m8.1.1.3.cmml" xref="A1.SS2.p2.8.m8.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.8.m8.1c">X_{j}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p2.8.m8.1d">italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> (see Equation <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S3.E9" title="In 3.1 Weak Learners ‣ 3 NRGBoost ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">9</span></a>).</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS2.p3">
<p class="ltx_p" id="A1.SS2.p3.7">The second term in Equation <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A1.E48" title="In A.2 A Simple Lower Bound on the Likelihood Increase ‣ Appendix A Theory ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">48</span></a> can be interpreted as the log of a moment generating function
for a centered random variable <math alttext="W" class="ltx_Math" display="inline" id="A1.SS2.p3.1.m1.1"><semantics id="A1.SS2.p3.1.m1.1a"><mi id="A1.SS2.p3.1.m1.1.1" xref="A1.SS2.p3.1.m1.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.1.m1.1b"><ci id="A1.SS2.p3.1.m1.1.1.cmml" xref="A1.SS2.p3.1.m1.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.1.m1.1c">W</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.1.m1.1d">italic_W</annotation></semantics></math> that takes values in <math alttext="\left\{\nicefrac{{P\left(X_{j}\right)}}{{Q_{f}(X_{j})}}-1\right\}_{j\in[1..J]}" class="ltx_math_unparsed" display="inline" id="A1.SS2.p3.2.m2.5"><semantics id="A1.SS2.p3.2.m2.5a"><msub id="A1.SS2.p3.2.m2.5.5"><mrow id="A1.SS2.p3.2.m2.5.5.1.1"><mo id="A1.SS2.p3.2.m2.5.5.1.1.2">{</mo><mrow id="A1.SS2.p3.2.m2.5.5.1.1.1"><mrow id="A1.SS2.p3.2.m2.2.2"><mpadded id="A1.SS2.p3.2.m2.1.1.1" voffset="0.3em"><mi id="A1.SS2.p3.2.m2.1.1.1.3" mathsize="70%">P</mi><mo id="A1.SS2.p3.2.m2.1.1.1.2">⁢</mo><mrow id="A1.SS2.p3.2.m2.1.1.1.1.1"><mo id="A1.SS2.p3.2.m2.1.1.1.1.1.2">(</mo><msub id="A1.SS2.p3.2.m2.1.1.1.1.1.1"><mi id="A1.SS2.p3.2.m2.1.1.1.1.1.1.2" mathsize="70%">X</mi><mi id="A1.SS2.p3.2.m2.1.1.1.1.1.1.3" mathsize="71%">j</mi></msub><mo id="A1.SS2.p3.2.m2.1.1.1.1.1.3">)</mo></mrow></mpadded><mpadded id="A1.SS2.p3.2.m2.2.2.3" lspace="-0.1em" width="-0.15em"><mo id="A1.SS2.p3.2.m2.2.2.3a" stretchy="true" symmetric="true">/</mo></mpadded><mrow id="A1.SS2.p3.2.m2.2.2.2"><msub id="A1.SS2.p3.2.m2.2.2.2.3"><mi id="A1.SS2.p3.2.m2.2.2.2.3.2" mathsize="70%">Q</mi><mi id="A1.SS2.p3.2.m2.2.2.2.3.3" mathsize="71%">f</mi></msub><mo id="A1.SS2.p3.2.m2.2.2.2.2">⁢</mo><mrow id="A1.SS2.p3.2.m2.2.2.2.1.1"><mo id="A1.SS2.p3.2.m2.2.2.2.1.1.2" maxsize="70%" minsize="70%">(</mo><msub id="A1.SS2.p3.2.m2.2.2.2.1.1.1"><mi id="A1.SS2.p3.2.m2.2.2.2.1.1.1.2" mathsize="70%">X</mi><mi id="A1.SS2.p3.2.m2.2.2.2.1.1.1.3" mathsize="71%">j</mi></msub><mo id="A1.SS2.p3.2.m2.2.2.2.1.1.3" maxsize="70%" minsize="70%">)</mo></mrow></mrow></mrow><mo id="A1.SS2.p3.2.m2.5.5.1.1.1.1">−</mo><mn id="A1.SS2.p3.2.m2.5.5.1.1.1.2">1</mn></mrow><mo id="A1.SS2.p3.2.m2.5.5.1.1.3">}</mo></mrow><mrow id="A1.SS2.p3.2.m2.4.4.2"><mi id="A1.SS2.p3.2.m2.3.3.1.1">j</mi><mo id="A1.SS2.p3.2.m2.4.4.2.2">∈</mo><mrow id="A1.SS2.p3.2.m2.4.4.2.3"><mo id="A1.SS2.p3.2.m2.4.4.2.3.1" stretchy="false">[</mo><mn id="A1.SS2.p3.2.m2.4.4.2.3.2">1</mn><mo id="A1.SS2.p3.2.m2.4.4.2.3.3" lspace="0em" rspace="0.0835em">.</mo><mo id="A1.SS2.p3.2.m2.4.4.2.3.4" lspace="0.0835em" rspace="0.167em">.</mo><mi id="A1.SS2.p3.2.m2.4.4.2.3.5">J</mi><mo id="A1.SS2.p3.2.m2.4.4.2.3.6" stretchy="false">]</mo></mrow></mrow></msub><annotation encoding="application/x-tex" id="A1.SS2.p3.2.m2.5b">\left\{\nicefrac{{P\left(X_{j}\right)}}{{Q_{f}(X_{j})}}-1\right\}_{j\in[1..J]}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.2.m2.5c">{ / start_ARG italic_P ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG start_ARG italic_Q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG - 1 } start_POSTSUBSCRIPT italic_j ∈ [ 1 . . italic_J ] end_POSTSUBSCRIPT</annotation></semantics></math> (i.e., the set of the leaf values), with corresponding probabilities <math alttext="\left\{Q_{f}(X_{j})\right\}_{j\in[1..J]}" class="ltx_math_unparsed" display="inline" id="A1.SS2.p3.3.m3.3"><semantics id="A1.SS2.p3.3.m3.3a"><msub id="A1.SS2.p3.3.m3.3.3"><mrow id="A1.SS2.p3.3.m3.3.3.1.1"><mo id="A1.SS2.p3.3.m3.3.3.1.1.2">{</mo><mrow id="A1.SS2.p3.3.m3.3.3.1.1.1"><msub id="A1.SS2.p3.3.m3.3.3.1.1.1.3"><mi id="A1.SS2.p3.3.m3.3.3.1.1.1.3.2">Q</mi><mi id="A1.SS2.p3.3.m3.3.3.1.1.1.3.3">f</mi></msub><mo id="A1.SS2.p3.3.m3.3.3.1.1.1.2">⁢</mo><mrow id="A1.SS2.p3.3.m3.3.3.1.1.1.1.1"><mo id="A1.SS2.p3.3.m3.3.3.1.1.1.1.1.2" stretchy="false">(</mo><msub id="A1.SS2.p3.3.m3.3.3.1.1.1.1.1.1"><mi id="A1.SS2.p3.3.m3.3.3.1.1.1.1.1.1.2">X</mi><mi id="A1.SS2.p3.3.m3.3.3.1.1.1.1.1.1.3">j</mi></msub><mo id="A1.SS2.p3.3.m3.3.3.1.1.1.1.1.3" stretchy="false">)</mo></mrow></mrow><mo id="A1.SS2.p3.3.m3.3.3.1.1.3">}</mo></mrow><mrow id="A1.SS2.p3.3.m3.2.2.2"><mi id="A1.SS2.p3.3.m3.1.1.1.1">j</mi><mo id="A1.SS2.p3.3.m3.2.2.2.2">∈</mo><mrow id="A1.SS2.p3.3.m3.2.2.2.3"><mo id="A1.SS2.p3.3.m3.2.2.2.3.1" stretchy="false">[</mo><mn id="A1.SS2.p3.3.m3.2.2.2.3.2">1</mn><mo id="A1.SS2.p3.3.m3.2.2.2.3.3" lspace="0em" rspace="0.0835em">.</mo><mo id="A1.SS2.p3.3.m3.2.2.2.3.4" lspace="0.0835em" rspace="0.167em">.</mo><mi id="A1.SS2.p3.3.m3.2.2.2.3.5">J</mi><mo id="A1.SS2.p3.3.m3.2.2.2.3.6" stretchy="false">]</mo></mrow></mrow></msub><annotation encoding="application/x-tex" id="A1.SS2.p3.3.m3.3b">\left\{Q_{f}(X_{j})\right\}_{j\in[1..J]}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.3.m3.3c">{ italic_Q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT italic_j ∈ [ 1 . . italic_J ] end_POSTSUBSCRIPT</annotation></semantics></math>.
With our proposed regularization approach (see Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S3.SS3" title="3.3 Regularization ‣ 3 NRGBoost ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">3.3</span></a>), we limit the ratio <math alttext="\nicefrac{{P\left(X_{j}\right)}}{{Q_{f}(X_{j})}}" class="ltx_Math" display="inline" id="A1.SS2.p3.4.m4.2"><semantics id="A1.SS2.p3.4.m4.2a"><mrow id="A1.SS2.p3.4.m4.2.2" xref="A1.SS2.p3.4.m4.2.2.cmml"><mpadded id="A1.SS2.p3.4.m4.1.1.1" voffset="0.3em" xref="A1.SS2.p3.4.m4.1.1.1.cmml"><mi id="A1.SS2.p3.4.m4.1.1.1.3" mathsize="70%" xref="A1.SS2.p3.4.m4.1.1.1.3.cmml">P</mi><mo id="A1.SS2.p3.4.m4.1.1.1.2" xref="A1.SS2.p3.4.m4.1.1.1.2.cmml">⁢</mo><mrow id="A1.SS2.p3.4.m4.1.1.1.1.1" xref="A1.SS2.p3.4.m4.1.1.1.1.1.1.cmml"><mo id="A1.SS2.p3.4.m4.1.1.1.1.1.2" xref="A1.SS2.p3.4.m4.1.1.1.1.1.1.cmml">(</mo><msub id="A1.SS2.p3.4.m4.1.1.1.1.1.1" xref="A1.SS2.p3.4.m4.1.1.1.1.1.1.cmml"><mi id="A1.SS2.p3.4.m4.1.1.1.1.1.1.2" mathsize="70%" xref="A1.SS2.p3.4.m4.1.1.1.1.1.1.2.cmml">X</mi><mi id="A1.SS2.p3.4.m4.1.1.1.1.1.1.3" mathsize="71%" xref="A1.SS2.p3.4.m4.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="A1.SS2.p3.4.m4.1.1.1.1.1.3" xref="A1.SS2.p3.4.m4.1.1.1.1.1.1.cmml">)</mo></mrow></mpadded><mpadded id="A1.SS2.p3.4.m4.2.2.3" lspace="-0.1em" width="-0.15em" xref="A1.SS2.p3.4.m4.2.2.3.cmml"><mo id="A1.SS2.p3.4.m4.2.2.3a" stretchy="true" symmetric="true" xref="A1.SS2.p3.4.m4.2.2.3.cmml">/</mo></mpadded><mrow id="A1.SS2.p3.4.m4.2.2.2" xref="A1.SS2.p3.4.m4.2.2.2.cmml"><msub id="A1.SS2.p3.4.m4.2.2.2.3" xref="A1.SS2.p3.4.m4.2.2.2.3.cmml"><mi id="A1.SS2.p3.4.m4.2.2.2.3.2" mathsize="70%" xref="A1.SS2.p3.4.m4.2.2.2.3.2.cmml">Q</mi><mi id="A1.SS2.p3.4.m4.2.2.2.3.3" mathsize="71%" xref="A1.SS2.p3.4.m4.2.2.2.3.3.cmml">f</mi></msub><mo id="A1.SS2.p3.4.m4.2.2.2.2" xref="A1.SS2.p3.4.m4.2.2.2.2.cmml">⁢</mo><mrow id="A1.SS2.p3.4.m4.2.2.2.1.1" xref="A1.SS2.p3.4.m4.2.2.2.1.1.1.cmml"><mo id="A1.SS2.p3.4.m4.2.2.2.1.1.2" maxsize="70%" minsize="70%" xref="A1.SS2.p3.4.m4.2.2.2.1.1.1.cmml">(</mo><msub id="A1.SS2.p3.4.m4.2.2.2.1.1.1" xref="A1.SS2.p3.4.m4.2.2.2.1.1.1.cmml"><mi id="A1.SS2.p3.4.m4.2.2.2.1.1.1.2" mathsize="70%" xref="A1.SS2.p3.4.m4.2.2.2.1.1.1.2.cmml">X</mi><mi id="A1.SS2.p3.4.m4.2.2.2.1.1.1.3" mathsize="71%" xref="A1.SS2.p3.4.m4.2.2.2.1.1.1.3.cmml">j</mi></msub><mo id="A1.SS2.p3.4.m4.2.2.2.1.1.3" maxsize="70%" minsize="70%" xref="A1.SS2.p3.4.m4.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.4.m4.2b"><apply id="A1.SS2.p3.4.m4.2.2.cmml" xref="A1.SS2.p3.4.m4.2.2"><divide id="A1.SS2.p3.4.m4.2.2.3.cmml" xref="A1.SS2.p3.4.m4.2.2.3"></divide><apply id="A1.SS2.p3.4.m4.1.1.1.cmml" xref="A1.SS2.p3.4.m4.1.1.1"><times id="A1.SS2.p3.4.m4.1.1.1.2.cmml" xref="A1.SS2.p3.4.m4.1.1.1.2"></times><ci id="A1.SS2.p3.4.m4.1.1.1.3.cmml" xref="A1.SS2.p3.4.m4.1.1.1.3">𝑃</ci><apply id="A1.SS2.p3.4.m4.1.1.1.1.1.1.cmml" xref="A1.SS2.p3.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p3.4.m4.1.1.1.1.1.1.1.cmml" xref="A1.SS2.p3.4.m4.1.1.1.1.1">subscript</csymbol><ci id="A1.SS2.p3.4.m4.1.1.1.1.1.1.2.cmml" xref="A1.SS2.p3.4.m4.1.1.1.1.1.1.2">𝑋</ci><ci id="A1.SS2.p3.4.m4.1.1.1.1.1.1.3.cmml" xref="A1.SS2.p3.4.m4.1.1.1.1.1.1.3">𝑗</ci></apply></apply><apply id="A1.SS2.p3.4.m4.2.2.2.cmml" xref="A1.SS2.p3.4.m4.2.2.2"><times id="A1.SS2.p3.4.m4.2.2.2.2.cmml" xref="A1.SS2.p3.4.m4.2.2.2.2"></times><apply id="A1.SS2.p3.4.m4.2.2.2.3.cmml" xref="A1.SS2.p3.4.m4.2.2.2.3"><csymbol cd="ambiguous" id="A1.SS2.p3.4.m4.2.2.2.3.1.cmml" xref="A1.SS2.p3.4.m4.2.2.2.3">subscript</csymbol><ci id="A1.SS2.p3.4.m4.2.2.2.3.2.cmml" xref="A1.SS2.p3.4.m4.2.2.2.3.2">𝑄</ci><ci id="A1.SS2.p3.4.m4.2.2.2.3.3.cmml" xref="A1.SS2.p3.4.m4.2.2.2.3.3">𝑓</ci></apply><apply id="A1.SS2.p3.4.m4.2.2.2.1.1.1.cmml" xref="A1.SS2.p3.4.m4.2.2.2.1.1"><csymbol cd="ambiguous" id="A1.SS2.p3.4.m4.2.2.2.1.1.1.1.cmml" xref="A1.SS2.p3.4.m4.2.2.2.1.1">subscript</csymbol><ci id="A1.SS2.p3.4.m4.2.2.2.1.1.1.2.cmml" xref="A1.SS2.p3.4.m4.2.2.2.1.1.1.2">𝑋</ci><ci id="A1.SS2.p3.4.m4.2.2.2.1.1.1.3.cmml" xref="A1.SS2.p3.4.m4.2.2.2.1.1.1.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.4.m4.2c">\nicefrac{{P\left(X_{j}\right)}}{{Q_{f}(X_{j})}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.4.m4.2d">/ start_ARG italic_P ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG start_ARG italic_Q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG</annotation></semantics></math> in any given <math alttext="X_{j}" class="ltx_Math" display="inline" id="A1.SS2.p3.5.m5.1"><semantics id="A1.SS2.p3.5.m5.1a"><msub id="A1.SS2.p3.5.m5.1.1" xref="A1.SS2.p3.5.m5.1.1.cmml"><mi id="A1.SS2.p3.5.m5.1.1.2" xref="A1.SS2.p3.5.m5.1.1.2.cmml">X</mi><mi id="A1.SS2.p3.5.m5.1.1.3" xref="A1.SS2.p3.5.m5.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.5.m5.1b"><apply id="A1.SS2.p3.5.m5.1.1.cmml" xref="A1.SS2.p3.5.m5.1.1"><csymbol cd="ambiguous" id="A1.SS2.p3.5.m5.1.1.1.cmml" xref="A1.SS2.p3.5.m5.1.1">subscript</csymbol><ci id="A1.SS2.p3.5.m5.1.1.2.cmml" xref="A1.SS2.p3.5.m5.1.1.2">𝑋</ci><ci id="A1.SS2.p3.5.m5.1.1.3.cmml" xref="A1.SS2.p3.5.m5.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.5.m5.1c">X_{j}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.5.m5.1d">italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> to a maximum value <math alttext="R" class="ltx_Math" display="inline" id="A1.SS2.p3.6.m6.1"><semantics id="A1.SS2.p3.6.m6.1a"><mi id="A1.SS2.p3.6.m6.1.1" xref="A1.SS2.p3.6.m6.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.6.m6.1b"><ci id="A1.SS2.p3.6.m6.1.1.cmml" xref="A1.SS2.p3.6.m6.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.6.m6.1c">R</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.6.m6.1d">italic_R</annotation></semantics></math> when partitioning the domain
and therefore we have that <math alttext="W\in[-1,R-1]" class="ltx_Math" display="inline" id="A1.SS2.p3.7.m7.2"><semantics id="A1.SS2.p3.7.m7.2a"><mrow id="A1.SS2.p3.7.m7.2.2" xref="A1.SS2.p3.7.m7.2.2.cmml"><mi id="A1.SS2.p3.7.m7.2.2.4" xref="A1.SS2.p3.7.m7.2.2.4.cmml">W</mi><mo id="A1.SS2.p3.7.m7.2.2.3" xref="A1.SS2.p3.7.m7.2.2.3.cmml">∈</mo><mrow id="A1.SS2.p3.7.m7.2.2.2.2" xref="A1.SS2.p3.7.m7.2.2.2.3.cmml"><mo id="A1.SS2.p3.7.m7.2.2.2.2.3" stretchy="false" xref="A1.SS2.p3.7.m7.2.2.2.3.cmml">[</mo><mrow id="A1.SS2.p3.7.m7.1.1.1.1.1" xref="A1.SS2.p3.7.m7.1.1.1.1.1.cmml"><mo id="A1.SS2.p3.7.m7.1.1.1.1.1a" xref="A1.SS2.p3.7.m7.1.1.1.1.1.cmml">−</mo><mn id="A1.SS2.p3.7.m7.1.1.1.1.1.2" xref="A1.SS2.p3.7.m7.1.1.1.1.1.2.cmml">1</mn></mrow><mo id="A1.SS2.p3.7.m7.2.2.2.2.4" xref="A1.SS2.p3.7.m7.2.2.2.3.cmml">,</mo><mrow id="A1.SS2.p3.7.m7.2.2.2.2.2" xref="A1.SS2.p3.7.m7.2.2.2.2.2.cmml"><mi id="A1.SS2.p3.7.m7.2.2.2.2.2.2" xref="A1.SS2.p3.7.m7.2.2.2.2.2.2.cmml">R</mi><mo id="A1.SS2.p3.7.m7.2.2.2.2.2.1" xref="A1.SS2.p3.7.m7.2.2.2.2.2.1.cmml">−</mo><mn id="A1.SS2.p3.7.m7.2.2.2.2.2.3" xref="A1.SS2.p3.7.m7.2.2.2.2.2.3.cmml">1</mn></mrow><mo id="A1.SS2.p3.7.m7.2.2.2.2.5" stretchy="false" xref="A1.SS2.p3.7.m7.2.2.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.7.m7.2b"><apply id="A1.SS2.p3.7.m7.2.2.cmml" xref="A1.SS2.p3.7.m7.2.2"><in id="A1.SS2.p3.7.m7.2.2.3.cmml" xref="A1.SS2.p3.7.m7.2.2.3"></in><ci id="A1.SS2.p3.7.m7.2.2.4.cmml" xref="A1.SS2.p3.7.m7.2.2.4">𝑊</ci><interval closure="closed" id="A1.SS2.p3.7.m7.2.2.2.3.cmml" xref="A1.SS2.p3.7.m7.2.2.2.2"><apply id="A1.SS2.p3.7.m7.1.1.1.1.1.cmml" xref="A1.SS2.p3.7.m7.1.1.1.1.1"><minus id="A1.SS2.p3.7.m7.1.1.1.1.1.1.cmml" xref="A1.SS2.p3.7.m7.1.1.1.1.1"></minus><cn id="A1.SS2.p3.7.m7.1.1.1.1.1.2.cmml" type="integer" xref="A1.SS2.p3.7.m7.1.1.1.1.1.2">1</cn></apply><apply id="A1.SS2.p3.7.m7.2.2.2.2.2.cmml" xref="A1.SS2.p3.7.m7.2.2.2.2.2"><minus id="A1.SS2.p3.7.m7.2.2.2.2.2.1.cmml" xref="A1.SS2.p3.7.m7.2.2.2.2.2.1"></minus><ci id="A1.SS2.p3.7.m7.2.2.2.2.2.2.cmml" xref="A1.SS2.p3.7.m7.2.2.2.2.2.2">𝑅</ci><cn id="A1.SS2.p3.7.m7.2.2.2.2.2.3.cmml" type="integer" xref="A1.SS2.p3.7.m7.2.2.2.2.2.3">1</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.7.m7.2c">W\in[-1,R-1]</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.7.m7.2d">italic_W ∈ [ - 1 , italic_R - 1 ]</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS2.p4">
<p class="ltx_p" id="A1.SS2.p4.2">Since <math alttext="W" class="ltx_Math" display="inline" id="A1.SS2.p4.1.m1.1"><semantics id="A1.SS2.p4.1.m1.1a"><mi id="A1.SS2.p4.1.m1.1.1" xref="A1.SS2.p4.1.m1.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p4.1.m1.1b"><ci id="A1.SS2.p4.1.m1.1.1.cmml" xref="A1.SS2.p4.1.m1.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p4.1.m1.1c">W</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p4.1.m1.1d">italic_W</annotation></semantics></math> is bounded, by Hoeffding’s Lemma (1963),
it is sub-gaussian with variance proxy <math alttext="R^{2}/4" class="ltx_Math" display="inline" id="A1.SS2.p4.2.m2.1"><semantics id="A1.SS2.p4.2.m2.1a"><mrow id="A1.SS2.p4.2.m2.1.1" xref="A1.SS2.p4.2.m2.1.1.cmml"><msup id="A1.SS2.p4.2.m2.1.1.2" xref="A1.SS2.p4.2.m2.1.1.2.cmml"><mi id="A1.SS2.p4.2.m2.1.1.2.2" xref="A1.SS2.p4.2.m2.1.1.2.2.cmml">R</mi><mn id="A1.SS2.p4.2.m2.1.1.2.3" xref="A1.SS2.p4.2.m2.1.1.2.3.cmml">2</mn></msup><mo id="A1.SS2.p4.2.m2.1.1.1" xref="A1.SS2.p4.2.m2.1.1.1.cmml">/</mo><mn id="A1.SS2.p4.2.m2.1.1.3" xref="A1.SS2.p4.2.m2.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p4.2.m2.1b"><apply id="A1.SS2.p4.2.m2.1.1.cmml" xref="A1.SS2.p4.2.m2.1.1"><divide id="A1.SS2.p4.2.m2.1.1.1.cmml" xref="A1.SS2.p4.2.m2.1.1.1"></divide><apply id="A1.SS2.p4.2.m2.1.1.2.cmml" xref="A1.SS2.p4.2.m2.1.1.2"><csymbol cd="ambiguous" id="A1.SS2.p4.2.m2.1.1.2.1.cmml" xref="A1.SS2.p4.2.m2.1.1.2">superscript</csymbol><ci id="A1.SS2.p4.2.m2.1.1.2.2.cmml" xref="A1.SS2.p4.2.m2.1.1.2.2">𝑅</ci><cn id="A1.SS2.p4.2.m2.1.1.2.3.cmml" type="integer" xref="A1.SS2.p4.2.m2.1.1.2.3">2</cn></apply><cn id="A1.SS2.p4.2.m2.1.1.3.cmml" type="integer" xref="A1.SS2.p4.2.m2.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p4.2.m2.1c">R^{2}/4</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p4.2.m2.1d">italic_R start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT / 4</annotation></semantics></math> and the log of its moment generating function is thus upper bounded by:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A5.EGx13">
<tbody id="A1.E49"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\log\mathbb{E}\exp\left(\alpha W\right)\leq\frac{\alpha^{2}R^{2}}%
{8}\,." class="ltx_Math" display="inline" id="A1.E49.m1.2"><semantics id="A1.E49.m1.2a"><mrow id="A1.E49.m1.2.2.1" xref="A1.E49.m1.2.2.1.1.cmml"><mrow id="A1.E49.m1.2.2.1.1" xref="A1.E49.m1.2.2.1.1.cmml"><mrow id="A1.E49.m1.2.2.1.1.1" xref="A1.E49.m1.2.2.1.1.1.cmml"><mi id="A1.E49.m1.2.2.1.1.1.2" xref="A1.E49.m1.2.2.1.1.1.2.cmml">log</mi><mo id="A1.E49.m1.2.2.1.1.1a" lspace="0.167em" xref="A1.E49.m1.2.2.1.1.1.cmml">⁡</mo><mrow id="A1.E49.m1.2.2.1.1.1.1" xref="A1.E49.m1.2.2.1.1.1.1.cmml"><mi id="A1.E49.m1.2.2.1.1.1.1.3" xref="A1.E49.m1.2.2.1.1.1.1.3.cmml">𝔼</mi><mo id="A1.E49.m1.2.2.1.1.1.1.2" lspace="0.167em" xref="A1.E49.m1.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E49.m1.2.2.1.1.1.1.1.1" xref="A1.E49.m1.2.2.1.1.1.1.1.2.cmml"><mi id="A1.E49.m1.1.1" xref="A1.E49.m1.1.1.cmml">exp</mi><mo id="A1.E49.m1.2.2.1.1.1.1.1.1a" xref="A1.E49.m1.2.2.1.1.1.1.1.2.cmml">⁡</mo><mrow id="A1.E49.m1.2.2.1.1.1.1.1.1.1" xref="A1.E49.m1.2.2.1.1.1.1.1.2.cmml"><mo id="A1.E49.m1.2.2.1.1.1.1.1.1.1.2" xref="A1.E49.m1.2.2.1.1.1.1.1.2.cmml">(</mo><mrow id="A1.E49.m1.2.2.1.1.1.1.1.1.1.1" xref="A1.E49.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E49.m1.2.2.1.1.1.1.1.1.1.1.2" xref="A1.E49.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">α</mi><mo id="A1.E49.m1.2.2.1.1.1.1.1.1.1.1.1" xref="A1.E49.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.E49.m1.2.2.1.1.1.1.1.1.1.1.3" xref="A1.E49.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">W</mi></mrow><mo id="A1.E49.m1.2.2.1.1.1.1.1.1.1.3" xref="A1.E49.m1.2.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A1.E49.m1.2.2.1.1.2" xref="A1.E49.m1.2.2.1.1.2.cmml">≤</mo><mstyle displaystyle="true" id="A1.E49.m1.2.2.1.1.3" xref="A1.E49.m1.2.2.1.1.3.cmml"><mfrac id="A1.E49.m1.2.2.1.1.3a" xref="A1.E49.m1.2.2.1.1.3.cmml"><mrow id="A1.E49.m1.2.2.1.1.3.2" xref="A1.E49.m1.2.2.1.1.3.2.cmml"><msup id="A1.E49.m1.2.2.1.1.3.2.2" xref="A1.E49.m1.2.2.1.1.3.2.2.cmml"><mi id="A1.E49.m1.2.2.1.1.3.2.2.2" xref="A1.E49.m1.2.2.1.1.3.2.2.2.cmml">α</mi><mn id="A1.E49.m1.2.2.1.1.3.2.2.3" xref="A1.E49.m1.2.2.1.1.3.2.2.3.cmml">2</mn></msup><mo id="A1.E49.m1.2.2.1.1.3.2.1" xref="A1.E49.m1.2.2.1.1.3.2.1.cmml">⁢</mo><msup id="A1.E49.m1.2.2.1.1.3.2.3" xref="A1.E49.m1.2.2.1.1.3.2.3.cmml"><mi id="A1.E49.m1.2.2.1.1.3.2.3.2" xref="A1.E49.m1.2.2.1.1.3.2.3.2.cmml">R</mi><mn id="A1.E49.m1.2.2.1.1.3.2.3.3" xref="A1.E49.m1.2.2.1.1.3.2.3.3.cmml">2</mn></msup></mrow><mn id="A1.E49.m1.2.2.1.1.3.3" xref="A1.E49.m1.2.2.1.1.3.3.cmml">8</mn></mfrac></mstyle></mrow><mo id="A1.E49.m1.2.2.1.2" lspace="0.170em" xref="A1.E49.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E49.m1.2b"><apply id="A1.E49.m1.2.2.1.1.cmml" xref="A1.E49.m1.2.2.1"><leq id="A1.E49.m1.2.2.1.1.2.cmml" xref="A1.E49.m1.2.2.1.1.2"></leq><apply id="A1.E49.m1.2.2.1.1.1.cmml" xref="A1.E49.m1.2.2.1.1.1"><log id="A1.E49.m1.2.2.1.1.1.2.cmml" xref="A1.E49.m1.2.2.1.1.1.2"></log><apply id="A1.E49.m1.2.2.1.1.1.1.cmml" xref="A1.E49.m1.2.2.1.1.1.1"><times id="A1.E49.m1.2.2.1.1.1.1.2.cmml" xref="A1.E49.m1.2.2.1.1.1.1.2"></times><ci id="A1.E49.m1.2.2.1.1.1.1.3.cmml" xref="A1.E49.m1.2.2.1.1.1.1.3">𝔼</ci><apply id="A1.E49.m1.2.2.1.1.1.1.1.2.cmml" xref="A1.E49.m1.2.2.1.1.1.1.1.1"><exp id="A1.E49.m1.1.1.cmml" xref="A1.E49.m1.1.1"></exp><apply id="A1.E49.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="A1.E49.m1.2.2.1.1.1.1.1.1.1.1"><times id="A1.E49.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E49.m1.2.2.1.1.1.1.1.1.1.1.1"></times><ci id="A1.E49.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E49.m1.2.2.1.1.1.1.1.1.1.1.2">𝛼</ci><ci id="A1.E49.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E49.m1.2.2.1.1.1.1.1.1.1.1.3">𝑊</ci></apply></apply></apply></apply><apply id="A1.E49.m1.2.2.1.1.3.cmml" xref="A1.E49.m1.2.2.1.1.3"><divide id="A1.E49.m1.2.2.1.1.3.1.cmml" xref="A1.E49.m1.2.2.1.1.3"></divide><apply id="A1.E49.m1.2.2.1.1.3.2.cmml" xref="A1.E49.m1.2.2.1.1.3.2"><times id="A1.E49.m1.2.2.1.1.3.2.1.cmml" xref="A1.E49.m1.2.2.1.1.3.2.1"></times><apply id="A1.E49.m1.2.2.1.1.3.2.2.cmml" xref="A1.E49.m1.2.2.1.1.3.2.2"><csymbol cd="ambiguous" id="A1.E49.m1.2.2.1.1.3.2.2.1.cmml" xref="A1.E49.m1.2.2.1.1.3.2.2">superscript</csymbol><ci id="A1.E49.m1.2.2.1.1.3.2.2.2.cmml" xref="A1.E49.m1.2.2.1.1.3.2.2.2">𝛼</ci><cn id="A1.E49.m1.2.2.1.1.3.2.2.3.cmml" type="integer" xref="A1.E49.m1.2.2.1.1.3.2.2.3">2</cn></apply><apply id="A1.E49.m1.2.2.1.1.3.2.3.cmml" xref="A1.E49.m1.2.2.1.1.3.2.3"><csymbol cd="ambiguous" id="A1.E49.m1.2.2.1.1.3.2.3.1.cmml" xref="A1.E49.m1.2.2.1.1.3.2.3">superscript</csymbol><ci id="A1.E49.m1.2.2.1.1.3.2.3.2.cmml" xref="A1.E49.m1.2.2.1.1.3.2.3.2">𝑅</ci><cn id="A1.E49.m1.2.2.1.1.3.2.3.3.cmml" type="integer" xref="A1.E49.m1.2.2.1.1.3.2.3.3">2</cn></apply></apply><cn id="A1.E49.m1.2.2.1.1.3.3.cmml" type="integer" xref="A1.E49.m1.2.2.1.1.3.3">8</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E49.m1.2c">\displaystyle\log\mathbb{E}\exp\left(\alpha W\right)\leq\frac{\alpha^{2}R^{2}}%
{8}\,.</annotation><annotation encoding="application/x-llamapun" id="A1.E49.m1.2d">roman_log blackboard_E roman_exp ( italic_α italic_W ) ≤ divide start_ARG italic_α start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_R start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG 8 end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(49)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS2.p5">
<p class="ltx_p" id="A1.SS2.p5.5">As a result, we have the following lower bound on the log-likelihood increase:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A5.EGx14">
<tbody id="A1.E50"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle L[f+\alpha\cdot\delta f]-L[f]" class="ltx_Math" display="inline" id="A1.E50.m1.2"><semantics id="A1.E50.m1.2a"><mrow id="A1.E50.m1.2.2" xref="A1.E50.m1.2.2.cmml"><mrow id="A1.E50.m1.2.2.1" xref="A1.E50.m1.2.2.1.cmml"><mi id="A1.E50.m1.2.2.1.3" xref="A1.E50.m1.2.2.1.3.cmml">L</mi><mo id="A1.E50.m1.2.2.1.2" xref="A1.E50.m1.2.2.1.2.cmml">⁢</mo><mrow id="A1.E50.m1.2.2.1.1.1" xref="A1.E50.m1.2.2.1.1.2.cmml"><mo id="A1.E50.m1.2.2.1.1.1.2" stretchy="false" xref="A1.E50.m1.2.2.1.1.2.1.cmml">[</mo><mrow id="A1.E50.m1.2.2.1.1.1.1" xref="A1.E50.m1.2.2.1.1.1.1.cmml"><mi id="A1.E50.m1.2.2.1.1.1.1.2" xref="A1.E50.m1.2.2.1.1.1.1.2.cmml">f</mi><mo id="A1.E50.m1.2.2.1.1.1.1.1" xref="A1.E50.m1.2.2.1.1.1.1.1.cmml">+</mo><mrow id="A1.E50.m1.2.2.1.1.1.1.3" xref="A1.E50.m1.2.2.1.1.1.1.3.cmml"><mrow id="A1.E50.m1.2.2.1.1.1.1.3.2" xref="A1.E50.m1.2.2.1.1.1.1.3.2.cmml"><mi id="A1.E50.m1.2.2.1.1.1.1.3.2.2" xref="A1.E50.m1.2.2.1.1.1.1.3.2.2.cmml">α</mi><mo id="A1.E50.m1.2.2.1.1.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="A1.E50.m1.2.2.1.1.1.1.3.2.1.cmml">⋅</mo><mi id="A1.E50.m1.2.2.1.1.1.1.3.2.3" xref="A1.E50.m1.2.2.1.1.1.1.3.2.3.cmml">δ</mi></mrow><mo id="A1.E50.m1.2.2.1.1.1.1.3.1" xref="A1.E50.m1.2.2.1.1.1.1.3.1.cmml">⁢</mo><mi id="A1.E50.m1.2.2.1.1.1.1.3.3" xref="A1.E50.m1.2.2.1.1.1.1.3.3.cmml">f</mi></mrow></mrow><mo id="A1.E50.m1.2.2.1.1.1.3" stretchy="false" xref="A1.E50.m1.2.2.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="A1.E50.m1.2.2.2" xref="A1.E50.m1.2.2.2.cmml">−</mo><mrow id="A1.E50.m1.2.2.3" xref="A1.E50.m1.2.2.3.cmml"><mi id="A1.E50.m1.2.2.3.2" xref="A1.E50.m1.2.2.3.2.cmml">L</mi><mo id="A1.E50.m1.2.2.3.1" xref="A1.E50.m1.2.2.3.1.cmml">⁢</mo><mrow id="A1.E50.m1.2.2.3.3.2" xref="A1.E50.m1.2.2.3.3.1.cmml"><mo id="A1.E50.m1.2.2.3.3.2.1" stretchy="false" xref="A1.E50.m1.2.2.3.3.1.1.cmml">[</mo><mi id="A1.E50.m1.1.1" xref="A1.E50.m1.1.1.cmml">f</mi><mo id="A1.E50.m1.2.2.3.3.2.2" stretchy="false" xref="A1.E50.m1.2.2.3.3.1.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E50.m1.2b"><apply id="A1.E50.m1.2.2.cmml" xref="A1.E50.m1.2.2"><minus id="A1.E50.m1.2.2.2.cmml" xref="A1.E50.m1.2.2.2"></minus><apply id="A1.E50.m1.2.2.1.cmml" xref="A1.E50.m1.2.2.1"><times id="A1.E50.m1.2.2.1.2.cmml" xref="A1.E50.m1.2.2.1.2"></times><ci id="A1.E50.m1.2.2.1.3.cmml" xref="A1.E50.m1.2.2.1.3">𝐿</ci><apply id="A1.E50.m1.2.2.1.1.2.cmml" xref="A1.E50.m1.2.2.1.1.1"><csymbol cd="latexml" id="A1.E50.m1.2.2.1.1.2.1.cmml" xref="A1.E50.m1.2.2.1.1.1.2">delimited-[]</csymbol><apply id="A1.E50.m1.2.2.1.1.1.1.cmml" xref="A1.E50.m1.2.2.1.1.1.1"><plus id="A1.E50.m1.2.2.1.1.1.1.1.cmml" xref="A1.E50.m1.2.2.1.1.1.1.1"></plus><ci id="A1.E50.m1.2.2.1.1.1.1.2.cmml" xref="A1.E50.m1.2.2.1.1.1.1.2">𝑓</ci><apply id="A1.E50.m1.2.2.1.1.1.1.3.cmml" xref="A1.E50.m1.2.2.1.1.1.1.3"><times id="A1.E50.m1.2.2.1.1.1.1.3.1.cmml" xref="A1.E50.m1.2.2.1.1.1.1.3.1"></times><apply id="A1.E50.m1.2.2.1.1.1.1.3.2.cmml" xref="A1.E50.m1.2.2.1.1.1.1.3.2"><ci id="A1.E50.m1.2.2.1.1.1.1.3.2.1.cmml" xref="A1.E50.m1.2.2.1.1.1.1.3.2.1">⋅</ci><ci id="A1.E50.m1.2.2.1.1.1.1.3.2.2.cmml" xref="A1.E50.m1.2.2.1.1.1.1.3.2.2">𝛼</ci><ci id="A1.E50.m1.2.2.1.1.1.1.3.2.3.cmml" xref="A1.E50.m1.2.2.1.1.1.1.3.2.3">𝛿</ci></apply><ci id="A1.E50.m1.2.2.1.1.1.1.3.3.cmml" xref="A1.E50.m1.2.2.1.1.1.1.3.3">𝑓</ci></apply></apply></apply></apply><apply id="A1.E50.m1.2.2.3.cmml" xref="A1.E50.m1.2.2.3"><times id="A1.E50.m1.2.2.3.1.cmml" xref="A1.E50.m1.2.2.3.1"></times><ci id="A1.E50.m1.2.2.3.2.cmml" xref="A1.E50.m1.2.2.3.2">𝐿</ci><apply id="A1.E50.m1.2.2.3.3.1.cmml" xref="A1.E50.m1.2.2.3.3.2"><csymbol cd="latexml" id="A1.E50.m1.2.2.3.3.1.1.cmml" xref="A1.E50.m1.2.2.3.3.2.1">delimited-[]</csymbol><ci id="A1.E50.m1.1.1.cmml" xref="A1.E50.m1.1.1">𝑓</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E50.m1.2c">\displaystyle L[f+\alpha\cdot\delta f]-L[f]</annotation><annotation encoding="application/x-llamapun" id="A1.E50.m1.2d">italic_L [ italic_f + italic_α ⋅ italic_δ italic_f ] - italic_L [ italic_f ]</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\geq\alpha\left[\chi^{2}(P\|Q_{f})-\alpha\frac{R^{2}}{8}\right]\,." class="ltx_Math" display="inline" id="A1.E50.m2.1"><semantics id="A1.E50.m2.1a"><mrow id="A1.E50.m2.1.1.1" xref="A1.E50.m2.1.1.1.1.cmml"><mrow id="A1.E50.m2.1.1.1.1" xref="A1.E50.m2.1.1.1.1.cmml"><mi id="A1.E50.m2.1.1.1.1.3" xref="A1.E50.m2.1.1.1.1.3.cmml"></mi><mo id="A1.E50.m2.1.1.1.1.2" xref="A1.E50.m2.1.1.1.1.2.cmml">≥</mo><mrow id="A1.E50.m2.1.1.1.1.1" xref="A1.E50.m2.1.1.1.1.1.cmml"><mi id="A1.E50.m2.1.1.1.1.1.3" xref="A1.E50.m2.1.1.1.1.1.3.cmml">α</mi><mo id="A1.E50.m2.1.1.1.1.1.2" xref="A1.E50.m2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E50.m2.1.1.1.1.1.1.1" xref="A1.E50.m2.1.1.1.1.1.1.2.cmml"><mo id="A1.E50.m2.1.1.1.1.1.1.1.2" xref="A1.E50.m2.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="A1.E50.m2.1.1.1.1.1.1.1.1" xref="A1.E50.m2.1.1.1.1.1.1.1.1.cmml"><mrow id="A1.E50.m2.1.1.1.1.1.1.1.1.1" xref="A1.E50.m2.1.1.1.1.1.1.1.1.1.cmml"><msup id="A1.E50.m2.1.1.1.1.1.1.1.1.1.3" xref="A1.E50.m2.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E50.m2.1.1.1.1.1.1.1.1.1.3.2" xref="A1.E50.m2.1.1.1.1.1.1.1.1.1.3.2.cmml">χ</mi><mn id="A1.E50.m2.1.1.1.1.1.1.1.1.1.3.3" xref="A1.E50.m2.1.1.1.1.1.1.1.1.1.3.3.cmml">2</mn></msup><mo id="A1.E50.m2.1.1.1.1.1.1.1.1.1.2" xref="A1.E50.m2.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E50.m2.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E50.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E50.m2.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E50.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E50.m2.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E50.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E50.m2.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E50.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">P</mi><mo id="A1.E50.m2.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E50.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">∥</mo><msub id="A1.E50.m2.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E50.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E50.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="A1.E50.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">Q</mi><mi id="A1.E50.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="A1.E50.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">f</mi></msub></mrow><mo id="A1.E50.m2.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E50.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E50.m2.1.1.1.1.1.1.1.1.2" xref="A1.E50.m2.1.1.1.1.1.1.1.1.2.cmml">−</mo><mrow id="A1.E50.m2.1.1.1.1.1.1.1.1.3" xref="A1.E50.m2.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E50.m2.1.1.1.1.1.1.1.1.3.2" xref="A1.E50.m2.1.1.1.1.1.1.1.1.3.2.cmml">α</mi><mo id="A1.E50.m2.1.1.1.1.1.1.1.1.3.1" xref="A1.E50.m2.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mstyle displaystyle="true" id="A1.E50.m2.1.1.1.1.1.1.1.1.3.3" xref="A1.E50.m2.1.1.1.1.1.1.1.1.3.3.cmml"><mfrac id="A1.E50.m2.1.1.1.1.1.1.1.1.3.3a" xref="A1.E50.m2.1.1.1.1.1.1.1.1.3.3.cmml"><msup id="A1.E50.m2.1.1.1.1.1.1.1.1.3.3.2" xref="A1.E50.m2.1.1.1.1.1.1.1.1.3.3.2.cmml"><mi id="A1.E50.m2.1.1.1.1.1.1.1.1.3.3.2.2" xref="A1.E50.m2.1.1.1.1.1.1.1.1.3.3.2.2.cmml">R</mi><mn id="A1.E50.m2.1.1.1.1.1.1.1.1.3.3.2.3" xref="A1.E50.m2.1.1.1.1.1.1.1.1.3.3.2.3.cmml">2</mn></msup><mn id="A1.E50.m2.1.1.1.1.1.1.1.1.3.3.3" xref="A1.E50.m2.1.1.1.1.1.1.1.1.3.3.3.cmml">8</mn></mfrac></mstyle></mrow></mrow><mo id="A1.E50.m2.1.1.1.1.1.1.1.3" xref="A1.E50.m2.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="A1.E50.m2.1.1.1.2" lspace="0.170em" xref="A1.E50.m2.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E50.m2.1b"><apply id="A1.E50.m2.1.1.1.1.cmml" xref="A1.E50.m2.1.1.1"><geq id="A1.E50.m2.1.1.1.1.2.cmml" xref="A1.E50.m2.1.1.1.1.2"></geq><csymbol cd="latexml" id="A1.E50.m2.1.1.1.1.3.cmml" xref="A1.E50.m2.1.1.1.1.3">absent</csymbol><apply id="A1.E50.m2.1.1.1.1.1.cmml" xref="A1.E50.m2.1.1.1.1.1"><times id="A1.E50.m2.1.1.1.1.1.2.cmml" xref="A1.E50.m2.1.1.1.1.1.2"></times><ci id="A1.E50.m2.1.1.1.1.1.3.cmml" xref="A1.E50.m2.1.1.1.1.1.3">𝛼</ci><apply id="A1.E50.m2.1.1.1.1.1.1.2.cmml" xref="A1.E50.m2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E50.m2.1.1.1.1.1.1.2.1.cmml" xref="A1.E50.m2.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A1.E50.m2.1.1.1.1.1.1.1.1.cmml" xref="A1.E50.m2.1.1.1.1.1.1.1.1"><minus id="A1.E50.m2.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E50.m2.1.1.1.1.1.1.1.1.2"></minus><apply id="A1.E50.m2.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E50.m2.1.1.1.1.1.1.1.1.1"><times id="A1.E50.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E50.m2.1.1.1.1.1.1.1.1.1.2"></times><apply id="A1.E50.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E50.m2.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E50.m2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E50.m2.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="A1.E50.m2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E50.m2.1.1.1.1.1.1.1.1.1.3.2">𝜒</ci><cn id="A1.E50.m2.1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="A1.E50.m2.1.1.1.1.1.1.1.1.1.3.3">2</cn></apply><apply id="A1.E50.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E50.m2.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E50.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E50.m2.1.1.1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="A1.E50.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E50.m2.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑃</ci><apply id="A1.E50.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E50.m2.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E50.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E50.m2.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E50.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E50.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑄</ci><ci id="A1.E50.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E50.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑓</ci></apply></apply></apply><apply id="A1.E50.m2.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E50.m2.1.1.1.1.1.1.1.1.3"><times id="A1.E50.m2.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E50.m2.1.1.1.1.1.1.1.1.3.1"></times><ci id="A1.E50.m2.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E50.m2.1.1.1.1.1.1.1.1.3.2">𝛼</ci><apply id="A1.E50.m2.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E50.m2.1.1.1.1.1.1.1.1.3.3"><divide id="A1.E50.m2.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A1.E50.m2.1.1.1.1.1.1.1.1.3.3"></divide><apply id="A1.E50.m2.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="A1.E50.m2.1.1.1.1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="A1.E50.m2.1.1.1.1.1.1.1.1.3.3.2.1.cmml" xref="A1.E50.m2.1.1.1.1.1.1.1.1.3.3.2">superscript</csymbol><ci id="A1.E50.m2.1.1.1.1.1.1.1.1.3.3.2.2.cmml" xref="A1.E50.m2.1.1.1.1.1.1.1.1.3.3.2.2">𝑅</ci><cn id="A1.E50.m2.1.1.1.1.1.1.1.1.3.3.2.3.cmml" type="integer" xref="A1.E50.m2.1.1.1.1.1.1.1.1.3.3.2.3">2</cn></apply><cn id="A1.E50.m2.1.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="A1.E50.m2.1.1.1.1.1.1.1.1.3.3.3">8</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E50.m2.1c">\displaystyle\geq\alpha\left[\chi^{2}(P\|Q_{f})-\alpha\frac{R^{2}}{8}\right]\,.</annotation><annotation encoding="application/x-llamapun" id="A1.E50.m2.1d">≥ italic_α [ italic_χ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ( italic_P ∥ italic_Q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT ) - italic_α divide start_ARG italic_R start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG 8 end_ARG ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(50)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS2.p5.4">As long as in the current round of boosting a partitioning of the input space can be found that yields a non-zero <math alttext="\chi^{2}(P\|Q_{f})" class="ltx_Math" display="inline" id="A1.SS2.p5.1.m1.1"><semantics id="A1.SS2.p5.1.m1.1a"><mrow id="A1.SS2.p5.1.m1.1.1" xref="A1.SS2.p5.1.m1.1.1.cmml"><msup id="A1.SS2.p5.1.m1.1.1.3" xref="A1.SS2.p5.1.m1.1.1.3.cmml"><mi id="A1.SS2.p5.1.m1.1.1.3.2" xref="A1.SS2.p5.1.m1.1.1.3.2.cmml">χ</mi><mn id="A1.SS2.p5.1.m1.1.1.3.3" xref="A1.SS2.p5.1.m1.1.1.3.3.cmml">2</mn></msup><mo id="A1.SS2.p5.1.m1.1.1.2" xref="A1.SS2.p5.1.m1.1.1.2.cmml">⁢</mo><mrow id="A1.SS2.p5.1.m1.1.1.1.1" xref="A1.SS2.p5.1.m1.1.1.1.1.1.cmml"><mo id="A1.SS2.p5.1.m1.1.1.1.1.2" stretchy="false" xref="A1.SS2.p5.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="A1.SS2.p5.1.m1.1.1.1.1.1" xref="A1.SS2.p5.1.m1.1.1.1.1.1.cmml"><mi id="A1.SS2.p5.1.m1.1.1.1.1.1.2" xref="A1.SS2.p5.1.m1.1.1.1.1.1.2.cmml">P</mi><mo id="A1.SS2.p5.1.m1.1.1.1.1.1.1" xref="A1.SS2.p5.1.m1.1.1.1.1.1.1.cmml">∥</mo><msub id="A1.SS2.p5.1.m1.1.1.1.1.1.3" xref="A1.SS2.p5.1.m1.1.1.1.1.1.3.cmml"><mi id="A1.SS2.p5.1.m1.1.1.1.1.1.3.2" xref="A1.SS2.p5.1.m1.1.1.1.1.1.3.2.cmml">Q</mi><mi id="A1.SS2.p5.1.m1.1.1.1.1.1.3.3" xref="A1.SS2.p5.1.m1.1.1.1.1.1.3.3.cmml">f</mi></msub></mrow><mo id="A1.SS2.p5.1.m1.1.1.1.1.3" stretchy="false" xref="A1.SS2.p5.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p5.1.m1.1b"><apply id="A1.SS2.p5.1.m1.1.1.cmml" xref="A1.SS2.p5.1.m1.1.1"><times id="A1.SS2.p5.1.m1.1.1.2.cmml" xref="A1.SS2.p5.1.m1.1.1.2"></times><apply id="A1.SS2.p5.1.m1.1.1.3.cmml" xref="A1.SS2.p5.1.m1.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p5.1.m1.1.1.3.1.cmml" xref="A1.SS2.p5.1.m1.1.1.3">superscript</csymbol><ci id="A1.SS2.p5.1.m1.1.1.3.2.cmml" xref="A1.SS2.p5.1.m1.1.1.3.2">𝜒</ci><cn id="A1.SS2.p5.1.m1.1.1.3.3.cmml" type="integer" xref="A1.SS2.p5.1.m1.1.1.3.3">2</cn></apply><apply id="A1.SS2.p5.1.m1.1.1.1.1.1.cmml" xref="A1.SS2.p5.1.m1.1.1.1.1"><csymbol cd="latexml" id="A1.SS2.p5.1.m1.1.1.1.1.1.1.cmml" xref="A1.SS2.p5.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="A1.SS2.p5.1.m1.1.1.1.1.1.2.cmml" xref="A1.SS2.p5.1.m1.1.1.1.1.1.2">𝑃</ci><apply id="A1.SS2.p5.1.m1.1.1.1.1.1.3.cmml" xref="A1.SS2.p5.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p5.1.m1.1.1.1.1.1.3.1.cmml" xref="A1.SS2.p5.1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.SS2.p5.1.m1.1.1.1.1.1.3.2.cmml" xref="A1.SS2.p5.1.m1.1.1.1.1.1.3.2">𝑄</ci><ci id="A1.SS2.p5.1.m1.1.1.1.1.1.3.3.cmml" xref="A1.SS2.p5.1.m1.1.1.1.1.1.3.3">𝑓</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p5.1.m1.1c">\chi^{2}(P\|Q_{f})</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p5.1.m1.1d">italic_χ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ( italic_P ∥ italic_Q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT )</annotation></semantics></math>,
the likelihood is guaranteed to increase as long as we choose a small enough step-size: <math alttext="\alpha\in\left(0,\frac{8}{R^{2}}\chi^{2}(P\|Q_{f})\right)" class="ltx_Math" display="inline" id="A1.SS2.p5.2.m2.2"><semantics id="A1.SS2.p5.2.m2.2a"><mrow id="A1.SS2.p5.2.m2.2.2" xref="A1.SS2.p5.2.m2.2.2.cmml"><mi id="A1.SS2.p5.2.m2.2.2.3" xref="A1.SS2.p5.2.m2.2.2.3.cmml">α</mi><mo id="A1.SS2.p5.2.m2.2.2.2" xref="A1.SS2.p5.2.m2.2.2.2.cmml">∈</mo><mrow id="A1.SS2.p5.2.m2.2.2.1.1" xref="A1.SS2.p5.2.m2.2.2.1.2.cmml"><mo id="A1.SS2.p5.2.m2.2.2.1.1.2" xref="A1.SS2.p5.2.m2.2.2.1.2.cmml">(</mo><mn id="A1.SS2.p5.2.m2.1.1" xref="A1.SS2.p5.2.m2.1.1.cmml">0</mn><mo id="A1.SS2.p5.2.m2.2.2.1.1.3" xref="A1.SS2.p5.2.m2.2.2.1.2.cmml">,</mo><mrow id="A1.SS2.p5.2.m2.2.2.1.1.1" xref="A1.SS2.p5.2.m2.2.2.1.1.1.cmml"><mfrac id="A1.SS2.p5.2.m2.2.2.1.1.1.3" xref="A1.SS2.p5.2.m2.2.2.1.1.1.3.cmml"><mn id="A1.SS2.p5.2.m2.2.2.1.1.1.3.2" xref="A1.SS2.p5.2.m2.2.2.1.1.1.3.2.cmml">8</mn><msup id="A1.SS2.p5.2.m2.2.2.1.1.1.3.3" xref="A1.SS2.p5.2.m2.2.2.1.1.1.3.3.cmml"><mi id="A1.SS2.p5.2.m2.2.2.1.1.1.3.3.2" xref="A1.SS2.p5.2.m2.2.2.1.1.1.3.3.2.cmml">R</mi><mn id="A1.SS2.p5.2.m2.2.2.1.1.1.3.3.3" xref="A1.SS2.p5.2.m2.2.2.1.1.1.3.3.3.cmml">2</mn></msup></mfrac><mo id="A1.SS2.p5.2.m2.2.2.1.1.1.2" xref="A1.SS2.p5.2.m2.2.2.1.1.1.2.cmml">⁢</mo><msup id="A1.SS2.p5.2.m2.2.2.1.1.1.4" xref="A1.SS2.p5.2.m2.2.2.1.1.1.4.cmml"><mi id="A1.SS2.p5.2.m2.2.2.1.1.1.4.2" xref="A1.SS2.p5.2.m2.2.2.1.1.1.4.2.cmml">χ</mi><mn id="A1.SS2.p5.2.m2.2.2.1.1.1.4.3" xref="A1.SS2.p5.2.m2.2.2.1.1.1.4.3.cmml">2</mn></msup><mo id="A1.SS2.p5.2.m2.2.2.1.1.1.2a" xref="A1.SS2.p5.2.m2.2.2.1.1.1.2.cmml">⁢</mo><mrow id="A1.SS2.p5.2.m2.2.2.1.1.1.1.1" xref="A1.SS2.p5.2.m2.2.2.1.1.1.1.1.1.cmml"><mo id="A1.SS2.p5.2.m2.2.2.1.1.1.1.1.2" stretchy="false" xref="A1.SS2.p5.2.m2.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.SS2.p5.2.m2.2.2.1.1.1.1.1.1" xref="A1.SS2.p5.2.m2.2.2.1.1.1.1.1.1.cmml"><mi id="A1.SS2.p5.2.m2.2.2.1.1.1.1.1.1.2" xref="A1.SS2.p5.2.m2.2.2.1.1.1.1.1.1.2.cmml">P</mi><mo id="A1.SS2.p5.2.m2.2.2.1.1.1.1.1.1.1" xref="A1.SS2.p5.2.m2.2.2.1.1.1.1.1.1.1.cmml">∥</mo><msub id="A1.SS2.p5.2.m2.2.2.1.1.1.1.1.1.3" xref="A1.SS2.p5.2.m2.2.2.1.1.1.1.1.1.3.cmml"><mi id="A1.SS2.p5.2.m2.2.2.1.1.1.1.1.1.3.2" xref="A1.SS2.p5.2.m2.2.2.1.1.1.1.1.1.3.2.cmml">Q</mi><mi id="A1.SS2.p5.2.m2.2.2.1.1.1.1.1.1.3.3" xref="A1.SS2.p5.2.m2.2.2.1.1.1.1.1.1.3.3.cmml">f</mi></msub></mrow><mo id="A1.SS2.p5.2.m2.2.2.1.1.1.1.1.3" stretchy="false" xref="A1.SS2.p5.2.m2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.SS2.p5.2.m2.2.2.1.1.4" xref="A1.SS2.p5.2.m2.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p5.2.m2.2b"><apply id="A1.SS2.p5.2.m2.2.2.cmml" xref="A1.SS2.p5.2.m2.2.2"><in id="A1.SS2.p5.2.m2.2.2.2.cmml" xref="A1.SS2.p5.2.m2.2.2.2"></in><ci id="A1.SS2.p5.2.m2.2.2.3.cmml" xref="A1.SS2.p5.2.m2.2.2.3">𝛼</ci><interval closure="open" id="A1.SS2.p5.2.m2.2.2.1.2.cmml" xref="A1.SS2.p5.2.m2.2.2.1.1"><cn id="A1.SS2.p5.2.m2.1.1.cmml" type="integer" xref="A1.SS2.p5.2.m2.1.1">0</cn><apply id="A1.SS2.p5.2.m2.2.2.1.1.1.cmml" xref="A1.SS2.p5.2.m2.2.2.1.1.1"><times id="A1.SS2.p5.2.m2.2.2.1.1.1.2.cmml" xref="A1.SS2.p5.2.m2.2.2.1.1.1.2"></times><apply id="A1.SS2.p5.2.m2.2.2.1.1.1.3.cmml" xref="A1.SS2.p5.2.m2.2.2.1.1.1.3"><divide id="A1.SS2.p5.2.m2.2.2.1.1.1.3.1.cmml" xref="A1.SS2.p5.2.m2.2.2.1.1.1.3"></divide><cn id="A1.SS2.p5.2.m2.2.2.1.1.1.3.2.cmml" type="integer" xref="A1.SS2.p5.2.m2.2.2.1.1.1.3.2">8</cn><apply id="A1.SS2.p5.2.m2.2.2.1.1.1.3.3.cmml" xref="A1.SS2.p5.2.m2.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.SS2.p5.2.m2.2.2.1.1.1.3.3.1.cmml" xref="A1.SS2.p5.2.m2.2.2.1.1.1.3.3">superscript</csymbol><ci id="A1.SS2.p5.2.m2.2.2.1.1.1.3.3.2.cmml" xref="A1.SS2.p5.2.m2.2.2.1.1.1.3.3.2">𝑅</ci><cn id="A1.SS2.p5.2.m2.2.2.1.1.1.3.3.3.cmml" type="integer" xref="A1.SS2.p5.2.m2.2.2.1.1.1.3.3.3">2</cn></apply></apply><apply id="A1.SS2.p5.2.m2.2.2.1.1.1.4.cmml" xref="A1.SS2.p5.2.m2.2.2.1.1.1.4"><csymbol cd="ambiguous" id="A1.SS2.p5.2.m2.2.2.1.1.1.4.1.cmml" xref="A1.SS2.p5.2.m2.2.2.1.1.1.4">superscript</csymbol><ci id="A1.SS2.p5.2.m2.2.2.1.1.1.4.2.cmml" xref="A1.SS2.p5.2.m2.2.2.1.1.1.4.2">𝜒</ci><cn id="A1.SS2.p5.2.m2.2.2.1.1.1.4.3.cmml" type="integer" xref="A1.SS2.p5.2.m2.2.2.1.1.1.4.3">2</cn></apply><apply id="A1.SS2.p5.2.m2.2.2.1.1.1.1.1.1.cmml" xref="A1.SS2.p5.2.m2.2.2.1.1.1.1.1"><csymbol cd="latexml" id="A1.SS2.p5.2.m2.2.2.1.1.1.1.1.1.1.cmml" xref="A1.SS2.p5.2.m2.2.2.1.1.1.1.1.1.1">conditional</csymbol><ci id="A1.SS2.p5.2.m2.2.2.1.1.1.1.1.1.2.cmml" xref="A1.SS2.p5.2.m2.2.2.1.1.1.1.1.1.2">𝑃</ci><apply id="A1.SS2.p5.2.m2.2.2.1.1.1.1.1.1.3.cmml" xref="A1.SS2.p5.2.m2.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p5.2.m2.2.2.1.1.1.1.1.1.3.1.cmml" xref="A1.SS2.p5.2.m2.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.SS2.p5.2.m2.2.2.1.1.1.1.1.1.3.2.cmml" xref="A1.SS2.p5.2.m2.2.2.1.1.1.1.1.1.3.2">𝑄</ci><ci id="A1.SS2.p5.2.m2.2.2.1.1.1.1.1.1.3.3.cmml" xref="A1.SS2.p5.2.m2.2.2.1.1.1.1.1.1.3.3">𝑓</ci></apply></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p5.2.m2.2c">\alpha\in\left(0,\frac{8}{R^{2}}\chi^{2}(P\|Q_{f})\right)</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p5.2.m2.2d">italic_α ∈ ( 0 , divide start_ARG 8 end_ARG start_ARG italic_R start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG italic_χ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ( italic_P ∥ italic_Q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT ) )</annotation></semantics></math>.
In particular, choosing a step size <math alttext="\alpha=\frac{4}{R^{2}}\chi^{2}(P\|Q_{f})" class="ltx_Math" display="inline" id="A1.SS2.p5.3.m3.1"><semantics id="A1.SS2.p5.3.m3.1a"><mrow id="A1.SS2.p5.3.m3.1.1" xref="A1.SS2.p5.3.m3.1.1.cmml"><mi id="A1.SS2.p5.3.m3.1.1.3" xref="A1.SS2.p5.3.m3.1.1.3.cmml">α</mi><mo id="A1.SS2.p5.3.m3.1.1.2" xref="A1.SS2.p5.3.m3.1.1.2.cmml">=</mo><mrow id="A1.SS2.p5.3.m3.1.1.1" xref="A1.SS2.p5.3.m3.1.1.1.cmml"><mfrac id="A1.SS2.p5.3.m3.1.1.1.3" xref="A1.SS2.p5.3.m3.1.1.1.3.cmml"><mn id="A1.SS2.p5.3.m3.1.1.1.3.2" xref="A1.SS2.p5.3.m3.1.1.1.3.2.cmml">4</mn><msup id="A1.SS2.p5.3.m3.1.1.1.3.3" xref="A1.SS2.p5.3.m3.1.1.1.3.3.cmml"><mi id="A1.SS2.p5.3.m3.1.1.1.3.3.2" xref="A1.SS2.p5.3.m3.1.1.1.3.3.2.cmml">R</mi><mn id="A1.SS2.p5.3.m3.1.1.1.3.3.3" xref="A1.SS2.p5.3.m3.1.1.1.3.3.3.cmml">2</mn></msup></mfrac><mo id="A1.SS2.p5.3.m3.1.1.1.2" xref="A1.SS2.p5.3.m3.1.1.1.2.cmml">⁢</mo><msup id="A1.SS2.p5.3.m3.1.1.1.4" xref="A1.SS2.p5.3.m3.1.1.1.4.cmml"><mi id="A1.SS2.p5.3.m3.1.1.1.4.2" xref="A1.SS2.p5.3.m3.1.1.1.4.2.cmml">χ</mi><mn id="A1.SS2.p5.3.m3.1.1.1.4.3" xref="A1.SS2.p5.3.m3.1.1.1.4.3.cmml">2</mn></msup><mo id="A1.SS2.p5.3.m3.1.1.1.2a" xref="A1.SS2.p5.3.m3.1.1.1.2.cmml">⁢</mo><mrow id="A1.SS2.p5.3.m3.1.1.1.1.1" xref="A1.SS2.p5.3.m3.1.1.1.1.1.1.cmml"><mo id="A1.SS2.p5.3.m3.1.1.1.1.1.2" stretchy="false" xref="A1.SS2.p5.3.m3.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.SS2.p5.3.m3.1.1.1.1.1.1" xref="A1.SS2.p5.3.m3.1.1.1.1.1.1.cmml"><mi id="A1.SS2.p5.3.m3.1.1.1.1.1.1.2" xref="A1.SS2.p5.3.m3.1.1.1.1.1.1.2.cmml">P</mi><mo id="A1.SS2.p5.3.m3.1.1.1.1.1.1.1" xref="A1.SS2.p5.3.m3.1.1.1.1.1.1.1.cmml">∥</mo><msub id="A1.SS2.p5.3.m3.1.1.1.1.1.1.3" xref="A1.SS2.p5.3.m3.1.1.1.1.1.1.3.cmml"><mi id="A1.SS2.p5.3.m3.1.1.1.1.1.1.3.2" xref="A1.SS2.p5.3.m3.1.1.1.1.1.1.3.2.cmml">Q</mi><mi id="A1.SS2.p5.3.m3.1.1.1.1.1.1.3.3" xref="A1.SS2.p5.3.m3.1.1.1.1.1.1.3.3.cmml">f</mi></msub></mrow><mo id="A1.SS2.p5.3.m3.1.1.1.1.1.3" stretchy="false" xref="A1.SS2.p5.3.m3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p5.3.m3.1b"><apply id="A1.SS2.p5.3.m3.1.1.cmml" xref="A1.SS2.p5.3.m3.1.1"><eq id="A1.SS2.p5.3.m3.1.1.2.cmml" xref="A1.SS2.p5.3.m3.1.1.2"></eq><ci id="A1.SS2.p5.3.m3.1.1.3.cmml" xref="A1.SS2.p5.3.m3.1.1.3">𝛼</ci><apply id="A1.SS2.p5.3.m3.1.1.1.cmml" xref="A1.SS2.p5.3.m3.1.1.1"><times id="A1.SS2.p5.3.m3.1.1.1.2.cmml" xref="A1.SS2.p5.3.m3.1.1.1.2"></times><apply id="A1.SS2.p5.3.m3.1.1.1.3.cmml" xref="A1.SS2.p5.3.m3.1.1.1.3"><divide id="A1.SS2.p5.3.m3.1.1.1.3.1.cmml" xref="A1.SS2.p5.3.m3.1.1.1.3"></divide><cn id="A1.SS2.p5.3.m3.1.1.1.3.2.cmml" type="integer" xref="A1.SS2.p5.3.m3.1.1.1.3.2">4</cn><apply id="A1.SS2.p5.3.m3.1.1.1.3.3.cmml" xref="A1.SS2.p5.3.m3.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.SS2.p5.3.m3.1.1.1.3.3.1.cmml" xref="A1.SS2.p5.3.m3.1.1.1.3.3">superscript</csymbol><ci id="A1.SS2.p5.3.m3.1.1.1.3.3.2.cmml" xref="A1.SS2.p5.3.m3.1.1.1.3.3.2">𝑅</ci><cn id="A1.SS2.p5.3.m3.1.1.1.3.3.3.cmml" type="integer" xref="A1.SS2.p5.3.m3.1.1.1.3.3.3">2</cn></apply></apply><apply id="A1.SS2.p5.3.m3.1.1.1.4.cmml" xref="A1.SS2.p5.3.m3.1.1.1.4"><csymbol cd="ambiguous" id="A1.SS2.p5.3.m3.1.1.1.4.1.cmml" xref="A1.SS2.p5.3.m3.1.1.1.4">superscript</csymbol><ci id="A1.SS2.p5.3.m3.1.1.1.4.2.cmml" xref="A1.SS2.p5.3.m3.1.1.1.4.2">𝜒</ci><cn id="A1.SS2.p5.3.m3.1.1.1.4.3.cmml" type="integer" xref="A1.SS2.p5.3.m3.1.1.1.4.3">2</cn></apply><apply id="A1.SS2.p5.3.m3.1.1.1.1.1.1.cmml" xref="A1.SS2.p5.3.m3.1.1.1.1.1"><csymbol cd="latexml" id="A1.SS2.p5.3.m3.1.1.1.1.1.1.1.cmml" xref="A1.SS2.p5.3.m3.1.1.1.1.1.1.1">conditional</csymbol><ci id="A1.SS2.p5.3.m3.1.1.1.1.1.1.2.cmml" xref="A1.SS2.p5.3.m3.1.1.1.1.1.1.2">𝑃</ci><apply id="A1.SS2.p5.3.m3.1.1.1.1.1.1.3.cmml" xref="A1.SS2.p5.3.m3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p5.3.m3.1.1.1.1.1.1.3.1.cmml" xref="A1.SS2.p5.3.m3.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.SS2.p5.3.m3.1.1.1.1.1.1.3.2.cmml" xref="A1.SS2.p5.3.m3.1.1.1.1.1.1.3.2">𝑄</ci><ci id="A1.SS2.p5.3.m3.1.1.1.1.1.1.3.3.cmml" xref="A1.SS2.p5.3.m3.1.1.1.1.1.1.3.3">𝑓</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p5.3.m3.1c">\alpha=\frac{4}{R^{2}}\chi^{2}(P\|Q_{f})</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p5.3.m3.1d">italic_α = divide start_ARG 4 end_ARG start_ARG italic_R start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG italic_χ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ( italic_P ∥ italic_Q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT )</annotation></semantics></math> produces an increase in log-likelihood of at least <math alttext="2\left[\nicefrac{{\chi^{2}(P\|Q_{f})}}{{R}}\right]^{2}" class="ltx_Math" display="inline" id="A1.SS2.p5.4.m4.1"><semantics id="A1.SS2.p5.4.m4.1a"><mrow id="A1.SS2.p5.4.m4.1.2" xref="A1.SS2.p5.4.m4.1.2.cmml"><mn id="A1.SS2.p5.4.m4.1.2.2" xref="A1.SS2.p5.4.m4.1.2.2.cmml">2</mn><mo id="A1.SS2.p5.4.m4.1.2.1" xref="A1.SS2.p5.4.m4.1.2.1.cmml">⁢</mo><msup id="A1.SS2.p5.4.m4.1.2.3" xref="A1.SS2.p5.4.m4.1.2.3.cmml"><mrow id="A1.SS2.p5.4.m4.1.2.3.2.2" xref="A1.SS2.p5.4.m4.1.2.3.2.1.cmml"><mo id="A1.SS2.p5.4.m4.1.2.3.2.2.1" xref="A1.SS2.p5.4.m4.1.2.3.2.1.1.cmml">[</mo><mrow id="A1.SS2.p5.4.m4.1.1" xref="A1.SS2.p5.4.m4.1.1.cmml"><mpadded id="A1.SS2.p5.4.m4.1.1.1" voffset="0.3em" xref="A1.SS2.p5.4.m4.1.1.1.cmml"><msup id="A1.SS2.p5.4.m4.1.1.1.3" xref="A1.SS2.p5.4.m4.1.1.1.3.cmml"><mi id="A1.SS2.p5.4.m4.1.1.1.3.2" mathsize="70%" xref="A1.SS2.p5.4.m4.1.1.1.3.2.cmml">χ</mi><mn id="A1.SS2.p5.4.m4.1.1.1.3.3" mathsize="71%" xref="A1.SS2.p5.4.m4.1.1.1.3.3.cmml">2</mn></msup><mo id="A1.SS2.p5.4.m4.1.1.1.2" xref="A1.SS2.p5.4.m4.1.1.1.2.cmml">⁢</mo><mrow id="A1.SS2.p5.4.m4.1.1.1.1.1" xref="A1.SS2.p5.4.m4.1.1.1.1.1.1.cmml"><mo id="A1.SS2.p5.4.m4.1.1.1.1.1.2" maxsize="70%" minsize="70%" xref="A1.SS2.p5.4.m4.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.SS2.p5.4.m4.1.1.1.1.1.1" xref="A1.SS2.p5.4.m4.1.1.1.1.1.1.cmml"><mi id="A1.SS2.p5.4.m4.1.1.1.1.1.1.2" mathsize="70%" xref="A1.SS2.p5.4.m4.1.1.1.1.1.1.2.cmml">P</mi><mo id="A1.SS2.p5.4.m4.1.1.1.1.1.1.1" mathsize="70%" xref="A1.SS2.p5.4.m4.1.1.1.1.1.1.1.cmml">∥</mo><msub id="A1.SS2.p5.4.m4.1.1.1.1.1.1.3" xref="A1.SS2.p5.4.m4.1.1.1.1.1.1.3.cmml"><mi id="A1.SS2.p5.4.m4.1.1.1.1.1.1.3.2" mathsize="70%" xref="A1.SS2.p5.4.m4.1.1.1.1.1.1.3.2.cmml">Q</mi><mi id="A1.SS2.p5.4.m4.1.1.1.1.1.1.3.3" mathsize="71%" xref="A1.SS2.p5.4.m4.1.1.1.1.1.1.3.3.cmml">f</mi></msub></mrow><mo id="A1.SS2.p5.4.m4.1.1.1.1.1.3" maxsize="70%" minsize="70%" xref="A1.SS2.p5.4.m4.1.1.1.1.1.1.cmml">)</mo></mrow></mpadded><mpadded id="A1.SS2.p5.4.m4.1.1.2" lspace="-0.1em" width="-0.15em" xref="A1.SS2.p5.4.m4.1.1.2.cmml"><mo id="A1.SS2.p5.4.m4.1.1.2a" stretchy="true" symmetric="true" xref="A1.SS2.p5.4.m4.1.1.2.cmml">/</mo></mpadded><mi id="A1.SS2.p5.4.m4.1.1.3" mathsize="70%" xref="A1.SS2.p5.4.m4.1.1.3.cmml">R</mi></mrow><mo id="A1.SS2.p5.4.m4.1.2.3.2.2.2" xref="A1.SS2.p5.4.m4.1.2.3.2.1.1.cmml">]</mo></mrow><mn id="A1.SS2.p5.4.m4.1.2.3.3" xref="A1.SS2.p5.4.m4.1.2.3.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p5.4.m4.1b"><apply id="A1.SS2.p5.4.m4.1.2.cmml" xref="A1.SS2.p5.4.m4.1.2"><times id="A1.SS2.p5.4.m4.1.2.1.cmml" xref="A1.SS2.p5.4.m4.1.2.1"></times><cn id="A1.SS2.p5.4.m4.1.2.2.cmml" type="integer" xref="A1.SS2.p5.4.m4.1.2.2">2</cn><apply id="A1.SS2.p5.4.m4.1.2.3.cmml" xref="A1.SS2.p5.4.m4.1.2.3"><csymbol cd="ambiguous" id="A1.SS2.p5.4.m4.1.2.3.1.cmml" xref="A1.SS2.p5.4.m4.1.2.3">superscript</csymbol><apply id="A1.SS2.p5.4.m4.1.2.3.2.1.cmml" xref="A1.SS2.p5.4.m4.1.2.3.2.2"><csymbol cd="latexml" id="A1.SS2.p5.4.m4.1.2.3.2.1.1.cmml" xref="A1.SS2.p5.4.m4.1.2.3.2.2.1">delimited-[]</csymbol><apply id="A1.SS2.p5.4.m4.1.1.cmml" xref="A1.SS2.p5.4.m4.1.1"><divide id="A1.SS2.p5.4.m4.1.1.2.cmml" xref="A1.SS2.p5.4.m4.1.1.2"></divide><apply id="A1.SS2.p5.4.m4.1.1.1.cmml" xref="A1.SS2.p5.4.m4.1.1.1"><times id="A1.SS2.p5.4.m4.1.1.1.2.cmml" xref="A1.SS2.p5.4.m4.1.1.1.2"></times><apply id="A1.SS2.p5.4.m4.1.1.1.3.cmml" xref="A1.SS2.p5.4.m4.1.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p5.4.m4.1.1.1.3.1.cmml" xref="A1.SS2.p5.4.m4.1.1.1.3">superscript</csymbol><ci id="A1.SS2.p5.4.m4.1.1.1.3.2.cmml" xref="A1.SS2.p5.4.m4.1.1.1.3.2">𝜒</ci><cn id="A1.SS2.p5.4.m4.1.1.1.3.3.cmml" type="integer" xref="A1.SS2.p5.4.m4.1.1.1.3.3">2</cn></apply><apply id="A1.SS2.p5.4.m4.1.1.1.1.1.1.cmml" xref="A1.SS2.p5.4.m4.1.1.1.1.1"><csymbol cd="latexml" id="A1.SS2.p5.4.m4.1.1.1.1.1.1.1.cmml" xref="A1.SS2.p5.4.m4.1.1.1.1.1.1.1">conditional</csymbol><ci id="A1.SS2.p5.4.m4.1.1.1.1.1.1.2.cmml" xref="A1.SS2.p5.4.m4.1.1.1.1.1.1.2">𝑃</ci><apply id="A1.SS2.p5.4.m4.1.1.1.1.1.1.3.cmml" xref="A1.SS2.p5.4.m4.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p5.4.m4.1.1.1.1.1.1.3.1.cmml" xref="A1.SS2.p5.4.m4.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.SS2.p5.4.m4.1.1.1.1.1.1.3.2.cmml" xref="A1.SS2.p5.4.m4.1.1.1.1.1.1.3.2">𝑄</ci><ci id="A1.SS2.p5.4.m4.1.1.1.1.1.1.3.3.cmml" xref="A1.SS2.p5.4.m4.1.1.1.1.1.1.3.3">𝑓</ci></apply></apply></apply><ci id="A1.SS2.p5.4.m4.1.1.3.cmml" xref="A1.SS2.p5.4.m4.1.1.3">𝑅</ci></apply></apply><cn id="A1.SS2.p5.4.m4.1.2.3.3.cmml" type="integer" xref="A1.SS2.p5.4.m4.1.2.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p5.4.m4.1c">2\left[\nicefrac{{\chi^{2}(P\|Q_{f})}}{{R}}\right]^{2}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p5.4.m4.1d">2 [ / start_ARG italic_χ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ( italic_P ∥ italic_Q start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT ) end_ARG start_ARG italic_R end_ARG ] start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS2.p6">
<p class="ltx_p" id="A1.SS2.p6.1">We note that this result, while insightful, assumes that one uses the exact probabilities under the model distribution in the NRGBoost update.
In practice, we would only be able to approximately estimate these with MCMC.
Furthermore, it can only guarantee an increase in the training log-likelihood as we also don’t have access to the probabilities under the data generating distribution.
We leave further analysis for future work.</p>
</div>
</section>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Density Estimation Trees</h2>
<div class="ltx_para ltx_noindent" id="A2.p1">
<p class="ltx_p" id="A2.p1.5">Density Estimation Trees (DET) <cite class="ltx_cite ltx_citemacro_citep">(Ram &amp; Gray, <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib24" title="">2011</a>)</cite> model the density function as a piecewise constant function,</p>
<table class="ltx_equation ltx_eqn_table" id="A2.E51">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="q(\mathbf{x})=\sum_{j=1}^{J}v_{j}\mathbf{1}_{X_{j}}(\mathbf{x})\,," class="ltx_Math" display="block" id="A2.E51.m1.3"><semantics id="A2.E51.m1.3a"><mrow id="A2.E51.m1.3.3.1" xref="A2.E51.m1.3.3.1.1.cmml"><mrow id="A2.E51.m1.3.3.1.1" xref="A2.E51.m1.3.3.1.1.cmml"><mrow id="A2.E51.m1.3.3.1.1.2" xref="A2.E51.m1.3.3.1.1.2.cmml"><mi id="A2.E51.m1.3.3.1.1.2.2" xref="A2.E51.m1.3.3.1.1.2.2.cmml">q</mi><mo id="A2.E51.m1.3.3.1.1.2.1" xref="A2.E51.m1.3.3.1.1.2.1.cmml">⁢</mo><mrow id="A2.E51.m1.3.3.1.1.2.3.2" xref="A2.E51.m1.3.3.1.1.2.cmml"><mo id="A2.E51.m1.3.3.1.1.2.3.2.1" stretchy="false" xref="A2.E51.m1.3.3.1.1.2.cmml">(</mo><mi id="A2.E51.m1.1.1" xref="A2.E51.m1.1.1.cmml">𝐱</mi><mo id="A2.E51.m1.3.3.1.1.2.3.2.2" stretchy="false" xref="A2.E51.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow><mo id="A2.E51.m1.3.3.1.1.1" rspace="0.111em" xref="A2.E51.m1.3.3.1.1.1.cmml">=</mo><mrow id="A2.E51.m1.3.3.1.1.3" xref="A2.E51.m1.3.3.1.1.3.cmml"><munderover id="A2.E51.m1.3.3.1.1.3.1" xref="A2.E51.m1.3.3.1.1.3.1.cmml"><mo id="A2.E51.m1.3.3.1.1.3.1.2.2" movablelimits="false" xref="A2.E51.m1.3.3.1.1.3.1.2.2.cmml">∑</mo><mrow id="A2.E51.m1.3.3.1.1.3.1.2.3" xref="A2.E51.m1.3.3.1.1.3.1.2.3.cmml"><mi id="A2.E51.m1.3.3.1.1.3.1.2.3.2" xref="A2.E51.m1.3.3.1.1.3.1.2.3.2.cmml">j</mi><mo id="A2.E51.m1.3.3.1.1.3.1.2.3.1" xref="A2.E51.m1.3.3.1.1.3.1.2.3.1.cmml">=</mo><mn id="A2.E51.m1.3.3.1.1.3.1.2.3.3" xref="A2.E51.m1.3.3.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="A2.E51.m1.3.3.1.1.3.1.3" xref="A2.E51.m1.3.3.1.1.3.1.3.cmml">J</mi></munderover><mrow id="A2.E51.m1.3.3.1.1.3.2" xref="A2.E51.m1.3.3.1.1.3.2.cmml"><msub id="A2.E51.m1.3.3.1.1.3.2.2" xref="A2.E51.m1.3.3.1.1.3.2.2.cmml"><mi id="A2.E51.m1.3.3.1.1.3.2.2.2" xref="A2.E51.m1.3.3.1.1.3.2.2.2.cmml">v</mi><mi id="A2.E51.m1.3.3.1.1.3.2.2.3" xref="A2.E51.m1.3.3.1.1.3.2.2.3.cmml">j</mi></msub><mo id="A2.E51.m1.3.3.1.1.3.2.1" xref="A2.E51.m1.3.3.1.1.3.2.1.cmml">⁢</mo><msub id="A2.E51.m1.3.3.1.1.3.2.3" xref="A2.E51.m1.3.3.1.1.3.2.3.cmml"><mn id="A2.E51.m1.3.3.1.1.3.2.3.2" xref="A2.E51.m1.3.3.1.1.3.2.3.2.cmml">𝟏</mn><msub id="A2.E51.m1.3.3.1.1.3.2.3.3" xref="A2.E51.m1.3.3.1.1.3.2.3.3.cmml"><mi id="A2.E51.m1.3.3.1.1.3.2.3.3.2" xref="A2.E51.m1.3.3.1.1.3.2.3.3.2.cmml">X</mi><mi id="A2.E51.m1.3.3.1.1.3.2.3.3.3" xref="A2.E51.m1.3.3.1.1.3.2.3.3.3.cmml">j</mi></msub></msub><mo id="A2.E51.m1.3.3.1.1.3.2.1a" xref="A2.E51.m1.3.3.1.1.3.2.1.cmml">⁢</mo><mrow id="A2.E51.m1.3.3.1.1.3.2.4.2" xref="A2.E51.m1.3.3.1.1.3.2.cmml"><mo id="A2.E51.m1.3.3.1.1.3.2.4.2.1" stretchy="false" xref="A2.E51.m1.3.3.1.1.3.2.cmml">(</mo><mi id="A2.E51.m1.2.2" xref="A2.E51.m1.2.2.cmml">𝐱</mi><mo id="A2.E51.m1.3.3.1.1.3.2.4.2.2" rspace="0.170em" stretchy="false" xref="A2.E51.m1.3.3.1.1.3.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A2.E51.m1.3.3.1.2" xref="A2.E51.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.E51.m1.3b"><apply id="A2.E51.m1.3.3.1.1.cmml" xref="A2.E51.m1.3.3.1"><eq id="A2.E51.m1.3.3.1.1.1.cmml" xref="A2.E51.m1.3.3.1.1.1"></eq><apply id="A2.E51.m1.3.3.1.1.2.cmml" xref="A2.E51.m1.3.3.1.1.2"><times id="A2.E51.m1.3.3.1.1.2.1.cmml" xref="A2.E51.m1.3.3.1.1.2.1"></times><ci id="A2.E51.m1.3.3.1.1.2.2.cmml" xref="A2.E51.m1.3.3.1.1.2.2">𝑞</ci><ci id="A2.E51.m1.1.1.cmml" xref="A2.E51.m1.1.1">𝐱</ci></apply><apply id="A2.E51.m1.3.3.1.1.3.cmml" xref="A2.E51.m1.3.3.1.1.3"><apply id="A2.E51.m1.3.3.1.1.3.1.cmml" xref="A2.E51.m1.3.3.1.1.3.1"><csymbol cd="ambiguous" id="A2.E51.m1.3.3.1.1.3.1.1.cmml" xref="A2.E51.m1.3.3.1.1.3.1">superscript</csymbol><apply id="A2.E51.m1.3.3.1.1.3.1.2.cmml" xref="A2.E51.m1.3.3.1.1.3.1"><csymbol cd="ambiguous" id="A2.E51.m1.3.3.1.1.3.1.2.1.cmml" xref="A2.E51.m1.3.3.1.1.3.1">subscript</csymbol><sum id="A2.E51.m1.3.3.1.1.3.1.2.2.cmml" xref="A2.E51.m1.3.3.1.1.3.1.2.2"></sum><apply id="A2.E51.m1.3.3.1.1.3.1.2.3.cmml" xref="A2.E51.m1.3.3.1.1.3.1.2.3"><eq id="A2.E51.m1.3.3.1.1.3.1.2.3.1.cmml" xref="A2.E51.m1.3.3.1.1.3.1.2.3.1"></eq><ci id="A2.E51.m1.3.3.1.1.3.1.2.3.2.cmml" xref="A2.E51.m1.3.3.1.1.3.1.2.3.2">𝑗</ci><cn id="A2.E51.m1.3.3.1.1.3.1.2.3.3.cmml" type="integer" xref="A2.E51.m1.3.3.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="A2.E51.m1.3.3.1.1.3.1.3.cmml" xref="A2.E51.m1.3.3.1.1.3.1.3">𝐽</ci></apply><apply id="A2.E51.m1.3.3.1.1.3.2.cmml" xref="A2.E51.m1.3.3.1.1.3.2"><times id="A2.E51.m1.3.3.1.1.3.2.1.cmml" xref="A2.E51.m1.3.3.1.1.3.2.1"></times><apply id="A2.E51.m1.3.3.1.1.3.2.2.cmml" xref="A2.E51.m1.3.3.1.1.3.2.2"><csymbol cd="ambiguous" id="A2.E51.m1.3.3.1.1.3.2.2.1.cmml" xref="A2.E51.m1.3.3.1.1.3.2.2">subscript</csymbol><ci id="A2.E51.m1.3.3.1.1.3.2.2.2.cmml" xref="A2.E51.m1.3.3.1.1.3.2.2.2">𝑣</ci><ci id="A2.E51.m1.3.3.1.1.3.2.2.3.cmml" xref="A2.E51.m1.3.3.1.1.3.2.2.3">𝑗</ci></apply><apply id="A2.E51.m1.3.3.1.1.3.2.3.cmml" xref="A2.E51.m1.3.3.1.1.3.2.3"><csymbol cd="ambiguous" id="A2.E51.m1.3.3.1.1.3.2.3.1.cmml" xref="A2.E51.m1.3.3.1.1.3.2.3">subscript</csymbol><cn id="A2.E51.m1.3.3.1.1.3.2.3.2.cmml" type="integer" xref="A2.E51.m1.3.3.1.1.3.2.3.2">1</cn><apply id="A2.E51.m1.3.3.1.1.3.2.3.3.cmml" xref="A2.E51.m1.3.3.1.1.3.2.3.3"><csymbol cd="ambiguous" id="A2.E51.m1.3.3.1.1.3.2.3.3.1.cmml" xref="A2.E51.m1.3.3.1.1.3.2.3.3">subscript</csymbol><ci id="A2.E51.m1.3.3.1.1.3.2.3.3.2.cmml" xref="A2.E51.m1.3.3.1.1.3.2.3.3.2">𝑋</ci><ci id="A2.E51.m1.3.3.1.1.3.2.3.3.3.cmml" xref="A2.E51.m1.3.3.1.1.3.2.3.3.3">𝑗</ci></apply></apply><ci id="A2.E51.m1.2.2.cmml" xref="A2.E51.m1.2.2">𝐱</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E51.m1.3c">q(\mathbf{x})=\sum_{j=1}^{J}v_{j}\mathbf{1}_{X_{j}}(\mathbf{x})\,,</annotation><annotation encoding="application/x-llamapun" id="A2.E51.m1.3d">italic_q ( bold_x ) = ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_J end_POSTSUPERSCRIPT italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT bold_1 start_POSTSUBSCRIPT italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_x ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(51)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A2.p1.4">where <math alttext="X_{j}" class="ltx_Math" display="inline" id="A2.p1.1.m1.1"><semantics id="A2.p1.1.m1.1a"><msub id="A2.p1.1.m1.1.1" xref="A2.p1.1.m1.1.1.cmml"><mi id="A2.p1.1.m1.1.1.2" xref="A2.p1.1.m1.1.1.2.cmml">X</mi><mi id="A2.p1.1.m1.1.1.3" xref="A2.p1.1.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A2.p1.1.m1.1b"><apply id="A2.p1.1.m1.1.1.cmml" xref="A2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A2.p1.1.m1.1.1.1.cmml" xref="A2.p1.1.m1.1.1">subscript</csymbol><ci id="A2.p1.1.m1.1.1.2.cmml" xref="A2.p1.1.m1.1.1.2">𝑋</ci><ci id="A2.p1.1.m1.1.1.3.cmml" xref="A2.p1.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.1.m1.1c">X_{j}</annotation><annotation encoding="application/x-llamapun" id="A2.p1.1.m1.1d">italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> are given by a partitioning of the input space <math alttext="\mathcal{X}" class="ltx_Math" display="inline" id="A2.p1.2.m2.1"><semantics id="A2.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="A2.p1.2.m2.1.1" xref="A2.p1.2.m2.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="A2.p1.2.m2.1b"><ci id="A2.p1.2.m2.1.1.cmml" xref="A2.p1.2.m2.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.2.m2.1c">\mathcal{X}</annotation><annotation encoding="application/x-llamapun" id="A2.p1.2.m2.1d">caligraphic_X</annotation></semantics></math> induced by a binary tree
and the <math alttext="v_{j}" class="ltx_Math" display="inline" id="A2.p1.3.m3.1"><semantics id="A2.p1.3.m3.1a"><msub id="A2.p1.3.m3.1.1" xref="A2.p1.3.m3.1.1.cmml"><mi id="A2.p1.3.m3.1.1.2" xref="A2.p1.3.m3.1.1.2.cmml">v</mi><mi id="A2.p1.3.m3.1.1.3" xref="A2.p1.3.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A2.p1.3.m3.1b"><apply id="A2.p1.3.m3.1.1.cmml" xref="A2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A2.p1.3.m3.1.1.1.cmml" xref="A2.p1.3.m3.1.1">subscript</csymbol><ci id="A2.p1.3.m3.1.1.2.cmml" xref="A2.p1.3.m3.1.1.2">𝑣</ci><ci id="A2.p1.3.m3.1.1.3.cmml" xref="A2.p1.3.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.3.m3.1c">v_{j}</annotation><annotation encoding="application/x-llamapun" id="A2.p1.3.m3.1d">italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> are the density values associated with each leaf that, for the time being, we will only require to be such that <math alttext="q(\mathbf{x})" class="ltx_Math" display="inline" id="A2.p1.4.m4.1"><semantics id="A2.p1.4.m4.1a"><mrow id="A2.p1.4.m4.1.2" xref="A2.p1.4.m4.1.2.cmml"><mi id="A2.p1.4.m4.1.2.2" xref="A2.p1.4.m4.1.2.2.cmml">q</mi><mo id="A2.p1.4.m4.1.2.1" xref="A2.p1.4.m4.1.2.1.cmml">⁢</mo><mrow id="A2.p1.4.m4.1.2.3.2" xref="A2.p1.4.m4.1.2.cmml"><mo id="A2.p1.4.m4.1.2.3.2.1" stretchy="false" xref="A2.p1.4.m4.1.2.cmml">(</mo><mi id="A2.p1.4.m4.1.1" xref="A2.p1.4.m4.1.1.cmml">𝐱</mi><mo id="A2.p1.4.m4.1.2.3.2.2" stretchy="false" xref="A2.p1.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.p1.4.m4.1b"><apply id="A2.p1.4.m4.1.2.cmml" xref="A2.p1.4.m4.1.2"><times id="A2.p1.4.m4.1.2.1.cmml" xref="A2.p1.4.m4.1.2.1"></times><ci id="A2.p1.4.m4.1.2.2.cmml" xref="A2.p1.4.m4.1.2.2">𝑞</ci><ci id="A2.p1.4.m4.1.1.cmml" xref="A2.p1.4.m4.1.1">𝐱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.4.m4.1c">q(\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="A2.p1.4.m4.1d">italic_q ( bold_x )</annotation></semantics></math> sums to one.</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.p2">
<p class="ltx_p" id="A2.p2.1"><cite class="ltx_cite ltx_citemacro_citet">Ram &amp; Gray (<a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib24" title="">2011</a>)</cite> proposes fitting DET models to directly minimize a generative objective, the Integrated Squared Error (ISE) between the data generating distribution, <math alttext="p(\mathbf{x})" class="ltx_Math" display="inline" id="A2.p2.1.m1.1"><semantics id="A2.p2.1.m1.1a"><mrow id="A2.p2.1.m1.1.2" xref="A2.p2.1.m1.1.2.cmml"><mi id="A2.p2.1.m1.1.2.2" xref="A2.p2.1.m1.1.2.2.cmml">p</mi><mo id="A2.p2.1.m1.1.2.1" xref="A2.p2.1.m1.1.2.1.cmml">⁢</mo><mrow id="A2.p2.1.m1.1.2.3.2" xref="A2.p2.1.m1.1.2.cmml"><mo id="A2.p2.1.m1.1.2.3.2.1" stretchy="false" xref="A2.p2.1.m1.1.2.cmml">(</mo><mi id="A2.p2.1.m1.1.1" xref="A2.p2.1.m1.1.1.cmml">𝐱</mi><mo id="A2.p2.1.m1.1.2.3.2.2" stretchy="false" xref="A2.p2.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.1.m1.1b"><apply id="A2.p2.1.m1.1.2.cmml" xref="A2.p2.1.m1.1.2"><times id="A2.p2.1.m1.1.2.1.cmml" xref="A2.p2.1.m1.1.2.1"></times><ci id="A2.p2.1.m1.1.2.2.cmml" xref="A2.p2.1.m1.1.2.2">𝑝</ci><ci id="A2.p2.1.m1.1.1.cmml" xref="A2.p2.1.m1.1.1">𝐱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.1.m1.1c">p(\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="A2.p2.1.m1.1d">italic_p ( bold_x )</annotation></semantics></math> and the model:</p>
<table class="ltx_equation ltx_eqn_table" id="A2.E52">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\min_{q\in\mathcal{Q}}\sum_{\mathbf{x}\in\mathcal{X}}\left(p(\mathbf{x})-q(%
\mathbf{x})\right)^{2}\,." class="ltx_Math" display="block" id="A2.E52.m1.3"><semantics id="A2.E52.m1.3a"><mrow id="A2.E52.m1.3.3.1" xref="A2.E52.m1.3.3.1.1.cmml"><mrow id="A2.E52.m1.3.3.1.1" xref="A2.E52.m1.3.3.1.1.cmml"><munder id="A2.E52.m1.3.3.1.1.3" xref="A2.E52.m1.3.3.1.1.3.cmml"><mi id="A2.E52.m1.3.3.1.1.3.2" xref="A2.E52.m1.3.3.1.1.3.2.cmml">min</mi><mrow id="A2.E52.m1.3.3.1.1.3.3" xref="A2.E52.m1.3.3.1.1.3.3.cmml"><mi id="A2.E52.m1.3.3.1.1.3.3.2" xref="A2.E52.m1.3.3.1.1.3.3.2.cmml">q</mi><mo id="A2.E52.m1.3.3.1.1.3.3.1" xref="A2.E52.m1.3.3.1.1.3.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="A2.E52.m1.3.3.1.1.3.3.3" xref="A2.E52.m1.3.3.1.1.3.3.3.cmml">𝒬</mi></mrow></munder><mo id="A2.E52.m1.3.3.1.1.2" xref="A2.E52.m1.3.3.1.1.2.cmml">⁢</mo><mrow id="A2.E52.m1.3.3.1.1.1" xref="A2.E52.m1.3.3.1.1.1.cmml"><munder id="A2.E52.m1.3.3.1.1.1.2" xref="A2.E52.m1.3.3.1.1.1.2.cmml"><mo id="A2.E52.m1.3.3.1.1.1.2.2" movablelimits="false" rspace="0em" xref="A2.E52.m1.3.3.1.1.1.2.2.cmml">∑</mo><mrow id="A2.E52.m1.3.3.1.1.1.2.3" xref="A2.E52.m1.3.3.1.1.1.2.3.cmml"><mi id="A2.E52.m1.3.3.1.1.1.2.3.2" xref="A2.E52.m1.3.3.1.1.1.2.3.2.cmml">𝐱</mi><mo id="A2.E52.m1.3.3.1.1.1.2.3.1" xref="A2.E52.m1.3.3.1.1.1.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="A2.E52.m1.3.3.1.1.1.2.3.3" xref="A2.E52.m1.3.3.1.1.1.2.3.3.cmml">𝒳</mi></mrow></munder><msup id="A2.E52.m1.3.3.1.1.1.1" xref="A2.E52.m1.3.3.1.1.1.1.cmml"><mrow id="A2.E52.m1.3.3.1.1.1.1.1.1" xref="A2.E52.m1.3.3.1.1.1.1.1.1.1.cmml"><mo id="A2.E52.m1.3.3.1.1.1.1.1.1.2" xref="A2.E52.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A2.E52.m1.3.3.1.1.1.1.1.1.1" xref="A2.E52.m1.3.3.1.1.1.1.1.1.1.cmml"><mrow id="A2.E52.m1.3.3.1.1.1.1.1.1.1.2" xref="A2.E52.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mi id="A2.E52.m1.3.3.1.1.1.1.1.1.1.2.2" xref="A2.E52.m1.3.3.1.1.1.1.1.1.1.2.2.cmml">p</mi><mo id="A2.E52.m1.3.3.1.1.1.1.1.1.1.2.1" xref="A2.E52.m1.3.3.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="A2.E52.m1.3.3.1.1.1.1.1.1.1.2.3.2" xref="A2.E52.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mo id="A2.E52.m1.3.3.1.1.1.1.1.1.1.2.3.2.1" stretchy="false" xref="A2.E52.m1.3.3.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="A2.E52.m1.1.1" xref="A2.E52.m1.1.1.cmml">𝐱</mi><mo id="A2.E52.m1.3.3.1.1.1.1.1.1.1.2.3.2.2" stretchy="false" xref="A2.E52.m1.3.3.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A2.E52.m1.3.3.1.1.1.1.1.1.1.1" xref="A2.E52.m1.3.3.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="A2.E52.m1.3.3.1.1.1.1.1.1.1.3" xref="A2.E52.m1.3.3.1.1.1.1.1.1.1.3.cmml"><mi id="A2.E52.m1.3.3.1.1.1.1.1.1.1.3.2" xref="A2.E52.m1.3.3.1.1.1.1.1.1.1.3.2.cmml">q</mi><mo id="A2.E52.m1.3.3.1.1.1.1.1.1.1.3.1" xref="A2.E52.m1.3.3.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="A2.E52.m1.3.3.1.1.1.1.1.1.1.3.3.2" xref="A2.E52.m1.3.3.1.1.1.1.1.1.1.3.cmml"><mo id="A2.E52.m1.3.3.1.1.1.1.1.1.1.3.3.2.1" stretchy="false" xref="A2.E52.m1.3.3.1.1.1.1.1.1.1.3.cmml">(</mo><mi id="A2.E52.m1.2.2" xref="A2.E52.m1.2.2.cmml">𝐱</mi><mo id="A2.E52.m1.3.3.1.1.1.1.1.1.1.3.3.2.2" stretchy="false" xref="A2.E52.m1.3.3.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="A2.E52.m1.3.3.1.1.1.1.1.1.3" xref="A2.E52.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="A2.E52.m1.3.3.1.1.1.1.3" xref="A2.E52.m1.3.3.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow><mo id="A2.E52.m1.3.3.1.2" lspace="0em" xref="A2.E52.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.E52.m1.3b"><apply id="A2.E52.m1.3.3.1.1.cmml" xref="A2.E52.m1.3.3.1"><times id="A2.E52.m1.3.3.1.1.2.cmml" xref="A2.E52.m1.3.3.1.1.2"></times><apply id="A2.E52.m1.3.3.1.1.3.cmml" xref="A2.E52.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="A2.E52.m1.3.3.1.1.3.1.cmml" xref="A2.E52.m1.3.3.1.1.3">subscript</csymbol><min id="A2.E52.m1.3.3.1.1.3.2.cmml" xref="A2.E52.m1.3.3.1.1.3.2"></min><apply id="A2.E52.m1.3.3.1.1.3.3.cmml" xref="A2.E52.m1.3.3.1.1.3.3"><in id="A2.E52.m1.3.3.1.1.3.3.1.cmml" xref="A2.E52.m1.3.3.1.1.3.3.1"></in><ci id="A2.E52.m1.3.3.1.1.3.3.2.cmml" xref="A2.E52.m1.3.3.1.1.3.3.2">𝑞</ci><ci id="A2.E52.m1.3.3.1.1.3.3.3.cmml" xref="A2.E52.m1.3.3.1.1.3.3.3">𝒬</ci></apply></apply><apply id="A2.E52.m1.3.3.1.1.1.cmml" xref="A2.E52.m1.3.3.1.1.1"><apply id="A2.E52.m1.3.3.1.1.1.2.cmml" xref="A2.E52.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="A2.E52.m1.3.3.1.1.1.2.1.cmml" xref="A2.E52.m1.3.3.1.1.1.2">subscript</csymbol><sum id="A2.E52.m1.3.3.1.1.1.2.2.cmml" xref="A2.E52.m1.3.3.1.1.1.2.2"></sum><apply id="A2.E52.m1.3.3.1.1.1.2.3.cmml" xref="A2.E52.m1.3.3.1.1.1.2.3"><in id="A2.E52.m1.3.3.1.1.1.2.3.1.cmml" xref="A2.E52.m1.3.3.1.1.1.2.3.1"></in><ci id="A2.E52.m1.3.3.1.1.1.2.3.2.cmml" xref="A2.E52.m1.3.3.1.1.1.2.3.2">𝐱</ci><ci id="A2.E52.m1.3.3.1.1.1.2.3.3.cmml" xref="A2.E52.m1.3.3.1.1.1.2.3.3">𝒳</ci></apply></apply><apply id="A2.E52.m1.3.3.1.1.1.1.cmml" xref="A2.E52.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="A2.E52.m1.3.3.1.1.1.1.2.cmml" xref="A2.E52.m1.3.3.1.1.1.1">superscript</csymbol><apply id="A2.E52.m1.3.3.1.1.1.1.1.1.1.cmml" xref="A2.E52.m1.3.3.1.1.1.1.1.1"><minus id="A2.E52.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="A2.E52.m1.3.3.1.1.1.1.1.1.1.1"></minus><apply id="A2.E52.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="A2.E52.m1.3.3.1.1.1.1.1.1.1.2"><times id="A2.E52.m1.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="A2.E52.m1.3.3.1.1.1.1.1.1.1.2.1"></times><ci id="A2.E52.m1.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="A2.E52.m1.3.3.1.1.1.1.1.1.1.2.2">𝑝</ci><ci id="A2.E52.m1.1.1.cmml" xref="A2.E52.m1.1.1">𝐱</ci></apply><apply id="A2.E52.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="A2.E52.m1.3.3.1.1.1.1.1.1.1.3"><times id="A2.E52.m1.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="A2.E52.m1.3.3.1.1.1.1.1.1.1.3.1"></times><ci id="A2.E52.m1.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="A2.E52.m1.3.3.1.1.1.1.1.1.1.3.2">𝑞</ci><ci id="A2.E52.m1.2.2.cmml" xref="A2.E52.m1.2.2">𝐱</ci></apply></apply><cn id="A2.E52.m1.3.3.1.1.1.1.3.cmml" type="integer" xref="A2.E52.m1.3.3.1.1.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E52.m1.3c">\min_{q\in\mathcal{Q}}\sum_{\mathbf{x}\in\mathcal{X}}\left(p(\mathbf{x})-q(%
\mathbf{x})\right)^{2}\,.</annotation><annotation encoding="application/x-llamapun" id="A2.E52.m1.3d">roman_min start_POSTSUBSCRIPT italic_q ∈ caligraphic_Q end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT bold_x ∈ caligraphic_X end_POSTSUBSCRIPT ( italic_p ( bold_x ) - italic_q ( bold_x ) ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(52)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A2.p2.3">Noting that <math alttext="q" class="ltx_Math" display="inline" id="A2.p2.2.m1.1"><semantics id="A2.p2.2.m1.1a"><mi id="A2.p2.2.m1.1.1" xref="A2.p2.2.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="A2.p2.2.m1.1b"><ci id="A2.p2.2.m1.1.1.cmml" xref="A2.p2.2.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.2.m1.1c">q</annotation><annotation encoding="application/x-llamapun" id="A2.p2.2.m1.1d">italic_q</annotation></semantics></math> is a function as in Equation <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A2.E51" title="In Appendix B Density Estimation Trees ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">51</span></a> and that <math alttext="\bigcup_{j=1}^{J}X_{j}=\mathcal{X}" class="ltx_Math" display="inline" id="A2.p2.3.m2.1"><semantics id="A2.p2.3.m2.1a"><mrow id="A2.p2.3.m2.1.1" xref="A2.p2.3.m2.1.1.cmml"><mrow id="A2.p2.3.m2.1.1.2" xref="A2.p2.3.m2.1.1.2.cmml"><msubsup id="A2.p2.3.m2.1.1.2.1" xref="A2.p2.3.m2.1.1.2.1.cmml"><mo id="A2.p2.3.m2.1.1.2.1.2.2" xref="A2.p2.3.m2.1.1.2.1.2.2.cmml">⋃</mo><mrow id="A2.p2.3.m2.1.1.2.1.2.3" xref="A2.p2.3.m2.1.1.2.1.2.3.cmml"><mi id="A2.p2.3.m2.1.1.2.1.2.3.2" xref="A2.p2.3.m2.1.1.2.1.2.3.2.cmml">j</mi><mo id="A2.p2.3.m2.1.1.2.1.2.3.1" xref="A2.p2.3.m2.1.1.2.1.2.3.1.cmml">=</mo><mn id="A2.p2.3.m2.1.1.2.1.2.3.3" xref="A2.p2.3.m2.1.1.2.1.2.3.3.cmml">1</mn></mrow><mi id="A2.p2.3.m2.1.1.2.1.3" xref="A2.p2.3.m2.1.1.2.1.3.cmml">J</mi></msubsup><msub id="A2.p2.3.m2.1.1.2.2" xref="A2.p2.3.m2.1.1.2.2.cmml"><mi id="A2.p2.3.m2.1.1.2.2.2" xref="A2.p2.3.m2.1.1.2.2.2.cmml">X</mi><mi id="A2.p2.3.m2.1.1.2.2.3" xref="A2.p2.3.m2.1.1.2.2.3.cmml">j</mi></msub></mrow><mo id="A2.p2.3.m2.1.1.1" xref="A2.p2.3.m2.1.1.1.cmml">=</mo><mi class="ltx_font_mathcaligraphic" id="A2.p2.3.m2.1.1.3" xref="A2.p2.3.m2.1.1.3.cmml">𝒳</mi></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.3.m2.1b"><apply id="A2.p2.3.m2.1.1.cmml" xref="A2.p2.3.m2.1.1"><eq id="A2.p2.3.m2.1.1.1.cmml" xref="A2.p2.3.m2.1.1.1"></eq><apply id="A2.p2.3.m2.1.1.2.cmml" xref="A2.p2.3.m2.1.1.2"><apply id="A2.p2.3.m2.1.1.2.1.cmml" xref="A2.p2.3.m2.1.1.2.1"><csymbol cd="ambiguous" id="A2.p2.3.m2.1.1.2.1.1.cmml" xref="A2.p2.3.m2.1.1.2.1">superscript</csymbol><apply id="A2.p2.3.m2.1.1.2.1.2.cmml" xref="A2.p2.3.m2.1.1.2.1"><csymbol cd="ambiguous" id="A2.p2.3.m2.1.1.2.1.2.1.cmml" xref="A2.p2.3.m2.1.1.2.1">subscript</csymbol><union id="A2.p2.3.m2.1.1.2.1.2.2.cmml" xref="A2.p2.3.m2.1.1.2.1.2.2"></union><apply id="A2.p2.3.m2.1.1.2.1.2.3.cmml" xref="A2.p2.3.m2.1.1.2.1.2.3"><eq id="A2.p2.3.m2.1.1.2.1.2.3.1.cmml" xref="A2.p2.3.m2.1.1.2.1.2.3.1"></eq><ci id="A2.p2.3.m2.1.1.2.1.2.3.2.cmml" xref="A2.p2.3.m2.1.1.2.1.2.3.2">𝑗</ci><cn id="A2.p2.3.m2.1.1.2.1.2.3.3.cmml" type="integer" xref="A2.p2.3.m2.1.1.2.1.2.3.3">1</cn></apply></apply><ci id="A2.p2.3.m2.1.1.2.1.3.cmml" xref="A2.p2.3.m2.1.1.2.1.3">𝐽</ci></apply><apply id="A2.p2.3.m2.1.1.2.2.cmml" xref="A2.p2.3.m2.1.1.2.2"><csymbol cd="ambiguous" id="A2.p2.3.m2.1.1.2.2.1.cmml" xref="A2.p2.3.m2.1.1.2.2">subscript</csymbol><ci id="A2.p2.3.m2.1.1.2.2.2.cmml" xref="A2.p2.3.m2.1.1.2.2.2">𝑋</ci><ci id="A2.p2.3.m2.1.1.2.2.3.cmml" xref="A2.p2.3.m2.1.1.2.2.3">𝑗</ci></apply></apply><ci id="A2.p2.3.m2.1.1.3.cmml" xref="A2.p2.3.m2.1.1.3">𝒳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.3.m2.1c">\bigcup_{j=1}^{J}X_{j}=\mathcal{X}</annotation><annotation encoding="application/x-llamapun" id="A2.p2.3.m2.1d">⋃ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_J end_POSTSUPERSCRIPT italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = caligraphic_X</annotation></semantics></math>, we can rewrite this as</p>
<table class="ltx_equationgroup ltx_eqn_table" id="A2.E53">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A2.E53X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\min_{v_{1},\ldots,v_{J},X_{1},\ldots,X_{J}}" class="ltx_Math" display="inline" id="A2.E53X.2.1.1.m1.6"><semantics id="A2.E53X.2.1.1.m1.6a"><munder id="A2.E53X.2.1.1.m1.6.7" xref="A2.E53X.2.1.1.m1.6.7.cmml"><mi id="A2.E53X.2.1.1.m1.6.7.2" xref="A2.E53X.2.1.1.m1.6.7.2.cmml">min</mi><mrow id="A2.E53X.2.1.1.m1.6.6.6.6" xref="A2.E53X.2.1.1.m1.6.6.6.7.cmml"><msub id="A2.E53X.2.1.1.m1.3.3.3.3.1" xref="A2.E53X.2.1.1.m1.3.3.3.3.1.cmml"><mi id="A2.E53X.2.1.1.m1.3.3.3.3.1.2" xref="A2.E53X.2.1.1.m1.3.3.3.3.1.2.cmml">v</mi><mn id="A2.E53X.2.1.1.m1.3.3.3.3.1.3" xref="A2.E53X.2.1.1.m1.3.3.3.3.1.3.cmml">1</mn></msub><mo id="A2.E53X.2.1.1.m1.6.6.6.6.5" xref="A2.E53X.2.1.1.m1.6.6.6.7.cmml">,</mo><mi id="A2.E53X.2.1.1.m1.1.1.1.1" mathvariant="normal" xref="A2.E53X.2.1.1.m1.1.1.1.1.cmml">…</mi><mo id="A2.E53X.2.1.1.m1.6.6.6.6.6" xref="A2.E53X.2.1.1.m1.6.6.6.7.cmml">,</mo><msub id="A2.E53X.2.1.1.m1.4.4.4.4.2" xref="A2.E53X.2.1.1.m1.4.4.4.4.2.cmml"><mi id="A2.E53X.2.1.1.m1.4.4.4.4.2.2" xref="A2.E53X.2.1.1.m1.4.4.4.4.2.2.cmml">v</mi><mi id="A2.E53X.2.1.1.m1.4.4.4.4.2.3" xref="A2.E53X.2.1.1.m1.4.4.4.4.2.3.cmml">J</mi></msub><mo id="A2.E53X.2.1.1.m1.6.6.6.6.7" xref="A2.E53X.2.1.1.m1.6.6.6.7.cmml">,</mo><msub id="A2.E53X.2.1.1.m1.5.5.5.5.3" xref="A2.E53X.2.1.1.m1.5.5.5.5.3.cmml"><mi id="A2.E53X.2.1.1.m1.5.5.5.5.3.2" xref="A2.E53X.2.1.1.m1.5.5.5.5.3.2.cmml">X</mi><mn id="A2.E53X.2.1.1.m1.5.5.5.5.3.3" xref="A2.E53X.2.1.1.m1.5.5.5.5.3.3.cmml">1</mn></msub><mo id="A2.E53X.2.1.1.m1.6.6.6.6.8" xref="A2.E53X.2.1.1.m1.6.6.6.7.cmml">,</mo><mi id="A2.E53X.2.1.1.m1.2.2.2.2" mathvariant="normal" xref="A2.E53X.2.1.1.m1.2.2.2.2.cmml">…</mi><mo id="A2.E53X.2.1.1.m1.6.6.6.6.9" xref="A2.E53X.2.1.1.m1.6.6.6.7.cmml">,</mo><msub id="A2.E53X.2.1.1.m1.6.6.6.6.4" xref="A2.E53X.2.1.1.m1.6.6.6.6.4.cmml"><mi id="A2.E53X.2.1.1.m1.6.6.6.6.4.2" xref="A2.E53X.2.1.1.m1.6.6.6.6.4.2.cmml">X</mi><mi id="A2.E53X.2.1.1.m1.6.6.6.6.4.3" xref="A2.E53X.2.1.1.m1.6.6.6.6.4.3.cmml">J</mi></msub></mrow></munder><annotation-xml encoding="MathML-Content" id="A2.E53X.2.1.1.m1.6b"><apply id="A2.E53X.2.1.1.m1.6.7.cmml" xref="A2.E53X.2.1.1.m1.6.7"><csymbol cd="ambiguous" id="A2.E53X.2.1.1.m1.6.7.1.cmml" xref="A2.E53X.2.1.1.m1.6.7">subscript</csymbol><min id="A2.E53X.2.1.1.m1.6.7.2.cmml" xref="A2.E53X.2.1.1.m1.6.7.2"></min><list id="A2.E53X.2.1.1.m1.6.6.6.7.cmml" xref="A2.E53X.2.1.1.m1.6.6.6.6"><apply id="A2.E53X.2.1.1.m1.3.3.3.3.1.cmml" xref="A2.E53X.2.1.1.m1.3.3.3.3.1"><csymbol cd="ambiguous" id="A2.E53X.2.1.1.m1.3.3.3.3.1.1.cmml" xref="A2.E53X.2.1.1.m1.3.3.3.3.1">subscript</csymbol><ci id="A2.E53X.2.1.1.m1.3.3.3.3.1.2.cmml" xref="A2.E53X.2.1.1.m1.3.3.3.3.1.2">𝑣</ci><cn id="A2.E53X.2.1.1.m1.3.3.3.3.1.3.cmml" type="integer" xref="A2.E53X.2.1.1.m1.3.3.3.3.1.3">1</cn></apply><ci id="A2.E53X.2.1.1.m1.1.1.1.1.cmml" xref="A2.E53X.2.1.1.m1.1.1.1.1">…</ci><apply id="A2.E53X.2.1.1.m1.4.4.4.4.2.cmml" xref="A2.E53X.2.1.1.m1.4.4.4.4.2"><csymbol cd="ambiguous" id="A2.E53X.2.1.1.m1.4.4.4.4.2.1.cmml" xref="A2.E53X.2.1.1.m1.4.4.4.4.2">subscript</csymbol><ci id="A2.E53X.2.1.1.m1.4.4.4.4.2.2.cmml" xref="A2.E53X.2.1.1.m1.4.4.4.4.2.2">𝑣</ci><ci id="A2.E53X.2.1.1.m1.4.4.4.4.2.3.cmml" xref="A2.E53X.2.1.1.m1.4.4.4.4.2.3">𝐽</ci></apply><apply id="A2.E53X.2.1.1.m1.5.5.5.5.3.cmml" xref="A2.E53X.2.1.1.m1.5.5.5.5.3"><csymbol cd="ambiguous" id="A2.E53X.2.1.1.m1.5.5.5.5.3.1.cmml" xref="A2.E53X.2.1.1.m1.5.5.5.5.3">subscript</csymbol><ci id="A2.E53X.2.1.1.m1.5.5.5.5.3.2.cmml" xref="A2.E53X.2.1.1.m1.5.5.5.5.3.2">𝑋</ci><cn id="A2.E53X.2.1.1.m1.5.5.5.5.3.3.cmml" type="integer" xref="A2.E53X.2.1.1.m1.5.5.5.5.3.3">1</cn></apply><ci id="A2.E53X.2.1.1.m1.2.2.2.2.cmml" xref="A2.E53X.2.1.1.m1.2.2.2.2">…</ci><apply id="A2.E53X.2.1.1.m1.6.6.6.6.4.cmml" xref="A2.E53X.2.1.1.m1.6.6.6.6.4"><csymbol cd="ambiguous" id="A2.E53X.2.1.1.m1.6.6.6.6.4.1.cmml" xref="A2.E53X.2.1.1.m1.6.6.6.6.4">subscript</csymbol><ci id="A2.E53X.2.1.1.m1.6.6.6.6.4.2.cmml" xref="A2.E53X.2.1.1.m1.6.6.6.6.4.2">𝑋</ci><ci id="A2.E53X.2.1.1.m1.6.6.6.6.4.3.cmml" xref="A2.E53X.2.1.1.m1.6.6.6.6.4.3">𝐽</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E53X.2.1.1.m1.6c">\displaystyle\min_{v_{1},\ldots,v_{J},X_{1},\ldots,X_{J}}</annotation><annotation encoding="application/x-llamapun" id="A2.E53X.2.1.1.m1.6d">roman_min start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_v start_POSTSUBSCRIPT italic_J end_POSTSUBSCRIPT , italic_X start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_X start_POSTSUBSCRIPT italic_J end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\sum_{\mathbf{x}\in\mathcal{X}}p^{2}(\mathbf{x})+\sum_{j=1}^{J}%
\sum_{\mathbf{x}\in X_{j}}\left(v_{j}^{2}-2v_{j}p(\mathbf{x})\right)" class="ltx_Math" display="inline" id="A2.E53X.3.2.2.m1.3"><semantics id="A2.E53X.3.2.2.m1.3a"><mrow id="A2.E53X.3.2.2.m1.3.3" xref="A2.E53X.3.2.2.m1.3.3.cmml"><mrow id="A2.E53X.3.2.2.m1.3.3.3" xref="A2.E53X.3.2.2.m1.3.3.3.cmml"><mstyle displaystyle="true" id="A2.E53X.3.2.2.m1.3.3.3.1" xref="A2.E53X.3.2.2.m1.3.3.3.1.cmml"><munder id="A2.E53X.3.2.2.m1.3.3.3.1a" xref="A2.E53X.3.2.2.m1.3.3.3.1.cmml"><mo id="A2.E53X.3.2.2.m1.3.3.3.1.2" movablelimits="false" xref="A2.E53X.3.2.2.m1.3.3.3.1.2.cmml">∑</mo><mrow id="A2.E53X.3.2.2.m1.3.3.3.1.3" xref="A2.E53X.3.2.2.m1.3.3.3.1.3.cmml"><mi id="A2.E53X.3.2.2.m1.3.3.3.1.3.2" xref="A2.E53X.3.2.2.m1.3.3.3.1.3.2.cmml">𝐱</mi><mo id="A2.E53X.3.2.2.m1.3.3.3.1.3.1" xref="A2.E53X.3.2.2.m1.3.3.3.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="A2.E53X.3.2.2.m1.3.3.3.1.3.3" xref="A2.E53X.3.2.2.m1.3.3.3.1.3.3.cmml">𝒳</mi></mrow></munder></mstyle><mrow id="A2.E53X.3.2.2.m1.3.3.3.2" xref="A2.E53X.3.2.2.m1.3.3.3.2.cmml"><msup id="A2.E53X.3.2.2.m1.3.3.3.2.2" xref="A2.E53X.3.2.2.m1.3.3.3.2.2.cmml"><mi id="A2.E53X.3.2.2.m1.3.3.3.2.2.2" xref="A2.E53X.3.2.2.m1.3.3.3.2.2.2.cmml">p</mi><mn id="A2.E53X.3.2.2.m1.3.3.3.2.2.3" xref="A2.E53X.3.2.2.m1.3.3.3.2.2.3.cmml">2</mn></msup><mo id="A2.E53X.3.2.2.m1.3.3.3.2.1" xref="A2.E53X.3.2.2.m1.3.3.3.2.1.cmml">⁢</mo><mrow id="A2.E53X.3.2.2.m1.3.3.3.2.3.2" xref="A2.E53X.3.2.2.m1.3.3.3.2.cmml"><mo id="A2.E53X.3.2.2.m1.3.3.3.2.3.2.1" stretchy="false" xref="A2.E53X.3.2.2.m1.3.3.3.2.cmml">(</mo><mi id="A2.E53X.3.2.2.m1.1.1" xref="A2.E53X.3.2.2.m1.1.1.cmml">𝐱</mi><mo id="A2.E53X.3.2.2.m1.3.3.3.2.3.2.2" stretchy="false" xref="A2.E53X.3.2.2.m1.3.3.3.2.cmml">)</mo></mrow></mrow></mrow><mo id="A2.E53X.3.2.2.m1.3.3.2" xref="A2.E53X.3.2.2.m1.3.3.2.cmml">+</mo><mrow id="A2.E53X.3.2.2.m1.3.3.1" xref="A2.E53X.3.2.2.m1.3.3.1.cmml"><mstyle displaystyle="true" id="A2.E53X.3.2.2.m1.3.3.1.2" xref="A2.E53X.3.2.2.m1.3.3.1.2.cmml"><munderover id="A2.E53X.3.2.2.m1.3.3.1.2a" xref="A2.E53X.3.2.2.m1.3.3.1.2.cmml"><mo id="A2.E53X.3.2.2.m1.3.3.1.2.2.2" movablelimits="false" xref="A2.E53X.3.2.2.m1.3.3.1.2.2.2.cmml">∑</mo><mrow id="A2.E53X.3.2.2.m1.3.3.1.2.2.3" xref="A2.E53X.3.2.2.m1.3.3.1.2.2.3.cmml"><mi id="A2.E53X.3.2.2.m1.3.3.1.2.2.3.2" xref="A2.E53X.3.2.2.m1.3.3.1.2.2.3.2.cmml">j</mi><mo id="A2.E53X.3.2.2.m1.3.3.1.2.2.3.1" xref="A2.E53X.3.2.2.m1.3.3.1.2.2.3.1.cmml">=</mo><mn id="A2.E53X.3.2.2.m1.3.3.1.2.2.3.3" xref="A2.E53X.3.2.2.m1.3.3.1.2.2.3.3.cmml">1</mn></mrow><mi id="A2.E53X.3.2.2.m1.3.3.1.2.3" xref="A2.E53X.3.2.2.m1.3.3.1.2.3.cmml">J</mi></munderover></mstyle><mrow id="A2.E53X.3.2.2.m1.3.3.1.1" xref="A2.E53X.3.2.2.m1.3.3.1.1.cmml"><mstyle displaystyle="true" id="A2.E53X.3.2.2.m1.3.3.1.1.2" xref="A2.E53X.3.2.2.m1.3.3.1.1.2.cmml"><munder id="A2.E53X.3.2.2.m1.3.3.1.1.2a" xref="A2.E53X.3.2.2.m1.3.3.1.1.2.cmml"><mo id="A2.E53X.3.2.2.m1.3.3.1.1.2.2" movablelimits="false" xref="A2.E53X.3.2.2.m1.3.3.1.1.2.2.cmml">∑</mo><mrow id="A2.E53X.3.2.2.m1.3.3.1.1.2.3" xref="A2.E53X.3.2.2.m1.3.3.1.1.2.3.cmml"><mi id="A2.E53X.3.2.2.m1.3.3.1.1.2.3.2" xref="A2.E53X.3.2.2.m1.3.3.1.1.2.3.2.cmml">𝐱</mi><mo id="A2.E53X.3.2.2.m1.3.3.1.1.2.3.1" xref="A2.E53X.3.2.2.m1.3.3.1.1.2.3.1.cmml">∈</mo><msub id="A2.E53X.3.2.2.m1.3.3.1.1.2.3.3" xref="A2.E53X.3.2.2.m1.3.3.1.1.2.3.3.cmml"><mi id="A2.E53X.3.2.2.m1.3.3.1.1.2.3.3.2" xref="A2.E53X.3.2.2.m1.3.3.1.1.2.3.3.2.cmml">X</mi><mi id="A2.E53X.3.2.2.m1.3.3.1.1.2.3.3.3" xref="A2.E53X.3.2.2.m1.3.3.1.1.2.3.3.3.cmml">j</mi></msub></mrow></munder></mstyle><mrow id="A2.E53X.3.2.2.m1.3.3.1.1.1.1" xref="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.cmml"><mo id="A2.E53X.3.2.2.m1.3.3.1.1.1.1.2" xref="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.cmml">(</mo><mrow id="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1" xref="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.cmml"><msubsup id="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.2" xref="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.2.cmml"><mi id="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.2.2.2" xref="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.2.2.2.cmml">v</mi><mi id="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.2.2.3" xref="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.2.2.3.cmml">j</mi><mn id="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.2.3" xref="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.2.3.cmml">2</mn></msubsup><mo id="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.1" xref="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.1.cmml">−</mo><mrow id="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.3" xref="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.3.cmml"><mn id="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.3.2" xref="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.3.2.cmml">2</mn><mo id="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.3.1" xref="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.3.3" xref="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.3.3.cmml"><mi id="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.3.3.2" xref="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.3.3.2.cmml">v</mi><mi id="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.3.3.3" xref="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.3.3.3.cmml">j</mi></msub><mo id="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.3.1a" xref="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.3.4" xref="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.3.4.cmml">p</mi><mo id="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.3.1b" xref="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.3.5.2" xref="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.3.cmml"><mo id="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.3.5.2.1" stretchy="false" xref="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.3.cmml">(</mo><mi id="A2.E53X.3.2.2.m1.2.2" xref="A2.E53X.3.2.2.m1.2.2.cmml">𝐱</mi><mo id="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.3.5.2.2" stretchy="false" xref="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="A2.E53X.3.2.2.m1.3.3.1.1.1.1.3" xref="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E53X.3.2.2.m1.3b"><apply id="A2.E53X.3.2.2.m1.3.3.cmml" xref="A2.E53X.3.2.2.m1.3.3"><plus id="A2.E53X.3.2.2.m1.3.3.2.cmml" xref="A2.E53X.3.2.2.m1.3.3.2"></plus><apply id="A2.E53X.3.2.2.m1.3.3.3.cmml" xref="A2.E53X.3.2.2.m1.3.3.3"><apply id="A2.E53X.3.2.2.m1.3.3.3.1.cmml" xref="A2.E53X.3.2.2.m1.3.3.3.1"><csymbol cd="ambiguous" id="A2.E53X.3.2.2.m1.3.3.3.1.1.cmml" xref="A2.E53X.3.2.2.m1.3.3.3.1">subscript</csymbol><sum id="A2.E53X.3.2.2.m1.3.3.3.1.2.cmml" xref="A2.E53X.3.2.2.m1.3.3.3.1.2"></sum><apply id="A2.E53X.3.2.2.m1.3.3.3.1.3.cmml" xref="A2.E53X.3.2.2.m1.3.3.3.1.3"><in id="A2.E53X.3.2.2.m1.3.3.3.1.3.1.cmml" xref="A2.E53X.3.2.2.m1.3.3.3.1.3.1"></in><ci id="A2.E53X.3.2.2.m1.3.3.3.1.3.2.cmml" xref="A2.E53X.3.2.2.m1.3.3.3.1.3.2">𝐱</ci><ci id="A2.E53X.3.2.2.m1.3.3.3.1.3.3.cmml" xref="A2.E53X.3.2.2.m1.3.3.3.1.3.3">𝒳</ci></apply></apply><apply id="A2.E53X.3.2.2.m1.3.3.3.2.cmml" xref="A2.E53X.3.2.2.m1.3.3.3.2"><times id="A2.E53X.3.2.2.m1.3.3.3.2.1.cmml" xref="A2.E53X.3.2.2.m1.3.3.3.2.1"></times><apply id="A2.E53X.3.2.2.m1.3.3.3.2.2.cmml" xref="A2.E53X.3.2.2.m1.3.3.3.2.2"><csymbol cd="ambiguous" id="A2.E53X.3.2.2.m1.3.3.3.2.2.1.cmml" xref="A2.E53X.3.2.2.m1.3.3.3.2.2">superscript</csymbol><ci id="A2.E53X.3.2.2.m1.3.3.3.2.2.2.cmml" xref="A2.E53X.3.2.2.m1.3.3.3.2.2.2">𝑝</ci><cn id="A2.E53X.3.2.2.m1.3.3.3.2.2.3.cmml" type="integer" xref="A2.E53X.3.2.2.m1.3.3.3.2.2.3">2</cn></apply><ci id="A2.E53X.3.2.2.m1.1.1.cmml" xref="A2.E53X.3.2.2.m1.1.1">𝐱</ci></apply></apply><apply id="A2.E53X.3.2.2.m1.3.3.1.cmml" xref="A2.E53X.3.2.2.m1.3.3.1"><apply id="A2.E53X.3.2.2.m1.3.3.1.2.cmml" xref="A2.E53X.3.2.2.m1.3.3.1.2"><csymbol cd="ambiguous" id="A2.E53X.3.2.2.m1.3.3.1.2.1.cmml" xref="A2.E53X.3.2.2.m1.3.3.1.2">superscript</csymbol><apply id="A2.E53X.3.2.2.m1.3.3.1.2.2.cmml" xref="A2.E53X.3.2.2.m1.3.3.1.2"><csymbol cd="ambiguous" id="A2.E53X.3.2.2.m1.3.3.1.2.2.1.cmml" xref="A2.E53X.3.2.2.m1.3.3.1.2">subscript</csymbol><sum id="A2.E53X.3.2.2.m1.3.3.1.2.2.2.cmml" xref="A2.E53X.3.2.2.m1.3.3.1.2.2.2"></sum><apply id="A2.E53X.3.2.2.m1.3.3.1.2.2.3.cmml" xref="A2.E53X.3.2.2.m1.3.3.1.2.2.3"><eq id="A2.E53X.3.2.2.m1.3.3.1.2.2.3.1.cmml" xref="A2.E53X.3.2.2.m1.3.3.1.2.2.3.1"></eq><ci id="A2.E53X.3.2.2.m1.3.3.1.2.2.3.2.cmml" xref="A2.E53X.3.2.2.m1.3.3.1.2.2.3.2">𝑗</ci><cn id="A2.E53X.3.2.2.m1.3.3.1.2.2.3.3.cmml" type="integer" xref="A2.E53X.3.2.2.m1.3.3.1.2.2.3.3">1</cn></apply></apply><ci id="A2.E53X.3.2.2.m1.3.3.1.2.3.cmml" xref="A2.E53X.3.2.2.m1.3.3.1.2.3">𝐽</ci></apply><apply id="A2.E53X.3.2.2.m1.3.3.1.1.cmml" xref="A2.E53X.3.2.2.m1.3.3.1.1"><apply id="A2.E53X.3.2.2.m1.3.3.1.1.2.cmml" xref="A2.E53X.3.2.2.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="A2.E53X.3.2.2.m1.3.3.1.1.2.1.cmml" xref="A2.E53X.3.2.2.m1.3.3.1.1.2">subscript</csymbol><sum id="A2.E53X.3.2.2.m1.3.3.1.1.2.2.cmml" xref="A2.E53X.3.2.2.m1.3.3.1.1.2.2"></sum><apply id="A2.E53X.3.2.2.m1.3.3.1.1.2.3.cmml" xref="A2.E53X.3.2.2.m1.3.3.1.1.2.3"><in id="A2.E53X.3.2.2.m1.3.3.1.1.2.3.1.cmml" xref="A2.E53X.3.2.2.m1.3.3.1.1.2.3.1"></in><ci id="A2.E53X.3.2.2.m1.3.3.1.1.2.3.2.cmml" xref="A2.E53X.3.2.2.m1.3.3.1.1.2.3.2">𝐱</ci><apply id="A2.E53X.3.2.2.m1.3.3.1.1.2.3.3.cmml" xref="A2.E53X.3.2.2.m1.3.3.1.1.2.3.3"><csymbol cd="ambiguous" id="A2.E53X.3.2.2.m1.3.3.1.1.2.3.3.1.cmml" xref="A2.E53X.3.2.2.m1.3.3.1.1.2.3.3">subscript</csymbol><ci id="A2.E53X.3.2.2.m1.3.3.1.1.2.3.3.2.cmml" xref="A2.E53X.3.2.2.m1.3.3.1.1.2.3.3.2">𝑋</ci><ci id="A2.E53X.3.2.2.m1.3.3.1.1.2.3.3.3.cmml" xref="A2.E53X.3.2.2.m1.3.3.1.1.2.3.3.3">𝑗</ci></apply></apply></apply><apply id="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.cmml" xref="A2.E53X.3.2.2.m1.3.3.1.1.1.1"><minus id="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.1.cmml" xref="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.1"></minus><apply id="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.2.cmml" xref="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.2.1.cmml" xref="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.2">superscript</csymbol><apply id="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.2.2.cmml" xref="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.2.2.1.cmml" xref="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.2">subscript</csymbol><ci id="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.2.2.2.cmml" xref="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.2.2.2">𝑣</ci><ci id="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.2.2.3.cmml" xref="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.2.2.3">𝑗</ci></apply><cn id="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.2.3.cmml" type="integer" xref="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.2.3">2</cn></apply><apply id="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.3.cmml" xref="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.3"><times id="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.3.1.cmml" xref="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.3.1"></times><cn id="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.3.2.cmml" type="integer" xref="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.3.2">2</cn><apply id="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.3.3.cmml" xref="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.3.3.1.cmml" xref="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.3.3">subscript</csymbol><ci id="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.3.3.2.cmml" xref="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.3.3.2">𝑣</ci><ci id="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.3.3.3.cmml" xref="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.3.3.3">𝑗</ci></apply><ci id="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.3.4.cmml" xref="A2.E53X.3.2.2.m1.3.3.1.1.1.1.1.3.4">𝑝</ci><ci id="A2.E53X.3.2.2.m1.2.2.cmml" xref="A2.E53X.3.2.2.m1.2.2">𝐱</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E53X.3.2.2.m1.3c">\displaystyle\sum_{\mathbf{x}\in\mathcal{X}}p^{2}(\mathbf{x})+\sum_{j=1}^{J}%
\sum_{\mathbf{x}\in X_{j}}\left(v_{j}^{2}-2v_{j}p(\mathbf{x})\right)</annotation><annotation encoding="application/x-llamapun" id="A2.E53X.3.2.2.m1.3d">∑ start_POSTSUBSCRIPT bold_x ∈ caligraphic_X end_POSTSUBSCRIPT italic_p start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ( bold_x ) + ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_J end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT bold_x ∈ italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT - 2 italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_p ( bold_x ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(53)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A2.E53Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span class="ltx_text ltx_markedasmath ltx_font_italic" id="A2.E53Xa.2.1.1.1">s.t.</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\sum_{j=1}^{J}\sum_{\mathbf{x}\in X_{j}}v_{j}=1\,." class="ltx_Math" display="inline" id="A2.E53Xa.3.2.2.m1.1"><semantics id="A2.E53Xa.3.2.2.m1.1a"><mrow id="A2.E53Xa.3.2.2.m1.1.1.1" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.cmml"><mrow id="A2.E53Xa.3.2.2.m1.1.1.1.1" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.cmml"><mrow id="A2.E53Xa.3.2.2.m1.1.1.1.1.2" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.2.cmml"><mstyle displaystyle="true" id="A2.E53Xa.3.2.2.m1.1.1.1.1.2.1" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.2.1.cmml"><munderover id="A2.E53Xa.3.2.2.m1.1.1.1.1.2.1a" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.2.1.cmml"><mo id="A2.E53Xa.3.2.2.m1.1.1.1.1.2.1.2.2" movablelimits="false" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.2.1.2.2.cmml">∑</mo><mrow id="A2.E53Xa.3.2.2.m1.1.1.1.1.2.1.2.3" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.2.1.2.3.cmml"><mi id="A2.E53Xa.3.2.2.m1.1.1.1.1.2.1.2.3.2" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.2.1.2.3.2.cmml">j</mi><mo id="A2.E53Xa.3.2.2.m1.1.1.1.1.2.1.2.3.1" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.2.1.2.3.1.cmml">=</mo><mn id="A2.E53Xa.3.2.2.m1.1.1.1.1.2.1.2.3.3" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.2.1.2.3.3.cmml">1</mn></mrow><mi id="A2.E53Xa.3.2.2.m1.1.1.1.1.2.1.3" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.2.1.3.cmml">J</mi></munderover></mstyle><mrow id="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.cmml"><mstyle displaystyle="true" id="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.1" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.1.cmml"><munder id="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.1a" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.1.cmml"><mo id="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.1.2" movablelimits="false" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.1.2.cmml">∑</mo><mrow id="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.1.3" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.1.3.cmml"><mi id="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.1.3.2" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.1.3.2.cmml">𝐱</mi><mo id="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.1.3.1" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.1.3.1.cmml">∈</mo><msub id="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.1.3.3" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.1.3.3.cmml"><mi id="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.1.3.3.2" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.1.3.3.2.cmml">X</mi><mi id="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.1.3.3.3" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.1.3.3.3.cmml">j</mi></msub></mrow></munder></mstyle><msub id="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.2" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.2.cmml"><mi id="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.2.2" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.2.2.cmml">v</mi><mi id="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.2.3" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.2.3.cmml">j</mi></msub></mrow></mrow><mo id="A2.E53Xa.3.2.2.m1.1.1.1.1.1" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.1.cmml">=</mo><mn id="A2.E53Xa.3.2.2.m1.1.1.1.1.3" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.3.cmml">1</mn></mrow><mo id="A2.E53Xa.3.2.2.m1.1.1.1.2" lspace="0.170em" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.E53Xa.3.2.2.m1.1b"><apply id="A2.E53Xa.3.2.2.m1.1.1.1.1.cmml" xref="A2.E53Xa.3.2.2.m1.1.1.1"><eq id="A2.E53Xa.3.2.2.m1.1.1.1.1.1.cmml" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.1"></eq><apply id="A2.E53Xa.3.2.2.m1.1.1.1.1.2.cmml" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.2"><apply id="A2.E53Xa.3.2.2.m1.1.1.1.1.2.1.cmml" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="A2.E53Xa.3.2.2.m1.1.1.1.1.2.1.1.cmml" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.2.1">superscript</csymbol><apply id="A2.E53Xa.3.2.2.m1.1.1.1.1.2.1.2.cmml" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="A2.E53Xa.3.2.2.m1.1.1.1.1.2.1.2.1.cmml" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.2.1">subscript</csymbol><sum id="A2.E53Xa.3.2.2.m1.1.1.1.1.2.1.2.2.cmml" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.2.1.2.2"></sum><apply id="A2.E53Xa.3.2.2.m1.1.1.1.1.2.1.2.3.cmml" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.2.1.2.3"><eq id="A2.E53Xa.3.2.2.m1.1.1.1.1.2.1.2.3.1.cmml" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.2.1.2.3.1"></eq><ci id="A2.E53Xa.3.2.2.m1.1.1.1.1.2.1.2.3.2.cmml" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.2.1.2.3.2">𝑗</ci><cn id="A2.E53Xa.3.2.2.m1.1.1.1.1.2.1.2.3.3.cmml" type="integer" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.2.1.2.3.3">1</cn></apply></apply><ci id="A2.E53Xa.3.2.2.m1.1.1.1.1.2.1.3.cmml" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.2.1.3">𝐽</ci></apply><apply id="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.cmml" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2"><apply id="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.1.cmml" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.1"><csymbol cd="ambiguous" id="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.1.1.cmml" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.1">subscript</csymbol><sum id="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.1.2.cmml" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.1.2"></sum><apply id="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.1.3.cmml" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.1.3"><in id="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.1.3.1.cmml" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.1.3.1"></in><ci id="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.1.3.2.cmml" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.1.3.2">𝐱</ci><apply id="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.1.3.3.cmml" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.1.3.3"><csymbol cd="ambiguous" id="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.1.3.3.1.cmml" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.1.3.3">subscript</csymbol><ci id="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.1.3.3.2.cmml" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.1.3.3.2">𝑋</ci><ci id="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.1.3.3.3.cmml" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.1.3.3.3">𝑗</ci></apply></apply></apply><apply id="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.2.cmml" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.2.1.cmml" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.2">subscript</csymbol><ci id="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.2.2.cmml" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.2.2">𝑣</ci><ci id="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.2.3.cmml" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.2.2.2.3">𝑗</ci></apply></apply></apply><cn id="A2.E53Xa.3.2.2.m1.1.1.1.1.3.cmml" type="integer" xref="A2.E53Xa.3.2.2.m1.1.1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E53Xa.3.2.2.m1.1c">\displaystyle\sum_{j=1}^{J}\sum_{\mathbf{x}\in X_{j}}v_{j}=1\,.</annotation><annotation encoding="application/x-llamapun" id="A2.E53Xa.3.2.2.m1.1d">∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_J end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT bold_x ∈ italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = 1 .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="A2.p2.10">Since the first term in the objective does not depend on the model this optimization problem can be further simplified as</p>
<table class="ltx_equationgroup ltx_eqn_table" id="A2.E54">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A2.E54X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\min_{v_{1},\ldots,v_{J},X_{1},\ldots,X_{J}}" class="ltx_Math" display="inline" id="A2.E54X.2.1.1.m1.6"><semantics id="A2.E54X.2.1.1.m1.6a"><munder id="A2.E54X.2.1.1.m1.6.7" xref="A2.E54X.2.1.1.m1.6.7.cmml"><mi id="A2.E54X.2.1.1.m1.6.7.2" xref="A2.E54X.2.1.1.m1.6.7.2.cmml">min</mi><mrow id="A2.E54X.2.1.1.m1.6.6.6.6" xref="A2.E54X.2.1.1.m1.6.6.6.7.cmml"><msub id="A2.E54X.2.1.1.m1.3.3.3.3.1" xref="A2.E54X.2.1.1.m1.3.3.3.3.1.cmml"><mi id="A2.E54X.2.1.1.m1.3.3.3.3.1.2" xref="A2.E54X.2.1.1.m1.3.3.3.3.1.2.cmml">v</mi><mn id="A2.E54X.2.1.1.m1.3.3.3.3.1.3" xref="A2.E54X.2.1.1.m1.3.3.3.3.1.3.cmml">1</mn></msub><mo id="A2.E54X.2.1.1.m1.6.6.6.6.5" xref="A2.E54X.2.1.1.m1.6.6.6.7.cmml">,</mo><mi id="A2.E54X.2.1.1.m1.1.1.1.1" mathvariant="normal" xref="A2.E54X.2.1.1.m1.1.1.1.1.cmml">…</mi><mo id="A2.E54X.2.1.1.m1.6.6.6.6.6" xref="A2.E54X.2.1.1.m1.6.6.6.7.cmml">,</mo><msub id="A2.E54X.2.1.1.m1.4.4.4.4.2" xref="A2.E54X.2.1.1.m1.4.4.4.4.2.cmml"><mi id="A2.E54X.2.1.1.m1.4.4.4.4.2.2" xref="A2.E54X.2.1.1.m1.4.4.4.4.2.2.cmml">v</mi><mi id="A2.E54X.2.1.1.m1.4.4.4.4.2.3" xref="A2.E54X.2.1.1.m1.4.4.4.4.2.3.cmml">J</mi></msub><mo id="A2.E54X.2.1.1.m1.6.6.6.6.7" xref="A2.E54X.2.1.1.m1.6.6.6.7.cmml">,</mo><msub id="A2.E54X.2.1.1.m1.5.5.5.5.3" xref="A2.E54X.2.1.1.m1.5.5.5.5.3.cmml"><mi id="A2.E54X.2.1.1.m1.5.5.5.5.3.2" xref="A2.E54X.2.1.1.m1.5.5.5.5.3.2.cmml">X</mi><mn id="A2.E54X.2.1.1.m1.5.5.5.5.3.3" xref="A2.E54X.2.1.1.m1.5.5.5.5.3.3.cmml">1</mn></msub><mo id="A2.E54X.2.1.1.m1.6.6.6.6.8" xref="A2.E54X.2.1.1.m1.6.6.6.7.cmml">,</mo><mi id="A2.E54X.2.1.1.m1.2.2.2.2" mathvariant="normal" xref="A2.E54X.2.1.1.m1.2.2.2.2.cmml">…</mi><mo id="A2.E54X.2.1.1.m1.6.6.6.6.9" xref="A2.E54X.2.1.1.m1.6.6.6.7.cmml">,</mo><msub id="A2.E54X.2.1.1.m1.6.6.6.6.4" xref="A2.E54X.2.1.1.m1.6.6.6.6.4.cmml"><mi id="A2.E54X.2.1.1.m1.6.6.6.6.4.2" xref="A2.E54X.2.1.1.m1.6.6.6.6.4.2.cmml">X</mi><mi id="A2.E54X.2.1.1.m1.6.6.6.6.4.3" xref="A2.E54X.2.1.1.m1.6.6.6.6.4.3.cmml">J</mi></msub></mrow></munder><annotation-xml encoding="MathML-Content" id="A2.E54X.2.1.1.m1.6b"><apply id="A2.E54X.2.1.1.m1.6.7.cmml" xref="A2.E54X.2.1.1.m1.6.7"><csymbol cd="ambiguous" id="A2.E54X.2.1.1.m1.6.7.1.cmml" xref="A2.E54X.2.1.1.m1.6.7">subscript</csymbol><min id="A2.E54X.2.1.1.m1.6.7.2.cmml" xref="A2.E54X.2.1.1.m1.6.7.2"></min><list id="A2.E54X.2.1.1.m1.6.6.6.7.cmml" xref="A2.E54X.2.1.1.m1.6.6.6.6"><apply id="A2.E54X.2.1.1.m1.3.3.3.3.1.cmml" xref="A2.E54X.2.1.1.m1.3.3.3.3.1"><csymbol cd="ambiguous" id="A2.E54X.2.1.1.m1.3.3.3.3.1.1.cmml" xref="A2.E54X.2.1.1.m1.3.3.3.3.1">subscript</csymbol><ci id="A2.E54X.2.1.1.m1.3.3.3.3.1.2.cmml" xref="A2.E54X.2.1.1.m1.3.3.3.3.1.2">𝑣</ci><cn id="A2.E54X.2.1.1.m1.3.3.3.3.1.3.cmml" type="integer" xref="A2.E54X.2.1.1.m1.3.3.3.3.1.3">1</cn></apply><ci id="A2.E54X.2.1.1.m1.1.1.1.1.cmml" xref="A2.E54X.2.1.1.m1.1.1.1.1">…</ci><apply id="A2.E54X.2.1.1.m1.4.4.4.4.2.cmml" xref="A2.E54X.2.1.1.m1.4.4.4.4.2"><csymbol cd="ambiguous" id="A2.E54X.2.1.1.m1.4.4.4.4.2.1.cmml" xref="A2.E54X.2.1.1.m1.4.4.4.4.2">subscript</csymbol><ci id="A2.E54X.2.1.1.m1.4.4.4.4.2.2.cmml" xref="A2.E54X.2.1.1.m1.4.4.4.4.2.2">𝑣</ci><ci id="A2.E54X.2.1.1.m1.4.4.4.4.2.3.cmml" xref="A2.E54X.2.1.1.m1.4.4.4.4.2.3">𝐽</ci></apply><apply id="A2.E54X.2.1.1.m1.5.5.5.5.3.cmml" xref="A2.E54X.2.1.1.m1.5.5.5.5.3"><csymbol cd="ambiguous" id="A2.E54X.2.1.1.m1.5.5.5.5.3.1.cmml" xref="A2.E54X.2.1.1.m1.5.5.5.5.3">subscript</csymbol><ci id="A2.E54X.2.1.1.m1.5.5.5.5.3.2.cmml" xref="A2.E54X.2.1.1.m1.5.5.5.5.3.2">𝑋</ci><cn id="A2.E54X.2.1.1.m1.5.5.5.5.3.3.cmml" type="integer" xref="A2.E54X.2.1.1.m1.5.5.5.5.3.3">1</cn></apply><ci id="A2.E54X.2.1.1.m1.2.2.2.2.cmml" xref="A2.E54X.2.1.1.m1.2.2.2.2">…</ci><apply id="A2.E54X.2.1.1.m1.6.6.6.6.4.cmml" xref="A2.E54X.2.1.1.m1.6.6.6.6.4"><csymbol cd="ambiguous" id="A2.E54X.2.1.1.m1.6.6.6.6.4.1.cmml" xref="A2.E54X.2.1.1.m1.6.6.6.6.4">subscript</csymbol><ci id="A2.E54X.2.1.1.m1.6.6.6.6.4.2.cmml" xref="A2.E54X.2.1.1.m1.6.6.6.6.4.2">𝑋</ci><ci id="A2.E54X.2.1.1.m1.6.6.6.6.4.3.cmml" xref="A2.E54X.2.1.1.m1.6.6.6.6.4.3">𝐽</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E54X.2.1.1.m1.6c">\displaystyle\min_{v_{1},\ldots,v_{J},X_{1},\ldots,X_{J}}</annotation><annotation encoding="application/x-llamapun" id="A2.E54X.2.1.1.m1.6d">roman_min start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_v start_POSTSUBSCRIPT italic_J end_POSTSUBSCRIPT , italic_X start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_X start_POSTSUBSCRIPT italic_J end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\sum_{j=1}^{J}\left(v_{j}^{2}V(X_{j})-2v_{j}P(X_{j})\right)" class="ltx_Math" display="inline" id="A2.E54X.3.2.2.m1.1"><semantics id="A2.E54X.3.2.2.m1.1a"><mrow id="A2.E54X.3.2.2.m1.1.1" xref="A2.E54X.3.2.2.m1.1.1.cmml"><mstyle displaystyle="true" id="A2.E54X.3.2.2.m1.1.1.2" xref="A2.E54X.3.2.2.m1.1.1.2.cmml"><munderover id="A2.E54X.3.2.2.m1.1.1.2a" xref="A2.E54X.3.2.2.m1.1.1.2.cmml"><mo id="A2.E54X.3.2.2.m1.1.1.2.2.2" movablelimits="false" xref="A2.E54X.3.2.2.m1.1.1.2.2.2.cmml">∑</mo><mrow id="A2.E54X.3.2.2.m1.1.1.2.2.3" xref="A2.E54X.3.2.2.m1.1.1.2.2.3.cmml"><mi id="A2.E54X.3.2.2.m1.1.1.2.2.3.2" xref="A2.E54X.3.2.2.m1.1.1.2.2.3.2.cmml">j</mi><mo id="A2.E54X.3.2.2.m1.1.1.2.2.3.1" xref="A2.E54X.3.2.2.m1.1.1.2.2.3.1.cmml">=</mo><mn id="A2.E54X.3.2.2.m1.1.1.2.2.3.3" xref="A2.E54X.3.2.2.m1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="A2.E54X.3.2.2.m1.1.1.2.3" xref="A2.E54X.3.2.2.m1.1.1.2.3.cmml">J</mi></munderover></mstyle><mrow id="A2.E54X.3.2.2.m1.1.1.1.1" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.cmml"><mo id="A2.E54X.3.2.2.m1.1.1.1.1.2" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.cmml">(</mo><mrow id="A2.E54X.3.2.2.m1.1.1.1.1.1" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.cmml"><mrow id="A2.E54X.3.2.2.m1.1.1.1.1.1.1" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.1.cmml"><msubsup id="A2.E54X.3.2.2.m1.1.1.1.1.1.1.3" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.1.3.cmml"><mi id="A2.E54X.3.2.2.m1.1.1.1.1.1.1.3.2.2" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.1.3.2.2.cmml">v</mi><mi id="A2.E54X.3.2.2.m1.1.1.1.1.1.1.3.2.3" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.1.3.2.3.cmml">j</mi><mn id="A2.E54X.3.2.2.m1.1.1.1.1.1.1.3.3" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.1.3.3.cmml">2</mn></msubsup><mo id="A2.E54X.3.2.2.m1.1.1.1.1.1.1.2" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="A2.E54X.3.2.2.m1.1.1.1.1.1.1.4" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.1.4.cmml">V</mi><mo id="A2.E54X.3.2.2.m1.1.1.1.1.1.1.2a" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A2.E54X.3.2.2.m1.1.1.1.1.1.1.1.1" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A2.E54X.3.2.2.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A2.E54X.3.2.2.m1.1.1.1.1.1.1.1.1.1" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A2.E54X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.cmml">X</mi><mi id="A2.E54X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="A2.E54X.3.2.2.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A2.E54X.3.2.2.m1.1.1.1.1.1.3" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.3.cmml">−</mo><mrow id="A2.E54X.3.2.2.m1.1.1.1.1.1.2" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.2.cmml"><mn id="A2.E54X.3.2.2.m1.1.1.1.1.1.2.3" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.2.3.cmml">2</mn><mo id="A2.E54X.3.2.2.m1.1.1.1.1.1.2.2" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.2.2.cmml">⁢</mo><msub id="A2.E54X.3.2.2.m1.1.1.1.1.1.2.4" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.2.4.cmml"><mi id="A2.E54X.3.2.2.m1.1.1.1.1.1.2.4.2" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.2.4.2.cmml">v</mi><mi id="A2.E54X.3.2.2.m1.1.1.1.1.1.2.4.3" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.2.4.3.cmml">j</mi></msub><mo id="A2.E54X.3.2.2.m1.1.1.1.1.1.2.2a" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.2.2.cmml">⁢</mo><mi id="A2.E54X.3.2.2.m1.1.1.1.1.1.2.5" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.2.5.cmml">P</mi><mo id="A2.E54X.3.2.2.m1.1.1.1.1.1.2.2b" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.2.2.cmml">⁢</mo><mrow id="A2.E54X.3.2.2.m1.1.1.1.1.1.2.1.1" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.2.1.1.1.cmml"><mo id="A2.E54X.3.2.2.m1.1.1.1.1.1.2.1.1.2" stretchy="false" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.2.1.1.1.cmml">(</mo><msub id="A2.E54X.3.2.2.m1.1.1.1.1.1.2.1.1.1" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.2.1.1.1.cmml"><mi id="A2.E54X.3.2.2.m1.1.1.1.1.1.2.1.1.1.2" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.2.1.1.1.2.cmml">X</mi><mi id="A2.E54X.3.2.2.m1.1.1.1.1.1.2.1.1.1.3" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.2.1.1.1.3.cmml">j</mi></msub><mo id="A2.E54X.3.2.2.m1.1.1.1.1.1.2.1.1.3" stretchy="false" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A2.E54X.3.2.2.m1.1.1.1.1.3" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E54X.3.2.2.m1.1b"><apply id="A2.E54X.3.2.2.m1.1.1.cmml" xref="A2.E54X.3.2.2.m1.1.1"><apply id="A2.E54X.3.2.2.m1.1.1.2.cmml" xref="A2.E54X.3.2.2.m1.1.1.2"><csymbol cd="ambiguous" id="A2.E54X.3.2.2.m1.1.1.2.1.cmml" xref="A2.E54X.3.2.2.m1.1.1.2">superscript</csymbol><apply id="A2.E54X.3.2.2.m1.1.1.2.2.cmml" xref="A2.E54X.3.2.2.m1.1.1.2"><csymbol cd="ambiguous" id="A2.E54X.3.2.2.m1.1.1.2.2.1.cmml" xref="A2.E54X.3.2.2.m1.1.1.2">subscript</csymbol><sum id="A2.E54X.3.2.2.m1.1.1.2.2.2.cmml" xref="A2.E54X.3.2.2.m1.1.1.2.2.2"></sum><apply id="A2.E54X.3.2.2.m1.1.1.2.2.3.cmml" xref="A2.E54X.3.2.2.m1.1.1.2.2.3"><eq id="A2.E54X.3.2.2.m1.1.1.2.2.3.1.cmml" xref="A2.E54X.3.2.2.m1.1.1.2.2.3.1"></eq><ci id="A2.E54X.3.2.2.m1.1.1.2.2.3.2.cmml" xref="A2.E54X.3.2.2.m1.1.1.2.2.3.2">𝑗</ci><cn id="A2.E54X.3.2.2.m1.1.1.2.2.3.3.cmml" type="integer" xref="A2.E54X.3.2.2.m1.1.1.2.2.3.3">1</cn></apply></apply><ci id="A2.E54X.3.2.2.m1.1.1.2.3.cmml" xref="A2.E54X.3.2.2.m1.1.1.2.3">𝐽</ci></apply><apply id="A2.E54X.3.2.2.m1.1.1.1.1.1.cmml" xref="A2.E54X.3.2.2.m1.1.1.1.1"><minus id="A2.E54X.3.2.2.m1.1.1.1.1.1.3.cmml" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.3"></minus><apply id="A2.E54X.3.2.2.m1.1.1.1.1.1.1.cmml" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.1"><times id="A2.E54X.3.2.2.m1.1.1.1.1.1.1.2.cmml" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.1.2"></times><apply id="A2.E54X.3.2.2.m1.1.1.1.1.1.1.3.cmml" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.E54X.3.2.2.m1.1.1.1.1.1.1.3.1.cmml" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.1.3">superscript</csymbol><apply id="A2.E54X.3.2.2.m1.1.1.1.1.1.1.3.2.cmml" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.E54X.3.2.2.m1.1.1.1.1.1.1.3.2.1.cmml" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A2.E54X.3.2.2.m1.1.1.1.1.1.1.3.2.2.cmml" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.1.3.2.2">𝑣</ci><ci id="A2.E54X.3.2.2.m1.1.1.1.1.1.1.3.2.3.cmml" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.1.3.2.3">𝑗</ci></apply><cn id="A2.E54X.3.2.2.m1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.1.3.3">2</cn></apply><ci id="A2.E54X.3.2.2.m1.1.1.1.1.1.1.4.cmml" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.1.4">𝑉</ci><apply id="A2.E54X.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E54X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A2.E54X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2">𝑋</ci><ci id="A2.E54X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3">𝑗</ci></apply></apply><apply id="A2.E54X.3.2.2.m1.1.1.1.1.1.2.cmml" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.2"><times id="A2.E54X.3.2.2.m1.1.1.1.1.1.2.2.cmml" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.2.2"></times><cn id="A2.E54X.3.2.2.m1.1.1.1.1.1.2.3.cmml" type="integer" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.2.3">2</cn><apply id="A2.E54X.3.2.2.m1.1.1.1.1.1.2.4.cmml" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="A2.E54X.3.2.2.m1.1.1.1.1.1.2.4.1.cmml" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.2.4">subscript</csymbol><ci id="A2.E54X.3.2.2.m1.1.1.1.1.1.2.4.2.cmml" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.2.4.2">𝑣</ci><ci id="A2.E54X.3.2.2.m1.1.1.1.1.1.2.4.3.cmml" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.2.4.3">𝑗</ci></apply><ci id="A2.E54X.3.2.2.m1.1.1.1.1.1.2.5.cmml" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.2.5">𝑃</ci><apply id="A2.E54X.3.2.2.m1.1.1.1.1.1.2.1.1.1.cmml" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.2.1.1"><csymbol cd="ambiguous" id="A2.E54X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.cmml" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.2.1.1">subscript</csymbol><ci id="A2.E54X.3.2.2.m1.1.1.1.1.1.2.1.1.1.2.cmml" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.2.1.1.1.2">𝑋</ci><ci id="A2.E54X.3.2.2.m1.1.1.1.1.1.2.1.1.1.3.cmml" xref="A2.E54X.3.2.2.m1.1.1.1.1.1.2.1.1.1.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E54X.3.2.2.m1.1c">\displaystyle\sum_{j=1}^{J}\left(v_{j}^{2}V(X_{j})-2v_{j}P(X_{j})\right)</annotation><annotation encoding="application/x-llamapun" id="A2.E54X.3.2.2.m1.1d">∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_J end_POSTSUPERSCRIPT ( italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_V ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) - 2 italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_P ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(54)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A2.E54Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span class="ltx_text ltx_markedasmath ltx_font_italic" id="A2.E54Xa.2.1.1.1">s.t.</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\sum_{j=1}^{J}v_{j}V(X_{j})=1\,," class="ltx_Math" display="inline" id="A2.E54Xa.3.2.2.m1.1"><semantics id="A2.E54Xa.3.2.2.m1.1a"><mrow id="A2.E54Xa.3.2.2.m1.1.1.1" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.cmml"><mrow id="A2.E54Xa.3.2.2.m1.1.1.1.1" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.cmml"><mrow id="A2.E54Xa.3.2.2.m1.1.1.1.1.1" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A2.E54Xa.3.2.2.m1.1.1.1.1.1.2" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.1.2.cmml"><munderover id="A2.E54Xa.3.2.2.m1.1.1.1.1.1.2a" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.1.2.cmml"><mo id="A2.E54Xa.3.2.2.m1.1.1.1.1.1.2.2.2" movablelimits="false" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="A2.E54Xa.3.2.2.m1.1.1.1.1.1.2.2.3" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.1.2.2.3.cmml"><mi id="A2.E54Xa.3.2.2.m1.1.1.1.1.1.2.2.3.2" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.1.2.2.3.2.cmml">j</mi><mo id="A2.E54Xa.3.2.2.m1.1.1.1.1.1.2.2.3.1" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="A2.E54Xa.3.2.2.m1.1.1.1.1.1.2.2.3.3" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="A2.E54Xa.3.2.2.m1.1.1.1.1.1.2.3" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.1.2.3.cmml">J</mi></munderover></mstyle><mrow id="A2.E54Xa.3.2.2.m1.1.1.1.1.1.1" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.1.1.cmml"><msub id="A2.E54Xa.3.2.2.m1.1.1.1.1.1.1.3" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.1.1.3.cmml"><mi id="A2.E54Xa.3.2.2.m1.1.1.1.1.1.1.3.2" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.1.1.3.2.cmml">v</mi><mi id="A2.E54Xa.3.2.2.m1.1.1.1.1.1.1.3.3" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.1.1.3.3.cmml">j</mi></msub><mo id="A2.E54Xa.3.2.2.m1.1.1.1.1.1.1.2" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="A2.E54Xa.3.2.2.m1.1.1.1.1.1.1.4" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.1.1.4.cmml">V</mi><mo id="A2.E54Xa.3.2.2.m1.1.1.1.1.1.1.2a" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A2.E54Xa.3.2.2.m1.1.1.1.1.1.1.1.1" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A2.E54Xa.3.2.2.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A2.E54Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A2.E54Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.cmml">X</mi><mi id="A2.E54Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="A2.E54Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A2.E54Xa.3.2.2.m1.1.1.1.1.2" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.2.cmml">=</mo><mn id="A2.E54Xa.3.2.2.m1.1.1.1.1.3" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.3.cmml">1</mn></mrow><mo id="A2.E54Xa.3.2.2.m1.1.1.1.2" lspace="0.170em" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.E54Xa.3.2.2.m1.1b"><apply id="A2.E54Xa.3.2.2.m1.1.1.1.1.cmml" xref="A2.E54Xa.3.2.2.m1.1.1.1"><eq id="A2.E54Xa.3.2.2.m1.1.1.1.1.2.cmml" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.2"></eq><apply id="A2.E54Xa.3.2.2.m1.1.1.1.1.1.cmml" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.1"><apply id="A2.E54Xa.3.2.2.m1.1.1.1.1.1.2.cmml" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A2.E54Xa.3.2.2.m1.1.1.1.1.1.2.1.cmml" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.1.2">superscript</csymbol><apply id="A2.E54Xa.3.2.2.m1.1.1.1.1.1.2.2.cmml" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A2.E54Xa.3.2.2.m1.1.1.1.1.1.2.2.1.cmml" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.1.2">subscript</csymbol><sum id="A2.E54Xa.3.2.2.m1.1.1.1.1.1.2.2.2.cmml" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.1.2.2.2"></sum><apply id="A2.E54Xa.3.2.2.m1.1.1.1.1.1.2.2.3.cmml" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.1.2.2.3"><eq id="A2.E54Xa.3.2.2.m1.1.1.1.1.1.2.2.3.1.cmml" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.1.2.2.3.1"></eq><ci id="A2.E54Xa.3.2.2.m1.1.1.1.1.1.2.2.3.2.cmml" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.1.2.2.3.2">𝑗</ci><cn id="A2.E54Xa.3.2.2.m1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="A2.E54Xa.3.2.2.m1.1.1.1.1.1.2.3.cmml" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.1.2.3">𝐽</ci></apply><apply id="A2.E54Xa.3.2.2.m1.1.1.1.1.1.1.cmml" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.1.1"><times id="A2.E54Xa.3.2.2.m1.1.1.1.1.1.1.2.cmml" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.1.1.2"></times><apply id="A2.E54Xa.3.2.2.m1.1.1.1.1.1.1.3.cmml" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.E54Xa.3.2.2.m1.1.1.1.1.1.1.3.1.cmml" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A2.E54Xa.3.2.2.m1.1.1.1.1.1.1.3.2.cmml" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.1.1.3.2">𝑣</ci><ci id="A2.E54Xa.3.2.2.m1.1.1.1.1.1.1.3.3.cmml" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.1.1.3.3">𝑗</ci></apply><ci id="A2.E54Xa.3.2.2.m1.1.1.1.1.1.1.4.cmml" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.1.1.4">𝑉</ci><apply id="A2.E54Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E54Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A2.E54Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2">𝑋</ci><ci id="A2.E54Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3">𝑗</ci></apply></apply></apply><cn id="A2.E54Xa.3.2.2.m1.1.1.1.1.3.cmml" type="integer" xref="A2.E54Xa.3.2.2.m1.1.1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E54Xa.3.2.2.m1.1c">\displaystyle\sum_{j=1}^{J}v_{j}V(X_{j})=1\,,</annotation><annotation encoding="application/x-llamapun" id="A2.E54Xa.3.2.2.m1.1d">∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_J end_POSTSUPERSCRIPT italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_V ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) = 1 ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="A2.p2.6">where <math alttext="V(X)" class="ltx_Math" display="inline" id="A2.p2.4.m1.1"><semantics id="A2.p2.4.m1.1a"><mrow id="A2.p2.4.m1.1.2" xref="A2.p2.4.m1.1.2.cmml"><mi id="A2.p2.4.m1.1.2.2" xref="A2.p2.4.m1.1.2.2.cmml">V</mi><mo id="A2.p2.4.m1.1.2.1" xref="A2.p2.4.m1.1.2.1.cmml">⁢</mo><mrow id="A2.p2.4.m1.1.2.3.2" xref="A2.p2.4.m1.1.2.cmml"><mo id="A2.p2.4.m1.1.2.3.2.1" stretchy="false" xref="A2.p2.4.m1.1.2.cmml">(</mo><mi id="A2.p2.4.m1.1.1" xref="A2.p2.4.m1.1.1.cmml">X</mi><mo id="A2.p2.4.m1.1.2.3.2.2" stretchy="false" xref="A2.p2.4.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.4.m1.1b"><apply id="A2.p2.4.m1.1.2.cmml" xref="A2.p2.4.m1.1.2"><times id="A2.p2.4.m1.1.2.1.cmml" xref="A2.p2.4.m1.1.2.1"></times><ci id="A2.p2.4.m1.1.2.2.cmml" xref="A2.p2.4.m1.1.2.2">𝑉</ci><ci id="A2.p2.4.m1.1.1.cmml" xref="A2.p2.4.m1.1.1">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.4.m1.1c">V(X)</annotation><annotation encoding="application/x-llamapun" id="A2.p2.4.m1.1d">italic_V ( italic_X )</annotation></semantics></math> denotes the volume of a subset <math alttext="X" class="ltx_Math" display="inline" id="A2.p2.5.m2.1"><semantics id="A2.p2.5.m2.1a"><mi id="A2.p2.5.m2.1.1" xref="A2.p2.5.m2.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="A2.p2.5.m2.1b"><ci id="A2.p2.5.m2.1.1.cmml" xref="A2.p2.5.m2.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.5.m2.1c">X</annotation><annotation encoding="application/x-llamapun" id="A2.p2.5.m2.1d">italic_X</annotation></semantics></math>.
Solving this quadratic program for the <math alttext="v_{j}" class="ltx_Math" display="inline" id="A2.p2.6.m3.1"><semantics id="A2.p2.6.m3.1a"><msub id="A2.p2.6.m3.1.1" xref="A2.p2.6.m3.1.1.cmml"><mi id="A2.p2.6.m3.1.1.2" xref="A2.p2.6.m3.1.1.2.cmml">v</mi><mi id="A2.p2.6.m3.1.1.3" xref="A2.p2.6.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A2.p2.6.m3.1b"><apply id="A2.p2.6.m3.1.1.cmml" xref="A2.p2.6.m3.1.1"><csymbol cd="ambiguous" id="A2.p2.6.m3.1.1.1.cmml" xref="A2.p2.6.m3.1.1">subscript</csymbol><ci id="A2.p2.6.m3.1.1.2.cmml" xref="A2.p2.6.m3.1.1.2">𝑣</ci><ci id="A2.p2.6.m3.1.1.3.cmml" xref="A2.p2.6.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.6.m3.1c">v_{j}</annotation><annotation encoding="application/x-llamapun" id="A2.p2.6.m3.1d">italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> we obtain the following optimal leaf values and objective:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A5.EGx15">
<tbody id="A2.E55"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle v_{j}^{*}=\frac{P(X_{j})}{V(X_{j})}\,," class="ltx_Math" display="inline" id="A2.E55.m1.3"><semantics id="A2.E55.m1.3a"><mrow id="A2.E55.m1.3.3.1" xref="A2.E55.m1.3.3.1.1.cmml"><mrow id="A2.E55.m1.3.3.1.1" xref="A2.E55.m1.3.3.1.1.cmml"><msubsup id="A2.E55.m1.3.3.1.1.2" xref="A2.E55.m1.3.3.1.1.2.cmml"><mi id="A2.E55.m1.3.3.1.1.2.2.2" xref="A2.E55.m1.3.3.1.1.2.2.2.cmml">v</mi><mi id="A2.E55.m1.3.3.1.1.2.2.3" xref="A2.E55.m1.3.3.1.1.2.2.3.cmml">j</mi><mo id="A2.E55.m1.3.3.1.1.2.3" xref="A2.E55.m1.3.3.1.1.2.3.cmml">∗</mo></msubsup><mo id="A2.E55.m1.3.3.1.1.1" xref="A2.E55.m1.3.3.1.1.1.cmml">=</mo><mstyle displaystyle="true" id="A2.E55.m1.2.2" xref="A2.E55.m1.2.2.cmml"><mfrac id="A2.E55.m1.2.2a" xref="A2.E55.m1.2.2.cmml"><mrow id="A2.E55.m1.1.1.1" xref="A2.E55.m1.1.1.1.cmml"><mi id="A2.E55.m1.1.1.1.3" xref="A2.E55.m1.1.1.1.3.cmml">P</mi><mo id="A2.E55.m1.1.1.1.2" xref="A2.E55.m1.1.1.1.2.cmml">⁢</mo><mrow id="A2.E55.m1.1.1.1.1.1" xref="A2.E55.m1.1.1.1.1.1.1.cmml"><mo id="A2.E55.m1.1.1.1.1.1.2" stretchy="false" xref="A2.E55.m1.1.1.1.1.1.1.cmml">(</mo><msub id="A2.E55.m1.1.1.1.1.1.1" xref="A2.E55.m1.1.1.1.1.1.1.cmml"><mi id="A2.E55.m1.1.1.1.1.1.1.2" xref="A2.E55.m1.1.1.1.1.1.1.2.cmml">X</mi><mi id="A2.E55.m1.1.1.1.1.1.1.3" xref="A2.E55.m1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="A2.E55.m1.1.1.1.1.1.3" stretchy="false" xref="A2.E55.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A2.E55.m1.2.2.2" xref="A2.E55.m1.2.2.2.cmml"><mi id="A2.E55.m1.2.2.2.3" xref="A2.E55.m1.2.2.2.3.cmml">V</mi><mo id="A2.E55.m1.2.2.2.2" xref="A2.E55.m1.2.2.2.2.cmml">⁢</mo><mrow id="A2.E55.m1.2.2.2.1.1" xref="A2.E55.m1.2.2.2.1.1.1.cmml"><mo id="A2.E55.m1.2.2.2.1.1.2" stretchy="false" xref="A2.E55.m1.2.2.2.1.1.1.cmml">(</mo><msub id="A2.E55.m1.2.2.2.1.1.1" xref="A2.E55.m1.2.2.2.1.1.1.cmml"><mi id="A2.E55.m1.2.2.2.1.1.1.2" xref="A2.E55.m1.2.2.2.1.1.1.2.cmml">X</mi><mi id="A2.E55.m1.2.2.2.1.1.1.3" xref="A2.E55.m1.2.2.2.1.1.1.3.cmml">j</mi></msub><mo id="A2.E55.m1.2.2.2.1.1.3" stretchy="false" xref="A2.E55.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mstyle></mrow><mo id="A2.E55.m1.3.3.1.2" lspace="0.170em" xref="A2.E55.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.E55.m1.3b"><apply id="A2.E55.m1.3.3.1.1.cmml" xref="A2.E55.m1.3.3.1"><eq id="A2.E55.m1.3.3.1.1.1.cmml" xref="A2.E55.m1.3.3.1.1.1"></eq><apply id="A2.E55.m1.3.3.1.1.2.cmml" xref="A2.E55.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="A2.E55.m1.3.3.1.1.2.1.cmml" xref="A2.E55.m1.3.3.1.1.2">superscript</csymbol><apply id="A2.E55.m1.3.3.1.1.2.2.cmml" xref="A2.E55.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="A2.E55.m1.3.3.1.1.2.2.1.cmml" xref="A2.E55.m1.3.3.1.1.2">subscript</csymbol><ci id="A2.E55.m1.3.3.1.1.2.2.2.cmml" xref="A2.E55.m1.3.3.1.1.2.2.2">𝑣</ci><ci id="A2.E55.m1.3.3.1.1.2.2.3.cmml" xref="A2.E55.m1.3.3.1.1.2.2.3">𝑗</ci></apply><times id="A2.E55.m1.3.3.1.1.2.3.cmml" xref="A2.E55.m1.3.3.1.1.2.3"></times></apply><apply id="A2.E55.m1.2.2.cmml" xref="A2.E55.m1.2.2"><divide id="A2.E55.m1.2.2.3.cmml" xref="A2.E55.m1.2.2"></divide><apply id="A2.E55.m1.1.1.1.cmml" xref="A2.E55.m1.1.1.1"><times id="A2.E55.m1.1.1.1.2.cmml" xref="A2.E55.m1.1.1.1.2"></times><ci id="A2.E55.m1.1.1.1.3.cmml" xref="A2.E55.m1.1.1.1.3">𝑃</ci><apply id="A2.E55.m1.1.1.1.1.1.1.cmml" xref="A2.E55.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E55.m1.1.1.1.1.1.1.1.cmml" xref="A2.E55.m1.1.1.1.1.1">subscript</csymbol><ci id="A2.E55.m1.1.1.1.1.1.1.2.cmml" xref="A2.E55.m1.1.1.1.1.1.1.2">𝑋</ci><ci id="A2.E55.m1.1.1.1.1.1.1.3.cmml" xref="A2.E55.m1.1.1.1.1.1.1.3">𝑗</ci></apply></apply><apply id="A2.E55.m1.2.2.2.cmml" xref="A2.E55.m1.2.2.2"><times id="A2.E55.m1.2.2.2.2.cmml" xref="A2.E55.m1.2.2.2.2"></times><ci id="A2.E55.m1.2.2.2.3.cmml" xref="A2.E55.m1.2.2.2.3">𝑉</ci><apply id="A2.E55.m1.2.2.2.1.1.1.cmml" xref="A2.E55.m1.2.2.2.1.1"><csymbol cd="ambiguous" id="A2.E55.m1.2.2.2.1.1.1.1.cmml" xref="A2.E55.m1.2.2.2.1.1">subscript</csymbol><ci id="A2.E55.m1.2.2.2.1.1.1.2.cmml" xref="A2.E55.m1.2.2.2.1.1.1.2">𝑋</ci><ci id="A2.E55.m1.2.2.2.1.1.1.3.cmml" xref="A2.E55.m1.2.2.2.1.1.1.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E55.m1.3c">\displaystyle v_{j}^{*}=\frac{P(X_{j})}{V(X_{j})}\,,</annotation><annotation encoding="application/x-llamapun" id="A2.E55.m1.3d">italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = divide start_ARG italic_P ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG start_ARG italic_V ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG ,</annotation></semantics></math></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\text{ISE}^{*}\left(X_{1},\ldots,X_{J}\right)=-\sum_{j=1}^{J}%
\frac{P^{2}(X_{j})}{V_{f}(X_{j})}\,." class="ltx_Math" display="inline" id="A2.E55.m2.4"><semantics id="A2.E55.m2.4a"><mrow id="A2.E55.m2.4.4.1" xref="A2.E55.m2.4.4.1.1.cmml"><mrow id="A2.E55.m2.4.4.1.1" xref="A2.E55.m2.4.4.1.1.cmml"><mrow id="A2.E55.m2.4.4.1.1.2" xref="A2.E55.m2.4.4.1.1.2.cmml"><msup id="A2.E55.m2.4.4.1.1.2.4" xref="A2.E55.m2.4.4.1.1.2.4.cmml"><mtext id="A2.E55.m2.4.4.1.1.2.4.2" xref="A2.E55.m2.4.4.1.1.2.4.2a.cmml">ISE</mtext><mo id="A2.E55.m2.4.4.1.1.2.4.3" xref="A2.E55.m2.4.4.1.1.2.4.3.cmml">∗</mo></msup><mo id="A2.E55.m2.4.4.1.1.2.3" xref="A2.E55.m2.4.4.1.1.2.3.cmml">⁢</mo><mrow id="A2.E55.m2.4.4.1.1.2.2.2" xref="A2.E55.m2.4.4.1.1.2.2.3.cmml"><mo id="A2.E55.m2.4.4.1.1.2.2.2.3" xref="A2.E55.m2.4.4.1.1.2.2.3.cmml">(</mo><msub id="A2.E55.m2.4.4.1.1.1.1.1.1" xref="A2.E55.m2.4.4.1.1.1.1.1.1.cmml"><mi id="A2.E55.m2.4.4.1.1.1.1.1.1.2" xref="A2.E55.m2.4.4.1.1.1.1.1.1.2.cmml">X</mi><mn id="A2.E55.m2.4.4.1.1.1.1.1.1.3" xref="A2.E55.m2.4.4.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="A2.E55.m2.4.4.1.1.2.2.2.4" xref="A2.E55.m2.4.4.1.1.2.2.3.cmml">,</mo><mi id="A2.E55.m2.3.3" mathvariant="normal" xref="A2.E55.m2.3.3.cmml">…</mi><mo id="A2.E55.m2.4.4.1.1.2.2.2.5" xref="A2.E55.m2.4.4.1.1.2.2.3.cmml">,</mo><msub id="A2.E55.m2.4.4.1.1.2.2.2.2" xref="A2.E55.m2.4.4.1.1.2.2.2.2.cmml"><mi id="A2.E55.m2.4.4.1.1.2.2.2.2.2" xref="A2.E55.m2.4.4.1.1.2.2.2.2.2.cmml">X</mi><mi id="A2.E55.m2.4.4.1.1.2.2.2.2.3" xref="A2.E55.m2.4.4.1.1.2.2.2.2.3.cmml">J</mi></msub><mo id="A2.E55.m2.4.4.1.1.2.2.2.6" xref="A2.E55.m2.4.4.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="A2.E55.m2.4.4.1.1.3" xref="A2.E55.m2.4.4.1.1.3.cmml">=</mo><mrow id="A2.E55.m2.4.4.1.1.4" xref="A2.E55.m2.4.4.1.1.4.cmml"><mo id="A2.E55.m2.4.4.1.1.4a" xref="A2.E55.m2.4.4.1.1.4.cmml">−</mo><mrow id="A2.E55.m2.4.4.1.1.4.2" xref="A2.E55.m2.4.4.1.1.4.2.cmml"><mstyle displaystyle="true" id="A2.E55.m2.4.4.1.1.4.2.1" xref="A2.E55.m2.4.4.1.1.4.2.1.cmml"><munderover id="A2.E55.m2.4.4.1.1.4.2.1a" xref="A2.E55.m2.4.4.1.1.4.2.1.cmml"><mo id="A2.E55.m2.4.4.1.1.4.2.1.2.2" movablelimits="false" xref="A2.E55.m2.4.4.1.1.4.2.1.2.2.cmml">∑</mo><mrow id="A2.E55.m2.4.4.1.1.4.2.1.2.3" xref="A2.E55.m2.4.4.1.1.4.2.1.2.3.cmml"><mi id="A2.E55.m2.4.4.1.1.4.2.1.2.3.2" xref="A2.E55.m2.4.4.1.1.4.2.1.2.3.2.cmml">j</mi><mo id="A2.E55.m2.4.4.1.1.4.2.1.2.3.1" xref="A2.E55.m2.4.4.1.1.4.2.1.2.3.1.cmml">=</mo><mn id="A2.E55.m2.4.4.1.1.4.2.1.2.3.3" xref="A2.E55.m2.4.4.1.1.4.2.1.2.3.3.cmml">1</mn></mrow><mi id="A2.E55.m2.4.4.1.1.4.2.1.3" xref="A2.E55.m2.4.4.1.1.4.2.1.3.cmml">J</mi></munderover></mstyle><mstyle displaystyle="true" id="A2.E55.m2.2.2" xref="A2.E55.m2.2.2.cmml"><mfrac id="A2.E55.m2.2.2a" xref="A2.E55.m2.2.2.cmml"><mrow id="A2.E55.m2.1.1.1" xref="A2.E55.m2.1.1.1.cmml"><msup id="A2.E55.m2.1.1.1.3" xref="A2.E55.m2.1.1.1.3.cmml"><mi id="A2.E55.m2.1.1.1.3.2" xref="A2.E55.m2.1.1.1.3.2.cmml">P</mi><mn id="A2.E55.m2.1.1.1.3.3" xref="A2.E55.m2.1.1.1.3.3.cmml">2</mn></msup><mo id="A2.E55.m2.1.1.1.2" xref="A2.E55.m2.1.1.1.2.cmml">⁢</mo><mrow id="A2.E55.m2.1.1.1.1.1" xref="A2.E55.m2.1.1.1.1.1.1.cmml"><mo id="A2.E55.m2.1.1.1.1.1.2" stretchy="false" xref="A2.E55.m2.1.1.1.1.1.1.cmml">(</mo><msub id="A2.E55.m2.1.1.1.1.1.1" xref="A2.E55.m2.1.1.1.1.1.1.cmml"><mi id="A2.E55.m2.1.1.1.1.1.1.2" xref="A2.E55.m2.1.1.1.1.1.1.2.cmml">X</mi><mi id="A2.E55.m2.1.1.1.1.1.1.3" xref="A2.E55.m2.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="A2.E55.m2.1.1.1.1.1.3" stretchy="false" xref="A2.E55.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A2.E55.m2.2.2.2" xref="A2.E55.m2.2.2.2.cmml"><msub id="A2.E55.m2.2.2.2.3" xref="A2.E55.m2.2.2.2.3.cmml"><mi id="A2.E55.m2.2.2.2.3.2" xref="A2.E55.m2.2.2.2.3.2.cmml">V</mi><mi id="A2.E55.m2.2.2.2.3.3" xref="A2.E55.m2.2.2.2.3.3.cmml">f</mi></msub><mo id="A2.E55.m2.2.2.2.2" xref="A2.E55.m2.2.2.2.2.cmml">⁢</mo><mrow id="A2.E55.m2.2.2.2.1.1" xref="A2.E55.m2.2.2.2.1.1.1.cmml"><mo id="A2.E55.m2.2.2.2.1.1.2" stretchy="false" xref="A2.E55.m2.2.2.2.1.1.1.cmml">(</mo><msub id="A2.E55.m2.2.2.2.1.1.1" xref="A2.E55.m2.2.2.2.1.1.1.cmml"><mi id="A2.E55.m2.2.2.2.1.1.1.2" xref="A2.E55.m2.2.2.2.1.1.1.2.cmml">X</mi><mi id="A2.E55.m2.2.2.2.1.1.1.3" xref="A2.E55.m2.2.2.2.1.1.1.3.cmml">j</mi></msub><mo id="A2.E55.m2.2.2.2.1.1.3" stretchy="false" xref="A2.E55.m2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mstyle></mrow></mrow></mrow><mo id="A2.E55.m2.4.4.1.2" lspace="0.170em" xref="A2.E55.m2.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.E55.m2.4b"><apply id="A2.E55.m2.4.4.1.1.cmml" xref="A2.E55.m2.4.4.1"><eq id="A2.E55.m2.4.4.1.1.3.cmml" xref="A2.E55.m2.4.4.1.1.3"></eq><apply id="A2.E55.m2.4.4.1.1.2.cmml" xref="A2.E55.m2.4.4.1.1.2"><times id="A2.E55.m2.4.4.1.1.2.3.cmml" xref="A2.E55.m2.4.4.1.1.2.3"></times><apply id="A2.E55.m2.4.4.1.1.2.4.cmml" xref="A2.E55.m2.4.4.1.1.2.4"><csymbol cd="ambiguous" id="A2.E55.m2.4.4.1.1.2.4.1.cmml" xref="A2.E55.m2.4.4.1.1.2.4">superscript</csymbol><ci id="A2.E55.m2.4.4.1.1.2.4.2a.cmml" xref="A2.E55.m2.4.4.1.1.2.4.2"><mtext id="A2.E55.m2.4.4.1.1.2.4.2.cmml" xref="A2.E55.m2.4.4.1.1.2.4.2">ISE</mtext></ci><times id="A2.E55.m2.4.4.1.1.2.4.3.cmml" xref="A2.E55.m2.4.4.1.1.2.4.3"></times></apply><vector id="A2.E55.m2.4.4.1.1.2.2.3.cmml" xref="A2.E55.m2.4.4.1.1.2.2.2"><apply id="A2.E55.m2.4.4.1.1.1.1.1.1.cmml" xref="A2.E55.m2.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E55.m2.4.4.1.1.1.1.1.1.1.cmml" xref="A2.E55.m2.4.4.1.1.1.1.1.1">subscript</csymbol><ci id="A2.E55.m2.4.4.1.1.1.1.1.1.2.cmml" xref="A2.E55.m2.4.4.1.1.1.1.1.1.2">𝑋</ci><cn id="A2.E55.m2.4.4.1.1.1.1.1.1.3.cmml" type="integer" xref="A2.E55.m2.4.4.1.1.1.1.1.1.3">1</cn></apply><ci id="A2.E55.m2.3.3.cmml" xref="A2.E55.m2.3.3">…</ci><apply id="A2.E55.m2.4.4.1.1.2.2.2.2.cmml" xref="A2.E55.m2.4.4.1.1.2.2.2.2"><csymbol cd="ambiguous" id="A2.E55.m2.4.4.1.1.2.2.2.2.1.cmml" xref="A2.E55.m2.4.4.1.1.2.2.2.2">subscript</csymbol><ci id="A2.E55.m2.4.4.1.1.2.2.2.2.2.cmml" xref="A2.E55.m2.4.4.1.1.2.2.2.2.2">𝑋</ci><ci id="A2.E55.m2.4.4.1.1.2.2.2.2.3.cmml" xref="A2.E55.m2.4.4.1.1.2.2.2.2.3">𝐽</ci></apply></vector></apply><apply id="A2.E55.m2.4.4.1.1.4.cmml" xref="A2.E55.m2.4.4.1.1.4"><minus id="A2.E55.m2.4.4.1.1.4.1.cmml" xref="A2.E55.m2.4.4.1.1.4"></minus><apply id="A2.E55.m2.4.4.1.1.4.2.cmml" xref="A2.E55.m2.4.4.1.1.4.2"><apply id="A2.E55.m2.4.4.1.1.4.2.1.cmml" xref="A2.E55.m2.4.4.1.1.4.2.1"><csymbol cd="ambiguous" id="A2.E55.m2.4.4.1.1.4.2.1.1.cmml" xref="A2.E55.m2.4.4.1.1.4.2.1">superscript</csymbol><apply id="A2.E55.m2.4.4.1.1.4.2.1.2.cmml" xref="A2.E55.m2.4.4.1.1.4.2.1"><csymbol cd="ambiguous" id="A2.E55.m2.4.4.1.1.4.2.1.2.1.cmml" xref="A2.E55.m2.4.4.1.1.4.2.1">subscript</csymbol><sum id="A2.E55.m2.4.4.1.1.4.2.1.2.2.cmml" xref="A2.E55.m2.4.4.1.1.4.2.1.2.2"></sum><apply id="A2.E55.m2.4.4.1.1.4.2.1.2.3.cmml" xref="A2.E55.m2.4.4.1.1.4.2.1.2.3"><eq id="A2.E55.m2.4.4.1.1.4.2.1.2.3.1.cmml" xref="A2.E55.m2.4.4.1.1.4.2.1.2.3.1"></eq><ci id="A2.E55.m2.4.4.1.1.4.2.1.2.3.2.cmml" xref="A2.E55.m2.4.4.1.1.4.2.1.2.3.2">𝑗</ci><cn id="A2.E55.m2.4.4.1.1.4.2.1.2.3.3.cmml" type="integer" xref="A2.E55.m2.4.4.1.1.4.2.1.2.3.3">1</cn></apply></apply><ci id="A2.E55.m2.4.4.1.1.4.2.1.3.cmml" xref="A2.E55.m2.4.4.1.1.4.2.1.3">𝐽</ci></apply><apply id="A2.E55.m2.2.2.cmml" xref="A2.E55.m2.2.2"><divide id="A2.E55.m2.2.2.3.cmml" xref="A2.E55.m2.2.2"></divide><apply id="A2.E55.m2.1.1.1.cmml" xref="A2.E55.m2.1.1.1"><times id="A2.E55.m2.1.1.1.2.cmml" xref="A2.E55.m2.1.1.1.2"></times><apply id="A2.E55.m2.1.1.1.3.cmml" xref="A2.E55.m2.1.1.1.3"><csymbol cd="ambiguous" id="A2.E55.m2.1.1.1.3.1.cmml" xref="A2.E55.m2.1.1.1.3">superscript</csymbol><ci id="A2.E55.m2.1.1.1.3.2.cmml" xref="A2.E55.m2.1.1.1.3.2">𝑃</ci><cn id="A2.E55.m2.1.1.1.3.3.cmml" type="integer" xref="A2.E55.m2.1.1.1.3.3">2</cn></apply><apply id="A2.E55.m2.1.1.1.1.1.1.cmml" xref="A2.E55.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E55.m2.1.1.1.1.1.1.1.cmml" xref="A2.E55.m2.1.1.1.1.1">subscript</csymbol><ci id="A2.E55.m2.1.1.1.1.1.1.2.cmml" xref="A2.E55.m2.1.1.1.1.1.1.2">𝑋</ci><ci id="A2.E55.m2.1.1.1.1.1.1.3.cmml" xref="A2.E55.m2.1.1.1.1.1.1.3">𝑗</ci></apply></apply><apply id="A2.E55.m2.2.2.2.cmml" xref="A2.E55.m2.2.2.2"><times id="A2.E55.m2.2.2.2.2.cmml" xref="A2.E55.m2.2.2.2.2"></times><apply id="A2.E55.m2.2.2.2.3.cmml" xref="A2.E55.m2.2.2.2.3"><csymbol cd="ambiguous" id="A2.E55.m2.2.2.2.3.1.cmml" xref="A2.E55.m2.2.2.2.3">subscript</csymbol><ci id="A2.E55.m2.2.2.2.3.2.cmml" xref="A2.E55.m2.2.2.2.3.2">𝑉</ci><ci id="A2.E55.m2.2.2.2.3.3.cmml" xref="A2.E55.m2.2.2.2.3.3">𝑓</ci></apply><apply id="A2.E55.m2.2.2.2.1.1.1.cmml" xref="A2.E55.m2.2.2.2.1.1"><csymbol cd="ambiguous" id="A2.E55.m2.2.2.2.1.1.1.1.cmml" xref="A2.E55.m2.2.2.2.1.1">subscript</csymbol><ci id="A2.E55.m2.2.2.2.1.1.1.2.cmml" xref="A2.E55.m2.2.2.2.1.1.1.2">𝑋</ci><ci id="A2.E55.m2.2.2.2.1.1.1.3.cmml" xref="A2.E55.m2.2.2.2.1.1.1.3">𝑗</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E55.m2.4c">\displaystyle\text{ISE}^{*}\left(X_{1},\ldots,X_{J}\right)=-\sum_{j=1}^{J}%
\frac{P^{2}(X_{j})}{V_{f}(X_{j})}\,.</annotation><annotation encoding="application/x-llamapun" id="A2.E55.m2.4d">ISE start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_X start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_X start_POSTSUBSCRIPT italic_J end_POSTSUBSCRIPT ) = - ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_J end_POSTSUPERSCRIPT divide start_ARG italic_P start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG start_ARG italic_V start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(55)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A2.p2.9">One can therefore grow a tree by greedily choosing to split a parent leaf with support <math alttext="X_{P}" class="ltx_Math" display="inline" id="A2.p2.7.m1.1"><semantics id="A2.p2.7.m1.1a"><msub id="A2.p2.7.m1.1.1" xref="A2.p2.7.m1.1.1.cmml"><mi id="A2.p2.7.m1.1.1.2" xref="A2.p2.7.m1.1.1.2.cmml">X</mi><mi id="A2.p2.7.m1.1.1.3" xref="A2.p2.7.m1.1.1.3.cmml">P</mi></msub><annotation-xml encoding="MathML-Content" id="A2.p2.7.m1.1b"><apply id="A2.p2.7.m1.1.1.cmml" xref="A2.p2.7.m1.1.1"><csymbol cd="ambiguous" id="A2.p2.7.m1.1.1.1.cmml" xref="A2.p2.7.m1.1.1">subscript</csymbol><ci id="A2.p2.7.m1.1.1.2.cmml" xref="A2.p2.7.m1.1.1.2">𝑋</ci><ci id="A2.p2.7.m1.1.1.3.cmml" xref="A2.p2.7.m1.1.1.3">𝑃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.7.m1.1c">X_{P}</annotation><annotation encoding="application/x-llamapun" id="A2.p2.7.m1.1d">italic_X start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT</annotation></semantics></math> into two leaves with supports <math alttext="X_{L}" class="ltx_Math" display="inline" id="A2.p2.8.m2.1"><semantics id="A2.p2.8.m2.1a"><msub id="A2.p2.8.m2.1.1" xref="A2.p2.8.m2.1.1.cmml"><mi id="A2.p2.8.m2.1.1.2" xref="A2.p2.8.m2.1.1.2.cmml">X</mi><mi id="A2.p2.8.m2.1.1.3" xref="A2.p2.8.m2.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="A2.p2.8.m2.1b"><apply id="A2.p2.8.m2.1.1.cmml" xref="A2.p2.8.m2.1.1"><csymbol cd="ambiguous" id="A2.p2.8.m2.1.1.1.cmml" xref="A2.p2.8.m2.1.1">subscript</csymbol><ci id="A2.p2.8.m2.1.1.2.cmml" xref="A2.p2.8.m2.1.1.2">𝑋</ci><ci id="A2.p2.8.m2.1.1.3.cmml" xref="A2.p2.8.m2.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.8.m2.1c">X_{L}</annotation><annotation encoding="application/x-llamapun" id="A2.p2.8.m2.1d">italic_X start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="X_{R}" class="ltx_Math" display="inline" id="A2.p2.9.m3.1"><semantics id="A2.p2.9.m3.1a"><msub id="A2.p2.9.m3.1.1" xref="A2.p2.9.m3.1.1.cmml"><mi id="A2.p2.9.m3.1.1.2" xref="A2.p2.9.m3.1.1.2.cmml">X</mi><mi id="A2.p2.9.m3.1.1.3" xref="A2.p2.9.m3.1.1.3.cmml">R</mi></msub><annotation-xml encoding="MathML-Content" id="A2.p2.9.m3.1b"><apply id="A2.p2.9.m3.1.1.cmml" xref="A2.p2.9.m3.1.1"><csymbol cd="ambiguous" id="A2.p2.9.m3.1.1.1.cmml" xref="A2.p2.9.m3.1.1">subscript</csymbol><ci id="A2.p2.9.m3.1.1.2.cmml" xref="A2.p2.9.m3.1.1.2">𝑋</ci><ci id="A2.p2.9.m3.1.1.3.cmml" xref="A2.p2.9.m3.1.1.3">𝑅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.9.m3.1c">X_{R}</annotation><annotation encoding="application/x-llamapun" id="A2.p2.9.m3.1d">italic_X start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT</annotation></semantics></math> so as to maximize the following criterion:</p>
<table class="ltx_equation ltx_eqn_table" id="A2.E56">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\max_{X_{L},X_{R}\in\mathcal{P}\left(X_{P}\right)}\frac{P^{2}(X_{L})}{V(X_{L})%
}+\frac{P^{2}(X_{R})}{V(X_{R})}-\frac{P^{2}(X_{P})}{V(X_{P})}\,." class="ltx_Math" display="block" id="A2.E56.m1.10"><semantics id="A2.E56.m1.10a"><mrow id="A2.E56.m1.10.10.1" xref="A2.E56.m1.10.10.1.1.cmml"><mrow id="A2.E56.m1.10.10.1.1" xref="A2.E56.m1.10.10.1.1.cmml"><mrow id="A2.E56.m1.10.10.1.1.2" xref="A2.E56.m1.10.10.1.1.2.cmml"><mrow id="A2.E56.m1.10.10.1.1.2.2" xref="A2.E56.m1.10.10.1.1.2.2.cmml"><munder id="A2.E56.m1.10.10.1.1.2.2.1" xref="A2.E56.m1.10.10.1.1.2.2.1.cmml"><mi id="A2.E56.m1.10.10.1.1.2.2.1.2" xref="A2.E56.m1.10.10.1.1.2.2.1.2.cmml">max</mi><mrow id="A2.E56.m1.3.3.3" xref="A2.E56.m1.3.3.3.cmml"><mrow id="A2.E56.m1.2.2.2.2.2" xref="A2.E56.m1.2.2.2.2.3.cmml"><msub id="A2.E56.m1.1.1.1.1.1.1" xref="A2.E56.m1.1.1.1.1.1.1.cmml"><mi id="A2.E56.m1.1.1.1.1.1.1.2" xref="A2.E56.m1.1.1.1.1.1.1.2.cmml">X</mi><mi id="A2.E56.m1.1.1.1.1.1.1.3" xref="A2.E56.m1.1.1.1.1.1.1.3.cmml">L</mi></msub><mo id="A2.E56.m1.2.2.2.2.2.3" xref="A2.E56.m1.2.2.2.2.3.cmml">,</mo><msub id="A2.E56.m1.2.2.2.2.2.2" xref="A2.E56.m1.2.2.2.2.2.2.cmml"><mi id="A2.E56.m1.2.2.2.2.2.2.2" xref="A2.E56.m1.2.2.2.2.2.2.2.cmml">X</mi><mi id="A2.E56.m1.2.2.2.2.2.2.3" xref="A2.E56.m1.2.2.2.2.2.2.3.cmml">R</mi></msub></mrow><mo id="A2.E56.m1.3.3.3.4" xref="A2.E56.m1.3.3.3.4.cmml">∈</mo><mrow id="A2.E56.m1.3.3.3.3" xref="A2.E56.m1.3.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.E56.m1.3.3.3.3.3" xref="A2.E56.m1.3.3.3.3.3.cmml">𝒫</mi><mo id="A2.E56.m1.3.3.3.3.2" xref="A2.E56.m1.3.3.3.3.2.cmml">⁢</mo><mrow id="A2.E56.m1.3.3.3.3.1.1" xref="A2.E56.m1.3.3.3.3.1.1.1.cmml"><mo id="A2.E56.m1.3.3.3.3.1.1.2" xref="A2.E56.m1.3.3.3.3.1.1.1.cmml">(</mo><msub id="A2.E56.m1.3.3.3.3.1.1.1" xref="A2.E56.m1.3.3.3.3.1.1.1.cmml"><mi id="A2.E56.m1.3.3.3.3.1.1.1.2" xref="A2.E56.m1.3.3.3.3.1.1.1.2.cmml">X</mi><mi id="A2.E56.m1.3.3.3.3.1.1.1.3" xref="A2.E56.m1.3.3.3.3.1.1.1.3.cmml">P</mi></msub><mo id="A2.E56.m1.3.3.3.3.1.1.3" xref="A2.E56.m1.3.3.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow></munder><mo id="A2.E56.m1.10.10.1.1.2.2a" lspace="0.167em" xref="A2.E56.m1.10.10.1.1.2.2.cmml">⁡</mo><mfrac id="A2.E56.m1.5.5" xref="A2.E56.m1.5.5.cmml"><mrow id="A2.E56.m1.4.4.1" xref="A2.E56.m1.4.4.1.cmml"><msup id="A2.E56.m1.4.4.1.3" xref="A2.E56.m1.4.4.1.3.cmml"><mi id="A2.E56.m1.4.4.1.3.2" xref="A2.E56.m1.4.4.1.3.2.cmml">P</mi><mn id="A2.E56.m1.4.4.1.3.3" xref="A2.E56.m1.4.4.1.3.3.cmml">2</mn></msup><mo id="A2.E56.m1.4.4.1.2" xref="A2.E56.m1.4.4.1.2.cmml">⁢</mo><mrow id="A2.E56.m1.4.4.1.1.1" xref="A2.E56.m1.4.4.1.1.1.1.cmml"><mo id="A2.E56.m1.4.4.1.1.1.2" stretchy="false" xref="A2.E56.m1.4.4.1.1.1.1.cmml">(</mo><msub id="A2.E56.m1.4.4.1.1.1.1" xref="A2.E56.m1.4.4.1.1.1.1.cmml"><mi id="A2.E56.m1.4.4.1.1.1.1.2" xref="A2.E56.m1.4.4.1.1.1.1.2.cmml">X</mi><mi id="A2.E56.m1.4.4.1.1.1.1.3" xref="A2.E56.m1.4.4.1.1.1.1.3.cmml">L</mi></msub><mo id="A2.E56.m1.4.4.1.1.1.3" stretchy="false" xref="A2.E56.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A2.E56.m1.5.5.2" xref="A2.E56.m1.5.5.2.cmml"><mi id="A2.E56.m1.5.5.2.3" xref="A2.E56.m1.5.5.2.3.cmml">V</mi><mo id="A2.E56.m1.5.5.2.2" xref="A2.E56.m1.5.5.2.2.cmml">⁢</mo><mrow id="A2.E56.m1.5.5.2.1.1" xref="A2.E56.m1.5.5.2.1.1.1.cmml"><mo id="A2.E56.m1.5.5.2.1.1.2" stretchy="false" xref="A2.E56.m1.5.5.2.1.1.1.cmml">(</mo><msub id="A2.E56.m1.5.5.2.1.1.1" xref="A2.E56.m1.5.5.2.1.1.1.cmml"><mi id="A2.E56.m1.5.5.2.1.1.1.2" xref="A2.E56.m1.5.5.2.1.1.1.2.cmml">X</mi><mi id="A2.E56.m1.5.5.2.1.1.1.3" xref="A2.E56.m1.5.5.2.1.1.1.3.cmml">L</mi></msub><mo id="A2.E56.m1.5.5.2.1.1.3" stretchy="false" xref="A2.E56.m1.5.5.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow><mo id="A2.E56.m1.10.10.1.1.2.1" xref="A2.E56.m1.10.10.1.1.2.1.cmml">+</mo><mfrac id="A2.E56.m1.7.7" xref="A2.E56.m1.7.7.cmml"><mrow id="A2.E56.m1.6.6.1" xref="A2.E56.m1.6.6.1.cmml"><msup id="A2.E56.m1.6.6.1.3" xref="A2.E56.m1.6.6.1.3.cmml"><mi id="A2.E56.m1.6.6.1.3.2" xref="A2.E56.m1.6.6.1.3.2.cmml">P</mi><mn id="A2.E56.m1.6.6.1.3.3" xref="A2.E56.m1.6.6.1.3.3.cmml">2</mn></msup><mo id="A2.E56.m1.6.6.1.2" xref="A2.E56.m1.6.6.1.2.cmml">⁢</mo><mrow id="A2.E56.m1.6.6.1.1.1" xref="A2.E56.m1.6.6.1.1.1.1.cmml"><mo id="A2.E56.m1.6.6.1.1.1.2" stretchy="false" xref="A2.E56.m1.6.6.1.1.1.1.cmml">(</mo><msub id="A2.E56.m1.6.6.1.1.1.1" xref="A2.E56.m1.6.6.1.1.1.1.cmml"><mi id="A2.E56.m1.6.6.1.1.1.1.2" xref="A2.E56.m1.6.6.1.1.1.1.2.cmml">X</mi><mi id="A2.E56.m1.6.6.1.1.1.1.3" xref="A2.E56.m1.6.6.1.1.1.1.3.cmml">R</mi></msub><mo id="A2.E56.m1.6.6.1.1.1.3" stretchy="false" xref="A2.E56.m1.6.6.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A2.E56.m1.7.7.2" xref="A2.E56.m1.7.7.2.cmml"><mi id="A2.E56.m1.7.7.2.3" xref="A2.E56.m1.7.7.2.3.cmml">V</mi><mo id="A2.E56.m1.7.7.2.2" xref="A2.E56.m1.7.7.2.2.cmml">⁢</mo><mrow id="A2.E56.m1.7.7.2.1.1" xref="A2.E56.m1.7.7.2.1.1.1.cmml"><mo id="A2.E56.m1.7.7.2.1.1.2" stretchy="false" xref="A2.E56.m1.7.7.2.1.1.1.cmml">(</mo><msub id="A2.E56.m1.7.7.2.1.1.1" xref="A2.E56.m1.7.7.2.1.1.1.cmml"><mi id="A2.E56.m1.7.7.2.1.1.1.2" xref="A2.E56.m1.7.7.2.1.1.1.2.cmml">X</mi><mi id="A2.E56.m1.7.7.2.1.1.1.3" xref="A2.E56.m1.7.7.2.1.1.1.3.cmml">R</mi></msub><mo id="A2.E56.m1.7.7.2.1.1.3" stretchy="false" xref="A2.E56.m1.7.7.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow><mo id="A2.E56.m1.10.10.1.1.1" xref="A2.E56.m1.10.10.1.1.1.cmml">−</mo><mfrac id="A2.E56.m1.9.9" xref="A2.E56.m1.9.9.cmml"><mrow id="A2.E56.m1.8.8.1" xref="A2.E56.m1.8.8.1.cmml"><msup id="A2.E56.m1.8.8.1.3" xref="A2.E56.m1.8.8.1.3.cmml"><mi id="A2.E56.m1.8.8.1.3.2" xref="A2.E56.m1.8.8.1.3.2.cmml">P</mi><mn id="A2.E56.m1.8.8.1.3.3" xref="A2.E56.m1.8.8.1.3.3.cmml">2</mn></msup><mo id="A2.E56.m1.8.8.1.2" xref="A2.E56.m1.8.8.1.2.cmml">⁢</mo><mrow id="A2.E56.m1.8.8.1.1.1" xref="A2.E56.m1.8.8.1.1.1.1.cmml"><mo id="A2.E56.m1.8.8.1.1.1.2" stretchy="false" xref="A2.E56.m1.8.8.1.1.1.1.cmml">(</mo><msub id="A2.E56.m1.8.8.1.1.1.1" xref="A2.E56.m1.8.8.1.1.1.1.cmml"><mi id="A2.E56.m1.8.8.1.1.1.1.2" xref="A2.E56.m1.8.8.1.1.1.1.2.cmml">X</mi><mi id="A2.E56.m1.8.8.1.1.1.1.3" xref="A2.E56.m1.8.8.1.1.1.1.3.cmml">P</mi></msub><mo id="A2.E56.m1.8.8.1.1.1.3" stretchy="false" xref="A2.E56.m1.8.8.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A2.E56.m1.9.9.2" xref="A2.E56.m1.9.9.2.cmml"><mi id="A2.E56.m1.9.9.2.3" xref="A2.E56.m1.9.9.2.3.cmml">V</mi><mo id="A2.E56.m1.9.9.2.2" xref="A2.E56.m1.9.9.2.2.cmml">⁢</mo><mrow id="A2.E56.m1.9.9.2.1.1" xref="A2.E56.m1.9.9.2.1.1.1.cmml"><mo id="A2.E56.m1.9.9.2.1.1.2" stretchy="false" xref="A2.E56.m1.9.9.2.1.1.1.cmml">(</mo><msub id="A2.E56.m1.9.9.2.1.1.1" xref="A2.E56.m1.9.9.2.1.1.1.cmml"><mi id="A2.E56.m1.9.9.2.1.1.1.2" xref="A2.E56.m1.9.9.2.1.1.1.2.cmml">X</mi><mi id="A2.E56.m1.9.9.2.1.1.1.3" xref="A2.E56.m1.9.9.2.1.1.1.3.cmml">P</mi></msub><mo id="A2.E56.m1.9.9.2.1.1.3" stretchy="false" xref="A2.E56.m1.9.9.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow><mo id="A2.E56.m1.10.10.1.2" lspace="0.170em" xref="A2.E56.m1.10.10.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.E56.m1.10b"><apply id="A2.E56.m1.10.10.1.1.cmml" xref="A2.E56.m1.10.10.1"><minus id="A2.E56.m1.10.10.1.1.1.cmml" xref="A2.E56.m1.10.10.1.1.1"></minus><apply id="A2.E56.m1.10.10.1.1.2.cmml" xref="A2.E56.m1.10.10.1.1.2"><plus id="A2.E56.m1.10.10.1.1.2.1.cmml" xref="A2.E56.m1.10.10.1.1.2.1"></plus><apply id="A2.E56.m1.10.10.1.1.2.2.cmml" xref="A2.E56.m1.10.10.1.1.2.2"><apply id="A2.E56.m1.10.10.1.1.2.2.1.cmml" xref="A2.E56.m1.10.10.1.1.2.2.1"><csymbol cd="ambiguous" id="A2.E56.m1.10.10.1.1.2.2.1.1.cmml" xref="A2.E56.m1.10.10.1.1.2.2.1">subscript</csymbol><max id="A2.E56.m1.10.10.1.1.2.2.1.2.cmml" xref="A2.E56.m1.10.10.1.1.2.2.1.2"></max><apply id="A2.E56.m1.3.3.3.cmml" xref="A2.E56.m1.3.3.3"><in id="A2.E56.m1.3.3.3.4.cmml" xref="A2.E56.m1.3.3.3.4"></in><list id="A2.E56.m1.2.2.2.2.3.cmml" xref="A2.E56.m1.2.2.2.2.2"><apply id="A2.E56.m1.1.1.1.1.1.1.cmml" xref="A2.E56.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E56.m1.1.1.1.1.1.1.1.cmml" xref="A2.E56.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A2.E56.m1.1.1.1.1.1.1.2.cmml" xref="A2.E56.m1.1.1.1.1.1.1.2">𝑋</ci><ci id="A2.E56.m1.1.1.1.1.1.1.3.cmml" xref="A2.E56.m1.1.1.1.1.1.1.3">𝐿</ci></apply><apply id="A2.E56.m1.2.2.2.2.2.2.cmml" xref="A2.E56.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A2.E56.m1.2.2.2.2.2.2.1.cmml" xref="A2.E56.m1.2.2.2.2.2.2">subscript</csymbol><ci id="A2.E56.m1.2.2.2.2.2.2.2.cmml" xref="A2.E56.m1.2.2.2.2.2.2.2">𝑋</ci><ci id="A2.E56.m1.2.2.2.2.2.2.3.cmml" xref="A2.E56.m1.2.2.2.2.2.2.3">𝑅</ci></apply></list><apply id="A2.E56.m1.3.3.3.3.cmml" xref="A2.E56.m1.3.3.3.3"><times id="A2.E56.m1.3.3.3.3.2.cmml" xref="A2.E56.m1.3.3.3.3.2"></times><ci id="A2.E56.m1.3.3.3.3.3.cmml" xref="A2.E56.m1.3.3.3.3.3">𝒫</ci><apply id="A2.E56.m1.3.3.3.3.1.1.1.cmml" xref="A2.E56.m1.3.3.3.3.1.1"><csymbol cd="ambiguous" id="A2.E56.m1.3.3.3.3.1.1.1.1.cmml" xref="A2.E56.m1.3.3.3.3.1.1">subscript</csymbol><ci id="A2.E56.m1.3.3.3.3.1.1.1.2.cmml" xref="A2.E56.m1.3.3.3.3.1.1.1.2">𝑋</ci><ci id="A2.E56.m1.3.3.3.3.1.1.1.3.cmml" xref="A2.E56.m1.3.3.3.3.1.1.1.3">𝑃</ci></apply></apply></apply></apply><apply id="A2.E56.m1.5.5.cmml" xref="A2.E56.m1.5.5"><divide id="A2.E56.m1.5.5.3.cmml" xref="A2.E56.m1.5.5"></divide><apply id="A2.E56.m1.4.4.1.cmml" xref="A2.E56.m1.4.4.1"><times id="A2.E56.m1.4.4.1.2.cmml" xref="A2.E56.m1.4.4.1.2"></times><apply id="A2.E56.m1.4.4.1.3.cmml" xref="A2.E56.m1.4.4.1.3"><csymbol cd="ambiguous" id="A2.E56.m1.4.4.1.3.1.cmml" xref="A2.E56.m1.4.4.1.3">superscript</csymbol><ci id="A2.E56.m1.4.4.1.3.2.cmml" xref="A2.E56.m1.4.4.1.3.2">𝑃</ci><cn id="A2.E56.m1.4.4.1.3.3.cmml" type="integer" xref="A2.E56.m1.4.4.1.3.3">2</cn></apply><apply id="A2.E56.m1.4.4.1.1.1.1.cmml" xref="A2.E56.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="A2.E56.m1.4.4.1.1.1.1.1.cmml" xref="A2.E56.m1.4.4.1.1.1">subscript</csymbol><ci id="A2.E56.m1.4.4.1.1.1.1.2.cmml" xref="A2.E56.m1.4.4.1.1.1.1.2">𝑋</ci><ci id="A2.E56.m1.4.4.1.1.1.1.3.cmml" xref="A2.E56.m1.4.4.1.1.1.1.3">𝐿</ci></apply></apply><apply id="A2.E56.m1.5.5.2.cmml" xref="A2.E56.m1.5.5.2"><times id="A2.E56.m1.5.5.2.2.cmml" xref="A2.E56.m1.5.5.2.2"></times><ci id="A2.E56.m1.5.5.2.3.cmml" xref="A2.E56.m1.5.5.2.3">𝑉</ci><apply id="A2.E56.m1.5.5.2.1.1.1.cmml" xref="A2.E56.m1.5.5.2.1.1"><csymbol cd="ambiguous" id="A2.E56.m1.5.5.2.1.1.1.1.cmml" xref="A2.E56.m1.5.5.2.1.1">subscript</csymbol><ci id="A2.E56.m1.5.5.2.1.1.1.2.cmml" xref="A2.E56.m1.5.5.2.1.1.1.2">𝑋</ci><ci id="A2.E56.m1.5.5.2.1.1.1.3.cmml" xref="A2.E56.m1.5.5.2.1.1.1.3">𝐿</ci></apply></apply></apply></apply><apply id="A2.E56.m1.7.7.cmml" xref="A2.E56.m1.7.7"><divide id="A2.E56.m1.7.7.3.cmml" xref="A2.E56.m1.7.7"></divide><apply id="A2.E56.m1.6.6.1.cmml" xref="A2.E56.m1.6.6.1"><times id="A2.E56.m1.6.6.1.2.cmml" xref="A2.E56.m1.6.6.1.2"></times><apply id="A2.E56.m1.6.6.1.3.cmml" xref="A2.E56.m1.6.6.1.3"><csymbol cd="ambiguous" id="A2.E56.m1.6.6.1.3.1.cmml" xref="A2.E56.m1.6.6.1.3">superscript</csymbol><ci id="A2.E56.m1.6.6.1.3.2.cmml" xref="A2.E56.m1.6.6.1.3.2">𝑃</ci><cn id="A2.E56.m1.6.6.1.3.3.cmml" type="integer" xref="A2.E56.m1.6.6.1.3.3">2</cn></apply><apply id="A2.E56.m1.6.6.1.1.1.1.cmml" xref="A2.E56.m1.6.6.1.1.1"><csymbol cd="ambiguous" id="A2.E56.m1.6.6.1.1.1.1.1.cmml" xref="A2.E56.m1.6.6.1.1.1">subscript</csymbol><ci id="A2.E56.m1.6.6.1.1.1.1.2.cmml" xref="A2.E56.m1.6.6.1.1.1.1.2">𝑋</ci><ci id="A2.E56.m1.6.6.1.1.1.1.3.cmml" xref="A2.E56.m1.6.6.1.1.1.1.3">𝑅</ci></apply></apply><apply id="A2.E56.m1.7.7.2.cmml" xref="A2.E56.m1.7.7.2"><times id="A2.E56.m1.7.7.2.2.cmml" xref="A2.E56.m1.7.7.2.2"></times><ci id="A2.E56.m1.7.7.2.3.cmml" xref="A2.E56.m1.7.7.2.3">𝑉</ci><apply id="A2.E56.m1.7.7.2.1.1.1.cmml" xref="A2.E56.m1.7.7.2.1.1"><csymbol cd="ambiguous" id="A2.E56.m1.7.7.2.1.1.1.1.cmml" xref="A2.E56.m1.7.7.2.1.1">subscript</csymbol><ci id="A2.E56.m1.7.7.2.1.1.1.2.cmml" xref="A2.E56.m1.7.7.2.1.1.1.2">𝑋</ci><ci id="A2.E56.m1.7.7.2.1.1.1.3.cmml" xref="A2.E56.m1.7.7.2.1.1.1.3">𝑅</ci></apply></apply></apply></apply><apply id="A2.E56.m1.9.9.cmml" xref="A2.E56.m1.9.9"><divide id="A2.E56.m1.9.9.3.cmml" xref="A2.E56.m1.9.9"></divide><apply id="A2.E56.m1.8.8.1.cmml" xref="A2.E56.m1.8.8.1"><times id="A2.E56.m1.8.8.1.2.cmml" xref="A2.E56.m1.8.8.1.2"></times><apply id="A2.E56.m1.8.8.1.3.cmml" xref="A2.E56.m1.8.8.1.3"><csymbol cd="ambiguous" id="A2.E56.m1.8.8.1.3.1.cmml" xref="A2.E56.m1.8.8.1.3">superscript</csymbol><ci id="A2.E56.m1.8.8.1.3.2.cmml" xref="A2.E56.m1.8.8.1.3.2">𝑃</ci><cn id="A2.E56.m1.8.8.1.3.3.cmml" type="integer" xref="A2.E56.m1.8.8.1.3.3">2</cn></apply><apply id="A2.E56.m1.8.8.1.1.1.1.cmml" xref="A2.E56.m1.8.8.1.1.1"><csymbol cd="ambiguous" id="A2.E56.m1.8.8.1.1.1.1.1.cmml" xref="A2.E56.m1.8.8.1.1.1">subscript</csymbol><ci id="A2.E56.m1.8.8.1.1.1.1.2.cmml" xref="A2.E56.m1.8.8.1.1.1.1.2">𝑋</ci><ci id="A2.E56.m1.8.8.1.1.1.1.3.cmml" xref="A2.E56.m1.8.8.1.1.1.1.3">𝑃</ci></apply></apply><apply id="A2.E56.m1.9.9.2.cmml" xref="A2.E56.m1.9.9.2"><times id="A2.E56.m1.9.9.2.2.cmml" xref="A2.E56.m1.9.9.2.2"></times><ci id="A2.E56.m1.9.9.2.3.cmml" xref="A2.E56.m1.9.9.2.3">𝑉</ci><apply id="A2.E56.m1.9.9.2.1.1.1.cmml" xref="A2.E56.m1.9.9.2.1.1"><csymbol cd="ambiguous" id="A2.E56.m1.9.9.2.1.1.1.1.cmml" xref="A2.E56.m1.9.9.2.1.1">subscript</csymbol><ci id="A2.E56.m1.9.9.2.1.1.1.2.cmml" xref="A2.E56.m1.9.9.2.1.1.1.2">𝑋</ci><ci id="A2.E56.m1.9.9.2.1.1.1.3.cmml" xref="A2.E56.m1.9.9.2.1.1.1.3">𝑃</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E56.m1.10c">\max_{X_{L},X_{R}\in\mathcal{P}\left(X_{P}\right)}\frac{P^{2}(X_{L})}{V(X_{L})%
}+\frac{P^{2}(X_{R})}{V(X_{R})}-\frac{P^{2}(X_{P})}{V(X_{P})}\,.</annotation><annotation encoding="application/x-llamapun" id="A2.E56.m1.10d">roman_max start_POSTSUBSCRIPT italic_X start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT , italic_X start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ∈ caligraphic_P ( italic_X start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT divide start_ARG italic_P start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ( italic_X start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT ) end_ARG start_ARG italic_V ( italic_X start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT ) end_ARG + divide start_ARG italic_P start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ( italic_X start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ) end_ARG start_ARG italic_V ( italic_X start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ) end_ARG - divide start_ARG italic_P start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ( italic_X start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT ) end_ARG start_ARG italic_V ( italic_X start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT ) end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(56)</span></td>
</tr></tbody>
</table>
</div>
<section class="ltx_subsection" id="A2.SSx1">
<h3 class="ltx_title ltx_title_subsection">Maximum Likelihood</h3>
<div class="ltx_para ltx_noindent" id="A2.SSx1.p1">
<p class="ltx_p" id="A2.SSx1.p1.3">To maximize the likelihood,</p>
<table class="ltx_equation ltx_eqn_table" id="A2.E57">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\max_{q}\mathbb{E}_{\mathbf{x}\sim p}\log q(\mathbf{x})\,," class="ltx_Math" display="block" id="A2.E57.m1.2"><semantics id="A2.E57.m1.2a"><mrow id="A2.E57.m1.2.2.1" xref="A2.E57.m1.2.2.1.1.cmml"><mrow id="A2.E57.m1.2.2.1.1" xref="A2.E57.m1.2.2.1.1.cmml"><mrow id="A2.E57.m1.2.2.1.1.2" xref="A2.E57.m1.2.2.1.1.2.cmml"><munder id="A2.E57.m1.2.2.1.1.2.1" xref="A2.E57.m1.2.2.1.1.2.1.cmml"><mi id="A2.E57.m1.2.2.1.1.2.1.2" xref="A2.E57.m1.2.2.1.1.2.1.2.cmml">max</mi><mi id="A2.E57.m1.2.2.1.1.2.1.3" xref="A2.E57.m1.2.2.1.1.2.1.3.cmml">q</mi></munder><mo id="A2.E57.m1.2.2.1.1.2a" lspace="0.167em" xref="A2.E57.m1.2.2.1.1.2.cmml">⁡</mo><mrow id="A2.E57.m1.2.2.1.1.2.2" xref="A2.E57.m1.2.2.1.1.2.2.cmml"><msub id="A2.E57.m1.2.2.1.1.2.2.2" xref="A2.E57.m1.2.2.1.1.2.2.2.cmml"><mi id="A2.E57.m1.2.2.1.1.2.2.2.2" xref="A2.E57.m1.2.2.1.1.2.2.2.2.cmml">𝔼</mi><mrow id="A2.E57.m1.2.2.1.1.2.2.2.3" xref="A2.E57.m1.2.2.1.1.2.2.2.3.cmml"><mi id="A2.E57.m1.2.2.1.1.2.2.2.3.2" xref="A2.E57.m1.2.2.1.1.2.2.2.3.2.cmml">𝐱</mi><mo id="A2.E57.m1.2.2.1.1.2.2.2.3.1" xref="A2.E57.m1.2.2.1.1.2.2.2.3.1.cmml">∼</mo><mi id="A2.E57.m1.2.2.1.1.2.2.2.3.3" xref="A2.E57.m1.2.2.1.1.2.2.2.3.3.cmml">p</mi></mrow></msub><mo id="A2.E57.m1.2.2.1.1.2.2.1" lspace="0.167em" xref="A2.E57.m1.2.2.1.1.2.2.1.cmml">⁢</mo><mrow id="A2.E57.m1.2.2.1.1.2.2.3" xref="A2.E57.m1.2.2.1.1.2.2.3.cmml"><mi id="A2.E57.m1.2.2.1.1.2.2.3.1" xref="A2.E57.m1.2.2.1.1.2.2.3.1.cmml">log</mi><mo id="A2.E57.m1.2.2.1.1.2.2.3a" lspace="0.167em" xref="A2.E57.m1.2.2.1.1.2.2.3.cmml">⁡</mo><mi id="A2.E57.m1.2.2.1.1.2.2.3.2" xref="A2.E57.m1.2.2.1.1.2.2.3.2.cmml">q</mi></mrow></mrow></mrow><mo id="A2.E57.m1.2.2.1.1.1" xref="A2.E57.m1.2.2.1.1.1.cmml">⁢</mo><mrow id="A2.E57.m1.2.2.1.1.3.2" xref="A2.E57.m1.2.2.1.1.cmml"><mo id="A2.E57.m1.2.2.1.1.3.2.1" stretchy="false" xref="A2.E57.m1.2.2.1.1.cmml">(</mo><mi id="A2.E57.m1.1.1" xref="A2.E57.m1.1.1.cmml">𝐱</mi><mo id="A2.E57.m1.2.2.1.1.3.2.2" rspace="0.170em" stretchy="false" xref="A2.E57.m1.2.2.1.1.cmml">)</mo></mrow></mrow><mo id="A2.E57.m1.2.2.1.2" xref="A2.E57.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.E57.m1.2b"><apply id="A2.E57.m1.2.2.1.1.cmml" xref="A2.E57.m1.2.2.1"><times id="A2.E57.m1.2.2.1.1.1.cmml" xref="A2.E57.m1.2.2.1.1.1"></times><apply id="A2.E57.m1.2.2.1.1.2.cmml" xref="A2.E57.m1.2.2.1.1.2"><apply id="A2.E57.m1.2.2.1.1.2.1.cmml" xref="A2.E57.m1.2.2.1.1.2.1"><csymbol cd="ambiguous" id="A2.E57.m1.2.2.1.1.2.1.1.cmml" xref="A2.E57.m1.2.2.1.1.2.1">subscript</csymbol><max id="A2.E57.m1.2.2.1.1.2.1.2.cmml" xref="A2.E57.m1.2.2.1.1.2.1.2"></max><ci id="A2.E57.m1.2.2.1.1.2.1.3.cmml" xref="A2.E57.m1.2.2.1.1.2.1.3">𝑞</ci></apply><apply id="A2.E57.m1.2.2.1.1.2.2.cmml" xref="A2.E57.m1.2.2.1.1.2.2"><times id="A2.E57.m1.2.2.1.1.2.2.1.cmml" xref="A2.E57.m1.2.2.1.1.2.2.1"></times><apply id="A2.E57.m1.2.2.1.1.2.2.2.cmml" xref="A2.E57.m1.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="A2.E57.m1.2.2.1.1.2.2.2.1.cmml" xref="A2.E57.m1.2.2.1.1.2.2.2">subscript</csymbol><ci id="A2.E57.m1.2.2.1.1.2.2.2.2.cmml" xref="A2.E57.m1.2.2.1.1.2.2.2.2">𝔼</ci><apply id="A2.E57.m1.2.2.1.1.2.2.2.3.cmml" xref="A2.E57.m1.2.2.1.1.2.2.2.3"><csymbol cd="latexml" id="A2.E57.m1.2.2.1.1.2.2.2.3.1.cmml" xref="A2.E57.m1.2.2.1.1.2.2.2.3.1">similar-to</csymbol><ci id="A2.E57.m1.2.2.1.1.2.2.2.3.2.cmml" xref="A2.E57.m1.2.2.1.1.2.2.2.3.2">𝐱</ci><ci id="A2.E57.m1.2.2.1.1.2.2.2.3.3.cmml" xref="A2.E57.m1.2.2.1.1.2.2.2.3.3">𝑝</ci></apply></apply><apply id="A2.E57.m1.2.2.1.1.2.2.3.cmml" xref="A2.E57.m1.2.2.1.1.2.2.3"><log id="A2.E57.m1.2.2.1.1.2.2.3.1.cmml" xref="A2.E57.m1.2.2.1.1.2.2.3.1"></log><ci id="A2.E57.m1.2.2.1.1.2.2.3.2.cmml" xref="A2.E57.m1.2.2.1.1.2.2.3.2">𝑞</ci></apply></apply></apply><ci id="A2.E57.m1.1.1.cmml" xref="A2.E57.m1.1.1">𝐱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E57.m1.2c">\max_{q}\mathbb{E}_{\mathbf{x}\sim p}\log q(\mathbf{x})\,,</annotation><annotation encoding="application/x-llamapun" id="A2.E57.m1.2d">roman_max start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT blackboard_E start_POSTSUBSCRIPT bold_x ∼ italic_p end_POSTSUBSCRIPT roman_log italic_q ( bold_x ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(57)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A2.SSx1.p1.4">rather than the ISE one can use the same approach. Here the optimization problem to solve is:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="A2.E58">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A2.E58X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\max_{v_{1},\ldots,v_{J},X_{1},\ldots,X_{J}}" class="ltx_Math" display="inline" id="A2.E58X.2.1.1.m1.6"><semantics id="A2.E58X.2.1.1.m1.6a"><munder id="A2.E58X.2.1.1.m1.6.7" xref="A2.E58X.2.1.1.m1.6.7.cmml"><mi id="A2.E58X.2.1.1.m1.6.7.2" xref="A2.E58X.2.1.1.m1.6.7.2.cmml">max</mi><mrow id="A2.E58X.2.1.1.m1.6.6.6.6" xref="A2.E58X.2.1.1.m1.6.6.6.7.cmml"><msub id="A2.E58X.2.1.1.m1.3.3.3.3.1" xref="A2.E58X.2.1.1.m1.3.3.3.3.1.cmml"><mi id="A2.E58X.2.1.1.m1.3.3.3.3.1.2" xref="A2.E58X.2.1.1.m1.3.3.3.3.1.2.cmml">v</mi><mn id="A2.E58X.2.1.1.m1.3.3.3.3.1.3" xref="A2.E58X.2.1.1.m1.3.3.3.3.1.3.cmml">1</mn></msub><mo id="A2.E58X.2.1.1.m1.6.6.6.6.5" xref="A2.E58X.2.1.1.m1.6.6.6.7.cmml">,</mo><mi id="A2.E58X.2.1.1.m1.1.1.1.1" mathvariant="normal" xref="A2.E58X.2.1.1.m1.1.1.1.1.cmml">…</mi><mo id="A2.E58X.2.1.1.m1.6.6.6.6.6" xref="A2.E58X.2.1.1.m1.6.6.6.7.cmml">,</mo><msub id="A2.E58X.2.1.1.m1.4.4.4.4.2" xref="A2.E58X.2.1.1.m1.4.4.4.4.2.cmml"><mi id="A2.E58X.2.1.1.m1.4.4.4.4.2.2" xref="A2.E58X.2.1.1.m1.4.4.4.4.2.2.cmml">v</mi><mi id="A2.E58X.2.1.1.m1.4.4.4.4.2.3" xref="A2.E58X.2.1.1.m1.4.4.4.4.2.3.cmml">J</mi></msub><mo id="A2.E58X.2.1.1.m1.6.6.6.6.7" xref="A2.E58X.2.1.1.m1.6.6.6.7.cmml">,</mo><msub id="A2.E58X.2.1.1.m1.5.5.5.5.3" xref="A2.E58X.2.1.1.m1.5.5.5.5.3.cmml"><mi id="A2.E58X.2.1.1.m1.5.5.5.5.3.2" xref="A2.E58X.2.1.1.m1.5.5.5.5.3.2.cmml">X</mi><mn id="A2.E58X.2.1.1.m1.5.5.5.5.3.3" xref="A2.E58X.2.1.1.m1.5.5.5.5.3.3.cmml">1</mn></msub><mo id="A2.E58X.2.1.1.m1.6.6.6.6.8" xref="A2.E58X.2.1.1.m1.6.6.6.7.cmml">,</mo><mi id="A2.E58X.2.1.1.m1.2.2.2.2" mathvariant="normal" xref="A2.E58X.2.1.1.m1.2.2.2.2.cmml">…</mi><mo id="A2.E58X.2.1.1.m1.6.6.6.6.9" xref="A2.E58X.2.1.1.m1.6.6.6.7.cmml">,</mo><msub id="A2.E58X.2.1.1.m1.6.6.6.6.4" xref="A2.E58X.2.1.1.m1.6.6.6.6.4.cmml"><mi id="A2.E58X.2.1.1.m1.6.6.6.6.4.2" xref="A2.E58X.2.1.1.m1.6.6.6.6.4.2.cmml">X</mi><mi id="A2.E58X.2.1.1.m1.6.6.6.6.4.3" xref="A2.E58X.2.1.1.m1.6.6.6.6.4.3.cmml">J</mi></msub></mrow></munder><annotation-xml encoding="MathML-Content" id="A2.E58X.2.1.1.m1.6b"><apply id="A2.E58X.2.1.1.m1.6.7.cmml" xref="A2.E58X.2.1.1.m1.6.7"><csymbol cd="ambiguous" id="A2.E58X.2.1.1.m1.6.7.1.cmml" xref="A2.E58X.2.1.1.m1.6.7">subscript</csymbol><max id="A2.E58X.2.1.1.m1.6.7.2.cmml" xref="A2.E58X.2.1.1.m1.6.7.2"></max><list id="A2.E58X.2.1.1.m1.6.6.6.7.cmml" xref="A2.E58X.2.1.1.m1.6.6.6.6"><apply id="A2.E58X.2.1.1.m1.3.3.3.3.1.cmml" xref="A2.E58X.2.1.1.m1.3.3.3.3.1"><csymbol cd="ambiguous" id="A2.E58X.2.1.1.m1.3.3.3.3.1.1.cmml" xref="A2.E58X.2.1.1.m1.3.3.3.3.1">subscript</csymbol><ci id="A2.E58X.2.1.1.m1.3.3.3.3.1.2.cmml" xref="A2.E58X.2.1.1.m1.3.3.3.3.1.2">𝑣</ci><cn id="A2.E58X.2.1.1.m1.3.3.3.3.1.3.cmml" type="integer" xref="A2.E58X.2.1.1.m1.3.3.3.3.1.3">1</cn></apply><ci id="A2.E58X.2.1.1.m1.1.1.1.1.cmml" xref="A2.E58X.2.1.1.m1.1.1.1.1">…</ci><apply id="A2.E58X.2.1.1.m1.4.4.4.4.2.cmml" xref="A2.E58X.2.1.1.m1.4.4.4.4.2"><csymbol cd="ambiguous" id="A2.E58X.2.1.1.m1.4.4.4.4.2.1.cmml" xref="A2.E58X.2.1.1.m1.4.4.4.4.2">subscript</csymbol><ci id="A2.E58X.2.1.1.m1.4.4.4.4.2.2.cmml" xref="A2.E58X.2.1.1.m1.4.4.4.4.2.2">𝑣</ci><ci id="A2.E58X.2.1.1.m1.4.4.4.4.2.3.cmml" xref="A2.E58X.2.1.1.m1.4.4.4.4.2.3">𝐽</ci></apply><apply id="A2.E58X.2.1.1.m1.5.5.5.5.3.cmml" xref="A2.E58X.2.1.1.m1.5.5.5.5.3"><csymbol cd="ambiguous" id="A2.E58X.2.1.1.m1.5.5.5.5.3.1.cmml" xref="A2.E58X.2.1.1.m1.5.5.5.5.3">subscript</csymbol><ci id="A2.E58X.2.1.1.m1.5.5.5.5.3.2.cmml" xref="A2.E58X.2.1.1.m1.5.5.5.5.3.2">𝑋</ci><cn id="A2.E58X.2.1.1.m1.5.5.5.5.3.3.cmml" type="integer" xref="A2.E58X.2.1.1.m1.5.5.5.5.3.3">1</cn></apply><ci id="A2.E58X.2.1.1.m1.2.2.2.2.cmml" xref="A2.E58X.2.1.1.m1.2.2.2.2">…</ci><apply id="A2.E58X.2.1.1.m1.6.6.6.6.4.cmml" xref="A2.E58X.2.1.1.m1.6.6.6.6.4"><csymbol cd="ambiguous" id="A2.E58X.2.1.1.m1.6.6.6.6.4.1.cmml" xref="A2.E58X.2.1.1.m1.6.6.6.6.4">subscript</csymbol><ci id="A2.E58X.2.1.1.m1.6.6.6.6.4.2.cmml" xref="A2.E58X.2.1.1.m1.6.6.6.6.4.2">𝑋</ci><ci id="A2.E58X.2.1.1.m1.6.6.6.6.4.3.cmml" xref="A2.E58X.2.1.1.m1.6.6.6.6.4.3">𝐽</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E58X.2.1.1.m1.6c">\displaystyle\max_{v_{1},\ldots,v_{J},X_{1},\ldots,X_{J}}</annotation><annotation encoding="application/x-llamapun" id="A2.E58X.2.1.1.m1.6d">roman_max start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_v start_POSTSUBSCRIPT italic_J end_POSTSUBSCRIPT , italic_X start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_X start_POSTSUBSCRIPT italic_J end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\sum_{j=1}^{J}P(X_{j})\log v_{j}" class="ltx_Math" display="inline" id="A2.E58X.3.2.2.m1.1"><semantics id="A2.E58X.3.2.2.m1.1a"><mrow id="A2.E58X.3.2.2.m1.1.1" xref="A2.E58X.3.2.2.m1.1.1.cmml"><mstyle displaystyle="true" id="A2.E58X.3.2.2.m1.1.1.2" xref="A2.E58X.3.2.2.m1.1.1.2.cmml"><munderover id="A2.E58X.3.2.2.m1.1.1.2a" xref="A2.E58X.3.2.2.m1.1.1.2.cmml"><mo id="A2.E58X.3.2.2.m1.1.1.2.2.2" movablelimits="false" xref="A2.E58X.3.2.2.m1.1.1.2.2.2.cmml">∑</mo><mrow id="A2.E58X.3.2.2.m1.1.1.2.2.3" xref="A2.E58X.3.2.2.m1.1.1.2.2.3.cmml"><mi id="A2.E58X.3.2.2.m1.1.1.2.2.3.2" xref="A2.E58X.3.2.2.m1.1.1.2.2.3.2.cmml">j</mi><mo id="A2.E58X.3.2.2.m1.1.1.2.2.3.1" xref="A2.E58X.3.2.2.m1.1.1.2.2.3.1.cmml">=</mo><mn id="A2.E58X.3.2.2.m1.1.1.2.2.3.3" xref="A2.E58X.3.2.2.m1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="A2.E58X.3.2.2.m1.1.1.2.3" xref="A2.E58X.3.2.2.m1.1.1.2.3.cmml">J</mi></munderover></mstyle><mrow id="A2.E58X.3.2.2.m1.1.1.1" xref="A2.E58X.3.2.2.m1.1.1.1.cmml"><mi id="A2.E58X.3.2.2.m1.1.1.1.3" xref="A2.E58X.3.2.2.m1.1.1.1.3.cmml">P</mi><mo id="A2.E58X.3.2.2.m1.1.1.1.2" xref="A2.E58X.3.2.2.m1.1.1.1.2.cmml">⁢</mo><mrow id="A2.E58X.3.2.2.m1.1.1.1.1.1" xref="A2.E58X.3.2.2.m1.1.1.1.1.1.1.cmml"><mo id="A2.E58X.3.2.2.m1.1.1.1.1.1.2" stretchy="false" xref="A2.E58X.3.2.2.m1.1.1.1.1.1.1.cmml">(</mo><msub id="A2.E58X.3.2.2.m1.1.1.1.1.1.1" xref="A2.E58X.3.2.2.m1.1.1.1.1.1.1.cmml"><mi id="A2.E58X.3.2.2.m1.1.1.1.1.1.1.2" xref="A2.E58X.3.2.2.m1.1.1.1.1.1.1.2.cmml">X</mi><mi id="A2.E58X.3.2.2.m1.1.1.1.1.1.1.3" xref="A2.E58X.3.2.2.m1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="A2.E58X.3.2.2.m1.1.1.1.1.1.3" stretchy="false" xref="A2.E58X.3.2.2.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A2.E58X.3.2.2.m1.1.1.1.2a" lspace="0.167em" xref="A2.E58X.3.2.2.m1.1.1.1.2.cmml">⁢</mo><mrow id="A2.E58X.3.2.2.m1.1.1.1.4" xref="A2.E58X.3.2.2.m1.1.1.1.4.cmml"><mi id="A2.E58X.3.2.2.m1.1.1.1.4.1" xref="A2.E58X.3.2.2.m1.1.1.1.4.1.cmml">log</mi><mo id="A2.E58X.3.2.2.m1.1.1.1.4a" lspace="0.167em" xref="A2.E58X.3.2.2.m1.1.1.1.4.cmml">⁡</mo><msub id="A2.E58X.3.2.2.m1.1.1.1.4.2" xref="A2.E58X.3.2.2.m1.1.1.1.4.2.cmml"><mi id="A2.E58X.3.2.2.m1.1.1.1.4.2.2" xref="A2.E58X.3.2.2.m1.1.1.1.4.2.2.cmml">v</mi><mi id="A2.E58X.3.2.2.m1.1.1.1.4.2.3" xref="A2.E58X.3.2.2.m1.1.1.1.4.2.3.cmml">j</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E58X.3.2.2.m1.1b"><apply id="A2.E58X.3.2.2.m1.1.1.cmml" xref="A2.E58X.3.2.2.m1.1.1"><apply id="A2.E58X.3.2.2.m1.1.1.2.cmml" xref="A2.E58X.3.2.2.m1.1.1.2"><csymbol cd="ambiguous" id="A2.E58X.3.2.2.m1.1.1.2.1.cmml" xref="A2.E58X.3.2.2.m1.1.1.2">superscript</csymbol><apply id="A2.E58X.3.2.2.m1.1.1.2.2.cmml" xref="A2.E58X.3.2.2.m1.1.1.2"><csymbol cd="ambiguous" id="A2.E58X.3.2.2.m1.1.1.2.2.1.cmml" xref="A2.E58X.3.2.2.m1.1.1.2">subscript</csymbol><sum id="A2.E58X.3.2.2.m1.1.1.2.2.2.cmml" xref="A2.E58X.3.2.2.m1.1.1.2.2.2"></sum><apply id="A2.E58X.3.2.2.m1.1.1.2.2.3.cmml" xref="A2.E58X.3.2.2.m1.1.1.2.2.3"><eq id="A2.E58X.3.2.2.m1.1.1.2.2.3.1.cmml" xref="A2.E58X.3.2.2.m1.1.1.2.2.3.1"></eq><ci id="A2.E58X.3.2.2.m1.1.1.2.2.3.2.cmml" xref="A2.E58X.3.2.2.m1.1.1.2.2.3.2">𝑗</ci><cn id="A2.E58X.3.2.2.m1.1.1.2.2.3.3.cmml" type="integer" xref="A2.E58X.3.2.2.m1.1.1.2.2.3.3">1</cn></apply></apply><ci id="A2.E58X.3.2.2.m1.1.1.2.3.cmml" xref="A2.E58X.3.2.2.m1.1.1.2.3">𝐽</ci></apply><apply id="A2.E58X.3.2.2.m1.1.1.1.cmml" xref="A2.E58X.3.2.2.m1.1.1.1"><times id="A2.E58X.3.2.2.m1.1.1.1.2.cmml" xref="A2.E58X.3.2.2.m1.1.1.1.2"></times><ci id="A2.E58X.3.2.2.m1.1.1.1.3.cmml" xref="A2.E58X.3.2.2.m1.1.1.1.3">𝑃</ci><apply id="A2.E58X.3.2.2.m1.1.1.1.1.1.1.cmml" xref="A2.E58X.3.2.2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E58X.3.2.2.m1.1.1.1.1.1.1.1.cmml" xref="A2.E58X.3.2.2.m1.1.1.1.1.1">subscript</csymbol><ci id="A2.E58X.3.2.2.m1.1.1.1.1.1.1.2.cmml" xref="A2.E58X.3.2.2.m1.1.1.1.1.1.1.2">𝑋</ci><ci id="A2.E58X.3.2.2.m1.1.1.1.1.1.1.3.cmml" xref="A2.E58X.3.2.2.m1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="A2.E58X.3.2.2.m1.1.1.1.4.cmml" xref="A2.E58X.3.2.2.m1.1.1.1.4"><log id="A2.E58X.3.2.2.m1.1.1.1.4.1.cmml" xref="A2.E58X.3.2.2.m1.1.1.1.4.1"></log><apply id="A2.E58X.3.2.2.m1.1.1.1.4.2.cmml" xref="A2.E58X.3.2.2.m1.1.1.1.4.2"><csymbol cd="ambiguous" id="A2.E58X.3.2.2.m1.1.1.1.4.2.1.cmml" xref="A2.E58X.3.2.2.m1.1.1.1.4.2">subscript</csymbol><ci id="A2.E58X.3.2.2.m1.1.1.1.4.2.2.cmml" xref="A2.E58X.3.2.2.m1.1.1.1.4.2.2">𝑣</ci><ci id="A2.E58X.3.2.2.m1.1.1.1.4.2.3.cmml" xref="A2.E58X.3.2.2.m1.1.1.1.4.2.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E58X.3.2.2.m1.1c">\displaystyle\sum_{j=1}^{J}P(X_{j})\log v_{j}</annotation><annotation encoding="application/x-llamapun" id="A2.E58X.3.2.2.m1.1d">∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_J end_POSTSUPERSCRIPT italic_P ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) roman_log italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(58)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A2.E58Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span class="ltx_text ltx_markedasmath ltx_font_italic" id="A2.E58Xa.2.1.1.1">s.t.</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\sum_{j=1}^{J}v_{j}V(X_{j})=1\,." class="ltx_Math" display="inline" id="A2.E58Xa.3.2.2.m1.1"><semantics id="A2.E58Xa.3.2.2.m1.1a"><mrow id="A2.E58Xa.3.2.2.m1.1.1.1" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.cmml"><mrow id="A2.E58Xa.3.2.2.m1.1.1.1.1" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.cmml"><mrow id="A2.E58Xa.3.2.2.m1.1.1.1.1.1" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A2.E58Xa.3.2.2.m1.1.1.1.1.1.2" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.1.2.cmml"><munderover id="A2.E58Xa.3.2.2.m1.1.1.1.1.1.2a" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.1.2.cmml"><mo id="A2.E58Xa.3.2.2.m1.1.1.1.1.1.2.2.2" movablelimits="false" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="A2.E58Xa.3.2.2.m1.1.1.1.1.1.2.2.3" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.1.2.2.3.cmml"><mi id="A2.E58Xa.3.2.2.m1.1.1.1.1.1.2.2.3.2" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.1.2.2.3.2.cmml">j</mi><mo id="A2.E58Xa.3.2.2.m1.1.1.1.1.1.2.2.3.1" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="A2.E58Xa.3.2.2.m1.1.1.1.1.1.2.2.3.3" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="A2.E58Xa.3.2.2.m1.1.1.1.1.1.2.3" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.1.2.3.cmml">J</mi></munderover></mstyle><mrow id="A2.E58Xa.3.2.2.m1.1.1.1.1.1.1" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.1.1.cmml"><msub id="A2.E58Xa.3.2.2.m1.1.1.1.1.1.1.3" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.1.1.3.cmml"><mi id="A2.E58Xa.3.2.2.m1.1.1.1.1.1.1.3.2" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.1.1.3.2.cmml">v</mi><mi id="A2.E58Xa.3.2.2.m1.1.1.1.1.1.1.3.3" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.1.1.3.3.cmml">j</mi></msub><mo id="A2.E58Xa.3.2.2.m1.1.1.1.1.1.1.2" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="A2.E58Xa.3.2.2.m1.1.1.1.1.1.1.4" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.1.1.4.cmml">V</mi><mo id="A2.E58Xa.3.2.2.m1.1.1.1.1.1.1.2a" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A2.E58Xa.3.2.2.m1.1.1.1.1.1.1.1.1" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A2.E58Xa.3.2.2.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A2.E58Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A2.E58Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.cmml">X</mi><mi id="A2.E58Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="A2.E58Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A2.E58Xa.3.2.2.m1.1.1.1.1.2" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.2.cmml">=</mo><mn id="A2.E58Xa.3.2.2.m1.1.1.1.1.3" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.3.cmml">1</mn></mrow><mo id="A2.E58Xa.3.2.2.m1.1.1.1.2" lspace="0.170em" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.E58Xa.3.2.2.m1.1b"><apply id="A2.E58Xa.3.2.2.m1.1.1.1.1.cmml" xref="A2.E58Xa.3.2.2.m1.1.1.1"><eq id="A2.E58Xa.3.2.2.m1.1.1.1.1.2.cmml" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.2"></eq><apply id="A2.E58Xa.3.2.2.m1.1.1.1.1.1.cmml" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.1"><apply id="A2.E58Xa.3.2.2.m1.1.1.1.1.1.2.cmml" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A2.E58Xa.3.2.2.m1.1.1.1.1.1.2.1.cmml" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.1.2">superscript</csymbol><apply id="A2.E58Xa.3.2.2.m1.1.1.1.1.1.2.2.cmml" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A2.E58Xa.3.2.2.m1.1.1.1.1.1.2.2.1.cmml" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.1.2">subscript</csymbol><sum id="A2.E58Xa.3.2.2.m1.1.1.1.1.1.2.2.2.cmml" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.1.2.2.2"></sum><apply id="A2.E58Xa.3.2.2.m1.1.1.1.1.1.2.2.3.cmml" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.1.2.2.3"><eq id="A2.E58Xa.3.2.2.m1.1.1.1.1.1.2.2.3.1.cmml" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.1.2.2.3.1"></eq><ci id="A2.E58Xa.3.2.2.m1.1.1.1.1.1.2.2.3.2.cmml" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.1.2.2.3.2">𝑗</ci><cn id="A2.E58Xa.3.2.2.m1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="A2.E58Xa.3.2.2.m1.1.1.1.1.1.2.3.cmml" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.1.2.3">𝐽</ci></apply><apply id="A2.E58Xa.3.2.2.m1.1.1.1.1.1.1.cmml" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.1.1"><times id="A2.E58Xa.3.2.2.m1.1.1.1.1.1.1.2.cmml" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.1.1.2"></times><apply id="A2.E58Xa.3.2.2.m1.1.1.1.1.1.1.3.cmml" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.E58Xa.3.2.2.m1.1.1.1.1.1.1.3.1.cmml" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A2.E58Xa.3.2.2.m1.1.1.1.1.1.1.3.2.cmml" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.1.1.3.2">𝑣</ci><ci id="A2.E58Xa.3.2.2.m1.1.1.1.1.1.1.3.3.cmml" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.1.1.3.3">𝑗</ci></apply><ci id="A2.E58Xa.3.2.2.m1.1.1.1.1.1.1.4.cmml" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.1.1.4">𝑉</ci><apply id="A2.E58Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E58Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A2.E58Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2">𝑋</ci><ci id="A2.E58Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3">𝑗</ci></apply></apply></apply><cn id="A2.E58Xa.3.2.2.m1.1.1.1.1.3.cmml" type="integer" xref="A2.E58Xa.3.2.2.m1.1.1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E58Xa.3.2.2.m1.1c">\displaystyle\sum_{j=1}^{J}v_{j}V(X_{j})=1\,.</annotation><annotation encoding="application/x-llamapun" id="A2.E58Xa.3.2.2.m1.1d">∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_J end_POSTSUPERSCRIPT italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_V ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) = 1 .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="A2.SSx1.p1.2">This is, again, easy to solve for <math alttext="v_{j}" class="ltx_Math" display="inline" id="A2.SSx1.p1.1.m1.1"><semantics id="A2.SSx1.p1.1.m1.1a"><msub id="A2.SSx1.p1.1.m1.1.1" xref="A2.SSx1.p1.1.m1.1.1.cmml"><mi id="A2.SSx1.p1.1.m1.1.1.2" xref="A2.SSx1.p1.1.m1.1.1.2.cmml">v</mi><mi id="A2.SSx1.p1.1.m1.1.1.3" xref="A2.SSx1.p1.1.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A2.SSx1.p1.1.m1.1b"><apply id="A2.SSx1.p1.1.m1.1.1.cmml" xref="A2.SSx1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A2.SSx1.p1.1.m1.1.1.1.cmml" xref="A2.SSx1.p1.1.m1.1.1">subscript</csymbol><ci id="A2.SSx1.p1.1.m1.1.1.2.cmml" xref="A2.SSx1.p1.1.m1.1.1.2">𝑣</ci><ci id="A2.SSx1.p1.1.m1.1.1.3.cmml" xref="A2.SSx1.p1.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SSx1.p1.1.m1.1c">v_{j}</annotation><annotation encoding="application/x-llamapun" id="A2.SSx1.p1.1.m1.1d">italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> since it is separable over <math alttext="j" class="ltx_Math" display="inline" id="A2.SSx1.p1.2.m2.1"><semantics id="A2.SSx1.p1.2.m2.1a"><mi id="A2.SSx1.p1.2.m2.1.1" xref="A2.SSx1.p1.2.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="A2.SSx1.p1.2.m2.1b"><ci id="A2.SSx1.p1.2.m2.1.1.cmml" xref="A2.SSx1.p1.2.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SSx1.p1.2.m2.1c">j</annotation><annotation encoding="application/x-llamapun" id="A2.SSx1.p1.2.m2.1d">italic_j</annotation></semantics></math> after removing the constraint using Lagrange multipliers. The optimal leaf values and objective are in this case:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A5.EGx16">
<tbody id="A2.E59"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle v_{j}^{*}=\frac{P(X_{j})}{V(X_{j})}\,," class="ltx_Math" display="inline" id="A2.E59.m1.3"><semantics id="A2.E59.m1.3a"><mrow id="A2.E59.m1.3.3.1" xref="A2.E59.m1.3.3.1.1.cmml"><mrow id="A2.E59.m1.3.3.1.1" xref="A2.E59.m1.3.3.1.1.cmml"><msubsup id="A2.E59.m1.3.3.1.1.2" xref="A2.E59.m1.3.3.1.1.2.cmml"><mi id="A2.E59.m1.3.3.1.1.2.2.2" xref="A2.E59.m1.3.3.1.1.2.2.2.cmml">v</mi><mi id="A2.E59.m1.3.3.1.1.2.2.3" xref="A2.E59.m1.3.3.1.1.2.2.3.cmml">j</mi><mo id="A2.E59.m1.3.3.1.1.2.3" xref="A2.E59.m1.3.3.1.1.2.3.cmml">∗</mo></msubsup><mo id="A2.E59.m1.3.3.1.1.1" xref="A2.E59.m1.3.3.1.1.1.cmml">=</mo><mstyle displaystyle="true" id="A2.E59.m1.2.2" xref="A2.E59.m1.2.2.cmml"><mfrac id="A2.E59.m1.2.2a" xref="A2.E59.m1.2.2.cmml"><mrow id="A2.E59.m1.1.1.1" xref="A2.E59.m1.1.1.1.cmml"><mi id="A2.E59.m1.1.1.1.3" xref="A2.E59.m1.1.1.1.3.cmml">P</mi><mo id="A2.E59.m1.1.1.1.2" xref="A2.E59.m1.1.1.1.2.cmml">⁢</mo><mrow id="A2.E59.m1.1.1.1.1.1" xref="A2.E59.m1.1.1.1.1.1.1.cmml"><mo id="A2.E59.m1.1.1.1.1.1.2" stretchy="false" xref="A2.E59.m1.1.1.1.1.1.1.cmml">(</mo><msub id="A2.E59.m1.1.1.1.1.1.1" xref="A2.E59.m1.1.1.1.1.1.1.cmml"><mi id="A2.E59.m1.1.1.1.1.1.1.2" xref="A2.E59.m1.1.1.1.1.1.1.2.cmml">X</mi><mi id="A2.E59.m1.1.1.1.1.1.1.3" xref="A2.E59.m1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="A2.E59.m1.1.1.1.1.1.3" stretchy="false" xref="A2.E59.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A2.E59.m1.2.2.2" xref="A2.E59.m1.2.2.2.cmml"><mi id="A2.E59.m1.2.2.2.3" xref="A2.E59.m1.2.2.2.3.cmml">V</mi><mo id="A2.E59.m1.2.2.2.2" xref="A2.E59.m1.2.2.2.2.cmml">⁢</mo><mrow id="A2.E59.m1.2.2.2.1.1" xref="A2.E59.m1.2.2.2.1.1.1.cmml"><mo id="A2.E59.m1.2.2.2.1.1.2" stretchy="false" xref="A2.E59.m1.2.2.2.1.1.1.cmml">(</mo><msub id="A2.E59.m1.2.2.2.1.1.1" xref="A2.E59.m1.2.2.2.1.1.1.cmml"><mi id="A2.E59.m1.2.2.2.1.1.1.2" xref="A2.E59.m1.2.2.2.1.1.1.2.cmml">X</mi><mi id="A2.E59.m1.2.2.2.1.1.1.3" xref="A2.E59.m1.2.2.2.1.1.1.3.cmml">j</mi></msub><mo id="A2.E59.m1.2.2.2.1.1.3" stretchy="false" xref="A2.E59.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mstyle></mrow><mo id="A2.E59.m1.3.3.1.2" lspace="0.170em" xref="A2.E59.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.E59.m1.3b"><apply id="A2.E59.m1.3.3.1.1.cmml" xref="A2.E59.m1.3.3.1"><eq id="A2.E59.m1.3.3.1.1.1.cmml" xref="A2.E59.m1.3.3.1.1.1"></eq><apply id="A2.E59.m1.3.3.1.1.2.cmml" xref="A2.E59.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="A2.E59.m1.3.3.1.1.2.1.cmml" xref="A2.E59.m1.3.3.1.1.2">superscript</csymbol><apply id="A2.E59.m1.3.3.1.1.2.2.cmml" xref="A2.E59.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="A2.E59.m1.3.3.1.1.2.2.1.cmml" xref="A2.E59.m1.3.3.1.1.2">subscript</csymbol><ci id="A2.E59.m1.3.3.1.1.2.2.2.cmml" xref="A2.E59.m1.3.3.1.1.2.2.2">𝑣</ci><ci id="A2.E59.m1.3.3.1.1.2.2.3.cmml" xref="A2.E59.m1.3.3.1.1.2.2.3">𝑗</ci></apply><times id="A2.E59.m1.3.3.1.1.2.3.cmml" xref="A2.E59.m1.3.3.1.1.2.3"></times></apply><apply id="A2.E59.m1.2.2.cmml" xref="A2.E59.m1.2.2"><divide id="A2.E59.m1.2.2.3.cmml" xref="A2.E59.m1.2.2"></divide><apply id="A2.E59.m1.1.1.1.cmml" xref="A2.E59.m1.1.1.1"><times id="A2.E59.m1.1.1.1.2.cmml" xref="A2.E59.m1.1.1.1.2"></times><ci id="A2.E59.m1.1.1.1.3.cmml" xref="A2.E59.m1.1.1.1.3">𝑃</ci><apply id="A2.E59.m1.1.1.1.1.1.1.cmml" xref="A2.E59.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E59.m1.1.1.1.1.1.1.1.cmml" xref="A2.E59.m1.1.1.1.1.1">subscript</csymbol><ci id="A2.E59.m1.1.1.1.1.1.1.2.cmml" xref="A2.E59.m1.1.1.1.1.1.1.2">𝑋</ci><ci id="A2.E59.m1.1.1.1.1.1.1.3.cmml" xref="A2.E59.m1.1.1.1.1.1.1.3">𝑗</ci></apply></apply><apply id="A2.E59.m1.2.2.2.cmml" xref="A2.E59.m1.2.2.2"><times id="A2.E59.m1.2.2.2.2.cmml" xref="A2.E59.m1.2.2.2.2"></times><ci id="A2.E59.m1.2.2.2.3.cmml" xref="A2.E59.m1.2.2.2.3">𝑉</ci><apply id="A2.E59.m1.2.2.2.1.1.1.cmml" xref="A2.E59.m1.2.2.2.1.1"><csymbol cd="ambiguous" id="A2.E59.m1.2.2.2.1.1.1.1.cmml" xref="A2.E59.m1.2.2.2.1.1">subscript</csymbol><ci id="A2.E59.m1.2.2.2.1.1.1.2.cmml" xref="A2.E59.m1.2.2.2.1.1.1.2">𝑋</ci><ci id="A2.E59.m1.2.2.2.1.1.1.3.cmml" xref="A2.E59.m1.2.2.2.1.1.1.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E59.m1.3c">\displaystyle v_{j}^{*}=\frac{P(X_{j})}{V(X_{j})}\,,</annotation><annotation encoding="application/x-llamapun" id="A2.E59.m1.3d">italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = divide start_ARG italic_P ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG start_ARG italic_V ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG ,</annotation></semantics></math></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle L^{*}\left(X_{1},\ldots,X_{J}\right)=\sum_{j=1}^{J}P(X_{j})\log%
\frac{P(X_{j})}{V_{f}(X_{j})}\,." class="ltx_Math" display="inline" id="A2.E59.m2.4"><semantics id="A2.E59.m2.4a"><mrow id="A2.E59.m2.4.4.1" xref="A2.E59.m2.4.4.1.1.cmml"><mrow id="A2.E59.m2.4.4.1.1" xref="A2.E59.m2.4.4.1.1.cmml"><mrow id="A2.E59.m2.4.4.1.1.2" xref="A2.E59.m2.4.4.1.1.2.cmml"><msup id="A2.E59.m2.4.4.1.1.2.4" xref="A2.E59.m2.4.4.1.1.2.4.cmml"><mi id="A2.E59.m2.4.4.1.1.2.4.2" xref="A2.E59.m2.4.4.1.1.2.4.2.cmml">L</mi><mo id="A2.E59.m2.4.4.1.1.2.4.3" xref="A2.E59.m2.4.4.1.1.2.4.3.cmml">∗</mo></msup><mo id="A2.E59.m2.4.4.1.1.2.3" xref="A2.E59.m2.4.4.1.1.2.3.cmml">⁢</mo><mrow id="A2.E59.m2.4.4.1.1.2.2.2" xref="A2.E59.m2.4.4.1.1.2.2.3.cmml"><mo id="A2.E59.m2.4.4.1.1.2.2.2.3" xref="A2.E59.m2.4.4.1.1.2.2.3.cmml">(</mo><msub id="A2.E59.m2.4.4.1.1.1.1.1.1" xref="A2.E59.m2.4.4.1.1.1.1.1.1.cmml"><mi id="A2.E59.m2.4.4.1.1.1.1.1.1.2" xref="A2.E59.m2.4.4.1.1.1.1.1.1.2.cmml">X</mi><mn id="A2.E59.m2.4.4.1.1.1.1.1.1.3" xref="A2.E59.m2.4.4.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="A2.E59.m2.4.4.1.1.2.2.2.4" xref="A2.E59.m2.4.4.1.1.2.2.3.cmml">,</mo><mi id="A2.E59.m2.3.3" mathvariant="normal" xref="A2.E59.m2.3.3.cmml">…</mi><mo id="A2.E59.m2.4.4.1.1.2.2.2.5" xref="A2.E59.m2.4.4.1.1.2.2.3.cmml">,</mo><msub id="A2.E59.m2.4.4.1.1.2.2.2.2" xref="A2.E59.m2.4.4.1.1.2.2.2.2.cmml"><mi id="A2.E59.m2.4.4.1.1.2.2.2.2.2" xref="A2.E59.m2.4.4.1.1.2.2.2.2.2.cmml">X</mi><mi id="A2.E59.m2.4.4.1.1.2.2.2.2.3" xref="A2.E59.m2.4.4.1.1.2.2.2.2.3.cmml">J</mi></msub><mo id="A2.E59.m2.4.4.1.1.2.2.2.6" xref="A2.E59.m2.4.4.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="A2.E59.m2.4.4.1.1.4" xref="A2.E59.m2.4.4.1.1.4.cmml">=</mo><mrow id="A2.E59.m2.4.4.1.1.3" xref="A2.E59.m2.4.4.1.1.3.cmml"><mstyle displaystyle="true" id="A2.E59.m2.4.4.1.1.3.2" xref="A2.E59.m2.4.4.1.1.3.2.cmml"><munderover id="A2.E59.m2.4.4.1.1.3.2a" xref="A2.E59.m2.4.4.1.1.3.2.cmml"><mo id="A2.E59.m2.4.4.1.1.3.2.2.2" movablelimits="false" xref="A2.E59.m2.4.4.1.1.3.2.2.2.cmml">∑</mo><mrow id="A2.E59.m2.4.4.1.1.3.2.2.3" xref="A2.E59.m2.4.4.1.1.3.2.2.3.cmml"><mi id="A2.E59.m2.4.4.1.1.3.2.2.3.2" xref="A2.E59.m2.4.4.1.1.3.2.2.3.2.cmml">j</mi><mo id="A2.E59.m2.4.4.1.1.3.2.2.3.1" xref="A2.E59.m2.4.4.1.1.3.2.2.3.1.cmml">=</mo><mn id="A2.E59.m2.4.4.1.1.3.2.2.3.3" xref="A2.E59.m2.4.4.1.1.3.2.2.3.3.cmml">1</mn></mrow><mi id="A2.E59.m2.4.4.1.1.3.2.3" xref="A2.E59.m2.4.4.1.1.3.2.3.cmml">J</mi></munderover></mstyle><mrow id="A2.E59.m2.4.4.1.1.3.1" xref="A2.E59.m2.4.4.1.1.3.1.cmml"><mi id="A2.E59.m2.4.4.1.1.3.1.3" xref="A2.E59.m2.4.4.1.1.3.1.3.cmml">P</mi><mo id="A2.E59.m2.4.4.1.1.3.1.2" xref="A2.E59.m2.4.4.1.1.3.1.2.cmml">⁢</mo><mrow id="A2.E59.m2.4.4.1.1.3.1.1.1" xref="A2.E59.m2.4.4.1.1.3.1.1.1.1.cmml"><mo id="A2.E59.m2.4.4.1.1.3.1.1.1.2" stretchy="false" xref="A2.E59.m2.4.4.1.1.3.1.1.1.1.cmml">(</mo><msub id="A2.E59.m2.4.4.1.1.3.1.1.1.1" xref="A2.E59.m2.4.4.1.1.3.1.1.1.1.cmml"><mi id="A2.E59.m2.4.4.1.1.3.1.1.1.1.2" xref="A2.E59.m2.4.4.1.1.3.1.1.1.1.2.cmml">X</mi><mi id="A2.E59.m2.4.4.1.1.3.1.1.1.1.3" xref="A2.E59.m2.4.4.1.1.3.1.1.1.1.3.cmml">j</mi></msub><mo id="A2.E59.m2.4.4.1.1.3.1.1.1.3" stretchy="false" xref="A2.E59.m2.4.4.1.1.3.1.1.1.1.cmml">)</mo></mrow><mo id="A2.E59.m2.4.4.1.1.3.1.2a" lspace="0.167em" xref="A2.E59.m2.4.4.1.1.3.1.2.cmml">⁢</mo><mrow id="A2.E59.m2.4.4.1.1.3.1.4" xref="A2.E59.m2.4.4.1.1.3.1.4.cmml"><mi id="A2.E59.m2.4.4.1.1.3.1.4.1" xref="A2.E59.m2.4.4.1.1.3.1.4.1.cmml">log</mi><mo id="A2.E59.m2.4.4.1.1.3.1.4a" lspace="0.167em" xref="A2.E59.m2.4.4.1.1.3.1.4.cmml">⁡</mo><mstyle displaystyle="true" id="A2.E59.m2.2.2" xref="A2.E59.m2.2.2.cmml"><mfrac id="A2.E59.m2.2.2a" xref="A2.E59.m2.2.2.cmml"><mrow id="A2.E59.m2.1.1.1" xref="A2.E59.m2.1.1.1.cmml"><mi id="A2.E59.m2.1.1.1.3" xref="A2.E59.m2.1.1.1.3.cmml">P</mi><mo id="A2.E59.m2.1.1.1.2" xref="A2.E59.m2.1.1.1.2.cmml">⁢</mo><mrow id="A2.E59.m2.1.1.1.1.1" xref="A2.E59.m2.1.1.1.1.1.1.cmml"><mo id="A2.E59.m2.1.1.1.1.1.2" stretchy="false" xref="A2.E59.m2.1.1.1.1.1.1.cmml">(</mo><msub id="A2.E59.m2.1.1.1.1.1.1" xref="A2.E59.m2.1.1.1.1.1.1.cmml"><mi id="A2.E59.m2.1.1.1.1.1.1.2" xref="A2.E59.m2.1.1.1.1.1.1.2.cmml">X</mi><mi id="A2.E59.m2.1.1.1.1.1.1.3" xref="A2.E59.m2.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="A2.E59.m2.1.1.1.1.1.3" stretchy="false" xref="A2.E59.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A2.E59.m2.2.2.2" xref="A2.E59.m2.2.2.2.cmml"><msub id="A2.E59.m2.2.2.2.3" xref="A2.E59.m2.2.2.2.3.cmml"><mi id="A2.E59.m2.2.2.2.3.2" xref="A2.E59.m2.2.2.2.3.2.cmml">V</mi><mi id="A2.E59.m2.2.2.2.3.3" xref="A2.E59.m2.2.2.2.3.3.cmml">f</mi></msub><mo id="A2.E59.m2.2.2.2.2" xref="A2.E59.m2.2.2.2.2.cmml">⁢</mo><mrow id="A2.E59.m2.2.2.2.1.1" xref="A2.E59.m2.2.2.2.1.1.1.cmml"><mo id="A2.E59.m2.2.2.2.1.1.2" stretchy="false" xref="A2.E59.m2.2.2.2.1.1.1.cmml">(</mo><msub id="A2.E59.m2.2.2.2.1.1.1" xref="A2.E59.m2.2.2.2.1.1.1.cmml"><mi id="A2.E59.m2.2.2.2.1.1.1.2" xref="A2.E59.m2.2.2.2.1.1.1.2.cmml">X</mi><mi id="A2.E59.m2.2.2.2.1.1.1.3" xref="A2.E59.m2.2.2.2.1.1.1.3.cmml">j</mi></msub><mo id="A2.E59.m2.2.2.2.1.1.3" stretchy="false" xref="A2.E59.m2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mstyle></mrow></mrow></mrow></mrow><mo id="A2.E59.m2.4.4.1.2" lspace="0.170em" xref="A2.E59.m2.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.E59.m2.4b"><apply id="A2.E59.m2.4.4.1.1.cmml" xref="A2.E59.m2.4.4.1"><eq id="A2.E59.m2.4.4.1.1.4.cmml" xref="A2.E59.m2.4.4.1.1.4"></eq><apply id="A2.E59.m2.4.4.1.1.2.cmml" xref="A2.E59.m2.4.4.1.1.2"><times id="A2.E59.m2.4.4.1.1.2.3.cmml" xref="A2.E59.m2.4.4.1.1.2.3"></times><apply id="A2.E59.m2.4.4.1.1.2.4.cmml" xref="A2.E59.m2.4.4.1.1.2.4"><csymbol cd="ambiguous" id="A2.E59.m2.4.4.1.1.2.4.1.cmml" xref="A2.E59.m2.4.4.1.1.2.4">superscript</csymbol><ci id="A2.E59.m2.4.4.1.1.2.4.2.cmml" xref="A2.E59.m2.4.4.1.1.2.4.2">𝐿</ci><times id="A2.E59.m2.4.4.1.1.2.4.3.cmml" xref="A2.E59.m2.4.4.1.1.2.4.3"></times></apply><vector id="A2.E59.m2.4.4.1.1.2.2.3.cmml" xref="A2.E59.m2.4.4.1.1.2.2.2"><apply id="A2.E59.m2.4.4.1.1.1.1.1.1.cmml" xref="A2.E59.m2.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E59.m2.4.4.1.1.1.1.1.1.1.cmml" xref="A2.E59.m2.4.4.1.1.1.1.1.1">subscript</csymbol><ci id="A2.E59.m2.4.4.1.1.1.1.1.1.2.cmml" xref="A2.E59.m2.4.4.1.1.1.1.1.1.2">𝑋</ci><cn id="A2.E59.m2.4.4.1.1.1.1.1.1.3.cmml" type="integer" xref="A2.E59.m2.4.4.1.1.1.1.1.1.3">1</cn></apply><ci id="A2.E59.m2.3.3.cmml" xref="A2.E59.m2.3.3">…</ci><apply id="A2.E59.m2.4.4.1.1.2.2.2.2.cmml" xref="A2.E59.m2.4.4.1.1.2.2.2.2"><csymbol cd="ambiguous" id="A2.E59.m2.4.4.1.1.2.2.2.2.1.cmml" xref="A2.E59.m2.4.4.1.1.2.2.2.2">subscript</csymbol><ci id="A2.E59.m2.4.4.1.1.2.2.2.2.2.cmml" xref="A2.E59.m2.4.4.1.1.2.2.2.2.2">𝑋</ci><ci id="A2.E59.m2.4.4.1.1.2.2.2.2.3.cmml" xref="A2.E59.m2.4.4.1.1.2.2.2.2.3">𝐽</ci></apply></vector></apply><apply id="A2.E59.m2.4.4.1.1.3.cmml" xref="A2.E59.m2.4.4.1.1.3"><apply id="A2.E59.m2.4.4.1.1.3.2.cmml" xref="A2.E59.m2.4.4.1.1.3.2"><csymbol cd="ambiguous" id="A2.E59.m2.4.4.1.1.3.2.1.cmml" xref="A2.E59.m2.4.4.1.1.3.2">superscript</csymbol><apply id="A2.E59.m2.4.4.1.1.3.2.2.cmml" xref="A2.E59.m2.4.4.1.1.3.2"><csymbol cd="ambiguous" id="A2.E59.m2.4.4.1.1.3.2.2.1.cmml" xref="A2.E59.m2.4.4.1.1.3.2">subscript</csymbol><sum id="A2.E59.m2.4.4.1.1.3.2.2.2.cmml" xref="A2.E59.m2.4.4.1.1.3.2.2.2"></sum><apply id="A2.E59.m2.4.4.1.1.3.2.2.3.cmml" xref="A2.E59.m2.4.4.1.1.3.2.2.3"><eq id="A2.E59.m2.4.4.1.1.3.2.2.3.1.cmml" xref="A2.E59.m2.4.4.1.1.3.2.2.3.1"></eq><ci id="A2.E59.m2.4.4.1.1.3.2.2.3.2.cmml" xref="A2.E59.m2.4.4.1.1.3.2.2.3.2">𝑗</ci><cn id="A2.E59.m2.4.4.1.1.3.2.2.3.3.cmml" type="integer" xref="A2.E59.m2.4.4.1.1.3.2.2.3.3">1</cn></apply></apply><ci id="A2.E59.m2.4.4.1.1.3.2.3.cmml" xref="A2.E59.m2.4.4.1.1.3.2.3">𝐽</ci></apply><apply id="A2.E59.m2.4.4.1.1.3.1.cmml" xref="A2.E59.m2.4.4.1.1.3.1"><times id="A2.E59.m2.4.4.1.1.3.1.2.cmml" xref="A2.E59.m2.4.4.1.1.3.1.2"></times><ci id="A2.E59.m2.4.4.1.1.3.1.3.cmml" xref="A2.E59.m2.4.4.1.1.3.1.3">𝑃</ci><apply id="A2.E59.m2.4.4.1.1.3.1.1.1.1.cmml" xref="A2.E59.m2.4.4.1.1.3.1.1.1"><csymbol cd="ambiguous" id="A2.E59.m2.4.4.1.1.3.1.1.1.1.1.cmml" xref="A2.E59.m2.4.4.1.1.3.1.1.1">subscript</csymbol><ci id="A2.E59.m2.4.4.1.1.3.1.1.1.1.2.cmml" xref="A2.E59.m2.4.4.1.1.3.1.1.1.1.2">𝑋</ci><ci id="A2.E59.m2.4.4.1.1.3.1.1.1.1.3.cmml" xref="A2.E59.m2.4.4.1.1.3.1.1.1.1.3">𝑗</ci></apply><apply id="A2.E59.m2.4.4.1.1.3.1.4.cmml" xref="A2.E59.m2.4.4.1.1.3.1.4"><log id="A2.E59.m2.4.4.1.1.3.1.4.1.cmml" xref="A2.E59.m2.4.4.1.1.3.1.4.1"></log><apply id="A2.E59.m2.2.2.cmml" xref="A2.E59.m2.2.2"><divide id="A2.E59.m2.2.2.3.cmml" xref="A2.E59.m2.2.2"></divide><apply id="A2.E59.m2.1.1.1.cmml" xref="A2.E59.m2.1.1.1"><times id="A2.E59.m2.1.1.1.2.cmml" xref="A2.E59.m2.1.1.1.2"></times><ci id="A2.E59.m2.1.1.1.3.cmml" xref="A2.E59.m2.1.1.1.3">𝑃</ci><apply id="A2.E59.m2.1.1.1.1.1.1.cmml" xref="A2.E59.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E59.m2.1.1.1.1.1.1.1.cmml" xref="A2.E59.m2.1.1.1.1.1">subscript</csymbol><ci id="A2.E59.m2.1.1.1.1.1.1.2.cmml" xref="A2.E59.m2.1.1.1.1.1.1.2">𝑋</ci><ci id="A2.E59.m2.1.1.1.1.1.1.3.cmml" xref="A2.E59.m2.1.1.1.1.1.1.3">𝑗</ci></apply></apply><apply id="A2.E59.m2.2.2.2.cmml" xref="A2.E59.m2.2.2.2"><times id="A2.E59.m2.2.2.2.2.cmml" xref="A2.E59.m2.2.2.2.2"></times><apply id="A2.E59.m2.2.2.2.3.cmml" xref="A2.E59.m2.2.2.2.3"><csymbol cd="ambiguous" id="A2.E59.m2.2.2.2.3.1.cmml" xref="A2.E59.m2.2.2.2.3">subscript</csymbol><ci id="A2.E59.m2.2.2.2.3.2.cmml" xref="A2.E59.m2.2.2.2.3.2">𝑉</ci><ci id="A2.E59.m2.2.2.2.3.3.cmml" xref="A2.E59.m2.2.2.2.3.3">𝑓</ci></apply><apply id="A2.E59.m2.2.2.2.1.1.1.cmml" xref="A2.E59.m2.2.2.2.1.1"><csymbol cd="ambiguous" id="A2.E59.m2.2.2.2.1.1.1.1.cmml" xref="A2.E59.m2.2.2.2.1.1">subscript</csymbol><ci id="A2.E59.m2.2.2.2.1.1.1.2.cmml" xref="A2.E59.m2.2.2.2.1.1.1.2">𝑋</ci><ci id="A2.E59.m2.2.2.2.1.1.1.3.cmml" xref="A2.E59.m2.2.2.2.1.1.1.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E59.m2.4c">\displaystyle L^{*}\left(X_{1},\ldots,X_{J}\right)=\sum_{j=1}^{J}P(X_{j})\log%
\frac{P(X_{j})}{V_{f}(X_{j})}\,.</annotation><annotation encoding="application/x-llamapun" id="A2.E59.m2.4d">italic_L start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_X start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_X start_POSTSUBSCRIPT italic_J end_POSTSUBSCRIPT ) = ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_J end_POSTSUPERSCRIPT italic_P ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) roman_log divide start_ARG italic_P ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG start_ARG italic_V start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(59)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A2.SSx1.p1.5">The only change is therefore to the splitting criterion which should become:</p>
<table class="ltx_equation ltx_eqn_table" id="A2.E60">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\max_{X_{L},X_{R}\in\mathcal{P}\left(X_{P}\right)}P(X_{L})\log\frac{P(X_{L})}{%
V(X_{L})}+P(X_{R})\log\frac{P(X_{R})}{V(X_{R})}-P(X_{P})\log\frac{P(X_{P})}{V(%
X_{P})}\,." class="ltx_Math" display="block" id="A2.E60.m1.10"><semantics id="A2.E60.m1.10a"><mrow id="A2.E60.m1.10.10.1" xref="A2.E60.m1.10.10.1.1.cmml"><mrow id="A2.E60.m1.10.10.1.1" xref="A2.E60.m1.10.10.1.1.cmml"><mrow id="A2.E60.m1.10.10.1.1.2" xref="A2.E60.m1.10.10.1.1.2.cmml"><mrow id="A2.E60.m1.10.10.1.1.1.1" xref="A2.E60.m1.10.10.1.1.1.1.cmml"><mrow id="A2.E60.m1.10.10.1.1.1.1.3" xref="A2.E60.m1.10.10.1.1.1.1.3.cmml"><munder id="A2.E60.m1.10.10.1.1.1.1.3.1" xref="A2.E60.m1.10.10.1.1.1.1.3.1.cmml"><mi id="A2.E60.m1.10.10.1.1.1.1.3.1.2" xref="A2.E60.m1.10.10.1.1.1.1.3.1.2.cmml">max</mi><mrow id="A2.E60.m1.3.3.3" xref="A2.E60.m1.3.3.3.cmml"><mrow id="A2.E60.m1.2.2.2.2.2" xref="A2.E60.m1.2.2.2.2.3.cmml"><msub id="A2.E60.m1.1.1.1.1.1.1" xref="A2.E60.m1.1.1.1.1.1.1.cmml"><mi id="A2.E60.m1.1.1.1.1.1.1.2" xref="A2.E60.m1.1.1.1.1.1.1.2.cmml">X</mi><mi id="A2.E60.m1.1.1.1.1.1.1.3" xref="A2.E60.m1.1.1.1.1.1.1.3.cmml">L</mi></msub><mo id="A2.E60.m1.2.2.2.2.2.3" xref="A2.E60.m1.2.2.2.2.3.cmml">,</mo><msub id="A2.E60.m1.2.2.2.2.2.2" xref="A2.E60.m1.2.2.2.2.2.2.cmml"><mi id="A2.E60.m1.2.2.2.2.2.2.2" xref="A2.E60.m1.2.2.2.2.2.2.2.cmml">X</mi><mi id="A2.E60.m1.2.2.2.2.2.2.3" xref="A2.E60.m1.2.2.2.2.2.2.3.cmml">R</mi></msub></mrow><mo id="A2.E60.m1.3.3.3.4" xref="A2.E60.m1.3.3.3.4.cmml">∈</mo><mrow id="A2.E60.m1.3.3.3.3" xref="A2.E60.m1.3.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.E60.m1.3.3.3.3.3" xref="A2.E60.m1.3.3.3.3.3.cmml">𝒫</mi><mo id="A2.E60.m1.3.3.3.3.2" xref="A2.E60.m1.3.3.3.3.2.cmml">⁢</mo><mrow id="A2.E60.m1.3.3.3.3.1.1" xref="A2.E60.m1.3.3.3.3.1.1.1.cmml"><mo id="A2.E60.m1.3.3.3.3.1.1.2" xref="A2.E60.m1.3.3.3.3.1.1.1.cmml">(</mo><msub id="A2.E60.m1.3.3.3.3.1.1.1" xref="A2.E60.m1.3.3.3.3.1.1.1.cmml"><mi id="A2.E60.m1.3.3.3.3.1.1.1.2" xref="A2.E60.m1.3.3.3.3.1.1.1.2.cmml">X</mi><mi id="A2.E60.m1.3.3.3.3.1.1.1.3" xref="A2.E60.m1.3.3.3.3.1.1.1.3.cmml">P</mi></msub><mo id="A2.E60.m1.3.3.3.3.1.1.3" xref="A2.E60.m1.3.3.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow></munder><mo id="A2.E60.m1.10.10.1.1.1.1.3a" lspace="0.167em" xref="A2.E60.m1.10.10.1.1.1.1.3.cmml">⁡</mo><mi id="A2.E60.m1.10.10.1.1.1.1.3.2" xref="A2.E60.m1.10.10.1.1.1.1.3.2.cmml">P</mi></mrow><mo id="A2.E60.m1.10.10.1.1.1.1.2" xref="A2.E60.m1.10.10.1.1.1.1.2.cmml">⁢</mo><mrow id="A2.E60.m1.10.10.1.1.1.1.1.1" xref="A2.E60.m1.10.10.1.1.1.1.1.1.1.cmml"><mo id="A2.E60.m1.10.10.1.1.1.1.1.1.2" stretchy="false" xref="A2.E60.m1.10.10.1.1.1.1.1.1.1.cmml">(</mo><msub id="A2.E60.m1.10.10.1.1.1.1.1.1.1" xref="A2.E60.m1.10.10.1.1.1.1.1.1.1.cmml"><mi id="A2.E60.m1.10.10.1.1.1.1.1.1.1.2" xref="A2.E60.m1.10.10.1.1.1.1.1.1.1.2.cmml">X</mi><mi id="A2.E60.m1.10.10.1.1.1.1.1.1.1.3" xref="A2.E60.m1.10.10.1.1.1.1.1.1.1.3.cmml">L</mi></msub><mo id="A2.E60.m1.10.10.1.1.1.1.1.1.3" stretchy="false" xref="A2.E60.m1.10.10.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A2.E60.m1.10.10.1.1.1.1.2a" lspace="0.167em" xref="A2.E60.m1.10.10.1.1.1.1.2.cmml">⁢</mo><mrow id="A2.E60.m1.10.10.1.1.1.1.4" xref="A2.E60.m1.10.10.1.1.1.1.4.cmml"><mi id="A2.E60.m1.10.10.1.1.1.1.4.1" xref="A2.E60.m1.10.10.1.1.1.1.4.1.cmml">log</mi><mo id="A2.E60.m1.10.10.1.1.1.1.4a" lspace="0.167em" xref="A2.E60.m1.10.10.1.1.1.1.4.cmml">⁡</mo><mfrac id="A2.E60.m1.5.5" xref="A2.E60.m1.5.5.cmml"><mrow id="A2.E60.m1.4.4.1" xref="A2.E60.m1.4.4.1.cmml"><mi id="A2.E60.m1.4.4.1.3" xref="A2.E60.m1.4.4.1.3.cmml">P</mi><mo id="A2.E60.m1.4.4.1.2" xref="A2.E60.m1.4.4.1.2.cmml">⁢</mo><mrow id="A2.E60.m1.4.4.1.1.1" xref="A2.E60.m1.4.4.1.1.1.1.cmml"><mo id="A2.E60.m1.4.4.1.1.1.2" stretchy="false" xref="A2.E60.m1.4.4.1.1.1.1.cmml">(</mo><msub id="A2.E60.m1.4.4.1.1.1.1" xref="A2.E60.m1.4.4.1.1.1.1.cmml"><mi id="A2.E60.m1.4.4.1.1.1.1.2" xref="A2.E60.m1.4.4.1.1.1.1.2.cmml">X</mi><mi id="A2.E60.m1.4.4.1.1.1.1.3" xref="A2.E60.m1.4.4.1.1.1.1.3.cmml">L</mi></msub><mo id="A2.E60.m1.4.4.1.1.1.3" stretchy="false" xref="A2.E60.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A2.E60.m1.5.5.2" xref="A2.E60.m1.5.5.2.cmml"><mi id="A2.E60.m1.5.5.2.3" xref="A2.E60.m1.5.5.2.3.cmml">V</mi><mo id="A2.E60.m1.5.5.2.2" xref="A2.E60.m1.5.5.2.2.cmml">⁢</mo><mrow id="A2.E60.m1.5.5.2.1.1" xref="A2.E60.m1.5.5.2.1.1.1.cmml"><mo id="A2.E60.m1.5.5.2.1.1.2" stretchy="false" xref="A2.E60.m1.5.5.2.1.1.1.cmml">(</mo><msub id="A2.E60.m1.5.5.2.1.1.1" xref="A2.E60.m1.5.5.2.1.1.1.cmml"><mi id="A2.E60.m1.5.5.2.1.1.1.2" xref="A2.E60.m1.5.5.2.1.1.1.2.cmml">X</mi><mi id="A2.E60.m1.5.5.2.1.1.1.3" xref="A2.E60.m1.5.5.2.1.1.1.3.cmml">L</mi></msub><mo id="A2.E60.m1.5.5.2.1.1.3" stretchy="false" xref="A2.E60.m1.5.5.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><mo id="A2.E60.m1.10.10.1.1.2.3" xref="A2.E60.m1.10.10.1.1.2.3.cmml">+</mo><mrow id="A2.E60.m1.10.10.1.1.2.2" xref="A2.E60.m1.10.10.1.1.2.2.cmml"><mi id="A2.E60.m1.10.10.1.1.2.2.3" xref="A2.E60.m1.10.10.1.1.2.2.3.cmml">P</mi><mo id="A2.E60.m1.10.10.1.1.2.2.2" xref="A2.E60.m1.10.10.1.1.2.2.2.cmml">⁢</mo><mrow id="A2.E60.m1.10.10.1.1.2.2.1.1" xref="A2.E60.m1.10.10.1.1.2.2.1.1.1.cmml"><mo id="A2.E60.m1.10.10.1.1.2.2.1.1.2" stretchy="false" xref="A2.E60.m1.10.10.1.1.2.2.1.1.1.cmml">(</mo><msub id="A2.E60.m1.10.10.1.1.2.2.1.1.1" xref="A2.E60.m1.10.10.1.1.2.2.1.1.1.cmml"><mi id="A2.E60.m1.10.10.1.1.2.2.1.1.1.2" xref="A2.E60.m1.10.10.1.1.2.2.1.1.1.2.cmml">X</mi><mi id="A2.E60.m1.10.10.1.1.2.2.1.1.1.3" xref="A2.E60.m1.10.10.1.1.2.2.1.1.1.3.cmml">R</mi></msub><mo id="A2.E60.m1.10.10.1.1.2.2.1.1.3" stretchy="false" xref="A2.E60.m1.10.10.1.1.2.2.1.1.1.cmml">)</mo></mrow><mo id="A2.E60.m1.10.10.1.1.2.2.2a" lspace="0.167em" xref="A2.E60.m1.10.10.1.1.2.2.2.cmml">⁢</mo><mrow id="A2.E60.m1.10.10.1.1.2.2.4" xref="A2.E60.m1.10.10.1.1.2.2.4.cmml"><mi id="A2.E60.m1.10.10.1.1.2.2.4.1" xref="A2.E60.m1.10.10.1.1.2.2.4.1.cmml">log</mi><mo id="A2.E60.m1.10.10.1.1.2.2.4a" lspace="0.167em" xref="A2.E60.m1.10.10.1.1.2.2.4.cmml">⁡</mo><mfrac id="A2.E60.m1.7.7" xref="A2.E60.m1.7.7.cmml"><mrow id="A2.E60.m1.6.6.1" xref="A2.E60.m1.6.6.1.cmml"><mi id="A2.E60.m1.6.6.1.3" xref="A2.E60.m1.6.6.1.3.cmml">P</mi><mo id="A2.E60.m1.6.6.1.2" xref="A2.E60.m1.6.6.1.2.cmml">⁢</mo><mrow id="A2.E60.m1.6.6.1.1.1" xref="A2.E60.m1.6.6.1.1.1.1.cmml"><mo id="A2.E60.m1.6.6.1.1.1.2" stretchy="false" xref="A2.E60.m1.6.6.1.1.1.1.cmml">(</mo><msub id="A2.E60.m1.6.6.1.1.1.1" xref="A2.E60.m1.6.6.1.1.1.1.cmml"><mi id="A2.E60.m1.6.6.1.1.1.1.2" xref="A2.E60.m1.6.6.1.1.1.1.2.cmml">X</mi><mi id="A2.E60.m1.6.6.1.1.1.1.3" xref="A2.E60.m1.6.6.1.1.1.1.3.cmml">R</mi></msub><mo id="A2.E60.m1.6.6.1.1.1.3" stretchy="false" xref="A2.E60.m1.6.6.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A2.E60.m1.7.7.2" xref="A2.E60.m1.7.7.2.cmml"><mi id="A2.E60.m1.7.7.2.3" xref="A2.E60.m1.7.7.2.3.cmml">V</mi><mo id="A2.E60.m1.7.7.2.2" xref="A2.E60.m1.7.7.2.2.cmml">⁢</mo><mrow id="A2.E60.m1.7.7.2.1.1" xref="A2.E60.m1.7.7.2.1.1.1.cmml"><mo id="A2.E60.m1.7.7.2.1.1.2" stretchy="false" xref="A2.E60.m1.7.7.2.1.1.1.cmml">(</mo><msub id="A2.E60.m1.7.7.2.1.1.1" xref="A2.E60.m1.7.7.2.1.1.1.cmml"><mi id="A2.E60.m1.7.7.2.1.1.1.2" xref="A2.E60.m1.7.7.2.1.1.1.2.cmml">X</mi><mi id="A2.E60.m1.7.7.2.1.1.1.3" xref="A2.E60.m1.7.7.2.1.1.1.3.cmml">R</mi></msub><mo id="A2.E60.m1.7.7.2.1.1.3" stretchy="false" xref="A2.E60.m1.7.7.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow></mrow><mo id="A2.E60.m1.10.10.1.1.4" xref="A2.E60.m1.10.10.1.1.4.cmml">−</mo><mrow id="A2.E60.m1.10.10.1.1.3" xref="A2.E60.m1.10.10.1.1.3.cmml"><mi id="A2.E60.m1.10.10.1.1.3.3" xref="A2.E60.m1.10.10.1.1.3.3.cmml">P</mi><mo id="A2.E60.m1.10.10.1.1.3.2" xref="A2.E60.m1.10.10.1.1.3.2.cmml">⁢</mo><mrow id="A2.E60.m1.10.10.1.1.3.1.1" xref="A2.E60.m1.10.10.1.1.3.1.1.1.cmml"><mo id="A2.E60.m1.10.10.1.1.3.1.1.2" stretchy="false" xref="A2.E60.m1.10.10.1.1.3.1.1.1.cmml">(</mo><msub id="A2.E60.m1.10.10.1.1.3.1.1.1" xref="A2.E60.m1.10.10.1.1.3.1.1.1.cmml"><mi id="A2.E60.m1.10.10.1.1.3.1.1.1.2" xref="A2.E60.m1.10.10.1.1.3.1.1.1.2.cmml">X</mi><mi id="A2.E60.m1.10.10.1.1.3.1.1.1.3" xref="A2.E60.m1.10.10.1.1.3.1.1.1.3.cmml">P</mi></msub><mo id="A2.E60.m1.10.10.1.1.3.1.1.3" stretchy="false" xref="A2.E60.m1.10.10.1.1.3.1.1.1.cmml">)</mo></mrow><mo id="A2.E60.m1.10.10.1.1.3.2a" lspace="0.167em" xref="A2.E60.m1.10.10.1.1.3.2.cmml">⁢</mo><mrow id="A2.E60.m1.10.10.1.1.3.4" xref="A2.E60.m1.10.10.1.1.3.4.cmml"><mi id="A2.E60.m1.10.10.1.1.3.4.1" xref="A2.E60.m1.10.10.1.1.3.4.1.cmml">log</mi><mo id="A2.E60.m1.10.10.1.1.3.4a" lspace="0.167em" xref="A2.E60.m1.10.10.1.1.3.4.cmml">⁡</mo><mfrac id="A2.E60.m1.9.9" xref="A2.E60.m1.9.9.cmml"><mrow id="A2.E60.m1.8.8.1" xref="A2.E60.m1.8.8.1.cmml"><mi id="A2.E60.m1.8.8.1.3" xref="A2.E60.m1.8.8.1.3.cmml">P</mi><mo id="A2.E60.m1.8.8.1.2" xref="A2.E60.m1.8.8.1.2.cmml">⁢</mo><mrow id="A2.E60.m1.8.8.1.1.1" xref="A2.E60.m1.8.8.1.1.1.1.cmml"><mo id="A2.E60.m1.8.8.1.1.1.2" stretchy="false" xref="A2.E60.m1.8.8.1.1.1.1.cmml">(</mo><msub id="A2.E60.m1.8.8.1.1.1.1" xref="A2.E60.m1.8.8.1.1.1.1.cmml"><mi id="A2.E60.m1.8.8.1.1.1.1.2" xref="A2.E60.m1.8.8.1.1.1.1.2.cmml">X</mi><mi id="A2.E60.m1.8.8.1.1.1.1.3" xref="A2.E60.m1.8.8.1.1.1.1.3.cmml">P</mi></msub><mo id="A2.E60.m1.8.8.1.1.1.3" stretchy="false" xref="A2.E60.m1.8.8.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A2.E60.m1.9.9.2" xref="A2.E60.m1.9.9.2.cmml"><mi id="A2.E60.m1.9.9.2.3" xref="A2.E60.m1.9.9.2.3.cmml">V</mi><mo id="A2.E60.m1.9.9.2.2" xref="A2.E60.m1.9.9.2.2.cmml">⁢</mo><mrow id="A2.E60.m1.9.9.2.1.1" xref="A2.E60.m1.9.9.2.1.1.1.cmml"><mo id="A2.E60.m1.9.9.2.1.1.2" stretchy="false" xref="A2.E60.m1.9.9.2.1.1.1.cmml">(</mo><msub id="A2.E60.m1.9.9.2.1.1.1" xref="A2.E60.m1.9.9.2.1.1.1.cmml"><mi id="A2.E60.m1.9.9.2.1.1.1.2" xref="A2.E60.m1.9.9.2.1.1.1.2.cmml">X</mi><mi id="A2.E60.m1.9.9.2.1.1.1.3" xref="A2.E60.m1.9.9.2.1.1.1.3.cmml">P</mi></msub><mo id="A2.E60.m1.9.9.2.1.1.3" stretchy="false" xref="A2.E60.m1.9.9.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow></mrow><mo id="A2.E60.m1.10.10.1.2" lspace="0.170em" xref="A2.E60.m1.10.10.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.E60.m1.10b"><apply id="A2.E60.m1.10.10.1.1.cmml" xref="A2.E60.m1.10.10.1"><minus id="A2.E60.m1.10.10.1.1.4.cmml" xref="A2.E60.m1.10.10.1.1.4"></minus><apply id="A2.E60.m1.10.10.1.1.2.cmml" xref="A2.E60.m1.10.10.1.1.2"><plus id="A2.E60.m1.10.10.1.1.2.3.cmml" xref="A2.E60.m1.10.10.1.1.2.3"></plus><apply id="A2.E60.m1.10.10.1.1.1.1.cmml" xref="A2.E60.m1.10.10.1.1.1.1"><times id="A2.E60.m1.10.10.1.1.1.1.2.cmml" xref="A2.E60.m1.10.10.1.1.1.1.2"></times><apply id="A2.E60.m1.10.10.1.1.1.1.3.cmml" xref="A2.E60.m1.10.10.1.1.1.1.3"><apply id="A2.E60.m1.10.10.1.1.1.1.3.1.cmml" xref="A2.E60.m1.10.10.1.1.1.1.3.1"><csymbol cd="ambiguous" id="A2.E60.m1.10.10.1.1.1.1.3.1.1.cmml" xref="A2.E60.m1.10.10.1.1.1.1.3.1">subscript</csymbol><max id="A2.E60.m1.10.10.1.1.1.1.3.1.2.cmml" xref="A2.E60.m1.10.10.1.1.1.1.3.1.2"></max><apply id="A2.E60.m1.3.3.3.cmml" xref="A2.E60.m1.3.3.3"><in id="A2.E60.m1.3.3.3.4.cmml" xref="A2.E60.m1.3.3.3.4"></in><list id="A2.E60.m1.2.2.2.2.3.cmml" xref="A2.E60.m1.2.2.2.2.2"><apply id="A2.E60.m1.1.1.1.1.1.1.cmml" xref="A2.E60.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E60.m1.1.1.1.1.1.1.1.cmml" xref="A2.E60.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A2.E60.m1.1.1.1.1.1.1.2.cmml" xref="A2.E60.m1.1.1.1.1.1.1.2">𝑋</ci><ci id="A2.E60.m1.1.1.1.1.1.1.3.cmml" xref="A2.E60.m1.1.1.1.1.1.1.3">𝐿</ci></apply><apply id="A2.E60.m1.2.2.2.2.2.2.cmml" xref="A2.E60.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A2.E60.m1.2.2.2.2.2.2.1.cmml" xref="A2.E60.m1.2.2.2.2.2.2">subscript</csymbol><ci id="A2.E60.m1.2.2.2.2.2.2.2.cmml" xref="A2.E60.m1.2.2.2.2.2.2.2">𝑋</ci><ci id="A2.E60.m1.2.2.2.2.2.2.3.cmml" xref="A2.E60.m1.2.2.2.2.2.2.3">𝑅</ci></apply></list><apply id="A2.E60.m1.3.3.3.3.cmml" xref="A2.E60.m1.3.3.3.3"><times id="A2.E60.m1.3.3.3.3.2.cmml" xref="A2.E60.m1.3.3.3.3.2"></times><ci id="A2.E60.m1.3.3.3.3.3.cmml" xref="A2.E60.m1.3.3.3.3.3">𝒫</ci><apply id="A2.E60.m1.3.3.3.3.1.1.1.cmml" xref="A2.E60.m1.3.3.3.3.1.1"><csymbol cd="ambiguous" id="A2.E60.m1.3.3.3.3.1.1.1.1.cmml" xref="A2.E60.m1.3.3.3.3.1.1">subscript</csymbol><ci id="A2.E60.m1.3.3.3.3.1.1.1.2.cmml" xref="A2.E60.m1.3.3.3.3.1.1.1.2">𝑋</ci><ci id="A2.E60.m1.3.3.3.3.1.1.1.3.cmml" xref="A2.E60.m1.3.3.3.3.1.1.1.3">𝑃</ci></apply></apply></apply></apply><ci id="A2.E60.m1.10.10.1.1.1.1.3.2.cmml" xref="A2.E60.m1.10.10.1.1.1.1.3.2">𝑃</ci></apply><apply id="A2.E60.m1.10.10.1.1.1.1.1.1.1.cmml" xref="A2.E60.m1.10.10.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E60.m1.10.10.1.1.1.1.1.1.1.1.cmml" xref="A2.E60.m1.10.10.1.1.1.1.1.1">subscript</csymbol><ci id="A2.E60.m1.10.10.1.1.1.1.1.1.1.2.cmml" xref="A2.E60.m1.10.10.1.1.1.1.1.1.1.2">𝑋</ci><ci id="A2.E60.m1.10.10.1.1.1.1.1.1.1.3.cmml" xref="A2.E60.m1.10.10.1.1.1.1.1.1.1.3">𝐿</ci></apply><apply id="A2.E60.m1.10.10.1.1.1.1.4.cmml" xref="A2.E60.m1.10.10.1.1.1.1.4"><log id="A2.E60.m1.10.10.1.1.1.1.4.1.cmml" xref="A2.E60.m1.10.10.1.1.1.1.4.1"></log><apply id="A2.E60.m1.5.5.cmml" xref="A2.E60.m1.5.5"><divide id="A2.E60.m1.5.5.3.cmml" xref="A2.E60.m1.5.5"></divide><apply id="A2.E60.m1.4.4.1.cmml" xref="A2.E60.m1.4.4.1"><times id="A2.E60.m1.4.4.1.2.cmml" xref="A2.E60.m1.4.4.1.2"></times><ci id="A2.E60.m1.4.4.1.3.cmml" xref="A2.E60.m1.4.4.1.3">𝑃</ci><apply id="A2.E60.m1.4.4.1.1.1.1.cmml" xref="A2.E60.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="A2.E60.m1.4.4.1.1.1.1.1.cmml" xref="A2.E60.m1.4.4.1.1.1">subscript</csymbol><ci id="A2.E60.m1.4.4.1.1.1.1.2.cmml" xref="A2.E60.m1.4.4.1.1.1.1.2">𝑋</ci><ci id="A2.E60.m1.4.4.1.1.1.1.3.cmml" xref="A2.E60.m1.4.4.1.1.1.1.3">𝐿</ci></apply></apply><apply id="A2.E60.m1.5.5.2.cmml" xref="A2.E60.m1.5.5.2"><times id="A2.E60.m1.5.5.2.2.cmml" xref="A2.E60.m1.5.5.2.2"></times><ci id="A2.E60.m1.5.5.2.3.cmml" xref="A2.E60.m1.5.5.2.3">𝑉</ci><apply id="A2.E60.m1.5.5.2.1.1.1.cmml" xref="A2.E60.m1.5.5.2.1.1"><csymbol cd="ambiguous" id="A2.E60.m1.5.5.2.1.1.1.1.cmml" xref="A2.E60.m1.5.5.2.1.1">subscript</csymbol><ci id="A2.E60.m1.5.5.2.1.1.1.2.cmml" xref="A2.E60.m1.5.5.2.1.1.1.2">𝑋</ci><ci id="A2.E60.m1.5.5.2.1.1.1.3.cmml" xref="A2.E60.m1.5.5.2.1.1.1.3">𝐿</ci></apply></apply></apply></apply></apply><apply id="A2.E60.m1.10.10.1.1.2.2.cmml" xref="A2.E60.m1.10.10.1.1.2.2"><times id="A2.E60.m1.10.10.1.1.2.2.2.cmml" xref="A2.E60.m1.10.10.1.1.2.2.2"></times><ci id="A2.E60.m1.10.10.1.1.2.2.3.cmml" xref="A2.E60.m1.10.10.1.1.2.2.3">𝑃</ci><apply id="A2.E60.m1.10.10.1.1.2.2.1.1.1.cmml" xref="A2.E60.m1.10.10.1.1.2.2.1.1"><csymbol cd="ambiguous" id="A2.E60.m1.10.10.1.1.2.2.1.1.1.1.cmml" xref="A2.E60.m1.10.10.1.1.2.2.1.1">subscript</csymbol><ci id="A2.E60.m1.10.10.1.1.2.2.1.1.1.2.cmml" xref="A2.E60.m1.10.10.1.1.2.2.1.1.1.2">𝑋</ci><ci id="A2.E60.m1.10.10.1.1.2.2.1.1.1.3.cmml" xref="A2.E60.m1.10.10.1.1.2.2.1.1.1.3">𝑅</ci></apply><apply id="A2.E60.m1.10.10.1.1.2.2.4.cmml" xref="A2.E60.m1.10.10.1.1.2.2.4"><log id="A2.E60.m1.10.10.1.1.2.2.4.1.cmml" xref="A2.E60.m1.10.10.1.1.2.2.4.1"></log><apply id="A2.E60.m1.7.7.cmml" xref="A2.E60.m1.7.7"><divide id="A2.E60.m1.7.7.3.cmml" xref="A2.E60.m1.7.7"></divide><apply id="A2.E60.m1.6.6.1.cmml" xref="A2.E60.m1.6.6.1"><times id="A2.E60.m1.6.6.1.2.cmml" xref="A2.E60.m1.6.6.1.2"></times><ci id="A2.E60.m1.6.6.1.3.cmml" xref="A2.E60.m1.6.6.1.3">𝑃</ci><apply id="A2.E60.m1.6.6.1.1.1.1.cmml" xref="A2.E60.m1.6.6.1.1.1"><csymbol cd="ambiguous" id="A2.E60.m1.6.6.1.1.1.1.1.cmml" xref="A2.E60.m1.6.6.1.1.1">subscript</csymbol><ci id="A2.E60.m1.6.6.1.1.1.1.2.cmml" xref="A2.E60.m1.6.6.1.1.1.1.2">𝑋</ci><ci id="A2.E60.m1.6.6.1.1.1.1.3.cmml" xref="A2.E60.m1.6.6.1.1.1.1.3">𝑅</ci></apply></apply><apply id="A2.E60.m1.7.7.2.cmml" xref="A2.E60.m1.7.7.2"><times id="A2.E60.m1.7.7.2.2.cmml" xref="A2.E60.m1.7.7.2.2"></times><ci id="A2.E60.m1.7.7.2.3.cmml" xref="A2.E60.m1.7.7.2.3">𝑉</ci><apply id="A2.E60.m1.7.7.2.1.1.1.cmml" xref="A2.E60.m1.7.7.2.1.1"><csymbol cd="ambiguous" id="A2.E60.m1.7.7.2.1.1.1.1.cmml" xref="A2.E60.m1.7.7.2.1.1">subscript</csymbol><ci id="A2.E60.m1.7.7.2.1.1.1.2.cmml" xref="A2.E60.m1.7.7.2.1.1.1.2">𝑋</ci><ci id="A2.E60.m1.7.7.2.1.1.1.3.cmml" xref="A2.E60.m1.7.7.2.1.1.1.3">𝑅</ci></apply></apply></apply></apply></apply></apply><apply id="A2.E60.m1.10.10.1.1.3.cmml" xref="A2.E60.m1.10.10.1.1.3"><times id="A2.E60.m1.10.10.1.1.3.2.cmml" xref="A2.E60.m1.10.10.1.1.3.2"></times><ci id="A2.E60.m1.10.10.1.1.3.3.cmml" xref="A2.E60.m1.10.10.1.1.3.3">𝑃</ci><apply id="A2.E60.m1.10.10.1.1.3.1.1.1.cmml" xref="A2.E60.m1.10.10.1.1.3.1.1"><csymbol cd="ambiguous" id="A2.E60.m1.10.10.1.1.3.1.1.1.1.cmml" xref="A2.E60.m1.10.10.1.1.3.1.1">subscript</csymbol><ci id="A2.E60.m1.10.10.1.1.3.1.1.1.2.cmml" xref="A2.E60.m1.10.10.1.1.3.1.1.1.2">𝑋</ci><ci id="A2.E60.m1.10.10.1.1.3.1.1.1.3.cmml" xref="A2.E60.m1.10.10.1.1.3.1.1.1.3">𝑃</ci></apply><apply id="A2.E60.m1.10.10.1.1.3.4.cmml" xref="A2.E60.m1.10.10.1.1.3.4"><log id="A2.E60.m1.10.10.1.1.3.4.1.cmml" xref="A2.E60.m1.10.10.1.1.3.4.1"></log><apply id="A2.E60.m1.9.9.cmml" xref="A2.E60.m1.9.9"><divide id="A2.E60.m1.9.9.3.cmml" xref="A2.E60.m1.9.9"></divide><apply id="A2.E60.m1.8.8.1.cmml" xref="A2.E60.m1.8.8.1"><times id="A2.E60.m1.8.8.1.2.cmml" xref="A2.E60.m1.8.8.1.2"></times><ci id="A2.E60.m1.8.8.1.3.cmml" xref="A2.E60.m1.8.8.1.3">𝑃</ci><apply id="A2.E60.m1.8.8.1.1.1.1.cmml" xref="A2.E60.m1.8.8.1.1.1"><csymbol cd="ambiguous" id="A2.E60.m1.8.8.1.1.1.1.1.cmml" xref="A2.E60.m1.8.8.1.1.1">subscript</csymbol><ci id="A2.E60.m1.8.8.1.1.1.1.2.cmml" xref="A2.E60.m1.8.8.1.1.1.1.2">𝑋</ci><ci id="A2.E60.m1.8.8.1.1.1.1.3.cmml" xref="A2.E60.m1.8.8.1.1.1.1.3">𝑃</ci></apply></apply><apply id="A2.E60.m1.9.9.2.cmml" xref="A2.E60.m1.9.9.2"><times id="A2.E60.m1.9.9.2.2.cmml" xref="A2.E60.m1.9.9.2.2"></times><ci id="A2.E60.m1.9.9.2.3.cmml" xref="A2.E60.m1.9.9.2.3">𝑉</ci><apply id="A2.E60.m1.9.9.2.1.1.1.cmml" xref="A2.E60.m1.9.9.2.1.1"><csymbol cd="ambiguous" id="A2.E60.m1.9.9.2.1.1.1.1.cmml" xref="A2.E60.m1.9.9.2.1.1">subscript</csymbol><ci id="A2.E60.m1.9.9.2.1.1.1.2.cmml" xref="A2.E60.m1.9.9.2.1.1.1.2">𝑋</ci><ci id="A2.E60.m1.9.9.2.1.1.1.3.cmml" xref="A2.E60.m1.9.9.2.1.1.1.3">𝑃</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E60.m1.10c">\max_{X_{L},X_{R}\in\mathcal{P}\left(X_{P}\right)}P(X_{L})\log\frac{P(X_{L})}{%
V(X_{L})}+P(X_{R})\log\frac{P(X_{R})}{V(X_{R})}-P(X_{P})\log\frac{P(X_{P})}{V(%
X_{P})}\,.</annotation><annotation encoding="application/x-llamapun" id="A2.E60.m1.10d">roman_max start_POSTSUBSCRIPT italic_X start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT , italic_X start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ∈ caligraphic_P ( italic_X start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT italic_P ( italic_X start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT ) roman_log divide start_ARG italic_P ( italic_X start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT ) end_ARG start_ARG italic_V ( italic_X start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT ) end_ARG + italic_P ( italic_X start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ) roman_log divide start_ARG italic_P ( italic_X start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ) end_ARG start_ARG italic_V ( italic_X start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ) end_ARG - italic_P ( italic_X start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT ) roman_log divide start_ARG italic_P ( italic_X start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT ) end_ARG start_ARG italic_V ( italic_X start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT ) end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(60)</span></td>
</tr></tbody>
</table>
</div>
</section>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Greedy Tree-Based Multiplicative Boosting</h2>
<div class="ltx_para ltx_noindent" id="A3.p1">
<p class="ltx_p" id="A3.p1.2">In multiplicative generative boosting an unnormalized current density model, <math alttext="\tilde{q}_{t-1}(\mathbf{x})" class="ltx_Math" display="inline" id="A3.p1.1.m1.1"><semantics id="A3.p1.1.m1.1a"><mrow id="A3.p1.1.m1.1.2" xref="A3.p1.1.m1.1.2.cmml"><msub id="A3.p1.1.m1.1.2.2" xref="A3.p1.1.m1.1.2.2.cmml"><mover accent="true" id="A3.p1.1.m1.1.2.2.2" xref="A3.p1.1.m1.1.2.2.2.cmml"><mi id="A3.p1.1.m1.1.2.2.2.2" xref="A3.p1.1.m1.1.2.2.2.2.cmml">q</mi><mo id="A3.p1.1.m1.1.2.2.2.1" xref="A3.p1.1.m1.1.2.2.2.1.cmml">~</mo></mover><mrow id="A3.p1.1.m1.1.2.2.3" xref="A3.p1.1.m1.1.2.2.3.cmml"><mi id="A3.p1.1.m1.1.2.2.3.2" xref="A3.p1.1.m1.1.2.2.3.2.cmml">t</mi><mo id="A3.p1.1.m1.1.2.2.3.1" xref="A3.p1.1.m1.1.2.2.3.1.cmml">−</mo><mn id="A3.p1.1.m1.1.2.2.3.3" xref="A3.p1.1.m1.1.2.2.3.3.cmml">1</mn></mrow></msub><mo id="A3.p1.1.m1.1.2.1" xref="A3.p1.1.m1.1.2.1.cmml">⁢</mo><mrow id="A3.p1.1.m1.1.2.3.2" xref="A3.p1.1.m1.1.2.cmml"><mo id="A3.p1.1.m1.1.2.3.2.1" stretchy="false" xref="A3.p1.1.m1.1.2.cmml">(</mo><mi id="A3.p1.1.m1.1.1" xref="A3.p1.1.m1.1.1.cmml">𝐱</mi><mo id="A3.p1.1.m1.1.2.3.2.2" stretchy="false" xref="A3.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.1.m1.1b"><apply id="A3.p1.1.m1.1.2.cmml" xref="A3.p1.1.m1.1.2"><times id="A3.p1.1.m1.1.2.1.cmml" xref="A3.p1.1.m1.1.2.1"></times><apply id="A3.p1.1.m1.1.2.2.cmml" xref="A3.p1.1.m1.1.2.2"><csymbol cd="ambiguous" id="A3.p1.1.m1.1.2.2.1.cmml" xref="A3.p1.1.m1.1.2.2">subscript</csymbol><apply id="A3.p1.1.m1.1.2.2.2.cmml" xref="A3.p1.1.m1.1.2.2.2"><ci id="A3.p1.1.m1.1.2.2.2.1.cmml" xref="A3.p1.1.m1.1.2.2.2.1">~</ci><ci id="A3.p1.1.m1.1.2.2.2.2.cmml" xref="A3.p1.1.m1.1.2.2.2.2">𝑞</ci></apply><apply id="A3.p1.1.m1.1.2.2.3.cmml" xref="A3.p1.1.m1.1.2.2.3"><minus id="A3.p1.1.m1.1.2.2.3.1.cmml" xref="A3.p1.1.m1.1.2.2.3.1"></minus><ci id="A3.p1.1.m1.1.2.2.3.2.cmml" xref="A3.p1.1.m1.1.2.2.3.2">𝑡</ci><cn id="A3.p1.1.m1.1.2.2.3.3.cmml" type="integer" xref="A3.p1.1.m1.1.2.2.3.3">1</cn></apply></apply><ci id="A3.p1.1.m1.1.1.cmml" xref="A3.p1.1.m1.1.1">𝐱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.1.m1.1c">\tilde{q}_{t-1}(\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="A3.p1.1.m1.1d">over~ start_ARG italic_q end_ARG start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT ( bold_x )</annotation></semantics></math>, is updated at each boosting round by multiplication with a new factor <math alttext="\delta q_{t}^{\alpha_{t}}(\mathbf{x})" class="ltx_Math" display="inline" id="A3.p1.2.m2.1"><semantics id="A3.p1.2.m2.1a"><mrow id="A3.p1.2.m2.1.2" xref="A3.p1.2.m2.1.2.cmml"><mi id="A3.p1.2.m2.1.2.2" xref="A3.p1.2.m2.1.2.2.cmml">δ</mi><mo id="A3.p1.2.m2.1.2.1" xref="A3.p1.2.m2.1.2.1.cmml">⁢</mo><msubsup id="A3.p1.2.m2.1.2.3" xref="A3.p1.2.m2.1.2.3.cmml"><mi id="A3.p1.2.m2.1.2.3.2.2" xref="A3.p1.2.m2.1.2.3.2.2.cmml">q</mi><mi id="A3.p1.2.m2.1.2.3.2.3" xref="A3.p1.2.m2.1.2.3.2.3.cmml">t</mi><msub id="A3.p1.2.m2.1.2.3.3" xref="A3.p1.2.m2.1.2.3.3.cmml"><mi id="A3.p1.2.m2.1.2.3.3.2" xref="A3.p1.2.m2.1.2.3.3.2.cmml">α</mi><mi id="A3.p1.2.m2.1.2.3.3.3" xref="A3.p1.2.m2.1.2.3.3.3.cmml">t</mi></msub></msubsup><mo id="A3.p1.2.m2.1.2.1a" xref="A3.p1.2.m2.1.2.1.cmml">⁢</mo><mrow id="A3.p1.2.m2.1.2.4.2" xref="A3.p1.2.m2.1.2.cmml"><mo id="A3.p1.2.m2.1.2.4.2.1" stretchy="false" xref="A3.p1.2.m2.1.2.cmml">(</mo><mi id="A3.p1.2.m2.1.1" xref="A3.p1.2.m2.1.1.cmml">𝐱</mi><mo id="A3.p1.2.m2.1.2.4.2.2" stretchy="false" xref="A3.p1.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.2.m2.1b"><apply id="A3.p1.2.m2.1.2.cmml" xref="A3.p1.2.m2.1.2"><times id="A3.p1.2.m2.1.2.1.cmml" xref="A3.p1.2.m2.1.2.1"></times><ci id="A3.p1.2.m2.1.2.2.cmml" xref="A3.p1.2.m2.1.2.2">𝛿</ci><apply id="A3.p1.2.m2.1.2.3.cmml" xref="A3.p1.2.m2.1.2.3"><csymbol cd="ambiguous" id="A3.p1.2.m2.1.2.3.1.cmml" xref="A3.p1.2.m2.1.2.3">superscript</csymbol><apply id="A3.p1.2.m2.1.2.3.2.cmml" xref="A3.p1.2.m2.1.2.3"><csymbol cd="ambiguous" id="A3.p1.2.m2.1.2.3.2.1.cmml" xref="A3.p1.2.m2.1.2.3">subscript</csymbol><ci id="A3.p1.2.m2.1.2.3.2.2.cmml" xref="A3.p1.2.m2.1.2.3.2.2">𝑞</ci><ci id="A3.p1.2.m2.1.2.3.2.3.cmml" xref="A3.p1.2.m2.1.2.3.2.3">𝑡</ci></apply><apply id="A3.p1.2.m2.1.2.3.3.cmml" xref="A3.p1.2.m2.1.2.3.3"><csymbol cd="ambiguous" id="A3.p1.2.m2.1.2.3.3.1.cmml" xref="A3.p1.2.m2.1.2.3.3">subscript</csymbol><ci id="A3.p1.2.m2.1.2.3.3.2.cmml" xref="A3.p1.2.m2.1.2.3.3.2">𝛼</ci><ci id="A3.p1.2.m2.1.2.3.3.3.cmml" xref="A3.p1.2.m2.1.2.3.3.3">𝑡</ci></apply></apply><ci id="A3.p1.2.m2.1.1.cmml" xref="A3.p1.2.m2.1.1">𝐱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.2.m2.1c">\delta q_{t}^{\alpha_{t}}(\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="A3.p1.2.m2.1d">italic_δ italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ( bold_x )</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="A3.E61">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\tilde{q}_{t}(\mathbf{x})=\tilde{q}_{t-1}(\mathbf{x})\cdot\delta q_{t}^{\alpha%
_{t}}(\mathbf{x})\,." class="ltx_Math" display="block" id="A3.E61.m1.4"><semantics id="A3.E61.m1.4a"><mrow id="A3.E61.m1.4.4.1" xref="A3.E61.m1.4.4.1.1.cmml"><mrow id="A3.E61.m1.4.4.1.1" xref="A3.E61.m1.4.4.1.1.cmml"><mrow id="A3.E61.m1.4.4.1.1.2" xref="A3.E61.m1.4.4.1.1.2.cmml"><msub id="A3.E61.m1.4.4.1.1.2.2" xref="A3.E61.m1.4.4.1.1.2.2.cmml"><mover accent="true" id="A3.E61.m1.4.4.1.1.2.2.2" xref="A3.E61.m1.4.4.1.1.2.2.2.cmml"><mi id="A3.E61.m1.4.4.1.1.2.2.2.2" xref="A3.E61.m1.4.4.1.1.2.2.2.2.cmml">q</mi><mo id="A3.E61.m1.4.4.1.1.2.2.2.1" xref="A3.E61.m1.4.4.1.1.2.2.2.1.cmml">~</mo></mover><mi id="A3.E61.m1.4.4.1.1.2.2.3" xref="A3.E61.m1.4.4.1.1.2.2.3.cmml">t</mi></msub><mo id="A3.E61.m1.4.4.1.1.2.1" xref="A3.E61.m1.4.4.1.1.2.1.cmml">⁢</mo><mrow id="A3.E61.m1.4.4.1.1.2.3.2" xref="A3.E61.m1.4.4.1.1.2.cmml"><mo id="A3.E61.m1.4.4.1.1.2.3.2.1" stretchy="false" xref="A3.E61.m1.4.4.1.1.2.cmml">(</mo><mi id="A3.E61.m1.1.1" xref="A3.E61.m1.1.1.cmml">𝐱</mi><mo id="A3.E61.m1.4.4.1.1.2.3.2.2" stretchy="false" xref="A3.E61.m1.4.4.1.1.2.cmml">)</mo></mrow></mrow><mo id="A3.E61.m1.4.4.1.1.1" xref="A3.E61.m1.4.4.1.1.1.cmml">=</mo><mrow id="A3.E61.m1.4.4.1.1.3" xref="A3.E61.m1.4.4.1.1.3.cmml"><mrow id="A3.E61.m1.4.4.1.1.3.2" xref="A3.E61.m1.4.4.1.1.3.2.cmml"><mrow id="A3.E61.m1.4.4.1.1.3.2.2" xref="A3.E61.m1.4.4.1.1.3.2.2.cmml"><msub id="A3.E61.m1.4.4.1.1.3.2.2.2" xref="A3.E61.m1.4.4.1.1.3.2.2.2.cmml"><mover accent="true" id="A3.E61.m1.4.4.1.1.3.2.2.2.2" xref="A3.E61.m1.4.4.1.1.3.2.2.2.2.cmml"><mi id="A3.E61.m1.4.4.1.1.3.2.2.2.2.2" xref="A3.E61.m1.4.4.1.1.3.2.2.2.2.2.cmml">q</mi><mo id="A3.E61.m1.4.4.1.1.3.2.2.2.2.1" xref="A3.E61.m1.4.4.1.1.3.2.2.2.2.1.cmml">~</mo></mover><mrow id="A3.E61.m1.4.4.1.1.3.2.2.2.3" xref="A3.E61.m1.4.4.1.1.3.2.2.2.3.cmml"><mi id="A3.E61.m1.4.4.1.1.3.2.2.2.3.2" xref="A3.E61.m1.4.4.1.1.3.2.2.2.3.2.cmml">t</mi><mo id="A3.E61.m1.4.4.1.1.3.2.2.2.3.1" xref="A3.E61.m1.4.4.1.1.3.2.2.2.3.1.cmml">−</mo><mn id="A3.E61.m1.4.4.1.1.3.2.2.2.3.3" xref="A3.E61.m1.4.4.1.1.3.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="A3.E61.m1.4.4.1.1.3.2.2.1" xref="A3.E61.m1.4.4.1.1.3.2.2.1.cmml">⁢</mo><mrow id="A3.E61.m1.4.4.1.1.3.2.2.3.2" xref="A3.E61.m1.4.4.1.1.3.2.2.cmml"><mo id="A3.E61.m1.4.4.1.1.3.2.2.3.2.1" stretchy="false" xref="A3.E61.m1.4.4.1.1.3.2.2.cmml">(</mo><mi id="A3.E61.m1.2.2" xref="A3.E61.m1.2.2.cmml">𝐱</mi><mo id="A3.E61.m1.4.4.1.1.3.2.2.3.2.2" rspace="0.055em" stretchy="false" xref="A3.E61.m1.4.4.1.1.3.2.2.cmml">)</mo></mrow></mrow><mo id="A3.E61.m1.4.4.1.1.3.2.1" rspace="0.222em" xref="A3.E61.m1.4.4.1.1.3.2.1.cmml">⋅</mo><mi id="A3.E61.m1.4.4.1.1.3.2.3" xref="A3.E61.m1.4.4.1.1.3.2.3.cmml">δ</mi></mrow><mo id="A3.E61.m1.4.4.1.1.3.1" xref="A3.E61.m1.4.4.1.1.3.1.cmml">⁢</mo><msubsup id="A3.E61.m1.4.4.1.1.3.3" xref="A3.E61.m1.4.4.1.1.3.3.cmml"><mi id="A3.E61.m1.4.4.1.1.3.3.2.2" xref="A3.E61.m1.4.4.1.1.3.3.2.2.cmml">q</mi><mi id="A3.E61.m1.4.4.1.1.3.3.2.3" xref="A3.E61.m1.4.4.1.1.3.3.2.3.cmml">t</mi><msub id="A3.E61.m1.4.4.1.1.3.3.3" xref="A3.E61.m1.4.4.1.1.3.3.3.cmml"><mi id="A3.E61.m1.4.4.1.1.3.3.3.2" xref="A3.E61.m1.4.4.1.1.3.3.3.2.cmml">α</mi><mi id="A3.E61.m1.4.4.1.1.3.3.3.3" xref="A3.E61.m1.4.4.1.1.3.3.3.3.cmml">t</mi></msub></msubsup><mo id="A3.E61.m1.4.4.1.1.3.1a" xref="A3.E61.m1.4.4.1.1.3.1.cmml">⁢</mo><mrow id="A3.E61.m1.4.4.1.1.3.4.2" xref="A3.E61.m1.4.4.1.1.3.cmml"><mo id="A3.E61.m1.4.4.1.1.3.4.2.1" stretchy="false" xref="A3.E61.m1.4.4.1.1.3.cmml">(</mo><mi id="A3.E61.m1.3.3" xref="A3.E61.m1.3.3.cmml">𝐱</mi><mo id="A3.E61.m1.4.4.1.1.3.4.2.2" stretchy="false" xref="A3.E61.m1.4.4.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="A3.E61.m1.4.4.1.2" lspace="0.170em" xref="A3.E61.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E61.m1.4b"><apply id="A3.E61.m1.4.4.1.1.cmml" xref="A3.E61.m1.4.4.1"><eq id="A3.E61.m1.4.4.1.1.1.cmml" xref="A3.E61.m1.4.4.1.1.1"></eq><apply id="A3.E61.m1.4.4.1.1.2.cmml" xref="A3.E61.m1.4.4.1.1.2"><times id="A3.E61.m1.4.4.1.1.2.1.cmml" xref="A3.E61.m1.4.4.1.1.2.1"></times><apply id="A3.E61.m1.4.4.1.1.2.2.cmml" xref="A3.E61.m1.4.4.1.1.2.2"><csymbol cd="ambiguous" id="A3.E61.m1.4.4.1.1.2.2.1.cmml" xref="A3.E61.m1.4.4.1.1.2.2">subscript</csymbol><apply id="A3.E61.m1.4.4.1.1.2.2.2.cmml" xref="A3.E61.m1.4.4.1.1.2.2.2"><ci id="A3.E61.m1.4.4.1.1.2.2.2.1.cmml" xref="A3.E61.m1.4.4.1.1.2.2.2.1">~</ci><ci id="A3.E61.m1.4.4.1.1.2.2.2.2.cmml" xref="A3.E61.m1.4.4.1.1.2.2.2.2">𝑞</ci></apply><ci id="A3.E61.m1.4.4.1.1.2.2.3.cmml" xref="A3.E61.m1.4.4.1.1.2.2.3">𝑡</ci></apply><ci id="A3.E61.m1.1.1.cmml" xref="A3.E61.m1.1.1">𝐱</ci></apply><apply id="A3.E61.m1.4.4.1.1.3.cmml" xref="A3.E61.m1.4.4.1.1.3"><times id="A3.E61.m1.4.4.1.1.3.1.cmml" xref="A3.E61.m1.4.4.1.1.3.1"></times><apply id="A3.E61.m1.4.4.1.1.3.2.cmml" xref="A3.E61.m1.4.4.1.1.3.2"><ci id="A3.E61.m1.4.4.1.1.3.2.1.cmml" xref="A3.E61.m1.4.4.1.1.3.2.1">⋅</ci><apply id="A3.E61.m1.4.4.1.1.3.2.2.cmml" xref="A3.E61.m1.4.4.1.1.3.2.2"><times id="A3.E61.m1.4.4.1.1.3.2.2.1.cmml" xref="A3.E61.m1.4.4.1.1.3.2.2.1"></times><apply id="A3.E61.m1.4.4.1.1.3.2.2.2.cmml" xref="A3.E61.m1.4.4.1.1.3.2.2.2"><csymbol cd="ambiguous" id="A3.E61.m1.4.4.1.1.3.2.2.2.1.cmml" xref="A3.E61.m1.4.4.1.1.3.2.2.2">subscript</csymbol><apply id="A3.E61.m1.4.4.1.1.3.2.2.2.2.cmml" xref="A3.E61.m1.4.4.1.1.3.2.2.2.2"><ci id="A3.E61.m1.4.4.1.1.3.2.2.2.2.1.cmml" xref="A3.E61.m1.4.4.1.1.3.2.2.2.2.1">~</ci><ci id="A3.E61.m1.4.4.1.1.3.2.2.2.2.2.cmml" xref="A3.E61.m1.4.4.1.1.3.2.2.2.2.2">𝑞</ci></apply><apply id="A3.E61.m1.4.4.1.1.3.2.2.2.3.cmml" xref="A3.E61.m1.4.4.1.1.3.2.2.2.3"><minus id="A3.E61.m1.4.4.1.1.3.2.2.2.3.1.cmml" xref="A3.E61.m1.4.4.1.1.3.2.2.2.3.1"></minus><ci id="A3.E61.m1.4.4.1.1.3.2.2.2.3.2.cmml" xref="A3.E61.m1.4.4.1.1.3.2.2.2.3.2">𝑡</ci><cn id="A3.E61.m1.4.4.1.1.3.2.2.2.3.3.cmml" type="integer" xref="A3.E61.m1.4.4.1.1.3.2.2.2.3.3">1</cn></apply></apply><ci id="A3.E61.m1.2.2.cmml" xref="A3.E61.m1.2.2">𝐱</ci></apply><ci id="A3.E61.m1.4.4.1.1.3.2.3.cmml" xref="A3.E61.m1.4.4.1.1.3.2.3">𝛿</ci></apply><apply id="A3.E61.m1.4.4.1.1.3.3.cmml" xref="A3.E61.m1.4.4.1.1.3.3"><csymbol cd="ambiguous" id="A3.E61.m1.4.4.1.1.3.3.1.cmml" xref="A3.E61.m1.4.4.1.1.3.3">superscript</csymbol><apply id="A3.E61.m1.4.4.1.1.3.3.2.cmml" xref="A3.E61.m1.4.4.1.1.3.3"><csymbol cd="ambiguous" id="A3.E61.m1.4.4.1.1.3.3.2.1.cmml" xref="A3.E61.m1.4.4.1.1.3.3">subscript</csymbol><ci id="A3.E61.m1.4.4.1.1.3.3.2.2.cmml" xref="A3.E61.m1.4.4.1.1.3.3.2.2">𝑞</ci><ci id="A3.E61.m1.4.4.1.1.3.3.2.3.cmml" xref="A3.E61.m1.4.4.1.1.3.3.2.3">𝑡</ci></apply><apply id="A3.E61.m1.4.4.1.1.3.3.3.cmml" xref="A3.E61.m1.4.4.1.1.3.3.3"><csymbol cd="ambiguous" id="A3.E61.m1.4.4.1.1.3.3.3.1.cmml" xref="A3.E61.m1.4.4.1.1.3.3.3">subscript</csymbol><ci id="A3.E61.m1.4.4.1.1.3.3.3.2.cmml" xref="A3.E61.m1.4.4.1.1.3.3.3.2">𝛼</ci><ci id="A3.E61.m1.4.4.1.1.3.3.3.3.cmml" xref="A3.E61.m1.4.4.1.1.3.3.3.3">𝑡</ci></apply></apply><ci id="A3.E61.m1.3.3.cmml" xref="A3.E61.m1.3.3">𝐱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E61.m1.4c">\tilde{q}_{t}(\mathbf{x})=\tilde{q}_{t-1}(\mathbf{x})\cdot\delta q_{t}^{\alpha%
_{t}}(\mathbf{x})\,.</annotation><annotation encoding="application/x-llamapun" id="A3.E61.m1.4d">over~ start_ARG italic_q end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_x ) = over~ start_ARG italic_q end_ARG start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT ( bold_x ) ⋅ italic_δ italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ( bold_x ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(61)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A3.p1.7">For our proposed NRGBoost, this factor is chosen in order to maximize a local quadratic approximation of the log likelihood around <math alttext="q_{t-1}" class="ltx_Math" display="inline" id="A3.p1.3.m1.1"><semantics id="A3.p1.3.m1.1a"><msub id="A3.p1.3.m1.1.1" xref="A3.p1.3.m1.1.1.cmml"><mi id="A3.p1.3.m1.1.1.2" xref="A3.p1.3.m1.1.1.2.cmml">q</mi><mrow id="A3.p1.3.m1.1.1.3" xref="A3.p1.3.m1.1.1.3.cmml"><mi id="A3.p1.3.m1.1.1.3.2" xref="A3.p1.3.m1.1.1.3.2.cmml">t</mi><mo id="A3.p1.3.m1.1.1.3.1" xref="A3.p1.3.m1.1.1.3.1.cmml">−</mo><mn id="A3.p1.3.m1.1.1.3.3" xref="A3.p1.3.m1.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="A3.p1.3.m1.1b"><apply id="A3.p1.3.m1.1.1.cmml" xref="A3.p1.3.m1.1.1"><csymbol cd="ambiguous" id="A3.p1.3.m1.1.1.1.cmml" xref="A3.p1.3.m1.1.1">subscript</csymbol><ci id="A3.p1.3.m1.1.1.2.cmml" xref="A3.p1.3.m1.1.1.2">𝑞</ci><apply id="A3.p1.3.m1.1.1.3.cmml" xref="A3.p1.3.m1.1.1.3"><minus id="A3.p1.3.m1.1.1.3.1.cmml" xref="A3.p1.3.m1.1.1.3.1"></minus><ci id="A3.p1.3.m1.1.1.3.2.cmml" xref="A3.p1.3.m1.1.1.3.2">𝑡</ci><cn id="A3.p1.3.m1.1.1.3.3.cmml" type="integer" xref="A3.p1.3.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.3.m1.1c">q_{t-1}</annotation><annotation encoding="application/x-llamapun" id="A3.p1.3.m1.1d">italic_q start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT</annotation></semantics></math> as a functional of the log density (see Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S3" title="3 NRGBoost ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">3</span></a>).
The motivation behind the greedy approach of <cite class="ltx_cite ltx_citemacro_citet">Tu (<a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib28" title="">2007</a>)</cite> or <cite class="ltx_cite ltx_citemacro_citet">Grover &amp; Ermon (<a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib14" title="">2018</a>)</cite> is to instead make the update factor <math alttext="\delta q_{t}(\mathbf{x})" class="ltx_Math" display="inline" id="A3.p1.4.m2.1"><semantics id="A3.p1.4.m2.1a"><mrow id="A3.p1.4.m2.1.2" xref="A3.p1.4.m2.1.2.cmml"><mi id="A3.p1.4.m2.1.2.2" xref="A3.p1.4.m2.1.2.2.cmml">δ</mi><mo id="A3.p1.4.m2.1.2.1" xref="A3.p1.4.m2.1.2.1.cmml">⁢</mo><msub id="A3.p1.4.m2.1.2.3" xref="A3.p1.4.m2.1.2.3.cmml"><mi id="A3.p1.4.m2.1.2.3.2" xref="A3.p1.4.m2.1.2.3.2.cmml">q</mi><mi id="A3.p1.4.m2.1.2.3.3" xref="A3.p1.4.m2.1.2.3.3.cmml">t</mi></msub><mo id="A3.p1.4.m2.1.2.1a" xref="A3.p1.4.m2.1.2.1.cmml">⁢</mo><mrow id="A3.p1.4.m2.1.2.4.2" xref="A3.p1.4.m2.1.2.cmml"><mo id="A3.p1.4.m2.1.2.4.2.1" stretchy="false" xref="A3.p1.4.m2.1.2.cmml">(</mo><mi id="A3.p1.4.m2.1.1" xref="A3.p1.4.m2.1.1.cmml">𝐱</mi><mo id="A3.p1.4.m2.1.2.4.2.2" stretchy="false" xref="A3.p1.4.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.4.m2.1b"><apply id="A3.p1.4.m2.1.2.cmml" xref="A3.p1.4.m2.1.2"><times id="A3.p1.4.m2.1.2.1.cmml" xref="A3.p1.4.m2.1.2.1"></times><ci id="A3.p1.4.m2.1.2.2.cmml" xref="A3.p1.4.m2.1.2.2">𝛿</ci><apply id="A3.p1.4.m2.1.2.3.cmml" xref="A3.p1.4.m2.1.2.3"><csymbol cd="ambiguous" id="A3.p1.4.m2.1.2.3.1.cmml" xref="A3.p1.4.m2.1.2.3">subscript</csymbol><ci id="A3.p1.4.m2.1.2.3.2.cmml" xref="A3.p1.4.m2.1.2.3.2">𝑞</ci><ci id="A3.p1.4.m2.1.2.3.3.cmml" xref="A3.p1.4.m2.1.2.3.3">𝑡</ci></apply><ci id="A3.p1.4.m2.1.1.cmml" xref="A3.p1.4.m2.1.1">𝐱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.4.m2.1c">\delta q_{t}(\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="A3.p1.4.m2.1d">italic_δ italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_x )</annotation></semantics></math> proportional to the likelihood ratio <math alttext="r_{t}(\mathbf{x})\coloneqq\nicefrac{{p(\mathbf{x})}}{{q_{t-1}(\mathbf{x})}}" class="ltx_Math" display="inline" id="A3.p1.5.m3.3"><semantics id="A3.p1.5.m3.3a"><mrow id="A3.p1.5.m3.3.4" xref="A3.p1.5.m3.3.4.cmml"><mrow id="A3.p1.5.m3.3.4.2" xref="A3.p1.5.m3.3.4.2.cmml"><msub id="A3.p1.5.m3.3.4.2.2" xref="A3.p1.5.m3.3.4.2.2.cmml"><mi id="A3.p1.5.m3.3.4.2.2.2" xref="A3.p1.5.m3.3.4.2.2.2.cmml">r</mi><mi id="A3.p1.5.m3.3.4.2.2.3" xref="A3.p1.5.m3.3.4.2.2.3.cmml">t</mi></msub><mo id="A3.p1.5.m3.3.4.2.1" xref="A3.p1.5.m3.3.4.2.1.cmml">⁢</mo><mrow id="A3.p1.5.m3.3.4.2.3.2" xref="A3.p1.5.m3.3.4.2.cmml"><mo id="A3.p1.5.m3.3.4.2.3.2.1" stretchy="false" xref="A3.p1.5.m3.3.4.2.cmml">(</mo><mi id="A3.p1.5.m3.3.3" xref="A3.p1.5.m3.3.3.cmml">𝐱</mi><mo id="A3.p1.5.m3.3.4.2.3.2.2" stretchy="false" xref="A3.p1.5.m3.3.4.2.cmml">)</mo></mrow></mrow><mo id="A3.p1.5.m3.3.4.1" xref="A3.p1.5.m3.3.4.1.cmml">≔</mo><mrow id="A3.p1.5.m3.2.2" xref="A3.p1.5.m3.2.2.cmml"><mpadded id="A3.p1.5.m3.1.1.1" voffset="0.3em" xref="A3.p1.5.m3.1.1.1.cmml"><mi id="A3.p1.5.m3.1.1.1.3" mathsize="70%" xref="A3.p1.5.m3.1.1.1.3.cmml">p</mi><mo id="A3.p1.5.m3.1.1.1.2" xref="A3.p1.5.m3.1.1.1.2.cmml">⁢</mo><mrow id="A3.p1.5.m3.1.1.1.4.2" xref="A3.p1.5.m3.1.1.1.cmml"><mo id="A3.p1.5.m3.1.1.1.4.2.1" maxsize="70%" minsize="70%" xref="A3.p1.5.m3.1.1.1.cmml">(</mo><mi id="A3.p1.5.m3.1.1.1.1" mathsize="70%" xref="A3.p1.5.m3.1.1.1.1.cmml">𝐱</mi><mo id="A3.p1.5.m3.1.1.1.4.2.2" maxsize="70%" minsize="70%" xref="A3.p1.5.m3.1.1.1.cmml">)</mo></mrow></mpadded><mpadded id="A3.p1.5.m3.2.2.3" lspace="-0.1em" width="-0.15em" xref="A3.p1.5.m3.2.2.3.cmml"><mo id="A3.p1.5.m3.2.2.3a" stretchy="true" symmetric="true" xref="A3.p1.5.m3.2.2.3.cmml">/</mo></mpadded><mrow id="A3.p1.5.m3.2.2.2" xref="A3.p1.5.m3.2.2.2.cmml"><msub id="A3.p1.5.m3.2.2.2.3" xref="A3.p1.5.m3.2.2.2.3.cmml"><mi id="A3.p1.5.m3.2.2.2.3.2" mathsize="70%" xref="A3.p1.5.m3.2.2.2.3.2.cmml">q</mi><mrow id="A3.p1.5.m3.2.2.2.3.3" xref="A3.p1.5.m3.2.2.2.3.3.cmml"><mi id="A3.p1.5.m3.2.2.2.3.3.2" mathsize="71%" xref="A3.p1.5.m3.2.2.2.3.3.2.cmml">t</mi><mo id="A3.p1.5.m3.2.2.2.3.3.1" mathsize="71%" xref="A3.p1.5.m3.2.2.2.3.3.1.cmml">−</mo><mn id="A3.p1.5.m3.2.2.2.3.3.3" mathsize="71%" xref="A3.p1.5.m3.2.2.2.3.3.3.cmml">1</mn></mrow></msub><mo id="A3.p1.5.m3.2.2.2.2" xref="A3.p1.5.m3.2.2.2.2.cmml">⁢</mo><mrow id="A3.p1.5.m3.2.2.2.4.2" xref="A3.p1.5.m3.2.2.2.cmml"><mo id="A3.p1.5.m3.2.2.2.4.2.1" maxsize="70%" minsize="70%" xref="A3.p1.5.m3.2.2.2.cmml">(</mo><mi id="A3.p1.5.m3.2.2.2.1" mathsize="70%" xref="A3.p1.5.m3.2.2.2.1.cmml">𝐱</mi><mo id="A3.p1.5.m3.2.2.2.4.2.2" maxsize="70%" minsize="70%" xref="A3.p1.5.m3.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.5.m3.3b"><apply id="A3.p1.5.m3.3.4.cmml" xref="A3.p1.5.m3.3.4"><ci id="A3.p1.5.m3.3.4.1.cmml" xref="A3.p1.5.m3.3.4.1">≔</ci><apply id="A3.p1.5.m3.3.4.2.cmml" xref="A3.p1.5.m3.3.4.2"><times id="A3.p1.5.m3.3.4.2.1.cmml" xref="A3.p1.5.m3.3.4.2.1"></times><apply id="A3.p1.5.m3.3.4.2.2.cmml" xref="A3.p1.5.m3.3.4.2.2"><csymbol cd="ambiguous" id="A3.p1.5.m3.3.4.2.2.1.cmml" xref="A3.p1.5.m3.3.4.2.2">subscript</csymbol><ci id="A3.p1.5.m3.3.4.2.2.2.cmml" xref="A3.p1.5.m3.3.4.2.2.2">𝑟</ci><ci id="A3.p1.5.m3.3.4.2.2.3.cmml" xref="A3.p1.5.m3.3.4.2.2.3">𝑡</ci></apply><ci id="A3.p1.5.m3.3.3.cmml" xref="A3.p1.5.m3.3.3">𝐱</ci></apply><apply id="A3.p1.5.m3.2.2.cmml" xref="A3.p1.5.m3.2.2"><divide id="A3.p1.5.m3.2.2.3.cmml" xref="A3.p1.5.m3.2.2.3"></divide><apply id="A3.p1.5.m3.1.1.1.cmml" xref="A3.p1.5.m3.1.1.1"><times id="A3.p1.5.m3.1.1.1.2.cmml" xref="A3.p1.5.m3.1.1.1.2"></times><ci id="A3.p1.5.m3.1.1.1.3.cmml" xref="A3.p1.5.m3.1.1.1.3">𝑝</ci><ci id="A3.p1.5.m3.1.1.1.1.cmml" xref="A3.p1.5.m3.1.1.1.1">𝐱</ci></apply><apply id="A3.p1.5.m3.2.2.2.cmml" xref="A3.p1.5.m3.2.2.2"><times id="A3.p1.5.m3.2.2.2.2.cmml" xref="A3.p1.5.m3.2.2.2.2"></times><apply id="A3.p1.5.m3.2.2.2.3.cmml" xref="A3.p1.5.m3.2.2.2.3"><csymbol cd="ambiguous" id="A3.p1.5.m3.2.2.2.3.1.cmml" xref="A3.p1.5.m3.2.2.2.3">subscript</csymbol><ci id="A3.p1.5.m3.2.2.2.3.2.cmml" xref="A3.p1.5.m3.2.2.2.3.2">𝑞</ci><apply id="A3.p1.5.m3.2.2.2.3.3.cmml" xref="A3.p1.5.m3.2.2.2.3.3"><minus id="A3.p1.5.m3.2.2.2.3.3.1.cmml" xref="A3.p1.5.m3.2.2.2.3.3.1"></minus><ci id="A3.p1.5.m3.2.2.2.3.3.2.cmml" xref="A3.p1.5.m3.2.2.2.3.3.2">𝑡</ci><cn id="A3.p1.5.m3.2.2.2.3.3.3.cmml" type="integer" xref="A3.p1.5.m3.2.2.2.3.3.3">1</cn></apply></apply><ci id="A3.p1.5.m3.2.2.2.1.cmml" xref="A3.p1.5.m3.2.2.2.1">𝐱</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.5.m3.3c">r_{t}(\mathbf{x})\coloneqq\nicefrac{{p(\mathbf{x})}}{{q_{t-1}(\mathbf{x})}}</annotation><annotation encoding="application/x-llamapun" id="A3.p1.5.m3.3d">italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_x ) ≔ / start_ARG italic_p ( bold_x ) end_ARG start_ARG italic_q start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT ( bold_x ) end_ARG</annotation></semantics></math> directly,
which under ideal conditions would mean that the method converges immediately when choosing a step size <math alttext="\alpha_{t}=1" class="ltx_Math" display="inline" id="A3.p1.6.m4.1"><semantics id="A3.p1.6.m4.1a"><mrow id="A3.p1.6.m4.1.1" xref="A3.p1.6.m4.1.1.cmml"><msub id="A3.p1.6.m4.1.1.2" xref="A3.p1.6.m4.1.1.2.cmml"><mi id="A3.p1.6.m4.1.1.2.2" xref="A3.p1.6.m4.1.1.2.2.cmml">α</mi><mi id="A3.p1.6.m4.1.1.2.3" xref="A3.p1.6.m4.1.1.2.3.cmml">t</mi></msub><mo id="A3.p1.6.m4.1.1.1" xref="A3.p1.6.m4.1.1.1.cmml">=</mo><mn id="A3.p1.6.m4.1.1.3" xref="A3.p1.6.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.6.m4.1b"><apply id="A3.p1.6.m4.1.1.cmml" xref="A3.p1.6.m4.1.1"><eq id="A3.p1.6.m4.1.1.1.cmml" xref="A3.p1.6.m4.1.1.1"></eq><apply id="A3.p1.6.m4.1.1.2.cmml" xref="A3.p1.6.m4.1.1.2"><csymbol cd="ambiguous" id="A3.p1.6.m4.1.1.2.1.cmml" xref="A3.p1.6.m4.1.1.2">subscript</csymbol><ci id="A3.p1.6.m4.1.1.2.2.cmml" xref="A3.p1.6.m4.1.1.2.2">𝛼</ci><ci id="A3.p1.6.m4.1.1.2.3.cmml" xref="A3.p1.6.m4.1.1.2.3">𝑡</ci></apply><cn id="A3.p1.6.m4.1.1.3.cmml" type="integer" xref="A3.p1.6.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.6.m4.1c">\alpha_{t}=1</annotation><annotation encoding="application/x-llamapun" id="A3.p1.6.m4.1d">italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = 1</annotation></semantics></math>.
In a more realistic setting, however, this method has been shown to converge under conditions on the performance of the individual <math alttext="\delta q_{t}" class="ltx_Math" display="inline" id="A3.p1.7.m5.1"><semantics id="A3.p1.7.m5.1a"><mrow id="A3.p1.7.m5.1.1" xref="A3.p1.7.m5.1.1.cmml"><mi id="A3.p1.7.m5.1.1.2" xref="A3.p1.7.m5.1.1.2.cmml">δ</mi><mo id="A3.p1.7.m5.1.1.1" xref="A3.p1.7.m5.1.1.1.cmml">⁢</mo><msub id="A3.p1.7.m5.1.1.3" xref="A3.p1.7.m5.1.1.3.cmml"><mi id="A3.p1.7.m5.1.1.3.2" xref="A3.p1.7.m5.1.1.3.2.cmml">q</mi><mi id="A3.p1.7.m5.1.1.3.3" xref="A3.p1.7.m5.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.7.m5.1b"><apply id="A3.p1.7.m5.1.1.cmml" xref="A3.p1.7.m5.1.1"><times id="A3.p1.7.m5.1.1.1.cmml" xref="A3.p1.7.m5.1.1.1"></times><ci id="A3.p1.7.m5.1.1.2.cmml" xref="A3.p1.7.m5.1.1.2">𝛿</ci><apply id="A3.p1.7.m5.1.1.3.cmml" xref="A3.p1.7.m5.1.1.3"><csymbol cd="ambiguous" id="A3.p1.7.m5.1.1.3.1.cmml" xref="A3.p1.7.m5.1.1.3">subscript</csymbol><ci id="A3.p1.7.m5.1.1.3.2.cmml" xref="A3.p1.7.m5.1.1.3.2">𝑞</ci><ci id="A3.p1.7.m5.1.1.3.3.cmml" xref="A3.p1.7.m5.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.7.m5.1c">\delta q_{t}</annotation><annotation encoding="application/x-llamapun" id="A3.p1.7.m5.1d">italic_δ italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> as discriminators between real and generated data <cite class="ltx_cite ltx_citemacro_citep">(Tu, <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib28" title="">2007</a>; Grover &amp; Ermon, <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib14" title="">2018</a>; Cranko &amp; Nock, <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib6" title="">2019</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="A3.p2">
<p class="ltx_p" id="A3.p2.2">While in principle this desired <math alttext="r_{t}(\mathbf{x})" class="ltx_Math" display="inline" id="A3.p2.1.m1.1"><semantics id="A3.p2.1.m1.1a"><mrow id="A3.p2.1.m1.1.2" xref="A3.p2.1.m1.1.2.cmml"><msub id="A3.p2.1.m1.1.2.2" xref="A3.p2.1.m1.1.2.2.cmml"><mi id="A3.p2.1.m1.1.2.2.2" xref="A3.p2.1.m1.1.2.2.2.cmml">r</mi><mi id="A3.p2.1.m1.1.2.2.3" xref="A3.p2.1.m1.1.2.2.3.cmml">t</mi></msub><mo id="A3.p2.1.m1.1.2.1" xref="A3.p2.1.m1.1.2.1.cmml">⁢</mo><mrow id="A3.p2.1.m1.1.2.3.2" xref="A3.p2.1.m1.1.2.cmml"><mo id="A3.p2.1.m1.1.2.3.2.1" stretchy="false" xref="A3.p2.1.m1.1.2.cmml">(</mo><mi id="A3.p2.1.m1.1.1" xref="A3.p2.1.m1.1.1.cmml">𝐱</mi><mo id="A3.p2.1.m1.1.2.3.2.2" stretchy="false" xref="A3.p2.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.p2.1.m1.1b"><apply id="A3.p2.1.m1.1.2.cmml" xref="A3.p2.1.m1.1.2"><times id="A3.p2.1.m1.1.2.1.cmml" xref="A3.p2.1.m1.1.2.1"></times><apply id="A3.p2.1.m1.1.2.2.cmml" xref="A3.p2.1.m1.1.2.2"><csymbol cd="ambiguous" id="A3.p2.1.m1.1.2.2.1.cmml" xref="A3.p2.1.m1.1.2.2">subscript</csymbol><ci id="A3.p2.1.m1.1.2.2.2.cmml" xref="A3.p2.1.m1.1.2.2.2">𝑟</ci><ci id="A3.p2.1.m1.1.2.2.3.cmml" xref="A3.p2.1.m1.1.2.2.3">𝑡</ci></apply><ci id="A3.p2.1.m1.1.1.cmml" xref="A3.p2.1.m1.1.1">𝐱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.1.m1.1c">r_{t}(\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="A3.p2.1.m1.1d">italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_x )</annotation></semantics></math> could be derived from any binary classifier that is trained to predict a probability of a datapoint being generated (e.g., by training it to minimize a strictly proper loss)
and <cite class="ltx_cite ltx_citemacro_citet">Tu (<a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib28" title="">2007</a>)</cite> does not prescribe any particular choice, <cite class="ltx_cite ltx_citemacro_citet">Grover &amp; Ermon (<a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib14" title="">2018</a>)</cite> propose relying on the following variational bound of an <math alttext="f" class="ltx_Math" display="inline" id="A3.p2.2.m2.1"><semantics id="A3.p2.2.m2.1a"><mi id="A3.p2.2.m2.1.1" xref="A3.p2.2.m2.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="A3.p2.2.m2.1b"><ci id="A3.p2.2.m2.1.1.cmml" xref="A3.p2.2.m2.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.2.m2.1c">f</annotation><annotation encoding="application/x-llamapun" id="A3.p2.2.m2.1d">italic_f</annotation></semantics></math>-divergence to derive an estimator for this ratio:</p>
<table class="ltx_equation ltx_eqn_table" id="A3.E62">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="D_{f}(P\|Q_{t-1})\geq\sup_{u\in\mathcal{U}_{t}}\left[\mathbb{E}_{\mathbf{x}%
\sim p}\;u(\mathbf{x})-\mathbb{E}_{\mathbf{x}\sim q_{t-1}}f^{*}(u(\mathbf{x}))%
\right]\,." class="ltx_Math" display="block" id="A3.E62.m1.3"><semantics id="A3.E62.m1.3a"><mrow id="A3.E62.m1.3.3.1" xref="A3.E62.m1.3.3.1.1.cmml"><mrow id="A3.E62.m1.3.3.1.1" xref="A3.E62.m1.3.3.1.1.cmml"><mrow id="A3.E62.m1.3.3.1.1.1" xref="A3.E62.m1.3.3.1.1.1.cmml"><msub id="A3.E62.m1.3.3.1.1.1.3" xref="A3.E62.m1.3.3.1.1.1.3.cmml"><mi id="A3.E62.m1.3.3.1.1.1.3.2" xref="A3.E62.m1.3.3.1.1.1.3.2.cmml">D</mi><mi id="A3.E62.m1.3.3.1.1.1.3.3" xref="A3.E62.m1.3.3.1.1.1.3.3.cmml">f</mi></msub><mo id="A3.E62.m1.3.3.1.1.1.2" xref="A3.E62.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="A3.E62.m1.3.3.1.1.1.1.1" xref="A3.E62.m1.3.3.1.1.1.1.1.1.cmml"><mo id="A3.E62.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="A3.E62.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="A3.E62.m1.3.3.1.1.1.1.1.1" xref="A3.E62.m1.3.3.1.1.1.1.1.1.cmml"><mi id="A3.E62.m1.3.3.1.1.1.1.1.1.2" xref="A3.E62.m1.3.3.1.1.1.1.1.1.2.cmml">P</mi><mo id="A3.E62.m1.3.3.1.1.1.1.1.1.1" xref="A3.E62.m1.3.3.1.1.1.1.1.1.1.cmml">∥</mo><msub id="A3.E62.m1.3.3.1.1.1.1.1.1.3" xref="A3.E62.m1.3.3.1.1.1.1.1.1.3.cmml"><mi id="A3.E62.m1.3.3.1.1.1.1.1.1.3.2" xref="A3.E62.m1.3.3.1.1.1.1.1.1.3.2.cmml">Q</mi><mrow id="A3.E62.m1.3.3.1.1.1.1.1.1.3.3" xref="A3.E62.m1.3.3.1.1.1.1.1.1.3.3.cmml"><mi id="A3.E62.m1.3.3.1.1.1.1.1.1.3.3.2" xref="A3.E62.m1.3.3.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="A3.E62.m1.3.3.1.1.1.1.1.1.3.3.1" xref="A3.E62.m1.3.3.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="A3.E62.m1.3.3.1.1.1.1.1.1.3.3.3" xref="A3.E62.m1.3.3.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="A3.E62.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="A3.E62.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A3.E62.m1.3.3.1.1.3" rspace="0.1389em" xref="A3.E62.m1.3.3.1.1.3.cmml">≥</mo><mrow id="A3.E62.m1.3.3.1.1.2" xref="A3.E62.m1.3.3.1.1.2.cmml"><munder id="A3.E62.m1.3.3.1.1.2.2" xref="A3.E62.m1.3.3.1.1.2.2.cmml"><mo id="A3.E62.m1.3.3.1.1.2.2.2" lspace="0.1389em" movablelimits="false" rspace="0em" xref="A3.E62.m1.3.3.1.1.2.2.2.cmml">sup</mo><mrow id="A3.E62.m1.3.3.1.1.2.2.3" xref="A3.E62.m1.3.3.1.1.2.2.3.cmml"><mi id="A3.E62.m1.3.3.1.1.2.2.3.2" xref="A3.E62.m1.3.3.1.1.2.2.3.2.cmml">u</mi><mo id="A3.E62.m1.3.3.1.1.2.2.3.1" xref="A3.E62.m1.3.3.1.1.2.2.3.1.cmml">∈</mo><msub id="A3.E62.m1.3.3.1.1.2.2.3.3" xref="A3.E62.m1.3.3.1.1.2.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.E62.m1.3.3.1.1.2.2.3.3.2" xref="A3.E62.m1.3.3.1.1.2.2.3.3.2.cmml">𝒰</mi><mi id="A3.E62.m1.3.3.1.1.2.2.3.3.3" xref="A3.E62.m1.3.3.1.1.2.2.3.3.3.cmml">t</mi></msub></mrow></munder><mrow id="A3.E62.m1.3.3.1.1.2.1.1" xref="A3.E62.m1.3.3.1.1.2.1.2.cmml"><mo id="A3.E62.m1.3.3.1.1.2.1.1.2" xref="A3.E62.m1.3.3.1.1.2.1.2.1.cmml">[</mo><mrow id="A3.E62.m1.3.3.1.1.2.1.1.1" xref="A3.E62.m1.3.3.1.1.2.1.1.1.cmml"><mrow id="A3.E62.m1.3.3.1.1.2.1.1.1.3" xref="A3.E62.m1.3.3.1.1.2.1.1.1.3.cmml"><msub id="A3.E62.m1.3.3.1.1.2.1.1.1.3.2" xref="A3.E62.m1.3.3.1.1.2.1.1.1.3.2.cmml"><mi id="A3.E62.m1.3.3.1.1.2.1.1.1.3.2.2" xref="A3.E62.m1.3.3.1.1.2.1.1.1.3.2.2.cmml">𝔼</mi><mrow id="A3.E62.m1.3.3.1.1.2.1.1.1.3.2.3" xref="A3.E62.m1.3.3.1.1.2.1.1.1.3.2.3.cmml"><mi id="A3.E62.m1.3.3.1.1.2.1.1.1.3.2.3.2" xref="A3.E62.m1.3.3.1.1.2.1.1.1.3.2.3.2.cmml">𝐱</mi><mo id="A3.E62.m1.3.3.1.1.2.1.1.1.3.2.3.1" xref="A3.E62.m1.3.3.1.1.2.1.1.1.3.2.3.1.cmml">∼</mo><mi id="A3.E62.m1.3.3.1.1.2.1.1.1.3.2.3.3" xref="A3.E62.m1.3.3.1.1.2.1.1.1.3.2.3.3.cmml">p</mi></mrow></msub><mo id="A3.E62.m1.3.3.1.1.2.1.1.1.3.1" xref="A3.E62.m1.3.3.1.1.2.1.1.1.3.1.cmml">⁢</mo><mi id="A3.E62.m1.3.3.1.1.2.1.1.1.3.3" xref="A3.E62.m1.3.3.1.1.2.1.1.1.3.3.cmml">u</mi><mo id="A3.E62.m1.3.3.1.1.2.1.1.1.3.1a" xref="A3.E62.m1.3.3.1.1.2.1.1.1.3.1.cmml">⁢</mo><mrow id="A3.E62.m1.3.3.1.1.2.1.1.1.3.4.2" xref="A3.E62.m1.3.3.1.1.2.1.1.1.3.cmml"><mo id="A3.E62.m1.3.3.1.1.2.1.1.1.3.4.2.1" stretchy="false" xref="A3.E62.m1.3.3.1.1.2.1.1.1.3.cmml">(</mo><mi id="A3.E62.m1.1.1" xref="A3.E62.m1.1.1.cmml">𝐱</mi><mo id="A3.E62.m1.3.3.1.1.2.1.1.1.3.4.2.2" stretchy="false" xref="A3.E62.m1.3.3.1.1.2.1.1.1.3.cmml">)</mo></mrow></mrow><mo id="A3.E62.m1.3.3.1.1.2.1.1.1.2" xref="A3.E62.m1.3.3.1.1.2.1.1.1.2.cmml">−</mo><mrow id="A3.E62.m1.3.3.1.1.2.1.1.1.1" xref="A3.E62.m1.3.3.1.1.2.1.1.1.1.cmml"><msub id="A3.E62.m1.3.3.1.1.2.1.1.1.1.3" xref="A3.E62.m1.3.3.1.1.2.1.1.1.1.3.cmml"><mi id="A3.E62.m1.3.3.1.1.2.1.1.1.1.3.2" xref="A3.E62.m1.3.3.1.1.2.1.1.1.1.3.2.cmml">𝔼</mi><mrow id="A3.E62.m1.3.3.1.1.2.1.1.1.1.3.3" xref="A3.E62.m1.3.3.1.1.2.1.1.1.1.3.3.cmml"><mi id="A3.E62.m1.3.3.1.1.2.1.1.1.1.3.3.2" xref="A3.E62.m1.3.3.1.1.2.1.1.1.1.3.3.2.cmml">𝐱</mi><mo id="A3.E62.m1.3.3.1.1.2.1.1.1.1.3.3.1" xref="A3.E62.m1.3.3.1.1.2.1.1.1.1.3.3.1.cmml">∼</mo><msub id="A3.E62.m1.3.3.1.1.2.1.1.1.1.3.3.3" xref="A3.E62.m1.3.3.1.1.2.1.1.1.1.3.3.3.cmml"><mi id="A3.E62.m1.3.3.1.1.2.1.1.1.1.3.3.3.2" xref="A3.E62.m1.3.3.1.1.2.1.1.1.1.3.3.3.2.cmml">q</mi><mrow id="A3.E62.m1.3.3.1.1.2.1.1.1.1.3.3.3.3" xref="A3.E62.m1.3.3.1.1.2.1.1.1.1.3.3.3.3.cmml"><mi id="A3.E62.m1.3.3.1.1.2.1.1.1.1.3.3.3.3.2" xref="A3.E62.m1.3.3.1.1.2.1.1.1.1.3.3.3.3.2.cmml">t</mi><mo id="A3.E62.m1.3.3.1.1.2.1.1.1.1.3.3.3.3.1" xref="A3.E62.m1.3.3.1.1.2.1.1.1.1.3.3.3.3.1.cmml">−</mo><mn id="A3.E62.m1.3.3.1.1.2.1.1.1.1.3.3.3.3.3" xref="A3.E62.m1.3.3.1.1.2.1.1.1.1.3.3.3.3.3.cmml">1</mn></mrow></msub></mrow></msub><mo id="A3.E62.m1.3.3.1.1.2.1.1.1.1.2" xref="A3.E62.m1.3.3.1.1.2.1.1.1.1.2.cmml">⁢</mo><msup id="A3.E62.m1.3.3.1.1.2.1.1.1.1.4" xref="A3.E62.m1.3.3.1.1.2.1.1.1.1.4.cmml"><mi id="A3.E62.m1.3.3.1.1.2.1.1.1.1.4.2" xref="A3.E62.m1.3.3.1.1.2.1.1.1.1.4.2.cmml">f</mi><mo id="A3.E62.m1.3.3.1.1.2.1.1.1.1.4.3" xref="A3.E62.m1.3.3.1.1.2.1.1.1.1.4.3.cmml">∗</mo></msup><mo id="A3.E62.m1.3.3.1.1.2.1.1.1.1.2a" xref="A3.E62.m1.3.3.1.1.2.1.1.1.1.2.cmml">⁢</mo><mrow id="A3.E62.m1.3.3.1.1.2.1.1.1.1.1.1" xref="A3.E62.m1.3.3.1.1.2.1.1.1.1.1.1.1.cmml"><mo id="A3.E62.m1.3.3.1.1.2.1.1.1.1.1.1.2" stretchy="false" xref="A3.E62.m1.3.3.1.1.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A3.E62.m1.3.3.1.1.2.1.1.1.1.1.1.1" xref="A3.E62.m1.3.3.1.1.2.1.1.1.1.1.1.1.cmml"><mi id="A3.E62.m1.3.3.1.1.2.1.1.1.1.1.1.1.2" xref="A3.E62.m1.3.3.1.1.2.1.1.1.1.1.1.1.2.cmml">u</mi><mo id="A3.E62.m1.3.3.1.1.2.1.1.1.1.1.1.1.1" xref="A3.E62.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="A3.E62.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.2" xref="A3.E62.m1.3.3.1.1.2.1.1.1.1.1.1.1.cmml"><mo id="A3.E62.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="A3.E62.m1.3.3.1.1.2.1.1.1.1.1.1.1.cmml">(</mo><mi id="A3.E62.m1.2.2" xref="A3.E62.m1.2.2.cmml">𝐱</mi><mo id="A3.E62.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="A3.E62.m1.3.3.1.1.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A3.E62.m1.3.3.1.1.2.1.1.1.1.1.1.3" stretchy="false" xref="A3.E62.m1.3.3.1.1.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A3.E62.m1.3.3.1.1.2.1.1.3" xref="A3.E62.m1.3.3.1.1.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="A3.E62.m1.3.3.1.2" lspace="0.170em" xref="A3.E62.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E62.m1.3b"><apply id="A3.E62.m1.3.3.1.1.cmml" xref="A3.E62.m1.3.3.1"><geq id="A3.E62.m1.3.3.1.1.3.cmml" xref="A3.E62.m1.3.3.1.1.3"></geq><apply id="A3.E62.m1.3.3.1.1.1.cmml" xref="A3.E62.m1.3.3.1.1.1"><times id="A3.E62.m1.3.3.1.1.1.2.cmml" xref="A3.E62.m1.3.3.1.1.1.2"></times><apply id="A3.E62.m1.3.3.1.1.1.3.cmml" xref="A3.E62.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="A3.E62.m1.3.3.1.1.1.3.1.cmml" xref="A3.E62.m1.3.3.1.1.1.3">subscript</csymbol><ci id="A3.E62.m1.3.3.1.1.1.3.2.cmml" xref="A3.E62.m1.3.3.1.1.1.3.2">𝐷</ci><ci id="A3.E62.m1.3.3.1.1.1.3.3.cmml" xref="A3.E62.m1.3.3.1.1.1.3.3">𝑓</ci></apply><apply id="A3.E62.m1.3.3.1.1.1.1.1.1.cmml" xref="A3.E62.m1.3.3.1.1.1.1.1"><csymbol cd="latexml" id="A3.E62.m1.3.3.1.1.1.1.1.1.1.cmml" xref="A3.E62.m1.3.3.1.1.1.1.1.1.1">conditional</csymbol><ci id="A3.E62.m1.3.3.1.1.1.1.1.1.2.cmml" xref="A3.E62.m1.3.3.1.1.1.1.1.1.2">𝑃</ci><apply id="A3.E62.m1.3.3.1.1.1.1.1.1.3.cmml" xref="A3.E62.m1.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E62.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="A3.E62.m1.3.3.1.1.1.1.1.1.3">subscript</csymbol><ci id="A3.E62.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="A3.E62.m1.3.3.1.1.1.1.1.1.3.2">𝑄</ci><apply id="A3.E62.m1.3.3.1.1.1.1.1.1.3.3.cmml" xref="A3.E62.m1.3.3.1.1.1.1.1.1.3.3"><minus id="A3.E62.m1.3.3.1.1.1.1.1.1.3.3.1.cmml" xref="A3.E62.m1.3.3.1.1.1.1.1.1.3.3.1"></minus><ci id="A3.E62.m1.3.3.1.1.1.1.1.1.3.3.2.cmml" xref="A3.E62.m1.3.3.1.1.1.1.1.1.3.3.2">𝑡</ci><cn id="A3.E62.m1.3.3.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="A3.E62.m1.3.3.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply><apply id="A3.E62.m1.3.3.1.1.2.cmml" xref="A3.E62.m1.3.3.1.1.2"><apply id="A3.E62.m1.3.3.1.1.2.2.cmml" xref="A3.E62.m1.3.3.1.1.2.2"><csymbol cd="ambiguous" id="A3.E62.m1.3.3.1.1.2.2.1.cmml" xref="A3.E62.m1.3.3.1.1.2.2">subscript</csymbol><csymbol cd="latexml" id="A3.E62.m1.3.3.1.1.2.2.2.cmml" xref="A3.E62.m1.3.3.1.1.2.2.2">supremum</csymbol><apply id="A3.E62.m1.3.3.1.1.2.2.3.cmml" xref="A3.E62.m1.3.3.1.1.2.2.3"><in id="A3.E62.m1.3.3.1.1.2.2.3.1.cmml" xref="A3.E62.m1.3.3.1.1.2.2.3.1"></in><ci id="A3.E62.m1.3.3.1.1.2.2.3.2.cmml" xref="A3.E62.m1.3.3.1.1.2.2.3.2">𝑢</ci><apply id="A3.E62.m1.3.3.1.1.2.2.3.3.cmml" xref="A3.E62.m1.3.3.1.1.2.2.3.3"><csymbol cd="ambiguous" id="A3.E62.m1.3.3.1.1.2.2.3.3.1.cmml" xref="A3.E62.m1.3.3.1.1.2.2.3.3">subscript</csymbol><ci id="A3.E62.m1.3.3.1.1.2.2.3.3.2.cmml" xref="A3.E62.m1.3.3.1.1.2.2.3.3.2">𝒰</ci><ci id="A3.E62.m1.3.3.1.1.2.2.3.3.3.cmml" xref="A3.E62.m1.3.3.1.1.2.2.3.3.3">𝑡</ci></apply></apply></apply><apply id="A3.E62.m1.3.3.1.1.2.1.2.cmml" xref="A3.E62.m1.3.3.1.1.2.1.1"><csymbol cd="latexml" id="A3.E62.m1.3.3.1.1.2.1.2.1.cmml" xref="A3.E62.m1.3.3.1.1.2.1.1.2">delimited-[]</csymbol><apply id="A3.E62.m1.3.3.1.1.2.1.1.1.cmml" xref="A3.E62.m1.3.3.1.1.2.1.1.1"><minus id="A3.E62.m1.3.3.1.1.2.1.1.1.2.cmml" xref="A3.E62.m1.3.3.1.1.2.1.1.1.2"></minus><apply id="A3.E62.m1.3.3.1.1.2.1.1.1.3.cmml" xref="A3.E62.m1.3.3.1.1.2.1.1.1.3"><times id="A3.E62.m1.3.3.1.1.2.1.1.1.3.1.cmml" xref="A3.E62.m1.3.3.1.1.2.1.1.1.3.1"></times><apply id="A3.E62.m1.3.3.1.1.2.1.1.1.3.2.cmml" xref="A3.E62.m1.3.3.1.1.2.1.1.1.3.2"><csymbol cd="ambiguous" id="A3.E62.m1.3.3.1.1.2.1.1.1.3.2.1.cmml" xref="A3.E62.m1.3.3.1.1.2.1.1.1.3.2">subscript</csymbol><ci id="A3.E62.m1.3.3.1.1.2.1.1.1.3.2.2.cmml" xref="A3.E62.m1.3.3.1.1.2.1.1.1.3.2.2">𝔼</ci><apply id="A3.E62.m1.3.3.1.1.2.1.1.1.3.2.3.cmml" xref="A3.E62.m1.3.3.1.1.2.1.1.1.3.2.3"><csymbol cd="latexml" id="A3.E62.m1.3.3.1.1.2.1.1.1.3.2.3.1.cmml" xref="A3.E62.m1.3.3.1.1.2.1.1.1.3.2.3.1">similar-to</csymbol><ci id="A3.E62.m1.3.3.1.1.2.1.1.1.3.2.3.2.cmml" xref="A3.E62.m1.3.3.1.1.2.1.1.1.3.2.3.2">𝐱</ci><ci id="A3.E62.m1.3.3.1.1.2.1.1.1.3.2.3.3.cmml" xref="A3.E62.m1.3.3.1.1.2.1.1.1.3.2.3.3">𝑝</ci></apply></apply><ci id="A3.E62.m1.3.3.1.1.2.1.1.1.3.3.cmml" xref="A3.E62.m1.3.3.1.1.2.1.1.1.3.3">𝑢</ci><ci id="A3.E62.m1.1.1.cmml" xref="A3.E62.m1.1.1">𝐱</ci></apply><apply id="A3.E62.m1.3.3.1.1.2.1.1.1.1.cmml" xref="A3.E62.m1.3.3.1.1.2.1.1.1.1"><times id="A3.E62.m1.3.3.1.1.2.1.1.1.1.2.cmml" xref="A3.E62.m1.3.3.1.1.2.1.1.1.1.2"></times><apply id="A3.E62.m1.3.3.1.1.2.1.1.1.1.3.cmml" xref="A3.E62.m1.3.3.1.1.2.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E62.m1.3.3.1.1.2.1.1.1.1.3.1.cmml" xref="A3.E62.m1.3.3.1.1.2.1.1.1.1.3">subscript</csymbol><ci id="A3.E62.m1.3.3.1.1.2.1.1.1.1.3.2.cmml" xref="A3.E62.m1.3.3.1.1.2.1.1.1.1.3.2">𝔼</ci><apply id="A3.E62.m1.3.3.1.1.2.1.1.1.1.3.3.cmml" xref="A3.E62.m1.3.3.1.1.2.1.1.1.1.3.3"><csymbol cd="latexml" id="A3.E62.m1.3.3.1.1.2.1.1.1.1.3.3.1.cmml" xref="A3.E62.m1.3.3.1.1.2.1.1.1.1.3.3.1">similar-to</csymbol><ci id="A3.E62.m1.3.3.1.1.2.1.1.1.1.3.3.2.cmml" xref="A3.E62.m1.3.3.1.1.2.1.1.1.1.3.3.2">𝐱</ci><apply id="A3.E62.m1.3.3.1.1.2.1.1.1.1.3.3.3.cmml" xref="A3.E62.m1.3.3.1.1.2.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="A3.E62.m1.3.3.1.1.2.1.1.1.1.3.3.3.1.cmml" xref="A3.E62.m1.3.3.1.1.2.1.1.1.1.3.3.3">subscript</csymbol><ci id="A3.E62.m1.3.3.1.1.2.1.1.1.1.3.3.3.2.cmml" xref="A3.E62.m1.3.3.1.1.2.1.1.1.1.3.3.3.2">𝑞</ci><apply id="A3.E62.m1.3.3.1.1.2.1.1.1.1.3.3.3.3.cmml" xref="A3.E62.m1.3.3.1.1.2.1.1.1.1.3.3.3.3"><minus id="A3.E62.m1.3.3.1.1.2.1.1.1.1.3.3.3.3.1.cmml" xref="A3.E62.m1.3.3.1.1.2.1.1.1.1.3.3.3.3.1"></minus><ci id="A3.E62.m1.3.3.1.1.2.1.1.1.1.3.3.3.3.2.cmml" xref="A3.E62.m1.3.3.1.1.2.1.1.1.1.3.3.3.3.2">𝑡</ci><cn id="A3.E62.m1.3.3.1.1.2.1.1.1.1.3.3.3.3.3.cmml" type="integer" xref="A3.E62.m1.3.3.1.1.2.1.1.1.1.3.3.3.3.3">1</cn></apply></apply></apply></apply><apply id="A3.E62.m1.3.3.1.1.2.1.1.1.1.4.cmml" xref="A3.E62.m1.3.3.1.1.2.1.1.1.1.4"><csymbol cd="ambiguous" id="A3.E62.m1.3.3.1.1.2.1.1.1.1.4.1.cmml" xref="A3.E62.m1.3.3.1.1.2.1.1.1.1.4">superscript</csymbol><ci id="A3.E62.m1.3.3.1.1.2.1.1.1.1.4.2.cmml" xref="A3.E62.m1.3.3.1.1.2.1.1.1.1.4.2">𝑓</ci><times id="A3.E62.m1.3.3.1.1.2.1.1.1.1.4.3.cmml" xref="A3.E62.m1.3.3.1.1.2.1.1.1.1.4.3"></times></apply><apply id="A3.E62.m1.3.3.1.1.2.1.1.1.1.1.1.1.cmml" xref="A3.E62.m1.3.3.1.1.2.1.1.1.1.1.1"><times id="A3.E62.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="A3.E62.m1.3.3.1.1.2.1.1.1.1.1.1.1.1"></times><ci id="A3.E62.m1.3.3.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="A3.E62.m1.3.3.1.1.2.1.1.1.1.1.1.1.2">𝑢</ci><ci id="A3.E62.m1.2.2.cmml" xref="A3.E62.m1.2.2">𝐱</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E62.m1.3c">D_{f}(P\|Q_{t-1})\geq\sup_{u\in\mathcal{U}_{t}}\left[\mathbb{E}_{\mathbf{x}%
\sim p}\;u(\mathbf{x})-\mathbb{E}_{\mathbf{x}\sim q_{t-1}}f^{*}(u(\mathbf{x}))%
\right]\,.</annotation><annotation encoding="application/x-llamapun" id="A3.E62.m1.3d">italic_D start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT ( italic_P ∥ italic_Q start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT ) ≥ roman_sup start_POSTSUBSCRIPT italic_u ∈ caligraphic_U start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ blackboard_E start_POSTSUBSCRIPT bold_x ∼ italic_p end_POSTSUBSCRIPT italic_u ( bold_x ) - blackboard_E start_POSTSUBSCRIPT bold_x ∼ italic_q start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_f start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_u ( bold_x ) ) ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(62)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A3.p2.8">Here <math alttext="f^{*}" class="ltx_Math" display="inline" id="A3.p2.3.m1.1"><semantics id="A3.p2.3.m1.1a"><msup id="A3.p2.3.m1.1.1" xref="A3.p2.3.m1.1.1.cmml"><mi id="A3.p2.3.m1.1.1.2" xref="A3.p2.3.m1.1.1.2.cmml">f</mi><mo id="A3.p2.3.m1.1.1.3" xref="A3.p2.3.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="A3.p2.3.m1.1b"><apply id="A3.p2.3.m1.1.1.cmml" xref="A3.p2.3.m1.1.1"><csymbol cd="ambiguous" id="A3.p2.3.m1.1.1.1.cmml" xref="A3.p2.3.m1.1.1">superscript</csymbol><ci id="A3.p2.3.m1.1.1.2.cmml" xref="A3.p2.3.m1.1.1.2">𝑓</ci><times id="A3.p2.3.m1.1.1.3.cmml" xref="A3.p2.3.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.3.m1.1c">f^{*}</annotation><annotation encoding="application/x-llamapun" id="A3.p2.3.m1.1d">italic_f start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the convex conjugate of <math alttext="f" class="ltx_Math" display="inline" id="A3.p2.4.m2.1"><semantics id="A3.p2.4.m2.1a"><mi id="A3.p2.4.m2.1.1" xref="A3.p2.4.m2.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="A3.p2.4.m2.1b"><ci id="A3.p2.4.m2.1.1.cmml" xref="A3.p2.4.m2.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.4.m2.1c">f</annotation><annotation encoding="application/x-llamapun" id="A3.p2.4.m2.1d">italic_f</annotation></semantics></math>. This bound is tight, with the optimum being achieved for <math alttext="u_{t}^{*}(\mathbf{x})=f^{\prime}(\nicefrac{{p(\mathbf{x})}}{{q_{t-1}(\mathbf{x%
})}})" class="ltx_Math" display="inline" id="A3.p2.5.m3.3"><semantics id="A3.p2.5.m3.3a"><mrow id="A3.p2.5.m3.3.4" xref="A3.p2.5.m3.3.4.cmml"><mrow id="A3.p2.5.m3.3.4.2" xref="A3.p2.5.m3.3.4.2.cmml"><msubsup id="A3.p2.5.m3.3.4.2.2" xref="A3.p2.5.m3.3.4.2.2.cmml"><mi id="A3.p2.5.m3.3.4.2.2.2.2" xref="A3.p2.5.m3.3.4.2.2.2.2.cmml">u</mi><mi id="A3.p2.5.m3.3.4.2.2.2.3" xref="A3.p2.5.m3.3.4.2.2.2.3.cmml">t</mi><mo id="A3.p2.5.m3.3.4.2.2.3" xref="A3.p2.5.m3.3.4.2.2.3.cmml">∗</mo></msubsup><mo id="A3.p2.5.m3.3.4.2.1" xref="A3.p2.5.m3.3.4.2.1.cmml">⁢</mo><mrow id="A3.p2.5.m3.3.4.2.3.2" xref="A3.p2.5.m3.3.4.2.cmml"><mo id="A3.p2.5.m3.3.4.2.3.2.1" stretchy="false" xref="A3.p2.5.m3.3.4.2.cmml">(</mo><mi id="A3.p2.5.m3.3.3" xref="A3.p2.5.m3.3.3.cmml">𝐱</mi><mo id="A3.p2.5.m3.3.4.2.3.2.2" stretchy="false" xref="A3.p2.5.m3.3.4.2.cmml">)</mo></mrow></mrow><mo id="A3.p2.5.m3.3.4.1" xref="A3.p2.5.m3.3.4.1.cmml">=</mo><mrow id="A3.p2.5.m3.3.4.3" xref="A3.p2.5.m3.3.4.3.cmml"><msup id="A3.p2.5.m3.3.4.3.2" xref="A3.p2.5.m3.3.4.3.2.cmml"><mi id="A3.p2.5.m3.3.4.3.2.2" xref="A3.p2.5.m3.3.4.3.2.2.cmml">f</mi><mo id="A3.p2.5.m3.3.4.3.2.3" xref="A3.p2.5.m3.3.4.3.2.3.cmml">′</mo></msup><mo id="A3.p2.5.m3.3.4.3.1" xref="A3.p2.5.m3.3.4.3.1.cmml">⁢</mo><mrow id="A3.p2.5.m3.3.4.3.3.2" xref="A3.p2.5.m3.2.2.cmml"><mo id="A3.p2.5.m3.3.4.3.3.2.1" stretchy="false" xref="A3.p2.5.m3.2.2.cmml">(</mo><mrow id="A3.p2.5.m3.2.2" xref="A3.p2.5.m3.2.2.cmml"><mpadded id="A3.p2.5.m3.1.1.1" voffset="0.3em" xref="A3.p2.5.m3.1.1.1.cmml"><mi id="A3.p2.5.m3.1.1.1.3" mathsize="70%" xref="A3.p2.5.m3.1.1.1.3.cmml">p</mi><mo id="A3.p2.5.m3.1.1.1.2" xref="A3.p2.5.m3.1.1.1.2.cmml">⁢</mo><mrow id="A3.p2.5.m3.1.1.1.4.2" xref="A3.p2.5.m3.1.1.1.cmml"><mo id="A3.p2.5.m3.1.1.1.4.2.1" maxsize="70%" minsize="70%" xref="A3.p2.5.m3.1.1.1.cmml">(</mo><mi id="A3.p2.5.m3.1.1.1.1" mathsize="70%" xref="A3.p2.5.m3.1.1.1.1.cmml">𝐱</mi><mo id="A3.p2.5.m3.1.1.1.4.2.2" maxsize="70%" minsize="70%" xref="A3.p2.5.m3.1.1.1.cmml">)</mo></mrow></mpadded><mpadded id="A3.p2.5.m3.2.2.3" lspace="-0.1em" width="-0.15em" xref="A3.p2.5.m3.2.2.3.cmml"><mo id="A3.p2.5.m3.2.2.3a" stretchy="true" symmetric="true" xref="A3.p2.5.m3.2.2.3.cmml">/</mo></mpadded><mrow id="A3.p2.5.m3.2.2.2" xref="A3.p2.5.m3.2.2.2.cmml"><msub id="A3.p2.5.m3.2.2.2.3" xref="A3.p2.5.m3.2.2.2.3.cmml"><mi id="A3.p2.5.m3.2.2.2.3.2" mathsize="70%" xref="A3.p2.5.m3.2.2.2.3.2.cmml">q</mi><mrow id="A3.p2.5.m3.2.2.2.3.3" xref="A3.p2.5.m3.2.2.2.3.3.cmml"><mi id="A3.p2.5.m3.2.2.2.3.3.2" mathsize="71%" xref="A3.p2.5.m3.2.2.2.3.3.2.cmml">t</mi><mo id="A3.p2.5.m3.2.2.2.3.3.1" mathsize="71%" xref="A3.p2.5.m3.2.2.2.3.3.1.cmml">−</mo><mn id="A3.p2.5.m3.2.2.2.3.3.3" mathsize="71%" xref="A3.p2.5.m3.2.2.2.3.3.3.cmml">1</mn></mrow></msub><mo id="A3.p2.5.m3.2.2.2.2" xref="A3.p2.5.m3.2.2.2.2.cmml">⁢</mo><mrow id="A3.p2.5.m3.2.2.2.4.2" xref="A3.p2.5.m3.2.2.2.cmml"><mo id="A3.p2.5.m3.2.2.2.4.2.1" maxsize="70%" minsize="70%" xref="A3.p2.5.m3.2.2.2.cmml">(</mo><mi id="A3.p2.5.m3.2.2.2.1" mathsize="70%" xref="A3.p2.5.m3.2.2.2.1.cmml">𝐱</mi><mo id="A3.p2.5.m3.2.2.2.4.2.2" maxsize="70%" minsize="70%" xref="A3.p2.5.m3.2.2.2.cmml">)</mo></mrow></mrow></mrow><mo id="A3.p2.5.m3.3.4.3.3.2.2" stretchy="false" xref="A3.p2.5.m3.2.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.p2.5.m3.3b"><apply id="A3.p2.5.m3.3.4.cmml" xref="A3.p2.5.m3.3.4"><eq id="A3.p2.5.m3.3.4.1.cmml" xref="A3.p2.5.m3.3.4.1"></eq><apply id="A3.p2.5.m3.3.4.2.cmml" xref="A3.p2.5.m3.3.4.2"><times id="A3.p2.5.m3.3.4.2.1.cmml" xref="A3.p2.5.m3.3.4.2.1"></times><apply id="A3.p2.5.m3.3.4.2.2.cmml" xref="A3.p2.5.m3.3.4.2.2"><csymbol cd="ambiguous" id="A3.p2.5.m3.3.4.2.2.1.cmml" xref="A3.p2.5.m3.3.4.2.2">superscript</csymbol><apply id="A3.p2.5.m3.3.4.2.2.2.cmml" xref="A3.p2.5.m3.3.4.2.2"><csymbol cd="ambiguous" id="A3.p2.5.m3.3.4.2.2.2.1.cmml" xref="A3.p2.5.m3.3.4.2.2">subscript</csymbol><ci id="A3.p2.5.m3.3.4.2.2.2.2.cmml" xref="A3.p2.5.m3.3.4.2.2.2.2">𝑢</ci><ci id="A3.p2.5.m3.3.4.2.2.2.3.cmml" xref="A3.p2.5.m3.3.4.2.2.2.3">𝑡</ci></apply><times id="A3.p2.5.m3.3.4.2.2.3.cmml" xref="A3.p2.5.m3.3.4.2.2.3"></times></apply><ci id="A3.p2.5.m3.3.3.cmml" xref="A3.p2.5.m3.3.3">𝐱</ci></apply><apply id="A3.p2.5.m3.3.4.3.cmml" xref="A3.p2.5.m3.3.4.3"><times id="A3.p2.5.m3.3.4.3.1.cmml" xref="A3.p2.5.m3.3.4.3.1"></times><apply id="A3.p2.5.m3.3.4.3.2.cmml" xref="A3.p2.5.m3.3.4.3.2"><csymbol cd="ambiguous" id="A3.p2.5.m3.3.4.3.2.1.cmml" xref="A3.p2.5.m3.3.4.3.2">superscript</csymbol><ci id="A3.p2.5.m3.3.4.3.2.2.cmml" xref="A3.p2.5.m3.3.4.3.2.2">𝑓</ci><ci id="A3.p2.5.m3.3.4.3.2.3.cmml" xref="A3.p2.5.m3.3.4.3.2.3">′</ci></apply><apply id="A3.p2.5.m3.2.2.cmml" xref="A3.p2.5.m3.3.4.3.3.2"><divide id="A3.p2.5.m3.2.2.3.cmml" xref="A3.p2.5.m3.2.2.3"></divide><apply id="A3.p2.5.m3.1.1.1.cmml" xref="A3.p2.5.m3.1.1.1"><times id="A3.p2.5.m3.1.1.1.2.cmml" xref="A3.p2.5.m3.1.1.1.2"></times><ci id="A3.p2.5.m3.1.1.1.3.cmml" xref="A3.p2.5.m3.1.1.1.3">𝑝</ci><ci id="A3.p2.5.m3.1.1.1.1.cmml" xref="A3.p2.5.m3.1.1.1.1">𝐱</ci></apply><apply id="A3.p2.5.m3.2.2.2.cmml" xref="A3.p2.5.m3.2.2.2"><times id="A3.p2.5.m3.2.2.2.2.cmml" xref="A3.p2.5.m3.2.2.2.2"></times><apply id="A3.p2.5.m3.2.2.2.3.cmml" xref="A3.p2.5.m3.2.2.2.3"><csymbol cd="ambiguous" id="A3.p2.5.m3.2.2.2.3.1.cmml" xref="A3.p2.5.m3.2.2.2.3">subscript</csymbol><ci id="A3.p2.5.m3.2.2.2.3.2.cmml" xref="A3.p2.5.m3.2.2.2.3.2">𝑞</ci><apply id="A3.p2.5.m3.2.2.2.3.3.cmml" xref="A3.p2.5.m3.2.2.2.3.3"><minus id="A3.p2.5.m3.2.2.2.3.3.1.cmml" xref="A3.p2.5.m3.2.2.2.3.3.1"></minus><ci id="A3.p2.5.m3.2.2.2.3.3.2.cmml" xref="A3.p2.5.m3.2.2.2.3.3.2">𝑡</ci><cn id="A3.p2.5.m3.2.2.2.3.3.3.cmml" type="integer" xref="A3.p2.5.m3.2.2.2.3.3.3">1</cn></apply></apply><ci id="A3.p2.5.m3.2.2.2.1.cmml" xref="A3.p2.5.m3.2.2.2.1">𝐱</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.5.m3.3c">u_{t}^{*}(\mathbf{x})=f^{\prime}(\nicefrac{{p(\mathbf{x})}}{{q_{t-1}(\mathbf{x%
})}})</annotation><annotation encoding="application/x-llamapun" id="A3.p2.5.m3.3d">italic_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( bold_x ) = italic_f start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( / start_ARG italic_p ( bold_x ) end_ARG start_ARG italic_q start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT ( bold_x ) end_ARG )</annotation></semantics></math>,
if <math alttext="\mathcal{U}_{t}" class="ltx_Math" display="inline" id="A3.p2.6.m4.1"><semantics id="A3.p2.6.m4.1a"><msub id="A3.p2.6.m4.1.1" xref="A3.p2.6.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.p2.6.m4.1.1.2" xref="A3.p2.6.m4.1.1.2.cmml">𝒰</mi><mi id="A3.p2.6.m4.1.1.3" xref="A3.p2.6.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p2.6.m4.1b"><apply id="A3.p2.6.m4.1.1.cmml" xref="A3.p2.6.m4.1.1"><csymbol cd="ambiguous" id="A3.p2.6.m4.1.1.1.cmml" xref="A3.p2.6.m4.1.1">subscript</csymbol><ci id="A3.p2.6.m4.1.1.2.cmml" xref="A3.p2.6.m4.1.1.2">𝒰</ci><ci id="A3.p2.6.m4.1.1.3.cmml" xref="A3.p2.6.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.6.m4.1c">\mathcal{U}_{t}</annotation><annotation encoding="application/x-llamapun" id="A3.p2.6.m4.1d">caligraphic_U start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is capable of representing this function.
<math alttext="\left(f^{\prime}\right)^{-1}(u^{*}_{t}(\mathbf{x}))" class="ltx_Math" display="inline" id="A3.p2.7.m5.3"><semantics id="A3.p2.7.m5.3a"><mrow id="A3.p2.7.m5.3.3" xref="A3.p2.7.m5.3.3.cmml"><msup id="A3.p2.7.m5.2.2.1" xref="A3.p2.7.m5.2.2.1.cmml"><mrow id="A3.p2.7.m5.2.2.1.1.1" xref="A3.p2.7.m5.2.2.1.1.1.1.cmml"><mo id="A3.p2.7.m5.2.2.1.1.1.2" xref="A3.p2.7.m5.2.2.1.1.1.1.cmml">(</mo><msup id="A3.p2.7.m5.2.2.1.1.1.1" xref="A3.p2.7.m5.2.2.1.1.1.1.cmml"><mi id="A3.p2.7.m5.2.2.1.1.1.1.2" xref="A3.p2.7.m5.2.2.1.1.1.1.2.cmml">f</mi><mo id="A3.p2.7.m5.2.2.1.1.1.1.3" xref="A3.p2.7.m5.2.2.1.1.1.1.3.cmml">′</mo></msup><mo id="A3.p2.7.m5.2.2.1.1.1.3" xref="A3.p2.7.m5.2.2.1.1.1.1.cmml">)</mo></mrow><mrow id="A3.p2.7.m5.2.2.1.3" xref="A3.p2.7.m5.2.2.1.3.cmml"><mo id="A3.p2.7.m5.2.2.1.3a" xref="A3.p2.7.m5.2.2.1.3.cmml">−</mo><mn id="A3.p2.7.m5.2.2.1.3.2" xref="A3.p2.7.m5.2.2.1.3.2.cmml">1</mn></mrow></msup><mo id="A3.p2.7.m5.3.3.3" xref="A3.p2.7.m5.3.3.3.cmml">⁢</mo><mrow id="A3.p2.7.m5.3.3.2.1" xref="A3.p2.7.m5.3.3.2.1.1.cmml"><mo id="A3.p2.7.m5.3.3.2.1.2" stretchy="false" xref="A3.p2.7.m5.3.3.2.1.1.cmml">(</mo><mrow id="A3.p2.7.m5.3.3.2.1.1" xref="A3.p2.7.m5.3.3.2.1.1.cmml"><msubsup id="A3.p2.7.m5.3.3.2.1.1.2" xref="A3.p2.7.m5.3.3.2.1.1.2.cmml"><mi id="A3.p2.7.m5.3.3.2.1.1.2.2.2" xref="A3.p2.7.m5.3.3.2.1.1.2.2.2.cmml">u</mi><mi id="A3.p2.7.m5.3.3.2.1.1.2.3" xref="A3.p2.7.m5.3.3.2.1.1.2.3.cmml">t</mi><mo id="A3.p2.7.m5.3.3.2.1.1.2.2.3" xref="A3.p2.7.m5.3.3.2.1.1.2.2.3.cmml">∗</mo></msubsup><mo id="A3.p2.7.m5.3.3.2.1.1.1" xref="A3.p2.7.m5.3.3.2.1.1.1.cmml">⁢</mo><mrow id="A3.p2.7.m5.3.3.2.1.1.3.2" xref="A3.p2.7.m5.3.3.2.1.1.cmml"><mo id="A3.p2.7.m5.3.3.2.1.1.3.2.1" stretchy="false" xref="A3.p2.7.m5.3.3.2.1.1.cmml">(</mo><mi id="A3.p2.7.m5.1.1" xref="A3.p2.7.m5.1.1.cmml">𝐱</mi><mo id="A3.p2.7.m5.3.3.2.1.1.3.2.2" stretchy="false" xref="A3.p2.7.m5.3.3.2.1.1.cmml">)</mo></mrow></mrow><mo id="A3.p2.7.m5.3.3.2.1.3" stretchy="false" xref="A3.p2.7.m5.3.3.2.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.p2.7.m5.3b"><apply id="A3.p2.7.m5.3.3.cmml" xref="A3.p2.7.m5.3.3"><times id="A3.p2.7.m5.3.3.3.cmml" xref="A3.p2.7.m5.3.3.3"></times><apply id="A3.p2.7.m5.2.2.1.cmml" xref="A3.p2.7.m5.2.2.1"><csymbol cd="ambiguous" id="A3.p2.7.m5.2.2.1.2.cmml" xref="A3.p2.7.m5.2.2.1">superscript</csymbol><apply id="A3.p2.7.m5.2.2.1.1.1.1.cmml" xref="A3.p2.7.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="A3.p2.7.m5.2.2.1.1.1.1.1.cmml" xref="A3.p2.7.m5.2.2.1.1.1">superscript</csymbol><ci id="A3.p2.7.m5.2.2.1.1.1.1.2.cmml" xref="A3.p2.7.m5.2.2.1.1.1.1.2">𝑓</ci><ci id="A3.p2.7.m5.2.2.1.1.1.1.3.cmml" xref="A3.p2.7.m5.2.2.1.1.1.1.3">′</ci></apply><apply id="A3.p2.7.m5.2.2.1.3.cmml" xref="A3.p2.7.m5.2.2.1.3"><minus id="A3.p2.7.m5.2.2.1.3.1.cmml" xref="A3.p2.7.m5.2.2.1.3"></minus><cn id="A3.p2.7.m5.2.2.1.3.2.cmml" type="integer" xref="A3.p2.7.m5.2.2.1.3.2">1</cn></apply></apply><apply id="A3.p2.7.m5.3.3.2.1.1.cmml" xref="A3.p2.7.m5.3.3.2.1"><times id="A3.p2.7.m5.3.3.2.1.1.1.cmml" xref="A3.p2.7.m5.3.3.2.1.1.1"></times><apply id="A3.p2.7.m5.3.3.2.1.1.2.cmml" xref="A3.p2.7.m5.3.3.2.1.1.2"><csymbol cd="ambiguous" id="A3.p2.7.m5.3.3.2.1.1.2.1.cmml" xref="A3.p2.7.m5.3.3.2.1.1.2">subscript</csymbol><apply id="A3.p2.7.m5.3.3.2.1.1.2.2.cmml" xref="A3.p2.7.m5.3.3.2.1.1.2"><csymbol cd="ambiguous" id="A3.p2.7.m5.3.3.2.1.1.2.2.1.cmml" xref="A3.p2.7.m5.3.3.2.1.1.2">superscript</csymbol><ci id="A3.p2.7.m5.3.3.2.1.1.2.2.2.cmml" xref="A3.p2.7.m5.3.3.2.1.1.2.2.2">𝑢</ci><times id="A3.p2.7.m5.3.3.2.1.1.2.2.3.cmml" xref="A3.p2.7.m5.3.3.2.1.1.2.2.3"></times></apply><ci id="A3.p2.7.m5.3.3.2.1.1.2.3.cmml" xref="A3.p2.7.m5.3.3.2.1.1.2.3">𝑡</ci></apply><ci id="A3.p2.7.m5.1.1.cmml" xref="A3.p2.7.m5.1.1">𝐱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.7.m5.3c">\left(f^{\prime}\right)^{-1}(u^{*}_{t}(\mathbf{x}))</annotation><annotation encoding="application/x-llamapun" id="A3.p2.7.m5.3d">( italic_f start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( italic_u start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_x ) )</annotation></semantics></math> can thus be interpreted as an approximation of the desired <math alttext="r_{t}(\mathbf{x})" class="ltx_Math" display="inline" id="A3.p2.8.m6.1"><semantics id="A3.p2.8.m6.1a"><mrow id="A3.p2.8.m6.1.2" xref="A3.p2.8.m6.1.2.cmml"><msub id="A3.p2.8.m6.1.2.2" xref="A3.p2.8.m6.1.2.2.cmml"><mi id="A3.p2.8.m6.1.2.2.2" xref="A3.p2.8.m6.1.2.2.2.cmml">r</mi><mi id="A3.p2.8.m6.1.2.2.3" xref="A3.p2.8.m6.1.2.2.3.cmml">t</mi></msub><mo id="A3.p2.8.m6.1.2.1" xref="A3.p2.8.m6.1.2.1.cmml">⁢</mo><mrow id="A3.p2.8.m6.1.2.3.2" xref="A3.p2.8.m6.1.2.cmml"><mo id="A3.p2.8.m6.1.2.3.2.1" stretchy="false" xref="A3.p2.8.m6.1.2.cmml">(</mo><mi id="A3.p2.8.m6.1.1" xref="A3.p2.8.m6.1.1.cmml">𝐱</mi><mo id="A3.p2.8.m6.1.2.3.2.2" stretchy="false" xref="A3.p2.8.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.p2.8.m6.1b"><apply id="A3.p2.8.m6.1.2.cmml" xref="A3.p2.8.m6.1.2"><times id="A3.p2.8.m6.1.2.1.cmml" xref="A3.p2.8.m6.1.2.1"></times><apply id="A3.p2.8.m6.1.2.2.cmml" xref="A3.p2.8.m6.1.2.2"><csymbol cd="ambiguous" id="A3.p2.8.m6.1.2.2.1.cmml" xref="A3.p2.8.m6.1.2.2">subscript</csymbol><ci id="A3.p2.8.m6.1.2.2.2.cmml" xref="A3.p2.8.m6.1.2.2.2">𝑟</ci><ci id="A3.p2.8.m6.1.2.2.3.cmml" xref="A3.p2.8.m6.1.2.2.3">𝑡</ci></apply><ci id="A3.p2.8.m6.1.1.cmml" xref="A3.p2.8.m6.1.1">𝐱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.8.m6.1c">r_{t}(\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="A3.p2.8.m6.1d">italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_x )</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="A3.p3">
<p class="ltx_p" id="A3.p3.7">Adapting this method to use trees as weak learners can be accomplished by considering <math alttext="\mathcal{U}_{t}" class="ltx_Math" display="inline" id="A3.p3.1.m1.1"><semantics id="A3.p3.1.m1.1a"><msub id="A3.p3.1.m1.1.1" xref="A3.p3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.p3.1.m1.1.1.2" xref="A3.p3.1.m1.1.1.2.cmml">𝒰</mi><mi id="A3.p3.1.m1.1.1.3" xref="A3.p3.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p3.1.m1.1b"><apply id="A3.p3.1.m1.1.1.cmml" xref="A3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="A3.p3.1.m1.1.1.1.cmml" xref="A3.p3.1.m1.1.1">subscript</csymbol><ci id="A3.p3.1.m1.1.1.2.cmml" xref="A3.p3.1.m1.1.1.2">𝒰</ci><ci id="A3.p3.1.m1.1.1.3.cmml" xref="A3.p3.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.1.m1.1c">\mathcal{U}_{t}</annotation><annotation encoding="application/x-llamapun" id="A3.p3.1.m1.1d">caligraphic_U start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> in Equation <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A3.E62" title="In Appendix C Greedy Tree-Based Multiplicative Boosting ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">62</span></a> to be defined by tree functions
<math alttext="u=\nicefrac{{1}}{{J}}\sum_{j=1}^{J}w_{j}\mathbf{1}_{X_{j}}" class="ltx_Math" display="inline" id="A3.p3.2.m2.1"><semantics id="A3.p3.2.m2.1a"><mrow id="A3.p3.2.m2.1.1" xref="A3.p3.2.m2.1.1.cmml"><mi id="A3.p3.2.m2.1.1.2" xref="A3.p3.2.m2.1.1.2.cmml">u</mi><mo id="A3.p3.2.m2.1.1.1" xref="A3.p3.2.m2.1.1.1.cmml">=</mo><mrow id="A3.p3.2.m2.1.1.3" xref="A3.p3.2.m2.1.1.3.cmml"><mrow id="A3.p3.2.m2.1.1.3.2" xref="A3.p3.2.m2.1.1.3.2.cmml"><mpadded id="A3.p3.2.m2.1.1.3.2.2" voffset="0.3em" xref="A3.p3.2.m2.1.1.3.2.2.cmml"><mn id="A3.p3.2.m2.1.1.3.2.2a" mathsize="70%" xref="A3.p3.2.m2.1.1.3.2.2.cmml">1</mn></mpadded><mpadded id="A3.p3.2.m2.1.1.3.2.1" lspace="-0.1em" width="-0.15em" xref="A3.p3.2.m2.1.1.3.2.1.cmml"><mo id="A3.p3.2.m2.1.1.3.2.1a" stretchy="true" symmetric="true" xref="A3.p3.2.m2.1.1.3.2.1.cmml">/</mo></mpadded><mi id="A3.p3.2.m2.1.1.3.2.3" mathsize="70%" xref="A3.p3.2.m2.1.1.3.2.3.cmml">J</mi></mrow><mo id="A3.p3.2.m2.1.1.3.1" xref="A3.p3.2.m2.1.1.3.1.cmml">⁢</mo><mrow id="A3.p3.2.m2.1.1.3.3" xref="A3.p3.2.m2.1.1.3.3.cmml"><msubsup id="A3.p3.2.m2.1.1.3.3.1" xref="A3.p3.2.m2.1.1.3.3.1.cmml"><mo id="A3.p3.2.m2.1.1.3.3.1.2.2" xref="A3.p3.2.m2.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="A3.p3.2.m2.1.1.3.3.1.2.3" xref="A3.p3.2.m2.1.1.3.3.1.2.3.cmml"><mi id="A3.p3.2.m2.1.1.3.3.1.2.3.2" xref="A3.p3.2.m2.1.1.3.3.1.2.3.2.cmml">j</mi><mo id="A3.p3.2.m2.1.1.3.3.1.2.3.1" xref="A3.p3.2.m2.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="A3.p3.2.m2.1.1.3.3.1.2.3.3" xref="A3.p3.2.m2.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="A3.p3.2.m2.1.1.3.3.1.3" xref="A3.p3.2.m2.1.1.3.3.1.3.cmml">J</mi></msubsup><mrow id="A3.p3.2.m2.1.1.3.3.2" xref="A3.p3.2.m2.1.1.3.3.2.cmml"><msub id="A3.p3.2.m2.1.1.3.3.2.2" xref="A3.p3.2.m2.1.1.3.3.2.2.cmml"><mi id="A3.p3.2.m2.1.1.3.3.2.2.2" xref="A3.p3.2.m2.1.1.3.3.2.2.2.cmml">w</mi><mi id="A3.p3.2.m2.1.1.3.3.2.2.3" xref="A3.p3.2.m2.1.1.3.3.2.2.3.cmml">j</mi></msub><mo id="A3.p3.2.m2.1.1.3.3.2.1" xref="A3.p3.2.m2.1.1.3.3.2.1.cmml">⁢</mo><msub id="A3.p3.2.m2.1.1.3.3.2.3" xref="A3.p3.2.m2.1.1.3.3.2.3.cmml"><mn id="A3.p3.2.m2.1.1.3.3.2.3.2" xref="A3.p3.2.m2.1.1.3.3.2.3.2.cmml">𝟏</mn><msub id="A3.p3.2.m2.1.1.3.3.2.3.3" xref="A3.p3.2.m2.1.1.3.3.2.3.3.cmml"><mi id="A3.p3.2.m2.1.1.3.3.2.3.3.2" xref="A3.p3.2.m2.1.1.3.3.2.3.3.2.cmml">X</mi><mi id="A3.p3.2.m2.1.1.3.3.2.3.3.3" xref="A3.p3.2.m2.1.1.3.3.2.3.3.3.cmml">j</mi></msub></msub></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.p3.2.m2.1b"><apply id="A3.p3.2.m2.1.1.cmml" xref="A3.p3.2.m2.1.1"><eq id="A3.p3.2.m2.1.1.1.cmml" xref="A3.p3.2.m2.1.1.1"></eq><ci id="A3.p3.2.m2.1.1.2.cmml" xref="A3.p3.2.m2.1.1.2">𝑢</ci><apply id="A3.p3.2.m2.1.1.3.cmml" xref="A3.p3.2.m2.1.1.3"><times id="A3.p3.2.m2.1.1.3.1.cmml" xref="A3.p3.2.m2.1.1.3.1"></times><apply id="A3.p3.2.m2.1.1.3.2.cmml" xref="A3.p3.2.m2.1.1.3.2"><divide id="A3.p3.2.m2.1.1.3.2.1.cmml" xref="A3.p3.2.m2.1.1.3.2.1"></divide><cn id="A3.p3.2.m2.1.1.3.2.2.cmml" type="integer" xref="A3.p3.2.m2.1.1.3.2.2">1</cn><ci id="A3.p3.2.m2.1.1.3.2.3.cmml" xref="A3.p3.2.m2.1.1.3.2.3">𝐽</ci></apply><apply id="A3.p3.2.m2.1.1.3.3.cmml" xref="A3.p3.2.m2.1.1.3.3"><apply id="A3.p3.2.m2.1.1.3.3.1.cmml" xref="A3.p3.2.m2.1.1.3.3.1"><csymbol cd="ambiguous" id="A3.p3.2.m2.1.1.3.3.1.1.cmml" xref="A3.p3.2.m2.1.1.3.3.1">superscript</csymbol><apply id="A3.p3.2.m2.1.1.3.3.1.2.cmml" xref="A3.p3.2.m2.1.1.3.3.1"><csymbol cd="ambiguous" id="A3.p3.2.m2.1.1.3.3.1.2.1.cmml" xref="A3.p3.2.m2.1.1.3.3.1">subscript</csymbol><sum id="A3.p3.2.m2.1.1.3.3.1.2.2.cmml" xref="A3.p3.2.m2.1.1.3.3.1.2.2"></sum><apply id="A3.p3.2.m2.1.1.3.3.1.2.3.cmml" xref="A3.p3.2.m2.1.1.3.3.1.2.3"><eq id="A3.p3.2.m2.1.1.3.3.1.2.3.1.cmml" xref="A3.p3.2.m2.1.1.3.3.1.2.3.1"></eq><ci id="A3.p3.2.m2.1.1.3.3.1.2.3.2.cmml" xref="A3.p3.2.m2.1.1.3.3.1.2.3.2">𝑗</ci><cn id="A3.p3.2.m2.1.1.3.3.1.2.3.3.cmml" type="integer" xref="A3.p3.2.m2.1.1.3.3.1.2.3.3">1</cn></apply></apply><ci id="A3.p3.2.m2.1.1.3.3.1.3.cmml" xref="A3.p3.2.m2.1.1.3.3.1.3">𝐽</ci></apply><apply id="A3.p3.2.m2.1.1.3.3.2.cmml" xref="A3.p3.2.m2.1.1.3.3.2"><times id="A3.p3.2.m2.1.1.3.3.2.1.cmml" xref="A3.p3.2.m2.1.1.3.3.2.1"></times><apply id="A3.p3.2.m2.1.1.3.3.2.2.cmml" xref="A3.p3.2.m2.1.1.3.3.2.2"><csymbol cd="ambiguous" id="A3.p3.2.m2.1.1.3.3.2.2.1.cmml" xref="A3.p3.2.m2.1.1.3.3.2.2">subscript</csymbol><ci id="A3.p3.2.m2.1.1.3.3.2.2.2.cmml" xref="A3.p3.2.m2.1.1.3.3.2.2.2">𝑤</ci><ci id="A3.p3.2.m2.1.1.3.3.2.2.3.cmml" xref="A3.p3.2.m2.1.1.3.3.2.2.3">𝑗</ci></apply><apply id="A3.p3.2.m2.1.1.3.3.2.3.cmml" xref="A3.p3.2.m2.1.1.3.3.2.3"><csymbol cd="ambiguous" id="A3.p3.2.m2.1.1.3.3.2.3.1.cmml" xref="A3.p3.2.m2.1.1.3.3.2.3">subscript</csymbol><cn id="A3.p3.2.m2.1.1.3.3.2.3.2.cmml" type="integer" xref="A3.p3.2.m2.1.1.3.3.2.3.2">1</cn><apply id="A3.p3.2.m2.1.1.3.3.2.3.3.cmml" xref="A3.p3.2.m2.1.1.3.3.2.3.3"><csymbol cd="ambiguous" id="A3.p3.2.m2.1.1.3.3.2.3.3.1.cmml" xref="A3.p3.2.m2.1.1.3.3.2.3.3">subscript</csymbol><ci id="A3.p3.2.m2.1.1.3.3.2.3.3.2.cmml" xref="A3.p3.2.m2.1.1.3.3.2.3.3.2">𝑋</ci><ci id="A3.p3.2.m2.1.1.3.3.2.3.3.3.cmml" xref="A3.p3.2.m2.1.1.3.3.2.3.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.2.m2.1c">u=\nicefrac{{1}}{{J}}\sum_{j=1}^{J}w_{j}\mathbf{1}_{X_{j}}</annotation><annotation encoding="application/x-llamapun" id="A3.p3.2.m2.1d">italic_u = / start_ARG 1 end_ARG start_ARG italic_J end_ARG ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_J end_POSTSUPERSCRIPT italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT bold_1 start_POSTSUBSCRIPT italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> with leaf values <math alttext="w_{j}" class="ltx_Math" display="inline" id="A3.p3.3.m3.1"><semantics id="A3.p3.3.m3.1a"><msub id="A3.p3.3.m3.1.1" xref="A3.p3.3.m3.1.1.cmml"><mi id="A3.p3.3.m3.1.1.2" xref="A3.p3.3.m3.1.1.2.cmml">w</mi><mi id="A3.p3.3.m3.1.1.3" xref="A3.p3.3.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p3.3.m3.1b"><apply id="A3.p3.3.m3.1.1.cmml" xref="A3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="A3.p3.3.m3.1.1.1.cmml" xref="A3.p3.3.m3.1.1">subscript</csymbol><ci id="A3.p3.3.m3.1.1.2.cmml" xref="A3.p3.3.m3.1.1.2">𝑤</ci><ci id="A3.p3.3.m3.1.1.3.cmml" xref="A3.p3.3.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.3.m3.1c">w_{j}</annotation><annotation encoding="application/x-llamapun" id="A3.p3.3.m3.1d">italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> and leaf supports <math alttext="X_{j}" class="ltx_Math" display="inline" id="A3.p3.4.m4.1"><semantics id="A3.p3.4.m4.1a"><msub id="A3.p3.4.m4.1.1" xref="A3.p3.4.m4.1.1.cmml"><mi id="A3.p3.4.m4.1.1.2" xref="A3.p3.4.m4.1.1.2.cmml">X</mi><mi id="A3.p3.4.m4.1.1.3" xref="A3.p3.4.m4.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p3.4.m4.1b"><apply id="A3.p3.4.m4.1.1.cmml" xref="A3.p3.4.m4.1.1"><csymbol cd="ambiguous" id="A3.p3.4.m4.1.1.1.cmml" xref="A3.p3.4.m4.1.1">subscript</csymbol><ci id="A3.p3.4.m4.1.1.2.cmml" xref="A3.p3.4.m4.1.1.2">𝑋</ci><ci id="A3.p3.4.m4.1.1.3.cmml" xref="A3.p3.4.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.4.m4.1c">X_{j}</annotation><annotation encoding="application/x-llamapun" id="A3.p3.4.m4.1d">italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>.
At each boosting iteration a new tree, <math alttext="u^{*}_{t}" class="ltx_Math" display="inline" id="A3.p3.5.m5.1"><semantics id="A3.p3.5.m5.1a"><msubsup id="A3.p3.5.m5.1.1" xref="A3.p3.5.m5.1.1.cmml"><mi id="A3.p3.5.m5.1.1.2.2" xref="A3.p3.5.m5.1.1.2.2.cmml">u</mi><mi id="A3.p3.5.m5.1.1.3" xref="A3.p3.5.m5.1.1.3.cmml">t</mi><mo id="A3.p3.5.m5.1.1.2.3" xref="A3.p3.5.m5.1.1.2.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="A3.p3.5.m5.1b"><apply id="A3.p3.5.m5.1.1.cmml" xref="A3.p3.5.m5.1.1"><csymbol cd="ambiguous" id="A3.p3.5.m5.1.1.1.cmml" xref="A3.p3.5.m5.1.1">subscript</csymbol><apply id="A3.p3.5.m5.1.1.2.cmml" xref="A3.p3.5.m5.1.1"><csymbol cd="ambiguous" id="A3.p3.5.m5.1.1.2.1.cmml" xref="A3.p3.5.m5.1.1">superscript</csymbol><ci id="A3.p3.5.m5.1.1.2.2.cmml" xref="A3.p3.5.m5.1.1.2.2">𝑢</ci><times id="A3.p3.5.m5.1.1.2.3.cmml" xref="A3.p3.5.m5.1.1.2.3"></times></apply><ci id="A3.p3.5.m5.1.1.3.cmml" xref="A3.p3.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.5.m5.1c">u^{*}_{t}</annotation><annotation encoding="application/x-llamapun" id="A3.p3.5.m5.1d">italic_u start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> can thus be grown to greedily optimize the lower bound in the r.h.s. of Equation <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A3.E62" title="In Appendix C Greedy Tree-Based Multiplicative Boosting ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">62</span></a> and setting
<math alttext="\delta q_{t}(\mathbf{x})=\left(f^{\prime}\right)^{-1}(u^{*}_{t}(\mathbf{x}))" class="ltx_Math" display="inline" id="A3.p3.6.m6.4"><semantics id="A3.p3.6.m6.4a"><mrow id="A3.p3.6.m6.4.4" xref="A3.p3.6.m6.4.4.cmml"><mrow id="A3.p3.6.m6.4.4.4" xref="A3.p3.6.m6.4.4.4.cmml"><mi id="A3.p3.6.m6.4.4.4.2" xref="A3.p3.6.m6.4.4.4.2.cmml">δ</mi><mo id="A3.p3.6.m6.4.4.4.1" xref="A3.p3.6.m6.4.4.4.1.cmml">⁢</mo><msub id="A3.p3.6.m6.4.4.4.3" xref="A3.p3.6.m6.4.4.4.3.cmml"><mi id="A3.p3.6.m6.4.4.4.3.2" xref="A3.p3.6.m6.4.4.4.3.2.cmml">q</mi><mi id="A3.p3.6.m6.4.4.4.3.3" xref="A3.p3.6.m6.4.4.4.3.3.cmml">t</mi></msub><mo id="A3.p3.6.m6.4.4.4.1a" xref="A3.p3.6.m6.4.4.4.1.cmml">⁢</mo><mrow id="A3.p3.6.m6.4.4.4.4.2" xref="A3.p3.6.m6.4.4.4.cmml"><mo id="A3.p3.6.m6.4.4.4.4.2.1" stretchy="false" xref="A3.p3.6.m6.4.4.4.cmml">(</mo><mi id="A3.p3.6.m6.1.1" xref="A3.p3.6.m6.1.1.cmml">𝐱</mi><mo id="A3.p3.6.m6.4.4.4.4.2.2" stretchy="false" xref="A3.p3.6.m6.4.4.4.cmml">)</mo></mrow></mrow><mo id="A3.p3.6.m6.4.4.3" xref="A3.p3.6.m6.4.4.3.cmml">=</mo><mrow id="A3.p3.6.m6.4.4.2" xref="A3.p3.6.m6.4.4.2.cmml"><msup id="A3.p3.6.m6.3.3.1.1" xref="A3.p3.6.m6.3.3.1.1.cmml"><mrow id="A3.p3.6.m6.3.3.1.1.1.1" xref="A3.p3.6.m6.3.3.1.1.1.1.1.cmml"><mo id="A3.p3.6.m6.3.3.1.1.1.1.2" xref="A3.p3.6.m6.3.3.1.1.1.1.1.cmml">(</mo><msup id="A3.p3.6.m6.3.3.1.1.1.1.1" xref="A3.p3.6.m6.3.3.1.1.1.1.1.cmml"><mi id="A3.p3.6.m6.3.3.1.1.1.1.1.2" xref="A3.p3.6.m6.3.3.1.1.1.1.1.2.cmml">f</mi><mo id="A3.p3.6.m6.3.3.1.1.1.1.1.3" xref="A3.p3.6.m6.3.3.1.1.1.1.1.3.cmml">′</mo></msup><mo id="A3.p3.6.m6.3.3.1.1.1.1.3" xref="A3.p3.6.m6.3.3.1.1.1.1.1.cmml">)</mo></mrow><mrow id="A3.p3.6.m6.3.3.1.1.3" xref="A3.p3.6.m6.3.3.1.1.3.cmml"><mo id="A3.p3.6.m6.3.3.1.1.3a" xref="A3.p3.6.m6.3.3.1.1.3.cmml">−</mo><mn id="A3.p3.6.m6.3.3.1.1.3.2" xref="A3.p3.6.m6.3.3.1.1.3.2.cmml">1</mn></mrow></msup><mo id="A3.p3.6.m6.4.4.2.3" xref="A3.p3.6.m6.4.4.2.3.cmml">⁢</mo><mrow id="A3.p3.6.m6.4.4.2.2.1" xref="A3.p3.6.m6.4.4.2.2.1.1.cmml"><mo id="A3.p3.6.m6.4.4.2.2.1.2" stretchy="false" xref="A3.p3.6.m6.4.4.2.2.1.1.cmml">(</mo><mrow id="A3.p3.6.m6.4.4.2.2.1.1" xref="A3.p3.6.m6.4.4.2.2.1.1.cmml"><msubsup id="A3.p3.6.m6.4.4.2.2.1.1.2" xref="A3.p3.6.m6.4.4.2.2.1.1.2.cmml"><mi id="A3.p3.6.m6.4.4.2.2.1.1.2.2.2" xref="A3.p3.6.m6.4.4.2.2.1.1.2.2.2.cmml">u</mi><mi id="A3.p3.6.m6.4.4.2.2.1.1.2.3" xref="A3.p3.6.m6.4.4.2.2.1.1.2.3.cmml">t</mi><mo id="A3.p3.6.m6.4.4.2.2.1.1.2.2.3" xref="A3.p3.6.m6.4.4.2.2.1.1.2.2.3.cmml">∗</mo></msubsup><mo id="A3.p3.6.m6.4.4.2.2.1.1.1" xref="A3.p3.6.m6.4.4.2.2.1.1.1.cmml">⁢</mo><mrow id="A3.p3.6.m6.4.4.2.2.1.1.3.2" xref="A3.p3.6.m6.4.4.2.2.1.1.cmml"><mo id="A3.p3.6.m6.4.4.2.2.1.1.3.2.1" stretchy="false" xref="A3.p3.6.m6.4.4.2.2.1.1.cmml">(</mo><mi id="A3.p3.6.m6.2.2" xref="A3.p3.6.m6.2.2.cmml">𝐱</mi><mo id="A3.p3.6.m6.4.4.2.2.1.1.3.2.2" stretchy="false" xref="A3.p3.6.m6.4.4.2.2.1.1.cmml">)</mo></mrow></mrow><mo id="A3.p3.6.m6.4.4.2.2.1.3" stretchy="false" xref="A3.p3.6.m6.4.4.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.p3.6.m6.4b"><apply id="A3.p3.6.m6.4.4.cmml" xref="A3.p3.6.m6.4.4"><eq id="A3.p3.6.m6.4.4.3.cmml" xref="A3.p3.6.m6.4.4.3"></eq><apply id="A3.p3.6.m6.4.4.4.cmml" xref="A3.p3.6.m6.4.4.4"><times id="A3.p3.6.m6.4.4.4.1.cmml" xref="A3.p3.6.m6.4.4.4.1"></times><ci id="A3.p3.6.m6.4.4.4.2.cmml" xref="A3.p3.6.m6.4.4.4.2">𝛿</ci><apply id="A3.p3.6.m6.4.4.4.3.cmml" xref="A3.p3.6.m6.4.4.4.3"><csymbol cd="ambiguous" id="A3.p3.6.m6.4.4.4.3.1.cmml" xref="A3.p3.6.m6.4.4.4.3">subscript</csymbol><ci id="A3.p3.6.m6.4.4.4.3.2.cmml" xref="A3.p3.6.m6.4.4.4.3.2">𝑞</ci><ci id="A3.p3.6.m6.4.4.4.3.3.cmml" xref="A3.p3.6.m6.4.4.4.3.3">𝑡</ci></apply><ci id="A3.p3.6.m6.1.1.cmml" xref="A3.p3.6.m6.1.1">𝐱</ci></apply><apply id="A3.p3.6.m6.4.4.2.cmml" xref="A3.p3.6.m6.4.4.2"><times id="A3.p3.6.m6.4.4.2.3.cmml" xref="A3.p3.6.m6.4.4.2.3"></times><apply id="A3.p3.6.m6.3.3.1.1.cmml" xref="A3.p3.6.m6.3.3.1.1"><csymbol cd="ambiguous" id="A3.p3.6.m6.3.3.1.1.2.cmml" xref="A3.p3.6.m6.3.3.1.1">superscript</csymbol><apply id="A3.p3.6.m6.3.3.1.1.1.1.1.cmml" xref="A3.p3.6.m6.3.3.1.1.1.1"><csymbol cd="ambiguous" id="A3.p3.6.m6.3.3.1.1.1.1.1.1.cmml" xref="A3.p3.6.m6.3.3.1.1.1.1">superscript</csymbol><ci id="A3.p3.6.m6.3.3.1.1.1.1.1.2.cmml" xref="A3.p3.6.m6.3.3.1.1.1.1.1.2">𝑓</ci><ci id="A3.p3.6.m6.3.3.1.1.1.1.1.3.cmml" xref="A3.p3.6.m6.3.3.1.1.1.1.1.3">′</ci></apply><apply id="A3.p3.6.m6.3.3.1.1.3.cmml" xref="A3.p3.6.m6.3.3.1.1.3"><minus id="A3.p3.6.m6.3.3.1.1.3.1.cmml" xref="A3.p3.6.m6.3.3.1.1.3"></minus><cn id="A3.p3.6.m6.3.3.1.1.3.2.cmml" type="integer" xref="A3.p3.6.m6.3.3.1.1.3.2">1</cn></apply></apply><apply id="A3.p3.6.m6.4.4.2.2.1.1.cmml" xref="A3.p3.6.m6.4.4.2.2.1"><times id="A3.p3.6.m6.4.4.2.2.1.1.1.cmml" xref="A3.p3.6.m6.4.4.2.2.1.1.1"></times><apply id="A3.p3.6.m6.4.4.2.2.1.1.2.cmml" xref="A3.p3.6.m6.4.4.2.2.1.1.2"><csymbol cd="ambiguous" id="A3.p3.6.m6.4.4.2.2.1.1.2.1.cmml" xref="A3.p3.6.m6.4.4.2.2.1.1.2">subscript</csymbol><apply id="A3.p3.6.m6.4.4.2.2.1.1.2.2.cmml" xref="A3.p3.6.m6.4.4.2.2.1.1.2"><csymbol cd="ambiguous" id="A3.p3.6.m6.4.4.2.2.1.1.2.2.1.cmml" xref="A3.p3.6.m6.4.4.2.2.1.1.2">superscript</csymbol><ci id="A3.p3.6.m6.4.4.2.2.1.1.2.2.2.cmml" xref="A3.p3.6.m6.4.4.2.2.1.1.2.2.2">𝑢</ci><times id="A3.p3.6.m6.4.4.2.2.1.1.2.2.3.cmml" xref="A3.p3.6.m6.4.4.2.2.1.1.2.2.3"></times></apply><ci id="A3.p3.6.m6.4.4.2.2.1.1.2.3.cmml" xref="A3.p3.6.m6.4.4.2.2.1.1.2.3">𝑡</ci></apply><ci id="A3.p3.6.m6.2.2.cmml" xref="A3.p3.6.m6.2.2">𝐱</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.6.m6.4c">\delta q_{t}(\mathbf{x})=\left(f^{\prime}\right)^{-1}(u^{*}_{t}(\mathbf{x}))</annotation><annotation encoding="application/x-llamapun" id="A3.p3.6.m6.4d">italic_δ italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_x ) = ( italic_f start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( italic_u start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_x ) )</annotation></semantics></math> which is thus also a tree with the same leaf supports and leaf values given by <math alttext="v_{j}\coloneqq\left(f^{\prime}\right)^{-1}(w_{j})" class="ltx_Math" display="inline" id="A3.p3.7.m7.2"><semantics id="A3.p3.7.m7.2a"><mrow id="A3.p3.7.m7.2.2" xref="A3.p3.7.m7.2.2.cmml"><msub id="A3.p3.7.m7.2.2.4" xref="A3.p3.7.m7.2.2.4.cmml"><mi id="A3.p3.7.m7.2.2.4.2" xref="A3.p3.7.m7.2.2.4.2.cmml">v</mi><mi id="A3.p3.7.m7.2.2.4.3" xref="A3.p3.7.m7.2.2.4.3.cmml">j</mi></msub><mo id="A3.p3.7.m7.2.2.3" xref="A3.p3.7.m7.2.2.3.cmml">≔</mo><mrow id="A3.p3.7.m7.2.2.2" xref="A3.p3.7.m7.2.2.2.cmml"><msup id="A3.p3.7.m7.1.1.1.1" xref="A3.p3.7.m7.1.1.1.1.cmml"><mrow id="A3.p3.7.m7.1.1.1.1.1.1" xref="A3.p3.7.m7.1.1.1.1.1.1.1.cmml"><mo id="A3.p3.7.m7.1.1.1.1.1.1.2" xref="A3.p3.7.m7.1.1.1.1.1.1.1.cmml">(</mo><msup id="A3.p3.7.m7.1.1.1.1.1.1.1" xref="A3.p3.7.m7.1.1.1.1.1.1.1.cmml"><mi id="A3.p3.7.m7.1.1.1.1.1.1.1.2" xref="A3.p3.7.m7.1.1.1.1.1.1.1.2.cmml">f</mi><mo id="A3.p3.7.m7.1.1.1.1.1.1.1.3" xref="A3.p3.7.m7.1.1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="A3.p3.7.m7.1.1.1.1.1.1.3" xref="A3.p3.7.m7.1.1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="A3.p3.7.m7.1.1.1.1.3" xref="A3.p3.7.m7.1.1.1.1.3.cmml"><mo id="A3.p3.7.m7.1.1.1.1.3a" xref="A3.p3.7.m7.1.1.1.1.3.cmml">−</mo><mn id="A3.p3.7.m7.1.1.1.1.3.2" xref="A3.p3.7.m7.1.1.1.1.3.2.cmml">1</mn></mrow></msup><mo id="A3.p3.7.m7.2.2.2.3" xref="A3.p3.7.m7.2.2.2.3.cmml">⁢</mo><mrow id="A3.p3.7.m7.2.2.2.2.1" xref="A3.p3.7.m7.2.2.2.2.1.1.cmml"><mo id="A3.p3.7.m7.2.2.2.2.1.2" stretchy="false" xref="A3.p3.7.m7.2.2.2.2.1.1.cmml">(</mo><msub id="A3.p3.7.m7.2.2.2.2.1.1" xref="A3.p3.7.m7.2.2.2.2.1.1.cmml"><mi id="A3.p3.7.m7.2.2.2.2.1.1.2" xref="A3.p3.7.m7.2.2.2.2.1.1.2.cmml">w</mi><mi id="A3.p3.7.m7.2.2.2.2.1.1.3" xref="A3.p3.7.m7.2.2.2.2.1.1.3.cmml">j</mi></msub><mo id="A3.p3.7.m7.2.2.2.2.1.3" stretchy="false" xref="A3.p3.7.m7.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.p3.7.m7.2b"><apply id="A3.p3.7.m7.2.2.cmml" xref="A3.p3.7.m7.2.2"><ci id="A3.p3.7.m7.2.2.3.cmml" xref="A3.p3.7.m7.2.2.3">≔</ci><apply id="A3.p3.7.m7.2.2.4.cmml" xref="A3.p3.7.m7.2.2.4"><csymbol cd="ambiguous" id="A3.p3.7.m7.2.2.4.1.cmml" xref="A3.p3.7.m7.2.2.4">subscript</csymbol><ci id="A3.p3.7.m7.2.2.4.2.cmml" xref="A3.p3.7.m7.2.2.4.2">𝑣</ci><ci id="A3.p3.7.m7.2.2.4.3.cmml" xref="A3.p3.7.m7.2.2.4.3">𝑗</ci></apply><apply id="A3.p3.7.m7.2.2.2.cmml" xref="A3.p3.7.m7.2.2.2"><times id="A3.p3.7.m7.2.2.2.3.cmml" xref="A3.p3.7.m7.2.2.2.3"></times><apply id="A3.p3.7.m7.1.1.1.1.cmml" xref="A3.p3.7.m7.1.1.1.1"><csymbol cd="ambiguous" id="A3.p3.7.m7.1.1.1.1.2.cmml" xref="A3.p3.7.m7.1.1.1.1">superscript</csymbol><apply id="A3.p3.7.m7.1.1.1.1.1.1.1.cmml" xref="A3.p3.7.m7.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.p3.7.m7.1.1.1.1.1.1.1.1.cmml" xref="A3.p3.7.m7.1.1.1.1.1.1">superscript</csymbol><ci id="A3.p3.7.m7.1.1.1.1.1.1.1.2.cmml" xref="A3.p3.7.m7.1.1.1.1.1.1.1.2">𝑓</ci><ci id="A3.p3.7.m7.1.1.1.1.1.1.1.3.cmml" xref="A3.p3.7.m7.1.1.1.1.1.1.1.3">′</ci></apply><apply id="A3.p3.7.m7.1.1.1.1.3.cmml" xref="A3.p3.7.m7.1.1.1.1.3"><minus id="A3.p3.7.m7.1.1.1.1.3.1.cmml" xref="A3.p3.7.m7.1.1.1.1.3"></minus><cn id="A3.p3.7.m7.1.1.1.1.3.2.cmml" type="integer" xref="A3.p3.7.m7.1.1.1.1.3.2">1</cn></apply></apply><apply id="A3.p3.7.m7.2.2.2.2.1.1.cmml" xref="A3.p3.7.m7.2.2.2.2.1"><csymbol cd="ambiguous" id="A3.p3.7.m7.2.2.2.2.1.1.1.cmml" xref="A3.p3.7.m7.2.2.2.2.1">subscript</csymbol><ci id="A3.p3.7.m7.2.2.2.2.1.1.2.cmml" xref="A3.p3.7.m7.2.2.2.2.1.1.2">𝑤</ci><ci id="A3.p3.7.m7.2.2.2.2.1.1.3.cmml" xref="A3.p3.7.m7.2.2.2.2.1.1.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.7.m7.2c">v_{j}\coloneqq\left(f^{\prime}\right)^{-1}(w_{j})</annotation><annotation encoding="application/x-llamapun" id="A3.p3.7.m7.2d">italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ≔ ( italic_f start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT )</annotation></semantics></math>.
This leads to the seaprable optimization problem:</p>
<table class="ltx_equation ltx_eqn_table" id="A3.E63">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\max_{w_{1},\ldots,w_{J},X_{1},\ldots,X_{J}}\sum_{j}^{J}\left[P(X_{j})w_{j}-Q(%
X_{j})f^{*}(w_{j})\right]\,." class="ltx_Math" display="block" id="A3.E63.m1.7"><semantics id="A3.E63.m1.7a"><mrow id="A3.E63.m1.7.7.1" xref="A3.E63.m1.7.7.1.1.cmml"><mrow id="A3.E63.m1.7.7.1.1" xref="A3.E63.m1.7.7.1.1.cmml"><munder id="A3.E63.m1.7.7.1.1.3" xref="A3.E63.m1.7.7.1.1.3.cmml"><mi id="A3.E63.m1.7.7.1.1.3.2" xref="A3.E63.m1.7.7.1.1.3.2.cmml">max</mi><mrow id="A3.E63.m1.6.6.6.6" xref="A3.E63.m1.6.6.6.7.cmml"><msub id="A3.E63.m1.3.3.3.3.1" xref="A3.E63.m1.3.3.3.3.1.cmml"><mi id="A3.E63.m1.3.3.3.3.1.2" xref="A3.E63.m1.3.3.3.3.1.2.cmml">w</mi><mn id="A3.E63.m1.3.3.3.3.1.3" xref="A3.E63.m1.3.3.3.3.1.3.cmml">1</mn></msub><mo id="A3.E63.m1.6.6.6.6.5" xref="A3.E63.m1.6.6.6.7.cmml">,</mo><mi id="A3.E63.m1.1.1.1.1" mathvariant="normal" xref="A3.E63.m1.1.1.1.1.cmml">…</mi><mo id="A3.E63.m1.6.6.6.6.6" xref="A3.E63.m1.6.6.6.7.cmml">,</mo><msub id="A3.E63.m1.4.4.4.4.2" xref="A3.E63.m1.4.4.4.4.2.cmml"><mi id="A3.E63.m1.4.4.4.4.2.2" xref="A3.E63.m1.4.4.4.4.2.2.cmml">w</mi><mi id="A3.E63.m1.4.4.4.4.2.3" xref="A3.E63.m1.4.4.4.4.2.3.cmml">J</mi></msub><mo id="A3.E63.m1.6.6.6.6.7" xref="A3.E63.m1.6.6.6.7.cmml">,</mo><msub id="A3.E63.m1.5.5.5.5.3" xref="A3.E63.m1.5.5.5.5.3.cmml"><mi id="A3.E63.m1.5.5.5.5.3.2" xref="A3.E63.m1.5.5.5.5.3.2.cmml">X</mi><mn id="A3.E63.m1.5.5.5.5.3.3" xref="A3.E63.m1.5.5.5.5.3.3.cmml">1</mn></msub><mo id="A3.E63.m1.6.6.6.6.8" xref="A3.E63.m1.6.6.6.7.cmml">,</mo><mi id="A3.E63.m1.2.2.2.2" mathvariant="normal" xref="A3.E63.m1.2.2.2.2.cmml">…</mi><mo id="A3.E63.m1.6.6.6.6.9" xref="A3.E63.m1.6.6.6.7.cmml">,</mo><msub id="A3.E63.m1.6.6.6.6.4" xref="A3.E63.m1.6.6.6.6.4.cmml"><mi id="A3.E63.m1.6.6.6.6.4.2" xref="A3.E63.m1.6.6.6.6.4.2.cmml">X</mi><mi id="A3.E63.m1.6.6.6.6.4.3" xref="A3.E63.m1.6.6.6.6.4.3.cmml">J</mi></msub></mrow></munder><mo id="A3.E63.m1.7.7.1.1.2" xref="A3.E63.m1.7.7.1.1.2.cmml">⁢</mo><mrow id="A3.E63.m1.7.7.1.1.1" xref="A3.E63.m1.7.7.1.1.1.cmml"><munderover id="A3.E63.m1.7.7.1.1.1.2" xref="A3.E63.m1.7.7.1.1.1.2.cmml"><mo id="A3.E63.m1.7.7.1.1.1.2.2.2" movablelimits="false" rspace="0em" xref="A3.E63.m1.7.7.1.1.1.2.2.2.cmml">∑</mo><mi id="A3.E63.m1.7.7.1.1.1.2.2.3" xref="A3.E63.m1.7.7.1.1.1.2.2.3.cmml">j</mi><mi id="A3.E63.m1.7.7.1.1.1.2.3" xref="A3.E63.m1.7.7.1.1.1.2.3.cmml">J</mi></munderover><mrow id="A3.E63.m1.7.7.1.1.1.1.1" xref="A3.E63.m1.7.7.1.1.1.1.2.cmml"><mo id="A3.E63.m1.7.7.1.1.1.1.1.2" xref="A3.E63.m1.7.7.1.1.1.1.2.1.cmml">[</mo><mrow id="A3.E63.m1.7.7.1.1.1.1.1.1" xref="A3.E63.m1.7.7.1.1.1.1.1.1.cmml"><mrow id="A3.E63.m1.7.7.1.1.1.1.1.1.1" xref="A3.E63.m1.7.7.1.1.1.1.1.1.1.cmml"><mi id="A3.E63.m1.7.7.1.1.1.1.1.1.1.3" xref="A3.E63.m1.7.7.1.1.1.1.1.1.1.3.cmml">P</mi><mo id="A3.E63.m1.7.7.1.1.1.1.1.1.1.2" xref="A3.E63.m1.7.7.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A3.E63.m1.7.7.1.1.1.1.1.1.1.1.1" xref="A3.E63.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A3.E63.m1.7.7.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A3.E63.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A3.E63.m1.7.7.1.1.1.1.1.1.1.1.1.1" xref="A3.E63.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A3.E63.m1.7.7.1.1.1.1.1.1.1.1.1.1.2" xref="A3.E63.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.cmml">X</mi><mi id="A3.E63.m1.7.7.1.1.1.1.1.1.1.1.1.1.3" xref="A3.E63.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="A3.E63.m1.7.7.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A3.E63.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A3.E63.m1.7.7.1.1.1.1.1.1.1.2a" xref="A3.E63.m1.7.7.1.1.1.1.1.1.1.2.cmml">⁢</mo><msub id="A3.E63.m1.7.7.1.1.1.1.1.1.1.4" xref="A3.E63.m1.7.7.1.1.1.1.1.1.1.4.cmml"><mi id="A3.E63.m1.7.7.1.1.1.1.1.1.1.4.2" xref="A3.E63.m1.7.7.1.1.1.1.1.1.1.4.2.cmml">w</mi><mi id="A3.E63.m1.7.7.1.1.1.1.1.1.1.4.3" xref="A3.E63.m1.7.7.1.1.1.1.1.1.1.4.3.cmml">j</mi></msub></mrow><mo id="A3.E63.m1.7.7.1.1.1.1.1.1.4" xref="A3.E63.m1.7.7.1.1.1.1.1.1.4.cmml">−</mo><mrow id="A3.E63.m1.7.7.1.1.1.1.1.1.3" xref="A3.E63.m1.7.7.1.1.1.1.1.1.3.cmml"><mi id="A3.E63.m1.7.7.1.1.1.1.1.1.3.4" xref="A3.E63.m1.7.7.1.1.1.1.1.1.3.4.cmml">Q</mi><mo id="A3.E63.m1.7.7.1.1.1.1.1.1.3.3" xref="A3.E63.m1.7.7.1.1.1.1.1.1.3.3.cmml">⁢</mo><mrow id="A3.E63.m1.7.7.1.1.1.1.1.1.2.1.1" xref="A3.E63.m1.7.7.1.1.1.1.1.1.2.1.1.1.cmml"><mo id="A3.E63.m1.7.7.1.1.1.1.1.1.2.1.1.2" stretchy="false" xref="A3.E63.m1.7.7.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><msub id="A3.E63.m1.7.7.1.1.1.1.1.1.2.1.1.1" xref="A3.E63.m1.7.7.1.1.1.1.1.1.2.1.1.1.cmml"><mi id="A3.E63.m1.7.7.1.1.1.1.1.1.2.1.1.1.2" xref="A3.E63.m1.7.7.1.1.1.1.1.1.2.1.1.1.2.cmml">X</mi><mi id="A3.E63.m1.7.7.1.1.1.1.1.1.2.1.1.1.3" xref="A3.E63.m1.7.7.1.1.1.1.1.1.2.1.1.1.3.cmml">j</mi></msub><mo id="A3.E63.m1.7.7.1.1.1.1.1.1.2.1.1.3" stretchy="false" xref="A3.E63.m1.7.7.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow><mo id="A3.E63.m1.7.7.1.1.1.1.1.1.3.3a" xref="A3.E63.m1.7.7.1.1.1.1.1.1.3.3.cmml">⁢</mo><msup id="A3.E63.m1.7.7.1.1.1.1.1.1.3.5" xref="A3.E63.m1.7.7.1.1.1.1.1.1.3.5.cmml"><mi id="A3.E63.m1.7.7.1.1.1.1.1.1.3.5.2" xref="A3.E63.m1.7.7.1.1.1.1.1.1.3.5.2.cmml">f</mi><mo id="A3.E63.m1.7.7.1.1.1.1.1.1.3.5.3" xref="A3.E63.m1.7.7.1.1.1.1.1.1.3.5.3.cmml">∗</mo></msup><mo id="A3.E63.m1.7.7.1.1.1.1.1.1.3.3b" xref="A3.E63.m1.7.7.1.1.1.1.1.1.3.3.cmml">⁢</mo><mrow id="A3.E63.m1.7.7.1.1.1.1.1.1.3.2.1" xref="A3.E63.m1.7.7.1.1.1.1.1.1.3.2.1.1.cmml"><mo id="A3.E63.m1.7.7.1.1.1.1.1.1.3.2.1.2" stretchy="false" xref="A3.E63.m1.7.7.1.1.1.1.1.1.3.2.1.1.cmml">(</mo><msub id="A3.E63.m1.7.7.1.1.1.1.1.1.3.2.1.1" xref="A3.E63.m1.7.7.1.1.1.1.1.1.3.2.1.1.cmml"><mi id="A3.E63.m1.7.7.1.1.1.1.1.1.3.2.1.1.2" xref="A3.E63.m1.7.7.1.1.1.1.1.1.3.2.1.1.2.cmml">w</mi><mi id="A3.E63.m1.7.7.1.1.1.1.1.1.3.2.1.1.3" xref="A3.E63.m1.7.7.1.1.1.1.1.1.3.2.1.1.3.cmml">j</mi></msub><mo id="A3.E63.m1.7.7.1.1.1.1.1.1.3.2.1.3" stretchy="false" xref="A3.E63.m1.7.7.1.1.1.1.1.1.3.2.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A3.E63.m1.7.7.1.1.1.1.1.3" xref="A3.E63.m1.7.7.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="A3.E63.m1.7.7.1.2" lspace="0.170em" xref="A3.E63.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E63.m1.7b"><apply id="A3.E63.m1.7.7.1.1.cmml" xref="A3.E63.m1.7.7.1"><times id="A3.E63.m1.7.7.1.1.2.cmml" xref="A3.E63.m1.7.7.1.1.2"></times><apply id="A3.E63.m1.7.7.1.1.3.cmml" xref="A3.E63.m1.7.7.1.1.3"><csymbol cd="ambiguous" id="A3.E63.m1.7.7.1.1.3.1.cmml" xref="A3.E63.m1.7.7.1.1.3">subscript</csymbol><max id="A3.E63.m1.7.7.1.1.3.2.cmml" xref="A3.E63.m1.7.7.1.1.3.2"></max><list id="A3.E63.m1.6.6.6.7.cmml" xref="A3.E63.m1.6.6.6.6"><apply id="A3.E63.m1.3.3.3.3.1.cmml" xref="A3.E63.m1.3.3.3.3.1"><csymbol cd="ambiguous" id="A3.E63.m1.3.3.3.3.1.1.cmml" xref="A3.E63.m1.3.3.3.3.1">subscript</csymbol><ci id="A3.E63.m1.3.3.3.3.1.2.cmml" xref="A3.E63.m1.3.3.3.3.1.2">𝑤</ci><cn id="A3.E63.m1.3.3.3.3.1.3.cmml" type="integer" xref="A3.E63.m1.3.3.3.3.1.3">1</cn></apply><ci id="A3.E63.m1.1.1.1.1.cmml" xref="A3.E63.m1.1.1.1.1">…</ci><apply id="A3.E63.m1.4.4.4.4.2.cmml" xref="A3.E63.m1.4.4.4.4.2"><csymbol cd="ambiguous" id="A3.E63.m1.4.4.4.4.2.1.cmml" xref="A3.E63.m1.4.4.4.4.2">subscript</csymbol><ci id="A3.E63.m1.4.4.4.4.2.2.cmml" xref="A3.E63.m1.4.4.4.4.2.2">𝑤</ci><ci id="A3.E63.m1.4.4.4.4.2.3.cmml" xref="A3.E63.m1.4.4.4.4.2.3">𝐽</ci></apply><apply id="A3.E63.m1.5.5.5.5.3.cmml" xref="A3.E63.m1.5.5.5.5.3"><csymbol cd="ambiguous" id="A3.E63.m1.5.5.5.5.3.1.cmml" xref="A3.E63.m1.5.5.5.5.3">subscript</csymbol><ci id="A3.E63.m1.5.5.5.5.3.2.cmml" xref="A3.E63.m1.5.5.5.5.3.2">𝑋</ci><cn id="A3.E63.m1.5.5.5.5.3.3.cmml" type="integer" xref="A3.E63.m1.5.5.5.5.3.3">1</cn></apply><ci id="A3.E63.m1.2.2.2.2.cmml" xref="A3.E63.m1.2.2.2.2">…</ci><apply id="A3.E63.m1.6.6.6.6.4.cmml" xref="A3.E63.m1.6.6.6.6.4"><csymbol cd="ambiguous" id="A3.E63.m1.6.6.6.6.4.1.cmml" xref="A3.E63.m1.6.6.6.6.4">subscript</csymbol><ci id="A3.E63.m1.6.6.6.6.4.2.cmml" xref="A3.E63.m1.6.6.6.6.4.2">𝑋</ci><ci id="A3.E63.m1.6.6.6.6.4.3.cmml" xref="A3.E63.m1.6.6.6.6.4.3">𝐽</ci></apply></list></apply><apply id="A3.E63.m1.7.7.1.1.1.cmml" xref="A3.E63.m1.7.7.1.1.1"><apply id="A3.E63.m1.7.7.1.1.1.2.cmml" xref="A3.E63.m1.7.7.1.1.1.2"><csymbol cd="ambiguous" id="A3.E63.m1.7.7.1.1.1.2.1.cmml" xref="A3.E63.m1.7.7.1.1.1.2">superscript</csymbol><apply id="A3.E63.m1.7.7.1.1.1.2.2.cmml" xref="A3.E63.m1.7.7.1.1.1.2"><csymbol cd="ambiguous" id="A3.E63.m1.7.7.1.1.1.2.2.1.cmml" xref="A3.E63.m1.7.7.1.1.1.2">subscript</csymbol><sum id="A3.E63.m1.7.7.1.1.1.2.2.2.cmml" xref="A3.E63.m1.7.7.1.1.1.2.2.2"></sum><ci id="A3.E63.m1.7.7.1.1.1.2.2.3.cmml" xref="A3.E63.m1.7.7.1.1.1.2.2.3">𝑗</ci></apply><ci id="A3.E63.m1.7.7.1.1.1.2.3.cmml" xref="A3.E63.m1.7.7.1.1.1.2.3">𝐽</ci></apply><apply id="A3.E63.m1.7.7.1.1.1.1.2.cmml" xref="A3.E63.m1.7.7.1.1.1.1.1"><csymbol cd="latexml" id="A3.E63.m1.7.7.1.1.1.1.2.1.cmml" xref="A3.E63.m1.7.7.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A3.E63.m1.7.7.1.1.1.1.1.1.cmml" xref="A3.E63.m1.7.7.1.1.1.1.1.1"><minus id="A3.E63.m1.7.7.1.1.1.1.1.1.4.cmml" xref="A3.E63.m1.7.7.1.1.1.1.1.1.4"></minus><apply id="A3.E63.m1.7.7.1.1.1.1.1.1.1.cmml" xref="A3.E63.m1.7.7.1.1.1.1.1.1.1"><times id="A3.E63.m1.7.7.1.1.1.1.1.1.1.2.cmml" xref="A3.E63.m1.7.7.1.1.1.1.1.1.1.2"></times><ci id="A3.E63.m1.7.7.1.1.1.1.1.1.1.3.cmml" xref="A3.E63.m1.7.7.1.1.1.1.1.1.1.3">𝑃</ci><apply id="A3.E63.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E63.m1.7.7.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E63.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E63.m1.7.7.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A3.E63.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E63.m1.7.7.1.1.1.1.1.1.1.1.1.1.2">𝑋</ci><ci id="A3.E63.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A3.E63.m1.7.7.1.1.1.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="A3.E63.m1.7.7.1.1.1.1.1.1.1.4.cmml" xref="A3.E63.m1.7.7.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A3.E63.m1.7.7.1.1.1.1.1.1.1.4.1.cmml" xref="A3.E63.m1.7.7.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="A3.E63.m1.7.7.1.1.1.1.1.1.1.4.2.cmml" xref="A3.E63.m1.7.7.1.1.1.1.1.1.1.4.2">𝑤</ci><ci id="A3.E63.m1.7.7.1.1.1.1.1.1.1.4.3.cmml" xref="A3.E63.m1.7.7.1.1.1.1.1.1.1.4.3">𝑗</ci></apply></apply><apply id="A3.E63.m1.7.7.1.1.1.1.1.1.3.cmml" xref="A3.E63.m1.7.7.1.1.1.1.1.1.3"><times id="A3.E63.m1.7.7.1.1.1.1.1.1.3.3.cmml" xref="A3.E63.m1.7.7.1.1.1.1.1.1.3.3"></times><ci id="A3.E63.m1.7.7.1.1.1.1.1.1.3.4.cmml" xref="A3.E63.m1.7.7.1.1.1.1.1.1.3.4">𝑄</ci><apply id="A3.E63.m1.7.7.1.1.1.1.1.1.2.1.1.1.cmml" xref="A3.E63.m1.7.7.1.1.1.1.1.1.2.1.1"><csymbol cd="ambiguous" id="A3.E63.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="A3.E63.m1.7.7.1.1.1.1.1.1.2.1.1">subscript</csymbol><ci id="A3.E63.m1.7.7.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="A3.E63.m1.7.7.1.1.1.1.1.1.2.1.1.1.2">𝑋</ci><ci id="A3.E63.m1.7.7.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="A3.E63.m1.7.7.1.1.1.1.1.1.2.1.1.1.3">𝑗</ci></apply><apply id="A3.E63.m1.7.7.1.1.1.1.1.1.3.5.cmml" xref="A3.E63.m1.7.7.1.1.1.1.1.1.3.5"><csymbol cd="ambiguous" id="A3.E63.m1.7.7.1.1.1.1.1.1.3.5.1.cmml" xref="A3.E63.m1.7.7.1.1.1.1.1.1.3.5">superscript</csymbol><ci id="A3.E63.m1.7.7.1.1.1.1.1.1.3.5.2.cmml" xref="A3.E63.m1.7.7.1.1.1.1.1.1.3.5.2">𝑓</ci><times id="A3.E63.m1.7.7.1.1.1.1.1.1.3.5.3.cmml" xref="A3.E63.m1.7.7.1.1.1.1.1.1.3.5.3"></times></apply><apply id="A3.E63.m1.7.7.1.1.1.1.1.1.3.2.1.1.cmml" xref="A3.E63.m1.7.7.1.1.1.1.1.1.3.2.1"><csymbol cd="ambiguous" id="A3.E63.m1.7.7.1.1.1.1.1.1.3.2.1.1.1.cmml" xref="A3.E63.m1.7.7.1.1.1.1.1.1.3.2.1">subscript</csymbol><ci id="A3.E63.m1.7.7.1.1.1.1.1.1.3.2.1.1.2.cmml" xref="A3.E63.m1.7.7.1.1.1.1.1.1.3.2.1.1.2">𝑤</ci><ci id="A3.E63.m1.7.7.1.1.1.1.1.1.3.2.1.1.3.cmml" xref="A3.E63.m1.7.7.1.1.1.1.1.1.3.2.1.1.3">𝑗</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E63.m1.7c">\max_{w_{1},\ldots,w_{J},X_{1},\ldots,X_{J}}\sum_{j}^{J}\left[P(X_{j})w_{j}-Q(%
X_{j})f^{*}(w_{j})\right]\,.</annotation><annotation encoding="application/x-llamapun" id="A3.E63.m1.7d">roman_max start_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_w start_POSTSUBSCRIPT italic_J end_POSTSUBSCRIPT , italic_X start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_X start_POSTSUBSCRIPT italic_J end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_J end_POSTSUPERSCRIPT [ italic_P ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT - italic_Q ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) italic_f start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(63)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A3.p3.10">Note that we drop the iteration indices from this point onwards for brevity. Maximizing over <math alttext="w_{j}" class="ltx_Math" display="inline" id="A3.p3.8.m1.1"><semantics id="A3.p3.8.m1.1a"><msub id="A3.p3.8.m1.1.1" xref="A3.p3.8.m1.1.1.cmml"><mi id="A3.p3.8.m1.1.1.2" xref="A3.p3.8.m1.1.1.2.cmml">w</mi><mi id="A3.p3.8.m1.1.1.3" xref="A3.p3.8.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p3.8.m1.1b"><apply id="A3.p3.8.m1.1.1.cmml" xref="A3.p3.8.m1.1.1"><csymbol cd="ambiguous" id="A3.p3.8.m1.1.1.1.cmml" xref="A3.p3.8.m1.1.1">subscript</csymbol><ci id="A3.p3.8.m1.1.1.2.cmml" xref="A3.p3.8.m1.1.1.2">𝑤</ci><ci id="A3.p3.8.m1.1.1.3.cmml" xref="A3.p3.8.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.8.m1.1c">w_{j}</annotation><annotation encoding="application/x-llamapun" id="A3.p3.8.m1.1d">italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> with the <math alttext="X_{j}" class="ltx_Math" display="inline" id="A3.p3.9.m2.1"><semantics id="A3.p3.9.m2.1a"><msub id="A3.p3.9.m2.1.1" xref="A3.p3.9.m2.1.1.cmml"><mi id="A3.p3.9.m2.1.1.2" xref="A3.p3.9.m2.1.1.2.cmml">X</mi><mi id="A3.p3.9.m2.1.1.3" xref="A3.p3.9.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p3.9.m2.1b"><apply id="A3.p3.9.m2.1.1.cmml" xref="A3.p3.9.m2.1.1"><csymbol cd="ambiguous" id="A3.p3.9.m2.1.1.1.cmml" xref="A3.p3.9.m2.1.1">subscript</csymbol><ci id="A3.p3.9.m2.1.1.2.cmml" xref="A3.p3.9.m2.1.1.2">𝑋</ci><ci id="A3.p3.9.m2.1.1.3.cmml" xref="A3.p3.9.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.9.m2.1c">X_{j}</annotation><annotation encoding="application/x-llamapun" id="A3.p3.9.m2.1d">italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> fixed we have that <math alttext="w_{j}^{*}=f^{\prime}\left(\nicefrac{{P(X_{j})}}{{Q(X_{j})}}\right)" class="ltx_Math" display="inline" id="A3.p3.10.m3.2"><semantics id="A3.p3.10.m3.2a"><mrow id="A3.p3.10.m3.2.3" xref="A3.p3.10.m3.2.3.cmml"><msubsup id="A3.p3.10.m3.2.3.2" xref="A3.p3.10.m3.2.3.2.cmml"><mi id="A3.p3.10.m3.2.3.2.2.2" xref="A3.p3.10.m3.2.3.2.2.2.cmml">w</mi><mi id="A3.p3.10.m3.2.3.2.2.3" xref="A3.p3.10.m3.2.3.2.2.3.cmml">j</mi><mo id="A3.p3.10.m3.2.3.2.3" xref="A3.p3.10.m3.2.3.2.3.cmml">∗</mo></msubsup><mo id="A3.p3.10.m3.2.3.1" xref="A3.p3.10.m3.2.3.1.cmml">=</mo><mrow id="A3.p3.10.m3.2.3.3" xref="A3.p3.10.m3.2.3.3.cmml"><msup id="A3.p3.10.m3.2.3.3.2" xref="A3.p3.10.m3.2.3.3.2.cmml"><mi id="A3.p3.10.m3.2.3.3.2.2" xref="A3.p3.10.m3.2.3.3.2.2.cmml">f</mi><mo id="A3.p3.10.m3.2.3.3.2.3" xref="A3.p3.10.m3.2.3.3.2.3.cmml">′</mo></msup><mo id="A3.p3.10.m3.2.3.3.1" xref="A3.p3.10.m3.2.3.3.1.cmml">⁢</mo><mrow id="A3.p3.10.m3.2.3.3.3.2" xref="A3.p3.10.m3.2.2.cmml"><mo id="A3.p3.10.m3.2.3.3.3.2.1" xref="A3.p3.10.m3.2.2.cmml">(</mo><mrow id="A3.p3.10.m3.2.2" xref="A3.p3.10.m3.2.2.cmml"><mpadded id="A3.p3.10.m3.1.1.1" voffset="0.3em" xref="A3.p3.10.m3.1.1.1.cmml"><mi id="A3.p3.10.m3.1.1.1.3" mathsize="70%" xref="A3.p3.10.m3.1.1.1.3.cmml">P</mi><mo id="A3.p3.10.m3.1.1.1.2" xref="A3.p3.10.m3.1.1.1.2.cmml">⁢</mo><mrow id="A3.p3.10.m3.1.1.1.1.1" xref="A3.p3.10.m3.1.1.1.1.1.1.cmml"><mo id="A3.p3.10.m3.1.1.1.1.1.2" maxsize="70%" minsize="70%" xref="A3.p3.10.m3.1.1.1.1.1.1.cmml">(</mo><msub id="A3.p3.10.m3.1.1.1.1.1.1" xref="A3.p3.10.m3.1.1.1.1.1.1.cmml"><mi id="A3.p3.10.m3.1.1.1.1.1.1.2" mathsize="70%" xref="A3.p3.10.m3.1.1.1.1.1.1.2.cmml">X</mi><mi id="A3.p3.10.m3.1.1.1.1.1.1.3" mathsize="71%" xref="A3.p3.10.m3.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="A3.p3.10.m3.1.1.1.1.1.3" maxsize="70%" minsize="70%" xref="A3.p3.10.m3.1.1.1.1.1.1.cmml">)</mo></mrow></mpadded><mpadded id="A3.p3.10.m3.2.2.3" lspace="-0.1em" width="-0.15em" xref="A3.p3.10.m3.2.2.3.cmml"><mo id="A3.p3.10.m3.2.2.3a" stretchy="true" symmetric="true" xref="A3.p3.10.m3.2.2.3.cmml">/</mo></mpadded><mrow id="A3.p3.10.m3.2.2.2" xref="A3.p3.10.m3.2.2.2.cmml"><mi id="A3.p3.10.m3.2.2.2.3" mathsize="70%" xref="A3.p3.10.m3.2.2.2.3.cmml">Q</mi><mo id="A3.p3.10.m3.2.2.2.2" xref="A3.p3.10.m3.2.2.2.2.cmml">⁢</mo><mrow id="A3.p3.10.m3.2.2.2.1.1" xref="A3.p3.10.m3.2.2.2.1.1.1.cmml"><mo id="A3.p3.10.m3.2.2.2.1.1.2" maxsize="70%" minsize="70%" xref="A3.p3.10.m3.2.2.2.1.1.1.cmml">(</mo><msub id="A3.p3.10.m3.2.2.2.1.1.1" xref="A3.p3.10.m3.2.2.2.1.1.1.cmml"><mi id="A3.p3.10.m3.2.2.2.1.1.1.2" mathsize="70%" xref="A3.p3.10.m3.2.2.2.1.1.1.2.cmml">X</mi><mi id="A3.p3.10.m3.2.2.2.1.1.1.3" mathsize="71%" xref="A3.p3.10.m3.2.2.2.1.1.1.3.cmml">j</mi></msub><mo id="A3.p3.10.m3.2.2.2.1.1.3" maxsize="70%" minsize="70%" xref="A3.p3.10.m3.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A3.p3.10.m3.2.3.3.3.2.2" xref="A3.p3.10.m3.2.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.p3.10.m3.2b"><apply id="A3.p3.10.m3.2.3.cmml" xref="A3.p3.10.m3.2.3"><eq id="A3.p3.10.m3.2.3.1.cmml" xref="A3.p3.10.m3.2.3.1"></eq><apply id="A3.p3.10.m3.2.3.2.cmml" xref="A3.p3.10.m3.2.3.2"><csymbol cd="ambiguous" id="A3.p3.10.m3.2.3.2.1.cmml" xref="A3.p3.10.m3.2.3.2">superscript</csymbol><apply id="A3.p3.10.m3.2.3.2.2.cmml" xref="A3.p3.10.m3.2.3.2"><csymbol cd="ambiguous" id="A3.p3.10.m3.2.3.2.2.1.cmml" xref="A3.p3.10.m3.2.3.2">subscript</csymbol><ci id="A3.p3.10.m3.2.3.2.2.2.cmml" xref="A3.p3.10.m3.2.3.2.2.2">𝑤</ci><ci id="A3.p3.10.m3.2.3.2.2.3.cmml" xref="A3.p3.10.m3.2.3.2.2.3">𝑗</ci></apply><times id="A3.p3.10.m3.2.3.2.3.cmml" xref="A3.p3.10.m3.2.3.2.3"></times></apply><apply id="A3.p3.10.m3.2.3.3.cmml" xref="A3.p3.10.m3.2.3.3"><times id="A3.p3.10.m3.2.3.3.1.cmml" xref="A3.p3.10.m3.2.3.3.1"></times><apply id="A3.p3.10.m3.2.3.3.2.cmml" xref="A3.p3.10.m3.2.3.3.2"><csymbol cd="ambiguous" id="A3.p3.10.m3.2.3.3.2.1.cmml" xref="A3.p3.10.m3.2.3.3.2">superscript</csymbol><ci id="A3.p3.10.m3.2.3.3.2.2.cmml" xref="A3.p3.10.m3.2.3.3.2.2">𝑓</ci><ci id="A3.p3.10.m3.2.3.3.2.3.cmml" xref="A3.p3.10.m3.2.3.3.2.3">′</ci></apply><apply id="A3.p3.10.m3.2.2.cmml" xref="A3.p3.10.m3.2.3.3.3.2"><divide id="A3.p3.10.m3.2.2.3.cmml" xref="A3.p3.10.m3.2.2.3"></divide><apply id="A3.p3.10.m3.1.1.1.cmml" xref="A3.p3.10.m3.1.1.1"><times id="A3.p3.10.m3.1.1.1.2.cmml" xref="A3.p3.10.m3.1.1.1.2"></times><ci id="A3.p3.10.m3.1.1.1.3.cmml" xref="A3.p3.10.m3.1.1.1.3">𝑃</ci><apply id="A3.p3.10.m3.1.1.1.1.1.1.cmml" xref="A3.p3.10.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.p3.10.m3.1.1.1.1.1.1.1.cmml" xref="A3.p3.10.m3.1.1.1.1.1">subscript</csymbol><ci id="A3.p3.10.m3.1.1.1.1.1.1.2.cmml" xref="A3.p3.10.m3.1.1.1.1.1.1.2">𝑋</ci><ci id="A3.p3.10.m3.1.1.1.1.1.1.3.cmml" xref="A3.p3.10.m3.1.1.1.1.1.1.3">𝑗</ci></apply></apply><apply id="A3.p3.10.m3.2.2.2.cmml" xref="A3.p3.10.m3.2.2.2"><times id="A3.p3.10.m3.2.2.2.2.cmml" xref="A3.p3.10.m3.2.2.2.2"></times><ci id="A3.p3.10.m3.2.2.2.3.cmml" xref="A3.p3.10.m3.2.2.2.3">𝑄</ci><apply id="A3.p3.10.m3.2.2.2.1.1.1.cmml" xref="A3.p3.10.m3.2.2.2.1.1"><csymbol cd="ambiguous" id="A3.p3.10.m3.2.2.2.1.1.1.1.cmml" xref="A3.p3.10.m3.2.2.2.1.1">subscript</csymbol><ci id="A3.p3.10.m3.2.2.2.1.1.1.2.cmml" xref="A3.p3.10.m3.2.2.2.1.1.1.2">𝑋</ci><ci id="A3.p3.10.m3.2.2.2.1.1.1.3.cmml" xref="A3.p3.10.m3.2.2.2.1.1.1.3">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.10.m3.2c">w_{j}^{*}=f^{\prime}\left(\nicefrac{{P(X_{j})}}{{Q(X_{j})}}\right)</annotation><annotation encoding="application/x-llamapun" id="A3.p3.10.m3.2d">italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = italic_f start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( / start_ARG italic_P ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG start_ARG italic_Q ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG )</annotation></semantics></math> which yields the optimal value</p>
<table class="ltx_equation ltx_eqn_table" id="A3.E64">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="J^{*}(X_{1},\ldots,X_{j})=\sum_{j}\left[P(X_{j})f^{\prime}\left(\frac{P(X_{j})%
}{Q(X_{j})}\right)-Q(X_{j})(f^{*}\circ f^{\prime})\left(\frac{P(X_{j})}{Q(X_{j%
})}\right)\right]" class="ltx_Math" display="block" id="A3.E64.m1.8"><semantics id="A3.E64.m1.8a"><mrow id="A3.E64.m1.8.8" xref="A3.E64.m1.8.8.cmml"><mrow id="A3.E64.m1.7.7.2" xref="A3.E64.m1.7.7.2.cmml"><msup id="A3.E64.m1.7.7.2.4" xref="A3.E64.m1.7.7.2.4.cmml"><mi id="A3.E64.m1.7.7.2.4.2" xref="A3.E64.m1.7.7.2.4.2.cmml">J</mi><mo id="A3.E64.m1.7.7.2.4.3" xref="A3.E64.m1.7.7.2.4.3.cmml">∗</mo></msup><mo id="A3.E64.m1.7.7.2.3" xref="A3.E64.m1.7.7.2.3.cmml">⁢</mo><mrow id="A3.E64.m1.7.7.2.2.2" xref="A3.E64.m1.7.7.2.2.3.cmml"><mo id="A3.E64.m1.7.7.2.2.2.3" stretchy="false" xref="A3.E64.m1.7.7.2.2.3.cmml">(</mo><msub id="A3.E64.m1.6.6.1.1.1.1" xref="A3.E64.m1.6.6.1.1.1.1.cmml"><mi id="A3.E64.m1.6.6.1.1.1.1.2" xref="A3.E64.m1.6.6.1.1.1.1.2.cmml">X</mi><mn id="A3.E64.m1.6.6.1.1.1.1.3" xref="A3.E64.m1.6.6.1.1.1.1.3.cmml">1</mn></msub><mo id="A3.E64.m1.7.7.2.2.2.4" xref="A3.E64.m1.7.7.2.2.3.cmml">,</mo><mi id="A3.E64.m1.5.5" mathvariant="normal" xref="A3.E64.m1.5.5.cmml">…</mi><mo id="A3.E64.m1.7.7.2.2.2.5" xref="A3.E64.m1.7.7.2.2.3.cmml">,</mo><msub id="A3.E64.m1.7.7.2.2.2.2" xref="A3.E64.m1.7.7.2.2.2.2.cmml"><mi id="A3.E64.m1.7.7.2.2.2.2.2" xref="A3.E64.m1.7.7.2.2.2.2.2.cmml">X</mi><mi id="A3.E64.m1.7.7.2.2.2.2.3" xref="A3.E64.m1.7.7.2.2.2.2.3.cmml">j</mi></msub><mo id="A3.E64.m1.7.7.2.2.2.6" stretchy="false" xref="A3.E64.m1.7.7.2.2.3.cmml">)</mo></mrow></mrow><mo id="A3.E64.m1.8.8.4" rspace="0.111em" xref="A3.E64.m1.8.8.4.cmml">=</mo><mrow id="A3.E64.m1.8.8.3" xref="A3.E64.m1.8.8.3.cmml"><munder id="A3.E64.m1.8.8.3.2" xref="A3.E64.m1.8.8.3.2.cmml"><mo id="A3.E64.m1.8.8.3.2.2" movablelimits="false" rspace="0em" xref="A3.E64.m1.8.8.3.2.2.cmml">∑</mo><mi id="A3.E64.m1.8.8.3.2.3" xref="A3.E64.m1.8.8.3.2.3.cmml">j</mi></munder><mrow id="A3.E64.m1.8.8.3.1.1" xref="A3.E64.m1.8.8.3.1.2.cmml"><mo id="A3.E64.m1.8.8.3.1.1.2" xref="A3.E64.m1.8.8.3.1.2.1.cmml">[</mo><mrow id="A3.E64.m1.8.8.3.1.1.1" xref="A3.E64.m1.8.8.3.1.1.1.cmml"><mrow id="A3.E64.m1.8.8.3.1.1.1.1" xref="A3.E64.m1.8.8.3.1.1.1.1.cmml"><mi id="A3.E64.m1.8.8.3.1.1.1.1.3" xref="A3.E64.m1.8.8.3.1.1.1.1.3.cmml">P</mi><mo id="A3.E64.m1.8.8.3.1.1.1.1.2" xref="A3.E64.m1.8.8.3.1.1.1.1.2.cmml">⁢</mo><mrow id="A3.E64.m1.8.8.3.1.1.1.1.1.1" xref="A3.E64.m1.8.8.3.1.1.1.1.1.1.1.cmml"><mo id="A3.E64.m1.8.8.3.1.1.1.1.1.1.2" stretchy="false" xref="A3.E64.m1.8.8.3.1.1.1.1.1.1.1.cmml">(</mo><msub id="A3.E64.m1.8.8.3.1.1.1.1.1.1.1" xref="A3.E64.m1.8.8.3.1.1.1.1.1.1.1.cmml"><mi id="A3.E64.m1.8.8.3.1.1.1.1.1.1.1.2" xref="A3.E64.m1.8.8.3.1.1.1.1.1.1.1.2.cmml">X</mi><mi id="A3.E64.m1.8.8.3.1.1.1.1.1.1.1.3" xref="A3.E64.m1.8.8.3.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="A3.E64.m1.8.8.3.1.1.1.1.1.1.3" stretchy="false" xref="A3.E64.m1.8.8.3.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A3.E64.m1.8.8.3.1.1.1.1.2a" xref="A3.E64.m1.8.8.3.1.1.1.1.2.cmml">⁢</mo><msup id="A3.E64.m1.8.8.3.1.1.1.1.4" xref="A3.E64.m1.8.8.3.1.1.1.1.4.cmml"><mi id="A3.E64.m1.8.8.3.1.1.1.1.4.2" xref="A3.E64.m1.8.8.3.1.1.1.1.4.2.cmml">f</mi><mo id="A3.E64.m1.8.8.3.1.1.1.1.4.3" xref="A3.E64.m1.8.8.3.1.1.1.1.4.3.cmml">′</mo></msup><mo id="A3.E64.m1.8.8.3.1.1.1.1.2b" xref="A3.E64.m1.8.8.3.1.1.1.1.2.cmml">⁢</mo><mrow id="A3.E64.m1.8.8.3.1.1.1.1.5.2" xref="A3.E64.m1.2.2.cmml"><mo id="A3.E64.m1.8.8.3.1.1.1.1.5.2.1" xref="A3.E64.m1.2.2.cmml">(</mo><mfrac id="A3.E64.m1.2.2" xref="A3.E64.m1.2.2.cmml"><mrow id="A3.E64.m1.1.1.1" xref="A3.E64.m1.1.1.1.cmml"><mi id="A3.E64.m1.1.1.1.3" xref="A3.E64.m1.1.1.1.3.cmml">P</mi><mo id="A3.E64.m1.1.1.1.2" xref="A3.E64.m1.1.1.1.2.cmml">⁢</mo><mrow id="A3.E64.m1.1.1.1.1.1" xref="A3.E64.m1.1.1.1.1.1.1.cmml"><mo id="A3.E64.m1.1.1.1.1.1.2" stretchy="false" xref="A3.E64.m1.1.1.1.1.1.1.cmml">(</mo><msub id="A3.E64.m1.1.1.1.1.1.1" xref="A3.E64.m1.1.1.1.1.1.1.cmml"><mi id="A3.E64.m1.1.1.1.1.1.1.2" xref="A3.E64.m1.1.1.1.1.1.1.2.cmml">X</mi><mi id="A3.E64.m1.1.1.1.1.1.1.3" xref="A3.E64.m1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="A3.E64.m1.1.1.1.1.1.3" stretchy="false" xref="A3.E64.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A3.E64.m1.2.2.2" xref="A3.E64.m1.2.2.2.cmml"><mi id="A3.E64.m1.2.2.2.3" xref="A3.E64.m1.2.2.2.3.cmml">Q</mi><mo id="A3.E64.m1.2.2.2.2" xref="A3.E64.m1.2.2.2.2.cmml">⁢</mo><mrow id="A3.E64.m1.2.2.2.1.1" xref="A3.E64.m1.2.2.2.1.1.1.cmml"><mo id="A3.E64.m1.2.2.2.1.1.2" stretchy="false" xref="A3.E64.m1.2.2.2.1.1.1.cmml">(</mo><msub id="A3.E64.m1.2.2.2.1.1.1" xref="A3.E64.m1.2.2.2.1.1.1.cmml"><mi id="A3.E64.m1.2.2.2.1.1.1.2" xref="A3.E64.m1.2.2.2.1.1.1.2.cmml">X</mi><mi id="A3.E64.m1.2.2.2.1.1.1.3" xref="A3.E64.m1.2.2.2.1.1.1.3.cmml">j</mi></msub><mo id="A3.E64.m1.2.2.2.1.1.3" stretchy="false" xref="A3.E64.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac><mo id="A3.E64.m1.8.8.3.1.1.1.1.5.2.2" xref="A3.E64.m1.2.2.cmml">)</mo></mrow></mrow><mo id="A3.E64.m1.8.8.3.1.1.1.4" xref="A3.E64.m1.8.8.3.1.1.1.4.cmml">−</mo><mrow id="A3.E64.m1.8.8.3.1.1.1.3" xref="A3.E64.m1.8.8.3.1.1.1.3.cmml"><mi id="A3.E64.m1.8.8.3.1.1.1.3.4" xref="A3.E64.m1.8.8.3.1.1.1.3.4.cmml">Q</mi><mo id="A3.E64.m1.8.8.3.1.1.1.3.3" xref="A3.E64.m1.8.8.3.1.1.1.3.3.cmml">⁢</mo><mrow id="A3.E64.m1.8.8.3.1.1.1.2.1.1" xref="A3.E64.m1.8.8.3.1.1.1.2.1.1.1.cmml"><mo id="A3.E64.m1.8.8.3.1.1.1.2.1.1.2" stretchy="false" xref="A3.E64.m1.8.8.3.1.1.1.2.1.1.1.cmml">(</mo><msub id="A3.E64.m1.8.8.3.1.1.1.2.1.1.1" xref="A3.E64.m1.8.8.3.1.1.1.2.1.1.1.cmml"><mi id="A3.E64.m1.8.8.3.1.1.1.2.1.1.1.2" xref="A3.E64.m1.8.8.3.1.1.1.2.1.1.1.2.cmml">X</mi><mi id="A3.E64.m1.8.8.3.1.1.1.2.1.1.1.3" xref="A3.E64.m1.8.8.3.1.1.1.2.1.1.1.3.cmml">j</mi></msub><mo id="A3.E64.m1.8.8.3.1.1.1.2.1.1.3" stretchy="false" xref="A3.E64.m1.8.8.3.1.1.1.2.1.1.1.cmml">)</mo></mrow><mo id="A3.E64.m1.8.8.3.1.1.1.3.3a" xref="A3.E64.m1.8.8.3.1.1.1.3.3.cmml">⁢</mo><mrow id="A3.E64.m1.8.8.3.1.1.1.3.2.1" xref="A3.E64.m1.8.8.3.1.1.1.3.2.1.1.cmml"><mo id="A3.E64.m1.8.8.3.1.1.1.3.2.1.2" stretchy="false" xref="A3.E64.m1.8.8.3.1.1.1.3.2.1.1.cmml">(</mo><mrow id="A3.E64.m1.8.8.3.1.1.1.3.2.1.1" xref="A3.E64.m1.8.8.3.1.1.1.3.2.1.1.cmml"><msup id="A3.E64.m1.8.8.3.1.1.1.3.2.1.1.2" xref="A3.E64.m1.8.8.3.1.1.1.3.2.1.1.2.cmml"><mi id="A3.E64.m1.8.8.3.1.1.1.3.2.1.1.2.2" xref="A3.E64.m1.8.8.3.1.1.1.3.2.1.1.2.2.cmml">f</mi><mo id="A3.E64.m1.8.8.3.1.1.1.3.2.1.1.2.3" xref="A3.E64.m1.8.8.3.1.1.1.3.2.1.1.2.3.cmml">∗</mo></msup><mo id="A3.E64.m1.8.8.3.1.1.1.3.2.1.1.1" lspace="0.222em" rspace="0.222em" xref="A3.E64.m1.8.8.3.1.1.1.3.2.1.1.1.cmml">∘</mo><msup id="A3.E64.m1.8.8.3.1.1.1.3.2.1.1.3" xref="A3.E64.m1.8.8.3.1.1.1.3.2.1.1.3.cmml"><mi id="A3.E64.m1.8.8.3.1.1.1.3.2.1.1.3.2" xref="A3.E64.m1.8.8.3.1.1.1.3.2.1.1.3.2.cmml">f</mi><mo id="A3.E64.m1.8.8.3.1.1.1.3.2.1.1.3.3" xref="A3.E64.m1.8.8.3.1.1.1.3.2.1.1.3.3.cmml">′</mo></msup></mrow><mo id="A3.E64.m1.8.8.3.1.1.1.3.2.1.3" stretchy="false" xref="A3.E64.m1.8.8.3.1.1.1.3.2.1.1.cmml">)</mo></mrow><mo id="A3.E64.m1.8.8.3.1.1.1.3.3b" xref="A3.E64.m1.8.8.3.1.1.1.3.3.cmml">⁢</mo><mrow id="A3.E64.m1.8.8.3.1.1.1.3.5.2" xref="A3.E64.m1.4.4.cmml"><mo id="A3.E64.m1.8.8.3.1.1.1.3.5.2.1" xref="A3.E64.m1.4.4.cmml">(</mo><mfrac id="A3.E64.m1.4.4" xref="A3.E64.m1.4.4.cmml"><mrow id="A3.E64.m1.3.3.1" xref="A3.E64.m1.3.3.1.cmml"><mi id="A3.E64.m1.3.3.1.3" xref="A3.E64.m1.3.3.1.3.cmml">P</mi><mo id="A3.E64.m1.3.3.1.2" xref="A3.E64.m1.3.3.1.2.cmml">⁢</mo><mrow id="A3.E64.m1.3.3.1.1.1" xref="A3.E64.m1.3.3.1.1.1.1.cmml"><mo id="A3.E64.m1.3.3.1.1.1.2" stretchy="false" xref="A3.E64.m1.3.3.1.1.1.1.cmml">(</mo><msub id="A3.E64.m1.3.3.1.1.1.1" xref="A3.E64.m1.3.3.1.1.1.1.cmml"><mi id="A3.E64.m1.3.3.1.1.1.1.2" xref="A3.E64.m1.3.3.1.1.1.1.2.cmml">X</mi><mi id="A3.E64.m1.3.3.1.1.1.1.3" xref="A3.E64.m1.3.3.1.1.1.1.3.cmml">j</mi></msub><mo id="A3.E64.m1.3.3.1.1.1.3" stretchy="false" xref="A3.E64.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A3.E64.m1.4.4.2" xref="A3.E64.m1.4.4.2.cmml"><mi id="A3.E64.m1.4.4.2.3" xref="A3.E64.m1.4.4.2.3.cmml">Q</mi><mo id="A3.E64.m1.4.4.2.2" xref="A3.E64.m1.4.4.2.2.cmml">⁢</mo><mrow id="A3.E64.m1.4.4.2.1.1" xref="A3.E64.m1.4.4.2.1.1.1.cmml"><mo id="A3.E64.m1.4.4.2.1.1.2" stretchy="false" xref="A3.E64.m1.4.4.2.1.1.1.cmml">(</mo><msub id="A3.E64.m1.4.4.2.1.1.1" xref="A3.E64.m1.4.4.2.1.1.1.cmml"><mi id="A3.E64.m1.4.4.2.1.1.1.2" xref="A3.E64.m1.4.4.2.1.1.1.2.cmml">X</mi><mi id="A3.E64.m1.4.4.2.1.1.1.3" xref="A3.E64.m1.4.4.2.1.1.1.3.cmml">j</mi></msub><mo id="A3.E64.m1.4.4.2.1.1.3" stretchy="false" xref="A3.E64.m1.4.4.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac><mo id="A3.E64.m1.8.8.3.1.1.1.3.5.2.2" xref="A3.E64.m1.4.4.cmml">)</mo></mrow></mrow></mrow><mo id="A3.E64.m1.8.8.3.1.1.3" xref="A3.E64.m1.8.8.3.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.E64.m1.8b"><apply id="A3.E64.m1.8.8.cmml" xref="A3.E64.m1.8.8"><eq id="A3.E64.m1.8.8.4.cmml" xref="A3.E64.m1.8.8.4"></eq><apply id="A3.E64.m1.7.7.2.cmml" xref="A3.E64.m1.7.7.2"><times id="A3.E64.m1.7.7.2.3.cmml" xref="A3.E64.m1.7.7.2.3"></times><apply id="A3.E64.m1.7.7.2.4.cmml" xref="A3.E64.m1.7.7.2.4"><csymbol cd="ambiguous" id="A3.E64.m1.7.7.2.4.1.cmml" xref="A3.E64.m1.7.7.2.4">superscript</csymbol><ci id="A3.E64.m1.7.7.2.4.2.cmml" xref="A3.E64.m1.7.7.2.4.2">𝐽</ci><times id="A3.E64.m1.7.7.2.4.3.cmml" xref="A3.E64.m1.7.7.2.4.3"></times></apply><vector id="A3.E64.m1.7.7.2.2.3.cmml" xref="A3.E64.m1.7.7.2.2.2"><apply id="A3.E64.m1.6.6.1.1.1.1.cmml" xref="A3.E64.m1.6.6.1.1.1.1"><csymbol cd="ambiguous" id="A3.E64.m1.6.6.1.1.1.1.1.cmml" xref="A3.E64.m1.6.6.1.1.1.1">subscript</csymbol><ci id="A3.E64.m1.6.6.1.1.1.1.2.cmml" xref="A3.E64.m1.6.6.1.1.1.1.2">𝑋</ci><cn id="A3.E64.m1.6.6.1.1.1.1.3.cmml" type="integer" xref="A3.E64.m1.6.6.1.1.1.1.3">1</cn></apply><ci id="A3.E64.m1.5.5.cmml" xref="A3.E64.m1.5.5">…</ci><apply id="A3.E64.m1.7.7.2.2.2.2.cmml" xref="A3.E64.m1.7.7.2.2.2.2"><csymbol cd="ambiguous" id="A3.E64.m1.7.7.2.2.2.2.1.cmml" xref="A3.E64.m1.7.7.2.2.2.2">subscript</csymbol><ci id="A3.E64.m1.7.7.2.2.2.2.2.cmml" xref="A3.E64.m1.7.7.2.2.2.2.2">𝑋</ci><ci id="A3.E64.m1.7.7.2.2.2.2.3.cmml" xref="A3.E64.m1.7.7.2.2.2.2.3">𝑗</ci></apply></vector></apply><apply id="A3.E64.m1.8.8.3.cmml" xref="A3.E64.m1.8.8.3"><apply id="A3.E64.m1.8.8.3.2.cmml" xref="A3.E64.m1.8.8.3.2"><csymbol cd="ambiguous" id="A3.E64.m1.8.8.3.2.1.cmml" xref="A3.E64.m1.8.8.3.2">subscript</csymbol><sum id="A3.E64.m1.8.8.3.2.2.cmml" xref="A3.E64.m1.8.8.3.2.2"></sum><ci id="A3.E64.m1.8.8.3.2.3.cmml" xref="A3.E64.m1.8.8.3.2.3">𝑗</ci></apply><apply id="A3.E64.m1.8.8.3.1.2.cmml" xref="A3.E64.m1.8.8.3.1.1"><csymbol cd="latexml" id="A3.E64.m1.8.8.3.1.2.1.cmml" xref="A3.E64.m1.8.8.3.1.1.2">delimited-[]</csymbol><apply id="A3.E64.m1.8.8.3.1.1.1.cmml" xref="A3.E64.m1.8.8.3.1.1.1"><minus id="A3.E64.m1.8.8.3.1.1.1.4.cmml" xref="A3.E64.m1.8.8.3.1.1.1.4"></minus><apply id="A3.E64.m1.8.8.3.1.1.1.1.cmml" xref="A3.E64.m1.8.8.3.1.1.1.1"><times id="A3.E64.m1.8.8.3.1.1.1.1.2.cmml" xref="A3.E64.m1.8.8.3.1.1.1.1.2"></times><ci id="A3.E64.m1.8.8.3.1.1.1.1.3.cmml" xref="A3.E64.m1.8.8.3.1.1.1.1.3">𝑃</ci><apply id="A3.E64.m1.8.8.3.1.1.1.1.1.1.1.cmml" xref="A3.E64.m1.8.8.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E64.m1.8.8.3.1.1.1.1.1.1.1.1.cmml" xref="A3.E64.m1.8.8.3.1.1.1.1.1.1">subscript</csymbol><ci id="A3.E64.m1.8.8.3.1.1.1.1.1.1.1.2.cmml" xref="A3.E64.m1.8.8.3.1.1.1.1.1.1.1.2">𝑋</ci><ci id="A3.E64.m1.8.8.3.1.1.1.1.1.1.1.3.cmml" xref="A3.E64.m1.8.8.3.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="A3.E64.m1.8.8.3.1.1.1.1.4.cmml" xref="A3.E64.m1.8.8.3.1.1.1.1.4"><csymbol cd="ambiguous" id="A3.E64.m1.8.8.3.1.1.1.1.4.1.cmml" xref="A3.E64.m1.8.8.3.1.1.1.1.4">superscript</csymbol><ci id="A3.E64.m1.8.8.3.1.1.1.1.4.2.cmml" xref="A3.E64.m1.8.8.3.1.1.1.1.4.2">𝑓</ci><ci id="A3.E64.m1.8.8.3.1.1.1.1.4.3.cmml" xref="A3.E64.m1.8.8.3.1.1.1.1.4.3">′</ci></apply><apply id="A3.E64.m1.2.2.cmml" xref="A3.E64.m1.8.8.3.1.1.1.1.5.2"><divide id="A3.E64.m1.2.2.3.cmml" xref="A3.E64.m1.8.8.3.1.1.1.1.5.2"></divide><apply id="A3.E64.m1.1.1.1.cmml" xref="A3.E64.m1.1.1.1"><times id="A3.E64.m1.1.1.1.2.cmml" xref="A3.E64.m1.1.1.1.2"></times><ci id="A3.E64.m1.1.1.1.3.cmml" xref="A3.E64.m1.1.1.1.3">𝑃</ci><apply id="A3.E64.m1.1.1.1.1.1.1.cmml" xref="A3.E64.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E64.m1.1.1.1.1.1.1.1.cmml" xref="A3.E64.m1.1.1.1.1.1">subscript</csymbol><ci id="A3.E64.m1.1.1.1.1.1.1.2.cmml" xref="A3.E64.m1.1.1.1.1.1.1.2">𝑋</ci><ci id="A3.E64.m1.1.1.1.1.1.1.3.cmml" xref="A3.E64.m1.1.1.1.1.1.1.3">𝑗</ci></apply></apply><apply id="A3.E64.m1.2.2.2.cmml" xref="A3.E64.m1.2.2.2"><times id="A3.E64.m1.2.2.2.2.cmml" xref="A3.E64.m1.2.2.2.2"></times><ci id="A3.E64.m1.2.2.2.3.cmml" xref="A3.E64.m1.2.2.2.3">𝑄</ci><apply id="A3.E64.m1.2.2.2.1.1.1.cmml" xref="A3.E64.m1.2.2.2.1.1"><csymbol cd="ambiguous" id="A3.E64.m1.2.2.2.1.1.1.1.cmml" xref="A3.E64.m1.2.2.2.1.1">subscript</csymbol><ci id="A3.E64.m1.2.2.2.1.1.1.2.cmml" xref="A3.E64.m1.2.2.2.1.1.1.2">𝑋</ci><ci id="A3.E64.m1.2.2.2.1.1.1.3.cmml" xref="A3.E64.m1.2.2.2.1.1.1.3">𝑗</ci></apply></apply></apply></apply><apply id="A3.E64.m1.8.8.3.1.1.1.3.cmml" xref="A3.E64.m1.8.8.3.1.1.1.3"><times id="A3.E64.m1.8.8.3.1.1.1.3.3.cmml" xref="A3.E64.m1.8.8.3.1.1.1.3.3"></times><ci id="A3.E64.m1.8.8.3.1.1.1.3.4.cmml" xref="A3.E64.m1.8.8.3.1.1.1.3.4">𝑄</ci><apply id="A3.E64.m1.8.8.3.1.1.1.2.1.1.1.cmml" xref="A3.E64.m1.8.8.3.1.1.1.2.1.1"><csymbol cd="ambiguous" id="A3.E64.m1.8.8.3.1.1.1.2.1.1.1.1.cmml" xref="A3.E64.m1.8.8.3.1.1.1.2.1.1">subscript</csymbol><ci id="A3.E64.m1.8.8.3.1.1.1.2.1.1.1.2.cmml" xref="A3.E64.m1.8.8.3.1.1.1.2.1.1.1.2">𝑋</ci><ci id="A3.E64.m1.8.8.3.1.1.1.2.1.1.1.3.cmml" xref="A3.E64.m1.8.8.3.1.1.1.2.1.1.1.3">𝑗</ci></apply><apply id="A3.E64.m1.8.8.3.1.1.1.3.2.1.1.cmml" xref="A3.E64.m1.8.8.3.1.1.1.3.2.1"><compose id="A3.E64.m1.8.8.3.1.1.1.3.2.1.1.1.cmml" xref="A3.E64.m1.8.8.3.1.1.1.3.2.1.1.1"></compose><apply id="A3.E64.m1.8.8.3.1.1.1.3.2.1.1.2.cmml" xref="A3.E64.m1.8.8.3.1.1.1.3.2.1.1.2"><csymbol cd="ambiguous" id="A3.E64.m1.8.8.3.1.1.1.3.2.1.1.2.1.cmml" xref="A3.E64.m1.8.8.3.1.1.1.3.2.1.1.2">superscript</csymbol><ci id="A3.E64.m1.8.8.3.1.1.1.3.2.1.1.2.2.cmml" xref="A3.E64.m1.8.8.3.1.1.1.3.2.1.1.2.2">𝑓</ci><times id="A3.E64.m1.8.8.3.1.1.1.3.2.1.1.2.3.cmml" xref="A3.E64.m1.8.8.3.1.1.1.3.2.1.1.2.3"></times></apply><apply id="A3.E64.m1.8.8.3.1.1.1.3.2.1.1.3.cmml" xref="A3.E64.m1.8.8.3.1.1.1.3.2.1.1.3"><csymbol cd="ambiguous" id="A3.E64.m1.8.8.3.1.1.1.3.2.1.1.3.1.cmml" xref="A3.E64.m1.8.8.3.1.1.1.3.2.1.1.3">superscript</csymbol><ci id="A3.E64.m1.8.8.3.1.1.1.3.2.1.1.3.2.cmml" xref="A3.E64.m1.8.8.3.1.1.1.3.2.1.1.3.2">𝑓</ci><ci id="A3.E64.m1.8.8.3.1.1.1.3.2.1.1.3.3.cmml" xref="A3.E64.m1.8.8.3.1.1.1.3.2.1.1.3.3">′</ci></apply></apply><apply id="A3.E64.m1.4.4.cmml" xref="A3.E64.m1.8.8.3.1.1.1.3.5.2"><divide id="A3.E64.m1.4.4.3.cmml" xref="A3.E64.m1.8.8.3.1.1.1.3.5.2"></divide><apply id="A3.E64.m1.3.3.1.cmml" xref="A3.E64.m1.3.3.1"><times id="A3.E64.m1.3.3.1.2.cmml" xref="A3.E64.m1.3.3.1.2"></times><ci id="A3.E64.m1.3.3.1.3.cmml" xref="A3.E64.m1.3.3.1.3">𝑃</ci><apply id="A3.E64.m1.3.3.1.1.1.1.cmml" xref="A3.E64.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="A3.E64.m1.3.3.1.1.1.1.1.cmml" xref="A3.E64.m1.3.3.1.1.1">subscript</csymbol><ci id="A3.E64.m1.3.3.1.1.1.1.2.cmml" xref="A3.E64.m1.3.3.1.1.1.1.2">𝑋</ci><ci id="A3.E64.m1.3.3.1.1.1.1.3.cmml" xref="A3.E64.m1.3.3.1.1.1.1.3">𝑗</ci></apply></apply><apply id="A3.E64.m1.4.4.2.cmml" xref="A3.E64.m1.4.4.2"><times id="A3.E64.m1.4.4.2.2.cmml" xref="A3.E64.m1.4.4.2.2"></times><ci id="A3.E64.m1.4.4.2.3.cmml" xref="A3.E64.m1.4.4.2.3">𝑄</ci><apply id="A3.E64.m1.4.4.2.1.1.1.cmml" xref="A3.E64.m1.4.4.2.1.1"><csymbol cd="ambiguous" id="A3.E64.m1.4.4.2.1.1.1.1.cmml" xref="A3.E64.m1.4.4.2.1.1">subscript</csymbol><ci id="A3.E64.m1.4.4.2.1.1.1.2.cmml" xref="A3.E64.m1.4.4.2.1.1.1.2">𝑋</ci><ci id="A3.E64.m1.4.4.2.1.1.1.3.cmml" xref="A3.E64.m1.4.4.2.1.1.1.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E64.m1.8c">J^{*}(X_{1},\ldots,X_{j})=\sum_{j}\left[P(X_{j})f^{\prime}\left(\frac{P(X_{j})%
}{Q(X_{j})}\right)-Q(X_{j})(f^{*}\circ f^{\prime})\left(\frac{P(X_{j})}{Q(X_{j%
})}\right)\right]</annotation><annotation encoding="application/x-llamapun" id="A3.E64.m1.8d">italic_J start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_X start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) = ∑ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT [ italic_P ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) italic_f start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( divide start_ARG italic_P ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG start_ARG italic_Q ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG ) - italic_Q ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ( italic_f start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ∘ italic_f start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) ( divide start_ARG italic_P ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG start_ARG italic_Q ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(64)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A3.p3.11">In turn, this determines the splitting criterion as a function of the choice of <math alttext="f" class="ltx_Math" display="inline" id="A3.p3.11.m1.1"><semantics id="A3.p3.11.m1.1a"><mi id="A3.p3.11.m1.1.1" xref="A3.p3.11.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="A3.p3.11.m1.1b"><ci id="A3.p3.11.m1.1.1.cmml" xref="A3.p3.11.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.11.m1.1c">f</annotation><annotation encoding="application/x-llamapun" id="A3.p3.11.m1.1d">italic_f</annotation></semantics></math>. Finally, the optimal density values for the leaves are given by</p>
<table class="ltx_equation ltx_eqn_table" id="A3.E65">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="v^{*}_{j}=\left(f^{\prime}\right)^{-1}(w^{*}_{j})=\frac{P(X_{j})}{Q(X_{j})}\,." class="ltx_Math" display="block" id="A3.E65.m1.3"><semantics id="A3.E65.m1.3a"><mrow id="A3.E65.m1.3.3.1" xref="A3.E65.m1.3.3.1.1.cmml"><mrow id="A3.E65.m1.3.3.1.1" xref="A3.E65.m1.3.3.1.1.cmml"><msubsup id="A3.E65.m1.3.3.1.1.4" xref="A3.E65.m1.3.3.1.1.4.cmml"><mi id="A3.E65.m1.3.3.1.1.4.2.2" xref="A3.E65.m1.3.3.1.1.4.2.2.cmml">v</mi><mi id="A3.E65.m1.3.3.1.1.4.3" xref="A3.E65.m1.3.3.1.1.4.3.cmml">j</mi><mo id="A3.E65.m1.3.3.1.1.4.2.3" xref="A3.E65.m1.3.3.1.1.4.2.3.cmml">∗</mo></msubsup><mo id="A3.E65.m1.3.3.1.1.5" xref="A3.E65.m1.3.3.1.1.5.cmml">=</mo><mrow id="A3.E65.m1.3.3.1.1.2" xref="A3.E65.m1.3.3.1.1.2.cmml"><msup id="A3.E65.m1.3.3.1.1.1.1" xref="A3.E65.m1.3.3.1.1.1.1.cmml"><mrow id="A3.E65.m1.3.3.1.1.1.1.1.1" xref="A3.E65.m1.3.3.1.1.1.1.1.1.1.cmml"><mo id="A3.E65.m1.3.3.1.1.1.1.1.1.2" xref="A3.E65.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><msup id="A3.E65.m1.3.3.1.1.1.1.1.1.1" xref="A3.E65.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="A3.E65.m1.3.3.1.1.1.1.1.1.1.2" xref="A3.E65.m1.3.3.1.1.1.1.1.1.1.2.cmml">f</mi><mo id="A3.E65.m1.3.3.1.1.1.1.1.1.1.3" xref="A3.E65.m1.3.3.1.1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="A3.E65.m1.3.3.1.1.1.1.1.1.3" xref="A3.E65.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="A3.E65.m1.3.3.1.1.1.1.3" xref="A3.E65.m1.3.3.1.1.1.1.3.cmml"><mo id="A3.E65.m1.3.3.1.1.1.1.3a" xref="A3.E65.m1.3.3.1.1.1.1.3.cmml">−</mo><mn id="A3.E65.m1.3.3.1.1.1.1.3.2" xref="A3.E65.m1.3.3.1.1.1.1.3.2.cmml">1</mn></mrow></msup><mo id="A3.E65.m1.3.3.1.1.2.3" xref="A3.E65.m1.3.3.1.1.2.3.cmml">⁢</mo><mrow id="A3.E65.m1.3.3.1.1.2.2.1" xref="A3.E65.m1.3.3.1.1.2.2.1.1.cmml"><mo id="A3.E65.m1.3.3.1.1.2.2.1.2" stretchy="false" xref="A3.E65.m1.3.3.1.1.2.2.1.1.cmml">(</mo><msubsup id="A3.E65.m1.3.3.1.1.2.2.1.1" xref="A3.E65.m1.3.3.1.1.2.2.1.1.cmml"><mi id="A3.E65.m1.3.3.1.1.2.2.1.1.2.2" xref="A3.E65.m1.3.3.1.1.2.2.1.1.2.2.cmml">w</mi><mi id="A3.E65.m1.3.3.1.1.2.2.1.1.3" xref="A3.E65.m1.3.3.1.1.2.2.1.1.3.cmml">j</mi><mo id="A3.E65.m1.3.3.1.1.2.2.1.1.2.3" xref="A3.E65.m1.3.3.1.1.2.2.1.1.2.3.cmml">∗</mo></msubsup><mo id="A3.E65.m1.3.3.1.1.2.2.1.3" stretchy="false" xref="A3.E65.m1.3.3.1.1.2.2.1.1.cmml">)</mo></mrow></mrow><mo id="A3.E65.m1.3.3.1.1.6" xref="A3.E65.m1.3.3.1.1.6.cmml">=</mo><mfrac id="A3.E65.m1.2.2" xref="A3.E65.m1.2.2.cmml"><mrow id="A3.E65.m1.1.1.1" xref="A3.E65.m1.1.1.1.cmml"><mi id="A3.E65.m1.1.1.1.3" xref="A3.E65.m1.1.1.1.3.cmml">P</mi><mo id="A3.E65.m1.1.1.1.2" xref="A3.E65.m1.1.1.1.2.cmml">⁢</mo><mrow id="A3.E65.m1.1.1.1.1.1" xref="A3.E65.m1.1.1.1.1.1.1.cmml"><mo id="A3.E65.m1.1.1.1.1.1.2" stretchy="false" xref="A3.E65.m1.1.1.1.1.1.1.cmml">(</mo><msub id="A3.E65.m1.1.1.1.1.1.1" xref="A3.E65.m1.1.1.1.1.1.1.cmml"><mi id="A3.E65.m1.1.1.1.1.1.1.2" xref="A3.E65.m1.1.1.1.1.1.1.2.cmml">X</mi><mi id="A3.E65.m1.1.1.1.1.1.1.3" xref="A3.E65.m1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="A3.E65.m1.1.1.1.1.1.3" stretchy="false" xref="A3.E65.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A3.E65.m1.2.2.2" xref="A3.E65.m1.2.2.2.cmml"><mi id="A3.E65.m1.2.2.2.3" xref="A3.E65.m1.2.2.2.3.cmml">Q</mi><mo id="A3.E65.m1.2.2.2.2" xref="A3.E65.m1.2.2.2.2.cmml">⁢</mo><mrow id="A3.E65.m1.2.2.2.1.1" xref="A3.E65.m1.2.2.2.1.1.1.cmml"><mo id="A3.E65.m1.2.2.2.1.1.2" stretchy="false" xref="A3.E65.m1.2.2.2.1.1.1.cmml">(</mo><msub id="A3.E65.m1.2.2.2.1.1.1" xref="A3.E65.m1.2.2.2.1.1.1.cmml"><mi id="A3.E65.m1.2.2.2.1.1.1.2" xref="A3.E65.m1.2.2.2.1.1.1.2.cmml">X</mi><mi id="A3.E65.m1.2.2.2.1.1.1.3" xref="A3.E65.m1.2.2.2.1.1.1.3.cmml">j</mi></msub><mo id="A3.E65.m1.2.2.2.1.1.3" stretchy="false" xref="A3.E65.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow><mo id="A3.E65.m1.3.3.1.2" lspace="0.170em" xref="A3.E65.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E65.m1.3b"><apply id="A3.E65.m1.3.3.1.1.cmml" xref="A3.E65.m1.3.3.1"><and id="A3.E65.m1.3.3.1.1a.cmml" xref="A3.E65.m1.3.3.1"></and><apply id="A3.E65.m1.3.3.1.1b.cmml" xref="A3.E65.m1.3.3.1"><eq id="A3.E65.m1.3.3.1.1.5.cmml" xref="A3.E65.m1.3.3.1.1.5"></eq><apply id="A3.E65.m1.3.3.1.1.4.cmml" xref="A3.E65.m1.3.3.1.1.4"><csymbol cd="ambiguous" id="A3.E65.m1.3.3.1.1.4.1.cmml" xref="A3.E65.m1.3.3.1.1.4">subscript</csymbol><apply id="A3.E65.m1.3.3.1.1.4.2.cmml" xref="A3.E65.m1.3.3.1.1.4"><csymbol cd="ambiguous" id="A3.E65.m1.3.3.1.1.4.2.1.cmml" xref="A3.E65.m1.3.3.1.1.4">superscript</csymbol><ci id="A3.E65.m1.3.3.1.1.4.2.2.cmml" xref="A3.E65.m1.3.3.1.1.4.2.2">𝑣</ci><times id="A3.E65.m1.3.3.1.1.4.2.3.cmml" xref="A3.E65.m1.3.3.1.1.4.2.3"></times></apply><ci id="A3.E65.m1.3.3.1.1.4.3.cmml" xref="A3.E65.m1.3.3.1.1.4.3">𝑗</ci></apply><apply id="A3.E65.m1.3.3.1.1.2.cmml" xref="A3.E65.m1.3.3.1.1.2"><times id="A3.E65.m1.3.3.1.1.2.3.cmml" xref="A3.E65.m1.3.3.1.1.2.3"></times><apply id="A3.E65.m1.3.3.1.1.1.1.cmml" xref="A3.E65.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="A3.E65.m1.3.3.1.1.1.1.2.cmml" xref="A3.E65.m1.3.3.1.1.1.1">superscript</csymbol><apply id="A3.E65.m1.3.3.1.1.1.1.1.1.1.cmml" xref="A3.E65.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E65.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="A3.E65.m1.3.3.1.1.1.1.1.1">superscript</csymbol><ci id="A3.E65.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="A3.E65.m1.3.3.1.1.1.1.1.1.1.2">𝑓</ci><ci id="A3.E65.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="A3.E65.m1.3.3.1.1.1.1.1.1.1.3">′</ci></apply><apply id="A3.E65.m1.3.3.1.1.1.1.3.cmml" xref="A3.E65.m1.3.3.1.1.1.1.3"><minus id="A3.E65.m1.3.3.1.1.1.1.3.1.cmml" xref="A3.E65.m1.3.3.1.1.1.1.3"></minus><cn id="A3.E65.m1.3.3.1.1.1.1.3.2.cmml" type="integer" xref="A3.E65.m1.3.3.1.1.1.1.3.2">1</cn></apply></apply><apply id="A3.E65.m1.3.3.1.1.2.2.1.1.cmml" xref="A3.E65.m1.3.3.1.1.2.2.1"><csymbol cd="ambiguous" id="A3.E65.m1.3.3.1.1.2.2.1.1.1.cmml" xref="A3.E65.m1.3.3.1.1.2.2.1">subscript</csymbol><apply id="A3.E65.m1.3.3.1.1.2.2.1.1.2.cmml" xref="A3.E65.m1.3.3.1.1.2.2.1"><csymbol cd="ambiguous" id="A3.E65.m1.3.3.1.1.2.2.1.1.2.1.cmml" xref="A3.E65.m1.3.3.1.1.2.2.1">superscript</csymbol><ci id="A3.E65.m1.3.3.1.1.2.2.1.1.2.2.cmml" xref="A3.E65.m1.3.3.1.1.2.2.1.1.2.2">𝑤</ci><times id="A3.E65.m1.3.3.1.1.2.2.1.1.2.3.cmml" xref="A3.E65.m1.3.3.1.1.2.2.1.1.2.3"></times></apply><ci id="A3.E65.m1.3.3.1.1.2.2.1.1.3.cmml" xref="A3.E65.m1.3.3.1.1.2.2.1.1.3">𝑗</ci></apply></apply></apply><apply id="A3.E65.m1.3.3.1.1c.cmml" xref="A3.E65.m1.3.3.1"><eq id="A3.E65.m1.3.3.1.1.6.cmml" xref="A3.E65.m1.3.3.1.1.6"></eq><share href="https://arxiv.org/html/2410.03535v1#A3.E65.m1.3.3.1.1.2.cmml" id="A3.E65.m1.3.3.1.1d.cmml" xref="A3.E65.m1.3.3.1"></share><apply id="A3.E65.m1.2.2.cmml" xref="A3.E65.m1.2.2"><divide id="A3.E65.m1.2.2.3.cmml" xref="A3.E65.m1.2.2"></divide><apply id="A3.E65.m1.1.1.1.cmml" xref="A3.E65.m1.1.1.1"><times id="A3.E65.m1.1.1.1.2.cmml" xref="A3.E65.m1.1.1.1.2"></times><ci id="A3.E65.m1.1.1.1.3.cmml" xref="A3.E65.m1.1.1.1.3">𝑃</ci><apply id="A3.E65.m1.1.1.1.1.1.1.cmml" xref="A3.E65.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E65.m1.1.1.1.1.1.1.1.cmml" xref="A3.E65.m1.1.1.1.1.1">subscript</csymbol><ci id="A3.E65.m1.1.1.1.1.1.1.2.cmml" xref="A3.E65.m1.1.1.1.1.1.1.2">𝑋</ci><ci id="A3.E65.m1.1.1.1.1.1.1.3.cmml" xref="A3.E65.m1.1.1.1.1.1.1.3">𝑗</ci></apply></apply><apply id="A3.E65.m1.2.2.2.cmml" xref="A3.E65.m1.2.2.2"><times id="A3.E65.m1.2.2.2.2.cmml" xref="A3.E65.m1.2.2.2.2"></times><ci id="A3.E65.m1.2.2.2.3.cmml" xref="A3.E65.m1.2.2.2.3">𝑄</ci><apply id="A3.E65.m1.2.2.2.1.1.1.cmml" xref="A3.E65.m1.2.2.2.1.1"><csymbol cd="ambiguous" id="A3.E65.m1.2.2.2.1.1.1.1.cmml" xref="A3.E65.m1.2.2.2.1.1">subscript</csymbol><ci id="A3.E65.m1.2.2.2.1.1.1.2.cmml" xref="A3.E65.m1.2.2.2.1.1.1.2">𝑋</ci><ci id="A3.E65.m1.2.2.2.1.1.1.3.cmml" xref="A3.E65.m1.2.2.2.1.1.1.3">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E65.m1.3c">v^{*}_{j}=\left(f^{\prime}\right)^{-1}(w^{*}_{j})=\frac{P(X_{j})}{Q(X_{j})}\,.</annotation><annotation encoding="application/x-llamapun" id="A3.E65.m1.3d">italic_v start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = ( italic_f start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( italic_w start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) = divide start_ARG italic_P ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG start_ARG italic_Q ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(65)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A3.p4">
<p class="ltx_p" id="A3.p4.3">It is interesting to note two particular choices of <math alttext="f" class="ltx_Math" display="inline" id="A3.p4.1.m1.1"><semantics id="A3.p4.1.m1.1a"><mi id="A3.p4.1.m1.1.1" xref="A3.p4.1.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="A3.p4.1.m1.1b"><ci id="A3.p4.1.m1.1.1.cmml" xref="A3.p4.1.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p4.1.m1.1c">f</annotation><annotation encoding="application/x-llamapun" id="A3.p4.1.m1.1d">italic_f</annotation></semantics></math>-divergences.
For the KL divergence, <math alttext="f(t)=t\log t" class="ltx_Math" display="inline" id="A3.p4.2.m2.1"><semantics id="A3.p4.2.m2.1a"><mrow id="A3.p4.2.m2.1.2" xref="A3.p4.2.m2.1.2.cmml"><mrow id="A3.p4.2.m2.1.2.2" xref="A3.p4.2.m2.1.2.2.cmml"><mi id="A3.p4.2.m2.1.2.2.2" xref="A3.p4.2.m2.1.2.2.2.cmml">f</mi><mo id="A3.p4.2.m2.1.2.2.1" xref="A3.p4.2.m2.1.2.2.1.cmml">⁢</mo><mrow id="A3.p4.2.m2.1.2.2.3.2" xref="A3.p4.2.m2.1.2.2.cmml"><mo id="A3.p4.2.m2.1.2.2.3.2.1" stretchy="false" xref="A3.p4.2.m2.1.2.2.cmml">(</mo><mi id="A3.p4.2.m2.1.1" xref="A3.p4.2.m2.1.1.cmml">t</mi><mo id="A3.p4.2.m2.1.2.2.3.2.2" stretchy="false" xref="A3.p4.2.m2.1.2.2.cmml">)</mo></mrow></mrow><mo id="A3.p4.2.m2.1.2.1" xref="A3.p4.2.m2.1.2.1.cmml">=</mo><mrow id="A3.p4.2.m2.1.2.3" xref="A3.p4.2.m2.1.2.3.cmml"><mi id="A3.p4.2.m2.1.2.3.2" xref="A3.p4.2.m2.1.2.3.2.cmml">t</mi><mo id="A3.p4.2.m2.1.2.3.1" lspace="0.167em" xref="A3.p4.2.m2.1.2.3.1.cmml">⁢</mo><mrow id="A3.p4.2.m2.1.2.3.3" xref="A3.p4.2.m2.1.2.3.3.cmml"><mi id="A3.p4.2.m2.1.2.3.3.1" xref="A3.p4.2.m2.1.2.3.3.1.cmml">log</mi><mo id="A3.p4.2.m2.1.2.3.3a" lspace="0.167em" xref="A3.p4.2.m2.1.2.3.3.cmml">⁡</mo><mi id="A3.p4.2.m2.1.2.3.3.2" xref="A3.p4.2.m2.1.2.3.3.2.cmml">t</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.p4.2.m2.1b"><apply id="A3.p4.2.m2.1.2.cmml" xref="A3.p4.2.m2.1.2"><eq id="A3.p4.2.m2.1.2.1.cmml" xref="A3.p4.2.m2.1.2.1"></eq><apply id="A3.p4.2.m2.1.2.2.cmml" xref="A3.p4.2.m2.1.2.2"><times id="A3.p4.2.m2.1.2.2.1.cmml" xref="A3.p4.2.m2.1.2.2.1"></times><ci id="A3.p4.2.m2.1.2.2.2.cmml" xref="A3.p4.2.m2.1.2.2.2">𝑓</ci><ci id="A3.p4.2.m2.1.1.cmml" xref="A3.p4.2.m2.1.1">𝑡</ci></apply><apply id="A3.p4.2.m2.1.2.3.cmml" xref="A3.p4.2.m2.1.2.3"><times id="A3.p4.2.m2.1.2.3.1.cmml" xref="A3.p4.2.m2.1.2.3.1"></times><ci id="A3.p4.2.m2.1.2.3.2.cmml" xref="A3.p4.2.m2.1.2.3.2">𝑡</ci><apply id="A3.p4.2.m2.1.2.3.3.cmml" xref="A3.p4.2.m2.1.2.3.3"><log id="A3.p4.2.m2.1.2.3.3.1.cmml" xref="A3.p4.2.m2.1.2.3.3.1"></log><ci id="A3.p4.2.m2.1.2.3.3.2.cmml" xref="A3.p4.2.m2.1.2.3.3.2">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p4.2.m2.1c">f(t)=t\log t</annotation><annotation encoding="application/x-llamapun" id="A3.p4.2.m2.1d">italic_f ( italic_t ) = italic_t roman_log italic_t</annotation></semantics></math> and <math alttext="f^{\prime}(t)=1+\log t=\left(f^{*}\right)^{-1}(t)" class="ltx_Math" display="inline" id="A3.p4.3.m3.3"><semantics id="A3.p4.3.m3.3a"><mrow id="A3.p4.3.m3.3.3" xref="A3.p4.3.m3.3.3.cmml"><mrow id="A3.p4.3.m3.3.3.3" xref="A3.p4.3.m3.3.3.3.cmml"><msup id="A3.p4.3.m3.3.3.3.2" xref="A3.p4.3.m3.3.3.3.2.cmml"><mi id="A3.p4.3.m3.3.3.3.2.2" xref="A3.p4.3.m3.3.3.3.2.2.cmml">f</mi><mo id="A3.p4.3.m3.3.3.3.2.3" xref="A3.p4.3.m3.3.3.3.2.3.cmml">′</mo></msup><mo id="A3.p4.3.m3.3.3.3.1" xref="A3.p4.3.m3.3.3.3.1.cmml">⁢</mo><mrow id="A3.p4.3.m3.3.3.3.3.2" xref="A3.p4.3.m3.3.3.3.cmml"><mo id="A3.p4.3.m3.3.3.3.3.2.1" stretchy="false" xref="A3.p4.3.m3.3.3.3.cmml">(</mo><mi id="A3.p4.3.m3.1.1" xref="A3.p4.3.m3.1.1.cmml">t</mi><mo id="A3.p4.3.m3.3.3.3.3.2.2" stretchy="false" xref="A3.p4.3.m3.3.3.3.cmml">)</mo></mrow></mrow><mo id="A3.p4.3.m3.3.3.4" xref="A3.p4.3.m3.3.3.4.cmml">=</mo><mrow id="A3.p4.3.m3.3.3.5" xref="A3.p4.3.m3.3.3.5.cmml"><mn id="A3.p4.3.m3.3.3.5.2" xref="A3.p4.3.m3.3.3.5.2.cmml">1</mn><mo id="A3.p4.3.m3.3.3.5.1" xref="A3.p4.3.m3.3.3.5.1.cmml">+</mo><mrow id="A3.p4.3.m3.3.3.5.3" xref="A3.p4.3.m3.3.3.5.3.cmml"><mi id="A3.p4.3.m3.3.3.5.3.1" xref="A3.p4.3.m3.3.3.5.3.1.cmml">log</mi><mo id="A3.p4.3.m3.3.3.5.3a" lspace="0.167em" xref="A3.p4.3.m3.3.3.5.3.cmml">⁡</mo><mi id="A3.p4.3.m3.3.3.5.3.2" xref="A3.p4.3.m3.3.3.5.3.2.cmml">t</mi></mrow></mrow><mo id="A3.p4.3.m3.3.3.6" xref="A3.p4.3.m3.3.3.6.cmml">=</mo><mrow id="A3.p4.3.m3.3.3.1" xref="A3.p4.3.m3.3.3.1.cmml"><msup id="A3.p4.3.m3.3.3.1.1" xref="A3.p4.3.m3.3.3.1.1.cmml"><mrow id="A3.p4.3.m3.3.3.1.1.1.1" xref="A3.p4.3.m3.3.3.1.1.1.1.1.cmml"><mo id="A3.p4.3.m3.3.3.1.1.1.1.2" xref="A3.p4.3.m3.3.3.1.1.1.1.1.cmml">(</mo><msup id="A3.p4.3.m3.3.3.1.1.1.1.1" xref="A3.p4.3.m3.3.3.1.1.1.1.1.cmml"><mi id="A3.p4.3.m3.3.3.1.1.1.1.1.2" xref="A3.p4.3.m3.3.3.1.1.1.1.1.2.cmml">f</mi><mo id="A3.p4.3.m3.3.3.1.1.1.1.1.3" xref="A3.p4.3.m3.3.3.1.1.1.1.1.3.cmml">∗</mo></msup><mo id="A3.p4.3.m3.3.3.1.1.1.1.3" xref="A3.p4.3.m3.3.3.1.1.1.1.1.cmml">)</mo></mrow><mrow id="A3.p4.3.m3.3.3.1.1.3" xref="A3.p4.3.m3.3.3.1.1.3.cmml"><mo id="A3.p4.3.m3.3.3.1.1.3a" xref="A3.p4.3.m3.3.3.1.1.3.cmml">−</mo><mn id="A3.p4.3.m3.3.3.1.1.3.2" xref="A3.p4.3.m3.3.3.1.1.3.2.cmml">1</mn></mrow></msup><mo id="A3.p4.3.m3.3.3.1.2" xref="A3.p4.3.m3.3.3.1.2.cmml">⁢</mo><mrow id="A3.p4.3.m3.3.3.1.3.2" xref="A3.p4.3.m3.3.3.1.cmml"><mo id="A3.p4.3.m3.3.3.1.3.2.1" stretchy="false" xref="A3.p4.3.m3.3.3.1.cmml">(</mo><mi id="A3.p4.3.m3.2.2" xref="A3.p4.3.m3.2.2.cmml">t</mi><mo id="A3.p4.3.m3.3.3.1.3.2.2" stretchy="false" xref="A3.p4.3.m3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.p4.3.m3.3b"><apply id="A3.p4.3.m3.3.3.cmml" xref="A3.p4.3.m3.3.3"><and id="A3.p4.3.m3.3.3a.cmml" xref="A3.p4.3.m3.3.3"></and><apply id="A3.p4.3.m3.3.3b.cmml" xref="A3.p4.3.m3.3.3"><eq id="A3.p4.3.m3.3.3.4.cmml" xref="A3.p4.3.m3.3.3.4"></eq><apply id="A3.p4.3.m3.3.3.3.cmml" xref="A3.p4.3.m3.3.3.3"><times id="A3.p4.3.m3.3.3.3.1.cmml" xref="A3.p4.3.m3.3.3.3.1"></times><apply id="A3.p4.3.m3.3.3.3.2.cmml" xref="A3.p4.3.m3.3.3.3.2"><csymbol cd="ambiguous" id="A3.p4.3.m3.3.3.3.2.1.cmml" xref="A3.p4.3.m3.3.3.3.2">superscript</csymbol><ci id="A3.p4.3.m3.3.3.3.2.2.cmml" xref="A3.p4.3.m3.3.3.3.2.2">𝑓</ci><ci id="A3.p4.3.m3.3.3.3.2.3.cmml" xref="A3.p4.3.m3.3.3.3.2.3">′</ci></apply><ci id="A3.p4.3.m3.1.1.cmml" xref="A3.p4.3.m3.1.1">𝑡</ci></apply><apply id="A3.p4.3.m3.3.3.5.cmml" xref="A3.p4.3.m3.3.3.5"><plus id="A3.p4.3.m3.3.3.5.1.cmml" xref="A3.p4.3.m3.3.3.5.1"></plus><cn id="A3.p4.3.m3.3.3.5.2.cmml" type="integer" xref="A3.p4.3.m3.3.3.5.2">1</cn><apply id="A3.p4.3.m3.3.3.5.3.cmml" xref="A3.p4.3.m3.3.3.5.3"><log id="A3.p4.3.m3.3.3.5.3.1.cmml" xref="A3.p4.3.m3.3.3.5.3.1"></log><ci id="A3.p4.3.m3.3.3.5.3.2.cmml" xref="A3.p4.3.m3.3.3.5.3.2">𝑡</ci></apply></apply></apply><apply id="A3.p4.3.m3.3.3c.cmml" xref="A3.p4.3.m3.3.3"><eq id="A3.p4.3.m3.3.3.6.cmml" xref="A3.p4.3.m3.3.3.6"></eq><share href="https://arxiv.org/html/2410.03535v1#A3.p4.3.m3.3.3.5.cmml" id="A3.p4.3.m3.3.3d.cmml" xref="A3.p4.3.m3.3.3"></share><apply id="A3.p4.3.m3.3.3.1.cmml" xref="A3.p4.3.m3.3.3.1"><times id="A3.p4.3.m3.3.3.1.2.cmml" xref="A3.p4.3.m3.3.3.1.2"></times><apply id="A3.p4.3.m3.3.3.1.1.cmml" xref="A3.p4.3.m3.3.3.1.1"><csymbol cd="ambiguous" id="A3.p4.3.m3.3.3.1.1.2.cmml" xref="A3.p4.3.m3.3.3.1.1">superscript</csymbol><apply id="A3.p4.3.m3.3.3.1.1.1.1.1.cmml" xref="A3.p4.3.m3.3.3.1.1.1.1"><csymbol cd="ambiguous" id="A3.p4.3.m3.3.3.1.1.1.1.1.1.cmml" xref="A3.p4.3.m3.3.3.1.1.1.1">superscript</csymbol><ci id="A3.p4.3.m3.3.3.1.1.1.1.1.2.cmml" xref="A3.p4.3.m3.3.3.1.1.1.1.1.2">𝑓</ci><times id="A3.p4.3.m3.3.3.1.1.1.1.1.3.cmml" xref="A3.p4.3.m3.3.3.1.1.1.1.1.3"></times></apply><apply id="A3.p4.3.m3.3.3.1.1.3.cmml" xref="A3.p4.3.m3.3.3.1.1.3"><minus id="A3.p4.3.m3.3.3.1.1.3.1.cmml" xref="A3.p4.3.m3.3.3.1.1.3"></minus><cn id="A3.p4.3.m3.3.3.1.1.3.2.cmml" type="integer" xref="A3.p4.3.m3.3.3.1.1.3.2">1</cn></apply></apply><ci id="A3.p4.3.m3.2.2.cmml" xref="A3.p4.3.m3.2.2">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p4.3.m3.3c">f^{\prime}(t)=1+\log t=\left(f^{*}\right)^{-1}(t)</annotation><annotation encoding="application/x-llamapun" id="A3.p4.3.m3.3d">italic_f start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_t ) = 1 + roman_log italic_t = ( italic_f start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( italic_t )</annotation></semantics></math>.
This leads to</p>
<table class="ltx_equation ltx_eqn_table" id="A3.E66">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="J_{KL}(X_{1},\ldots,X_{j})=\sum_{j}P(X_{j})\log\frac{P(X_{j})}{Q(X_{j})}" class="ltx_Math" display="block" id="A3.E66.m1.6"><semantics id="A3.E66.m1.6a"><mrow id="A3.E66.m1.6.6" xref="A3.E66.m1.6.6.cmml"><mrow id="A3.E66.m1.5.5.2" xref="A3.E66.m1.5.5.2.cmml"><msub id="A3.E66.m1.5.5.2.4" xref="A3.E66.m1.5.5.2.4.cmml"><mi id="A3.E66.m1.5.5.2.4.2" xref="A3.E66.m1.5.5.2.4.2.cmml">J</mi><mrow id="A3.E66.m1.5.5.2.4.3" xref="A3.E66.m1.5.5.2.4.3.cmml"><mi id="A3.E66.m1.5.5.2.4.3.2" xref="A3.E66.m1.5.5.2.4.3.2.cmml">K</mi><mo id="A3.E66.m1.5.5.2.4.3.1" xref="A3.E66.m1.5.5.2.4.3.1.cmml">⁢</mo><mi id="A3.E66.m1.5.5.2.4.3.3" xref="A3.E66.m1.5.5.2.4.3.3.cmml">L</mi></mrow></msub><mo id="A3.E66.m1.5.5.2.3" xref="A3.E66.m1.5.5.2.3.cmml">⁢</mo><mrow id="A3.E66.m1.5.5.2.2.2" xref="A3.E66.m1.5.5.2.2.3.cmml"><mo id="A3.E66.m1.5.5.2.2.2.3" stretchy="false" xref="A3.E66.m1.5.5.2.2.3.cmml">(</mo><msub id="A3.E66.m1.4.4.1.1.1.1" xref="A3.E66.m1.4.4.1.1.1.1.cmml"><mi id="A3.E66.m1.4.4.1.1.1.1.2" xref="A3.E66.m1.4.4.1.1.1.1.2.cmml">X</mi><mn id="A3.E66.m1.4.4.1.1.1.1.3" xref="A3.E66.m1.4.4.1.1.1.1.3.cmml">1</mn></msub><mo id="A3.E66.m1.5.5.2.2.2.4" xref="A3.E66.m1.5.5.2.2.3.cmml">,</mo><mi id="A3.E66.m1.3.3" mathvariant="normal" xref="A3.E66.m1.3.3.cmml">…</mi><mo id="A3.E66.m1.5.5.2.2.2.5" xref="A3.E66.m1.5.5.2.2.3.cmml">,</mo><msub id="A3.E66.m1.5.5.2.2.2.2" xref="A3.E66.m1.5.5.2.2.2.2.cmml"><mi id="A3.E66.m1.5.5.2.2.2.2.2" xref="A3.E66.m1.5.5.2.2.2.2.2.cmml">X</mi><mi id="A3.E66.m1.5.5.2.2.2.2.3" xref="A3.E66.m1.5.5.2.2.2.2.3.cmml">j</mi></msub><mo id="A3.E66.m1.5.5.2.2.2.6" stretchy="false" xref="A3.E66.m1.5.5.2.2.3.cmml">)</mo></mrow></mrow><mo id="A3.E66.m1.6.6.4" rspace="0.111em" xref="A3.E66.m1.6.6.4.cmml">=</mo><mrow id="A3.E66.m1.6.6.3" xref="A3.E66.m1.6.6.3.cmml"><munder id="A3.E66.m1.6.6.3.2" xref="A3.E66.m1.6.6.3.2.cmml"><mo id="A3.E66.m1.6.6.3.2.2" movablelimits="false" xref="A3.E66.m1.6.6.3.2.2.cmml">∑</mo><mi id="A3.E66.m1.6.6.3.2.3" xref="A3.E66.m1.6.6.3.2.3.cmml">j</mi></munder><mrow id="A3.E66.m1.6.6.3.1" xref="A3.E66.m1.6.6.3.1.cmml"><mi id="A3.E66.m1.6.6.3.1.3" xref="A3.E66.m1.6.6.3.1.3.cmml">P</mi><mo id="A3.E66.m1.6.6.3.1.2" xref="A3.E66.m1.6.6.3.1.2.cmml">⁢</mo><mrow id="A3.E66.m1.6.6.3.1.1.1" xref="A3.E66.m1.6.6.3.1.1.1.1.cmml"><mo id="A3.E66.m1.6.6.3.1.1.1.2" stretchy="false" xref="A3.E66.m1.6.6.3.1.1.1.1.cmml">(</mo><msub id="A3.E66.m1.6.6.3.1.1.1.1" xref="A3.E66.m1.6.6.3.1.1.1.1.cmml"><mi id="A3.E66.m1.6.6.3.1.1.1.1.2" xref="A3.E66.m1.6.6.3.1.1.1.1.2.cmml">X</mi><mi id="A3.E66.m1.6.6.3.1.1.1.1.3" xref="A3.E66.m1.6.6.3.1.1.1.1.3.cmml">j</mi></msub><mo id="A3.E66.m1.6.6.3.1.1.1.3" stretchy="false" xref="A3.E66.m1.6.6.3.1.1.1.1.cmml">)</mo></mrow><mo id="A3.E66.m1.6.6.3.1.2a" lspace="0.167em" xref="A3.E66.m1.6.6.3.1.2.cmml">⁢</mo><mrow id="A3.E66.m1.6.6.3.1.4" xref="A3.E66.m1.6.6.3.1.4.cmml"><mi id="A3.E66.m1.6.6.3.1.4.1" xref="A3.E66.m1.6.6.3.1.4.1.cmml">log</mi><mo id="A3.E66.m1.6.6.3.1.4a" lspace="0.167em" xref="A3.E66.m1.6.6.3.1.4.cmml">⁡</mo><mfrac id="A3.E66.m1.2.2" xref="A3.E66.m1.2.2.cmml"><mrow id="A3.E66.m1.1.1.1" xref="A3.E66.m1.1.1.1.cmml"><mi id="A3.E66.m1.1.1.1.3" xref="A3.E66.m1.1.1.1.3.cmml">P</mi><mo id="A3.E66.m1.1.1.1.2" xref="A3.E66.m1.1.1.1.2.cmml">⁢</mo><mrow id="A3.E66.m1.1.1.1.1.1" xref="A3.E66.m1.1.1.1.1.1.1.cmml"><mo id="A3.E66.m1.1.1.1.1.1.2" stretchy="false" xref="A3.E66.m1.1.1.1.1.1.1.cmml">(</mo><msub id="A3.E66.m1.1.1.1.1.1.1" xref="A3.E66.m1.1.1.1.1.1.1.cmml"><mi id="A3.E66.m1.1.1.1.1.1.1.2" xref="A3.E66.m1.1.1.1.1.1.1.2.cmml">X</mi><mi id="A3.E66.m1.1.1.1.1.1.1.3" xref="A3.E66.m1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="A3.E66.m1.1.1.1.1.1.3" stretchy="false" xref="A3.E66.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A3.E66.m1.2.2.2" xref="A3.E66.m1.2.2.2.cmml"><mi id="A3.E66.m1.2.2.2.3" xref="A3.E66.m1.2.2.2.3.cmml">Q</mi><mo id="A3.E66.m1.2.2.2.2" xref="A3.E66.m1.2.2.2.2.cmml">⁢</mo><mrow id="A3.E66.m1.2.2.2.1.1" xref="A3.E66.m1.2.2.2.1.1.1.cmml"><mo id="A3.E66.m1.2.2.2.1.1.2" stretchy="false" xref="A3.E66.m1.2.2.2.1.1.1.cmml">(</mo><msub id="A3.E66.m1.2.2.2.1.1.1" xref="A3.E66.m1.2.2.2.1.1.1.cmml"><mi id="A3.E66.m1.2.2.2.1.1.1.2" xref="A3.E66.m1.2.2.2.1.1.1.2.cmml">X</mi><mi id="A3.E66.m1.2.2.2.1.1.1.3" xref="A3.E66.m1.2.2.2.1.1.1.3.cmml">j</mi></msub><mo id="A3.E66.m1.2.2.2.1.1.3" stretchy="false" xref="A3.E66.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.E66.m1.6b"><apply id="A3.E66.m1.6.6.cmml" xref="A3.E66.m1.6.6"><eq id="A3.E66.m1.6.6.4.cmml" xref="A3.E66.m1.6.6.4"></eq><apply id="A3.E66.m1.5.5.2.cmml" xref="A3.E66.m1.5.5.2"><times id="A3.E66.m1.5.5.2.3.cmml" xref="A3.E66.m1.5.5.2.3"></times><apply id="A3.E66.m1.5.5.2.4.cmml" xref="A3.E66.m1.5.5.2.4"><csymbol cd="ambiguous" id="A3.E66.m1.5.5.2.4.1.cmml" xref="A3.E66.m1.5.5.2.4">subscript</csymbol><ci id="A3.E66.m1.5.5.2.4.2.cmml" xref="A3.E66.m1.5.5.2.4.2">𝐽</ci><apply id="A3.E66.m1.5.5.2.4.3.cmml" xref="A3.E66.m1.5.5.2.4.3"><times id="A3.E66.m1.5.5.2.4.3.1.cmml" xref="A3.E66.m1.5.5.2.4.3.1"></times><ci id="A3.E66.m1.5.5.2.4.3.2.cmml" xref="A3.E66.m1.5.5.2.4.3.2">𝐾</ci><ci id="A3.E66.m1.5.5.2.4.3.3.cmml" xref="A3.E66.m1.5.5.2.4.3.3">𝐿</ci></apply></apply><vector id="A3.E66.m1.5.5.2.2.3.cmml" xref="A3.E66.m1.5.5.2.2.2"><apply id="A3.E66.m1.4.4.1.1.1.1.cmml" xref="A3.E66.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="A3.E66.m1.4.4.1.1.1.1.1.cmml" xref="A3.E66.m1.4.4.1.1.1.1">subscript</csymbol><ci id="A3.E66.m1.4.4.1.1.1.1.2.cmml" xref="A3.E66.m1.4.4.1.1.1.1.2">𝑋</ci><cn id="A3.E66.m1.4.4.1.1.1.1.3.cmml" type="integer" xref="A3.E66.m1.4.4.1.1.1.1.3">1</cn></apply><ci id="A3.E66.m1.3.3.cmml" xref="A3.E66.m1.3.3">…</ci><apply id="A3.E66.m1.5.5.2.2.2.2.cmml" xref="A3.E66.m1.5.5.2.2.2.2"><csymbol cd="ambiguous" id="A3.E66.m1.5.5.2.2.2.2.1.cmml" xref="A3.E66.m1.5.5.2.2.2.2">subscript</csymbol><ci id="A3.E66.m1.5.5.2.2.2.2.2.cmml" xref="A3.E66.m1.5.5.2.2.2.2.2">𝑋</ci><ci id="A3.E66.m1.5.5.2.2.2.2.3.cmml" xref="A3.E66.m1.5.5.2.2.2.2.3">𝑗</ci></apply></vector></apply><apply id="A3.E66.m1.6.6.3.cmml" xref="A3.E66.m1.6.6.3"><apply id="A3.E66.m1.6.6.3.2.cmml" xref="A3.E66.m1.6.6.3.2"><csymbol cd="ambiguous" id="A3.E66.m1.6.6.3.2.1.cmml" xref="A3.E66.m1.6.6.3.2">subscript</csymbol><sum id="A3.E66.m1.6.6.3.2.2.cmml" xref="A3.E66.m1.6.6.3.2.2"></sum><ci id="A3.E66.m1.6.6.3.2.3.cmml" xref="A3.E66.m1.6.6.3.2.3">𝑗</ci></apply><apply id="A3.E66.m1.6.6.3.1.cmml" xref="A3.E66.m1.6.6.3.1"><times id="A3.E66.m1.6.6.3.1.2.cmml" xref="A3.E66.m1.6.6.3.1.2"></times><ci id="A3.E66.m1.6.6.3.1.3.cmml" xref="A3.E66.m1.6.6.3.1.3">𝑃</ci><apply id="A3.E66.m1.6.6.3.1.1.1.1.cmml" xref="A3.E66.m1.6.6.3.1.1.1"><csymbol cd="ambiguous" id="A3.E66.m1.6.6.3.1.1.1.1.1.cmml" xref="A3.E66.m1.6.6.3.1.1.1">subscript</csymbol><ci id="A3.E66.m1.6.6.3.1.1.1.1.2.cmml" xref="A3.E66.m1.6.6.3.1.1.1.1.2">𝑋</ci><ci id="A3.E66.m1.6.6.3.1.1.1.1.3.cmml" xref="A3.E66.m1.6.6.3.1.1.1.1.3">𝑗</ci></apply><apply id="A3.E66.m1.6.6.3.1.4.cmml" xref="A3.E66.m1.6.6.3.1.4"><log id="A3.E66.m1.6.6.3.1.4.1.cmml" xref="A3.E66.m1.6.6.3.1.4.1"></log><apply id="A3.E66.m1.2.2.cmml" xref="A3.E66.m1.2.2"><divide id="A3.E66.m1.2.2.3.cmml" xref="A3.E66.m1.2.2"></divide><apply id="A3.E66.m1.1.1.1.cmml" xref="A3.E66.m1.1.1.1"><times id="A3.E66.m1.1.1.1.2.cmml" xref="A3.E66.m1.1.1.1.2"></times><ci id="A3.E66.m1.1.1.1.3.cmml" xref="A3.E66.m1.1.1.1.3">𝑃</ci><apply id="A3.E66.m1.1.1.1.1.1.1.cmml" xref="A3.E66.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E66.m1.1.1.1.1.1.1.1.cmml" xref="A3.E66.m1.1.1.1.1.1">subscript</csymbol><ci id="A3.E66.m1.1.1.1.1.1.1.2.cmml" xref="A3.E66.m1.1.1.1.1.1.1.2">𝑋</ci><ci id="A3.E66.m1.1.1.1.1.1.1.3.cmml" xref="A3.E66.m1.1.1.1.1.1.1.3">𝑗</ci></apply></apply><apply id="A3.E66.m1.2.2.2.cmml" xref="A3.E66.m1.2.2.2"><times id="A3.E66.m1.2.2.2.2.cmml" xref="A3.E66.m1.2.2.2.2"></times><ci id="A3.E66.m1.2.2.2.3.cmml" xref="A3.E66.m1.2.2.2.3">𝑄</ci><apply id="A3.E66.m1.2.2.2.1.1.1.cmml" xref="A3.E66.m1.2.2.2.1.1"><csymbol cd="ambiguous" id="A3.E66.m1.2.2.2.1.1.1.1.cmml" xref="A3.E66.m1.2.2.2.1.1">subscript</csymbol><ci id="A3.E66.m1.2.2.2.1.1.1.2.cmml" xref="A3.E66.m1.2.2.2.1.1.1.2">𝑋</ci><ci id="A3.E66.m1.2.2.2.1.1.1.3.cmml" xref="A3.E66.m1.2.2.2.1.1.1.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E66.m1.6c">J_{KL}(X_{1},\ldots,X_{j})=\sum_{j}P(X_{j})\log\frac{P(X_{j})}{Q(X_{j})}</annotation><annotation encoding="application/x-llamapun" id="A3.E66.m1.6d">italic_J start_POSTSUBSCRIPT italic_K italic_L end_POSTSUBSCRIPT ( italic_X start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) = ∑ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_P ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) roman_log divide start_ARG italic_P ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG start_ARG italic_Q ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(66)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A3.p4.6">as the splitting criterion.
The Pearson <math alttext="\chi^{2}" class="ltx_Math" display="inline" id="A3.p4.4.m1.1"><semantics id="A3.p4.4.m1.1a"><msup id="A3.p4.4.m1.1.1" xref="A3.p4.4.m1.1.1.cmml"><mi id="A3.p4.4.m1.1.1.2" xref="A3.p4.4.m1.1.1.2.cmml">χ</mi><mn id="A3.p4.4.m1.1.1.3" xref="A3.p4.4.m1.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="A3.p4.4.m1.1b"><apply id="A3.p4.4.m1.1.1.cmml" xref="A3.p4.4.m1.1.1"><csymbol cd="ambiguous" id="A3.p4.4.m1.1.1.1.cmml" xref="A3.p4.4.m1.1.1">superscript</csymbol><ci id="A3.p4.4.m1.1.1.2.cmml" xref="A3.p4.4.m1.1.1.2">𝜒</ci><cn id="A3.p4.4.m1.1.1.3.cmml" type="integer" xref="A3.p4.4.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p4.4.m1.1c">\chi^{2}</annotation><annotation encoding="application/x-llamapun" id="A3.p4.4.m1.1d">italic_χ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> divergence, with <math alttext="f(t)=(t-1)^{2}" class="ltx_Math" display="inline" id="A3.p4.5.m2.2"><semantics id="A3.p4.5.m2.2a"><mrow id="A3.p4.5.m2.2.2" xref="A3.p4.5.m2.2.2.cmml"><mrow id="A3.p4.5.m2.2.2.3" xref="A3.p4.5.m2.2.2.3.cmml"><mi id="A3.p4.5.m2.2.2.3.2" xref="A3.p4.5.m2.2.2.3.2.cmml">f</mi><mo id="A3.p4.5.m2.2.2.3.1" xref="A3.p4.5.m2.2.2.3.1.cmml">⁢</mo><mrow id="A3.p4.5.m2.2.2.3.3.2" xref="A3.p4.5.m2.2.2.3.cmml"><mo id="A3.p4.5.m2.2.2.3.3.2.1" stretchy="false" xref="A3.p4.5.m2.2.2.3.cmml">(</mo><mi id="A3.p4.5.m2.1.1" xref="A3.p4.5.m2.1.1.cmml">t</mi><mo id="A3.p4.5.m2.2.2.3.3.2.2" stretchy="false" xref="A3.p4.5.m2.2.2.3.cmml">)</mo></mrow></mrow><mo id="A3.p4.5.m2.2.2.2" xref="A3.p4.5.m2.2.2.2.cmml">=</mo><msup id="A3.p4.5.m2.2.2.1" xref="A3.p4.5.m2.2.2.1.cmml"><mrow id="A3.p4.5.m2.2.2.1.1.1" xref="A3.p4.5.m2.2.2.1.1.1.1.cmml"><mo id="A3.p4.5.m2.2.2.1.1.1.2" stretchy="false" xref="A3.p4.5.m2.2.2.1.1.1.1.cmml">(</mo><mrow id="A3.p4.5.m2.2.2.1.1.1.1" xref="A3.p4.5.m2.2.2.1.1.1.1.cmml"><mi id="A3.p4.5.m2.2.2.1.1.1.1.2" xref="A3.p4.5.m2.2.2.1.1.1.1.2.cmml">t</mi><mo id="A3.p4.5.m2.2.2.1.1.1.1.1" xref="A3.p4.5.m2.2.2.1.1.1.1.1.cmml">−</mo><mn id="A3.p4.5.m2.2.2.1.1.1.1.3" xref="A3.p4.5.m2.2.2.1.1.1.1.3.cmml">1</mn></mrow><mo id="A3.p4.5.m2.2.2.1.1.1.3" stretchy="false" xref="A3.p4.5.m2.2.2.1.1.1.1.cmml">)</mo></mrow><mn id="A3.p4.5.m2.2.2.1.3" xref="A3.p4.5.m2.2.2.1.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.p4.5.m2.2b"><apply id="A3.p4.5.m2.2.2.cmml" xref="A3.p4.5.m2.2.2"><eq id="A3.p4.5.m2.2.2.2.cmml" xref="A3.p4.5.m2.2.2.2"></eq><apply id="A3.p4.5.m2.2.2.3.cmml" xref="A3.p4.5.m2.2.2.3"><times id="A3.p4.5.m2.2.2.3.1.cmml" xref="A3.p4.5.m2.2.2.3.1"></times><ci id="A3.p4.5.m2.2.2.3.2.cmml" xref="A3.p4.5.m2.2.2.3.2">𝑓</ci><ci id="A3.p4.5.m2.1.1.cmml" xref="A3.p4.5.m2.1.1">𝑡</ci></apply><apply id="A3.p4.5.m2.2.2.1.cmml" xref="A3.p4.5.m2.2.2.1"><csymbol cd="ambiguous" id="A3.p4.5.m2.2.2.1.2.cmml" xref="A3.p4.5.m2.2.2.1">superscript</csymbol><apply id="A3.p4.5.m2.2.2.1.1.1.1.cmml" xref="A3.p4.5.m2.2.2.1.1.1"><minus id="A3.p4.5.m2.2.2.1.1.1.1.1.cmml" xref="A3.p4.5.m2.2.2.1.1.1.1.1"></minus><ci id="A3.p4.5.m2.2.2.1.1.1.1.2.cmml" xref="A3.p4.5.m2.2.2.1.1.1.1.2">𝑡</ci><cn id="A3.p4.5.m2.2.2.1.1.1.1.3.cmml" type="integer" xref="A3.p4.5.m2.2.2.1.1.1.1.3">1</cn></apply><cn id="A3.p4.5.m2.2.2.1.3.cmml" type="integer" xref="A3.p4.5.m2.2.2.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p4.5.m2.2c">f(t)=(t-1)^{2}</annotation><annotation encoding="application/x-llamapun" id="A3.p4.5.m2.2d">italic_f ( italic_t ) = ( italic_t - 1 ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>, leads to the same splitting criterion as NRGBoost.
Note however that for NRGBoost the leaf values for the multiplicative update of the density are proportional to <math alttext="\exp\left(\nicefrac{{P(X_{j})}}{{Q(X_{j})}}\right)" class="ltx_Math" display="inline" id="A3.p4.6.m3.3"><semantics id="A3.p4.6.m3.3a"><mrow id="A3.p4.6.m3.3.4.2" xref="A3.p4.6.m3.3.4.1.cmml"><mi id="A3.p4.6.m3.3.3" xref="A3.p4.6.m3.3.3.cmml">exp</mi><mo id="A3.p4.6.m3.3.4.2a" xref="A3.p4.6.m3.3.4.1.cmml">⁡</mo><mrow id="A3.p4.6.m3.3.4.2.1" xref="A3.p4.6.m3.3.4.1.cmml"><mo id="A3.p4.6.m3.3.4.2.1.1" xref="A3.p4.6.m3.3.4.1.cmml">(</mo><mrow id="A3.p4.6.m3.2.2" xref="A3.p4.6.m3.2.2.cmml"><mpadded id="A3.p4.6.m3.1.1.1" voffset="0.3em" xref="A3.p4.6.m3.1.1.1.cmml"><mi id="A3.p4.6.m3.1.1.1.3" mathsize="70%" xref="A3.p4.6.m3.1.1.1.3.cmml">P</mi><mo id="A3.p4.6.m3.1.1.1.2" xref="A3.p4.6.m3.1.1.1.2.cmml">⁢</mo><mrow id="A3.p4.6.m3.1.1.1.1.1" xref="A3.p4.6.m3.1.1.1.1.1.1.cmml"><mo id="A3.p4.6.m3.1.1.1.1.1.2" maxsize="70%" minsize="70%" xref="A3.p4.6.m3.1.1.1.1.1.1.cmml">(</mo><msub id="A3.p4.6.m3.1.1.1.1.1.1" xref="A3.p4.6.m3.1.1.1.1.1.1.cmml"><mi id="A3.p4.6.m3.1.1.1.1.1.1.2" mathsize="70%" xref="A3.p4.6.m3.1.1.1.1.1.1.2.cmml">X</mi><mi id="A3.p4.6.m3.1.1.1.1.1.1.3" mathsize="71%" xref="A3.p4.6.m3.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="A3.p4.6.m3.1.1.1.1.1.3" maxsize="70%" minsize="70%" xref="A3.p4.6.m3.1.1.1.1.1.1.cmml">)</mo></mrow></mpadded><mpadded id="A3.p4.6.m3.2.2.3" lspace="-0.1em" width="-0.15em" xref="A3.p4.6.m3.2.2.3.cmml"><mo id="A3.p4.6.m3.2.2.3a" stretchy="true" symmetric="true" xref="A3.p4.6.m3.2.2.3.cmml">/</mo></mpadded><mrow id="A3.p4.6.m3.2.2.2" xref="A3.p4.6.m3.2.2.2.cmml"><mi id="A3.p4.6.m3.2.2.2.3" mathsize="70%" xref="A3.p4.6.m3.2.2.2.3.cmml">Q</mi><mo id="A3.p4.6.m3.2.2.2.2" xref="A3.p4.6.m3.2.2.2.2.cmml">⁢</mo><mrow id="A3.p4.6.m3.2.2.2.1.1" xref="A3.p4.6.m3.2.2.2.1.1.1.cmml"><mo id="A3.p4.6.m3.2.2.2.1.1.2" maxsize="70%" minsize="70%" xref="A3.p4.6.m3.2.2.2.1.1.1.cmml">(</mo><msub id="A3.p4.6.m3.2.2.2.1.1.1" xref="A3.p4.6.m3.2.2.2.1.1.1.cmml"><mi id="A3.p4.6.m3.2.2.2.1.1.1.2" mathsize="70%" xref="A3.p4.6.m3.2.2.2.1.1.1.2.cmml">X</mi><mi id="A3.p4.6.m3.2.2.2.1.1.1.3" mathsize="71%" xref="A3.p4.6.m3.2.2.2.1.1.1.3.cmml">j</mi></msub><mo id="A3.p4.6.m3.2.2.2.1.1.3" maxsize="70%" minsize="70%" xref="A3.p4.6.m3.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A3.p4.6.m3.3.4.2.1.2" xref="A3.p4.6.m3.3.4.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.p4.6.m3.3b"><apply id="A3.p4.6.m3.3.4.1.cmml" xref="A3.p4.6.m3.3.4.2"><exp id="A3.p4.6.m3.3.3.cmml" xref="A3.p4.6.m3.3.3"></exp><apply id="A3.p4.6.m3.2.2.cmml" xref="A3.p4.6.m3.2.2"><divide id="A3.p4.6.m3.2.2.3.cmml" xref="A3.p4.6.m3.2.2.3"></divide><apply id="A3.p4.6.m3.1.1.1.cmml" xref="A3.p4.6.m3.1.1.1"><times id="A3.p4.6.m3.1.1.1.2.cmml" xref="A3.p4.6.m3.1.1.1.2"></times><ci id="A3.p4.6.m3.1.1.1.3.cmml" xref="A3.p4.6.m3.1.1.1.3">𝑃</ci><apply id="A3.p4.6.m3.1.1.1.1.1.1.cmml" xref="A3.p4.6.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.p4.6.m3.1.1.1.1.1.1.1.cmml" xref="A3.p4.6.m3.1.1.1.1.1">subscript</csymbol><ci id="A3.p4.6.m3.1.1.1.1.1.1.2.cmml" xref="A3.p4.6.m3.1.1.1.1.1.1.2">𝑋</ci><ci id="A3.p4.6.m3.1.1.1.1.1.1.3.cmml" xref="A3.p4.6.m3.1.1.1.1.1.1.3">𝑗</ci></apply></apply><apply id="A3.p4.6.m3.2.2.2.cmml" xref="A3.p4.6.m3.2.2.2"><times id="A3.p4.6.m3.2.2.2.2.cmml" xref="A3.p4.6.m3.2.2.2.2"></times><ci id="A3.p4.6.m3.2.2.2.3.cmml" xref="A3.p4.6.m3.2.2.2.3">𝑄</ci><apply id="A3.p4.6.m3.2.2.2.1.1.1.cmml" xref="A3.p4.6.m3.2.2.2.1.1"><csymbol cd="ambiguous" id="A3.p4.6.m3.2.2.2.1.1.1.1.cmml" xref="A3.p4.6.m3.2.2.2.1.1">subscript</csymbol><ci id="A3.p4.6.m3.2.2.2.1.1.1.2.cmml" xref="A3.p4.6.m3.2.2.2.1.1.1.2">𝑋</ci><ci id="A3.p4.6.m3.2.2.2.1.1.1.3.cmml" xref="A3.p4.6.m3.2.2.2.1.1.1.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p4.6.m3.3c">\exp\left(\nicefrac{{P(X_{j})}}{{Q(X_{j})}}\right)</annotation><annotation encoding="application/x-llamapun" id="A3.p4.6.m3.3d">roman_exp ( / start_ARG italic_P ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG start_ARG italic_Q ( italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG )</annotation></semantics></math> instead of the ratio directly.
Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A3.T6" title="Table 6 ‣ Appendix C Greedy Tree-Based Multiplicative Boosting ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">6</span></a> summarizes these results.</p>
</div>
<figure class="ltx_table" id="A3.T6">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 6: </span>Comparison of splitting criterion and leaf weights for the different versions of boosting.</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="A3.T6.7">
<tr class="ltx_tr" id="A3.T6.7.8">
<td class="ltx_td ltx_border_tt" id="A3.T6.7.8.1"></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T6.7.8.2">Splitting Criterion</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_tt" id="A3.T6.7.8.3">Leaf Values (Density)</td>
</tr>
<tr class="ltx_tr" id="A3.T6.2.2">
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T6.2.2.3">Greedy (KL)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T6.1.1.1"><math alttext="P\log\left(\nicefrac{{P}}{{Q}}\right)" class="ltx_Math" display="inline" id="A3.T6.1.1.1.m1.2"><semantics id="A3.T6.1.1.1.m1.2a"><mrow id="A3.T6.1.1.1.m1.2.3" xref="A3.T6.1.1.1.m1.2.3.cmml"><mi id="A3.T6.1.1.1.m1.2.3.2" xref="A3.T6.1.1.1.m1.2.3.2.cmml">P</mi><mo id="A3.T6.1.1.1.m1.2.3.1" lspace="0.167em" xref="A3.T6.1.1.1.m1.2.3.1.cmml">⁢</mo><mrow id="A3.T6.1.1.1.m1.2.3.3.2" xref="A3.T6.1.1.1.m1.2.3.3.1.cmml"><mi id="A3.T6.1.1.1.m1.1.1" xref="A3.T6.1.1.1.m1.1.1.cmml">log</mi><mo id="A3.T6.1.1.1.m1.2.3.3.2a" xref="A3.T6.1.1.1.m1.2.3.3.1.cmml">⁡</mo><mrow id="A3.T6.1.1.1.m1.2.3.3.2.1" xref="A3.T6.1.1.1.m1.2.3.3.1.cmml"><mo id="A3.T6.1.1.1.m1.2.3.3.2.1.1" xref="A3.T6.1.1.1.m1.2.3.3.1.cmml">(</mo><mrow id="A3.T6.1.1.1.m1.2.2" xref="A3.T6.1.1.1.m1.2.2.cmml"><mpadded id="A3.T6.1.1.1.m1.2.2.2" voffset="0.3em" xref="A3.T6.1.1.1.m1.2.2.2.cmml"><mi id="A3.T6.1.1.1.m1.2.2.2a" mathsize="70%" xref="A3.T6.1.1.1.m1.2.2.2.cmml">P</mi></mpadded><mpadded id="A3.T6.1.1.1.m1.2.2.1" lspace="-0.1em" width="-0.15em" xref="A3.T6.1.1.1.m1.2.2.1.cmml"><mo id="A3.T6.1.1.1.m1.2.2.1a" stretchy="true" symmetric="true" xref="A3.T6.1.1.1.m1.2.2.1.cmml">/</mo></mpadded><mi id="A3.T6.1.1.1.m1.2.2.3" mathsize="70%" xref="A3.T6.1.1.1.m1.2.2.3.cmml">Q</mi></mrow><mo id="A3.T6.1.1.1.m1.2.3.3.2.1.2" xref="A3.T6.1.1.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.T6.1.1.1.m1.2b"><apply id="A3.T6.1.1.1.m1.2.3.cmml" xref="A3.T6.1.1.1.m1.2.3"><times id="A3.T6.1.1.1.m1.2.3.1.cmml" xref="A3.T6.1.1.1.m1.2.3.1"></times><ci id="A3.T6.1.1.1.m1.2.3.2.cmml" xref="A3.T6.1.1.1.m1.2.3.2">𝑃</ci><apply id="A3.T6.1.1.1.m1.2.3.3.1.cmml" xref="A3.T6.1.1.1.m1.2.3.3.2"><log id="A3.T6.1.1.1.m1.1.1.cmml" xref="A3.T6.1.1.1.m1.1.1"></log><apply id="A3.T6.1.1.1.m1.2.2.cmml" xref="A3.T6.1.1.1.m1.2.2"><divide id="A3.T6.1.1.1.m1.2.2.1.cmml" xref="A3.T6.1.1.1.m1.2.2.1"></divide><ci id="A3.T6.1.1.1.m1.2.2.2.cmml" xref="A3.T6.1.1.1.m1.2.2.2">𝑃</ci><ci id="A3.T6.1.1.1.m1.2.2.3.cmml" xref="A3.T6.1.1.1.m1.2.2.3">𝑄</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T6.1.1.1.m1.2c">P\log\left(\nicefrac{{P}}{{Q}}\right)</annotation><annotation encoding="application/x-llamapun" id="A3.T6.1.1.1.m1.2d">italic_P roman_log ( / start_ARG italic_P end_ARG start_ARG italic_Q end_ARG )</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="A3.T6.2.2.2"><math alttext="\nicefrac{{P}}{{Q}}" class="ltx_Math" display="inline" id="A3.T6.2.2.2.m1.1"><semantics id="A3.T6.2.2.2.m1.1a"><mrow id="A3.T6.2.2.2.m1.1.1" xref="A3.T6.2.2.2.m1.1.1.cmml"><mpadded id="A3.T6.2.2.2.m1.1.1.2" voffset="0.3em" xref="A3.T6.2.2.2.m1.1.1.2.cmml"><mi id="A3.T6.2.2.2.m1.1.1.2a" mathsize="70%" xref="A3.T6.2.2.2.m1.1.1.2.cmml">P</mi></mpadded><mpadded id="A3.T6.2.2.2.m1.1.1.1" lspace="-0.1em" width="-0.15em" xref="A3.T6.2.2.2.m1.1.1.1.cmml"><mo id="A3.T6.2.2.2.m1.1.1.1a" stretchy="true" symmetric="true" xref="A3.T6.2.2.2.m1.1.1.1.cmml">/</mo></mpadded><mi id="A3.T6.2.2.2.m1.1.1.3" mathsize="70%" xref="A3.T6.2.2.2.m1.1.1.3.cmml">Q</mi></mrow><annotation-xml encoding="MathML-Content" id="A3.T6.2.2.2.m1.1b"><apply id="A3.T6.2.2.2.m1.1.1.cmml" xref="A3.T6.2.2.2.m1.1.1"><divide id="A3.T6.2.2.2.m1.1.1.1.cmml" xref="A3.T6.2.2.2.m1.1.1.1"></divide><ci id="A3.T6.2.2.2.m1.1.1.2.cmml" xref="A3.T6.2.2.2.m1.1.1.2">𝑃</ci><ci id="A3.T6.2.2.2.m1.1.1.3.cmml" xref="A3.T6.2.2.2.m1.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T6.2.2.2.m1.1c">\nicefrac{{P}}{{Q}}</annotation><annotation encoding="application/x-llamapun" id="A3.T6.2.2.2.m1.1d">/ start_ARG italic_P end_ARG start_ARG italic_Q end_ARG</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A3.T6.5.5">
<td class="ltx_td ltx_align_left" id="A3.T6.3.3.1">Greedy (<math alttext="\chi^{2}" class="ltx_Math" display="inline" id="A3.T6.3.3.1.m1.1"><semantics id="A3.T6.3.3.1.m1.1a"><msup id="A3.T6.3.3.1.m1.1.1" xref="A3.T6.3.3.1.m1.1.1.cmml"><mi id="A3.T6.3.3.1.m1.1.1.2" xref="A3.T6.3.3.1.m1.1.1.2.cmml">χ</mi><mn id="A3.T6.3.3.1.m1.1.1.3" xref="A3.T6.3.3.1.m1.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="A3.T6.3.3.1.m1.1b"><apply id="A3.T6.3.3.1.m1.1.1.cmml" xref="A3.T6.3.3.1.m1.1.1"><csymbol cd="ambiguous" id="A3.T6.3.3.1.m1.1.1.1.cmml" xref="A3.T6.3.3.1.m1.1.1">superscript</csymbol><ci id="A3.T6.3.3.1.m1.1.1.2.cmml" xref="A3.T6.3.3.1.m1.1.1.2">𝜒</ci><cn id="A3.T6.3.3.1.m1.1.1.3.cmml" type="integer" xref="A3.T6.3.3.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T6.3.3.1.m1.1c">\chi^{2}</annotation><annotation encoding="application/x-llamapun" id="A3.T6.3.3.1.m1.1d">italic_χ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>)</td>
<td class="ltx_td ltx_align_center" id="A3.T6.4.4.2"><math alttext="\nicefrac{{P^{2}}}{{Q}}" class="ltx_Math" display="inline" id="A3.T6.4.4.2.m1.1"><semantics id="A3.T6.4.4.2.m1.1a"><mrow id="A3.T6.4.4.2.m1.1.1" xref="A3.T6.4.4.2.m1.1.1.cmml"><mpadded id="A3.T6.4.4.2.m1.1.1.2" voffset="0.3em" xref="A3.T6.4.4.2.m1.1.1.2.cmml"><msup id="A3.T6.4.4.2.m1.1.1.2a" xref="A3.T6.4.4.2.m1.1.1.2.cmml"><mi id="A3.T6.4.4.2.m1.1.1.2.2" mathsize="70%" xref="A3.T6.4.4.2.m1.1.1.2.2.cmml">P</mi><mn id="A3.T6.4.4.2.m1.1.1.2.3" mathsize="71%" xref="A3.T6.4.4.2.m1.1.1.2.3.cmml">2</mn></msup></mpadded><mpadded id="A3.T6.4.4.2.m1.1.1.1" lspace="-0.1em" width="-0.15em" xref="A3.T6.4.4.2.m1.1.1.1.cmml"><mo id="A3.T6.4.4.2.m1.1.1.1a" stretchy="true" symmetric="true" xref="A3.T6.4.4.2.m1.1.1.1.cmml">/</mo></mpadded><mi id="A3.T6.4.4.2.m1.1.1.3" mathsize="70%" xref="A3.T6.4.4.2.m1.1.1.3.cmml">Q</mi></mrow><annotation-xml encoding="MathML-Content" id="A3.T6.4.4.2.m1.1b"><apply id="A3.T6.4.4.2.m1.1.1.cmml" xref="A3.T6.4.4.2.m1.1.1"><divide id="A3.T6.4.4.2.m1.1.1.1.cmml" xref="A3.T6.4.4.2.m1.1.1.1"></divide><apply id="A3.T6.4.4.2.m1.1.1.2.cmml" xref="A3.T6.4.4.2.m1.1.1.2"><csymbol cd="ambiguous" id="A3.T6.4.4.2.m1.1.1.2.1.cmml" xref="A3.T6.4.4.2.m1.1.1.2">superscript</csymbol><ci id="A3.T6.4.4.2.m1.1.1.2.2.cmml" xref="A3.T6.4.4.2.m1.1.1.2.2">𝑃</ci><cn id="A3.T6.4.4.2.m1.1.1.2.3.cmml" type="integer" xref="A3.T6.4.4.2.m1.1.1.2.3">2</cn></apply><ci id="A3.T6.4.4.2.m1.1.1.3.cmml" xref="A3.T6.4.4.2.m1.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T6.4.4.2.m1.1c">\nicefrac{{P^{2}}}{{Q}}</annotation><annotation encoding="application/x-llamapun" id="A3.T6.4.4.2.m1.1d">/ start_ARG italic_P start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_Q end_ARG</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A3.T6.5.5.3"><math alttext="\nicefrac{{P}}{{Q}}" class="ltx_Math" display="inline" id="A3.T6.5.5.3.m1.1"><semantics id="A3.T6.5.5.3.m1.1a"><mrow id="A3.T6.5.5.3.m1.1.1" xref="A3.T6.5.5.3.m1.1.1.cmml"><mpadded id="A3.T6.5.5.3.m1.1.1.2" voffset="0.3em" xref="A3.T6.5.5.3.m1.1.1.2.cmml"><mi id="A3.T6.5.5.3.m1.1.1.2a" mathsize="70%" xref="A3.T6.5.5.3.m1.1.1.2.cmml">P</mi></mpadded><mpadded id="A3.T6.5.5.3.m1.1.1.1" lspace="-0.1em" width="-0.15em" xref="A3.T6.5.5.3.m1.1.1.1.cmml"><mo id="A3.T6.5.5.3.m1.1.1.1a" stretchy="true" symmetric="true" xref="A3.T6.5.5.3.m1.1.1.1.cmml">/</mo></mpadded><mi id="A3.T6.5.5.3.m1.1.1.3" mathsize="70%" xref="A3.T6.5.5.3.m1.1.1.3.cmml">Q</mi></mrow><annotation-xml encoding="MathML-Content" id="A3.T6.5.5.3.m1.1b"><apply id="A3.T6.5.5.3.m1.1.1.cmml" xref="A3.T6.5.5.3.m1.1.1"><divide id="A3.T6.5.5.3.m1.1.1.1.cmml" xref="A3.T6.5.5.3.m1.1.1.1"></divide><ci id="A3.T6.5.5.3.m1.1.1.2.cmml" xref="A3.T6.5.5.3.m1.1.1.2">𝑃</ci><ci id="A3.T6.5.5.3.m1.1.1.3.cmml" xref="A3.T6.5.5.3.m1.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T6.5.5.3.m1.1c">\nicefrac{{P}}{{Q}}</annotation><annotation encoding="application/x-llamapun" id="A3.T6.5.5.3.m1.1d">/ start_ARG italic_P end_ARG start_ARG italic_Q end_ARG</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A3.T6.7.7">
<td class="ltx_td ltx_align_left ltx_border_bb" id="A3.T6.7.7.3">NRGBoost</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T6.6.6.1"><math alttext="\nicefrac{{P^{2}}}{{Q}}" class="ltx_Math" display="inline" id="A3.T6.6.6.1.m1.1"><semantics id="A3.T6.6.6.1.m1.1a"><mrow id="A3.T6.6.6.1.m1.1.1" xref="A3.T6.6.6.1.m1.1.1.cmml"><mpadded id="A3.T6.6.6.1.m1.1.1.2" voffset="0.3em" xref="A3.T6.6.6.1.m1.1.1.2.cmml"><msup id="A3.T6.6.6.1.m1.1.1.2a" xref="A3.T6.6.6.1.m1.1.1.2.cmml"><mi id="A3.T6.6.6.1.m1.1.1.2.2" mathsize="70%" xref="A3.T6.6.6.1.m1.1.1.2.2.cmml">P</mi><mn id="A3.T6.6.6.1.m1.1.1.2.3" mathsize="71%" xref="A3.T6.6.6.1.m1.1.1.2.3.cmml">2</mn></msup></mpadded><mpadded id="A3.T6.6.6.1.m1.1.1.1" lspace="-0.1em" width="-0.15em" xref="A3.T6.6.6.1.m1.1.1.1.cmml"><mo id="A3.T6.6.6.1.m1.1.1.1a" stretchy="true" symmetric="true" xref="A3.T6.6.6.1.m1.1.1.1.cmml">/</mo></mpadded><mi id="A3.T6.6.6.1.m1.1.1.3" mathsize="70%" xref="A3.T6.6.6.1.m1.1.1.3.cmml">Q</mi></mrow><annotation-xml encoding="MathML-Content" id="A3.T6.6.6.1.m1.1b"><apply id="A3.T6.6.6.1.m1.1.1.cmml" xref="A3.T6.6.6.1.m1.1.1"><divide id="A3.T6.6.6.1.m1.1.1.1.cmml" xref="A3.T6.6.6.1.m1.1.1.1"></divide><apply id="A3.T6.6.6.1.m1.1.1.2.cmml" xref="A3.T6.6.6.1.m1.1.1.2"><csymbol cd="ambiguous" id="A3.T6.6.6.1.m1.1.1.2.1.cmml" xref="A3.T6.6.6.1.m1.1.1.2">superscript</csymbol><ci id="A3.T6.6.6.1.m1.1.1.2.2.cmml" xref="A3.T6.6.6.1.m1.1.1.2.2">𝑃</ci><cn id="A3.T6.6.6.1.m1.1.1.2.3.cmml" type="integer" xref="A3.T6.6.6.1.m1.1.1.2.3">2</cn></apply><ci id="A3.T6.6.6.1.m1.1.1.3.cmml" xref="A3.T6.6.6.1.m1.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T6.6.6.1.m1.1c">\nicefrac{{P^{2}}}{{Q}}</annotation><annotation encoding="application/x-llamapun" id="A3.T6.6.6.1.m1.1d">/ start_ARG italic_P start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_Q end_ARG</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" id="A3.T6.7.7.2"><math alttext="\exp\left(\nicefrac{{P}}{{Q}}-1\right)" class="ltx_Math" display="inline" id="A3.T6.7.7.2.m1.2"><semantics id="A3.T6.7.7.2.m1.2a"><mrow id="A3.T6.7.7.2.m1.2.2.1" xref="A3.T6.7.7.2.m1.2.2.2.cmml"><mi id="A3.T6.7.7.2.m1.1.1" xref="A3.T6.7.7.2.m1.1.1.cmml">exp</mi><mo id="A3.T6.7.7.2.m1.2.2.1a" xref="A3.T6.7.7.2.m1.2.2.2.cmml">⁡</mo><mrow id="A3.T6.7.7.2.m1.2.2.1.1" xref="A3.T6.7.7.2.m1.2.2.2.cmml"><mo id="A3.T6.7.7.2.m1.2.2.1.1.2" xref="A3.T6.7.7.2.m1.2.2.2.cmml">(</mo><mrow id="A3.T6.7.7.2.m1.2.2.1.1.1" xref="A3.T6.7.7.2.m1.2.2.1.1.1.cmml"><mrow id="A3.T6.7.7.2.m1.2.2.1.1.1.2" xref="A3.T6.7.7.2.m1.2.2.1.1.1.2.cmml"><mpadded id="A3.T6.7.7.2.m1.2.2.1.1.1.2.2" voffset="0.3em" xref="A3.T6.7.7.2.m1.2.2.1.1.1.2.2.cmml"><mi id="A3.T6.7.7.2.m1.2.2.1.1.1.2.2a" mathsize="70%" xref="A3.T6.7.7.2.m1.2.2.1.1.1.2.2.cmml">P</mi></mpadded><mpadded id="A3.T6.7.7.2.m1.2.2.1.1.1.2.1" lspace="-0.1em" width="-0.15em" xref="A3.T6.7.7.2.m1.2.2.1.1.1.2.1.cmml"><mo id="A3.T6.7.7.2.m1.2.2.1.1.1.2.1a" stretchy="true" symmetric="true" xref="A3.T6.7.7.2.m1.2.2.1.1.1.2.1.cmml">/</mo></mpadded><mi id="A3.T6.7.7.2.m1.2.2.1.1.1.2.3" mathsize="70%" xref="A3.T6.7.7.2.m1.2.2.1.1.1.2.3.cmml">Q</mi></mrow><mo id="A3.T6.7.7.2.m1.2.2.1.1.1.1" xref="A3.T6.7.7.2.m1.2.2.1.1.1.1.cmml">−</mo><mn id="A3.T6.7.7.2.m1.2.2.1.1.1.3" xref="A3.T6.7.7.2.m1.2.2.1.1.1.3.cmml">1</mn></mrow><mo id="A3.T6.7.7.2.m1.2.2.1.1.3" xref="A3.T6.7.7.2.m1.2.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.T6.7.7.2.m1.2b"><apply id="A3.T6.7.7.2.m1.2.2.2.cmml" xref="A3.T6.7.7.2.m1.2.2.1"><exp id="A3.T6.7.7.2.m1.1.1.cmml" xref="A3.T6.7.7.2.m1.1.1"></exp><apply id="A3.T6.7.7.2.m1.2.2.1.1.1.cmml" xref="A3.T6.7.7.2.m1.2.2.1.1.1"><minus id="A3.T6.7.7.2.m1.2.2.1.1.1.1.cmml" xref="A3.T6.7.7.2.m1.2.2.1.1.1.1"></minus><apply id="A3.T6.7.7.2.m1.2.2.1.1.1.2.cmml" xref="A3.T6.7.7.2.m1.2.2.1.1.1.2"><divide id="A3.T6.7.7.2.m1.2.2.1.1.1.2.1.cmml" xref="A3.T6.7.7.2.m1.2.2.1.1.1.2.1"></divide><ci id="A3.T6.7.7.2.m1.2.2.1.1.1.2.2.cmml" xref="A3.T6.7.7.2.m1.2.2.1.1.1.2.2">𝑃</ci><ci id="A3.T6.7.7.2.m1.2.2.1.1.1.2.3.cmml" xref="A3.T6.7.7.2.m1.2.2.1.1.1.2.3">𝑄</ci></apply><cn id="A3.T6.7.7.2.m1.2.2.1.1.1.3.cmml" type="integer" xref="A3.T6.7.7.2.m1.2.2.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T6.7.7.2.m1.2c">\exp\left(\nicefrac{{P}}{{Q}}-1\right)</annotation><annotation encoding="application/x-llamapun" id="A3.T6.7.7.2.m1.2d">roman_exp ( / start_ARG italic_P end_ARG start_ARG italic_Q end_ARG - 1 )</annotation></semantics></math></td>
</tr>
</table>
</figure>
<div class="ltx_para ltx_noindent" id="A3.p5">
<p class="ltx_p" id="A3.p5.1">Another interesting observation is that a DET model can be interpreted as a single round of greedy multiplicative boosting
starting from a uniform initial model. The choice of the ISE as the criterion to optimize the DET corresponds to the choice of Pearson’s <math alttext="\chi^{2}" class="ltx_Math" display="inline" id="A3.p5.1.m1.1"><semantics id="A3.p5.1.m1.1a"><msup id="A3.p5.1.m1.1.1" xref="A3.p5.1.m1.1.1.cmml"><mi id="A3.p5.1.m1.1.1.2" xref="A3.p5.1.m1.1.1.2.cmml">χ</mi><mn id="A3.p5.1.m1.1.1.3" xref="A3.p5.1.m1.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="A3.p5.1.m1.1b"><apply id="A3.p5.1.m1.1.1.cmml" xref="A3.p5.1.m1.1.1"><csymbol cd="ambiguous" id="A3.p5.1.m1.1.1.1.cmml" xref="A3.p5.1.m1.1.1">superscript</csymbol><ci id="A3.p5.1.m1.1.1.2.cmml" xref="A3.p5.1.m1.1.1.2">𝜒</ci><cn id="A3.p5.1.m1.1.1.3.cmml" type="integer" xref="A3.p5.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p5.1.m1.1c">\chi^{2}</annotation><annotation encoding="application/x-llamapun" id="A3.p5.1.m1.1d">italic_χ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> divergence and likelihood to the choice of KL divergence.</p>
</div>
</section>
<section class="ltx_appendix" id="A4">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Reproducibility</h2>
<section class="ltx_subsection" id="A4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.1 </span>Datasets</h3>
<div class="ltx_para ltx_noindent" id="A4.SS1.p1">
<p class="ltx_p" id="A4.SS1.p1.1">We use 5 datasets from the UCI Machine Learning Repository <cite class="ltx_cite ltx_citemacro_citep">(Dheeru &amp; Karra Taniskidou, <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib8" title="">2017</a>)</cite>: Abalone, Physicochemical Properties of Protein Tertiary Structure (from hereon referred to as Protein), Adult, MiniBooNE and Covertype.
We also use the California Housing dataset which was downloaded through the Scikit-Learn package <cite class="ltx_cite ltx_citemacro_cite">Pedregosa et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib23" title="">2011</a>)</cite> and a downsampled version of the MNIST dataset <cite class="ltx_cite ltx_citemacro_cite">Deng (<a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib7" title="">2012</a>)</cite>.
Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A4.T7" title="Table 7 ‣ D.1 Datasets ‣ Appendix D Reproducibility ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">7</span></a> summarizes the main details of these datasets as well as the approximate number of samples used for train/validation/test for each cross-validation fold.</p>
</div>
<figure class="ltx_table" id="A4.T7">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 7: </span>Dataset Information. We respect the original test sets of each dataset when provided,
otherwise we set aside 20% of the original dataset as a test set. 20% of the remaining data
is set aside as a validation set used for hyperparameter tuning.
</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_centering ltx_figure_panel ltx_align_middle" id="A4.T7.2">
<tr class="ltx_tr" id="A4.T7.2.3">
<td class="ltx_td ltx_align_left ltx_border_tt" id="A4.T7.2.3.1">Abbr</td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="A4.T7.2.3.2">Name</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A4.T7.2.3.3">Train + Val</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A4.T7.2.3.4">Test</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A4.T7.2.3.5">Num</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A4.T7.2.3.6">Cat</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A4.T7.2.3.7">Target</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A4.T7.2.3.8">Cardinality</td>
</tr>
<tr class="ltx_tr" id="A4.T7.2.4">
<td class="ltx_td ltx_align_left ltx_border_t" id="A4.T7.2.4.1">AB</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A4.T7.2.4.2">Abalone</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T7.2.4.3">3342</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T7.2.4.4">835</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T7.2.4.5">7</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T7.2.4.6">1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T7.2.4.7">Num</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T7.2.4.8">29</td>
</tr>
<tr class="ltx_tr" id="A4.T7.2.5">
<td class="ltx_td ltx_align_left" id="A4.T7.2.5.1">CH</td>
<td class="ltx_td ltx_align_left" id="A4.T7.2.5.2">California Housing</td>
<td class="ltx_td ltx_align_center" id="A4.T7.2.5.3">16512</td>
<td class="ltx_td ltx_align_center" id="A4.T7.2.5.4">4128</td>
<td class="ltx_td ltx_align_center" id="A4.T7.2.5.5">8</td>
<td class="ltx_td ltx_align_center" id="A4.T7.2.5.6">0</td>
<td class="ltx_td ltx_align_center" id="A4.T7.2.5.7">Num</td>
<td class="ltx_td ltx_align_center" id="A4.T7.2.5.8">Continuous</td>
</tr>
<tr class="ltx_tr" id="A4.T7.2.6">
<td class="ltx_td ltx_align_left" id="A4.T7.2.6.1">PR</td>
<td class="ltx_td ltx_align_left" id="A4.T7.2.6.2">Protein</td>
<td class="ltx_td ltx_align_center" id="A4.T7.2.6.3">36584</td>
<td class="ltx_td ltx_align_center" id="A4.T7.2.6.4">9146</td>
<td class="ltx_td ltx_align_center" id="A4.T7.2.6.5">9</td>
<td class="ltx_td ltx_align_center" id="A4.T7.2.6.6">0</td>
<td class="ltx_td ltx_align_center" id="A4.T7.2.6.7">Num</td>
<td class="ltx_td ltx_align_center" id="A4.T7.2.6.8">Continuous</td>
</tr>
<tr class="ltx_tr" id="A4.T7.1.1">
<td class="ltx_td ltx_align_left" id="A4.T7.1.1.2">AD</td>
<td class="ltx_td ltx_align_left" id="A4.T7.1.1.3">Adult</td>
<td class="ltx_td ltx_align_center" id="A4.T7.1.1.4">32560</td>
<td class="ltx_td ltx_align_center" id="A4.T7.1.1.1">16280<sup class="ltx_sup" id="A4.T7.1.1.1.1">∗</sup>
</td>
<td class="ltx_td ltx_align_center" id="A4.T7.1.1.5">6</td>
<td class="ltx_td ltx_align_center" id="A4.T7.1.1.6">8</td>
<td class="ltx_td ltx_align_center" id="A4.T7.1.1.7">Cat</td>
<td class="ltx_td ltx_align_center" id="A4.T7.1.1.8">2</td>
</tr>
<tr class="ltx_tr" id="A4.T7.2.7">
<td class="ltx_td ltx_align_left" id="A4.T7.2.7.1">MBNE</td>
<td class="ltx_td ltx_align_left" id="A4.T7.2.7.2">MiniBooNE</td>
<td class="ltx_td ltx_align_center" id="A4.T7.2.7.3">104051</td>
<td class="ltx_td ltx_align_center" id="A4.T7.2.7.4">26013</td>
<td class="ltx_td ltx_align_center" id="A4.T7.2.7.5">50</td>
<td class="ltx_td ltx_align_center" id="A4.T7.2.7.6">0</td>
<td class="ltx_td ltx_align_center" id="A4.T7.2.7.7">Cat</td>
<td class="ltx_td ltx_align_center" id="A4.T7.2.7.8">2</td>
</tr>
<tr class="ltx_tr" id="A4.T7.2.2">
<td class="ltx_td ltx_align_left" id="A4.T7.2.2.2">MNIST</td>
<td class="ltx_td ltx_align_left" id="A4.T7.2.2.3">MNIST (downsampled)</td>
<td class="ltx_td ltx_align_center" id="A4.T7.2.2.4">60000</td>
<td class="ltx_td ltx_align_center" id="A4.T7.2.2.1">10000<sup class="ltx_sup" id="A4.T7.2.2.1.1">∗</sup>
</td>
<td class="ltx_td ltx_align_center" id="A4.T7.2.2.5">196</td>
<td class="ltx_td ltx_align_center" id="A4.T7.2.2.6">0</td>
<td class="ltx_td ltx_align_center" id="A4.T7.2.2.7">Cat</td>
<td class="ltx_td ltx_align_center" id="A4.T7.2.2.8">10</td>
</tr>
<tr class="ltx_tr" id="A4.T7.2.8">
<td class="ltx_td ltx_align_left ltx_border_bb" id="A4.T7.2.8.1">CT</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A4.T7.2.8.2">Covertype</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T7.2.8.3">464810</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T7.2.8.4">116202</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T7.2.8.5">10</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T7.2.8.6">2</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T7.2.8.7">Cat</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T7.2.8.8">7</td>
</tr>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<ul class="ltx_itemize ltx_centering ltx_figure_panel" id="A4.I1">
<li class="ltx_item" id="A4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="A4.I1.i1.p1">
<p class="ltx_p" id="A4.I1.i1.p1.1"><sup class="ltx_sup" id="A4.I1.i1.p1.1.1">∗</sup> Original test set was respected.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_flex_break"></div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="A4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.2 </span>DEF and NRGBoost Implementation Details</h3>
<section class="ltx_paragraph" id="A4.SS2.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Discretization</h5>
<div class="ltx_para ltx_noindent" id="A4.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="A4.SS2.SSS0.Px1.p1.1">In our practical implementation of tree based methods we first discretize the input space by binning continuous numerical variables by quantiles.
Furthermore we also bin discrete numerical variables in order to keep their cardinalities smaller than 256.
This can also be interpreted as establishing a priori a set of discrete values to consider when splitting on each numerical variable
and is done for computational efficiency, being inspired by LightGBM <cite class="ltx_cite ltx_citemacro_citep">(Ke et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib18" title="">2017</a>)</cite>.</p>
</div>
</section>
<section class="ltx_paragraph" id="A4.SS2.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Categorical Splitting</h5>
<div class="ltx_para ltx_noindent" id="A4.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="A4.SS2.SSS0.Px2.p1.4">For splitting on a categorical variable we once again take inspiration from LightGBM.
Rather than relying on one-vs-all splits we found it better to first order the possible categorical values at a leaf according to a pre-defined sorting function and then choose the optimal many-vs-many split as if the variable was numerical.
The function used to sort the values is the leaf value function.
E.g., for splitting on a categorical variable <math alttext="x_{i}" class="ltx_Math" display="inline" id="A4.SS2.SSS0.Px2.p1.1.m1.1"><semantics id="A4.SS2.SSS0.Px2.p1.1.m1.1a"><msub id="A4.SS2.SSS0.Px2.p1.1.m1.1.1" xref="A4.SS2.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="A4.SS2.SSS0.Px2.p1.1.m1.1.1.2" xref="A4.SS2.SSS0.Px2.p1.1.m1.1.1.2.cmml">x</mi><mi id="A4.SS2.SSS0.Px2.p1.1.m1.1.1.3" xref="A4.SS2.SSS0.Px2.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A4.SS2.SSS0.Px2.p1.1.m1.1b"><apply id="A4.SS2.SSS0.Px2.p1.1.m1.1.1.cmml" xref="A4.SS2.SSS0.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A4.SS2.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="A4.SS2.SSS0.Px2.p1.1.m1.1.1">subscript</csymbol><ci id="A4.SS2.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="A4.SS2.SSS0.Px2.p1.1.m1.1.1.2">𝑥</ci><ci id="A4.SS2.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="A4.SS2.SSS0.Px2.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.SSS0.Px2.p1.1.m1.1c">x_{i}</annotation><annotation encoding="application/x-llamapun" id="A4.SS2.SSS0.Px2.p1.1.m1.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> we order each possible categorical value <math alttext="k" class="ltx_Math" display="inline" id="A4.SS2.SSS0.Px2.p1.2.m2.1"><semantics id="A4.SS2.SSS0.Px2.p1.2.m2.1a"><mi id="A4.SS2.SSS0.Px2.p1.2.m2.1.1" xref="A4.SS2.SSS0.Px2.p1.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A4.SS2.SSS0.Px2.p1.2.m2.1b"><ci id="A4.SS2.SSS0.Px2.p1.2.m2.1.1.cmml" xref="A4.SS2.SSS0.Px2.p1.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.SSS0.Px2.p1.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="A4.SS2.SSS0.Px2.p1.2.m2.1d">italic_k</annotation></semantics></math> by <math alttext="\nicefrac{{\hat{P}(x_{i}=k,X_{-i})}}{{\hat{Q}(x_{i}=k,X_{-i})}}" class="ltx_Math" display="inline" id="A4.SS2.SSS0.Px2.p1.3.m3.4"><semantics id="A4.SS2.SSS0.Px2.p1.3.m3.4a"><mrow id="A4.SS2.SSS0.Px2.p1.3.m3.4.4" xref="A4.SS2.SSS0.Px2.p1.3.m3.4.4.cmml"><mpadded id="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2" voffset="0.3em" xref="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.cmml"><mover accent="true" id="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.4" xref="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.4.cmml"><mi id="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.4.2" mathsize="70%" xref="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.4.2.cmml">P</mi><mo id="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.4.1" mathsize="70%" xref="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.4.1.cmml">^</mo></mover><mo id="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.3" xref="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.3.cmml">⁢</mo><mrow id="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1" xref="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.cmml"><mo id="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.2" maxsize="70%" minsize="70%" xref="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.cmml">(</mo><mrow id="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1" xref="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.cmml"><msub id="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.3" xref="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.3.cmml"><mi id="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.3.2" mathsize="70%" xref="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.3.2.cmml">x</mi><mi id="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.3.3" mathsize="71%" xref="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.3.3.cmml">i</mi></msub><mo id="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.2" mathsize="70%" xref="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.2.cmml">=</mo><mrow id="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.1.1" xref="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.1.2.cmml"><mi id="A4.SS2.SSS0.Px2.p1.3.m3.1.1.1.1" mathsize="70%" xref="A4.SS2.SSS0.Px2.p1.3.m3.1.1.1.1.cmml">k</mi><mo id="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.1.1.2" mathsize="70%" xref="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.1.2.cmml">,</mo><msub id="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.1.1.1" xref="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.1.1.1.cmml"><mi id="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.1.1.1.2" mathsize="70%" xref="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.1.1.1.2.cmml">X</mi><mrow id="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.1.1.1.3" xref="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.1.1.1.3.cmml"><mo id="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.1.1.1.3a" mathsize="71%" xref="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.1.1.1.3.cmml">−</mo><mi id="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.1.1.1.3.2" mathsize="71%" xref="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.1.1.1.3.2.cmml">i</mi></mrow></msub></mrow></mrow><mo id="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.3" maxsize="70%" minsize="70%" xref="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.cmml">)</mo></mrow></mpadded><mpadded id="A4.SS2.SSS0.Px2.p1.3.m3.4.4.5" lspace="-0.1em" width="-0.15em" xref="A4.SS2.SSS0.Px2.p1.3.m3.4.4.5.cmml"><mo id="A4.SS2.SSS0.Px2.p1.3.m3.4.4.5a" stretchy="true" symmetric="true" xref="A4.SS2.SSS0.Px2.p1.3.m3.4.4.5.cmml">/</mo></mpadded><mrow id="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4" xref="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.cmml"><mover accent="true" id="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.4" xref="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.4.cmml"><mi id="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.4.2" mathsize="70%" xref="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.4.2.cmml">Q</mi><mo id="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.4.1" mathsize="70%" xref="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.4.1.cmml">^</mo></mover><mo id="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.3" xref="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.3.cmml">⁢</mo><mrow id="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1" xref="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.cmml"><mo id="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.2" maxsize="70%" minsize="70%" xref="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.cmml">(</mo><mrow id="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1" xref="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.cmml"><msub id="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.3" xref="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.3.cmml"><mi id="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.3.2" mathsize="70%" xref="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.3.2.cmml">x</mi><mi id="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.3.3" mathsize="71%" xref="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.3.3.cmml">i</mi></msub><mo id="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.2" mathsize="70%" xref="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.2.cmml">=</mo><mrow id="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.1.1" xref="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.1.2.cmml"><mi id="A4.SS2.SSS0.Px2.p1.3.m3.3.3.3.1" mathsize="70%" xref="A4.SS2.SSS0.Px2.p1.3.m3.3.3.3.1.cmml">k</mi><mo id="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.1.1.2" mathsize="70%" xref="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.1.2.cmml">,</mo><msub id="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.1.1.1" xref="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.1.1.1.cmml"><mi id="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.1.1.1.2" mathsize="70%" xref="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.1.1.1.2.cmml">X</mi><mrow id="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.1.1.1.3" xref="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.1.1.1.3.cmml"><mo id="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.1.1.1.3a" mathsize="71%" xref="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.1.1.1.3.cmml">−</mo><mi id="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.1.1.1.3.2" mathsize="71%" xref="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.1.1.1.3.2.cmml">i</mi></mrow></msub></mrow></mrow><mo id="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.3" maxsize="70%" minsize="70%" xref="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.SS2.SSS0.Px2.p1.3.m3.4b"><apply id="A4.SS2.SSS0.Px2.p1.3.m3.4.4.cmml" xref="A4.SS2.SSS0.Px2.p1.3.m3.4.4"><divide id="A4.SS2.SSS0.Px2.p1.3.m3.4.4.5.cmml" xref="A4.SS2.SSS0.Px2.p1.3.m3.4.4.5"></divide><apply id="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.cmml" xref="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2"><times id="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.3.cmml" xref="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.3"></times><apply id="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.4.cmml" xref="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.4"><ci id="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.4.1.cmml" xref="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.4.1">^</ci><ci id="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.4.2.cmml" xref="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.4.2">𝑃</ci></apply><apply id="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.cmml" xref="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1"><eq id="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.2.cmml" xref="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.2"></eq><apply id="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.3.cmml" xref="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.3.1.cmml" xref="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.3">subscript</csymbol><ci id="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.3.2.cmml" xref="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.3.2">𝑥</ci><ci id="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.3.3.cmml" xref="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.3.3">𝑖</ci></apply><list id="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.1.2.cmml" xref="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.1.1"><ci id="A4.SS2.SSS0.Px2.p1.3.m3.1.1.1.1.cmml" xref="A4.SS2.SSS0.Px2.p1.3.m3.1.1.1.1">𝑘</ci><apply id="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.1.1.1.cmml" xref="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.1.1.1.1.cmml" xref="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.1.1.1">subscript</csymbol><ci id="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.1.1.1.2.cmml" xref="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.1.1.1.2">𝑋</ci><apply id="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.1.1.1.3.cmml" xref="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.1.1.1.3"><minus id="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.1.1.1.3.1.cmml" xref="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.1.1.1.3"></minus><ci id="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.1.1.1.3.2.cmml" xref="A4.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.1.1.1.3.2">𝑖</ci></apply></apply></list></apply></apply><apply id="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.cmml" xref="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4"><times id="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.3.cmml" xref="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.3"></times><apply id="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.4.cmml" xref="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.4"><ci id="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.4.1.cmml" xref="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.4.1">^</ci><ci id="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.4.2.cmml" xref="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.4.2">𝑄</ci></apply><apply id="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.cmml" xref="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1"><eq id="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.2.cmml" xref="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.2"></eq><apply id="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.3.cmml" xref="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.3"><csymbol cd="ambiguous" id="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.3.1.cmml" xref="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.3">subscript</csymbol><ci id="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.3.2.cmml" xref="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.3.2">𝑥</ci><ci id="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.3.3.cmml" xref="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.3.3">𝑖</ci></apply><list id="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.1.2.cmml" xref="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.1.1"><ci id="A4.SS2.SSS0.Px2.p1.3.m3.3.3.3.1.cmml" xref="A4.SS2.SSS0.Px2.p1.3.m3.3.3.3.1">𝑘</ci><apply id="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.1.1.1.cmml" xref="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.1.1.1.1.cmml" xref="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.1.1.1">subscript</csymbol><ci id="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.1.1.1.2.cmml" xref="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.1.1.1.2">𝑋</ci><apply id="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.1.1.1.3.cmml" xref="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.1.1.1.3"><minus id="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.1.1.1.3.1.cmml" xref="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.1.1.1.3"></minus><ci id="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.1.1.1.3.2.cmml" xref="A4.SS2.SSS0.Px2.p1.3.m3.4.4.4.2.1.1.1.1.1.3.2">𝑖</ci></apply></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.SSS0.Px2.p1.3.m3.4c">\nicefrac{{\hat{P}(x_{i}=k,X_{-i})}}{{\hat{Q}(x_{i}=k,X_{-i})}}</annotation><annotation encoding="application/x-llamapun" id="A4.SS2.SSS0.Px2.p1.3.m3.4d">/ start_ARG over^ start_ARG italic_P end_ARG ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_k , italic_X start_POSTSUBSCRIPT - italic_i end_POSTSUBSCRIPT ) end_ARG start_ARG over^ start_ARG italic_Q end_ARG ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_k , italic_X start_POSTSUBSCRIPT - italic_i end_POSTSUBSCRIPT ) end_ARG</annotation></semantics></math> where <math alttext="X_{-i}" class="ltx_Math" display="inline" id="A4.SS2.SSS0.Px2.p1.4.m4.1"><semantics id="A4.SS2.SSS0.Px2.p1.4.m4.1a"><msub id="A4.SS2.SSS0.Px2.p1.4.m4.1.1" xref="A4.SS2.SSS0.Px2.p1.4.m4.1.1.cmml"><mi id="A4.SS2.SSS0.Px2.p1.4.m4.1.1.2" xref="A4.SS2.SSS0.Px2.p1.4.m4.1.1.2.cmml">X</mi><mrow id="A4.SS2.SSS0.Px2.p1.4.m4.1.1.3" xref="A4.SS2.SSS0.Px2.p1.4.m4.1.1.3.cmml"><mo id="A4.SS2.SSS0.Px2.p1.4.m4.1.1.3a" xref="A4.SS2.SSS0.Px2.p1.4.m4.1.1.3.cmml">−</mo><mi id="A4.SS2.SSS0.Px2.p1.4.m4.1.1.3.2" xref="A4.SS2.SSS0.Px2.p1.4.m4.1.1.3.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A4.SS2.SSS0.Px2.p1.4.m4.1b"><apply id="A4.SS2.SSS0.Px2.p1.4.m4.1.1.cmml" xref="A4.SS2.SSS0.Px2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="A4.SS2.SSS0.Px2.p1.4.m4.1.1.1.cmml" xref="A4.SS2.SSS0.Px2.p1.4.m4.1.1">subscript</csymbol><ci id="A4.SS2.SSS0.Px2.p1.4.m4.1.1.2.cmml" xref="A4.SS2.SSS0.Px2.p1.4.m4.1.1.2">𝑋</ci><apply id="A4.SS2.SSS0.Px2.p1.4.m4.1.1.3.cmml" xref="A4.SS2.SSS0.Px2.p1.4.m4.1.1.3"><minus id="A4.SS2.SSS0.Px2.p1.4.m4.1.1.3.1.cmml" xref="A4.SS2.SSS0.Px2.p1.4.m4.1.1.3"></minus><ci id="A4.SS2.SSS0.Px2.p1.4.m4.1.1.3.2.cmml" xref="A4.SS2.SSS0.Px2.p1.4.m4.1.1.3.2">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.SSS0.Px2.p1.4.m4.1c">X_{-i}</annotation><annotation encoding="application/x-llamapun" id="A4.SS2.SSS0.Px2.p1.4.m4.1d">italic_X start_POSTSUBSCRIPT - italic_i end_POSTSUBSCRIPT</annotation></semantics></math> denotes the leaf support over the remaining variables.</p>
</div>
</section>
<section class="ltx_paragraph" id="A4.SS2.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Tree Growth Strategy</h5>
<div class="ltx_para ltx_noindent" id="A4.SS2.SSS0.Px3.p1">
<p class="ltx_p" id="A4.SS2.SSS0.Px3.p1.1">We always grow trees in best first order, i.e., we always split the current leaf node that yields the maximum gain in the chosen objective value.</p>
</div>
</section>
<section class="ltx_paragraph" id="A4.SS2.SSS0.Px4">
<h5 class="ltx_title ltx_title_paragraph">Line Search</h5>
<div class="ltx_para ltx_noindent" id="A4.SS2.SSS0.Px4.p1">
<p class="ltx_p" id="A4.SS2.SSS0.Px4.p1.2">As mentioned in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S3" title="3 NRGBoost ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">3</span></a>, we perform a line search to find the optimal step size after each round of boosting in order to maximize the likelihood gain in Equation <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A1.E45" title="In A.1 Application to Piecewise Constant Functions ‣ Appendix A Theory ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">45</span></a>.
Because evaluating multiple possible step sizes, <math alttext="\alpha_{t}" class="ltx_Math" display="inline" id="A4.SS2.SSS0.Px4.p1.1.m1.1"><semantics id="A4.SS2.SSS0.Px4.p1.1.m1.1a"><msub id="A4.SS2.SSS0.Px4.p1.1.m1.1.1" xref="A4.SS2.SSS0.Px4.p1.1.m1.1.1.cmml"><mi id="A4.SS2.SSS0.Px4.p1.1.m1.1.1.2" xref="A4.SS2.SSS0.Px4.p1.1.m1.1.1.2.cmml">α</mi><mi id="A4.SS2.SSS0.Px4.p1.1.m1.1.1.3" xref="A4.SS2.SSS0.Px4.p1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A4.SS2.SSS0.Px4.p1.1.m1.1b"><apply id="A4.SS2.SSS0.Px4.p1.1.m1.1.1.cmml" xref="A4.SS2.SSS0.Px4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A4.SS2.SSS0.Px4.p1.1.m1.1.1.1.cmml" xref="A4.SS2.SSS0.Px4.p1.1.m1.1.1">subscript</csymbol><ci id="A4.SS2.SSS0.Px4.p1.1.m1.1.1.2.cmml" xref="A4.SS2.SSS0.Px4.p1.1.m1.1.1.2">𝛼</ci><ci id="A4.SS2.SSS0.Px4.p1.1.m1.1.1.3.cmml" xref="A4.SS2.SSS0.Px4.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.SSS0.Px4.p1.1.m1.1c">\alpha_{t}</annotation><annotation encoding="application/x-llamapun" id="A4.SS2.SSS0.Px4.p1.1.m1.1d">italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, is inexpensive, we simply do a grid search over 101 different step sizes, split evenly in log space over <math alttext="[10^{-3},10]" class="ltx_Math" display="inline" id="A4.SS2.SSS0.Px4.p1.2.m2.2"><semantics id="A4.SS2.SSS0.Px4.p1.2.m2.2a"><mrow id="A4.SS2.SSS0.Px4.p1.2.m2.2.2.1" xref="A4.SS2.SSS0.Px4.p1.2.m2.2.2.2.cmml"><mo id="A4.SS2.SSS0.Px4.p1.2.m2.2.2.1.2" stretchy="false" xref="A4.SS2.SSS0.Px4.p1.2.m2.2.2.2.cmml">[</mo><msup id="A4.SS2.SSS0.Px4.p1.2.m2.2.2.1.1" xref="A4.SS2.SSS0.Px4.p1.2.m2.2.2.1.1.cmml"><mn id="A4.SS2.SSS0.Px4.p1.2.m2.2.2.1.1.2" xref="A4.SS2.SSS0.Px4.p1.2.m2.2.2.1.1.2.cmml">10</mn><mrow id="A4.SS2.SSS0.Px4.p1.2.m2.2.2.1.1.3" xref="A4.SS2.SSS0.Px4.p1.2.m2.2.2.1.1.3.cmml"><mo id="A4.SS2.SSS0.Px4.p1.2.m2.2.2.1.1.3a" xref="A4.SS2.SSS0.Px4.p1.2.m2.2.2.1.1.3.cmml">−</mo><mn id="A4.SS2.SSS0.Px4.p1.2.m2.2.2.1.1.3.2" xref="A4.SS2.SSS0.Px4.p1.2.m2.2.2.1.1.3.2.cmml">3</mn></mrow></msup><mo id="A4.SS2.SSS0.Px4.p1.2.m2.2.2.1.3" xref="A4.SS2.SSS0.Px4.p1.2.m2.2.2.2.cmml">,</mo><mn id="A4.SS2.SSS0.Px4.p1.2.m2.1.1" xref="A4.SS2.SSS0.Px4.p1.2.m2.1.1.cmml">10</mn><mo id="A4.SS2.SSS0.Px4.p1.2.m2.2.2.1.4" stretchy="false" xref="A4.SS2.SSS0.Px4.p1.2.m2.2.2.2.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.SS2.SSS0.Px4.p1.2.m2.2b"><interval closure="closed" id="A4.SS2.SSS0.Px4.p1.2.m2.2.2.2.cmml" xref="A4.SS2.SSS0.Px4.p1.2.m2.2.2.1"><apply id="A4.SS2.SSS0.Px4.p1.2.m2.2.2.1.1.cmml" xref="A4.SS2.SSS0.Px4.p1.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="A4.SS2.SSS0.Px4.p1.2.m2.2.2.1.1.1.cmml" xref="A4.SS2.SSS0.Px4.p1.2.m2.2.2.1.1">superscript</csymbol><cn id="A4.SS2.SSS0.Px4.p1.2.m2.2.2.1.1.2.cmml" type="integer" xref="A4.SS2.SSS0.Px4.p1.2.m2.2.2.1.1.2">10</cn><apply id="A4.SS2.SSS0.Px4.p1.2.m2.2.2.1.1.3.cmml" xref="A4.SS2.SSS0.Px4.p1.2.m2.2.2.1.1.3"><minus id="A4.SS2.SSS0.Px4.p1.2.m2.2.2.1.1.3.1.cmml" xref="A4.SS2.SSS0.Px4.p1.2.m2.2.2.1.1.3"></minus><cn id="A4.SS2.SSS0.Px4.p1.2.m2.2.2.1.1.3.2.cmml" type="integer" xref="A4.SS2.SSS0.Px4.p1.2.m2.2.2.1.1.3.2">3</cn></apply></apply><cn id="A4.SS2.SSS0.Px4.p1.2.m2.1.1.cmml" type="integer" xref="A4.SS2.SSS0.Px4.p1.2.m2.1.1">10</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.SSS0.Px4.p1.2.m2.2c">[10^{-3},10]</annotation><annotation encoding="application/x-llamapun" id="A4.SS2.SSS0.Px4.p1.2.m2.2d">[ 10 start_POSTSUPERSCRIPT - 3 end_POSTSUPERSCRIPT , 10 ]</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_paragraph" id="A4.SS2.SSS0.Px5">
<h5 class="ltx_title ltx_title_paragraph">Code</h5>
<div class="ltx_para ltx_noindent" id="A4.SS2.SSS0.Px5.p1">
<p class="ltx_p" id="A4.SS2.SSS0.Px5.p1.1">Our implementation of the proposed tree-based methods is mostly Python code using the NumPy library <cite class="ltx_cite ltx_citemacro_citep">(Harris et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib15" title="">2020</a>)</cite>. We implement the tree evaluation and Gibbs sampling in C, making use of the PCG library <cite class="ltx_cite ltx_citemacro_citep">(O’Neill, <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib22" title="">2014</a>)</cite> for random number generation.
Our code is available in the supplementary material and we will make both the DEF and NRGBoost methods available in an open-source library.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="A4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.3 </span>Hyperparameter Tuning</h3>
<section class="ltx_subsubsection" id="A4.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">D.3.1 </span>XGBoost</h4>
<div class="ltx_para ltx_noindent" id="A4.SS3.SSS1.p1">
<p class="ltx_p" id="A4.SS3.SSS1.p1.1">To tune the hyperparameters of XGBoost we use 100 trials of random search with the search space defined in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A4.T8" title="Table 8 ‣ D.3.1 XGBoost ‣ D.3 Hyperparameter Tuning ‣ Appendix D Reproducibility ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">8</span></a>.</p>
</div>
<figure class="ltx_table" id="A4.T8">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 8: </span>XGBoost hyperparameter tuning search space. <math alttext="\delta(0)" class="ltx_Math" display="inline" id="A4.T8.2.m1.1"><semantics id="A4.T8.2.m1.1b"><mrow id="A4.T8.2.m1.1.2" xref="A4.T8.2.m1.1.2.cmml"><mi id="A4.T8.2.m1.1.2.2" xref="A4.T8.2.m1.1.2.2.cmml">δ</mi><mo id="A4.T8.2.m1.1.2.1" xref="A4.T8.2.m1.1.2.1.cmml">⁢</mo><mrow id="A4.T8.2.m1.1.2.3.2" xref="A4.T8.2.m1.1.2.cmml"><mo id="A4.T8.2.m1.1.2.3.2.1" stretchy="false" xref="A4.T8.2.m1.1.2.cmml">(</mo><mn id="A4.T8.2.m1.1.1" xref="A4.T8.2.m1.1.1.cmml">0</mn><mo id="A4.T8.2.m1.1.2.3.2.2" stretchy="false" xref="A4.T8.2.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.T8.2.m1.1c"><apply id="A4.T8.2.m1.1.2.cmml" xref="A4.T8.2.m1.1.2"><times id="A4.T8.2.m1.1.2.1.cmml" xref="A4.T8.2.m1.1.2.1"></times><ci id="A4.T8.2.m1.1.2.2.cmml" xref="A4.T8.2.m1.1.2.2">𝛿</ci><cn id="A4.T8.2.m1.1.1.cmml" type="integer" xref="A4.T8.2.m1.1.1">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T8.2.m1.1d">\delta(0)</annotation><annotation encoding="application/x-llamapun" id="A4.T8.2.m1.1e">italic_δ ( 0 )</annotation></semantics></math> denotes a point mass distribution at 0.</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="A4.T8.7">
<tr class="ltx_tr" id="A4.T8.7.6">
<td class="ltx_td ltx_align_left ltx_border_tt" id="A4.T8.7.6.1" style="padding-top:1.25pt;padding-bottom:1.25pt;">Parameter</td>
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_tt" id="A4.T8.7.6.2" style="padding-top:1.25pt;padding-bottom:1.25pt;">Distribution or Value</td>
</tr>
<tr class="ltx_tr" id="A4.T8.3.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="A4.T8.3.1.2" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span class="ltx_text ltx_font_typewriter" id="A4.T8.3.1.2.1">learning_rate</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t" id="A4.T8.3.1.1" style="padding-top:1.25pt;padding-bottom:1.25pt;"><math alttext="\textrm{LogUniform}\left(\left[10^{-3},1.0\right]\right)" class="ltx_Math" display="inline" id="A4.T8.3.1.1.m1.2"><semantics id="A4.T8.3.1.1.m1.2a"><mrow id="A4.T8.3.1.1.m1.2.2" xref="A4.T8.3.1.1.m1.2.2.cmml"><mtext id="A4.T8.3.1.1.m1.2.2.3" xref="A4.T8.3.1.1.m1.2.2.3a.cmml">LogUniform</mtext><mo id="A4.T8.3.1.1.m1.2.2.2" xref="A4.T8.3.1.1.m1.2.2.2.cmml">⁢</mo><mrow id="A4.T8.3.1.1.m1.2.2.1.1" xref="A4.T8.3.1.1.m1.2.2.cmml"><mo id="A4.T8.3.1.1.m1.2.2.1.1.2" xref="A4.T8.3.1.1.m1.2.2.cmml">(</mo><mrow id="A4.T8.3.1.1.m1.2.2.1.1.1.1" xref="A4.T8.3.1.1.m1.2.2.1.1.1.2.cmml"><mo id="A4.T8.3.1.1.m1.2.2.1.1.1.1.2" xref="A4.T8.3.1.1.m1.2.2.1.1.1.2.cmml">[</mo><msup id="A4.T8.3.1.1.m1.2.2.1.1.1.1.1" xref="A4.T8.3.1.1.m1.2.2.1.1.1.1.1.cmml"><mn id="A4.T8.3.1.1.m1.2.2.1.1.1.1.1.2" xref="A4.T8.3.1.1.m1.2.2.1.1.1.1.1.2.cmml">10</mn><mrow id="A4.T8.3.1.1.m1.2.2.1.1.1.1.1.3" xref="A4.T8.3.1.1.m1.2.2.1.1.1.1.1.3.cmml"><mo id="A4.T8.3.1.1.m1.2.2.1.1.1.1.1.3a" xref="A4.T8.3.1.1.m1.2.2.1.1.1.1.1.3.cmml">−</mo><mn id="A4.T8.3.1.1.m1.2.2.1.1.1.1.1.3.2" xref="A4.T8.3.1.1.m1.2.2.1.1.1.1.1.3.2.cmml">3</mn></mrow></msup><mo id="A4.T8.3.1.1.m1.2.2.1.1.1.1.3" xref="A4.T8.3.1.1.m1.2.2.1.1.1.2.cmml">,</mo><mn id="A4.T8.3.1.1.m1.1.1" xref="A4.T8.3.1.1.m1.1.1.cmml">1.0</mn><mo id="A4.T8.3.1.1.m1.2.2.1.1.1.1.4" xref="A4.T8.3.1.1.m1.2.2.1.1.1.2.cmml">]</mo></mrow><mo id="A4.T8.3.1.1.m1.2.2.1.1.3" xref="A4.T8.3.1.1.m1.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.T8.3.1.1.m1.2b"><apply id="A4.T8.3.1.1.m1.2.2.cmml" xref="A4.T8.3.1.1.m1.2.2"><times id="A4.T8.3.1.1.m1.2.2.2.cmml" xref="A4.T8.3.1.1.m1.2.2.2"></times><ci id="A4.T8.3.1.1.m1.2.2.3a.cmml" xref="A4.T8.3.1.1.m1.2.2.3"><mtext id="A4.T8.3.1.1.m1.2.2.3.cmml" xref="A4.T8.3.1.1.m1.2.2.3">LogUniform</mtext></ci><interval closure="closed" id="A4.T8.3.1.1.m1.2.2.1.1.1.2.cmml" xref="A4.T8.3.1.1.m1.2.2.1.1.1.1"><apply id="A4.T8.3.1.1.m1.2.2.1.1.1.1.1.cmml" xref="A4.T8.3.1.1.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.T8.3.1.1.m1.2.2.1.1.1.1.1.1.cmml" xref="A4.T8.3.1.1.m1.2.2.1.1.1.1.1">superscript</csymbol><cn id="A4.T8.3.1.1.m1.2.2.1.1.1.1.1.2.cmml" type="integer" xref="A4.T8.3.1.1.m1.2.2.1.1.1.1.1.2">10</cn><apply id="A4.T8.3.1.1.m1.2.2.1.1.1.1.1.3.cmml" xref="A4.T8.3.1.1.m1.2.2.1.1.1.1.1.3"><minus id="A4.T8.3.1.1.m1.2.2.1.1.1.1.1.3.1.cmml" xref="A4.T8.3.1.1.m1.2.2.1.1.1.1.1.3"></minus><cn id="A4.T8.3.1.1.m1.2.2.1.1.1.1.1.3.2.cmml" type="integer" xref="A4.T8.3.1.1.m1.2.2.1.1.1.1.1.3.2">3</cn></apply></apply><cn id="A4.T8.3.1.1.m1.1.1.cmml" type="float" xref="A4.T8.3.1.1.m1.1.1">1.0</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T8.3.1.1.m1.2c">\textrm{LogUniform}\left(\left[10^{-3},1.0\right]\right)</annotation><annotation encoding="application/x-llamapun" id="A4.T8.3.1.1.m1.2d">LogUniform ( [ 10 start_POSTSUPERSCRIPT - 3 end_POSTSUPERSCRIPT , 1.0 ] )</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A4.T8.4.2">
<td class="ltx_td ltx_align_left" id="A4.T8.4.2.2" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span class="ltx_text ltx_font_typewriter" id="A4.T8.4.2.2.1">max_leaves</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A4.T8.4.2.1" style="padding-top:1.25pt;padding-bottom:1.25pt;"><math alttext="\textrm{Uniform}\left(\left\{16,32,64,128,256,512,1024\right\}\right)" class="ltx_Math" display="inline" id="A4.T8.4.2.1.m1.8"><semantics id="A4.T8.4.2.1.m1.8a"><mrow id="A4.T8.4.2.1.m1.8.8" xref="A4.T8.4.2.1.m1.8.8.cmml"><mtext id="A4.T8.4.2.1.m1.8.8.3" xref="A4.T8.4.2.1.m1.8.8.3a.cmml">Uniform</mtext><mo id="A4.T8.4.2.1.m1.8.8.2" xref="A4.T8.4.2.1.m1.8.8.2.cmml">⁢</mo><mrow id="A4.T8.4.2.1.m1.8.8.1.1" xref="A4.T8.4.2.1.m1.8.8.cmml"><mo id="A4.T8.4.2.1.m1.8.8.1.1.2" xref="A4.T8.4.2.1.m1.8.8.cmml">(</mo><mrow id="A4.T8.4.2.1.m1.8.8.1.1.1.2" xref="A4.T8.4.2.1.m1.8.8.1.1.1.1.cmml"><mo id="A4.T8.4.2.1.m1.8.8.1.1.1.2.1" xref="A4.T8.4.2.1.m1.8.8.1.1.1.1.cmml">{</mo><mn id="A4.T8.4.2.1.m1.1.1" xref="A4.T8.4.2.1.m1.1.1.cmml">16</mn><mo id="A4.T8.4.2.1.m1.8.8.1.1.1.2.2" xref="A4.T8.4.2.1.m1.8.8.1.1.1.1.cmml">,</mo><mn id="A4.T8.4.2.1.m1.2.2" xref="A4.T8.4.2.1.m1.2.2.cmml">32</mn><mo id="A4.T8.4.2.1.m1.8.8.1.1.1.2.3" xref="A4.T8.4.2.1.m1.8.8.1.1.1.1.cmml">,</mo><mn id="A4.T8.4.2.1.m1.3.3" xref="A4.T8.4.2.1.m1.3.3.cmml">64</mn><mo id="A4.T8.4.2.1.m1.8.8.1.1.1.2.4" xref="A4.T8.4.2.1.m1.8.8.1.1.1.1.cmml">,</mo><mn id="A4.T8.4.2.1.m1.4.4" xref="A4.T8.4.2.1.m1.4.4.cmml">128</mn><mo id="A4.T8.4.2.1.m1.8.8.1.1.1.2.5" xref="A4.T8.4.2.1.m1.8.8.1.1.1.1.cmml">,</mo><mn id="A4.T8.4.2.1.m1.5.5" xref="A4.T8.4.2.1.m1.5.5.cmml">256</mn><mo id="A4.T8.4.2.1.m1.8.8.1.1.1.2.6" xref="A4.T8.4.2.1.m1.8.8.1.1.1.1.cmml">,</mo><mn id="A4.T8.4.2.1.m1.6.6" xref="A4.T8.4.2.1.m1.6.6.cmml">512</mn><mo id="A4.T8.4.2.1.m1.8.8.1.1.1.2.7" xref="A4.T8.4.2.1.m1.8.8.1.1.1.1.cmml">,</mo><mn id="A4.T8.4.2.1.m1.7.7" xref="A4.T8.4.2.1.m1.7.7.cmml">1024</mn><mo id="A4.T8.4.2.1.m1.8.8.1.1.1.2.8" xref="A4.T8.4.2.1.m1.8.8.1.1.1.1.cmml">}</mo></mrow><mo id="A4.T8.4.2.1.m1.8.8.1.1.3" xref="A4.T8.4.2.1.m1.8.8.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.T8.4.2.1.m1.8b"><apply id="A4.T8.4.2.1.m1.8.8.cmml" xref="A4.T8.4.2.1.m1.8.8"><times id="A4.T8.4.2.1.m1.8.8.2.cmml" xref="A4.T8.4.2.1.m1.8.8.2"></times><ci id="A4.T8.4.2.1.m1.8.8.3a.cmml" xref="A4.T8.4.2.1.m1.8.8.3"><mtext id="A4.T8.4.2.1.m1.8.8.3.cmml" xref="A4.T8.4.2.1.m1.8.8.3">Uniform</mtext></ci><set id="A4.T8.4.2.1.m1.8.8.1.1.1.1.cmml" xref="A4.T8.4.2.1.m1.8.8.1.1.1.2"><cn id="A4.T8.4.2.1.m1.1.1.cmml" type="integer" xref="A4.T8.4.2.1.m1.1.1">16</cn><cn id="A4.T8.4.2.1.m1.2.2.cmml" type="integer" xref="A4.T8.4.2.1.m1.2.2">32</cn><cn id="A4.T8.4.2.1.m1.3.3.cmml" type="integer" xref="A4.T8.4.2.1.m1.3.3">64</cn><cn id="A4.T8.4.2.1.m1.4.4.cmml" type="integer" xref="A4.T8.4.2.1.m1.4.4">128</cn><cn id="A4.T8.4.2.1.m1.5.5.cmml" type="integer" xref="A4.T8.4.2.1.m1.5.5">256</cn><cn id="A4.T8.4.2.1.m1.6.6.cmml" type="integer" xref="A4.T8.4.2.1.m1.6.6">512</cn><cn id="A4.T8.4.2.1.m1.7.7.cmml" type="integer" xref="A4.T8.4.2.1.m1.7.7">1024</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T8.4.2.1.m1.8c">\textrm{Uniform}\left(\left\{16,32,64,128,256,512,1024\right\}\right)</annotation><annotation encoding="application/x-llamapun" id="A4.T8.4.2.1.m1.8d">Uniform ( { 16 , 32 , 64 , 128 , 256 , 512 , 1024 } )</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A4.T8.5.3">
<td class="ltx_td ltx_align_left" id="A4.T8.5.3.2" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span class="ltx_text ltx_font_typewriter" id="A4.T8.5.3.2.1">min_child_weight</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A4.T8.5.3.1" style="padding-top:1.25pt;padding-bottom:1.25pt;"><math alttext="\textrm{LogUniform}\left(\left[10^{-1},10^{3}\right]\right)" class="ltx_Math" display="inline" id="A4.T8.5.3.1.m1.1"><semantics id="A4.T8.5.3.1.m1.1a"><mrow id="A4.T8.5.3.1.m1.1.1" xref="A4.T8.5.3.1.m1.1.1.cmml"><mtext id="A4.T8.5.3.1.m1.1.1.3" xref="A4.T8.5.3.1.m1.1.1.3a.cmml">LogUniform</mtext><mo id="A4.T8.5.3.1.m1.1.1.2" xref="A4.T8.5.3.1.m1.1.1.2.cmml">⁢</mo><mrow id="A4.T8.5.3.1.m1.1.1.1.1" xref="A4.T8.5.3.1.m1.1.1.cmml"><mo id="A4.T8.5.3.1.m1.1.1.1.1.2" xref="A4.T8.5.3.1.m1.1.1.cmml">(</mo><mrow id="A4.T8.5.3.1.m1.1.1.1.1.1.2" xref="A4.T8.5.3.1.m1.1.1.1.1.1.3.cmml"><mo id="A4.T8.5.3.1.m1.1.1.1.1.1.2.3" xref="A4.T8.5.3.1.m1.1.1.1.1.1.3.cmml">[</mo><msup id="A4.T8.5.3.1.m1.1.1.1.1.1.1.1" xref="A4.T8.5.3.1.m1.1.1.1.1.1.1.1.cmml"><mn id="A4.T8.5.3.1.m1.1.1.1.1.1.1.1.2" xref="A4.T8.5.3.1.m1.1.1.1.1.1.1.1.2.cmml">10</mn><mrow id="A4.T8.5.3.1.m1.1.1.1.1.1.1.1.3" xref="A4.T8.5.3.1.m1.1.1.1.1.1.1.1.3.cmml"><mo id="A4.T8.5.3.1.m1.1.1.1.1.1.1.1.3a" xref="A4.T8.5.3.1.m1.1.1.1.1.1.1.1.3.cmml">−</mo><mn id="A4.T8.5.3.1.m1.1.1.1.1.1.1.1.3.2" xref="A4.T8.5.3.1.m1.1.1.1.1.1.1.1.3.2.cmml">1</mn></mrow></msup><mo id="A4.T8.5.3.1.m1.1.1.1.1.1.2.4" xref="A4.T8.5.3.1.m1.1.1.1.1.1.3.cmml">,</mo><msup id="A4.T8.5.3.1.m1.1.1.1.1.1.2.2" xref="A4.T8.5.3.1.m1.1.1.1.1.1.2.2.cmml"><mn id="A4.T8.5.3.1.m1.1.1.1.1.1.2.2.2" xref="A4.T8.5.3.1.m1.1.1.1.1.1.2.2.2.cmml">10</mn><mn id="A4.T8.5.3.1.m1.1.1.1.1.1.2.2.3" xref="A4.T8.5.3.1.m1.1.1.1.1.1.2.2.3.cmml">3</mn></msup><mo id="A4.T8.5.3.1.m1.1.1.1.1.1.2.5" xref="A4.T8.5.3.1.m1.1.1.1.1.1.3.cmml">]</mo></mrow><mo id="A4.T8.5.3.1.m1.1.1.1.1.3" xref="A4.T8.5.3.1.m1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.T8.5.3.1.m1.1b"><apply id="A4.T8.5.3.1.m1.1.1.cmml" xref="A4.T8.5.3.1.m1.1.1"><times id="A4.T8.5.3.1.m1.1.1.2.cmml" xref="A4.T8.5.3.1.m1.1.1.2"></times><ci id="A4.T8.5.3.1.m1.1.1.3a.cmml" xref="A4.T8.5.3.1.m1.1.1.3"><mtext id="A4.T8.5.3.1.m1.1.1.3.cmml" xref="A4.T8.5.3.1.m1.1.1.3">LogUniform</mtext></ci><interval closure="closed" id="A4.T8.5.3.1.m1.1.1.1.1.1.3.cmml" xref="A4.T8.5.3.1.m1.1.1.1.1.1.2"><apply id="A4.T8.5.3.1.m1.1.1.1.1.1.1.1.cmml" xref="A4.T8.5.3.1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.T8.5.3.1.m1.1.1.1.1.1.1.1.1.cmml" xref="A4.T8.5.3.1.m1.1.1.1.1.1.1.1">superscript</csymbol><cn id="A4.T8.5.3.1.m1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="A4.T8.5.3.1.m1.1.1.1.1.1.1.1.2">10</cn><apply id="A4.T8.5.3.1.m1.1.1.1.1.1.1.1.3.cmml" xref="A4.T8.5.3.1.m1.1.1.1.1.1.1.1.3"><minus id="A4.T8.5.3.1.m1.1.1.1.1.1.1.1.3.1.cmml" xref="A4.T8.5.3.1.m1.1.1.1.1.1.1.1.3"></minus><cn id="A4.T8.5.3.1.m1.1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="A4.T8.5.3.1.m1.1.1.1.1.1.1.1.3.2">1</cn></apply></apply><apply id="A4.T8.5.3.1.m1.1.1.1.1.1.2.2.cmml" xref="A4.T8.5.3.1.m1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A4.T8.5.3.1.m1.1.1.1.1.1.2.2.1.cmml" xref="A4.T8.5.3.1.m1.1.1.1.1.1.2.2">superscript</csymbol><cn id="A4.T8.5.3.1.m1.1.1.1.1.1.2.2.2.cmml" type="integer" xref="A4.T8.5.3.1.m1.1.1.1.1.1.2.2.2">10</cn><cn id="A4.T8.5.3.1.m1.1.1.1.1.1.2.2.3.cmml" type="integer" xref="A4.T8.5.3.1.m1.1.1.1.1.1.2.2.3">3</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T8.5.3.1.m1.1c">\textrm{LogUniform}\left(\left[10^{-1},10^{3}\right]\right)</annotation><annotation encoding="application/x-llamapun" id="A4.T8.5.3.1.m1.1d">LogUniform ( [ 10 start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT , 10 start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT ] )</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A4.T8.6.4">
<td class="ltx_td ltx_align_left" id="A4.T8.6.4.2" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span class="ltx_text ltx_font_typewriter" id="A4.T8.6.4.2.1">reg_lambda</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A4.T8.6.4.1" style="padding-top:1.25pt;padding-bottom:1.25pt;"><math alttext="0.5\cdot\delta(0)+0.5\cdot\textrm{LogUniform}\left(\left[10^{-3},10\right]\right)" class="ltx_Math" display="inline" id="A4.T8.6.4.1.m1.3"><semantics id="A4.T8.6.4.1.m1.3a"><mrow id="A4.T8.6.4.1.m1.3.3" xref="A4.T8.6.4.1.m1.3.3.cmml"><mrow id="A4.T8.6.4.1.m1.3.3.3" xref="A4.T8.6.4.1.m1.3.3.3.cmml"><mrow id="A4.T8.6.4.1.m1.3.3.3.2" xref="A4.T8.6.4.1.m1.3.3.3.2.cmml"><mn id="A4.T8.6.4.1.m1.3.3.3.2.2" xref="A4.T8.6.4.1.m1.3.3.3.2.2.cmml">0.5</mn><mo id="A4.T8.6.4.1.m1.3.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="A4.T8.6.4.1.m1.3.3.3.2.1.cmml">⋅</mo><mi id="A4.T8.6.4.1.m1.3.3.3.2.3" xref="A4.T8.6.4.1.m1.3.3.3.2.3.cmml">δ</mi></mrow><mo id="A4.T8.6.4.1.m1.3.3.3.1" xref="A4.T8.6.4.1.m1.3.3.3.1.cmml">⁢</mo><mrow id="A4.T8.6.4.1.m1.3.3.3.3.2" xref="A4.T8.6.4.1.m1.3.3.3.cmml"><mo id="A4.T8.6.4.1.m1.3.3.3.3.2.1" stretchy="false" xref="A4.T8.6.4.1.m1.3.3.3.cmml">(</mo><mn id="A4.T8.6.4.1.m1.1.1" xref="A4.T8.6.4.1.m1.1.1.cmml">0</mn><mo id="A4.T8.6.4.1.m1.3.3.3.3.2.2" stretchy="false" xref="A4.T8.6.4.1.m1.3.3.3.cmml">)</mo></mrow></mrow><mo id="A4.T8.6.4.1.m1.3.3.2" xref="A4.T8.6.4.1.m1.3.3.2.cmml">+</mo><mrow id="A4.T8.6.4.1.m1.3.3.1" xref="A4.T8.6.4.1.m1.3.3.1.cmml"><mrow id="A4.T8.6.4.1.m1.3.3.1.3" xref="A4.T8.6.4.1.m1.3.3.1.3.cmml"><mn id="A4.T8.6.4.1.m1.3.3.1.3.2" xref="A4.T8.6.4.1.m1.3.3.1.3.2.cmml">0.5</mn><mo id="A4.T8.6.4.1.m1.3.3.1.3.1" lspace="0.222em" rspace="0.222em" xref="A4.T8.6.4.1.m1.3.3.1.3.1.cmml">⋅</mo><mtext id="A4.T8.6.4.1.m1.3.3.1.3.3" xref="A4.T8.6.4.1.m1.3.3.1.3.3a.cmml">LogUniform</mtext></mrow><mo id="A4.T8.6.4.1.m1.3.3.1.2" xref="A4.T8.6.4.1.m1.3.3.1.2.cmml">⁢</mo><mrow id="A4.T8.6.4.1.m1.3.3.1.1.1" xref="A4.T8.6.4.1.m1.3.3.1.cmml"><mo id="A4.T8.6.4.1.m1.3.3.1.1.1.2" xref="A4.T8.6.4.1.m1.3.3.1.cmml">(</mo><mrow id="A4.T8.6.4.1.m1.3.3.1.1.1.1.1" xref="A4.T8.6.4.1.m1.3.3.1.1.1.1.2.cmml"><mo id="A4.T8.6.4.1.m1.3.3.1.1.1.1.1.2" xref="A4.T8.6.4.1.m1.3.3.1.1.1.1.2.cmml">[</mo><msup id="A4.T8.6.4.1.m1.3.3.1.1.1.1.1.1" xref="A4.T8.6.4.1.m1.3.3.1.1.1.1.1.1.cmml"><mn id="A4.T8.6.4.1.m1.3.3.1.1.1.1.1.1.2" xref="A4.T8.6.4.1.m1.3.3.1.1.1.1.1.1.2.cmml">10</mn><mrow id="A4.T8.6.4.1.m1.3.3.1.1.1.1.1.1.3" xref="A4.T8.6.4.1.m1.3.3.1.1.1.1.1.1.3.cmml"><mo id="A4.T8.6.4.1.m1.3.3.1.1.1.1.1.1.3a" xref="A4.T8.6.4.1.m1.3.3.1.1.1.1.1.1.3.cmml">−</mo><mn id="A4.T8.6.4.1.m1.3.3.1.1.1.1.1.1.3.2" xref="A4.T8.6.4.1.m1.3.3.1.1.1.1.1.1.3.2.cmml">3</mn></mrow></msup><mo id="A4.T8.6.4.1.m1.3.3.1.1.1.1.1.3" xref="A4.T8.6.4.1.m1.3.3.1.1.1.1.2.cmml">,</mo><mn id="A4.T8.6.4.1.m1.2.2" xref="A4.T8.6.4.1.m1.2.2.cmml">10</mn><mo id="A4.T8.6.4.1.m1.3.3.1.1.1.1.1.4" xref="A4.T8.6.4.1.m1.3.3.1.1.1.1.2.cmml">]</mo></mrow><mo id="A4.T8.6.4.1.m1.3.3.1.1.1.3" xref="A4.T8.6.4.1.m1.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.T8.6.4.1.m1.3b"><apply id="A4.T8.6.4.1.m1.3.3.cmml" xref="A4.T8.6.4.1.m1.3.3"><plus id="A4.T8.6.4.1.m1.3.3.2.cmml" xref="A4.T8.6.4.1.m1.3.3.2"></plus><apply id="A4.T8.6.4.1.m1.3.3.3.cmml" xref="A4.T8.6.4.1.m1.3.3.3"><times id="A4.T8.6.4.1.m1.3.3.3.1.cmml" xref="A4.T8.6.4.1.m1.3.3.3.1"></times><apply id="A4.T8.6.4.1.m1.3.3.3.2.cmml" xref="A4.T8.6.4.1.m1.3.3.3.2"><ci id="A4.T8.6.4.1.m1.3.3.3.2.1.cmml" xref="A4.T8.6.4.1.m1.3.3.3.2.1">⋅</ci><cn id="A4.T8.6.4.1.m1.3.3.3.2.2.cmml" type="float" xref="A4.T8.6.4.1.m1.3.3.3.2.2">0.5</cn><ci id="A4.T8.6.4.1.m1.3.3.3.2.3.cmml" xref="A4.T8.6.4.1.m1.3.3.3.2.3">𝛿</ci></apply><cn id="A4.T8.6.4.1.m1.1.1.cmml" type="integer" xref="A4.T8.6.4.1.m1.1.1">0</cn></apply><apply id="A4.T8.6.4.1.m1.3.3.1.cmml" xref="A4.T8.6.4.1.m1.3.3.1"><times id="A4.T8.6.4.1.m1.3.3.1.2.cmml" xref="A4.T8.6.4.1.m1.3.3.1.2"></times><apply id="A4.T8.6.4.1.m1.3.3.1.3.cmml" xref="A4.T8.6.4.1.m1.3.3.1.3"><ci id="A4.T8.6.4.1.m1.3.3.1.3.1.cmml" xref="A4.T8.6.4.1.m1.3.3.1.3.1">⋅</ci><cn id="A4.T8.6.4.1.m1.3.3.1.3.2.cmml" type="float" xref="A4.T8.6.4.1.m1.3.3.1.3.2">0.5</cn><ci id="A4.T8.6.4.1.m1.3.3.1.3.3a.cmml" xref="A4.T8.6.4.1.m1.3.3.1.3.3"><mtext id="A4.T8.6.4.1.m1.3.3.1.3.3.cmml" xref="A4.T8.6.4.1.m1.3.3.1.3.3">LogUniform</mtext></ci></apply><interval closure="closed" id="A4.T8.6.4.1.m1.3.3.1.1.1.1.2.cmml" xref="A4.T8.6.4.1.m1.3.3.1.1.1.1.1"><apply id="A4.T8.6.4.1.m1.3.3.1.1.1.1.1.1.cmml" xref="A4.T8.6.4.1.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.T8.6.4.1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="A4.T8.6.4.1.m1.3.3.1.1.1.1.1.1">superscript</csymbol><cn id="A4.T8.6.4.1.m1.3.3.1.1.1.1.1.1.2.cmml" type="integer" xref="A4.T8.6.4.1.m1.3.3.1.1.1.1.1.1.2">10</cn><apply id="A4.T8.6.4.1.m1.3.3.1.1.1.1.1.1.3.cmml" xref="A4.T8.6.4.1.m1.3.3.1.1.1.1.1.1.3"><minus id="A4.T8.6.4.1.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="A4.T8.6.4.1.m1.3.3.1.1.1.1.1.1.3"></minus><cn id="A4.T8.6.4.1.m1.3.3.1.1.1.1.1.1.3.2.cmml" type="integer" xref="A4.T8.6.4.1.m1.3.3.1.1.1.1.1.1.3.2">3</cn></apply></apply><cn id="A4.T8.6.4.1.m1.2.2.cmml" type="integer" xref="A4.T8.6.4.1.m1.2.2">10</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T8.6.4.1.m1.3c">0.5\cdot\delta(0)+0.5\cdot\textrm{LogUniform}\left(\left[10^{-3},10\right]\right)</annotation><annotation encoding="application/x-llamapun" id="A4.T8.6.4.1.m1.3d">0.5 ⋅ italic_δ ( 0 ) + 0.5 ⋅ LogUniform ( [ 10 start_POSTSUPERSCRIPT - 3 end_POSTSUPERSCRIPT , 10 ] )</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A4.T8.7.5">
<td class="ltx_td ltx_align_left" id="A4.T8.7.5.2" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span class="ltx_text ltx_font_typewriter" id="A4.T8.7.5.2.1">reg_alpha</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A4.T8.7.5.1" style="padding-top:1.25pt;padding-bottom:1.25pt;"><math alttext="0.5\cdot\delta(0)+0.5\cdot\textrm{LogUniform}\left(\left[10^{-3},10\right]\right)" class="ltx_Math" display="inline" id="A4.T8.7.5.1.m1.3"><semantics id="A4.T8.7.5.1.m1.3a"><mrow id="A4.T8.7.5.1.m1.3.3" xref="A4.T8.7.5.1.m1.3.3.cmml"><mrow id="A4.T8.7.5.1.m1.3.3.3" xref="A4.T8.7.5.1.m1.3.3.3.cmml"><mrow id="A4.T8.7.5.1.m1.3.3.3.2" xref="A4.T8.7.5.1.m1.3.3.3.2.cmml"><mn id="A4.T8.7.5.1.m1.3.3.3.2.2" xref="A4.T8.7.5.1.m1.3.3.3.2.2.cmml">0.5</mn><mo id="A4.T8.7.5.1.m1.3.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="A4.T8.7.5.1.m1.3.3.3.2.1.cmml">⋅</mo><mi id="A4.T8.7.5.1.m1.3.3.3.2.3" xref="A4.T8.7.5.1.m1.3.3.3.2.3.cmml">δ</mi></mrow><mo id="A4.T8.7.5.1.m1.3.3.3.1" xref="A4.T8.7.5.1.m1.3.3.3.1.cmml">⁢</mo><mrow id="A4.T8.7.5.1.m1.3.3.3.3.2" xref="A4.T8.7.5.1.m1.3.3.3.cmml"><mo id="A4.T8.7.5.1.m1.3.3.3.3.2.1" stretchy="false" xref="A4.T8.7.5.1.m1.3.3.3.cmml">(</mo><mn id="A4.T8.7.5.1.m1.1.1" xref="A4.T8.7.5.1.m1.1.1.cmml">0</mn><mo id="A4.T8.7.5.1.m1.3.3.3.3.2.2" stretchy="false" xref="A4.T8.7.5.1.m1.3.3.3.cmml">)</mo></mrow></mrow><mo id="A4.T8.7.5.1.m1.3.3.2" xref="A4.T8.7.5.1.m1.3.3.2.cmml">+</mo><mrow id="A4.T8.7.5.1.m1.3.3.1" xref="A4.T8.7.5.1.m1.3.3.1.cmml"><mrow id="A4.T8.7.5.1.m1.3.3.1.3" xref="A4.T8.7.5.1.m1.3.3.1.3.cmml"><mn id="A4.T8.7.5.1.m1.3.3.1.3.2" xref="A4.T8.7.5.1.m1.3.3.1.3.2.cmml">0.5</mn><mo id="A4.T8.7.5.1.m1.3.3.1.3.1" lspace="0.222em" rspace="0.222em" xref="A4.T8.7.5.1.m1.3.3.1.3.1.cmml">⋅</mo><mtext id="A4.T8.7.5.1.m1.3.3.1.3.3" xref="A4.T8.7.5.1.m1.3.3.1.3.3a.cmml">LogUniform</mtext></mrow><mo id="A4.T8.7.5.1.m1.3.3.1.2" xref="A4.T8.7.5.1.m1.3.3.1.2.cmml">⁢</mo><mrow id="A4.T8.7.5.1.m1.3.3.1.1.1" xref="A4.T8.7.5.1.m1.3.3.1.cmml"><mo id="A4.T8.7.5.1.m1.3.3.1.1.1.2" xref="A4.T8.7.5.1.m1.3.3.1.cmml">(</mo><mrow id="A4.T8.7.5.1.m1.3.3.1.1.1.1.1" xref="A4.T8.7.5.1.m1.3.3.1.1.1.1.2.cmml"><mo id="A4.T8.7.5.1.m1.3.3.1.1.1.1.1.2" xref="A4.T8.7.5.1.m1.3.3.1.1.1.1.2.cmml">[</mo><msup id="A4.T8.7.5.1.m1.3.3.1.1.1.1.1.1" xref="A4.T8.7.5.1.m1.3.3.1.1.1.1.1.1.cmml"><mn id="A4.T8.7.5.1.m1.3.3.1.1.1.1.1.1.2" xref="A4.T8.7.5.1.m1.3.3.1.1.1.1.1.1.2.cmml">10</mn><mrow id="A4.T8.7.5.1.m1.3.3.1.1.1.1.1.1.3" xref="A4.T8.7.5.1.m1.3.3.1.1.1.1.1.1.3.cmml"><mo id="A4.T8.7.5.1.m1.3.3.1.1.1.1.1.1.3a" xref="A4.T8.7.5.1.m1.3.3.1.1.1.1.1.1.3.cmml">−</mo><mn id="A4.T8.7.5.1.m1.3.3.1.1.1.1.1.1.3.2" xref="A4.T8.7.5.1.m1.3.3.1.1.1.1.1.1.3.2.cmml">3</mn></mrow></msup><mo id="A4.T8.7.5.1.m1.3.3.1.1.1.1.1.3" xref="A4.T8.7.5.1.m1.3.3.1.1.1.1.2.cmml">,</mo><mn id="A4.T8.7.5.1.m1.2.2" xref="A4.T8.7.5.1.m1.2.2.cmml">10</mn><mo id="A4.T8.7.5.1.m1.3.3.1.1.1.1.1.4" xref="A4.T8.7.5.1.m1.3.3.1.1.1.1.2.cmml">]</mo></mrow><mo id="A4.T8.7.5.1.m1.3.3.1.1.1.3" xref="A4.T8.7.5.1.m1.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.T8.7.5.1.m1.3b"><apply id="A4.T8.7.5.1.m1.3.3.cmml" xref="A4.T8.7.5.1.m1.3.3"><plus id="A4.T8.7.5.1.m1.3.3.2.cmml" xref="A4.T8.7.5.1.m1.3.3.2"></plus><apply id="A4.T8.7.5.1.m1.3.3.3.cmml" xref="A4.T8.7.5.1.m1.3.3.3"><times id="A4.T8.7.5.1.m1.3.3.3.1.cmml" xref="A4.T8.7.5.1.m1.3.3.3.1"></times><apply id="A4.T8.7.5.1.m1.3.3.3.2.cmml" xref="A4.T8.7.5.1.m1.3.3.3.2"><ci id="A4.T8.7.5.1.m1.3.3.3.2.1.cmml" xref="A4.T8.7.5.1.m1.3.3.3.2.1">⋅</ci><cn id="A4.T8.7.5.1.m1.3.3.3.2.2.cmml" type="float" xref="A4.T8.7.5.1.m1.3.3.3.2.2">0.5</cn><ci id="A4.T8.7.5.1.m1.3.3.3.2.3.cmml" xref="A4.T8.7.5.1.m1.3.3.3.2.3">𝛿</ci></apply><cn id="A4.T8.7.5.1.m1.1.1.cmml" type="integer" xref="A4.T8.7.5.1.m1.1.1">0</cn></apply><apply id="A4.T8.7.5.1.m1.3.3.1.cmml" xref="A4.T8.7.5.1.m1.3.3.1"><times id="A4.T8.7.5.1.m1.3.3.1.2.cmml" xref="A4.T8.7.5.1.m1.3.3.1.2"></times><apply id="A4.T8.7.5.1.m1.3.3.1.3.cmml" xref="A4.T8.7.5.1.m1.3.3.1.3"><ci id="A4.T8.7.5.1.m1.3.3.1.3.1.cmml" xref="A4.T8.7.5.1.m1.3.3.1.3.1">⋅</ci><cn id="A4.T8.7.5.1.m1.3.3.1.3.2.cmml" type="float" xref="A4.T8.7.5.1.m1.3.3.1.3.2">0.5</cn><ci id="A4.T8.7.5.1.m1.3.3.1.3.3a.cmml" xref="A4.T8.7.5.1.m1.3.3.1.3.3"><mtext id="A4.T8.7.5.1.m1.3.3.1.3.3.cmml" xref="A4.T8.7.5.1.m1.3.3.1.3.3">LogUniform</mtext></ci></apply><interval closure="closed" id="A4.T8.7.5.1.m1.3.3.1.1.1.1.2.cmml" xref="A4.T8.7.5.1.m1.3.3.1.1.1.1.1"><apply id="A4.T8.7.5.1.m1.3.3.1.1.1.1.1.1.cmml" xref="A4.T8.7.5.1.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.T8.7.5.1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="A4.T8.7.5.1.m1.3.3.1.1.1.1.1.1">superscript</csymbol><cn id="A4.T8.7.5.1.m1.3.3.1.1.1.1.1.1.2.cmml" type="integer" xref="A4.T8.7.5.1.m1.3.3.1.1.1.1.1.1.2">10</cn><apply id="A4.T8.7.5.1.m1.3.3.1.1.1.1.1.1.3.cmml" xref="A4.T8.7.5.1.m1.3.3.1.1.1.1.1.1.3"><minus id="A4.T8.7.5.1.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="A4.T8.7.5.1.m1.3.3.1.1.1.1.1.1.3"></minus><cn id="A4.T8.7.5.1.m1.3.3.1.1.1.1.1.1.3.2.cmml" type="integer" xref="A4.T8.7.5.1.m1.3.3.1.1.1.1.1.1.3.2">3</cn></apply></apply><cn id="A4.T8.7.5.1.m1.2.2.cmml" type="integer" xref="A4.T8.7.5.1.m1.2.2">10</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T8.7.5.1.m1.3c">0.5\cdot\delta(0)+0.5\cdot\textrm{LogUniform}\left(\left[10^{-3},10\right]\right)</annotation><annotation encoding="application/x-llamapun" id="A4.T8.7.5.1.m1.3d">0.5 ⋅ italic_δ ( 0 ) + 0.5 ⋅ LogUniform ( [ 10 start_POSTSUPERSCRIPT - 3 end_POSTSUPERSCRIPT , 10 ] )</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A4.T8.7.7">
<td class="ltx_td ltx_align_left" id="A4.T8.7.7.1" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span class="ltx_text ltx_font_typewriter" id="A4.T8.7.7.1.1">max_leaves</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A4.T8.7.7.2" style="padding-top:1.25pt;padding-bottom:1.25pt;">0 (we already limit the number of leaves)</td>
</tr>
<tr class="ltx_tr" id="A4.T8.7.8">
<td class="ltx_td ltx_align_left" id="A4.T8.7.8.1" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span class="ltx_text ltx_font_typewriter" id="A4.T8.7.8.1.1">grow_policy</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A4.T8.7.8.2" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span class="ltx_text ltx_font_typewriter" id="A4.T8.7.8.2.1">lossguide</span></td>
</tr>
<tr class="ltx_tr" id="A4.T8.7.9">
<td class="ltx_td ltx_align_left ltx_border_bb" id="A4.T8.7.9.1" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span class="ltx_text ltx_font_typewriter" id="A4.T8.7.9.1.1">tree_method</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb" id="A4.T8.7.9.2" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span class="ltx_text ltx_font_typewriter" id="A4.T8.7.9.2.1">hist</span></td>
</tr>
</table>
</figure>
<div class="ltx_para ltx_noindent" id="A4.SS3.SSS1.p2">
<p class="ltx_p" id="A4.SS3.SSS1.p2.1">Each model was trained for 1000 boosting rounds on regression and binary classification tasks.
For multi-class classification tasks a maximum number of 200 rounds of boosting was used due to the larger size of the datasets and because a separate tree is built at every round for each class.
The best model was selected based on the validation set, together with the boosting round where the best performance was attained. The test metrics reported correspond to the performance of the selected model at that boosting round on the test set.</p>
</div>
</section>
<section class="ltx_subsubsection" id="A4.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">D.3.2 </span>RFDE</h4>
<div class="ltx_para ltx_noindent" id="A4.SS3.SSS2.p1">
<p class="ltx_p" id="A4.SS3.SSS2.p1.1">We implement the RFDE method <cite class="ltx_cite ltx_citemacro_citep">(Wen &amp; Hang, <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib31" title="">2022</a>)</cite> after quantile discretization of the dataset and therefore split at the midpoint of the discretized dimension instead of the original one.
When a leaf support has odd cardinality over the splitting dimension a random choice is made over the two possible splitting values. Finally, the original paper does not mention how to split over categorical domains.
We therefore choose to randomly split the possible categorical values for a leaf evenly as we found that this yielded slightly better results than a random one vs all split.</p>
</div>
<div class="ltx_para ltx_noindent" id="A4.SS3.SSS2.p2">
<p class="ltx_p" id="A4.SS3.SSS2.p2.2">For RFDE models we train a total of 1000 trees. The only hyperparameter that we tune is the maximum number of leaves per tree for which we test the values <math alttext="[2^{6},2^{7},\ldots,2^{14}]" class="ltx_Math" display="inline" id="A4.SS3.SSS2.p2.1.m1.4"><semantics id="A4.SS3.SSS2.p2.1.m1.4a"><mrow id="A4.SS3.SSS2.p2.1.m1.4.4.3" xref="A4.SS3.SSS2.p2.1.m1.4.4.4.cmml"><mo id="A4.SS3.SSS2.p2.1.m1.4.4.3.4" stretchy="false" xref="A4.SS3.SSS2.p2.1.m1.4.4.4.cmml">[</mo><msup id="A4.SS3.SSS2.p2.1.m1.2.2.1.1" xref="A4.SS3.SSS2.p2.1.m1.2.2.1.1.cmml"><mn id="A4.SS3.SSS2.p2.1.m1.2.2.1.1.2" xref="A4.SS3.SSS2.p2.1.m1.2.2.1.1.2.cmml">2</mn><mn id="A4.SS3.SSS2.p2.1.m1.2.2.1.1.3" xref="A4.SS3.SSS2.p2.1.m1.2.2.1.1.3.cmml">6</mn></msup><mo id="A4.SS3.SSS2.p2.1.m1.4.4.3.5" xref="A4.SS3.SSS2.p2.1.m1.4.4.4.cmml">,</mo><msup id="A4.SS3.SSS2.p2.1.m1.3.3.2.2" xref="A4.SS3.SSS2.p2.1.m1.3.3.2.2.cmml"><mn id="A4.SS3.SSS2.p2.1.m1.3.3.2.2.2" xref="A4.SS3.SSS2.p2.1.m1.3.3.2.2.2.cmml">2</mn><mn id="A4.SS3.SSS2.p2.1.m1.3.3.2.2.3" xref="A4.SS3.SSS2.p2.1.m1.3.3.2.2.3.cmml">7</mn></msup><mo id="A4.SS3.SSS2.p2.1.m1.4.4.3.6" xref="A4.SS3.SSS2.p2.1.m1.4.4.4.cmml">,</mo><mi id="A4.SS3.SSS2.p2.1.m1.1.1" mathvariant="normal" xref="A4.SS3.SSS2.p2.1.m1.1.1.cmml">…</mi><mo id="A4.SS3.SSS2.p2.1.m1.4.4.3.7" xref="A4.SS3.SSS2.p2.1.m1.4.4.4.cmml">,</mo><msup id="A4.SS3.SSS2.p2.1.m1.4.4.3.3" xref="A4.SS3.SSS2.p2.1.m1.4.4.3.3.cmml"><mn id="A4.SS3.SSS2.p2.1.m1.4.4.3.3.2" xref="A4.SS3.SSS2.p2.1.m1.4.4.3.3.2.cmml">2</mn><mn id="A4.SS3.SSS2.p2.1.m1.4.4.3.3.3" xref="A4.SS3.SSS2.p2.1.m1.4.4.3.3.3.cmml">14</mn></msup><mo id="A4.SS3.SSS2.p2.1.m1.4.4.3.8" stretchy="false" xref="A4.SS3.SSS2.p2.1.m1.4.4.4.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.SS3.SSS2.p2.1.m1.4b"><list id="A4.SS3.SSS2.p2.1.m1.4.4.4.cmml" xref="A4.SS3.SSS2.p2.1.m1.4.4.3"><apply id="A4.SS3.SSS2.p2.1.m1.2.2.1.1.cmml" xref="A4.SS3.SSS2.p2.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="A4.SS3.SSS2.p2.1.m1.2.2.1.1.1.cmml" xref="A4.SS3.SSS2.p2.1.m1.2.2.1.1">superscript</csymbol><cn id="A4.SS3.SSS2.p2.1.m1.2.2.1.1.2.cmml" type="integer" xref="A4.SS3.SSS2.p2.1.m1.2.2.1.1.2">2</cn><cn id="A4.SS3.SSS2.p2.1.m1.2.2.1.1.3.cmml" type="integer" xref="A4.SS3.SSS2.p2.1.m1.2.2.1.1.3">6</cn></apply><apply id="A4.SS3.SSS2.p2.1.m1.3.3.2.2.cmml" xref="A4.SS3.SSS2.p2.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="A4.SS3.SSS2.p2.1.m1.3.3.2.2.1.cmml" xref="A4.SS3.SSS2.p2.1.m1.3.3.2.2">superscript</csymbol><cn id="A4.SS3.SSS2.p2.1.m1.3.3.2.2.2.cmml" type="integer" xref="A4.SS3.SSS2.p2.1.m1.3.3.2.2.2">2</cn><cn id="A4.SS3.SSS2.p2.1.m1.3.3.2.2.3.cmml" type="integer" xref="A4.SS3.SSS2.p2.1.m1.3.3.2.2.3">7</cn></apply><ci id="A4.SS3.SSS2.p2.1.m1.1.1.cmml" xref="A4.SS3.SSS2.p2.1.m1.1.1">…</ci><apply id="A4.SS3.SSS2.p2.1.m1.4.4.3.3.cmml" xref="A4.SS3.SSS2.p2.1.m1.4.4.3.3"><csymbol cd="ambiguous" id="A4.SS3.SSS2.p2.1.m1.4.4.3.3.1.cmml" xref="A4.SS3.SSS2.p2.1.m1.4.4.3.3">superscript</csymbol><cn id="A4.SS3.SSS2.p2.1.m1.4.4.3.3.2.cmml" type="integer" xref="A4.SS3.SSS2.p2.1.m1.4.4.3.3.2">2</cn><cn id="A4.SS3.SSS2.p2.1.m1.4.4.3.3.3.cmml" type="integer" xref="A4.SS3.SSS2.p2.1.m1.4.4.3.3.3">14</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="A4.SS3.SSS2.p2.1.m1.4c">[2^{6},2^{7},\ldots,2^{14}]</annotation><annotation encoding="application/x-llamapun" id="A4.SS3.SSS2.p2.1.m1.4d">[ 2 start_POSTSUPERSCRIPT 6 end_POSTSUPERSCRIPT , 2 start_POSTSUPERSCRIPT 7 end_POSTSUPERSCRIPT , … , 2 start_POSTSUPERSCRIPT 14 end_POSTSUPERSCRIPT ]</annotation></semantics></math>.
For the Adult dataset, due to limitations of our tree evaluation implementation we only test values up to <math alttext="2^{13}" class="ltx_Math" display="inline" id="A4.SS3.SSS2.p2.2.m2.1"><semantics id="A4.SS3.SSS2.p2.2.m2.1a"><msup id="A4.SS3.SSS2.p2.2.m2.1.1" xref="A4.SS3.SSS2.p2.2.m2.1.1.cmml"><mn id="A4.SS3.SSS2.p2.2.m2.1.1.2" xref="A4.SS3.SSS2.p2.2.m2.1.1.2.cmml">2</mn><mn id="A4.SS3.SSS2.p2.2.m2.1.1.3" xref="A4.SS3.SSS2.p2.2.m2.1.1.3.cmml">13</mn></msup><annotation-xml encoding="MathML-Content" id="A4.SS3.SSS2.p2.2.m2.1b"><apply id="A4.SS3.SSS2.p2.2.m2.1.1.cmml" xref="A4.SS3.SSS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="A4.SS3.SSS2.p2.2.m2.1.1.1.cmml" xref="A4.SS3.SSS2.p2.2.m2.1.1">superscript</csymbol><cn id="A4.SS3.SSS2.p2.2.m2.1.1.2.cmml" type="integer" xref="A4.SS3.SSS2.p2.2.m2.1.1.2">2</cn><cn id="A4.SS3.SSS2.p2.2.m2.1.1.3.cmml" type="integer" xref="A4.SS3.SSS2.p2.2.m2.1.1.3">13</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS3.SSS2.p2.2.m2.1c">2^{13}</annotation><annotation encoding="application/x-llamapun" id="A4.SS3.SSS2.p2.2.m2.1d">2 start_POSTSUPERSCRIPT 13 end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="A4.SS3.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">D.3.3 </span>ARF</h4>
<div class="ltx_para ltx_noindent" id="A4.SS3.SSS3.p1">
<p class="ltx_p" id="A4.SS3.SSS3.p1.1">For ARF we used the official python implementation of the algorithm <cite class="ltx_cite ltx_citemacro_citep">(Blesch &amp; Wright, <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib1" title="">2023</a>)</cite>.
We implement the single variable inference for this method ourselves since the python library does not provide density evaluation.
Due to memory (and time) concerns we train models with a maximum of 100 trees for up to 10 adversarial iterations.
We use a similar grid-search setup to DEF, tuning only the following two parameters:</p>
<ul class="ltx_itemize" id="A4.I2">
<li class="ltx_item" id="A4.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A4.I2.i1.p1">
<p class="ltx_p" id="A4.I2.i1.p1.2">The maximum number of leaves per tree, for which we test the values <math alttext="[2^{6},2^{7},\ldots,2^{12},\infty]" class="ltx_Math" display="inline" id="A4.I2.i1.p1.1.m1.5"><semantics id="A4.I2.i1.p1.1.m1.5a"><mrow id="A4.I2.i1.p1.1.m1.5.5.3" xref="A4.I2.i1.p1.1.m1.5.5.4.cmml"><mo id="A4.I2.i1.p1.1.m1.5.5.3.4" stretchy="false" xref="A4.I2.i1.p1.1.m1.5.5.4.cmml">[</mo><msup id="A4.I2.i1.p1.1.m1.3.3.1.1" xref="A4.I2.i1.p1.1.m1.3.3.1.1.cmml"><mn id="A4.I2.i1.p1.1.m1.3.3.1.1.2" xref="A4.I2.i1.p1.1.m1.3.3.1.1.2.cmml">2</mn><mn id="A4.I2.i1.p1.1.m1.3.3.1.1.3" xref="A4.I2.i1.p1.1.m1.3.3.1.1.3.cmml">6</mn></msup><mo id="A4.I2.i1.p1.1.m1.5.5.3.5" xref="A4.I2.i1.p1.1.m1.5.5.4.cmml">,</mo><msup id="A4.I2.i1.p1.1.m1.4.4.2.2" xref="A4.I2.i1.p1.1.m1.4.4.2.2.cmml"><mn id="A4.I2.i1.p1.1.m1.4.4.2.2.2" xref="A4.I2.i1.p1.1.m1.4.4.2.2.2.cmml">2</mn><mn id="A4.I2.i1.p1.1.m1.4.4.2.2.3" xref="A4.I2.i1.p1.1.m1.4.4.2.2.3.cmml">7</mn></msup><mo id="A4.I2.i1.p1.1.m1.5.5.3.6" xref="A4.I2.i1.p1.1.m1.5.5.4.cmml">,</mo><mi id="A4.I2.i1.p1.1.m1.1.1" mathvariant="normal" xref="A4.I2.i1.p1.1.m1.1.1.cmml">…</mi><mo id="A4.I2.i1.p1.1.m1.5.5.3.7" xref="A4.I2.i1.p1.1.m1.5.5.4.cmml">,</mo><msup id="A4.I2.i1.p1.1.m1.5.5.3.3" xref="A4.I2.i1.p1.1.m1.5.5.3.3.cmml"><mn id="A4.I2.i1.p1.1.m1.5.5.3.3.2" xref="A4.I2.i1.p1.1.m1.5.5.3.3.2.cmml">2</mn><mn id="A4.I2.i1.p1.1.m1.5.5.3.3.3" xref="A4.I2.i1.p1.1.m1.5.5.3.3.3.cmml">12</mn></msup><mo id="A4.I2.i1.p1.1.m1.5.5.3.8" xref="A4.I2.i1.p1.1.m1.5.5.4.cmml">,</mo><mi id="A4.I2.i1.p1.1.m1.2.2" mathvariant="normal" xref="A4.I2.i1.p1.1.m1.2.2.cmml">∞</mi><mo id="A4.I2.i1.p1.1.m1.5.5.3.9" stretchy="false" xref="A4.I2.i1.p1.1.m1.5.5.4.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.I2.i1.p1.1.m1.5b"><list id="A4.I2.i1.p1.1.m1.5.5.4.cmml" xref="A4.I2.i1.p1.1.m1.5.5.3"><apply id="A4.I2.i1.p1.1.m1.3.3.1.1.cmml" xref="A4.I2.i1.p1.1.m1.3.3.1.1"><csymbol cd="ambiguous" id="A4.I2.i1.p1.1.m1.3.3.1.1.1.cmml" xref="A4.I2.i1.p1.1.m1.3.3.1.1">superscript</csymbol><cn id="A4.I2.i1.p1.1.m1.3.3.1.1.2.cmml" type="integer" xref="A4.I2.i1.p1.1.m1.3.3.1.1.2">2</cn><cn id="A4.I2.i1.p1.1.m1.3.3.1.1.3.cmml" type="integer" xref="A4.I2.i1.p1.1.m1.3.3.1.1.3">6</cn></apply><apply id="A4.I2.i1.p1.1.m1.4.4.2.2.cmml" xref="A4.I2.i1.p1.1.m1.4.4.2.2"><csymbol cd="ambiguous" id="A4.I2.i1.p1.1.m1.4.4.2.2.1.cmml" xref="A4.I2.i1.p1.1.m1.4.4.2.2">superscript</csymbol><cn id="A4.I2.i1.p1.1.m1.4.4.2.2.2.cmml" type="integer" xref="A4.I2.i1.p1.1.m1.4.4.2.2.2">2</cn><cn id="A4.I2.i1.p1.1.m1.4.4.2.2.3.cmml" type="integer" xref="A4.I2.i1.p1.1.m1.4.4.2.2.3">7</cn></apply><ci id="A4.I2.i1.p1.1.m1.1.1.cmml" xref="A4.I2.i1.p1.1.m1.1.1">…</ci><apply id="A4.I2.i1.p1.1.m1.5.5.3.3.cmml" xref="A4.I2.i1.p1.1.m1.5.5.3.3"><csymbol cd="ambiguous" id="A4.I2.i1.p1.1.m1.5.5.3.3.1.cmml" xref="A4.I2.i1.p1.1.m1.5.5.3.3">superscript</csymbol><cn id="A4.I2.i1.p1.1.m1.5.5.3.3.2.cmml" type="integer" xref="A4.I2.i1.p1.1.m1.5.5.3.3.2">2</cn><cn id="A4.I2.i1.p1.1.m1.5.5.3.3.3.cmml" type="integer" xref="A4.I2.i1.p1.1.m1.5.5.3.3.3">12</cn></apply><infinity id="A4.I2.i1.p1.1.m1.2.2.cmml" xref="A4.I2.i1.p1.1.m1.2.2"></infinity></list></annotation-xml><annotation encoding="application/x-tex" id="A4.I2.i1.p1.1.m1.5c">[2^{6},2^{7},\ldots,2^{12},\infty]</annotation><annotation encoding="application/x-llamapun" id="A4.I2.i1.p1.1.m1.5d">[ 2 start_POSTSUPERSCRIPT 6 end_POSTSUPERSCRIPT , 2 start_POSTSUPERSCRIPT 7 end_POSTSUPERSCRIPT , … , 2 start_POSTSUPERSCRIPT 12 end_POSTSUPERSCRIPT , ∞ ]</annotation></semantics></math> (<math alttext="\infty" class="ltx_Math" display="inline" id="A4.I2.i1.p1.2.m2.1"><semantics id="A4.I2.i1.p1.2.m2.1a"><mi id="A4.I2.i1.p1.2.m2.1.1" mathvariant="normal" xref="A4.I2.i1.p1.2.m2.1.1.cmml">∞</mi><annotation-xml encoding="MathML-Content" id="A4.I2.i1.p1.2.m2.1b"><infinity id="A4.I2.i1.p1.2.m2.1.1.cmml" xref="A4.I2.i1.p1.2.m2.1.1"></infinity></annotation-xml><annotation encoding="application/x-tex" id="A4.I2.i1.p1.2.m2.1c">\infty</annotation><annotation encoding="application/x-llamapun" id="A4.I2.i1.p1.2.m2.1d">∞</annotation></semantics></math> denotes unconstrained).</p>
</div>
</li>
<li class="ltx_item" id="A4.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="A4.I2.i2.p1">
<p class="ltx_p" id="A4.I2.i2.p1.1">The minimum number of examples falling on each leaf, for which we test the values <math alttext="[3,5,10,30,50,100]" class="ltx_Math" display="inline" id="A4.I2.i2.p1.1.m1.6"><semantics id="A4.I2.i2.p1.1.m1.6a"><mrow id="A4.I2.i2.p1.1.m1.6.7.2" xref="A4.I2.i2.p1.1.m1.6.7.1.cmml"><mo id="A4.I2.i2.p1.1.m1.6.7.2.1" stretchy="false" xref="A4.I2.i2.p1.1.m1.6.7.1.cmml">[</mo><mn id="A4.I2.i2.p1.1.m1.1.1" xref="A4.I2.i2.p1.1.m1.1.1.cmml">3</mn><mo id="A4.I2.i2.p1.1.m1.6.7.2.2" xref="A4.I2.i2.p1.1.m1.6.7.1.cmml">,</mo><mn id="A4.I2.i2.p1.1.m1.2.2" xref="A4.I2.i2.p1.1.m1.2.2.cmml">5</mn><mo id="A4.I2.i2.p1.1.m1.6.7.2.3" xref="A4.I2.i2.p1.1.m1.6.7.1.cmml">,</mo><mn id="A4.I2.i2.p1.1.m1.3.3" xref="A4.I2.i2.p1.1.m1.3.3.cmml">10</mn><mo id="A4.I2.i2.p1.1.m1.6.7.2.4" xref="A4.I2.i2.p1.1.m1.6.7.1.cmml">,</mo><mn id="A4.I2.i2.p1.1.m1.4.4" xref="A4.I2.i2.p1.1.m1.4.4.cmml">30</mn><mo id="A4.I2.i2.p1.1.m1.6.7.2.5" xref="A4.I2.i2.p1.1.m1.6.7.1.cmml">,</mo><mn id="A4.I2.i2.p1.1.m1.5.5" xref="A4.I2.i2.p1.1.m1.5.5.cmml">50</mn><mo id="A4.I2.i2.p1.1.m1.6.7.2.6" xref="A4.I2.i2.p1.1.m1.6.7.1.cmml">,</mo><mn id="A4.I2.i2.p1.1.m1.6.6" xref="A4.I2.i2.p1.1.m1.6.6.cmml">100</mn><mo id="A4.I2.i2.p1.1.m1.6.7.2.7" stretchy="false" xref="A4.I2.i2.p1.1.m1.6.7.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.I2.i2.p1.1.m1.6b"><list id="A4.I2.i2.p1.1.m1.6.7.1.cmml" xref="A4.I2.i2.p1.1.m1.6.7.2"><cn id="A4.I2.i2.p1.1.m1.1.1.cmml" type="integer" xref="A4.I2.i2.p1.1.m1.1.1">3</cn><cn id="A4.I2.i2.p1.1.m1.2.2.cmml" type="integer" xref="A4.I2.i2.p1.1.m1.2.2">5</cn><cn id="A4.I2.i2.p1.1.m1.3.3.cmml" type="integer" xref="A4.I2.i2.p1.1.m1.3.3">10</cn><cn id="A4.I2.i2.p1.1.m1.4.4.cmml" type="integer" xref="A4.I2.i2.p1.1.m1.4.4">30</cn><cn id="A4.I2.i2.p1.1.m1.5.5.cmml" type="integer" xref="A4.I2.i2.p1.1.m1.5.5">50</cn><cn id="A4.I2.i2.p1.1.m1.6.6.cmml" type="integer" xref="A4.I2.i2.p1.1.m1.6.6">100</cn></list></annotation-xml><annotation encoding="application/x-tex" id="A4.I2.i2.p1.1.m1.6c">[3,5,10,30,50,100]</annotation><annotation encoding="application/x-llamapun" id="A4.I2.i2.p1.1.m1.6d">[ 3 , 5 , 10 , 30 , 50 , 100 ]</annotation></semantics></math>.
If one value of this parameter doesn’t improve upon the previous, we move on to the next value of the maximum number of leaves (i.e., we exit this loop early).</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsubsection" id="A4.SS3.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">D.3.4 </span>DEF</h4>
<div class="ltx_para ltx_noindent" id="A4.SS3.SSS4.p1">
<p class="ltx_p" id="A4.SS3.SSS4.p1.1">We train ensembles with 1000 DET models. Only three hyperparameters are tuned, using three nested loops, each loop running over the possible values of a single parameter in a pre-defined order. These are, in order of outermost to innermost:</p>
<ul class="ltx_itemize" id="A4.I3">
<li class="ltx_item" id="A4.I3.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A4.I3.i1.p1">
<p class="ltx_p" id="A4.I3.i1.p1.1">The maximum number of leaves per tree for which we test the values <math alttext="[16384,4096,1024,256]" class="ltx_Math" display="inline" id="A4.I3.i1.p1.1.m1.4"><semantics id="A4.I3.i1.p1.1.m1.4a"><mrow id="A4.I3.i1.p1.1.m1.4.5.2" xref="A4.I3.i1.p1.1.m1.4.5.1.cmml"><mo id="A4.I3.i1.p1.1.m1.4.5.2.1" stretchy="false" xref="A4.I3.i1.p1.1.m1.4.5.1.cmml">[</mo><mn id="A4.I3.i1.p1.1.m1.1.1" xref="A4.I3.i1.p1.1.m1.1.1.cmml">16384</mn><mo id="A4.I3.i1.p1.1.m1.4.5.2.2" xref="A4.I3.i1.p1.1.m1.4.5.1.cmml">,</mo><mn id="A4.I3.i1.p1.1.m1.2.2" xref="A4.I3.i1.p1.1.m1.2.2.cmml">4096</mn><mo id="A4.I3.i1.p1.1.m1.4.5.2.3" xref="A4.I3.i1.p1.1.m1.4.5.1.cmml">,</mo><mn id="A4.I3.i1.p1.1.m1.3.3" xref="A4.I3.i1.p1.1.m1.3.3.cmml">1024</mn><mo id="A4.I3.i1.p1.1.m1.4.5.2.4" xref="A4.I3.i1.p1.1.m1.4.5.1.cmml">,</mo><mn id="A4.I3.i1.p1.1.m1.4.4" xref="A4.I3.i1.p1.1.m1.4.4.cmml">256</mn><mo id="A4.I3.i1.p1.1.m1.4.5.2.5" stretchy="false" xref="A4.I3.i1.p1.1.m1.4.5.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.I3.i1.p1.1.m1.4b"><list id="A4.I3.i1.p1.1.m1.4.5.1.cmml" xref="A4.I3.i1.p1.1.m1.4.5.2"><cn id="A4.I3.i1.p1.1.m1.1.1.cmml" type="integer" xref="A4.I3.i1.p1.1.m1.1.1">16384</cn><cn id="A4.I3.i1.p1.1.m1.2.2.cmml" type="integer" xref="A4.I3.i1.p1.1.m1.2.2">4096</cn><cn id="A4.I3.i1.p1.1.m1.3.3.cmml" type="integer" xref="A4.I3.i1.p1.1.m1.3.3">1024</cn><cn id="A4.I3.i1.p1.1.m1.4.4.cmml" type="integer" xref="A4.I3.i1.p1.1.m1.4.4">256</cn></list></annotation-xml><annotation encoding="application/x-tex" id="A4.I3.i1.p1.1.m1.4c">[16384,4096,1024,256]</annotation><annotation encoding="application/x-llamapun" id="A4.I3.i1.p1.1.m1.4d">[ 16384 , 4096 , 1024 , 256 ]</annotation></semantics></math>.
If the best model for one value of the maximum number of leaves (over the remaining inner-loop parameters) doesn’t improve upon the previous, we stop the hyperparameter tuning.
This is done because in most datasets, reducing the number of leaves always leads to a worse model for DEF.</p>
</div>
</li>
<li class="ltx_item" id="A4.I3.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A4.I3.i2.p1">
<p class="ltx_p" id="A4.I3.i2.p1.2">The fraction of features to consider when splitting a node. We test the values <math alttext="[d^{-1/2},d^{-1/4},1]" class="ltx_Math" display="inline" id="A4.I3.i2.p1.1.m1.3"><semantics id="A4.I3.i2.p1.1.m1.3a"><mrow id="A4.I3.i2.p1.1.m1.3.3.2" xref="A4.I3.i2.p1.1.m1.3.3.3.cmml"><mo id="A4.I3.i2.p1.1.m1.3.3.2.3" stretchy="false" xref="A4.I3.i2.p1.1.m1.3.3.3.cmml">[</mo><msup id="A4.I3.i2.p1.1.m1.2.2.1.1" xref="A4.I3.i2.p1.1.m1.2.2.1.1.cmml"><mi id="A4.I3.i2.p1.1.m1.2.2.1.1.2" xref="A4.I3.i2.p1.1.m1.2.2.1.1.2.cmml">d</mi><mrow id="A4.I3.i2.p1.1.m1.2.2.1.1.3" xref="A4.I3.i2.p1.1.m1.2.2.1.1.3.cmml"><mo id="A4.I3.i2.p1.1.m1.2.2.1.1.3a" xref="A4.I3.i2.p1.1.m1.2.2.1.1.3.cmml">−</mo><mrow id="A4.I3.i2.p1.1.m1.2.2.1.1.3.2" xref="A4.I3.i2.p1.1.m1.2.2.1.1.3.2.cmml"><mn id="A4.I3.i2.p1.1.m1.2.2.1.1.3.2.2" xref="A4.I3.i2.p1.1.m1.2.2.1.1.3.2.2.cmml">1</mn><mo id="A4.I3.i2.p1.1.m1.2.2.1.1.3.2.1" xref="A4.I3.i2.p1.1.m1.2.2.1.1.3.2.1.cmml">/</mo><mn id="A4.I3.i2.p1.1.m1.2.2.1.1.3.2.3" xref="A4.I3.i2.p1.1.m1.2.2.1.1.3.2.3.cmml">2</mn></mrow></mrow></msup><mo id="A4.I3.i2.p1.1.m1.3.3.2.4" xref="A4.I3.i2.p1.1.m1.3.3.3.cmml">,</mo><msup id="A4.I3.i2.p1.1.m1.3.3.2.2" xref="A4.I3.i2.p1.1.m1.3.3.2.2.cmml"><mi id="A4.I3.i2.p1.1.m1.3.3.2.2.2" xref="A4.I3.i2.p1.1.m1.3.3.2.2.2.cmml">d</mi><mrow id="A4.I3.i2.p1.1.m1.3.3.2.2.3" xref="A4.I3.i2.p1.1.m1.3.3.2.2.3.cmml"><mo id="A4.I3.i2.p1.1.m1.3.3.2.2.3a" xref="A4.I3.i2.p1.1.m1.3.3.2.2.3.cmml">−</mo><mrow id="A4.I3.i2.p1.1.m1.3.3.2.2.3.2" xref="A4.I3.i2.p1.1.m1.3.3.2.2.3.2.cmml"><mn id="A4.I3.i2.p1.1.m1.3.3.2.2.3.2.2" xref="A4.I3.i2.p1.1.m1.3.3.2.2.3.2.2.cmml">1</mn><mo id="A4.I3.i2.p1.1.m1.3.3.2.2.3.2.1" xref="A4.I3.i2.p1.1.m1.3.3.2.2.3.2.1.cmml">/</mo><mn id="A4.I3.i2.p1.1.m1.3.3.2.2.3.2.3" xref="A4.I3.i2.p1.1.m1.3.3.2.2.3.2.3.cmml">4</mn></mrow></mrow></msup><mo id="A4.I3.i2.p1.1.m1.3.3.2.5" xref="A4.I3.i2.p1.1.m1.3.3.3.cmml">,</mo><mn id="A4.I3.i2.p1.1.m1.1.1" xref="A4.I3.i2.p1.1.m1.1.1.cmml">1</mn><mo id="A4.I3.i2.p1.1.m1.3.3.2.6" stretchy="false" xref="A4.I3.i2.p1.1.m1.3.3.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.I3.i2.p1.1.m1.3b"><list id="A4.I3.i2.p1.1.m1.3.3.3.cmml" xref="A4.I3.i2.p1.1.m1.3.3.2"><apply id="A4.I3.i2.p1.1.m1.2.2.1.1.cmml" xref="A4.I3.i2.p1.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="A4.I3.i2.p1.1.m1.2.2.1.1.1.cmml" xref="A4.I3.i2.p1.1.m1.2.2.1.1">superscript</csymbol><ci id="A4.I3.i2.p1.1.m1.2.2.1.1.2.cmml" xref="A4.I3.i2.p1.1.m1.2.2.1.1.2">𝑑</ci><apply id="A4.I3.i2.p1.1.m1.2.2.1.1.3.cmml" xref="A4.I3.i2.p1.1.m1.2.2.1.1.3"><minus id="A4.I3.i2.p1.1.m1.2.2.1.1.3.1.cmml" xref="A4.I3.i2.p1.1.m1.2.2.1.1.3"></minus><apply id="A4.I3.i2.p1.1.m1.2.2.1.1.3.2.cmml" xref="A4.I3.i2.p1.1.m1.2.2.1.1.3.2"><divide id="A4.I3.i2.p1.1.m1.2.2.1.1.3.2.1.cmml" xref="A4.I3.i2.p1.1.m1.2.2.1.1.3.2.1"></divide><cn id="A4.I3.i2.p1.1.m1.2.2.1.1.3.2.2.cmml" type="integer" xref="A4.I3.i2.p1.1.m1.2.2.1.1.3.2.2">1</cn><cn id="A4.I3.i2.p1.1.m1.2.2.1.1.3.2.3.cmml" type="integer" xref="A4.I3.i2.p1.1.m1.2.2.1.1.3.2.3">2</cn></apply></apply></apply><apply id="A4.I3.i2.p1.1.m1.3.3.2.2.cmml" xref="A4.I3.i2.p1.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="A4.I3.i2.p1.1.m1.3.3.2.2.1.cmml" xref="A4.I3.i2.p1.1.m1.3.3.2.2">superscript</csymbol><ci id="A4.I3.i2.p1.1.m1.3.3.2.2.2.cmml" xref="A4.I3.i2.p1.1.m1.3.3.2.2.2">𝑑</ci><apply id="A4.I3.i2.p1.1.m1.3.3.2.2.3.cmml" xref="A4.I3.i2.p1.1.m1.3.3.2.2.3"><minus id="A4.I3.i2.p1.1.m1.3.3.2.2.3.1.cmml" xref="A4.I3.i2.p1.1.m1.3.3.2.2.3"></minus><apply id="A4.I3.i2.p1.1.m1.3.3.2.2.3.2.cmml" xref="A4.I3.i2.p1.1.m1.3.3.2.2.3.2"><divide id="A4.I3.i2.p1.1.m1.3.3.2.2.3.2.1.cmml" xref="A4.I3.i2.p1.1.m1.3.3.2.2.3.2.1"></divide><cn id="A4.I3.i2.p1.1.m1.3.3.2.2.3.2.2.cmml" type="integer" xref="A4.I3.i2.p1.1.m1.3.3.2.2.3.2.2">1</cn><cn id="A4.I3.i2.p1.1.m1.3.3.2.2.3.2.3.cmml" type="integer" xref="A4.I3.i2.p1.1.m1.3.3.2.2.3.2.3">4</cn></apply></apply></apply><cn id="A4.I3.i2.p1.1.m1.1.1.cmml" type="integer" xref="A4.I3.i2.p1.1.m1.1.1">1</cn></list></annotation-xml><annotation encoding="application/x-tex" id="A4.I3.i2.p1.1.m1.3c">[d^{-1/2},d^{-1/4},1]</annotation><annotation encoding="application/x-llamapun" id="A4.I3.i2.p1.1.m1.3d">[ italic_d start_POSTSUPERSCRIPT - 1 / 2 end_POSTSUPERSCRIPT , italic_d start_POSTSUPERSCRIPT - 1 / 4 end_POSTSUPERSCRIPT , 1 ]</annotation></semantics></math> with <math alttext="d" class="ltx_Math" display="inline" id="A4.I3.i2.p1.2.m2.1"><semantics id="A4.I3.i2.p1.2.m2.1a"><mi id="A4.I3.i2.p1.2.m2.1.1" xref="A4.I3.i2.p1.2.m2.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="A4.I3.i2.p1.2.m2.1b"><ci id="A4.I3.i2.p1.2.m2.1.1.cmml" xref="A4.I3.i2.p1.2.m2.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.I3.i2.p1.2.m2.1c">d</annotation><annotation encoding="application/x-llamapun" id="A4.I3.i2.p1.2.m2.1d">italic_d</annotation></semantics></math> being the dimension of the dataset.
If the best model for one value of this parameter doesn’t improve upon the best model for the previous value, we move on to the next value of the maximum number of leaves (i.e., we exit this loop early).</p>
</div>
</li>
<li class="ltx_item" id="A4.I3.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="A4.I3.i3.p1">
<p class="ltx_p" id="A4.I3.i3.p1.1">The minimum number of data points that need to be left in each leaf for a split to be considered. We test the values <math alttext="[0,1,3,10,30]" class="ltx_Math" display="inline" id="A4.I3.i3.p1.1.m1.5"><semantics id="A4.I3.i3.p1.1.m1.5a"><mrow id="A4.I3.i3.p1.1.m1.5.6.2" xref="A4.I3.i3.p1.1.m1.5.6.1.cmml"><mo id="A4.I3.i3.p1.1.m1.5.6.2.1" stretchy="false" xref="A4.I3.i3.p1.1.m1.5.6.1.cmml">[</mo><mn id="A4.I3.i3.p1.1.m1.1.1" xref="A4.I3.i3.p1.1.m1.1.1.cmml">0</mn><mo id="A4.I3.i3.p1.1.m1.5.6.2.2" xref="A4.I3.i3.p1.1.m1.5.6.1.cmml">,</mo><mn id="A4.I3.i3.p1.1.m1.2.2" xref="A4.I3.i3.p1.1.m1.2.2.cmml">1</mn><mo id="A4.I3.i3.p1.1.m1.5.6.2.3" xref="A4.I3.i3.p1.1.m1.5.6.1.cmml">,</mo><mn id="A4.I3.i3.p1.1.m1.3.3" xref="A4.I3.i3.p1.1.m1.3.3.cmml">3</mn><mo id="A4.I3.i3.p1.1.m1.5.6.2.4" xref="A4.I3.i3.p1.1.m1.5.6.1.cmml">,</mo><mn id="A4.I3.i3.p1.1.m1.4.4" xref="A4.I3.i3.p1.1.m1.4.4.cmml">10</mn><mo id="A4.I3.i3.p1.1.m1.5.6.2.5" xref="A4.I3.i3.p1.1.m1.5.6.1.cmml">,</mo><mn id="A4.I3.i3.p1.1.m1.5.5" xref="A4.I3.i3.p1.1.m1.5.5.cmml">30</mn><mo id="A4.I3.i3.p1.1.m1.5.6.2.6" stretchy="false" xref="A4.I3.i3.p1.1.m1.5.6.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.I3.i3.p1.1.m1.5b"><list id="A4.I3.i3.p1.1.m1.5.6.1.cmml" xref="A4.I3.i3.p1.1.m1.5.6.2"><cn id="A4.I3.i3.p1.1.m1.1.1.cmml" type="integer" xref="A4.I3.i3.p1.1.m1.1.1">0</cn><cn id="A4.I3.i3.p1.1.m1.2.2.cmml" type="integer" xref="A4.I3.i3.p1.1.m1.2.2">1</cn><cn id="A4.I3.i3.p1.1.m1.3.3.cmml" type="integer" xref="A4.I3.i3.p1.1.m1.3.3">3</cn><cn id="A4.I3.i3.p1.1.m1.4.4.cmml" type="integer" xref="A4.I3.i3.p1.1.m1.4.4">10</cn><cn id="A4.I3.i3.p1.1.m1.5.5.cmml" type="integer" xref="A4.I3.i3.p1.1.m1.5.5">30</cn></list></annotation-xml><annotation encoding="application/x-tex" id="A4.I3.i3.p1.1.m1.5c">[0,1,3,10,30]</annotation><annotation encoding="application/x-llamapun" id="A4.I3.i3.p1.1.m1.5d">[ 0 , 1 , 3 , 10 , 30 ]</annotation></semantics></math>.
If one value of this parameter doesn’t improve upon the previous, we move on to the next value of fraction of features.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsubsection" id="A4.SS3.SSS5">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">D.3.5 </span>NRGBoost</h4>
<div class="ltx_para ltx_noindent" id="A4.SS3.SSS5.p1">
<p class="ltx_p" id="A4.SS3.SSS5.p1.1">We train NRGBoost models for a maximum of 200 rounds of boosting. We only tune two parameters for NRGBoost Models:</p>
<ul class="ltx_itemize" id="A4.I4">
<li class="ltx_item" id="A4.I4.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A4.I4.i1.p1">
<p class="ltx_p" id="A4.I4.i1.p1.1">The maximum number of leaves for which we try the values <math alttext="[64,256,1024,4096]" class="ltx_Math" display="inline" id="A4.I4.i1.p1.1.m1.4"><semantics id="A4.I4.i1.p1.1.m1.4a"><mrow id="A4.I4.i1.p1.1.m1.4.5.2" xref="A4.I4.i1.p1.1.m1.4.5.1.cmml"><mo id="A4.I4.i1.p1.1.m1.4.5.2.1" stretchy="false" xref="A4.I4.i1.p1.1.m1.4.5.1.cmml">[</mo><mn id="A4.I4.i1.p1.1.m1.1.1" xref="A4.I4.i1.p1.1.m1.1.1.cmml">64</mn><mo id="A4.I4.i1.p1.1.m1.4.5.2.2" xref="A4.I4.i1.p1.1.m1.4.5.1.cmml">,</mo><mn id="A4.I4.i1.p1.1.m1.2.2" xref="A4.I4.i1.p1.1.m1.2.2.cmml">256</mn><mo id="A4.I4.i1.p1.1.m1.4.5.2.3" xref="A4.I4.i1.p1.1.m1.4.5.1.cmml">,</mo><mn id="A4.I4.i1.p1.1.m1.3.3" xref="A4.I4.i1.p1.1.m1.3.3.cmml">1024</mn><mo id="A4.I4.i1.p1.1.m1.4.5.2.4" xref="A4.I4.i1.p1.1.m1.4.5.1.cmml">,</mo><mn id="A4.I4.i1.p1.1.m1.4.4" xref="A4.I4.i1.p1.1.m1.4.4.cmml">4096</mn><mo id="A4.I4.i1.p1.1.m1.4.5.2.5" stretchy="false" xref="A4.I4.i1.p1.1.m1.4.5.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.I4.i1.p1.1.m1.4b"><list id="A4.I4.i1.p1.1.m1.4.5.1.cmml" xref="A4.I4.i1.p1.1.m1.4.5.2"><cn id="A4.I4.i1.p1.1.m1.1.1.cmml" type="integer" xref="A4.I4.i1.p1.1.m1.1.1">64</cn><cn id="A4.I4.i1.p1.1.m1.2.2.cmml" type="integer" xref="A4.I4.i1.p1.1.m1.2.2">256</cn><cn id="A4.I4.i1.p1.1.m1.3.3.cmml" type="integer" xref="A4.I4.i1.p1.1.m1.3.3">1024</cn><cn id="A4.I4.i1.p1.1.m1.4.4.cmml" type="integer" xref="A4.I4.i1.p1.1.m1.4.4">4096</cn></list></annotation-xml><annotation encoding="application/x-tex" id="A4.I4.i1.p1.1.m1.4c">[64,256,1024,4096]</annotation><annotation encoding="application/x-llamapun" id="A4.I4.i1.p1.1.m1.4d">[ 64 , 256 , 1024 , 4096 ]</annotation></semantics></math> in order, stopping if performance fails to improve from one value to the next. For the CT dataset we also include 16384 in the values to test.</p>
</div>
</li>
<li class="ltx_item" id="A4.I4.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="A4.I4.i2.p1">
<p class="ltx_p" id="A4.I4.i2.p1.1">The constant factor by which the optimal step size determined by the line search is shrunk at each round of boosting.
This is essentially the "learning rate" parameter.
To tune it we perform a Golden-section search for the log of its value using a total of 6 evaluations. The range we use is <math alttext="[0.01,0.5]" class="ltx_Math" display="inline" id="A4.I4.i2.p1.1.m1.2"><semantics id="A4.I4.i2.p1.1.m1.2a"><mrow id="A4.I4.i2.p1.1.m1.2.3.2" xref="A4.I4.i2.p1.1.m1.2.3.1.cmml"><mo id="A4.I4.i2.p1.1.m1.2.3.2.1" stretchy="false" xref="A4.I4.i2.p1.1.m1.2.3.1.cmml">[</mo><mn id="A4.I4.i2.p1.1.m1.1.1" xref="A4.I4.i2.p1.1.m1.1.1.cmml">0.01</mn><mo id="A4.I4.i2.p1.1.m1.2.3.2.2" xref="A4.I4.i2.p1.1.m1.2.3.1.cmml">,</mo><mn id="A4.I4.i2.p1.1.m1.2.2" xref="A4.I4.i2.p1.1.m1.2.2.cmml">0.5</mn><mo id="A4.I4.i2.p1.1.m1.2.3.2.3" stretchy="false" xref="A4.I4.i2.p1.1.m1.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.I4.i2.p1.1.m1.2b"><interval closure="closed" id="A4.I4.i2.p1.1.m1.2.3.1.cmml" xref="A4.I4.i2.p1.1.m1.2.3.2"><cn id="A4.I4.i2.p1.1.m1.1.1.cmml" type="float" xref="A4.I4.i2.p1.1.m1.1.1">0.01</cn><cn id="A4.I4.i2.p1.1.m1.2.2.cmml" type="float" xref="A4.I4.i2.p1.1.m1.2.2">0.5</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="A4.I4.i2.p1.1.m1.2c">[0.01,0.5]</annotation><annotation encoding="application/x-llamapun" id="A4.I4.i2.p1.1.m1.2d">[ 0.01 , 0.5 ]</annotation></semantics></math>.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para ltx_noindent" id="A4.SS3.SSS5.p2">
<p class="ltx_p" id="A4.SS3.SSS5.p2.1">For regularization we limit the ratio between empirical data density and model data density on each leaf to a maximum of 2.
We noticed that smaller values of this regularization parameter tend to work better but that it otherwise plays a similar role to the shrinkage factor so we opt to tune only the latter.</p>
</div>
<div class="ltx_para ltx_noindent" id="A4.SS3.SSS5.p3">
<p class="ltx_p" id="A4.SS3.SSS5.p3.1">For sampling we use a sample pool of 80000 samples for all datasets except for Covertype where we use 320000.
These values are chosen so that the number of samples in the pool are at minimum similar to the training set size which we found to be a good rule of thumb.
At each round of boosting, samples are removed from the pool according to our rejection sampling approach (using Equation <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#S3.E12" title="In 3.2 Amortized Sampling ‣ 3 NRGBoost ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">12</span></a>) after independently removing 10% at random.
These samples are replaced by samples from the current model using Gibbs sampling.</p>
</div>
<div class="ltx_para ltx_noindent" id="A4.SS3.SSS5.p4">
<p class="ltx_p" id="A4.SS3.SSS5.p4.1">The starting point of each NRGBoost model was selected as a mixture model between a uniform distribution (10%) and the
product of training marginals (90%) on the discretized input space. We observed that this mixture coefficient does not have much impact on the results however.</p>
</div>
</section>
<section class="ltx_subsubsection" id="A4.SS3.SSS6">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">D.3.6 </span>TVAE</h4>
<div class="ltx_para ltx_noindent" id="A4.SS3.SSS6.p1">
<p class="ltx_p" id="A4.SS3.SSS6.p1.1">We use the implementation of TVAE from the SDV package.<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/sdv-dev/SDV" title="">https://github.com/sdv-dev/SDV</a></span></span></span>
To tune its hyperparameters we use 50 trials of random search with the search spaces defined in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A4.T9" title="Table 9 ‣ D.3.6 TVAE ‣ D.3 Hyperparameter Tuning ‣ Appendix D Reproducibility ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">9</span></a>.</p>
</div>
<figure class="ltx_table" id="A4.T9">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 9: </span>TVAE hyperparameter tuning search space. We set both <span class="ltx_text ltx_font_typewriter" id="A4.T9.12.1">compress_dims</span> and <span class="ltx_text ltx_font_typewriter" id="A4.T9.13.2">decompress_dims</span> to have the number of layers specified by <span class="ltx_text ltx_font_typewriter" id="A4.T9.14.3">num_layers</span>,
with <span class="ltx_text ltx_font_typewriter" id="A4.T9.15.4">hidden_dim</span> hidden units in each layer.
We use larger batch sizes and smaller number of epochs for the larger datasets (MBNE, MNIST, CT) since these can take signifcantly longer to run a single epoch.</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="A4.T9.7">
<tr class="ltx_tr" id="A4.T9.7.8">
<td class="ltx_td ltx_align_left ltx_border_tt" id="A4.T9.7.8.1" style="padding-top:1.25pt;padding-bottom:1.25pt;">Parameter</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A4.T9.7.8.2" style="padding-top:1.25pt;padding-bottom:1.25pt;">Datasets</td>
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_tt" id="A4.T9.7.8.3" style="padding-top:1.25pt;padding-bottom:1.25pt;">Distribution or Value</td>
</tr>
<tr class="ltx_tr" id="A4.T9.1.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="A4.T9.1.1.2" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span class="ltx_text ltx_font_typewriter" id="A4.T9.1.1.2.1">epochs</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T9.1.1.3" style="padding-top:1.25pt;padding-bottom:1.25pt;">small</td>
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t" id="A4.T9.1.1.1" style="padding-top:1.25pt;padding-bottom:1.25pt;"><math alttext="\textrm{Uniform}\left(\left[100..500\right]\right)" class="ltx_Math" display="inline" id="A4.T9.1.1.1.m1.2"><semantics id="A4.T9.1.1.1.m1.2a"><mrow id="A4.T9.1.1.1.m1.2.2" xref="A4.T9.1.1.1.m1.2.2.cmml"><mtext id="A4.T9.1.1.1.m1.2.2.3" xref="A4.T9.1.1.1.m1.2.2.3a.cmml">Uniform</mtext><mo id="A4.T9.1.1.1.m1.2.2.2" xref="A4.T9.1.1.1.m1.2.2.2.cmml">⁢</mo><mrow id="A4.T9.1.1.1.m1.2.2.1.1" xref="A4.T9.1.1.1.m1.2.2.cmml"><mo id="A4.T9.1.1.1.m1.2.2.1.1.2" xref="A4.T9.1.1.1.m1.2.2.cmml">(</mo><mrow id="A4.T9.1.1.1.m1.2.2.1.1.1.2" xref="A4.T9.1.1.1.m1.2.2.1.1.1.1.cmml"><mo id="A4.T9.1.1.1.m1.2.2.1.1.1.2.1" xref="A4.T9.1.1.1.m1.2.2.1.1.1.1.1.cmml">[</mo><mn id="A4.T9.1.1.1.m1.1.1" xref="A4.T9.1.1.1.m1.1.1.cmml">100..500</mn><mo id="A4.T9.1.1.1.m1.2.2.1.1.1.2.2" xref="A4.T9.1.1.1.m1.2.2.1.1.1.1.1.cmml">]</mo></mrow><mo id="A4.T9.1.1.1.m1.2.2.1.1.3" xref="A4.T9.1.1.1.m1.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.T9.1.1.1.m1.2b"><apply id="A4.T9.1.1.1.m1.2.2.cmml" xref="A4.T9.1.1.1.m1.2.2"><times id="A4.T9.1.1.1.m1.2.2.2.cmml" xref="A4.T9.1.1.1.m1.2.2.2"></times><ci id="A4.T9.1.1.1.m1.2.2.3a.cmml" xref="A4.T9.1.1.1.m1.2.2.3"><mtext id="A4.T9.1.1.1.m1.2.2.3.cmml" xref="A4.T9.1.1.1.m1.2.2.3">Uniform</mtext></ci><apply id="A4.T9.1.1.1.m1.2.2.1.1.1.1.cmml" xref="A4.T9.1.1.1.m1.2.2.1.1.1.2"><csymbol cd="latexml" id="A4.T9.1.1.1.m1.2.2.1.1.1.1.1.cmml" xref="A4.T9.1.1.1.m1.2.2.1.1.1.2.1">delimited-[]</csymbol><cn id="A4.T9.1.1.1.m1.1.1.cmml" type="float" xref="A4.T9.1.1.1.m1.1.1">100..500</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T9.1.1.1.m1.2c">\textrm{Uniform}\left(\left[100..500\right]\right)</annotation><annotation encoding="application/x-llamapun" id="A4.T9.1.1.1.m1.2d">Uniform ( [ 100..500 ] )</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A4.T9.2.2">
<td class="ltx_td" id="A4.T9.2.2.2" style="padding-top:1.25pt;padding-bottom:1.25pt;"></td>
<td class="ltx_td ltx_align_center" id="A4.T9.2.2.3" style="padding-top:1.25pt;padding-bottom:1.25pt;">large</td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A4.T9.2.2.1" style="padding-top:1.25pt;padding-bottom:1.25pt;"><math alttext="\textrm{Uniform}\left(\left[50..200\right]\right)" class="ltx_Math" display="inline" id="A4.T9.2.2.1.m1.2"><semantics id="A4.T9.2.2.1.m1.2a"><mrow id="A4.T9.2.2.1.m1.2.2" xref="A4.T9.2.2.1.m1.2.2.cmml"><mtext id="A4.T9.2.2.1.m1.2.2.3" xref="A4.T9.2.2.1.m1.2.2.3a.cmml">Uniform</mtext><mo id="A4.T9.2.2.1.m1.2.2.2" xref="A4.T9.2.2.1.m1.2.2.2.cmml">⁢</mo><mrow id="A4.T9.2.2.1.m1.2.2.1.1" xref="A4.T9.2.2.1.m1.2.2.cmml"><mo id="A4.T9.2.2.1.m1.2.2.1.1.2" xref="A4.T9.2.2.1.m1.2.2.cmml">(</mo><mrow id="A4.T9.2.2.1.m1.2.2.1.1.1.2" xref="A4.T9.2.2.1.m1.2.2.1.1.1.1.cmml"><mo id="A4.T9.2.2.1.m1.2.2.1.1.1.2.1" xref="A4.T9.2.2.1.m1.2.2.1.1.1.1.1.cmml">[</mo><mn id="A4.T9.2.2.1.m1.1.1" xref="A4.T9.2.2.1.m1.1.1.cmml">50..200</mn><mo id="A4.T9.2.2.1.m1.2.2.1.1.1.2.2" xref="A4.T9.2.2.1.m1.2.2.1.1.1.1.1.cmml">]</mo></mrow><mo id="A4.T9.2.2.1.m1.2.2.1.1.3" xref="A4.T9.2.2.1.m1.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.T9.2.2.1.m1.2b"><apply id="A4.T9.2.2.1.m1.2.2.cmml" xref="A4.T9.2.2.1.m1.2.2"><times id="A4.T9.2.2.1.m1.2.2.2.cmml" xref="A4.T9.2.2.1.m1.2.2.2"></times><ci id="A4.T9.2.2.1.m1.2.2.3a.cmml" xref="A4.T9.2.2.1.m1.2.2.3"><mtext id="A4.T9.2.2.1.m1.2.2.3.cmml" xref="A4.T9.2.2.1.m1.2.2.3">Uniform</mtext></ci><apply id="A4.T9.2.2.1.m1.2.2.1.1.1.1.cmml" xref="A4.T9.2.2.1.m1.2.2.1.1.1.2"><csymbol cd="latexml" id="A4.T9.2.2.1.m1.2.2.1.1.1.1.1.cmml" xref="A4.T9.2.2.1.m1.2.2.1.1.1.2.1">delimited-[]</csymbol><cn id="A4.T9.2.2.1.m1.1.1.cmml" type="float" xref="A4.T9.2.2.1.m1.1.1">50..200</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T9.2.2.1.m1.2c">\textrm{Uniform}\left(\left[50..200\right]\right)</annotation><annotation encoding="application/x-llamapun" id="A4.T9.2.2.1.m1.2d">Uniform ( [ 50..200 ] )</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A4.T9.3.3">
<td class="ltx_td ltx_align_left" id="A4.T9.3.3.2" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span class="ltx_text ltx_font_typewriter" id="A4.T9.3.3.2.1">batch_size</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.3.3.3" style="padding-top:1.25pt;padding-bottom:1.25pt;">small</td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A4.T9.3.3.1" style="padding-top:1.25pt;padding-bottom:1.25pt;"><math alttext="\textrm{Uniform}\left(\left\{100,200,\ldots,500\right\}\right)" class="ltx_Math" display="inline" id="A4.T9.3.3.1.m1.5"><semantics id="A4.T9.3.3.1.m1.5a"><mrow id="A4.T9.3.3.1.m1.5.5" xref="A4.T9.3.3.1.m1.5.5.cmml"><mtext id="A4.T9.3.3.1.m1.5.5.3" xref="A4.T9.3.3.1.m1.5.5.3a.cmml">Uniform</mtext><mo id="A4.T9.3.3.1.m1.5.5.2" xref="A4.T9.3.3.1.m1.5.5.2.cmml">⁢</mo><mrow id="A4.T9.3.3.1.m1.5.5.1.1" xref="A4.T9.3.3.1.m1.5.5.cmml"><mo id="A4.T9.3.3.1.m1.5.5.1.1.2" xref="A4.T9.3.3.1.m1.5.5.cmml">(</mo><mrow id="A4.T9.3.3.1.m1.5.5.1.1.1.2" xref="A4.T9.3.3.1.m1.5.5.1.1.1.1.cmml"><mo id="A4.T9.3.3.1.m1.5.5.1.1.1.2.1" xref="A4.T9.3.3.1.m1.5.5.1.1.1.1.cmml">{</mo><mn id="A4.T9.3.3.1.m1.1.1" xref="A4.T9.3.3.1.m1.1.1.cmml">100</mn><mo id="A4.T9.3.3.1.m1.5.5.1.1.1.2.2" xref="A4.T9.3.3.1.m1.5.5.1.1.1.1.cmml">,</mo><mn id="A4.T9.3.3.1.m1.2.2" xref="A4.T9.3.3.1.m1.2.2.cmml">200</mn><mo id="A4.T9.3.3.1.m1.5.5.1.1.1.2.3" xref="A4.T9.3.3.1.m1.5.5.1.1.1.1.cmml">,</mo><mi id="A4.T9.3.3.1.m1.3.3" mathvariant="normal" xref="A4.T9.3.3.1.m1.3.3.cmml">…</mi><mo id="A4.T9.3.3.1.m1.5.5.1.1.1.2.4" xref="A4.T9.3.3.1.m1.5.5.1.1.1.1.cmml">,</mo><mn id="A4.T9.3.3.1.m1.4.4" xref="A4.T9.3.3.1.m1.4.4.cmml">500</mn><mo id="A4.T9.3.3.1.m1.5.5.1.1.1.2.5" xref="A4.T9.3.3.1.m1.5.5.1.1.1.1.cmml">}</mo></mrow><mo id="A4.T9.3.3.1.m1.5.5.1.1.3" xref="A4.T9.3.3.1.m1.5.5.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.T9.3.3.1.m1.5b"><apply id="A4.T9.3.3.1.m1.5.5.cmml" xref="A4.T9.3.3.1.m1.5.5"><times id="A4.T9.3.3.1.m1.5.5.2.cmml" xref="A4.T9.3.3.1.m1.5.5.2"></times><ci id="A4.T9.3.3.1.m1.5.5.3a.cmml" xref="A4.T9.3.3.1.m1.5.5.3"><mtext id="A4.T9.3.3.1.m1.5.5.3.cmml" xref="A4.T9.3.3.1.m1.5.5.3">Uniform</mtext></ci><set id="A4.T9.3.3.1.m1.5.5.1.1.1.1.cmml" xref="A4.T9.3.3.1.m1.5.5.1.1.1.2"><cn id="A4.T9.3.3.1.m1.1.1.cmml" type="integer" xref="A4.T9.3.3.1.m1.1.1">100</cn><cn id="A4.T9.3.3.1.m1.2.2.cmml" type="integer" xref="A4.T9.3.3.1.m1.2.2">200</cn><ci id="A4.T9.3.3.1.m1.3.3.cmml" xref="A4.T9.3.3.1.m1.3.3">…</ci><cn id="A4.T9.3.3.1.m1.4.4.cmml" type="integer" xref="A4.T9.3.3.1.m1.4.4">500</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T9.3.3.1.m1.5c">\textrm{Uniform}\left(\left\{100,200,\ldots,500\right\}\right)</annotation><annotation encoding="application/x-llamapun" id="A4.T9.3.3.1.m1.5d">Uniform ( { 100 , 200 , … , 500 } )</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A4.T9.4.4">
<td class="ltx_td" id="A4.T9.4.4.2" style="padding-top:1.25pt;padding-bottom:1.25pt;"></td>
<td class="ltx_td ltx_align_center" id="A4.T9.4.4.3" style="padding-top:1.25pt;padding-bottom:1.25pt;">large</td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A4.T9.4.4.1" style="padding-top:1.25pt;padding-bottom:1.25pt;"><math alttext="\textrm{Uniform}\left(\left\{500,1000,\ldots,2500\right\}\right)" class="ltx_Math" display="inline" id="A4.T9.4.4.1.m1.5"><semantics id="A4.T9.4.4.1.m1.5a"><mrow id="A4.T9.4.4.1.m1.5.5" xref="A4.T9.4.4.1.m1.5.5.cmml"><mtext id="A4.T9.4.4.1.m1.5.5.3" xref="A4.T9.4.4.1.m1.5.5.3a.cmml">Uniform</mtext><mo id="A4.T9.4.4.1.m1.5.5.2" xref="A4.T9.4.4.1.m1.5.5.2.cmml">⁢</mo><mrow id="A4.T9.4.4.1.m1.5.5.1.1" xref="A4.T9.4.4.1.m1.5.5.cmml"><mo id="A4.T9.4.4.1.m1.5.5.1.1.2" xref="A4.T9.4.4.1.m1.5.5.cmml">(</mo><mrow id="A4.T9.4.4.1.m1.5.5.1.1.1.2" xref="A4.T9.4.4.1.m1.5.5.1.1.1.1.cmml"><mo id="A4.T9.4.4.1.m1.5.5.1.1.1.2.1" xref="A4.T9.4.4.1.m1.5.5.1.1.1.1.cmml">{</mo><mn id="A4.T9.4.4.1.m1.1.1" xref="A4.T9.4.4.1.m1.1.1.cmml">500</mn><mo id="A4.T9.4.4.1.m1.5.5.1.1.1.2.2" xref="A4.T9.4.4.1.m1.5.5.1.1.1.1.cmml">,</mo><mn id="A4.T9.4.4.1.m1.2.2" xref="A4.T9.4.4.1.m1.2.2.cmml">1000</mn><mo id="A4.T9.4.4.1.m1.5.5.1.1.1.2.3" xref="A4.T9.4.4.1.m1.5.5.1.1.1.1.cmml">,</mo><mi id="A4.T9.4.4.1.m1.3.3" mathvariant="normal" xref="A4.T9.4.4.1.m1.3.3.cmml">…</mi><mo id="A4.T9.4.4.1.m1.5.5.1.1.1.2.4" xref="A4.T9.4.4.1.m1.5.5.1.1.1.1.cmml">,</mo><mn id="A4.T9.4.4.1.m1.4.4" xref="A4.T9.4.4.1.m1.4.4.cmml">2500</mn><mo id="A4.T9.4.4.1.m1.5.5.1.1.1.2.5" xref="A4.T9.4.4.1.m1.5.5.1.1.1.1.cmml">}</mo></mrow><mo id="A4.T9.4.4.1.m1.5.5.1.1.3" xref="A4.T9.4.4.1.m1.5.5.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.T9.4.4.1.m1.5b"><apply id="A4.T9.4.4.1.m1.5.5.cmml" xref="A4.T9.4.4.1.m1.5.5"><times id="A4.T9.4.4.1.m1.5.5.2.cmml" xref="A4.T9.4.4.1.m1.5.5.2"></times><ci id="A4.T9.4.4.1.m1.5.5.3a.cmml" xref="A4.T9.4.4.1.m1.5.5.3"><mtext id="A4.T9.4.4.1.m1.5.5.3.cmml" xref="A4.T9.4.4.1.m1.5.5.3">Uniform</mtext></ci><set id="A4.T9.4.4.1.m1.5.5.1.1.1.1.cmml" xref="A4.T9.4.4.1.m1.5.5.1.1.1.2"><cn id="A4.T9.4.4.1.m1.1.1.cmml" type="integer" xref="A4.T9.4.4.1.m1.1.1">500</cn><cn id="A4.T9.4.4.1.m1.2.2.cmml" type="integer" xref="A4.T9.4.4.1.m1.2.2">1000</cn><ci id="A4.T9.4.4.1.m1.3.3.cmml" xref="A4.T9.4.4.1.m1.3.3">…</ci><cn id="A4.T9.4.4.1.m1.4.4.cmml" type="integer" xref="A4.T9.4.4.1.m1.4.4">2500</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T9.4.4.1.m1.5c">\textrm{Uniform}\left(\left\{500,1000,\ldots,2500\right\}\right)</annotation><annotation encoding="application/x-llamapun" id="A4.T9.4.4.1.m1.5d">Uniform ( { 500 , 1000 , … , 2500 } )</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A4.T9.5.5">
<td class="ltx_td ltx_align_left" id="A4.T9.5.5.2" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span class="ltx_text ltx_font_typewriter" id="A4.T9.5.5.2.1">embedding_dim</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.5.5.3" style="padding-top:1.25pt;padding-bottom:1.25pt;">all</td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A4.T9.5.5.1" style="padding-top:1.25pt;padding-bottom:1.25pt;"><math alttext="\textrm{Uniform}\left(\left\{32,64,128,256,512\right\}\right)" class="ltx_Math" display="inline" id="A4.T9.5.5.1.m1.6"><semantics id="A4.T9.5.5.1.m1.6a"><mrow id="A4.T9.5.5.1.m1.6.6" xref="A4.T9.5.5.1.m1.6.6.cmml"><mtext id="A4.T9.5.5.1.m1.6.6.3" xref="A4.T9.5.5.1.m1.6.6.3a.cmml">Uniform</mtext><mo id="A4.T9.5.5.1.m1.6.6.2" xref="A4.T9.5.5.1.m1.6.6.2.cmml">⁢</mo><mrow id="A4.T9.5.5.1.m1.6.6.1.1" xref="A4.T9.5.5.1.m1.6.6.cmml"><mo id="A4.T9.5.5.1.m1.6.6.1.1.2" xref="A4.T9.5.5.1.m1.6.6.cmml">(</mo><mrow id="A4.T9.5.5.1.m1.6.6.1.1.1.2" xref="A4.T9.5.5.1.m1.6.6.1.1.1.1.cmml"><mo id="A4.T9.5.5.1.m1.6.6.1.1.1.2.1" xref="A4.T9.5.5.1.m1.6.6.1.1.1.1.cmml">{</mo><mn id="A4.T9.5.5.1.m1.1.1" xref="A4.T9.5.5.1.m1.1.1.cmml">32</mn><mo id="A4.T9.5.5.1.m1.6.6.1.1.1.2.2" xref="A4.T9.5.5.1.m1.6.6.1.1.1.1.cmml">,</mo><mn id="A4.T9.5.5.1.m1.2.2" xref="A4.T9.5.5.1.m1.2.2.cmml">64</mn><mo id="A4.T9.5.5.1.m1.6.6.1.1.1.2.3" xref="A4.T9.5.5.1.m1.6.6.1.1.1.1.cmml">,</mo><mn id="A4.T9.5.5.1.m1.3.3" xref="A4.T9.5.5.1.m1.3.3.cmml">128</mn><mo id="A4.T9.5.5.1.m1.6.6.1.1.1.2.4" xref="A4.T9.5.5.1.m1.6.6.1.1.1.1.cmml">,</mo><mn id="A4.T9.5.5.1.m1.4.4" xref="A4.T9.5.5.1.m1.4.4.cmml">256</mn><mo id="A4.T9.5.5.1.m1.6.6.1.1.1.2.5" xref="A4.T9.5.5.1.m1.6.6.1.1.1.1.cmml">,</mo><mn id="A4.T9.5.5.1.m1.5.5" xref="A4.T9.5.5.1.m1.5.5.cmml">512</mn><mo id="A4.T9.5.5.1.m1.6.6.1.1.1.2.6" xref="A4.T9.5.5.1.m1.6.6.1.1.1.1.cmml">}</mo></mrow><mo id="A4.T9.5.5.1.m1.6.6.1.1.3" xref="A4.T9.5.5.1.m1.6.6.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.T9.5.5.1.m1.6b"><apply id="A4.T9.5.5.1.m1.6.6.cmml" xref="A4.T9.5.5.1.m1.6.6"><times id="A4.T9.5.5.1.m1.6.6.2.cmml" xref="A4.T9.5.5.1.m1.6.6.2"></times><ci id="A4.T9.5.5.1.m1.6.6.3a.cmml" xref="A4.T9.5.5.1.m1.6.6.3"><mtext id="A4.T9.5.5.1.m1.6.6.3.cmml" xref="A4.T9.5.5.1.m1.6.6.3">Uniform</mtext></ci><set id="A4.T9.5.5.1.m1.6.6.1.1.1.1.cmml" xref="A4.T9.5.5.1.m1.6.6.1.1.1.2"><cn id="A4.T9.5.5.1.m1.1.1.cmml" type="integer" xref="A4.T9.5.5.1.m1.1.1">32</cn><cn id="A4.T9.5.5.1.m1.2.2.cmml" type="integer" xref="A4.T9.5.5.1.m1.2.2">64</cn><cn id="A4.T9.5.5.1.m1.3.3.cmml" type="integer" xref="A4.T9.5.5.1.m1.3.3">128</cn><cn id="A4.T9.5.5.1.m1.4.4.cmml" type="integer" xref="A4.T9.5.5.1.m1.4.4">256</cn><cn id="A4.T9.5.5.1.m1.5.5.cmml" type="integer" xref="A4.T9.5.5.1.m1.5.5">512</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T9.5.5.1.m1.6c">\textrm{Uniform}\left(\left\{32,64,128,256,512\right\}\right)</annotation><annotation encoding="application/x-llamapun" id="A4.T9.5.5.1.m1.6d">Uniform ( { 32 , 64 , 128 , 256 , 512 } )</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A4.T9.6.6">
<td class="ltx_td ltx_align_left" id="A4.T9.6.6.2" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span class="ltx_text ltx_font_typewriter" id="A4.T9.6.6.2.1">hidden_dim</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.6.6.3" style="padding-top:1.25pt;padding-bottom:1.25pt;">all</td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A4.T9.6.6.1" style="padding-top:1.25pt;padding-bottom:1.25pt;"><math alttext="\textrm{Uniform}\left(\left\{32,64,128,256,512\right\}\right)" class="ltx_Math" display="inline" id="A4.T9.6.6.1.m1.6"><semantics id="A4.T9.6.6.1.m1.6a"><mrow id="A4.T9.6.6.1.m1.6.6" xref="A4.T9.6.6.1.m1.6.6.cmml"><mtext id="A4.T9.6.6.1.m1.6.6.3" xref="A4.T9.6.6.1.m1.6.6.3a.cmml">Uniform</mtext><mo id="A4.T9.6.6.1.m1.6.6.2" xref="A4.T9.6.6.1.m1.6.6.2.cmml">⁢</mo><mrow id="A4.T9.6.6.1.m1.6.6.1.1" xref="A4.T9.6.6.1.m1.6.6.cmml"><mo id="A4.T9.6.6.1.m1.6.6.1.1.2" xref="A4.T9.6.6.1.m1.6.6.cmml">(</mo><mrow id="A4.T9.6.6.1.m1.6.6.1.1.1.2" xref="A4.T9.6.6.1.m1.6.6.1.1.1.1.cmml"><mo id="A4.T9.6.6.1.m1.6.6.1.1.1.2.1" xref="A4.T9.6.6.1.m1.6.6.1.1.1.1.cmml">{</mo><mn id="A4.T9.6.6.1.m1.1.1" xref="A4.T9.6.6.1.m1.1.1.cmml">32</mn><mo id="A4.T9.6.6.1.m1.6.6.1.1.1.2.2" xref="A4.T9.6.6.1.m1.6.6.1.1.1.1.cmml">,</mo><mn id="A4.T9.6.6.1.m1.2.2" xref="A4.T9.6.6.1.m1.2.2.cmml">64</mn><mo id="A4.T9.6.6.1.m1.6.6.1.1.1.2.3" xref="A4.T9.6.6.1.m1.6.6.1.1.1.1.cmml">,</mo><mn id="A4.T9.6.6.1.m1.3.3" xref="A4.T9.6.6.1.m1.3.3.cmml">128</mn><mo id="A4.T9.6.6.1.m1.6.6.1.1.1.2.4" xref="A4.T9.6.6.1.m1.6.6.1.1.1.1.cmml">,</mo><mn id="A4.T9.6.6.1.m1.4.4" xref="A4.T9.6.6.1.m1.4.4.cmml">256</mn><mo id="A4.T9.6.6.1.m1.6.6.1.1.1.2.5" xref="A4.T9.6.6.1.m1.6.6.1.1.1.1.cmml">,</mo><mn id="A4.T9.6.6.1.m1.5.5" xref="A4.T9.6.6.1.m1.5.5.cmml">512</mn><mo id="A4.T9.6.6.1.m1.6.6.1.1.1.2.6" xref="A4.T9.6.6.1.m1.6.6.1.1.1.1.cmml">}</mo></mrow><mo id="A4.T9.6.6.1.m1.6.6.1.1.3" xref="A4.T9.6.6.1.m1.6.6.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.T9.6.6.1.m1.6b"><apply id="A4.T9.6.6.1.m1.6.6.cmml" xref="A4.T9.6.6.1.m1.6.6"><times id="A4.T9.6.6.1.m1.6.6.2.cmml" xref="A4.T9.6.6.1.m1.6.6.2"></times><ci id="A4.T9.6.6.1.m1.6.6.3a.cmml" xref="A4.T9.6.6.1.m1.6.6.3"><mtext id="A4.T9.6.6.1.m1.6.6.3.cmml" xref="A4.T9.6.6.1.m1.6.6.3">Uniform</mtext></ci><set id="A4.T9.6.6.1.m1.6.6.1.1.1.1.cmml" xref="A4.T9.6.6.1.m1.6.6.1.1.1.2"><cn id="A4.T9.6.6.1.m1.1.1.cmml" type="integer" xref="A4.T9.6.6.1.m1.1.1">32</cn><cn id="A4.T9.6.6.1.m1.2.2.cmml" type="integer" xref="A4.T9.6.6.1.m1.2.2">64</cn><cn id="A4.T9.6.6.1.m1.3.3.cmml" type="integer" xref="A4.T9.6.6.1.m1.3.3">128</cn><cn id="A4.T9.6.6.1.m1.4.4.cmml" type="integer" xref="A4.T9.6.6.1.m1.4.4">256</cn><cn id="A4.T9.6.6.1.m1.5.5.cmml" type="integer" xref="A4.T9.6.6.1.m1.5.5">512</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T9.6.6.1.m1.6c">\textrm{Uniform}\left(\left\{32,64,128,256,512\right\}\right)</annotation><annotation encoding="application/x-llamapun" id="A4.T9.6.6.1.m1.6d">Uniform ( { 32 , 64 , 128 , 256 , 512 } )</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A4.T9.7.7">
<td class="ltx_td ltx_align_left" id="A4.T9.7.7.2" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span class="ltx_text ltx_font_typewriter" id="A4.T9.7.7.2.1">num_layers</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.7.7.3" style="padding-top:1.25pt;padding-bottom:1.25pt;">all</td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A4.T9.7.7.1" style="padding-top:1.25pt;padding-bottom:1.25pt;"><math alttext="\textrm{Uniform}\left(\left\{1,2,3\right\}\right)" class="ltx_Math" display="inline" id="A4.T9.7.7.1.m1.4"><semantics id="A4.T9.7.7.1.m1.4a"><mrow id="A4.T9.7.7.1.m1.4.4" xref="A4.T9.7.7.1.m1.4.4.cmml"><mtext id="A4.T9.7.7.1.m1.4.4.3" xref="A4.T9.7.7.1.m1.4.4.3a.cmml">Uniform</mtext><mo id="A4.T9.7.7.1.m1.4.4.2" xref="A4.T9.7.7.1.m1.4.4.2.cmml">⁢</mo><mrow id="A4.T9.7.7.1.m1.4.4.1.1" xref="A4.T9.7.7.1.m1.4.4.cmml"><mo id="A4.T9.7.7.1.m1.4.4.1.1.2" xref="A4.T9.7.7.1.m1.4.4.cmml">(</mo><mrow id="A4.T9.7.7.1.m1.4.4.1.1.1.2" xref="A4.T9.7.7.1.m1.4.4.1.1.1.1.cmml"><mo id="A4.T9.7.7.1.m1.4.4.1.1.1.2.1" xref="A4.T9.7.7.1.m1.4.4.1.1.1.1.cmml">{</mo><mn id="A4.T9.7.7.1.m1.1.1" xref="A4.T9.7.7.1.m1.1.1.cmml">1</mn><mo id="A4.T9.7.7.1.m1.4.4.1.1.1.2.2" xref="A4.T9.7.7.1.m1.4.4.1.1.1.1.cmml">,</mo><mn id="A4.T9.7.7.1.m1.2.2" xref="A4.T9.7.7.1.m1.2.2.cmml">2</mn><mo id="A4.T9.7.7.1.m1.4.4.1.1.1.2.3" xref="A4.T9.7.7.1.m1.4.4.1.1.1.1.cmml">,</mo><mn id="A4.T9.7.7.1.m1.3.3" xref="A4.T9.7.7.1.m1.3.3.cmml">3</mn><mo id="A4.T9.7.7.1.m1.4.4.1.1.1.2.4" xref="A4.T9.7.7.1.m1.4.4.1.1.1.1.cmml">}</mo></mrow><mo id="A4.T9.7.7.1.m1.4.4.1.1.3" xref="A4.T9.7.7.1.m1.4.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.T9.7.7.1.m1.4b"><apply id="A4.T9.7.7.1.m1.4.4.cmml" xref="A4.T9.7.7.1.m1.4.4"><times id="A4.T9.7.7.1.m1.4.4.2.cmml" xref="A4.T9.7.7.1.m1.4.4.2"></times><ci id="A4.T9.7.7.1.m1.4.4.3a.cmml" xref="A4.T9.7.7.1.m1.4.4.3"><mtext id="A4.T9.7.7.1.m1.4.4.3.cmml" xref="A4.T9.7.7.1.m1.4.4.3">Uniform</mtext></ci><set id="A4.T9.7.7.1.m1.4.4.1.1.1.1.cmml" xref="A4.T9.7.7.1.m1.4.4.1.1.1.2"><cn id="A4.T9.7.7.1.m1.1.1.cmml" type="integer" xref="A4.T9.7.7.1.m1.1.1">1</cn><cn id="A4.T9.7.7.1.m1.2.2.cmml" type="integer" xref="A4.T9.7.7.1.m1.2.2">2</cn><cn id="A4.T9.7.7.1.m1.3.3.cmml" type="integer" xref="A4.T9.7.7.1.m1.3.3">3</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T9.7.7.1.m1.4c">\textrm{Uniform}\left(\left\{1,2,3\right\}\right)</annotation><annotation encoding="application/x-llamapun" id="A4.T9.7.7.1.m1.4d">Uniform ( { 1 , 2 , 3 } )</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A4.T9.7.9">
<td class="ltx_td ltx_align_left" id="A4.T9.7.9.1" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span class="ltx_text ltx_font_typewriter" id="A4.T9.7.9.1.1">compress_dims</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.7.9.2" style="padding-top:1.25pt;padding-bottom:1.25pt;">all</td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A4.T9.7.9.3" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span class="ltx_text ltx_font_typewriter" id="A4.T9.7.9.3.1">(hidden_dim,) * num_layers</span></td>
</tr>
<tr class="ltx_tr" id="A4.T9.7.10">
<td class="ltx_td ltx_align_left ltx_border_bb" id="A4.T9.7.10.1" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span class="ltx_text ltx_font_typewriter" id="A4.T9.7.10.1.1">decompress_dims</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T9.7.10.2" style="padding-top:1.25pt;padding-bottom:1.25pt;">all</td>
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb" id="A4.T9.7.10.3" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span class="ltx_text ltx_font_typewriter" id="A4.T9.7.10.3.1">(hidden_dim,) * num_layers</span></td>
</tr>
</table>
</figure>
</section>
<section class="ltx_subsubsection" id="A4.SS3.SSS7">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">D.3.7 </span>TabDDPM</h4>
<div class="ltx_para ltx_noindent" id="A4.SS3.SSS7.p1">
<p class="ltx_p" id="A4.SS3.SSS7.p1.1">We used the official implementation of TabDDPM<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/yandex-research/tab-ddpm" title="">https://github.com/yandex-research/tab-ddpm</a></span></span></span> adapted to use our datasets and validation setup.
To tune the hyperparameters of TabDDPM we use 50 trials of random search with the same search space that the original authors report in their paper <cite class="ltx_cite ltx_citemacro_citep">(Kotelnikov et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib19" title="">2023</a>)</cite>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="A4.SS3.SSS8">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">D.3.8 </span>Forest-Flow</h4>
<div class="ltx_para ltx_noindent" id="A4.SS3.SSS8.p1">
<p class="ltx_p" id="A4.SS3.SSS8.p1.1">We use the official implementation of Forest-Flow.<span class="ltx_note ltx_role_footnote" id="footnote4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/SamsungSAILMontreal/ForestDiffusion" title="">https://github.com/SamsungSAILMontreal/ForestDiffusion</a></span></span></span>
The only hyperparameters with impact on performance that the Forest-Flow documentation recommends tuning are the number of diffusion timesteps for which a recommended default value of 50 is offered and the number of noise values per sample for which the default value is 100.
Due to the fact that Forest-Flow models already take significantly longer to train than the other models, and that that increasing either value would lead to slower training we opted to use these default values.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="A4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.4 </span>Evaluation Setup</h3>
<section class="ltx_paragraph" id="A4.SS4.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Single variable inference</h5>
<div class="ltx_para ltx_noindent" id="A4.SS4.SSS0.Px1.p1">
<p class="ltx_p" id="A4.SS4.SSS0.Px1.p1.1">For the single variable inference evaluation, the best models are selected by their discriminative performance on a validation set.
The entire setup is repeated five times with different cross-validation folds and with different seeds for all sources of randomness.
For the Adult and MNIST datasets the test set is fixed but training and validation splits are still rotated.</p>
</div>
</section>
<section class="ltx_paragraph" id="A4.SS4.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Sampling</h5>
<div class="ltx_para ltx_noindent" id="A4.SS4.SSS0.Px2.p1">
<p class="ltx_p" id="A4.SS4.SSS0.Px2.p1.1">For the sampling evaluation we use a single train/validation/test split of the real data (corresponding to the first fold in the previous setup) for training the generative models.
The density models used are those previously selected based on their single variable inference performance on the validation set.
For TVAE and TabDDPM we directly evaluate their ML Efficiency using the validation data.</p>
</div>
</section>
<section class="ltx_paragraph" id="A4.SS4.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">ML Efficiency</h5>
<div class="ltx_para ltx_noindent" id="A4.SS4.SSS0.Px3.p1">
<p class="ltx_p" id="A4.SS4.SSS0.Px3.p1.1">For each selected model we sample a train and validation sets with the same number of samples as those used on the original data.
For NRGBoost we generate these samples by running 64 chains in parallel with 100 steps of burn in and downsampling their outputs by 30 (for the smaller datasets) or 10 (for MBNE, MNIST and CT).
For every synthetic dataset, an XGBoost model is trained using the best hyperparameters found on the real data and using a synthetic validation set to select the best stopping round for XGBoost.
The setup is repeated 5 times with different datasets being generated for each method and dataset.</p>
</div>
</section>
<section class="ltx_paragraph" id="A4.SS4.SSS0.Px4">
<h5 class="ltx_title ltx_title_paragraph">Discriminator Measure</h5>
<div class="ltx_para ltx_noindent" id="A4.SS4.SSS0.Px4.p1">
<p class="ltx_p" id="A4.SS4.SSS0.Px4.p1.1">We create the training, validation and test sets to train an XGBoost model to discriminate between real and generated data using the following process:</p>
<ul class="ltx_itemize" id="A4.I5">
<li class="ltx_item" id="A4.I5.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A4.I5.i1.p1">
<p class="ltx_p" id="A4.I5.i1.p1.1">The original validation set is used as the real part of the training set in order to avoid benefiting generative methods that overfit their training set.</p>
</div>
</li>
<li class="ltx_item" id="A4.I5.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A4.I5.i2.p1">
<p class="ltx_p" id="A4.I5.i2.p1.1">The original test set is split 20%/80%. The 20% portion is used as the real part of the validation set and the 80% portion as the real part of the test set.</p>
</div>
</li>
<li class="ltx_item" id="A4.I5.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A4.I5.i3.p1">
<p class="ltx_p" id="A4.I5.i3.p1.1">To form the synthetic part of the training, validation and test sets for the smaller datasets (AB, CH, PR, AD) we sample data according to the original number of samples in the train, validation and test splits on the real data respectively.
Note that this makes the ratio of real to synthetic data 1:4 in the training set. This is deliberate because for these smaller datasets the original validation has few samples and adding extra synthetic data helps the discriminator.</p>
</div>
</li>
<li class="ltx_item" id="A4.I5.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="A4.I5.i4.p1">
<p class="ltx_p" id="A4.I5.i4.p1.1">For the larger datasets (MBNE, MNIST, CT) we generate the same number of synthetic samples as there are real samples on each split, therefore making every ratio 1:1 because the discriminator is typically already too powerful without adding additional synthetic data.</p>
</div>
</li>
</ul>
<p class="ltx_p" id="A4.SS4.SSS0.Px4.p1.2">Because, in contrast to the previous metric, having a lower number of effective samples helps rather than hurts we take extra precautions to not generate correlated data with NRGBoost.
We draw each sample by running its own independent chain for 100 steps starting from an independent sample from the initial model which is a rather slow process.
The setup is repeated 5 times with 5 different sets of generated samples from each method.</p>
</div>
</section>
<section class="ltx_paragraph" id="A4.SS4.SSS0.Px5">
<h5 class="ltx_title ltx_title_paragraph">Statistical Distance Measure</h5>
<div class="ltx_para ltx_noindent" id="A4.SS4.SSS0.Px5.p1">
<p class="ltx_p" id="A4.SS4.SSS0.Px5.p1.1">We follow a procedure similar to <cite class="ltx_cite ltx_citemacro_citet">Jolicoeur-Martineau et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#bib.bib16" title="">2024</a>)</cite>.
We min-max scale the numerical variables, and one-hot encode the categorical variables and scale them by 1/2.
We use a <math alttext="L_{1}" class="ltx_Math" display="inline" id="A4.SS4.SSS0.Px5.p1.1.m1.1"><semantics id="A4.SS4.SSS0.Px5.p1.1.m1.1a"><msub id="A4.SS4.SSS0.Px5.p1.1.m1.1.1" xref="A4.SS4.SSS0.Px5.p1.1.m1.1.1.cmml"><mi id="A4.SS4.SSS0.Px5.p1.1.m1.1.1.2" xref="A4.SS4.SSS0.Px5.p1.1.m1.1.1.2.cmml">L</mi><mn id="A4.SS4.SSS0.Px5.p1.1.m1.1.1.3" xref="A4.SS4.SSS0.Px5.p1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A4.SS4.SSS0.Px5.p1.1.m1.1b"><apply id="A4.SS4.SSS0.Px5.p1.1.m1.1.1.cmml" xref="A4.SS4.SSS0.Px5.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A4.SS4.SSS0.Px5.p1.1.m1.1.1.1.cmml" xref="A4.SS4.SSS0.Px5.p1.1.m1.1.1">subscript</csymbol><ci id="A4.SS4.SSS0.Px5.p1.1.m1.1.1.2.cmml" xref="A4.SS4.SSS0.Px5.p1.1.m1.1.1.2">𝐿</ci><cn id="A4.SS4.SSS0.Px5.p1.1.m1.1.1.3.cmml" type="integer" xref="A4.SS4.SSS0.Px5.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS4.SSS0.Px5.p1.1.m1.1c">L_{1}</annotation><annotation encoding="application/x-llamapun" id="A4.SS4.SSS0.Px5.p1.1.m1.1d">italic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> distance in the formulation of the optimal transport problem and use the python <span class="ltx_text ltx_font_typewriter" id="A4.SS4.SSS0.Px5.p1.1.1">POT</span> library to solve it. We sub-sample a maximum of 5000 samples from the original train or test sets and use an equal number of synthetic samples, repeating each experiment 5 times.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="A4.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.5 </span>Computational Resources</h3>
<div class="ltx_para ltx_noindent" id="A4.SS5.p1">
<p class="ltx_p" id="A4.SS5.p1.1">The experiments were run on a machine equipped with an AMD Ryzen 7 7700X 8 core CPU and 32 GB of RAM.
The comparisons with TVAE and TabDDPM further made use of a GeForce RTX 3060 GPU with 12 GB of VRAM.</p>
</div>
</section>
</section>
<section class="ltx_appendix" id="A5">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Additional Results</h2>
<section class="ltx_subsection" id="A5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">E.1 </span>Computational Effort</h3>
<div class="ltx_para ltx_noindent" id="A5.SS1.p1">
<p class="ltx_p" id="A5.SS1.p1.1">In Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A5.F4" title="Figure 4 ‣ E.1 Computational Effort ‣ Appendix E Additional Results ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">4</span></a> we show the training times for NRGBoost as well as the other methods for the best model selected by hyperparameter tuning.
We do not report the training times for the RFDE method because it is virtually free when compared to the other methods since the splitting process is random and depends only on the input domain. The data itself is only required for computing leaf probabilities which is inexpensive.</p>
</div>
<div class="ltx_para ltx_noindent" id="A5.SS1.p2">
<p class="ltx_p" id="A5.SS1.p2.1">Note that the biggest computational cost for training a NRGBoost model is the Gibbs sampling (accounting for roughly 70% of the training time on average).
This could potentially be improved by leveraging higher parallelism than what we used in the experiments (16 virtual cores).</p>
</div>
<div class="ltx_para ltx_noindent" id="A5.SS1.p3">
<p class="ltx_p" id="A5.SS1.p3.1">We note also that we believe there is still plenty of margin for optimizing the tree-fitting code used for DEF models. As such, the results presented are merely indicative.</p>
</div>
<div class="ltx_para ltx_noindent" id="A5.SS1.p4">
<p class="ltx_p" id="A5.SS1.p4.1">The computational effort for fitting a tree-based model should scale linearly both in the number of samples and the number of features and this is the main source of variation for the training times between datasets.
However, we note that larger datasets can benefit more from larger models (e.g., with a larger number of leaves) which are also slower to train.</p>
</div>
<figure class="ltx_figure" id="A5.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="235" id="A5.F4.g1" src="x4.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Wall time required to train the best model for each method.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="A5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">E.2 </span>MCMC Chain Convergence on MNIST</h3>
<div class="ltx_para ltx_noindent" id="A5.SS2.p1">
<p class="ltx_p" id="A5.SS2.p1.1">In Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03535v1#A5.F5" title="Figure 5 ‣ E.2 MCMC Chain Convergence on MNIST ‣ Appendix E Additional Results ‣ NRGBoost: Energy-Based Generative Boosted Trees"><span class="ltx_text ltx_ref_tag">5</span></a> we show the convergence of a Gibbs sampler sampling from a NRGBoost model.
In only a few samples each chain appears to have converged to the data manifold after starting at a random sample from the initial model (a mixture between the product of training marginals and a uniform).
Note how consecutive samples are autocorrelated. In particular it can be rare for a chain to switch between two different modes of the distribution (e.g., switching digits) even though a few such transitions can be observed.</p>
</div>
<figure class="ltx_figure" id="A5.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="229" id="A5.F5.g1" src="x5.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Downsampled MNIST samples generated by Gibbs sampling from a NRGBoost model. Each row corresponds to an independent chain initialized with a sample from the initial model <math alttext="f_{0}" class="ltx_Math" display="inline" id="A5.F5.2.m1.1"><semantics id="A5.F5.2.m1.1b"><msub id="A5.F5.2.m1.1.1" xref="A5.F5.2.m1.1.1.cmml"><mi id="A5.F5.2.m1.1.1.2" xref="A5.F5.2.m1.1.1.2.cmml">f</mi><mn id="A5.F5.2.m1.1.1.3" xref="A5.F5.2.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="A5.F5.2.m1.1c"><apply id="A5.F5.2.m1.1.1.cmml" xref="A5.F5.2.m1.1.1"><csymbol cd="ambiguous" id="A5.F5.2.m1.1.1.1.cmml" xref="A5.F5.2.m1.1.1">subscript</csymbol><ci id="A5.F5.2.m1.1.1.2.cmml" xref="A5.F5.2.m1.1.1.2">𝑓</ci><cn id="A5.F5.2.m1.1.1.3.cmml" type="integer" xref="A5.F5.2.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.F5.2.m1.1d">f_{0}</annotation><annotation encoding="application/x-llamapun" id="A5.F5.2.m1.1e">italic_f start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> (first column). Each column represents a consecutive sample from the chain.</figcaption>
</figure>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Thu Oct  3 22:27:22 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
