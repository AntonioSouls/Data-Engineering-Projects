<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression</title>
<!--Generated on Wed Oct  2 14:27:48 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.03765v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#S1" title="In Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span><span class="ltx_text ltx_font_smallcaps">Introduction</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#S2" title="In Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span><span class="ltx_text ltx_font_smallcaps">Related Work</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#S2.SS0.SSS0.Px1" title="In 2 Related Work ‣ Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_title">Large Language Model Compression</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#S2.SS0.SSS0.Px2" title="In 2 Related Work ‣ Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_title">SVD-based Weight Compression</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#S2.SS0.SSS0.Px3" title="In 2 Related Work ‣ Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_title">Parameter Sharing</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#S3" title="In Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Methodology</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#S3.SS1" title="In 3 Methodology ‣ Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Representing Weight Matrices across Layers with Combinations of Basis Vectors and Coefficients</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#S3.SS2" title="In 3 Methodology ‣ Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Selection of Weight Matrices in LLMs for Cross-Layer Parameter Sharing</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#S3.SS3" title="In 3 Methodology ‣ Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Selection of Layers for Basis Sharing</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#S4" title="In Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span><span class="ltx_text ltx_font_smallcaps">Experiments</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#S4.SS1" title="In 4 Experiments ‣ Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span><span class="ltx_text ltx_font_smallcaps">Settings</span></span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#S4.SS1.SSS0.Px1" title="In 4.1 Settings ‣ 4 Experiments ‣ Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_title">Baseline</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#S4.SS1.SSS0.Px2" title="In 4.1 Settings ‣ 4 Experiments ‣ Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_title">Models and Datasets.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#S4.SS1.SSS0.Px3" title="In 4.1 Settings ‣ 4 Experiments ‣ Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_title">Implementation details</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#S4.SS2" title="In 4 Experiments ‣ Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span><span class="ltx_text ltx_font_smallcaps">Results</span></span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#S4.SS2.SSS0.Px1" title="In 4.2 Results ‣ 4 Experiments ‣ Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_title">Performance on Generation &amp; Reasoning Tasks</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#S4.SS2.SSS0.Px2" title="In 4.2 Results ‣ 4 Experiments ‣ Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_title">Performance on Different LLMs</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#S4.SS2.SSS0.Px3" title="In 4.2 Results ‣ 4 Experiments ‣ Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_title">Performance on LLMs with Various Scales</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#S4.SS2.SSS0.Px4" title="In 4.2 Results ‣ 4 Experiments ‣ Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_title">Performance with LoRA Fine-Tuning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#S4.SS2.SSS0.Px5" title="In 4.2 Results ‣ 4 Experiments ‣ Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_title">Comparison with Training from Scratch</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#S4.SS3" title="In 4 Experiments ‣ Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span><span class="ltx_text ltx_font_smallcaps">Impact of Layer Selection of Basis Sharing on LLM Performance</span></span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#S4.SS3.SSS0.Px1" title="In 4.3 Impact of Layer Selection of Basis Sharing on LLM Performance ‣ 4 Experiments ‣ Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_title">Impact on LLM Performance in Zero-Shot Setting</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#S4.SS3.SSS0.Px2" title="In 4.3 Impact of Layer Selection of Basis Sharing on LLM Performance ‣ 4 Experiments ‣ Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_title">Impact on LLM Performance with LoRA Fine-Tuning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#S4.SS3.SSS0.Px3" title="In 4.3 Impact of Layer Selection of Basis Sharing on LLM Performance ‣ 4 Experiments ‣ Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_title">Impact on LLM Peformance with Full Parameter Fine-Tuning</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#S4.SS4" title="In 4 Experiments ‣ Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Performance on Real Hardware</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#S5" title="In Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#A1" title="In Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Appendix</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#A1.SS1" title="In Appendix A Appendix ‣ Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Relation between compression ratio and number of basis vectors</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#A1.SS2" title="In Appendix A Appendix ‣ Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2 </span>Share Error Heat Map</span></a></li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">

Jingcun Wang
<br class="ltx_break"/>Technical University of Darmstadt
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id1.1.id1">jingcun.wang@tu-darmstadt.de</span>
&amp;Yu-Guang Chen
<br class="ltx_break"/>National Central University
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id2.2.id2">andyygchen@ee.ncu.edu.tw</span>
&amp;Ing-Chao Lin
<br class="ltx_break"/>National Cheng Kung University
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id3.3.id3">iclin@csie.ncku.edu.tw</span>
&amp;Bing Li
<br class="ltx_break"/>University of Siegen
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id4.4.id4">Bing.Li@uni-siegen.de</span>   &amp;Grace Li Zhang
<br class="ltx_break"/>Technical University of Darmstadt
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id5.5.id5">grace.zhang@tu-darmstadt.de</span>
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id6.id1">Large Language Models (LLMs) have achieved remarkable breakthroughs. However, the huge number of parameters in LLMs require significant amount of memory storage in inference, which prevents their practical deployment in many applications.
To reduce memory storage of LLMs, singular value decomposition (SVD) provides a promising solution to approximate weight matrices for compressing LLMs. In this paper, we take a step further to explore parameter sharing across different layers with SVD to achieve more effective compression for LLMs. Specifically, weight matrices in different layers are decomposed and represented as a linear combination of a set of shared basis vectors and unique coefficients. The types of weight matrices and the layer selection for basis sharing are examined when compressing LLMs to maintain the performance. Comprehensive experiments demonstrate that
Basis Sharing outperforms state-of-the-art SVD-based compression approaches and parameter sharing techniques, especially under large compression ratios. Code is available at: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/TUDa-HWAI/Basis_Sharing" title="">https://github.com/TUDa-HWAI/Basis_Sharing</a></p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span><span class="ltx_text ltx_font_smallcaps" id="S1.1.1">Introduction</span>
</h2>
<div class="ltx_para ltx_noindent" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Large Language Models (LLMs) have revolutionized natural language processing by enabling machines to understand human language more accurately. Although these models have remarkable capabilities, they are computation- and memory-intensive, making their deployment on resource-constrained devices challenging. To address this challenge, model compression has become a widely adopted technique to reduce model size and complexity.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Common compression techniques, such as model distillation <cite class="ltx_cite ltx_citemacro_citep">(Gu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib12" title="">2024</a>, Magister et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib23" title="">2023</a>, Jiang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib19" title="">2023b</a>, Huang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib16" title="">2022</a>, Qiu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib28" title="">2024</a>)</cite>,
pruning <cite class="ltx_cite ltx_citemacro_citep">(Frantar &amp; Alistarh, <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib9" title="">2023</a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib8" title="">2022</a>, Ma et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib22" title="">2023</a>, Sun et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib33" title="">2024</a>, Jiang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib18" title="">2024</a>, Petri et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib27" title="">2023</a>)</cite>,
and quantization <cite class="ltx_cite ltx_citemacro_citep">(Lin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib20" title="">2024</a>, Zhao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib48" title="">2024</a>, Ashkboos et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib2" title="">2024</a>, Xiao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib43" title="">2023</a>, Sun et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib34" title="">2023</a>)</cite>, early-exit <cite class="ltx_cite ltx_citemacro_citep">(Pan et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib26" title="">2024</a>, Wang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib40" title="">2024a</a>)</cite> etc. have been extensively studied.
While such techniques are effective in many scenarios, these methods often require hardware modification and expensive retraining. Compression techniques based on low-rank approximation with, e.g., Singular Value Decomposition (SVD) <cite class="ltx_cite ltx_citemacro_citep">(Yuan et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib45" title="">2023</a>, Hsu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib14" title="">2022</a>, Wang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib41" title="">2024b</a>)</cite>, provide a promising alternative since they are not restricted by such constraints. In SVD-based weight compression, a weight matrix in a layer is processed individually by decomposing it into three matrices. By removing small singular values in the decomposed diagonal matrix, the original weight matrix can be approximated with fewer number of weight values.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Despite the benefits of SVD-based weight compression, the potential of grouping layers for weight approximation and compression has not been explored thoroughly. Since weight matrices in different layers of an LLM might share similarity, parameter sharing across layers can be exploited to further compress weight matrices for LLMs. In sharing parameters across layers, <cite class="ltx_cite ltx_citemacro_citet">Hay &amp; Wolf (<a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib13" title="">2024</a>)</cite>
trained a small language model by restricting weight matrices in some layers to be the same. On the one hand, this brute-force method leads to significant performance degradation since weight matrices in different layers should vary to maintain their functionalities. On the other hand, it is impractical to train LLMs from scratch due to limited training data or high training costs.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">Contrary to previous work, in this paper, we use pretrained LLMs to enable weight matrices across layers to share a common set of basis vectors but still retain their different functionalities with unique coefficients. Our method, called Basis Sharing, can compress LLMs effectively.
In summary, our contributions are as follows:</p>
<ol class="ltx_enumerate" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para ltx_noindent" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We propose to represent weight matrices across different layers in a pretrained LLM with a linear combination of a set of shared basis vectors and coefficients unique to specific layers. This basis sharing can effectively reduce the number of parameters in LLMs while only affecting the performance of LLMs slightly.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para ltx_noindent" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We examine cross-layer basis sharing for different types of weight matrices in LLMs according to the incurred compression errors. The types of weight matrices whose sharing across layers does not incur significant compression error are selected for compressing LLMs.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para ltx_noindent" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">For the selected types of weight matrices, we also develop a criterion to group layers to share a set of basis vectors but have individual coefficients to
preserve the performance of LLMs.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">4.</span>
<div class="ltx_para ltx_noindent" id="S1.I1.i4.p1">
<p class="ltx_p" id="S1.I1.i4.p1.1">We conduct extensive experiments on a variety of LLMs, including the LLaMA family <cite class="ltx_cite ltx_citemacro_citep">(Touvron et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib37" title="">2023a</a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib38" title="">b</a>)</cite>, OPT-6.7B <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib47" title="">2022</a>)</cite>, Mistral-7B <cite class="ltx_cite ltx_citemacro_citep">(Jiang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib17" title="">2023a</a>)</cite>, and GPT-2 <cite class="ltx_cite ltx_citemacro_citep">(Radford et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib29" title="">2019</a>)</cite>. Our Basis Sharing can surpasses the state-of-the-art SVD-based methods in both generation tasks and downstream reasoning tasks without any fine-tuning under compression ratios from 20% to 50%. Specifically, compared with state-of-the-art SVD-based compression approaches, Basis Sharing can further reduce the perplexity by up to 25% on generation tasks and improve accuracy by up to 4% on downstream reasoning tasks under the same compression ratio.</p>
</div>
</li>
</ol>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span><span class="ltx_text ltx_font_smallcaps" id="S2.1.1">Related Work</span>
</h2>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Large Language Model Compression</h4>
<div class="ltx_para ltx_noindent" id="S2.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px1.p1.1">LLM compression techniques include model distillation, pruning and quantization, etc.
<cite class="ltx_cite ltx_citemacro_citet">Gu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib12" title="">2024</a>), Huang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib16" title="">2022</a>), Magister et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib23" title="">2023</a>), Jiang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib19" title="">2023b</a>)</cite> successfully applied model distillation to LLM by retraining,
which incurs high computational cost.
<cite class="ltx_cite ltx_citemacro_citet">Frantar &amp; Alistarh (<a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib9" title="">2023</a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib8" title="">2022</a>), Sun et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib33" title="">2024</a>), Ma et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib22" title="">2023</a>)</cite> pruned weights that are less sensitive to outliers. However,
the resulting unstructured weight matrices do not provide meaningful compression benefits on real hardware. Structured pruning techniques, such as 2:4 or 4:8 pruning, can achieve effective compression but restrict a fixed 50% pruning ratio, which limits flexibility in balancing performance and compression ratio.
<cite class="ltx_cite ltx_citemacro_citet">Zhao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib48" title="">2024</a>), Ashkboos et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib2" title="">2024</a>), Lin et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib20" title="">2024</a>), Xiao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib43" title="">2023</a>)</cite>
allocated higher quantization bits to weights with larger influence on outliers,
but it does not reduce the number of parameters, limiting its impact on overall compression.</p>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">SVD-based Weight Compression</h4>
<div class="ltx_para ltx_noindent" id="S2.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px2.p1.1">SVD-based weight compression has a flexible compression ratio to maintain performance without retraining.
<cite class="ltx_cite ltx_citemacro_citet">Golub et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib11" title="">1987</a>)</cite> were the first to apply SVD for neural network compression, and <cite class="ltx_cite ltx_citemacro_citet">Lv et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib21" title="">2023</a>), Wu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib42" title="">2023</a>)</cite> extended this approach to shallow transformer models <cite class="ltx_cite ltx_citemacro_citep">(Vaswani, <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib39" title="">2017</a>)</cite>. However, in LLM compression, these methods incur significant errors since they do not consider outliers in activations.
FWSVD <cite class="ltx_cite ltx_citemacro_citep">(Hsu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib14" title="">2022</a>)</cite> addresses this issue by incorporating the impact of outliers through the Fisher information analysis of weight matrices. However, this method requires gradient information during training process, which is computationally prohibitive for LLMs.
ASVD <cite class="ltx_cite ltx_citemacro_citep">(Yuan et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib45" title="">2023</a>)</cite> alleviates this problem by selecting key channels in the weight matrix based on their sensitivity to outliers and minimizing compression error in these channels. While it avoids the need for gradients, ASVD still lacks a direct connection between SVD truncation error and the overall model compression error.
SVD-LLM <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib41" title="">2024b</a>)</cite> improves this by introducing a whitening matrix that captures outlier information, effectively reducing compression error.
<span class="ltx_text ltx_font_italic" id="S2.SS0.SSS0.Px2.p1.1.1">However, all of these methods focus only on compressing individual weight matrices within a single layer, missing the opportunity to exploit weight compression across multiple layers. </span></p>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">Parameter Sharing</h4>
<div class="ltx_para ltx_noindent" id="S2.SS0.SSS0.Px3.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px3.p1.1">Parameter sharing reduces model size by reusing weight matrices across different layers. Inspired by recurrent neural networks, <cite class="ltx_cite ltx_citemacro_citet">Dehghani et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib7" title="">2019</a>)</cite> explored this concept within transformers by restricting all layers in the encoder and decoder to share the same weights. Similarly, <cite class="ltx_cite ltx_citemacro_citet">Reid et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib31" title="">2021</a>)</cite> divided transformer parameters into two groups (attention-related and feedforward-related) and compressed the model by sharing weights within each group.
<cite class="ltx_cite ltx_citemacro_citet">Takase &amp; Kiyono (<a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib35" title="">2021</a>)</cite> applied selective weight sharing, where specific layers shared the same weights rather than all layers. Beyond direct weight sharing, <cite class="ltx_cite ltx_citemacro_citet">Xiao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib44" title="">2019</a>), Bhojanapalli et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib4" title="">2021</a>)</cite> introduced the idea of sharing attention scores between layers. By reusing attention scores, some weight matrices for attention computation could be discarded. Dynamic Tying <cite class="ltx_cite ltx_citemacro_citep">(Hay &amp; Wolf, <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib13" title="">2024</a>)</cite> determines layer-wise weight sharing during training using reinforcement learning, which is still time-consuming for large LLMs.
<span class="ltx_text ltx_font_italic" id="S2.SS0.SSS0.Px3.p1.1.1">All of these approaches have been tested only on smaller transformer models and typically require training from scratch or full parameter fine-tuning, which makes them impractical for LLMs. </span></p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methodology</h2>
<figure class="ltx_figure ltx_align_floatright" id="S3.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="421" id="S3.F1.g1" src="x1.png" width="829"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>
(a) Two layers share the same weight matrix in previous work. (b) Two layers share the same basis matrix but have their individual coefficients in our work.
</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">Contrary to the previous techniques that require training from scratch and weights in some layers are restricted to be the same during training,
we adopt a pretrained LLM to explore
representing weights across different layers with combinations of a set of shared basis vectors and individual coefficients. Since the set of basis vectors can be shared across several layers, the number of parameters in the LLM can thus be reduced effectively. The difference between the previous weight sharing method and our Basis Sharing is illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#S3.F1" title="Figure 1 ‣ 3 Methodology ‣ Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.p2">
<p class="ltx_p" id="S3.p2.1">To exploit the cross-layer parameter sharing to compress LLMs, the subsequent subsections address the following challenges: 1) What methodologies can be used to process the weight matrices across layers in an LLM to determine a set of shared basis vectors and individual coefficients? 2) Which types of weight matrices across layers in an LLM can take advantage of parameter sharing without affecting its performance significantly? 3) Which layers can share a set of basis vectors in an LLM without affecting its performance significantly?</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Representing Weight Matrices across Layers with Combinations of Basis Vectors and Coefficients</h3>
<div class="ltx_para ltx_noindent" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.7">Suppose that we have weight matrices across <math alttext="n" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">italic_n</annotation></semantics></math> layers, denoted as <math alttext="\displaystyle\displaystyle{\bm{W}}^{(1)}\dots\displaystyle{\bm{W}}^{(n)},%
\displaystyle{\bm{W}}^{(i)}\in\mathbb{R}^{d_{1}\times d_{2}}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.5"><semantics id="S3.SS1.p1.2.m2.5a"><mrow id="S3.SS1.p1.2.m2.5.5" xref="S3.SS1.p1.2.m2.5.5.cmml"><mrow id="S3.SS1.p1.2.m2.5.5.2.2" xref="S3.SS1.p1.2.m2.5.5.2.3.cmml"><mrow id="S3.SS1.p1.2.m2.4.4.1.1.1" xref="S3.SS1.p1.2.m2.4.4.1.1.1.cmml"><msup id="S3.SS1.p1.2.m2.4.4.1.1.1.2" xref="S3.SS1.p1.2.m2.4.4.1.1.1.2.cmml"><mi id="S3.SS1.p1.2.m2.4.4.1.1.1.2.2" xref="S3.SS1.p1.2.m2.4.4.1.1.1.2.2.cmml">𝑾</mi><mrow id="S3.SS1.p1.2.m2.1.1.1.3" xref="S3.SS1.p1.2.m2.4.4.1.1.1.2.cmml"><mo id="S3.SS1.p1.2.m2.1.1.1.3.1" stretchy="false" xref="S3.SS1.p1.2.m2.4.4.1.1.1.2.cmml">(</mo><mn id="S3.SS1.p1.2.m2.1.1.1.1" xref="S3.SS1.p1.2.m2.1.1.1.1.cmml">1</mn><mo id="S3.SS1.p1.2.m2.1.1.1.3.2" stretchy="false" xref="S3.SS1.p1.2.m2.4.4.1.1.1.2.cmml">)</mo></mrow></msup><mo id="S3.SS1.p1.2.m2.4.4.1.1.1.1" xref="S3.SS1.p1.2.m2.4.4.1.1.1.1.cmml">⁢</mo><mi id="S3.SS1.p1.2.m2.4.4.1.1.1.3" mathvariant="normal" xref="S3.SS1.p1.2.m2.4.4.1.1.1.3.cmml">…</mi><mo id="S3.SS1.p1.2.m2.4.4.1.1.1.1a" xref="S3.SS1.p1.2.m2.4.4.1.1.1.1.cmml">⁢</mo><msup id="S3.SS1.p1.2.m2.4.4.1.1.1.4" xref="S3.SS1.p1.2.m2.4.4.1.1.1.4.cmml"><mi id="S3.SS1.p1.2.m2.4.4.1.1.1.4.2" xref="S3.SS1.p1.2.m2.4.4.1.1.1.4.2.cmml">𝑾</mi><mrow id="S3.SS1.p1.2.m2.2.2.1.3" xref="S3.SS1.p1.2.m2.4.4.1.1.1.4.cmml"><mo id="S3.SS1.p1.2.m2.2.2.1.3.1" stretchy="false" xref="S3.SS1.p1.2.m2.4.4.1.1.1.4.cmml">(</mo><mi id="S3.SS1.p1.2.m2.2.2.1.1" xref="S3.SS1.p1.2.m2.2.2.1.1.cmml">n</mi><mo id="S3.SS1.p1.2.m2.2.2.1.3.2" stretchy="false" xref="S3.SS1.p1.2.m2.4.4.1.1.1.4.cmml">)</mo></mrow></msup></mrow><mo id="S3.SS1.p1.2.m2.5.5.2.2.3" xref="S3.SS1.p1.2.m2.5.5.2.3.cmml">,</mo><msup id="S3.SS1.p1.2.m2.5.5.2.2.2" xref="S3.SS1.p1.2.m2.5.5.2.2.2.cmml"><mi id="S3.SS1.p1.2.m2.5.5.2.2.2.2" xref="S3.SS1.p1.2.m2.5.5.2.2.2.2.cmml">𝑾</mi><mrow id="S3.SS1.p1.2.m2.3.3.1.3" xref="S3.SS1.p1.2.m2.5.5.2.2.2.cmml"><mo id="S3.SS1.p1.2.m2.3.3.1.3.1" stretchy="false" xref="S3.SS1.p1.2.m2.5.5.2.2.2.cmml">(</mo><mi id="S3.SS1.p1.2.m2.3.3.1.1" xref="S3.SS1.p1.2.m2.3.3.1.1.cmml">i</mi><mo id="S3.SS1.p1.2.m2.3.3.1.3.2" stretchy="false" xref="S3.SS1.p1.2.m2.5.5.2.2.2.cmml">)</mo></mrow></msup></mrow><mo id="S3.SS1.p1.2.m2.5.5.3" xref="S3.SS1.p1.2.m2.5.5.3.cmml">∈</mo><msup id="S3.SS1.p1.2.m2.5.5.4" xref="S3.SS1.p1.2.m2.5.5.4.cmml"><mi id="S3.SS1.p1.2.m2.5.5.4.2" xref="S3.SS1.p1.2.m2.5.5.4.2.cmml">ℝ</mi><mrow id="S3.SS1.p1.2.m2.5.5.4.3" xref="S3.SS1.p1.2.m2.5.5.4.3.cmml"><msub id="S3.SS1.p1.2.m2.5.5.4.3.2" xref="S3.SS1.p1.2.m2.5.5.4.3.2.cmml"><mi id="S3.SS1.p1.2.m2.5.5.4.3.2.2" xref="S3.SS1.p1.2.m2.5.5.4.3.2.2.cmml">d</mi><mn id="S3.SS1.p1.2.m2.5.5.4.3.2.3" xref="S3.SS1.p1.2.m2.5.5.4.3.2.3.cmml">1</mn></msub><mo id="S3.SS1.p1.2.m2.5.5.4.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.2.m2.5.5.4.3.1.cmml">×</mo><msub id="S3.SS1.p1.2.m2.5.5.4.3.3" xref="S3.SS1.p1.2.m2.5.5.4.3.3.cmml"><mi id="S3.SS1.p1.2.m2.5.5.4.3.3.2" xref="S3.SS1.p1.2.m2.5.5.4.3.3.2.cmml">d</mi><mn id="S3.SS1.p1.2.m2.5.5.4.3.3.3" xref="S3.SS1.p1.2.m2.5.5.4.3.3.3.cmml">2</mn></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.5b"><apply id="S3.SS1.p1.2.m2.5.5.cmml" xref="S3.SS1.p1.2.m2.5.5"><in id="S3.SS1.p1.2.m2.5.5.3.cmml" xref="S3.SS1.p1.2.m2.5.5.3"></in><list id="S3.SS1.p1.2.m2.5.5.2.3.cmml" xref="S3.SS1.p1.2.m2.5.5.2.2"><apply id="S3.SS1.p1.2.m2.4.4.1.1.1.cmml" xref="S3.SS1.p1.2.m2.4.4.1.1.1"><times id="S3.SS1.p1.2.m2.4.4.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.4.4.1.1.1.1"></times><apply id="S3.SS1.p1.2.m2.4.4.1.1.1.2.cmml" xref="S3.SS1.p1.2.m2.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.4.4.1.1.1.2.1.cmml" xref="S3.SS1.p1.2.m2.4.4.1.1.1.2">superscript</csymbol><ci id="S3.SS1.p1.2.m2.4.4.1.1.1.2.2.cmml" xref="S3.SS1.p1.2.m2.4.4.1.1.1.2.2">𝑾</ci><cn id="S3.SS1.p1.2.m2.1.1.1.1.cmml" type="integer" xref="S3.SS1.p1.2.m2.1.1.1.1">1</cn></apply><ci id="S3.SS1.p1.2.m2.4.4.1.1.1.3.cmml" xref="S3.SS1.p1.2.m2.4.4.1.1.1.3">…</ci><apply id="S3.SS1.p1.2.m2.4.4.1.1.1.4.cmml" xref="S3.SS1.p1.2.m2.4.4.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.4.4.1.1.1.4.1.cmml" xref="S3.SS1.p1.2.m2.4.4.1.1.1.4">superscript</csymbol><ci id="S3.SS1.p1.2.m2.4.4.1.1.1.4.2.cmml" xref="S3.SS1.p1.2.m2.4.4.1.1.1.4.2">𝑾</ci><ci id="S3.SS1.p1.2.m2.2.2.1.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1">𝑛</ci></apply></apply><apply id="S3.SS1.p1.2.m2.5.5.2.2.2.cmml" xref="S3.SS1.p1.2.m2.5.5.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.5.5.2.2.2.1.cmml" xref="S3.SS1.p1.2.m2.5.5.2.2.2">superscript</csymbol><ci id="S3.SS1.p1.2.m2.5.5.2.2.2.2.cmml" xref="S3.SS1.p1.2.m2.5.5.2.2.2.2">𝑾</ci><ci id="S3.SS1.p1.2.m2.3.3.1.1.cmml" xref="S3.SS1.p1.2.m2.3.3.1.1">𝑖</ci></apply></list><apply id="S3.SS1.p1.2.m2.5.5.4.cmml" xref="S3.SS1.p1.2.m2.5.5.4"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.5.5.4.1.cmml" xref="S3.SS1.p1.2.m2.5.5.4">superscript</csymbol><ci id="S3.SS1.p1.2.m2.5.5.4.2.cmml" xref="S3.SS1.p1.2.m2.5.5.4.2">ℝ</ci><apply id="S3.SS1.p1.2.m2.5.5.4.3.cmml" xref="S3.SS1.p1.2.m2.5.5.4.3"><times id="S3.SS1.p1.2.m2.5.5.4.3.1.cmml" xref="S3.SS1.p1.2.m2.5.5.4.3.1"></times><apply id="S3.SS1.p1.2.m2.5.5.4.3.2.cmml" xref="S3.SS1.p1.2.m2.5.5.4.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.5.5.4.3.2.1.cmml" xref="S3.SS1.p1.2.m2.5.5.4.3.2">subscript</csymbol><ci id="S3.SS1.p1.2.m2.5.5.4.3.2.2.cmml" xref="S3.SS1.p1.2.m2.5.5.4.3.2.2">𝑑</ci><cn id="S3.SS1.p1.2.m2.5.5.4.3.2.3.cmml" type="integer" xref="S3.SS1.p1.2.m2.5.5.4.3.2.3">1</cn></apply><apply id="S3.SS1.p1.2.m2.5.5.4.3.3.cmml" xref="S3.SS1.p1.2.m2.5.5.4.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.5.5.4.3.3.1.cmml" xref="S3.SS1.p1.2.m2.5.5.4.3.3">subscript</csymbol><ci id="S3.SS1.p1.2.m2.5.5.4.3.3.2.cmml" xref="S3.SS1.p1.2.m2.5.5.4.3.3.2">𝑑</ci><cn id="S3.SS1.p1.2.m2.5.5.4.3.3.3.cmml" type="integer" xref="S3.SS1.p1.2.m2.5.5.4.3.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.5c">\displaystyle\displaystyle{\bm{W}}^{(1)}\dots\displaystyle{\bm{W}}^{(n)},%
\displaystyle{\bm{W}}^{(i)}\in\mathbb{R}^{d_{1}\times d_{2}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.5d">bold_italic_W start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT … bold_italic_W start_POSTSUPERSCRIPT ( italic_n ) end_POSTSUPERSCRIPT , bold_italic_W start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT × italic_d start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>. To derive a set of shared basis vectors and coefficients to represent such weight matrices, intuitively, such matrices can be horizontally concatenated into one matrix, denoted as <math alttext="\displaystyle{\bm{W}}\in\mathbb{R}^{d_{1}\times nd_{2}}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><mrow id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><mi id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">𝑾</mi><mo id="S3.SS1.p1.3.m3.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml"><mi id="S3.SS1.p1.3.m3.1.1.3.2" xref="S3.SS1.p1.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p1.3.m3.1.1.3.3" xref="S3.SS1.p1.3.m3.1.1.3.3.cmml"><mrow id="S3.SS1.p1.3.m3.1.1.3.3.2" xref="S3.SS1.p1.3.m3.1.1.3.3.2.cmml"><msub id="S3.SS1.p1.3.m3.1.1.3.3.2.2" xref="S3.SS1.p1.3.m3.1.1.3.3.2.2.cmml"><mi id="S3.SS1.p1.3.m3.1.1.3.3.2.2.2" xref="S3.SS1.p1.3.m3.1.1.3.3.2.2.2.cmml">d</mi><mn id="S3.SS1.p1.3.m3.1.1.3.3.2.2.3" xref="S3.SS1.p1.3.m3.1.1.3.3.2.2.3.cmml">1</mn></msub><mo id="S3.SS1.p1.3.m3.1.1.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.3.m3.1.1.3.3.2.1.cmml">×</mo><mi id="S3.SS1.p1.3.m3.1.1.3.3.2.3" xref="S3.SS1.p1.3.m3.1.1.3.3.2.3.cmml">n</mi></mrow><mo id="S3.SS1.p1.3.m3.1.1.3.3.1" xref="S3.SS1.p1.3.m3.1.1.3.3.1.cmml">⁢</mo><msub id="S3.SS1.p1.3.m3.1.1.3.3.3" xref="S3.SS1.p1.3.m3.1.1.3.3.3.cmml"><mi id="S3.SS1.p1.3.m3.1.1.3.3.3.2" xref="S3.SS1.p1.3.m3.1.1.3.3.3.2.cmml">d</mi><mn id="S3.SS1.p1.3.m3.1.1.3.3.3.3" xref="S3.SS1.p1.3.m3.1.1.3.3.3.3.cmml">2</mn></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><in id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1"></in><ci id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2">𝑾</ci><apply id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.3.1.cmml" xref="S3.SS1.p1.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.3.2.cmml" xref="S3.SS1.p1.3.m3.1.1.3.2">ℝ</ci><apply id="S3.SS1.p1.3.m3.1.1.3.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3"><times id="S3.SS1.p1.3.m3.1.1.3.3.1.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3.1"></times><apply id="S3.SS1.p1.3.m3.1.1.3.3.2.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3.2"><times id="S3.SS1.p1.3.m3.1.1.3.3.2.1.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3.2.1"></times><apply id="S3.SS1.p1.3.m3.1.1.3.3.2.2.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.3.3.2.2.1.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3.2.2">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.3.3.2.2.2.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3.2.2.2">𝑑</ci><cn id="S3.SS1.p1.3.m3.1.1.3.3.2.2.3.cmml" type="integer" xref="S3.SS1.p1.3.m3.1.1.3.3.2.2.3">1</cn></apply><ci id="S3.SS1.p1.3.m3.1.1.3.3.2.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3.2.3">𝑛</ci></apply><apply id="S3.SS1.p1.3.m3.1.1.3.3.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.3.3.3.1.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.3.3.3.2.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3.3.2">𝑑</ci><cn id="S3.SS1.p1.3.m3.1.1.3.3.3.3.cmml" type="integer" xref="S3.SS1.p1.3.m3.1.1.3.3.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">\displaystyle{\bm{W}}\in\mathbb{R}^{d_{1}\times nd_{2}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">bold_italic_W ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT × italic_n italic_d start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, and singular value decomposition (SVD) can be applied to decompose this matrix into three matrices: <math alttext="{\bm{U}},{\bm{\Sigma}},{\bm{V}}^{T}" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.3"><semantics id="S3.SS1.p1.4.m4.3a"><mrow id="S3.SS1.p1.4.m4.3.3.1" xref="S3.SS1.p1.4.m4.3.3.2.cmml"><mi id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">𝑼</mi><mo id="S3.SS1.p1.4.m4.3.3.1.2" xref="S3.SS1.p1.4.m4.3.3.2.cmml">,</mo><mi id="S3.SS1.p1.4.m4.2.2" xref="S3.SS1.p1.4.m4.2.2.cmml">𝚺</mi><mo id="S3.SS1.p1.4.m4.3.3.1.3" xref="S3.SS1.p1.4.m4.3.3.2.cmml">,</mo><msup id="S3.SS1.p1.4.m4.3.3.1.1" xref="S3.SS1.p1.4.m4.3.3.1.1.cmml"><mi id="S3.SS1.p1.4.m4.3.3.1.1.2" xref="S3.SS1.p1.4.m4.3.3.1.1.2.cmml">𝑽</mi><mi id="S3.SS1.p1.4.m4.3.3.1.1.3" xref="S3.SS1.p1.4.m4.3.3.1.1.3.cmml">T</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.3b"><list id="S3.SS1.p1.4.m4.3.3.2.cmml" xref="S3.SS1.p1.4.m4.3.3.1"><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">𝑼</ci><ci id="S3.SS1.p1.4.m4.2.2.cmml" xref="S3.SS1.p1.4.m4.2.2">𝚺</ci><apply id="S3.SS1.p1.4.m4.3.3.1.1.cmml" xref="S3.SS1.p1.4.m4.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.3.3.1.1.1.cmml" xref="S3.SS1.p1.4.m4.3.3.1.1">superscript</csymbol><ci id="S3.SS1.p1.4.m4.3.3.1.1.2.cmml" xref="S3.SS1.p1.4.m4.3.3.1.1.2">𝑽</ci><ci id="S3.SS1.p1.4.m4.3.3.1.1.3.cmml" xref="S3.SS1.p1.4.m4.3.3.1.1.3">𝑇</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.3c">{\bm{U}},{\bm{\Sigma}},{\bm{V}}^{T}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.3d">bold_italic_U , bold_Σ , bold_italic_V start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math>. <math alttext="{\bm{\Sigma}}" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.1"><semantics id="S3.SS1.p1.5.m5.1a"><mi id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">𝚺</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">𝚺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">{\bm{\Sigma}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.1d">bold_Σ</annotation></semantics></math> is a <math alttext="d_{1}\times nd_{2}" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m6.1"><semantics id="S3.SS1.p1.6.m6.1a"><mrow id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml"><mrow id="S3.SS1.p1.6.m6.1.1.2" xref="S3.SS1.p1.6.m6.1.1.2.cmml"><msub id="S3.SS1.p1.6.m6.1.1.2.2" xref="S3.SS1.p1.6.m6.1.1.2.2.cmml"><mi id="S3.SS1.p1.6.m6.1.1.2.2.2" xref="S3.SS1.p1.6.m6.1.1.2.2.2.cmml">d</mi><mn id="S3.SS1.p1.6.m6.1.1.2.2.3" xref="S3.SS1.p1.6.m6.1.1.2.2.3.cmml">1</mn></msub><mo id="S3.SS1.p1.6.m6.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.6.m6.1.1.2.1.cmml">×</mo><mi id="S3.SS1.p1.6.m6.1.1.2.3" xref="S3.SS1.p1.6.m6.1.1.2.3.cmml">n</mi></mrow><mo id="S3.SS1.p1.6.m6.1.1.1" xref="S3.SS1.p1.6.m6.1.1.1.cmml">⁢</mo><msub id="S3.SS1.p1.6.m6.1.1.3" xref="S3.SS1.p1.6.m6.1.1.3.cmml"><mi id="S3.SS1.p1.6.m6.1.1.3.2" xref="S3.SS1.p1.6.m6.1.1.3.2.cmml">d</mi><mn id="S3.SS1.p1.6.m6.1.1.3.3" xref="S3.SS1.p1.6.m6.1.1.3.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1"><times id="S3.SS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1"></times><apply id="S3.SS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2"><times id="S3.SS1.p1.6.m6.1.1.2.1.cmml" xref="S3.SS1.p1.6.m6.1.1.2.1"></times><apply id="S3.SS1.p1.6.m6.1.1.2.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.2.2.1.cmml" xref="S3.SS1.p1.6.m6.1.1.2.2">subscript</csymbol><ci id="S3.SS1.p1.6.m6.1.1.2.2.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2.2.2">𝑑</ci><cn id="S3.SS1.p1.6.m6.1.1.2.2.3.cmml" type="integer" xref="S3.SS1.p1.6.m6.1.1.2.2.3">1</cn></apply><ci id="S3.SS1.p1.6.m6.1.1.2.3.cmml" xref="S3.SS1.p1.6.m6.1.1.2.3">𝑛</ci></apply><apply id="S3.SS1.p1.6.m6.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.3.1.cmml" xref="S3.SS1.p1.6.m6.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.6.m6.1.1.3.2.cmml" xref="S3.SS1.p1.6.m6.1.1.3.2">𝑑</ci><cn id="S3.SS1.p1.6.m6.1.1.3.3.cmml" type="integer" xref="S3.SS1.p1.6.m6.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">d_{1}\times nd_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m6.1d">italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT × italic_n italic_d start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> diagonal matrix consisting of singular values of <math alttext="\displaystyle{\bm{W}}" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m7.1"><semantics id="S3.SS1.p1.7.m7.1a"><mi id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">𝑾</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><ci id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">𝑾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">\displaystyle{\bm{W}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m7.1d">bold_italic_W</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.26">By selecting the top <math alttext="k" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">italic_k</annotation></semantics></math> singular values in <math alttext="\displaystyle{\bm{\Sigma}}" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><mi id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">𝚺</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">𝚺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">\displaystyle{\bm{\Sigma}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">bold_Σ</annotation></semantics></math>, <math alttext="\displaystyle{\bm{W}}" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.1"><semantics id="S3.SS1.p2.3.m3.1a"><mi id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">𝑾</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">𝑾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">\displaystyle{\bm{W}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.1d">bold_italic_W</annotation></semantics></math> can be approximated as <math alttext="\displaystyle{\bm{W}}\approx\displaystyle{\bm{W}}_{k}={\bm{U}}_{k}{\bm{\Sigma}%
}_{k}{\bm{V}}^{T}_{k}" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m4.1"><semantics id="S3.SS1.p2.4.m4.1a"><mrow id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml"><mi id="S3.SS1.p2.4.m4.1.1.2" xref="S3.SS1.p2.4.m4.1.1.2.cmml">𝑾</mi><mo id="S3.SS1.p2.4.m4.1.1.3" xref="S3.SS1.p2.4.m4.1.1.3.cmml">≈</mo><msub id="S3.SS1.p2.4.m4.1.1.4" xref="S3.SS1.p2.4.m4.1.1.4.cmml"><mi id="S3.SS1.p2.4.m4.1.1.4.2" xref="S3.SS1.p2.4.m4.1.1.4.2.cmml">𝑾</mi><mi id="S3.SS1.p2.4.m4.1.1.4.3" xref="S3.SS1.p2.4.m4.1.1.4.3.cmml">k</mi></msub><mo id="S3.SS1.p2.4.m4.1.1.5" xref="S3.SS1.p2.4.m4.1.1.5.cmml">=</mo><mrow id="S3.SS1.p2.4.m4.1.1.6" xref="S3.SS1.p2.4.m4.1.1.6.cmml"><msub id="S3.SS1.p2.4.m4.1.1.6.2" xref="S3.SS1.p2.4.m4.1.1.6.2.cmml"><mi id="S3.SS1.p2.4.m4.1.1.6.2.2" xref="S3.SS1.p2.4.m4.1.1.6.2.2.cmml">𝑼</mi><mi id="S3.SS1.p2.4.m4.1.1.6.2.3" xref="S3.SS1.p2.4.m4.1.1.6.2.3.cmml">k</mi></msub><mo id="S3.SS1.p2.4.m4.1.1.6.1" xref="S3.SS1.p2.4.m4.1.1.6.1.cmml">⁢</mo><msub id="S3.SS1.p2.4.m4.1.1.6.3" xref="S3.SS1.p2.4.m4.1.1.6.3.cmml"><mi id="S3.SS1.p2.4.m4.1.1.6.3.2" xref="S3.SS1.p2.4.m4.1.1.6.3.2.cmml">𝚺</mi><mi id="S3.SS1.p2.4.m4.1.1.6.3.3" xref="S3.SS1.p2.4.m4.1.1.6.3.3.cmml">k</mi></msub><mo id="S3.SS1.p2.4.m4.1.1.6.1a" xref="S3.SS1.p2.4.m4.1.1.6.1.cmml">⁢</mo><msubsup id="S3.SS1.p2.4.m4.1.1.6.4" xref="S3.SS1.p2.4.m4.1.1.6.4.cmml"><mi id="S3.SS1.p2.4.m4.1.1.6.4.2.2" xref="S3.SS1.p2.4.m4.1.1.6.4.2.2.cmml">𝑽</mi><mi id="S3.SS1.p2.4.m4.1.1.6.4.3" xref="S3.SS1.p2.4.m4.1.1.6.4.3.cmml">k</mi><mi id="S3.SS1.p2.4.m4.1.1.6.4.2.3" xref="S3.SS1.p2.4.m4.1.1.6.4.2.3.cmml">T</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><apply id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1"><and id="S3.SS1.p2.4.m4.1.1a.cmml" xref="S3.SS1.p2.4.m4.1.1"></and><apply id="S3.SS1.p2.4.m4.1.1b.cmml" xref="S3.SS1.p2.4.m4.1.1"><approx id="S3.SS1.p2.4.m4.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3"></approx><ci id="S3.SS1.p2.4.m4.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.2">𝑾</ci><apply id="S3.SS1.p2.4.m4.1.1.4.cmml" xref="S3.SS1.p2.4.m4.1.1.4"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.4.1.cmml" xref="S3.SS1.p2.4.m4.1.1.4">subscript</csymbol><ci id="S3.SS1.p2.4.m4.1.1.4.2.cmml" xref="S3.SS1.p2.4.m4.1.1.4.2">𝑾</ci><ci id="S3.SS1.p2.4.m4.1.1.4.3.cmml" xref="S3.SS1.p2.4.m4.1.1.4.3">𝑘</ci></apply></apply><apply id="S3.SS1.p2.4.m4.1.1c.cmml" xref="S3.SS1.p2.4.m4.1.1"><eq id="S3.SS1.p2.4.m4.1.1.5.cmml" xref="S3.SS1.p2.4.m4.1.1.5"></eq><share href="https://arxiv.org/html/2410.03765v1#S3.SS1.p2.4.m4.1.1.4.cmml" id="S3.SS1.p2.4.m4.1.1d.cmml" xref="S3.SS1.p2.4.m4.1.1"></share><apply id="S3.SS1.p2.4.m4.1.1.6.cmml" xref="S3.SS1.p2.4.m4.1.1.6"><times id="S3.SS1.p2.4.m4.1.1.6.1.cmml" xref="S3.SS1.p2.4.m4.1.1.6.1"></times><apply id="S3.SS1.p2.4.m4.1.1.6.2.cmml" xref="S3.SS1.p2.4.m4.1.1.6.2"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.6.2.1.cmml" xref="S3.SS1.p2.4.m4.1.1.6.2">subscript</csymbol><ci id="S3.SS1.p2.4.m4.1.1.6.2.2.cmml" xref="S3.SS1.p2.4.m4.1.1.6.2.2">𝑼</ci><ci id="S3.SS1.p2.4.m4.1.1.6.2.3.cmml" xref="S3.SS1.p2.4.m4.1.1.6.2.3">𝑘</ci></apply><apply id="S3.SS1.p2.4.m4.1.1.6.3.cmml" xref="S3.SS1.p2.4.m4.1.1.6.3"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.6.3.1.cmml" xref="S3.SS1.p2.4.m4.1.1.6.3">subscript</csymbol><ci id="S3.SS1.p2.4.m4.1.1.6.3.2.cmml" xref="S3.SS1.p2.4.m4.1.1.6.3.2">𝚺</ci><ci id="S3.SS1.p2.4.m4.1.1.6.3.3.cmml" xref="S3.SS1.p2.4.m4.1.1.6.3.3">𝑘</ci></apply><apply id="S3.SS1.p2.4.m4.1.1.6.4.cmml" xref="S3.SS1.p2.4.m4.1.1.6.4"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.6.4.1.cmml" xref="S3.SS1.p2.4.m4.1.1.6.4">subscript</csymbol><apply id="S3.SS1.p2.4.m4.1.1.6.4.2.cmml" xref="S3.SS1.p2.4.m4.1.1.6.4"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.6.4.2.1.cmml" xref="S3.SS1.p2.4.m4.1.1.6.4">superscript</csymbol><ci id="S3.SS1.p2.4.m4.1.1.6.4.2.2.cmml" xref="S3.SS1.p2.4.m4.1.1.6.4.2.2">𝑽</ci><ci id="S3.SS1.p2.4.m4.1.1.6.4.2.3.cmml" xref="S3.SS1.p2.4.m4.1.1.6.4.2.3">𝑇</ci></apply><ci id="S3.SS1.p2.4.m4.1.1.6.4.3.cmml" xref="S3.SS1.p2.4.m4.1.1.6.4.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">\displaystyle{\bm{W}}\approx\displaystyle{\bm{W}}_{k}={\bm{U}}_{k}{\bm{\Sigma}%
}_{k}{\bm{V}}^{T}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m4.1d">bold_italic_W ≈ bold_italic_W start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT = bold_italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT bold_Σ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT bold_italic_V start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, where the dimensions of <math alttext="\displaystyle{\bm{U}}_{k}" class="ltx_Math" display="inline" id="S3.SS1.p2.5.m5.1"><semantics id="S3.SS1.p2.5.m5.1a"><msub id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml"><mi id="S3.SS1.p2.5.m5.1.1.2" xref="S3.SS1.p2.5.m5.1.1.2.cmml">𝑼</mi><mi id="S3.SS1.p2.5.m5.1.1.3" xref="S3.SS1.p2.5.m5.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><apply id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.1.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.p2.5.m5.1.1.2.cmml" xref="S3.SS1.p2.5.m5.1.1.2">𝑼</ci><ci id="S3.SS1.p2.5.m5.1.1.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">\displaystyle{\bm{U}}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.5.m5.1d">bold_italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\displaystyle{\bm{\Sigma}}_{k}" class="ltx_Math" display="inline" id="S3.SS1.p2.6.m6.1"><semantics id="S3.SS1.p2.6.m6.1a"><msub id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml"><mi id="S3.SS1.p2.6.m6.1.1.2" xref="S3.SS1.p2.6.m6.1.1.2.cmml">𝚺</mi><mi id="S3.SS1.p2.6.m6.1.1.3" xref="S3.SS1.p2.6.m6.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.1b"><apply id="S3.SS1.p2.6.m6.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.1.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.p2.6.m6.1.1.2.cmml" xref="S3.SS1.p2.6.m6.1.1.2">𝚺</ci><ci id="S3.SS1.p2.6.m6.1.1.3.cmml" xref="S3.SS1.p2.6.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.1c">\displaystyle{\bm{\Sigma}}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.6.m6.1d">bold_Σ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="{\bm{V}}^{T}_{k}" class="ltx_Math" display="inline" id="S3.SS1.p2.7.m7.1"><semantics id="S3.SS1.p2.7.m7.1a"><msubsup id="S3.SS1.p2.7.m7.1.1" xref="S3.SS1.p2.7.m7.1.1.cmml"><mi id="S3.SS1.p2.7.m7.1.1.2.2" xref="S3.SS1.p2.7.m7.1.1.2.2.cmml">𝑽</mi><mi id="S3.SS1.p2.7.m7.1.1.3" xref="S3.SS1.p2.7.m7.1.1.3.cmml">k</mi><mi id="S3.SS1.p2.7.m7.1.1.2.3" xref="S3.SS1.p2.7.m7.1.1.2.3.cmml">T</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m7.1b"><apply id="S3.SS1.p2.7.m7.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.1.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1">subscript</csymbol><apply id="S3.SS1.p2.7.m7.1.1.2.cmml" xref="S3.SS1.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.1.1.2.1.cmml" xref="S3.SS1.p2.7.m7.1.1">superscript</csymbol><ci id="S3.SS1.p2.7.m7.1.1.2.2.cmml" xref="S3.SS1.p2.7.m7.1.1.2.2">𝑽</ci><ci id="S3.SS1.p2.7.m7.1.1.2.3.cmml" xref="S3.SS1.p2.7.m7.1.1.2.3">𝑇</ci></apply><ci id="S3.SS1.p2.7.m7.1.1.3.cmml" xref="S3.SS1.p2.7.m7.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m7.1c">{\bm{V}}^{T}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.7.m7.1d">bold_italic_V start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> are <math alttext="d_{1}\times k" class="ltx_Math" display="inline" id="S3.SS1.p2.8.m8.1"><semantics id="S3.SS1.p2.8.m8.1a"><mrow id="S3.SS1.p2.8.m8.1.1" xref="S3.SS1.p2.8.m8.1.1.cmml"><msub id="S3.SS1.p2.8.m8.1.1.2" xref="S3.SS1.p2.8.m8.1.1.2.cmml"><mi id="S3.SS1.p2.8.m8.1.1.2.2" xref="S3.SS1.p2.8.m8.1.1.2.2.cmml">d</mi><mn id="S3.SS1.p2.8.m8.1.1.2.3" xref="S3.SS1.p2.8.m8.1.1.2.3.cmml">1</mn></msub><mo id="S3.SS1.p2.8.m8.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p2.8.m8.1.1.1.cmml">×</mo><mi id="S3.SS1.p2.8.m8.1.1.3" xref="S3.SS1.p2.8.m8.1.1.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m8.1b"><apply id="S3.SS1.p2.8.m8.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1"><times id="S3.SS1.p2.8.m8.1.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1.1"></times><apply id="S3.SS1.p2.8.m8.1.1.2.cmml" xref="S3.SS1.p2.8.m8.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m8.1.1.2.1.cmml" xref="S3.SS1.p2.8.m8.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.8.m8.1.1.2.2.cmml" xref="S3.SS1.p2.8.m8.1.1.2.2">𝑑</ci><cn id="S3.SS1.p2.8.m8.1.1.2.3.cmml" type="integer" xref="S3.SS1.p2.8.m8.1.1.2.3">1</cn></apply><ci id="S3.SS1.p2.8.m8.1.1.3.cmml" xref="S3.SS1.p2.8.m8.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.8.m8.1c">d_{1}\times k</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.8.m8.1d">italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT × italic_k</annotation></semantics></math>, <math alttext="k\times k" class="ltx_Math" display="inline" id="S3.SS1.p2.9.m9.1"><semantics id="S3.SS1.p2.9.m9.1a"><mrow id="S3.SS1.p2.9.m9.1.1" xref="S3.SS1.p2.9.m9.1.1.cmml"><mi id="S3.SS1.p2.9.m9.1.1.2" xref="S3.SS1.p2.9.m9.1.1.2.cmml">k</mi><mo id="S3.SS1.p2.9.m9.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p2.9.m9.1.1.1.cmml">×</mo><mi id="S3.SS1.p2.9.m9.1.1.3" xref="S3.SS1.p2.9.m9.1.1.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.9.m9.1b"><apply id="S3.SS1.p2.9.m9.1.1.cmml" xref="S3.SS1.p2.9.m9.1.1"><times id="S3.SS1.p2.9.m9.1.1.1.cmml" xref="S3.SS1.p2.9.m9.1.1.1"></times><ci id="S3.SS1.p2.9.m9.1.1.2.cmml" xref="S3.SS1.p2.9.m9.1.1.2">𝑘</ci><ci id="S3.SS1.p2.9.m9.1.1.3.cmml" xref="S3.SS1.p2.9.m9.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.9.m9.1c">k\times k</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.9.m9.1d">italic_k × italic_k</annotation></semantics></math>, and <math alttext="k\times nd_{2}" class="ltx_Math" display="inline" id="S3.SS1.p2.10.m10.1"><semantics id="S3.SS1.p2.10.m10.1a"><mrow id="S3.SS1.p2.10.m10.1.1" xref="S3.SS1.p2.10.m10.1.1.cmml"><mrow id="S3.SS1.p2.10.m10.1.1.2" xref="S3.SS1.p2.10.m10.1.1.2.cmml"><mi id="S3.SS1.p2.10.m10.1.1.2.2" xref="S3.SS1.p2.10.m10.1.1.2.2.cmml">k</mi><mo id="S3.SS1.p2.10.m10.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p2.10.m10.1.1.2.1.cmml">×</mo><mi id="S3.SS1.p2.10.m10.1.1.2.3" xref="S3.SS1.p2.10.m10.1.1.2.3.cmml">n</mi></mrow><mo id="S3.SS1.p2.10.m10.1.1.1" xref="S3.SS1.p2.10.m10.1.1.1.cmml">⁢</mo><msub id="S3.SS1.p2.10.m10.1.1.3" xref="S3.SS1.p2.10.m10.1.1.3.cmml"><mi id="S3.SS1.p2.10.m10.1.1.3.2" xref="S3.SS1.p2.10.m10.1.1.3.2.cmml">d</mi><mn id="S3.SS1.p2.10.m10.1.1.3.3" xref="S3.SS1.p2.10.m10.1.1.3.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.10.m10.1b"><apply id="S3.SS1.p2.10.m10.1.1.cmml" xref="S3.SS1.p2.10.m10.1.1"><times id="S3.SS1.p2.10.m10.1.1.1.cmml" xref="S3.SS1.p2.10.m10.1.1.1"></times><apply id="S3.SS1.p2.10.m10.1.1.2.cmml" xref="S3.SS1.p2.10.m10.1.1.2"><times id="S3.SS1.p2.10.m10.1.1.2.1.cmml" xref="S3.SS1.p2.10.m10.1.1.2.1"></times><ci id="S3.SS1.p2.10.m10.1.1.2.2.cmml" xref="S3.SS1.p2.10.m10.1.1.2.2">𝑘</ci><ci id="S3.SS1.p2.10.m10.1.1.2.3.cmml" xref="S3.SS1.p2.10.m10.1.1.2.3">𝑛</ci></apply><apply id="S3.SS1.p2.10.m10.1.1.3.cmml" xref="S3.SS1.p2.10.m10.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.10.m10.1.1.3.1.cmml" xref="S3.SS1.p2.10.m10.1.1.3">subscript</csymbol><ci id="S3.SS1.p2.10.m10.1.1.3.2.cmml" xref="S3.SS1.p2.10.m10.1.1.3.2">𝑑</ci><cn id="S3.SS1.p2.10.m10.1.1.3.3.cmml" type="integer" xref="S3.SS1.p2.10.m10.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.10.m10.1c">k\times nd_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.10.m10.1d">italic_k × italic_n italic_d start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, respectively.
The value of <math alttext="k" class="ltx_Math" display="inline" id="S3.SS1.p2.11.m11.1"><semantics id="S3.SS1.p2.11.m11.1a"><mi id="S3.SS1.p2.11.m11.1.1" xref="S3.SS1.p2.11.m11.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.11.m11.1b"><ci id="S3.SS1.p2.11.m11.1.1.cmml" xref="S3.SS1.p2.11.m11.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.11.m11.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.11.m11.1d">italic_k</annotation></semantics></math> should be determined to balance the compression ratio and the performance of the compressed LLM (Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#A1.SS1" title="A.1 Relation between compression ratio and number of basis vectors ‣ Appendix A Appendix ‣ Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_tag">A.1</span></a> shows the evaluation of <math alttext="k" class="ltx_Math" display="inline" id="S3.SS1.p2.12.m12.1"><semantics id="S3.SS1.p2.12.m12.1a"><mi id="S3.SS1.p2.12.m12.1.1" xref="S3.SS1.p2.12.m12.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.12.m12.1b"><ci id="S3.SS1.p2.12.m12.1.1.cmml" xref="S3.SS1.p2.12.m12.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.12.m12.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.12.m12.1d">italic_k</annotation></semantics></math> under a given compression ratio).
<math alttext="\displaystyle{\bm{W}}_{k}" class="ltx_Math" display="inline" id="S3.SS1.p2.13.m13.1"><semantics id="S3.SS1.p2.13.m13.1a"><msub id="S3.SS1.p2.13.m13.1.1" xref="S3.SS1.p2.13.m13.1.1.cmml"><mi id="S3.SS1.p2.13.m13.1.1.2" xref="S3.SS1.p2.13.m13.1.1.2.cmml">𝑾</mi><mi id="S3.SS1.p2.13.m13.1.1.3" xref="S3.SS1.p2.13.m13.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.13.m13.1b"><apply id="S3.SS1.p2.13.m13.1.1.cmml" xref="S3.SS1.p2.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.13.m13.1.1.1.cmml" xref="S3.SS1.p2.13.m13.1.1">subscript</csymbol><ci id="S3.SS1.p2.13.m13.1.1.2.cmml" xref="S3.SS1.p2.13.m13.1.1.2">𝑾</ci><ci id="S3.SS1.p2.13.m13.1.1.3.cmml" xref="S3.SS1.p2.13.m13.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.13.m13.1c">\displaystyle{\bm{W}}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.13.m13.1d">bold_italic_W start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> can be rewritten as <math alttext="\displaystyle{\bm{W}}_{k}={\bm{B}}{\bm{V}}^{T}_{k}" class="ltx_Math" display="inline" id="S3.SS1.p2.14.m14.1"><semantics id="S3.SS1.p2.14.m14.1a"><mrow id="S3.SS1.p2.14.m14.1.1" xref="S3.SS1.p2.14.m14.1.1.cmml"><msub id="S3.SS1.p2.14.m14.1.1.2" xref="S3.SS1.p2.14.m14.1.1.2.cmml"><mi id="S3.SS1.p2.14.m14.1.1.2.2" xref="S3.SS1.p2.14.m14.1.1.2.2.cmml">𝑾</mi><mi id="S3.SS1.p2.14.m14.1.1.2.3" xref="S3.SS1.p2.14.m14.1.1.2.3.cmml">k</mi></msub><mo id="S3.SS1.p2.14.m14.1.1.1" xref="S3.SS1.p2.14.m14.1.1.1.cmml">=</mo><mrow id="S3.SS1.p2.14.m14.1.1.3" xref="S3.SS1.p2.14.m14.1.1.3.cmml"><mi id="S3.SS1.p2.14.m14.1.1.3.2" xref="S3.SS1.p2.14.m14.1.1.3.2.cmml">𝑩</mi><mo id="S3.SS1.p2.14.m14.1.1.3.1" xref="S3.SS1.p2.14.m14.1.1.3.1.cmml">⁢</mo><msubsup id="S3.SS1.p2.14.m14.1.1.3.3" xref="S3.SS1.p2.14.m14.1.1.3.3.cmml"><mi id="S3.SS1.p2.14.m14.1.1.3.3.2.2" xref="S3.SS1.p2.14.m14.1.1.3.3.2.2.cmml">𝑽</mi><mi id="S3.SS1.p2.14.m14.1.1.3.3.3" xref="S3.SS1.p2.14.m14.1.1.3.3.3.cmml">k</mi><mi id="S3.SS1.p2.14.m14.1.1.3.3.2.3" xref="S3.SS1.p2.14.m14.1.1.3.3.2.3.cmml">T</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.14.m14.1b"><apply id="S3.SS1.p2.14.m14.1.1.cmml" xref="S3.SS1.p2.14.m14.1.1"><eq id="S3.SS1.p2.14.m14.1.1.1.cmml" xref="S3.SS1.p2.14.m14.1.1.1"></eq><apply id="S3.SS1.p2.14.m14.1.1.2.cmml" xref="S3.SS1.p2.14.m14.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.14.m14.1.1.2.1.cmml" xref="S3.SS1.p2.14.m14.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.14.m14.1.1.2.2.cmml" xref="S3.SS1.p2.14.m14.1.1.2.2">𝑾</ci><ci id="S3.SS1.p2.14.m14.1.1.2.3.cmml" xref="S3.SS1.p2.14.m14.1.1.2.3">𝑘</ci></apply><apply id="S3.SS1.p2.14.m14.1.1.3.cmml" xref="S3.SS1.p2.14.m14.1.1.3"><times id="S3.SS1.p2.14.m14.1.1.3.1.cmml" xref="S3.SS1.p2.14.m14.1.1.3.1"></times><ci id="S3.SS1.p2.14.m14.1.1.3.2.cmml" xref="S3.SS1.p2.14.m14.1.1.3.2">𝑩</ci><apply id="S3.SS1.p2.14.m14.1.1.3.3.cmml" xref="S3.SS1.p2.14.m14.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.14.m14.1.1.3.3.1.cmml" xref="S3.SS1.p2.14.m14.1.1.3.3">subscript</csymbol><apply id="S3.SS1.p2.14.m14.1.1.3.3.2.cmml" xref="S3.SS1.p2.14.m14.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.14.m14.1.1.3.3.2.1.cmml" xref="S3.SS1.p2.14.m14.1.1.3.3">superscript</csymbol><ci id="S3.SS1.p2.14.m14.1.1.3.3.2.2.cmml" xref="S3.SS1.p2.14.m14.1.1.3.3.2.2">𝑽</ci><ci id="S3.SS1.p2.14.m14.1.1.3.3.2.3.cmml" xref="S3.SS1.p2.14.m14.1.1.3.3.2.3">𝑇</ci></apply><ci id="S3.SS1.p2.14.m14.1.1.3.3.3.cmml" xref="S3.SS1.p2.14.m14.1.1.3.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.14.m14.1c">\displaystyle{\bm{W}}_{k}={\bm{B}}{\bm{V}}^{T}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.14.m14.1d">bold_italic_W start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT = bold_italic_B bold_italic_V start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, where <math alttext="\displaystyle{\bm{B}}" class="ltx_Math" display="inline" id="S3.SS1.p2.15.m15.1"><semantics id="S3.SS1.p2.15.m15.1a"><mi id="S3.SS1.p2.15.m15.1.1" xref="S3.SS1.p2.15.m15.1.1.cmml">𝑩</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.15.m15.1b"><ci id="S3.SS1.p2.15.m15.1.1.cmml" xref="S3.SS1.p2.15.m15.1.1">𝑩</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.15.m15.1c">\displaystyle{\bm{B}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.15.m15.1d">bold_italic_B</annotation></semantics></math> is the multiplication result of <math alttext="\displaystyle{\bm{U}}_{k}" class="ltx_Math" display="inline" id="S3.SS1.p2.16.m16.1"><semantics id="S3.SS1.p2.16.m16.1a"><msub id="S3.SS1.p2.16.m16.1.1" xref="S3.SS1.p2.16.m16.1.1.cmml"><mi id="S3.SS1.p2.16.m16.1.1.2" xref="S3.SS1.p2.16.m16.1.1.2.cmml">𝑼</mi><mi id="S3.SS1.p2.16.m16.1.1.3" xref="S3.SS1.p2.16.m16.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.16.m16.1b"><apply id="S3.SS1.p2.16.m16.1.1.cmml" xref="S3.SS1.p2.16.m16.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.16.m16.1.1.1.cmml" xref="S3.SS1.p2.16.m16.1.1">subscript</csymbol><ci id="S3.SS1.p2.16.m16.1.1.2.cmml" xref="S3.SS1.p2.16.m16.1.1.2">𝑼</ci><ci id="S3.SS1.p2.16.m16.1.1.3.cmml" xref="S3.SS1.p2.16.m16.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.16.m16.1c">\displaystyle{\bm{U}}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.16.m16.1d">bold_italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\displaystyle{\bm{\Sigma}}_{k}" class="ltx_Math" display="inline" id="S3.SS1.p2.17.m17.1"><semantics id="S3.SS1.p2.17.m17.1a"><msub id="S3.SS1.p2.17.m17.1.1" xref="S3.SS1.p2.17.m17.1.1.cmml"><mi id="S3.SS1.p2.17.m17.1.1.2" xref="S3.SS1.p2.17.m17.1.1.2.cmml">𝚺</mi><mi id="S3.SS1.p2.17.m17.1.1.3" xref="S3.SS1.p2.17.m17.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.17.m17.1b"><apply id="S3.SS1.p2.17.m17.1.1.cmml" xref="S3.SS1.p2.17.m17.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.17.m17.1.1.1.cmml" xref="S3.SS1.p2.17.m17.1.1">subscript</csymbol><ci id="S3.SS1.p2.17.m17.1.1.2.cmml" xref="S3.SS1.p2.17.m17.1.1.2">𝚺</ci><ci id="S3.SS1.p2.17.m17.1.1.3.cmml" xref="S3.SS1.p2.17.m17.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.17.m17.1c">\displaystyle{\bm{\Sigma}}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.17.m17.1d">bold_Σ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>. We call <math alttext="\displaystyle{\bm{B}}" class="ltx_Math" display="inline" id="S3.SS1.p2.18.m18.1"><semantics id="S3.SS1.p2.18.m18.1a"><mi id="S3.SS1.p2.18.m18.1.1" xref="S3.SS1.p2.18.m18.1.1.cmml">𝑩</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.18.m18.1b"><ci id="S3.SS1.p2.18.m18.1.1.cmml" xref="S3.SS1.p2.18.m18.1.1">𝑩</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.18.m18.1c">\displaystyle{\bm{B}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.18.m18.1d">bold_italic_B</annotation></semantics></math> a basis matrix and a column of <math alttext="\displaystyle{\bm{B}}" class="ltx_Math" display="inline" id="S3.SS1.p2.19.m19.1"><semantics id="S3.SS1.p2.19.m19.1a"><mi id="S3.SS1.p2.19.m19.1.1" xref="S3.SS1.p2.19.m19.1.1.cmml">𝑩</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.19.m19.1b"><ci id="S3.SS1.p2.19.m19.1.1.cmml" xref="S3.SS1.p2.19.m19.1.1">𝑩</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.19.m19.1c">\displaystyle{\bm{B}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.19.m19.1d">bold_italic_B</annotation></semantics></math> is a basis vector, denoted as <math alttext="{\bm{B}}_{:,i}" class="ltx_Math" display="inline" id="S3.SS1.p2.20.m20.2"><semantics id="S3.SS1.p2.20.m20.2a"><msub id="S3.SS1.p2.20.m20.2.3" xref="S3.SS1.p2.20.m20.2.3.cmml"><mi id="S3.SS1.p2.20.m20.2.3.2" xref="S3.SS1.p2.20.m20.2.3.2.cmml">𝑩</mi><mrow id="S3.SS1.p2.20.m20.2.2.2.4" xref="S3.SS1.p2.20.m20.2.2.2.3.cmml"><mo id="S3.SS1.p2.20.m20.1.1.1.1" rspace="0em" xref="S3.SS1.p2.20.m20.1.1.1.1.cmml">:</mo><mo id="S3.SS1.p2.20.m20.2.2.2.4.1" xref="S3.SS1.p2.20.m20.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p2.20.m20.2.2.2.2" xref="S3.SS1.p2.20.m20.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.20.m20.2b"><apply id="S3.SS1.p2.20.m20.2.3.cmml" xref="S3.SS1.p2.20.m20.2.3"><csymbol cd="ambiguous" id="S3.SS1.p2.20.m20.2.3.1.cmml" xref="S3.SS1.p2.20.m20.2.3">subscript</csymbol><ci id="S3.SS1.p2.20.m20.2.3.2.cmml" xref="S3.SS1.p2.20.m20.2.3.2">𝑩</ci><list id="S3.SS1.p2.20.m20.2.2.2.3.cmml" xref="S3.SS1.p2.20.m20.2.2.2.4"><ci id="S3.SS1.p2.20.m20.1.1.1.1.cmml" xref="S3.SS1.p2.20.m20.1.1.1.1">:</ci><ci id="S3.SS1.p2.20.m20.2.2.2.2.cmml" xref="S3.SS1.p2.20.m20.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.20.m20.2c">{\bm{B}}_{:,i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.20.m20.2d">bold_italic_B start_POSTSUBSCRIPT : , italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. <math alttext="\displaystyle{\bm{V}}^{T}_{k}" class="ltx_Math" display="inline" id="S3.SS1.p2.21.m21.1"><semantics id="S3.SS1.p2.21.m21.1a"><msubsup id="S3.SS1.p2.21.m21.1.1" xref="S3.SS1.p2.21.m21.1.1.cmml"><mi id="S3.SS1.p2.21.m21.1.1.2.2" xref="S3.SS1.p2.21.m21.1.1.2.2.cmml">𝑽</mi><mi id="S3.SS1.p2.21.m21.1.1.3" xref="S3.SS1.p2.21.m21.1.1.3.cmml">k</mi><mi id="S3.SS1.p2.21.m21.1.1.2.3" xref="S3.SS1.p2.21.m21.1.1.2.3.cmml">T</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.21.m21.1b"><apply id="S3.SS1.p2.21.m21.1.1.cmml" xref="S3.SS1.p2.21.m21.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.21.m21.1.1.1.cmml" xref="S3.SS1.p2.21.m21.1.1">subscript</csymbol><apply id="S3.SS1.p2.21.m21.1.1.2.cmml" xref="S3.SS1.p2.21.m21.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.21.m21.1.1.2.1.cmml" xref="S3.SS1.p2.21.m21.1.1">superscript</csymbol><ci id="S3.SS1.p2.21.m21.1.1.2.2.cmml" xref="S3.SS1.p2.21.m21.1.1.2.2">𝑽</ci><ci id="S3.SS1.p2.21.m21.1.1.2.3.cmml" xref="S3.SS1.p2.21.m21.1.1.2.3">𝑇</ci></apply><ci id="S3.SS1.p2.21.m21.1.1.3.cmml" xref="S3.SS1.p2.21.m21.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.21.m21.1c">\displaystyle{\bm{V}}^{T}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.21.m21.1d">bold_italic_V start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> can be considered as a coefficient matrix, i.e., <math alttext="\displaystyle{\bm{V}}^{T}_{k}=\displaystyle{\bm{C}}" class="ltx_Math" display="inline" id="S3.SS1.p2.22.m22.1"><semantics id="S3.SS1.p2.22.m22.1a"><mrow id="S3.SS1.p2.22.m22.1.1" xref="S3.SS1.p2.22.m22.1.1.cmml"><msubsup id="S3.SS1.p2.22.m22.1.1.2" xref="S3.SS1.p2.22.m22.1.1.2.cmml"><mi id="S3.SS1.p2.22.m22.1.1.2.2.2" xref="S3.SS1.p2.22.m22.1.1.2.2.2.cmml">𝑽</mi><mi id="S3.SS1.p2.22.m22.1.1.2.3" xref="S3.SS1.p2.22.m22.1.1.2.3.cmml">k</mi><mi id="S3.SS1.p2.22.m22.1.1.2.2.3" xref="S3.SS1.p2.22.m22.1.1.2.2.3.cmml">T</mi></msubsup><mo id="S3.SS1.p2.22.m22.1.1.1" xref="S3.SS1.p2.22.m22.1.1.1.cmml">=</mo><mi id="S3.SS1.p2.22.m22.1.1.3" xref="S3.SS1.p2.22.m22.1.1.3.cmml">𝑪</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.22.m22.1b"><apply id="S3.SS1.p2.22.m22.1.1.cmml" xref="S3.SS1.p2.22.m22.1.1"><eq id="S3.SS1.p2.22.m22.1.1.1.cmml" xref="S3.SS1.p2.22.m22.1.1.1"></eq><apply id="S3.SS1.p2.22.m22.1.1.2.cmml" xref="S3.SS1.p2.22.m22.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.22.m22.1.1.2.1.cmml" xref="S3.SS1.p2.22.m22.1.1.2">subscript</csymbol><apply id="S3.SS1.p2.22.m22.1.1.2.2.cmml" xref="S3.SS1.p2.22.m22.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.22.m22.1.1.2.2.1.cmml" xref="S3.SS1.p2.22.m22.1.1.2">superscript</csymbol><ci id="S3.SS1.p2.22.m22.1.1.2.2.2.cmml" xref="S3.SS1.p2.22.m22.1.1.2.2.2">𝑽</ci><ci id="S3.SS1.p2.22.m22.1.1.2.2.3.cmml" xref="S3.SS1.p2.22.m22.1.1.2.2.3">𝑇</ci></apply><ci id="S3.SS1.p2.22.m22.1.1.2.3.cmml" xref="S3.SS1.p2.22.m22.1.1.2.3">𝑘</ci></apply><ci id="S3.SS1.p2.22.m22.1.1.3.cmml" xref="S3.SS1.p2.22.m22.1.1.3">𝑪</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.22.m22.1c">\displaystyle{\bm{V}}^{T}_{k}=\displaystyle{\bm{C}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.22.m22.1d">bold_italic_V start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT = bold_italic_C</annotation></semantics></math>. Accordingly, the <math alttext="\displaystyle j^{th}" class="ltx_Math" display="inline" id="S3.SS1.p2.23.m23.1"><semantics id="S3.SS1.p2.23.m23.1a"><msup id="S3.SS1.p2.23.m23.1.1" xref="S3.SS1.p2.23.m23.1.1.cmml"><mi id="S3.SS1.p2.23.m23.1.1.2" xref="S3.SS1.p2.23.m23.1.1.2.cmml">j</mi><mrow id="S3.SS1.p2.23.m23.1.1.3" xref="S3.SS1.p2.23.m23.1.1.3.cmml"><mi id="S3.SS1.p2.23.m23.1.1.3.2" xref="S3.SS1.p2.23.m23.1.1.3.2.cmml">t</mi><mo id="S3.SS1.p2.23.m23.1.1.3.1" xref="S3.SS1.p2.23.m23.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p2.23.m23.1.1.3.3" xref="S3.SS1.p2.23.m23.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.23.m23.1b"><apply id="S3.SS1.p2.23.m23.1.1.cmml" xref="S3.SS1.p2.23.m23.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.23.m23.1.1.1.cmml" xref="S3.SS1.p2.23.m23.1.1">superscript</csymbol><ci id="S3.SS1.p2.23.m23.1.1.2.cmml" xref="S3.SS1.p2.23.m23.1.1.2">𝑗</ci><apply id="S3.SS1.p2.23.m23.1.1.3.cmml" xref="S3.SS1.p2.23.m23.1.1.3"><times id="S3.SS1.p2.23.m23.1.1.3.1.cmml" xref="S3.SS1.p2.23.m23.1.1.3.1"></times><ci id="S3.SS1.p2.23.m23.1.1.3.2.cmml" xref="S3.SS1.p2.23.m23.1.1.3.2">𝑡</ci><ci id="S3.SS1.p2.23.m23.1.1.3.3.cmml" xref="S3.SS1.p2.23.m23.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.23.m23.1c">\displaystyle j^{th}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.23.m23.1d">italic_j start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> column of the original weight matrix
<math alttext="\displaystyle{\bm{W}}^{(i)}" class="ltx_Math" display="inline" id="S3.SS1.p2.24.m24.1"><semantics id="S3.SS1.p2.24.m24.1a"><msup id="S3.SS1.p2.24.m24.1.2" xref="S3.SS1.p2.24.m24.1.2.cmml"><mi id="S3.SS1.p2.24.m24.1.2.2" xref="S3.SS1.p2.24.m24.1.2.2.cmml">𝑾</mi><mrow id="S3.SS1.p2.24.m24.1.1.1.3" xref="S3.SS1.p2.24.m24.1.2.cmml"><mo id="S3.SS1.p2.24.m24.1.1.1.3.1" stretchy="false" xref="S3.SS1.p2.24.m24.1.2.cmml">(</mo><mi id="S3.SS1.p2.24.m24.1.1.1.1" xref="S3.SS1.p2.24.m24.1.1.1.1.cmml">i</mi><mo id="S3.SS1.p2.24.m24.1.1.1.3.2" stretchy="false" xref="S3.SS1.p2.24.m24.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.24.m24.1b"><apply id="S3.SS1.p2.24.m24.1.2.cmml" xref="S3.SS1.p2.24.m24.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.24.m24.1.2.1.cmml" xref="S3.SS1.p2.24.m24.1.2">superscript</csymbol><ci id="S3.SS1.p2.24.m24.1.2.2.cmml" xref="S3.SS1.p2.24.m24.1.2.2">𝑾</ci><ci id="S3.SS1.p2.24.m24.1.1.1.1.cmml" xref="S3.SS1.p2.24.m24.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.24.m24.1c">\displaystyle{\bm{W}}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.24.m24.1d">bold_italic_W start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> in the <math alttext="i^{th}" class="ltx_Math" display="inline" id="S3.SS1.p2.25.m25.1"><semantics id="S3.SS1.p2.25.m25.1a"><msup id="S3.SS1.p2.25.m25.1.1" xref="S3.SS1.p2.25.m25.1.1.cmml"><mi id="S3.SS1.p2.25.m25.1.1.2" xref="S3.SS1.p2.25.m25.1.1.2.cmml">i</mi><mrow id="S3.SS1.p2.25.m25.1.1.3" xref="S3.SS1.p2.25.m25.1.1.3.cmml"><mi id="S3.SS1.p2.25.m25.1.1.3.2" xref="S3.SS1.p2.25.m25.1.1.3.2.cmml">t</mi><mo id="S3.SS1.p2.25.m25.1.1.3.1" xref="S3.SS1.p2.25.m25.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p2.25.m25.1.1.3.3" xref="S3.SS1.p2.25.m25.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.25.m25.1b"><apply id="S3.SS1.p2.25.m25.1.1.cmml" xref="S3.SS1.p2.25.m25.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.25.m25.1.1.1.cmml" xref="S3.SS1.p2.25.m25.1.1">superscript</csymbol><ci id="S3.SS1.p2.25.m25.1.1.2.cmml" xref="S3.SS1.p2.25.m25.1.1.2">𝑖</ci><apply id="S3.SS1.p2.25.m25.1.1.3.cmml" xref="S3.SS1.p2.25.m25.1.1.3"><times id="S3.SS1.p2.25.m25.1.1.3.1.cmml" xref="S3.SS1.p2.25.m25.1.1.3.1"></times><ci id="S3.SS1.p2.25.m25.1.1.3.2.cmml" xref="S3.SS1.p2.25.m25.1.1.3.2">𝑡</ci><ci id="S3.SS1.p2.25.m25.1.1.3.3.cmml" xref="S3.SS1.p2.25.m25.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.25.m25.1c">i^{th}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.25.m25.1d">italic_i start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> layer
can be approximated as a liner combination of
<math alttext="k" class="ltx_Math" display="inline" id="S3.SS1.p2.26.m26.1"><semantics id="S3.SS1.p2.26.m26.1a"><mi id="S3.SS1.p2.26.m26.1.1" xref="S3.SS1.p2.26.m26.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.26.m26.1b"><ci id="S3.SS1.p2.26.m26.1.1.cmml" xref="S3.SS1.p2.26.m26.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.26.m26.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.26.m26.1d">italic_k</annotation></semantics></math> basis vectors and individual coefficients as follows.</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle{\bm{W}}^{(i)}_{:,j}\approx\sum_{m=1}^{k}{\bm{B}}_{:,m}{\bm{C}}^{%
(i)}_{m,j}." class="ltx_Math" display="block" id="S3.E1.m1.9"><semantics id="S3.E1.m1.9a"><mrow id="S3.E1.m1.9.9.1" xref="S3.E1.m1.9.9.1.1.cmml"><mrow id="S3.E1.m1.9.9.1.1" xref="S3.E1.m1.9.9.1.1.cmml"><msubsup id="S3.E1.m1.9.9.1.1.2" xref="S3.E1.m1.9.9.1.1.2.cmml"><mi id="S3.E1.m1.9.9.1.1.2.2.2" xref="S3.E1.m1.9.9.1.1.2.2.2.cmml">𝑾</mi><mrow id="S3.E1.m1.3.3.2.4" xref="S3.E1.m1.3.3.2.3.cmml"><mo id="S3.E1.m1.2.2.1.1" rspace="0em" xref="S3.E1.m1.2.2.1.1.cmml">:</mo><mo id="S3.E1.m1.3.3.2.4.1" xref="S3.E1.m1.3.3.2.3.cmml">,</mo><mi id="S3.E1.m1.3.3.2.2" xref="S3.E1.m1.3.3.2.2.cmml">j</mi></mrow><mrow id="S3.E1.m1.1.1.1.3" xref="S3.E1.m1.9.9.1.1.2.cmml"><mo id="S3.E1.m1.1.1.1.3.1" stretchy="false" xref="S3.E1.m1.9.9.1.1.2.cmml">(</mo><mi id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml">i</mi><mo id="S3.E1.m1.1.1.1.3.2" stretchy="false" xref="S3.E1.m1.9.9.1.1.2.cmml">)</mo></mrow></msubsup><mo id="S3.E1.m1.9.9.1.1.1" rspace="0.111em" xref="S3.E1.m1.9.9.1.1.1.cmml">≈</mo><mrow id="S3.E1.m1.9.9.1.1.3" xref="S3.E1.m1.9.9.1.1.3.cmml"><munderover id="S3.E1.m1.9.9.1.1.3.1" xref="S3.E1.m1.9.9.1.1.3.1.cmml"><mo id="S3.E1.m1.9.9.1.1.3.1.2.2" movablelimits="false" xref="S3.E1.m1.9.9.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.E1.m1.9.9.1.1.3.1.2.3" xref="S3.E1.m1.9.9.1.1.3.1.2.3.cmml"><mi id="S3.E1.m1.9.9.1.1.3.1.2.3.2" xref="S3.E1.m1.9.9.1.1.3.1.2.3.2.cmml">m</mi><mo id="S3.E1.m1.9.9.1.1.3.1.2.3.1" xref="S3.E1.m1.9.9.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.E1.m1.9.9.1.1.3.1.2.3.3" xref="S3.E1.m1.9.9.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.9.9.1.1.3.1.3" xref="S3.E1.m1.9.9.1.1.3.1.3.cmml">k</mi></munderover><mrow id="S3.E1.m1.9.9.1.1.3.2" xref="S3.E1.m1.9.9.1.1.3.2.cmml"><msub id="S3.E1.m1.9.9.1.1.3.2.2" xref="S3.E1.m1.9.9.1.1.3.2.2.cmml"><mi id="S3.E1.m1.9.9.1.1.3.2.2.2" xref="S3.E1.m1.9.9.1.1.3.2.2.2.cmml">𝑩</mi><mrow id="S3.E1.m1.5.5.2.4" xref="S3.E1.m1.5.5.2.3.cmml"><mo id="S3.E1.m1.4.4.1.1" rspace="0em" xref="S3.E1.m1.4.4.1.1.cmml">:</mo><mo id="S3.E1.m1.5.5.2.4.1" xref="S3.E1.m1.5.5.2.3.cmml">,</mo><mi id="S3.E1.m1.5.5.2.2" xref="S3.E1.m1.5.5.2.2.cmml">m</mi></mrow></msub><mo id="S3.E1.m1.9.9.1.1.3.2.1" xref="S3.E1.m1.9.9.1.1.3.2.1.cmml">⁢</mo><msubsup id="S3.E1.m1.9.9.1.1.3.2.3" xref="S3.E1.m1.9.9.1.1.3.2.3.cmml"><mi id="S3.E1.m1.9.9.1.1.3.2.3.2.2" xref="S3.E1.m1.9.9.1.1.3.2.3.2.2.cmml">𝑪</mi><mrow id="S3.E1.m1.8.8.2.4" xref="S3.E1.m1.8.8.2.3.cmml"><mi id="S3.E1.m1.7.7.1.1" xref="S3.E1.m1.7.7.1.1.cmml">m</mi><mo id="S3.E1.m1.8.8.2.4.1" xref="S3.E1.m1.8.8.2.3.cmml">,</mo><mi id="S3.E1.m1.8.8.2.2" xref="S3.E1.m1.8.8.2.2.cmml">j</mi></mrow><mrow id="S3.E1.m1.6.6.1.3" xref="S3.E1.m1.9.9.1.1.3.2.3.cmml"><mo id="S3.E1.m1.6.6.1.3.1" stretchy="false" xref="S3.E1.m1.9.9.1.1.3.2.3.cmml">(</mo><mi id="S3.E1.m1.6.6.1.1" xref="S3.E1.m1.6.6.1.1.cmml">i</mi><mo id="S3.E1.m1.6.6.1.3.2" stretchy="false" xref="S3.E1.m1.9.9.1.1.3.2.3.cmml">)</mo></mrow></msubsup></mrow></mrow></mrow><mo id="S3.E1.m1.9.9.1.2" lspace="0em" xref="S3.E1.m1.9.9.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.9b"><apply id="S3.E1.m1.9.9.1.1.cmml" xref="S3.E1.m1.9.9.1"><approx id="S3.E1.m1.9.9.1.1.1.cmml" xref="S3.E1.m1.9.9.1.1.1"></approx><apply id="S3.E1.m1.9.9.1.1.2.cmml" xref="S3.E1.m1.9.9.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.9.9.1.1.2.1.cmml" xref="S3.E1.m1.9.9.1.1.2">subscript</csymbol><apply id="S3.E1.m1.9.9.1.1.2.2.cmml" xref="S3.E1.m1.9.9.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.9.9.1.1.2.2.1.cmml" xref="S3.E1.m1.9.9.1.1.2">superscript</csymbol><ci id="S3.E1.m1.9.9.1.1.2.2.2.cmml" xref="S3.E1.m1.9.9.1.1.2.2.2">𝑾</ci><ci id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1">𝑖</ci></apply><list id="S3.E1.m1.3.3.2.3.cmml" xref="S3.E1.m1.3.3.2.4"><ci id="S3.E1.m1.2.2.1.1.cmml" xref="S3.E1.m1.2.2.1.1">:</ci><ci id="S3.E1.m1.3.3.2.2.cmml" xref="S3.E1.m1.3.3.2.2">𝑗</ci></list></apply><apply id="S3.E1.m1.9.9.1.1.3.cmml" xref="S3.E1.m1.9.9.1.1.3"><apply id="S3.E1.m1.9.9.1.1.3.1.cmml" xref="S3.E1.m1.9.9.1.1.3.1"><csymbol cd="ambiguous" id="S3.E1.m1.9.9.1.1.3.1.1.cmml" xref="S3.E1.m1.9.9.1.1.3.1">superscript</csymbol><apply id="S3.E1.m1.9.9.1.1.3.1.2.cmml" xref="S3.E1.m1.9.9.1.1.3.1"><csymbol cd="ambiguous" id="S3.E1.m1.9.9.1.1.3.1.2.1.cmml" xref="S3.E1.m1.9.9.1.1.3.1">subscript</csymbol><sum id="S3.E1.m1.9.9.1.1.3.1.2.2.cmml" xref="S3.E1.m1.9.9.1.1.3.1.2.2"></sum><apply id="S3.E1.m1.9.9.1.1.3.1.2.3.cmml" xref="S3.E1.m1.9.9.1.1.3.1.2.3"><eq id="S3.E1.m1.9.9.1.1.3.1.2.3.1.cmml" xref="S3.E1.m1.9.9.1.1.3.1.2.3.1"></eq><ci id="S3.E1.m1.9.9.1.1.3.1.2.3.2.cmml" xref="S3.E1.m1.9.9.1.1.3.1.2.3.2">𝑚</ci><cn id="S3.E1.m1.9.9.1.1.3.1.2.3.3.cmml" type="integer" xref="S3.E1.m1.9.9.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.9.9.1.1.3.1.3.cmml" xref="S3.E1.m1.9.9.1.1.3.1.3">𝑘</ci></apply><apply id="S3.E1.m1.9.9.1.1.3.2.cmml" xref="S3.E1.m1.9.9.1.1.3.2"><times id="S3.E1.m1.9.9.1.1.3.2.1.cmml" xref="S3.E1.m1.9.9.1.1.3.2.1"></times><apply id="S3.E1.m1.9.9.1.1.3.2.2.cmml" xref="S3.E1.m1.9.9.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.9.9.1.1.3.2.2.1.cmml" xref="S3.E1.m1.9.9.1.1.3.2.2">subscript</csymbol><ci id="S3.E1.m1.9.9.1.1.3.2.2.2.cmml" xref="S3.E1.m1.9.9.1.1.3.2.2.2">𝑩</ci><list id="S3.E1.m1.5.5.2.3.cmml" xref="S3.E1.m1.5.5.2.4"><ci id="S3.E1.m1.4.4.1.1.cmml" xref="S3.E1.m1.4.4.1.1">:</ci><ci id="S3.E1.m1.5.5.2.2.cmml" xref="S3.E1.m1.5.5.2.2">𝑚</ci></list></apply><apply id="S3.E1.m1.9.9.1.1.3.2.3.cmml" xref="S3.E1.m1.9.9.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.9.9.1.1.3.2.3.1.cmml" xref="S3.E1.m1.9.9.1.1.3.2.3">subscript</csymbol><apply id="S3.E1.m1.9.9.1.1.3.2.3.2.cmml" xref="S3.E1.m1.9.9.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.9.9.1.1.3.2.3.2.1.cmml" xref="S3.E1.m1.9.9.1.1.3.2.3">superscript</csymbol><ci id="S3.E1.m1.9.9.1.1.3.2.3.2.2.cmml" xref="S3.E1.m1.9.9.1.1.3.2.3.2.2">𝑪</ci><ci id="S3.E1.m1.6.6.1.1.cmml" xref="S3.E1.m1.6.6.1.1">𝑖</ci></apply><list id="S3.E1.m1.8.8.2.3.cmml" xref="S3.E1.m1.8.8.2.4"><ci id="S3.E1.m1.7.7.1.1.cmml" xref="S3.E1.m1.7.7.1.1">𝑚</ci><ci id="S3.E1.m1.8.8.2.2.cmml" xref="S3.E1.m1.8.8.2.2">𝑗</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.9c">\displaystyle{\bm{W}}^{(i)}_{:,j}\approx\sum_{m=1}^{k}{\bm{B}}_{:,m}{\bm{C}}^{%
(i)}_{m,j}.</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.9d">bold_italic_W start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT : , italic_j end_POSTSUBSCRIPT ≈ ∑ start_POSTSUBSCRIPT italic_m = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT bold_italic_B start_POSTSUBSCRIPT : , italic_m end_POSTSUBSCRIPT bold_italic_C start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_m , italic_j end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p2.28">where <math alttext="{\bm{C}}^{(i)}" class="ltx_Math" display="inline" id="S3.SS1.p2.27.m1.1"><semantics id="S3.SS1.p2.27.m1.1a"><msup id="S3.SS1.p2.27.m1.1.2" xref="S3.SS1.p2.27.m1.1.2.cmml"><mi id="S3.SS1.p2.27.m1.1.2.2" xref="S3.SS1.p2.27.m1.1.2.2.cmml">𝑪</mi><mrow id="S3.SS1.p2.27.m1.1.1.1.3" xref="S3.SS1.p2.27.m1.1.2.cmml"><mo id="S3.SS1.p2.27.m1.1.1.1.3.1" stretchy="false" xref="S3.SS1.p2.27.m1.1.2.cmml">(</mo><mi id="S3.SS1.p2.27.m1.1.1.1.1" xref="S3.SS1.p2.27.m1.1.1.1.1.cmml">i</mi><mo id="S3.SS1.p2.27.m1.1.1.1.3.2" stretchy="false" xref="S3.SS1.p2.27.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.27.m1.1b"><apply id="S3.SS1.p2.27.m1.1.2.cmml" xref="S3.SS1.p2.27.m1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.27.m1.1.2.1.cmml" xref="S3.SS1.p2.27.m1.1.2">superscript</csymbol><ci id="S3.SS1.p2.27.m1.1.2.2.cmml" xref="S3.SS1.p2.27.m1.1.2.2">𝑪</ci><ci id="S3.SS1.p2.27.m1.1.1.1.1.cmml" xref="S3.SS1.p2.27.m1.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.27.m1.1c">{\bm{C}}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.27.m1.1d">bold_italic_C start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> is the coefficient matrix in <math alttext="i^{th}" class="ltx_Math" display="inline" id="S3.SS1.p2.28.m2.1"><semantics id="S3.SS1.p2.28.m2.1a"><msup id="S3.SS1.p2.28.m2.1.1" xref="S3.SS1.p2.28.m2.1.1.cmml"><mi id="S3.SS1.p2.28.m2.1.1.2" xref="S3.SS1.p2.28.m2.1.1.2.cmml">i</mi><mrow id="S3.SS1.p2.28.m2.1.1.3" xref="S3.SS1.p2.28.m2.1.1.3.cmml"><mi id="S3.SS1.p2.28.m2.1.1.3.2" xref="S3.SS1.p2.28.m2.1.1.3.2.cmml">t</mi><mo id="S3.SS1.p2.28.m2.1.1.3.1" xref="S3.SS1.p2.28.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p2.28.m2.1.1.3.3" xref="S3.SS1.p2.28.m2.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.28.m2.1b"><apply id="S3.SS1.p2.28.m2.1.1.cmml" xref="S3.SS1.p2.28.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.28.m2.1.1.1.cmml" xref="S3.SS1.p2.28.m2.1.1">superscript</csymbol><ci id="S3.SS1.p2.28.m2.1.1.2.cmml" xref="S3.SS1.p2.28.m2.1.1.2">𝑖</ci><apply id="S3.SS1.p2.28.m2.1.1.3.cmml" xref="S3.SS1.p2.28.m2.1.1.3"><times id="S3.SS1.p2.28.m2.1.1.3.1.cmml" xref="S3.SS1.p2.28.m2.1.1.3.1"></times><ci id="S3.SS1.p2.28.m2.1.1.3.2.cmml" xref="S3.SS1.p2.28.m2.1.1.3.2">𝑡</ci><ci id="S3.SS1.p2.28.m2.1.1.3.3.cmml" xref="S3.SS1.p2.28.m2.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.28.m2.1c">i^{th}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.28.m2.1d">italic_i start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> layer.
The process of weight matrix approximation and representation is illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#S3.F3" title="Figure 3 ‣ 3.1 Representing Weight Matrices across Layers with Combinations of Basis Vectors and Coefficients ‣ 3 Methodology ‣ Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<figure class="ltx_figure" id="S3.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_middle" id="S3.F3.7" style="width:230.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="443" id="S3.F3.1.g1" src="x2.png" width="831"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Weight matrices across <math alttext="n" class="ltx_Math" display="inline" id="S3.F3.5.4.m1.1"><semantics id="S3.F3.5.4.m1.1b"><mi id="S3.F3.5.4.m1.1.1" xref="S3.F3.5.4.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.F3.5.4.m1.1c"><ci id="S3.F3.5.4.m1.1.1.cmml" xref="S3.F3.5.4.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.5.4.m1.1d">n</annotation><annotation encoding="application/x-llamapun" id="S3.F3.5.4.m1.1e">italic_n</annotation></semantics></math> layers are concatenated horizontally into a weight matrix, which is processed by SVD. The <math alttext="j^{th}" class="ltx_Math" display="inline" id="S3.F3.6.5.m2.1"><semantics id="S3.F3.6.5.m2.1b"><msup id="S3.F3.6.5.m2.1.1" xref="S3.F3.6.5.m2.1.1.cmml"><mi id="S3.F3.6.5.m2.1.1.2" xref="S3.F3.6.5.m2.1.1.2.cmml">j</mi><mrow id="S3.F3.6.5.m2.1.1.3" xref="S3.F3.6.5.m2.1.1.3.cmml"><mi id="S3.F3.6.5.m2.1.1.3.2" xref="S3.F3.6.5.m2.1.1.3.2.cmml">t</mi><mo id="S3.F3.6.5.m2.1.1.3.1" xref="S3.F3.6.5.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.F3.6.5.m2.1.1.3.3" xref="S3.F3.6.5.m2.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.F3.6.5.m2.1c"><apply id="S3.F3.6.5.m2.1.1.cmml" xref="S3.F3.6.5.m2.1.1"><csymbol cd="ambiguous" id="S3.F3.6.5.m2.1.1.1.cmml" xref="S3.F3.6.5.m2.1.1">superscript</csymbol><ci id="S3.F3.6.5.m2.1.1.2.cmml" xref="S3.F3.6.5.m2.1.1.2">𝑗</ci><apply id="S3.F3.6.5.m2.1.1.3.cmml" xref="S3.F3.6.5.m2.1.1.3"><times id="S3.F3.6.5.m2.1.1.3.1.cmml" xref="S3.F3.6.5.m2.1.1.3.1"></times><ci id="S3.F3.6.5.m2.1.1.3.2.cmml" xref="S3.F3.6.5.m2.1.1.3.2">𝑡</ci><ci id="S3.F3.6.5.m2.1.1.3.3.cmml" xref="S3.F3.6.5.m2.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.6.5.m2.1d">j^{th}</annotation><annotation encoding="application/x-llamapun" id="S3.F3.6.5.m2.1e">italic_j start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> column of the original weight matrix in a layer
can be represented as a linear combination of <math alttext="k" class="ltx_Math" display="inline" id="S3.F3.7.6.m3.1"><semantics id="S3.F3.7.6.m3.1b"><mi id="S3.F3.7.6.m3.1.1" xref="S3.F3.7.6.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.F3.7.6.m3.1c"><ci id="S3.F3.7.6.m3.1.1.cmml" xref="S3.F3.7.6.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.7.6.m3.1d">k</annotation><annotation encoding="application/x-llamapun" id="S3.F3.7.6.m3.1e">italic_k</annotation></semantics></math> shared basis vectors and coefficients.</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_middle" id="S3.F3.20" style="width:151.0pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="693" id="S3.F3.8.g1" src="x3.png" width="746"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>
<math alttext="\Delta{\bm{W}}_{1}" class="ltx_Math" display="inline" id="S3.F3.15.7.m1.1"><semantics id="S3.F3.15.7.m1.1b"><mrow id="S3.F3.15.7.m1.1.1" xref="S3.F3.15.7.m1.1.1.cmml"><mi id="S3.F3.15.7.m1.1.1.2" mathvariant="normal" xref="S3.F3.15.7.m1.1.1.2.cmml">Δ</mi><mo id="S3.F3.15.7.m1.1.1.1" xref="S3.F3.15.7.m1.1.1.1.cmml">⁢</mo><msub id="S3.F3.15.7.m1.1.1.3" xref="S3.F3.15.7.m1.1.1.3.cmml"><mi id="S3.F3.15.7.m1.1.1.3.2" xref="S3.F3.15.7.m1.1.1.3.2.cmml">𝑾</mi><mn id="S3.F3.15.7.m1.1.1.3.3" xref="S3.F3.15.7.m1.1.1.3.3.cmml">1</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.F3.15.7.m1.1c"><apply id="S3.F3.15.7.m1.1.1.cmml" xref="S3.F3.15.7.m1.1.1"><times id="S3.F3.15.7.m1.1.1.1.cmml" xref="S3.F3.15.7.m1.1.1.1"></times><ci id="S3.F3.15.7.m1.1.1.2.cmml" xref="S3.F3.15.7.m1.1.1.2">Δ</ci><apply id="S3.F3.15.7.m1.1.1.3.cmml" xref="S3.F3.15.7.m1.1.1.3"><csymbol cd="ambiguous" id="S3.F3.15.7.m1.1.1.3.1.cmml" xref="S3.F3.15.7.m1.1.1.3">subscript</csymbol><ci id="S3.F3.15.7.m1.1.1.3.2.cmml" xref="S3.F3.15.7.m1.1.1.3.2">𝑾</ci><cn id="S3.F3.15.7.m1.1.1.3.3.cmml" type="integer" xref="S3.F3.15.7.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.15.7.m1.1d">\Delta{\bm{W}}_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.F3.15.7.m1.1e">roman_Δ bold_italic_W start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\Delta{\bm{W}}_{2}" class="ltx_Math" display="inline" id="S3.F3.16.8.m2.1"><semantics id="S3.F3.16.8.m2.1b"><mrow id="S3.F3.16.8.m2.1.1" xref="S3.F3.16.8.m2.1.1.cmml"><mi id="S3.F3.16.8.m2.1.1.2" mathvariant="normal" xref="S3.F3.16.8.m2.1.1.2.cmml">Δ</mi><mo id="S3.F3.16.8.m2.1.1.1" xref="S3.F3.16.8.m2.1.1.1.cmml">⁢</mo><msub id="S3.F3.16.8.m2.1.1.3" xref="S3.F3.16.8.m2.1.1.3.cmml"><mi id="S3.F3.16.8.m2.1.1.3.2" xref="S3.F3.16.8.m2.1.1.3.2.cmml">𝑾</mi><mn id="S3.F3.16.8.m2.1.1.3.3" xref="S3.F3.16.8.m2.1.1.3.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.F3.16.8.m2.1c"><apply id="S3.F3.16.8.m2.1.1.cmml" xref="S3.F3.16.8.m2.1.1"><times id="S3.F3.16.8.m2.1.1.1.cmml" xref="S3.F3.16.8.m2.1.1.1"></times><ci id="S3.F3.16.8.m2.1.1.2.cmml" xref="S3.F3.16.8.m2.1.1.2">Δ</ci><apply id="S3.F3.16.8.m2.1.1.3.cmml" xref="S3.F3.16.8.m2.1.1.3"><csymbol cd="ambiguous" id="S3.F3.16.8.m2.1.1.3.1.cmml" xref="S3.F3.16.8.m2.1.1.3">subscript</csymbol><ci id="S3.F3.16.8.m2.1.1.3.2.cmml" xref="S3.F3.16.8.m2.1.1.3.2">𝑾</ci><cn id="S3.F3.16.8.m2.1.1.3.3.cmml" type="integer" xref="S3.F3.16.8.m2.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.16.8.m2.1d">\Delta{\bm{W}}_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.F3.16.8.m2.1e">roman_Δ bold_italic_W start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> are differences with respect to the original weight matrix after compression. <math alttext="||\Delta{\bm{W}}_{1}||_{F}" class="ltx_Math" display="inline" id="S3.F3.17.9.m3.1"><semantics id="S3.F3.17.9.m3.1b"><msub id="S3.F3.17.9.m3.1.1" xref="S3.F3.17.9.m3.1.1.cmml"><mrow id="S3.F3.17.9.m3.1.1.1.1" xref="S3.F3.17.9.m3.1.1.1.2.cmml"><mo id="S3.F3.17.9.m3.1.1.1.1.2" stretchy="false" xref="S3.F3.17.9.m3.1.1.1.2.1.cmml">‖</mo><mrow id="S3.F3.17.9.m3.1.1.1.1.1" xref="S3.F3.17.9.m3.1.1.1.1.1.cmml"><mi id="S3.F3.17.9.m3.1.1.1.1.1.2" mathvariant="normal" xref="S3.F3.17.9.m3.1.1.1.1.1.2.cmml">Δ</mi><mo id="S3.F3.17.9.m3.1.1.1.1.1.1" xref="S3.F3.17.9.m3.1.1.1.1.1.1.cmml">⁢</mo><msub id="S3.F3.17.9.m3.1.1.1.1.1.3" xref="S3.F3.17.9.m3.1.1.1.1.1.3.cmml"><mi id="S3.F3.17.9.m3.1.1.1.1.1.3.2" xref="S3.F3.17.9.m3.1.1.1.1.1.3.2.cmml">𝑾</mi><mn id="S3.F3.17.9.m3.1.1.1.1.1.3.3" xref="S3.F3.17.9.m3.1.1.1.1.1.3.3.cmml">1</mn></msub></mrow><mo id="S3.F3.17.9.m3.1.1.1.1.3" stretchy="false" xref="S3.F3.17.9.m3.1.1.1.2.1.cmml">‖</mo></mrow><mi id="S3.F3.17.9.m3.1.1.3" xref="S3.F3.17.9.m3.1.1.3.cmml">F</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F3.17.9.m3.1c"><apply id="S3.F3.17.9.m3.1.1.cmml" xref="S3.F3.17.9.m3.1.1"><csymbol cd="ambiguous" id="S3.F3.17.9.m3.1.1.2.cmml" xref="S3.F3.17.9.m3.1.1">subscript</csymbol><apply id="S3.F3.17.9.m3.1.1.1.2.cmml" xref="S3.F3.17.9.m3.1.1.1.1"><csymbol cd="latexml" id="S3.F3.17.9.m3.1.1.1.2.1.cmml" xref="S3.F3.17.9.m3.1.1.1.1.2">norm</csymbol><apply id="S3.F3.17.9.m3.1.1.1.1.1.cmml" xref="S3.F3.17.9.m3.1.1.1.1.1"><times id="S3.F3.17.9.m3.1.1.1.1.1.1.cmml" xref="S3.F3.17.9.m3.1.1.1.1.1.1"></times><ci id="S3.F3.17.9.m3.1.1.1.1.1.2.cmml" xref="S3.F3.17.9.m3.1.1.1.1.1.2">Δ</ci><apply id="S3.F3.17.9.m3.1.1.1.1.1.3.cmml" xref="S3.F3.17.9.m3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.F3.17.9.m3.1.1.1.1.1.3.1.cmml" xref="S3.F3.17.9.m3.1.1.1.1.1.3">subscript</csymbol><ci id="S3.F3.17.9.m3.1.1.1.1.1.3.2.cmml" xref="S3.F3.17.9.m3.1.1.1.1.1.3.2">𝑾</ci><cn id="S3.F3.17.9.m3.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.F3.17.9.m3.1.1.1.1.1.3.3">1</cn></apply></apply></apply><ci id="S3.F3.17.9.m3.1.1.3.cmml" xref="S3.F3.17.9.m3.1.1.3">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.17.9.m3.1d">||\Delta{\bm{W}}_{1}||_{F}</annotation><annotation encoding="application/x-llamapun" id="S3.F3.17.9.m3.1e">| | roman_Δ bold_italic_W start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT | | start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT</annotation></semantics></math> is smaller than <math alttext="||\Delta{\bm{W}}_{2}||_{F}" class="ltx_Math" display="inline" id="S3.F3.18.10.m4.1"><semantics id="S3.F3.18.10.m4.1b"><msub id="S3.F3.18.10.m4.1.1" xref="S3.F3.18.10.m4.1.1.cmml"><mrow id="S3.F3.18.10.m4.1.1.1.1" xref="S3.F3.18.10.m4.1.1.1.2.cmml"><mo id="S3.F3.18.10.m4.1.1.1.1.2" stretchy="false" xref="S3.F3.18.10.m4.1.1.1.2.1.cmml">‖</mo><mrow id="S3.F3.18.10.m4.1.1.1.1.1" xref="S3.F3.18.10.m4.1.1.1.1.1.cmml"><mi id="S3.F3.18.10.m4.1.1.1.1.1.2" mathvariant="normal" xref="S3.F3.18.10.m4.1.1.1.1.1.2.cmml">Δ</mi><mo id="S3.F3.18.10.m4.1.1.1.1.1.1" xref="S3.F3.18.10.m4.1.1.1.1.1.1.cmml">⁢</mo><msub id="S3.F3.18.10.m4.1.1.1.1.1.3" xref="S3.F3.18.10.m4.1.1.1.1.1.3.cmml"><mi id="S3.F3.18.10.m4.1.1.1.1.1.3.2" xref="S3.F3.18.10.m4.1.1.1.1.1.3.2.cmml">𝑾</mi><mn id="S3.F3.18.10.m4.1.1.1.1.1.3.3" xref="S3.F3.18.10.m4.1.1.1.1.1.3.3.cmml">2</mn></msub></mrow><mo id="S3.F3.18.10.m4.1.1.1.1.3" stretchy="false" xref="S3.F3.18.10.m4.1.1.1.2.1.cmml">‖</mo></mrow><mi id="S3.F3.18.10.m4.1.1.3" xref="S3.F3.18.10.m4.1.1.3.cmml">F</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F3.18.10.m4.1c"><apply id="S3.F3.18.10.m4.1.1.cmml" xref="S3.F3.18.10.m4.1.1"><csymbol cd="ambiguous" id="S3.F3.18.10.m4.1.1.2.cmml" xref="S3.F3.18.10.m4.1.1">subscript</csymbol><apply id="S3.F3.18.10.m4.1.1.1.2.cmml" xref="S3.F3.18.10.m4.1.1.1.1"><csymbol cd="latexml" id="S3.F3.18.10.m4.1.1.1.2.1.cmml" xref="S3.F3.18.10.m4.1.1.1.1.2">norm</csymbol><apply id="S3.F3.18.10.m4.1.1.1.1.1.cmml" xref="S3.F3.18.10.m4.1.1.1.1.1"><times id="S3.F3.18.10.m4.1.1.1.1.1.1.cmml" xref="S3.F3.18.10.m4.1.1.1.1.1.1"></times><ci id="S3.F3.18.10.m4.1.1.1.1.1.2.cmml" xref="S3.F3.18.10.m4.1.1.1.1.1.2">Δ</ci><apply id="S3.F3.18.10.m4.1.1.1.1.1.3.cmml" xref="S3.F3.18.10.m4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.F3.18.10.m4.1.1.1.1.1.3.1.cmml" xref="S3.F3.18.10.m4.1.1.1.1.1.3">subscript</csymbol><ci id="S3.F3.18.10.m4.1.1.1.1.1.3.2.cmml" xref="S3.F3.18.10.m4.1.1.1.1.1.3.2">𝑾</ci><cn id="S3.F3.18.10.m4.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.F3.18.10.m4.1.1.1.1.1.3.3">2</cn></apply></apply></apply><ci id="S3.F3.18.10.m4.1.1.3.cmml" xref="S3.F3.18.10.m4.1.1.3">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.18.10.m4.1d">||\Delta{\bm{W}}_{2}||_{F}</annotation><annotation encoding="application/x-llamapun" id="S3.F3.18.10.m4.1e">| | roman_Δ bold_italic_W start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT | | start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT</annotation></semantics></math>, but <math alttext="||{\bm{X}}\Delta{\bm{W}}_{1}||_{F}" class="ltx_Math" display="inline" id="S3.F3.19.11.m5.1"><semantics id="S3.F3.19.11.m5.1b"><msub id="S3.F3.19.11.m5.1.1" xref="S3.F3.19.11.m5.1.1.cmml"><mrow id="S3.F3.19.11.m5.1.1.1.1" xref="S3.F3.19.11.m5.1.1.1.2.cmml"><mo id="S3.F3.19.11.m5.1.1.1.1.2" stretchy="false" xref="S3.F3.19.11.m5.1.1.1.2.1.cmml">‖</mo><mrow id="S3.F3.19.11.m5.1.1.1.1.1" xref="S3.F3.19.11.m5.1.1.1.1.1.cmml"><mi id="S3.F3.19.11.m5.1.1.1.1.1.2" xref="S3.F3.19.11.m5.1.1.1.1.1.2.cmml">𝑿</mi><mo id="S3.F3.19.11.m5.1.1.1.1.1.1" xref="S3.F3.19.11.m5.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.F3.19.11.m5.1.1.1.1.1.3" mathvariant="normal" xref="S3.F3.19.11.m5.1.1.1.1.1.3.cmml">Δ</mi><mo id="S3.F3.19.11.m5.1.1.1.1.1.1b" xref="S3.F3.19.11.m5.1.1.1.1.1.1.cmml">⁢</mo><msub id="S3.F3.19.11.m5.1.1.1.1.1.4" xref="S3.F3.19.11.m5.1.1.1.1.1.4.cmml"><mi id="S3.F3.19.11.m5.1.1.1.1.1.4.2" xref="S3.F3.19.11.m5.1.1.1.1.1.4.2.cmml">𝑾</mi><mn id="S3.F3.19.11.m5.1.1.1.1.1.4.3" xref="S3.F3.19.11.m5.1.1.1.1.1.4.3.cmml">1</mn></msub></mrow><mo id="S3.F3.19.11.m5.1.1.1.1.3" stretchy="false" xref="S3.F3.19.11.m5.1.1.1.2.1.cmml">‖</mo></mrow><mi id="S3.F3.19.11.m5.1.1.3" xref="S3.F3.19.11.m5.1.1.3.cmml">F</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F3.19.11.m5.1c"><apply id="S3.F3.19.11.m5.1.1.cmml" xref="S3.F3.19.11.m5.1.1"><csymbol cd="ambiguous" id="S3.F3.19.11.m5.1.1.2.cmml" xref="S3.F3.19.11.m5.1.1">subscript</csymbol><apply id="S3.F3.19.11.m5.1.1.1.2.cmml" xref="S3.F3.19.11.m5.1.1.1.1"><csymbol cd="latexml" id="S3.F3.19.11.m5.1.1.1.2.1.cmml" xref="S3.F3.19.11.m5.1.1.1.1.2">norm</csymbol><apply id="S3.F3.19.11.m5.1.1.1.1.1.cmml" xref="S3.F3.19.11.m5.1.1.1.1.1"><times id="S3.F3.19.11.m5.1.1.1.1.1.1.cmml" xref="S3.F3.19.11.m5.1.1.1.1.1.1"></times><ci id="S3.F3.19.11.m5.1.1.1.1.1.2.cmml" xref="S3.F3.19.11.m5.1.1.1.1.1.2">𝑿</ci><ci id="S3.F3.19.11.m5.1.1.1.1.1.3.cmml" xref="S3.F3.19.11.m5.1.1.1.1.1.3">Δ</ci><apply id="S3.F3.19.11.m5.1.1.1.1.1.4.cmml" xref="S3.F3.19.11.m5.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.F3.19.11.m5.1.1.1.1.1.4.1.cmml" xref="S3.F3.19.11.m5.1.1.1.1.1.4">subscript</csymbol><ci id="S3.F3.19.11.m5.1.1.1.1.1.4.2.cmml" xref="S3.F3.19.11.m5.1.1.1.1.1.4.2">𝑾</ci><cn id="S3.F3.19.11.m5.1.1.1.1.1.4.3.cmml" type="integer" xref="S3.F3.19.11.m5.1.1.1.1.1.4.3">1</cn></apply></apply></apply><ci id="S3.F3.19.11.m5.1.1.3.cmml" xref="S3.F3.19.11.m5.1.1.3">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.19.11.m5.1d">||{\bm{X}}\Delta{\bm{W}}_{1}||_{F}</annotation><annotation encoding="application/x-llamapun" id="S3.F3.19.11.m5.1e">| | bold_italic_X roman_Δ bold_italic_W start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT | | start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT</annotation></semantics></math> is larger than <math alttext="||{\bm{X}}\Delta{\bm{W}}_{2}||_{F}" class="ltx_Math" display="inline" id="S3.F3.20.12.m6.1"><semantics id="S3.F3.20.12.m6.1b"><msub id="S3.F3.20.12.m6.1.1" xref="S3.F3.20.12.m6.1.1.cmml"><mrow id="S3.F3.20.12.m6.1.1.1.1" xref="S3.F3.20.12.m6.1.1.1.2.cmml"><mo id="S3.F3.20.12.m6.1.1.1.1.2" stretchy="false" xref="S3.F3.20.12.m6.1.1.1.2.1.cmml">‖</mo><mrow id="S3.F3.20.12.m6.1.1.1.1.1" xref="S3.F3.20.12.m6.1.1.1.1.1.cmml"><mi id="S3.F3.20.12.m6.1.1.1.1.1.2" xref="S3.F3.20.12.m6.1.1.1.1.1.2.cmml">𝑿</mi><mo id="S3.F3.20.12.m6.1.1.1.1.1.1" xref="S3.F3.20.12.m6.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.F3.20.12.m6.1.1.1.1.1.3" mathvariant="normal" xref="S3.F3.20.12.m6.1.1.1.1.1.3.cmml">Δ</mi><mo id="S3.F3.20.12.m6.1.1.1.1.1.1b" xref="S3.F3.20.12.m6.1.1.1.1.1.1.cmml">⁢</mo><msub id="S3.F3.20.12.m6.1.1.1.1.1.4" xref="S3.F3.20.12.m6.1.1.1.1.1.4.cmml"><mi id="S3.F3.20.12.m6.1.1.1.1.1.4.2" xref="S3.F3.20.12.m6.1.1.1.1.1.4.2.cmml">𝑾</mi><mn id="S3.F3.20.12.m6.1.1.1.1.1.4.3" xref="S3.F3.20.12.m6.1.1.1.1.1.4.3.cmml">2</mn></msub></mrow><mo id="S3.F3.20.12.m6.1.1.1.1.3" stretchy="false" xref="S3.F3.20.12.m6.1.1.1.2.1.cmml">‖</mo></mrow><mi id="S3.F3.20.12.m6.1.1.3" xref="S3.F3.20.12.m6.1.1.3.cmml">F</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F3.20.12.m6.1c"><apply id="S3.F3.20.12.m6.1.1.cmml" xref="S3.F3.20.12.m6.1.1"><csymbol cd="ambiguous" id="S3.F3.20.12.m6.1.1.2.cmml" xref="S3.F3.20.12.m6.1.1">subscript</csymbol><apply id="S3.F3.20.12.m6.1.1.1.2.cmml" xref="S3.F3.20.12.m6.1.1.1.1"><csymbol cd="latexml" id="S3.F3.20.12.m6.1.1.1.2.1.cmml" xref="S3.F3.20.12.m6.1.1.1.1.2">norm</csymbol><apply id="S3.F3.20.12.m6.1.1.1.1.1.cmml" xref="S3.F3.20.12.m6.1.1.1.1.1"><times id="S3.F3.20.12.m6.1.1.1.1.1.1.cmml" xref="S3.F3.20.12.m6.1.1.1.1.1.1"></times><ci id="S3.F3.20.12.m6.1.1.1.1.1.2.cmml" xref="S3.F3.20.12.m6.1.1.1.1.1.2">𝑿</ci><ci id="S3.F3.20.12.m6.1.1.1.1.1.3.cmml" xref="S3.F3.20.12.m6.1.1.1.1.1.3">Δ</ci><apply id="S3.F3.20.12.m6.1.1.1.1.1.4.cmml" xref="S3.F3.20.12.m6.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.F3.20.12.m6.1.1.1.1.1.4.1.cmml" xref="S3.F3.20.12.m6.1.1.1.1.1.4">subscript</csymbol><ci id="S3.F3.20.12.m6.1.1.1.1.1.4.2.cmml" xref="S3.F3.20.12.m6.1.1.1.1.1.4.2">𝑾</ci><cn id="S3.F3.20.12.m6.1.1.1.1.1.4.3.cmml" type="integer" xref="S3.F3.20.12.m6.1.1.1.1.1.4.3">2</cn></apply></apply></apply><ci id="S3.F3.20.12.m6.1.1.3.cmml" xref="S3.F3.20.12.m6.1.1.3">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.20.12.m6.1d">||{\bm{X}}\Delta{\bm{W}}_{2}||_{F}</annotation><annotation encoding="application/x-llamapun" id="S3.F3.20.12.m6.1e">| | bold_italic_X roman_Δ bold_italic_W start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT | | start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT</annotation></semantics></math>.
</figcaption>
</figure>
</div>
</div>
</figure>
<div class="ltx_para ltx_noindent" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.4">In the weight matrix approximation with SVD above, input data, denoted as <math alttext="\displaystyle{\bm{X}}" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.1"><semantics id="S3.SS1.p3.1.m1.1a"><mi id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml">𝑿</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><ci id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">𝑿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">\displaystyle{\bm{X}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.1d">bold_italic_X</annotation></semantics></math>, are not considered. In fact, the result of <math alttext="\displaystyle{\bm{X}}{\bm{W}}" class="ltx_Math" display="inline" id="S3.SS1.p3.2.m2.1"><semantics id="S3.SS1.p3.2.m2.1a"><mrow id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml"><mi id="S3.SS1.p3.2.m2.1.1.2" xref="S3.SS1.p3.2.m2.1.1.2.cmml">𝑿</mi><mo id="S3.SS1.p3.2.m2.1.1.1" xref="S3.SS1.p3.2.m2.1.1.1.cmml">⁢</mo><mi id="S3.SS1.p3.2.m2.1.1.3" xref="S3.SS1.p3.2.m2.1.1.3.cmml">𝑾</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><apply id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1"><times id="S3.SS1.p3.2.m2.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1.1"></times><ci id="S3.SS1.p3.2.m2.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1.2">𝑿</ci><ci id="S3.SS1.p3.2.m2.1.1.3.cmml" xref="S3.SS1.p3.2.m2.1.1.3">𝑾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">\displaystyle{\bm{X}}{\bm{W}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.2.m2.1d">bold_italic_X bold_italic_W</annotation></semantics></math> instead of <math alttext="\displaystyle{\bm{W}}" class="ltx_Math" display="inline" id="S3.SS1.p3.3.m3.1"><semantics id="S3.SS1.p3.3.m3.1a"><mi id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml">𝑾</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><ci id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1">𝑾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">\displaystyle{\bm{W}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.3.m3.1d">bold_italic_W</annotation></semantics></math> is used in inference.
Accordingly, applying SVD directly onto weight matrices
without incorporating input data might lead to significant computation loss and potentially affect the performance of the LLM. Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#S3.F3" title="Figure 3 ‣ 3.1 Representing Weight Matrices across Layers with Combinations of Basis Vectors and Coefficients ‣ 3 Methodology ‣ Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_tag">3</span></a> illustrates an example, where a weight matrix approximated with SVD leads to a large compression loss in the form of Frobenius loss, denoted as <math alttext="\displaystyle||{\bm{X}}\Delta{\bm{W}}||_{F}" class="ltx_Math" display="inline" id="S3.SS1.p3.4.m4.1"><semantics id="S3.SS1.p3.4.m4.1a"><msub id="S3.SS1.p3.4.m4.1.1" xref="S3.SS1.p3.4.m4.1.1.cmml"><mrow id="S3.SS1.p3.4.m4.1.1.1.1" xref="S3.SS1.p3.4.m4.1.1.1.2.cmml"><mo id="S3.SS1.p3.4.m4.1.1.1.1.2" stretchy="false" xref="S3.SS1.p3.4.m4.1.1.1.2.1.cmml">‖</mo><mrow id="S3.SS1.p3.4.m4.1.1.1.1.1" xref="S3.SS1.p3.4.m4.1.1.1.1.1.cmml"><mi id="S3.SS1.p3.4.m4.1.1.1.1.1.2" xref="S3.SS1.p3.4.m4.1.1.1.1.1.2.cmml">𝑿</mi><mo id="S3.SS1.p3.4.m4.1.1.1.1.1.1" xref="S3.SS1.p3.4.m4.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.SS1.p3.4.m4.1.1.1.1.1.3" mathvariant="normal" xref="S3.SS1.p3.4.m4.1.1.1.1.1.3.cmml">Δ</mi><mo id="S3.SS1.p3.4.m4.1.1.1.1.1.1a" xref="S3.SS1.p3.4.m4.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.SS1.p3.4.m4.1.1.1.1.1.4" xref="S3.SS1.p3.4.m4.1.1.1.1.1.4.cmml">𝑾</mi></mrow><mo id="S3.SS1.p3.4.m4.1.1.1.1.3" stretchy="false" xref="S3.SS1.p3.4.m4.1.1.1.2.1.cmml">‖</mo></mrow><mi id="S3.SS1.p3.4.m4.1.1.3" xref="S3.SS1.p3.4.m4.1.1.3.cmml">F</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.1b"><apply id="S3.SS1.p3.4.m4.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m4.1.1.2.cmml" xref="S3.SS1.p3.4.m4.1.1">subscript</csymbol><apply id="S3.SS1.p3.4.m4.1.1.1.2.cmml" xref="S3.SS1.p3.4.m4.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p3.4.m4.1.1.1.2.1.cmml" xref="S3.SS1.p3.4.m4.1.1.1.1.2">norm</csymbol><apply id="S3.SS1.p3.4.m4.1.1.1.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1.1.1.1"><times id="S3.SS1.p3.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1.1.1.1.1"></times><ci id="S3.SS1.p3.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS1.p3.4.m4.1.1.1.1.1.2">𝑿</ci><ci id="S3.SS1.p3.4.m4.1.1.1.1.1.3.cmml" xref="S3.SS1.p3.4.m4.1.1.1.1.1.3">Δ</ci><ci id="S3.SS1.p3.4.m4.1.1.1.1.1.4.cmml" xref="S3.SS1.p3.4.m4.1.1.1.1.1.4">𝑾</ci></apply></apply><ci id="S3.SS1.p3.4.m4.1.1.3.cmml" xref="S3.SS1.p3.4.m4.1.1.3">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.1c">\displaystyle||{\bm{X}}\Delta{\bm{W}}||_{F}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.4.m4.1d">| | bold_italic_X roman_Δ bold_italic_W | | start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT</annotation></semantics></math>.
Since the second element in the input data affects the computation accuracy significantly, the second column of the weight matrix should be approximated more accurately compared with other columns to reduce the overall computation loss. <cite class="ltx_cite ltx_citemacro_citet">Yuan et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib45" title="">2023</a>), Wang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib41" title="">2024b</a>)</cite> also pointed out similar results.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p4">
<p class="ltx_p" id="S3.SS1.p4.2">To incorporate the effect of input data into the weight approximation with SVD to maintain the performance of the LLM, we will scale the concatenated weight matrix <math alttext="\displaystyle{\bm{W}}" class="ltx_Math" display="inline" id="S3.SS1.p4.1.m1.1"><semantics id="S3.SS1.p4.1.m1.1a"><mi id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml">𝑾</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b"><ci id="S3.SS1.p4.1.m1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1">𝑾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">\displaystyle{\bm{W}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.1.m1.1d">bold_italic_W</annotation></semantics></math> with a matrix <math alttext="\displaystyle{\bm{S}}\in\mathbb{R}^{d_{1}\times d_{1}}" class="ltx_Math" display="inline" id="S3.SS1.p4.2.m2.1"><semantics id="S3.SS1.p4.2.m2.1a"><mrow id="S3.SS1.p4.2.m2.1.1" xref="S3.SS1.p4.2.m2.1.1.cmml"><mi id="S3.SS1.p4.2.m2.1.1.2" xref="S3.SS1.p4.2.m2.1.1.2.cmml">𝑺</mi><mo id="S3.SS1.p4.2.m2.1.1.1" xref="S3.SS1.p4.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS1.p4.2.m2.1.1.3" xref="S3.SS1.p4.2.m2.1.1.3.cmml"><mi id="S3.SS1.p4.2.m2.1.1.3.2" xref="S3.SS1.p4.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p4.2.m2.1.1.3.3" xref="S3.SS1.p4.2.m2.1.1.3.3.cmml"><msub id="S3.SS1.p4.2.m2.1.1.3.3.2" xref="S3.SS1.p4.2.m2.1.1.3.3.2.cmml"><mi id="S3.SS1.p4.2.m2.1.1.3.3.2.2" xref="S3.SS1.p4.2.m2.1.1.3.3.2.2.cmml">d</mi><mn id="S3.SS1.p4.2.m2.1.1.3.3.2.3" xref="S3.SS1.p4.2.m2.1.1.3.3.2.3.cmml">1</mn></msub><mo id="S3.SS1.p4.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p4.2.m2.1.1.3.3.1.cmml">×</mo><msub id="S3.SS1.p4.2.m2.1.1.3.3.3" xref="S3.SS1.p4.2.m2.1.1.3.3.3.cmml"><mi id="S3.SS1.p4.2.m2.1.1.3.3.3.2" xref="S3.SS1.p4.2.m2.1.1.3.3.3.2.cmml">d</mi><mn id="S3.SS1.p4.2.m2.1.1.3.3.3.3" xref="S3.SS1.p4.2.m2.1.1.3.3.3.3.cmml">1</mn></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.2.m2.1b"><apply id="S3.SS1.p4.2.m2.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1"><in id="S3.SS1.p4.2.m2.1.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1.1"></in><ci id="S3.SS1.p4.2.m2.1.1.2.cmml" xref="S3.SS1.p4.2.m2.1.1.2">𝑺</ci><apply id="S3.SS1.p4.2.m2.1.1.3.cmml" xref="S3.SS1.p4.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p4.2.m2.1.1.3.1.cmml" xref="S3.SS1.p4.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS1.p4.2.m2.1.1.3.2.cmml" xref="S3.SS1.p4.2.m2.1.1.3.2">ℝ</ci><apply id="S3.SS1.p4.2.m2.1.1.3.3.cmml" xref="S3.SS1.p4.2.m2.1.1.3.3"><times id="S3.SS1.p4.2.m2.1.1.3.3.1.cmml" xref="S3.SS1.p4.2.m2.1.1.3.3.1"></times><apply id="S3.SS1.p4.2.m2.1.1.3.3.2.cmml" xref="S3.SS1.p4.2.m2.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.p4.2.m2.1.1.3.3.2.1.cmml" xref="S3.SS1.p4.2.m2.1.1.3.3.2">subscript</csymbol><ci id="S3.SS1.p4.2.m2.1.1.3.3.2.2.cmml" xref="S3.SS1.p4.2.m2.1.1.3.3.2.2">𝑑</ci><cn id="S3.SS1.p4.2.m2.1.1.3.3.2.3.cmml" type="integer" xref="S3.SS1.p4.2.m2.1.1.3.3.2.3">1</cn></apply><apply id="S3.SS1.p4.2.m2.1.1.3.3.3.cmml" xref="S3.SS1.p4.2.m2.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p4.2.m2.1.1.3.3.3.1.cmml" xref="S3.SS1.p4.2.m2.1.1.3.3.3">subscript</csymbol><ci id="S3.SS1.p4.2.m2.1.1.3.3.3.2.cmml" xref="S3.SS1.p4.2.m2.1.1.3.3.3.2">𝑑</ci><cn id="S3.SS1.p4.2.m2.1.1.3.3.3.3.cmml" type="integer" xref="S3.SS1.p4.2.m2.1.1.3.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.2.m2.1c">\displaystyle{\bm{S}}\in\mathbb{R}^{d_{1}\times d_{1}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.2.m2.1d">bold_italic_S ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT × italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> as follows</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle{\bm{W}}={\bm{S}}^{-1}{\bm{S}}{\bm{W}}={\bm{S}}^{-1}({\bm{S}}{\bm%
{W}})." class="ltx_Math" display="block" id="S3.E2.m1.1"><semantics id="S3.E2.m1.1a"><mrow id="S3.E2.m1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml"><mrow id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.3.cmml">𝑾</mi><mo id="S3.E2.m1.1.1.1.1.4" xref="S3.E2.m1.1.1.1.1.4.cmml">=</mo><mrow id="S3.E2.m1.1.1.1.1.5" xref="S3.E2.m1.1.1.1.1.5.cmml"><msup id="S3.E2.m1.1.1.1.1.5.2" xref="S3.E2.m1.1.1.1.1.5.2.cmml"><mi id="S3.E2.m1.1.1.1.1.5.2.2" xref="S3.E2.m1.1.1.1.1.5.2.2.cmml">𝑺</mi><mrow id="S3.E2.m1.1.1.1.1.5.2.3" xref="S3.E2.m1.1.1.1.1.5.2.3.cmml"><mo id="S3.E2.m1.1.1.1.1.5.2.3a" xref="S3.E2.m1.1.1.1.1.5.2.3.cmml">−</mo><mn id="S3.E2.m1.1.1.1.1.5.2.3.2" xref="S3.E2.m1.1.1.1.1.5.2.3.2.cmml">1</mn></mrow></msup><mo id="S3.E2.m1.1.1.1.1.5.1" xref="S3.E2.m1.1.1.1.1.5.1.cmml">⁢</mo><mi id="S3.E2.m1.1.1.1.1.5.3" xref="S3.E2.m1.1.1.1.1.5.3.cmml">𝑺</mi><mo id="S3.E2.m1.1.1.1.1.5.1a" xref="S3.E2.m1.1.1.1.1.5.1.cmml">⁢</mo><mi id="S3.E2.m1.1.1.1.1.5.4" xref="S3.E2.m1.1.1.1.1.5.4.cmml">𝑾</mi></mrow><mo id="S3.E2.m1.1.1.1.1.6" xref="S3.E2.m1.1.1.1.1.6.cmml">=</mo><mrow id="S3.E2.m1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.cmml"><msup id="S3.E2.m1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.1.1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.1.1.3.2.cmml">𝑺</mi><mrow id="S3.E2.m1.1.1.1.1.1.3.3" xref="S3.E2.m1.1.1.1.1.1.3.3.cmml"><mo id="S3.E2.m1.1.1.1.1.1.3.3a" xref="S3.E2.m1.1.1.1.1.1.3.3.cmml">−</mo><mn id="S3.E2.m1.1.1.1.1.1.3.3.2" xref="S3.E2.m1.1.1.1.1.1.3.3.2.cmml">1</mn></mrow></msup><mo id="S3.E2.m1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E2.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E2.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.cmml">𝑺</mi><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.3.cmml">𝑾</mi></mrow><mo id="S3.E2.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E2.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E2.m1.1.1.1.2" lspace="0em" xref="S3.E2.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.1b"><apply id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1"><and id="S3.E2.m1.1.1.1.1a.cmml" xref="S3.E2.m1.1.1.1"></and><apply id="S3.E2.m1.1.1.1.1b.cmml" xref="S3.E2.m1.1.1.1"><eq id="S3.E2.m1.1.1.1.1.4.cmml" xref="S3.E2.m1.1.1.1.1.4"></eq><ci id="S3.E2.m1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.3">𝑾</ci><apply id="S3.E2.m1.1.1.1.1.5.cmml" xref="S3.E2.m1.1.1.1.1.5"><times id="S3.E2.m1.1.1.1.1.5.1.cmml" xref="S3.E2.m1.1.1.1.1.5.1"></times><apply id="S3.E2.m1.1.1.1.1.5.2.cmml" xref="S3.E2.m1.1.1.1.1.5.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.5.2.1.cmml" xref="S3.E2.m1.1.1.1.1.5.2">superscript</csymbol><ci id="S3.E2.m1.1.1.1.1.5.2.2.cmml" xref="S3.E2.m1.1.1.1.1.5.2.2">𝑺</ci><apply id="S3.E2.m1.1.1.1.1.5.2.3.cmml" xref="S3.E2.m1.1.1.1.1.5.2.3"><minus id="S3.E2.m1.1.1.1.1.5.2.3.1.cmml" xref="S3.E2.m1.1.1.1.1.5.2.3"></minus><cn id="S3.E2.m1.1.1.1.1.5.2.3.2.cmml" type="integer" xref="S3.E2.m1.1.1.1.1.5.2.3.2">1</cn></apply></apply><ci id="S3.E2.m1.1.1.1.1.5.3.cmml" xref="S3.E2.m1.1.1.1.1.5.3">𝑺</ci><ci id="S3.E2.m1.1.1.1.1.5.4.cmml" xref="S3.E2.m1.1.1.1.1.5.4">𝑾</ci></apply></apply><apply id="S3.E2.m1.1.1.1.1c.cmml" xref="S3.E2.m1.1.1.1"><eq id="S3.E2.m1.1.1.1.1.6.cmml" xref="S3.E2.m1.1.1.1.1.6"></eq><share href="https://arxiv.org/html/2410.03765v1#S3.E2.m1.1.1.1.1.5.cmml" id="S3.E2.m1.1.1.1.1d.cmml" xref="S3.E2.m1.1.1.1"></share><apply id="S3.E2.m1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1"><times id="S3.E2.m1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.2"></times><apply id="S3.E2.m1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.3.2">𝑺</ci><apply id="S3.E2.m1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.3.3"><minus id="S3.E2.m1.1.1.1.1.1.3.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.3.3"></minus><cn id="S3.E2.m1.1.1.1.1.1.3.3.2.cmml" type="integer" xref="S3.E2.m1.1.1.1.1.1.3.3.2">1</cn></apply></apply><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1"><times id="S3.E2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1"></times><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2">𝑺</ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.3">𝑾</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.1c">\displaystyle{\bm{W}}={\bm{S}}^{-1}{\bm{S}}{\bm{W}}={\bm{S}}^{-1}({\bm{S}}{\bm%
{W}}).</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.1d">bold_italic_W = bold_italic_S start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT bold_italic_S bold_italic_W = bold_italic_S start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( bold_italic_S bold_italic_W ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p4.13">The matrix <math alttext="\displaystyle{\bm{S}}" class="ltx_Math" display="inline" id="S3.SS1.p4.3.m1.1"><semantics id="S3.SS1.p4.3.m1.1a"><mi id="S3.SS1.p4.3.m1.1.1" xref="S3.SS1.p4.3.m1.1.1.cmml">𝑺</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.3.m1.1b"><ci id="S3.SS1.p4.3.m1.1.1.cmml" xref="S3.SS1.p4.3.m1.1.1">𝑺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.3.m1.1c">\displaystyle{\bm{S}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.3.m1.1d">bold_italic_S</annotation></semantics></math> should be evaluated to represent the impact of input data on the weights, so that it can adjust <math alttext="\displaystyle{\bm{W}}" class="ltx_Math" display="inline" id="S3.SS1.p4.4.m2.1"><semantics id="S3.SS1.p4.4.m2.1a"><mi id="S3.SS1.p4.4.m2.1.1" xref="S3.SS1.p4.4.m2.1.1.cmml">𝑾</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.4.m2.1b"><ci id="S3.SS1.p4.4.m2.1.1.cmml" xref="S3.SS1.p4.4.m2.1.1">𝑾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.4.m2.1c">\displaystyle{\bm{W}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.4.m2.1d">bold_italic_W</annotation></semantics></math> accordingly to reflect the significance of
different input data. To obtain appropriate <math alttext="\displaystyle{\bm{S}}" class="ltx_Math" display="inline" id="S3.SS1.p4.5.m3.1"><semantics id="S3.SS1.p4.5.m3.1a"><mi id="S3.SS1.p4.5.m3.1.1" xref="S3.SS1.p4.5.m3.1.1.cmml">𝑺</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.5.m3.1b"><ci id="S3.SS1.p4.5.m3.1.1.cmml" xref="S3.SS1.p4.5.m3.1.1">𝑺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.5.m3.1c">\displaystyle{\bm{S}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.5.m3.1d">bold_italic_S</annotation></semantics></math>,
we will adapt the techniques developed in <cite class="ltx_cite ltx_citemacro_citet">Wang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib41" title="">2024b</a>)</cite>, where <math alttext="\displaystyle{\bm{S}}" class="ltx_Math" display="inline" id="S3.SS1.p4.6.m4.1"><semantics id="S3.SS1.p4.6.m4.1a"><mi id="S3.SS1.p4.6.m4.1.1" xref="S3.SS1.p4.6.m4.1.1.cmml">𝑺</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.6.m4.1b"><ci id="S3.SS1.p4.6.m4.1.1.cmml" xref="S3.SS1.p4.6.m4.1.1">𝑺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.6.m4.1c">\displaystyle{\bm{S}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.6.m4.1d">bold_italic_S</annotation></semantics></math> can be evaluated with <math alttext="\displaystyle{\bm{S}}({\bm{S}})^{T}=cholesky(({\bm{X}})^{T}{\bm{X}})" class="ltx_Math" display="inline" id="S3.SS1.p4.7.m5.3"><semantics id="S3.SS1.p4.7.m5.3a"><mrow id="S3.SS1.p4.7.m5.3.3" xref="S3.SS1.p4.7.m5.3.3.cmml"><mrow id="S3.SS1.p4.7.m5.3.3.3" xref="S3.SS1.p4.7.m5.3.3.3.cmml"><mi id="S3.SS1.p4.7.m5.3.3.3.2" xref="S3.SS1.p4.7.m5.3.3.3.2.cmml">𝑺</mi><mo id="S3.SS1.p4.7.m5.3.3.3.1" xref="S3.SS1.p4.7.m5.3.3.3.1.cmml">⁢</mo><msup id="S3.SS1.p4.7.m5.3.3.3.3" xref="S3.SS1.p4.7.m5.3.3.3.3.cmml"><mrow id="S3.SS1.p4.7.m5.3.3.3.3.2.2" xref="S3.SS1.p4.7.m5.3.3.3.3.cmml"><mo id="S3.SS1.p4.7.m5.3.3.3.3.2.2.1" stretchy="false" xref="S3.SS1.p4.7.m5.3.3.3.3.cmml">(</mo><mi id="S3.SS1.p4.7.m5.1.1" xref="S3.SS1.p4.7.m5.1.1.cmml">𝑺</mi><mo id="S3.SS1.p4.7.m5.3.3.3.3.2.2.2" stretchy="false" xref="S3.SS1.p4.7.m5.3.3.3.3.cmml">)</mo></mrow><mi id="S3.SS1.p4.7.m5.3.3.3.3.3" xref="S3.SS1.p4.7.m5.3.3.3.3.3.cmml">T</mi></msup></mrow><mo id="S3.SS1.p4.7.m5.3.3.2" xref="S3.SS1.p4.7.m5.3.3.2.cmml">=</mo><mrow id="S3.SS1.p4.7.m5.3.3.1" xref="S3.SS1.p4.7.m5.3.3.1.cmml"><mi id="S3.SS1.p4.7.m5.3.3.1.3" xref="S3.SS1.p4.7.m5.3.3.1.3.cmml">c</mi><mo id="S3.SS1.p4.7.m5.3.3.1.2" xref="S3.SS1.p4.7.m5.3.3.1.2.cmml">⁢</mo><mi id="S3.SS1.p4.7.m5.3.3.1.4" xref="S3.SS1.p4.7.m5.3.3.1.4.cmml">h</mi><mo id="S3.SS1.p4.7.m5.3.3.1.2a" xref="S3.SS1.p4.7.m5.3.3.1.2.cmml">⁢</mo><mi id="S3.SS1.p4.7.m5.3.3.1.5" xref="S3.SS1.p4.7.m5.3.3.1.5.cmml">o</mi><mo id="S3.SS1.p4.7.m5.3.3.1.2b" xref="S3.SS1.p4.7.m5.3.3.1.2.cmml">⁢</mo><mi id="S3.SS1.p4.7.m5.3.3.1.6" xref="S3.SS1.p4.7.m5.3.3.1.6.cmml">l</mi><mo id="S3.SS1.p4.7.m5.3.3.1.2c" xref="S3.SS1.p4.7.m5.3.3.1.2.cmml">⁢</mo><mi id="S3.SS1.p4.7.m5.3.3.1.7" xref="S3.SS1.p4.7.m5.3.3.1.7.cmml">e</mi><mo id="S3.SS1.p4.7.m5.3.3.1.2d" xref="S3.SS1.p4.7.m5.3.3.1.2.cmml">⁢</mo><mi id="S3.SS1.p4.7.m5.3.3.1.8" xref="S3.SS1.p4.7.m5.3.3.1.8.cmml">s</mi><mo id="S3.SS1.p4.7.m5.3.3.1.2e" xref="S3.SS1.p4.7.m5.3.3.1.2.cmml">⁢</mo><mi id="S3.SS1.p4.7.m5.3.3.1.9" xref="S3.SS1.p4.7.m5.3.3.1.9.cmml">k</mi><mo id="S3.SS1.p4.7.m5.3.3.1.2f" xref="S3.SS1.p4.7.m5.3.3.1.2.cmml">⁢</mo><mi id="S3.SS1.p4.7.m5.3.3.1.10" xref="S3.SS1.p4.7.m5.3.3.1.10.cmml">y</mi><mo id="S3.SS1.p4.7.m5.3.3.1.2g" xref="S3.SS1.p4.7.m5.3.3.1.2.cmml">⁢</mo><mrow id="S3.SS1.p4.7.m5.3.3.1.1.1" xref="S3.SS1.p4.7.m5.3.3.1.1.1.1.cmml"><mo id="S3.SS1.p4.7.m5.3.3.1.1.1.2" stretchy="false" xref="S3.SS1.p4.7.m5.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p4.7.m5.3.3.1.1.1.1" xref="S3.SS1.p4.7.m5.3.3.1.1.1.1.cmml"><msup id="S3.SS1.p4.7.m5.3.3.1.1.1.1.2" xref="S3.SS1.p4.7.m5.3.3.1.1.1.1.2.cmml"><mrow id="S3.SS1.p4.7.m5.3.3.1.1.1.1.2.2.2" xref="S3.SS1.p4.7.m5.3.3.1.1.1.1.2.cmml"><mo id="S3.SS1.p4.7.m5.3.3.1.1.1.1.2.2.2.1" stretchy="false" xref="S3.SS1.p4.7.m5.3.3.1.1.1.1.2.cmml">(</mo><mi id="S3.SS1.p4.7.m5.2.2" xref="S3.SS1.p4.7.m5.2.2.cmml">𝑿</mi><mo id="S3.SS1.p4.7.m5.3.3.1.1.1.1.2.2.2.2" stretchy="false" xref="S3.SS1.p4.7.m5.3.3.1.1.1.1.2.cmml">)</mo></mrow><mi id="S3.SS1.p4.7.m5.3.3.1.1.1.1.2.3" xref="S3.SS1.p4.7.m5.3.3.1.1.1.1.2.3.cmml">T</mi></msup><mo id="S3.SS1.p4.7.m5.3.3.1.1.1.1.1" xref="S3.SS1.p4.7.m5.3.3.1.1.1.1.1.cmml">⁢</mo><mi id="S3.SS1.p4.7.m5.3.3.1.1.1.1.3" xref="S3.SS1.p4.7.m5.3.3.1.1.1.1.3.cmml">𝑿</mi></mrow><mo id="S3.SS1.p4.7.m5.3.3.1.1.1.3" stretchy="false" xref="S3.SS1.p4.7.m5.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.7.m5.3b"><apply id="S3.SS1.p4.7.m5.3.3.cmml" xref="S3.SS1.p4.7.m5.3.3"><eq id="S3.SS1.p4.7.m5.3.3.2.cmml" xref="S3.SS1.p4.7.m5.3.3.2"></eq><apply id="S3.SS1.p4.7.m5.3.3.3.cmml" xref="S3.SS1.p4.7.m5.3.3.3"><times id="S3.SS1.p4.7.m5.3.3.3.1.cmml" xref="S3.SS1.p4.7.m5.3.3.3.1"></times><ci id="S3.SS1.p4.7.m5.3.3.3.2.cmml" xref="S3.SS1.p4.7.m5.3.3.3.2">𝑺</ci><apply id="S3.SS1.p4.7.m5.3.3.3.3.cmml" xref="S3.SS1.p4.7.m5.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p4.7.m5.3.3.3.3.1.cmml" xref="S3.SS1.p4.7.m5.3.3.3.3">superscript</csymbol><ci id="S3.SS1.p4.7.m5.1.1.cmml" xref="S3.SS1.p4.7.m5.1.1">𝑺</ci><ci id="S3.SS1.p4.7.m5.3.3.3.3.3.cmml" xref="S3.SS1.p4.7.m5.3.3.3.3.3">𝑇</ci></apply></apply><apply id="S3.SS1.p4.7.m5.3.3.1.cmml" xref="S3.SS1.p4.7.m5.3.3.1"><times id="S3.SS1.p4.7.m5.3.3.1.2.cmml" xref="S3.SS1.p4.7.m5.3.3.1.2"></times><ci id="S3.SS1.p4.7.m5.3.3.1.3.cmml" xref="S3.SS1.p4.7.m5.3.3.1.3">𝑐</ci><ci id="S3.SS1.p4.7.m5.3.3.1.4.cmml" xref="S3.SS1.p4.7.m5.3.3.1.4">ℎ</ci><ci id="S3.SS1.p4.7.m5.3.3.1.5.cmml" xref="S3.SS1.p4.7.m5.3.3.1.5">𝑜</ci><ci id="S3.SS1.p4.7.m5.3.3.1.6.cmml" xref="S3.SS1.p4.7.m5.3.3.1.6">𝑙</ci><ci id="S3.SS1.p4.7.m5.3.3.1.7.cmml" xref="S3.SS1.p4.7.m5.3.3.1.7">𝑒</ci><ci id="S3.SS1.p4.7.m5.3.3.1.8.cmml" xref="S3.SS1.p4.7.m5.3.3.1.8">𝑠</ci><ci id="S3.SS1.p4.7.m5.3.3.1.9.cmml" xref="S3.SS1.p4.7.m5.3.3.1.9">𝑘</ci><ci id="S3.SS1.p4.7.m5.3.3.1.10.cmml" xref="S3.SS1.p4.7.m5.3.3.1.10">𝑦</ci><apply id="S3.SS1.p4.7.m5.3.3.1.1.1.1.cmml" xref="S3.SS1.p4.7.m5.3.3.1.1.1"><times id="S3.SS1.p4.7.m5.3.3.1.1.1.1.1.cmml" xref="S3.SS1.p4.7.m5.3.3.1.1.1.1.1"></times><apply id="S3.SS1.p4.7.m5.3.3.1.1.1.1.2.cmml" xref="S3.SS1.p4.7.m5.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p4.7.m5.3.3.1.1.1.1.2.1.cmml" xref="S3.SS1.p4.7.m5.3.3.1.1.1.1.2">superscript</csymbol><ci id="S3.SS1.p4.7.m5.2.2.cmml" xref="S3.SS1.p4.7.m5.2.2">𝑿</ci><ci id="S3.SS1.p4.7.m5.3.3.1.1.1.1.2.3.cmml" xref="S3.SS1.p4.7.m5.3.3.1.1.1.1.2.3">𝑇</ci></apply><ci id="S3.SS1.p4.7.m5.3.3.1.1.1.1.3.cmml" xref="S3.SS1.p4.7.m5.3.3.1.1.1.1.3">𝑿</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.7.m5.3c">\displaystyle{\bm{S}}({\bm{S}})^{T}=cholesky(({\bm{X}})^{T}{\bm{X}})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.7.m5.3d">bold_italic_S ( bold_italic_S ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT = italic_c italic_h italic_o italic_l italic_e italic_s italic_k italic_y ( ( bold_italic_X ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT bold_italic_X )</annotation></semantics></math>. However, <math alttext="\displaystyle{\bm{X}}" class="ltx_Math" display="inline" id="S3.SS1.p4.8.m6.1"><semantics id="S3.SS1.p4.8.m6.1a"><mi id="S3.SS1.p4.8.m6.1.1" xref="S3.SS1.p4.8.m6.1.1.cmml">𝑿</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.8.m6.1b"><ci id="S3.SS1.p4.8.m6.1.1.cmml" xref="S3.SS1.p4.8.m6.1.1">𝑿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.8.m6.1c">\displaystyle{\bm{X}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.8.m6.1d">bold_italic_X</annotation></semantics></math> in their technique refers to input data of a layer instead of several layers in our method. To evaluate <math alttext="\displaystyle{\bm{S}}" class="ltx_Math" display="inline" id="S3.SS1.p4.9.m7.1"><semantics id="S3.SS1.p4.9.m7.1a"><mi id="S3.SS1.p4.9.m7.1.1" xref="S3.SS1.p4.9.m7.1.1.cmml">𝑺</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.9.m7.1b"><ci id="S3.SS1.p4.9.m7.1.1.cmml" xref="S3.SS1.p4.9.m7.1.1">𝑺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.9.m7.1c">\displaystyle{\bm{S}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.9.m7.1d">bold_italic_S</annotation></semantics></math> considering several layers, we will vertically concatenate the input matrices in such layers, denoted as, <math alttext="{\bm{X}}^{(1)},\dots,{\bm{X}}^{(n)}" class="ltx_Math" display="inline" id="S3.SS1.p4.10.m8.5"><semantics id="S3.SS1.p4.10.m8.5a"><mrow id="S3.SS1.p4.10.m8.5.5.2" xref="S3.SS1.p4.10.m8.5.5.3.cmml"><msup id="S3.SS1.p4.10.m8.4.4.1.1" xref="S3.SS1.p4.10.m8.4.4.1.1.cmml"><mi id="S3.SS1.p4.10.m8.4.4.1.1.2" xref="S3.SS1.p4.10.m8.4.4.1.1.2.cmml">𝑿</mi><mrow id="S3.SS1.p4.10.m8.1.1.1.3" xref="S3.SS1.p4.10.m8.4.4.1.1.cmml"><mo id="S3.SS1.p4.10.m8.1.1.1.3.1" stretchy="false" xref="S3.SS1.p4.10.m8.4.4.1.1.cmml">(</mo><mn id="S3.SS1.p4.10.m8.1.1.1.1" xref="S3.SS1.p4.10.m8.1.1.1.1.cmml">1</mn><mo id="S3.SS1.p4.10.m8.1.1.1.3.2" stretchy="false" xref="S3.SS1.p4.10.m8.4.4.1.1.cmml">)</mo></mrow></msup><mo id="S3.SS1.p4.10.m8.5.5.2.3" xref="S3.SS1.p4.10.m8.5.5.3.cmml">,</mo><mi id="S3.SS1.p4.10.m8.3.3" mathvariant="normal" xref="S3.SS1.p4.10.m8.3.3.cmml">…</mi><mo id="S3.SS1.p4.10.m8.5.5.2.4" xref="S3.SS1.p4.10.m8.5.5.3.cmml">,</mo><msup id="S3.SS1.p4.10.m8.5.5.2.2" xref="S3.SS1.p4.10.m8.5.5.2.2.cmml"><mi id="S3.SS1.p4.10.m8.5.5.2.2.2" xref="S3.SS1.p4.10.m8.5.5.2.2.2.cmml">𝑿</mi><mrow id="S3.SS1.p4.10.m8.2.2.1.3" xref="S3.SS1.p4.10.m8.5.5.2.2.cmml"><mo id="S3.SS1.p4.10.m8.2.2.1.3.1" stretchy="false" xref="S3.SS1.p4.10.m8.5.5.2.2.cmml">(</mo><mi id="S3.SS1.p4.10.m8.2.2.1.1" xref="S3.SS1.p4.10.m8.2.2.1.1.cmml">n</mi><mo id="S3.SS1.p4.10.m8.2.2.1.3.2" stretchy="false" xref="S3.SS1.p4.10.m8.5.5.2.2.cmml">)</mo></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.10.m8.5b"><list id="S3.SS1.p4.10.m8.5.5.3.cmml" xref="S3.SS1.p4.10.m8.5.5.2"><apply id="S3.SS1.p4.10.m8.4.4.1.1.cmml" xref="S3.SS1.p4.10.m8.4.4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.10.m8.4.4.1.1.1.cmml" xref="S3.SS1.p4.10.m8.4.4.1.1">superscript</csymbol><ci id="S3.SS1.p4.10.m8.4.4.1.1.2.cmml" xref="S3.SS1.p4.10.m8.4.4.1.1.2">𝑿</ci><cn id="S3.SS1.p4.10.m8.1.1.1.1.cmml" type="integer" xref="S3.SS1.p4.10.m8.1.1.1.1">1</cn></apply><ci id="S3.SS1.p4.10.m8.3.3.cmml" xref="S3.SS1.p4.10.m8.3.3">…</ci><apply id="S3.SS1.p4.10.m8.5.5.2.2.cmml" xref="S3.SS1.p4.10.m8.5.5.2.2"><csymbol cd="ambiguous" id="S3.SS1.p4.10.m8.5.5.2.2.1.cmml" xref="S3.SS1.p4.10.m8.5.5.2.2">superscript</csymbol><ci id="S3.SS1.p4.10.m8.5.5.2.2.2.cmml" xref="S3.SS1.p4.10.m8.5.5.2.2.2">𝑿</ci><ci id="S3.SS1.p4.10.m8.2.2.1.1.cmml" xref="S3.SS1.p4.10.m8.2.2.1.1">𝑛</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.10.m8.5c">{\bm{X}}^{(1)},\dots,{\bm{X}}^{(n)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.10.m8.5d">bold_italic_X start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT , … , bold_italic_X start_POSTSUPERSCRIPT ( italic_n ) end_POSTSUPERSCRIPT</annotation></semantics></math>, and compute the <math alttext="{\bm{S}}" class="ltx_Math" display="inline" id="S3.SS1.p4.11.m9.1"><semantics id="S3.SS1.p4.11.m9.1a"><mi id="S3.SS1.p4.11.m9.1.1" xref="S3.SS1.p4.11.m9.1.1.cmml">𝑺</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.11.m9.1b"><ci id="S3.SS1.p4.11.m9.1.1.cmml" xref="S3.SS1.p4.11.m9.1.1">𝑺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.11.m9.1c">{\bm{S}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.11.m9.1d">bold_italic_S</annotation></semantics></math> with the concatenated <math alttext="{\bm{X}}" class="ltx_Math" display="inline" id="S3.SS1.p4.12.m10.1"><semantics id="S3.SS1.p4.12.m10.1a"><mi id="S3.SS1.p4.12.m10.1.1" xref="S3.SS1.p4.12.m10.1.1.cmml">𝑿</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.12.m10.1b"><ci id="S3.SS1.p4.12.m10.1.1.cmml" xref="S3.SS1.p4.12.m10.1.1">𝑿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.12.m10.1c">{\bm{X}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.12.m10.1d">bold_italic_X</annotation></semantics></math>.
In our experiments, we use 256 samples from WikiText-2 <cite class="ltx_cite ltx_citemacro_citep">(Merity et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib25" title="">2016</a>)</cite> with each 2048 tokens to evaluate <math alttext="{\bm{X}}" class="ltx_Math" display="inline" id="S3.SS1.p4.13.m11.1"><semantics id="S3.SS1.p4.13.m11.1a"><mi id="S3.SS1.p4.13.m11.1.1" xref="S3.SS1.p4.13.m11.1.1.cmml">𝑿</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.13.m11.1b"><ci id="S3.SS1.p4.13.m11.1.1.cmml" xref="S3.SS1.p4.13.m11.1.1">𝑿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.13.m11.1c">{\bm{X}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.13.m11.1d">bold_italic_X</annotation></semantics></math>, similar to that in <cite class="ltx_cite ltx_citemacro_citet">Wang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib41" title="">2024b</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p5">
<p class="ltx_p" id="S3.SS1.p5.7">Instead of applying SVD directly on the concatenated weight matrix <math alttext="\displaystyle{\bm{W}}" class="ltx_Math" display="inline" id="S3.SS1.p5.1.m1.1"><semantics id="S3.SS1.p5.1.m1.1a"><mi id="S3.SS1.p5.1.m1.1.1" xref="S3.SS1.p5.1.m1.1.1.cmml">𝑾</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.1.m1.1b"><ci id="S3.SS1.p5.1.m1.1.1.cmml" xref="S3.SS1.p5.1.m1.1.1">𝑾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.1.m1.1c">\displaystyle{\bm{W}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.1.m1.1d">bold_italic_W</annotation></semantics></math>, we will decompose <math alttext="\displaystyle{\bm{S}}{\bm{W}}" class="ltx_Math" display="inline" id="S3.SS1.p5.2.m2.1"><semantics id="S3.SS1.p5.2.m2.1a"><mrow id="S3.SS1.p5.2.m2.1.1" xref="S3.SS1.p5.2.m2.1.1.cmml"><mi id="S3.SS1.p5.2.m2.1.1.2" xref="S3.SS1.p5.2.m2.1.1.2.cmml">𝑺</mi><mo id="S3.SS1.p5.2.m2.1.1.1" xref="S3.SS1.p5.2.m2.1.1.1.cmml">⁢</mo><mi id="S3.SS1.p5.2.m2.1.1.3" xref="S3.SS1.p5.2.m2.1.1.3.cmml">𝑾</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.2.m2.1b"><apply id="S3.SS1.p5.2.m2.1.1.cmml" xref="S3.SS1.p5.2.m2.1.1"><times id="S3.SS1.p5.2.m2.1.1.1.cmml" xref="S3.SS1.p5.2.m2.1.1.1"></times><ci id="S3.SS1.p5.2.m2.1.1.2.cmml" xref="S3.SS1.p5.2.m2.1.1.2">𝑺</ci><ci id="S3.SS1.p5.2.m2.1.1.3.cmml" xref="S3.SS1.p5.2.m2.1.1.3">𝑾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.2.m2.1c">\displaystyle{\bm{S}}{\bm{W}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.2.m2.1d">bold_italic_S bold_italic_W</annotation></semantics></math> with SVD and approximate this scaled weight matrix <math alttext="\displaystyle{\bm{S}}{\bm{W}}\approx{\bm{U}}^{\prime}_{k}{\bm{\Sigma}}^{\prime%
}_{k}{\bm{V}}^{\prime}_{k}={\bm{B}}^{\prime}{\bm{C}}^{\prime}" class="ltx_Math" display="inline" id="S3.SS1.p5.3.m3.1"><semantics id="S3.SS1.p5.3.m3.1a"><mrow id="S3.SS1.p5.3.m3.1.1" xref="S3.SS1.p5.3.m3.1.1.cmml"><mrow id="S3.SS1.p5.3.m3.1.1.2" xref="S3.SS1.p5.3.m3.1.1.2.cmml"><mi id="S3.SS1.p5.3.m3.1.1.2.2" xref="S3.SS1.p5.3.m3.1.1.2.2.cmml">𝑺</mi><mo id="S3.SS1.p5.3.m3.1.1.2.1" xref="S3.SS1.p5.3.m3.1.1.2.1.cmml">⁢</mo><mi id="S3.SS1.p5.3.m3.1.1.2.3" xref="S3.SS1.p5.3.m3.1.1.2.3.cmml">𝑾</mi></mrow><mo id="S3.SS1.p5.3.m3.1.1.3" xref="S3.SS1.p5.3.m3.1.1.3.cmml">≈</mo><mrow id="S3.SS1.p5.3.m3.1.1.4" xref="S3.SS1.p5.3.m3.1.1.4.cmml"><msubsup id="S3.SS1.p5.3.m3.1.1.4.2" xref="S3.SS1.p5.3.m3.1.1.4.2.cmml"><mi id="S3.SS1.p5.3.m3.1.1.4.2.2.2" xref="S3.SS1.p5.3.m3.1.1.4.2.2.2.cmml">𝑼</mi><mi id="S3.SS1.p5.3.m3.1.1.4.2.3" xref="S3.SS1.p5.3.m3.1.1.4.2.3.cmml">k</mi><mo id="S3.SS1.p5.3.m3.1.1.4.2.2.3" xref="S3.SS1.p5.3.m3.1.1.4.2.2.3.cmml">′</mo></msubsup><mo id="S3.SS1.p5.3.m3.1.1.4.1" xref="S3.SS1.p5.3.m3.1.1.4.1.cmml">⁢</mo><msubsup id="S3.SS1.p5.3.m3.1.1.4.3" xref="S3.SS1.p5.3.m3.1.1.4.3.cmml"><mi id="S3.SS1.p5.3.m3.1.1.4.3.2.2" xref="S3.SS1.p5.3.m3.1.1.4.3.2.2.cmml">𝚺</mi><mi id="S3.SS1.p5.3.m3.1.1.4.3.3" xref="S3.SS1.p5.3.m3.1.1.4.3.3.cmml">k</mi><mo id="S3.SS1.p5.3.m3.1.1.4.3.2.3" xref="S3.SS1.p5.3.m3.1.1.4.3.2.3.cmml">′</mo></msubsup><mo id="S3.SS1.p5.3.m3.1.1.4.1a" xref="S3.SS1.p5.3.m3.1.1.4.1.cmml">⁢</mo><msubsup id="S3.SS1.p5.3.m3.1.1.4.4" xref="S3.SS1.p5.3.m3.1.1.4.4.cmml"><mi id="S3.SS1.p5.3.m3.1.1.4.4.2.2" xref="S3.SS1.p5.3.m3.1.1.4.4.2.2.cmml">𝑽</mi><mi id="S3.SS1.p5.3.m3.1.1.4.4.3" xref="S3.SS1.p5.3.m3.1.1.4.4.3.cmml">k</mi><mo id="S3.SS1.p5.3.m3.1.1.4.4.2.3" xref="S3.SS1.p5.3.m3.1.1.4.4.2.3.cmml">′</mo></msubsup></mrow><mo id="S3.SS1.p5.3.m3.1.1.5" xref="S3.SS1.p5.3.m3.1.1.5.cmml">=</mo><mrow id="S3.SS1.p5.3.m3.1.1.6" xref="S3.SS1.p5.3.m3.1.1.6.cmml"><msup id="S3.SS1.p5.3.m3.1.1.6.2" xref="S3.SS1.p5.3.m3.1.1.6.2.cmml"><mi id="S3.SS1.p5.3.m3.1.1.6.2.2" xref="S3.SS1.p5.3.m3.1.1.6.2.2.cmml">𝑩</mi><mo id="S3.SS1.p5.3.m3.1.1.6.2.3" xref="S3.SS1.p5.3.m3.1.1.6.2.3.cmml">′</mo></msup><mo id="S3.SS1.p5.3.m3.1.1.6.1" xref="S3.SS1.p5.3.m3.1.1.6.1.cmml">⁢</mo><msup id="S3.SS1.p5.3.m3.1.1.6.3" xref="S3.SS1.p5.3.m3.1.1.6.3.cmml"><mi id="S3.SS1.p5.3.m3.1.1.6.3.2" xref="S3.SS1.p5.3.m3.1.1.6.3.2.cmml">𝑪</mi><mo id="S3.SS1.p5.3.m3.1.1.6.3.3" xref="S3.SS1.p5.3.m3.1.1.6.3.3.cmml">′</mo></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.3.m3.1b"><apply id="S3.SS1.p5.3.m3.1.1.cmml" xref="S3.SS1.p5.3.m3.1.1"><and id="S3.SS1.p5.3.m3.1.1a.cmml" xref="S3.SS1.p5.3.m3.1.1"></and><apply id="S3.SS1.p5.3.m3.1.1b.cmml" xref="S3.SS1.p5.3.m3.1.1"><approx id="S3.SS1.p5.3.m3.1.1.3.cmml" xref="S3.SS1.p5.3.m3.1.1.3"></approx><apply id="S3.SS1.p5.3.m3.1.1.2.cmml" xref="S3.SS1.p5.3.m3.1.1.2"><times id="S3.SS1.p5.3.m3.1.1.2.1.cmml" xref="S3.SS1.p5.3.m3.1.1.2.1"></times><ci id="S3.SS1.p5.3.m3.1.1.2.2.cmml" xref="S3.SS1.p5.3.m3.1.1.2.2">𝑺</ci><ci id="S3.SS1.p5.3.m3.1.1.2.3.cmml" xref="S3.SS1.p5.3.m3.1.1.2.3">𝑾</ci></apply><apply id="S3.SS1.p5.3.m3.1.1.4.cmml" xref="S3.SS1.p5.3.m3.1.1.4"><times id="S3.SS1.p5.3.m3.1.1.4.1.cmml" xref="S3.SS1.p5.3.m3.1.1.4.1"></times><apply id="S3.SS1.p5.3.m3.1.1.4.2.cmml" xref="S3.SS1.p5.3.m3.1.1.4.2"><csymbol cd="ambiguous" id="S3.SS1.p5.3.m3.1.1.4.2.1.cmml" xref="S3.SS1.p5.3.m3.1.1.4.2">subscript</csymbol><apply id="S3.SS1.p5.3.m3.1.1.4.2.2.cmml" xref="S3.SS1.p5.3.m3.1.1.4.2"><csymbol cd="ambiguous" id="S3.SS1.p5.3.m3.1.1.4.2.2.1.cmml" xref="S3.SS1.p5.3.m3.1.1.4.2">superscript</csymbol><ci id="S3.SS1.p5.3.m3.1.1.4.2.2.2.cmml" xref="S3.SS1.p5.3.m3.1.1.4.2.2.2">𝑼</ci><ci id="S3.SS1.p5.3.m3.1.1.4.2.2.3.cmml" xref="S3.SS1.p5.3.m3.1.1.4.2.2.3">′</ci></apply><ci id="S3.SS1.p5.3.m3.1.1.4.2.3.cmml" xref="S3.SS1.p5.3.m3.1.1.4.2.3">𝑘</ci></apply><apply id="S3.SS1.p5.3.m3.1.1.4.3.cmml" xref="S3.SS1.p5.3.m3.1.1.4.3"><csymbol cd="ambiguous" id="S3.SS1.p5.3.m3.1.1.4.3.1.cmml" xref="S3.SS1.p5.3.m3.1.1.4.3">subscript</csymbol><apply id="S3.SS1.p5.3.m3.1.1.4.3.2.cmml" xref="S3.SS1.p5.3.m3.1.1.4.3"><csymbol cd="ambiguous" id="S3.SS1.p5.3.m3.1.1.4.3.2.1.cmml" xref="S3.SS1.p5.3.m3.1.1.4.3">superscript</csymbol><ci id="S3.SS1.p5.3.m3.1.1.4.3.2.2.cmml" xref="S3.SS1.p5.3.m3.1.1.4.3.2.2">𝚺</ci><ci id="S3.SS1.p5.3.m3.1.1.4.3.2.3.cmml" xref="S3.SS1.p5.3.m3.1.1.4.3.2.3">′</ci></apply><ci id="S3.SS1.p5.3.m3.1.1.4.3.3.cmml" xref="S3.SS1.p5.3.m3.1.1.4.3.3">𝑘</ci></apply><apply id="S3.SS1.p5.3.m3.1.1.4.4.cmml" xref="S3.SS1.p5.3.m3.1.1.4.4"><csymbol cd="ambiguous" id="S3.SS1.p5.3.m3.1.1.4.4.1.cmml" xref="S3.SS1.p5.3.m3.1.1.4.4">subscript</csymbol><apply id="S3.SS1.p5.3.m3.1.1.4.4.2.cmml" xref="S3.SS1.p5.3.m3.1.1.4.4"><csymbol cd="ambiguous" id="S3.SS1.p5.3.m3.1.1.4.4.2.1.cmml" xref="S3.SS1.p5.3.m3.1.1.4.4">superscript</csymbol><ci id="S3.SS1.p5.3.m3.1.1.4.4.2.2.cmml" xref="S3.SS1.p5.3.m3.1.1.4.4.2.2">𝑽</ci><ci id="S3.SS1.p5.3.m3.1.1.4.4.2.3.cmml" xref="S3.SS1.p5.3.m3.1.1.4.4.2.3">′</ci></apply><ci id="S3.SS1.p5.3.m3.1.1.4.4.3.cmml" xref="S3.SS1.p5.3.m3.1.1.4.4.3">𝑘</ci></apply></apply></apply><apply id="S3.SS1.p5.3.m3.1.1c.cmml" xref="S3.SS1.p5.3.m3.1.1"><eq id="S3.SS1.p5.3.m3.1.1.5.cmml" xref="S3.SS1.p5.3.m3.1.1.5"></eq><share href="https://arxiv.org/html/2410.03765v1#S3.SS1.p5.3.m3.1.1.4.cmml" id="S3.SS1.p5.3.m3.1.1d.cmml" xref="S3.SS1.p5.3.m3.1.1"></share><apply id="S3.SS1.p5.3.m3.1.1.6.cmml" xref="S3.SS1.p5.3.m3.1.1.6"><times id="S3.SS1.p5.3.m3.1.1.6.1.cmml" xref="S3.SS1.p5.3.m3.1.1.6.1"></times><apply id="S3.SS1.p5.3.m3.1.1.6.2.cmml" xref="S3.SS1.p5.3.m3.1.1.6.2"><csymbol cd="ambiguous" id="S3.SS1.p5.3.m3.1.1.6.2.1.cmml" xref="S3.SS1.p5.3.m3.1.1.6.2">superscript</csymbol><ci id="S3.SS1.p5.3.m3.1.1.6.2.2.cmml" xref="S3.SS1.p5.3.m3.1.1.6.2.2">𝑩</ci><ci id="S3.SS1.p5.3.m3.1.1.6.2.3.cmml" xref="S3.SS1.p5.3.m3.1.1.6.2.3">′</ci></apply><apply id="S3.SS1.p5.3.m3.1.1.6.3.cmml" xref="S3.SS1.p5.3.m3.1.1.6.3"><csymbol cd="ambiguous" id="S3.SS1.p5.3.m3.1.1.6.3.1.cmml" xref="S3.SS1.p5.3.m3.1.1.6.3">superscript</csymbol><ci id="S3.SS1.p5.3.m3.1.1.6.3.2.cmml" xref="S3.SS1.p5.3.m3.1.1.6.3.2">𝑪</ci><ci id="S3.SS1.p5.3.m3.1.1.6.3.3.cmml" xref="S3.SS1.p5.3.m3.1.1.6.3.3">′</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.3.m3.1c">\displaystyle{\bm{S}}{\bm{W}}\approx{\bm{U}}^{\prime}_{k}{\bm{\Sigma}}^{\prime%
}_{k}{\bm{V}}^{\prime}_{k}={\bm{B}}^{\prime}{\bm{C}}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.3.m3.1d">bold_italic_S bold_italic_W ≈ bold_italic_U start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT bold_Σ start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT bold_italic_V start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT = bold_italic_B start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT bold_italic_C start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="\displaystyle{\bm{B}}^{\prime}" class="ltx_Math" display="inline" id="S3.SS1.p5.4.m4.1"><semantics id="S3.SS1.p5.4.m4.1a"><msup id="S3.SS1.p5.4.m4.1.1" xref="S3.SS1.p5.4.m4.1.1.cmml"><mi id="S3.SS1.p5.4.m4.1.1.2" xref="S3.SS1.p5.4.m4.1.1.2.cmml">𝑩</mi><mo id="S3.SS1.p5.4.m4.1.1.3" xref="S3.SS1.p5.4.m4.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.4.m4.1b"><apply id="S3.SS1.p5.4.m4.1.1.cmml" xref="S3.SS1.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.4.m4.1.1.1.cmml" xref="S3.SS1.p5.4.m4.1.1">superscript</csymbol><ci id="S3.SS1.p5.4.m4.1.1.2.cmml" xref="S3.SS1.p5.4.m4.1.1.2">𝑩</ci><ci id="S3.SS1.p5.4.m4.1.1.3.cmml" xref="S3.SS1.p5.4.m4.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.4.m4.1c">\displaystyle{\bm{B}}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.4.m4.1d">bold_italic_B start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\displaystyle{\bm{C}}^{\prime}" class="ltx_Math" display="inline" id="S3.SS1.p5.5.m5.1"><semantics id="S3.SS1.p5.5.m5.1a"><msup id="S3.SS1.p5.5.m5.1.1" xref="S3.SS1.p5.5.m5.1.1.cmml"><mi id="S3.SS1.p5.5.m5.1.1.2" xref="S3.SS1.p5.5.m5.1.1.2.cmml">𝑪</mi><mo id="S3.SS1.p5.5.m5.1.1.3" xref="S3.SS1.p5.5.m5.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.5.m5.1b"><apply id="S3.SS1.p5.5.m5.1.1.cmml" xref="S3.SS1.p5.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.5.m5.1.1.1.cmml" xref="S3.SS1.p5.5.m5.1.1">superscript</csymbol><ci id="S3.SS1.p5.5.m5.1.1.2.cmml" xref="S3.SS1.p5.5.m5.1.1.2">𝑪</ci><ci id="S3.SS1.p5.5.m5.1.1.3.cmml" xref="S3.SS1.p5.5.m5.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.5.m5.1c">\displaystyle{\bm{C}}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.5.m5.1d">bold_italic_C start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> are the revised basis matrix and coefficient matrix, respectively.
To recover the approximated weight matrix for computation in inference, <math alttext="\displaystyle{\bm{S}}^{-1}" class="ltx_Math" display="inline" id="S3.SS1.p5.6.m6.1"><semantics id="S3.SS1.p5.6.m6.1a"><msup id="S3.SS1.p5.6.m6.1.1" xref="S3.SS1.p5.6.m6.1.1.cmml"><mi id="S3.SS1.p5.6.m6.1.1.2" xref="S3.SS1.p5.6.m6.1.1.2.cmml">𝑺</mi><mrow id="S3.SS1.p5.6.m6.1.1.3" xref="S3.SS1.p5.6.m6.1.1.3.cmml"><mo id="S3.SS1.p5.6.m6.1.1.3a" xref="S3.SS1.p5.6.m6.1.1.3.cmml">−</mo><mn id="S3.SS1.p5.6.m6.1.1.3.2" xref="S3.SS1.p5.6.m6.1.1.3.2.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.6.m6.1b"><apply id="S3.SS1.p5.6.m6.1.1.cmml" xref="S3.SS1.p5.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.6.m6.1.1.1.cmml" xref="S3.SS1.p5.6.m6.1.1">superscript</csymbol><ci id="S3.SS1.p5.6.m6.1.1.2.cmml" xref="S3.SS1.p5.6.m6.1.1.2">𝑺</ci><apply id="S3.SS1.p5.6.m6.1.1.3.cmml" xref="S3.SS1.p5.6.m6.1.1.3"><minus id="S3.SS1.p5.6.m6.1.1.3.1.cmml" xref="S3.SS1.p5.6.m6.1.1.3"></minus><cn id="S3.SS1.p5.6.m6.1.1.3.2.cmml" type="integer" xref="S3.SS1.p5.6.m6.1.1.3.2">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.6.m6.1c">\displaystyle{\bm{S}}^{-1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.6.m6.1d">bold_italic_S start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT</annotation></semantics></math> will be multiplied with <math alttext="\displaystyle{\bm{B}}^{\prime}" class="ltx_Math" display="inline" id="S3.SS1.p5.7.m7.1"><semantics id="S3.SS1.p5.7.m7.1a"><msup id="S3.SS1.p5.7.m7.1.1" xref="S3.SS1.p5.7.m7.1.1.cmml"><mi id="S3.SS1.p5.7.m7.1.1.2" xref="S3.SS1.p5.7.m7.1.1.2.cmml">𝑩</mi><mo id="S3.SS1.p5.7.m7.1.1.3" xref="S3.SS1.p5.7.m7.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.7.m7.1b"><apply id="S3.SS1.p5.7.m7.1.1.cmml" xref="S3.SS1.p5.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.7.m7.1.1.1.cmml" xref="S3.SS1.p5.7.m7.1.1">superscript</csymbol><ci id="S3.SS1.p5.7.m7.1.1.2.cmml" xref="S3.SS1.p5.7.m7.1.1.2">𝑩</ci><ci id="S3.SS1.p5.7.m7.1.1.3.cmml" xref="S3.SS1.p5.7.m7.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.7.m7.1c">\displaystyle{\bm{B}}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.7.m7.1d">bold_italic_B start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>, the result of which will be the final adjusted basis matrix, i.e.,</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle{\bm{W}}\approx{\bm{S}}^{-1}{\bm{U}}^{\prime}_{k}{\bm{\Sigma}}^{%
\prime}_{k}{\bm{V}}^{\prime}_{k}={\bm{S}}^{-1}{\bm{B}}^{\prime}{\bm{C}}^{%
\prime}={\bm{B}}^{\prime\prime}{\bm{C}}^{\prime}," class="ltx_Math" display="block" id="S3.E3.m1.1"><semantics id="S3.E3.m1.1a"><mrow id="S3.E3.m1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml"><mrow id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.2.cmml">𝑾</mi><mo id="S3.E3.m1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.3.cmml">≈</mo><mrow id="S3.E3.m1.1.1.1.1.4" xref="S3.E3.m1.1.1.1.1.4.cmml"><msup id="S3.E3.m1.1.1.1.1.4.2" xref="S3.E3.m1.1.1.1.1.4.2.cmml"><mi id="S3.E3.m1.1.1.1.1.4.2.2" xref="S3.E3.m1.1.1.1.1.4.2.2.cmml">𝑺</mi><mrow id="S3.E3.m1.1.1.1.1.4.2.3" xref="S3.E3.m1.1.1.1.1.4.2.3.cmml"><mo id="S3.E3.m1.1.1.1.1.4.2.3a" xref="S3.E3.m1.1.1.1.1.4.2.3.cmml">−</mo><mn id="S3.E3.m1.1.1.1.1.4.2.3.2" xref="S3.E3.m1.1.1.1.1.4.2.3.2.cmml">1</mn></mrow></msup><mo id="S3.E3.m1.1.1.1.1.4.1" xref="S3.E3.m1.1.1.1.1.4.1.cmml">⁢</mo><msubsup id="S3.E3.m1.1.1.1.1.4.3" xref="S3.E3.m1.1.1.1.1.4.3.cmml"><mi id="S3.E3.m1.1.1.1.1.4.3.2.2" xref="S3.E3.m1.1.1.1.1.4.3.2.2.cmml">𝑼</mi><mi id="S3.E3.m1.1.1.1.1.4.3.3" xref="S3.E3.m1.1.1.1.1.4.3.3.cmml">k</mi><mo id="S3.E3.m1.1.1.1.1.4.3.2.3" xref="S3.E3.m1.1.1.1.1.4.3.2.3.cmml">′</mo></msubsup><mo id="S3.E3.m1.1.1.1.1.4.1a" xref="S3.E3.m1.1.1.1.1.4.1.cmml">⁢</mo><msubsup id="S3.E3.m1.1.1.1.1.4.4" xref="S3.E3.m1.1.1.1.1.4.4.cmml"><mi id="S3.E3.m1.1.1.1.1.4.4.2.2" xref="S3.E3.m1.1.1.1.1.4.4.2.2.cmml">𝚺</mi><mi id="S3.E3.m1.1.1.1.1.4.4.3" xref="S3.E3.m1.1.1.1.1.4.4.3.cmml">k</mi><mo id="S3.E3.m1.1.1.1.1.4.4.2.3" xref="S3.E3.m1.1.1.1.1.4.4.2.3.cmml">′</mo></msubsup><mo id="S3.E3.m1.1.1.1.1.4.1b" xref="S3.E3.m1.1.1.1.1.4.1.cmml">⁢</mo><msubsup id="S3.E3.m1.1.1.1.1.4.5" xref="S3.E3.m1.1.1.1.1.4.5.cmml"><mi id="S3.E3.m1.1.1.1.1.4.5.2.2" xref="S3.E3.m1.1.1.1.1.4.5.2.2.cmml">𝑽</mi><mi id="S3.E3.m1.1.1.1.1.4.5.3" xref="S3.E3.m1.1.1.1.1.4.5.3.cmml">k</mi><mo id="S3.E3.m1.1.1.1.1.4.5.2.3" xref="S3.E3.m1.1.1.1.1.4.5.2.3.cmml">′</mo></msubsup></mrow><mo id="S3.E3.m1.1.1.1.1.5" xref="S3.E3.m1.1.1.1.1.5.cmml">=</mo><mrow id="S3.E3.m1.1.1.1.1.6" xref="S3.E3.m1.1.1.1.1.6.cmml"><msup id="S3.E3.m1.1.1.1.1.6.2" xref="S3.E3.m1.1.1.1.1.6.2.cmml"><mi id="S3.E3.m1.1.1.1.1.6.2.2" xref="S3.E3.m1.1.1.1.1.6.2.2.cmml">𝑺</mi><mrow id="S3.E3.m1.1.1.1.1.6.2.3" xref="S3.E3.m1.1.1.1.1.6.2.3.cmml"><mo id="S3.E3.m1.1.1.1.1.6.2.3a" xref="S3.E3.m1.1.1.1.1.6.2.3.cmml">−</mo><mn id="S3.E3.m1.1.1.1.1.6.2.3.2" xref="S3.E3.m1.1.1.1.1.6.2.3.2.cmml">1</mn></mrow></msup><mo id="S3.E3.m1.1.1.1.1.6.1" xref="S3.E3.m1.1.1.1.1.6.1.cmml">⁢</mo><msup id="S3.E3.m1.1.1.1.1.6.3" xref="S3.E3.m1.1.1.1.1.6.3.cmml"><mi id="S3.E3.m1.1.1.1.1.6.3.2" xref="S3.E3.m1.1.1.1.1.6.3.2.cmml">𝑩</mi><mo id="S3.E3.m1.1.1.1.1.6.3.3" xref="S3.E3.m1.1.1.1.1.6.3.3.cmml">′</mo></msup><mo id="S3.E3.m1.1.1.1.1.6.1a" xref="S3.E3.m1.1.1.1.1.6.1.cmml">⁢</mo><msup id="S3.E3.m1.1.1.1.1.6.4" xref="S3.E3.m1.1.1.1.1.6.4.cmml"><mi id="S3.E3.m1.1.1.1.1.6.4.2" xref="S3.E3.m1.1.1.1.1.6.4.2.cmml">𝑪</mi><mo id="S3.E3.m1.1.1.1.1.6.4.3" xref="S3.E3.m1.1.1.1.1.6.4.3.cmml">′</mo></msup></mrow><mo id="S3.E3.m1.1.1.1.1.7" xref="S3.E3.m1.1.1.1.1.7.cmml">=</mo><mrow id="S3.E3.m1.1.1.1.1.8" xref="S3.E3.m1.1.1.1.1.8.cmml"><msup id="S3.E3.m1.1.1.1.1.8.2" xref="S3.E3.m1.1.1.1.1.8.2.cmml"><mi id="S3.E3.m1.1.1.1.1.8.2.2" xref="S3.E3.m1.1.1.1.1.8.2.2.cmml">𝑩</mi><mo id="S3.E3.m1.1.1.1.1.8.2.3" xref="S3.E3.m1.1.1.1.1.8.2.3.cmml">′′</mo></msup><mo id="S3.E3.m1.1.1.1.1.8.1" xref="S3.E3.m1.1.1.1.1.8.1.cmml">⁢</mo><msup id="S3.E3.m1.1.1.1.1.8.3" xref="S3.E3.m1.1.1.1.1.8.3.cmml"><mi id="S3.E3.m1.1.1.1.1.8.3.2" xref="S3.E3.m1.1.1.1.1.8.3.2.cmml">𝑪</mi><mo id="S3.E3.m1.1.1.1.1.8.3.3" xref="S3.E3.m1.1.1.1.1.8.3.3.cmml">′</mo></msup></mrow></mrow><mo id="S3.E3.m1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.1b"><apply id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1"><and id="S3.E3.m1.1.1.1.1a.cmml" xref="S3.E3.m1.1.1.1"></and><apply id="S3.E3.m1.1.1.1.1b.cmml" xref="S3.E3.m1.1.1.1"><approx id="S3.E3.m1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.3"></approx><ci id="S3.E3.m1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.2">𝑾</ci><apply id="S3.E3.m1.1.1.1.1.4.cmml" xref="S3.E3.m1.1.1.1.1.4"><times id="S3.E3.m1.1.1.1.1.4.1.cmml" xref="S3.E3.m1.1.1.1.1.4.1"></times><apply id="S3.E3.m1.1.1.1.1.4.2.cmml" xref="S3.E3.m1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.4.2.1.cmml" xref="S3.E3.m1.1.1.1.1.4.2">superscript</csymbol><ci id="S3.E3.m1.1.1.1.1.4.2.2.cmml" xref="S3.E3.m1.1.1.1.1.4.2.2">𝑺</ci><apply id="S3.E3.m1.1.1.1.1.4.2.3.cmml" xref="S3.E3.m1.1.1.1.1.4.2.3"><minus id="S3.E3.m1.1.1.1.1.4.2.3.1.cmml" xref="S3.E3.m1.1.1.1.1.4.2.3"></minus><cn id="S3.E3.m1.1.1.1.1.4.2.3.2.cmml" type="integer" xref="S3.E3.m1.1.1.1.1.4.2.3.2">1</cn></apply></apply><apply id="S3.E3.m1.1.1.1.1.4.3.cmml" xref="S3.E3.m1.1.1.1.1.4.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.4.3.1.cmml" xref="S3.E3.m1.1.1.1.1.4.3">subscript</csymbol><apply id="S3.E3.m1.1.1.1.1.4.3.2.cmml" xref="S3.E3.m1.1.1.1.1.4.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.4.3.2.1.cmml" xref="S3.E3.m1.1.1.1.1.4.3">superscript</csymbol><ci id="S3.E3.m1.1.1.1.1.4.3.2.2.cmml" xref="S3.E3.m1.1.1.1.1.4.3.2.2">𝑼</ci><ci id="S3.E3.m1.1.1.1.1.4.3.2.3.cmml" xref="S3.E3.m1.1.1.1.1.4.3.2.3">′</ci></apply><ci id="S3.E3.m1.1.1.1.1.4.3.3.cmml" xref="S3.E3.m1.1.1.1.1.4.3.3">𝑘</ci></apply><apply id="S3.E3.m1.1.1.1.1.4.4.cmml" xref="S3.E3.m1.1.1.1.1.4.4"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.4.4.1.cmml" xref="S3.E3.m1.1.1.1.1.4.4">subscript</csymbol><apply id="S3.E3.m1.1.1.1.1.4.4.2.cmml" xref="S3.E3.m1.1.1.1.1.4.4"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.4.4.2.1.cmml" xref="S3.E3.m1.1.1.1.1.4.4">superscript</csymbol><ci id="S3.E3.m1.1.1.1.1.4.4.2.2.cmml" xref="S3.E3.m1.1.1.1.1.4.4.2.2">𝚺</ci><ci id="S3.E3.m1.1.1.1.1.4.4.2.3.cmml" xref="S3.E3.m1.1.1.1.1.4.4.2.3">′</ci></apply><ci id="S3.E3.m1.1.1.1.1.4.4.3.cmml" xref="S3.E3.m1.1.1.1.1.4.4.3">𝑘</ci></apply><apply id="S3.E3.m1.1.1.1.1.4.5.cmml" xref="S3.E3.m1.1.1.1.1.4.5"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.4.5.1.cmml" xref="S3.E3.m1.1.1.1.1.4.5">subscript</csymbol><apply id="S3.E3.m1.1.1.1.1.4.5.2.cmml" xref="S3.E3.m1.1.1.1.1.4.5"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.4.5.2.1.cmml" xref="S3.E3.m1.1.1.1.1.4.5">superscript</csymbol><ci id="S3.E3.m1.1.1.1.1.4.5.2.2.cmml" xref="S3.E3.m1.1.1.1.1.4.5.2.2">𝑽</ci><ci id="S3.E3.m1.1.1.1.1.4.5.2.3.cmml" xref="S3.E3.m1.1.1.1.1.4.5.2.3">′</ci></apply><ci id="S3.E3.m1.1.1.1.1.4.5.3.cmml" xref="S3.E3.m1.1.1.1.1.4.5.3">𝑘</ci></apply></apply></apply><apply id="S3.E3.m1.1.1.1.1c.cmml" xref="S3.E3.m1.1.1.1"><eq id="S3.E3.m1.1.1.1.1.5.cmml" xref="S3.E3.m1.1.1.1.1.5"></eq><share href="https://arxiv.org/html/2410.03765v1#S3.E3.m1.1.1.1.1.4.cmml" id="S3.E3.m1.1.1.1.1d.cmml" xref="S3.E3.m1.1.1.1"></share><apply id="S3.E3.m1.1.1.1.1.6.cmml" xref="S3.E3.m1.1.1.1.1.6"><times id="S3.E3.m1.1.1.1.1.6.1.cmml" xref="S3.E3.m1.1.1.1.1.6.1"></times><apply id="S3.E3.m1.1.1.1.1.6.2.cmml" xref="S3.E3.m1.1.1.1.1.6.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.6.2.1.cmml" xref="S3.E3.m1.1.1.1.1.6.2">superscript</csymbol><ci id="S3.E3.m1.1.1.1.1.6.2.2.cmml" xref="S3.E3.m1.1.1.1.1.6.2.2">𝑺</ci><apply id="S3.E3.m1.1.1.1.1.6.2.3.cmml" xref="S3.E3.m1.1.1.1.1.6.2.3"><minus id="S3.E3.m1.1.1.1.1.6.2.3.1.cmml" xref="S3.E3.m1.1.1.1.1.6.2.3"></minus><cn id="S3.E3.m1.1.1.1.1.6.2.3.2.cmml" type="integer" xref="S3.E3.m1.1.1.1.1.6.2.3.2">1</cn></apply></apply><apply id="S3.E3.m1.1.1.1.1.6.3.cmml" xref="S3.E3.m1.1.1.1.1.6.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.6.3.1.cmml" xref="S3.E3.m1.1.1.1.1.6.3">superscript</csymbol><ci id="S3.E3.m1.1.1.1.1.6.3.2.cmml" xref="S3.E3.m1.1.1.1.1.6.3.2">𝑩</ci><ci id="S3.E3.m1.1.1.1.1.6.3.3.cmml" xref="S3.E3.m1.1.1.1.1.6.3.3">′</ci></apply><apply id="S3.E3.m1.1.1.1.1.6.4.cmml" xref="S3.E3.m1.1.1.1.1.6.4"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.6.4.1.cmml" xref="S3.E3.m1.1.1.1.1.6.4">superscript</csymbol><ci id="S3.E3.m1.1.1.1.1.6.4.2.cmml" xref="S3.E3.m1.1.1.1.1.6.4.2">𝑪</ci><ci id="S3.E3.m1.1.1.1.1.6.4.3.cmml" xref="S3.E3.m1.1.1.1.1.6.4.3">′</ci></apply></apply></apply><apply id="S3.E3.m1.1.1.1.1e.cmml" xref="S3.E3.m1.1.1.1"><eq id="S3.E3.m1.1.1.1.1.7.cmml" xref="S3.E3.m1.1.1.1.1.7"></eq><share href="https://arxiv.org/html/2410.03765v1#S3.E3.m1.1.1.1.1.6.cmml" id="S3.E3.m1.1.1.1.1f.cmml" xref="S3.E3.m1.1.1.1"></share><apply id="S3.E3.m1.1.1.1.1.8.cmml" xref="S3.E3.m1.1.1.1.1.8"><times id="S3.E3.m1.1.1.1.1.8.1.cmml" xref="S3.E3.m1.1.1.1.1.8.1"></times><apply id="S3.E3.m1.1.1.1.1.8.2.cmml" xref="S3.E3.m1.1.1.1.1.8.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.8.2.1.cmml" xref="S3.E3.m1.1.1.1.1.8.2">superscript</csymbol><ci id="S3.E3.m1.1.1.1.1.8.2.2.cmml" xref="S3.E3.m1.1.1.1.1.8.2.2">𝑩</ci><ci id="S3.E3.m1.1.1.1.1.8.2.3.cmml" xref="S3.E3.m1.1.1.1.1.8.2.3">′′</ci></apply><apply id="S3.E3.m1.1.1.1.1.8.3.cmml" xref="S3.E3.m1.1.1.1.1.8.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.8.3.1.cmml" xref="S3.E3.m1.1.1.1.1.8.3">superscript</csymbol><ci id="S3.E3.m1.1.1.1.1.8.3.2.cmml" xref="S3.E3.m1.1.1.1.1.8.3.2">𝑪</ci><ci id="S3.E3.m1.1.1.1.1.8.3.3.cmml" xref="S3.E3.m1.1.1.1.1.8.3.3">′</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.1c">\displaystyle{\bm{W}}\approx{\bm{S}}^{-1}{\bm{U}}^{\prime}_{k}{\bm{\Sigma}}^{%
\prime}_{k}{\bm{V}}^{\prime}_{k}={\bm{S}}^{-1}{\bm{B}}^{\prime}{\bm{C}}^{%
\prime}={\bm{B}}^{\prime\prime}{\bm{C}}^{\prime},</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.1d">bold_italic_W ≈ bold_italic_S start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT bold_italic_U start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT bold_Σ start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT bold_italic_V start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT = bold_italic_S start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT bold_italic_B start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT bold_italic_C start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = bold_italic_B start_POSTSUPERSCRIPT ′ ′ end_POSTSUPERSCRIPT bold_italic_C start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p5.8">where <math alttext="{\bm{B}}^{\prime\prime}" class="ltx_Math" display="inline" id="S3.SS1.p5.8.m1.1"><semantics id="S3.SS1.p5.8.m1.1a"><msup id="S3.SS1.p5.8.m1.1.1" xref="S3.SS1.p5.8.m1.1.1.cmml"><mi id="S3.SS1.p5.8.m1.1.1.2" xref="S3.SS1.p5.8.m1.1.1.2.cmml">𝑩</mi><mo id="S3.SS1.p5.8.m1.1.1.3" xref="S3.SS1.p5.8.m1.1.1.3.cmml">′′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.8.m1.1b"><apply id="S3.SS1.p5.8.m1.1.1.cmml" xref="S3.SS1.p5.8.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.8.m1.1.1.1.cmml" xref="S3.SS1.p5.8.m1.1.1">superscript</csymbol><ci id="S3.SS1.p5.8.m1.1.1.2.cmml" xref="S3.SS1.p5.8.m1.1.1.2">𝑩</ci><ci id="S3.SS1.p5.8.m1.1.1.3.cmml" xref="S3.SS1.p5.8.m1.1.1.3">′′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.8.m1.1c">{\bm{B}}^{\prime\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.8.m1.1d">bold_italic_B start_POSTSUPERSCRIPT ′ ′ end_POSTSUPERSCRIPT</annotation></semantics></math> is the final adjusted basis matrix in our paper.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Selection of Weight Matrices in LLMs for Cross-Layer Parameter Sharing</h3>
<div class="ltx_para ltx_noindent" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.7">Modern LLMs are constructed based on the decoder-only transformer architecture. A layer in such an architecture includes several types of weight matrices, which have different functions. <math alttext="{\bm{W}}_{K}" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><msub id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">𝑾</mi><mi id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml">K</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">𝑾</ci><ci id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">{\bm{W}}_{K}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">bold_italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="{\bm{W}}_{Q}" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><msub id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">𝑾</mi><mi id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">Q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">𝑾</ci><ci id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">{\bm{W}}_{Q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">bold_italic_W start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="{\bm{W}}_{V}" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><msub id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml">𝑾</mi><mi id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml">V</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2">𝑾</ci><ci id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">{\bm{W}}_{V}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">bold_italic_W start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT</annotation></semantics></math> are three types of projection matrices, which are used to generate the key, the query and the value matrices. <math alttext="{\bm{W}}_{O}" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m4.1"><semantics id="S3.SS2.p1.4.m4.1a"><msub id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><mi id="S3.SS2.p1.4.m4.1.1.2" xref="S3.SS2.p1.4.m4.1.1.2.cmml">𝑾</mi><mi id="S3.SS2.p1.4.m4.1.1.3" xref="S3.SS2.p1.4.m4.1.1.3.cmml">O</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2">𝑾</ci><ci id="S3.SS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3">𝑂</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">{\bm{W}}_{O}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m4.1d">bold_italic_W start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT</annotation></semantics></math>, another type of weight matrices, further transforms the attention result to build a new representation for an input embedding.
<math alttext="{\bm{W}}_{Up}" class="ltx_Math" display="inline" id="S3.SS2.p1.5.m5.1"><semantics id="S3.SS2.p1.5.m5.1a"><msub id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml"><mi id="S3.SS2.p1.5.m5.1.1.2" xref="S3.SS2.p1.5.m5.1.1.2.cmml">𝑾</mi><mrow id="S3.SS2.p1.5.m5.1.1.3" xref="S3.SS2.p1.5.m5.1.1.3.cmml"><mi id="S3.SS2.p1.5.m5.1.1.3.2" xref="S3.SS2.p1.5.m5.1.1.3.2.cmml">U</mi><mo id="S3.SS2.p1.5.m5.1.1.3.1" xref="S3.SS2.p1.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.5.m5.1.1.3.3" xref="S3.SS2.p1.5.m5.1.1.3.3.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><apply id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p1.5.m5.1.1.2.cmml" xref="S3.SS2.p1.5.m5.1.1.2">𝑾</ci><apply id="S3.SS2.p1.5.m5.1.1.3.cmml" xref="S3.SS2.p1.5.m5.1.1.3"><times id="S3.SS2.p1.5.m5.1.1.3.1.cmml" xref="S3.SS2.p1.5.m5.1.1.3.1"></times><ci id="S3.SS2.p1.5.m5.1.1.3.2.cmml" xref="S3.SS2.p1.5.m5.1.1.3.2">𝑈</ci><ci id="S3.SS2.p1.5.m5.1.1.3.3.cmml" xref="S3.SS2.p1.5.m5.1.1.3.3">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">{\bm{W}}_{Up}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.5.m5.1d">bold_italic_W start_POSTSUBSCRIPT italic_U italic_p end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="{\bm{W}}_{Gate}" class="ltx_Math" display="inline" id="S3.SS2.p1.6.m6.1"><semantics id="S3.SS2.p1.6.m6.1a"><msub id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml"><mi id="S3.SS2.p1.6.m6.1.1.2" xref="S3.SS2.p1.6.m6.1.1.2.cmml">𝑾</mi><mrow id="S3.SS2.p1.6.m6.1.1.3" xref="S3.SS2.p1.6.m6.1.1.3.cmml"><mi id="S3.SS2.p1.6.m6.1.1.3.2" xref="S3.SS2.p1.6.m6.1.1.3.2.cmml">G</mi><mo id="S3.SS2.p1.6.m6.1.1.3.1" xref="S3.SS2.p1.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.6.m6.1.1.3.3" xref="S3.SS2.p1.6.m6.1.1.3.3.cmml">a</mi><mo id="S3.SS2.p1.6.m6.1.1.3.1a" xref="S3.SS2.p1.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.6.m6.1.1.3.4" xref="S3.SS2.p1.6.m6.1.1.3.4.cmml">t</mi><mo id="S3.SS2.p1.6.m6.1.1.3.1b" xref="S3.SS2.p1.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.6.m6.1.1.3.5" xref="S3.SS2.p1.6.m6.1.1.3.5.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><apply id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.p1.6.m6.1.1.2.cmml" xref="S3.SS2.p1.6.m6.1.1.2">𝑾</ci><apply id="S3.SS2.p1.6.m6.1.1.3.cmml" xref="S3.SS2.p1.6.m6.1.1.3"><times id="S3.SS2.p1.6.m6.1.1.3.1.cmml" xref="S3.SS2.p1.6.m6.1.1.3.1"></times><ci id="S3.SS2.p1.6.m6.1.1.3.2.cmml" xref="S3.SS2.p1.6.m6.1.1.3.2">𝐺</ci><ci id="S3.SS2.p1.6.m6.1.1.3.3.cmml" xref="S3.SS2.p1.6.m6.1.1.3.3">𝑎</ci><ci id="S3.SS2.p1.6.m6.1.1.3.4.cmml" xref="S3.SS2.p1.6.m6.1.1.3.4">𝑡</ci><ci id="S3.SS2.p1.6.m6.1.1.3.5.cmml" xref="S3.SS2.p1.6.m6.1.1.3.5">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">{\bm{W}}_{Gate}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.6.m6.1d">bold_italic_W start_POSTSUBSCRIPT italic_G italic_a italic_t italic_e end_POSTSUBSCRIPT</annotation></semantics></math>(used in LLaMA and LLaMA2), further types of weight matrices,
represent this transformation result into a high-dimension embedding.
Afterwards, <math alttext="{\bm{W}}_{Down}" class="ltx_Math" display="inline" id="S3.SS2.p1.7.m7.1"><semantics id="S3.SS2.p1.7.m7.1a"><msub id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml"><mi id="S3.SS2.p1.7.m7.1.1.2" xref="S3.SS2.p1.7.m7.1.1.2.cmml">𝑾</mi><mrow id="S3.SS2.p1.7.m7.1.1.3" xref="S3.SS2.p1.7.m7.1.1.3.cmml"><mi id="S3.SS2.p1.7.m7.1.1.3.2" xref="S3.SS2.p1.7.m7.1.1.3.2.cmml">D</mi><mo id="S3.SS2.p1.7.m7.1.1.3.1" xref="S3.SS2.p1.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.7.m7.1.1.3.3" xref="S3.SS2.p1.7.m7.1.1.3.3.cmml">o</mi><mo id="S3.SS2.p1.7.m7.1.1.3.1a" xref="S3.SS2.p1.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.7.m7.1.1.3.4" xref="S3.SS2.p1.7.m7.1.1.3.4.cmml">w</mi><mo id="S3.SS2.p1.7.m7.1.1.3.1b" xref="S3.SS2.p1.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.7.m7.1.1.3.5" xref="S3.SS2.p1.7.m7.1.1.3.5.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><apply id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.1.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.p1.7.m7.1.1.2.cmml" xref="S3.SS2.p1.7.m7.1.1.2">𝑾</ci><apply id="S3.SS2.p1.7.m7.1.1.3.cmml" xref="S3.SS2.p1.7.m7.1.1.3"><times id="S3.SS2.p1.7.m7.1.1.3.1.cmml" xref="S3.SS2.p1.7.m7.1.1.3.1"></times><ci id="S3.SS2.p1.7.m7.1.1.3.2.cmml" xref="S3.SS2.p1.7.m7.1.1.3.2">𝐷</ci><ci id="S3.SS2.p1.7.m7.1.1.3.3.cmml" xref="S3.SS2.p1.7.m7.1.1.3.3">𝑜</ci><ci id="S3.SS2.p1.7.m7.1.1.3.4.cmml" xref="S3.SS2.p1.7.m7.1.1.3.4">𝑤</ci><ci id="S3.SS2.p1.7.m7.1.1.3.5.cmml" xref="S3.SS2.p1.7.m7.1.1.3.5">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">{\bm{W}}_{Down}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.7.m7.1d">bold_italic_W start_POSTSUBSCRIPT italic_D italic_o italic_w italic_n end_POSTSUBSCRIPT</annotation></semantics></math>, the last type of weight matrices, projects the high dimension embedding back to the low dimension embedding.
The types of weight matrices above have different functions, so that we need to determine which type of weight matrices can take advantage of cross-layer basis sharing with SVD described in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#S3.SS1" title="3.1 Representing Weight Matrices across Layers with Combinations of Basis Vectors and Coefficients ‣ 3 Methodology ‣ Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_tag">3.1</span></a> without affecting the performance of the LLM significantly.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.1">First of all, the type of matrices whose function are to project a high-dimension embedding into a low-dimension embedding such as <math alttext="{\bm{W}}_{Down}" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1"><semantics id="S3.SS2.p2.1.m1.1a"><msub id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">𝑾</mi><mrow id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml"><mi id="S3.SS2.p2.1.m1.1.1.3.2" xref="S3.SS2.p2.1.m1.1.1.3.2.cmml">D</mi><mo id="S3.SS2.p2.1.m1.1.1.3.1" xref="S3.SS2.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.1.m1.1.1.3.3" xref="S3.SS2.p2.1.m1.1.1.3.3.cmml">o</mi><mo id="S3.SS2.p2.1.m1.1.1.3.1a" xref="S3.SS2.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.1.m1.1.1.3.4" xref="S3.SS2.p2.1.m1.1.1.3.4.cmml">w</mi><mo id="S3.SS2.p2.1.m1.1.1.3.1b" xref="S3.SS2.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.1.m1.1.1.3.5" xref="S3.SS2.p2.1.m1.1.1.3.5.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">𝑾</ci><apply id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3"><times id="S3.SS2.p2.1.m1.1.1.3.1.cmml" xref="S3.SS2.p2.1.m1.1.1.3.1"></times><ci id="S3.SS2.p2.1.m1.1.1.3.2.cmml" xref="S3.SS2.p2.1.m1.1.1.3.2">𝐷</ci><ci id="S3.SS2.p2.1.m1.1.1.3.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3.3">𝑜</ci><ci id="S3.SS2.p2.1.m1.1.1.3.4.cmml" xref="S3.SS2.p2.1.m1.1.1.3.4">𝑤</ci><ci id="S3.SS2.p2.1.m1.1.1.3.5.cmml" xref="S3.SS2.p2.1.m1.1.1.3.5">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">{\bm{W}}_{Down}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.1d">bold_italic_W start_POSTSUBSCRIPT italic_D italic_o italic_w italic_n end_POSTSUBSCRIPT</annotation></semantics></math> cannot take advantage of the cross-layer parameter sharing. The reason is that after the horizontal concatenation of such matrices,
the rank of the concatenated matrix will be larger than that of an individual matrix.
Under the same compression ratio, compressing the concatenated matrix with SVD incurs a larger Frobenius loss than the original weight matrix.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.26">For the remaining types of weight matrices including <math alttext="{\bm{W}}_{K}" class="ltx_Math" display="inline" id="S3.SS2.p3.1.m1.1"><semantics id="S3.SS2.p3.1.m1.1a"><msub id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml"><mi id="S3.SS2.p3.1.m1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.2.cmml">𝑾</mi><mi id="S3.SS2.p3.1.m1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.3.cmml">K</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><apply id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.1.2">𝑾</ci><ci id="S3.SS2.p3.1.m1.1.1.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">{\bm{W}}_{K}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.1.m1.1d">bold_italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="{\bm{W}}_{Q}" class="ltx_Math" display="inline" id="S3.SS2.p3.2.m2.1"><semantics id="S3.SS2.p3.2.m2.1a"><msub id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml"><mi id="S3.SS2.p3.2.m2.1.1.2" xref="S3.SS2.p3.2.m2.1.1.2.cmml">𝑾</mi><mi id="S3.SS2.p3.2.m2.1.1.3" xref="S3.SS2.p3.2.m2.1.1.3.cmml">Q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><apply id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.1.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p3.2.m2.1.1.2.cmml" xref="S3.SS2.p3.2.m2.1.1.2">𝑾</ci><ci id="S3.SS2.p3.2.m2.1.1.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">{\bm{W}}_{Q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.2.m2.1d">bold_italic_W start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="{\bm{W}}_{V}" class="ltx_Math" display="inline" id="S3.SS2.p3.3.m3.1"><semantics id="S3.SS2.p3.3.m3.1a"><msub id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml"><mi id="S3.SS2.p3.3.m3.1.1.2" xref="S3.SS2.p3.3.m3.1.1.2.cmml">𝑾</mi><mi id="S3.SS2.p3.3.m3.1.1.3" xref="S3.SS2.p3.3.m3.1.1.3.cmml">V</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b"><apply id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.1.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p3.3.m3.1.1.2.cmml" xref="S3.SS2.p3.3.m3.1.1.2">𝑾</ci><ci id="S3.SS2.p3.3.m3.1.1.3.cmml" xref="S3.SS2.p3.3.m3.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">{\bm{W}}_{V}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.3.m3.1d">bold_italic_W start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="{\bm{W}}_{O}" class="ltx_Math" display="inline" id="S3.SS2.p3.4.m4.1"><semantics id="S3.SS2.p3.4.m4.1a"><msub id="S3.SS2.p3.4.m4.1.1" xref="S3.SS2.p3.4.m4.1.1.cmml"><mi id="S3.SS2.p3.4.m4.1.1.2" xref="S3.SS2.p3.4.m4.1.1.2.cmml">𝑾</mi><mi id="S3.SS2.p3.4.m4.1.1.3" xref="S3.SS2.p3.4.m4.1.1.3.cmml">O</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.1b"><apply id="S3.SS2.p3.4.m4.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.1.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p3.4.m4.1.1.2.cmml" xref="S3.SS2.p3.4.m4.1.1.2">𝑾</ci><ci id="S3.SS2.p3.4.m4.1.1.3.cmml" xref="S3.SS2.p3.4.m4.1.1.3">𝑂</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.1c">{\bm{W}}_{O}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.4.m4.1d">bold_italic_W start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="{\bm{W}}_{Up}" class="ltx_Math" display="inline" id="S3.SS2.p3.5.m5.1"><semantics id="S3.SS2.p3.5.m5.1a"><msub id="S3.SS2.p3.5.m5.1.1" xref="S3.SS2.p3.5.m5.1.1.cmml"><mi id="S3.SS2.p3.5.m5.1.1.2" xref="S3.SS2.p3.5.m5.1.1.2.cmml">𝑾</mi><mrow id="S3.SS2.p3.5.m5.1.1.3" xref="S3.SS2.p3.5.m5.1.1.3.cmml"><mi id="S3.SS2.p3.5.m5.1.1.3.2" xref="S3.SS2.p3.5.m5.1.1.3.2.cmml">U</mi><mo id="S3.SS2.p3.5.m5.1.1.3.1" xref="S3.SS2.p3.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p3.5.m5.1.1.3.3" xref="S3.SS2.p3.5.m5.1.1.3.3.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m5.1b"><apply id="S3.SS2.p3.5.m5.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.5.m5.1.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p3.5.m5.1.1.2.cmml" xref="S3.SS2.p3.5.m5.1.1.2">𝑾</ci><apply id="S3.SS2.p3.5.m5.1.1.3.cmml" xref="S3.SS2.p3.5.m5.1.1.3"><times id="S3.SS2.p3.5.m5.1.1.3.1.cmml" xref="S3.SS2.p3.5.m5.1.1.3.1"></times><ci id="S3.SS2.p3.5.m5.1.1.3.2.cmml" xref="S3.SS2.p3.5.m5.1.1.3.2">𝑈</ci><ci id="S3.SS2.p3.5.m5.1.1.3.3.cmml" xref="S3.SS2.p3.5.m5.1.1.3.3">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m5.1c">{\bm{W}}_{Up}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.5.m5.1d">bold_italic_W start_POSTSUBSCRIPT italic_U italic_p end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="{\bm{W}}_{Gate}" class="ltx_Math" display="inline" id="S3.SS2.p3.6.m6.1"><semantics id="S3.SS2.p3.6.m6.1a"><msub id="S3.SS2.p3.6.m6.1.1" xref="S3.SS2.p3.6.m6.1.1.cmml"><mi id="S3.SS2.p3.6.m6.1.1.2" xref="S3.SS2.p3.6.m6.1.1.2.cmml">𝑾</mi><mrow id="S3.SS2.p3.6.m6.1.1.3" xref="S3.SS2.p3.6.m6.1.1.3.cmml"><mi id="S3.SS2.p3.6.m6.1.1.3.2" xref="S3.SS2.p3.6.m6.1.1.3.2.cmml">G</mi><mo id="S3.SS2.p3.6.m6.1.1.3.1" xref="S3.SS2.p3.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p3.6.m6.1.1.3.3" xref="S3.SS2.p3.6.m6.1.1.3.3.cmml">a</mi><mo id="S3.SS2.p3.6.m6.1.1.3.1a" xref="S3.SS2.p3.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p3.6.m6.1.1.3.4" xref="S3.SS2.p3.6.m6.1.1.3.4.cmml">t</mi><mo id="S3.SS2.p3.6.m6.1.1.3.1b" xref="S3.SS2.p3.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p3.6.m6.1.1.3.5" xref="S3.SS2.p3.6.m6.1.1.3.5.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.6.m6.1b"><apply id="S3.SS2.p3.6.m6.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.6.m6.1.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.p3.6.m6.1.1.2.cmml" xref="S3.SS2.p3.6.m6.1.1.2">𝑾</ci><apply id="S3.SS2.p3.6.m6.1.1.3.cmml" xref="S3.SS2.p3.6.m6.1.1.3"><times id="S3.SS2.p3.6.m6.1.1.3.1.cmml" xref="S3.SS2.p3.6.m6.1.1.3.1"></times><ci id="S3.SS2.p3.6.m6.1.1.3.2.cmml" xref="S3.SS2.p3.6.m6.1.1.3.2">𝐺</ci><ci id="S3.SS2.p3.6.m6.1.1.3.3.cmml" xref="S3.SS2.p3.6.m6.1.1.3.3">𝑎</ci><ci id="S3.SS2.p3.6.m6.1.1.3.4.cmml" xref="S3.SS2.p3.6.m6.1.1.3.4">𝑡</ci><ci id="S3.SS2.p3.6.m6.1.1.3.5.cmml" xref="S3.SS2.p3.6.m6.1.1.3.5">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.6.m6.1c">{\bm{W}}_{Gate}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.6.m6.1d">bold_italic_W start_POSTSUBSCRIPT italic_G italic_a italic_t italic_e end_POSTSUBSCRIPT</annotation></semantics></math>, we will determine whether each of them can use cross-layer basis sharing by examining the Frobenius loss resulted from this sharing.
To explain this concept, we use basis sharing
across two layers for <math alttext="{\bm{W}}_{K}" class="ltx_Math" display="inline" id="S3.SS2.p3.7.m7.1"><semantics id="S3.SS2.p3.7.m7.1a"><msub id="S3.SS2.p3.7.m7.1.1" xref="S3.SS2.p3.7.m7.1.1.cmml"><mi id="S3.SS2.p3.7.m7.1.1.2" xref="S3.SS2.p3.7.m7.1.1.2.cmml">𝑾</mi><mi id="S3.SS2.p3.7.m7.1.1.3" xref="S3.SS2.p3.7.m7.1.1.3.cmml">K</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.7.m7.1b"><apply id="S3.SS2.p3.7.m7.1.1.cmml" xref="S3.SS2.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.7.m7.1.1.1.cmml" xref="S3.SS2.p3.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.p3.7.m7.1.1.2.cmml" xref="S3.SS2.p3.7.m7.1.1.2">𝑾</ci><ci id="S3.SS2.p3.7.m7.1.1.3.cmml" xref="S3.SS2.p3.7.m7.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.7.m7.1c">{\bm{W}}_{K}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.7.m7.1d">bold_italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math> in LLaMA2-7B as an example. Assume that we remove small singular values by applying SVD on <math alttext="{\bm{S}}^{(i)}_{K}{\bm{W}}^{(i)}_{K}" class="ltx_Math" display="inline" id="S3.SS2.p3.8.m8.2"><semantics id="S3.SS2.p3.8.m8.2a"><mrow id="S3.SS2.p3.8.m8.2.3" xref="S3.SS2.p3.8.m8.2.3.cmml"><msubsup id="S3.SS2.p3.8.m8.2.3.2" xref="S3.SS2.p3.8.m8.2.3.2.cmml"><mi id="S3.SS2.p3.8.m8.2.3.2.2.2" xref="S3.SS2.p3.8.m8.2.3.2.2.2.cmml">𝑺</mi><mi id="S3.SS2.p3.8.m8.2.3.2.3" xref="S3.SS2.p3.8.m8.2.3.2.3.cmml">K</mi><mrow id="S3.SS2.p3.8.m8.1.1.1.3" xref="S3.SS2.p3.8.m8.2.3.2.cmml"><mo id="S3.SS2.p3.8.m8.1.1.1.3.1" stretchy="false" xref="S3.SS2.p3.8.m8.2.3.2.cmml">(</mo><mi id="S3.SS2.p3.8.m8.1.1.1.1" xref="S3.SS2.p3.8.m8.1.1.1.1.cmml">i</mi><mo id="S3.SS2.p3.8.m8.1.1.1.3.2" stretchy="false" xref="S3.SS2.p3.8.m8.2.3.2.cmml">)</mo></mrow></msubsup><mo id="S3.SS2.p3.8.m8.2.3.1" xref="S3.SS2.p3.8.m8.2.3.1.cmml">⁢</mo><msubsup id="S3.SS2.p3.8.m8.2.3.3" xref="S3.SS2.p3.8.m8.2.3.3.cmml"><mi id="S3.SS2.p3.8.m8.2.3.3.2.2" xref="S3.SS2.p3.8.m8.2.3.3.2.2.cmml">𝑾</mi><mi id="S3.SS2.p3.8.m8.2.3.3.3" xref="S3.SS2.p3.8.m8.2.3.3.3.cmml">K</mi><mrow id="S3.SS2.p3.8.m8.2.2.1.3" xref="S3.SS2.p3.8.m8.2.3.3.cmml"><mo id="S3.SS2.p3.8.m8.2.2.1.3.1" stretchy="false" xref="S3.SS2.p3.8.m8.2.3.3.cmml">(</mo><mi id="S3.SS2.p3.8.m8.2.2.1.1" xref="S3.SS2.p3.8.m8.2.2.1.1.cmml">i</mi><mo id="S3.SS2.p3.8.m8.2.2.1.3.2" stretchy="false" xref="S3.SS2.p3.8.m8.2.3.3.cmml">)</mo></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.8.m8.2b"><apply id="S3.SS2.p3.8.m8.2.3.cmml" xref="S3.SS2.p3.8.m8.2.3"><times id="S3.SS2.p3.8.m8.2.3.1.cmml" xref="S3.SS2.p3.8.m8.2.3.1"></times><apply id="S3.SS2.p3.8.m8.2.3.2.cmml" xref="S3.SS2.p3.8.m8.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p3.8.m8.2.3.2.1.cmml" xref="S3.SS2.p3.8.m8.2.3.2">subscript</csymbol><apply id="S3.SS2.p3.8.m8.2.3.2.2.cmml" xref="S3.SS2.p3.8.m8.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p3.8.m8.2.3.2.2.1.cmml" xref="S3.SS2.p3.8.m8.2.3.2">superscript</csymbol><ci id="S3.SS2.p3.8.m8.2.3.2.2.2.cmml" xref="S3.SS2.p3.8.m8.2.3.2.2.2">𝑺</ci><ci id="S3.SS2.p3.8.m8.1.1.1.1.cmml" xref="S3.SS2.p3.8.m8.1.1.1.1">𝑖</ci></apply><ci id="S3.SS2.p3.8.m8.2.3.2.3.cmml" xref="S3.SS2.p3.8.m8.2.3.2.3">𝐾</ci></apply><apply id="S3.SS2.p3.8.m8.2.3.3.cmml" xref="S3.SS2.p3.8.m8.2.3.3"><csymbol cd="ambiguous" id="S3.SS2.p3.8.m8.2.3.3.1.cmml" xref="S3.SS2.p3.8.m8.2.3.3">subscript</csymbol><apply id="S3.SS2.p3.8.m8.2.3.3.2.cmml" xref="S3.SS2.p3.8.m8.2.3.3"><csymbol cd="ambiguous" id="S3.SS2.p3.8.m8.2.3.3.2.1.cmml" xref="S3.SS2.p3.8.m8.2.3.3">superscript</csymbol><ci id="S3.SS2.p3.8.m8.2.3.3.2.2.cmml" xref="S3.SS2.p3.8.m8.2.3.3.2.2">𝑾</ci><ci id="S3.SS2.p3.8.m8.2.2.1.1.cmml" xref="S3.SS2.p3.8.m8.2.2.1.1">𝑖</ci></apply><ci id="S3.SS2.p3.8.m8.2.3.3.3.cmml" xref="S3.SS2.p3.8.m8.2.3.3.3">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.8.m8.2c">{\bm{S}}^{(i)}_{K}{\bm{W}}^{(i)}_{K}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.8.m8.2d">bold_italic_S start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT bold_italic_W start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math> to achieve a compression ratio of 20%, where <math alttext="{\bm{W}}_{K}^{(i)}" class="ltx_Math" display="inline" id="S3.SS2.p3.9.m9.1"><semantics id="S3.SS2.p3.9.m9.1a"><msubsup id="S3.SS2.p3.9.m9.1.2" xref="S3.SS2.p3.9.m9.1.2.cmml"><mi id="S3.SS2.p3.9.m9.1.2.2.2" xref="S3.SS2.p3.9.m9.1.2.2.2.cmml">𝑾</mi><mi id="S3.SS2.p3.9.m9.1.2.2.3" xref="S3.SS2.p3.9.m9.1.2.2.3.cmml">K</mi><mrow id="S3.SS2.p3.9.m9.1.1.1.3" xref="S3.SS2.p3.9.m9.1.2.cmml"><mo id="S3.SS2.p3.9.m9.1.1.1.3.1" stretchy="false" xref="S3.SS2.p3.9.m9.1.2.cmml">(</mo><mi id="S3.SS2.p3.9.m9.1.1.1.1" xref="S3.SS2.p3.9.m9.1.1.1.1.cmml">i</mi><mo id="S3.SS2.p3.9.m9.1.1.1.3.2" stretchy="false" xref="S3.SS2.p3.9.m9.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.9.m9.1b"><apply id="S3.SS2.p3.9.m9.1.2.cmml" xref="S3.SS2.p3.9.m9.1.2"><csymbol cd="ambiguous" id="S3.SS2.p3.9.m9.1.2.1.cmml" xref="S3.SS2.p3.9.m9.1.2">superscript</csymbol><apply id="S3.SS2.p3.9.m9.1.2.2.cmml" xref="S3.SS2.p3.9.m9.1.2"><csymbol cd="ambiguous" id="S3.SS2.p3.9.m9.1.2.2.1.cmml" xref="S3.SS2.p3.9.m9.1.2">subscript</csymbol><ci id="S3.SS2.p3.9.m9.1.2.2.2.cmml" xref="S3.SS2.p3.9.m9.1.2.2.2">𝑾</ci><ci id="S3.SS2.p3.9.m9.1.2.2.3.cmml" xref="S3.SS2.p3.9.m9.1.2.2.3">𝐾</ci></apply><ci id="S3.SS2.p3.9.m9.1.1.1.1.cmml" xref="S3.SS2.p3.9.m9.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.9.m9.1c">{\bm{W}}_{K}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.9.m9.1d">bold_italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> is <math alttext="{\bm{W}}_{K}" class="ltx_Math" display="inline" id="S3.SS2.p3.10.m10.1"><semantics id="S3.SS2.p3.10.m10.1a"><msub id="S3.SS2.p3.10.m10.1.1" xref="S3.SS2.p3.10.m10.1.1.cmml"><mi id="S3.SS2.p3.10.m10.1.1.2" xref="S3.SS2.p3.10.m10.1.1.2.cmml">𝑾</mi><mi id="S3.SS2.p3.10.m10.1.1.3" xref="S3.SS2.p3.10.m10.1.1.3.cmml">K</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.10.m10.1b"><apply id="S3.SS2.p3.10.m10.1.1.cmml" xref="S3.SS2.p3.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.10.m10.1.1.1.cmml" xref="S3.SS2.p3.10.m10.1.1">subscript</csymbol><ci id="S3.SS2.p3.10.m10.1.1.2.cmml" xref="S3.SS2.p3.10.m10.1.1.2">𝑾</ci><ci id="S3.SS2.p3.10.m10.1.1.3.cmml" xref="S3.SS2.p3.10.m10.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.10.m10.1c">{\bm{W}}_{K}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.10.m10.1d">bold_italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math> matrix in the <math alttext="i^{th}" class="ltx_Math" display="inline" id="S3.SS2.p3.11.m11.1"><semantics id="S3.SS2.p3.11.m11.1a"><msup id="S3.SS2.p3.11.m11.1.1" xref="S3.SS2.p3.11.m11.1.1.cmml"><mi id="S3.SS2.p3.11.m11.1.1.2" xref="S3.SS2.p3.11.m11.1.1.2.cmml">i</mi><mrow id="S3.SS2.p3.11.m11.1.1.3" xref="S3.SS2.p3.11.m11.1.1.3.cmml"><mi id="S3.SS2.p3.11.m11.1.1.3.2" xref="S3.SS2.p3.11.m11.1.1.3.2.cmml">t</mi><mo id="S3.SS2.p3.11.m11.1.1.3.1" xref="S3.SS2.p3.11.m11.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p3.11.m11.1.1.3.3" xref="S3.SS2.p3.11.m11.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.11.m11.1b"><apply id="S3.SS2.p3.11.m11.1.1.cmml" xref="S3.SS2.p3.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.11.m11.1.1.1.cmml" xref="S3.SS2.p3.11.m11.1.1">superscript</csymbol><ci id="S3.SS2.p3.11.m11.1.1.2.cmml" xref="S3.SS2.p3.11.m11.1.1.2">𝑖</ci><apply id="S3.SS2.p3.11.m11.1.1.3.cmml" xref="S3.SS2.p3.11.m11.1.1.3"><times id="S3.SS2.p3.11.m11.1.1.3.1.cmml" xref="S3.SS2.p3.11.m11.1.1.3.1"></times><ci id="S3.SS2.p3.11.m11.1.1.3.2.cmml" xref="S3.SS2.p3.11.m11.1.1.3.2">𝑡</ci><ci id="S3.SS2.p3.11.m11.1.1.3.3.cmml" xref="S3.SS2.p3.11.m11.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.11.m11.1c">i^{th}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.11.m11.1d">italic_i start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> layer (<math alttext="i\in[1,32]" class="ltx_Math" display="inline" id="S3.SS2.p3.12.m12.2"><semantics id="S3.SS2.p3.12.m12.2a"><mrow id="S3.SS2.p3.12.m12.2.3" xref="S3.SS2.p3.12.m12.2.3.cmml"><mi id="S3.SS2.p3.12.m12.2.3.2" xref="S3.SS2.p3.12.m12.2.3.2.cmml">i</mi><mo id="S3.SS2.p3.12.m12.2.3.1" xref="S3.SS2.p3.12.m12.2.3.1.cmml">∈</mo><mrow id="S3.SS2.p3.12.m12.2.3.3.2" xref="S3.SS2.p3.12.m12.2.3.3.1.cmml"><mo id="S3.SS2.p3.12.m12.2.3.3.2.1" stretchy="false" xref="S3.SS2.p3.12.m12.2.3.3.1.cmml">[</mo><mn id="S3.SS2.p3.12.m12.1.1" xref="S3.SS2.p3.12.m12.1.1.cmml">1</mn><mo id="S3.SS2.p3.12.m12.2.3.3.2.2" xref="S3.SS2.p3.12.m12.2.3.3.1.cmml">,</mo><mn id="S3.SS2.p3.12.m12.2.2" xref="S3.SS2.p3.12.m12.2.2.cmml">32</mn><mo id="S3.SS2.p3.12.m12.2.3.3.2.3" stretchy="false" xref="S3.SS2.p3.12.m12.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.12.m12.2b"><apply id="S3.SS2.p3.12.m12.2.3.cmml" xref="S3.SS2.p3.12.m12.2.3"><in id="S3.SS2.p3.12.m12.2.3.1.cmml" xref="S3.SS2.p3.12.m12.2.3.1"></in><ci id="S3.SS2.p3.12.m12.2.3.2.cmml" xref="S3.SS2.p3.12.m12.2.3.2">𝑖</ci><interval closure="closed" id="S3.SS2.p3.12.m12.2.3.3.1.cmml" xref="S3.SS2.p3.12.m12.2.3.3.2"><cn id="S3.SS2.p3.12.m12.1.1.cmml" type="integer" xref="S3.SS2.p3.12.m12.1.1">1</cn><cn id="S3.SS2.p3.12.m12.2.2.cmml" type="integer" xref="S3.SS2.p3.12.m12.2.2">32</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.12.m12.2c">i\in[1,32]</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.12.m12.2d">italic_i ∈ [ 1 , 32 ]</annotation></semantics></math>) and <math alttext="{\bm{S}}_{K}^{(i)}" class="ltx_Math" display="inline" id="S3.SS2.p3.13.m13.1"><semantics id="S3.SS2.p3.13.m13.1a"><msubsup id="S3.SS2.p3.13.m13.1.2" xref="S3.SS2.p3.13.m13.1.2.cmml"><mi id="S3.SS2.p3.13.m13.1.2.2.2" xref="S3.SS2.p3.13.m13.1.2.2.2.cmml">𝑺</mi><mi id="S3.SS2.p3.13.m13.1.2.2.3" xref="S3.SS2.p3.13.m13.1.2.2.3.cmml">K</mi><mrow id="S3.SS2.p3.13.m13.1.1.1.3" xref="S3.SS2.p3.13.m13.1.2.cmml"><mo id="S3.SS2.p3.13.m13.1.1.1.3.1" stretchy="false" xref="S3.SS2.p3.13.m13.1.2.cmml">(</mo><mi id="S3.SS2.p3.13.m13.1.1.1.1" xref="S3.SS2.p3.13.m13.1.1.1.1.cmml">i</mi><mo id="S3.SS2.p3.13.m13.1.1.1.3.2" stretchy="false" xref="S3.SS2.p3.13.m13.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.13.m13.1b"><apply id="S3.SS2.p3.13.m13.1.2.cmml" xref="S3.SS2.p3.13.m13.1.2"><csymbol cd="ambiguous" id="S3.SS2.p3.13.m13.1.2.1.cmml" xref="S3.SS2.p3.13.m13.1.2">superscript</csymbol><apply id="S3.SS2.p3.13.m13.1.2.2.cmml" xref="S3.SS2.p3.13.m13.1.2"><csymbol cd="ambiguous" id="S3.SS2.p3.13.m13.1.2.2.1.cmml" xref="S3.SS2.p3.13.m13.1.2">subscript</csymbol><ci id="S3.SS2.p3.13.m13.1.2.2.2.cmml" xref="S3.SS2.p3.13.m13.1.2.2.2">𝑺</ci><ci id="S3.SS2.p3.13.m13.1.2.2.3.cmml" xref="S3.SS2.p3.13.m13.1.2.2.3">𝐾</ci></apply><ci id="S3.SS2.p3.13.m13.1.1.1.1.cmml" xref="S3.SS2.p3.13.m13.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.13.m13.1c">{\bm{S}}_{K}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.13.m13.1d">bold_italic_S start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> is the corresponding <math alttext="{\bm{S}}" class="ltx_Math" display="inline" id="S3.SS2.p3.14.m14.1"><semantics id="S3.SS2.p3.14.m14.1a"><mi id="S3.SS2.p3.14.m14.1.1" xref="S3.SS2.p3.14.m14.1.1.cmml">𝑺</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.14.m14.1b"><ci id="S3.SS2.p3.14.m14.1.1.cmml" xref="S3.SS2.p3.14.m14.1.1">𝑺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.14.m14.1c">{\bm{S}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.14.m14.1d">bold_italic_S</annotation></semantics></math> matrix for <math alttext="{\bm{W}}_{K}^{(i)}" class="ltx_Math" display="inline" id="S3.SS2.p3.15.m15.1"><semantics id="S3.SS2.p3.15.m15.1a"><msubsup id="S3.SS2.p3.15.m15.1.2" xref="S3.SS2.p3.15.m15.1.2.cmml"><mi id="S3.SS2.p3.15.m15.1.2.2.2" xref="S3.SS2.p3.15.m15.1.2.2.2.cmml">𝑾</mi><mi id="S3.SS2.p3.15.m15.1.2.2.3" xref="S3.SS2.p3.15.m15.1.2.2.3.cmml">K</mi><mrow id="S3.SS2.p3.15.m15.1.1.1.3" xref="S3.SS2.p3.15.m15.1.2.cmml"><mo id="S3.SS2.p3.15.m15.1.1.1.3.1" stretchy="false" xref="S3.SS2.p3.15.m15.1.2.cmml">(</mo><mi id="S3.SS2.p3.15.m15.1.1.1.1" xref="S3.SS2.p3.15.m15.1.1.1.1.cmml">i</mi><mo id="S3.SS2.p3.15.m15.1.1.1.3.2" stretchy="false" xref="S3.SS2.p3.15.m15.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.15.m15.1b"><apply id="S3.SS2.p3.15.m15.1.2.cmml" xref="S3.SS2.p3.15.m15.1.2"><csymbol cd="ambiguous" id="S3.SS2.p3.15.m15.1.2.1.cmml" xref="S3.SS2.p3.15.m15.1.2">superscript</csymbol><apply id="S3.SS2.p3.15.m15.1.2.2.cmml" xref="S3.SS2.p3.15.m15.1.2"><csymbol cd="ambiguous" id="S3.SS2.p3.15.m15.1.2.2.1.cmml" xref="S3.SS2.p3.15.m15.1.2">subscript</csymbol><ci id="S3.SS2.p3.15.m15.1.2.2.2.cmml" xref="S3.SS2.p3.15.m15.1.2.2.2">𝑾</ci><ci id="S3.SS2.p3.15.m15.1.2.2.3.cmml" xref="S3.SS2.p3.15.m15.1.2.2.3">𝐾</ci></apply><ci id="S3.SS2.p3.15.m15.1.1.1.1.cmml" xref="S3.SS2.p3.15.m15.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.15.m15.1c">{\bm{W}}_{K}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.15.m15.1d">bold_italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math>. The resulting Frobenius loss of each layer under this compression ratio will be evaluated.
To evaluate the Frobenius
loss incurred by basis sharing,
we horizontally concatenate <math alttext="{\bm{W}}_{K}^{(i)}" class="ltx_Math" display="inline" id="S3.SS2.p3.16.m16.1"><semantics id="S3.SS2.p3.16.m16.1a"><msubsup id="S3.SS2.p3.16.m16.1.2" xref="S3.SS2.p3.16.m16.1.2.cmml"><mi id="S3.SS2.p3.16.m16.1.2.2.2" xref="S3.SS2.p3.16.m16.1.2.2.2.cmml">𝑾</mi><mi id="S3.SS2.p3.16.m16.1.2.2.3" xref="S3.SS2.p3.16.m16.1.2.2.3.cmml">K</mi><mrow id="S3.SS2.p3.16.m16.1.1.1.3" xref="S3.SS2.p3.16.m16.1.2.cmml"><mo id="S3.SS2.p3.16.m16.1.1.1.3.1" stretchy="false" xref="S3.SS2.p3.16.m16.1.2.cmml">(</mo><mi id="S3.SS2.p3.16.m16.1.1.1.1" xref="S3.SS2.p3.16.m16.1.1.1.1.cmml">i</mi><mo id="S3.SS2.p3.16.m16.1.1.1.3.2" stretchy="false" xref="S3.SS2.p3.16.m16.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.16.m16.1b"><apply id="S3.SS2.p3.16.m16.1.2.cmml" xref="S3.SS2.p3.16.m16.1.2"><csymbol cd="ambiguous" id="S3.SS2.p3.16.m16.1.2.1.cmml" xref="S3.SS2.p3.16.m16.1.2">superscript</csymbol><apply id="S3.SS2.p3.16.m16.1.2.2.cmml" xref="S3.SS2.p3.16.m16.1.2"><csymbol cd="ambiguous" id="S3.SS2.p3.16.m16.1.2.2.1.cmml" xref="S3.SS2.p3.16.m16.1.2">subscript</csymbol><ci id="S3.SS2.p3.16.m16.1.2.2.2.cmml" xref="S3.SS2.p3.16.m16.1.2.2.2">𝑾</ci><ci id="S3.SS2.p3.16.m16.1.2.2.3.cmml" xref="S3.SS2.p3.16.m16.1.2.2.3">𝐾</ci></apply><ci id="S3.SS2.p3.16.m16.1.1.1.1.cmml" xref="S3.SS2.p3.16.m16.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.16.m16.1c">{\bm{W}}_{K}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.16.m16.1d">bold_italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> of the <math alttext="i^{th}" class="ltx_Math" display="inline" id="S3.SS2.p3.17.m17.1"><semantics id="S3.SS2.p3.17.m17.1a"><msup id="S3.SS2.p3.17.m17.1.1" xref="S3.SS2.p3.17.m17.1.1.cmml"><mi id="S3.SS2.p3.17.m17.1.1.2" xref="S3.SS2.p3.17.m17.1.1.2.cmml">i</mi><mrow id="S3.SS2.p3.17.m17.1.1.3" xref="S3.SS2.p3.17.m17.1.1.3.cmml"><mi id="S3.SS2.p3.17.m17.1.1.3.2" xref="S3.SS2.p3.17.m17.1.1.3.2.cmml">t</mi><mo id="S3.SS2.p3.17.m17.1.1.3.1" xref="S3.SS2.p3.17.m17.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p3.17.m17.1.1.3.3" xref="S3.SS2.p3.17.m17.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.17.m17.1b"><apply id="S3.SS2.p3.17.m17.1.1.cmml" xref="S3.SS2.p3.17.m17.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.17.m17.1.1.1.cmml" xref="S3.SS2.p3.17.m17.1.1">superscript</csymbol><ci id="S3.SS2.p3.17.m17.1.1.2.cmml" xref="S3.SS2.p3.17.m17.1.1.2">𝑖</ci><apply id="S3.SS2.p3.17.m17.1.1.3.cmml" xref="S3.SS2.p3.17.m17.1.1.3"><times id="S3.SS2.p3.17.m17.1.1.3.1.cmml" xref="S3.SS2.p3.17.m17.1.1.3.1"></times><ci id="S3.SS2.p3.17.m17.1.1.3.2.cmml" xref="S3.SS2.p3.17.m17.1.1.3.2">𝑡</ci><ci id="S3.SS2.p3.17.m17.1.1.3.3.cmml" xref="S3.SS2.p3.17.m17.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.17.m17.1c">i^{th}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.17.m17.1d">italic_i start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> layer and <math alttext="{\bm{W}}_{K}^{(j)}" class="ltx_Math" display="inline" id="S3.SS2.p3.18.m18.1"><semantics id="S3.SS2.p3.18.m18.1a"><msubsup id="S3.SS2.p3.18.m18.1.2" xref="S3.SS2.p3.18.m18.1.2.cmml"><mi id="S3.SS2.p3.18.m18.1.2.2.2" xref="S3.SS2.p3.18.m18.1.2.2.2.cmml">𝑾</mi><mi id="S3.SS2.p3.18.m18.1.2.2.3" xref="S3.SS2.p3.18.m18.1.2.2.3.cmml">K</mi><mrow id="S3.SS2.p3.18.m18.1.1.1.3" xref="S3.SS2.p3.18.m18.1.2.cmml"><mo id="S3.SS2.p3.18.m18.1.1.1.3.1" stretchy="false" xref="S3.SS2.p3.18.m18.1.2.cmml">(</mo><mi id="S3.SS2.p3.18.m18.1.1.1.1" xref="S3.SS2.p3.18.m18.1.1.1.1.cmml">j</mi><mo id="S3.SS2.p3.18.m18.1.1.1.3.2" stretchy="false" xref="S3.SS2.p3.18.m18.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.18.m18.1b"><apply id="S3.SS2.p3.18.m18.1.2.cmml" xref="S3.SS2.p3.18.m18.1.2"><csymbol cd="ambiguous" id="S3.SS2.p3.18.m18.1.2.1.cmml" xref="S3.SS2.p3.18.m18.1.2">superscript</csymbol><apply id="S3.SS2.p3.18.m18.1.2.2.cmml" xref="S3.SS2.p3.18.m18.1.2"><csymbol cd="ambiguous" id="S3.SS2.p3.18.m18.1.2.2.1.cmml" xref="S3.SS2.p3.18.m18.1.2">subscript</csymbol><ci id="S3.SS2.p3.18.m18.1.2.2.2.cmml" xref="S3.SS2.p3.18.m18.1.2.2.2">𝑾</ci><ci id="S3.SS2.p3.18.m18.1.2.2.3.cmml" xref="S3.SS2.p3.18.m18.1.2.2.3">𝐾</ci></apply><ci id="S3.SS2.p3.18.m18.1.1.1.1.cmml" xref="S3.SS2.p3.18.m18.1.1.1.1">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.18.m18.1c">{\bm{W}}_{K}^{(j)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.18.m18.1d">bold_italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT</annotation></semantics></math> of the <math alttext="j^{th}" class="ltx_Math" display="inline" id="S3.SS2.p3.19.m19.1"><semantics id="S3.SS2.p3.19.m19.1a"><msup id="S3.SS2.p3.19.m19.1.1" xref="S3.SS2.p3.19.m19.1.1.cmml"><mi id="S3.SS2.p3.19.m19.1.1.2" xref="S3.SS2.p3.19.m19.1.1.2.cmml">j</mi><mrow id="S3.SS2.p3.19.m19.1.1.3" xref="S3.SS2.p3.19.m19.1.1.3.cmml"><mi id="S3.SS2.p3.19.m19.1.1.3.2" xref="S3.SS2.p3.19.m19.1.1.3.2.cmml">t</mi><mo id="S3.SS2.p3.19.m19.1.1.3.1" xref="S3.SS2.p3.19.m19.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p3.19.m19.1.1.3.3" xref="S3.SS2.p3.19.m19.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.19.m19.1b"><apply id="S3.SS2.p3.19.m19.1.1.cmml" xref="S3.SS2.p3.19.m19.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.19.m19.1.1.1.cmml" xref="S3.SS2.p3.19.m19.1.1">superscript</csymbol><ci id="S3.SS2.p3.19.m19.1.1.2.cmml" xref="S3.SS2.p3.19.m19.1.1.2">𝑗</ci><apply id="S3.SS2.p3.19.m19.1.1.3.cmml" xref="S3.SS2.p3.19.m19.1.1.3"><times id="S3.SS2.p3.19.m19.1.1.3.1.cmml" xref="S3.SS2.p3.19.m19.1.1.3.1"></times><ci id="S3.SS2.p3.19.m19.1.1.3.2.cmml" xref="S3.SS2.p3.19.m19.1.1.3.2">𝑡</ci><ci id="S3.SS2.p3.19.m19.1.1.3.3.cmml" xref="S3.SS2.p3.19.m19.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.19.m19.1c">j^{th}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.19.m19.1d">italic_j start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math>layer as <math alttext="{\bm{W}}_{K}^{(i,j)}" class="ltx_Math" display="inline" id="S3.SS2.p3.20.m20.2"><semantics id="S3.SS2.p3.20.m20.2a"><msubsup id="S3.SS2.p3.20.m20.2.3" xref="S3.SS2.p3.20.m20.2.3.cmml"><mi id="S3.SS2.p3.20.m20.2.3.2.2" xref="S3.SS2.p3.20.m20.2.3.2.2.cmml">𝑾</mi><mi id="S3.SS2.p3.20.m20.2.3.2.3" xref="S3.SS2.p3.20.m20.2.3.2.3.cmml">K</mi><mrow id="S3.SS2.p3.20.m20.2.2.2.4" xref="S3.SS2.p3.20.m20.2.2.2.3.cmml"><mo id="S3.SS2.p3.20.m20.2.2.2.4.1" stretchy="false" xref="S3.SS2.p3.20.m20.2.2.2.3.cmml">(</mo><mi id="S3.SS2.p3.20.m20.1.1.1.1" xref="S3.SS2.p3.20.m20.1.1.1.1.cmml">i</mi><mo id="S3.SS2.p3.20.m20.2.2.2.4.2" xref="S3.SS2.p3.20.m20.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p3.20.m20.2.2.2.2" xref="S3.SS2.p3.20.m20.2.2.2.2.cmml">j</mi><mo id="S3.SS2.p3.20.m20.2.2.2.4.3" stretchy="false" xref="S3.SS2.p3.20.m20.2.2.2.3.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.20.m20.2b"><apply id="S3.SS2.p3.20.m20.2.3.cmml" xref="S3.SS2.p3.20.m20.2.3"><csymbol cd="ambiguous" id="S3.SS2.p3.20.m20.2.3.1.cmml" xref="S3.SS2.p3.20.m20.2.3">superscript</csymbol><apply id="S3.SS2.p3.20.m20.2.3.2.cmml" xref="S3.SS2.p3.20.m20.2.3"><csymbol cd="ambiguous" id="S3.SS2.p3.20.m20.2.3.2.1.cmml" xref="S3.SS2.p3.20.m20.2.3">subscript</csymbol><ci id="S3.SS2.p3.20.m20.2.3.2.2.cmml" xref="S3.SS2.p3.20.m20.2.3.2.2">𝑾</ci><ci id="S3.SS2.p3.20.m20.2.3.2.3.cmml" xref="S3.SS2.p3.20.m20.2.3.2.3">𝐾</ci></apply><interval closure="open" id="S3.SS2.p3.20.m20.2.2.2.3.cmml" xref="S3.SS2.p3.20.m20.2.2.2.4"><ci id="S3.SS2.p3.20.m20.1.1.1.1.cmml" xref="S3.SS2.p3.20.m20.1.1.1.1">𝑖</ci><ci id="S3.SS2.p3.20.m20.2.2.2.2.cmml" xref="S3.SS2.p3.20.m20.2.2.2.2">𝑗</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.20.m20.2c">{\bm{W}}_{K}^{(i,j)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.20.m20.2d">bold_italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i , italic_j ) end_POSTSUPERSCRIPT</annotation></semantics></math> where <math alttext="j\not=i" class="ltx_Math" display="inline" id="S3.SS2.p3.21.m21.1"><semantics id="S3.SS2.p3.21.m21.1a"><mrow id="S3.SS2.p3.21.m21.1.1" xref="S3.SS2.p3.21.m21.1.1.cmml"><mi id="S3.SS2.p3.21.m21.1.1.2" xref="S3.SS2.p3.21.m21.1.1.2.cmml">j</mi><mo id="S3.SS2.p3.21.m21.1.1.1" xref="S3.SS2.p3.21.m21.1.1.1.cmml">≠</mo><mi id="S3.SS2.p3.21.m21.1.1.3" xref="S3.SS2.p3.21.m21.1.1.3.cmml">i</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.21.m21.1b"><apply id="S3.SS2.p3.21.m21.1.1.cmml" xref="S3.SS2.p3.21.m21.1.1"><neq id="S3.SS2.p3.21.m21.1.1.1.cmml" xref="S3.SS2.p3.21.m21.1.1.1"></neq><ci id="S3.SS2.p3.21.m21.1.1.2.cmml" xref="S3.SS2.p3.21.m21.1.1.2">𝑗</ci><ci id="S3.SS2.p3.21.m21.1.1.3.cmml" xref="S3.SS2.p3.21.m21.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.21.m21.1c">j\not=i</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.21.m21.1d">italic_j ≠ italic_i</annotation></semantics></math>, <math alttext="i,j\in[1,32]" class="ltx_Math" display="inline" id="S3.SS2.p3.22.m22.4"><semantics id="S3.SS2.p3.22.m22.4a"><mrow id="S3.SS2.p3.22.m22.4.5" xref="S3.SS2.p3.22.m22.4.5.cmml"><mrow id="S3.SS2.p3.22.m22.4.5.2.2" xref="S3.SS2.p3.22.m22.4.5.2.1.cmml"><mi id="S3.SS2.p3.22.m22.3.3" xref="S3.SS2.p3.22.m22.3.3.cmml">i</mi><mo id="S3.SS2.p3.22.m22.4.5.2.2.1" xref="S3.SS2.p3.22.m22.4.5.2.1.cmml">,</mo><mi id="S3.SS2.p3.22.m22.4.4" xref="S3.SS2.p3.22.m22.4.4.cmml">j</mi></mrow><mo id="S3.SS2.p3.22.m22.4.5.1" xref="S3.SS2.p3.22.m22.4.5.1.cmml">∈</mo><mrow id="S3.SS2.p3.22.m22.4.5.3.2" xref="S3.SS2.p3.22.m22.4.5.3.1.cmml"><mo id="S3.SS2.p3.22.m22.4.5.3.2.1" stretchy="false" xref="S3.SS2.p3.22.m22.4.5.3.1.cmml">[</mo><mn id="S3.SS2.p3.22.m22.1.1" xref="S3.SS2.p3.22.m22.1.1.cmml">1</mn><mo id="S3.SS2.p3.22.m22.4.5.3.2.2" xref="S3.SS2.p3.22.m22.4.5.3.1.cmml">,</mo><mn id="S3.SS2.p3.22.m22.2.2" xref="S3.SS2.p3.22.m22.2.2.cmml">32</mn><mo id="S3.SS2.p3.22.m22.4.5.3.2.3" stretchy="false" xref="S3.SS2.p3.22.m22.4.5.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.22.m22.4b"><apply id="S3.SS2.p3.22.m22.4.5.cmml" xref="S3.SS2.p3.22.m22.4.5"><in id="S3.SS2.p3.22.m22.4.5.1.cmml" xref="S3.SS2.p3.22.m22.4.5.1"></in><list id="S3.SS2.p3.22.m22.4.5.2.1.cmml" xref="S3.SS2.p3.22.m22.4.5.2.2"><ci id="S3.SS2.p3.22.m22.3.3.cmml" xref="S3.SS2.p3.22.m22.3.3">𝑖</ci><ci id="S3.SS2.p3.22.m22.4.4.cmml" xref="S3.SS2.p3.22.m22.4.4">𝑗</ci></list><interval closure="closed" id="S3.SS2.p3.22.m22.4.5.3.1.cmml" xref="S3.SS2.p3.22.m22.4.5.3.2"><cn id="S3.SS2.p3.22.m22.1.1.cmml" type="integer" xref="S3.SS2.p3.22.m22.1.1">1</cn><cn id="S3.SS2.p3.22.m22.2.2.cmml" type="integer" xref="S3.SS2.p3.22.m22.2.2">32</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.22.m22.4c">i,j\in[1,32]</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.22.m22.4d">italic_i , italic_j ∈ [ 1 , 32 ]</annotation></semantics></math>. SVD is applied on <math alttext="{\bm{S}}^{(i,j)}_{K}{\bm{W}}_{K}^{(i,j)}" class="ltx_Math" display="inline" id="S3.SS2.p3.23.m23.4"><semantics id="S3.SS2.p3.23.m23.4a"><mrow id="S3.SS2.p3.23.m23.4.5" xref="S3.SS2.p3.23.m23.4.5.cmml"><msubsup id="S3.SS2.p3.23.m23.4.5.2" xref="S3.SS2.p3.23.m23.4.5.2.cmml"><mi id="S3.SS2.p3.23.m23.4.5.2.2.2" xref="S3.SS2.p3.23.m23.4.5.2.2.2.cmml">𝑺</mi><mi id="S3.SS2.p3.23.m23.4.5.2.3" xref="S3.SS2.p3.23.m23.4.5.2.3.cmml">K</mi><mrow id="S3.SS2.p3.23.m23.2.2.2.4" xref="S3.SS2.p3.23.m23.2.2.2.3.cmml"><mo id="S3.SS2.p3.23.m23.2.2.2.4.1" stretchy="false" xref="S3.SS2.p3.23.m23.2.2.2.3.cmml">(</mo><mi id="S3.SS2.p3.23.m23.1.1.1.1" xref="S3.SS2.p3.23.m23.1.1.1.1.cmml">i</mi><mo id="S3.SS2.p3.23.m23.2.2.2.4.2" xref="S3.SS2.p3.23.m23.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p3.23.m23.2.2.2.2" xref="S3.SS2.p3.23.m23.2.2.2.2.cmml">j</mi><mo id="S3.SS2.p3.23.m23.2.2.2.4.3" stretchy="false" xref="S3.SS2.p3.23.m23.2.2.2.3.cmml">)</mo></mrow></msubsup><mo id="S3.SS2.p3.23.m23.4.5.1" xref="S3.SS2.p3.23.m23.4.5.1.cmml">⁢</mo><msubsup id="S3.SS2.p3.23.m23.4.5.3" xref="S3.SS2.p3.23.m23.4.5.3.cmml"><mi id="S3.SS2.p3.23.m23.4.5.3.2.2" xref="S3.SS2.p3.23.m23.4.5.3.2.2.cmml">𝑾</mi><mi id="S3.SS2.p3.23.m23.4.5.3.2.3" xref="S3.SS2.p3.23.m23.4.5.3.2.3.cmml">K</mi><mrow id="S3.SS2.p3.23.m23.4.4.2.4" xref="S3.SS2.p3.23.m23.4.4.2.3.cmml"><mo id="S3.SS2.p3.23.m23.4.4.2.4.1" stretchy="false" xref="S3.SS2.p3.23.m23.4.4.2.3.cmml">(</mo><mi id="S3.SS2.p3.23.m23.3.3.1.1" xref="S3.SS2.p3.23.m23.3.3.1.1.cmml">i</mi><mo id="S3.SS2.p3.23.m23.4.4.2.4.2" xref="S3.SS2.p3.23.m23.4.4.2.3.cmml">,</mo><mi id="S3.SS2.p3.23.m23.4.4.2.2" xref="S3.SS2.p3.23.m23.4.4.2.2.cmml">j</mi><mo id="S3.SS2.p3.23.m23.4.4.2.4.3" stretchy="false" xref="S3.SS2.p3.23.m23.4.4.2.3.cmml">)</mo></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.23.m23.4b"><apply id="S3.SS2.p3.23.m23.4.5.cmml" xref="S3.SS2.p3.23.m23.4.5"><times id="S3.SS2.p3.23.m23.4.5.1.cmml" xref="S3.SS2.p3.23.m23.4.5.1"></times><apply id="S3.SS2.p3.23.m23.4.5.2.cmml" xref="S3.SS2.p3.23.m23.4.5.2"><csymbol cd="ambiguous" id="S3.SS2.p3.23.m23.4.5.2.1.cmml" xref="S3.SS2.p3.23.m23.4.5.2">subscript</csymbol><apply id="S3.SS2.p3.23.m23.4.5.2.2.cmml" xref="S3.SS2.p3.23.m23.4.5.2"><csymbol cd="ambiguous" id="S3.SS2.p3.23.m23.4.5.2.2.1.cmml" xref="S3.SS2.p3.23.m23.4.5.2">superscript</csymbol><ci id="S3.SS2.p3.23.m23.4.5.2.2.2.cmml" xref="S3.SS2.p3.23.m23.4.5.2.2.2">𝑺</ci><interval closure="open" id="S3.SS2.p3.23.m23.2.2.2.3.cmml" xref="S3.SS2.p3.23.m23.2.2.2.4"><ci id="S3.SS2.p3.23.m23.1.1.1.1.cmml" xref="S3.SS2.p3.23.m23.1.1.1.1">𝑖</ci><ci id="S3.SS2.p3.23.m23.2.2.2.2.cmml" xref="S3.SS2.p3.23.m23.2.2.2.2">𝑗</ci></interval></apply><ci id="S3.SS2.p3.23.m23.4.5.2.3.cmml" xref="S3.SS2.p3.23.m23.4.5.2.3">𝐾</ci></apply><apply id="S3.SS2.p3.23.m23.4.5.3.cmml" xref="S3.SS2.p3.23.m23.4.5.3"><csymbol cd="ambiguous" id="S3.SS2.p3.23.m23.4.5.3.1.cmml" xref="S3.SS2.p3.23.m23.4.5.3">superscript</csymbol><apply id="S3.SS2.p3.23.m23.4.5.3.2.cmml" xref="S3.SS2.p3.23.m23.4.5.3"><csymbol cd="ambiguous" id="S3.SS2.p3.23.m23.4.5.3.2.1.cmml" xref="S3.SS2.p3.23.m23.4.5.3">subscript</csymbol><ci id="S3.SS2.p3.23.m23.4.5.3.2.2.cmml" xref="S3.SS2.p3.23.m23.4.5.3.2.2">𝑾</ci><ci id="S3.SS2.p3.23.m23.4.5.3.2.3.cmml" xref="S3.SS2.p3.23.m23.4.5.3.2.3">𝐾</ci></apply><interval closure="open" id="S3.SS2.p3.23.m23.4.4.2.3.cmml" xref="S3.SS2.p3.23.m23.4.4.2.4"><ci id="S3.SS2.p3.23.m23.3.3.1.1.cmml" xref="S3.SS2.p3.23.m23.3.3.1.1">𝑖</ci><ci id="S3.SS2.p3.23.m23.4.4.2.2.cmml" xref="S3.SS2.p3.23.m23.4.4.2.2">𝑗</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.23.m23.4c">{\bm{S}}^{(i,j)}_{K}{\bm{W}}_{K}^{(i,j)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.23.m23.4d">bold_italic_S start_POSTSUPERSCRIPT ( italic_i , italic_j ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT bold_italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i , italic_j ) end_POSTSUPERSCRIPT</annotation></semantics></math> to remove small singular values to achieve the same compression ratio, where <math alttext="{\bm{S}}^{(i,j)}_{K}" class="ltx_Math" display="inline" id="S3.SS2.p3.24.m24.2"><semantics id="S3.SS2.p3.24.m24.2a"><msubsup id="S3.SS2.p3.24.m24.2.3" xref="S3.SS2.p3.24.m24.2.3.cmml"><mi id="S3.SS2.p3.24.m24.2.3.2.2" xref="S3.SS2.p3.24.m24.2.3.2.2.cmml">𝑺</mi><mi id="S3.SS2.p3.24.m24.2.3.3" xref="S3.SS2.p3.24.m24.2.3.3.cmml">K</mi><mrow id="S3.SS2.p3.24.m24.2.2.2.4" xref="S3.SS2.p3.24.m24.2.2.2.3.cmml"><mo id="S3.SS2.p3.24.m24.2.2.2.4.1" stretchy="false" xref="S3.SS2.p3.24.m24.2.2.2.3.cmml">(</mo><mi id="S3.SS2.p3.24.m24.1.1.1.1" xref="S3.SS2.p3.24.m24.1.1.1.1.cmml">i</mi><mo id="S3.SS2.p3.24.m24.2.2.2.4.2" xref="S3.SS2.p3.24.m24.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p3.24.m24.2.2.2.2" xref="S3.SS2.p3.24.m24.2.2.2.2.cmml">j</mi><mo id="S3.SS2.p3.24.m24.2.2.2.4.3" stretchy="false" xref="S3.SS2.p3.24.m24.2.2.2.3.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.24.m24.2b"><apply id="S3.SS2.p3.24.m24.2.3.cmml" xref="S3.SS2.p3.24.m24.2.3"><csymbol cd="ambiguous" id="S3.SS2.p3.24.m24.2.3.1.cmml" xref="S3.SS2.p3.24.m24.2.3">subscript</csymbol><apply id="S3.SS2.p3.24.m24.2.3.2.cmml" xref="S3.SS2.p3.24.m24.2.3"><csymbol cd="ambiguous" id="S3.SS2.p3.24.m24.2.3.2.1.cmml" xref="S3.SS2.p3.24.m24.2.3">superscript</csymbol><ci id="S3.SS2.p3.24.m24.2.3.2.2.cmml" xref="S3.SS2.p3.24.m24.2.3.2.2">𝑺</ci><interval closure="open" id="S3.SS2.p3.24.m24.2.2.2.3.cmml" xref="S3.SS2.p3.24.m24.2.2.2.4"><ci id="S3.SS2.p3.24.m24.1.1.1.1.cmml" xref="S3.SS2.p3.24.m24.1.1.1.1">𝑖</ci><ci id="S3.SS2.p3.24.m24.2.2.2.2.cmml" xref="S3.SS2.p3.24.m24.2.2.2.2">𝑗</ci></interval></apply><ci id="S3.SS2.p3.24.m24.2.3.3.cmml" xref="S3.SS2.p3.24.m24.2.3.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.24.m24.2c">{\bm{S}}^{(i,j)}_{K}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.24.m24.2d">bold_italic_S start_POSTSUPERSCRIPT ( italic_i , italic_j ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math> is the corresponding S matrix for <math alttext="{\bm{W}}_{K}^{(i,j)}" class="ltx_Math" display="inline" id="S3.SS2.p3.25.m25.2"><semantics id="S3.SS2.p3.25.m25.2a"><msubsup id="S3.SS2.p3.25.m25.2.3" xref="S3.SS2.p3.25.m25.2.3.cmml"><mi id="S3.SS2.p3.25.m25.2.3.2.2" xref="S3.SS2.p3.25.m25.2.3.2.2.cmml">𝑾</mi><mi id="S3.SS2.p3.25.m25.2.3.2.3" xref="S3.SS2.p3.25.m25.2.3.2.3.cmml">K</mi><mrow id="S3.SS2.p3.25.m25.2.2.2.4" xref="S3.SS2.p3.25.m25.2.2.2.3.cmml"><mo id="S3.SS2.p3.25.m25.2.2.2.4.1" stretchy="false" xref="S3.SS2.p3.25.m25.2.2.2.3.cmml">(</mo><mi id="S3.SS2.p3.25.m25.1.1.1.1" xref="S3.SS2.p3.25.m25.1.1.1.1.cmml">i</mi><mo id="S3.SS2.p3.25.m25.2.2.2.4.2" xref="S3.SS2.p3.25.m25.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p3.25.m25.2.2.2.2" xref="S3.SS2.p3.25.m25.2.2.2.2.cmml">j</mi><mo id="S3.SS2.p3.25.m25.2.2.2.4.3" stretchy="false" xref="S3.SS2.p3.25.m25.2.2.2.3.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.25.m25.2b"><apply id="S3.SS2.p3.25.m25.2.3.cmml" xref="S3.SS2.p3.25.m25.2.3"><csymbol cd="ambiguous" id="S3.SS2.p3.25.m25.2.3.1.cmml" xref="S3.SS2.p3.25.m25.2.3">superscript</csymbol><apply id="S3.SS2.p3.25.m25.2.3.2.cmml" xref="S3.SS2.p3.25.m25.2.3"><csymbol cd="ambiguous" id="S3.SS2.p3.25.m25.2.3.2.1.cmml" xref="S3.SS2.p3.25.m25.2.3">subscript</csymbol><ci id="S3.SS2.p3.25.m25.2.3.2.2.cmml" xref="S3.SS2.p3.25.m25.2.3.2.2">𝑾</ci><ci id="S3.SS2.p3.25.m25.2.3.2.3.cmml" xref="S3.SS2.p3.25.m25.2.3.2.3">𝐾</ci></apply><interval closure="open" id="S3.SS2.p3.25.m25.2.2.2.3.cmml" xref="S3.SS2.p3.25.m25.2.2.2.4"><ci id="S3.SS2.p3.25.m25.1.1.1.1.cmml" xref="S3.SS2.p3.25.m25.1.1.1.1">𝑖</ci><ci id="S3.SS2.p3.25.m25.2.2.2.2.cmml" xref="S3.SS2.p3.25.m25.2.2.2.2">𝑗</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.25.m25.2c">{\bm{W}}_{K}^{(i,j)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.25.m25.2d">bold_italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i , italic_j ) end_POSTSUPERSCRIPT</annotation></semantics></math>.
Afterwards,
we evaluate the incurred Frobenius loss of basis sharing across two layers.
Similarly, we repeat the process above for <math alttext="{\bm{W}}_{O}" class="ltx_Math" display="inline" id="S3.SS2.p3.26.m26.1"><semantics id="S3.SS2.p3.26.m26.1a"><msub id="S3.SS2.p3.26.m26.1.1" xref="S3.SS2.p3.26.m26.1.1.cmml"><mi id="S3.SS2.p3.26.m26.1.1.2" xref="S3.SS2.p3.26.m26.1.1.2.cmml">𝑾</mi><mi id="S3.SS2.p3.26.m26.1.1.3" xref="S3.SS2.p3.26.m26.1.1.3.cmml">O</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.26.m26.1b"><apply id="S3.SS2.p3.26.m26.1.1.cmml" xref="S3.SS2.p3.26.m26.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.26.m26.1.1.1.cmml" xref="S3.SS2.p3.26.m26.1.1">subscript</csymbol><ci id="S3.SS2.p3.26.m26.1.1.2.cmml" xref="S3.SS2.p3.26.m26.1.1.2">𝑾</ci><ci id="S3.SS2.p3.26.m26.1.1.3.cmml" xref="S3.SS2.p3.26.m26.1.1.3">𝑂</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.26.m26.1c">{\bm{W}}_{O}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.26.m26.1d">bold_italic_W start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT</annotation></semantics></math>.
The results are illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#S3.F4" title="Figure 4 ‣ 3.2 Selection of Weight Matrices in LLMs for Cross-Layer Parameter Sharing ‣ 3 Methodology ‣ Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_tag">4</span></a>, where the number/color in a block represents the resulting Frobenius loss if a basis matrix is shared between two layers and the numbers in the diagonal direction are obtained by applying SVD to the scaled weight matrix of a layer directly.</p>
</div>
<figure class="ltx_figure" id="S3.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="544" id="S3.F4.g1" src="x4.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Frobenius loss incurred by basis sharing across any two layers. The number/color in a block represents the resulting Frobenius loss if a basis matrix is shared by
two layers and the numbers in the diagonal direction are obtained by applying SVD to the scaled
weight matrix of a layer directly. (a) Frobenius loss incurred by basis sharing across two layers for <math alttext="{\bm{W}}_{K}" class="ltx_Math" display="inline" id="S3.F4.3.m1.1"><semantics id="S3.F4.3.m1.1b"><msub id="S3.F4.3.m1.1.1" xref="S3.F4.3.m1.1.1.cmml"><mi id="S3.F4.3.m1.1.1.2" xref="S3.F4.3.m1.1.1.2.cmml">𝑾</mi><mi id="S3.F4.3.m1.1.1.3" xref="S3.F4.3.m1.1.1.3.cmml">K</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F4.3.m1.1c"><apply id="S3.F4.3.m1.1.1.cmml" xref="S3.F4.3.m1.1.1"><csymbol cd="ambiguous" id="S3.F4.3.m1.1.1.1.cmml" xref="S3.F4.3.m1.1.1">subscript</csymbol><ci id="S3.F4.3.m1.1.1.2.cmml" xref="S3.F4.3.m1.1.1.2">𝑾</ci><ci id="S3.F4.3.m1.1.1.3.cmml" xref="S3.F4.3.m1.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.3.m1.1d">{\bm{W}}_{K}</annotation><annotation encoding="application/x-llamapun" id="S3.F4.3.m1.1e">bold_italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math> in LLaMA2-7B. (b) Frobenius loss incurred by basis sharing across two layers for <math alttext="{\bm{W}}_{O}" class="ltx_Math" display="inline" id="S3.F4.4.m2.1"><semantics id="S3.F4.4.m2.1b"><msub id="S3.F4.4.m2.1.1" xref="S3.F4.4.m2.1.1.cmml"><mi id="S3.F4.4.m2.1.1.2" xref="S3.F4.4.m2.1.1.2.cmml">𝑾</mi><mi id="S3.F4.4.m2.1.1.3" xref="S3.F4.4.m2.1.1.3.cmml">O</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F4.4.m2.1c"><apply id="S3.F4.4.m2.1.1.cmml" xref="S3.F4.4.m2.1.1"><csymbol cd="ambiguous" id="S3.F4.4.m2.1.1.1.cmml" xref="S3.F4.4.m2.1.1">subscript</csymbol><ci id="S3.F4.4.m2.1.1.2.cmml" xref="S3.F4.4.m2.1.1.2">𝑾</ci><ci id="S3.F4.4.m2.1.1.3.cmml" xref="S3.F4.4.m2.1.1.3">𝑂</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.4.m2.1d">{\bm{W}}_{O}</annotation><annotation encoding="application/x-llamapun" id="S3.F4.4.m2.1e">bold_italic_W start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT</annotation></semantics></math> in LLaMA2-7B.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S3.SS2.p4">
<p class="ltx_p" id="S3.SS2.p4.16">Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#S3.F4" title="Figure 4 ‣ 3.2 Selection of Weight Matrices in LLMs for Cross-Layer Parameter Sharing ‣ 3 Methodology ‣ Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_tag">4</span></a>
compares the results of basis sharing for <math alttext="{\bm{W}}_{K}" class="ltx_Math" display="inline" id="S3.SS2.p4.1.m1.1"><semantics id="S3.SS2.p4.1.m1.1a"><msub id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml"><mi id="S3.SS2.p4.1.m1.1.1.2" xref="S3.SS2.p4.1.m1.1.1.2.cmml">𝑾</mi><mi id="S3.SS2.p4.1.m1.1.1.3" xref="S3.SS2.p4.1.m1.1.1.3.cmml">K</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b"><apply id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p4.1.m1.1.1.2.cmml" xref="S3.SS2.p4.1.m1.1.1.2">𝑾</ci><ci id="S3.SS2.p4.1.m1.1.1.3.cmml" xref="S3.SS2.p4.1.m1.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">{\bm{W}}_{K}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.1.m1.1d">bold_italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="{\bm{W}}_{O}" class="ltx_Math" display="inline" id="S3.SS2.p4.2.m2.1"><semantics id="S3.SS2.p4.2.m2.1a"><msub id="S3.SS2.p4.2.m2.1.1" xref="S3.SS2.p4.2.m2.1.1.cmml"><mi id="S3.SS2.p4.2.m2.1.1.2" xref="S3.SS2.p4.2.m2.1.1.2.cmml">𝑾</mi><mi id="S3.SS2.p4.2.m2.1.1.3" xref="S3.SS2.p4.2.m2.1.1.3.cmml">O</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.1b"><apply id="S3.SS2.p4.2.m2.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.2.m2.1.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p4.2.m2.1.1.2.cmml" xref="S3.SS2.p4.2.m2.1.1.2">𝑾</ci><ci id="S3.SS2.p4.2.m2.1.1.3.cmml" xref="S3.SS2.p4.2.m2.1.1.3">𝑂</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.1c">{\bm{W}}_{O}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.2.m2.1d">bold_italic_W start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT</annotation></semantics></math>.
Basis sharing across two layers for <math alttext="{\bm{W}}_{K}" class="ltx_Math" display="inline" id="S3.SS2.p4.3.m3.1"><semantics id="S3.SS2.p4.3.m3.1a"><msub id="S3.SS2.p4.3.m3.1.1" xref="S3.SS2.p4.3.m3.1.1.cmml"><mi id="S3.SS2.p4.3.m3.1.1.2" xref="S3.SS2.p4.3.m3.1.1.2.cmml">𝑾</mi><mi id="S3.SS2.p4.3.m3.1.1.3" xref="S3.SS2.p4.3.m3.1.1.3.cmml">K</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.3.m3.1b"><apply id="S3.SS2.p4.3.m3.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.3.m3.1.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p4.3.m3.1.1.2.cmml" xref="S3.SS2.p4.3.m3.1.1.2">𝑾</ci><ci id="S3.SS2.p4.3.m3.1.1.3.cmml" xref="S3.SS2.p4.3.m3.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.3.m3.1c">{\bm{W}}_{K}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.3.m3.1d">bold_italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math> can reduce the Frobenius loss. For example,
when SVD is applied on <math alttext="{\bm{S}}_{K}{\bm{W}}_{K}" class="ltx_Math" display="inline" id="S3.SS2.p4.4.m4.1"><semantics id="S3.SS2.p4.4.m4.1a"><mrow id="S3.SS2.p4.4.m4.1.1" xref="S3.SS2.p4.4.m4.1.1.cmml"><msub id="S3.SS2.p4.4.m4.1.1.2" xref="S3.SS2.p4.4.m4.1.1.2.cmml"><mi id="S3.SS2.p4.4.m4.1.1.2.2" xref="S3.SS2.p4.4.m4.1.1.2.2.cmml">𝑺</mi><mi id="S3.SS2.p4.4.m4.1.1.2.3" xref="S3.SS2.p4.4.m4.1.1.2.3.cmml">K</mi></msub><mo id="S3.SS2.p4.4.m4.1.1.1" xref="S3.SS2.p4.4.m4.1.1.1.cmml">⁢</mo><msub id="S3.SS2.p4.4.m4.1.1.3" xref="S3.SS2.p4.4.m4.1.1.3.cmml"><mi id="S3.SS2.p4.4.m4.1.1.3.2" xref="S3.SS2.p4.4.m4.1.1.3.2.cmml">𝑾</mi><mi id="S3.SS2.p4.4.m4.1.1.3.3" xref="S3.SS2.p4.4.m4.1.1.3.3.cmml">K</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.4.m4.1b"><apply id="S3.SS2.p4.4.m4.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1"><times id="S3.SS2.p4.4.m4.1.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1.1"></times><apply id="S3.SS2.p4.4.m4.1.1.2.cmml" xref="S3.SS2.p4.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p4.4.m4.1.1.2.1.cmml" xref="S3.SS2.p4.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS2.p4.4.m4.1.1.2.2.cmml" xref="S3.SS2.p4.4.m4.1.1.2.2">𝑺</ci><ci id="S3.SS2.p4.4.m4.1.1.2.3.cmml" xref="S3.SS2.p4.4.m4.1.1.2.3">𝐾</ci></apply><apply id="S3.SS2.p4.4.m4.1.1.3.cmml" xref="S3.SS2.p4.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p4.4.m4.1.1.3.1.cmml" xref="S3.SS2.p4.4.m4.1.1.3">subscript</csymbol><ci id="S3.SS2.p4.4.m4.1.1.3.2.cmml" xref="S3.SS2.p4.4.m4.1.1.3.2">𝑾</ci><ci id="S3.SS2.p4.4.m4.1.1.3.3.cmml" xref="S3.SS2.p4.4.m4.1.1.3.3">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.4.m4.1c">{\bm{S}}_{K}{\bm{W}}_{K}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.4.m4.1d">bold_italic_S start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT bold_italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math> for the <math alttext="9^{th}" class="ltx_Math" display="inline" id="S3.SS2.p4.5.m5.1"><semantics id="S3.SS2.p4.5.m5.1a"><msup id="S3.SS2.p4.5.m5.1.1" xref="S3.SS2.p4.5.m5.1.1.cmml"><mn id="S3.SS2.p4.5.m5.1.1.2" xref="S3.SS2.p4.5.m5.1.1.2.cmml">9</mn><mrow id="S3.SS2.p4.5.m5.1.1.3" xref="S3.SS2.p4.5.m5.1.1.3.cmml"><mi id="S3.SS2.p4.5.m5.1.1.3.2" xref="S3.SS2.p4.5.m5.1.1.3.2.cmml">t</mi><mo id="S3.SS2.p4.5.m5.1.1.3.1" xref="S3.SS2.p4.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p4.5.m5.1.1.3.3" xref="S3.SS2.p4.5.m5.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.5.m5.1b"><apply id="S3.SS2.p4.5.m5.1.1.cmml" xref="S3.SS2.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.5.m5.1.1.1.cmml" xref="S3.SS2.p4.5.m5.1.1">superscript</csymbol><cn id="S3.SS2.p4.5.m5.1.1.2.cmml" type="integer" xref="S3.SS2.p4.5.m5.1.1.2">9</cn><apply id="S3.SS2.p4.5.m5.1.1.3.cmml" xref="S3.SS2.p4.5.m5.1.1.3"><times id="S3.SS2.p4.5.m5.1.1.3.1.cmml" xref="S3.SS2.p4.5.m5.1.1.3.1"></times><ci id="S3.SS2.p4.5.m5.1.1.3.2.cmml" xref="S3.SS2.p4.5.m5.1.1.3.2">𝑡</ci><ci id="S3.SS2.p4.5.m5.1.1.3.3.cmml" xref="S3.SS2.p4.5.m5.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.5.m5.1c">9^{th}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.5.m5.1d">9 start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="10^{th}" class="ltx_Math" display="inline" id="S3.SS2.p4.6.m6.1"><semantics id="S3.SS2.p4.6.m6.1a"><msup id="S3.SS2.p4.6.m6.1.1" xref="S3.SS2.p4.6.m6.1.1.cmml"><mn id="S3.SS2.p4.6.m6.1.1.2" xref="S3.SS2.p4.6.m6.1.1.2.cmml">10</mn><mrow id="S3.SS2.p4.6.m6.1.1.3" xref="S3.SS2.p4.6.m6.1.1.3.cmml"><mi id="S3.SS2.p4.6.m6.1.1.3.2" xref="S3.SS2.p4.6.m6.1.1.3.2.cmml">t</mi><mo id="S3.SS2.p4.6.m6.1.1.3.1" xref="S3.SS2.p4.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p4.6.m6.1.1.3.3" xref="S3.SS2.p4.6.m6.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.6.m6.1b"><apply id="S3.SS2.p4.6.m6.1.1.cmml" xref="S3.SS2.p4.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.6.m6.1.1.1.cmml" xref="S3.SS2.p4.6.m6.1.1">superscript</csymbol><cn id="S3.SS2.p4.6.m6.1.1.2.cmml" type="integer" xref="S3.SS2.p4.6.m6.1.1.2">10</cn><apply id="S3.SS2.p4.6.m6.1.1.3.cmml" xref="S3.SS2.p4.6.m6.1.1.3"><times id="S3.SS2.p4.6.m6.1.1.3.1.cmml" xref="S3.SS2.p4.6.m6.1.1.3.1"></times><ci id="S3.SS2.p4.6.m6.1.1.3.2.cmml" xref="S3.SS2.p4.6.m6.1.1.3.2">𝑡</ci><ci id="S3.SS2.p4.6.m6.1.1.3.3.cmml" xref="S3.SS2.p4.6.m6.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.6.m6.1c">10^{th}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.6.m6.1d">10 start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> layers separately, the resulting Frobenius loss is evaluated as <math alttext="33508.2+33174.7=66682.9" class="ltx_Math" display="inline" id="S3.SS2.p4.7.m7.1"><semantics id="S3.SS2.p4.7.m7.1a"><mrow id="S3.SS2.p4.7.m7.1.1" xref="S3.SS2.p4.7.m7.1.1.cmml"><mrow id="S3.SS2.p4.7.m7.1.1.2" xref="S3.SS2.p4.7.m7.1.1.2.cmml"><mn id="S3.SS2.p4.7.m7.1.1.2.2" xref="S3.SS2.p4.7.m7.1.1.2.2.cmml">33508.2</mn><mo id="S3.SS2.p4.7.m7.1.1.2.1" xref="S3.SS2.p4.7.m7.1.1.2.1.cmml">+</mo><mn id="S3.SS2.p4.7.m7.1.1.2.3" xref="S3.SS2.p4.7.m7.1.1.2.3.cmml">33174.7</mn></mrow><mo id="S3.SS2.p4.7.m7.1.1.1" xref="S3.SS2.p4.7.m7.1.1.1.cmml">=</mo><mn id="S3.SS2.p4.7.m7.1.1.3" xref="S3.SS2.p4.7.m7.1.1.3.cmml">66682.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.7.m7.1b"><apply id="S3.SS2.p4.7.m7.1.1.cmml" xref="S3.SS2.p4.7.m7.1.1"><eq id="S3.SS2.p4.7.m7.1.1.1.cmml" xref="S3.SS2.p4.7.m7.1.1.1"></eq><apply id="S3.SS2.p4.7.m7.1.1.2.cmml" xref="S3.SS2.p4.7.m7.1.1.2"><plus id="S3.SS2.p4.7.m7.1.1.2.1.cmml" xref="S3.SS2.p4.7.m7.1.1.2.1"></plus><cn id="S3.SS2.p4.7.m7.1.1.2.2.cmml" type="float" xref="S3.SS2.p4.7.m7.1.1.2.2">33508.2</cn><cn id="S3.SS2.p4.7.m7.1.1.2.3.cmml" type="float" xref="S3.SS2.p4.7.m7.1.1.2.3">33174.7</cn></apply><cn id="S3.SS2.p4.7.m7.1.1.3.cmml" type="float" xref="S3.SS2.p4.7.m7.1.1.3">66682.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.7.m7.1c">33508.2+33174.7=66682.9</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.7.m7.1d">33508.2 + 33174.7 = 66682.9</annotation></semantics></math>. When the <math alttext="9^{th}" class="ltx_Math" display="inline" id="S3.SS2.p4.8.m8.1"><semantics id="S3.SS2.p4.8.m8.1a"><msup id="S3.SS2.p4.8.m8.1.1" xref="S3.SS2.p4.8.m8.1.1.cmml"><mn id="S3.SS2.p4.8.m8.1.1.2" xref="S3.SS2.p4.8.m8.1.1.2.cmml">9</mn><mrow id="S3.SS2.p4.8.m8.1.1.3" xref="S3.SS2.p4.8.m8.1.1.3.cmml"><mi id="S3.SS2.p4.8.m8.1.1.3.2" xref="S3.SS2.p4.8.m8.1.1.3.2.cmml">t</mi><mo id="S3.SS2.p4.8.m8.1.1.3.1" xref="S3.SS2.p4.8.m8.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p4.8.m8.1.1.3.3" xref="S3.SS2.p4.8.m8.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.8.m8.1b"><apply id="S3.SS2.p4.8.m8.1.1.cmml" xref="S3.SS2.p4.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.8.m8.1.1.1.cmml" xref="S3.SS2.p4.8.m8.1.1">superscript</csymbol><cn id="S3.SS2.p4.8.m8.1.1.2.cmml" type="integer" xref="S3.SS2.p4.8.m8.1.1.2">9</cn><apply id="S3.SS2.p4.8.m8.1.1.3.cmml" xref="S3.SS2.p4.8.m8.1.1.3"><times id="S3.SS2.p4.8.m8.1.1.3.1.cmml" xref="S3.SS2.p4.8.m8.1.1.3.1"></times><ci id="S3.SS2.p4.8.m8.1.1.3.2.cmml" xref="S3.SS2.p4.8.m8.1.1.3.2">𝑡</ci><ci id="S3.SS2.p4.8.m8.1.1.3.3.cmml" xref="S3.SS2.p4.8.m8.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.8.m8.1c">9^{th}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.8.m8.1d">9 start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="10^{th}" class="ltx_Math" display="inline" id="S3.SS2.p4.9.m9.1"><semantics id="S3.SS2.p4.9.m9.1a"><msup id="S3.SS2.p4.9.m9.1.1" xref="S3.SS2.p4.9.m9.1.1.cmml"><mn id="S3.SS2.p4.9.m9.1.1.2" xref="S3.SS2.p4.9.m9.1.1.2.cmml">10</mn><mrow id="S3.SS2.p4.9.m9.1.1.3" xref="S3.SS2.p4.9.m9.1.1.3.cmml"><mi id="S3.SS2.p4.9.m9.1.1.3.2" xref="S3.SS2.p4.9.m9.1.1.3.2.cmml">t</mi><mo id="S3.SS2.p4.9.m9.1.1.3.1" xref="S3.SS2.p4.9.m9.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p4.9.m9.1.1.3.3" xref="S3.SS2.p4.9.m9.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.9.m9.1b"><apply id="S3.SS2.p4.9.m9.1.1.cmml" xref="S3.SS2.p4.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.9.m9.1.1.1.cmml" xref="S3.SS2.p4.9.m9.1.1">superscript</csymbol><cn id="S3.SS2.p4.9.m9.1.1.2.cmml" type="integer" xref="S3.SS2.p4.9.m9.1.1.2">10</cn><apply id="S3.SS2.p4.9.m9.1.1.3.cmml" xref="S3.SS2.p4.9.m9.1.1.3"><times id="S3.SS2.p4.9.m9.1.1.3.1.cmml" xref="S3.SS2.p4.9.m9.1.1.3.1"></times><ci id="S3.SS2.p4.9.m9.1.1.3.2.cmml" xref="S3.SS2.p4.9.m9.1.1.3.2">𝑡</ci><ci id="S3.SS2.p4.9.m9.1.1.3.3.cmml" xref="S3.SS2.p4.9.m9.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.9.m9.1c">10^{th}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.9.m9.1d">10 start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> layers share a common basis matrix, the Frobenius loss resulting from compression becomes smaller, i.e, <math alttext="61817.3&lt;66682.9" class="ltx_Math" display="inline" id="S3.SS2.p4.10.m10.1"><semantics id="S3.SS2.p4.10.m10.1a"><mrow id="S3.SS2.p4.10.m10.1.1" xref="S3.SS2.p4.10.m10.1.1.cmml"><mn id="S3.SS2.p4.10.m10.1.1.2" xref="S3.SS2.p4.10.m10.1.1.2.cmml">61817.3</mn><mo id="S3.SS2.p4.10.m10.1.1.1" xref="S3.SS2.p4.10.m10.1.1.1.cmml">&lt;</mo><mn id="S3.SS2.p4.10.m10.1.1.3" xref="S3.SS2.p4.10.m10.1.1.3.cmml">66682.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.10.m10.1b"><apply id="S3.SS2.p4.10.m10.1.1.cmml" xref="S3.SS2.p4.10.m10.1.1"><lt id="S3.SS2.p4.10.m10.1.1.1.cmml" xref="S3.SS2.p4.10.m10.1.1.1"></lt><cn id="S3.SS2.p4.10.m10.1.1.2.cmml" type="float" xref="S3.SS2.p4.10.m10.1.1.2">61817.3</cn><cn id="S3.SS2.p4.10.m10.1.1.3.cmml" type="float" xref="S3.SS2.p4.10.m10.1.1.3">66682.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.10.m10.1c">61817.3&lt;66682.9</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.10.m10.1d">61817.3 &lt; 66682.9</annotation></semantics></math>. This indicates that allowing parameter sharing across two layers for <math alttext="{\bm{W}}_{K}" class="ltx_Math" display="inline" id="S3.SS2.p4.11.m11.1"><semantics id="S3.SS2.p4.11.m11.1a"><msub id="S3.SS2.p4.11.m11.1.1" xref="S3.SS2.p4.11.m11.1.1.cmml"><mi id="S3.SS2.p4.11.m11.1.1.2" xref="S3.SS2.p4.11.m11.1.1.2.cmml">𝑾</mi><mi id="S3.SS2.p4.11.m11.1.1.3" xref="S3.SS2.p4.11.m11.1.1.3.cmml">K</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.11.m11.1b"><apply id="S3.SS2.p4.11.m11.1.1.cmml" xref="S3.SS2.p4.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.11.m11.1.1.1.cmml" xref="S3.SS2.p4.11.m11.1.1">subscript</csymbol><ci id="S3.SS2.p4.11.m11.1.1.2.cmml" xref="S3.SS2.p4.11.m11.1.1.2">𝑾</ci><ci id="S3.SS2.p4.11.m11.1.1.3.cmml" xref="S3.SS2.p4.11.m11.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.11.m11.1c">{\bm{W}}_{K}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.11.m11.1d">bold_italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math> can enhance computation accuracy. This trend can be seen in <math alttext="{\bm{W}}_{K}" class="ltx_Math" display="inline" id="S3.SS2.p4.12.m12.1"><semantics id="S3.SS2.p4.12.m12.1a"><msub id="S3.SS2.p4.12.m12.1.1" xref="S3.SS2.p4.12.m12.1.1.cmml"><mi id="S3.SS2.p4.12.m12.1.1.2" xref="S3.SS2.p4.12.m12.1.1.2.cmml">𝑾</mi><mi id="S3.SS2.p4.12.m12.1.1.3" xref="S3.SS2.p4.12.m12.1.1.3.cmml">K</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.12.m12.1b"><apply id="S3.SS2.p4.12.m12.1.1.cmml" xref="S3.SS2.p4.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.12.m12.1.1.1.cmml" xref="S3.SS2.p4.12.m12.1.1">subscript</csymbol><ci id="S3.SS2.p4.12.m12.1.1.2.cmml" xref="S3.SS2.p4.12.m12.1.1.2">𝑾</ci><ci id="S3.SS2.p4.12.m12.1.1.3.cmml" xref="S3.SS2.p4.12.m12.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.12.m12.1c">{\bm{W}}_{K}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.12.m12.1d">bold_italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="{\bm{W}}_{Q}" class="ltx_Math" display="inline" id="S3.SS2.p4.13.m13.1"><semantics id="S3.SS2.p4.13.m13.1a"><msub id="S3.SS2.p4.13.m13.1.1" xref="S3.SS2.p4.13.m13.1.1.cmml"><mi id="S3.SS2.p4.13.m13.1.1.2" xref="S3.SS2.p4.13.m13.1.1.2.cmml">𝑾</mi><mi id="S3.SS2.p4.13.m13.1.1.3" xref="S3.SS2.p4.13.m13.1.1.3.cmml">Q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.13.m13.1b"><apply id="S3.SS2.p4.13.m13.1.1.cmml" xref="S3.SS2.p4.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.13.m13.1.1.1.cmml" xref="S3.SS2.p4.13.m13.1.1">subscript</csymbol><ci id="S3.SS2.p4.13.m13.1.1.2.cmml" xref="S3.SS2.p4.13.m13.1.1.2">𝑾</ci><ci id="S3.SS2.p4.13.m13.1.1.3.cmml" xref="S3.SS2.p4.13.m13.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.13.m13.1c">{\bm{W}}_{Q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.13.m13.1d">bold_italic_W start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="{\bm{W}}_{V}" class="ltx_Math" display="inline" id="S3.SS2.p4.14.m14.1"><semantics id="S3.SS2.p4.14.m14.1a"><msub id="S3.SS2.p4.14.m14.1.1" xref="S3.SS2.p4.14.m14.1.1.cmml"><mi id="S3.SS2.p4.14.m14.1.1.2" xref="S3.SS2.p4.14.m14.1.1.2.cmml">𝑾</mi><mi id="S3.SS2.p4.14.m14.1.1.3" xref="S3.SS2.p4.14.m14.1.1.3.cmml">V</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.14.m14.1b"><apply id="S3.SS2.p4.14.m14.1.1.cmml" xref="S3.SS2.p4.14.m14.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.14.m14.1.1.1.cmml" xref="S3.SS2.p4.14.m14.1.1">subscript</csymbol><ci id="S3.SS2.p4.14.m14.1.1.2.cmml" xref="S3.SS2.p4.14.m14.1.1.2">𝑾</ci><ci id="S3.SS2.p4.14.m14.1.1.3.cmml" xref="S3.SS2.p4.14.m14.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.14.m14.1c">{\bm{W}}_{V}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.14.m14.1d">bold_italic_W start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="{\bm{W}}_{Up}" class="ltx_Math" display="inline" id="S3.SS2.p4.15.m15.1"><semantics id="S3.SS2.p4.15.m15.1a"><msub id="S3.SS2.p4.15.m15.1.1" xref="S3.SS2.p4.15.m15.1.1.cmml"><mi id="S3.SS2.p4.15.m15.1.1.2" xref="S3.SS2.p4.15.m15.1.1.2.cmml">𝑾</mi><mrow id="S3.SS2.p4.15.m15.1.1.3" xref="S3.SS2.p4.15.m15.1.1.3.cmml"><mi id="S3.SS2.p4.15.m15.1.1.3.2" xref="S3.SS2.p4.15.m15.1.1.3.2.cmml">U</mi><mo id="S3.SS2.p4.15.m15.1.1.3.1" xref="S3.SS2.p4.15.m15.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p4.15.m15.1.1.3.3" xref="S3.SS2.p4.15.m15.1.1.3.3.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.15.m15.1b"><apply id="S3.SS2.p4.15.m15.1.1.cmml" xref="S3.SS2.p4.15.m15.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.15.m15.1.1.1.cmml" xref="S3.SS2.p4.15.m15.1.1">subscript</csymbol><ci id="S3.SS2.p4.15.m15.1.1.2.cmml" xref="S3.SS2.p4.15.m15.1.1.2">𝑾</ci><apply id="S3.SS2.p4.15.m15.1.1.3.cmml" xref="S3.SS2.p4.15.m15.1.1.3"><times id="S3.SS2.p4.15.m15.1.1.3.1.cmml" xref="S3.SS2.p4.15.m15.1.1.3.1"></times><ci id="S3.SS2.p4.15.m15.1.1.3.2.cmml" xref="S3.SS2.p4.15.m15.1.1.3.2">𝑈</ci><ci id="S3.SS2.p4.15.m15.1.1.3.3.cmml" xref="S3.SS2.p4.15.m15.1.1.3.3">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.15.m15.1c">{\bm{W}}_{Up}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.15.m15.1d">bold_italic_W start_POSTSUBSCRIPT italic_U italic_p end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="{\bm{W}}_{Gate}" class="ltx_Math" display="inline" id="S3.SS2.p4.16.m16.1"><semantics id="S3.SS2.p4.16.m16.1a"><msub id="S3.SS2.p4.16.m16.1.1" xref="S3.SS2.p4.16.m16.1.1.cmml"><mi id="S3.SS2.p4.16.m16.1.1.2" xref="S3.SS2.p4.16.m16.1.1.2.cmml">𝑾</mi><mrow id="S3.SS2.p4.16.m16.1.1.3" xref="S3.SS2.p4.16.m16.1.1.3.cmml"><mi id="S3.SS2.p4.16.m16.1.1.3.2" xref="S3.SS2.p4.16.m16.1.1.3.2.cmml">G</mi><mo id="S3.SS2.p4.16.m16.1.1.3.1" xref="S3.SS2.p4.16.m16.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p4.16.m16.1.1.3.3" xref="S3.SS2.p4.16.m16.1.1.3.3.cmml">a</mi><mo id="S3.SS2.p4.16.m16.1.1.3.1a" xref="S3.SS2.p4.16.m16.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p4.16.m16.1.1.3.4" xref="S3.SS2.p4.16.m16.1.1.3.4.cmml">t</mi><mo id="S3.SS2.p4.16.m16.1.1.3.1b" xref="S3.SS2.p4.16.m16.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p4.16.m16.1.1.3.5" xref="S3.SS2.p4.16.m16.1.1.3.5.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.16.m16.1b"><apply id="S3.SS2.p4.16.m16.1.1.cmml" xref="S3.SS2.p4.16.m16.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.16.m16.1.1.1.cmml" xref="S3.SS2.p4.16.m16.1.1">subscript</csymbol><ci id="S3.SS2.p4.16.m16.1.1.2.cmml" xref="S3.SS2.p4.16.m16.1.1.2">𝑾</ci><apply id="S3.SS2.p4.16.m16.1.1.3.cmml" xref="S3.SS2.p4.16.m16.1.1.3"><times id="S3.SS2.p4.16.m16.1.1.3.1.cmml" xref="S3.SS2.p4.16.m16.1.1.3.1"></times><ci id="S3.SS2.p4.16.m16.1.1.3.2.cmml" xref="S3.SS2.p4.16.m16.1.1.3.2">𝐺</ci><ci id="S3.SS2.p4.16.m16.1.1.3.3.cmml" xref="S3.SS2.p4.16.m16.1.1.3.3">𝑎</ci><ci id="S3.SS2.p4.16.m16.1.1.3.4.cmml" xref="S3.SS2.p4.16.m16.1.1.3.4">𝑡</ci><ci id="S3.SS2.p4.16.m16.1.1.3.5.cmml" xref="S3.SS2.p4.16.m16.1.1.3.5">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.16.m16.1c">{\bm{W}}_{Gate}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.16.m16.1d">bold_italic_W start_POSTSUBSCRIPT italic_G italic_a italic_t italic_e end_POSTSUBSCRIPT</annotation></semantics></math> (Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#A1.SS2" title="A.2 Share Error Heat Map ‣ Appendix A Appendix ‣ Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_tag">A.2</span></a> show the results). Accordingly, basis sharing across layers can be applied on such matrices.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p5">
<p class="ltx_p" id="S3.SS2.p5.5">On the contrary, basis sharing for <math alttext="{\bm{W}}_{O}" class="ltx_Math" display="inline" id="S3.SS2.p5.1.m1.1"><semantics id="S3.SS2.p5.1.m1.1a"><msub id="S3.SS2.p5.1.m1.1.1" xref="S3.SS2.p5.1.m1.1.1.cmml"><mi id="S3.SS2.p5.1.m1.1.1.2" xref="S3.SS2.p5.1.m1.1.1.2.cmml">𝑾</mi><mi id="S3.SS2.p5.1.m1.1.1.3" xref="S3.SS2.p5.1.m1.1.1.3.cmml">O</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.1.m1.1b"><apply id="S3.SS2.p5.1.m1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.1.m1.1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p5.1.m1.1.1.2.cmml" xref="S3.SS2.p5.1.m1.1.1.2">𝑾</ci><ci id="S3.SS2.p5.1.m1.1.1.3.cmml" xref="S3.SS2.p5.1.m1.1.1.3">𝑂</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.1.m1.1c">{\bm{W}}_{O}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.1.m1.1d">bold_italic_W start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT</annotation></semantics></math> in <math alttext="9^{th}" class="ltx_Math" display="inline" id="S3.SS2.p5.2.m2.1"><semantics id="S3.SS2.p5.2.m2.1a"><msup id="S3.SS2.p5.2.m2.1.1" xref="S3.SS2.p5.2.m2.1.1.cmml"><mn id="S3.SS2.p5.2.m2.1.1.2" xref="S3.SS2.p5.2.m2.1.1.2.cmml">9</mn><mrow id="S3.SS2.p5.2.m2.1.1.3" xref="S3.SS2.p5.2.m2.1.1.3.cmml"><mi id="S3.SS2.p5.2.m2.1.1.3.2" xref="S3.SS2.p5.2.m2.1.1.3.2.cmml">t</mi><mo id="S3.SS2.p5.2.m2.1.1.3.1" xref="S3.SS2.p5.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p5.2.m2.1.1.3.3" xref="S3.SS2.p5.2.m2.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.2.m2.1b"><apply id="S3.SS2.p5.2.m2.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.2.m2.1.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1">superscript</csymbol><cn id="S3.SS2.p5.2.m2.1.1.2.cmml" type="integer" xref="S3.SS2.p5.2.m2.1.1.2">9</cn><apply id="S3.SS2.p5.2.m2.1.1.3.cmml" xref="S3.SS2.p5.2.m2.1.1.3"><times id="S3.SS2.p5.2.m2.1.1.3.1.cmml" xref="S3.SS2.p5.2.m2.1.1.3.1"></times><ci id="S3.SS2.p5.2.m2.1.1.3.2.cmml" xref="S3.SS2.p5.2.m2.1.1.3.2">𝑡</ci><ci id="S3.SS2.p5.2.m2.1.1.3.3.cmml" xref="S3.SS2.p5.2.m2.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.2.m2.1c">9^{th}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.2.m2.1d">9 start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="10^{th}" class="ltx_Math" display="inline" id="S3.SS2.p5.3.m3.1"><semantics id="S3.SS2.p5.3.m3.1a"><msup id="S3.SS2.p5.3.m3.1.1" xref="S3.SS2.p5.3.m3.1.1.cmml"><mn id="S3.SS2.p5.3.m3.1.1.2" xref="S3.SS2.p5.3.m3.1.1.2.cmml">10</mn><mrow id="S3.SS2.p5.3.m3.1.1.3" xref="S3.SS2.p5.3.m3.1.1.3.cmml"><mi id="S3.SS2.p5.3.m3.1.1.3.2" xref="S3.SS2.p5.3.m3.1.1.3.2.cmml">t</mi><mo id="S3.SS2.p5.3.m3.1.1.3.1" xref="S3.SS2.p5.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p5.3.m3.1.1.3.3" xref="S3.SS2.p5.3.m3.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.3.m3.1b"><apply id="S3.SS2.p5.3.m3.1.1.cmml" xref="S3.SS2.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.3.m3.1.1.1.cmml" xref="S3.SS2.p5.3.m3.1.1">superscript</csymbol><cn id="S3.SS2.p5.3.m3.1.1.2.cmml" type="integer" xref="S3.SS2.p5.3.m3.1.1.2">10</cn><apply id="S3.SS2.p5.3.m3.1.1.3.cmml" xref="S3.SS2.p5.3.m3.1.1.3"><times id="S3.SS2.p5.3.m3.1.1.3.1.cmml" xref="S3.SS2.p5.3.m3.1.1.3.1"></times><ci id="S3.SS2.p5.3.m3.1.1.3.2.cmml" xref="S3.SS2.p5.3.m3.1.1.3.2">𝑡</ci><ci id="S3.SS2.p5.3.m3.1.1.3.3.cmml" xref="S3.SS2.p5.3.m3.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.3.m3.1c">10^{th}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.3.m3.1d">10 start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> layers incurs the increase of the Frobenius loss, i.e., <math alttext="10618.3&gt;4355.1+4895.7" class="ltx_Math" display="inline" id="S3.SS2.p5.4.m4.1"><semantics id="S3.SS2.p5.4.m4.1a"><mrow id="S3.SS2.p5.4.m4.1.1" xref="S3.SS2.p5.4.m4.1.1.cmml"><mn id="S3.SS2.p5.4.m4.1.1.2" xref="S3.SS2.p5.4.m4.1.1.2.cmml">10618.3</mn><mo id="S3.SS2.p5.4.m4.1.1.1" xref="S3.SS2.p5.4.m4.1.1.1.cmml">&gt;</mo><mrow id="S3.SS2.p5.4.m4.1.1.3" xref="S3.SS2.p5.4.m4.1.1.3.cmml"><mn id="S3.SS2.p5.4.m4.1.1.3.2" xref="S3.SS2.p5.4.m4.1.1.3.2.cmml">4355.1</mn><mo id="S3.SS2.p5.4.m4.1.1.3.1" xref="S3.SS2.p5.4.m4.1.1.3.1.cmml">+</mo><mn id="S3.SS2.p5.4.m4.1.1.3.3" xref="S3.SS2.p5.4.m4.1.1.3.3.cmml">4895.7</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.4.m4.1b"><apply id="S3.SS2.p5.4.m4.1.1.cmml" xref="S3.SS2.p5.4.m4.1.1"><gt id="S3.SS2.p5.4.m4.1.1.1.cmml" xref="S3.SS2.p5.4.m4.1.1.1"></gt><cn id="S3.SS2.p5.4.m4.1.1.2.cmml" type="float" xref="S3.SS2.p5.4.m4.1.1.2">10618.3</cn><apply id="S3.SS2.p5.4.m4.1.1.3.cmml" xref="S3.SS2.p5.4.m4.1.1.3"><plus id="S3.SS2.p5.4.m4.1.1.3.1.cmml" xref="S3.SS2.p5.4.m4.1.1.3.1"></plus><cn id="S3.SS2.p5.4.m4.1.1.3.2.cmml" type="float" xref="S3.SS2.p5.4.m4.1.1.3.2">4355.1</cn><cn id="S3.SS2.p5.4.m4.1.1.3.3.cmml" type="float" xref="S3.SS2.p5.4.m4.1.1.3.3">4895.7</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.4.m4.1c">10618.3&gt;4355.1+4895.7</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.4.m4.1d">10618.3 &gt; 4355.1 + 4895.7</annotation></semantics></math>. Accordingly, this parameter sharing should not be applied on <math alttext="{\bm{W}}_{O}" class="ltx_Math" display="inline" id="S3.SS2.p5.5.m5.1"><semantics id="S3.SS2.p5.5.m5.1a"><msub id="S3.SS2.p5.5.m5.1.1" xref="S3.SS2.p5.5.m5.1.1.cmml"><mi id="S3.SS2.p5.5.m5.1.1.2" xref="S3.SS2.p5.5.m5.1.1.2.cmml">𝑾</mi><mi id="S3.SS2.p5.5.m5.1.1.3" xref="S3.SS2.p5.5.m5.1.1.3.cmml">O</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.5.m5.1b"><apply id="S3.SS2.p5.5.m5.1.1.cmml" xref="S3.SS2.p5.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.5.m5.1.1.1.cmml" xref="S3.SS2.p5.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p5.5.m5.1.1.2.cmml" xref="S3.SS2.p5.5.m5.1.1.2">𝑾</ci><ci id="S3.SS2.p5.5.m5.1.1.3.cmml" xref="S3.SS2.p5.5.m5.1.1.3">𝑂</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.5.m5.1c">{\bm{W}}_{O}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.5.m5.1d">bold_italic_W start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT</annotation></semantics></math> to avoid significant computation loss. For such matrices, we will apply SVD to process the individual matrix in each layer separately.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Selection of Layers for Basis Sharing</h3>
<div class="ltx_para ltx_noindent" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#S3.SS1" title="3.1 Representing Weight Matrices across Layers with Combinations of Basis Vectors and Coefficients ‣ 3 Methodology ‣ Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_tag">3.1</span></a> determines which types of weight matrices can be shared across layers. This subsection then determines which layers can share basis vectors to represent such types of weight matrices. To select layers for basis sharing, the basis sharing of such layers should not incur Frobenius loss larger than without sharing.
According to Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#S3.F4" title="Figure 4 ‣ 3.2 Selection of Weight Matrices in LLMs for Cross-Layer Parameter Sharing ‣ 3 Methodology ‣ Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_tag">4</span></a>, the group of two adjacent layers leads to smaller Frobenius loss than the sum of the Frobenius loss of two separate layers. Based on this analysis, we will group adjacent layers with the order from the first layer to the last layer. Take a group of two layers as an example. The first layer and the second layer are grouped for basis sharing, followed by the group of the third layer and the fourth layer, etc.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span><span class="ltx_text ltx_font_smallcaps" id="S4.1.1">Experiments</span>
</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span><span class="ltx_text ltx_font_smallcaps" id="S4.SS1.1.1">Settings</span>
</h3>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Baseline</h4>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px1.p1.1">We compare with the work where SVD-based weight approximation in each individual layer is applied without cross-layer parameter sharing. Such work includes ASVD <cite class="ltx_cite ltx_citemacro_citep">(Yuan et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib45" title="">2023</a>)</cite>, FWSVD <cite class="ltx_cite ltx_citemacro_citep">(Hsu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib14" title="">2022</a>)</cite> and SVD-LLM <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib41" title="">2024b</a>)</cite>. We also compared our method with Dynamic Tying <cite class="ltx_cite ltx_citemacro_citep">(Hay &amp; Wolf, <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib13" title="">2024</a>)</cite>, where weights in some layers are restricted to be the same by training from scratch.
Since this method can only be applied on small language models, only GPT2 <cite class="ltx_cite ltx_citemacro_citep">(Radford et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib29" title="">2019</a>)</cite> was used to compared our method and Dynamic Tying.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Models and Datasets.</h4>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px2.p1.1">We evaluate our method using several models. For LLMs, many models are evaluated, namely LLaMA family (LLaMA-7B, LLaMA-13B, LLaMA-30B, LLaMA2-7B) <cite class="ltx_cite ltx_citemacro_citep">(Touvron et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib37" title="">2023a</a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib38" title="">b</a>)</cite>, OPT-6.7B <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib47" title="">2022</a>)</cite>, Mistral-7B <cite class="ltx_cite ltx_citemacro_citep">(Jiang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib17" title="">2023a</a>)</cite>, GPT2. Three language modeling datasets used in our experiment include WikiText-2 <cite class="ltx_cite ltx_citemacro_citep">(Merity et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib25" title="">2016</a>)</cite>, PTB <cite class="ltx_cite ltx_citemacro_citep">(Marcus et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib24" title="">1993</a>)</cite> and C4 <cite class="ltx_cite ltx_citemacro_citep">(Raffel et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib30" title="">2019</a>)</cite>. Seven reasoning datasets used in the experiments include OpenbookQA <cite class="ltx_cite ltx_citemacro_citep">(Banerjee et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib3" title="">2020</a>)</cite>, WinoGrande <cite class="ltx_cite ltx_citemacro_citep">(Sakaguchi et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib32" title="">2021</a>)</cite> HellaSwag <cite class="ltx_cite ltx_citemacro_citep">(Zellers et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib46" title="">2019</a>)</cite>, PIQA <cite class="ltx_cite ltx_citemacro_citep">(Bisk et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib5" title="">2020</a>)</cite>, MathQA <cite class="ltx_cite ltx_citemacro_citep">(Amini et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib1" title="">2019</a>)</cite>, ARC-e, ARC-c <cite class="ltx_cite ltx_citemacro_citep">(Clark et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib6" title="">2018</a>)</cite>. All the reasoning tasks are tested in zero-shot setting with the implementation of LM-Evaluation-Harness framework <cite class="ltx_cite ltx_citemacro_citep">(Gao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib10" title="">2024</a>)</cite>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">Implementation details</h4>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS0.Px3.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px3.p1.4">All of our models are based on the model implemented by the Hugging Face. LLaMA-30B are implemented with FP16, the rest models are implemented with FP32. To evaluate <math alttext="{\bm{S}}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px3.p1.1.m1.1"><semantics id="S4.SS1.SSS0.Px3.p1.1.m1.1a"><mi id="S4.SS1.SSS0.Px3.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.cmml">𝑺</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p1.1.m1.1b"><ci id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1">𝑺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p1.1.m1.1c">{\bm{S}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px3.p1.1.m1.1d">bold_italic_S</annotation></semantics></math>, FP64 is used to maintain the computation precision. All experiments are tested on two NVIDIA A100 80GB GPUs.
<math alttext="{\bm{S}}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px3.p1.2.m2.1"><semantics id="S4.SS1.SSS0.Px3.p1.2.m2.1a"><mi id="S4.SS1.SSS0.Px3.p1.2.m2.1.1" xref="S4.SS1.SSS0.Px3.p1.2.m2.1.1.cmml">𝑺</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p1.2.m2.1b"><ci id="S4.SS1.SSS0.Px3.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.2.m2.1.1">𝑺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p1.2.m2.1c">{\bm{S}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px3.p1.2.m2.1d">bold_italic_S</annotation></semantics></math> is derived through 256 samples from WikiText-2 with 2048 sequence length.
When the compression
ratio is 40% or larger than 40%
, the incurred compression errors increase, so that the output of a layer as the input of the next layer deviates significantly from its original values. This input deviation affects the evaluations of <math alttext="{\bm{S}}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px3.p1.3.m3.1"><semantics id="S4.SS1.SSS0.Px3.p1.3.m3.1a"><mi id="S4.SS1.SSS0.Px3.p1.3.m3.1.1" xref="S4.SS1.SSS0.Px3.p1.3.m3.1.1.cmml">𝑺</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p1.3.m3.1b"><ci id="S4.SS1.SSS0.Px3.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.3.m3.1.1">𝑺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p1.3.m3.1c">{\bm{S}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px3.p1.3.m3.1d">bold_italic_S</annotation></semantics></math> with <math alttext="\displaystyle{\bm{S}}({\bm{S}})^{T}=cholesky(({\bm{X}})^{T}{\bm{X}})" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px3.p1.4.m4.3"><semantics id="S4.SS1.SSS0.Px3.p1.4.m4.3a"><mrow id="S4.SS1.SSS0.Px3.p1.4.m4.3.3" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.cmml"><mrow id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.3" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.3.cmml"><mi id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.3.2" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.3.2.cmml">𝑺</mi><mo id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.3.1" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.3.1.cmml">⁢</mo><msup id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.3.3" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.3.3.cmml"><mrow id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.3.3.2.2" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.3.3.cmml"><mo id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.3.3.2.2.1" stretchy="false" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.3.3.cmml">(</mo><mi id="S4.SS1.SSS0.Px3.p1.4.m4.1.1" xref="S4.SS1.SSS0.Px3.p1.4.m4.1.1.cmml">𝑺</mi><mo id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.3.3.2.2.2" stretchy="false" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.3.3.cmml">)</mo></mrow><mi id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.3.3.3" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.3.3.3.cmml">T</mi></msup></mrow><mo id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.2" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.2.cmml">=</mo><mrow id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.cmml"><mi id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.3" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.3.cmml">c</mi><mo id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.2" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.2.cmml">⁢</mo><mi id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.4" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.4.cmml">h</mi><mo id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.2a" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.2.cmml">⁢</mo><mi id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.5" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.5.cmml">o</mi><mo id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.2b" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.2.cmml">⁢</mo><mi id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.6" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.6.cmml">l</mi><mo id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.2c" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.2.cmml">⁢</mo><mi id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.7" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.7.cmml">e</mi><mo id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.2d" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.2.cmml">⁢</mo><mi id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.8" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.8.cmml">s</mi><mo id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.2e" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.2.cmml">⁢</mo><mi id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.9" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.9.cmml">k</mi><mo id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.2f" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.2.cmml">⁢</mo><mi id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.10" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.10.cmml">y</mi><mo id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.2g" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.2.cmml">⁢</mo><mrow id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.1.1" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.1.1.1.cmml"><mo id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.1.1.2" stretchy="false" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.1.1.1" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.1.1.1.cmml"><msup id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.1.1.1.2" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.1.1.1.2.cmml"><mrow id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.1.1.1.2.2.2" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.1.1.1.2.cmml"><mo id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.1.1.1.2.2.2.1" stretchy="false" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.1.1.1.2.cmml">(</mo><mi id="S4.SS1.SSS0.Px3.p1.4.m4.2.2" xref="S4.SS1.SSS0.Px3.p1.4.m4.2.2.cmml">𝑿</mi><mo id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.1.1.1.2.2.2.2" stretchy="false" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.1.1.1.2.cmml">)</mo></mrow><mi id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.1.1.1.2.3" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.1.1.1.2.3.cmml">T</mi></msup><mo id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.1.1.1.1" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.1.1.1.1.cmml">⁢</mo><mi id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.1.1.1.3" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.1.1.1.3.cmml">𝑿</mi></mrow><mo id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.1.1.3" stretchy="false" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p1.4.m4.3b"><apply id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.cmml" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3"><eq id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.2.cmml" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.2"></eq><apply id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.3.cmml" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.3"><times id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.3.1.cmml" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.3.1"></times><ci id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.3.2.cmml" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.3.2">𝑺</ci><apply id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.3.3.cmml" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.3.3.1.cmml" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.3.3">superscript</csymbol><ci id="S4.SS1.SSS0.Px3.p1.4.m4.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.4.m4.1.1">𝑺</ci><ci id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.3.3.3.cmml" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.3.3.3">𝑇</ci></apply></apply><apply id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.cmml" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1"><times id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.2.cmml" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.2"></times><ci id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.3.cmml" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.3">𝑐</ci><ci id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.4.cmml" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.4">ℎ</ci><ci id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.5.cmml" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.5">𝑜</ci><ci id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.6.cmml" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.6">𝑙</ci><ci id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.7.cmml" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.7">𝑒</ci><ci id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.8.cmml" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.8">𝑠</ci><ci id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.9.cmml" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.9">𝑘</ci><ci id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.10.cmml" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.10">𝑦</ci><apply id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.1.1"><times id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.1.1.1.1"></times><apply id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.1.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.1.1.1.2">superscript</csymbol><ci id="S4.SS1.SSS0.Px3.p1.4.m4.2.2.cmml" xref="S4.SS1.SSS0.Px3.p1.4.m4.2.2">𝑿</ci><ci id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.1.1.1.2.3.cmml" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.1.1.1.2.3">𝑇</ci></apply><ci id="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px3.p1.4.m4.3.3.1.1.1.1.3">𝑿</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p1.4.m4.3c">\displaystyle{\bm{S}}({\bm{S}})^{T}=cholesky(({\bm{X}})^{T}{\bm{X}})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px3.p1.4.m4.3d">bold_italic_S ( bold_italic_S ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT = italic_c italic_h italic_o italic_l italic_e italic_s italic_k italic_y ( ( bold_italic_X ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT bold_italic_X )</annotation></semantics></math>. To incorporate this input deviation, we update the weights in the next layers for basis sharing with such deviated inputs, similar to that in SVD-LLM.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span><span class="ltx_text ltx_font_smallcaps" id="S4.SS2.1.1">Results</span>
</h3>
<div class="ltx_para ltx_noindent" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">We evaluate the performance of the proposed cross-layer parameter sharing from four aspects: (a) Performance on generation and reasoning tasks and comparison with state of the art in zero-shot setting. (b) LLM Performance on different LLMs in zero-shot setting. (c) Performance on LLMs with various scales in zero-shot setting. (d) LLM performance with LoRA <cite class="ltx_cite ltx_citemacro_citep">(Hu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib15" title="">2021</a>)</cite> fine-tuninng. (e) Comparison with training from scratch for weight sharing across layers.</p>
</div>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Performance on Generation &amp; Reasoning Tasks</h4>
<figure class="ltx_table ltx_figure_panel" id="S4.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>
PPL(<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T1.4.m1.1"><semantics id="S4.T1.4.m1.1b"><mo id="S4.T1.4.m1.1.1" mathcolor="#009901" stretchy="false" xref="S4.T1.4.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T1.4.m1.1c"><ci id="S4.T1.4.m1.1.1.cmml" xref="S4.T1.4.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.m1.1d">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.4.m1.1e">↓</annotation></semantics></math>) and Zero-shot(<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T1.5.m2.1"><semantics id="S4.T1.5.m2.1b"><mo id="S4.T1.5.m2.1.1" mathcolor="#009901" stretchy="false" xref="S4.T1.5.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T1.5.m2.1c"><ci id="S4.T1.5.m2.1.1.cmml" xref="S4.T1.5.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.5.m2.1d">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.5.m2.1e">↑</annotation></semantics></math>) performance of LLaMA-7B with Basis Sharing and baselines under 20% to 50% compression ratio on three language modeling datasets and seven common sense reasoning datasets. The <math alttext="{\bm{S}}" class="ltx_Math" display="inline" id="S4.T1.6.m3.1"><semantics id="S4.T1.6.m3.1b"><mi id="S4.T1.6.m3.1.1" xref="S4.T1.6.m3.1.1.cmml">𝑺</mi><annotation-xml encoding="MathML-Content" id="S4.T1.6.m3.1c"><ci id="S4.T1.6.m3.1.1.cmml" xref="S4.T1.6.m3.1.1">𝑺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.6.m3.1d">{\bm{S}}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.6.m3.1e">bold_italic_S</annotation></semantics></math> of all tasks is obtained with the dataset WikiText-2.
</figcaption>
<div class="ltx_inline-block ltx_figure_panel ltx_align_center ltx_transformed_outer" id="S4.SS2.SSS0.Px1.4.4" style="width:397.5pt;height:255.1pt;vertical-align:-0.6pt;"><span class="ltx_transformed_inner" style="transform:translate(-110.6pt,70.8pt) scale(0.642557611345823,0.642557611345823) ;">
<table class="ltx_tabular ltx_align_middle" id="S4.SS2.SSS0.Px1.4.4.4">
<tr class="ltx_tr" id="S4.SS2.SSS0.Px1.4.4.4.4">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.4.5"><span class="ltx_text ltx_font_smallcaps" id="S4.SS2.SSS0.Px1.4.4.4.4.5.1">Ratio</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.4.6"><span class="ltx_text ltx_font_smallcaps" id="S4.SS2.SSS0.Px1.4.4.4.4.6.1">Method</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.1.1.1.1.1">WikiText-2<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.1.1.1.1.1.m1.1"><semantics id="S4.SS2.SSS0.Px1.1.1.1.1.1.m1.1a"><mo id="S4.SS2.SSS0.Px1.1.1.1.1.1.m1.1.1" mathcolor="#009901" stretchy="false" xref="S4.SS2.SSS0.Px1.1.1.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.1.1.1.1.1.m1.1b"><ci id="S4.SS2.SSS0.Px1.1.1.1.1.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px1.1.1.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.1.1.1.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.1.1.1.1.1.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.2.2.2.2.2">PTB<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.2.2.2.2.2.m1.1"><semantics id="S4.SS2.SSS0.Px1.2.2.2.2.2.m1.1a"><mo id="S4.SS2.SSS0.Px1.2.2.2.2.2.m1.1.1" mathcolor="#009901" stretchy="false" xref="S4.SS2.SSS0.Px1.2.2.2.2.2.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.2.2.2.2.2.m1.1b"><ci id="S4.SS2.SSS0.Px1.2.2.2.2.2.m1.1.1.cmml" xref="S4.SS2.SSS0.Px1.2.2.2.2.2.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.2.2.2.2.2.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.2.2.2.2.2.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.SS2.SSS0.Px1.3.3.3.3.3">C4<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.3.3.3.3.3.m1.1"><semantics id="S4.SS2.SSS0.Px1.3.3.3.3.3.m1.1a"><mo id="S4.SS2.SSS0.Px1.3.3.3.3.3.m1.1.1" mathcolor="#009901" stretchy="false" xref="S4.SS2.SSS0.Px1.3.3.3.3.3.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.3.3.3.3.3.m1.1b"><ci id="S4.SS2.SSS0.Px1.3.3.3.3.3.m1.1.1.cmml" xref="S4.SS2.SSS0.Px1.3.3.3.3.3.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.3.3.3.3.3.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.3.3.3.3.3.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.4.7">Openb.</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.4.8">ARC_e</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.4.9">WinoG.</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.4.10">HellaS.</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.4.11">ARC_c</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.4.12">PIQA</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.4.13">MathQA</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.4.4"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.4.4.4.4.4.1">Average<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.4.4.4.4.4.1.m1.1"><semantics id="S4.SS2.SSS0.Px1.4.4.4.4.4.1.m1.1a"><mo id="S4.SS2.SSS0.Px1.4.4.4.4.4.1.m1.1.1" mathcolor="#009901" stretchy="false" xref="S4.SS2.SSS0.Px1.4.4.4.4.4.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.4.4.4.4.4.1.m1.1b"><ci id="S4.SS2.SSS0.Px1.4.4.4.4.4.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px1.4.4.4.4.4.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.4.4.4.4.4.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.4.4.4.4.4.1.m1.1d">↑</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="S4.SS2.SSS0.Px1.4.4.4.5">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.5.1"><span class="ltx_text" id="S4.SS2.SSS0.Px1.4.4.4.5.1.1" style="color:#9B9B9B;">0%</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.5.2"><span class="ltx_text" id="S4.SS2.SSS0.Px1.4.4.4.5.2.1" style="color:#9B9B9B;">Original</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.5.3"><span class="ltx_text" id="S4.SS2.SSS0.Px1.4.4.4.5.3.1" style="color:#9B9B9B;">5.68</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.5.4"><span class="ltx_text" id="S4.SS2.SSS0.Px1.4.4.4.5.4.1" style="color:#9B9B9B;">8.35</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.5.5"><span class="ltx_text" id="S4.SS2.SSS0.Px1.4.4.4.5.5.1" style="color:#9B9B9B;">7.34</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.5.6"><span class="ltx_text" id="S4.SS2.SSS0.Px1.4.4.4.5.6.1" style="color:#9B9B9B;">0.28</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.5.7"><span class="ltx_text" id="S4.SS2.SSS0.Px1.4.4.4.5.7.1" style="color:#9B9B9B;">0.67</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.5.8"><span class="ltx_text" id="S4.SS2.SSS0.Px1.4.4.4.5.8.1" style="color:#9B9B9B;">0.67</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.5.9"><span class="ltx_text" id="S4.SS2.SSS0.Px1.4.4.4.5.9.1" style="color:#9B9B9B;">0.56</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.5.10"><span class="ltx_text" id="S4.SS2.SSS0.Px1.4.4.4.5.10.1" style="color:#9B9B9B;">0.38</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.5.11"><span class="ltx_text" id="S4.SS2.SSS0.Px1.4.4.4.5.11.1" style="color:#9B9B9B;">0.78</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.5.12"><span class="ltx_text" id="S4.SS2.SSS0.Px1.4.4.4.5.12.1" style="color:#9B9B9B;">0.27</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.5.13"><span class="ltx_text" id="S4.SS2.SSS0.Px1.4.4.4.5.13.1" style="color:#9B9B9B;">0.52</span></td>
</tr>
<tr class="ltx_tr" id="S4.SS2.SSS0.Px1.4.4.4.6">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.6.1" rowspan="5"><span class="ltx_text" id="S4.SS2.SSS0.Px1.4.4.4.6.1.1">20%</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.6.2">SVD</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.6.3">20061</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.6.4">20306</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.6.5">18800</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.6.6">0.14</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.6.7">0.27</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.6.8">0.51</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.6.9">0.26</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.6.10">0.21</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.6.11">0.53</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.6.12">0.21</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.6.13">0.31</td>
</tr>
<tr class="ltx_tr" id="S4.SS2.SSS0.Px1.4.4.4.7">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS2.SSS0.Px1.4.4.4.7.1">FWSVD</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.7.2">1727</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.7.3">2152</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS2.SSS0.Px1.4.4.4.7.4">1511</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.7.5">0.15</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.7.6">0.31</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.7.7">0.50</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.7.8">0.26</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.7.9">0.23</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.7.10">0.56</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.7.11">0.21</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.7.12">0.32</td>
</tr>
<tr class="ltx_tr" id="S4.SS2.SSS0.Px1.4.4.4.8">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS2.SSS0.Px1.4.4.4.8.1">ASVD</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.8.2">11.14</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.8.3">16.55</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS2.SSS0.Px1.4.4.4.8.4">15.93</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.8.5">0.25</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.8.6">0.53</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.8.7">0.64</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.8.8">0.41</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.8.9">0.27</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.8.10">0.68</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.8.11">0.24</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.8.12">0.43</td>
</tr>
<tr class="ltx_tr" id="S4.SS2.SSS0.Px1.4.4.4.9">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS2.SSS0.Px1.4.4.4.9.1">SVD-LLM</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.9.2">7.94</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.9.3">18.05</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS2.SSS0.Px1.4.4.4.9.4">15.93</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.9.5">0.22</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.9.6">0.58</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.9.7">0.63</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.9.8">0.43</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.9.9">0.29</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.9.10">0.69</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.9.11">0.24</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.9.12">0.44</td>
</tr>
<tr class="ltx_tr" id="S4.SS2.SSS0.Px1.4.4.4.10">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.10.1"><span class="ltx_text ltx_font_typewriter" id="S4.SS2.SSS0.Px1.4.4.4.10.1.1">Basis Sharing</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.10.2"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.4.4.4.10.2.1">7.74</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.10.3"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.4.4.4.10.3.1">17.35</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.10.4"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.4.4.4.10.4.1">15.03</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.10.5"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.4.4.4.10.5.1">0.28</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.10.6"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.4.4.4.10.6.1">0.66</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.10.7"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.4.4.4.10.7.1">0.66</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.10.8"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.4.4.4.10.8.1">0.46</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.10.9"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.4.4.4.10.9.1">0.36</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.10.10"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.4.4.4.10.10.1">0.71</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.10.11"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.4.4.4.10.11.1">0.25</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.10.12"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.4.4.4.10.12.1">0.48</span></td>
</tr>
<tr class="ltx_tr" id="S4.SS2.SSS0.Px1.4.4.4.11">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.11.1" rowspan="5"><span class="ltx_text" id="S4.SS2.SSS0.Px1.4.4.4.11.1.1">30%</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.11.2">SVD</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.11.3">13103</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.11.4">17210</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.11.5">20871</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.11.6">0.13</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.11.7">0.26</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.11.8">0.51</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.11.9">0.26</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.11.10">0.21</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.11.11">0.54</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.11.12">0.22</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.11.13">0.30</td>
</tr>
<tr class="ltx_tr" id="S4.SS2.SSS0.Px1.4.4.4.12">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS2.SSS0.Px1.4.4.4.12.1">FWSVD</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.12.2">20127</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.12.3">11058</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS2.SSS0.Px1.4.4.4.12.4">7240</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.12.5">0.17</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.12.6">0.26</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.12.7">0.49</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.12.8">0.26</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.12.9">0.22</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.12.10">0.51</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.12.11">0.19</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.12.12">0.30</td>
</tr>
<tr class="ltx_tr" id="S4.SS2.SSS0.Px1.4.4.4.13">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS2.SSS0.Px1.4.4.4.13.1">ASVD</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.13.2">51</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.13.3">70</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS2.SSS0.Px1.4.4.4.13.4">41</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.13.5">0.18</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.13.6">0.43</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.13.7">0.53</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.13.8">0.37</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.13.9">0.25</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.13.10">0.65</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.13.11">0.21</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.13.12">0.38</td>
</tr>
<tr class="ltx_tr" id="S4.SS2.SSS0.Px1.4.4.4.14">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS2.SSS0.Px1.4.4.4.14.1">SVD-LLM</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.14.2">9.56</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.14.3">29.44</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS2.SSS0.Px1.4.4.4.14.4">25.11</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.14.5">0.20</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.14.6">0.48</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.14.7">0.59</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.14.8">0.40</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.14.9">0.26</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.14.10">0.65</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.14.11">0.22</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.14.12">0.40</td>
</tr>
<tr class="ltx_tr" id="S4.SS2.SSS0.Px1.4.4.4.15">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.15.1"><span class="ltx_text ltx_font_typewriter" id="S4.SS2.SSS0.Px1.4.4.4.15.1.1">Basis Sharing</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.15.2"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.4.4.4.15.2.1">9.25</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.15.3"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.4.4.4.15.3.1">29.12</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.15.4"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.4.4.4.15.4.1">22.46</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.15.5"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.4.4.4.15.5.1">0.27</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.15.6"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.4.4.4.15.6.1">0.63</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.15.7"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.4.4.4.15.7.1">0.63</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.15.8"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.4.4.4.15.8.1">0.40</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.15.9"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.4.4.4.15.9.1">0.30</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.15.10"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.4.4.4.15.10.1">0.68</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.15.11"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.4.4.4.15.11.1">0.24</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.15.12"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.4.4.4.15.12.1">0.45</span></td>
</tr>
<tr class="ltx_tr" id="S4.SS2.SSS0.Px1.4.4.4.16">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.16.1" rowspan="5"><span class="ltx_text" id="S4.SS2.SSS0.Px1.4.4.4.16.1.1">40%</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.16.2">SVD</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.16.3">52489</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.16.4">59977</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.16.5">47774</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.16.6">0.15</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.16.7">0.26</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.16.8">0.52</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.16.9">0.26</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.16.10">0.22</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.16.11">0.53</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.16.12">0.20</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.16.13">0.30</td>
</tr>
<tr class="ltx_tr" id="S4.SS2.SSS0.Px1.4.4.4.17">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS2.SSS0.Px1.4.4.4.17.1">FWSVD</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.17.2">18156</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.17.3">20990</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS2.SSS0.Px1.4.4.4.17.4">12847</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.17.5">0.16</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.17.6">0.26</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.17.7">0.51</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.17.8">0.26</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.17.9">0.22</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.17.10">0.53</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.17.11">0.21</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.17.12">0.30</td>
</tr>
<tr class="ltx_tr" id="S4.SS2.SSS0.Px1.4.4.4.18">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS2.SSS0.Px1.4.4.4.18.1">ASVD</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.18.2">1407</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.18.3">3292</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS2.SSS0.Px1.4.4.4.18.4">1109</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.18.5">0.13</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.18.6">0.28</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.18.7">0.48</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.18.8">0.26</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.18.9">0.22</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.18.10">0.55</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.18.11">0.19</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.18.12">0.30</td>
</tr>
<tr class="ltx_tr" id="S4.SS2.SSS0.Px1.4.4.4.19">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS2.SSS0.Px1.4.4.4.19.1">SVD-LLM</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.19.2">13.11</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.19.3">63.75</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS2.SSS0.Px1.4.4.4.19.4">49.83</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.19.5">0.19</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.19.6">0.42</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.19.7">0.58</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.19.8">0.33</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.19.9">0.25</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.19.10">0.60</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.19.11">0.21</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.19.12">0.37</td>
</tr>
<tr class="ltx_tr" id="S4.SS2.SSS0.Px1.4.4.4.20">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.20.1"><span class="ltx_text ltx_font_typewriter" id="S4.SS2.SSS0.Px1.4.4.4.20.1.1">Basis Sharing</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.20.2"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.4.4.4.20.2.1">12.39</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.20.3"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.4.4.4.20.3.1">55.78</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.20.4"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.4.4.4.20.4.1">41.28</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.20.5"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.4.4.4.20.5.1">0.22</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.20.6"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.4.4.4.20.6.1">0.52</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.20.7"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.4.4.4.20.7.1">0.61</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.20.8"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.4.4.4.20.8.1">0.35</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.20.9"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.4.4.4.20.9.1">0.27</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.20.10"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.4.4.4.20.10.1">0.62</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.20.11"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.4.4.4.20.11.1">0.23</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.20.12"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.4.4.4.20.12.1">0.40</span></td>
</tr>
<tr class="ltx_tr" id="S4.SS2.SSS0.Px1.4.4.4.21">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.21.1" rowspan="5"><span class="ltx_text" id="S4.SS2.SSS0.Px1.4.4.4.21.1.1">50%</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.21.2">SVD</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.21.3">131715</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.21.4">87227</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.21.5">79815</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.21.6">0.16</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.21.7">0.26</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.21.8">0.50</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.21.9">0.26</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.21.10">0.23</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.21.11">0.52</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.21.12">0.19</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.21.13">0.30</td>
</tr>
<tr class="ltx_tr" id="S4.SS2.SSS0.Px1.4.4.4.22">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS2.SSS0.Px1.4.4.4.22.1">FWSVD</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.22.2">24391</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.22.3">28321</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS2.SSS0.Px1.4.4.4.22.4">23104</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.22.5">0.12</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.22.6">0.26</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.22.7">0.50</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.22.8">0.26</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.22.9">0.23</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.22.10">0.53</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.22.11">0.20</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.22.12">0.30</td>
</tr>
<tr class="ltx_tr" id="S4.SS2.SSS0.Px1.4.4.4.23">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS2.SSS0.Px1.4.4.4.23.1">ASVD</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.23.2">15358</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.23.3">47690</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS2.SSS0.Px1.4.4.4.23.4">27925</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.23.5">0.12</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.23.6">0.26</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.23.7">0.51</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.23.8">0.26</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.23.9">0.22</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.23.10">0.52</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.23.11">0.19</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.23.12">0.30</td>
</tr>
<tr class="ltx_tr" id="S4.SS2.SSS0.Px1.4.4.4.24">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS2.SSS0.Px1.4.4.4.24.1">SVD-LLM</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.24.2">23.97</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.24.3">150.58</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS2.SSS0.Px1.4.4.4.24.4">118.57</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.24.5">0.16</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.24.6">0.33</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.24.7">0.54</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.24.8">0.29</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.24.9">0.23</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.24.10">0.56</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.24.11">0.21</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.4.4.4.24.12">0.33</td>
</tr>
<tr class="ltx_tr" id="S4.SS2.SSS0.Px1.4.4.4.25">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.25.1"><span class="ltx_text ltx_font_typewriter" id="S4.SS2.SSS0.Px1.4.4.4.25.1.1">Basis Sharing</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.25.2"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.4.4.4.25.2.1">19.99</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.25.3"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.4.4.4.25.3.1">126.35</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.25.4"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.4.4.4.25.4.1">88.44</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.25.5"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.4.4.4.25.5.1">0.18</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.25.6"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.4.4.4.25.6.1">0.42</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.25.7"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.4.4.4.25.7.1">0.57</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.25.8"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.4.4.4.25.8.1">0.31</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.25.9"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.4.4.4.25.9.1">0.23</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.25.10"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.4.4.4.25.10.1">0.58</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.25.11"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.4.4.4.25.11.1">0.22</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.SS2.SSS0.Px1.4.4.4.25.12"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.4.4.4.25.12.1">0.36</span></td>
</tr>
</table>
</span></div>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p1.1">We demonstrate the performance of LLaMA-7B and LLaMA2-7B on ten datasets under different compression ratios from 20% to 50%. In evaluating the LLM performance, we group two consecutive layers in the order from the first layer to the last layer to share a basis matrix, while Basis Sharing with more than two layers will be discussed later. Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#S4.SS2.SSS0.Px1" title="Performance on Generation &amp; Reasoning Tasks ‣ 4.2 Results ‣ 4 Experiments ‣ Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_tag">4.2</span></a> shows the results of LLaMA-7B. The first three datasets are for text generation tasks and the rest seven datasets are for reasoning tasks. For text generation tasks evaluated by perplexity (PPL), Basis Sharing consistently achieves the lowest PPL among compared with the state-of-the-art methods across all compression ratios and tasks. In reasoning tasks, Basis Sharing achieves an average accuracy at least 3% higher than the state-of-the-art methods. As the compression ratio increases, model performance consistently declines across all the methods due to the incurred larger compression errors. In short,
Basis Sharing outperforms SVD-LLM due to smaller compression errors as discussed in Section 3.</p>
</div>
<figure class="ltx_table ltx_figure_panel" id="S4.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>
PPL(<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T2.5.m1.1"><semantics id="S4.T2.5.m1.1b"><mo id="S4.T2.5.m1.1.1" mathcolor="#009901" stretchy="false" xref="S4.T2.5.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T2.5.m1.1c"><ci id="S4.T2.5.m1.1.1.cmml" xref="S4.T2.5.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.5.m1.1d">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.5.m1.1e">↓</annotation></semantics></math>) and Zero-shot(<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T2.6.m2.1"><semantics id="S4.T2.6.m2.1b"><mo id="S4.T2.6.m2.1.1" mathcolor="#009901" stretchy="false" xref="S4.T2.6.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.6.m2.1c"><ci id="S4.T2.6.m2.1.1.cmml" xref="S4.T2.6.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.6.m2.1d">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.6.m2.1e">↑</annotation></semantics></math>) performance of LLaMA2-7B with Basis Sharing under 20% to 50% compression ratios on three language modeling datasets and seven common sense reasoning datasets. The <math alttext="{\bm{S}}" class="ltx_Math" display="inline" id="S4.T2.7.m3.1"><semantics id="S4.T2.7.m3.1b"><mi id="S4.T2.7.m3.1.1" xref="S4.T2.7.m3.1.1.cmml">𝑺</mi><annotation-xml encoding="MathML-Content" id="S4.T2.7.m3.1c"><ci id="S4.T2.7.m3.1.1.cmml" xref="S4.T2.7.m3.1.1">𝑺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.7.m3.1d">{\bm{S}}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.7.m3.1e">bold_italic_S</annotation></semantics></math> of all language modeling tasks is evaluated with WikiText-2. For reasoning tasks, the <math alttext="{\bm{S}}" class="ltx_Math" display="inline" id="S4.T2.8.m4.1"><semantics id="S4.T2.8.m4.1b"><mi id="S4.T2.8.m4.1.1" xref="S4.T2.8.m4.1.1.cmml">𝑺</mi><annotation-xml encoding="MathML-Content" id="S4.T2.8.m4.1c"><ci id="S4.T2.8.m4.1.1.cmml" xref="S4.T2.8.m4.1.1">𝑺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.8.m4.1d">{\bm{S}}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.8.m4.1e">bold_italic_S</annotation></semantics></math> of the results outside the bracket is evaluated with WikiText-2, while inside is evaluated with Alpaca.
</figcaption>
<div class="ltx_inline-block ltx_figure_panel ltx_align_center ltx_transformed_outer" id="S4.SS2.SSS0.Px1.8.4" style="width:397.5pt;height:67pt;vertical-align:-0.6pt;"><span class="ltx_transformed_inner" style="transform:translate(-124.4pt,20.8pt) scale(0.614956795335978,0.614956795335978) ;">
<table class="ltx_tabular ltx_align_middle" id="S4.SS2.SSS0.Px1.8.4.4">
<tr class="ltx_tr" id="S4.SS2.SSS0.Px1.8.4.4.4">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.SS2.SSS0.Px1.8.4.4.4.5"><span class="ltx_text ltx_font_smallcaps" id="S4.SS2.SSS0.Px1.8.4.4.4.5.1">Ratio</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.5.1.1.1.1">WikiText-2<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.5.1.1.1.1.m1.1"><semantics id="S4.SS2.SSS0.Px1.5.1.1.1.1.m1.1a"><mo id="S4.SS2.SSS0.Px1.5.1.1.1.1.m1.1.1" mathcolor="#009901" stretchy="false" xref="S4.SS2.SSS0.Px1.5.1.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.5.1.1.1.1.m1.1b"><ci id="S4.SS2.SSS0.Px1.5.1.1.1.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px1.5.1.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.5.1.1.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.5.1.1.1.1.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.6.2.2.2.2">PTB<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.6.2.2.2.2.m1.1"><semantics id="S4.SS2.SSS0.Px1.6.2.2.2.2.m1.1a"><mo id="S4.SS2.SSS0.Px1.6.2.2.2.2.m1.1.1" mathcolor="#009901" stretchy="false" xref="S4.SS2.SSS0.Px1.6.2.2.2.2.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.6.2.2.2.2.m1.1b"><ci id="S4.SS2.SSS0.Px1.6.2.2.2.2.m1.1.1.cmml" xref="S4.SS2.SSS0.Px1.6.2.2.2.2.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.6.2.2.2.2.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.6.2.2.2.2.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.SS2.SSS0.Px1.7.3.3.3.3">C4<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.7.3.3.3.3.m1.1"><semantics id="S4.SS2.SSS0.Px1.7.3.3.3.3.m1.1a"><mo id="S4.SS2.SSS0.Px1.7.3.3.3.3.m1.1.1" mathcolor="#009901" stretchy="false" xref="S4.SS2.SSS0.Px1.7.3.3.3.3.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.7.3.3.3.3.m1.1b"><ci id="S4.SS2.SSS0.Px1.7.3.3.3.3.m1.1.1.cmml" xref="S4.SS2.SSS0.Px1.7.3.3.3.3.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.7.3.3.3.3.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.7.3.3.3.3.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.8.4.4.4.6">Openb.</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.8.4.4.4.7">ARC_e</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.8.4.4.4.8">WinoG.</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.8.4.4.4.9">HellaS.</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.8.4.4.4.10">ARC_c</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.8.4.4.4.11">PIQA</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.8.4.4.4.12">MathQA</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.8.4.4.4.4"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.8.4.4.4.4.1">Average<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.8.4.4.4.4.1.m1.1"><semantics id="S4.SS2.SSS0.Px1.8.4.4.4.4.1.m1.1a"><mo id="S4.SS2.SSS0.Px1.8.4.4.4.4.1.m1.1.1" mathcolor="#009901" stretchy="false" xref="S4.SS2.SSS0.Px1.8.4.4.4.4.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.8.4.4.4.4.1.m1.1b"><ci id="S4.SS2.SSS0.Px1.8.4.4.4.4.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px1.8.4.4.4.4.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.8.4.4.4.4.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.8.4.4.4.4.1.m1.1d">↑</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="S4.SS2.SSS0.Px1.8.4.4.5">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.SS2.SSS0.Px1.8.4.4.5.1"><span class="ltx_text" id="S4.SS2.SSS0.Px1.8.4.4.5.1.1" style="color:#9B9B9B;">0%</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.8.4.4.5.2"><span class="ltx_text" id="S4.SS2.SSS0.Px1.8.4.4.5.2.1" style="color:#9B9B9B;">5.47</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.8.4.4.5.3"><span class="ltx_text" id="S4.SS2.SSS0.Px1.8.4.4.5.3.1" style="color:#9B9B9B;">7.29</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.SS2.SSS0.Px1.8.4.4.5.4"><span class="ltx_text" id="S4.SS2.SSS0.Px1.8.4.4.5.4.1" style="color:#9B9B9B;">7.29</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.8.4.4.5.5"><span class="ltx_text" id="S4.SS2.SSS0.Px1.8.4.4.5.5.1" style="color:#9B9B9B;">0.31</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.8.4.4.5.6"><span class="ltx_text" id="S4.SS2.SSS0.Px1.8.4.4.5.6.1" style="color:#9B9B9B;">0.76</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.8.4.4.5.7"><span class="ltx_text" id="S4.SS2.SSS0.Px1.8.4.4.5.7.1" style="color:#9B9B9B;">0.69</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.8.4.4.5.8"><span class="ltx_text" id="S4.SS2.SSS0.Px1.8.4.4.5.8.1" style="color:#9B9B9B;">0.57</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.8.4.4.5.9"><span class="ltx_text" id="S4.SS2.SSS0.Px1.8.4.4.5.9.1" style="color:#9B9B9B;">0.43</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.8.4.4.5.10"><span class="ltx_text" id="S4.SS2.SSS0.Px1.8.4.4.5.10.1" style="color:#9B9B9B;">0.78</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.8.4.4.5.11"><span class="ltx_text" id="S4.SS2.SSS0.Px1.8.4.4.5.11.1" style="color:#9B9B9B;">0.28</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.8.4.4.5.12"><span class="ltx_text" id="S4.SS2.SSS0.Px1.8.4.4.5.12.1" style="color:#9B9B9B;">0.55</span></td>
</tr>
<tr class="ltx_tr" id="S4.SS2.SSS0.Px1.8.4.4.6">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.SS2.SSS0.Px1.8.4.4.6.1">20%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.8.4.4.6.2">7.77</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.8.4.4.6.3">60.00</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.SS2.SSS0.Px1.8.4.4.6.4">15.30</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.8.4.4.6.5">0.27 (0.28)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.8.4.4.6.6">0.66 (0.70)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.8.4.4.6.7">0.63 (0.63)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.8.4.4.6.8">0.43 (0.46)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.8.4.4.6.9">0.33 (0.35)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.8.4.4.6.10">0.70 (0.74)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.8.4.4.6.11">0.25 (0.25)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px1.8.4.4.6.12">0.47 (0.49)</td>
</tr>
<tr class="ltx_tr" id="S4.SS2.SSS0.Px1.8.4.4.7">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS2.SSS0.Px1.8.4.4.7.1">30%</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.8.4.4.7.2">9.69</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.8.4.4.7.3">97.40</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS2.SSS0.Px1.8.4.4.7.4">23.86</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.8.4.4.7.5">0.26 (0.27)</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.8.4.4.7.6">0.58 (0.65)</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.8.4.4.7.7">0.62 (0.62)</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.8.4.4.7.8">0.38 (0.41)</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.8.4.4.7.9">0.27 (0.32)</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.8.4.4.7.10">0.66 (0.70)</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.8.4.4.7.11">0.23 (0.24)</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.8.4.4.7.12">0.43 (0.46)</td>
</tr>
<tr class="ltx_tr" id="S4.SS2.SSS0.Px1.8.4.4.8">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS2.SSS0.Px1.8.4.4.8.1">40%</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.8.4.4.8.2">13.62</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.8.4.4.8.3">195.95</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS2.SSS0.Px1.8.4.4.8.4">43.89</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.8.4.4.8.5">0.19 (0.21)</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.8.4.4.8.6">0.48 (0.57)</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.8.4.4.8.7">0.58 (0.57)</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.8.4.4.8.8">0.33 (0.36)</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.8.4.4.8.9">0.22 (0.27)</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.8.4.4.8.10">0.61 (0.66)</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.8.4.4.8.11">0.23 (0.23)</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px1.8.4.4.8.12">0.38 (0.41)</td>
</tr>
<tr class="ltx_tr" id="S4.SS2.SSS0.Px1.8.4.4.9">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.SS2.SSS0.Px1.8.4.4.9.1">50%</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.SS2.SSS0.Px1.8.4.4.9.2">21.3</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.SS2.SSS0.Px1.8.4.4.9.3">509.30</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.SS2.SSS0.Px1.8.4.4.9.4">98.92</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.SS2.SSS0.Px1.8.4.4.9.5">0.15 (0.17)</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.SS2.SSS0.Px1.8.4.4.9.6">0.36 (0.47)</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.SS2.SSS0.Px1.8.4.4.9.7">0.55 (0.53)</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.SS2.SSS0.Px1.8.4.4.9.8">0.29 (0.31)</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.SS2.SSS0.Px1.8.4.4.9.9">0.20 (0.25)</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.SS2.SSS0.Px1.8.4.4.9.10">0.56 (0.60)</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.SS2.SSS0.Px1.8.4.4.9.11">0.23 (0.22)</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.SS2.SSS0.Px1.8.4.4.9.12">0.33 (0.36)</td>
</tr>
</table>
</span></div>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS2.SSS0.Px1.p2">
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p2.3">Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#S4.SS2.SSS0.Px1" title="Performance on Generation &amp; Reasoning Tasks ‣ 4.2 Results ‣ 4 Experiments ‣ Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_tag">4.2</span></a> presents the basis sharing results of LLaMA2-7B. For the common reasoning tasks, <math alttext="{\bm{S}}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p2.1.m1.1"><semantics id="S4.SS2.SSS0.Px1.p2.1.m1.1a"><mi id="S4.SS2.SSS0.Px1.p2.1.m1.1.1" xref="S4.SS2.SSS0.Px1.p2.1.m1.1.1.cmml">𝑺</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p2.1.m1.1b"><ci id="S4.SS2.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.1.m1.1.1">𝑺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p2.1.m1.1c">{\bm{S}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p2.1.m1.1d">bold_italic_S</annotation></semantics></math> are evaluated with both WikiText-2 and Alpaca <cite class="ltx_cite ltx_citemacro_citep">(Taori et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib36" title="">2023</a>)</cite> to demonstrate the performance difference. The result outside the bracket is based on the evaluation of <math alttext="{\bm{S}}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p2.2.m2.1"><semantics id="S4.SS2.SSS0.Px1.p2.2.m2.1a"><mi id="S4.SS2.SSS0.Px1.p2.2.m2.1.1" xref="S4.SS2.SSS0.Px1.p2.2.m2.1.1.cmml">𝑺</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p2.2.m2.1b"><ci id="S4.SS2.SSS0.Px1.p2.2.m2.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.2.m2.1.1">𝑺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p2.2.m2.1c">{\bm{S}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p2.2.m2.1d">bold_italic_S</annotation></semantics></math> with WikiText-2, while the result within the bracket is based on the evaluation of <math alttext="{\bm{S}}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p2.3.m3.1"><semantics id="S4.SS2.SSS0.Px1.p2.3.m3.1a"><mi id="S4.SS2.SSS0.Px1.p2.3.m3.1.1" xref="S4.SS2.SSS0.Px1.p2.3.m3.1.1.cmml">𝑺</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p2.3.m3.1b"><ci id="S4.SS2.SSS0.Px1.p2.3.m3.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.3.m3.1.1">𝑺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p2.3.m3.1c">{\bm{S}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p2.3.m3.1d">bold_italic_S</annotation></semantics></math> from Alpaca. It can be seen that LLaMA2-7B is more sensitive to parameter compression, especially on the PTB task. When the compression ratio reaches to 50%, the PPL of LLaMA2-7B is four times of the PPL of LLaMA-7B, while the performance on the remaining tasks are still comparable.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.SSS0.Px1.p3">
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p3.4">According to Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#S4.SS2.SSS0.Px1" title="Performance on Generation &amp; Reasoning Tasks ‣ 4.2 Results ‣ 4 Experiments ‣ Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_tag">4.2</span></a>, the input dataset from which <math alttext="{\bm{S}}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p3.1.m1.1"><semantics id="S4.SS2.SSS0.Px1.p3.1.m1.1a"><mi id="S4.SS2.SSS0.Px1.p3.1.m1.1.1" xref="S4.SS2.SSS0.Px1.p3.1.m1.1.1.cmml">𝑺</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p3.1.m1.1b"><ci id="S4.SS2.SSS0.Px1.p3.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p3.1.m1.1.1">𝑺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p3.1.m1.1c">{\bm{S}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p3.1.m1.1d">bold_italic_S</annotation></semantics></math> is derived plays a crucial role in determining performance on common reasoning tasks in zero-shot settings. Generally, the model where <math alttext="{\bm{S}}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p3.2.m2.1"><semantics id="S4.SS2.SSS0.Px1.p3.2.m2.1a"><mi id="S4.SS2.SSS0.Px1.p3.2.m2.1.1" xref="S4.SS2.SSS0.Px1.p3.2.m2.1.1.cmml">𝑺</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p3.2.m2.1b"><ci id="S4.SS2.SSS0.Px1.p3.2.m2.1.1.cmml" xref="S4.SS2.SSS0.Px1.p3.2.m2.1.1">𝑺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p3.2.m2.1c">{\bm{S}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p3.2.m2.1d">bold_italic_S</annotation></semantics></math> is evaluated with Alpaca achieves better accuracy than the model where <math alttext="{\bm{S}}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p3.3.m3.1"><semantics id="S4.SS2.SSS0.Px1.p3.3.m3.1a"><mi id="S4.SS2.SSS0.Px1.p3.3.m3.1.1" xref="S4.SS2.SSS0.Px1.p3.3.m3.1.1.cmml">𝑺</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p3.3.m3.1b"><ci id="S4.SS2.SSS0.Px1.p3.3.m3.1.1.cmml" xref="S4.SS2.SSS0.Px1.p3.3.m3.1.1">𝑺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p3.3.m3.1c">{\bm{S}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p3.3.m3.1d">bold_italic_S</annotation></semantics></math> is evaluated with WikiText-2, especially on ARC_e under 50% compression ratio. The accuracy difference can reach 11%. However, on WinoG. the difference is not obvious, the model where <math alttext="{\bm{S}}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p3.4.m4.1"><semantics id="S4.SS2.SSS0.Px1.p3.4.m4.1a"><mi id="S4.SS2.SSS0.Px1.p3.4.m4.1.1" xref="S4.SS2.SSS0.Px1.p3.4.m4.1.1.cmml">𝑺</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p3.4.m4.1b"><ci id="S4.SS2.SSS0.Px1.p3.4.m4.1.1.cmml" xref="S4.SS2.SSS0.Px1.p3.4.m4.1.1">𝑺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p3.4.m4.1c">{\bm{S}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p3.4.m4.1d">bold_italic_S</annotation></semantics></math> is evaluated with WikiText-2 achieves even higher accuracy under 40% and 50% compression ratios.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Performance on Different LLMs</h4>
<div class="ltx_para ltx_noindent" id="S4.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px2.p1.1">To evaluate the generalization of Basis Sharing across multiple LLMs, we evaluate its PPL on three distinct models from three LLM families: OPT-6.7B (from the OPT family), LLaMA 2-7B (from the LLaMA family), and Mistral-7B (from the Mistral family). This comparison is conducted under a 20% compression ratio using the WikiText-2 dataset without any fine-tuning. It can be seen from Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#S4.SS2.SSS0.Px2" title="Performance on Different LLMs ‣ 4.2 Results ‣ 4 Experiments ‣ Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_tag">4.2</span></a>, Basis Sharing consistently achieves the lowest PPL. Especially for OPT-6.7B and Mistral-7B, Basis Sharing achieves a PPL reduction up to 25% compared with SVD-LLM.</p>
</div>
<figure class="ltx_figure" id="S4.SS2.SSS0.Px2.2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_middle" id="S4.SS2.SSS0.Px2.1.fig1" style="width:190.8pt;">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_table ltx_figure_panel" id="S4.T3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>PPL (<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T3.2.m1.1"><semantics id="S4.T3.2.m1.1b"><mo id="S4.T3.2.m1.1.1" mathcolor="#009901" stretchy="false" xref="S4.T3.2.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T3.2.m1.1c"><ci id="S4.T3.2.m1.1.1.cmml" xref="S4.T3.2.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.2.m1.1d">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.2.m1.1e">↓</annotation></semantics></math>) of three different LLMs – OPT-6.7B, LLaMA 2-7B, and Mistral-7B – under 20% compression ratio on WikiText-2.</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_inline-block ltx_figure_panel ltx_align_center ltx_transformed_outer" id="S4.SS2.SSS0.Px2.1.fig1.1" style="width:397.5pt;height:164.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(68.5pt,-28.4pt) scale(1.5253633703057,1.5253633703057) ;">
<table class="ltx_tabular ltx_align_middle" id="S4.SS2.SSS0.Px2.1.fig1.1.1">
<tr class="ltx_tr" id="S4.SS2.SSS0.Px2.1.fig1.1.1.1">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.SS2.SSS0.Px2.1.fig1.1.1.1.1"><span class="ltx_text ltx_font_smallcaps" id="S4.SS2.SSS0.Px2.1.fig1.1.1.1.1.1">Method</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px2.1.fig1.1.1.1.2">OPT-6.7B</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px2.1.fig1.1.1.1.3">LLaMA 2-7B</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px2.1.fig1.1.1.1.4">Mistral-7B</td>
</tr>
<tr class="ltx_tr" id="S4.SS2.SSS0.Px2.1.fig1.1.1.2">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.SS2.SSS0.Px2.1.fig1.1.1.2.1">SVD</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px2.1.fig1.1.1.2.2">66275</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px2.1.fig1.1.1.2.3">18192</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px2.1.fig1.1.1.2.4">159627</td>
</tr>
<tr class="ltx_tr" id="S4.SS2.SSS0.Px2.1.fig1.1.1.3">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS2.SSS0.Px2.1.fig1.1.1.3.1">FWSVD</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px2.1.fig1.1.1.3.2">14559</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px2.1.fig1.1.1.3.3">2360</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px2.1.fig1.1.1.3.4">6357</td>
</tr>
<tr class="ltx_tr" id="S4.SS2.SSS0.Px2.1.fig1.1.1.4">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS2.SSS0.Px2.1.fig1.1.1.4.1">ASVD</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px2.1.fig1.1.1.4.2">82</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px2.1.fig1.1.1.4.3">10.10</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px2.1.fig1.1.1.4.4">13.72</td>
</tr>
<tr class="ltx_tr" id="S4.SS2.SSS0.Px2.1.fig1.1.1.5">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS2.SSS0.Px2.1.fig1.1.1.5.1">SVD-LLM</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px2.1.fig1.1.1.5.2">16.04</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px2.1.fig1.1.1.5.3">8.5</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px2.1.fig1.1.1.5.4">10.21</td>
</tr>
<tr class="ltx_tr" id="S4.SS2.SSS0.Px2.1.fig1.1.1.6">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.SS2.SSS0.Px2.1.fig1.1.1.6.1"><span class="ltx_text ltx_font_typewriter" id="S4.SS2.SSS0.Px2.1.fig1.1.1.6.1.1">Basis Sharing</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.SS2.SSS0.Px2.1.fig1.1.1.6.2"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px2.1.fig1.1.1.6.2.1">11.79</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.SS2.SSS0.Px2.1.fig1.1.1.6.3"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px2.1.fig1.1.1.6.3.1">7.70</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.SS2.SSS0.Px2.1.fig1.1.1.6.4"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px2.1.fig1.1.1.6.4.1">7.57</span></td>
</tr>
</table>
</span></div>
</div>
</div>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.SS2.SSS0.Px2.2.fig2" style="width:190.8pt;">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_table ltx_figure_panel" id="S4.T4">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4: </span>PPL (<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T4.2.m1.1"><semantics id="S4.T4.2.m1.1b"><mo id="S4.T4.2.m1.1.1" mathcolor="#009901" stretchy="false" xref="S4.T4.2.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T4.2.m1.1c"><ci id="S4.T4.2.m1.1.1.cmml" xref="S4.T4.2.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.2.m1.1d">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T4.2.m1.1e">↓</annotation></semantics></math>) of LLaMA-7B, 13B, 30B under 20% compression ratio on WikiText-2. OOM means out of memory error during the model compression. </figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_inline-block ltx_figure_panel ltx_align_center ltx_transformed_outer" id="S4.SS2.SSS0.Px2.2.fig2.1" style="width:397.5pt;height:159.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(64.0pt,-25.6pt) scale(1.47474309896746,1.47474309896746) ;">
<table class="ltx_tabular ltx_align_middle" id="S4.SS2.SSS0.Px2.2.fig2.1.1">
<tr class="ltx_tr" id="S4.SS2.SSS0.Px2.2.fig2.1.1.1">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.SS2.SSS0.Px2.2.fig2.1.1.1.1"><span class="ltx_text ltx_font_smallcaps" id="S4.SS2.SSS0.Px2.2.fig2.1.1.1.1.1">Method</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px2.2.fig2.1.1.1.2">LLaMA-7B</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px2.2.fig2.1.1.1.3">LLaMA-13B</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px2.2.fig2.1.1.1.4">LLaMA-30B</td>
</tr>
<tr class="ltx_tr" id="S4.SS2.SSS0.Px2.2.fig2.1.1.2">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.SS2.SSS0.Px2.2.fig2.1.1.2.1">SVD</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px2.2.fig2.1.1.2.2">20061</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px2.2.fig2.1.1.2.3">946.31</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS2.SSS0.Px2.2.fig2.1.1.2.4">54.11</td>
</tr>
<tr class="ltx_tr" id="S4.SS2.SSS0.Px2.2.fig2.1.1.3">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS2.SSS0.Px2.2.fig2.1.1.3.1">FWSVD</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px2.2.fig2.1.1.3.2">1630</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px2.2.fig2.1.1.3.3">OOM</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px2.2.fig2.1.1.3.4">OOM</td>
</tr>
<tr class="ltx_tr" id="S4.SS2.SSS0.Px2.2.fig2.1.1.4">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS2.SSS0.Px2.2.fig2.1.1.4.1">ASVD</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px2.2.fig2.1.1.4.2">11.14</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px2.2.fig2.1.1.4.3">6.74</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px2.2.fig2.1.1.4.4">22.71</td>
</tr>
<tr class="ltx_tr" id="S4.SS2.SSS0.Px2.2.fig2.1.1.5">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS2.SSS0.Px2.2.fig2.1.1.5.1">SVD-LLM</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px2.2.fig2.1.1.5.2">7.94</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px2.2.fig2.1.1.5.3">6.61</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.SSS0.Px2.2.fig2.1.1.5.4">5.63</td>
</tr>
<tr class="ltx_tr" id="S4.SS2.SSS0.Px2.2.fig2.1.1.6">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.SS2.SSS0.Px2.2.fig2.1.1.6.1"><span class="ltx_text ltx_font_typewriter" id="S4.SS2.SSS0.Px2.2.fig2.1.1.6.1.1">Basis Sharing</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.SS2.SSS0.Px2.2.fig2.1.1.6.2"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px2.2.fig2.1.1.6.2.1">7.74</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.SS2.SSS0.Px2.2.fig2.1.1.6.3"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px2.2.fig2.1.1.6.3.1">6.47</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.SS2.SSS0.Px2.2.fig2.1.1.6.4"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px2.2.fig2.1.1.6.4.1">5.47</span></td>
</tr>
</table>
</span></div>
</div>
</div>
</figure>
</div>
</div>
</figure>
</section>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">Performance on LLMs with Various Scales</h4>
<div class="ltx_para ltx_noindent" id="S4.SS2.SSS0.Px3.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px3.p1.1">Basis Sharing can be applied to LLMs with large scales. To demonstrate this, we apply Basis Sharing on LLaMA with three different scales under 20% compression ratio, namely LLaMA-7B, LLaMA-13B and LLaMA-30B against the state-of-the-art methods.
The result is shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#S4.SS2.SSS0.Px2" title="Performance on Different LLMs ‣ 4.2 Results ‣ 4 Experiments ‣ Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_tag">4.2</span></a>. According to this table,
Basis Sharing achieves the best performance across all the scales. Since gradient needs to be computed with FWSVD, out of memory error occurs on an A100 GPU. In contrast, Basis Sharing can still be realized with an A100 GPU.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px4">
<h4 class="ltx_title ltx_title_paragraph">Performance with LoRA Fine-Tuning </h4>
<figure class="ltx_figure ltx_align_floatright" id="S4.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="630" id="S4.F5.g1" src="x5.png" width="829"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>LoRA fine-tuning results of LLaMA-7B under 20% compression ratio with different compression methods.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS2.SSS0.Px4.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px4.p1.1">LoRA <cite class="ltx_cite ltx_citemacro_citep">(Hu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib15" title="">2021</a>)</cite> is one of the most promising fine-tuning techniques to recover performance/accuracy. LoRA can also be applied to Basis Sharing to recover performance/accuracy. We used <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px4.p1.1.1">lora_r</span> = 8, <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px4.p1.1.2">lora_alpha</span> = 32, and <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px4.p1.1.3">learning_rate</span> = 1e-4, and used defaults for all other hyperparameters in the Hugging Face PEFT. Each model is fine tuned with WikiText-2 training dataset for two epochs.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.SSS0.Px4.p2">
<p class="ltx_p" id="S4.SS2.SSS0.Px4.p2.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#S4.F5" title="Figure 5 ‣ Performance with LoRA Fine-Tuning ‣ 4.2 Results ‣ 4 Experiments ‣ Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_tag">5</span></a> shows the result after applying LoRA on LLaMA-7B with WikiText-2. It can be seen from the figure that all compression methods achieve similar PPL under 20% compression ratio, and PPL difference increases as the compression ratio goes up. Basis Sharing achieves the lowest PPL when the compression ratio reaches 50%.</p>
</div>
<figure class="ltx_table ltx_figure_panel ltx_align_center ltx_align_floatright" id="S4.T5">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 5: </span>GPT2 20% compression ratio compared with Dynamic Tying.</figcaption>
<div class="ltx_inline-block ltx_figure_panel ltx_align_center ltx_transformed_outer" id="S4.T5.1" style="width:190.8pt;height:41.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-29.4pt,6.4pt) scale(0.764394471718832,0.764394471718832) ;">
<table class="ltx_tabular ltx_align_middle" id="S4.T5.1.1">
<tr class="ltx_tr" id="S4.T5.1.1.1">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T5.1.1.1.1"><span class="ltx_text ltx_font_smallcaps" id="S4.T5.1.1.1.1.1">Method</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.1.1.2"># Parm.</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.1.1.3">Time</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.1.1.4">PPL</td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.1.2">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T5.1.1.2.1">Dynamic Tying</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.1.2.2">264M (GPT2-XL)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.1.2.3">13.75h</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.1.2.4">49.37</td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.1.3">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T5.1.1.3.1">Basis Sharing</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T5.1.1.3.2">94M (GPT2)</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T5.1.1.3.3">26.47s</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T5.1.1.3.4">43.15</td>
</tr>
</table>
</span></div>
</figure>
</section>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px5">
<h4 class="ltx_title ltx_title_paragraph">Comparison with Training from Scratch</h4>
<div class="ltx_para ltx_noindent" id="S4.SS2.SSS0.Px5.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px5.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#S4.SS2.SSS0.Px4" title="Performance with LoRA Fine-Tuning ‣ 4.2 Results ‣ 4 Experiments ‣ Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_tag">4.2</span></a> compares Basis Sharing with Dynamic Tying<cite class="ltx_cite ltx_citemacro_citep">(Hay &amp; Wolf, <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#bib.bib13" title="">2024</a>)</cite>, where parameter sharing is realized by training from scratch. Instead of training from scratch, Basis Sharing leverages pretrained models that have been trained on large datasets and trained with more computational resources. As a result, Basis Sharing achieves fewer parameters, faster compression, and better PPL on WikiText-2 compared to Dynamic Tying.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span><span class="ltx_text ltx_font_smallcaps" id="S4.SS3.3.1">Impact of Layer Selection of Basis Sharing on LLM Performance</span>
</h3>
<div class="ltx_para ltx_noindent" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">In section 3, we analyzed the change of Frobenius loss when two layers are grouped to share a set of basis vectors.
In this section, we will demonstrate how grouping more than two consecutive layers affects the LLM performance.</p>
</div>
<figure class="ltx_figure" id="S4.SS3.2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_middle" id="S4.SS3.1.fig1" style="width:190.8pt;">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_table ltx_figure_panel ltx_align_center" id="S4.T6">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 6: </span>Impact of grouping different numbers of layers on LLaMA-7B under compression ratios from 20% to 50%.</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_inline-block ltx_figure_panel ltx_align_center ltx_transformed_outer" id="S4.SS3.1.fig1.1" style="width:357.7pt;height:372.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(83.9pt,-87.5pt) scale(1.88335834360254,1.88335834360254) ;">
<table class="ltx_tabular ltx_align_middle" id="S4.SS3.1.fig1.1.1">
<tr class="ltx_tr" id="S4.SS3.1.fig1.1.1.1">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.SS3.1.fig1.1.1.1.1"><span class="ltx_text ltx_font_smallcaps" id="S4.SS3.1.fig1.1.1.1.1.1"># Layers</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS3.1.fig1.1.1.1.2">20%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS3.1.fig1.1.1.1.3">30%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS3.1.fig1.1.1.1.4">40%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS3.1.fig1.1.1.1.5">50%</td>
</tr>
<tr class="ltx_tr" id="S4.SS3.1.fig1.1.1.2">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.SS3.1.fig1.1.1.2.1">1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS3.1.fig1.1.1.2.2">7.94</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS3.1.fig1.1.1.2.3">9.56</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS3.1.fig1.1.1.2.4">13.11</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS3.1.fig1.1.1.2.5">23.97</td>
</tr>
<tr class="ltx_tr" id="S4.SS3.1.fig1.1.1.3">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS3.1.fig1.1.1.3.1">2</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.1.fig1.1.1.3.2">7.74</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.1.fig1.1.1.3.3">9.25</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.1.fig1.1.1.3.4"><span class="ltx_text ltx_font_bold" id="S4.SS3.1.fig1.1.1.3.4.1">12.39</span></td>
<td class="ltx_td ltx_align_center" id="S4.SS3.1.fig1.1.1.3.5"><span class="ltx_text ltx_font_bold" id="S4.SS3.1.fig1.1.1.3.5.1">19.99</span></td>
</tr>
<tr class="ltx_tr" id="S4.SS3.1.fig1.1.1.4">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS3.1.fig1.1.1.4.1">3</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.1.fig1.1.1.4.2">7.72</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.1.fig1.1.1.4.3">9.27</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.1.fig1.1.1.4.4">12.60</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.1.fig1.1.1.4.5">20.06</td>
</tr>
<tr class="ltx_tr" id="S4.SS3.1.fig1.1.1.5">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS3.1.fig1.1.1.5.1">4</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.1.fig1.1.1.5.2">7.65</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.1.fig1.1.1.5.3"><span class="ltx_text ltx_font_bold" id="S4.SS3.1.fig1.1.1.5.3.1">9.18</span></td>
<td class="ltx_td ltx_align_center" id="S4.SS3.1.fig1.1.1.5.4">12.58</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.1.fig1.1.1.5.5">20.86</td>
</tr>
<tr class="ltx_tr" id="S4.SS3.1.fig1.1.1.6">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS3.1.fig1.1.1.6.1">5</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.1.fig1.1.1.6.2"><span class="ltx_text ltx_font_bold" id="S4.SS3.1.fig1.1.1.6.2.1">7.62</span></td>
<td class="ltx_td ltx_align_center" id="S4.SS3.1.fig1.1.1.6.3">9.19</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.1.fig1.1.1.6.4">12.81</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.1.fig1.1.1.6.5">24.45</td>
</tr>
<tr class="ltx_tr" id="S4.SS3.1.fig1.1.1.7">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS3.1.fig1.1.1.7.1">6</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.1.fig1.1.1.7.2">7.64</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.1.fig1.1.1.7.3">9.20</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.1.fig1.1.1.7.4">14.13</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.1.fig1.1.1.7.5">25.40</td>
</tr>
<tr class="ltx_tr" id="S4.SS3.1.fig1.1.1.8">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS3.1.fig1.1.1.8.1">7</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.1.fig1.1.1.8.2">7.67</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.1.fig1.1.1.8.3">9.24</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.1.fig1.1.1.8.4">14.64</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.1.fig1.1.1.8.5">27.30</td>
</tr>
<tr class="ltx_tr" id="S4.SS3.1.fig1.1.1.9">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS3.1.fig1.1.1.9.1">8</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.1.fig1.1.1.9.2">7.75</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.1.fig1.1.1.9.3">9.49</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.1.fig1.1.1.9.4">14.60</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.1.fig1.1.1.9.5">27.92</td>
</tr>
<tr class="ltx_tr" id="S4.SS3.1.fig1.1.1.10">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS3.1.fig1.1.1.10.1">16</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.1.fig1.1.1.10.2">7.95</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.1.fig1.1.1.10.3">10.58</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.1.fig1.1.1.10.4">19.72</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.1.fig1.1.1.10.5">49.11</td>
</tr>
<tr class="ltx_tr" id="S4.SS3.1.fig1.1.1.11">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.SS3.1.fig1.1.1.11.1">32</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.SS3.1.fig1.1.1.11.2">7.94</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.SS3.1.fig1.1.1.11.3">9.56</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.SS3.1.fig1.1.1.11.4">30.82</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.SS3.1.fig1.1.1.11.5">85.24</td>
</tr>
</table>
</span></div>
</div>
</div>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.SS3.2.fig2" style="width:190.8pt;">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_table ltx_figure_panel" id="S4.T7">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 7: </span>Impact of grouping different numbers of layers on LLaMA-7B under compression ratios from 20% to 50% after LoRA Fine-Tuning.</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_inline-block ltx_figure_panel ltx_align_center ltx_transformed_outer" id="S4.SS3.2.fig2.1" style="width:357.7pt;height:381.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(86.1pt,-91.9pt) scale(1.92848229670802,1.92848229670802) ;">
<table class="ltx_tabular ltx_align_middle" id="S4.SS3.2.fig2.1.1">
<tr class="ltx_tr" id="S4.SS3.2.fig2.1.1.1">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.SS3.2.fig2.1.1.1.1"><span class="ltx_text ltx_font_smallcaps" id="S4.SS3.2.fig2.1.1.1.1.1"># Layers</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS3.2.fig2.1.1.1.2">20%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS3.2.fig2.1.1.1.3">30%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS3.2.fig2.1.1.1.4">40%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS3.2.fig2.1.1.1.5">50%</td>
</tr>
<tr class="ltx_tr" id="S4.SS3.2.fig2.1.1.2">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.SS3.2.fig2.1.1.2.1">1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS3.2.fig2.1.1.2.2">7.78</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS3.2.fig2.1.1.2.3">9.56</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS3.2.fig2.1.1.2.4">10.65</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS3.2.fig2.1.1.2.5">13.26</td>
</tr>
<tr class="ltx_tr" id="S4.SS3.2.fig2.1.1.3">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS3.2.fig2.1.1.3.1">2</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.2.fig2.1.1.3.2">7.14</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.2.fig2.1.1.3.3">7.84</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.2.fig2.1.1.3.4">8.91</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.2.fig2.1.1.3.5">10.56</td>
</tr>
<tr class="ltx_tr" id="S4.SS3.2.fig2.1.1.4">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS3.2.fig2.1.1.4.1">3</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.2.fig2.1.1.4.2">7.00</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.2.fig2.1.1.4.3">7.81</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.2.fig2.1.1.4.4">9.04</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.2.fig2.1.1.4.5">10.35</td>
</tr>
<tr class="ltx_tr" id="S4.SS3.2.fig2.1.1.5">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS3.2.fig2.1.1.5.1">4</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.2.fig2.1.1.5.2">7.07</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.2.fig2.1.1.5.3">7.86</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.2.fig2.1.1.5.4">9.02</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.2.fig2.1.1.5.5">10.36</td>
</tr>
<tr class="ltx_tr" id="S4.SS3.2.fig2.1.1.6">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS3.2.fig2.1.1.6.1">5</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.2.fig2.1.1.6.2">6.98</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.2.fig2.1.1.6.3">8.05</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.2.fig2.1.1.6.4">9.23</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.2.fig2.1.1.6.5">10.14</td>
</tr>
<tr class="ltx_tr" id="S4.SS3.2.fig2.1.1.7">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS3.2.fig2.1.1.7.1">6</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.2.fig2.1.1.7.2">6.88</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.2.fig2.1.1.7.3">8.03</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.2.fig2.1.1.7.4">9.06</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.2.fig2.1.1.7.5">10.32</td>
</tr>
<tr class="ltx_tr" id="S4.SS3.2.fig2.1.1.8">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS3.2.fig2.1.1.8.1">7</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.2.fig2.1.1.8.2">6.75</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.2.fig2.1.1.8.3">7.57</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.2.fig2.1.1.8.4">9.08</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.2.fig2.1.1.8.5">10.76</td>
</tr>
<tr class="ltx_tr" id="S4.SS3.2.fig2.1.1.9">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS3.2.fig2.1.1.9.1">8</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.2.fig2.1.1.9.2">6.89</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.2.fig2.1.1.9.3">7.68</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.2.fig2.1.1.9.4">9.14</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.2.fig2.1.1.9.5">10.32</td>
</tr>
<tr class="ltx_tr" id="S4.SS3.2.fig2.1.1.10">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS3.2.fig2.1.1.10.1">16</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.2.fig2.1.1.10.2">7.02</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.2.fig2.1.1.10.3">7.82</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.2.fig2.1.1.10.4">9.27</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.2.fig2.1.1.10.5">11.20</td>
</tr>
<tr class="ltx_tr" id="S4.SS3.2.fig2.1.1.11">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.SS3.2.fig2.1.1.11.1">32</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.SS3.2.fig2.1.1.11.2">6.97</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.SS3.2.fig2.1.1.11.3">8.25</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.SS3.2.fig2.1.1.11.4">9.37</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.SS3.2.fig2.1.1.11.5">11.64</td>
</tr>
</table>
</span></div>
</div>
</div>
</figure>
</div>
</div>
</figure>
<section class="ltx_paragraph" id="S4.SS3.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Impact on LLM Performance in Zero-Shot Setting</h4>
<div class="ltx_para ltx_noindent" id="S4.SS3.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS3.SSS0.Px1.p1.1">We grouped different numbers of consecutive layers to examine
the impact of the number grouped layers on the LLM performance without any fine-tuning. Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#S4.SS3" title="4.3 Impact of Layer Selection of Basis Sharing on LLM Performance ‣ 4 Experiments ‣ Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_tag">4.3</span></a> shows the result. The number in the first column indicates the number of consecutive layers sharing a common basis matrix. For example, 4 means that every four consecutive layers share a basis matrix in the order from the first layer to the last layer.
Compared with no basis sharing in SVD-LLM (# LAYERS = 1) under 20% compression ratio, Basis Sharing achieves a similar performance. Grouping four or five layers to share a basis matrix is more reasonable when compression ratio is lower than 30%, since they have the lowest PPL. Two layers sharing a basis matrix is a good choice when the
compression ratio is larger than 30%.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS3.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Impact on LLM Performance with LoRA Fine-Tuning</h4>
<div class="ltx_para ltx_noindent" id="S4.SS3.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS3.SSS0.Px2.p1.1">We also examined the impact of grouping different number of layers on LLM performance after LoRA Fine-Tuning. Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#S4.SS3" title="4.3 Impact of Layer Selection of Basis Sharing on LLM Performance ‣ 4 Experiments ‣ Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_tag">4.3</span></a>
shows the result. According to this table,
the performance of LLM can be enhanced compared with that without fine-tuning.
In addition, this table also shows that after LoRA fine-tuning, grouping layers in LLaMA-7B for Basis Sharing can achieve better performance than that without basis sharing in SVD-LLM (# LAYERS = 1).
Even when the number of grouped layer is 32, the performance of Basis Sharing is still better than that without basis sharing in SVD-LLM (# LAYERS = 1).</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS3.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">Impact on LLM Peformance with Full Parameter Fine-Tuning</h4>
<figure class="ltx_table ltx_figure_panel ltx_align_floatright" id="S4.T8">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 8: </span>Result of full parameter fine-tuning by grouping different numbers of layers.</figcaption>
<div class="ltx_inline-block ltx_figure_panel ltx_align_center ltx_transformed_outer" id="S4.T8.1" style="width:159.0pt;height:94.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-11.0pt,6.6pt) scale(0.87813547243326,0.87813547243326) ;">
<table class="ltx_tabular ltx_align_middle" id="S4.T8.1.1">
<tr class="ltx_tr" id="S4.T8.1.1.1">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T8.1.1.1.1"><span class="ltx_text ltx_font_smallcaps" id="S4.T8.1.1.1.1.1"># Layers</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T8.1.1.1.2">20%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T8.1.1.1.3">30%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T8.1.1.1.4">40%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T8.1.1.1.5">50%</td>
</tr>
<tr class="ltx_tr" id="S4.T8.1.1.2">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T8.1.1.2.1">2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T8.1.1.2.2">6.57</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T8.1.1.2.3">7.41</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T8.1.1.2.4">8.29</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T8.1.1.2.5">9.71</td>
</tr>
<tr class="ltx_tr" id="S4.T8.1.1.3">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T8.1.1.3.1">4</td>
<td class="ltx_td ltx_align_center" id="S4.T8.1.1.3.2">6.64</td>
<td class="ltx_td ltx_align_center" id="S4.T8.1.1.3.3">7.39</td>
<td class="ltx_td ltx_align_center" id="S4.T8.1.1.3.4">8.41</td>
<td class="ltx_td ltx_align_center" id="S4.T8.1.1.3.5">9.91</td>
</tr>
<tr class="ltx_tr" id="S4.T8.1.1.4">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T8.1.1.4.1">8</td>
<td class="ltx_td ltx_align_center" id="S4.T8.1.1.4.2">6.63</td>
<td class="ltx_td ltx_align_center" id="S4.T8.1.1.4.3">7.46</td>
<td class="ltx_td ltx_align_center" id="S4.T8.1.1.4.4">8.54</td>
<td class="ltx_td ltx_align_center" id="S4.T8.1.1.4.5">10.23</td>
</tr>
<tr class="ltx_tr" id="S4.T8.1.1.5">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T8.1.1.5.1">16</td>
<td class="ltx_td ltx_align_center" id="S4.T8.1.1.5.2">6.66</td>
<td class="ltx_td ltx_align_center" id="S4.T8.1.1.5.3">7.66</td>
<td class="ltx_td ltx_align_center" id="S4.T8.1.1.5.4">9.04</td>
<td class="ltx_td ltx_align_center" id="S4.T8.1.1.5.5">10.48</td>
</tr>
<tr class="ltx_tr" id="S4.T8.1.1.6">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T8.1.1.6.1">32</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T8.1.1.6.2">6.67</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T8.1.1.6.3">7.90</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T8.1.1.6.4">9.24</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T8.1.1.6.5">10.94</td>
</tr>
</table>
</span></div>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS3.SSS0.Px3.p1">
<p class="ltx_p" id="S4.SS3.SSS0.Px3.p1.1">To examine the full potential of the Basis Sharing, we also conducted the full parameter fine-tuning to examine the impact of grouping different numbers of layers on LLM performance. Due to the high computational cost, we only fine tuned the LLaMA-7B on grouping 2, 4, 8, 16, 32 layers, respectively. The differences from LoRA fine-tuning are that we use here <span class="ltx_text ltx_font_italic" id="S4.SS3.SSS0.Px3.p1.1.1">learning_rate</span> = 2e-6 and two A100 GPUs. The results of full parameter fine-tuning can be found in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#S4.SS3.SSS0.Px3" title="Impact on LLM Peformance with Full Parameter Fine-Tuning ‣ 4.3 Impact of Layer Selection of Basis Sharing on LLM Performance ‣ 4 Experiments ‣ Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_tag">4.3</span></a>. It can be seen that the performance with full parameter fine-tuning is only a little bit better than the performance with LoRA fine-tuning. The reason could be that WikiText-2 is relatively a small dataset to fine-tune the large model. Directly using this dataset to fine-tune could easily lead to overfitting. Therefore, we reduce the <span class="ltx_text ltx_font_italic" id="S4.SS3.SSS0.Px3.p1.1.2">learning_rate</span> from 1e-4 to 2e-6.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Performance on Real Hardware</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">Basis Sharing not only reduces the memory required for storing parameters, but also enhances inference efficiency on real hardware.
To demonstrate this advantage, we compared the performance of LLaMA-7B with and without Basis Sharing on a single A100 GPU, using a batch size of 512 and a sequence length of 32 to generate
one token for each batch.
With this setting, throughput was evaluated as the total number of tokens that can be processed by the model per second.</p>
</div>
<figure class="ltx_figure ltx_align_floatright" id="S4.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="622" id="S4.F6.g1" src="x6.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Throughput of dense LLaMA-7B model and the compressed model with Basis Sharing under compression ratios from 20% to 50%.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS4.p2">
<p class="ltx_p" id="S4.SS4.p2.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03765v1#S4.F6" title="Figure 6 ‣ 4.4 Performance on Real Hardware ‣ 4 Experiments ‣ Basis Sharing: Cross-Layer Parameter Sharing for Large Language Model Compression"><span class="ltx_text ltx_ref_tag">6</span></a> shows the throughput result. It can be seen that as the compression ratio increases, the throughput of model with Basis Sharing also increases. Under 50% compression ratio, the throughput of Basis Sharing is 1.57 times of the dense model.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>
<div class="ltx_para ltx_noindent" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this paper, we explore parameter sharing across different layers with SVD to achieve effective compression for LLMs. Specifically, weight matrices in different layers are decomposed and represented as a linear combination of a set of shared basis vectors and unique coefficients. The types of weight matrices and the layer selection for Basis Sharing are examined when compressing LLMs to maintain the performance. Comprehensive experiments demonstrate that
Basis Sharing outperforms state-of-the-art SVD-based compression approaches, especially under large compression ratios.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Amini et al. (2019)</span>
<span class="ltx_bibblock">
Aida Amini, Saadia Gabriel, Shanchuan Lin, Rik Koncel-Kedziorski, Yejin Choi,
and Hannaneh Hajishirzi.

</span>
<span class="ltx_bibblock">MathQA: Towards interpretable math word problem solving with
operation-based formalisms.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">Proceedings of the 2019 Conference of the North American
Chapter of the Association for Computational Linguistics: Human Language
Technologies, Volume 1 (Long and Short Papers)</em>, pp.  2357–2367.
Association for Computational Linguistics, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ashkboos et al. (2024)</span>
<span class="ltx_bibblock">
Saleh Ashkboos, Amirkeivan Mohtashami, Maximilian L Croci, Bo Li, Martin Jaggi,
Dan Alistarh, Torsten Hoefler, and James Hensman.

</span>
<span class="ltx_bibblock">Quarot: Outlier-free 4-bit inference in rotated llms.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">arXiv preprint arXiv:2404.00456</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Banerjee et al. (2020)</span>
<span class="ltx_bibblock">
Pratyay Banerjee, Kuntal Kumar Pal, Arindam Mitra, and Chitta Baral.

</span>
<span class="ltx_bibblock">Careful selection of knowledge to solve open book question answering.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">57th Annual Meeting of the Association for Computational
Linguistics, ACL 2019</em>, pp.  6120–6129, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bhojanapalli et al. (2021)</span>
<span class="ltx_bibblock">
Srinadh Bhojanapalli, Ayan Chakrabarti, Andreas Veit, Michal Lukasik, Himanshu
Jain, Frederick Liu, Yin-Wen Chang, and Sanjiv Kumar.

</span>
<span class="ltx_bibblock">Leveraging redundancy in attention with reuse transformers.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">arXiv preprint arXiv:2110.06821</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bisk et al. (2020)</span>
<span class="ltx_bibblock">
Yonatan Bisk, Rowan Zellers, et al.

</span>
<span class="ltx_bibblock">Piqa: Reasoning about physical commonsense in natural language.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Proceedings of the AAAI Conference on Artificial Intelligence</em>,
34:7432–7439, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Clark et al. (2018)</span>
<span class="ltx_bibblock">
Peter Clark, Isaac Cowhey, Oren Etzioni, Tushar Khot, Ashish Sabharwal, Carissa
Schoenick, and Oyvind Tafjord.

</span>
<span class="ltx_bibblock">Think you have solved question answering? Try ARC, the AI2
reasoning challenge.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">arXiv:1803.05457v1</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dehghani et al. (2019)</span>
<span class="ltx_bibblock">
Mostafa Dehghani, Stephan Gouws, Oriol Vinyals, Jakob Uszkoreit, and Lukasz
Kaiser.

</span>
<span class="ltx_bibblock">Universal transformers.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">International Conference on Learning Representations</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Frantar &amp; Alistarh (2022)</span>
<span class="ltx_bibblock">
Elias Frantar and Dan Alistarh.

</span>
<span class="ltx_bibblock">Optimal brain compression: A framework for accurate post-training
quantization and pruning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">Advances in Neural Information Processing Systems</em>,
35:4475–4488, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Frantar &amp; Alistarh (2023)</span>
<span class="ltx_bibblock">
Elias Frantar and Dan Alistarh.

</span>
<span class="ltx_bibblock">Sparsegpt: Massive language models can be accurately pruned in
one-shot.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">International Conference on Machine Learning</em>, pp. 10323–10337, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et al. (2024)</span>
<span class="ltx_bibblock">
Leo Gao, Jonathan Tow, Baber Abbasi, Stella Biderman, Sid Black, Anthony
DiPofi, Charles Foster, Laurence Golding, Jeffrey Hsu, Alain Le Noac’h,
Haonan Li, Kyle McDonell, Niklas Muennighoff, Chris Ociepa, Jason Phang,
Laria Reynolds, Hailey Schoelkopf, Aviya Skowron, Lintang Sutawika, Eric
Tang, Anish Thite, Ben Wang, Kevin Wang, and Andy Zou.

</span>
<span class="ltx_bibblock">A framework for few-shot language model evaluation, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://zenodo.org/records/12608602" title="">https://zenodo.org/records/12608602</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Golub et al. (1987)</span>
<span class="ltx_bibblock">
Gene H Golub, Alan Hoffman, and Gilbert W Stewart.

</span>
<span class="ltx_bibblock">A generalization of the eckart-young-mirsky matrix approximation
theorem.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">Linear Algebra and its applications</em>, 88:317–327,
1987.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gu et al. (2024)</span>
<span class="ltx_bibblock">
Yuxian Gu, Li Dong, Furu Wei, and Minlie Huang.

</span>
<span class="ltx_bibblock">MiniLLM: Knowledge distillation of large language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">The Twelfth International Conference on Learning
Representations</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hay &amp; Wolf (2024)</span>
<span class="ltx_bibblock">
Tamir David Hay and Lior Wolf.

</span>
<span class="ltx_bibblock">Dynamic layer tying for parameter-efficient transformers.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">The Twelfth International Conference on Learning
Representations</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hsu et al. (2022)</span>
<span class="ltx_bibblock">
Yen-Chang Hsu, Ting Hua, Sungen Chang, Qian Lou, Yilin Shen, and Hongxia Jin.

</span>
<span class="ltx_bibblock">Language model compression with weighted low-rank factorization.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">International Conference on Learning Representations</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al. (2021)</span>
<span class="ltx_bibblock">
Edward J Hu, Yelong Shen, Phillip Wallis, Zeyuan Allen-Zhu, Yuanzhi Li, Shean
Wang, Lu Wang, and Weizhu Chen.

</span>
<span class="ltx_bibblock">Lora: Low-rank adaptation of large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">arXiv preprint arXiv:2106.09685</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et al. (2022)</span>
<span class="ltx_bibblock">
Yukun Huang, Yanda Chen, Zhou Yu, and Kathleen McKeown.

</span>
<span class="ltx_bibblock">In-context learning distillation: Transferring few-shot learning
ability of pre-trained language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">arXiv preprint arXiv:2212.10670</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al. (2023a)</span>
<span class="ltx_bibblock">
Albert Q Jiang, Alexandre Sablayrolles, Arthur Mensch, Chris Bamford,
Devendra Singh Chaplot, Diego de las Casas, Florian Bressand, Gianna Lengyel,
Guillaume Lample, Lucile Saulnier, et al.

</span>
<span class="ltx_bibblock">Mistral 7B.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">arXiv preprint arXiv:2310.06825</em>, 2023a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al. (2024)</span>
<span class="ltx_bibblock">
Mengnan Jiang, Jingcun Wang, Amro Eldebiky, Xunzhao Yin, Cheng Zhuo, Ing-Chao
Lin, and Grace Li Zhang.

</span>
<span class="ltx_bibblock">Class-aware pruning for efficient neural networks.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Design, Automation and Test in Europe Conference and
Exhibition (DATE)</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al. (2023b)</span>
<span class="ltx_bibblock">
Yuxin Jiang, Chunkit Chan, Mingyang Chen, and Wei Wang.

</span>
<span class="ltx_bibblock">Lion: Adversarial distillation of proprietary large language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">The 2023 Conference on Empirical Methods in Natural Language
Processing</em>, pp.  3134–3154, 2023b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al. (2024)</span>
<span class="ltx_bibblock">
Ji Lin, Jiaming Tang, Haotian Tang, Shang Yang, Wei-Ming Chen, Wei-Chen Wang,
Guangxuan Xiao, Xingyu Dang, Chuang Gan, and Song Han.

</span>
<span class="ltx_bibblock">Awq: Activation-aware weight quantization for on-device llm
compression and acceleration.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">Proceedings of Machine Learning and Systems</em>, 6:87–100, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lv et al. (2023)</span>
<span class="ltx_bibblock">
Xiuqing Lv, Peng Zhang, Sunzhu Li, Guobing Gan, and Yueheng Sun.

</span>
<span class="ltx_bibblock">Lightformer: Light-weight transformer using svd-based weight transfer
and parameter sharing.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">Findings of the Association for Computational Linguistics:
ACL 2023</em>, pp.  10323–10335, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma et al. (2023)</span>
<span class="ltx_bibblock">
Xinyin Ma, Gongfan Fang, and Xinchao Wang.

</span>
<span class="ltx_bibblock">Llm-pruner: On the structural pruning of large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">Advances in neural information processing systems</em>,
36:21702–21720, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Magister et al. (2023)</span>
<span class="ltx_bibblock">
Lucie Charlotte Magister, Jonathan Mallinson, Jakub Dominik Adamek, Eric Malmi,
and Aliaksei Severyn.

</span>
<span class="ltx_bibblock">Teaching small language models to reason.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">The 61st Annual Meeting Of The Association For Computational
Linguistics</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Marcus et al. (1993)</span>
<span class="ltx_bibblock">
Mitchell P. Marcus, Beatrice Santorini, and Mary Ann Marcinkiewicz.

</span>
<span class="ltx_bibblock">Building a large annotated corpus of English: The Penn
Treebank.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">Computational Linguistics</em>, 19(2):313–330,
1993.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Merity et al. (2016)</span>
<span class="ltx_bibblock">
Stephen Merity, Caiming Xiong, James Bradbury, and Richard Socher.

</span>
<span class="ltx_bibblock">Pointer sentinel mixture models, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pan et al. (2024)</span>
<span class="ltx_bibblock">
Xuchen Pan, Yanxi Chen, Yaliang Li, Bolin Ding, and Jingren Zhou.

</span>
<span class="ltx_bibblock">Ee-tuning: An economical yet scalable solution for tuning early-exit
large language models, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Petri et al. (2023)</span>
<span class="ltx_bibblock">
Richard Petri, Grace Li Zhang, Yiran Chen, Ulf Schlichtmann, and Bing Li.

</span>
<span class="ltx_bibblock">Powerpruning: Selecting weights and activations for power-efficient
neural network acceleration.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">Design Automation Conference (DAC)</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qiu et al. (2024)</span>
<span class="ltx_bibblock">
Ruidi Qiu, Amro Eldebiky, Grace Li Zhang, Xunzhao Yin, Cheng Zhuo, Ulf
Schlichtmann, and Bing Li.

</span>
<span class="ltx_bibblock">Oplixnet: Towards area-efficient optical split-complex networks with
real-to-complex data assignment and knowledge distillation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">Design, Automation and Test in Europe Conference and
Exhibition (DATE)</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford et al. (2019)</span>
<span class="ltx_bibblock">
Alec Radford, Jeffrey Wu, Rewon Child, David Luan, Dario Amodei, Ilya
Sutskever, et al.

</span>
<span class="ltx_bibblock">Language models are unsupervised multitask learners.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">OpenAI blog</em>, 1(8):9, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Raffel et al. (2019)</span>
<span class="ltx_bibblock">
Colin Raffel, Noam Shazeer, Adam Roberts, Katherine Lee, Sharan Narang, Michael
Matena, Yanqi Zhou, Wei Li, and Peter J. Liu.

</span>
<span class="ltx_bibblock">Exploring the limits of transfer learning with a unified text-to-text
transformer.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">arXiv e-prints</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reid et al. (2021)</span>
<span class="ltx_bibblock">
Machel Reid, Edison Marrese-Taylor, and Yutaka Matsuo.

</span>
<span class="ltx_bibblock">Subformer: Exploring weight sharing for parameter efficiency in
generative transformers.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">arXiv preprint arXiv:2101.00234</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sakaguchi et al. (2021)</span>
<span class="ltx_bibblock">
Keisuke Sakaguchi, Ronan Le Bras, Chandra Bhagavatula, and Yejin Choi.

</span>
<span class="ltx_bibblock">Winogrande: an adversarial winograd schema challenge at scale.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">Commun. ACM</em>, 64(9):99–106, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al. (2024)</span>
<span class="ltx_bibblock">
Mingjie Sun, Zhuang Liu, Anna Bair, and J Zico Kolter.

</span>
<span class="ltx_bibblock">A simple and effective pruning approach for large language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">The Twelfth International Conference on Learning
Representations</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al. (2023)</span>
<span class="ltx_bibblock">
Wenhao Sun, Grace Li Zhang, Huaxi Gu, Bing Lil, and Ulf Schlichtmann.

</span>
<span class="ltx_bibblock">Class-based quantization for neural networks.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">Design, Automation and Test in Europe Conference and
Exhibition (DATE)</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Takase &amp; Kiyono (2021)</span>
<span class="ltx_bibblock">
Sho Takase and Shun Kiyono.

</span>
<span class="ltx_bibblock">Lessons on parameter sharing across layers in transformers.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">arXiv preprint arXiv:2104.06022</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Taori et al. (2023)</span>
<span class="ltx_bibblock">
Rohan Taori, Ishaan Gulrajani, Tianyi Zhang, Yann Dubois, Xuechen Li, Carlos
Guestrin, Percy Liang, and Tatsunori B. Hashimoto.

</span>
<span class="ltx_bibblock">Stanford alpaca: An instruction-following llama model, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et al. (2023a)</span>
<span class="ltx_bibblock">
Hugo Touvron, Thibaut Lavril, Gautier Izacard, Xavier Martinet, Marie-Anne
Lachaux, Timothée Lacroix, Baptiste Rozière, Naman Goyal, Eric
Hambro, Faisal Azhar, et al.

</span>
<span class="ltx_bibblock">Llama: Open and efficient foundation language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">arXiv preprint arXiv:2302.13971</em>, 2023a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et al. (2023b)</span>
<span class="ltx_bibblock">
Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine
Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale,
et al.

</span>
<span class="ltx_bibblock">Llama 2: Open foundation and fine-tuned chat models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">arXiv preprint arXiv:2307.09288</em>, 2023b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani (2017)</span>
<span class="ltx_bibblock">
A Vaswani.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">Advances in Neural Information Processing Systems</em>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2024a)</span>
<span class="ltx_bibblock">
Jingcun Wang, Bing Li, and Grace Li Zhang.

</span>
<span class="ltx_bibblock">Early-exit with class exclusion for efficient inference of neural
networks.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">International Conference on AI Circuits and Systems
(AICAS)</em>, 2024a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2024b)</span>
<span class="ltx_bibblock">
Xin Wang, Yu Zheng, Zhongwei Wan, and Mi Zhang.

</span>
<span class="ltx_bibblock">SVD-LLM: Truncation-aware singular value decomposition for large
language model compression.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">arXiv preprint arXiv:2403.07378</em>, 2024b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. (2023)</span>
<span class="ltx_bibblock">
Yifan Wu, Shichao Kan, Min Zeng, and Min Li.

</span>
<span class="ltx_bibblock">Singularformer: Learning to decompose self-attention to linearize the
complexity of transformer.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">International Joint Conference on Artificial Intelligence</em>,
pp.  4433–4441, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiao et al. (2023)</span>
<span class="ltx_bibblock">
Guangxuan Xiao, Ji Lin, Mickael Seznec, Hao Wu, Julien Demouth, and Song Han.

</span>
<span class="ltx_bibblock">Smoothquant: Accurate and efficient post-training quantization for
large language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">International Conference on Machine Learning</em>, pp. 38087–38099, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiao et al. (2019)</span>
<span class="ltx_bibblock">
Tong Xiao, Yinqiao Li, Jingbo Zhu, Zhengtao Yu, and Tongran Liu.

</span>
<span class="ltx_bibblock">Sharing attention weights for fast transformer.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">International Joint Conference on Artificial Intelligence</em>,
2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yuan et al. (2023)</span>
<span class="ltx_bibblock">
Zhihang Yuan, Yuzhang Shang, Yue Song, Qiang Wu, Yan Yan, and Guangyu Sun.

</span>
<span class="ltx_bibblock">ASVD: Activation-aware singular value decomposition for compressing
large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">arXiv preprint arXiv:2312.05821</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zellers et al. (2019)</span>
<span class="ltx_bibblock">
Rowan Zellers, Ari Holtzman, Yonatan Bisk, Ali Farhadi, and Yejin Choi.

</span>
<span class="ltx_bibblock">Hellaswag: Can a machine really finish your sentence?

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">Proceedings of the 57th Annual Meeting of the Association
for Computational Linguistics</em>, pp.  4791–4800, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2022)</span>
<span class="ltx_bibblock">
Susan Zhang, Stephen Roller, Naman Goyal, Mikel Artetxe, Moya Chen, Shuohui
Chen, Christopher Dewan, Mona Diab, Xian Li, Xi Victoria Lin, Todor Mihaylov,
Myle Ott, Sam Shleifer, Kurt Shuster, Daniel Simig, Punit Singh Koura, Anjali
Sridhar, Tianlu Wang, and Luke Zettlemoyer.

</span>
<span class="ltx_bibblock">Opt: Open pre-trained transformer language models, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. (2024)</span>
<span class="ltx_bibblock">
Yilong Zhao, Chien-Yu Lin, Kan Zhu, Zihao Ye, Lequn Chen, Size Zheng, Luis
Ceze, Arvind Krishnamurthy, Tianqi Chen, and Baris Kasikci.

</span>
<span class="ltx_bibblock">Atom: Low-bit quantization for efficient and accurate llm serving.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">Proceedings of Machine Learning and Systems</em>, 6:196–209, 2024.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Appendix</h2>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Relation between compression ratio and number of basis vectors</h3>
<div class="ltx_para ltx_noindent" id="A1.SS1.p1">
<p class="ltx_p" id="A1.SS1.p1.4">Consider compressing <math alttext="n" class="ltx_Math" display="inline" id="A1.SS1.p1.1.m1.1"><semantics id="A1.SS1.p1.1.m1.1a"><mi id="A1.SS1.p1.1.m1.1.1" xref="A1.SS1.p1.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.1.m1.1b"><ci id="A1.SS1.p1.1.m1.1.1.cmml" xref="A1.SS1.p1.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.1.m1.1d">italic_n</annotation></semantics></math> weight matrices to x% of their original sizes. Assume each matrix have <math alttext="d_{1}" class="ltx_Math" display="inline" id="A1.SS1.p1.2.m2.1"><semantics id="A1.SS1.p1.2.m2.1a"><msub id="A1.SS1.p1.2.m2.1.1" xref="A1.SS1.p1.2.m2.1.1.cmml"><mi id="A1.SS1.p1.2.m2.1.1.2" xref="A1.SS1.p1.2.m2.1.1.2.cmml">d</mi><mn id="A1.SS1.p1.2.m2.1.1.3" xref="A1.SS1.p1.2.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.2.m2.1b"><apply id="A1.SS1.p1.2.m2.1.1.cmml" xref="A1.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.2.m2.1.1.1.cmml" xref="A1.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="A1.SS1.p1.2.m2.1.1.2.cmml" xref="A1.SS1.p1.2.m2.1.1.2">𝑑</ci><cn id="A1.SS1.p1.2.m2.1.1.3.cmml" type="integer" xref="A1.SS1.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.2.m2.1c">d_{1}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.2.m2.1d">italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> rows and <math alttext="d_{2}" class="ltx_Math" display="inline" id="A1.SS1.p1.3.m3.1"><semantics id="A1.SS1.p1.3.m3.1a"><msub id="A1.SS1.p1.3.m3.1.1" xref="A1.SS1.p1.3.m3.1.1.cmml"><mi id="A1.SS1.p1.3.m3.1.1.2" xref="A1.SS1.p1.3.m3.1.1.2.cmml">d</mi><mn id="A1.SS1.p1.3.m3.1.1.3" xref="A1.SS1.p1.3.m3.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.3.m3.1b"><apply id="A1.SS1.p1.3.m3.1.1.cmml" xref="A1.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.3.m3.1.1.1.cmml" xref="A1.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="A1.SS1.p1.3.m3.1.1.2.cmml" xref="A1.SS1.p1.3.m3.1.1.2">𝑑</ci><cn id="A1.SS1.p1.3.m3.1.1.3.cmml" type="integer" xref="A1.SS1.p1.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.3.m3.1c">d_{2}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.3.m3.1d">italic_d start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> columns. The number of basis vectors (<math alttext="k" class="ltx_Math" display="inline" id="A1.SS1.p1.4.m4.1"><semantics id="A1.SS1.p1.4.m4.1a"><mi id="A1.SS1.p1.4.m4.1.1" xref="A1.SS1.p1.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.4.m4.1b"><ci id="A1.SS1.p1.4.m4.1.1.cmml" xref="A1.SS1.p1.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.4.m4.1c">k</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.4.m4.1d">italic_k</annotation></semantics></math>) can be calculated as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="d_{1}k+kd_{2}n=d_{1}d_{2}n\times x\%\Rightarrow k=\frac{d_{1}d_{2}n\times x\%}%
{(d_{1}+d_{2}n)}" class="ltx_Math" display="block" id="A1.Ex1.m1.1"><semantics id="A1.Ex1.m1.1a"><mrow id="A1.Ex1.m1.1.2" xref="A1.Ex1.m1.1.2.cmml"><mrow id="A1.Ex1.m1.1.2.2" xref="A1.Ex1.m1.1.2.2.cmml"><mrow id="A1.Ex1.m1.1.2.2.2" xref="A1.Ex1.m1.1.2.2.2.cmml"><msub id="A1.Ex1.m1.1.2.2.2.2" xref="A1.Ex1.m1.1.2.2.2.2.cmml"><mi id="A1.Ex1.m1.1.2.2.2.2.2" xref="A1.Ex1.m1.1.2.2.2.2.2.cmml">d</mi><mn id="A1.Ex1.m1.1.2.2.2.2.3" xref="A1.Ex1.m1.1.2.2.2.2.3.cmml">1</mn></msub><mo id="A1.Ex1.m1.1.2.2.2.1" xref="A1.Ex1.m1.1.2.2.2.1.cmml">⁢</mo><mi id="A1.Ex1.m1.1.2.2.2.3" xref="A1.Ex1.m1.1.2.2.2.3.cmml">k</mi></mrow><mo id="A1.Ex1.m1.1.2.2.1" xref="A1.Ex1.m1.1.2.2.1.cmml">+</mo><mrow id="A1.Ex1.m1.1.2.2.3" xref="A1.Ex1.m1.1.2.2.3.cmml"><mi id="A1.Ex1.m1.1.2.2.3.2" xref="A1.Ex1.m1.1.2.2.3.2.cmml">k</mi><mo id="A1.Ex1.m1.1.2.2.3.1" xref="A1.Ex1.m1.1.2.2.3.1.cmml">⁢</mo><msub id="A1.Ex1.m1.1.2.2.3.3" xref="A1.Ex1.m1.1.2.2.3.3.cmml"><mi id="A1.Ex1.m1.1.2.2.3.3.2" xref="A1.Ex1.m1.1.2.2.3.3.2.cmml">d</mi><mn id="A1.Ex1.m1.1.2.2.3.3.3" xref="A1.Ex1.m1.1.2.2.3.3.3.cmml">2</mn></msub><mo id="A1.Ex1.m1.1.2.2.3.1a" xref="A1.Ex1.m1.1.2.2.3.1.cmml">⁢</mo><mi id="A1.Ex1.m1.1.2.2.3.4" xref="A1.Ex1.m1.1.2.2.3.4.cmml">n</mi></mrow></mrow><mo id="A1.Ex1.m1.1.2.3" xref="A1.Ex1.m1.1.2.3.cmml">=</mo><mrow id="A1.Ex1.m1.1.2.4" xref="A1.Ex1.m1.1.2.4.cmml"><mrow id="A1.Ex1.m1.1.2.4.2" xref="A1.Ex1.m1.1.2.4.2.cmml"><msub id="A1.Ex1.m1.1.2.4.2.2" xref="A1.Ex1.m1.1.2.4.2.2.cmml"><mi id="A1.Ex1.m1.1.2.4.2.2.2" xref="A1.Ex1.m1.1.2.4.2.2.2.cmml">d</mi><mn id="A1.Ex1.m1.1.2.4.2.2.3" xref="A1.Ex1.m1.1.2.4.2.2.3.cmml">1</mn></msub><mo id="A1.Ex1.m1.1.2.4.2.1" xref="A1.Ex1.m1.1.2.4.2.1.cmml">⁢</mo><msub id="A1.Ex1.m1.1.2.4.2.3" xref="A1.Ex1.m1.1.2.4.2.3.cmml"><mi id="A1.Ex1.m1.1.2.4.2.3.2" xref="A1.Ex1.m1.1.2.4.2.3.2.cmml">d</mi><mn id="A1.Ex1.m1.1.2.4.2.3.3" xref="A1.Ex1.m1.1.2.4.2.3.3.cmml">2</mn></msub><mo id="A1.Ex1.m1.1.2.4.2.1a" xref="A1.Ex1.m1.1.2.4.2.1.cmml">⁢</mo><mi id="A1.Ex1.m1.1.2.4.2.4" xref="A1.Ex1.m1.1.2.4.2.4.cmml">n</mi></mrow><mo id="A1.Ex1.m1.1.2.4.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex1.m1.1.2.4.1.cmml">×</mo><mrow id="A1.Ex1.m1.1.2.4.3" xref="A1.Ex1.m1.1.2.4.3.cmml"><mi id="A1.Ex1.m1.1.2.4.3.2" xref="A1.Ex1.m1.1.2.4.3.2.cmml">x</mi><mo id="A1.Ex1.m1.1.2.4.3.1" xref="A1.Ex1.m1.1.2.4.3.1.cmml">%</mo></mrow></mrow><mo id="A1.Ex1.m1.1.2.5" stretchy="false" xref="A1.Ex1.m1.1.2.5.cmml">⇒</mo><mi id="A1.Ex1.m1.1.2.6" xref="A1.Ex1.m1.1.2.6.cmml">k</mi><mo id="A1.Ex1.m1.1.2.7" xref="A1.Ex1.m1.1.2.7.cmml">=</mo><mfrac id="A1.Ex1.m1.1.1" xref="A1.Ex1.m1.1.1.cmml"><mrow id="A1.Ex1.m1.1.1.3" xref="A1.Ex1.m1.1.1.3.cmml"><mrow id="A1.Ex1.m1.1.1.3.2" xref="A1.Ex1.m1.1.1.3.2.cmml"><msub id="A1.Ex1.m1.1.1.3.2.2" xref="A1.Ex1.m1.1.1.3.2.2.cmml"><mi id="A1.Ex1.m1.1.1.3.2.2.2" xref="A1.Ex1.m1.1.1.3.2.2.2.cmml">d</mi><mn id="A1.Ex1.m1.1.1.3.2.2.3" xref="A1.Ex1.m1.1.1.3.2.2.3.cmml">1</mn></msub><mo id="A1.Ex1.m1.1.1.3.2.1" xref="A1.Ex1.m1.1.1.3.2.1.cmml">⁢</mo><msub id="A1.Ex1.m1.1.1.3.2.3" xref="A1.Ex1.m1.1.1.3.2.3.cmml"><mi id="A1.Ex1.m1.1.1.3.2.3.2" xref="A1.Ex1.m1.1.1.3.2.3.2.cmml">d</mi><mn id="A1.Ex1.m1.1.1.3.2.3.3" xref="A1.Ex1.m1.1.1.3.2.3.3.cmml">2</mn></msub><mo id="A1.Ex1.m1.1.1.3.2.1a" xref="A1.Ex1.m1.1.1.3.2.1.cmml">⁢</mo><mi id="A1.Ex1.m1.1.1.3.2.4" xref="A1.Ex1.m1.1.1.3.2.4.cmml">n</mi></mrow><mo id="A1.Ex1.m1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex1.m1.1.1.3.1.cmml">×</mo><mrow id="A1.Ex1.m1.1.1.3.3" xref="A1.Ex1.m1.1.1.3.3.cmml"><mi id="A1.Ex1.m1.1.1.3.3.2" xref="A1.Ex1.m1.1.1.3.3.2.cmml">x</mi><mo id="A1.Ex1.m1.1.1.3.3.1" xref="A1.Ex1.m1.1.1.3.3.1.cmml">%</mo></mrow></mrow><mrow id="A1.Ex1.m1.1.1.1.1" xref="A1.Ex1.m1.1.1.1.1.1.cmml"><mo id="A1.Ex1.m1.1.1.1.1.2" stretchy="false" xref="A1.Ex1.m1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex1.m1.1.1.1.1.1" xref="A1.Ex1.m1.1.1.1.1.1.cmml"><msub id="A1.Ex1.m1.1.1.1.1.1.2" xref="A1.Ex1.m1.1.1.1.1.1.2.cmml"><mi id="A1.Ex1.m1.1.1.1.1.1.2.2" xref="A1.Ex1.m1.1.1.1.1.1.2.2.cmml">d</mi><mn id="A1.Ex1.m1.1.1.1.1.1.2.3" xref="A1.Ex1.m1.1.1.1.1.1.2.3.cmml">1</mn></msub><mo id="A1.Ex1.m1.1.1.1.1.1.1" xref="A1.Ex1.m1.1.1.1.1.1.1.cmml">+</mo><mrow id="A1.Ex1.m1.1.1.1.1.1.3" xref="A1.Ex1.m1.1.1.1.1.1.3.cmml"><msub id="A1.Ex1.m1.1.1.1.1.1.3.2" xref="A1.Ex1.m1.1.1.1.1.1.3.2.cmml"><mi id="A1.Ex1.m1.1.1.1.1.1.3.2.2" xref="A1.Ex1.m1.1.1.1.1.1.3.2.2.cmml">d</mi><mn id="A1.Ex1.m1.1.1.1.1.1.3.2.3" xref="A1.Ex1.m1.1.1.1.1.1.3.2.3.cmml">2</mn></msub><mo id="A1.Ex1.m1.1.1.1.1.1.3.1" xref="A1.Ex1.m1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="A1.Ex1.m1.1.1.1.1.1.3.3" xref="A1.Ex1.m1.1.1.1.1.1.3.3.cmml">n</mi></mrow></mrow><mo id="A1.Ex1.m1.1.1.1.1.3" stretchy="false" xref="A1.Ex1.m1.1.1.1.1.1.cmml">)</mo></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex1.m1.1b"><apply id="A1.Ex1.m1.1.2.cmml" xref="A1.Ex1.m1.1.2"><and id="A1.Ex1.m1.1.2a.cmml" xref="A1.Ex1.m1.1.2"></and><apply id="A1.Ex1.m1.1.2b.cmml" xref="A1.Ex1.m1.1.2"><eq id="A1.Ex1.m1.1.2.3.cmml" xref="A1.Ex1.m1.1.2.3"></eq><apply id="A1.Ex1.m1.1.2.2.cmml" xref="A1.Ex1.m1.1.2.2"><plus id="A1.Ex1.m1.1.2.2.1.cmml" xref="A1.Ex1.m1.1.2.2.1"></plus><apply id="A1.Ex1.m1.1.2.2.2.cmml" xref="A1.Ex1.m1.1.2.2.2"><times id="A1.Ex1.m1.1.2.2.2.1.cmml" xref="A1.Ex1.m1.1.2.2.2.1"></times><apply id="A1.Ex1.m1.1.2.2.2.2.cmml" xref="A1.Ex1.m1.1.2.2.2.2"><csymbol cd="ambiguous" id="A1.Ex1.m1.1.2.2.2.2.1.cmml" xref="A1.Ex1.m1.1.2.2.2.2">subscript</csymbol><ci id="A1.Ex1.m1.1.2.2.2.2.2.cmml" xref="A1.Ex1.m1.1.2.2.2.2.2">𝑑</ci><cn id="A1.Ex1.m1.1.2.2.2.2.3.cmml" type="integer" xref="A1.Ex1.m1.1.2.2.2.2.3">1</cn></apply><ci id="A1.Ex1.m1.1.2.2.2.3.cmml" xref="A1.Ex1.m1.1.2.2.2.3">𝑘</ci></apply><apply id="A1.Ex1.m1.1.2.2.3.cmml" xref="A1.Ex1.m1.1.2.2.3"><times id="A1.Ex1.m1.1.2.2.3.1.cmml" xref="A1.Ex1.m1.1.2.2.3.1"></times><ci id="A1.Ex1.m1.1.2.2.3.2.cmml" xref="A1.Ex1.m1.1.2.2.3.2">𝑘</ci><apply id="A1.Ex1.m1.1.2.2.3.3.cmml" xref="A1.Ex1.m1.1.2.2.3.3"><csymbol cd="ambiguous" id="A1.Ex1.m1.1.2.2.3.3.1.cmml" xref="A1.Ex1.m1.1.2.2.3.3">subscript</csymbol><ci id="A1.Ex1.m1.1.2.2.3.3.2.cmml" xref="A1.Ex1.m1.1.2.2.3.3.2">𝑑</ci><cn id="A1.Ex1.m1.1.2.2.3.3.3.cmml" type="integer" xref="A1.Ex1.m1.1.2.2.3.3.3">2</cn></apply><ci id="A1.Ex1.m1.1.2.2.3.4.cmml" xref="A1.Ex1.m1.1.2.2.3.4">𝑛</ci></apply></apply><apply id="A1.Ex1.m1.1.2.4.cmml" xref="A1.Ex1.m1.1.2.4"><times id="A1.Ex1.m1.1.2.4.1.cmml" xref="A1.Ex1.m1.1.2.4.1"></times><apply id="A1.Ex1.m1.1.2.4.2.cmml" xref="A1.Ex1.m1.1.2.4.2"><times id="A1.Ex1.m1.1.2.4.2.1.cmml" xref="A1.Ex1.m1.1.2.4.2.1"></times><apply id="A1.Ex1.m1.1.2.4.2.2.cmml" xref="A1.Ex1.m1.1.2.4.2.2"><csymbol cd="ambiguous" id="A1.Ex1.m1.1.2.4.2.2.1.cmml" xref="A1.Ex1.m1.1.2.4.2.2">subscript</csymbol><ci id="A1.Ex1.m1.1.2.4.2.2.2.cmml" xref="A1.Ex1.m1.1.2.4.2.2.2">𝑑</ci><cn id="A1.Ex1.m1.1.2.4.2.2.3.cmml" type="integer" xref="A1.Ex1.m1.1.2.4.2.2.3">1</cn></apply><apply id="A1.Ex1.m1.1.2.4.2.3.cmml" xref="A1.Ex1.m1.1.2.4.2.3"><csymbol cd="ambiguous" id="A1.Ex1.m1.1.2.4.2.3.1.cmml" xref="A1.Ex1.m1.1.2.4.2.3">subscript</csymbol><ci id="A1.Ex1.m1.1.2.4.2.3.2.cmml" xref="A1.Ex1.m1.1.2.4.2.3.2">𝑑</ci><cn id="A1.Ex1.m1.1.2.4.2.3.3.cmml" type="integer" xref="A1.Ex1.m1.1.2.4.2.3.3">2</cn></apply><ci id="A1.Ex1.m1.1.2.4.2.4.cmml" xref="A1.Ex1.m1.1.2.4.2.4">𝑛</ci></apply><apply id="A1.Ex1.m1.1.2.4.3.cmml" xref="A1.Ex1.m1.1.2.4.3"><csymbol cd="latexml" id="A1.Ex1.m1.1.2.4.3.1.cmml" xref="A1.Ex1.m1.1.2.4.3.1">percent</csymbol><ci id="A1.Ex1.m1.1.2.4.3.2.cmml" xref="A1.Ex1.m1.1.2.4.3.2">𝑥</ci></apply></apply></apply><apply id="A1.Ex1.m1.1.2c.cmml" xref="A1.Ex1.m1.1.2"><ci id="A1.Ex1.m1.1.2.5.cmml" xref="A1.Ex1.m1.1.2.5">⇒</ci><share href="https://arxiv.org/html/2410.03765v1#A1.Ex1.m1.1.2.4.cmml" id="A1.Ex1.m1.1.2d.cmml" xref="A1.Ex1.m1.1.2"></share><ci id="A1.Ex1.m1.1.2.6.cmml" xref="A1.Ex1.m1.1.2.6">𝑘</ci></apply><apply id="A1.Ex1.m1.1.2e.cmml" xref="A1.Ex1.m1.1.2"><eq id="A1.Ex1.m1.1.2.7.cmml" xref="A1.Ex1.m1.1.2.7"></eq><share href="https://arxiv.org/html/2410.03765v1#A1.Ex1.m1.1.2.6.cmml" id="A1.Ex1.m1.1.2f.cmml" xref="A1.Ex1.m1.1.2"></share><apply id="A1.Ex1.m1.1.1.cmml" xref="A1.Ex1.m1.1.1"><divide id="A1.Ex1.m1.1.1.2.cmml" xref="A1.Ex1.m1.1.1"></divide><apply id="A1.Ex1.m1.1.1.3.cmml" xref="A1.Ex1.m1.1.1.3"><times id="A1.Ex1.m1.1.1.3.1.cmml" xref="A1.Ex1.m1.1.1.3.1"></times><apply id="A1.Ex1.m1.1.1.3.2.cmml" xref="A1.Ex1.m1.1.1.3.2"><times id="A1.Ex1.m1.1.1.3.2.1.cmml" xref="A1.Ex1.m1.1.1.3.2.1"></times><apply id="A1.Ex1.m1.1.1.3.2.2.cmml" xref="A1.Ex1.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="A1.Ex1.m1.1.1.3.2.2.1.cmml" xref="A1.Ex1.m1.1.1.3.2.2">subscript</csymbol><ci id="A1.Ex1.m1.1.1.3.2.2.2.cmml" xref="A1.Ex1.m1.1.1.3.2.2.2">𝑑</ci><cn id="A1.Ex1.m1.1.1.3.2.2.3.cmml" type="integer" xref="A1.Ex1.m1.1.1.3.2.2.3">1</cn></apply><apply id="A1.Ex1.m1.1.1.3.2.3.cmml" xref="A1.Ex1.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="A1.Ex1.m1.1.1.3.2.3.1.cmml" xref="A1.Ex1.m1.1.1.3.2.3">subscript</csymbol><ci id="A1.Ex1.m1.1.1.3.2.3.2.cmml" xref="A1.Ex1.m1.1.1.3.2.3.2">𝑑</ci><cn id="A1.Ex1.m1.1.1.3.2.3.3.cmml" type="integer" xref="A1.Ex1.m1.1.1.3.2.3.3">2</cn></apply><ci id="A1.Ex1.m1.1.1.3.2.4.cmml" xref="A1.Ex1.m1.1.1.3.2.4">𝑛</ci></apply><apply id="A1.Ex1.m1.1.1.3.3.cmml" xref="A1.Ex1.m1.1.1.3.3"><csymbol cd="latexml" id="A1.Ex1.m1.1.1.3.3.1.cmml" xref="A1.Ex1.m1.1.1.3.3.1">percent</csymbol><ci id="A1.Ex1.m1.1.1.3.3.2.cmml" xref="A1.Ex1.m1.1.1.3.3.2">𝑥</ci></apply></apply><apply id="A1.Ex1.m1.1.1.1.1.1.cmml" xref="A1.Ex1.m1.1.1.1.1"><plus id="A1.Ex1.m1.1.1.1.1.1.1.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1"></plus><apply id="A1.Ex1.m1.1.1.1.1.1.2.cmml" xref="A1.Ex1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex1.m1.1.1.1.1.1.2.1.cmml" xref="A1.Ex1.m1.1.1.1.1.1.2">subscript</csymbol><ci id="A1.Ex1.m1.1.1.1.1.1.2.2.cmml" xref="A1.Ex1.m1.1.1.1.1.1.2.2">𝑑</ci><cn id="A1.Ex1.m1.1.1.1.1.1.2.3.cmml" type="integer" xref="A1.Ex1.m1.1.1.1.1.1.2.3">1</cn></apply><apply id="A1.Ex1.m1.1.1.1.1.1.3.cmml" xref="A1.Ex1.m1.1.1.1.1.1.3"><times id="A1.Ex1.m1.1.1.1.1.1.3.1.cmml" xref="A1.Ex1.m1.1.1.1.1.1.3.1"></times><apply id="A1.Ex1.m1.1.1.1.1.1.3.2.cmml" xref="A1.Ex1.m1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.Ex1.m1.1.1.1.1.1.3.2.1.cmml" xref="A1.Ex1.m1.1.1.1.1.1.3.2">subscript</csymbol><ci id="A1.Ex1.m1.1.1.1.1.1.3.2.2.cmml" xref="A1.Ex1.m1.1.1.1.1.1.3.2.2">𝑑</ci><cn id="A1.Ex1.m1.1.1.1.1.1.3.2.3.cmml" type="integer" xref="A1.Ex1.m1.1.1.1.1.1.3.2.3">2</cn></apply><ci id="A1.Ex1.m1.1.1.1.1.1.3.3.cmml" xref="A1.Ex1.m1.1.1.1.1.1.3.3">𝑛</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex1.m1.1c">d_{1}k+kd_{2}n=d_{1}d_{2}n\times x\%\Rightarrow k=\frac{d_{1}d_{2}n\times x\%}%
{(d_{1}+d_{2}n)}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex1.m1.1d">italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT italic_k + italic_k italic_d start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT italic_n = italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT italic_n × italic_x % ⇒ italic_k = divide start_ARG italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT italic_n × italic_x % end_ARG start_ARG ( italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + italic_d start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT italic_n ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsection" id="A1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Share Error Heat Map</h3>
<div class="ltx_para ltx_noindent" id="A1.SS2.p1">
<p class="ltx_p" id="A1.SS2.p1.4">The Frobenius loss inccured by basis sharing for <math alttext="{\bm{W}}_{Q}" class="ltx_Math" display="inline" id="A1.SS2.p1.1.m1.1"><semantics id="A1.SS2.p1.1.m1.1a"><msub id="A1.SS2.p1.1.m1.1.1" xref="A1.SS2.p1.1.m1.1.1.cmml"><mi id="A1.SS2.p1.1.m1.1.1.2" xref="A1.SS2.p1.1.m1.1.1.2.cmml">𝑾</mi><mi id="A1.SS2.p1.1.m1.1.1.3" xref="A1.SS2.p1.1.m1.1.1.3.cmml">Q</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.1.m1.1b"><apply id="A1.SS2.p1.1.m1.1.1.cmml" xref="A1.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p1.1.m1.1.1.1.cmml" xref="A1.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="A1.SS2.p1.1.m1.1.1.2.cmml" xref="A1.SS2.p1.1.m1.1.1.2">𝑾</ci><ci id="A1.SS2.p1.1.m1.1.1.3.cmml" xref="A1.SS2.p1.1.m1.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.1.m1.1c">{\bm{W}}_{Q}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.1.m1.1d">bold_italic_W start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT</annotation></semantics></math>
, <math alttext="{\bm{W}}_{V}" class="ltx_Math" display="inline" id="A1.SS2.p1.2.m2.1"><semantics id="A1.SS2.p1.2.m2.1a"><msub id="A1.SS2.p1.2.m2.1.1" xref="A1.SS2.p1.2.m2.1.1.cmml"><mi id="A1.SS2.p1.2.m2.1.1.2" xref="A1.SS2.p1.2.m2.1.1.2.cmml">𝑾</mi><mi id="A1.SS2.p1.2.m2.1.1.3" xref="A1.SS2.p1.2.m2.1.1.3.cmml">V</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.2.m2.1b"><apply id="A1.SS2.p1.2.m2.1.1.cmml" xref="A1.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS2.p1.2.m2.1.1.1.cmml" xref="A1.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="A1.SS2.p1.2.m2.1.1.2.cmml" xref="A1.SS2.p1.2.m2.1.1.2">𝑾</ci><ci id="A1.SS2.p1.2.m2.1.1.3.cmml" xref="A1.SS2.p1.2.m2.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.2.m2.1c">{\bm{W}}_{V}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.2.m2.1d">bold_italic_W start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="{\bm{W}}_{Up}" class="ltx_Math" display="inline" id="A1.SS2.p1.3.m3.1"><semantics id="A1.SS2.p1.3.m3.1a"><msub id="A1.SS2.p1.3.m3.1.1" xref="A1.SS2.p1.3.m3.1.1.cmml"><mi id="A1.SS2.p1.3.m3.1.1.2" xref="A1.SS2.p1.3.m3.1.1.2.cmml">𝑾</mi><mrow id="A1.SS2.p1.3.m3.1.1.3" xref="A1.SS2.p1.3.m3.1.1.3.cmml"><mi id="A1.SS2.p1.3.m3.1.1.3.2" xref="A1.SS2.p1.3.m3.1.1.3.2.cmml">U</mi><mo id="A1.SS2.p1.3.m3.1.1.3.1" xref="A1.SS2.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="A1.SS2.p1.3.m3.1.1.3.3" xref="A1.SS2.p1.3.m3.1.1.3.3.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.3.m3.1b"><apply id="A1.SS2.p1.3.m3.1.1.cmml" xref="A1.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A1.SS2.p1.3.m3.1.1.1.cmml" xref="A1.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="A1.SS2.p1.3.m3.1.1.2.cmml" xref="A1.SS2.p1.3.m3.1.1.2">𝑾</ci><apply id="A1.SS2.p1.3.m3.1.1.3.cmml" xref="A1.SS2.p1.3.m3.1.1.3"><times id="A1.SS2.p1.3.m3.1.1.3.1.cmml" xref="A1.SS2.p1.3.m3.1.1.3.1"></times><ci id="A1.SS2.p1.3.m3.1.1.3.2.cmml" xref="A1.SS2.p1.3.m3.1.1.3.2">𝑈</ci><ci id="A1.SS2.p1.3.m3.1.1.3.3.cmml" xref="A1.SS2.p1.3.m3.1.1.3.3">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.3.m3.1c">{\bm{W}}_{Up}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.3.m3.1d">bold_italic_W start_POSTSUBSCRIPT italic_U italic_p end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="{\bm{W}}_{Gate}" class="ltx_Math" display="inline" id="A1.SS2.p1.4.m4.1"><semantics id="A1.SS2.p1.4.m4.1a"><msub id="A1.SS2.p1.4.m4.1.1" xref="A1.SS2.p1.4.m4.1.1.cmml"><mi id="A1.SS2.p1.4.m4.1.1.2" xref="A1.SS2.p1.4.m4.1.1.2.cmml">𝑾</mi><mrow id="A1.SS2.p1.4.m4.1.1.3" xref="A1.SS2.p1.4.m4.1.1.3.cmml"><mi id="A1.SS2.p1.4.m4.1.1.3.2" xref="A1.SS2.p1.4.m4.1.1.3.2.cmml">G</mi><mo id="A1.SS2.p1.4.m4.1.1.3.1" xref="A1.SS2.p1.4.m4.1.1.3.1.cmml">⁢</mo><mi id="A1.SS2.p1.4.m4.1.1.3.3" xref="A1.SS2.p1.4.m4.1.1.3.3.cmml">a</mi><mo id="A1.SS2.p1.4.m4.1.1.3.1a" xref="A1.SS2.p1.4.m4.1.1.3.1.cmml">⁢</mo><mi id="A1.SS2.p1.4.m4.1.1.3.4" xref="A1.SS2.p1.4.m4.1.1.3.4.cmml">t</mi><mo id="A1.SS2.p1.4.m4.1.1.3.1b" xref="A1.SS2.p1.4.m4.1.1.3.1.cmml">⁢</mo><mi id="A1.SS2.p1.4.m4.1.1.3.5" xref="A1.SS2.p1.4.m4.1.1.3.5.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.4.m4.1b"><apply id="A1.SS2.p1.4.m4.1.1.cmml" xref="A1.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="A1.SS2.p1.4.m4.1.1.1.cmml" xref="A1.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="A1.SS2.p1.4.m4.1.1.2.cmml" xref="A1.SS2.p1.4.m4.1.1.2">𝑾</ci><apply id="A1.SS2.p1.4.m4.1.1.3.cmml" xref="A1.SS2.p1.4.m4.1.1.3"><times id="A1.SS2.p1.4.m4.1.1.3.1.cmml" xref="A1.SS2.p1.4.m4.1.1.3.1"></times><ci id="A1.SS2.p1.4.m4.1.1.3.2.cmml" xref="A1.SS2.p1.4.m4.1.1.3.2">𝐺</ci><ci id="A1.SS2.p1.4.m4.1.1.3.3.cmml" xref="A1.SS2.p1.4.m4.1.1.3.3">𝑎</ci><ci id="A1.SS2.p1.4.m4.1.1.3.4.cmml" xref="A1.SS2.p1.4.m4.1.1.3.4">𝑡</ci><ci id="A1.SS2.p1.4.m4.1.1.3.5.cmml" xref="A1.SS2.p1.4.m4.1.1.3.5">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.4.m4.1c">{\bm{W}}_{Gate}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.4.m4.1d">bold_italic_W start_POSTSUBSCRIPT italic_G italic_a italic_t italic_e end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<figure class="ltx_figure" id="A1.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="573" id="A1.F7.g1" src="x7.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Frobenius loss incurred by basis sharing across any two layers. The number/color in a block represents the resulting Frobenius loss if a basis matrix is shared by
two layers and the numbers in the diagonal direction are obtained by applying SVD to the scaled
weight matrix of a layer directly. (a) Frobenius loss incurred by basis sharing across two layers for <math alttext="{\bm{W}}_{Q}" class="ltx_Math" display="inline" id="A1.F7.3.m1.1"><semantics id="A1.F7.3.m1.1b"><msub id="A1.F7.3.m1.1.1" xref="A1.F7.3.m1.1.1.cmml"><mi id="A1.F7.3.m1.1.1.2" xref="A1.F7.3.m1.1.1.2.cmml">𝑾</mi><mi id="A1.F7.3.m1.1.1.3" xref="A1.F7.3.m1.1.1.3.cmml">Q</mi></msub><annotation-xml encoding="MathML-Content" id="A1.F7.3.m1.1c"><apply id="A1.F7.3.m1.1.1.cmml" xref="A1.F7.3.m1.1.1"><csymbol cd="ambiguous" id="A1.F7.3.m1.1.1.1.cmml" xref="A1.F7.3.m1.1.1">subscript</csymbol><ci id="A1.F7.3.m1.1.1.2.cmml" xref="A1.F7.3.m1.1.1.2">𝑾</ci><ci id="A1.F7.3.m1.1.1.3.cmml" xref="A1.F7.3.m1.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F7.3.m1.1d">{\bm{W}}_{Q}</annotation><annotation encoding="application/x-llamapun" id="A1.F7.3.m1.1e">bold_italic_W start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT</annotation></semantics></math> in LLaMA2-7B. (b) Frobenius loss incurred by basis sharing across two layers for <math alttext="{\bm{W}}_{V}" class="ltx_Math" display="inline" id="A1.F7.4.m2.1"><semantics id="A1.F7.4.m2.1b"><msub id="A1.F7.4.m2.1.1" xref="A1.F7.4.m2.1.1.cmml"><mi id="A1.F7.4.m2.1.1.2" xref="A1.F7.4.m2.1.1.2.cmml">𝑾</mi><mi id="A1.F7.4.m2.1.1.3" xref="A1.F7.4.m2.1.1.3.cmml">V</mi></msub><annotation-xml encoding="MathML-Content" id="A1.F7.4.m2.1c"><apply id="A1.F7.4.m2.1.1.cmml" xref="A1.F7.4.m2.1.1"><csymbol cd="ambiguous" id="A1.F7.4.m2.1.1.1.cmml" xref="A1.F7.4.m2.1.1">subscript</csymbol><ci id="A1.F7.4.m2.1.1.2.cmml" xref="A1.F7.4.m2.1.1.2">𝑾</ci><ci id="A1.F7.4.m2.1.1.3.cmml" xref="A1.F7.4.m2.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F7.4.m2.1d">{\bm{W}}_{V}</annotation><annotation encoding="application/x-llamapun" id="A1.F7.4.m2.1e">bold_italic_W start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT</annotation></semantics></math> in LLaMA2-7B.</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
<figure class="ltx_figure" id="A1.F8"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="573" id="A1.F8.g1" src="x8.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Frobenius loss incurred by basis sharing across any two layers. The number/color in a block represents the resulting Frobenius loss if a basis matrix is shared by
two layers and the numbers in the diagonal direction are obtained by applying SVD to the scaled
weight matrix of a layer directly. (a) Frobenius loss incurred by basis sharing across two layers for <math alttext="{\bm{W}}_{Up}" class="ltx_Math" display="inline" id="A1.F8.3.m1.1"><semantics id="A1.F8.3.m1.1b"><msub id="A1.F8.3.m1.1.1" xref="A1.F8.3.m1.1.1.cmml"><mi id="A1.F8.3.m1.1.1.2" xref="A1.F8.3.m1.1.1.2.cmml">𝑾</mi><mrow id="A1.F8.3.m1.1.1.3" xref="A1.F8.3.m1.1.1.3.cmml"><mi id="A1.F8.3.m1.1.1.3.2" xref="A1.F8.3.m1.1.1.3.2.cmml">U</mi><mo id="A1.F8.3.m1.1.1.3.1" xref="A1.F8.3.m1.1.1.3.1.cmml">⁢</mo><mi id="A1.F8.3.m1.1.1.3.3" xref="A1.F8.3.m1.1.1.3.3.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.F8.3.m1.1c"><apply id="A1.F8.3.m1.1.1.cmml" xref="A1.F8.3.m1.1.1"><csymbol cd="ambiguous" id="A1.F8.3.m1.1.1.1.cmml" xref="A1.F8.3.m1.1.1">subscript</csymbol><ci id="A1.F8.3.m1.1.1.2.cmml" xref="A1.F8.3.m1.1.1.2">𝑾</ci><apply id="A1.F8.3.m1.1.1.3.cmml" xref="A1.F8.3.m1.1.1.3"><times id="A1.F8.3.m1.1.1.3.1.cmml" xref="A1.F8.3.m1.1.1.3.1"></times><ci id="A1.F8.3.m1.1.1.3.2.cmml" xref="A1.F8.3.m1.1.1.3.2">𝑈</ci><ci id="A1.F8.3.m1.1.1.3.3.cmml" xref="A1.F8.3.m1.1.1.3.3">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F8.3.m1.1d">{\bm{W}}_{Up}</annotation><annotation encoding="application/x-llamapun" id="A1.F8.3.m1.1e">bold_italic_W start_POSTSUBSCRIPT italic_U italic_p end_POSTSUBSCRIPT</annotation></semantics></math> in LLaMA2-7B. (b) Frobenius loss incurred by basis sharing across two layers for <math alttext="{\bm{W}}_{Gate}" class="ltx_Math" display="inline" id="A1.F8.4.m2.1"><semantics id="A1.F8.4.m2.1b"><msub id="A1.F8.4.m2.1.1" xref="A1.F8.4.m2.1.1.cmml"><mi id="A1.F8.4.m2.1.1.2" xref="A1.F8.4.m2.1.1.2.cmml">𝑾</mi><mrow id="A1.F8.4.m2.1.1.3" xref="A1.F8.4.m2.1.1.3.cmml"><mi id="A1.F8.4.m2.1.1.3.2" xref="A1.F8.4.m2.1.1.3.2.cmml">G</mi><mo id="A1.F8.4.m2.1.1.3.1" xref="A1.F8.4.m2.1.1.3.1.cmml">⁢</mo><mi id="A1.F8.4.m2.1.1.3.3" xref="A1.F8.4.m2.1.1.3.3.cmml">a</mi><mo id="A1.F8.4.m2.1.1.3.1b" xref="A1.F8.4.m2.1.1.3.1.cmml">⁢</mo><mi id="A1.F8.4.m2.1.1.3.4" xref="A1.F8.4.m2.1.1.3.4.cmml">t</mi><mo id="A1.F8.4.m2.1.1.3.1c" xref="A1.F8.4.m2.1.1.3.1.cmml">⁢</mo><mi id="A1.F8.4.m2.1.1.3.5" xref="A1.F8.4.m2.1.1.3.5.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.F8.4.m2.1c"><apply id="A1.F8.4.m2.1.1.cmml" xref="A1.F8.4.m2.1.1"><csymbol cd="ambiguous" id="A1.F8.4.m2.1.1.1.cmml" xref="A1.F8.4.m2.1.1">subscript</csymbol><ci id="A1.F8.4.m2.1.1.2.cmml" xref="A1.F8.4.m2.1.1.2">𝑾</ci><apply id="A1.F8.4.m2.1.1.3.cmml" xref="A1.F8.4.m2.1.1.3"><times id="A1.F8.4.m2.1.1.3.1.cmml" xref="A1.F8.4.m2.1.1.3.1"></times><ci id="A1.F8.4.m2.1.1.3.2.cmml" xref="A1.F8.4.m2.1.1.3.2">𝐺</ci><ci id="A1.F8.4.m2.1.1.3.3.cmml" xref="A1.F8.4.m2.1.1.3.3">𝑎</ci><ci id="A1.F8.4.m2.1.1.3.4.cmml" xref="A1.F8.4.m2.1.1.3.4">𝑡</ci><ci id="A1.F8.4.m2.1.1.3.5.cmml" xref="A1.F8.4.m2.1.1.3.5">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F8.4.m2.1d">{\bm{W}}_{Gate}</annotation><annotation encoding="application/x-llamapun" id="A1.F8.4.m2.1e">bold_italic_W start_POSTSUBSCRIPT italic_G italic_a italic_t italic_e end_POSTSUBSCRIPT</annotation></semantics></math> in LLaMA2-7B.</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Wed Oct  2 14:27:48 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
