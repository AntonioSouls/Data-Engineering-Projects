<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2309.00434] Improving the matching of deformable objects by learning to detect keypoints</title><meta property="og:description" content="We propose a novel learned keypoint detection method to increase the number of correct matches for the task of non-rigid image correspondence. By leveraging true correspondences acquired by matching annotated image pai…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Improving the matching of deformable objects by learning to detect keypoints">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Improving the matching of deformable objects by learning to detect keypoints">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2309.00434">

<!--Generated on Wed Feb 28 06:02:49 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_fleqn">
<h1 class="ltx_title ltx_title_document" lang="en">Improving the matching of deformable objects by learning to detect keypoints</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname" lang="en">Felipe Cadar
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email" lang="en"><a href="mailto:cadar@dcc.ufmg.br">cadar@dcc.ufmg.br</a>
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname" lang="en">Welerson Melo
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email" lang="en"><a href="mailto:welerson.melo@dcc.ufmg.br">welerson.melo@dcc.ufmg.br</a>
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname" lang="en">Vaishnavi Kanagasabapathi
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email" lang="en"><a href="mailto:Vaishnavi_Kanagasabapathi@etu.u-bourgogne.fr">Vaishnavi_Kanagasabapathi@etu.u-bourgogne.fr</a>
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname" lang="en">Guilherme Potje
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email" lang="en"><a href="mailto:guipotje@dcc.ufmg.br">guipotje@dcc.ufmg.br</a>
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname" lang="en">Renato Martins
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email" lang="en"><a href="mailto:renato.martins@u-bourgogne.fr">renato.martins@u-bourgogne.fr</a>
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname" lang="en">Erickson R. Nascimento
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email" lang="en"><a href="mailto:erickson@dcc.ufmg.br">erickson@dcc.ufmg.br</a>
</span>
<span class="ltx_contact ltx_role_address" lang="en">Department of Computer Science, Universidade Federal de Minas Gerais, Brazil
</span>
<span class="ltx_contact ltx_role_address" lang="en">Laboratoire Interdisciplinaire Carnot de Bourgogne, UMR 6303 CNRS, Université de Bourgogne, France
</span>
<span class="ltx_contact ltx_role_address" lang="en">TANGRAM team, LORIA, Inria, Université de Lorraine, France
</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.1" class="ltx_p"><span id="id1.1.1" class="ltx_text" lang="en">We propose a novel learned keypoint detection method to increase the number of correct matches for the task of non-rigid image correspondence. By leveraging true correspondences acquired by matching annotated image pairs with a specified descriptor extractor, we train an end-to-end convolutional neural network (CNN) to find keypoint locations that are more appropriate to the considered descriptor. Experiments demonstrate that our method enhances the Mean Matching Accuracy of numerous descriptors when used in conjunction with our detection method, while outperforming the state-of-the-art keypoint detectors on real images of non-rigid objects by <math id="id1.1.1.m1.1" class="ltx_Math" alttext="20" display="inline"><semantics id="id1.1.1.m1.1a"><mn id="id1.1.1.m1.1.1" xref="id1.1.1.m1.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="id1.1.1.m1.1b"><cn type="integer" id="id1.1.1.m1.1.1.cmml" xref="id1.1.1.m1.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="id1.1.1.m1.1c">20</annotation></semantics></math> p.p. We also apply our method on the complex real-world task of object retrieval where our detector performs on par with the finest keypoint detectors currently available for this task. The source code and trained models are publicly available at <a target="_blank" href="https://github.com/verlab/LearningToDetect_PRL_2023" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/verlab/LearningToDetect_PRL_2023</a></span></p>
</div>
<div class="ltx_classification">
<h6 class="ltx_title ltx_title_classification">keywords: </h6>
<span id="id2.id1" class="ltx_text" lang="en">
<span id="id2.id1.1" class="ltx_text ltx_font_italic">Keywords</span>: 
<br class="ltx_break">Detector , Local Features , Non-rigid Deformations , Image Matching
</span>
</div>
<div id="p1" class="ltx_para">
<span id="p1.1" class="ltx_ERROR undefined">\useunder</span>
<p id="p1.2" class="ltx_p"><span id="p1.2.1" class="ltx_text ltx_ulem_uline"></span><span id="p1.2.2" class="ltx_ERROR undefined">\ul</span>










<span id="p1.2.3" class="ltx_text" lang="en"></span></p>
</div>
<section id="S1" class="ltx_section" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Finding discriminative patterns that are repeatable across various images of the same scene is the primary goal of keypoint detectors. A good detector should be equivariant to changes in viewpoint and scale as well as invariant to changes in illumination. Furthermore, objects may change in shape over time due to deformations. Therefore, equivariance to non-rigid deformations is an important property when identifying points for visual correspondence.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.5" class="ltx_p">Recently, learning-based systems <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> have become more prevalent in feature detection techniques, producing outcomes that greatly exceed handcrafted keypoint detectors <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>.
Despite the advances in learning feature representations, end-to-end learning of keypoint detection is still a challenging problem. Typically, a learned keypoint detector is trained to find recurring patterns across images. However, this approach does not ensure that the detected points are good for matching.
For instance, consider the high degree of ambiguity in texture while matching points on edges and repetitive patterns, <span id="S1.p2.5.1" class="ltx_text ltx_font_italic">e.g</span>.<span id="S1.p2.5.2" class="ltx_text"></span>, structures that commonly appear in man-made buildings. In regions where accurate matching is not achievable <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, methods that first detect keypoints before describing them often degrade the matching performance. Moreover, it is computationally infeasible to bypass detection by dense matching, i.e., matching all pixels <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>. The time complexity to match two images <math id="S1.p2.1.m1.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S1.p2.1.m1.1a"><mi id="S1.p2.1.m1.1.1" xref="S1.p2.1.m1.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S1.p2.1.m1.1b"><ci id="S1.p2.1.m1.1.1.cmml" xref="S1.p2.1.m1.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.1.m1.1c">A</annotation></semantics></math> and <math id="S1.p2.2.m2.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S1.p2.2.m2.1a"><mi id="S1.p2.2.m2.1.1" xref="S1.p2.2.m2.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S1.p2.2.m2.1b"><ci id="S1.p2.2.m2.1.1.cmml" xref="S1.p2.2.m2.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.2.m2.1c">B</annotation></semantics></math> using feature sets <math id="S1.p2.3.m3.1" class="ltx_Math" alttext="F_{A}" display="inline"><semantics id="S1.p2.3.m3.1a"><msub id="S1.p2.3.m3.1.1" xref="S1.p2.3.m3.1.1.cmml"><mi id="S1.p2.3.m3.1.1.2" xref="S1.p2.3.m3.1.1.2.cmml">F</mi><mi id="S1.p2.3.m3.1.1.3" xref="S1.p2.3.m3.1.1.3.cmml">A</mi></msub><annotation-xml encoding="MathML-Content" id="S1.p2.3.m3.1b"><apply id="S1.p2.3.m3.1.1.cmml" xref="S1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S1.p2.3.m3.1.1.1.cmml" xref="S1.p2.3.m3.1.1">subscript</csymbol><ci id="S1.p2.3.m3.1.1.2.cmml" xref="S1.p2.3.m3.1.1.2">𝐹</ci><ci id="S1.p2.3.m3.1.1.3.cmml" xref="S1.p2.3.m3.1.1.3">𝐴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.3.m3.1c">F_{A}</annotation></semantics></math> and <math id="S1.p2.4.m4.1" class="ltx_Math" alttext="F_{B}" display="inline"><semantics id="S1.p2.4.m4.1a"><msub id="S1.p2.4.m4.1.1" xref="S1.p2.4.m4.1.1.cmml"><mi id="S1.p2.4.m4.1.1.2" xref="S1.p2.4.m4.1.1.2.cmml">F</mi><mi id="S1.p2.4.m4.1.1.3" xref="S1.p2.4.m4.1.1.3.cmml">B</mi></msub><annotation-xml encoding="MathML-Content" id="S1.p2.4.m4.1b"><apply id="S1.p2.4.m4.1.1.cmml" xref="S1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S1.p2.4.m4.1.1.1.cmml" xref="S1.p2.4.m4.1.1">subscript</csymbol><ci id="S1.p2.4.m4.1.1.2.cmml" xref="S1.p2.4.m4.1.1.2">𝐹</ci><ci id="S1.p2.4.m4.1.1.3.cmml" xref="S1.p2.4.m4.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.4.m4.1c">F_{B}</annotation></semantics></math> is <math id="S1.p2.5.m5.1" class="ltx_Math" alttext="O(|F_{A}|\cdot|F_{B}|)" display="inline"><semantics id="S1.p2.5.m5.1a"><mrow id="S1.p2.5.m5.1.1" xref="S1.p2.5.m5.1.1.cmml"><mi id="S1.p2.5.m5.1.1.3" xref="S1.p2.5.m5.1.1.3.cmml">O</mi><mo lspace="0em" rspace="0em" id="S1.p2.5.m5.1.1.2" xref="S1.p2.5.m5.1.1.2.cmml">​</mo><mrow id="S1.p2.5.m5.1.1.1.1" xref="S1.p2.5.m5.1.1.1.1.1.cmml"><mo stretchy="false" id="S1.p2.5.m5.1.1.1.1.2" xref="S1.p2.5.m5.1.1.1.1.1.cmml">(</mo><mrow id="S1.p2.5.m5.1.1.1.1.1" xref="S1.p2.5.m5.1.1.1.1.1.cmml"><mrow id="S1.p2.5.m5.1.1.1.1.1.1.1" xref="S1.p2.5.m5.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S1.p2.5.m5.1.1.1.1.1.1.1.2" xref="S1.p2.5.m5.1.1.1.1.1.1.2.1.cmml">|</mo><msub id="S1.p2.5.m5.1.1.1.1.1.1.1.1" xref="S1.p2.5.m5.1.1.1.1.1.1.1.1.cmml"><mi id="S1.p2.5.m5.1.1.1.1.1.1.1.1.2" xref="S1.p2.5.m5.1.1.1.1.1.1.1.1.2.cmml">F</mi><mi id="S1.p2.5.m5.1.1.1.1.1.1.1.1.3" xref="S1.p2.5.m5.1.1.1.1.1.1.1.1.3.cmml">A</mi></msub><mo rspace="0.055em" stretchy="false" id="S1.p2.5.m5.1.1.1.1.1.1.1.3" xref="S1.p2.5.m5.1.1.1.1.1.1.2.1.cmml">|</mo></mrow><mo rspace="0.222em" id="S1.p2.5.m5.1.1.1.1.1.3" xref="S1.p2.5.m5.1.1.1.1.1.3.cmml">⋅</mo><mrow id="S1.p2.5.m5.1.1.1.1.1.2.1" xref="S1.p2.5.m5.1.1.1.1.1.2.2.cmml"><mo stretchy="false" id="S1.p2.5.m5.1.1.1.1.1.2.1.2" xref="S1.p2.5.m5.1.1.1.1.1.2.2.1.cmml">|</mo><msub id="S1.p2.5.m5.1.1.1.1.1.2.1.1" xref="S1.p2.5.m5.1.1.1.1.1.2.1.1.cmml"><mi id="S1.p2.5.m5.1.1.1.1.1.2.1.1.2" xref="S1.p2.5.m5.1.1.1.1.1.2.1.1.2.cmml">F</mi><mi id="S1.p2.5.m5.1.1.1.1.1.2.1.1.3" xref="S1.p2.5.m5.1.1.1.1.1.2.1.1.3.cmml">B</mi></msub><mo stretchy="false" id="S1.p2.5.m5.1.1.1.1.1.2.1.3" xref="S1.p2.5.m5.1.1.1.1.1.2.2.1.cmml">|</mo></mrow></mrow><mo stretchy="false" id="S1.p2.5.m5.1.1.1.1.3" xref="S1.p2.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p2.5.m5.1b"><apply id="S1.p2.5.m5.1.1.cmml" xref="S1.p2.5.m5.1.1"><times id="S1.p2.5.m5.1.1.2.cmml" xref="S1.p2.5.m5.1.1.2"></times><ci id="S1.p2.5.m5.1.1.3.cmml" xref="S1.p2.5.m5.1.1.3">𝑂</ci><apply id="S1.p2.5.m5.1.1.1.1.1.cmml" xref="S1.p2.5.m5.1.1.1.1"><ci id="S1.p2.5.m5.1.1.1.1.1.3.cmml" xref="S1.p2.5.m5.1.1.1.1.1.3">⋅</ci><apply id="S1.p2.5.m5.1.1.1.1.1.1.2.cmml" xref="S1.p2.5.m5.1.1.1.1.1.1.1"><abs id="S1.p2.5.m5.1.1.1.1.1.1.2.1.cmml" xref="S1.p2.5.m5.1.1.1.1.1.1.1.2"></abs><apply id="S1.p2.5.m5.1.1.1.1.1.1.1.1.cmml" xref="S1.p2.5.m5.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S1.p2.5.m5.1.1.1.1.1.1.1.1.1.cmml" xref="S1.p2.5.m5.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S1.p2.5.m5.1.1.1.1.1.1.1.1.2.cmml" xref="S1.p2.5.m5.1.1.1.1.1.1.1.1.2">𝐹</ci><ci id="S1.p2.5.m5.1.1.1.1.1.1.1.1.3.cmml" xref="S1.p2.5.m5.1.1.1.1.1.1.1.1.3">𝐴</ci></apply></apply><apply id="S1.p2.5.m5.1.1.1.1.1.2.2.cmml" xref="S1.p2.5.m5.1.1.1.1.1.2.1"><abs id="S1.p2.5.m5.1.1.1.1.1.2.2.1.cmml" xref="S1.p2.5.m5.1.1.1.1.1.2.1.2"></abs><apply id="S1.p2.5.m5.1.1.1.1.1.2.1.1.cmml" xref="S1.p2.5.m5.1.1.1.1.1.2.1.1"><csymbol cd="ambiguous" id="S1.p2.5.m5.1.1.1.1.1.2.1.1.1.cmml" xref="S1.p2.5.m5.1.1.1.1.1.2.1.1">subscript</csymbol><ci id="S1.p2.5.m5.1.1.1.1.1.2.1.1.2.cmml" xref="S1.p2.5.m5.1.1.1.1.1.2.1.1.2">𝐹</ci><ci id="S1.p2.5.m5.1.1.1.1.1.2.1.1.3.cmml" xref="S1.p2.5.m5.1.1.1.1.1.2.1.1.3">𝐵</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.5.m5.1c">O(|F_{A}|\cdot|F_{B}|)</annotation></semantics></math>. The problem becomes intractable, requiring carefully designed training techniques and high computational resources. Dense matching also has to deal with the inherent ambiguity caused by poorly-textured regions and poor localization properties. Some methods, like LoFTR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>, rely on fewer confident matches at a lower resolution and propagate this more robust information of matching for neighboring pixels to higher resolutions. In this context, keypoint detection may be needed to improve dense matching. Few works have attempted to achieve equivariance regarding non-rigid deformations, and most recent advances in this direction, such as the work of Yu <span id="S1.p2.5.3" class="ltx_text ltx_font_italic">et al</span>.<span id="S1.p2.5.4" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, suggest using additional depth information. Still, color cameras are by far the most used and available imaging sensors.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Differently from these previous approaches, we propose a novel learned keypoint detection methodology for handling non-rigid deformations on still images (Figure <a href="#S3.F3" title="Figure 3 ‣ 3.3 Implementation details ‣ 3 Methodology ‣ Improving the matching of deformable objects by learning to detect keypoints" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows some qualitative results). In this work, we assume locally smooth non-rigid deformations, i.e., the gradient of the deformation field is locally continuous and does not have abrupt discontinuities. This implies that the nearby pixels from a point in the image should follow similar offsets from one image to another, which is a reasonable assumption for most real-world scenarios, especially when dealing with local features, because of their local receptive field. Inspired by DEAL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>, we model the deformations using Thin-plate Splines <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>, where one minimizes the bending energy of the deformation field by solving for an affine transformation and the Radial Basis Functions (RBFs) coefficients for the following energy function:</p>
</div>
<div id="S1.p4" class="ltx_para ltx_noindent">
<table id="S1.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S1.E1.m1.2" class="ltx_Math" alttext="E_{tps}(f)=\sum_{i=1}^{k}||\mathbf{y_{i}}-f(\mathbf{x_{i}})||^{2}," display="block"><semantics id="S1.E1.m1.2a"><mrow id="S1.E1.m1.2.2.1" xref="S1.E1.m1.2.2.1.1.cmml"><mrow id="S1.E1.m1.2.2.1.1" xref="S1.E1.m1.2.2.1.1.cmml"><mrow id="S1.E1.m1.2.2.1.1.3" xref="S1.E1.m1.2.2.1.1.3.cmml"><msub id="S1.E1.m1.2.2.1.1.3.2" xref="S1.E1.m1.2.2.1.1.3.2.cmml"><mi id="S1.E1.m1.2.2.1.1.3.2.2" xref="S1.E1.m1.2.2.1.1.3.2.2.cmml">E</mi><mrow id="S1.E1.m1.2.2.1.1.3.2.3" xref="S1.E1.m1.2.2.1.1.3.2.3.cmml"><mi id="S1.E1.m1.2.2.1.1.3.2.3.2" xref="S1.E1.m1.2.2.1.1.3.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S1.E1.m1.2.2.1.1.3.2.3.1" xref="S1.E1.m1.2.2.1.1.3.2.3.1.cmml">​</mo><mi id="S1.E1.m1.2.2.1.1.3.2.3.3" xref="S1.E1.m1.2.2.1.1.3.2.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S1.E1.m1.2.2.1.1.3.2.3.1a" xref="S1.E1.m1.2.2.1.1.3.2.3.1.cmml">​</mo><mi id="S1.E1.m1.2.2.1.1.3.2.3.4" xref="S1.E1.m1.2.2.1.1.3.2.3.4.cmml">s</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S1.E1.m1.2.2.1.1.3.1" xref="S1.E1.m1.2.2.1.1.3.1.cmml">​</mo><mrow id="S1.E1.m1.2.2.1.1.3.3.2" xref="S1.E1.m1.2.2.1.1.3.cmml"><mo stretchy="false" id="S1.E1.m1.2.2.1.1.3.3.2.1" xref="S1.E1.m1.2.2.1.1.3.cmml">(</mo><mi id="S1.E1.m1.1.1" xref="S1.E1.m1.1.1.cmml">f</mi><mo stretchy="false" id="S1.E1.m1.2.2.1.1.3.3.2.2" xref="S1.E1.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S1.E1.m1.2.2.1.1.2" xref="S1.E1.m1.2.2.1.1.2.cmml">=</mo><mrow id="S1.E1.m1.2.2.1.1.1" xref="S1.E1.m1.2.2.1.1.1.cmml"><munderover id="S1.E1.m1.2.2.1.1.1.2" xref="S1.E1.m1.2.2.1.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S1.E1.m1.2.2.1.1.1.2.2.2" xref="S1.E1.m1.2.2.1.1.1.2.2.2.cmml">∑</mo><mrow id="S1.E1.m1.2.2.1.1.1.2.2.3" xref="S1.E1.m1.2.2.1.1.1.2.2.3.cmml"><mi id="S1.E1.m1.2.2.1.1.1.2.2.3.2" xref="S1.E1.m1.2.2.1.1.1.2.2.3.2.cmml">i</mi><mo id="S1.E1.m1.2.2.1.1.1.2.2.3.1" xref="S1.E1.m1.2.2.1.1.1.2.2.3.1.cmml">=</mo><mn id="S1.E1.m1.2.2.1.1.1.2.2.3.3" xref="S1.E1.m1.2.2.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S1.E1.m1.2.2.1.1.1.2.3" xref="S1.E1.m1.2.2.1.1.1.2.3.cmml">k</mi></munderover><msup id="S1.E1.m1.2.2.1.1.1.1" xref="S1.E1.m1.2.2.1.1.1.1.cmml"><mrow id="S1.E1.m1.2.2.1.1.1.1.1.1" xref="S1.E1.m1.2.2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S1.E1.m1.2.2.1.1.1.1.1.1.2" xref="S1.E1.m1.2.2.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S1.E1.m1.2.2.1.1.1.1.1.1.1" xref="S1.E1.m1.2.2.1.1.1.1.1.1.1.cmml"><msub id="S1.E1.m1.2.2.1.1.1.1.1.1.1.3" xref="S1.E1.m1.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="S1.E1.m1.2.2.1.1.1.1.1.1.1.3.2" xref="S1.E1.m1.2.2.1.1.1.1.1.1.1.3.2.cmml">𝐲</mi><mi id="S1.E1.m1.2.2.1.1.1.1.1.1.1.3.3" xref="S1.E1.m1.2.2.1.1.1.1.1.1.1.3.3.cmml">𝐢</mi></msub><mo id="S1.E1.m1.2.2.1.1.1.1.1.1.1.2" xref="S1.E1.m1.2.2.1.1.1.1.1.1.1.2.cmml">−</mo><mrow id="S1.E1.m1.2.2.1.1.1.1.1.1.1.1" xref="S1.E1.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S1.E1.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S1.E1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S1.E1.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S1.E1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S1.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S1.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S1.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S1.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S1.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S1.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S1.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S1.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S1.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S1.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml">𝐢</mi></msub><mo stretchy="false" id="S1.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S1.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S1.E1.m1.2.2.1.1.1.1.1.1.3" xref="S1.E1.m1.2.2.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S1.E1.m1.2.2.1.1.1.1.3" xref="S1.E1.m1.2.2.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow><mo id="S1.E1.m1.2.2.1.2" xref="S1.E1.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.E1.m1.2b"><apply id="S1.E1.m1.2.2.1.1.cmml" xref="S1.E1.m1.2.2.1"><eq id="S1.E1.m1.2.2.1.1.2.cmml" xref="S1.E1.m1.2.2.1.1.2"></eq><apply id="S1.E1.m1.2.2.1.1.3.cmml" xref="S1.E1.m1.2.2.1.1.3"><times id="S1.E1.m1.2.2.1.1.3.1.cmml" xref="S1.E1.m1.2.2.1.1.3.1"></times><apply id="S1.E1.m1.2.2.1.1.3.2.cmml" xref="S1.E1.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S1.E1.m1.2.2.1.1.3.2.1.cmml" xref="S1.E1.m1.2.2.1.1.3.2">subscript</csymbol><ci id="S1.E1.m1.2.2.1.1.3.2.2.cmml" xref="S1.E1.m1.2.2.1.1.3.2.2">𝐸</ci><apply id="S1.E1.m1.2.2.1.1.3.2.3.cmml" xref="S1.E1.m1.2.2.1.1.3.2.3"><times id="S1.E1.m1.2.2.1.1.3.2.3.1.cmml" xref="S1.E1.m1.2.2.1.1.3.2.3.1"></times><ci id="S1.E1.m1.2.2.1.1.3.2.3.2.cmml" xref="S1.E1.m1.2.2.1.1.3.2.3.2">𝑡</ci><ci id="S1.E1.m1.2.2.1.1.3.2.3.3.cmml" xref="S1.E1.m1.2.2.1.1.3.2.3.3">𝑝</ci><ci id="S1.E1.m1.2.2.1.1.3.2.3.4.cmml" xref="S1.E1.m1.2.2.1.1.3.2.3.4">𝑠</ci></apply></apply><ci id="S1.E1.m1.1.1.cmml" xref="S1.E1.m1.1.1">𝑓</ci></apply><apply id="S1.E1.m1.2.2.1.1.1.cmml" xref="S1.E1.m1.2.2.1.1.1"><apply id="S1.E1.m1.2.2.1.1.1.2.cmml" xref="S1.E1.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S1.E1.m1.2.2.1.1.1.2.1.cmml" xref="S1.E1.m1.2.2.1.1.1.2">superscript</csymbol><apply id="S1.E1.m1.2.2.1.1.1.2.2.cmml" xref="S1.E1.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S1.E1.m1.2.2.1.1.1.2.2.1.cmml" xref="S1.E1.m1.2.2.1.1.1.2">subscript</csymbol><sum id="S1.E1.m1.2.2.1.1.1.2.2.2.cmml" xref="S1.E1.m1.2.2.1.1.1.2.2.2"></sum><apply id="S1.E1.m1.2.2.1.1.1.2.2.3.cmml" xref="S1.E1.m1.2.2.1.1.1.2.2.3"><eq id="S1.E1.m1.2.2.1.1.1.2.2.3.1.cmml" xref="S1.E1.m1.2.2.1.1.1.2.2.3.1"></eq><ci id="S1.E1.m1.2.2.1.1.1.2.2.3.2.cmml" xref="S1.E1.m1.2.2.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S1.E1.m1.2.2.1.1.1.2.2.3.3.cmml" xref="S1.E1.m1.2.2.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S1.E1.m1.2.2.1.1.1.2.3.cmml" xref="S1.E1.m1.2.2.1.1.1.2.3">𝑘</ci></apply><apply id="S1.E1.m1.2.2.1.1.1.1.cmml" xref="S1.E1.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S1.E1.m1.2.2.1.1.1.1.2.cmml" xref="S1.E1.m1.2.2.1.1.1.1">superscript</csymbol><apply id="S1.E1.m1.2.2.1.1.1.1.1.2.cmml" xref="S1.E1.m1.2.2.1.1.1.1.1.1"><csymbol cd="latexml" id="S1.E1.m1.2.2.1.1.1.1.1.2.1.cmml" xref="S1.E1.m1.2.2.1.1.1.1.1.1.2">norm</csymbol><apply id="S1.E1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S1.E1.m1.2.2.1.1.1.1.1.1.1"><minus id="S1.E1.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S1.E1.m1.2.2.1.1.1.1.1.1.1.2"></minus><apply id="S1.E1.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S1.E1.m1.2.2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S1.E1.m1.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S1.E1.m1.2.2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S1.E1.m1.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S1.E1.m1.2.2.1.1.1.1.1.1.1.3.2">𝐲</ci><ci id="S1.E1.m1.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="S1.E1.m1.2.2.1.1.1.1.1.1.1.3.3">𝐢</ci></apply><apply id="S1.E1.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S1.E1.m1.2.2.1.1.1.1.1.1.1.1"><times id="S1.E1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S1.E1.m1.2.2.1.1.1.1.1.1.1.1.2"></times><ci id="S1.E1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S1.E1.m1.2.2.1.1.1.1.1.1.1.1.3">𝑓</ci><apply id="S1.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S1.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S1.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S1.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S1.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S1.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S1.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S1.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3">𝐢</ci></apply></apply></apply></apply><cn type="integer" id="S1.E1.m1.2.2.1.1.1.1.3.cmml" xref="S1.E1.m1.2.2.1.1.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.E1.m1.2c">E_{tps}(f)=\sum_{i=1}^{k}||\mathbf{y_{i}}-f(\mathbf{x_{i}})||^{2},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S1.p4.6" class="ltx_p">where <math id="S1.p4.1.m1.1" class="ltx_Math" alttext="\mathbf{y_{i}}" display="inline"><semantics id="S1.p4.1.m1.1a"><msub id="S1.p4.1.m1.1.1" xref="S1.p4.1.m1.1.1.cmml"><mi id="S1.p4.1.m1.1.1.2" xref="S1.p4.1.m1.1.1.2.cmml">𝐲</mi><mi id="S1.p4.1.m1.1.1.3" xref="S1.p4.1.m1.1.1.3.cmml">𝐢</mi></msub><annotation-xml encoding="MathML-Content" id="S1.p4.1.m1.1b"><apply id="S1.p4.1.m1.1.1.cmml" xref="S1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S1.p4.1.m1.1.1.1.cmml" xref="S1.p4.1.m1.1.1">subscript</csymbol><ci id="S1.p4.1.m1.1.1.2.cmml" xref="S1.p4.1.m1.1.1.2">𝐲</ci><ci id="S1.p4.1.m1.1.1.3.cmml" xref="S1.p4.1.m1.1.1.3">𝐢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.1.m1.1c">\mathbf{y_{i}}</annotation></semantics></math> and <math id="S1.p4.2.m2.1" class="ltx_Math" alttext="\mathbf{x_{i}}" display="inline"><semantics id="S1.p4.2.m2.1a"><msub id="S1.p4.2.m2.1.1" xref="S1.p4.2.m2.1.1.cmml"><mi id="S1.p4.2.m2.1.1.2" xref="S1.p4.2.m2.1.1.2.cmml">𝐱</mi><mi id="S1.p4.2.m2.1.1.3" xref="S1.p4.2.m2.1.1.3.cmml">𝐢</mi></msub><annotation-xml encoding="MathML-Content" id="S1.p4.2.m2.1b"><apply id="S1.p4.2.m2.1.1.cmml" xref="S1.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S1.p4.2.m2.1.1.1.cmml" xref="S1.p4.2.m2.1.1">subscript</csymbol><ci id="S1.p4.2.m2.1.1.2.cmml" xref="S1.p4.2.m2.1.1.2">𝐱</ci><ci id="S1.p4.2.m2.1.1.3.cmml" xref="S1.p4.2.m2.1.1.3">𝐢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.2.m2.1c">\mathbf{x_{i}}</annotation></semantics></math> are two sets of corresponding points, also called control points, and <math id="S1.p4.3.m3.1" class="ltx_Math" alttext="f(\mathbf{x})" display="inline"><semantics id="S1.p4.3.m3.1a"><mrow id="S1.p4.3.m3.1.2" xref="S1.p4.3.m3.1.2.cmml"><mi id="S1.p4.3.m3.1.2.2" xref="S1.p4.3.m3.1.2.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S1.p4.3.m3.1.2.1" xref="S1.p4.3.m3.1.2.1.cmml">​</mo><mrow id="S1.p4.3.m3.1.2.3.2" xref="S1.p4.3.m3.1.2.cmml"><mo stretchy="false" id="S1.p4.3.m3.1.2.3.2.1" xref="S1.p4.3.m3.1.2.cmml">(</mo><mi id="S1.p4.3.m3.1.1" xref="S1.p4.3.m3.1.1.cmml">𝐱</mi><mo stretchy="false" id="S1.p4.3.m3.1.2.3.2.2" xref="S1.p4.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p4.3.m3.1b"><apply id="S1.p4.3.m3.1.2.cmml" xref="S1.p4.3.m3.1.2"><times id="S1.p4.3.m3.1.2.1.cmml" xref="S1.p4.3.m3.1.2.1"></times><ci id="S1.p4.3.m3.1.2.2.cmml" xref="S1.p4.3.m3.1.2.2">𝑓</ci><ci id="S1.p4.3.m3.1.1.cmml" xref="S1.p4.3.m3.1.1">𝐱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.3.m3.1c">f(\mathbf{x})</annotation></semantics></math> is the RBF that employs the TPS kernel. Once the affine matrix <math id="S1.p4.4.m4.1" class="ltx_Math" alttext="\mathbf{A}" display="inline"><semantics id="S1.p4.4.m4.1a"><mi id="S1.p4.4.m4.1.1" xref="S1.p4.4.m4.1.1.cmml">𝐀</mi><annotation-xml encoding="MathML-Content" id="S1.p4.4.m4.1b"><ci id="S1.p4.4.m4.1.1.cmml" xref="S1.p4.4.m4.1.1">𝐀</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.4.m4.1c">\mathbf{A}</annotation></semantics></math> and coefficients of <math id="S1.p4.5.m5.1" class="ltx_Math" alttext="\mathbf{w_{i}}\in\mathbb{R}^{2}" display="inline"><semantics id="S1.p4.5.m5.1a"><mrow id="S1.p4.5.m5.1.1" xref="S1.p4.5.m5.1.1.cmml"><msub id="S1.p4.5.m5.1.1.2" xref="S1.p4.5.m5.1.1.2.cmml"><mi id="S1.p4.5.m5.1.1.2.2" xref="S1.p4.5.m5.1.1.2.2.cmml">𝐰</mi><mi id="S1.p4.5.m5.1.1.2.3" xref="S1.p4.5.m5.1.1.2.3.cmml">𝐢</mi></msub><mo id="S1.p4.5.m5.1.1.1" xref="S1.p4.5.m5.1.1.1.cmml">∈</mo><msup id="S1.p4.5.m5.1.1.3" xref="S1.p4.5.m5.1.1.3.cmml"><mi id="S1.p4.5.m5.1.1.3.2" xref="S1.p4.5.m5.1.1.3.2.cmml">ℝ</mi><mn id="S1.p4.5.m5.1.1.3.3" xref="S1.p4.5.m5.1.1.3.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S1.p4.5.m5.1b"><apply id="S1.p4.5.m5.1.1.cmml" xref="S1.p4.5.m5.1.1"><in id="S1.p4.5.m5.1.1.1.cmml" xref="S1.p4.5.m5.1.1.1"></in><apply id="S1.p4.5.m5.1.1.2.cmml" xref="S1.p4.5.m5.1.1.2"><csymbol cd="ambiguous" id="S1.p4.5.m5.1.1.2.1.cmml" xref="S1.p4.5.m5.1.1.2">subscript</csymbol><ci id="S1.p4.5.m5.1.1.2.2.cmml" xref="S1.p4.5.m5.1.1.2.2">𝐰</ci><ci id="S1.p4.5.m5.1.1.2.3.cmml" xref="S1.p4.5.m5.1.1.2.3">𝐢</ci></apply><apply id="S1.p4.5.m5.1.1.3.cmml" xref="S1.p4.5.m5.1.1.3"><csymbol cd="ambiguous" id="S1.p4.5.m5.1.1.3.1.cmml" xref="S1.p4.5.m5.1.1.3">superscript</csymbol><ci id="S1.p4.5.m5.1.1.3.2.cmml" xref="S1.p4.5.m5.1.1.3.2">ℝ</ci><cn type="integer" id="S1.p4.5.m5.1.1.3.3.cmml" xref="S1.p4.5.m5.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.5.m5.1c">\mathbf{w_{i}}\in\mathbb{R}^{2}</annotation></semantics></math> are obtained, one can map a pixel <math id="S1.p4.6.m6.1" class="ltx_Math" alttext="\mathbf{x}" display="inline"><semantics id="S1.p4.6.m6.1a"><mi id="S1.p4.6.m6.1.1" xref="S1.p4.6.m6.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S1.p4.6.m6.1b"><ci id="S1.p4.6.m6.1.1.cmml" xref="S1.p4.6.m6.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.6.m6.1c">\mathbf{x}</annotation></semantics></math> from a reference frame to the target frame by using the TPS warp as follows:</p>
<table id="S1.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S1.E2.m1.2" class="ltx_Math" alttext="f(\mathbf{x})=\mathbf{Ax}+\sum_{i=1}^{n_{c}}\rho(||\mathbf{x}-\mathbf{c_{i}}||^{2})\mathbf{w_{i}}," display="block"><semantics id="S1.E2.m1.2a"><mrow id="S1.E2.m1.2.2.1" xref="S1.E2.m1.2.2.1.1.cmml"><mrow id="S1.E2.m1.2.2.1.1" xref="S1.E2.m1.2.2.1.1.cmml"><mrow id="S1.E2.m1.2.2.1.1.3" xref="S1.E2.m1.2.2.1.1.3.cmml"><mi id="S1.E2.m1.2.2.1.1.3.2" xref="S1.E2.m1.2.2.1.1.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S1.E2.m1.2.2.1.1.3.1" xref="S1.E2.m1.2.2.1.1.3.1.cmml">​</mo><mrow id="S1.E2.m1.2.2.1.1.3.3.2" xref="S1.E2.m1.2.2.1.1.3.cmml"><mo stretchy="false" id="S1.E2.m1.2.2.1.1.3.3.2.1" xref="S1.E2.m1.2.2.1.1.3.cmml">(</mo><mi id="S1.E2.m1.1.1" xref="S1.E2.m1.1.1.cmml">𝐱</mi><mo stretchy="false" id="S1.E2.m1.2.2.1.1.3.3.2.2" xref="S1.E2.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow><mo id="S1.E2.m1.2.2.1.1.2" xref="S1.E2.m1.2.2.1.1.2.cmml">=</mo><mrow id="S1.E2.m1.2.2.1.1.1" xref="S1.E2.m1.2.2.1.1.1.cmml"><mi id="S1.E2.m1.2.2.1.1.1.3" xref="S1.E2.m1.2.2.1.1.1.3.cmml">𝐀𝐱</mi><mo rspace="0.055em" id="S1.E2.m1.2.2.1.1.1.2" xref="S1.E2.m1.2.2.1.1.1.2.cmml">+</mo><mrow id="S1.E2.m1.2.2.1.1.1.1" xref="S1.E2.m1.2.2.1.1.1.1.cmml"><munderover id="S1.E2.m1.2.2.1.1.1.1.2" xref="S1.E2.m1.2.2.1.1.1.1.2.cmml"><mo movablelimits="false" id="S1.E2.m1.2.2.1.1.1.1.2.2.2" xref="S1.E2.m1.2.2.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S1.E2.m1.2.2.1.1.1.1.2.2.3" xref="S1.E2.m1.2.2.1.1.1.1.2.2.3.cmml"><mi id="S1.E2.m1.2.2.1.1.1.1.2.2.3.2" xref="S1.E2.m1.2.2.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S1.E2.m1.2.2.1.1.1.1.2.2.3.1" xref="S1.E2.m1.2.2.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S1.E2.m1.2.2.1.1.1.1.2.2.3.3" xref="S1.E2.m1.2.2.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><msub id="S1.E2.m1.2.2.1.1.1.1.2.3" xref="S1.E2.m1.2.2.1.1.1.1.2.3.cmml"><mi id="S1.E2.m1.2.2.1.1.1.1.2.3.2" xref="S1.E2.m1.2.2.1.1.1.1.2.3.2.cmml">n</mi><mi id="S1.E2.m1.2.2.1.1.1.1.2.3.3" xref="S1.E2.m1.2.2.1.1.1.1.2.3.3.cmml">c</mi></msub></munderover><mrow id="S1.E2.m1.2.2.1.1.1.1.1" xref="S1.E2.m1.2.2.1.1.1.1.1.cmml"><mi id="S1.E2.m1.2.2.1.1.1.1.1.3" xref="S1.E2.m1.2.2.1.1.1.1.1.3.cmml">ρ</mi><mo lspace="0em" rspace="0em" id="S1.E2.m1.2.2.1.1.1.1.1.2" xref="S1.E2.m1.2.2.1.1.1.1.1.2.cmml">​</mo><mrow id="S1.E2.m1.2.2.1.1.1.1.1.1.1" xref="S1.E2.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S1.E2.m1.2.2.1.1.1.1.1.1.1.2" xref="S1.E2.m1.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S1.E2.m1.2.2.1.1.1.1.1.1.1.1" xref="S1.E2.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mrow id="S1.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S1.E2.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S1.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S1.E2.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S1.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S1.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S1.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S1.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mo id="S1.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S1.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S1.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S1.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S1.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S1.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">𝐜</mi><mi id="S1.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S1.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">𝐢</mi></msub></mrow><mo stretchy="false" id="S1.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S1.E2.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S1.E2.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S1.E2.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">2</mn></msup><mo stretchy="false" id="S1.E2.m1.2.2.1.1.1.1.1.1.1.3" xref="S1.E2.m1.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S1.E2.m1.2.2.1.1.1.1.1.2a" xref="S1.E2.m1.2.2.1.1.1.1.1.2.cmml">​</mo><msub id="S1.E2.m1.2.2.1.1.1.1.1.4" xref="S1.E2.m1.2.2.1.1.1.1.1.4.cmml"><mi id="S1.E2.m1.2.2.1.1.1.1.1.4.2" xref="S1.E2.m1.2.2.1.1.1.1.1.4.2.cmml">𝐰</mi><mi id="S1.E2.m1.2.2.1.1.1.1.1.4.3" xref="S1.E2.m1.2.2.1.1.1.1.1.4.3.cmml">𝐢</mi></msub></mrow></mrow></mrow></mrow><mo id="S1.E2.m1.2.2.1.2" xref="S1.E2.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.E2.m1.2b"><apply id="S1.E2.m1.2.2.1.1.cmml" xref="S1.E2.m1.2.2.1"><eq id="S1.E2.m1.2.2.1.1.2.cmml" xref="S1.E2.m1.2.2.1.1.2"></eq><apply id="S1.E2.m1.2.2.1.1.3.cmml" xref="S1.E2.m1.2.2.1.1.3"><times id="S1.E2.m1.2.2.1.1.3.1.cmml" xref="S1.E2.m1.2.2.1.1.3.1"></times><ci id="S1.E2.m1.2.2.1.1.3.2.cmml" xref="S1.E2.m1.2.2.1.1.3.2">𝑓</ci><ci id="S1.E2.m1.1.1.cmml" xref="S1.E2.m1.1.1">𝐱</ci></apply><apply id="S1.E2.m1.2.2.1.1.1.cmml" xref="S1.E2.m1.2.2.1.1.1"><plus id="S1.E2.m1.2.2.1.1.1.2.cmml" xref="S1.E2.m1.2.2.1.1.1.2"></plus><ci id="S1.E2.m1.2.2.1.1.1.3.cmml" xref="S1.E2.m1.2.2.1.1.1.3">𝐀𝐱</ci><apply id="S1.E2.m1.2.2.1.1.1.1.cmml" xref="S1.E2.m1.2.2.1.1.1.1"><apply id="S1.E2.m1.2.2.1.1.1.1.2.cmml" xref="S1.E2.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S1.E2.m1.2.2.1.1.1.1.2.1.cmml" xref="S1.E2.m1.2.2.1.1.1.1.2">superscript</csymbol><apply id="S1.E2.m1.2.2.1.1.1.1.2.2.cmml" xref="S1.E2.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S1.E2.m1.2.2.1.1.1.1.2.2.1.cmml" xref="S1.E2.m1.2.2.1.1.1.1.2">subscript</csymbol><sum id="S1.E2.m1.2.2.1.1.1.1.2.2.2.cmml" xref="S1.E2.m1.2.2.1.1.1.1.2.2.2"></sum><apply id="S1.E2.m1.2.2.1.1.1.1.2.2.3.cmml" xref="S1.E2.m1.2.2.1.1.1.1.2.2.3"><eq id="S1.E2.m1.2.2.1.1.1.1.2.2.3.1.cmml" xref="S1.E2.m1.2.2.1.1.1.1.2.2.3.1"></eq><ci id="S1.E2.m1.2.2.1.1.1.1.2.2.3.2.cmml" xref="S1.E2.m1.2.2.1.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S1.E2.m1.2.2.1.1.1.1.2.2.3.3.cmml" xref="S1.E2.m1.2.2.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S1.E2.m1.2.2.1.1.1.1.2.3.cmml" xref="S1.E2.m1.2.2.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S1.E2.m1.2.2.1.1.1.1.2.3.1.cmml" xref="S1.E2.m1.2.2.1.1.1.1.2.3">subscript</csymbol><ci id="S1.E2.m1.2.2.1.1.1.1.2.3.2.cmml" xref="S1.E2.m1.2.2.1.1.1.1.2.3.2">𝑛</ci><ci id="S1.E2.m1.2.2.1.1.1.1.2.3.3.cmml" xref="S1.E2.m1.2.2.1.1.1.1.2.3.3">𝑐</ci></apply></apply><apply id="S1.E2.m1.2.2.1.1.1.1.1.cmml" xref="S1.E2.m1.2.2.1.1.1.1.1"><times id="S1.E2.m1.2.2.1.1.1.1.1.2.cmml" xref="S1.E2.m1.2.2.1.1.1.1.1.2"></times><ci id="S1.E2.m1.2.2.1.1.1.1.1.3.cmml" xref="S1.E2.m1.2.2.1.1.1.1.1.3">𝜌</ci><apply id="S1.E2.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S1.E2.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S1.E2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S1.E2.m1.2.2.1.1.1.1.1.1.1">superscript</csymbol><apply id="S1.E2.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S1.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S1.E2.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S1.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S1.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S1.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1"><minus id="S1.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S1.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1"></minus><ci id="S1.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S1.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2">𝐱</ci><apply id="S1.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S1.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S1.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S1.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S1.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S1.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2">𝐜</ci><ci id="S1.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S1.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3">𝐢</ci></apply></apply></apply><cn type="integer" id="S1.E2.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S1.E2.m1.2.2.1.1.1.1.1.1.1.1.3">2</cn></apply><apply id="S1.E2.m1.2.2.1.1.1.1.1.4.cmml" xref="S1.E2.m1.2.2.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S1.E2.m1.2.2.1.1.1.1.1.4.1.cmml" xref="S1.E2.m1.2.2.1.1.1.1.1.4">subscript</csymbol><ci id="S1.E2.m1.2.2.1.1.1.1.1.4.2.cmml" xref="S1.E2.m1.2.2.1.1.1.1.1.4.2">𝐰</ci><ci id="S1.E2.m1.2.2.1.1.1.1.1.4.3.cmml" xref="S1.E2.m1.2.2.1.1.1.1.1.4.3">𝐢</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.E2.m1.2c">f(\mathbf{x})=\mathbf{Ax}+\sum_{i=1}^{n_{c}}\rho(||\mathbf{x}-\mathbf{c_{i}}||^{2})\mathbf{w_{i}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S1.p4.11" class="ltx_p">where <math id="S1.p4.7.m1.1" class="ltx_Math" alttext="\rho(r)=r^{2}\ log\ r" display="inline"><semantics id="S1.p4.7.m1.1a"><mrow id="S1.p4.7.m1.1.2" xref="S1.p4.7.m1.1.2.cmml"><mrow id="S1.p4.7.m1.1.2.2" xref="S1.p4.7.m1.1.2.2.cmml"><mi id="S1.p4.7.m1.1.2.2.2" xref="S1.p4.7.m1.1.2.2.2.cmml">ρ</mi><mo lspace="0em" rspace="0em" id="S1.p4.7.m1.1.2.2.1" xref="S1.p4.7.m1.1.2.2.1.cmml">​</mo><mrow id="S1.p4.7.m1.1.2.2.3.2" xref="S1.p4.7.m1.1.2.2.cmml"><mo stretchy="false" id="S1.p4.7.m1.1.2.2.3.2.1" xref="S1.p4.7.m1.1.2.2.cmml">(</mo><mi id="S1.p4.7.m1.1.1" xref="S1.p4.7.m1.1.1.cmml">r</mi><mo stretchy="false" id="S1.p4.7.m1.1.2.2.3.2.2" xref="S1.p4.7.m1.1.2.2.cmml">)</mo></mrow></mrow><mo id="S1.p4.7.m1.1.2.1" xref="S1.p4.7.m1.1.2.1.cmml">=</mo><mrow id="S1.p4.7.m1.1.2.3" xref="S1.p4.7.m1.1.2.3.cmml"><msup id="S1.p4.7.m1.1.2.3.2" xref="S1.p4.7.m1.1.2.3.2.cmml"><mi id="S1.p4.7.m1.1.2.3.2.2" xref="S1.p4.7.m1.1.2.3.2.2.cmml">r</mi><mn id="S1.p4.7.m1.1.2.3.2.3" xref="S1.p4.7.m1.1.2.3.2.3.cmml">2</mn></msup><mo lspace="0em" rspace="0em" id="S1.p4.7.m1.1.2.3.1" xref="S1.p4.7.m1.1.2.3.1.cmml">​</mo><mi id="S1.p4.7.m1.1.2.3.3" xref="S1.p4.7.m1.1.2.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S1.p4.7.m1.1.2.3.1a" xref="S1.p4.7.m1.1.2.3.1.cmml">​</mo><mi id="S1.p4.7.m1.1.2.3.4" xref="S1.p4.7.m1.1.2.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S1.p4.7.m1.1.2.3.1b" xref="S1.p4.7.m1.1.2.3.1.cmml">​</mo><mi id="S1.p4.7.m1.1.2.3.5" xref="S1.p4.7.m1.1.2.3.5.cmml">g</mi><mo lspace="0.500em" rspace="0em" id="S1.p4.7.m1.1.2.3.1c" xref="S1.p4.7.m1.1.2.3.1.cmml">​</mo><mi id="S1.p4.7.m1.1.2.3.6" xref="S1.p4.7.m1.1.2.3.6.cmml">r</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p4.7.m1.1b"><apply id="S1.p4.7.m1.1.2.cmml" xref="S1.p4.7.m1.1.2"><eq id="S1.p4.7.m1.1.2.1.cmml" xref="S1.p4.7.m1.1.2.1"></eq><apply id="S1.p4.7.m1.1.2.2.cmml" xref="S1.p4.7.m1.1.2.2"><times id="S1.p4.7.m1.1.2.2.1.cmml" xref="S1.p4.7.m1.1.2.2.1"></times><ci id="S1.p4.7.m1.1.2.2.2.cmml" xref="S1.p4.7.m1.1.2.2.2">𝜌</ci><ci id="S1.p4.7.m1.1.1.cmml" xref="S1.p4.7.m1.1.1">𝑟</ci></apply><apply id="S1.p4.7.m1.1.2.3.cmml" xref="S1.p4.7.m1.1.2.3"><times id="S1.p4.7.m1.1.2.3.1.cmml" xref="S1.p4.7.m1.1.2.3.1"></times><apply id="S1.p4.7.m1.1.2.3.2.cmml" xref="S1.p4.7.m1.1.2.3.2"><csymbol cd="ambiguous" id="S1.p4.7.m1.1.2.3.2.1.cmml" xref="S1.p4.7.m1.1.2.3.2">superscript</csymbol><ci id="S1.p4.7.m1.1.2.3.2.2.cmml" xref="S1.p4.7.m1.1.2.3.2.2">𝑟</ci><cn type="integer" id="S1.p4.7.m1.1.2.3.2.3.cmml" xref="S1.p4.7.m1.1.2.3.2.3">2</cn></apply><ci id="S1.p4.7.m1.1.2.3.3.cmml" xref="S1.p4.7.m1.1.2.3.3">𝑙</ci><ci id="S1.p4.7.m1.1.2.3.4.cmml" xref="S1.p4.7.m1.1.2.3.4">𝑜</ci><ci id="S1.p4.7.m1.1.2.3.5.cmml" xref="S1.p4.7.m1.1.2.3.5">𝑔</ci><ci id="S1.p4.7.m1.1.2.3.6.cmml" xref="S1.p4.7.m1.1.2.3.6">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.7.m1.1c">\rho(r)=r^{2}\ log\ r</annotation></semantics></math> is the thin-plate radial basis function, <math id="S1.p4.8.m2.1" class="ltx_Math" alttext="\mathbf{x}" display="inline"><semantics id="S1.p4.8.m2.1a"><mi id="S1.p4.8.m2.1.1" xref="S1.p4.8.m2.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S1.p4.8.m2.1b"><ci id="S1.p4.8.m2.1.1.cmml" xref="S1.p4.8.m2.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.8.m2.1c">\mathbf{x}</annotation></semantics></math> is a 2D point, <math id="S1.p4.9.m3.1" class="ltx_Math" alttext="n_{c}" display="inline"><semantics id="S1.p4.9.m3.1a"><msub id="S1.p4.9.m3.1.1" xref="S1.p4.9.m3.1.1.cmml"><mi id="S1.p4.9.m3.1.1.2" xref="S1.p4.9.m3.1.1.2.cmml">n</mi><mi id="S1.p4.9.m3.1.1.3" xref="S1.p4.9.m3.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S1.p4.9.m3.1b"><apply id="S1.p4.9.m3.1.1.cmml" xref="S1.p4.9.m3.1.1"><csymbol cd="ambiguous" id="S1.p4.9.m3.1.1.1.cmml" xref="S1.p4.9.m3.1.1">subscript</csymbol><ci id="S1.p4.9.m3.1.1.2.cmml" xref="S1.p4.9.m3.1.1.2">𝑛</ci><ci id="S1.p4.9.m3.1.1.3.cmml" xref="S1.p4.9.m3.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.9.m3.1c">n_{c}</annotation></semantics></math> is the number of control points, <math id="S1.p4.10.m4.1" class="ltx_Math" alttext="\mathbf{c_{i}}" display="inline"><semantics id="S1.p4.10.m4.1a"><msub id="S1.p4.10.m4.1.1" xref="S1.p4.10.m4.1.1.cmml"><mi id="S1.p4.10.m4.1.1.2" xref="S1.p4.10.m4.1.1.2.cmml">𝐜</mi><mi id="S1.p4.10.m4.1.1.3" xref="S1.p4.10.m4.1.1.3.cmml">𝐢</mi></msub><annotation-xml encoding="MathML-Content" id="S1.p4.10.m4.1b"><apply id="S1.p4.10.m4.1.1.cmml" xref="S1.p4.10.m4.1.1"><csymbol cd="ambiguous" id="S1.p4.10.m4.1.1.1.cmml" xref="S1.p4.10.m4.1.1">subscript</csymbol><ci id="S1.p4.10.m4.1.1.2.cmml" xref="S1.p4.10.m4.1.1.2">𝐜</ci><ci id="S1.p4.10.m4.1.1.3.cmml" xref="S1.p4.10.m4.1.1.3">𝐢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.10.m4.1c">\mathbf{c_{i}}</annotation></semantics></math> is a control point of index <math id="S1.p4.11.m5.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S1.p4.11.m5.1a"><mi id="S1.p4.11.m5.1.1" xref="S1.p4.11.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S1.p4.11.m5.1b"><ci id="S1.p4.11.m5.1.1.cmml" xref="S1.p4.11.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.11.m5.1c">i</annotation></semantics></math>.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">Several challenges need to be addressed for successfully detecting keypoints on deformable surfaces with high accuracy. Specifically, robustness to non-linear illumination changes, occlusions, and local photometric changes, which can introduce high ambiguity for both the detection and description stages. By assuming that desirable features to be discovered are also salient points that are likely to produce accurate matches, we propose to tackle the keypoint detection problem in a well-defined manner. By using an existing detector-descriptor setup, our learned detection model takes advantage of matching score maps. Our network can be easily paired with any combination of pre-existing detector-descriptor since it is trained to identify good features based on the map created from true descriptor matches on virtual deformations.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">We test our detector using three separate benchmark datasets of real deformable objects as well as with an application of content-based object retrieval, demonstrating that our approach can achieve state-of-the-art performance not only in matching evaluation scores but also in a relevant practical computer vision task of image retrieval. Figure <a href="#S3.F3" title="Figure 3 ‣ 3.3 Implementation details ‣ 3 Methodology ‣ Improving the matching of deformable objects by learning to detect keypoints" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows how well our detector performs in matching keypoints in comparison to several recently developed detectors.</p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p">The two main technical contributions of our work are: (i) a novel keypoint detection training framework designed to enhance the matching performance of pre-existing descriptors and (ii) the first learned keypoint detector tailored to handle non-rigid deformations on color images.
This paper extends the results and contributions of our previous work <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> on several major fronts. First, we introduce and evaluate novel architecture components, such as deformable convolutional network (DCN) layers, to evaluate the contribution of providing the network with more specialized inductive bias than regular CNNs for the task of non-rigid keypoint detection. Second, we perform experiments by adding DCN layers to different stages of the network backbone. Extensive experimental analysis reveals that the DCN layers help during training but do not improve the generalization of the network; the main improvement comes from our learning strategy. Finally, we extend the experimental evaluation with nine more recent strong baseline detectors. These additional experiments with several keypoint detectors indicate that our novel training paradigm can be adopted as a general framework for improving matching for non-rigid correspondence. Our method can be trained for any pair of detectors and descriptors to specialize the keypoint selection and improve matching quality with a specified descriptor.</p>
</div>
</section>
<section id="S2" class="ltx_section" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related work</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">The most popular keypoint detectors are based on carefully crafted algorithms that choose feature patterns like blobs, corners, or edges <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>. Deep learning, on the other hand, has recently emerged as the new standard for feature extraction and image matching. However, these learning-based methods are mainly used for tasks involving feature description <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>, and joint detection and description <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>. There are only a few studies that specifically address learning to recognize keypoints by raising detection likelihood for repeatable areas between image pairs <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>. While such keypoint detectors have high repeatability, their keypoints are mostly ambiguous, and the matching performance is degraded <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>. To enhance the representation and generalization of low-level characteristics, Barroso-Laguna <span id="S2.p1.1.1" class="ltx_text ltx_font_italic">et al</span>.<span id="S2.p1.1.2" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> and Di <span id="S2.p1.1.3" class="ltx_text ltx_font_italic">et al</span>.<span id="S2.p1.1.4" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> employ fixed handcrafted filters in addition to learned ones. However, manually created filters can include biases that could make it difficult to find appropriate keypoints, resulting in subpar detections.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">Alternatively, recent studies have been published based on a new research trend called the describe-then-detect approach, where the keypoints are found from a dense descriptor map. According to Revaud <span id="S2.p2.1.1" class="ltx_text ltx_font_italic">et al</span>.<span id="S2.p2.1.2" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, keypoints should be identified based on repeatability and dependability because detection and description are inextricably entwined. Suwanwimolkul <span id="S2.p2.1.3" class="ltx_text ltx_font_italic">et al</span>.<span id="S2.p2.1.4" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> noted that since the keypoint selection is more handcrafted in approaches like D2-Net <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> and ASLFeat <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>, there are no guarantees that the chosen keypoints can match the learned descriptors. Consequently, the accuracy of the matched keypoints is not usually very high. In contrast, in our method, the detector is trained to increase matching accuracy with real image pairings, and the peaks are generated directly from the network output (score map shown in Figure <a href="#S3.F1" title="Figure 1 ‣ 3 Methodology ‣ Improving the matching of deformable objects by learning to detect keypoints" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>).</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p">Only a few studies take descriptor matching into account in the training pipeline. GLAM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> detects keypoints based on matching quality but for a very specific domain of retinal images. By first identifying repeatable keypoints and then selecting the confident keypoints based on the matching, SEKD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> proposes a non-domain specific detector and descriptor. However, when a high number of good keypoints for matching is not discovered during the repeatability optimization stage, this strategy often produces degraded results. To jointly optimize detection and description, DISK <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> takes into account detection and description in a probabilistic relaxation and applies a reinforcement learning strategy. The method’s disadvantage is that in order to converge, it needs cautious hyperparameter adjustments and parameter annealing tricks. A decision tree was developed by Tonioni <span id="S2.p3.1.1" class="ltx_text ltx_font_italic">et al</span>.<span id="S2.p3.1.2" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> to learn how to choose 3D keypoints based on good matches. The authors argue that good traits for detection are those that are most likely to produce accurate matches. We implement a similar approach but on 2D keypoints, using a modern deep learning design. We employ the outcomes of matching descriptors with a weighting technique for creating a Matching Heatmap, which is non-domain specific.</p>
</div>
<div id="S2.p4" class="ltx_para">
<p id="S2.p4.1" class="ltx_p">Descriptors like DEAL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> present a deformation-aware local feature description technique that learns to describe non-rigid surfaces without depth information using explicit network deformation modeling. Similarly, the DaLi descriptor <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> finds features invariant to non-rigid deformations and variations in light by transforming local patches into meshes and applying heat diffusion operators. Likewise, GeoBit descriptor <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> and GeoPatch <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite> compute isometrically invariant features for RGB-D images by using geodesics from an object’s surface. In contrast to the suggested strategy in this paper, these solutions are designed for RGB-D images and focus only on the description step and ignore the detection phase. A 3D keypoint detector has recently been proposed by UKPGAN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, in which keypoints are found for 3D reconstruction. However, unlike our detector for 2D images, their approach is only appropriate in the context of 3D keypoints. To the extent of our knowledge, no previous study has addressed the detection of 2D features on images with non-rigid deformations. Tarashima <span id="S2.p4.1.1" class="ltx_text ltx_font_italic">et al</span>.<span id="S2.p4.1.2" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> proposed to deal with non-rigid objects by considering deformations only in the matching stage. Despite having reasonable premisses for matching, the deformations still degrade the detection and description needed as input in the matching.
In this paper, we offer a method for obtaining keypoints less affected by non-rigid deformations using only visual data.</p>
</div>
</section>
<section id="S3" class="ltx_section" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methodology</h2>

<figure id="S3.F1" class="ltx_figure"><img src="/html/2309.00434/assets/x1.png" id="S3.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="415" height="228" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span><span id="S3.F1.6.1" class="ltx_text ltx_font_bold">Network architecture for keypoint detection.</span> The Siamese network is optimized to detect reliable keypoints to be matched for a given descriptor. The encoder-decoder architecture is an U-Net with dimensions <math id="S3.F1.3.m1.4" class="ltx_Math" alttext="D_{encoder}=\{1,32,64,128\}" display="inline"><semantics id="S3.F1.3.m1.4b"><mrow id="S3.F1.3.m1.4.5" xref="S3.F1.3.m1.4.5.cmml"><msub id="S3.F1.3.m1.4.5.2" xref="S3.F1.3.m1.4.5.2.cmml"><mi id="S3.F1.3.m1.4.5.2.2" xref="S3.F1.3.m1.4.5.2.2.cmml">D</mi><mrow id="S3.F1.3.m1.4.5.2.3" xref="S3.F1.3.m1.4.5.2.3.cmml"><mi id="S3.F1.3.m1.4.5.2.3.2" xref="S3.F1.3.m1.4.5.2.3.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.F1.3.m1.4.5.2.3.1" xref="S3.F1.3.m1.4.5.2.3.1.cmml">​</mo><mi id="S3.F1.3.m1.4.5.2.3.3" xref="S3.F1.3.m1.4.5.2.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.F1.3.m1.4.5.2.3.1b" xref="S3.F1.3.m1.4.5.2.3.1.cmml">​</mo><mi id="S3.F1.3.m1.4.5.2.3.4" xref="S3.F1.3.m1.4.5.2.3.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.F1.3.m1.4.5.2.3.1c" xref="S3.F1.3.m1.4.5.2.3.1.cmml">​</mo><mi id="S3.F1.3.m1.4.5.2.3.5" xref="S3.F1.3.m1.4.5.2.3.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.F1.3.m1.4.5.2.3.1d" xref="S3.F1.3.m1.4.5.2.3.1.cmml">​</mo><mi id="S3.F1.3.m1.4.5.2.3.6" xref="S3.F1.3.m1.4.5.2.3.6.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.F1.3.m1.4.5.2.3.1e" xref="S3.F1.3.m1.4.5.2.3.1.cmml">​</mo><mi id="S3.F1.3.m1.4.5.2.3.7" xref="S3.F1.3.m1.4.5.2.3.7.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.F1.3.m1.4.5.2.3.1f" xref="S3.F1.3.m1.4.5.2.3.1.cmml">​</mo><mi id="S3.F1.3.m1.4.5.2.3.8" xref="S3.F1.3.m1.4.5.2.3.8.cmml">r</mi></mrow></msub><mo id="S3.F1.3.m1.4.5.1" xref="S3.F1.3.m1.4.5.1.cmml">=</mo><mrow id="S3.F1.3.m1.4.5.3.2" xref="S3.F1.3.m1.4.5.3.1.cmml"><mo stretchy="false" id="S3.F1.3.m1.4.5.3.2.1" xref="S3.F1.3.m1.4.5.3.1.cmml">{</mo><mn id="S3.F1.3.m1.1.1" xref="S3.F1.3.m1.1.1.cmml">1</mn><mo id="S3.F1.3.m1.4.5.3.2.2" xref="S3.F1.3.m1.4.5.3.1.cmml">,</mo><mn id="S3.F1.3.m1.2.2" xref="S3.F1.3.m1.2.2.cmml">32</mn><mo id="S3.F1.3.m1.4.5.3.2.3" xref="S3.F1.3.m1.4.5.3.1.cmml">,</mo><mn id="S3.F1.3.m1.3.3" xref="S3.F1.3.m1.3.3.cmml">64</mn><mo id="S3.F1.3.m1.4.5.3.2.4" xref="S3.F1.3.m1.4.5.3.1.cmml">,</mo><mn id="S3.F1.3.m1.4.4" xref="S3.F1.3.m1.4.4.cmml">128</mn><mo stretchy="false" id="S3.F1.3.m1.4.5.3.2.5" xref="S3.F1.3.m1.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.F1.3.m1.4c"><apply id="S3.F1.3.m1.4.5.cmml" xref="S3.F1.3.m1.4.5"><eq id="S3.F1.3.m1.4.5.1.cmml" xref="S3.F1.3.m1.4.5.1"></eq><apply id="S3.F1.3.m1.4.5.2.cmml" xref="S3.F1.3.m1.4.5.2"><csymbol cd="ambiguous" id="S3.F1.3.m1.4.5.2.1.cmml" xref="S3.F1.3.m1.4.5.2">subscript</csymbol><ci id="S3.F1.3.m1.4.5.2.2.cmml" xref="S3.F1.3.m1.4.5.2.2">𝐷</ci><apply id="S3.F1.3.m1.4.5.2.3.cmml" xref="S3.F1.3.m1.4.5.2.3"><times id="S3.F1.3.m1.4.5.2.3.1.cmml" xref="S3.F1.3.m1.4.5.2.3.1"></times><ci id="S3.F1.3.m1.4.5.2.3.2.cmml" xref="S3.F1.3.m1.4.5.2.3.2">𝑒</ci><ci id="S3.F1.3.m1.4.5.2.3.3.cmml" xref="S3.F1.3.m1.4.5.2.3.3">𝑛</ci><ci id="S3.F1.3.m1.4.5.2.3.4.cmml" xref="S3.F1.3.m1.4.5.2.3.4">𝑐</ci><ci id="S3.F1.3.m1.4.5.2.3.5.cmml" xref="S3.F1.3.m1.4.5.2.3.5">𝑜</ci><ci id="S3.F1.3.m1.4.5.2.3.6.cmml" xref="S3.F1.3.m1.4.5.2.3.6">𝑑</ci><ci id="S3.F1.3.m1.4.5.2.3.7.cmml" xref="S3.F1.3.m1.4.5.2.3.7">𝑒</ci><ci id="S3.F1.3.m1.4.5.2.3.8.cmml" xref="S3.F1.3.m1.4.5.2.3.8">𝑟</ci></apply></apply><set id="S3.F1.3.m1.4.5.3.1.cmml" xref="S3.F1.3.m1.4.5.3.2"><cn type="integer" id="S3.F1.3.m1.1.1.cmml" xref="S3.F1.3.m1.1.1">1</cn><cn type="integer" id="S3.F1.3.m1.2.2.cmml" xref="S3.F1.3.m1.2.2">32</cn><cn type="integer" id="S3.F1.3.m1.3.3.cmml" xref="S3.F1.3.m1.3.3">64</cn><cn type="integer" id="S3.F1.3.m1.4.4.cmml" xref="S3.F1.3.m1.4.4">128</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.3.m1.4d">D_{encoder}=\{1,32,64,128\}</annotation></semantics></math> and <math id="S3.F1.4.m2.4" class="ltx_Math" alttext="D_{decoder}=\{128,64,32,1\}" display="inline"><semantics id="S3.F1.4.m2.4b"><mrow id="S3.F1.4.m2.4.5" xref="S3.F1.4.m2.4.5.cmml"><msub id="S3.F1.4.m2.4.5.2" xref="S3.F1.4.m2.4.5.2.cmml"><mi id="S3.F1.4.m2.4.5.2.2" xref="S3.F1.4.m2.4.5.2.2.cmml">D</mi><mrow id="S3.F1.4.m2.4.5.2.3" xref="S3.F1.4.m2.4.5.2.3.cmml"><mi id="S3.F1.4.m2.4.5.2.3.2" xref="S3.F1.4.m2.4.5.2.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.F1.4.m2.4.5.2.3.1" xref="S3.F1.4.m2.4.5.2.3.1.cmml">​</mo><mi id="S3.F1.4.m2.4.5.2.3.3" xref="S3.F1.4.m2.4.5.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.F1.4.m2.4.5.2.3.1b" xref="S3.F1.4.m2.4.5.2.3.1.cmml">​</mo><mi id="S3.F1.4.m2.4.5.2.3.4" xref="S3.F1.4.m2.4.5.2.3.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.F1.4.m2.4.5.2.3.1c" xref="S3.F1.4.m2.4.5.2.3.1.cmml">​</mo><mi id="S3.F1.4.m2.4.5.2.3.5" xref="S3.F1.4.m2.4.5.2.3.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.F1.4.m2.4.5.2.3.1d" xref="S3.F1.4.m2.4.5.2.3.1.cmml">​</mo><mi id="S3.F1.4.m2.4.5.2.3.6" xref="S3.F1.4.m2.4.5.2.3.6.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.F1.4.m2.4.5.2.3.1e" xref="S3.F1.4.m2.4.5.2.3.1.cmml">​</mo><mi id="S3.F1.4.m2.4.5.2.3.7" xref="S3.F1.4.m2.4.5.2.3.7.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.F1.4.m2.4.5.2.3.1f" xref="S3.F1.4.m2.4.5.2.3.1.cmml">​</mo><mi id="S3.F1.4.m2.4.5.2.3.8" xref="S3.F1.4.m2.4.5.2.3.8.cmml">r</mi></mrow></msub><mo id="S3.F1.4.m2.4.5.1" xref="S3.F1.4.m2.4.5.1.cmml">=</mo><mrow id="S3.F1.4.m2.4.5.3.2" xref="S3.F1.4.m2.4.5.3.1.cmml"><mo stretchy="false" id="S3.F1.4.m2.4.5.3.2.1" xref="S3.F1.4.m2.4.5.3.1.cmml">{</mo><mn id="S3.F1.4.m2.1.1" xref="S3.F1.4.m2.1.1.cmml">128</mn><mo id="S3.F1.4.m2.4.5.3.2.2" xref="S3.F1.4.m2.4.5.3.1.cmml">,</mo><mn id="S3.F1.4.m2.2.2" xref="S3.F1.4.m2.2.2.cmml">64</mn><mo id="S3.F1.4.m2.4.5.3.2.3" xref="S3.F1.4.m2.4.5.3.1.cmml">,</mo><mn id="S3.F1.4.m2.3.3" xref="S3.F1.4.m2.3.3.cmml">32</mn><mo id="S3.F1.4.m2.4.5.3.2.4" xref="S3.F1.4.m2.4.5.3.1.cmml">,</mo><mn id="S3.F1.4.m2.4.4" xref="S3.F1.4.m2.4.4.cmml">1</mn><mo stretchy="false" id="S3.F1.4.m2.4.5.3.2.5" xref="S3.F1.4.m2.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.F1.4.m2.4c"><apply id="S3.F1.4.m2.4.5.cmml" xref="S3.F1.4.m2.4.5"><eq id="S3.F1.4.m2.4.5.1.cmml" xref="S3.F1.4.m2.4.5.1"></eq><apply id="S3.F1.4.m2.4.5.2.cmml" xref="S3.F1.4.m2.4.5.2"><csymbol cd="ambiguous" id="S3.F1.4.m2.4.5.2.1.cmml" xref="S3.F1.4.m2.4.5.2">subscript</csymbol><ci id="S3.F1.4.m2.4.5.2.2.cmml" xref="S3.F1.4.m2.4.5.2.2">𝐷</ci><apply id="S3.F1.4.m2.4.5.2.3.cmml" xref="S3.F1.4.m2.4.5.2.3"><times id="S3.F1.4.m2.4.5.2.3.1.cmml" xref="S3.F1.4.m2.4.5.2.3.1"></times><ci id="S3.F1.4.m2.4.5.2.3.2.cmml" xref="S3.F1.4.m2.4.5.2.3.2">𝑑</ci><ci id="S3.F1.4.m2.4.5.2.3.3.cmml" xref="S3.F1.4.m2.4.5.2.3.3">𝑒</ci><ci id="S3.F1.4.m2.4.5.2.3.4.cmml" xref="S3.F1.4.m2.4.5.2.3.4">𝑐</ci><ci id="S3.F1.4.m2.4.5.2.3.5.cmml" xref="S3.F1.4.m2.4.5.2.3.5">𝑜</ci><ci id="S3.F1.4.m2.4.5.2.3.6.cmml" xref="S3.F1.4.m2.4.5.2.3.6">𝑑</ci><ci id="S3.F1.4.m2.4.5.2.3.7.cmml" xref="S3.F1.4.m2.4.5.2.3.7">𝑒</ci><ci id="S3.F1.4.m2.4.5.2.3.8.cmml" xref="S3.F1.4.m2.4.5.2.3.8">𝑟</ci></apply></apply><set id="S3.F1.4.m2.4.5.3.1.cmml" xref="S3.F1.4.m2.4.5.3.2"><cn type="integer" id="S3.F1.4.m2.1.1.cmml" xref="S3.F1.4.m2.1.1">128</cn><cn type="integer" id="S3.F1.4.m2.2.2.cmml" xref="S3.F1.4.m2.2.2">64</cn><cn type="integer" id="S3.F1.4.m2.3.3.cmml" xref="S3.F1.4.m2.3.3">32</cn><cn type="integer" id="S3.F1.4.m2.4.4.cmml" xref="S3.F1.4.m2.4.4">1</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.4.m2.4d">D_{decoder}=\{128,64,32,1\}</annotation></semantics></math> with skip connections and a final sigmoid layer.</figcaption>
</figure>
<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">Our detector is trained to identify stable areas in images that are affected by non-rigid deformations. Our training setting imposes keypoints to be found at repetitive places with a high likelihood of matching for a given descriptor. Our network (Figure <a href="#S3.F1" title="Figure 1 ‣ 3 Methodology ‣ Improving the matching of deformable objects by learning to detect keypoints" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) receives an image and outputs the most likely keypoints to be detected. We describe the training framework, the loss design, and implementation specifics in the following sections.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Keypoint detection learning framework</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.11" class="ltx_p">In contrast to learned keypoints like Key.net <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> and describe-to-detect techniques like R2D2 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> and ASLFeat <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>, the central idea of our learning technique is to bootstrap the learning process with an existing detector-descriptor pair that is targeted at high confidence matches. Let <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="A\in\mathbb{R}^{H\times W}" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mrow id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">A</mi><mo id="S3.SS1.p1.1.m1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml"><mi id="S3.SS1.p1.1.m1.1.1.3.2" xref="S3.SS1.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p1.1.m1.1.1.3.3" xref="S3.SS1.p1.1.m1.1.1.3.3.cmml"><mi id="S3.SS1.p1.1.m1.1.1.3.3.2" xref="S3.SS1.p1.1.m1.1.1.3.3.2.cmml">H</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p1.1.m1.1.1.3.3.1" xref="S3.SS1.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p1.1.m1.1.1.3.3.3" xref="S3.SS1.p1.1.m1.1.1.3.3.3.cmml">W</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><in id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1"></in><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">𝐴</ci><apply id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.3.1.cmml" xref="S3.SS1.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.3.2.cmml" xref="S3.SS1.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS1.p1.1.m1.1.1.3.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3"><times id="S3.SS1.p1.1.m1.1.1.3.3.1.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3.1"></times><ci id="S3.SS1.p1.1.m1.1.1.3.3.2.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3.2">𝐻</ci><ci id="S3.SS1.p1.1.m1.1.1.3.3.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3.3">𝑊</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">A\in\mathbb{R}^{H\times W}</annotation></semantics></math> be the anchor image, which is an image from our training set. On image <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">A</annotation></semantics></math>, we apply two combinations of random homography and thin-plate-spline warp (TPS) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>, <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="g" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><mi id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">g</annotation></semantics></math> and <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="g^{\prime}" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><msup id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><mi id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml">g</mi><mo id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">superscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2">𝑔</ci><ci id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">g^{\prime}</annotation></semantics></math>, to generate images <math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><mi id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">B</annotation></semantics></math> and <math id="S3.SS1.p1.6.m6.1" class="ltx_Math" alttext="B^{\prime}" display="inline"><semantics id="S3.SS1.p1.6.m6.1a"><msup id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml"><mi id="S3.SS1.p1.6.m6.1.1.2" xref="S3.SS1.p1.6.m6.1.1.2.cmml">B</mi><mo id="S3.SS1.p1.6.m6.1.1.3" xref="S3.SS1.p1.6.m6.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">superscript</csymbol><ci id="S3.SS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2">𝐵</ci><ci id="S3.SS1.p1.6.m6.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">B^{\prime}</annotation></semantics></math>, respectively. The TPS was purposefully chosen since non-rigid deformations can be efficiently parameterized via TPS wrappings. Then, using a base detector, we find <math id="S3.SS1.p1.7.m7.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p1.7.m7.1a"><mi id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><ci id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">k</annotation></semantics></math> salient keypoints for images <math id="S3.SS1.p1.8.m8.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S3.SS1.p1.8.m8.1a"><mi id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><ci id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">A</annotation></semantics></math>, <math id="S3.SS1.p1.9.m9.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S3.SS1.p1.9.m9.1a"><mi id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b"><ci id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">B</annotation></semantics></math>, and <math id="S3.SS1.p1.10.m10.1" class="ltx_Math" alttext="B^{\prime}" display="inline"><semantics id="S3.SS1.p1.10.m10.1a"><msup id="S3.SS1.p1.10.m10.1.1" xref="S3.SS1.p1.10.m10.1.1.cmml"><mi id="S3.SS1.p1.10.m10.1.1.2" xref="S3.SS1.p1.10.m10.1.1.2.cmml">B</mi><mo id="S3.SS1.p1.10.m10.1.1.3" xref="S3.SS1.p1.10.m10.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m10.1b"><apply id="S3.SS1.p1.10.m10.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m10.1.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1">superscript</csymbol><ci id="S3.SS1.p1.10.m10.1.1.2.cmml" xref="S3.SS1.p1.10.m10.1.1.2">𝐵</ci><ci id="S3.SS1.p1.10.m10.1.1.3.cmml" xref="S3.SS1.p1.10.m10.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m10.1c">B^{\prime}</annotation></semantics></math>. We use <math id="S3.SS1.p1.11.m11.1" class="ltx_Math" alttext="k=0.02\times H\times W" display="inline"><semantics id="S3.SS1.p1.11.m11.1a"><mrow id="S3.SS1.p1.11.m11.1.1" xref="S3.SS1.p1.11.m11.1.1.cmml"><mi id="S3.SS1.p1.11.m11.1.1.2" xref="S3.SS1.p1.11.m11.1.1.2.cmml">k</mi><mo id="S3.SS1.p1.11.m11.1.1.1" xref="S3.SS1.p1.11.m11.1.1.1.cmml">=</mo><mrow id="S3.SS1.p1.11.m11.1.1.3" xref="S3.SS1.p1.11.m11.1.1.3.cmml"><mn id="S3.SS1.p1.11.m11.1.1.3.2" xref="S3.SS1.p1.11.m11.1.1.3.2.cmml">0.02</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p1.11.m11.1.1.3.1" xref="S3.SS1.p1.11.m11.1.1.3.1.cmml">×</mo><mi id="S3.SS1.p1.11.m11.1.1.3.3" xref="S3.SS1.p1.11.m11.1.1.3.3.cmml">H</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p1.11.m11.1.1.3.1a" xref="S3.SS1.p1.11.m11.1.1.3.1.cmml">×</mo><mi id="S3.SS1.p1.11.m11.1.1.3.4" xref="S3.SS1.p1.11.m11.1.1.3.4.cmml">W</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m11.1b"><apply id="S3.SS1.p1.11.m11.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1"><eq id="S3.SS1.p1.11.m11.1.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1.1"></eq><ci id="S3.SS1.p1.11.m11.1.1.2.cmml" xref="S3.SS1.p1.11.m11.1.1.2">𝑘</ci><apply id="S3.SS1.p1.11.m11.1.1.3.cmml" xref="S3.SS1.p1.11.m11.1.1.3"><times id="S3.SS1.p1.11.m11.1.1.3.1.cmml" xref="S3.SS1.p1.11.m11.1.1.3.1"></times><cn type="float" id="S3.SS1.p1.11.m11.1.1.3.2.cmml" xref="S3.SS1.p1.11.m11.1.1.3.2">0.02</cn><ci id="S3.SS1.p1.11.m11.1.1.3.3.cmml" xref="S3.SS1.p1.11.m11.1.1.3.3">𝐻</ci><ci id="S3.SS1.p1.11.m11.1.1.3.4.cmml" xref="S3.SS1.p1.11.m11.1.1.3.4">𝑊</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m11.1c">k=0.02\times H\times W</annotation></semantics></math> in our trials, which yields a significant amount of keypoints at all regions in the image. This number of keypoints is an upper limit for the ground truth generation, as we filter a great portion of them later in the pipeline.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.14" class="ltx_p">After selecting the salient pixels, we extract descriptors for each keypoint location and compare the descriptors of images <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">A</annotation></semantics></math> and <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><mi id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">B</annotation></semantics></math>, and the descriptors of images <math id="S3.SS1.p2.3.m3.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S3.SS1.p2.3.m3.1a"><mi id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">A</annotation></semantics></math> and <math id="S3.SS1.p2.4.m4.1" class="ltx_Math" alttext="B^{\prime}" display="inline"><semantics id="S3.SS1.p2.4.m4.1a"><msup id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml"><mi id="S3.SS1.p2.4.m4.1.1.2" xref="S3.SS1.p2.4.m4.1.1.2.cmml">B</mi><mo id="S3.SS1.p2.4.m4.1.1.3" xref="S3.SS1.p2.4.m4.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><apply id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">superscript</csymbol><ci id="S3.SS1.p2.4.m4.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.2">𝐵</ci><ci id="S3.SS1.p2.4.m4.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">B^{\prime}</annotation></semantics></math>. Note that <math id="S3.SS1.p2.5.m5.1" class="ltx_Math" alttext="g" display="inline"><semantics id="S3.SS1.p2.5.m5.1a"><mi id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><ci id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">g</annotation></semantics></math> and <math id="S3.SS1.p2.6.m6.1" class="ltx_Math" alttext="g^{\prime}" display="inline"><semantics id="S3.SS1.p2.6.m6.1a"><msup id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml"><mi id="S3.SS1.p2.6.m6.1.1.2" xref="S3.SS1.p2.6.m6.1.1.2.cmml">g</mi><mo id="S3.SS1.p2.6.m6.1.1.3" xref="S3.SS1.p2.6.m6.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.1b"><apply id="S3.SS1.p2.6.m6.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.1.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1">superscript</csymbol><ci id="S3.SS1.p2.6.m6.1.1.2.cmml" xref="S3.SS1.p2.6.m6.1.1.2">𝑔</ci><ci id="S3.SS1.p2.6.m6.1.1.3.cmml" xref="S3.SS1.p2.6.m6.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.1c">g^{\prime}</annotation></semantics></math> can be used to determine the locations of the correct matches. When the descriptors pass the nearest neighbor distance ratio tests and is a correct match, its keypoint location <math id="S3.SS1.p2.7.m7.2" class="ltx_Math" alttext="(x,y)" display="inline"><semantics id="S3.SS1.p2.7.m7.2a"><mrow id="S3.SS1.p2.7.m7.2.3.2" xref="S3.SS1.p2.7.m7.2.3.1.cmml"><mo stretchy="false" id="S3.SS1.p2.7.m7.2.3.2.1" xref="S3.SS1.p2.7.m7.2.3.1.cmml">(</mo><mi id="S3.SS1.p2.7.m7.1.1" xref="S3.SS1.p2.7.m7.1.1.cmml">x</mi><mo id="S3.SS1.p2.7.m7.2.3.2.2" xref="S3.SS1.p2.7.m7.2.3.1.cmml">,</mo><mi id="S3.SS1.p2.7.m7.2.2" xref="S3.SS1.p2.7.m7.2.2.cmml">y</mi><mo stretchy="false" id="S3.SS1.p2.7.m7.2.3.2.3" xref="S3.SS1.p2.7.m7.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m7.2b"><interval closure="open" id="S3.SS1.p2.7.m7.2.3.1.cmml" xref="S3.SS1.p2.7.m7.2.3.2"><ci id="S3.SS1.p2.7.m7.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1">𝑥</ci><ci id="S3.SS1.p2.7.m7.2.2.cmml" xref="S3.SS1.p2.7.m7.2.2">𝑦</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m7.2c">(x,y)</annotation></semantics></math> is added to the set <math id="S3.SS1.p2.8.m8.1" class="ltx_Math" alttext="C_{i}" display="inline"><semantics id="S3.SS1.p2.8.m8.1a"><msub id="S3.SS1.p2.8.m8.1.1" xref="S3.SS1.p2.8.m8.1.1.cmml"><mi id="S3.SS1.p2.8.m8.1.1.2" xref="S3.SS1.p2.8.m8.1.1.2.cmml">C</mi><mi id="S3.SS1.p2.8.m8.1.1.3" xref="S3.SS1.p2.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m8.1b"><apply id="S3.SS1.p2.8.m8.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m8.1.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1">subscript</csymbol><ci id="S3.SS1.p2.8.m8.1.1.2.cmml" xref="S3.SS1.p2.8.m8.1.1.2">𝐶</ci><ci id="S3.SS1.p2.8.m8.1.1.3.cmml" xref="S3.SS1.p2.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.8.m8.1c">C_{i}</annotation></semantics></math>, where <math id="S3.SS1.p2.9.m9.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS1.p2.9.m9.1a"><mi id="S3.SS1.p2.9.m9.1.1" xref="S3.SS1.p2.9.m9.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.9.m9.1b"><ci id="S3.SS1.p2.9.m9.1.1.cmml" xref="S3.SS1.p2.9.m9.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.9.m9.1c">i</annotation></semantics></math> is the index of the keypoint for image <math id="S3.SS1.p2.10.m10.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S3.SS1.p2.10.m10.1a"><mi id="S3.SS1.p2.10.m10.1.1" xref="S3.SS1.p2.10.m10.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.10.m10.1b"><ci id="S3.SS1.p2.10.m10.1.1.cmml" xref="S3.SS1.p2.10.m10.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.10.m10.1c">A</annotation></semantics></math>, <math id="S3.SS1.p2.11.m11.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S3.SS1.p2.11.m11.1a"><mi id="S3.SS1.p2.11.m11.1.1" xref="S3.SS1.p2.11.m11.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.11.m11.1b"><ci id="S3.SS1.p2.11.m11.1.1.cmml" xref="S3.SS1.p2.11.m11.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.11.m11.1c">B</annotation></semantics></math>, or <math id="S3.SS1.p2.12.m12.1" class="ltx_Math" alttext="B^{\prime}" display="inline"><semantics id="S3.SS1.p2.12.m12.1a"><msup id="S3.SS1.p2.12.m12.1.1" xref="S3.SS1.p2.12.m12.1.1.cmml"><mi id="S3.SS1.p2.12.m12.1.1.2" xref="S3.SS1.p2.12.m12.1.1.2.cmml">B</mi><mo id="S3.SS1.p2.12.m12.1.1.3" xref="S3.SS1.p2.12.m12.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.12.m12.1b"><apply id="S3.SS1.p2.12.m12.1.1.cmml" xref="S3.SS1.p2.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.12.m12.1.1.1.cmml" xref="S3.SS1.p2.12.m12.1.1">superscript</csymbol><ci id="S3.SS1.p2.12.m12.1.1.2.cmml" xref="S3.SS1.p2.12.m12.1.1.2">𝐵</ci><ci id="S3.SS1.p2.12.m12.1.1.3.cmml" xref="S3.SS1.p2.12.m12.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.12.m12.1c">B^{\prime}</annotation></semantics></math>. The tolerance used to consider a match correct is set to <math id="S3.SS1.p2.13.m13.1" class="ltx_Math" alttext="3" display="inline"><semantics id="S3.SS1.p2.13.m13.1a"><mn id="S3.SS1.p2.13.m13.1.1" xref="S3.SS1.p2.13.m13.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.13.m13.1b"><cn type="integer" id="S3.SS1.p2.13.m13.1.1.cmml" xref="S3.SS1.p2.13.m13.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.13.m13.1c">3</annotation></semantics></math> pixels, and the nearest neighbor distance ratio is set to <math id="S3.SS1.p2.14.m14.1" class="ltx_Math" alttext="0.8" display="inline"><semantics id="S3.SS1.p2.14.m14.1a"><mn id="S3.SS1.p2.14.m14.1.1" xref="S3.SS1.p2.14.m14.1.1.cmml">0.8</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.14.m14.1b"><cn type="float" id="S3.SS1.p2.14.m14.1.1.cmml" xref="S3.SS1.p2.14.m14.1.1">0.8</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.14.m14.1c">0.8</annotation></semantics></math>. Using the position of the correct descriptors’ matches as our training data, we train our model to recognize reliable keypoint locations. The map created using true matches is denoted as <span id="S3.SS1.p2.14.1" class="ltx_text ltx_font_italic">Matching Heatmap</span> (MH). Figure <a href="#S3.F2" title="Figure 2 ‣ 3.1 Keypoint detection learning framework ‣ 3 Methodology ‣ Improving the matching of deformable objects by learning to detect keypoints" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> shows a summary of this procedure.</p>
</div>
<figure id="S3.F2" class="ltx_figure"><img src="/html/2309.00434/assets/x2.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="457" height="243" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span><span id="S3.F2.4.1" class="ltx_text ltx_font_bold">Training setting.</span> Our training comprises three steps: i) We detect the keypoints using a base detector for images A, B and B’ (an anchor, and two transformed versions of the anchor with random homography and non-rigid image deformations);
and then, we extract the descriptors on the detected keypoints to find correspondences with nearest neighbor search;
ii) Using the correct matches, we build a Matching Heatmap (MH) from the locations of correct matches for each input image;
iii) MH weighting done based on keypoint quality, <span id="S3.F2.5.2" class="ltx_text ltx_font_italic">i.e</span>.<span id="S3.F2.6.3" class="ltx_text"></span>, true match repeatability.</figcaption>
</figure>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.35" class="ltx_p">Let the MH of <math id="S3.SS1.p3.1.m1.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S3.SS1.p3.1.m1.1a"><mi id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><ci id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">A</annotation></semantics></math> be <math id="S3.SS1.p3.2.m2.2" class="ltx_Math" alttext="M_{a1},M_{a2}" display="inline"><semantics id="S3.SS1.p3.2.m2.2a"><mrow id="S3.SS1.p3.2.m2.2.2.2" xref="S3.SS1.p3.2.m2.2.2.3.cmml"><msub id="S3.SS1.p3.2.m2.1.1.1.1" xref="S3.SS1.p3.2.m2.1.1.1.1.cmml"><mi id="S3.SS1.p3.2.m2.1.1.1.1.2" xref="S3.SS1.p3.2.m2.1.1.1.1.2.cmml">M</mi><mrow id="S3.SS1.p3.2.m2.1.1.1.1.3" xref="S3.SS1.p3.2.m2.1.1.1.1.3.cmml"><mi id="S3.SS1.p3.2.m2.1.1.1.1.3.2" xref="S3.SS1.p3.2.m2.1.1.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.2.m2.1.1.1.1.3.1" xref="S3.SS1.p3.2.m2.1.1.1.1.3.1.cmml">​</mo><mn id="S3.SS1.p3.2.m2.1.1.1.1.3.3" xref="S3.SS1.p3.2.m2.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS1.p3.2.m2.2.2.2.3" xref="S3.SS1.p3.2.m2.2.2.3.cmml">,</mo><msub id="S3.SS1.p3.2.m2.2.2.2.2" xref="S3.SS1.p3.2.m2.2.2.2.2.cmml"><mi id="S3.SS1.p3.2.m2.2.2.2.2.2" xref="S3.SS1.p3.2.m2.2.2.2.2.2.cmml">M</mi><mrow id="S3.SS1.p3.2.m2.2.2.2.2.3" xref="S3.SS1.p3.2.m2.2.2.2.2.3.cmml"><mi id="S3.SS1.p3.2.m2.2.2.2.2.3.2" xref="S3.SS1.p3.2.m2.2.2.2.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.2.m2.2.2.2.2.3.1" xref="S3.SS1.p3.2.m2.2.2.2.2.3.1.cmml">​</mo><mn id="S3.SS1.p3.2.m2.2.2.2.2.3.3" xref="S3.SS1.p3.2.m2.2.2.2.2.3.3.cmml">2</mn></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.2b"><list id="S3.SS1.p3.2.m2.2.2.3.cmml" xref="S3.SS1.p3.2.m2.2.2.2"><apply id="S3.SS1.p3.2.m2.1.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.1.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p3.2.m2.1.1.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1.2">𝑀</ci><apply id="S3.SS1.p3.2.m2.1.1.1.1.3.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1.3"><times id="S3.SS1.p3.2.m2.1.1.1.1.3.1.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1.3.1"></times><ci id="S3.SS1.p3.2.m2.1.1.1.1.3.2.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1.3.2">𝑎</ci><cn type="integer" id="S3.SS1.p3.2.m2.1.1.1.1.3.3.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.SS1.p3.2.m2.2.2.2.2.cmml" xref="S3.SS1.p3.2.m2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.2.2.2.2.1.cmml" xref="S3.SS1.p3.2.m2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p3.2.m2.2.2.2.2.2.cmml" xref="S3.SS1.p3.2.m2.2.2.2.2.2">𝑀</ci><apply id="S3.SS1.p3.2.m2.2.2.2.2.3.cmml" xref="S3.SS1.p3.2.m2.2.2.2.2.3"><times id="S3.SS1.p3.2.m2.2.2.2.2.3.1.cmml" xref="S3.SS1.p3.2.m2.2.2.2.2.3.1"></times><ci id="S3.SS1.p3.2.m2.2.2.2.2.3.2.cmml" xref="S3.SS1.p3.2.m2.2.2.2.2.3.2">𝑎</ci><cn type="integer" id="S3.SS1.p3.2.m2.2.2.2.2.3.3.cmml" xref="S3.SS1.p3.2.m2.2.2.2.2.3.3">2</cn></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.2c">M_{a1},M_{a2}</annotation></semantics></math> and the MH of <math id="S3.SS1.p3.3.m3.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S3.SS1.p3.3.m3.1a"><mi id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><ci id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">B</annotation></semantics></math> be <math id="S3.SS1.p3.4.m4.2" class="ltx_Math" alttext="M_{b1},M_{b2}" display="inline"><semantics id="S3.SS1.p3.4.m4.2a"><mrow id="S3.SS1.p3.4.m4.2.2.2" xref="S3.SS1.p3.4.m4.2.2.3.cmml"><msub id="S3.SS1.p3.4.m4.1.1.1.1" xref="S3.SS1.p3.4.m4.1.1.1.1.cmml"><mi id="S3.SS1.p3.4.m4.1.1.1.1.2" xref="S3.SS1.p3.4.m4.1.1.1.1.2.cmml">M</mi><mrow id="S3.SS1.p3.4.m4.1.1.1.1.3" xref="S3.SS1.p3.4.m4.1.1.1.1.3.cmml"><mi id="S3.SS1.p3.4.m4.1.1.1.1.3.2" xref="S3.SS1.p3.4.m4.1.1.1.1.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.4.m4.1.1.1.1.3.1" xref="S3.SS1.p3.4.m4.1.1.1.1.3.1.cmml">​</mo><mn id="S3.SS1.p3.4.m4.1.1.1.1.3.3" xref="S3.SS1.p3.4.m4.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS1.p3.4.m4.2.2.2.3" xref="S3.SS1.p3.4.m4.2.2.3.cmml">,</mo><msub id="S3.SS1.p3.4.m4.2.2.2.2" xref="S3.SS1.p3.4.m4.2.2.2.2.cmml"><mi id="S3.SS1.p3.4.m4.2.2.2.2.2" xref="S3.SS1.p3.4.m4.2.2.2.2.2.cmml">M</mi><mrow id="S3.SS1.p3.4.m4.2.2.2.2.3" xref="S3.SS1.p3.4.m4.2.2.2.2.3.cmml"><mi id="S3.SS1.p3.4.m4.2.2.2.2.3.2" xref="S3.SS1.p3.4.m4.2.2.2.2.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.4.m4.2.2.2.2.3.1" xref="S3.SS1.p3.4.m4.2.2.2.2.3.1.cmml">​</mo><mn id="S3.SS1.p3.4.m4.2.2.2.2.3.3" xref="S3.SS1.p3.4.m4.2.2.2.2.3.3.cmml">2</mn></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.2b"><list id="S3.SS1.p3.4.m4.2.2.3.cmml" xref="S3.SS1.p3.4.m4.2.2.2"><apply id="S3.SS1.p3.4.m4.1.1.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m4.1.1.1.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p3.4.m4.1.1.1.1.2.cmml" xref="S3.SS1.p3.4.m4.1.1.1.1.2">𝑀</ci><apply id="S3.SS1.p3.4.m4.1.1.1.1.3.cmml" xref="S3.SS1.p3.4.m4.1.1.1.1.3"><times id="S3.SS1.p3.4.m4.1.1.1.1.3.1.cmml" xref="S3.SS1.p3.4.m4.1.1.1.1.3.1"></times><ci id="S3.SS1.p3.4.m4.1.1.1.1.3.2.cmml" xref="S3.SS1.p3.4.m4.1.1.1.1.3.2">𝑏</ci><cn type="integer" id="S3.SS1.p3.4.m4.1.1.1.1.3.3.cmml" xref="S3.SS1.p3.4.m4.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.SS1.p3.4.m4.2.2.2.2.cmml" xref="S3.SS1.p3.4.m4.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m4.2.2.2.2.1.cmml" xref="S3.SS1.p3.4.m4.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p3.4.m4.2.2.2.2.2.cmml" xref="S3.SS1.p3.4.m4.2.2.2.2.2">𝑀</ci><apply id="S3.SS1.p3.4.m4.2.2.2.2.3.cmml" xref="S3.SS1.p3.4.m4.2.2.2.2.3"><times id="S3.SS1.p3.4.m4.2.2.2.2.3.1.cmml" xref="S3.SS1.p3.4.m4.2.2.2.2.3.1"></times><ci id="S3.SS1.p3.4.m4.2.2.2.2.3.2.cmml" xref="S3.SS1.p3.4.m4.2.2.2.2.3.2">𝑏</ci><cn type="integer" id="S3.SS1.p3.4.m4.2.2.2.2.3.3.cmml" xref="S3.SS1.p3.4.m4.2.2.2.2.3.3">2</cn></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.2c">M_{b1},M_{b2}</annotation></semantics></math> having values in the range <math id="S3.SS1.p3.5.m5.2" class="ltx_Math" alttext="[0,1]" display="inline"><semantics id="S3.SS1.p3.5.m5.2a"><mrow id="S3.SS1.p3.5.m5.2.3.2" xref="S3.SS1.p3.5.m5.2.3.1.cmml"><mo stretchy="false" id="S3.SS1.p3.5.m5.2.3.2.1" xref="S3.SS1.p3.5.m5.2.3.1.cmml">[</mo><mn id="S3.SS1.p3.5.m5.1.1" xref="S3.SS1.p3.5.m5.1.1.cmml">0</mn><mo id="S3.SS1.p3.5.m5.2.3.2.2" xref="S3.SS1.p3.5.m5.2.3.1.cmml">,</mo><mn id="S3.SS1.p3.5.m5.2.2" xref="S3.SS1.p3.5.m5.2.2.cmml">1</mn><mo stretchy="false" id="S3.SS1.p3.5.m5.2.3.2.3" xref="S3.SS1.p3.5.m5.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.5.m5.2b"><interval closure="closed" id="S3.SS1.p3.5.m5.2.3.1.cmml" xref="S3.SS1.p3.5.m5.2.3.2"><cn type="integer" id="S3.SS1.p3.5.m5.1.1.cmml" xref="S3.SS1.p3.5.m5.1.1">0</cn><cn type="integer" id="S3.SS1.p3.5.m5.2.2.cmml" xref="S3.SS1.p3.5.m5.2.2">1</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.5.m5.2c">[0,1]</annotation></semantics></math>, where value <math id="S3.SS1.p3.6.m6.1" class="ltx_Math" alttext="0" display="inline"><semantics id="S3.SS1.p3.6.m6.1a"><mn id="S3.SS1.p3.6.m6.1.1" xref="S3.SS1.p3.6.m6.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.6.m6.1b"><cn type="integer" id="S3.SS1.p3.6.m6.1.1.cmml" xref="S3.SS1.p3.6.m6.1.1">0</cn></annotation-xml></semantics></math> denotes regions with low matching confidence and <math id="S3.SS1.p3.7.m7.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S3.SS1.p3.7.m7.1a"><mn id="S3.SS1.p3.7.m7.1.1" xref="S3.SS1.p3.7.m7.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.7.m7.1b"><cn type="integer" id="S3.SS1.p3.7.m7.1.1.cmml" xref="S3.SS1.p3.7.m7.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.7.m7.1c">1</annotation></semantics></math> denotes regions with high matching confidence (Figure <a href="#S3.F2" title="Figure 2 ‣ 3.1 Keypoint detection learning framework ‣ 3 Methodology ‣ Improving the matching of deformable objects by learning to detect keypoints" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>). The size of the MH is the same as the input image. If the position <math id="S3.SS1.p3.8.m8.2" class="ltx_Math" alttext="(x,y)" display="inline"><semantics id="S3.SS1.p3.8.m8.2a"><mrow id="S3.SS1.p3.8.m8.2.3.2" xref="S3.SS1.p3.8.m8.2.3.1.cmml"><mo stretchy="false" id="S3.SS1.p3.8.m8.2.3.2.1" xref="S3.SS1.p3.8.m8.2.3.1.cmml">(</mo><mi id="S3.SS1.p3.8.m8.1.1" xref="S3.SS1.p3.8.m8.1.1.cmml">x</mi><mo id="S3.SS1.p3.8.m8.2.3.2.2" xref="S3.SS1.p3.8.m8.2.3.1.cmml">,</mo><mi id="S3.SS1.p3.8.m8.2.2" xref="S3.SS1.p3.8.m8.2.2.cmml">y</mi><mo stretchy="false" id="S3.SS1.p3.8.m8.2.3.2.3" xref="S3.SS1.p3.8.m8.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.8.m8.2b"><interval closure="open" id="S3.SS1.p3.8.m8.2.3.1.cmml" xref="S3.SS1.p3.8.m8.2.3.2"><ci id="S3.SS1.p3.8.m8.1.1.cmml" xref="S3.SS1.p3.8.m8.1.1">𝑥</ci><ci id="S3.SS1.p3.8.m8.2.2.cmml" xref="S3.SS1.p3.8.m8.2.2">𝑦</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.8.m8.2c">(x,y)</annotation></semantics></math> is in the set <math id="S3.SS1.p3.9.m9.1" class="ltx_Math" alttext="C_{i}" display="inline"><semantics id="S3.SS1.p3.9.m9.1a"><msub id="S3.SS1.p3.9.m9.1.1" xref="S3.SS1.p3.9.m9.1.1.cmml"><mi id="S3.SS1.p3.9.m9.1.1.2" xref="S3.SS1.p3.9.m9.1.1.2.cmml">C</mi><mi id="S3.SS1.p3.9.m9.1.1.3" xref="S3.SS1.p3.9.m9.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.9.m9.1b"><apply id="S3.SS1.p3.9.m9.1.1.cmml" xref="S3.SS1.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.9.m9.1.1.1.cmml" xref="S3.SS1.p3.9.m9.1.1">subscript</csymbol><ci id="S3.SS1.p3.9.m9.1.1.2.cmml" xref="S3.SS1.p3.9.m9.1.1.2">𝐶</ci><ci id="S3.SS1.p3.9.m9.1.1.3.cmml" xref="S3.SS1.p3.9.m9.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.9.m9.1c">C_{i}</annotation></semantics></math>, we set the MH value to <math id="S3.SS1.p3.10.m10.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S3.SS1.p3.10.m10.1a"><mn id="S3.SS1.p3.10.m10.1.1" xref="S3.SS1.p3.10.m10.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.10.m10.1b"><cn type="integer" id="S3.SS1.p3.10.m10.1.1.cmml" xref="S3.SS1.p3.10.m10.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.10.m10.1c">1</annotation></semantics></math>. The final step combines the MH from all pairwise matches such that the areas in the map where descriptors were correctly matched on both match attempts, <span id="S3.SS1.p3.35.1" class="ltx_text ltx_font_italic">i.e</span>.<span id="S3.SS1.p3.35.2" class="ltx_text"></span>, matches of image <math id="S3.SS1.p3.11.m11.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S3.SS1.p3.11.m11.1a"><mi id="S3.SS1.p3.11.m11.1.1" xref="S3.SS1.p3.11.m11.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.11.m11.1b"><ci id="S3.SS1.p3.11.m11.1.1.cmml" xref="S3.SS1.p3.11.m11.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.11.m11.1c">A</annotation></semantics></math> with <math id="S3.SS1.p3.12.m12.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S3.SS1.p3.12.m12.1a"><mi id="S3.SS1.p3.12.m12.1.1" xref="S3.SS1.p3.12.m12.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.12.m12.1b"><ci id="S3.SS1.p3.12.m12.1.1.cmml" xref="S3.SS1.p3.12.m12.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.12.m12.1c">B</annotation></semantics></math> and <math id="S3.SS1.p3.13.m13.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S3.SS1.p3.13.m13.1a"><mi id="S3.SS1.p3.13.m13.1.1" xref="S3.SS1.p3.13.m13.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.13.m13.1b"><ci id="S3.SS1.p3.13.m13.1.1.cmml" xref="S3.SS1.p3.13.m13.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.13.m13.1c">A</annotation></semantics></math> with <math id="S3.SS1.p3.14.m14.1" class="ltx_Math" alttext="B^{\prime}" display="inline"><semantics id="S3.SS1.p3.14.m14.1a"><msup id="S3.SS1.p3.14.m14.1.1" xref="S3.SS1.p3.14.m14.1.1.cmml"><mi id="S3.SS1.p3.14.m14.1.1.2" xref="S3.SS1.p3.14.m14.1.1.2.cmml">B</mi><mo id="S3.SS1.p3.14.m14.1.1.3" xref="S3.SS1.p3.14.m14.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.14.m14.1b"><apply id="S3.SS1.p3.14.m14.1.1.cmml" xref="S3.SS1.p3.14.m14.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.14.m14.1.1.1.cmml" xref="S3.SS1.p3.14.m14.1.1">superscript</csymbol><ci id="S3.SS1.p3.14.m14.1.1.2.cmml" xref="S3.SS1.p3.14.m14.1.1.2">𝐵</ci><ci id="S3.SS1.p3.14.m14.1.1.3.cmml" xref="S3.SS1.p3.14.m14.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.14.m14.1c">B^{\prime}</annotation></semantics></math>, are given more weight. The final MH for image <math id="S3.SS1.p3.15.m15.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S3.SS1.p3.15.m15.1a"><mi id="S3.SS1.p3.15.m15.1.1" xref="S3.SS1.p3.15.m15.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.15.m15.1b"><ci id="S3.SS1.p3.15.m15.1.1.cmml" xref="S3.SS1.p3.15.m15.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.15.m15.1c">A</annotation></semantics></math> is therefore <math id="S3.SS1.p3.16.m16.1" class="ltx_Math" alttext="M_{a}=(M_{a1}+M_{a2})/2" display="inline"><semantics id="S3.SS1.p3.16.m16.1a"><mrow id="S3.SS1.p3.16.m16.1.1" xref="S3.SS1.p3.16.m16.1.1.cmml"><msub id="S3.SS1.p3.16.m16.1.1.3" xref="S3.SS1.p3.16.m16.1.1.3.cmml"><mi id="S3.SS1.p3.16.m16.1.1.3.2" xref="S3.SS1.p3.16.m16.1.1.3.2.cmml">M</mi><mi id="S3.SS1.p3.16.m16.1.1.3.3" xref="S3.SS1.p3.16.m16.1.1.3.3.cmml">a</mi></msub><mo id="S3.SS1.p3.16.m16.1.1.2" xref="S3.SS1.p3.16.m16.1.1.2.cmml">=</mo><mrow id="S3.SS1.p3.16.m16.1.1.1" xref="S3.SS1.p3.16.m16.1.1.1.cmml"><mrow id="S3.SS1.p3.16.m16.1.1.1.1.1" xref="S3.SS1.p3.16.m16.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p3.16.m16.1.1.1.1.1.2" xref="S3.SS1.p3.16.m16.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p3.16.m16.1.1.1.1.1.1" xref="S3.SS1.p3.16.m16.1.1.1.1.1.1.cmml"><msub id="S3.SS1.p3.16.m16.1.1.1.1.1.1.2" xref="S3.SS1.p3.16.m16.1.1.1.1.1.1.2.cmml"><mi id="S3.SS1.p3.16.m16.1.1.1.1.1.1.2.2" xref="S3.SS1.p3.16.m16.1.1.1.1.1.1.2.2.cmml">M</mi><mrow id="S3.SS1.p3.16.m16.1.1.1.1.1.1.2.3" xref="S3.SS1.p3.16.m16.1.1.1.1.1.1.2.3.cmml"><mi id="S3.SS1.p3.16.m16.1.1.1.1.1.1.2.3.2" xref="S3.SS1.p3.16.m16.1.1.1.1.1.1.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.16.m16.1.1.1.1.1.1.2.3.1" xref="S3.SS1.p3.16.m16.1.1.1.1.1.1.2.3.1.cmml">​</mo><mn id="S3.SS1.p3.16.m16.1.1.1.1.1.1.2.3.3" xref="S3.SS1.p3.16.m16.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS1.p3.16.m16.1.1.1.1.1.1.1" xref="S3.SS1.p3.16.m16.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.SS1.p3.16.m16.1.1.1.1.1.1.3" xref="S3.SS1.p3.16.m16.1.1.1.1.1.1.3.cmml"><mi id="S3.SS1.p3.16.m16.1.1.1.1.1.1.3.2" xref="S3.SS1.p3.16.m16.1.1.1.1.1.1.3.2.cmml">M</mi><mrow id="S3.SS1.p3.16.m16.1.1.1.1.1.1.3.3" xref="S3.SS1.p3.16.m16.1.1.1.1.1.1.3.3.cmml"><mi id="S3.SS1.p3.16.m16.1.1.1.1.1.1.3.3.2" xref="S3.SS1.p3.16.m16.1.1.1.1.1.1.3.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.16.m16.1.1.1.1.1.1.3.3.1" xref="S3.SS1.p3.16.m16.1.1.1.1.1.1.3.3.1.cmml">​</mo><mn id="S3.SS1.p3.16.m16.1.1.1.1.1.1.3.3.3" xref="S3.SS1.p3.16.m16.1.1.1.1.1.1.3.3.3.cmml">2</mn></mrow></msub></mrow><mo stretchy="false" id="S3.SS1.p3.16.m16.1.1.1.1.1.3" xref="S3.SS1.p3.16.m16.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS1.p3.16.m16.1.1.1.2" xref="S3.SS1.p3.16.m16.1.1.1.2.cmml">/</mo><mn id="S3.SS1.p3.16.m16.1.1.1.3" xref="S3.SS1.p3.16.m16.1.1.1.3.cmml">2</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.16.m16.1b"><apply id="S3.SS1.p3.16.m16.1.1.cmml" xref="S3.SS1.p3.16.m16.1.1"><eq id="S3.SS1.p3.16.m16.1.1.2.cmml" xref="S3.SS1.p3.16.m16.1.1.2"></eq><apply id="S3.SS1.p3.16.m16.1.1.3.cmml" xref="S3.SS1.p3.16.m16.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p3.16.m16.1.1.3.1.cmml" xref="S3.SS1.p3.16.m16.1.1.3">subscript</csymbol><ci id="S3.SS1.p3.16.m16.1.1.3.2.cmml" xref="S3.SS1.p3.16.m16.1.1.3.2">𝑀</ci><ci id="S3.SS1.p3.16.m16.1.1.3.3.cmml" xref="S3.SS1.p3.16.m16.1.1.3.3">𝑎</ci></apply><apply id="S3.SS1.p3.16.m16.1.1.1.cmml" xref="S3.SS1.p3.16.m16.1.1.1"><divide id="S3.SS1.p3.16.m16.1.1.1.2.cmml" xref="S3.SS1.p3.16.m16.1.1.1.2"></divide><apply id="S3.SS1.p3.16.m16.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.16.m16.1.1.1.1.1"><plus id="S3.SS1.p3.16.m16.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.16.m16.1.1.1.1.1.1.1"></plus><apply id="S3.SS1.p3.16.m16.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p3.16.m16.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.16.m16.1.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p3.16.m16.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS1.p3.16.m16.1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p3.16.m16.1.1.1.1.1.1.2.2">𝑀</ci><apply id="S3.SS1.p3.16.m16.1.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p3.16.m16.1.1.1.1.1.1.2.3"><times id="S3.SS1.p3.16.m16.1.1.1.1.1.1.2.3.1.cmml" xref="S3.SS1.p3.16.m16.1.1.1.1.1.1.2.3.1"></times><ci id="S3.SS1.p3.16.m16.1.1.1.1.1.1.2.3.2.cmml" xref="S3.SS1.p3.16.m16.1.1.1.1.1.1.2.3.2">𝑎</ci><cn type="integer" id="S3.SS1.p3.16.m16.1.1.1.1.1.1.2.3.3.cmml" xref="S3.SS1.p3.16.m16.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.SS1.p3.16.m16.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p3.16.m16.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p3.16.m16.1.1.1.1.1.1.3.1.cmml" xref="S3.SS1.p3.16.m16.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS1.p3.16.m16.1.1.1.1.1.1.3.2.cmml" xref="S3.SS1.p3.16.m16.1.1.1.1.1.1.3.2">𝑀</ci><apply id="S3.SS1.p3.16.m16.1.1.1.1.1.1.3.3.cmml" xref="S3.SS1.p3.16.m16.1.1.1.1.1.1.3.3"><times id="S3.SS1.p3.16.m16.1.1.1.1.1.1.3.3.1.cmml" xref="S3.SS1.p3.16.m16.1.1.1.1.1.1.3.3.1"></times><ci id="S3.SS1.p3.16.m16.1.1.1.1.1.1.3.3.2.cmml" xref="S3.SS1.p3.16.m16.1.1.1.1.1.1.3.3.2">𝑎</ci><cn type="integer" id="S3.SS1.p3.16.m16.1.1.1.1.1.1.3.3.3.cmml" xref="S3.SS1.p3.16.m16.1.1.1.1.1.1.3.3.3">2</cn></apply></apply></apply><cn type="integer" id="S3.SS1.p3.16.m16.1.1.1.3.cmml" xref="S3.SS1.p3.16.m16.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.16.m16.1c">M_{a}=(M_{a1}+M_{a2})/2</annotation></semantics></math>. A similar approach with three degrees of weights is applied to images <math id="S3.SS1.p3.17.m17.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S3.SS1.p3.17.m17.1a"><mi id="S3.SS1.p3.17.m17.1.1" xref="S3.SS1.p3.17.m17.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.17.m17.1b"><ci id="S3.SS1.p3.17.m17.1.1.cmml" xref="S3.SS1.p3.17.m17.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.17.m17.1c">B</annotation></semantics></math> and <math id="S3.SS1.p3.18.m18.1" class="ltx_Math" alttext="B^{\prime}" display="inline"><semantics id="S3.SS1.p3.18.m18.1a"><msup id="S3.SS1.p3.18.m18.1.1" xref="S3.SS1.p3.18.m18.1.1.cmml"><mi id="S3.SS1.p3.18.m18.1.1.2" xref="S3.SS1.p3.18.m18.1.1.2.cmml">B</mi><mo id="S3.SS1.p3.18.m18.1.1.3" xref="S3.SS1.p3.18.m18.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.18.m18.1b"><apply id="S3.SS1.p3.18.m18.1.1.cmml" xref="S3.SS1.p3.18.m18.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.18.m18.1.1.1.cmml" xref="S3.SS1.p3.18.m18.1.1">superscript</csymbol><ci id="S3.SS1.p3.18.m18.1.1.2.cmml" xref="S3.SS1.p3.18.m18.1.1.2">𝐵</ci><ci id="S3.SS1.p3.18.m18.1.1.3.cmml" xref="S3.SS1.p3.18.m18.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.18.m18.1c">B^{\prime}</annotation></semantics></math>. Regarding image <math id="S3.SS1.p3.19.m19.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S3.SS1.p3.19.m19.1a"><mi id="S3.SS1.p3.19.m19.1.1" xref="S3.SS1.p3.19.m19.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.19.m19.1b"><ci id="S3.SS1.p3.19.m19.1.1.cmml" xref="S3.SS1.p3.19.m19.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.19.m19.1c">B</annotation></semantics></math>, we have descriptors that are accurate in both image pairs, accurate in the match between <math id="S3.SS1.p3.20.m20.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S3.SS1.p3.20.m20.1a"><mi id="S3.SS1.p3.20.m20.1.1" xref="S3.SS1.p3.20.m20.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.20.m20.1b"><ci id="S3.SS1.p3.20.m20.1.1.cmml" xref="S3.SS1.p3.20.m20.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.20.m20.1c">B</annotation></semantics></math> and <math id="S3.SS1.p3.21.m21.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S3.SS1.p3.21.m21.1a"><mi id="S3.SS1.p3.21.m21.1.1" xref="S3.SS1.p3.21.m21.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.21.m21.1b"><ci id="S3.SS1.p3.21.m21.1.1.cmml" xref="S3.SS1.p3.21.m21.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.21.m21.1c">A</annotation></semantics></math>, and accurate in the match between <math id="S3.SS1.p3.22.m22.1" class="ltx_Math" alttext="B^{\prime}" display="inline"><semantics id="S3.SS1.p3.22.m22.1a"><msup id="S3.SS1.p3.22.m22.1.1" xref="S3.SS1.p3.22.m22.1.1.cmml"><mi id="S3.SS1.p3.22.m22.1.1.2" xref="S3.SS1.p3.22.m22.1.1.2.cmml">B</mi><mo id="S3.SS1.p3.22.m22.1.1.3" xref="S3.SS1.p3.22.m22.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.22.m22.1b"><apply id="S3.SS1.p3.22.m22.1.1.cmml" xref="S3.SS1.p3.22.m22.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.22.m22.1.1.1.cmml" xref="S3.SS1.p3.22.m22.1.1">superscript</csymbol><ci id="S3.SS1.p3.22.m22.1.1.2.cmml" xref="S3.SS1.p3.22.m22.1.1.2">𝐵</ci><ci id="S3.SS1.p3.22.m22.1.1.3.cmml" xref="S3.SS1.p3.22.m22.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.22.m22.1c">B^{\prime}</annotation></semantics></math> and <math id="S3.SS1.p3.23.m23.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S3.SS1.p3.23.m23.1a"><mi id="S3.SS1.p3.23.m23.1.1" xref="S3.SS1.p3.23.m23.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.23.m23.1b"><ci id="S3.SS1.p3.23.m23.1.1.cmml" xref="S3.SS1.p3.23.m23.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.23.m23.1c">A</annotation></semantics></math>. On the MH of <math id="S3.SS1.p3.24.m24.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S3.SS1.p3.24.m24.1a"><mi id="S3.SS1.p3.24.m24.1.1" xref="S3.SS1.p3.24.m24.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.24.m24.1b"><ci id="S3.SS1.p3.24.m24.1.1.cmml" xref="S3.SS1.p3.24.m24.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.24.m24.1c">B</annotation></semantics></math>, the latter is likewise depicted, albeit with less weight. For <math id="S3.SS1.p3.25.m25.1" class="ltx_Math" alttext="B^{\prime}" display="inline"><semantics id="S3.SS1.p3.25.m25.1a"><msup id="S3.SS1.p3.25.m25.1.1" xref="S3.SS1.p3.25.m25.1.1.cmml"><mi id="S3.SS1.p3.25.m25.1.1.2" xref="S3.SS1.p3.25.m25.1.1.2.cmml">B</mi><mo id="S3.SS1.p3.25.m25.1.1.3" xref="S3.SS1.p3.25.m25.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.25.m25.1b"><apply id="S3.SS1.p3.25.m25.1.1.cmml" xref="S3.SS1.p3.25.m25.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.25.m25.1.1.1.cmml" xref="S3.SS1.p3.25.m25.1.1">superscript</csymbol><ci id="S3.SS1.p3.25.m25.1.1.2.cmml" xref="S3.SS1.p3.25.m25.1.1.2">𝐵</ci><ci id="S3.SS1.p3.25.m25.1.1.3.cmml" xref="S3.SS1.p3.25.m25.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.25.m25.1c">B^{\prime}</annotation></semantics></math>, the same reasoning is used. As a result, the global MHs for <math id="S3.SS1.p3.26.m26.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S3.SS1.p3.26.m26.1a"><mi id="S3.SS1.p3.26.m26.1.1" xref="S3.SS1.p3.26.m26.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.26.m26.1b"><ci id="S3.SS1.p3.26.m26.1.1.cmml" xref="S3.SS1.p3.26.m26.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.26.m26.1c">B</annotation></semantics></math> and <math id="S3.SS1.p3.27.m27.1" class="ltx_Math" alttext="B^{\prime}" display="inline"><semantics id="S3.SS1.p3.27.m27.1a"><msup id="S3.SS1.p3.27.m27.1.1" xref="S3.SS1.p3.27.m27.1.1.cmml"><mi id="S3.SS1.p3.27.m27.1.1.2" xref="S3.SS1.p3.27.m27.1.1.2.cmml">B</mi><mo id="S3.SS1.p3.27.m27.1.1.3" xref="S3.SS1.p3.27.m27.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.27.m27.1b"><apply id="S3.SS1.p3.27.m27.1.1.cmml" xref="S3.SS1.p3.27.m27.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.27.m27.1.1.1.cmml" xref="S3.SS1.p3.27.m27.1.1">superscript</csymbol><ci id="S3.SS1.p3.27.m27.1.1.2.cmml" xref="S3.SS1.p3.27.m27.1.1.2">𝐵</ci><ci id="S3.SS1.p3.27.m27.1.1.3.cmml" xref="S3.SS1.p3.27.m27.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.27.m27.1c">B^{\prime}</annotation></semantics></math> are as follows: <math id="S3.SS1.p3.28.m28.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S3.SS1.p3.28.m28.1a"><mi id="S3.SS1.p3.28.m28.1.1" xref="S3.SS1.p3.28.m28.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.28.m28.1b"><ci id="S3.SS1.p3.28.m28.1.1.cmml" xref="S3.SS1.p3.28.m28.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.28.m28.1c">B</annotation></semantics></math>: <math id="S3.SS1.p3.29.m29.1" class="ltx_Math" alttext="M_{b}=(g(M_{a})+M_{b1})/2" display="inline"><semantics id="S3.SS1.p3.29.m29.1a"><mrow id="S3.SS1.p3.29.m29.1.1" xref="S3.SS1.p3.29.m29.1.1.cmml"><msub id="S3.SS1.p3.29.m29.1.1.3" xref="S3.SS1.p3.29.m29.1.1.3.cmml"><mi id="S3.SS1.p3.29.m29.1.1.3.2" xref="S3.SS1.p3.29.m29.1.1.3.2.cmml">M</mi><mi id="S3.SS1.p3.29.m29.1.1.3.3" xref="S3.SS1.p3.29.m29.1.1.3.3.cmml">b</mi></msub><mo id="S3.SS1.p3.29.m29.1.1.2" xref="S3.SS1.p3.29.m29.1.1.2.cmml">=</mo><mrow id="S3.SS1.p3.29.m29.1.1.1" xref="S3.SS1.p3.29.m29.1.1.1.cmml"><mrow id="S3.SS1.p3.29.m29.1.1.1.1.1" xref="S3.SS1.p3.29.m29.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p3.29.m29.1.1.1.1.1.2" xref="S3.SS1.p3.29.m29.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p3.29.m29.1.1.1.1.1.1" xref="S3.SS1.p3.29.m29.1.1.1.1.1.1.cmml"><mrow id="S3.SS1.p3.29.m29.1.1.1.1.1.1.1" xref="S3.SS1.p3.29.m29.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p3.29.m29.1.1.1.1.1.1.1.3" xref="S3.SS1.p3.29.m29.1.1.1.1.1.1.1.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.29.m29.1.1.1.1.1.1.1.2" xref="S3.SS1.p3.29.m29.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.SS1.p3.29.m29.1.1.1.1.1.1.1.1.1" xref="S3.SS1.p3.29.m29.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p3.29.m29.1.1.1.1.1.1.1.1.1.2" xref="S3.SS1.p3.29.m29.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS1.p3.29.m29.1.1.1.1.1.1.1.1.1.1" xref="S3.SS1.p3.29.m29.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p3.29.m29.1.1.1.1.1.1.1.1.1.1.2" xref="S3.SS1.p3.29.m29.1.1.1.1.1.1.1.1.1.1.2.cmml">M</mi><mi id="S3.SS1.p3.29.m29.1.1.1.1.1.1.1.1.1.1.3" xref="S3.SS1.p3.29.m29.1.1.1.1.1.1.1.1.1.1.3.cmml">a</mi></msub><mo stretchy="false" id="S3.SS1.p3.29.m29.1.1.1.1.1.1.1.1.1.3" xref="S3.SS1.p3.29.m29.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p3.29.m29.1.1.1.1.1.1.2" xref="S3.SS1.p3.29.m29.1.1.1.1.1.1.2.cmml">+</mo><msub id="S3.SS1.p3.29.m29.1.1.1.1.1.1.3" xref="S3.SS1.p3.29.m29.1.1.1.1.1.1.3.cmml"><mi id="S3.SS1.p3.29.m29.1.1.1.1.1.1.3.2" xref="S3.SS1.p3.29.m29.1.1.1.1.1.1.3.2.cmml">M</mi><mrow id="S3.SS1.p3.29.m29.1.1.1.1.1.1.3.3" xref="S3.SS1.p3.29.m29.1.1.1.1.1.1.3.3.cmml"><mi id="S3.SS1.p3.29.m29.1.1.1.1.1.1.3.3.2" xref="S3.SS1.p3.29.m29.1.1.1.1.1.1.3.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.29.m29.1.1.1.1.1.1.3.3.1" xref="S3.SS1.p3.29.m29.1.1.1.1.1.1.3.3.1.cmml">​</mo><mn id="S3.SS1.p3.29.m29.1.1.1.1.1.1.3.3.3" xref="S3.SS1.p3.29.m29.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo stretchy="false" id="S3.SS1.p3.29.m29.1.1.1.1.1.3" xref="S3.SS1.p3.29.m29.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS1.p3.29.m29.1.1.1.2" xref="S3.SS1.p3.29.m29.1.1.1.2.cmml">/</mo><mn id="S3.SS1.p3.29.m29.1.1.1.3" xref="S3.SS1.p3.29.m29.1.1.1.3.cmml">2</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.29.m29.1b"><apply id="S3.SS1.p3.29.m29.1.1.cmml" xref="S3.SS1.p3.29.m29.1.1"><eq id="S3.SS1.p3.29.m29.1.1.2.cmml" xref="S3.SS1.p3.29.m29.1.1.2"></eq><apply id="S3.SS1.p3.29.m29.1.1.3.cmml" xref="S3.SS1.p3.29.m29.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p3.29.m29.1.1.3.1.cmml" xref="S3.SS1.p3.29.m29.1.1.3">subscript</csymbol><ci id="S3.SS1.p3.29.m29.1.1.3.2.cmml" xref="S3.SS1.p3.29.m29.1.1.3.2">𝑀</ci><ci id="S3.SS1.p3.29.m29.1.1.3.3.cmml" xref="S3.SS1.p3.29.m29.1.1.3.3">𝑏</ci></apply><apply id="S3.SS1.p3.29.m29.1.1.1.cmml" xref="S3.SS1.p3.29.m29.1.1.1"><divide id="S3.SS1.p3.29.m29.1.1.1.2.cmml" xref="S3.SS1.p3.29.m29.1.1.1.2"></divide><apply id="S3.SS1.p3.29.m29.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.29.m29.1.1.1.1.1"><plus id="S3.SS1.p3.29.m29.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p3.29.m29.1.1.1.1.1.1.2"></plus><apply id="S3.SS1.p3.29.m29.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.29.m29.1.1.1.1.1.1.1"><times id="S3.SS1.p3.29.m29.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p3.29.m29.1.1.1.1.1.1.1.2"></times><ci id="S3.SS1.p3.29.m29.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p3.29.m29.1.1.1.1.1.1.1.3">𝑔</ci><apply id="S3.SS1.p3.29.m29.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.29.m29.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.29.m29.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.29.m29.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p3.29.m29.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p3.29.m29.1.1.1.1.1.1.1.1.1.1.2">𝑀</ci><ci id="S3.SS1.p3.29.m29.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p3.29.m29.1.1.1.1.1.1.1.1.1.1.3">𝑎</ci></apply></apply><apply id="S3.SS1.p3.29.m29.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p3.29.m29.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p3.29.m29.1.1.1.1.1.1.3.1.cmml" xref="S3.SS1.p3.29.m29.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS1.p3.29.m29.1.1.1.1.1.1.3.2.cmml" xref="S3.SS1.p3.29.m29.1.1.1.1.1.1.3.2">𝑀</ci><apply id="S3.SS1.p3.29.m29.1.1.1.1.1.1.3.3.cmml" xref="S3.SS1.p3.29.m29.1.1.1.1.1.1.3.3"><times id="S3.SS1.p3.29.m29.1.1.1.1.1.1.3.3.1.cmml" xref="S3.SS1.p3.29.m29.1.1.1.1.1.1.3.3.1"></times><ci id="S3.SS1.p3.29.m29.1.1.1.1.1.1.3.3.2.cmml" xref="S3.SS1.p3.29.m29.1.1.1.1.1.1.3.3.2">𝑏</ci><cn type="integer" id="S3.SS1.p3.29.m29.1.1.1.1.1.1.3.3.3.cmml" xref="S3.SS1.p3.29.m29.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply><cn type="integer" id="S3.SS1.p3.29.m29.1.1.1.3.cmml" xref="S3.SS1.p3.29.m29.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.29.m29.1c">M_{b}=(g(M_{a})+M_{b1})/2</annotation></semantics></math> and <math id="S3.SS1.p3.30.m30.1" class="ltx_Math" alttext="B^{\prime}" display="inline"><semantics id="S3.SS1.p3.30.m30.1a"><msup id="S3.SS1.p3.30.m30.1.1" xref="S3.SS1.p3.30.m30.1.1.cmml"><mi id="S3.SS1.p3.30.m30.1.1.2" xref="S3.SS1.p3.30.m30.1.1.2.cmml">B</mi><mo id="S3.SS1.p3.30.m30.1.1.3" xref="S3.SS1.p3.30.m30.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.30.m30.1b"><apply id="S3.SS1.p3.30.m30.1.1.cmml" xref="S3.SS1.p3.30.m30.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.30.m30.1.1.1.cmml" xref="S3.SS1.p3.30.m30.1.1">superscript</csymbol><ci id="S3.SS1.p3.30.m30.1.1.2.cmml" xref="S3.SS1.p3.30.m30.1.1.2">𝐵</ci><ci id="S3.SS1.p3.30.m30.1.1.3.cmml" xref="S3.SS1.p3.30.m30.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.30.m30.1c">B^{\prime}</annotation></semantics></math>: <math id="S3.SS1.p3.31.m31.1" class="ltx_Math" alttext="M_{b^{\prime}}=(g^{\prime}(M_{a})+M_{b2})/2" display="inline"><semantics id="S3.SS1.p3.31.m31.1a"><mrow id="S3.SS1.p3.31.m31.1.1" xref="S3.SS1.p3.31.m31.1.1.cmml"><msub id="S3.SS1.p3.31.m31.1.1.3" xref="S3.SS1.p3.31.m31.1.1.3.cmml"><mi id="S3.SS1.p3.31.m31.1.1.3.2" xref="S3.SS1.p3.31.m31.1.1.3.2.cmml">M</mi><msup id="S3.SS1.p3.31.m31.1.1.3.3" xref="S3.SS1.p3.31.m31.1.1.3.3.cmml"><mi id="S3.SS1.p3.31.m31.1.1.3.3.2" xref="S3.SS1.p3.31.m31.1.1.3.3.2.cmml">b</mi><mo id="S3.SS1.p3.31.m31.1.1.3.3.3" xref="S3.SS1.p3.31.m31.1.1.3.3.3.cmml">′</mo></msup></msub><mo id="S3.SS1.p3.31.m31.1.1.2" xref="S3.SS1.p3.31.m31.1.1.2.cmml">=</mo><mrow id="S3.SS1.p3.31.m31.1.1.1" xref="S3.SS1.p3.31.m31.1.1.1.cmml"><mrow id="S3.SS1.p3.31.m31.1.1.1.1.1" xref="S3.SS1.p3.31.m31.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p3.31.m31.1.1.1.1.1.2" xref="S3.SS1.p3.31.m31.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p3.31.m31.1.1.1.1.1.1" xref="S3.SS1.p3.31.m31.1.1.1.1.1.1.cmml"><mrow id="S3.SS1.p3.31.m31.1.1.1.1.1.1.1" xref="S3.SS1.p3.31.m31.1.1.1.1.1.1.1.cmml"><msup id="S3.SS1.p3.31.m31.1.1.1.1.1.1.1.3" xref="S3.SS1.p3.31.m31.1.1.1.1.1.1.1.3.cmml"><mi id="S3.SS1.p3.31.m31.1.1.1.1.1.1.1.3.2" xref="S3.SS1.p3.31.m31.1.1.1.1.1.1.1.3.2.cmml">g</mi><mo id="S3.SS1.p3.31.m31.1.1.1.1.1.1.1.3.3" xref="S3.SS1.p3.31.m31.1.1.1.1.1.1.1.3.3.cmml">′</mo></msup><mo lspace="0em" rspace="0em" id="S3.SS1.p3.31.m31.1.1.1.1.1.1.1.2" xref="S3.SS1.p3.31.m31.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.SS1.p3.31.m31.1.1.1.1.1.1.1.1.1" xref="S3.SS1.p3.31.m31.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p3.31.m31.1.1.1.1.1.1.1.1.1.2" xref="S3.SS1.p3.31.m31.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS1.p3.31.m31.1.1.1.1.1.1.1.1.1.1" xref="S3.SS1.p3.31.m31.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p3.31.m31.1.1.1.1.1.1.1.1.1.1.2" xref="S3.SS1.p3.31.m31.1.1.1.1.1.1.1.1.1.1.2.cmml">M</mi><mi id="S3.SS1.p3.31.m31.1.1.1.1.1.1.1.1.1.1.3" xref="S3.SS1.p3.31.m31.1.1.1.1.1.1.1.1.1.1.3.cmml">a</mi></msub><mo stretchy="false" id="S3.SS1.p3.31.m31.1.1.1.1.1.1.1.1.1.3" xref="S3.SS1.p3.31.m31.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p3.31.m31.1.1.1.1.1.1.2" xref="S3.SS1.p3.31.m31.1.1.1.1.1.1.2.cmml">+</mo><msub id="S3.SS1.p3.31.m31.1.1.1.1.1.1.3" xref="S3.SS1.p3.31.m31.1.1.1.1.1.1.3.cmml"><mi id="S3.SS1.p3.31.m31.1.1.1.1.1.1.3.2" xref="S3.SS1.p3.31.m31.1.1.1.1.1.1.3.2.cmml">M</mi><mrow id="S3.SS1.p3.31.m31.1.1.1.1.1.1.3.3" xref="S3.SS1.p3.31.m31.1.1.1.1.1.1.3.3.cmml"><mi id="S3.SS1.p3.31.m31.1.1.1.1.1.1.3.3.2" xref="S3.SS1.p3.31.m31.1.1.1.1.1.1.3.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.31.m31.1.1.1.1.1.1.3.3.1" xref="S3.SS1.p3.31.m31.1.1.1.1.1.1.3.3.1.cmml">​</mo><mn id="S3.SS1.p3.31.m31.1.1.1.1.1.1.3.3.3" xref="S3.SS1.p3.31.m31.1.1.1.1.1.1.3.3.3.cmml">2</mn></mrow></msub></mrow><mo stretchy="false" id="S3.SS1.p3.31.m31.1.1.1.1.1.3" xref="S3.SS1.p3.31.m31.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS1.p3.31.m31.1.1.1.2" xref="S3.SS1.p3.31.m31.1.1.1.2.cmml">/</mo><mn id="S3.SS1.p3.31.m31.1.1.1.3" xref="S3.SS1.p3.31.m31.1.1.1.3.cmml">2</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.31.m31.1b"><apply id="S3.SS1.p3.31.m31.1.1.cmml" xref="S3.SS1.p3.31.m31.1.1"><eq id="S3.SS1.p3.31.m31.1.1.2.cmml" xref="S3.SS1.p3.31.m31.1.1.2"></eq><apply id="S3.SS1.p3.31.m31.1.1.3.cmml" xref="S3.SS1.p3.31.m31.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p3.31.m31.1.1.3.1.cmml" xref="S3.SS1.p3.31.m31.1.1.3">subscript</csymbol><ci id="S3.SS1.p3.31.m31.1.1.3.2.cmml" xref="S3.SS1.p3.31.m31.1.1.3.2">𝑀</ci><apply id="S3.SS1.p3.31.m31.1.1.3.3.cmml" xref="S3.SS1.p3.31.m31.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p3.31.m31.1.1.3.3.1.cmml" xref="S3.SS1.p3.31.m31.1.1.3.3">superscript</csymbol><ci id="S3.SS1.p3.31.m31.1.1.3.3.2.cmml" xref="S3.SS1.p3.31.m31.1.1.3.3.2">𝑏</ci><ci id="S3.SS1.p3.31.m31.1.1.3.3.3.cmml" xref="S3.SS1.p3.31.m31.1.1.3.3.3">′</ci></apply></apply><apply id="S3.SS1.p3.31.m31.1.1.1.cmml" xref="S3.SS1.p3.31.m31.1.1.1"><divide id="S3.SS1.p3.31.m31.1.1.1.2.cmml" xref="S3.SS1.p3.31.m31.1.1.1.2"></divide><apply id="S3.SS1.p3.31.m31.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.31.m31.1.1.1.1.1"><plus id="S3.SS1.p3.31.m31.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p3.31.m31.1.1.1.1.1.1.2"></plus><apply id="S3.SS1.p3.31.m31.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.31.m31.1.1.1.1.1.1.1"><times id="S3.SS1.p3.31.m31.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p3.31.m31.1.1.1.1.1.1.1.2"></times><apply id="S3.SS1.p3.31.m31.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p3.31.m31.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p3.31.m31.1.1.1.1.1.1.1.3.1.cmml" xref="S3.SS1.p3.31.m31.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.SS1.p3.31.m31.1.1.1.1.1.1.1.3.2.cmml" xref="S3.SS1.p3.31.m31.1.1.1.1.1.1.1.3.2">𝑔</ci><ci id="S3.SS1.p3.31.m31.1.1.1.1.1.1.1.3.3.cmml" xref="S3.SS1.p3.31.m31.1.1.1.1.1.1.1.3.3">′</ci></apply><apply id="S3.SS1.p3.31.m31.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.31.m31.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.31.m31.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.31.m31.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p3.31.m31.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p3.31.m31.1.1.1.1.1.1.1.1.1.1.2">𝑀</ci><ci id="S3.SS1.p3.31.m31.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p3.31.m31.1.1.1.1.1.1.1.1.1.1.3">𝑎</ci></apply></apply><apply id="S3.SS1.p3.31.m31.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p3.31.m31.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p3.31.m31.1.1.1.1.1.1.3.1.cmml" xref="S3.SS1.p3.31.m31.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS1.p3.31.m31.1.1.1.1.1.1.3.2.cmml" xref="S3.SS1.p3.31.m31.1.1.1.1.1.1.3.2">𝑀</ci><apply id="S3.SS1.p3.31.m31.1.1.1.1.1.1.3.3.cmml" xref="S3.SS1.p3.31.m31.1.1.1.1.1.1.3.3"><times id="S3.SS1.p3.31.m31.1.1.1.1.1.1.3.3.1.cmml" xref="S3.SS1.p3.31.m31.1.1.1.1.1.1.3.3.1"></times><ci id="S3.SS1.p3.31.m31.1.1.1.1.1.1.3.3.2.cmml" xref="S3.SS1.p3.31.m31.1.1.1.1.1.1.3.3.2">𝑏</ci><cn type="integer" id="S3.SS1.p3.31.m31.1.1.1.1.1.1.3.3.3.cmml" xref="S3.SS1.p3.31.m31.1.1.1.1.1.1.3.3.3">2</cn></apply></apply></apply><cn type="integer" id="S3.SS1.p3.31.m31.1.1.1.3.cmml" xref="S3.SS1.p3.31.m31.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.31.m31.1c">M_{b^{\prime}}=(g^{\prime}(M_{a})+M_{b2})/2</annotation></semantics></math>. At the end of this operation, we utilize images <math id="S3.SS1.p3.32.m32.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S3.SS1.p3.32.m32.1a"><mi id="S3.SS1.p3.32.m32.1.1" xref="S3.SS1.p3.32.m32.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.32.m32.1b"><ci id="S3.SS1.p3.32.m32.1.1.cmml" xref="S3.SS1.p3.32.m32.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.32.m32.1c">B</annotation></semantics></math> and <math id="S3.SS1.p3.33.m33.1" class="ltx_Math" alttext="B^{\prime}" display="inline"><semantics id="S3.SS1.p3.33.m33.1a"><msup id="S3.SS1.p3.33.m33.1.1" xref="S3.SS1.p3.33.m33.1.1.cmml"><mi id="S3.SS1.p3.33.m33.1.1.2" xref="S3.SS1.p3.33.m33.1.1.2.cmml">B</mi><mo id="S3.SS1.p3.33.m33.1.1.3" xref="S3.SS1.p3.33.m33.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.33.m33.1b"><apply id="S3.SS1.p3.33.m33.1.1.cmml" xref="S3.SS1.p3.33.m33.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.33.m33.1.1.1.cmml" xref="S3.SS1.p3.33.m33.1.1">superscript</csymbol><ci id="S3.SS1.p3.33.m33.1.1.2.cmml" xref="S3.SS1.p3.33.m33.1.1.2">𝐵</ci><ci id="S3.SS1.p3.33.m33.1.1.3.cmml" xref="S3.SS1.p3.33.m33.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.33.m33.1c">B^{\prime}</annotation></semantics></math> and their respective matching heatmaps to train the network. A <math id="S3.SS1.p3.34.m34.1" class="ltx_Math" alttext="3\times 3" display="inline"><semantics id="S3.SS1.p3.34.m34.1a"><mrow id="S3.SS1.p3.34.m34.1.1" xref="S3.SS1.p3.34.m34.1.1.cmml"><mn id="S3.SS1.p3.34.m34.1.1.2" xref="S3.SS1.p3.34.m34.1.1.2.cmml">3</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p3.34.m34.1.1.1" xref="S3.SS1.p3.34.m34.1.1.1.cmml">×</mo><mn id="S3.SS1.p3.34.m34.1.1.3" xref="S3.SS1.p3.34.m34.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.34.m34.1b"><apply id="S3.SS1.p3.34.m34.1.1.cmml" xref="S3.SS1.p3.34.m34.1.1"><times id="S3.SS1.p3.34.m34.1.1.1.cmml" xref="S3.SS1.p3.34.m34.1.1.1"></times><cn type="integer" id="S3.SS1.p3.34.m34.1.1.2.cmml" xref="S3.SS1.p3.34.m34.1.1.2">3</cn><cn type="integer" id="S3.SS1.p3.34.m34.1.1.3.cmml" xref="S3.SS1.p3.34.m34.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.34.m34.1c">3\times 3</annotation></semantics></math> Gaussian kernel with <math id="S3.SS1.p3.35.m35.1" class="ltx_Math" alttext="\sigma=1.5" display="inline"><semantics id="S3.SS1.p3.35.m35.1a"><mrow id="S3.SS1.p3.35.m35.1.1" xref="S3.SS1.p3.35.m35.1.1.cmml"><mi id="S3.SS1.p3.35.m35.1.1.2" xref="S3.SS1.p3.35.m35.1.1.2.cmml">σ</mi><mo id="S3.SS1.p3.35.m35.1.1.1" xref="S3.SS1.p3.35.m35.1.1.1.cmml">=</mo><mn id="S3.SS1.p3.35.m35.1.1.3" xref="S3.SS1.p3.35.m35.1.1.3.cmml">1.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.35.m35.1b"><apply id="S3.SS1.p3.35.m35.1.1.cmml" xref="S3.SS1.p3.35.m35.1.1"><eq id="S3.SS1.p3.35.m35.1.1.1.cmml" xref="S3.SS1.p3.35.m35.1.1.1"></eq><ci id="S3.SS1.p3.35.m35.1.1.2.cmml" xref="S3.SS1.p3.35.m35.1.1.2">𝜎</ci><cn type="float" id="S3.SS1.p3.35.m35.1.1.3.cmml" xref="S3.SS1.p3.35.m35.1.1.3">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.35.m35.1c">\sigma=1.5</annotation></semantics></math> is applied to each binary MH for it to peak at the ground truth keypoint coordinates. This makes it simpler for the CNN model to learn the global MH. We chose this kernel size to maintain a small activation neighborhood while maintaining smoothness in the heatmaps.</p>
</div>
<div id="S3.SS1.p4" class="ltx_para">
<p id="S3.SS1.p4.1" class="ltx_p">Finally, each image’s high-confidence locations to be matched are present on the MH. As we select only repetitive keypoints by choosing the right matches, we also impose our model to learn repeatable points. Siamese training <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite> is used to boost similarities between the score map and the MH of the anchor image and its transformations to further reinforce the repeatability of the detected keypoints. These techniques increase the detector’s repeatability when subject to geometric changes. It is important to highlight that our strategy is agnostic to the base detector and descriptor used to generate the ground truth of correspondences. In the experiments, we demonstrate how the suggested detection strategy can enhance the matching ability of three recent descriptors.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Loss function</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.12" class="ltx_p">Due to the uneven distribution of positive and negative pixels in the MH, using the entire map for training would bias the model’s predictions in favor of maps with generally very low scores. Therefore for each positive keypoint match in the training, we randomly choose a certain number of negative keypoint instances to address this issue. We uniformly sample <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">n</annotation></semantics></math> negative examples and back-propagate <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="2n" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><mrow id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mn id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.SS2.p1.2.m2.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.cmml">​</mo><mi id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><times id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1"></times><cn type="integer" id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">2</cn><ci id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">2n</annotation></semantics></math> examples, where <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><mi id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">n</annotation></semantics></math> is the number of positive keypoints in each image. This strategy is expressed as a binary pixel-wise mask <math id="S3.SS2.p1.4.m4.1" class="ltx_Math" alttext="F" display="inline"><semantics id="S3.SS2.p1.4.m4.1a"><mi id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><ci id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">F</annotation></semantics></math> with the value <math id="S3.SS2.p1.5.m5.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S3.SS2.p1.5.m5.1a"><mn id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><cn type="integer" id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">1</annotation></semantics></math> at the coordinates of the selected pixels and the value <math id="S3.SS2.p1.6.m6.1" class="ltx_Math" alttext="0" display="inline"><semantics id="S3.SS2.p1.6.m6.1a"><mn id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><cn type="integer" id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">0</cn></annotation-xml></semantics></math> otherwise. We define <math id="S3.SS2.p1.7.m7.1" class="ltx_Math" alttext="S^{\prime}=S\times F" display="inline"><semantics id="S3.SS2.p1.7.m7.1a"><mrow id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml"><msup id="S3.SS2.p1.7.m7.1.1.2" xref="S3.SS2.p1.7.m7.1.1.2.cmml"><mi id="S3.SS2.p1.7.m7.1.1.2.2" xref="S3.SS2.p1.7.m7.1.1.2.2.cmml">S</mi><mo id="S3.SS2.p1.7.m7.1.1.2.3" xref="S3.SS2.p1.7.m7.1.1.2.3.cmml">′</mo></msup><mo id="S3.SS2.p1.7.m7.1.1.1" xref="S3.SS2.p1.7.m7.1.1.1.cmml">=</mo><mrow id="S3.SS2.p1.7.m7.1.1.3" xref="S3.SS2.p1.7.m7.1.1.3.cmml"><mi id="S3.SS2.p1.7.m7.1.1.3.2" xref="S3.SS2.p1.7.m7.1.1.3.2.cmml">S</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p1.7.m7.1.1.3.1" xref="S3.SS2.p1.7.m7.1.1.3.1.cmml">×</mo><mi id="S3.SS2.p1.7.m7.1.1.3.3" xref="S3.SS2.p1.7.m7.1.1.3.3.cmml">F</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><apply id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1"><eq id="S3.SS2.p1.7.m7.1.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1.1"></eq><apply id="S3.SS2.p1.7.m7.1.1.2.cmml" xref="S3.SS2.p1.7.m7.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.1.1.2.1.cmml" xref="S3.SS2.p1.7.m7.1.1.2">superscript</csymbol><ci id="S3.SS2.p1.7.m7.1.1.2.2.cmml" xref="S3.SS2.p1.7.m7.1.1.2.2">𝑆</ci><ci id="S3.SS2.p1.7.m7.1.1.2.3.cmml" xref="S3.SS2.p1.7.m7.1.1.2.3">′</ci></apply><apply id="S3.SS2.p1.7.m7.1.1.3.cmml" xref="S3.SS2.p1.7.m7.1.1.3"><times id="S3.SS2.p1.7.m7.1.1.3.1.cmml" xref="S3.SS2.p1.7.m7.1.1.3.1"></times><ci id="S3.SS2.p1.7.m7.1.1.3.2.cmml" xref="S3.SS2.p1.7.m7.1.1.3.2">𝑆</ci><ci id="S3.SS2.p1.7.m7.1.1.3.3.cmml" xref="S3.SS2.p1.7.m7.1.1.3.3">𝐹</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">S^{\prime}=S\times F</annotation></semantics></math> given an image <math id="S3.SS2.p1.8.m8.1" class="ltx_Math" alttext="I" display="inline"><semantics id="S3.SS2.p1.8.m8.1a"><mi id="S3.SS2.p1.8.m8.1.1" xref="S3.SS2.p1.8.m8.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m8.1b"><ci id="S3.SS2.p1.8.m8.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m8.1c">I</annotation></semantics></math>, its respective MH <math id="S3.SS2.p1.9.m9.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS2.p1.9.m9.1a"><mi id="S3.SS2.p1.9.m9.1.1" xref="S3.SS2.p1.9.m9.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m9.1b"><ci id="S3.SS2.p1.9.m9.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m9.1c">M</annotation></semantics></math>, and the model output score map <math id="S3.SS2.p1.10.m10.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S3.SS2.p1.10.m10.1a"><mi id="S3.SS2.p1.10.m10.1.1" xref="S3.SS2.p1.10.m10.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.m10.1b"><ci id="S3.SS2.p1.10.m10.1.1.cmml" xref="S3.SS2.p1.10.m10.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.10.m10.1c">S</annotation></semantics></math>. Finally, we apply the cosine similarity to optimize the similarity between the MH <math id="S3.SS2.p1.11.m11.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS2.p1.11.m11.1a"><mi id="S3.SS2.p1.11.m11.1.1" xref="S3.SS2.p1.11.m11.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.11.m11.1b"><ci id="S3.SS2.p1.11.m11.1.1.cmml" xref="S3.SS2.p1.11.m11.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.11.m11.1c">M</annotation></semantics></math> and the estimated score map image from the network <math id="S3.SS2.p1.12.m12.1" class="ltx_Math" alttext="S^{\prime}" display="inline"><semantics id="S3.SS2.p1.12.m12.1a"><msup id="S3.SS2.p1.12.m12.1.1" xref="S3.SS2.p1.12.m12.1.1.cmml"><mi id="S3.SS2.p1.12.m12.1.1.2" xref="S3.SS2.p1.12.m12.1.1.2.cmml">S</mi><mo id="S3.SS2.p1.12.m12.1.1.3" xref="S3.SS2.p1.12.m12.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.12.m12.1b"><apply id="S3.SS2.p1.12.m12.1.1.cmml" xref="S3.SS2.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.12.m12.1.1.1.cmml" xref="S3.SS2.p1.12.m12.1.1">superscript</csymbol><ci id="S3.SS2.p1.12.m12.1.1.2.cmml" xref="S3.SS2.p1.12.m12.1.1.2">𝑆</ci><ci id="S3.SS2.p1.12.m12.1.1.3.cmml" xref="S3.SS2.p1.12.m12.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.12.m12.1c">S^{\prime}</annotation></semantics></math>:</p>
<table id="S3.Ex1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S3.Ex1.m1.3" class="ltx_Math" alttext="\mathcal{L}_{cossim}(I)=1-cossim\left(S^{\prime},M\right)." display="block"><semantics id="S3.Ex1.m1.3a"><mrow id="S3.Ex1.m1.3.3.1" xref="S3.Ex1.m1.3.3.1.1.cmml"><mrow id="S3.Ex1.m1.3.3.1.1" xref="S3.Ex1.m1.3.3.1.1.cmml"><mrow id="S3.Ex1.m1.3.3.1.1.3" xref="S3.Ex1.m1.3.3.1.1.3.cmml"><msub id="S3.Ex1.m1.3.3.1.1.3.2" xref="S3.Ex1.m1.3.3.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m1.3.3.1.1.3.2.2" xref="S3.Ex1.m1.3.3.1.1.3.2.2.cmml">ℒ</mi><mrow id="S3.Ex1.m1.3.3.1.1.3.2.3" xref="S3.Ex1.m1.3.3.1.1.3.2.3.cmml"><mi id="S3.Ex1.m1.3.3.1.1.3.2.3.2" xref="S3.Ex1.m1.3.3.1.1.3.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.3.3.1.1.3.2.3.1" xref="S3.Ex1.m1.3.3.1.1.3.2.3.1.cmml">​</mo><mi id="S3.Ex1.m1.3.3.1.1.3.2.3.3" xref="S3.Ex1.m1.3.3.1.1.3.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.3.3.1.1.3.2.3.1a" xref="S3.Ex1.m1.3.3.1.1.3.2.3.1.cmml">​</mo><mi id="S3.Ex1.m1.3.3.1.1.3.2.3.4" xref="S3.Ex1.m1.3.3.1.1.3.2.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.3.3.1.1.3.2.3.1b" xref="S3.Ex1.m1.3.3.1.1.3.2.3.1.cmml">​</mo><mi id="S3.Ex1.m1.3.3.1.1.3.2.3.5" xref="S3.Ex1.m1.3.3.1.1.3.2.3.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.3.3.1.1.3.2.3.1c" xref="S3.Ex1.m1.3.3.1.1.3.2.3.1.cmml">​</mo><mi id="S3.Ex1.m1.3.3.1.1.3.2.3.6" xref="S3.Ex1.m1.3.3.1.1.3.2.3.6.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.3.3.1.1.3.2.3.1d" xref="S3.Ex1.m1.3.3.1.1.3.2.3.1.cmml">​</mo><mi id="S3.Ex1.m1.3.3.1.1.3.2.3.7" xref="S3.Ex1.m1.3.3.1.1.3.2.3.7.cmml">m</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.3.3.1.1.3.1" xref="S3.Ex1.m1.3.3.1.1.3.1.cmml">​</mo><mrow id="S3.Ex1.m1.3.3.1.1.3.3.2" xref="S3.Ex1.m1.3.3.1.1.3.cmml"><mo stretchy="false" id="S3.Ex1.m1.3.3.1.1.3.3.2.1" xref="S3.Ex1.m1.3.3.1.1.3.cmml">(</mo><mi id="S3.Ex1.m1.1.1" xref="S3.Ex1.m1.1.1.cmml">I</mi><mo stretchy="false" id="S3.Ex1.m1.3.3.1.1.3.3.2.2" xref="S3.Ex1.m1.3.3.1.1.3.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m1.3.3.1.1.2" xref="S3.Ex1.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.Ex1.m1.3.3.1.1.1" xref="S3.Ex1.m1.3.3.1.1.1.cmml"><mn id="S3.Ex1.m1.3.3.1.1.1.3" xref="S3.Ex1.m1.3.3.1.1.1.3.cmml">1</mn><mo id="S3.Ex1.m1.3.3.1.1.1.2" xref="S3.Ex1.m1.3.3.1.1.1.2.cmml">−</mo><mrow id="S3.Ex1.m1.3.3.1.1.1.1" xref="S3.Ex1.m1.3.3.1.1.1.1.cmml"><mi id="S3.Ex1.m1.3.3.1.1.1.1.3" xref="S3.Ex1.m1.3.3.1.1.1.1.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.3.3.1.1.1.1.2" xref="S3.Ex1.m1.3.3.1.1.1.1.2.cmml">​</mo><mi id="S3.Ex1.m1.3.3.1.1.1.1.4" xref="S3.Ex1.m1.3.3.1.1.1.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.3.3.1.1.1.1.2a" xref="S3.Ex1.m1.3.3.1.1.1.1.2.cmml">​</mo><mi id="S3.Ex1.m1.3.3.1.1.1.1.5" xref="S3.Ex1.m1.3.3.1.1.1.1.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.3.3.1.1.1.1.2b" xref="S3.Ex1.m1.3.3.1.1.1.1.2.cmml">​</mo><mi id="S3.Ex1.m1.3.3.1.1.1.1.6" xref="S3.Ex1.m1.3.3.1.1.1.1.6.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.3.3.1.1.1.1.2c" xref="S3.Ex1.m1.3.3.1.1.1.1.2.cmml">​</mo><mi id="S3.Ex1.m1.3.3.1.1.1.1.7" xref="S3.Ex1.m1.3.3.1.1.1.1.7.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.3.3.1.1.1.1.2d" xref="S3.Ex1.m1.3.3.1.1.1.1.2.cmml">​</mo><mi id="S3.Ex1.m1.3.3.1.1.1.1.8" xref="S3.Ex1.m1.3.3.1.1.1.1.8.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.3.3.1.1.1.1.2e" xref="S3.Ex1.m1.3.3.1.1.1.1.2.cmml">​</mo><mrow id="S3.Ex1.m1.3.3.1.1.1.1.1.1" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2.cmml"><mo id="S3.Ex1.m1.3.3.1.1.1.1.1.1.2" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2.cmml">(</mo><msup id="S3.Ex1.m1.3.3.1.1.1.1.1.1.1" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.2.cmml">S</mi><mo id="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="S3.Ex1.m1.3.3.1.1.1.1.1.1.3" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2.cmml">,</mo><mi id="S3.Ex1.m1.2.2" xref="S3.Ex1.m1.2.2.cmml">M</mi><mo id="S3.Ex1.m1.3.3.1.1.1.1.1.1.4" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.Ex1.m1.3.3.1.2" xref="S3.Ex1.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.3b"><apply id="S3.Ex1.m1.3.3.1.1.cmml" xref="S3.Ex1.m1.3.3.1"><eq id="S3.Ex1.m1.3.3.1.1.2.cmml" xref="S3.Ex1.m1.3.3.1.1.2"></eq><apply id="S3.Ex1.m1.3.3.1.1.3.cmml" xref="S3.Ex1.m1.3.3.1.1.3"><times id="S3.Ex1.m1.3.3.1.1.3.1.cmml" xref="S3.Ex1.m1.3.3.1.1.3.1"></times><apply id="S3.Ex1.m1.3.3.1.1.3.2.cmml" xref="S3.Ex1.m1.3.3.1.1.3.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.3.3.1.1.3.2.1.cmml" xref="S3.Ex1.m1.3.3.1.1.3.2">subscript</csymbol><ci id="S3.Ex1.m1.3.3.1.1.3.2.2.cmml" xref="S3.Ex1.m1.3.3.1.1.3.2.2">ℒ</ci><apply id="S3.Ex1.m1.3.3.1.1.3.2.3.cmml" xref="S3.Ex1.m1.3.3.1.1.3.2.3"><times id="S3.Ex1.m1.3.3.1.1.3.2.3.1.cmml" xref="S3.Ex1.m1.3.3.1.1.3.2.3.1"></times><ci id="S3.Ex1.m1.3.3.1.1.3.2.3.2.cmml" xref="S3.Ex1.m1.3.3.1.1.3.2.3.2">𝑐</ci><ci id="S3.Ex1.m1.3.3.1.1.3.2.3.3.cmml" xref="S3.Ex1.m1.3.3.1.1.3.2.3.3">𝑜</ci><ci id="S3.Ex1.m1.3.3.1.1.3.2.3.4.cmml" xref="S3.Ex1.m1.3.3.1.1.3.2.3.4">𝑠</ci><ci id="S3.Ex1.m1.3.3.1.1.3.2.3.5.cmml" xref="S3.Ex1.m1.3.3.1.1.3.2.3.5">𝑠</ci><ci id="S3.Ex1.m1.3.3.1.1.3.2.3.6.cmml" xref="S3.Ex1.m1.3.3.1.1.3.2.3.6">𝑖</ci><ci id="S3.Ex1.m1.3.3.1.1.3.2.3.7.cmml" xref="S3.Ex1.m1.3.3.1.1.3.2.3.7">𝑚</ci></apply></apply><ci id="S3.Ex1.m1.1.1.cmml" xref="S3.Ex1.m1.1.1">𝐼</ci></apply><apply id="S3.Ex1.m1.3.3.1.1.1.cmml" xref="S3.Ex1.m1.3.3.1.1.1"><minus id="S3.Ex1.m1.3.3.1.1.1.2.cmml" xref="S3.Ex1.m1.3.3.1.1.1.2"></minus><cn type="integer" id="S3.Ex1.m1.3.3.1.1.1.3.cmml" xref="S3.Ex1.m1.3.3.1.1.1.3">1</cn><apply id="S3.Ex1.m1.3.3.1.1.1.1.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1"><times id="S3.Ex1.m1.3.3.1.1.1.1.2.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.2"></times><ci id="S3.Ex1.m1.3.3.1.1.1.1.3.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.3">𝑐</ci><ci id="S3.Ex1.m1.3.3.1.1.1.1.4.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.4">𝑜</ci><ci id="S3.Ex1.m1.3.3.1.1.1.1.5.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.5">𝑠</ci><ci id="S3.Ex1.m1.3.3.1.1.1.1.6.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.6">𝑠</ci><ci id="S3.Ex1.m1.3.3.1.1.1.1.7.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.7">𝑖</ci><ci id="S3.Ex1.m1.3.3.1.1.1.1.8.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.8">𝑚</ci><interval closure="open" id="S3.Ex1.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1"><apply id="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.2">𝑆</ci><ci id="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.3">′</ci></apply><ci id="S3.Ex1.m1.2.2.cmml" xref="S3.Ex1.m1.2.2">𝑀</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.3c">\mathcal{L}_{cossim}(I)=1-cossim\left(S^{\prime},M\right).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.19" class="ltx_p">We chose the cosine similarity to improve the keypoint localization, as this loss focuses more on assuring that the high responses between the ground truth and the predicted map are in the same location rather than on the magnitude of the values between the score maps. Also, to optimize the peaks values, we take the following L2 loss into account:</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S3.E3.m1.2" class="ltx_Math" alttext="\mathcal{L}_{simple}(I)=\frac{1}{2n}\sum_{i=1}^{H\cdot W}\left(S^{\prime}_{i}-M_{i}\right)^{2}." display="block"><semantics id="S3.E3.m1.2a"><mrow id="S3.E3.m1.2.2.1" xref="S3.E3.m1.2.2.1.1.cmml"><mrow id="S3.E3.m1.2.2.1.1" xref="S3.E3.m1.2.2.1.1.cmml"><mrow id="S3.E3.m1.2.2.1.1.3" xref="S3.E3.m1.2.2.1.1.3.cmml"><msub id="S3.E3.m1.2.2.1.1.3.2" xref="S3.E3.m1.2.2.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.2.2.1.1.3.2.2" xref="S3.E3.m1.2.2.1.1.3.2.2.cmml">ℒ</mi><mrow id="S3.E3.m1.2.2.1.1.3.2.3" xref="S3.E3.m1.2.2.1.1.3.2.3.cmml"><mi id="S3.E3.m1.2.2.1.1.3.2.3.2" xref="S3.E3.m1.2.2.1.1.3.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.1.1.3.2.3.1" xref="S3.E3.m1.2.2.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E3.m1.2.2.1.1.3.2.3.3" xref="S3.E3.m1.2.2.1.1.3.2.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.1.1.3.2.3.1a" xref="S3.E3.m1.2.2.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E3.m1.2.2.1.1.3.2.3.4" xref="S3.E3.m1.2.2.1.1.3.2.3.4.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.1.1.3.2.3.1b" xref="S3.E3.m1.2.2.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E3.m1.2.2.1.1.3.2.3.5" xref="S3.E3.m1.2.2.1.1.3.2.3.5.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.1.1.3.2.3.1c" xref="S3.E3.m1.2.2.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E3.m1.2.2.1.1.3.2.3.6" xref="S3.E3.m1.2.2.1.1.3.2.3.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.1.1.3.2.3.1d" xref="S3.E3.m1.2.2.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E3.m1.2.2.1.1.3.2.3.7" xref="S3.E3.m1.2.2.1.1.3.2.3.7.cmml">e</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.1.1.3.1" xref="S3.E3.m1.2.2.1.1.3.1.cmml">​</mo><mrow id="S3.E3.m1.2.2.1.1.3.3.2" xref="S3.E3.m1.2.2.1.1.3.cmml"><mo stretchy="false" id="S3.E3.m1.2.2.1.1.3.3.2.1" xref="S3.E3.m1.2.2.1.1.3.cmml">(</mo><mi id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">I</mi><mo stretchy="false" id="S3.E3.m1.2.2.1.1.3.3.2.2" xref="S3.E3.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.2.2.1.1.2" xref="S3.E3.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.E3.m1.2.2.1.1.1" xref="S3.E3.m1.2.2.1.1.1.cmml"><mfrac id="S3.E3.m1.2.2.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.3.cmml"><mn id="S3.E3.m1.2.2.1.1.1.3.2" xref="S3.E3.m1.2.2.1.1.1.3.2.cmml">1</mn><mrow id="S3.E3.m1.2.2.1.1.1.3.3" xref="S3.E3.m1.2.2.1.1.1.3.3.cmml"><mn id="S3.E3.m1.2.2.1.1.1.3.3.2" xref="S3.E3.m1.2.2.1.1.1.3.3.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.1.1.1.3.3.1" xref="S3.E3.m1.2.2.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E3.m1.2.2.1.1.1.3.3.3" xref="S3.E3.m1.2.2.1.1.1.3.3.3.cmml">n</mi></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.1.1.1.2" xref="S3.E3.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.E3.m1.2.2.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.cmml"><munderover id="S3.E3.m1.2.2.1.1.1.1.2" xref="S3.E3.m1.2.2.1.1.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S3.E3.m1.2.2.1.1.1.1.2.2.2" xref="S3.E3.m1.2.2.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E3.m1.2.2.1.1.1.1.2.2.3" xref="S3.E3.m1.2.2.1.1.1.1.2.2.3.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.2.2.3.2" xref="S3.E3.m1.2.2.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E3.m1.2.2.1.1.1.1.2.2.3.1" xref="S3.E3.m1.2.2.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E3.m1.2.2.1.1.1.1.2.2.3.3" xref="S3.E3.m1.2.2.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S3.E3.m1.2.2.1.1.1.1.2.3" xref="S3.E3.m1.2.2.1.1.1.1.2.3.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.2.3.2" xref="S3.E3.m1.2.2.1.1.1.1.2.3.2.cmml">H</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E3.m1.2.2.1.1.1.1.2.3.1" xref="S3.E3.m1.2.2.1.1.1.1.2.3.1.cmml">⋅</mo><mi id="S3.E3.m1.2.2.1.1.1.1.2.3.3" xref="S3.E3.m1.2.2.1.1.1.1.2.3.3.cmml">W</mi></mrow></munderover><msup id="S3.E3.m1.2.2.1.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.cmml"><mrow id="S3.E3.m1.2.2.1.1.1.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E3.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.cmml"><msubsup id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.cmml">S</mi><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.2.3" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mo id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.2.2.3.cmml">′</mo></msubsup><mo id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.3.2" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml">M</mi><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.3.3" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S3.E3.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S3.E3.m1.2.2.1.1.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow></mrow><mo lspace="0em" id="S3.E3.m1.2.2.1.2" xref="S3.E3.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.2b"><apply id="S3.E3.m1.2.2.1.1.cmml" xref="S3.E3.m1.2.2.1"><eq id="S3.E3.m1.2.2.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.2"></eq><apply id="S3.E3.m1.2.2.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.3"><times id="S3.E3.m1.2.2.1.1.3.1.cmml" xref="S3.E3.m1.2.2.1.1.3.1"></times><apply id="S3.E3.m1.2.2.1.1.3.2.cmml" xref="S3.E3.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.3.2.1.cmml" xref="S3.E3.m1.2.2.1.1.3.2">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.3.2.2.cmml" xref="S3.E3.m1.2.2.1.1.3.2.2">ℒ</ci><apply id="S3.E3.m1.2.2.1.1.3.2.3.cmml" xref="S3.E3.m1.2.2.1.1.3.2.3"><times id="S3.E3.m1.2.2.1.1.3.2.3.1.cmml" xref="S3.E3.m1.2.2.1.1.3.2.3.1"></times><ci id="S3.E3.m1.2.2.1.1.3.2.3.2.cmml" xref="S3.E3.m1.2.2.1.1.3.2.3.2">𝑠</ci><ci id="S3.E3.m1.2.2.1.1.3.2.3.3.cmml" xref="S3.E3.m1.2.2.1.1.3.2.3.3">𝑖</ci><ci id="S3.E3.m1.2.2.1.1.3.2.3.4.cmml" xref="S3.E3.m1.2.2.1.1.3.2.3.4">𝑚</ci><ci id="S3.E3.m1.2.2.1.1.3.2.3.5.cmml" xref="S3.E3.m1.2.2.1.1.3.2.3.5">𝑝</ci><ci id="S3.E3.m1.2.2.1.1.3.2.3.6.cmml" xref="S3.E3.m1.2.2.1.1.3.2.3.6">𝑙</ci><ci id="S3.E3.m1.2.2.1.1.3.2.3.7.cmml" xref="S3.E3.m1.2.2.1.1.3.2.3.7">𝑒</ci></apply></apply><ci id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">𝐼</ci></apply><apply id="S3.E3.m1.2.2.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1"><times id="S3.E3.m1.2.2.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.2"></times><apply id="S3.E3.m1.2.2.1.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.1.3"><divide id="S3.E3.m1.2.2.1.1.1.3.1.cmml" xref="S3.E3.m1.2.2.1.1.1.3"></divide><cn type="integer" id="S3.E3.m1.2.2.1.1.1.3.2.cmml" xref="S3.E3.m1.2.2.1.1.1.3.2">1</cn><apply id="S3.E3.m1.2.2.1.1.1.3.3.cmml" xref="S3.E3.m1.2.2.1.1.1.3.3"><times id="S3.E3.m1.2.2.1.1.1.3.3.1.cmml" xref="S3.E3.m1.2.2.1.1.1.3.3.1"></times><cn type="integer" id="S3.E3.m1.2.2.1.1.1.3.3.2.cmml" xref="S3.E3.m1.2.2.1.1.1.3.3.2">2</cn><ci id="S3.E3.m1.2.2.1.1.1.3.3.3.cmml" xref="S3.E3.m1.2.2.1.1.1.3.3.3">𝑛</ci></apply></apply><apply id="S3.E3.m1.2.2.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1"><apply id="S3.E3.m1.2.2.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.2.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.2">superscript</csymbol><apply id="S3.E3.m1.2.2.1.1.1.1.2.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.2.2.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.2">subscript</csymbol><sum id="S3.E3.m1.2.2.1.1.1.1.2.2.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.2.2.2"></sum><apply id="S3.E3.m1.2.2.1.1.1.1.2.2.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.2.2.3"><eq id="S3.E3.m1.2.2.1.1.1.1.2.2.3.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.2.2.3.1"></eq><ci id="S3.E3.m1.2.2.1.1.1.1.2.2.3.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E3.m1.2.2.1.1.1.1.2.2.3.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S3.E3.m1.2.2.1.1.1.1.2.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.2.3"><ci id="S3.E3.m1.2.2.1.1.1.1.2.3.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.2.3.1">⋅</ci><ci id="S3.E3.m1.2.2.1.1.1.1.2.3.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.2.3.2">𝐻</ci><ci id="S3.E3.m1.2.2.1.1.1.1.2.3.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.2.3.3">𝑊</ci></apply></apply><apply id="S3.E3.m1.2.2.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1">superscript</csymbol><apply id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1"><minus id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.2.2.2">𝑆</ci><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.2.2.3">′</ci></apply><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.3.2">𝑀</ci><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply><cn type="integer" id="S3.E3.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.2c">\mathcal{L}_{simple}(I)=\frac{1}{2n}\sum_{i=1}^{H\cdot W}\left(S^{\prime}_{i}-M_{i}\right)^{2}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.15" class="ltx_p">We also want the regressed map to peak at the keypoint locations. Therefore, we use a third loss term to force local peakiness in the score map to achieve even faster convergence. Taking into consideration a collection of non-overlapping <math id="S3.SS2.p1.13.m1.1" class="ltx_Math" alttext="N\times N" display="inline"><semantics id="S3.SS2.p1.13.m1.1a"><mrow id="S3.SS2.p1.13.m1.1.1" xref="S3.SS2.p1.13.m1.1.1.cmml"><mi id="S3.SS2.p1.13.m1.1.1.2" xref="S3.SS2.p1.13.m1.1.1.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p1.13.m1.1.1.1" xref="S3.SS2.p1.13.m1.1.1.1.cmml">×</mo><mi id="S3.SS2.p1.13.m1.1.1.3" xref="S3.SS2.p1.13.m1.1.1.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.13.m1.1b"><apply id="S3.SS2.p1.13.m1.1.1.cmml" xref="S3.SS2.p1.13.m1.1.1"><times id="S3.SS2.p1.13.m1.1.1.1.cmml" xref="S3.SS2.p1.13.m1.1.1.1"></times><ci id="S3.SS2.p1.13.m1.1.1.2.cmml" xref="S3.SS2.p1.13.m1.1.1.2">𝑁</ci><ci id="S3.SS2.p1.13.m1.1.1.3.cmml" xref="S3.SS2.p1.13.m1.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.13.m1.1c">N\times N</annotation></semantics></math> patches <math id="S3.SS2.p1.14.m2.1" class="ltx_Math" alttext="\mathcal{P}=\{p\}" display="inline"><semantics id="S3.SS2.p1.14.m2.1a"><mrow id="S3.SS2.p1.14.m2.1.2" xref="S3.SS2.p1.14.m2.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.14.m2.1.2.2" xref="S3.SS2.p1.14.m2.1.2.2.cmml">𝒫</mi><mo id="S3.SS2.p1.14.m2.1.2.1" xref="S3.SS2.p1.14.m2.1.2.1.cmml">=</mo><mrow id="S3.SS2.p1.14.m2.1.2.3.2" xref="S3.SS2.p1.14.m2.1.2.3.1.cmml"><mo stretchy="false" id="S3.SS2.p1.14.m2.1.2.3.2.1" xref="S3.SS2.p1.14.m2.1.2.3.1.cmml">{</mo><mi id="S3.SS2.p1.14.m2.1.1" xref="S3.SS2.p1.14.m2.1.1.cmml">p</mi><mo stretchy="false" id="S3.SS2.p1.14.m2.1.2.3.2.2" xref="S3.SS2.p1.14.m2.1.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.14.m2.1b"><apply id="S3.SS2.p1.14.m2.1.2.cmml" xref="S3.SS2.p1.14.m2.1.2"><eq id="S3.SS2.p1.14.m2.1.2.1.cmml" xref="S3.SS2.p1.14.m2.1.2.1"></eq><ci id="S3.SS2.p1.14.m2.1.2.2.cmml" xref="S3.SS2.p1.14.m2.1.2.2">𝒫</ci><set id="S3.SS2.p1.14.m2.1.2.3.1.cmml" xref="S3.SS2.p1.14.m2.1.2.3.2"><ci id="S3.SS2.p1.14.m2.1.1.cmml" xref="S3.SS2.p1.14.m2.1.1">𝑝</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.14.m2.1c">\mathcal{P}=\{p\}</annotation></semantics></math> originated from a regular grid within the image <math id="S3.SS2.p1.15.m3.1" class="ltx_Math" alttext="I" display="inline"><semantics id="S3.SS2.p1.15.m3.1a"><mi id="S3.SS2.p1.15.m3.1.1" xref="S3.SS2.p1.15.m3.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.15.m3.1b"><ci id="S3.SS2.p1.15.m3.1.1.cmml" xref="S3.SS2.p1.15.m3.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.15.m3.1c">I</annotation></semantics></math>, where there is at least one non-zero pixel at the corresponding location of the patch on M, the peakiness loss term of the score map is defined as:</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S3.E4.m1.11" class="ltx_Math" alttext="\mathcal{L}_{peak}(I)=1-\frac{1}{|\mathcal{P}|}\sum_{p\in\mathcal{P}}\left(\max_{(i,j)\in p}S_{i,j}-\underset{(i,j)\in p}{\text{mean}}S_{i,j}\right)." display="block"><semantics id="S3.E4.m1.11a"><mrow id="S3.E4.m1.11.11.1" xref="S3.E4.m1.11.11.1.1.cmml"><mrow id="S3.E4.m1.11.11.1.1" xref="S3.E4.m1.11.11.1.1.cmml"><mrow id="S3.E4.m1.11.11.1.1.3" xref="S3.E4.m1.11.11.1.1.3.cmml"><msub id="S3.E4.m1.11.11.1.1.3.2" xref="S3.E4.m1.11.11.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.11.11.1.1.3.2.2" xref="S3.E4.m1.11.11.1.1.3.2.2.cmml">ℒ</mi><mrow id="S3.E4.m1.11.11.1.1.3.2.3" xref="S3.E4.m1.11.11.1.1.3.2.3.cmml"><mi id="S3.E4.m1.11.11.1.1.3.2.3.2" xref="S3.E4.m1.11.11.1.1.3.2.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.11.11.1.1.3.2.3.1" xref="S3.E4.m1.11.11.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E4.m1.11.11.1.1.3.2.3.3" xref="S3.E4.m1.11.11.1.1.3.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.11.11.1.1.3.2.3.1a" xref="S3.E4.m1.11.11.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E4.m1.11.11.1.1.3.2.3.4" xref="S3.E4.m1.11.11.1.1.3.2.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.11.11.1.1.3.2.3.1b" xref="S3.E4.m1.11.11.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E4.m1.11.11.1.1.3.2.3.5" xref="S3.E4.m1.11.11.1.1.3.2.3.5.cmml">k</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.11.11.1.1.3.1" xref="S3.E4.m1.11.11.1.1.3.1.cmml">​</mo><mrow id="S3.E4.m1.11.11.1.1.3.3.2" xref="S3.E4.m1.11.11.1.1.3.cmml"><mo stretchy="false" id="S3.E4.m1.11.11.1.1.3.3.2.1" xref="S3.E4.m1.11.11.1.1.3.cmml">(</mo><mi id="S3.E4.m1.10.10" xref="S3.E4.m1.10.10.cmml">I</mi><mo stretchy="false" id="S3.E4.m1.11.11.1.1.3.3.2.2" xref="S3.E4.m1.11.11.1.1.3.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.11.11.1.1.2" xref="S3.E4.m1.11.11.1.1.2.cmml">=</mo><mrow id="S3.E4.m1.11.11.1.1.1" xref="S3.E4.m1.11.11.1.1.1.cmml"><mn id="S3.E4.m1.11.11.1.1.1.3" xref="S3.E4.m1.11.11.1.1.1.3.cmml">1</mn><mo id="S3.E4.m1.11.11.1.1.1.2" xref="S3.E4.m1.11.11.1.1.1.2.cmml">−</mo><mrow id="S3.E4.m1.11.11.1.1.1.1" xref="S3.E4.m1.11.11.1.1.1.1.cmml"><mfrac id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml"><mn id="S3.E4.m1.1.1.3" xref="S3.E4.m1.1.1.3.cmml">1</mn><mrow id="S3.E4.m1.1.1.1.3" xref="S3.E4.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E4.m1.1.1.1.3.1" xref="S3.E4.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml">𝒫</mi><mo stretchy="false" id="S3.E4.m1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E4.m1.11.11.1.1.1.1.2" xref="S3.E4.m1.11.11.1.1.1.1.2.cmml">​</mo><mrow id="S3.E4.m1.11.11.1.1.1.1.1" xref="S3.E4.m1.11.11.1.1.1.1.1.cmml"><munder id="S3.E4.m1.11.11.1.1.1.1.1.2" xref="S3.E4.m1.11.11.1.1.1.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S3.E4.m1.11.11.1.1.1.1.1.2.2" xref="S3.E4.m1.11.11.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E4.m1.11.11.1.1.1.1.1.2.3" xref="S3.E4.m1.11.11.1.1.1.1.1.2.3.cmml"><mi id="S3.E4.m1.11.11.1.1.1.1.1.2.3.2" xref="S3.E4.m1.11.11.1.1.1.1.1.2.3.2.cmml">p</mi><mo id="S3.E4.m1.11.11.1.1.1.1.1.2.3.1" xref="S3.E4.m1.11.11.1.1.1.1.1.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.11.11.1.1.1.1.1.2.3.3" xref="S3.E4.m1.11.11.1.1.1.1.1.2.3.3.cmml">𝒫</mi></mrow></munder><mrow id="S3.E4.m1.11.11.1.1.1.1.1.1.1" xref="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E4.m1.11.11.1.1.1.1.1.1.1.2" xref="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.11.11.1.1.1.1.1.1.1.1" xref="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.2.cmml"><munder id="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.2.1" xref="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.2.1.cmml"><mi id="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.2.1.2" xref="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.2.1.2.cmml">max</mi><mrow id="S3.E4.m1.3.3.2" xref="S3.E4.m1.3.3.2.cmml"><mrow id="S3.E4.m1.3.3.2.4.2" xref="S3.E4.m1.3.3.2.4.1.cmml"><mo stretchy="false" id="S3.E4.m1.3.3.2.4.2.1" xref="S3.E4.m1.3.3.2.4.1.cmml">(</mo><mi id="S3.E4.m1.2.2.1.1" xref="S3.E4.m1.2.2.1.1.cmml">i</mi><mo id="S3.E4.m1.3.3.2.4.2.2" xref="S3.E4.m1.3.3.2.4.1.cmml">,</mo><mi id="S3.E4.m1.3.3.2.2" xref="S3.E4.m1.3.3.2.2.cmml">j</mi><mo stretchy="false" id="S3.E4.m1.3.3.2.4.2.3" xref="S3.E4.m1.3.3.2.4.1.cmml">)</mo></mrow><mo id="S3.E4.m1.3.3.2.3" xref="S3.E4.m1.3.3.2.3.cmml">∈</mo><mi id="S3.E4.m1.3.3.2.5" xref="S3.E4.m1.3.3.2.5.cmml">p</mi></mrow></munder><mo lspace="0.167em" id="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.2a" xref="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.2.cmml">⁡</mo><msub id="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.2.2" xref="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.2.2.2.cmml">S</mi><mrow id="S3.E4.m1.5.5.2.4" xref="S3.E4.m1.5.5.2.3.cmml"><mi id="S3.E4.m1.4.4.1.1" xref="S3.E4.m1.4.4.1.1.cmml">i</mi><mo id="S3.E4.m1.5.5.2.4.1" xref="S3.E4.m1.5.5.2.3.cmml">,</mo><mi id="S3.E4.m1.5.5.2.2" xref="S3.E4.m1.5.5.2.2.cmml">j</mi></mrow></msub></mrow><mo id="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.3.cmml"><munder accentunder="true" id="S3.E4.m1.7.7" xref="S3.E4.m1.7.7.cmml"><mtext id="S3.E4.m1.7.7.3" xref="S3.E4.m1.7.7.3a.cmml">mean</mtext><mrow id="S3.E4.m1.7.7.2" xref="S3.E4.m1.7.7.2.cmml"><mrow id="S3.E4.m1.7.7.2.4.2" xref="S3.E4.m1.7.7.2.4.1.cmml"><mo stretchy="false" id="S3.E4.m1.7.7.2.4.2.1" xref="S3.E4.m1.7.7.2.4.1.cmml">(</mo><mi id="S3.E4.m1.6.6.1.1" xref="S3.E4.m1.6.6.1.1.cmml">i</mi><mo id="S3.E4.m1.7.7.2.4.2.2" xref="S3.E4.m1.7.7.2.4.1.cmml">,</mo><mi id="S3.E4.m1.7.7.2.2" xref="S3.E4.m1.7.7.2.2.cmml">j</mi><mo stretchy="false" id="S3.E4.m1.7.7.2.4.2.3" xref="S3.E4.m1.7.7.2.4.1.cmml">)</mo></mrow><mo id="S3.E4.m1.7.7.2.3" xref="S3.E4.m1.7.7.2.3.cmml">∈</mo><mi id="S3.E4.m1.7.7.2.5" xref="S3.E4.m1.7.7.2.5.cmml">p</mi></mrow></munder><mo lspace="0em" rspace="0em" id="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.3.1" xref="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><msub id="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.3.2" xref="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.3.2.2.cmml">S</mi><mrow id="S3.E4.m1.9.9.2.4" xref="S3.E4.m1.9.9.2.3.cmml"><mi id="S3.E4.m1.8.8.1.1" xref="S3.E4.m1.8.8.1.1.cmml">i</mi><mo id="S3.E4.m1.9.9.2.4.1" xref="S3.E4.m1.9.9.2.3.cmml">,</mo><mi id="S3.E4.m1.9.9.2.2" xref="S3.E4.m1.9.9.2.2.cmml">j</mi></mrow></msub></mrow></mrow><mo id="S3.E4.m1.11.11.1.1.1.1.1.1.1.3" xref="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E4.m1.11.11.1.2" xref="S3.E4.m1.11.11.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.11b"><apply id="S3.E4.m1.11.11.1.1.cmml" xref="S3.E4.m1.11.11.1"><eq id="S3.E4.m1.11.11.1.1.2.cmml" xref="S3.E4.m1.11.11.1.1.2"></eq><apply id="S3.E4.m1.11.11.1.1.3.cmml" xref="S3.E4.m1.11.11.1.1.3"><times id="S3.E4.m1.11.11.1.1.3.1.cmml" xref="S3.E4.m1.11.11.1.1.3.1"></times><apply id="S3.E4.m1.11.11.1.1.3.2.cmml" xref="S3.E4.m1.11.11.1.1.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.11.11.1.1.3.2.1.cmml" xref="S3.E4.m1.11.11.1.1.3.2">subscript</csymbol><ci id="S3.E4.m1.11.11.1.1.3.2.2.cmml" xref="S3.E4.m1.11.11.1.1.3.2.2">ℒ</ci><apply id="S3.E4.m1.11.11.1.1.3.2.3.cmml" xref="S3.E4.m1.11.11.1.1.3.2.3"><times id="S3.E4.m1.11.11.1.1.3.2.3.1.cmml" xref="S3.E4.m1.11.11.1.1.3.2.3.1"></times><ci id="S3.E4.m1.11.11.1.1.3.2.3.2.cmml" xref="S3.E4.m1.11.11.1.1.3.2.3.2">𝑝</ci><ci id="S3.E4.m1.11.11.1.1.3.2.3.3.cmml" xref="S3.E4.m1.11.11.1.1.3.2.3.3">𝑒</ci><ci id="S3.E4.m1.11.11.1.1.3.2.3.4.cmml" xref="S3.E4.m1.11.11.1.1.3.2.3.4">𝑎</ci><ci id="S3.E4.m1.11.11.1.1.3.2.3.5.cmml" xref="S3.E4.m1.11.11.1.1.3.2.3.5">𝑘</ci></apply></apply><ci id="S3.E4.m1.10.10.cmml" xref="S3.E4.m1.10.10">𝐼</ci></apply><apply id="S3.E4.m1.11.11.1.1.1.cmml" xref="S3.E4.m1.11.11.1.1.1"><minus id="S3.E4.m1.11.11.1.1.1.2.cmml" xref="S3.E4.m1.11.11.1.1.1.2"></minus><cn type="integer" id="S3.E4.m1.11.11.1.1.1.3.cmml" xref="S3.E4.m1.11.11.1.1.1.3">1</cn><apply id="S3.E4.m1.11.11.1.1.1.1.cmml" xref="S3.E4.m1.11.11.1.1.1.1"><times id="S3.E4.m1.11.11.1.1.1.1.2.cmml" xref="S3.E4.m1.11.11.1.1.1.1.2"></times><apply id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1"><divide id="S3.E4.m1.1.1.2.cmml" xref="S3.E4.m1.1.1"></divide><cn type="integer" id="S3.E4.m1.1.1.3.cmml" xref="S3.E4.m1.1.1.3">1</cn><apply id="S3.E4.m1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.3"><abs id="S3.E4.m1.1.1.1.2.1.cmml" xref="S3.E4.m1.1.1.1.3.1"></abs><ci id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1">𝒫</ci></apply></apply><apply id="S3.E4.m1.11.11.1.1.1.1.1.cmml" xref="S3.E4.m1.11.11.1.1.1.1.1"><apply id="S3.E4.m1.11.11.1.1.1.1.1.2.cmml" xref="S3.E4.m1.11.11.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.11.11.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.11.11.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E4.m1.11.11.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.11.11.1.1.1.1.1.2.2"></sum><apply id="S3.E4.m1.11.11.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.11.11.1.1.1.1.1.2.3"><in id="S3.E4.m1.11.11.1.1.1.1.1.2.3.1.cmml" xref="S3.E4.m1.11.11.1.1.1.1.1.2.3.1"></in><ci id="S3.E4.m1.11.11.1.1.1.1.1.2.3.2.cmml" xref="S3.E4.m1.11.11.1.1.1.1.1.2.3.2">𝑝</ci><ci id="S3.E4.m1.11.11.1.1.1.1.1.2.3.3.cmml" xref="S3.E4.m1.11.11.1.1.1.1.1.2.3.3">𝒫</ci></apply></apply><apply id="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.11.11.1.1.1.1.1.1.1"><minus id="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.2"><apply id="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.2.1.1.cmml" xref="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.2.1">subscript</csymbol><max id="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.2.1.2.cmml" xref="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.2.1.2"></max><apply id="S3.E4.m1.3.3.2.cmml" xref="S3.E4.m1.3.3.2"><in id="S3.E4.m1.3.3.2.3.cmml" xref="S3.E4.m1.3.3.2.3"></in><interval closure="open" id="S3.E4.m1.3.3.2.4.1.cmml" xref="S3.E4.m1.3.3.2.4.2"><ci id="S3.E4.m1.2.2.1.1.cmml" xref="S3.E4.m1.2.2.1.1">𝑖</ci><ci id="S3.E4.m1.3.3.2.2.cmml" xref="S3.E4.m1.3.3.2.2">𝑗</ci></interval><ci id="S3.E4.m1.3.3.2.5.cmml" xref="S3.E4.m1.3.3.2.5">𝑝</ci></apply></apply><apply id="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.2.2.2">𝑆</ci><list id="S3.E4.m1.5.5.2.3.cmml" xref="S3.E4.m1.5.5.2.4"><ci id="S3.E4.m1.4.4.1.1.cmml" xref="S3.E4.m1.4.4.1.1">𝑖</ci><ci id="S3.E4.m1.5.5.2.2.cmml" xref="S3.E4.m1.5.5.2.2">𝑗</ci></list></apply></apply><apply id="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.3"><times id="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.3.1"></times><apply id="S3.E4.m1.7.7.cmml" xref="S3.E4.m1.7.7"><apply id="S3.E4.m1.7.7.2.cmml" xref="S3.E4.m1.7.7.2"><in id="S3.E4.m1.7.7.2.3.cmml" xref="S3.E4.m1.7.7.2.3"></in><interval closure="open" id="S3.E4.m1.7.7.2.4.1.cmml" xref="S3.E4.m1.7.7.2.4.2"><ci id="S3.E4.m1.6.6.1.1.cmml" xref="S3.E4.m1.6.6.1.1">𝑖</ci><ci id="S3.E4.m1.7.7.2.2.cmml" xref="S3.E4.m1.7.7.2.2">𝑗</ci></interval><ci id="S3.E4.m1.7.7.2.5.cmml" xref="S3.E4.m1.7.7.2.5">𝑝</ci></apply><ci id="S3.E4.m1.7.7.3a.cmml" xref="S3.E4.m1.7.7.3"><mtext id="S3.E4.m1.7.7.3.cmml" xref="S3.E4.m1.7.7.3">mean</mtext></ci></apply><apply id="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E4.m1.11.11.1.1.1.1.1.1.1.1.3.2.2">𝑆</ci><list id="S3.E4.m1.9.9.2.3.cmml" xref="S3.E4.m1.9.9.2.4"><ci id="S3.E4.m1.8.8.1.1.cmml" xref="S3.E4.m1.8.8.1.1">𝑖</ci><ci id="S3.E4.m1.9.9.2.2.cmml" xref="S3.E4.m1.9.9.2.2">𝑗</ci></list></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.11c">\mathcal{L}_{peak}(I)=1-\frac{1}{|\mathcal{P}|}\sum_{p\in\mathcal{P}}\left(\max_{(i,j)\in p}S_{i,j}-\underset{(i,j)\in p}{\text{mean}}S_{i,j}\right).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.18" class="ltx_p">While modeling the loss, we observed that if <math id="S3.SS2.p1.16.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS2.p1.16.m1.1a"><mi id="S3.SS2.p1.16.m1.1.1" xref="S3.SS2.p1.16.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.16.m1.1b"><ci id="S3.SS2.p1.16.m1.1.1.cmml" xref="S3.SS2.p1.16.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.16.m1.1c">N</annotation></semantics></math> is too large, the network will produce fewer keypoints and a smoother heatmap. This behavior is not desirable for pixel-level accurate matching. However, if <math id="S3.SS2.p1.17.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS2.p1.17.m2.1a"><mi id="S3.SS2.p1.17.m2.1.1" xref="S3.SS2.p1.17.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.17.m2.1b"><ci id="S3.SS2.p1.17.m2.1.1.cmml" xref="S3.SS2.p1.17.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.17.m2.1c">N</annotation></semantics></math> is too small, it will produce a high number of low-quality keypoints. The weighted sum of <span id="S3.SS2.p1.18.1" class="ltx_text ltx_font_italic">cossim</span>, L2, and peak losses yields the final detector training loss <math id="S3.SS2.p1.18.m3.1" class="ltx_Math" alttext="\mathcal{L}" display="inline"><semantics id="S3.SS2.p1.18.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.18.m3.1.1" xref="S3.SS2.p1.18.m3.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.18.m3.1b"><ci id="S3.SS2.p1.18.m3.1.1.cmml" xref="S3.SS2.p1.18.m3.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.18.m3.1c">\mathcal{L}</annotation></semantics></math>:</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S3.E5.m1.5" class="ltx_Math" alttext="\mathcal{L}(I)=\lambda_{1}\mathcal{L}_{cossim}(I)+\lambda_{2}\mathcal{L}_{simple}(I)+\lambda_{3}\mathcal{L}_{peak}(I)." display="block"><semantics id="S3.E5.m1.5a"><mrow id="S3.E5.m1.5.5.1" xref="S3.E5.m1.5.5.1.1.cmml"><mrow id="S3.E5.m1.5.5.1.1" xref="S3.E5.m1.5.5.1.1.cmml"><mrow id="S3.E5.m1.5.5.1.1.2" xref="S3.E5.m1.5.5.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.5.5.1.1.2.2" xref="S3.E5.m1.5.5.1.1.2.2.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.5.5.1.1.2.1" xref="S3.E5.m1.5.5.1.1.2.1.cmml">​</mo><mrow id="S3.E5.m1.5.5.1.1.2.3.2" xref="S3.E5.m1.5.5.1.1.2.cmml"><mo stretchy="false" id="S3.E5.m1.5.5.1.1.2.3.2.1" xref="S3.E5.m1.5.5.1.1.2.cmml">(</mo><mi id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml">I</mi><mo stretchy="false" id="S3.E5.m1.5.5.1.1.2.3.2.2" xref="S3.E5.m1.5.5.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.5.5.1.1.1" xref="S3.E5.m1.5.5.1.1.1.cmml">=</mo><mrow id="S3.E5.m1.5.5.1.1.3" xref="S3.E5.m1.5.5.1.1.3.cmml"><mrow id="S3.E5.m1.5.5.1.1.3.2" xref="S3.E5.m1.5.5.1.1.3.2.cmml"><msub id="S3.E5.m1.5.5.1.1.3.2.2" xref="S3.E5.m1.5.5.1.1.3.2.2.cmml"><mi id="S3.E5.m1.5.5.1.1.3.2.2.2" xref="S3.E5.m1.5.5.1.1.3.2.2.2.cmml">λ</mi><mn id="S3.E5.m1.5.5.1.1.3.2.2.3" xref="S3.E5.m1.5.5.1.1.3.2.2.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.5.5.1.1.3.2.1" xref="S3.E5.m1.5.5.1.1.3.2.1.cmml">​</mo><msub id="S3.E5.m1.5.5.1.1.3.2.3" xref="S3.E5.m1.5.5.1.1.3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.5.5.1.1.3.2.3.2" xref="S3.E5.m1.5.5.1.1.3.2.3.2.cmml">ℒ</mi><mrow id="S3.E5.m1.5.5.1.1.3.2.3.3" xref="S3.E5.m1.5.5.1.1.3.2.3.3.cmml"><mi id="S3.E5.m1.5.5.1.1.3.2.3.3.2" xref="S3.E5.m1.5.5.1.1.3.2.3.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.5.5.1.1.3.2.3.3.1" xref="S3.E5.m1.5.5.1.1.3.2.3.3.1.cmml">​</mo><mi id="S3.E5.m1.5.5.1.1.3.2.3.3.3" xref="S3.E5.m1.5.5.1.1.3.2.3.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.5.5.1.1.3.2.3.3.1a" xref="S3.E5.m1.5.5.1.1.3.2.3.3.1.cmml">​</mo><mi id="S3.E5.m1.5.5.1.1.3.2.3.3.4" xref="S3.E5.m1.5.5.1.1.3.2.3.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.5.5.1.1.3.2.3.3.1b" xref="S3.E5.m1.5.5.1.1.3.2.3.3.1.cmml">​</mo><mi id="S3.E5.m1.5.5.1.1.3.2.3.3.5" xref="S3.E5.m1.5.5.1.1.3.2.3.3.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.5.5.1.1.3.2.3.3.1c" xref="S3.E5.m1.5.5.1.1.3.2.3.3.1.cmml">​</mo><mi id="S3.E5.m1.5.5.1.1.3.2.3.3.6" xref="S3.E5.m1.5.5.1.1.3.2.3.3.6.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.5.5.1.1.3.2.3.3.1d" xref="S3.E5.m1.5.5.1.1.3.2.3.3.1.cmml">​</mo><mi id="S3.E5.m1.5.5.1.1.3.2.3.3.7" xref="S3.E5.m1.5.5.1.1.3.2.3.3.7.cmml">m</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.5.5.1.1.3.2.1a" xref="S3.E5.m1.5.5.1.1.3.2.1.cmml">​</mo><mrow id="S3.E5.m1.5.5.1.1.3.2.4.2" xref="S3.E5.m1.5.5.1.1.3.2.cmml"><mo stretchy="false" id="S3.E5.m1.5.5.1.1.3.2.4.2.1" xref="S3.E5.m1.5.5.1.1.3.2.cmml">(</mo><mi id="S3.E5.m1.2.2" xref="S3.E5.m1.2.2.cmml">I</mi><mo stretchy="false" id="S3.E5.m1.5.5.1.1.3.2.4.2.2" xref="S3.E5.m1.5.5.1.1.3.2.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.5.5.1.1.3.1" xref="S3.E5.m1.5.5.1.1.3.1.cmml">+</mo><mrow id="S3.E5.m1.5.5.1.1.3.3" xref="S3.E5.m1.5.5.1.1.3.3.cmml"><msub id="S3.E5.m1.5.5.1.1.3.3.2" xref="S3.E5.m1.5.5.1.1.3.3.2.cmml"><mi id="S3.E5.m1.5.5.1.1.3.3.2.2" xref="S3.E5.m1.5.5.1.1.3.3.2.2.cmml">λ</mi><mn id="S3.E5.m1.5.5.1.1.3.3.2.3" xref="S3.E5.m1.5.5.1.1.3.3.2.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.5.5.1.1.3.3.1" xref="S3.E5.m1.5.5.1.1.3.3.1.cmml">​</mo><msub id="S3.E5.m1.5.5.1.1.3.3.3" xref="S3.E5.m1.5.5.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.5.5.1.1.3.3.3.2" xref="S3.E5.m1.5.5.1.1.3.3.3.2.cmml">ℒ</mi><mrow id="S3.E5.m1.5.5.1.1.3.3.3.3" xref="S3.E5.m1.5.5.1.1.3.3.3.3.cmml"><mi id="S3.E5.m1.5.5.1.1.3.3.3.3.2" xref="S3.E5.m1.5.5.1.1.3.3.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.5.5.1.1.3.3.3.3.1" xref="S3.E5.m1.5.5.1.1.3.3.3.3.1.cmml">​</mo><mi id="S3.E5.m1.5.5.1.1.3.3.3.3.3" xref="S3.E5.m1.5.5.1.1.3.3.3.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.5.5.1.1.3.3.3.3.1a" xref="S3.E5.m1.5.5.1.1.3.3.3.3.1.cmml">​</mo><mi id="S3.E5.m1.5.5.1.1.3.3.3.3.4" xref="S3.E5.m1.5.5.1.1.3.3.3.3.4.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.5.5.1.1.3.3.3.3.1b" xref="S3.E5.m1.5.5.1.1.3.3.3.3.1.cmml">​</mo><mi id="S3.E5.m1.5.5.1.1.3.3.3.3.5" xref="S3.E5.m1.5.5.1.1.3.3.3.3.5.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.5.5.1.1.3.3.3.3.1c" xref="S3.E5.m1.5.5.1.1.3.3.3.3.1.cmml">​</mo><mi id="S3.E5.m1.5.5.1.1.3.3.3.3.6" xref="S3.E5.m1.5.5.1.1.3.3.3.3.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.5.5.1.1.3.3.3.3.1d" xref="S3.E5.m1.5.5.1.1.3.3.3.3.1.cmml">​</mo><mi id="S3.E5.m1.5.5.1.1.3.3.3.3.7" xref="S3.E5.m1.5.5.1.1.3.3.3.3.7.cmml">e</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.5.5.1.1.3.3.1a" xref="S3.E5.m1.5.5.1.1.3.3.1.cmml">​</mo><mrow id="S3.E5.m1.5.5.1.1.3.3.4.2" xref="S3.E5.m1.5.5.1.1.3.3.cmml"><mo stretchy="false" id="S3.E5.m1.5.5.1.1.3.3.4.2.1" xref="S3.E5.m1.5.5.1.1.3.3.cmml">(</mo><mi id="S3.E5.m1.3.3" xref="S3.E5.m1.3.3.cmml">I</mi><mo stretchy="false" id="S3.E5.m1.5.5.1.1.3.3.4.2.2" xref="S3.E5.m1.5.5.1.1.3.3.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.5.5.1.1.3.1a" xref="S3.E5.m1.5.5.1.1.3.1.cmml">+</mo><mrow id="S3.E5.m1.5.5.1.1.3.4" xref="S3.E5.m1.5.5.1.1.3.4.cmml"><msub id="S3.E5.m1.5.5.1.1.3.4.2" xref="S3.E5.m1.5.5.1.1.3.4.2.cmml"><mi id="S3.E5.m1.5.5.1.1.3.4.2.2" xref="S3.E5.m1.5.5.1.1.3.4.2.2.cmml">λ</mi><mn id="S3.E5.m1.5.5.1.1.3.4.2.3" xref="S3.E5.m1.5.5.1.1.3.4.2.3.cmml">3</mn></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.5.5.1.1.3.4.1" xref="S3.E5.m1.5.5.1.1.3.4.1.cmml">​</mo><msub id="S3.E5.m1.5.5.1.1.3.4.3" xref="S3.E5.m1.5.5.1.1.3.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.5.5.1.1.3.4.3.2" xref="S3.E5.m1.5.5.1.1.3.4.3.2.cmml">ℒ</mi><mrow id="S3.E5.m1.5.5.1.1.3.4.3.3" xref="S3.E5.m1.5.5.1.1.3.4.3.3.cmml"><mi id="S3.E5.m1.5.5.1.1.3.4.3.3.2" xref="S3.E5.m1.5.5.1.1.3.4.3.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.5.5.1.1.3.4.3.3.1" xref="S3.E5.m1.5.5.1.1.3.4.3.3.1.cmml">​</mo><mi id="S3.E5.m1.5.5.1.1.3.4.3.3.3" xref="S3.E5.m1.5.5.1.1.3.4.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.5.5.1.1.3.4.3.3.1a" xref="S3.E5.m1.5.5.1.1.3.4.3.3.1.cmml">​</mo><mi id="S3.E5.m1.5.5.1.1.3.4.3.3.4" xref="S3.E5.m1.5.5.1.1.3.4.3.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.5.5.1.1.3.4.3.3.1b" xref="S3.E5.m1.5.5.1.1.3.4.3.3.1.cmml">​</mo><mi id="S3.E5.m1.5.5.1.1.3.4.3.3.5" xref="S3.E5.m1.5.5.1.1.3.4.3.3.5.cmml">k</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.5.5.1.1.3.4.1a" xref="S3.E5.m1.5.5.1.1.3.4.1.cmml">​</mo><mrow id="S3.E5.m1.5.5.1.1.3.4.4.2" xref="S3.E5.m1.5.5.1.1.3.4.cmml"><mo stretchy="false" id="S3.E5.m1.5.5.1.1.3.4.4.2.1" xref="S3.E5.m1.5.5.1.1.3.4.cmml">(</mo><mi id="S3.E5.m1.4.4" xref="S3.E5.m1.4.4.cmml">I</mi><mo stretchy="false" id="S3.E5.m1.5.5.1.1.3.4.4.2.2" xref="S3.E5.m1.5.5.1.1.3.4.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E5.m1.5.5.1.2" xref="S3.E5.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.5b"><apply id="S3.E5.m1.5.5.1.1.cmml" xref="S3.E5.m1.5.5.1"><eq id="S3.E5.m1.5.5.1.1.1.cmml" xref="S3.E5.m1.5.5.1.1.1"></eq><apply id="S3.E5.m1.5.5.1.1.2.cmml" xref="S3.E5.m1.5.5.1.1.2"><times id="S3.E5.m1.5.5.1.1.2.1.cmml" xref="S3.E5.m1.5.5.1.1.2.1"></times><ci id="S3.E5.m1.5.5.1.1.2.2.cmml" xref="S3.E5.m1.5.5.1.1.2.2">ℒ</ci><ci id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1">𝐼</ci></apply><apply id="S3.E5.m1.5.5.1.1.3.cmml" xref="S3.E5.m1.5.5.1.1.3"><plus id="S3.E5.m1.5.5.1.1.3.1.cmml" xref="S3.E5.m1.5.5.1.1.3.1"></plus><apply id="S3.E5.m1.5.5.1.1.3.2.cmml" xref="S3.E5.m1.5.5.1.1.3.2"><times id="S3.E5.m1.5.5.1.1.3.2.1.cmml" xref="S3.E5.m1.5.5.1.1.3.2.1"></times><apply id="S3.E5.m1.5.5.1.1.3.2.2.cmml" xref="S3.E5.m1.5.5.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.1.3.2.2.1.cmml" xref="S3.E5.m1.5.5.1.1.3.2.2">subscript</csymbol><ci id="S3.E5.m1.5.5.1.1.3.2.2.2.cmml" xref="S3.E5.m1.5.5.1.1.3.2.2.2">𝜆</ci><cn type="integer" id="S3.E5.m1.5.5.1.1.3.2.2.3.cmml" xref="S3.E5.m1.5.5.1.1.3.2.2.3">1</cn></apply><apply id="S3.E5.m1.5.5.1.1.3.2.3.cmml" xref="S3.E5.m1.5.5.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.1.3.2.3.1.cmml" xref="S3.E5.m1.5.5.1.1.3.2.3">subscript</csymbol><ci id="S3.E5.m1.5.5.1.1.3.2.3.2.cmml" xref="S3.E5.m1.5.5.1.1.3.2.3.2">ℒ</ci><apply id="S3.E5.m1.5.5.1.1.3.2.3.3.cmml" xref="S3.E5.m1.5.5.1.1.3.2.3.3"><times id="S3.E5.m1.5.5.1.1.3.2.3.3.1.cmml" xref="S3.E5.m1.5.5.1.1.3.2.3.3.1"></times><ci id="S3.E5.m1.5.5.1.1.3.2.3.3.2.cmml" xref="S3.E5.m1.5.5.1.1.3.2.3.3.2">𝑐</ci><ci id="S3.E5.m1.5.5.1.1.3.2.3.3.3.cmml" xref="S3.E5.m1.5.5.1.1.3.2.3.3.3">𝑜</ci><ci id="S3.E5.m1.5.5.1.1.3.2.3.3.4.cmml" xref="S3.E5.m1.5.5.1.1.3.2.3.3.4">𝑠</ci><ci id="S3.E5.m1.5.5.1.1.3.2.3.3.5.cmml" xref="S3.E5.m1.5.5.1.1.3.2.3.3.5">𝑠</ci><ci id="S3.E5.m1.5.5.1.1.3.2.3.3.6.cmml" xref="S3.E5.m1.5.5.1.1.3.2.3.3.6">𝑖</ci><ci id="S3.E5.m1.5.5.1.1.3.2.3.3.7.cmml" xref="S3.E5.m1.5.5.1.1.3.2.3.3.7">𝑚</ci></apply></apply><ci id="S3.E5.m1.2.2.cmml" xref="S3.E5.m1.2.2">𝐼</ci></apply><apply id="S3.E5.m1.5.5.1.1.3.3.cmml" xref="S3.E5.m1.5.5.1.1.3.3"><times id="S3.E5.m1.5.5.1.1.3.3.1.cmml" xref="S3.E5.m1.5.5.1.1.3.3.1"></times><apply id="S3.E5.m1.5.5.1.1.3.3.2.cmml" xref="S3.E5.m1.5.5.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.1.3.3.2.1.cmml" xref="S3.E5.m1.5.5.1.1.3.3.2">subscript</csymbol><ci id="S3.E5.m1.5.5.1.1.3.3.2.2.cmml" xref="S3.E5.m1.5.5.1.1.3.3.2.2">𝜆</ci><cn type="integer" id="S3.E5.m1.5.5.1.1.3.3.2.3.cmml" xref="S3.E5.m1.5.5.1.1.3.3.2.3">2</cn></apply><apply id="S3.E5.m1.5.5.1.1.3.3.3.cmml" xref="S3.E5.m1.5.5.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.1.3.3.3.1.cmml" xref="S3.E5.m1.5.5.1.1.3.3.3">subscript</csymbol><ci id="S3.E5.m1.5.5.1.1.3.3.3.2.cmml" xref="S3.E5.m1.5.5.1.1.3.3.3.2">ℒ</ci><apply id="S3.E5.m1.5.5.1.1.3.3.3.3.cmml" xref="S3.E5.m1.5.5.1.1.3.3.3.3"><times id="S3.E5.m1.5.5.1.1.3.3.3.3.1.cmml" xref="S3.E5.m1.5.5.1.1.3.3.3.3.1"></times><ci id="S3.E5.m1.5.5.1.1.3.3.3.3.2.cmml" xref="S3.E5.m1.5.5.1.1.3.3.3.3.2">𝑠</ci><ci id="S3.E5.m1.5.5.1.1.3.3.3.3.3.cmml" xref="S3.E5.m1.5.5.1.1.3.3.3.3.3">𝑖</ci><ci id="S3.E5.m1.5.5.1.1.3.3.3.3.4.cmml" xref="S3.E5.m1.5.5.1.1.3.3.3.3.4">𝑚</ci><ci id="S3.E5.m1.5.5.1.1.3.3.3.3.5.cmml" xref="S3.E5.m1.5.5.1.1.3.3.3.3.5">𝑝</ci><ci id="S3.E5.m1.5.5.1.1.3.3.3.3.6.cmml" xref="S3.E5.m1.5.5.1.1.3.3.3.3.6">𝑙</ci><ci id="S3.E5.m1.5.5.1.1.3.3.3.3.7.cmml" xref="S3.E5.m1.5.5.1.1.3.3.3.3.7">𝑒</ci></apply></apply><ci id="S3.E5.m1.3.3.cmml" xref="S3.E5.m1.3.3">𝐼</ci></apply><apply id="S3.E5.m1.5.5.1.1.3.4.cmml" xref="S3.E5.m1.5.5.1.1.3.4"><times id="S3.E5.m1.5.5.1.1.3.4.1.cmml" xref="S3.E5.m1.5.5.1.1.3.4.1"></times><apply id="S3.E5.m1.5.5.1.1.3.4.2.cmml" xref="S3.E5.m1.5.5.1.1.3.4.2"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.1.3.4.2.1.cmml" xref="S3.E5.m1.5.5.1.1.3.4.2">subscript</csymbol><ci id="S3.E5.m1.5.5.1.1.3.4.2.2.cmml" xref="S3.E5.m1.5.5.1.1.3.4.2.2">𝜆</ci><cn type="integer" id="S3.E5.m1.5.5.1.1.3.4.2.3.cmml" xref="S3.E5.m1.5.5.1.1.3.4.2.3">3</cn></apply><apply id="S3.E5.m1.5.5.1.1.3.4.3.cmml" xref="S3.E5.m1.5.5.1.1.3.4.3"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.1.3.4.3.1.cmml" xref="S3.E5.m1.5.5.1.1.3.4.3">subscript</csymbol><ci id="S3.E5.m1.5.5.1.1.3.4.3.2.cmml" xref="S3.E5.m1.5.5.1.1.3.4.3.2">ℒ</ci><apply id="S3.E5.m1.5.5.1.1.3.4.3.3.cmml" xref="S3.E5.m1.5.5.1.1.3.4.3.3"><times id="S3.E5.m1.5.5.1.1.3.4.3.3.1.cmml" xref="S3.E5.m1.5.5.1.1.3.4.3.3.1"></times><ci id="S3.E5.m1.5.5.1.1.3.4.3.3.2.cmml" xref="S3.E5.m1.5.5.1.1.3.4.3.3.2">𝑝</ci><ci id="S3.E5.m1.5.5.1.1.3.4.3.3.3.cmml" xref="S3.E5.m1.5.5.1.1.3.4.3.3.3">𝑒</ci><ci id="S3.E5.m1.5.5.1.1.3.4.3.3.4.cmml" xref="S3.E5.m1.5.5.1.1.3.4.3.3.4">𝑎</ci><ci id="S3.E5.m1.5.5.1.1.3.4.3.3.5.cmml" xref="S3.E5.m1.5.5.1.1.3.4.3.3.5">𝑘</ci></apply></apply><ci id="S3.E5.m1.4.4.cmml" xref="S3.E5.m1.4.4">𝐼</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.5c">\mathcal{L}(I)=\lambda_{1}\mathcal{L}_{cossim}(I)+\lambda_{2}\mathcal{L}_{simple}(I)+\lambda_{3}\mathcal{L}_{peak}(I).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Implementation details</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.5" class="ltx_p">The learned detector comprises a <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="4" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><mn id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><cn type="integer" id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">4</annotation></semantics></math>-level deep U-net <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite> with a final sigmoid activation function in the output layer. We included <math id="S3.SS3.p1.2.m2.1" class="ltx_Math" alttext="3\times 3" display="inline"><semantics id="S3.SS3.p1.2.m2.1a"><mrow id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml"><mn id="S3.SS3.p1.2.m2.1.1.2" xref="S3.SS3.p1.2.m2.1.1.2.cmml">3</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p1.2.m2.1.1.1" xref="S3.SS3.p1.2.m2.1.1.1.cmml">×</mo><mn id="S3.SS3.p1.2.m2.1.1.3" xref="S3.SS3.p1.2.m2.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><apply id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1"><times id="S3.SS3.p1.2.m2.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1.1"></times><cn type="integer" id="S3.SS3.p1.2.m2.1.1.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2">3</cn><cn type="integer" id="S3.SS3.p1.2.m2.1.1.3.cmml" xref="S3.SS3.p1.2.m2.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">3\times 3</annotation></semantics></math> convolution blocks with batch normalization and ReLU activations in each layer. Grid-search was used to determine the weights <math id="S3.SS3.p1.3.m3.1" class="ltx_Math" alttext="\lambda_{1}=3.0" display="inline"><semantics id="S3.SS3.p1.3.m3.1a"><mrow id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml"><msub id="S3.SS3.p1.3.m3.1.1.2" xref="S3.SS3.p1.3.m3.1.1.2.cmml"><mi id="S3.SS3.p1.3.m3.1.1.2.2" xref="S3.SS3.p1.3.m3.1.1.2.2.cmml">λ</mi><mn id="S3.SS3.p1.3.m3.1.1.2.3" xref="S3.SS3.p1.3.m3.1.1.2.3.cmml">1</mn></msub><mo id="S3.SS3.p1.3.m3.1.1.1" xref="S3.SS3.p1.3.m3.1.1.1.cmml">=</mo><mn id="S3.SS3.p1.3.m3.1.1.3" xref="S3.SS3.p1.3.m3.1.1.3.cmml">3.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><apply id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1"><eq id="S3.SS3.p1.3.m3.1.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1.1"></eq><apply id="S3.SS3.p1.3.m3.1.1.2.cmml" xref="S3.SS3.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.1.1.2.1.cmml" xref="S3.SS3.p1.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS3.p1.3.m3.1.1.2.2.cmml" xref="S3.SS3.p1.3.m3.1.1.2.2">𝜆</ci><cn type="integer" id="S3.SS3.p1.3.m3.1.1.2.3.cmml" xref="S3.SS3.p1.3.m3.1.1.2.3">1</cn></apply><cn type="float" id="S3.SS3.p1.3.m3.1.1.3.cmml" xref="S3.SS3.p1.3.m3.1.1.3">3.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">\lambda_{1}=3.0</annotation></semantics></math>, <math id="S3.SS3.p1.4.m4.1" class="ltx_Math" alttext="\lambda_{2}=1.0" display="inline"><semantics id="S3.SS3.p1.4.m4.1a"><mrow id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml"><msub id="S3.SS3.p1.4.m4.1.1.2" xref="S3.SS3.p1.4.m4.1.1.2.cmml"><mi id="S3.SS3.p1.4.m4.1.1.2.2" xref="S3.SS3.p1.4.m4.1.1.2.2.cmml">λ</mi><mn id="S3.SS3.p1.4.m4.1.1.2.3" xref="S3.SS3.p1.4.m4.1.1.2.3.cmml">2</mn></msub><mo id="S3.SS3.p1.4.m4.1.1.1" xref="S3.SS3.p1.4.m4.1.1.1.cmml">=</mo><mn id="S3.SS3.p1.4.m4.1.1.3" xref="S3.SS3.p1.4.m4.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><apply id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1"><eq id="S3.SS3.p1.4.m4.1.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1.1"></eq><apply id="S3.SS3.p1.4.m4.1.1.2.cmml" xref="S3.SS3.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.1.1.2.1.cmml" xref="S3.SS3.p1.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS3.p1.4.m4.1.1.2.2.cmml" xref="S3.SS3.p1.4.m4.1.1.2.2">𝜆</ci><cn type="integer" id="S3.SS3.p1.4.m4.1.1.2.3.cmml" xref="S3.SS3.p1.4.m4.1.1.2.3">2</cn></apply><cn type="float" id="S3.SS3.p1.4.m4.1.1.3.cmml" xref="S3.SS3.p1.4.m4.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">\lambda_{2}=1.0</annotation></semantics></math>, and <math id="S3.SS3.p1.5.m5.1" class="ltx_Math" alttext="\lambda_{3}=0.3" display="inline"><semantics id="S3.SS3.p1.5.m5.1a"><mrow id="S3.SS3.p1.5.m5.1.1" xref="S3.SS3.p1.5.m5.1.1.cmml"><msub id="S3.SS3.p1.5.m5.1.1.2" xref="S3.SS3.p1.5.m5.1.1.2.cmml"><mi id="S3.SS3.p1.5.m5.1.1.2.2" xref="S3.SS3.p1.5.m5.1.1.2.2.cmml">λ</mi><mn id="S3.SS3.p1.5.m5.1.1.2.3" xref="S3.SS3.p1.5.m5.1.1.2.3.cmml">3</mn></msub><mo id="S3.SS3.p1.5.m5.1.1.1" xref="S3.SS3.p1.5.m5.1.1.1.cmml">=</mo><mn id="S3.SS3.p1.5.m5.1.1.3" xref="S3.SS3.p1.5.m5.1.1.3.cmml">0.3</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.1b"><apply id="S3.SS3.p1.5.m5.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1"><eq id="S3.SS3.p1.5.m5.1.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1.1"></eq><apply id="S3.SS3.p1.5.m5.1.1.2.cmml" xref="S3.SS3.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.1.1.2.1.cmml" xref="S3.SS3.p1.5.m5.1.1.2">subscript</csymbol><ci id="S3.SS3.p1.5.m5.1.1.2.2.cmml" xref="S3.SS3.p1.5.m5.1.1.2.2">𝜆</ci><cn type="integer" id="S3.SS3.p1.5.m5.1.1.2.3.cmml" xref="S3.SS3.p1.5.m5.1.1.2.3">3</cn></apply><cn type="float" id="S3.SS3.p1.5.m5.1.1.3.cmml" xref="S3.SS3.p1.5.m5.1.1.3">0.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.1c">\lambda_{3}=0.3</annotation></semantics></math> which provided the best results. Even though the experiments are composed of real images with real deformations, our network was only trained using artificially generated deformations. To apply the non-rigid deformations and homography, we employ the code from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> to generate the simulated deformations.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.17" class="ltx_p">The training process used <math id="S3.SS3.p2.1.m1.1" class="ltx_Math" alttext="10K" display="inline"><semantics id="S3.SS3.p2.1.m1.1a"><mrow id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml"><mn id="S3.SS3.p2.1.m1.1.1.2" xref="S3.SS3.p2.1.m1.1.1.2.cmml">10</mn><mo lspace="0em" rspace="0em" id="S3.SS3.p2.1.m1.1.1.1" xref="S3.SS3.p2.1.m1.1.1.1.cmml">​</mo><mi id="S3.SS3.p2.1.m1.1.1.3" xref="S3.SS3.p2.1.m1.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1"><times id="S3.SS3.p2.1.m1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1.1"></times><cn type="integer" id="S3.SS3.p2.1.m1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1.2">10</cn><ci id="S3.SS3.p2.1.m1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">10K</annotation></semantics></math> images, resulting in 5K pairs of images with a resolution of <math id="S3.SS3.p2.2.m2.1" class="ltx_Math" alttext="400\times 300" display="inline"><semantics id="S3.SS3.p2.2.m2.1a"><mrow id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml"><mn id="S3.SS3.p2.2.m2.1.1.2" xref="S3.SS3.p2.2.m2.1.1.2.cmml">400</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p2.2.m2.1.1.1" xref="S3.SS3.p2.2.m2.1.1.1.cmml">×</mo><mn id="S3.SS3.p2.2.m2.1.1.3" xref="S3.SS3.p2.2.m2.1.1.3.cmml">300</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><apply id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1"><times id="S3.SS3.p2.2.m2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1.1"></times><cn type="integer" id="S3.SS3.p2.2.m2.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2">400</cn><cn type="integer" id="S3.SS3.p2.2.m2.1.1.3.cmml" xref="S3.SS3.p2.2.m2.1.1.3">300</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">400\times 300</annotation></semantics></math>. We applied various random photometric transformations in each image. With an initial learning rate of <math id="S3.SS3.p2.3.m3.1" class="ltx_Math" alttext="0.006" display="inline"><semantics id="S3.SS3.p2.3.m3.1a"><mn id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml">0.006</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><cn type="float" id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">0.006</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">0.006</annotation></semantics></math>, we optimize the network using Adam, scaling it by <math id="S3.SS3.p2.4.m4.1" class="ltx_Math" alttext="0.9" display="inline"><semantics id="S3.SS3.p2.4.m4.1a"><mn id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml">0.9</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><cn type="float" id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1">0.9</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">0.9</annotation></semantics></math> every <math id="S3.SS3.p2.5.m5.1" class="ltx_Math" alttext="500" display="inline"><semantics id="S3.SS3.p2.5.m5.1a"><mn id="S3.SS3.p2.5.m5.1.1" xref="S3.SS3.p2.5.m5.1.1.cmml">500</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.1b"><cn type="integer" id="S3.SS3.p2.5.m5.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1">500</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.1c">500</annotation></semantics></math> steps for <math id="S3.SS3.p2.6.m6.1" class="ltx_Math" alttext="7" display="inline"><semantics id="S3.SS3.p2.6.m6.1a"><mn id="S3.SS3.p2.6.m6.1.1" xref="S3.SS3.p2.6.m6.1.1.cmml">7</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m6.1b"><cn type="integer" id="S3.SS3.p2.6.m6.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1">7</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m6.1c">7</annotation></semantics></math> epochs. We used a batch size of <math id="S3.SS3.p2.7.m7.1" class="ltx_Math" alttext="12" display="inline"><semantics id="S3.SS3.p2.7.m7.1a"><mn id="S3.SS3.p2.7.m7.1.1" xref="S3.SS3.p2.7.m7.1.1.cmml">12</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.7.m7.1b"><cn type="integer" id="S3.SS3.p2.7.m7.1.1.cmml" xref="S3.SS3.p2.7.m7.1.1">12</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.7.m7.1c">12</annotation></semantics></math> images with at least <math id="S3.SS3.p2.8.m8.1" class="ltx_Math" alttext="32" display="inline"><semantics id="S3.SS3.p2.8.m8.1a"><mn id="S3.SS3.p2.8.m8.1.1" xref="S3.SS3.p2.8.m8.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.8.m8.1b"><cn type="integer" id="S3.SS3.p2.8.m8.1.1.cmml" xref="S3.SS3.p2.8.m8.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.8.m8.1c">32</annotation></semantics></math> peaks in their MH. We trained the model on roughly <math id="S3.SS3.p2.9.m9.1" class="ltx_Math" alttext="1.5M" display="inline"><semantics id="S3.SS3.p2.9.m9.1a"><mrow id="S3.SS3.p2.9.m9.1.1" xref="S3.SS3.p2.9.m9.1.1.cmml"><mn id="S3.SS3.p2.9.m9.1.1.2" xref="S3.SS3.p2.9.m9.1.1.2.cmml">1.5</mn><mo lspace="0em" rspace="0em" id="S3.SS3.p2.9.m9.1.1.1" xref="S3.SS3.p2.9.m9.1.1.1.cmml">​</mo><mi id="S3.SS3.p2.9.m9.1.1.3" xref="S3.SS3.p2.9.m9.1.1.3.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.9.m9.1b"><apply id="S3.SS3.p2.9.m9.1.1.cmml" xref="S3.SS3.p2.9.m9.1.1"><times id="S3.SS3.p2.9.m9.1.1.1.cmml" xref="S3.SS3.p2.9.m9.1.1.1"></times><cn type="float" id="S3.SS3.p2.9.m9.1.1.2.cmml" xref="S3.SS3.p2.9.m9.1.1.2">1.5</cn><ci id="S3.SS3.p2.9.m9.1.1.3.cmml" xref="S3.SS3.p2.9.m9.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.9.m9.1c">1.5M</annotation></semantics></math> ground truth keypoints for the ASLFeat descriptor.
We implemented the peakness loss by using Max and Average Pooling operations. The window size used in the peakiness term is <math id="S3.SS3.p2.10.m10.1" class="ltx_Math" alttext="N=5" display="inline"><semantics id="S3.SS3.p2.10.m10.1a"><mrow id="S3.SS3.p2.10.m10.1.1" xref="S3.SS3.p2.10.m10.1.1.cmml"><mi id="S3.SS3.p2.10.m10.1.1.2" xref="S3.SS3.p2.10.m10.1.1.2.cmml">N</mi><mo id="S3.SS3.p2.10.m10.1.1.1" xref="S3.SS3.p2.10.m10.1.1.1.cmml">=</mo><mn id="S3.SS3.p2.10.m10.1.1.3" xref="S3.SS3.p2.10.m10.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.10.m10.1b"><apply id="S3.SS3.p2.10.m10.1.1.cmml" xref="S3.SS3.p2.10.m10.1.1"><eq id="S3.SS3.p2.10.m10.1.1.1.cmml" xref="S3.SS3.p2.10.m10.1.1.1"></eq><ci id="S3.SS3.p2.10.m10.1.1.2.cmml" xref="S3.SS3.p2.10.m10.1.1.2">𝑁</ci><cn type="integer" id="S3.SS3.p2.10.m10.1.1.3.cmml" xref="S3.SS3.p2.10.m10.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.10.m10.1c">N=5</annotation></semantics></math>, which is defined by the kernel size used in the pooling operations. In all experiments, we applied non-maximum suppression (NMS) with a <math id="S3.SS3.p2.11.m11.1" class="ltx_Math" alttext="5\times 5" display="inline"><semantics id="S3.SS3.p2.11.m11.1a"><mrow id="S3.SS3.p2.11.m11.1.1" xref="S3.SS3.p2.11.m11.1.1.cmml"><mn id="S3.SS3.p2.11.m11.1.1.2" xref="S3.SS3.p2.11.m11.1.1.2.cmml">5</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p2.11.m11.1.1.1" xref="S3.SS3.p2.11.m11.1.1.1.cmml">×</mo><mn id="S3.SS3.p2.11.m11.1.1.3" xref="S3.SS3.p2.11.m11.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.11.m11.1b"><apply id="S3.SS3.p2.11.m11.1.1.cmml" xref="S3.SS3.p2.11.m11.1.1"><times id="S3.SS3.p2.11.m11.1.1.1.cmml" xref="S3.SS3.p2.11.m11.1.1.1"></times><cn type="integer" id="S3.SS3.p2.11.m11.1.1.2.cmml" xref="S3.SS3.p2.11.m11.1.1.2">5</cn><cn type="integer" id="S3.SS3.p2.11.m11.1.1.3.cmml" xref="S3.SS3.p2.11.m11.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.11.m11.1c">5\times 5</annotation></semantics></math> pixel window size. Additionally, we post-process the keypoints using edge reduction techniques like SIFT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> (with a threshold of <math id="S3.SS3.p2.12.m12.1" class="ltx_Math" alttext="10" display="inline"><semantics id="S3.SS3.p2.12.m12.1a"><mn id="S3.SS3.p2.12.m12.1.1" xref="S3.SS3.p2.12.m12.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.12.m12.1b"><cn type="integer" id="S3.SS3.p2.12.m12.1.1.cmml" xref="S3.SS3.p2.12.m12.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.12.m12.1c">10</annotation></semantics></math>). The top <math id="S3.SS3.p2.13.m13.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS3.p2.13.m13.1a"><mi id="S3.SS3.p2.13.m13.1.1" xref="S3.SS3.p2.13.m13.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.13.m13.1b"><ci id="S3.SS3.p2.13.m13.1.1.cmml" xref="S3.SS3.p2.13.m13.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.13.m13.1c">k</annotation></semantics></math> keypoints having the largest scores, where <math id="S3.SS3.p2.14.m14.1" class="ltx_Math" alttext="k\in\mathbb{Z}^{+}" display="inline"><semantics id="S3.SS3.p2.14.m14.1a"><mrow id="S3.SS3.p2.14.m14.1.1" xref="S3.SS3.p2.14.m14.1.1.cmml"><mi id="S3.SS3.p2.14.m14.1.1.2" xref="S3.SS3.p2.14.m14.1.1.2.cmml">k</mi><mo id="S3.SS3.p2.14.m14.1.1.1" xref="S3.SS3.p2.14.m14.1.1.1.cmml">∈</mo><msup id="S3.SS3.p2.14.m14.1.1.3" xref="S3.SS3.p2.14.m14.1.1.3.cmml"><mi id="S3.SS3.p2.14.m14.1.1.3.2" xref="S3.SS3.p2.14.m14.1.1.3.2.cmml">ℤ</mi><mo id="S3.SS3.p2.14.m14.1.1.3.3" xref="S3.SS3.p2.14.m14.1.1.3.3.cmml">+</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.14.m14.1b"><apply id="S3.SS3.p2.14.m14.1.1.cmml" xref="S3.SS3.p2.14.m14.1.1"><in id="S3.SS3.p2.14.m14.1.1.1.cmml" xref="S3.SS3.p2.14.m14.1.1.1"></in><ci id="S3.SS3.p2.14.m14.1.1.2.cmml" xref="S3.SS3.p2.14.m14.1.1.2">𝑘</ci><apply id="S3.SS3.p2.14.m14.1.1.3.cmml" xref="S3.SS3.p2.14.m14.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.14.m14.1.1.3.1.cmml" xref="S3.SS3.p2.14.m14.1.1.3">superscript</csymbol><ci id="S3.SS3.p2.14.m14.1.1.3.2.cmml" xref="S3.SS3.p2.14.m14.1.1.3.2">ℤ</ci><plus id="S3.SS3.p2.14.m14.1.1.3.3.cmml" xref="S3.SS3.p2.14.m14.1.1.3.3"></plus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.14.m14.1c">k\in\mathbb{Z}^{+}</annotation></semantics></math> with respect to detection scores are maintained, while those with detection values below <math id="S3.SS3.p2.15.m15.1" class="ltx_Math" alttext="0.2" display="inline"><semantics id="S3.SS3.p2.15.m15.1a"><mn id="S3.SS3.p2.15.m15.1.1" xref="S3.SS3.p2.15.m15.1.1.cmml">0.2</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.15.m15.1b"><cn type="float" id="S3.SS3.p2.15.m15.1.1.cmml" xref="S3.SS3.p2.15.m15.1.1">0.2</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.15.m15.1c">0.2</annotation></semantics></math> are filtered out. The average time to detect <math id="S3.SS3.p2.16.m16.2" class="ltx_Math" alttext="1{,}024" display="inline"><semantics id="S3.SS3.p2.16.m16.2a"><mrow id="S3.SS3.p2.16.m16.2.3.2" xref="S3.SS3.p2.16.m16.2.3.1.cmml"><mn id="S3.SS3.p2.16.m16.1.1" xref="S3.SS3.p2.16.m16.1.1.cmml">1</mn><mo id="S3.SS3.p2.16.m16.2.3.2.1" xref="S3.SS3.p2.16.m16.2.3.1.cmml">,</mo><mn id="S3.SS3.p2.16.m16.2.2" xref="S3.SS3.p2.16.m16.2.2.cmml">024</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.16.m16.2b"><list id="S3.SS3.p2.16.m16.2.3.1.cmml" xref="S3.SS3.p2.16.m16.2.3.2"><cn type="integer" id="S3.SS3.p2.16.m16.1.1.cmml" xref="S3.SS3.p2.16.m16.1.1">1</cn><cn type="integer" id="S3.SS3.p2.16.m16.2.2.cmml" xref="S3.SS3.p2.16.m16.2.2">024</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.16.m16.2c">1{,}024</annotation></semantics></math> keypoints in a <math id="S3.SS3.p2.17.m17.1" class="ltx_Math" alttext="600\times 900" display="inline"><semantics id="S3.SS3.p2.17.m17.1a"><mrow id="S3.SS3.p2.17.m17.1.1" xref="S3.SS3.p2.17.m17.1.1.cmml"><mn id="S3.SS3.p2.17.m17.1.1.2" xref="S3.SS3.p2.17.m17.1.1.2.cmml">600</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p2.17.m17.1.1.1" xref="S3.SS3.p2.17.m17.1.1.1.cmml">×</mo><mn id="S3.SS3.p2.17.m17.1.1.3" xref="S3.SS3.p2.17.m17.1.1.3.cmml">900</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.17.m17.1b"><apply id="S3.SS3.p2.17.m17.1.1.cmml" xref="S3.SS3.p2.17.m17.1.1"><times id="S3.SS3.p2.17.m17.1.1.1.cmml" xref="S3.SS3.p2.17.m17.1.1.1"></times><cn type="integer" id="S3.SS3.p2.17.m17.1.1.2.cmml" xref="S3.SS3.p2.17.m17.1.1.2">600</cn><cn type="integer" id="S3.SS3.p2.17.m17.1.1.3.cmml" xref="S3.SS3.p2.17.m17.1.1.3">900</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.17.m17.1c">600\times 900</annotation></semantics></math> image is 869ms, using 2.5Gb of GPU in an NVIDIA Titan XP.</p>
</div>
<figure id="S3.F3" class="ltx_figure"><img src="/html/2309.00434/assets/imgs/2col_qualitative.png" id="S3.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="538" height="338" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span><span id="S3.F3.2.1" class="ltx_text ltx_font_bold">Qualitative results on real non-rigid matching examples.</span> The green lines show correct correspondences, while red lines depict wrong correspondences. Our keypoint detector improves matching accuracy of the DEAL, ASLFeat, and SuperPoint descriptors with respect to their traditional detectors, while maintaining a similar number of total matches.</figcaption>
</figure>
</section>
</section>
<section id="S4" class="ltx_section" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments and results</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.4" class="ltx_p">The training and validation datasets were generated from random images from SfM datasets <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite>. We assess our detector using a variety of publicly accessible datasets with deformable objects under various viewing circumstances, including lighting, perspective, and deformation. We chose the two datasets recently issued by GeoBit and DeSurT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>. They contain color images of <math id="S4.p1.1.m1.1" class="ltx_Math" alttext="11" display="inline"><semantics id="S4.p1.1.m1.1a"><mn id="S4.p1.1.m1.1.1" xref="S4.p1.1.m1.1.1.cmml">11</mn><annotation-xml encoding="MathML-Content" id="S4.p1.1.m1.1b"><cn type="integer" id="S4.p1.1.m1.1.1.cmml" xref="S4.p1.1.m1.1.1">11</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.1.m1.1c">11</annotation></semantics></math> deforming real-world objects, with a total of <math id="S4.p1.2.m2.1" class="ltx_Math" alttext="770" display="inline"><semantics id="S4.p1.2.m2.1a"><mn id="S4.p1.2.m2.1.1" xref="S4.p1.2.m2.1.1.cmml">770</mn><annotation-xml encoding="MathML-Content" id="S4.p1.2.m2.1b"><cn type="integer" id="S4.p1.2.m2.1.1.cmml" xref="S4.p1.2.m2.1.1">770</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.2.m2.1c">770</annotation></semantics></math> pairs of images with shapes between <math id="S4.p1.3.m3.1" class="ltx_Math" alttext="960\times 540" display="inline"><semantics id="S4.p1.3.m3.1a"><mrow id="S4.p1.3.m3.1.1" xref="S4.p1.3.m3.1.1.cmml"><mn id="S4.p1.3.m3.1.1.2" xref="S4.p1.3.m3.1.1.2.cmml">960</mn><mo lspace="0.222em" rspace="0.222em" id="S4.p1.3.m3.1.1.1" xref="S4.p1.3.m3.1.1.1.cmml">×</mo><mn id="S4.p1.3.m3.1.1.3" xref="S4.p1.3.m3.1.1.3.cmml">540</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.3.m3.1b"><apply id="S4.p1.3.m3.1.1.cmml" xref="S4.p1.3.m3.1.1"><times id="S4.p1.3.m3.1.1.1.cmml" xref="S4.p1.3.m3.1.1.1"></times><cn type="integer" id="S4.p1.3.m3.1.1.2.cmml" xref="S4.p1.3.m3.1.1.2">960</cn><cn type="integer" id="S4.p1.3.m3.1.1.3.cmml" xref="S4.p1.3.m3.1.1.3">540</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.3.m3.1c">960\times 540</annotation></semantics></math> and <math id="S4.p1.4.m4.1" class="ltx_Math" alttext="640\times 480" display="inline"><semantics id="S4.p1.4.m4.1a"><mrow id="S4.p1.4.m4.1.1" xref="S4.p1.4.m4.1.1.cmml"><mn id="S4.p1.4.m4.1.1.2" xref="S4.p1.4.m4.1.1.2.cmml">640</mn><mo lspace="0.222em" rspace="0.222em" id="S4.p1.4.m4.1.1.1" xref="S4.p1.4.m4.1.1.1.cmml">×</mo><mn id="S4.p1.4.m4.1.1.3" xref="S4.p1.4.m4.1.1.3.cmml">480</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.4.m4.1b"><apply id="S4.p1.4.m4.1.1.cmml" xref="S4.p1.4.m4.1.1"><times id="S4.p1.4.m4.1.1.1.cmml" xref="S4.p1.4.m4.1.1.1"></times><cn type="integer" id="S4.p1.4.m4.1.1.2.cmml" xref="S4.p1.4.m4.1.1.2">640</cn><cn type="integer" id="S4.p1.4.m4.1.1.3.cmml" xref="S4.p1.4.m4.1.1.3">480</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.4.m4.1c">640\times 480</annotation></semantics></math>, and ground-truth correspondences collection follows the protocol of <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite>. Our training setting considers a base detector and descriptor. Given the large range of detectors and descriptors available, we start using ASLFeat <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> because its architecture features deformable convolutional kernels and is among the state-of-the-art methods for the detection-description task. The deformable kernels aim to develop dynamic receptive fields to accommodate the capabilities of modeling geometric variations. We also select the DEAL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> descriptor, which is non-rigid deformation invariant.
At last, to show the robustness of our training setting, we chose the SuperPoint detector-descriptor due to its success on traditional rigid matching tasks.</p>
</div>
<figure id="S4.1" class="ltx_table">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>Detector matching performance comparison. Best in bold and second-best underlined. The higher the value, the better. Our detector provides keypoints on images with non-rigid deformations that enhances the matching results.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="S4.1.1" class="ltx_inline-block ltx_figure_panel ltx_transformed_outer" style="width:433.6pt;height:202.7pt;vertical-align:-0.7pt;"><span class="ltx_transformed_inner" style="transform:translate(-105.2pt,49.0pt) scale(0.673321841083533,0.673321841083533) ;">
<table id="S4.1.1.1" class="ltx_tabular ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.1.1.1.1" class="ltx_tr">
<td id="S4.1.1.1.1.1" class="ltx_td ltx_align_center ltx_border_tt" colspan="11">Dataset <math id="S4.1.1.1.1.1.m1.1" class="ltx_Math" alttext="770" display="inline"><semantics id="S4.1.1.1.1.1.m1.1a"><mn id="S4.1.1.1.1.1.m1.1.1" xref="S4.1.1.1.1.1.m1.1.1.cmml">770</mn><annotation-xml encoding="MathML-Content" id="S4.1.1.1.1.1.m1.1b"><cn type="integer" id="S4.1.1.1.1.1.m1.1.1.cmml" xref="S4.1.1.1.1.1.m1.1.1">770</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.1.1.1.1.1.m1.1c">770</annotation></semantics></math> pairs total - MS / MMA@3 pixels</td>
</tr>
<tr id="S4.1.1.1.2.1" class="ltx_tr">
<td id="S4.1.1.1.2.1.1" class="ltx_td ltx_align_center ltx_border_t">
<table id="S4.1.1.1.2.1.1.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.1.1.1.2.1.1.1.1" class="ltx_tr">
<td id="S4.1.1.1.2.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.1.1.1.2.1.1.1.1.1.1" class="ltx_text ltx_font_bold">Detector</span></td>
</tr>
<tr id="S4.1.1.1.2.1.1.1.2" class="ltx_tr">
<td id="S4.1.1.1.2.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.1.1.1.2.1.1.1.2.1.1" class="ltx_text ltx_font_bold">+</span></td>
</tr>
<tr id="S4.1.1.1.2.1.1.1.3" class="ltx_tr">
<td id="S4.1.1.1.2.1.1.1.3.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.1.1.1.2.1.1.1.3.1.1" class="ltx_text ltx_font_bold">ASLFeat</span></td>
</tr>
</table>
</td>
<td id="S4.1.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">Kinect1</td>
<td id="S4.1.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">Kinect2</td>
<td id="S4.1.1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">DeSurT</td>
<td id="S4.1.1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t">Mean</td>
<td id="S4.1.1.1.2.1.6" class="ltx_td ltx_border_t"></td>
<td id="S4.1.1.1.2.1.7" class="ltx_td ltx_align_center ltx_border_t">
<table id="S4.1.1.1.2.1.7.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.1.1.1.2.1.7.1.1" class="ltx_tr">
<td id="S4.1.1.1.2.1.7.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.1.1.1.2.1.7.1.1.1.1" class="ltx_text ltx_font_bold">Detector</span></td>
</tr>
<tr id="S4.1.1.1.2.1.7.1.2" class="ltx_tr">
<td id="S4.1.1.1.2.1.7.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.1.1.1.2.1.7.1.2.1.1" class="ltx_text ltx_font_bold">+</span></td>
</tr>
<tr id="S4.1.1.1.2.1.7.1.3" class="ltx_tr">
<td id="S4.1.1.1.2.1.7.1.3.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.1.1.1.2.1.7.1.3.1.1" class="ltx_text ltx_font_bold">DEAL</span></td>
</tr>
</table>
</td>
<td id="S4.1.1.1.2.1.8" class="ltx_td ltx_align_center ltx_border_t">Kinect1</td>
<td id="S4.1.1.1.2.1.9" class="ltx_td ltx_align_center ltx_border_t">Kinect2</td>
<td id="S4.1.1.1.2.1.10" class="ltx_td ltx_align_center ltx_border_t">DeSurT</td>
<td id="S4.1.1.1.2.1.11" class="ltx_td ltx_align_center ltx_border_t">Mean</td>
</tr>
<tr id="S4.1.1.1.3.2" class="ltx_tr">
<td id="S4.1.1.1.3.2.1" class="ltx_td ltx_align_left ltx_border_t">SIFT</td>
<td id="S4.1.1.1.3.2.2" class="ltx_td ltx_align_left ltx_border_t">0.35 / 0.77</td>
<td id="S4.1.1.1.3.2.3" class="ltx_td ltx_align_left ltx_border_t">0.37 / 0.85</td>
<td id="S4.1.1.1.3.2.4" class="ltx_td ltx_align_left ltx_border_t">0.26 / 0.63</td>
<td id="S4.1.1.1.3.2.5" class="ltx_td ltx_align_left ltx_border_t">0.33 / 0.75</td>
<td id="S4.1.1.1.3.2.6" class="ltx_td"></td>
<td id="S4.1.1.1.3.2.7" class="ltx_td ltx_align_left ltx_border_t">SIFT</td>
<td id="S4.1.1.1.3.2.8" class="ltx_td ltx_align_left ltx_border_t">0.33 / 0.68</td>
<td id="S4.1.1.1.3.2.9" class="ltx_td ltx_align_left ltx_border_t">0.38 / <span id="S4.1.1.1.3.2.9.1" class="ltx_text ltx_font_bold">0.85</span>
</td>
<td id="S4.1.1.1.3.2.10" class="ltx_td ltx_align_left ltx_border_t">0.27 / <span id="S4.1.1.1.3.2.10.1" class="ltx_text ltx_font_bold">0.63</span>
</td>
<td id="S4.1.1.1.3.2.11" class="ltx_td ltx_align_left ltx_border_t">0.33 / <span id="S4.1.1.1.3.2.11.1" class="ltx_text ltx_framed ltx_framed_underline">0.72</span>
</td>
</tr>
<tr id="S4.1.1.1.4.3" class="ltx_tr">
<td id="S4.1.1.1.4.3.1" class="ltx_td ltx_align_left">FAST</td>
<td id="S4.1.1.1.4.3.2" class="ltx_td ltx_align_left">0.43 / 0.69</td>
<td id="S4.1.1.1.4.3.3" class="ltx_td ltx_align_left">0.53 / 0.85</td>
<td id="S4.1.1.1.4.3.4" class="ltx_td ltx_align_left">0.33 / 0.56</td>
<td id="S4.1.1.1.4.3.5" class="ltx_td ltx_align_left">
<span id="S4.1.1.1.4.3.5.1" class="ltx_text ltx_framed ltx_framed_underline">0.43</span> / 0.70</td>
<td id="S4.1.1.1.4.3.6" class="ltx_td"></td>
<td id="S4.1.1.1.4.3.7" class="ltx_td ltx_align_left">FAST</td>
<td id="S4.1.1.1.4.3.8" class="ltx_td ltx_align_left">0.36 / 0.58</td>
<td id="S4.1.1.1.4.3.9" class="ltx_td ltx_align_left">
<span id="S4.1.1.1.4.3.9.1" class="ltx_text ltx_font_bold">0.51</span> / 0.81</td>
<td id="S4.1.1.1.4.3.10" class="ltx_td ltx_align_left">
<span id="S4.1.1.1.4.3.10.1" class="ltx_text ltx_framed ltx_framed_underline">0.29</span> / 0.49</td>
<td id="S4.1.1.1.4.3.11" class="ltx_td ltx_align_left">0.39 / 0.63</td>
</tr>
<tr id="S4.1.1.1.5.4" class="ltx_tr">
<td id="S4.1.1.1.5.4.1" class="ltx_td ltx_align_left">AKAZE</td>
<td id="S4.1.1.1.5.4.2" class="ltx_td ltx_align_left">0.39 / 0.66</td>
<td id="S4.1.1.1.5.4.3" class="ltx_td ltx_align_left">0.49 / 0.76</td>
<td id="S4.1.1.1.5.4.4" class="ltx_td ltx_align_left">0.26 / 0.48</td>
<td id="S4.1.1.1.5.4.5" class="ltx_td ltx_align_left">0.40 / 0.66</td>
<td id="S4.1.1.1.5.4.6" class="ltx_td"></td>
<td id="S4.1.1.1.5.4.7" class="ltx_td ltx_align_left">AKAZE</td>
<td id="S4.1.1.1.5.4.8" class="ltx_td ltx_align_left">0.38 / 0.65</td>
<td id="S4.1.1.1.5.4.9" class="ltx_td ltx_align_left">0.47 / 0.74</td>
<td id="S4.1.1.1.5.4.10" class="ltx_td ltx_align_left">0.23 / 0.42</td>
<td id="S4.1.1.1.5.4.11" class="ltx_td ltx_align_left">0.36 / 0.60</td>
</tr>
<tr id="S4.1.1.1.6.5" class="ltx_tr">
<td id="S4.1.1.1.6.5.1" class="ltx_td ltx_align_left">Keynet</td>
<td id="S4.1.1.1.6.5.2" class="ltx_td ltx_align_left">0.31 / 0.65</td>
<td id="S4.1.1.1.6.5.3" class="ltx_td ltx_align_left">0.35 / 0.62</td>
<td id="S4.1.1.1.6.5.4" class="ltx_td ltx_align_left">0.24 / 0.51</td>
<td id="S4.1.1.1.6.5.5" class="ltx_td ltx_align_left">0.30 / 0.59</td>
<td id="S4.1.1.1.6.5.6" class="ltx_td"></td>
<td id="S4.1.1.1.6.5.7" class="ltx_td ltx_align_left">Keynet</td>
<td id="S4.1.1.1.6.5.8" class="ltx_td ltx_align_left">0.27 / 0.58</td>
<td id="S4.1.1.1.6.5.9" class="ltx_td ltx_align_left">0.34 / 0.59</td>
<td id="S4.1.1.1.6.5.10" class="ltx_td ltx_align_left">0.22 / 0.45</td>
<td id="S4.1.1.1.6.5.11" class="ltx_td ltx_align_left">0.28 / 0.54</td>
</tr>
<tr id="S4.1.1.1.7.6" class="ltx_tr">
<td id="S4.1.1.1.7.6.1" class="ltx_td ltx_align_left">ASLFeat</td>
<td id="S4.1.1.1.7.6.2" class="ltx_td ltx_align_left">0.31 / 0.58</td>
<td id="S4.1.1.1.7.6.3" class="ltx_td ltx_align_left">0.39 / 0.69</td>
<td id="S4.1.1.1.7.6.4" class="ltx_td ltx_align_left">0.28 / 0.53</td>
<td id="S4.1.1.1.7.6.5" class="ltx_td ltx_align_left">0.33 / 0.60</td>
<td id="S4.1.1.1.7.6.6" class="ltx_td"></td>
<td id="S4.1.1.1.7.6.7" class="ltx_td ltx_align_left">ASLFeat</td>
<td id="S4.1.1.1.7.6.8" class="ltx_td ltx_align_left">0.31 / 0.66</td>
<td id="S4.1.1.1.7.6.9" class="ltx_td ltx_align_left">0.40 / 0.73</td>
<td id="S4.1.1.1.7.6.10" class="ltx_td ltx_align_left">0.25 / 0.54</td>
<td id="S4.1.1.1.7.6.11" class="ltx_td ltx_align_left">0.32 / 0.64</td>
</tr>
<tr id="S4.1.1.1.8.7" class="ltx_tr">
<td id="S4.1.1.1.8.7.1" class="ltx_td ltx_align_left">R2D2</td>
<td id="S4.1.1.1.8.7.2" class="ltx_td ltx_align_left">0.20 / 0.51</td>
<td id="S4.1.1.1.8.7.3" class="ltx_td ltx_align_left">0.24 / 0.57</td>
<td id="S4.1.1.1.8.7.4" class="ltx_td ltx_align_left">0.15 / 0.40</td>
<td id="S4.1.1.1.8.7.5" class="ltx_td ltx_align_left">0.20 / 0.49</td>
<td id="S4.1.1.1.8.7.6" class="ltx_td"></td>
<td id="S4.1.1.1.8.7.7" class="ltx_td ltx_align_left">R2D2</td>
<td id="S4.1.1.1.8.7.8" class="ltx_td ltx_align_left">0.16 / 0.41</td>
<td id="S4.1.1.1.8.7.9" class="ltx_td ltx_align_left">0.20 / 0.48</td>
<td id="S4.1.1.1.8.7.10" class="ltx_td ltx_align_left">0.12 / 0.33</td>
<td id="S4.1.1.1.8.7.11" class="ltx_td ltx_align_left">0.16 / 0.41</td>
</tr>
<tr id="S4.1.1.1.9.8" class="ltx_tr">
<td id="S4.1.1.1.9.8.1" class="ltx_td ltx_align_left">ORB</td>
<td id="S4.1.1.1.9.8.2" class="ltx_td ltx_align_left">0.17 / 0.37</td>
<td id="S4.1.1.1.9.8.3" class="ltx_td ltx_align_left">0.26 / 0.57</td>
<td id="S4.1.1.1.9.8.4" class="ltx_td ltx_align_left">0.14 / 0.34</td>
<td id="S4.1.1.1.9.8.5" class="ltx_td ltx_align_left">0.19 / 0.43</td>
<td id="S4.1.1.1.9.8.6" class="ltx_td"></td>
<td id="S4.1.1.1.9.8.7" class="ltx_td ltx_align_left">ORB</td>
<td id="S4.1.1.1.9.8.8" class="ltx_td ltx_align_left">0.03 / 0.07</td>
<td id="S4.1.1.1.9.8.9" class="ltx_td ltx_align_left">0.14 / 0.34</td>
<td id="S4.1.1.1.9.8.10" class="ltx_td ltx_align_left">0.06 / 0.15</td>
<td id="S4.1.1.1.9.8.11" class="ltx_td ltx_align_left">0.08 / 0.19</td>
</tr>
<tr id="S4.1.1.1.10.9" class="ltx_tr">
<td id="S4.1.1.1.10.9.1" class="ltx_td ltx_align_left">D2NET</td>
<td id="S4.1.1.1.10.9.2" class="ltx_td ltx_align_left">0.32 / 0.83</td>
<td id="S4.1.1.1.10.9.3" class="ltx_td ltx_align_left">0.37 / <span id="S4.1.1.1.10.9.3.1" class="ltx_text ltx_font_bold">0.89</span>
</td>
<td id="S4.1.1.1.10.9.4" class="ltx_td ltx_align_left">0.18 / <span id="S4.1.1.1.10.9.4.1" class="ltx_text ltx_font_bold">0.68</span>
</td>
<td id="S4.1.1.1.10.9.5" class="ltx_td ltx_align_left">0.29 / <span id="S4.1.1.1.10.9.5.1" class="ltx_text ltx_framed ltx_framed_underline">0.80</span>
</td>
<td id="S4.1.1.1.10.9.6" class="ltx_td"></td>
<td id="S4.1.1.1.10.9.7" class="ltx_td ltx_align_left">D2NET</td>
<td id="S4.1.1.1.10.9.8" class="ltx_td ltx_align_left">0.28 / <span id="S4.1.1.1.10.9.8.1" class="ltx_text ltx_framed ltx_framed_underline">0.72</span>
</td>
<td id="S4.1.1.1.10.9.9" class="ltx_td ltx_align_left">0.34 / <span id="S4.1.1.1.10.9.9.1" class="ltx_text ltx_framed ltx_framed_underline">0.84</span>
</td>
<td id="S4.1.1.1.10.9.10" class="ltx_td ltx_align_left">0.16 / 0.57</td>
<td id="S4.1.1.1.10.9.11" class="ltx_td ltx_align_left">0.26 / 0.71</td>
</tr>
<tr id="S4.1.1.1.11.10" class="ltx_tr">
<td id="S4.1.1.1.11.10.1" class="ltx_td ltx_align_left">DISK</td>
<td id="S4.1.1.1.11.10.2" class="ltx_td ltx_align_left">
<span id="S4.1.1.1.11.10.2.1" class="ltx_text ltx_font_bold">0.57</span> / <span id="S4.1.1.1.11.10.2.2" class="ltx_text ltx_framed ltx_framed_underline">0.85</span>
</td>
<td id="S4.1.1.1.11.10.3" class="ltx_td ltx_align_left">0.51 / <span id="S4.1.1.1.11.10.3.1" class="ltx_text ltx_framed ltx_framed_underline">0.88</span>
</td>
<td id="S4.1.1.1.11.10.4" class="ltx_td ltx_align_left">
<span id="S4.1.1.1.11.10.4.1" class="ltx_text ltx_font_bold">0.40</span> / <span id="S4.1.1.1.11.10.4.2" class="ltx_text ltx_framed ltx_framed_underline">0.66</span>
</td>
<td id="S4.1.1.1.11.10.5" class="ltx_td ltx_align_left">
<span id="S4.1.1.1.11.10.5.1" class="ltx_text ltx_font_bold">0.49</span> / <span id="S4.1.1.1.11.10.5.2" class="ltx_text ltx_framed ltx_framed_underline">0.80</span>
</td>
<td id="S4.1.1.1.11.10.6" class="ltx_td"></td>
<td id="S4.1.1.1.11.10.7" class="ltx_td ltx_align_left">DISK</td>
<td id="S4.1.1.1.11.10.8" class="ltx_td ltx_align_left">
<span id="S4.1.1.1.11.10.8.1" class="ltx_text ltx_font_bold">0.48</span> / 0.71</td>
<td id="S4.1.1.1.11.10.9" class="ltx_td ltx_align_left">0.46 / 0.80</td>
<td id="S4.1.1.1.11.10.10" class="ltx_td ltx_align_left">
<span id="S4.1.1.1.11.10.10.1" class="ltx_text ltx_font_bold">0.35</span> / 0.55</td>
<td id="S4.1.1.1.11.10.11" class="ltx_td ltx_align_left">
<span id="S4.1.1.1.11.10.11.1" class="ltx_text ltx_font_bold">0.43</span> / 0.69</td>
</tr>
<tr id="S4.1.1.1.12.11" class="ltx_tr">
<td id="S4.1.1.1.12.11.1" class="ltx_td ltx_align_left">ALIKE</td>
<td id="S4.1.1.1.12.11.2" class="ltx_td ltx_align_left">0.45 / 0.68</td>
<td id="S4.1.1.1.12.11.3" class="ltx_td ltx_align_left">
<span id="S4.1.1.1.12.11.3.1" class="ltx_text ltx_framed ltx_framed_underline">0.53</span> / 0.84</td>
<td id="S4.1.1.1.12.11.4" class="ltx_td ltx_align_left">0.31 / 0.48</td>
<td id="S4.1.1.1.12.11.5" class="ltx_td ltx_align_left">
<span id="S4.1.1.1.12.11.5.1" class="ltx_text ltx_framed ltx_framed_underline">0.43</span> / 0.67</td>
<td id="S4.1.1.1.12.11.6" class="ltx_td"></td>
<td id="S4.1.1.1.12.11.7" class="ltx_td ltx_align_left">ALIKE</td>
<td id="S4.1.1.1.12.11.8" class="ltx_td ltx_align_left">0.4 / 0.61</td>
<td id="S4.1.1.1.12.11.9" class="ltx_td ltx_align_left">
<span id="S4.1.1.1.12.11.9.1" class="ltx_text ltx_framed ltx_framed_underline">0.49</span> / 0.78</td>
<td id="S4.1.1.1.12.11.10" class="ltx_td ltx_align_left">
<span id="S4.1.1.1.12.11.10.1" class="ltx_text ltx_framed ltx_framed_underline">0.29</span> / 0.44</td>
<td id="S4.1.1.1.12.11.11" class="ltx_td ltx_align_left">0.39 / 0.61</td>
</tr>
<tr id="S4.1.1.1.13.12" class="ltx_tr">
<td id="S4.1.1.1.13.12.1" class="ltx_td ltx_align_left">SuperPoint</td>
<td id="S4.1.1.1.13.12.2" class="ltx_td ltx_align_left">0.46 / 0.77</td>
<td id="S4.1.1.1.13.12.3" class="ltx_td ltx_align_left">
<span id="S4.1.1.1.13.12.3.1" class="ltx_text ltx_font_bold">0.56</span> / <span id="S4.1.1.1.13.12.3.2" class="ltx_text ltx_font_bold">0.89</span>
</td>
<td id="S4.1.1.1.13.12.4" class="ltx_td ltx_align_left">
<span id="S4.1.1.1.13.12.4.1" class="ltx_text ltx_framed ltx_framed_underline">0.34</span> / 0.61</td>
<td id="S4.1.1.1.13.12.5" class="ltx_td ltx_align_left">0.42 / 0.76</td>
<td id="S4.1.1.1.13.12.6" class="ltx_td"></td>
<td id="S4.1.1.1.13.12.7" class="ltx_td ltx_align_left">SuperPoint</td>
<td id="S4.1.1.1.13.12.8" class="ltx_td ltx_align_left">0.34 / 0.57</td>
<td id="S4.1.1.1.13.12.9" class="ltx_td ltx_align_left">0.47 / 0.75</td>
<td id="S4.1.1.1.13.12.10" class="ltx_td ltx_align_left">0.27 / 0.48</td>
<td id="S4.1.1.1.13.12.11" class="ltx_td ltx_align_left">0.36 / 0.60</td>
</tr>
<tr id="S4.1.1.1.14.13" class="ltx_tr">
<td id="S4.1.1.1.14.13.1" class="ltx_td ltx_align_left ltx_border_bb">
<span id="S4.1.1.1.14.13.1.1" class="ltx_ERROR undefined">\hdashline</span>
Ours</td>
<td id="S4.1.1.1.14.13.2" class="ltx_td ltx_align_left ltx_border_bb">
<span id="S4.1.1.1.14.13.2.1" class="ltx_text ltx_framed ltx_framed_underline">0.49</span> / <span id="S4.1.1.1.14.13.2.2" class="ltx_text ltx_font_bold">0.86</span>
</td>
<td id="S4.1.1.1.14.13.3" class="ltx_td ltx_align_left ltx_border_bb">0.48 / <span id="S4.1.1.1.14.13.3.1" class="ltx_text ltx_font_bold">0.89</span>
</td>
<td id="S4.1.1.1.14.13.4" class="ltx_td ltx_align_left ltx_border_bb">0.31 / <span id="S4.1.1.1.14.13.4.1" class="ltx_text ltx_framed ltx_framed_underline">0.66</span>
</td>
<td id="S4.1.1.1.14.13.5" class="ltx_td ltx_align_left ltx_border_bb">
<span id="S4.1.1.1.14.13.5.1" class="ltx_text ltx_framed ltx_framed_underline">0.43</span> / <span id="S4.1.1.1.14.13.5.2" class="ltx_text ltx_font_bold">0.81</span>
</td>
<td id="S4.1.1.1.14.13.6" class="ltx_td ltx_border_bb"></td>
<td id="S4.1.1.1.14.13.7" class="ltx_td ltx_align_left ltx_border_bb">Ours</td>
<td id="S4.1.1.1.14.13.8" class="ltx_td ltx_align_left ltx_border_bb">
<span id="S4.1.1.1.14.13.8.1" class="ltx_text ltx_framed ltx_framed_underline">0.45</span> / <span id="S4.1.1.1.14.13.8.2" class="ltx_text ltx_font_bold">0.79</span>
</td>
<td id="S4.1.1.1.14.13.9" class="ltx_td ltx_align_left ltx_border_bb">0.46 / <span id="S4.1.1.1.14.13.9.1" class="ltx_text ltx_font_bold">0.85</span>
</td>
<td id="S4.1.1.1.14.13.10" class="ltx_td ltx_align_left ltx_border_bb">0.28 / <span id="S4.1.1.1.14.13.10.1" class="ltx_text ltx_framed ltx_framed_underline">0.59</span>
</td>
<td id="S4.1.1.1.14.13.11" class="ltx_td ltx_align_left ltx_border_bb">
<span id="S4.1.1.1.14.13.11.1" class="ltx_text ltx_framed ltx_framed_underline">0.40</span> / <span id="S4.1.1.1.14.13.11.2" class="ltx_text ltx_font_bold">0.74</span>
</td>
</tr>
</tbody>
</table>
</span></div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<section id="S4.SS1" class="ltx_subsection ltx_figure_panel">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Metrics and baselines</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.2" class="ltx_p">In our experiments, we use the Mean Matching Accuracy (MMA) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> that computes the ratio of correct matches to possible matches; and the Matching Score (MS) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. We chose these metrics since the ultimate objective of our feature detection is to maximize the number of correct feature matches. We also employ keypoint Repeatability Rate (RR), a popular keypoint metric that computes the ratio of potential matches to the minimum number of keypoints in the shared view with a <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="3" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mn id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><cn type="integer" id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">3</annotation></semantics></math> pixel error threshold. We perform comparisons to eleven widely adopted detectors across three descriptors. We take into account three handcrafted detectors, SIFT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>, ORB, FAST <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite> and AKAZE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite>, which provide stable keypoints and are still regarded as good baselines by a recent study <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite>; and seven state-of-the-art learning-based frameworks: Keynet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, ASLFeat <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>, R2D2 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, D2Net <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>, DISK <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>, ALIKE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> and SuperPoint <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>. Considering the discussion of Mikolajczyk <span id="S4.SS1.p1.2.1" class="ltx_text ltx_font_italic">et al</span>.<span id="S4.SS1.p1.2.2" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite>, the metrics require the methods to detect enough keypoints for the stability of the results. For that reason, on each image, each detector is configured to find <math id="S4.SS1.p1.2.m2.2" class="ltx_Math" alttext="1,024" display="inline"><semantics id="S4.SS1.p1.2.m2.2a"><mrow id="S4.SS1.p1.2.m2.2.3.2" xref="S4.SS1.p1.2.m2.2.3.1.cmml"><mn id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">1</mn><mo id="S4.SS1.p1.2.m2.2.3.2.1" xref="S4.SS1.p1.2.m2.2.3.1.cmml">,</mo><mn id="S4.SS1.p1.2.m2.2.2" xref="S4.SS1.p1.2.m2.2.2.cmml">024</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.2b"><list id="S4.SS1.p1.2.m2.2.3.1.cmml" xref="S4.SS1.p1.2.m2.2.3.2"><cn type="integer" id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">1</cn><cn type="integer" id="S4.SS1.p1.2.m2.2.2.cmml" xref="S4.SS1.p1.2.m2.2.2">024</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.2c">1,024</annotation></semantics></math> keypoints. Methods like SEKD and GLAM could not maintain a large number of detections and, for that reason, are not included in Table <a href="#S4" title="4 Experiments and results ‣ Improving the matching of deformable objects by learning to detect keypoints" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a></p>
</div>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Results on sequences of deformable objects</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.6" class="ltx_p">We evaluate the metrics achieved by the detectors using existing descriptors. For this, we chose DEAL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>, ASLFeat <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>, and SuperPoint <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite> as descriptors and re-trained three detectors to match each of the three considered descriptors. As can be observed in Table <a href="#S4" title="4 Experiments and results ‣ Improving the matching of deformable objects by learning to detect keypoints" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, in both MS and MMA metrics, our keypoints combined with DEAL descriptors perform better on average than all detector-DEAL combinations. It is also clear that our trained detector achieves the best MMA across all datasets for the ASLFeat descriptor. It is important to note that when the ASLFeat’s detector is replaced by ours, the average MMA score jumps from <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="0.60" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mn id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">0.60</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><cn type="float" id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">0.60</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">0.60</annotation></semantics></math> to <math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="0.80" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><mn id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">0.80</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><cn type="float" id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">0.80</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">0.80</annotation></semantics></math> (<math id="S4.SS2.p1.3.m3.1" class="ltx_Math" alttext="20" display="inline"><semantics id="S4.SS2.p1.3.m3.1a"><mn id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><cn type="integer" id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">20</annotation></semantics></math> p.p.), and our approach is significantly different from the second-best MMA method by <math id="S4.SS2.p1.4.m4.1" class="ltx_Math" alttext="4" display="inline"><semantics id="S4.SS2.p1.4.m4.1a"><mn id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><cn type="integer" id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">4</annotation></semantics></math> p.p (SuperPoint-ASLFeat). When compared to the SIFT detector used to train the DEAL descriptor, our detector consistently gets the highest and second-best MS and MMA scores, improving, on average, by roughly <math id="S4.SS2.p1.5.m5.1" class="ltx_Math" alttext="7" display="inline"><semantics id="S4.SS2.p1.5.m5.1a"><mn id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml">7</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.1b"><cn type="integer" id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1">7</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.1c">7</annotation></semantics></math> and <math id="S4.SS2.p1.6.m6.1" class="ltx_Math" alttext="2" display="inline"><semantics id="S4.SS2.p1.6.m6.1a"><mn id="S4.SS2.p1.6.m6.1.1" xref="S4.SS2.p1.6.m6.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m6.1b"><cn type="integer" id="S4.SS2.p1.6.m6.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m6.1c">2</annotation></semantics></math> points for MS and MMA respectively. Matching examples of our detector using various descriptors are shown in Figure <a href="#S3.F3" title="Figure 3 ‣ 3.3 Implementation details ‣ 3 Methodology ‣ Improving the matching of deformable objects by learning to detect keypoints" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. Similar to the SIFT and ASLFeat detectors, our technique can provide evenly spaced matches in the image, but with higher accuracy.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.5" class="ltx_p">Aside from MMA and MS, we also evaluated the repeatability rate, where FAST has the best RR of any approach, averaging <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="0.59" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><mn id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml">0.59</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><cn type="float" id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">0.59</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">0.59</annotation></semantics></math> and followed by SuperPoint at <math id="S4.SS2.p2.2.m2.1" class="ltx_Math" alttext="0.57" display="inline"><semantics id="S4.SS2.p2.2.m2.1a"><mn id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml">0.57</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><cn type="float" id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">0.57</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">0.57</annotation></semantics></math>. AKAZE, ASLFeat, and our approach achieve an RR of <math id="S4.SS2.p2.3.m3.1" class="ltx_Math" alttext="0.50" display="inline"><semantics id="S4.SS2.p2.3.m3.1a"><mn id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml">0.50</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><cn type="float" id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1">0.50</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">0.50</annotation></semantics></math>. SIFT has the lowest RR metric of any detector with <math id="S4.SS2.p2.4.m4.1" class="ltx_Math" alttext="0.43" display="inline"><semantics id="S4.SS2.p2.4.m4.1a"><mn id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml">0.43</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><cn type="float" id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1">0.43</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.1c">0.43</annotation></semantics></math>. These results demonstrate that our detector achieves a competitive RR while improving the MMA and MS matching metrics. It is noteworthy that, while having a high RR, the ASLFeat detector has a smaller MS and MMA, as shown in Table <a href="#S4" title="4 Experiments and results ‣ Improving the matching of deformable objects by learning to detect keypoints" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. Moreover, a high RR does not necessarily translate into strong matching results. We also extended our experiments to retrain our detector using the widely adopted learned detector-descriptor SuperPoint. In Table <a href="#S4.SS2" title="4.2 Results on sequences of deformable objects ‣ 4.1 Metrics and baselines ‣ 4 Experiments and results ‣ Improving the matching of deformable objects by learning to detect keypoints" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>, we compare the results of all the previous baseline detectors in conjunction with SuperPoint descriptors. The "Ours [SP]" line shows the results of training on SuperPoint keypoints and descriptors. Even though SuperPoint has a joint detector-descriptor learning method, we were able to better filter the detection in a way that we have better matches at the cost of less repeatable keypoints. We highlight that the SuperPoint training already includes keypoint augmentation via homography to improve repeatability, thus it would be very challenging to improve upon that without losing match accuracy. We gain <math id="S4.SS2.p2.5.m5.1" class="ltx_Math" alttext="6" display="inline"><semantics id="S4.SS2.p2.5.m5.1a"><mn id="S4.SS2.p2.5.m5.1.1" xref="S4.SS2.p2.5.m5.1.1.cmml">6</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.5.m5.1b"><cn type="integer" id="S4.SS2.p2.5.m5.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1">6</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.5.m5.1c">6</annotation></semantics></math> p.p. in MMA, showing that our keypoints are still competitive for the descriptor.</p>
</div>
<figure id="S4.SS2.tab1" class="ltx_table">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>Detector matching performance comparison. Best in bold and second-best underlined.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="S4.SS2.tab1.1" class="ltx_inline-block ltx_figure_panel ltx_transformed_outer" style="width:208.1pt;height:203.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-51.1pt,49.9pt) scale(0.670683244729262,0.670683244729262) ;">
<table id="S4.SS2.tab1.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.SS2.tab1.1.1.1.1" class="ltx_tr">
<th id="S4.SS2.tab1.1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" colspan="5">Dataset 770 pairs total - MS / MMA@3</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.SS2.tab1.1.1.2.1" class="ltx_tr">
<th id="S4.SS2.tab1.1.1.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">
<table id="S4.SS2.tab1.1.1.2.1.1.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.SS2.tab1.1.1.2.1.1.1.1" class="ltx_tr">
<td id="S4.SS2.tab1.1.1.2.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.SS2.tab1.1.1.2.1.1.1.1.1.1" class="ltx_text ltx_font_bold">Detector</span></td>
</tr>
<tr id="S4.SS2.tab1.1.1.2.1.1.1.2" class="ltx_tr">
<td id="S4.SS2.tab1.1.1.2.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.SS2.tab1.1.1.2.1.1.1.2.1.1" class="ltx_text ltx_font_bold">+</span></td>
</tr>
<tr id="S4.SS2.tab1.1.1.2.1.1.1.3" class="ltx_tr">
<td id="S4.SS2.tab1.1.1.2.1.1.1.3.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.SS2.tab1.1.1.2.1.1.1.3.1.1" class="ltx_text ltx_font_bold">SuperPoint</span></td>
</tr>
</table>
</th>
<td id="S4.SS2.tab1.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">Kinect1</td>
<td id="S4.SS2.tab1.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">Kinect2</td>
<td id="S4.SS2.tab1.1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">DeSurT</td>
<td id="S4.SS2.tab1.1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t">Mean</td>
</tr>
<tr id="S4.SS2.tab1.1.1.3.2" class="ltx_tr">
<th id="S4.SS2.tab1.1.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">SIFT</th>
<td id="S4.SS2.tab1.1.1.3.2.2" class="ltx_td ltx_align_center ltx_border_t">0.34 / 0.74</td>
<td id="S4.SS2.tab1.1.1.3.2.3" class="ltx_td ltx_align_center ltx_border_t">0.36 / 0.85</td>
<td id="S4.SS2.tab1.1.1.3.2.4" class="ltx_td ltx_align_center ltx_border_t">0.25 / <span id="S4.SS2.tab1.1.1.3.2.4.1" class="ltx_text ltx_framed ltx_framed_underline">0.63</span>
</td>
<td id="S4.SS2.tab1.1.1.3.2.5" class="ltx_td ltx_align_center ltx_border_t">0.32 / 0.74</td>
</tr>
<tr id="S4.SS2.tab1.1.1.4.3" class="ltx_tr">
<th id="S4.SS2.tab1.1.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">FAST</th>
<td id="S4.SS2.tab1.1.1.4.3.2" class="ltx_td ltx_align_center">0.38 / 0.79</td>
<td id="S4.SS2.tab1.1.1.4.3.3" class="ltx_td ltx_align_center">0.39 / 0.55</td>
<td id="S4.SS2.tab1.1.1.4.3.4" class="ltx_td ltx_align_center">0.30 / 0.48</td>
<td id="S4.SS2.tab1.1.1.4.3.5" class="ltx_td ltx_align_center">0.36 / 0.61</td>
</tr>
<tr id="S4.SS2.tab1.1.1.5.4" class="ltx_tr">
<th id="S4.SS2.tab1.1.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">AKAZE</th>
<td id="S4.SS2.tab1.1.1.5.4.2" class="ltx_td ltx_align_center">0.41 / 0.69</td>
<td id="S4.SS2.tab1.1.1.5.4.3" class="ltx_td ltx_align_center">0.47 / 0.69</td>
<td id="S4.SS2.tab1.1.1.5.4.4" class="ltx_td ltx_align_center">0.28 / 0.59</td>
<td id="S4.SS2.tab1.1.1.5.4.5" class="ltx_td ltx_align_center">0.39 / 0.67</td>
</tr>
<tr id="S4.SS2.tab1.1.1.6.5" class="ltx_tr">
<th id="S4.SS2.tab1.1.1.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Keynet</th>
<td id="S4.SS2.tab1.1.1.6.5.2" class="ltx_td ltx_align_center">0.28 / 0.59</td>
<td id="S4.SS2.tab1.1.1.6.5.3" class="ltx_td ltx_align_center">0.37 / 0.64</td>
<td id="S4.SS2.tab1.1.1.6.5.4" class="ltx_td ltx_align_center">0.24 / 0.51</td>
<td id="S4.SS2.tab1.1.1.6.5.5" class="ltx_td ltx_align_center">0.30 / 0.58</td>
</tr>
<tr id="S4.SS2.tab1.1.1.7.6" class="ltx_tr">
<th id="S4.SS2.tab1.1.1.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">ASLFeat</th>
<td id="S4.SS2.tab1.1.1.7.6.2" class="ltx_td ltx_align_center">
<span id="S4.SS2.tab1.1.1.7.6.2.1" class="ltx_text ltx_framed ltx_framed_underline">0.48</span> / <span id="S4.SS2.tab1.1.1.7.6.2.2" class="ltx_text ltx_font_bold">0.84</span>
</td>
<td id="S4.SS2.tab1.1.1.7.6.3" class="ltx_td ltx_align_center">
<span id="S4.SS2.tab1.1.1.7.6.3.1" class="ltx_text ltx_font_bold">0.53</span> / 0.78</td>
<td id="S4.SS2.tab1.1.1.7.6.4" class="ltx_td ltx_align_center">
<span id="S4.SS2.tab1.1.1.7.6.4.1" class="ltx_text ltx_font_bold">0.34</span> / 0.62</td>
<td id="S4.SS2.tab1.1.1.7.6.5" class="ltx_td ltx_align_center">
<span id="S4.SS2.tab1.1.1.7.6.5.1" class="ltx_text ltx_framed ltx_framed_underline">0.45</span> / 0.75</td>
</tr>
<tr id="S4.SS2.tab1.1.1.8.7" class="ltx_tr">
<th id="S4.SS2.tab1.1.1.8.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">R2D2</th>
<td id="S4.SS2.tab1.1.1.8.7.2" class="ltx_td ltx_align_center">0.18 / 0.48</td>
<td id="S4.SS2.tab1.1.1.8.7.3" class="ltx_td ltx_align_center">0.22 / 0.54</td>
<td id="S4.SS2.tab1.1.1.8.7.4" class="ltx_td ltx_align_center">0.14 / 0.37</td>
<td id="S4.SS2.tab1.1.1.8.7.5" class="ltx_td ltx_align_center">0.18 / 0.46</td>
</tr>
<tr id="S4.SS2.tab1.1.1.9.8" class="ltx_tr">
<th id="S4.SS2.tab1.1.1.9.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">ORB</th>
<td id="S4.SS2.tab1.1.1.9.8.2" class="ltx_td ltx_align_center">0.14 / 0.31</td>
<td id="S4.SS2.tab1.1.1.9.8.3" class="ltx_td ltx_align_center">0.23 / 0.51</td>
<td id="S4.SS2.tab1.1.1.9.8.4" class="ltx_td ltx_align_center">0.13 / 0.30</td>
<td id="S4.SS2.tab1.1.1.9.8.5" class="ltx_td ltx_align_center">0.17 / 0.37</td>
</tr>
<tr id="S4.SS2.tab1.1.1.10.9" class="ltx_tr">
<th id="S4.SS2.tab1.1.1.10.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">D2NET</th>
<td id="S4.SS2.tab1.1.1.10.9.2" class="ltx_td ltx_align_center">0.31 / <span id="S4.SS2.tab1.1.1.10.9.2.1" class="ltx_text ltx_framed ltx_framed_underline">0.80</span>
</td>
<td id="S4.SS2.tab1.1.1.10.9.3" class="ltx_td ltx_align_center">0.35 / <span id="S4.SS2.tab1.1.1.10.9.3.1" class="ltx_text ltx_framed ltx_framed_underline">0.87</span>
</td>
<td id="S4.SS2.tab1.1.1.10.9.4" class="ltx_td ltx_align_center">0.18 / <span id="S4.SS2.tab1.1.1.10.9.4.1" class="ltx_text ltx_font_bold">0.67</span>
</td>
<td id="S4.SS2.tab1.1.1.10.9.5" class="ltx_td ltx_align_center">0.28 / <span id="S4.SS2.tab1.1.1.10.9.5.1" class="ltx_text ltx_font_bold">0.78</span>
</td>
</tr>
<tr id="S4.SS2.tab1.1.1.11.10" class="ltx_tr">
<th id="S4.SS2.tab1.1.1.11.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">DISK</th>
<td id="S4.SS2.tab1.1.1.11.10.2" class="ltx_td ltx_align_center">
<span id="S4.SS2.tab1.1.1.11.10.2.1" class="ltx_text ltx_font_bold">0.53</span> / <span id="S4.SS2.tab1.1.1.11.10.2.2" class="ltx_text ltx_framed ltx_framed_underline">0.80</span>
</td>
<td id="S4.SS2.tab1.1.1.11.10.3" class="ltx_td ltx_align_center">0.49 / 0.86</td>
<td id="S4.SS2.tab1.1.1.11.10.4" class="ltx_td ltx_align_center">0.39 / <span id="S4.SS2.tab1.1.1.11.10.4.1" class="ltx_text ltx_framed ltx_framed_underline">0.63</span>
</td>
<td id="S4.SS2.tab1.1.1.11.10.5" class="ltx_td ltx_align_center">
<span id="S4.SS2.tab1.1.1.11.10.5.1" class="ltx_text ltx_font_bold">0.47</span> / <span id="S4.SS2.tab1.1.1.11.10.5.2" class="ltx_text ltx_framed ltx_framed_underline">0.76</span>
</td>
</tr>
<tr id="S4.SS2.tab1.1.1.12.11" class="ltx_tr">
<th id="S4.SS2.tab1.1.1.12.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">ALIKE</th>
<td id="S4.SS2.tab1.1.1.12.11.2" class="ltx_td ltx_align_center">0.41 / 0.62</td>
<td id="S4.SS2.tab1.1.1.12.11.3" class="ltx_td ltx_align_center">
<span id="S4.SS2.tab1.1.1.12.11.3.1" class="ltx_text ltx_framed ltx_framed_underline">0.50</span> / 0.79</td>
<td id="S4.SS2.tab1.1.1.12.11.4" class="ltx_td ltx_align_center">0.29 / 0.45</td>
<td id="S4.SS2.tab1.1.1.12.11.5" class="ltx_td ltx_align_center">0.40 / 0.60</td>
</tr>
<tr id="S4.SS2.tab1.1.1.13.12" class="ltx_tr">
<th id="S4.SS2.tab1.1.1.13.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">SuperPoint</th>
<td id="S4.SS2.tab1.1.1.13.12.2" class="ltx_td ltx_align_center">0.43 / 0.73</td>
<td id="S4.SS2.tab1.1.1.13.12.3" class="ltx_td ltx_align_center">
<span id="S4.SS2.tab1.1.1.13.12.3.1" class="ltx_text ltx_font_bold">0.53</span> / 0.85</td>
<td id="S4.SS2.tab1.1.1.13.12.4" class="ltx_td ltx_align_center">
<span id="S4.SS2.tab1.1.1.13.12.4.1" class="ltx_text ltx_framed ltx_framed_underline">0.33</span> / 0.59</td>
<td id="S4.SS2.tab1.1.1.13.12.5" class="ltx_td ltx_align_center">0.43 / 0.72</td>
</tr>
<tr id="S4.SS2.tab1.1.1.14.13" class="ltx_tr">
<th id="S4.SS2.tab1.1.1.14.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">
<span id="S4.SS2.tab1.1.1.14.13.1.1" class="ltx_ERROR undefined">\hdashline</span>
Ours [SP]</th>
<td id="S4.SS2.tab1.1.1.14.13.2" class="ltx_td ltx_align_center ltx_border_bb">0.33 / 0.78</td>
<td id="S4.SS2.tab1.1.1.14.13.3" class="ltx_td ltx_align_center ltx_border_bb">0.45 / <span id="S4.SS2.tab1.1.1.14.13.3.1" class="ltx_text ltx_font_bold">0.88</span>
</td>
<td id="S4.SS2.tab1.1.1.14.13.4" class="ltx_td ltx_align_center ltx_border_bb">0.21 / <span id="S4.SS2.tab1.1.1.14.13.4.1" class="ltx_text ltx_font_bold">0.67</span>
</td>
<td id="S4.SS2.tab1.1.1.14.13.5" class="ltx_td ltx_align_center ltx_border_bb">0.33 / <span id="S4.SS2.tab1.1.1.14.13.5.1" class="ltx_text ltx_font_bold">0.78</span>
</td>
</tr>
</tbody>
</table>
</span></div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="S4.SS2.tab1.2" class="ltx_p ltx_figure_panel">Tables <a href="#S4" title="4 Experiments and results ‣ Improving the matching of deformable objects by learning to detect keypoints" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> and <a href="#S4.SS2" title="4.2 Results on sequences of deformable objects ‣ 4.1 Metrics and baselines ‣ 4 Experiments and results ‣ Improving the matching of deformable objects by learning to detect keypoints" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a> show that the ALIKE descriptor has a small advantage in matching scores in some cases due to the reduced number of keypoints (approximately 100 detected keypoints less on average), but is inferior in matching accuracy for all experiments. Also our approach is superior to DISK in MMA in almost all experiments, while having a competitive performance in Matching Scores.
Despite SEKD and GLAM not detecting enough instances (averaging 121 and 235, respectively), we computed their MMA, MMS, and RR metrics using the nonrigid descriptor DEAL. For the sake of fairness, we also lowered the number of maximum de- tections of our method to match each competitor. Com- paring Ours versus SEKD, on average, SEKD scored 0.51, 0.43, and 0.80 in RR, MMS, and MMA, respectively, while Our detector scored 0.44, 0.36, and 0.78. Comparing Ours versus GLAM, on average, GLAM scored 0.51, 0.42, 0.79 in RR, MMS, and MMA, respectively, while our detector scored 0.47, 0.40, and 0.80. It is worth mentioning that experiments with a small number of keypoints can result in misleading results as shown by Mikolajczyk <span id="S4.SS2.tab1.2.1" class="ltx_text ltx_font_italic">et al</span>.<span id="S4.SS2.tab1.2.2" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<section id="S4.SS3" class="ltx_subsection ltx_figure_panel">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Results on the application of object retrieval</h3>

<figure id="S4.SS3.2" class="ltx_table">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span><span id="S4.SS3.2.4.1" class="ltx_text ltx_font_bold">Ablation study.</span> Comparing MS, MMA, and Mean RR for different architecture choices.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="S4.SS3.2.5" class="ltx_inline-block ltx_figure_panel ltx_transformed_outer" style="width:216.8pt;height:82.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-88.6pt,33.9pt) scale(0.550394200634124,0.550394200634124) ;">
<table id="S4.SS3.2.5.1" class="ltx_tabular ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.SS3.2.5.1.1.1" class="ltx_tr">
<td id="S4.SS3.2.5.1.1.1.1" class="ltx_td ltx_align_center" colspan="5">Dataset 770 pairs total - MS / MMA@3 / MRR pixels</td>
</tr>
<tr id="S4.SS3.2.5.1.2.2" class="ltx_tr">
<td id="S4.SS3.2.5.1.2.2.1" class="ltx_td ltx_align_left ltx_border_t">Our Detector</td>
<td id="S4.SS3.2.5.1.2.2.2" class="ltx_td ltx_align_left ltx_border_t">Kinect1</td>
<td id="S4.SS3.2.5.1.2.2.3" class="ltx_td ltx_align_left ltx_border_t">Kinect2</td>
<td id="S4.SS3.2.5.1.2.2.4" class="ltx_td ltx_align_left ltx_border_t">DeSurT</td>
<td id="S4.SS3.2.5.1.2.2.5" class="ltx_td ltx_align_left ltx_border_t">Mean</td>
</tr>
<tr id="S4.SS3.2.5.1.3.3" class="ltx_tr">
<td id="S4.SS3.2.5.1.3.3.1" class="ltx_td ltx_align_left ltx_border_t">Enc. DCN</td>
<td id="S4.SS3.2.5.1.3.3.2" class="ltx_td ltx_align_left ltx_border_t">0.21/0.67/0.22</td>
<td id="S4.SS3.2.5.1.3.3.3" class="ltx_td ltx_align_left ltx_border_t">
<span id="S4.SS3.2.5.1.3.3.3.1" class="ltx_text ltx_framed ltx_framed_underline">0.41</span>/<span id="S4.SS3.2.5.1.3.3.3.2" class="ltx_text ltx_framed ltx_framed_underline">0.93</span>/<span id="S4.SS3.2.5.1.3.3.3.3" class="ltx_text ltx_framed ltx_framed_underline">0.43</span>
</td>
<td id="S4.SS3.2.5.1.3.3.4" class="ltx_td ltx_align_left ltx_border_t">0.21/0.52/0.37</td>
<td id="S4.SS3.2.5.1.3.3.5" class="ltx_td ltx_align_left ltx_border_t">0.27/0.70/0.42</td>
</tr>
<tr id="S4.SS3.2.5.1.4.4" class="ltx_tr">
<td id="S4.SS3.2.5.1.4.4.1" class="ltx_td ltx_align_left">Dec. DCN</td>
<td id="S4.SS3.2.5.1.4.4.2" class="ltx_td ltx_align_left">0.44/0.82/0.48</td>
<td id="S4.SS3.2.5.1.4.4.3" class="ltx_td ltx_align_left">0.37/0.92/0.40</td>
<td id="S4.SS3.2.5.1.4.4.4" class="ltx_td ltx_align_left">0.29/0.64/0.26</td>
<td id="S4.SS3.2.5.1.4.4.5" class="ltx_td ltx_align_left">0.37/0.79/0.30</td>
</tr>
<tr id="S4.SS3.2.5.1.5.5" class="ltx_tr">
<td id="S4.SS3.2.5.1.5.5.1" class="ltx_td ltx_align_left">All DCN</td>
<td id="S4.SS3.2.5.1.5.5.2" class="ltx_td ltx_align_left">
<span id="S4.SS3.2.5.1.5.5.2.1" class="ltx_text ltx_framed ltx_framed_underline">0.48</span>/<span id="S4.SS3.2.5.1.5.5.2.2" class="ltx_text ltx_font_bold">0.92</span>/<span id="S4.SS3.2.5.1.5.5.2.3" class="ltx_text ltx_framed ltx_framed_underline">0.52</span>
</td>
<td id="S4.SS3.2.5.1.5.5.3" class="ltx_td ltx_align_left">0.3/<span id="S4.SS3.2.5.1.5.5.3.1" class="ltx_text ltx_font_bold">0.94</span>/0.31</td>
<td id="S4.SS3.2.5.1.5.5.4" class="ltx_td ltx_align_left">
<span id="S4.SS3.2.5.1.5.5.4.1" class="ltx_text ltx_font_bold">0.36</span>/<span id="S4.SS3.2.5.1.5.5.4.2" class="ltx_text ltx_font_bold">0.68</span>/<span id="S4.SS3.2.5.1.5.5.4.3" class="ltx_text ltx_font_bold">0.46</span>
</td>
<td id="S4.SS3.2.5.1.5.5.5" class="ltx_td ltx_align_left">
<span id="S4.SS3.2.5.1.5.5.5.1" class="ltx_text ltx_framed ltx_framed_underline">0.38</span>/<span id="S4.SS3.2.5.1.5.5.5.2" class="ltx_text ltx_font_bold">0.84</span>/<span id="S4.SS3.2.5.1.5.5.5.3" class="ltx_text ltx_framed ltx_framed_underline">0.43</span>
</td>
</tr>
<tr id="S4.SS3.2.5.1.6.6" class="ltx_tr">
<td id="S4.SS3.2.5.1.6.6.1" class="ltx_td ltx_align_left">Single Branch</td>
<td id="S4.SS3.2.5.1.6.6.2" class="ltx_td ltx_align_left">0.43/<span id="S4.SS3.2.5.1.6.6.2.1" class="ltx_text ltx_framed ltx_framed_underline">0.88</span>/0.48</td>
<td id="S4.SS3.2.5.1.6.6.3" class="ltx_td ltx_align_left">0.26/0.92/0.28</td>
<td id="S4.SS3.2.5.1.6.6.4" class="ltx_td ltx_align_left">0.22/0.6/0.30</td>
<td id="S4.SS3.2.5.1.6.6.5" class="ltx_td ltx_align_left">0.3/<span id="S4.SS3.2.5.1.6.6.5.1" class="ltx_text ltx_framed ltx_framed_underline">0.82</span>/0.35</td>
</tr>
<tr id="S4.SS3.2.5.1.7.7" class="ltx_tr">
<td id="S4.SS3.2.5.1.7.7.1" class="ltx_td ltx_align_left">Only Homography</td>
<td id="S4.SS3.2.5.1.7.7.2" class="ltx_td ltx_align_left">0.37/0.86/0.43</td>
<td id="S4.SS3.2.5.1.7.7.3" class="ltx_td ltx_align_left">0.24/<span id="S4.SS3.2.5.1.7.7.3.1" class="ltx_text ltx_framed ltx_framed_underline">0.93</span>/0.25</td>
<td id="S4.SS3.2.5.1.7.7.4" class="ltx_td ltx_align_left">0.26/0.64/0.37</td>
<td id="S4.SS3.2.5.1.7.7.5" class="ltx_td ltx_align_left">0.29/0.81/0.35</td>
</tr>
<tr id="S4.SS3.2.5.1.8.8" class="ltx_tr">
<td id="S4.SS3.2.5.1.8.8.1" class="ltx_td ltx_align_left ltx_border_bb">
<span id="S4.SS3.2.5.1.8.8.1.1" class="ltx_ERROR undefined">\hdashline</span>
Ours</td>
<td id="S4.SS3.2.5.1.8.8.2" class="ltx_td ltx_align_left ltx_border_bb">
<span id="S4.SS3.2.5.1.8.8.2.1" class="ltx_text ltx_font_bold">0.49</span>/0.86/<span id="S4.SS3.2.5.1.8.8.2.2" class="ltx_text ltx_font_bold">0.55</span>
</td>
<td id="S4.SS3.2.5.1.8.8.3" class="ltx_td ltx_align_left ltx_border_bb">
<span id="S4.SS3.2.5.1.8.8.3.1" class="ltx_text ltx_font_bold">0.48</span>/0.89/<span id="S4.SS3.2.5.1.8.8.3.2" class="ltx_text ltx_font_bold">0.54</span>
</td>
<td id="S4.SS3.2.5.1.8.8.4" class="ltx_td ltx_align_left ltx_border_bb">
<span id="S4.SS3.2.5.1.8.8.4.1" class="ltx_text ltx_framed ltx_framed_underline">0.31</span>/<span id="S4.SS3.2.5.1.8.8.4.2" class="ltx_text ltx_framed ltx_framed_underline">0.66</span>/<span id="S4.SS3.2.5.1.8.8.4.3" class="ltx_text ltx_framed ltx_framed_underline">0.42</span>
</td>
<td id="S4.SS3.2.5.1.8.8.5" class="ltx_td ltx_align_left ltx_border_bb">
<span id="S4.SS3.2.5.1.8.8.5.1" class="ltx_text ltx_font_bold">0.43</span>/0.80/<span id="S4.SS3.2.5.1.8.8.5.2" class="ltx_text ltx_font_bold">0.51</span>
</td>
</tr>
</tbody>
</table>
</span></div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="S4.SS3.2.2" class="ltx_p ltx_figure_panel">To further demonstrate the efficacy of our detector in real-world applications, we conducted experiments on a content-based object retrieval task. The goal is to return the top K images corresponding to a given query. We represent each image using a Bag-of-Visual-Words method. The DEAL descriptor <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> was used to create a visual dictionary for each keypoint, which is then used to generate a global descriptor for each image. We determine the global descriptor for a given query image and employ the K-Nearest Neighbor search to identify the top K closest objects. To assess the effectiveness of the detectors, we use retrieval accuracy@K, <span id="S4.SS3.2.2.1" class="ltx_text ltx_font_italic">i.e</span>.<span id="S4.SS3.2.2.2" class="ltx_text"></span>, the number of accurate objects recovered in the top K images. We only employ a descriptor that models isometric deformations because the application’s database is deformable. The retrieval accuracy for SIFT, ASLFeat, and Ours at <math id="S4.SS3.1.1.m1.1" class="ltx_Math" alttext="K=20" display="inline"><semantics id="S4.SS3.1.1.m1.1a"><mrow id="S4.SS3.1.1.m1.1.1" xref="S4.SS3.1.1.m1.1.1.cmml"><mi id="S4.SS3.1.1.m1.1.1.2" xref="S4.SS3.1.1.m1.1.1.2.cmml">K</mi><mo id="S4.SS3.1.1.m1.1.1.1" xref="S4.SS3.1.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS3.1.1.m1.1.1.3" xref="S4.SS3.1.1.m1.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.1.1.m1.1b"><apply id="S4.SS3.1.1.m1.1.1.cmml" xref="S4.SS3.1.1.m1.1.1"><eq id="S4.SS3.1.1.m1.1.1.1.cmml" xref="S4.SS3.1.1.m1.1.1.1"></eq><ci id="S4.SS3.1.1.m1.1.1.2.cmml" xref="S4.SS3.1.1.m1.1.1.2">𝐾</ci><cn type="integer" id="S4.SS3.1.1.m1.1.1.3.cmml" xref="S4.SS3.1.1.m1.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.1.1.m1.1c">K=20</annotation></semantics></math> achieved <math id="S4.SS3.2.2.m2.1" class="ltx_Math" alttext="100\%" display="inline"><semantics id="S4.SS3.2.2.m2.1a"><mrow id="S4.SS3.2.2.m2.1.1" xref="S4.SS3.2.2.m2.1.1.cmml"><mn id="S4.SS3.2.2.m2.1.1.2" xref="S4.SS3.2.2.m2.1.1.2.cmml">100</mn><mo id="S4.SS3.2.2.m2.1.1.1" xref="S4.SS3.2.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.2.2.m2.1b"><apply id="S4.SS3.2.2.m2.1.1.cmml" xref="S4.SS3.2.2.m2.1.1"><csymbol cd="latexml" id="S4.SS3.2.2.m2.1.1.1.cmml" xref="S4.SS3.2.2.m2.1.1.1">percent</csymbol><cn type="integer" id="S4.SS3.2.2.m2.1.1.2.cmml" xref="S4.SS3.2.2.m2.1.1.2">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.2.2.m2.1c">100\%</annotation></semantics></math>. The outcomes show that, even though our detector was trained to improve matching tasks, it can effectively select representative keypoints for non-matching challenges.</p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<section id="S4.SS4" class="ltx_subsection ltx_figure_panel">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Ablation study and sensitivity analysis</h3>

<div id="S4.SS4.p1" class="ltx_para ltx_noindent">
<p id="S4.SS4.p1.8" class="ltx_p"><span id="S4.SS4.p1.8.1" class="ltx_text ltx_font_bold">Siamese network:</span> We trained our model using two configurations for ablation studies: (i) a Siamese network scheme and (ii) a conventional network training scheme, <span id="S4.SS4.p1.8.2" class="ltx_text ltx_font_italic">i.e</span>.<span id="S4.SS4.p1.8.3" class="ltx_text"></span>, employing a single branch. According to the experiments, a Siamese scheme (i) aids the model’s ability to learn repeating keypoints. Using the Siamese method, the RR went up from <math id="S4.SS4.p1.1.m1.1" class="ltx_Math" alttext="0.35" display="inline"><semantics id="S4.SS4.p1.1.m1.1a"><mn id="S4.SS4.p1.1.m1.1.1" xref="S4.SS4.p1.1.m1.1.1.cmml">0.35</mn><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.m1.1b"><cn type="float" id="S4.SS4.p1.1.m1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1">0.35</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.m1.1c">0.35</annotation></semantics></math> to <math id="S4.SS4.p1.2.m2.1" class="ltx_Math" alttext="0.51" display="inline"><semantics id="S4.SS4.p1.2.m2.1a"><mn id="S4.SS4.p1.2.m2.1.1" xref="S4.SS4.p1.2.m2.1.1.cmml">0.51</mn><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.2.m2.1b"><cn type="float" id="S4.SS4.p1.2.m2.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1">0.51</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.2.m2.1c">0.51</annotation></semantics></math>, the MS from <math id="S4.SS4.p1.3.m3.1" class="ltx_Math" alttext="0.39" display="inline"><semantics id="S4.SS4.p1.3.m3.1a"><mn id="S4.SS4.p1.3.m3.1.1" xref="S4.SS4.p1.3.m3.1.1.cmml">0.39</mn><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.3.m3.1b"><cn type="float" id="S4.SS4.p1.3.m3.1.1.cmml" xref="S4.SS4.p1.3.m3.1.1">0.39</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.3.m3.1c">0.39</annotation></semantics></math> to <math id="S4.SS4.p1.4.m4.1" class="ltx_Math" alttext="0.43" display="inline"><semantics id="S4.SS4.p1.4.m4.1a"><mn id="S4.SS4.p1.4.m4.1.1" xref="S4.SS4.p1.4.m4.1.1.cmml">0.43</mn><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.4.m4.1b"><cn type="float" id="S4.SS4.p1.4.m4.1.1.cmml" xref="S4.SS4.p1.4.m4.1.1">0.43</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.4.m4.1c">0.43</annotation></semantics></math>, and the MMA went down from <math id="S4.SS4.p1.5.m5.1" class="ltx_Math" alttext="0.81" display="inline"><semantics id="S4.SS4.p1.5.m5.1a"><mn id="S4.SS4.p1.5.m5.1.1" xref="S4.SS4.p1.5.m5.1.1.cmml">0.81</mn><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.5.m5.1b"><cn type="float" id="S4.SS4.p1.5.m5.1.1.cmml" xref="S4.SS4.p1.5.m5.1.1">0.81</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.5.m5.1c">0.81</annotation></semantics></math> to <math id="S4.SS4.p1.6.m6.1" class="ltx_Math" alttext="0.80" display="inline"><semantics id="S4.SS4.p1.6.m6.1a"><mn id="S4.SS4.p1.6.m6.1.1" xref="S4.SS4.p1.6.m6.1.1.cmml">0.80</mn><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.6.m6.1b"><cn type="float" id="S4.SS4.p1.6.m6.1.1.cmml" xref="S4.SS4.p1.6.m6.1.1">0.80</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.6.m6.1c">0.80</annotation></semantics></math>; nevertheless, the inliers dramatically increased from <math id="S4.SS4.p1.7.m7.1" class="ltx_Math" alttext="150" display="inline"><semantics id="S4.SS4.p1.7.m7.1a"><mn id="S4.SS4.p1.7.m7.1.1" xref="S4.SS4.p1.7.m7.1.1.cmml">150</mn><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.7.m7.1b"><cn type="integer" id="S4.SS4.p1.7.m7.1.1.cmml" xref="S4.SS4.p1.7.m7.1.1">150</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.7.m7.1c">150</annotation></semantics></math> to <math id="S4.SS4.p1.8.m8.1" class="ltx_Math" alttext="170" display="inline"><semantics id="S4.SS4.p1.8.m8.1a"><mn id="S4.SS4.p1.8.m8.1.1" xref="S4.SS4.p1.8.m8.1.1.cmml">170</mn><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.8.m8.1b"><cn type="integer" id="S4.SS4.p1.8.m8.1.1.cmml" xref="S4.SS4.p1.8.m8.1.1">170</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.8.m8.1c">170</annotation></semantics></math>.</p>
</div>
<div id="S4.SS4.p2" class="ltx_para ltx_noindent">
<p id="S4.SS4.p2.1" class="ltx_p"><span id="S4.SS4.p2.1.1" class="ltx_text ltx_font_bold">Deformable convolutions:</span> We also evaluated the contribution of adopting Deformable Convolutional layers (DCNs) in the network model of our detector with four configurations: (i) using DCNs at the decoder (dec.), (ii) using DCNs at the encoder (enc.), (iii) using DCNs in both the encoder and decoder, and (iv) using conventional convolution layers. We can see in the results of Table <a href="#S4.SS3" title="4.3 Results on the application of object retrieval ‣ 4.2 Results on sequences of deformable objects ‣ 4.1 Metrics and baselines ‣ 4 Experiments and results ‣ Improving the matching of deformable objects by learning to detect keypoints" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.3</span></a> the adopted full CNN model achieved, on average, the best matching score and repeatability rate while maintaining a consistently high, and second best, matching accuracy.
Since DCN layers have considerably more learnable parameters, they introduce a bigger domain gap between the synthetic training data and the real-world deformable objects on the benchmark datasets.</p>
</div>
<div id="S4.SS4.p3" class="ltx_para ltx_noindent">
<p id="S4.SS4.p3.1" class="ltx_p"><span id="S4.SS4.p3.1.1" class="ltx_text ltx_font_bold">TPS deformations:</span> We trained our model with only homography changes to evaluate the effect of using TPS on top of homography to generate the dataset. As shown in table <a href="#S4.SS3" title="4.3 Results on the application of object retrieval ‣ 4.2 Results on sequences of deformable objects ‣ 4.1 Metrics and baselines ‣ 4 Experiments and results ‣ Improving the matching of deformable objects by learning to detect keypoints" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.3</span></a>, the use of TPS deformations improved every metric on all datasets, showing that this transformation is much more representative of real nonrigid objects than simply homography.</p>
</div>
<figure id="S4.T4" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Ablation study. Comparing the average MS, MMA, and Mean RR across the nonrigid evaluation dataset for different loss combinations.</figcaption>
<div id="S4.T4.6" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:199.5pt;height:102.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-22.6pt,11.6pt) scale(0.815359304477735,0.815359304477735) ;">
<table id="S4.T4.6.6" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T4.6.6.7.1" class="ltx_tr">
<th id="S4.T4.6.6.7.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="S4.T4.6.6.7.1.1.1" class="ltx_text ltx_font_bold">Loss Combination</span></th>
<th id="S4.T4.6.6.7.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">RR</th>
<th id="S4.T4.6.6.7.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">MMS</th>
<th id="S4.T4.6.6.7.1.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">MMA@3</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T4.1.1.1" class="ltx_tr">
<td id="S4.T4.1.1.1.1" class="ltx_td ltx_align_left ltx_border_t">(i)    <math id="S4.T4.1.1.1.1.m1.1" class="ltx_Math" alttext="L_{cossim}+L_{simple}+L_{peak}" display="inline"><semantics id="S4.T4.1.1.1.1.m1.1a"><mrow id="S4.T4.1.1.1.1.m1.1.1" xref="S4.T4.1.1.1.1.m1.1.1.cmml"><msub id="S4.T4.1.1.1.1.m1.1.1.2" xref="S4.T4.1.1.1.1.m1.1.1.2.cmml"><mi id="S4.T4.1.1.1.1.m1.1.1.2.2" xref="S4.T4.1.1.1.1.m1.1.1.2.2.cmml">L</mi><mrow id="S4.T4.1.1.1.1.m1.1.1.2.3" xref="S4.T4.1.1.1.1.m1.1.1.2.3.cmml"><mi id="S4.T4.1.1.1.1.m1.1.1.2.3.2" xref="S4.T4.1.1.1.1.m1.1.1.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.T4.1.1.1.1.m1.1.1.2.3.1" xref="S4.T4.1.1.1.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T4.1.1.1.1.m1.1.1.2.3.3" xref="S4.T4.1.1.1.1.m1.1.1.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.T4.1.1.1.1.m1.1.1.2.3.1a" xref="S4.T4.1.1.1.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T4.1.1.1.1.m1.1.1.2.3.4" xref="S4.T4.1.1.1.1.m1.1.1.2.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.T4.1.1.1.1.m1.1.1.2.3.1b" xref="S4.T4.1.1.1.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T4.1.1.1.1.m1.1.1.2.3.5" xref="S4.T4.1.1.1.1.m1.1.1.2.3.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.T4.1.1.1.1.m1.1.1.2.3.1c" xref="S4.T4.1.1.1.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T4.1.1.1.1.m1.1.1.2.3.6" xref="S4.T4.1.1.1.1.m1.1.1.2.3.6.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.T4.1.1.1.1.m1.1.1.2.3.1d" xref="S4.T4.1.1.1.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T4.1.1.1.1.m1.1.1.2.3.7" xref="S4.T4.1.1.1.1.m1.1.1.2.3.7.cmml">m</mi></mrow></msub><mo id="S4.T4.1.1.1.1.m1.1.1.1" xref="S4.T4.1.1.1.1.m1.1.1.1.cmml">+</mo><msub id="S4.T4.1.1.1.1.m1.1.1.3" xref="S4.T4.1.1.1.1.m1.1.1.3.cmml"><mi id="S4.T4.1.1.1.1.m1.1.1.3.2" xref="S4.T4.1.1.1.1.m1.1.1.3.2.cmml">L</mi><mrow id="S4.T4.1.1.1.1.m1.1.1.3.3" xref="S4.T4.1.1.1.1.m1.1.1.3.3.cmml"><mi id="S4.T4.1.1.1.1.m1.1.1.3.3.2" xref="S4.T4.1.1.1.1.m1.1.1.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.T4.1.1.1.1.m1.1.1.3.3.1" xref="S4.T4.1.1.1.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S4.T4.1.1.1.1.m1.1.1.3.3.3" xref="S4.T4.1.1.1.1.m1.1.1.3.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.T4.1.1.1.1.m1.1.1.3.3.1a" xref="S4.T4.1.1.1.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S4.T4.1.1.1.1.m1.1.1.3.3.4" xref="S4.T4.1.1.1.1.m1.1.1.3.3.4.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.T4.1.1.1.1.m1.1.1.3.3.1b" xref="S4.T4.1.1.1.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S4.T4.1.1.1.1.m1.1.1.3.3.5" xref="S4.T4.1.1.1.1.m1.1.1.3.3.5.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.T4.1.1.1.1.m1.1.1.3.3.1c" xref="S4.T4.1.1.1.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S4.T4.1.1.1.1.m1.1.1.3.3.6" xref="S4.T4.1.1.1.1.m1.1.1.3.3.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="S4.T4.1.1.1.1.m1.1.1.3.3.1d" xref="S4.T4.1.1.1.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S4.T4.1.1.1.1.m1.1.1.3.3.7" xref="S4.T4.1.1.1.1.m1.1.1.3.3.7.cmml">e</mi></mrow></msub><mo id="S4.T4.1.1.1.1.m1.1.1.1a" xref="S4.T4.1.1.1.1.m1.1.1.1.cmml">+</mo><msub id="S4.T4.1.1.1.1.m1.1.1.4" xref="S4.T4.1.1.1.1.m1.1.1.4.cmml"><mi id="S4.T4.1.1.1.1.m1.1.1.4.2" xref="S4.T4.1.1.1.1.m1.1.1.4.2.cmml">L</mi><mrow id="S4.T4.1.1.1.1.m1.1.1.4.3" xref="S4.T4.1.1.1.1.m1.1.1.4.3.cmml"><mi id="S4.T4.1.1.1.1.m1.1.1.4.3.2" xref="S4.T4.1.1.1.1.m1.1.1.4.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.T4.1.1.1.1.m1.1.1.4.3.1" xref="S4.T4.1.1.1.1.m1.1.1.4.3.1.cmml">​</mo><mi id="S4.T4.1.1.1.1.m1.1.1.4.3.3" xref="S4.T4.1.1.1.1.m1.1.1.4.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.T4.1.1.1.1.m1.1.1.4.3.1a" xref="S4.T4.1.1.1.1.m1.1.1.4.3.1.cmml">​</mo><mi id="S4.T4.1.1.1.1.m1.1.1.4.3.4" xref="S4.T4.1.1.1.1.m1.1.1.4.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.T4.1.1.1.1.m1.1.1.4.3.1b" xref="S4.T4.1.1.1.1.m1.1.1.4.3.1.cmml">​</mo><mi id="S4.T4.1.1.1.1.m1.1.1.4.3.5" xref="S4.T4.1.1.1.1.m1.1.1.4.3.5.cmml">k</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.1.1.1.1.m1.1b"><apply id="S4.T4.1.1.1.1.m1.1.1.cmml" xref="S4.T4.1.1.1.1.m1.1.1"><plus id="S4.T4.1.1.1.1.m1.1.1.1.cmml" xref="S4.T4.1.1.1.1.m1.1.1.1"></plus><apply id="S4.T4.1.1.1.1.m1.1.1.2.cmml" xref="S4.T4.1.1.1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.T4.1.1.1.1.m1.1.1.2.1.cmml" xref="S4.T4.1.1.1.1.m1.1.1.2">subscript</csymbol><ci id="S4.T4.1.1.1.1.m1.1.1.2.2.cmml" xref="S4.T4.1.1.1.1.m1.1.1.2.2">𝐿</ci><apply id="S4.T4.1.1.1.1.m1.1.1.2.3.cmml" xref="S4.T4.1.1.1.1.m1.1.1.2.3"><times id="S4.T4.1.1.1.1.m1.1.1.2.3.1.cmml" xref="S4.T4.1.1.1.1.m1.1.1.2.3.1"></times><ci id="S4.T4.1.1.1.1.m1.1.1.2.3.2.cmml" xref="S4.T4.1.1.1.1.m1.1.1.2.3.2">𝑐</ci><ci id="S4.T4.1.1.1.1.m1.1.1.2.3.3.cmml" xref="S4.T4.1.1.1.1.m1.1.1.2.3.3">𝑜</ci><ci id="S4.T4.1.1.1.1.m1.1.1.2.3.4.cmml" xref="S4.T4.1.1.1.1.m1.1.1.2.3.4">𝑠</ci><ci id="S4.T4.1.1.1.1.m1.1.1.2.3.5.cmml" xref="S4.T4.1.1.1.1.m1.1.1.2.3.5">𝑠</ci><ci id="S4.T4.1.1.1.1.m1.1.1.2.3.6.cmml" xref="S4.T4.1.1.1.1.m1.1.1.2.3.6">𝑖</ci><ci id="S4.T4.1.1.1.1.m1.1.1.2.3.7.cmml" xref="S4.T4.1.1.1.1.m1.1.1.2.3.7">𝑚</ci></apply></apply><apply id="S4.T4.1.1.1.1.m1.1.1.3.cmml" xref="S4.T4.1.1.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T4.1.1.1.1.m1.1.1.3.1.cmml" xref="S4.T4.1.1.1.1.m1.1.1.3">subscript</csymbol><ci id="S4.T4.1.1.1.1.m1.1.1.3.2.cmml" xref="S4.T4.1.1.1.1.m1.1.1.3.2">𝐿</ci><apply id="S4.T4.1.1.1.1.m1.1.1.3.3.cmml" xref="S4.T4.1.1.1.1.m1.1.1.3.3"><times id="S4.T4.1.1.1.1.m1.1.1.3.3.1.cmml" xref="S4.T4.1.1.1.1.m1.1.1.3.3.1"></times><ci id="S4.T4.1.1.1.1.m1.1.1.3.3.2.cmml" xref="S4.T4.1.1.1.1.m1.1.1.3.3.2">𝑠</ci><ci id="S4.T4.1.1.1.1.m1.1.1.3.3.3.cmml" xref="S4.T4.1.1.1.1.m1.1.1.3.3.3">𝑖</ci><ci id="S4.T4.1.1.1.1.m1.1.1.3.3.4.cmml" xref="S4.T4.1.1.1.1.m1.1.1.3.3.4">𝑚</ci><ci id="S4.T4.1.1.1.1.m1.1.1.3.3.5.cmml" xref="S4.T4.1.1.1.1.m1.1.1.3.3.5">𝑝</ci><ci id="S4.T4.1.1.1.1.m1.1.1.3.3.6.cmml" xref="S4.T4.1.1.1.1.m1.1.1.3.3.6">𝑙</ci><ci id="S4.T4.1.1.1.1.m1.1.1.3.3.7.cmml" xref="S4.T4.1.1.1.1.m1.1.1.3.3.7">𝑒</ci></apply></apply><apply id="S4.T4.1.1.1.1.m1.1.1.4.cmml" xref="S4.T4.1.1.1.1.m1.1.1.4"><csymbol cd="ambiguous" id="S4.T4.1.1.1.1.m1.1.1.4.1.cmml" xref="S4.T4.1.1.1.1.m1.1.1.4">subscript</csymbol><ci id="S4.T4.1.1.1.1.m1.1.1.4.2.cmml" xref="S4.T4.1.1.1.1.m1.1.1.4.2">𝐿</ci><apply id="S4.T4.1.1.1.1.m1.1.1.4.3.cmml" xref="S4.T4.1.1.1.1.m1.1.1.4.3"><times id="S4.T4.1.1.1.1.m1.1.1.4.3.1.cmml" xref="S4.T4.1.1.1.1.m1.1.1.4.3.1"></times><ci id="S4.T4.1.1.1.1.m1.1.1.4.3.2.cmml" xref="S4.T4.1.1.1.1.m1.1.1.4.3.2">𝑝</ci><ci id="S4.T4.1.1.1.1.m1.1.1.4.3.3.cmml" xref="S4.T4.1.1.1.1.m1.1.1.4.3.3">𝑒</ci><ci id="S4.T4.1.1.1.1.m1.1.1.4.3.4.cmml" xref="S4.T4.1.1.1.1.m1.1.1.4.3.4">𝑎</ci><ci id="S4.T4.1.1.1.1.m1.1.1.4.3.5.cmml" xref="S4.T4.1.1.1.1.m1.1.1.4.3.5">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.1.1.1.1.m1.1c">L_{cossim}+L_{simple}+L_{peak}</annotation></semantics></math>
</td>
<td id="S4.T4.1.1.1.2" class="ltx_td ltx_align_left ltx_border_t">0.50</td>
<td id="S4.T4.1.1.1.3" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T4.1.1.1.3.1" class="ltx_text ltx_font_bold">0.43</span></td>
<td id="S4.T4.1.1.1.4" class="ltx_td ltx_align_left ltx_border_t">0.81</td>
</tr>
<tr id="S4.T4.2.2.2" class="ltx_tr">
<td id="S4.T4.2.2.2.1" class="ltx_td ltx_align_left">(ii)  <math id="S4.T4.2.2.2.1.m1.1" class="ltx_Math" alttext="L_{cossim}+L_{simple}" display="inline"><semantics id="S4.T4.2.2.2.1.m1.1a"><mrow id="S4.T4.2.2.2.1.m1.1.1" xref="S4.T4.2.2.2.1.m1.1.1.cmml"><msub id="S4.T4.2.2.2.1.m1.1.1.2" xref="S4.T4.2.2.2.1.m1.1.1.2.cmml"><mi id="S4.T4.2.2.2.1.m1.1.1.2.2" xref="S4.T4.2.2.2.1.m1.1.1.2.2.cmml">L</mi><mrow id="S4.T4.2.2.2.1.m1.1.1.2.3" xref="S4.T4.2.2.2.1.m1.1.1.2.3.cmml"><mi id="S4.T4.2.2.2.1.m1.1.1.2.3.2" xref="S4.T4.2.2.2.1.m1.1.1.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.T4.2.2.2.1.m1.1.1.2.3.1" xref="S4.T4.2.2.2.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T4.2.2.2.1.m1.1.1.2.3.3" xref="S4.T4.2.2.2.1.m1.1.1.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.T4.2.2.2.1.m1.1.1.2.3.1a" xref="S4.T4.2.2.2.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T4.2.2.2.1.m1.1.1.2.3.4" xref="S4.T4.2.2.2.1.m1.1.1.2.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.T4.2.2.2.1.m1.1.1.2.3.1b" xref="S4.T4.2.2.2.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T4.2.2.2.1.m1.1.1.2.3.5" xref="S4.T4.2.2.2.1.m1.1.1.2.3.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.T4.2.2.2.1.m1.1.1.2.3.1c" xref="S4.T4.2.2.2.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T4.2.2.2.1.m1.1.1.2.3.6" xref="S4.T4.2.2.2.1.m1.1.1.2.3.6.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.T4.2.2.2.1.m1.1.1.2.3.1d" xref="S4.T4.2.2.2.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T4.2.2.2.1.m1.1.1.2.3.7" xref="S4.T4.2.2.2.1.m1.1.1.2.3.7.cmml">m</mi></mrow></msub><mo id="S4.T4.2.2.2.1.m1.1.1.1" xref="S4.T4.2.2.2.1.m1.1.1.1.cmml">+</mo><msub id="S4.T4.2.2.2.1.m1.1.1.3" xref="S4.T4.2.2.2.1.m1.1.1.3.cmml"><mi id="S4.T4.2.2.2.1.m1.1.1.3.2" xref="S4.T4.2.2.2.1.m1.1.1.3.2.cmml">L</mi><mrow id="S4.T4.2.2.2.1.m1.1.1.3.3" xref="S4.T4.2.2.2.1.m1.1.1.3.3.cmml"><mi id="S4.T4.2.2.2.1.m1.1.1.3.3.2" xref="S4.T4.2.2.2.1.m1.1.1.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.T4.2.2.2.1.m1.1.1.3.3.1" xref="S4.T4.2.2.2.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S4.T4.2.2.2.1.m1.1.1.3.3.3" xref="S4.T4.2.2.2.1.m1.1.1.3.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.T4.2.2.2.1.m1.1.1.3.3.1a" xref="S4.T4.2.2.2.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S4.T4.2.2.2.1.m1.1.1.3.3.4" xref="S4.T4.2.2.2.1.m1.1.1.3.3.4.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.T4.2.2.2.1.m1.1.1.3.3.1b" xref="S4.T4.2.2.2.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S4.T4.2.2.2.1.m1.1.1.3.3.5" xref="S4.T4.2.2.2.1.m1.1.1.3.3.5.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.T4.2.2.2.1.m1.1.1.3.3.1c" xref="S4.T4.2.2.2.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S4.T4.2.2.2.1.m1.1.1.3.3.6" xref="S4.T4.2.2.2.1.m1.1.1.3.3.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="S4.T4.2.2.2.1.m1.1.1.3.3.1d" xref="S4.T4.2.2.2.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S4.T4.2.2.2.1.m1.1.1.3.3.7" xref="S4.T4.2.2.2.1.m1.1.1.3.3.7.cmml">e</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.2.2.2.1.m1.1b"><apply id="S4.T4.2.2.2.1.m1.1.1.cmml" xref="S4.T4.2.2.2.1.m1.1.1"><plus id="S4.T4.2.2.2.1.m1.1.1.1.cmml" xref="S4.T4.2.2.2.1.m1.1.1.1"></plus><apply id="S4.T4.2.2.2.1.m1.1.1.2.cmml" xref="S4.T4.2.2.2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.T4.2.2.2.1.m1.1.1.2.1.cmml" xref="S4.T4.2.2.2.1.m1.1.1.2">subscript</csymbol><ci id="S4.T4.2.2.2.1.m1.1.1.2.2.cmml" xref="S4.T4.2.2.2.1.m1.1.1.2.2">𝐿</ci><apply id="S4.T4.2.2.2.1.m1.1.1.2.3.cmml" xref="S4.T4.2.2.2.1.m1.1.1.2.3"><times id="S4.T4.2.2.2.1.m1.1.1.2.3.1.cmml" xref="S4.T4.2.2.2.1.m1.1.1.2.3.1"></times><ci id="S4.T4.2.2.2.1.m1.1.1.2.3.2.cmml" xref="S4.T4.2.2.2.1.m1.1.1.2.3.2">𝑐</ci><ci id="S4.T4.2.2.2.1.m1.1.1.2.3.3.cmml" xref="S4.T4.2.2.2.1.m1.1.1.2.3.3">𝑜</ci><ci id="S4.T4.2.2.2.1.m1.1.1.2.3.4.cmml" xref="S4.T4.2.2.2.1.m1.1.1.2.3.4">𝑠</ci><ci id="S4.T4.2.2.2.1.m1.1.1.2.3.5.cmml" xref="S4.T4.2.2.2.1.m1.1.1.2.3.5">𝑠</ci><ci id="S4.T4.2.2.2.1.m1.1.1.2.3.6.cmml" xref="S4.T4.2.2.2.1.m1.1.1.2.3.6">𝑖</ci><ci id="S4.T4.2.2.2.1.m1.1.1.2.3.7.cmml" xref="S4.T4.2.2.2.1.m1.1.1.2.3.7">𝑚</ci></apply></apply><apply id="S4.T4.2.2.2.1.m1.1.1.3.cmml" xref="S4.T4.2.2.2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T4.2.2.2.1.m1.1.1.3.1.cmml" xref="S4.T4.2.2.2.1.m1.1.1.3">subscript</csymbol><ci id="S4.T4.2.2.2.1.m1.1.1.3.2.cmml" xref="S4.T4.2.2.2.1.m1.1.1.3.2">𝐿</ci><apply id="S4.T4.2.2.2.1.m1.1.1.3.3.cmml" xref="S4.T4.2.2.2.1.m1.1.1.3.3"><times id="S4.T4.2.2.2.1.m1.1.1.3.3.1.cmml" xref="S4.T4.2.2.2.1.m1.1.1.3.3.1"></times><ci id="S4.T4.2.2.2.1.m1.1.1.3.3.2.cmml" xref="S4.T4.2.2.2.1.m1.1.1.3.3.2">𝑠</ci><ci id="S4.T4.2.2.2.1.m1.1.1.3.3.3.cmml" xref="S4.T4.2.2.2.1.m1.1.1.3.3.3">𝑖</ci><ci id="S4.T4.2.2.2.1.m1.1.1.3.3.4.cmml" xref="S4.T4.2.2.2.1.m1.1.1.3.3.4">𝑚</ci><ci id="S4.T4.2.2.2.1.m1.1.1.3.3.5.cmml" xref="S4.T4.2.2.2.1.m1.1.1.3.3.5">𝑝</ci><ci id="S4.T4.2.2.2.1.m1.1.1.3.3.6.cmml" xref="S4.T4.2.2.2.1.m1.1.1.3.3.6">𝑙</ci><ci id="S4.T4.2.2.2.1.m1.1.1.3.3.7.cmml" xref="S4.T4.2.2.2.1.m1.1.1.3.3.7">𝑒</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.2.2.2.1.m1.1c">L_{cossim}+L_{simple}</annotation></semantics></math>
</td>
<td id="S4.T4.2.2.2.2" class="ltx_td ltx_align_left">0.48</td>
<td id="S4.T4.2.2.2.3" class="ltx_td ltx_align_left">0.39</td>
<td id="S4.T4.2.2.2.4" class="ltx_td ltx_align_left">0.80</td>
</tr>
<tr id="S4.T4.3.3.3" class="ltx_tr">
<td id="S4.T4.3.3.3.1" class="ltx_td ltx_align_left">(iii) <math id="S4.T4.3.3.3.1.m1.1" class="ltx_Math" alttext="L_{cossim}+L_{peak}" display="inline"><semantics id="S4.T4.3.3.3.1.m1.1a"><mrow id="S4.T4.3.3.3.1.m1.1.1" xref="S4.T4.3.3.3.1.m1.1.1.cmml"><msub id="S4.T4.3.3.3.1.m1.1.1.2" xref="S4.T4.3.3.3.1.m1.1.1.2.cmml"><mi id="S4.T4.3.3.3.1.m1.1.1.2.2" xref="S4.T4.3.3.3.1.m1.1.1.2.2.cmml">L</mi><mrow id="S4.T4.3.3.3.1.m1.1.1.2.3" xref="S4.T4.3.3.3.1.m1.1.1.2.3.cmml"><mi id="S4.T4.3.3.3.1.m1.1.1.2.3.2" xref="S4.T4.3.3.3.1.m1.1.1.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.T4.3.3.3.1.m1.1.1.2.3.1" xref="S4.T4.3.3.3.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T4.3.3.3.1.m1.1.1.2.3.3" xref="S4.T4.3.3.3.1.m1.1.1.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.T4.3.3.3.1.m1.1.1.2.3.1a" xref="S4.T4.3.3.3.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T4.3.3.3.1.m1.1.1.2.3.4" xref="S4.T4.3.3.3.1.m1.1.1.2.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.T4.3.3.3.1.m1.1.1.2.3.1b" xref="S4.T4.3.3.3.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T4.3.3.3.1.m1.1.1.2.3.5" xref="S4.T4.3.3.3.1.m1.1.1.2.3.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.T4.3.3.3.1.m1.1.1.2.3.1c" xref="S4.T4.3.3.3.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T4.3.3.3.1.m1.1.1.2.3.6" xref="S4.T4.3.3.3.1.m1.1.1.2.3.6.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.T4.3.3.3.1.m1.1.1.2.3.1d" xref="S4.T4.3.3.3.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T4.3.3.3.1.m1.1.1.2.3.7" xref="S4.T4.3.3.3.1.m1.1.1.2.3.7.cmml">m</mi></mrow></msub><mo id="S4.T4.3.3.3.1.m1.1.1.1" xref="S4.T4.3.3.3.1.m1.1.1.1.cmml">+</mo><msub id="S4.T4.3.3.3.1.m1.1.1.3" xref="S4.T4.3.3.3.1.m1.1.1.3.cmml"><mi id="S4.T4.3.3.3.1.m1.1.1.3.2" xref="S4.T4.3.3.3.1.m1.1.1.3.2.cmml">L</mi><mrow id="S4.T4.3.3.3.1.m1.1.1.3.3" xref="S4.T4.3.3.3.1.m1.1.1.3.3.cmml"><mi id="S4.T4.3.3.3.1.m1.1.1.3.3.2" xref="S4.T4.3.3.3.1.m1.1.1.3.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.T4.3.3.3.1.m1.1.1.3.3.1" xref="S4.T4.3.3.3.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S4.T4.3.3.3.1.m1.1.1.3.3.3" xref="S4.T4.3.3.3.1.m1.1.1.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.T4.3.3.3.1.m1.1.1.3.3.1a" xref="S4.T4.3.3.3.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S4.T4.3.3.3.1.m1.1.1.3.3.4" xref="S4.T4.3.3.3.1.m1.1.1.3.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.T4.3.3.3.1.m1.1.1.3.3.1b" xref="S4.T4.3.3.3.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S4.T4.3.3.3.1.m1.1.1.3.3.5" xref="S4.T4.3.3.3.1.m1.1.1.3.3.5.cmml">k</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.3.3.3.1.m1.1b"><apply id="S4.T4.3.3.3.1.m1.1.1.cmml" xref="S4.T4.3.3.3.1.m1.1.1"><plus id="S4.T4.3.3.3.1.m1.1.1.1.cmml" xref="S4.T4.3.3.3.1.m1.1.1.1"></plus><apply id="S4.T4.3.3.3.1.m1.1.1.2.cmml" xref="S4.T4.3.3.3.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.T4.3.3.3.1.m1.1.1.2.1.cmml" xref="S4.T4.3.3.3.1.m1.1.1.2">subscript</csymbol><ci id="S4.T4.3.3.3.1.m1.1.1.2.2.cmml" xref="S4.T4.3.3.3.1.m1.1.1.2.2">𝐿</ci><apply id="S4.T4.3.3.3.1.m1.1.1.2.3.cmml" xref="S4.T4.3.3.3.1.m1.1.1.2.3"><times id="S4.T4.3.3.3.1.m1.1.1.2.3.1.cmml" xref="S4.T4.3.3.3.1.m1.1.1.2.3.1"></times><ci id="S4.T4.3.3.3.1.m1.1.1.2.3.2.cmml" xref="S4.T4.3.3.3.1.m1.1.1.2.3.2">𝑐</ci><ci id="S4.T4.3.3.3.1.m1.1.1.2.3.3.cmml" xref="S4.T4.3.3.3.1.m1.1.1.2.3.3">𝑜</ci><ci id="S4.T4.3.3.3.1.m1.1.1.2.3.4.cmml" xref="S4.T4.3.3.3.1.m1.1.1.2.3.4">𝑠</ci><ci id="S4.T4.3.3.3.1.m1.1.1.2.3.5.cmml" xref="S4.T4.3.3.3.1.m1.1.1.2.3.5">𝑠</ci><ci id="S4.T4.3.3.3.1.m1.1.1.2.3.6.cmml" xref="S4.T4.3.3.3.1.m1.1.1.2.3.6">𝑖</ci><ci id="S4.T4.3.3.3.1.m1.1.1.2.3.7.cmml" xref="S4.T4.3.3.3.1.m1.1.1.2.3.7">𝑚</ci></apply></apply><apply id="S4.T4.3.3.3.1.m1.1.1.3.cmml" xref="S4.T4.3.3.3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T4.3.3.3.1.m1.1.1.3.1.cmml" xref="S4.T4.3.3.3.1.m1.1.1.3">subscript</csymbol><ci id="S4.T4.3.3.3.1.m1.1.1.3.2.cmml" xref="S4.T4.3.3.3.1.m1.1.1.3.2">𝐿</ci><apply id="S4.T4.3.3.3.1.m1.1.1.3.3.cmml" xref="S4.T4.3.3.3.1.m1.1.1.3.3"><times id="S4.T4.3.3.3.1.m1.1.1.3.3.1.cmml" xref="S4.T4.3.3.3.1.m1.1.1.3.3.1"></times><ci id="S4.T4.3.3.3.1.m1.1.1.3.3.2.cmml" xref="S4.T4.3.3.3.1.m1.1.1.3.3.2">𝑝</ci><ci id="S4.T4.3.3.3.1.m1.1.1.3.3.3.cmml" xref="S4.T4.3.3.3.1.m1.1.1.3.3.3">𝑒</ci><ci id="S4.T4.3.3.3.1.m1.1.1.3.3.4.cmml" xref="S4.T4.3.3.3.1.m1.1.1.3.3.4">𝑎</ci><ci id="S4.T4.3.3.3.1.m1.1.1.3.3.5.cmml" xref="S4.T4.3.3.3.1.m1.1.1.3.3.5">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.3.3.3.1.m1.1c">L_{cossim}+L_{peak}</annotation></semantics></math>
</td>
<td id="S4.T4.3.3.3.2" class="ltx_td ltx_align_left">0.34</td>
<td id="S4.T4.3.3.3.3" class="ltx_td ltx_align_left">0.29</td>
<td id="S4.T4.3.3.3.4" class="ltx_td ltx_align_left">0.80</td>
</tr>
<tr id="S4.T4.4.4.4" class="ltx_tr">
<td id="S4.T4.4.4.4.1" class="ltx_td ltx_align_left">(iv) <math id="S4.T4.4.4.4.1.m1.1" class="ltx_Math" alttext="L_{simple}+L_{peak}" display="inline"><semantics id="S4.T4.4.4.4.1.m1.1a"><mrow id="S4.T4.4.4.4.1.m1.1.1" xref="S4.T4.4.4.4.1.m1.1.1.cmml"><msub id="S4.T4.4.4.4.1.m1.1.1.2" xref="S4.T4.4.4.4.1.m1.1.1.2.cmml"><mi id="S4.T4.4.4.4.1.m1.1.1.2.2" xref="S4.T4.4.4.4.1.m1.1.1.2.2.cmml">L</mi><mrow id="S4.T4.4.4.4.1.m1.1.1.2.3" xref="S4.T4.4.4.4.1.m1.1.1.2.3.cmml"><mi id="S4.T4.4.4.4.1.m1.1.1.2.3.2" xref="S4.T4.4.4.4.1.m1.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.T4.4.4.4.1.m1.1.1.2.3.1" xref="S4.T4.4.4.4.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T4.4.4.4.1.m1.1.1.2.3.3" xref="S4.T4.4.4.4.1.m1.1.1.2.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.T4.4.4.4.1.m1.1.1.2.3.1a" xref="S4.T4.4.4.4.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T4.4.4.4.1.m1.1.1.2.3.4" xref="S4.T4.4.4.4.1.m1.1.1.2.3.4.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.T4.4.4.4.1.m1.1.1.2.3.1b" xref="S4.T4.4.4.4.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T4.4.4.4.1.m1.1.1.2.3.5" xref="S4.T4.4.4.4.1.m1.1.1.2.3.5.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.T4.4.4.4.1.m1.1.1.2.3.1c" xref="S4.T4.4.4.4.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T4.4.4.4.1.m1.1.1.2.3.6" xref="S4.T4.4.4.4.1.m1.1.1.2.3.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="S4.T4.4.4.4.1.m1.1.1.2.3.1d" xref="S4.T4.4.4.4.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T4.4.4.4.1.m1.1.1.2.3.7" xref="S4.T4.4.4.4.1.m1.1.1.2.3.7.cmml">e</mi></mrow></msub><mo id="S4.T4.4.4.4.1.m1.1.1.1" xref="S4.T4.4.4.4.1.m1.1.1.1.cmml">+</mo><msub id="S4.T4.4.4.4.1.m1.1.1.3" xref="S4.T4.4.4.4.1.m1.1.1.3.cmml"><mi id="S4.T4.4.4.4.1.m1.1.1.3.2" xref="S4.T4.4.4.4.1.m1.1.1.3.2.cmml">L</mi><mrow id="S4.T4.4.4.4.1.m1.1.1.3.3" xref="S4.T4.4.4.4.1.m1.1.1.3.3.cmml"><mi id="S4.T4.4.4.4.1.m1.1.1.3.3.2" xref="S4.T4.4.4.4.1.m1.1.1.3.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.T4.4.4.4.1.m1.1.1.3.3.1" xref="S4.T4.4.4.4.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S4.T4.4.4.4.1.m1.1.1.3.3.3" xref="S4.T4.4.4.4.1.m1.1.1.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.T4.4.4.4.1.m1.1.1.3.3.1a" xref="S4.T4.4.4.4.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S4.T4.4.4.4.1.m1.1.1.3.3.4" xref="S4.T4.4.4.4.1.m1.1.1.3.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.T4.4.4.4.1.m1.1.1.3.3.1b" xref="S4.T4.4.4.4.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S4.T4.4.4.4.1.m1.1.1.3.3.5" xref="S4.T4.4.4.4.1.m1.1.1.3.3.5.cmml">k</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.4.4.4.1.m1.1b"><apply id="S4.T4.4.4.4.1.m1.1.1.cmml" xref="S4.T4.4.4.4.1.m1.1.1"><plus id="S4.T4.4.4.4.1.m1.1.1.1.cmml" xref="S4.T4.4.4.4.1.m1.1.1.1"></plus><apply id="S4.T4.4.4.4.1.m1.1.1.2.cmml" xref="S4.T4.4.4.4.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.T4.4.4.4.1.m1.1.1.2.1.cmml" xref="S4.T4.4.4.4.1.m1.1.1.2">subscript</csymbol><ci id="S4.T4.4.4.4.1.m1.1.1.2.2.cmml" xref="S4.T4.4.4.4.1.m1.1.1.2.2">𝐿</ci><apply id="S4.T4.4.4.4.1.m1.1.1.2.3.cmml" xref="S4.T4.4.4.4.1.m1.1.1.2.3"><times id="S4.T4.4.4.4.1.m1.1.1.2.3.1.cmml" xref="S4.T4.4.4.4.1.m1.1.1.2.3.1"></times><ci id="S4.T4.4.4.4.1.m1.1.1.2.3.2.cmml" xref="S4.T4.4.4.4.1.m1.1.1.2.3.2">𝑠</ci><ci id="S4.T4.4.4.4.1.m1.1.1.2.3.3.cmml" xref="S4.T4.4.4.4.1.m1.1.1.2.3.3">𝑖</ci><ci id="S4.T4.4.4.4.1.m1.1.1.2.3.4.cmml" xref="S4.T4.4.4.4.1.m1.1.1.2.3.4">𝑚</ci><ci id="S4.T4.4.4.4.1.m1.1.1.2.3.5.cmml" xref="S4.T4.4.4.4.1.m1.1.1.2.3.5">𝑝</ci><ci id="S4.T4.4.4.4.1.m1.1.1.2.3.6.cmml" xref="S4.T4.4.4.4.1.m1.1.1.2.3.6">𝑙</ci><ci id="S4.T4.4.4.4.1.m1.1.1.2.3.7.cmml" xref="S4.T4.4.4.4.1.m1.1.1.2.3.7">𝑒</ci></apply></apply><apply id="S4.T4.4.4.4.1.m1.1.1.3.cmml" xref="S4.T4.4.4.4.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T4.4.4.4.1.m1.1.1.3.1.cmml" xref="S4.T4.4.4.4.1.m1.1.1.3">subscript</csymbol><ci id="S4.T4.4.4.4.1.m1.1.1.3.2.cmml" xref="S4.T4.4.4.4.1.m1.1.1.3.2">𝐿</ci><apply id="S4.T4.4.4.4.1.m1.1.1.3.3.cmml" xref="S4.T4.4.4.4.1.m1.1.1.3.3"><times id="S4.T4.4.4.4.1.m1.1.1.3.3.1.cmml" xref="S4.T4.4.4.4.1.m1.1.1.3.3.1"></times><ci id="S4.T4.4.4.4.1.m1.1.1.3.3.2.cmml" xref="S4.T4.4.4.4.1.m1.1.1.3.3.2">𝑝</ci><ci id="S4.T4.4.4.4.1.m1.1.1.3.3.3.cmml" xref="S4.T4.4.4.4.1.m1.1.1.3.3.3">𝑒</ci><ci id="S4.T4.4.4.4.1.m1.1.1.3.3.4.cmml" xref="S4.T4.4.4.4.1.m1.1.1.3.3.4">𝑎</ci><ci id="S4.T4.4.4.4.1.m1.1.1.3.3.5.cmml" xref="S4.T4.4.4.4.1.m1.1.1.3.3.5">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.4.4.4.1.m1.1c">L_{simple}+L_{peak}</annotation></semantics></math>
</td>
<td id="S4.T4.4.4.4.2" class="ltx_td ltx_align_left">0.25</td>
<td id="S4.T4.4.4.4.3" class="ltx_td ltx_align_left">0.19</td>
<td id="S4.T4.4.4.4.4" class="ltx_td ltx_align_left">0.74</td>
</tr>
<tr id="S4.T4.5.5.5" class="ltx_tr">
<td id="S4.T4.5.5.5.1" class="ltx_td ltx_align_left">(v)   <math id="S4.T4.5.5.5.1.m1.1" class="ltx_Math" alttext="L_{cossim}" display="inline"><semantics id="S4.T4.5.5.5.1.m1.1a"><msub id="S4.T4.5.5.5.1.m1.1.1" xref="S4.T4.5.5.5.1.m1.1.1.cmml"><mi id="S4.T4.5.5.5.1.m1.1.1.2" xref="S4.T4.5.5.5.1.m1.1.1.2.cmml">L</mi><mrow id="S4.T4.5.5.5.1.m1.1.1.3" xref="S4.T4.5.5.5.1.m1.1.1.3.cmml"><mi id="S4.T4.5.5.5.1.m1.1.1.3.2" xref="S4.T4.5.5.5.1.m1.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.T4.5.5.5.1.m1.1.1.3.1" xref="S4.T4.5.5.5.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.T4.5.5.5.1.m1.1.1.3.3" xref="S4.T4.5.5.5.1.m1.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.T4.5.5.5.1.m1.1.1.3.1a" xref="S4.T4.5.5.5.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.T4.5.5.5.1.m1.1.1.3.4" xref="S4.T4.5.5.5.1.m1.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.T4.5.5.5.1.m1.1.1.3.1b" xref="S4.T4.5.5.5.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.T4.5.5.5.1.m1.1.1.3.5" xref="S4.T4.5.5.5.1.m1.1.1.3.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.T4.5.5.5.1.m1.1.1.3.1c" xref="S4.T4.5.5.5.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.T4.5.5.5.1.m1.1.1.3.6" xref="S4.T4.5.5.5.1.m1.1.1.3.6.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.T4.5.5.5.1.m1.1.1.3.1d" xref="S4.T4.5.5.5.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.T4.5.5.5.1.m1.1.1.3.7" xref="S4.T4.5.5.5.1.m1.1.1.3.7.cmml">m</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.T4.5.5.5.1.m1.1b"><apply id="S4.T4.5.5.5.1.m1.1.1.cmml" xref="S4.T4.5.5.5.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T4.5.5.5.1.m1.1.1.1.cmml" xref="S4.T4.5.5.5.1.m1.1.1">subscript</csymbol><ci id="S4.T4.5.5.5.1.m1.1.1.2.cmml" xref="S4.T4.5.5.5.1.m1.1.1.2">𝐿</ci><apply id="S4.T4.5.5.5.1.m1.1.1.3.cmml" xref="S4.T4.5.5.5.1.m1.1.1.3"><times id="S4.T4.5.5.5.1.m1.1.1.3.1.cmml" xref="S4.T4.5.5.5.1.m1.1.1.3.1"></times><ci id="S4.T4.5.5.5.1.m1.1.1.3.2.cmml" xref="S4.T4.5.5.5.1.m1.1.1.3.2">𝑐</ci><ci id="S4.T4.5.5.5.1.m1.1.1.3.3.cmml" xref="S4.T4.5.5.5.1.m1.1.1.3.3">𝑜</ci><ci id="S4.T4.5.5.5.1.m1.1.1.3.4.cmml" xref="S4.T4.5.5.5.1.m1.1.1.3.4">𝑠</ci><ci id="S4.T4.5.5.5.1.m1.1.1.3.5.cmml" xref="S4.T4.5.5.5.1.m1.1.1.3.5">𝑠</ci><ci id="S4.T4.5.5.5.1.m1.1.1.3.6.cmml" xref="S4.T4.5.5.5.1.m1.1.1.3.6">𝑖</ci><ci id="S4.T4.5.5.5.1.m1.1.1.3.7.cmml" xref="S4.T4.5.5.5.1.m1.1.1.3.7">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.5.5.5.1.m1.1c">L_{cossim}</annotation></semantics></math>
</td>
<td id="S4.T4.5.5.5.2" class="ltx_td ltx_align_left">0.42</td>
<td id="S4.T4.5.5.5.3" class="ltx_td ltx_align_left">0.37</td>
<td id="S4.T4.5.5.5.4" class="ltx_td ltx_align_left">0.81</td>
</tr>
<tr id="S4.T4.6.6.6" class="ltx_tr">
<td id="S4.T4.6.6.6.1" class="ltx_td ltx_align_left ltx_border_b">(vi) <math id="S4.T4.6.6.6.1.m1.1" class="ltx_Math" alttext="L_{simple}" display="inline"><semantics id="S4.T4.6.6.6.1.m1.1a"><msub id="S4.T4.6.6.6.1.m1.1.1" xref="S4.T4.6.6.6.1.m1.1.1.cmml"><mi id="S4.T4.6.6.6.1.m1.1.1.2" xref="S4.T4.6.6.6.1.m1.1.1.2.cmml">L</mi><mrow id="S4.T4.6.6.6.1.m1.1.1.3" xref="S4.T4.6.6.6.1.m1.1.1.3.cmml"><mi id="S4.T4.6.6.6.1.m1.1.1.3.2" xref="S4.T4.6.6.6.1.m1.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.T4.6.6.6.1.m1.1.1.3.1" xref="S4.T4.6.6.6.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.T4.6.6.6.1.m1.1.1.3.3" xref="S4.T4.6.6.6.1.m1.1.1.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.T4.6.6.6.1.m1.1.1.3.1a" xref="S4.T4.6.6.6.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.T4.6.6.6.1.m1.1.1.3.4" xref="S4.T4.6.6.6.1.m1.1.1.3.4.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.T4.6.6.6.1.m1.1.1.3.1b" xref="S4.T4.6.6.6.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.T4.6.6.6.1.m1.1.1.3.5" xref="S4.T4.6.6.6.1.m1.1.1.3.5.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.T4.6.6.6.1.m1.1.1.3.1c" xref="S4.T4.6.6.6.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.T4.6.6.6.1.m1.1.1.3.6" xref="S4.T4.6.6.6.1.m1.1.1.3.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="S4.T4.6.6.6.1.m1.1.1.3.1d" xref="S4.T4.6.6.6.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.T4.6.6.6.1.m1.1.1.3.7" xref="S4.T4.6.6.6.1.m1.1.1.3.7.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.T4.6.6.6.1.m1.1b"><apply id="S4.T4.6.6.6.1.m1.1.1.cmml" xref="S4.T4.6.6.6.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T4.6.6.6.1.m1.1.1.1.cmml" xref="S4.T4.6.6.6.1.m1.1.1">subscript</csymbol><ci id="S4.T4.6.6.6.1.m1.1.1.2.cmml" xref="S4.T4.6.6.6.1.m1.1.1.2">𝐿</ci><apply id="S4.T4.6.6.6.1.m1.1.1.3.cmml" xref="S4.T4.6.6.6.1.m1.1.1.3"><times id="S4.T4.6.6.6.1.m1.1.1.3.1.cmml" xref="S4.T4.6.6.6.1.m1.1.1.3.1"></times><ci id="S4.T4.6.6.6.1.m1.1.1.3.2.cmml" xref="S4.T4.6.6.6.1.m1.1.1.3.2">𝑠</ci><ci id="S4.T4.6.6.6.1.m1.1.1.3.3.cmml" xref="S4.T4.6.6.6.1.m1.1.1.3.3">𝑖</ci><ci id="S4.T4.6.6.6.1.m1.1.1.3.4.cmml" xref="S4.T4.6.6.6.1.m1.1.1.3.4">𝑚</ci><ci id="S4.T4.6.6.6.1.m1.1.1.3.5.cmml" xref="S4.T4.6.6.6.1.m1.1.1.3.5">𝑝</ci><ci id="S4.T4.6.6.6.1.m1.1.1.3.6.cmml" xref="S4.T4.6.6.6.1.m1.1.1.3.6">𝑙</ci><ci id="S4.T4.6.6.6.1.m1.1.1.3.7.cmml" xref="S4.T4.6.6.6.1.m1.1.1.3.7">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.6.6.6.1.m1.1c">L_{simple}</annotation></semantics></math>
</td>
<td id="S4.T4.6.6.6.2" class="ltx_td ltx_align_left ltx_border_b"><span id="S4.T4.6.6.6.2.1" class="ltx_text ltx_font_bold">0.51</span></td>
<td id="S4.T4.6.6.6.3" class="ltx_td ltx_align_left ltx_border_b"><span id="S4.T4.6.6.6.3.1" class="ltx_text ltx_font_bold">0.43</span></td>
<td id="S4.T4.6.6.6.4" class="ltx_td ltx_align_left ltx_border_b"><span id="S4.T4.6.6.6.4.1" class="ltx_text ltx_font_bold">0.82</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S4.F4" class="ltx_figure"><img src="/html/2309.00434/assets/x3.png" id="S4.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="457" height="120" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span><span id="S4.F4.2.1" class="ltx_text ltx_font_bold">Loss comparison.</span> Looking closer at the score map prediction between the configurations (b) and (c), we can see that combining the three losses (b) results in much more confident keypoints with less ambiguous areas.
</figcaption>
</figure>
<div id="S4.SS4.p4" class="ltx_para ltx_noindent">
<p id="S4.SS4.p4.8" class="ltx_p"><span id="S4.SS4.p4.8.1" class="ltx_text ltx_font_bold">Loss combinations:</span> At last, we assess six setups to gauge how well each of our proposed loss components (Equation <a href="#S3.E5" title="In 3.2 Loss function ‣ 3 Methodology ‣ Improving the matching of deformable objects by learning to detect keypoints" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>) contributes to and supports our implementation choices, as shown in table <a href="#S4.T4" title="Table 4 ‣ 4.4 Ablation study and sensitivity analysis ‣ 4.3 Results on the application of object retrieval ‣ 4.2 Results on sequences of deformable objects ‣ 4.1 Metrics and baselines ‣ 4 Experiments and results ‣ Improving the matching of deformable objects by learning to detect keypoints" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. Our findings demonstrate that setup (i) is the most effective, with the repeatability rate at <math id="S4.SS4.p4.1.m1.1" class="ltx_Math" alttext="0.5" display="inline"><semantics id="S4.SS4.p4.1.m1.1a"><mn id="S4.SS4.p4.1.m1.1.1" xref="S4.SS4.p4.1.m1.1.1.cmml">0.5</mn><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.1.m1.1b"><cn type="float" id="S4.SS4.p4.1.m1.1.1.cmml" xref="S4.SS4.p4.1.m1.1.1">0.5</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.1.m1.1c">0.5</annotation></semantics></math>, the best MS at <math id="S4.SS4.p4.2.m2.1" class="ltx_Math" alttext="0.43" display="inline"><semantics id="S4.SS4.p4.2.m2.1a"><mn id="S4.SS4.p4.2.m2.1.1" xref="S4.SS4.p4.2.m2.1.1.cmml">0.43</mn><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.2.m2.1b"><cn type="float" id="S4.SS4.p4.2.m2.1.1.cmml" xref="S4.SS4.p4.2.m2.1.1">0.43</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.2.m2.1c">0.43</annotation></semantics></math>, and MMA@3 at <math id="S4.SS4.p4.3.m3.1" class="ltx_Math" alttext="0.81" display="inline"><semantics id="S4.SS4.p4.3.m3.1a"><mn id="S4.SS4.p4.3.m3.1.1" xref="S4.SS4.p4.3.m3.1.1.cmml">0.81</mn><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.3.m3.1b"><cn type="float" id="S4.SS4.p4.3.m3.1.1.cmml" xref="S4.SS4.p4.3.m3.1.1">0.81</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.3.m3.1c">0.81</annotation></semantics></math>. Despite (vi) having slightly better values, it results in much less confident keypoints, resulting in an ambiguous score map with almost no peaks, as shown in Figure <a href="#S4.F4" title="Figure 4 ‣ 4.4 Ablation study and sensitivity analysis ‣ 4.3 Results on the application of object retrieval ‣ 4.2 Results on sequences of deformable objects ‣ 4.1 Metrics and baselines ‣ 4 Experiments and results ‣ Improving the matching of deformable objects by learning to detect keypoints" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. For this reason we choose setup (i).
To further justify the weighting step choices in our training framework, we experimented by applying equal weights based on repeatable matching. This will set all the peaks in the MHs to a constant value of <math id="S4.SS4.p4.4.m4.1" class="ltx_Math" alttext="1.0" display="inline"><semantics id="S4.SS4.p4.4.m4.1a"><mn id="S4.SS4.p4.4.m4.1.1" xref="S4.SS4.p4.4.m4.1.1.cmml">1.0</mn><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.4.m4.1b"><cn type="float" id="S4.SS4.p4.4.m4.1.1.cmml" xref="S4.SS4.p4.4.m4.1.1">1.0</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.4.m4.1c">1.0</annotation></semantics></math>. For this equal weights strategy, we achieved RR and MS values of <math id="S4.SS4.p4.5.m5.1" class="ltx_Math" alttext="0.45" display="inline"><semantics id="S4.SS4.p4.5.m5.1a"><mn id="S4.SS4.p4.5.m5.1.1" xref="S4.SS4.p4.5.m5.1.1.cmml">0.45</mn><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.5.m5.1b"><cn type="float" id="S4.SS4.p4.5.m5.1.1.cmml" xref="S4.SS4.p4.5.m5.1.1">0.45</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.5.m5.1c">0.45</annotation></semantics></math> and <math id="S4.SS4.p4.6.m6.1" class="ltx_Math" alttext="0.37" display="inline"><semantics id="S4.SS4.p4.6.m6.1a"><mn id="S4.SS4.p4.6.m6.1.1" xref="S4.SS4.p4.6.m6.1.1.cmml">0.37</mn><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.6.m6.1b"><cn type="float" id="S4.SS4.p4.6.m6.1.1.cmml" xref="S4.SS4.p4.6.m6.1.1">0.37</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.6.m6.1c">0.37</annotation></semantics></math>, which are much lower than what we achieve when utilizing the proposed weighted Matching Heatmap strategy (<math id="S4.SS4.p4.7.m7.1" class="ltx_Math" alttext="0.50" display="inline"><semantics id="S4.SS4.p4.7.m7.1a"><mn id="S4.SS4.p4.7.m7.1.1" xref="S4.SS4.p4.7.m7.1.1.cmml">0.50</mn><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.7.m7.1b"><cn type="float" id="S4.SS4.p4.7.m7.1.1.cmml" xref="S4.SS4.p4.7.m7.1.1">0.50</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.7.m7.1c">0.50</annotation></semantics></math> and <math id="S4.SS4.p4.8.m8.1" class="ltx_Math" alttext="0.43" display="inline"><semantics id="S4.SS4.p4.8.m8.1a"><mn id="S4.SS4.p4.8.m8.1.1" xref="S4.SS4.p4.8.m8.1.1.cmml">0.43</mn><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.8.m8.1b"><cn type="float" id="S4.SS4.p4.8.m8.1.1.cmml" xref="S4.SS4.p4.8.m8.1.1">0.43</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.8.m8.1c">0.43</annotation></semantics></math> for RR and MS, respectively).</p>
</div>
<div id="S4.SS4.p5" class="ltx_para ltx_noindent">
<p id="S4.SS4.p5.1" class="ltx_p"><span id="S4.SS4.p5.1.1" class="ltx_text ltx_font_bold">Limitations:</span>
As stated in Section <a href="#S3" title="3 Methodology ‣ Improving the matching of deformable objects by learning to detect keypoints" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, our detection strategy learns to improve the types of keypoints provided by the base detector and conditions them to work better with the descriptor used in the training for matching non-rigid surfaces. This behavior is not uncommon, and it can be observed when a detector is trained with the assistance, or at the same time, of a specific descriptor, like R2D2 and DISK. But this modeling also implies that our detector can incorporate limitations from the description method, e.g., if ASLFeat fails to match poorly-textured regions, our detector will also avoid these areas.</p>
</div>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">We present a novel method for locating confident keypoints on images having non-rigid deformations, focused on improving matching results. For designing a detector that learns the likelihood of proper matching for a given descriptor, we devised a method for training a CNN using non-rigidly deformed images. The experimental results demonstrate that our approach successfully matched and detected keypoints on non-rigid deformation datasets with state-of-the-art accuracy.
We observed that learning the types of keypoints that remain robust to matching goes beyond keeping the base detector predictions, as our method could maintain the number of detections and improve the keypoint selection.
The experimental analysis also indicates that a successful detector requires more than just repeatability. Our learned detector improved matching for three different state-of-the-art descriptors compared to a wide variety of competitors. We also demonstrate the effectiveness of our detector in a practical setting, indicating the potential of improving keypoint detection as a research area for enhancing performance in practical tasks.
Future works can easily extend our approach to tackle not only challenges in deformable object matching but a wider class of problems involving reliable keypoint computation.



<br class="ltx_break"><span id="S5.p1.1.1" class="ltx_text ltx_font_bold">Acknowledgments.</span>
We would like to thank CAPES, CNPq, FAPEMIG, Google, and Conseil Régional BFC for funding different parts of this work and NVIDIA for the donation of a Titan XP GPU used for this study. This work was also granted access to the HPC resources of IDRIS under the project 2021-AD011013154.</p>
</div>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
P. Di Febbo, C. Dal Mutto, K. Tieu, S. Mattoccia, KCNN: extremely-efficient
hardware keypoint detection with a compact convolutional neural network, in:
CVPR Workshops, 2018.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
A. Barroso-Laguna, E. Riba, D. Ponsa, K. Mikolajczyk, Key.Net: Keypoint
Detection by Handcrafted and Learned CNN Filters, in: ICCV, 2019.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
J. Revaud, C. De Souza, M. Humenberger, P. Weinzaepfel, R2d2: Reliable and
repeatable detector and descriptor, in: NeurIPS, 2019.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
M. Dusmanu, I. Rocco, T. Pajdla, M. Pollefeys, J. Sivic, A. Torii, T. Sattler,
D2-net: A trainable CNN for joint description and detection of local
features, in: CVPR, 2019.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Z. Luo, L. Zhou, X. Bai, H. Chen, J. Zhang, Y. Yao, S. Li, T. Fang, L. Quan,
ASLFeat: learning local features of accurate shape and localization, in:
CVPR, 2020.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
M. Tyszkiewicz, P. Fua, E. Trulls, DISK: learning local features with policy
gradient, in: NeurIPS, 2020.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Y. Song, L. Cai, J. Li, Y. Tian, M. Li, SEKD: self-evolving keypoint
detection and description, in: arXiv, 2020.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
S. Suwanwimolkul, S. Komorita, K. Tasaka, Learning of low-level feature
keypoints for accurate and robust detection, in: WACV, 2021.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
L. O. Vasconcelos, E. R. Nascimento, M. F. Campos, Kvd: Scale invariant
keypoints by combining visual and depth data, PRL (2017) 83–89.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
D. G. Lowe, Distinctive image features from scale-invariant keypoints, IJCV 60
(2004) 91–110.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
E. Rublee, V. Rabaud, K. Konolige, G. Bradski, ORB: An efficient alternative
to SIFT or SURF, in: ICCV, 2011.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
J. Sun, Z. Shen, Y. Wang, H. Bao, X. Zhou, LoFTR: detector-free local feature
matching with transformers, in: CVPR, 2021.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Y. You, W. Liu, Y.-L. Li, W. Wang, C. Lu, Ukpgan: Unsupervised keypoint
ganeration, in: arXiv, 2020.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
G. Potje, R. Martins, F. Chamone, E. Nascimento, Extracting deformation-aware
local features by learning to deform, in: NeurIPS, 2021.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
A. Bartoli, M. Perriollat, S. Chambon, Generalized thin-plate spline warps.,
IJCV 88 (1) (2010) 85–110.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
W. Melo, G. Potje, F. Cadar, R. Martins, E. R. Nascimento, Learning to detect
good keypoints to match non-rigid objects in RGB images, in: SIBGRAPI,
2022.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
C. Harris, M. Stephens, et al., A combined corner and edge detector, in: Alvey
Vision Conference, 1988.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Z. Luo, T. Shen, L. Zhou, J. Zhang, Y. Yao, S. Li, T. Fang, L. Quan,
ContextDesc: local descriptor augmentation with cross-modality context, in:
CVPR, 2019.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
G. Wu, Z. Lin, G. Ding, Q. Ni, J. Han, On aggregation of unsupervised deep
binary descriptor with weak bits, IEEE Transactions on Image Processing 29
(2020) 9266–9278.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
D. DeTone, T. Malisiewicz, A. Rabinovich, SuperPoint: self-supervised
interest point detection and description, in: CVPR Workshops, 2018.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Y. Ono, E. Trulls, P. Fua, K. M. Yi, LF-Net: learning local features from
images, in: NeurIPS, 2018.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
K. M. Yi, E. Trulls, V. Lepetit, P. Fua, Lift: Learned invariant feature
transform, in: ECCV, 2016, pp. 467–483.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
X. Zhao, X. Wu, J. Miao, W. Chen, P. C. Y. Chen, Z. Li, Alike: Accurate and
lightweight keypoint detection and descriptor extraction, IEEE Trans. on
Multimedia.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
N. Savinov, A. Seki, L. Ladicky, T. Sattler, M. Pollefeys, Quad-networks:
unsupervised learning to rank for interest point detection, in: CVPR, 2017.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
L. Zhang, S. Rusinkiewicz, Learning to detect features in texture images, in:
CVPR, 2018.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Y. Verdie, K. M. Yi, P. Fua, V. Lepetit, TILDE: A temporally invariant
learned DEtector, in: CVPR, IEEE, 2015.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
P. Truong, S. Apostolopoulos, A. Mosinska, S. Stucky, C. Ciller, S. D. Zanet,
GLAMpoints: greedily learned accurate match points, in: ICCV, 2019.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
A. Tonioni, S. Salti, F. Tombari, R. Spezialetti, L. D. Stefano, Learning to
detect good 3d keypoints, IJCV (2018) 1–20.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
F. Moreno-Noguer, Deformation and illumination invariant feature point
descriptor, in: CVPR, 2011.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
E. R. Nascimento, G. Potje, R. Martins, F. Cadar, M. F. Campos, R. Bajcsy,
GEOBIT: a geodesic-based binary descriptor invariant to non-rigid
deformations for RGB-D images, in: ICCV, 2019.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
G. Potje, R. Martins, F. Cadar, E. R. Nascimento, Learning geodesic-aware local
features from RGB-D images, CVIU 219 (2022) 103409.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
S. Tarashima, J. Shimamura, T. Kinebuchi, S. Satah, Keypoint matching for
non-rigid object via locally consistent visual pattern mining, in: ICIP,
IEEE, 2018.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
G. Donato, S. Belongie, Approximate thin plate spline mappings, in: ECCV, 2002.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
J. Bromley, I. Guyon, Y. LeCun, E. Säckinger, R. Shah, Signature
verification using a "siamese" time delay neural network, in: NeurIPS, 1993.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
O. Ronneberger, P. Fischer, T. Brox, U-net: Convolutional networks for
biomedical image segmentation, in: MICCAI, 2015.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
K. Wilson, N. Snavely, Robust global translations with 1dsfm, in: ECCV, 2014.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
T. Wang, H. Ling, C. Lang, S. Feng, X. Hou, Deformable surface tracking by
graph matching, in: ICCV, 2019.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
Y. Jin, D. Mishkin, A. Mishchuk, J. Matas, P. Fua, K. M. Yi, E. Trulls, Image
matching across wide baselines: From paper to practice, IJCV (2021)
517–547.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
E. Rosten, T. Drummond, Machine learning for high-speed corner detection, in:
ECCV, 2006.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
P. F. Alcantarilla, A. Bartoli, A. J. Davison, KAZE features, in: ECCV, 2012.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
D. DeTone, T. Malisiewicz, A. Rabinovich, SuperPoint: self-supervised
interest point detection and description, in: CVPR Workshops, 2018.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
K. Mikolajczyk, T. Tuytelaars, C. Schmid, A. Zisserman, J. Matas,
F. Schaffalitzky, T. Kadir, L. V. Gool, A comparison of affine region
detectors, IJCV 65 (1) (2005) 43–72.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
</div>
</div>
</figure>
</section>
</div>
</div>
</figure>
</section>
</section>
</div>
</div>
</figure>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2309.00433" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2309.00434" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2309.00434">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2309.00434" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2309.00435" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Wed Feb 28 06:02:49 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
